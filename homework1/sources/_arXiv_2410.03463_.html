<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Diffusion State-Guided Projected Gradient for Inverse Problems</title>
<!--Generated on Fri Oct  4 14:17:22 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03463v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S1" title="In Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S2" title="In Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background &amp; Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S3" title="In Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Diffusion State-Guided Projected Gradient (DiffStateGrad)</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S3.SS1" title="In 3 Diffusion State-Guided Projected Gradient (DiffStateGrad) ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Efficiency</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4" title="In Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.SS1" title="In 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.SS2" title="In 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Robustness</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.SS3" title="In 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Performance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S5" title="In Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S6" title="In Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Reproducibility Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A1" title="In Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Additional Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A2" title="In Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Visualizations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3" title="In Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS1" title="In Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Hyperparameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS2" title="In Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Efficiency Experiment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS3" title="In Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>PSLD</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS4" title="In Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.4 </span>ReSample</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS5" title="In Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.5 </span>DAPS</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A4" title="In Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Proofs</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Diffusion State-Guided Projected Gradient for Inverse Problems</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rayhan Zirvi 
<br class="ltx_break"/>Computing and Mathematical Sciences
<br class="ltx_break"/>California Institute of Technology
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.2.id1">rayhanzirvi@caltech.edu</span>
<br class="ltx_break"/>&amp;Bahareh Tolooshams<sup class="ltx_sup" id="id3.3.id2">∗</sup>
<br class="ltx_break"/>Computing and Mathematical Sciences
<br class="ltx_break"/>California Institute of Technology
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id4.4.id3">btoloosh@caltech.edu</span>
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id5.5.id4">\AND</span>Anima Anandkumar
<br class="ltx_break"/>Computing and Mathematical Sciences
<br class="ltx_break"/>California Institute of Technology
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id6.6.id5">anima@caltech.edu</span>
<br class="ltx_break"/>
</span><span class="ltx_author_notes">Equal contribution</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id7.id1">Recent advancements in diffusion models have been effective in learning data priors for solving inverse problems. They leverage diffusion sampling steps for inducing a data prior while using a measurement guidance gradient at each step to impose data consistency. For general inverse problems, approximations are needed when an unconditionally trained diffusion model is used since the measurement likelihood is intractable, leading to inaccurate posterior sampling. In other words, due to their approximations, these methods fail to preserve the generation process on the data manifold defined by the diffusion prior, leading to artifacts in applications such as image restoration. To enhance the performance and robustness of diffusion models in solving inverse problems, we propose <span class="ltx_text ltx_font_italic" id="id7.id1.1">Diffusion State-Guided Projected Gradient</span> (DiffStateGrad), which projects the measurement gradient onto a subspace that is a low-rank approximation of an intermediate state of the diffusion process. DiffStateGrad, as a module, can be added to a wide range of diffusion-based inverse solvers to improve the preservation of the diffusion process on the prior manifold and filter out artifact-inducing components. We highlight that DiffStateGrad improves the robustness of diffusion models in terms of the choice of measurement guidance step size and noise while improving the worst-case performance. Finally, we demonstrate that DiffStateGrad improves upon the state-of-the-art on linear and nonlinear image restoration inverse problems.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Inverse problems are ubiquitous in science and engineering, playing a crucial role in simulation-based scientific discovery and real-world applications <cite class="ltx_cite ltx_citemacro_citep">(Groetsch &amp; Groetsch, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib11" title="">1993</a>)</cite>. They arise in fields such as medical imaging, remote sensing, astrophysics, computational neuroscience, molecular dynamics simulations, systems biology, and generally solving partial differential equations (PDEs). Inverse problems aim to recover an unknown signal <math alttext="{\bm{x}}^{\star}\in\mathbb{R}^{n}" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><mrow id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml"><msup id="S1.p1.1.m1.1.1.2" xref="S1.p1.1.m1.1.1.2.cmml"><mi id="S1.p1.1.m1.1.1.2.2" xref="S1.p1.1.m1.1.1.2.2.cmml">𝒙</mi><mo id="S1.p1.1.m1.1.1.2.3" xref="S1.p1.1.m1.1.1.2.3.cmml">⋆</mo></msup><mo id="S1.p1.1.m1.1.1.1" xref="S1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S1.p1.1.m1.1.1.3" xref="S1.p1.1.m1.1.1.3.cmml"><mi id="S1.p1.1.m1.1.1.3.2" xref="S1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S1.p1.1.m1.1.1.3.3" xref="S1.p1.1.m1.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><apply id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1"><in id="S1.p1.1.m1.1.1.1.cmml" xref="S1.p1.1.m1.1.1.1"></in><apply id="S1.p1.1.m1.1.1.2.cmml" xref="S1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S1.p1.1.m1.1.1.2.1.cmml" xref="S1.p1.1.m1.1.1.2">superscript</csymbol><ci id="S1.p1.1.m1.1.1.2.2.cmml" xref="S1.p1.1.m1.1.1.2.2">𝒙</ci><ci id="S1.p1.1.m1.1.1.2.3.cmml" xref="S1.p1.1.m1.1.1.2.3">⋆</ci></apply><apply id="S1.p1.1.m1.1.1.3.cmml" xref="S1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S1.p1.1.m1.1.1.3.1.cmml" xref="S1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S1.p1.1.m1.1.1.3.2.cmml" xref="S1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S1.p1.1.m1.1.1.3.3.cmml" xref="S1.p1.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">{\bm{x}}^{\star}\in\mathbb{R}^{n}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">bold_italic_x start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> from noisy observations</p>
<table class="ltx_equation ltx_eqn_table" id="S1.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{y}}=\mathcal{A}({\bm{x}}^{\star})+{\bm{n}}\in\mathbb{R}^{m}," class="ltx_Math" display="block" id="S1.E1.m1.1"><semantics id="S1.E1.m1.1a"><mrow id="S1.E1.m1.1.1.1" xref="S1.E1.m1.1.1.1.1.cmml"><mrow id="S1.E1.m1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.cmml"><mi id="S1.E1.m1.1.1.1.1.3" xref="S1.E1.m1.1.1.1.1.3.cmml">𝒚</mi><mo id="S1.E1.m1.1.1.1.1.4" xref="S1.E1.m1.1.1.1.1.4.cmml">=</mo><mrow id="S1.E1.m1.1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.1.cmml"><mrow id="S1.E1.m1.1.1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.E1.m1.1.1.1.1.1.1.3" xref="S1.E1.m1.1.1.1.1.1.1.3.cmml">𝒜</mi><mo id="S1.E1.m1.1.1.1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S1.E1.m1.1.1.1.1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S1.E1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S1.E1.m1.1.1.1.1.1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S1.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S1.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">⋆</mo></msup><mo id="S1.E1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.E1.m1.1.1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.1.2.cmml">+</mo><mi id="S1.E1.m1.1.1.1.1.1.3" xref="S1.E1.m1.1.1.1.1.1.3.cmml">𝒏</mi></mrow><mo id="S1.E1.m1.1.1.1.1.5" xref="S1.E1.m1.1.1.1.1.5.cmml">∈</mo><msup id="S1.E1.m1.1.1.1.1.6" xref="S1.E1.m1.1.1.1.1.6.cmml"><mi id="S1.E1.m1.1.1.1.1.6.2" xref="S1.E1.m1.1.1.1.1.6.2.cmml">ℝ</mi><mi id="S1.E1.m1.1.1.1.1.6.3" xref="S1.E1.m1.1.1.1.1.6.3.cmml">m</mi></msup></mrow><mo id="S1.E1.m1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E1.m1.1b"><apply id="S1.E1.m1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1"><and id="S1.E1.m1.1.1.1.1a.cmml" xref="S1.E1.m1.1.1.1"></and><apply id="S1.E1.m1.1.1.1.1b.cmml" xref="S1.E1.m1.1.1.1"><eq id="S1.E1.m1.1.1.1.1.4.cmml" xref="S1.E1.m1.1.1.1.1.4"></eq><ci id="S1.E1.m1.1.1.1.1.3.cmml" xref="S1.E1.m1.1.1.1.1.3">𝒚</ci><apply id="S1.E1.m1.1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1.1"><plus id="S1.E1.m1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.1.1.1.1.1.2"></plus><apply id="S1.E1.m1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1"><times id="S1.E1.m1.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.1.1.1.1.1.1.2"></times><ci id="S1.E1.m1.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.1.1.1.1.1.1.3">𝒜</ci><apply id="S1.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S1.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S1.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.3">⋆</ci></apply></apply><ci id="S1.E1.m1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.1.1.1.1.1.3">𝒏</ci></apply></apply><apply id="S1.E1.m1.1.1.1.1c.cmml" xref="S1.E1.m1.1.1.1"><in id="S1.E1.m1.1.1.1.1.5.cmml" xref="S1.E1.m1.1.1.1.1.5"></in><share href="https://arxiv.org/html/2410.03463v1#S1.E1.m1.1.1.1.1.1.cmml" id="S1.E1.m1.1.1.1.1d.cmml" xref="S1.E1.m1.1.1.1"></share><apply id="S1.E1.m1.1.1.1.1.6.cmml" xref="S1.E1.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S1.E1.m1.1.1.1.1.6.1.cmml" xref="S1.E1.m1.1.1.1.1.6">superscript</csymbol><ci id="S1.E1.m1.1.1.1.1.6.2.cmml" xref="S1.E1.m1.1.1.1.1.6.2">ℝ</ci><ci id="S1.E1.m1.1.1.1.1.6.3.cmml" xref="S1.E1.m1.1.1.1.1.6.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1.m1.1c">{\bm{y}}=\mathcal{A}({\bm{x}}^{\star})+{\bm{n}}\in\mathbb{R}^{m},</annotation><annotation encoding="application/x-llamapun" id="S1.E1.m1.1d">bold_italic_y = caligraphic_A ( bold_italic_x start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT ) + bold_italic_n ∈ blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S1.p1.10">where <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S1.p1.2.m1.1"><semantics id="S1.p1.2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S1.p1.2.m1.1.1" xref="S1.p1.2.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S1.p1.2.m1.1b"><ci id="S1.p1.2.m1.1.1.cmml" xref="S1.p1.2.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.2.m1.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.2.m1.1d">caligraphic_A</annotation></semantics></math> denotes the measurement operator, and <math alttext="{\bm{n}}" class="ltx_Math" display="inline" id="S1.p1.3.m2.1"><semantics id="S1.p1.3.m2.1a"><mi id="S1.p1.3.m2.1.1" xref="S1.p1.3.m2.1.1.cmml">𝒏</mi><annotation-xml encoding="MathML-Content" id="S1.p1.3.m2.1b"><ci id="S1.p1.3.m2.1.1.cmml" xref="S1.p1.3.m2.1.1">𝒏</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.3.m2.1c">{\bm{n}}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.3.m2.1d">bold_italic_n</annotation></semantics></math> is the noise. Inverse problems are ill-posed, i.e., in the absence of a structure governing the underlying desired signal <math alttext="{\bm{x}}" class="ltx_Math" display="inline" id="S1.p1.4.m3.1"><semantics id="S1.p1.4.m3.1a"><mi id="S1.p1.4.m3.1.1" xref="S1.p1.4.m3.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S1.p1.4.m3.1b"><ci id="S1.p1.4.m3.1.1.cmml" xref="S1.p1.4.m3.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.4.m3.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.4.m3.1d">bold_italic_x</annotation></semantics></math>, many solutions can explain the measurements <math alttext="{\bm{y}}" class="ltx_Math" display="inline" id="S1.p1.5.m4.1"><semantics id="S1.p1.5.m4.1a"><mi id="S1.p1.5.m4.1.1" xref="S1.p1.5.m4.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S1.p1.5.m4.1b"><ci id="S1.p1.5.m4.1.1.cmml" xref="S1.p1.5.m4.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.5.m4.1c">{\bm{y}}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.5.m4.1d">bold_italic_y</annotation></semantics></math>. In the Bayesian framework, this structure is translated into a <span class="ltx_text ltx_font_italic" id="S1.p1.10.1">prior</span> <math alttext="p({\bm{x}})" class="ltx_Math" display="inline" id="S1.p1.6.m5.1"><semantics id="S1.p1.6.m5.1a"><mrow id="S1.p1.6.m5.1.2" xref="S1.p1.6.m5.1.2.cmml"><mi id="S1.p1.6.m5.1.2.2" xref="S1.p1.6.m5.1.2.2.cmml">p</mi><mo id="S1.p1.6.m5.1.2.1" xref="S1.p1.6.m5.1.2.1.cmml">⁢</mo><mrow id="S1.p1.6.m5.1.2.3.2" xref="S1.p1.6.m5.1.2.cmml"><mo id="S1.p1.6.m5.1.2.3.2.1" stretchy="false" xref="S1.p1.6.m5.1.2.cmml">(</mo><mi id="S1.p1.6.m5.1.1" xref="S1.p1.6.m5.1.1.cmml">𝒙</mi><mo id="S1.p1.6.m5.1.2.3.2.2" stretchy="false" xref="S1.p1.6.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.6.m5.1b"><apply id="S1.p1.6.m5.1.2.cmml" xref="S1.p1.6.m5.1.2"><times id="S1.p1.6.m5.1.2.1.cmml" xref="S1.p1.6.m5.1.2.1"></times><ci id="S1.p1.6.m5.1.2.2.cmml" xref="S1.p1.6.m5.1.2.2">𝑝</ci><ci id="S1.p1.6.m5.1.1.cmml" xref="S1.p1.6.m5.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.6.m5.1c">p({\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S1.p1.6.m5.1d">italic_p ( bold_italic_x )</annotation></semantics></math>, which can be combined with the <span class="ltx_text ltx_font_italic" id="S1.p1.10.2">likelihood term</span> <math alttext="p({\bm{y}}|{\bm{x}})" class="ltx_Math" display="inline" id="S1.p1.7.m6.1"><semantics id="S1.p1.7.m6.1a"><mrow id="S1.p1.7.m6.1.1" xref="S1.p1.7.m6.1.1.cmml"><mi id="S1.p1.7.m6.1.1.3" xref="S1.p1.7.m6.1.1.3.cmml">p</mi><mo id="S1.p1.7.m6.1.1.2" xref="S1.p1.7.m6.1.1.2.cmml">⁢</mo><mrow id="S1.p1.7.m6.1.1.1.1" xref="S1.p1.7.m6.1.1.1.1.1.cmml"><mo id="S1.p1.7.m6.1.1.1.1.2" stretchy="false" xref="S1.p1.7.m6.1.1.1.1.1.cmml">(</mo><mrow id="S1.p1.7.m6.1.1.1.1.1" xref="S1.p1.7.m6.1.1.1.1.1.cmml"><mi id="S1.p1.7.m6.1.1.1.1.1.2" xref="S1.p1.7.m6.1.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S1.p1.7.m6.1.1.1.1.1.1" xref="S1.p1.7.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S1.p1.7.m6.1.1.1.1.1.3" xref="S1.p1.7.m6.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S1.p1.7.m6.1.1.1.1.3" stretchy="false" xref="S1.p1.7.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.7.m6.1b"><apply id="S1.p1.7.m6.1.1.cmml" xref="S1.p1.7.m6.1.1"><times id="S1.p1.7.m6.1.1.2.cmml" xref="S1.p1.7.m6.1.1.2"></times><ci id="S1.p1.7.m6.1.1.3.cmml" xref="S1.p1.7.m6.1.1.3">𝑝</ci><apply id="S1.p1.7.m6.1.1.1.1.1.cmml" xref="S1.p1.7.m6.1.1.1.1"><csymbol cd="latexml" id="S1.p1.7.m6.1.1.1.1.1.1.cmml" xref="S1.p1.7.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p1.7.m6.1.1.1.1.1.2.cmml" xref="S1.p1.7.m6.1.1.1.1.1.2">𝒚</ci><ci id="S1.p1.7.m6.1.1.1.1.1.3.cmml" xref="S1.p1.7.m6.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.7.m6.1c">p({\bm{y}}|{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S1.p1.7.m6.1d">italic_p ( bold_italic_y | bold_italic_x )</annotation></semantics></math> to define a <span class="ltx_text ltx_font_italic" id="S1.p1.10.3">posterior distribution</span> <math alttext="p({\bm{x}}|{\bm{y}})\propto p({\bm{y}}|{\bm{x}})p({\bm{x}})" class="ltx_Math" display="inline" id="S1.p1.8.m7.3"><semantics id="S1.p1.8.m7.3a"><mrow id="S1.p1.8.m7.3.3" xref="S1.p1.8.m7.3.3.cmml"><mrow id="S1.p1.8.m7.2.2.1" xref="S1.p1.8.m7.2.2.1.cmml"><mi id="S1.p1.8.m7.2.2.1.3" xref="S1.p1.8.m7.2.2.1.3.cmml">p</mi><mo id="S1.p1.8.m7.2.2.1.2" xref="S1.p1.8.m7.2.2.1.2.cmml">⁢</mo><mrow id="S1.p1.8.m7.2.2.1.1.1" xref="S1.p1.8.m7.2.2.1.1.1.1.cmml"><mo id="S1.p1.8.m7.2.2.1.1.1.2" stretchy="false" xref="S1.p1.8.m7.2.2.1.1.1.1.cmml">(</mo><mrow id="S1.p1.8.m7.2.2.1.1.1.1" xref="S1.p1.8.m7.2.2.1.1.1.1.cmml"><mi id="S1.p1.8.m7.2.2.1.1.1.1.2" xref="S1.p1.8.m7.2.2.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S1.p1.8.m7.2.2.1.1.1.1.1" xref="S1.p1.8.m7.2.2.1.1.1.1.1.cmml">|</mo><mi id="S1.p1.8.m7.2.2.1.1.1.1.3" xref="S1.p1.8.m7.2.2.1.1.1.1.3.cmml">𝒚</mi></mrow><mo id="S1.p1.8.m7.2.2.1.1.1.3" stretchy="false" xref="S1.p1.8.m7.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.p1.8.m7.3.3.3" xref="S1.p1.8.m7.3.3.3.cmml">∝</mo><mrow id="S1.p1.8.m7.3.3.2" xref="S1.p1.8.m7.3.3.2.cmml"><mi id="S1.p1.8.m7.3.3.2.3" xref="S1.p1.8.m7.3.3.2.3.cmml">p</mi><mo id="S1.p1.8.m7.3.3.2.2" xref="S1.p1.8.m7.3.3.2.2.cmml">⁢</mo><mrow id="S1.p1.8.m7.3.3.2.1.1" xref="S1.p1.8.m7.3.3.2.1.1.1.cmml"><mo id="S1.p1.8.m7.3.3.2.1.1.2" stretchy="false" xref="S1.p1.8.m7.3.3.2.1.1.1.cmml">(</mo><mrow id="S1.p1.8.m7.3.3.2.1.1.1" xref="S1.p1.8.m7.3.3.2.1.1.1.cmml"><mi id="S1.p1.8.m7.3.3.2.1.1.1.2" xref="S1.p1.8.m7.3.3.2.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S1.p1.8.m7.3.3.2.1.1.1.1" xref="S1.p1.8.m7.3.3.2.1.1.1.1.cmml">|</mo><mi id="S1.p1.8.m7.3.3.2.1.1.1.3" xref="S1.p1.8.m7.3.3.2.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S1.p1.8.m7.3.3.2.1.1.3" stretchy="false" xref="S1.p1.8.m7.3.3.2.1.1.1.cmml">)</mo></mrow><mo id="S1.p1.8.m7.3.3.2.2a" xref="S1.p1.8.m7.3.3.2.2.cmml">⁢</mo><mi id="S1.p1.8.m7.3.3.2.4" xref="S1.p1.8.m7.3.3.2.4.cmml">p</mi><mo id="S1.p1.8.m7.3.3.2.2b" xref="S1.p1.8.m7.3.3.2.2.cmml">⁢</mo><mrow id="S1.p1.8.m7.3.3.2.5.2" xref="S1.p1.8.m7.3.3.2.cmml"><mo id="S1.p1.8.m7.3.3.2.5.2.1" stretchy="false" xref="S1.p1.8.m7.3.3.2.cmml">(</mo><mi id="S1.p1.8.m7.1.1" xref="S1.p1.8.m7.1.1.cmml">𝒙</mi><mo id="S1.p1.8.m7.3.3.2.5.2.2" stretchy="false" xref="S1.p1.8.m7.3.3.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.8.m7.3b"><apply id="S1.p1.8.m7.3.3.cmml" xref="S1.p1.8.m7.3.3"><csymbol cd="latexml" id="S1.p1.8.m7.3.3.3.cmml" xref="S1.p1.8.m7.3.3.3">proportional-to</csymbol><apply id="S1.p1.8.m7.2.2.1.cmml" xref="S1.p1.8.m7.2.2.1"><times id="S1.p1.8.m7.2.2.1.2.cmml" xref="S1.p1.8.m7.2.2.1.2"></times><ci id="S1.p1.8.m7.2.2.1.3.cmml" xref="S1.p1.8.m7.2.2.1.3">𝑝</ci><apply id="S1.p1.8.m7.2.2.1.1.1.1.cmml" xref="S1.p1.8.m7.2.2.1.1.1"><csymbol cd="latexml" id="S1.p1.8.m7.2.2.1.1.1.1.1.cmml" xref="S1.p1.8.m7.2.2.1.1.1.1.1">conditional</csymbol><ci id="S1.p1.8.m7.2.2.1.1.1.1.2.cmml" xref="S1.p1.8.m7.2.2.1.1.1.1.2">𝒙</ci><ci id="S1.p1.8.m7.2.2.1.1.1.1.3.cmml" xref="S1.p1.8.m7.2.2.1.1.1.1.3">𝒚</ci></apply></apply><apply id="S1.p1.8.m7.3.3.2.cmml" xref="S1.p1.8.m7.3.3.2"><times id="S1.p1.8.m7.3.3.2.2.cmml" xref="S1.p1.8.m7.3.3.2.2"></times><ci id="S1.p1.8.m7.3.3.2.3.cmml" xref="S1.p1.8.m7.3.3.2.3">𝑝</ci><apply id="S1.p1.8.m7.3.3.2.1.1.1.cmml" xref="S1.p1.8.m7.3.3.2.1.1"><csymbol cd="latexml" id="S1.p1.8.m7.3.3.2.1.1.1.1.cmml" xref="S1.p1.8.m7.3.3.2.1.1.1.1">conditional</csymbol><ci id="S1.p1.8.m7.3.3.2.1.1.1.2.cmml" xref="S1.p1.8.m7.3.3.2.1.1.1.2">𝒚</ci><ci id="S1.p1.8.m7.3.3.2.1.1.1.3.cmml" xref="S1.p1.8.m7.3.3.2.1.1.1.3">𝒙</ci></apply><ci id="S1.p1.8.m7.3.3.2.4.cmml" xref="S1.p1.8.m7.3.3.2.4">𝑝</ci><ci id="S1.p1.8.m7.1.1.cmml" xref="S1.p1.8.m7.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.8.m7.3c">p({\bm{x}}|{\bm{y}})\propto p({\bm{y}}|{\bm{x}})p({\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S1.p1.8.m7.3d">italic_p ( bold_italic_x | bold_italic_y ) ∝ italic_p ( bold_italic_y | bold_italic_x ) italic_p ( bold_italic_x )</annotation></semantics></math>. Hence, solving the inverse problem translates into performing a Maximum a Posteriori (MAP) estimation or drawing high-probability samples from the posterior <cite class="ltx_cite ltx_citemacro_citep">(Stuart, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib32" title="">2010</a>)</cite>. Given the forward model <math alttext="p({\bm{y}}|{\bm{x}})" class="ltx_Math" display="inline" id="S1.p1.9.m8.1"><semantics id="S1.p1.9.m8.1a"><mrow id="S1.p1.9.m8.1.1" xref="S1.p1.9.m8.1.1.cmml"><mi id="S1.p1.9.m8.1.1.3" xref="S1.p1.9.m8.1.1.3.cmml">p</mi><mo id="S1.p1.9.m8.1.1.2" xref="S1.p1.9.m8.1.1.2.cmml">⁢</mo><mrow id="S1.p1.9.m8.1.1.1.1" xref="S1.p1.9.m8.1.1.1.1.1.cmml"><mo id="S1.p1.9.m8.1.1.1.1.2" stretchy="false" xref="S1.p1.9.m8.1.1.1.1.1.cmml">(</mo><mrow id="S1.p1.9.m8.1.1.1.1.1" xref="S1.p1.9.m8.1.1.1.1.1.cmml"><mi id="S1.p1.9.m8.1.1.1.1.1.2" xref="S1.p1.9.m8.1.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S1.p1.9.m8.1.1.1.1.1.1" xref="S1.p1.9.m8.1.1.1.1.1.1.cmml">|</mo><mi id="S1.p1.9.m8.1.1.1.1.1.3" xref="S1.p1.9.m8.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S1.p1.9.m8.1.1.1.1.3" stretchy="false" xref="S1.p1.9.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.9.m8.1b"><apply id="S1.p1.9.m8.1.1.cmml" xref="S1.p1.9.m8.1.1"><times id="S1.p1.9.m8.1.1.2.cmml" xref="S1.p1.9.m8.1.1.2"></times><ci id="S1.p1.9.m8.1.1.3.cmml" xref="S1.p1.9.m8.1.1.3">𝑝</ci><apply id="S1.p1.9.m8.1.1.1.1.1.cmml" xref="S1.p1.9.m8.1.1.1.1"><csymbol cd="latexml" id="S1.p1.9.m8.1.1.1.1.1.1.cmml" xref="S1.p1.9.m8.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p1.9.m8.1.1.1.1.1.2.cmml" xref="S1.p1.9.m8.1.1.1.1.1.2">𝒚</ci><ci id="S1.p1.9.m8.1.1.1.1.1.3.cmml" xref="S1.p1.9.m8.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.9.m8.1c">p({\bm{y}}|{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S1.p1.9.m8.1d">italic_p ( bold_italic_y | bold_italic_x )</annotation></semantics></math>, the critical step is to choose the prior <math alttext="p({\bm{x}})" class="ltx_Math" display="inline" id="S1.p1.10.m9.1"><semantics id="S1.p1.10.m9.1a"><mrow id="S1.p1.10.m9.1.2" xref="S1.p1.10.m9.1.2.cmml"><mi id="S1.p1.10.m9.1.2.2" xref="S1.p1.10.m9.1.2.2.cmml">p</mi><mo id="S1.p1.10.m9.1.2.1" xref="S1.p1.10.m9.1.2.1.cmml">⁢</mo><mrow id="S1.p1.10.m9.1.2.3.2" xref="S1.p1.10.m9.1.2.cmml"><mo id="S1.p1.10.m9.1.2.3.2.1" stretchy="false" xref="S1.p1.10.m9.1.2.cmml">(</mo><mi id="S1.p1.10.m9.1.1" xref="S1.p1.10.m9.1.1.cmml">𝒙</mi><mo id="S1.p1.10.m9.1.2.3.2.2" stretchy="false" xref="S1.p1.10.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.10.m9.1b"><apply id="S1.p1.10.m9.1.2.cmml" xref="S1.p1.10.m9.1.2"><times id="S1.p1.10.m9.1.2.1.cmml" xref="S1.p1.10.m9.1.2.1"></times><ci id="S1.p1.10.m9.1.2.2.cmml" xref="S1.p1.10.m9.1.2.2">𝑝</ci><ci id="S1.p1.10.m9.1.1.cmml" xref="S1.p1.10.m9.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.10.m9.1c">p({\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S1.p1.10.m9.1d">italic_p ( bold_italic_x )</annotation></semantics></math>, which is often challenging; one needs domain knowledge to define a prior or a large amount of data to learn it.</p>
</div>
<figure class="ltx_figure ltx_align_center" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="253" id="S1.F1.1.g1" src="extracted/5900490/figures/figure_v100.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S1.F1.5.1">High-level interpretation of Diffusion State-Guided Projected Gradient (DiffStateGrad).</span> DiffStateGrad projects the measurement gradient onto a subspace, defined to capture statistics of the diffusion state at time <math alttext="t" class="ltx_Math" display="inline" id="S1.F1.3.m1.1"><semantics id="S1.F1.3.m1.1b"><mi id="S1.F1.3.m1.1.1" xref="S1.F1.3.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S1.F1.3.m1.1c"><ci id="S1.F1.3.m1.1.1.cmml" xref="S1.F1.3.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.3.m1.1d">t</annotation><annotation encoding="application/x-llamapun" id="S1.F1.3.m1.1e">italic_t</annotation></semantics></math>. This helps the process stay closer to the data manifold during the diffusion process, resulting in better posterior sampling. Without such projection, the measurement gradient pushes the process off the data manifold. The dotted straight line conceptually visualizes the subspace to which the measurement gradient is projected.</figcaption>
</figure>
<figure class="ltx_figure ltx_align_floatright" id="S1.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="166" id="S1.F2.sf1.g1" src="extracted/5900490/figures/rec_high.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Image visualizations.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="308" id="S1.F2.sf2.g1" src="extracted/5900490/figures/z0givent_zt_gt/PSLD_default_highfeedback_z0givent_zt_gt_latent1_1-10-20-30-40-50.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>PSLD diffusion dynamics.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="308" id="S1.F2.sf3.g1" src="extracted/5900490/figures/z0givent_zt_gt/PSLD_lowrank_highfeedback_z0givent_zt_gt_latent1_1-10-20-30-40-50.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>DiffStateGrad-PSLD diffusion dynamics.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S1.F2.2.1">Visualization of DiffStateGrad in removing artifacts.</span> The large MG step size pushes the process away from the manifold in PSLD, while DiffStateGrad-PSLD is unaffected. The title refers to the diffusion steps.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Prior works consider sparse priors and provide a theoretical analysis of conditions for the unique recovery of data, a problem known as compressed sensing <cite class="ltx_cite ltx_citemacro_citep">(Donoho, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib8" title="">2006</a>; Candès et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib2" title="">2006</a>)</cite>. Sparse priors have shown usefulness in medical imaging <cite class="ltx_cite ltx_citemacro_citep">(Lustig et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib18" title="">2007</a>)</cite>, computational neuroscience <cite class="ltx_cite ltx_citemacro_citep">(Olshausen &amp; Field, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib19" title="">1997</a>)</cite>, and engineering applications. This approach is categorized into model-based priors where a structure is assumed on the signal instead of being learned.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.2">Recent literature goes beyond such model-based priors and leverages information from data. The latest works employ generative diffusion models <cite class="ltx_cite ltx_citemacro_citep">(Song &amp; Ermon, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib30" title="">2019</a>; Kadkhodaie &amp; Simoncelli, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib13" title="">2021</a>)</cite>, which implicitly learn the data prior <math alttext="p({\bm{x}})" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mrow id="S1.p3.1.m1.1.2" xref="S1.p3.1.m1.1.2.cmml"><mi id="S1.p3.1.m1.1.2.2" xref="S1.p3.1.m1.1.2.2.cmml">p</mi><mo id="S1.p3.1.m1.1.2.1" xref="S1.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S1.p3.1.m1.1.2.3.2" xref="S1.p3.1.m1.1.2.cmml"><mo id="S1.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S1.p3.1.m1.1.2.cmml">(</mo><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">𝒙</mi><mo id="S1.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.2.cmml" xref="S1.p3.1.m1.1.2"><times id="S1.p3.1.m1.1.2.1.cmml" xref="S1.p3.1.m1.1.2.1"></times><ci id="S1.p3.1.m1.1.2.2.cmml" xref="S1.p3.1.m1.1.2.2">𝑝</ci><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">p({\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_p ( bold_italic_x )</annotation></semantics></math> by learning a process that transforms noise into samples from a complex data distribution. For inverse problems, this reverse generation process is guided by the likelihood <math alttext="p({\bm{y}}|{\bm{x}})" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><mrow id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml"><mi id="S1.p3.2.m2.1.1.3" xref="S1.p3.2.m2.1.1.3.cmml">p</mi><mo id="S1.p3.2.m2.1.1.2" xref="S1.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="S1.p3.2.m2.1.1.1.1" xref="S1.p3.2.m2.1.1.1.1.1.cmml"><mo id="S1.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S1.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S1.p3.2.m2.1.1.1.1.1" xref="S1.p3.2.m2.1.1.1.1.1.cmml"><mi id="S1.p3.2.m2.1.1.1.1.1.2" xref="S1.p3.2.m2.1.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S1.p3.2.m2.1.1.1.1.1.1" xref="S1.p3.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S1.p3.2.m2.1.1.1.1.1.3" xref="S1.p3.2.m2.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S1.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S1.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><apply id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1"><times id="S1.p3.2.m2.1.1.2.cmml" xref="S1.p3.2.m2.1.1.2"></times><ci id="S1.p3.2.m2.1.1.3.cmml" xref="S1.p3.2.m2.1.1.3">𝑝</ci><apply id="S1.p3.2.m2.1.1.1.1.1.cmml" xref="S1.p3.2.m2.1.1.1.1"><csymbol cd="latexml" id="S1.p3.2.m2.1.1.1.1.1.1.cmml" xref="S1.p3.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p3.2.m2.1.1.1.1.1.2.cmml" xref="S1.p3.2.m2.1.1.1.1.1.2">𝒚</ci><ci id="S1.p3.2.m2.1.1.1.1.1.3.cmml" xref="S1.p3.2.m2.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">p({\bm{y}}|{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">italic_p ( bold_italic_y | bold_italic_x )</annotation></semantics></math>, forming a denoiser posterior, to generate data-consistent samples. While diffusion models show state-of-the-art performance, they still face challenges in solving inverse problems.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.2">The main challenge arises since the denoiser posterior, specifically the likelihood component <math alttext="p({\bm{y}}|{\bm{x}})" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mrow id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">p</mi><mo id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S1.p4.1.m1.1.1.1.1" xref="S1.p4.1.m1.1.1.1.1.1.cmml"><mo id="S1.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S1.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S1.p4.1.m1.1.1.1.1.1" xref="S1.p4.1.m1.1.1.1.1.1.cmml"><mi id="S1.p4.1.m1.1.1.1.1.1.2" xref="S1.p4.1.m1.1.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S1.p4.1.m1.1.1.1.1.1.1" xref="S1.p4.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S1.p4.1.m1.1.1.1.1.1.3" xref="S1.p4.1.m1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S1.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><times id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2"></times><ci id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3">𝑝</ci><apply id="S1.p4.1.m1.1.1.1.1.1.cmml" xref="S1.p4.1.m1.1.1.1.1"><csymbol cd="latexml" id="S1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S1.p4.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.1.1.1.2">𝒚</ci><ci id="S1.p4.1.m1.1.1.1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">p({\bm{y}}|{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">italic_p ( bold_italic_y | bold_italic_x )</annotation></semantics></math>, is intractable since the diffusion is trained unconditionally <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib31" title="">2021</a>)</cite>. Prior work addresses this challenge by proposing various approximations or projections to the gradient related to the measurement likelihood <math alttext="p({\bm{y}}|{\bm{x}})" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mrow id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml"><mi id="S1.p4.2.m2.1.1.3" xref="S1.p4.2.m2.1.1.3.cmml">p</mi><mo id="S1.p4.2.m2.1.1.2" xref="S1.p4.2.m2.1.1.2.cmml">⁢</mo><mrow id="S1.p4.2.m2.1.1.1.1" xref="S1.p4.2.m2.1.1.1.1.1.cmml"><mo id="S1.p4.2.m2.1.1.1.1.2" stretchy="false" xref="S1.p4.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S1.p4.2.m2.1.1.1.1.1" xref="S1.p4.2.m2.1.1.1.1.1.cmml"><mi id="S1.p4.2.m2.1.1.1.1.1.2" xref="S1.p4.2.m2.1.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S1.p4.2.m2.1.1.1.1.1.1" xref="S1.p4.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S1.p4.2.m2.1.1.1.1.1.3" xref="S1.p4.2.m2.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S1.p4.2.m2.1.1.1.1.3" stretchy="false" xref="S1.p4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><apply id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"><times id="S1.p4.2.m2.1.1.2.cmml" xref="S1.p4.2.m2.1.1.2"></times><ci id="S1.p4.2.m2.1.1.3.cmml" xref="S1.p4.2.m2.1.1.3">𝑝</ci><apply id="S1.p4.2.m2.1.1.1.1.1.cmml" xref="S1.p4.2.m2.1.1.1.1"><csymbol cd="latexml" id="S1.p4.2.m2.1.1.1.1.1.1.cmml" xref="S1.p4.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p4.2.m2.1.1.1.1.1.2.cmml" xref="S1.p4.2.m2.1.1.1.1.1.2">𝒚</ci><ci id="S1.p4.2.m2.1.1.1.1.1.3.cmml" xref="S1.p4.2.m2.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">p({\bm{y}}|{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">italic_p ( bold_italic_y | bold_italic_x )</annotation></semantics></math> to achieve likely solutions <cite class="ltx_cite ltx_citemacro_citep">(Kawar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib15" title="">2022</a>)</cite>; when these approximations are not valid, it results in inaccurate posterior sampling and the introduction of “artifacts” in the reconstructed data <cite class="ltx_cite ltx_citemacro_citep">(Chung et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib4" title="">2023</a>)</cite>. <em class="ltx_emph ltx_font_italic" id="S1.p4.2.1">Latent</em> diffusion models (LDMs) <cite class="ltx_cite ltx_citemacro_citep">(Rombach et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib22" title="">2022</a>)</cite>, due to the nonlinearity of the latent-to-pixel decoder, further exacerbate this challenge. Besides this approximation, the lack of robustness of diffusion models to the measurement gradient step size <cite class="ltx_cite ltx_citemacro_citep">(Peng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib20" title="">2024</a>)</cite> and the measurement noise, and the lack of guarantees for worst-case performance limits their practical applications for inverse problems.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.3"><span class="ltx_text ltx_font_bold" id="S1.p5.3.1">Our contributions:</span> We propose a <span class="ltx_text ltx_font_italic" id="S1.p5.3.2">Diffusion State-Guided Projected Gradient</span> (DiffStateGrad) to address the challenge of staying on the data manifold in solving inverse problems. We focus on gradient-based measurement guidance approaches that use the measurement as guidance to move the intermediate diffusion state <math alttext="{\bm{x}}_{t}" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><msub id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml"><mi id="S1.p5.1.m1.1.1.2" xref="S1.p5.1.m1.1.1.2.cmml">𝒙</mi><mi id="S1.p5.1.m1.1.1.3" xref="S1.p5.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><apply id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p5.1.m1.1.1.1.cmml" xref="S1.p5.1.m1.1.1">subscript</csymbol><ci id="S1.p5.1.m1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.2">𝒙</ci><ci id="S1.p5.1.m1.1.1.3.cmml" xref="S1.p5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">{\bm{x}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> toward high-probability regions of the posterior. DiffStateGrad projects the measurement guidance gradient onto a low-rank subspace, capturing the learned prior at time <math alttext="t" class="ltx_Math" display="inline" id="S1.p5.2.m2.1"><semantics id="S1.p5.2.m2.1a"><mi id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><ci id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S1.p5.2.m2.1d">italic_t</annotation></semantics></math> in the diffusion process (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S1.F1" title="In 1 Introduction ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>). We visualize how the diffusion process is pushed off the manifold when the measurement step size is relatively large in a diffusion model and how the incorporation of DiffStateGrad alleviates this challenge (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S1.F2" title="In 1 Introduction ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a>). We perform singular value decomposition (SVD) on the intermediate diffusion state of an image and use the <math alttext="r" class="ltx_Math" display="inline" id="S1.p5.3.m3.1"><semantics id="S1.p5.3.m3.1a"><mi id="S1.p5.3.m3.1.1" xref="S1.p5.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S1.p5.3.m3.1b"><ci id="S1.p5.3.m3.1.1.cmml" xref="S1.p5.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.3.m3.1c">r</annotation><annotation encoding="application/x-llamapun" id="S1.p5.3.m3.1d">italic_r</annotation></semantics></math> highest contributing singular vectors as a choice of our projection matrix; by projecting the measurement gradient onto our proposed subspace, we aim to remove the directions orthogonal to the local manifold structure.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We show that the crucial factor is the choice of the subspace, not the low-rank nature of the subspace projection. We find that our DiffStateGrad projection enhances performance, in contrast to random subspace projections and low-rank approximations of the measurement gradient (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S1.T1" title="In 1 Introduction ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We theoretically prove how DiffStateGrad helps the samples remain on or close to the manifold, hence improving reconstruction quality (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S3.Thmproposition1" title="Proposition 1. ‣ 3 Diffusion State-Guided Projected Gradient (DiffStateGrad) ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.4">We demonstrate that DiffStateGrad increases the robustness of diffusion models to the measurement guidance gradient step size (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.F6" title="In 4.1 Experimental Setup ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A1.T7" title="In Appendix A Additional Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">7</span></a>) and the measurement noise (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.F7" title="In 4.1 Experimental Setup ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">7</span></a>). For example, for a large step size, DiffStateGrad drastically improves the LPIPS of PSLD <cite class="ltx_cite ltx_citemacro_citep">(Rout et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib23" title="">2023</a>)</cite> from <math alttext="0.463" class="ltx_Math" display="inline" id="S1.I1.i3.p1.1.m1.1"><semantics id="S1.I1.i3.p1.1.m1.1a"><mn id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml">0.463</mn><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><cn id="S1.I1.i3.p1.1.m1.1.1.cmml" type="float" xref="S1.I1.i3.p1.1.m1.1.1">0.463</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">0.463</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.m1.1d">0.463</annotation></semantics></math> to <math alttext="0.165" class="ltx_Math" display="inline" id="S1.I1.i3.p1.2.m2.1"><semantics id="S1.I1.i3.p1.2.m2.1a"><mn id="S1.I1.i3.p1.2.m2.1.1" xref="S1.I1.i3.p1.2.m2.1.1.cmml">0.165</mn><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.2.m2.1b"><cn id="S1.I1.i3.p1.2.m2.1.1.cmml" type="float" xref="S1.I1.i3.p1.2.m2.1.1">0.165</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.2.m2.1c">0.165</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.2.m2.1d">0.165</annotation></semantics></math> on random inpainting. For large measurement noise, DiffStateGrad improves the SSIM of DAPS <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib39" title="">2024</a>)</cite> from <math alttext="0.436" class="ltx_Math" display="inline" id="S1.I1.i3.p1.3.m3.1"><semantics id="S1.I1.i3.p1.3.m3.1a"><mn id="S1.I1.i3.p1.3.m3.1.1" xref="S1.I1.i3.p1.3.m3.1.1.cmml">0.436</mn><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.3.m3.1b"><cn id="S1.I1.i3.p1.3.m3.1.1.cmml" type="float" xref="S1.I1.i3.p1.3.m3.1.1">0.436</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.3.m3.1c">0.436</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.3.m3.1d">0.436</annotation></semantics></math> to <math alttext="0.705" class="ltx_Math" display="inline" id="S1.I1.i3.p1.4.m4.1"><semantics id="S1.I1.i3.p1.4.m4.1a"><mn id="S1.I1.i3.p1.4.m4.1.1" xref="S1.I1.i3.p1.4.m4.1.1.cmml">0.705</mn><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.4.m4.1b"><cn id="S1.I1.i3.p1.4.m4.1.1.cmml" type="float" xref="S1.I1.i3.p1.4.m4.1.1">0.705</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.4.m4.1c">0.705</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.4.m4.1d">0.705</annotation></semantics></math> on box inpainting.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.3">We empirically show that DiffStateGrad improves the worst-case performance of the diffusion model, e.g., significantly reducing the failure rate (PSNR <math alttext="&lt;20" class="ltx_Math" display="inline" id="S1.I1.i4.p1.1.m1.1"><semantics id="S1.I1.i4.p1.1.m1.1a"><mrow id="S1.I1.i4.p1.1.m1.1.1" xref="S1.I1.i4.p1.1.m1.1.1.cmml"><mi id="S1.I1.i4.p1.1.m1.1.1.2" xref="S1.I1.i4.p1.1.m1.1.1.2.cmml"></mi><mo id="S1.I1.i4.p1.1.m1.1.1.1" xref="S1.I1.i4.p1.1.m1.1.1.1.cmml">&lt;</mo><mn id="S1.I1.i4.p1.1.m1.1.1.3" xref="S1.I1.i4.p1.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i4.p1.1.m1.1b"><apply id="S1.I1.i4.p1.1.m1.1.1.cmml" xref="S1.I1.i4.p1.1.m1.1.1"><lt id="S1.I1.i4.p1.1.m1.1.1.1.cmml" xref="S1.I1.i4.p1.1.m1.1.1.1"></lt><csymbol cd="latexml" id="S1.I1.i4.p1.1.m1.1.1.2.cmml" xref="S1.I1.i4.p1.1.m1.1.1.2">absent</csymbol><cn id="S1.I1.i4.p1.1.m1.1.1.3.cmml" type="integer" xref="S1.I1.i4.p1.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i4.p1.1.m1.1c">&lt;20</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i4.p1.1.m1.1d">&lt; 20</annotation></semantics></math>) from <math alttext="26\%" class="ltx_Math" display="inline" id="S1.I1.i4.p1.2.m2.1"><semantics id="S1.I1.i4.p1.2.m2.1a"><mrow id="S1.I1.i4.p1.2.m2.1.1" xref="S1.I1.i4.p1.2.m2.1.1.cmml"><mn id="S1.I1.i4.p1.2.m2.1.1.2" xref="S1.I1.i4.p1.2.m2.1.1.2.cmml">26</mn><mo id="S1.I1.i4.p1.2.m2.1.1.1" xref="S1.I1.i4.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i4.p1.2.m2.1b"><apply id="S1.I1.i4.p1.2.m2.1.1.cmml" xref="S1.I1.i4.p1.2.m2.1.1"><csymbol cd="latexml" id="S1.I1.i4.p1.2.m2.1.1.1.cmml" xref="S1.I1.i4.p1.2.m2.1.1.1">percent</csymbol><cn id="S1.I1.i4.p1.2.m2.1.1.2.cmml" type="integer" xref="S1.I1.i4.p1.2.m2.1.1.2">26</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i4.p1.2.m2.1c">26\%</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i4.p1.2.m2.1d">26 %</annotation></semantics></math> to <math alttext="4\%" class="ltx_Math" display="inline" id="S1.I1.i4.p1.3.m3.1"><semantics id="S1.I1.i4.p1.3.m3.1a"><mrow id="S1.I1.i4.p1.3.m3.1.1" xref="S1.I1.i4.p1.3.m3.1.1.cmml"><mn id="S1.I1.i4.p1.3.m3.1.1.2" xref="S1.I1.i4.p1.3.m3.1.1.2.cmml">4</mn><mo id="S1.I1.i4.p1.3.m3.1.1.1" xref="S1.I1.i4.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i4.p1.3.m3.1b"><apply id="S1.I1.i4.p1.3.m3.1.1.cmml" xref="S1.I1.i4.p1.3.m3.1.1"><csymbol cd="latexml" id="S1.I1.i4.p1.3.m3.1.1.1.cmml" xref="S1.I1.i4.p1.3.m3.1.1.1">percent</csymbol><cn id="S1.I1.i4.p1.3.m3.1.1.2.cmml" type="integer" xref="S1.I1.i4.p1.3.m3.1.1.2">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i4.p1.3.m3.1c">4\%</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i4.p1.3.m3.1d">4 %</annotation></semantics></math> on the phase retrieval task, increasing their reliability (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S2.F3" title="In 2 Background &amp; Related Works ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a>). DiffStateGrad consistently shows lower standard deviation across the test datasets than state-of-the-art methods.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i5.p1">
<p class="ltx_p" id="S1.I1.i5.p1.2">We demonstrate that DiffStateGrad significantly improves the performance of state-of-the-art (SOTA) methods, especially in challenging tasks such as phase retrieval and high dynamic range reconstruction. For example, DiffStateGrad improves the PSNR of ReSample <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib28" title="">2023a</a>)</cite> from <math alttext="27.61(8.07)" class="ltx_Math" display="inline" id="S1.I1.i5.p1.1.m1.1"><semantics id="S1.I1.i5.p1.1.m1.1a"><mrow id="S1.I1.i5.p1.1.m1.1.2" xref="S1.I1.i5.p1.1.m1.1.2.cmml"><mn id="S1.I1.i5.p1.1.m1.1.2.2" xref="S1.I1.i5.p1.1.m1.1.2.2.cmml">27.61</mn><mo id="S1.I1.i5.p1.1.m1.1.2.1" xref="S1.I1.i5.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S1.I1.i5.p1.1.m1.1.2.3.2" xref="S1.I1.i5.p1.1.m1.1.2.cmml"><mo id="S1.I1.i5.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S1.I1.i5.p1.1.m1.1.2.cmml">(</mo><mn id="S1.I1.i5.p1.1.m1.1.1" xref="S1.I1.i5.p1.1.m1.1.1.cmml">8.07</mn><mo id="S1.I1.i5.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S1.I1.i5.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i5.p1.1.m1.1b"><apply id="S1.I1.i5.p1.1.m1.1.2.cmml" xref="S1.I1.i5.p1.1.m1.1.2"><times id="S1.I1.i5.p1.1.m1.1.2.1.cmml" xref="S1.I1.i5.p1.1.m1.1.2.1"></times><cn id="S1.I1.i5.p1.1.m1.1.2.2.cmml" type="float" xref="S1.I1.i5.p1.1.m1.1.2.2">27.61</cn><cn id="S1.I1.i5.p1.1.m1.1.1.cmml" type="float" xref="S1.I1.i5.p1.1.m1.1.1">8.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i5.p1.1.m1.1c">27.61(8.07)</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i5.p1.1.m1.1d">27.61 ( 8.07 )</annotation></semantics></math> to <math alttext="31.19(4.33)" class="ltx_Math" display="inline" id="S1.I1.i5.p1.2.m2.1"><semantics id="S1.I1.i5.p1.2.m2.1a"><mrow id="S1.I1.i5.p1.2.m2.1.2" xref="S1.I1.i5.p1.2.m2.1.2.cmml"><mn id="S1.I1.i5.p1.2.m2.1.2.2" xref="S1.I1.i5.p1.2.m2.1.2.2.cmml">31.19</mn><mo id="S1.I1.i5.p1.2.m2.1.2.1" xref="S1.I1.i5.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S1.I1.i5.p1.2.m2.1.2.3.2" xref="S1.I1.i5.p1.2.m2.1.2.cmml"><mo id="S1.I1.i5.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S1.I1.i5.p1.2.m2.1.2.cmml">(</mo><mn id="S1.I1.i5.p1.2.m2.1.1" xref="S1.I1.i5.p1.2.m2.1.1.cmml">4.33</mn><mo id="S1.I1.i5.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S1.I1.i5.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i5.p1.2.m2.1b"><apply id="S1.I1.i5.p1.2.m2.1.2.cmml" xref="S1.I1.i5.p1.2.m2.1.2"><times id="S1.I1.i5.p1.2.m2.1.2.1.cmml" xref="S1.I1.i5.p1.2.m2.1.2.1"></times><cn id="S1.I1.i5.p1.2.m2.1.2.2.cmml" type="float" xref="S1.I1.i5.p1.2.m2.1.2.2">31.19</cn><cn id="S1.I1.i5.p1.2.m2.1.1.cmml" type="float" xref="S1.I1.i5.p1.2.m2.1.1">4.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i5.p1.2.m2.1c">31.19(4.33)</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i5.p1.2.m2.1d">31.19 ( 4.33 )</annotation></semantics></math> for phase retrieval, reporting mean (std). Our experiments cover a wide range of linear inverse problems of box inpainting, random inpainting, Gaussian deblur, motion deblur, and super-resolution (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.T2" title="In 4.2 Robustness ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Tables</span> <span class="ltx_text ltx_ref_tag">2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.T3" title="Table 3 ‣ 4.2 Robustness ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.T5" title="Table 5 ‣ 4.3 Performance ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">5</span></a>) and nonlinear inverse problems of phase retrieval, nonlinear deblur, and high dynamic range (HDR) (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.T4" title="In 4.3 Performance ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a>) for image restoration tasks.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table ltx_align_floatright" id="S1.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S1.T1.3" style="width:433.2pt;height:177.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(106.5pt,-43.6pt) scale(1.96826595824412,1.96826595824412) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S1.T1.3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S1.T1.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S1.T1.3.3.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">Projection Subspace</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S1.T1.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S1.T1.1.1.1.1.m1.1"><semantics id="S1.T1.1.1.1.1.m1.1a"><mo id="S1.T1.1.1.1.1.m1.1.1" stretchy="false" xref="S1.T1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S1.T1.1.1.1.1.m1.1b"><ci id="S1.T1.1.1.1.1.m1.1.1.cmml" xref="S1.T1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S1.T1.1.1.1.1.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S1.T1.2.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S1.T1.2.2.2.2.m1.1"><semantics id="S1.T1.2.2.2.2.m1.1a"><mo id="S1.T1.2.2.2.2.m1.1.1" stretchy="false" xref="S1.T1.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S1.T1.2.2.2.2.m1.1b"><ci id="S1.T1.2.2.2.2.m1.1.1.cmml" xref="S1.T1.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S1.T1.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S1.T1.3.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S1.T1.3.3.3.3.m1.1"><semantics id="S1.T1.3.3.3.3.m1.1a"><mo id="S1.T1.3.3.3.3.m1.1.1" stretchy="false" xref="S1.T1.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S1.T1.3.3.3.3.m1.1b"><ci id="S1.T1.3.3.3.3.m1.1.1.cmml" xref="S1.T1.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S1.T1.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
<tr class="ltx_tr" id="S1.T1.3.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S1.T1.3.3.4.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">No Projection</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S1.T1.3.3.4.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.246</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S1.T1.3.3.4.1.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S1.T1.3.3.4.1.3.1">0.809</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S1.T1.3.3.4.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">29.05</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S1.T1.3.3.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S1.T1.3.3.5.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Random matrix</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T1.3.3.5.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.299</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T1.3.3.5.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.753</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T1.3.3.5.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">27.30</td>
</tr>
<tr class="ltx_tr" id="S1.T1.3.3.6.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S1.T1.3.3.6.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">Measurement gradient</th>
<td class="ltx_td ltx_align_center" id="S1.T1.3.3.6.2.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S1.T1.3.3.6.2.2.1">0.242</span></td>
<td class="ltx_td ltx_align_center" id="S1.T1.3.3.6.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.808</td>
<td class="ltx_td ltx_align_center" id="S1.T1.3.3.6.2.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S1.T1.3.3.6.2.4.1">29.21</span></td>
</tr>
<tr class="ltx_tr" id="S1.T1.3.3.7.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S1.T1.3.3.7.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S1.T1.3.3.7.3.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S1.T1.3.3.7.3.2.1">0.165</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S1.T1.3.3.7.3.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S1.T1.3.3.7.3.3.1">0.898</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S1.T1.3.3.7.3.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S1.T1.3.3.7.3.4.1">31.68</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_bold" id="S1.T1.7.1">Advantage of diffusion state-guided projection.</span> Results are from random inpainting on FFHQ <math alttext="256\times 256" class="ltx_Math" display="inline" id="S1.T1.5.m1.1"><semantics id="S1.T1.5.m1.1b"><mrow id="S1.T1.5.m1.1.1" xref="S1.T1.5.m1.1.1.cmml"><mn id="S1.T1.5.m1.1.1.2" xref="S1.T1.5.m1.1.1.2.cmml">256</mn><mo id="S1.T1.5.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S1.T1.5.m1.1.1.1.cmml">×</mo><mn id="S1.T1.5.m1.1.1.3" xref="S1.T1.5.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.5.m1.1c"><apply id="S1.T1.5.m1.1.1.cmml" xref="S1.T1.5.m1.1.1"><times id="S1.T1.5.m1.1.1.1.cmml" xref="S1.T1.5.m1.1.1.1"></times><cn id="S1.T1.5.m1.1.1.2.cmml" type="integer" xref="S1.T1.5.m1.1.1.2">256</cn><cn id="S1.T1.5.m1.1.1.3.cmml" type="integer" xref="S1.T1.5.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.5.m1.1d">256\times 256</annotation><annotation encoding="application/x-llamapun" id="S1.T1.5.m1.1e">256 × 256</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background &amp; Related Works</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Learning-based priors.</span> These methods leverage data structures captured by a pre-trained denoiser <cite class="ltx_cite ltx_citemacro_citep">(Romano et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib21" title="">2017</a>)</cite> as plug-and-play priors <cite class="ltx_cite ltx_citemacro_citep">(Venkatakrishnan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib35" title="">2013</a>)</cite>, or deep generative models such as variational autoencoders (VAEs)
 <cite class="ltx_cite ltx_citemacro_citep">(Kingma, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib16" title="">2013</a>)</cite> and generative adversarial networks (GANs) <cite class="ltx_cite ltx_citemacro_citep">(Goodfellow et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib10" title="">2014</a>)</cite> to solve inverse problems <cite class="ltx_cite ltx_citemacro_citep">(Bora et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib1" title="">2017</a>; Ulyanov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib34" title="">2018</a>)</cite>. The state-of-the-art is based on generative diffusion models, which have shown promising performance in generating high-quality samples in computer vision <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib29" title="">2023b</a>)</cite>, solving PDEs <cite class="ltx_cite ltx_citemacro_citep">(Shu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib27" title="">2023</a>)</cite>, and high-energy physics <cite class="ltx_cite ltx_citemacro_citep">(Shmakov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib26" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.3"><span class="ltx_text ltx_font_bold" id="S2.p2.3.1">Diffusion models.</span> Diffusion models conceptualize the generation of data as the reverse of a noising process, where a data sample <math alttext="{\bm{x}}_{t}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><msub id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">𝒙</mi><mi id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">𝒙</ci><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">{\bm{x}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at time <math alttext="t" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_t</annotation></semantics></math> within the interval <math alttext="[0,T]" class="ltx_Math" display="inline" id="S2.p2.3.m3.2"><semantics id="S2.p2.3.m3.2a"><mrow id="S2.p2.3.m3.2.3.2" xref="S2.p2.3.m3.2.3.1.cmml"><mo id="S2.p2.3.m3.2.3.2.1" stretchy="false" xref="S2.p2.3.m3.2.3.1.cmml">[</mo><mn id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">0</mn><mo id="S2.p2.3.m3.2.3.2.2" xref="S2.p2.3.m3.2.3.1.cmml">,</mo><mi id="S2.p2.3.m3.2.2" xref="S2.p2.3.m3.2.2.cmml">T</mi><mo id="S2.p2.3.m3.2.3.2.3" stretchy="false" xref="S2.p2.3.m3.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.2b"><interval closure="closed" id="S2.p2.3.m3.2.3.1.cmml" xref="S2.p2.3.m3.2.3.2"><cn id="S2.p2.3.m3.1.1.cmml" type="integer" xref="S2.p2.3.m3.1.1">0</cn><ci id="S2.p2.3.m3.2.2.cmml" xref="S2.p2.3.m3.2.2">𝑇</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.2c">[0,T]</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.2d">[ 0 , italic_T ]</annotation></semantics></math> follows a specified stochastic differential equation (SDE). This SDE <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib31" title="">2021</a>)</cite> for the data noising process is described by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d{\bm{x}}=-\frac{\beta_{t}}{2}{\bm{x}}\,dt+\sqrt{\beta_{t}}\,d{\bm{w}}," class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.2.2.cmml">d</mi><mo id="S2.E2.m1.1.1.1.1.2.1" xref="S2.E2.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.2.3.cmml">𝒙</mi></mrow><mo id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml"><mrow id="S2.E2.m1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.3.2.cmml"><mo id="S2.E2.m1.1.1.1.1.3.2a" xref="S2.E2.m1.1.1.1.1.3.2.cmml">−</mo><mrow id="S2.E2.m1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.cmml"><mfrac id="S2.E2.m1.1.1.1.1.3.2.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.2.cmml"><msub id="S2.E2.m1.1.1.1.1.3.2.2.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.2.cmml">β</mi><mi id="S2.E2.m1.1.1.1.1.3.2.2.2.2.3" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.cmml">t</mi></msub><mn id="S2.E2.m1.1.1.1.1.3.2.2.2.3" xref="S2.E2.m1.1.1.1.1.3.2.2.2.3.cmml">2</mn></mfrac><mo id="S2.E2.m1.1.1.1.1.3.2.2.1" xref="S2.E2.m1.1.1.1.1.3.2.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.2.2.3" xref="S2.E2.m1.1.1.1.1.3.2.2.3.cmml">𝒙</mi><mo id="S2.E2.m1.1.1.1.1.3.2.2.1a" lspace="0.170em" xref="S2.E2.m1.1.1.1.1.3.2.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.2.2.4" xref="S2.E2.m1.1.1.1.1.3.2.2.4.cmml">d</mi><mo id="S2.E2.m1.1.1.1.1.3.2.2.1b" xref="S2.E2.m1.1.1.1.1.3.2.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.2.2.5" xref="S2.E2.m1.1.1.1.1.3.2.2.5.cmml">t</mi></mrow></mrow><mo id="S2.E2.m1.1.1.1.1.3.1" xref="S2.E2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E2.m1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.3.3.cmml"><msqrt id="S2.E2.m1.1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.1.3.3.2.cmml"><msub id="S2.E2.m1.1.1.1.1.3.3.2.2" xref="S2.E2.m1.1.1.1.1.3.3.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.3.2.2.2" xref="S2.E2.m1.1.1.1.1.3.3.2.2.2.cmml">β</mi><mi id="S2.E2.m1.1.1.1.1.3.3.2.2.3" xref="S2.E2.m1.1.1.1.1.3.3.2.2.3.cmml">t</mi></msub></msqrt><mo id="S2.E2.m1.1.1.1.1.3.3.1" lspace="0.170em" xref="S2.E2.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.cmml">d</mi><mo id="S2.E2.m1.1.1.1.1.3.3.1a" xref="S2.E2.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.3.4" xref="S2.E2.m1.1.1.1.1.3.3.4.cmml">𝒘</mi></mrow></mrow></mrow><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><eq id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"></eq><apply id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"><times id="S2.E2.m1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1"></times><ci id="S2.E2.m1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2">𝑑</ci><ci id="S2.E2.m1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3">𝒙</ci></apply><apply id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"><plus id="S2.E2.m1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.1"></plus><apply id="S2.E2.m1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2"><minus id="S2.E2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2"></minus><apply id="S2.E2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2"><times id="S2.E2.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.1"></times><apply id="S2.E2.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2"><divide id="S2.E2.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2"></divide><apply id="S2.E2.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.2">𝛽</ci><ci id="S2.E2.m1.1.1.1.1.3.2.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2.2.3">𝑡</ci></apply><cn id="S2.E2.m1.1.1.1.1.3.2.2.2.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.3.2.2.2.3">2</cn></apply><ci id="S2.E2.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3">𝒙</ci><ci id="S2.E2.m1.1.1.1.1.3.2.2.4.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.4">𝑑</ci><ci id="S2.E2.m1.1.1.1.1.3.2.2.5.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.5">𝑡</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3"><times id="S2.E2.m1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.1"></times><apply id="S2.E2.m1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2"><root id="S2.E2.m1.1.1.1.1.3.3.2a.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2"></root><apply id="S2.E2.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.2.2">𝛽</ci><ci id="S2.E2.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.2.3">𝑡</ci></apply></apply><ci id="S2.E2.m1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3">𝑑</ci><ci id="S2.E2.m1.1.1.1.1.3.3.4.cmml" xref="S2.E2.m1.1.1.1.1.3.3.4">𝒘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">d{\bm{x}}=-\frac{\beta_{t}}{2}{\bm{x}}\,dt+\sqrt{\beta_{t}}\,d{\bm{w}},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">italic_d bold_italic_x = - divide start_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG bold_italic_x italic_d italic_t + square-root start_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_d bold_italic_w ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p2.9">where <math alttext="\beta_{t}\in(0,1)" class="ltx_Math" display="inline" id="S2.p2.4.m1.2"><semantics id="S2.p2.4.m1.2a"><mrow id="S2.p2.4.m1.2.3" xref="S2.p2.4.m1.2.3.cmml"><msub id="S2.p2.4.m1.2.3.2" xref="S2.p2.4.m1.2.3.2.cmml"><mi id="S2.p2.4.m1.2.3.2.2" xref="S2.p2.4.m1.2.3.2.2.cmml">β</mi><mi id="S2.p2.4.m1.2.3.2.3" xref="S2.p2.4.m1.2.3.2.3.cmml">t</mi></msub><mo id="S2.p2.4.m1.2.3.1" xref="S2.p2.4.m1.2.3.1.cmml">∈</mo><mrow id="S2.p2.4.m1.2.3.3.2" xref="S2.p2.4.m1.2.3.3.1.cmml"><mo id="S2.p2.4.m1.2.3.3.2.1" stretchy="false" xref="S2.p2.4.m1.2.3.3.1.cmml">(</mo><mn id="S2.p2.4.m1.1.1" xref="S2.p2.4.m1.1.1.cmml">0</mn><mo id="S2.p2.4.m1.2.3.3.2.2" xref="S2.p2.4.m1.2.3.3.1.cmml">,</mo><mn id="S2.p2.4.m1.2.2" xref="S2.p2.4.m1.2.2.cmml">1</mn><mo id="S2.p2.4.m1.2.3.3.2.3" stretchy="false" xref="S2.p2.4.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m1.2b"><apply id="S2.p2.4.m1.2.3.cmml" xref="S2.p2.4.m1.2.3"><in id="S2.p2.4.m1.2.3.1.cmml" xref="S2.p2.4.m1.2.3.1"></in><apply id="S2.p2.4.m1.2.3.2.cmml" xref="S2.p2.4.m1.2.3.2"><csymbol cd="ambiguous" id="S2.p2.4.m1.2.3.2.1.cmml" xref="S2.p2.4.m1.2.3.2">subscript</csymbol><ci id="S2.p2.4.m1.2.3.2.2.cmml" xref="S2.p2.4.m1.2.3.2.2">𝛽</ci><ci id="S2.p2.4.m1.2.3.2.3.cmml" xref="S2.p2.4.m1.2.3.2.3">𝑡</ci></apply><interval closure="open" id="S2.p2.4.m1.2.3.3.1.cmml" xref="S2.p2.4.m1.2.3.3.2"><cn id="S2.p2.4.m1.1.1.cmml" type="integer" xref="S2.p2.4.m1.1.1">0</cn><cn id="S2.p2.4.m1.2.2.cmml" type="integer" xref="S2.p2.4.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m1.2c">\beta_{t}\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m1.2d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ ( 0 , 1 )</annotation></semantics></math> is a positive, monotonically increasing function of time <math alttext="t" class="ltx_Math" display="inline" id="S2.p2.5.m2.1"><semantics id="S2.p2.5.m2.1a"><mi id="S2.p2.5.m2.1.1" xref="S2.p2.5.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p2.5.m2.1b"><ci id="S2.p2.5.m2.1.1.cmml" xref="S2.p2.5.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m2.1d">italic_t</annotation></semantics></math>, and <math alttext="{\bm{w}}" class="ltx_Math" display="inline" id="S2.p2.6.m3.1"><semantics id="S2.p2.6.m3.1a"><mi id="S2.p2.6.m3.1.1" xref="S2.p2.6.m3.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.p2.6.m3.1b"><ci id="S2.p2.6.m3.1.1.cmml" xref="S2.p2.6.m3.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m3.1c">{\bm{w}}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m3.1d">bold_italic_w</annotation></semantics></math> represents a standard Wiener process. The process begins with an initial data distribution <math alttext="{\bm{x}}_{0}\sim p_{\text{data}}" class="ltx_Math" display="inline" id="S2.p2.7.m4.1"><semantics id="S2.p2.7.m4.1a"><mrow id="S2.p2.7.m4.1.1" xref="S2.p2.7.m4.1.1.cmml"><msub id="S2.p2.7.m4.1.1.2" xref="S2.p2.7.m4.1.1.2.cmml"><mi id="S2.p2.7.m4.1.1.2.2" xref="S2.p2.7.m4.1.1.2.2.cmml">𝒙</mi><mn id="S2.p2.7.m4.1.1.2.3" xref="S2.p2.7.m4.1.1.2.3.cmml">0</mn></msub><mo id="S2.p2.7.m4.1.1.1" xref="S2.p2.7.m4.1.1.1.cmml">∼</mo><msub id="S2.p2.7.m4.1.1.3" xref="S2.p2.7.m4.1.1.3.cmml"><mi id="S2.p2.7.m4.1.1.3.2" xref="S2.p2.7.m4.1.1.3.2.cmml">p</mi><mtext id="S2.p2.7.m4.1.1.3.3" xref="S2.p2.7.m4.1.1.3.3a.cmml">data</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.7.m4.1b"><apply id="S2.p2.7.m4.1.1.cmml" xref="S2.p2.7.m4.1.1"><csymbol cd="latexml" id="S2.p2.7.m4.1.1.1.cmml" xref="S2.p2.7.m4.1.1.1">similar-to</csymbol><apply id="S2.p2.7.m4.1.1.2.cmml" xref="S2.p2.7.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p2.7.m4.1.1.2.1.cmml" xref="S2.p2.7.m4.1.1.2">subscript</csymbol><ci id="S2.p2.7.m4.1.1.2.2.cmml" xref="S2.p2.7.m4.1.1.2.2">𝒙</ci><cn id="S2.p2.7.m4.1.1.2.3.cmml" type="integer" xref="S2.p2.7.m4.1.1.2.3">0</cn></apply><apply id="S2.p2.7.m4.1.1.3.cmml" xref="S2.p2.7.m4.1.1.3"><csymbol cd="ambiguous" id="S2.p2.7.m4.1.1.3.1.cmml" xref="S2.p2.7.m4.1.1.3">subscript</csymbol><ci id="S2.p2.7.m4.1.1.3.2.cmml" xref="S2.p2.7.m4.1.1.3.2">𝑝</ci><ci id="S2.p2.7.m4.1.1.3.3a.cmml" xref="S2.p2.7.m4.1.1.3.3"><mtext id="S2.p2.7.m4.1.1.3.3.cmml" mathsize="70%" xref="S2.p2.7.m4.1.1.3.3">data</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m4.1c">{\bm{x}}_{0}\sim p_{\text{data}}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.7.m4.1d">bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∼ italic_p start_POSTSUBSCRIPT data end_POSTSUBSCRIPT</annotation></semantics></math> and transitions to an approximately Gaussian distribution <math alttext="{\bm{x}}_{T}\sim\mathcal{N}(\bm{0},{\bm{I}})" class="ltx_Math" display="inline" id="S2.p2.8.m5.2"><semantics id="S2.p2.8.m5.2a"><mrow id="S2.p2.8.m5.2.3" xref="S2.p2.8.m5.2.3.cmml"><msub id="S2.p2.8.m5.2.3.2" xref="S2.p2.8.m5.2.3.2.cmml"><mi id="S2.p2.8.m5.2.3.2.2" xref="S2.p2.8.m5.2.3.2.2.cmml">𝒙</mi><mi id="S2.p2.8.m5.2.3.2.3" xref="S2.p2.8.m5.2.3.2.3.cmml">T</mi></msub><mo id="S2.p2.8.m5.2.3.1" xref="S2.p2.8.m5.2.3.1.cmml">∼</mo><mrow id="S2.p2.8.m5.2.3.3" xref="S2.p2.8.m5.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.8.m5.2.3.3.2" xref="S2.p2.8.m5.2.3.3.2.cmml">𝒩</mi><mo id="S2.p2.8.m5.2.3.3.1" xref="S2.p2.8.m5.2.3.3.1.cmml">⁢</mo><mrow id="S2.p2.8.m5.2.3.3.3.2" xref="S2.p2.8.m5.2.3.3.3.1.cmml"><mo id="S2.p2.8.m5.2.3.3.3.2.1" stretchy="false" xref="S2.p2.8.m5.2.3.3.3.1.cmml">(</mo><mn id="S2.p2.8.m5.1.1" xref="S2.p2.8.m5.1.1.cmml">𝟎</mn><mo id="S2.p2.8.m5.2.3.3.3.2.2" xref="S2.p2.8.m5.2.3.3.3.1.cmml">,</mo><mi id="S2.p2.8.m5.2.2" xref="S2.p2.8.m5.2.2.cmml">𝑰</mi><mo id="S2.p2.8.m5.2.3.3.3.2.3" stretchy="false" xref="S2.p2.8.m5.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.8.m5.2b"><apply id="S2.p2.8.m5.2.3.cmml" xref="S2.p2.8.m5.2.3"><csymbol cd="latexml" id="S2.p2.8.m5.2.3.1.cmml" xref="S2.p2.8.m5.2.3.1">similar-to</csymbol><apply id="S2.p2.8.m5.2.3.2.cmml" xref="S2.p2.8.m5.2.3.2"><csymbol cd="ambiguous" id="S2.p2.8.m5.2.3.2.1.cmml" xref="S2.p2.8.m5.2.3.2">subscript</csymbol><ci id="S2.p2.8.m5.2.3.2.2.cmml" xref="S2.p2.8.m5.2.3.2.2">𝒙</ci><ci id="S2.p2.8.m5.2.3.2.3.cmml" xref="S2.p2.8.m5.2.3.2.3">𝑇</ci></apply><apply id="S2.p2.8.m5.2.3.3.cmml" xref="S2.p2.8.m5.2.3.3"><times id="S2.p2.8.m5.2.3.3.1.cmml" xref="S2.p2.8.m5.2.3.3.1"></times><ci id="S2.p2.8.m5.2.3.3.2.cmml" xref="S2.p2.8.m5.2.3.3.2">𝒩</ci><interval closure="open" id="S2.p2.8.m5.2.3.3.3.1.cmml" xref="S2.p2.8.m5.2.3.3.3.2"><cn id="S2.p2.8.m5.1.1.cmml" type="integer" xref="S2.p2.8.m5.1.1">0</cn><ci id="S2.p2.8.m5.2.2.cmml" xref="S2.p2.8.m5.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m5.2c">{\bm{x}}_{T}\sim\mathcal{N}(\bm{0},{\bm{I}})</annotation><annotation encoding="application/x-llamapun" id="S2.p2.8.m5.2d">bold_italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∼ caligraphic_N ( bold_0 , bold_italic_I )</annotation></semantics></math> by time <math alttext="T" class="ltx_Math" display="inline" id="S2.p2.9.m6.1"><semantics id="S2.p2.9.m6.1a"><mi id="S2.p2.9.m6.1.1" xref="S2.p2.9.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.p2.9.m6.1b"><ci id="S2.p2.9.m6.1.1.cmml" xref="S2.p2.9.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m6.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.p2.9.m6.1d">italic_T</annotation></semantics></math>. The objective of regenerating the original data distribution from this Gaussian distribution involves reversing the noising process through a reverse SDE of the form</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d{\bm{x}}=\left[-\frac{\beta_{t}}{2}{\bm{x}}-\beta_{t}\nabla_{{\bm{x}}_{t}}%
\log p_{t}({\bm{x}}_{t})\right]dt+\sqrt{\beta_{t}}d\bar{{\bm{w}}}," class="ltx_Math" display="block" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml">d</mi><mo id="S2.E3.m1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml">𝒙</mi></mrow><mo id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mfrac id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.2.cmml">β</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml">t</mi></msub><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml">2</mn></mfrac><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">𝒙</mi></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.2" lspace="0.167em" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml"><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.2" rspace="0.167em" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.2.cmml">∇</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.2.cmml">𝒙</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.3.cmml">t</mi></msub></msub><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.2.cmml">log</mi></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4a" lspace="0.167em" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.cmml">⁡</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml">p</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml">t</mi></msub></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.2a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.3.cmml">d</mi><mo id="S2.E3.m1.1.1.1.1.1.1.2a" xref="S2.E3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.1.4" xref="S2.E3.m1.1.1.1.1.1.1.4.cmml">t</mi></mrow><mo id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml"><msqrt id="S2.E3.m1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.3.2.cmml"><msub id="S2.E3.m1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.1.1.1.1.1.3.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.3.2.2.2" xref="S2.E3.m1.1.1.1.1.1.3.2.2.2.cmml">β</mi><mi id="S2.E3.m1.1.1.1.1.1.3.2.2.3" xref="S2.E3.m1.1.1.1.1.1.3.2.2.3.cmml">t</mi></msub></msqrt><mo id="S2.E3.m1.1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.3.3.cmml">d</mi><mo id="S2.E3.m1.1.1.1.1.1.3.1a" xref="S2.E3.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mover accent="true" id="S2.E3.m1.1.1.1.1.1.3.4" xref="S2.E3.m1.1.1.1.1.1.3.4.cmml"><mi id="S2.E3.m1.1.1.1.1.1.3.4.2" xref="S2.E3.m1.1.1.1.1.1.3.4.2.cmml">𝒘</mi><mo id="S2.E3.m1.1.1.1.1.1.3.4.1" xref="S2.E3.m1.1.1.1.1.1.3.4.1.cmml">¯</mo></mover></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2"></eq><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><times id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.1"></times><ci id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2">𝑑</ci><ci id="S2.E3.m1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3">𝒙</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><plus id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2"></plus><apply id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1"><minus id="S2.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3"><minus id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.1"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2"><divide id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2"></divide><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.2">𝛽</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.3">𝑡</ci></apply><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.2.3">2</cn></apply><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝒙</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4"><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1"><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.2">∇</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.2">𝒙</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.1.3.3">𝑡</ci></apply></apply><log id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.1.2"></log></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.2">𝑝</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.4.2.3">𝑡</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply><ci id="S2.E3.m1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3">𝑑</ci><ci id="S2.E3.m1.1.1.1.1.1.1.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.4">𝑡</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3"><times id="S2.E3.m1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.3.1"></times><apply id="S2.E3.m1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2"><root id="S2.E3.m1.1.1.1.1.1.3.2a.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2"></root><apply id="S2.E3.m1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.3.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.3.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2.2.2">𝛽</ci><ci id="S2.E3.m1.1.1.1.1.1.3.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2.2.3">𝑡</ci></apply></apply><ci id="S2.E3.m1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3.3">𝑑</ci><apply id="S2.E3.m1.1.1.1.1.1.3.4.cmml" xref="S2.E3.m1.1.1.1.1.1.3.4"><ci id="S2.E3.m1.1.1.1.1.1.3.4.1.cmml" xref="S2.E3.m1.1.1.1.1.1.3.4.1">¯</ci><ci id="S2.E3.m1.1.1.1.1.1.3.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.4.2">𝒘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">d{\bm{x}}=\left[-\frac{\beta_{t}}{2}{\bm{x}}-\beta_{t}\nabla_{{\bm{x}}_{t}}%
\log p_{t}({\bm{x}}_{t})\right]dt+\sqrt{\beta_{t}}d\bar{{\bm{w}}},</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">italic_d bold_italic_x = [ - divide start_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG bold_italic_x - italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ] italic_d italic_t + square-root start_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_d over¯ start_ARG bold_italic_w end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p2.13">where <math alttext="dt" class="ltx_Math" display="inline" id="S2.p2.10.m1.1"><semantics id="S2.p2.10.m1.1a"><mrow id="S2.p2.10.m1.1.1" xref="S2.p2.10.m1.1.1.cmml"><mi id="S2.p2.10.m1.1.1.2" xref="S2.p2.10.m1.1.1.2.cmml">d</mi><mo id="S2.p2.10.m1.1.1.1" xref="S2.p2.10.m1.1.1.1.cmml">⁢</mo><mi id="S2.p2.10.m1.1.1.3" xref="S2.p2.10.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.10.m1.1b"><apply id="S2.p2.10.m1.1.1.cmml" xref="S2.p2.10.m1.1.1"><times id="S2.p2.10.m1.1.1.1.cmml" xref="S2.p2.10.m1.1.1.1"></times><ci id="S2.p2.10.m1.1.1.2.cmml" xref="S2.p2.10.m1.1.1.2">𝑑</ci><ci id="S2.p2.10.m1.1.1.3.cmml" xref="S2.p2.10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m1.1c">dt</annotation><annotation encoding="application/x-llamapun" id="S2.p2.10.m1.1d">italic_d italic_t</annotation></semantics></math> indicates time moving backward and <math alttext="\bar{{\bm{w}}}" class="ltx_Math" display="inline" id="S2.p2.11.m2.1"><semantics id="S2.p2.11.m2.1a"><mover accent="true" id="S2.p2.11.m2.1.1" xref="S2.p2.11.m2.1.1.cmml"><mi id="S2.p2.11.m2.1.1.2" xref="S2.p2.11.m2.1.1.2.cmml">𝒘</mi><mo id="S2.p2.11.m2.1.1.1" xref="S2.p2.11.m2.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S2.p2.11.m2.1b"><apply id="S2.p2.11.m2.1.1.cmml" xref="S2.p2.11.m2.1.1"><ci id="S2.p2.11.m2.1.1.1.cmml" xref="S2.p2.11.m2.1.1.1">¯</ci><ci id="S2.p2.11.m2.1.1.2.cmml" xref="S2.p2.11.m2.1.1.2">𝒘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m2.1c">\bar{{\bm{w}}}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.11.m2.1d">over¯ start_ARG bold_italic_w end_ARG</annotation></semantics></math> is the reversed Wiener process. To approximate <math alttext="\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{x}}_{t})" class="ltx_Math" display="inline" id="S2.p2.12.m3.1"><semantics id="S2.p2.12.m3.1a"><mrow id="S2.p2.12.m3.1.1" xref="S2.p2.12.m3.1.1.cmml"><mrow id="S2.p2.12.m3.1.1.3" xref="S2.p2.12.m3.1.1.3.cmml"><mrow id="S2.p2.12.m3.1.1.3.1" xref="S2.p2.12.m3.1.1.3.1.cmml"><msub id="S2.p2.12.m3.1.1.3.1.1" xref="S2.p2.12.m3.1.1.3.1.1.cmml"><mo id="S2.p2.12.m3.1.1.3.1.1.2" xref="S2.p2.12.m3.1.1.3.1.1.2.cmml">∇</mo><msub id="S2.p2.12.m3.1.1.3.1.1.3" xref="S2.p2.12.m3.1.1.3.1.1.3.cmml"><mi id="S2.p2.12.m3.1.1.3.1.1.3.2" xref="S2.p2.12.m3.1.1.3.1.1.3.2.cmml">𝒙</mi><mi id="S2.p2.12.m3.1.1.3.1.1.3.3" xref="S2.p2.12.m3.1.1.3.1.1.3.3.cmml">t</mi></msub></msub><mi id="S2.p2.12.m3.1.1.3.1.2" xref="S2.p2.12.m3.1.1.3.1.2.cmml">log</mi></mrow><mo id="S2.p2.12.m3.1.1.3a" lspace="0.167em" xref="S2.p2.12.m3.1.1.3.cmml">⁡</mo><msub id="S2.p2.12.m3.1.1.3.2" xref="S2.p2.12.m3.1.1.3.2.cmml"><mi id="S2.p2.12.m3.1.1.3.2.2" xref="S2.p2.12.m3.1.1.3.2.2.cmml">p</mi><mi id="S2.p2.12.m3.1.1.3.2.3" xref="S2.p2.12.m3.1.1.3.2.3.cmml">t</mi></msub></mrow><mo id="S2.p2.12.m3.1.1.2" xref="S2.p2.12.m3.1.1.2.cmml">⁢</mo><mrow id="S2.p2.12.m3.1.1.1.1" xref="S2.p2.12.m3.1.1.1.1.1.cmml"><mo id="S2.p2.12.m3.1.1.1.1.2" stretchy="false" xref="S2.p2.12.m3.1.1.1.1.1.cmml">(</mo><msub id="S2.p2.12.m3.1.1.1.1.1" xref="S2.p2.12.m3.1.1.1.1.1.cmml"><mi id="S2.p2.12.m3.1.1.1.1.1.2" xref="S2.p2.12.m3.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.p2.12.m3.1.1.1.1.1.3" xref="S2.p2.12.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.p2.12.m3.1.1.1.1.3" stretchy="false" xref="S2.p2.12.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.12.m3.1b"><apply id="S2.p2.12.m3.1.1.cmml" xref="S2.p2.12.m3.1.1"><times id="S2.p2.12.m3.1.1.2.cmml" xref="S2.p2.12.m3.1.1.2"></times><apply id="S2.p2.12.m3.1.1.3.cmml" xref="S2.p2.12.m3.1.1.3"><apply id="S2.p2.12.m3.1.1.3.1.cmml" xref="S2.p2.12.m3.1.1.3.1"><apply id="S2.p2.12.m3.1.1.3.1.1.cmml" xref="S2.p2.12.m3.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.p2.12.m3.1.1.3.1.1.1.cmml" xref="S2.p2.12.m3.1.1.3.1.1">subscript</csymbol><ci id="S2.p2.12.m3.1.1.3.1.1.2.cmml" xref="S2.p2.12.m3.1.1.3.1.1.2">∇</ci><apply id="S2.p2.12.m3.1.1.3.1.1.3.cmml" xref="S2.p2.12.m3.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S2.p2.12.m3.1.1.3.1.1.3.1.cmml" xref="S2.p2.12.m3.1.1.3.1.1.3">subscript</csymbol><ci id="S2.p2.12.m3.1.1.3.1.1.3.2.cmml" xref="S2.p2.12.m3.1.1.3.1.1.3.2">𝒙</ci><ci id="S2.p2.12.m3.1.1.3.1.1.3.3.cmml" xref="S2.p2.12.m3.1.1.3.1.1.3.3">𝑡</ci></apply></apply><log id="S2.p2.12.m3.1.1.3.1.2.cmml" xref="S2.p2.12.m3.1.1.3.1.2"></log></apply><apply id="S2.p2.12.m3.1.1.3.2.cmml" xref="S2.p2.12.m3.1.1.3.2"><csymbol cd="ambiguous" id="S2.p2.12.m3.1.1.3.2.1.cmml" xref="S2.p2.12.m3.1.1.3.2">subscript</csymbol><ci id="S2.p2.12.m3.1.1.3.2.2.cmml" xref="S2.p2.12.m3.1.1.3.2.2">𝑝</ci><ci id="S2.p2.12.m3.1.1.3.2.3.cmml" xref="S2.p2.12.m3.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S2.p2.12.m3.1.1.1.1.1.cmml" xref="S2.p2.12.m3.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.12.m3.1.1.1.1.1.1.cmml" xref="S2.p2.12.m3.1.1.1.1">subscript</csymbol><ci id="S2.p2.12.m3.1.1.1.1.1.2.cmml" xref="S2.p2.12.m3.1.1.1.1.1.2">𝒙</ci><ci id="S2.p2.12.m3.1.1.1.1.1.3.cmml" xref="S2.p2.12.m3.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m3.1c">\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{x}}_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.p2.12.m3.1d">∇ start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, a neural network <math alttext="s_{\theta}" class="ltx_Math" display="inline" id="S2.p2.13.m4.1"><semantics id="S2.p2.13.m4.1a"><msub id="S2.p2.13.m4.1.1" xref="S2.p2.13.m4.1.1.cmml"><mi id="S2.p2.13.m4.1.1.2" xref="S2.p2.13.m4.1.1.2.cmml">s</mi><mi id="S2.p2.13.m4.1.1.3" xref="S2.p2.13.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.13.m4.1b"><apply id="S2.p2.13.m4.1.1.cmml" xref="S2.p2.13.m4.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m4.1.1.1.cmml" xref="S2.p2.13.m4.1.1">subscript</csymbol><ci id="S2.p2.13.m4.1.1.2.cmml" xref="S2.p2.13.m4.1.1.2">𝑠</ci><ci id="S2.p2.13.m4.1.1.3.cmml" xref="S2.p2.13.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.13.m4.1c">s_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.13.m4.1d">italic_s start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> trained via denoising score matching <cite class="ltx_cite ltx_citemacro_citep">(Vincent, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib36" title="">2011</a>)</cite> is used.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.2"><span class="ltx_text ltx_font_bold" id="S2.p3.2.1">Solving inverse problems with diffusion models.</span> Diffusion-based approaches to inverse problems seek to reconstruct the original data <math alttext="{\bm{x}}_{0}" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><msub id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">𝒙</mi><mn id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.cmml" xref="S2.p3.1.m1.1.1">subscript</csymbol><ci id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2">𝒙</ci><cn id="S2.p3.1.m1.1.1.3.cmml" type="integer" xref="S2.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">{\bm{x}}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> from the measurement <math alttext="{\bm{y}}=\mathcal{A}({\bm{x}}_{0})+{\bm{n}}" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mrow id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml"><mi id="S2.p3.2.m2.1.1.3" xref="S2.p3.2.m2.1.1.3.cmml">𝒚</mi><mo id="S2.p3.2.m2.1.1.2" xref="S2.p3.2.m2.1.1.2.cmml">=</mo><mrow id="S2.p3.2.m2.1.1.1" xref="S2.p3.2.m2.1.1.1.cmml"><mrow id="S2.p3.2.m2.1.1.1.1" xref="S2.p3.2.m2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p3.2.m2.1.1.1.1.3" xref="S2.p3.2.m2.1.1.1.1.3.cmml">𝒜</mi><mo id="S2.p3.2.m2.1.1.1.1.2" xref="S2.p3.2.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.p3.2.m2.1.1.1.1.1.1" xref="S2.p3.2.m2.1.1.1.1.1.1.1.cmml"><mo id="S2.p3.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S2.p3.2.m2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p3.2.m2.1.1.1.1.1.1.1" xref="S2.p3.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.p3.2.m2.1.1.1.1.1.1.1.2" xref="S2.p3.2.m2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mn id="S2.p3.2.m2.1.1.1.1.1.1.1.3" xref="S2.p3.2.m2.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.p3.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S2.p3.2.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p3.2.m2.1.1.1.2" xref="S2.p3.2.m2.1.1.1.2.cmml">+</mo><mi id="S2.p3.2.m2.1.1.1.3" xref="S2.p3.2.m2.1.1.1.3.cmml">𝒏</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1"><eq id="S2.p3.2.m2.1.1.2.cmml" xref="S2.p3.2.m2.1.1.2"></eq><ci id="S2.p3.2.m2.1.1.3.cmml" xref="S2.p3.2.m2.1.1.3">𝒚</ci><apply id="S2.p3.2.m2.1.1.1.cmml" xref="S2.p3.2.m2.1.1.1"><plus id="S2.p3.2.m2.1.1.1.2.cmml" xref="S2.p3.2.m2.1.1.1.2"></plus><apply id="S2.p3.2.m2.1.1.1.1.cmml" xref="S2.p3.2.m2.1.1.1.1"><times id="S2.p3.2.m2.1.1.1.1.2.cmml" xref="S2.p3.2.m2.1.1.1.1.2"></times><ci id="S2.p3.2.m2.1.1.1.1.3.cmml" xref="S2.p3.2.m2.1.1.1.1.3">𝒜</ci><apply id="S2.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.p3.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.p3.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.p3.2.m2.1.1.1.1.1.1.1.2">𝒙</ci><cn id="S2.p3.2.m2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.p3.2.m2.1.1.1.1.1.1.1.3">0</cn></apply></apply><ci id="S2.p3.2.m2.1.1.1.3.cmml" xref="S2.p3.2.m2.1.1.1.3">𝒏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">{\bm{y}}=\mathcal{A}({\bm{x}}_{0})+{\bm{n}}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">bold_italic_y = caligraphic_A ( bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) + bold_italic_n</annotation></semantics></math>. In this case, the reverse SDE implements</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d{\bm{x}}=\left[-\frac{\beta_{t}}{2}{\bm{x}}-\beta_{t}(\nabla_{{\bm{x}}_{t}}%
\log{p_{t}({\bm{x}}_{t})}+\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{y}}|{\bm{x}}_{t%
}))\right]dt+\sqrt{\beta_{t}}d\bar{{\bm{w}}}." class="ltx_Math" display="block" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.3.2.cmml">d</mi><mo id="S2.E4.m1.1.1.1.1.3.1" xref="S2.E4.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.3.3.cmml">𝒙</mi></mrow><mo id="S2.E4.m1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3a" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mfrac id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.2.cmml">β</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml">t</mi></msub><mn id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml">2</mn></mfrac><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">𝒙</mi></mrow></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.2" rspace="0.167em" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.2.cmml">∇</mo><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.2.cmml">𝒙</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.3.cmml">t</mi></msub></msub><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.cmml">log</mi></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi></msub></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml"><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.2" rspace="0.167em" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.2.cmml">∇</mo><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.2.cmml">𝒙</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.3.cmml">t</mi></msub></msub><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.2.cmml">log</mi></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">p</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">t</mi></msub></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">|</mo><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E4.m1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.3.cmml">d</mi><mo id="S2.E4.m1.1.1.1.1.1.1.2a" xref="S2.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E4.m1.1.1.1.1.1.1.4" xref="S2.E4.m1.1.1.1.1.1.1.4.cmml">t</mi></mrow><mo id="S2.E4.m1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.E4.m1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.3.cmml"><msqrt id="S2.E4.m1.1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.3.2.cmml"><msub id="S2.E4.m1.1.1.1.1.1.3.2.2" xref="S2.E4.m1.1.1.1.1.1.3.2.2.cmml"><mi id="S2.E4.m1.1.1.1.1.1.3.2.2.2" xref="S2.E4.m1.1.1.1.1.1.3.2.2.2.cmml">β</mi><mi id="S2.E4.m1.1.1.1.1.1.3.2.2.3" xref="S2.E4.m1.1.1.1.1.1.3.2.2.3.cmml">t</mi></msub></msqrt><mo id="S2.E4.m1.1.1.1.1.1.3.1" xref="S2.E4.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.3.3.cmml">d</mi><mo id="S2.E4.m1.1.1.1.1.1.3.1a" xref="S2.E4.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mover accent="true" id="S2.E4.m1.1.1.1.1.1.3.4" xref="S2.E4.m1.1.1.1.1.1.3.4.cmml"><mi id="S2.E4.m1.1.1.1.1.1.3.4.2" xref="S2.E4.m1.1.1.1.1.1.3.4.2.cmml">𝒘</mi><mo id="S2.E4.m1.1.1.1.1.1.3.4.1" xref="S2.E4.m1.1.1.1.1.1.3.4.1.cmml">¯</mo></mover></mrow></mrow></mrow><mo id="S2.E4.m1.1.1.1.2" lspace="0em" xref="S2.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.2"></eq><apply id="S2.E4.m1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.3"><times id="S2.E4.m1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.3.1"></times><ci id="S2.E4.m1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.3.2">𝑑</ci><ci id="S2.E4.m1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.3.3">𝒙</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1"><plus id="S2.E4.m1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.2"></plus><apply id="S2.E4.m1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.2"></times><apply id="S2.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1"><minus id="S2.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3"><minus id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2"><times id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.1"></times><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2"><divide id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2"></divide><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.2">𝛽</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.3">𝑡</ci></apply><cn id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" type="integer" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.3">2</cn></apply><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝒙</ci></apply></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"></plus><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.2">∇</ci><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.2">𝒙</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.3.3">𝑡</ci></apply></apply><log id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.2"></log></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><times id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.2">∇</ci><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.2">𝒙</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.1.3.3">𝑡</ci></apply></apply><log id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.2"></log></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.2">𝑝</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.3">𝑡</ci></apply></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1">conditional</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">𝒚</ci><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝒙</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply><ci id="S2.E4.m1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.3">𝑑</ci><ci id="S2.E4.m1.1.1.1.1.1.1.4.cmml" xref="S2.E4.m1.1.1.1.1.1.1.4">𝑡</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3"><times id="S2.E4.m1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.3.1"></times><apply id="S2.E4.m1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2"><root id="S2.E4.m1.1.1.1.1.1.3.2a.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2"></root><apply id="S2.E4.m1.1.1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.3.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.3.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2.2.2">𝛽</ci><ci id="S2.E4.m1.1.1.1.1.1.3.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2.2.3">𝑡</ci></apply></apply><ci id="S2.E4.m1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3.3">𝑑</ci><apply id="S2.E4.m1.1.1.1.1.1.3.4.cmml" xref="S2.E4.m1.1.1.1.1.1.3.4"><ci id="S2.E4.m1.1.1.1.1.1.3.4.1.cmml" xref="S2.E4.m1.1.1.1.1.1.3.4.1">¯</ci><ci id="S2.E4.m1.1.1.1.1.1.3.4.2.cmml" xref="S2.E4.m1.1.1.1.1.1.3.4.2">𝒘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">d{\bm{x}}=\left[-\frac{\beta_{t}}{2}{\bm{x}}-\beta_{t}(\nabla_{{\bm{x}}_{t}}%
\log{p_{t}({\bm{x}}_{t})}+\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{y}}|{\bm{x}}_{t%
}))\right]dt+\sqrt{\beta_{t}}d\bar{{\bm{w}}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">italic_d bold_italic_x = [ - divide start_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG bold_italic_x - italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( ∇ start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + ∇ start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_y | bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ] italic_d italic_t + square-root start_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_d over¯ start_ARG bold_italic_w end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p3.8">Conceptually, the learned score function <math alttext="\nabla_{{\bm{x}}_{t}}\log{p_{t}({\bm{x}}_{t})}" class="ltx_Math" display="inline" id="S2.p3.3.m1.1"><semantics id="S2.p3.3.m1.1a"><mrow id="S2.p3.3.m1.1.1" xref="S2.p3.3.m1.1.1.cmml"><mrow id="S2.p3.3.m1.1.1.3" xref="S2.p3.3.m1.1.1.3.cmml"><mrow id="S2.p3.3.m1.1.1.3.1" xref="S2.p3.3.m1.1.1.3.1.cmml"><msub id="S2.p3.3.m1.1.1.3.1.1" xref="S2.p3.3.m1.1.1.3.1.1.cmml"><mo id="S2.p3.3.m1.1.1.3.1.1.2" xref="S2.p3.3.m1.1.1.3.1.1.2.cmml">∇</mo><msub id="S2.p3.3.m1.1.1.3.1.1.3" xref="S2.p3.3.m1.1.1.3.1.1.3.cmml"><mi id="S2.p3.3.m1.1.1.3.1.1.3.2" xref="S2.p3.3.m1.1.1.3.1.1.3.2.cmml">𝒙</mi><mi id="S2.p3.3.m1.1.1.3.1.1.3.3" xref="S2.p3.3.m1.1.1.3.1.1.3.3.cmml">t</mi></msub></msub><mi id="S2.p3.3.m1.1.1.3.1.2" xref="S2.p3.3.m1.1.1.3.1.2.cmml">log</mi></mrow><mo id="S2.p3.3.m1.1.1.3a" lspace="0.167em" xref="S2.p3.3.m1.1.1.3.cmml">⁡</mo><msub id="S2.p3.3.m1.1.1.3.2" xref="S2.p3.3.m1.1.1.3.2.cmml"><mi id="S2.p3.3.m1.1.1.3.2.2" xref="S2.p3.3.m1.1.1.3.2.2.cmml">p</mi><mi id="S2.p3.3.m1.1.1.3.2.3" xref="S2.p3.3.m1.1.1.3.2.3.cmml">t</mi></msub></mrow><mo id="S2.p3.3.m1.1.1.2" xref="S2.p3.3.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p3.3.m1.1.1.1.1" xref="S2.p3.3.m1.1.1.1.1.1.cmml"><mo id="S2.p3.3.m1.1.1.1.1.2" stretchy="false" xref="S2.p3.3.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.p3.3.m1.1.1.1.1.1" xref="S2.p3.3.m1.1.1.1.1.1.cmml"><mi id="S2.p3.3.m1.1.1.1.1.1.2" xref="S2.p3.3.m1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.p3.3.m1.1.1.1.1.1.3" xref="S2.p3.3.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.p3.3.m1.1.1.1.1.3" stretchy="false" xref="S2.p3.3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m1.1b"><apply id="S2.p3.3.m1.1.1.cmml" xref="S2.p3.3.m1.1.1"><times id="S2.p3.3.m1.1.1.2.cmml" xref="S2.p3.3.m1.1.1.2"></times><apply id="S2.p3.3.m1.1.1.3.cmml" xref="S2.p3.3.m1.1.1.3"><apply id="S2.p3.3.m1.1.1.3.1.cmml" xref="S2.p3.3.m1.1.1.3.1"><apply id="S2.p3.3.m1.1.1.3.1.1.cmml" xref="S2.p3.3.m1.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m1.1.1.3.1.1.1.cmml" xref="S2.p3.3.m1.1.1.3.1.1">subscript</csymbol><ci id="S2.p3.3.m1.1.1.3.1.1.2.cmml" xref="S2.p3.3.m1.1.1.3.1.1.2">∇</ci><apply id="S2.p3.3.m1.1.1.3.1.1.3.cmml" xref="S2.p3.3.m1.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S2.p3.3.m1.1.1.3.1.1.3.1.cmml" xref="S2.p3.3.m1.1.1.3.1.1.3">subscript</csymbol><ci id="S2.p3.3.m1.1.1.3.1.1.3.2.cmml" xref="S2.p3.3.m1.1.1.3.1.1.3.2">𝒙</ci><ci id="S2.p3.3.m1.1.1.3.1.1.3.3.cmml" xref="S2.p3.3.m1.1.1.3.1.1.3.3">𝑡</ci></apply></apply><log id="S2.p3.3.m1.1.1.3.1.2.cmml" xref="S2.p3.3.m1.1.1.3.1.2"></log></apply><apply id="S2.p3.3.m1.1.1.3.2.cmml" xref="S2.p3.3.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.p3.3.m1.1.1.3.2.1.cmml" xref="S2.p3.3.m1.1.1.3.2">subscript</csymbol><ci id="S2.p3.3.m1.1.1.3.2.2.cmml" xref="S2.p3.3.m1.1.1.3.2.2">𝑝</ci><ci id="S2.p3.3.m1.1.1.3.2.3.cmml" xref="S2.p3.3.m1.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S2.p3.3.m1.1.1.1.1.1.cmml" xref="S2.p3.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m1.1.1.1.1.1.1.cmml" xref="S2.p3.3.m1.1.1.1.1">subscript</csymbol><ci id="S2.p3.3.m1.1.1.1.1.1.2.cmml" xref="S2.p3.3.m1.1.1.1.1.1.2">𝒙</ci><ci id="S2.p3.3.m1.1.1.1.1.1.3.cmml" xref="S2.p3.3.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m1.1c">\nabla_{{\bm{x}}_{t}}\log{p_{t}({\bm{x}}_{t})}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m1.1d">∇ start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> guides the reverse diffusion process from noise to the data distribution, and the likelihood-related term <math alttext="\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{y}}\mid{\bm{x}}_{t})" class="ltx_Math" display="inline" id="S2.p3.4.m2.1"><semantics id="S2.p3.4.m2.1a"><mrow id="S2.p3.4.m2.1.1" xref="S2.p3.4.m2.1.1.cmml"><mrow id="S2.p3.4.m2.1.1.3" xref="S2.p3.4.m2.1.1.3.cmml"><mrow id="S2.p3.4.m2.1.1.3.1" xref="S2.p3.4.m2.1.1.3.1.cmml"><msub id="S2.p3.4.m2.1.1.3.1.1" xref="S2.p3.4.m2.1.1.3.1.1.cmml"><mo id="S2.p3.4.m2.1.1.3.1.1.2" xref="S2.p3.4.m2.1.1.3.1.1.2.cmml">∇</mo><msub id="S2.p3.4.m2.1.1.3.1.1.3" xref="S2.p3.4.m2.1.1.3.1.1.3.cmml"><mi id="S2.p3.4.m2.1.1.3.1.1.3.2" xref="S2.p3.4.m2.1.1.3.1.1.3.2.cmml">𝒙</mi><mi id="S2.p3.4.m2.1.1.3.1.1.3.3" xref="S2.p3.4.m2.1.1.3.1.1.3.3.cmml">t</mi></msub></msub><mi id="S2.p3.4.m2.1.1.3.1.2" xref="S2.p3.4.m2.1.1.3.1.2.cmml">log</mi></mrow><mo id="S2.p3.4.m2.1.1.3a" lspace="0.167em" xref="S2.p3.4.m2.1.1.3.cmml">⁡</mo><msub id="S2.p3.4.m2.1.1.3.2" xref="S2.p3.4.m2.1.1.3.2.cmml"><mi id="S2.p3.4.m2.1.1.3.2.2" xref="S2.p3.4.m2.1.1.3.2.2.cmml">p</mi><mi id="S2.p3.4.m2.1.1.3.2.3" xref="S2.p3.4.m2.1.1.3.2.3.cmml">t</mi></msub></mrow><mo id="S2.p3.4.m2.1.1.2" xref="S2.p3.4.m2.1.1.2.cmml">⁢</mo><mrow id="S2.p3.4.m2.1.1.1.1" xref="S2.p3.4.m2.1.1.1.1.1.cmml"><mo id="S2.p3.4.m2.1.1.1.1.2" stretchy="false" xref="S2.p3.4.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.p3.4.m2.1.1.1.1.1" xref="S2.p3.4.m2.1.1.1.1.1.cmml"><mi id="S2.p3.4.m2.1.1.1.1.1.2" xref="S2.p3.4.m2.1.1.1.1.1.2.cmml">𝒚</mi><mo id="S2.p3.4.m2.1.1.1.1.1.1" xref="S2.p3.4.m2.1.1.1.1.1.1.cmml">∣</mo><msub id="S2.p3.4.m2.1.1.1.1.1.3" xref="S2.p3.4.m2.1.1.1.1.1.3.cmml"><mi id="S2.p3.4.m2.1.1.1.1.1.3.2" xref="S2.p3.4.m2.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.p3.4.m2.1.1.1.1.1.3.3" xref="S2.p3.4.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.p3.4.m2.1.1.1.1.3" stretchy="false" xref="S2.p3.4.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.4.m2.1b"><apply id="S2.p3.4.m2.1.1.cmml" xref="S2.p3.4.m2.1.1"><times id="S2.p3.4.m2.1.1.2.cmml" xref="S2.p3.4.m2.1.1.2"></times><apply id="S2.p3.4.m2.1.1.3.cmml" xref="S2.p3.4.m2.1.1.3"><apply id="S2.p3.4.m2.1.1.3.1.cmml" xref="S2.p3.4.m2.1.1.3.1"><apply id="S2.p3.4.m2.1.1.3.1.1.cmml" xref="S2.p3.4.m2.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.p3.4.m2.1.1.3.1.1.1.cmml" xref="S2.p3.4.m2.1.1.3.1.1">subscript</csymbol><ci id="S2.p3.4.m2.1.1.3.1.1.2.cmml" xref="S2.p3.4.m2.1.1.3.1.1.2">∇</ci><apply id="S2.p3.4.m2.1.1.3.1.1.3.cmml" xref="S2.p3.4.m2.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S2.p3.4.m2.1.1.3.1.1.3.1.cmml" xref="S2.p3.4.m2.1.1.3.1.1.3">subscript</csymbol><ci id="S2.p3.4.m2.1.1.3.1.1.3.2.cmml" xref="S2.p3.4.m2.1.1.3.1.1.3.2">𝒙</ci><ci id="S2.p3.4.m2.1.1.3.1.1.3.3.cmml" xref="S2.p3.4.m2.1.1.3.1.1.3.3">𝑡</ci></apply></apply><log id="S2.p3.4.m2.1.1.3.1.2.cmml" xref="S2.p3.4.m2.1.1.3.1.2"></log></apply><apply id="S2.p3.4.m2.1.1.3.2.cmml" xref="S2.p3.4.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.p3.4.m2.1.1.3.2.1.cmml" xref="S2.p3.4.m2.1.1.3.2">subscript</csymbol><ci id="S2.p3.4.m2.1.1.3.2.2.cmml" xref="S2.p3.4.m2.1.1.3.2.2">𝑝</ci><ci id="S2.p3.4.m2.1.1.3.2.3.cmml" xref="S2.p3.4.m2.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S2.p3.4.m2.1.1.1.1.1.cmml" xref="S2.p3.4.m2.1.1.1.1"><csymbol cd="latexml" id="S2.p3.4.m2.1.1.1.1.1.1.cmml" xref="S2.p3.4.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p3.4.m2.1.1.1.1.1.2.cmml" xref="S2.p3.4.m2.1.1.1.1.1.2">𝒚</ci><apply id="S2.p3.4.m2.1.1.1.1.1.3.cmml" xref="S2.p3.4.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.4.m2.1.1.1.1.1.3.1.cmml" xref="S2.p3.4.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p3.4.m2.1.1.1.1.1.3.2.cmml" xref="S2.p3.4.m2.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.p3.4.m2.1.1.1.1.1.3.3.cmml" xref="S2.p3.4.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m2.1c">\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{y}}\mid{\bm{x}}_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m2.1d">∇ start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_y ∣ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> ensures measurement consistency. When the model is trained unconditionally, the main challenge is the intractable denoiser posterior due to the lack of an explicit analytical expression for <math alttext="\nabla_{{\bm{x}}_{t}}\log{p_{t}({\bm{y}}\mid{\bm{x}}_{t})}" class="ltx_Math" display="inline" id="S2.p3.5.m3.1"><semantics id="S2.p3.5.m3.1a"><mrow id="S2.p3.5.m3.1.1" xref="S2.p3.5.m3.1.1.cmml"><mrow id="S2.p3.5.m3.1.1.3" xref="S2.p3.5.m3.1.1.3.cmml"><mrow id="S2.p3.5.m3.1.1.3.1" xref="S2.p3.5.m3.1.1.3.1.cmml"><msub id="S2.p3.5.m3.1.1.3.1.1" xref="S2.p3.5.m3.1.1.3.1.1.cmml"><mo id="S2.p3.5.m3.1.1.3.1.1.2" xref="S2.p3.5.m3.1.1.3.1.1.2.cmml">∇</mo><msub id="S2.p3.5.m3.1.1.3.1.1.3" xref="S2.p3.5.m3.1.1.3.1.1.3.cmml"><mi id="S2.p3.5.m3.1.1.3.1.1.3.2" xref="S2.p3.5.m3.1.1.3.1.1.3.2.cmml">𝒙</mi><mi id="S2.p3.5.m3.1.1.3.1.1.3.3" xref="S2.p3.5.m3.1.1.3.1.1.3.3.cmml">t</mi></msub></msub><mi id="S2.p3.5.m3.1.1.3.1.2" xref="S2.p3.5.m3.1.1.3.1.2.cmml">log</mi></mrow><mo id="S2.p3.5.m3.1.1.3a" lspace="0.167em" xref="S2.p3.5.m3.1.1.3.cmml">⁡</mo><msub id="S2.p3.5.m3.1.1.3.2" xref="S2.p3.5.m3.1.1.3.2.cmml"><mi id="S2.p3.5.m3.1.1.3.2.2" xref="S2.p3.5.m3.1.1.3.2.2.cmml">p</mi><mi id="S2.p3.5.m3.1.1.3.2.3" xref="S2.p3.5.m3.1.1.3.2.3.cmml">t</mi></msub></mrow><mo id="S2.p3.5.m3.1.1.2" xref="S2.p3.5.m3.1.1.2.cmml">⁢</mo><mrow id="S2.p3.5.m3.1.1.1.1" xref="S2.p3.5.m3.1.1.1.1.1.cmml"><mo id="S2.p3.5.m3.1.1.1.1.2" stretchy="false" xref="S2.p3.5.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.p3.5.m3.1.1.1.1.1" xref="S2.p3.5.m3.1.1.1.1.1.cmml"><mi id="S2.p3.5.m3.1.1.1.1.1.2" xref="S2.p3.5.m3.1.1.1.1.1.2.cmml">𝒚</mi><mo id="S2.p3.5.m3.1.1.1.1.1.1" xref="S2.p3.5.m3.1.1.1.1.1.1.cmml">∣</mo><msub id="S2.p3.5.m3.1.1.1.1.1.3" xref="S2.p3.5.m3.1.1.1.1.1.3.cmml"><mi id="S2.p3.5.m3.1.1.1.1.1.3.2" xref="S2.p3.5.m3.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.p3.5.m3.1.1.1.1.1.3.3" xref="S2.p3.5.m3.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.p3.5.m3.1.1.1.1.3" stretchy="false" xref="S2.p3.5.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.5.m3.1b"><apply id="S2.p3.5.m3.1.1.cmml" xref="S2.p3.5.m3.1.1"><times id="S2.p3.5.m3.1.1.2.cmml" xref="S2.p3.5.m3.1.1.2"></times><apply id="S2.p3.5.m3.1.1.3.cmml" xref="S2.p3.5.m3.1.1.3"><apply id="S2.p3.5.m3.1.1.3.1.cmml" xref="S2.p3.5.m3.1.1.3.1"><apply id="S2.p3.5.m3.1.1.3.1.1.cmml" xref="S2.p3.5.m3.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.p3.5.m3.1.1.3.1.1.1.cmml" xref="S2.p3.5.m3.1.1.3.1.1">subscript</csymbol><ci id="S2.p3.5.m3.1.1.3.1.1.2.cmml" xref="S2.p3.5.m3.1.1.3.1.1.2">∇</ci><apply id="S2.p3.5.m3.1.1.3.1.1.3.cmml" xref="S2.p3.5.m3.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S2.p3.5.m3.1.1.3.1.1.3.1.cmml" xref="S2.p3.5.m3.1.1.3.1.1.3">subscript</csymbol><ci id="S2.p3.5.m3.1.1.3.1.1.3.2.cmml" xref="S2.p3.5.m3.1.1.3.1.1.3.2">𝒙</ci><ci id="S2.p3.5.m3.1.1.3.1.1.3.3.cmml" xref="S2.p3.5.m3.1.1.3.1.1.3.3">𝑡</ci></apply></apply><log id="S2.p3.5.m3.1.1.3.1.2.cmml" xref="S2.p3.5.m3.1.1.3.1.2"></log></apply><apply id="S2.p3.5.m3.1.1.3.2.cmml" xref="S2.p3.5.m3.1.1.3.2"><csymbol cd="ambiguous" id="S2.p3.5.m3.1.1.3.2.1.cmml" xref="S2.p3.5.m3.1.1.3.2">subscript</csymbol><ci id="S2.p3.5.m3.1.1.3.2.2.cmml" xref="S2.p3.5.m3.1.1.3.2.2">𝑝</ci><ci id="S2.p3.5.m3.1.1.3.2.3.cmml" xref="S2.p3.5.m3.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S2.p3.5.m3.1.1.1.1.1.cmml" xref="S2.p3.5.m3.1.1.1.1"><csymbol cd="latexml" id="S2.p3.5.m3.1.1.1.1.1.1.cmml" xref="S2.p3.5.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p3.5.m3.1.1.1.1.1.2.cmml" xref="S2.p3.5.m3.1.1.1.1.1.2">𝒚</ci><apply id="S2.p3.5.m3.1.1.1.1.1.3.cmml" xref="S2.p3.5.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.5.m3.1.1.1.1.1.3.1.cmml" xref="S2.p3.5.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p3.5.m3.1.1.1.1.1.3.2.cmml" xref="S2.p3.5.m3.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.p3.5.m3.1.1.1.1.1.3.3.cmml" xref="S2.p3.5.m3.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m3.1c">\nabla_{{\bm{x}}_{t}}\log{p_{t}({\bm{y}}\mid{\bm{x}}_{t})}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.5.m3.1d">∇ start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_y ∣ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>; the exact relationship between <math alttext="{\bm{y}}" class="ltx_Math" display="inline" id="S2.p3.6.m4.1"><semantics id="S2.p3.6.m4.1a"><mi id="S2.p3.6.m4.1.1" xref="S2.p3.6.m4.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S2.p3.6.m4.1b"><ci id="S2.p3.6.m4.1.1.cmml" xref="S2.p3.6.m4.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m4.1c">{\bm{y}}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.6.m4.1d">bold_italic_y</annotation></semantics></math> and intermediate states <math alttext="{\bm{x}}_{t}" class="ltx_Math" display="inline" id="S2.p3.7.m5.1"><semantics id="S2.p3.7.m5.1a"><msub id="S2.p3.7.m5.1.1" xref="S2.p3.7.m5.1.1.cmml"><mi id="S2.p3.7.m5.1.1.2" xref="S2.p3.7.m5.1.1.2.cmml">𝒙</mi><mi id="S2.p3.7.m5.1.1.3" xref="S2.p3.7.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.7.m5.1b"><apply id="S2.p3.7.m5.1.1.cmml" xref="S2.p3.7.m5.1.1"><csymbol cd="ambiguous" id="S2.p3.7.m5.1.1.1.cmml" xref="S2.p3.7.m5.1.1">subscript</csymbol><ci id="S2.p3.7.m5.1.1.2.cmml" xref="S2.p3.7.m5.1.1.2">𝒙</ci><ci id="S2.p3.7.m5.1.1.3.cmml" xref="S2.p3.7.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m5.1c">{\bm{x}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.7.m5.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is not well-defined, except at the initial state <math alttext="{\bm{x}}_{0}" class="ltx_Math" display="inline" id="S2.p3.8.m6.1"><semantics id="S2.p3.8.m6.1a"><msub id="S2.p3.8.m6.1.1" xref="S2.p3.8.m6.1.1.cmml"><mi id="S2.p3.8.m6.1.1.2" xref="S2.p3.8.m6.1.1.2.cmml">𝒙</mi><mn id="S2.p3.8.m6.1.1.3" xref="S2.p3.8.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.p3.8.m6.1b"><apply id="S2.p3.8.m6.1.1.cmml" xref="S2.p3.8.m6.1.1"><csymbol cd="ambiguous" id="S2.p3.8.m6.1.1.1.cmml" xref="S2.p3.8.m6.1.1">subscript</csymbol><ci id="S2.p3.8.m6.1.1.2.cmml" xref="S2.p3.8.m6.1.1.2">𝒙</ci><cn id="S2.p3.8.m6.1.1.3.cmml" type="integer" xref="S2.p3.8.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m6.1c">{\bm{x}}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.8.m6.1d">bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure ltx_align_center ltx_align_floatright" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="407" id="S2.F3.1.1.g1" src="extracted/5900490/figures/psnr_histogram_improved.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S2.F3.3.1">DiffStateGrad improves the worst-case performance</span>. PSNR histogram of ReSample and DiffStateGrad-ReSample for phase retrieval shows that DiffStateGrad-ReSample has a significantly lower failure rate than ReSample.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.8"><span class="ltx_text ltx_font_bold" id="S2.p4.8.1">Solving inverse problems with latent diffusion models.</span> For complex scenarios where direct application of pixel-based models is computationally expensive or ineffective, latent diffusion models (LDMs) offer a promising alternative <cite class="ltx_cite ltx_citemacro_citep">(Rombach et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib22" title="">2022</a>)</cite>. Given data <math alttext="{\bm{x}}\in\mathbb{R}^{n}" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><mrow id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml"><mi id="S2.p4.1.m1.1.1.2" xref="S2.p4.1.m1.1.1.2.cmml">𝒙</mi><mo id="S2.p4.1.m1.1.1.1" xref="S2.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S2.p4.1.m1.1.1.3" xref="S2.p4.1.m1.1.1.3.cmml"><mi id="S2.p4.1.m1.1.1.3.2" xref="S2.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S2.p4.1.m1.1.1.3.3" xref="S2.p4.1.m1.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"><in id="S2.p4.1.m1.1.1.1.cmml" xref="S2.p4.1.m1.1.1.1"></in><ci id="S2.p4.1.m1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.2">𝒙</ci><apply id="S2.p4.1.m1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.3.1.cmml" xref="S2.p4.1.m1.1.1.3">superscript</csymbol><ci id="S2.p4.1.m1.1.1.3.2.cmml" xref="S2.p4.1.m1.1.1.3.2">ℝ</ci><ci id="S2.p4.1.m1.1.1.3.3.cmml" xref="S2.p4.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">{\bm{x}}\in\mathbb{R}^{n}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">bold_italic_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, the LDM framework utilizes an encoder <math alttext="\mathcal{E}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{k}" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><mrow id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.2.m2.1.1.2" xref="S2.p4.2.m2.1.1.2.cmml">ℰ</mi><mo id="S2.p4.2.m2.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.p4.2.m2.1.1.1.cmml">:</mo><mrow id="S2.p4.2.m2.1.1.3" xref="S2.p4.2.m2.1.1.3.cmml"><msup id="S2.p4.2.m2.1.1.3.2" xref="S2.p4.2.m2.1.1.3.2.cmml"><mi id="S2.p4.2.m2.1.1.3.2.2" xref="S2.p4.2.m2.1.1.3.2.2.cmml">ℝ</mi><mi id="S2.p4.2.m2.1.1.3.2.3" xref="S2.p4.2.m2.1.1.3.2.3.cmml">n</mi></msup><mo id="S2.p4.2.m2.1.1.3.1" stretchy="false" xref="S2.p4.2.m2.1.1.3.1.cmml">→</mo><msup id="S2.p4.2.m2.1.1.3.3" xref="S2.p4.2.m2.1.1.3.3.cmml"><mi id="S2.p4.2.m2.1.1.3.3.2" xref="S2.p4.2.m2.1.1.3.3.2.cmml">ℝ</mi><mi id="S2.p4.2.m2.1.1.3.3.3" xref="S2.p4.2.m2.1.1.3.3.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><apply id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1"><ci id="S2.p4.2.m2.1.1.1.cmml" xref="S2.p4.2.m2.1.1.1">:</ci><ci id="S2.p4.2.m2.1.1.2.cmml" xref="S2.p4.2.m2.1.1.2">ℰ</ci><apply id="S2.p4.2.m2.1.1.3.cmml" xref="S2.p4.2.m2.1.1.3"><ci id="S2.p4.2.m2.1.1.3.1.cmml" xref="S2.p4.2.m2.1.1.3.1">→</ci><apply id="S2.p4.2.m2.1.1.3.2.cmml" xref="S2.p4.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.3.2.1.cmml" xref="S2.p4.2.m2.1.1.3.2">superscript</csymbol><ci id="S2.p4.2.m2.1.1.3.2.2.cmml" xref="S2.p4.2.m2.1.1.3.2.2">ℝ</ci><ci id="S2.p4.2.m2.1.1.3.2.3.cmml" xref="S2.p4.2.m2.1.1.3.2.3">𝑛</ci></apply><apply id="S2.p4.2.m2.1.1.3.3.cmml" xref="S2.p4.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.3.3.1.cmml" xref="S2.p4.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.p4.2.m2.1.1.3.3.2.cmml" xref="S2.p4.2.m2.1.1.3.3.2">ℝ</ci><ci id="S2.p4.2.m2.1.1.3.3.3.cmml" xref="S2.p4.2.m2.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">\mathcal{E}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">caligraphic_E : blackboard_R start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> and a decoder <math alttext="\mathcal{D}:\mathbb{R}^{k}\rightarrow\mathbb{R}^{n}" class="ltx_Math" display="inline" id="S2.p4.3.m3.1"><semantics id="S2.p4.3.m3.1a"><mrow id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.3.m3.1.1.2" xref="S2.p4.3.m3.1.1.2.cmml">𝒟</mi><mo id="S2.p4.3.m3.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.p4.3.m3.1.1.1.cmml">:</mo><mrow id="S2.p4.3.m3.1.1.3" xref="S2.p4.3.m3.1.1.3.cmml"><msup id="S2.p4.3.m3.1.1.3.2" xref="S2.p4.3.m3.1.1.3.2.cmml"><mi id="S2.p4.3.m3.1.1.3.2.2" xref="S2.p4.3.m3.1.1.3.2.2.cmml">ℝ</mi><mi id="S2.p4.3.m3.1.1.3.2.3" xref="S2.p4.3.m3.1.1.3.2.3.cmml">k</mi></msup><mo id="S2.p4.3.m3.1.1.3.1" stretchy="false" xref="S2.p4.3.m3.1.1.3.1.cmml">→</mo><msup id="S2.p4.3.m3.1.1.3.3" xref="S2.p4.3.m3.1.1.3.3.cmml"><mi id="S2.p4.3.m3.1.1.3.3.2" xref="S2.p4.3.m3.1.1.3.3.2.cmml">ℝ</mi><mi id="S2.p4.3.m3.1.1.3.3.3" xref="S2.p4.3.m3.1.1.3.3.3.cmml">n</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.1b"><apply id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1"><ci id="S2.p4.3.m3.1.1.1.cmml" xref="S2.p4.3.m3.1.1.1">:</ci><ci id="S2.p4.3.m3.1.1.2.cmml" xref="S2.p4.3.m3.1.1.2">𝒟</ci><apply id="S2.p4.3.m3.1.1.3.cmml" xref="S2.p4.3.m3.1.1.3"><ci id="S2.p4.3.m3.1.1.3.1.cmml" xref="S2.p4.3.m3.1.1.3.1">→</ci><apply id="S2.p4.3.m3.1.1.3.2.cmml" xref="S2.p4.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S2.p4.3.m3.1.1.3.2.1.cmml" xref="S2.p4.3.m3.1.1.3.2">superscript</csymbol><ci id="S2.p4.3.m3.1.1.3.2.2.cmml" xref="S2.p4.3.m3.1.1.3.2.2">ℝ</ci><ci id="S2.p4.3.m3.1.1.3.2.3.cmml" xref="S2.p4.3.m3.1.1.3.2.3">𝑘</ci></apply><apply id="S2.p4.3.m3.1.1.3.3.cmml" xref="S2.p4.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.p4.3.m3.1.1.3.3.1.cmml" xref="S2.p4.3.m3.1.1.3.3">superscript</csymbol><ci id="S2.p4.3.m3.1.1.3.3.2.cmml" xref="S2.p4.3.m3.1.1.3.3.2">ℝ</ci><ci id="S2.p4.3.m3.1.1.3.3.3.cmml" xref="S2.p4.3.m3.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.1c">\mathcal{D}:\mathbb{R}^{k}\rightarrow\mathbb{R}^{n}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.3.m3.1d">caligraphic_D : blackboard_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, with <math alttext="k\ll n" class="ltx_Math" display="inline" id="S2.p4.4.m4.1"><semantics id="S2.p4.4.m4.1a"><mrow id="S2.p4.4.m4.1.1" xref="S2.p4.4.m4.1.1.cmml"><mi id="S2.p4.4.m4.1.1.2" xref="S2.p4.4.m4.1.1.2.cmml">k</mi><mo id="S2.p4.4.m4.1.1.1" xref="S2.p4.4.m4.1.1.1.cmml">≪</mo><mi id="S2.p4.4.m4.1.1.3" xref="S2.p4.4.m4.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.4.m4.1b"><apply id="S2.p4.4.m4.1.1.cmml" xref="S2.p4.4.m4.1.1"><csymbol cd="latexml" id="S2.p4.4.m4.1.1.1.cmml" xref="S2.p4.4.m4.1.1.1">much-less-than</csymbol><ci id="S2.p4.4.m4.1.1.2.cmml" xref="S2.p4.4.m4.1.1.2">𝑘</ci><ci id="S2.p4.4.m4.1.1.3.cmml" xref="S2.p4.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m4.1c">k\ll n</annotation><annotation encoding="application/x-llamapun" id="S2.p4.4.m4.1d">italic_k ≪ italic_n</annotation></semantics></math>, to work in a compressed latent space. <math alttext="{\bm{x}}_{T}" class="ltx_Math" display="inline" id="S2.p4.5.m5.1"><semantics id="S2.p4.5.m5.1a"><msub id="S2.p4.5.m5.1.1" xref="S2.p4.5.m5.1.1.cmml"><mi id="S2.p4.5.m5.1.1.2" xref="S2.p4.5.m5.1.1.2.cmml">𝒙</mi><mi id="S2.p4.5.m5.1.1.3" xref="S2.p4.5.m5.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.5.m5.1b"><apply id="S2.p4.5.m5.1.1.cmml" xref="S2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p4.5.m5.1.1.1.cmml" xref="S2.p4.5.m5.1.1">subscript</csymbol><ci id="S2.p4.5.m5.1.1.2.cmml" xref="S2.p4.5.m5.1.1.2">𝒙</ci><ci id="S2.p4.5.m5.1.1.3.cmml" xref="S2.p4.5.m5.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.5.m5.1c">{\bm{x}}_{T}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.5.m5.1d">bold_italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> is encoded into a latent representation <math alttext="{\bm{z}}_{T}=\mathcal{E}({\bm{x}}_{T})" class="ltx_Math" display="inline" id="S2.p4.6.m6.1"><semantics id="S2.p4.6.m6.1a"><mrow id="S2.p4.6.m6.1.1" xref="S2.p4.6.m6.1.1.cmml"><msub id="S2.p4.6.m6.1.1.3" xref="S2.p4.6.m6.1.1.3.cmml"><mi id="S2.p4.6.m6.1.1.3.2" xref="S2.p4.6.m6.1.1.3.2.cmml">𝒛</mi><mi id="S2.p4.6.m6.1.1.3.3" xref="S2.p4.6.m6.1.1.3.3.cmml">T</mi></msub><mo id="S2.p4.6.m6.1.1.2" xref="S2.p4.6.m6.1.1.2.cmml">=</mo><mrow id="S2.p4.6.m6.1.1.1" xref="S2.p4.6.m6.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.6.m6.1.1.1.3" xref="S2.p4.6.m6.1.1.1.3.cmml">ℰ</mi><mo id="S2.p4.6.m6.1.1.1.2" xref="S2.p4.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S2.p4.6.m6.1.1.1.1.1" xref="S2.p4.6.m6.1.1.1.1.1.1.cmml"><mo id="S2.p4.6.m6.1.1.1.1.1.2" stretchy="false" xref="S2.p4.6.m6.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p4.6.m6.1.1.1.1.1.1" xref="S2.p4.6.m6.1.1.1.1.1.1.cmml"><mi id="S2.p4.6.m6.1.1.1.1.1.1.2" xref="S2.p4.6.m6.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.p4.6.m6.1.1.1.1.1.1.3" xref="S2.p4.6.m6.1.1.1.1.1.1.3.cmml">T</mi></msub><mo id="S2.p4.6.m6.1.1.1.1.1.3" stretchy="false" xref="S2.p4.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.6.m6.1b"><apply id="S2.p4.6.m6.1.1.cmml" xref="S2.p4.6.m6.1.1"><eq id="S2.p4.6.m6.1.1.2.cmml" xref="S2.p4.6.m6.1.1.2"></eq><apply id="S2.p4.6.m6.1.1.3.cmml" xref="S2.p4.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.p4.6.m6.1.1.3.1.cmml" xref="S2.p4.6.m6.1.1.3">subscript</csymbol><ci id="S2.p4.6.m6.1.1.3.2.cmml" xref="S2.p4.6.m6.1.1.3.2">𝒛</ci><ci id="S2.p4.6.m6.1.1.3.3.cmml" xref="S2.p4.6.m6.1.1.3.3">𝑇</ci></apply><apply id="S2.p4.6.m6.1.1.1.cmml" xref="S2.p4.6.m6.1.1.1"><times id="S2.p4.6.m6.1.1.1.2.cmml" xref="S2.p4.6.m6.1.1.1.2"></times><ci id="S2.p4.6.m6.1.1.1.3.cmml" xref="S2.p4.6.m6.1.1.1.3">ℰ</ci><apply id="S2.p4.6.m6.1.1.1.1.1.1.cmml" xref="S2.p4.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.6.m6.1.1.1.1.1.1.1.cmml" xref="S2.p4.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S2.p4.6.m6.1.1.1.1.1.1.2.cmml" xref="S2.p4.6.m6.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.p4.6.m6.1.1.1.1.1.1.3.cmml" xref="S2.p4.6.m6.1.1.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.6.m6.1c">{\bm{z}}_{T}=\mathcal{E}({\bm{x}}_{T})</annotation><annotation encoding="application/x-llamapun" id="S2.p4.6.m6.1d">bold_italic_z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT = caligraphic_E ( bold_italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math> and serves as the starting point for the reverse diffusion process. Then, <math alttext="{\bm{z}}_{0}" class="ltx_Math" display="inline" id="S2.p4.7.m7.1"><semantics id="S2.p4.7.m7.1a"><msub id="S2.p4.7.m7.1.1" xref="S2.p4.7.m7.1.1.cmml"><mi id="S2.p4.7.m7.1.1.2" xref="S2.p4.7.m7.1.1.2.cmml">𝒛</mi><mn id="S2.p4.7.m7.1.1.3" xref="S2.p4.7.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.p4.7.m7.1b"><apply id="S2.p4.7.m7.1.1.cmml" xref="S2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p4.7.m7.1.1.1.cmml" xref="S2.p4.7.m7.1.1">subscript</csymbol><ci id="S2.p4.7.m7.1.1.2.cmml" xref="S2.p4.7.m7.1.1.2">𝒛</ci><cn id="S2.p4.7.m7.1.1.3.cmml" type="integer" xref="S2.p4.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.7.m7.1c">{\bm{z}}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.7.m7.1d">bold_italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is decoded to <math alttext="{\bm{x}}_{0}=\mathcal{D}({\bm{z}}_{0})" class="ltx_Math" display="inline" id="S2.p4.8.m8.1"><semantics id="S2.p4.8.m8.1a"><mrow id="S2.p4.8.m8.1.1" xref="S2.p4.8.m8.1.1.cmml"><msub id="S2.p4.8.m8.1.1.3" xref="S2.p4.8.m8.1.1.3.cmml"><mi id="S2.p4.8.m8.1.1.3.2" xref="S2.p4.8.m8.1.1.3.2.cmml">𝒙</mi><mn id="S2.p4.8.m8.1.1.3.3" xref="S2.p4.8.m8.1.1.3.3.cmml">0</mn></msub><mo id="S2.p4.8.m8.1.1.2" xref="S2.p4.8.m8.1.1.2.cmml">=</mo><mrow id="S2.p4.8.m8.1.1.1" xref="S2.p4.8.m8.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.8.m8.1.1.1.3" xref="S2.p4.8.m8.1.1.1.3.cmml">𝒟</mi><mo id="S2.p4.8.m8.1.1.1.2" xref="S2.p4.8.m8.1.1.1.2.cmml">⁢</mo><mrow id="S2.p4.8.m8.1.1.1.1.1" xref="S2.p4.8.m8.1.1.1.1.1.1.cmml"><mo id="S2.p4.8.m8.1.1.1.1.1.2" stretchy="false" xref="S2.p4.8.m8.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p4.8.m8.1.1.1.1.1.1" xref="S2.p4.8.m8.1.1.1.1.1.1.cmml"><mi id="S2.p4.8.m8.1.1.1.1.1.1.2" xref="S2.p4.8.m8.1.1.1.1.1.1.2.cmml">𝒛</mi><mn id="S2.p4.8.m8.1.1.1.1.1.1.3" xref="S2.p4.8.m8.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.p4.8.m8.1.1.1.1.1.3" stretchy="false" xref="S2.p4.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.8.m8.1b"><apply id="S2.p4.8.m8.1.1.cmml" xref="S2.p4.8.m8.1.1"><eq id="S2.p4.8.m8.1.1.2.cmml" xref="S2.p4.8.m8.1.1.2"></eq><apply id="S2.p4.8.m8.1.1.3.cmml" xref="S2.p4.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.p4.8.m8.1.1.3.1.cmml" xref="S2.p4.8.m8.1.1.3">subscript</csymbol><ci id="S2.p4.8.m8.1.1.3.2.cmml" xref="S2.p4.8.m8.1.1.3.2">𝒙</ci><cn id="S2.p4.8.m8.1.1.3.3.cmml" type="integer" xref="S2.p4.8.m8.1.1.3.3">0</cn></apply><apply id="S2.p4.8.m8.1.1.1.cmml" xref="S2.p4.8.m8.1.1.1"><times id="S2.p4.8.m8.1.1.1.2.cmml" xref="S2.p4.8.m8.1.1.1.2"></times><ci id="S2.p4.8.m8.1.1.1.3.cmml" xref="S2.p4.8.m8.1.1.1.3">𝒟</ci><apply id="S2.p4.8.m8.1.1.1.1.1.1.cmml" xref="S2.p4.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.8.m8.1.1.1.1.1.1.1.cmml" xref="S2.p4.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S2.p4.8.m8.1.1.1.1.1.1.2.cmml" xref="S2.p4.8.m8.1.1.1.1.1.1.2">𝒛</ci><cn id="S2.p4.8.m8.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.p4.8.m8.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.8.m8.1c">{\bm{x}}_{0}=\mathcal{D}({\bm{z}}_{0})</annotation><annotation encoding="application/x-llamapun" id="S2.p4.8.m8.1d">bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = caligraphic_D ( bold_italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>, the final reconstruction of the image. Using a <em class="ltx_emph ltx_font_italic" id="S2.p4.8.2">latent</em> diffusion model introduces an additional complexity to solving inverse problems. The challenge arises from the nonlinear nature and non-uniqueness mapping of the encoder/decoder, discussed by <cite class="ltx_cite ltx_citemacro_citet">Rout et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib23" title="">2023</a>)</cite> in their proposed Posterior Sampling with Latent Diffusion (PSLD); PSLD improves performance by enforcing fixed-point properties on the representations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p5">
<p class="ltx_p" id="S2.p5.5"><span class="ltx_text ltx_font_bold" id="S2.p5.5.1">Diffusion-based inverse problems addressing challenges of intractable denoiser posterior.</span> To address the intractability of the gradient for the reverse diffusion, Diffusion Posterior Sampling (DPS) <cite class="ltx_cite ltx_citemacro_citep">(Chung et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib4" title="">2023</a>)</cite>, approximates the probability <math alttext="p({\bm{y}}\mid{\bm{x}}_{t})\approx p({\bm{y}}|\hat{{\bm{x}}}_{0}\coloneqq%
\mathbb{E}[{\bm{x}}_{0}\mid{\bm{x}}_{t}])" class="ltx_Math" display="inline" id="S2.p5.1.m1.2"><semantics id="S2.p5.1.m1.2a"><mrow id="S2.p5.1.m1.2.2" xref="S2.p5.1.m1.2.2.cmml"><mrow id="S2.p5.1.m1.1.1.1" xref="S2.p5.1.m1.1.1.1.cmml"><mi id="S2.p5.1.m1.1.1.1.3" xref="S2.p5.1.m1.1.1.1.3.cmml">p</mi><mo id="S2.p5.1.m1.1.1.1.2" xref="S2.p5.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.p5.1.m1.1.1.1.1.1" xref="S2.p5.1.m1.1.1.1.1.1.1.cmml"><mo id="S2.p5.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.p5.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p5.1.m1.1.1.1.1.1.1" xref="S2.p5.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.p5.1.m1.1.1.1.1.1.1.2" xref="S2.p5.1.m1.1.1.1.1.1.1.2.cmml">𝒚</mi><mo id="S2.p5.1.m1.1.1.1.1.1.1.1" xref="S2.p5.1.m1.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S2.p5.1.m1.1.1.1.1.1.1.3" xref="S2.p5.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.p5.1.m1.1.1.1.1.1.1.3.2" xref="S2.p5.1.m1.1.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.p5.1.m1.1.1.1.1.1.1.3.3" xref="S2.p5.1.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.p5.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.p5.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p5.1.m1.2.2.3" xref="S2.p5.1.m1.2.2.3.cmml">≈</mo><mrow id="S2.p5.1.m1.2.2.2" xref="S2.p5.1.m1.2.2.2.cmml"><mi id="S2.p5.1.m1.2.2.2.3" xref="S2.p5.1.m1.2.2.2.3.cmml">p</mi><mo id="S2.p5.1.m1.2.2.2.2" xref="S2.p5.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.p5.1.m1.2.2.2.1.1" xref="S2.p5.1.m1.2.2.2.1.1.1.cmml"><mo id="S2.p5.1.m1.2.2.2.1.1.2" stretchy="false" xref="S2.p5.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.p5.1.m1.2.2.2.1.1.1" xref="S2.p5.1.m1.2.2.2.1.1.1.cmml"><mrow id="S2.p5.1.m1.2.2.2.1.1.1.3" xref="S2.p5.1.m1.2.2.2.1.1.1.3.cmml"><mi id="S2.p5.1.m1.2.2.2.1.1.1.3.2" xref="S2.p5.1.m1.2.2.2.1.1.1.3.2.cmml">𝒚</mi><mo fence="false" id="S2.p5.1.m1.2.2.2.1.1.1.3.1" xref="S2.p5.1.m1.2.2.2.1.1.1.3.1.cmml">|</mo><msub id="S2.p5.1.m1.2.2.2.1.1.1.3.3" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3.cmml"><mover accent="true" id="S2.p5.1.m1.2.2.2.1.1.1.3.3.2" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3.2.cmml"><mi id="S2.p5.1.m1.2.2.2.1.1.1.3.3.2.2" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3.2.2.cmml">𝒙</mi><mo id="S2.p5.1.m1.2.2.2.1.1.1.3.3.2.1" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3.2.1.cmml">^</mo></mover><mn id="S2.p5.1.m1.2.2.2.1.1.1.3.3.3" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3.3.cmml">0</mn></msub></mrow><mo id="S2.p5.1.m1.2.2.2.1.1.1.2" xref="S2.p5.1.m1.2.2.2.1.1.1.2.cmml">≔</mo><mrow id="S2.p5.1.m1.2.2.2.1.1.1.1" xref="S2.p5.1.m1.2.2.2.1.1.1.1.cmml"><mi id="S2.p5.1.m1.2.2.2.1.1.1.1.3" xref="S2.p5.1.m1.2.2.2.1.1.1.1.3.cmml">𝔼</mi><mo id="S2.p5.1.m1.2.2.2.1.1.1.1.2" xref="S2.p5.1.m1.2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.2.cmml"><mo id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.cmml"><msub id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.2" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mn id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.3" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.1" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.2" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.3" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.p5.1.m1.2.2.2.1.1.3" stretchy="false" xref="S2.p5.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.2b"><apply id="S2.p5.1.m1.2.2.cmml" xref="S2.p5.1.m1.2.2"><approx id="S2.p5.1.m1.2.2.3.cmml" xref="S2.p5.1.m1.2.2.3"></approx><apply id="S2.p5.1.m1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1"><times id="S2.p5.1.m1.1.1.1.2.cmml" xref="S2.p5.1.m1.1.1.1.2"></times><ci id="S2.p5.1.m1.1.1.1.3.cmml" xref="S2.p5.1.m1.1.1.1.3">𝑝</ci><apply id="S2.p5.1.m1.1.1.1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p5.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p5.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.p5.1.m1.1.1.1.1.1.1.2">𝒚</ci><apply id="S2.p5.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.p5.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p5.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.p5.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p5.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.p5.1.m1.1.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.p5.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.p5.1.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S2.p5.1.m1.2.2.2.cmml" xref="S2.p5.1.m1.2.2.2"><times id="S2.p5.1.m1.2.2.2.2.cmml" xref="S2.p5.1.m1.2.2.2.2"></times><ci id="S2.p5.1.m1.2.2.2.3.cmml" xref="S2.p5.1.m1.2.2.2.3">𝑝</ci><apply id="S2.p5.1.m1.2.2.2.1.1.1.cmml" xref="S2.p5.1.m1.2.2.2.1.1"><ci id="S2.p5.1.m1.2.2.2.1.1.1.2.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.2">≔</ci><apply id="S2.p5.1.m1.2.2.2.1.1.1.3.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.3"><csymbol cd="latexml" id="S2.p5.1.m1.2.2.2.1.1.1.3.1.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.3.1">conditional</csymbol><ci id="S2.p5.1.m1.2.2.2.1.1.1.3.2.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.3.2">𝒚</ci><apply id="S2.p5.1.m1.2.2.2.1.1.1.3.3.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p5.1.m1.2.2.2.1.1.1.3.3.1.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3">subscript</csymbol><apply id="S2.p5.1.m1.2.2.2.1.1.1.3.3.2.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3.2"><ci id="S2.p5.1.m1.2.2.2.1.1.1.3.3.2.1.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3.2.1">^</ci><ci id="S2.p5.1.m1.2.2.2.1.1.1.3.3.2.2.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3.2.2">𝒙</ci></apply><cn id="S2.p5.1.m1.2.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S2.p5.1.m1.2.2.2.1.1.1.3.3.3">0</cn></apply></apply><apply id="S2.p5.1.m1.2.2.2.1.1.1.1.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1"><times id="S2.p5.1.m1.2.2.2.1.1.1.1.2.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.2"></times><ci id="S2.p5.1.m1.2.2.2.1.1.1.1.3.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.3">𝔼</ci><apply id="S2.p5.1.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p5.1.m1.2.2.2.1.1.1.1.1.2.1.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.2">𝒙</ci><cn id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.2.3">0</cn></apply><apply id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.p5.1.m1.2.2.2.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.2c">p({\bm{y}}\mid{\bm{x}}_{t})\approx p({\bm{y}}|\hat{{\bm{x}}}_{0}\coloneqq%
\mathbb{E}[{\bm{x}}_{0}\mid{\bm{x}}_{t}])</annotation><annotation encoding="application/x-llamapun" id="S2.p5.1.m1.2d">italic_p ( bold_italic_y ∣ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ≈ italic_p ( bold_italic_y | over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ≔ blackboard_E [ bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∣ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] )</annotation></semantics></math> using the conditional expectation of the data. Extending to the latent case, <span class="ltx_text ltx_font_italic" id="S2.p5.5.2">Latent-DPS</span> uses <math alttext="p({\bm{y}}|{\bm{z}}_{t})\approx p({\bm{y}}|\hat{{\bm{x}}}_{0}:=\mathcal{D}(%
\mathbb{E}[{\bm{z}}_{0}|{\bm{z}}_{t}]))" class="ltx_Math" display="inline" id="S2.p5.2.m2.2"><semantics id="S2.p5.2.m2.2a"><mrow id="S2.p5.2.m2.2.2" xref="S2.p5.2.m2.2.2.cmml"><mrow id="S2.p5.2.m2.1.1.1" xref="S2.p5.2.m2.1.1.1.cmml"><mi id="S2.p5.2.m2.1.1.1.3" xref="S2.p5.2.m2.1.1.1.3.cmml">p</mi><mo id="S2.p5.2.m2.1.1.1.2" xref="S2.p5.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.p5.2.m2.1.1.1.1.1" xref="S2.p5.2.m2.1.1.1.1.1.1.cmml"><mo id="S2.p5.2.m2.1.1.1.1.1.2" stretchy="false" xref="S2.p5.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p5.2.m2.1.1.1.1.1.1" xref="S2.p5.2.m2.1.1.1.1.1.1.cmml"><mi id="S2.p5.2.m2.1.1.1.1.1.1.2" xref="S2.p5.2.m2.1.1.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S2.p5.2.m2.1.1.1.1.1.1.1" xref="S2.p5.2.m2.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.p5.2.m2.1.1.1.1.1.1.3" xref="S2.p5.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S2.p5.2.m2.1.1.1.1.1.1.3.2" xref="S2.p5.2.m2.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S2.p5.2.m2.1.1.1.1.1.1.3.3" xref="S2.p5.2.m2.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.p5.2.m2.1.1.1.1.1.3" stretchy="false" xref="S2.p5.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p5.2.m2.2.2.3" xref="S2.p5.2.m2.2.2.3.cmml">≈</mo><mrow id="S2.p5.2.m2.2.2.2" xref="S2.p5.2.m2.2.2.2.cmml"><mi id="S2.p5.2.m2.2.2.2.3" xref="S2.p5.2.m2.2.2.2.3.cmml">p</mi><mo id="S2.p5.2.m2.2.2.2.2" xref="S2.p5.2.m2.2.2.2.2.cmml">⁢</mo><mrow id="S2.p5.2.m2.2.2.2.1.1" xref="S2.p5.2.m2.2.2.2.1.1.1.cmml"><mo id="S2.p5.2.m2.2.2.2.1.1.2" stretchy="false" xref="S2.p5.2.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.p5.2.m2.2.2.2.1.1.1" xref="S2.p5.2.m2.2.2.2.1.1.1.cmml"><mrow id="S2.p5.2.m2.2.2.2.1.1.1.3" xref="S2.p5.2.m2.2.2.2.1.1.1.3.cmml"><mi id="S2.p5.2.m2.2.2.2.1.1.1.3.2" xref="S2.p5.2.m2.2.2.2.1.1.1.3.2.cmml">𝒚</mi><mo fence="false" id="S2.p5.2.m2.2.2.2.1.1.1.3.1" xref="S2.p5.2.m2.2.2.2.1.1.1.3.1.cmml">|</mo><msub id="S2.p5.2.m2.2.2.2.1.1.1.3.3" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3.cmml"><mover accent="true" id="S2.p5.2.m2.2.2.2.1.1.1.3.3.2" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3.2.cmml"><mi id="S2.p5.2.m2.2.2.2.1.1.1.3.3.2.2" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3.2.2.cmml">𝒙</mi><mo id="S2.p5.2.m2.2.2.2.1.1.1.3.3.2.1" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3.2.1.cmml">^</mo></mover><mn id="S2.p5.2.m2.2.2.2.1.1.1.3.3.3" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3.3.cmml">0</mn></msub></mrow><mo id="S2.p5.2.m2.2.2.2.1.1.1.2" lspace="0.278em" rspace="0.278em" xref="S2.p5.2.m2.2.2.2.1.1.1.2.cmml">:=</mo><mrow id="S2.p5.2.m2.2.2.2.1.1.1.1" xref="S2.p5.2.m2.2.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p5.2.m2.2.2.2.1.1.1.1.3" xref="S2.p5.2.m2.2.2.2.1.1.1.1.3.cmml">𝒟</mi><mo id="S2.p5.2.m2.2.2.2.1.1.1.1.2" xref="S2.p5.2.m2.2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.3" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.3.cmml">𝔼</mi><mo id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.2" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mn id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo fence="false" id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.p5.2.m2.2.2.2.1.1.3" stretchy="false" xref="S2.p5.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.2b"><apply id="S2.p5.2.m2.2.2.cmml" xref="S2.p5.2.m2.2.2"><approx id="S2.p5.2.m2.2.2.3.cmml" xref="S2.p5.2.m2.2.2.3"></approx><apply id="S2.p5.2.m2.1.1.1.cmml" xref="S2.p5.2.m2.1.1.1"><times id="S2.p5.2.m2.1.1.1.2.cmml" xref="S2.p5.2.m2.1.1.1.2"></times><ci id="S2.p5.2.m2.1.1.1.3.cmml" xref="S2.p5.2.m2.1.1.1.3">𝑝</ci><apply id="S2.p5.2.m2.1.1.1.1.1.1.cmml" xref="S2.p5.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S2.p5.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.p5.2.m2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p5.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.p5.2.m2.1.1.1.1.1.1.2">𝒚</ci><apply id="S2.p5.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.p5.2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p5.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.p5.2.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p5.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.p5.2.m2.1.1.1.1.1.1.3.2">𝒛</ci><ci id="S2.p5.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.p5.2.m2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S2.p5.2.m2.2.2.2.cmml" xref="S2.p5.2.m2.2.2.2"><times id="S2.p5.2.m2.2.2.2.2.cmml" xref="S2.p5.2.m2.2.2.2.2"></times><ci id="S2.p5.2.m2.2.2.2.3.cmml" xref="S2.p5.2.m2.2.2.2.3">𝑝</ci><apply id="S2.p5.2.m2.2.2.2.1.1.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1"><csymbol cd="latexml" id="S2.p5.2.m2.2.2.2.1.1.1.2.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.2">assign</csymbol><apply id="S2.p5.2.m2.2.2.2.1.1.1.3.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.3"><csymbol cd="latexml" id="S2.p5.2.m2.2.2.2.1.1.1.3.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.3.1">conditional</csymbol><ci id="S2.p5.2.m2.2.2.2.1.1.1.3.2.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.3.2">𝒚</ci><apply id="S2.p5.2.m2.2.2.2.1.1.1.3.3.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p5.2.m2.2.2.2.1.1.1.3.3.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3">subscript</csymbol><apply id="S2.p5.2.m2.2.2.2.1.1.1.3.3.2.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3.2"><ci id="S2.p5.2.m2.2.2.2.1.1.1.3.3.2.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3.2.1">^</ci><ci id="S2.p5.2.m2.2.2.2.1.1.1.3.3.2.2.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3.2.2">𝒙</ci></apply><cn id="S2.p5.2.m2.2.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S2.p5.2.m2.2.2.2.1.1.1.3.3.3">0</cn></apply></apply><apply id="S2.p5.2.m2.2.2.2.1.1.1.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1"><times id="S2.p5.2.m2.2.2.2.1.1.1.1.2.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.2"></times><ci id="S2.p5.2.m2.2.2.2.1.1.1.1.3.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.3">𝒟</ci><apply id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1"><times id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.2"></times><ci id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.3">𝔼</ci><apply id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝒛</ci><cn id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3">0</cn></apply><apply id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝒛</ci><ci id="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.p5.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.2c">p({\bm{y}}|{\bm{z}}_{t})\approx p({\bm{y}}|\hat{{\bm{x}}}_{0}:=\mathcal{D}(%
\mathbb{E}[{\bm{z}}_{0}|{\bm{z}}_{t}]))</annotation><annotation encoding="application/x-llamapun" id="S2.p5.2.m2.2d">italic_p ( bold_italic_y | bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ≈ italic_p ( bold_italic_y | over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT := caligraphic_D ( blackboard_E [ bold_italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] ) )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib28" title="">2023a</a>)</cite>. Two intuitive drawbacks of this approach are that a) the image estimate <math alttext="\hat{{\bm{x}}}_{0}" class="ltx_Math" display="inline" id="S2.p5.3.m3.1"><semantics id="S2.p5.3.m3.1a"><msub id="S2.p5.3.m3.1.1" xref="S2.p5.3.m3.1.1.cmml"><mover accent="true" id="S2.p5.3.m3.1.1.2" xref="S2.p5.3.m3.1.1.2.cmml"><mi id="S2.p5.3.m3.1.1.2.2" xref="S2.p5.3.m3.1.1.2.2.cmml">𝒙</mi><mo id="S2.p5.3.m3.1.1.2.1" xref="S2.p5.3.m3.1.1.2.1.cmml">^</mo></mover><mn id="S2.p5.3.m3.1.1.3" xref="S2.p5.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.p5.3.m3.1b"><apply id="S2.p5.3.m3.1.1.cmml" xref="S2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p5.3.m3.1.1.1.cmml" xref="S2.p5.3.m3.1.1">subscript</csymbol><apply id="S2.p5.3.m3.1.1.2.cmml" xref="S2.p5.3.m3.1.1.2"><ci id="S2.p5.3.m3.1.1.2.1.cmml" xref="S2.p5.3.m3.1.1.2.1">^</ci><ci id="S2.p5.3.m3.1.1.2.2.cmml" xref="S2.p5.3.m3.1.1.2.2">𝒙</ci></apply><cn id="S2.p5.3.m3.1.1.3.cmml" type="integer" xref="S2.p5.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.3.m3.1c">\hat{{\bm{x}}}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.3.m3.1d">over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is reconstructed using an expectation, which results in inaccurate estimations for multi-modal complex distributions, and b) the measurement gradient directly updates the noisy state <math alttext="{\bm{x}}_{t}" class="ltx_Math" display="inline" id="S2.p5.4.m4.1"><semantics id="S2.p5.4.m4.1a"><msub id="S2.p5.4.m4.1.1" xref="S2.p5.4.m4.1.1.cmml"><mi id="S2.p5.4.m4.1.1.2" xref="S2.p5.4.m4.1.1.2.cmml">𝒙</mi><mi id="S2.p5.4.m4.1.1.3" xref="S2.p5.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p5.4.m4.1b"><apply id="S2.p5.4.m4.1.1.cmml" xref="S2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p5.4.m4.1.1.1.cmml" xref="S2.p5.4.m4.1.1">subscript</csymbol><ci id="S2.p5.4.m4.1.1.2.cmml" xref="S2.p5.4.m4.1.1.2">𝒙</ci><ci id="S2.p5.4.m4.1.1.3.cmml" xref="S2.p5.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.4.m4.1c">{\bm{x}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.4.m4.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which may push away the state from the desired noise level at <math alttext="t" class="ltx_Math" display="inline" id="S2.p5.5.m5.1"><semantics id="S2.p5.5.m5.1a"><mi id="S2.p5.5.m5.1.1" xref="S2.p5.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p5.5.m5.1b"><ci id="S2.p5.5.m5.1.1.cmml" xref="S2.p5.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p5.5.m5.1d">italic_t</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p6">
<p class="ltx_p" id="S2.p6.2">Prior works aim to address the first challenge by going beyond first-order statistics <cite class="ltx_cite ltx_citemacro_citep">(Rout et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib24" title="">2024</a>)</cite> or incorporating posterior covariance into the maximum likelihood estimation step <cite class="ltx_cite ltx_citemacro_citep">(Peng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib20" title="">2024</a>)</cite>. Other lines of work address the second issue by decoupling the measurement guidance from the sampling process; they update the data estimate <math alttext="\hat{{\bm{x}}}_{0}" class="ltx_Math" display="inline" id="S2.p6.1.m1.1"><semantics id="S2.p6.1.m1.1a"><msub id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml"><mover accent="true" id="S2.p6.1.m1.1.1.2" xref="S2.p6.1.m1.1.1.2.cmml"><mi id="S2.p6.1.m1.1.1.2.2" xref="S2.p6.1.m1.1.1.2.2.cmml">𝒙</mi><mo id="S2.p6.1.m1.1.1.2.1" xref="S2.p6.1.m1.1.1.2.1.cmml">^</mo></mover><mn id="S2.p6.1.m1.1.1.3" xref="S2.p6.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><apply id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p6.1.m1.1.1.1.cmml" xref="S2.p6.1.m1.1.1">subscript</csymbol><apply id="S2.p6.1.m1.1.1.2.cmml" xref="S2.p6.1.m1.1.1.2"><ci id="S2.p6.1.m1.1.1.2.1.cmml" xref="S2.p6.1.m1.1.1.2.1">^</ci><ci id="S2.p6.1.m1.1.1.2.2.cmml" xref="S2.p6.1.m1.1.1.2.2">𝒙</ci></apply><cn id="S2.p6.1.m1.1.1.3.cmml" type="integer" xref="S2.p6.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">\hat{{\bm{x}}}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.1.m1.1d">over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> at time <math alttext="t" class="ltx_Math" display="inline" id="S2.p6.2.m2.1"><semantics id="S2.p6.2.m2.1a"><mi id="S2.p6.2.m2.1.1" xref="S2.p6.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p6.2.m2.1b"><ci id="S2.p6.2.m2.1.1.cmml" xref="S2.p6.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p6.2.m2.1d">italic_t</annotation></semantics></math> using the measurement gradient before resampling it to the noisy manifold <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib28" title="">2023a</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib39" title="">2024</a>)</cite>. The above-discussed approaches are still highly sensitive to the measurement gradient step size <cite class="ltx_cite ltx_citemacro_citep">(Peng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib20" title="">2024</a>)</cite>. Indeed, balancing the measurement gradient with the unconditional score function remains a significant challenge to solving inverse problems using measurement-guided generation. <cite class="ltx_cite ltx_citemacro_citet">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib38" title="">2024</a>)</cite> avoids the discussed approximations and samples from the posterior directly to resolve the need to find a balance between measurement guidance and the prior process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p7">
<p class="ltx_p" id="S2.p7.5"><span class="ltx_text ltx_font_bold" id="S2.p7.5.1">Projections in diffusion models.</span> Manifold and subspace projections are used in various contexts in diffusion models. <cite class="ltx_cite ltx_citemacro_citet">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib12" title="">2024</a>)</cite> uses a manifold-preserving approach to improve the efficiency of diffusion generation. <cite class="ltx_cite ltx_citemacro_citet">Chung et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib3" title="">2022</a>)</cite> proposes a manifold constraint to project the measurement gradient into the data manifold <math alttext="{\bm{x}}_{0}" class="ltx_Math" display="inline" id="S2.p7.1.m1.1"><semantics id="S2.p7.1.m1.1a"><msub id="S2.p7.1.m1.1.1" xref="S2.p7.1.m1.1.1.cmml"><mi id="S2.p7.1.m1.1.1.2" xref="S2.p7.1.m1.1.1.2.cmml">𝒙</mi><mn id="S2.p7.1.m1.1.1.3" xref="S2.p7.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.p7.1.m1.1b"><apply id="S2.p7.1.m1.1.1.cmml" xref="S2.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.1.cmml" xref="S2.p7.1.m1.1.1">subscript</csymbol><ci id="S2.p7.1.m1.1.1.2.cmml" xref="S2.p7.1.m1.1.1.2">𝒙</ci><cn id="S2.p7.1.m1.1.1.3.cmml" type="integer" xref="S2.p7.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.1.m1.1c">{\bm{x}}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.p7.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>; our proposal is more effective, which projects the measurement gradient on the noisy diffusion state related to <math alttext="{\bm{x}}_{t}" class="ltx_Math" display="inline" id="S2.p7.2.m2.1"><semantics id="S2.p7.2.m2.1a"><msub id="S2.p7.2.m2.1.1" xref="S2.p7.2.m2.1.1.cmml"><mi id="S2.p7.2.m2.1.1.2" xref="S2.p7.2.m2.1.1.2.cmml">𝒙</mi><mi id="S2.p7.2.m2.1.1.3" xref="S2.p7.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p7.2.m2.1b"><apply id="S2.p7.2.m2.1.1.cmml" xref="S2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p7.2.m2.1.1.1.cmml" xref="S2.p7.2.m2.1.1">subscript</csymbol><ci id="S2.p7.2.m2.1.1.2.cmml" xref="S2.p7.2.m2.1.1.2">𝒙</ci><ci id="S2.p7.2.m2.1.1.3.cmml" xref="S2.p7.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.2.m2.1c">{\bm{x}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p7.2.m2.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> or <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S2.p7.3.m3.1"><semantics id="S2.p7.3.m3.1a"><msub id="S2.p7.3.m3.1.1" xref="S2.p7.3.m3.1.1.cmml"><mi id="S2.p7.3.m3.1.1.2" xref="S2.p7.3.m3.1.1.2.cmml">𝒛</mi><mi id="S2.p7.3.m3.1.1.3" xref="S2.p7.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p7.3.m3.1b"><apply id="S2.p7.3.m3.1.1.cmml" xref="S2.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p7.3.m3.1.1.1.cmml" xref="S2.p7.3.m3.1.1">subscript</csymbol><ci id="S2.p7.3.m3.1.1.2.cmml" xref="S2.p7.3.m3.1.1.2">𝒛</ci><ci id="S2.p7.3.m3.1.1.3.cmml" xref="S2.p7.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.3.m3.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p7.3.m3.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to stay close to <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="S2.p7.4.m4.1"><semantics id="S2.p7.4.m4.1a"><msub id="S2.p7.4.m4.1.1" xref="S2.p7.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p7.4.m4.1.1.2" xref="S2.p7.4.m4.1.1.2.cmml">ℳ</mi><mi id="S2.p7.4.m4.1.1.3" xref="S2.p7.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p7.4.m4.1b"><apply id="S2.p7.4.m4.1.1.cmml" xref="S2.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p7.4.m4.1.1.1.cmml" xref="S2.p7.4.m4.1.1">subscript</csymbol><ci id="S2.p7.4.m4.1.1.2.cmml" xref="S2.p7.4.m4.1.1.2">ℳ</ci><ci id="S2.p7.4.m4.1.1.3.cmml" xref="S2.p7.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.4.m4.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p7.4.m4.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> rather than <math alttext="\mathcal{M}_{0}" class="ltx_Math" display="inline" id="S2.p7.5.m5.1"><semantics id="S2.p7.5.m5.1a"><msub id="S2.p7.5.m5.1.1" xref="S2.p7.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p7.5.m5.1.1.2" xref="S2.p7.5.m5.1.1.2.cmml">ℳ</mi><mn id="S2.p7.5.m5.1.1.3" xref="S2.p7.5.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.p7.5.m5.1b"><apply id="S2.p7.5.m5.1.1.cmml" xref="S2.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p7.5.m5.1.1.1.cmml" xref="S2.p7.5.m5.1.1">subscript</csymbol><ci id="S2.p7.5.m5.1.1.2.cmml" xref="S2.p7.5.m5.1.1.2">ℳ</ci><cn id="S2.p7.5.m5.1.1.3.cmml" type="integer" xref="S2.p7.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.5.m5.1c">\mathcal{M}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.p7.5.m5.1d">caligraphic_M start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p8">
<p class="ltx_p" id="S2.p8.1"><span class="ltx_text ltx_font_bold" id="S2.p8.1.1">Conditional diffusion models for inverse problems.</span> We focus on unconditional diffusion models as learned priors to solve general inverse problems. This approach leverages <em class="ltx_emph ltx_font_italic" id="S2.p8.1.2">already trained</em> diffusion models, which is useful for domains with abundant data. Another approach is to train conditional diffusion models where <math alttext="\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{y}}\mid{\bm{x}}_{t})" class="ltx_Math" display="inline" id="S2.p8.1.m1.1"><semantics id="S2.p8.1.m1.1a"><mrow id="S2.p8.1.m1.1.1" xref="S2.p8.1.m1.1.1.cmml"><mrow id="S2.p8.1.m1.1.1.3" xref="S2.p8.1.m1.1.1.3.cmml"><mrow id="S2.p8.1.m1.1.1.3.1" xref="S2.p8.1.m1.1.1.3.1.cmml"><msub id="S2.p8.1.m1.1.1.3.1.1" xref="S2.p8.1.m1.1.1.3.1.1.cmml"><mo id="S2.p8.1.m1.1.1.3.1.1.2" xref="S2.p8.1.m1.1.1.3.1.1.2.cmml">∇</mo><msub id="S2.p8.1.m1.1.1.3.1.1.3" xref="S2.p8.1.m1.1.1.3.1.1.3.cmml"><mi id="S2.p8.1.m1.1.1.3.1.1.3.2" xref="S2.p8.1.m1.1.1.3.1.1.3.2.cmml">𝒙</mi><mi id="S2.p8.1.m1.1.1.3.1.1.3.3" xref="S2.p8.1.m1.1.1.3.1.1.3.3.cmml">t</mi></msub></msub><mi id="S2.p8.1.m1.1.1.3.1.2" xref="S2.p8.1.m1.1.1.3.1.2.cmml">log</mi></mrow><mo id="S2.p8.1.m1.1.1.3a" lspace="0.167em" xref="S2.p8.1.m1.1.1.3.cmml">⁡</mo><msub id="S2.p8.1.m1.1.1.3.2" xref="S2.p8.1.m1.1.1.3.2.cmml"><mi id="S2.p8.1.m1.1.1.3.2.2" xref="S2.p8.1.m1.1.1.3.2.2.cmml">p</mi><mi id="S2.p8.1.m1.1.1.3.2.3" xref="S2.p8.1.m1.1.1.3.2.3.cmml">t</mi></msub></mrow><mo id="S2.p8.1.m1.1.1.2" xref="S2.p8.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p8.1.m1.1.1.1.1" xref="S2.p8.1.m1.1.1.1.1.1.cmml"><mo id="S2.p8.1.m1.1.1.1.1.2" stretchy="false" xref="S2.p8.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p8.1.m1.1.1.1.1.1" xref="S2.p8.1.m1.1.1.1.1.1.cmml"><mi id="S2.p8.1.m1.1.1.1.1.1.2" xref="S2.p8.1.m1.1.1.1.1.1.2.cmml">𝒚</mi><mo id="S2.p8.1.m1.1.1.1.1.1.1" xref="S2.p8.1.m1.1.1.1.1.1.1.cmml">∣</mo><msub id="S2.p8.1.m1.1.1.1.1.1.3" xref="S2.p8.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.p8.1.m1.1.1.1.1.1.3.2" xref="S2.p8.1.m1.1.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.p8.1.m1.1.1.1.1.1.3.3" xref="S2.p8.1.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.p8.1.m1.1.1.1.1.3" stretchy="false" xref="S2.p8.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.1.m1.1b"><apply id="S2.p8.1.m1.1.1.cmml" xref="S2.p8.1.m1.1.1"><times id="S2.p8.1.m1.1.1.2.cmml" xref="S2.p8.1.m1.1.1.2"></times><apply id="S2.p8.1.m1.1.1.3.cmml" xref="S2.p8.1.m1.1.1.3"><apply id="S2.p8.1.m1.1.1.3.1.cmml" xref="S2.p8.1.m1.1.1.3.1"><apply id="S2.p8.1.m1.1.1.3.1.1.cmml" xref="S2.p8.1.m1.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.p8.1.m1.1.1.3.1.1.1.cmml" xref="S2.p8.1.m1.1.1.3.1.1">subscript</csymbol><ci id="S2.p8.1.m1.1.1.3.1.1.2.cmml" xref="S2.p8.1.m1.1.1.3.1.1.2">∇</ci><apply id="S2.p8.1.m1.1.1.3.1.1.3.cmml" xref="S2.p8.1.m1.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S2.p8.1.m1.1.1.3.1.1.3.1.cmml" xref="S2.p8.1.m1.1.1.3.1.1.3">subscript</csymbol><ci id="S2.p8.1.m1.1.1.3.1.1.3.2.cmml" xref="S2.p8.1.m1.1.1.3.1.1.3.2">𝒙</ci><ci id="S2.p8.1.m1.1.1.3.1.1.3.3.cmml" xref="S2.p8.1.m1.1.1.3.1.1.3.3">𝑡</ci></apply></apply><log id="S2.p8.1.m1.1.1.3.1.2.cmml" xref="S2.p8.1.m1.1.1.3.1.2"></log></apply><apply id="S2.p8.1.m1.1.1.3.2.cmml" xref="S2.p8.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.p8.1.m1.1.1.3.2.1.cmml" xref="S2.p8.1.m1.1.1.3.2">subscript</csymbol><ci id="S2.p8.1.m1.1.1.3.2.2.cmml" xref="S2.p8.1.m1.1.1.3.2.2">𝑝</ci><ci id="S2.p8.1.m1.1.1.3.2.3.cmml" xref="S2.p8.1.m1.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S2.p8.1.m1.1.1.1.1.1.cmml" xref="S2.p8.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.p8.1.m1.1.1.1.1.1.1.cmml" xref="S2.p8.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p8.1.m1.1.1.1.1.1.2.cmml" xref="S2.p8.1.m1.1.1.1.1.1.2">𝒚</ci><apply id="S2.p8.1.m1.1.1.1.1.1.3.cmml" xref="S2.p8.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p8.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.p8.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p8.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.p8.1.m1.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.p8.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.p8.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.1.m1.1c">\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{y}}\mid{\bm{x}}_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.p8.1.m1.1d">∇ start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_y ∣ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is directly captured by the score function, or where the diffusion directly transforms the measurement into the underlying data (e.g., image-to-image diffusion) <cite class="ltx_cite ltx_citemacro_citep">(Saharia et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib25" title="">2022</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib17" title="">2023</a>; Chung et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib5" title="">2024</a>)</cite>. This latter approach is problem-specific; hence, it is not generalizable across inverse tasks.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Diffusion State-Guided Projected Gradient (DiffStateGrad)</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We propose a <span class="ltx_text ltx_font_italic" id="S3.p1.1.1">Diffusion State-Guided Projected Gradient</span> (DiffStateGrad) to solve general inverse problems. DiffStateGrad can be incorporated into a wide range of diffusion models to improve guidance-based diffusion models. Without loss of generality, we explain DiffStateGrad in the context of Latent-DPS <cite class="ltx_cite ltx_citemacro_citep">(Chung et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib4" title="">2023</a>)</cite> and note that DiffStateGrad applies to a wide range of pixel and latent diffusion-based inverse solvers (see <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4" title="4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.3">Given <math alttext="{\bm{z}}_{t+1}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">𝒛</mi><mrow id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml"><mi id="S3.p2.1.m1.1.1.3.2" xref="S3.p2.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.p2.1.m1.1.1.3.1" xref="S3.p2.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.p2.1.m1.1.1.3.3" xref="S3.p2.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝒛</ci><apply id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3"><plus id="S3.p2.1.m1.1.1.3.1.cmml" xref="S3.p2.1.m1.1.1.3.1"></plus><ci id="S3.p2.1.m1.1.1.3.2.cmml" xref="S3.p2.1.m1.1.1.3.2">𝑡</ci><cn id="S3.p2.1.m1.1.1.3.3.cmml" type="integer" xref="S3.p2.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">{\bm{z}}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, we sample <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">𝒛</mi><mi id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝒛</ci><ci id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> from the unconditional reverse process, and then compute the estimate <math alttext="\hat{\bm{z}}_{0}({\bm{z}}_{t})\coloneqq\mathcal{D}(\mathbb{E}[{\bm{z}}_{0}\mid%
{\bm{z}}_{t}])" class="ltx_Math" display="inline" id="S3.p2.3.m3.2"><semantics id="S3.p2.3.m3.2a"><mrow id="S3.p2.3.m3.2.2" xref="S3.p2.3.m3.2.2.cmml"><mrow id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml"><msub id="S3.p2.3.m3.1.1.1.3" xref="S3.p2.3.m3.1.1.1.3.cmml"><mover accent="true" id="S3.p2.3.m3.1.1.1.3.2" xref="S3.p2.3.m3.1.1.1.3.2.cmml"><mi id="S3.p2.3.m3.1.1.1.3.2.2" xref="S3.p2.3.m3.1.1.1.3.2.2.cmml">𝒛</mi><mo id="S3.p2.3.m3.1.1.1.3.2.1" xref="S3.p2.3.m3.1.1.1.3.2.1.cmml">^</mo></mover><mn id="S3.p2.3.m3.1.1.1.3.3" xref="S3.p2.3.m3.1.1.1.3.3.cmml">0</mn></msub><mo id="S3.p2.3.m3.1.1.1.2" xref="S3.p2.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.p2.3.m3.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.p2.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.p2.3.m3.1.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.p2.3.m3.1.1.1.1.1.1.2" xref="S3.p2.3.m3.1.1.1.1.1.1.2.cmml">𝒛</mi><mi id="S3.p2.3.m3.1.1.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p2.3.m3.1.1.1.1.1.3" stretchy="false" xref="S3.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p2.3.m3.2.2.3" xref="S3.p2.3.m3.2.2.3.cmml">≔</mo><mrow id="S3.p2.3.m3.2.2.2" xref="S3.p2.3.m3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.m3.2.2.2.3" xref="S3.p2.3.m3.2.2.2.3.cmml">𝒟</mi><mo id="S3.p2.3.m3.2.2.2.2" xref="S3.p2.3.m3.2.2.2.2.cmml">⁢</mo><mrow id="S3.p2.3.m3.2.2.2.1.1" xref="S3.p2.3.m3.2.2.2.1.1.1.cmml"><mo id="S3.p2.3.m3.2.2.2.1.1.2" stretchy="false" xref="S3.p2.3.m3.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.p2.3.m3.2.2.2.1.1.1" xref="S3.p2.3.m3.2.2.2.1.1.1.cmml"><mi id="S3.p2.3.m3.2.2.2.1.1.1.3" xref="S3.p2.3.m3.2.2.2.1.1.1.3.cmml">𝔼</mi><mo id="S3.p2.3.m3.2.2.2.1.1.1.2" xref="S3.p2.3.m3.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.p2.3.m3.2.2.2.1.1.1.1.1" xref="S3.p2.3.m3.2.2.2.1.1.1.1.2.cmml"><mo id="S3.p2.3.m3.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.p2.3.m3.2.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.cmml"><msub id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.2" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mn id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.3" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.1" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.2" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.3" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.p2.3.m3.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.p2.3.m3.2.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.p2.3.m3.2.2.2.1.1.3" stretchy="false" xref="S3.p2.3.m3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.2b"><apply id="S3.p2.3.m3.2.2.cmml" xref="S3.p2.3.m3.2.2"><ci id="S3.p2.3.m3.2.2.3.cmml" xref="S3.p2.3.m3.2.2.3">≔</ci><apply id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"><times id="S3.p2.3.m3.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.2"></times><apply id="S3.p2.3.m3.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.3.1.cmml" xref="S3.p2.3.m3.1.1.1.3">subscript</csymbol><apply id="S3.p2.3.m3.1.1.1.3.2.cmml" xref="S3.p2.3.m3.1.1.1.3.2"><ci id="S3.p2.3.m3.1.1.1.3.2.1.cmml" xref="S3.p2.3.m3.1.1.1.3.2.1">^</ci><ci id="S3.p2.3.m3.1.1.1.3.2.2.cmml" xref="S3.p2.3.m3.1.1.1.3.2.2">𝒛</ci></apply><cn id="S3.p2.3.m3.1.1.1.3.3.cmml" type="integer" xref="S3.p2.3.m3.1.1.1.3.3">0</cn></apply><apply id="S3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.2">𝒛</ci><ci id="S3.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.p2.3.m3.2.2.2.cmml" xref="S3.p2.3.m3.2.2.2"><times id="S3.p2.3.m3.2.2.2.2.cmml" xref="S3.p2.3.m3.2.2.2.2"></times><ci id="S3.p2.3.m3.2.2.2.3.cmml" xref="S3.p2.3.m3.2.2.2.3">𝒟</ci><apply id="S3.p2.3.m3.2.2.2.1.1.1.cmml" xref="S3.p2.3.m3.2.2.2.1.1"><times id="S3.p2.3.m3.2.2.2.1.1.1.2.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.2"></times><ci id="S3.p2.3.m3.2.2.2.1.1.1.3.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.3">𝔼</ci><apply id="S3.p2.3.m3.2.2.2.1.1.1.1.2.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.p2.3.m3.2.2.2.1.1.1.1.2.1.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.2">𝒛</ci><cn id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.2.3">0</cn></apply><apply id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.2">𝒛</ci><ci id="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.p2.3.m3.2.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.2c">\hat{\bm{z}}_{0}({\bm{z}}_{t})\coloneqq\mathcal{D}(\mathbb{E}[{\bm{z}}_{0}\mid%
{\bm{z}}_{t}])</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.2d">over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ≔ caligraphic_D ( blackboard_E [ bold_italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∣ bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] )</annotation></semantics></math>. Then, the data-consistency guidance term can be incorporated as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{z}}_{t}\leftarrow{\bm{z}}_{t}-\eta_{t}\mathcal{P}_{\mathcal{S}_{t}}(\bm{g%
}_{t})," class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E5.m1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.2.cmml">←</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S3.E5.m1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.3.2.cmml">η</mi><mi id="S3.E5.m1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E5.m1.1.1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.1.1.4.2" xref="S3.E5.m1.1.1.1.1.1.1.4.2.cmml">𝒫</mi><msub id="S3.E5.m1.1.1.1.1.1.1.4.3" xref="S3.E5.m1.1.1.1.1.1.1.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.1.1.4.3.2" xref="S3.E5.m1.1.1.1.1.1.1.4.3.2.cmml">𝒮</mi><mi id="S3.E5.m1.1.1.1.1.1.1.4.3.3" xref="S3.E5.m1.1.1.1.1.1.1.4.3.3.cmml">t</mi></msub></msub><mo id="S3.E5.m1.1.1.1.1.1.1.2a" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒈</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><ci id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2">←</ci><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2">𝒛</ci><ci id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><minus id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2"></minus><apply id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.3.2">𝒛</ci><ci id="S3.E5.m1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2">𝜂</ci><ci id="S3.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2">𝒫</ci><apply id="S3.E5.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.3.2">𝒮</ci><ci id="S3.E5.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.3.3">𝑡</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2">𝒈</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">{\bm{z}}_{t}\leftarrow{\bm{z}}_{t}-\eta_{t}\mathcal{P}_{\mathcal{S}_{t}}(\bm{g%
}_{t}),</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.10">where <math alttext="\bm{g}_{t}=\nabla_{{\bm{z}}_{t+1}}\log p({\bm{y}}\mid\hat{\bm{z}}_{0}({\bm{z}}%
_{t}))" class="ltx_Math" display="inline" id="S3.p2.4.m1.1"><semantics id="S3.p2.4.m1.1a"><mrow id="S3.p2.4.m1.1.1" xref="S3.p2.4.m1.1.1.cmml"><msub id="S3.p2.4.m1.1.1.3" xref="S3.p2.4.m1.1.1.3.cmml"><mi id="S3.p2.4.m1.1.1.3.2" xref="S3.p2.4.m1.1.1.3.2.cmml">𝒈</mi><mi id="S3.p2.4.m1.1.1.3.3" xref="S3.p2.4.m1.1.1.3.3.cmml">t</mi></msub><mo id="S3.p2.4.m1.1.1.2" xref="S3.p2.4.m1.1.1.2.cmml">=</mo><mrow id="S3.p2.4.m1.1.1.1" xref="S3.p2.4.m1.1.1.1.cmml"><mrow id="S3.p2.4.m1.1.1.1.3" xref="S3.p2.4.m1.1.1.1.3.cmml"><mrow id="S3.p2.4.m1.1.1.1.3.1" xref="S3.p2.4.m1.1.1.1.3.1.cmml"><msub id="S3.p2.4.m1.1.1.1.3.1.1" xref="S3.p2.4.m1.1.1.1.3.1.1.cmml"><mo id="S3.p2.4.m1.1.1.1.3.1.1.2" rspace="0.167em" xref="S3.p2.4.m1.1.1.1.3.1.1.2.cmml">∇</mo><msub id="S3.p2.4.m1.1.1.1.3.1.1.3" xref="S3.p2.4.m1.1.1.1.3.1.1.3.cmml"><mi id="S3.p2.4.m1.1.1.1.3.1.1.3.2" xref="S3.p2.4.m1.1.1.1.3.1.1.3.2.cmml">𝒛</mi><mrow id="S3.p2.4.m1.1.1.1.3.1.1.3.3" xref="S3.p2.4.m1.1.1.1.3.1.1.3.3.cmml"><mi id="S3.p2.4.m1.1.1.1.3.1.1.3.3.2" xref="S3.p2.4.m1.1.1.1.3.1.1.3.3.2.cmml">t</mi><mo id="S3.p2.4.m1.1.1.1.3.1.1.3.3.1" xref="S3.p2.4.m1.1.1.1.3.1.1.3.3.1.cmml">+</mo><mn id="S3.p2.4.m1.1.1.1.3.1.1.3.3.3" xref="S3.p2.4.m1.1.1.1.3.1.1.3.3.3.cmml">1</mn></mrow></msub></msub><mi id="S3.p2.4.m1.1.1.1.3.1.2" xref="S3.p2.4.m1.1.1.1.3.1.2.cmml">log</mi></mrow><mo id="S3.p2.4.m1.1.1.1.3a" lspace="0.167em" xref="S3.p2.4.m1.1.1.1.3.cmml">⁡</mo><mi id="S3.p2.4.m1.1.1.1.3.2" xref="S3.p2.4.m1.1.1.1.3.2.cmml">p</mi></mrow><mo id="S3.p2.4.m1.1.1.1.2" xref="S3.p2.4.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.p2.4.m1.1.1.1.1.1" xref="S3.p2.4.m1.1.1.1.1.1.1.cmml"><mo id="S3.p2.4.m1.1.1.1.1.1.2" stretchy="false" xref="S3.p2.4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p2.4.m1.1.1.1.1.1.1" xref="S3.p2.4.m1.1.1.1.1.1.1.cmml"><mi id="S3.p2.4.m1.1.1.1.1.1.1.3" xref="S3.p2.4.m1.1.1.1.1.1.1.3.cmml">𝒚</mi><mo id="S3.p2.4.m1.1.1.1.1.1.1.2" xref="S3.p2.4.m1.1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S3.p2.4.m1.1.1.1.1.1.1.1" xref="S3.p2.4.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.p2.4.m1.1.1.1.1.1.1.1.3" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.p2.4.m1.1.1.1.1.1.1.1.3.2" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.p2.4.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3.2.2.cmml">𝒛</mi><mo id="S3.p2.4.m1.1.1.1.1.1.1.1.3.2.1" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mn id="S3.p2.4.m1.1.1.1.1.1.1.1.3.3" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="S3.p2.4.m1.1.1.1.1.1.1.1.2" xref="S3.p2.4.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.p2.4.m1.1.1.1.1.1.1.1.1.1" xref="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mi id="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.p2.4.m1.1.1.1.1.1.3" stretchy="false" xref="S3.p2.4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m1.1b"><apply id="S3.p2.4.m1.1.1.cmml" xref="S3.p2.4.m1.1.1"><eq id="S3.p2.4.m1.1.1.2.cmml" xref="S3.p2.4.m1.1.1.2"></eq><apply id="S3.p2.4.m1.1.1.3.cmml" xref="S3.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.4.m1.1.1.3.1.cmml" xref="S3.p2.4.m1.1.1.3">subscript</csymbol><ci id="S3.p2.4.m1.1.1.3.2.cmml" xref="S3.p2.4.m1.1.1.3.2">𝒈</ci><ci id="S3.p2.4.m1.1.1.3.3.cmml" xref="S3.p2.4.m1.1.1.3.3">𝑡</ci></apply><apply id="S3.p2.4.m1.1.1.1.cmml" xref="S3.p2.4.m1.1.1.1"><times id="S3.p2.4.m1.1.1.1.2.cmml" xref="S3.p2.4.m1.1.1.1.2"></times><apply id="S3.p2.4.m1.1.1.1.3.cmml" xref="S3.p2.4.m1.1.1.1.3"><apply id="S3.p2.4.m1.1.1.1.3.1.cmml" xref="S3.p2.4.m1.1.1.1.3.1"><apply id="S3.p2.4.m1.1.1.1.3.1.1.cmml" xref="S3.p2.4.m1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m1.1.1.1.3.1.1.1.cmml" xref="S3.p2.4.m1.1.1.1.3.1.1">subscript</csymbol><ci id="S3.p2.4.m1.1.1.1.3.1.1.2.cmml" xref="S3.p2.4.m1.1.1.1.3.1.1.2">∇</ci><apply id="S3.p2.4.m1.1.1.1.3.1.1.3.cmml" xref="S3.p2.4.m1.1.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S3.p2.4.m1.1.1.1.3.1.1.3.1.cmml" xref="S3.p2.4.m1.1.1.1.3.1.1.3">subscript</csymbol><ci id="S3.p2.4.m1.1.1.1.3.1.1.3.2.cmml" xref="S3.p2.4.m1.1.1.1.3.1.1.3.2">𝒛</ci><apply id="S3.p2.4.m1.1.1.1.3.1.1.3.3.cmml" xref="S3.p2.4.m1.1.1.1.3.1.1.3.3"><plus id="S3.p2.4.m1.1.1.1.3.1.1.3.3.1.cmml" xref="S3.p2.4.m1.1.1.1.3.1.1.3.3.1"></plus><ci id="S3.p2.4.m1.1.1.1.3.1.1.3.3.2.cmml" xref="S3.p2.4.m1.1.1.1.3.1.1.3.3.2">𝑡</ci><cn id="S3.p2.4.m1.1.1.1.3.1.1.3.3.3.cmml" type="integer" xref="S3.p2.4.m1.1.1.1.3.1.1.3.3.3">1</cn></apply></apply></apply><log id="S3.p2.4.m1.1.1.1.3.1.2.cmml" xref="S3.p2.4.m1.1.1.1.3.1.2"></log></apply><ci id="S3.p2.4.m1.1.1.1.3.2.cmml" xref="S3.p2.4.m1.1.1.1.3.2">𝑝</ci></apply><apply id="S3.p2.4.m1.1.1.1.1.1.1.cmml" xref="S3.p2.4.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.p2.4.m1.1.1.1.1.1.1.2.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S3.p2.4.m1.1.1.1.1.1.1.3.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.3">𝒚</ci><apply id="S3.p2.4.m1.1.1.1.1.1.1.1.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1"><times id="S3.p2.4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1.2"></times><apply id="S3.p2.4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.4.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.p2.4.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3.2"><ci id="S3.p2.4.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.p2.4.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3.2.2">𝒛</ci></apply><cn id="S3.p2.4.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.p2.4.m1.1.1.1.1.1.1.1.3.3">0</cn></apply><apply id="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.2">𝒛</ci><ci id="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.4.m1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m1.1c">\bm{g}_{t}=\nabla_{{\bm{z}}_{t+1}}\log p({\bm{y}}\mid\hat{\bm{z}}_{0}({\bm{z}}%
_{t}))</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m1.1d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∇ start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p ( bold_italic_y ∣ over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) )</annotation></semantics></math> is the measurement gradient (MG), <math alttext="\eta_{t}" class="ltx_Math" display="inline" id="S3.p2.5.m2.1"><semantics id="S3.p2.5.m2.1a"><msub id="S3.p2.5.m2.1.1" xref="S3.p2.5.m2.1.1.cmml"><mi id="S3.p2.5.m2.1.1.2" xref="S3.p2.5.m2.1.1.2.cmml">η</mi><mi id="S3.p2.5.m2.1.1.3" xref="S3.p2.5.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.5.m2.1b"><apply id="S3.p2.5.m2.1.1.cmml" xref="S3.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m2.1.1.1.cmml" xref="S3.p2.5.m2.1.1">subscript</csymbol><ci id="S3.p2.5.m2.1.1.2.cmml" xref="S3.p2.5.m2.1.1.2">𝜂</ci><ci id="S3.p2.5.m2.1.1.3.cmml" xref="S3.p2.5.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m2.1c">\eta_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m2.1d">italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the step size, and <math alttext="\mathcal{P}_{\mathcal{S}_{t}}" class="ltx_Math" display="inline" id="S3.p2.6.m3.1"><semantics id="S3.p2.6.m3.1a"><msub id="S3.p2.6.m3.1.1" xref="S3.p2.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.6.m3.1.1.2" xref="S3.p2.6.m3.1.1.2.cmml">𝒫</mi><msub id="S3.p2.6.m3.1.1.3" xref="S3.p2.6.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.6.m3.1.1.3.2" xref="S3.p2.6.m3.1.1.3.2.cmml">𝒮</mi><mi id="S3.p2.6.m3.1.1.3.3" xref="S3.p2.6.m3.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.p2.6.m3.1b"><apply id="S3.p2.6.m3.1.1.cmml" xref="S3.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m3.1.1.1.cmml" xref="S3.p2.6.m3.1.1">subscript</csymbol><ci id="S3.p2.6.m3.1.1.2.cmml" xref="S3.p2.6.m3.1.1.2">𝒫</ci><apply id="S3.p2.6.m3.1.1.3.cmml" xref="S3.p2.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p2.6.m3.1.1.3.1.cmml" xref="S3.p2.6.m3.1.1.3">subscript</csymbol><ci id="S3.p2.6.m3.1.1.3.2.cmml" xref="S3.p2.6.m3.1.1.3.2">𝒮</ci><ci id="S3.p2.6.m3.1.1.3.3.cmml" xref="S3.p2.6.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m3.1c">\mathcal{P}_{\mathcal{S}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.m3.1d">caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is a projection step onto the low-rank subspace <math alttext="\mathcal{S}_{t}" class="ltx_Math" display="inline" id="S3.p2.7.m4.1"><semantics id="S3.p2.7.m4.1a"><msub id="S3.p2.7.m4.1.1" xref="S3.p2.7.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.7.m4.1.1.2" xref="S3.p2.7.m4.1.1.2.cmml">𝒮</mi><mi id="S3.p2.7.m4.1.1.3" xref="S3.p2.7.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m4.1b"><apply id="S3.p2.7.m4.1.1.cmml" xref="S3.p2.7.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m4.1.1.1.cmml" xref="S3.p2.7.m4.1.1">subscript</csymbol><ci id="S3.p2.7.m4.1.1.2.cmml" xref="S3.p2.7.m4.1.1.2">𝒮</ci><ci id="S3.p2.7.m4.1.1.3.cmml" xref="S3.p2.7.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m4.1c">\mathcal{S}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.m4.1d">caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The main contribution of this paper is to define this subspace so it results in better posterior sampling; in other words, to define a subspace such that when the measurement gradient is projected onto, the diffusion process is not disturbed and pushed away from the data manifold. We show in <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S1.T1" title="In 1 Introduction ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a> that indeed the subspace <math alttext="\mathcal{S}_{t}" class="ltx_Math" display="inline" id="S3.p2.8.m5.1"><semantics id="S3.p2.8.m5.1a"><msub id="S3.p2.8.m5.1.1" xref="S3.p2.8.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.8.m5.1.1.2" xref="S3.p2.8.m5.1.1.2.cmml">𝒮</mi><mi id="S3.p2.8.m5.1.1.3" xref="S3.p2.8.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.8.m5.1b"><apply id="S3.p2.8.m5.1.1.cmml" xref="S3.p2.8.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m5.1.1.1.cmml" xref="S3.p2.8.m5.1.1">subscript</csymbol><ci id="S3.p2.8.m5.1.1.2.cmml" xref="S3.p2.8.m5.1.1.2">𝒮</ci><ci id="S3.p2.8.m5.1.1.3.cmml" xref="S3.p2.8.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m5.1c">\mathcal{S}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.8.m5.1d">caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, defined by the intermediate diffusion state, results in an improved posterior sampling, unlike a subspace that is constructed based on a random matrix or the low-rank structure of the measurement gradient. Hence, we choose the diffusion state <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p2.9.m6.1"><semantics id="S3.p2.9.m6.1a"><msub id="S3.p2.9.m6.1.1" xref="S3.p2.9.m6.1.1.cmml"><mi id="S3.p2.9.m6.1.1.2" xref="S3.p2.9.m6.1.1.2.cmml">𝒛</mi><mi id="S3.p2.9.m6.1.1.3" xref="S3.p2.9.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.9.m6.1b"><apply id="S3.p2.9.m6.1.1.cmml" xref="S3.p2.9.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m6.1.1.1.cmml" xref="S3.p2.9.m6.1.1">subscript</csymbol><ci id="S3.p2.9.m6.1.1.2.cmml" xref="S3.p2.9.m6.1.1.2">𝒛</ci><ci id="S3.p2.9.m6.1.1.3.cmml" xref="S3.p2.9.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m6.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.9.m6.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to define <math alttext="\mathcal{S}_{t}" class="ltx_Math" display="inline" id="S3.p2.10.m7.1"><semantics id="S3.p2.10.m7.1a"><msub id="S3.p2.10.m7.1.1" xref="S3.p2.10.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.10.m7.1.1.2" xref="S3.p2.10.m7.1.1.2.cmml">𝒮</mi><mi id="S3.p2.10.m7.1.1.3" xref="S3.p2.10.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.10.m7.1b"><apply id="S3.p2.10.m7.1.1.cmml" xref="S3.p2.10.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m7.1.1.1.cmml" xref="S3.p2.10.m7.1.1">subscript</csymbol><ci id="S3.p2.10.m7.1.1.2.cmml" xref="S3.p2.10.m7.1.1.2">𝒮</ci><ci id="S3.p2.10.m7.1.1.3.cmml" xref="S3.p2.10.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m7.1c">\mathcal{S}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.10.m7.1d">caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p3">
<p class="ltx_p" id="S3.p3.9">We focus on images as our data modality and implement the projection <math alttext="\mathcal{P}_{\mathcal{S}_{t}}" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">𝒫</mi><msub id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.1.m1.1.1.3.2" xref="S3.p3.1.m1.1.1.3.2.cmml">𝒮</mi><mi id="S3.p3.1.m1.1.1.3.3" xref="S3.p3.1.m1.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝒫</ci><apply id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.3.1.cmml" xref="S3.p3.1.m1.1.1.3">subscript</csymbol><ci id="S3.p3.1.m1.1.1.3.2.cmml" xref="S3.p3.1.m1.1.1.3.2">𝒮</ci><ci id="S3.p3.1.m1.1.1.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\mathcal{P}_{\mathcal{S}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> by computing the SVD of <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">𝒛</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝒛</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in its image matrix form, denoted by <math alttext="\bm{Z}_{t}" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">𝒁</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝒁</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">\bm{Z}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">bold_italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (i.e., <math alttext="\bm{U},\bm{S},\bm{V}\leftarrow\text{SVD}(\bm{Z}_{t})" class="ltx_Math" display="inline" id="S3.p3.4.m4.4"><semantics id="S3.p3.4.m4.4a"><mrow id="S3.p3.4.m4.4.4" xref="S3.p3.4.m4.4.4.cmml"><mrow id="S3.p3.4.m4.4.4.3.2" xref="S3.p3.4.m4.4.4.3.1.cmml"><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">𝑼</mi><mo id="S3.p3.4.m4.4.4.3.2.1" xref="S3.p3.4.m4.4.4.3.1.cmml">,</mo><mi id="S3.p3.4.m4.2.2" xref="S3.p3.4.m4.2.2.cmml">𝑺</mi><mo id="S3.p3.4.m4.4.4.3.2.2" xref="S3.p3.4.m4.4.4.3.1.cmml">,</mo><mi id="S3.p3.4.m4.3.3" xref="S3.p3.4.m4.3.3.cmml">𝑽</mi></mrow><mo id="S3.p3.4.m4.4.4.2" stretchy="false" xref="S3.p3.4.m4.4.4.2.cmml">←</mo><mrow id="S3.p3.4.m4.4.4.1" xref="S3.p3.4.m4.4.4.1.cmml"><mtext id="S3.p3.4.m4.4.4.1.3" xref="S3.p3.4.m4.4.4.1.3a.cmml">SVD</mtext><mo id="S3.p3.4.m4.4.4.1.2" xref="S3.p3.4.m4.4.4.1.2.cmml">⁢</mo><mrow id="S3.p3.4.m4.4.4.1.1.1" xref="S3.p3.4.m4.4.4.1.1.1.1.cmml"><mo id="S3.p3.4.m4.4.4.1.1.1.2" stretchy="false" xref="S3.p3.4.m4.4.4.1.1.1.1.cmml">(</mo><msub id="S3.p3.4.m4.4.4.1.1.1.1" xref="S3.p3.4.m4.4.4.1.1.1.1.cmml"><mi id="S3.p3.4.m4.4.4.1.1.1.1.2" xref="S3.p3.4.m4.4.4.1.1.1.1.2.cmml">𝒁</mi><mi id="S3.p3.4.m4.4.4.1.1.1.1.3" xref="S3.p3.4.m4.4.4.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p3.4.m4.4.4.1.1.1.3" stretchy="false" xref="S3.p3.4.m4.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.4b"><apply id="S3.p3.4.m4.4.4.cmml" xref="S3.p3.4.m4.4.4"><ci id="S3.p3.4.m4.4.4.2.cmml" xref="S3.p3.4.m4.4.4.2">←</ci><list id="S3.p3.4.m4.4.4.3.1.cmml" xref="S3.p3.4.m4.4.4.3.2"><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">𝑼</ci><ci id="S3.p3.4.m4.2.2.cmml" xref="S3.p3.4.m4.2.2">𝑺</ci><ci id="S3.p3.4.m4.3.3.cmml" xref="S3.p3.4.m4.3.3">𝑽</ci></list><apply id="S3.p3.4.m4.4.4.1.cmml" xref="S3.p3.4.m4.4.4.1"><times id="S3.p3.4.m4.4.4.1.2.cmml" xref="S3.p3.4.m4.4.4.1.2"></times><ci id="S3.p3.4.m4.4.4.1.3a.cmml" xref="S3.p3.4.m4.4.4.1.3"><mtext id="S3.p3.4.m4.4.4.1.3.cmml" xref="S3.p3.4.m4.4.4.1.3">SVD</mtext></ci><apply id="S3.p3.4.m4.4.4.1.1.1.1.cmml" xref="S3.p3.4.m4.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.4.4.1.1.1.1.1.cmml" xref="S3.p3.4.m4.4.4.1.1.1">subscript</csymbol><ci id="S3.p3.4.m4.4.4.1.1.1.1.2.cmml" xref="S3.p3.4.m4.4.4.1.1.1.1.2">𝒁</ci><ci id="S3.p3.4.m4.4.4.1.1.1.1.3.cmml" xref="S3.p3.4.m4.4.4.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.4c">\bm{U},\bm{S},\bm{V}\leftarrow\text{SVD}(\bm{Z}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.4d">bold_italic_U , bold_italic_S , bold_italic_V ← SVD ( bold_italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>). Then, we compute an adaptive rank <math alttext="r\leftarrow\underset{k}{\operatorname*{arg\,min}}\{\frac{\sum_{j=1}^{k}s_{j}^{%
2}}{\sum_{j}s_{j}^{2}}\geq\tau\}" class="ltx_Math" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><mrow id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml"><mi id="S3.p3.5.m5.1.1.3" xref="S3.p3.5.m5.1.1.3.cmml">r</mi><mo id="S3.p3.5.m5.1.1.2" stretchy="false" xref="S3.p3.5.m5.1.1.2.cmml">←</mo><mrow id="S3.p3.5.m5.1.1.1" xref="S3.p3.5.m5.1.1.1.cmml"><munder accentunder="true" id="S3.p3.5.m5.1.1.1.3" xref="S3.p3.5.m5.1.1.1.3.cmml"><mrow id="S3.p3.5.m5.1.1.1.3.2" xref="S3.p3.5.m5.1.1.1.3.2.cmml"><mi id="S3.p3.5.m5.1.1.1.3.2.2" xref="S3.p3.5.m5.1.1.1.3.2.2.cmml">arg</mi><mo id="S3.p3.5.m5.1.1.1.3.2.1" lspace="0.170em" xref="S3.p3.5.m5.1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.p3.5.m5.1.1.1.3.2.3" xref="S3.p3.5.m5.1.1.1.3.2.3.cmml">min</mi></mrow><mo id="S3.p3.5.m5.1.1.1.3.1" xref="S3.p3.5.m5.1.1.1.3.1.cmml">𝑘</mo></munder><mo id="S3.p3.5.m5.1.1.1.2" xref="S3.p3.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="S3.p3.5.m5.1.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.2.cmml"><mo id="S3.p3.5.m5.1.1.1.1.1.2" stretchy="false" xref="S3.p3.5.m5.1.1.1.1.2.cmml">{</mo><mrow id="S3.p3.5.m5.1.1.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.1.1.cmml"><mfrac id="S3.p3.5.m5.1.1.1.1.1.1.2" xref="S3.p3.5.m5.1.1.1.1.1.1.2.cmml"><mrow id="S3.p3.5.m5.1.1.1.1.1.1.2.2" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.cmml"><mstyle displaystyle="false" id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.cmml"><msubsup id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1a" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.cmml"><mo id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.2" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.2.cmml">∑</mo><mrow id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.cmml"><mi id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.2" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.2.cmml">j</mi><mo id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.1" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.1.cmml">=</mo><mn id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.3" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.3" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.3.cmml">k</mi></msubsup></mstyle><msubsup id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.2.2" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.2.2.cmml">s</mi><mi id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.2.3" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.2.3.cmml">j</mi><mn id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.3" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msubsup></mrow><mrow id="S3.p3.5.m5.1.1.1.1.1.1.2.3" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.cmml"><mstyle displaystyle="false" id="S3.p3.5.m5.1.1.1.1.1.1.2.3.1" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.cmml"><msub id="S3.p3.5.m5.1.1.1.1.1.1.2.3.1a" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.2" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.2.cmml">∑</mo><mi id="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.3" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.3.cmml">j</mi></msub></mstyle><msubsup id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.2.2" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.2.2.cmml">s</mi><mi id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.2.3" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.2.3.cmml">j</mi><mn id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.3" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.3.cmml">2</mn></msubsup></mrow></mfrac><mo id="S3.p3.5.m5.1.1.1.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.1.1.1.cmml">≥</mo><mi id="S3.p3.5.m5.1.1.1.1.1.1.3" xref="S3.p3.5.m5.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.p3.5.m5.1.1.1.1.1.3" stretchy="false" xref="S3.p3.5.m5.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1"><ci id="S3.p3.5.m5.1.1.2.cmml" xref="S3.p3.5.m5.1.1.2">←</ci><ci id="S3.p3.5.m5.1.1.3.cmml" xref="S3.p3.5.m5.1.1.3">𝑟</ci><apply id="S3.p3.5.m5.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1"><times id="S3.p3.5.m5.1.1.1.2.cmml" xref="S3.p3.5.m5.1.1.1.2"></times><apply id="S3.p3.5.m5.1.1.1.3.cmml" xref="S3.p3.5.m5.1.1.1.3"><ci id="S3.p3.5.m5.1.1.1.3.1.cmml" xref="S3.p3.5.m5.1.1.1.3.1">𝑘</ci><apply id="S3.p3.5.m5.1.1.1.3.2.cmml" xref="S3.p3.5.m5.1.1.1.3.2"><times id="S3.p3.5.m5.1.1.1.3.2.1.cmml" xref="S3.p3.5.m5.1.1.1.3.2.1"></times><ci id="S3.p3.5.m5.1.1.1.3.2.2.cmml" xref="S3.p3.5.m5.1.1.1.3.2.2">arg</ci><ci id="S3.p3.5.m5.1.1.1.3.2.3.cmml" xref="S3.p3.5.m5.1.1.1.3.2.3">min</ci></apply></apply><set id="S3.p3.5.m5.1.1.1.1.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1"><apply id="S3.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1"><geq id="S3.p3.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.1"></geq><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2"><divide id="S3.p3.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2"></divide><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2"><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1">superscript</csymbol><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1">subscript</csymbol><sum id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.2"></sum><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3"><eq id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.1"></eq><ci id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.2">𝑗</ci><cn id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.3.cmml" type="integer" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.2.3.3">1</cn></apply></apply><ci id="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.1.3">𝑘</ci></apply><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.2.2">𝑠</ci><ci id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.2.3">𝑗</ci></apply><cn id="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.p3.5.m5.1.1.1.1.1.1.2.2.2.3">2</cn></apply></apply><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3"><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.1">subscript</csymbol><sum id="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.2"></sum><ci id="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.1.3">𝑗</ci></apply><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2">superscript</csymbol><apply id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.2.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.2.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.2.2">𝑠</ci><ci id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.2.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.2.3">𝑗</ci></apply><cn id="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.p3.5.m5.1.1.1.1.1.1.2.3.2.3">2</cn></apply></apply></apply><ci id="S3.p3.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1.3">𝜏</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">r\leftarrow\underset{k}{\operatorname*{arg\,min}}\{\frac{\sum_{j=1}^{k}s_{j}^{%
2}}{\sum_{j}s_{j}^{2}}\geq\tau\}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">italic_r ← underitalic_k start_ARG roman_arg roman_min end_ARG { divide start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ≥ italic_τ }</annotation></semantics></math> leveraging a fixed variance retention threshold <math alttext="\tau" class="ltx_Math" display="inline" id="S3.p3.6.m6.1"><semantics id="S3.p3.6.m6.1a"><mi id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><ci id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m6.1d">italic_τ</annotation></semantics></math>. The gradient <math alttext="\bm{g}_{t}" class="ltx_Math" display="inline" id="S3.p3.7.m7.1"><semantics id="S3.p3.7.m7.1a"><msub id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml"><mi id="S3.p3.7.m7.1.1.2" xref="S3.p3.7.m7.1.1.2.cmml">𝒈</mi><mi id="S3.p3.7.m7.1.1.3" xref="S3.p3.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><apply id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p3.7.m7.1.1.1.cmml" xref="S3.p3.7.m7.1.1">subscript</csymbol><ci id="S3.p3.7.m7.1.1.2.cmml" xref="S3.p3.7.m7.1.1.2">𝒈</ci><ci id="S3.p3.7.m7.1.1.3.cmml" xref="S3.p3.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">\bm{g}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.7.m7.1d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which takes a matrix form for images, is projected onto a subspace defined by the highest <math alttext="r" class="ltx_Math" display="inline" id="S3.p3.8.m8.1"><semantics id="S3.p3.8.m8.1a"><mi id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><ci id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.p3.8.m8.1d">italic_r</annotation></semantics></math> singular values of <math alttext="{\bm{Z}}_{t}" class="ltx_Math" display="inline" id="S3.p3.9.m9.1"><semantics id="S3.p3.9.m9.1a"><msub id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml"><mi id="S3.p3.9.m9.1.1.2" xref="S3.p3.9.m9.1.1.2.cmml">𝒁</mi><mi id="S3.p3.9.m9.1.1.3" xref="S3.p3.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><apply id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p3.9.m9.1.1.1.cmml" xref="S3.p3.9.m9.1.1">subscript</csymbol><ci id="S3.p3.9.m9.1.1.2.cmml" xref="S3.p3.9.m9.1.1.2">𝒁</ci><ci id="S3.p3.9.m9.1.1.3.cmml" xref="S3.p3.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">{\bm{Z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.9.m9.1d">bold_italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{G}_{t}\leftarrow\bm{U}_{r}\bm{U}_{r}^{\text{T}}\bm{G}_{t}\bm{V}_{r}^{\text%
{T}}\bm{V}_{r}," class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.2.2.cmml">𝑮</mi><mi id="S3.E6.m1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E6.m1.1.1.1.1.1" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.cmml">←</mo><mrow id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><msub id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.3.2.2.cmml">𝑼</mi><mi id="S3.E6.m1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.3.2.3.cmml">r</mi></msub><mo id="S3.E6.m1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.1.1.1.1.3.3.2.2.cmml">𝑼</mi><mi id="S3.E6.m1.1.1.1.1.3.3.2.3" xref="S3.E6.m1.1.1.1.1.3.3.2.3.cmml">r</mi><mtext id="S3.E6.m1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.3.3.3a.cmml">T</mtext></msubsup><mo id="S3.E6.m1.1.1.1.1.3.1a" xref="S3.E6.m1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.1.1.3.4" xref="S3.E6.m1.1.1.1.1.3.4.cmml"><mi id="S3.E6.m1.1.1.1.1.3.4.2" xref="S3.E6.m1.1.1.1.1.3.4.2.cmml">𝑮</mi><mi id="S3.E6.m1.1.1.1.1.3.4.3" xref="S3.E6.m1.1.1.1.1.3.4.3.cmml">t</mi></msub><mo id="S3.E6.m1.1.1.1.1.3.1b" xref="S3.E6.m1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S3.E6.m1.1.1.1.1.3.5" xref="S3.E6.m1.1.1.1.1.3.5.cmml"><mi id="S3.E6.m1.1.1.1.1.3.5.2.2" xref="S3.E6.m1.1.1.1.1.3.5.2.2.cmml">𝑽</mi><mi id="S3.E6.m1.1.1.1.1.3.5.2.3" xref="S3.E6.m1.1.1.1.1.3.5.2.3.cmml">r</mi><mtext id="S3.E6.m1.1.1.1.1.3.5.3" xref="S3.E6.m1.1.1.1.1.3.5.3a.cmml">T</mtext></msubsup><mo id="S3.E6.m1.1.1.1.1.3.1c" xref="S3.E6.m1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.1.1.3.6" xref="S3.E6.m1.1.1.1.1.3.6.cmml"><mi id="S3.E6.m1.1.1.1.1.3.6.2" xref="S3.E6.m1.1.1.1.1.3.6.2.cmml">𝑽</mi><mi id="S3.E6.m1.1.1.1.1.3.6.3" xref="S3.E6.m1.1.1.1.1.3.6.3.cmml">r</mi></msub></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><ci id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1">←</ci><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2">𝑮</ci><ci id="S3.E6.m1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><times id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.1"></times><apply id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2.2">𝑼</ci><ci id="S3.E6.m1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.3.2.3">𝑟</ci></apply><apply id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3.2.2">𝑼</ci><ci id="S3.E6.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3.2.3">𝑟</ci></apply><ci id="S3.E6.m1.1.1.1.1.3.3.3a.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3"><mtext id="S3.E6.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.3.3.3">T</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.3.4.cmml" xref="S3.E6.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.4.1.cmml" xref="S3.E6.m1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.4.2.cmml" xref="S3.E6.m1.1.1.1.1.3.4.2">𝑮</ci><ci id="S3.E6.m1.1.1.1.1.3.4.3.cmml" xref="S3.E6.m1.1.1.1.1.3.4.3">𝑡</ci></apply><apply id="S3.E6.m1.1.1.1.1.3.5.cmml" xref="S3.E6.m1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.5.1.cmml" xref="S3.E6.m1.1.1.1.1.3.5">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.3.5.2.cmml" xref="S3.E6.m1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.5.2.1.cmml" xref="S3.E6.m1.1.1.1.1.3.5">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.5.2.2.cmml" xref="S3.E6.m1.1.1.1.1.3.5.2.2">𝑽</ci><ci id="S3.E6.m1.1.1.1.1.3.5.2.3.cmml" xref="S3.E6.m1.1.1.1.1.3.5.2.3">𝑟</ci></apply><ci id="S3.E6.m1.1.1.1.1.3.5.3a.cmml" xref="S3.E6.m1.1.1.1.1.3.5.3"><mtext id="S3.E6.m1.1.1.1.1.3.5.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.3.5.3">T</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.3.6.cmml" xref="S3.E6.m1.1.1.1.1.3.6"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.6.1.cmml" xref="S3.E6.m1.1.1.1.1.3.6">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.6.2.cmml" xref="S3.E6.m1.1.1.1.1.3.6.2">𝑽</ci><ci id="S3.E6.m1.1.1.1.1.3.6.3.cmml" xref="S3.E6.m1.1.1.1.1.3.6.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\bm{G}_{t}\leftarrow\bm{U}_{r}\bm{U}_{r}^{\text{T}}\bm{G}_{t}\bm{V}_{r}^{\text%
{T}}\bm{V}_{r},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">bold_italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT T end_POSTSUPERSCRIPT bold_italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_italic_V start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT T end_POSTSUPERSCRIPT bold_italic_V start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.15">where <math alttext="\bm{G}_{t}" class="ltx_Math" display="inline" id="S3.p3.10.m1.1"><semantics id="S3.p3.10.m1.1a"><msub id="S3.p3.10.m1.1.1" xref="S3.p3.10.m1.1.1.cmml"><mi id="S3.p3.10.m1.1.1.2" xref="S3.p3.10.m1.1.1.2.cmml">𝑮</mi><mi id="S3.p3.10.m1.1.1.3" xref="S3.p3.10.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.10.m1.1b"><apply id="S3.p3.10.m1.1.1.cmml" xref="S3.p3.10.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.10.m1.1.1.1.cmml" xref="S3.p3.10.m1.1.1">subscript</csymbol><ci id="S3.p3.10.m1.1.1.2.cmml" xref="S3.p3.10.m1.1.1.2">𝑮</ci><ci id="S3.p3.10.m1.1.1.3.cmml" xref="S3.p3.10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m1.1c">\bm{G}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.10.m1.1d">bold_italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the measurement gradient in image matrix form, and <math alttext="\bm{U}_{r}" class="ltx_Math" display="inline" id="S3.p3.11.m2.1"><semantics id="S3.p3.11.m2.1a"><msub id="S3.p3.11.m2.1.1" xref="S3.p3.11.m2.1.1.cmml"><mi id="S3.p3.11.m2.1.1.2" xref="S3.p3.11.m2.1.1.2.cmml">𝑼</mi><mi id="S3.p3.11.m2.1.1.3" xref="S3.p3.11.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.11.m2.1b"><apply id="S3.p3.11.m2.1.1.cmml" xref="S3.p3.11.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.11.m2.1.1.1.cmml" xref="S3.p3.11.m2.1.1">subscript</csymbol><ci id="S3.p3.11.m2.1.1.2.cmml" xref="S3.p3.11.m2.1.1.2">𝑼</ci><ci id="S3.p3.11.m2.1.1.3.cmml" xref="S3.p3.11.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m2.1c">\bm{U}_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.11.m2.1d">bold_italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\bm{V}_{r}" class="ltx_Math" display="inline" id="S3.p3.12.m3.1"><semantics id="S3.p3.12.m3.1a"><msub id="S3.p3.12.m3.1.1" xref="S3.p3.12.m3.1.1.cmml"><mi id="S3.p3.12.m3.1.1.2" xref="S3.p3.12.m3.1.1.2.cmml">𝑽</mi><mi id="S3.p3.12.m3.1.1.3" xref="S3.p3.12.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.12.m3.1b"><apply id="S3.p3.12.m3.1.1.cmml" xref="S3.p3.12.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.12.m3.1.1.1.cmml" xref="S3.p3.12.m3.1.1">subscript</csymbol><ci id="S3.p3.12.m3.1.1.2.cmml" xref="S3.p3.12.m3.1.1.2">𝑽</ci><ci id="S3.p3.12.m3.1.1.3.cmml" xref="S3.p3.12.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.12.m3.1c">\bm{V}_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.12.m3.1d">bold_italic_V start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> contain the first <math alttext="r" class="ltx_Math" display="inline" id="S3.p3.13.m4.1"><semantics id="S3.p3.13.m4.1a"><mi id="S3.p3.13.m4.1.1" xref="S3.p3.13.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.p3.13.m4.1b"><ci id="S3.p3.13.m4.1.1.cmml" xref="S3.p3.13.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.13.m4.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.p3.13.m4.1d">italic_r</annotation></semantics></math> left and right singular vectors, respectively (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#alg1" title="In 3 Diffusion State-Guided Projected Gradient (DiffStateGrad) ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>). While we use the <span class="ltx_text ltx_font_italic" id="S3.p3.15.1">full</span> SVD projection (i.e., combining both left and right projection), in practice, one may choose to do either left or right projection. Next, we provide mathematical intuitions (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S3.Thmproposition1" title="Proposition 1. ‣ 3 Diffusion State-Guided Projected Gradient (DiffStateGrad) ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a>) on the effectiveness of DiffStateGrad in preserving <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p3.14.m5.1"><semantics id="S3.p3.14.m5.1a"><msub id="S3.p3.14.m5.1.1" xref="S3.p3.14.m5.1.1.cmml"><mi id="S3.p3.14.m5.1.1.2" xref="S3.p3.14.m5.1.1.2.cmml">𝒛</mi><mi id="S3.p3.14.m5.1.1.3" xref="S3.p3.14.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.14.m5.1b"><apply id="S3.p3.14.m5.1.1.cmml" xref="S3.p3.14.m5.1.1"><csymbol cd="ambiguous" id="S3.p3.14.m5.1.1.1.cmml" xref="S3.p3.14.m5.1.1">subscript</csymbol><ci id="S3.p3.14.m5.1.1.2.cmml" xref="S3.p3.14.m5.1.1.2">𝒛</ci><ci id="S3.p3.14.m5.1.1.3.cmml" xref="S3.p3.14.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.14.m5.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.14.m5.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, particularly for high-dimensional data with low-rank structure, after the MG update on the manifold <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="S3.p3.15.m6.1"><semantics id="S3.p3.15.m6.1a"><msub id="S3.p3.15.m6.1.1" xref="S3.p3.15.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.15.m6.1.1.2" xref="S3.p3.15.m6.1.1.2.cmml">ℳ</mi><mi id="S3.p3.15.m6.1.1.3" xref="S3.p3.15.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.15.m6.1b"><apply id="S3.p3.15.m6.1.1.cmml" xref="S3.p3.15.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.15.m6.1.1.1.cmml" xref="S3.p3.15.m6.1.1">subscript</csymbol><ci id="S3.p3.15.m6.1.1.2.cmml" xref="S3.p3.15.m6.1.1.2">ℳ</ci><ci id="S3.p3.15.m6.1.1.3.cmml" xref="S3.p3.15.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.15.m6.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.15.m6.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Finally, we note that while DiffStateGrad can significantly improve the runtime and computational efficiency of diffusion frameworks that use Adam optimizers for data consistency <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib28" title="">2023a</a>; Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib40" title="">2024</a>)</cite>, the current implementation and this paper does not explore this aspect and, instead, focuses on the property of the proposed subspace.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Diffusion State-Guided Projected Gradient (DiffStateGrad) for Latent Diffusion-based Inverse Problems (Image Restoration Tasks)</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>Normal input + variance retention threshold <math alttext="\tau" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_τ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>Let <math alttext="T" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_T</annotation></semantics></math> = number of total iterations of sampling algorithm and assume we calculate latent image representation <math alttext="{\bm{Z}}_{t}" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">𝒁</mi><mi id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝒁</ci><ci id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">{\bm{Z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">bold_italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> for each iteration. Note that <math alttext="{\bm{Z}}_{t}" class="ltx_Math" display="inline" id="alg1.l2.m3.1"><semantics id="alg1.l2.m3.1a"><msub id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mi id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml">𝒁</mi><mi id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1">subscript</csymbol><ci id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2">𝒁</ci><ci id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">{\bm{Z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.1d">bold_italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is a matrix.

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><span class="ltx_text ltx_font_bold" id="alg1.l3.1">for</span> <math alttext="t=T-1" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">t</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mrow id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">T</mi><mo id="alg1.l3.m1.1.1.3.1" xref="alg1.l3.m1.1.1.3.1.cmml">−</mo><mn id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑡</ci><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><minus id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.1"></minus><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">𝑇</ci><cn id="alg1.l3.m1.1.1.3.3.cmml" type="integer" xref="alg1.l3.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">t=T-1</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_t = italic_T - 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l3.2">to</span> <math alttext="0" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mn id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><cn id="alg1.l3.m2.1.1.cmml" type="integer" xref="alg1.l3.m2.1.1">0</cn></annotation-xml></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l3.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>     Compute measurement gradient <math alttext="\bm{G}_{t}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><msub id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">𝑮</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑮</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\bm{G}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">bold_italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> according to sampling algorithm

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math alttext="\bm{U},\bm{S},\bm{V}\leftarrow\text{SVD}({\bm{Z}}_{t})" class="ltx_Math" display="inline" id="alg1.l5.m1.4"><semantics id="alg1.l5.m1.4a"><mrow id="alg1.l5.m1.4.4" xref="alg1.l5.m1.4.4.cmml"><mrow id="alg1.l5.m1.4.4.3.2" xref="alg1.l5.m1.4.4.3.1.cmml"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">𝑼</mi><mo id="alg1.l5.m1.4.4.3.2.1" xref="alg1.l5.m1.4.4.3.1.cmml">,</mo><mi id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml">𝑺</mi><mo id="alg1.l5.m1.4.4.3.2.2" xref="alg1.l5.m1.4.4.3.1.cmml">,</mo><mi id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml">𝑽</mi></mrow><mo id="alg1.l5.m1.4.4.2" stretchy="false" xref="alg1.l5.m1.4.4.2.cmml">←</mo><mrow id="alg1.l5.m1.4.4.1" xref="alg1.l5.m1.4.4.1.cmml"><mtext id="alg1.l5.m1.4.4.1.3" xref="alg1.l5.m1.4.4.1.3a.cmml">SVD</mtext><mo id="alg1.l5.m1.4.4.1.2" xref="alg1.l5.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.4.4.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.1.cmml"><mo id="alg1.l5.m1.4.4.1.1.1.2" stretchy="false" xref="alg1.l5.m1.4.4.1.1.1.1.cmml">(</mo><msub id="alg1.l5.m1.4.4.1.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.1.cmml"><mi id="alg1.l5.m1.4.4.1.1.1.1.2" xref="alg1.l5.m1.4.4.1.1.1.1.2.cmml">𝒁</mi><mi id="alg1.l5.m1.4.4.1.1.1.1.3" xref="alg1.l5.m1.4.4.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l5.m1.4.4.1.1.1.3" stretchy="false" xref="alg1.l5.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.4b"><apply id="alg1.l5.m1.4.4.cmml" xref="alg1.l5.m1.4.4"><ci id="alg1.l5.m1.4.4.2.cmml" xref="alg1.l5.m1.4.4.2">←</ci><list id="alg1.l5.m1.4.4.3.1.cmml" xref="alg1.l5.m1.4.4.3.2"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑼</ci><ci id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">𝑺</ci><ci id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3">𝑽</ci></list><apply id="alg1.l5.m1.4.4.1.cmml" xref="alg1.l5.m1.4.4.1"><times id="alg1.l5.m1.4.4.1.2.cmml" xref="alg1.l5.m1.4.4.1.2"></times><ci id="alg1.l5.m1.4.4.1.3a.cmml" xref="alg1.l5.m1.4.4.1.3"><mtext id="alg1.l5.m1.4.4.1.3.cmml" xref="alg1.l5.m1.4.4.1.3">SVD</mtext></ci><apply id="alg1.l5.m1.4.4.1.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.2">𝒁</ci><ci id="alg1.l5.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.4c">\bm{U},\bm{S},\bm{V}\leftarrow\text{SVD}({\bm{Z}}_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.4d">bold_italic_U , bold_italic_S , bold_italic_V ← SVD ( bold_italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l5.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> Perform SVD on current diffusion state
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math alttext="\lambda_{j}\leftarrow s_{j}^{2}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">λ</mi><mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">j</mi></msub><mo id="alg1.l6.m1.1.1.1" stretchy="false" xref="alg1.l6.m1.1.1.1.cmml">←</mo><msubsup id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2.2" xref="alg1.l6.m1.1.1.3.2.2.cmml">s</mi><mi id="alg1.l6.m1.1.1.3.2.3" xref="alg1.l6.m1.1.1.3.2.3.cmml">j</mi><mn id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">𝜆</ci><ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">𝑗</ci></apply><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">superscript</csymbol><apply id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.3.2.2">𝑠</ci><ci id="alg1.l6.m1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.3.2.3">𝑗</ci></apply><cn id="alg1.l6.m1.1.1.3.3.cmml" type="integer" xref="alg1.l6.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\lambda_{j}\leftarrow s_{j}^{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ← italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> (where <math alttext="s_{j}" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><msub id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">s</mi><mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">subscript</csymbol><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝑠</ci><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are the singular values of <math alttext="\bm{S}" class="ltx_Math" display="inline" id="alg1.l6.m3.1"><semantics id="alg1.l6.m3.1a"><mi id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><ci id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">\bm{S}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m3.1d">bold_italic_S</annotation></semantics></math>) <span class="ltx_text" id="alg1.l6.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> Calculate eigenvalues
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math alttext="c_{k}\leftarrow\frac{\sum_{j=1}^{k}\lambda_{j}}{\sum_{j}\lambda_{j}}" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">c</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg1.l7.m1.1.1.1" stretchy="false" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mfrac id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mrow id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml"><mstyle displaystyle="false" id="alg1.l7.m1.1.1.3.2.1" xref="alg1.l7.m1.1.1.3.2.1.cmml"><msubsup id="alg1.l7.m1.1.1.3.2.1a" xref="alg1.l7.m1.1.1.3.2.1.cmml"><mo id="alg1.l7.m1.1.1.3.2.1.2.2" xref="alg1.l7.m1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="alg1.l7.m1.1.1.3.2.1.2.3" xref="alg1.l7.m1.1.1.3.2.1.2.3.cmml"><mi id="alg1.l7.m1.1.1.3.2.1.2.3.2" xref="alg1.l7.m1.1.1.3.2.1.2.3.2.cmml">j</mi><mo id="alg1.l7.m1.1.1.3.2.1.2.3.1" xref="alg1.l7.m1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="alg1.l7.m1.1.1.3.2.1.2.3.3" xref="alg1.l7.m1.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l7.m1.1.1.3.2.1.3" xref="alg1.l7.m1.1.1.3.2.1.3.cmml">k</mi></msubsup></mstyle><msub id="alg1.l7.m1.1.1.3.2.2" xref="alg1.l7.m1.1.1.3.2.2.cmml"><mi id="alg1.l7.m1.1.1.3.2.2.2" xref="alg1.l7.m1.1.1.3.2.2.2.cmml">λ</mi><mi id="alg1.l7.m1.1.1.3.2.2.3" xref="alg1.l7.m1.1.1.3.2.2.3.cmml">j</mi></msub></mrow><mrow id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="alg1.l7.m1.1.1.3.3.1" xref="alg1.l7.m1.1.1.3.3.1.cmml"><msub id="alg1.l7.m1.1.1.3.3.1a" xref="alg1.l7.m1.1.1.3.3.1.cmml"><mo id="alg1.l7.m1.1.1.3.3.1.2" xref="alg1.l7.m1.1.1.3.3.1.2.cmml">∑</mo><mi id="alg1.l7.m1.1.1.3.3.1.3" xref="alg1.l7.m1.1.1.3.3.1.3.cmml">j</mi></msub></mstyle><msub id="alg1.l7.m1.1.1.3.3.2" xref="alg1.l7.m1.1.1.3.3.2.cmml"><mi id="alg1.l7.m1.1.1.3.3.2.2" xref="alg1.l7.m1.1.1.3.3.2.2.cmml">λ</mi><mi id="alg1.l7.m1.1.1.3.3.2.3" xref="alg1.l7.m1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑐</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><divide id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3"></divide><apply id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2"><apply id="alg1.l7.m1.1.1.3.2.1.cmml" xref="alg1.l7.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.2.1.1.cmml" xref="alg1.l7.m1.1.1.3.2.1">superscript</csymbol><apply id="alg1.l7.m1.1.1.3.2.1.2.cmml" xref="alg1.l7.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.2.1.2.1.cmml" xref="alg1.l7.m1.1.1.3.2.1">subscript</csymbol><sum id="alg1.l7.m1.1.1.3.2.1.2.2.cmml" xref="alg1.l7.m1.1.1.3.2.1.2.2"></sum><apply id="alg1.l7.m1.1.1.3.2.1.2.3.cmml" xref="alg1.l7.m1.1.1.3.2.1.2.3"><eq id="alg1.l7.m1.1.1.3.2.1.2.3.1.cmml" xref="alg1.l7.m1.1.1.3.2.1.2.3.1"></eq><ci id="alg1.l7.m1.1.1.3.2.1.2.3.2.cmml" xref="alg1.l7.m1.1.1.3.2.1.2.3.2">𝑗</ci><cn id="alg1.l7.m1.1.1.3.2.1.2.3.3.cmml" type="integer" xref="alg1.l7.m1.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="alg1.l7.m1.1.1.3.2.1.3.cmml" xref="alg1.l7.m1.1.1.3.2.1.3">𝑘</ci></apply><apply id="alg1.l7.m1.1.1.3.2.2.cmml" xref="alg1.l7.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.2.2.1.cmml" xref="alg1.l7.m1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.2.2.cmml" xref="alg1.l7.m1.1.1.3.2.2.2">𝜆</ci><ci id="alg1.l7.m1.1.1.3.2.2.3.cmml" xref="alg1.l7.m1.1.1.3.2.2.3">𝑗</ci></apply></apply><apply id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3"><apply id="alg1.l7.m1.1.1.3.3.1.cmml" xref="alg1.l7.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.3.1.1.cmml" xref="alg1.l7.m1.1.1.3.3.1">subscript</csymbol><sum id="alg1.l7.m1.1.1.3.3.1.2.cmml" xref="alg1.l7.m1.1.1.3.3.1.2"></sum><ci id="alg1.l7.m1.1.1.3.3.1.3.cmml" xref="alg1.l7.m1.1.1.3.3.1.3">𝑗</ci></apply><apply id="alg1.l7.m1.1.1.3.3.2.cmml" xref="alg1.l7.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.3.2.1.cmml" xref="alg1.l7.m1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.3.2.2.cmml" xref="alg1.l7.m1.1.1.3.3.2.2">𝜆</ci><ci id="alg1.l7.m1.1.1.3.3.2.3.cmml" xref="alg1.l7.m1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">c_{k}\leftarrow\frac{\sum_{j=1}^{k}\lambda_{j}}{\sum_{j}\lambda_{j}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← divide start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> <span class="ltx_text" id="alg1.l7.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">▷</annotation></semantics></math> Cumulative sum of eigenvalues
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math alttext="r\leftarrow\underset{k}{\operatorname*{arg\,min}}\{c_{k}\geq\tau\}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">r</mi><mo id="alg1.l8.m1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.2.cmml">←</mo><mrow id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml"><munder accentunder="true" id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.1.1.3.cmml"><mrow id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.3.2.cmml"><mi id="alg1.l8.m1.1.1.1.3.2.2" xref="alg1.l8.m1.1.1.1.3.2.2.cmml">arg</mi><mo id="alg1.l8.m1.1.1.1.3.2.1" lspace="0.170em" xref="alg1.l8.m1.1.1.1.3.2.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.1.3.2.3" xref="alg1.l8.m1.1.1.1.3.2.3.cmml">min</mi></mrow><mo id="alg1.l8.m1.1.1.1.3.1" xref="alg1.l8.m1.1.1.1.3.1.cmml">𝑘</mo></munder><mo id="alg1.l8.m1.1.1.1.2" xref="alg1.l8.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.2.cmml"><mo id="alg1.l8.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l8.m1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="alg1.l8.m1.1.1.1.1.1.1.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="alg1.l8.m1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.cmml">≥</mo><mi id="alg1.l8.m1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="alg1.l8.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l8.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">←</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑟</ci><apply id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"><times id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.2"></times><apply id="alg1.l8.m1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.3"><ci id="alg1.l8.m1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.3.1">𝑘</ci><apply id="alg1.l8.m1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.3.2"><times id="alg1.l8.m1.1.1.1.3.2.1.cmml" xref="alg1.l8.m1.1.1.1.3.2.1"></times><ci id="alg1.l8.m1.1.1.1.3.2.2.cmml" xref="alg1.l8.m1.1.1.1.3.2.2">arg</ci><ci id="alg1.l8.m1.1.1.1.3.2.3.cmml" xref="alg1.l8.m1.1.1.1.3.2.3">min</ci></apply></apply><set id="alg1.l8.m1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1"><apply id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1"><geq id="alg1.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1"></geq><apply id="alg1.l8.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3">𝜏</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">r\leftarrow\underset{k}{\operatorname*{arg\,min}}\{c_{k}\geq\tau\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_r ← underitalic_k start_ARG roman_arg roman_min end_ARG { italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ≥ italic_τ }</annotation></semantics></math> <span class="ltx_text" id="alg1.l8.3" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l8.1.m1.1"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.1.m1.1d">▷</annotation></semantics></math> Determine rank <math alttext="r" class="ltx_Math" display="inline" id="alg1.l8.2.m2.1"><semantics id="alg1.l8.2.m2.1a"><mi id="alg1.l8.2.m2.1.1" xref="alg1.l8.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.2.m2.1b"><ci id="alg1.l8.2.m2.1.1.cmml" xref="alg1.l8.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.2.m2.1d">italic_r</annotation></semantics></math> based on threshold <math alttext="\tau" class="ltx_Math" display="inline" id="alg1.l8.3.m3.1"><semantics id="alg1.l8.3.m3.1a"><mi id="alg1.l8.3.m3.1.1" xref="alg1.l8.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.3.m3.1b"><ci id="alg1.l8.3.m3.1.1.cmml" xref="alg1.l8.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.3.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.3.m3.1d">italic_τ</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math alttext="\bm{A}_{t}\leftarrow\bm{U}_{r}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">𝑨</mi><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg1.l9.m1.1.1.1" stretchy="false" xref="alg1.l9.m1.1.1.1.cmml">←</mo><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">𝑼</mi><mi id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑨</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝑼</ci><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\bm{A}_{t}\leftarrow\bm{U}_{r}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">bold_italic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l9.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l9.1.m1.1"><semantics id="alg1.l9.1.m1.1a"><mo id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b"><ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.1.m1.1d">▷</annotation></semantics></math> Get first <math alttext="r" class="ltx_Math" display="inline" id="alg1.l9.2.m2.1"><semantics id="alg1.l9.2.m2.1a"><mi id="alg1.l9.2.m2.1.1" xref="alg1.l9.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.2.m2.1b"><ci id="alg1.l9.2.m2.1.1.cmml" xref="alg1.l9.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.2.m2.1d">italic_r</annotation></semantics></math> left singular vectors
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <math alttext="\bm{B}_{t}\leftarrow\bm{V}_{r}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msub id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">𝑩</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg1.l10.m1.1.1.1" stretchy="false" xref="alg1.l10.m1.1.1.1.cmml">←</mo><msub id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">𝑽</mi><mi id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝑩</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑽</ci><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\bm{B}_{t}\leftarrow\bm{V}_{r}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">bold_italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_italic_V start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l10.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l10.1.m1.1"><semantics id="alg1.l10.1.m1.1a"><mo id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.1b"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.1.m1.1d">▷</annotation></semantics></math> Get first <math alttext="r" class="ltx_Math" display="inline" id="alg1.l10.2.m2.1"><semantics id="alg1.l10.2.m2.1a"><mi id="alg1.l10.2.m2.1.1" xref="alg1.l10.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.2.m2.1b"><ci id="alg1.l10.2.m2.1.1.cmml" xref="alg1.l10.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.2.m2.1d">italic_r</annotation></semantics></math> right singular vectors
</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <math alttext="\bm{R}_{t}\leftarrow\bm{A}_{t}^{T}\bm{G}_{t}\bm{B}_{t}^{T}" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><msub id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml"><mi id="alg1.l11.m1.1.1.2.2" xref="alg1.l11.m1.1.1.2.2.cmml">𝑹</mi><mi id="alg1.l11.m1.1.1.2.3" xref="alg1.l11.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg1.l11.m1.1.1.1" stretchy="false" xref="alg1.l11.m1.1.1.1.cmml">←</mo><mrow id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><msubsup id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml"><mi id="alg1.l11.m1.1.1.3.2.2.2" xref="alg1.l11.m1.1.1.3.2.2.2.cmml">𝑨</mi><mi id="alg1.l11.m1.1.1.3.2.2.3" xref="alg1.l11.m1.1.1.3.2.2.3.cmml">t</mi><mi id="alg1.l11.m1.1.1.3.2.3" xref="alg1.l11.m1.1.1.3.2.3.cmml">T</mi></msubsup><mo id="alg1.l11.m1.1.1.3.1" xref="alg1.l11.m1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml"><mi id="alg1.l11.m1.1.1.3.3.2" xref="alg1.l11.m1.1.1.3.3.2.cmml">𝑮</mi><mi id="alg1.l11.m1.1.1.3.3.3" xref="alg1.l11.m1.1.1.3.3.3.cmml">t</mi></msub><mo id="alg1.l11.m1.1.1.3.1a" xref="alg1.l11.m1.1.1.3.1.cmml">⁢</mo><msubsup id="alg1.l11.m1.1.1.3.4" xref="alg1.l11.m1.1.1.3.4.cmml"><mi id="alg1.l11.m1.1.1.3.4.2.2" xref="alg1.l11.m1.1.1.3.4.2.2.cmml">𝑩</mi><mi id="alg1.l11.m1.1.1.3.4.2.3" xref="alg1.l11.m1.1.1.3.4.2.3.cmml">t</mi><mi id="alg1.l11.m1.1.1.3.4.3" xref="alg1.l11.m1.1.1.3.4.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2.2">𝑹</ci><ci id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><times id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.1"></times><apply id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.2.1.cmml" xref="alg1.l11.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l11.m1.1.1.3.2.2.cmml" xref="alg1.l11.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.2.2.1.cmml" xref="alg1.l11.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.2.2.cmml" xref="alg1.l11.m1.1.1.3.2.2.2">𝑨</ci><ci id="alg1.l11.m1.1.1.3.2.2.3.cmml" xref="alg1.l11.m1.1.1.3.2.2.3">𝑡</ci></apply><ci id="alg1.l11.m1.1.1.3.2.3.cmml" xref="alg1.l11.m1.1.1.3.2.3">𝑇</ci></apply><apply id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.3.1.cmml" xref="alg1.l11.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l11.m1.1.1.3.3.2.cmml" xref="alg1.l11.m1.1.1.3.3.2">𝑮</ci><ci id="alg1.l11.m1.1.1.3.3.3.cmml" xref="alg1.l11.m1.1.1.3.3.3">𝑡</ci></apply><apply id="alg1.l11.m1.1.1.3.4.cmml" xref="alg1.l11.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.4.1.cmml" xref="alg1.l11.m1.1.1.3.4">superscript</csymbol><apply id="alg1.l11.m1.1.1.3.4.2.cmml" xref="alg1.l11.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.4.2.1.cmml" xref="alg1.l11.m1.1.1.3.4">subscript</csymbol><ci id="alg1.l11.m1.1.1.3.4.2.2.cmml" xref="alg1.l11.m1.1.1.3.4.2.2">𝑩</ci><ci id="alg1.l11.m1.1.1.3.4.2.3.cmml" xref="alg1.l11.m1.1.1.3.4.2.3">𝑡</ci></apply><ci id="alg1.l11.m1.1.1.3.4.3.cmml" xref="alg1.l11.m1.1.1.3.4.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\bm{R}_{t}\leftarrow\bm{A}_{t}^{T}\bm{G}_{t}\bm{B}_{t}^{T}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">bold_italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_italic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l11.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l11.1.m1.1"><semantics id="alg1.l11.1.m1.1a"><mo id="alg1.l11.1.m1.1.1" xref="alg1.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l11.1.m1.1b"><ci id="alg1.l11.1.m1.1.1.cmml" xref="alg1.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.1.m1.1d">▷</annotation></semantics></math> Project gradient
</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <math alttext="\bm{G}^{\prime}_{t}\leftarrow\bm{A}_{t}\bm{R}_{t}\bm{B}_{t}" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msubsup id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><mi id="alg1.l12.m1.1.1.2.2.2" xref="alg1.l12.m1.1.1.2.2.2.cmml">𝑮</mi><mi id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml">t</mi><mo id="alg1.l12.m1.1.1.2.2.3" xref="alg1.l12.m1.1.1.2.2.3.cmml">′</mo></msubsup><mo id="alg1.l12.m1.1.1.1" stretchy="false" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mrow id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><msub id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml"><mi id="alg1.l12.m1.1.1.3.2.2" xref="alg1.l12.m1.1.1.3.2.2.cmml">𝑨</mi><mi id="alg1.l12.m1.1.1.3.2.3" xref="alg1.l12.m1.1.1.3.2.3.cmml">t</mi></msub><mo id="alg1.l12.m1.1.1.3.1" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml"><mi id="alg1.l12.m1.1.1.3.3.2" xref="alg1.l12.m1.1.1.3.3.2.cmml">𝑹</mi><mi id="alg1.l12.m1.1.1.3.3.3" xref="alg1.l12.m1.1.1.3.3.3.cmml">t</mi></msub><mo id="alg1.l12.m1.1.1.3.1a" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l12.m1.1.1.3.4" xref="alg1.l12.m1.1.1.3.4.cmml"><mi id="alg1.l12.m1.1.1.3.4.2" xref="alg1.l12.m1.1.1.3.4.2.cmml">𝑩</mi><mi id="alg1.l12.m1.1.1.3.4.3" xref="alg1.l12.m1.1.1.3.4.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2">subscript</csymbol><apply id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.2.1.cmml" xref="alg1.l12.m1.1.1.2">superscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.2.cmml" xref="alg1.l12.m1.1.1.2.2.2">𝑮</ci><ci id="alg1.l12.m1.1.1.2.2.3.cmml" xref="alg1.l12.m1.1.1.2.2.3">′</ci></apply><ci id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><times id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1"></times><apply id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.2.2">𝑨</ci><ci id="alg1.l12.m1.1.1.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.2.3">𝑡</ci></apply><apply id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.1.cmml" xref="alg1.l12.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.2">𝑹</ci><ci id="alg1.l12.m1.1.1.3.3.3.cmml" xref="alg1.l12.m1.1.1.3.3.3">𝑡</ci></apply><apply id="alg1.l12.m1.1.1.3.4.cmml" xref="alg1.l12.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.4.1.cmml" xref="alg1.l12.m1.1.1.3.4">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.4.2.cmml" xref="alg1.l12.m1.1.1.3.4.2">𝑩</ci><ci id="alg1.l12.m1.1.1.3.4.3.cmml" xref="alg1.l12.m1.1.1.3.4.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\bm{G}^{\prime}_{t}\leftarrow\bm{A}_{t}\bm{R}_{t}\bm{B}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">bold_italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_italic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l12.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l12.1.m1.1"><semantics id="alg1.l12.1.m1.1a"><mo id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.1.m1.1d">▷</annotation></semantics></math> Reconstruct approximated gradient
</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>     Use updated gradient <math alttext="\bm{G}^{\prime}_{t}" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><msubsup id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2.2" xref="alg1.l13.m1.1.1.2.2.cmml">𝑮</mi><mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">t</mi><mo id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1">subscript</csymbol><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1">superscript</csymbol><ci id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2.2">𝑮</ci><ci id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3">′</ci></apply><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\bm{G}^{\prime}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">bold_italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in sampling algorithm

</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span><span class="ltx_text ltx_font_bold" id="alg1.l14.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l14.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span><span class="ltx_text ltx_font_bold" id="alg1.l15.1">return</span> <math alttext="\mathcal{D}(\hat{{\bm{z}}}_{0})" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">𝒟</mi><mo id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.cmml"><mo id="alg1.l15.m1.1.1.1.1.2" stretchy="false" xref="alg1.l15.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l15.m1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l15.m1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.2.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.2.2" xref="alg1.l15.m1.1.1.1.1.1.2.2.cmml">𝒛</mi><mo id="alg1.l15.m1.1.1.1.1.1.2.1" xref="alg1.l15.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mn id="alg1.l15.m1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg1.l15.m1.1.1.1.1.3" stretchy="false" xref="alg1.l15.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><times id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2"></times><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">𝒟</ci><apply id="alg1.l15.m1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l15.m1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.2"><ci id="alg1.l15.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.2.1">^</ci><ci id="alg1.l15.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.2.2">𝒛</ci></apply><cn id="alg1.l15.m1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l15.m1.1.1.1.1.1.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\mathcal{D}(\hat{{\bm{z}}}_{0})</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">caligraphic_D ( over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
</div>
</figure>
<div class="ltx_theorem ltx_theorem_proposition" id="S3.Thmproposition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmproposition1.1.1.1">Proposition 1</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmproposition1.2.2">.</span>
</h6>
<div class="ltx_para ltx_noindent" id="S3.Thmproposition1.p1">
<p class="ltx_p" id="S3.Thmproposition1.p1.12"><span class="ltx_text ltx_font_italic" id="S3.Thmproposition1.p1.12.12">Let <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.1.1.m1.1"><semantics id="S3.Thmproposition1.p1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.Thmproposition1.p1.1.1.m1.1.1" xref="S3.Thmproposition1.p1.1.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.1.1.m1.1b"><ci id="S3.Thmproposition1.p1.1.1.m1.1.1.cmml" xref="S3.Thmproposition1.p1.1.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.1.1.m1.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.1.1.m1.1d">caligraphic_M</annotation></semantics></math> be a smooth <math alttext="m" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.2.2.m2.1"><semantics id="S3.Thmproposition1.p1.2.2.m2.1a"><mi id="S3.Thmproposition1.p1.2.2.m2.1.1" xref="S3.Thmproposition1.p1.2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.2.2.m2.1b"><ci id="S3.Thmproposition1.p1.2.2.m2.1.1.cmml" xref="S3.Thmproposition1.p1.2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.2.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.2.2.m2.1d">italic_m</annotation></semantics></math>-dimensional submanifold of a <math alttext="d" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.3.3.m3.1"><semantics id="S3.Thmproposition1.p1.3.3.m3.1a"><mi id="S3.Thmproposition1.p1.3.3.m3.1.1" xref="S3.Thmproposition1.p1.3.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.3.3.m3.1b"><ci id="S3.Thmproposition1.p1.3.3.m3.1.1.cmml" xref="S3.Thmproposition1.p1.3.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.3.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.3.3.m3.1d">italic_d</annotation></semantics></math>-dimensional Euclidean space <math alttext="\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.4.4.m4.1"><semantics id="S3.Thmproposition1.p1.4.4.m4.1a"><msup id="S3.Thmproposition1.p1.4.4.m4.1.1" xref="S3.Thmproposition1.p1.4.4.m4.1.1.cmml"><mi id="S3.Thmproposition1.p1.4.4.m4.1.1.2" xref="S3.Thmproposition1.p1.4.4.m4.1.1.2.cmml">ℝ</mi><mi id="S3.Thmproposition1.p1.4.4.m4.1.1.3" xref="S3.Thmproposition1.p1.4.4.m4.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.4.4.m4.1b"><apply id="S3.Thmproposition1.p1.4.4.m4.1.1.cmml" xref="S3.Thmproposition1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.4.4.m4.1.1.1.cmml" xref="S3.Thmproposition1.p1.4.4.m4.1.1">superscript</csymbol><ci id="S3.Thmproposition1.p1.4.4.m4.1.1.2.cmml" xref="S3.Thmproposition1.p1.4.4.m4.1.1.2">ℝ</ci><ci id="S3.Thmproposition1.p1.4.4.m4.1.1.3.cmml" xref="S3.Thmproposition1.p1.4.4.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.4.4.m4.1c">\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.4.4.m4.1d">blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="m&lt;d" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.5.5.m5.1"><semantics id="S3.Thmproposition1.p1.5.5.m5.1a"><mrow id="S3.Thmproposition1.p1.5.5.m5.1.1" xref="S3.Thmproposition1.p1.5.5.m5.1.1.cmml"><mi id="S3.Thmproposition1.p1.5.5.m5.1.1.2" xref="S3.Thmproposition1.p1.5.5.m5.1.1.2.cmml">m</mi><mo id="S3.Thmproposition1.p1.5.5.m5.1.1.1" xref="S3.Thmproposition1.p1.5.5.m5.1.1.1.cmml">&lt;</mo><mi id="S3.Thmproposition1.p1.5.5.m5.1.1.3" xref="S3.Thmproposition1.p1.5.5.m5.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.5.5.m5.1b"><apply id="S3.Thmproposition1.p1.5.5.m5.1.1.cmml" xref="S3.Thmproposition1.p1.5.5.m5.1.1"><lt id="S3.Thmproposition1.p1.5.5.m5.1.1.1.cmml" xref="S3.Thmproposition1.p1.5.5.m5.1.1.1"></lt><ci id="S3.Thmproposition1.p1.5.5.m5.1.1.2.cmml" xref="S3.Thmproposition1.p1.5.5.m5.1.1.2">𝑚</ci><ci id="S3.Thmproposition1.p1.5.5.m5.1.1.3.cmml" xref="S3.Thmproposition1.p1.5.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.5.5.m5.1c">m&lt;d</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.5.5.m5.1d">italic_m &lt; italic_d</annotation></semantics></math>. Assume that for each point <math alttext="{\bm{z}}_{t}\in\mathcal{M}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.6.6.m6.1"><semantics id="S3.Thmproposition1.p1.6.6.m6.1a"><mrow id="S3.Thmproposition1.p1.6.6.m6.1.1" xref="S3.Thmproposition1.p1.6.6.m6.1.1.cmml"><msub id="S3.Thmproposition1.p1.6.6.m6.1.1.2" xref="S3.Thmproposition1.p1.6.6.m6.1.1.2.cmml"><mi id="S3.Thmproposition1.p1.6.6.m6.1.1.2.2" xref="S3.Thmproposition1.p1.6.6.m6.1.1.2.2.cmml">𝐳</mi><mi id="S3.Thmproposition1.p1.6.6.m6.1.1.2.3" xref="S3.Thmproposition1.p1.6.6.m6.1.1.2.3.cmml">t</mi></msub><mo id="S3.Thmproposition1.p1.6.6.m6.1.1.1" xref="S3.Thmproposition1.p1.6.6.m6.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmproposition1.p1.6.6.m6.1.1.3" xref="S3.Thmproposition1.p1.6.6.m6.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.6.6.m6.1b"><apply id="S3.Thmproposition1.p1.6.6.m6.1.1.cmml" xref="S3.Thmproposition1.p1.6.6.m6.1.1"><in id="S3.Thmproposition1.p1.6.6.m6.1.1.1.cmml" xref="S3.Thmproposition1.p1.6.6.m6.1.1.1"></in><apply id="S3.Thmproposition1.p1.6.6.m6.1.1.2.cmml" xref="S3.Thmproposition1.p1.6.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.6.6.m6.1.1.2.1.cmml" xref="S3.Thmproposition1.p1.6.6.m6.1.1.2">subscript</csymbol><ci id="S3.Thmproposition1.p1.6.6.m6.1.1.2.2.cmml" xref="S3.Thmproposition1.p1.6.6.m6.1.1.2.2">𝐳</ci><ci id="S3.Thmproposition1.p1.6.6.m6.1.1.2.3.cmml" xref="S3.Thmproposition1.p1.6.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.Thmproposition1.p1.6.6.m6.1.1.3.cmml" xref="S3.Thmproposition1.p1.6.6.m6.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.6.6.m6.1c">{\bm{z}}_{t}\in\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.6.6.m6.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_M</annotation></semantics></math>, the tangent space <math alttext="T_{{\bm{z}}_{t}}\mathcal{M}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.7.7.m7.1"><semantics id="S3.Thmproposition1.p1.7.7.m7.1a"><mrow id="S3.Thmproposition1.p1.7.7.m7.1.1" xref="S3.Thmproposition1.p1.7.7.m7.1.1.cmml"><msub id="S3.Thmproposition1.p1.7.7.m7.1.1.2" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2.cmml"><mi id="S3.Thmproposition1.p1.7.7.m7.1.1.2.2" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2.2.cmml">T</mi><msub id="S3.Thmproposition1.p1.7.7.m7.1.1.2.3" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.cmml"><mi id="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.2" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.2.cmml">𝐳</mi><mi id="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.3" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="S3.Thmproposition1.p1.7.7.m7.1.1.1" xref="S3.Thmproposition1.p1.7.7.m7.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmproposition1.p1.7.7.m7.1.1.3" xref="S3.Thmproposition1.p1.7.7.m7.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.7.7.m7.1b"><apply id="S3.Thmproposition1.p1.7.7.m7.1.1.cmml" xref="S3.Thmproposition1.p1.7.7.m7.1.1"><times id="S3.Thmproposition1.p1.7.7.m7.1.1.1.cmml" xref="S3.Thmproposition1.p1.7.7.m7.1.1.1"></times><apply id="S3.Thmproposition1.p1.7.7.m7.1.1.2.cmml" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.7.7.m7.1.1.2.1.cmml" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2">subscript</csymbol><ci id="S3.Thmproposition1.p1.7.7.m7.1.1.2.2.cmml" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2.2">𝑇</ci><apply id="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.cmml" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2.3"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.1.cmml" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2.3">subscript</csymbol><ci id="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.2.cmml" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.2">𝐳</ci><ci id="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.3.cmml" xref="S3.Thmproposition1.p1.7.7.m7.1.1.2.3.3">𝑡</ci></apply></apply><ci id="S3.Thmproposition1.p1.7.7.m7.1.1.3.cmml" xref="S3.Thmproposition1.p1.7.7.m7.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.7.7.m7.1c">T_{{\bm{z}}_{t}}\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.7.7.m7.1d">italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M</annotation></semantics></math> is well-defined, and the projection operator <math alttext="\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.8.8.m8.1"><semantics id="S3.Thmproposition1.p1.8.8.m8.1a"><msub id="S3.Thmproposition1.p1.8.8.m8.1.1" xref="S3.Thmproposition1.p1.8.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmproposition1.p1.8.8.m8.1.1.2" xref="S3.Thmproposition1.p1.8.8.m8.1.1.2.cmml">𝒫</mi><msub id="S3.Thmproposition1.p1.8.8.m8.1.1.3" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmproposition1.p1.8.8.m8.1.1.3.2" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3.2.cmml">𝒮</mi><msub id="S3.Thmproposition1.p1.8.8.m8.1.1.3.3" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.cmml"><mi id="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.2" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.2.cmml">𝐳</mi><mi id="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.3" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.3.cmml">t</mi></msub></msub></msub><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.8.8.m8.1b"><apply id="S3.Thmproposition1.p1.8.8.m8.1.1.cmml" xref="S3.Thmproposition1.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.8.8.m8.1.1.1.cmml" xref="S3.Thmproposition1.p1.8.8.m8.1.1">subscript</csymbol><ci id="S3.Thmproposition1.p1.8.8.m8.1.1.2.cmml" xref="S3.Thmproposition1.p1.8.8.m8.1.1.2">𝒫</ci><apply id="S3.Thmproposition1.p1.8.8.m8.1.1.3.cmml" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.8.8.m8.1.1.3.1.cmml" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3">subscript</csymbol><ci id="S3.Thmproposition1.p1.8.8.m8.1.1.3.2.cmml" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3.2">𝒮</ci><apply id="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.cmml" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.1.cmml" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3.3">subscript</csymbol><ci id="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.2.cmml" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.2">𝐳</ci><ci id="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.3.cmml" xref="S3.Thmproposition1.p1.8.8.m8.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.8.8.m8.1c">\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.8.8.m8.1d">caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> onto an approximate subspace <math alttext="\mathcal{S}_{{\bm{z}}_{t}}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.9.9.m9.1"><semantics id="S3.Thmproposition1.p1.9.9.m9.1a"><msub id="S3.Thmproposition1.p1.9.9.m9.1.1" xref="S3.Thmproposition1.p1.9.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmproposition1.p1.9.9.m9.1.1.2" xref="S3.Thmproposition1.p1.9.9.m9.1.1.2.cmml">𝒮</mi><msub id="S3.Thmproposition1.p1.9.9.m9.1.1.3" xref="S3.Thmproposition1.p1.9.9.m9.1.1.3.cmml"><mi id="S3.Thmproposition1.p1.9.9.m9.1.1.3.2" xref="S3.Thmproposition1.p1.9.9.m9.1.1.3.2.cmml">𝐳</mi><mi id="S3.Thmproposition1.p1.9.9.m9.1.1.3.3" xref="S3.Thmproposition1.p1.9.9.m9.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.9.9.m9.1b"><apply id="S3.Thmproposition1.p1.9.9.m9.1.1.cmml" xref="S3.Thmproposition1.p1.9.9.m9.1.1"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.9.9.m9.1.1.1.cmml" xref="S3.Thmproposition1.p1.9.9.m9.1.1">subscript</csymbol><ci id="S3.Thmproposition1.p1.9.9.m9.1.1.2.cmml" xref="S3.Thmproposition1.p1.9.9.m9.1.1.2">𝒮</ci><apply id="S3.Thmproposition1.p1.9.9.m9.1.1.3.cmml" xref="S3.Thmproposition1.p1.9.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.9.9.m9.1.1.3.1.cmml" xref="S3.Thmproposition1.p1.9.9.m9.1.1.3">subscript</csymbol><ci id="S3.Thmproposition1.p1.9.9.m9.1.1.3.2.cmml" xref="S3.Thmproposition1.p1.9.9.m9.1.1.3.2">𝐳</ci><ci id="S3.Thmproposition1.p1.9.9.m9.1.1.3.3.cmml" xref="S3.Thmproposition1.p1.9.9.m9.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.9.9.m9.1c">\mathcal{S}_{{\bm{z}}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.9.9.m9.1d">caligraphic_S start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> closely approximates the projection onto <math alttext="T_{{\bm{z}}_{t}}\mathcal{M}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.10.10.m10.1"><semantics id="S3.Thmproposition1.p1.10.10.m10.1a"><mrow id="S3.Thmproposition1.p1.10.10.m10.1.1" xref="S3.Thmproposition1.p1.10.10.m10.1.1.cmml"><msub id="S3.Thmproposition1.p1.10.10.m10.1.1.2" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2.cmml"><mi id="S3.Thmproposition1.p1.10.10.m10.1.1.2.2" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2.2.cmml">T</mi><msub id="S3.Thmproposition1.p1.10.10.m10.1.1.2.3" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.cmml"><mi id="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.2" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.2.cmml">𝐳</mi><mi id="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.3" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="S3.Thmproposition1.p1.10.10.m10.1.1.1" xref="S3.Thmproposition1.p1.10.10.m10.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmproposition1.p1.10.10.m10.1.1.3" xref="S3.Thmproposition1.p1.10.10.m10.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.10.10.m10.1b"><apply id="S3.Thmproposition1.p1.10.10.m10.1.1.cmml" xref="S3.Thmproposition1.p1.10.10.m10.1.1"><times id="S3.Thmproposition1.p1.10.10.m10.1.1.1.cmml" xref="S3.Thmproposition1.p1.10.10.m10.1.1.1"></times><apply id="S3.Thmproposition1.p1.10.10.m10.1.1.2.cmml" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.10.10.m10.1.1.2.1.cmml" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2">subscript</csymbol><ci id="S3.Thmproposition1.p1.10.10.m10.1.1.2.2.cmml" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2.2">𝑇</ci><apply id="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.cmml" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2.3"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.1.cmml" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2.3">subscript</csymbol><ci id="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.2.cmml" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.2">𝐳</ci><ci id="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.3.cmml" xref="S3.Thmproposition1.p1.10.10.m10.1.1.2.3.3">𝑡</ci></apply></apply><ci id="S3.Thmproposition1.p1.10.10.m10.1.1.3.cmml" xref="S3.Thmproposition1.p1.10.10.m10.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.10.10.m10.1c">T_{{\bm{z}}_{t}}\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.10.10.m10.1d">italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M</annotation></semantics></math>. For the state <math alttext="{\bm{z}}_{t}\in\mathcal{M}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.11.11.m11.1"><semantics id="S3.Thmproposition1.p1.11.11.m11.1a"><mrow id="S3.Thmproposition1.p1.11.11.m11.1.1" xref="S3.Thmproposition1.p1.11.11.m11.1.1.cmml"><msub id="S3.Thmproposition1.p1.11.11.m11.1.1.2" xref="S3.Thmproposition1.p1.11.11.m11.1.1.2.cmml"><mi id="S3.Thmproposition1.p1.11.11.m11.1.1.2.2" xref="S3.Thmproposition1.p1.11.11.m11.1.1.2.2.cmml">𝐳</mi><mi id="S3.Thmproposition1.p1.11.11.m11.1.1.2.3" xref="S3.Thmproposition1.p1.11.11.m11.1.1.2.3.cmml">t</mi></msub><mo id="S3.Thmproposition1.p1.11.11.m11.1.1.1" xref="S3.Thmproposition1.p1.11.11.m11.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmproposition1.p1.11.11.m11.1.1.3" xref="S3.Thmproposition1.p1.11.11.m11.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.11.11.m11.1b"><apply id="S3.Thmproposition1.p1.11.11.m11.1.1.cmml" xref="S3.Thmproposition1.p1.11.11.m11.1.1"><in id="S3.Thmproposition1.p1.11.11.m11.1.1.1.cmml" xref="S3.Thmproposition1.p1.11.11.m11.1.1.1"></in><apply id="S3.Thmproposition1.p1.11.11.m11.1.1.2.cmml" xref="S3.Thmproposition1.p1.11.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.11.11.m11.1.1.2.1.cmml" xref="S3.Thmproposition1.p1.11.11.m11.1.1.2">subscript</csymbol><ci id="S3.Thmproposition1.p1.11.11.m11.1.1.2.2.cmml" xref="S3.Thmproposition1.p1.11.11.m11.1.1.2.2">𝐳</ci><ci id="S3.Thmproposition1.p1.11.11.m11.1.1.2.3.cmml" xref="S3.Thmproposition1.p1.11.11.m11.1.1.2.3">𝑡</ci></apply><ci id="S3.Thmproposition1.p1.11.11.m11.1.1.3.cmml" xref="S3.Thmproposition1.p1.11.11.m11.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.11.11.m11.1c">{\bm{z}}_{t}\in\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.11.11.m11.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_M</annotation></semantics></math> and the measurement guidance gradient <math alttext="{\bm{g}}_{t}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.12.12.m12.1"><semantics id="S3.Thmproposition1.p1.12.12.m12.1a"><mrow id="S3.Thmproposition1.p1.12.12.m12.1.1" xref="S3.Thmproposition1.p1.12.12.m12.1.1.cmml"><msub id="S3.Thmproposition1.p1.12.12.m12.1.1.2" xref="S3.Thmproposition1.p1.12.12.m12.1.1.2.cmml"><mi id="S3.Thmproposition1.p1.12.12.m12.1.1.2.2" xref="S3.Thmproposition1.p1.12.12.m12.1.1.2.2.cmml">𝐠</mi><mi id="S3.Thmproposition1.p1.12.12.m12.1.1.2.3" xref="S3.Thmproposition1.p1.12.12.m12.1.1.2.3.cmml">t</mi></msub><mo id="S3.Thmproposition1.p1.12.12.m12.1.1.1" xref="S3.Thmproposition1.p1.12.12.m12.1.1.1.cmml">∈</mo><msup id="S3.Thmproposition1.p1.12.12.m12.1.1.3" xref="S3.Thmproposition1.p1.12.12.m12.1.1.3.cmml"><mi id="S3.Thmproposition1.p1.12.12.m12.1.1.3.2" xref="S3.Thmproposition1.p1.12.12.m12.1.1.3.2.cmml">ℝ</mi><mi id="S3.Thmproposition1.p1.12.12.m12.1.1.3.3" xref="S3.Thmproposition1.p1.12.12.m12.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.12.12.m12.1b"><apply id="S3.Thmproposition1.p1.12.12.m12.1.1.cmml" xref="S3.Thmproposition1.p1.12.12.m12.1.1"><in id="S3.Thmproposition1.p1.12.12.m12.1.1.1.cmml" xref="S3.Thmproposition1.p1.12.12.m12.1.1.1"></in><apply id="S3.Thmproposition1.p1.12.12.m12.1.1.2.cmml" xref="S3.Thmproposition1.p1.12.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.12.12.m12.1.1.2.1.cmml" xref="S3.Thmproposition1.p1.12.12.m12.1.1.2">subscript</csymbol><ci id="S3.Thmproposition1.p1.12.12.m12.1.1.2.2.cmml" xref="S3.Thmproposition1.p1.12.12.m12.1.1.2.2">𝐠</ci><ci id="S3.Thmproposition1.p1.12.12.m12.1.1.2.3.cmml" xref="S3.Thmproposition1.p1.12.12.m12.1.1.2.3">𝑡</ci></apply><apply id="S3.Thmproposition1.p1.12.12.m12.1.1.3.cmml" xref="S3.Thmproposition1.p1.12.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.Thmproposition1.p1.12.12.m12.1.1.3.1.cmml" xref="S3.Thmproposition1.p1.12.12.m12.1.1.3">superscript</csymbol><ci id="S3.Thmproposition1.p1.12.12.m12.1.1.3.2.cmml" xref="S3.Thmproposition1.p1.12.12.m12.1.1.3.2">ℝ</ci><ci id="S3.Thmproposition1.p1.12.12.m12.1.1.3.3.cmml" xref="S3.Thmproposition1.p1.12.12.m12.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.12.12.m12.1c">{\bm{g}}_{t}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.12.12.m12.1d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, consider two update rules:</span></p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E7">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E7X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\bm{z}}_{t-1}" class="ltx_Math" display="inline" id="S3.E7X.2.1.1.m1.1"><semantics id="S3.E7X.2.1.1.m1.1a"><msub id="S3.E7X.2.1.1.m1.1.1" xref="S3.E7X.2.1.1.m1.1.1.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.2" xref="S3.E7X.2.1.1.m1.1.1.2.cmml">𝒛</mi><mrow id="S3.E7X.2.1.1.m1.1.1.3" xref="S3.E7X.2.1.1.m1.1.1.3.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.3.2" xref="S3.E7X.2.1.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.E7X.2.1.1.m1.1.1.3.1" xref="S3.E7X.2.1.1.m1.1.1.3.1.cmml">−</mo><mn id="S3.E7X.2.1.1.m1.1.1.3.3" xref="S3.E7X.2.1.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E7X.2.1.1.m1.1b"><apply id="S3.E7X.2.1.1.m1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.2">𝒛</ci><apply id="S3.E7X.2.1.1.m1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.3"><minus id="S3.E7X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.3.1"></minus><ci id="S3.E7X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.3.2">𝑡</ci><cn id="S3.E7X.2.1.1.m1.1.1.3.3.cmml" type="integer" xref="S3.E7X.2.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.1c">\displaystyle{\bm{z}}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.E7X.2.1.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle={\bm{z}}_{t}-\eta{\bm{g}}_{t}\quad\text{(standard update)}," class="ltx_Math" display="inline" id="S3.E7X.3.2.2.m1.2"><semantics id="S3.E7X.3.2.2.m1.2a"><mrow id="S3.E7X.3.2.2.m1.2.2.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.cmml"><mrow id="S3.E7X.3.2.2.m1.2.2.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.3.cmml"></mi><mo id="S3.E7X.3.2.2.m1.2.2.1.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.2.cmml"><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.2.cmml">𝒛</mi><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.2.cmml">η</mi><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.2.cmml">𝒈</mi><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mspace id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2" width="1em" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.2.cmml"></mspace><mtext class="ltx_mathvariant_italic" id="S3.E7X.3.2.2.m1.1.1" xref="S3.E7X.3.2.2.m1.1.1a.cmml">(standard update)</mtext></mrow></mrow><mo id="S3.E7X.3.2.2.m1.2.2.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.3.2.2.m1.2b"><apply id="S3.E7X.3.2.2.m1.2.2.1.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1"><eq id="S3.E7X.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.2"></eq><csymbol cd="latexml" id="S3.E7X.3.2.2.m1.2.2.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.3">absent</csymbol><list id="S3.E7X.3.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1"><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1"><minus id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1"></minus><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.2">𝒛</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3"><times id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.1"></times><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.2">𝜂</ci><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.2">𝒈</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply><ci id="S3.E7X.3.2.2.m1.1.1a.cmml" xref="S3.E7X.3.2.2.m1.1.1"><mtext class="ltx_mathvariant_italic" id="S3.E7X.3.2.2.m1.1.1.cmml" xref="S3.E7X.3.2.2.m1.1.1">(standard update)</mtext></ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.3.2.2.m1.2c">\displaystyle={\bm{z}}_{t}-\eta{\bm{g}}_{t}\quad\text{(standard update)},</annotation><annotation encoding="application/x-llamapun" id="S3.E7X.3.2.2.m1.2d">= bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_η bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT (standard update) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E7Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\bm{z}}_{t-1}^{\prime}" class="ltx_Math" display="inline" id="S3.E7Xa.2.1.1.m1.1"><semantics id="S3.E7Xa.2.1.1.m1.1a"><msubsup id="S3.E7Xa.2.1.1.m1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.2.2" xref="S3.E7Xa.2.1.1.m1.1.1.2.2.cmml">𝒛</mi><mrow id="S3.E7Xa.2.1.1.m1.1.1.2.3" xref="S3.E7Xa.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.2.3.2" xref="S3.E7Xa.2.1.1.m1.1.1.2.3.2.cmml">t</mi><mo id="S3.E7Xa.2.1.1.m1.1.1.2.3.1" xref="S3.E7Xa.2.1.1.m1.1.1.2.3.1.cmml">−</mo><mn id="S3.E7Xa.2.1.1.m1.1.1.2.3.3" xref="S3.E7Xa.2.1.1.m1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.E7Xa.2.1.1.m1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.E7Xa.2.1.1.m1.1b"><apply id="S3.E7Xa.2.1.1.m1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1">superscript</csymbol><apply id="S3.E7Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.1.1.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.2.2">𝒛</ci><apply id="S3.E7Xa.2.1.1.m1.1.1.2.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.2.3"><minus id="S3.E7Xa.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.2.3.1"></minus><ci id="S3.E7Xa.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.2.3.2">𝑡</ci><cn id="S3.E7Xa.2.1.1.m1.1.1.2.3.3.cmml" type="integer" xref="S3.E7Xa.2.1.1.m1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E7Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.2.1.1.m1.1c">\displaystyle{\bm{z}}_{t-1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.E7Xa.2.1.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle={\bm{z}}_{t}-\eta\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}({\bm{g%
}}_{t})\quad\text{(projected update)}," class="ltx_Math" display="inline" id="S3.E7Xa.3.2.2.m1.2"><semantics id="S3.E7Xa.3.2.2.m1.2a"><mrow id="S3.E7Xa.3.2.2.m1.2.2.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.cmml"><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.cmml"><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.3.cmml"></mi><mo id="S3.E7Xa.3.2.2.m1.2.2.1.1.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.2.cmml"><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml">η</mi><mo id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.2.cmml">𝒫</mi><msub id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.2.cmml">𝒮</mi><msub id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.cmml"><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.2.cmml">𝒛</mi><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.3.cmml">t</mi></msub></msub></msub><mo id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2a" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝒈</mi><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2" width="1em" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.2.cmml"></mspace><mtext class="ltx_mathvariant_italic" id="S3.E7Xa.3.2.2.m1.1.1" xref="S3.E7Xa.3.2.2.m1.1.1a.cmml">(projected update)</mtext></mrow></mrow><mo id="S3.E7Xa.3.2.2.m1.2.2.1.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xa.3.2.2.m1.2b"><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1"><eq id="S3.E7Xa.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.2"></eq><csymbol cd="latexml" id="S3.E7Xa.3.2.2.m1.2.2.1.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.3">absent</csymbol><list id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1"><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1"><minus id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.2"></minus><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.2">𝒛</ci><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1"><times id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3">𝜂</ci><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.2">𝒫</ci><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.2">𝒮</ci><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3">subscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.2">𝒛</ci><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.4.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝒈</ci><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><ci id="S3.E7Xa.3.2.2.m1.1.1a.cmml" xref="S3.E7Xa.3.2.2.m1.1.1"><mtext class="ltx_mathvariant_italic" id="S3.E7Xa.3.2.2.m1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.1.1">(projected update)</mtext></ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.3.2.2.m1.2c">\displaystyle={\bm{z}}_{t}-\eta\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}({\bm{g%
}}_{t})\quad\text{(projected update)},</annotation><annotation encoding="application/x-llamapun" id="S3.E7Xa.3.2.2.m1.2d">= bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_η caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) (projected update) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.Thmproposition1.p1.13"><span class="ltx_text ltx_font_italic" id="S3.Thmproposition1.p1.13.1">where <math alttext="\eta&gt;0" class="ltx_Math" display="inline" id="S3.Thmproposition1.p1.13.1.m1.1"><semantics id="S3.Thmproposition1.p1.13.1.m1.1a"><mrow id="S3.Thmproposition1.p1.13.1.m1.1.1" xref="S3.Thmproposition1.p1.13.1.m1.1.1.cmml"><mi id="S3.Thmproposition1.p1.13.1.m1.1.1.2" xref="S3.Thmproposition1.p1.13.1.m1.1.1.2.cmml">η</mi><mo id="S3.Thmproposition1.p1.13.1.m1.1.1.1" xref="S3.Thmproposition1.p1.13.1.m1.1.1.1.cmml">&gt;</mo><mn id="S3.Thmproposition1.p1.13.1.m1.1.1.3" xref="S3.Thmproposition1.p1.13.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p1.13.1.m1.1b"><apply id="S3.Thmproposition1.p1.13.1.m1.1.1.cmml" xref="S3.Thmproposition1.p1.13.1.m1.1.1"><gt id="S3.Thmproposition1.p1.13.1.m1.1.1.1.cmml" xref="S3.Thmproposition1.p1.13.1.m1.1.1.1"></gt><ci id="S3.Thmproposition1.p1.13.1.m1.1.1.2.cmml" xref="S3.Thmproposition1.p1.13.1.m1.1.1.2">𝜂</ci><cn id="S3.Thmproposition1.p1.13.1.m1.1.1.3.cmml" type="integer" xref="S3.Thmproposition1.p1.13.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p1.13.1.m1.1c">\eta&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p1.13.1.m1.1d">italic_η &gt; 0</annotation></semantics></math> is a small step size.</span></p>
</div>
<div class="ltx_para" id="S3.Thmproposition1.p2">
<p class="ltx_p" id="S3.Thmproposition1.p2.4"><span class="ltx_text ltx_font_italic" id="S3.Thmproposition1.p2.4.4">Then, for sufficiently small <math alttext="\eta" class="ltx_Math" display="inline" id="S3.Thmproposition1.p2.1.1.m1.1"><semantics id="S3.Thmproposition1.p2.1.1.m1.1a"><mi id="S3.Thmproposition1.p2.1.1.m1.1.1" xref="S3.Thmproposition1.p2.1.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p2.1.1.m1.1b"><ci id="S3.Thmproposition1.p2.1.1.m1.1.1.cmml" xref="S3.Thmproposition1.p2.1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p2.1.1.m1.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p2.1.1.m1.1d">italic_η</annotation></semantics></math>, the projected update <math alttext="{\bm{z}}_{t-1}^{\prime}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p2.2.2.m2.1"><semantics id="S3.Thmproposition1.p2.2.2.m2.1a"><msubsup id="S3.Thmproposition1.p2.2.2.m2.1.1" xref="S3.Thmproposition1.p2.2.2.m2.1.1.cmml"><mi id="S3.Thmproposition1.p2.2.2.m2.1.1.2.2" xref="S3.Thmproposition1.p2.2.2.m2.1.1.2.2.cmml">𝐳</mi><mrow id="S3.Thmproposition1.p2.2.2.m2.1.1.2.3" xref="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.cmml"><mi id="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.2" xref="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.2.cmml">t</mi><mo id="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.1" xref="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.1.cmml">−</mo><mn id="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.3" xref="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.Thmproposition1.p2.2.2.m2.1.1.3" xref="S3.Thmproposition1.p2.2.2.m2.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p2.2.2.m2.1b"><apply id="S3.Thmproposition1.p2.2.2.m2.1.1.cmml" xref="S3.Thmproposition1.p2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.Thmproposition1.p2.2.2.m2.1.1.1.cmml" xref="S3.Thmproposition1.p2.2.2.m2.1.1">superscript</csymbol><apply id="S3.Thmproposition1.p2.2.2.m2.1.1.2.cmml" xref="S3.Thmproposition1.p2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.Thmproposition1.p2.2.2.m2.1.1.2.1.cmml" xref="S3.Thmproposition1.p2.2.2.m2.1.1">subscript</csymbol><ci id="S3.Thmproposition1.p2.2.2.m2.1.1.2.2.cmml" xref="S3.Thmproposition1.p2.2.2.m2.1.1.2.2">𝐳</ci><apply id="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.cmml" xref="S3.Thmproposition1.p2.2.2.m2.1.1.2.3"><minus id="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.1.cmml" xref="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.1"></minus><ci id="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.2.cmml" xref="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.2">𝑡</ci><cn id="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.3.cmml" type="integer" xref="S3.Thmproposition1.p2.2.2.m2.1.1.2.3.3">1</cn></apply></apply><ci id="S3.Thmproposition1.p2.2.2.m2.1.1.3.cmml" xref="S3.Thmproposition1.p2.2.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p2.2.2.m2.1c">{\bm{z}}_{t-1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p2.2.2.m2.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> stays closer to the manifold <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p2.3.3.m3.1"><semantics id="S3.Thmproposition1.p2.3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.Thmproposition1.p2.3.3.m3.1.1" xref="S3.Thmproposition1.p2.3.3.m3.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p2.3.3.m3.1b"><ci id="S3.Thmproposition1.p2.3.3.m3.1.1.cmml" xref="S3.Thmproposition1.p2.3.3.m3.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p2.3.3.m3.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p2.3.3.m3.1d">caligraphic_M</annotation></semantics></math> than the standard update <math alttext="{\bm{z}}_{t-1}" class="ltx_Math" display="inline" id="S3.Thmproposition1.p2.4.4.m4.1"><semantics id="S3.Thmproposition1.p2.4.4.m4.1a"><msub id="S3.Thmproposition1.p2.4.4.m4.1.1" xref="S3.Thmproposition1.p2.4.4.m4.1.1.cmml"><mi id="S3.Thmproposition1.p2.4.4.m4.1.1.2" xref="S3.Thmproposition1.p2.4.4.m4.1.1.2.cmml">𝐳</mi><mrow id="S3.Thmproposition1.p2.4.4.m4.1.1.3" xref="S3.Thmproposition1.p2.4.4.m4.1.1.3.cmml"><mi id="S3.Thmproposition1.p2.4.4.m4.1.1.3.2" xref="S3.Thmproposition1.p2.4.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.Thmproposition1.p2.4.4.m4.1.1.3.1" xref="S3.Thmproposition1.p2.4.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.Thmproposition1.p2.4.4.m4.1.1.3.3" xref="S3.Thmproposition1.p2.4.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.Thmproposition1.p2.4.4.m4.1b"><apply id="S3.Thmproposition1.p2.4.4.m4.1.1.cmml" xref="S3.Thmproposition1.p2.4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.Thmproposition1.p2.4.4.m4.1.1.1.cmml" xref="S3.Thmproposition1.p2.4.4.m4.1.1">subscript</csymbol><ci id="S3.Thmproposition1.p2.4.4.m4.1.1.2.cmml" xref="S3.Thmproposition1.p2.4.4.m4.1.1.2">𝐳</ci><apply id="S3.Thmproposition1.p2.4.4.m4.1.1.3.cmml" xref="S3.Thmproposition1.p2.4.4.m4.1.1.3"><minus id="S3.Thmproposition1.p2.4.4.m4.1.1.3.1.cmml" xref="S3.Thmproposition1.p2.4.4.m4.1.1.3.1"></minus><ci id="S3.Thmproposition1.p2.4.4.m4.1.1.3.2.cmml" xref="S3.Thmproposition1.p2.4.4.m4.1.1.3.2">𝑡</ci><cn id="S3.Thmproposition1.p2.4.4.m4.1.1.3.3.cmml" type="integer" xref="S3.Thmproposition1.p2.4.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmproposition1.p2.4.4.m4.1c">{\bm{z}}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmproposition1.p2.4.4.m4.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>. That is,</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})&lt;\text{dist}({\bm{z}}_{t-1},%
\mathcal{M})." class="ltx_Math" display="block" id="S3.E8.m1.3"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.3.1" xref="S3.E8.m1.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1.1" xref="S3.E8.m1.3.3.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E8.m1.3.3.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.3a.cmml">dist</mtext><mo id="S3.E8.m1.3.3.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E8.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">(</mo><msubsup id="S3.E8.m1.3.3.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.E8.m1.3.3.1.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E8.m1.3.3.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">ℳ</mi><mo id="S3.E8.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.3.3.1.1.3" xref="S3.E8.m1.3.3.1.1.3.cmml">&lt;</mo><mrow id="S3.E8.m1.3.3.1.1.2" xref="S3.E8.m1.3.3.1.1.2.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E8.m1.3.3.1.1.2.3" xref="S3.E8.m1.3.3.1.1.2.3a.cmml">dist</mtext><mo id="S3.E8.m1.3.3.1.1.2.2" xref="S3.E8.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.2.1.1" xref="S3.E8.m1.3.3.1.1.2.1.2.cmml"><mo id="S3.E8.m1.3.3.1.1.2.1.1.2" stretchy="false" xref="S3.E8.m1.3.3.1.1.2.1.2.cmml">(</mo><msub id="S3.E8.m1.3.3.1.1.2.1.1.1" xref="S3.E8.m1.3.3.1.1.2.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.2.1.1.1.2" xref="S3.E8.m1.3.3.1.1.2.1.1.1.2.cmml">𝒛</mi><mrow id="S3.E8.m1.3.3.1.1.2.1.1.1.3" xref="S3.E8.m1.3.3.1.1.2.1.1.1.3.cmml"><mi id="S3.E8.m1.3.3.1.1.2.1.1.1.3.2" xref="S3.E8.m1.3.3.1.1.2.1.1.1.3.2.cmml">t</mi><mo id="S3.E8.m1.3.3.1.1.2.1.1.1.3.1" xref="S3.E8.m1.3.3.1.1.2.1.1.1.3.1.cmml">−</mo><mn id="S3.E8.m1.3.3.1.1.2.1.1.1.3.3" xref="S3.E8.m1.3.3.1.1.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E8.m1.3.3.1.1.2.1.1.3" xref="S3.E8.m1.3.3.1.1.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml">ℳ</mi><mo id="S3.E8.m1.3.3.1.1.2.1.1.4" stretchy="false" xref="S3.E8.m1.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.3.3.1.2" lspace="0em" xref="S3.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1"><lt id="S3.E8.m1.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.3"></lt><apply id="S3.E8.m1.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1"><times id="S3.E8.m1.3.3.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.2"></times><ci id="S3.E8.m1.3.3.1.1.1.3a.cmml" xref="S3.E8.m1.3.3.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E8.m1.3.3.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.3">dist</mtext></ci><interval closure="open" id="S3.E8.m1.3.3.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1"><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.2">𝒛</ci><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.3"><minus id="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.1"></minus><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.3">′</ci></apply><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">ℳ</ci></interval></apply><apply id="S3.E8.m1.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2"><times id="S3.E8.m1.3.3.1.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2"></times><ci id="S3.E8.m1.3.3.1.1.2.3a.cmml" xref="S3.E8.m1.3.3.1.1.2.3"><mtext class="ltx_mathvariant_italic" id="S3.E8.m1.3.3.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.2.3">dist</mtext></ci><interval closure="open" id="S3.E8.m1.3.3.1.1.2.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2.1.1"><apply id="S3.E8.m1.3.3.1.1.2.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2.1.1.1.2">𝒛</ci><apply id="S3.E8.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.2.1.1.1.3"><minus id="S3.E8.m1.3.3.1.1.2.1.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.2.1.1.1.3.1"></minus><ci id="S3.E8.m1.3.3.1.1.2.1.1.1.3.2.cmml" xref="S3.E8.m1.3.3.1.1.2.1.1.1.3.2">𝑡</ci><cn id="S3.E8.m1.3.3.1.1.2.1.1.1.3.3.cmml" type="integer" xref="S3.E8.m1.3.3.1.1.2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">ℳ</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})&lt;\text{dist}({\bm{z}}_{t-1},%
\mathcal{M}).</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.3d">dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M ) &lt; dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , caligraphic_M ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.p4">
<p class="ltx_p" id="S3.p4.5">The remainder of this section provides intuitions on how DiffStateGrad improves solving inverse problems in the presence of a suitable learned prior. Let the initial latent state <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><msub id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">𝒛</mi><mi id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝒛</ci><ci id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> be on the manifold <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><msub id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">ℳ</mi><mi id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">ℳ</ci><ci id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (e.g., being artifact-free, as the diffusion model is trained on clean data samples). We observe that pushing away from the manifold process (e.g., introducing artifacts) can only be introduced via the guidance by the data-consistency gradient step, as this is the sole mechanism by which information from the measurement process enters the latent space. Consider the manifold <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.p4.3.m3.1"><semantics id="S3.p4.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><ci id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.m3.1d">caligraphic_M</annotation></semantics></math> of artifact-free latent representations. Each <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p4.4.m4.1"><semantics id="S3.p4.4.m4.1a"><msub id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml"><mi id="S3.p4.4.m4.1.1.2" xref="S3.p4.4.m4.1.1.2.cmml">𝒛</mi><mi id="S3.p4.4.m4.1.1.3" xref="S3.p4.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><apply id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p4.4.m4.1.1.1.cmml" xref="S3.p4.4.m4.1.1">subscript</csymbol><ci id="S3.p4.4.m4.1.1.2.cmml" xref="S3.p4.4.m4.1.1.2">𝒛</ci><ci id="S3.p4.4.m4.1.1.3.cmml" xref="S3.p4.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.4.m4.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> lies on this manifold, and the tangent space <math alttext="T_{{\bm{z}}_{t}}\mathcal{M}" class="ltx_Math" display="inline" id="S3.p4.5.m5.1"><semantics id="S3.p4.5.m5.1a"><mrow id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml"><msub id="S3.p4.5.m5.1.1.2" xref="S3.p4.5.m5.1.1.2.cmml"><mi id="S3.p4.5.m5.1.1.2.2" xref="S3.p4.5.m5.1.1.2.2.cmml">T</mi><msub id="S3.p4.5.m5.1.1.2.3" xref="S3.p4.5.m5.1.1.2.3.cmml"><mi id="S3.p4.5.m5.1.1.2.3.2" xref="S3.p4.5.m5.1.1.2.3.2.cmml">𝒛</mi><mi id="S3.p4.5.m5.1.1.2.3.3" xref="S3.p4.5.m5.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="S3.p4.5.m5.1.1.1" xref="S3.p4.5.m5.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.p4.5.m5.1.1.3" xref="S3.p4.5.m5.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><apply id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1"><times id="S3.p4.5.m5.1.1.1.cmml" xref="S3.p4.5.m5.1.1.1"></times><apply id="S3.p4.5.m5.1.1.2.cmml" xref="S3.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p4.5.m5.1.1.2.1.cmml" xref="S3.p4.5.m5.1.1.2">subscript</csymbol><ci id="S3.p4.5.m5.1.1.2.2.cmml" xref="S3.p4.5.m5.1.1.2.2">𝑇</ci><apply id="S3.p4.5.m5.1.1.2.3.cmml" xref="S3.p4.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.p4.5.m5.1.1.2.3.1.cmml" xref="S3.p4.5.m5.1.1.2.3">subscript</csymbol><ci id="S3.p4.5.m5.1.1.2.3.2.cmml" xref="S3.p4.5.m5.1.1.2.3.2">𝒛</ci><ci id="S3.p4.5.m5.1.1.2.3.3.cmml" xref="S3.p4.5.m5.1.1.2.3.3">𝑡</ci></apply></apply><ci id="S3.p4.5.m5.1.1.3.cmml" xref="S3.p4.5.m5.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">T_{{\bm{z}}_{t}}\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.5.m5.1d">italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M</annotation></semantics></math> represents the directions of “allowable” updates that maintain the artifact-free property staying on the current manifold.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p5">
<p class="ltx_p" id="S3.p5.4">Our DiffStateGrad method, through the projection operator <math alttext="\mathcal{P}_{\mathcal{S}_{t}}" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><msub id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.1.m1.1.1.2" xref="S3.p5.1.m1.1.1.2.cmml">𝒫</mi><msub id="S3.p5.1.m1.1.1.3" xref="S3.p5.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.1.m1.1.1.3.2" xref="S3.p5.1.m1.1.1.3.2.cmml">𝒮</mi><mi id="S3.p5.1.m1.1.1.3.3" xref="S3.p5.1.m1.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><apply id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.1.cmml" xref="S3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.p5.1.m1.1.1.2.cmml" xref="S3.p5.1.m1.1.1.2">𝒫</ci><apply id="S3.p5.1.m1.1.1.3.cmml" xref="S3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.3.1.cmml" xref="S3.p5.1.m1.1.1.3">subscript</csymbol><ci id="S3.p5.1.m1.1.1.3.2.cmml" xref="S3.p5.1.m1.1.1.3.2">𝒮</ci><ci id="S3.p5.1.m1.1.1.3.3.cmml" xref="S3.p5.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\mathcal{P}_{\mathcal{S}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, approximates this tangent space. The effectiveness of DiffStateGrad depends on how well <math alttext="\mathcal{P}_{\mathcal{S}_{t}}" class="ltx_Math" display="inline" id="S3.p5.2.m2.1"><semantics id="S3.p5.2.m2.1a"><msub id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.2.m2.1.1.2" xref="S3.p5.2.m2.1.1.2.cmml">𝒫</mi><msub id="S3.p5.2.m2.1.1.3" xref="S3.p5.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.2.m2.1.1.3.2" xref="S3.p5.2.m2.1.1.3.2.cmml">𝒮</mi><mi id="S3.p5.2.m2.1.1.3.3" xref="S3.p5.2.m2.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p5.2.m2.1.1.1.cmml" xref="S3.p5.2.m2.1.1">subscript</csymbol><ci id="S3.p5.2.m2.1.1.2.cmml" xref="S3.p5.2.m2.1.1.2">𝒫</ci><apply id="S3.p5.2.m2.1.1.3.cmml" xref="S3.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p5.2.m2.1.1.3.1.cmml" xref="S3.p5.2.m2.1.1.3">subscript</csymbol><ci id="S3.p5.2.m2.1.1.3.2.cmml" xref="S3.p5.2.m2.1.1.3.2">𝒮</ci><ci id="S3.p5.2.m2.1.1.3.3.cmml" xref="S3.p5.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">\mathcal{P}_{\mathcal{S}_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m2.1d">caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> approximates the projection onto <math alttext="T_{{\bm{z}}_{t}}\mathcal{M}" class="ltx_Math" display="inline" id="S3.p5.3.m3.1"><semantics id="S3.p5.3.m3.1a"><mrow id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml"><msub id="S3.p5.3.m3.1.1.2" xref="S3.p5.3.m3.1.1.2.cmml"><mi id="S3.p5.3.m3.1.1.2.2" xref="S3.p5.3.m3.1.1.2.2.cmml">T</mi><msub id="S3.p5.3.m3.1.1.2.3" xref="S3.p5.3.m3.1.1.2.3.cmml"><mi id="S3.p5.3.m3.1.1.2.3.2" xref="S3.p5.3.m3.1.1.2.3.2.cmml">𝒛</mi><mi id="S3.p5.3.m3.1.1.2.3.3" xref="S3.p5.3.m3.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="S3.p5.3.m3.1.1.1" xref="S3.p5.3.m3.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.p5.3.m3.1.1.3" xref="S3.p5.3.m3.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><apply id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1"><times id="S3.p5.3.m3.1.1.1.cmml" xref="S3.p5.3.m3.1.1.1"></times><apply id="S3.p5.3.m3.1.1.2.cmml" xref="S3.p5.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.p5.3.m3.1.1.2.1.cmml" xref="S3.p5.3.m3.1.1.2">subscript</csymbol><ci id="S3.p5.3.m3.1.1.2.2.cmml" xref="S3.p5.3.m3.1.1.2.2">𝑇</ci><apply id="S3.p5.3.m3.1.1.2.3.cmml" xref="S3.p5.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S3.p5.3.m3.1.1.2.3.1.cmml" xref="S3.p5.3.m3.1.1.2.3">subscript</csymbol><ci id="S3.p5.3.m3.1.1.2.3.2.cmml" xref="S3.p5.3.m3.1.1.2.3.2">𝒛</ci><ci id="S3.p5.3.m3.1.1.2.3.3.cmml" xref="S3.p5.3.m3.1.1.2.3.3">𝑡</ci></apply></apply><ci id="S3.p5.3.m3.1.1.3.cmml" xref="S3.p5.3.m3.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">T_{{\bm{z}}_{t}}\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.3.m3.1d">italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M</annotation></semantics></math>. Hence, we discuss a rationale on how the approximated projection is sufficient for performance; we, accordingly, support this by experimental results in <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4" title="4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a>. First, the SVD captures the principal directions of variation in <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p5.4.m4.1"><semantics id="S3.p5.4.m4.1a"><msub id="S3.p5.4.m4.1.1" xref="S3.p5.4.m4.1.1.cmml"><mi id="S3.p5.4.m4.1.1.2" xref="S3.p5.4.m4.1.1.2.cmml">𝒛</mi><mi id="S3.p5.4.m4.1.1.3" xref="S3.p5.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.4.m4.1b"><apply id="S3.p5.4.m4.1.1.cmml" xref="S3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p5.4.m4.1.1.1.cmml" xref="S3.p5.4.m4.1.1">subscript</csymbol><ci id="S3.p5.4.m4.1.1.2.cmml" xref="S3.p5.4.m4.1.1.2">𝒛</ci><ci id="S3.p5.4.m4.1.1.3.cmml" xref="S3.p5.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.m4.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.4.m4.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which are likely to align with the local structure of the manifold when the data is high-dimensional. Second, by adaptively choosing the rank based on a variance retention threshold, we ensure that the projection preserves the most significant state-related structural information while filtering out potential noise or artifact-inducing components from the measurement gradient. Finally, the low-rank nature of our approximation aligns with the assumption that the manifold of representations has a lower intrinsic dimensionality than the ambient space.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p6">
<p class="ltx_p" id="S3.p6.6">Hence, by projecting the measurement gradient onto this subspace defined by the current latent state <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p6.1.m1.1"><semantics id="S3.p6.1.m1.1a"><msub id="S3.p6.1.m1.1.1" xref="S3.p6.1.m1.1.1.cmml"><mi id="S3.p6.1.m1.1.1.2" xref="S3.p6.1.m1.1.1.2.cmml">𝒛</mi><mi id="S3.p6.1.m1.1.1.3" xref="S3.p6.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p6.1.m1.1b"><apply id="S3.p6.1.m1.1.1.cmml" xref="S3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p6.1.m1.1.1.1.cmml" xref="S3.p6.1.m1.1.1">subscript</csymbol><ci id="S3.p6.1.m1.1.1.2.cmml" xref="S3.p6.1.m1.1.1.2">𝒛</ci><ci id="S3.p6.1.m1.1.1.3.cmml" xref="S3.p6.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.1.m1.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we effectively filter the directions orthogonal to the local manifold structure, and hence, remove artifacts-inducing components. This projection ensures that updates to <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p6.2.m2.1"><semantics id="S3.p6.2.m2.1a"><msub id="S3.p6.2.m2.1.1" xref="S3.p6.2.m2.1.1.cmml"><mi id="S3.p6.2.m2.1.1.2" xref="S3.p6.2.m2.1.1.2.cmml">𝒛</mi><mi id="S3.p6.2.m2.1.1.3" xref="S3.p6.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p6.2.m2.1b"><apply id="S3.p6.2.m2.1.1.cmml" xref="S3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p6.2.m2.1.1.1.cmml" xref="S3.p6.2.m2.1.1">subscript</csymbol><ci id="S3.p6.2.m2.1.1.2.cmml" xref="S3.p6.2.m2.1.1.2">𝒛</ci><ci id="S3.p6.2.m2.1.1.3.cmml" xref="S3.p6.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.2.m2.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.2.m2.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> remain closer to the manifold <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.p6.3.m3.1"><semantics id="S3.p6.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p6.3.m3.1.1" xref="S3.p6.3.m3.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p6.3.m3.1b"><ci id="S3.p6.3.m3.1.1.cmml" xref="S3.p6.3.m3.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.3.m3.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.3.m3.1d">caligraphic_M</annotation></semantics></math> than unprojected updates would, as stated in <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S3.Thmproposition1" title="Proposition 1. ‣ 3 Diffusion State-Guided Projected Gradient (DiffStateGrad) ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a>. Consequently, DiffStateGrad relies on the reliability of the learned prior and helps to provide high-probability posterior samples. This creates an inductive process: if <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p6.4.m4.1"><semantics id="S3.p6.4.m4.1a"><msub id="S3.p6.4.m4.1.1" xref="S3.p6.4.m4.1.1.cmml"><mi id="S3.p6.4.m4.1.1.2" xref="S3.p6.4.m4.1.1.2.cmml">𝒛</mi><mi id="S3.p6.4.m4.1.1.3" xref="S3.p6.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p6.4.m4.1b"><apply id="S3.p6.4.m4.1.1.cmml" xref="S3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p6.4.m4.1.1.1.cmml" xref="S3.p6.4.m4.1.1">subscript</csymbol><ci id="S3.p6.4.m4.1.1.2.cmml" xref="S3.p6.4.m4.1.1.2">𝒛</ci><ci id="S3.p6.4.m4.1.1.3.cmml" xref="S3.p6.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.4.m4.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.4.m4.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is artifact-free, and we only allow updates that align with its structure (i.e., updates that stay close to the manifold <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.p6.5.m5.1"><semantics id="S3.p6.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p6.5.m5.1.1" xref="S3.p6.5.m5.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p6.5.m5.1b"><ci id="S3.p6.5.m5.1.1.cmml" xref="S3.p6.5.m5.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.5.m5.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.5.m5.1d">caligraphic_M</annotation></semantics></math>), subsequent latent representation <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="S3.p6.6.m6.1"><semantics id="S3.p6.6.m6.1a"><msub id="S3.p6.6.m6.1.1" xref="S3.p6.6.m6.1.1.cmml"><mi id="S3.p6.6.m6.1.1.2" xref="S3.p6.6.m6.1.1.2.cmml">𝒛</mi><mi id="S3.p6.6.m6.1.1.3" xref="S3.p6.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p6.6.m6.1b"><apply id="S3.p6.6.m6.1.1.cmml" xref="S3.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p6.6.m6.1.1.1.cmml" xref="S3.p6.6.m6.1.1">subscript</csymbol><ci id="S3.p6.6.m6.1.1.2.cmml" xref="S3.p6.6.m6.1.1.2">𝒛</ci><ci id="S3.p6.6.m6.1.1.3.cmml" xref="S3.p6.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.6.m6.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.6.m6.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> will likely be samples from the high-probability regions of the posterior.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p7">
<p class="ltx_p" id="S3.p7.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S1.F2" title="In 1 Introduction ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a> demonstrates the effectiveness of DiffStateGrad in removing artifacts when the MG step size is large; artifacts are introduced onto the measurement gradient and stay within the latent representation in PSLD <cite class="ltx_cite ltx_citemacro_citep">(Rout et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib23" title="">2023</a>)</cite>. On the other hand, the reverse process via DiffStateGrad-PSLD (our method applied to PSLD) stays artifact-free, consistent with the mathematical analysis in <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S3.Thmproposition1" title="Proposition 1. ‣ 3 Diffusion State-Guided Projected Gradient (DiffStateGrad) ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a> and the practical efficacy of the proposed SVD-based subspace projection. Finally, we note that the most significant improvements appear in challenging tasks such as phase retrieval, HDR, and inpainting. We attribute the effectiveness of DiffStateGrad, particularly in challenging tasks, to a reduced rate of failure cases (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S2.F3" title="In 2 Background &amp; Related Works ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a>). By constraining solutions closer to the data manifold, DiffStateGrad minimizes extreme failures, enhances consistency in reconstruction quality, and improves overall performance metrics.</p>
</div>
<figure class="ltx_figure ltx_align_center ltx_align_floatright" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="339" id="S3.F4.1.1.g1" src="extracted/5900490/figures/runtime/diffusion_solvers_runtime_comparison_horizontal.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S3.F4.3.1">Runtime complexity of DiffStateGrad.</span> The increase of runtime with DiffStateGrad is minimal.</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Efficiency</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">DiffStateGrad introduces minimal computational overhead. We perform SVD <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.1.1">at most</span> once per iteration, and for latent diffusion solvers, this occurs in the latent space on <math alttext="64\times 64" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mn id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">64</mn><mo id="S3.SS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><times id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></times><cn id="S3.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.2">64</cn><cn id="S3.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">64 × 64</annotation></semantics></math> matrices. By selecting a low rank based on a variance threshold, subsequent projection and reconstruction operations are performed on reduced matrices, further decreasing computational complexity. <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S3.F4" title="In 3 Diffusion State-Guided Projected Gradient (DiffStateGrad) ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a> illustrates the runtime for the three diffusion-based methods of PSLD <cite class="ltx_cite ltx_citemacro_citep">(Rout et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib23" title="">2023</a>)</cite>, ReSample <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib28" title="">2023a</a>)</cite>, and DAPS <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib39" title="">2024</a>)</cite> with and without DiffStateGrad. The figure shows that the additional computational cost of incorporating DiffStateGrad is marginal, typically adding only a few seconds to the total runtime (see <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS2" title="C.2 Efficiency Experiment ‣ Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">C.2</span></a> for further details). We note that our method is not intended to <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.1.2">improve</span> efficiency, but rather to enhance performance and robustness.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">This section provides extensive experimental results on the effectiveness of DiffStateGrad employed in several methods for image-based inverse problems. We show that DiffStateGrad significantly improves (1) the robustness of diffusion-based methods to the choice of measurement gradient step size and measurement noise, and (2) the overall posterior sampling performance of diffusion.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">We evaluate the performance of DiffStateGrad applied to three SOTA diffusion methods of PSLD <cite class="ltx_cite ltx_citemacro_citep">(Rout et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib23" title="">2023</a>)</cite>, ReSample <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib28" title="">2023a</a>)</cite>, and DAPS <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib39" title="">2024</a>)</cite>. These methods span both latent solvers (PSLD and ReSample) and pixel-based solvers (DAPS). We evaluate their performance based on key quantitative metrics, including LPIPS (Learned Perceptual Image Patch Similarity), PSNR (Peak Signal-to-Noise Ratio), and SSIM (Structural Similarity Index) <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib37" title="">2004</a>)</cite>. We demonstrate the effectiveness of DiffStateGrad on two datasets: a) the FFHQ <math alttext="256\times 256" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">256</mn><mo id="S4.SS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><times id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></times><cn id="S4.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.2">256</cn><cn id="S4.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">256\times 256</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">256 × 256</annotation></semantics></math> validation dataset <cite class="ltx_cite ltx_citemacro_citep">(Karras et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib14" title="">2021</a>)</cite>, and b) the ImageNet <math alttext="256\times 256" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mn id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">256</mn><mo id="S4.SS1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><times id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></times><cn id="S4.SS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1.2">256</cn><cn id="S4.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">256\times 256</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">256 × 256</annotation></semantics></math> validation dataset <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib6" title="">2009</a>)</cite>. For pixel-based experiments, we use (i) the pre-trained diffusion model from <cite class="ltx_cite ltx_citemacro_citep">(Chung et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib4" title="">2023</a>)</cite> for the FFHQ dataset, and (ii) the pre-trained model from <cite class="ltx_cite ltx_citemacro_citep">(Dhariwal &amp; Nichol, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib7" title="">2021</a>)</cite> for the ImageNet dataset. For latent diffusion experiments, we use (i) the unconditional LDM-VQ-4 model trained on FFHQ <cite class="ltx_cite ltx_citemacro_citep">(Rombach et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib22" title="">2022</a>)</cite> for the FFHQ dataset, and (ii) the Stable Diffusion v1.5 <cite class="ltx_cite ltx_citemacro_citep">(Rombach et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib22" title="">2022</a>)</cite> model for the ImageNet dataset.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.2">We consider both linear and nonlinear inverse problems for natural images. For evaluation, we sample a fixed set of <math alttext="100" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mn id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><cn id="S4.SS1.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p2.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">100</annotation></semantics></math> images from the FFHQ and ImageNet validation sets. Images are normalized to the range <math alttext="[0,1]" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.2"><semantics id="S4.SS1.p2.2.m2.2a"><mrow id="S4.SS1.p2.2.m2.2.3.2" xref="S4.SS1.p2.2.m2.2.3.1.cmml"><mo id="S4.SS1.p2.2.m2.2.3.2.1" stretchy="false" xref="S4.SS1.p2.2.m2.2.3.1.cmml">[</mo><mn id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">0</mn><mo id="S4.SS1.p2.2.m2.2.3.2.2" xref="S4.SS1.p2.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS1.p2.2.m2.2.2" xref="S4.SS1.p2.2.m2.2.2.cmml">1</mn><mo id="S4.SS1.p2.2.m2.2.3.2.3" stretchy="false" xref="S4.SS1.p2.2.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.2b"><interval closure="closed" id="S4.SS1.p2.2.m2.2.3.1.cmml" xref="S4.SS1.p2.2.m2.2.3.2"><cn id="S4.SS1.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p2.2.m2.1.1">0</cn><cn id="S4.SS1.p2.2.m2.2.2.cmml" type="integer" xref="S4.SS1.p2.2.m2.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.2d">[ 0 , 1 ]</annotation></semantics></math>. We use the default settings for PSLD, ReSample, and DAPS for all experiments (see <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3" title="Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">C</span></a> for more details).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.6">For linear inverse problems, we consider (1) box inpainting, (2) random inpainting, (3) Gaussian deblur, (4) motion deblur, and (5) super-resolution. In the box inpainting task, a random <math alttext="128\times 128" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mn id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">128</mn><mo id="S4.SS1.p3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p3.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><times id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></times><cn id="S4.SS1.p3.1.m1.1.1.2.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.2">128</cn><cn id="S4.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">128\times 128</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">128 × 128</annotation></semantics></math> box is used, while the random inpainting task employs a <math alttext="70\%" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mn id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">70</mn><mo id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1">percent</csymbol><cn id="S4.SS1.p3.2.m2.1.1.2.cmml" type="integer" xref="S4.SS1.p3.2.m2.1.1.2">70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">70\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">70 %</annotation></semantics></math> random mask. Gaussian and motion deblurring tasks utilize kernels of size <math alttext="61\times 61" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mrow id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mn id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">61</mn><mo id="S4.SS1.p3.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p3.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml">61</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><times id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1"></times><cn id="S4.SS1.p3.3.m3.1.1.2.cmml" type="integer" xref="S4.SS1.p3.3.m3.1.1.2">61</cn><cn id="S4.SS1.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.p3.3.m3.1.1.3">61</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">61\times 61</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">61 × 61</annotation></semantics></math>, with standard deviations of <math alttext="3.0" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><mn id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">3.0</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><cn id="S4.SS1.p3.4.m4.1.1.cmml" type="float" xref="S4.SS1.p3.4.m4.1.1">3.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">3.0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">3.0</annotation></semantics></math> and <math alttext="0.5" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><mn id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><cn id="S4.SS1.p3.5.m5.1.1.cmml" type="float" xref="S4.SS1.p3.5.m5.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">0.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">0.5</annotation></semantics></math>, respectively. For super-resolution, images are downscaled by a factor of <math alttext="4" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><mn id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><cn id="S4.SS1.p3.6.m6.1.1.cmml" type="integer" xref="S4.SS1.p3.6.m6.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">4</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">4</annotation></semantics></math> using a bicubic resizer. For nonlinear inverse problems, we consider (1) phase retrieval, (2) nonlinear deblur, and (3) high dynamic range (HDR). For phase retrieval, we use an oversampling rate of 2.0, and due to the instability and non-uniqueness of reconstruction, we adopt the strategy from DPS <cite class="ltx_cite ltx_citemacro_citep">(Chung et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib4" title="">2023</a>)</cite> and DAPS <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib39" title="">2024</a>)</cite>, generating four separate reconstructions and reporting the best result. Like DAPS <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib39" title="">2024</a>)</cite>, we normalize the data to lie in the range [0, 1] before applying the discrete Fourier transform. For nonlinear deblur, we use the default setting from <cite class="ltx_cite ltx_citemacro_citep">(Tran et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib33" title="">2021</a>)</cite>. For HDR, we use a scale factor of 2. We note that PSLD is not designed to handle nonlinear inverse problems.</p>
</div>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.fig1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S4.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="273" id="S4.F6.sf1.g1" src="extracted/5900490/figures/nmse_vs_omega_plot_var_cutoff_robust.png" width="384"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Box Inpainting (NMSE).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="273" id="S4.F6.sf2.g1" src="extracted/5900490/figures/psnr_vs_omega_plot_var_cutoff_robust.png" width="384"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Box Inpainting (PSNR).</figcaption>
</figure>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.fig2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel" id="S4.F6.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="390" id="S4.F6.sf3.g1" src="extracted/5900490/figures/robust_step_size/lpips_vs_mg_step_size_plot_random_inpainting_with_std.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Random Inpainting (LPIPS).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="390" id="S4.F6.sf4.g1" src="extracted/5900490/figures/robust_step_size/lpips_vs_mg_step_size_plot_motion_deblur_with_std.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>Motion Deblur (LPIPS).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="390" id="S4.F6.sf5.g1" src="extracted/5900490/figures/robust_step_size/lpips_vs_mg_step_size_plot_super_resolution_with_std.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(e) </span>Super-Resolution (LPIPS).</figcaption>
</figure>
</div>
</div>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="S4.F6.4.1">Robustness of DiffStateGrad to MG step size</span>. (a-b) Performance on box inpainting across various MG step sizes. (c-e) Performance on different tasks with default and large step sizes. We evaluate the performance of PSLD and DiffStateGrad-PSLD using FFHQ <math alttext="256\times 256" class="ltx_Math" display="inline" id="S4.F6.2.m1.1"><semantics id="S4.F6.2.m1.1b"><mrow id="S4.F6.2.m1.1.1" xref="S4.F6.2.m1.1.1.cmml"><mn id="S4.F6.2.m1.1.1.2" xref="S4.F6.2.m1.1.1.2.cmml">256</mn><mo id="S4.F6.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.F6.2.m1.1.1.1.cmml">×</mo><mn id="S4.F6.2.m1.1.1.3" xref="S4.F6.2.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.2.m1.1c"><apply id="S4.F6.2.m1.1.1.cmml" xref="S4.F6.2.m1.1.1"><times id="S4.F6.2.m1.1.1.1.cmml" xref="S4.F6.2.m1.1.1.1"></times><cn id="S4.F6.2.m1.1.1.2.cmml" type="integer" xref="S4.F6.2.m1.1.1.2">256</cn><cn id="S4.F6.2.m1.1.1.3.cmml" type="integer" xref="S4.F6.2.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.2.m1.1d">256\times 256</annotation><annotation encoding="application/x-llamapun" id="S4.F6.2.m1.1e">256 × 256</annotation></semantics></math>.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S4.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="341" id="S4.F7.sf1.g1" src="extracted/5900490/figures/robust_meas_noise/ssim_vs_noise_plot_plorg_daps_vs_daps.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Inpainting (Box).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S4.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="341" id="S4.F7.sf2.g1" src="extracted/5900490/figures/robust_meas_noise/ssim_vs_noise_plot_plorg_psld_vs_psld.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Gaussian Deblur.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="S4.F7.4.1">Robustness of DiffStateGrad to measurement noise.</span> We evaluate the performance of DiffStateGrad-PSLD and PSLD-DAPS with their respective counterparts on different tasks across a range of measurement noise levels using FFHQ <math alttext="256\times 256" class="ltx_Math" display="inline" id="S4.F7.2.m1.1"><semantics id="S4.F7.2.m1.1b"><mrow id="S4.F7.2.m1.1.1" xref="S4.F7.2.m1.1.1.cmml"><mn id="S4.F7.2.m1.1.1.2" xref="S4.F7.2.m1.1.1.2.cmml">256</mn><mo id="S4.F7.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.F7.2.m1.1.1.1.cmml">×</mo><mn id="S4.F7.2.m1.1.1.3" xref="S4.F7.2.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F7.2.m1.1c"><apply id="S4.F7.2.m1.1.1.cmml" xref="S4.F7.2.m1.1.1"><times id="S4.F7.2.m1.1.1.1.cmml" xref="S4.F7.2.m1.1.1.1"></times><cn id="S4.F7.2.m1.1.1.2.cmml" type="integer" xref="S4.F7.2.m1.1.1.2">256</cn><cn id="S4.F7.2.m1.1.1.3.cmml" type="integer" xref="S4.F7.2.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.2.m1.1d">256\times 256</annotation><annotation encoding="application/x-llamapun" id="S4.F7.2.m1.1e">256 × 256</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Robustness</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.F6" title="In 4.1 Experimental Setup ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">6</span></a> exhibits the sensitivity of PSLD to the choice of MG step size; the performance of PSLD significantly deteriorates when a relatively large MG step size is used, leading to poor results across all tasks. In contrast, DiffStateGrad-PSLD shows superior robustness, maintaining high performance over a wide range of MG step sizes. <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.F7" title="In 4.1 Experimental Setup ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">7</span></a> demonstrates the robustness of DiffStateGrad methods compared to their non-DiffStateGrad counterparts when faced with increasing measurement noise. For both inpainting and Gaussian deblur tasks, the performance of DAPS and PSLD deteriorates significantly as noise levels rise. In contrast, DiffStateGrad-DAPS and DiffStateGrad-PSLD exhibit superior resilience across the range of noise levels tested.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span><span class="ltx_text ltx_font_bold" id="S4.T2.2.1">Performance comparison for inpainting tasks on FFHQ 256 <math alttext="\times" class="ltx_Math" display="inline" id="S4.T2.2.1.m1.1"><semantics id="S4.T2.2.1.m1.1b"><mo id="S4.T2.2.1.m1.1.1" xref="S4.T2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.1.m1.1c"><times id="S4.T2.2.1.m1.1.1.cmml" xref="S4.T2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.1.m1.1e">×</annotation></semantics></math> 256.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.8" style="width:397.5pt;height:141.1pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-56.2pt,19.9pt) scale(0.779444169764447,0.779444169764447) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.8.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.8.6.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T2.8.6.7.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Method</th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.8.6.7.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Inpaint (Box)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.8.6.7.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Inpaint (Random)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.6.6">
<th class="ltx_td ltx_th ltx_th_row" id="S4.T2.8.6.6.7" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.3.1.1.1.m1.1"><semantics id="S4.T2.3.1.1.1.m1.1a"><mo id="S4.T2.3.1.1.1.m1.1.1" stretchy="false" xref="S4.T2.3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.1.1.1.m1.1b"><ci id="S4.T2.3.1.1.1.m1.1.1.cmml" xref="S4.T2.3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.4.2.2.2.m1.1"><semantics id="S4.T2.4.2.2.2.m1.1a"><mo id="S4.T2.4.2.2.2.m1.1.1" stretchy="false" xref="S4.T2.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.2.2.2.m1.1b"><ci id="S4.T2.4.2.2.2.m1.1.1.cmml" xref="S4.T2.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.5.3.3.3.m1.1"><semantics id="S4.T2.5.3.3.3.m1.1a"><mo id="S4.T2.5.3.3.3.m1.1.1" stretchy="false" xref="S4.T2.5.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.3.3.3.m1.1b"><ci id="S4.T2.5.3.3.3.m1.1.1.cmml" xref="S4.T2.5.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.6.4.4.4.m1.1"><semantics id="S4.T2.6.4.4.4.m1.1a"><mo id="S4.T2.6.4.4.4.m1.1.1" stretchy="false" xref="S4.T2.6.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.4.4.4.m1.1b"><ci id="S4.T2.6.4.4.4.m1.1.1.cmml" xref="S4.T2.6.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.4.4.4.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.7.5.5.5.m1.1"><semantics id="S4.T2.7.5.5.5.m1.1a"><mo id="S4.T2.7.5.5.5.m1.1.1" stretchy="false" xref="S4.T2.7.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.5.5.5.m1.1b"><ci id="S4.T2.7.5.5.5.m1.1.1.cmml" xref="S4.T2.7.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.5.5.5.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.8.6.6.6.m1.1"><semantics id="S4.T2.8.6.6.6.m1.1a"><mo id="S4.T2.8.6.6.6.m1.1.1" stretchy="false" xref="S4.T2.8.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.8.6.6.6.m1.1b"><ci id="S4.T2.8.6.6.6.m1.1.1.cmml" xref="S4.T2.8.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.6.8.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T2.8.6.8.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="S4.T2.8.6.8.2.1.1">Pixel-based</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.8.6.9.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.8.6.9.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">DAPS</th>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.9.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.9.3.2.1">0.136</span> (0.027)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.9.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.9.3.3.1">0.806</span> (0.028)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.9.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.9.3.4.1">24.57</span> (2.61)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.9.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.9.3.5.1">0.130</span> (0.022)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.9.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.9.3.6.1">0.829</span> (0.022)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.9.3.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.9.3.7.1">30.79</span> (1.60)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.6.10.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.8.6.10.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-DAPS (ours)</th>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.10.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.10.4.2.1">0.113</span> (0.020)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.10.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.10.4.3.1">0.849</span> (0.029)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.10.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.10.4.4.1">24.78</span> (2.62)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.10.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.10.4.5.1">0.099</span> (0.020)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.10.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.10.4.6.1">0.887</span> (0.023)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.10.4.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.10.4.7.1">32.04</span> (1.79)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.6.11.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T2.8.6.11.5.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="S4.T2.8.6.11.5.1.1">Latent</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.8.6.12.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.8.6.12.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">PSLD</th>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.12.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.158 (0.023)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.12.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.819 (0.031)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.12.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.12.6.4.1">24.22</span> (2.80)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.12.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.246 (0.053)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.12.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.809 (0.049)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.12.6.7" style="padding-left:3.0pt;padding-right:3.0pt;">29.05 (1.98)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.6.13.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.8.6.13.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-PSLD (ours)</th>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.13.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.13.7.2.1">0.092</span> (0.019)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.13.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.13.7.3.1">0.880</span> (0.028)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.13.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.13.7.4.1">24.32</span> (2.78)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.13.7.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.165 (0.035)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.13.7.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.13.7.6.1">0.898</span> (0.024)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.13.7.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.13.7.7.1">31.68</span> (1.74)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.6.14.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.8.6.14.8.1" style="padding-left:3.0pt;padding-right:3.0pt;">ReSample</th>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.14.8.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.198 (0.032)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.14.8.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.807 (0.036)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.14.8.4" style="padding-left:3.0pt;padding-right:3.0pt;">19.91 (1.78)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.14.8.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.14.8.5.1">0.115</span> (0.028)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.14.8.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.892 (0.030)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.8.6.14.8.7" style="padding-left:3.0pt;padding-right:3.0pt;">31.27 (2.35)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.6.15.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T2.8.6.15.9.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-ReSample (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.8.6.15.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.15.9.2.1">0.156</span> (0.027)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.8.6.15.9.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.8.6.15.9.3.1">0.841</span> (0.032)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.8.6.15.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">23.59 (2.38)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.8.6.15.9.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.15.9.5.1">0.106</span> (0.023)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.8.6.15.9.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.15.9.6.1">0.913</span> (0.023)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.8.6.15.9.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T2.8.6.15.9.7.1">31.91</span> (1.84)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span><span class="ltx_text ltx_font_bold" id="S4.T3.2.1">Performance comparison for deblurring and super-resolution tasks on FFHQ 256 <math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.2.1.m1.1"><semantics id="S4.T3.2.1.m1.1b"><mo id="S4.T3.2.1.m1.1.1" xref="S4.T3.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.1.m1.1c"><times id="S4.T3.2.1.m1.1.1.cmml" xref="S4.T3.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.1.m1.1e">×</annotation></semantics></math> 256.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.8" style="width:397.5pt;height:142.5pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-53.7pt,19.2pt) scale(0.787162081002744,0.787162081002744) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.8.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.8.6.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T3.8.6.7.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Method</th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T3.8.6.7.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Gaussian deblur</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T3.8.6.7.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Motion deblur</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T3.8.6.7.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">SR (x4)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.6.6">
<th class="ltx_td ltx_th ltx_th_row" id="S4.T3.8.6.6.7" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.3.1.1.1.m1.1"><semantics id="S4.T3.3.1.1.1.m1.1a"><mo id="S4.T3.3.1.1.1.m1.1.1" stretchy="false" xref="S4.T3.3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.1.1.1.m1.1b"><ci id="S4.T3.3.1.1.1.m1.1.1.cmml" xref="S4.T3.3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.4.2.2.2.m1.1"><semantics id="S4.T3.4.2.2.2.m1.1a"><mo id="S4.T3.4.2.2.2.m1.1.1" stretchy="false" xref="S4.T3.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.2.2.2.m1.1b"><ci id="S4.T3.4.2.2.2.m1.1.1.cmml" xref="S4.T3.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.5.3.3.3.m1.1"><semantics id="S4.T3.5.3.3.3.m1.1a"><mo id="S4.T3.5.3.3.3.m1.1.1" stretchy="false" xref="S4.T3.5.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.3.3.3.m1.1b"><ci id="S4.T3.5.3.3.3.m1.1.1.cmml" xref="S4.T3.5.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.6.4.4.4.m1.1"><semantics id="S4.T3.6.4.4.4.m1.1a"><mo id="S4.T3.6.4.4.4.m1.1.1" stretchy="false" xref="S4.T3.6.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.4.4.4.m1.1b"><ci id="S4.T3.6.4.4.4.m1.1.1.cmml" xref="S4.T3.6.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.7.5.5.5.m1.1"><semantics id="S4.T3.7.5.5.5.m1.1a"><mo id="S4.T3.7.5.5.5.m1.1.1" stretchy="false" xref="S4.T3.7.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.7.5.5.5.m1.1b"><ci id="S4.T3.7.5.5.5.m1.1.1.cmml" xref="S4.T3.7.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.8.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.8.6.6.6.m1.1"><semantics id="S4.T3.8.6.6.6.m1.1a"><mo id="S4.T3.8.6.6.6.m1.1.1" stretchy="false" xref="S4.T3.8.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.8.6.6.6.m1.1b"><ci id="S4.T3.8.6.6.6.m1.1.1.cmml" xref="S4.T3.8.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.6.8.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T3.8.6.8.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="S4.T3.8.6.8.2.1.1">Pixel-based</span></th>
</tr>
<tr class="ltx_tr" id="S4.T3.8.6.9.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.8.6.9.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">DAPS</th>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.9.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.9.3.2.1">0.216</span> (0.045)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.9.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.9.3.3.1">27.92</span> (1.90)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.9.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.9.3.4.1">0.154</span> (0.030)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.9.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.9.3.5.1">30.13</span> (1.70)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.9.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.9.3.6.1">0.197</span> (0.032)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.9.3.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.9.3.7.1">28.64</span> (1.69)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.6.10.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.8.6.10.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-DAPS (ours)</th>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.10.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.10.4.2.1">0.180</span> (0.031)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.10.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.10.4.3.1">29.02</span> (1.86)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.10.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.10.4.4.1">0.119</span> (0.023)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.10.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.10.4.5.1">31.74</span> (1.57)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.10.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.10.4.6.1">0.181</span> (0.028)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.10.4.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.10.4.7.1">29.35</span> (1.70)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.6.11.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T3.8.6.11.5.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="S4.T3.8.6.11.5.1.1">Latent</span></th>
</tr>
<tr class="ltx_tr" id="S4.T3.8.6.12.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.8.6.12.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">PSLD</th>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.12.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.357 (0.060)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.12.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">22.87 (1.67)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.12.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.322 (0.048)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.12.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">24.25 (1.47)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.12.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.313 (0.098)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.12.6.7" style="padding-left:3.0pt;padding-right:3.0pt;">24.51 (2.98)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.6.13.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.8.6.13.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-PSLD (ours)</th>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.13.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.355 (0.043)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.13.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">22.95 (1.32)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.13.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.319 (0.039)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.13.7.5" style="padding-left:3.0pt;padding-right:3.0pt;">24.31 (1.18)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.13.7.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.320 (0.079)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.13.7.7" style="padding-left:3.0pt;padding-right:3.0pt;">24.56 (2.46)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.6.14.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.8.6.14.8.1" style="padding-left:3.0pt;padding-right:3.0pt;">ReSample</th>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.14.8.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.14.8.2.1">0.253</span> (0.039)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.14.8.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.14.8.3.1">27.78</span> (1.79)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.14.8.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.14.8.4.1">0.160</span> (0.028)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.14.8.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.14.8.5.1">30.55</span> (1.75)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.14.8.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.14.8.6.1">0.204</span> (0.038)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.6.14.8.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.8.6.14.8.7.1">28.02</span> (2.05)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.6.15.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T3.8.6.15.9.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-ReSample (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.8.6.15.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.15.9.2.1">0.245</span> (0.030)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.8.6.15.9.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.15.9.3.1">28.04</span> (1.66)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.8.6.15.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.15.9.4.1">0.153</span> (0.024)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.8.6.15.9.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.15.9.5.1">30.82</span> (1.71)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.8.6.15.9.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.15.9.6.1">0.200</span> (0.031)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.8.6.15.9.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.6.15.9.7.1">28.27</span> (1.84)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Performance</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We provide quantitative results in <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.T2" title="In 4.2 Robustness ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Tables</span> <span class="ltx_text ltx_ref_tag">2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.T3" title="Table 3 ‣ 4.2 Robustness ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.T4" title="Table 4 ‣ 4.3 Performance ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.T5" title="Table 5 ‣ 4.3 Performance ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">5</span></a>, and qualitative results in <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S5.F9" title="In 5 Conclusion ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">9</span></a>. These results demonstrate the substantial improvement in the performance of DiffStateGrad-PSLD, DiffStateGrad-ReSample, and DiffStateGrad-DAPS against their respective SOTA counterparts across a wide variety of linear and nonlinear tasks on both FFHQ and ImageNet. For example, DiffStateGrad significantly improves performance and increases reconstruction consistency in both pixel-based and latent solvers for phase retrieval (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.T4" title="In 4.3 Performance ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a>). We additionally show that DiffStateGrad does not impact the diversity of the posterior sampling (see <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A2.F15" title="In Appendix B Visualizations ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">15</span></a>). Finally, we note that DiffStateGrad is robust to the choice of subspace rank (<a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A1.F10" title="In Appendix A Additional Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figures</span> <span class="ltx_text ltx_ref_tag">10</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.F8" title="Figure 8 ‣ 4.3 Performance ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">8</span></a>). We refer the reader to <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A2" title="Appendix B Visualizations ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">B</span></a> for the extensive qualitative performance of DiffStateGrad.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span><span class="ltx_text ltx_font_bold" id="S4.T4.2.1">Performance comparison for nonlinear tasks on FFHQ 256 <math alttext="\times" class="ltx_Math" display="inline" id="S4.T4.2.1.m1.1"><semantics id="S4.T4.2.1.m1.1b"><mo id="S4.T4.2.1.m1.1.1" xref="S4.T4.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.1.m1.1c"><times id="S4.T4.2.1.m1.1.1.cmml" xref="S4.T4.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.1.m1.1e">×</annotation></semantics></math> 256.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.8" style="width:397.5pt;height:113.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-53.7pt,15.3pt) scale(0.787162081002744,0.787162081002744) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.8.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.8.6.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T4.8.6.7.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Method</th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T4.8.6.7.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Phase retrieval</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T4.8.6.7.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Nonlinear deblur</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T4.8.6.7.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">High dynamic range</td>
</tr>
<tr class="ltx_tr" id="S4.T4.8.6.6">
<th class="ltx_td ltx_th ltx_th_row" id="S4.T4.8.6.6.7" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T4.3.1.1.1.m1.1"><semantics id="S4.T4.3.1.1.1.m1.1a"><mo id="S4.T4.3.1.1.1.m1.1.1" stretchy="false" xref="S4.T4.3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.3.1.1.1.m1.1b"><ci id="S4.T4.3.1.1.1.m1.1.1.cmml" xref="S4.T4.3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.4.2.2.2.m1.1"><semantics id="S4.T4.4.2.2.2.m1.1a"><mo id="S4.T4.4.2.2.2.m1.1.1" stretchy="false" xref="S4.T4.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.4.2.2.2.m1.1b"><ci id="S4.T4.4.2.2.2.m1.1.1.cmml" xref="S4.T4.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.5.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T4.5.3.3.3.m1.1"><semantics id="S4.T4.5.3.3.3.m1.1a"><mo id="S4.T4.5.3.3.3.m1.1.1" stretchy="false" xref="S4.T4.5.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.5.3.3.3.m1.1b"><ci id="S4.T4.5.3.3.3.m1.1.1.cmml" xref="S4.T4.5.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.5.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.6.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.6.4.4.4.m1.1"><semantics id="S4.T4.6.4.4.4.m1.1a"><mo id="S4.T4.6.4.4.4.m1.1.1" stretchy="false" xref="S4.T4.6.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.6.4.4.4.m1.1b"><ci id="S4.T4.6.4.4.4.m1.1.1.cmml" xref="S4.T4.6.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.6.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.7.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T4.7.5.5.5.m1.1"><semantics id="S4.T4.7.5.5.5.m1.1a"><mo id="S4.T4.7.5.5.5.m1.1.1" stretchy="false" xref="S4.T4.7.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T4.7.5.5.5.m1.1b"><ci id="S4.T4.7.5.5.5.m1.1.1.cmml" xref="S4.T4.7.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.7.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.8.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.8.6.6.6.m1.1"><semantics id="S4.T4.8.6.6.6.m1.1a"><mo id="S4.T4.8.6.6.6.m1.1.1" stretchy="false" xref="S4.T4.8.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.8.6.6.6.m1.1b"><ci id="S4.T4.8.6.6.6.m1.1.1.cmml" xref="S4.T4.8.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.8.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.8.6.8.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T4.8.6.8.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="S4.T4.8.6.8.2.1.1">Pixel-based</span></th>
</tr>
<tr class="ltx_tr" id="S4.T4.8.6.9.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.8.6.9.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">DAPS</th>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.9.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.9.3.2.1">0.139</span> (0.026)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.9.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.9.3.3.1">30.52</span> (2.61)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.9.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.9.3.4.1">0.184</span> (0.032)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.9.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.9.3.5.1">27.80</span> (1.97)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.9.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.9.3.6.1">0.170</span> (0.075)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.9.3.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.9.3.7.1">26.91</span> (3.94)</td>
</tr>
<tr class="ltx_tr" id="S4.T4.8.6.10.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.8.6.10.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-DAPS (ours)</th>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.10.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.10.4.2.1">0.105</span> (0.023)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.10.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.10.4.3.1">32.25</span> (1.34)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.10.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.10.4.4.1">0.145</span> (0.027)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.10.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.10.4.5.1">29.51</span> (2.16)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.10.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.10.4.6.1">0.143</span> (0.070)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.10.4.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.10.4.7.1">27.76</span> (3.18)</td>
</tr>
<tr class="ltx_tr" id="S4.T4.8.6.11.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T4.8.6.11.5.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="S4.T4.8.6.11.5.1.1">Latent</span></th>
</tr>
<tr class="ltx_tr" id="S4.T4.8.6.12.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.8.6.12.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">ReSample</th>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.12.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.12.6.2.1">0.237</span> (0.189)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.12.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.12.6.3.1">27.61</span> (8.07)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.12.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.12.6.4.1">0.188</span> (0.037)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.12.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.12.6.5.1">29.54</span> (1.89)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.12.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.12.6.6.1">0.190</span> (0.067)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.6.12.6.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.8.6.12.6.7.1">24.88</span> (3.46)</td>
</tr>
<tr class="ltx_tr" id="S4.T4.8.6.13.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T4.8.6.13.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-ReSample (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.8.6.13.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.13.7.2.1">0.154</span> (0.104)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.8.6.13.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.13.7.3.1">31.19</span> (4.33)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.8.6.13.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.13.7.4.1">0.185</span> (0.035)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.8.6.13.7.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.13.7.5.1">29.91</span> (1.60)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.8.6.13.7.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.13.7.6.1">0.164</span> (0.041)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.8.6.13.7.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T4.8.6.13.7.7.1">25.50</span> (3.07)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span><span class="ltx_text ltx_font_bold" id="S4.T5.2.1">Performance comparison for linear tasks on ImageNet 256 <math alttext="\times" class="ltx_Math" display="inline" id="S4.T5.2.1.m1.1"><semantics id="S4.T5.2.1.m1.1b"><mo id="S4.T5.2.1.m1.1.1" xref="S4.T5.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T5.2.1.m1.1c"><times id="S4.T5.2.1.m1.1.1.cmml" xref="S4.T5.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T5.2.1.m1.1e">×</annotation></semantics></math> 256.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T5.8" style="width:397.5pt;height:59.5pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-45.1pt,6.7pt) scale(0.814957163214644,0.814957163214644) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.8.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.8.6.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T5.8.6.7.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T5.8.6.7.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Gaussian deblur</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T5.8.6.7.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Motion deblur</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T5.8.6.7.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">SR (x4)</th>
</tr>
<tr class="ltx_tr" id="S4.T5.8.6.6">
<th class="ltx_td ltx_th ltx_th_row" id="S4.T5.8.6.6.7" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.3.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.3.1.1.1.m1.1"><semantics id="S4.T5.3.1.1.1.m1.1a"><mo id="S4.T5.3.1.1.1.m1.1.1" stretchy="false" xref="S4.T5.3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.3.1.1.1.m1.1b"><ci id="S4.T5.3.1.1.1.m1.1.1.cmml" xref="S4.T5.3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.3.1.1.1.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.4.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.4.2.2.2.m1.1"><semantics id="S4.T5.4.2.2.2.m1.1a"><mo id="S4.T5.4.2.2.2.m1.1.1" stretchy="false" xref="S4.T5.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.4.2.2.2.m1.1b"><ci id="S4.T5.4.2.2.2.m1.1.1.cmml" xref="S4.T5.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.5.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.5.3.3.3.m1.1"><semantics id="S4.T5.5.3.3.3.m1.1a"><mo id="S4.T5.5.3.3.3.m1.1.1" stretchy="false" xref="S4.T5.5.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.5.3.3.3.m1.1b"><ci id="S4.T5.5.3.3.3.m1.1.1.cmml" xref="S4.T5.5.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.5.3.3.3.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.6.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.6.4.4.4.m1.1"><semantics id="S4.T5.6.4.4.4.m1.1a"><mo id="S4.T5.6.4.4.4.m1.1.1" stretchy="false" xref="S4.T5.6.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.6.4.4.4.m1.1b"><ci id="S4.T5.6.4.4.4.m1.1.1.cmml" xref="S4.T5.6.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.6.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.6.4.4.4.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.7.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.7.5.5.5.m1.1"><semantics id="S4.T5.7.5.5.5.m1.1a"><mo id="S4.T5.7.5.5.5.m1.1.1" stretchy="false" xref="S4.T5.7.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.7.5.5.5.m1.1b"><ci id="S4.T5.7.5.5.5.m1.1.1.cmml" xref="S4.T5.7.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.7.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.7.5.5.5.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.8.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.8.6.6.6.m1.1"><semantics id="S4.T5.8.6.6.6.m1.1a"><mo id="S4.T5.8.6.6.6.m1.1.1" stretchy="false" xref="S4.T5.8.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.8.6.6.6.m1.1b"><ci id="S4.T5.8.6.6.6.m1.1.1.cmml" xref="S4.T5.8.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.8.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.8.6.6.6.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.8.6.8.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.8.6.8.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">PSLD</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.8.6.8.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.8.6.8.1.2.1">0.466</span> (0.085)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.8.6.8.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.8.6.8.1.3.1">20.70</span> (3.01)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.8.6.8.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.8.6.8.1.4.1">0.435</span> (0.102)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.8.6.8.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.8.6.8.1.5.1">21.26</span> (3.44)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.8.6.8.1.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.8.6.8.1.6.1">0.416</span> (0.063)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.8.6.8.1.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.8.6.8.1.7.1">22.29</span> (3.08)</td>
</tr>
<tr class="ltx_tr" id="S4.T5.8.6.9.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T5.8.6.9.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-PSLD (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.8.6.9.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T5.8.6.9.2.2.1">0.446</span> (0.076)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.8.6.9.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T5.8.6.9.2.3.1">22.34</span> (3.19)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.8.6.9.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T5.8.6.9.2.4.1">0.399</span> (0.060)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.8.6.9.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T5.8.6.9.2.5.1">23.80</span> (3.27)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.8.6.9.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T5.8.6.9.2.6.1">0.370</span> (0.081)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.8.6.9.2.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T5.8.6.9.2.7.1">23.53</span> (3.52)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S4.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="340" id="S4.F8.sf1.g1" src="extracted/5900490/figures/tau/psnr_vs_tau_plot.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>PSNR</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="340" id="S4.F8.sf2.g1" src="extracted/5900490/figures/tau/ssim_vs_tau_plot.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>SSIM</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="340" id="S4.F8.sf3.g1" src="extracted/5900490/figures/tau/lpips_vs_tau_plot.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>LPIPS</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span class="ltx_text ltx_font_bold" id="S4.F8.6.1">Performance of DiffStateGrad-DAPS for different variance retention thresholds <math alttext="\tau" class="ltx_Math" display="inline" id="S4.F8.6.1.m1.1"><semantics id="S4.F8.6.1.m1.1b"><mi id="S4.F8.6.1.m1.1.1" xref="S4.F8.6.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.F8.6.1.m1.1c"><ci id="S4.F8.6.1.m1.1.1.cmml" xref="S4.F8.6.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F8.6.1.m1.1d">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.F8.6.1.m1.1e">italic_τ</annotation></semantics></math></span>. DiffStateGrad is robust to the choice of <math alttext="\tau" class="ltx_Math" display="inline" id="S4.F8.7.m1.1"><semantics id="S4.F8.7.m1.1b"><mi id="S4.F8.7.m1.1.1" xref="S4.F8.7.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.F8.7.m1.1c"><ci id="S4.F8.7.m1.1.1.cmml" xref="S4.F8.7.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F8.7.m1.1d">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.F8.7.m1.1e">italic_τ</annotation></semantics></math>, as values <math alttext="\geq 0.6" class="ltx_Math" display="inline" id="S4.F8.8.m2.1"><semantics id="S4.F8.8.m2.1b"><mrow id="S4.F8.8.m2.1.1" xref="S4.F8.8.m2.1.1.cmml"><mi id="S4.F8.8.m2.1.1.2" xref="S4.F8.8.m2.1.1.2.cmml"></mi><mo id="S4.F8.8.m2.1.1.1" xref="S4.F8.8.m2.1.1.1.cmml">≥</mo><mn id="S4.F8.8.m2.1.1.3" xref="S4.F8.8.m2.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F8.8.m2.1c"><apply id="S4.F8.8.m2.1.1.cmml" xref="S4.F8.8.m2.1.1"><geq id="S4.F8.8.m2.1.1.1.cmml" xref="S4.F8.8.m2.1.1.1"></geq><csymbol cd="latexml" id="S4.F8.8.m2.1.1.2.cmml" xref="S4.F8.8.m2.1.1.2">absent</csymbol><cn id="S4.F8.8.m2.1.1.3.cmml" type="float" xref="S4.F8.8.m2.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F8.8.m2.1d">\geq 0.6</annotation><annotation encoding="application/x-llamapun" id="S4.F8.8.m2.1e">≥ 0.6</annotation></semantics></math> show similar performance in this figure. In our main experiments, we use <math alttext="\tau=0.99" class="ltx_Math" display="inline" id="S4.F8.9.m3.1"><semantics id="S4.F8.9.m3.1b"><mrow id="S4.F8.9.m3.1.1" xref="S4.F8.9.m3.1.1.cmml"><mi id="S4.F8.9.m3.1.1.2" xref="S4.F8.9.m3.1.1.2.cmml">τ</mi><mo id="S4.F8.9.m3.1.1.1" xref="S4.F8.9.m3.1.1.1.cmml">=</mo><mn id="S4.F8.9.m3.1.1.3" xref="S4.F8.9.m3.1.1.3.cmml">0.99</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F8.9.m3.1c"><apply id="S4.F8.9.m3.1.1.cmml" xref="S4.F8.9.m3.1.1"><eq id="S4.F8.9.m3.1.1.1.cmml" xref="S4.F8.9.m3.1.1.1"></eq><ci id="S4.F8.9.m3.1.1.2.cmml" xref="S4.F8.9.m3.1.1.2">𝜏</ci><cn id="S4.F8.9.m3.1.1.3.cmml" type="float" xref="S4.F8.9.m3.1.1.3">0.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F8.9.m3.1d">\tau=0.99</annotation><annotation encoding="application/x-llamapun" id="S4.F8.9.m3.1e">italic_τ = 0.99</annotation></semantics></math> (see <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS1" title="C.1 Hyperparameters ‣ Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">C.1</span></a> for further details). We evaluate images from FFHQ <math alttext="256\times 256" class="ltx_Math" display="inline" id="S4.F8.10.m4.1"><semantics id="S4.F8.10.m4.1b"><mrow id="S4.F8.10.m4.1.1" xref="S4.F8.10.m4.1.1.cmml"><mn id="S4.F8.10.m4.1.1.2" xref="S4.F8.10.m4.1.1.2.cmml">256</mn><mo id="S4.F8.10.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.F8.10.m4.1.1.1.cmml">×</mo><mn id="S4.F8.10.m4.1.1.3" xref="S4.F8.10.m4.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F8.10.m4.1c"><apply id="S4.F8.10.m4.1.1.cmml" xref="S4.F8.10.m4.1.1"><times id="S4.F8.10.m4.1.1.1.cmml" xref="S4.F8.10.m4.1.1.1"></times><cn id="S4.F8.10.m4.1.1.2.cmml" type="integer" xref="S4.F8.10.m4.1.1.2">256</cn><cn id="S4.F8.10.m4.1.1.3.cmml" type="integer" xref="S4.F8.10.m4.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F8.10.m4.1d">256\times 256</annotation><annotation encoding="application/x-llamapun" id="S4.F8.10.m4.1e">256 × 256</annotation></semantics></math> on box inpainting.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We introduce a <span class="ltx_text ltx_font_italic" id="S5.p1.1.1">Diffusion State-Guided Projected Gradient</span> (DiffStateGrad) to enhance the performance and robustness of diffusion models in solving inverse problems. DiffStateGrad addresses the introduction of artifacts and deviations from the data manifold by constraining gradient updates to a subspace approximating the manifold. DiffStateGrad is versatile, applicable across various diffusion models and sampling algorithms, and includes an adaptive rank that dynamically adjusts to the gradient’s complexity. Overall, DiffStateGrad reduces the need for excessive tuning of hyperparameters and significantly boosts performance for more challenging inverse problems.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">We note that DiffStateGrad assumes that the learned prior is a relatively good prior for the task at hand. Since DiffStateGrad encourages the process to stay close to the manifold structure captured by the generative prior, it may introduce the prior’s biases into image restoration tasks. Hence, DiffStateGrad may not be recommended for certain inverse problems such as black hole imaging <cite class="ltx_cite ltx_citemacro_citep">(Feng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib9" title="">2024</a>)</cite>.</p>
</div>
<figure class="ltx_figure" id="S5.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S5.F9.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="S5.F9.sf1.g1" src="extracted/5900490/figures/rec_examples_good_fixed_title/chosen-images-updated_task_chosen-bip-images_id_60012.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="S5.F9.sf1.g2" src="extracted/5900490/figures/rec_examples_good_fixed_title/chosen-images-updated_task_chosen-bip-images_id_60027_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Box inpainting.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S5.F9.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="S5.F9.sf2.g1" src="extracted/5900490/figures/rec_examples_good_fixed_title/chosen-images-updated_task_chosen-rip-images_id_60037.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="S5.F9.sf2.g2" src="extracted/5900490/figures/rec_examples_good_fixed_title/chosen-images-updated_task_chosen-rip-images_id_60097_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Random inpainting.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S5.F9.sf3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="S5.F9.sf3.g1" src="extracted/5900490/figures/rec_examples_good_fixed_title/chosen-images-updated_task_chosen-gb-images_id_60096.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="S5.F9.sf3.g2" src="extracted/5900490/figures/rec_examples_best_fixed_title/best_performing_task_chosen-gb-images_id_60031_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Gaussian deblur.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S5.F9.sf4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="S5.F9.sf4.g1" src="extracted/5900490/figures/rec_examples_good_fixed_title/chosen-images-updated_task_chosen-sr-images_id_60014.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="S5.F9.sf4.g2" src="extracted/5900490/figures/rec_examples_good_fixed_title/chosen-images-updated_task_chosen-sr-images_id_60032_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>Super-resolution (<math alttext="\times 4" class="ltx_Math" display="inline" id="S5.F9.sf4.2.m1.1"><semantics id="S5.F9.sf4.2.m1.1b"><mrow id="S5.F9.sf4.2.m1.1.1" xref="S5.F9.sf4.2.m1.1.1.cmml"><mi id="S5.F9.sf4.2.m1.1.1.2" xref="S5.F9.sf4.2.m1.1.1.2.cmml"></mi><mo id="S5.F9.sf4.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.F9.sf4.2.m1.1.1.1.cmml">×</mo><mn id="S5.F9.sf4.2.m1.1.1.3" xref="S5.F9.sf4.2.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F9.sf4.2.m1.1c"><apply id="S5.F9.sf4.2.m1.1.1.cmml" xref="S5.F9.sf4.2.m1.1.1"><times id="S5.F9.sf4.2.m1.1.1.1.cmml" xref="S5.F9.sf4.2.m1.1.1.1"></times><csymbol cd="latexml" id="S5.F9.sf4.2.m1.1.1.2.cmml" xref="S5.F9.sf4.2.m1.1.1.2">absent</csymbol><cn id="S5.F9.sf4.2.m1.1.1.3.cmml" type="integer" xref="S5.F9.sf4.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F9.sf4.2.m1.1d">\times 4</annotation><annotation encoding="application/x-llamapun" id="S5.F9.sf4.2.m1.1e">× 4</annotation></semantics></math>).</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span class="ltx_text ltx_font_bold" id="S5.F9.2.1">Qualitative comparison of DiffStateGrad-PSLD and PSLD for their best-performing MG step size</span>. DiffStateGrad-PSLD can remove artifacts and reduce failure cases, producing more reliable reconstructions. Images are chosen at random for visualization.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Reproducibility Statement</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">To ensure the reproducibility of our results, we thoroughly detail the hyperparameters used in our experiments in <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS1" title="C.1 Hyperparameters ‣ Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">C.1</span></a>. We also provide specific implementation and configuration details of all the baselines used in <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS3" title="C.3 PSLD ‣ Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Sections</span> <span class="ltx_text ltx_ref_tag">C.3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS4" title="C.4 ReSample ‣ Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">C.4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A3.SS5" title="C.5 DAPS ‣ Appendix C Implementation Details ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">C.5</span></a>. Moreover, we use easily accessible pre-trained diffusion models throughout our experiments. PSLD (<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/LituRout/PSLD" title="">https://github.com/LituRout/PSLD</a>), ReSample (<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/soominkwon/resample" title="">https://github.com/soominkwon/resample</a>), and DAPS (<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/zhangbingliang2019/DAPS" title="">https://github.com/zhangbingliang2019/DAPS</a>) all have publicly available code. We will make the anonymous GitHub repository with our code available to the reviewers after the discussion forum opens.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bora et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Bora, Ajil Jalal, Eric Price, and Alexandros G Dimakis.

</span>
<span class="ltx_bibblock">Compressed Sensing using Generative Models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">International conference on machine learning</em>, pp. 537–546. PMLR, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Candès et al. (2006)</span>
<span class="ltx_bibblock">
Emmanuel J Candès, Justin Romberg, and Terence Tao.

</span>
<span class="ltx_bibblock">Robust Uncertainty Principles: Exact Signal Reconstruction from
Highly Incomplete Frequency Information.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">IEEE Transactions on information theory</em>, 52(2):489–509, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et al. (2022)</span>
<span class="ltx_bibblock">
Hyungjin Chung, Byeongsu Sim, Dohoon Ryu, and Jong Chul Ye.

</span>
<span class="ltx_bibblock">Improving Diffusion Models for Inverse Problems using Manifold
Constraints.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances in Neural Information Processing Systems</em>,
35:25683–25696, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et al. (2023)</span>
<span class="ltx_bibblock">
Hyungjin Chung, Jeongsol Kim, Michael Thompson Mccann, Marc Louis Klasky, and
Jong Chul Ye.

</span>
<span class="ltx_bibblock">Diffusion Posterior Sampling for General Noisy Inverse Problems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">The Eleventh International Conference on Learning
Representations</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=OnD9zGAGT0k" title="">https://openreview.net/forum?id=OnD9zGAGT0k</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et al. (2024)</span>
<span class="ltx_bibblock">
Hyungjin Chung, Jeongsol Kim, and Jong Chul Ye.

</span>
<span class="ltx_bibblock">Direct diffusion bridge using data consistency for inverse problems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2009)</span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">ImageNet: A Large-Scale Hierarchical Image Database.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">2009 IEEE Conference on Computer Vision and Pattern
Recognition</em>, pp.  248–255. IEEE, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dhariwal &amp; Nichol (2021)</span>
<span class="ltx_bibblock">
Prafulla Dhariwal and Alexander Quinn Nichol.

</span>
<span class="ltx_bibblock">Diffusion Models Beat GANs on Image Synthesis.

</span>
<span class="ltx_bibblock">In A. Beygelzimer, Y. Dauphin, P. Liang, and J. Wortman Vaughan
(eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Advances in Neural Information Processing Systems</em>. Curran
Associates, Inc., 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Donoho (2006)</span>
<span class="ltx_bibblock">
David L Donoho.

</span>
<span class="ltx_bibblock">Compressed Sensing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">IEEE Transactions on information theory</em>, 52(4):1289–1306, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al. (2024)</span>
<span class="ltx_bibblock">
Berthy T Feng, Katherine L Bouman, and William T Freeman.

</span>
<span class="ltx_bibblock">Event-horizon-scale imaging of m87* under different assumptions via
deep generative image priors.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2406.02785</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow et al. (2014)</span>
<span class="ltx_bibblock">
Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley,
Sherjil Ozair, Aaron Courville, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Generative Adversarial Nets.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Advances in neural information processing systems</em>, 27, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Groetsch &amp; Groetsch (1993)</span>
<span class="ltx_bibblock">
Charles W Groetsch and CW Groetsch.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Inverse problems in the mathematical sciences</em>, volume 52.

</span>
<span class="ltx_bibblock">Springer, 1993.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2024)</span>
<span class="ltx_bibblock">
Yutong He, Naoki Murata, Chieh-Hsin Lai, Yuhta Takida, Toshimitsu Uesaka,
Dongjun Kim, Wei-Hsiang Liao, Yuki Mitsufuji, J Zico Kolter, Ruslan
Salakhutdinov, et al.

</span>
<span class="ltx_bibblock">Manifold preserving guided diffusion.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">The Twelfth International Conference on Learning
Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kadkhodaie &amp; Simoncelli (2021)</span>
<span class="ltx_bibblock">
Zahra Kadkhodaie and Eero Simoncelli.

</span>
<span class="ltx_bibblock">Stochastic solutions for linear inverse problems using the prior
implicit in a denoiser.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Advances in Neural Information Processing Systems</em>,
34:13242–13254, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karras et al. (2021)</span>
<span class="ltx_bibblock">
Tero Karras, Samuli Laine, and Timo Aila.

</span>
<span class="ltx_bibblock">A Style-Based Generator Architecture for Generative Adversarial
Networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">IEEE Transactions on Pattern Analysis &amp; Machine Intelligence</em>,
43(12):4217–4228, Dec 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kawar et al. (2022)</span>
<span class="ltx_bibblock">
Bahjat Kawar, Michael Elad, Stefano Ermon, and Jiaming Song.

</span>
<span class="ltx_bibblock">Denoising diffusion restoration models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>,
35:23593–23606, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma (2013)</span>
<span class="ltx_bibblock">
Diederik P Kingma.

</span>
<span class="ltx_bibblock">Auto-encoding Variational Bayes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:1312.6114</em>, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Guan-Horng Liu, Arash Vahdat, De-An Huang, Evangelos Theodorou, Weili Nie, and
Anima Anandkumar.

</span>
<span class="ltx_bibblock">I2sb: Image-to-image schrödinger bridge.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">International Conference on Machine Learning</em>, pp. 22042–22062. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lustig et al. (2007)</span>
<span class="ltx_bibblock">
Michael Lustig, David Donoho, and John M Pauly.

</span>
<span class="ltx_bibblock">Sparse mri: The application of compressed sensing for rapid mr
imaging.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Magnetic Resonance in Medicine: An Official Journal of the
International Society for Magnetic Resonance in Medicine</em>, 58(6):1182–1195, 2007.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Olshausen &amp; Field (1997)</span>
<span class="ltx_bibblock">
Bruno A Olshausen and David J Field.

</span>
<span class="ltx_bibblock">Sparse coding with an overcomplete basis set: A strategy employed by
v1?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Vision research</em>, 37(23):3311–3325, 1997.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2024)</span>
<span class="ltx_bibblock">
Xinyu Peng, Ziyang Zheng, Wenrui Dai, Nuoqian Xiao, Chenglin Li, Junni Zou, and
Hongkai Xiong.

</span>
<span class="ltx_bibblock">Improving diffusion models for inverse problems using optimal
posterior covariance.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Forty-first International Conference on Machine Learning</em>,
2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Romano et al. (2017)</span>
<span class="ltx_bibblock">
Yaniv Romano, Michael Elad, and Peyman Milanfar.

</span>
<span class="ltx_bibblock">The little engine that could: Regularization by denoising (red).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">SIAM Journal on Imaging Sciences</em>, 10(4):1804–1844, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rombach et al. (2022)</span>
<span class="ltx_bibblock">
Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn
Ommer.

</span>
<span class="ltx_bibblock">High-resolution Image Synthesis with Latent Diffusion Models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition</em>, pp.  10684–10695, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rout et al. (2023)</span>
<span class="ltx_bibblock">
Litu Rout, Negin Raoof, Giannis Daras, Constantine Caramanis, Alex Dimakis, and
Sanjay Shakkottai.

</span>
<span class="ltx_bibblock">Solving Linear Inverse Problems Provably via Posterior Sampling with
Latent Diffusion Models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Thirty-seventh Conference on Neural Information Processing
Systems</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=XKBFdYwfRo" title="">https://openreview.net/forum?id=XKBFdYwfRo</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rout et al. (2024)</span>
<span class="ltx_bibblock">
Litu Rout, Yujia Chen, Abhishek Kumar, Constantine Caramanis, Sanjay
Shakkottai, and Wen-Sheng Chu.

</span>
<span class="ltx_bibblock">Beyond first-order tweedie: Solving inverse problems using latent
diffusion.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  9472–9481, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saharia et al. (2022)</span>
<span class="ltx_bibblock">
Chitwan Saharia, William Chan, Huiwen Chang, Chris Lee, Jonathan Ho, Tim
Salimans, David Fleet, and Mohammad Norouzi.

</span>
<span class="ltx_bibblock">Palette: Image-to-image diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">ACM SIGGRAPH 2022 conference proceedings</em>, pp.  1–10,
2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shmakov et al. (2024)</span>
<span class="ltx_bibblock">
Alexander Shmakov, Kevin Greif, Michael Fenton, Aishik Ghosh, Pierre Baldi, and
Daniel Whiteson.

</span>
<span class="ltx_bibblock">End-to-end latent variational diffusion models for inverse problems
in high energy physics.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shu et al. (2023)</span>
<span class="ltx_bibblock">
Dule Shu, Zijie Li, and Amir Barati Farimani.

</span>
<span class="ltx_bibblock">A Physics-informed Diffusion Model for High-fidelity Flow Field
Reconstruction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Journal of Computational Physics</em>, 478:111972, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2023a)</span>
<span class="ltx_bibblock">
Bowen Song, Soo Min Kwon, Zecheng Zhang, Xinyu Hu, Qing Qu, and Liyue Shen.

</span>
<span class="ltx_bibblock">Solving Inverse Problems with Latent Diffusion Models via Hard Data
Consistency.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Conference on Parsimony and Learning (Recent Spotlight
Track)</em>, 2023a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=iHcarDCZLn" title="">https://openreview.net/forum?id=iHcarDCZLn</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2023b)</span>
<span class="ltx_bibblock">
Jiaming Song, Arash Vahdat, Morteza Mardani, and Jan Kautz.

</span>
<span class="ltx_bibblock">Pseudoinverse-Guided Diffusion Models for Inverse Problems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">International Conference on Learning Representations</em>,
2023b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=9_gsMA8MRKQ" title="">https://openreview.net/forum?id=9_gsMA8MRKQ</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song &amp; Ermon (2019)</span>
<span class="ltx_bibblock">
Yang Song and Stefano Ermon.

</span>
<span class="ltx_bibblock">Generative Modeling by Estimating Gradients of the Data
Distribution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Advances in Neural Information Processing Systems</em>,
volume 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2021)</span>
<span class="ltx_bibblock">
Yang Song, Jascha Sohl-Dickstein, Diederik Kingma, Abhishek Kumar, Stefano
Ermon, and Ben Poole.

</span>
<span class="ltx_bibblock">Score-based Generative Modeling through Stochastic Differential
Equations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">The International Conference on Learning Representations</em>,
2021.

</span>
<span class="ltx_bibblock">URL
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/pdf/ef0eadbe07115b0853e964f17aa09d811cd490f1.pdf" title="">https://openreview.net/pdf/ef0eadbe07115b0853e964f17aa09d811cd490f1.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stuart (2010)</span>
<span class="ltx_bibblock">
Andrew M Stuart.

</span>
<span class="ltx_bibblock">Inverse problems: a bayesian perspective.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Acta numerica</em>, 19:451–559, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tran et al. (2021)</span>
<span class="ltx_bibblock">
Phong Tran, Anh Tran, Quynh Phung, and Minh Hoai.

</span>
<span class="ltx_bibblock">Explore Image Deblurring via Encoded Blur Kernel Space.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition (CVPR)</em>. IEEE, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ulyanov et al. (2018)</span>
<span class="ltx_bibblock">
Dmitry Ulyanov, Andrea Vedaldi, and Victor Lempitsky.

</span>
<span class="ltx_bibblock">Deep Image Prior.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  9446–9454, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Venkatakrishnan et al. (2013)</span>
<span class="ltx_bibblock">
Singanallur V Venkatakrishnan, Charles A Bouman, and Brendt Wohlberg.

</span>
<span class="ltx_bibblock">Plug-and-play priors for model based reconstruction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">2013 IEEE global conference on signal and information
processing</em>, pp.  945–948. IEEE, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vincent (2011)</span>
<span class="ltx_bibblock">
Pascal Vincent.

</span>
<span class="ltx_bibblock">A Connection Between Score Matching and Denoising Autoencoders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Neural Computation</em>, 23(7):1661–1674,
2011.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1162/NECO_a_00142</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2004)</span>
<span class="ltx_bibblock">
Zhou Wang, Alan C Bovik, Hamid R Sheikh, and Eero P Simoncelli.

</span>
<span class="ltx_bibblock">Image quality assessment: from error visibility to structural
similarity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">IEEE transactions on image processing</em>, 13(4):600–612, 2004.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2024)</span>
<span class="ltx_bibblock">
Zihui Wu, Yu Sun, Yifan Chen, Bingliang Zhang, Yisong Yue, and Katherine L
Bouman.

</span>
<span class="ltx_bibblock">Principled probabilistic imaging using diffusion models as
plug-and-play priors.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2405.18782</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Bingliang Zhang, Wenda Chu, Julius Berner, Chenlin Meng, Anima Anandkumar, and
Yang Song.

</span>
<span class="ltx_bibblock">Improving Diffusion Inverse Problem Solving with Decoupled Noise
Annealing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2407.01521</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2024)</span>
<span class="ltx_bibblock">
Jiawei Zhao, Zhenyu Zhang, Beidi Chen, Zhangyang Wang, Anima Anandkumar, and
Yuandong Tian.

</span>
<span class="ltx_bibblock">Galore: Memory-efficient llm training by gradient low-rank
projection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Forty-first International Conference on Machine Learning</em>,
2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional Results</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">This section provides additional results.</p>
</div>
<figure class="ltx_table" id="A1.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span><span class="ltx_text ltx_font_bold" id="A1.T6.2.1">Performance comparison for inpainting tasks on ImageNet 256 <math alttext="\times" class="ltx_Math" display="inline" id="A1.T6.2.1.m1.1"><semantics id="A1.T6.2.1.m1.1b"><mo id="A1.T6.2.1.m1.1.1" xref="A1.T6.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T6.2.1.m1.1c"><times id="A1.T6.2.1.m1.1.1.cmml" xref="A1.T6.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.2.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A1.T6.2.1.m1.1e">×</annotation></semantics></math> 256.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T6.8" style="width:397.5pt;height:58.9pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-47.6pt,7.0pt) scale(0.806687445580614,0.806687445580614) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T6.8.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T6.8.6.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A1.T6.8.6.7.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="A1.T6.8.6.7.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Inpaint (Box)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="A1.T6.8.6.7.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Inpaint (Random)</th>
</tr>
<tr class="ltx_tr" id="A1.T6.8.6.6">
<th class="ltx_td ltx_th ltx_th_row" id="A1.T6.8.6.6.7" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.3.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T6.3.1.1.1.m1.1"><semantics id="A1.T6.3.1.1.1.m1.1a"><mo id="A1.T6.3.1.1.1.m1.1.1" stretchy="false" xref="A1.T6.3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T6.3.1.1.1.m1.1b"><ci id="A1.T6.3.1.1.1.m1.1.1.cmml" xref="A1.T6.3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.3.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.3.1.1.1.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.4.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T6.4.2.2.2.m1.1"><semantics id="A1.T6.4.2.2.2.m1.1a"><mo id="A1.T6.4.2.2.2.m1.1.1" stretchy="false" xref="A1.T6.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T6.4.2.2.2.m1.1b"><ci id="A1.T6.4.2.2.2.m1.1.1.cmml" xref="A1.T6.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.5.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T6.5.3.3.3.m1.1"><semantics id="A1.T6.5.3.3.3.m1.1a"><mo id="A1.T6.5.3.3.3.m1.1.1" stretchy="false" xref="A1.T6.5.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T6.5.3.3.3.m1.1b"><ci id="A1.T6.5.3.3.3.m1.1.1.cmml" xref="A1.T6.5.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.5.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.5.3.3.3.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.6.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T6.6.4.4.4.m1.1"><semantics id="A1.T6.6.4.4.4.m1.1a"><mo id="A1.T6.6.4.4.4.m1.1.1" stretchy="false" xref="A1.T6.6.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T6.6.4.4.4.m1.1b"><ci id="A1.T6.6.4.4.4.m1.1.1.cmml" xref="A1.T6.6.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.6.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.6.4.4.4.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.7.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T6.7.5.5.5.m1.1"><semantics id="A1.T6.7.5.5.5.m1.1a"><mo id="A1.T6.7.5.5.5.m1.1.1" stretchy="false" xref="A1.T6.7.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T6.7.5.5.5.m1.1b"><ci id="A1.T6.7.5.5.5.m1.1.1.cmml" xref="A1.T6.7.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.7.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.7.5.5.5.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T6.8.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T6.8.6.6.6.m1.1"><semantics id="A1.T6.8.6.6.6.m1.1a"><mo id="A1.T6.8.6.6.6.m1.1.1" stretchy="false" xref="A1.T6.8.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T6.8.6.6.6.m1.1b"><ci id="A1.T6.8.6.6.6.m1.1.1.cmml" xref="A1.T6.8.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.8.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.8.6.6.6.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T6.8.6.8.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T6.8.6.8.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">PSLD</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.8.6.8.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.8.6.8.1.2.1">0.182</span> (0.033)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.8.6.8.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.8.6.8.1.3.1">0.780</span> (0.044)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.8.6.8.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.8.6.8.1.4.1">16.28</span> (3.49)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.8.6.8.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.217 (0.073)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.8.6.8.1.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.8.6.8.1.6.1">0.846</span> (0.070)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.8.6.8.1.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T6.8.6.8.1.7.1">26.56</span> (2.98)</td>
</tr>
<tr class="ltx_tr" id="A1.T6.8.6.9.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A1.T6.8.6.9.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-PSLD (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T6.8.6.9.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T6.8.6.9.2.2.1">0.176</span> (0.030)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T6.8.6.9.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T6.8.6.9.2.3.1">0.803</span> (0.045)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T6.8.6.9.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T6.8.6.9.2.4.1">18.90</span> (3.82)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T6.8.6.9.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T6.8.6.9.2.5.1">0.169</span> (0.050)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T6.8.6.9.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T6.8.6.9.2.6.1">0.878</span> (0.051)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T6.8.6.9.2.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T6.8.6.9.2.7.1">28.48</span> (4.04)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="A1.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span><span class="ltx_text ltx_font_bold" id="A1.T7.2.1">Robustness comparison of PSLD and DiffStateGrad-PSLD on linear tasks under different MG step sizes on FFHQ 256 <math alttext="\times" class="ltx_Math" display="inline" id="A1.T7.2.1.m1.1"><semantics id="A1.T7.2.1.m1.1b"><mo id="A1.T7.2.1.m1.1.1" xref="A1.T7.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T7.2.1.m1.1c"><times id="A1.T7.2.1.m1.1.1.cmml" xref="A1.T7.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.2.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A1.T7.2.1.m1.1e">×</annotation></semantics></math> 256</span>.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T7.12" style="width:397.5pt;height:116.2pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-49.3pt,14.3pt) scale(0.801401802238935,0.801401802238935) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T7.12.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T7.12.10.11.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A1.T7.12.10.11.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">Method</th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="A1.T7.12.10.11.1.2" style="padding-left:2.0pt;padding-right:2.0pt;">Inpaint (Box)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="A1.T7.12.10.11.1.3" style="padding-left:2.0pt;padding-right:2.0pt;">Inpaint (Random)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="A1.T7.12.10.11.1.4" style="padding-left:2.0pt;padding-right:2.0pt;">Gaussian deblur</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="A1.T7.12.10.11.1.5" style="padding-left:2.0pt;padding-right:2.0pt;">Motion deblur</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="A1.T7.12.10.11.1.6" style="padding-left:2.0pt;padding-right:2.0pt;">SR (×4)</td>
</tr>
<tr class="ltx_tr" id="A1.T7.12.10.10">
<th class="ltx_td ltx_th ltx_th_row" id="A1.T7.12.10.10.11" style="padding-left:2.0pt;padding-right:2.0pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.3.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T7.3.1.1.1.m1.1"><semantics id="A1.T7.3.1.1.1.m1.1a"><mo id="A1.T7.3.1.1.1.m1.1.1" stretchy="false" xref="A1.T7.3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T7.3.1.1.1.m1.1b"><ci id="A1.T7.3.1.1.1.m1.1.1.cmml" xref="A1.T7.3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.3.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T7.3.1.1.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.2.2.2" style="padding-left:2.0pt;padding-right:2.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T7.4.2.2.2.m1.1"><semantics id="A1.T7.4.2.2.2.m1.1a"><mo id="A1.T7.4.2.2.2.m1.1.1" stretchy="false" xref="A1.T7.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T7.4.2.2.2.m1.1b"><ci id="A1.T7.4.2.2.2.m1.1.1.cmml" xref="A1.T7.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T7.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.5.3.3.3" style="padding-left:2.0pt;padding-right:2.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T7.5.3.3.3.m1.1"><semantics id="A1.T7.5.3.3.3.m1.1a"><mo id="A1.T7.5.3.3.3.m1.1.1" stretchy="false" xref="A1.T7.5.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T7.5.3.3.3.m1.1b"><ci id="A1.T7.5.3.3.3.m1.1.1.cmml" xref="A1.T7.5.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.5.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T7.5.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.4.4.4" style="padding-left:2.0pt;padding-right:2.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T7.6.4.4.4.m1.1"><semantics id="A1.T7.6.4.4.4.m1.1a"><mo id="A1.T7.6.4.4.4.m1.1.1" stretchy="false" xref="A1.T7.6.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T7.6.4.4.4.m1.1b"><ci id="A1.T7.6.4.4.4.m1.1.1.cmml" xref="A1.T7.6.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.6.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T7.6.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.7.5.5.5" style="padding-left:2.0pt;padding-right:2.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T7.7.5.5.5.m1.1"><semantics id="A1.T7.7.5.5.5.m1.1a"><mo id="A1.T7.7.5.5.5.m1.1.1" stretchy="false" xref="A1.T7.7.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T7.7.5.5.5.m1.1b"><ci id="A1.T7.7.5.5.5.m1.1.1.cmml" xref="A1.T7.7.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.7.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T7.7.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.8.6.6.6" style="padding-left:2.0pt;padding-right:2.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T7.8.6.6.6.m1.1"><semantics id="A1.T7.8.6.6.6.m1.1a"><mo id="A1.T7.8.6.6.6.m1.1.1" stretchy="false" xref="A1.T7.8.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T7.8.6.6.6.m1.1b"><ci id="A1.T7.8.6.6.6.m1.1.1.cmml" xref="A1.T7.8.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.8.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T7.8.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.9.7.7.7" style="padding-left:2.0pt;padding-right:2.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T7.9.7.7.7.m1.1"><semantics id="A1.T7.9.7.7.7.m1.1a"><mo id="A1.T7.9.7.7.7.m1.1.1" stretchy="false" xref="A1.T7.9.7.7.7.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T7.9.7.7.7.m1.1b"><ci id="A1.T7.9.7.7.7.m1.1.1.cmml" xref="A1.T7.9.7.7.7.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.9.7.7.7.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T7.9.7.7.7.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.10.8.8.8" style="padding-left:2.0pt;padding-right:2.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T7.10.8.8.8.m1.1"><semantics id="A1.T7.10.8.8.8.m1.1a"><mo id="A1.T7.10.8.8.8.m1.1.1" stretchy="false" xref="A1.T7.10.8.8.8.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T7.10.8.8.8.m1.1b"><ci id="A1.T7.10.8.8.8.m1.1.1.cmml" xref="A1.T7.10.8.8.8.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.10.8.8.8.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T7.10.8.8.8.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.11.9.9.9" style="padding-left:2.0pt;padding-right:2.0pt;">LPIPS<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T7.11.9.9.9.m1.1"><semantics id="A1.T7.11.9.9.9.m1.1a"><mo id="A1.T7.11.9.9.9.m1.1.1" stretchy="false" xref="A1.T7.11.9.9.9.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T7.11.9.9.9.m1.1b"><ci id="A1.T7.11.9.9.9.m1.1.1.cmml" xref="A1.T7.11.9.9.9.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.11.9.9.9.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T7.11.9.9.9.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.12.10.10.10" style="padding-left:2.0pt;padding-right:2.0pt;">PSNR<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T7.12.10.10.10.m1.1"><semantics id="A1.T7.12.10.10.10.m1.1a"><mo id="A1.T7.12.10.10.10.m1.1.1" stretchy="false" xref="A1.T7.12.10.10.10.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T7.12.10.10.10.m1.1b"><ci id="A1.T7.12.10.10.10.m1.1.1.cmml" xref="A1.T7.12.10.10.10.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.12.10.10.10.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T7.12.10.10.10.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T7.12.10.12.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="11" id="A1.T7.12.10.12.2.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T7.12.10.12.2.1.1">Default MG step size</span></th>
</tr>
<tr class="ltx_tr" id="A1.T7.12.10.13.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.12.10.13.3.1" style="padding-left:2.0pt;padding-right:2.0pt;">PSLD</th>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.13.3.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.158</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.13.3.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T7.12.10.13.3.3.1">24.22</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.13.3.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T7.12.10.13.3.4.1">0.246</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.13.3.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T7.12.10.13.3.5.1">29.05</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.13.3.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T7.12.10.13.3.6.1">0.357</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.13.3.7" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T7.12.10.13.3.7.1">22.87</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.13.3.8" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T7.12.10.13.3.8.1">0.322</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.13.3.9" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T7.12.10.13.3.9.1">24.25</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.13.3.10" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.12.10.13.3.10.1">0.313</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.13.3.11" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T7.12.10.13.3.11.1">24.51</span></td>
</tr>
<tr class="ltx_tr" id="A1.T7.12.10.14.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.12.10.14.4.1" style="padding-left:2.0pt;padding-right:2.0pt;">DiffStateGrad-PSLD (ours)</th>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.14.4.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T7.12.10.14.4.2.1">0.095</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.14.4.3" style="padding-left:2.0pt;padding-right:2.0pt;">23.76</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.14.4.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.265</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.14.4.5" style="padding-left:2.0pt;padding-right:2.0pt;">28.14</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.14.4.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.366</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.14.4.7" style="padding-left:2.0pt;padding-right:2.0pt;">22.24</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.14.4.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.335</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.14.4.9" style="padding-left:2.0pt;padding-right:2.0pt;">23.34</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.14.4.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.392</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.14.4.11" style="padding-left:2.0pt;padding-right:2.0pt;">22.12</td>
</tr>
<tr class="ltx_tr" id="A1.T7.12.10.15.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="11" id="A1.T7.12.10.15.5.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T7.12.10.15.5.1.1">Large MG step size</span></th>
</tr>
<tr class="ltx_tr" id="A1.T7.12.10.16.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.12.10.16.6.1" style="padding-left:2.0pt;padding-right:2.0pt;">PSLD</th>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.16.6.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.252</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.16.6.3" style="padding-left:2.0pt;padding-right:2.0pt;">11.99</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.16.6.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.463</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.16.6.5" style="padding-left:2.0pt;padding-right:2.0pt;">20.62</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.16.6.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.549</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.16.6.7" style="padding-left:2.0pt;padding-right:2.0pt;">17.47</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.16.6.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.514</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.16.6.9" style="padding-left:2.0pt;padding-right:2.0pt;">18.81</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.16.6.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.697</td>
<td class="ltx_td ltx_align_center" id="A1.T7.12.10.16.6.11" style="padding-left:2.0pt;padding-right:2.0pt;">7.700</td>
</tr>
<tr class="ltx_tr" id="A1.T7.12.10.17.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A1.T7.12.10.17.7.1" style="padding-left:2.0pt;padding-right:2.0pt;">DiffStateGrad-PSLD (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.12.10.17.7.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.12.10.17.7.2.1">0.092</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.12.10.17.7.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.12.10.17.7.3.1">24.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.12.10.17.7.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.12.10.17.7.4.1">0.165</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.12.10.17.7.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.12.10.17.7.5.1">31.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.12.10.17.7.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.12.10.17.7.6.1">0.355</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.12.10.17.7.7" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.12.10.17.7.7.1">22.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.12.10.17.7.8" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.12.10.17.7.8.1">0.319</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.12.10.17.7.9" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.12.10.17.7.9.1">24.31</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.12.10.17.7.10" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T7.12.10.17.7.10.1">0.320</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.12.10.17.7.11" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.12.10.17.7.11.1">24.56</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="A1.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A1.F10.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="389" id="A1.F10.sf1.g1" src="extracted/5900490/figures/ablation/nmse_vs_omega_plot_var_cutoff_final_actual.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>NMSE</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A1.F10.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="389" id="A1.F10.sf2.g1" src="extracted/5900490/figures/ablation/nmse_vs_omega_plot_var_cutoff_zoomed_final_actual.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>NMSE (zoomed)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A1.F10.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="389" id="A1.F10.sf3.g1" src="extracted/5900490/figures/ablation/psnr_vs_omega_plot_var_cutoff_final_actual.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PSNR</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span class="ltx_text ltx_font_bold" id="A1.F10.3.1">Robustness comparison of PSLD and DiffStateGrad-PSLD for different variance retention thresholds <math alttext="\tau" class="ltx_Math" display="inline" id="A1.F10.3.1.m1.1"><semantics id="A1.F10.3.1.m1.1b"><mi id="A1.F10.3.1.m1.1.1" xref="A1.F10.3.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A1.F10.3.1.m1.1c"><ci id="A1.F10.3.1.m1.1.1.cmml" xref="A1.F10.3.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.3.1.m1.1d">\tau</annotation><annotation encoding="application/x-llamapun" id="A1.F10.3.1.m1.1e">italic_τ</annotation></semantics></math></span>. We evaluate images from FFHQ <math alttext="256\times 256" class="ltx_Math" display="inline" id="A1.F10.4.m1.1"><semantics id="A1.F10.4.m1.1b"><mrow id="A1.F10.4.m1.1.1" xref="A1.F10.4.m1.1.1.cmml"><mn id="A1.F10.4.m1.1.1.2" xref="A1.F10.4.m1.1.1.2.cmml">256</mn><mo id="A1.F10.4.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.F10.4.m1.1.1.1.cmml">×</mo><mn id="A1.F10.4.m1.1.1.3" xref="A1.F10.4.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.4.m1.1c"><apply id="A1.F10.4.m1.1.1.cmml" xref="A1.F10.4.m1.1.1"><times id="A1.F10.4.m1.1.1.1.cmml" xref="A1.F10.4.m1.1.1.1"></times><cn id="A1.F10.4.m1.1.1.2.cmml" type="integer" xref="A1.F10.4.m1.1.1.2">256</cn><cn id="A1.F10.4.m1.1.1.3.cmml" type="integer" xref="A1.F10.4.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.4.m1.1d">256\times 256</annotation><annotation encoding="application/x-llamapun" id="A1.F10.4.m1.1e">256 × 256</annotation></semantics></math> on box inpainting.</figcaption>
</figure>
<figure class="ltx_table" id="A1.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span><span class="ltx_text ltx_font_bold" id="A1.T8.2.1">SSIM comparison for deblurring and super-resolution tasks on FFHQ 256 <math alttext="\times" class="ltx_Math" display="inline" id="A1.T8.2.1.m1.1"><semantics id="A1.T8.2.1.m1.1b"><mo id="A1.T8.2.1.m1.1.1" xref="A1.T8.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T8.2.1.m1.1c"><times id="A1.T8.2.1.m1.1.1.cmml" xref="A1.T8.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.2.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A1.T8.2.1.m1.1e">×</annotation></semantics></math> 256.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T8.5" style="width:278.2pt;height:141pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-38.5pt,19.5pt) scale(0.783216620118685,0.783216620118685) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T8.5.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T8.5.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A1.T8.5.3.4.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Method</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T8.5.3.4.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Gaussian deblur</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T8.5.3.4.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Motion deblur</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T8.5.3.4.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">SR (x4)</td>
</tr>
<tr class="ltx_tr" id="A1.T8.5.3.3">
<th class="ltx_td ltx_th ltx_th_row" id="A1.T8.5.3.3.4" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.3.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T8.3.1.1.1.m1.1"><semantics id="A1.T8.3.1.1.1.m1.1a"><mo id="A1.T8.3.1.1.1.m1.1.1" stretchy="false" xref="A1.T8.3.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T8.3.1.1.1.m1.1b"><ci id="A1.T8.3.1.1.1.m1.1.1.cmml" xref="A1.T8.3.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.3.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T8.3.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.4.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T8.4.2.2.2.m1.1"><semantics id="A1.T8.4.2.2.2.m1.1a"><mo id="A1.T8.4.2.2.2.m1.1.1" stretchy="false" xref="A1.T8.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T8.4.2.2.2.m1.1b"><ci id="A1.T8.4.2.2.2.m1.1.1.cmml" xref="A1.T8.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T8.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.5.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T8.5.3.3.3.m1.1"><semantics id="A1.T8.5.3.3.3.m1.1a"><mo id="A1.T8.5.3.3.3.m1.1.1" stretchy="false" xref="A1.T8.5.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T8.5.3.3.3.m1.1b"><ci id="A1.T8.5.3.3.3.m1.1.1.cmml" xref="A1.T8.5.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.5.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T8.5.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T8.5.3.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="4" id="A1.T8.5.3.5.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T8.5.3.5.2.1.1">Pixel-based</span></th>
</tr>
<tr class="ltx_tr" id="A1.T8.5.3.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.5.3.6.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">DAPS</th>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.6.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T8.5.3.6.3.2.1">0.786</span> (0.051)</td>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.6.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T8.5.3.6.3.3.1">0.837</span> (0.040)</td>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.6.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T8.5.3.6.3.4.1">0.797</span> (0.044)</td>
</tr>
<tr class="ltx_tr" id="A1.T8.5.3.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.5.3.7.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-DAPS (ours)</th>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.7.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T8.5.3.7.4.2.1">0.803</span> (0.044)</td>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.7.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T8.5.3.7.4.3.1">0.853</span> (0.028)</td>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.7.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T8.5.3.7.4.4.1">0.801</span> (0.039)</td>
</tr>
<tr class="ltx_tr" id="A1.T8.5.3.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="4" id="A1.T8.5.3.8.5.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T8.5.3.8.5.1.1">Latent</span></th>
</tr>
<tr class="ltx_tr" id="A1.T8.5.3.9.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.5.3.9.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">PSLD</th>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.9.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.537 (0.094)</td>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.9.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.615 (0.075)</td>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.9.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.650 (0.140)</td>
</tr>
<tr class="ltx_tr" id="A1.T8.5.3.10.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.5.3.10.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-PSLD (ours)</th>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.10.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.542 (0.077)</td>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.10.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.620 (0.065)</td>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.10.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.640 (0.123)</td>
</tr>
<tr class="ltx_tr" id="A1.T8.5.3.11.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.5.3.11.8.1" style="padding-left:3.0pt;padding-right:3.0pt;">ReSample</th>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.11.8.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T8.5.3.11.8.2.1">0.757</span> (0.049)</td>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.11.8.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T8.5.3.11.8.3.1">0.854</span> (0.034)</td>
<td class="ltx_td ltx_align_center" id="A1.T8.5.3.11.8.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T8.5.3.11.8.4.1">0.790</span> (0.048)</td>
</tr>
<tr class="ltx_tr" id="A1.T8.5.3.12.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A1.T8.5.3.12.9.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-ReSample (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T8.5.3.12.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T8.5.3.12.9.2.1">0.767</span> (0.041)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T8.5.3.12.9.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T8.5.3.12.9.3.1">0.860</span> (0.031)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T8.5.3.12.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T8.5.3.12.9.4.1">0.795</span> (0.044)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_table" id="A1.T9">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span><span class="ltx_text ltx_font_bold" id="A1.T9.2.1">SSIM comparison for nonlinear tasks on FFHQ 256 <math alttext="\times" class="ltx_Math" display="inline" id="A1.T9.2.1.m1.1"><semantics id="A1.T9.2.1.m1.1b"><mo id="A1.T9.2.1.m1.1.1" xref="A1.T9.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T9.2.1.m1.1c"><times id="A1.T9.2.1.m1.1.1.cmml" xref="A1.T9.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T9.2.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A1.T9.2.1.m1.1e">×</annotation></semantics></math> 256.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T9.5" style="width:278.2pt;height:103pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-55.4pt,20.5pt) scale(0.715340693393854,0.715340693393854) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T9.5.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T9.5.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A1.T9.5.3.4.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Method</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T9.5.3.4.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Phase retrieval</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T9.5.3.4.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Nonlinear deblur</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T9.5.3.4.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">High dynamic range</td>
</tr>
<tr class="ltx_tr" id="A1.T9.5.3.3">
<th class="ltx_td ltx_th ltx_th_row" id="A1.T9.5.3.3.4" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T9.3.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T9.3.1.1.1.m1.1"><semantics id="A1.T9.3.1.1.1.m1.1a"><mo id="A1.T9.3.1.1.1.m1.1.1" stretchy="false" xref="A1.T9.3.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T9.3.1.1.1.m1.1b"><ci id="A1.T9.3.1.1.1.m1.1.1.cmml" xref="A1.T9.3.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T9.3.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T9.3.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T9.4.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T9.4.2.2.2.m1.1"><semantics id="A1.T9.4.2.2.2.m1.1a"><mo id="A1.T9.4.2.2.2.m1.1.1" stretchy="false" xref="A1.T9.4.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T9.4.2.2.2.m1.1b"><ci id="A1.T9.4.2.2.2.m1.1.1.cmml" xref="A1.T9.4.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T9.4.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T9.4.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T9.5.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T9.5.3.3.3.m1.1"><semantics id="A1.T9.5.3.3.3.m1.1a"><mo id="A1.T9.5.3.3.3.m1.1.1" stretchy="false" xref="A1.T9.5.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T9.5.3.3.3.m1.1b"><ci id="A1.T9.5.3.3.3.m1.1.1.cmml" xref="A1.T9.5.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T9.5.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T9.5.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A1.T9.5.3.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="4" id="A1.T9.5.3.5.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T9.5.3.5.2.1.1">Pixel-based</span></th>
</tr>
<tr class="ltx_tr" id="A1.T9.5.3.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T9.5.3.6.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">DAPS</th>
<td class="ltx_td ltx_align_center" id="A1.T9.5.3.6.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T9.5.3.6.3.2.1">0.823</span> (0.033)</td>
<td class="ltx_td ltx_align_center" id="A1.T9.5.3.6.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T9.5.3.6.3.3.1">0.723</span> (0.034)</td>
<td class="ltx_td ltx_align_center" id="A1.T9.5.3.6.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T9.5.3.6.3.4.1">0.817</span> (0.109)</td>
</tr>
<tr class="ltx_tr" id="A1.T9.5.3.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T9.5.3.7.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-DAPS (ours)</th>
<td class="ltx_td ltx_align_center" id="A1.T9.5.3.7.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T9.5.3.7.4.2.1">0.868</span> (0.026)</td>
<td class="ltx_td ltx_align_center" id="A1.T9.5.3.7.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T9.5.3.7.4.3.1">0.818</span> (0.035)</td>
<td class="ltx_td ltx_align_center" id="A1.T9.5.3.7.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T9.5.3.7.4.4.1">0.852</span> (0.098)</td>
</tr>
<tr class="ltx_tr" id="A1.T9.5.3.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="4" id="A1.T9.5.3.8.5.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_italic" id="A1.T9.5.3.8.5.1.1">Latent</span></th>
</tr>
<tr class="ltx_tr" id="A1.T9.5.3.9.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T9.5.3.9.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">ReSample</th>
<td class="ltx_td ltx_align_center" id="A1.T9.5.3.9.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T9.5.3.9.6.2.1">0.750</span> (0.246)</td>
<td class="ltx_td ltx_align_center" id="A1.T9.5.3.9.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T9.5.3.9.6.3.1">0.842</span> (0.038)</td>
<td class="ltx_td ltx_align_center" id="A1.T9.5.3.9.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="A1.T9.5.3.9.6.4.1">0.819</span> (0.109)</td>
</tr>
<tr class="ltx_tr" id="A1.T9.5.3.10.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A1.T9.5.3.10.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">DiffStateGrad-ReSample (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T9.5.3.10.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T9.5.3.10.7.2.1">0.855</span> (0.130)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T9.5.3.10.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T9.5.3.10.7.3.1">0.847</span> (0.035)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T9.5.3.10.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="A1.T9.5.3.10.7.4.1">0.857</span> (0.059)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Visualizations</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">This section contains additional visualizations for performance comparison.</p>
</div>
<figure class="ltx_figure" id="A2.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A2.F11.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A2.F11.sf1.g1" src="extracted/5900490/figures/rec_examples_fixed_title/chosen-images_task_chosen-bip-images_id_60017.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="A2.F11.sf1.g2" src="extracted/5900490/figures/rec_examples_fixed_title/chosen-images_task_chosen-bip-images_id_60095_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Box inpainting.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A2.F11.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A2.F11.sf2.g1" src="extracted/5900490/figures/rec_examples_fixed_title/chosen-images_task_chosen-rip-images_id_60050.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="A2.F11.sf2.g2" src="extracted/5900490/figures/rec_examples_fixed_title/chosen-images_task_chosen-rip-images_id_60061_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Random inpainting.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A2.F11.sf3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A2.F11.sf3.g1" src="extracted/5900490/figures/rec_examples_fixed_title/chosen-images_task_chosen-gb-images_id_60011.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="A2.F11.sf3.g2" src="extracted/5900490/figures/rec_examples_fixed_title/chosen-images_task_chosen-gb-images_id_60031_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Gaussian deblur.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A2.F11.sf4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A2.F11.sf4.g1" src="extracted/5900490/figures/rec_examples_fixed_title/chosen-images_task_chosen-sr-images_id_60088.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="A2.F11.sf4.g2" src="extracted/5900490/figures/rec_examples_fixed_title/chosen-images_task_chosen-sr-images_id_60087_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>Super-resolution (<math alttext="\times 4" class="ltx_Math" display="inline" id="A2.F11.sf4.2.m1.1"><semantics id="A2.F11.sf4.2.m1.1b"><mrow id="A2.F11.sf4.2.m1.1.1" xref="A2.F11.sf4.2.m1.1.1.cmml"><mi id="A2.F11.sf4.2.m1.1.1.2" xref="A2.F11.sf4.2.m1.1.1.2.cmml"></mi><mo id="A2.F11.sf4.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.F11.sf4.2.m1.1.1.1.cmml">×</mo><mn id="A2.F11.sf4.2.m1.1.1.3" xref="A2.F11.sf4.2.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F11.sf4.2.m1.1c"><apply id="A2.F11.sf4.2.m1.1.1.cmml" xref="A2.F11.sf4.2.m1.1.1"><times id="A2.F11.sf4.2.m1.1.1.1.cmml" xref="A2.F11.sf4.2.m1.1.1.1"></times><csymbol cd="latexml" id="A2.F11.sf4.2.m1.1.1.2.cmml" xref="A2.F11.sf4.2.m1.1.1.2">absent</csymbol><cn id="A2.F11.sf4.2.m1.1.1.3.cmml" type="integer" xref="A2.F11.sf4.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.sf4.2.m1.1d">\times 4</annotation><annotation encoding="application/x-llamapun" id="A2.F11.sf4.2.m1.1e">× 4</annotation></semantics></math>).</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span class="ltx_text ltx_font_bold" id="A2.F11.2.1">Qualitative comparison of DiffStateGrad-PSLD and PSLD for a large MG step size</span>. Images are chosen at random for visualization.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F12">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A2.F12.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A2.F12.sf1.g1" src="extracted/5900490/figures/rec_examples_best_fixed_title/best_performing_task_chosen-bip-images_id_60021.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="A2.F12.sf1.g2" src="extracted/5900490/figures/rec_examples_best_fixed_title/best_performing_task_chosen-bip-images_id_60095_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Box inpainting.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A2.F12.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A2.F12.sf2.g1" src="extracted/5900490/figures/rec_examples_best_fixed_title/best_performing_task_chosen-rip-images_id_60067.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="A2.F12.sf2.g2" src="extracted/5900490/figures/rec_examples_best_fixed_title/best_performing_task_chosen-rip-images_id_60063_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Random inpainting.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A2.F12.sf3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A2.F12.sf3.g1" src="extracted/5900490/figures/rec_examples_best_fixed_title/best_performing_task_chosen-gb-images_id_60033.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="A2.F12.sf3.g2" src="extracted/5900490/figures/rec_examples_best_fixed_title/best_performing_task_chosen-gb-images_id_60031_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Gaussian deblur.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A2.F12.sf4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A2.F12.sf4.g1" src="extracted/5900490/figures/rec_examples_best_fixed_title/best_performing_task_chosen-sr-images_id_60096.png" width="548"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="A2.F12.sf4.g2" src="extracted/5900490/figures/rec_examples_best_fixed_title/best_performing_task_chosen-sr-images_id_60074_notitle.png" width="548"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>Super-resolution (<math alttext="\times 4" class="ltx_Math" display="inline" id="A2.F12.sf4.2.m1.1"><semantics id="A2.F12.sf4.2.m1.1b"><mrow id="A2.F12.sf4.2.m1.1.1" xref="A2.F12.sf4.2.m1.1.1.cmml"><mi id="A2.F12.sf4.2.m1.1.1.2" xref="A2.F12.sf4.2.m1.1.1.2.cmml"></mi><mo id="A2.F12.sf4.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.F12.sf4.2.m1.1.1.1.cmml">×</mo><mn id="A2.F12.sf4.2.m1.1.1.3" xref="A2.F12.sf4.2.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F12.sf4.2.m1.1c"><apply id="A2.F12.sf4.2.m1.1.1.cmml" xref="A2.F12.sf4.2.m1.1.1"><times id="A2.F12.sf4.2.m1.1.1.1.cmml" xref="A2.F12.sf4.2.m1.1.1.1"></times><csymbol cd="latexml" id="A2.F12.sf4.2.m1.1.1.2.cmml" xref="A2.F12.sf4.2.m1.1.1.2">absent</csymbol><cn id="A2.F12.sf4.2.m1.1.1.3.cmml" type="integer" xref="A2.F12.sf4.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F12.sf4.2.m1.1d">\times 4</annotation><annotation encoding="application/x-llamapun" id="A2.F12.sf4.2.m1.1e">× 4</annotation></semantics></math>).</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 12: </span><span class="ltx_text ltx_font_bold" id="A2.F12.2.1">Qualitative comparison of DiffStateGrad-PSLD and PSLD for their best-performing MG step size</span>. Images are chosen at random for visualization.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A2.F13.4" style="width:194.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="152" id="A2.F13.1.g1" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-pr-images_id_60002.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F13.2.g2" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-pr-images_id_60008_notitle.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F13.3.g3" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-pr-images_id_60009_notitle.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F13.4.g4" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-pr-images_id_60016_notitle.png" width="548"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A2.F13.8" style="width:194.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="152" id="A2.F13.5.g1" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-pr-images_id_60024.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F13.6.g2" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-pr-images_id_60026_notitle.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F13.7.g3" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-pr-images_id_60081_notitle.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F13.8.g4" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-pr-images_id_60094_notitle.png" width="548"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span><span class="ltx_text ltx_font_bold" id="A2.F13.10.1">Qualitative comparison of DiffStateGrad-ReSample and ReSample for phase retrieval</span>. Whereas the performance of ReSample is inconsistent, DiffStateGrad-ReSample consistently produces accurate reconstructions. Images are chosen at random for visualization.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F14">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A2.F14.4" style="width:194.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="152" id="A2.F14.1.g1" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-hdr-images_id_60014.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F14.2.g2" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-hdr-images_id_60015_notitle.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F14.3.g3" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-hdr-images_id_60025_notitle.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F14.4.g4" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-hdr-images_id_60029_notitle.png" width="548"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A2.F14.8" style="width:194.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="152" id="A2.F14.5.g1" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-hdr-images_id_60052.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F14.6.g2" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-hdr-images_id_60055_notitle.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F14.7.g3" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-hdr-images_id_60080_notitle.png" width="548"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A2.F14.8.g4" src="extracted/5900490/figures/rec_phase/chosen-images_task_chosen-hdr-images_id_60085_notitle.png" width="548"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span><span class="ltx_text ltx_font_bold" id="A2.F14.10.1">Qualitative comparison of DiffStateGrad-ReSample and ReSample for high dynamic range (HDR)</span>. Images are chosen at random for visualization.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F15">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A2.F15.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="A2.F15.sf1.g1" src="extracted/5900490/figures/diverse/diverse_task_bip_id_60045.png" width="598"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A2.F15.sf1.g2" src="extracted/5900490/figures/diverse/diverse_task_bip_id_60046_notitle.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Box inpainting (<math alttext="192\times 192" class="ltx_Math" display="inline" id="A2.F15.sf1.2.m1.1"><semantics id="A2.F15.sf1.2.m1.1b"><mrow id="A2.F15.sf1.2.m1.1.1" xref="A2.F15.sf1.2.m1.1.1.cmml"><mn id="A2.F15.sf1.2.m1.1.1.2" xref="A2.F15.sf1.2.m1.1.1.2.cmml">192</mn><mo id="A2.F15.sf1.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.F15.sf1.2.m1.1.1.1.cmml">×</mo><mn id="A2.F15.sf1.2.m1.1.1.3" xref="A2.F15.sf1.2.m1.1.1.3.cmml">192</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F15.sf1.2.m1.1c"><apply id="A2.F15.sf1.2.m1.1.1.cmml" xref="A2.F15.sf1.2.m1.1.1"><times id="A2.F15.sf1.2.m1.1.1.1.cmml" xref="A2.F15.sf1.2.m1.1.1.1"></times><cn id="A2.F15.sf1.2.m1.1.1.2.cmml" type="integer" xref="A2.F15.sf1.2.m1.1.1.2">192</cn><cn id="A2.F15.sf1.2.m1.1.1.3.cmml" type="integer" xref="A2.F15.sf1.2.m1.1.1.3">192</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F15.sf1.2.m1.1d">192\times 192</annotation><annotation encoding="application/x-llamapun" id="A2.F15.sf1.2.m1.1e">192 × 192</annotation></semantics></math> box).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A2.F15.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="138" id="A2.F15.sf2.g1" src="extracted/5900490/figures/diverse/diverse_task_gb_id_60047.png" width="598"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="A2.F15.sf2.g2" src="extracted/5900490/figures/diverse/diverse_task_gb_id_60048_notitle.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Gaussian deblur (<math alttext="81\times 81" class="ltx_Math" display="inline" id="A2.F15.sf2.2.m1.1"><semantics id="A2.F15.sf2.2.m1.1b"><mrow id="A2.F15.sf2.2.m1.1.1" xref="A2.F15.sf2.2.m1.1.1.cmml"><mn id="A2.F15.sf2.2.m1.1.1.2" xref="A2.F15.sf2.2.m1.1.1.2.cmml">81</mn><mo id="A2.F15.sf2.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.F15.sf2.2.m1.1.1.1.cmml">×</mo><mn id="A2.F15.sf2.2.m1.1.1.3" xref="A2.F15.sf2.2.m1.1.1.3.cmml">81</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F15.sf2.2.m1.1c"><apply id="A2.F15.sf2.2.m1.1.1.cmml" xref="A2.F15.sf2.2.m1.1.1"><times id="A2.F15.sf2.2.m1.1.1.1.cmml" xref="A2.F15.sf2.2.m1.1.1.1"></times><cn id="A2.F15.sf2.2.m1.1.1.2.cmml" type="integer" xref="A2.F15.sf2.2.m1.1.1.2">81</cn><cn id="A2.F15.sf2.2.m1.1.1.3.cmml" type="integer" xref="A2.F15.sf2.2.m1.1.1.3">81</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F15.sf2.2.m1.1d">81\times 81</annotation><annotation encoding="application/x-llamapun" id="A2.F15.sf2.2.m1.1e">81 × 81</annotation></semantics></math> kernel, SD of 7).</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 15: </span><span class="ltx_text ltx_font_bold" id="A2.F15.2.1">Reconstruction diversity of DiffStateGrad.</span> DiffStateGrad-PSLD with a large MG step size can produce a diverse range of images from multimodal posteriors. Generated images have distinctive facial features.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Implementation Details</h2>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Hyperparameters</h3>
<div class="ltx_para ltx_noindent" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.4">For all main experiments across all three methods, we use the variance retention threshold <math alttext="\tau=0.99" class="ltx_Math" display="inline" id="A3.SS1.p1.1.m1.1"><semantics id="A3.SS1.p1.1.m1.1a"><mrow id="A3.SS1.p1.1.m1.1.1" xref="A3.SS1.p1.1.m1.1.1.cmml"><mi id="A3.SS1.p1.1.m1.1.1.2" xref="A3.SS1.p1.1.m1.1.1.2.cmml">τ</mi><mo id="A3.SS1.p1.1.m1.1.1.1" xref="A3.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS1.p1.1.m1.1.1.3" xref="A3.SS1.p1.1.m1.1.1.3.cmml">0.99</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.1.m1.1b"><apply id="A3.SS1.p1.1.m1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1"><eq id="A3.SS1.p1.1.m1.1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1.1"></eq><ci id="A3.SS1.p1.1.m1.1.1.2.cmml" xref="A3.SS1.p1.1.m1.1.1.2">𝜏</ci><cn id="A3.SS1.p1.1.m1.1.1.3.cmml" type="float" xref="A3.SS1.p1.1.m1.1.1.3">0.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.1.m1.1c">\tau=0.99</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.1.m1.1d">italic_τ = 0.99</annotation></semantics></math>. For all experiments involving PSLD and DAPS, we perform the DiffStateGrad projection step every iteration (<math alttext="F=1" class="ltx_Math" display="inline" id="A3.SS1.p1.2.m2.1"><semantics id="A3.SS1.p1.2.m2.1a"><mrow id="A3.SS1.p1.2.m2.1.1" xref="A3.SS1.p1.2.m2.1.1.cmml"><mi id="A3.SS1.p1.2.m2.1.1.2" xref="A3.SS1.p1.2.m2.1.1.2.cmml">F</mi><mo id="A3.SS1.p1.2.m2.1.1.1" xref="A3.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A3.SS1.p1.2.m2.1.1.3" xref="A3.SS1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.2.m2.1b"><apply id="A3.SS1.p1.2.m2.1.1.cmml" xref="A3.SS1.p1.2.m2.1.1"><eq id="A3.SS1.p1.2.m2.1.1.1.cmml" xref="A3.SS1.p1.2.m2.1.1.1"></eq><ci id="A3.SS1.p1.2.m2.1.1.2.cmml" xref="A3.SS1.p1.2.m2.1.1.2">𝐹</ci><cn id="A3.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="A3.SS1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.2.m2.1c">F=1</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.2.m2.1d">italic_F = 1</annotation></semantics></math>). For all experiments involving ReSample, we perform the step every five iterations (<math alttext="F=5" class="ltx_Math" display="inline" id="A3.SS1.p1.3.m3.1"><semantics id="A3.SS1.p1.3.m3.1a"><mrow id="A3.SS1.p1.3.m3.1.1" xref="A3.SS1.p1.3.m3.1.1.cmml"><mi id="A3.SS1.p1.3.m3.1.1.2" xref="A3.SS1.p1.3.m3.1.1.2.cmml">F</mi><mo id="A3.SS1.p1.3.m3.1.1.1" xref="A3.SS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="A3.SS1.p1.3.m3.1.1.3" xref="A3.SS1.p1.3.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.3.m3.1b"><apply id="A3.SS1.p1.3.m3.1.1.cmml" xref="A3.SS1.p1.3.m3.1.1"><eq id="A3.SS1.p1.3.m3.1.1.1.cmml" xref="A3.SS1.p1.3.m3.1.1.1"></eq><ci id="A3.SS1.p1.3.m3.1.1.2.cmml" xref="A3.SS1.p1.3.m3.1.1.2">𝐹</ci><cn id="A3.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="A3.SS1.p1.3.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.3.m3.1c">F=5</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.3.m3.1d">italic_F = 5</annotation></semantics></math>). See the sections dedicated to each method for further implementation details. We reiterate that various values of <math alttext="\tau" class="ltx_Math" display="inline" id="A3.SS1.p1.4.m4.1"><semantics id="A3.SS1.p1.4.m4.1a"><mi id="A3.SS1.p1.4.m4.1.1" xref="A3.SS1.p1.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.4.m4.1b"><ci id="A3.SS1.p1.4.m4.1.1.cmml" xref="A3.SS1.p1.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.4.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.4.m4.1d">italic_τ</annotation></semantics></math> are reasonable options for optimal performance (see <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#A1.F10" title="In Appendix A Additional Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">Figures</span> <span class="ltx_text ltx_ref_tag">10</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S4.F8" title="Figure 8 ‣ 4.3 Performance ‣ 4 Results ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">8</span></a>).</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Efficiency Experiment</h3>
<div class="ltx_para ltx_noindent" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.1">We evaluate the computational overhead introduced by DiffStateGrad across three diffusion-based methods: PSLD, ReSample, and DAPS. We conduct these experiments on the box inpainting task using an NVIDIA GeForce RTX 4090 GPU with 24GB of VRAM. Each method is run with its default settings on a set of 100 images from FFHQ <math alttext="256\times 256" class="ltx_Math" display="inline" id="A3.SS2.p1.1.m1.1"><semantics id="A3.SS2.p1.1.m1.1a"><mrow id="A3.SS2.p1.1.m1.1.1" xref="A3.SS2.p1.1.m1.1.1.cmml"><mn id="A3.SS2.p1.1.m1.1.1.2" xref="A3.SS2.p1.1.m1.1.1.2.cmml">256</mn><mo id="A3.SS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="A3.SS2.p1.1.m1.1.1.3" xref="A3.SS2.p1.1.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.1.m1.1b"><apply id="A3.SS2.p1.1.m1.1.1.cmml" xref="A3.SS2.p1.1.m1.1.1"><times id="A3.SS2.p1.1.m1.1.1.1.cmml" xref="A3.SS2.p1.1.m1.1.1.1"></times><cn id="A3.SS2.p1.1.m1.1.1.2.cmml" type="integer" xref="A3.SS2.p1.1.m1.1.1.2">256</cn><cn id="A3.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="A3.SS2.p1.1.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.1.m1.1c">256\times 256</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.1.m1.1d">256 × 256</annotation></semantics></math>, and we measure the average runtime in seconds per image.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>PSLD</h3>
<div class="ltx_para ltx_noindent" id="A3.SS3.p1">
<p class="ltx_p" id="A3.SS3.p1.7">Our DiffStateGrad-PSLD algorithm integrates the state-guided projected gradient directly into the PSLD update process. For each iteration (i.e., frequency <math alttext="F=1" class="ltx_Math" display="inline" id="A3.SS3.p1.1.m1.1"><semantics id="A3.SS3.p1.1.m1.1a"><mrow id="A3.SS3.p1.1.m1.1.1" xref="A3.SS3.p1.1.m1.1.1.cmml"><mi id="A3.SS3.p1.1.m1.1.1.2" xref="A3.SS3.p1.1.m1.1.1.2.cmml">F</mi><mo id="A3.SS3.p1.1.m1.1.1.1" xref="A3.SS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS3.p1.1.m1.1.1.3" xref="A3.SS3.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.1.m1.1b"><apply id="A3.SS3.p1.1.m1.1.1.cmml" xref="A3.SS3.p1.1.m1.1.1"><eq id="A3.SS3.p1.1.m1.1.1.1.cmml" xref="A3.SS3.p1.1.m1.1.1.1"></eq><ci id="A3.SS3.p1.1.m1.1.1.2.cmml" xref="A3.SS3.p1.1.m1.1.1.2">𝐹</ci><cn id="A3.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="A3.SS3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.1.m1.1c">F=1</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.1.m1.1d">italic_F = 1</annotation></semantics></math>) of the main loop, after computing the standard PSLD update <math alttext="{\bm{z}}^{\prime}_{t-1}" class="ltx_Math" display="inline" id="A3.SS3.p1.2.m2.1"><semantics id="A3.SS3.p1.2.m2.1a"><msubsup id="A3.SS3.p1.2.m2.1.1" xref="A3.SS3.p1.2.m2.1.1.cmml"><mi id="A3.SS3.p1.2.m2.1.1.2.2" xref="A3.SS3.p1.2.m2.1.1.2.2.cmml">𝒛</mi><mrow id="A3.SS3.p1.2.m2.1.1.3" xref="A3.SS3.p1.2.m2.1.1.3.cmml"><mi id="A3.SS3.p1.2.m2.1.1.3.2" xref="A3.SS3.p1.2.m2.1.1.3.2.cmml">t</mi><mo id="A3.SS3.p1.2.m2.1.1.3.1" xref="A3.SS3.p1.2.m2.1.1.3.1.cmml">−</mo><mn id="A3.SS3.p1.2.m2.1.1.3.3" xref="A3.SS3.p1.2.m2.1.1.3.3.cmml">1</mn></mrow><mo id="A3.SS3.p1.2.m2.1.1.2.3" xref="A3.SS3.p1.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.2.m2.1b"><apply id="A3.SS3.p1.2.m2.1.1.cmml" xref="A3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS3.p1.2.m2.1.1.1.cmml" xref="A3.SS3.p1.2.m2.1.1">subscript</csymbol><apply id="A3.SS3.p1.2.m2.1.1.2.cmml" xref="A3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS3.p1.2.m2.1.1.2.1.cmml" xref="A3.SS3.p1.2.m2.1.1">superscript</csymbol><ci id="A3.SS3.p1.2.m2.1.1.2.2.cmml" xref="A3.SS3.p1.2.m2.1.1.2.2">𝒛</ci><ci id="A3.SS3.p1.2.m2.1.1.2.3.cmml" xref="A3.SS3.p1.2.m2.1.1.2.3">′</ci></apply><apply id="A3.SS3.p1.2.m2.1.1.3.cmml" xref="A3.SS3.p1.2.m2.1.1.3"><minus id="A3.SS3.p1.2.m2.1.1.3.1.cmml" xref="A3.SS3.p1.2.m2.1.1.3.1"></minus><ci id="A3.SS3.p1.2.m2.1.1.3.2.cmml" xref="A3.SS3.p1.2.m2.1.1.3.2">𝑡</ci><cn id="A3.SS3.p1.2.m2.1.1.3.3.cmml" type="integer" xref="A3.SS3.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.2.m2.1c">{\bm{z}}^{\prime}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.2.m2.1d">bold_italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, we introduce our DiffStateGrad method. First, we calculate the full gradient <math alttext="\bm{G}_{t}" class="ltx_Math" display="inline" id="A3.SS3.p1.3.m3.1"><semantics id="A3.SS3.p1.3.m3.1a"><msub id="A3.SS3.p1.3.m3.1.1" xref="A3.SS3.p1.3.m3.1.1.cmml"><mi id="A3.SS3.p1.3.m3.1.1.2" xref="A3.SS3.p1.3.m3.1.1.2.cmml">𝑮</mi><mi id="A3.SS3.p1.3.m3.1.1.3" xref="A3.SS3.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.3.m3.1b"><apply id="A3.SS3.p1.3.m3.1.1.cmml" xref="A3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A3.SS3.p1.3.m3.1.1.1.cmml" xref="A3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="A3.SS3.p1.3.m3.1.1.2.cmml" xref="A3.SS3.p1.3.m3.1.1.2">𝑮</ci><ci id="A3.SS3.p1.3.m3.1.1.3.cmml" xref="A3.SS3.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.3.m3.1c">\bm{G}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.3.m3.1d">bold_italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> according to PSLD, combining both the measurement consistency term and the fixed-point constraint. We then perform SVD on the current latent representation (or diffusion state) <math alttext="{\bm{Z}}_{t}" class="ltx_Math" display="inline" id="A3.SS3.p1.4.m4.1"><semantics id="A3.SS3.p1.4.m4.1a"><msub id="A3.SS3.p1.4.m4.1.1" xref="A3.SS3.p1.4.m4.1.1.cmml"><mi id="A3.SS3.p1.4.m4.1.1.2" xref="A3.SS3.p1.4.m4.1.1.2.cmml">𝒁</mi><mi id="A3.SS3.p1.4.m4.1.1.3" xref="A3.SS3.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.4.m4.1b"><apply id="A3.SS3.p1.4.m4.1.1.cmml" xref="A3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A3.SS3.p1.4.m4.1.1.1.cmml" xref="A3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="A3.SS3.p1.4.m4.1.1.2.cmml" xref="A3.SS3.p1.4.m4.1.1.2">𝒁</ci><ci id="A3.SS3.p1.4.m4.1.1.3.cmml" xref="A3.SS3.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.4.m4.1c">{\bm{Z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.4.m4.1d">bold_italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (<math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="A3.SS3.p1.5.m5.1"><semantics id="A3.SS3.p1.5.m5.1a"><msub id="A3.SS3.p1.5.m5.1.1" xref="A3.SS3.p1.5.m5.1.1.cmml"><mi id="A3.SS3.p1.5.m5.1.1.2" xref="A3.SS3.p1.5.m5.1.1.2.cmml">𝒛</mi><mi id="A3.SS3.p1.5.m5.1.1.3" xref="A3.SS3.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.5.m5.1b"><apply id="A3.SS3.p1.5.m5.1.1.cmml" xref="A3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A3.SS3.p1.5.m5.1.1.1.cmml" xref="A3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="A3.SS3.p1.5.m5.1.1.2.cmml" xref="A3.SS3.p1.5.m5.1.1.2">𝒛</ci><ci id="A3.SS3.p1.5.m5.1.1.3.cmml" xref="A3.SS3.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.5.m5.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.5.m5.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in image matrix form). Using the variance retention threshold <math alttext="\tau" class="ltx_Math" display="inline" id="A3.SS3.p1.6.m6.1"><semantics id="A3.SS3.p1.6.m6.1a"><mi id="A3.SS3.p1.6.m6.1.1" xref="A3.SS3.p1.6.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.6.m6.1b"><ci id="A3.SS3.p1.6.m6.1.1.cmml" xref="A3.SS3.p1.6.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.6.m6.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.6.m6.1d">italic_τ</annotation></semantics></math>, we determine the appropriate rank for our projection. We construct projection matrices from the truncated singular vectors and use these to approximate the gradient. This approximated gradient <math alttext="\bm{G}^{\prime}_{t}" class="ltx_Math" display="inline" id="A3.SS3.p1.7.m7.1"><semantics id="A3.SS3.p1.7.m7.1a"><msubsup id="A3.SS3.p1.7.m7.1.1" xref="A3.SS3.p1.7.m7.1.1.cmml"><mi id="A3.SS3.p1.7.m7.1.1.2.2" xref="A3.SS3.p1.7.m7.1.1.2.2.cmml">𝑮</mi><mi id="A3.SS3.p1.7.m7.1.1.3" xref="A3.SS3.p1.7.m7.1.1.3.cmml">t</mi><mo id="A3.SS3.p1.7.m7.1.1.2.3" xref="A3.SS3.p1.7.m7.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.7.m7.1b"><apply id="A3.SS3.p1.7.m7.1.1.cmml" xref="A3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A3.SS3.p1.7.m7.1.1.1.cmml" xref="A3.SS3.p1.7.m7.1.1">subscript</csymbol><apply id="A3.SS3.p1.7.m7.1.1.2.cmml" xref="A3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A3.SS3.p1.7.m7.1.1.2.1.cmml" xref="A3.SS3.p1.7.m7.1.1">superscript</csymbol><ci id="A3.SS3.p1.7.m7.1.1.2.2.cmml" xref="A3.SS3.p1.7.m7.1.1.2.2">𝑮</ci><ci id="A3.SS3.p1.7.m7.1.1.2.3.cmml" xref="A3.SS3.p1.7.m7.1.1.2.3">′</ci></apply><ci id="A3.SS3.p1.7.m7.1.1.3.cmml" xref="A3.SS3.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.7.m7.1c">\bm{G}^{\prime}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.7.m7.1d">bold_italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is then used for the final update step, replacing the separate gradient updates in standard PSLD. This process is repeated at every iteration, allowing for adaptive, low-rank updates throughout the entire diffusion process.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS3.p2">
<p class="ltx_p" id="A3.SS3.p2.1">For experiments, we use the official implementation of PSLD <cite class="ltx_cite ltx_citemacro_citep">(Rout et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib23" title="">2023</a>)</cite> with default configurations.</p>
</div>
<figure class="ltx_figure" id="A3.SS3.fig1">
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> DiffStateGrad-PSLD for Image Restoration Tasks</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><math alttext="T,\bm{y},\{\eta_{t}\}_{t=1}^{T},\{\gamma_{t}\}_{t=1}^{T},\{\tilde{\sigma}_{t}%
\}_{t=1}^{T}" class="ltx_Math" display="inline" id="alg2.l1.m1.5"><semantics id="alg2.l1.m1.5a"><mrow id="alg2.l1.m1.5.5.3" xref="alg2.l1.m1.5.5.4.cmml"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">T</mi><mo id="alg2.l1.m1.5.5.3.4" xref="alg2.l1.m1.5.5.4.cmml">,</mo><mi id="alg2.l1.m1.2.2" xref="alg2.l1.m1.2.2.cmml">𝒚</mi><mo id="alg2.l1.m1.5.5.3.5" xref="alg2.l1.m1.5.5.4.cmml">,</mo><msubsup id="alg2.l1.m1.3.3.1.1" xref="alg2.l1.m1.3.3.1.1.cmml"><mrow id="alg2.l1.m1.3.3.1.1.1.1.1" xref="alg2.l1.m1.3.3.1.1.1.1.2.cmml"><mo id="alg2.l1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="alg2.l1.m1.3.3.1.1.1.1.2.cmml">{</mo><msub id="alg2.l1.m1.3.3.1.1.1.1.1.1" xref="alg2.l1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="alg2.l1.m1.3.3.1.1.1.1.1.1.2" xref="alg2.l1.m1.3.3.1.1.1.1.1.1.2.cmml">η</mi><mi id="alg2.l1.m1.3.3.1.1.1.1.1.1.3" xref="alg2.l1.m1.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="alg2.l1.m1.3.3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l1.m1.3.3.1.1.1.3" xref="alg2.l1.m1.3.3.1.1.1.3.cmml"><mi id="alg2.l1.m1.3.3.1.1.1.3.2" xref="alg2.l1.m1.3.3.1.1.1.3.2.cmml">t</mi><mo id="alg2.l1.m1.3.3.1.1.1.3.1" xref="alg2.l1.m1.3.3.1.1.1.3.1.cmml">=</mo><mn id="alg2.l1.m1.3.3.1.1.1.3.3" xref="alg2.l1.m1.3.3.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg2.l1.m1.3.3.1.1.3" xref="alg2.l1.m1.3.3.1.1.3.cmml">T</mi></msubsup><mo id="alg2.l1.m1.5.5.3.6" xref="alg2.l1.m1.5.5.4.cmml">,</mo><msubsup id="alg2.l1.m1.4.4.2.2" xref="alg2.l1.m1.4.4.2.2.cmml"><mrow id="alg2.l1.m1.4.4.2.2.1.1.1" xref="alg2.l1.m1.4.4.2.2.1.1.2.cmml"><mo id="alg2.l1.m1.4.4.2.2.1.1.1.2" stretchy="false" xref="alg2.l1.m1.4.4.2.2.1.1.2.cmml">{</mo><msub id="alg2.l1.m1.4.4.2.2.1.1.1.1" xref="alg2.l1.m1.4.4.2.2.1.1.1.1.cmml"><mi id="alg2.l1.m1.4.4.2.2.1.1.1.1.2" xref="alg2.l1.m1.4.4.2.2.1.1.1.1.2.cmml">γ</mi><mi id="alg2.l1.m1.4.4.2.2.1.1.1.1.3" xref="alg2.l1.m1.4.4.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l1.m1.4.4.2.2.1.1.1.3" stretchy="false" xref="alg2.l1.m1.4.4.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l1.m1.4.4.2.2.1.3" xref="alg2.l1.m1.4.4.2.2.1.3.cmml"><mi id="alg2.l1.m1.4.4.2.2.1.3.2" xref="alg2.l1.m1.4.4.2.2.1.3.2.cmml">t</mi><mo id="alg2.l1.m1.4.4.2.2.1.3.1" xref="alg2.l1.m1.4.4.2.2.1.3.1.cmml">=</mo><mn id="alg2.l1.m1.4.4.2.2.1.3.3" xref="alg2.l1.m1.4.4.2.2.1.3.3.cmml">1</mn></mrow><mi id="alg2.l1.m1.4.4.2.2.3" xref="alg2.l1.m1.4.4.2.2.3.cmml">T</mi></msubsup><mo id="alg2.l1.m1.5.5.3.7" xref="alg2.l1.m1.5.5.4.cmml">,</mo><msubsup id="alg2.l1.m1.5.5.3.3" xref="alg2.l1.m1.5.5.3.3.cmml"><mrow id="alg2.l1.m1.5.5.3.3.1.1.1" xref="alg2.l1.m1.5.5.3.3.1.1.2.cmml"><mo id="alg2.l1.m1.5.5.3.3.1.1.1.2" stretchy="false" xref="alg2.l1.m1.5.5.3.3.1.1.2.cmml">{</mo><msub id="alg2.l1.m1.5.5.3.3.1.1.1.1" xref="alg2.l1.m1.5.5.3.3.1.1.1.1.cmml"><mover accent="true" id="alg2.l1.m1.5.5.3.3.1.1.1.1.2" xref="alg2.l1.m1.5.5.3.3.1.1.1.1.2.cmml"><mi id="alg2.l1.m1.5.5.3.3.1.1.1.1.2.2" xref="alg2.l1.m1.5.5.3.3.1.1.1.1.2.2.cmml">σ</mi><mo id="alg2.l1.m1.5.5.3.3.1.1.1.1.2.1" xref="alg2.l1.m1.5.5.3.3.1.1.1.1.2.1.cmml">~</mo></mover><mi id="alg2.l1.m1.5.5.3.3.1.1.1.1.3" xref="alg2.l1.m1.5.5.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l1.m1.5.5.3.3.1.1.1.3" stretchy="false" xref="alg2.l1.m1.5.5.3.3.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l1.m1.5.5.3.3.1.3" xref="alg2.l1.m1.5.5.3.3.1.3.cmml"><mi id="alg2.l1.m1.5.5.3.3.1.3.2" xref="alg2.l1.m1.5.5.3.3.1.3.2.cmml">t</mi><mo id="alg2.l1.m1.5.5.3.3.1.3.1" xref="alg2.l1.m1.5.5.3.3.1.3.1.cmml">=</mo><mn id="alg2.l1.m1.5.5.3.3.1.3.3" xref="alg2.l1.m1.5.5.3.3.1.3.3.cmml">1</mn></mrow><mi id="alg2.l1.m1.5.5.3.3.3" xref="alg2.l1.m1.5.5.3.3.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.5b"><list id="alg2.l1.m1.5.5.4.cmml" xref="alg2.l1.m1.5.5.3"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝑇</ci><ci id="alg2.l1.m1.2.2.cmml" xref="alg2.l1.m1.2.2">𝒚</ci><apply id="alg2.l1.m1.3.3.1.1.cmml" xref="alg2.l1.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.3.3.1.1.2.cmml" xref="alg2.l1.m1.3.3.1.1">superscript</csymbol><apply id="alg2.l1.m1.3.3.1.1.1.cmml" xref="alg2.l1.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.3.3.1.1.1.2.cmml" xref="alg2.l1.m1.3.3.1.1">subscript</csymbol><set id="alg2.l1.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.1"><apply id="alg2.l1.m1.3.3.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.1.1.2">𝜂</ci><ci id="alg2.l1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="alg2.l1.m1.3.3.1.1.1.3.cmml" xref="alg2.l1.m1.3.3.1.1.1.3"><eq id="alg2.l1.m1.3.3.1.1.1.3.1.cmml" xref="alg2.l1.m1.3.3.1.1.1.3.1"></eq><ci id="alg2.l1.m1.3.3.1.1.1.3.2.cmml" xref="alg2.l1.m1.3.3.1.1.1.3.2">𝑡</ci><cn id="alg2.l1.m1.3.3.1.1.1.3.3.cmml" type="integer" xref="alg2.l1.m1.3.3.1.1.1.3.3">1</cn></apply></apply><ci id="alg2.l1.m1.3.3.1.1.3.cmml" xref="alg2.l1.m1.3.3.1.1.3">𝑇</ci></apply><apply id="alg2.l1.m1.4.4.2.2.cmml" xref="alg2.l1.m1.4.4.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.4.4.2.2.2.cmml" xref="alg2.l1.m1.4.4.2.2">superscript</csymbol><apply id="alg2.l1.m1.4.4.2.2.1.cmml" xref="alg2.l1.m1.4.4.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.4.4.2.2.1.2.cmml" xref="alg2.l1.m1.4.4.2.2">subscript</csymbol><set id="alg2.l1.m1.4.4.2.2.1.1.2.cmml" xref="alg2.l1.m1.4.4.2.2.1.1.1"><apply id="alg2.l1.m1.4.4.2.2.1.1.1.1.cmml" xref="alg2.l1.m1.4.4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.4.4.2.2.1.1.1.1.1.cmml" xref="alg2.l1.m1.4.4.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m1.4.4.2.2.1.1.1.1.2.cmml" xref="alg2.l1.m1.4.4.2.2.1.1.1.1.2">𝛾</ci><ci id="alg2.l1.m1.4.4.2.2.1.1.1.1.3.cmml" xref="alg2.l1.m1.4.4.2.2.1.1.1.1.3">𝑡</ci></apply></set><apply id="alg2.l1.m1.4.4.2.2.1.3.cmml" xref="alg2.l1.m1.4.4.2.2.1.3"><eq id="alg2.l1.m1.4.4.2.2.1.3.1.cmml" xref="alg2.l1.m1.4.4.2.2.1.3.1"></eq><ci id="alg2.l1.m1.4.4.2.2.1.3.2.cmml" xref="alg2.l1.m1.4.4.2.2.1.3.2">𝑡</ci><cn id="alg2.l1.m1.4.4.2.2.1.3.3.cmml" type="integer" xref="alg2.l1.m1.4.4.2.2.1.3.3">1</cn></apply></apply><ci id="alg2.l1.m1.4.4.2.2.3.cmml" xref="alg2.l1.m1.4.4.2.2.3">𝑇</ci></apply><apply id="alg2.l1.m1.5.5.3.3.cmml" xref="alg2.l1.m1.5.5.3.3"><csymbol cd="ambiguous" id="alg2.l1.m1.5.5.3.3.2.cmml" xref="alg2.l1.m1.5.5.3.3">superscript</csymbol><apply id="alg2.l1.m1.5.5.3.3.1.cmml" xref="alg2.l1.m1.5.5.3.3"><csymbol cd="ambiguous" id="alg2.l1.m1.5.5.3.3.1.2.cmml" xref="alg2.l1.m1.5.5.3.3">subscript</csymbol><set id="alg2.l1.m1.5.5.3.3.1.1.2.cmml" xref="alg2.l1.m1.5.5.3.3.1.1.1"><apply id="alg2.l1.m1.5.5.3.3.1.1.1.1.cmml" xref="alg2.l1.m1.5.5.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.5.5.3.3.1.1.1.1.1.cmml" xref="alg2.l1.m1.5.5.3.3.1.1.1.1">subscript</csymbol><apply id="alg2.l1.m1.5.5.3.3.1.1.1.1.2.cmml" xref="alg2.l1.m1.5.5.3.3.1.1.1.1.2"><ci id="alg2.l1.m1.5.5.3.3.1.1.1.1.2.1.cmml" xref="alg2.l1.m1.5.5.3.3.1.1.1.1.2.1">~</ci><ci id="alg2.l1.m1.5.5.3.3.1.1.1.1.2.2.cmml" xref="alg2.l1.m1.5.5.3.3.1.1.1.1.2.2">𝜎</ci></apply><ci id="alg2.l1.m1.5.5.3.3.1.1.1.1.3.cmml" xref="alg2.l1.m1.5.5.3.3.1.1.1.1.3">𝑡</ci></apply></set><apply id="alg2.l1.m1.5.5.3.3.1.3.cmml" xref="alg2.l1.m1.5.5.3.3.1.3"><eq id="alg2.l1.m1.5.5.3.3.1.3.1.cmml" xref="alg2.l1.m1.5.5.3.3.1.3.1"></eq><ci id="alg2.l1.m1.5.5.3.3.1.3.2.cmml" xref="alg2.l1.m1.5.5.3.3.1.3.2">𝑡</ci><cn id="alg2.l1.m1.5.5.3.3.1.3.3.cmml" type="integer" xref="alg2.l1.m1.5.5.3.3.1.3.3">1</cn></apply></apply><ci id="alg2.l1.m1.5.5.3.3.3.cmml" xref="alg2.l1.m1.5.5.3.3.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.5c">T,\bm{y},\{\eta_{t}\}_{t=1}^{T},\{\gamma_{t}\}_{t=1}^{T},\{\tilde{\sigma}_{t}%
\}_{t=1}^{T}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.5d">italic_T , bold_italic_y , { italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT , { italic_γ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT , { over~ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><math alttext="\mathcal{E},\mathcal{D},\mathcal{A}{\bm{x}}_{0}^{\ast},\mathcal{A},\bm{s}_{%
\theta}," class="ltx_Math" display="inline" id="alg2.l2.m1.4"><semantics id="alg2.l2.m1.4a"><mrow id="alg2.l2.m1.4.4.1"><mrow id="alg2.l2.m1.4.4.1.1.2" xref="alg2.l2.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">ℰ</mi><mo id="alg2.l2.m1.4.4.1.1.2.3" xref="alg2.l2.m1.4.4.1.1.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.2.2" xref="alg2.l2.m1.2.2.cmml">𝒟</mi><mo id="alg2.l2.m1.4.4.1.1.2.4" xref="alg2.l2.m1.4.4.1.1.3.cmml">,</mo><mrow id="alg2.l2.m1.4.4.1.1.1.1" xref="alg2.l2.m1.4.4.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.4.4.1.1.1.1.2" xref="alg2.l2.m1.4.4.1.1.1.1.2.cmml">𝒜</mi><mo id="alg2.l2.m1.4.4.1.1.1.1.1" xref="alg2.l2.m1.4.4.1.1.1.1.1.cmml">⁢</mo><msubsup id="alg2.l2.m1.4.4.1.1.1.1.3" xref="alg2.l2.m1.4.4.1.1.1.1.3.cmml"><mi id="alg2.l2.m1.4.4.1.1.1.1.3.2.2" xref="alg2.l2.m1.4.4.1.1.1.1.3.2.2.cmml">𝒙</mi><mn id="alg2.l2.m1.4.4.1.1.1.1.3.2.3" xref="alg2.l2.m1.4.4.1.1.1.1.3.2.3.cmml">0</mn><mo id="alg2.l2.m1.4.4.1.1.1.1.3.3" xref="alg2.l2.m1.4.4.1.1.1.1.3.3.cmml">∗</mo></msubsup></mrow><mo id="alg2.l2.m1.4.4.1.1.2.5" xref="alg2.l2.m1.4.4.1.1.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.3.3" xref="alg2.l2.m1.3.3.cmml">𝒜</mi><mo id="alg2.l2.m1.4.4.1.1.2.6" xref="alg2.l2.m1.4.4.1.1.3.cmml">,</mo><msub id="alg2.l2.m1.4.4.1.1.2.2" xref="alg2.l2.m1.4.4.1.1.2.2.cmml"><mi id="alg2.l2.m1.4.4.1.1.2.2.2" xref="alg2.l2.m1.4.4.1.1.2.2.2.cmml">𝒔</mi><mi id="alg2.l2.m1.4.4.1.1.2.2.3" xref="alg2.l2.m1.4.4.1.1.2.2.3.cmml">θ</mi></msub></mrow><mo id="alg2.l2.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.4b"><list id="alg2.l2.m1.4.4.1.1.3.cmml" xref="alg2.l2.m1.4.4.1.1.2"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">ℰ</ci><ci id="alg2.l2.m1.2.2.cmml" xref="alg2.l2.m1.2.2">𝒟</ci><apply id="alg2.l2.m1.4.4.1.1.1.1.cmml" xref="alg2.l2.m1.4.4.1.1.1.1"><times id="alg2.l2.m1.4.4.1.1.1.1.1.cmml" xref="alg2.l2.m1.4.4.1.1.1.1.1"></times><ci id="alg2.l2.m1.4.4.1.1.1.1.2.cmml" xref="alg2.l2.m1.4.4.1.1.1.1.2">𝒜</ci><apply id="alg2.l2.m1.4.4.1.1.1.1.3.cmml" xref="alg2.l2.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l2.m1.4.4.1.1.1.1.3.1.cmml" xref="alg2.l2.m1.4.4.1.1.1.1.3">superscript</csymbol><apply id="alg2.l2.m1.4.4.1.1.1.1.3.2.cmml" xref="alg2.l2.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l2.m1.4.4.1.1.1.1.3.2.1.cmml" xref="alg2.l2.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="alg2.l2.m1.4.4.1.1.1.1.3.2.2.cmml" xref="alg2.l2.m1.4.4.1.1.1.1.3.2.2">𝒙</ci><cn id="alg2.l2.m1.4.4.1.1.1.1.3.2.3.cmml" type="integer" xref="alg2.l2.m1.4.4.1.1.1.1.3.2.3">0</cn></apply><ci id="alg2.l2.m1.4.4.1.1.1.1.3.3.cmml" xref="alg2.l2.m1.4.4.1.1.1.1.3.3">∗</ci></apply></apply><ci id="alg2.l2.m1.3.3.cmml" xref="alg2.l2.m1.3.3">𝒜</ci><apply id="alg2.l2.m1.4.4.1.1.2.2.cmml" xref="alg2.l2.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.4.4.1.1.2.2.1.cmml" xref="alg2.l2.m1.4.4.1.1.2.2">subscript</csymbol><ci id="alg2.l2.m1.4.4.1.1.2.2.2.cmml" xref="alg2.l2.m1.4.4.1.1.2.2.2">𝒔</ci><ci id="alg2.l2.m1.4.4.1.1.2.2.3.cmml" xref="alg2.l2.m1.4.4.1.1.2.2.3">𝜃</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.4c">\mathcal{E},\mathcal{D},\mathcal{A}{\bm{x}}_{0}^{\ast},\mathcal{A},\bm{s}_{%
\theta},</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.4d">caligraphic_E , caligraphic_D , caligraphic_A bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , caligraphic_A , bold_italic_s start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ,</annotation></semantics></math><span class="ltx_text" id="alg2.l2.1" style="color:#0000FF;">variance retention threshold <math alttext="\tau" class="ltx_Math" display="inline" id="alg2.l2.1.m1.1"><semantics id="alg2.l2.1.m1.1a"><mi id="alg2.l2.1.m1.1.1" mathcolor="#0000FF" xref="alg2.l2.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.1.m1.1b"><ci id="alg2.l2.1.m1.1.1.cmml" xref="alg2.l2.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.1.m1.1d">italic_τ</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><math alttext="{\bm{z}}_{T}\sim\mathcal{N}(\bm{0},\bm{I})" class="ltx_Math" display="inline" id="alg2.l3.m1.2"><semantics id="alg2.l3.m1.2a"><mrow id="alg2.l3.m1.2.3" xref="alg2.l3.m1.2.3.cmml"><msub id="alg2.l3.m1.2.3.2" xref="alg2.l3.m1.2.3.2.cmml"><mi id="alg2.l3.m1.2.3.2.2" xref="alg2.l3.m1.2.3.2.2.cmml">𝒛</mi><mi id="alg2.l3.m1.2.3.2.3" xref="alg2.l3.m1.2.3.2.3.cmml">T</mi></msub><mo id="alg2.l3.m1.2.3.1" xref="alg2.l3.m1.2.3.1.cmml">∼</mo><mrow id="alg2.l3.m1.2.3.3" xref="alg2.l3.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.2.3.3.2" xref="alg2.l3.m1.2.3.3.2.cmml">𝒩</mi><mo id="alg2.l3.m1.2.3.3.1" xref="alg2.l3.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg2.l3.m1.2.3.3.3.2" xref="alg2.l3.m1.2.3.3.3.1.cmml"><mo id="alg2.l3.m1.2.3.3.3.2.1" stretchy="false" xref="alg2.l3.m1.2.3.3.3.1.cmml">(</mo><mn id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">𝟎</mn><mo id="alg2.l3.m1.2.3.3.3.2.2" xref="alg2.l3.m1.2.3.3.3.1.cmml">,</mo><mi id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml">𝑰</mi><mo id="alg2.l3.m1.2.3.3.3.2.3" stretchy="false" xref="alg2.l3.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.2b"><apply id="alg2.l3.m1.2.3.cmml" xref="alg2.l3.m1.2.3"><csymbol cd="latexml" id="alg2.l3.m1.2.3.1.cmml" xref="alg2.l3.m1.2.3.1">similar-to</csymbol><apply id="alg2.l3.m1.2.3.2.cmml" xref="alg2.l3.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l3.m1.2.3.2.1.cmml" xref="alg2.l3.m1.2.3.2">subscript</csymbol><ci id="alg2.l3.m1.2.3.2.2.cmml" xref="alg2.l3.m1.2.3.2.2">𝒛</ci><ci id="alg2.l3.m1.2.3.2.3.cmml" xref="alg2.l3.m1.2.3.2.3">𝑇</ci></apply><apply id="alg2.l3.m1.2.3.3.cmml" xref="alg2.l3.m1.2.3.3"><times id="alg2.l3.m1.2.3.3.1.cmml" xref="alg2.l3.m1.2.3.3.1"></times><ci id="alg2.l3.m1.2.3.3.2.cmml" xref="alg2.l3.m1.2.3.3.2">𝒩</ci><interval closure="open" id="alg2.l3.m1.2.3.3.3.1.cmml" xref="alg2.l3.m1.2.3.3.3.2"><cn id="alg2.l3.m1.1.1.cmml" type="integer" xref="alg2.l3.m1.1.1">0</cn><ci id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.2c">{\bm{z}}_{T}\sim\mathcal{N}(\bm{0},\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.2d">bold_italic_z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∼ caligraphic_N ( bold_0 , bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span><span class="ltx_text ltx_font_bold" id="alg2.l4.1">for</span> <math alttext="t=T-1" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">t</mi><mo id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">=</mo><mrow id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml"><mi id="alg2.l4.m1.1.1.3.2" xref="alg2.l4.m1.1.1.3.2.cmml">T</mi><mo id="alg2.l4.m1.1.1.3.1" xref="alg2.l4.m1.1.1.3.1.cmml">−</mo><mn id="alg2.l4.m1.1.1.3.3" xref="alg2.l4.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><eq id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"></eq><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝑡</ci><apply id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"><minus id="alg2.l4.m1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.3.1"></minus><ci id="alg2.l4.m1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.3.2">𝑇</ci><cn id="alg2.l4.m1.1.1.3.3.cmml" type="integer" xref="alg2.l4.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">t=T-1</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">italic_t = italic_T - 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l4.2">to</span> <math alttext="0" class="ltx_Math" display="inline" id="alg2.l4.m2.1"><semantics id="alg2.l4.m2.1a"><mn id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><cn id="alg2.l4.m2.1.1.cmml" type="integer" xref="alg2.l4.m2.1.1">0</cn></annotation-xml></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l4.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math alttext="\hat{\bm{s}}\leftarrow\bm{s}_{\theta}({\bm{z}}_{t},t)" class="ltx_Math" display="inline" id="alg2.l5.m1.2"><semantics id="alg2.l5.m1.2a"><mrow id="alg2.l5.m1.2.2" xref="alg2.l5.m1.2.2.cmml"><mover accent="true" id="alg2.l5.m1.2.2.3" xref="alg2.l5.m1.2.2.3.cmml"><mi id="alg2.l5.m1.2.2.3.2" xref="alg2.l5.m1.2.2.3.2.cmml">𝒔</mi><mo id="alg2.l5.m1.2.2.3.1" xref="alg2.l5.m1.2.2.3.1.cmml">^</mo></mover><mo id="alg2.l5.m1.2.2.2" stretchy="false" xref="alg2.l5.m1.2.2.2.cmml">←</mo><mrow id="alg2.l5.m1.2.2.1" xref="alg2.l5.m1.2.2.1.cmml"><msub id="alg2.l5.m1.2.2.1.3" xref="alg2.l5.m1.2.2.1.3.cmml"><mi id="alg2.l5.m1.2.2.1.3.2" xref="alg2.l5.m1.2.2.1.3.2.cmml">𝒔</mi><mi id="alg2.l5.m1.2.2.1.3.3" xref="alg2.l5.m1.2.2.1.3.3.cmml">θ</mi></msub><mo id="alg2.l5.m1.2.2.1.2" xref="alg2.l5.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg2.l5.m1.2.2.1.1.1" xref="alg2.l5.m1.2.2.1.1.2.cmml"><mo id="alg2.l5.m1.2.2.1.1.1.2" stretchy="false" xref="alg2.l5.m1.2.2.1.1.2.cmml">(</mo><msub id="alg2.l5.m1.2.2.1.1.1.1" xref="alg2.l5.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l5.m1.2.2.1.1.1.1.2" xref="alg2.l5.m1.2.2.1.1.1.1.2.cmml">𝒛</mi><mi id="alg2.l5.m1.2.2.1.1.1.1.3" xref="alg2.l5.m1.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l5.m1.2.2.1.1.1.3" xref="alg2.l5.m1.2.2.1.1.2.cmml">,</mo><mi id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">t</mi><mo id="alg2.l5.m1.2.2.1.1.1.4" stretchy="false" xref="alg2.l5.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.2.cmml" xref="alg2.l5.m1.2.2"><ci id="alg2.l5.m1.2.2.2.cmml" xref="alg2.l5.m1.2.2.2">←</ci><apply id="alg2.l5.m1.2.2.3.cmml" xref="alg2.l5.m1.2.2.3"><ci id="alg2.l5.m1.2.2.3.1.cmml" xref="alg2.l5.m1.2.2.3.1">^</ci><ci id="alg2.l5.m1.2.2.3.2.cmml" xref="alg2.l5.m1.2.2.3.2">𝒔</ci></apply><apply id="alg2.l5.m1.2.2.1.cmml" xref="alg2.l5.m1.2.2.1"><times id="alg2.l5.m1.2.2.1.2.cmml" xref="alg2.l5.m1.2.2.1.2"></times><apply id="alg2.l5.m1.2.2.1.3.cmml" xref="alg2.l5.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.3.1.cmml" xref="alg2.l5.m1.2.2.1.3">subscript</csymbol><ci id="alg2.l5.m1.2.2.1.3.2.cmml" xref="alg2.l5.m1.2.2.1.3.2">𝒔</ci><ci id="alg2.l5.m1.2.2.1.3.3.cmml" xref="alg2.l5.m1.2.2.1.3.3">𝜃</ci></apply><interval closure="open" id="alg2.l5.m1.2.2.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1"><apply id="alg2.l5.m1.2.2.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.2">𝒛</ci><ci id="alg2.l5.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">𝑡</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">\hat{\bm{s}}\leftarrow\bm{s}_{\theta}({\bm{z}}_{t},t)</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.2d">over^ start_ARG bold_italic_s end_ARG ← bold_italic_s start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math alttext="\hat{{\bm{z}}}_{0}\leftarrow\frac{1}{\sqrt{\bar{\alpha_{t}}}}({\bm{z}}_{t}+(1-%
\bar{\alpha_{t}})\hat{\bm{s}})" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><msub id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml"><mover accent="true" id="alg2.l6.m1.1.1.3.2" xref="alg2.l6.m1.1.1.3.2.cmml"><mi id="alg2.l6.m1.1.1.3.2.2" xref="alg2.l6.m1.1.1.3.2.2.cmml">𝒛</mi><mo id="alg2.l6.m1.1.1.3.2.1" xref="alg2.l6.m1.1.1.3.2.1.cmml">^</mo></mover><mn id="alg2.l6.m1.1.1.3.3" xref="alg2.l6.m1.1.1.3.3.cmml">0</mn></msub><mo id="alg2.l6.m1.1.1.2" stretchy="false" xref="alg2.l6.m1.1.1.2.cmml">←</mo><mrow id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml"><mfrac id="alg2.l6.m1.1.1.1.3" xref="alg2.l6.m1.1.1.1.3.cmml"><mn id="alg2.l6.m1.1.1.1.3.2" xref="alg2.l6.m1.1.1.1.3.2.cmml">1</mn><msqrt id="alg2.l6.m1.1.1.1.3.3" xref="alg2.l6.m1.1.1.1.3.3.cmml"><mover accent="true" id="alg2.l6.m1.1.1.1.3.3.2" xref="alg2.l6.m1.1.1.1.3.3.2.cmml"><msub id="alg2.l6.m1.1.1.1.3.3.2.2" xref="alg2.l6.m1.1.1.1.3.3.2.2.cmml"><mi id="alg2.l6.m1.1.1.1.3.3.2.2.2" xref="alg2.l6.m1.1.1.1.3.3.2.2.2.cmml">α</mi><mi id="alg2.l6.m1.1.1.1.3.3.2.2.3" xref="alg2.l6.m1.1.1.1.3.3.2.2.3.cmml">t</mi></msub><mo id="alg2.l6.m1.1.1.1.3.3.2.1" xref="alg2.l6.m1.1.1.1.3.3.2.1.cmml">¯</mo></mover></msqrt></mfrac><mo id="alg2.l6.m1.1.1.1.2" xref="alg2.l6.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l6.m1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.cmml"><mo id="alg2.l6.m1.1.1.1.1.1.2" stretchy="false" xref="alg2.l6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l6.m1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.cmml"><msub id="alg2.l6.m1.1.1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l6.m1.1.1.1.1.1.1.3.2" xref="alg2.l6.m1.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="alg2.l6.m1.1.1.1.1.1.1.3.3" xref="alg2.l6.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="alg2.l6.m1.1.1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="alg2.l6.m1.1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.1.cmml"><mrow id="alg2.l6.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">α</mi><mi id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi></msub><mo id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.l6.m1.1.1.1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mover accent="true" id="alg2.l6.m1.1.1.1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l6.m1.1.1.1.1.1.1.1.3.2" xref="alg2.l6.m1.1.1.1.1.1.1.1.3.2.cmml">𝒔</mi><mo id="alg2.l6.m1.1.1.1.1.1.1.1.3.1" xref="alg2.l6.m1.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow></mrow><mo id="alg2.l6.m1.1.1.1.1.1.3" stretchy="false" xref="alg2.l6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><ci id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">←</ci><apply id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.3">subscript</csymbol><apply id="alg2.l6.m1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.3.2"><ci id="alg2.l6.m1.1.1.3.2.1.cmml" xref="alg2.l6.m1.1.1.3.2.1">^</ci><ci id="alg2.l6.m1.1.1.3.2.2.cmml" xref="alg2.l6.m1.1.1.3.2.2">𝒛</ci></apply><cn id="alg2.l6.m1.1.1.3.3.cmml" type="integer" xref="alg2.l6.m1.1.1.3.3">0</cn></apply><apply id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1"><times id="alg2.l6.m1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.2"></times><apply id="alg2.l6.m1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.3"><divide id="alg2.l6.m1.1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.1.3"></divide><cn id="alg2.l6.m1.1.1.1.3.2.cmml" type="integer" xref="alg2.l6.m1.1.1.1.3.2">1</cn><apply id="alg2.l6.m1.1.1.1.3.3.cmml" xref="alg2.l6.m1.1.1.1.3.3"><root id="alg2.l6.m1.1.1.1.3.3a.cmml" xref="alg2.l6.m1.1.1.1.3.3"></root><apply id="alg2.l6.m1.1.1.1.3.3.2.cmml" xref="alg2.l6.m1.1.1.1.3.3.2"><ci id="alg2.l6.m1.1.1.1.3.3.2.1.cmml" xref="alg2.l6.m1.1.1.1.3.3.2.1">¯</ci><apply id="alg2.l6.m1.1.1.1.3.3.2.2.cmml" xref="alg2.l6.m1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.3.3.2.2.1.cmml" xref="alg2.l6.m1.1.1.1.3.3.2.2">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.3.3.2.2.2.cmml" xref="alg2.l6.m1.1.1.1.3.3.2.2.2">𝛼</ci><ci id="alg2.l6.m1.1.1.1.3.3.2.2.3.cmml" xref="alg2.l6.m1.1.1.1.3.3.2.2.3">𝑡</ci></apply></apply></apply></apply><apply id="alg2.l6.m1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1"><plus id="alg2.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.2"></plus><apply id="alg2.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.3.2">𝒛</ci><ci id="alg2.l6.m1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="alg2.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1"><times id="alg2.l6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.2"></times><apply id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1"><minus id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3"><ci id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.1">¯</ci><apply id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝛼</ci><ci id="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply></apply></apply><apply id="alg2.l6.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.3"><ci id="alg2.l6.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.3.1">^</ci><ci id="alg2.l6.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.3.2">𝒔</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\hat{{\bm{z}}}_{0}\leftarrow\frac{1}{\sqrt{\bar{\alpha_{t}}}}({\bm{z}}_{t}+(1-%
\bar{\alpha_{t}})\hat{\bm{s}})</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← divide start_ARG 1 end_ARG start_ARG square-root start_ARG over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG end_ARG ( bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + ( 1 - over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG ) over^ start_ARG bold_italic_s end_ARG )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math alttext="\bm{\epsilon}\sim\mathcal{N}(\bm{0},\bm{I})" class="ltx_Math" display="inline" id="alg2.l7.m1.2"><semantics id="alg2.l7.m1.2a"><mrow id="alg2.l7.m1.2.3" xref="alg2.l7.m1.2.3.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg2.l7.m1.2.3.2" mathvariant="bold-italic" xref="alg2.l7.m1.2.3.2.cmml">ϵ</mi><mo id="alg2.l7.m1.2.3.1" xref="alg2.l7.m1.2.3.1.cmml">∼</mo><mrow id="alg2.l7.m1.2.3.3" xref="alg2.l7.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.2.3.3.2" xref="alg2.l7.m1.2.3.3.2.cmml">𝒩</mi><mo id="alg2.l7.m1.2.3.3.1" xref="alg2.l7.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg2.l7.m1.2.3.3.3.2" xref="alg2.l7.m1.2.3.3.3.1.cmml"><mo id="alg2.l7.m1.2.3.3.3.2.1" stretchy="false" xref="alg2.l7.m1.2.3.3.3.1.cmml">(</mo><mn id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">𝟎</mn><mo id="alg2.l7.m1.2.3.3.3.2.2" xref="alg2.l7.m1.2.3.3.3.1.cmml">,</mo><mi id="alg2.l7.m1.2.2" xref="alg2.l7.m1.2.2.cmml">𝑰</mi><mo id="alg2.l7.m1.2.3.3.3.2.3" stretchy="false" xref="alg2.l7.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.2b"><apply id="alg2.l7.m1.2.3.cmml" xref="alg2.l7.m1.2.3"><csymbol cd="latexml" id="alg2.l7.m1.2.3.1.cmml" xref="alg2.l7.m1.2.3.1">similar-to</csymbol><ci id="alg2.l7.m1.2.3.2.cmml" xref="alg2.l7.m1.2.3.2">bold-italic-ϵ</ci><apply id="alg2.l7.m1.2.3.3.cmml" xref="alg2.l7.m1.2.3.3"><times id="alg2.l7.m1.2.3.3.1.cmml" xref="alg2.l7.m1.2.3.3.1"></times><ci id="alg2.l7.m1.2.3.3.2.cmml" xref="alg2.l7.m1.2.3.3.2">𝒩</ci><interval closure="open" id="alg2.l7.m1.2.3.3.3.1.cmml" xref="alg2.l7.m1.2.3.3.3.2"><cn id="alg2.l7.m1.1.1.cmml" type="integer" xref="alg2.l7.m1.1.1">0</cn><ci id="alg2.l7.m1.2.2.cmml" xref="alg2.l7.m1.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.2c">\bm{\epsilon}\sim\mathcal{N}(\bm{0},\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.2d">bold_italic_ϵ ∼ caligraphic_N ( bold_0 , bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math alttext="{\bm{z}}^{\prime}_{t-1}\leftarrow\frac{\sqrt{\alpha_{t}}(1-\bar{\alpha}_{t-1})%
}{1-\bar{\alpha}_{t}}{\bm{z}}_{t}+\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_{t}}{1-%
\bar{\alpha}_{t}}\hat{{\bm{z}}}_{0}+\tilde{\sigma}_{t}\bm{\epsilon}" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.2" xref="alg2.l8.m1.1.2.cmml"><msubsup id="alg2.l8.m1.1.2.2" xref="alg2.l8.m1.1.2.2.cmml"><mi id="alg2.l8.m1.1.2.2.2.2" xref="alg2.l8.m1.1.2.2.2.2.cmml">𝒛</mi><mrow id="alg2.l8.m1.1.2.2.3" xref="alg2.l8.m1.1.2.2.3.cmml"><mi id="alg2.l8.m1.1.2.2.3.2" xref="alg2.l8.m1.1.2.2.3.2.cmml">t</mi><mo id="alg2.l8.m1.1.2.2.3.1" xref="alg2.l8.m1.1.2.2.3.1.cmml">−</mo><mn id="alg2.l8.m1.1.2.2.3.3" xref="alg2.l8.m1.1.2.2.3.3.cmml">1</mn></mrow><mo id="alg2.l8.m1.1.2.2.2.3" xref="alg2.l8.m1.1.2.2.2.3.cmml">′</mo></msubsup><mo id="alg2.l8.m1.1.2.1" stretchy="false" xref="alg2.l8.m1.1.2.1.cmml">←</mo><mrow id="alg2.l8.m1.1.2.3" xref="alg2.l8.m1.1.2.3.cmml"><mrow id="alg2.l8.m1.1.2.3.2" xref="alg2.l8.m1.1.2.3.2.cmml"><mfrac id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mrow id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml"><msqrt id="alg2.l8.m1.1.1.1.3" xref="alg2.l8.m1.1.1.1.3.cmml"><msub id="alg2.l8.m1.1.1.1.3.2" xref="alg2.l8.m1.1.1.1.3.2.cmml"><mi id="alg2.l8.m1.1.1.1.3.2.2" xref="alg2.l8.m1.1.1.1.3.2.2.cmml">α</mi><mi id="alg2.l8.m1.1.1.1.3.2.3" xref="alg2.l8.m1.1.1.1.3.2.3.cmml">t</mi></msub></msqrt><mo id="alg2.l8.m1.1.1.1.2" xref="alg2.l8.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l8.m1.1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.1.1.cmml"><mo id="alg2.l8.m1.1.1.1.1.1.2" stretchy="false" xref="alg2.l8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l8.m1.1.1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.1.1.cmml"><mn id="alg2.l8.m1.1.1.1.1.1.1.2" xref="alg2.l8.m1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg2.l8.m1.1.1.1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg2.l8.m1.1.1.1.1.1.1.3" xref="alg2.l8.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg2.l8.m1.1.1.1.1.1.1.3.2" xref="alg2.l8.m1.1.1.1.1.1.1.3.2.cmml"><mi id="alg2.l8.m1.1.1.1.1.1.1.3.2.2" xref="alg2.l8.m1.1.1.1.1.1.1.3.2.2.cmml">α</mi><mo id="alg2.l8.m1.1.1.1.1.1.1.3.2.1" xref="alg2.l8.m1.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="alg2.l8.m1.1.1.1.1.1.1.3.3" xref="alg2.l8.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg2.l8.m1.1.1.1.1.1.1.3.3.2" xref="alg2.l8.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg2.l8.m1.1.1.1.1.1.1.3.3.1" xref="alg2.l8.m1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="alg2.l8.m1.1.1.1.1.1.1.3.3.3" xref="alg2.l8.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg2.l8.m1.1.1.1.1.1.3" stretchy="false" xref="alg2.l8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml"><mn id="alg2.l8.m1.1.1.3.2" xref="alg2.l8.m1.1.1.3.2.cmml">1</mn><mo id="alg2.l8.m1.1.1.3.1" xref="alg2.l8.m1.1.1.3.1.cmml">−</mo><msub id="alg2.l8.m1.1.1.3.3" xref="alg2.l8.m1.1.1.3.3.cmml"><mover accent="true" id="alg2.l8.m1.1.1.3.3.2" xref="alg2.l8.m1.1.1.3.3.2.cmml"><mi id="alg2.l8.m1.1.1.3.3.2.2" xref="alg2.l8.m1.1.1.3.3.2.2.cmml">α</mi><mo id="alg2.l8.m1.1.1.3.3.2.1" xref="alg2.l8.m1.1.1.3.3.2.1.cmml">¯</mo></mover><mi id="alg2.l8.m1.1.1.3.3.3" xref="alg2.l8.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mfrac><mo id="alg2.l8.m1.1.2.3.2.1" xref="alg2.l8.m1.1.2.3.2.1.cmml">⁢</mo><msub id="alg2.l8.m1.1.2.3.2.2" xref="alg2.l8.m1.1.2.3.2.2.cmml"><mi id="alg2.l8.m1.1.2.3.2.2.2" xref="alg2.l8.m1.1.2.3.2.2.2.cmml">𝒛</mi><mi id="alg2.l8.m1.1.2.3.2.2.3" xref="alg2.l8.m1.1.2.3.2.2.3.cmml">t</mi></msub></mrow><mo id="alg2.l8.m1.1.2.3.1" xref="alg2.l8.m1.1.2.3.1.cmml">+</mo><mrow id="alg2.l8.m1.1.2.3.3" xref="alg2.l8.m1.1.2.3.3.cmml"><mfrac id="alg2.l8.m1.1.2.3.3.2" xref="alg2.l8.m1.1.2.3.3.2.cmml"><mrow id="alg2.l8.m1.1.2.3.3.2.2" xref="alg2.l8.m1.1.2.3.3.2.2.cmml"><msqrt id="alg2.l8.m1.1.2.3.3.2.2.2" xref="alg2.l8.m1.1.2.3.3.2.2.2.cmml"><msub id="alg2.l8.m1.1.2.3.3.2.2.2.2" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.cmml"><mover accent="true" id="alg2.l8.m1.1.2.3.3.2.2.2.2.2" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.2.cmml"><mi id="alg2.l8.m1.1.2.3.3.2.2.2.2.2.2" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.2.2.cmml">α</mi><mo id="alg2.l8.m1.1.2.3.3.2.2.2.2.2.1" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.2.1.cmml">¯</mo></mover><mrow id="alg2.l8.m1.1.2.3.3.2.2.2.2.3" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.3.cmml"><mi id="alg2.l8.m1.1.2.3.3.2.2.2.2.3.2" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.3.2.cmml">t</mi><mo id="alg2.l8.m1.1.2.3.3.2.2.2.2.3.1" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.3.1.cmml">−</mo><mn id="alg2.l8.m1.1.2.3.3.2.2.2.2.3.3" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.3.3.cmml">1</mn></mrow></msub></msqrt><mo id="alg2.l8.m1.1.2.3.3.2.2.1" xref="alg2.l8.m1.1.2.3.3.2.2.1.cmml">⁢</mo><msub id="alg2.l8.m1.1.2.3.3.2.2.3" xref="alg2.l8.m1.1.2.3.3.2.2.3.cmml"><mi id="alg2.l8.m1.1.2.3.3.2.2.3.2" xref="alg2.l8.m1.1.2.3.3.2.2.3.2.cmml">β</mi><mi id="alg2.l8.m1.1.2.3.3.2.2.3.3" xref="alg2.l8.m1.1.2.3.3.2.2.3.3.cmml">t</mi></msub></mrow><mrow id="alg2.l8.m1.1.2.3.3.2.3" xref="alg2.l8.m1.1.2.3.3.2.3.cmml"><mn id="alg2.l8.m1.1.2.3.3.2.3.2" xref="alg2.l8.m1.1.2.3.3.2.3.2.cmml">1</mn><mo id="alg2.l8.m1.1.2.3.3.2.3.1" xref="alg2.l8.m1.1.2.3.3.2.3.1.cmml">−</mo><msub id="alg2.l8.m1.1.2.3.3.2.3.3" xref="alg2.l8.m1.1.2.3.3.2.3.3.cmml"><mover accent="true" id="alg2.l8.m1.1.2.3.3.2.3.3.2" xref="alg2.l8.m1.1.2.3.3.2.3.3.2.cmml"><mi id="alg2.l8.m1.1.2.3.3.2.3.3.2.2" xref="alg2.l8.m1.1.2.3.3.2.3.3.2.2.cmml">α</mi><mo id="alg2.l8.m1.1.2.3.3.2.3.3.2.1" xref="alg2.l8.m1.1.2.3.3.2.3.3.2.1.cmml">¯</mo></mover><mi id="alg2.l8.m1.1.2.3.3.2.3.3.3" xref="alg2.l8.m1.1.2.3.3.2.3.3.3.cmml">t</mi></msub></mrow></mfrac><mo id="alg2.l8.m1.1.2.3.3.1" xref="alg2.l8.m1.1.2.3.3.1.cmml">⁢</mo><msub id="alg2.l8.m1.1.2.3.3.3" xref="alg2.l8.m1.1.2.3.3.3.cmml"><mover accent="true" id="alg2.l8.m1.1.2.3.3.3.2" xref="alg2.l8.m1.1.2.3.3.3.2.cmml"><mi id="alg2.l8.m1.1.2.3.3.3.2.2" xref="alg2.l8.m1.1.2.3.3.3.2.2.cmml">𝒛</mi><mo id="alg2.l8.m1.1.2.3.3.3.2.1" xref="alg2.l8.m1.1.2.3.3.3.2.1.cmml">^</mo></mover><mn id="alg2.l8.m1.1.2.3.3.3.3" xref="alg2.l8.m1.1.2.3.3.3.3.cmml">0</mn></msub></mrow><mo id="alg2.l8.m1.1.2.3.1a" xref="alg2.l8.m1.1.2.3.1.cmml">+</mo><mrow id="alg2.l8.m1.1.2.3.4" xref="alg2.l8.m1.1.2.3.4.cmml"><msub id="alg2.l8.m1.1.2.3.4.2" xref="alg2.l8.m1.1.2.3.4.2.cmml"><mover accent="true" id="alg2.l8.m1.1.2.3.4.2.2" xref="alg2.l8.m1.1.2.3.4.2.2.cmml"><mi id="alg2.l8.m1.1.2.3.4.2.2.2" xref="alg2.l8.m1.1.2.3.4.2.2.2.cmml">σ</mi><mo id="alg2.l8.m1.1.2.3.4.2.2.1" xref="alg2.l8.m1.1.2.3.4.2.2.1.cmml">~</mo></mover><mi id="alg2.l8.m1.1.2.3.4.2.3" xref="alg2.l8.m1.1.2.3.4.2.3.cmml">t</mi></msub><mo id="alg2.l8.m1.1.2.3.4.1" xref="alg2.l8.m1.1.2.3.4.1.cmml">⁢</mo><mi class="ltx_mathvariant_bold-italic" id="alg2.l8.m1.1.2.3.4.3" mathvariant="bold-italic" xref="alg2.l8.m1.1.2.3.4.3.cmml">ϵ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.2.cmml" xref="alg2.l8.m1.1.2"><ci id="alg2.l8.m1.1.2.1.cmml" xref="alg2.l8.m1.1.2.1">←</ci><apply id="alg2.l8.m1.1.2.2.cmml" xref="alg2.l8.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.2.2.1.cmml" xref="alg2.l8.m1.1.2.2">subscript</csymbol><apply id="alg2.l8.m1.1.2.2.2.cmml" xref="alg2.l8.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.2.2.2.1.cmml" xref="alg2.l8.m1.1.2.2">superscript</csymbol><ci id="alg2.l8.m1.1.2.2.2.2.cmml" xref="alg2.l8.m1.1.2.2.2.2">𝒛</ci><ci id="alg2.l8.m1.1.2.2.2.3.cmml" xref="alg2.l8.m1.1.2.2.2.3">′</ci></apply><apply id="alg2.l8.m1.1.2.2.3.cmml" xref="alg2.l8.m1.1.2.2.3"><minus id="alg2.l8.m1.1.2.2.3.1.cmml" xref="alg2.l8.m1.1.2.2.3.1"></minus><ci id="alg2.l8.m1.1.2.2.3.2.cmml" xref="alg2.l8.m1.1.2.2.3.2">𝑡</ci><cn id="alg2.l8.m1.1.2.2.3.3.cmml" type="integer" xref="alg2.l8.m1.1.2.2.3.3">1</cn></apply></apply><apply id="alg2.l8.m1.1.2.3.cmml" xref="alg2.l8.m1.1.2.3"><plus id="alg2.l8.m1.1.2.3.1.cmml" xref="alg2.l8.m1.1.2.3.1"></plus><apply id="alg2.l8.m1.1.2.3.2.cmml" xref="alg2.l8.m1.1.2.3.2"><times id="alg2.l8.m1.1.2.3.2.1.cmml" xref="alg2.l8.m1.1.2.3.2.1"></times><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><divide id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1"></divide><apply id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1"><times id="alg2.l8.m1.1.1.1.2.cmml" xref="alg2.l8.m1.1.1.1.2"></times><apply id="alg2.l8.m1.1.1.1.3.cmml" xref="alg2.l8.m1.1.1.1.3"><root id="alg2.l8.m1.1.1.1.3a.cmml" xref="alg2.l8.m1.1.1.1.3"></root><apply id="alg2.l8.m1.1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.3.2.1.cmml" xref="alg2.l8.m1.1.1.1.3.2">subscript</csymbol><ci id="alg2.l8.m1.1.1.1.3.2.2.cmml" xref="alg2.l8.m1.1.1.1.3.2.2">𝛼</ci><ci id="alg2.l8.m1.1.1.1.3.2.3.cmml" xref="alg2.l8.m1.1.1.1.3.2.3">𝑡</ci></apply></apply><apply id="alg2.l8.m1.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1.1"><minus id="alg2.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1"></minus><cn id="alg2.l8.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg2.l8.m1.1.1.1.1.1.1.2">1</cn><apply id="alg2.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="alg2.l8.m1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.3.2"><ci id="alg2.l8.m1.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.3.2.1">¯</ci><ci id="alg2.l8.m1.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.3.2.2">𝛼</ci></apply><apply id="alg2.l8.m1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.3.3"><minus id="alg2.l8.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.3.3.1"></minus><ci id="alg2.l8.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="alg2.l8.m1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="alg2.l8.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"><minus id="alg2.l8.m1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.3.1"></minus><cn id="alg2.l8.m1.1.1.3.2.cmml" type="integer" xref="alg2.l8.m1.1.1.3.2">1</cn><apply id="alg2.l8.m1.1.1.3.3.cmml" xref="alg2.l8.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.3.1.cmml" xref="alg2.l8.m1.1.1.3.3">subscript</csymbol><apply id="alg2.l8.m1.1.1.3.3.2.cmml" xref="alg2.l8.m1.1.1.3.3.2"><ci id="alg2.l8.m1.1.1.3.3.2.1.cmml" xref="alg2.l8.m1.1.1.3.3.2.1">¯</ci><ci id="alg2.l8.m1.1.1.3.3.2.2.cmml" xref="alg2.l8.m1.1.1.3.3.2.2">𝛼</ci></apply><ci id="alg2.l8.m1.1.1.3.3.3.cmml" xref="alg2.l8.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg2.l8.m1.1.2.3.2.2.cmml" xref="alg2.l8.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.2.3.2.2.1.cmml" xref="alg2.l8.m1.1.2.3.2.2">subscript</csymbol><ci id="alg2.l8.m1.1.2.3.2.2.2.cmml" xref="alg2.l8.m1.1.2.3.2.2.2">𝒛</ci><ci id="alg2.l8.m1.1.2.3.2.2.3.cmml" xref="alg2.l8.m1.1.2.3.2.2.3">𝑡</ci></apply></apply><apply id="alg2.l8.m1.1.2.3.3.cmml" xref="alg2.l8.m1.1.2.3.3"><times id="alg2.l8.m1.1.2.3.3.1.cmml" xref="alg2.l8.m1.1.2.3.3.1"></times><apply id="alg2.l8.m1.1.2.3.3.2.cmml" xref="alg2.l8.m1.1.2.3.3.2"><divide id="alg2.l8.m1.1.2.3.3.2.1.cmml" xref="alg2.l8.m1.1.2.3.3.2"></divide><apply id="alg2.l8.m1.1.2.3.3.2.2.cmml" xref="alg2.l8.m1.1.2.3.3.2.2"><times id="alg2.l8.m1.1.2.3.3.2.2.1.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.1"></times><apply id="alg2.l8.m1.1.2.3.3.2.2.2.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.2"><root id="alg2.l8.m1.1.2.3.3.2.2.2a.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.2"></root><apply id="alg2.l8.m1.1.2.3.3.2.2.2.2.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.2.3.3.2.2.2.2.1.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.2.2">subscript</csymbol><apply id="alg2.l8.m1.1.2.3.3.2.2.2.2.2.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.2"><ci id="alg2.l8.m1.1.2.3.3.2.2.2.2.2.1.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.2.1">¯</ci><ci id="alg2.l8.m1.1.2.3.3.2.2.2.2.2.2.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.2.2">𝛼</ci></apply><apply id="alg2.l8.m1.1.2.3.3.2.2.2.2.3.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.3"><minus id="alg2.l8.m1.1.2.3.3.2.2.2.2.3.1.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.3.1"></minus><ci id="alg2.l8.m1.1.2.3.3.2.2.2.2.3.2.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.3.2">𝑡</ci><cn id="alg2.l8.m1.1.2.3.3.2.2.2.2.3.3.cmml" type="integer" xref="alg2.l8.m1.1.2.3.3.2.2.2.2.3.3">1</cn></apply></apply></apply><apply id="alg2.l8.m1.1.2.3.3.2.2.3.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="alg2.l8.m1.1.2.3.3.2.2.3.1.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.3">subscript</csymbol><ci id="alg2.l8.m1.1.2.3.3.2.2.3.2.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.3.2">𝛽</ci><ci id="alg2.l8.m1.1.2.3.3.2.2.3.3.cmml" xref="alg2.l8.m1.1.2.3.3.2.2.3.3">𝑡</ci></apply></apply><apply id="alg2.l8.m1.1.2.3.3.2.3.cmml" xref="alg2.l8.m1.1.2.3.3.2.3"><minus id="alg2.l8.m1.1.2.3.3.2.3.1.cmml" xref="alg2.l8.m1.1.2.3.3.2.3.1"></minus><cn id="alg2.l8.m1.1.2.3.3.2.3.2.cmml" type="integer" xref="alg2.l8.m1.1.2.3.3.2.3.2">1</cn><apply id="alg2.l8.m1.1.2.3.3.2.3.3.cmml" xref="alg2.l8.m1.1.2.3.3.2.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.1.2.3.3.2.3.3.1.cmml" xref="alg2.l8.m1.1.2.3.3.2.3.3">subscript</csymbol><apply id="alg2.l8.m1.1.2.3.3.2.3.3.2.cmml" xref="alg2.l8.m1.1.2.3.3.2.3.3.2"><ci id="alg2.l8.m1.1.2.3.3.2.3.3.2.1.cmml" xref="alg2.l8.m1.1.2.3.3.2.3.3.2.1">¯</ci><ci id="alg2.l8.m1.1.2.3.3.2.3.3.2.2.cmml" xref="alg2.l8.m1.1.2.3.3.2.3.3.2.2">𝛼</ci></apply><ci id="alg2.l8.m1.1.2.3.3.2.3.3.3.cmml" xref="alg2.l8.m1.1.2.3.3.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg2.l8.m1.1.2.3.3.3.cmml" xref="alg2.l8.m1.1.2.3.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.1.2.3.3.3.1.cmml" xref="alg2.l8.m1.1.2.3.3.3">subscript</csymbol><apply id="alg2.l8.m1.1.2.3.3.3.2.cmml" xref="alg2.l8.m1.1.2.3.3.3.2"><ci id="alg2.l8.m1.1.2.3.3.3.2.1.cmml" xref="alg2.l8.m1.1.2.3.3.3.2.1">^</ci><ci id="alg2.l8.m1.1.2.3.3.3.2.2.cmml" xref="alg2.l8.m1.1.2.3.3.3.2.2">𝒛</ci></apply><cn id="alg2.l8.m1.1.2.3.3.3.3.cmml" type="integer" xref="alg2.l8.m1.1.2.3.3.3.3">0</cn></apply></apply><apply id="alg2.l8.m1.1.2.3.4.cmml" xref="alg2.l8.m1.1.2.3.4"><times id="alg2.l8.m1.1.2.3.4.1.cmml" xref="alg2.l8.m1.1.2.3.4.1"></times><apply id="alg2.l8.m1.1.2.3.4.2.cmml" xref="alg2.l8.m1.1.2.3.4.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.2.3.4.2.1.cmml" xref="alg2.l8.m1.1.2.3.4.2">subscript</csymbol><apply id="alg2.l8.m1.1.2.3.4.2.2.cmml" xref="alg2.l8.m1.1.2.3.4.2.2"><ci id="alg2.l8.m1.1.2.3.4.2.2.1.cmml" xref="alg2.l8.m1.1.2.3.4.2.2.1">~</ci><ci id="alg2.l8.m1.1.2.3.4.2.2.2.cmml" xref="alg2.l8.m1.1.2.3.4.2.2.2">𝜎</ci></apply><ci id="alg2.l8.m1.1.2.3.4.2.3.cmml" xref="alg2.l8.m1.1.2.3.4.2.3">𝑡</ci></apply><ci id="alg2.l8.m1.1.2.3.4.3.cmml" xref="alg2.l8.m1.1.2.3.4.3">bold-italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">{\bm{z}}^{\prime}_{t-1}\leftarrow\frac{\sqrt{\alpha_{t}}(1-\bar{\alpha}_{t-1})%
}{1-\bar{\alpha}_{t}}{\bm{z}}_{t}+\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_{t}}{1-%
\bar{\alpha}_{t}}\hat{{\bm{z}}}_{0}+\tilde{\sigma}_{t}\bm{\epsilon}</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">bold_italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ← divide start_ARG square-root start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG ( 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) end_ARG start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + divide start_ARG square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + over~ start_ARG italic_σ end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_italic_ϵ</annotation></semantics></math>
<span class="ltx_text" id="alg2.l8.1" style="color:#0000FF;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span><span class="ltx_text" id="alg2.l9.1" style="color:#0000FF;">     </span><math alttext="\bm{g}_{t}\leftarrow\eta_{t}\nabla_{{\bm{z}}_{t}}\|\bm{y}-\mathcal{A}(\mathcal%
{D}(\hat{{\bm{z}}}_{0}))\|^{2}_{2}+\gamma_{t}\nabla_{{\bm{z}}_{t}}\|\hat{{\bm{%
z}}}_{0}-\mathcal{E}(\mathcal{A}^{T}\mathcal{A}{\bm{x}}_{0}^{\ast}+(\bm{I}-%
\mathcal{A}^{T}\mathcal{A})\mathcal{D}(\hat{{\bm{z}}}_{0}))\|^{2}_{2}" class="ltx_Math" display="inline" id="alg2.l9.m1.2"><semantics id="alg2.l9.m1.2a"><mrow id="alg2.l9.m1.2.2" xref="alg2.l9.m1.2.2.cmml"><msub id="alg2.l9.m1.2.2.4" xref="alg2.l9.m1.2.2.4.cmml"><mi id="alg2.l9.m1.2.2.4.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.4.2.cmml">𝒈</mi><mi id="alg2.l9.m1.2.2.4.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.4.3.cmml">t</mi></msub><mo id="alg2.l9.m1.2.2.3" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.2.2.3.cmml">←</mo><mrow id="alg2.l9.m1.2.2.2" xref="alg2.l9.m1.2.2.2.cmml"><mrow id="alg2.l9.m1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.cmml"><msub id="alg2.l9.m1.1.1.1.1.3" xref="alg2.l9.m1.1.1.1.1.3.cmml"><mi id="alg2.l9.m1.1.1.1.1.3.2" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.3.2.cmml">η</mi><mi id="alg2.l9.m1.1.1.1.1.3.3" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="alg2.l9.m1.1.1.1.1.2" lspace="0.167em" xref="alg2.l9.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l9.m1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.cmml"><msub id="alg2.l9.m1.1.1.1.1.1.2" xref="alg2.l9.m1.1.1.1.1.1.2.cmml"><mo id="alg2.l9.m1.1.1.1.1.1.2.2" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.2.2.cmml">∇</mo><msub id="alg2.l9.m1.1.1.1.1.1.2.3" xref="alg2.l9.m1.1.1.1.1.1.2.3.cmml"><mi id="alg2.l9.m1.1.1.1.1.1.2.3.2" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.2.3.2.cmml">𝒛</mi><mi id="alg2.l9.m1.1.1.1.1.1.2.3.3" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></msub><msubsup id="alg2.l9.m1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.cmml"><mrow id="alg2.l9.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝒚</mi><mo id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝒜</mi><mo id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝒟</mi><mo id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mo id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mn id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg2.l9.m1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.1.3.cmml">2</mn><mn id="alg2.l9.m1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="alg2.l9.m1.2.2.2.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.3.cmml">+</mo><mrow id="alg2.l9.m1.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.cmml"><msub id="alg2.l9.m1.2.2.2.2.3" xref="alg2.l9.m1.2.2.2.2.3.cmml"><mi id="alg2.l9.m1.2.2.2.2.3.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.3.2.cmml">γ</mi><mi id="alg2.l9.m1.2.2.2.2.3.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.3.3.cmml">t</mi></msub><mo id="alg2.l9.m1.2.2.2.2.2" lspace="0.167em" xref="alg2.l9.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="alg2.l9.m1.2.2.2.2.1" xref="alg2.l9.m1.2.2.2.2.1.cmml"><msub id="alg2.l9.m1.2.2.2.2.1.2" xref="alg2.l9.m1.2.2.2.2.1.2.cmml"><mo id="alg2.l9.m1.2.2.2.2.1.2.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.2.2.cmml">∇</mo><msub id="alg2.l9.m1.2.2.2.2.1.2.3" xref="alg2.l9.m1.2.2.2.2.1.2.3.cmml"><mi id="alg2.l9.m1.2.2.2.2.1.2.3.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.2.3.2.cmml">𝒛</mi><mi id="alg2.l9.m1.2.2.2.2.1.2.3.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.2.3.3.cmml">t</mi></msub></msub><msubsup id="alg2.l9.m1.2.2.2.2.1.1" xref="alg2.l9.m1.2.2.2.2.1.1.cmml"><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.2.cmml"><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.2.1.cmml">‖</mo><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.cmml"><msub id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2.2.cmml">𝒛</mi><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2.1" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mn id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">−</mo><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml">ℰ</mi><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.2" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.cmml"><msup id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml">𝒜</mi><mi id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml">T</mi></msup><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.3.cmml">𝒜</mi><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.1a" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><msubsup id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.cmml"><mi id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.2.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.2.2.cmml">𝒙</mi><mn id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.2.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.2.3.cmml">0</mn><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.3.cmml">∗</mo></msubsup></mrow><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝑰</mi><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msup id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒜</mi><mi id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">T</mi></msup><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝒜</mi></mrow></mrow><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.4" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.4.cmml">𝒟</mi><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3a" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">(</mo><msub id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mover accent="true" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml"><mi id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.2" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.2.cmml">𝒛</mi><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.1" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.1.cmml">^</mo></mover><mn id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml">0</mn></msub><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.3" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg2.l9.m1.2.2.2.2.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.3.cmml">2</mn><mn id="alg2.l9.m1.2.2.2.2.1.1.1.3" mathcolor="#0000FF" xref="alg2.l9.m1.2.2.2.2.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.2b"><apply id="alg2.l9.m1.2.2.cmml" xref="alg2.l9.m1.2.2"><ci id="alg2.l9.m1.2.2.3.cmml" xref="alg2.l9.m1.2.2.3">←</ci><apply id="alg2.l9.m1.2.2.4.cmml" xref="alg2.l9.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.4.1.cmml" xref="alg2.l9.m1.2.2.4">subscript</csymbol><ci id="alg2.l9.m1.2.2.4.2.cmml" xref="alg2.l9.m1.2.2.4.2">𝒈</ci><ci id="alg2.l9.m1.2.2.4.3.cmml" xref="alg2.l9.m1.2.2.4.3">𝑡</ci></apply><apply id="alg2.l9.m1.2.2.2.cmml" xref="alg2.l9.m1.2.2.2"><plus id="alg2.l9.m1.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.3"></plus><apply id="alg2.l9.m1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1"><times id="alg2.l9.m1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.2"></times><apply id="alg2.l9.m1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l9.m1.1.1.1.1.3.2.cmml" xref="alg2.l9.m1.1.1.1.1.3.2">𝜂</ci><ci id="alg2.l9.m1.1.1.1.1.3.3.cmml" xref="alg2.l9.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="alg2.l9.m1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1"><apply id="alg2.l9.m1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l9.m1.1.1.1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.2.2">∇</ci><apply id="alg2.l9.m1.1.1.1.1.1.2.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.2.3.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="alg2.l9.m1.1.1.1.1.1.2.3.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.2.3.2">𝒛</ci><ci id="alg2.l9.m1.1.1.1.1.1.2.3.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="alg2.l9.m1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l9.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1"><minus id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.2"></minus><ci id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.3">𝒚</ci><apply id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝒜</ci><apply id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝒟</ci><apply id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒛</ci></apply><cn id="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></apply></apply><cn id="alg2.l9.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l9.m1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="alg2.l9.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l9.m1.1.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="alg2.l9.m1.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2"><times id="alg2.l9.m1.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2"></times><apply id="alg2.l9.m1.2.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.3.1.cmml" xref="alg2.l9.m1.2.2.2.2.3">subscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.3.2.cmml" xref="alg2.l9.m1.2.2.2.2.3.2">𝛾</ci><ci id="alg2.l9.m1.2.2.2.2.3.3.cmml" xref="alg2.l9.m1.2.2.2.2.3.3">𝑡</ci></apply><apply id="alg2.l9.m1.2.2.2.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.1"><apply id="alg2.l9.m1.2.2.2.2.1.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.2"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.1.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.2">subscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.1.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.2.2">∇</ci><apply id="alg2.l9.m1.2.2.2.2.1.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.2.3"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.1.2.3.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.2.3">subscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.1.2.3.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.2.3.2">𝒛</ci><ci id="alg2.l9.m1.2.2.2.2.1.2.3.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.2.3.3">𝑡</ci></apply></apply><apply id="alg2.l9.m1.2.2.2.2.1.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.1.1.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1">subscript</csymbol><apply id="alg2.l9.m1.2.2.2.2.1.1.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.1.1.1.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1">superscript</csymbol><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l9.m1.2.2.2.2.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.2">norm</csymbol><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1"><minus id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.2"></minus><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2"><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2.1">^</ci><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.2.2">𝒛</ci></apply><cn id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.3.3">0</cn></apply><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1"><times id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.2"></times><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.3">ℰ</ci><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1"><plus id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.3"></plus><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4"><times id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.1"></times><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2">superscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.2">𝒜</ci><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.2.3">𝑇</ci></apply><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.3">𝒜</ci><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4">superscript</csymbol><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.2.2">𝒙</ci><cn id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.2.3.cmml" type="integer" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.2.3">0</cn></apply><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.4.4.3">∗</ci></apply></apply><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2"><times id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3"></times><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑰</ci><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝒜</ci><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑇</ci></apply><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝒜</ci></apply></apply><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.4">𝒟</ci><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1">subscript</csymbol><apply id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2"><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.1">^</ci><ci id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.2">𝒛</ci></apply><cn id="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml" type="integer" xref="alg2.l9.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3">0</cn></apply></apply></apply></apply></apply></apply><cn id="alg2.l9.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="alg2.l9.m1.2.2.2.2.1.1.1.3">2</cn></apply><cn id="alg2.l9.m1.2.2.2.2.1.1.3.cmml" type="integer" xref="alg2.l9.m1.2.2.2.2.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.2c">\bm{g}_{t}\leftarrow\eta_{t}\nabla_{{\bm{z}}_{t}}\|\bm{y}-\mathcal{A}(\mathcal%
{D}(\hat{{\bm{z}}}_{0}))\|^{2}_{2}+\gamma_{t}\nabla_{{\bm{z}}_{t}}\|\hat{{\bm{%
z}}}_{0}-\mathcal{E}(\mathcal{A}^{T}\mathcal{A}{\bm{x}}_{0}^{\ast}+(\bm{I}-%
\mathcal{A}^{T}\mathcal{A})\mathcal{D}(\hat{{\bm{z}}}_{0}))\|^{2}_{2}</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.2d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_italic_y - caligraphic_A ( caligraphic_D ( over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_γ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - caligraphic_E ( caligraphic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT caligraphic_A bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT + ( bold_italic_I - caligraphic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT caligraphic_A ) caligraphic_D ( over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l9.2" style="color:#0000FF;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span><span class="ltx_text" id="alg2.l10.1" style="color:#0000FF;">     </span><math alttext="\bm{U},\bm{S},\bm{V}\leftarrow\text{SVD}(\bm{Z}_{t})" class="ltx_Math" display="inline" id="alg2.l10.m1.4"><semantics id="alg2.l10.m1.4a"><mrow id="alg2.l10.m1.4.4" xref="alg2.l10.m1.4.4.cmml"><mrow id="alg2.l10.m1.4.4.3.2" xref="alg2.l10.m1.4.4.3.1.cmml"><mi id="alg2.l10.m1.1.1" mathcolor="#0000FF" xref="alg2.l10.m1.1.1.cmml">𝑼</mi><mo id="alg2.l10.m1.4.4.3.2.1" mathcolor="#0000FF" xref="alg2.l10.m1.4.4.3.1.cmml">,</mo><mi id="alg2.l10.m1.2.2" mathcolor="#0000FF" xref="alg2.l10.m1.2.2.cmml">𝑺</mi><mo id="alg2.l10.m1.4.4.3.2.2" mathcolor="#0000FF" xref="alg2.l10.m1.4.4.3.1.cmml">,</mo><mi id="alg2.l10.m1.3.3" mathcolor="#0000FF" xref="alg2.l10.m1.3.3.cmml">𝑽</mi></mrow><mo id="alg2.l10.m1.4.4.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l10.m1.4.4.2.cmml">←</mo><mrow id="alg2.l10.m1.4.4.1" xref="alg2.l10.m1.4.4.1.cmml"><mtext id="alg2.l10.m1.4.4.1.3" mathcolor="#0000FF" xref="alg2.l10.m1.4.4.1.3a.cmml">SVD</mtext><mo id="alg2.l10.m1.4.4.1.2" xref="alg2.l10.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg2.l10.m1.4.4.1.1.1" xref="alg2.l10.m1.4.4.1.1.1.1.cmml"><mo id="alg2.l10.m1.4.4.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l10.m1.4.4.1.1.1.1.cmml">(</mo><msub id="alg2.l10.m1.4.4.1.1.1.1" xref="alg2.l10.m1.4.4.1.1.1.1.cmml"><mi id="alg2.l10.m1.4.4.1.1.1.1.2" mathcolor="#0000FF" xref="alg2.l10.m1.4.4.1.1.1.1.2.cmml">𝒁</mi><mi id="alg2.l10.m1.4.4.1.1.1.1.3" mathcolor="#0000FF" xref="alg2.l10.m1.4.4.1.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l10.m1.4.4.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg2.l10.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.4b"><apply id="alg2.l10.m1.4.4.cmml" xref="alg2.l10.m1.4.4"><ci id="alg2.l10.m1.4.4.2.cmml" xref="alg2.l10.m1.4.4.2">←</ci><list id="alg2.l10.m1.4.4.3.1.cmml" xref="alg2.l10.m1.4.4.3.2"><ci id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1">𝑼</ci><ci id="alg2.l10.m1.2.2.cmml" xref="alg2.l10.m1.2.2">𝑺</ci><ci id="alg2.l10.m1.3.3.cmml" xref="alg2.l10.m1.3.3">𝑽</ci></list><apply id="alg2.l10.m1.4.4.1.cmml" xref="alg2.l10.m1.4.4.1"><times id="alg2.l10.m1.4.4.1.2.cmml" xref="alg2.l10.m1.4.4.1.2"></times><ci id="alg2.l10.m1.4.4.1.3a.cmml" xref="alg2.l10.m1.4.4.1.3"><mtext id="alg2.l10.m1.4.4.1.3.cmml" xref="alg2.l10.m1.4.4.1.3">SVD</mtext></ci><apply id="alg2.l10.m1.4.4.1.1.1.1.cmml" xref="alg2.l10.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.4.4.1.1.1.1.1.cmml" xref="alg2.l10.m1.4.4.1.1.1">subscript</csymbol><ci id="alg2.l10.m1.4.4.1.1.1.1.2.cmml" xref="alg2.l10.m1.4.4.1.1.1.1.2">𝒁</ci><ci id="alg2.l10.m1.4.4.1.1.1.1.3.cmml" xref="alg2.l10.m1.4.4.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.4c">\bm{U},\bm{S},\bm{V}\leftarrow\text{SVD}(\bm{Z}_{t})</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.4d">bold_italic_U , bold_italic_S , bold_italic_V ← SVD ( bold_italic_Z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg2.l10.2" style="color:#0000FF;"> </span>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span><span class="ltx_text" id="alg2.l11.1" style="color:#0000FF;">     </span><math alttext="\lambda_{j}\leftarrow s_{j}^{2}" class="ltx_Math" display="inline" id="alg2.l11.m1.1"><semantics id="alg2.l11.m1.1a"><mrow id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><msub id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml"><mi id="alg2.l11.m1.1.1.2.2" mathcolor="#0000FF" xref="alg2.l11.m1.1.1.2.2.cmml">λ</mi><mi id="alg2.l11.m1.1.1.2.3" mathcolor="#0000FF" xref="alg2.l11.m1.1.1.2.3.cmml">j</mi></msub><mo id="alg2.l11.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg2.l11.m1.1.1.1.cmml">←</mo><msubsup id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml"><mi id="alg2.l11.m1.1.1.3.2.2" mathcolor="#0000FF" xref="alg2.l11.m1.1.1.3.2.2.cmml">s</mi><mi id="alg2.l11.m1.1.1.3.2.3" mathcolor="#0000FF" xref="alg2.l11.m1.1.1.3.2.3.cmml">j</mi><mn id="alg2.l11.m1.1.1.3.3" mathcolor="#0000FF" xref="alg2.l11.m1.1.1.3.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><ci id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1">←</ci><apply id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.2.1.cmml" xref="alg2.l11.m1.1.1.2">subscript</csymbol><ci id="alg2.l11.m1.1.1.2.2.cmml" xref="alg2.l11.m1.1.1.2.2">𝜆</ci><ci id="alg2.l11.m1.1.1.2.3.cmml" xref="alg2.l11.m1.1.1.2.3">𝑗</ci></apply><apply id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.3.1.cmml" xref="alg2.l11.m1.1.1.3">superscript</csymbol><apply id="alg2.l11.m1.1.1.3.2.cmml" xref="alg2.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.3.2.1.cmml" xref="alg2.l11.m1.1.1.3">subscript</csymbol><ci id="alg2.l11.m1.1.1.3.2.2.cmml" xref="alg2.l11.m1.1.1.3.2.2">𝑠</ci><ci id="alg2.l11.m1.1.1.3.2.3.cmml" xref="alg2.l11.m1.1.1.3.2.3">𝑗</ci></apply><cn id="alg2.l11.m1.1.1.3.3.cmml" type="integer" xref="alg2.l11.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">\lambda_{j}\leftarrow s_{j}^{2}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.1d">italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ← italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l11.2" style="color:#0000FF;"> (</span><math alttext="s_{j}" class="ltx_Math" display="inline" id="alg2.l11.m2.1"><semantics id="alg2.l11.m2.1a"><msub id="alg2.l11.m2.1.1" xref="alg2.l11.m2.1.1.cmml"><mi id="alg2.l11.m2.1.1.2" mathcolor="#0000FF" xref="alg2.l11.m2.1.1.2.cmml">s</mi><mi id="alg2.l11.m2.1.1.3" mathcolor="#0000FF" xref="alg2.l11.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l11.m2.1b"><apply id="alg2.l11.m2.1.1.cmml" xref="alg2.l11.m2.1.1"><csymbol cd="ambiguous" id="alg2.l11.m2.1.1.1.cmml" xref="alg2.l11.m2.1.1">subscript</csymbol><ci id="alg2.l11.m2.1.1.2.cmml" xref="alg2.l11.m2.1.1.2">𝑠</ci><ci id="alg2.l11.m2.1.1.3.cmml" xref="alg2.l11.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m2.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m2.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l11.3" style="color:#0000FF;"> are the singular values of </span><math alttext="\bm{S}" class="ltx_Math" display="inline" id="alg2.l11.m3.1"><semantics id="alg2.l11.m3.1a"><mi id="alg2.l11.m3.1.1" mathcolor="#0000FF" xref="alg2.l11.m3.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="alg2.l11.m3.1b"><ci id="alg2.l11.m3.1.1.cmml" xref="alg2.l11.m3.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m3.1c">\bm{S}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m3.1d">bold_italic_S</annotation></semantics></math><span class="ltx_text" id="alg2.l11.4" style="color:#0000FF;">)
</span>
</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span><span class="ltx_text" id="alg2.l12.1" style="color:#0000FF;">     </span><math alttext="c_{k}\leftarrow\frac{\sum_{j=1}^{k}\lambda_{j}}{\sum_{j}\lambda_{j}}" class="ltx_Math" display="inline" id="alg2.l12.m1.1"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><msub id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml"><mi id="alg2.l12.m1.1.1.2.2" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.2.2.cmml">c</mi><mi id="alg2.l12.m1.1.1.2.3" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg2.l12.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg2.l12.m1.1.1.1.cmml">←</mo><mfrac id="alg2.l12.m1.1.1.3" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.cmml"><mrow id="alg2.l12.m1.1.1.3.2" xref="alg2.l12.m1.1.1.3.2.cmml"><mstyle displaystyle="false" id="alg2.l12.m1.1.1.3.2.1" xref="alg2.l12.m1.1.1.3.2.1.cmml"><msubsup id="alg2.l12.m1.1.1.3.2.1a" xref="alg2.l12.m1.1.1.3.2.1.cmml"><mo id="alg2.l12.m1.1.1.3.2.1.2.2" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="alg2.l12.m1.1.1.3.2.1.2.3" xref="alg2.l12.m1.1.1.3.2.1.2.3.cmml"><mi id="alg2.l12.m1.1.1.3.2.1.2.3.2" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.2.1.2.3.2.cmml">j</mi><mo id="alg2.l12.m1.1.1.3.2.1.2.3.1" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="alg2.l12.m1.1.1.3.2.1.2.3.3" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="alg2.l12.m1.1.1.3.2.1.3" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.2.1.3.cmml">k</mi></msubsup></mstyle><msub id="alg2.l12.m1.1.1.3.2.2" xref="alg2.l12.m1.1.1.3.2.2.cmml"><mi id="alg2.l12.m1.1.1.3.2.2.2" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.2.2.2.cmml">λ</mi><mi id="alg2.l12.m1.1.1.3.2.2.3" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.2.2.3.cmml">j</mi></msub></mrow><mrow id="alg2.l12.m1.1.1.3.3" xref="alg2.l12.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="alg2.l12.m1.1.1.3.3.1" xref="alg2.l12.m1.1.1.3.3.1.cmml"><msub id="alg2.l12.m1.1.1.3.3.1a" xref="alg2.l12.m1.1.1.3.3.1.cmml"><mo id="alg2.l12.m1.1.1.3.3.1.2" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.3.1.2.cmml">∑</mo><mi id="alg2.l12.m1.1.1.3.3.1.3" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.3.1.3.cmml">j</mi></msub></mstyle><msub id="alg2.l12.m1.1.1.3.3.2" xref="alg2.l12.m1.1.1.3.3.2.cmml"><mi id="alg2.l12.m1.1.1.3.3.2.2" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.3.2.2.cmml">λ</mi><mi id="alg2.l12.m1.1.1.3.3.2.3" mathcolor="#0000FF" xref="alg2.l12.m1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><ci id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1">←</ci><apply id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.2.1.cmml" xref="alg2.l12.m1.1.1.2">subscript</csymbol><ci id="alg2.l12.m1.1.1.2.2.cmml" xref="alg2.l12.m1.1.1.2.2">𝑐</ci><ci id="alg2.l12.m1.1.1.2.3.cmml" xref="alg2.l12.m1.1.1.2.3">𝑘</ci></apply><apply id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3"><divide id="alg2.l12.m1.1.1.3.1.cmml" xref="alg2.l12.m1.1.1.3"></divide><apply id="alg2.l12.m1.1.1.3.2.cmml" xref="alg2.l12.m1.1.1.3.2"><apply id="alg2.l12.m1.1.1.3.2.1.cmml" xref="alg2.l12.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.3.2.1.1.cmml" xref="alg2.l12.m1.1.1.3.2.1">superscript</csymbol><apply id="alg2.l12.m1.1.1.3.2.1.2.cmml" xref="alg2.l12.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.3.2.1.2.1.cmml" xref="alg2.l12.m1.1.1.3.2.1">subscript</csymbol><sum id="alg2.l12.m1.1.1.3.2.1.2.2.cmml" xref="alg2.l12.m1.1.1.3.2.1.2.2"></sum><apply id="alg2.l12.m1.1.1.3.2.1.2.3.cmml" xref="alg2.l12.m1.1.1.3.2.1.2.3"><eq id="alg2.l12.m1.1.1.3.2.1.2.3.1.cmml" xref="alg2.l12.m1.1.1.3.2.1.2.3.1"></eq><ci id="alg2.l12.m1.1.1.3.2.1.2.3.2.cmml" xref="alg2.l12.m1.1.1.3.2.1.2.3.2">𝑗</ci><cn id="alg2.l12.m1.1.1.3.2.1.2.3.3.cmml" type="integer" xref="alg2.l12.m1.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="alg2.l12.m1.1.1.3.2.1.3.cmml" xref="alg2.l12.m1.1.1.3.2.1.3">𝑘</ci></apply><apply id="alg2.l12.m1.1.1.3.2.2.cmml" xref="alg2.l12.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.3.2.2.1.cmml" xref="alg2.l12.m1.1.1.3.2.2">subscript</csymbol><ci id="alg2.l12.m1.1.1.3.2.2.2.cmml" xref="alg2.l12.m1.1.1.3.2.2.2">𝜆</ci><ci id="alg2.l12.m1.1.1.3.2.2.3.cmml" xref="alg2.l12.m1.1.1.3.2.2.3">𝑗</ci></apply></apply><apply id="alg2.l12.m1.1.1.3.3.cmml" xref="alg2.l12.m1.1.1.3.3"><apply id="alg2.l12.m1.1.1.3.3.1.cmml" xref="alg2.l12.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.3.3.1.1.cmml" xref="alg2.l12.m1.1.1.3.3.1">subscript</csymbol><sum id="alg2.l12.m1.1.1.3.3.1.2.cmml" xref="alg2.l12.m1.1.1.3.3.1.2"></sum><ci id="alg2.l12.m1.1.1.3.3.1.3.cmml" xref="alg2.l12.m1.1.1.3.3.1.3">𝑗</ci></apply><apply id="alg2.l12.m1.1.1.3.3.2.cmml" xref="alg2.l12.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.3.3.2.1.cmml" xref="alg2.l12.m1.1.1.3.3.2">subscript</csymbol><ci id="alg2.l12.m1.1.1.3.3.2.2.cmml" xref="alg2.l12.m1.1.1.3.3.2.2">𝜆</ci><ci id="alg2.l12.m1.1.1.3.3.2.3.cmml" xref="alg2.l12.m1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">c_{k}\leftarrow\frac{\sum_{j=1}^{k}\lambda_{j}}{\sum_{j}\lambda_{j}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m1.1d">italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← divide start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG</annotation></semantics></math><span class="ltx_text" id="alg2.l12.2" style="color:#0000FF;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span><span class="ltx_text" id="alg2.l13.1" style="color:#0000FF;">     </span><math alttext="r\leftarrow\underset{k}{\operatorname*{arg\,min}}\{c_{k}\geq\tau\}" class="ltx_Math" display="inline" id="alg2.l13.m1.1"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><mi id="alg2.l13.m1.1.1.3" mathcolor="#0000FF" xref="alg2.l13.m1.1.1.3.cmml">r</mi><mo id="alg2.l13.m1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l13.m1.1.1.2.cmml">←</mo><mrow id="alg2.l13.m1.1.1.1" xref="alg2.l13.m1.1.1.1.cmml"><munder accentunder="true" id="alg2.l13.m1.1.1.1.3" xref="alg2.l13.m1.1.1.1.3.cmml"><mrow id="alg2.l13.m1.1.1.1.3.2" xref="alg2.l13.m1.1.1.1.3.2.cmml"><mi id="alg2.l13.m1.1.1.1.3.2.2" mathcolor="#0000FF" xref="alg2.l13.m1.1.1.1.3.2.2.cmml">arg</mi><mo id="alg2.l13.m1.1.1.1.3.2.1" lspace="0.170em" xref="alg2.l13.m1.1.1.1.3.2.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.1.1.3.2.3" mathcolor="#0000FF" xref="alg2.l13.m1.1.1.1.3.2.3.cmml">min</mi></mrow><mo id="alg2.l13.m1.1.1.1.3.1" mathcolor="#0000FF" xref="alg2.l13.m1.1.1.1.3.1.cmml">𝑘</mo></munder><mo id="alg2.l13.m1.1.1.1.2" xref="alg2.l13.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l13.m1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.2.cmml"><mo id="alg2.l13.m1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg2.l13.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg2.l13.m1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.cmml"><msub id="alg2.l13.m1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.2.2" mathcolor="#0000FF" xref="alg2.l13.m1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="alg2.l13.m1.1.1.1.1.1.1.2.3" mathcolor="#0000FF" xref="alg2.l13.m1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="alg2.l13.m1.1.1.1.1.1.1.1" mathcolor="#0000FF" xref="alg2.l13.m1.1.1.1.1.1.1.1.cmml">≥</mo><mi id="alg2.l13.m1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg2.l13.m1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="alg2.l13.m1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg2.l13.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><ci id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2">←</ci><ci id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3">𝑟</ci><apply id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1"><times id="alg2.l13.m1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.2"></times><apply id="alg2.l13.m1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.3"><ci id="alg2.l13.m1.1.1.1.3.1.cmml" xref="alg2.l13.m1.1.1.1.3.1">𝑘</ci><apply id="alg2.l13.m1.1.1.1.3.2.cmml" xref="alg2.l13.m1.1.1.1.3.2"><times id="alg2.l13.m1.1.1.1.3.2.1.cmml" xref="alg2.l13.m1.1.1.1.3.2.1"></times><ci id="alg2.l13.m1.1.1.1.3.2.2.cmml" xref="alg2.l13.m1.1.1.1.3.2.2">arg</ci><ci id="alg2.l13.m1.1.1.1.3.2.3.cmml" xref="alg2.l13.m1.1.1.1.3.2.3">min</ci></apply></apply><set id="alg2.l13.m1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1"><apply id="alg2.l13.m1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1"><geq id="alg2.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1"></geq><apply id="alg2.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l13.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="alg2.l13.m1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg2.l13.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.3">𝜏</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">r\leftarrow\underset{k}{\operatorname*{arg\,min}}\{c_{k}\geq\tau\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.1d">italic_r ← underitalic_k start_ARG roman_arg roman_min end_ARG { italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ≥ italic_τ }</annotation></semantics></math><span class="ltx_text" id="alg2.l13.2" style="color:#0000FF;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span><span class="ltx_text" id="alg2.l14.1" style="color:#0000FF;">     </span><math alttext="\bm{A}_{t}\leftarrow\bm{U}_{r}" class="ltx_Math" display="inline" id="alg2.l14.m1.1"><semantics id="alg2.l14.m1.1a"><mrow id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><msub id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml"><mi id="alg2.l14.m1.1.1.2.2" mathcolor="#0000FF" xref="alg2.l14.m1.1.1.2.2.cmml">𝑨</mi><mi id="alg2.l14.m1.1.1.2.3" mathcolor="#0000FF" xref="alg2.l14.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg2.l14.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg2.l14.m1.1.1.1.cmml">←</mo><msub id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml"><mi id="alg2.l14.m1.1.1.3.2" mathcolor="#0000FF" xref="alg2.l14.m1.1.1.3.2.cmml">𝑼</mi><mi id="alg2.l14.m1.1.1.3.3" mathcolor="#0000FF" xref="alg2.l14.m1.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><ci id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1">←</ci><apply id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.1.cmml" xref="alg2.l14.m1.1.1.2">subscript</csymbol><ci id="alg2.l14.m1.1.1.2.2.cmml" xref="alg2.l14.m1.1.1.2.2">𝑨</ci><ci id="alg2.l14.m1.1.1.2.3.cmml" xref="alg2.l14.m1.1.1.2.3">𝑡</ci></apply><apply id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.1.cmml" xref="alg2.l14.m1.1.1.3">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.2.cmml" xref="alg2.l14.m1.1.1.3.2">𝑼</ci><ci id="alg2.l14.m1.1.1.3.3.cmml" xref="alg2.l14.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">\bm{A}_{t}\leftarrow\bm{U}_{r}</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m1.1d">bold_italic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l14.2" style="color:#0000FF;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span><span class="ltx_text" id="alg2.l15.1" style="color:#0000FF;">     </span><math alttext="\bm{B}_{t}\leftarrow\bm{V}_{r}" class="ltx_Math" display="inline" id="alg2.l15.m1.1"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><msub id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml"><mi id="alg2.l15.m1.1.1.2.2" mathcolor="#0000FF" xref="alg2.l15.m1.1.1.2.2.cmml">𝑩</mi><mi id="alg2.l15.m1.1.1.2.3" mathcolor="#0000FF" xref="alg2.l15.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg2.l15.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg2.l15.m1.1.1.1.cmml">←</mo><msub id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml"><mi id="alg2.l15.m1.1.1.3.2" mathcolor="#0000FF" xref="alg2.l15.m1.1.1.3.2.cmml">𝑽</mi><mi id="alg2.l15.m1.1.1.3.3" mathcolor="#0000FF" xref="alg2.l15.m1.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><ci id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1">←</ci><apply id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.2.1.cmml" xref="alg2.l15.m1.1.1.2">subscript</csymbol><ci id="alg2.l15.m1.1.1.2.2.cmml" xref="alg2.l15.m1.1.1.2.2">𝑩</ci><ci id="alg2.l15.m1.1.1.2.3.cmml" xref="alg2.l15.m1.1.1.2.3">𝑡</ci></apply><apply id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.3.1.cmml" xref="alg2.l15.m1.1.1.3">subscript</csymbol><ci id="alg2.l15.m1.1.1.3.2.cmml" xref="alg2.l15.m1.1.1.3.2">𝑽</ci><ci id="alg2.l15.m1.1.1.3.3.cmml" xref="alg2.l15.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">\bm{B}_{t}\leftarrow\bm{V}_{r}</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m1.1d">bold_italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_italic_V start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l15.2" style="color:#0000FF;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span><span class="ltx_text" id="alg2.l16.1" style="color:#0000FF;">     </span><math alttext="\bm{R}_{t}\leftarrow\bm{A}_{t}^{T}\bm{G}_{t}\bm{B}_{t}^{T}" class="ltx_Math" display="inline" id="alg2.l16.m1.1"><semantics id="alg2.l16.m1.1a"><mrow id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><msub id="alg2.l16.m1.1.1.2" xref="alg2.l16.m1.1.1.2.cmml"><mi id="alg2.l16.m1.1.1.2.2" mathcolor="#0000FF" xref="alg2.l16.m1.1.1.2.2.cmml">𝑹</mi><mi id="alg2.l16.m1.1.1.2.3" mathcolor="#0000FF" xref="alg2.l16.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg2.l16.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg2.l16.m1.1.1.1.cmml">←</mo><mrow id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml"><msubsup id="alg2.l16.m1.1.1.3.2" xref="alg2.l16.m1.1.1.3.2.cmml"><mi id="alg2.l16.m1.1.1.3.2.2.2" mathcolor="#0000FF" xref="alg2.l16.m1.1.1.3.2.2.2.cmml">𝑨</mi><mi id="alg2.l16.m1.1.1.3.2.2.3" mathcolor="#0000FF" xref="alg2.l16.m1.1.1.3.2.2.3.cmml">t</mi><mi id="alg2.l16.m1.1.1.3.2.3" mathcolor="#0000FF" xref="alg2.l16.m1.1.1.3.2.3.cmml">T</mi></msubsup><mo id="alg2.l16.m1.1.1.3.1" xref="alg2.l16.m1.1.1.3.1.cmml">⁢</mo><msub id="alg2.l16.m1.1.1.3.3" xref="alg2.l16.m1.1.1.3.3.cmml"><mi id="alg2.l16.m1.1.1.3.3.2" mathcolor="#0000FF" xref="alg2.l16.m1.1.1.3.3.2.cmml">𝑮</mi><mi id="alg2.l16.m1.1.1.3.3.3" mathcolor="#0000FF" xref="alg2.l16.m1.1.1.3.3.3.cmml">t</mi></msub><mo id="alg2.l16.m1.1.1.3.1a" xref="alg2.l16.m1.1.1.3.1.cmml">⁢</mo><msubsup id="alg2.l16.m1.1.1.3.4" xref="alg2.l16.m1.1.1.3.4.cmml"><mi id="alg2.l16.m1.1.1.3.4.2.2" mathcolor="#0000FF" xref="alg2.l16.m1.1.1.3.4.2.2.cmml">𝑩</mi><mi id="alg2.l16.m1.1.1.3.4.2.3" mathcolor="#0000FF" xref="alg2.l16.m1.1.1.3.4.2.3.cmml">t</mi><mi id="alg2.l16.m1.1.1.3.4.3" mathcolor="#0000FF" xref="alg2.l16.m1.1.1.3.4.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><ci id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1">←</ci><apply id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1.2">subscript</csymbol><ci id="alg2.l16.m1.1.1.2.2.cmml" xref="alg2.l16.m1.1.1.2.2">𝑹</ci><ci id="alg2.l16.m1.1.1.2.3.cmml" xref="alg2.l16.m1.1.1.2.3">𝑡</ci></apply><apply id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3"><times id="alg2.l16.m1.1.1.3.1.cmml" xref="alg2.l16.m1.1.1.3.1"></times><apply id="alg2.l16.m1.1.1.3.2.cmml" xref="alg2.l16.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.3.2.1.cmml" xref="alg2.l16.m1.1.1.3.2">superscript</csymbol><apply id="alg2.l16.m1.1.1.3.2.2.cmml" xref="alg2.l16.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.3.2.2.1.cmml" xref="alg2.l16.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l16.m1.1.1.3.2.2.2.cmml" xref="alg2.l16.m1.1.1.3.2.2.2">𝑨</ci><ci id="alg2.l16.m1.1.1.3.2.2.3.cmml" xref="alg2.l16.m1.1.1.3.2.2.3">𝑡</ci></apply><ci id="alg2.l16.m1.1.1.3.2.3.cmml" xref="alg2.l16.m1.1.1.3.2.3">𝑇</ci></apply><apply id="alg2.l16.m1.1.1.3.3.cmml" xref="alg2.l16.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.3.3.1.cmml" xref="alg2.l16.m1.1.1.3.3">subscript</csymbol><ci id="alg2.l16.m1.1.1.3.3.2.cmml" xref="alg2.l16.m1.1.1.3.3.2">𝑮</ci><ci id="alg2.l16.m1.1.1.3.3.3.cmml" xref="alg2.l16.m1.1.1.3.3.3">𝑡</ci></apply><apply id="alg2.l16.m1.1.1.3.4.cmml" xref="alg2.l16.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.3.4.1.cmml" xref="alg2.l16.m1.1.1.3.4">superscript</csymbol><apply id="alg2.l16.m1.1.1.3.4.2.cmml" xref="alg2.l16.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.3.4.2.1.cmml" xref="alg2.l16.m1.1.1.3.4">subscript</csymbol><ci id="alg2.l16.m1.1.1.3.4.2.2.cmml" xref="alg2.l16.m1.1.1.3.4.2.2">𝑩</ci><ci id="alg2.l16.m1.1.1.3.4.2.3.cmml" xref="alg2.l16.m1.1.1.3.4.2.3">𝑡</ci></apply><ci id="alg2.l16.m1.1.1.3.4.3.cmml" xref="alg2.l16.m1.1.1.3.4.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">\bm{R}_{t}\leftarrow\bm{A}_{t}^{T}\bm{G}_{t}\bm{B}_{t}^{T}</annotation><annotation encoding="application/x-llamapun" id="alg2.l16.m1.1d">bold_italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_italic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l16.2" style="color:#0000FF;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span><span class="ltx_text" id="alg2.l17.1" style="color:#0000FF;">     </span><math alttext="\bm{G}^{\prime}_{t}\leftarrow\bm{A}_{t}\bm{R}_{t}\bm{B}_{t}" class="ltx_Math" display="inline" id="alg2.l17.m1.1"><semantics id="alg2.l17.m1.1a"><mrow id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml"><msubsup id="alg2.l17.m1.1.1.2" xref="alg2.l17.m1.1.1.2.cmml"><mi id="alg2.l17.m1.1.1.2.2.2" mathcolor="#0000FF" xref="alg2.l17.m1.1.1.2.2.2.cmml">𝑮</mi><mi id="alg2.l17.m1.1.1.2.3" mathcolor="#0000FF" xref="alg2.l17.m1.1.1.2.3.cmml">t</mi><mo id="alg2.l17.m1.1.1.2.2.3" mathcolor="#0000FF" xref="alg2.l17.m1.1.1.2.2.3.cmml">′</mo></msubsup><mo id="alg2.l17.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg2.l17.m1.1.1.1.cmml">←</mo><mrow id="alg2.l17.m1.1.1.3" xref="alg2.l17.m1.1.1.3.cmml"><msub id="alg2.l17.m1.1.1.3.2" xref="alg2.l17.m1.1.1.3.2.cmml"><mi id="alg2.l17.m1.1.1.3.2.2" mathcolor="#0000FF" xref="alg2.l17.m1.1.1.3.2.2.cmml">𝑨</mi><mi id="alg2.l17.m1.1.1.3.2.3" mathcolor="#0000FF" xref="alg2.l17.m1.1.1.3.2.3.cmml">t</mi></msub><mo id="alg2.l17.m1.1.1.3.1" xref="alg2.l17.m1.1.1.3.1.cmml">⁢</mo><msub id="alg2.l17.m1.1.1.3.3" xref="alg2.l17.m1.1.1.3.3.cmml"><mi id="alg2.l17.m1.1.1.3.3.2" mathcolor="#0000FF" xref="alg2.l17.m1.1.1.3.3.2.cmml">𝑹</mi><mi id="alg2.l17.m1.1.1.3.3.3" mathcolor="#0000FF" xref="alg2.l17.m1.1.1.3.3.3.cmml">t</mi></msub><mo id="alg2.l17.m1.1.1.3.1a" xref="alg2.l17.m1.1.1.3.1.cmml">⁢</mo><msub id="alg2.l17.m1.1.1.3.4" xref="alg2.l17.m1.1.1.3.4.cmml"><mi id="alg2.l17.m1.1.1.3.4.2" mathcolor="#0000FF" xref="alg2.l17.m1.1.1.3.4.2.cmml">𝑩</mi><mi id="alg2.l17.m1.1.1.3.4.3" mathcolor="#0000FF" xref="alg2.l17.m1.1.1.3.4.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.1b"><apply id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1"><ci id="alg2.l17.m1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1">←</ci><apply id="alg2.l17.m1.1.1.2.cmml" xref="alg2.l17.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.2.1.cmml" xref="alg2.l17.m1.1.1.2">subscript</csymbol><apply id="alg2.l17.m1.1.1.2.2.cmml" xref="alg2.l17.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.2.2.1.cmml" xref="alg2.l17.m1.1.1.2">superscript</csymbol><ci id="alg2.l17.m1.1.1.2.2.2.cmml" xref="alg2.l17.m1.1.1.2.2.2">𝑮</ci><ci id="alg2.l17.m1.1.1.2.2.3.cmml" xref="alg2.l17.m1.1.1.2.2.3">′</ci></apply><ci id="alg2.l17.m1.1.1.2.3.cmml" xref="alg2.l17.m1.1.1.2.3">𝑡</ci></apply><apply id="alg2.l17.m1.1.1.3.cmml" xref="alg2.l17.m1.1.1.3"><times id="alg2.l17.m1.1.1.3.1.cmml" xref="alg2.l17.m1.1.1.3.1"></times><apply id="alg2.l17.m1.1.1.3.2.cmml" xref="alg2.l17.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.3.2.1.cmml" xref="alg2.l17.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l17.m1.1.1.3.2.2.cmml" xref="alg2.l17.m1.1.1.3.2.2">𝑨</ci><ci id="alg2.l17.m1.1.1.3.2.3.cmml" xref="alg2.l17.m1.1.1.3.2.3">𝑡</ci></apply><apply id="alg2.l17.m1.1.1.3.3.cmml" xref="alg2.l17.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.3.3.1.cmml" xref="alg2.l17.m1.1.1.3.3">subscript</csymbol><ci id="alg2.l17.m1.1.1.3.3.2.cmml" xref="alg2.l17.m1.1.1.3.3.2">𝑹</ci><ci id="alg2.l17.m1.1.1.3.3.3.cmml" xref="alg2.l17.m1.1.1.3.3.3">𝑡</ci></apply><apply id="alg2.l17.m1.1.1.3.4.cmml" xref="alg2.l17.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.3.4.1.cmml" xref="alg2.l17.m1.1.1.3.4">subscript</csymbol><ci id="alg2.l17.m1.1.1.3.4.2.cmml" xref="alg2.l17.m1.1.1.3.4.2">𝑩</ci><ci id="alg2.l17.m1.1.1.3.4.3.cmml" xref="alg2.l17.m1.1.1.3.4.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.1c">\bm{G}^{\prime}_{t}\leftarrow\bm{A}_{t}\bm{R}_{t}\bm{B}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg2.l17.m1.1d">bold_italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← bold_italic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l17.2" style="color:#0000FF;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span><span class="ltx_text" id="alg2.l18.1" style="color:#0000FF;">     </span><math alttext="{\bm{z}}_{t-1}\leftarrow{\bm{z}}^{\prime}_{t-1}-\bm{g}^{\prime}_{t}" class="ltx_Math" display="inline" id="alg2.l18.m1.1"><semantics id="alg2.l18.m1.1a"><mrow id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml"><msub id="alg2.l18.m1.1.1.2" xref="alg2.l18.m1.1.1.2.cmml"><mi id="alg2.l18.m1.1.1.2.2" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.2.2.cmml">𝒛</mi><mrow id="alg2.l18.m1.1.1.2.3" xref="alg2.l18.m1.1.1.2.3.cmml"><mi id="alg2.l18.m1.1.1.2.3.2" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.2.3.2.cmml">t</mi><mo id="alg2.l18.m1.1.1.2.3.1" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.2.3.1.cmml">−</mo><mn id="alg2.l18.m1.1.1.2.3.3" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="alg2.l18.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg2.l18.m1.1.1.1.cmml">←</mo><mrow id="alg2.l18.m1.1.1.3" xref="alg2.l18.m1.1.1.3.cmml"><msubsup id="alg2.l18.m1.1.1.3.2" xref="alg2.l18.m1.1.1.3.2.cmml"><mi id="alg2.l18.m1.1.1.3.2.2.2" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.3.2.2.2.cmml">𝒛</mi><mrow id="alg2.l18.m1.1.1.3.2.3" xref="alg2.l18.m1.1.1.3.2.3.cmml"><mi id="alg2.l18.m1.1.1.3.2.3.2" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.3.2.3.2.cmml">t</mi><mo id="alg2.l18.m1.1.1.3.2.3.1" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.3.2.3.1.cmml">−</mo><mn id="alg2.l18.m1.1.1.3.2.3.3" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.3.2.3.3.cmml">1</mn></mrow><mo id="alg2.l18.m1.1.1.3.2.2.3" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.3.2.2.3.cmml">′</mo></msubsup><mo id="alg2.l18.m1.1.1.3.1" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.3.1.cmml">−</mo><msubsup id="alg2.l18.m1.1.1.3.3" xref="alg2.l18.m1.1.1.3.3.cmml"><mi id="alg2.l18.m1.1.1.3.3.2.2" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.3.3.2.2.cmml">𝒈</mi><mi id="alg2.l18.m1.1.1.3.3.3" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.3.3.3.cmml">t</mi><mo id="alg2.l18.m1.1.1.3.3.2.3" mathcolor="#0000FF" xref="alg2.l18.m1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><apply id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1"><ci id="alg2.l18.m1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1">←</ci><apply id="alg2.l18.m1.1.1.2.cmml" xref="alg2.l18.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.2.1.cmml" xref="alg2.l18.m1.1.1.2">subscript</csymbol><ci id="alg2.l18.m1.1.1.2.2.cmml" xref="alg2.l18.m1.1.1.2.2">𝒛</ci><apply id="alg2.l18.m1.1.1.2.3.cmml" xref="alg2.l18.m1.1.1.2.3"><minus id="alg2.l18.m1.1.1.2.3.1.cmml" xref="alg2.l18.m1.1.1.2.3.1"></minus><ci id="alg2.l18.m1.1.1.2.3.2.cmml" xref="alg2.l18.m1.1.1.2.3.2">𝑡</ci><cn id="alg2.l18.m1.1.1.2.3.3.cmml" type="integer" xref="alg2.l18.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg2.l18.m1.1.1.3.cmml" xref="alg2.l18.m1.1.1.3"><minus id="alg2.l18.m1.1.1.3.1.cmml" xref="alg2.l18.m1.1.1.3.1"></minus><apply id="alg2.l18.m1.1.1.3.2.cmml" xref="alg2.l18.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.2.1.cmml" xref="alg2.l18.m1.1.1.3.2">subscript</csymbol><apply id="alg2.l18.m1.1.1.3.2.2.cmml" xref="alg2.l18.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.2.2.1.cmml" xref="alg2.l18.m1.1.1.3.2">superscript</csymbol><ci id="alg2.l18.m1.1.1.3.2.2.2.cmml" xref="alg2.l18.m1.1.1.3.2.2.2">𝒛</ci><ci id="alg2.l18.m1.1.1.3.2.2.3.cmml" xref="alg2.l18.m1.1.1.3.2.2.3">′</ci></apply><apply id="alg2.l18.m1.1.1.3.2.3.cmml" xref="alg2.l18.m1.1.1.3.2.3"><minus id="alg2.l18.m1.1.1.3.2.3.1.cmml" xref="alg2.l18.m1.1.1.3.2.3.1"></minus><ci id="alg2.l18.m1.1.1.3.2.3.2.cmml" xref="alg2.l18.m1.1.1.3.2.3.2">𝑡</ci><cn id="alg2.l18.m1.1.1.3.2.3.3.cmml" type="integer" xref="alg2.l18.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg2.l18.m1.1.1.3.3.cmml" xref="alg2.l18.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.3.1.cmml" xref="alg2.l18.m1.1.1.3.3">subscript</csymbol><apply id="alg2.l18.m1.1.1.3.3.2.cmml" xref="alg2.l18.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.3.2.1.cmml" xref="alg2.l18.m1.1.1.3.3">superscript</csymbol><ci id="alg2.l18.m1.1.1.3.3.2.2.cmml" xref="alg2.l18.m1.1.1.3.3.2.2">𝒈</ci><ci id="alg2.l18.m1.1.1.3.3.2.3.cmml" xref="alg2.l18.m1.1.1.3.3.2.3">′</ci></apply><ci id="alg2.l18.m1.1.1.3.3.3.cmml" xref="alg2.l18.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">{\bm{z}}_{t-1}\leftarrow{\bm{z}}^{\prime}_{t-1}-\bm{g}^{\prime}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ← bold_italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT - bold_italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l18.2">
</span>
</div>
<div class="ltx_listingline" id="alg2.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span><span class="ltx_text ltx_font_bold" id="alg2.l19.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l19.2">for</span>
</div>
<div class="ltx_listingline" id="alg2.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span><span class="ltx_text ltx_font_bold" id="alg2.l20.1">return</span> <math alttext="\mathcal{D}(\hat{{\bm{z}}}_{0})" class="ltx_Math" display="inline" id="alg2.l20.m1.1"><semantics id="alg2.l20.m1.1a"><mrow id="alg2.l20.m1.1.1" xref="alg2.l20.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l20.m1.1.1.3" xref="alg2.l20.m1.1.1.3.cmml">𝒟</mi><mo id="alg2.l20.m1.1.1.2" xref="alg2.l20.m1.1.1.2.cmml">⁢</mo><mrow id="alg2.l20.m1.1.1.1.1" xref="alg2.l20.m1.1.1.1.1.1.cmml"><mo id="alg2.l20.m1.1.1.1.1.2" stretchy="false" xref="alg2.l20.m1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l20.m1.1.1.1.1.1" xref="alg2.l20.m1.1.1.1.1.1.cmml"><mover accent="true" id="alg2.l20.m1.1.1.1.1.1.2" xref="alg2.l20.m1.1.1.1.1.1.2.cmml"><mi id="alg2.l20.m1.1.1.1.1.1.2.2" xref="alg2.l20.m1.1.1.1.1.1.2.2.cmml">𝒛</mi><mo id="alg2.l20.m1.1.1.1.1.1.2.1" xref="alg2.l20.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mn id="alg2.l20.m1.1.1.1.1.1.3" xref="alg2.l20.m1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg2.l20.m1.1.1.1.1.3" stretchy="false" xref="alg2.l20.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l20.m1.1b"><apply id="alg2.l20.m1.1.1.cmml" xref="alg2.l20.m1.1.1"><times id="alg2.l20.m1.1.1.2.cmml" xref="alg2.l20.m1.1.1.2"></times><ci id="alg2.l20.m1.1.1.3.cmml" xref="alg2.l20.m1.1.1.3">𝒟</ci><apply id="alg2.l20.m1.1.1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1.1">subscript</csymbol><apply id="alg2.l20.m1.1.1.1.1.1.2.cmml" xref="alg2.l20.m1.1.1.1.1.1.2"><ci id="alg2.l20.m1.1.1.1.1.1.2.1.cmml" xref="alg2.l20.m1.1.1.1.1.1.2.1">^</ci><ci id="alg2.l20.m1.1.1.1.1.1.2.2.cmml" xref="alg2.l20.m1.1.1.1.1.1.2.2">𝒛</ci></apply><cn id="alg2.l20.m1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l20.m1.1.1.1.1.1.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l20.m1.1c">\mathcal{D}(\hat{{\bm{z}}}_{0})</annotation><annotation encoding="application/x-llamapun" id="alg2.l20.m1.1d">caligraphic_D ( over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
</div>
</figure>
</figure>
</section>
<section class="ltx_subsection" id="A3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.4 </span>ReSample</h3>
<div class="ltx_para ltx_noindent" id="A3.SS4.p1">
<p class="ltx_p" id="A3.SS4.p1.7">Our DiffStateGrad-ReSample algorithm integrates the state-guided projected gradient into the optimization process of ReSample <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib28" title="">2023a</a>)</cite>. We introduce two new hyperparameters: the variance retention threshold <math alttext="\tau" class="ltx_Math" display="inline" id="A3.SS4.p1.1.m1.1"><semantics id="A3.SS4.p1.1.m1.1a"><mi id="A3.SS4.p1.1.m1.1.1" xref="A3.SS4.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.1.m1.1b"><ci id="A3.SS4.p1.1.m1.1.1.cmml" xref="A3.SS4.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.1.m1.1d">italic_τ</annotation></semantics></math> and a frequency <math alttext="F" class="ltx_Math" display="inline" id="A3.SS4.p1.2.m2.1"><semantics id="A3.SS4.p1.2.m2.1a"><mi id="A3.SS4.p1.2.m2.1.1" xref="A3.SS4.p1.2.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.2.m2.1b"><ci id="A3.SS4.p1.2.m2.1.1.cmml" xref="A3.SS4.p1.2.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.2.m2.1c">F</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.2.m2.1d">italic_F</annotation></semantics></math> for applying our DiffStateGrad step. During each ReSample step, we first perform SVD on the current latent representation (or diffusion state) <math alttext="{\bm{Z}}^{\prime}_{t}" class="ltx_Math" display="inline" id="A3.SS4.p1.3.m3.1"><semantics id="A3.SS4.p1.3.m3.1a"><msubsup id="A3.SS4.p1.3.m3.1.1" xref="A3.SS4.p1.3.m3.1.1.cmml"><mi id="A3.SS4.p1.3.m3.1.1.2.2" xref="A3.SS4.p1.3.m3.1.1.2.2.cmml">𝒁</mi><mi id="A3.SS4.p1.3.m3.1.1.3" xref="A3.SS4.p1.3.m3.1.1.3.cmml">t</mi><mo id="A3.SS4.p1.3.m3.1.1.2.3" xref="A3.SS4.p1.3.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.3.m3.1b"><apply id="A3.SS4.p1.3.m3.1.1.cmml" xref="A3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.3.m3.1.1.1.cmml" xref="A3.SS4.p1.3.m3.1.1">subscript</csymbol><apply id="A3.SS4.p1.3.m3.1.1.2.cmml" xref="A3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.3.m3.1.1.2.1.cmml" xref="A3.SS4.p1.3.m3.1.1">superscript</csymbol><ci id="A3.SS4.p1.3.m3.1.1.2.2.cmml" xref="A3.SS4.p1.3.m3.1.1.2.2">𝒁</ci><ci id="A3.SS4.p1.3.m3.1.1.2.3.cmml" xref="A3.SS4.p1.3.m3.1.1.2.3">′</ci></apply><ci id="A3.SS4.p1.3.m3.1.1.3.cmml" xref="A3.SS4.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.3.m3.1c">{\bm{Z}}^{\prime}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.3.m3.1d">bold_italic_Z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (<math alttext="{\bm{z}}^{\prime}_{t}" class="ltx_Math" display="inline" id="A3.SS4.p1.4.m4.1"><semantics id="A3.SS4.p1.4.m4.1a"><msubsup id="A3.SS4.p1.4.m4.1.1" xref="A3.SS4.p1.4.m4.1.1.cmml"><mi id="A3.SS4.p1.4.m4.1.1.2.2" xref="A3.SS4.p1.4.m4.1.1.2.2.cmml">𝒛</mi><mi id="A3.SS4.p1.4.m4.1.1.3" xref="A3.SS4.p1.4.m4.1.1.3.cmml">t</mi><mo id="A3.SS4.p1.4.m4.1.1.2.3" xref="A3.SS4.p1.4.m4.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.4.m4.1b"><apply id="A3.SS4.p1.4.m4.1.1.cmml" xref="A3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.4.m4.1.1.1.cmml" xref="A3.SS4.p1.4.m4.1.1">subscript</csymbol><apply id="A3.SS4.p1.4.m4.1.1.2.cmml" xref="A3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.4.m4.1.1.2.1.cmml" xref="A3.SS4.p1.4.m4.1.1">superscript</csymbol><ci id="A3.SS4.p1.4.m4.1.1.2.2.cmml" xref="A3.SS4.p1.4.m4.1.1.2.2">𝒛</ci><ci id="A3.SS4.p1.4.m4.1.1.2.3.cmml" xref="A3.SS4.p1.4.m4.1.1.2.3">′</ci></apply><ci id="A3.SS4.p1.4.m4.1.1.3.cmml" xref="A3.SS4.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.4.m4.1c">{\bm{z}}^{\prime}_{t}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.4.m4.1d">bold_italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in image matrix form). Note that we do not perform SVD within the gradient descent loop itself, meaning that we only perform SVD at most once per iteration of the sampling algorithm. We then determine the appropriate rank based on <math alttext="\tau" class="ltx_Math" display="inline" id="A3.SS4.p1.5.m5.1"><semantics id="A3.SS4.p1.5.m5.1a"><mi id="A3.SS4.p1.5.m5.1.1" xref="A3.SS4.p1.5.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.5.m5.1b"><ci id="A3.SS4.p1.5.m5.1.1.cmml" xref="A3.SS4.p1.5.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.5.m5.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.5.m5.1d">italic_τ</annotation></semantics></math> and construct projection matrices. Then, within the gradient descent loop for solving <math alttext="\hat{{\bm{z}}}_{0}({\bm{y}})" class="ltx_Math" display="inline" id="A3.SS4.p1.6.m6.1"><semantics id="A3.SS4.p1.6.m6.1a"><mrow id="A3.SS4.p1.6.m6.1.2" xref="A3.SS4.p1.6.m6.1.2.cmml"><msub id="A3.SS4.p1.6.m6.1.2.2" xref="A3.SS4.p1.6.m6.1.2.2.cmml"><mover accent="true" id="A3.SS4.p1.6.m6.1.2.2.2" xref="A3.SS4.p1.6.m6.1.2.2.2.cmml"><mi id="A3.SS4.p1.6.m6.1.2.2.2.2" xref="A3.SS4.p1.6.m6.1.2.2.2.2.cmml">𝒛</mi><mo id="A3.SS4.p1.6.m6.1.2.2.2.1" xref="A3.SS4.p1.6.m6.1.2.2.2.1.cmml">^</mo></mover><mn id="A3.SS4.p1.6.m6.1.2.2.3" xref="A3.SS4.p1.6.m6.1.2.2.3.cmml">0</mn></msub><mo id="A3.SS4.p1.6.m6.1.2.1" xref="A3.SS4.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="A3.SS4.p1.6.m6.1.2.3.2" xref="A3.SS4.p1.6.m6.1.2.cmml"><mo id="A3.SS4.p1.6.m6.1.2.3.2.1" stretchy="false" xref="A3.SS4.p1.6.m6.1.2.cmml">(</mo><mi id="A3.SS4.p1.6.m6.1.1" xref="A3.SS4.p1.6.m6.1.1.cmml">𝒚</mi><mo id="A3.SS4.p1.6.m6.1.2.3.2.2" stretchy="false" xref="A3.SS4.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.6.m6.1b"><apply id="A3.SS4.p1.6.m6.1.2.cmml" xref="A3.SS4.p1.6.m6.1.2"><times id="A3.SS4.p1.6.m6.1.2.1.cmml" xref="A3.SS4.p1.6.m6.1.2.1"></times><apply id="A3.SS4.p1.6.m6.1.2.2.cmml" xref="A3.SS4.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="A3.SS4.p1.6.m6.1.2.2.1.cmml" xref="A3.SS4.p1.6.m6.1.2.2">subscript</csymbol><apply id="A3.SS4.p1.6.m6.1.2.2.2.cmml" xref="A3.SS4.p1.6.m6.1.2.2.2"><ci id="A3.SS4.p1.6.m6.1.2.2.2.1.cmml" xref="A3.SS4.p1.6.m6.1.2.2.2.1">^</ci><ci id="A3.SS4.p1.6.m6.1.2.2.2.2.cmml" xref="A3.SS4.p1.6.m6.1.2.2.2.2">𝒛</ci></apply><cn id="A3.SS4.p1.6.m6.1.2.2.3.cmml" type="integer" xref="A3.SS4.p1.6.m6.1.2.2.3">0</cn></apply><ci id="A3.SS4.p1.6.m6.1.1.cmml" xref="A3.SS4.p1.6.m6.1.1">𝒚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.6.m6.1c">\hat{{\bm{z}}}_{0}({\bm{y}})</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.6.m6.1d">over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_y )</annotation></semantics></math>, we approximate the gradient in the diffusion state subspace using our projection matrices every <math alttext="F=5" class="ltx_Math" display="inline" id="A3.SS4.p1.7.m7.1"><semantics id="A3.SS4.p1.7.m7.1a"><mrow id="A3.SS4.p1.7.m7.1.1" xref="A3.SS4.p1.7.m7.1.1.cmml"><mi id="A3.SS4.p1.7.m7.1.1.2" xref="A3.SS4.p1.7.m7.1.1.2.cmml">F</mi><mo id="A3.SS4.p1.7.m7.1.1.1" xref="A3.SS4.p1.7.m7.1.1.1.cmml">=</mo><mn id="A3.SS4.p1.7.m7.1.1.3" xref="A3.SS4.p1.7.m7.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.7.m7.1b"><apply id="A3.SS4.p1.7.m7.1.1.cmml" xref="A3.SS4.p1.7.m7.1.1"><eq id="A3.SS4.p1.7.m7.1.1.1.cmml" xref="A3.SS4.p1.7.m7.1.1.1"></eq><ci id="A3.SS4.p1.7.m7.1.1.2.cmml" xref="A3.SS4.p1.7.m7.1.1.2">𝐹</ci><cn id="A3.SS4.p1.7.m7.1.1.3.cmml" type="integer" xref="A3.SS4.p1.7.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.7.m7.1c">F=5</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.7.m7.1d">italic_F = 5</annotation></semantics></math> steps. On steps where DiffStateGrad is not applied, we use the standard gradient. This adaptive, periodic application of DiffStateGrad allows for a balance between the benefits of low-rank approximation and the potential need for full gradient information. The rest of the ReSample algorithm, including the stochastic resampling step, remains unchanged.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p2">
<p class="ltx_p" id="A3.SS4.p2.1">We note that the ReSample algorithm employs a two-stage approach for its hard data consistency step. Initially, it performs pixel-space optimization. This step is computationally efficient and produces smoother, albeit potentially blurrier, results with high-level semantic information. As the diffusion process approaches <math alttext="t=0" class="ltx_Math" display="inline" id="A3.SS4.p2.1.m1.1"><semantics id="A3.SS4.p2.1.m1.1a"><mrow id="A3.SS4.p2.1.m1.1.1" xref="A3.SS4.p2.1.m1.1.1.cmml"><mi id="A3.SS4.p2.1.m1.1.1.2" xref="A3.SS4.p2.1.m1.1.1.2.cmml">t</mi><mo id="A3.SS4.p2.1.m1.1.1.1" xref="A3.SS4.p2.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS4.p2.1.m1.1.1.3" xref="A3.SS4.p2.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.1.m1.1b"><apply id="A3.SS4.p2.1.m1.1.1.cmml" xref="A3.SS4.p2.1.m1.1.1"><eq id="A3.SS4.p2.1.m1.1.1.1.cmml" xref="A3.SS4.p2.1.m1.1.1.1"></eq><ci id="A3.SS4.p2.1.m1.1.1.2.cmml" xref="A3.SS4.p2.1.m1.1.1.2">𝑡</ci><cn id="A3.SS4.p2.1.m1.1.1.3.cmml" type="integer" xref="A3.SS4.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.1.m1.1c">t=0</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.1.m1.1d">italic_t = 0</annotation></semantics></math>, ReSample transitions to latent-space optimization to refine the image with finer details. Our DiffStateGrad method is specifically integrated into this latter, latent-space optimization stage. By applying DiffStateGrad to the latent optimization, we aim to mitigate the potential introduction of artifacts and off-manifold deviations that can occur due to the direct manipulation of latent variables. This application of DiffStateGrad allows us to benefit from the computational efficiency of initial pixel-space optimization while enhancing the robustness and quality of the final latent-space refinement. Importantly, DiffStateGrad is not applied during the pixel-space optimization phase, as this stage already tends to produce smoother results and is less prone to artifact introduction.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p3">
<p class="ltx_p" id="A3.SS4.p3.1">For experiments, we use the official implementation of ReSample <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib28" title="">2023a</a>)</cite> with default configurations.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg3.2.1.1">Algorithm 3</span> </span> DiffStateGrad-ReSample for Image Restoration Tasks</figcaption>
<div class="ltx_listing ltx_listing" id="alg3.3">
<div class="ltx_listingline" id="alg3.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>Measurements <math alttext="{\bm{y}}" class="ltx_Math" display="inline" id="alg3.l1.m1.1"><semantics id="alg3.l1.m1.1a"><mi id="alg3.l1.m1.1.1" xref="alg3.l1.m1.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.1b"><ci id="alg3.l1.m1.1.1.cmml" xref="alg3.l1.m1.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.1c">{\bm{y}}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m1.1d">bold_italic_y</annotation></semantics></math>, <math alttext="\mathcal{A}(\cdot)" class="ltx_Math" display="inline" id="alg3.l1.m2.1"><semantics id="alg3.l1.m2.1a"><mrow id="alg3.l1.m2.1.2" xref="alg3.l1.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l1.m2.1.2.2" xref="alg3.l1.m2.1.2.2.cmml">𝒜</mi><mo id="alg3.l1.m2.1.2.1" xref="alg3.l1.m2.1.2.1.cmml">⁢</mo><mrow id="alg3.l1.m2.1.2.3.2" xref="alg3.l1.m2.1.2.cmml"><mo id="alg3.l1.m2.1.2.3.2.1" stretchy="false" xref="alg3.l1.m2.1.2.cmml">(</mo><mo id="alg3.l1.m2.1.1" lspace="0em" rspace="0em" xref="alg3.l1.m2.1.1.cmml">⋅</mo><mo id="alg3.l1.m2.1.2.3.2.2" stretchy="false" xref="alg3.l1.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m2.1b"><apply id="alg3.l1.m2.1.2.cmml" xref="alg3.l1.m2.1.2"><times id="alg3.l1.m2.1.2.1.cmml" xref="alg3.l1.m2.1.2.1"></times><ci id="alg3.l1.m2.1.2.2.cmml" xref="alg3.l1.m2.1.2.2">𝒜</ci><ci id="alg3.l1.m2.1.1.cmml" xref="alg3.l1.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m2.1c">\mathcal{A}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m2.1d">caligraphic_A ( ⋅ )</annotation></semantics></math>, Encoder <math alttext="\mathcal{E}(\cdot)" class="ltx_Math" display="inline" id="alg3.l1.m3.1"><semantics id="alg3.l1.m3.1a"><mrow id="alg3.l1.m3.1.2" xref="alg3.l1.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l1.m3.1.2.2" xref="alg3.l1.m3.1.2.2.cmml">ℰ</mi><mo id="alg3.l1.m3.1.2.1" xref="alg3.l1.m3.1.2.1.cmml">⁢</mo><mrow id="alg3.l1.m3.1.2.3.2" xref="alg3.l1.m3.1.2.cmml"><mo id="alg3.l1.m3.1.2.3.2.1" stretchy="false" xref="alg3.l1.m3.1.2.cmml">(</mo><mo id="alg3.l1.m3.1.1" lspace="0em" rspace="0em" xref="alg3.l1.m3.1.1.cmml">⋅</mo><mo id="alg3.l1.m3.1.2.3.2.2" stretchy="false" xref="alg3.l1.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m3.1b"><apply id="alg3.l1.m3.1.2.cmml" xref="alg3.l1.m3.1.2"><times id="alg3.l1.m3.1.2.1.cmml" xref="alg3.l1.m3.1.2.1"></times><ci id="alg3.l1.m3.1.2.2.cmml" xref="alg3.l1.m3.1.2.2">ℰ</ci><ci id="alg3.l1.m3.1.1.cmml" xref="alg3.l1.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m3.1c">\mathcal{E}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m3.1d">caligraphic_E ( ⋅ )</annotation></semantics></math>, Decoder <math alttext="\mathcal{D}(\cdot)" class="ltx_Math" display="inline" id="alg3.l1.m4.1"><semantics id="alg3.l1.m4.1a"><mrow id="alg3.l1.m4.1.2" xref="alg3.l1.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l1.m4.1.2.2" xref="alg3.l1.m4.1.2.2.cmml">𝒟</mi><mo id="alg3.l1.m4.1.2.1" xref="alg3.l1.m4.1.2.1.cmml">⁢</mo><mrow id="alg3.l1.m4.1.2.3.2" xref="alg3.l1.m4.1.2.cmml"><mo id="alg3.l1.m4.1.2.3.2.1" stretchy="false" xref="alg3.l1.m4.1.2.cmml">(</mo><mo id="alg3.l1.m4.1.1" lspace="0em" rspace="0em" xref="alg3.l1.m4.1.1.cmml">⋅</mo><mo id="alg3.l1.m4.1.2.3.2.2" stretchy="false" xref="alg3.l1.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m4.1b"><apply id="alg3.l1.m4.1.2.cmml" xref="alg3.l1.m4.1.2"><times id="alg3.l1.m4.1.2.1.cmml" xref="alg3.l1.m4.1.2.1"></times><ci id="alg3.l1.m4.1.2.2.cmml" xref="alg3.l1.m4.1.2.2">𝒟</ci><ci id="alg3.l1.m4.1.1.cmml" xref="alg3.l1.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m4.1c">\mathcal{D}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m4.1d">caligraphic_D ( ⋅ )</annotation></semantics></math>, Score function <math alttext="{\bm{s}}_{\theta}(\cdot,t)" class="ltx_Math" display="inline" id="alg3.l1.m5.2"><semantics id="alg3.l1.m5.2a"><mrow id="alg3.l1.m5.2.3" xref="alg3.l1.m5.2.3.cmml"><msub id="alg3.l1.m5.2.3.2" xref="alg3.l1.m5.2.3.2.cmml"><mi id="alg3.l1.m5.2.3.2.2" xref="alg3.l1.m5.2.3.2.2.cmml">𝒔</mi><mi id="alg3.l1.m5.2.3.2.3" xref="alg3.l1.m5.2.3.2.3.cmml">θ</mi></msub><mo id="alg3.l1.m5.2.3.1" xref="alg3.l1.m5.2.3.1.cmml">⁢</mo><mrow id="alg3.l1.m5.2.3.3.2" xref="alg3.l1.m5.2.3.3.1.cmml"><mo id="alg3.l1.m5.2.3.3.2.1" stretchy="false" xref="alg3.l1.m5.2.3.3.1.cmml">(</mo><mo id="alg3.l1.m5.1.1" lspace="0em" rspace="0em" xref="alg3.l1.m5.1.1.cmml">⋅</mo><mo id="alg3.l1.m5.2.3.3.2.2" xref="alg3.l1.m5.2.3.3.1.cmml">,</mo><mi id="alg3.l1.m5.2.2" xref="alg3.l1.m5.2.2.cmml">t</mi><mo id="alg3.l1.m5.2.3.3.2.3" stretchy="false" xref="alg3.l1.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m5.2b"><apply id="alg3.l1.m5.2.3.cmml" xref="alg3.l1.m5.2.3"><times id="alg3.l1.m5.2.3.1.cmml" xref="alg3.l1.m5.2.3.1"></times><apply id="alg3.l1.m5.2.3.2.cmml" xref="alg3.l1.m5.2.3.2"><csymbol cd="ambiguous" id="alg3.l1.m5.2.3.2.1.cmml" xref="alg3.l1.m5.2.3.2">subscript</csymbol><ci id="alg3.l1.m5.2.3.2.2.cmml" xref="alg3.l1.m5.2.3.2.2">𝒔</ci><ci id="alg3.l1.m5.2.3.2.3.cmml" xref="alg3.l1.m5.2.3.2.3">𝜃</ci></apply><interval closure="open" id="alg3.l1.m5.2.3.3.1.cmml" xref="alg3.l1.m5.2.3.3.2"><ci id="alg3.l1.m5.1.1.cmml" xref="alg3.l1.m5.1.1">⋅</ci><ci id="alg3.l1.m5.2.2.cmml" xref="alg3.l1.m5.2.2">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m5.2c">{\bm{s}}_{\theta}(\cdot,t)</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m5.2d">bold_italic_s start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ , italic_t )</annotation></semantics></math>, Pretrained LDM Parameters <math alttext="\beta_{t}" class="ltx_Math" display="inline" id="alg3.l1.m6.1"><semantics id="alg3.l1.m6.1a"><msub id="alg3.l1.m6.1.1" xref="alg3.l1.m6.1.1.cmml"><mi id="alg3.l1.m6.1.1.2" xref="alg3.l1.m6.1.1.2.cmml">β</mi><mi id="alg3.l1.m6.1.1.3" xref="alg3.l1.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m6.1b"><apply id="alg3.l1.m6.1.1.cmml" xref="alg3.l1.m6.1.1"><csymbol cd="ambiguous" id="alg3.l1.m6.1.1.1.cmml" xref="alg3.l1.m6.1.1">subscript</csymbol><ci id="alg3.l1.m6.1.1.2.cmml" xref="alg3.l1.m6.1.1.2">𝛽</ci><ci id="alg3.l1.m6.1.1.3.cmml" xref="alg3.l1.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m6.1c">\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m6.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\bar{\alpha}_{t}" class="ltx_Math" display="inline" id="alg3.l1.m7.1"><semantics id="alg3.l1.m7.1a"><msub id="alg3.l1.m7.1.1" xref="alg3.l1.m7.1.1.cmml"><mover accent="true" id="alg3.l1.m7.1.1.2" xref="alg3.l1.m7.1.1.2.cmml"><mi id="alg3.l1.m7.1.1.2.2" xref="alg3.l1.m7.1.1.2.2.cmml">α</mi><mo id="alg3.l1.m7.1.1.2.1" xref="alg3.l1.m7.1.1.2.1.cmml">¯</mo></mover><mi id="alg3.l1.m7.1.1.3" xref="alg3.l1.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m7.1b"><apply id="alg3.l1.m7.1.1.cmml" xref="alg3.l1.m7.1.1"><csymbol cd="ambiguous" id="alg3.l1.m7.1.1.1.cmml" xref="alg3.l1.m7.1.1">subscript</csymbol><apply id="alg3.l1.m7.1.1.2.cmml" xref="alg3.l1.m7.1.1.2"><ci id="alg3.l1.m7.1.1.2.1.cmml" xref="alg3.l1.m7.1.1.2.1">¯</ci><ci id="alg3.l1.m7.1.1.2.2.cmml" xref="alg3.l1.m7.1.1.2.2">𝛼</ci></apply><ci id="alg3.l1.m7.1.1.3.cmml" xref="alg3.l1.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m7.1c">\bar{\alpha}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m7.1d">over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\eta" class="ltx_Math" display="inline" id="alg3.l1.m8.1"><semantics id="alg3.l1.m8.1a"><mi id="alg3.l1.m8.1.1" xref="alg3.l1.m8.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m8.1b"><ci id="alg3.l1.m8.1.1.cmml" xref="alg3.l1.m8.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m8.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m8.1d">italic_η</annotation></semantics></math>, <math alttext="\delta" class="ltx_Math" display="inline" id="alg3.l1.m9.1"><semantics id="alg3.l1.m9.1a"><mi id="alg3.l1.m9.1.1" xref="alg3.l1.m9.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m9.1b"><ci id="alg3.l1.m9.1.1.cmml" xref="alg3.l1.m9.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m9.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m9.1d">italic_δ</annotation></semantics></math>, Hyperparameter <math alttext="\gamma" class="ltx_Math" display="inline" id="alg3.l1.m10.1"><semantics id="alg3.l1.m10.1a"><mi id="alg3.l1.m10.1.1" xref="alg3.l1.m10.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m10.1b"><ci id="alg3.l1.m10.1.1.cmml" xref="alg3.l1.m10.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m10.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m10.1d">italic_γ</annotation></semantics></math> to control <math alttext="\sigma_{t}^{2}" class="ltx_Math" display="inline" id="alg3.l1.m11.1"><semantics id="alg3.l1.m11.1a"><msubsup id="alg3.l1.m11.1.1" xref="alg3.l1.m11.1.1.cmml"><mi id="alg3.l1.m11.1.1.2.2" xref="alg3.l1.m11.1.1.2.2.cmml">σ</mi><mi id="alg3.l1.m11.1.1.2.3" xref="alg3.l1.m11.1.1.2.3.cmml">t</mi><mn id="alg3.l1.m11.1.1.3" xref="alg3.l1.m11.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg3.l1.m11.1b"><apply id="alg3.l1.m11.1.1.cmml" xref="alg3.l1.m11.1.1"><csymbol cd="ambiguous" id="alg3.l1.m11.1.1.1.cmml" xref="alg3.l1.m11.1.1">superscript</csymbol><apply id="alg3.l1.m11.1.1.2.cmml" xref="alg3.l1.m11.1.1"><csymbol cd="ambiguous" id="alg3.l1.m11.1.1.2.1.cmml" xref="alg3.l1.m11.1.1">subscript</csymbol><ci id="alg3.l1.m11.1.1.2.2.cmml" xref="alg3.l1.m11.1.1.2.2">𝜎</ci><ci id="alg3.l1.m11.1.1.2.3.cmml" xref="alg3.l1.m11.1.1.2.3">𝑡</ci></apply><cn id="alg3.l1.m11.1.1.3.cmml" type="integer" xref="alg3.l1.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m11.1c">\sigma_{t}^{2}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m11.1d">italic_σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, Time steps to perform resample <math alttext="C" class="ltx_Math" display="inline" id="alg3.l1.m12.1"><semantics id="alg3.l1.m12.1a"><mi id="alg3.l1.m12.1.1" xref="alg3.l1.m12.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m12.1b"><ci id="alg3.l1.m12.1.1.cmml" xref="alg3.l1.m12.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m12.1c">C</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m12.1d">italic_C</annotation></semantics></math>, <span class="ltx_text" id="alg3.l1.2" style="color:#0000FF;"> Variance retention threshold <math alttext="\tau" class="ltx_Math" display="inline" id="alg3.l1.1.m1.1"><semantics id="alg3.l1.1.m1.1a"><mi id="alg3.l1.1.m1.1.1" mathcolor="#0000FF" xref="alg3.l1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.1.m1.1b"><ci id="alg3.l1.1.m1.1.1.cmml" xref="alg3.l1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.1.m1.1d">italic_τ</annotation></semantics></math>, Frequency <math alttext="F" class="ltx_Math" display="inline" id="alg3.l1.2.m2.1"><semantics id="alg3.l1.2.m2.1a"><mi id="alg3.l1.2.m2.1.1" mathcolor="#0000FF" xref="alg3.l1.2.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.2.m2.1b"><ci id="alg3.l1.2.m2.1.1.cmml" xref="alg3.l1.2.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.2.m2.1c">F</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.2.m2.1d">italic_F</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg3.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><math alttext="{\bm{z}}_{T}\sim\mathcal{N}(\mathbf{0},\bm{I})" class="ltx_Math" display="inline" id="alg3.l2.m1.2"><semantics id="alg3.l2.m1.2a"><mrow id="alg3.l2.m1.2.3" xref="alg3.l2.m1.2.3.cmml"><msub id="alg3.l2.m1.2.3.2" xref="alg3.l2.m1.2.3.2.cmml"><mi id="alg3.l2.m1.2.3.2.2" xref="alg3.l2.m1.2.3.2.2.cmml">𝒛</mi><mi id="alg3.l2.m1.2.3.2.3" xref="alg3.l2.m1.2.3.2.3.cmml">T</mi></msub><mo id="alg3.l2.m1.2.3.1" xref="alg3.l2.m1.2.3.1.cmml">∼</mo><mrow id="alg3.l2.m1.2.3.3" xref="alg3.l2.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l2.m1.2.3.3.2" xref="alg3.l2.m1.2.3.3.2.cmml">𝒩</mi><mo id="alg3.l2.m1.2.3.3.1" xref="alg3.l2.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg3.l2.m1.2.3.3.3.2" xref="alg3.l2.m1.2.3.3.3.1.cmml"><mo id="alg3.l2.m1.2.3.3.3.2.1" stretchy="false" xref="alg3.l2.m1.2.3.3.3.1.cmml">(</mo><mn id="alg3.l2.m1.1.1" xref="alg3.l2.m1.1.1.cmml">𝟎</mn><mo id="alg3.l2.m1.2.3.3.3.2.2" xref="alg3.l2.m1.2.3.3.3.1.cmml">,</mo><mi id="alg3.l2.m1.2.2" xref="alg3.l2.m1.2.2.cmml">𝑰</mi><mo id="alg3.l2.m1.2.3.3.3.2.3" stretchy="false" xref="alg3.l2.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.2b"><apply id="alg3.l2.m1.2.3.cmml" xref="alg3.l2.m1.2.3"><csymbol cd="latexml" id="alg3.l2.m1.2.3.1.cmml" xref="alg3.l2.m1.2.3.1">similar-to</csymbol><apply id="alg3.l2.m1.2.3.2.cmml" xref="alg3.l2.m1.2.3.2"><csymbol cd="ambiguous" id="alg3.l2.m1.2.3.2.1.cmml" xref="alg3.l2.m1.2.3.2">subscript</csymbol><ci id="alg3.l2.m1.2.3.2.2.cmml" xref="alg3.l2.m1.2.3.2.2">𝒛</ci><ci id="alg3.l2.m1.2.3.2.3.cmml" xref="alg3.l2.m1.2.3.2.3">𝑇</ci></apply><apply id="alg3.l2.m1.2.3.3.cmml" xref="alg3.l2.m1.2.3.3"><times id="alg3.l2.m1.2.3.3.1.cmml" xref="alg3.l2.m1.2.3.3.1"></times><ci id="alg3.l2.m1.2.3.3.2.cmml" xref="alg3.l2.m1.2.3.3.2">𝒩</ci><interval closure="open" id="alg3.l2.m1.2.3.3.3.1.cmml" xref="alg3.l2.m1.2.3.3.3.2"><cn id="alg3.l2.m1.1.1.cmml" type="integer" xref="alg3.l2.m1.1.1">0</cn><ci id="alg3.l2.m1.2.2.cmml" xref="alg3.l2.m1.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.2c">{\bm{z}}_{T}\sim\mathcal{N}(\mathbf{0},\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m1.2d">bold_italic_z start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∼ caligraphic_N ( bold_0 , bold_italic_I )</annotation></semantics></math> <span class="ltx_text" id="alg3.l2.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l2.1.m1.1"><semantics id="alg3.l2.1.m1.1a"><mo id="alg3.l2.1.m1.1.1" xref="alg3.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l2.1.m1.1b"><ci id="alg3.l2.1.m1.1.1.cmml" xref="alg3.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.1.m1.1d">▷</annotation></semantics></math> Initial noise vector
</span>
</div>
<div class="ltx_listingline" id="alg3.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><span class="ltx_text ltx_font_bold" id="alg3.l3.1">for</span> <math alttext="t=T-1,\ldots,0" class="ltx_Math" display="inline" id="alg3.l3.m1.3"><semantics id="alg3.l3.m1.3a"><mrow id="alg3.l3.m1.3.3" xref="alg3.l3.m1.3.3.cmml"><mi id="alg3.l3.m1.3.3.3" xref="alg3.l3.m1.3.3.3.cmml">t</mi><mo id="alg3.l3.m1.3.3.2" xref="alg3.l3.m1.3.3.2.cmml">=</mo><mrow id="alg3.l3.m1.3.3.1.1" xref="alg3.l3.m1.3.3.1.2.cmml"><mrow id="alg3.l3.m1.3.3.1.1.1" xref="alg3.l3.m1.3.3.1.1.1.cmml"><mi id="alg3.l3.m1.3.3.1.1.1.2" xref="alg3.l3.m1.3.3.1.1.1.2.cmml">T</mi><mo id="alg3.l3.m1.3.3.1.1.1.1" xref="alg3.l3.m1.3.3.1.1.1.1.cmml">−</mo><mn id="alg3.l3.m1.3.3.1.1.1.3" xref="alg3.l3.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="alg3.l3.m1.3.3.1.1.2" xref="alg3.l3.m1.3.3.1.2.cmml">,</mo><mi id="alg3.l3.m1.1.1" mathvariant="normal" xref="alg3.l3.m1.1.1.cmml">…</mi><mo id="alg3.l3.m1.3.3.1.1.3" xref="alg3.l3.m1.3.3.1.2.cmml">,</mo><mn id="alg3.l3.m1.2.2" xref="alg3.l3.m1.2.2.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.3b"><apply id="alg3.l3.m1.3.3.cmml" xref="alg3.l3.m1.3.3"><eq id="alg3.l3.m1.3.3.2.cmml" xref="alg3.l3.m1.3.3.2"></eq><ci id="alg3.l3.m1.3.3.3.cmml" xref="alg3.l3.m1.3.3.3">𝑡</ci><list id="alg3.l3.m1.3.3.1.2.cmml" xref="alg3.l3.m1.3.3.1.1"><apply id="alg3.l3.m1.3.3.1.1.1.cmml" xref="alg3.l3.m1.3.3.1.1.1"><minus id="alg3.l3.m1.3.3.1.1.1.1.cmml" xref="alg3.l3.m1.3.3.1.1.1.1"></minus><ci id="alg3.l3.m1.3.3.1.1.1.2.cmml" xref="alg3.l3.m1.3.3.1.1.1.2">𝑇</ci><cn id="alg3.l3.m1.3.3.1.1.1.3.cmml" type="integer" xref="alg3.l3.m1.3.3.1.1.1.3">1</cn></apply><ci id="alg3.l3.m1.1.1.cmml" xref="alg3.l3.m1.1.1">…</ci><cn id="alg3.l3.m1.2.2.cmml" type="integer" xref="alg3.l3.m1.2.2">0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.3c">t=T-1,\ldots,0</annotation><annotation encoding="application/x-llamapun" id="alg3.l3.m1.3d">italic_t = italic_T - 1 , … , 0</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.l3.2">do</span>
</div>
<div class="ltx_listingline" id="alg3.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <math alttext="\bm{\epsilon}_{1}\sim\mathcal{N}(\mathbf{0},\bm{I})" class="ltx_Math" display="inline" id="alg3.l4.m1.2"><semantics id="alg3.l4.m1.2a"><mrow id="alg3.l4.m1.2.3" xref="alg3.l4.m1.2.3.cmml"><msub id="alg3.l4.m1.2.3.2" xref="alg3.l4.m1.2.3.2.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg3.l4.m1.2.3.2.2" mathvariant="bold-italic" xref="alg3.l4.m1.2.3.2.2.cmml">ϵ</mi><mn id="alg3.l4.m1.2.3.2.3" xref="alg3.l4.m1.2.3.2.3.cmml">1</mn></msub><mo id="alg3.l4.m1.2.3.1" xref="alg3.l4.m1.2.3.1.cmml">∼</mo><mrow id="alg3.l4.m1.2.3.3" xref="alg3.l4.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l4.m1.2.3.3.2" xref="alg3.l4.m1.2.3.3.2.cmml">𝒩</mi><mo id="alg3.l4.m1.2.3.3.1" xref="alg3.l4.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg3.l4.m1.2.3.3.3.2" xref="alg3.l4.m1.2.3.3.3.1.cmml"><mo id="alg3.l4.m1.2.3.3.3.2.1" stretchy="false" xref="alg3.l4.m1.2.3.3.3.1.cmml">(</mo><mn id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml">𝟎</mn><mo id="alg3.l4.m1.2.3.3.3.2.2" xref="alg3.l4.m1.2.3.3.3.1.cmml">,</mo><mi id="alg3.l4.m1.2.2" xref="alg3.l4.m1.2.2.cmml">𝑰</mi><mo id="alg3.l4.m1.2.3.3.3.2.3" stretchy="false" xref="alg3.l4.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.2b"><apply id="alg3.l4.m1.2.3.cmml" xref="alg3.l4.m1.2.3"><csymbol cd="latexml" id="alg3.l4.m1.2.3.1.cmml" xref="alg3.l4.m1.2.3.1">similar-to</csymbol><apply id="alg3.l4.m1.2.3.2.cmml" xref="alg3.l4.m1.2.3.2"><csymbol cd="ambiguous" id="alg3.l4.m1.2.3.2.1.cmml" xref="alg3.l4.m1.2.3.2">subscript</csymbol><ci id="alg3.l4.m1.2.3.2.2.cmml" xref="alg3.l4.m1.2.3.2.2">bold-italic-ϵ</ci><cn id="alg3.l4.m1.2.3.2.3.cmml" type="integer" xref="alg3.l4.m1.2.3.2.3">1</cn></apply><apply id="alg3.l4.m1.2.3.3.cmml" xref="alg3.l4.m1.2.3.3"><times id="alg3.l4.m1.2.3.3.1.cmml" xref="alg3.l4.m1.2.3.3.1"></times><ci id="alg3.l4.m1.2.3.3.2.cmml" xref="alg3.l4.m1.2.3.3.2">𝒩</ci><interval closure="open" id="alg3.l4.m1.2.3.3.3.1.cmml" xref="alg3.l4.m1.2.3.3.3.2"><cn id="alg3.l4.m1.1.1.cmml" type="integer" xref="alg3.l4.m1.1.1">0</cn><ci id="alg3.l4.m1.2.2.cmml" xref="alg3.l4.m1.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.2c">\bm{\epsilon}_{1}\sim\mathcal{N}(\mathbf{0},\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg3.l4.m1.2d">bold_italic_ϵ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∼ caligraphic_N ( bold_0 , bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math alttext="\hat{\bm{\epsilon}}_{t+1}={\bm{s}}_{\theta}({\bm{z}}_{t+1},t+1)" class="ltx_Math" display="inline" id="alg3.l5.m1.2"><semantics id="alg3.l5.m1.2a"><mrow id="alg3.l5.m1.2.2" xref="alg3.l5.m1.2.2.cmml"><msub id="alg3.l5.m1.2.2.4" xref="alg3.l5.m1.2.2.4.cmml"><mover accent="true" id="alg3.l5.m1.2.2.4.2" xref="alg3.l5.m1.2.2.4.2.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg3.l5.m1.2.2.4.2.2" mathvariant="bold-italic" xref="alg3.l5.m1.2.2.4.2.2.cmml">ϵ</mi><mo id="alg3.l5.m1.2.2.4.2.1" xref="alg3.l5.m1.2.2.4.2.1.cmml">^</mo></mover><mrow id="alg3.l5.m1.2.2.4.3" xref="alg3.l5.m1.2.2.4.3.cmml"><mi id="alg3.l5.m1.2.2.4.3.2" xref="alg3.l5.m1.2.2.4.3.2.cmml">t</mi><mo id="alg3.l5.m1.2.2.4.3.1" xref="alg3.l5.m1.2.2.4.3.1.cmml">+</mo><mn id="alg3.l5.m1.2.2.4.3.3" xref="alg3.l5.m1.2.2.4.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l5.m1.2.2.3" xref="alg3.l5.m1.2.2.3.cmml">=</mo><mrow id="alg3.l5.m1.2.2.2" xref="alg3.l5.m1.2.2.2.cmml"><msub id="alg3.l5.m1.2.2.2.4" xref="alg3.l5.m1.2.2.2.4.cmml"><mi id="alg3.l5.m1.2.2.2.4.2" xref="alg3.l5.m1.2.2.2.4.2.cmml">𝒔</mi><mi id="alg3.l5.m1.2.2.2.4.3" xref="alg3.l5.m1.2.2.2.4.3.cmml">θ</mi></msub><mo id="alg3.l5.m1.2.2.2.3" xref="alg3.l5.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg3.l5.m1.2.2.2.2.2" xref="alg3.l5.m1.2.2.2.2.3.cmml"><mo id="alg3.l5.m1.2.2.2.2.2.3" stretchy="false" xref="alg3.l5.m1.2.2.2.2.3.cmml">(</mo><msub id="alg3.l5.m1.1.1.1.1.1.1" xref="alg3.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg3.l5.m1.1.1.1.1.1.1.2" xref="alg3.l5.m1.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="alg3.l5.m1.1.1.1.1.1.1.3" xref="alg3.l5.m1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l5.m1.1.1.1.1.1.1.3.2" xref="alg3.l5.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg3.l5.m1.1.1.1.1.1.1.3.1" xref="alg3.l5.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg3.l5.m1.1.1.1.1.1.1.3.3" xref="alg3.l5.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l5.m1.2.2.2.2.2.4" xref="alg3.l5.m1.2.2.2.2.3.cmml">,</mo><mrow id="alg3.l5.m1.2.2.2.2.2.2" xref="alg3.l5.m1.2.2.2.2.2.2.cmml"><mi id="alg3.l5.m1.2.2.2.2.2.2.2" xref="alg3.l5.m1.2.2.2.2.2.2.2.cmml">t</mi><mo id="alg3.l5.m1.2.2.2.2.2.2.1" xref="alg3.l5.m1.2.2.2.2.2.2.1.cmml">+</mo><mn id="alg3.l5.m1.2.2.2.2.2.2.3" xref="alg3.l5.m1.2.2.2.2.2.2.3.cmml">1</mn></mrow><mo id="alg3.l5.m1.2.2.2.2.2.5" stretchy="false" xref="alg3.l5.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.2b"><apply id="alg3.l5.m1.2.2.cmml" xref="alg3.l5.m1.2.2"><eq id="alg3.l5.m1.2.2.3.cmml" xref="alg3.l5.m1.2.2.3"></eq><apply id="alg3.l5.m1.2.2.4.cmml" xref="alg3.l5.m1.2.2.4"><csymbol cd="ambiguous" id="alg3.l5.m1.2.2.4.1.cmml" xref="alg3.l5.m1.2.2.4">subscript</csymbol><apply id="alg3.l5.m1.2.2.4.2.cmml" xref="alg3.l5.m1.2.2.4.2"><ci id="alg3.l5.m1.2.2.4.2.1.cmml" xref="alg3.l5.m1.2.2.4.2.1">^</ci><ci id="alg3.l5.m1.2.2.4.2.2.cmml" xref="alg3.l5.m1.2.2.4.2.2">bold-italic-ϵ</ci></apply><apply id="alg3.l5.m1.2.2.4.3.cmml" xref="alg3.l5.m1.2.2.4.3"><plus id="alg3.l5.m1.2.2.4.3.1.cmml" xref="alg3.l5.m1.2.2.4.3.1"></plus><ci id="alg3.l5.m1.2.2.4.3.2.cmml" xref="alg3.l5.m1.2.2.4.3.2">𝑡</ci><cn id="alg3.l5.m1.2.2.4.3.3.cmml" type="integer" xref="alg3.l5.m1.2.2.4.3.3">1</cn></apply></apply><apply id="alg3.l5.m1.2.2.2.cmml" xref="alg3.l5.m1.2.2.2"><times id="alg3.l5.m1.2.2.2.3.cmml" xref="alg3.l5.m1.2.2.2.3"></times><apply id="alg3.l5.m1.2.2.2.4.cmml" xref="alg3.l5.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg3.l5.m1.2.2.2.4.1.cmml" xref="alg3.l5.m1.2.2.2.4">subscript</csymbol><ci id="alg3.l5.m1.2.2.2.4.2.cmml" xref="alg3.l5.m1.2.2.2.4.2">𝒔</ci><ci id="alg3.l5.m1.2.2.2.4.3.cmml" xref="alg3.l5.m1.2.2.2.4.3">𝜃</ci></apply><interval closure="open" id="alg3.l5.m1.2.2.2.2.3.cmml" xref="alg3.l5.m1.2.2.2.2.2"><apply id="alg3.l5.m1.1.1.1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.2">𝒛</ci><apply id="alg3.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.3"><plus id="alg3.l5.m1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.3.1"></plus><ci id="alg3.l5.m1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l5.m1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="alg3.l5.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg3.l5.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg3.l5.m1.2.2.2.2.2.2.cmml" xref="alg3.l5.m1.2.2.2.2.2.2"><plus id="alg3.l5.m1.2.2.2.2.2.2.1.cmml" xref="alg3.l5.m1.2.2.2.2.2.2.1"></plus><ci id="alg3.l5.m1.2.2.2.2.2.2.2.cmml" xref="alg3.l5.m1.2.2.2.2.2.2.2">𝑡</ci><cn id="alg3.l5.m1.2.2.2.2.2.2.3.cmml" type="integer" xref="alg3.l5.m1.2.2.2.2.2.2.3">1</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.2c">\hat{\bm{\epsilon}}_{t+1}={\bm{s}}_{\theta}({\bm{z}}_{t+1},t+1)</annotation><annotation encoding="application/x-llamapun" id="alg3.l5.m1.2d">over^ start_ARG bold_italic_ϵ end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = bold_italic_s start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_t + 1 )</annotation></semantics></math> <span class="ltx_text" id="alg3.l5.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l5.1.m1.1"><semantics id="alg3.l5.1.m1.1a"><mo id="alg3.l5.1.m1.1.1" xref="alg3.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l5.1.m1.1b"><ci id="alg3.l5.1.m1.1.1.cmml" xref="alg3.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l5.1.m1.1d">▷</annotation></semantics></math> Compute the score
</span>
</div>
<div class="ltx_listingline" id="alg3.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math alttext="\hat{{\bm{z}}}_{0}({\bm{z}}_{t+1})=\frac{1}{\sqrt{\bar{\alpha}_{t+1}}}({\bm{z}%
}_{t+1}-\sqrt{1-\bar{\alpha}_{t+1}}\hat{\bm{\epsilon}}_{t+1})" class="ltx_Math" display="inline" id="alg3.l6.m1.2"><semantics id="alg3.l6.m1.2a"><mrow id="alg3.l6.m1.2.2" xref="alg3.l6.m1.2.2.cmml"><mrow id="alg3.l6.m1.1.1.1" xref="alg3.l6.m1.1.1.1.cmml"><msub id="alg3.l6.m1.1.1.1.3" xref="alg3.l6.m1.1.1.1.3.cmml"><mover accent="true" id="alg3.l6.m1.1.1.1.3.2" xref="alg3.l6.m1.1.1.1.3.2.cmml"><mi id="alg3.l6.m1.1.1.1.3.2.2" xref="alg3.l6.m1.1.1.1.3.2.2.cmml">𝒛</mi><mo id="alg3.l6.m1.1.1.1.3.2.1" xref="alg3.l6.m1.1.1.1.3.2.1.cmml">^</mo></mover><mn id="alg3.l6.m1.1.1.1.3.3" xref="alg3.l6.m1.1.1.1.3.3.cmml">0</mn></msub><mo id="alg3.l6.m1.1.1.1.2" xref="alg3.l6.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l6.m1.1.1.1.1.1" xref="alg3.l6.m1.1.1.1.1.1.1.cmml"><mo id="alg3.l6.m1.1.1.1.1.1.2" stretchy="false" xref="alg3.l6.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg3.l6.m1.1.1.1.1.1.1" xref="alg3.l6.m1.1.1.1.1.1.1.cmml"><mi id="alg3.l6.m1.1.1.1.1.1.1.2" xref="alg3.l6.m1.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="alg3.l6.m1.1.1.1.1.1.1.3" xref="alg3.l6.m1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l6.m1.1.1.1.1.1.1.3.2" xref="alg3.l6.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg3.l6.m1.1.1.1.1.1.1.3.1" xref="alg3.l6.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg3.l6.m1.1.1.1.1.1.1.3.3" xref="alg3.l6.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l6.m1.1.1.1.1.1.3" stretchy="false" xref="alg3.l6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l6.m1.2.2.3" xref="alg3.l6.m1.2.2.3.cmml">=</mo><mrow id="alg3.l6.m1.2.2.2" xref="alg3.l6.m1.2.2.2.cmml"><mfrac id="alg3.l6.m1.2.2.2.3" xref="alg3.l6.m1.2.2.2.3.cmml"><mn id="alg3.l6.m1.2.2.2.3.2" xref="alg3.l6.m1.2.2.2.3.2.cmml">1</mn><msqrt id="alg3.l6.m1.2.2.2.3.3" xref="alg3.l6.m1.2.2.2.3.3.cmml"><msub id="alg3.l6.m1.2.2.2.3.3.2" xref="alg3.l6.m1.2.2.2.3.3.2.cmml"><mover accent="true" id="alg3.l6.m1.2.2.2.3.3.2.2" xref="alg3.l6.m1.2.2.2.3.3.2.2.cmml"><mi id="alg3.l6.m1.2.2.2.3.3.2.2.2" xref="alg3.l6.m1.2.2.2.3.3.2.2.2.cmml">α</mi><mo id="alg3.l6.m1.2.2.2.3.3.2.2.1" xref="alg3.l6.m1.2.2.2.3.3.2.2.1.cmml">¯</mo></mover><mrow id="alg3.l6.m1.2.2.2.3.3.2.3" xref="alg3.l6.m1.2.2.2.3.3.2.3.cmml"><mi id="alg3.l6.m1.2.2.2.3.3.2.3.2" xref="alg3.l6.m1.2.2.2.3.3.2.3.2.cmml">t</mi><mo id="alg3.l6.m1.2.2.2.3.3.2.3.1" xref="alg3.l6.m1.2.2.2.3.3.2.3.1.cmml">+</mo><mn id="alg3.l6.m1.2.2.2.3.3.2.3.3" xref="alg3.l6.m1.2.2.2.3.3.2.3.3.cmml">1</mn></mrow></msub></msqrt></mfrac><mo id="alg3.l6.m1.2.2.2.2" xref="alg3.l6.m1.2.2.2.2.cmml">⁢</mo><mrow id="alg3.l6.m1.2.2.2.1.1" xref="alg3.l6.m1.2.2.2.1.1.1.cmml"><mo id="alg3.l6.m1.2.2.2.1.1.2" stretchy="false" xref="alg3.l6.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="alg3.l6.m1.2.2.2.1.1.1" xref="alg3.l6.m1.2.2.2.1.1.1.cmml"><msub id="alg3.l6.m1.2.2.2.1.1.1.2" xref="alg3.l6.m1.2.2.2.1.1.1.2.cmml"><mi id="alg3.l6.m1.2.2.2.1.1.1.2.2" xref="alg3.l6.m1.2.2.2.1.1.1.2.2.cmml">𝒛</mi><mrow id="alg3.l6.m1.2.2.2.1.1.1.2.3" xref="alg3.l6.m1.2.2.2.1.1.1.2.3.cmml"><mi id="alg3.l6.m1.2.2.2.1.1.1.2.3.2" xref="alg3.l6.m1.2.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="alg3.l6.m1.2.2.2.1.1.1.2.3.1" xref="alg3.l6.m1.2.2.2.1.1.1.2.3.1.cmml">+</mo><mn id="alg3.l6.m1.2.2.2.1.1.1.2.3.3" xref="alg3.l6.m1.2.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l6.m1.2.2.2.1.1.1.1" xref="alg3.l6.m1.2.2.2.1.1.1.1.cmml">−</mo><mrow id="alg3.l6.m1.2.2.2.1.1.1.3" xref="alg3.l6.m1.2.2.2.1.1.1.3.cmml"><msqrt id="alg3.l6.m1.2.2.2.1.1.1.3.2" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.cmml"><mrow id="alg3.l6.m1.2.2.2.1.1.1.3.2.2" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.cmml"><mn id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.2" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.2.cmml">1</mn><mo id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.1" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.1.cmml">−</mo><msub id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.cmml"><mover accent="true" id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2.cmml"><mi id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2.2" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2.2.cmml">α</mi><mo id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2.1" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2.1.cmml">¯</mo></mover><mrow id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.cmml"><mi id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.2" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.2.cmml">t</mi><mo id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.1" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.1.cmml">+</mo><mn id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.3" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow></msqrt><mo id="alg3.l6.m1.2.2.2.1.1.1.3.1" xref="alg3.l6.m1.2.2.2.1.1.1.3.1.cmml">⁢</mo><msub id="alg3.l6.m1.2.2.2.1.1.1.3.3" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.cmml"><mover accent="true" id="alg3.l6.m1.2.2.2.1.1.1.3.3.2" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.2.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg3.l6.m1.2.2.2.1.1.1.3.3.2.2" mathvariant="bold-italic" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.2.2.cmml">ϵ</mi><mo id="alg3.l6.m1.2.2.2.1.1.1.3.3.2.1" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.2.1.cmml">^</mo></mover><mrow id="alg3.l6.m1.2.2.2.1.1.1.3.3.3" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.3.cmml"><mi id="alg3.l6.m1.2.2.2.1.1.1.3.3.3.2" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.3.2.cmml">t</mi><mo id="alg3.l6.m1.2.2.2.1.1.1.3.3.3.1" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.3.1.cmml">+</mo><mn id="alg3.l6.m1.2.2.2.1.1.1.3.3.3.3" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="alg3.l6.m1.2.2.2.1.1.3" stretchy="false" xref="alg3.l6.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.2b"><apply id="alg3.l6.m1.2.2.cmml" xref="alg3.l6.m1.2.2"><eq id="alg3.l6.m1.2.2.3.cmml" xref="alg3.l6.m1.2.2.3"></eq><apply id="alg3.l6.m1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1"><times id="alg3.l6.m1.1.1.1.2.cmml" xref="alg3.l6.m1.1.1.1.2"></times><apply id="alg3.l6.m1.1.1.1.3.cmml" xref="alg3.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l6.m1.1.1.1.3.1.cmml" xref="alg3.l6.m1.1.1.1.3">subscript</csymbol><apply id="alg3.l6.m1.1.1.1.3.2.cmml" xref="alg3.l6.m1.1.1.1.3.2"><ci id="alg3.l6.m1.1.1.1.3.2.1.cmml" xref="alg3.l6.m1.1.1.1.3.2.1">^</ci><ci id="alg3.l6.m1.1.1.1.3.2.2.cmml" xref="alg3.l6.m1.1.1.1.3.2.2">𝒛</ci></apply><cn id="alg3.l6.m1.1.1.1.3.3.cmml" type="integer" xref="alg3.l6.m1.1.1.1.3.3">0</cn></apply><apply id="alg3.l6.m1.1.1.1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l6.m1.1.1.1.1.1.1.2">𝒛</ci><apply id="alg3.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l6.m1.1.1.1.1.1.1.3"><plus id="alg3.l6.m1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l6.m1.1.1.1.1.1.1.3.1"></plus><ci id="alg3.l6.m1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l6.m1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="alg3.l6.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg3.l6.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="alg3.l6.m1.2.2.2.cmml" xref="alg3.l6.m1.2.2.2"><times id="alg3.l6.m1.2.2.2.2.cmml" xref="alg3.l6.m1.2.2.2.2"></times><apply id="alg3.l6.m1.2.2.2.3.cmml" xref="alg3.l6.m1.2.2.2.3"><divide id="alg3.l6.m1.2.2.2.3.1.cmml" xref="alg3.l6.m1.2.2.2.3"></divide><cn id="alg3.l6.m1.2.2.2.3.2.cmml" type="integer" xref="alg3.l6.m1.2.2.2.3.2">1</cn><apply id="alg3.l6.m1.2.2.2.3.3.cmml" xref="alg3.l6.m1.2.2.2.3.3"><root id="alg3.l6.m1.2.2.2.3.3a.cmml" xref="alg3.l6.m1.2.2.2.3.3"></root><apply id="alg3.l6.m1.2.2.2.3.3.2.cmml" xref="alg3.l6.m1.2.2.2.3.3.2"><csymbol cd="ambiguous" id="alg3.l6.m1.2.2.2.3.3.2.1.cmml" xref="alg3.l6.m1.2.2.2.3.3.2">subscript</csymbol><apply id="alg3.l6.m1.2.2.2.3.3.2.2.cmml" xref="alg3.l6.m1.2.2.2.3.3.2.2"><ci id="alg3.l6.m1.2.2.2.3.3.2.2.1.cmml" xref="alg3.l6.m1.2.2.2.3.3.2.2.1">¯</ci><ci id="alg3.l6.m1.2.2.2.3.3.2.2.2.cmml" xref="alg3.l6.m1.2.2.2.3.3.2.2.2">𝛼</ci></apply><apply id="alg3.l6.m1.2.2.2.3.3.2.3.cmml" xref="alg3.l6.m1.2.2.2.3.3.2.3"><plus id="alg3.l6.m1.2.2.2.3.3.2.3.1.cmml" xref="alg3.l6.m1.2.2.2.3.3.2.3.1"></plus><ci id="alg3.l6.m1.2.2.2.3.3.2.3.2.cmml" xref="alg3.l6.m1.2.2.2.3.3.2.3.2">𝑡</ci><cn id="alg3.l6.m1.2.2.2.3.3.2.3.3.cmml" type="integer" xref="alg3.l6.m1.2.2.2.3.3.2.3.3">1</cn></apply></apply></apply></apply><apply id="alg3.l6.m1.2.2.2.1.1.1.cmml" xref="alg3.l6.m1.2.2.2.1.1"><minus id="alg3.l6.m1.2.2.2.1.1.1.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.1"></minus><apply id="alg3.l6.m1.2.2.2.1.1.1.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l6.m1.2.2.2.1.1.1.2.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.2">subscript</csymbol><ci id="alg3.l6.m1.2.2.2.1.1.1.2.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.2.2">𝒛</ci><apply id="alg3.l6.m1.2.2.2.1.1.1.2.3.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.2.3"><plus id="alg3.l6.m1.2.2.2.1.1.1.2.3.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.2.3.1"></plus><ci id="alg3.l6.m1.2.2.2.1.1.1.2.3.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.2.3.2">𝑡</ci><cn id="alg3.l6.m1.2.2.2.1.1.1.2.3.3.cmml" type="integer" xref="alg3.l6.m1.2.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="alg3.l6.m1.2.2.2.1.1.1.3.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3"><times id="alg3.l6.m1.2.2.2.1.1.1.3.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.1"></times><apply id="alg3.l6.m1.2.2.2.1.1.1.3.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2"><root id="alg3.l6.m1.2.2.2.1.1.1.3.2a.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2"></root><apply id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2"><minus id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.1"></minus><cn id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.2.cmml" type="integer" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.2">1</cn><apply id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3">subscript</csymbol><apply id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2"><ci id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2.1">¯</ci><ci id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.2.2">𝛼</ci></apply><apply id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3"><plus id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.1"></plus><ci id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.2">𝑡</ci><cn id="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.3.cmml" type="integer" xref="alg3.l6.m1.2.2.2.1.1.1.3.2.2.3.3.3">1</cn></apply></apply></apply></apply><apply id="alg3.l6.m1.2.2.2.1.1.1.3.3.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="alg3.l6.m1.2.2.2.1.1.1.3.3.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.3">subscript</csymbol><apply id="alg3.l6.m1.2.2.2.1.1.1.3.3.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.2"><ci id="alg3.l6.m1.2.2.2.1.1.1.3.3.2.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.2.1">^</ci><ci id="alg3.l6.m1.2.2.2.1.1.1.3.3.2.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.2.2">bold-italic-ϵ</ci></apply><apply id="alg3.l6.m1.2.2.2.1.1.1.3.3.3.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.3"><plus id="alg3.l6.m1.2.2.2.1.1.1.3.3.3.1.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.3.1"></plus><ci id="alg3.l6.m1.2.2.2.1.1.1.3.3.3.2.cmml" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.3.2">𝑡</ci><cn id="alg3.l6.m1.2.2.2.1.1.1.3.3.3.3.cmml" type="integer" xref="alg3.l6.m1.2.2.2.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.2c">\hat{{\bm{z}}}_{0}({\bm{z}}_{t+1})=\frac{1}{\sqrt{\bar{\alpha}_{t+1}}}({\bm{z}%
}_{t+1}-\sqrt{1-\bar{\alpha}_{t+1}}\hat{\bm{\epsilon}}_{t+1})</annotation><annotation encoding="application/x-llamapun" id="alg3.l6.m1.2d">over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) = divide start_ARG 1 end_ARG start_ARG square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT end_ARG end_ARG ( bold_italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT - square-root start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT end_ARG over^ start_ARG bold_italic_ϵ end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg3.l6.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l6.1.m1.1"><semantics id="alg3.l6.1.m1.1a"><mo id="alg3.l6.1.m1.1.1" xref="alg3.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l6.1.m1.1b"><ci id="alg3.l6.1.m1.1.1.cmml" xref="alg3.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l6.1.m1.1d">▷</annotation></semantics></math> Predict <math alttext="\hat{{\bm{z}}}_{0}" class="ltx_Math" display="inline" id="alg3.l6.2.m2.1"><semantics id="alg3.l6.2.m2.1a"><msub id="alg3.l6.2.m2.1.1" xref="alg3.l6.2.m2.1.1.cmml"><mover accent="true" id="alg3.l6.2.m2.1.1.2" xref="alg3.l6.2.m2.1.1.2.cmml"><mi id="alg3.l6.2.m2.1.1.2.2" xref="alg3.l6.2.m2.1.1.2.2.cmml">𝒛</mi><mo id="alg3.l6.2.m2.1.1.2.1" xref="alg3.l6.2.m2.1.1.2.1.cmml">^</mo></mover><mn id="alg3.l6.2.m2.1.1.3" xref="alg3.l6.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg3.l6.2.m2.1b"><apply id="alg3.l6.2.m2.1.1.cmml" xref="alg3.l6.2.m2.1.1"><csymbol cd="ambiguous" id="alg3.l6.2.m2.1.1.1.cmml" xref="alg3.l6.2.m2.1.1">subscript</csymbol><apply id="alg3.l6.2.m2.1.1.2.cmml" xref="alg3.l6.2.m2.1.1.2"><ci id="alg3.l6.2.m2.1.1.2.1.cmml" xref="alg3.l6.2.m2.1.1.2.1">^</ci><ci id="alg3.l6.2.m2.1.1.2.2.cmml" xref="alg3.l6.2.m2.1.1.2.2">𝒛</ci></apply><cn id="alg3.l6.2.m2.1.1.3.cmml" type="integer" xref="alg3.l6.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.2.m2.1c">\hat{{\bm{z}}}_{0}</annotation><annotation encoding="application/x-llamapun" id="alg3.l6.2.m2.1d">over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> using Tweedie’s formula
</span>
</div>
<div class="ltx_listingline" id="alg3.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math alttext="{\bm{z}}^{\prime}_{t}=\sqrt{\bar{\alpha}_{t}}\hat{{\bm{z}}}_{0}({\bm{z}}_{t+1}%
)+\sqrt{1-\bar{\alpha}_{t}-\eta\delta^{2}}\hat{\bm{\epsilon}}_{t+1}+\eta\delta%
\bm{\epsilon}_{1}" class="ltx_Math" display="inline" id="alg3.l7.m1.1"><semantics id="alg3.l7.m1.1a"><mrow id="alg3.l7.m1.1.1" xref="alg3.l7.m1.1.1.cmml"><msubsup id="alg3.l7.m1.1.1.3" xref="alg3.l7.m1.1.1.3.cmml"><mi id="alg3.l7.m1.1.1.3.2.2" xref="alg3.l7.m1.1.1.3.2.2.cmml">𝒛</mi><mi id="alg3.l7.m1.1.1.3.3" xref="alg3.l7.m1.1.1.3.3.cmml">t</mi><mo id="alg3.l7.m1.1.1.3.2.3" xref="alg3.l7.m1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="alg3.l7.m1.1.1.2" xref="alg3.l7.m1.1.1.2.cmml">=</mo><mrow id="alg3.l7.m1.1.1.1" xref="alg3.l7.m1.1.1.1.cmml"><mrow id="alg3.l7.m1.1.1.1.1" xref="alg3.l7.m1.1.1.1.1.cmml"><msqrt id="alg3.l7.m1.1.1.1.1.3" xref="alg3.l7.m1.1.1.1.1.3.cmml"><msub id="alg3.l7.m1.1.1.1.1.3.2" xref="alg3.l7.m1.1.1.1.1.3.2.cmml"><mover accent="true" id="alg3.l7.m1.1.1.1.1.3.2.2" xref="alg3.l7.m1.1.1.1.1.3.2.2.cmml"><mi id="alg3.l7.m1.1.1.1.1.3.2.2.2" xref="alg3.l7.m1.1.1.1.1.3.2.2.2.cmml">α</mi><mo id="alg3.l7.m1.1.1.1.1.3.2.2.1" xref="alg3.l7.m1.1.1.1.1.3.2.2.1.cmml">¯</mo></mover><mi id="alg3.l7.m1.1.1.1.1.3.2.3" xref="alg3.l7.m1.1.1.1.1.3.2.3.cmml">t</mi></msub></msqrt><mo id="alg3.l7.m1.1.1.1.1.2" xref="alg3.l7.m1.1.1.1.1.2.cmml">⁢</mo><msub id="alg3.l7.m1.1.1.1.1.4" xref="alg3.l7.m1.1.1.1.1.4.cmml"><mover accent="true" id="alg3.l7.m1.1.1.1.1.4.2" xref="alg3.l7.m1.1.1.1.1.4.2.cmml"><mi id="alg3.l7.m1.1.1.1.1.4.2.2" xref="alg3.l7.m1.1.1.1.1.4.2.2.cmml">𝒛</mi><mo id="alg3.l7.m1.1.1.1.1.4.2.1" xref="alg3.l7.m1.1.1.1.1.4.2.1.cmml">^</mo></mover><mn id="alg3.l7.m1.1.1.1.1.4.3" xref="alg3.l7.m1.1.1.1.1.4.3.cmml">0</mn></msub><mo id="alg3.l7.m1.1.1.1.1.2a" xref="alg3.l7.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l7.m1.1.1.1.1.1.1" xref="alg3.l7.m1.1.1.1.1.1.1.1.cmml"><mo id="alg3.l7.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg3.l7.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg3.l7.m1.1.1.1.1.1.1.1" xref="alg3.l7.m1.1.1.1.1.1.1.1.cmml"><mi id="alg3.l7.m1.1.1.1.1.1.1.1.2" xref="alg3.l7.m1.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="alg3.l7.m1.1.1.1.1.1.1.1.3" xref="alg3.l7.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l7.m1.1.1.1.1.1.1.1.3.2" xref="alg3.l7.m1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg3.l7.m1.1.1.1.1.1.1.1.3.1" xref="alg3.l7.m1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg3.l7.m1.1.1.1.1.1.1.1.3.3" xref="alg3.l7.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l7.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg3.l7.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l7.m1.1.1.1.2" xref="alg3.l7.m1.1.1.1.2.cmml">+</mo><mrow id="alg3.l7.m1.1.1.1.3" xref="alg3.l7.m1.1.1.1.3.cmml"><msqrt id="alg3.l7.m1.1.1.1.3.2" xref="alg3.l7.m1.1.1.1.3.2.cmml"><mrow id="alg3.l7.m1.1.1.1.3.2.2" xref="alg3.l7.m1.1.1.1.3.2.2.cmml"><mn id="alg3.l7.m1.1.1.1.3.2.2.2" xref="alg3.l7.m1.1.1.1.3.2.2.2.cmml">1</mn><mo id="alg3.l7.m1.1.1.1.3.2.2.1" xref="alg3.l7.m1.1.1.1.3.2.2.1.cmml">−</mo><msub id="alg3.l7.m1.1.1.1.3.2.2.3" xref="alg3.l7.m1.1.1.1.3.2.2.3.cmml"><mover accent="true" id="alg3.l7.m1.1.1.1.3.2.2.3.2" xref="alg3.l7.m1.1.1.1.3.2.2.3.2.cmml"><mi id="alg3.l7.m1.1.1.1.3.2.2.3.2.2" xref="alg3.l7.m1.1.1.1.3.2.2.3.2.2.cmml">α</mi><mo id="alg3.l7.m1.1.1.1.3.2.2.3.2.1" xref="alg3.l7.m1.1.1.1.3.2.2.3.2.1.cmml">¯</mo></mover><mi id="alg3.l7.m1.1.1.1.3.2.2.3.3" xref="alg3.l7.m1.1.1.1.3.2.2.3.3.cmml">t</mi></msub><mo id="alg3.l7.m1.1.1.1.3.2.2.1a" xref="alg3.l7.m1.1.1.1.3.2.2.1.cmml">−</mo><mrow id="alg3.l7.m1.1.1.1.3.2.2.4" xref="alg3.l7.m1.1.1.1.3.2.2.4.cmml"><mi id="alg3.l7.m1.1.1.1.3.2.2.4.2" xref="alg3.l7.m1.1.1.1.3.2.2.4.2.cmml">η</mi><mo id="alg3.l7.m1.1.1.1.3.2.2.4.1" xref="alg3.l7.m1.1.1.1.3.2.2.4.1.cmml">⁢</mo><msup id="alg3.l7.m1.1.1.1.3.2.2.4.3" xref="alg3.l7.m1.1.1.1.3.2.2.4.3.cmml"><mi id="alg3.l7.m1.1.1.1.3.2.2.4.3.2" xref="alg3.l7.m1.1.1.1.3.2.2.4.3.2.cmml">δ</mi><mn id="alg3.l7.m1.1.1.1.3.2.2.4.3.3" xref="alg3.l7.m1.1.1.1.3.2.2.4.3.3.cmml">2</mn></msup></mrow></mrow></msqrt><mo id="alg3.l7.m1.1.1.1.3.1" xref="alg3.l7.m1.1.1.1.3.1.cmml">⁢</mo><msub id="alg3.l7.m1.1.1.1.3.3" xref="alg3.l7.m1.1.1.1.3.3.cmml"><mover accent="true" id="alg3.l7.m1.1.1.1.3.3.2" xref="alg3.l7.m1.1.1.1.3.3.2.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg3.l7.m1.1.1.1.3.3.2.2" mathvariant="bold-italic" xref="alg3.l7.m1.1.1.1.3.3.2.2.cmml">ϵ</mi><mo id="alg3.l7.m1.1.1.1.3.3.2.1" xref="alg3.l7.m1.1.1.1.3.3.2.1.cmml">^</mo></mover><mrow id="alg3.l7.m1.1.1.1.3.3.3" xref="alg3.l7.m1.1.1.1.3.3.3.cmml"><mi id="alg3.l7.m1.1.1.1.3.3.3.2" xref="alg3.l7.m1.1.1.1.3.3.3.2.cmml">t</mi><mo id="alg3.l7.m1.1.1.1.3.3.3.1" xref="alg3.l7.m1.1.1.1.3.3.3.1.cmml">+</mo><mn id="alg3.l7.m1.1.1.1.3.3.3.3" xref="alg3.l7.m1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg3.l7.m1.1.1.1.2a" xref="alg3.l7.m1.1.1.1.2.cmml">+</mo><mrow id="alg3.l7.m1.1.1.1.4" xref="alg3.l7.m1.1.1.1.4.cmml"><mi id="alg3.l7.m1.1.1.1.4.2" xref="alg3.l7.m1.1.1.1.4.2.cmml">η</mi><mo id="alg3.l7.m1.1.1.1.4.1" xref="alg3.l7.m1.1.1.1.4.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.1.4.3" xref="alg3.l7.m1.1.1.1.4.3.cmml">δ</mi><mo id="alg3.l7.m1.1.1.1.4.1a" xref="alg3.l7.m1.1.1.1.4.1.cmml">⁢</mo><msub id="alg3.l7.m1.1.1.1.4.4" xref="alg3.l7.m1.1.1.1.4.4.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg3.l7.m1.1.1.1.4.4.2" mathvariant="bold-italic" xref="alg3.l7.m1.1.1.1.4.4.2.cmml">ϵ</mi><mn id="alg3.l7.m1.1.1.1.4.4.3" xref="alg3.l7.m1.1.1.1.4.4.3.cmml">1</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l7.m1.1b"><apply id="alg3.l7.m1.1.1.cmml" xref="alg3.l7.m1.1.1"><eq id="alg3.l7.m1.1.1.2.cmml" xref="alg3.l7.m1.1.1.2"></eq><apply id="alg3.l7.m1.1.1.3.cmml" xref="alg3.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.3.1.cmml" xref="alg3.l7.m1.1.1.3">subscript</csymbol><apply id="alg3.l7.m1.1.1.3.2.cmml" xref="alg3.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.3.2.1.cmml" xref="alg3.l7.m1.1.1.3">superscript</csymbol><ci id="alg3.l7.m1.1.1.3.2.2.cmml" xref="alg3.l7.m1.1.1.3.2.2">𝒛</ci><ci id="alg3.l7.m1.1.1.3.2.3.cmml" xref="alg3.l7.m1.1.1.3.2.3">′</ci></apply><ci id="alg3.l7.m1.1.1.3.3.cmml" xref="alg3.l7.m1.1.1.3.3">𝑡</ci></apply><apply id="alg3.l7.m1.1.1.1.cmml" xref="alg3.l7.m1.1.1.1"><plus id="alg3.l7.m1.1.1.1.2.cmml" xref="alg3.l7.m1.1.1.1.2"></plus><apply id="alg3.l7.m1.1.1.1.1.cmml" xref="alg3.l7.m1.1.1.1.1"><times id="alg3.l7.m1.1.1.1.1.2.cmml" xref="alg3.l7.m1.1.1.1.1.2"></times><apply id="alg3.l7.m1.1.1.1.1.3.cmml" xref="alg3.l7.m1.1.1.1.1.3"><root id="alg3.l7.m1.1.1.1.1.3a.cmml" xref="alg3.l7.m1.1.1.1.1.3"></root><apply id="alg3.l7.m1.1.1.1.1.3.2.cmml" xref="alg3.l7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.1.1.3.2.1.cmml" xref="alg3.l7.m1.1.1.1.1.3.2">subscript</csymbol><apply id="alg3.l7.m1.1.1.1.1.3.2.2.cmml" xref="alg3.l7.m1.1.1.1.1.3.2.2"><ci id="alg3.l7.m1.1.1.1.1.3.2.2.1.cmml" xref="alg3.l7.m1.1.1.1.1.3.2.2.1">¯</ci><ci id="alg3.l7.m1.1.1.1.1.3.2.2.2.cmml" xref="alg3.l7.m1.1.1.1.1.3.2.2.2">𝛼</ci></apply><ci id="alg3.l7.m1.1.1.1.1.3.2.3.cmml" xref="alg3.l7.m1.1.1.1.1.3.2.3">𝑡</ci></apply></apply><apply id="alg3.l7.m1.1.1.1.1.4.cmml" xref="alg3.l7.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.1.1.4.1.cmml" xref="alg3.l7.m1.1.1.1.1.4">subscript</csymbol><apply id="alg3.l7.m1.1.1.1.1.4.2.cmml" xref="alg3.l7.m1.1.1.1.1.4.2"><ci id="alg3.l7.m1.1.1.1.1.4.2.1.cmml" xref="alg3.l7.m1.1.1.1.1.4.2.1">^</ci><ci id="alg3.l7.m1.1.1.1.1.4.2.2.cmml" xref="alg3.l7.m1.1.1.1.1.4.2.2">𝒛</ci></apply><cn id="alg3.l7.m1.1.1.1.1.4.3.cmml" type="integer" xref="alg3.l7.m1.1.1.1.1.4.3">0</cn></apply><apply id="alg3.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l7.m1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l7.m1.1.1.1.1.1.1.1.2">𝒛</ci><apply id="alg3.l7.m1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l7.m1.1.1.1.1.1.1.1.3"><plus id="alg3.l7.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l7.m1.1.1.1.1.1.1.1.3.1"></plus><ci id="alg3.l7.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l7.m1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="alg3.l7.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg3.l7.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="alg3.l7.m1.1.1.1.3.cmml" xref="alg3.l7.m1.1.1.1.3"><times id="alg3.l7.m1.1.1.1.3.1.cmml" xref="alg3.l7.m1.1.1.1.3.1"></times><apply id="alg3.l7.m1.1.1.1.3.2.cmml" xref="alg3.l7.m1.1.1.1.3.2"><root id="alg3.l7.m1.1.1.1.3.2a.cmml" xref="alg3.l7.m1.1.1.1.3.2"></root><apply id="alg3.l7.m1.1.1.1.3.2.2.cmml" xref="alg3.l7.m1.1.1.1.3.2.2"><minus id="alg3.l7.m1.1.1.1.3.2.2.1.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.1"></minus><cn id="alg3.l7.m1.1.1.1.3.2.2.2.cmml" type="integer" xref="alg3.l7.m1.1.1.1.3.2.2.2">1</cn><apply id="alg3.l7.m1.1.1.1.3.2.2.3.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.1.3.2.2.3.1.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.3">subscript</csymbol><apply id="alg3.l7.m1.1.1.1.3.2.2.3.2.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.3.2"><ci id="alg3.l7.m1.1.1.1.3.2.2.3.2.1.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.3.2.1">¯</ci><ci id="alg3.l7.m1.1.1.1.3.2.2.3.2.2.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.3.2.2">𝛼</ci></apply><ci id="alg3.l7.m1.1.1.1.3.2.2.3.3.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.3.3">𝑡</ci></apply><apply id="alg3.l7.m1.1.1.1.3.2.2.4.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.4"><times id="alg3.l7.m1.1.1.1.3.2.2.4.1.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.4.1"></times><ci id="alg3.l7.m1.1.1.1.3.2.2.4.2.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.4.2">𝜂</ci><apply id="alg3.l7.m1.1.1.1.3.2.2.4.3.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.4.3"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.1.3.2.2.4.3.1.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.4.3">superscript</csymbol><ci id="alg3.l7.m1.1.1.1.3.2.2.4.3.2.cmml" xref="alg3.l7.m1.1.1.1.3.2.2.4.3.2">𝛿</ci><cn id="alg3.l7.m1.1.1.1.3.2.2.4.3.3.cmml" type="integer" xref="alg3.l7.m1.1.1.1.3.2.2.4.3.3">2</cn></apply></apply></apply></apply><apply id="alg3.l7.m1.1.1.1.3.3.cmml" xref="alg3.l7.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.1.3.3.1.cmml" xref="alg3.l7.m1.1.1.1.3.3">subscript</csymbol><apply id="alg3.l7.m1.1.1.1.3.3.2.cmml" xref="alg3.l7.m1.1.1.1.3.3.2"><ci id="alg3.l7.m1.1.1.1.3.3.2.1.cmml" xref="alg3.l7.m1.1.1.1.3.3.2.1">^</ci><ci id="alg3.l7.m1.1.1.1.3.3.2.2.cmml" xref="alg3.l7.m1.1.1.1.3.3.2.2">bold-italic-ϵ</ci></apply><apply id="alg3.l7.m1.1.1.1.3.3.3.cmml" xref="alg3.l7.m1.1.1.1.3.3.3"><plus id="alg3.l7.m1.1.1.1.3.3.3.1.cmml" xref="alg3.l7.m1.1.1.1.3.3.3.1"></plus><ci id="alg3.l7.m1.1.1.1.3.3.3.2.cmml" xref="alg3.l7.m1.1.1.1.3.3.3.2">𝑡</ci><cn id="alg3.l7.m1.1.1.1.3.3.3.3.cmml" type="integer" xref="alg3.l7.m1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="alg3.l7.m1.1.1.1.4.cmml" xref="alg3.l7.m1.1.1.1.4"><times id="alg3.l7.m1.1.1.1.4.1.cmml" xref="alg3.l7.m1.1.1.1.4.1"></times><ci id="alg3.l7.m1.1.1.1.4.2.cmml" xref="alg3.l7.m1.1.1.1.4.2">𝜂</ci><ci id="alg3.l7.m1.1.1.1.4.3.cmml" xref="alg3.l7.m1.1.1.1.4.3">𝛿</ci><apply id="alg3.l7.m1.1.1.1.4.4.cmml" xref="alg3.l7.m1.1.1.1.4.4"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.1.4.4.1.cmml" xref="alg3.l7.m1.1.1.1.4.4">subscript</csymbol><ci id="alg3.l7.m1.1.1.1.4.4.2.cmml" xref="alg3.l7.m1.1.1.1.4.4.2">bold-italic-ϵ</ci><cn id="alg3.l7.m1.1.1.1.4.4.3.cmml" type="integer" xref="alg3.l7.m1.1.1.1.4.4.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m1.1c">{\bm{z}}^{\prime}_{t}=\sqrt{\bar{\alpha}_{t}}\hat{{\bm{z}}}_{0}({\bm{z}}_{t+1}%
)+\sqrt{1-\bar{\alpha}_{t}-\eta\delta^{2}}\hat{\bm{\epsilon}}_{t+1}+\eta\delta%
\bm{\epsilon}_{1}</annotation><annotation encoding="application/x-llamapun" id="alg3.l7.m1.1d">bold_italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) + square-root start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_η italic_δ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG over^ start_ARG bold_italic_ϵ end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT + italic_η italic_δ bold_italic_ϵ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg3.l7.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l7.1.m1.1"><semantics id="alg3.l7.1.m1.1a"><mo id="alg3.l7.1.m1.1.1" xref="alg3.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l7.1.m1.1b"><ci id="alg3.l7.1.m1.1.1.cmml" xref="alg3.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l7.1.m1.1d">▷</annotation></semantics></math> Unconditional DDIM step
</span>
</div>
<div class="ltx_listingline" id="alg3.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l8.2">if</span> <math alttext="t\in C" class="ltx_Math" display="inline" id="alg3.l8.m1.1"><semantics id="alg3.l8.m1.1a"><mrow id="alg3.l8.m1.1.1" xref="alg3.l8.m1.1.1.cmml"><mi id="alg3.l8.m1.1.1.2" xref="alg3.l8.m1.1.1.2.cmml">t</mi><mo id="alg3.l8.m1.1.1.1" xref="alg3.l8.m1.1.1.1.cmml">∈</mo><mi id="alg3.l8.m1.1.1.3" xref="alg3.l8.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l8.m1.1b"><apply id="alg3.l8.m1.1.1.cmml" xref="alg3.l8.m1.1.1"><in id="alg3.l8.m1.1.1.1.cmml" xref="alg3.l8.m1.1.1.1"></in><ci id="alg3.l8.m1.1.1.2.cmml" xref="alg3.l8.m1.1.1.2">𝑡</ci><ci id="alg3.l8.m1.1.1.3.cmml" xref="alg3.l8.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.m1.1c">t\in C</annotation><annotation encoding="application/x-llamapun" id="alg3.l8.m1.1d">italic_t ∈ italic_C</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.l8.3">then</span> <span class="ltx_text" id="alg3.l8.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l8.1.m1.1"><semantics id="alg3.l8.1.m1.1a"><mo id="alg3.l8.1.m1.1.1" xref="alg3.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l8.1.m1.1b"><ci id="alg3.l8.1.m1.1.1.cmml" xref="alg3.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l8.1.m1.1d">▷</annotation></semantics></math> ReSample time step
</span>
</div>
<div class="ltx_listingline" id="alg3.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>         <span class="ltx_text" id="alg3.l9.2" style="color:#0000FF;"> Initialize <math alttext="\hat{{\bm{z}}}_{0}({\bm{y}})" class="ltx_Math" display="inline" id="alg3.l9.1.m1.1"><semantics id="alg3.l9.1.m1.1a"><mrow id="alg3.l9.1.m1.1.2" xref="alg3.l9.1.m1.1.2.cmml"><msub id="alg3.l9.1.m1.1.2.2" xref="alg3.l9.1.m1.1.2.2.cmml"><mover accent="true" id="alg3.l9.1.m1.1.2.2.2" xref="alg3.l9.1.m1.1.2.2.2.cmml"><mi id="alg3.l9.1.m1.1.2.2.2.2" mathcolor="#0000FF" xref="alg3.l9.1.m1.1.2.2.2.2.cmml">𝒛</mi><mo id="alg3.l9.1.m1.1.2.2.2.1" mathcolor="#0000FF" xref="alg3.l9.1.m1.1.2.2.2.1.cmml">^</mo></mover><mn id="alg3.l9.1.m1.1.2.2.3" mathcolor="#0000FF" xref="alg3.l9.1.m1.1.2.2.3.cmml">0</mn></msub><mo id="alg3.l9.1.m1.1.2.1" xref="alg3.l9.1.m1.1.2.1.cmml">⁢</mo><mrow id="alg3.l9.1.m1.1.2.3.2" xref="alg3.l9.1.m1.1.2.cmml"><mo id="alg3.l9.1.m1.1.2.3.2.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l9.1.m1.1.2.cmml">(</mo><mi id="alg3.l9.1.m1.1.1" mathcolor="#0000FF" xref="alg3.l9.1.m1.1.1.cmml">𝒚</mi><mo id="alg3.l9.1.m1.1.2.3.2.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l9.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.1.m1.1b"><apply id="alg3.l9.1.m1.1.2.cmml" xref="alg3.l9.1.m1.1.2"><times id="alg3.l9.1.m1.1.2.1.cmml" xref="alg3.l9.1.m1.1.2.1"></times><apply id="alg3.l9.1.m1.1.2.2.cmml" xref="alg3.l9.1.m1.1.2.2"><csymbol cd="ambiguous" id="alg3.l9.1.m1.1.2.2.1.cmml" xref="alg3.l9.1.m1.1.2.2">subscript</csymbol><apply id="alg3.l9.1.m1.1.2.2.2.cmml" xref="alg3.l9.1.m1.1.2.2.2"><ci id="alg3.l9.1.m1.1.2.2.2.1.cmml" xref="alg3.l9.1.m1.1.2.2.2.1">^</ci><ci id="alg3.l9.1.m1.1.2.2.2.2.cmml" xref="alg3.l9.1.m1.1.2.2.2.2">𝒛</ci></apply><cn id="alg3.l9.1.m1.1.2.2.3.cmml" type="integer" xref="alg3.l9.1.m1.1.2.2.3">0</cn></apply><ci id="alg3.l9.1.m1.1.1.cmml" xref="alg3.l9.1.m1.1.1">𝒚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.1.m1.1c">\hat{{\bm{z}}}_{0}({\bm{y}})</annotation><annotation encoding="application/x-llamapun" id="alg3.l9.1.m1.1d">over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_y )</annotation></semantics></math> with <math alttext="\hat{{\bm{z}}}_{0}({\bm{z}}_{t+1})" class="ltx_Math" display="inline" id="alg3.l9.2.m2.1"><semantics id="alg3.l9.2.m2.1a"><mrow id="alg3.l9.2.m2.1.1" xref="alg3.l9.2.m2.1.1.cmml"><msub id="alg3.l9.2.m2.1.1.3" xref="alg3.l9.2.m2.1.1.3.cmml"><mover accent="true" id="alg3.l9.2.m2.1.1.3.2" xref="alg3.l9.2.m2.1.1.3.2.cmml"><mi id="alg3.l9.2.m2.1.1.3.2.2" mathcolor="#0000FF" xref="alg3.l9.2.m2.1.1.3.2.2.cmml">𝒛</mi><mo id="alg3.l9.2.m2.1.1.3.2.1" mathcolor="#0000FF" xref="alg3.l9.2.m2.1.1.3.2.1.cmml">^</mo></mover><mn id="alg3.l9.2.m2.1.1.3.3" mathcolor="#0000FF" xref="alg3.l9.2.m2.1.1.3.3.cmml">0</mn></msub><mo id="alg3.l9.2.m2.1.1.2" xref="alg3.l9.2.m2.1.1.2.cmml">⁢</mo><mrow id="alg3.l9.2.m2.1.1.1.1" xref="alg3.l9.2.m2.1.1.1.1.1.cmml"><mo id="alg3.l9.2.m2.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l9.2.m2.1.1.1.1.1.cmml">(</mo><msub id="alg3.l9.2.m2.1.1.1.1.1" xref="alg3.l9.2.m2.1.1.1.1.1.cmml"><mi id="alg3.l9.2.m2.1.1.1.1.1.2" mathcolor="#0000FF" xref="alg3.l9.2.m2.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="alg3.l9.2.m2.1.1.1.1.1.3" xref="alg3.l9.2.m2.1.1.1.1.1.3.cmml"><mi id="alg3.l9.2.m2.1.1.1.1.1.3.2" mathcolor="#0000FF" xref="alg3.l9.2.m2.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg3.l9.2.m2.1.1.1.1.1.3.1" mathcolor="#0000FF" xref="alg3.l9.2.m2.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg3.l9.2.m2.1.1.1.1.1.3.3" mathcolor="#0000FF" xref="alg3.l9.2.m2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg3.l9.2.m2.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg3.l9.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.2.m2.1b"><apply id="alg3.l9.2.m2.1.1.cmml" xref="alg3.l9.2.m2.1.1"><times id="alg3.l9.2.m2.1.1.2.cmml" xref="alg3.l9.2.m2.1.1.2"></times><apply id="alg3.l9.2.m2.1.1.3.cmml" xref="alg3.l9.2.m2.1.1.3"><csymbol cd="ambiguous" id="alg3.l9.2.m2.1.1.3.1.cmml" xref="alg3.l9.2.m2.1.1.3">subscript</csymbol><apply id="alg3.l9.2.m2.1.1.3.2.cmml" xref="alg3.l9.2.m2.1.1.3.2"><ci id="alg3.l9.2.m2.1.1.3.2.1.cmml" xref="alg3.l9.2.m2.1.1.3.2.1">^</ci><ci id="alg3.l9.2.m2.1.1.3.2.2.cmml" xref="alg3.l9.2.m2.1.1.3.2.2">𝒛</ci></apply><cn id="alg3.l9.2.m2.1.1.3.3.cmml" type="integer" xref="alg3.l9.2.m2.1.1.3.3">0</cn></apply><apply id="alg3.l9.2.m2.1.1.1.1.1.cmml" xref="alg3.l9.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l9.2.m2.1.1.1.1.1.1.cmml" xref="alg3.l9.2.m2.1.1.1.1">subscript</csymbol><ci id="alg3.l9.2.m2.1.1.1.1.1.2.cmml" xref="alg3.l9.2.m2.1.1.1.1.1.2">𝒛</ci><apply id="alg3.l9.2.m2.1.1.1.1.1.3.cmml" xref="alg3.l9.2.m2.1.1.1.1.1.3"><plus id="alg3.l9.2.m2.1.1.1.1.1.3.1.cmml" xref="alg3.l9.2.m2.1.1.1.1.1.3.1"></plus><ci id="alg3.l9.2.m2.1.1.1.1.1.3.2.cmml" xref="alg3.l9.2.m2.1.1.1.1.1.3.2">𝑡</ci><cn id="alg3.l9.2.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="alg3.l9.2.m2.1.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.2.m2.1c">\hat{{\bm{z}}}_{0}({\bm{z}}_{t+1})</annotation><annotation encoding="application/x-llamapun" id="alg3.l9.2.m2.1d">over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg3.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>         <span class="ltx_text" id="alg3.l10.1" style="color:#0000FF;"> <math alttext="\bm{U},\bm{S},\bm{V}\leftarrow\text{SVD}(\bm{Z}^{\prime}_{t})" class="ltx_Math" display="inline" id="alg3.l10.1.m1.4"><semantics id="alg3.l10.1.m1.4a"><mrow id="alg3.l10.1.m1.4.4" xref="alg3.l10.1.m1.4.4.cmml"><mrow id="alg3.l10.1.m1.4.4.3.2" xref="alg3.l10.1.m1.4.4.3.1.cmml"><mi id="alg3.l10.1.m1.1.1" mathcolor="#0000FF" xref="alg3.l10.1.m1.1.1.cmml">𝑼</mi><mo id="alg3.l10.1.m1.4.4.3.2.1" mathcolor="#0000FF" xref="alg3.l10.1.m1.4.4.3.1.cmml">,</mo><mi id="alg3.l10.1.m1.2.2" mathcolor="#0000FF" xref="alg3.l10.1.m1.2.2.cmml">𝑺</mi><mo id="alg3.l10.1.m1.4.4.3.2.2" mathcolor="#0000FF" xref="alg3.l10.1.m1.4.4.3.1.cmml">,</mo><mi id="alg3.l10.1.m1.3.3" mathcolor="#0000FF" xref="alg3.l10.1.m1.3.3.cmml">𝑽</mi></mrow><mo id="alg3.l10.1.m1.4.4.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l10.1.m1.4.4.2.cmml">←</mo><mrow id="alg3.l10.1.m1.4.4.1" xref="alg3.l10.1.m1.4.4.1.cmml"><mtext id="alg3.l10.1.m1.4.4.1.3" mathcolor="#0000FF" xref="alg3.l10.1.m1.4.4.1.3a.cmml">SVD</mtext><mo id="alg3.l10.1.m1.4.4.1.2" xref="alg3.l10.1.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg3.l10.1.m1.4.4.1.1.1" xref="alg3.l10.1.m1.4.4.1.1.1.1.cmml"><mo id="alg3.l10.1.m1.4.4.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l10.1.m1.4.4.1.1.1.1.cmml">(</mo><msubsup id="alg3.l10.1.m1.4.4.1.1.1.1" xref="alg3.l10.1.m1.4.4.1.1.1.1.cmml"><mi id="alg3.l10.1.m1.4.4.1.1.1.1.2.2" mathcolor="#0000FF" xref="alg3.l10.1.m1.4.4.1.1.1.1.2.2.cmml">𝒁</mi><mi id="alg3.l10.1.m1.4.4.1.1.1.1.3" mathcolor="#0000FF" xref="alg3.l10.1.m1.4.4.1.1.1.1.3.cmml">t</mi><mo id="alg3.l10.1.m1.4.4.1.1.1.1.2.3" mathcolor="#0000FF" xref="alg3.l10.1.m1.4.4.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="alg3.l10.1.m1.4.4.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg3.l10.1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l10.1.m1.4b"><apply id="alg3.l10.1.m1.4.4.cmml" xref="alg3.l10.1.m1.4.4"><ci id="alg3.l10.1.m1.4.4.2.cmml" xref="alg3.l10.1.m1.4.4.2">←</ci><list id="alg3.l10.1.m1.4.4.3.1.cmml" xref="alg3.l10.1.m1.4.4.3.2"><ci id="alg3.l10.1.m1.1.1.cmml" xref="alg3.l10.1.m1.1.1">𝑼</ci><ci id="alg3.l10.1.m1.2.2.cmml" xref="alg3.l10.1.m1.2.2">𝑺</ci><ci id="alg3.l10.1.m1.3.3.cmml" xref="alg3.l10.1.m1.3.3">𝑽</ci></list><apply id="alg3.l10.1.m1.4.4.1.cmml" xref="alg3.l10.1.m1.4.4.1"><times id="alg3.l10.1.m1.4.4.1.2.cmml" xref="alg3.l10.1.m1.4.4.1.2"></times><ci id="alg3.l10.1.m1.4.4.1.3a.cmml" xref="alg3.l10.1.m1.4.4.1.3"><mtext id="alg3.l10.1.m1.4.4.1.3.cmml" mathcolor="#0000FF" xref="alg3.l10.1.m1.4.4.1.3">SVD</mtext></ci><apply id="alg3.l10.1.m1.4.4.1.1.1.1.cmml" xref="alg3.l10.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg3.l10.1.m1.4.4.1.1.1.1.1.cmml" xref="alg3.l10.1.m1.4.4.1.1.1">subscript</csymbol><apply id="alg3.l10.1.m1.4.4.1.1.1.1.2.cmml" xref="alg3.l10.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg3.l10.1.m1.4.4.1.1.1.1.2.1.cmml" xref="alg3.l10.1.m1.4.4.1.1.1">superscript</csymbol><ci id="alg3.l10.1.m1.4.4.1.1.1.1.2.2.cmml" xref="alg3.l10.1.m1.4.4.1.1.1.1.2.2">𝒁</ci><ci id="alg3.l10.1.m1.4.4.1.1.1.1.2.3.cmml" xref="alg3.l10.1.m1.4.4.1.1.1.1.2.3">′</ci></apply><ci id="alg3.l10.1.m1.4.4.1.1.1.1.3.cmml" xref="alg3.l10.1.m1.4.4.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.1.m1.4c">\bm{U},\bm{S},\bm{V}\leftarrow\text{SVD}(\bm{Z}^{\prime}_{t})</annotation><annotation encoding="application/x-llamapun" id="alg3.l10.1.m1.4d">bold_italic_U , bold_italic_S , bold_italic_V ← SVD ( bold_italic_Z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></span> <span class="ltx_text" id="alg3.l10.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l10.2.m1.1"><semantics id="alg3.l10.2.m1.1a"><mo id="alg3.l10.2.m1.1.1" xref="alg3.l10.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l10.2.m1.1b"><ci id="alg3.l10.2.m1.1.1.cmml" xref="alg3.l10.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l10.2.m1.1d">▷</annotation></semantics></math> Perform SVD on current diffusion state
</span>
</div>
<div class="ltx_listingline" id="alg3.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>         <span class="ltx_text" id="alg3.l11.3" style="color:#0000FF;"> <math alttext="\lambda_{j}\leftarrow s_{j}^{2}" class="ltx_Math" display="inline" id="alg3.l11.1.m1.1"><semantics id="alg3.l11.1.m1.1a"><mrow id="alg3.l11.1.m1.1.1" xref="alg3.l11.1.m1.1.1.cmml"><msub id="alg3.l11.1.m1.1.1.2" xref="alg3.l11.1.m1.1.1.2.cmml"><mi id="alg3.l11.1.m1.1.1.2.2" mathcolor="#0000FF" xref="alg3.l11.1.m1.1.1.2.2.cmml">λ</mi><mi id="alg3.l11.1.m1.1.1.2.3" mathcolor="#0000FF" xref="alg3.l11.1.m1.1.1.2.3.cmml">j</mi></msub><mo id="alg3.l11.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l11.1.m1.1.1.1.cmml">←</mo><msubsup id="alg3.l11.1.m1.1.1.3" xref="alg3.l11.1.m1.1.1.3.cmml"><mi id="alg3.l11.1.m1.1.1.3.2.2" mathcolor="#0000FF" xref="alg3.l11.1.m1.1.1.3.2.2.cmml">s</mi><mi id="alg3.l11.1.m1.1.1.3.2.3" mathcolor="#0000FF" xref="alg3.l11.1.m1.1.1.3.2.3.cmml">j</mi><mn id="alg3.l11.1.m1.1.1.3.3" mathcolor="#0000FF" xref="alg3.l11.1.m1.1.1.3.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l11.1.m1.1b"><apply id="alg3.l11.1.m1.1.1.cmml" xref="alg3.l11.1.m1.1.1"><ci id="alg3.l11.1.m1.1.1.1.cmml" xref="alg3.l11.1.m1.1.1.1">←</ci><apply id="alg3.l11.1.m1.1.1.2.cmml" xref="alg3.l11.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l11.1.m1.1.1.2.1.cmml" xref="alg3.l11.1.m1.1.1.2">subscript</csymbol><ci id="alg3.l11.1.m1.1.1.2.2.cmml" xref="alg3.l11.1.m1.1.1.2.2">𝜆</ci><ci id="alg3.l11.1.m1.1.1.2.3.cmml" xref="alg3.l11.1.m1.1.1.2.3">𝑗</ci></apply><apply id="alg3.l11.1.m1.1.1.3.cmml" xref="alg3.l11.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l11.1.m1.1.1.3.1.cmml" xref="alg3.l11.1.m1.1.1.3">superscript</csymbol><apply id="alg3.l11.1.m1.1.1.3.2.cmml" xref="alg3.l11.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l11.1.m1.1.1.3.2.1.cmml" xref="alg3.l11.1.m1.1.1.3">subscript</csymbol><ci id="alg3.l11.1.m1.1.1.3.2.2.cmml" xref="alg3.l11.1.m1.1.1.3.2.2">𝑠</ci><ci id="alg3.l11.1.m1.1.1.3.2.3.cmml" xref="alg3.l11.1.m1.1.1.3.2.3">𝑗</ci></apply><cn id="alg3.l11.1.m1.1.1.3.3.cmml" type="integer" xref="alg3.l11.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.1.m1.1c">\lambda_{j}\leftarrow s_{j}^{2}</annotation><annotation encoding="application/x-llamapun" id="alg3.l11.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ← italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> (where <math alttext="s_{j}" class="ltx_Math" display="inline" id="alg3.l11.2.m2.1"><semantics id="alg3.l11.2.m2.1a"><msub id="alg3.l11.2.m2.1.1" xref="alg3.l11.2.m2.1.1.cmml"><mi id="alg3.l11.2.m2.1.1.2" mathcolor="#0000FF" xref="alg3.l11.2.m2.1.1.2.cmml">s</mi><mi id="alg3.l11.2.m2.1.1.3" mathcolor="#0000FF" xref="alg3.l11.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l11.2.m2.1b"><apply id="alg3.l11.2.m2.1.1.cmml" xref="alg3.l11.2.m2.1.1"><csymbol cd="ambiguous" id="alg3.l11.2.m2.1.1.1.cmml" xref="alg3.l11.2.m2.1.1">subscript</csymbol><ci id="alg3.l11.2.m2.1.1.2.cmml" xref="alg3.l11.2.m2.1.1.2">𝑠</ci><ci id="alg3.l11.2.m2.1.1.3.cmml" xref="alg3.l11.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.2.m2.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="alg3.l11.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are the singular values of <math alttext="\bm{S}" class="ltx_Math" display="inline" id="alg3.l11.3.m3.1"><semantics id="alg3.l11.3.m3.1a"><mi id="alg3.l11.3.m3.1.1" mathcolor="#0000FF" xref="alg3.l11.3.m3.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="alg3.l11.3.m3.1b"><ci id="alg3.l11.3.m3.1.1.cmml" xref="alg3.l11.3.m3.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.3.m3.1c">\bm{S}</annotation><annotation encoding="application/x-llamapun" id="alg3.l11.3.m3.1d">bold_italic_S</annotation></semantics></math>)</span> <span class="ltx_text" id="alg3.l11.4" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l11.4.m1.1"><semantics id="alg3.l11.4.m1.1a"><mo id="alg3.l11.4.m1.1.1" xref="alg3.l11.4.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l11.4.m1.1b"><ci id="alg3.l11.4.m1.1.1.cmml" xref="alg3.l11.4.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.4.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l11.4.m1.1d">▷</annotation></semantics></math> Calculate eigenvalues
</span>
</div>
<div class="ltx_listingline" id="alg3.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>         <span class="ltx_text" id="alg3.l12.1" style="color:#0000FF;"> <math alttext="c_{k}\leftarrow\frac{\sum_{j=1}^{k}\lambda_{j}}{\sum_{j}\lambda_{j}}" class="ltx_Math" display="inline" id="alg3.l12.1.m1.1"><semantics id="alg3.l12.1.m1.1a"><mrow id="alg3.l12.1.m1.1.1" xref="alg3.l12.1.m1.1.1.cmml"><msub id="alg3.l12.1.m1.1.1.2" xref="alg3.l12.1.m1.1.1.2.cmml"><mi id="alg3.l12.1.m1.1.1.2.2" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.2.2.cmml">c</mi><mi id="alg3.l12.1.m1.1.1.2.3" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg3.l12.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l12.1.m1.1.1.1.cmml">←</mo><mfrac id="alg3.l12.1.m1.1.1.3" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.cmml"><mrow id="alg3.l12.1.m1.1.1.3.2" xref="alg3.l12.1.m1.1.1.3.2.cmml"><mstyle displaystyle="false" id="alg3.l12.1.m1.1.1.3.2.1" xref="alg3.l12.1.m1.1.1.3.2.1.cmml"><msubsup id="alg3.l12.1.m1.1.1.3.2.1a" xref="alg3.l12.1.m1.1.1.3.2.1.cmml"><mo id="alg3.l12.1.m1.1.1.3.2.1.2.2" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="alg3.l12.1.m1.1.1.3.2.1.2.3" xref="alg3.l12.1.m1.1.1.3.2.1.2.3.cmml"><mi id="alg3.l12.1.m1.1.1.3.2.1.2.3.2" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.2.1.2.3.2.cmml">j</mi><mo id="alg3.l12.1.m1.1.1.3.2.1.2.3.1" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="alg3.l12.1.m1.1.1.3.2.1.2.3.3" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="alg3.l12.1.m1.1.1.3.2.1.3" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.2.1.3.cmml">k</mi></msubsup></mstyle><msub id="alg3.l12.1.m1.1.1.3.2.2" xref="alg3.l12.1.m1.1.1.3.2.2.cmml"><mi id="alg3.l12.1.m1.1.1.3.2.2.2" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.2.2.2.cmml">λ</mi><mi id="alg3.l12.1.m1.1.1.3.2.2.3" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.2.2.3.cmml">j</mi></msub></mrow><mrow id="alg3.l12.1.m1.1.1.3.3" xref="alg3.l12.1.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="alg3.l12.1.m1.1.1.3.3.1" xref="alg3.l12.1.m1.1.1.3.3.1.cmml"><msub id="alg3.l12.1.m1.1.1.3.3.1a" xref="alg3.l12.1.m1.1.1.3.3.1.cmml"><mo id="alg3.l12.1.m1.1.1.3.3.1.2" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.3.1.2.cmml">∑</mo><mi id="alg3.l12.1.m1.1.1.3.3.1.3" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.3.1.3.cmml">j</mi></msub></mstyle><msub id="alg3.l12.1.m1.1.1.3.3.2" xref="alg3.l12.1.m1.1.1.3.3.2.cmml"><mi id="alg3.l12.1.m1.1.1.3.3.2.2" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.3.2.2.cmml">λ</mi><mi id="alg3.l12.1.m1.1.1.3.3.2.3" mathcolor="#0000FF" xref="alg3.l12.1.m1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg3.l12.1.m1.1b"><apply id="alg3.l12.1.m1.1.1.cmml" xref="alg3.l12.1.m1.1.1"><ci id="alg3.l12.1.m1.1.1.1.cmml" xref="alg3.l12.1.m1.1.1.1">←</ci><apply id="alg3.l12.1.m1.1.1.2.cmml" xref="alg3.l12.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l12.1.m1.1.1.2.1.cmml" xref="alg3.l12.1.m1.1.1.2">subscript</csymbol><ci id="alg3.l12.1.m1.1.1.2.2.cmml" xref="alg3.l12.1.m1.1.1.2.2">𝑐</ci><ci id="alg3.l12.1.m1.1.1.2.3.cmml" xref="alg3.l12.1.m1.1.1.2.3">𝑘</ci></apply><apply id="alg3.l12.1.m1.1.1.3.cmml" xref="alg3.l12.1.m1.1.1.3"><divide id="alg3.l12.1.m1.1.1.3.1.cmml" xref="alg3.l12.1.m1.1.1.3"></divide><apply id="alg3.l12.1.m1.1.1.3.2.cmml" xref="alg3.l12.1.m1.1.1.3.2"><apply id="alg3.l12.1.m1.1.1.3.2.1.cmml" xref="alg3.l12.1.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg3.l12.1.m1.1.1.3.2.1.1.cmml" xref="alg3.l12.1.m1.1.1.3.2.1">superscript</csymbol><apply id="alg3.l12.1.m1.1.1.3.2.1.2.cmml" xref="alg3.l12.1.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg3.l12.1.m1.1.1.3.2.1.2.1.cmml" xref="alg3.l12.1.m1.1.1.3.2.1">subscript</csymbol><sum id="alg3.l12.1.m1.1.1.3.2.1.2.2.cmml" xref="alg3.l12.1.m1.1.1.3.2.1.2.2"></sum><apply id="alg3.l12.1.m1.1.1.3.2.1.2.3.cmml" xref="alg3.l12.1.m1.1.1.3.2.1.2.3"><eq id="alg3.l12.1.m1.1.1.3.2.1.2.3.1.cmml" xref="alg3.l12.1.m1.1.1.3.2.1.2.3.1"></eq><ci id="alg3.l12.1.m1.1.1.3.2.1.2.3.2.cmml" xref="alg3.l12.1.m1.1.1.3.2.1.2.3.2">𝑗</ci><cn id="alg3.l12.1.m1.1.1.3.2.1.2.3.3.cmml" type="integer" xref="alg3.l12.1.m1.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="alg3.l12.1.m1.1.1.3.2.1.3.cmml" xref="alg3.l12.1.m1.1.1.3.2.1.3">𝑘</ci></apply><apply id="alg3.l12.1.m1.1.1.3.2.2.cmml" xref="alg3.l12.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg3.l12.1.m1.1.1.3.2.2.1.cmml" xref="alg3.l12.1.m1.1.1.3.2.2">subscript</csymbol><ci id="alg3.l12.1.m1.1.1.3.2.2.2.cmml" xref="alg3.l12.1.m1.1.1.3.2.2.2">𝜆</ci><ci id="alg3.l12.1.m1.1.1.3.2.2.3.cmml" xref="alg3.l12.1.m1.1.1.3.2.2.3">𝑗</ci></apply></apply><apply id="alg3.l12.1.m1.1.1.3.3.cmml" xref="alg3.l12.1.m1.1.1.3.3"><apply id="alg3.l12.1.m1.1.1.3.3.1.cmml" xref="alg3.l12.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg3.l12.1.m1.1.1.3.3.1.1.cmml" xref="alg3.l12.1.m1.1.1.3.3.1">subscript</csymbol><sum id="alg3.l12.1.m1.1.1.3.3.1.2.cmml" xref="alg3.l12.1.m1.1.1.3.3.1.2"></sum><ci id="alg3.l12.1.m1.1.1.3.3.1.3.cmml" xref="alg3.l12.1.m1.1.1.3.3.1.3">𝑗</ci></apply><apply id="alg3.l12.1.m1.1.1.3.3.2.cmml" xref="alg3.l12.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg3.l12.1.m1.1.1.3.3.2.1.cmml" xref="alg3.l12.1.m1.1.1.3.3.2">subscript</csymbol><ci id="alg3.l12.1.m1.1.1.3.3.2.2.cmml" xref="alg3.l12.1.m1.1.1.3.3.2.2">𝜆</ci><ci id="alg3.l12.1.m1.1.1.3.3.2.3.cmml" xref="alg3.l12.1.m1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l12.1.m1.1c">c_{k}\leftarrow\frac{\sum_{j=1}^{k}\lambda_{j}}{\sum_{j}\lambda_{j}}</annotation><annotation encoding="application/x-llamapun" id="alg3.l12.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← divide start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></span> <span class="ltx_text" id="alg3.l12.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l12.2.m1.1"><semantics id="alg3.l12.2.m1.1a"><mo id="alg3.l12.2.m1.1.1" xref="alg3.l12.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l12.2.m1.1b"><ci id="alg3.l12.2.m1.1.1.cmml" xref="alg3.l12.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l12.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l12.2.m1.1d">▷</annotation></semantics></math> Cumulative sum of eigenvalues
</span>
</div>
<div class="ltx_listingline" id="alg3.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>         <span class="ltx_text" id="alg3.l13.1" style="color:#0000FF;"> <math alttext="r\leftarrow\underset{k}{\operatorname*{arg\,min}}\{c_{k}\geq\tau\}" class="ltx_Math" display="inline" id="alg3.l13.1.m1.1"><semantics id="alg3.l13.1.m1.1a"><mrow id="alg3.l13.1.m1.1.1" xref="alg3.l13.1.m1.1.1.cmml"><mi id="alg3.l13.1.m1.1.1.3" mathcolor="#0000FF" xref="alg3.l13.1.m1.1.1.3.cmml">r</mi><mo id="alg3.l13.1.m1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l13.1.m1.1.1.2.cmml">←</mo><mrow id="alg3.l13.1.m1.1.1.1" xref="alg3.l13.1.m1.1.1.1.cmml"><munder accentunder="true" id="alg3.l13.1.m1.1.1.1.3" xref="alg3.l13.1.m1.1.1.1.3.cmml"><mrow id="alg3.l13.1.m1.1.1.1.3.2" xref="alg3.l13.1.m1.1.1.1.3.2.cmml"><mi id="alg3.l13.1.m1.1.1.1.3.2.2" mathcolor="#0000FF" xref="alg3.l13.1.m1.1.1.1.3.2.2.cmml">arg</mi><mo id="alg3.l13.1.m1.1.1.1.3.2.1" lspace="0.170em" xref="alg3.l13.1.m1.1.1.1.3.2.1.cmml">⁢</mo><mi id="alg3.l13.1.m1.1.1.1.3.2.3" mathcolor="#0000FF" xref="alg3.l13.1.m1.1.1.1.3.2.3.cmml">min</mi></mrow><mo id="alg3.l13.1.m1.1.1.1.3.1" mathcolor="#0000FF" xref="alg3.l13.1.m1.1.1.1.3.1.cmml">𝑘</mo></munder><mo id="alg3.l13.1.m1.1.1.1.2" xref="alg3.l13.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l13.1.m1.1.1.1.1.1" xref="alg3.l13.1.m1.1.1.1.1.2.cmml"><mo id="alg3.l13.1.m1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l13.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg3.l13.1.m1.1.1.1.1.1.1" xref="alg3.l13.1.m1.1.1.1.1.1.1.cmml"><msub id="alg3.l13.1.m1.1.1.1.1.1.1.2" xref="alg3.l13.1.m1.1.1.1.1.1.1.2.cmml"><mi id="alg3.l13.1.m1.1.1.1.1.1.1.2.2" mathcolor="#0000FF" xref="alg3.l13.1.m1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="alg3.l13.1.m1.1.1.1.1.1.1.2.3" mathcolor="#0000FF" xref="alg3.l13.1.m1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="alg3.l13.1.m1.1.1.1.1.1.1.1" mathcolor="#0000FF" xref="alg3.l13.1.m1.1.1.1.1.1.1.1.cmml">≥</mo><mi id="alg3.l13.1.m1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg3.l13.1.m1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="alg3.l13.1.m1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg3.l13.1.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l13.1.m1.1b"><apply id="alg3.l13.1.m1.1.1.cmml" xref="alg3.l13.1.m1.1.1"><ci id="alg3.l13.1.m1.1.1.2.cmml" xref="alg3.l13.1.m1.1.1.2">←</ci><ci id="alg3.l13.1.m1.1.1.3.cmml" xref="alg3.l13.1.m1.1.1.3">𝑟</ci><apply id="alg3.l13.1.m1.1.1.1.cmml" xref="alg3.l13.1.m1.1.1.1"><times id="alg3.l13.1.m1.1.1.1.2.cmml" xref="alg3.l13.1.m1.1.1.1.2"></times><apply id="alg3.l13.1.m1.1.1.1.3.cmml" xref="alg3.l13.1.m1.1.1.1.3"><ci id="alg3.l13.1.m1.1.1.1.3.1.cmml" xref="alg3.l13.1.m1.1.1.1.3.1">𝑘</ci><apply id="alg3.l13.1.m1.1.1.1.3.2.cmml" xref="alg3.l13.1.m1.1.1.1.3.2"><times id="alg3.l13.1.m1.1.1.1.3.2.1.cmml" xref="alg3.l13.1.m1.1.1.1.3.2.1"></times><ci id="alg3.l13.1.m1.1.1.1.3.2.2.cmml" xref="alg3.l13.1.m1.1.1.1.3.2.2">arg</ci><ci id="alg3.l13.1.m1.1.1.1.3.2.3.cmml" xref="alg3.l13.1.m1.1.1.1.3.2.3">min</ci></apply></apply><set id="alg3.l13.1.m1.1.1.1.1.2.cmml" xref="alg3.l13.1.m1.1.1.1.1.1"><apply id="alg3.l13.1.m1.1.1.1.1.1.1.cmml" xref="alg3.l13.1.m1.1.1.1.1.1.1"><geq id="alg3.l13.1.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l13.1.m1.1.1.1.1.1.1.1"></geq><apply id="alg3.l13.1.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l13.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l13.1.m1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l13.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg3.l13.1.m1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l13.1.m1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="alg3.l13.1.m1.1.1.1.1.1.1.2.3.cmml" xref="alg3.l13.1.m1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg3.l13.1.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l13.1.m1.1.1.1.1.1.1.3">𝜏</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.1.m1.1c">r\leftarrow\underset{k}{\operatorname*{arg\,min}}\{c_{k}\geq\tau\}</annotation><annotation encoding="application/x-llamapun" id="alg3.l13.1.m1.1d">italic_r ← underitalic_k start_ARG roman_arg roman_min end_ARG { italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ≥ italic_τ }</annotation></semantics></math></span> <span class="ltx_text" id="alg3.l13.4" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l13.2.m1.1"><semantics id="alg3.l13.2.m1.1a"><mo id="alg3.l13.2.m1.1.1" xref="alg3.l13.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l13.2.m1.1b"><ci id="alg3.l13.2.m1.1.1.cmml" xref="alg3.l13.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l13.2.m1.1d">▷</annotation></semantics></math> Determine rank <math alttext="r" class="ltx_Math" display="inline" id="alg3.l13.3.m2.1"><semantics id="alg3.l13.3.m2.1a"><mi id="alg3.l13.3.m2.1.1" xref="alg3.l13.3.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg3.l13.3.m2.1b"><ci id="alg3.l13.3.m2.1.1.cmml" xref="alg3.l13.3.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.3.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg3.l13.3.m2.1d">italic_r</annotation></semantics></math> based on threshold <math alttext="\tau" class="ltx_Math" display="inline" id="alg3.l13.4.m3.1"><semantics id="alg3.l13.4.m3.1a"><mi id="alg3.l13.4.m3.1.1" xref="alg3.l13.4.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg3.l13.4.m3.1b"><ci id="alg3.l13.4.m3.1.1.cmml" xref="alg3.l13.4.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.4.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg3.l13.4.m3.1d">italic_τ</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg3.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>         <span class="ltx_text" id="alg3.l14.1" style="color:#0000FF;"> <math alttext="\bm{A}\leftarrow\bm{U}_{r}" class="ltx_Math" display="inline" id="alg3.l14.1.m1.1"><semantics id="alg3.l14.1.m1.1a"><mrow id="alg3.l14.1.m1.1.1" xref="alg3.l14.1.m1.1.1.cmml"><mi id="alg3.l14.1.m1.1.1.2" mathcolor="#0000FF" xref="alg3.l14.1.m1.1.1.2.cmml">𝑨</mi><mo id="alg3.l14.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l14.1.m1.1.1.1.cmml">←</mo><msub id="alg3.l14.1.m1.1.1.3" xref="alg3.l14.1.m1.1.1.3.cmml"><mi id="alg3.l14.1.m1.1.1.3.2" mathcolor="#0000FF" xref="alg3.l14.1.m1.1.1.3.2.cmml">𝑼</mi><mi id="alg3.l14.1.m1.1.1.3.3" mathcolor="#0000FF" xref="alg3.l14.1.m1.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l14.1.m1.1b"><apply id="alg3.l14.1.m1.1.1.cmml" xref="alg3.l14.1.m1.1.1"><ci id="alg3.l14.1.m1.1.1.1.cmml" xref="alg3.l14.1.m1.1.1.1">←</ci><ci id="alg3.l14.1.m1.1.1.2.cmml" xref="alg3.l14.1.m1.1.1.2">𝑨</ci><apply id="alg3.l14.1.m1.1.1.3.cmml" xref="alg3.l14.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l14.1.m1.1.1.3.1.cmml" xref="alg3.l14.1.m1.1.1.3">subscript</csymbol><ci id="alg3.l14.1.m1.1.1.3.2.cmml" xref="alg3.l14.1.m1.1.1.3.2">𝑼</ci><ci id="alg3.l14.1.m1.1.1.3.3.cmml" xref="alg3.l14.1.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l14.1.m1.1c">\bm{A}\leftarrow\bm{U}_{r}</annotation><annotation encoding="application/x-llamapun" id="alg3.l14.1.m1.1d">bold_italic_A ← bold_italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></span> <span class="ltx_text" id="alg3.l14.3" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l14.2.m1.1"><semantics id="alg3.l14.2.m1.1a"><mo id="alg3.l14.2.m1.1.1" xref="alg3.l14.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l14.2.m1.1b"><ci id="alg3.l14.2.m1.1.1.cmml" xref="alg3.l14.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l14.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l14.2.m1.1d">▷</annotation></semantics></math> Get first <math alttext="r" class="ltx_Math" display="inline" id="alg3.l14.3.m2.1"><semantics id="alg3.l14.3.m2.1a"><mi id="alg3.l14.3.m2.1.1" xref="alg3.l14.3.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg3.l14.3.m2.1b"><ci id="alg3.l14.3.m2.1.1.cmml" xref="alg3.l14.3.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l14.3.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg3.l14.3.m2.1d">italic_r</annotation></semantics></math> left singular vectors
</span>
</div>
<div class="ltx_listingline" id="alg3.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>         <span class="ltx_text" id="alg3.l15.1" style="color:#0000FF;"> <math alttext="\bm{B}\leftarrow\bm{V}_{r}" class="ltx_Math" display="inline" id="alg3.l15.1.m1.1"><semantics id="alg3.l15.1.m1.1a"><mrow id="alg3.l15.1.m1.1.1" xref="alg3.l15.1.m1.1.1.cmml"><mi id="alg3.l15.1.m1.1.1.2" mathcolor="#0000FF" xref="alg3.l15.1.m1.1.1.2.cmml">𝑩</mi><mo id="alg3.l15.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l15.1.m1.1.1.1.cmml">←</mo><msub id="alg3.l15.1.m1.1.1.3" xref="alg3.l15.1.m1.1.1.3.cmml"><mi id="alg3.l15.1.m1.1.1.3.2" mathcolor="#0000FF" xref="alg3.l15.1.m1.1.1.3.2.cmml">𝑽</mi><mi id="alg3.l15.1.m1.1.1.3.3" mathcolor="#0000FF" xref="alg3.l15.1.m1.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l15.1.m1.1b"><apply id="alg3.l15.1.m1.1.1.cmml" xref="alg3.l15.1.m1.1.1"><ci id="alg3.l15.1.m1.1.1.1.cmml" xref="alg3.l15.1.m1.1.1.1">←</ci><ci id="alg3.l15.1.m1.1.1.2.cmml" xref="alg3.l15.1.m1.1.1.2">𝑩</ci><apply id="alg3.l15.1.m1.1.1.3.cmml" xref="alg3.l15.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l15.1.m1.1.1.3.1.cmml" xref="alg3.l15.1.m1.1.1.3">subscript</csymbol><ci id="alg3.l15.1.m1.1.1.3.2.cmml" xref="alg3.l15.1.m1.1.1.3.2">𝑽</ci><ci id="alg3.l15.1.m1.1.1.3.3.cmml" xref="alg3.l15.1.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l15.1.m1.1c">\bm{B}\leftarrow\bm{V}_{r}</annotation><annotation encoding="application/x-llamapun" id="alg3.l15.1.m1.1d">bold_italic_B ← bold_italic_V start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></span> <span class="ltx_text" id="alg3.l15.3" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l15.2.m1.1"><semantics id="alg3.l15.2.m1.1a"><mo id="alg3.l15.2.m1.1.1" xref="alg3.l15.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l15.2.m1.1b"><ci id="alg3.l15.2.m1.1.1.cmml" xref="alg3.l15.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l15.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l15.2.m1.1d">▷</annotation></semantics></math> Get first <math alttext="r" class="ltx_Math" display="inline" id="alg3.l15.3.m2.1"><semantics id="alg3.l15.3.m2.1a"><mi id="alg3.l15.3.m2.1.1" xref="alg3.l15.3.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg3.l15.3.m2.1b"><ci id="alg3.l15.3.m2.1.1.cmml" xref="alg3.l15.3.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l15.3.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg3.l15.3.m2.1d">italic_r</annotation></semantics></math> right singular vectors
</span>
</div>
<div class="ltx_listingline" id="alg3.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>         <span class="ltx_text ltx_font_bold" id="alg3.l16.1">for</span> <span class="ltx_text" id="alg3.l16.2" style="color:#0000FF;"> each step in gradient descent</span> <span class="ltx_text ltx_font_bold" id="alg3.l16.3">do</span>
</div>
<div class="ltx_listingline" id="alg3.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>              <span class="ltx_text ltx_font_bold" id="alg3.l17.2">if</span> <span class="ltx_text" id="alg3.l17.1" style="color:#0000FF;"> step number <math alttext="\mod F=0" class="ltx_math_unparsed" display="inline" id="alg3.l17.1.m1.1"><semantics id="alg3.l17.1.m1.1a"><mrow id="alg3.l17.1.m1.1b"><mo id="alg3.l17.1.m1.1.1" mathcolor="#0000FF">mod</mo><mi id="alg3.l17.1.m1.1.2" mathcolor="#0000FF">F</mi><mo id="alg3.l17.1.m1.1.3" mathcolor="#0000FF">=</mo><mn id="alg3.l17.1.m1.1.4" mathcolor="#0000FF">0</mn></mrow><annotation encoding="application/x-tex" id="alg3.l17.1.m1.1c">\mod F=0</annotation><annotation encoding="application/x-llamapun" id="alg3.l17.1.m1.1d">roman_mod italic_F = 0</annotation></semantics></math></span> <span class="ltx_text ltx_font_bold" id="alg3.l17.3">then</span>
</div>
<div class="ltx_listingline" id="alg3.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>                  <span class="ltx_text" id="alg3.l18.1" style="color:#0000FF;"> <math alttext="\bm{g}\leftarrow\nabla_{\hat{{\bm{z}}}_{0}({\bm{y}})}\frac{1}{2}\|{\bm{y}}-%
\mathcal{A}(\mathcal{D}(\hat{{\bm{z}}}_{0}({\bm{y}})))\|_{2}^{2}" class="ltx_Math" display="inline" id="alg3.l18.1.m1.3"><semantics id="alg3.l18.1.m1.3a"><mrow id="alg3.l18.1.m1.3.3" xref="alg3.l18.1.m1.3.3.cmml"><mi id="alg3.l18.1.m1.3.3.3" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.3.cmml">𝒈</mi><mo id="alg3.l18.1.m1.3.3.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.3.3.2.cmml">←</mo><mrow id="alg3.l18.1.m1.3.3.1" xref="alg3.l18.1.m1.3.3.1.cmml"><msub id="alg3.l18.1.m1.3.3.1.2" xref="alg3.l18.1.m1.3.3.1.2.cmml"><mo id="alg3.l18.1.m1.3.3.1.2.2" mathcolor="#0000FF" rspace="0.167em" xref="alg3.l18.1.m1.3.3.1.2.2.cmml">∇</mo><mrow id="alg3.l18.1.m1.1.1.1" xref="alg3.l18.1.m1.1.1.1.cmml"><msub id="alg3.l18.1.m1.1.1.1.3" xref="alg3.l18.1.m1.1.1.1.3.cmml"><mover accent="true" id="alg3.l18.1.m1.1.1.1.3.2" xref="alg3.l18.1.m1.1.1.1.3.2.cmml"><mi id="alg3.l18.1.m1.1.1.1.3.2.2" mathcolor="#0000FF" xref="alg3.l18.1.m1.1.1.1.3.2.2.cmml">𝒛</mi><mo id="alg3.l18.1.m1.1.1.1.3.2.1" mathcolor="#0000FF" xref="alg3.l18.1.m1.1.1.1.3.2.1.cmml">^</mo></mover><mn id="alg3.l18.1.m1.1.1.1.3.3" mathcolor="#0000FF" xref="alg3.l18.1.m1.1.1.1.3.3.cmml">0</mn></msub><mo id="alg3.l18.1.m1.1.1.1.2" xref="alg3.l18.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l18.1.m1.1.1.1.4.2" xref="alg3.l18.1.m1.1.1.1.cmml"><mo id="alg3.l18.1.m1.1.1.1.4.2.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.1.1.1.cmml">(</mo><mi id="alg3.l18.1.m1.1.1.1.1" mathcolor="#0000FF" xref="alg3.l18.1.m1.1.1.1.1.cmml">𝒚</mi><mo id="alg3.l18.1.m1.1.1.1.4.2.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.1.1.1.cmml">)</mo></mrow></mrow></msub><mrow id="alg3.l18.1.m1.3.3.1.1" xref="alg3.l18.1.m1.3.3.1.1.cmml"><mfrac id="alg3.l18.1.m1.3.3.1.1.3" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.3.cmml"><mn id="alg3.l18.1.m1.3.3.1.1.3.2" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.3.2.cmml">1</mn><mn id="alg3.l18.1.m1.3.3.1.1.3.3" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.3.3.cmml">2</mn></mfrac><mo id="alg3.l18.1.m1.3.3.1.1.2" xref="alg3.l18.1.m1.3.3.1.1.2.cmml">⁢</mo><msubsup id="alg3.l18.1.m1.3.3.1.1.1" xref="alg3.l18.1.m1.3.3.1.1.1.cmml"><mrow id="alg3.l18.1.m1.3.3.1.1.1.1.1.1" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">𝒚</mi><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.2" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">𝒜</mi><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝒟</mi><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒛</mi><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="alg3.l18.1.m1.2.2" mathcolor="#0000FF" xref="alg3.l18.1.m1.2.2.cmml">𝒚</mi><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg3.l18.1.m1.3.3.1.1.1.1.3" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.1.1.3.cmml">2</mn><mn id="alg3.l18.1.m1.3.3.1.1.1.3" mathcolor="#0000FF" xref="alg3.l18.1.m1.3.3.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l18.1.m1.3b"><apply id="alg3.l18.1.m1.3.3.cmml" xref="alg3.l18.1.m1.3.3"><ci id="alg3.l18.1.m1.3.3.2.cmml" xref="alg3.l18.1.m1.3.3.2">←</ci><ci id="alg3.l18.1.m1.3.3.3.cmml" xref="alg3.l18.1.m1.3.3.3">𝒈</ci><apply id="alg3.l18.1.m1.3.3.1.cmml" xref="alg3.l18.1.m1.3.3.1"><apply id="alg3.l18.1.m1.3.3.1.2.cmml" xref="alg3.l18.1.m1.3.3.1.2"><csymbol cd="ambiguous" id="alg3.l18.1.m1.3.3.1.2.1.cmml" xref="alg3.l18.1.m1.3.3.1.2">subscript</csymbol><ci id="alg3.l18.1.m1.3.3.1.2.2.cmml" xref="alg3.l18.1.m1.3.3.1.2.2">∇</ci><apply id="alg3.l18.1.m1.1.1.1.cmml" xref="alg3.l18.1.m1.1.1.1"><times id="alg3.l18.1.m1.1.1.1.2.cmml" xref="alg3.l18.1.m1.1.1.1.2"></times><apply id="alg3.l18.1.m1.1.1.1.3.cmml" xref="alg3.l18.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l18.1.m1.1.1.1.3.1.cmml" xref="alg3.l18.1.m1.1.1.1.3">subscript</csymbol><apply id="alg3.l18.1.m1.1.1.1.3.2.cmml" xref="alg3.l18.1.m1.1.1.1.3.2"><ci id="alg3.l18.1.m1.1.1.1.3.2.1.cmml" xref="alg3.l18.1.m1.1.1.1.3.2.1">^</ci><ci id="alg3.l18.1.m1.1.1.1.3.2.2.cmml" xref="alg3.l18.1.m1.1.1.1.3.2.2">𝒛</ci></apply><cn id="alg3.l18.1.m1.1.1.1.3.3.cmml" type="integer" xref="alg3.l18.1.m1.1.1.1.3.3">0</cn></apply><ci id="alg3.l18.1.m1.1.1.1.1.cmml" xref="alg3.l18.1.m1.1.1.1.1">𝒚</ci></apply></apply><apply id="alg3.l18.1.m1.3.3.1.1.cmml" xref="alg3.l18.1.m1.3.3.1.1"><times id="alg3.l18.1.m1.3.3.1.1.2.cmml" xref="alg3.l18.1.m1.3.3.1.1.2"></times><apply id="alg3.l18.1.m1.3.3.1.1.3.cmml" xref="alg3.l18.1.m1.3.3.1.1.3"><divide id="alg3.l18.1.m1.3.3.1.1.3.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.3"></divide><cn id="alg3.l18.1.m1.3.3.1.1.3.2.cmml" type="integer" xref="alg3.l18.1.m1.3.3.1.1.3.2">1</cn><cn id="alg3.l18.1.m1.3.3.1.1.3.3.cmml" type="integer" xref="alg3.l18.1.m1.3.3.1.1.3.3">2</cn></apply><apply id="alg3.l18.1.m1.3.3.1.1.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l18.1.m1.3.3.1.1.1.2.cmml" xref="alg3.l18.1.m1.3.3.1.1.1">superscript</csymbol><apply id="alg3.l18.1.m1.3.3.1.1.1.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l18.1.m1.3.3.1.1.1.1.2.cmml" xref="alg3.l18.1.m1.3.3.1.1.1">subscript</csymbol><apply id="alg3.l18.1.m1.3.3.1.1.1.1.1.2.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="alg3.l18.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.2">norm</csymbol><apply id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1"><minus id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.2"></minus><ci id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.3">𝒚</ci><apply id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1"><times id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.2"></times><ci id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.3">𝒜</ci><apply id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><times id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝒟</ci><apply id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒛</ci></apply><cn id="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="alg3.l18.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="alg3.l18.1.m1.2.2.cmml" xref="alg3.l18.1.m1.2.2">𝒚</ci></apply></apply></apply></apply></apply><cn id="alg3.l18.1.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="alg3.l18.1.m1.3.3.1.1.1.1.3">2</cn></apply><cn id="alg3.l18.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="alg3.l18.1.m1.3.3.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l18.1.m1.3c">\bm{g}\leftarrow\nabla_{\hat{{\bm{z}}}_{0}({\bm{y}})}\frac{1}{2}\|{\bm{y}}-%
\mathcal{A}(\mathcal{D}(\hat{{\bm{z}}}_{0}({\bm{y}})))\|_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="alg3.l18.1.m1.3d">bold_italic_g ← ∇ start_POSTSUBSCRIPT over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_y ) end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∥ bold_italic_y - caligraphic_A ( caligraphic_D ( over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_y ) ) ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></span> <span class="ltx_text" id="alg3.l18.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l18.2.m1.1"><semantics id="alg3.l18.2.m1.1a"><mo id="alg3.l18.2.m1.1.1" xref="alg3.l18.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l18.2.m1.1b"><ci id="alg3.l18.2.m1.1.1.cmml" xref="alg3.l18.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l18.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l18.2.m1.1d">▷</annotation></semantics></math> Compute gradient
</span>
</div>
<div class="ltx_listingline" id="alg3.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span>                  <span class="ltx_text" id="alg3.l19.1" style="color:#0000FF;"> <math alttext="\bm{R}\leftarrow\bm{A}^{T}\bm{G}\bm{B}^{T}" class="ltx_Math" display="inline" id="alg3.l19.1.m1.1"><semantics id="alg3.l19.1.m1.1a"><mrow id="alg3.l19.1.m1.1.1" xref="alg3.l19.1.m1.1.1.cmml"><mi id="alg3.l19.1.m1.1.1.2" mathcolor="#0000FF" xref="alg3.l19.1.m1.1.1.2.cmml">𝑹</mi><mo id="alg3.l19.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l19.1.m1.1.1.1.cmml">←</mo><mrow id="alg3.l19.1.m1.1.1.3" xref="alg3.l19.1.m1.1.1.3.cmml"><msup id="alg3.l19.1.m1.1.1.3.2" xref="alg3.l19.1.m1.1.1.3.2.cmml"><mi id="alg3.l19.1.m1.1.1.3.2.2" mathcolor="#0000FF" xref="alg3.l19.1.m1.1.1.3.2.2.cmml">𝑨</mi><mi id="alg3.l19.1.m1.1.1.3.2.3" mathcolor="#0000FF" xref="alg3.l19.1.m1.1.1.3.2.3.cmml">T</mi></msup><mo id="alg3.l19.1.m1.1.1.3.1" xref="alg3.l19.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg3.l19.1.m1.1.1.3.3" mathcolor="#0000FF" xref="alg3.l19.1.m1.1.1.3.3.cmml">𝑮</mi><mo id="alg3.l19.1.m1.1.1.3.1a" xref="alg3.l19.1.m1.1.1.3.1.cmml">⁢</mo><msup id="alg3.l19.1.m1.1.1.3.4" xref="alg3.l19.1.m1.1.1.3.4.cmml"><mi id="alg3.l19.1.m1.1.1.3.4.2" mathcolor="#0000FF" xref="alg3.l19.1.m1.1.1.3.4.2.cmml">𝑩</mi><mi id="alg3.l19.1.m1.1.1.3.4.3" mathcolor="#0000FF" xref="alg3.l19.1.m1.1.1.3.4.3.cmml">T</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l19.1.m1.1b"><apply id="alg3.l19.1.m1.1.1.cmml" xref="alg3.l19.1.m1.1.1"><ci id="alg3.l19.1.m1.1.1.1.cmml" xref="alg3.l19.1.m1.1.1.1">←</ci><ci id="alg3.l19.1.m1.1.1.2.cmml" xref="alg3.l19.1.m1.1.1.2">𝑹</ci><apply id="alg3.l19.1.m1.1.1.3.cmml" xref="alg3.l19.1.m1.1.1.3"><times id="alg3.l19.1.m1.1.1.3.1.cmml" xref="alg3.l19.1.m1.1.1.3.1"></times><apply id="alg3.l19.1.m1.1.1.3.2.cmml" xref="alg3.l19.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l19.1.m1.1.1.3.2.1.cmml" xref="alg3.l19.1.m1.1.1.3.2">superscript</csymbol><ci id="alg3.l19.1.m1.1.1.3.2.2.cmml" xref="alg3.l19.1.m1.1.1.3.2.2">𝑨</ci><ci id="alg3.l19.1.m1.1.1.3.2.3.cmml" xref="alg3.l19.1.m1.1.1.3.2.3">𝑇</ci></apply><ci id="alg3.l19.1.m1.1.1.3.3.cmml" xref="alg3.l19.1.m1.1.1.3.3">𝑮</ci><apply id="alg3.l19.1.m1.1.1.3.4.cmml" xref="alg3.l19.1.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg3.l19.1.m1.1.1.3.4.1.cmml" xref="alg3.l19.1.m1.1.1.3.4">superscript</csymbol><ci id="alg3.l19.1.m1.1.1.3.4.2.cmml" xref="alg3.l19.1.m1.1.1.3.4.2">𝑩</ci><ci id="alg3.l19.1.m1.1.1.3.4.3.cmml" xref="alg3.l19.1.m1.1.1.3.4.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l19.1.m1.1c">\bm{R}\leftarrow\bm{A}^{T}\bm{G}\bm{B}^{T}</annotation><annotation encoding="application/x-llamapun" id="alg3.l19.1.m1.1d">bold_italic_R ← bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_G bold_italic_B start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math></span> <span class="ltx_text" id="alg3.l19.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l19.2.m1.1"><semantics id="alg3.l19.2.m1.1a"><mo id="alg3.l19.2.m1.1.1" xref="alg3.l19.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l19.2.m1.1b"><ci id="alg3.l19.2.m1.1.1.cmml" xref="alg3.l19.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l19.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l19.2.m1.1d">▷</annotation></semantics></math> Project gradient
</span>
</div>
<div class="ltx_listingline" id="alg3.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span>                  <span class="ltx_text" id="alg3.l20.1" style="color:#0000FF;"> <math alttext="\bm{G}^{\prime}\leftarrow\bm{A}\bm{R}\bm{B}" class="ltx_Math" display="inline" id="alg3.l20.1.m1.1"><semantics id="alg3.l20.1.m1.1a"><mrow id="alg3.l20.1.m1.1.1" xref="alg3.l20.1.m1.1.1.cmml"><msup id="alg3.l20.1.m1.1.1.2" xref="alg3.l20.1.m1.1.1.2.cmml"><mi id="alg3.l20.1.m1.1.1.2.2" mathcolor="#0000FF" xref="alg3.l20.1.m1.1.1.2.2.cmml">𝑮</mi><mo id="alg3.l20.1.m1.1.1.2.3" mathcolor="#0000FF" xref="alg3.l20.1.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg3.l20.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l20.1.m1.1.1.1.cmml">←</mo><mrow id="alg3.l20.1.m1.1.1.3" xref="alg3.l20.1.m1.1.1.3.cmml"><mi id="alg3.l20.1.m1.1.1.3.2" mathcolor="#0000FF" xref="alg3.l20.1.m1.1.1.3.2.cmml">𝑨</mi><mo id="alg3.l20.1.m1.1.1.3.1" xref="alg3.l20.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg3.l20.1.m1.1.1.3.3" mathcolor="#0000FF" xref="alg3.l20.1.m1.1.1.3.3.cmml">𝑹</mi><mo id="alg3.l20.1.m1.1.1.3.1a" xref="alg3.l20.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg3.l20.1.m1.1.1.3.4" mathcolor="#0000FF" xref="alg3.l20.1.m1.1.1.3.4.cmml">𝑩</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l20.1.m1.1b"><apply id="alg3.l20.1.m1.1.1.cmml" xref="alg3.l20.1.m1.1.1"><ci id="alg3.l20.1.m1.1.1.1.cmml" xref="alg3.l20.1.m1.1.1.1">←</ci><apply id="alg3.l20.1.m1.1.1.2.cmml" xref="alg3.l20.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l20.1.m1.1.1.2.1.cmml" xref="alg3.l20.1.m1.1.1.2">superscript</csymbol><ci id="alg3.l20.1.m1.1.1.2.2.cmml" xref="alg3.l20.1.m1.1.1.2.2">𝑮</ci><ci id="alg3.l20.1.m1.1.1.2.3.cmml" xref="alg3.l20.1.m1.1.1.2.3">′</ci></apply><apply id="alg3.l20.1.m1.1.1.3.cmml" xref="alg3.l20.1.m1.1.1.3"><times id="alg3.l20.1.m1.1.1.3.1.cmml" xref="alg3.l20.1.m1.1.1.3.1"></times><ci id="alg3.l20.1.m1.1.1.3.2.cmml" xref="alg3.l20.1.m1.1.1.3.2">𝑨</ci><ci id="alg3.l20.1.m1.1.1.3.3.cmml" xref="alg3.l20.1.m1.1.1.3.3">𝑹</ci><ci id="alg3.l20.1.m1.1.1.3.4.cmml" xref="alg3.l20.1.m1.1.1.3.4">𝑩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l20.1.m1.1c">\bm{G}^{\prime}\leftarrow\bm{A}\bm{R}\bm{B}</annotation><annotation encoding="application/x-llamapun" id="alg3.l20.1.m1.1d">bold_italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← bold_italic_A bold_italic_R bold_italic_B</annotation></semantics></math></span> <span class="ltx_text" id="alg3.l20.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l20.2.m1.1"><semantics id="alg3.l20.2.m1.1a"><mo id="alg3.l20.2.m1.1.1" xref="alg3.l20.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l20.2.m1.1b"><ci id="alg3.l20.2.m1.1.1.cmml" xref="alg3.l20.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l20.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l20.2.m1.1d">▷</annotation></semantics></math> Reconstruct approximated gradient
</span>
</div>
<div class="ltx_listingline" id="alg3.l21">
<span class="ltx_tag ltx_tag_listingline">21:</span>              <span class="ltx_text ltx_font_bold" id="alg3.l21.1">else</span>
</div>
<div class="ltx_listingline" id="alg3.l22">
<span class="ltx_tag ltx_tag_listingline">22:</span>                  <span class="ltx_text" id="alg3.l22.1" style="color:#0000FF;"> <math alttext="\bm{g}^{\prime}\leftarrow\nabla_{\hat{{\bm{z}}}_{0}({\bm{y}})}\frac{1}{2}\|{%
\bm{y}}-\mathcal{A}(\mathcal{D}(\hat{{\bm{z}}}_{0}({\bm{y}})))\|_{2}^{2}" class="ltx_Math" display="inline" id="alg3.l22.1.m1.3"><semantics id="alg3.l22.1.m1.3a"><mrow id="alg3.l22.1.m1.3.3" xref="alg3.l22.1.m1.3.3.cmml"><msup id="alg3.l22.1.m1.3.3.3" xref="alg3.l22.1.m1.3.3.3.cmml"><mi id="alg3.l22.1.m1.3.3.3.2" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.3.2.cmml">𝒈</mi><mo id="alg3.l22.1.m1.3.3.3.3" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.3.3.cmml">′</mo></msup><mo id="alg3.l22.1.m1.3.3.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.3.3.2.cmml">←</mo><mrow id="alg3.l22.1.m1.3.3.1" xref="alg3.l22.1.m1.3.3.1.cmml"><msub id="alg3.l22.1.m1.3.3.1.2" xref="alg3.l22.1.m1.3.3.1.2.cmml"><mo id="alg3.l22.1.m1.3.3.1.2.2" mathcolor="#0000FF" rspace="0.167em" xref="alg3.l22.1.m1.3.3.1.2.2.cmml">∇</mo><mrow id="alg3.l22.1.m1.1.1.1" xref="alg3.l22.1.m1.1.1.1.cmml"><msub id="alg3.l22.1.m1.1.1.1.3" xref="alg3.l22.1.m1.1.1.1.3.cmml"><mover accent="true" id="alg3.l22.1.m1.1.1.1.3.2" xref="alg3.l22.1.m1.1.1.1.3.2.cmml"><mi id="alg3.l22.1.m1.1.1.1.3.2.2" mathcolor="#0000FF" xref="alg3.l22.1.m1.1.1.1.3.2.2.cmml">𝒛</mi><mo id="alg3.l22.1.m1.1.1.1.3.2.1" mathcolor="#0000FF" xref="alg3.l22.1.m1.1.1.1.3.2.1.cmml">^</mo></mover><mn id="alg3.l22.1.m1.1.1.1.3.3" mathcolor="#0000FF" xref="alg3.l22.1.m1.1.1.1.3.3.cmml">0</mn></msub><mo id="alg3.l22.1.m1.1.1.1.2" xref="alg3.l22.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l22.1.m1.1.1.1.4.2" xref="alg3.l22.1.m1.1.1.1.cmml"><mo id="alg3.l22.1.m1.1.1.1.4.2.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.1.1.1.cmml">(</mo><mi id="alg3.l22.1.m1.1.1.1.1" mathcolor="#0000FF" xref="alg3.l22.1.m1.1.1.1.1.cmml">𝒚</mi><mo id="alg3.l22.1.m1.1.1.1.4.2.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.1.1.1.cmml">)</mo></mrow></mrow></msub><mrow id="alg3.l22.1.m1.3.3.1.1" xref="alg3.l22.1.m1.3.3.1.1.cmml"><mfrac id="alg3.l22.1.m1.3.3.1.1.3" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.3.cmml"><mn id="alg3.l22.1.m1.3.3.1.1.3.2" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.3.2.cmml">1</mn><mn id="alg3.l22.1.m1.3.3.1.1.3.3" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.3.3.cmml">2</mn></mfrac><mo id="alg3.l22.1.m1.3.3.1.1.2" xref="alg3.l22.1.m1.3.3.1.1.2.cmml">⁢</mo><msubsup id="alg3.l22.1.m1.3.3.1.1.1" xref="alg3.l22.1.m1.3.3.1.1.1.cmml"><mrow id="alg3.l22.1.m1.3.3.1.1.1.1.1.1" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">𝒚</mi><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.2" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">𝒜</mi><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝒟</mi><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒛</mi><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="alg3.l22.1.m1.2.2" mathcolor="#0000FF" xref="alg3.l22.1.m1.2.2.cmml">𝒚</mi><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg3.l22.1.m1.3.3.1.1.1.1.3" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.1.1.3.cmml">2</mn><mn id="alg3.l22.1.m1.3.3.1.1.1.3" mathcolor="#0000FF" xref="alg3.l22.1.m1.3.3.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l22.1.m1.3b"><apply id="alg3.l22.1.m1.3.3.cmml" xref="alg3.l22.1.m1.3.3"><ci id="alg3.l22.1.m1.3.3.2.cmml" xref="alg3.l22.1.m1.3.3.2">←</ci><apply id="alg3.l22.1.m1.3.3.3.cmml" xref="alg3.l22.1.m1.3.3.3"><csymbol cd="ambiguous" id="alg3.l22.1.m1.3.3.3.1.cmml" xref="alg3.l22.1.m1.3.3.3">superscript</csymbol><ci id="alg3.l22.1.m1.3.3.3.2.cmml" xref="alg3.l22.1.m1.3.3.3.2">𝒈</ci><ci id="alg3.l22.1.m1.3.3.3.3.cmml" xref="alg3.l22.1.m1.3.3.3.3">′</ci></apply><apply id="alg3.l22.1.m1.3.3.1.cmml" xref="alg3.l22.1.m1.3.3.1"><apply id="alg3.l22.1.m1.3.3.1.2.cmml" xref="alg3.l22.1.m1.3.3.1.2"><csymbol cd="ambiguous" id="alg3.l22.1.m1.3.3.1.2.1.cmml" xref="alg3.l22.1.m1.3.3.1.2">subscript</csymbol><ci id="alg3.l22.1.m1.3.3.1.2.2.cmml" xref="alg3.l22.1.m1.3.3.1.2.2">∇</ci><apply id="alg3.l22.1.m1.1.1.1.cmml" xref="alg3.l22.1.m1.1.1.1"><times id="alg3.l22.1.m1.1.1.1.2.cmml" xref="alg3.l22.1.m1.1.1.1.2"></times><apply id="alg3.l22.1.m1.1.1.1.3.cmml" xref="alg3.l22.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l22.1.m1.1.1.1.3.1.cmml" xref="alg3.l22.1.m1.1.1.1.3">subscript</csymbol><apply id="alg3.l22.1.m1.1.1.1.3.2.cmml" xref="alg3.l22.1.m1.1.1.1.3.2"><ci id="alg3.l22.1.m1.1.1.1.3.2.1.cmml" xref="alg3.l22.1.m1.1.1.1.3.2.1">^</ci><ci id="alg3.l22.1.m1.1.1.1.3.2.2.cmml" xref="alg3.l22.1.m1.1.1.1.3.2.2">𝒛</ci></apply><cn id="alg3.l22.1.m1.1.1.1.3.3.cmml" type="integer" xref="alg3.l22.1.m1.1.1.1.3.3">0</cn></apply><ci id="alg3.l22.1.m1.1.1.1.1.cmml" xref="alg3.l22.1.m1.1.1.1.1">𝒚</ci></apply></apply><apply id="alg3.l22.1.m1.3.3.1.1.cmml" xref="alg3.l22.1.m1.3.3.1.1"><times id="alg3.l22.1.m1.3.3.1.1.2.cmml" xref="alg3.l22.1.m1.3.3.1.1.2"></times><apply id="alg3.l22.1.m1.3.3.1.1.3.cmml" xref="alg3.l22.1.m1.3.3.1.1.3"><divide id="alg3.l22.1.m1.3.3.1.1.3.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.3"></divide><cn id="alg3.l22.1.m1.3.3.1.1.3.2.cmml" type="integer" xref="alg3.l22.1.m1.3.3.1.1.3.2">1</cn><cn id="alg3.l22.1.m1.3.3.1.1.3.3.cmml" type="integer" xref="alg3.l22.1.m1.3.3.1.1.3.3">2</cn></apply><apply id="alg3.l22.1.m1.3.3.1.1.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l22.1.m1.3.3.1.1.1.2.cmml" xref="alg3.l22.1.m1.3.3.1.1.1">superscript</csymbol><apply id="alg3.l22.1.m1.3.3.1.1.1.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l22.1.m1.3.3.1.1.1.1.2.cmml" xref="alg3.l22.1.m1.3.3.1.1.1">subscript</csymbol><apply id="alg3.l22.1.m1.3.3.1.1.1.1.1.2.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="alg3.l22.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.2">norm</csymbol><apply id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1"><minus id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.2"></minus><ci id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.3">𝒚</ci><apply id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1"><times id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.2"></times><ci id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.3">𝒜</ci><apply id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><times id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝒟</ci><apply id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒛</ci></apply><cn id="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="alg3.l22.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="alg3.l22.1.m1.2.2.cmml" xref="alg3.l22.1.m1.2.2">𝒚</ci></apply></apply></apply></apply></apply><cn id="alg3.l22.1.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="alg3.l22.1.m1.3.3.1.1.1.1.3">2</cn></apply><cn id="alg3.l22.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="alg3.l22.1.m1.3.3.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l22.1.m1.3c">\bm{g}^{\prime}\leftarrow\nabla_{\hat{{\bm{z}}}_{0}({\bm{y}})}\frac{1}{2}\|{%
\bm{y}}-\mathcal{A}(\mathcal{D}(\hat{{\bm{z}}}_{0}({\bm{y}})))\|_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="alg3.l22.1.m1.3d">bold_italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← ∇ start_POSTSUBSCRIPT over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_y ) end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∥ bold_italic_y - caligraphic_A ( caligraphic_D ( over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_y ) ) ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></span> <span class="ltx_text" id="alg3.l22.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l22.2.m1.1"><semantics id="alg3.l22.2.m1.1a"><mo id="alg3.l22.2.m1.1.1" xref="alg3.l22.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l22.2.m1.1b"><ci id="alg3.l22.2.m1.1.1.cmml" xref="alg3.l22.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l22.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l22.2.m1.1d">▷</annotation></semantics></math> Compute gradient without modification
</span>
</div>
<div class="ltx_listingline" id="alg3.l23">
<span class="ltx_tag ltx_tag_listingline">23:</span>              <span class="ltx_text ltx_font_bold" id="alg3.l23.1">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l23.2">if</span>
</div>
<div class="ltx_listingline" id="alg3.l24">
<span class="ltx_tag ltx_tag_listingline">24:</span>              <span class="ltx_text" id="alg3.l24.2" style="color:#0000FF;"> Update <math alttext="\hat{{\bm{z}}}_{0}({\bm{y}})" class="ltx_Math" display="inline" id="alg3.l24.1.m1.1"><semantics id="alg3.l24.1.m1.1a"><mrow id="alg3.l24.1.m1.1.2" xref="alg3.l24.1.m1.1.2.cmml"><msub id="alg3.l24.1.m1.1.2.2" xref="alg3.l24.1.m1.1.2.2.cmml"><mover accent="true" id="alg3.l24.1.m1.1.2.2.2" xref="alg3.l24.1.m1.1.2.2.2.cmml"><mi id="alg3.l24.1.m1.1.2.2.2.2" mathcolor="#0000FF" xref="alg3.l24.1.m1.1.2.2.2.2.cmml">𝒛</mi><mo id="alg3.l24.1.m1.1.2.2.2.1" mathcolor="#0000FF" xref="alg3.l24.1.m1.1.2.2.2.1.cmml">^</mo></mover><mn id="alg3.l24.1.m1.1.2.2.3" mathcolor="#0000FF" xref="alg3.l24.1.m1.1.2.2.3.cmml">0</mn></msub><mo id="alg3.l24.1.m1.1.2.1" xref="alg3.l24.1.m1.1.2.1.cmml">⁢</mo><mrow id="alg3.l24.1.m1.1.2.3.2" xref="alg3.l24.1.m1.1.2.cmml"><mo id="alg3.l24.1.m1.1.2.3.2.1" mathcolor="#0000FF" stretchy="false" xref="alg3.l24.1.m1.1.2.cmml">(</mo><mi id="alg3.l24.1.m1.1.1" mathcolor="#0000FF" xref="alg3.l24.1.m1.1.1.cmml">𝒚</mi><mo id="alg3.l24.1.m1.1.2.3.2.2" mathcolor="#0000FF" stretchy="false" xref="alg3.l24.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l24.1.m1.1b"><apply id="alg3.l24.1.m1.1.2.cmml" xref="alg3.l24.1.m1.1.2"><times id="alg3.l24.1.m1.1.2.1.cmml" xref="alg3.l24.1.m1.1.2.1"></times><apply id="alg3.l24.1.m1.1.2.2.cmml" xref="alg3.l24.1.m1.1.2.2"><csymbol cd="ambiguous" id="alg3.l24.1.m1.1.2.2.1.cmml" xref="alg3.l24.1.m1.1.2.2">subscript</csymbol><apply id="alg3.l24.1.m1.1.2.2.2.cmml" xref="alg3.l24.1.m1.1.2.2.2"><ci id="alg3.l24.1.m1.1.2.2.2.1.cmml" xref="alg3.l24.1.m1.1.2.2.2.1">^</ci><ci id="alg3.l24.1.m1.1.2.2.2.2.cmml" xref="alg3.l24.1.m1.1.2.2.2.2">𝒛</ci></apply><cn id="alg3.l24.1.m1.1.2.2.3.cmml" type="integer" xref="alg3.l24.1.m1.1.2.2.3">0</cn></apply><ci id="alg3.l24.1.m1.1.1.cmml" xref="alg3.l24.1.m1.1.1">𝒚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l24.1.m1.1c">\hat{{\bm{z}}}_{0}({\bm{y}})</annotation><annotation encoding="application/x-llamapun" id="alg3.l24.1.m1.1d">over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_y )</annotation></semantics></math> using gradient <math alttext="\bm{g}^{\prime}" class="ltx_Math" display="inline" id="alg3.l24.2.m2.1"><semantics id="alg3.l24.2.m2.1a"><msup id="alg3.l24.2.m2.1.1" xref="alg3.l24.2.m2.1.1.cmml"><mi id="alg3.l24.2.m2.1.1.2" mathcolor="#0000FF" xref="alg3.l24.2.m2.1.1.2.cmml">𝒈</mi><mo id="alg3.l24.2.m2.1.1.3" mathcolor="#0000FF" xref="alg3.l24.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg3.l24.2.m2.1b"><apply id="alg3.l24.2.m2.1.1.cmml" xref="alg3.l24.2.m2.1.1"><csymbol cd="ambiguous" id="alg3.l24.2.m2.1.1.1.cmml" xref="alg3.l24.2.m2.1.1">superscript</csymbol><ci id="alg3.l24.2.m2.1.1.2.cmml" xref="alg3.l24.2.m2.1.1.2">𝒈</ci><ci id="alg3.l24.2.m2.1.1.3.cmml" xref="alg3.l24.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l24.2.m2.1c">\bm{g}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg3.l24.2.m2.1d">bold_italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg3.l25">
<span class="ltx_tag ltx_tag_listingline">25:</span>         <span class="ltx_text ltx_font_bold" id="alg3.l25.1">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l25.2">for</span>
</div>
<div class="ltx_listingline" id="alg3.l26">
<span class="ltx_tag ltx_tag_listingline">26:</span>         <math alttext="{\bm{z}}_{t}=\text{StochasticResample}(\hat{{\bm{z}}}_{0}({\bm{y}}),{\bm{z}}^{%
\prime}_{t},\gamma)" class="ltx_Math" display="inline" id="alg3.l26.m1.4"><semantics id="alg3.l26.m1.4a"><mrow id="alg3.l26.m1.4.4" xref="alg3.l26.m1.4.4.cmml"><msub id="alg3.l26.m1.4.4.4" xref="alg3.l26.m1.4.4.4.cmml"><mi id="alg3.l26.m1.4.4.4.2" xref="alg3.l26.m1.4.4.4.2.cmml">𝒛</mi><mi id="alg3.l26.m1.4.4.4.3" xref="alg3.l26.m1.4.4.4.3.cmml">t</mi></msub><mo id="alg3.l26.m1.4.4.3" xref="alg3.l26.m1.4.4.3.cmml">=</mo><mrow id="alg3.l26.m1.4.4.2" xref="alg3.l26.m1.4.4.2.cmml"><mtext id="alg3.l26.m1.4.4.2.4" xref="alg3.l26.m1.4.4.2.4a.cmml">StochasticResample</mtext><mo id="alg3.l26.m1.4.4.2.3" xref="alg3.l26.m1.4.4.2.3.cmml">⁢</mo><mrow id="alg3.l26.m1.4.4.2.2.2" xref="alg3.l26.m1.4.4.2.2.3.cmml"><mo id="alg3.l26.m1.4.4.2.2.2.3" stretchy="false" xref="alg3.l26.m1.4.4.2.2.3.cmml">(</mo><mrow id="alg3.l26.m1.3.3.1.1.1.1" xref="alg3.l26.m1.3.3.1.1.1.1.cmml"><msub id="alg3.l26.m1.3.3.1.1.1.1.2" xref="alg3.l26.m1.3.3.1.1.1.1.2.cmml"><mover accent="true" id="alg3.l26.m1.3.3.1.1.1.1.2.2" xref="alg3.l26.m1.3.3.1.1.1.1.2.2.cmml"><mi id="alg3.l26.m1.3.3.1.1.1.1.2.2.2" xref="alg3.l26.m1.3.3.1.1.1.1.2.2.2.cmml">𝒛</mi><mo id="alg3.l26.m1.3.3.1.1.1.1.2.2.1" xref="alg3.l26.m1.3.3.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="alg3.l26.m1.3.3.1.1.1.1.2.3" xref="alg3.l26.m1.3.3.1.1.1.1.2.3.cmml">0</mn></msub><mo id="alg3.l26.m1.3.3.1.1.1.1.1" xref="alg3.l26.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="alg3.l26.m1.3.3.1.1.1.1.3.2" xref="alg3.l26.m1.3.3.1.1.1.1.cmml"><mo id="alg3.l26.m1.3.3.1.1.1.1.3.2.1" stretchy="false" xref="alg3.l26.m1.3.3.1.1.1.1.cmml">(</mo><mi id="alg3.l26.m1.1.1" xref="alg3.l26.m1.1.1.cmml">𝒚</mi><mo id="alg3.l26.m1.3.3.1.1.1.1.3.2.2" stretchy="false" xref="alg3.l26.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l26.m1.4.4.2.2.2.4" xref="alg3.l26.m1.4.4.2.2.3.cmml">,</mo><msubsup id="alg3.l26.m1.4.4.2.2.2.2" xref="alg3.l26.m1.4.4.2.2.2.2.cmml"><mi id="alg3.l26.m1.4.4.2.2.2.2.2.2" xref="alg3.l26.m1.4.4.2.2.2.2.2.2.cmml">𝒛</mi><mi id="alg3.l26.m1.4.4.2.2.2.2.3" xref="alg3.l26.m1.4.4.2.2.2.2.3.cmml">t</mi><mo id="alg3.l26.m1.4.4.2.2.2.2.2.3" xref="alg3.l26.m1.4.4.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="alg3.l26.m1.4.4.2.2.2.5" xref="alg3.l26.m1.4.4.2.2.3.cmml">,</mo><mi id="alg3.l26.m1.2.2" xref="alg3.l26.m1.2.2.cmml">γ</mi><mo id="alg3.l26.m1.4.4.2.2.2.6" stretchy="false" xref="alg3.l26.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l26.m1.4b"><apply id="alg3.l26.m1.4.4.cmml" xref="alg3.l26.m1.4.4"><eq id="alg3.l26.m1.4.4.3.cmml" xref="alg3.l26.m1.4.4.3"></eq><apply id="alg3.l26.m1.4.4.4.cmml" xref="alg3.l26.m1.4.4.4"><csymbol cd="ambiguous" id="alg3.l26.m1.4.4.4.1.cmml" xref="alg3.l26.m1.4.4.4">subscript</csymbol><ci id="alg3.l26.m1.4.4.4.2.cmml" xref="alg3.l26.m1.4.4.4.2">𝒛</ci><ci id="alg3.l26.m1.4.4.4.3.cmml" xref="alg3.l26.m1.4.4.4.3">𝑡</ci></apply><apply id="alg3.l26.m1.4.4.2.cmml" xref="alg3.l26.m1.4.4.2"><times id="alg3.l26.m1.4.4.2.3.cmml" xref="alg3.l26.m1.4.4.2.3"></times><ci id="alg3.l26.m1.4.4.2.4a.cmml" xref="alg3.l26.m1.4.4.2.4"><mtext id="alg3.l26.m1.4.4.2.4.cmml" xref="alg3.l26.m1.4.4.2.4">StochasticResample</mtext></ci><vector id="alg3.l26.m1.4.4.2.2.3.cmml" xref="alg3.l26.m1.4.4.2.2.2"><apply id="alg3.l26.m1.3.3.1.1.1.1.cmml" xref="alg3.l26.m1.3.3.1.1.1.1"><times id="alg3.l26.m1.3.3.1.1.1.1.1.cmml" xref="alg3.l26.m1.3.3.1.1.1.1.1"></times><apply id="alg3.l26.m1.3.3.1.1.1.1.2.cmml" xref="alg3.l26.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l26.m1.3.3.1.1.1.1.2.1.cmml" xref="alg3.l26.m1.3.3.1.1.1.1.2">subscript</csymbol><apply id="alg3.l26.m1.3.3.1.1.1.1.2.2.cmml" xref="alg3.l26.m1.3.3.1.1.1.1.2.2"><ci id="alg3.l26.m1.3.3.1.1.1.1.2.2.1.cmml" xref="alg3.l26.m1.3.3.1.1.1.1.2.2.1">^</ci><ci id="alg3.l26.m1.3.3.1.1.1.1.2.2.2.cmml" xref="alg3.l26.m1.3.3.1.1.1.1.2.2.2">𝒛</ci></apply><cn id="alg3.l26.m1.3.3.1.1.1.1.2.3.cmml" type="integer" xref="alg3.l26.m1.3.3.1.1.1.1.2.3">0</cn></apply><ci id="alg3.l26.m1.1.1.cmml" xref="alg3.l26.m1.1.1">𝒚</ci></apply><apply id="alg3.l26.m1.4.4.2.2.2.2.cmml" xref="alg3.l26.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l26.m1.4.4.2.2.2.2.1.cmml" xref="alg3.l26.m1.4.4.2.2.2.2">subscript</csymbol><apply id="alg3.l26.m1.4.4.2.2.2.2.2.cmml" xref="alg3.l26.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l26.m1.4.4.2.2.2.2.2.1.cmml" xref="alg3.l26.m1.4.4.2.2.2.2">superscript</csymbol><ci id="alg3.l26.m1.4.4.2.2.2.2.2.2.cmml" xref="alg3.l26.m1.4.4.2.2.2.2.2.2">𝒛</ci><ci id="alg3.l26.m1.4.4.2.2.2.2.2.3.cmml" xref="alg3.l26.m1.4.4.2.2.2.2.2.3">′</ci></apply><ci id="alg3.l26.m1.4.4.2.2.2.2.3.cmml" xref="alg3.l26.m1.4.4.2.2.2.2.3">𝑡</ci></apply><ci id="alg3.l26.m1.2.2.cmml" xref="alg3.l26.m1.2.2">𝛾</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l26.m1.4c">{\bm{z}}_{t}=\text{StochasticResample}(\hat{{\bm{z}}}_{0}({\bm{y}}),{\bm{z}}^{%
\prime}_{t},\gamma)</annotation><annotation encoding="application/x-llamapun" id="alg3.l26.m1.4d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = StochasticResample ( over^ start_ARG bold_italic_z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_y ) , bold_italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_γ )</annotation></semantics></math> <span class="ltx_text" id="alg3.l26.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l26.1.m1.1"><semantics id="alg3.l26.1.m1.1a"><mo id="alg3.l26.1.m1.1.1" xref="alg3.l26.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l26.1.m1.1b"><ci id="alg3.l26.1.m1.1.1.cmml" xref="alg3.l26.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l26.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l26.1.m1.1d">▷</annotation></semantics></math> Map back to <math alttext="t" class="ltx_Math" display="inline" id="alg3.l26.2.m2.1"><semantics id="alg3.l26.2.m2.1a"><mi id="alg3.l26.2.m2.1.1" xref="alg3.l26.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg3.l26.2.m2.1b"><ci id="alg3.l26.2.m2.1.1.cmml" xref="alg3.l26.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l26.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="alg3.l26.2.m2.1d">italic_t</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg3.l27">
<span class="ltx_tag ltx_tag_listingline">27:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l27.1">else</span>
</div>
<div class="ltx_listingline" id="alg3.l28">
<span class="ltx_tag ltx_tag_listingline">28:</span>         <math alttext="{\bm{z}}_{t}={\bm{z}}^{\prime}_{t}" class="ltx_Math" display="inline" id="alg3.l28.m1.1"><semantics id="alg3.l28.m1.1a"><mrow id="alg3.l28.m1.1.1" xref="alg3.l28.m1.1.1.cmml"><msub id="alg3.l28.m1.1.1.2" xref="alg3.l28.m1.1.1.2.cmml"><mi id="alg3.l28.m1.1.1.2.2" xref="alg3.l28.m1.1.1.2.2.cmml">𝒛</mi><mi id="alg3.l28.m1.1.1.2.3" xref="alg3.l28.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg3.l28.m1.1.1.1" xref="alg3.l28.m1.1.1.1.cmml">=</mo><msubsup id="alg3.l28.m1.1.1.3" xref="alg3.l28.m1.1.1.3.cmml"><mi id="alg3.l28.m1.1.1.3.2.2" xref="alg3.l28.m1.1.1.3.2.2.cmml">𝒛</mi><mi id="alg3.l28.m1.1.1.3.3" xref="alg3.l28.m1.1.1.3.3.cmml">t</mi><mo id="alg3.l28.m1.1.1.3.2.3" xref="alg3.l28.m1.1.1.3.2.3.cmml">′</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l28.m1.1b"><apply id="alg3.l28.m1.1.1.cmml" xref="alg3.l28.m1.1.1"><eq id="alg3.l28.m1.1.1.1.cmml" xref="alg3.l28.m1.1.1.1"></eq><apply id="alg3.l28.m1.1.1.2.cmml" xref="alg3.l28.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l28.m1.1.1.2.1.cmml" xref="alg3.l28.m1.1.1.2">subscript</csymbol><ci id="alg3.l28.m1.1.1.2.2.cmml" xref="alg3.l28.m1.1.1.2.2">𝒛</ci><ci id="alg3.l28.m1.1.1.2.3.cmml" xref="alg3.l28.m1.1.1.2.3">𝑡</ci></apply><apply id="alg3.l28.m1.1.1.3.cmml" xref="alg3.l28.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l28.m1.1.1.3.1.cmml" xref="alg3.l28.m1.1.1.3">subscript</csymbol><apply id="alg3.l28.m1.1.1.3.2.cmml" xref="alg3.l28.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l28.m1.1.1.3.2.1.cmml" xref="alg3.l28.m1.1.1.3">superscript</csymbol><ci id="alg3.l28.m1.1.1.3.2.2.cmml" xref="alg3.l28.m1.1.1.3.2.2">𝒛</ci><ci id="alg3.l28.m1.1.1.3.2.3.cmml" xref="alg3.l28.m1.1.1.3.2.3">′</ci></apply><ci id="alg3.l28.m1.1.1.3.3.cmml" xref="alg3.l28.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l28.m1.1c">{\bm{z}}_{t}={\bm{z}}^{\prime}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg3.l28.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg3.l28.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l28.1.m1.1"><semantics id="alg3.l28.1.m1.1a"><mo id="alg3.l28.1.m1.1.1" xref="alg3.l28.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l28.1.m1.1b"><ci id="alg3.l28.1.m1.1.1.cmml" xref="alg3.l28.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l28.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l28.1.m1.1d">▷</annotation></semantics></math> Unconditional sampling if not resampling
</span>
</div>
<div class="ltx_listingline" id="alg3.l29">
<span class="ltx_tag ltx_tag_listingline">29:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l29.1">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l29.2">if</span>
</div>
<div class="ltx_listingline" id="alg3.l30">
<span class="ltx_tag ltx_tag_listingline">30:</span><span class="ltx_text ltx_font_bold" id="alg3.l30.1">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l30.2">for</span>
</div>
<div class="ltx_listingline" id="alg3.l31">
<span class="ltx_tag ltx_tag_listingline">31:</span><math alttext="{\bm{x}}_{0}=\mathcal{D}({\bm{z}}_{0})" class="ltx_Math" display="inline" id="alg3.l31.m1.1"><semantics id="alg3.l31.m1.1a"><mrow id="alg3.l31.m1.1.1" xref="alg3.l31.m1.1.1.cmml"><msub id="alg3.l31.m1.1.1.3" xref="alg3.l31.m1.1.1.3.cmml"><mi id="alg3.l31.m1.1.1.3.2" xref="alg3.l31.m1.1.1.3.2.cmml">𝒙</mi><mn id="alg3.l31.m1.1.1.3.3" xref="alg3.l31.m1.1.1.3.3.cmml">0</mn></msub><mo id="alg3.l31.m1.1.1.2" xref="alg3.l31.m1.1.1.2.cmml">=</mo><mrow id="alg3.l31.m1.1.1.1" xref="alg3.l31.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l31.m1.1.1.1.3" xref="alg3.l31.m1.1.1.1.3.cmml">𝒟</mi><mo id="alg3.l31.m1.1.1.1.2" xref="alg3.l31.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l31.m1.1.1.1.1.1" xref="alg3.l31.m1.1.1.1.1.1.1.cmml"><mo id="alg3.l31.m1.1.1.1.1.1.2" stretchy="false" xref="alg3.l31.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg3.l31.m1.1.1.1.1.1.1" xref="alg3.l31.m1.1.1.1.1.1.1.cmml"><mi id="alg3.l31.m1.1.1.1.1.1.1.2" xref="alg3.l31.m1.1.1.1.1.1.1.2.cmml">𝒛</mi><mn id="alg3.l31.m1.1.1.1.1.1.1.3" xref="alg3.l31.m1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg3.l31.m1.1.1.1.1.1.3" stretchy="false" xref="alg3.l31.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l31.m1.1b"><apply id="alg3.l31.m1.1.1.cmml" xref="alg3.l31.m1.1.1"><eq id="alg3.l31.m1.1.1.2.cmml" xref="alg3.l31.m1.1.1.2"></eq><apply id="alg3.l31.m1.1.1.3.cmml" xref="alg3.l31.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l31.m1.1.1.3.1.cmml" xref="alg3.l31.m1.1.1.3">subscript</csymbol><ci id="alg3.l31.m1.1.1.3.2.cmml" xref="alg3.l31.m1.1.1.3.2">𝒙</ci><cn id="alg3.l31.m1.1.1.3.3.cmml" type="integer" xref="alg3.l31.m1.1.1.3.3">0</cn></apply><apply id="alg3.l31.m1.1.1.1.cmml" xref="alg3.l31.m1.1.1.1"><times id="alg3.l31.m1.1.1.1.2.cmml" xref="alg3.l31.m1.1.1.1.2"></times><ci id="alg3.l31.m1.1.1.1.3.cmml" xref="alg3.l31.m1.1.1.1.3">𝒟</ci><apply id="alg3.l31.m1.1.1.1.1.1.1.cmml" xref="alg3.l31.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l31.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l31.m1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l31.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l31.m1.1.1.1.1.1.1.2">𝒛</ci><cn id="alg3.l31.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg3.l31.m1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l31.m1.1c">{\bm{x}}_{0}=\mathcal{D}({\bm{z}}_{0})</annotation><annotation encoding="application/x-llamapun" id="alg3.l31.m1.1d">bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = caligraphic_D ( bold_italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg3.l31.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg3.l31.1.m1.1"><semantics id="alg3.l31.1.m1.1a"><mo id="alg3.l31.1.m1.1.1" xref="alg3.l31.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l31.1.m1.1b"><ci id="alg3.l31.1.m1.1.1.cmml" xref="alg3.l31.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l31.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg3.l31.1.m1.1d">▷</annotation></semantics></math> Output reconstructed image
</span>
</div>
<div class="ltx_listingline" id="alg3.l32">
<span class="ltx_tag ltx_tag_listingline">32:</span><span class="ltx_text ltx_font_bold" id="alg3.l32.1">return</span> <math alttext="{\bm{x}}_{0}" class="ltx_Math" display="inline" id="alg3.l32.m1.1"><semantics id="alg3.l32.m1.1a"><msub id="alg3.l32.m1.1.1" xref="alg3.l32.m1.1.1.cmml"><mi id="alg3.l32.m1.1.1.2" xref="alg3.l32.m1.1.1.2.cmml">𝒙</mi><mn id="alg3.l32.m1.1.1.3" xref="alg3.l32.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg3.l32.m1.1b"><apply id="alg3.l32.m1.1.1.cmml" xref="alg3.l32.m1.1.1"><csymbol cd="ambiguous" id="alg3.l32.m1.1.1.1.cmml" xref="alg3.l32.m1.1.1">subscript</csymbol><ci id="alg3.l32.m1.1.1.2.cmml" xref="alg3.l32.m1.1.1.2">𝒙</ci><cn id="alg3.l32.m1.1.1.3.cmml" type="integer" xref="alg3.l32.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l32.m1.1c">{\bm{x}}_{0}</annotation><annotation encoding="application/x-llamapun" id="alg3.l32.m1.1d">bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="A3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.5 </span>DAPS</h3>
<div class="ltx_para ltx_noindent" id="A3.SS5.p1">
<p class="ltx_p" id="A3.SS5.p1.9">We improve upon DAPS by incorporating a state-guided projected gradient. We introduce a variance retention threshold <math alttext="\tau" class="ltx_Math" display="inline" id="A3.SS5.p1.1.m1.1"><semantics id="A3.SS5.p1.1.m1.1a"><mi id="A3.SS5.p1.1.m1.1.1" xref="A3.SS5.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.1.m1.1b"><ci id="A3.SS5.p1.1.m1.1.1.cmml" xref="A3.SS5.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.1.m1.1d">italic_τ</annotation></semantics></math> to determine the projection rank. For each noise level in the annealing loop, DAPS computes the initial estimate <math alttext="\hat{{\bm{x}}}_{0}^{(0)}" class="ltx_Math" display="inline" id="A3.SS5.p1.2.m2.1"><semantics id="A3.SS5.p1.2.m2.1a"><msubsup id="A3.SS5.p1.2.m2.1.2" xref="A3.SS5.p1.2.m2.1.2.cmml"><mover accent="true" id="A3.SS5.p1.2.m2.1.2.2.2" xref="A3.SS5.p1.2.m2.1.2.2.2.cmml"><mi id="A3.SS5.p1.2.m2.1.2.2.2.2" xref="A3.SS5.p1.2.m2.1.2.2.2.2.cmml">𝒙</mi><mo id="A3.SS5.p1.2.m2.1.2.2.2.1" xref="A3.SS5.p1.2.m2.1.2.2.2.1.cmml">^</mo></mover><mn id="A3.SS5.p1.2.m2.1.2.2.3" xref="A3.SS5.p1.2.m2.1.2.2.3.cmml">0</mn><mrow id="A3.SS5.p1.2.m2.1.1.1.3" xref="A3.SS5.p1.2.m2.1.2.cmml"><mo id="A3.SS5.p1.2.m2.1.1.1.3.1" stretchy="false" xref="A3.SS5.p1.2.m2.1.2.cmml">(</mo><mn id="A3.SS5.p1.2.m2.1.1.1.1" xref="A3.SS5.p1.2.m2.1.1.1.1.cmml">0</mn><mo id="A3.SS5.p1.2.m2.1.1.1.3.2" stretchy="false" xref="A3.SS5.p1.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.2.m2.1b"><apply id="A3.SS5.p1.2.m2.1.2.cmml" xref="A3.SS5.p1.2.m2.1.2"><csymbol cd="ambiguous" id="A3.SS5.p1.2.m2.1.2.1.cmml" xref="A3.SS5.p1.2.m2.1.2">superscript</csymbol><apply id="A3.SS5.p1.2.m2.1.2.2.cmml" xref="A3.SS5.p1.2.m2.1.2"><csymbol cd="ambiguous" id="A3.SS5.p1.2.m2.1.2.2.1.cmml" xref="A3.SS5.p1.2.m2.1.2">subscript</csymbol><apply id="A3.SS5.p1.2.m2.1.2.2.2.cmml" xref="A3.SS5.p1.2.m2.1.2.2.2"><ci id="A3.SS5.p1.2.m2.1.2.2.2.1.cmml" xref="A3.SS5.p1.2.m2.1.2.2.2.1">^</ci><ci id="A3.SS5.p1.2.m2.1.2.2.2.2.cmml" xref="A3.SS5.p1.2.m2.1.2.2.2.2">𝒙</ci></apply><cn id="A3.SS5.p1.2.m2.1.2.2.3.cmml" type="integer" xref="A3.SS5.p1.2.m2.1.2.2.3">0</cn></apply><cn id="A3.SS5.p1.2.m2.1.1.1.1.cmml" type="integer" xref="A3.SS5.p1.2.m2.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.2.m2.1c">\hat{{\bm{x}}}_{0}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.2.m2.1d">over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math> by solving the probability flow ODE using the score model <math alttext="{\bm{s}}_{\theta}" class="ltx_Math" display="inline" id="A3.SS5.p1.3.m3.1"><semantics id="A3.SS5.p1.3.m3.1a"><msub id="A3.SS5.p1.3.m3.1.1" xref="A3.SS5.p1.3.m3.1.1.cmml"><mi id="A3.SS5.p1.3.m3.1.1.2" xref="A3.SS5.p1.3.m3.1.1.2.cmml">𝒔</mi><mi id="A3.SS5.p1.3.m3.1.1.3" xref="A3.SS5.p1.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.3.m3.1b"><apply id="A3.SS5.p1.3.m3.1.1.cmml" xref="A3.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A3.SS5.p1.3.m3.1.1.1.cmml" xref="A3.SS5.p1.3.m3.1.1">subscript</csymbol><ci id="A3.SS5.p1.3.m3.1.1.2.cmml" xref="A3.SS5.p1.3.m3.1.1.2">𝒔</ci><ci id="A3.SS5.p1.3.m3.1.1.3.cmml" xref="A3.SS5.p1.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.3.m3.1c">{\bm{s}}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.3.m3.1d">bold_italic_s start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>. This estimate represents a guess of the clean image given the current noisy sample <math alttext="{\bm{x}}_{t_{i}}" class="ltx_Math" display="inline" id="A3.SS5.p1.4.m4.1"><semantics id="A3.SS5.p1.4.m4.1a"><msub id="A3.SS5.p1.4.m4.1.1" xref="A3.SS5.p1.4.m4.1.1.cmml"><mi id="A3.SS5.p1.4.m4.1.1.2" xref="A3.SS5.p1.4.m4.1.1.2.cmml">𝒙</mi><msub id="A3.SS5.p1.4.m4.1.1.3" xref="A3.SS5.p1.4.m4.1.1.3.cmml"><mi id="A3.SS5.p1.4.m4.1.1.3.2" xref="A3.SS5.p1.4.m4.1.1.3.2.cmml">t</mi><mi id="A3.SS5.p1.4.m4.1.1.3.3" xref="A3.SS5.p1.4.m4.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.4.m4.1b"><apply id="A3.SS5.p1.4.m4.1.1.cmml" xref="A3.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A3.SS5.p1.4.m4.1.1.1.cmml" xref="A3.SS5.p1.4.m4.1.1">subscript</csymbol><ci id="A3.SS5.p1.4.m4.1.1.2.cmml" xref="A3.SS5.p1.4.m4.1.1.2">𝒙</ci><apply id="A3.SS5.p1.4.m4.1.1.3.cmml" xref="A3.SS5.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="A3.SS5.p1.4.m4.1.1.3.1.cmml" xref="A3.SS5.p1.4.m4.1.1.3">subscript</csymbol><ci id="A3.SS5.p1.4.m4.1.1.3.2.cmml" xref="A3.SS5.p1.4.m4.1.1.3.2">𝑡</ci><ci id="A3.SS5.p1.4.m4.1.1.3.3.cmml" xref="A3.SS5.p1.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.4.m4.1c">{\bm{x}}_{t_{i}}</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.4.m4.1d">bold_italic_x start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. We then perform SVD on this estimate in image matrix form <math alttext="\hat{\bm{X}}_{0}^{(0)}" class="ltx_Math" display="inline" id="A3.SS5.p1.5.m5.1"><semantics id="A3.SS5.p1.5.m5.1a"><msubsup id="A3.SS5.p1.5.m5.1.2" xref="A3.SS5.p1.5.m5.1.2.cmml"><mover accent="true" id="A3.SS5.p1.5.m5.1.2.2.2" xref="A3.SS5.p1.5.m5.1.2.2.2.cmml"><mi id="A3.SS5.p1.5.m5.1.2.2.2.2" xref="A3.SS5.p1.5.m5.1.2.2.2.2.cmml">𝑿</mi><mo id="A3.SS5.p1.5.m5.1.2.2.2.1" xref="A3.SS5.p1.5.m5.1.2.2.2.1.cmml">^</mo></mover><mn id="A3.SS5.p1.5.m5.1.2.2.3" xref="A3.SS5.p1.5.m5.1.2.2.3.cmml">0</mn><mrow id="A3.SS5.p1.5.m5.1.1.1.3" xref="A3.SS5.p1.5.m5.1.2.cmml"><mo id="A3.SS5.p1.5.m5.1.1.1.3.1" stretchy="false" xref="A3.SS5.p1.5.m5.1.2.cmml">(</mo><mn id="A3.SS5.p1.5.m5.1.1.1.1" xref="A3.SS5.p1.5.m5.1.1.1.1.cmml">0</mn><mo id="A3.SS5.p1.5.m5.1.1.1.3.2" stretchy="false" xref="A3.SS5.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.5.m5.1b"><apply id="A3.SS5.p1.5.m5.1.2.cmml" xref="A3.SS5.p1.5.m5.1.2"><csymbol cd="ambiguous" id="A3.SS5.p1.5.m5.1.2.1.cmml" xref="A3.SS5.p1.5.m5.1.2">superscript</csymbol><apply id="A3.SS5.p1.5.m5.1.2.2.cmml" xref="A3.SS5.p1.5.m5.1.2"><csymbol cd="ambiguous" id="A3.SS5.p1.5.m5.1.2.2.1.cmml" xref="A3.SS5.p1.5.m5.1.2">subscript</csymbol><apply id="A3.SS5.p1.5.m5.1.2.2.2.cmml" xref="A3.SS5.p1.5.m5.1.2.2.2"><ci id="A3.SS5.p1.5.m5.1.2.2.2.1.cmml" xref="A3.SS5.p1.5.m5.1.2.2.2.1">^</ci><ci id="A3.SS5.p1.5.m5.1.2.2.2.2.cmml" xref="A3.SS5.p1.5.m5.1.2.2.2.2">𝑿</ci></apply><cn id="A3.SS5.p1.5.m5.1.2.2.3.cmml" type="integer" xref="A3.SS5.p1.5.m5.1.2.2.3">0</cn></apply><cn id="A3.SS5.p1.5.m5.1.1.1.1.cmml" type="integer" xref="A3.SS5.p1.5.m5.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.5.m5.1c">\hat{\bm{X}}_{0}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.5.m5.1d">over^ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math> (using it as our diffusion state), determine the appropriate rank based on <math alttext="\tau" class="ltx_Math" display="inline" id="A3.SS5.p1.6.m6.1"><semantics id="A3.SS5.p1.6.m6.1a"><mi id="A3.SS5.p1.6.m6.1.1" xref="A3.SS5.p1.6.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.6.m6.1b"><ci id="A3.SS5.p1.6.m6.1.1.cmml" xref="A3.SS5.p1.6.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.6.m6.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.6.m6.1d">italic_τ</annotation></semantics></math>, and construct projection matrices. Within the Langevin dynamics loop, we calculate the full gradient, combining both the prior term <math alttext="\log p(\hat{{\bm{x}}}_{0}^{(j)}|{\bm{x}}_{t_{i}})" class="ltx_Math" display="inline" id="A3.SS5.p1.7.m7.2"><semantics id="A3.SS5.p1.7.m7.2a"><mrow id="A3.SS5.p1.7.m7.2.2" xref="A3.SS5.p1.7.m7.2.2.cmml"><mrow id="A3.SS5.p1.7.m7.2.2.3" xref="A3.SS5.p1.7.m7.2.2.3.cmml"><mi id="A3.SS5.p1.7.m7.2.2.3.1" xref="A3.SS5.p1.7.m7.2.2.3.1.cmml">log</mi><mo id="A3.SS5.p1.7.m7.2.2.3a" lspace="0.167em" xref="A3.SS5.p1.7.m7.2.2.3.cmml">⁡</mo><mi id="A3.SS5.p1.7.m7.2.2.3.2" xref="A3.SS5.p1.7.m7.2.2.3.2.cmml">p</mi></mrow><mo id="A3.SS5.p1.7.m7.2.2.2" xref="A3.SS5.p1.7.m7.2.2.2.cmml">⁢</mo><mrow id="A3.SS5.p1.7.m7.2.2.1.1" xref="A3.SS5.p1.7.m7.2.2.1.1.1.cmml"><mo id="A3.SS5.p1.7.m7.2.2.1.1.2" stretchy="false" xref="A3.SS5.p1.7.m7.2.2.1.1.1.cmml">(</mo><mrow id="A3.SS5.p1.7.m7.2.2.1.1.1" xref="A3.SS5.p1.7.m7.2.2.1.1.1.cmml"><msubsup id="A3.SS5.p1.7.m7.2.2.1.1.1.2" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.cmml"><mover accent="true" id="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2.cmml"><mi id="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2.2" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2.2.cmml">𝒙</mi><mo id="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2.1" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2.1.cmml">^</mo></mover><mn id="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.3" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.3.cmml">0</mn><mrow id="A3.SS5.p1.7.m7.1.1.1.3" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.cmml"><mo id="A3.SS5.p1.7.m7.1.1.1.3.1" stretchy="false" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.cmml">(</mo><mi id="A3.SS5.p1.7.m7.1.1.1.1" xref="A3.SS5.p1.7.m7.1.1.1.1.cmml">j</mi><mo id="A3.SS5.p1.7.m7.1.1.1.3.2" stretchy="false" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.cmml">)</mo></mrow></msubsup><mo fence="false" id="A3.SS5.p1.7.m7.2.2.1.1.1.1" xref="A3.SS5.p1.7.m7.2.2.1.1.1.1.cmml">|</mo><msub id="A3.SS5.p1.7.m7.2.2.1.1.1.3" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3.cmml"><mi id="A3.SS5.p1.7.m7.2.2.1.1.1.3.2" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3.2.cmml">𝒙</mi><msub id="A3.SS5.p1.7.m7.2.2.1.1.1.3.3" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.cmml"><mi id="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.2" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.2.cmml">t</mi><mi id="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.3" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.3.cmml">i</mi></msub></msub></mrow><mo id="A3.SS5.p1.7.m7.2.2.1.1.3" stretchy="false" xref="A3.SS5.p1.7.m7.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.7.m7.2b"><apply id="A3.SS5.p1.7.m7.2.2.cmml" xref="A3.SS5.p1.7.m7.2.2"><times id="A3.SS5.p1.7.m7.2.2.2.cmml" xref="A3.SS5.p1.7.m7.2.2.2"></times><apply id="A3.SS5.p1.7.m7.2.2.3.cmml" xref="A3.SS5.p1.7.m7.2.2.3"><log id="A3.SS5.p1.7.m7.2.2.3.1.cmml" xref="A3.SS5.p1.7.m7.2.2.3.1"></log><ci id="A3.SS5.p1.7.m7.2.2.3.2.cmml" xref="A3.SS5.p1.7.m7.2.2.3.2">𝑝</ci></apply><apply id="A3.SS5.p1.7.m7.2.2.1.1.1.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1"><csymbol cd="latexml" id="A3.SS5.p1.7.m7.2.2.1.1.1.1.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.1">conditional</csymbol><apply id="A3.SS5.p1.7.m7.2.2.1.1.1.2.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A3.SS5.p1.7.m7.2.2.1.1.1.2.1.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2">superscript</csymbol><apply id="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.1.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2">subscript</csymbol><apply id="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2"><ci id="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2.1.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2.1">^</ci><ci id="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2.2.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.2.2">𝒙</ci></apply><cn id="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.3.cmml" type="integer" xref="A3.SS5.p1.7.m7.2.2.1.1.1.2.2.3">0</cn></apply><ci id="A3.SS5.p1.7.m7.1.1.1.1.cmml" xref="A3.SS5.p1.7.m7.1.1.1.1">𝑗</ci></apply><apply id="A3.SS5.p1.7.m7.2.2.1.1.1.3.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS5.p1.7.m7.2.2.1.1.1.3.1.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3">subscript</csymbol><ci id="A3.SS5.p1.7.m7.2.2.1.1.1.3.2.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3.2">𝒙</ci><apply id="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.1.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3.3">subscript</csymbol><ci id="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.2.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.2">𝑡</ci><ci id="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.3.cmml" xref="A3.SS5.p1.7.m7.2.2.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.7.m7.2c">\log p(\hat{{\bm{x}}}_{0}^{(j)}|{\bm{x}}_{t_{i}})</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.7.m7.2d">roman_log italic_p ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | bold_italic_x start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> and the likelihood term <math alttext="\log p({\bm{y}}|\hat{{\bm{x}}}_{0}^{(j)})" class="ltx_Math" display="inline" id="A3.SS5.p1.8.m8.2"><semantics id="A3.SS5.p1.8.m8.2a"><mrow id="A3.SS5.p1.8.m8.2.2" xref="A3.SS5.p1.8.m8.2.2.cmml"><mrow id="A3.SS5.p1.8.m8.2.2.3" xref="A3.SS5.p1.8.m8.2.2.3.cmml"><mi id="A3.SS5.p1.8.m8.2.2.3.1" xref="A3.SS5.p1.8.m8.2.2.3.1.cmml">log</mi><mo id="A3.SS5.p1.8.m8.2.2.3a" lspace="0.167em" xref="A3.SS5.p1.8.m8.2.2.3.cmml">⁡</mo><mi id="A3.SS5.p1.8.m8.2.2.3.2" xref="A3.SS5.p1.8.m8.2.2.3.2.cmml">p</mi></mrow><mo id="A3.SS5.p1.8.m8.2.2.2" xref="A3.SS5.p1.8.m8.2.2.2.cmml">⁢</mo><mrow id="A3.SS5.p1.8.m8.2.2.1.1" xref="A3.SS5.p1.8.m8.2.2.1.1.1.cmml"><mo id="A3.SS5.p1.8.m8.2.2.1.1.2" stretchy="false" xref="A3.SS5.p1.8.m8.2.2.1.1.1.cmml">(</mo><mrow id="A3.SS5.p1.8.m8.2.2.1.1.1" xref="A3.SS5.p1.8.m8.2.2.1.1.1.cmml"><mi id="A3.SS5.p1.8.m8.2.2.1.1.1.2" xref="A3.SS5.p1.8.m8.2.2.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="A3.SS5.p1.8.m8.2.2.1.1.1.1" xref="A3.SS5.p1.8.m8.2.2.1.1.1.1.cmml">|</mo><msubsup id="A3.SS5.p1.8.m8.2.2.1.1.1.3" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.cmml"><mover accent="true" id="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2.cmml"><mi id="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2.2" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2.2.cmml">𝒙</mi><mo id="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2.1" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2.1.cmml">^</mo></mover><mn id="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.3" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.3.cmml">0</mn><mrow id="A3.SS5.p1.8.m8.1.1.1.3" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.cmml"><mo id="A3.SS5.p1.8.m8.1.1.1.3.1" stretchy="false" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.cmml">(</mo><mi id="A3.SS5.p1.8.m8.1.1.1.1" xref="A3.SS5.p1.8.m8.1.1.1.1.cmml">j</mi><mo id="A3.SS5.p1.8.m8.1.1.1.3.2" stretchy="false" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A3.SS5.p1.8.m8.2.2.1.1.3" stretchy="false" xref="A3.SS5.p1.8.m8.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.8.m8.2b"><apply id="A3.SS5.p1.8.m8.2.2.cmml" xref="A3.SS5.p1.8.m8.2.2"><times id="A3.SS5.p1.8.m8.2.2.2.cmml" xref="A3.SS5.p1.8.m8.2.2.2"></times><apply id="A3.SS5.p1.8.m8.2.2.3.cmml" xref="A3.SS5.p1.8.m8.2.2.3"><log id="A3.SS5.p1.8.m8.2.2.3.1.cmml" xref="A3.SS5.p1.8.m8.2.2.3.1"></log><ci id="A3.SS5.p1.8.m8.2.2.3.2.cmml" xref="A3.SS5.p1.8.m8.2.2.3.2">𝑝</ci></apply><apply id="A3.SS5.p1.8.m8.2.2.1.1.1.cmml" xref="A3.SS5.p1.8.m8.2.2.1.1"><csymbol cd="latexml" id="A3.SS5.p1.8.m8.2.2.1.1.1.1.cmml" xref="A3.SS5.p1.8.m8.2.2.1.1.1.1">conditional</csymbol><ci id="A3.SS5.p1.8.m8.2.2.1.1.1.2.cmml" xref="A3.SS5.p1.8.m8.2.2.1.1.1.2">𝒚</ci><apply id="A3.SS5.p1.8.m8.2.2.1.1.1.3.cmml" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS5.p1.8.m8.2.2.1.1.1.3.1.cmml" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3">superscript</csymbol><apply id="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.cmml" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.1.cmml" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3">subscript</csymbol><apply id="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2.cmml" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2"><ci id="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2.1.cmml" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2.1">^</ci><ci id="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2.2.cmml" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.2.2">𝒙</ci></apply><cn id="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.3.cmml" type="integer" xref="A3.SS5.p1.8.m8.2.2.1.1.1.3.2.3">0</cn></apply><ci id="A3.SS5.p1.8.m8.1.1.1.1.cmml" xref="A3.SS5.p1.8.m8.1.1.1.1">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.8.m8.2c">\log p({\bm{y}}|\hat{{\bm{x}}}_{0}^{(j)})</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.8.m8.2d">roman_log italic_p ( bold_italic_y | over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT )</annotation></semantics></math>. For each step (i.e., frequency <math alttext="F=1" class="ltx_Math" display="inline" id="A3.SS5.p1.9.m9.1"><semantics id="A3.SS5.p1.9.m9.1a"><mrow id="A3.SS5.p1.9.m9.1.1" xref="A3.SS5.p1.9.m9.1.1.cmml"><mi id="A3.SS5.p1.9.m9.1.1.2" xref="A3.SS5.p1.9.m9.1.1.2.cmml">F</mi><mo id="A3.SS5.p1.9.m9.1.1.1" xref="A3.SS5.p1.9.m9.1.1.1.cmml">=</mo><mn id="A3.SS5.p1.9.m9.1.1.3" xref="A3.SS5.p1.9.m9.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.9.m9.1b"><apply id="A3.SS5.p1.9.m9.1.1.cmml" xref="A3.SS5.p1.9.m9.1.1"><eq id="A3.SS5.p1.9.m9.1.1.1.cmml" xref="A3.SS5.p1.9.m9.1.1.1"></eq><ci id="A3.SS5.p1.9.m9.1.1.2.cmml" xref="A3.SS5.p1.9.m9.1.1.2">𝐹</ci><cn id="A3.SS5.p1.9.m9.1.1.3.cmml" type="integer" xref="A3.SS5.p1.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.9.m9.1c">F=1</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.9.m9.1d">italic_F = 1</annotation></semantics></math>), we project this gradient using our pre-computed matrices and use this projected gradient for the update step. This process is repeated for each noise level, progressively refining our estimate of the clean image.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS5.p2">
<p class="ltx_p" id="A3.SS5.p2.1">For experiments, we use the official implementation of DAPS <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#bib.bib39" title="">2024</a>)</cite> with default configurations.</p>
</div>
<figure class="ltx_figure" id="A3.SS5.fig1">
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg4.2.1.1">Algorithm 4</span> </span> DiffStateGrad-DAPS for Image Restoration Tasks</figcaption>
<div class="ltx_listing ltx_listing" id="alg4.3">
<div class="ltx_listingline" id="alg4.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>Score model <math alttext="{\bm{s}}_{\theta}" class="ltx_Math" display="inline" id="alg4.l1.m1.1"><semantics id="alg4.l1.m1.1a"><msub id="alg4.l1.m1.1.1" xref="alg4.l1.m1.1.1.cmml"><mi id="alg4.l1.m1.1.1.2" xref="alg4.l1.m1.1.1.2.cmml">𝒔</mi><mi id="alg4.l1.m1.1.1.3" xref="alg4.l1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l1.m1.1b"><apply id="alg4.l1.m1.1.1.cmml" xref="alg4.l1.m1.1.1"><csymbol cd="ambiguous" id="alg4.l1.m1.1.1.1.cmml" xref="alg4.l1.m1.1.1">subscript</csymbol><ci id="alg4.l1.m1.1.1.2.cmml" xref="alg4.l1.m1.1.1.2">𝒔</ci><ci id="alg4.l1.m1.1.1.3.cmml" xref="alg4.l1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m1.1c">{\bm{s}}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m1.1d">bold_italic_s start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, measurement <math alttext="{\bm{y}}" class="ltx_Math" display="inline" id="alg4.l1.m2.1"><semantics id="alg4.l1.m2.1a"><mi id="alg4.l1.m2.1.1" xref="alg4.l1.m2.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m2.1b"><ci id="alg4.l1.m2.1.1.cmml" xref="alg4.l1.m2.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m2.1c">{\bm{y}}</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m2.1d">bold_italic_y</annotation></semantics></math>, noise schedule <math alttext="\sigma_{t}" class="ltx_Math" display="inline" id="alg4.l1.m3.1"><semantics id="alg4.l1.m3.1a"><msub id="alg4.l1.m3.1.1" xref="alg4.l1.m3.1.1.cmml"><mi id="alg4.l1.m3.1.1.2" xref="alg4.l1.m3.1.1.2.cmml">σ</mi><mi id="alg4.l1.m3.1.1.3" xref="alg4.l1.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l1.m3.1b"><apply id="alg4.l1.m3.1.1.cmml" xref="alg4.l1.m3.1.1"><csymbol cd="ambiguous" id="alg4.l1.m3.1.1.1.cmml" xref="alg4.l1.m3.1.1">subscript</csymbol><ci id="alg4.l1.m3.1.1.2.cmml" xref="alg4.l1.m3.1.1.2">𝜎</ci><ci id="alg4.l1.m3.1.1.3.cmml" xref="alg4.l1.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m3.1c">\sigma_{t}</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m3.1d">italic_σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\{t_{i}\}_{i\in\{0,\ldots,N_{A}\}}" class="ltx_Math" display="inline" id="alg4.l1.m4.4"><semantics id="alg4.l1.m4.4a"><msub id="alg4.l1.m4.4.4" xref="alg4.l1.m4.4.4.cmml"><mrow id="alg4.l1.m4.4.4.1.1" xref="alg4.l1.m4.4.4.1.2.cmml"><mo id="alg4.l1.m4.4.4.1.1.2" stretchy="false" xref="alg4.l1.m4.4.4.1.2.cmml">{</mo><msub id="alg4.l1.m4.4.4.1.1.1" xref="alg4.l1.m4.4.4.1.1.1.cmml"><mi id="alg4.l1.m4.4.4.1.1.1.2" xref="alg4.l1.m4.4.4.1.1.1.2.cmml">t</mi><mi id="alg4.l1.m4.4.4.1.1.1.3" xref="alg4.l1.m4.4.4.1.1.1.3.cmml">i</mi></msub><mo id="alg4.l1.m4.4.4.1.1.3" stretchy="false" xref="alg4.l1.m4.4.4.1.2.cmml">}</mo></mrow><mrow id="alg4.l1.m4.3.3.3" xref="alg4.l1.m4.3.3.3.cmml"><mi id="alg4.l1.m4.3.3.3.5" xref="alg4.l1.m4.3.3.3.5.cmml">i</mi><mo id="alg4.l1.m4.3.3.3.4" xref="alg4.l1.m4.3.3.3.4.cmml">∈</mo><mrow id="alg4.l1.m4.3.3.3.3.1" xref="alg4.l1.m4.3.3.3.3.2.cmml"><mo id="alg4.l1.m4.3.3.3.3.1.2" stretchy="false" xref="alg4.l1.m4.3.3.3.3.2.cmml">{</mo><mn id="alg4.l1.m4.1.1.1.1" xref="alg4.l1.m4.1.1.1.1.cmml">0</mn><mo id="alg4.l1.m4.3.3.3.3.1.3" xref="alg4.l1.m4.3.3.3.3.2.cmml">,</mo><mi id="alg4.l1.m4.2.2.2.2" mathvariant="normal" xref="alg4.l1.m4.2.2.2.2.cmml">…</mi><mo id="alg4.l1.m4.3.3.3.3.1.4" xref="alg4.l1.m4.3.3.3.3.2.cmml">,</mo><msub id="alg4.l1.m4.3.3.3.3.1.1" xref="alg4.l1.m4.3.3.3.3.1.1.cmml"><mi id="alg4.l1.m4.3.3.3.3.1.1.2" xref="alg4.l1.m4.3.3.3.3.1.1.2.cmml">N</mi><mi id="alg4.l1.m4.3.3.3.3.1.1.3" xref="alg4.l1.m4.3.3.3.3.1.1.3.cmml">A</mi></msub><mo id="alg4.l1.m4.3.3.3.3.1.5" stretchy="false" xref="alg4.l1.m4.3.3.3.3.2.cmml">}</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg4.l1.m4.4b"><apply id="alg4.l1.m4.4.4.cmml" xref="alg4.l1.m4.4.4"><csymbol cd="ambiguous" id="alg4.l1.m4.4.4.2.cmml" xref="alg4.l1.m4.4.4">subscript</csymbol><set id="alg4.l1.m4.4.4.1.2.cmml" xref="alg4.l1.m4.4.4.1.1"><apply id="alg4.l1.m4.4.4.1.1.1.cmml" xref="alg4.l1.m4.4.4.1.1.1"><csymbol cd="ambiguous" id="alg4.l1.m4.4.4.1.1.1.1.cmml" xref="alg4.l1.m4.4.4.1.1.1">subscript</csymbol><ci id="alg4.l1.m4.4.4.1.1.1.2.cmml" xref="alg4.l1.m4.4.4.1.1.1.2">𝑡</ci><ci id="alg4.l1.m4.4.4.1.1.1.3.cmml" xref="alg4.l1.m4.4.4.1.1.1.3">𝑖</ci></apply></set><apply id="alg4.l1.m4.3.3.3.cmml" xref="alg4.l1.m4.3.3.3"><in id="alg4.l1.m4.3.3.3.4.cmml" xref="alg4.l1.m4.3.3.3.4"></in><ci id="alg4.l1.m4.3.3.3.5.cmml" xref="alg4.l1.m4.3.3.3.5">𝑖</ci><set id="alg4.l1.m4.3.3.3.3.2.cmml" xref="alg4.l1.m4.3.3.3.3.1"><cn id="alg4.l1.m4.1.1.1.1.cmml" type="integer" xref="alg4.l1.m4.1.1.1.1">0</cn><ci id="alg4.l1.m4.2.2.2.2.cmml" xref="alg4.l1.m4.2.2.2.2">…</ci><apply id="alg4.l1.m4.3.3.3.3.1.1.cmml" xref="alg4.l1.m4.3.3.3.3.1.1"><csymbol cd="ambiguous" id="alg4.l1.m4.3.3.3.3.1.1.1.cmml" xref="alg4.l1.m4.3.3.3.3.1.1">subscript</csymbol><ci id="alg4.l1.m4.3.3.3.3.1.1.2.cmml" xref="alg4.l1.m4.3.3.3.3.1.1.2">𝑁</ci><ci id="alg4.l1.m4.3.3.3.3.1.1.3.cmml" xref="alg4.l1.m4.3.3.3.3.1.1.3">𝐴</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m4.4c">\{t_{i}\}_{i\in\{0,\ldots,N_{A}\}}</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m4.4d">{ italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i ∈ { 0 , … , italic_N start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT } end_POSTSUBSCRIPT</annotation></semantics></math>, <span class="ltx_text" id="alg4.l1.1" style="color:#0000FF;"> variance retention threshold <math alttext="\tau" class="ltx_Math" display="inline" id="alg4.l1.1.m1.1"><semantics id="alg4.l1.1.m1.1a"><mi id="alg4.l1.1.m1.1.1" mathcolor="#0000FF" xref="alg4.l1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.1.m1.1b"><ci id="alg4.l1.1.m1.1.1.cmml" xref="alg4.l1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.1.m1.1d">italic_τ</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg4.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>Sample <math alttext="{\bm{x}}_{T}\sim\mathcal{N}(\mathbf{0},\sigma_{T}^{2}\bm{I})" class="ltx_Math" display="inline" id="alg4.l2.m1.2"><semantics id="alg4.l2.m1.2a"><mrow id="alg4.l2.m1.2.2" xref="alg4.l2.m1.2.2.cmml"><msub id="alg4.l2.m1.2.2.3" xref="alg4.l2.m1.2.2.3.cmml"><mi id="alg4.l2.m1.2.2.3.2" xref="alg4.l2.m1.2.2.3.2.cmml">𝒙</mi><mi id="alg4.l2.m1.2.2.3.3" xref="alg4.l2.m1.2.2.3.3.cmml">T</mi></msub><mo id="alg4.l2.m1.2.2.2" xref="alg4.l2.m1.2.2.2.cmml">∼</mo><mrow id="alg4.l2.m1.2.2.1" xref="alg4.l2.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg4.l2.m1.2.2.1.3" xref="alg4.l2.m1.2.2.1.3.cmml">𝒩</mi><mo id="alg4.l2.m1.2.2.1.2" xref="alg4.l2.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg4.l2.m1.2.2.1.1.1" xref="alg4.l2.m1.2.2.1.1.2.cmml"><mo id="alg4.l2.m1.2.2.1.1.1.2" stretchy="false" xref="alg4.l2.m1.2.2.1.1.2.cmml">(</mo><mn id="alg4.l2.m1.1.1" xref="alg4.l2.m1.1.1.cmml">𝟎</mn><mo id="alg4.l2.m1.2.2.1.1.1.3" xref="alg4.l2.m1.2.2.1.1.2.cmml">,</mo><mrow id="alg4.l2.m1.2.2.1.1.1.1" xref="alg4.l2.m1.2.2.1.1.1.1.cmml"><msubsup id="alg4.l2.m1.2.2.1.1.1.1.2" xref="alg4.l2.m1.2.2.1.1.1.1.2.cmml"><mi id="alg4.l2.m1.2.2.1.1.1.1.2.2.2" xref="alg4.l2.m1.2.2.1.1.1.1.2.2.2.cmml">σ</mi><mi id="alg4.l2.m1.2.2.1.1.1.1.2.2.3" xref="alg4.l2.m1.2.2.1.1.1.1.2.2.3.cmml">T</mi><mn id="alg4.l2.m1.2.2.1.1.1.1.2.3" xref="alg4.l2.m1.2.2.1.1.1.1.2.3.cmml">2</mn></msubsup><mo id="alg4.l2.m1.2.2.1.1.1.1.1" xref="alg4.l2.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l2.m1.2.2.1.1.1.1.3" xref="alg4.l2.m1.2.2.1.1.1.1.3.cmml">𝑰</mi></mrow><mo id="alg4.l2.m1.2.2.1.1.1.4" stretchy="false" xref="alg4.l2.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l2.m1.2b"><apply id="alg4.l2.m1.2.2.cmml" xref="alg4.l2.m1.2.2"><csymbol cd="latexml" id="alg4.l2.m1.2.2.2.cmml" xref="alg4.l2.m1.2.2.2">similar-to</csymbol><apply id="alg4.l2.m1.2.2.3.cmml" xref="alg4.l2.m1.2.2.3"><csymbol cd="ambiguous" id="alg4.l2.m1.2.2.3.1.cmml" xref="alg4.l2.m1.2.2.3">subscript</csymbol><ci id="alg4.l2.m1.2.2.3.2.cmml" xref="alg4.l2.m1.2.2.3.2">𝒙</ci><ci id="alg4.l2.m1.2.2.3.3.cmml" xref="alg4.l2.m1.2.2.3.3">𝑇</ci></apply><apply id="alg4.l2.m1.2.2.1.cmml" xref="alg4.l2.m1.2.2.1"><times id="alg4.l2.m1.2.2.1.2.cmml" xref="alg4.l2.m1.2.2.1.2"></times><ci id="alg4.l2.m1.2.2.1.3.cmml" xref="alg4.l2.m1.2.2.1.3">𝒩</ci><interval closure="open" id="alg4.l2.m1.2.2.1.1.2.cmml" xref="alg4.l2.m1.2.2.1.1.1"><cn id="alg4.l2.m1.1.1.cmml" type="integer" xref="alg4.l2.m1.1.1">0</cn><apply id="alg4.l2.m1.2.2.1.1.1.1.cmml" xref="alg4.l2.m1.2.2.1.1.1.1"><times id="alg4.l2.m1.2.2.1.1.1.1.1.cmml" xref="alg4.l2.m1.2.2.1.1.1.1.1"></times><apply id="alg4.l2.m1.2.2.1.1.1.1.2.cmml" xref="alg4.l2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="alg4.l2.m1.2.2.1.1.1.1.2.1.cmml" xref="alg4.l2.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="alg4.l2.m1.2.2.1.1.1.1.2.2.cmml" xref="alg4.l2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="alg4.l2.m1.2.2.1.1.1.1.2.2.1.cmml" xref="alg4.l2.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="alg4.l2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="alg4.l2.m1.2.2.1.1.1.1.2.2.2">𝜎</ci><ci id="alg4.l2.m1.2.2.1.1.1.1.2.2.3.cmml" xref="alg4.l2.m1.2.2.1.1.1.1.2.2.3">𝑇</ci></apply><cn id="alg4.l2.m1.2.2.1.1.1.1.2.3.cmml" type="integer" xref="alg4.l2.m1.2.2.1.1.1.1.2.3">2</cn></apply><ci id="alg4.l2.m1.2.2.1.1.1.1.3.cmml" xref="alg4.l2.m1.2.2.1.1.1.1.3">𝑰</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l2.m1.2c">{\bm{x}}_{T}\sim\mathcal{N}(\mathbf{0},\sigma_{T}^{2}\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg4.l2.m1.2d">bold_italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∼ caligraphic_N ( bold_0 , italic_σ start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><span class="ltx_text ltx_font_bold" id="alg4.l3.1">for</span> <math alttext="i=N_{A},N_{A}-1,\ldots,1" class="ltx_Math" display="inline" id="alg4.l3.m1.4"><semantics id="alg4.l3.m1.4a"><mrow id="alg4.l3.m1.4.4" xref="alg4.l3.m1.4.4.cmml"><mi id="alg4.l3.m1.4.4.4" xref="alg4.l3.m1.4.4.4.cmml">i</mi><mo id="alg4.l3.m1.4.4.3" xref="alg4.l3.m1.4.4.3.cmml">=</mo><mrow id="alg4.l3.m1.4.4.2.2" xref="alg4.l3.m1.4.4.2.3.cmml"><msub id="alg4.l3.m1.3.3.1.1.1" xref="alg4.l3.m1.3.3.1.1.1.cmml"><mi id="alg4.l3.m1.3.3.1.1.1.2" xref="alg4.l3.m1.3.3.1.1.1.2.cmml">N</mi><mi id="alg4.l3.m1.3.3.1.1.1.3" xref="alg4.l3.m1.3.3.1.1.1.3.cmml">A</mi></msub><mo id="alg4.l3.m1.4.4.2.2.3" xref="alg4.l3.m1.4.4.2.3.cmml">,</mo><mrow id="alg4.l3.m1.4.4.2.2.2" xref="alg4.l3.m1.4.4.2.2.2.cmml"><msub id="alg4.l3.m1.4.4.2.2.2.2" xref="alg4.l3.m1.4.4.2.2.2.2.cmml"><mi id="alg4.l3.m1.4.4.2.2.2.2.2" xref="alg4.l3.m1.4.4.2.2.2.2.2.cmml">N</mi><mi id="alg4.l3.m1.4.4.2.2.2.2.3" xref="alg4.l3.m1.4.4.2.2.2.2.3.cmml">A</mi></msub><mo id="alg4.l3.m1.4.4.2.2.2.1" xref="alg4.l3.m1.4.4.2.2.2.1.cmml">−</mo><mn id="alg4.l3.m1.4.4.2.2.2.3" xref="alg4.l3.m1.4.4.2.2.2.3.cmml">1</mn></mrow><mo id="alg4.l3.m1.4.4.2.2.4" xref="alg4.l3.m1.4.4.2.3.cmml">,</mo><mi id="alg4.l3.m1.1.1" mathvariant="normal" xref="alg4.l3.m1.1.1.cmml">…</mi><mo id="alg4.l3.m1.4.4.2.2.5" xref="alg4.l3.m1.4.4.2.3.cmml">,</mo><mn id="alg4.l3.m1.2.2" xref="alg4.l3.m1.2.2.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l3.m1.4b"><apply id="alg4.l3.m1.4.4.cmml" xref="alg4.l3.m1.4.4"><eq id="alg4.l3.m1.4.4.3.cmml" xref="alg4.l3.m1.4.4.3"></eq><ci id="alg4.l3.m1.4.4.4.cmml" xref="alg4.l3.m1.4.4.4">𝑖</ci><list id="alg4.l3.m1.4.4.2.3.cmml" xref="alg4.l3.m1.4.4.2.2"><apply id="alg4.l3.m1.3.3.1.1.1.cmml" xref="alg4.l3.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg4.l3.m1.3.3.1.1.1.1.cmml" xref="alg4.l3.m1.3.3.1.1.1">subscript</csymbol><ci id="alg4.l3.m1.3.3.1.1.1.2.cmml" xref="alg4.l3.m1.3.3.1.1.1.2">𝑁</ci><ci id="alg4.l3.m1.3.3.1.1.1.3.cmml" xref="alg4.l3.m1.3.3.1.1.1.3">𝐴</ci></apply><apply id="alg4.l3.m1.4.4.2.2.2.cmml" xref="alg4.l3.m1.4.4.2.2.2"><minus id="alg4.l3.m1.4.4.2.2.2.1.cmml" xref="alg4.l3.m1.4.4.2.2.2.1"></minus><apply id="alg4.l3.m1.4.4.2.2.2.2.cmml" xref="alg4.l3.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg4.l3.m1.4.4.2.2.2.2.1.cmml" xref="alg4.l3.m1.4.4.2.2.2.2">subscript</csymbol><ci id="alg4.l3.m1.4.4.2.2.2.2.2.cmml" xref="alg4.l3.m1.4.4.2.2.2.2.2">𝑁</ci><ci id="alg4.l3.m1.4.4.2.2.2.2.3.cmml" xref="alg4.l3.m1.4.4.2.2.2.2.3">𝐴</ci></apply><cn id="alg4.l3.m1.4.4.2.2.2.3.cmml" type="integer" xref="alg4.l3.m1.4.4.2.2.2.3">1</cn></apply><ci id="alg4.l3.m1.1.1.cmml" xref="alg4.l3.m1.1.1">…</ci><cn id="alg4.l3.m1.2.2.cmml" type="integer" xref="alg4.l3.m1.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m1.4c">i=N_{A},N_{A}-1,\ldots,1</annotation><annotation encoding="application/x-llamapun" id="alg4.l3.m1.4d">italic_i = italic_N start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_N start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT - 1 , … , 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg4.l3.2">do</span>
</div>
<div class="ltx_listingline" id="alg4.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>     Compute <math alttext="\hat{{\bm{x}}}_{0}^{(0)}=\hat{{\bm{x}}}_{0}({\bm{x}}_{t_{i}})" class="ltx_Math" display="inline" id="alg4.l4.m1.2"><semantics id="alg4.l4.m1.2a"><mrow id="alg4.l4.m1.2.2" xref="alg4.l4.m1.2.2.cmml"><msubsup id="alg4.l4.m1.2.2.3" xref="alg4.l4.m1.2.2.3.cmml"><mover accent="true" id="alg4.l4.m1.2.2.3.2.2" xref="alg4.l4.m1.2.2.3.2.2.cmml"><mi id="alg4.l4.m1.2.2.3.2.2.2" xref="alg4.l4.m1.2.2.3.2.2.2.cmml">𝒙</mi><mo id="alg4.l4.m1.2.2.3.2.2.1" xref="alg4.l4.m1.2.2.3.2.2.1.cmml">^</mo></mover><mn id="alg4.l4.m1.2.2.3.2.3" xref="alg4.l4.m1.2.2.3.2.3.cmml">0</mn><mrow id="alg4.l4.m1.1.1.1.3" xref="alg4.l4.m1.2.2.3.cmml"><mo id="alg4.l4.m1.1.1.1.3.1" stretchy="false" xref="alg4.l4.m1.2.2.3.cmml">(</mo><mn id="alg4.l4.m1.1.1.1.1" xref="alg4.l4.m1.1.1.1.1.cmml">0</mn><mo id="alg4.l4.m1.1.1.1.3.2" stretchy="false" xref="alg4.l4.m1.2.2.3.cmml">)</mo></mrow></msubsup><mo id="alg4.l4.m1.2.2.2" xref="alg4.l4.m1.2.2.2.cmml">=</mo><mrow id="alg4.l4.m1.2.2.1" xref="alg4.l4.m1.2.2.1.cmml"><msub id="alg4.l4.m1.2.2.1.3" xref="alg4.l4.m1.2.2.1.3.cmml"><mover accent="true" id="alg4.l4.m1.2.2.1.3.2" xref="alg4.l4.m1.2.2.1.3.2.cmml"><mi id="alg4.l4.m1.2.2.1.3.2.2" xref="alg4.l4.m1.2.2.1.3.2.2.cmml">𝒙</mi><mo id="alg4.l4.m1.2.2.1.3.2.1" xref="alg4.l4.m1.2.2.1.3.2.1.cmml">^</mo></mover><mn id="alg4.l4.m1.2.2.1.3.3" xref="alg4.l4.m1.2.2.1.3.3.cmml">0</mn></msub><mo id="alg4.l4.m1.2.2.1.2" xref="alg4.l4.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg4.l4.m1.2.2.1.1.1" xref="alg4.l4.m1.2.2.1.1.1.1.cmml"><mo id="alg4.l4.m1.2.2.1.1.1.2" stretchy="false" xref="alg4.l4.m1.2.2.1.1.1.1.cmml">(</mo><msub id="alg4.l4.m1.2.2.1.1.1.1" xref="alg4.l4.m1.2.2.1.1.1.1.cmml"><mi id="alg4.l4.m1.2.2.1.1.1.1.2" xref="alg4.l4.m1.2.2.1.1.1.1.2.cmml">𝒙</mi><msub id="alg4.l4.m1.2.2.1.1.1.1.3" xref="alg4.l4.m1.2.2.1.1.1.1.3.cmml"><mi id="alg4.l4.m1.2.2.1.1.1.1.3.2" xref="alg4.l4.m1.2.2.1.1.1.1.3.2.cmml">t</mi><mi id="alg4.l4.m1.2.2.1.1.1.1.3.3" xref="alg4.l4.m1.2.2.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="alg4.l4.m1.2.2.1.1.1.3" stretchy="false" xref="alg4.l4.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l4.m1.2b"><apply id="alg4.l4.m1.2.2.cmml" xref="alg4.l4.m1.2.2"><eq id="alg4.l4.m1.2.2.2.cmml" xref="alg4.l4.m1.2.2.2"></eq><apply id="alg4.l4.m1.2.2.3.cmml" xref="alg4.l4.m1.2.2.3"><csymbol cd="ambiguous" id="alg4.l4.m1.2.2.3.1.cmml" xref="alg4.l4.m1.2.2.3">superscript</csymbol><apply id="alg4.l4.m1.2.2.3.2.cmml" xref="alg4.l4.m1.2.2.3"><csymbol cd="ambiguous" id="alg4.l4.m1.2.2.3.2.1.cmml" xref="alg4.l4.m1.2.2.3">subscript</csymbol><apply id="alg4.l4.m1.2.2.3.2.2.cmml" xref="alg4.l4.m1.2.2.3.2.2"><ci id="alg4.l4.m1.2.2.3.2.2.1.cmml" xref="alg4.l4.m1.2.2.3.2.2.1">^</ci><ci id="alg4.l4.m1.2.2.3.2.2.2.cmml" xref="alg4.l4.m1.2.2.3.2.2.2">𝒙</ci></apply><cn id="alg4.l4.m1.2.2.3.2.3.cmml" type="integer" xref="alg4.l4.m1.2.2.3.2.3">0</cn></apply><cn id="alg4.l4.m1.1.1.1.1.cmml" type="integer" xref="alg4.l4.m1.1.1.1.1">0</cn></apply><apply id="alg4.l4.m1.2.2.1.cmml" xref="alg4.l4.m1.2.2.1"><times id="alg4.l4.m1.2.2.1.2.cmml" xref="alg4.l4.m1.2.2.1.2"></times><apply id="alg4.l4.m1.2.2.1.3.cmml" xref="alg4.l4.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg4.l4.m1.2.2.1.3.1.cmml" xref="alg4.l4.m1.2.2.1.3">subscript</csymbol><apply id="alg4.l4.m1.2.2.1.3.2.cmml" xref="alg4.l4.m1.2.2.1.3.2"><ci id="alg4.l4.m1.2.2.1.3.2.1.cmml" xref="alg4.l4.m1.2.2.1.3.2.1">^</ci><ci id="alg4.l4.m1.2.2.1.3.2.2.cmml" xref="alg4.l4.m1.2.2.1.3.2.2">𝒙</ci></apply><cn id="alg4.l4.m1.2.2.1.3.3.cmml" type="integer" xref="alg4.l4.m1.2.2.1.3.3">0</cn></apply><apply id="alg4.l4.m1.2.2.1.1.1.1.cmml" xref="alg4.l4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg4.l4.m1.2.2.1.1.1.1.1.cmml" xref="alg4.l4.m1.2.2.1.1.1">subscript</csymbol><ci id="alg4.l4.m1.2.2.1.1.1.1.2.cmml" xref="alg4.l4.m1.2.2.1.1.1.1.2">𝒙</ci><apply id="alg4.l4.m1.2.2.1.1.1.1.3.cmml" xref="alg4.l4.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="alg4.l4.m1.2.2.1.1.1.1.3.1.cmml" xref="alg4.l4.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="alg4.l4.m1.2.2.1.1.1.1.3.2.cmml" xref="alg4.l4.m1.2.2.1.1.1.1.3.2">𝑡</ci><ci id="alg4.l4.m1.2.2.1.1.1.1.3.3.cmml" xref="alg4.l4.m1.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l4.m1.2c">\hat{{\bm{x}}}_{0}^{(0)}=\hat{{\bm{x}}}_{0}({\bm{x}}_{t_{i}})</annotation><annotation encoding="application/x-llamapun" id="alg4.l4.m1.2d">over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT = over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> by solving the probability flow ODE in Eq. (39) with <math alttext="{\bm{s}}_{\theta}" class="ltx_Math" display="inline" id="alg4.l4.m2.1"><semantics id="alg4.l4.m2.1a"><msub id="alg4.l4.m2.1.1" xref="alg4.l4.m2.1.1.cmml"><mi id="alg4.l4.m2.1.1.2" xref="alg4.l4.m2.1.1.2.cmml">𝒔</mi><mi id="alg4.l4.m2.1.1.3" xref="alg4.l4.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l4.m2.1b"><apply id="alg4.l4.m2.1.1.cmml" xref="alg4.l4.m2.1.1"><csymbol cd="ambiguous" id="alg4.l4.m2.1.1.1.cmml" xref="alg4.l4.m2.1.1">subscript</csymbol><ci id="alg4.l4.m2.1.1.2.cmml" xref="alg4.l4.m2.1.1.2">𝒔</ci><ci id="alg4.l4.m2.1.1.3.cmml" xref="alg4.l4.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l4.m2.1c">{\bm{s}}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg4.l4.m2.1d">bold_italic_s start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <span class="ltx_text" id="alg4.l5.1" style="color:#0000FF;"> <math alttext="\bm{U},\bm{S},\bm{V}\leftarrow\text{SVD}(\hat{\bm{X}}_{0}^{(0)})" class="ltx_Math" display="inline" id="alg4.l5.1.m1.5"><semantics id="alg4.l5.1.m1.5a"><mrow id="alg4.l5.1.m1.5.5" xref="alg4.l5.1.m1.5.5.cmml"><mrow id="alg4.l5.1.m1.5.5.3.2" xref="alg4.l5.1.m1.5.5.3.1.cmml"><mi id="alg4.l5.1.m1.2.2" mathcolor="#0000FF" xref="alg4.l5.1.m1.2.2.cmml">𝑼</mi><mo id="alg4.l5.1.m1.5.5.3.2.1" mathcolor="#0000FF" xref="alg4.l5.1.m1.5.5.3.1.cmml">,</mo><mi id="alg4.l5.1.m1.3.3" mathcolor="#0000FF" xref="alg4.l5.1.m1.3.3.cmml">𝑺</mi><mo id="alg4.l5.1.m1.5.5.3.2.2" mathcolor="#0000FF" xref="alg4.l5.1.m1.5.5.3.1.cmml">,</mo><mi id="alg4.l5.1.m1.4.4" mathcolor="#0000FF" xref="alg4.l5.1.m1.4.4.cmml">𝑽</mi></mrow><mo id="alg4.l5.1.m1.5.5.2" mathcolor="#0000FF" stretchy="false" xref="alg4.l5.1.m1.5.5.2.cmml">←</mo><mrow id="alg4.l5.1.m1.5.5.1" xref="alg4.l5.1.m1.5.5.1.cmml"><mtext id="alg4.l5.1.m1.5.5.1.3" mathcolor="#0000FF" xref="alg4.l5.1.m1.5.5.1.3a.cmml">SVD</mtext><mo id="alg4.l5.1.m1.5.5.1.2" xref="alg4.l5.1.m1.5.5.1.2.cmml">⁢</mo><mrow id="alg4.l5.1.m1.5.5.1.1.1" xref="alg4.l5.1.m1.5.5.1.1.1.1.cmml"><mo id="alg4.l5.1.m1.5.5.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg4.l5.1.m1.5.5.1.1.1.1.cmml">(</mo><msubsup id="alg4.l5.1.m1.5.5.1.1.1.1" xref="alg4.l5.1.m1.5.5.1.1.1.1.cmml"><mover accent="true" id="alg4.l5.1.m1.5.5.1.1.1.1.2.2" xref="alg4.l5.1.m1.5.5.1.1.1.1.2.2.cmml"><mi id="alg4.l5.1.m1.5.5.1.1.1.1.2.2.2" mathcolor="#0000FF" xref="alg4.l5.1.m1.5.5.1.1.1.1.2.2.2.cmml">𝑿</mi><mo id="alg4.l5.1.m1.5.5.1.1.1.1.2.2.1" mathcolor="#0000FF" xref="alg4.l5.1.m1.5.5.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="alg4.l5.1.m1.5.5.1.1.1.1.2.3" mathcolor="#0000FF" xref="alg4.l5.1.m1.5.5.1.1.1.1.2.3.cmml">0</mn><mrow id="alg4.l5.1.m1.1.1.1.3" xref="alg4.l5.1.m1.5.5.1.1.1.1.cmml"><mo id="alg4.l5.1.m1.1.1.1.3.1" mathcolor="#0000FF" stretchy="false" xref="alg4.l5.1.m1.5.5.1.1.1.1.cmml">(</mo><mn id="alg4.l5.1.m1.1.1.1.1" mathcolor="#0000FF" xref="alg4.l5.1.m1.1.1.1.1.cmml">0</mn><mo id="alg4.l5.1.m1.1.1.1.3.2" mathcolor="#0000FF" stretchy="false" xref="alg4.l5.1.m1.5.5.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg4.l5.1.m1.5.5.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg4.l5.1.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l5.1.m1.5b"><apply id="alg4.l5.1.m1.5.5.cmml" xref="alg4.l5.1.m1.5.5"><ci id="alg4.l5.1.m1.5.5.2.cmml" xref="alg4.l5.1.m1.5.5.2">←</ci><list id="alg4.l5.1.m1.5.5.3.1.cmml" xref="alg4.l5.1.m1.5.5.3.2"><ci id="alg4.l5.1.m1.2.2.cmml" xref="alg4.l5.1.m1.2.2">𝑼</ci><ci id="alg4.l5.1.m1.3.3.cmml" xref="alg4.l5.1.m1.3.3">𝑺</ci><ci id="alg4.l5.1.m1.4.4.cmml" xref="alg4.l5.1.m1.4.4">𝑽</ci></list><apply id="alg4.l5.1.m1.5.5.1.cmml" xref="alg4.l5.1.m1.5.5.1"><times id="alg4.l5.1.m1.5.5.1.2.cmml" xref="alg4.l5.1.m1.5.5.1.2"></times><ci id="alg4.l5.1.m1.5.5.1.3a.cmml" xref="alg4.l5.1.m1.5.5.1.3"><mtext id="alg4.l5.1.m1.5.5.1.3.cmml" mathcolor="#0000FF" xref="alg4.l5.1.m1.5.5.1.3">SVD</mtext></ci><apply id="alg4.l5.1.m1.5.5.1.1.1.1.cmml" xref="alg4.l5.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg4.l5.1.m1.5.5.1.1.1.1.1.cmml" xref="alg4.l5.1.m1.5.5.1.1.1">superscript</csymbol><apply id="alg4.l5.1.m1.5.5.1.1.1.1.2.cmml" xref="alg4.l5.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg4.l5.1.m1.5.5.1.1.1.1.2.1.cmml" xref="alg4.l5.1.m1.5.5.1.1.1">subscript</csymbol><apply id="alg4.l5.1.m1.5.5.1.1.1.1.2.2.cmml" xref="alg4.l5.1.m1.5.5.1.1.1.1.2.2"><ci id="alg4.l5.1.m1.5.5.1.1.1.1.2.2.1.cmml" xref="alg4.l5.1.m1.5.5.1.1.1.1.2.2.1">^</ci><ci id="alg4.l5.1.m1.5.5.1.1.1.1.2.2.2.cmml" xref="alg4.l5.1.m1.5.5.1.1.1.1.2.2.2">𝑿</ci></apply><cn id="alg4.l5.1.m1.5.5.1.1.1.1.2.3.cmml" type="integer" xref="alg4.l5.1.m1.5.5.1.1.1.1.2.3">0</cn></apply><cn id="alg4.l5.1.m1.1.1.1.1.cmml" type="integer" xref="alg4.l5.1.m1.1.1.1.1">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l5.1.m1.5c">\bm{U},\bm{S},\bm{V}\leftarrow\text{SVD}(\hat{\bm{X}}_{0}^{(0)})</annotation><annotation encoding="application/x-llamapun" id="alg4.l5.1.m1.5d">bold_italic_U , bold_italic_S , bold_italic_V ← SVD ( over^ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT )</annotation></semantics></math></span> <span class="ltx_text" id="alg4.l5.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l5.2.m1.1"><semantics id="alg4.l5.2.m1.1a"><mo id="alg4.l5.2.m1.1.1" xref="alg4.l5.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l5.2.m1.1b"><ci id="alg4.l5.2.m1.1.1.cmml" xref="alg4.l5.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l5.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l5.2.m1.1d">▷</annotation></semantics></math> <span class="ltx_text" id="alg4.l5.2.1" style="color:#0000FF;"> Perform SVD on initial estimate</span>
</span>
</div>
<div class="ltx_listingline" id="alg4.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <span class="ltx_text" id="alg4.l6.3" style="color:#0000FF;"> <math alttext="\lambda_{j}\leftarrow s_{j}^{2}" class="ltx_Math" display="inline" id="alg4.l6.1.m1.1"><semantics id="alg4.l6.1.m1.1a"><mrow id="alg4.l6.1.m1.1.1" xref="alg4.l6.1.m1.1.1.cmml"><msub id="alg4.l6.1.m1.1.1.2" xref="alg4.l6.1.m1.1.1.2.cmml"><mi id="alg4.l6.1.m1.1.1.2.2" mathcolor="#0000FF" xref="alg4.l6.1.m1.1.1.2.2.cmml">λ</mi><mi id="alg4.l6.1.m1.1.1.2.3" mathcolor="#0000FF" xref="alg4.l6.1.m1.1.1.2.3.cmml">j</mi></msub><mo id="alg4.l6.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg4.l6.1.m1.1.1.1.cmml">←</mo><msubsup id="alg4.l6.1.m1.1.1.3" xref="alg4.l6.1.m1.1.1.3.cmml"><mi id="alg4.l6.1.m1.1.1.3.2.2" mathcolor="#0000FF" xref="alg4.l6.1.m1.1.1.3.2.2.cmml">s</mi><mi id="alg4.l6.1.m1.1.1.3.2.3" mathcolor="#0000FF" xref="alg4.l6.1.m1.1.1.3.2.3.cmml">j</mi><mn id="alg4.l6.1.m1.1.1.3.3" mathcolor="#0000FF" xref="alg4.l6.1.m1.1.1.3.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg4.l6.1.m1.1b"><apply id="alg4.l6.1.m1.1.1.cmml" xref="alg4.l6.1.m1.1.1"><ci id="alg4.l6.1.m1.1.1.1.cmml" xref="alg4.l6.1.m1.1.1.1">←</ci><apply id="alg4.l6.1.m1.1.1.2.cmml" xref="alg4.l6.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg4.l6.1.m1.1.1.2.1.cmml" xref="alg4.l6.1.m1.1.1.2">subscript</csymbol><ci id="alg4.l6.1.m1.1.1.2.2.cmml" xref="alg4.l6.1.m1.1.1.2.2">𝜆</ci><ci id="alg4.l6.1.m1.1.1.2.3.cmml" xref="alg4.l6.1.m1.1.1.2.3">𝑗</ci></apply><apply id="alg4.l6.1.m1.1.1.3.cmml" xref="alg4.l6.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg4.l6.1.m1.1.1.3.1.cmml" xref="alg4.l6.1.m1.1.1.3">superscript</csymbol><apply id="alg4.l6.1.m1.1.1.3.2.cmml" xref="alg4.l6.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg4.l6.1.m1.1.1.3.2.1.cmml" xref="alg4.l6.1.m1.1.1.3">subscript</csymbol><ci id="alg4.l6.1.m1.1.1.3.2.2.cmml" xref="alg4.l6.1.m1.1.1.3.2.2">𝑠</ci><ci id="alg4.l6.1.m1.1.1.3.2.3.cmml" xref="alg4.l6.1.m1.1.1.3.2.3">𝑗</ci></apply><cn id="alg4.l6.1.m1.1.1.3.3.cmml" type="integer" xref="alg4.l6.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.1.m1.1c">\lambda_{j}\leftarrow s_{j}^{2}</annotation><annotation encoding="application/x-llamapun" id="alg4.l6.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ← italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> (where <math alttext="s_{j}" class="ltx_Math" display="inline" id="alg4.l6.2.m2.1"><semantics id="alg4.l6.2.m2.1a"><msub id="alg4.l6.2.m2.1.1" xref="alg4.l6.2.m2.1.1.cmml"><mi id="alg4.l6.2.m2.1.1.2" mathcolor="#0000FF" xref="alg4.l6.2.m2.1.1.2.cmml">s</mi><mi id="alg4.l6.2.m2.1.1.3" mathcolor="#0000FF" xref="alg4.l6.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l6.2.m2.1b"><apply id="alg4.l6.2.m2.1.1.cmml" xref="alg4.l6.2.m2.1.1"><csymbol cd="ambiguous" id="alg4.l6.2.m2.1.1.1.cmml" xref="alg4.l6.2.m2.1.1">subscript</csymbol><ci id="alg4.l6.2.m2.1.1.2.cmml" xref="alg4.l6.2.m2.1.1.2">𝑠</ci><ci id="alg4.l6.2.m2.1.1.3.cmml" xref="alg4.l6.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.2.m2.1c">s_{j}</annotation><annotation encoding="application/x-llamapun" id="alg4.l6.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are the singular values of <math alttext="\bm{S}" class="ltx_Math" display="inline" id="alg4.l6.3.m3.1"><semantics id="alg4.l6.3.m3.1a"><mi id="alg4.l6.3.m3.1.1" mathcolor="#0000FF" xref="alg4.l6.3.m3.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="alg4.l6.3.m3.1b"><ci id="alg4.l6.3.m3.1.1.cmml" xref="alg4.l6.3.m3.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.3.m3.1c">\bm{S}</annotation><annotation encoding="application/x-llamapun" id="alg4.l6.3.m3.1d">bold_italic_S</annotation></semantics></math>)</span> <span class="ltx_text" id="alg4.l6.4" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l6.4.m1.1"><semantics id="alg4.l6.4.m1.1a"><mo id="alg4.l6.4.m1.1.1" xref="alg4.l6.4.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l6.4.m1.1b"><ci id="alg4.l6.4.m1.1.1.cmml" xref="alg4.l6.4.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.4.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l6.4.m1.1d">▷</annotation></semantics></math> <span class="ltx_text" id="alg4.l6.4.1" style="color:#0000FF;"> Calculate eigenvalues</span>
</span>
</div>
<div class="ltx_listingline" id="alg4.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span class="ltx_text" id="alg4.l7.1" style="color:#0000FF;"> <math alttext="c_{k}\leftarrow\frac{\sum_{j=1}^{k}\lambda_{j}}{\sum_{j}\lambda_{j}}" class="ltx_Math" display="inline" id="alg4.l7.1.m1.1"><semantics id="alg4.l7.1.m1.1a"><mrow id="alg4.l7.1.m1.1.1" xref="alg4.l7.1.m1.1.1.cmml"><msub id="alg4.l7.1.m1.1.1.2" xref="alg4.l7.1.m1.1.1.2.cmml"><mi id="alg4.l7.1.m1.1.1.2.2" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.2.2.cmml">c</mi><mi id="alg4.l7.1.m1.1.1.2.3" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg4.l7.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg4.l7.1.m1.1.1.1.cmml">←</mo><mfrac id="alg4.l7.1.m1.1.1.3" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.cmml"><mrow id="alg4.l7.1.m1.1.1.3.2" xref="alg4.l7.1.m1.1.1.3.2.cmml"><mstyle displaystyle="false" id="alg4.l7.1.m1.1.1.3.2.1" xref="alg4.l7.1.m1.1.1.3.2.1.cmml"><msubsup id="alg4.l7.1.m1.1.1.3.2.1a" xref="alg4.l7.1.m1.1.1.3.2.1.cmml"><mo id="alg4.l7.1.m1.1.1.3.2.1.2.2" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="alg4.l7.1.m1.1.1.3.2.1.2.3" xref="alg4.l7.1.m1.1.1.3.2.1.2.3.cmml"><mi id="alg4.l7.1.m1.1.1.3.2.1.2.3.2" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.2.1.2.3.2.cmml">j</mi><mo id="alg4.l7.1.m1.1.1.3.2.1.2.3.1" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="alg4.l7.1.m1.1.1.3.2.1.2.3.3" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="alg4.l7.1.m1.1.1.3.2.1.3" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.2.1.3.cmml">k</mi></msubsup></mstyle><msub id="alg4.l7.1.m1.1.1.3.2.2" xref="alg4.l7.1.m1.1.1.3.2.2.cmml"><mi id="alg4.l7.1.m1.1.1.3.2.2.2" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.2.2.2.cmml">λ</mi><mi id="alg4.l7.1.m1.1.1.3.2.2.3" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.2.2.3.cmml">j</mi></msub></mrow><mrow id="alg4.l7.1.m1.1.1.3.3" xref="alg4.l7.1.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="alg4.l7.1.m1.1.1.3.3.1" xref="alg4.l7.1.m1.1.1.3.3.1.cmml"><msub id="alg4.l7.1.m1.1.1.3.3.1a" xref="alg4.l7.1.m1.1.1.3.3.1.cmml"><mo id="alg4.l7.1.m1.1.1.3.3.1.2" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.3.1.2.cmml">∑</mo><mi id="alg4.l7.1.m1.1.1.3.3.1.3" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.3.1.3.cmml">j</mi></msub></mstyle><msub id="alg4.l7.1.m1.1.1.3.3.2" xref="alg4.l7.1.m1.1.1.3.3.2.cmml"><mi id="alg4.l7.1.m1.1.1.3.3.2.2" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.3.2.2.cmml">λ</mi><mi id="alg4.l7.1.m1.1.1.3.3.2.3" mathcolor="#0000FF" xref="alg4.l7.1.m1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg4.l7.1.m1.1b"><apply id="alg4.l7.1.m1.1.1.cmml" xref="alg4.l7.1.m1.1.1"><ci id="alg4.l7.1.m1.1.1.1.cmml" xref="alg4.l7.1.m1.1.1.1">←</ci><apply id="alg4.l7.1.m1.1.1.2.cmml" xref="alg4.l7.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg4.l7.1.m1.1.1.2.1.cmml" xref="alg4.l7.1.m1.1.1.2">subscript</csymbol><ci id="alg4.l7.1.m1.1.1.2.2.cmml" xref="alg4.l7.1.m1.1.1.2.2">𝑐</ci><ci id="alg4.l7.1.m1.1.1.2.3.cmml" xref="alg4.l7.1.m1.1.1.2.3">𝑘</ci></apply><apply id="alg4.l7.1.m1.1.1.3.cmml" xref="alg4.l7.1.m1.1.1.3"><divide id="alg4.l7.1.m1.1.1.3.1.cmml" xref="alg4.l7.1.m1.1.1.3"></divide><apply id="alg4.l7.1.m1.1.1.3.2.cmml" xref="alg4.l7.1.m1.1.1.3.2"><apply id="alg4.l7.1.m1.1.1.3.2.1.cmml" xref="alg4.l7.1.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg4.l7.1.m1.1.1.3.2.1.1.cmml" xref="alg4.l7.1.m1.1.1.3.2.1">superscript</csymbol><apply id="alg4.l7.1.m1.1.1.3.2.1.2.cmml" xref="alg4.l7.1.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg4.l7.1.m1.1.1.3.2.1.2.1.cmml" xref="alg4.l7.1.m1.1.1.3.2.1">subscript</csymbol><sum id="alg4.l7.1.m1.1.1.3.2.1.2.2.cmml" xref="alg4.l7.1.m1.1.1.3.2.1.2.2"></sum><apply id="alg4.l7.1.m1.1.1.3.2.1.2.3.cmml" xref="alg4.l7.1.m1.1.1.3.2.1.2.3"><eq id="alg4.l7.1.m1.1.1.3.2.1.2.3.1.cmml" xref="alg4.l7.1.m1.1.1.3.2.1.2.3.1"></eq><ci id="alg4.l7.1.m1.1.1.3.2.1.2.3.2.cmml" xref="alg4.l7.1.m1.1.1.3.2.1.2.3.2">𝑗</ci><cn id="alg4.l7.1.m1.1.1.3.2.1.2.3.3.cmml" type="integer" xref="alg4.l7.1.m1.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="alg4.l7.1.m1.1.1.3.2.1.3.cmml" xref="alg4.l7.1.m1.1.1.3.2.1.3">𝑘</ci></apply><apply id="alg4.l7.1.m1.1.1.3.2.2.cmml" xref="alg4.l7.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg4.l7.1.m1.1.1.3.2.2.1.cmml" xref="alg4.l7.1.m1.1.1.3.2.2">subscript</csymbol><ci id="alg4.l7.1.m1.1.1.3.2.2.2.cmml" xref="alg4.l7.1.m1.1.1.3.2.2.2">𝜆</ci><ci id="alg4.l7.1.m1.1.1.3.2.2.3.cmml" xref="alg4.l7.1.m1.1.1.3.2.2.3">𝑗</ci></apply></apply><apply id="alg4.l7.1.m1.1.1.3.3.cmml" xref="alg4.l7.1.m1.1.1.3.3"><apply id="alg4.l7.1.m1.1.1.3.3.1.cmml" xref="alg4.l7.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg4.l7.1.m1.1.1.3.3.1.1.cmml" xref="alg4.l7.1.m1.1.1.3.3.1">subscript</csymbol><sum id="alg4.l7.1.m1.1.1.3.3.1.2.cmml" xref="alg4.l7.1.m1.1.1.3.3.1.2"></sum><ci id="alg4.l7.1.m1.1.1.3.3.1.3.cmml" xref="alg4.l7.1.m1.1.1.3.3.1.3">𝑗</ci></apply><apply id="alg4.l7.1.m1.1.1.3.3.2.cmml" xref="alg4.l7.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg4.l7.1.m1.1.1.3.3.2.1.cmml" xref="alg4.l7.1.m1.1.1.3.3.2">subscript</csymbol><ci id="alg4.l7.1.m1.1.1.3.3.2.2.cmml" xref="alg4.l7.1.m1.1.1.3.3.2.2">𝜆</ci><ci id="alg4.l7.1.m1.1.1.3.3.2.3.cmml" xref="alg4.l7.1.m1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l7.1.m1.1c">c_{k}\leftarrow\frac{\sum_{j=1}^{k}\lambda_{j}}{\sum_{j}\lambda_{j}}</annotation><annotation encoding="application/x-llamapun" id="alg4.l7.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← divide start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></span> <span class="ltx_text" id="alg4.l7.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l7.2.m1.1"><semantics id="alg4.l7.2.m1.1a"><mo id="alg4.l7.2.m1.1.1" xref="alg4.l7.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l7.2.m1.1b"><ci id="alg4.l7.2.m1.1.1.cmml" xref="alg4.l7.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l7.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l7.2.m1.1d">▷</annotation></semantics></math> <span class="ltx_text" id="alg4.l7.2.1" style="color:#0000FF;"> Cumulative sum of eigenvalues</span>
</span>
</div>
<div class="ltx_listingline" id="alg4.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <span class="ltx_text" id="alg4.l8.1" style="color:#0000FF;"> <math alttext="r\leftarrow\underset{k}{\operatorname*{arg\,min}}\{c_{k}\geq\tau\}" class="ltx_Math" display="inline" id="alg4.l8.1.m1.1"><semantics id="alg4.l8.1.m1.1a"><mrow id="alg4.l8.1.m1.1.1" xref="alg4.l8.1.m1.1.1.cmml"><mi id="alg4.l8.1.m1.1.1.3" mathcolor="#0000FF" xref="alg4.l8.1.m1.1.1.3.cmml">r</mi><mo id="alg4.l8.1.m1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg4.l8.1.m1.1.1.2.cmml">←</mo><mrow id="alg4.l8.1.m1.1.1.1" xref="alg4.l8.1.m1.1.1.1.cmml"><munder accentunder="true" id="alg4.l8.1.m1.1.1.1.3" xref="alg4.l8.1.m1.1.1.1.3.cmml"><mrow id="alg4.l8.1.m1.1.1.1.3.2" xref="alg4.l8.1.m1.1.1.1.3.2.cmml"><mi id="alg4.l8.1.m1.1.1.1.3.2.2" mathcolor="#0000FF" xref="alg4.l8.1.m1.1.1.1.3.2.2.cmml">arg</mi><mo id="alg4.l8.1.m1.1.1.1.3.2.1" lspace="0.170em" xref="alg4.l8.1.m1.1.1.1.3.2.1.cmml">⁢</mo><mi id="alg4.l8.1.m1.1.1.1.3.2.3" mathcolor="#0000FF" xref="alg4.l8.1.m1.1.1.1.3.2.3.cmml">min</mi></mrow><mo id="alg4.l8.1.m1.1.1.1.3.1" mathcolor="#0000FF" xref="alg4.l8.1.m1.1.1.1.3.1.cmml">𝑘</mo></munder><mo id="alg4.l8.1.m1.1.1.1.2" xref="alg4.l8.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg4.l8.1.m1.1.1.1.1.1" xref="alg4.l8.1.m1.1.1.1.1.2.cmml"><mo id="alg4.l8.1.m1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg4.l8.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg4.l8.1.m1.1.1.1.1.1.1" xref="alg4.l8.1.m1.1.1.1.1.1.1.cmml"><msub id="alg4.l8.1.m1.1.1.1.1.1.1.2" xref="alg4.l8.1.m1.1.1.1.1.1.1.2.cmml"><mi id="alg4.l8.1.m1.1.1.1.1.1.1.2.2" mathcolor="#0000FF" xref="alg4.l8.1.m1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="alg4.l8.1.m1.1.1.1.1.1.1.2.3" mathcolor="#0000FF" xref="alg4.l8.1.m1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="alg4.l8.1.m1.1.1.1.1.1.1.1" mathcolor="#0000FF" xref="alg4.l8.1.m1.1.1.1.1.1.1.1.cmml">≥</mo><mi id="alg4.l8.1.m1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="alg4.l8.1.m1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="alg4.l8.1.m1.1.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg4.l8.1.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l8.1.m1.1b"><apply id="alg4.l8.1.m1.1.1.cmml" xref="alg4.l8.1.m1.1.1"><ci id="alg4.l8.1.m1.1.1.2.cmml" xref="alg4.l8.1.m1.1.1.2">←</ci><ci id="alg4.l8.1.m1.1.1.3.cmml" xref="alg4.l8.1.m1.1.1.3">𝑟</ci><apply id="alg4.l8.1.m1.1.1.1.cmml" xref="alg4.l8.1.m1.1.1.1"><times id="alg4.l8.1.m1.1.1.1.2.cmml" xref="alg4.l8.1.m1.1.1.1.2"></times><apply id="alg4.l8.1.m1.1.1.1.3.cmml" xref="alg4.l8.1.m1.1.1.1.3"><ci id="alg4.l8.1.m1.1.1.1.3.1.cmml" xref="alg4.l8.1.m1.1.1.1.3.1">𝑘</ci><apply id="alg4.l8.1.m1.1.1.1.3.2.cmml" xref="alg4.l8.1.m1.1.1.1.3.2"><times id="alg4.l8.1.m1.1.1.1.3.2.1.cmml" xref="alg4.l8.1.m1.1.1.1.3.2.1"></times><ci id="alg4.l8.1.m1.1.1.1.3.2.2.cmml" xref="alg4.l8.1.m1.1.1.1.3.2.2">arg</ci><ci id="alg4.l8.1.m1.1.1.1.3.2.3.cmml" xref="alg4.l8.1.m1.1.1.1.3.2.3">min</ci></apply></apply><set id="alg4.l8.1.m1.1.1.1.1.2.cmml" xref="alg4.l8.1.m1.1.1.1.1.1"><apply id="alg4.l8.1.m1.1.1.1.1.1.1.cmml" xref="alg4.l8.1.m1.1.1.1.1.1.1"><geq id="alg4.l8.1.m1.1.1.1.1.1.1.1.cmml" xref="alg4.l8.1.m1.1.1.1.1.1.1.1"></geq><apply id="alg4.l8.1.m1.1.1.1.1.1.1.2.cmml" xref="alg4.l8.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg4.l8.1.m1.1.1.1.1.1.1.2.1.cmml" xref="alg4.l8.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg4.l8.1.m1.1.1.1.1.1.1.2.2.cmml" xref="alg4.l8.1.m1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="alg4.l8.1.m1.1.1.1.1.1.1.2.3.cmml" xref="alg4.l8.1.m1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg4.l8.1.m1.1.1.1.1.1.1.3.cmml" xref="alg4.l8.1.m1.1.1.1.1.1.1.3">𝜏</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l8.1.m1.1c">r\leftarrow\underset{k}{\operatorname*{arg\,min}}\{c_{k}\geq\tau\}</annotation><annotation encoding="application/x-llamapun" id="alg4.l8.1.m1.1d">italic_r ← underitalic_k start_ARG roman_arg roman_min end_ARG { italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ≥ italic_τ }</annotation></semantics></math></span> <span class="ltx_text" id="alg4.l8.4" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l8.2.m1.1"><semantics id="alg4.l8.2.m1.1a"><mo id="alg4.l8.2.m1.1.1" xref="alg4.l8.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l8.2.m1.1b"><ci id="alg4.l8.2.m1.1.1.cmml" xref="alg4.l8.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l8.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l8.2.m1.1d">▷</annotation></semantics></math> <span class="ltx_text" id="alg4.l8.4.2" style="color:#0000FF;"> Determine rank <math alttext="r" class="ltx_Math" display="inline" id="alg4.l8.3.1.m1.1"><semantics id="alg4.l8.3.1.m1.1a"><mi id="alg4.l8.3.1.m1.1.1" mathcolor="#0000FF" xref="alg4.l8.3.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg4.l8.3.1.m1.1b"><ci id="alg4.l8.3.1.m1.1.1.cmml" xref="alg4.l8.3.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l8.3.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg4.l8.3.1.m1.1d">italic_r</annotation></semantics></math> based on threshold <math alttext="\tau" class="ltx_Math" display="inline" id="alg4.l8.4.2.m2.1"><semantics id="alg4.l8.4.2.m2.1a"><mi id="alg4.l8.4.2.m2.1.1" mathcolor="#0000FF" xref="alg4.l8.4.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg4.l8.4.2.m2.1b"><ci id="alg4.l8.4.2.m2.1.1.cmml" xref="alg4.l8.4.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l8.4.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg4.l8.4.2.m2.1d">italic_τ</annotation></semantics></math></span>
</span>
</div>
<div class="ltx_listingline" id="alg4.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <span class="ltx_text" id="alg4.l9.1" style="color:#0000FF;"> <math alttext="\bm{A}\leftarrow\bm{U}_{r}" class="ltx_Math" display="inline" id="alg4.l9.1.m1.1"><semantics id="alg4.l9.1.m1.1a"><mrow id="alg4.l9.1.m1.1.1" xref="alg4.l9.1.m1.1.1.cmml"><mi id="alg4.l9.1.m1.1.1.2" mathcolor="#0000FF" xref="alg4.l9.1.m1.1.1.2.cmml">𝑨</mi><mo id="alg4.l9.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg4.l9.1.m1.1.1.1.cmml">←</mo><msub id="alg4.l9.1.m1.1.1.3" xref="alg4.l9.1.m1.1.1.3.cmml"><mi id="alg4.l9.1.m1.1.1.3.2" mathcolor="#0000FF" xref="alg4.l9.1.m1.1.1.3.2.cmml">𝑼</mi><mi id="alg4.l9.1.m1.1.1.3.3" mathcolor="#0000FF" xref="alg4.l9.1.m1.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg4.l9.1.m1.1b"><apply id="alg4.l9.1.m1.1.1.cmml" xref="alg4.l9.1.m1.1.1"><ci id="alg4.l9.1.m1.1.1.1.cmml" xref="alg4.l9.1.m1.1.1.1">←</ci><ci id="alg4.l9.1.m1.1.1.2.cmml" xref="alg4.l9.1.m1.1.1.2">𝑨</ci><apply id="alg4.l9.1.m1.1.1.3.cmml" xref="alg4.l9.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg4.l9.1.m1.1.1.3.1.cmml" xref="alg4.l9.1.m1.1.1.3">subscript</csymbol><ci id="alg4.l9.1.m1.1.1.3.2.cmml" xref="alg4.l9.1.m1.1.1.3.2">𝑼</ci><ci id="alg4.l9.1.m1.1.1.3.3.cmml" xref="alg4.l9.1.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l9.1.m1.1c">\bm{A}\leftarrow\bm{U}_{r}</annotation><annotation encoding="application/x-llamapun" id="alg4.l9.1.m1.1d">bold_italic_A ← bold_italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></span> <span class="ltx_text" id="alg4.l9.3" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l9.2.m1.1"><semantics id="alg4.l9.2.m1.1a"><mo id="alg4.l9.2.m1.1.1" xref="alg4.l9.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l9.2.m1.1b"><ci id="alg4.l9.2.m1.1.1.cmml" xref="alg4.l9.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l9.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l9.2.m1.1d">▷</annotation></semantics></math> <span class="ltx_text" id="alg4.l9.3.1" style="color:#0000FF;"> Get first <math alttext="r" class="ltx_Math" display="inline" id="alg4.l9.3.1.m1.1"><semantics id="alg4.l9.3.1.m1.1a"><mi id="alg4.l9.3.1.m1.1.1" mathcolor="#0000FF" xref="alg4.l9.3.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg4.l9.3.1.m1.1b"><ci id="alg4.l9.3.1.m1.1.1.cmml" xref="alg4.l9.3.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l9.3.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg4.l9.3.1.m1.1d">italic_r</annotation></semantics></math> left singular vectors</span>
</span>
</div>
<div class="ltx_listingline" id="alg4.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <span class="ltx_text" id="alg4.l10.1" style="color:#0000FF;"> <math alttext="\bm{B}\leftarrow\bm{V}_{r}" class="ltx_Math" display="inline" id="alg4.l10.1.m1.1"><semantics id="alg4.l10.1.m1.1a"><mrow id="alg4.l10.1.m1.1.1" xref="alg4.l10.1.m1.1.1.cmml"><mi id="alg4.l10.1.m1.1.1.2" mathcolor="#0000FF" xref="alg4.l10.1.m1.1.1.2.cmml">𝑩</mi><mo id="alg4.l10.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg4.l10.1.m1.1.1.1.cmml">←</mo><msub id="alg4.l10.1.m1.1.1.3" xref="alg4.l10.1.m1.1.1.3.cmml"><mi id="alg4.l10.1.m1.1.1.3.2" mathcolor="#0000FF" xref="alg4.l10.1.m1.1.1.3.2.cmml">𝑽</mi><mi id="alg4.l10.1.m1.1.1.3.3" mathcolor="#0000FF" xref="alg4.l10.1.m1.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg4.l10.1.m1.1b"><apply id="alg4.l10.1.m1.1.1.cmml" xref="alg4.l10.1.m1.1.1"><ci id="alg4.l10.1.m1.1.1.1.cmml" xref="alg4.l10.1.m1.1.1.1">←</ci><ci id="alg4.l10.1.m1.1.1.2.cmml" xref="alg4.l10.1.m1.1.1.2">𝑩</ci><apply id="alg4.l10.1.m1.1.1.3.cmml" xref="alg4.l10.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg4.l10.1.m1.1.1.3.1.cmml" xref="alg4.l10.1.m1.1.1.3">subscript</csymbol><ci id="alg4.l10.1.m1.1.1.3.2.cmml" xref="alg4.l10.1.m1.1.1.3.2">𝑽</ci><ci id="alg4.l10.1.m1.1.1.3.3.cmml" xref="alg4.l10.1.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l10.1.m1.1c">\bm{B}\leftarrow\bm{V}_{r}</annotation><annotation encoding="application/x-llamapun" id="alg4.l10.1.m1.1d">bold_italic_B ← bold_italic_V start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></span> <span class="ltx_text" id="alg4.l10.3" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l10.2.m1.1"><semantics id="alg4.l10.2.m1.1a"><mo id="alg4.l10.2.m1.1.1" xref="alg4.l10.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l10.2.m1.1b"><ci id="alg4.l10.2.m1.1.1.cmml" xref="alg4.l10.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l10.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l10.2.m1.1d">▷</annotation></semantics></math> <span class="ltx_text" id="alg4.l10.3.1" style="color:#0000FF;"> Get first <math alttext="r" class="ltx_Math" display="inline" id="alg4.l10.3.1.m1.1"><semantics id="alg4.l10.3.1.m1.1a"><mi id="alg4.l10.3.1.m1.1.1" mathcolor="#0000FF" xref="alg4.l10.3.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg4.l10.3.1.m1.1b"><ci id="alg4.l10.3.1.m1.1.1.cmml" xref="alg4.l10.3.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l10.3.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg4.l10.3.1.m1.1d">italic_r</annotation></semantics></math> right singular vectors</span>
</span>
</div>
<div class="ltx_listingline" id="alg4.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <span class="ltx_text ltx_font_bold" id="alg4.l11.1">for</span> <math alttext="j=0,\ldots,N-1" class="ltx_Math" display="inline" id="alg4.l11.m1.3"><semantics id="alg4.l11.m1.3a"><mrow id="alg4.l11.m1.3.3" xref="alg4.l11.m1.3.3.cmml"><mi id="alg4.l11.m1.3.3.3" xref="alg4.l11.m1.3.3.3.cmml">j</mi><mo id="alg4.l11.m1.3.3.2" xref="alg4.l11.m1.3.3.2.cmml">=</mo><mrow id="alg4.l11.m1.3.3.1.1" xref="alg4.l11.m1.3.3.1.2.cmml"><mn id="alg4.l11.m1.1.1" xref="alg4.l11.m1.1.1.cmml">0</mn><mo id="alg4.l11.m1.3.3.1.1.2" xref="alg4.l11.m1.3.3.1.2.cmml">,</mo><mi id="alg4.l11.m1.2.2" mathvariant="normal" xref="alg4.l11.m1.2.2.cmml">…</mi><mo id="alg4.l11.m1.3.3.1.1.3" xref="alg4.l11.m1.3.3.1.2.cmml">,</mo><mrow id="alg4.l11.m1.3.3.1.1.1" xref="alg4.l11.m1.3.3.1.1.1.cmml"><mi id="alg4.l11.m1.3.3.1.1.1.2" xref="alg4.l11.m1.3.3.1.1.1.2.cmml">N</mi><mo id="alg4.l11.m1.3.3.1.1.1.1" xref="alg4.l11.m1.3.3.1.1.1.1.cmml">−</mo><mn id="alg4.l11.m1.3.3.1.1.1.3" xref="alg4.l11.m1.3.3.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l11.m1.3b"><apply id="alg4.l11.m1.3.3.cmml" xref="alg4.l11.m1.3.3"><eq id="alg4.l11.m1.3.3.2.cmml" xref="alg4.l11.m1.3.3.2"></eq><ci id="alg4.l11.m1.3.3.3.cmml" xref="alg4.l11.m1.3.3.3">𝑗</ci><list id="alg4.l11.m1.3.3.1.2.cmml" xref="alg4.l11.m1.3.3.1.1"><cn id="alg4.l11.m1.1.1.cmml" type="integer" xref="alg4.l11.m1.1.1">0</cn><ci id="alg4.l11.m1.2.2.cmml" xref="alg4.l11.m1.2.2">…</ci><apply id="alg4.l11.m1.3.3.1.1.1.cmml" xref="alg4.l11.m1.3.3.1.1.1"><minus id="alg4.l11.m1.3.3.1.1.1.1.cmml" xref="alg4.l11.m1.3.3.1.1.1.1"></minus><ci id="alg4.l11.m1.3.3.1.1.1.2.cmml" xref="alg4.l11.m1.3.3.1.1.1.2">𝑁</ci><cn id="alg4.l11.m1.3.3.1.1.1.3.cmml" type="integer" xref="alg4.l11.m1.3.3.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l11.m1.3c">j=0,\ldots,N-1</annotation><annotation encoding="application/x-llamapun" id="alg4.l11.m1.3d">italic_j = 0 , … , italic_N - 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg4.l11.2">do</span>
</div>
<div class="ltx_listingline" id="alg4.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>         <span class="ltx_text" id="alg4.l12.1" style="color:#0000FF;"> <math alttext="\bm{g}\leftarrow\nabla_{\hat{{\bm{x}}}_{0}}\log p(\hat{{\bm{x}}}_{0}^{(j)}|{%
\bm{x}}_{t_{i}})+\nabla_{\hat{{\bm{x}}}_{0}}\log p({\bm{y}}|\hat{{\bm{x}}}_{0}%
^{(j)})" class="ltx_Math" display="inline" id="alg4.l12.1.m1.4"><semantics id="alg4.l12.1.m1.4a"><mrow id="alg4.l12.1.m1.4.4" xref="alg4.l12.1.m1.4.4.cmml"><mi id="alg4.l12.1.m1.4.4.4" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.4.cmml">𝒈</mi><mo id="alg4.l12.1.m1.4.4.3" mathcolor="#0000FF" stretchy="false" xref="alg4.l12.1.m1.4.4.3.cmml">←</mo><mrow id="alg4.l12.1.m1.4.4.2" xref="alg4.l12.1.m1.4.4.2.cmml"><mrow id="alg4.l12.1.m1.3.3.1.1" xref="alg4.l12.1.m1.3.3.1.1.cmml"><mrow id="alg4.l12.1.m1.3.3.1.1.3" xref="alg4.l12.1.m1.3.3.1.1.3.cmml"><mrow id="alg4.l12.1.m1.3.3.1.1.3.1" xref="alg4.l12.1.m1.3.3.1.1.3.1.cmml"><msub id="alg4.l12.1.m1.3.3.1.1.3.1.1" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.cmml"><mo id="alg4.l12.1.m1.3.3.1.1.3.1.1.2" mathcolor="#0000FF" rspace="0.167em" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.2.cmml">∇</mo><msub id="alg4.l12.1.m1.3.3.1.1.3.1.1.3" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3.cmml"><mover accent="true" id="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2.cmml"><mi id="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2.2.cmml">𝒙</mi><mo id="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2.1" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2.1.cmml">^</mo></mover><mn id="alg4.l12.1.m1.3.3.1.1.3.1.1.3.3" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3.3.cmml">0</mn></msub></msub><mi id="alg4.l12.1.m1.3.3.1.1.3.1.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.3.1.2.cmml">log</mi></mrow><mo id="alg4.l12.1.m1.3.3.1.1.3a" lspace="0.167em" xref="alg4.l12.1.m1.3.3.1.1.3.cmml">⁡</mo><mi id="alg4.l12.1.m1.3.3.1.1.3.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.3.2.cmml">p</mi></mrow><mo id="alg4.l12.1.m1.3.3.1.1.2" xref="alg4.l12.1.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="alg4.l12.1.m1.3.3.1.1.1.1" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.cmml"><mo id="alg4.l12.1.m1.3.3.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="alg4.l12.1.m1.3.3.1.1.1.1.1" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.cmml"><msubsup id="alg4.l12.1.m1.3.3.1.1.1.1.1.2" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.cmml"><mover accent="true" id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2.cmml"><mi id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml">𝒙</mi><mo id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2.1" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mn id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.3" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.3.cmml">0</mn><mrow id="alg4.l12.1.m1.1.1.1.3" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="alg4.l12.1.m1.1.1.1.3.1" mathcolor="#0000FF" stretchy="false" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="alg4.l12.1.m1.1.1.1.1" mathcolor="#0000FF" xref="alg4.l12.1.m1.1.1.1.1.cmml">j</mi><mo id="alg4.l12.1.m1.1.1.1.3.2" mathcolor="#0000FF" stretchy="false" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo fence="false" id="alg4.l12.1.m1.3.3.1.1.1.1.1.1" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.1.cmml">|</mo><msub id="alg4.l12.1.m1.3.3.1.1.1.1.1.3" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3.cmml"><mi id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3.2.cmml">𝒙</mi><msub id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.cmml"><mi id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.2.cmml">t</mi><mi id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.3" mathcolor="#0000FF" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub></mrow><mo id="alg4.l12.1.m1.3.3.1.1.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg4.l12.1.m1.4.4.2.3" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.3.cmml">+</mo><mrow id="alg4.l12.1.m1.4.4.2.2" xref="alg4.l12.1.m1.4.4.2.2.cmml"><mrow id="alg4.l12.1.m1.4.4.2.2.3" xref="alg4.l12.1.m1.4.4.2.2.3.cmml"><mrow id="alg4.l12.1.m1.4.4.2.2.3.1" xref="alg4.l12.1.m1.4.4.2.2.3.1.cmml"><msub id="alg4.l12.1.m1.4.4.2.2.3.1.1" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.cmml"><mo id="alg4.l12.1.m1.4.4.2.2.3.1.1.2" mathcolor="#0000FF" rspace="0.167em" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.2.cmml">∇</mo><msub id="alg4.l12.1.m1.4.4.2.2.3.1.1.3" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3.cmml"><mover accent="true" id="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2.cmml"><mi id="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2.2.cmml">𝒙</mi><mo id="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2.1" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2.1.cmml">^</mo></mover><mn id="alg4.l12.1.m1.4.4.2.2.3.1.1.3.3" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3.3.cmml">0</mn></msub></msub><mi id="alg4.l12.1.m1.4.4.2.2.3.1.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.2.3.1.2.cmml">log</mi></mrow><mo id="alg4.l12.1.m1.4.4.2.2.3a" lspace="0.167em" xref="alg4.l12.1.m1.4.4.2.2.3.cmml">⁡</mo><mi id="alg4.l12.1.m1.4.4.2.2.3.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.2.3.2.cmml">p</mi></mrow><mo id="alg4.l12.1.m1.4.4.2.2.2" xref="alg4.l12.1.m1.4.4.2.2.2.cmml">⁢</mo><mrow id="alg4.l12.1.m1.4.4.2.2.1.1" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.cmml"><mo id="alg4.l12.1.m1.4.4.2.2.1.1.2" mathcolor="#0000FF" stretchy="false" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.cmml">(</mo><mrow id="alg4.l12.1.m1.4.4.2.2.1.1.1" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.cmml"><mi id="alg4.l12.1.m1.4.4.2.2.1.1.1.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="alg4.l12.1.m1.4.4.2.2.1.1.1.1" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.1.cmml">|</mo><msubsup id="alg4.l12.1.m1.4.4.2.2.1.1.1.3" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.cmml"><mover accent="true" id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2.cmml"><mi id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2.2" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2.2.cmml">𝒙</mi><mo id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2.1" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2.1.cmml">^</mo></mover><mn id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.3" mathcolor="#0000FF" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.3.cmml">0</mn><mrow id="alg4.l12.1.m1.2.2.1.3" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.cmml"><mo id="alg4.l12.1.m1.2.2.1.3.1" mathcolor="#0000FF" stretchy="false" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.cmml">(</mo><mi id="alg4.l12.1.m1.2.2.1.1" mathcolor="#0000FF" xref="alg4.l12.1.m1.2.2.1.1.cmml">j</mi><mo id="alg4.l12.1.m1.2.2.1.3.2" mathcolor="#0000FF" stretchy="false" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="alg4.l12.1.m1.4.4.2.2.1.1.3" mathcolor="#0000FF" stretchy="false" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l12.1.m1.4b"><apply id="alg4.l12.1.m1.4.4.cmml" xref="alg4.l12.1.m1.4.4"><ci id="alg4.l12.1.m1.4.4.3.cmml" xref="alg4.l12.1.m1.4.4.3">←</ci><ci id="alg4.l12.1.m1.4.4.4.cmml" xref="alg4.l12.1.m1.4.4.4">𝒈</ci><apply id="alg4.l12.1.m1.4.4.2.cmml" xref="alg4.l12.1.m1.4.4.2"><plus id="alg4.l12.1.m1.4.4.2.3.cmml" xref="alg4.l12.1.m1.4.4.2.3"></plus><apply id="alg4.l12.1.m1.3.3.1.1.cmml" xref="alg4.l12.1.m1.3.3.1.1"><times id="alg4.l12.1.m1.3.3.1.1.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.2"></times><apply id="alg4.l12.1.m1.3.3.1.1.3.cmml" xref="alg4.l12.1.m1.3.3.1.1.3"><apply id="alg4.l12.1.m1.3.3.1.1.3.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.1"><apply id="alg4.l12.1.m1.3.3.1.1.3.1.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.1.1"><csymbol cd="ambiguous" id="alg4.l12.1.m1.3.3.1.1.3.1.1.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.1.1">subscript</csymbol><ci id="alg4.l12.1.m1.3.3.1.1.3.1.1.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.2">∇</ci><apply id="alg4.l12.1.m1.3.3.1.1.3.1.1.3.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3"><csymbol cd="ambiguous" id="alg4.l12.1.m1.3.3.1.1.3.1.1.3.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3">subscript</csymbol><apply id="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2"><ci id="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2.1">^</ci><ci id="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3.2.2">𝒙</ci></apply><cn id="alg4.l12.1.m1.3.3.1.1.3.1.1.3.3.cmml" type="integer" xref="alg4.l12.1.m1.3.3.1.1.3.1.1.3.3">0</cn></apply></apply><log id="alg4.l12.1.m1.3.3.1.1.3.1.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.1.2"></log></apply><ci id="alg4.l12.1.m1.3.3.1.1.3.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.3.2">𝑝</ci></apply><apply id="alg4.l12.1.m1.3.3.1.1.1.1.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="alg4.l12.1.m1.3.3.1.1.1.1.1.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.1">conditional</csymbol><apply id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2">superscript</csymbol><apply id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2">subscript</csymbol><apply id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2"><ci id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2.1">^</ci><ci id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.2.2">𝒙</ci></apply><cn id="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.3.cmml" type="integer" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.2.2.3">0</cn></apply><ci id="alg4.l12.1.m1.1.1.1.1.cmml" xref="alg4.l12.1.m1.1.1.1.1">𝑗</ci></apply><apply id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3.2">𝒙</ci><apply id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.1.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.2.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.2">𝑡</ci><ci id="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.3.cmml" xref="alg4.l12.1.m1.3.3.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="alg4.l12.1.m1.4.4.2.2.cmml" xref="alg4.l12.1.m1.4.4.2.2"><times id="alg4.l12.1.m1.4.4.2.2.2.cmml" xref="alg4.l12.1.m1.4.4.2.2.2"></times><apply id="alg4.l12.1.m1.4.4.2.2.3.cmml" xref="alg4.l12.1.m1.4.4.2.2.3"><apply id="alg4.l12.1.m1.4.4.2.2.3.1.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.1"><apply id="alg4.l12.1.m1.4.4.2.2.3.1.1.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.1.1"><csymbol cd="ambiguous" id="alg4.l12.1.m1.4.4.2.2.3.1.1.1.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.1.1">subscript</csymbol><ci id="alg4.l12.1.m1.4.4.2.2.3.1.1.2.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.2">∇</ci><apply id="alg4.l12.1.m1.4.4.2.2.3.1.1.3.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3"><csymbol cd="ambiguous" id="alg4.l12.1.m1.4.4.2.2.3.1.1.3.1.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3">subscript</csymbol><apply id="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2"><ci id="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2.1.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2.1">^</ci><ci id="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2.2.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3.2.2">𝒙</ci></apply><cn id="alg4.l12.1.m1.4.4.2.2.3.1.1.3.3.cmml" type="integer" xref="alg4.l12.1.m1.4.4.2.2.3.1.1.3.3">0</cn></apply></apply><log id="alg4.l12.1.m1.4.4.2.2.3.1.2.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.1.2"></log></apply><ci id="alg4.l12.1.m1.4.4.2.2.3.2.cmml" xref="alg4.l12.1.m1.4.4.2.2.3.2">𝑝</ci></apply><apply id="alg4.l12.1.m1.4.4.2.2.1.1.1.cmml" xref="alg4.l12.1.m1.4.4.2.2.1.1"><csymbol cd="latexml" id="alg4.l12.1.m1.4.4.2.2.1.1.1.1.cmml" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.1">conditional</csymbol><ci id="alg4.l12.1.m1.4.4.2.2.1.1.1.2.cmml" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.2">𝒚</ci><apply id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.cmml" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.1.cmml" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3">superscript</csymbol><apply id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.cmml" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.1.cmml" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3">subscript</csymbol><apply id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2.cmml" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2"><ci id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2.1.cmml" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2.1">^</ci><ci id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2.2.cmml" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.2.2">𝒙</ci></apply><cn id="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.3.cmml" type="integer" xref="alg4.l12.1.m1.4.4.2.2.1.1.1.3.2.3">0</cn></apply><ci id="alg4.l12.1.m1.2.2.1.1.cmml" xref="alg4.l12.1.m1.2.2.1.1">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.1.m1.4c">\bm{g}\leftarrow\nabla_{\hat{{\bm{x}}}_{0}}\log p(\hat{{\bm{x}}}_{0}^{(j)}|{%
\bm{x}}_{t_{i}})+\nabla_{\hat{{\bm{x}}}_{0}}\log p({\bm{y}}|\hat{{\bm{x}}}_{0}%
^{(j)})</annotation><annotation encoding="application/x-llamapun" id="alg4.l12.1.m1.4d">bold_italic_g ← ∇ start_POSTSUBSCRIPT over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | bold_italic_x start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) + ∇ start_POSTSUBSCRIPT over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p ( bold_italic_y | over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT )</annotation></semantics></math></span> <span class="ltx_text" id="alg4.l12.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l12.2.m1.1"><semantics id="alg4.l12.2.m1.1a"><mo id="alg4.l12.2.m1.1.1" xref="alg4.l12.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l12.2.m1.1b"><ci id="alg4.l12.2.m1.1.1.cmml" xref="alg4.l12.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l12.2.m1.1d">▷</annotation></semantics></math> <span class="ltx_text" id="alg4.l12.2.1" style="color:#0000FF;"> Compute gradient</span>
</span>
</div>
<div class="ltx_listingline" id="alg4.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>         <span class="ltx_text" id="alg4.l13.1" style="color:#0000FF;"> <math alttext="\bm{R}\leftarrow\bm{A}^{T}\bm{G}\bm{B}^{T}" class="ltx_Math" display="inline" id="alg4.l13.1.m1.1"><semantics id="alg4.l13.1.m1.1a"><mrow id="alg4.l13.1.m1.1.1" xref="alg4.l13.1.m1.1.1.cmml"><mi id="alg4.l13.1.m1.1.1.2" mathcolor="#0000FF" xref="alg4.l13.1.m1.1.1.2.cmml">𝑹</mi><mo id="alg4.l13.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg4.l13.1.m1.1.1.1.cmml">←</mo><mrow id="alg4.l13.1.m1.1.1.3" xref="alg4.l13.1.m1.1.1.3.cmml"><msup id="alg4.l13.1.m1.1.1.3.2" xref="alg4.l13.1.m1.1.1.3.2.cmml"><mi id="alg4.l13.1.m1.1.1.3.2.2" mathcolor="#0000FF" xref="alg4.l13.1.m1.1.1.3.2.2.cmml">𝑨</mi><mi id="alg4.l13.1.m1.1.1.3.2.3" mathcolor="#0000FF" xref="alg4.l13.1.m1.1.1.3.2.3.cmml">T</mi></msup><mo id="alg4.l13.1.m1.1.1.3.1" xref="alg4.l13.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg4.l13.1.m1.1.1.3.3" mathcolor="#0000FF" xref="alg4.l13.1.m1.1.1.3.3.cmml">𝑮</mi><mo id="alg4.l13.1.m1.1.1.3.1a" xref="alg4.l13.1.m1.1.1.3.1.cmml">⁢</mo><msup id="alg4.l13.1.m1.1.1.3.4" xref="alg4.l13.1.m1.1.1.3.4.cmml"><mi id="alg4.l13.1.m1.1.1.3.4.2" mathcolor="#0000FF" xref="alg4.l13.1.m1.1.1.3.4.2.cmml">𝑩</mi><mi id="alg4.l13.1.m1.1.1.3.4.3" mathcolor="#0000FF" xref="alg4.l13.1.m1.1.1.3.4.3.cmml">T</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l13.1.m1.1b"><apply id="alg4.l13.1.m1.1.1.cmml" xref="alg4.l13.1.m1.1.1"><ci id="alg4.l13.1.m1.1.1.1.cmml" xref="alg4.l13.1.m1.1.1.1">←</ci><ci id="alg4.l13.1.m1.1.1.2.cmml" xref="alg4.l13.1.m1.1.1.2">𝑹</ci><apply id="alg4.l13.1.m1.1.1.3.cmml" xref="alg4.l13.1.m1.1.1.3"><times id="alg4.l13.1.m1.1.1.3.1.cmml" xref="alg4.l13.1.m1.1.1.3.1"></times><apply id="alg4.l13.1.m1.1.1.3.2.cmml" xref="alg4.l13.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg4.l13.1.m1.1.1.3.2.1.cmml" xref="alg4.l13.1.m1.1.1.3.2">superscript</csymbol><ci id="alg4.l13.1.m1.1.1.3.2.2.cmml" xref="alg4.l13.1.m1.1.1.3.2.2">𝑨</ci><ci id="alg4.l13.1.m1.1.1.3.2.3.cmml" xref="alg4.l13.1.m1.1.1.3.2.3">𝑇</ci></apply><ci id="alg4.l13.1.m1.1.1.3.3.cmml" xref="alg4.l13.1.m1.1.1.3.3">𝑮</ci><apply id="alg4.l13.1.m1.1.1.3.4.cmml" xref="alg4.l13.1.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg4.l13.1.m1.1.1.3.4.1.cmml" xref="alg4.l13.1.m1.1.1.3.4">superscript</csymbol><ci id="alg4.l13.1.m1.1.1.3.4.2.cmml" xref="alg4.l13.1.m1.1.1.3.4.2">𝑩</ci><ci id="alg4.l13.1.m1.1.1.3.4.3.cmml" xref="alg4.l13.1.m1.1.1.3.4.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.1.m1.1c">\bm{R}\leftarrow\bm{A}^{T}\bm{G}\bm{B}^{T}</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.1.m1.1d">bold_italic_R ← bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_G bold_italic_B start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math></span> <span class="ltx_text" id="alg4.l13.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l13.2.m1.1"><semantics id="alg4.l13.2.m1.1a"><mo id="alg4.l13.2.m1.1.1" xref="alg4.l13.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l13.2.m1.1b"><ci id="alg4.l13.2.m1.1.1.cmml" xref="alg4.l13.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.2.m1.1d">▷</annotation></semantics></math> <span class="ltx_text" id="alg4.l13.2.1" style="color:#0000FF;"> Project gradient</span>
</span>
</div>
<div class="ltx_listingline" id="alg4.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>         <span class="ltx_text" id="alg4.l14.1" style="color:#0000FF;"> <math alttext="\bm{G}^{\prime}\leftarrow\bm{A}\bm{R}\bm{B}" class="ltx_Math" display="inline" id="alg4.l14.1.m1.1"><semantics id="alg4.l14.1.m1.1a"><mrow id="alg4.l14.1.m1.1.1" xref="alg4.l14.1.m1.1.1.cmml"><msup id="alg4.l14.1.m1.1.1.2" xref="alg4.l14.1.m1.1.1.2.cmml"><mi id="alg4.l14.1.m1.1.1.2.2" mathcolor="#0000FF" xref="alg4.l14.1.m1.1.1.2.2.cmml">𝑮</mi><mo id="alg4.l14.1.m1.1.1.2.3" mathcolor="#0000FF" xref="alg4.l14.1.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg4.l14.1.m1.1.1.1" mathcolor="#0000FF" stretchy="false" xref="alg4.l14.1.m1.1.1.1.cmml">←</mo><mrow id="alg4.l14.1.m1.1.1.3" xref="alg4.l14.1.m1.1.1.3.cmml"><mi id="alg4.l14.1.m1.1.1.3.2" mathcolor="#0000FF" xref="alg4.l14.1.m1.1.1.3.2.cmml">𝑨</mi><mo id="alg4.l14.1.m1.1.1.3.1" xref="alg4.l14.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg4.l14.1.m1.1.1.3.3" mathcolor="#0000FF" xref="alg4.l14.1.m1.1.1.3.3.cmml">𝑹</mi><mo id="alg4.l14.1.m1.1.1.3.1a" xref="alg4.l14.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg4.l14.1.m1.1.1.3.4" mathcolor="#0000FF" xref="alg4.l14.1.m1.1.1.3.4.cmml">𝑩</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l14.1.m1.1b"><apply id="alg4.l14.1.m1.1.1.cmml" xref="alg4.l14.1.m1.1.1"><ci id="alg4.l14.1.m1.1.1.1.cmml" xref="alg4.l14.1.m1.1.1.1">←</ci><apply id="alg4.l14.1.m1.1.1.2.cmml" xref="alg4.l14.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg4.l14.1.m1.1.1.2.1.cmml" xref="alg4.l14.1.m1.1.1.2">superscript</csymbol><ci id="alg4.l14.1.m1.1.1.2.2.cmml" xref="alg4.l14.1.m1.1.1.2.2">𝑮</ci><ci id="alg4.l14.1.m1.1.1.2.3.cmml" xref="alg4.l14.1.m1.1.1.2.3">′</ci></apply><apply id="alg4.l14.1.m1.1.1.3.cmml" xref="alg4.l14.1.m1.1.1.3"><times id="alg4.l14.1.m1.1.1.3.1.cmml" xref="alg4.l14.1.m1.1.1.3.1"></times><ci id="alg4.l14.1.m1.1.1.3.2.cmml" xref="alg4.l14.1.m1.1.1.3.2">𝑨</ci><ci id="alg4.l14.1.m1.1.1.3.3.cmml" xref="alg4.l14.1.m1.1.1.3.3">𝑹</ci><ci id="alg4.l14.1.m1.1.1.3.4.cmml" xref="alg4.l14.1.m1.1.1.3.4">𝑩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l14.1.m1.1c">\bm{G}^{\prime}\leftarrow\bm{A}\bm{R}\bm{B}</annotation><annotation encoding="application/x-llamapun" id="alg4.l14.1.m1.1d">bold_italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← bold_italic_A bold_italic_R bold_italic_B</annotation></semantics></math></span> <span class="ltx_text" id="alg4.l14.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l14.2.m1.1"><semantics id="alg4.l14.2.m1.1a"><mo id="alg4.l14.2.m1.1.1" xref="alg4.l14.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l14.2.m1.1b"><ci id="alg4.l14.2.m1.1.1.cmml" xref="alg4.l14.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l14.2.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l14.2.m1.1d">▷</annotation></semantics></math> <span class="ltx_text" id="alg4.l14.2.1" style="color:#0000FF;"> Reconstruct approximated gradient</span>
</span>
</div>
<div class="ltx_listingline" id="alg4.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>         <math alttext="\hat{{\bm{x}}}_{0}^{(j+1)}\leftarrow\hat{{\bm{x}}}_{0}^{(j)}+\eta_{t}\bm{g}^{%
\prime}+\sqrt{2\eta_{t}}\bm{\epsilon}_{j}" class="ltx_Math" display="inline" id="alg4.l15.m1.2"><semantics id="alg4.l15.m1.2a"><mrow id="alg4.l15.m1.2.3" xref="alg4.l15.m1.2.3.cmml"><msubsup id="alg4.l15.m1.2.3.2" xref="alg4.l15.m1.2.3.2.cmml"><mover accent="true" id="alg4.l15.m1.2.3.2.2.2" xref="alg4.l15.m1.2.3.2.2.2.cmml"><mi id="alg4.l15.m1.2.3.2.2.2.2" xref="alg4.l15.m1.2.3.2.2.2.2.cmml">𝒙</mi><mo id="alg4.l15.m1.2.3.2.2.2.1" xref="alg4.l15.m1.2.3.2.2.2.1.cmml">^</mo></mover><mn id="alg4.l15.m1.2.3.2.2.3" xref="alg4.l15.m1.2.3.2.2.3.cmml">0</mn><mrow id="alg4.l15.m1.1.1.1.1" xref="alg4.l15.m1.1.1.1.1.1.cmml"><mo id="alg4.l15.m1.1.1.1.1.2" stretchy="false" xref="alg4.l15.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg4.l15.m1.1.1.1.1.1" xref="alg4.l15.m1.1.1.1.1.1.cmml"><mi id="alg4.l15.m1.1.1.1.1.1.2" xref="alg4.l15.m1.1.1.1.1.1.2.cmml">j</mi><mo id="alg4.l15.m1.1.1.1.1.1.1" xref="alg4.l15.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg4.l15.m1.1.1.1.1.1.3" xref="alg4.l15.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg4.l15.m1.1.1.1.1.3" stretchy="false" xref="alg4.l15.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg4.l15.m1.2.3.1" stretchy="false" xref="alg4.l15.m1.2.3.1.cmml">←</mo><mrow id="alg4.l15.m1.2.3.3" xref="alg4.l15.m1.2.3.3.cmml"><msubsup id="alg4.l15.m1.2.3.3.2" xref="alg4.l15.m1.2.3.3.2.cmml"><mover accent="true" id="alg4.l15.m1.2.3.3.2.2.2" xref="alg4.l15.m1.2.3.3.2.2.2.cmml"><mi id="alg4.l15.m1.2.3.3.2.2.2.2" xref="alg4.l15.m1.2.3.3.2.2.2.2.cmml">𝒙</mi><mo id="alg4.l15.m1.2.3.3.2.2.2.1" xref="alg4.l15.m1.2.3.3.2.2.2.1.cmml">^</mo></mover><mn id="alg4.l15.m1.2.3.3.2.2.3" xref="alg4.l15.m1.2.3.3.2.2.3.cmml">0</mn><mrow id="alg4.l15.m1.2.2.1.3" xref="alg4.l15.m1.2.3.3.2.cmml"><mo id="alg4.l15.m1.2.2.1.3.1" stretchy="false" xref="alg4.l15.m1.2.3.3.2.cmml">(</mo><mi id="alg4.l15.m1.2.2.1.1" xref="alg4.l15.m1.2.2.1.1.cmml">j</mi><mo id="alg4.l15.m1.2.2.1.3.2" stretchy="false" xref="alg4.l15.m1.2.3.3.2.cmml">)</mo></mrow></msubsup><mo id="alg4.l15.m1.2.3.3.1" xref="alg4.l15.m1.2.3.3.1.cmml">+</mo><mrow id="alg4.l15.m1.2.3.3.3" xref="alg4.l15.m1.2.3.3.3.cmml"><msub id="alg4.l15.m1.2.3.3.3.2" xref="alg4.l15.m1.2.3.3.3.2.cmml"><mi id="alg4.l15.m1.2.3.3.3.2.2" xref="alg4.l15.m1.2.3.3.3.2.2.cmml">η</mi><mi id="alg4.l15.m1.2.3.3.3.2.3" xref="alg4.l15.m1.2.3.3.3.2.3.cmml">t</mi></msub><mo id="alg4.l15.m1.2.3.3.3.1" xref="alg4.l15.m1.2.3.3.3.1.cmml">⁢</mo><msup id="alg4.l15.m1.2.3.3.3.3" xref="alg4.l15.m1.2.3.3.3.3.cmml"><mi id="alg4.l15.m1.2.3.3.3.3.2" xref="alg4.l15.m1.2.3.3.3.3.2.cmml">𝒈</mi><mo id="alg4.l15.m1.2.3.3.3.3.3" xref="alg4.l15.m1.2.3.3.3.3.3.cmml">′</mo></msup></mrow><mo id="alg4.l15.m1.2.3.3.1a" xref="alg4.l15.m1.2.3.3.1.cmml">+</mo><mrow id="alg4.l15.m1.2.3.3.4" xref="alg4.l15.m1.2.3.3.4.cmml"><msqrt id="alg4.l15.m1.2.3.3.4.2" xref="alg4.l15.m1.2.3.3.4.2.cmml"><mrow id="alg4.l15.m1.2.3.3.4.2.2" xref="alg4.l15.m1.2.3.3.4.2.2.cmml"><mn id="alg4.l15.m1.2.3.3.4.2.2.2" xref="alg4.l15.m1.2.3.3.4.2.2.2.cmml">2</mn><mo id="alg4.l15.m1.2.3.3.4.2.2.1" xref="alg4.l15.m1.2.3.3.4.2.2.1.cmml">⁢</mo><msub id="alg4.l15.m1.2.3.3.4.2.2.3" xref="alg4.l15.m1.2.3.3.4.2.2.3.cmml"><mi id="alg4.l15.m1.2.3.3.4.2.2.3.2" xref="alg4.l15.m1.2.3.3.4.2.2.3.2.cmml">η</mi><mi id="alg4.l15.m1.2.3.3.4.2.2.3.3" xref="alg4.l15.m1.2.3.3.4.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo id="alg4.l15.m1.2.3.3.4.1" xref="alg4.l15.m1.2.3.3.4.1.cmml">⁢</mo><msub id="alg4.l15.m1.2.3.3.4.3" xref="alg4.l15.m1.2.3.3.4.3.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg4.l15.m1.2.3.3.4.3.2" mathvariant="bold-italic" xref="alg4.l15.m1.2.3.3.4.3.2.cmml">ϵ</mi><mi id="alg4.l15.m1.2.3.3.4.3.3" xref="alg4.l15.m1.2.3.3.4.3.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l15.m1.2b"><apply id="alg4.l15.m1.2.3.cmml" xref="alg4.l15.m1.2.3"><ci id="alg4.l15.m1.2.3.1.cmml" xref="alg4.l15.m1.2.3.1">←</ci><apply id="alg4.l15.m1.2.3.2.cmml" xref="alg4.l15.m1.2.3.2"><csymbol cd="ambiguous" id="alg4.l15.m1.2.3.2.1.cmml" xref="alg4.l15.m1.2.3.2">superscript</csymbol><apply id="alg4.l15.m1.2.3.2.2.cmml" xref="alg4.l15.m1.2.3.2"><csymbol cd="ambiguous" id="alg4.l15.m1.2.3.2.2.1.cmml" xref="alg4.l15.m1.2.3.2">subscript</csymbol><apply id="alg4.l15.m1.2.3.2.2.2.cmml" xref="alg4.l15.m1.2.3.2.2.2"><ci id="alg4.l15.m1.2.3.2.2.2.1.cmml" xref="alg4.l15.m1.2.3.2.2.2.1">^</ci><ci id="alg4.l15.m1.2.3.2.2.2.2.cmml" xref="alg4.l15.m1.2.3.2.2.2.2">𝒙</ci></apply><cn id="alg4.l15.m1.2.3.2.2.3.cmml" type="integer" xref="alg4.l15.m1.2.3.2.2.3">0</cn></apply><apply id="alg4.l15.m1.1.1.1.1.1.cmml" xref="alg4.l15.m1.1.1.1.1"><plus id="alg4.l15.m1.1.1.1.1.1.1.cmml" xref="alg4.l15.m1.1.1.1.1.1.1"></plus><ci id="alg4.l15.m1.1.1.1.1.1.2.cmml" xref="alg4.l15.m1.1.1.1.1.1.2">𝑗</ci><cn id="alg4.l15.m1.1.1.1.1.1.3.cmml" type="integer" xref="alg4.l15.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg4.l15.m1.2.3.3.cmml" xref="alg4.l15.m1.2.3.3"><plus id="alg4.l15.m1.2.3.3.1.cmml" xref="alg4.l15.m1.2.3.3.1"></plus><apply id="alg4.l15.m1.2.3.3.2.cmml" xref="alg4.l15.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg4.l15.m1.2.3.3.2.1.cmml" xref="alg4.l15.m1.2.3.3.2">superscript</csymbol><apply id="alg4.l15.m1.2.3.3.2.2.cmml" xref="alg4.l15.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg4.l15.m1.2.3.3.2.2.1.cmml" xref="alg4.l15.m1.2.3.3.2">subscript</csymbol><apply id="alg4.l15.m1.2.3.3.2.2.2.cmml" xref="alg4.l15.m1.2.3.3.2.2.2"><ci id="alg4.l15.m1.2.3.3.2.2.2.1.cmml" xref="alg4.l15.m1.2.3.3.2.2.2.1">^</ci><ci id="alg4.l15.m1.2.3.3.2.2.2.2.cmml" xref="alg4.l15.m1.2.3.3.2.2.2.2">𝒙</ci></apply><cn id="alg4.l15.m1.2.3.3.2.2.3.cmml" type="integer" xref="alg4.l15.m1.2.3.3.2.2.3">0</cn></apply><ci id="alg4.l15.m1.2.2.1.1.cmml" xref="alg4.l15.m1.2.2.1.1">𝑗</ci></apply><apply id="alg4.l15.m1.2.3.3.3.cmml" xref="alg4.l15.m1.2.3.3.3"><times id="alg4.l15.m1.2.3.3.3.1.cmml" xref="alg4.l15.m1.2.3.3.3.1"></times><apply id="alg4.l15.m1.2.3.3.3.2.cmml" xref="alg4.l15.m1.2.3.3.3.2"><csymbol cd="ambiguous" id="alg4.l15.m1.2.3.3.3.2.1.cmml" xref="alg4.l15.m1.2.3.3.3.2">subscript</csymbol><ci id="alg4.l15.m1.2.3.3.3.2.2.cmml" xref="alg4.l15.m1.2.3.3.3.2.2">𝜂</ci><ci id="alg4.l15.m1.2.3.3.3.2.3.cmml" xref="alg4.l15.m1.2.3.3.3.2.3">𝑡</ci></apply><apply id="alg4.l15.m1.2.3.3.3.3.cmml" xref="alg4.l15.m1.2.3.3.3.3"><csymbol cd="ambiguous" id="alg4.l15.m1.2.3.3.3.3.1.cmml" xref="alg4.l15.m1.2.3.3.3.3">superscript</csymbol><ci id="alg4.l15.m1.2.3.3.3.3.2.cmml" xref="alg4.l15.m1.2.3.3.3.3.2">𝒈</ci><ci id="alg4.l15.m1.2.3.3.3.3.3.cmml" xref="alg4.l15.m1.2.3.3.3.3.3">′</ci></apply></apply><apply id="alg4.l15.m1.2.3.3.4.cmml" xref="alg4.l15.m1.2.3.3.4"><times id="alg4.l15.m1.2.3.3.4.1.cmml" xref="alg4.l15.m1.2.3.3.4.1"></times><apply id="alg4.l15.m1.2.3.3.4.2.cmml" xref="alg4.l15.m1.2.3.3.4.2"><root id="alg4.l15.m1.2.3.3.4.2a.cmml" xref="alg4.l15.m1.2.3.3.4.2"></root><apply id="alg4.l15.m1.2.3.3.4.2.2.cmml" xref="alg4.l15.m1.2.3.3.4.2.2"><times id="alg4.l15.m1.2.3.3.4.2.2.1.cmml" xref="alg4.l15.m1.2.3.3.4.2.2.1"></times><cn id="alg4.l15.m1.2.3.3.4.2.2.2.cmml" type="integer" xref="alg4.l15.m1.2.3.3.4.2.2.2">2</cn><apply id="alg4.l15.m1.2.3.3.4.2.2.3.cmml" xref="alg4.l15.m1.2.3.3.4.2.2.3"><csymbol cd="ambiguous" id="alg4.l15.m1.2.3.3.4.2.2.3.1.cmml" xref="alg4.l15.m1.2.3.3.4.2.2.3">subscript</csymbol><ci id="alg4.l15.m1.2.3.3.4.2.2.3.2.cmml" xref="alg4.l15.m1.2.3.3.4.2.2.3.2">𝜂</ci><ci id="alg4.l15.m1.2.3.3.4.2.2.3.3.cmml" xref="alg4.l15.m1.2.3.3.4.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="alg4.l15.m1.2.3.3.4.3.cmml" xref="alg4.l15.m1.2.3.3.4.3"><csymbol cd="ambiguous" id="alg4.l15.m1.2.3.3.4.3.1.cmml" xref="alg4.l15.m1.2.3.3.4.3">subscript</csymbol><ci id="alg4.l15.m1.2.3.3.4.3.2.cmml" xref="alg4.l15.m1.2.3.3.4.3.2">bold-italic-ϵ</ci><ci id="alg4.l15.m1.2.3.3.4.3.3.cmml" xref="alg4.l15.m1.2.3.3.4.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l15.m1.2c">\hat{{\bm{x}}}_{0}^{(j+1)}\leftarrow\hat{{\bm{x}}}_{0}^{(j)}+\eta_{t}\bm{g}^{%
\prime}+\sqrt{2\eta_{t}}\bm{\epsilon}_{j}</annotation><annotation encoding="application/x-llamapun" id="alg4.l15.m1.2d">over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j + 1 ) end_POSTSUPERSCRIPT ← over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT + italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + square-root start_ARG 2 italic_η start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_italic_ϵ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\bm{\epsilon}_{j}\sim\mathcal{N}(\mathbf{0},\bm{I})" class="ltx_Math" display="inline" id="alg4.l15.m2.2"><semantics id="alg4.l15.m2.2a"><mrow id="alg4.l15.m2.2.3" xref="alg4.l15.m2.2.3.cmml"><msub id="alg4.l15.m2.2.3.2" xref="alg4.l15.m2.2.3.2.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg4.l15.m2.2.3.2.2" mathvariant="bold-italic" xref="alg4.l15.m2.2.3.2.2.cmml">ϵ</mi><mi id="alg4.l15.m2.2.3.2.3" xref="alg4.l15.m2.2.3.2.3.cmml">j</mi></msub><mo id="alg4.l15.m2.2.3.1" xref="alg4.l15.m2.2.3.1.cmml">∼</mo><mrow id="alg4.l15.m2.2.3.3" xref="alg4.l15.m2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg4.l15.m2.2.3.3.2" xref="alg4.l15.m2.2.3.3.2.cmml">𝒩</mi><mo id="alg4.l15.m2.2.3.3.1" xref="alg4.l15.m2.2.3.3.1.cmml">⁢</mo><mrow id="alg4.l15.m2.2.3.3.3.2" xref="alg4.l15.m2.2.3.3.3.1.cmml"><mo id="alg4.l15.m2.2.3.3.3.2.1" stretchy="false" xref="alg4.l15.m2.2.3.3.3.1.cmml">(</mo><mn id="alg4.l15.m2.1.1" xref="alg4.l15.m2.1.1.cmml">𝟎</mn><mo id="alg4.l15.m2.2.3.3.3.2.2" xref="alg4.l15.m2.2.3.3.3.1.cmml">,</mo><mi id="alg4.l15.m2.2.2" xref="alg4.l15.m2.2.2.cmml">𝑰</mi><mo id="alg4.l15.m2.2.3.3.3.2.3" stretchy="false" xref="alg4.l15.m2.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l15.m2.2b"><apply id="alg4.l15.m2.2.3.cmml" xref="alg4.l15.m2.2.3"><csymbol cd="latexml" id="alg4.l15.m2.2.3.1.cmml" xref="alg4.l15.m2.2.3.1">similar-to</csymbol><apply id="alg4.l15.m2.2.3.2.cmml" xref="alg4.l15.m2.2.3.2"><csymbol cd="ambiguous" id="alg4.l15.m2.2.3.2.1.cmml" xref="alg4.l15.m2.2.3.2">subscript</csymbol><ci id="alg4.l15.m2.2.3.2.2.cmml" xref="alg4.l15.m2.2.3.2.2">bold-italic-ϵ</ci><ci id="alg4.l15.m2.2.3.2.3.cmml" xref="alg4.l15.m2.2.3.2.3">𝑗</ci></apply><apply id="alg4.l15.m2.2.3.3.cmml" xref="alg4.l15.m2.2.3.3"><times id="alg4.l15.m2.2.3.3.1.cmml" xref="alg4.l15.m2.2.3.3.1"></times><ci id="alg4.l15.m2.2.3.3.2.cmml" xref="alg4.l15.m2.2.3.3.2">𝒩</ci><interval closure="open" id="alg4.l15.m2.2.3.3.3.1.cmml" xref="alg4.l15.m2.2.3.3.3.2"><cn id="alg4.l15.m2.1.1.cmml" type="integer" xref="alg4.l15.m2.1.1">0</cn><ci id="alg4.l15.m2.2.2.cmml" xref="alg4.l15.m2.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l15.m2.2c">\bm{\epsilon}_{j}\sim\mathcal{N}(\mathbf{0},\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg4.l15.m2.2d">bold_italic_ϵ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∼ caligraphic_N ( bold_0 , bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>     <span class="ltx_text ltx_font_bold" id="alg4.l16.1">end</span> <span class="ltx_text ltx_font_bold" id="alg4.l16.2">for</span>
</div>
<div class="ltx_listingline" id="alg4.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>     Sample <math alttext="{\bm{x}}_{t_{i-1}}\sim\mathcal{N}(\hat{{\bm{x}}}_{0}^{(N)},\sigma_{t_{i-1}}^{2%
}\bm{I})" class="ltx_Math" display="inline" id="alg4.l17.m1.3"><semantics id="alg4.l17.m1.3a"><mrow id="alg4.l17.m1.3.3" xref="alg4.l17.m1.3.3.cmml"><msub id="alg4.l17.m1.3.3.4" xref="alg4.l17.m1.3.3.4.cmml"><mi id="alg4.l17.m1.3.3.4.2" xref="alg4.l17.m1.3.3.4.2.cmml">𝒙</mi><msub id="alg4.l17.m1.3.3.4.3" xref="alg4.l17.m1.3.3.4.3.cmml"><mi id="alg4.l17.m1.3.3.4.3.2" xref="alg4.l17.m1.3.3.4.3.2.cmml">t</mi><mrow id="alg4.l17.m1.3.3.4.3.3" xref="alg4.l17.m1.3.3.4.3.3.cmml"><mi id="alg4.l17.m1.3.3.4.3.3.2" xref="alg4.l17.m1.3.3.4.3.3.2.cmml">i</mi><mo id="alg4.l17.m1.3.3.4.3.3.1" xref="alg4.l17.m1.3.3.4.3.3.1.cmml">−</mo><mn id="alg4.l17.m1.3.3.4.3.3.3" xref="alg4.l17.m1.3.3.4.3.3.3.cmml">1</mn></mrow></msub></msub><mo id="alg4.l17.m1.3.3.3" xref="alg4.l17.m1.3.3.3.cmml">∼</mo><mrow id="alg4.l17.m1.3.3.2" xref="alg4.l17.m1.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg4.l17.m1.3.3.2.4" xref="alg4.l17.m1.3.3.2.4.cmml">𝒩</mi><mo id="alg4.l17.m1.3.3.2.3" xref="alg4.l17.m1.3.3.2.3.cmml">⁢</mo><mrow id="alg4.l17.m1.3.3.2.2.2" xref="alg4.l17.m1.3.3.2.2.3.cmml"><mo id="alg4.l17.m1.3.3.2.2.2.3" stretchy="false" xref="alg4.l17.m1.3.3.2.2.3.cmml">(</mo><msubsup id="alg4.l17.m1.2.2.1.1.1.1" xref="alg4.l17.m1.2.2.1.1.1.1.cmml"><mover accent="true" id="alg4.l17.m1.2.2.1.1.1.1.2.2" xref="alg4.l17.m1.2.2.1.1.1.1.2.2.cmml"><mi id="alg4.l17.m1.2.2.1.1.1.1.2.2.2" xref="alg4.l17.m1.2.2.1.1.1.1.2.2.2.cmml">𝒙</mi><mo id="alg4.l17.m1.2.2.1.1.1.1.2.2.1" xref="alg4.l17.m1.2.2.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="alg4.l17.m1.2.2.1.1.1.1.2.3" xref="alg4.l17.m1.2.2.1.1.1.1.2.3.cmml">0</mn><mrow id="alg4.l17.m1.1.1.1.3" xref="alg4.l17.m1.2.2.1.1.1.1.cmml"><mo id="alg4.l17.m1.1.1.1.3.1" stretchy="false" xref="alg4.l17.m1.2.2.1.1.1.1.cmml">(</mo><mi id="alg4.l17.m1.1.1.1.1" xref="alg4.l17.m1.1.1.1.1.cmml">N</mi><mo id="alg4.l17.m1.1.1.1.3.2" stretchy="false" xref="alg4.l17.m1.2.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg4.l17.m1.3.3.2.2.2.4" xref="alg4.l17.m1.3.3.2.2.3.cmml">,</mo><mrow id="alg4.l17.m1.3.3.2.2.2.2" xref="alg4.l17.m1.3.3.2.2.2.2.cmml"><msubsup id="alg4.l17.m1.3.3.2.2.2.2.2" xref="alg4.l17.m1.3.3.2.2.2.2.2.cmml"><mi id="alg4.l17.m1.3.3.2.2.2.2.2.2.2" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.2.cmml">σ</mi><msub id="alg4.l17.m1.3.3.2.2.2.2.2.2.3" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.cmml"><mi id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.2" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.2.cmml">t</mi><mrow id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.cmml"><mi id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.2" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.2.cmml">i</mi><mo id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.1" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.1.cmml">−</mo><mn id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.3" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.3.cmml">1</mn></mrow></msub><mn id="alg4.l17.m1.3.3.2.2.2.2.2.3" xref="alg4.l17.m1.3.3.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="alg4.l17.m1.3.3.2.2.2.2.1" xref="alg4.l17.m1.3.3.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l17.m1.3.3.2.2.2.2.3" xref="alg4.l17.m1.3.3.2.2.2.2.3.cmml">𝑰</mi></mrow><mo id="alg4.l17.m1.3.3.2.2.2.5" stretchy="false" xref="alg4.l17.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l17.m1.3b"><apply id="alg4.l17.m1.3.3.cmml" xref="alg4.l17.m1.3.3"><csymbol cd="latexml" id="alg4.l17.m1.3.3.3.cmml" xref="alg4.l17.m1.3.3.3">similar-to</csymbol><apply id="alg4.l17.m1.3.3.4.cmml" xref="alg4.l17.m1.3.3.4"><csymbol cd="ambiguous" id="alg4.l17.m1.3.3.4.1.cmml" xref="alg4.l17.m1.3.3.4">subscript</csymbol><ci id="alg4.l17.m1.3.3.4.2.cmml" xref="alg4.l17.m1.3.3.4.2">𝒙</ci><apply id="alg4.l17.m1.3.3.4.3.cmml" xref="alg4.l17.m1.3.3.4.3"><csymbol cd="ambiguous" id="alg4.l17.m1.3.3.4.3.1.cmml" xref="alg4.l17.m1.3.3.4.3">subscript</csymbol><ci id="alg4.l17.m1.3.3.4.3.2.cmml" xref="alg4.l17.m1.3.3.4.3.2">𝑡</ci><apply id="alg4.l17.m1.3.3.4.3.3.cmml" xref="alg4.l17.m1.3.3.4.3.3"><minus id="alg4.l17.m1.3.3.4.3.3.1.cmml" xref="alg4.l17.m1.3.3.4.3.3.1"></minus><ci id="alg4.l17.m1.3.3.4.3.3.2.cmml" xref="alg4.l17.m1.3.3.4.3.3.2">𝑖</ci><cn id="alg4.l17.m1.3.3.4.3.3.3.cmml" type="integer" xref="alg4.l17.m1.3.3.4.3.3.3">1</cn></apply></apply></apply><apply id="alg4.l17.m1.3.3.2.cmml" xref="alg4.l17.m1.3.3.2"><times id="alg4.l17.m1.3.3.2.3.cmml" xref="alg4.l17.m1.3.3.2.3"></times><ci id="alg4.l17.m1.3.3.2.4.cmml" xref="alg4.l17.m1.3.3.2.4">𝒩</ci><interval closure="open" id="alg4.l17.m1.3.3.2.2.3.cmml" xref="alg4.l17.m1.3.3.2.2.2"><apply id="alg4.l17.m1.2.2.1.1.1.1.cmml" xref="alg4.l17.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l17.m1.2.2.1.1.1.1.1.cmml" xref="alg4.l17.m1.2.2.1.1.1.1">superscript</csymbol><apply id="alg4.l17.m1.2.2.1.1.1.1.2.cmml" xref="alg4.l17.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l17.m1.2.2.1.1.1.1.2.1.cmml" xref="alg4.l17.m1.2.2.1.1.1.1">subscript</csymbol><apply id="alg4.l17.m1.2.2.1.1.1.1.2.2.cmml" xref="alg4.l17.m1.2.2.1.1.1.1.2.2"><ci id="alg4.l17.m1.2.2.1.1.1.1.2.2.1.cmml" xref="alg4.l17.m1.2.2.1.1.1.1.2.2.1">^</ci><ci id="alg4.l17.m1.2.2.1.1.1.1.2.2.2.cmml" xref="alg4.l17.m1.2.2.1.1.1.1.2.2.2">𝒙</ci></apply><cn id="alg4.l17.m1.2.2.1.1.1.1.2.3.cmml" type="integer" xref="alg4.l17.m1.2.2.1.1.1.1.2.3">0</cn></apply><ci id="alg4.l17.m1.1.1.1.1.cmml" xref="alg4.l17.m1.1.1.1.1">𝑁</ci></apply><apply id="alg4.l17.m1.3.3.2.2.2.2.cmml" xref="alg4.l17.m1.3.3.2.2.2.2"><times id="alg4.l17.m1.3.3.2.2.2.2.1.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.1"></times><apply id="alg4.l17.m1.3.3.2.2.2.2.2.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg4.l17.m1.3.3.2.2.2.2.2.1.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2">superscript</csymbol><apply id="alg4.l17.m1.3.3.2.2.2.2.2.2.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg4.l17.m1.3.3.2.2.2.2.2.2.1.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="alg4.l17.m1.3.3.2.2.2.2.2.2.2.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.2">𝜎</ci><apply id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.1.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3">subscript</csymbol><ci id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.2.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.2">𝑡</ci><apply id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3"><minus id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.1.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.1"></minus><ci id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.2.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.2">𝑖</ci><cn id="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.3.cmml" type="integer" xref="alg4.l17.m1.3.3.2.2.2.2.2.2.3.3.3">1</cn></apply></apply></apply><cn id="alg4.l17.m1.3.3.2.2.2.2.2.3.cmml" type="integer" xref="alg4.l17.m1.3.3.2.2.2.2.2.3">2</cn></apply><ci id="alg4.l17.m1.3.3.2.2.2.2.3.cmml" xref="alg4.l17.m1.3.3.2.2.2.2.3">𝑰</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l17.m1.3c">{\bm{x}}_{t_{i-1}}\sim\mathcal{N}(\hat{{\bm{x}}}_{0}^{(N)},\sigma_{t_{i-1}}^{2%
}\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg4.l17.m1.3d">bold_italic_x start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∼ caligraphic_N ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT , italic_σ start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span><span class="ltx_text ltx_font_bold" id="alg4.l18.1">end</span> <span class="ltx_text ltx_font_bold" id="alg4.l18.2">for</span>
</div>
<div class="ltx_listingline" id="alg4.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span><span class="ltx_text ltx_font_bold" id="alg4.l19.1">return</span> <math alttext="{\bm{x}}_{0}" class="ltx_Math" display="inline" id="alg4.l19.m1.1"><semantics id="alg4.l19.m1.1a"><msub id="alg4.l19.m1.1.1" xref="alg4.l19.m1.1.1.cmml"><mi id="alg4.l19.m1.1.1.2" xref="alg4.l19.m1.1.1.2.cmml">𝒙</mi><mn id="alg4.l19.m1.1.1.3" xref="alg4.l19.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg4.l19.m1.1b"><apply id="alg4.l19.m1.1.1.cmml" xref="alg4.l19.m1.1.1"><csymbol cd="ambiguous" id="alg4.l19.m1.1.1.1.cmml" xref="alg4.l19.m1.1.1">subscript</csymbol><ci id="alg4.l19.m1.1.1.2.cmml" xref="alg4.l19.m1.1.1.2">𝒙</ci><cn id="alg4.l19.m1.1.1.3.cmml" type="integer" xref="alg4.l19.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l19.m1.1c">{\bm{x}}_{0}</annotation><annotation encoding="application/x-llamapun" id="alg4.l19.m1.1d">bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
</div>
</figure>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Proofs</h2>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">See <a class="ltx_ref" href="https://arxiv.org/html/2410.03463v1#S3.Thmproposition1" title="Proposition 1. ‣ 3 Diffusion State-Guided Projected Gradient (DiffStateGrad) ‣ Diffusion State-Guided Projected Gradient for Inverse Problems"><span class="ltx_text ltx_ref_tag">1</span></a></p>
</div>
<div class="ltx_proof" id="A4.16">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para ltx_noindent" id="A4.1.p1">
<p class="ltx_p" id="A4.1.p1.5">Let <math alttext="{\bm{z}}_{t}\in\mathcal{M}" class="ltx_Math" display="inline" id="A4.1.p1.1.m1.1"><semantics id="A4.1.p1.1.m1.1a"><mrow id="A4.1.p1.1.m1.1.1" xref="A4.1.p1.1.m1.1.1.cmml"><msub id="A4.1.p1.1.m1.1.1.2" xref="A4.1.p1.1.m1.1.1.2.cmml"><mi id="A4.1.p1.1.m1.1.1.2.2" xref="A4.1.p1.1.m1.1.1.2.2.cmml">𝒛</mi><mi id="A4.1.p1.1.m1.1.1.2.3" xref="A4.1.p1.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="A4.1.p1.1.m1.1.1.1" xref="A4.1.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A4.1.p1.1.m1.1.1.3" xref="A4.1.p1.1.m1.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.1.p1.1.m1.1b"><apply id="A4.1.p1.1.m1.1.1.cmml" xref="A4.1.p1.1.m1.1.1"><in id="A4.1.p1.1.m1.1.1.1.cmml" xref="A4.1.p1.1.m1.1.1.1"></in><apply id="A4.1.p1.1.m1.1.1.2.cmml" xref="A4.1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.1.p1.1.m1.1.1.2.1.cmml" xref="A4.1.p1.1.m1.1.1.2">subscript</csymbol><ci id="A4.1.p1.1.m1.1.1.2.2.cmml" xref="A4.1.p1.1.m1.1.1.2.2">𝒛</ci><ci id="A4.1.p1.1.m1.1.1.2.3.cmml" xref="A4.1.p1.1.m1.1.1.2.3">𝑡</ci></apply><ci id="A4.1.p1.1.m1.1.1.3.cmml" xref="A4.1.p1.1.m1.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.1.p1.1.m1.1c">{\bm{z}}_{t}\in\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.1.p1.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_M</annotation></semantics></math> and <math alttext="{\bm{g}}_{t}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="A4.1.p1.2.m2.1"><semantics id="A4.1.p1.2.m2.1a"><mrow id="A4.1.p1.2.m2.1.1" xref="A4.1.p1.2.m2.1.1.cmml"><msub id="A4.1.p1.2.m2.1.1.2" xref="A4.1.p1.2.m2.1.1.2.cmml"><mi id="A4.1.p1.2.m2.1.1.2.2" xref="A4.1.p1.2.m2.1.1.2.2.cmml">𝒈</mi><mi id="A4.1.p1.2.m2.1.1.2.3" xref="A4.1.p1.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="A4.1.p1.2.m2.1.1.1" xref="A4.1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="A4.1.p1.2.m2.1.1.3" xref="A4.1.p1.2.m2.1.1.3.cmml"><mi id="A4.1.p1.2.m2.1.1.3.2" xref="A4.1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="A4.1.p1.2.m2.1.1.3.3" xref="A4.1.p1.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.1.p1.2.m2.1b"><apply id="A4.1.p1.2.m2.1.1.cmml" xref="A4.1.p1.2.m2.1.1"><in id="A4.1.p1.2.m2.1.1.1.cmml" xref="A4.1.p1.2.m2.1.1.1"></in><apply id="A4.1.p1.2.m2.1.1.2.cmml" xref="A4.1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A4.1.p1.2.m2.1.1.2.1.cmml" xref="A4.1.p1.2.m2.1.1.2">subscript</csymbol><ci id="A4.1.p1.2.m2.1.1.2.2.cmml" xref="A4.1.p1.2.m2.1.1.2.2">𝒈</ci><ci id="A4.1.p1.2.m2.1.1.2.3.cmml" xref="A4.1.p1.2.m2.1.1.2.3">𝑡</ci></apply><apply id="A4.1.p1.2.m2.1.1.3.cmml" xref="A4.1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A4.1.p1.2.m2.1.1.3.1.cmml" xref="A4.1.p1.2.m2.1.1.3">superscript</csymbol><ci id="A4.1.p1.2.m2.1.1.3.2.cmml" xref="A4.1.p1.2.m2.1.1.3.2">ℝ</ci><ci id="A4.1.p1.2.m2.1.1.3.3.cmml" xref="A4.1.p1.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.1.p1.2.m2.1c">{\bm{g}}_{t}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="A4.1.p1.2.m2.1d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. Decompose the gradient <math alttext="{\bm{g}}_{t}" class="ltx_Math" display="inline" id="A4.1.p1.3.m3.1"><semantics id="A4.1.p1.3.m3.1a"><msub id="A4.1.p1.3.m3.1.1" xref="A4.1.p1.3.m3.1.1.cmml"><mi id="A4.1.p1.3.m3.1.1.2" xref="A4.1.p1.3.m3.1.1.2.cmml">𝒈</mi><mi id="A4.1.p1.3.m3.1.1.3" xref="A4.1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.1.p1.3.m3.1b"><apply id="A4.1.p1.3.m3.1.1.cmml" xref="A4.1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A4.1.p1.3.m3.1.1.1.cmml" xref="A4.1.p1.3.m3.1.1">subscript</csymbol><ci id="A4.1.p1.3.m3.1.1.2.cmml" xref="A4.1.p1.3.m3.1.1.2">𝒈</ci><ci id="A4.1.p1.3.m3.1.1.3.cmml" xref="A4.1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.1.p1.3.m3.1c">{\bm{g}}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.1.p1.3.m3.1d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> into components tangent and normal to <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="A4.1.p1.4.m4.1"><semantics id="A4.1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="A4.1.p1.4.m4.1.1" xref="A4.1.p1.4.m4.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="A4.1.p1.4.m4.1b"><ci id="A4.1.p1.4.m4.1.1.cmml" xref="A4.1.p1.4.m4.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.1.p1.4.m4.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.1.p1.4.m4.1d">caligraphic_M</annotation></semantics></math> at <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="A4.1.p1.5.m5.1"><semantics id="A4.1.p1.5.m5.1a"><msub id="A4.1.p1.5.m5.1.1" xref="A4.1.p1.5.m5.1.1.cmml"><mi id="A4.1.p1.5.m5.1.1.2" xref="A4.1.p1.5.m5.1.1.2.cmml">𝒛</mi><mi id="A4.1.p1.5.m5.1.1.3" xref="A4.1.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.1.p1.5.m5.1b"><apply id="A4.1.p1.5.m5.1.1.cmml" xref="A4.1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A4.1.p1.5.m5.1.1.1.cmml" xref="A4.1.p1.5.m5.1.1">subscript</csymbol><ci id="A4.1.p1.5.m5.1.1.2.cmml" xref="A4.1.p1.5.m5.1.1.2">𝒛</ci><ci id="A4.1.p1.5.m5.1.1.3.cmml" xref="A4.1.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.1.p1.5.m5.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.1.p1.5.m5.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{g}}_{t}={\bm{g}}_{t}^{\parallel}+{\bm{g}}_{t}^{\perp}," class="ltx_Math" display="block" id="A4.Ex1.m1.1"><semantics id="A4.Ex1.m1.1a"><mrow id="A4.Ex1.m1.1.1.1" xref="A4.Ex1.m1.1.1.1.1.cmml"><mrow id="A4.Ex1.m1.1.1.1.1" xref="A4.Ex1.m1.1.1.1.1.cmml"><msub id="A4.Ex1.m1.1.1.1.1.2" xref="A4.Ex1.m1.1.1.1.1.2.cmml"><mi id="A4.Ex1.m1.1.1.1.1.2.2" xref="A4.Ex1.m1.1.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.Ex1.m1.1.1.1.1.2.3" xref="A4.Ex1.m1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="A4.Ex1.m1.1.1.1.1.1" xref="A4.Ex1.m1.1.1.1.1.1.cmml">=</mo><mrow id="A4.Ex1.m1.1.1.1.1.3" xref="A4.Ex1.m1.1.1.1.1.3.cmml"><msubsup id="A4.Ex1.m1.1.1.1.1.3.2" xref="A4.Ex1.m1.1.1.1.1.3.2.cmml"><mi id="A4.Ex1.m1.1.1.1.1.3.2.2.2" xref="A4.Ex1.m1.1.1.1.1.3.2.2.2.cmml">𝒈</mi><mi id="A4.Ex1.m1.1.1.1.1.3.2.2.3" xref="A4.Ex1.m1.1.1.1.1.3.2.2.3.cmml">t</mi><mo id="A4.Ex1.m1.1.1.1.1.3.2.3" xref="A4.Ex1.m1.1.1.1.1.3.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex1.m1.1.1.1.1.3.1" xref="A4.Ex1.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="A4.Ex1.m1.1.1.1.1.3.3" xref="A4.Ex1.m1.1.1.1.1.3.3.cmml"><mi id="A4.Ex1.m1.1.1.1.1.3.3.2.2" xref="A4.Ex1.m1.1.1.1.1.3.3.2.2.cmml">𝒈</mi><mi id="A4.Ex1.m1.1.1.1.1.3.3.2.3" xref="A4.Ex1.m1.1.1.1.1.3.3.2.3.cmml">t</mi><mo id="A4.Ex1.m1.1.1.1.1.3.3.3" xref="A4.Ex1.m1.1.1.1.1.3.3.3.cmml">⟂</mo></msubsup></mrow></mrow><mo id="A4.Ex1.m1.1.1.1.2" xref="A4.Ex1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex1.m1.1b"><apply id="A4.Ex1.m1.1.1.1.1.cmml" xref="A4.Ex1.m1.1.1.1"><eq id="A4.Ex1.m1.1.1.1.1.1.cmml" xref="A4.Ex1.m1.1.1.1.1.1"></eq><apply id="A4.Ex1.m1.1.1.1.1.2.cmml" xref="A4.Ex1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex1.m1.1.1.1.1.2.1.cmml" xref="A4.Ex1.m1.1.1.1.1.2">subscript</csymbol><ci id="A4.Ex1.m1.1.1.1.1.2.2.cmml" xref="A4.Ex1.m1.1.1.1.1.2.2">𝒈</ci><ci id="A4.Ex1.m1.1.1.1.1.2.3.cmml" xref="A4.Ex1.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A4.Ex1.m1.1.1.1.1.3.cmml" xref="A4.Ex1.m1.1.1.1.1.3"><plus id="A4.Ex1.m1.1.1.1.1.3.1.cmml" xref="A4.Ex1.m1.1.1.1.1.3.1"></plus><apply id="A4.Ex1.m1.1.1.1.1.3.2.cmml" xref="A4.Ex1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A4.Ex1.m1.1.1.1.1.3.2.1.cmml" xref="A4.Ex1.m1.1.1.1.1.3.2">superscript</csymbol><apply id="A4.Ex1.m1.1.1.1.1.3.2.2.cmml" xref="A4.Ex1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A4.Ex1.m1.1.1.1.1.3.2.2.1.cmml" xref="A4.Ex1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="A4.Ex1.m1.1.1.1.1.3.2.2.2.cmml" xref="A4.Ex1.m1.1.1.1.1.3.2.2.2">𝒈</ci><ci id="A4.Ex1.m1.1.1.1.1.3.2.2.3.cmml" xref="A4.Ex1.m1.1.1.1.1.3.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex1.m1.1.1.1.1.3.2.3.cmml" xref="A4.Ex1.m1.1.1.1.1.3.2.3">parallel-to</csymbol></apply><apply id="A4.Ex1.m1.1.1.1.1.3.3.cmml" xref="A4.Ex1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.Ex1.m1.1.1.1.1.3.3.1.cmml" xref="A4.Ex1.m1.1.1.1.1.3.3">superscript</csymbol><apply id="A4.Ex1.m1.1.1.1.1.3.3.2.cmml" xref="A4.Ex1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.Ex1.m1.1.1.1.1.3.3.2.1.cmml" xref="A4.Ex1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="A4.Ex1.m1.1.1.1.1.3.3.2.2.cmml" xref="A4.Ex1.m1.1.1.1.1.3.3.2.2">𝒈</ci><ci id="A4.Ex1.m1.1.1.1.1.3.3.2.3.cmml" xref="A4.Ex1.m1.1.1.1.1.3.3.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex1.m1.1.1.1.1.3.3.3.cmml" xref="A4.Ex1.m1.1.1.1.1.3.3.3">perpendicular-to</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex1.m1.1c">{\bm{g}}_{t}={\bm{g}}_{t}^{\parallel}+{\bm{g}}_{t}^{\perp},</annotation><annotation encoding="application/x-llamapun" id="A4.Ex1.m1.1d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.1.p1.8">where <math alttext="{\bm{g}}_{t}^{\parallel}\in T_{{\bm{z}}_{t}}\mathcal{M}" class="ltx_Math" display="inline" id="A4.1.p1.6.m1.1"><semantics id="A4.1.p1.6.m1.1a"><mrow id="A4.1.p1.6.m1.1.1" xref="A4.1.p1.6.m1.1.1.cmml"><msubsup id="A4.1.p1.6.m1.1.1.2" xref="A4.1.p1.6.m1.1.1.2.cmml"><mi id="A4.1.p1.6.m1.1.1.2.2.2" xref="A4.1.p1.6.m1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.1.p1.6.m1.1.1.2.2.3" xref="A4.1.p1.6.m1.1.1.2.2.3.cmml">t</mi><mo id="A4.1.p1.6.m1.1.1.2.3" xref="A4.1.p1.6.m1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.1.p1.6.m1.1.1.1" xref="A4.1.p1.6.m1.1.1.1.cmml">∈</mo><mrow id="A4.1.p1.6.m1.1.1.3" xref="A4.1.p1.6.m1.1.1.3.cmml"><msub id="A4.1.p1.6.m1.1.1.3.2" xref="A4.1.p1.6.m1.1.1.3.2.cmml"><mi id="A4.1.p1.6.m1.1.1.3.2.2" xref="A4.1.p1.6.m1.1.1.3.2.2.cmml">T</mi><msub id="A4.1.p1.6.m1.1.1.3.2.3" xref="A4.1.p1.6.m1.1.1.3.2.3.cmml"><mi id="A4.1.p1.6.m1.1.1.3.2.3.2" xref="A4.1.p1.6.m1.1.1.3.2.3.2.cmml">𝒛</mi><mi id="A4.1.p1.6.m1.1.1.3.2.3.3" xref="A4.1.p1.6.m1.1.1.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.1.p1.6.m1.1.1.3.1" xref="A4.1.p1.6.m1.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.1.p1.6.m1.1.1.3.3" xref="A4.1.p1.6.m1.1.1.3.3.cmml">ℳ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.1.p1.6.m1.1b"><apply id="A4.1.p1.6.m1.1.1.cmml" xref="A4.1.p1.6.m1.1.1"><in id="A4.1.p1.6.m1.1.1.1.cmml" xref="A4.1.p1.6.m1.1.1.1"></in><apply id="A4.1.p1.6.m1.1.1.2.cmml" xref="A4.1.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="A4.1.p1.6.m1.1.1.2.1.cmml" xref="A4.1.p1.6.m1.1.1.2">superscript</csymbol><apply id="A4.1.p1.6.m1.1.1.2.2.cmml" xref="A4.1.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="A4.1.p1.6.m1.1.1.2.2.1.cmml" xref="A4.1.p1.6.m1.1.1.2">subscript</csymbol><ci id="A4.1.p1.6.m1.1.1.2.2.2.cmml" xref="A4.1.p1.6.m1.1.1.2.2.2">𝒈</ci><ci id="A4.1.p1.6.m1.1.1.2.2.3.cmml" xref="A4.1.p1.6.m1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.1.p1.6.m1.1.1.2.3.cmml" xref="A4.1.p1.6.m1.1.1.2.3">parallel-to</csymbol></apply><apply id="A4.1.p1.6.m1.1.1.3.cmml" xref="A4.1.p1.6.m1.1.1.3"><times id="A4.1.p1.6.m1.1.1.3.1.cmml" xref="A4.1.p1.6.m1.1.1.3.1"></times><apply id="A4.1.p1.6.m1.1.1.3.2.cmml" xref="A4.1.p1.6.m1.1.1.3.2"><csymbol cd="ambiguous" id="A4.1.p1.6.m1.1.1.3.2.1.cmml" xref="A4.1.p1.6.m1.1.1.3.2">subscript</csymbol><ci id="A4.1.p1.6.m1.1.1.3.2.2.cmml" xref="A4.1.p1.6.m1.1.1.3.2.2">𝑇</ci><apply id="A4.1.p1.6.m1.1.1.3.2.3.cmml" xref="A4.1.p1.6.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A4.1.p1.6.m1.1.1.3.2.3.1.cmml" xref="A4.1.p1.6.m1.1.1.3.2.3">subscript</csymbol><ci id="A4.1.p1.6.m1.1.1.3.2.3.2.cmml" xref="A4.1.p1.6.m1.1.1.3.2.3.2">𝒛</ci><ci id="A4.1.p1.6.m1.1.1.3.2.3.3.cmml" xref="A4.1.p1.6.m1.1.1.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.1.p1.6.m1.1.1.3.3.cmml" xref="A4.1.p1.6.m1.1.1.3.3">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.1.p1.6.m1.1c">{\bm{g}}_{t}^{\parallel}\in T_{{\bm{z}}_{t}}\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.1.p1.6.m1.1d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT ∈ italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M</annotation></semantics></math> and <math alttext="{\bm{g}}_{t}^{\perp}\in N_{{\bm{z}}_{t}}\mathcal{M}" class="ltx_Math" display="inline" id="A4.1.p1.7.m2.1"><semantics id="A4.1.p1.7.m2.1a"><mrow id="A4.1.p1.7.m2.1.1" xref="A4.1.p1.7.m2.1.1.cmml"><msubsup id="A4.1.p1.7.m2.1.1.2" xref="A4.1.p1.7.m2.1.1.2.cmml"><mi id="A4.1.p1.7.m2.1.1.2.2.2" xref="A4.1.p1.7.m2.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.1.p1.7.m2.1.1.2.2.3" xref="A4.1.p1.7.m2.1.1.2.2.3.cmml">t</mi><mo id="A4.1.p1.7.m2.1.1.2.3" xref="A4.1.p1.7.m2.1.1.2.3.cmml">⟂</mo></msubsup><mo id="A4.1.p1.7.m2.1.1.1" xref="A4.1.p1.7.m2.1.1.1.cmml">∈</mo><mrow id="A4.1.p1.7.m2.1.1.3" xref="A4.1.p1.7.m2.1.1.3.cmml"><msub id="A4.1.p1.7.m2.1.1.3.2" xref="A4.1.p1.7.m2.1.1.3.2.cmml"><mi id="A4.1.p1.7.m2.1.1.3.2.2" xref="A4.1.p1.7.m2.1.1.3.2.2.cmml">N</mi><msub id="A4.1.p1.7.m2.1.1.3.2.3" xref="A4.1.p1.7.m2.1.1.3.2.3.cmml"><mi id="A4.1.p1.7.m2.1.1.3.2.3.2" xref="A4.1.p1.7.m2.1.1.3.2.3.2.cmml">𝒛</mi><mi id="A4.1.p1.7.m2.1.1.3.2.3.3" xref="A4.1.p1.7.m2.1.1.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.1.p1.7.m2.1.1.3.1" xref="A4.1.p1.7.m2.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.1.p1.7.m2.1.1.3.3" xref="A4.1.p1.7.m2.1.1.3.3.cmml">ℳ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.1.p1.7.m2.1b"><apply id="A4.1.p1.7.m2.1.1.cmml" xref="A4.1.p1.7.m2.1.1"><in id="A4.1.p1.7.m2.1.1.1.cmml" xref="A4.1.p1.7.m2.1.1.1"></in><apply id="A4.1.p1.7.m2.1.1.2.cmml" xref="A4.1.p1.7.m2.1.1.2"><csymbol cd="ambiguous" id="A4.1.p1.7.m2.1.1.2.1.cmml" xref="A4.1.p1.7.m2.1.1.2">superscript</csymbol><apply id="A4.1.p1.7.m2.1.1.2.2.cmml" xref="A4.1.p1.7.m2.1.1.2"><csymbol cd="ambiguous" id="A4.1.p1.7.m2.1.1.2.2.1.cmml" xref="A4.1.p1.7.m2.1.1.2">subscript</csymbol><ci id="A4.1.p1.7.m2.1.1.2.2.2.cmml" xref="A4.1.p1.7.m2.1.1.2.2.2">𝒈</ci><ci id="A4.1.p1.7.m2.1.1.2.2.3.cmml" xref="A4.1.p1.7.m2.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.1.p1.7.m2.1.1.2.3.cmml" xref="A4.1.p1.7.m2.1.1.2.3">perpendicular-to</csymbol></apply><apply id="A4.1.p1.7.m2.1.1.3.cmml" xref="A4.1.p1.7.m2.1.1.3"><times id="A4.1.p1.7.m2.1.1.3.1.cmml" xref="A4.1.p1.7.m2.1.1.3.1"></times><apply id="A4.1.p1.7.m2.1.1.3.2.cmml" xref="A4.1.p1.7.m2.1.1.3.2"><csymbol cd="ambiguous" id="A4.1.p1.7.m2.1.1.3.2.1.cmml" xref="A4.1.p1.7.m2.1.1.3.2">subscript</csymbol><ci id="A4.1.p1.7.m2.1.1.3.2.2.cmml" xref="A4.1.p1.7.m2.1.1.3.2.2">𝑁</ci><apply id="A4.1.p1.7.m2.1.1.3.2.3.cmml" xref="A4.1.p1.7.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="A4.1.p1.7.m2.1.1.3.2.3.1.cmml" xref="A4.1.p1.7.m2.1.1.3.2.3">subscript</csymbol><ci id="A4.1.p1.7.m2.1.1.3.2.3.2.cmml" xref="A4.1.p1.7.m2.1.1.3.2.3.2">𝒛</ci><ci id="A4.1.p1.7.m2.1.1.3.2.3.3.cmml" xref="A4.1.p1.7.m2.1.1.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.1.p1.7.m2.1.1.3.3.cmml" xref="A4.1.p1.7.m2.1.1.3.3">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.1.p1.7.m2.1c">{\bm{g}}_{t}^{\perp}\in N_{{\bm{z}}_{t}}\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.1.p1.7.m2.1d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∈ italic_N start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M</annotation></semantics></math>, the normal space at <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="A4.1.p1.8.m3.1"><semantics id="A4.1.p1.8.m3.1a"><msub id="A4.1.p1.8.m3.1.1" xref="A4.1.p1.8.m3.1.1.cmml"><mi id="A4.1.p1.8.m3.1.1.2" xref="A4.1.p1.8.m3.1.1.2.cmml">𝒛</mi><mi id="A4.1.p1.8.m3.1.1.3" xref="A4.1.p1.8.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.1.p1.8.m3.1b"><apply id="A4.1.p1.8.m3.1.1.cmml" xref="A4.1.p1.8.m3.1.1"><csymbol cd="ambiguous" id="A4.1.p1.8.m3.1.1.1.cmml" xref="A4.1.p1.8.m3.1.1">subscript</csymbol><ci id="A4.1.p1.8.m3.1.1.2.cmml" xref="A4.1.p1.8.m3.1.1.2">𝒛</ci><ci id="A4.1.p1.8.m3.1.1.3.cmml" xref="A4.1.p1.8.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.1.p1.8.m3.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.1.p1.8.m3.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.2.p2">
<p class="ltx_p" id="A4.2.p2.1">We have two projection operators:</p>
<ul class="ltx_itemize" id="A4.I1">
<li class="ltx_item" id="A4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A4.I1.i1.p1">
<p class="ltx_p" id="A4.I1.i1.p1.2"><math alttext="\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}" class="ltx_Math" display="inline" id="A4.I1.i1.p1.1.m1.1"><semantics id="A4.I1.i1.p1.1.m1.1a"><msub id="A4.I1.i1.p1.1.m1.1.1" xref="A4.I1.i1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.I1.i1.p1.1.m1.1.1.2" xref="A4.I1.i1.p1.1.m1.1.1.2.cmml">𝒫</mi><mrow id="A4.I1.i1.p1.1.m1.1.1.3" xref="A4.I1.i1.p1.1.m1.1.1.3.cmml"><msub id="A4.I1.i1.p1.1.m1.1.1.3.2" xref="A4.I1.i1.p1.1.m1.1.1.3.2.cmml"><mi id="A4.I1.i1.p1.1.m1.1.1.3.2.2" xref="A4.I1.i1.p1.1.m1.1.1.3.2.2.cmml">T</mi><msub id="A4.I1.i1.p1.1.m1.1.1.3.2.3" xref="A4.I1.i1.p1.1.m1.1.1.3.2.3.cmml"><mi id="A4.I1.i1.p1.1.m1.1.1.3.2.3.2" xref="A4.I1.i1.p1.1.m1.1.1.3.2.3.2.cmml">𝒛</mi><mi id="A4.I1.i1.p1.1.m1.1.1.3.2.3.3" xref="A4.I1.i1.p1.1.m1.1.1.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.I1.i1.p1.1.m1.1.1.3.1" xref="A4.I1.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.I1.i1.p1.1.m1.1.1.3.3" xref="A4.I1.i1.p1.1.m1.1.1.3.3.cmml">ℳ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.I1.i1.p1.1.m1.1b"><apply id="A4.I1.i1.p1.1.m1.1.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.I1.i1.p1.1.m1.1.1.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="A4.I1.i1.p1.1.m1.1.1.2.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2">𝒫</ci><apply id="A4.I1.i1.p1.1.m1.1.1.3.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3"><times id="A4.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3.1"></times><apply id="A4.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A4.I1.i1.p1.1.m1.1.1.3.2.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="A4.I1.i1.p1.1.m1.1.1.3.2.2.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3.2.2">𝑇</ci><apply id="A4.I1.i1.p1.1.m1.1.1.3.2.3.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A4.I1.i1.p1.1.m1.1.1.3.2.3.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="A4.I1.i1.p1.1.m1.1.1.3.2.3.2.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3.2.3.2">𝒛</ci><ci id="A4.I1.i1.p1.1.m1.1.1.3.2.3.3.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3.3">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.I1.i1.p1.1.m1.1c">\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}</annotation><annotation encoding="application/x-llamapun" id="A4.I1.i1.p1.1.m1.1d">caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT</annotation></semantics></math>: the exact orthogonal projection onto the tangent space <math alttext="T_{{\bm{z}}_{t}}\mathcal{M}" class="ltx_Math" display="inline" id="A4.I1.i1.p1.2.m2.1"><semantics id="A4.I1.i1.p1.2.m2.1a"><mrow id="A4.I1.i1.p1.2.m2.1.1" xref="A4.I1.i1.p1.2.m2.1.1.cmml"><msub id="A4.I1.i1.p1.2.m2.1.1.2" xref="A4.I1.i1.p1.2.m2.1.1.2.cmml"><mi id="A4.I1.i1.p1.2.m2.1.1.2.2" xref="A4.I1.i1.p1.2.m2.1.1.2.2.cmml">T</mi><msub id="A4.I1.i1.p1.2.m2.1.1.2.3" xref="A4.I1.i1.p1.2.m2.1.1.2.3.cmml"><mi id="A4.I1.i1.p1.2.m2.1.1.2.3.2" xref="A4.I1.i1.p1.2.m2.1.1.2.3.2.cmml">𝒛</mi><mi id="A4.I1.i1.p1.2.m2.1.1.2.3.3" xref="A4.I1.i1.p1.2.m2.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="A4.I1.i1.p1.2.m2.1.1.1" xref="A4.I1.i1.p1.2.m2.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.I1.i1.p1.2.m2.1.1.3" xref="A4.I1.i1.p1.2.m2.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.I1.i1.p1.2.m2.1b"><apply id="A4.I1.i1.p1.2.m2.1.1.cmml" xref="A4.I1.i1.p1.2.m2.1.1"><times id="A4.I1.i1.p1.2.m2.1.1.1.cmml" xref="A4.I1.i1.p1.2.m2.1.1.1"></times><apply id="A4.I1.i1.p1.2.m2.1.1.2.cmml" xref="A4.I1.i1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A4.I1.i1.p1.2.m2.1.1.2.1.cmml" xref="A4.I1.i1.p1.2.m2.1.1.2">subscript</csymbol><ci id="A4.I1.i1.p1.2.m2.1.1.2.2.cmml" xref="A4.I1.i1.p1.2.m2.1.1.2.2">𝑇</ci><apply id="A4.I1.i1.p1.2.m2.1.1.2.3.cmml" xref="A4.I1.i1.p1.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="A4.I1.i1.p1.2.m2.1.1.2.3.1.cmml" xref="A4.I1.i1.p1.2.m2.1.1.2.3">subscript</csymbol><ci id="A4.I1.i1.p1.2.m2.1.1.2.3.2.cmml" xref="A4.I1.i1.p1.2.m2.1.1.2.3.2">𝒛</ci><ci id="A4.I1.i1.p1.2.m2.1.1.2.3.3.cmml" xref="A4.I1.i1.p1.2.m2.1.1.2.3.3">𝑡</ci></apply></apply><ci id="A4.I1.i1.p1.2.m2.1.1.3.cmml" xref="A4.I1.i1.p1.2.m2.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.I1.i1.p1.2.m2.1c">T_{{\bm{z}}_{t}}\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.I1.i1.p1.2.m2.1d">italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="A4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A4.I1.i2.p1">
<p class="ltx_p" id="A4.I1.i2.p1.3"><math alttext="\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}" class="ltx_Math" display="inline" id="A4.I1.i2.p1.1.m1.1"><semantics id="A4.I1.i2.p1.1.m1.1a"><msub id="A4.I1.i2.p1.1.m1.1.1" xref="A4.I1.i2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.I1.i2.p1.1.m1.1.1.2" xref="A4.I1.i2.p1.1.m1.1.1.2.cmml">𝒫</mi><msub id="A4.I1.i2.p1.1.m1.1.1.3" xref="A4.I1.i2.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.I1.i2.p1.1.m1.1.1.3.2" xref="A4.I1.i2.p1.1.m1.1.1.3.2.cmml">𝒮</mi><msub id="A4.I1.i2.p1.1.m1.1.1.3.3" xref="A4.I1.i2.p1.1.m1.1.1.3.3.cmml"><mi id="A4.I1.i2.p1.1.m1.1.1.3.3.2" xref="A4.I1.i2.p1.1.m1.1.1.3.3.2.cmml">𝒛</mi><mi id="A4.I1.i2.p1.1.m1.1.1.3.3.3" xref="A4.I1.i2.p1.1.m1.1.1.3.3.3.cmml">t</mi></msub></msub></msub><annotation-xml encoding="MathML-Content" id="A4.I1.i2.p1.1.m1.1b"><apply id="A4.I1.i2.p1.1.m1.1.1.cmml" xref="A4.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.I1.i2.p1.1.m1.1.1.1.cmml" xref="A4.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="A4.I1.i2.p1.1.m1.1.1.2.cmml" xref="A4.I1.i2.p1.1.m1.1.1.2">𝒫</ci><apply id="A4.I1.i2.p1.1.m1.1.1.3.cmml" xref="A4.I1.i2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A4.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="A4.I1.i2.p1.1.m1.1.1.3">subscript</csymbol><ci id="A4.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="A4.I1.i2.p1.1.m1.1.1.3.2">𝒮</ci><apply id="A4.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="A4.I1.i2.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A4.I1.i2.p1.1.m1.1.1.3.3.1.cmml" xref="A4.I1.i2.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="A4.I1.i2.p1.1.m1.1.1.3.3.2.cmml" xref="A4.I1.i2.p1.1.m1.1.1.3.3.2">𝒛</ci><ci id="A4.I1.i2.p1.1.m1.1.1.3.3.3.cmml" xref="A4.I1.i2.p1.1.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.I1.i2.p1.1.m1.1c">\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}</annotation><annotation encoding="application/x-llamapun" id="A4.I1.i2.p1.1.m1.1d">caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>: an approximate projection operator onto a subspace <math alttext="\mathcal{S}_{{\bm{z}}_{t}}" class="ltx_Math" display="inline" id="A4.I1.i2.p1.2.m2.1"><semantics id="A4.I1.i2.p1.2.m2.1a"><msub id="A4.I1.i2.p1.2.m2.1.1" xref="A4.I1.i2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.I1.i2.p1.2.m2.1.1.2" xref="A4.I1.i2.p1.2.m2.1.1.2.cmml">𝒮</mi><msub id="A4.I1.i2.p1.2.m2.1.1.3" xref="A4.I1.i2.p1.2.m2.1.1.3.cmml"><mi id="A4.I1.i2.p1.2.m2.1.1.3.2" xref="A4.I1.i2.p1.2.m2.1.1.3.2.cmml">𝒛</mi><mi id="A4.I1.i2.p1.2.m2.1.1.3.3" xref="A4.I1.i2.p1.2.m2.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="A4.I1.i2.p1.2.m2.1b"><apply id="A4.I1.i2.p1.2.m2.1.1.cmml" xref="A4.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A4.I1.i2.p1.2.m2.1.1.1.cmml" xref="A4.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="A4.I1.i2.p1.2.m2.1.1.2.cmml" xref="A4.I1.i2.p1.2.m2.1.1.2">𝒮</ci><apply id="A4.I1.i2.p1.2.m2.1.1.3.cmml" xref="A4.I1.i2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A4.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="A4.I1.i2.p1.2.m2.1.1.3">subscript</csymbol><ci id="A4.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="A4.I1.i2.p1.2.m2.1.1.3.2">𝒛</ci><ci id="A4.I1.i2.p1.2.m2.1.1.3.3.cmml" xref="A4.I1.i2.p1.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.I1.i2.p1.2.m2.1c">\mathcal{S}_{{\bm{z}}_{t}}</annotation><annotation encoding="application/x-llamapun" id="A4.I1.i2.p1.2.m2.1d">caligraphic_S start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> that closely approximates <math alttext="T_{{\bm{z}}_{t}}\mathcal{M}" class="ltx_Math" display="inline" id="A4.I1.i2.p1.3.m3.1"><semantics id="A4.I1.i2.p1.3.m3.1a"><mrow id="A4.I1.i2.p1.3.m3.1.1" xref="A4.I1.i2.p1.3.m3.1.1.cmml"><msub id="A4.I1.i2.p1.3.m3.1.1.2" xref="A4.I1.i2.p1.3.m3.1.1.2.cmml"><mi id="A4.I1.i2.p1.3.m3.1.1.2.2" xref="A4.I1.i2.p1.3.m3.1.1.2.2.cmml">T</mi><msub id="A4.I1.i2.p1.3.m3.1.1.2.3" xref="A4.I1.i2.p1.3.m3.1.1.2.3.cmml"><mi id="A4.I1.i2.p1.3.m3.1.1.2.3.2" xref="A4.I1.i2.p1.3.m3.1.1.2.3.2.cmml">𝒛</mi><mi id="A4.I1.i2.p1.3.m3.1.1.2.3.3" xref="A4.I1.i2.p1.3.m3.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="A4.I1.i2.p1.3.m3.1.1.1" xref="A4.I1.i2.p1.3.m3.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.I1.i2.p1.3.m3.1.1.3" xref="A4.I1.i2.p1.3.m3.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.I1.i2.p1.3.m3.1b"><apply id="A4.I1.i2.p1.3.m3.1.1.cmml" xref="A4.I1.i2.p1.3.m3.1.1"><times id="A4.I1.i2.p1.3.m3.1.1.1.cmml" xref="A4.I1.i2.p1.3.m3.1.1.1"></times><apply id="A4.I1.i2.p1.3.m3.1.1.2.cmml" xref="A4.I1.i2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A4.I1.i2.p1.3.m3.1.1.2.1.cmml" xref="A4.I1.i2.p1.3.m3.1.1.2">subscript</csymbol><ci id="A4.I1.i2.p1.3.m3.1.1.2.2.cmml" xref="A4.I1.i2.p1.3.m3.1.1.2.2">𝑇</ci><apply id="A4.I1.i2.p1.3.m3.1.1.2.3.cmml" xref="A4.I1.i2.p1.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="A4.I1.i2.p1.3.m3.1.1.2.3.1.cmml" xref="A4.I1.i2.p1.3.m3.1.1.2.3">subscript</csymbol><ci id="A4.I1.i2.p1.3.m3.1.1.2.3.2.cmml" xref="A4.I1.i2.p1.3.m3.1.1.2.3.2">𝒛</ci><ci id="A4.I1.i2.p1.3.m3.1.1.2.3.3.cmml" xref="A4.I1.i2.p1.3.m3.1.1.2.3.3">𝑡</ci></apply></apply><ci id="A4.I1.i2.p1.3.m3.1.1.3.cmml" xref="A4.I1.i2.p1.3.m3.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.I1.i2.p1.3.m3.1c">T_{{\bm{z}}_{t}}\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.I1.i2.p1.3.m3.1d">italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A4.3.p3">
<p class="ltx_p" id="A4.3.p3.2">Assuming that <math alttext="\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}" class="ltx_Math" display="inline" id="A4.3.p3.1.m1.1"><semantics id="A4.3.p3.1.m1.1a"><msub id="A4.3.p3.1.m1.1.1" xref="A4.3.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.3.p3.1.m1.1.1.2" xref="A4.3.p3.1.m1.1.1.2.cmml">𝒫</mi><msub id="A4.3.p3.1.m1.1.1.3" xref="A4.3.p3.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.3.p3.1.m1.1.1.3.2" xref="A4.3.p3.1.m1.1.1.3.2.cmml">𝒮</mi><msub id="A4.3.p3.1.m1.1.1.3.3" xref="A4.3.p3.1.m1.1.1.3.3.cmml"><mi id="A4.3.p3.1.m1.1.1.3.3.2" xref="A4.3.p3.1.m1.1.1.3.3.2.cmml">𝒛</mi><mi id="A4.3.p3.1.m1.1.1.3.3.3" xref="A4.3.p3.1.m1.1.1.3.3.3.cmml">t</mi></msub></msub></msub><annotation-xml encoding="MathML-Content" id="A4.3.p3.1.m1.1b"><apply id="A4.3.p3.1.m1.1.1.cmml" xref="A4.3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A4.3.p3.1.m1.1.1.1.cmml" xref="A4.3.p3.1.m1.1.1">subscript</csymbol><ci id="A4.3.p3.1.m1.1.1.2.cmml" xref="A4.3.p3.1.m1.1.1.2">𝒫</ci><apply id="A4.3.p3.1.m1.1.1.3.cmml" xref="A4.3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="A4.3.p3.1.m1.1.1.3.1.cmml" xref="A4.3.p3.1.m1.1.1.3">subscript</csymbol><ci id="A4.3.p3.1.m1.1.1.3.2.cmml" xref="A4.3.p3.1.m1.1.1.3.2">𝒮</ci><apply id="A4.3.p3.1.m1.1.1.3.3.cmml" xref="A4.3.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A4.3.p3.1.m1.1.1.3.3.1.cmml" xref="A4.3.p3.1.m1.1.1.3.3">subscript</csymbol><ci id="A4.3.p3.1.m1.1.1.3.3.2.cmml" xref="A4.3.p3.1.m1.1.1.3.3.2">𝒛</ci><ci id="A4.3.p3.1.m1.1.1.3.3.3.cmml" xref="A4.3.p3.1.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.3.p3.1.m1.1c">\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}</annotation><annotation encoding="application/x-llamapun" id="A4.3.p3.1.m1.1d">caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> approximates <math alttext="\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}" class="ltx_Math" display="inline" id="A4.3.p3.2.m2.1"><semantics id="A4.3.p3.2.m2.1a"><msub id="A4.3.p3.2.m2.1.1" xref="A4.3.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.3.p3.2.m2.1.1.2" xref="A4.3.p3.2.m2.1.1.2.cmml">𝒫</mi><mrow id="A4.3.p3.2.m2.1.1.3" xref="A4.3.p3.2.m2.1.1.3.cmml"><msub id="A4.3.p3.2.m2.1.1.3.2" xref="A4.3.p3.2.m2.1.1.3.2.cmml"><mi id="A4.3.p3.2.m2.1.1.3.2.2" xref="A4.3.p3.2.m2.1.1.3.2.2.cmml">T</mi><msub id="A4.3.p3.2.m2.1.1.3.2.3" xref="A4.3.p3.2.m2.1.1.3.2.3.cmml"><mi id="A4.3.p3.2.m2.1.1.3.2.3.2" xref="A4.3.p3.2.m2.1.1.3.2.3.2.cmml">𝒛</mi><mi id="A4.3.p3.2.m2.1.1.3.2.3.3" xref="A4.3.p3.2.m2.1.1.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.3.p3.2.m2.1.1.3.1" xref="A4.3.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.3.p3.2.m2.1.1.3.3" xref="A4.3.p3.2.m2.1.1.3.3.cmml">ℳ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.3.p3.2.m2.1b"><apply id="A4.3.p3.2.m2.1.1.cmml" xref="A4.3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A4.3.p3.2.m2.1.1.1.cmml" xref="A4.3.p3.2.m2.1.1">subscript</csymbol><ci id="A4.3.p3.2.m2.1.1.2.cmml" xref="A4.3.p3.2.m2.1.1.2">𝒫</ci><apply id="A4.3.p3.2.m2.1.1.3.cmml" xref="A4.3.p3.2.m2.1.1.3"><times id="A4.3.p3.2.m2.1.1.3.1.cmml" xref="A4.3.p3.2.m2.1.1.3.1"></times><apply id="A4.3.p3.2.m2.1.1.3.2.cmml" xref="A4.3.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="A4.3.p3.2.m2.1.1.3.2.1.cmml" xref="A4.3.p3.2.m2.1.1.3.2">subscript</csymbol><ci id="A4.3.p3.2.m2.1.1.3.2.2.cmml" xref="A4.3.p3.2.m2.1.1.3.2.2">𝑇</ci><apply id="A4.3.p3.2.m2.1.1.3.2.3.cmml" xref="A4.3.p3.2.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="A4.3.p3.2.m2.1.1.3.2.3.1.cmml" xref="A4.3.p3.2.m2.1.1.3.2.3">subscript</csymbol><ci id="A4.3.p3.2.m2.1.1.3.2.3.2.cmml" xref="A4.3.p3.2.m2.1.1.3.2.3.2">𝒛</ci><ci id="A4.3.p3.2.m2.1.1.3.2.3.3.cmml" xref="A4.3.p3.2.m2.1.1.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.3.p3.2.m2.1.1.3.3.cmml" xref="A4.3.p3.2.m2.1.1.3.3">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.3.p3.2.m2.1c">\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}</annotation><annotation encoding="application/x-llamapun" id="A4.3.p3.2.m2.1d">caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT</annotation></semantics></math>, we have:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}({\bm{g}}_{t})={\bm{g}}_{t}^{\parallel%
}+\bm{\epsilon}," class="ltx_Math" display="block" id="A4.Ex2.m1.1"><semantics id="A4.Ex2.m1.1a"><mrow id="A4.Ex2.m1.1.1.1" xref="A4.Ex2.m1.1.1.1.1.cmml"><mrow id="A4.Ex2.m1.1.1.1.1" xref="A4.Ex2.m1.1.1.1.1.cmml"><mrow id="A4.Ex2.m1.1.1.1.1.1" xref="A4.Ex2.m1.1.1.1.1.1.cmml"><msub id="A4.Ex2.m1.1.1.1.1.1.3" xref="A4.Ex2.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex2.m1.1.1.1.1.1.3.2" xref="A4.Ex2.m1.1.1.1.1.1.3.2.cmml">𝒫</mi><msub id="A4.Ex2.m1.1.1.1.1.1.3.3" xref="A4.Ex2.m1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex2.m1.1.1.1.1.1.3.3.2" xref="A4.Ex2.m1.1.1.1.1.1.3.3.2.cmml">𝒮</mi><msub id="A4.Ex2.m1.1.1.1.1.1.3.3.3" xref="A4.Ex2.m1.1.1.1.1.1.3.3.3.cmml"><mi id="A4.Ex2.m1.1.1.1.1.1.3.3.3.2" xref="A4.Ex2.m1.1.1.1.1.1.3.3.3.2.cmml">𝒛</mi><mi id="A4.Ex2.m1.1.1.1.1.1.3.3.3.3" xref="A4.Ex2.m1.1.1.1.1.1.3.3.3.3.cmml">t</mi></msub></msub></msub><mo id="A4.Ex2.m1.1.1.1.1.1.2" xref="A4.Ex2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex2.m1.1.1.1.1.1.1.1" xref="A4.Ex2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.Ex2.m1.1.1.1.1.1.1.1.1" xref="A4.Ex2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex2.m1.1.1.1.1.1.1.1.1.2" xref="A4.Ex2.m1.1.1.1.1.1.1.1.1.2.cmml">𝒈</mi><mi id="A4.Ex2.m1.1.1.1.1.1.1.1.1.3" xref="A4.Ex2.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A4.Ex2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.Ex2.m1.1.1.1.1.2" xref="A4.Ex2.m1.1.1.1.1.2.cmml">=</mo><mrow id="A4.Ex2.m1.1.1.1.1.3" xref="A4.Ex2.m1.1.1.1.1.3.cmml"><msubsup id="A4.Ex2.m1.1.1.1.1.3.2" xref="A4.Ex2.m1.1.1.1.1.3.2.cmml"><mi id="A4.Ex2.m1.1.1.1.1.3.2.2.2" xref="A4.Ex2.m1.1.1.1.1.3.2.2.2.cmml">𝒈</mi><mi id="A4.Ex2.m1.1.1.1.1.3.2.2.3" xref="A4.Ex2.m1.1.1.1.1.3.2.2.3.cmml">t</mi><mo id="A4.Ex2.m1.1.1.1.1.3.2.3" xref="A4.Ex2.m1.1.1.1.1.3.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex2.m1.1.1.1.1.3.1" xref="A4.Ex2.m1.1.1.1.1.3.1.cmml">+</mo><mi class="ltx_mathvariant_bold-italic" id="A4.Ex2.m1.1.1.1.1.3.3" mathvariant="bold-italic" xref="A4.Ex2.m1.1.1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="A4.Ex2.m1.1.1.1.2" xref="A4.Ex2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex2.m1.1b"><apply id="A4.Ex2.m1.1.1.1.1.cmml" xref="A4.Ex2.m1.1.1.1"><eq id="A4.Ex2.m1.1.1.1.1.2.cmml" xref="A4.Ex2.m1.1.1.1.1.2"></eq><apply id="A4.Ex2.m1.1.1.1.1.1.cmml" xref="A4.Ex2.m1.1.1.1.1.1"><times id="A4.Ex2.m1.1.1.1.1.1.2.cmml" xref="A4.Ex2.m1.1.1.1.1.1.2"></times><apply id="A4.Ex2.m1.1.1.1.1.1.3.cmml" xref="A4.Ex2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex2.m1.1.1.1.1.1.3.1.cmml" xref="A4.Ex2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex2.m1.1.1.1.1.1.3.2.cmml" xref="A4.Ex2.m1.1.1.1.1.1.3.2">𝒫</ci><apply id="A4.Ex2.m1.1.1.1.1.1.3.3.cmml" xref="A4.Ex2.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.Ex2.m1.1.1.1.1.1.3.3.1.cmml" xref="A4.Ex2.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A4.Ex2.m1.1.1.1.1.1.3.3.2.cmml" xref="A4.Ex2.m1.1.1.1.1.1.3.3.2">𝒮</ci><apply id="A4.Ex2.m1.1.1.1.1.1.3.3.3.cmml" xref="A4.Ex2.m1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A4.Ex2.m1.1.1.1.1.1.3.3.3.1.cmml" xref="A4.Ex2.m1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A4.Ex2.m1.1.1.1.1.1.3.3.3.2.cmml" xref="A4.Ex2.m1.1.1.1.1.1.3.3.3.2">𝒛</ci><ci id="A4.Ex2.m1.1.1.1.1.1.3.3.3.3.cmml" xref="A4.Ex2.m1.1.1.1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply><apply id="A4.Ex2.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex2.m1.1.1.1.1.1.1.1.1.2">𝒈</ci><ci id="A4.Ex2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex2.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="A4.Ex2.m1.1.1.1.1.3.cmml" xref="A4.Ex2.m1.1.1.1.1.3"><plus id="A4.Ex2.m1.1.1.1.1.3.1.cmml" xref="A4.Ex2.m1.1.1.1.1.3.1"></plus><apply id="A4.Ex2.m1.1.1.1.1.3.2.cmml" xref="A4.Ex2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A4.Ex2.m1.1.1.1.1.3.2.1.cmml" xref="A4.Ex2.m1.1.1.1.1.3.2">superscript</csymbol><apply id="A4.Ex2.m1.1.1.1.1.3.2.2.cmml" xref="A4.Ex2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A4.Ex2.m1.1.1.1.1.3.2.2.1.cmml" xref="A4.Ex2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="A4.Ex2.m1.1.1.1.1.3.2.2.2.cmml" xref="A4.Ex2.m1.1.1.1.1.3.2.2.2">𝒈</ci><ci id="A4.Ex2.m1.1.1.1.1.3.2.2.3.cmml" xref="A4.Ex2.m1.1.1.1.1.3.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex2.m1.1.1.1.1.3.2.3.cmml" xref="A4.Ex2.m1.1.1.1.1.3.2.3">parallel-to</csymbol></apply><ci id="A4.Ex2.m1.1.1.1.1.3.3.cmml" xref="A4.Ex2.m1.1.1.1.1.3.3">bold-italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex2.m1.1c">\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}({\bm{g}}_{t})={\bm{g}}_{t}^{\parallel%
}+\bm{\epsilon},</annotation><annotation encoding="application/x-llamapun" id="A4.Ex2.m1.1d">caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_ϵ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.3.p3.3">where <math alttext="\bm{\epsilon}=\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}({\bm{g}}_{t})-{\bm{g}}_%
{t}^{\parallel}" class="ltx_Math" display="inline" id="A4.3.p3.3.m1.1"><semantics id="A4.3.p3.3.m1.1a"><mrow id="A4.3.p3.3.m1.1.1" xref="A4.3.p3.3.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" id="A4.3.p3.3.m1.1.1.3" mathvariant="bold-italic" xref="A4.3.p3.3.m1.1.1.3.cmml">ϵ</mi><mo id="A4.3.p3.3.m1.1.1.2" xref="A4.3.p3.3.m1.1.1.2.cmml">=</mo><mrow id="A4.3.p3.3.m1.1.1.1" xref="A4.3.p3.3.m1.1.1.1.cmml"><mrow id="A4.3.p3.3.m1.1.1.1.1" xref="A4.3.p3.3.m1.1.1.1.1.cmml"><msub id="A4.3.p3.3.m1.1.1.1.1.3" xref="A4.3.p3.3.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.3.p3.3.m1.1.1.1.1.3.2" xref="A4.3.p3.3.m1.1.1.1.1.3.2.cmml">𝒫</mi><msub id="A4.3.p3.3.m1.1.1.1.1.3.3" xref="A4.3.p3.3.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.3.p3.3.m1.1.1.1.1.3.3.2" xref="A4.3.p3.3.m1.1.1.1.1.3.3.2.cmml">𝒮</mi><msub id="A4.3.p3.3.m1.1.1.1.1.3.3.3" xref="A4.3.p3.3.m1.1.1.1.1.3.3.3.cmml"><mi id="A4.3.p3.3.m1.1.1.1.1.3.3.3.2" xref="A4.3.p3.3.m1.1.1.1.1.3.3.3.2.cmml">𝒛</mi><mi id="A4.3.p3.3.m1.1.1.1.1.3.3.3.3" xref="A4.3.p3.3.m1.1.1.1.1.3.3.3.3.cmml">t</mi></msub></msub></msub><mo id="A4.3.p3.3.m1.1.1.1.1.2" xref="A4.3.p3.3.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.3.p3.3.m1.1.1.1.1.1.1" xref="A4.3.p3.3.m1.1.1.1.1.1.1.1.cmml"><mo id="A4.3.p3.3.m1.1.1.1.1.1.1.2" stretchy="false" xref="A4.3.p3.3.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.3.p3.3.m1.1.1.1.1.1.1.1" xref="A4.3.p3.3.m1.1.1.1.1.1.1.1.cmml"><mi id="A4.3.p3.3.m1.1.1.1.1.1.1.1.2" xref="A4.3.p3.3.m1.1.1.1.1.1.1.1.2.cmml">𝒈</mi><mi id="A4.3.p3.3.m1.1.1.1.1.1.1.1.3" xref="A4.3.p3.3.m1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A4.3.p3.3.m1.1.1.1.1.1.1.3" stretchy="false" xref="A4.3.p3.3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.3.p3.3.m1.1.1.1.2" xref="A4.3.p3.3.m1.1.1.1.2.cmml">−</mo><msubsup id="A4.3.p3.3.m1.1.1.1.3" xref="A4.3.p3.3.m1.1.1.1.3.cmml"><mi id="A4.3.p3.3.m1.1.1.1.3.2.2" xref="A4.3.p3.3.m1.1.1.1.3.2.2.cmml">𝒈</mi><mi id="A4.3.p3.3.m1.1.1.1.3.2.3" xref="A4.3.p3.3.m1.1.1.1.3.2.3.cmml">t</mi><mo id="A4.3.p3.3.m1.1.1.1.3.3" xref="A4.3.p3.3.m1.1.1.1.3.3.cmml">∥</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.3.p3.3.m1.1b"><apply id="A4.3.p3.3.m1.1.1.cmml" xref="A4.3.p3.3.m1.1.1"><eq id="A4.3.p3.3.m1.1.1.2.cmml" xref="A4.3.p3.3.m1.1.1.2"></eq><ci id="A4.3.p3.3.m1.1.1.3.cmml" xref="A4.3.p3.3.m1.1.1.3">bold-italic-ϵ</ci><apply id="A4.3.p3.3.m1.1.1.1.cmml" xref="A4.3.p3.3.m1.1.1.1"><minus id="A4.3.p3.3.m1.1.1.1.2.cmml" xref="A4.3.p3.3.m1.1.1.1.2"></minus><apply id="A4.3.p3.3.m1.1.1.1.1.cmml" xref="A4.3.p3.3.m1.1.1.1.1"><times id="A4.3.p3.3.m1.1.1.1.1.2.cmml" xref="A4.3.p3.3.m1.1.1.1.1.2"></times><apply id="A4.3.p3.3.m1.1.1.1.1.3.cmml" xref="A4.3.p3.3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.3.p3.3.m1.1.1.1.1.3.1.cmml" xref="A4.3.p3.3.m1.1.1.1.1.3">subscript</csymbol><ci id="A4.3.p3.3.m1.1.1.1.1.3.2.cmml" xref="A4.3.p3.3.m1.1.1.1.1.3.2">𝒫</ci><apply id="A4.3.p3.3.m1.1.1.1.1.3.3.cmml" xref="A4.3.p3.3.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.3.p3.3.m1.1.1.1.1.3.3.1.cmml" xref="A4.3.p3.3.m1.1.1.1.1.3.3">subscript</csymbol><ci id="A4.3.p3.3.m1.1.1.1.1.3.3.2.cmml" xref="A4.3.p3.3.m1.1.1.1.1.3.3.2">𝒮</ci><apply id="A4.3.p3.3.m1.1.1.1.1.3.3.3.cmml" xref="A4.3.p3.3.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A4.3.p3.3.m1.1.1.1.1.3.3.3.1.cmml" xref="A4.3.p3.3.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A4.3.p3.3.m1.1.1.1.1.3.3.3.2.cmml" xref="A4.3.p3.3.m1.1.1.1.1.3.3.3.2">𝒛</ci><ci id="A4.3.p3.3.m1.1.1.1.1.3.3.3.3.cmml" xref="A4.3.p3.3.m1.1.1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply><apply id="A4.3.p3.3.m1.1.1.1.1.1.1.1.cmml" xref="A4.3.p3.3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.3.p3.3.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.3.p3.3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.3.p3.3.m1.1.1.1.1.1.1.1.2.cmml" xref="A4.3.p3.3.m1.1.1.1.1.1.1.1.2">𝒈</ci><ci id="A4.3.p3.3.m1.1.1.1.1.1.1.1.3.cmml" xref="A4.3.p3.3.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="A4.3.p3.3.m1.1.1.1.3.cmml" xref="A4.3.p3.3.m1.1.1.1.3"><csymbol cd="ambiguous" id="A4.3.p3.3.m1.1.1.1.3.1.cmml" xref="A4.3.p3.3.m1.1.1.1.3">superscript</csymbol><apply id="A4.3.p3.3.m1.1.1.1.3.2.cmml" xref="A4.3.p3.3.m1.1.1.1.3"><csymbol cd="ambiguous" id="A4.3.p3.3.m1.1.1.1.3.2.1.cmml" xref="A4.3.p3.3.m1.1.1.1.3">subscript</csymbol><ci id="A4.3.p3.3.m1.1.1.1.3.2.2.cmml" xref="A4.3.p3.3.m1.1.1.1.3.2.2">𝒈</ci><ci id="A4.3.p3.3.m1.1.1.1.3.2.3.cmml" xref="A4.3.p3.3.m1.1.1.1.3.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.3.p3.3.m1.1.1.1.3.3.cmml" xref="A4.3.p3.3.m1.1.1.1.3.3">parallel-to</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.3.p3.3.m1.1c">\bm{\epsilon}=\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}({\bm{g}}_{t})-{\bm{g}}_%
{t}^{\parallel}</annotation><annotation encoding="application/x-llamapun" id="A4.3.p3.3.m1.1d">bold_italic_ϵ = caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT</annotation></semantics></math> is the approximation error, which is small.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.4.p4">
<p class="ltx_p" id="A4.4.p4.1">The standard update is:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{z}}_{t-1}={\bm{z}}_{t}-\eta{\bm{g}}_{t}={\bm{z}}_{t}-\eta({\bm{g}}_{t}^{%
\parallel}+{\bm{g}}_{t}^{\perp})." class="ltx_Math" display="block" id="A4.Ex3.m1.1"><semantics id="A4.Ex3.m1.1a"><mrow id="A4.Ex3.m1.1.1.1" xref="A4.Ex3.m1.1.1.1.1.cmml"><mrow id="A4.Ex3.m1.1.1.1.1" xref="A4.Ex3.m1.1.1.1.1.cmml"><msub id="A4.Ex3.m1.1.1.1.1.3" xref="A4.Ex3.m1.1.1.1.1.3.cmml"><mi id="A4.Ex3.m1.1.1.1.1.3.2" xref="A4.Ex3.m1.1.1.1.1.3.2.cmml">𝒛</mi><mrow id="A4.Ex3.m1.1.1.1.1.3.3" xref="A4.Ex3.m1.1.1.1.1.3.3.cmml"><mi id="A4.Ex3.m1.1.1.1.1.3.3.2" xref="A4.Ex3.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="A4.Ex3.m1.1.1.1.1.3.3.1" xref="A4.Ex3.m1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A4.Ex3.m1.1.1.1.1.3.3.3" xref="A4.Ex3.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="A4.Ex3.m1.1.1.1.1.4" xref="A4.Ex3.m1.1.1.1.1.4.cmml">=</mo><mrow id="A4.Ex3.m1.1.1.1.1.5" xref="A4.Ex3.m1.1.1.1.1.5.cmml"><msub id="A4.Ex3.m1.1.1.1.1.5.2" xref="A4.Ex3.m1.1.1.1.1.5.2.cmml"><mi id="A4.Ex3.m1.1.1.1.1.5.2.2" xref="A4.Ex3.m1.1.1.1.1.5.2.2.cmml">𝒛</mi><mi id="A4.Ex3.m1.1.1.1.1.5.2.3" xref="A4.Ex3.m1.1.1.1.1.5.2.3.cmml">t</mi></msub><mo id="A4.Ex3.m1.1.1.1.1.5.1" xref="A4.Ex3.m1.1.1.1.1.5.1.cmml">−</mo><mrow id="A4.Ex3.m1.1.1.1.1.5.3" xref="A4.Ex3.m1.1.1.1.1.5.3.cmml"><mi id="A4.Ex3.m1.1.1.1.1.5.3.2" xref="A4.Ex3.m1.1.1.1.1.5.3.2.cmml">η</mi><mo id="A4.Ex3.m1.1.1.1.1.5.3.1" xref="A4.Ex3.m1.1.1.1.1.5.3.1.cmml">⁢</mo><msub id="A4.Ex3.m1.1.1.1.1.5.3.3" xref="A4.Ex3.m1.1.1.1.1.5.3.3.cmml"><mi id="A4.Ex3.m1.1.1.1.1.5.3.3.2" xref="A4.Ex3.m1.1.1.1.1.5.3.3.2.cmml">𝒈</mi><mi id="A4.Ex3.m1.1.1.1.1.5.3.3.3" xref="A4.Ex3.m1.1.1.1.1.5.3.3.3.cmml">t</mi></msub></mrow></mrow><mo id="A4.Ex3.m1.1.1.1.1.6" xref="A4.Ex3.m1.1.1.1.1.6.cmml">=</mo><mrow id="A4.Ex3.m1.1.1.1.1.1" xref="A4.Ex3.m1.1.1.1.1.1.cmml"><msub id="A4.Ex3.m1.1.1.1.1.1.3" xref="A4.Ex3.m1.1.1.1.1.1.3.cmml"><mi id="A4.Ex3.m1.1.1.1.1.1.3.2" xref="A4.Ex3.m1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="A4.Ex3.m1.1.1.1.1.1.3.3" xref="A4.Ex3.m1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A4.Ex3.m1.1.1.1.1.1.2" xref="A4.Ex3.m1.1.1.1.1.1.2.cmml">−</mo><mrow id="A4.Ex3.m1.1.1.1.1.1.1" xref="A4.Ex3.m1.1.1.1.1.1.1.cmml"><mi id="A4.Ex3.m1.1.1.1.1.1.1.3" xref="A4.Ex3.m1.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex3.m1.1.1.1.1.1.1.2" xref="A4.Ex3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex3.m1.1.1.1.1.1.1.1.1" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex3.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mo id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒈</mi><mi id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mo id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">⟂</mo></msubsup></mrow><mo id="A4.Ex3.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A4.Ex3.m1.1.1.1.2" lspace="0em" xref="A4.Ex3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex3.m1.1b"><apply id="A4.Ex3.m1.1.1.1.1.cmml" xref="A4.Ex3.m1.1.1.1"><and id="A4.Ex3.m1.1.1.1.1a.cmml" xref="A4.Ex3.m1.1.1.1"></and><apply id="A4.Ex3.m1.1.1.1.1b.cmml" xref="A4.Ex3.m1.1.1.1"><eq id="A4.Ex3.m1.1.1.1.1.4.cmml" xref="A4.Ex3.m1.1.1.1.1.4"></eq><apply id="A4.Ex3.m1.1.1.1.1.3.cmml" xref="A4.Ex3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex3.m1.1.1.1.1.3.1.cmml" xref="A4.Ex3.m1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex3.m1.1.1.1.1.3.2.cmml" xref="A4.Ex3.m1.1.1.1.1.3.2">𝒛</ci><apply id="A4.Ex3.m1.1.1.1.1.3.3.cmml" xref="A4.Ex3.m1.1.1.1.1.3.3"><minus id="A4.Ex3.m1.1.1.1.1.3.3.1.cmml" xref="A4.Ex3.m1.1.1.1.1.3.3.1"></minus><ci id="A4.Ex3.m1.1.1.1.1.3.3.2.cmml" xref="A4.Ex3.m1.1.1.1.1.3.3.2">𝑡</ci><cn id="A4.Ex3.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="A4.Ex3.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="A4.Ex3.m1.1.1.1.1.5.cmml" xref="A4.Ex3.m1.1.1.1.1.5"><minus id="A4.Ex3.m1.1.1.1.1.5.1.cmml" xref="A4.Ex3.m1.1.1.1.1.5.1"></minus><apply id="A4.Ex3.m1.1.1.1.1.5.2.cmml" xref="A4.Ex3.m1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="A4.Ex3.m1.1.1.1.1.5.2.1.cmml" xref="A4.Ex3.m1.1.1.1.1.5.2">subscript</csymbol><ci id="A4.Ex3.m1.1.1.1.1.5.2.2.cmml" xref="A4.Ex3.m1.1.1.1.1.5.2.2">𝒛</ci><ci id="A4.Ex3.m1.1.1.1.1.5.2.3.cmml" xref="A4.Ex3.m1.1.1.1.1.5.2.3">𝑡</ci></apply><apply id="A4.Ex3.m1.1.1.1.1.5.3.cmml" xref="A4.Ex3.m1.1.1.1.1.5.3"><times id="A4.Ex3.m1.1.1.1.1.5.3.1.cmml" xref="A4.Ex3.m1.1.1.1.1.5.3.1"></times><ci id="A4.Ex3.m1.1.1.1.1.5.3.2.cmml" xref="A4.Ex3.m1.1.1.1.1.5.3.2">𝜂</ci><apply id="A4.Ex3.m1.1.1.1.1.5.3.3.cmml" xref="A4.Ex3.m1.1.1.1.1.5.3.3"><csymbol cd="ambiguous" id="A4.Ex3.m1.1.1.1.1.5.3.3.1.cmml" xref="A4.Ex3.m1.1.1.1.1.5.3.3">subscript</csymbol><ci id="A4.Ex3.m1.1.1.1.1.5.3.3.2.cmml" xref="A4.Ex3.m1.1.1.1.1.5.3.3.2">𝒈</ci><ci id="A4.Ex3.m1.1.1.1.1.5.3.3.3.cmml" xref="A4.Ex3.m1.1.1.1.1.5.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="A4.Ex3.m1.1.1.1.1c.cmml" xref="A4.Ex3.m1.1.1.1"><eq id="A4.Ex3.m1.1.1.1.1.6.cmml" xref="A4.Ex3.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2410.03463v1#A4.Ex3.m1.1.1.1.1.5.cmml" id="A4.Ex3.m1.1.1.1.1d.cmml" xref="A4.Ex3.m1.1.1.1"></share><apply id="A4.Ex3.m1.1.1.1.1.1.cmml" xref="A4.Ex3.m1.1.1.1.1.1"><minus id="A4.Ex3.m1.1.1.1.1.1.2.cmml" xref="A4.Ex3.m1.1.1.1.1.1.2"></minus><apply id="A4.Ex3.m1.1.1.1.1.1.3.cmml" xref="A4.Ex3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex3.m1.1.1.1.1.1.3.1.cmml" xref="A4.Ex3.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex3.m1.1.1.1.1.1.3.2.cmml" xref="A4.Ex3.m1.1.1.1.1.1.3.2">𝒛</ci><ci id="A4.Ex3.m1.1.1.1.1.1.3.3.cmml" xref="A4.Ex3.m1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A4.Ex3.m1.1.1.1.1.1.1.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1"><times id="A4.Ex3.m1.1.1.1.1.1.1.2.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.2"></times><ci id="A4.Ex3.m1.1.1.1.1.1.1.3.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1"><plus id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝒈</ci><ci id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.2.3">parallel-to</csymbol></apply><apply id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝒈</ci><ci id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3">perpendicular-to</csymbol></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex3.m1.1c">{\bm{z}}_{t-1}={\bm{z}}_{t}-\eta{\bm{g}}_{t}={\bm{z}}_{t}-\eta({\bm{g}}_{t}^{%
\parallel}+{\bm{g}}_{t}^{\perp}).</annotation><annotation encoding="application/x-llamapun" id="A4.Ex3.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT = bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_η bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_η ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A4.5.p5">
<p class="ltx_p" id="A4.5.p5.1">The projected update is:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{z}}_{t-1}^{\prime}={\bm{z}}_{t}-\eta\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t%
}}}({\bm{g}}_{t})={\bm{z}}_{t}-\eta({\bm{g}}_{t}^{\parallel}+\bm{\epsilon})." class="ltx_Math" display="block" id="A4.Ex4.m1.1"><semantics id="A4.Ex4.m1.1a"><mrow id="A4.Ex4.m1.1.1.1" xref="A4.Ex4.m1.1.1.1.1.cmml"><mrow id="A4.Ex4.m1.1.1.1.1" xref="A4.Ex4.m1.1.1.1.1.cmml"><msubsup id="A4.Ex4.m1.1.1.1.1.4" xref="A4.Ex4.m1.1.1.1.1.4.cmml"><mi id="A4.Ex4.m1.1.1.1.1.4.2.2" xref="A4.Ex4.m1.1.1.1.1.4.2.2.cmml">𝒛</mi><mrow id="A4.Ex4.m1.1.1.1.1.4.2.3" xref="A4.Ex4.m1.1.1.1.1.4.2.3.cmml"><mi id="A4.Ex4.m1.1.1.1.1.4.2.3.2" xref="A4.Ex4.m1.1.1.1.1.4.2.3.2.cmml">t</mi><mo id="A4.Ex4.m1.1.1.1.1.4.2.3.1" xref="A4.Ex4.m1.1.1.1.1.4.2.3.1.cmml">−</mo><mn id="A4.Ex4.m1.1.1.1.1.4.2.3.3" xref="A4.Ex4.m1.1.1.1.1.4.2.3.3.cmml">1</mn></mrow><mo id="A4.Ex4.m1.1.1.1.1.4.3" xref="A4.Ex4.m1.1.1.1.1.4.3.cmml">′</mo></msubsup><mo id="A4.Ex4.m1.1.1.1.1.5" xref="A4.Ex4.m1.1.1.1.1.5.cmml">=</mo><mrow id="A4.Ex4.m1.1.1.1.1.1" xref="A4.Ex4.m1.1.1.1.1.1.cmml"><msub id="A4.Ex4.m1.1.1.1.1.1.3" xref="A4.Ex4.m1.1.1.1.1.1.3.cmml"><mi id="A4.Ex4.m1.1.1.1.1.1.3.2" xref="A4.Ex4.m1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="A4.Ex4.m1.1.1.1.1.1.3.3" xref="A4.Ex4.m1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A4.Ex4.m1.1.1.1.1.1.2" xref="A4.Ex4.m1.1.1.1.1.1.2.cmml">−</mo><mrow id="A4.Ex4.m1.1.1.1.1.1.1" xref="A4.Ex4.m1.1.1.1.1.1.1.cmml"><mi id="A4.Ex4.m1.1.1.1.1.1.1.3" xref="A4.Ex4.m1.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex4.m1.1.1.1.1.1.1.2" xref="A4.Ex4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="A4.Ex4.m1.1.1.1.1.1.1.4" xref="A4.Ex4.m1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex4.m1.1.1.1.1.1.1.4.2" xref="A4.Ex4.m1.1.1.1.1.1.1.4.2.cmml">𝒫</mi><msub id="A4.Ex4.m1.1.1.1.1.1.1.4.3" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex4.m1.1.1.1.1.1.1.4.3.2" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3.2.cmml">𝒮</mi><msub id="A4.Ex4.m1.1.1.1.1.1.1.4.3.3" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.cmml"><mi id="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.2" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.2.cmml">𝒛</mi><mi id="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.3" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.3.cmml">t</mi></msub></msub></msub><mo id="A4.Ex4.m1.1.1.1.1.1.1.2a" xref="A4.Ex4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex4.m1.1.1.1.1.1.1.1.1" xref="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex4.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.Ex4.m1.1.1.1.1.1.1.1.1.1" xref="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒈</mi><mi id="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A4.Ex4.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex4.m1.1.1.1.1.6" xref="A4.Ex4.m1.1.1.1.1.6.cmml">=</mo><mrow id="A4.Ex4.m1.1.1.1.1.2" xref="A4.Ex4.m1.1.1.1.1.2.cmml"><msub id="A4.Ex4.m1.1.1.1.1.2.3" xref="A4.Ex4.m1.1.1.1.1.2.3.cmml"><mi id="A4.Ex4.m1.1.1.1.1.2.3.2" xref="A4.Ex4.m1.1.1.1.1.2.3.2.cmml">𝒛</mi><mi id="A4.Ex4.m1.1.1.1.1.2.3.3" xref="A4.Ex4.m1.1.1.1.1.2.3.3.cmml">t</mi></msub><mo id="A4.Ex4.m1.1.1.1.1.2.2" xref="A4.Ex4.m1.1.1.1.1.2.2.cmml">−</mo><mrow id="A4.Ex4.m1.1.1.1.1.2.1" xref="A4.Ex4.m1.1.1.1.1.2.1.cmml"><mi id="A4.Ex4.m1.1.1.1.1.2.1.3" xref="A4.Ex4.m1.1.1.1.1.2.1.3.cmml">η</mi><mo id="A4.Ex4.m1.1.1.1.1.2.1.2" xref="A4.Ex4.m1.1.1.1.1.2.1.2.cmml">⁢</mo><mrow id="A4.Ex4.m1.1.1.1.1.2.1.1.1" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.cmml"><mo id="A4.Ex4.m1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.cmml"><msubsup id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.cmml"><mi id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.2.2" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.2.3" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml">t</mi><mo id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.3" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.1" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.1.cmml">+</mo><mi class="ltx_mathvariant_bold-italic" id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.3" mathvariant="bold-italic" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="A4.Ex4.m1.1.1.1.1.2.1.1.1.3" stretchy="false" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A4.Ex4.m1.1.1.1.2" lspace="0em" xref="A4.Ex4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex4.m1.1b"><apply id="A4.Ex4.m1.1.1.1.1.cmml" xref="A4.Ex4.m1.1.1.1"><and id="A4.Ex4.m1.1.1.1.1a.cmml" xref="A4.Ex4.m1.1.1.1"></and><apply id="A4.Ex4.m1.1.1.1.1b.cmml" xref="A4.Ex4.m1.1.1.1"><eq id="A4.Ex4.m1.1.1.1.1.5.cmml" xref="A4.Ex4.m1.1.1.1.1.5"></eq><apply id="A4.Ex4.m1.1.1.1.1.4.cmml" xref="A4.Ex4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="A4.Ex4.m1.1.1.1.1.4.1.cmml" xref="A4.Ex4.m1.1.1.1.1.4">superscript</csymbol><apply id="A4.Ex4.m1.1.1.1.1.4.2.cmml" xref="A4.Ex4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="A4.Ex4.m1.1.1.1.1.4.2.1.cmml" xref="A4.Ex4.m1.1.1.1.1.4">subscript</csymbol><ci id="A4.Ex4.m1.1.1.1.1.4.2.2.cmml" xref="A4.Ex4.m1.1.1.1.1.4.2.2">𝒛</ci><apply id="A4.Ex4.m1.1.1.1.1.4.2.3.cmml" xref="A4.Ex4.m1.1.1.1.1.4.2.3"><minus id="A4.Ex4.m1.1.1.1.1.4.2.3.1.cmml" xref="A4.Ex4.m1.1.1.1.1.4.2.3.1"></minus><ci id="A4.Ex4.m1.1.1.1.1.4.2.3.2.cmml" xref="A4.Ex4.m1.1.1.1.1.4.2.3.2">𝑡</ci><cn id="A4.Ex4.m1.1.1.1.1.4.2.3.3.cmml" type="integer" xref="A4.Ex4.m1.1.1.1.1.4.2.3.3">1</cn></apply></apply><ci id="A4.Ex4.m1.1.1.1.1.4.3.cmml" xref="A4.Ex4.m1.1.1.1.1.4.3">′</ci></apply><apply id="A4.Ex4.m1.1.1.1.1.1.cmml" xref="A4.Ex4.m1.1.1.1.1.1"><minus id="A4.Ex4.m1.1.1.1.1.1.2.cmml" xref="A4.Ex4.m1.1.1.1.1.1.2"></minus><apply id="A4.Ex4.m1.1.1.1.1.1.3.cmml" xref="A4.Ex4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex4.m1.1.1.1.1.1.3.1.cmml" xref="A4.Ex4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex4.m1.1.1.1.1.1.3.2.cmml" xref="A4.Ex4.m1.1.1.1.1.1.3.2">𝒛</ci><ci id="A4.Ex4.m1.1.1.1.1.1.3.3.cmml" xref="A4.Ex4.m1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A4.Ex4.m1.1.1.1.1.1.1.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1"><times id="A4.Ex4.m1.1.1.1.1.1.1.2.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.2"></times><ci id="A4.Ex4.m1.1.1.1.1.1.1.3.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex4.m1.1.1.1.1.1.1.4.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A4.Ex4.m1.1.1.1.1.1.1.4.1.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A4.Ex4.m1.1.1.1.1.1.1.4.2.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.4.2">𝒫</ci><apply id="A4.Ex4.m1.1.1.1.1.1.1.4.3.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="A4.Ex4.m1.1.1.1.1.1.1.4.3.1.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="A4.Ex4.m1.1.1.1.1.1.1.4.3.2.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3.2">𝒮</ci><apply id="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.1.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3.3">subscript</csymbol><ci id="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.2.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.2">𝒛</ci><ci id="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.3.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.4.3.3.3">𝑡</ci></apply></apply></apply><apply id="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.2">𝒈</ci><ci id="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex4.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply><apply id="A4.Ex4.m1.1.1.1.1c.cmml" xref="A4.Ex4.m1.1.1.1"><eq id="A4.Ex4.m1.1.1.1.1.6.cmml" xref="A4.Ex4.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2410.03463v1#A4.Ex4.m1.1.1.1.1.1.cmml" id="A4.Ex4.m1.1.1.1.1d.cmml" xref="A4.Ex4.m1.1.1.1"></share><apply id="A4.Ex4.m1.1.1.1.1.2.cmml" xref="A4.Ex4.m1.1.1.1.1.2"><minus id="A4.Ex4.m1.1.1.1.1.2.2.cmml" xref="A4.Ex4.m1.1.1.1.1.2.2"></minus><apply id="A4.Ex4.m1.1.1.1.1.2.3.cmml" xref="A4.Ex4.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A4.Ex4.m1.1.1.1.1.2.3.1.cmml" xref="A4.Ex4.m1.1.1.1.1.2.3">subscript</csymbol><ci id="A4.Ex4.m1.1.1.1.1.2.3.2.cmml" xref="A4.Ex4.m1.1.1.1.1.2.3.2">𝒛</ci><ci id="A4.Ex4.m1.1.1.1.1.2.3.3.cmml" xref="A4.Ex4.m1.1.1.1.1.2.3.3">𝑡</ci></apply><apply id="A4.Ex4.m1.1.1.1.1.2.1.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1"><times id="A4.Ex4.m1.1.1.1.1.2.1.2.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.2"></times><ci id="A4.Ex4.m1.1.1.1.1.2.1.3.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.3">𝜂</ci><apply id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1"><plus id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.1"></plus><apply id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2">superscript</csymbol><apply id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.2.1.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.2.2.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.2.2">𝒈</ci><ci id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.2.3">parallel-to</csymbol></apply><ci id="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="A4.Ex4.m1.1.1.1.1.2.1.1.1.1.3">bold-italic-ϵ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex4.m1.1c">{\bm{z}}_{t-1}^{\prime}={\bm{z}}_{t}-\eta\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t%
}}}({\bm{g}}_{t})={\bm{z}}_{t}-\eta({\bm{g}}_{t}^{\parallel}+\bm{\epsilon}).</annotation><annotation encoding="application/x-llamapun" id="A4.Ex4.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_η caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_η ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_ϵ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A4.6.p6">
<p class="ltx_p" id="A4.6.p6.7">Let <math alttext="\pi({\bm{z}})" class="ltx_Math" display="inline" id="A4.6.p6.1.m1.1"><semantics id="A4.6.p6.1.m1.1a"><mrow id="A4.6.p6.1.m1.1.2" xref="A4.6.p6.1.m1.1.2.cmml"><mi id="A4.6.p6.1.m1.1.2.2" xref="A4.6.p6.1.m1.1.2.2.cmml">π</mi><mo id="A4.6.p6.1.m1.1.2.1" xref="A4.6.p6.1.m1.1.2.1.cmml">⁢</mo><mrow id="A4.6.p6.1.m1.1.2.3.2" xref="A4.6.p6.1.m1.1.2.cmml"><mo id="A4.6.p6.1.m1.1.2.3.2.1" stretchy="false" xref="A4.6.p6.1.m1.1.2.cmml">(</mo><mi id="A4.6.p6.1.m1.1.1" xref="A4.6.p6.1.m1.1.1.cmml">𝒛</mi><mo id="A4.6.p6.1.m1.1.2.3.2.2" stretchy="false" xref="A4.6.p6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.6.p6.1.m1.1b"><apply id="A4.6.p6.1.m1.1.2.cmml" xref="A4.6.p6.1.m1.1.2"><times id="A4.6.p6.1.m1.1.2.1.cmml" xref="A4.6.p6.1.m1.1.2.1"></times><ci id="A4.6.p6.1.m1.1.2.2.cmml" xref="A4.6.p6.1.m1.1.2.2">𝜋</ci><ci id="A4.6.p6.1.m1.1.1.cmml" xref="A4.6.p6.1.m1.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.6.p6.1.m1.1c">\pi({\bm{z}})</annotation><annotation encoding="application/x-llamapun" id="A4.6.p6.1.m1.1d">italic_π ( bold_italic_z )</annotation></semantics></math> denote the orthogonal projection of <math alttext="{\bm{z}}" class="ltx_Math" display="inline" id="A4.6.p6.2.m2.1"><semantics id="A4.6.p6.2.m2.1a"><mi id="A4.6.p6.2.m2.1.1" xref="A4.6.p6.2.m2.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="A4.6.p6.2.m2.1b"><ci id="A4.6.p6.2.m2.1.1.cmml" xref="A4.6.p6.2.m2.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.6.p6.2.m2.1c">{\bm{z}}</annotation><annotation encoding="application/x-llamapun" id="A4.6.p6.2.m2.1d">bold_italic_z</annotation></semantics></math> onto <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="A4.6.p6.3.m3.1"><semantics id="A4.6.p6.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="A4.6.p6.3.m3.1.1" xref="A4.6.p6.3.m3.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="A4.6.p6.3.m3.1b"><ci id="A4.6.p6.3.m3.1.1.cmml" xref="A4.6.p6.3.m3.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.6.p6.3.m3.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.6.p6.3.m3.1d">caligraphic_M</annotation></semantics></math>. For points close to <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="A4.6.p6.4.m4.1"><semantics id="A4.6.p6.4.m4.1a"><msub id="A4.6.p6.4.m4.1.1" xref="A4.6.p6.4.m4.1.1.cmml"><mi id="A4.6.p6.4.m4.1.1.2" xref="A4.6.p6.4.m4.1.1.2.cmml">𝒛</mi><mi id="A4.6.p6.4.m4.1.1.3" xref="A4.6.p6.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.6.p6.4.m4.1b"><apply id="A4.6.p6.4.m4.1.1.cmml" xref="A4.6.p6.4.m4.1.1"><csymbol cd="ambiguous" id="A4.6.p6.4.m4.1.1.1.cmml" xref="A4.6.p6.4.m4.1.1">subscript</csymbol><ci id="A4.6.p6.4.m4.1.1.2.cmml" xref="A4.6.p6.4.m4.1.1.2">𝒛</ci><ci id="A4.6.p6.4.m4.1.1.3.cmml" xref="A4.6.p6.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.6.p6.4.m4.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.6.p6.4.m4.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we can approximate <math alttext="\pi({\bm{z}})" class="ltx_Math" display="inline" id="A4.6.p6.5.m5.1"><semantics id="A4.6.p6.5.m5.1a"><mrow id="A4.6.p6.5.m5.1.2" xref="A4.6.p6.5.m5.1.2.cmml"><mi id="A4.6.p6.5.m5.1.2.2" xref="A4.6.p6.5.m5.1.2.2.cmml">π</mi><mo id="A4.6.p6.5.m5.1.2.1" xref="A4.6.p6.5.m5.1.2.1.cmml">⁢</mo><mrow id="A4.6.p6.5.m5.1.2.3.2" xref="A4.6.p6.5.m5.1.2.cmml"><mo id="A4.6.p6.5.m5.1.2.3.2.1" stretchy="false" xref="A4.6.p6.5.m5.1.2.cmml">(</mo><mi id="A4.6.p6.5.m5.1.1" xref="A4.6.p6.5.m5.1.1.cmml">𝒛</mi><mo id="A4.6.p6.5.m5.1.2.3.2.2" stretchy="false" xref="A4.6.p6.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.6.p6.5.m5.1b"><apply id="A4.6.p6.5.m5.1.2.cmml" xref="A4.6.p6.5.m5.1.2"><times id="A4.6.p6.5.m5.1.2.1.cmml" xref="A4.6.p6.5.m5.1.2.1"></times><ci id="A4.6.p6.5.m5.1.2.2.cmml" xref="A4.6.p6.5.m5.1.2.2">𝜋</ci><ci id="A4.6.p6.5.m5.1.1.cmml" xref="A4.6.p6.5.m5.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.6.p6.5.m5.1c">\pi({\bm{z}})</annotation><annotation encoding="application/x-llamapun" id="A4.6.p6.5.m5.1d">italic_π ( bold_italic_z )</annotation></semantics></math> using the tangent space projection, which comes from the first-order Taylor expansion of <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="A4.6.p6.6.m6.1"><semantics id="A4.6.p6.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="A4.6.p6.6.m6.1.1" xref="A4.6.p6.6.m6.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="A4.6.p6.6.m6.1b"><ci id="A4.6.p6.6.m6.1.1.cmml" xref="A4.6.p6.6.m6.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.6.p6.6.m6.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.6.p6.6.m6.1d">caligraphic_M</annotation></semantics></math> at <math alttext="{\bm{z}}_{t}" class="ltx_Math" display="inline" id="A4.6.p6.7.m7.1"><semantics id="A4.6.p6.7.m7.1a"><msub id="A4.6.p6.7.m7.1.1" xref="A4.6.p6.7.m7.1.1.cmml"><mi id="A4.6.p6.7.m7.1.1.2" xref="A4.6.p6.7.m7.1.1.2.cmml">𝒛</mi><mi id="A4.6.p6.7.m7.1.1.3" xref="A4.6.p6.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A4.6.p6.7.m7.1b"><apply id="A4.6.p6.7.m7.1.1.cmml" xref="A4.6.p6.7.m7.1.1"><csymbol cd="ambiguous" id="A4.6.p6.7.m7.1.1.1.cmml" xref="A4.6.p6.7.m7.1.1">subscript</csymbol><ci id="A4.6.p6.7.m7.1.1.2.cmml" xref="A4.6.p6.7.m7.1.1.2">𝒛</ci><ci id="A4.6.p6.7.m7.1.1.3.cmml" xref="A4.6.p6.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.6.p6.7.m7.1c">{\bm{z}}_{t}</annotation><annotation encoding="application/x-llamapun" id="A4.6.p6.7.m7.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi({\bm{z}})\approx{\bm{z}}_{t}+\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}({%
\bm{z}}-{\bm{z}}_{t})." class="ltx_Math" display="block" id="A4.Ex5.m1.2"><semantics id="A4.Ex5.m1.2a"><mrow id="A4.Ex5.m1.2.2.1" xref="A4.Ex5.m1.2.2.1.1.cmml"><mrow id="A4.Ex5.m1.2.2.1.1" xref="A4.Ex5.m1.2.2.1.1.cmml"><mrow id="A4.Ex5.m1.2.2.1.1.3" xref="A4.Ex5.m1.2.2.1.1.3.cmml"><mi id="A4.Ex5.m1.2.2.1.1.3.2" xref="A4.Ex5.m1.2.2.1.1.3.2.cmml">π</mi><mo id="A4.Ex5.m1.2.2.1.1.3.1" xref="A4.Ex5.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="A4.Ex5.m1.2.2.1.1.3.3.2" xref="A4.Ex5.m1.2.2.1.1.3.cmml"><mo id="A4.Ex5.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="A4.Ex5.m1.2.2.1.1.3.cmml">(</mo><mi id="A4.Ex5.m1.1.1" xref="A4.Ex5.m1.1.1.cmml">𝒛</mi><mo id="A4.Ex5.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="A4.Ex5.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="A4.Ex5.m1.2.2.1.1.2" xref="A4.Ex5.m1.2.2.1.1.2.cmml">≈</mo><mrow id="A4.Ex5.m1.2.2.1.1.1" xref="A4.Ex5.m1.2.2.1.1.1.cmml"><msub id="A4.Ex5.m1.2.2.1.1.1.3" xref="A4.Ex5.m1.2.2.1.1.1.3.cmml"><mi id="A4.Ex5.m1.2.2.1.1.1.3.2" xref="A4.Ex5.m1.2.2.1.1.1.3.2.cmml">𝒛</mi><mi id="A4.Ex5.m1.2.2.1.1.1.3.3" xref="A4.Ex5.m1.2.2.1.1.1.3.3.cmml">t</mi></msub><mo id="A4.Ex5.m1.2.2.1.1.1.2" xref="A4.Ex5.m1.2.2.1.1.1.2.cmml">+</mo><mrow id="A4.Ex5.m1.2.2.1.1.1.1" xref="A4.Ex5.m1.2.2.1.1.1.1.cmml"><msub id="A4.Ex5.m1.2.2.1.1.1.1.3" xref="A4.Ex5.m1.2.2.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex5.m1.2.2.1.1.1.1.3.2" xref="A4.Ex5.m1.2.2.1.1.1.1.3.2.cmml">𝒫</mi><mrow id="A4.Ex5.m1.2.2.1.1.1.1.3.3" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.cmml"><msub id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.cmml"><mi id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.2" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.2.cmml">T</mi><msub id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.cmml"><mi id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.2" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.2.cmml">𝒛</mi><mi id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.3" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.Ex5.m1.2.2.1.1.1.1.3.3.1" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex5.m1.2.2.1.1.1.1.3.3.3" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.3.cmml">ℳ</mi></mrow></msub><mo id="A4.Ex5.m1.2.2.1.1.1.1.2" xref="A4.Ex5.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex5.m1.2.2.1.1.1.1.1.1" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex5.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.2" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mo id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.1" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A4.Ex5.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A4.Ex5.m1.2.2.1.2" lspace="0em" xref="A4.Ex5.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex5.m1.2b"><apply id="A4.Ex5.m1.2.2.1.1.cmml" xref="A4.Ex5.m1.2.2.1"><approx id="A4.Ex5.m1.2.2.1.1.2.cmml" xref="A4.Ex5.m1.2.2.1.1.2"></approx><apply id="A4.Ex5.m1.2.2.1.1.3.cmml" xref="A4.Ex5.m1.2.2.1.1.3"><times id="A4.Ex5.m1.2.2.1.1.3.1.cmml" xref="A4.Ex5.m1.2.2.1.1.3.1"></times><ci id="A4.Ex5.m1.2.2.1.1.3.2.cmml" xref="A4.Ex5.m1.2.2.1.1.3.2">𝜋</ci><ci id="A4.Ex5.m1.1.1.cmml" xref="A4.Ex5.m1.1.1">𝒛</ci></apply><apply id="A4.Ex5.m1.2.2.1.1.1.cmml" xref="A4.Ex5.m1.2.2.1.1.1"><plus id="A4.Ex5.m1.2.2.1.1.1.2.cmml" xref="A4.Ex5.m1.2.2.1.1.1.2"></plus><apply id="A4.Ex5.m1.2.2.1.1.1.3.cmml" xref="A4.Ex5.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex5.m1.2.2.1.1.1.3.1.cmml" xref="A4.Ex5.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A4.Ex5.m1.2.2.1.1.1.3.2.cmml" xref="A4.Ex5.m1.2.2.1.1.1.3.2">𝒛</ci><ci id="A4.Ex5.m1.2.2.1.1.1.3.3.cmml" xref="A4.Ex5.m1.2.2.1.1.1.3.3">𝑡</ci></apply><apply id="A4.Ex5.m1.2.2.1.1.1.1.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1"><times id="A4.Ex5.m1.2.2.1.1.1.1.2.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.2"></times><apply id="A4.Ex5.m1.2.2.1.1.1.1.3.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex5.m1.2.2.1.1.1.1.3.1.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex5.m1.2.2.1.1.1.1.3.2.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.2">𝒫</ci><apply id="A4.Ex5.m1.2.2.1.1.1.1.3.3.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3"><times id="A4.Ex5.m1.2.2.1.1.1.1.3.3.1.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.1"></times><apply id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.1.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2">subscript</csymbol><ci id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.2.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.2">𝑇</ci><apply id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.1.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.2.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.2">𝒛</ci><ci id="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.3.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.Ex5.m1.2.2.1.1.1.1.3.3.3.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.3.3.3">ℳ</ci></apply></apply><apply id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1"><minus id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.1"></minus><ci id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.2">𝒛</ci><apply id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2">𝒛</ci><ci id="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="A4.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex5.m1.2c">\pi({\bm{z}})\approx{\bm{z}}_{t}+\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}({%
\bm{z}}-{\bm{z}}_{t}).</annotation><annotation encoding="application/x-llamapun" id="A4.Ex5.m1.2d">italic_π ( bold_italic_z ) ≈ bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ( bold_italic_z - bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A4.7.p7">
<p class="ltx_p" id="A4.7.p7.4">Here, the higher-order terms for <math alttext="\pi({\bm{z}}_{t-1})" class="ltx_Math" display="inline" id="A4.7.p7.1.m1.1"><semantics id="A4.7.p7.1.m1.1a"><mrow id="A4.7.p7.1.m1.1.1" xref="A4.7.p7.1.m1.1.1.cmml"><mi id="A4.7.p7.1.m1.1.1.3" xref="A4.7.p7.1.m1.1.1.3.cmml">π</mi><mo id="A4.7.p7.1.m1.1.1.2" xref="A4.7.p7.1.m1.1.1.2.cmml">⁢</mo><mrow id="A4.7.p7.1.m1.1.1.1.1" xref="A4.7.p7.1.m1.1.1.1.1.1.cmml"><mo id="A4.7.p7.1.m1.1.1.1.1.2" stretchy="false" xref="A4.7.p7.1.m1.1.1.1.1.1.cmml">(</mo><msub id="A4.7.p7.1.m1.1.1.1.1.1" xref="A4.7.p7.1.m1.1.1.1.1.1.cmml"><mi id="A4.7.p7.1.m1.1.1.1.1.1.2" xref="A4.7.p7.1.m1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="A4.7.p7.1.m1.1.1.1.1.1.3" xref="A4.7.p7.1.m1.1.1.1.1.1.3.cmml"><mi id="A4.7.p7.1.m1.1.1.1.1.1.3.2" xref="A4.7.p7.1.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="A4.7.p7.1.m1.1.1.1.1.1.3.1" xref="A4.7.p7.1.m1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A4.7.p7.1.m1.1.1.1.1.1.3.3" xref="A4.7.p7.1.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A4.7.p7.1.m1.1.1.1.1.3" stretchy="false" xref="A4.7.p7.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.7.p7.1.m1.1b"><apply id="A4.7.p7.1.m1.1.1.cmml" xref="A4.7.p7.1.m1.1.1"><times id="A4.7.p7.1.m1.1.1.2.cmml" xref="A4.7.p7.1.m1.1.1.2"></times><ci id="A4.7.p7.1.m1.1.1.3.cmml" xref="A4.7.p7.1.m1.1.1.3">𝜋</ci><apply id="A4.7.p7.1.m1.1.1.1.1.1.cmml" xref="A4.7.p7.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.7.p7.1.m1.1.1.1.1.1.1.cmml" xref="A4.7.p7.1.m1.1.1.1.1">subscript</csymbol><ci id="A4.7.p7.1.m1.1.1.1.1.1.2.cmml" xref="A4.7.p7.1.m1.1.1.1.1.1.2">𝒛</ci><apply id="A4.7.p7.1.m1.1.1.1.1.1.3.cmml" xref="A4.7.p7.1.m1.1.1.1.1.1.3"><minus id="A4.7.p7.1.m1.1.1.1.1.1.3.1.cmml" xref="A4.7.p7.1.m1.1.1.1.1.1.3.1"></minus><ci id="A4.7.p7.1.m1.1.1.1.1.1.3.2.cmml" xref="A4.7.p7.1.m1.1.1.1.1.1.3.2">𝑡</ci><cn id="A4.7.p7.1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="A4.7.p7.1.m1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.7.p7.1.m1.1c">\pi({\bm{z}}_{t-1})</annotation><annotation encoding="application/x-llamapun" id="A4.7.p7.1.m1.1d">italic_π ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> are of order <math alttext="\mathcal{O}(\|{\bm{z}}_{t-1}-{\bm{z}}_{t}\|^{2})=\mathcal{O}((\eta\|{\bm{g}}_{%
t}\|)^{2})=\mathcal{O}(\eta^{2})" class="ltx_Math" display="inline" id="A4.7.p7.2.m2.3"><semantics id="A4.7.p7.2.m2.3a"><mrow id="A4.7.p7.2.m2.3.3" xref="A4.7.p7.2.m2.3.3.cmml"><mrow id="A4.7.p7.2.m2.1.1.1" xref="A4.7.p7.2.m2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.7.p7.2.m2.1.1.1.3" xref="A4.7.p7.2.m2.1.1.1.3.cmml">𝒪</mi><mo id="A4.7.p7.2.m2.1.1.1.2" xref="A4.7.p7.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="A4.7.p7.2.m2.1.1.1.1.1" xref="A4.7.p7.2.m2.1.1.1.1.1.1.cmml"><mo id="A4.7.p7.2.m2.1.1.1.1.1.2" stretchy="false" xref="A4.7.p7.2.m2.1.1.1.1.1.1.cmml">(</mo><msup id="A4.7.p7.2.m2.1.1.1.1.1.1" xref="A4.7.p7.2.m2.1.1.1.1.1.1.cmml"><mrow id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.2.cmml"><mo id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.cmml"><msub id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.2" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.2" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.1" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.3" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.1" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.2" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.3" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A4.7.p7.2.m2.1.1.1.1.1.1.3" xref="A4.7.p7.2.m2.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A4.7.p7.2.m2.1.1.1.1.1.3" stretchy="false" xref="A4.7.p7.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.7.p7.2.m2.3.3.5" xref="A4.7.p7.2.m2.3.3.5.cmml">=</mo><mrow id="A4.7.p7.2.m2.2.2.2" xref="A4.7.p7.2.m2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.7.p7.2.m2.2.2.2.3" xref="A4.7.p7.2.m2.2.2.2.3.cmml">𝒪</mi><mo id="A4.7.p7.2.m2.2.2.2.2" xref="A4.7.p7.2.m2.2.2.2.2.cmml">⁢</mo><mrow id="A4.7.p7.2.m2.2.2.2.1.1" xref="A4.7.p7.2.m2.2.2.2.1.1.1.cmml"><mo id="A4.7.p7.2.m2.2.2.2.1.1.2" stretchy="false" xref="A4.7.p7.2.m2.2.2.2.1.1.1.cmml">(</mo><msup id="A4.7.p7.2.m2.2.2.2.1.1.1" xref="A4.7.p7.2.m2.2.2.2.1.1.1.cmml"><mrow id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.cmml"><mo id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.cmml"><mi id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.3" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.2" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝒈</mi><mi id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A4.7.p7.2.m2.2.2.2.1.1.1.3" xref="A4.7.p7.2.m2.2.2.2.1.1.1.3.cmml">2</mn></msup><mo id="A4.7.p7.2.m2.2.2.2.1.1.3" stretchy="false" xref="A4.7.p7.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.7.p7.2.m2.3.3.6" xref="A4.7.p7.2.m2.3.3.6.cmml">=</mo><mrow id="A4.7.p7.2.m2.3.3.3" xref="A4.7.p7.2.m2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.7.p7.2.m2.3.3.3.3" xref="A4.7.p7.2.m2.3.3.3.3.cmml">𝒪</mi><mo id="A4.7.p7.2.m2.3.3.3.2" xref="A4.7.p7.2.m2.3.3.3.2.cmml">⁢</mo><mrow id="A4.7.p7.2.m2.3.3.3.1.1" xref="A4.7.p7.2.m2.3.3.3.1.1.1.cmml"><mo id="A4.7.p7.2.m2.3.3.3.1.1.2" stretchy="false" xref="A4.7.p7.2.m2.3.3.3.1.1.1.cmml">(</mo><msup id="A4.7.p7.2.m2.3.3.3.1.1.1" xref="A4.7.p7.2.m2.3.3.3.1.1.1.cmml"><mi id="A4.7.p7.2.m2.3.3.3.1.1.1.2" xref="A4.7.p7.2.m2.3.3.3.1.1.1.2.cmml">η</mi><mn id="A4.7.p7.2.m2.3.3.3.1.1.1.3" xref="A4.7.p7.2.m2.3.3.3.1.1.1.3.cmml">2</mn></msup><mo id="A4.7.p7.2.m2.3.3.3.1.1.3" stretchy="false" xref="A4.7.p7.2.m2.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.7.p7.2.m2.3b"><apply id="A4.7.p7.2.m2.3.3.cmml" xref="A4.7.p7.2.m2.3.3"><and id="A4.7.p7.2.m2.3.3a.cmml" xref="A4.7.p7.2.m2.3.3"></and><apply id="A4.7.p7.2.m2.3.3b.cmml" xref="A4.7.p7.2.m2.3.3"><eq id="A4.7.p7.2.m2.3.3.5.cmml" xref="A4.7.p7.2.m2.3.3.5"></eq><apply id="A4.7.p7.2.m2.1.1.1.cmml" xref="A4.7.p7.2.m2.1.1.1"><times id="A4.7.p7.2.m2.1.1.1.2.cmml" xref="A4.7.p7.2.m2.1.1.1.2"></times><ci id="A4.7.p7.2.m2.1.1.1.3.cmml" xref="A4.7.p7.2.m2.1.1.1.3">𝒪</ci><apply id="A4.7.p7.2.m2.1.1.1.1.1.1.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.7.p7.2.m2.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1">superscript</csymbol><apply id="A4.7.p7.2.m2.1.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A4.7.p7.2.m2.1.1.1.1.1.1.1.2.1.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1"><minus id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.2">𝒛</ci><apply id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3"><minus id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.2">𝒛</ci><ci id="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.7.p7.2.m2.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn id="A4.7.p7.2.m2.1.1.1.1.1.1.3.cmml" type="integer" xref="A4.7.p7.2.m2.1.1.1.1.1.1.3">2</cn></apply></apply><apply id="A4.7.p7.2.m2.2.2.2.cmml" xref="A4.7.p7.2.m2.2.2.2"><times id="A4.7.p7.2.m2.2.2.2.2.cmml" xref="A4.7.p7.2.m2.2.2.2.2"></times><ci id="A4.7.p7.2.m2.2.2.2.3.cmml" xref="A4.7.p7.2.m2.2.2.2.3">𝒪</ci><apply id="A4.7.p7.2.m2.2.2.2.1.1.1.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="A4.7.p7.2.m2.2.2.2.1.1.1.2.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1">superscript</csymbol><apply id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1"><times id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.2"></times><ci id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.3.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.2">𝒈</ci><ci id="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.7.p7.2.m2.2.2.2.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><cn id="A4.7.p7.2.m2.2.2.2.1.1.1.3.cmml" type="integer" xref="A4.7.p7.2.m2.2.2.2.1.1.1.3">2</cn></apply></apply></apply><apply id="A4.7.p7.2.m2.3.3c.cmml" xref="A4.7.p7.2.m2.3.3"><eq id="A4.7.p7.2.m2.3.3.6.cmml" xref="A4.7.p7.2.m2.3.3.6"></eq><share href="https://arxiv.org/html/2410.03463v1#A4.7.p7.2.m2.2.2.2.cmml" id="A4.7.p7.2.m2.3.3d.cmml" xref="A4.7.p7.2.m2.3.3"></share><apply id="A4.7.p7.2.m2.3.3.3.cmml" xref="A4.7.p7.2.m2.3.3.3"><times id="A4.7.p7.2.m2.3.3.3.2.cmml" xref="A4.7.p7.2.m2.3.3.3.2"></times><ci id="A4.7.p7.2.m2.3.3.3.3.cmml" xref="A4.7.p7.2.m2.3.3.3.3">𝒪</ci><apply id="A4.7.p7.2.m2.3.3.3.1.1.1.cmml" xref="A4.7.p7.2.m2.3.3.3.1.1"><csymbol cd="ambiguous" id="A4.7.p7.2.m2.3.3.3.1.1.1.1.cmml" xref="A4.7.p7.2.m2.3.3.3.1.1">superscript</csymbol><ci id="A4.7.p7.2.m2.3.3.3.1.1.1.2.cmml" xref="A4.7.p7.2.m2.3.3.3.1.1.1.2">𝜂</ci><cn id="A4.7.p7.2.m2.3.3.3.1.1.1.3.cmml" type="integer" xref="A4.7.p7.2.m2.3.3.3.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.7.p7.2.m2.3c">\mathcal{O}(\|{\bm{z}}_{t-1}-{\bm{z}}_{t}\|^{2})=\mathcal{O}((\eta\|{\bm{g}}_{%
t}\|)^{2})=\mathcal{O}(\eta^{2})</annotation><annotation encoding="application/x-llamapun" id="A4.7.p7.2.m2.3d">caligraphic_O ( ∥ bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT - bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) = caligraphic_O ( ( italic_η ∥ bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) = caligraphic_O ( italic_η start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>. Similarly, the higher-order terms for <math alttext="\pi({\bm{z}}_{t-1}^{\prime})" class="ltx_Math" display="inline" id="A4.7.p7.3.m3.1"><semantics id="A4.7.p7.3.m3.1a"><mrow id="A4.7.p7.3.m3.1.1" xref="A4.7.p7.3.m3.1.1.cmml"><mi id="A4.7.p7.3.m3.1.1.3" xref="A4.7.p7.3.m3.1.1.3.cmml">π</mi><mo id="A4.7.p7.3.m3.1.1.2" xref="A4.7.p7.3.m3.1.1.2.cmml">⁢</mo><mrow id="A4.7.p7.3.m3.1.1.1.1" xref="A4.7.p7.3.m3.1.1.1.1.1.cmml"><mo id="A4.7.p7.3.m3.1.1.1.1.2" stretchy="false" xref="A4.7.p7.3.m3.1.1.1.1.1.cmml">(</mo><msubsup id="A4.7.p7.3.m3.1.1.1.1.1" xref="A4.7.p7.3.m3.1.1.1.1.1.cmml"><mi id="A4.7.p7.3.m3.1.1.1.1.1.2.2" xref="A4.7.p7.3.m3.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="A4.7.p7.3.m3.1.1.1.1.1.2.3" xref="A4.7.p7.3.m3.1.1.1.1.1.2.3.cmml"><mi id="A4.7.p7.3.m3.1.1.1.1.1.2.3.2" xref="A4.7.p7.3.m3.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A4.7.p7.3.m3.1.1.1.1.1.2.3.1" xref="A4.7.p7.3.m3.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A4.7.p7.3.m3.1.1.1.1.1.2.3.3" xref="A4.7.p7.3.m3.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.7.p7.3.m3.1.1.1.1.1.3" xref="A4.7.p7.3.m3.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="A4.7.p7.3.m3.1.1.1.1.3" stretchy="false" xref="A4.7.p7.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.7.p7.3.m3.1b"><apply id="A4.7.p7.3.m3.1.1.cmml" xref="A4.7.p7.3.m3.1.1"><times id="A4.7.p7.3.m3.1.1.2.cmml" xref="A4.7.p7.3.m3.1.1.2"></times><ci id="A4.7.p7.3.m3.1.1.3.cmml" xref="A4.7.p7.3.m3.1.1.3">𝜋</ci><apply id="A4.7.p7.3.m3.1.1.1.1.1.cmml" xref="A4.7.p7.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="A4.7.p7.3.m3.1.1.1.1.1.1.cmml" xref="A4.7.p7.3.m3.1.1.1.1">superscript</csymbol><apply id="A4.7.p7.3.m3.1.1.1.1.1.2.cmml" xref="A4.7.p7.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="A4.7.p7.3.m3.1.1.1.1.1.2.1.cmml" xref="A4.7.p7.3.m3.1.1.1.1">subscript</csymbol><ci id="A4.7.p7.3.m3.1.1.1.1.1.2.2.cmml" xref="A4.7.p7.3.m3.1.1.1.1.1.2.2">𝒛</ci><apply id="A4.7.p7.3.m3.1.1.1.1.1.2.3.cmml" xref="A4.7.p7.3.m3.1.1.1.1.1.2.3"><minus id="A4.7.p7.3.m3.1.1.1.1.1.2.3.1.cmml" xref="A4.7.p7.3.m3.1.1.1.1.1.2.3.1"></minus><ci id="A4.7.p7.3.m3.1.1.1.1.1.2.3.2.cmml" xref="A4.7.p7.3.m3.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A4.7.p7.3.m3.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.7.p7.3.m3.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A4.7.p7.3.m3.1.1.1.1.1.3.cmml" xref="A4.7.p7.3.m3.1.1.1.1.1.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.7.p7.3.m3.1c">\pi({\bm{z}}_{t-1}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="A4.7.p7.3.m3.1d">italic_π ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> are of order <math alttext="\mathcal{O}(\|{\bm{z}}_{t-1}^{\prime}-{\bm{z}}_{t}\|^{2})=\mathcal{O}((\eta\|%
\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}({\bm{g}}_{t})\|)^{2})=\mathcal{O}(%
\eta^{2})" class="ltx_Math" display="inline" id="A4.7.p7.4.m4.3"><semantics id="A4.7.p7.4.m4.3a"><mrow id="A4.7.p7.4.m4.3.3" xref="A4.7.p7.4.m4.3.3.cmml"><mrow id="A4.7.p7.4.m4.1.1.1" xref="A4.7.p7.4.m4.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.7.p7.4.m4.1.1.1.3" xref="A4.7.p7.4.m4.1.1.1.3.cmml">𝒪</mi><mo id="A4.7.p7.4.m4.1.1.1.2" xref="A4.7.p7.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="A4.7.p7.4.m4.1.1.1.1.1" xref="A4.7.p7.4.m4.1.1.1.1.1.1.cmml"><mo id="A4.7.p7.4.m4.1.1.1.1.1.2" stretchy="false" xref="A4.7.p7.4.m4.1.1.1.1.1.1.cmml">(</mo><msup id="A4.7.p7.4.m4.1.1.1.1.1.1" xref="A4.7.p7.4.m4.1.1.1.1.1.1.cmml"><mrow id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.2.cmml"><mo id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.2" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒛</mi><mrow id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">−</mo><mn id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mo id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.3" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.1" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.2" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.3" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A4.7.p7.4.m4.1.1.1.1.1.1.3" xref="A4.7.p7.4.m4.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="A4.7.p7.4.m4.1.1.1.1.1.3" stretchy="false" xref="A4.7.p7.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.7.p7.4.m4.3.3.5" xref="A4.7.p7.4.m4.3.3.5.cmml">=</mo><mrow id="A4.7.p7.4.m4.2.2.2" xref="A4.7.p7.4.m4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.7.p7.4.m4.2.2.2.3" xref="A4.7.p7.4.m4.2.2.2.3.cmml">𝒪</mi><mo id="A4.7.p7.4.m4.2.2.2.2" xref="A4.7.p7.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="A4.7.p7.4.m4.2.2.2.1.1" xref="A4.7.p7.4.m4.2.2.2.1.1.1.cmml"><mo id="A4.7.p7.4.m4.2.2.2.1.1.2" stretchy="false" xref="A4.7.p7.4.m4.2.2.2.1.1.1.cmml">(</mo><msup id="A4.7.p7.4.m4.2.2.2.1.1.1" xref="A4.7.p7.4.m4.2.2.2.1.1.1.cmml"><mrow id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.cmml"><mo id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.2" stretchy="false" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.cmml"><mi id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.3" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.2" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒫</mi><msub id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.2" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝒮</mi><msub id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">𝒛</mi><mi id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">t</mi></msub></msub></msub><mo id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒈</mi><mi id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.3" stretchy="false" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A4.7.p7.4.m4.2.2.2.1.1.1.3" xref="A4.7.p7.4.m4.2.2.2.1.1.1.3.cmml">2</mn></msup><mo id="A4.7.p7.4.m4.2.2.2.1.1.3" stretchy="false" xref="A4.7.p7.4.m4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.7.p7.4.m4.3.3.6" xref="A4.7.p7.4.m4.3.3.6.cmml">=</mo><mrow id="A4.7.p7.4.m4.3.3.3" xref="A4.7.p7.4.m4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.7.p7.4.m4.3.3.3.3" xref="A4.7.p7.4.m4.3.3.3.3.cmml">𝒪</mi><mo id="A4.7.p7.4.m4.3.3.3.2" xref="A4.7.p7.4.m4.3.3.3.2.cmml">⁢</mo><mrow id="A4.7.p7.4.m4.3.3.3.1.1" xref="A4.7.p7.4.m4.3.3.3.1.1.1.cmml"><mo id="A4.7.p7.4.m4.3.3.3.1.1.2" stretchy="false" xref="A4.7.p7.4.m4.3.3.3.1.1.1.cmml">(</mo><msup id="A4.7.p7.4.m4.3.3.3.1.1.1" xref="A4.7.p7.4.m4.3.3.3.1.1.1.cmml"><mi id="A4.7.p7.4.m4.3.3.3.1.1.1.2" xref="A4.7.p7.4.m4.3.3.3.1.1.1.2.cmml">η</mi><mn id="A4.7.p7.4.m4.3.3.3.1.1.1.3" xref="A4.7.p7.4.m4.3.3.3.1.1.1.3.cmml">2</mn></msup><mo id="A4.7.p7.4.m4.3.3.3.1.1.3" stretchy="false" xref="A4.7.p7.4.m4.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.7.p7.4.m4.3b"><apply id="A4.7.p7.4.m4.3.3.cmml" xref="A4.7.p7.4.m4.3.3"><and id="A4.7.p7.4.m4.3.3a.cmml" xref="A4.7.p7.4.m4.3.3"></and><apply id="A4.7.p7.4.m4.3.3b.cmml" xref="A4.7.p7.4.m4.3.3"><eq id="A4.7.p7.4.m4.3.3.5.cmml" xref="A4.7.p7.4.m4.3.3.5"></eq><apply id="A4.7.p7.4.m4.1.1.1.cmml" xref="A4.7.p7.4.m4.1.1.1"><times id="A4.7.p7.4.m4.1.1.1.2.cmml" xref="A4.7.p7.4.m4.1.1.1.2"></times><ci id="A4.7.p7.4.m4.1.1.1.3.cmml" xref="A4.7.p7.4.m4.1.1.1.3">𝒪</ci><apply id="A4.7.p7.4.m4.1.1.1.1.1.1.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.7.p7.4.m4.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1">superscript</csymbol><apply id="A4.7.p7.4.m4.1.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A4.7.p7.4.m4.1.1.1.1.1.1.1.2.1.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1"><minus id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.2">𝒛</ci><apply id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3"><minus id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.1"></minus><ci id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><apply id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.2">𝒛</ci><ci id="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.7.p7.4.m4.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn id="A4.7.p7.4.m4.1.1.1.1.1.1.3.cmml" type="integer" xref="A4.7.p7.4.m4.1.1.1.1.1.1.3">2</cn></apply></apply><apply id="A4.7.p7.4.m4.2.2.2.cmml" xref="A4.7.p7.4.m4.2.2.2"><times id="A4.7.p7.4.m4.2.2.2.2.cmml" xref="A4.7.p7.4.m4.2.2.2.2"></times><ci id="A4.7.p7.4.m4.2.2.2.3.cmml" xref="A4.7.p7.4.m4.2.2.2.3">𝒪</ci><apply id="A4.7.p7.4.m4.2.2.2.1.1.1.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1"><csymbol cd="ambiguous" id="A4.7.p7.4.m4.2.2.2.1.1.1.2.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1">superscript</csymbol><apply id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1"><times id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.2"></times><ci id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.3.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1"><times id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.2"></times><apply id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.2">𝒫</ci><apply id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.2">𝒮</ci><apply id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.2">𝒛</ci><ci id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply><apply id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒈</ci><ci id="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.7.p7.4.m4.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply><cn id="A4.7.p7.4.m4.2.2.2.1.1.1.3.cmml" type="integer" xref="A4.7.p7.4.m4.2.2.2.1.1.1.3">2</cn></apply></apply></apply><apply id="A4.7.p7.4.m4.3.3c.cmml" xref="A4.7.p7.4.m4.3.3"><eq id="A4.7.p7.4.m4.3.3.6.cmml" xref="A4.7.p7.4.m4.3.3.6"></eq><share href="https://arxiv.org/html/2410.03463v1#A4.7.p7.4.m4.2.2.2.cmml" id="A4.7.p7.4.m4.3.3d.cmml" xref="A4.7.p7.4.m4.3.3"></share><apply id="A4.7.p7.4.m4.3.3.3.cmml" xref="A4.7.p7.4.m4.3.3.3"><times id="A4.7.p7.4.m4.3.3.3.2.cmml" xref="A4.7.p7.4.m4.3.3.3.2"></times><ci id="A4.7.p7.4.m4.3.3.3.3.cmml" xref="A4.7.p7.4.m4.3.3.3.3">𝒪</ci><apply id="A4.7.p7.4.m4.3.3.3.1.1.1.cmml" xref="A4.7.p7.4.m4.3.3.3.1.1"><csymbol cd="ambiguous" id="A4.7.p7.4.m4.3.3.3.1.1.1.1.cmml" xref="A4.7.p7.4.m4.3.3.3.1.1">superscript</csymbol><ci id="A4.7.p7.4.m4.3.3.3.1.1.1.2.cmml" xref="A4.7.p7.4.m4.3.3.3.1.1.1.2">𝜂</ci><cn id="A4.7.p7.4.m4.3.3.3.1.1.1.3.cmml" type="integer" xref="A4.7.p7.4.m4.3.3.3.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.7.p7.4.m4.3c">\mathcal{O}(\|{\bm{z}}_{t-1}^{\prime}-{\bm{z}}_{t}\|^{2})=\mathcal{O}((\eta\|%
\mathcal{P}_{\mathcal{S}_{{\bm{z}}_{t}}}({\bm{g}}_{t})\|)^{2})=\mathcal{O}(%
\eta^{2})</annotation><annotation encoding="application/x-llamapun" id="A4.7.p7.4.m4.3d">caligraphic_O ( ∥ bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT - bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) = caligraphic_O ( ( italic_η ∥ caligraphic_P start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ∥ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) = caligraphic_O ( italic_η start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>. We will address these terms at the end of the proof.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.8.p8">
<p class="ltx_p" id="A4.8.p8.2">First, compute the distance from <math alttext="{\bm{z}}_{t-1}" class="ltx_Math" display="inline" id="A4.8.p8.1.m1.1"><semantics id="A4.8.p8.1.m1.1a"><msub id="A4.8.p8.1.m1.1.1" xref="A4.8.p8.1.m1.1.1.cmml"><mi id="A4.8.p8.1.m1.1.1.2" xref="A4.8.p8.1.m1.1.1.2.cmml">𝒛</mi><mrow id="A4.8.p8.1.m1.1.1.3" xref="A4.8.p8.1.m1.1.1.3.cmml"><mi id="A4.8.p8.1.m1.1.1.3.2" xref="A4.8.p8.1.m1.1.1.3.2.cmml">t</mi><mo id="A4.8.p8.1.m1.1.1.3.1" xref="A4.8.p8.1.m1.1.1.3.1.cmml">−</mo><mn id="A4.8.p8.1.m1.1.1.3.3" xref="A4.8.p8.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.8.p8.1.m1.1b"><apply id="A4.8.p8.1.m1.1.1.cmml" xref="A4.8.p8.1.m1.1.1"><csymbol cd="ambiguous" id="A4.8.p8.1.m1.1.1.1.cmml" xref="A4.8.p8.1.m1.1.1">subscript</csymbol><ci id="A4.8.p8.1.m1.1.1.2.cmml" xref="A4.8.p8.1.m1.1.1.2">𝒛</ci><apply id="A4.8.p8.1.m1.1.1.3.cmml" xref="A4.8.p8.1.m1.1.1.3"><minus id="A4.8.p8.1.m1.1.1.3.1.cmml" xref="A4.8.p8.1.m1.1.1.3.1"></minus><ci id="A4.8.p8.1.m1.1.1.3.2.cmml" xref="A4.8.p8.1.m1.1.1.3.2">𝑡</ci><cn id="A4.8.p8.1.m1.1.1.3.3.cmml" type="integer" xref="A4.8.p8.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.8.p8.1.m1.1c">{\bm{z}}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="A4.8.p8.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="A4.8.p8.2.m2.1"><semantics id="A4.8.p8.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A4.8.p8.2.m2.1.1" xref="A4.8.p8.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="A4.8.p8.2.m2.1b"><ci id="A4.8.p8.2.m2.1.1.cmml" xref="A4.8.p8.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.8.p8.2.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.8.p8.2.m2.1d">caligraphic_M</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx1">
<tbody id="A4.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{dist}({\bm{z}}_{t-1},\mathcal{M})" class="ltx_Math" display="inline" id="A4.Ex6.m1.2"><semantics id="A4.Ex6.m1.2a"><mrow id="A4.Ex6.m1.2.2" xref="A4.Ex6.m1.2.2.cmml"><mtext id="A4.Ex6.m1.2.2.3" xref="A4.Ex6.m1.2.2.3a.cmml">dist</mtext><mo id="A4.Ex6.m1.2.2.2" xref="A4.Ex6.m1.2.2.2.cmml">⁢</mo><mrow id="A4.Ex6.m1.2.2.1.1" xref="A4.Ex6.m1.2.2.1.2.cmml"><mo id="A4.Ex6.m1.2.2.1.1.2" stretchy="false" xref="A4.Ex6.m1.2.2.1.2.cmml">(</mo><msub id="A4.Ex6.m1.2.2.1.1.1" xref="A4.Ex6.m1.2.2.1.1.1.cmml"><mi id="A4.Ex6.m1.2.2.1.1.1.2" xref="A4.Ex6.m1.2.2.1.1.1.2.cmml">𝒛</mi><mrow id="A4.Ex6.m1.2.2.1.1.1.3" xref="A4.Ex6.m1.2.2.1.1.1.3.cmml"><mi id="A4.Ex6.m1.2.2.1.1.1.3.2" xref="A4.Ex6.m1.2.2.1.1.1.3.2.cmml">t</mi><mo id="A4.Ex6.m1.2.2.1.1.1.3.1" xref="A4.Ex6.m1.2.2.1.1.1.3.1.cmml">−</mo><mn id="A4.Ex6.m1.2.2.1.1.1.3.3" xref="A4.Ex6.m1.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A4.Ex6.m1.2.2.1.1.3" xref="A4.Ex6.m1.2.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex6.m1.1.1" xref="A4.Ex6.m1.1.1.cmml">ℳ</mi><mo id="A4.Ex6.m1.2.2.1.1.4" stretchy="false" xref="A4.Ex6.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex6.m1.2b"><apply id="A4.Ex6.m1.2.2.cmml" xref="A4.Ex6.m1.2.2"><times id="A4.Ex6.m1.2.2.2.cmml" xref="A4.Ex6.m1.2.2.2"></times><ci id="A4.Ex6.m1.2.2.3a.cmml" xref="A4.Ex6.m1.2.2.3"><mtext id="A4.Ex6.m1.2.2.3.cmml" xref="A4.Ex6.m1.2.2.3">dist</mtext></ci><interval closure="open" id="A4.Ex6.m1.2.2.1.2.cmml" xref="A4.Ex6.m1.2.2.1.1"><apply id="A4.Ex6.m1.2.2.1.1.1.cmml" xref="A4.Ex6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.Ex6.m1.2.2.1.1.1.1.cmml" xref="A4.Ex6.m1.2.2.1.1.1">subscript</csymbol><ci id="A4.Ex6.m1.2.2.1.1.1.2.cmml" xref="A4.Ex6.m1.2.2.1.1.1.2">𝒛</ci><apply id="A4.Ex6.m1.2.2.1.1.1.3.cmml" xref="A4.Ex6.m1.2.2.1.1.1.3"><minus id="A4.Ex6.m1.2.2.1.1.1.3.1.cmml" xref="A4.Ex6.m1.2.2.1.1.1.3.1"></minus><ci id="A4.Ex6.m1.2.2.1.1.1.3.2.cmml" xref="A4.Ex6.m1.2.2.1.1.1.3.2">𝑡</ci><cn id="A4.Ex6.m1.2.2.1.1.1.3.3.cmml" type="integer" xref="A4.Ex6.m1.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="A4.Ex6.m1.1.1.cmml" xref="A4.Ex6.m1.1.1">ℳ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex6.m1.2c">\displaystyle\text{dist}({\bm{z}}_{t-1},\mathcal{M})</annotation><annotation encoding="application/x-llamapun" id="A4.Ex6.m1.2d">dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , caligraphic_M )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|{\bm{z}}_{t-1}-\pi({\bm{z}}_{t-1})\right\|" class="ltx_Math" display="inline" id="A4.Ex6.m2.1"><semantics id="A4.Ex6.m2.1a"><mrow id="A4.Ex6.m2.1.1" xref="A4.Ex6.m2.1.1.cmml"><mi id="A4.Ex6.m2.1.1.3" xref="A4.Ex6.m2.1.1.3.cmml"></mi><mo id="A4.Ex6.m2.1.1.2" xref="A4.Ex6.m2.1.1.2.cmml">=</mo><mrow id="A4.Ex6.m2.1.1.1.1" xref="A4.Ex6.m2.1.1.1.2.cmml"><mo id="A4.Ex6.m2.1.1.1.1.2" xref="A4.Ex6.m2.1.1.1.2.1.cmml">‖</mo><mrow id="A4.Ex6.m2.1.1.1.1.1" xref="A4.Ex6.m2.1.1.1.1.1.cmml"><msub id="A4.Ex6.m2.1.1.1.1.1.3" xref="A4.Ex6.m2.1.1.1.1.1.3.cmml"><mi id="A4.Ex6.m2.1.1.1.1.1.3.2" xref="A4.Ex6.m2.1.1.1.1.1.3.2.cmml">𝒛</mi><mrow id="A4.Ex6.m2.1.1.1.1.1.3.3" xref="A4.Ex6.m2.1.1.1.1.1.3.3.cmml"><mi id="A4.Ex6.m2.1.1.1.1.1.3.3.2" xref="A4.Ex6.m2.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="A4.Ex6.m2.1.1.1.1.1.3.3.1" xref="A4.Ex6.m2.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A4.Ex6.m2.1.1.1.1.1.3.3.3" xref="A4.Ex6.m2.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="A4.Ex6.m2.1.1.1.1.1.2" xref="A4.Ex6.m2.1.1.1.1.1.2.cmml">−</mo><mrow id="A4.Ex6.m2.1.1.1.1.1.1" xref="A4.Ex6.m2.1.1.1.1.1.1.cmml"><mi id="A4.Ex6.m2.1.1.1.1.1.1.3" xref="A4.Ex6.m2.1.1.1.1.1.1.3.cmml">π</mi><mo id="A4.Ex6.m2.1.1.1.1.1.1.2" xref="A4.Ex6.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex6.m2.1.1.1.1.1.1.1.1" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex6.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.2" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.1" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.3" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A4.Ex6.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex6.m2.1.1.1.1.3" xref="A4.Ex6.m2.1.1.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex6.m2.1b"><apply id="A4.Ex6.m2.1.1.cmml" xref="A4.Ex6.m2.1.1"><eq id="A4.Ex6.m2.1.1.2.cmml" xref="A4.Ex6.m2.1.1.2"></eq><csymbol cd="latexml" id="A4.Ex6.m2.1.1.3.cmml" xref="A4.Ex6.m2.1.1.3">absent</csymbol><apply id="A4.Ex6.m2.1.1.1.2.cmml" xref="A4.Ex6.m2.1.1.1.1"><csymbol cd="latexml" id="A4.Ex6.m2.1.1.1.2.1.cmml" xref="A4.Ex6.m2.1.1.1.1.2">norm</csymbol><apply id="A4.Ex6.m2.1.1.1.1.1.cmml" xref="A4.Ex6.m2.1.1.1.1.1"><minus id="A4.Ex6.m2.1.1.1.1.1.2.cmml" xref="A4.Ex6.m2.1.1.1.1.1.2"></minus><apply id="A4.Ex6.m2.1.1.1.1.1.3.cmml" xref="A4.Ex6.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex6.m2.1.1.1.1.1.3.1.cmml" xref="A4.Ex6.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex6.m2.1.1.1.1.1.3.2.cmml" xref="A4.Ex6.m2.1.1.1.1.1.3.2">𝒛</ci><apply id="A4.Ex6.m2.1.1.1.1.1.3.3.cmml" xref="A4.Ex6.m2.1.1.1.1.1.3.3"><minus id="A4.Ex6.m2.1.1.1.1.1.3.3.1.cmml" xref="A4.Ex6.m2.1.1.1.1.1.3.3.1"></minus><ci id="A4.Ex6.m2.1.1.1.1.1.3.3.2.cmml" xref="A4.Ex6.m2.1.1.1.1.1.3.3.2">𝑡</ci><cn id="A4.Ex6.m2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A4.Ex6.m2.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="A4.Ex6.m2.1.1.1.1.1.1.cmml" xref="A4.Ex6.m2.1.1.1.1.1.1"><times id="A4.Ex6.m2.1.1.1.1.1.1.2.cmml" xref="A4.Ex6.m2.1.1.1.1.1.1.2"></times><ci id="A4.Ex6.m2.1.1.1.1.1.1.3.cmml" xref="A4.Ex6.m2.1.1.1.1.1.1.3">𝜋</ci><apply id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.2">𝒛</ci><apply id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3"><minus id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A4.Ex6.m2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex6.m2.1c">\displaystyle=\left\|{\bm{z}}_{t-1}-\pi({\bm{z}}_{t-1})\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex6.m2.1d">= ∥ bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT - italic_π ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\approx\left\|{\bm{z}}_{t}-\eta({\bm{g}}_{t}^{\parallel}+{\bm{g}}%
_{t}^{\perp})-\left({\bm{z}}_{t}+\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}(-%
\eta({\bm{g}}_{t}^{\parallel}+{\bm{g}}_{t}^{\perp}))\right)\right\|" class="ltx_Math" display="inline" id="A4.Ex7.m1.1"><semantics id="A4.Ex7.m1.1a"><mrow id="A4.Ex7.m1.1.1" xref="A4.Ex7.m1.1.1.cmml"><mi id="A4.Ex7.m1.1.1.3" xref="A4.Ex7.m1.1.1.3.cmml"></mi><mo id="A4.Ex7.m1.1.1.2" xref="A4.Ex7.m1.1.1.2.cmml">≈</mo><mrow id="A4.Ex7.m1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.2.cmml"><mo id="A4.Ex7.m1.1.1.1.1.2" xref="A4.Ex7.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A4.Ex7.m1.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.cmml"><msub id="A4.Ex7.m1.1.1.1.1.1.4" xref="A4.Ex7.m1.1.1.1.1.1.4.cmml"><mi id="A4.Ex7.m1.1.1.1.1.1.4.2" xref="A4.Ex7.m1.1.1.1.1.1.4.2.cmml">𝒛</mi><mi id="A4.Ex7.m1.1.1.1.1.1.4.3" xref="A4.Ex7.m1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="A4.Ex7.m1.1.1.1.1.1.3" xref="A4.Ex7.m1.1.1.1.1.1.3.cmml">−</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.1.cmml"><mi id="A4.Ex7.m1.1.1.1.1.1.1.3" xref="A4.Ex7.m1.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex7.m1.1.1.1.1.1.1.2" xref="A4.Ex7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex7.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mo id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒈</mi><mi id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mo id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">⟂</mo></msubsup></mrow><mo id="A4.Ex7.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.Ex7.m1.1.1.1.1.1.3a" xref="A4.Ex7.m1.1.1.1.1.1.3.cmml">−</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.2.1" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.cmml"><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.2.1.1" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.cmml"><msub id="A4.Ex7.m1.1.1.1.1.1.2.1.1.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.cmml"><mi id="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.2.cmml">𝒛</mi><mi id="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.3.cmml">t</mi></msub><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.2.cmml">+</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.cmml"><msub id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.2.cmml">𝒫</mi><mrow id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.cmml"><msub id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.cmml"><mi id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.2.cmml">T</mi><msub id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.cmml"><mi id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.2.cmml">𝒛</mi><mi id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.1" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.3.cmml">ℳ</mi></mrow></msub><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1a" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">−</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒈</mi><mi id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">⟂</mo></msubsup></mrow><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex7.m1.1.1.1.1.1.2.1.3" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="A4.Ex7.m1.1.1.1.1.3" xref="A4.Ex7.m1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex7.m1.1b"><apply id="A4.Ex7.m1.1.1.cmml" xref="A4.Ex7.m1.1.1"><approx id="A4.Ex7.m1.1.1.2.cmml" xref="A4.Ex7.m1.1.1.2"></approx><csymbol cd="latexml" id="A4.Ex7.m1.1.1.3.cmml" xref="A4.Ex7.m1.1.1.3">absent</csymbol><apply id="A4.Ex7.m1.1.1.1.2.cmml" xref="A4.Ex7.m1.1.1.1.1"><csymbol cd="latexml" id="A4.Ex7.m1.1.1.1.2.1.cmml" xref="A4.Ex7.m1.1.1.1.1.2">norm</csymbol><apply id="A4.Ex7.m1.1.1.1.1.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1"><minus id="A4.Ex7.m1.1.1.1.1.1.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.3"></minus><apply id="A4.Ex7.m1.1.1.1.1.1.4.cmml" xref="A4.Ex7.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.4.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.4">subscript</csymbol><ci id="A4.Ex7.m1.1.1.1.1.1.4.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.4.2">𝒛</ci><ci id="A4.Ex7.m1.1.1.1.1.1.4.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.4.3">𝑡</ci></apply><apply id="A4.Ex7.m1.1.1.1.1.1.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1"><times id="A4.Ex7.m1.1.1.1.1.1.1.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.2"></times><ci id="A4.Ex7.m1.1.1.1.1.1.1.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1"><plus id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝒈</ci><ci id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.2.3">parallel-to</csymbol></apply><apply id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝒈</ci><ci id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.1.1.1.1.3.3">perpendicular-to</csymbol></apply></apply></apply><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1"><plus id="A4.Ex7.m1.1.1.1.1.1.2.1.1.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.2"></plus><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.2">𝒛</ci><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.3.3">𝑡</ci></apply><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1"><times id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.2"></times><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.2">𝒫</ci><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3"><times id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.1"></times><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2">subscript</csymbol><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.2">𝑇</ci><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3">subscript</csymbol><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.2">𝒛</ci><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.3.3.3">ℳ</ci></apply></apply><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1"><minus id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1"></minus><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1"><times id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2"></times><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><plus id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒈</ci><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3">parallel-to</csymbol></apply><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.2">𝒈</ci><ci id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.Ex7.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.3">perpendicular-to</csymbol></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex7.m1.1c">\displaystyle\approx\left\|{\bm{z}}_{t}-\eta({\bm{g}}_{t}^{\parallel}+{\bm{g}}%
_{t}^{\perp})-\left({\bm{z}}_{t}+\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}(-%
\eta({\bm{g}}_{t}^{\parallel}+{\bm{g}}_{t}^{\perp}))\right)\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex7.m1.1d">≈ ∥ bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_η ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ) - ( bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ( - italic_η ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ) ) ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|-\eta({\bm{g}}_{t}^{\parallel}+{\bm{g}}_{t}^{\perp})+\eta%
\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}({\bm{g}}_{t}^{\parallel}+{\bm{g}}_{t%
}^{\perp})\right\|" class="ltx_Math" display="inline" id="A4.Ex8.m1.1"><semantics id="A4.Ex8.m1.1a"><mrow id="A4.Ex8.m1.1.1" xref="A4.Ex8.m1.1.1.cmml"><mi id="A4.Ex8.m1.1.1.3" xref="A4.Ex8.m1.1.1.3.cmml"></mi><mo id="A4.Ex8.m1.1.1.2" xref="A4.Ex8.m1.1.1.2.cmml">=</mo><mrow id="A4.Ex8.m1.1.1.1.1" xref="A4.Ex8.m1.1.1.1.2.cmml"><mo id="A4.Ex8.m1.1.1.1.1.2" xref="A4.Ex8.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A4.Ex8.m1.1.1.1.1.1" xref="A4.Ex8.m1.1.1.1.1.1.cmml"><mrow id="A4.Ex8.m1.1.1.1.1.1.1" xref="A4.Ex8.m1.1.1.1.1.1.1.cmml"><mo id="A4.Ex8.m1.1.1.1.1.1.1a" xref="A4.Ex8.m1.1.1.1.1.1.1.cmml">−</mo><mrow id="A4.Ex8.m1.1.1.1.1.1.1.1" xref="A4.Ex8.m1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex8.m1.1.1.1.1.1.1.1.3" xref="A4.Ex8.m1.1.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex8.m1.1.1.1.1.1.1.1.2" xref="A4.Ex8.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mo id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒈</mi><mi id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mo id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">⟂</mo></msubsup></mrow><mo id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex8.m1.1.1.1.1.1.3" xref="A4.Ex8.m1.1.1.1.1.1.3.cmml">+</mo><mrow id="A4.Ex8.m1.1.1.1.1.1.2" xref="A4.Ex8.m1.1.1.1.1.1.2.cmml"><mi id="A4.Ex8.m1.1.1.1.1.1.2.3" xref="A4.Ex8.m1.1.1.1.1.1.2.3.cmml">η</mi><mo id="A4.Ex8.m1.1.1.1.1.1.2.2" xref="A4.Ex8.m1.1.1.1.1.1.2.2.cmml">⁢</mo><msub id="A4.Ex8.m1.1.1.1.1.1.2.4" xref="A4.Ex8.m1.1.1.1.1.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex8.m1.1.1.1.1.1.2.4.2" xref="A4.Ex8.m1.1.1.1.1.1.2.4.2.cmml">𝒫</mi><mrow id="A4.Ex8.m1.1.1.1.1.1.2.4.3" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.cmml"><msub id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.cmml"><mi id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.2" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.2.cmml">T</mi><msub id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.cmml"><mi id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.2" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.2.cmml">𝒛</mi><mi id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.3" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.Ex8.m1.1.1.1.1.1.2.4.3.1" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex8.m1.1.1.1.1.1.2.4.3.3" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.3.cmml">ℳ</mi></mrow></msub><mo id="A4.Ex8.m1.1.1.1.1.1.2.2a" xref="A4.Ex8.m1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A4.Ex8.m1.1.1.1.1.1.2.1.1" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A4.Ex8.m1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.cmml"><msubsup id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.2.2" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.2.3" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.2.3.cmml">t</mi><mo id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.3" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.1" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.1.cmml">+</mo><msubsup id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.2.2" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.2.2.cmml">𝒈</mi><mi id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.2.3" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.2.3.cmml">t</mi><mo id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.3" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.3.cmml">⟂</mo></msubsup></mrow><mo id="A4.Ex8.m1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex8.m1.1.1.1.1.3" xref="A4.Ex8.m1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex8.m1.1b"><apply id="A4.Ex8.m1.1.1.cmml" xref="A4.Ex8.m1.1.1"><eq id="A4.Ex8.m1.1.1.2.cmml" xref="A4.Ex8.m1.1.1.2"></eq><csymbol cd="latexml" id="A4.Ex8.m1.1.1.3.cmml" xref="A4.Ex8.m1.1.1.3">absent</csymbol><apply id="A4.Ex8.m1.1.1.1.2.cmml" xref="A4.Ex8.m1.1.1.1.1"><csymbol cd="latexml" id="A4.Ex8.m1.1.1.1.2.1.cmml" xref="A4.Ex8.m1.1.1.1.1.2">norm</csymbol><apply id="A4.Ex8.m1.1.1.1.1.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1"><plus id="A4.Ex8.m1.1.1.1.1.1.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.3"></plus><apply id="A4.Ex8.m1.1.1.1.1.1.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1"><minus id="A4.Ex8.m1.1.1.1.1.1.1.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1"></minus><apply id="A4.Ex8.m1.1.1.1.1.1.1.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1"><times id="A4.Ex8.m1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.2"></times><ci id="A4.Ex8.m1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1"><plus id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒈</ci><ci id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.2.3">parallel-to</csymbol></apply><apply id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝒈</ci><ci id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.1.1.1.1.1.3.3">perpendicular-to</csymbol></apply></apply></apply></apply><apply id="A4.Ex8.m1.1.1.1.1.1.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2"><times id="A4.Ex8.m1.1.1.1.1.1.2.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.2"></times><ci id="A4.Ex8.m1.1.1.1.1.1.2.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.3">𝜂</ci><apply id="A4.Ex8.m1.1.1.1.1.1.2.4.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.2.4.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4">subscript</csymbol><ci id="A4.Ex8.m1.1.1.1.1.1.2.4.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.2">𝒫</ci><apply id="A4.Ex8.m1.1.1.1.1.1.2.4.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3"><times id="A4.Ex8.m1.1.1.1.1.1.2.4.3.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.1"></times><apply id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2">subscript</csymbol><ci id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.2">𝑇</ci><apply id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3">subscript</csymbol><ci id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.2">𝒛</ci><ci id="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.Ex8.m1.1.1.1.1.1.2.4.3.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.4.3.3">ℳ</ci></apply></apply><apply id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1"><plus id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.1"></plus><apply id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2">superscript</csymbol><apply id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.2.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2">subscript</csymbol><ci id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.2.2">𝒈</ci><ci id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.2.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.2.3">parallel-to</csymbol></apply><apply id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3">superscript</csymbol><apply id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.2.1.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.2.2.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.2.2">𝒈</ci><ci id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.2.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="A4.Ex8.m1.1.1.1.1.1.2.1.1.1.3.3">perpendicular-to</csymbol></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex8.m1.1c">\displaystyle=\left\|-\eta({\bm{g}}_{t}^{\parallel}+{\bm{g}}_{t}^{\perp})+\eta%
\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}({\bm{g}}_{t}^{\parallel}+{\bm{g}}_{t%
}^{\perp})\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex8.m1.1d">= ∥ - italic_η ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ) + italic_η caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|-\eta{\bm{g}}_{t}^{\perp}+\eta\mathcal{P}_{T_{{\bm{z}}_{t%
}}\mathcal{M}}({\bm{g}}_{t}^{\perp})\right\|" class="ltx_Math" display="inline" id="A4.Ex9.m1.1"><semantics id="A4.Ex9.m1.1a"><mrow id="A4.Ex9.m1.1.1" xref="A4.Ex9.m1.1.1.cmml"><mi id="A4.Ex9.m1.1.1.3" xref="A4.Ex9.m1.1.1.3.cmml"></mi><mo id="A4.Ex9.m1.1.1.2" xref="A4.Ex9.m1.1.1.2.cmml">=</mo><mrow id="A4.Ex9.m1.1.1.1.1" xref="A4.Ex9.m1.1.1.1.2.cmml"><mo id="A4.Ex9.m1.1.1.1.1.2" xref="A4.Ex9.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A4.Ex9.m1.1.1.1.1.1" xref="A4.Ex9.m1.1.1.1.1.1.cmml"><mrow id="A4.Ex9.m1.1.1.1.1.1.3" xref="A4.Ex9.m1.1.1.1.1.1.3.cmml"><mo id="A4.Ex9.m1.1.1.1.1.1.3a" xref="A4.Ex9.m1.1.1.1.1.1.3.cmml">−</mo><mrow id="A4.Ex9.m1.1.1.1.1.1.3.2" xref="A4.Ex9.m1.1.1.1.1.1.3.2.cmml"><mi id="A4.Ex9.m1.1.1.1.1.1.3.2.2" xref="A4.Ex9.m1.1.1.1.1.1.3.2.2.cmml">η</mi><mo id="A4.Ex9.m1.1.1.1.1.1.3.2.1" xref="A4.Ex9.m1.1.1.1.1.1.3.2.1.cmml">⁢</mo><msubsup id="A4.Ex9.m1.1.1.1.1.1.3.2.3" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3.cmml"><mi id="A4.Ex9.m1.1.1.1.1.1.3.2.3.2.2" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3.2.2.cmml">𝒈</mi><mi id="A4.Ex9.m1.1.1.1.1.1.3.2.3.2.3" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3.2.3.cmml">t</mi><mo id="A4.Ex9.m1.1.1.1.1.1.3.2.3.3" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3.3.cmml">⟂</mo></msubsup></mrow></mrow><mo id="A4.Ex9.m1.1.1.1.1.1.2" xref="A4.Ex9.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="A4.Ex9.m1.1.1.1.1.1.1" xref="A4.Ex9.m1.1.1.1.1.1.1.cmml"><mi id="A4.Ex9.m1.1.1.1.1.1.1.3" xref="A4.Ex9.m1.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex9.m1.1.1.1.1.1.1.2" xref="A4.Ex9.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="A4.Ex9.m1.1.1.1.1.1.1.4" xref="A4.Ex9.m1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex9.m1.1.1.1.1.1.1.4.2" xref="A4.Ex9.m1.1.1.1.1.1.1.4.2.cmml">𝒫</mi><mrow id="A4.Ex9.m1.1.1.1.1.1.1.4.3" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.cmml"><msub id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.cmml"><mi id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.2" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.2.cmml">T</mi><msub id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.cmml"><mi id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.2" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.2.cmml">𝒛</mi><mi id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.3" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.Ex9.m1.1.1.1.1.1.1.4.3.1" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex9.m1.1.1.1.1.1.1.4.3.3" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.3.cmml">ℳ</mi></mrow></msub><mo id="A4.Ex9.m1.1.1.1.1.1.1.2a" xref="A4.Ex9.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex9.m1.1.1.1.1.1.1.1.1" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex9.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mo id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.Ex9.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex9.m1.1.1.1.1.3" xref="A4.Ex9.m1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex9.m1.1b"><apply id="A4.Ex9.m1.1.1.cmml" xref="A4.Ex9.m1.1.1"><eq id="A4.Ex9.m1.1.1.2.cmml" xref="A4.Ex9.m1.1.1.2"></eq><csymbol cd="latexml" id="A4.Ex9.m1.1.1.3.cmml" xref="A4.Ex9.m1.1.1.3">absent</csymbol><apply id="A4.Ex9.m1.1.1.1.2.cmml" xref="A4.Ex9.m1.1.1.1.1"><csymbol cd="latexml" id="A4.Ex9.m1.1.1.1.2.1.cmml" xref="A4.Ex9.m1.1.1.1.1.2">norm</csymbol><apply id="A4.Ex9.m1.1.1.1.1.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1"><plus id="A4.Ex9.m1.1.1.1.1.1.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.2"></plus><apply id="A4.Ex9.m1.1.1.1.1.1.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3"><minus id="A4.Ex9.m1.1.1.1.1.1.3.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3"></minus><apply id="A4.Ex9.m1.1.1.1.1.1.3.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3.2"><times id="A4.Ex9.m1.1.1.1.1.1.3.2.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3.2.1"></times><ci id="A4.Ex9.m1.1.1.1.1.1.3.2.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3.2.2">𝜂</ci><apply id="A4.Ex9.m1.1.1.1.1.1.3.2.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A4.Ex9.m1.1.1.1.1.1.3.2.3.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3">superscript</csymbol><apply id="A4.Ex9.m1.1.1.1.1.1.3.2.3.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A4.Ex9.m1.1.1.1.1.1.3.2.3.2.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="A4.Ex9.m1.1.1.1.1.1.3.2.3.2.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3.2.2">𝒈</ci><ci id="A4.Ex9.m1.1.1.1.1.1.3.2.3.2.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex9.m1.1.1.1.1.1.3.2.3.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.3.2.3.3">perpendicular-to</csymbol></apply></apply></apply><apply id="A4.Ex9.m1.1.1.1.1.1.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1"><times id="A4.Ex9.m1.1.1.1.1.1.1.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.2"></times><ci id="A4.Ex9.m1.1.1.1.1.1.1.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex9.m1.1.1.1.1.1.1.4.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A4.Ex9.m1.1.1.1.1.1.1.4.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A4.Ex9.m1.1.1.1.1.1.1.4.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.2">𝒫</ci><apply id="A4.Ex9.m1.1.1.1.1.1.1.4.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3"><times id="A4.Ex9.m1.1.1.1.1.1.1.4.3.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.1"></times><apply id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2"><csymbol cd="ambiguous" id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2">subscript</csymbol><ci id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.2">𝑇</ci><apply id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3"><csymbol cd="ambiguous" id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3">subscript</csymbol><ci id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.2">𝒛</ci><ci id="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.Ex9.m1.1.1.1.1.1.1.4.3.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.4.3.3">ℳ</ci></apply></apply><apply id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.2.2">𝒈</ci><ci id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex9.m1.1.1.1.1.1.1.1.1.1.3">perpendicular-to</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex9.m1.1c">\displaystyle=\left\|-\eta{\bm{g}}_{t}^{\perp}+\eta\mathcal{P}_{T_{{\bm{z}}_{t%
}}\mathcal{M}}({\bm{g}}_{t}^{\perp})\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex9.m1.1d">= ∥ - italic_η bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT + italic_η caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\eta\left\|{\bm{g}}_{t}^{\perp}-\mathcal{P}_{T_{{\bm{z}}_{t}}%
\mathcal{M}}({\bm{g}}_{t}^{\perp})\right\|." class="ltx_Math" display="inline" id="A4.Ex10.m1.1"><semantics id="A4.Ex10.m1.1a"><mrow id="A4.Ex10.m1.1.1.1" xref="A4.Ex10.m1.1.1.1.1.cmml"><mrow id="A4.Ex10.m1.1.1.1.1" xref="A4.Ex10.m1.1.1.1.1.cmml"><mi id="A4.Ex10.m1.1.1.1.1.3" xref="A4.Ex10.m1.1.1.1.1.3.cmml"></mi><mo id="A4.Ex10.m1.1.1.1.1.2" xref="A4.Ex10.m1.1.1.1.1.2.cmml">=</mo><mrow id="A4.Ex10.m1.1.1.1.1.1" xref="A4.Ex10.m1.1.1.1.1.1.cmml"><mi id="A4.Ex10.m1.1.1.1.1.1.3" xref="A4.Ex10.m1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex10.m1.1.1.1.1.1.2" xref="A4.Ex10.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex10.m1.1.1.1.1.1.1.1" xref="A4.Ex10.m1.1.1.1.1.1.1.2.cmml"><mo id="A4.Ex10.m1.1.1.1.1.1.1.1.2" xref="A4.Ex10.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A4.Ex10.m1.1.1.1.1.1.1.1.1" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.2.2" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒈</mi><mi id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.2.3" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mo id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.3" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.3.cmml">⟂</mo></msubsup><mo id="A4.Ex10.m1.1.1.1.1.1.1.1.1.2" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.2" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒫</mi><mrow id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><msub id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">T</mi><msub id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.2" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.2.cmml">𝒛</mi><mi id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.3" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">ℳ</mi></mrow></msub><mo id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mo id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex10.m1.1.1.1.1.1.1.1.3" xref="A4.Ex10.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="A4.Ex10.m1.1.1.1.2" lspace="0em" xref="A4.Ex10.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex10.m1.1b"><apply id="A4.Ex10.m1.1.1.1.1.cmml" xref="A4.Ex10.m1.1.1.1"><eq id="A4.Ex10.m1.1.1.1.1.2.cmml" xref="A4.Ex10.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="A4.Ex10.m1.1.1.1.1.3.cmml" xref="A4.Ex10.m1.1.1.1.1.3">absent</csymbol><apply id="A4.Ex10.m1.1.1.1.1.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1"><times id="A4.Ex10.m1.1.1.1.1.1.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.2"></times><ci id="A4.Ex10.m1.1.1.1.1.1.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex10.m1.1.1.1.1.1.1.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A4.Ex10.m1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A4.Ex10.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1"><minus id="A4.Ex10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.2"></minus><apply id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.2.2">𝒈</ci><ci id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.3.3">perpendicular-to</csymbol></apply><apply id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1"><times id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.2">𝒫</ci><apply id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3"><times id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.1"></times><apply id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.2">𝑇</ci><apply id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.2">𝒛</ci><ci id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.3.3.3">ℳ</ci></apply></apply><apply id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒈</ci><ci id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">perpendicular-to</csymbol></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex10.m1.1c">\displaystyle=\eta\left\|{\bm{g}}_{t}^{\perp}-\mathcal{P}_{T_{{\bm{z}}_{t}}%
\mathcal{M}}({\bm{g}}_{t}^{\perp})\right\|.</annotation><annotation encoding="application/x-llamapun" id="A4.Ex10.m1.1d">= italic_η ∥ bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT - caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ) ∥ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A4.9.p9">
<p class="ltx_p" id="A4.9.p9.2">Since <math alttext="{\bm{g}}_{t}^{\perp}\in N_{{\bm{z}}_{t}}\mathcal{M}" class="ltx_Math" display="inline" id="A4.9.p9.1.m1.1"><semantics id="A4.9.p9.1.m1.1a"><mrow id="A4.9.p9.1.m1.1.1" xref="A4.9.p9.1.m1.1.1.cmml"><msubsup id="A4.9.p9.1.m1.1.1.2" xref="A4.9.p9.1.m1.1.1.2.cmml"><mi id="A4.9.p9.1.m1.1.1.2.2.2" xref="A4.9.p9.1.m1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.9.p9.1.m1.1.1.2.2.3" xref="A4.9.p9.1.m1.1.1.2.2.3.cmml">t</mi><mo id="A4.9.p9.1.m1.1.1.2.3" xref="A4.9.p9.1.m1.1.1.2.3.cmml">⟂</mo></msubsup><mo id="A4.9.p9.1.m1.1.1.1" xref="A4.9.p9.1.m1.1.1.1.cmml">∈</mo><mrow id="A4.9.p9.1.m1.1.1.3" xref="A4.9.p9.1.m1.1.1.3.cmml"><msub id="A4.9.p9.1.m1.1.1.3.2" xref="A4.9.p9.1.m1.1.1.3.2.cmml"><mi id="A4.9.p9.1.m1.1.1.3.2.2" xref="A4.9.p9.1.m1.1.1.3.2.2.cmml">N</mi><msub id="A4.9.p9.1.m1.1.1.3.2.3" xref="A4.9.p9.1.m1.1.1.3.2.3.cmml"><mi id="A4.9.p9.1.m1.1.1.3.2.3.2" xref="A4.9.p9.1.m1.1.1.3.2.3.2.cmml">𝒛</mi><mi id="A4.9.p9.1.m1.1.1.3.2.3.3" xref="A4.9.p9.1.m1.1.1.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.9.p9.1.m1.1.1.3.1" xref="A4.9.p9.1.m1.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.9.p9.1.m1.1.1.3.3" xref="A4.9.p9.1.m1.1.1.3.3.cmml">ℳ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.9.p9.1.m1.1b"><apply id="A4.9.p9.1.m1.1.1.cmml" xref="A4.9.p9.1.m1.1.1"><in id="A4.9.p9.1.m1.1.1.1.cmml" xref="A4.9.p9.1.m1.1.1.1"></in><apply id="A4.9.p9.1.m1.1.1.2.cmml" xref="A4.9.p9.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.9.p9.1.m1.1.1.2.1.cmml" xref="A4.9.p9.1.m1.1.1.2">superscript</csymbol><apply id="A4.9.p9.1.m1.1.1.2.2.cmml" xref="A4.9.p9.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.9.p9.1.m1.1.1.2.2.1.cmml" xref="A4.9.p9.1.m1.1.1.2">subscript</csymbol><ci id="A4.9.p9.1.m1.1.1.2.2.2.cmml" xref="A4.9.p9.1.m1.1.1.2.2.2">𝒈</ci><ci id="A4.9.p9.1.m1.1.1.2.2.3.cmml" xref="A4.9.p9.1.m1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.9.p9.1.m1.1.1.2.3.cmml" xref="A4.9.p9.1.m1.1.1.2.3">perpendicular-to</csymbol></apply><apply id="A4.9.p9.1.m1.1.1.3.cmml" xref="A4.9.p9.1.m1.1.1.3"><times id="A4.9.p9.1.m1.1.1.3.1.cmml" xref="A4.9.p9.1.m1.1.1.3.1"></times><apply id="A4.9.p9.1.m1.1.1.3.2.cmml" xref="A4.9.p9.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A4.9.p9.1.m1.1.1.3.2.1.cmml" xref="A4.9.p9.1.m1.1.1.3.2">subscript</csymbol><ci id="A4.9.p9.1.m1.1.1.3.2.2.cmml" xref="A4.9.p9.1.m1.1.1.3.2.2">𝑁</ci><apply id="A4.9.p9.1.m1.1.1.3.2.3.cmml" xref="A4.9.p9.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A4.9.p9.1.m1.1.1.3.2.3.1.cmml" xref="A4.9.p9.1.m1.1.1.3.2.3">subscript</csymbol><ci id="A4.9.p9.1.m1.1.1.3.2.3.2.cmml" xref="A4.9.p9.1.m1.1.1.3.2.3.2">𝒛</ci><ci id="A4.9.p9.1.m1.1.1.3.2.3.3.cmml" xref="A4.9.p9.1.m1.1.1.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.9.p9.1.m1.1.1.3.3.cmml" xref="A4.9.p9.1.m1.1.1.3.3">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.9.p9.1.m1.1c">{\bm{g}}_{t}^{\perp}\in N_{{\bm{z}}_{t}}\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.9.p9.1.m1.1d">bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∈ italic_N start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M</annotation></semantics></math> and <math alttext="\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}({\bm{g}}_{t}^{\perp})=\mathbf{0}" class="ltx_Math" display="inline" id="A4.9.p9.2.m2.1"><semantics id="A4.9.p9.2.m2.1a"><mrow id="A4.9.p9.2.m2.1.1" xref="A4.9.p9.2.m2.1.1.cmml"><mrow id="A4.9.p9.2.m2.1.1.1" xref="A4.9.p9.2.m2.1.1.1.cmml"><msub id="A4.9.p9.2.m2.1.1.1.3" xref="A4.9.p9.2.m2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.9.p9.2.m2.1.1.1.3.2" xref="A4.9.p9.2.m2.1.1.1.3.2.cmml">𝒫</mi><mrow id="A4.9.p9.2.m2.1.1.1.3.3" xref="A4.9.p9.2.m2.1.1.1.3.3.cmml"><msub id="A4.9.p9.2.m2.1.1.1.3.3.2" xref="A4.9.p9.2.m2.1.1.1.3.3.2.cmml"><mi id="A4.9.p9.2.m2.1.1.1.3.3.2.2" xref="A4.9.p9.2.m2.1.1.1.3.3.2.2.cmml">T</mi><msub id="A4.9.p9.2.m2.1.1.1.3.3.2.3" xref="A4.9.p9.2.m2.1.1.1.3.3.2.3.cmml"><mi id="A4.9.p9.2.m2.1.1.1.3.3.2.3.2" xref="A4.9.p9.2.m2.1.1.1.3.3.2.3.2.cmml">𝒛</mi><mi id="A4.9.p9.2.m2.1.1.1.3.3.2.3.3" xref="A4.9.p9.2.m2.1.1.1.3.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.9.p9.2.m2.1.1.1.3.3.1" xref="A4.9.p9.2.m2.1.1.1.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.9.p9.2.m2.1.1.1.3.3.3" xref="A4.9.p9.2.m2.1.1.1.3.3.3.cmml">ℳ</mi></mrow></msub><mo id="A4.9.p9.2.m2.1.1.1.2" xref="A4.9.p9.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="A4.9.p9.2.m2.1.1.1.1.1" xref="A4.9.p9.2.m2.1.1.1.1.1.1.cmml"><mo id="A4.9.p9.2.m2.1.1.1.1.1.2" stretchy="false" xref="A4.9.p9.2.m2.1.1.1.1.1.1.cmml">(</mo><msubsup id="A4.9.p9.2.m2.1.1.1.1.1.1" xref="A4.9.p9.2.m2.1.1.1.1.1.1.cmml"><mi id="A4.9.p9.2.m2.1.1.1.1.1.1.2.2" xref="A4.9.p9.2.m2.1.1.1.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.9.p9.2.m2.1.1.1.1.1.1.2.3" xref="A4.9.p9.2.m2.1.1.1.1.1.1.2.3.cmml">t</mi><mo id="A4.9.p9.2.m2.1.1.1.1.1.1.3" xref="A4.9.p9.2.m2.1.1.1.1.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.9.p9.2.m2.1.1.1.1.1.3" stretchy="false" xref="A4.9.p9.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.9.p9.2.m2.1.1.2" xref="A4.9.p9.2.m2.1.1.2.cmml">=</mo><mn id="A4.9.p9.2.m2.1.1.3" xref="A4.9.p9.2.m2.1.1.3.cmml">𝟎</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.9.p9.2.m2.1b"><apply id="A4.9.p9.2.m2.1.1.cmml" xref="A4.9.p9.2.m2.1.1"><eq id="A4.9.p9.2.m2.1.1.2.cmml" xref="A4.9.p9.2.m2.1.1.2"></eq><apply id="A4.9.p9.2.m2.1.1.1.cmml" xref="A4.9.p9.2.m2.1.1.1"><times id="A4.9.p9.2.m2.1.1.1.2.cmml" xref="A4.9.p9.2.m2.1.1.1.2"></times><apply id="A4.9.p9.2.m2.1.1.1.3.cmml" xref="A4.9.p9.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="A4.9.p9.2.m2.1.1.1.3.1.cmml" xref="A4.9.p9.2.m2.1.1.1.3">subscript</csymbol><ci id="A4.9.p9.2.m2.1.1.1.3.2.cmml" xref="A4.9.p9.2.m2.1.1.1.3.2">𝒫</ci><apply id="A4.9.p9.2.m2.1.1.1.3.3.cmml" xref="A4.9.p9.2.m2.1.1.1.3.3"><times id="A4.9.p9.2.m2.1.1.1.3.3.1.cmml" xref="A4.9.p9.2.m2.1.1.1.3.3.1"></times><apply id="A4.9.p9.2.m2.1.1.1.3.3.2.cmml" xref="A4.9.p9.2.m2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A4.9.p9.2.m2.1.1.1.3.3.2.1.cmml" xref="A4.9.p9.2.m2.1.1.1.3.3.2">subscript</csymbol><ci id="A4.9.p9.2.m2.1.1.1.3.3.2.2.cmml" xref="A4.9.p9.2.m2.1.1.1.3.3.2.2">𝑇</ci><apply id="A4.9.p9.2.m2.1.1.1.3.3.2.3.cmml" xref="A4.9.p9.2.m2.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A4.9.p9.2.m2.1.1.1.3.3.2.3.1.cmml" xref="A4.9.p9.2.m2.1.1.1.3.3.2.3">subscript</csymbol><ci id="A4.9.p9.2.m2.1.1.1.3.3.2.3.2.cmml" xref="A4.9.p9.2.m2.1.1.1.3.3.2.3.2">𝒛</ci><ci id="A4.9.p9.2.m2.1.1.1.3.3.2.3.3.cmml" xref="A4.9.p9.2.m2.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.9.p9.2.m2.1.1.1.3.3.3.cmml" xref="A4.9.p9.2.m2.1.1.1.3.3.3">ℳ</ci></apply></apply><apply id="A4.9.p9.2.m2.1.1.1.1.1.1.cmml" xref="A4.9.p9.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.9.p9.2.m2.1.1.1.1.1.1.1.cmml" xref="A4.9.p9.2.m2.1.1.1.1.1">superscript</csymbol><apply id="A4.9.p9.2.m2.1.1.1.1.1.1.2.cmml" xref="A4.9.p9.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.9.p9.2.m2.1.1.1.1.1.1.2.1.cmml" xref="A4.9.p9.2.m2.1.1.1.1.1">subscript</csymbol><ci id="A4.9.p9.2.m2.1.1.1.1.1.1.2.2.cmml" xref="A4.9.p9.2.m2.1.1.1.1.1.1.2.2">𝒈</ci><ci id="A4.9.p9.2.m2.1.1.1.1.1.1.2.3.cmml" xref="A4.9.p9.2.m2.1.1.1.1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.9.p9.2.m2.1.1.1.1.1.1.3.cmml" xref="A4.9.p9.2.m2.1.1.1.1.1.1.3">perpendicular-to</csymbol></apply></apply><cn id="A4.9.p9.2.m2.1.1.3.cmml" type="integer" xref="A4.9.p9.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.9.p9.2.m2.1c">\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}({\bm{g}}_{t}^{\perp})=\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="A4.9.p9.2.m2.1d">caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ) = bold_0</annotation></semantics></math>, we have:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{dist}({\bm{z}}_{t-1},\mathcal{M})=\eta\left\|{\bm{g}}_{t}^{\perp}\right\|." class="ltx_Math" display="block" id="A4.E9.m1.2"><semantics id="A4.E9.m1.2a"><mrow id="A4.E9.m1.2.2.1" xref="A4.E9.m1.2.2.1.1.cmml"><mrow id="A4.E9.m1.2.2.1.1" xref="A4.E9.m1.2.2.1.1.cmml"><mrow id="A4.E9.m1.2.2.1.1.1" xref="A4.E9.m1.2.2.1.1.1.cmml"><mtext id="A4.E9.m1.2.2.1.1.1.3" xref="A4.E9.m1.2.2.1.1.1.3a.cmml">dist</mtext><mo id="A4.E9.m1.2.2.1.1.1.2" xref="A4.E9.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A4.E9.m1.2.2.1.1.1.1.1" xref="A4.E9.m1.2.2.1.1.1.1.2.cmml"><mo id="A4.E9.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="A4.E9.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="A4.E9.m1.2.2.1.1.1.1.1.1" xref="A4.E9.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A4.E9.m1.2.2.1.1.1.1.1.1.2" xref="A4.E9.m1.2.2.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="A4.E9.m1.2.2.1.1.1.1.1.1.3" xref="A4.E9.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A4.E9.m1.2.2.1.1.1.1.1.1.3.2" xref="A4.E9.m1.2.2.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="A4.E9.m1.2.2.1.1.1.1.1.1.3.1" xref="A4.E9.m1.2.2.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A4.E9.m1.2.2.1.1.1.1.1.1.3.3" xref="A4.E9.m1.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A4.E9.m1.2.2.1.1.1.1.1.3" xref="A4.E9.m1.2.2.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.E9.m1.1.1" xref="A4.E9.m1.1.1.cmml">ℳ</mi><mo id="A4.E9.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="A4.E9.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.E9.m1.2.2.1.1.3" xref="A4.E9.m1.2.2.1.1.3.cmml">=</mo><mrow id="A4.E9.m1.2.2.1.1.2" xref="A4.E9.m1.2.2.1.1.2.cmml"><mi id="A4.E9.m1.2.2.1.1.2.3" xref="A4.E9.m1.2.2.1.1.2.3.cmml">η</mi><mo id="A4.E9.m1.2.2.1.1.2.2" xref="A4.E9.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="A4.E9.m1.2.2.1.1.2.1.1" xref="A4.E9.m1.2.2.1.1.2.1.2.cmml"><mo id="A4.E9.m1.2.2.1.1.2.1.1.2" xref="A4.E9.m1.2.2.1.1.2.1.2.1.cmml">‖</mo><msubsup id="A4.E9.m1.2.2.1.1.2.1.1.1" xref="A4.E9.m1.2.2.1.1.2.1.1.1.cmml"><mi id="A4.E9.m1.2.2.1.1.2.1.1.1.2.2" xref="A4.E9.m1.2.2.1.1.2.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.E9.m1.2.2.1.1.2.1.1.1.2.3" xref="A4.E9.m1.2.2.1.1.2.1.1.1.2.3.cmml">t</mi><mo id="A4.E9.m1.2.2.1.1.2.1.1.1.3" xref="A4.E9.m1.2.2.1.1.2.1.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.E9.m1.2.2.1.1.2.1.1.3" xref="A4.E9.m1.2.2.1.1.2.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="A4.E9.m1.2.2.1.2" lspace="0em" xref="A4.E9.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E9.m1.2b"><apply id="A4.E9.m1.2.2.1.1.cmml" xref="A4.E9.m1.2.2.1"><eq id="A4.E9.m1.2.2.1.1.3.cmml" xref="A4.E9.m1.2.2.1.1.3"></eq><apply id="A4.E9.m1.2.2.1.1.1.cmml" xref="A4.E9.m1.2.2.1.1.1"><times id="A4.E9.m1.2.2.1.1.1.2.cmml" xref="A4.E9.m1.2.2.1.1.1.2"></times><ci id="A4.E9.m1.2.2.1.1.1.3a.cmml" xref="A4.E9.m1.2.2.1.1.1.3"><mtext id="A4.E9.m1.2.2.1.1.1.3.cmml" xref="A4.E9.m1.2.2.1.1.1.3">dist</mtext></ci><interval closure="open" id="A4.E9.m1.2.2.1.1.1.1.2.cmml" xref="A4.E9.m1.2.2.1.1.1.1.1"><apply id="A4.E9.m1.2.2.1.1.1.1.1.1.cmml" xref="A4.E9.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E9.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A4.E9.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A4.E9.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A4.E9.m1.2.2.1.1.1.1.1.1.2">𝒛</ci><apply id="A4.E9.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A4.E9.m1.2.2.1.1.1.1.1.1.3"><minus id="A4.E9.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A4.E9.m1.2.2.1.1.1.1.1.1.3.1"></minus><ci id="A4.E9.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A4.E9.m1.2.2.1.1.1.1.1.1.3.2">𝑡</ci><cn id="A4.E9.m1.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A4.E9.m1.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="A4.E9.m1.1.1.cmml" xref="A4.E9.m1.1.1">ℳ</ci></interval></apply><apply id="A4.E9.m1.2.2.1.1.2.cmml" xref="A4.E9.m1.2.2.1.1.2"><times id="A4.E9.m1.2.2.1.1.2.2.cmml" xref="A4.E9.m1.2.2.1.1.2.2"></times><ci id="A4.E9.m1.2.2.1.1.2.3.cmml" xref="A4.E9.m1.2.2.1.1.2.3">𝜂</ci><apply id="A4.E9.m1.2.2.1.1.2.1.2.cmml" xref="A4.E9.m1.2.2.1.1.2.1.1"><csymbol cd="latexml" id="A4.E9.m1.2.2.1.1.2.1.2.1.cmml" xref="A4.E9.m1.2.2.1.1.2.1.1.2">norm</csymbol><apply id="A4.E9.m1.2.2.1.1.2.1.1.1.cmml" xref="A4.E9.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A4.E9.m1.2.2.1.1.2.1.1.1.1.cmml" xref="A4.E9.m1.2.2.1.1.2.1.1.1">superscript</csymbol><apply id="A4.E9.m1.2.2.1.1.2.1.1.1.2.cmml" xref="A4.E9.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A4.E9.m1.2.2.1.1.2.1.1.1.2.1.cmml" xref="A4.E9.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="A4.E9.m1.2.2.1.1.2.1.1.1.2.2.cmml" xref="A4.E9.m1.2.2.1.1.2.1.1.1.2.2">𝒈</ci><ci id="A4.E9.m1.2.2.1.1.2.1.1.1.2.3.cmml" xref="A4.E9.m1.2.2.1.1.2.1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.E9.m1.2.2.1.1.2.1.1.1.3.cmml" xref="A4.E9.m1.2.2.1.1.2.1.1.1.3">perpendicular-to</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E9.m1.2c">\text{dist}({\bm{z}}_{t-1},\mathcal{M})=\eta\left\|{\bm{g}}_{t}^{\perp}\right\|.</annotation><annotation encoding="application/x-llamapun" id="A4.E9.m1.2d">dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , caligraphic_M ) = italic_η ∥ bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A4.10.p10">
<p class="ltx_p" id="A4.10.p10.2">Now, compute the distance from <math alttext="{\bm{z}}_{t-1}^{\prime}" class="ltx_Math" display="inline" id="A4.10.p10.1.m1.1"><semantics id="A4.10.p10.1.m1.1a"><msubsup id="A4.10.p10.1.m1.1.1" xref="A4.10.p10.1.m1.1.1.cmml"><mi id="A4.10.p10.1.m1.1.1.2.2" xref="A4.10.p10.1.m1.1.1.2.2.cmml">𝒛</mi><mrow id="A4.10.p10.1.m1.1.1.2.3" xref="A4.10.p10.1.m1.1.1.2.3.cmml"><mi id="A4.10.p10.1.m1.1.1.2.3.2" xref="A4.10.p10.1.m1.1.1.2.3.2.cmml">t</mi><mo id="A4.10.p10.1.m1.1.1.2.3.1" xref="A4.10.p10.1.m1.1.1.2.3.1.cmml">−</mo><mn id="A4.10.p10.1.m1.1.1.2.3.3" xref="A4.10.p10.1.m1.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.10.p10.1.m1.1.1.3" xref="A4.10.p10.1.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.10.p10.1.m1.1b"><apply id="A4.10.p10.1.m1.1.1.cmml" xref="A4.10.p10.1.m1.1.1"><csymbol cd="ambiguous" id="A4.10.p10.1.m1.1.1.1.cmml" xref="A4.10.p10.1.m1.1.1">superscript</csymbol><apply id="A4.10.p10.1.m1.1.1.2.cmml" xref="A4.10.p10.1.m1.1.1"><csymbol cd="ambiguous" id="A4.10.p10.1.m1.1.1.2.1.cmml" xref="A4.10.p10.1.m1.1.1">subscript</csymbol><ci id="A4.10.p10.1.m1.1.1.2.2.cmml" xref="A4.10.p10.1.m1.1.1.2.2">𝒛</ci><apply id="A4.10.p10.1.m1.1.1.2.3.cmml" xref="A4.10.p10.1.m1.1.1.2.3"><minus id="A4.10.p10.1.m1.1.1.2.3.1.cmml" xref="A4.10.p10.1.m1.1.1.2.3.1"></minus><ci id="A4.10.p10.1.m1.1.1.2.3.2.cmml" xref="A4.10.p10.1.m1.1.1.2.3.2">𝑡</ci><cn id="A4.10.p10.1.m1.1.1.2.3.3.cmml" type="integer" xref="A4.10.p10.1.m1.1.1.2.3.3">1</cn></apply></apply><ci id="A4.10.p10.1.m1.1.1.3.cmml" xref="A4.10.p10.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.10.p10.1.m1.1c">{\bm{z}}_{t-1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A4.10.p10.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="A4.10.p10.2.m2.1"><semantics id="A4.10.p10.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A4.10.p10.2.m2.1.1" xref="A4.10.p10.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="A4.10.p10.2.m2.1b"><ci id="A4.10.p10.2.m2.1.1.cmml" xref="A4.10.p10.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.10.p10.2.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.10.p10.2.m2.1d">caligraphic_M</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx2">
<tbody id="A4.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})" class="ltx_Math" display="inline" id="A4.Ex11.m1.2"><semantics id="A4.Ex11.m1.2a"><mrow id="A4.Ex11.m1.2.2" xref="A4.Ex11.m1.2.2.cmml"><mtext id="A4.Ex11.m1.2.2.3" xref="A4.Ex11.m1.2.2.3a.cmml">dist</mtext><mo id="A4.Ex11.m1.2.2.2" xref="A4.Ex11.m1.2.2.2.cmml">⁢</mo><mrow id="A4.Ex11.m1.2.2.1.1" xref="A4.Ex11.m1.2.2.1.2.cmml"><mo id="A4.Ex11.m1.2.2.1.1.2" stretchy="false" xref="A4.Ex11.m1.2.2.1.2.cmml">(</mo><msubsup id="A4.Ex11.m1.2.2.1.1.1" xref="A4.Ex11.m1.2.2.1.1.1.cmml"><mi id="A4.Ex11.m1.2.2.1.1.1.2.2" xref="A4.Ex11.m1.2.2.1.1.1.2.2.cmml">𝒛</mi><mrow id="A4.Ex11.m1.2.2.1.1.1.2.3" xref="A4.Ex11.m1.2.2.1.1.1.2.3.cmml"><mi id="A4.Ex11.m1.2.2.1.1.1.2.3.2" xref="A4.Ex11.m1.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="A4.Ex11.m1.2.2.1.1.1.2.3.1" xref="A4.Ex11.m1.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="A4.Ex11.m1.2.2.1.1.1.2.3.3" xref="A4.Ex11.m1.2.2.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.Ex11.m1.2.2.1.1.1.3" xref="A4.Ex11.m1.2.2.1.1.1.3.cmml">′</mo></msubsup><mo id="A4.Ex11.m1.2.2.1.1.3" xref="A4.Ex11.m1.2.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex11.m1.1.1" xref="A4.Ex11.m1.1.1.cmml">ℳ</mi><mo id="A4.Ex11.m1.2.2.1.1.4" stretchy="false" xref="A4.Ex11.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex11.m1.2b"><apply id="A4.Ex11.m1.2.2.cmml" xref="A4.Ex11.m1.2.2"><times id="A4.Ex11.m1.2.2.2.cmml" xref="A4.Ex11.m1.2.2.2"></times><ci id="A4.Ex11.m1.2.2.3a.cmml" xref="A4.Ex11.m1.2.2.3"><mtext id="A4.Ex11.m1.2.2.3.cmml" xref="A4.Ex11.m1.2.2.3">dist</mtext></ci><interval closure="open" id="A4.Ex11.m1.2.2.1.2.cmml" xref="A4.Ex11.m1.2.2.1.1"><apply id="A4.Ex11.m1.2.2.1.1.1.cmml" xref="A4.Ex11.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.Ex11.m1.2.2.1.1.1.1.cmml" xref="A4.Ex11.m1.2.2.1.1.1">superscript</csymbol><apply id="A4.Ex11.m1.2.2.1.1.1.2.cmml" xref="A4.Ex11.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.Ex11.m1.2.2.1.1.1.2.1.cmml" xref="A4.Ex11.m1.2.2.1.1.1">subscript</csymbol><ci id="A4.Ex11.m1.2.2.1.1.1.2.2.cmml" xref="A4.Ex11.m1.2.2.1.1.1.2.2">𝒛</ci><apply id="A4.Ex11.m1.2.2.1.1.1.2.3.cmml" xref="A4.Ex11.m1.2.2.1.1.1.2.3"><minus id="A4.Ex11.m1.2.2.1.1.1.2.3.1.cmml" xref="A4.Ex11.m1.2.2.1.1.1.2.3.1"></minus><ci id="A4.Ex11.m1.2.2.1.1.1.2.3.2.cmml" xref="A4.Ex11.m1.2.2.1.1.1.2.3.2">𝑡</ci><cn id="A4.Ex11.m1.2.2.1.1.1.2.3.3.cmml" type="integer" xref="A4.Ex11.m1.2.2.1.1.1.2.3.3">1</cn></apply></apply><ci id="A4.Ex11.m1.2.2.1.1.1.3.cmml" xref="A4.Ex11.m1.2.2.1.1.1.3">′</ci></apply><ci id="A4.Ex11.m1.1.1.cmml" xref="A4.Ex11.m1.1.1">ℳ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex11.m1.2c">\displaystyle\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})</annotation><annotation encoding="application/x-llamapun" id="A4.Ex11.m1.2d">dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|{\bm{z}}_{t-1}^{\prime}-\pi({\bm{z}}_{t-1}^{\prime})\right\|" class="ltx_Math" display="inline" id="A4.Ex11.m2.1"><semantics id="A4.Ex11.m2.1a"><mrow id="A4.Ex11.m2.1.1" xref="A4.Ex11.m2.1.1.cmml"><mi id="A4.Ex11.m2.1.1.3" xref="A4.Ex11.m2.1.1.3.cmml"></mi><mo id="A4.Ex11.m2.1.1.2" xref="A4.Ex11.m2.1.1.2.cmml">=</mo><mrow id="A4.Ex11.m2.1.1.1.1" xref="A4.Ex11.m2.1.1.1.2.cmml"><mo id="A4.Ex11.m2.1.1.1.1.2" xref="A4.Ex11.m2.1.1.1.2.1.cmml">‖</mo><mrow id="A4.Ex11.m2.1.1.1.1.1" xref="A4.Ex11.m2.1.1.1.1.1.cmml"><msubsup id="A4.Ex11.m2.1.1.1.1.1.3" xref="A4.Ex11.m2.1.1.1.1.1.3.cmml"><mi id="A4.Ex11.m2.1.1.1.1.1.3.2.2" xref="A4.Ex11.m2.1.1.1.1.1.3.2.2.cmml">𝒛</mi><mrow id="A4.Ex11.m2.1.1.1.1.1.3.2.3" xref="A4.Ex11.m2.1.1.1.1.1.3.2.3.cmml"><mi id="A4.Ex11.m2.1.1.1.1.1.3.2.3.2" xref="A4.Ex11.m2.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="A4.Ex11.m2.1.1.1.1.1.3.2.3.1" xref="A4.Ex11.m2.1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="A4.Ex11.m2.1.1.1.1.1.3.2.3.3" xref="A4.Ex11.m2.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mo id="A4.Ex11.m2.1.1.1.1.1.3.3" xref="A4.Ex11.m2.1.1.1.1.1.3.3.cmml">′</mo></msubsup><mo id="A4.Ex11.m2.1.1.1.1.1.2" xref="A4.Ex11.m2.1.1.1.1.1.2.cmml">−</mo><mrow id="A4.Ex11.m2.1.1.1.1.1.1" xref="A4.Ex11.m2.1.1.1.1.1.1.cmml"><mi id="A4.Ex11.m2.1.1.1.1.1.1.3" xref="A4.Ex11.m2.1.1.1.1.1.1.3.cmml">π</mi><mo id="A4.Ex11.m2.1.1.1.1.1.1.2" xref="A4.Ex11.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex11.m2.1.1.1.1.1.1.1.1" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex11.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.2" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.2" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.1" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.3" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="A4.Ex11.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex11.m2.1.1.1.1.3" xref="A4.Ex11.m2.1.1.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex11.m2.1b"><apply id="A4.Ex11.m2.1.1.cmml" xref="A4.Ex11.m2.1.1"><eq id="A4.Ex11.m2.1.1.2.cmml" xref="A4.Ex11.m2.1.1.2"></eq><csymbol cd="latexml" id="A4.Ex11.m2.1.1.3.cmml" xref="A4.Ex11.m2.1.1.3">absent</csymbol><apply id="A4.Ex11.m2.1.1.1.2.cmml" xref="A4.Ex11.m2.1.1.1.1"><csymbol cd="latexml" id="A4.Ex11.m2.1.1.1.2.1.cmml" xref="A4.Ex11.m2.1.1.1.1.2">norm</csymbol><apply id="A4.Ex11.m2.1.1.1.1.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1"><minus id="A4.Ex11.m2.1.1.1.1.1.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.2"></minus><apply id="A4.Ex11.m2.1.1.1.1.1.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex11.m2.1.1.1.1.1.3.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3">superscript</csymbol><apply id="A4.Ex11.m2.1.1.1.1.1.3.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex11.m2.1.1.1.1.1.3.2.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex11.m2.1.1.1.1.1.3.2.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3.2.2">𝒛</ci><apply id="A4.Ex11.m2.1.1.1.1.1.3.2.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3.2.3"><minus id="A4.Ex11.m2.1.1.1.1.1.3.2.3.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3.2.3.1"></minus><ci id="A4.Ex11.m2.1.1.1.1.1.3.2.3.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="A4.Ex11.m2.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="A4.Ex11.m2.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="A4.Ex11.m2.1.1.1.1.1.3.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.3.3">′</ci></apply><apply id="A4.Ex11.m2.1.1.1.1.1.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1"><times id="A4.Ex11.m2.1.1.1.1.1.1.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.2"></times><ci id="A4.Ex11.m2.1.1.1.1.1.1.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.3">𝜋</ci><apply id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.2">𝒛</ci><apply id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3"><minus id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex11.m2.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex11.m2.1c">\displaystyle=\left\|{\bm{z}}_{t-1}^{\prime}-\pi({\bm{z}}_{t-1}^{\prime})\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex11.m2.1d">= ∥ bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT - italic_π ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\approx\left\|{\bm{z}}_{t}-\eta({\bm{g}}_{t}^{\parallel}+\bm{%
\epsilon})-\left({\bm{z}}_{t}+\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}(-\eta(%
{\bm{g}}_{t}^{\parallel}+\bm{\epsilon}))\right)\right\|" class="ltx_Math" display="inline" id="A4.Ex12.m1.1"><semantics id="A4.Ex12.m1.1a"><mrow id="A4.Ex12.m1.1.1" xref="A4.Ex12.m1.1.1.cmml"><mi id="A4.Ex12.m1.1.1.3" xref="A4.Ex12.m1.1.1.3.cmml"></mi><mo id="A4.Ex12.m1.1.1.2" xref="A4.Ex12.m1.1.1.2.cmml">≈</mo><mrow id="A4.Ex12.m1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.2.cmml"><mo id="A4.Ex12.m1.1.1.1.1.2" xref="A4.Ex12.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A4.Ex12.m1.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.cmml"><msub id="A4.Ex12.m1.1.1.1.1.1.4" xref="A4.Ex12.m1.1.1.1.1.1.4.cmml"><mi id="A4.Ex12.m1.1.1.1.1.1.4.2" xref="A4.Ex12.m1.1.1.1.1.1.4.2.cmml">𝒛</mi><mi id="A4.Ex12.m1.1.1.1.1.1.4.3" xref="A4.Ex12.m1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="A4.Ex12.m1.1.1.1.1.1.3" xref="A4.Ex12.m1.1.1.1.1.1.3.cmml">−</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.1.cmml"><mi id="A4.Ex12.m1.1.1.1.1.1.1.3" xref="A4.Ex12.m1.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex12.m1.1.1.1.1.1.1.2" xref="A4.Ex12.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex12.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mo id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi class="ltx_mathvariant_bold-italic" id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.3" mathvariant="bold-italic" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="A4.Ex12.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.Ex12.m1.1.1.1.1.1.3a" xref="A4.Ex12.m1.1.1.1.1.1.3.cmml">−</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.2.1" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.cmml"><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.2.1.1" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.cmml"><msub id="A4.Ex12.m1.1.1.1.1.1.2.1.1.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.cmml"><mi id="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.2.cmml">𝒛</mi><mi id="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.3.cmml">t</mi></msub><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.2.cmml">+</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.cmml"><msub id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.2.cmml">𝒫</mi><mrow id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.cmml"><msub id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.cmml"><mi id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.2.cmml">T</mi><msub id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.cmml"><mi id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.2.cmml">𝒛</mi><mi id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.1" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.3.cmml">ℳ</mi></mrow></msub><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1a" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">−</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi class="ltx_mathvariant_bold-italic" id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" mathvariant="bold-italic" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex12.m1.1.1.1.1.1.2.1.3" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="A4.Ex12.m1.1.1.1.1.3" xref="A4.Ex12.m1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex12.m1.1b"><apply id="A4.Ex12.m1.1.1.cmml" xref="A4.Ex12.m1.1.1"><approx id="A4.Ex12.m1.1.1.2.cmml" xref="A4.Ex12.m1.1.1.2"></approx><csymbol cd="latexml" id="A4.Ex12.m1.1.1.3.cmml" xref="A4.Ex12.m1.1.1.3">absent</csymbol><apply id="A4.Ex12.m1.1.1.1.2.cmml" xref="A4.Ex12.m1.1.1.1.1"><csymbol cd="latexml" id="A4.Ex12.m1.1.1.1.2.1.cmml" xref="A4.Ex12.m1.1.1.1.1.2">norm</csymbol><apply id="A4.Ex12.m1.1.1.1.1.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1"><minus id="A4.Ex12.m1.1.1.1.1.1.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.3"></minus><apply id="A4.Ex12.m1.1.1.1.1.1.4.cmml" xref="A4.Ex12.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A4.Ex12.m1.1.1.1.1.1.4.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.4">subscript</csymbol><ci id="A4.Ex12.m1.1.1.1.1.1.4.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.4.2">𝒛</ci><ci id="A4.Ex12.m1.1.1.1.1.1.4.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.4.3">𝑡</ci></apply><apply id="A4.Ex12.m1.1.1.1.1.1.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1"><times id="A4.Ex12.m1.1.1.1.1.1.1.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.2"></times><ci id="A4.Ex12.m1.1.1.1.1.1.1.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1"><plus id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝒈</ci><ci id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.2.3">parallel-to</csymbol></apply><ci id="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.1.1.1.1.3">bold-italic-ϵ</ci></apply></apply><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1"><plus id="A4.Ex12.m1.1.1.1.1.1.2.1.1.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.2"></plus><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.2">𝒛</ci><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.3.3">𝑡</ci></apply><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1"><times id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.2"></times><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.2">𝒫</ci><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3"><times id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.1"></times><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2">subscript</csymbol><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.2">𝑇</ci><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3">subscript</csymbol><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.2">𝒛</ci><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.3.3.3">ℳ</ci></apply></apply><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1"><minus id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1"></minus><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1"><times id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2"></times><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><plus id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒈</ci><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.3">parallel-to</csymbol></apply><ci id="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex12.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">bold-italic-ϵ</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex12.m1.1c">\displaystyle\approx\left\|{\bm{z}}_{t}-\eta({\bm{g}}_{t}^{\parallel}+\bm{%
\epsilon})-\left({\bm{z}}_{t}+\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}(-\eta(%
{\bm{g}}_{t}^{\parallel}+\bm{\epsilon}))\right)\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex12.m1.1d">≈ ∥ bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_η ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_ϵ ) - ( bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ( - italic_η ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_ϵ ) ) ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|-\eta({\bm{g}}_{t}^{\parallel}+\bm{\epsilon})+\eta%
\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}({\bm{g}}_{t}^{\parallel}+\bm{%
\epsilon})\right\|" class="ltx_Math" display="inline" id="A4.Ex13.m1.1"><semantics id="A4.Ex13.m1.1a"><mrow id="A4.Ex13.m1.1.1" xref="A4.Ex13.m1.1.1.cmml"><mi id="A4.Ex13.m1.1.1.3" xref="A4.Ex13.m1.1.1.3.cmml"></mi><mo id="A4.Ex13.m1.1.1.2" xref="A4.Ex13.m1.1.1.2.cmml">=</mo><mrow id="A4.Ex13.m1.1.1.1.1" xref="A4.Ex13.m1.1.1.1.2.cmml"><mo id="A4.Ex13.m1.1.1.1.1.2" xref="A4.Ex13.m1.1.1.1.2.1.cmml">‖</mo><mrow id="A4.Ex13.m1.1.1.1.1.1" xref="A4.Ex13.m1.1.1.1.1.1.cmml"><mrow id="A4.Ex13.m1.1.1.1.1.1.1" xref="A4.Ex13.m1.1.1.1.1.1.1.cmml"><mo id="A4.Ex13.m1.1.1.1.1.1.1a" xref="A4.Ex13.m1.1.1.1.1.1.1.cmml">−</mo><mrow id="A4.Ex13.m1.1.1.1.1.1.1.1" xref="A4.Ex13.m1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex13.m1.1.1.1.1.1.1.1.3" xref="A4.Ex13.m1.1.1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex13.m1.1.1.1.1.1.1.1.2" xref="A4.Ex13.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mo id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi class="ltx_mathvariant_bold-italic" id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3" mathvariant="bold-italic" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex13.m1.1.1.1.1.1.3" xref="A4.Ex13.m1.1.1.1.1.1.3.cmml">+</mo><mrow id="A4.Ex13.m1.1.1.1.1.1.2" xref="A4.Ex13.m1.1.1.1.1.1.2.cmml"><mi id="A4.Ex13.m1.1.1.1.1.1.2.3" xref="A4.Ex13.m1.1.1.1.1.1.2.3.cmml">η</mi><mo id="A4.Ex13.m1.1.1.1.1.1.2.2" xref="A4.Ex13.m1.1.1.1.1.1.2.2.cmml">⁢</mo><msub id="A4.Ex13.m1.1.1.1.1.1.2.4" xref="A4.Ex13.m1.1.1.1.1.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex13.m1.1.1.1.1.1.2.4.2" xref="A4.Ex13.m1.1.1.1.1.1.2.4.2.cmml">𝒫</mi><mrow id="A4.Ex13.m1.1.1.1.1.1.2.4.3" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.cmml"><msub id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.cmml"><mi id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.2" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.2.cmml">T</mi><msub id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.cmml"><mi id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.2" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.2.cmml">𝒛</mi><mi id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.3" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.Ex13.m1.1.1.1.1.1.2.4.3.1" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex13.m1.1.1.1.1.1.2.4.3.3" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.3.cmml">ℳ</mi></mrow></msub><mo id="A4.Ex13.m1.1.1.1.1.1.2.2a" xref="A4.Ex13.m1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A4.Ex13.m1.1.1.1.1.1.2.1.1" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A4.Ex13.m1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.cmml"><msubsup id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.2.2" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.2.2.cmml">𝒈</mi><mi id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.2.3" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.2.3.cmml">t</mi><mo id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.3" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.3.cmml">∥</mo></msubsup><mo id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.1" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.1.cmml">+</mo><mi class="ltx_mathvariant_bold-italic" id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.3" mathvariant="bold-italic" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.3.cmml">ϵ</mi></mrow><mo id="A4.Ex13.m1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex13.m1.1.1.1.1.3" xref="A4.Ex13.m1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex13.m1.1b"><apply id="A4.Ex13.m1.1.1.cmml" xref="A4.Ex13.m1.1.1"><eq id="A4.Ex13.m1.1.1.2.cmml" xref="A4.Ex13.m1.1.1.2"></eq><csymbol cd="latexml" id="A4.Ex13.m1.1.1.3.cmml" xref="A4.Ex13.m1.1.1.3">absent</csymbol><apply id="A4.Ex13.m1.1.1.1.2.cmml" xref="A4.Ex13.m1.1.1.1.1"><csymbol cd="latexml" id="A4.Ex13.m1.1.1.1.2.1.cmml" xref="A4.Ex13.m1.1.1.1.1.2">norm</csymbol><apply id="A4.Ex13.m1.1.1.1.1.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1"><plus id="A4.Ex13.m1.1.1.1.1.1.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.3"></plus><apply id="A4.Ex13.m1.1.1.1.1.1.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1"><minus id="A4.Ex13.m1.1.1.1.1.1.1.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1"></minus><apply id="A4.Ex13.m1.1.1.1.1.1.1.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1"><times id="A4.Ex13.m1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.2"></times><ci id="A4.Ex13.m1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1"><plus id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒈</ci><ci id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.3">parallel-to</csymbol></apply><ci id="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3">bold-italic-ϵ</ci></apply></apply></apply><apply id="A4.Ex13.m1.1.1.1.1.1.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2"><times id="A4.Ex13.m1.1.1.1.1.1.2.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.2"></times><ci id="A4.Ex13.m1.1.1.1.1.1.2.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.3">𝜂</ci><apply id="A4.Ex13.m1.1.1.1.1.1.2.4.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A4.Ex13.m1.1.1.1.1.1.2.4.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4">subscript</csymbol><ci id="A4.Ex13.m1.1.1.1.1.1.2.4.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.2">𝒫</ci><apply id="A4.Ex13.m1.1.1.1.1.1.2.4.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3"><times id="A4.Ex13.m1.1.1.1.1.1.2.4.3.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.1"></times><apply id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2"><csymbol cd="ambiguous" id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2">subscript</csymbol><ci id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.2">𝑇</ci><apply id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3"><csymbol cd="ambiguous" id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3">subscript</csymbol><ci id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.2">𝒛</ci><ci id="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.Ex13.m1.1.1.1.1.1.2.4.3.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.4.3.3">ℳ</ci></apply></apply><apply id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1"><plus id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.1"></plus><apply id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2">superscript</csymbol><apply id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.2.1.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2">subscript</csymbol><ci id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.2.2">𝒈</ci><ci id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.2.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.2.3">parallel-to</csymbol></apply><ci id="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A4.Ex13.m1.1.1.1.1.1.2.1.1.1.3">bold-italic-ϵ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex13.m1.1c">\displaystyle=\left\|-\eta({\bm{g}}_{t}^{\parallel}+\bm{\epsilon})+\eta%
\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}}({\bm{g}}_{t}^{\parallel}+\bm{%
\epsilon})\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex13.m1.1d">= ∥ - italic_η ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_ϵ ) + italic_η caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ( bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∥ end_POSTSUPERSCRIPT + bold_italic_ϵ ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|-\eta\bm{\epsilon}+\eta\mathcal{P}_{T_{{\bm{z}}_{t}}%
\mathcal{M}}(\bm{\epsilon})\right\|" class="ltx_Math" display="inline" id="A4.Ex14.m1.2"><semantics id="A4.Ex14.m1.2a"><mrow id="A4.Ex14.m1.2.2" xref="A4.Ex14.m1.2.2.cmml"><mi id="A4.Ex14.m1.2.2.3" xref="A4.Ex14.m1.2.2.3.cmml"></mi><mo id="A4.Ex14.m1.2.2.2" xref="A4.Ex14.m1.2.2.2.cmml">=</mo><mrow id="A4.Ex14.m1.2.2.1.1" xref="A4.Ex14.m1.2.2.1.2.cmml"><mo id="A4.Ex14.m1.2.2.1.1.2" xref="A4.Ex14.m1.2.2.1.2.1.cmml">‖</mo><mrow id="A4.Ex14.m1.2.2.1.1.1" xref="A4.Ex14.m1.2.2.1.1.1.cmml"><mrow id="A4.Ex14.m1.2.2.1.1.1.2" xref="A4.Ex14.m1.2.2.1.1.1.2.cmml"><mo id="A4.Ex14.m1.2.2.1.1.1.2a" xref="A4.Ex14.m1.2.2.1.1.1.2.cmml">−</mo><mrow id="A4.Ex14.m1.2.2.1.1.1.2.2" xref="A4.Ex14.m1.2.2.1.1.1.2.2.cmml"><mi id="A4.Ex14.m1.2.2.1.1.1.2.2.2" xref="A4.Ex14.m1.2.2.1.1.1.2.2.2.cmml">η</mi><mo id="A4.Ex14.m1.2.2.1.1.1.2.2.1" xref="A4.Ex14.m1.2.2.1.1.1.2.2.1.cmml">⁢</mo><mi class="ltx_mathvariant_bold-italic" id="A4.Ex14.m1.2.2.1.1.1.2.2.3" mathvariant="bold-italic" xref="A4.Ex14.m1.2.2.1.1.1.2.2.3.cmml">ϵ</mi></mrow></mrow><mo id="A4.Ex14.m1.2.2.1.1.1.1" xref="A4.Ex14.m1.2.2.1.1.1.1.cmml">+</mo><mrow id="A4.Ex14.m1.2.2.1.1.1.3" xref="A4.Ex14.m1.2.2.1.1.1.3.cmml"><mi id="A4.Ex14.m1.2.2.1.1.1.3.2" xref="A4.Ex14.m1.2.2.1.1.1.3.2.cmml">η</mi><mo id="A4.Ex14.m1.2.2.1.1.1.3.1" xref="A4.Ex14.m1.2.2.1.1.1.3.1.cmml">⁢</mo><msub id="A4.Ex14.m1.2.2.1.1.1.3.3" xref="A4.Ex14.m1.2.2.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex14.m1.2.2.1.1.1.3.3.2" xref="A4.Ex14.m1.2.2.1.1.1.3.3.2.cmml">𝒫</mi><mrow id="A4.Ex14.m1.2.2.1.1.1.3.3.3" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.cmml"><msub id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.cmml"><mi id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.2" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.2.cmml">T</mi><msub id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.cmml"><mi id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.2" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.2.cmml">𝒛</mi><mi id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.3" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.Ex14.m1.2.2.1.1.1.3.3.3.1" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex14.m1.2.2.1.1.1.3.3.3.3" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.3.cmml">ℳ</mi></mrow></msub><mo id="A4.Ex14.m1.2.2.1.1.1.3.1a" xref="A4.Ex14.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="A4.Ex14.m1.2.2.1.1.1.3.4.2" xref="A4.Ex14.m1.2.2.1.1.1.3.cmml"><mo id="A4.Ex14.m1.2.2.1.1.1.3.4.2.1" stretchy="false" xref="A4.Ex14.m1.2.2.1.1.1.3.cmml">(</mo><mi class="ltx_mathvariant_bold-italic" id="A4.Ex14.m1.1.1" mathvariant="bold-italic" xref="A4.Ex14.m1.1.1.cmml">ϵ</mi><mo id="A4.Ex14.m1.2.2.1.1.1.3.4.2.2" stretchy="false" xref="A4.Ex14.m1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex14.m1.2.2.1.1.3" xref="A4.Ex14.m1.2.2.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex14.m1.2b"><apply id="A4.Ex14.m1.2.2.cmml" xref="A4.Ex14.m1.2.2"><eq id="A4.Ex14.m1.2.2.2.cmml" xref="A4.Ex14.m1.2.2.2"></eq><csymbol cd="latexml" id="A4.Ex14.m1.2.2.3.cmml" xref="A4.Ex14.m1.2.2.3">absent</csymbol><apply id="A4.Ex14.m1.2.2.1.2.cmml" xref="A4.Ex14.m1.2.2.1.1"><csymbol cd="latexml" id="A4.Ex14.m1.2.2.1.2.1.cmml" xref="A4.Ex14.m1.2.2.1.1.2">norm</csymbol><apply id="A4.Ex14.m1.2.2.1.1.1.cmml" xref="A4.Ex14.m1.2.2.1.1.1"><plus id="A4.Ex14.m1.2.2.1.1.1.1.cmml" xref="A4.Ex14.m1.2.2.1.1.1.1"></plus><apply id="A4.Ex14.m1.2.2.1.1.1.2.cmml" xref="A4.Ex14.m1.2.2.1.1.1.2"><minus id="A4.Ex14.m1.2.2.1.1.1.2.1.cmml" xref="A4.Ex14.m1.2.2.1.1.1.2"></minus><apply id="A4.Ex14.m1.2.2.1.1.1.2.2.cmml" xref="A4.Ex14.m1.2.2.1.1.1.2.2"><times id="A4.Ex14.m1.2.2.1.1.1.2.2.1.cmml" xref="A4.Ex14.m1.2.2.1.1.1.2.2.1"></times><ci id="A4.Ex14.m1.2.2.1.1.1.2.2.2.cmml" xref="A4.Ex14.m1.2.2.1.1.1.2.2.2">𝜂</ci><ci id="A4.Ex14.m1.2.2.1.1.1.2.2.3.cmml" xref="A4.Ex14.m1.2.2.1.1.1.2.2.3">bold-italic-ϵ</ci></apply></apply><apply id="A4.Ex14.m1.2.2.1.1.1.3.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3"><times id="A4.Ex14.m1.2.2.1.1.1.3.1.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.1"></times><ci id="A4.Ex14.m1.2.2.1.1.1.3.2.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.2">𝜂</ci><apply id="A4.Ex14.m1.2.2.1.1.1.3.3.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="A4.Ex14.m1.2.2.1.1.1.3.3.1.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="A4.Ex14.m1.2.2.1.1.1.3.3.2.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.2">𝒫</ci><apply id="A4.Ex14.m1.2.2.1.1.1.3.3.3.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3"><times id="A4.Ex14.m1.2.2.1.1.1.3.3.3.1.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.1"></times><apply id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.1.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2">subscript</csymbol><ci id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.2.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.2">𝑇</ci><apply id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.1.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3">subscript</csymbol><ci id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.2.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.2">𝒛</ci><ci id="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.3.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.Ex14.m1.2.2.1.1.1.3.3.3.3.cmml" xref="A4.Ex14.m1.2.2.1.1.1.3.3.3.3">ℳ</ci></apply></apply><ci id="A4.Ex14.m1.1.1.cmml" xref="A4.Ex14.m1.1.1">bold-italic-ϵ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex14.m1.2c">\displaystyle=\left\|-\eta\bm{\epsilon}+\eta\mathcal{P}_{T_{{\bm{z}}_{t}}%
\mathcal{M}}(\bm{\epsilon})\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex14.m1.2d">= ∥ - italic_η bold_italic_ϵ + italic_η caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ( bold_italic_ϵ ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\eta\left\|\bm{\epsilon}-\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M%
}}(\bm{\epsilon})\right\|" class="ltx_Math" display="inline" id="A4.Ex15.m1.2"><semantics id="A4.Ex15.m1.2a"><mrow id="A4.Ex15.m1.2.2" xref="A4.Ex15.m1.2.2.cmml"><mi id="A4.Ex15.m1.2.2.3" xref="A4.Ex15.m1.2.2.3.cmml"></mi><mo id="A4.Ex15.m1.2.2.2" xref="A4.Ex15.m1.2.2.2.cmml">=</mo><mrow id="A4.Ex15.m1.2.2.1" xref="A4.Ex15.m1.2.2.1.cmml"><mi id="A4.Ex15.m1.2.2.1.3" xref="A4.Ex15.m1.2.2.1.3.cmml">η</mi><mo id="A4.Ex15.m1.2.2.1.2" xref="A4.Ex15.m1.2.2.1.2.cmml">⁢</mo><mrow id="A4.Ex15.m1.2.2.1.1.1" xref="A4.Ex15.m1.2.2.1.1.2.cmml"><mo id="A4.Ex15.m1.2.2.1.1.1.2" xref="A4.Ex15.m1.2.2.1.1.2.1.cmml">‖</mo><mrow id="A4.Ex15.m1.2.2.1.1.1.1" xref="A4.Ex15.m1.2.2.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" id="A4.Ex15.m1.2.2.1.1.1.1.2" mathvariant="bold-italic" xref="A4.Ex15.m1.2.2.1.1.1.1.2.cmml">ϵ</mi><mo id="A4.Ex15.m1.2.2.1.1.1.1.1" xref="A4.Ex15.m1.2.2.1.1.1.1.1.cmml">−</mo><mrow id="A4.Ex15.m1.2.2.1.1.1.1.3" xref="A4.Ex15.m1.2.2.1.1.1.1.3.cmml"><msub id="A4.Ex15.m1.2.2.1.1.1.1.3.2" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex15.m1.2.2.1.1.1.1.3.2.2" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.2.cmml">𝒫</mi><mrow id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.cmml"><msub id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.cmml"><mi id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.2" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.2.cmml">T</mi><msub id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.cmml"><mi id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.2" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.2.cmml">𝒛</mi><mi id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.3" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.1" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.3" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.3.cmml">ℳ</mi></mrow></msub><mo id="A4.Ex15.m1.2.2.1.1.1.1.3.1" xref="A4.Ex15.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A4.Ex15.m1.2.2.1.1.1.1.3.3.2" xref="A4.Ex15.m1.2.2.1.1.1.1.3.cmml"><mo id="A4.Ex15.m1.2.2.1.1.1.1.3.3.2.1" stretchy="false" xref="A4.Ex15.m1.2.2.1.1.1.1.3.cmml">(</mo><mi class="ltx_mathvariant_bold-italic" id="A4.Ex15.m1.1.1" mathvariant="bold-italic" xref="A4.Ex15.m1.1.1.cmml">ϵ</mi><mo id="A4.Ex15.m1.2.2.1.1.1.1.3.3.2.2" stretchy="false" xref="A4.Ex15.m1.2.2.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex15.m1.2.2.1.1.1.3" xref="A4.Ex15.m1.2.2.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex15.m1.2b"><apply id="A4.Ex15.m1.2.2.cmml" xref="A4.Ex15.m1.2.2"><eq id="A4.Ex15.m1.2.2.2.cmml" xref="A4.Ex15.m1.2.2.2"></eq><csymbol cd="latexml" id="A4.Ex15.m1.2.2.3.cmml" xref="A4.Ex15.m1.2.2.3">absent</csymbol><apply id="A4.Ex15.m1.2.2.1.cmml" xref="A4.Ex15.m1.2.2.1"><times id="A4.Ex15.m1.2.2.1.2.cmml" xref="A4.Ex15.m1.2.2.1.2"></times><ci id="A4.Ex15.m1.2.2.1.3.cmml" xref="A4.Ex15.m1.2.2.1.3">𝜂</ci><apply id="A4.Ex15.m1.2.2.1.1.2.cmml" xref="A4.Ex15.m1.2.2.1.1.1"><csymbol cd="latexml" id="A4.Ex15.m1.2.2.1.1.2.1.cmml" xref="A4.Ex15.m1.2.2.1.1.1.2">norm</csymbol><apply id="A4.Ex15.m1.2.2.1.1.1.1.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1"><minus id="A4.Ex15.m1.2.2.1.1.1.1.1.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.1"></minus><ci id="A4.Ex15.m1.2.2.1.1.1.1.2.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.2">bold-italic-ϵ</ci><apply id="A4.Ex15.m1.2.2.1.1.1.1.3.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3"><times id="A4.Ex15.m1.2.2.1.1.1.1.3.1.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.1"></times><apply id="A4.Ex15.m1.2.2.1.1.1.1.3.2.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A4.Ex15.m1.2.2.1.1.1.1.3.2.1.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="A4.Ex15.m1.2.2.1.1.1.1.3.2.2.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.2">𝒫</ci><apply id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3"><times id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.1.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.1"></times><apply id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.1.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2">subscript</csymbol><ci id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.2.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.2">𝑇</ci><apply id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3"><csymbol cd="ambiguous" id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.1.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3">subscript</csymbol><ci id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.2.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.2">𝒛</ci><ci id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.3.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.3.cmml" xref="A4.Ex15.m1.2.2.1.1.1.1.3.2.3.3">ℳ</ci></apply></apply><ci id="A4.Ex15.m1.1.1.cmml" xref="A4.Ex15.m1.1.1">bold-italic-ϵ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex15.m1.2c">\displaystyle=\eta\left\|\bm{\epsilon}-\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M%
}}(\bm{\epsilon})\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex15.m1.2d">= italic_η ∥ bold_italic_ϵ - caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ( bold_italic_ϵ ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\eta\left\|(I-\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}})\bm{%
\epsilon}\right\|." class="ltx_Math" display="inline" id="A4.Ex16.m1.1"><semantics id="A4.Ex16.m1.1a"><mrow id="A4.Ex16.m1.1.1.1" xref="A4.Ex16.m1.1.1.1.1.cmml"><mrow id="A4.Ex16.m1.1.1.1.1" xref="A4.Ex16.m1.1.1.1.1.cmml"><mi id="A4.Ex16.m1.1.1.1.1.3" xref="A4.Ex16.m1.1.1.1.1.3.cmml"></mi><mo id="A4.Ex16.m1.1.1.1.1.2" xref="A4.Ex16.m1.1.1.1.1.2.cmml">=</mo><mrow id="A4.Ex16.m1.1.1.1.1.1" xref="A4.Ex16.m1.1.1.1.1.1.cmml"><mi id="A4.Ex16.m1.1.1.1.1.1.3" xref="A4.Ex16.m1.1.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex16.m1.1.1.1.1.1.2" xref="A4.Ex16.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex16.m1.1.1.1.1.1.1.1" xref="A4.Ex16.m1.1.1.1.1.1.1.2.cmml"><mo id="A4.Ex16.m1.1.1.1.1.1.1.1.2" xref="A4.Ex16.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A4.Ex16.m1.1.1.1.1.1.1.1.1" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">I</mi><mo id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒫</mi><mrow id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><msub id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">T</mi><msub id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.2" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.2.cmml">𝒛</mi><mi id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.3" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">ℳ</mi></mrow></msub></mrow><mo id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A4.Ex16.m1.1.1.1.1.1.1.1.1.2" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi class="ltx_mathvariant_bold-italic" id="A4.Ex16.m1.1.1.1.1.1.1.1.1.3" mathvariant="bold-italic" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="A4.Ex16.m1.1.1.1.1.1.1.1.3" xref="A4.Ex16.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="A4.Ex16.m1.1.1.1.2" lspace="0em" xref="A4.Ex16.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex16.m1.1b"><apply id="A4.Ex16.m1.1.1.1.1.cmml" xref="A4.Ex16.m1.1.1.1"><eq id="A4.Ex16.m1.1.1.1.1.2.cmml" xref="A4.Ex16.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="A4.Ex16.m1.1.1.1.1.3.cmml" xref="A4.Ex16.m1.1.1.1.1.3">absent</csymbol><apply id="A4.Ex16.m1.1.1.1.1.1.cmml" xref="A4.Ex16.m1.1.1.1.1.1"><times id="A4.Ex16.m1.1.1.1.1.1.2.cmml" xref="A4.Ex16.m1.1.1.1.1.1.2"></times><ci id="A4.Ex16.m1.1.1.1.1.1.3.cmml" xref="A4.Ex16.m1.1.1.1.1.1.3">𝜂</ci><apply id="A4.Ex16.m1.1.1.1.1.1.1.2.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A4.Ex16.m1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A4.Ex16.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1"><times id="A4.Ex16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.2"></times><apply id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1"><minus id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝐼</ci><apply id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝒫</ci><apply id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><apply id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">𝑇</ci><apply id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.2">𝒛</ci><ci id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">ℳ</ci></apply></apply></apply><ci id="A4.Ex16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex16.m1.1.1.1.1.1.1.1.1.3">bold-italic-ϵ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex16.m1.1c">\displaystyle=\eta\left\|(I-\mathcal{P}_{T_{{\bm{z}}_{t}}\mathcal{M}})\bm{%
\epsilon}\right\|.</annotation><annotation encoding="application/x-llamapun" id="A4.Ex16.m1.1d">= italic_η ∥ ( italic_I - caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ) bold_italic_ϵ ∥ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A4.11.p11">
<p class="ltx_p" id="A4.11.p11.1">Since <math alttext="\left\|\bm{\epsilon}^{\perp}\right\|=\left\|(I-\mathcal{P}_{T_{{\bm{z}}_{t}}%
\mathcal{M}})\bm{\epsilon}\right\|" class="ltx_Math" display="inline" id="A4.11.p11.1.m1.2"><semantics id="A4.11.p11.1.m1.2a"><mrow id="A4.11.p11.1.m1.2.2" xref="A4.11.p11.1.m1.2.2.cmml"><mrow id="A4.11.p11.1.m1.1.1.1.1" xref="A4.11.p11.1.m1.1.1.1.2.cmml"><mo id="A4.11.p11.1.m1.1.1.1.1.2" xref="A4.11.p11.1.m1.1.1.1.2.1.cmml">‖</mo><msup id="A4.11.p11.1.m1.1.1.1.1.1" xref="A4.11.p11.1.m1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" id="A4.11.p11.1.m1.1.1.1.1.1.2" mathvariant="bold-italic" xref="A4.11.p11.1.m1.1.1.1.1.1.2.cmml">ϵ</mi><mo id="A4.11.p11.1.m1.1.1.1.1.1.3" xref="A4.11.p11.1.m1.1.1.1.1.1.3.cmml">⟂</mo></msup><mo id="A4.11.p11.1.m1.1.1.1.1.3" xref="A4.11.p11.1.m1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A4.11.p11.1.m1.2.2.3" xref="A4.11.p11.1.m1.2.2.3.cmml">=</mo><mrow id="A4.11.p11.1.m1.2.2.2.1" xref="A4.11.p11.1.m1.2.2.2.2.cmml"><mo id="A4.11.p11.1.m1.2.2.2.1.2" xref="A4.11.p11.1.m1.2.2.2.2.1.cmml">‖</mo><mrow id="A4.11.p11.1.m1.2.2.2.1.1" xref="A4.11.p11.1.m1.2.2.2.1.1.cmml"><mrow id="A4.11.p11.1.m1.2.2.2.1.1.1.1" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.cmml"><mo id="A4.11.p11.1.m1.2.2.2.1.1.1.1.2" stretchy="false" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.cmml"><mi id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.2" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.2.cmml">I</mi><mo id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.1" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.2" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.2.cmml">𝒫</mi><mrow id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.cmml"><msub id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.cmml"><mi id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.2" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.2.cmml">T</mi><msub id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.cmml"><mi id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.2" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.2.cmml">𝒛</mi><mi id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.3" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.3.cmml">t</mi></msub></msub><mo id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.1" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.3" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.3.cmml">ℳ</mi></mrow></msub></mrow><mo id="A4.11.p11.1.m1.2.2.2.1.1.1.1.3" stretchy="false" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="A4.11.p11.1.m1.2.2.2.1.1.2" xref="A4.11.p11.1.m1.2.2.2.1.1.2.cmml">⁢</mo><mi class="ltx_mathvariant_bold-italic" id="A4.11.p11.1.m1.2.2.2.1.1.3" mathvariant="bold-italic" xref="A4.11.p11.1.m1.2.2.2.1.1.3.cmml">ϵ</mi></mrow><mo id="A4.11.p11.1.m1.2.2.2.1.3" xref="A4.11.p11.1.m1.2.2.2.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.11.p11.1.m1.2b"><apply id="A4.11.p11.1.m1.2.2.cmml" xref="A4.11.p11.1.m1.2.2"><eq id="A4.11.p11.1.m1.2.2.3.cmml" xref="A4.11.p11.1.m1.2.2.3"></eq><apply id="A4.11.p11.1.m1.1.1.1.2.cmml" xref="A4.11.p11.1.m1.1.1.1.1"><csymbol cd="latexml" id="A4.11.p11.1.m1.1.1.1.2.1.cmml" xref="A4.11.p11.1.m1.1.1.1.1.2">norm</csymbol><apply id="A4.11.p11.1.m1.1.1.1.1.1.cmml" xref="A4.11.p11.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.11.p11.1.m1.1.1.1.1.1.1.cmml" xref="A4.11.p11.1.m1.1.1.1.1.1">superscript</csymbol><ci id="A4.11.p11.1.m1.1.1.1.1.1.2.cmml" xref="A4.11.p11.1.m1.1.1.1.1.1.2">bold-italic-ϵ</ci><csymbol cd="latexml" id="A4.11.p11.1.m1.1.1.1.1.1.3.cmml" xref="A4.11.p11.1.m1.1.1.1.1.1.3">perpendicular-to</csymbol></apply></apply><apply id="A4.11.p11.1.m1.2.2.2.2.cmml" xref="A4.11.p11.1.m1.2.2.2.1"><csymbol cd="latexml" id="A4.11.p11.1.m1.2.2.2.2.1.cmml" xref="A4.11.p11.1.m1.2.2.2.1.2">norm</csymbol><apply id="A4.11.p11.1.m1.2.2.2.1.1.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1"><times id="A4.11.p11.1.m1.2.2.2.1.1.2.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.2"></times><apply id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1"><minus id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.1.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.1"></minus><ci id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.2.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.2">𝐼</ci><apply id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.1.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.2.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.2">𝒫</ci><apply id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3"><times id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.1.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.1"></times><apply id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.1.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.2.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.2">𝑇</ci><apply id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.1.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.2.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.2">𝒛</ci><ci id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.3.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply><ci id="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.3.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.1.1.1.3.3.3">ℳ</ci></apply></apply></apply><ci id="A4.11.p11.1.m1.2.2.2.1.1.3.cmml" xref="A4.11.p11.1.m1.2.2.2.1.1.3">bold-italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.11.p11.1.m1.2c">\left\|\bm{\epsilon}^{\perp}\right\|=\left\|(I-\mathcal{P}_{T_{{\bm{z}}_{t}}%
\mathcal{M}})\bm{\epsilon}\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.11.p11.1.m1.2d">∥ bold_italic_ϵ start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥ = ∥ ( italic_I - caligraphic_P start_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_M end_POSTSUBSCRIPT ) bold_italic_ϵ ∥</annotation></semantics></math>, we have:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})=\eta\left\|\bm{\epsilon}^{%
\perp}\right\|." class="ltx_Math" display="block" id="A4.E10.m1.2"><semantics id="A4.E10.m1.2a"><mrow id="A4.E10.m1.2.2.1" xref="A4.E10.m1.2.2.1.1.cmml"><mrow id="A4.E10.m1.2.2.1.1" xref="A4.E10.m1.2.2.1.1.cmml"><mrow id="A4.E10.m1.2.2.1.1.1" xref="A4.E10.m1.2.2.1.1.1.cmml"><mtext id="A4.E10.m1.2.2.1.1.1.3" xref="A4.E10.m1.2.2.1.1.1.3a.cmml">dist</mtext><mo id="A4.E10.m1.2.2.1.1.1.2" xref="A4.E10.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A4.E10.m1.2.2.1.1.1.1.1" xref="A4.E10.m1.2.2.1.1.1.1.2.cmml"><mo id="A4.E10.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="A4.E10.m1.2.2.1.1.1.1.2.cmml">(</mo><msubsup id="A4.E10.m1.2.2.1.1.1.1.1.1" xref="A4.E10.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A4.E10.m1.2.2.1.1.1.1.1.1.2.2" xref="A4.E10.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="A4.E10.m1.2.2.1.1.1.1.1.1.2.3" xref="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.2" xref="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.1" xref="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.3" xref="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.E10.m1.2.2.1.1.1.1.1.1.3" xref="A4.E10.m1.2.2.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="A4.E10.m1.2.2.1.1.1.1.1.3" xref="A4.E10.m1.2.2.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.E10.m1.1.1" xref="A4.E10.m1.1.1.cmml">ℳ</mi><mo id="A4.E10.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="A4.E10.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.E10.m1.2.2.1.1.3" xref="A4.E10.m1.2.2.1.1.3.cmml">=</mo><mrow id="A4.E10.m1.2.2.1.1.2" xref="A4.E10.m1.2.2.1.1.2.cmml"><mi id="A4.E10.m1.2.2.1.1.2.3" xref="A4.E10.m1.2.2.1.1.2.3.cmml">η</mi><mo id="A4.E10.m1.2.2.1.1.2.2" xref="A4.E10.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="A4.E10.m1.2.2.1.1.2.1.1" xref="A4.E10.m1.2.2.1.1.2.1.2.cmml"><mo id="A4.E10.m1.2.2.1.1.2.1.1.2" xref="A4.E10.m1.2.2.1.1.2.1.2.1.cmml">‖</mo><msup id="A4.E10.m1.2.2.1.1.2.1.1.1" xref="A4.E10.m1.2.2.1.1.2.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" id="A4.E10.m1.2.2.1.1.2.1.1.1.2" mathvariant="bold-italic" xref="A4.E10.m1.2.2.1.1.2.1.1.1.2.cmml">ϵ</mi><mo id="A4.E10.m1.2.2.1.1.2.1.1.1.3" xref="A4.E10.m1.2.2.1.1.2.1.1.1.3.cmml">⟂</mo></msup><mo id="A4.E10.m1.2.2.1.1.2.1.1.3" xref="A4.E10.m1.2.2.1.1.2.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="A4.E10.m1.2.2.1.2" lspace="0em" xref="A4.E10.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E10.m1.2b"><apply id="A4.E10.m1.2.2.1.1.cmml" xref="A4.E10.m1.2.2.1"><eq id="A4.E10.m1.2.2.1.1.3.cmml" xref="A4.E10.m1.2.2.1.1.3"></eq><apply id="A4.E10.m1.2.2.1.1.1.cmml" xref="A4.E10.m1.2.2.1.1.1"><times id="A4.E10.m1.2.2.1.1.1.2.cmml" xref="A4.E10.m1.2.2.1.1.1.2"></times><ci id="A4.E10.m1.2.2.1.1.1.3a.cmml" xref="A4.E10.m1.2.2.1.1.1.3"><mtext id="A4.E10.m1.2.2.1.1.1.3.cmml" xref="A4.E10.m1.2.2.1.1.1.3">dist</mtext></ci><interval closure="open" id="A4.E10.m1.2.2.1.1.1.1.2.cmml" xref="A4.E10.m1.2.2.1.1.1.1.1"><apply id="A4.E10.m1.2.2.1.1.1.1.1.1.cmml" xref="A4.E10.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E10.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A4.E10.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="A4.E10.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A4.E10.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E10.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="A4.E10.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A4.E10.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="A4.E10.m1.2.2.1.1.1.1.1.1.2.2">𝒛</ci><apply id="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="A4.E10.m1.2.2.1.1.1.1.1.1.2.3"><minus id="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.1"></minus><ci id="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.E10.m1.2.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A4.E10.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A4.E10.m1.2.2.1.1.1.1.1.1.3">′</ci></apply><ci id="A4.E10.m1.1.1.cmml" xref="A4.E10.m1.1.1">ℳ</ci></interval></apply><apply id="A4.E10.m1.2.2.1.1.2.cmml" xref="A4.E10.m1.2.2.1.1.2"><times id="A4.E10.m1.2.2.1.1.2.2.cmml" xref="A4.E10.m1.2.2.1.1.2.2"></times><ci id="A4.E10.m1.2.2.1.1.2.3.cmml" xref="A4.E10.m1.2.2.1.1.2.3">𝜂</ci><apply id="A4.E10.m1.2.2.1.1.2.1.2.cmml" xref="A4.E10.m1.2.2.1.1.2.1.1"><csymbol cd="latexml" id="A4.E10.m1.2.2.1.1.2.1.2.1.cmml" xref="A4.E10.m1.2.2.1.1.2.1.1.2">norm</csymbol><apply id="A4.E10.m1.2.2.1.1.2.1.1.1.cmml" xref="A4.E10.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A4.E10.m1.2.2.1.1.2.1.1.1.1.cmml" xref="A4.E10.m1.2.2.1.1.2.1.1.1">superscript</csymbol><ci id="A4.E10.m1.2.2.1.1.2.1.1.1.2.cmml" xref="A4.E10.m1.2.2.1.1.2.1.1.1.2">bold-italic-ϵ</ci><csymbol cd="latexml" id="A4.E10.m1.2.2.1.1.2.1.1.1.3.cmml" xref="A4.E10.m1.2.2.1.1.2.1.1.1.3">perpendicular-to</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E10.m1.2c">\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})=\eta\left\|\bm{\epsilon}^{%
\perp}\right\|.</annotation><annotation encoding="application/x-llamapun" id="A4.E10.m1.2d">dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M ) = italic_η ∥ bold_italic_ϵ start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A4.12.p12">
<p class="ltx_p" id="A4.12.p12.3">Because <math alttext="\bm{\epsilon}" class="ltx_Math" display="inline" id="A4.12.p12.1.m1.1"><semantics id="A4.12.p12.1.m1.1a"><mi class="ltx_mathvariant_bold-italic" id="A4.12.p12.1.m1.1.1" mathvariant="bold-italic" xref="A4.12.p12.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="A4.12.p12.1.m1.1b"><ci id="A4.12.p12.1.m1.1.1.cmml" xref="A4.12.p12.1.m1.1.1">bold-italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.12.p12.1.m1.1c">\bm{\epsilon}</annotation><annotation encoding="application/x-llamapun" id="A4.12.p12.1.m1.1d">bold_italic_ϵ</annotation></semantics></math> is small, we can bound <math alttext="\left\|\bm{\epsilon}^{\perp}\right\|\leq c^{\prime}\left\|{\bm{g}}_{t}^{\perp}\right\|" class="ltx_Math" display="inline" id="A4.12.p12.2.m2.2"><semantics id="A4.12.p12.2.m2.2a"><mrow id="A4.12.p12.2.m2.2.2" xref="A4.12.p12.2.m2.2.2.cmml"><mrow id="A4.12.p12.2.m2.1.1.1.1" xref="A4.12.p12.2.m2.1.1.1.2.cmml"><mo id="A4.12.p12.2.m2.1.1.1.1.2" xref="A4.12.p12.2.m2.1.1.1.2.1.cmml">‖</mo><msup id="A4.12.p12.2.m2.1.1.1.1.1" xref="A4.12.p12.2.m2.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" id="A4.12.p12.2.m2.1.1.1.1.1.2" mathvariant="bold-italic" xref="A4.12.p12.2.m2.1.1.1.1.1.2.cmml">ϵ</mi><mo id="A4.12.p12.2.m2.1.1.1.1.1.3" xref="A4.12.p12.2.m2.1.1.1.1.1.3.cmml">⟂</mo></msup><mo id="A4.12.p12.2.m2.1.1.1.1.3" xref="A4.12.p12.2.m2.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A4.12.p12.2.m2.2.2.3" xref="A4.12.p12.2.m2.2.2.3.cmml">≤</mo><mrow id="A4.12.p12.2.m2.2.2.2" xref="A4.12.p12.2.m2.2.2.2.cmml"><msup id="A4.12.p12.2.m2.2.2.2.3" xref="A4.12.p12.2.m2.2.2.2.3.cmml"><mi id="A4.12.p12.2.m2.2.2.2.3.2" xref="A4.12.p12.2.m2.2.2.2.3.2.cmml">c</mi><mo id="A4.12.p12.2.m2.2.2.2.3.3" xref="A4.12.p12.2.m2.2.2.2.3.3.cmml">′</mo></msup><mo id="A4.12.p12.2.m2.2.2.2.2" xref="A4.12.p12.2.m2.2.2.2.2.cmml">⁢</mo><mrow id="A4.12.p12.2.m2.2.2.2.1.1" xref="A4.12.p12.2.m2.2.2.2.1.2.cmml"><mo id="A4.12.p12.2.m2.2.2.2.1.1.2" xref="A4.12.p12.2.m2.2.2.2.1.2.1.cmml">‖</mo><msubsup id="A4.12.p12.2.m2.2.2.2.1.1.1" xref="A4.12.p12.2.m2.2.2.2.1.1.1.cmml"><mi id="A4.12.p12.2.m2.2.2.2.1.1.1.2.2" xref="A4.12.p12.2.m2.2.2.2.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.12.p12.2.m2.2.2.2.1.1.1.2.3" xref="A4.12.p12.2.m2.2.2.2.1.1.1.2.3.cmml">t</mi><mo id="A4.12.p12.2.m2.2.2.2.1.1.1.3" xref="A4.12.p12.2.m2.2.2.2.1.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.12.p12.2.m2.2.2.2.1.1.3" xref="A4.12.p12.2.m2.2.2.2.1.2.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.12.p12.2.m2.2b"><apply id="A4.12.p12.2.m2.2.2.cmml" xref="A4.12.p12.2.m2.2.2"><leq id="A4.12.p12.2.m2.2.2.3.cmml" xref="A4.12.p12.2.m2.2.2.3"></leq><apply id="A4.12.p12.2.m2.1.1.1.2.cmml" xref="A4.12.p12.2.m2.1.1.1.1"><csymbol cd="latexml" id="A4.12.p12.2.m2.1.1.1.2.1.cmml" xref="A4.12.p12.2.m2.1.1.1.1.2">norm</csymbol><apply id="A4.12.p12.2.m2.1.1.1.1.1.cmml" xref="A4.12.p12.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.12.p12.2.m2.1.1.1.1.1.1.cmml" xref="A4.12.p12.2.m2.1.1.1.1.1">superscript</csymbol><ci id="A4.12.p12.2.m2.1.1.1.1.1.2.cmml" xref="A4.12.p12.2.m2.1.1.1.1.1.2">bold-italic-ϵ</ci><csymbol cd="latexml" id="A4.12.p12.2.m2.1.1.1.1.1.3.cmml" xref="A4.12.p12.2.m2.1.1.1.1.1.3">perpendicular-to</csymbol></apply></apply><apply id="A4.12.p12.2.m2.2.2.2.cmml" xref="A4.12.p12.2.m2.2.2.2"><times id="A4.12.p12.2.m2.2.2.2.2.cmml" xref="A4.12.p12.2.m2.2.2.2.2"></times><apply id="A4.12.p12.2.m2.2.2.2.3.cmml" xref="A4.12.p12.2.m2.2.2.2.3"><csymbol cd="ambiguous" id="A4.12.p12.2.m2.2.2.2.3.1.cmml" xref="A4.12.p12.2.m2.2.2.2.3">superscript</csymbol><ci id="A4.12.p12.2.m2.2.2.2.3.2.cmml" xref="A4.12.p12.2.m2.2.2.2.3.2">𝑐</ci><ci id="A4.12.p12.2.m2.2.2.2.3.3.cmml" xref="A4.12.p12.2.m2.2.2.2.3.3">′</ci></apply><apply id="A4.12.p12.2.m2.2.2.2.1.2.cmml" xref="A4.12.p12.2.m2.2.2.2.1.1"><csymbol cd="latexml" id="A4.12.p12.2.m2.2.2.2.1.2.1.cmml" xref="A4.12.p12.2.m2.2.2.2.1.1.2">norm</csymbol><apply id="A4.12.p12.2.m2.2.2.2.1.1.1.cmml" xref="A4.12.p12.2.m2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.12.p12.2.m2.2.2.2.1.1.1.1.cmml" xref="A4.12.p12.2.m2.2.2.2.1.1.1">superscript</csymbol><apply id="A4.12.p12.2.m2.2.2.2.1.1.1.2.cmml" xref="A4.12.p12.2.m2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.12.p12.2.m2.2.2.2.1.1.1.2.1.cmml" xref="A4.12.p12.2.m2.2.2.2.1.1.1">subscript</csymbol><ci id="A4.12.p12.2.m2.2.2.2.1.1.1.2.2.cmml" xref="A4.12.p12.2.m2.2.2.2.1.1.1.2.2">𝒈</ci><ci id="A4.12.p12.2.m2.2.2.2.1.1.1.2.3.cmml" xref="A4.12.p12.2.m2.2.2.2.1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.12.p12.2.m2.2.2.2.1.1.1.3.cmml" xref="A4.12.p12.2.m2.2.2.2.1.1.1.3">perpendicular-to</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.12.p12.2.m2.2c">\left\|\bm{\epsilon}^{\perp}\right\|\leq c^{\prime}\left\|{\bm{g}}_{t}^{\perp}\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.12.p12.2.m2.2d">∥ bold_italic_ϵ start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥ ≤ italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∥ bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥</annotation></semantics></math> for some small constant <math alttext="c^{\prime}&gt;0" class="ltx_Math" display="inline" id="A4.12.p12.3.m3.1"><semantics id="A4.12.p12.3.m3.1a"><mrow id="A4.12.p12.3.m3.1.1" xref="A4.12.p12.3.m3.1.1.cmml"><msup id="A4.12.p12.3.m3.1.1.2" xref="A4.12.p12.3.m3.1.1.2.cmml"><mi id="A4.12.p12.3.m3.1.1.2.2" xref="A4.12.p12.3.m3.1.1.2.2.cmml">c</mi><mo id="A4.12.p12.3.m3.1.1.2.3" xref="A4.12.p12.3.m3.1.1.2.3.cmml">′</mo></msup><mo id="A4.12.p12.3.m3.1.1.1" xref="A4.12.p12.3.m3.1.1.1.cmml">&gt;</mo><mn id="A4.12.p12.3.m3.1.1.3" xref="A4.12.p12.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.12.p12.3.m3.1b"><apply id="A4.12.p12.3.m3.1.1.cmml" xref="A4.12.p12.3.m3.1.1"><gt id="A4.12.p12.3.m3.1.1.1.cmml" xref="A4.12.p12.3.m3.1.1.1"></gt><apply id="A4.12.p12.3.m3.1.1.2.cmml" xref="A4.12.p12.3.m3.1.1.2"><csymbol cd="ambiguous" id="A4.12.p12.3.m3.1.1.2.1.cmml" xref="A4.12.p12.3.m3.1.1.2">superscript</csymbol><ci id="A4.12.p12.3.m3.1.1.2.2.cmml" xref="A4.12.p12.3.m3.1.1.2.2">𝑐</ci><ci id="A4.12.p12.3.m3.1.1.2.3.cmml" xref="A4.12.p12.3.m3.1.1.2.3">′</ci></apply><cn id="A4.12.p12.3.m3.1.1.3.cmml" type="integer" xref="A4.12.p12.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.12.p12.3.m3.1c">c^{\prime}&gt;0</annotation><annotation encoding="application/x-llamapun" id="A4.12.p12.3.m3.1d">italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT &gt; 0</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.13.p13">
<p class="ltx_p" id="A4.13.p13.1">Therefore,</p>
<table class="ltx_equation ltx_eqn_table" id="A4.Ex17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})\leq c^{\prime}\eta\left\|{\bm%
{g}}_{t}^{\perp}\right\|." class="ltx_Math" display="block" id="A4.Ex17.m1.2"><semantics id="A4.Ex17.m1.2a"><mrow id="A4.Ex17.m1.2.2.1" xref="A4.Ex17.m1.2.2.1.1.cmml"><mrow id="A4.Ex17.m1.2.2.1.1" xref="A4.Ex17.m1.2.2.1.1.cmml"><mrow id="A4.Ex17.m1.2.2.1.1.1" xref="A4.Ex17.m1.2.2.1.1.1.cmml"><mtext id="A4.Ex17.m1.2.2.1.1.1.3" xref="A4.Ex17.m1.2.2.1.1.1.3a.cmml">dist</mtext><mo id="A4.Ex17.m1.2.2.1.1.1.2" xref="A4.Ex17.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex17.m1.2.2.1.1.1.1.1" xref="A4.Ex17.m1.2.2.1.1.1.1.2.cmml"><mo id="A4.Ex17.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="A4.Ex17.m1.2.2.1.1.1.1.2.cmml">(</mo><msubsup id="A4.Ex17.m1.2.2.1.1.1.1.1.1" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.2" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.2" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.1" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.3" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.Ex17.m1.2.2.1.1.1.1.1.1.3" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="A4.Ex17.m1.2.2.1.1.1.1.1.3" xref="A4.Ex17.m1.2.2.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex17.m1.1.1" xref="A4.Ex17.m1.1.1.cmml">ℳ</mi><mo id="A4.Ex17.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="A4.Ex17.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.Ex17.m1.2.2.1.1.3" xref="A4.Ex17.m1.2.2.1.1.3.cmml">≤</mo><mrow id="A4.Ex17.m1.2.2.1.1.2" xref="A4.Ex17.m1.2.2.1.1.2.cmml"><msup id="A4.Ex17.m1.2.2.1.1.2.3" xref="A4.Ex17.m1.2.2.1.1.2.3.cmml"><mi id="A4.Ex17.m1.2.2.1.1.2.3.2" xref="A4.Ex17.m1.2.2.1.1.2.3.2.cmml">c</mi><mo id="A4.Ex17.m1.2.2.1.1.2.3.3" xref="A4.Ex17.m1.2.2.1.1.2.3.3.cmml">′</mo></msup><mo id="A4.Ex17.m1.2.2.1.1.2.2" xref="A4.Ex17.m1.2.2.1.1.2.2.cmml">⁢</mo><mi id="A4.Ex17.m1.2.2.1.1.2.4" xref="A4.Ex17.m1.2.2.1.1.2.4.cmml">η</mi><mo id="A4.Ex17.m1.2.2.1.1.2.2a" xref="A4.Ex17.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="A4.Ex17.m1.2.2.1.1.2.1.1" xref="A4.Ex17.m1.2.2.1.1.2.1.2.cmml"><mo id="A4.Ex17.m1.2.2.1.1.2.1.1.2" xref="A4.Ex17.m1.2.2.1.1.2.1.2.1.cmml">‖</mo><msubsup id="A4.Ex17.m1.2.2.1.1.2.1.1.1" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1.cmml"><mi id="A4.Ex17.m1.2.2.1.1.2.1.1.1.2.2" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.Ex17.m1.2.2.1.1.2.1.1.1.2.3" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1.2.3.cmml">t</mi><mo id="A4.Ex17.m1.2.2.1.1.2.1.1.1.3" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.Ex17.m1.2.2.1.1.2.1.1.3" xref="A4.Ex17.m1.2.2.1.1.2.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="A4.Ex17.m1.2.2.1.2" lspace="0em" xref="A4.Ex17.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex17.m1.2b"><apply id="A4.Ex17.m1.2.2.1.1.cmml" xref="A4.Ex17.m1.2.2.1"><leq id="A4.Ex17.m1.2.2.1.1.3.cmml" xref="A4.Ex17.m1.2.2.1.1.3"></leq><apply id="A4.Ex17.m1.2.2.1.1.1.cmml" xref="A4.Ex17.m1.2.2.1.1.1"><times id="A4.Ex17.m1.2.2.1.1.1.2.cmml" xref="A4.Ex17.m1.2.2.1.1.1.2"></times><ci id="A4.Ex17.m1.2.2.1.1.1.3a.cmml" xref="A4.Ex17.m1.2.2.1.1.1.3"><mtext id="A4.Ex17.m1.2.2.1.1.1.3.cmml" xref="A4.Ex17.m1.2.2.1.1.1.3">dist</mtext></ci><interval closure="open" id="A4.Ex17.m1.2.2.1.1.1.1.2.cmml" xref="A4.Ex17.m1.2.2.1.1.1.1.1"><apply id="A4.Ex17.m1.2.2.1.1.1.1.1.1.cmml" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex17.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.2">𝒛</ci><apply id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3"><minus id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.1"></minus><ci id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A4.Ex17.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A4.Ex17.m1.2.2.1.1.1.1.1.1.3">′</ci></apply><ci id="A4.Ex17.m1.1.1.cmml" xref="A4.Ex17.m1.1.1">ℳ</ci></interval></apply><apply id="A4.Ex17.m1.2.2.1.1.2.cmml" xref="A4.Ex17.m1.2.2.1.1.2"><times id="A4.Ex17.m1.2.2.1.1.2.2.cmml" xref="A4.Ex17.m1.2.2.1.1.2.2"></times><apply id="A4.Ex17.m1.2.2.1.1.2.3.cmml" xref="A4.Ex17.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="A4.Ex17.m1.2.2.1.1.2.3.1.cmml" xref="A4.Ex17.m1.2.2.1.1.2.3">superscript</csymbol><ci id="A4.Ex17.m1.2.2.1.1.2.3.2.cmml" xref="A4.Ex17.m1.2.2.1.1.2.3.2">𝑐</ci><ci id="A4.Ex17.m1.2.2.1.1.2.3.3.cmml" xref="A4.Ex17.m1.2.2.1.1.2.3.3">′</ci></apply><ci id="A4.Ex17.m1.2.2.1.1.2.4.cmml" xref="A4.Ex17.m1.2.2.1.1.2.4">𝜂</ci><apply id="A4.Ex17.m1.2.2.1.1.2.1.2.cmml" xref="A4.Ex17.m1.2.2.1.1.2.1.1"><csymbol cd="latexml" id="A4.Ex17.m1.2.2.1.1.2.1.2.1.cmml" xref="A4.Ex17.m1.2.2.1.1.2.1.1.2">norm</csymbol><apply id="A4.Ex17.m1.2.2.1.1.2.1.1.1.cmml" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A4.Ex17.m1.2.2.1.1.2.1.1.1.1.cmml" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1">superscript</csymbol><apply id="A4.Ex17.m1.2.2.1.1.2.1.1.1.2.cmml" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A4.Ex17.m1.2.2.1.1.2.1.1.1.2.1.cmml" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="A4.Ex17.m1.2.2.1.1.2.1.1.1.2.2.cmml" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1.2.2">𝒈</ci><ci id="A4.Ex17.m1.2.2.1.1.2.1.1.1.2.3.cmml" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex17.m1.2.2.1.1.2.1.1.1.3.cmml" xref="A4.Ex17.m1.2.2.1.1.2.1.1.1.3">perpendicular-to</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex17.m1.2c">\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})\leq c^{\prime}\eta\left\|{\bm%
{g}}_{t}^{\perp}\right\|.</annotation><annotation encoding="application/x-llamapun" id="A4.Ex17.m1.2d">dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M ) ≤ italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_η ∥ bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A4.14.p14">
<p class="ltx_p" id="A4.14.p14.2">Comparing the distances, we have:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx3">
<tbody id="A4.Ex18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{dist}({\bm{z}}_{t-1},\mathcal{M})-\text{dist}({\bm{z}}_{t-1%
}^{\prime},\mathcal{M})" class="ltx_Math" display="inline" id="A4.Ex18.m1.4"><semantics id="A4.Ex18.m1.4a"><mrow id="A4.Ex18.m1.4.4" xref="A4.Ex18.m1.4.4.cmml"><mrow id="A4.Ex18.m1.3.3.1" xref="A4.Ex18.m1.3.3.1.cmml"><mtext id="A4.Ex18.m1.3.3.1.3" xref="A4.Ex18.m1.3.3.1.3a.cmml">dist</mtext><mo id="A4.Ex18.m1.3.3.1.2" xref="A4.Ex18.m1.3.3.1.2.cmml">⁢</mo><mrow id="A4.Ex18.m1.3.3.1.1.1" xref="A4.Ex18.m1.3.3.1.1.2.cmml"><mo id="A4.Ex18.m1.3.3.1.1.1.2" stretchy="false" xref="A4.Ex18.m1.3.3.1.1.2.cmml">(</mo><msub id="A4.Ex18.m1.3.3.1.1.1.1" xref="A4.Ex18.m1.3.3.1.1.1.1.cmml"><mi id="A4.Ex18.m1.3.3.1.1.1.1.2" xref="A4.Ex18.m1.3.3.1.1.1.1.2.cmml">𝒛</mi><mrow id="A4.Ex18.m1.3.3.1.1.1.1.3" xref="A4.Ex18.m1.3.3.1.1.1.1.3.cmml"><mi id="A4.Ex18.m1.3.3.1.1.1.1.3.2" xref="A4.Ex18.m1.3.3.1.1.1.1.3.2.cmml">t</mi><mo id="A4.Ex18.m1.3.3.1.1.1.1.3.1" xref="A4.Ex18.m1.3.3.1.1.1.1.3.1.cmml">−</mo><mn id="A4.Ex18.m1.3.3.1.1.1.1.3.3" xref="A4.Ex18.m1.3.3.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A4.Ex18.m1.3.3.1.1.1.3" xref="A4.Ex18.m1.3.3.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex18.m1.1.1" xref="A4.Ex18.m1.1.1.cmml">ℳ</mi><mo id="A4.Ex18.m1.3.3.1.1.1.4" stretchy="false" xref="A4.Ex18.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.Ex18.m1.4.4.3" xref="A4.Ex18.m1.4.4.3.cmml">−</mo><mrow id="A4.Ex18.m1.4.4.2" xref="A4.Ex18.m1.4.4.2.cmml"><mtext id="A4.Ex18.m1.4.4.2.3" xref="A4.Ex18.m1.4.4.2.3a.cmml">dist</mtext><mo id="A4.Ex18.m1.4.4.2.2" xref="A4.Ex18.m1.4.4.2.2.cmml">⁢</mo><mrow id="A4.Ex18.m1.4.4.2.1.1" xref="A4.Ex18.m1.4.4.2.1.2.cmml"><mo id="A4.Ex18.m1.4.4.2.1.1.2" stretchy="false" xref="A4.Ex18.m1.4.4.2.1.2.cmml">(</mo><msubsup id="A4.Ex18.m1.4.4.2.1.1.1" xref="A4.Ex18.m1.4.4.2.1.1.1.cmml"><mi id="A4.Ex18.m1.4.4.2.1.1.1.2.2" xref="A4.Ex18.m1.4.4.2.1.1.1.2.2.cmml">𝒛</mi><mrow id="A4.Ex18.m1.4.4.2.1.1.1.2.3" xref="A4.Ex18.m1.4.4.2.1.1.1.2.3.cmml"><mi id="A4.Ex18.m1.4.4.2.1.1.1.2.3.2" xref="A4.Ex18.m1.4.4.2.1.1.1.2.3.2.cmml">t</mi><mo id="A4.Ex18.m1.4.4.2.1.1.1.2.3.1" xref="A4.Ex18.m1.4.4.2.1.1.1.2.3.1.cmml">−</mo><mn id="A4.Ex18.m1.4.4.2.1.1.1.2.3.3" xref="A4.Ex18.m1.4.4.2.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.Ex18.m1.4.4.2.1.1.1.3" xref="A4.Ex18.m1.4.4.2.1.1.1.3.cmml">′</mo></msubsup><mo id="A4.Ex18.m1.4.4.2.1.1.3" xref="A4.Ex18.m1.4.4.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex18.m1.2.2" xref="A4.Ex18.m1.2.2.cmml">ℳ</mi><mo id="A4.Ex18.m1.4.4.2.1.1.4" stretchy="false" xref="A4.Ex18.m1.4.4.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex18.m1.4b"><apply id="A4.Ex18.m1.4.4.cmml" xref="A4.Ex18.m1.4.4"><minus id="A4.Ex18.m1.4.4.3.cmml" xref="A4.Ex18.m1.4.4.3"></minus><apply id="A4.Ex18.m1.3.3.1.cmml" xref="A4.Ex18.m1.3.3.1"><times id="A4.Ex18.m1.3.3.1.2.cmml" xref="A4.Ex18.m1.3.3.1.2"></times><ci id="A4.Ex18.m1.3.3.1.3a.cmml" xref="A4.Ex18.m1.3.3.1.3"><mtext id="A4.Ex18.m1.3.3.1.3.cmml" xref="A4.Ex18.m1.3.3.1.3">dist</mtext></ci><interval closure="open" id="A4.Ex18.m1.3.3.1.1.2.cmml" xref="A4.Ex18.m1.3.3.1.1.1"><apply id="A4.Ex18.m1.3.3.1.1.1.1.cmml" xref="A4.Ex18.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex18.m1.3.3.1.1.1.1.1.cmml" xref="A4.Ex18.m1.3.3.1.1.1.1">subscript</csymbol><ci id="A4.Ex18.m1.3.3.1.1.1.1.2.cmml" xref="A4.Ex18.m1.3.3.1.1.1.1.2">𝒛</ci><apply id="A4.Ex18.m1.3.3.1.1.1.1.3.cmml" xref="A4.Ex18.m1.3.3.1.1.1.1.3"><minus id="A4.Ex18.m1.3.3.1.1.1.1.3.1.cmml" xref="A4.Ex18.m1.3.3.1.1.1.1.3.1"></minus><ci id="A4.Ex18.m1.3.3.1.1.1.1.3.2.cmml" xref="A4.Ex18.m1.3.3.1.1.1.1.3.2">𝑡</ci><cn id="A4.Ex18.m1.3.3.1.1.1.1.3.3.cmml" type="integer" xref="A4.Ex18.m1.3.3.1.1.1.1.3.3">1</cn></apply></apply><ci id="A4.Ex18.m1.1.1.cmml" xref="A4.Ex18.m1.1.1">ℳ</ci></interval></apply><apply id="A4.Ex18.m1.4.4.2.cmml" xref="A4.Ex18.m1.4.4.2"><times id="A4.Ex18.m1.4.4.2.2.cmml" xref="A4.Ex18.m1.4.4.2.2"></times><ci id="A4.Ex18.m1.4.4.2.3a.cmml" xref="A4.Ex18.m1.4.4.2.3"><mtext id="A4.Ex18.m1.4.4.2.3.cmml" xref="A4.Ex18.m1.4.4.2.3">dist</mtext></ci><interval closure="open" id="A4.Ex18.m1.4.4.2.1.2.cmml" xref="A4.Ex18.m1.4.4.2.1.1"><apply id="A4.Ex18.m1.4.4.2.1.1.1.cmml" xref="A4.Ex18.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A4.Ex18.m1.4.4.2.1.1.1.1.cmml" xref="A4.Ex18.m1.4.4.2.1.1.1">superscript</csymbol><apply id="A4.Ex18.m1.4.4.2.1.1.1.2.cmml" xref="A4.Ex18.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A4.Ex18.m1.4.4.2.1.1.1.2.1.cmml" xref="A4.Ex18.m1.4.4.2.1.1.1">subscript</csymbol><ci id="A4.Ex18.m1.4.4.2.1.1.1.2.2.cmml" xref="A4.Ex18.m1.4.4.2.1.1.1.2.2">𝒛</ci><apply id="A4.Ex18.m1.4.4.2.1.1.1.2.3.cmml" xref="A4.Ex18.m1.4.4.2.1.1.1.2.3"><minus id="A4.Ex18.m1.4.4.2.1.1.1.2.3.1.cmml" xref="A4.Ex18.m1.4.4.2.1.1.1.2.3.1"></minus><ci id="A4.Ex18.m1.4.4.2.1.1.1.2.3.2.cmml" xref="A4.Ex18.m1.4.4.2.1.1.1.2.3.2">𝑡</ci><cn id="A4.Ex18.m1.4.4.2.1.1.1.2.3.3.cmml" type="integer" xref="A4.Ex18.m1.4.4.2.1.1.1.2.3.3">1</cn></apply></apply><ci id="A4.Ex18.m1.4.4.2.1.1.1.3.cmml" xref="A4.Ex18.m1.4.4.2.1.1.1.3">′</ci></apply><ci id="A4.Ex18.m1.2.2.cmml" xref="A4.Ex18.m1.2.2">ℳ</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex18.m1.4c">\displaystyle\text{dist}({\bm{z}}_{t-1},\mathcal{M})-\text{dist}({\bm{z}}_{t-1%
}^{\prime},\mathcal{M})</annotation><annotation encoding="application/x-llamapun" id="A4.Ex18.m1.4d">dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , caligraphic_M ) - dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\geq\eta\left\|{\bm{g}}_{t}^{\perp}\right\|-c^{\prime}\eta\left\|%
{\bm{g}}_{t}^{\perp}\right\|" class="ltx_Math" display="inline" id="A4.Ex18.m2.2"><semantics id="A4.Ex18.m2.2a"><mrow id="A4.Ex18.m2.2.2" xref="A4.Ex18.m2.2.2.cmml"><mi id="A4.Ex18.m2.2.2.4" xref="A4.Ex18.m2.2.2.4.cmml"></mi><mo id="A4.Ex18.m2.2.2.3" xref="A4.Ex18.m2.2.2.3.cmml">≥</mo><mrow id="A4.Ex18.m2.2.2.2" xref="A4.Ex18.m2.2.2.2.cmml"><mrow id="A4.Ex18.m2.1.1.1.1" xref="A4.Ex18.m2.1.1.1.1.cmml"><mi id="A4.Ex18.m2.1.1.1.1.3" xref="A4.Ex18.m2.1.1.1.1.3.cmml">η</mi><mo id="A4.Ex18.m2.1.1.1.1.2" xref="A4.Ex18.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex18.m2.1.1.1.1.1.1" xref="A4.Ex18.m2.1.1.1.1.1.2.cmml"><mo id="A4.Ex18.m2.1.1.1.1.1.1.2" xref="A4.Ex18.m2.1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="A4.Ex18.m2.1.1.1.1.1.1.1" xref="A4.Ex18.m2.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex18.m2.1.1.1.1.1.1.1.2.2" xref="A4.Ex18.m2.1.1.1.1.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.Ex18.m2.1.1.1.1.1.1.1.2.3" xref="A4.Ex18.m2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mo id="A4.Ex18.m2.1.1.1.1.1.1.1.3" xref="A4.Ex18.m2.1.1.1.1.1.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.Ex18.m2.1.1.1.1.1.1.3" xref="A4.Ex18.m2.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="A4.Ex18.m2.2.2.2.3" xref="A4.Ex18.m2.2.2.2.3.cmml">−</mo><mrow id="A4.Ex18.m2.2.2.2.2" xref="A4.Ex18.m2.2.2.2.2.cmml"><msup id="A4.Ex18.m2.2.2.2.2.3" xref="A4.Ex18.m2.2.2.2.2.3.cmml"><mi id="A4.Ex18.m2.2.2.2.2.3.2" xref="A4.Ex18.m2.2.2.2.2.3.2.cmml">c</mi><mo id="A4.Ex18.m2.2.2.2.2.3.3" xref="A4.Ex18.m2.2.2.2.2.3.3.cmml">′</mo></msup><mo id="A4.Ex18.m2.2.2.2.2.2" xref="A4.Ex18.m2.2.2.2.2.2.cmml">⁢</mo><mi id="A4.Ex18.m2.2.2.2.2.4" xref="A4.Ex18.m2.2.2.2.2.4.cmml">η</mi><mo id="A4.Ex18.m2.2.2.2.2.2a" xref="A4.Ex18.m2.2.2.2.2.2.cmml">⁢</mo><mrow id="A4.Ex18.m2.2.2.2.2.1.1" xref="A4.Ex18.m2.2.2.2.2.1.2.cmml"><mo id="A4.Ex18.m2.2.2.2.2.1.1.2" xref="A4.Ex18.m2.2.2.2.2.1.2.1.cmml">‖</mo><msubsup id="A4.Ex18.m2.2.2.2.2.1.1.1" xref="A4.Ex18.m2.2.2.2.2.1.1.1.cmml"><mi id="A4.Ex18.m2.2.2.2.2.1.1.1.2.2" xref="A4.Ex18.m2.2.2.2.2.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.Ex18.m2.2.2.2.2.1.1.1.2.3" xref="A4.Ex18.m2.2.2.2.2.1.1.1.2.3.cmml">t</mi><mo id="A4.Ex18.m2.2.2.2.2.1.1.1.3" xref="A4.Ex18.m2.2.2.2.2.1.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.Ex18.m2.2.2.2.2.1.1.3" xref="A4.Ex18.m2.2.2.2.2.1.2.1.cmml">‖</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex18.m2.2b"><apply id="A4.Ex18.m2.2.2.cmml" xref="A4.Ex18.m2.2.2"><geq id="A4.Ex18.m2.2.2.3.cmml" xref="A4.Ex18.m2.2.2.3"></geq><csymbol cd="latexml" id="A4.Ex18.m2.2.2.4.cmml" xref="A4.Ex18.m2.2.2.4">absent</csymbol><apply id="A4.Ex18.m2.2.2.2.cmml" xref="A4.Ex18.m2.2.2.2"><minus id="A4.Ex18.m2.2.2.2.3.cmml" xref="A4.Ex18.m2.2.2.2.3"></minus><apply id="A4.Ex18.m2.1.1.1.1.cmml" xref="A4.Ex18.m2.1.1.1.1"><times id="A4.Ex18.m2.1.1.1.1.2.cmml" xref="A4.Ex18.m2.1.1.1.1.2"></times><ci id="A4.Ex18.m2.1.1.1.1.3.cmml" xref="A4.Ex18.m2.1.1.1.1.3">𝜂</ci><apply id="A4.Ex18.m2.1.1.1.1.1.2.cmml" xref="A4.Ex18.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="A4.Ex18.m2.1.1.1.1.1.2.1.cmml" xref="A4.Ex18.m2.1.1.1.1.1.1.2">norm</csymbol><apply id="A4.Ex18.m2.1.1.1.1.1.1.1.cmml" xref="A4.Ex18.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex18.m2.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex18.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A4.Ex18.m2.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex18.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex18.m2.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex18.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex18.m2.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex18.m2.1.1.1.1.1.1.1.2.2">𝒈</ci><ci id="A4.Ex18.m2.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex18.m2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex18.m2.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex18.m2.1.1.1.1.1.1.1.3">perpendicular-to</csymbol></apply></apply></apply><apply id="A4.Ex18.m2.2.2.2.2.cmml" xref="A4.Ex18.m2.2.2.2.2"><times id="A4.Ex18.m2.2.2.2.2.2.cmml" xref="A4.Ex18.m2.2.2.2.2.2"></times><apply id="A4.Ex18.m2.2.2.2.2.3.cmml" xref="A4.Ex18.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="A4.Ex18.m2.2.2.2.2.3.1.cmml" xref="A4.Ex18.m2.2.2.2.2.3">superscript</csymbol><ci id="A4.Ex18.m2.2.2.2.2.3.2.cmml" xref="A4.Ex18.m2.2.2.2.2.3.2">𝑐</ci><ci id="A4.Ex18.m2.2.2.2.2.3.3.cmml" xref="A4.Ex18.m2.2.2.2.2.3.3">′</ci></apply><ci id="A4.Ex18.m2.2.2.2.2.4.cmml" xref="A4.Ex18.m2.2.2.2.2.4">𝜂</ci><apply id="A4.Ex18.m2.2.2.2.2.1.2.cmml" xref="A4.Ex18.m2.2.2.2.2.1.1"><csymbol cd="latexml" id="A4.Ex18.m2.2.2.2.2.1.2.1.cmml" xref="A4.Ex18.m2.2.2.2.2.1.1.2">norm</csymbol><apply id="A4.Ex18.m2.2.2.2.2.1.1.1.cmml" xref="A4.Ex18.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.Ex18.m2.2.2.2.2.1.1.1.1.cmml" xref="A4.Ex18.m2.2.2.2.2.1.1.1">superscript</csymbol><apply id="A4.Ex18.m2.2.2.2.2.1.1.1.2.cmml" xref="A4.Ex18.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.Ex18.m2.2.2.2.2.1.1.1.2.1.cmml" xref="A4.Ex18.m2.2.2.2.2.1.1.1">subscript</csymbol><ci id="A4.Ex18.m2.2.2.2.2.1.1.1.2.2.cmml" xref="A4.Ex18.m2.2.2.2.2.1.1.1.2.2">𝒈</ci><ci id="A4.Ex18.m2.2.2.2.2.1.1.1.2.3.cmml" xref="A4.Ex18.m2.2.2.2.2.1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex18.m2.2.2.2.2.1.1.1.3.cmml" xref="A4.Ex18.m2.2.2.2.2.1.1.1.3">perpendicular-to</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex18.m2.2c">\displaystyle\geq\eta\left\|{\bm{g}}_{t}^{\perp}\right\|-c^{\prime}\eta\left\|%
{\bm{g}}_{t}^{\perp}\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex18.m2.2d">≥ italic_η ∥ bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥ - italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_η ∥ bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(1-c^{\prime})\eta\left\|{\bm{g}}_{t}^{\perp}\right\|" class="ltx_Math" display="inline" id="A4.Ex19.m1.2"><semantics id="A4.Ex19.m1.2a"><mrow id="A4.Ex19.m1.2.2" xref="A4.Ex19.m1.2.2.cmml"><mi id="A4.Ex19.m1.2.2.4" xref="A4.Ex19.m1.2.2.4.cmml"></mi><mo id="A4.Ex19.m1.2.2.3" xref="A4.Ex19.m1.2.2.3.cmml">=</mo><mrow id="A4.Ex19.m1.2.2.2" xref="A4.Ex19.m1.2.2.2.cmml"><mrow id="A4.Ex19.m1.1.1.1.1.1" xref="A4.Ex19.m1.1.1.1.1.1.1.cmml"><mo id="A4.Ex19.m1.1.1.1.1.1.2" stretchy="false" xref="A4.Ex19.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.Ex19.m1.1.1.1.1.1.1" xref="A4.Ex19.m1.1.1.1.1.1.1.cmml"><mn id="A4.Ex19.m1.1.1.1.1.1.1.2" xref="A4.Ex19.m1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A4.Ex19.m1.1.1.1.1.1.1.1" xref="A4.Ex19.m1.1.1.1.1.1.1.1.cmml">−</mo><msup id="A4.Ex19.m1.1.1.1.1.1.1.3" xref="A4.Ex19.m1.1.1.1.1.1.1.3.cmml"><mi id="A4.Ex19.m1.1.1.1.1.1.1.3.2" xref="A4.Ex19.m1.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="A4.Ex19.m1.1.1.1.1.1.1.3.3" xref="A4.Ex19.m1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="A4.Ex19.m1.1.1.1.1.1.3" stretchy="false" xref="A4.Ex19.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A4.Ex19.m1.2.2.2.3" xref="A4.Ex19.m1.2.2.2.3.cmml">⁢</mo><mi id="A4.Ex19.m1.2.2.2.4" xref="A4.Ex19.m1.2.2.2.4.cmml">η</mi><mo id="A4.Ex19.m1.2.2.2.3a" xref="A4.Ex19.m1.2.2.2.3.cmml">⁢</mo><mrow id="A4.Ex19.m1.2.2.2.2.1" xref="A4.Ex19.m1.2.2.2.2.2.cmml"><mo id="A4.Ex19.m1.2.2.2.2.1.2" xref="A4.Ex19.m1.2.2.2.2.2.1.cmml">‖</mo><msubsup id="A4.Ex19.m1.2.2.2.2.1.1" xref="A4.Ex19.m1.2.2.2.2.1.1.cmml"><mi id="A4.Ex19.m1.2.2.2.2.1.1.2.2" xref="A4.Ex19.m1.2.2.2.2.1.1.2.2.cmml">𝒈</mi><mi id="A4.Ex19.m1.2.2.2.2.1.1.2.3" xref="A4.Ex19.m1.2.2.2.2.1.1.2.3.cmml">t</mi><mo id="A4.Ex19.m1.2.2.2.2.1.1.3" xref="A4.Ex19.m1.2.2.2.2.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.Ex19.m1.2.2.2.2.1.3" xref="A4.Ex19.m1.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex19.m1.2b"><apply id="A4.Ex19.m1.2.2.cmml" xref="A4.Ex19.m1.2.2"><eq id="A4.Ex19.m1.2.2.3.cmml" xref="A4.Ex19.m1.2.2.3"></eq><csymbol cd="latexml" id="A4.Ex19.m1.2.2.4.cmml" xref="A4.Ex19.m1.2.2.4">absent</csymbol><apply id="A4.Ex19.m1.2.2.2.cmml" xref="A4.Ex19.m1.2.2.2"><times id="A4.Ex19.m1.2.2.2.3.cmml" xref="A4.Ex19.m1.2.2.2.3"></times><apply id="A4.Ex19.m1.1.1.1.1.1.1.cmml" xref="A4.Ex19.m1.1.1.1.1.1"><minus id="A4.Ex19.m1.1.1.1.1.1.1.1.cmml" xref="A4.Ex19.m1.1.1.1.1.1.1.1"></minus><cn id="A4.Ex19.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="A4.Ex19.m1.1.1.1.1.1.1.2">1</cn><apply id="A4.Ex19.m1.1.1.1.1.1.1.3.cmml" xref="A4.Ex19.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.Ex19.m1.1.1.1.1.1.1.3.1.cmml" xref="A4.Ex19.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A4.Ex19.m1.1.1.1.1.1.1.3.2.cmml" xref="A4.Ex19.m1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="A4.Ex19.m1.1.1.1.1.1.1.3.3.cmml" xref="A4.Ex19.m1.1.1.1.1.1.1.3.3">′</ci></apply></apply><ci id="A4.Ex19.m1.2.2.2.4.cmml" xref="A4.Ex19.m1.2.2.2.4">𝜂</ci><apply id="A4.Ex19.m1.2.2.2.2.2.cmml" xref="A4.Ex19.m1.2.2.2.2.1"><csymbol cd="latexml" id="A4.Ex19.m1.2.2.2.2.2.1.cmml" xref="A4.Ex19.m1.2.2.2.2.1.2">norm</csymbol><apply id="A4.Ex19.m1.2.2.2.2.1.1.cmml" xref="A4.Ex19.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A4.Ex19.m1.2.2.2.2.1.1.1.cmml" xref="A4.Ex19.m1.2.2.2.2.1.1">superscript</csymbol><apply id="A4.Ex19.m1.2.2.2.2.1.1.2.cmml" xref="A4.Ex19.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A4.Ex19.m1.2.2.2.2.1.1.2.1.cmml" xref="A4.Ex19.m1.2.2.2.2.1.1">subscript</csymbol><ci id="A4.Ex19.m1.2.2.2.2.1.1.2.2.cmml" xref="A4.Ex19.m1.2.2.2.2.1.1.2.2">𝒈</ci><ci id="A4.Ex19.m1.2.2.2.2.1.1.2.3.cmml" xref="A4.Ex19.m1.2.2.2.2.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex19.m1.2.2.2.2.1.1.3.cmml" xref="A4.Ex19.m1.2.2.2.2.1.1.3">perpendicular-to</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex19.m1.2c">\displaystyle=(1-c^{\prime})\eta\left\|{\bm{g}}_{t}^{\perp}\right\|</annotation><annotation encoding="application/x-llamapun" id="A4.Ex19.m1.2d">= ( 1 - italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) italic_η ∥ bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A4.Ex20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=c\eta\left\|{\bm{g}}_{t}^{\perp}\right\|," class="ltx_Math" display="inline" id="A4.Ex20.m1.1"><semantics id="A4.Ex20.m1.1a"><mrow id="A4.Ex20.m1.1.1.1" xref="A4.Ex20.m1.1.1.1.1.cmml"><mrow id="A4.Ex20.m1.1.1.1.1" xref="A4.Ex20.m1.1.1.1.1.cmml"><mi id="A4.Ex20.m1.1.1.1.1.3" xref="A4.Ex20.m1.1.1.1.1.3.cmml"></mi><mo id="A4.Ex20.m1.1.1.1.1.2" xref="A4.Ex20.m1.1.1.1.1.2.cmml">=</mo><mrow id="A4.Ex20.m1.1.1.1.1.1" xref="A4.Ex20.m1.1.1.1.1.1.cmml"><mi id="A4.Ex20.m1.1.1.1.1.1.3" xref="A4.Ex20.m1.1.1.1.1.1.3.cmml">c</mi><mo id="A4.Ex20.m1.1.1.1.1.1.2" xref="A4.Ex20.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A4.Ex20.m1.1.1.1.1.1.4" xref="A4.Ex20.m1.1.1.1.1.1.4.cmml">η</mi><mo id="A4.Ex20.m1.1.1.1.1.1.2a" xref="A4.Ex20.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex20.m1.1.1.1.1.1.1.1" xref="A4.Ex20.m1.1.1.1.1.1.1.2.cmml"><mo id="A4.Ex20.m1.1.1.1.1.1.1.1.2" xref="A4.Ex20.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="A4.Ex20.m1.1.1.1.1.1.1.1.1" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.Ex20.m1.1.1.1.1.1.1.1.1.2.2" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.Ex20.m1.1.1.1.1.1.1.1.1.2.3" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mo id="A4.Ex20.m1.1.1.1.1.1.1.1.1.3" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.Ex20.m1.1.1.1.1.1.1.1.3" xref="A4.Ex20.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="A4.Ex20.m1.1.1.1.2" xref="A4.Ex20.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex20.m1.1b"><apply id="A4.Ex20.m1.1.1.1.1.cmml" xref="A4.Ex20.m1.1.1.1"><eq id="A4.Ex20.m1.1.1.1.1.2.cmml" xref="A4.Ex20.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="A4.Ex20.m1.1.1.1.1.3.cmml" xref="A4.Ex20.m1.1.1.1.1.3">absent</csymbol><apply id="A4.Ex20.m1.1.1.1.1.1.cmml" xref="A4.Ex20.m1.1.1.1.1.1"><times id="A4.Ex20.m1.1.1.1.1.1.2.cmml" xref="A4.Ex20.m1.1.1.1.1.1.2"></times><ci id="A4.Ex20.m1.1.1.1.1.1.3.cmml" xref="A4.Ex20.m1.1.1.1.1.1.3">𝑐</ci><ci id="A4.Ex20.m1.1.1.1.1.1.4.cmml" xref="A4.Ex20.m1.1.1.1.1.1.4">𝜂</ci><apply id="A4.Ex20.m1.1.1.1.1.1.1.2.cmml" xref="A4.Ex20.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A4.Ex20.m1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex20.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A4.Ex20.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex20.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A4.Ex20.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex20.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex20.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1.2.2">𝒈</ci><ci id="A4.Ex20.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.Ex20.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.Ex20.m1.1.1.1.1.1.1.1.1.3">perpendicular-to</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex20.m1.1c">\displaystyle=c\eta\left\|{\bm{g}}_{t}^{\perp}\right\|,</annotation><annotation encoding="application/x-llamapun" id="A4.Ex20.m1.1d">= italic_c italic_η ∥ bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.14.p14.1">where <math alttext="c=1-c^{\prime}&gt;0" class="ltx_Math" display="inline" id="A4.14.p14.1.m1.1"><semantics id="A4.14.p14.1.m1.1a"><mrow id="A4.14.p14.1.m1.1.1" xref="A4.14.p14.1.m1.1.1.cmml"><mi id="A4.14.p14.1.m1.1.1.2" xref="A4.14.p14.1.m1.1.1.2.cmml">c</mi><mo id="A4.14.p14.1.m1.1.1.3" xref="A4.14.p14.1.m1.1.1.3.cmml">=</mo><mrow id="A4.14.p14.1.m1.1.1.4" xref="A4.14.p14.1.m1.1.1.4.cmml"><mn id="A4.14.p14.1.m1.1.1.4.2" xref="A4.14.p14.1.m1.1.1.4.2.cmml">1</mn><mo id="A4.14.p14.1.m1.1.1.4.1" xref="A4.14.p14.1.m1.1.1.4.1.cmml">−</mo><msup id="A4.14.p14.1.m1.1.1.4.3" xref="A4.14.p14.1.m1.1.1.4.3.cmml"><mi id="A4.14.p14.1.m1.1.1.4.3.2" xref="A4.14.p14.1.m1.1.1.4.3.2.cmml">c</mi><mo id="A4.14.p14.1.m1.1.1.4.3.3" xref="A4.14.p14.1.m1.1.1.4.3.3.cmml">′</mo></msup></mrow><mo id="A4.14.p14.1.m1.1.1.5" xref="A4.14.p14.1.m1.1.1.5.cmml">&gt;</mo><mn id="A4.14.p14.1.m1.1.1.6" xref="A4.14.p14.1.m1.1.1.6.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.14.p14.1.m1.1b"><apply id="A4.14.p14.1.m1.1.1.cmml" xref="A4.14.p14.1.m1.1.1"><and id="A4.14.p14.1.m1.1.1a.cmml" xref="A4.14.p14.1.m1.1.1"></and><apply id="A4.14.p14.1.m1.1.1b.cmml" xref="A4.14.p14.1.m1.1.1"><eq id="A4.14.p14.1.m1.1.1.3.cmml" xref="A4.14.p14.1.m1.1.1.3"></eq><ci id="A4.14.p14.1.m1.1.1.2.cmml" xref="A4.14.p14.1.m1.1.1.2">𝑐</ci><apply id="A4.14.p14.1.m1.1.1.4.cmml" xref="A4.14.p14.1.m1.1.1.4"><minus id="A4.14.p14.1.m1.1.1.4.1.cmml" xref="A4.14.p14.1.m1.1.1.4.1"></minus><cn id="A4.14.p14.1.m1.1.1.4.2.cmml" type="integer" xref="A4.14.p14.1.m1.1.1.4.2">1</cn><apply id="A4.14.p14.1.m1.1.1.4.3.cmml" xref="A4.14.p14.1.m1.1.1.4.3"><csymbol cd="ambiguous" id="A4.14.p14.1.m1.1.1.4.3.1.cmml" xref="A4.14.p14.1.m1.1.1.4.3">superscript</csymbol><ci id="A4.14.p14.1.m1.1.1.4.3.2.cmml" xref="A4.14.p14.1.m1.1.1.4.3.2">𝑐</ci><ci id="A4.14.p14.1.m1.1.1.4.3.3.cmml" xref="A4.14.p14.1.m1.1.1.4.3.3">′</ci></apply></apply></apply><apply id="A4.14.p14.1.m1.1.1c.cmml" xref="A4.14.p14.1.m1.1.1"><gt id="A4.14.p14.1.m1.1.1.5.cmml" xref="A4.14.p14.1.m1.1.1.5"></gt><share href="https://arxiv.org/html/2410.03463v1#A4.14.p14.1.m1.1.1.4.cmml" id="A4.14.p14.1.m1.1.1d.cmml" xref="A4.14.p14.1.m1.1.1"></share><cn id="A4.14.p14.1.m1.1.1.6.cmml" type="integer" xref="A4.14.p14.1.m1.1.1.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.14.p14.1.m1.1c">c=1-c^{\prime}&gt;0</annotation><annotation encoding="application/x-llamapun" id="A4.14.p14.1.m1.1d">italic_c = 1 - italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT &gt; 0</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.15.p15">
<p class="ltx_p" id="A4.15.p15.1">Including higher-order terms, we can write:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})\leq\text{dist}({\bm{z}}_{t-1}%
,\mathcal{M})-c\eta\left\|{\bm{g}}_{t}^{\perp}\right\|+\mathcal{O}(\eta^{2})." class="ltx_Math" display="block" id="A4.E11.m1.3"><semantics id="A4.E11.m1.3a"><mrow id="A4.E11.m1.3.3.1" xref="A4.E11.m1.3.3.1.1.cmml"><mrow id="A4.E11.m1.3.3.1.1" xref="A4.E11.m1.3.3.1.1.cmml"><mrow id="A4.E11.m1.3.3.1.1.1" xref="A4.E11.m1.3.3.1.1.1.cmml"><mtext id="A4.E11.m1.3.3.1.1.1.3" xref="A4.E11.m1.3.3.1.1.1.3a.cmml">dist</mtext><mo id="A4.E11.m1.3.3.1.1.1.2" xref="A4.E11.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A4.E11.m1.3.3.1.1.1.1.1" xref="A4.E11.m1.3.3.1.1.1.1.2.cmml"><mo id="A4.E11.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A4.E11.m1.3.3.1.1.1.1.2.cmml">(</mo><msubsup id="A4.E11.m1.3.3.1.1.1.1.1.1" xref="A4.E11.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A4.E11.m1.3.3.1.1.1.1.1.1.2.2" xref="A4.E11.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="A4.E11.m1.3.3.1.1.1.1.1.1.2.3" xref="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.2" xref="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.1" xref="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.3" xref="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.E11.m1.3.3.1.1.1.1.1.1.3" xref="A4.E11.m1.3.3.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="A4.E11.m1.3.3.1.1.1.1.1.3" xref="A4.E11.m1.3.3.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.E11.m1.1.1" xref="A4.E11.m1.1.1.cmml">ℳ</mi><mo id="A4.E11.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="A4.E11.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.E11.m1.3.3.1.1.5" xref="A4.E11.m1.3.3.1.1.5.cmml">≤</mo><mrow id="A4.E11.m1.3.3.1.1.4" xref="A4.E11.m1.3.3.1.1.4.cmml"><mrow id="A4.E11.m1.3.3.1.1.3.2" xref="A4.E11.m1.3.3.1.1.3.2.cmml"><mrow id="A4.E11.m1.3.3.1.1.2.1.1" xref="A4.E11.m1.3.3.1.1.2.1.1.cmml"><mtext id="A4.E11.m1.3.3.1.1.2.1.1.3" xref="A4.E11.m1.3.3.1.1.2.1.1.3a.cmml">dist</mtext><mo id="A4.E11.m1.3.3.1.1.2.1.1.2" xref="A4.E11.m1.3.3.1.1.2.1.1.2.cmml">⁢</mo><mrow id="A4.E11.m1.3.3.1.1.2.1.1.1.1" xref="A4.E11.m1.3.3.1.1.2.1.1.1.2.cmml"><mo id="A4.E11.m1.3.3.1.1.2.1.1.1.1.2" stretchy="false" xref="A4.E11.m1.3.3.1.1.2.1.1.1.2.cmml">(</mo><msub id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mi id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.2" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.cmml"><mi id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.2" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.1" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.1.cmml">−</mo><mn id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.3" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A4.E11.m1.3.3.1.1.2.1.1.1.1.3" xref="A4.E11.m1.3.3.1.1.2.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.E11.m1.2.2" xref="A4.E11.m1.2.2.cmml">ℳ</mi><mo id="A4.E11.m1.3.3.1.1.2.1.1.1.1.4" stretchy="false" xref="A4.E11.m1.3.3.1.1.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.E11.m1.3.3.1.1.3.2.3" xref="A4.E11.m1.3.3.1.1.3.2.3.cmml">−</mo><mrow id="A4.E11.m1.3.3.1.1.3.2.2" xref="A4.E11.m1.3.3.1.1.3.2.2.cmml"><mi id="A4.E11.m1.3.3.1.1.3.2.2.3" xref="A4.E11.m1.3.3.1.1.3.2.2.3.cmml">c</mi><mo id="A4.E11.m1.3.3.1.1.3.2.2.2" xref="A4.E11.m1.3.3.1.1.3.2.2.2.cmml">⁢</mo><mi id="A4.E11.m1.3.3.1.1.3.2.2.4" xref="A4.E11.m1.3.3.1.1.3.2.2.4.cmml">η</mi><mo id="A4.E11.m1.3.3.1.1.3.2.2.2a" xref="A4.E11.m1.3.3.1.1.3.2.2.2.cmml">⁢</mo><mrow id="A4.E11.m1.3.3.1.1.3.2.2.1.1" xref="A4.E11.m1.3.3.1.1.3.2.2.1.2.cmml"><mo id="A4.E11.m1.3.3.1.1.3.2.2.1.1.2" xref="A4.E11.m1.3.3.1.1.3.2.2.1.2.1.cmml">‖</mo><msubsup id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.cmml"><mi id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.2.2" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.2.2.cmml">𝒈</mi><mi id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.2.3" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.2.3.cmml">t</mi><mo id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.3" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.3.cmml">⟂</mo></msubsup><mo id="A4.E11.m1.3.3.1.1.3.2.2.1.1.3" xref="A4.E11.m1.3.3.1.1.3.2.2.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="A4.E11.m1.3.3.1.1.4.4" xref="A4.E11.m1.3.3.1.1.4.4.cmml">+</mo><mrow id="A4.E11.m1.3.3.1.1.4.3" xref="A4.E11.m1.3.3.1.1.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.E11.m1.3.3.1.1.4.3.3" xref="A4.E11.m1.3.3.1.1.4.3.3.cmml">𝒪</mi><mo id="A4.E11.m1.3.3.1.1.4.3.2" xref="A4.E11.m1.3.3.1.1.4.3.2.cmml">⁢</mo><mrow id="A4.E11.m1.3.3.1.1.4.3.1.1" xref="A4.E11.m1.3.3.1.1.4.3.1.1.1.cmml"><mo id="A4.E11.m1.3.3.1.1.4.3.1.1.2" stretchy="false" xref="A4.E11.m1.3.3.1.1.4.3.1.1.1.cmml">(</mo><msup id="A4.E11.m1.3.3.1.1.4.3.1.1.1" xref="A4.E11.m1.3.3.1.1.4.3.1.1.1.cmml"><mi id="A4.E11.m1.3.3.1.1.4.3.1.1.1.2" xref="A4.E11.m1.3.3.1.1.4.3.1.1.1.2.cmml">η</mi><mn id="A4.E11.m1.3.3.1.1.4.3.1.1.1.3" xref="A4.E11.m1.3.3.1.1.4.3.1.1.1.3.cmml">2</mn></msup><mo id="A4.E11.m1.3.3.1.1.4.3.1.1.3" stretchy="false" xref="A4.E11.m1.3.3.1.1.4.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A4.E11.m1.3.3.1.2" lspace="0em" xref="A4.E11.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E11.m1.3b"><apply id="A4.E11.m1.3.3.1.1.cmml" xref="A4.E11.m1.3.3.1"><leq id="A4.E11.m1.3.3.1.1.5.cmml" xref="A4.E11.m1.3.3.1.1.5"></leq><apply id="A4.E11.m1.3.3.1.1.1.cmml" xref="A4.E11.m1.3.3.1.1.1"><times id="A4.E11.m1.3.3.1.1.1.2.cmml" xref="A4.E11.m1.3.3.1.1.1.2"></times><ci id="A4.E11.m1.3.3.1.1.1.3a.cmml" xref="A4.E11.m1.3.3.1.1.1.3"><mtext id="A4.E11.m1.3.3.1.1.1.3.cmml" xref="A4.E11.m1.3.3.1.1.1.3">dist</mtext></ci><interval closure="open" id="A4.E11.m1.3.3.1.1.1.1.2.cmml" xref="A4.E11.m1.3.3.1.1.1.1.1"><apply id="A4.E11.m1.3.3.1.1.1.1.1.1.cmml" xref="A4.E11.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E11.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A4.E11.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="A4.E11.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A4.E11.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E11.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="A4.E11.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A4.E11.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="A4.E11.m1.3.3.1.1.1.1.1.1.2.2">𝒛</ci><apply id="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="A4.E11.m1.3.3.1.1.1.1.1.1.2.3"><minus id="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.1"></minus><ci id="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.E11.m1.3.3.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A4.E11.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A4.E11.m1.3.3.1.1.1.1.1.1.3">′</ci></apply><ci id="A4.E11.m1.1.1.cmml" xref="A4.E11.m1.1.1">ℳ</ci></interval></apply><apply id="A4.E11.m1.3.3.1.1.4.cmml" xref="A4.E11.m1.3.3.1.1.4"><plus id="A4.E11.m1.3.3.1.1.4.4.cmml" xref="A4.E11.m1.3.3.1.1.4.4"></plus><apply id="A4.E11.m1.3.3.1.1.3.2.cmml" xref="A4.E11.m1.3.3.1.1.3.2"><minus id="A4.E11.m1.3.3.1.1.3.2.3.cmml" xref="A4.E11.m1.3.3.1.1.3.2.3"></minus><apply id="A4.E11.m1.3.3.1.1.2.1.1.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1"><times id="A4.E11.m1.3.3.1.1.2.1.1.2.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1.2"></times><ci id="A4.E11.m1.3.3.1.1.2.1.1.3a.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1.3"><mtext id="A4.E11.m1.3.3.1.1.2.1.1.3.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1.3">dist</mtext></ci><interval closure="open" id="A4.E11.m1.3.3.1.1.2.1.1.1.2.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1"><apply id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.2">𝒛</ci><apply id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3"><minus id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.1.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.1"></minus><ci id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.2.cmml" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.2">𝑡</ci><cn id="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.3.cmml" type="integer" xref="A4.E11.m1.3.3.1.1.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="A4.E11.m1.2.2.cmml" xref="A4.E11.m1.2.2">ℳ</ci></interval></apply><apply id="A4.E11.m1.3.3.1.1.3.2.2.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2"><times id="A4.E11.m1.3.3.1.1.3.2.2.2.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.2"></times><ci id="A4.E11.m1.3.3.1.1.3.2.2.3.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.3">𝑐</ci><ci id="A4.E11.m1.3.3.1.1.3.2.2.4.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.4">𝜂</ci><apply id="A4.E11.m1.3.3.1.1.3.2.2.1.2.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1"><csymbol cd="latexml" id="A4.E11.m1.3.3.1.1.3.2.2.1.2.1.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.2">norm</csymbol><apply id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.1.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1">superscript</csymbol><apply id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.2.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.2.1.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1">subscript</csymbol><ci id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.2.2.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.2.2">𝒈</ci><ci id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.2.3.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.3.cmml" xref="A4.E11.m1.3.3.1.1.3.2.2.1.1.1.3">perpendicular-to</csymbol></apply></apply></apply></apply><apply id="A4.E11.m1.3.3.1.1.4.3.cmml" xref="A4.E11.m1.3.3.1.1.4.3"><times id="A4.E11.m1.3.3.1.1.4.3.2.cmml" xref="A4.E11.m1.3.3.1.1.4.3.2"></times><ci id="A4.E11.m1.3.3.1.1.4.3.3.cmml" xref="A4.E11.m1.3.3.1.1.4.3.3">𝒪</ci><apply id="A4.E11.m1.3.3.1.1.4.3.1.1.1.cmml" xref="A4.E11.m1.3.3.1.1.4.3.1.1"><csymbol cd="ambiguous" id="A4.E11.m1.3.3.1.1.4.3.1.1.1.1.cmml" xref="A4.E11.m1.3.3.1.1.4.3.1.1">superscript</csymbol><ci id="A4.E11.m1.3.3.1.1.4.3.1.1.1.2.cmml" xref="A4.E11.m1.3.3.1.1.4.3.1.1.1.2">𝜂</ci><cn id="A4.E11.m1.3.3.1.1.4.3.1.1.1.3.cmml" type="integer" xref="A4.E11.m1.3.3.1.1.4.3.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E11.m1.3c">\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})\leq\text{dist}({\bm{z}}_{t-1}%
,\mathcal{M})-c\eta\left\|{\bm{g}}_{t}^{\perp}\right\|+\mathcal{O}(\eta^{2}).</annotation><annotation encoding="application/x-llamapun" id="A4.E11.m1.3d">dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M ) ≤ dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , caligraphic_M ) - italic_c italic_η ∥ bold_italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⟂ end_POSTSUPERSCRIPT ∥ + caligraphic_O ( italic_η start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A4.16.p16">
<p class="ltx_p" id="A4.16.p16.4">Therefore, for sufficiently small <math alttext="\eta" class="ltx_Math" display="inline" id="A4.16.p16.1.m1.1"><semantics id="A4.16.p16.1.m1.1a"><mi id="A4.16.p16.1.m1.1.1" xref="A4.16.p16.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="A4.16.p16.1.m1.1b"><ci id="A4.16.p16.1.m1.1.1.cmml" xref="A4.16.p16.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.16.p16.1.m1.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="A4.16.p16.1.m1.1d">italic_η</annotation></semantics></math>, the linear term dominates the higher-order terms, meaning that the projected update <math alttext="{\bm{z}}_{t-1}^{\prime}" class="ltx_Math" display="inline" id="A4.16.p16.2.m2.1"><semantics id="A4.16.p16.2.m2.1a"><msubsup id="A4.16.p16.2.m2.1.1" xref="A4.16.p16.2.m2.1.1.cmml"><mi id="A4.16.p16.2.m2.1.1.2.2" xref="A4.16.p16.2.m2.1.1.2.2.cmml">𝒛</mi><mrow id="A4.16.p16.2.m2.1.1.2.3" xref="A4.16.p16.2.m2.1.1.2.3.cmml"><mi id="A4.16.p16.2.m2.1.1.2.3.2" xref="A4.16.p16.2.m2.1.1.2.3.2.cmml">t</mi><mo id="A4.16.p16.2.m2.1.1.2.3.1" xref="A4.16.p16.2.m2.1.1.2.3.1.cmml">−</mo><mn id="A4.16.p16.2.m2.1.1.2.3.3" xref="A4.16.p16.2.m2.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.16.p16.2.m2.1.1.3" xref="A4.16.p16.2.m2.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A4.16.p16.2.m2.1b"><apply id="A4.16.p16.2.m2.1.1.cmml" xref="A4.16.p16.2.m2.1.1"><csymbol cd="ambiguous" id="A4.16.p16.2.m2.1.1.1.cmml" xref="A4.16.p16.2.m2.1.1">superscript</csymbol><apply id="A4.16.p16.2.m2.1.1.2.cmml" xref="A4.16.p16.2.m2.1.1"><csymbol cd="ambiguous" id="A4.16.p16.2.m2.1.1.2.1.cmml" xref="A4.16.p16.2.m2.1.1">subscript</csymbol><ci id="A4.16.p16.2.m2.1.1.2.2.cmml" xref="A4.16.p16.2.m2.1.1.2.2">𝒛</ci><apply id="A4.16.p16.2.m2.1.1.2.3.cmml" xref="A4.16.p16.2.m2.1.1.2.3"><minus id="A4.16.p16.2.m2.1.1.2.3.1.cmml" xref="A4.16.p16.2.m2.1.1.2.3.1"></minus><ci id="A4.16.p16.2.m2.1.1.2.3.2.cmml" xref="A4.16.p16.2.m2.1.1.2.3.2">𝑡</ci><cn id="A4.16.p16.2.m2.1.1.2.3.3.cmml" type="integer" xref="A4.16.p16.2.m2.1.1.2.3.3">1</cn></apply></apply><ci id="A4.16.p16.2.m2.1.1.3.cmml" xref="A4.16.p16.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.16.p16.2.m2.1c">{\bm{z}}_{t-1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A4.16.p16.2.m2.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> stays closer to the manifold <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="A4.16.p16.3.m3.1"><semantics id="A4.16.p16.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="A4.16.p16.3.m3.1.1" xref="A4.16.p16.3.m3.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="A4.16.p16.3.m3.1b"><ci id="A4.16.p16.3.m3.1.1.cmml" xref="A4.16.p16.3.m3.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.16.p16.3.m3.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="A4.16.p16.3.m3.1d">caligraphic_M</annotation></semantics></math> than the standard update <math alttext="{\bm{z}}_{t-1}" class="ltx_Math" display="inline" id="A4.16.p16.4.m4.1"><semantics id="A4.16.p16.4.m4.1a"><msub id="A4.16.p16.4.m4.1.1" xref="A4.16.p16.4.m4.1.1.cmml"><mi id="A4.16.p16.4.m4.1.1.2" xref="A4.16.p16.4.m4.1.1.2.cmml">𝒛</mi><mrow id="A4.16.p16.4.m4.1.1.3" xref="A4.16.p16.4.m4.1.1.3.cmml"><mi id="A4.16.p16.4.m4.1.1.3.2" xref="A4.16.p16.4.m4.1.1.3.2.cmml">t</mi><mo id="A4.16.p16.4.m4.1.1.3.1" xref="A4.16.p16.4.m4.1.1.3.1.cmml">−</mo><mn id="A4.16.p16.4.m4.1.1.3.3" xref="A4.16.p16.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.16.p16.4.m4.1b"><apply id="A4.16.p16.4.m4.1.1.cmml" xref="A4.16.p16.4.m4.1.1"><csymbol cd="ambiguous" id="A4.16.p16.4.m4.1.1.1.cmml" xref="A4.16.p16.4.m4.1.1">subscript</csymbol><ci id="A4.16.p16.4.m4.1.1.2.cmml" xref="A4.16.p16.4.m4.1.1.2">𝒛</ci><apply id="A4.16.p16.4.m4.1.1.3.cmml" xref="A4.16.p16.4.m4.1.1.3"><minus id="A4.16.p16.4.m4.1.1.3.1.cmml" xref="A4.16.p16.4.m4.1.1.3.1"></minus><ci id="A4.16.p16.4.m4.1.1.3.2.cmml" xref="A4.16.p16.4.m4.1.1.3.2">𝑡</ci><cn id="A4.16.p16.4.m4.1.1.3.3.cmml" type="integer" xref="A4.16.p16.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.16.p16.4.m4.1c">{\bm{z}}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="A4.16.p16.4.m4.1d">bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.Ex21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})&lt;\text{dist}({\bm{z}}_{t-1},%
\mathcal{M})." class="ltx_Math" display="block" id="A4.Ex21.m1.3"><semantics id="A4.Ex21.m1.3a"><mrow id="A4.Ex21.m1.3.3.1" xref="A4.Ex21.m1.3.3.1.1.cmml"><mrow id="A4.Ex21.m1.3.3.1.1" xref="A4.Ex21.m1.3.3.1.1.cmml"><mrow id="A4.Ex21.m1.3.3.1.1.1" xref="A4.Ex21.m1.3.3.1.1.1.cmml"><mtext id="A4.Ex21.m1.3.3.1.1.1.3" xref="A4.Ex21.m1.3.3.1.1.1.3a.cmml">dist</mtext><mo id="A4.Ex21.m1.3.3.1.1.1.2" xref="A4.Ex21.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A4.Ex21.m1.3.3.1.1.1.1.1" xref="A4.Ex21.m1.3.3.1.1.1.1.2.cmml"><mo id="A4.Ex21.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A4.Ex21.m1.3.3.1.1.1.1.2.cmml">(</mo><msubsup id="A4.Ex21.m1.3.3.1.1.1.1.1.1" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.2" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.2" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.1" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.3" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="A4.Ex21.m1.3.3.1.1.1.1.1.1.3" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="A4.Ex21.m1.3.3.1.1.1.1.1.3" xref="A4.Ex21.m1.3.3.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex21.m1.1.1" xref="A4.Ex21.m1.1.1.cmml">ℳ</mi><mo id="A4.Ex21.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="A4.Ex21.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.Ex21.m1.3.3.1.1.3" xref="A4.Ex21.m1.3.3.1.1.3.cmml">&lt;</mo><mrow id="A4.Ex21.m1.3.3.1.1.2" xref="A4.Ex21.m1.3.3.1.1.2.cmml"><mtext id="A4.Ex21.m1.3.3.1.1.2.3" xref="A4.Ex21.m1.3.3.1.1.2.3a.cmml">dist</mtext><mo id="A4.Ex21.m1.3.3.1.1.2.2" xref="A4.Ex21.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="A4.Ex21.m1.3.3.1.1.2.1.1" xref="A4.Ex21.m1.3.3.1.1.2.1.2.cmml"><mo id="A4.Ex21.m1.3.3.1.1.2.1.1.2" stretchy="false" xref="A4.Ex21.m1.3.3.1.1.2.1.2.cmml">(</mo><msub id="A4.Ex21.m1.3.3.1.1.2.1.1.1" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.cmml"><mi id="A4.Ex21.m1.3.3.1.1.2.1.1.1.2" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.2.cmml">𝒛</mi><mrow id="A4.Ex21.m1.3.3.1.1.2.1.1.1.3" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.cmml"><mi id="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.2" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.2.cmml">t</mi><mo id="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.1" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.1.cmml">−</mo><mn id="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.3" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A4.Ex21.m1.3.3.1.1.2.1.1.3" xref="A4.Ex21.m1.3.3.1.1.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A4.Ex21.m1.2.2" xref="A4.Ex21.m1.2.2.cmml">ℳ</mi><mo id="A4.Ex21.m1.3.3.1.1.2.1.1.4" stretchy="false" xref="A4.Ex21.m1.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A4.Ex21.m1.3.3.1.2" lspace="0em" xref="A4.Ex21.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.Ex21.m1.3b"><apply id="A4.Ex21.m1.3.3.1.1.cmml" xref="A4.Ex21.m1.3.3.1"><lt id="A4.Ex21.m1.3.3.1.1.3.cmml" xref="A4.Ex21.m1.3.3.1.1.3"></lt><apply id="A4.Ex21.m1.3.3.1.1.1.cmml" xref="A4.Ex21.m1.3.3.1.1.1"><times id="A4.Ex21.m1.3.3.1.1.1.2.cmml" xref="A4.Ex21.m1.3.3.1.1.1.2"></times><ci id="A4.Ex21.m1.3.3.1.1.1.3a.cmml" xref="A4.Ex21.m1.3.3.1.1.1.3"><mtext id="A4.Ex21.m1.3.3.1.1.1.3.cmml" xref="A4.Ex21.m1.3.3.1.1.1.3">dist</mtext></ci><interval closure="open" id="A4.Ex21.m1.3.3.1.1.1.1.2.cmml" xref="A4.Ex21.m1.3.3.1.1.1.1.1"><apply id="A4.Ex21.m1.3.3.1.1.1.1.1.1.cmml" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex21.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.2">𝒛</ci><apply id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3"><minus id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.1"></minus><ci id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A4.Ex21.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A4.Ex21.m1.3.3.1.1.1.1.1.1.3">′</ci></apply><ci id="A4.Ex21.m1.1.1.cmml" xref="A4.Ex21.m1.1.1">ℳ</ci></interval></apply><apply id="A4.Ex21.m1.3.3.1.1.2.cmml" xref="A4.Ex21.m1.3.3.1.1.2"><times id="A4.Ex21.m1.3.3.1.1.2.2.cmml" xref="A4.Ex21.m1.3.3.1.1.2.2"></times><ci id="A4.Ex21.m1.3.3.1.1.2.3a.cmml" xref="A4.Ex21.m1.3.3.1.1.2.3"><mtext id="A4.Ex21.m1.3.3.1.1.2.3.cmml" xref="A4.Ex21.m1.3.3.1.1.2.3">dist</mtext></ci><interval closure="open" id="A4.Ex21.m1.3.3.1.1.2.1.2.cmml" xref="A4.Ex21.m1.3.3.1.1.2.1.1"><apply id="A4.Ex21.m1.3.3.1.1.2.1.1.1.cmml" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A4.Ex21.m1.3.3.1.1.2.1.1.1.1.cmml" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1">subscript</csymbol><ci id="A4.Ex21.m1.3.3.1.1.2.1.1.1.2.cmml" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.2">𝒛</ci><apply id="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.cmml" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.3"><minus id="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.1.cmml" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.1"></minus><ci id="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.2.cmml" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.2">𝑡</ci><cn id="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.3.cmml" type="integer" xref="A4.Ex21.m1.3.3.1.1.2.1.1.1.3.3">1</cn></apply></apply><ci id="A4.Ex21.m1.2.2.cmml" xref="A4.Ex21.m1.2.2">ℳ</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.Ex21.m1.3c">\text{dist}({\bm{z}}_{t-1}^{\prime},\mathcal{M})&lt;\text{dist}({\bm{z}}_{t-1},%
\mathcal{M}).</annotation><annotation encoding="application/x-llamapun" id="A4.Ex21.m1.3d">dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M ) &lt; dist ( bold_italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , caligraphic_M ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.16.p16.5">∎</p>
</div>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 14:17:22 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
