<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models</title>
<!--Generated on Tue Oct  1 19:46:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03750v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S1" title="In SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S2" title="In SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S2.SS1" title="In 2 Methodology ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Sparsification and Quantization Stage</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S2.SS2" title="In 2 Methodology ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Fine-tuning with Neural Low-rank Adapter Search (NLS)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S2.SS3" title="In 2 Methodology ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>SparsePEFT</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S2.SS4" title="In 2 Methodology ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Quantization-aware SparsePEFT</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S2.SS5" title="In 2 Methodology ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>Model Serving and Inference Acceleration</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3" title="In SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experimental Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS1" title="In 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS1.SSS0.Px1" title="In 3.1 Setup ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title">Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS1.SSS0.Px2" title="In 3.1 Setup ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title">Datasets and Downstream Tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS1.SSS0.Px3" title="In 3.1 Setup ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title">Evaluation Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS1.SSS0.Px4" title="In 3.1 Setup ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title">Reference Configuration</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS2" title="In 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Main Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS2.SSS1" title="In 3.2 Main Results ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Fine-tuning on GSM8K</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS2.SSS2" title="In 3.2 Main Results ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Math Reasoning with Instruction Tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS2.SSS3" title="In 3.2 Main Results ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Fine-tuning on Commonsense Reasoning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS3" title="In 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Hill-climbing to Better Configurations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS4" title="In 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Exploring a Broader Range of Sparsity Levels</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS5" title="In 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Cost Analysis of Pipeline Configurations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS6" title="In 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Ablation Studies - LoRA vs NLS</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S4" title="In SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A1" title="In SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A1.SS0.SSS0.Px1" title="In Appendix A Related Work ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title">Pruning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A1.SS0.SSS0.Px2" title="In Appendix A Related Work ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title">Quantization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A1.SS0.SSS0.Px3" title="In Appendix A Related Work ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title">Parameter-efficient Fine-tuning (PEFT)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A2" title="In SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Hyperparameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A3" title="In SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Hill-climbing search algorithm</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A4" title="In SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Additional Sparsity Levels and Ablation Studies for Llama-3 on GSM8K</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A5" title="In SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>How does SQFT perform without sparsity?</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">
SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span class="ltx_text ltx_font_bold" id="id1.1.id1">J. Pablo Muñoz <sup class="ltx_sup" id="id1.1.id1.1">1</sup></span>,
<span class="ltx_text ltx_font_bold" id="id2.2.id2">Jinjie Yuan<sup class="ltx_sup" id="id2.2.id2.1">2</sup><span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex1.1.1.1">1</span></span></span></span></span></span>,
<span class="ltx_text ltx_font_bold" id="id3.3.id3">Nilesh Jain<sup class="ltx_sup" id="id3.3.id3.1">1</sup></span>
<br class="ltx_break"/><sup class="ltx_sup" id="id4.4.id4">1</sup>Intel Labs,
<sup class="ltx_sup" id="id5.5.id5">2</sup>Intel Corporation
<br class="ltx_break"/>
{pablo.munoz, jinjie.yuan, nilesh.jain}@intel.com
</span><span class="ltx_author_notes">
Co-first authors.
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id6.id1">Large pre-trained models (LPMs), such as large language models, have become ubiquitous and are employed in many applications. These models are often adapted to a desired domain or downstream task through a fine-tuning stage. This paper proposes SQFT, an end-to-end solution for low-precision sparse parameter-efficient fine-tuning of LPMs, allowing for effective model manipulation in resource-constrained environments. Additionally, an innovative strategy enables the merging of sparse weights with low-rank adapters without losing sparsity and accuracy, overcoming the limitations of previous approaches. SQFT also addresses the challenge of having quantized weights and adapters with different numerical precisions, enabling merging in the desired numerical format without sacrificing accuracy. Multiple adaptation scenarios, models, and comprehensive sparsity levels demonstrate the effectiveness of SQFT. Models and code are available at <a class="ltx_ref ltx_href" href="https://github.com/IntelLabs/Hardware-Aware-Automated-Machine-Learning" title="">https://github.com/IntelLabs/Hardware-Aware-Automated-Machine-Learning</a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.1">
<p class="ltx_p" id="p1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1.1">SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models</span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.1.2" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.1.2.1" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.1.2.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="p1.1.2.1.1.1.1">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.2.1.1.1.1.1.1">
J. Pablo Muñoz <sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.1.1">1</sup><span class="ltx_note ltx_role_thanks" id="p1.1.2.1.1.1.1.1.1.2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>
Co-first authors.
</span></span></span>,
Jinjie Yuan<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.1.3">2</sup><span class="ltx_note ltx_role_footnotemark" id="footnotex2"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex2.1.1.1">1</span></span></span></span></span>,
Nilesh Jain<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.1.4">1</sup></span></span></span>
<span class="ltx_tr" id="p1.1.2.1.1.2.2">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.2.2.1"><sup class="ltx_sup" id="p1.1.2.1.1.2.2.1.1">1</sup>Intel Labs,
<sup class="ltx_sup" id="p1.1.2.1.1.2.2.1.2">2</sup>Intel Corporation</span></span>
<span class="ltx_tr" id="p1.1.2.1.1.3.3">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.3.3.1">
{pablo.munoz, jinjie.yuan, nilesh.jain}@intel.com</span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Despite several limitations, such as hallucinations and a significant computational footprint, large pre-trained, foundation, or frontier models have become integral to numerous applications, including language understanding and code generation. These models are trained with extensive corpora on thousands of graphics processing units (GPUs), resulting in outstanding zero-shot performance across various tasks and datasets. However, it is frequently the case that they must be adapted to improve their performance on new tasks or data.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="470" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Limitations of existing approaches for fine-tuning sparse and quantized models. Full fine-tuning is expensive. Low-rank adapters (LoRA) for Parameter-efficient Fine-tuning (PEFT) on sparse or quantized models cannot easily merge with the compressed weights due to loss of previously induced sparsity or different numerical precision.
</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Low-rank adapters (LoRA) <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib13" title="">2022</a>)</cite> have demonstrated their effectiveness in model adaptation. However, when LoRA is combined with model compression techniques, e.g., sparsity or quantization, several challenges prevent merging these adapters into a single compressed and fine-tuned model, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">1</span></a>. These challenges stem from two primary reasons: <span class="ltx_text ltx_font_bold" id="S1.p2.1.1">i)</span> merging dense adapters causes the loss of sparsity in the base model, and <span class="ltx_text ltx_font_bold" id="S1.p2.1.2">ii)</span> adapter merging cannot be achieved due to different numerical precisions.</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="397" id="S1.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>SQFT Overview. Several pipeline configurations can be utilized to efficiently fine-tune large models while addressing several limitations of existing approaches.
</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">This paper introduces <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">SQFT</span>, an end-to-end compression and model adaptation solution for large pre-trained models (LPMs) that alleviates the limitations above. SQFT is designed to sparsify, quantize, and fine-tune large models and can instantiate efficient pipelines that streamline compression techniques.
Within the SQFT framework, we propose <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">Sparse</span> <span class="ltx_text ltx_font_bold" id="S1.p3.1.3">P</span>arameter-<span class="ltx_text ltx_font_bold" id="S1.p3.1.4">E</span>fficient <span class="ltx_text ltx_font_bold" id="S1.p3.1.5">F</span>ine-<span class="ltx_text ltx_font_bold" id="S1.p3.1.6">T</span>uning (<span class="ltx_text ltx_font_bold" id="S1.p3.1.7">SparsePEFT</span>), a strategy to address the adapter merging problem for sparse and quantized models, resulting in more effective high-performing models.
Furthermore, SQFT also benefits from weight-sharing techniques applied to traditional parameter-efficient fine-tuning (PEFT) techniques and incorporates insights from state-of-the-art compression techniques. Throughout this paper, we discuss the following contributions:</p>
</div>
<div class="ltx_para" id="S1.p4">
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">An end-to-end model adaptation solution, SQFT, designed for efficient low-cost configurable pipelines tailored for large pre-trained models with low numerical precision and sparsity.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">SparsePEFT, a component of SQFT, addresses several limitations in existing parameter-efficient fine-tuning approaches for sparse and quantized models, including the reduction in the cost of fine-tuning, the effective merging of adapters into the sparse model without the loss of sparsity, and the effective merging of components that operate in different numerical precision.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Extensive experiments demonstrate the effectiveness of SQFT across different foundation models, sparsity levels, and adaptation scenarios.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">This paper is organized as follows: Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S2" title="2 Methodology ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">2</span></a> describes the stages in the proposed end-to-end solution, SQFT. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3" title="3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3</span></a> discusses SQFT’s evaluation, and we finalize with some concluding remarks in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S4" title="4 Conclusion ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">4</span></a>. Due to page limits, we include a Related Work section and additional results in the Appendix.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methodology</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">SQFT fine-tunes large pre-trained models (LPMs) in an efficient multi-stage approach that includes (1) Sparsification, with an optional reduction in the numerical precision, i.e., Quantization, (2) Fine-tuning with Neural Low-rank Adapter Search (NLS), (3) Sparse Parameter-Efficient Fine-Tuning (SparsePEFT) with optional (4) Quantization-awareness. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates the alternative model compression and adaptation pipelines that were explored. In the following sections, we discuss the details of each stage and the benefits of accelerating inference and model serving.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Sparsification and Quantization Stage</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.14">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">2</span></a>, at the beginning of all possible pipeline configurations, SQFT employs an effective method to induce sparsity in the model. For a given weight matrix <math alttext="\boldsymbol{W}\in\mathbb{R}^{m\times n}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">𝑾</mi><mo id="S2.SS1.p1.1.m1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.1.m1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.3.2" xref="S2.SS1.p1.1.m1.1.1.3.3.2.cmml">m</mi><mo id="S2.SS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p1.1.m1.1.1.3.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><in id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1"></in><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝑾</ci><apply id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S2.SS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3"><times id="S2.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S2.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.2">𝑚</ci><ci id="S2.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\boldsymbol{W}\in\mathbb{R}^{m\times n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">bold_italic_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, with entries <math alttext="w_{i,j}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.2"><semantics id="S2.SS1.p1.2.m2.2a"><msub id="S2.SS1.p1.2.m2.2.3" xref="S2.SS1.p1.2.m2.2.3.cmml"><mi id="S2.SS1.p1.2.m2.2.3.2" xref="S2.SS1.p1.2.m2.2.3.2.cmml">w</mi><mrow id="S2.SS1.p1.2.m2.2.2.2.4" xref="S2.SS1.p1.2.m2.2.2.2.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S2.SS1.p1.2.m2.2.2.2.4.1" xref="S2.SS1.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p1.2.m2.2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.2b"><apply id="S2.SS1.p1.2.m2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.3.1.cmml" xref="S2.SS1.p1.2.m2.2.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.3.2.cmml" xref="S2.SS1.p1.2.m2.2.3.2">𝑤</ci><list id="S2.SS1.p1.2.m2.2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2.4"><ci id="S2.SS1.p1.2.m2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1">𝑖</ci><ci id="S2.SS1.p1.2.m2.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.2c">w_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.2d">italic_w start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> s.t. <math alttext="\boldsymbol{W}=(w_{i,j}),1\leq i\leq m,1\leq j\leq n" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.4"><semantics id="S2.SS1.p1.3.m3.4a"><mrow id="S2.SS1.p1.3.m3.4.4.2" xref="S2.SS1.p1.3.m3.4.4.3.cmml"><mrow id="S2.SS1.p1.3.m3.3.3.1.1.2" xref="S2.SS1.p1.3.m3.3.3.1.1.3.cmml"><mrow id="S2.SS1.p1.3.m3.3.3.1.1.1.1" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.cmml"><mi id="S2.SS1.p1.3.m3.3.3.1.1.1.1.3" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.3.cmml">𝑾</mi><mo id="S2.SS1.p1.3.m3.3.3.1.1.1.1.2" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.2.cmml">=</mo><mrow id="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.cmml">w</mi><mrow id="S2.SS1.p1.3.m3.2.2.2.4" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S2.SS1.p1.3.m3.2.2.2.4.1" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p1.3.m3.2.2.2.2" xref="S2.SS1.p1.3.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.3.m3.3.3.1.1.2.3" xref="S2.SS1.p1.3.m3.3.3.1.1.3a.cmml">,</mo><mrow id="S2.SS1.p1.3.m3.3.3.1.1.2.2" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.cmml"><mn id="S2.SS1.p1.3.m3.3.3.1.1.2.2.2" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.2.cmml">1</mn><mo id="S2.SS1.p1.3.m3.3.3.1.1.2.2.3" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.3.cmml">≤</mo><mi id="S2.SS1.p1.3.m3.3.3.1.1.2.2.4" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.4.cmml">i</mi><mo id="S2.SS1.p1.3.m3.3.3.1.1.2.2.5" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.5.cmml">≤</mo><mi id="S2.SS1.p1.3.m3.3.3.1.1.2.2.6" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.6.cmml">m</mi></mrow></mrow><mo id="S2.SS1.p1.3.m3.4.4.2.3" xref="S2.SS1.p1.3.m3.4.4.3a.cmml">,</mo><mrow id="S2.SS1.p1.3.m3.4.4.2.2" xref="S2.SS1.p1.3.m3.4.4.2.2.cmml"><mn id="S2.SS1.p1.3.m3.4.4.2.2.2" xref="S2.SS1.p1.3.m3.4.4.2.2.2.cmml">1</mn><mo id="S2.SS1.p1.3.m3.4.4.2.2.3" xref="S2.SS1.p1.3.m3.4.4.2.2.3.cmml">≤</mo><mi id="S2.SS1.p1.3.m3.4.4.2.2.4" xref="S2.SS1.p1.3.m3.4.4.2.2.4.cmml">j</mi><mo id="S2.SS1.p1.3.m3.4.4.2.2.5" xref="S2.SS1.p1.3.m3.4.4.2.2.5.cmml">≤</mo><mi id="S2.SS1.p1.3.m3.4.4.2.2.6" xref="S2.SS1.p1.3.m3.4.4.2.2.6.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.4b"><apply id="S2.SS1.p1.3.m3.4.4.3.cmml" xref="S2.SS1.p1.3.m3.4.4.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.4.4.3a.cmml" xref="S2.SS1.p1.3.m3.4.4.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p1.3.m3.3.3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.3.3.1.1.3a.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p1.3.m3.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1"><eq id="S2.SS1.p1.3.m3.3.3.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.2"></eq><ci id="S2.SS1.p1.3.m3.3.3.1.1.1.1.3.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.3">𝑾</ci><apply id="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.1.1.1.1.1.2">𝑤</ci><list id="S2.SS1.p1.3.m3.2.2.2.3.cmml" xref="S2.SS1.p1.3.m3.2.2.2.4"><ci id="S2.SS1.p1.3.m3.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1">𝑖</ci><ci id="S2.SS1.p1.3.m3.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S2.SS1.p1.3.m3.3.3.1.1.2.2.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2"><and id="S2.SS1.p1.3.m3.3.3.1.1.2.2a.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2"></and><apply id="S2.SS1.p1.3.m3.3.3.1.1.2.2b.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2"><leq id="S2.SS1.p1.3.m3.3.3.1.1.2.2.3.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.3"></leq><cn id="S2.SS1.p1.3.m3.3.3.1.1.2.2.2.cmml" type="integer" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.2">1</cn><ci id="S2.SS1.p1.3.m3.3.3.1.1.2.2.4.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.4">𝑖</ci></apply><apply id="S2.SS1.p1.3.m3.3.3.1.1.2.2c.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2"><leq id="S2.SS1.p1.3.m3.3.3.1.1.2.2.5.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.5"></leq><share href="https://arxiv.org/html/2410.03750v1#S2.SS1.p1.3.m3.3.3.1.1.2.2.4.cmml" id="S2.SS1.p1.3.m3.3.3.1.1.2.2d.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2"></share><ci id="S2.SS1.p1.3.m3.3.3.1.1.2.2.6.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.2.2.6">𝑚</ci></apply></apply></apply><apply id="S2.SS1.p1.3.m3.4.4.2.2.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2"><and id="S2.SS1.p1.3.m3.4.4.2.2a.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2"></and><apply id="S2.SS1.p1.3.m3.4.4.2.2b.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2"><leq id="S2.SS1.p1.3.m3.4.4.2.2.3.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2.3"></leq><cn id="S2.SS1.p1.3.m3.4.4.2.2.2.cmml" type="integer" xref="S2.SS1.p1.3.m3.4.4.2.2.2">1</cn><ci id="S2.SS1.p1.3.m3.4.4.2.2.4.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2.4">𝑗</ci></apply><apply id="S2.SS1.p1.3.m3.4.4.2.2c.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2"><leq id="S2.SS1.p1.3.m3.4.4.2.2.5.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2.5"></leq><share href="https://arxiv.org/html/2410.03750v1#S2.SS1.p1.3.m3.4.4.2.2.4.cmml" id="S2.SS1.p1.3.m3.4.4.2.2d.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2"></share><ci id="S2.SS1.p1.3.m3.4.4.2.2.6.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2.6">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.4c">\boldsymbol{W}=(w_{i,j}),1\leq i\leq m,1\leq j\leq n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.4d">bold_italic_W = ( italic_w start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ) , 1 ≤ italic_i ≤ italic_m , 1 ≤ italic_j ≤ italic_n</annotation></semantics></math>, an arbitrary scoring function, <math alttext="\Psi" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" mathvariant="normal" xref="S2.SS1.p1.4.m4.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">roman_Ψ</annotation></semantics></math>, is assigned to the proposed solution. This function determines the relative importance of <math alttext="w_{i,j}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.2"><semantics id="S2.SS1.p1.5.m5.2a"><msub id="S2.SS1.p1.5.m5.2.3" xref="S2.SS1.p1.5.m5.2.3.cmml"><mi id="S2.SS1.p1.5.m5.2.3.2" xref="S2.SS1.p1.5.m5.2.3.2.cmml">w</mi><mrow id="S2.SS1.p1.5.m5.2.2.2.4" xref="S2.SS1.p1.5.m5.2.2.2.3.cmml"><mi id="S2.SS1.p1.5.m5.1.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S2.SS1.p1.5.m5.2.2.2.4.1" xref="S2.SS1.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p1.5.m5.2.2.2.2" xref="S2.SS1.p1.5.m5.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.2b"><apply id="S2.SS1.p1.5.m5.2.3.cmml" xref="S2.SS1.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.3.1.cmml" xref="S2.SS1.p1.5.m5.2.3">subscript</csymbol><ci id="S2.SS1.p1.5.m5.2.3.2.cmml" xref="S2.SS1.p1.5.m5.2.3.2">𝑤</ci><list id="S2.SS1.p1.5.m5.2.2.2.3.cmml" xref="S2.SS1.p1.5.m5.2.2.2.4"><ci id="S2.SS1.p1.5.m5.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1">𝑖</ci><ci id="S2.SS1.p1.5.m5.2.2.2.2.cmml" xref="S2.SS1.p1.5.m5.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.2c">w_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.2d">italic_w start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> compared to the other weights in <math alttext="\boldsymbol{W}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\boldsymbol{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">bold_italic_W</annotation></semantics></math>. <math alttext="\Psi" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" mathvariant="normal" xref="S2.SS1.p1.7.m7.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">roman_Ψ</annotation></semantics></math> can be formulated in various ways. For instance, <math alttext="\Psi(\boldsymbol{W})=|\boldsymbol{W}|\cdot\|\boldsymbol{X}\|_{2}" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.3"><semantics id="S2.SS1.p1.8.m8.3a"><mrow id="S2.SS1.p1.8.m8.3.4" xref="S2.SS1.p1.8.m8.3.4.cmml"><mrow id="S2.SS1.p1.8.m8.3.4.2" xref="S2.SS1.p1.8.m8.3.4.2.cmml"><mi id="S2.SS1.p1.8.m8.3.4.2.2" mathvariant="normal" xref="S2.SS1.p1.8.m8.3.4.2.2.cmml">Ψ</mi><mo id="S2.SS1.p1.8.m8.3.4.2.1" xref="S2.SS1.p1.8.m8.3.4.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.8.m8.3.4.2.3.2" xref="S2.SS1.p1.8.m8.3.4.2.cmml"><mo id="S2.SS1.p1.8.m8.3.4.2.3.2.1" stretchy="false" xref="S2.SS1.p1.8.m8.3.4.2.cmml">(</mo><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">𝑾</mi><mo id="S2.SS1.p1.8.m8.3.4.2.3.2.2" stretchy="false" xref="S2.SS1.p1.8.m8.3.4.2.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.8.m8.3.4.1" xref="S2.SS1.p1.8.m8.3.4.1.cmml">=</mo><mrow id="S2.SS1.p1.8.m8.3.4.3" xref="S2.SS1.p1.8.m8.3.4.3.cmml"><mrow id="S2.SS1.p1.8.m8.3.4.3.2.2" xref="S2.SS1.p1.8.m8.3.4.3.2.1.cmml"><mo id="S2.SS1.p1.8.m8.3.4.3.2.2.1" stretchy="false" xref="S2.SS1.p1.8.m8.3.4.3.2.1.1.cmml">|</mo><mi id="S2.SS1.p1.8.m8.2.2" xref="S2.SS1.p1.8.m8.2.2.cmml">𝑾</mi><mo id="S2.SS1.p1.8.m8.3.4.3.2.2.2" rspace="0.055em" stretchy="false" xref="S2.SS1.p1.8.m8.3.4.3.2.1.1.cmml">|</mo></mrow><mo id="S2.SS1.p1.8.m8.3.4.3.1" rspace="0.222em" xref="S2.SS1.p1.8.m8.3.4.3.1.cmml">⋅</mo><msub id="S2.SS1.p1.8.m8.3.4.3.3" xref="S2.SS1.p1.8.m8.3.4.3.3.cmml"><mrow id="S2.SS1.p1.8.m8.3.4.3.3.2.2" xref="S2.SS1.p1.8.m8.3.4.3.3.2.1.cmml"><mo id="S2.SS1.p1.8.m8.3.4.3.3.2.2.1" stretchy="false" xref="S2.SS1.p1.8.m8.3.4.3.3.2.1.1.cmml">‖</mo><mi id="S2.SS1.p1.8.m8.3.3" xref="S2.SS1.p1.8.m8.3.3.cmml">𝑿</mi><mo id="S2.SS1.p1.8.m8.3.4.3.3.2.2.2" stretchy="false" xref="S2.SS1.p1.8.m8.3.4.3.3.2.1.1.cmml">‖</mo></mrow><mn id="S2.SS1.p1.8.m8.3.4.3.3.3" xref="S2.SS1.p1.8.m8.3.4.3.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.3b"><apply id="S2.SS1.p1.8.m8.3.4.cmml" xref="S2.SS1.p1.8.m8.3.4"><eq id="S2.SS1.p1.8.m8.3.4.1.cmml" xref="S2.SS1.p1.8.m8.3.4.1"></eq><apply id="S2.SS1.p1.8.m8.3.4.2.cmml" xref="S2.SS1.p1.8.m8.3.4.2"><times id="S2.SS1.p1.8.m8.3.4.2.1.cmml" xref="S2.SS1.p1.8.m8.3.4.2.1"></times><ci id="S2.SS1.p1.8.m8.3.4.2.2.cmml" xref="S2.SS1.p1.8.m8.3.4.2.2">Ψ</ci><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑾</ci></apply><apply id="S2.SS1.p1.8.m8.3.4.3.cmml" xref="S2.SS1.p1.8.m8.3.4.3"><ci id="S2.SS1.p1.8.m8.3.4.3.1.cmml" xref="S2.SS1.p1.8.m8.3.4.3.1">⋅</ci><apply id="S2.SS1.p1.8.m8.3.4.3.2.1.cmml" xref="S2.SS1.p1.8.m8.3.4.3.2.2"><abs id="S2.SS1.p1.8.m8.3.4.3.2.1.1.cmml" xref="S2.SS1.p1.8.m8.3.4.3.2.2.1"></abs><ci id="S2.SS1.p1.8.m8.2.2.cmml" xref="S2.SS1.p1.8.m8.2.2">𝑾</ci></apply><apply id="S2.SS1.p1.8.m8.3.4.3.3.cmml" xref="S2.SS1.p1.8.m8.3.4.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.3.4.3.3.1.cmml" xref="S2.SS1.p1.8.m8.3.4.3.3">subscript</csymbol><apply id="S2.SS1.p1.8.m8.3.4.3.3.2.1.cmml" xref="S2.SS1.p1.8.m8.3.4.3.3.2.2"><csymbol cd="latexml" id="S2.SS1.p1.8.m8.3.4.3.3.2.1.1.cmml" xref="S2.SS1.p1.8.m8.3.4.3.3.2.2.1">norm</csymbol><ci id="S2.SS1.p1.8.m8.3.3.cmml" xref="S2.SS1.p1.8.m8.3.3">𝑿</ci></apply><cn id="S2.SS1.p1.8.m8.3.4.3.3.3.cmml" type="integer" xref="S2.SS1.p1.8.m8.3.4.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.3c">\Psi(\boldsymbol{W})=|\boldsymbol{W}|\cdot\|\boldsymbol{X}\|_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.3d">roman_Ψ ( bold_italic_W ) = | bold_italic_W | ⋅ ∥ bold_italic_X ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\boldsymbol{X}" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.1"><semantics id="S2.SS1.p1.9.m9.1a"><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\boldsymbol{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">bold_italic_X</annotation></semantics></math> represents sampled feature input activations, as proposed by <cite class="ltx_cite ltx_citemacro_citet">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib24" title="">2023</a>)</cite>. However, it is important to highlight that the proposed end-to-end model fine-tuning solution, SQFT, can utilize any other scoring function. Leveraging the scores from <math alttext="\Psi" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.1"><semantics id="S2.SS1.p1.10.m10.1a"><mi id="S2.SS1.p1.10.m10.1.1" mathvariant="normal" xref="S2.SS1.p1.10.m10.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><ci id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">roman_Ψ</annotation></semantics></math> and a desired level of sparsity, <math alttext="s" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.1"><semantics id="S2.SS1.p1.11.m11.1a"><mi id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><ci id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.1d">italic_s</annotation></semantics></math>, we derive the sparsified weight, denoted as <math alttext="\boldsymbol{W}^{p}" class="ltx_Math" display="inline" id="S2.SS1.p1.12.m12.1"><semantics id="S2.SS1.p1.12.m12.1a"><msup id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml"><mi id="S2.SS1.p1.12.m12.1.1.2" xref="S2.SS1.p1.12.m12.1.1.2.cmml">𝑾</mi><mi id="S2.SS1.p1.12.m12.1.1.3" xref="S2.SS1.p1.12.m12.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><apply id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">superscript</csymbol><ci id="S2.SS1.p1.12.m12.1.1.2.cmml" xref="S2.SS1.p1.12.m12.1.1.2">𝑾</ci><ci id="S2.SS1.p1.12.m12.1.1.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">\boldsymbol{W}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m12.1d">bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>, with a sparsity pattern <math alttext="S\{\boldsymbol{W}^{p}\}=\{(i,j)\mid\boldsymbol{W}^{p}_{i,j}\not=0,1\leq i\leq m%
,1\leq j\leq n\}" class="ltx_Math" display="inline" id="S2.SS1.p1.13.m13.7"><semantics id="S2.SS1.p1.13.m13.7a"><mrow id="S2.SS1.p1.13.m13.7.7" xref="S2.SS1.p1.13.m13.7.7.cmml"><mrow id="S2.SS1.p1.13.m13.5.5.1" xref="S2.SS1.p1.13.m13.5.5.1.cmml"><mi id="S2.SS1.p1.13.m13.5.5.1.3" xref="S2.SS1.p1.13.m13.5.5.1.3.cmml">S</mi><mo id="S2.SS1.p1.13.m13.5.5.1.2" xref="S2.SS1.p1.13.m13.5.5.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.13.m13.5.5.1.1.1" xref="S2.SS1.p1.13.m13.5.5.1.1.2.cmml"><mo id="S2.SS1.p1.13.m13.5.5.1.1.1.2" stretchy="false" xref="S2.SS1.p1.13.m13.5.5.1.1.2.cmml">{</mo><msup id="S2.SS1.p1.13.m13.5.5.1.1.1.1" xref="S2.SS1.p1.13.m13.5.5.1.1.1.1.cmml"><mi id="S2.SS1.p1.13.m13.5.5.1.1.1.1.2" xref="S2.SS1.p1.13.m13.5.5.1.1.1.1.2.cmml">𝑾</mi><mi id="S2.SS1.p1.13.m13.5.5.1.1.1.1.3" xref="S2.SS1.p1.13.m13.5.5.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.SS1.p1.13.m13.5.5.1.1.1.3" stretchy="false" xref="S2.SS1.p1.13.m13.5.5.1.1.2.cmml">}</mo></mrow></mrow><mo id="S2.SS1.p1.13.m13.7.7.4" xref="S2.SS1.p1.13.m13.7.7.4.cmml">=</mo><mrow id="S2.SS1.p1.13.m13.7.7.3.2" xref="S2.SS1.p1.13.m13.7.7.3.3.cmml"><mo id="S2.SS1.p1.13.m13.7.7.3.2.3" stretchy="false" xref="S2.SS1.p1.13.m13.7.7.3.3.1.cmml">{</mo><mrow id="S2.SS1.p1.13.m13.6.6.2.1.1.2" xref="S2.SS1.p1.13.m13.6.6.2.1.1.1.cmml"><mo id="S2.SS1.p1.13.m13.6.6.2.1.1.2.1" stretchy="false" xref="S2.SS1.p1.13.m13.6.6.2.1.1.1.cmml">(</mo><mi id="S2.SS1.p1.13.m13.3.3" xref="S2.SS1.p1.13.m13.3.3.cmml">i</mi><mo id="S2.SS1.p1.13.m13.6.6.2.1.1.2.2" xref="S2.SS1.p1.13.m13.6.6.2.1.1.1.cmml">,</mo><mi id="S2.SS1.p1.13.m13.4.4" xref="S2.SS1.p1.13.m13.4.4.cmml">j</mi><mo id="S2.SS1.p1.13.m13.6.6.2.1.1.2.3" stretchy="false" xref="S2.SS1.p1.13.m13.6.6.2.1.1.1.cmml">)</mo></mrow><mo fence="true" id="S2.SS1.p1.13.m13.7.7.3.2.4" lspace="0em" rspace="0em" xref="S2.SS1.p1.13.m13.7.7.3.3.1.cmml">∣</mo><mrow id="S2.SS1.p1.13.m13.7.7.3.2.2.2" xref="S2.SS1.p1.13.m13.7.7.3.2.2.3.cmml"><mrow id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.3.cmml"><mrow id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.cmml"><msubsup id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.2.2" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.2.2.cmml">𝑾</mi><mrow id="S2.SS1.p1.13.m13.2.2.2.4" xref="S2.SS1.p1.13.m13.2.2.2.3.cmml"><mi id="S2.SS1.p1.13.m13.1.1.1.1" xref="S2.SS1.p1.13.m13.1.1.1.1.cmml">i</mi><mo id="S2.SS1.p1.13.m13.2.2.2.4.1" xref="S2.SS1.p1.13.m13.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p1.13.m13.2.2.2.2" xref="S2.SS1.p1.13.m13.2.2.2.2.cmml">j</mi></mrow><mi id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.2.3" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.2.3.cmml">p</mi></msubsup><mo id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.1" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.1.cmml">≠</mo><mn id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.3" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.3.cmml">0</mn></mrow><mo id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.3" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.3a.cmml">,</mo><mrow id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.cmml"><mn id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.2" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.2.cmml">1</mn><mo id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.3" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.3.cmml">≤</mo><mi id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.4" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.4.cmml">i</mi><mo id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.5" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.5.cmml">≤</mo><mi id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.6" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.6.cmml">m</mi></mrow></mrow><mo id="S2.SS1.p1.13.m13.7.7.3.2.2.2.3" xref="S2.SS1.p1.13.m13.7.7.3.2.2.3a.cmml">,</mo><mrow id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.cmml"><mn id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.2" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.2.cmml">1</mn><mo id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.3" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.3.cmml">≤</mo><mi id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.4" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.4.cmml">j</mi><mo id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.5" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.5.cmml">≤</mo><mi id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.6" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.6.cmml">n</mi></mrow></mrow><mo id="S2.SS1.p1.13.m13.7.7.3.2.5" stretchy="false" xref="S2.SS1.p1.13.m13.7.7.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.7b"><apply id="S2.SS1.p1.13.m13.7.7.cmml" xref="S2.SS1.p1.13.m13.7.7"><eq id="S2.SS1.p1.13.m13.7.7.4.cmml" xref="S2.SS1.p1.13.m13.7.7.4"></eq><apply id="S2.SS1.p1.13.m13.5.5.1.cmml" xref="S2.SS1.p1.13.m13.5.5.1"><times id="S2.SS1.p1.13.m13.5.5.1.2.cmml" xref="S2.SS1.p1.13.m13.5.5.1.2"></times><ci id="S2.SS1.p1.13.m13.5.5.1.3.cmml" xref="S2.SS1.p1.13.m13.5.5.1.3">𝑆</ci><set id="S2.SS1.p1.13.m13.5.5.1.1.2.cmml" xref="S2.SS1.p1.13.m13.5.5.1.1.1"><apply id="S2.SS1.p1.13.m13.5.5.1.1.1.1.cmml" xref="S2.SS1.p1.13.m13.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.5.5.1.1.1.1.1.cmml" xref="S2.SS1.p1.13.m13.5.5.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.13.m13.5.5.1.1.1.1.2.cmml" xref="S2.SS1.p1.13.m13.5.5.1.1.1.1.2">𝑾</ci><ci id="S2.SS1.p1.13.m13.5.5.1.1.1.1.3.cmml" xref="S2.SS1.p1.13.m13.5.5.1.1.1.1.3">𝑝</ci></apply></set></apply><apply id="S2.SS1.p1.13.m13.7.7.3.3.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2"><csymbol cd="latexml" id="S2.SS1.p1.13.m13.7.7.3.3.1.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.3">conditional-set</csymbol><interval closure="open" id="S2.SS1.p1.13.m13.6.6.2.1.1.1.cmml" xref="S2.SS1.p1.13.m13.6.6.2.1.1.2"><ci id="S2.SS1.p1.13.m13.3.3.cmml" xref="S2.SS1.p1.13.m13.3.3">𝑖</ci><ci id="S2.SS1.p1.13.m13.4.4.cmml" xref="S2.SS1.p1.13.m13.4.4">𝑗</ci></interval><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.3.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.7.7.3.2.2.3a.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.3.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.3a.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1"><neq id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.1"></neq><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2">subscript</csymbol><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2">superscript</csymbol><ci id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.2.2">𝑾</ci><ci id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.2.2.3">𝑝</ci></apply><list id="S2.SS1.p1.13.m13.2.2.2.3.cmml" xref="S2.SS1.p1.13.m13.2.2.2.4"><ci id="S2.SS1.p1.13.m13.1.1.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1.1.1">𝑖</ci><ci id="S2.SS1.p1.13.m13.2.2.2.2.cmml" xref="S2.SS1.p1.13.m13.2.2.2.2">𝑗</ci></list></apply><cn id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.1.1.3">0</cn></apply><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2"><and id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2a.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2"></and><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2b.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2"><leq id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.3.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.3"></leq><cn id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.2.cmml" type="integer" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.2">1</cn><ci id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.4.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.4">𝑖</ci></apply><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2c.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2"><leq id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.5.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.5"></leq><share href="https://arxiv.org/html/2410.03750v1#S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.4.cmml" id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2d.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2"></share><ci id="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.6.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.1.1.2.2.6">𝑚</ci></apply></apply></apply><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2"><and id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2a.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2"></and><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2b.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2"><leq id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.3.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.3"></leq><cn id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.2.cmml" type="integer" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.2">1</cn><ci id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.4.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.4">𝑗</ci></apply><apply id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2c.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2"><leq id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.5.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2410.03750v1#S2.SS1.p1.13.m13.7.7.3.2.2.2.2.4.cmml" id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2d.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2"></share><ci id="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.6.cmml" xref="S2.SS1.p1.13.m13.7.7.3.2.2.2.2.6">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.7c">S\{\boldsymbol{W}^{p}\}=\{(i,j)\mid\boldsymbol{W}^{p}_{i,j}\not=0,1\leq i\leq m%
,1\leq j\leq n\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.13.m13.7d">italic_S { bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT } = { ( italic_i , italic_j ) ∣ bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ≠ 0 , 1 ≤ italic_i ≤ italic_m , 1 ≤ italic_j ≤ italic_n }</annotation></semantics></math>, s.t. <math alttext="\lvert S\{\boldsymbol{W}^{p}\}\rvert\leq\lvert S\{\boldsymbol{W}\}\rvert" class="ltx_Math" display="inline" id="S2.SS1.p1.14.m14.3"><semantics id="S2.SS1.p1.14.m14.3a"><mrow id="S2.SS1.p1.14.m14.3.3" xref="S2.SS1.p1.14.m14.3.3.cmml"><mrow id="S2.SS1.p1.14.m14.2.2.1.1" xref="S2.SS1.p1.14.m14.2.2.1.2.cmml"><mo id="S2.SS1.p1.14.m14.2.2.1.1.2" stretchy="false" xref="S2.SS1.p1.14.m14.2.2.1.2.1.cmml">|</mo><mrow id="S2.SS1.p1.14.m14.2.2.1.1.1" xref="S2.SS1.p1.14.m14.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.14.m14.2.2.1.1.1.3" xref="S2.SS1.p1.14.m14.2.2.1.1.1.3.cmml">S</mi><mo id="S2.SS1.p1.14.m14.2.2.1.1.1.2" xref="S2.SS1.p1.14.m14.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.14.m14.2.2.1.1.1.1.1" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.2.cmml"><mo id="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.2.cmml">{</mo><msup id="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.2" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.2.cmml">𝑾</mi><mi id="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.3" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.3.cmml">p</mi></msup><mo id="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S2.SS1.p1.14.m14.2.2.1.1.3" stretchy="false" xref="S2.SS1.p1.14.m14.2.2.1.2.1.cmml">|</mo></mrow><mo id="S2.SS1.p1.14.m14.3.3.3" xref="S2.SS1.p1.14.m14.3.3.3.cmml">≤</mo><mrow id="S2.SS1.p1.14.m14.3.3.2.1" xref="S2.SS1.p1.14.m14.3.3.2.2.cmml"><mo id="S2.SS1.p1.14.m14.3.3.2.1.2" stretchy="false" xref="S2.SS1.p1.14.m14.3.3.2.2.1.cmml">|</mo><mrow id="S2.SS1.p1.14.m14.3.3.2.1.1" xref="S2.SS1.p1.14.m14.3.3.2.1.1.cmml"><mi id="S2.SS1.p1.14.m14.3.3.2.1.1.2" xref="S2.SS1.p1.14.m14.3.3.2.1.1.2.cmml">S</mi><mo id="S2.SS1.p1.14.m14.3.3.2.1.1.1" xref="S2.SS1.p1.14.m14.3.3.2.1.1.1.cmml">⁢</mo><mrow id="S2.SS1.p1.14.m14.3.3.2.1.1.3.2" xref="S2.SS1.p1.14.m14.3.3.2.1.1.3.1.cmml"><mo id="S2.SS1.p1.14.m14.3.3.2.1.1.3.2.1" stretchy="false" xref="S2.SS1.p1.14.m14.3.3.2.1.1.3.1.cmml">{</mo><mi id="S2.SS1.p1.14.m14.1.1" xref="S2.SS1.p1.14.m14.1.1.cmml">𝑾</mi><mo id="S2.SS1.p1.14.m14.3.3.2.1.1.3.2.2" stretchy="false" xref="S2.SS1.p1.14.m14.3.3.2.1.1.3.1.cmml">}</mo></mrow></mrow><mo id="S2.SS1.p1.14.m14.3.3.2.1.3" stretchy="false" xref="S2.SS1.p1.14.m14.3.3.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m14.3b"><apply id="S2.SS1.p1.14.m14.3.3.cmml" xref="S2.SS1.p1.14.m14.3.3"><leq id="S2.SS1.p1.14.m14.3.3.3.cmml" xref="S2.SS1.p1.14.m14.3.3.3"></leq><apply id="S2.SS1.p1.14.m14.2.2.1.2.cmml" xref="S2.SS1.p1.14.m14.2.2.1.1"><abs id="S2.SS1.p1.14.m14.2.2.1.2.1.cmml" xref="S2.SS1.p1.14.m14.2.2.1.1.2"></abs><apply id="S2.SS1.p1.14.m14.2.2.1.1.1.cmml" xref="S2.SS1.p1.14.m14.2.2.1.1.1"><times id="S2.SS1.p1.14.m14.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.14.m14.2.2.1.1.1.2"></times><ci id="S2.SS1.p1.14.m14.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.14.m14.2.2.1.1.1.3">𝑆</ci><set id="S2.SS1.p1.14.m14.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.1"><apply id="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.2">𝑾</ci><ci id="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.14.m14.2.2.1.1.1.1.1.1.3">𝑝</ci></apply></set></apply></apply><apply id="S2.SS1.p1.14.m14.3.3.2.2.cmml" xref="S2.SS1.p1.14.m14.3.3.2.1"><abs id="S2.SS1.p1.14.m14.3.3.2.2.1.cmml" xref="S2.SS1.p1.14.m14.3.3.2.1.2"></abs><apply id="S2.SS1.p1.14.m14.3.3.2.1.1.cmml" xref="S2.SS1.p1.14.m14.3.3.2.1.1"><times id="S2.SS1.p1.14.m14.3.3.2.1.1.1.cmml" xref="S2.SS1.p1.14.m14.3.3.2.1.1.1"></times><ci id="S2.SS1.p1.14.m14.3.3.2.1.1.2.cmml" xref="S2.SS1.p1.14.m14.3.3.2.1.1.2">𝑆</ci><set id="S2.SS1.p1.14.m14.3.3.2.1.1.3.1.cmml" xref="S2.SS1.p1.14.m14.3.3.2.1.1.3.2"><ci id="S2.SS1.p1.14.m14.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1">𝑾</ci></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m14.3c">\lvert S\{\boldsymbol{W}^{p}\}\rvert\leq\lvert S\{\boldsymbol{W}\}\rvert</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.14.m14.3d">| italic_S { bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT } | ≤ | italic_S { bold_italic_W } |</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.4">It has been demonstrated that LPMs can tolerate higher sparsity levels compared with the previous generations of smaller transformer-based models <cite class="ltx_cite ltx_citemacro_cite">Frantar and Alistarh (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib7" title="">2023</a>)</cite>. Our experiments confirm these observations (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3" title="3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3</span></a>).
SQFT’s evaluations use Wanda <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib24" title="">2023</a>)</cite> to measure the importance and replace the least important base model’s weights with zeros. Once sparsity has been induced in the pre-trained weights, <math alttext="\boldsymbol{W}^{p}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><msup id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">𝑾</mi><mi id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">superscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">𝑾</ci><ci id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\boldsymbol{W}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>, we might enable an optional reduction in their numerical precision. Given the sparse weights, SQFT applies layer-wise one-shot quantization
<cite class="ltx_cite ltx_citemacro_cite">Nagel et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib21" title="">2020</a>); Frantar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib8" title="">2022a</a>); Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib26" title="">2020</a>); Frantar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib9" title="">2022b</a>)</cite>.
Utilizing a selection from state-of-the-art post-training quantization approaches, SQFT identifies the low-precision sparse weights, denoted as <math alttext="\widehat{\boldsymbol{W}}^{p}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><msup id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mover accent="true" id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2.2" xref="S2.SS1.p2.2.m2.1.1.2.2.cmml">𝑾</mi><mo id="S2.SS1.p2.2.m2.1.1.2.1" xref="S2.SS1.p2.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">superscript</csymbol><apply id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2"><ci id="S2.SS1.p2.2.m2.1.1.2.1.cmml" xref="S2.SS1.p2.2.m2.1.1.2.1">^</ci><ci id="S2.SS1.p2.2.m2.1.1.2.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2.2">𝑾</ci></apply><ci id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">\widehat{\boldsymbol{W}}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">over^ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>, that given an input <math alttext="\boldsymbol{X}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">\boldsymbol{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">bold_italic_X</annotation></semantics></math>, minimize <math alttext="argmin_{\widehat{\boldsymbol{W}}^{p}}\lvert\lvert\boldsymbol{W}^{p}\boldsymbol%
{X}-\boldsymbol{\widehat{W}}^{p}\boldsymbol{X}\rvert\rvert^{2}_{2}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mrow id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">a</mi><mo id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p2.4.m4.1.1.4" xref="S2.SS1.p2.4.m4.1.1.4.cmml">r</mi><mo id="S2.SS1.p2.4.m4.1.1.2a" xref="S2.SS1.p2.4.m4.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p2.4.m4.1.1.5" xref="S2.SS1.p2.4.m4.1.1.5.cmml">g</mi><mo id="S2.SS1.p2.4.m4.1.1.2b" xref="S2.SS1.p2.4.m4.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p2.4.m4.1.1.6" xref="S2.SS1.p2.4.m4.1.1.6.cmml">m</mi><mo id="S2.SS1.p2.4.m4.1.1.2c" xref="S2.SS1.p2.4.m4.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p2.4.m4.1.1.7" xref="S2.SS1.p2.4.m4.1.1.7.cmml">i</mi><mo id="S2.SS1.p2.4.m4.1.1.2d" xref="S2.SS1.p2.4.m4.1.1.2.cmml">⁢</mo><msub id="S2.SS1.p2.4.m4.1.1.8" xref="S2.SS1.p2.4.m4.1.1.8.cmml"><mi id="S2.SS1.p2.4.m4.1.1.8.2" xref="S2.SS1.p2.4.m4.1.1.8.2.cmml">n</mi><msup id="S2.SS1.p2.4.m4.1.1.8.3" xref="S2.SS1.p2.4.m4.1.1.8.3.cmml"><mover accent="true" id="S2.SS1.p2.4.m4.1.1.8.3.2" xref="S2.SS1.p2.4.m4.1.1.8.3.2.cmml"><mi id="S2.SS1.p2.4.m4.1.1.8.3.2.2" xref="S2.SS1.p2.4.m4.1.1.8.3.2.2.cmml">𝑾</mi><mo id="S2.SS1.p2.4.m4.1.1.8.3.2.1" xref="S2.SS1.p2.4.m4.1.1.8.3.2.1.cmml">^</mo></mover><mi id="S2.SS1.p2.4.m4.1.1.8.3.3" xref="S2.SS1.p2.4.m4.1.1.8.3.3.cmml">p</mi></msup></msub><mo id="S2.SS1.p2.4.m4.1.1.2e" xref="S2.SS1.p2.4.m4.1.1.2.cmml">⁢</mo><msubsup id="S2.SS1.p2.4.m4.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.cmml"><mrow id="S2.SS1.p2.4.m4.1.1.1.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p2.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.cmml"><msup id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝑾</mi><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.cmml">p</mi></msup><mo id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.3.cmml">𝑿</mi></mrow><mo id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.cmml"><msup id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">𝑾</mi><mo class="ltx_mathvariant_bold" id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2.1" mathvariant="bold" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.3.cmml">p</mi></msup><mo id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.1" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.3" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.3.cmml">𝑿</mi></mrow></mrow><mo id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.SS1.p2.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.4.m4.1.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S2.SS1.p2.4.m4.1.1.1.3" xref="S2.SS1.p2.4.m4.1.1.1.3.cmml">2</mn><mn id="S2.SS1.p2.4.m4.1.1.1.1.3" xref="S2.SS1.p2.4.m4.1.1.1.1.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><times id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2"></times><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">𝑎</ci><ci id="S2.SS1.p2.4.m4.1.1.4.cmml" xref="S2.SS1.p2.4.m4.1.1.4">𝑟</ci><ci id="S2.SS1.p2.4.m4.1.1.5.cmml" xref="S2.SS1.p2.4.m4.1.1.5">𝑔</ci><ci id="S2.SS1.p2.4.m4.1.1.6.cmml" xref="S2.SS1.p2.4.m4.1.1.6">𝑚</ci><ci id="S2.SS1.p2.4.m4.1.1.7.cmml" xref="S2.SS1.p2.4.m4.1.1.7">𝑖</ci><apply id="S2.SS1.p2.4.m4.1.1.8.cmml" xref="S2.SS1.p2.4.m4.1.1.8"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.8.1.cmml" xref="S2.SS1.p2.4.m4.1.1.8">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.8.2.cmml" xref="S2.SS1.p2.4.m4.1.1.8.2">𝑛</ci><apply id="S2.SS1.p2.4.m4.1.1.8.3.cmml" xref="S2.SS1.p2.4.m4.1.1.8.3"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.8.3.1.cmml" xref="S2.SS1.p2.4.m4.1.1.8.3">superscript</csymbol><apply id="S2.SS1.p2.4.m4.1.1.8.3.2.cmml" xref="S2.SS1.p2.4.m4.1.1.8.3.2"><ci id="S2.SS1.p2.4.m4.1.1.8.3.2.1.cmml" xref="S2.SS1.p2.4.m4.1.1.8.3.2.1">^</ci><ci id="S2.SS1.p2.4.m4.1.1.8.3.2.2.cmml" xref="S2.SS1.p2.4.m4.1.1.8.3.2.2">𝑾</ci></apply><ci id="S2.SS1.p2.4.m4.1.1.8.3.3.cmml" xref="S2.SS1.p2.4.m4.1.1.8.3.3">𝑝</ci></apply></apply><apply id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1">subscript</csymbol><apply id="S2.SS1.p2.4.m4.1.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1">superscript</csymbol><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1"><abs id="S2.SS1.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.2"></abs><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1"><abs id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.2"></abs><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1"><minus id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2"><times id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.2">𝑾</ci><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.3">𝑝</ci></apply><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.3">𝑿</ci></apply><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3"><times id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2.1">bold-^</ci><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑾</ci></apply><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.2.3">𝑝</ci></apply><ci id="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.3">𝑿</ci></apply></apply></apply></apply><cn id="S2.SS1.p2.4.m4.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.4.m4.1.1.1.1.3">2</cn></apply><cn id="S2.SS1.p2.4.m4.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.4.m4.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">argmin_{\widehat{\boldsymbol{W}}^{p}}\lvert\lvert\boldsymbol{W}^{p}\boldsymbol%
{X}-\boldsymbol{\widehat{W}}^{p}\boldsymbol{X}\rvert\rvert^{2}_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_a italic_r italic_g italic_m italic_i italic_n start_POSTSUBSCRIPT over^ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | | bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT bold_italic_X - overbold_^ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT bold_italic_X | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.
In SQFT’s evaluation (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3" title="3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3</span></a>), we use GPTQ <cite class="ltx_cite ltx_citemacro_cite">Frantar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib8" title="">2022a</a>)</cite>, but other similar approaches can be used to obtain the quantized weights.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">Reducing the numerical precision and inducing sparsity on weights frequently decrease the model’s accuracy, requiring fine-tuning to improve performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Fine-tuning with Neural Low-rank Adapter Search (NLS)</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.5">Given the sparse quantized weights, <math alttext="\boldsymbol{\widehat{W}}^{p}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><msup id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mover accent="true" id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.2" xref="S2.SS2.p1.1.m1.1.1.2.2.cmml">𝑾</mi><mo class="ltx_mathvariant_bold" id="S2.SS2.p1.1.m1.1.1.2.1" mathvariant="bold" xref="S2.SS2.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">superscript</csymbol><apply id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2"><ci id="S2.SS2.p1.1.m1.1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.1">bold-^</ci><ci id="S2.SS2.p1.1.m1.1.1.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2">𝑾</ci></apply><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\boldsymbol{\widehat{W}}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">overbold_^ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>, SQFT recovers any drops in accuracy induced by the compression schema and fine-tunes these weights for a specific downstream task.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">2</span></a>, SQFT employs Neural Low-rank Adapter Search (NLS) <cite class="ltx_cite ltx_citemacro_cite">Munoz et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib19" title="">2024a</a>)</cite> instead of vanilla Low-rank Adapters (LoRA) <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib13" title="">2022</a>)</cite>, and fine-tunes sparse and quantized models. To justify using NLS, traditional LoRA adapters require assigning the values for several hyperparameters, including their rank <math alttext="r" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_r</annotation></semantics></math>, and the subset of modules where these adapters will be placed. Determining these hyperparameters can be a challenging endeavor. To alleviate this limitation, SQFT extends NLS’ weight-sharing techniques to facilitate the discovery of optimal adapter configurations from a space of elastic adapter configurations. In other words, instead of having a fixed value for the rank, <math alttext="r" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_r</annotation></semantics></math>, we enable elastic configurations, <math alttext="C=[c_{1},\ldots,c_{n}]" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.3"><semantics id="S2.SS2.p1.4.m4.3a"><mrow id="S2.SS2.p1.4.m4.3.3" xref="S2.SS2.p1.4.m4.3.3.cmml"><mi id="S2.SS2.p1.4.m4.3.3.4" xref="S2.SS2.p1.4.m4.3.3.4.cmml">C</mi><mo id="S2.SS2.p1.4.m4.3.3.3" xref="S2.SS2.p1.4.m4.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.4.m4.3.3.2.2" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml"><mo id="S2.SS2.p1.4.m4.3.3.2.2.3" stretchy="false" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">[</mo><msub id="S2.SS2.p1.4.m4.2.2.1.1.1" xref="S2.SS2.p1.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.4.m4.2.2.1.1.1.2" xref="S2.SS2.p1.4.m4.2.2.1.1.1.2.cmml">c</mi><mn id="S2.SS2.p1.4.m4.2.2.1.1.1.3" xref="S2.SS2.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.4.m4.3.3.2.2.4" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">,</mo><mi id="S2.SS2.p1.4.m4.1.1" mathvariant="normal" xref="S2.SS2.p1.4.m4.1.1.cmml">…</mi><mo id="S2.SS2.p1.4.m4.3.3.2.2.5" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.4.m4.3.3.2.2.2" xref="S2.SS2.p1.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.4.m4.3.3.2.2.2.2" xref="S2.SS2.p1.4.m4.3.3.2.2.2.2.cmml">c</mi><mi id="S2.SS2.p1.4.m4.3.3.2.2.2.3" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S2.SS2.p1.4.m4.3.3.2.2.6" stretchy="false" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.3b"><apply id="S2.SS2.p1.4.m4.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3"><eq id="S2.SS2.p1.4.m4.3.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3.3"></eq><ci id="S2.SS2.p1.4.m4.3.3.4.cmml" xref="S2.SS2.p1.4.m4.3.3.4">𝐶</ci><list id="S2.SS2.p1.4.m4.3.3.2.3.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2"><apply id="S2.SS2.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1.2">𝑐</ci><cn id="S2.SS2.p1.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">…</ci><apply id="S2.SS2.p1.4.m4.3.3.2.2.2.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2.2">𝑐</ci><ci id="S2.SS2.p1.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.3c">C=[c_{1},\ldots,c_{n}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.3d">italic_C = [ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math>, s.t., <math alttext="r\leftarrow c_{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><mrow id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">r</mi><mo id="S2.SS2.p1.5.m5.1.1.1" stretchy="false" xref="S2.SS2.p1.5.m5.1.1.1.cmml">←</mo><msub id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml"><mi id="S2.SS2.p1.5.m5.1.1.3.2" xref="S2.SS2.p1.5.m5.1.1.3.2.cmml">c</mi><mi id="S2.SS2.p1.5.m5.1.1.3.3" xref="S2.SS2.p1.5.m5.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><ci id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1.1">←</ci><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">𝑟</ci><apply id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.3.1.cmml" xref="S2.SS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.3.2.cmml" xref="S2.SS2.p1.5.m5.1.1.3.2">𝑐</ci><ci id="S2.SS2.p1.5.m5.1.1.3.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">r\leftarrow c_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_r ← italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> depending on the activation of the corresponding sub-adapter.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>SparsePEFT</h3>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="484" id="S2.F3.g1" src="x3.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Sparse Parameter-efficient Fine-tuning (SparsePEFT). A binary mask is obtained from the sparsified weights and applied to the adapters, allowing for the later merge without loss of sparsity.
</figcaption>
</figure>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.4">Fine-tuning the sparse quantized model with elastic adapters effectively improves the model’s performance on a downstream task. However, as illustrated in the middle and right part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">1</span></a>, a challenge arises when dealing with sparse or quantized weights and dense adapter weights: merging them will i) result in the loss of sparsity on the model’s weights or ii) be unable to merge due to different numerical precisions.
Aiming to address the first limitation, we propose an effective strategy, Sparse Parameter-Efficient Fine-Tuning (SparsePEFT), to make adapters sparsity-aware.
As depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S2.F3" title="Figure 3 ‣ 2.3 SparsePEFT ‣ 2 Methodology ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3</span></a>, SparsePEFT applies a binary mask <math alttext="\boldsymbol{M}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><mi id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">𝑴</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">𝑴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\boldsymbol{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">bold_italic_M</annotation></semantics></math> derived from the initial sparsification of <math alttext="\boldsymbol{W}" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1"><semantics id="S2.SS3.p1.2.m2.1a"><mi id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><ci id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">\boldsymbol{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">bold_italic_W</annotation></semantics></math>. This mask is used to sparsify the adapters matrix (denoted as <math alttext="\boldsymbol{BA}" class="ltx_Math" display="inline" id="S2.SS3.p1.3.m3.1"><semantics id="S2.SS3.p1.3.m3.1a"><mrow id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml"><mi id="S2.SS3.p1.3.m3.1.1.2" xref="S2.SS3.p1.3.m3.1.1.2.cmml">𝑩</mi><mo id="S2.SS3.p1.3.m3.1.1.1" xref="S2.SS3.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S2.SS3.p1.3.m3.1.1.3" xref="S2.SS3.p1.3.m3.1.1.3.cmml">𝑨</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><apply id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1"><times id="S2.SS3.p1.3.m3.1.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1.1"></times><ci id="S2.SS3.p1.3.m3.1.1.2.cmml" xref="S2.SS3.p1.3.m3.1.1.2">𝑩</ci><ci id="S2.SS3.p1.3.m3.1.1.3.cmml" xref="S2.SS3.p1.3.m3.1.1.3">𝑨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">\boldsymbol{BA}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.3.m3.1d">bold_italic_B bold_italic_A</annotation></semantics></math>) into <math alttext="\boldsymbol{L}^{p}" class="ltx_Math" display="inline" id="S2.SS3.p1.4.m4.1"><semantics id="S2.SS3.p1.4.m4.1a"><msup id="S2.SS3.p1.4.m4.1.1" xref="S2.SS3.p1.4.m4.1.1.cmml"><mi id="S2.SS3.p1.4.m4.1.1.2" xref="S2.SS3.p1.4.m4.1.1.2.cmml">𝑳</mi><mi id="S2.SS3.p1.4.m4.1.1.3" xref="S2.SS3.p1.4.m4.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.1b"><apply id="S2.SS3.p1.4.m4.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS3.p1.4.m4.1.1.2.cmml" xref="S2.SS3.p1.4.m4.1.1.2">𝑳</ci><ci id="S2.SS3.p1.4.m4.1.1.3.cmml" xref="S2.SS3.p1.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.1c">\boldsymbol{L}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.4.m4.1d">bold_italic_L start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>. The process can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{L}^{p}=(\boldsymbol{BA})\odot\boldsymbol{M}," class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><msup id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml">𝑳</mi><mi id="S2.E1.m1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.3.3.cmml">p</mi></msup><mo id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">𝑩</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml">𝑨</mi></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.1.1.1.1.1.2" rspace="0.222em" xref="S2.E1.m1.1.1.1.1.1.2.cmml">⊙</mo><mi id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml">𝑴</mi></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"></eq><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2">𝑳</ci><ci id="S2.E1.m1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.3">𝑝</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2">direct-product</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2">𝑩</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3">𝑨</ci></apply><ci id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3">𝑴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\boldsymbol{L}^{p}=(\boldsymbol{BA})\odot\boldsymbol{M},</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">bold_italic_L start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT = ( bold_italic_B bold_italic_A ) ⊙ bold_italic_M ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p1.6">which is activated during the fine-tuning process for sparsity awareness.
SparsePEFT enables the merging of the sparsified weights <math alttext="\boldsymbol{W}^{p}" class="ltx_Math" display="inline" id="S2.SS3.p1.5.m1.1"><semantics id="S2.SS3.p1.5.m1.1a"><msup id="S2.SS3.p1.5.m1.1.1" xref="S2.SS3.p1.5.m1.1.1.cmml"><mi id="S2.SS3.p1.5.m1.1.1.2" xref="S2.SS3.p1.5.m1.1.1.2.cmml">𝑾</mi><mi id="S2.SS3.p1.5.m1.1.1.3" xref="S2.SS3.p1.5.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m1.1b"><apply id="S2.SS3.p1.5.m1.1.1.cmml" xref="S2.SS3.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m1.1.1.1.cmml" xref="S2.SS3.p1.5.m1.1.1">superscript</csymbol><ci id="S2.SS3.p1.5.m1.1.1.2.cmml" xref="S2.SS3.p1.5.m1.1.1.2">𝑾</ci><ci id="S2.SS3.p1.5.m1.1.1.3.cmml" xref="S2.SS3.p1.5.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m1.1c">\boldsymbol{W}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.5.m1.1d">bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> and the adapter weight <math alttext="\boldsymbol{L}^{p}" class="ltx_Math" display="inline" id="S2.SS3.p1.6.m2.1"><semantics id="S2.SS3.p1.6.m2.1a"><msup id="S2.SS3.p1.6.m2.1.1" xref="S2.SS3.p1.6.m2.1.1.cmml"><mi id="S2.SS3.p1.6.m2.1.1.2" xref="S2.SS3.p1.6.m2.1.1.2.cmml">𝑳</mi><mi id="S2.SS3.p1.6.m2.1.1.3" xref="S2.SS3.p1.6.m2.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m2.1b"><apply id="S2.SS3.p1.6.m2.1.1.cmml" xref="S2.SS3.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.6.m2.1.1.1.cmml" xref="S2.SS3.p1.6.m2.1.1">superscript</csymbol><ci id="S2.SS3.p1.6.m2.1.1.2.cmml" xref="S2.SS3.p1.6.m2.1.1.2">𝑳</ci><ci id="S2.SS3.p1.6.m2.1.1.3.cmml" xref="S2.SS3.p1.6.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m2.1c">\boldsymbol{L}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.6.m2.1d">bold_italic_L start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> without sacrificing the sparsity induced early in the compression pipeline as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{W}^{p}\leftarrow\boldsymbol{W}^{p}+\boldsymbol{L}^{p}." class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><msup id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.2.2.cmml">𝑾</mi><mi id="S2.E2.m1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.2.3.cmml">p</mi></msup><mo id="S2.E2.m1.1.1.1.1.1" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.cmml">←</mo><mrow id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml"><msup id="S2.E2.m1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.cmml">𝑾</mi><mi id="S2.E2.m1.1.1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.1.3.2.3.cmml">p</mi></msup><mo id="S2.E2.m1.1.1.1.1.3.1" xref="S2.E2.m1.1.1.1.1.3.1.cmml">+</mo><msup id="S2.E2.m1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.1.3.3.2.cmml">𝑳</mi><mi id="S2.E2.m1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.cmml">p</mi></msup></mrow></mrow><mo id="S2.E2.m1.1.1.1.2" lspace="0em" xref="S2.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><ci id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1">←</ci><apply id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2">𝑾</ci><ci id="S2.E2.m1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3">𝑝</ci></apply><apply id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"><plus id="S2.E2.m1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.1"></plus><apply id="S2.E2.m1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2">𝑾</ci><ci id="S2.E2.m1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.3">𝑝</ci></apply><apply id="S2.E2.m1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2">𝑳</ci><ci id="S2.E2.m1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\boldsymbol{W}^{p}\leftarrow\boldsymbol{W}^{p}+\boldsymbol{L}^{p}.</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT ← bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT + bold_italic_L start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p1.7">In addition to preserving sparsity, SparsePEFT demonstrates comparable (even better) accuracy compared to fine-tuning with dense adapters. Extensive experimental findings substantiate the advantages of SparsePEFT, as detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3" title="3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">Although SparsePEFT can effectively preserve the model’s sparsity, it presents additional challenges when merging with quantized models, the second limitation we discussed before, which is primarily attributed to the need for the adapter and pre-trained weights to possess identical numerical precision.
In the following subsection, we explore a pipeline variation for SQFT that facilitates the integration of sparse quantized weights. This approach aims to address both challenges mentioned above while improving the overall efficiency of the resulting model.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Quantization-aware SparsePEFT</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.6">Building upon the concept of SparsePEFT, we propose Quantization-aware SparsePEFT (QA-SparsePEFT), an extension of SparsePEFT for sparse quantized models. QA-SparsePEFT integrates quantization awareness into SparsePEFT.
In most common quantization schemes, the zero point and scales for the target quantized tensor are determined during the quantization process.
Within the QA-SparsePEFT stage, the zeros and scales of the sparse quantized weights, <math alttext="\widehat{\boldsymbol{W}}^{p}" class="ltx_Math" display="inline" id="S2.SS4.p1.1.m1.1"><semantics id="S2.SS4.p1.1.m1.1a"><msup id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml"><mover accent="true" id="S2.SS4.p1.1.m1.1.1.2" xref="S2.SS4.p1.1.m1.1.1.2.cmml"><mi id="S2.SS4.p1.1.m1.1.1.2.2" xref="S2.SS4.p1.1.m1.1.1.2.2.cmml">𝑾</mi><mo id="S2.SS4.p1.1.m1.1.1.2.1" xref="S2.SS4.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS4.p1.1.m1.1.1.3" xref="S2.SS4.p1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><apply id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">superscript</csymbol><apply id="S2.SS4.p1.1.m1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.1.2"><ci id="S2.SS4.p1.1.m1.1.1.2.1.cmml" xref="S2.SS4.p1.1.m1.1.1.2.1">^</ci><ci id="S2.SS4.p1.1.m1.1.1.2.2.cmml" xref="S2.SS4.p1.1.m1.1.1.2.2">𝑾</ci></apply><ci id="S2.SS4.p1.1.m1.1.1.3.cmml" xref="S2.SS4.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">\widehat{\boldsymbol{W}}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.1d">over^ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>, of the based model are shared with the adapter.
The elastic adapters can then be quantized smoothly with the shared fixed zeros and scales, enabling quantization-aware fine-tuning.
Formally, given the sparsified pre-trained weight <math alttext="\boldsymbol{W}^{p}" class="ltx_Math" display="inline" id="S2.SS4.p1.2.m2.1"><semantics id="S2.SS4.p1.2.m2.1a"><msup id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml"><mi id="S2.SS4.p1.2.m2.1.1.2" xref="S2.SS4.p1.2.m2.1.1.2.cmml">𝑾</mi><mi id="S2.SS4.p1.2.m2.1.1.3" xref="S2.SS4.p1.2.m2.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><apply id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.2.m2.1.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">superscript</csymbol><ci id="S2.SS4.p1.2.m2.1.1.2.cmml" xref="S2.SS4.p1.2.m2.1.1.2">𝑾</ci><ci id="S2.SS4.p1.2.m2.1.1.3.cmml" xref="S2.SS4.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">\boldsymbol{W}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>, sparsified adapter weight <math alttext="\boldsymbol{L}^{p}" class="ltx_Math" display="inline" id="S2.SS4.p1.3.m3.1"><semantics id="S2.SS4.p1.3.m3.1a"><msup id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml"><mi id="S2.SS4.p1.3.m3.1.1.2" xref="S2.SS4.p1.3.m3.1.1.2.cmml">𝑳</mi><mi id="S2.SS4.p1.3.m3.1.1.3" xref="S2.SS4.p1.3.m3.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><apply id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.3.m3.1.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS4.p1.3.m3.1.1.2.cmml" xref="S2.SS4.p1.3.m3.1.1.2">𝑳</ci><ci id="S2.SS4.p1.3.m3.1.1.3.cmml" xref="S2.SS4.p1.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">\boldsymbol{L}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.3.m3.1d">bold_italic_L start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> obtained from SparsePEFT, zeros <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS4.p1.4.m4.1"><semantics id="S2.SS4.p1.4.m4.1a"><mi id="S2.SS4.p1.4.m4.1.1" xref="S2.SS4.p1.4.m4.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.4.m4.1b"><ci id="S2.SS4.p1.4.m4.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.4.m4.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.4.m4.1d">bold_italic_z</annotation></semantics></math> and scales <math alttext="\boldsymbol{s}" class="ltx_Math" display="inline" id="S2.SS4.p1.5.m5.1"><semantics id="S2.SS4.p1.5.m5.1a"><mi id="S2.SS4.p1.5.m5.1.1" xref="S2.SS4.p1.5.m5.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.5.m5.1b"><ci id="S2.SS4.p1.5.m5.1.1.cmml" xref="S2.SS4.p1.5.m5.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.5.m5.1c">\boldsymbol{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.5.m5.1d">bold_italic_s</annotation></semantics></math> from the quantization of <math alttext="\boldsymbol{W}^{p}" class="ltx_Math" display="inline" id="S2.SS4.p1.6.m6.1"><semantics id="S2.SS4.p1.6.m6.1a"><msup id="S2.SS4.p1.6.m6.1.1" xref="S2.SS4.p1.6.m6.1.1.cmml"><mi id="S2.SS4.p1.6.m6.1.1.2" xref="S2.SS4.p1.6.m6.1.1.2.cmml">𝑾</mi><mi id="S2.SS4.p1.6.m6.1.1.3" xref="S2.SS4.p1.6.m6.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.6.m6.1b"><apply id="S2.SS4.p1.6.m6.1.1.cmml" xref="S2.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.6.m6.1.1.1.cmml" xref="S2.SS4.p1.6.m6.1.1">superscript</csymbol><ci id="S2.SS4.p1.6.m6.1.1.2.cmml" xref="S2.SS4.p1.6.m6.1.1.2">𝑾</ci><ci id="S2.SS4.p1.6.m6.1.1.3.cmml" xref="S2.SS4.p1.6.m6.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.6.m6.1c">\boldsymbol{W}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.6.m6.1d">bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>, the quantization process in the proposed QA-SparsePEFT can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{\boldsymbol{W}}^{p}_{m}=\text{clamp}\left(\text{round}\left(\frac{%
\boldsymbol{W^{p}+L^{p}}}{\boldsymbol{s}}\right)+\boldsymbol{z},0,Q_{p}\right)," class="ltx_Math" display="block" id="S2.E3.m1.3"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><msubsup id="S2.E3.m1.3.3.1.1.4" xref="S2.E3.m1.3.3.1.1.4.cmml"><mover accent="true" id="S2.E3.m1.3.3.1.1.4.2.2" xref="S2.E3.m1.3.3.1.1.4.2.2.cmml"><mi id="S2.E3.m1.3.3.1.1.4.2.2.2" xref="S2.E3.m1.3.3.1.1.4.2.2.2.cmml">𝑾</mi><mo id="S2.E3.m1.3.3.1.1.4.2.2.1" xref="S2.E3.m1.3.3.1.1.4.2.2.1.cmml">^</mo></mover><mi id="S2.E3.m1.3.3.1.1.4.3" xref="S2.E3.m1.3.3.1.1.4.3.cmml">m</mi><mi id="S2.E3.m1.3.3.1.1.4.2.3" xref="S2.E3.m1.3.3.1.1.4.2.3.cmml">p</mi></msubsup><mo id="S2.E3.m1.3.3.1.1.3" xref="S2.E3.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml"><mtext id="S2.E3.m1.3.3.1.1.2.4" xref="S2.E3.m1.3.3.1.1.2.4a.cmml">clamp</mtext><mo id="S2.E3.m1.3.3.1.1.2.3" xref="S2.E3.m1.3.3.1.1.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml"><mo id="S2.E3.m1.3.3.1.1.2.2.2.3" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml"><mtext id="S2.E3.m1.3.3.1.1.1.1.1.1.2.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.2a.cmml">round</mtext><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.2.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S2.E3.m1.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.2.3.2.1" xref="S2.E3.m1.1.1.cmml">(</mo><mfrac id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mrow id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml"><msup id="S2.E3.m1.1.1.2.2" xref="S2.E3.m1.1.1.2.2.cmml"><mi id="S2.E3.m1.1.1.2.2.2" xref="S2.E3.m1.1.1.2.2.2.cmml">𝑾</mi><mi id="S2.E3.m1.1.1.2.2.3" xref="S2.E3.m1.1.1.2.2.3.cmml">𝒑</mi></msup><mo class="ltx_mathvariant_bold" id="S2.E3.m1.1.1.2.1" mathvariant="bold" xref="S2.E3.m1.1.1.2.1.cmml">+</mo><msup id="S2.E3.m1.1.1.2.3" xref="S2.E3.m1.1.1.2.3.cmml"><mi id="S2.E3.m1.1.1.2.3.2" xref="S2.E3.m1.1.1.2.3.2.cmml">𝑳</mi><mi id="S2.E3.m1.1.1.2.3.3" xref="S2.E3.m1.1.1.2.3.3.cmml">𝒑</mi></msup></mrow><mi id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml">𝒔</mi></mfrac><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.2.3.2.2" xref="S2.E3.m1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo id="S2.E3.m1.3.3.1.1.2.2.2.4" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml">,</mo><mn id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">0</mn><mo id="S2.E3.m1.3.3.1.1.2.2.2.5" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S2.E3.m1.3.3.1.1.2.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.2.cmml">Q</mi><mi id="S2.E3.m1.3.3.1.1.2.2.2.2.3" xref="S2.E3.m1.3.3.1.1.2.2.2.2.3.cmml">p</mi></msub><mo id="S2.E3.m1.3.3.1.1.2.2.2.6" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.2" xref="S2.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1"><eq id="S2.E3.m1.3.3.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3"></eq><apply id="S2.E3.m1.3.3.1.1.4.cmml" xref="S2.E3.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.4.1.cmml" xref="S2.E3.m1.3.3.1.1.4">subscript</csymbol><apply id="S2.E3.m1.3.3.1.1.4.2.cmml" xref="S2.E3.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.4.2.1.cmml" xref="S2.E3.m1.3.3.1.1.4">superscript</csymbol><apply id="S2.E3.m1.3.3.1.1.4.2.2.cmml" xref="S2.E3.m1.3.3.1.1.4.2.2"><ci id="S2.E3.m1.3.3.1.1.4.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.4.2.2.1">^</ci><ci id="S2.E3.m1.3.3.1.1.4.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.4.2.2.2">𝑾</ci></apply><ci id="S2.E3.m1.3.3.1.1.4.2.3.cmml" xref="S2.E3.m1.3.3.1.1.4.2.3">𝑝</ci></apply><ci id="S2.E3.m1.3.3.1.1.4.3.cmml" xref="S2.E3.m1.3.3.1.1.4.3">𝑚</ci></apply><apply id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"><times id="S2.E3.m1.3.3.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.3"></times><ci id="S2.E3.m1.3.3.1.1.2.4a.cmml" xref="S2.E3.m1.3.3.1.1.2.4"><mtext id="S2.E3.m1.3.3.1.1.2.4.cmml" xref="S2.E3.m1.3.3.1.1.2.4">clamp</mtext></ci><vector id="S2.E3.m1.3.3.1.1.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2"><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1"><plus id="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1"></plus><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2"><times id="S2.E3.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.1"></times><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.2.2a.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.2"><mtext id="S2.E3.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.2">round</mtext></ci><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.3.2"><divide id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.3.2"></divide><apply id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2"><plus id="S2.E3.m1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.2.1"></plus><apply id="S2.E3.m1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.2.1.cmml" xref="S2.E3.m1.1.1.2.2">superscript</csymbol><ci id="S2.E3.m1.1.1.2.2.2.cmml" xref="S2.E3.m1.1.1.2.2.2">𝑾</ci><ci id="S2.E3.m1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.2.2.3">𝒑</ci></apply><apply id="S2.E3.m1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.3.1.cmml" xref="S2.E3.m1.1.1.2.3">superscript</csymbol><ci id="S2.E3.m1.1.1.2.3.2.cmml" xref="S2.E3.m1.1.1.2.3.2">𝑳</ci><ci id="S2.E3.m1.1.1.2.3.3.cmml" xref="S2.E3.m1.1.1.2.3.3">𝒑</ci></apply></apply><ci id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">𝒔</ci></apply></apply><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3">𝒛</ci></apply><cn id="S2.E3.m1.2.2.cmml" type="integer" xref="S2.E3.m1.2.2">0</cn><apply id="S2.E3.m1.3.3.1.1.2.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.2">𝑄</ci><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.3">𝑝</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">\widehat{\boldsymbol{W}}^{p}_{m}=\text{clamp}\left(\text{round}\left(\frac{%
\boldsymbol{W^{p}+L^{p}}}{\boldsymbol{s}}\right)+\boldsymbol{z},0,Q_{p}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.3d">over^ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = clamp ( round ( divide start_ARG bold_italic_W start_POSTSUPERSCRIPT bold_italic_p end_POSTSUPERSCRIPT bold_+ bold_italic_L start_POSTSUPERSCRIPT bold_italic_p end_POSTSUPERSCRIPT end_ARG start_ARG bold_italic_s end_ARG ) + bold_italic_z , 0 , italic_Q start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p1.8">where <math alttext="\widehat{\boldsymbol{W}}^{p}_{m}" class="ltx_Math" display="inline" id="S2.SS4.p1.7.m1.1"><semantics id="S2.SS4.p1.7.m1.1a"><msubsup id="S2.SS4.p1.7.m1.1.1" xref="S2.SS4.p1.7.m1.1.1.cmml"><mover accent="true" id="S2.SS4.p1.7.m1.1.1.2.2" xref="S2.SS4.p1.7.m1.1.1.2.2.cmml"><mi id="S2.SS4.p1.7.m1.1.1.2.2.2" xref="S2.SS4.p1.7.m1.1.1.2.2.2.cmml">𝑾</mi><mo id="S2.SS4.p1.7.m1.1.1.2.2.1" xref="S2.SS4.p1.7.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.SS4.p1.7.m1.1.1.3" xref="S2.SS4.p1.7.m1.1.1.3.cmml">m</mi><mi id="S2.SS4.p1.7.m1.1.1.2.3" xref="S2.SS4.p1.7.m1.1.1.2.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.7.m1.1b"><apply id="S2.SS4.p1.7.m1.1.1.cmml" xref="S2.SS4.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.7.m1.1.1.1.cmml" xref="S2.SS4.p1.7.m1.1.1">subscript</csymbol><apply id="S2.SS4.p1.7.m1.1.1.2.cmml" xref="S2.SS4.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.7.m1.1.1.2.1.cmml" xref="S2.SS4.p1.7.m1.1.1">superscript</csymbol><apply id="S2.SS4.p1.7.m1.1.1.2.2.cmml" xref="S2.SS4.p1.7.m1.1.1.2.2"><ci id="S2.SS4.p1.7.m1.1.1.2.2.1.cmml" xref="S2.SS4.p1.7.m1.1.1.2.2.1">^</ci><ci id="S2.SS4.p1.7.m1.1.1.2.2.2.cmml" xref="S2.SS4.p1.7.m1.1.1.2.2.2">𝑾</ci></apply><ci id="S2.SS4.p1.7.m1.1.1.2.3.cmml" xref="S2.SS4.p1.7.m1.1.1.2.3">𝑝</ci></apply><ci id="S2.SS4.p1.7.m1.1.1.3.cmml" xref="S2.SS4.p1.7.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.7.m1.1c">\widehat{\boldsymbol{W}}^{p}_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.7.m1.1d">over^ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> denotes the sparse quantized (merged) weight and <math alttext="Q_{p}=2^{n-1}-1" class="ltx_Math" display="inline" id="S2.SS4.p1.8.m2.1"><semantics id="S2.SS4.p1.8.m2.1a"><mrow id="S2.SS4.p1.8.m2.1.1" xref="S2.SS4.p1.8.m2.1.1.cmml"><msub id="S2.SS4.p1.8.m2.1.1.2" xref="S2.SS4.p1.8.m2.1.1.2.cmml"><mi id="S2.SS4.p1.8.m2.1.1.2.2" xref="S2.SS4.p1.8.m2.1.1.2.2.cmml">Q</mi><mi id="S2.SS4.p1.8.m2.1.1.2.3" xref="S2.SS4.p1.8.m2.1.1.2.3.cmml">p</mi></msub><mo id="S2.SS4.p1.8.m2.1.1.1" xref="S2.SS4.p1.8.m2.1.1.1.cmml">=</mo><mrow id="S2.SS4.p1.8.m2.1.1.3" xref="S2.SS4.p1.8.m2.1.1.3.cmml"><msup id="S2.SS4.p1.8.m2.1.1.3.2" xref="S2.SS4.p1.8.m2.1.1.3.2.cmml"><mn id="S2.SS4.p1.8.m2.1.1.3.2.2" xref="S2.SS4.p1.8.m2.1.1.3.2.2.cmml">2</mn><mrow id="S2.SS4.p1.8.m2.1.1.3.2.3" xref="S2.SS4.p1.8.m2.1.1.3.2.3.cmml"><mi id="S2.SS4.p1.8.m2.1.1.3.2.3.2" xref="S2.SS4.p1.8.m2.1.1.3.2.3.2.cmml">n</mi><mo id="S2.SS4.p1.8.m2.1.1.3.2.3.1" xref="S2.SS4.p1.8.m2.1.1.3.2.3.1.cmml">−</mo><mn id="S2.SS4.p1.8.m2.1.1.3.2.3.3" xref="S2.SS4.p1.8.m2.1.1.3.2.3.3.cmml">1</mn></mrow></msup><mo id="S2.SS4.p1.8.m2.1.1.3.1" xref="S2.SS4.p1.8.m2.1.1.3.1.cmml">−</mo><mn id="S2.SS4.p1.8.m2.1.1.3.3" xref="S2.SS4.p1.8.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.8.m2.1b"><apply id="S2.SS4.p1.8.m2.1.1.cmml" xref="S2.SS4.p1.8.m2.1.1"><eq id="S2.SS4.p1.8.m2.1.1.1.cmml" xref="S2.SS4.p1.8.m2.1.1.1"></eq><apply id="S2.SS4.p1.8.m2.1.1.2.cmml" xref="S2.SS4.p1.8.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p1.8.m2.1.1.2.1.cmml" xref="S2.SS4.p1.8.m2.1.1.2">subscript</csymbol><ci id="S2.SS4.p1.8.m2.1.1.2.2.cmml" xref="S2.SS4.p1.8.m2.1.1.2.2">𝑄</ci><ci id="S2.SS4.p1.8.m2.1.1.2.3.cmml" xref="S2.SS4.p1.8.m2.1.1.2.3">𝑝</ci></apply><apply id="S2.SS4.p1.8.m2.1.1.3.cmml" xref="S2.SS4.p1.8.m2.1.1.3"><minus id="S2.SS4.p1.8.m2.1.1.3.1.cmml" xref="S2.SS4.p1.8.m2.1.1.3.1"></minus><apply id="S2.SS4.p1.8.m2.1.1.3.2.cmml" xref="S2.SS4.p1.8.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS4.p1.8.m2.1.1.3.2.1.cmml" xref="S2.SS4.p1.8.m2.1.1.3.2">superscript</csymbol><cn id="S2.SS4.p1.8.m2.1.1.3.2.2.cmml" type="integer" xref="S2.SS4.p1.8.m2.1.1.3.2.2">2</cn><apply id="S2.SS4.p1.8.m2.1.1.3.2.3.cmml" xref="S2.SS4.p1.8.m2.1.1.3.2.3"><minus id="S2.SS4.p1.8.m2.1.1.3.2.3.1.cmml" xref="S2.SS4.p1.8.m2.1.1.3.2.3.1"></minus><ci id="S2.SS4.p1.8.m2.1.1.3.2.3.2.cmml" xref="S2.SS4.p1.8.m2.1.1.3.2.3.2">𝑛</ci><cn id="S2.SS4.p1.8.m2.1.1.3.2.3.3.cmml" type="integer" xref="S2.SS4.p1.8.m2.1.1.3.2.3.3">1</cn></apply></apply><cn id="S2.SS4.p1.8.m2.1.1.3.3.cmml" type="integer" xref="S2.SS4.p1.8.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.8.m2.1c">Q_{p}=2^{n-1}-1</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.8.m2.1d">italic_Q start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = 2 start_POSTSUPERSCRIPT italic_n - 1 end_POSTSUPERSCRIPT - 1</annotation></semantics></math> (n represents the bit-width of the quantized values). Dequantization is the inverse as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\boldsymbol{W}}^{p}_{m}=\boldsymbol{s}\left(\widehat{\boldsymbol{W}}^{p%
}_{m}-\boldsymbol{z}\right)," class="ltx_Math" display="block" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><msubsup id="S2.E4.m1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.3.cmml"><mover accent="true" id="S2.E4.m1.1.1.1.1.3.2.2" xref="S2.E4.m1.1.1.1.1.3.2.2.cmml"><mi id="S2.E4.m1.1.1.1.1.3.2.2.2" xref="S2.E4.m1.1.1.1.1.3.2.2.2.cmml">𝑾</mi><mo id="S2.E4.m1.1.1.1.1.3.2.2.1" xref="S2.E4.m1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S2.E4.m1.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.3.3.cmml">m</mi><mi id="S2.E4.m1.1.1.1.1.3.2.3" xref="S2.E4.m1.1.1.1.1.3.2.3.cmml">p</mi></msubsup><mo id="S2.E4.m1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.3.cmml">𝒔</mi><mo id="S2.E4.m1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E4.m1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝑾</mi><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml">m</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">p</mi></msubsup><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.2"></eq><apply id="S2.E4.m1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.3">subscript</csymbol><apply id="S2.E4.m1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.3">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.3.2.2"><ci id="S2.E4.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.3.2.2.1">~</ci><ci id="S2.E4.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.3.2.2.2">𝑾</ci></apply><ci id="S2.E4.m1.1.1.1.1.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.3.2.3">𝑝</ci></apply><ci id="S2.E4.m1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.3.3">𝑚</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.2"></times><ci id="S2.E4.m1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3">𝒔</ci><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1"><minus id="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝑾</ci></apply><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.3">𝑝</ci></apply><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3">𝒛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\tilde{\boldsymbol{W}}^{p}_{m}=\boldsymbol{s}\left(\widehat{\boldsymbol{W}}^{p%
}_{m}-\boldsymbol{z}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">over~ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = bold_italic_s ( over^ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT - bold_italic_z ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p1.11">which applies <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS4.p1.9.m1.1"><semantics id="S2.SS4.p1.9.m1.1a"><mi id="S2.SS4.p1.9.m1.1.1" xref="S2.SS4.p1.9.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.9.m1.1b"><ci id="S2.SS4.p1.9.m1.1.1.cmml" xref="S2.SS4.p1.9.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.9.m1.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.9.m1.1d">bold_italic_z</annotation></semantics></math> and <math alttext="\boldsymbol{s}" class="ltx_Math" display="inline" id="S2.SS4.p1.10.m2.1"><semantics id="S2.SS4.p1.10.m2.1a"><mi id="S2.SS4.p1.10.m2.1.1" xref="S2.SS4.p1.10.m2.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.10.m2.1b"><ci id="S2.SS4.p1.10.m2.1.1.cmml" xref="S2.SS4.p1.10.m2.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.10.m2.1c">\boldsymbol{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.10.m2.1d">bold_italic_s</annotation></semantics></math> to approximate <math alttext="\boldsymbol{W}^{p}_{m}" class="ltx_Math" display="inline" id="S2.SS4.p1.11.m3.1"><semantics id="S2.SS4.p1.11.m3.1a"><msubsup id="S2.SS4.p1.11.m3.1.1" xref="S2.SS4.p1.11.m3.1.1.cmml"><mi id="S2.SS4.p1.11.m3.1.1.2.2" xref="S2.SS4.p1.11.m3.1.1.2.2.cmml">𝑾</mi><mi id="S2.SS4.p1.11.m3.1.1.3" xref="S2.SS4.p1.11.m3.1.1.3.cmml">m</mi><mi id="S2.SS4.p1.11.m3.1.1.2.3" xref="S2.SS4.p1.11.m3.1.1.2.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.11.m3.1b"><apply id="S2.SS4.p1.11.m3.1.1.cmml" xref="S2.SS4.p1.11.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.11.m3.1.1.1.cmml" xref="S2.SS4.p1.11.m3.1.1">subscript</csymbol><apply id="S2.SS4.p1.11.m3.1.1.2.cmml" xref="S2.SS4.p1.11.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.11.m3.1.1.2.1.cmml" xref="S2.SS4.p1.11.m3.1.1">superscript</csymbol><ci id="S2.SS4.p1.11.m3.1.1.2.2.cmml" xref="S2.SS4.p1.11.m3.1.1.2.2">𝑾</ci><ci id="S2.SS4.p1.11.m3.1.1.2.3.cmml" xref="S2.SS4.p1.11.m3.1.1.2.3">𝑝</ci></apply><ci id="S2.SS4.p1.11.m3.1.1.3.cmml" xref="S2.SS4.p1.11.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.11.m3.1c">\boldsymbol{W}^{p}_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.11.m3.1d">bold_italic_W start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>.
Through QA-SparsePEFT, we can obtain the fine-tuned, sparse, low-precision resulting model.
Moreover, SQFT with QA-SparsePEFT can run the NLS stage using this schema, which allows us to merge the adapters as soon as an optimal configuration has been discovered.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>Model Serving and Inference Acceleration</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.1">Accelerating model serving and inference through sparsification and quantization techniques has shown significant efficacy across various hardware platforms and kernels, demonstrating remarkable speedups. However, adding adapter modules for PEFT with a sparse or quantized model (as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">1</span></a>) introduces computational overhead during inference due to their non-mergeability.
SparsePEFT and QA-SparsePEFT allow adapters to be merged into the sparse and quantized model, which can reduce adapters’ redundancy and computational overhead, leading to more streamlined inference processes.
Moreover, quantization techniques further enhance acceleration by reducing the model size and computational complexity, but balancing the trade-off between acceleration and maintaining competitive accuracy is essential.</p>
</div>
<div class="ltx_para" id="S2.SS5.p2">
<p class="ltx_p" id="S2.SS5.p2.1">In summary, SQFT and its SparsePEFT strategy bring the benefits of adapter merging and maintaining accuracy on sparse or quantization scenarios. The choice between the sparsity level and whether to apply quantization depends on the specific deployment scenario (e.g., task requirements and resource constraints), including the trade-off between model performance, inference speed, and memory efficiency.
In the next section, we will delve into further empirical studies to fully understand the strengths and weaknesses of each approach in different settings.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experimental Results</h2>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Results from adapting <span class="ltx_text ltx_font_bold" id="S3.T1.4.1">Llama-3-8B</span> and <span class="ltx_text ltx_font_bold" id="S3.T1.5.2">Mistral-7B-v0.3</span> to GSM8K. The criterion for mergeable is that there should be no loss in either accuracy or sparsity before and after merging. The evaluation used the default configuration for <span class="ltx_text ltx_font_italic" id="S3.T1.6.3">lm-eval-harness</span> <cite class="ltx_cite ltx_citemacro_cite">Gao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib10" title="">2023</a>)</cite> (5-shot).
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.7">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.7.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T1.7.1.1.1" rowspan="2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S3.T1.7.1.1.2" rowspan="2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.2.1">Sparsity</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T1.7.1.1.3" rowspan="2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.3.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.1.4" rowspan="2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.4.1">Mergeable</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.1.5" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.5.1">Final Precision</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.1.6" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.6.1">GSM8K Test</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.2.2">
<td class="ltx_td ltx_align_center" id="S3.T1.7.2.2.1" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.2.2.1.1">(Base + Adapter / Base)</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.2.2.2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.2.2.2.1">Accuracy(%)</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.7.3.3.1" rowspan="2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.3.3.1.1">Llama-3-8B</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T1.7.3.3.2" style="padding:1pt 8.0pt;">0%</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.7.3.3.3" style="padding:1pt 8.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.3.3.4" style="padding:1pt 8.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.3.3.5" style="padding:1pt 8.0pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.3.3.6" style="padding:1pt 8.0pt;">50.0</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T1.7.4.4.1" rowspan="10" style="padding:1pt 8.0pt;"><span class="ltx_text" id="S3.T1.7.4.4.1.1">50%</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="4" id="S3.T1.7.4.4.2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T1.7.4.4.2.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.7.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.5.5.1" style="padding:1pt 8.0pt;">
<span class="ltx_ERROR undefined" id="S3.T1.7.5.5.1.1">\cdashline</span>3-6</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.5.5.2" style="padding:1pt 8.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.5.5.3" style="padding:1pt 8.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.5.5.4" style="padding:1pt 8.0pt;">FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.5.5.5" style="padding:1pt 8.0pt;">12.5</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.6.6">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.6.6.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.6.6.2" style="padding:1pt 8.0pt;">LoRA</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.6.6.3" style="padding:1pt 8.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.6.6.4" style="padding:1pt 8.0pt;">FP16 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.6.6.5" style="padding:1pt 8.0pt;">50.6</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.7.7">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.7.7.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.7.7.2" style="padding:1pt 8.0pt;">Shears</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.7.7.3" style="padding:1pt 8.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.7.7.4" style="padding:1pt 8.0pt;">FP16 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.7.7.5" style="padding:1pt 8.0pt;">52.2</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.8.8">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.8.8.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.8.8.2" style="padding:1pt 8.0pt;">SQFT + SparsePEFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.8.8.3" style="padding:1pt 8.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.8.8.4" style="padding:1pt 8.0pt;">FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.8.8.5" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.8.8.5.1">52.5</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.9.9.1" style="padding:1pt 8.0pt;">
<span class="ltx_ERROR undefined" id="S3.T1.7.9.9.1.1">\cdashline</span>3-6</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="4" id="S3.T1.7.9.9.2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T1.7.9.9.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.7.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.10.10.1" style="padding:1pt 8.0pt;">
<span class="ltx_ERROR undefined" id="S3.T1.7.10.10.1.1">\cdashline</span>3-6</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.10.10.2" style="padding:1pt 8.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.10.10.3" style="padding:1pt 8.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.10.10.4" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.10.10.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.10.10.5" style="padding:1pt 8.0pt;">7.0</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.11.11">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.11.11.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.11.11.2" style="padding:1pt 8.0pt;">GPTQ + LoRA</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.11.11.3" style="padding:1pt 8.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.11.11.4" style="padding:1pt 8.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.11.11.5" style="padding:1pt 8.0pt;">48.9</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.12.12">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.12.12.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.12.12.2" style="padding:1pt 8.0pt;">SQFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.12.12.3" style="padding:1pt 8.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.12.12.4" style="padding:1pt 8.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.12.12.5" style="padding:1pt 8.0pt;">50.0</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.13.13">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.13.13.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.13.13.2" style="padding:1pt 8.0pt;">SQFT + QA-SparsePEFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.13.13.3" style="padding:1pt 8.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.13.13.4" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.13.13.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.13.13.5" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.13.13.5.1">50.2</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.7.14.14.1" rowspan="2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.14.14.1.1">Mistral-7B-v0.3</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T1.7.14.14.2" style="padding:1pt 8.0pt;">0%</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.7.14.14.3" style="padding:1pt 8.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.14.14.4" style="padding:1pt 8.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.14.14.5" style="padding:1pt 8.0pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.14.14.6" style="padding:1pt 8.0pt;">36.0</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S3.T1.7.15.15.1" rowspan="10" style="padding:1pt 8.0pt;"><span class="ltx_text" id="S3.T1.7.15.15.1.1">50%</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="4" id="S3.T1.7.15.15.2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T1.7.15.15.2.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.7.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.16.16.1" style="padding:1pt 8.0pt;">
<span class="ltx_ERROR undefined" id="S3.T1.7.16.16.1.1">\cdashline</span>3-6</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.16.16.2" style="padding:1pt 8.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.16.16.3" style="padding:1pt 8.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.16.16.4" style="padding:1pt 8.0pt;">FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.16.16.5" style="padding:1pt 8.0pt;">17.2</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.17.17">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.17.17.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.17.17.2" style="padding:1pt 8.0pt;">LoRA</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.17.17.3" style="padding:1pt 8.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.17.17.4" style="padding:1pt 8.0pt;">FP16 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.17.17.5" style="padding:1pt 8.0pt;">44.1</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.18.18">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.18.18.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.18.18.2" style="padding:1pt 8.0pt;">Shears</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.18.18.3" style="padding:1pt 8.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.18.18.4" style="padding:1pt 8.0pt;">FP16 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.18.18.5" style="padding:1pt 8.0pt;">45.1</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.19.19">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.19.19.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.19.19.2" style="padding:1pt 8.0pt;">SQFT + SparsePEFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.19.19.3" style="padding:1pt 8.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.19.19.4" style="padding:1pt 8.0pt;">FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.19.19.5" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.19.19.5.1">50.1</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.20.20.1" style="padding:1pt 8.0pt;">
<span class="ltx_ERROR undefined" id="S3.T1.7.20.20.1.1">\cdashline</span>3-6</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="4" id="S3.T1.7.20.20.2" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T1.7.20.20.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.7.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.21.21.1" style="padding:1pt 8.0pt;">
<span class="ltx_ERROR undefined" id="S3.T1.7.21.21.1.1">\cdashline</span>3-6</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.21.21.2" style="padding:1pt 8.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.21.21.3" style="padding:1pt 8.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.21.21.4" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.21.21.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.21.21.5" style="padding:1pt 8.0pt;">16.0</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.22.22">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.22.22.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.22.22.2" style="padding:1pt 8.0pt;">GPTQ + LoRA</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.22.22.3" style="padding:1pt 8.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.22.22.4" style="padding:1pt 8.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.22.22.5" style="padding:1pt 8.0pt;">44.0</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.23.23">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.7.23.23.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.23.23.2" style="padding:1pt 8.0pt;">SQFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.23.23.3" style="padding:1pt 8.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.23.23.4" style="padding:1pt 8.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.23.23.5" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.23.23.5.1">44.5</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.24.24">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb" id="S3.T1.7.24.24.1" style="padding:1pt 8.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T1.7.24.24.2" style="padding:1pt 8.0pt;">SQFT + QA-SparsePEFT (Ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.24.24.3" style="padding:1pt 8.0pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.24.24.4" style="padding:1pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.24.24.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.24.24.5" style="padding:1pt 8.0pt;">44.0</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We evaluate SQFT on several state-of-the-art large pre-trained models and datasets. Next, we discuss the setup for our experiments.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Setup</h3>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Models</h5>
<div class="ltx_para" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.1">SQFT is evaluated on three state-of-the-art models, including
Llama-3-8B<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://huggingface.co/meta-llama/Meta-Llama-3-8B</span></span></span>, Mistral-7B-v0.3<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://huggingface.co/mistralai/Mistral-7B-v0.3</span></span></span> and Phi-3-Mini-4K-Instruct<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://huggingface.co/microsoft/Phi-3-mini-4k-instruct</span></span></span>.
To study it more comprehensively, we aim to explore SQFT across different models, scales, and settings.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Datasets and Downstream Tasks</h5>
<div class="ltx_para" id="S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.1">Aligned with other works in the LPMs compression and fine-tuning spaces, SQFT is validated on three experimental settings:
<span class="ltx_text ltx_font_bold" id="S3.SS1.SSS0.Px2.p1.1.1">1)</span> Grade School Math 8K (GSM8K) <cite class="ltx_cite ltx_citemacro_cite">Cobbe et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib4" title="">2021</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS0.Px2.p1.1.2">2)</span> Math reasoning with instruction tuning (following LLM-Adapters <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib14" title="">2023</a>)</cite>), including 3 math reasoning datasets: GSM8K,
Math Word Problems (MAWPS)
<cite class="ltx_cite ltx_citemacro_cite">Koncel-Kedziorski et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib15" title="">2016</a>)</cite>, Simple Variations on Arithmetic Math word Problems (SVAMP)
<cite class="ltx_cite ltx_citemacro_cite">Patel et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib22" title="">2021</a>)</cite>, and <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS0.Px2.p1.1.3">3)</span> Commonsense reasoning datasets: Boolean Questions (BoolQ)
<cite class="ltx_cite ltx_citemacro_cite">Clark et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib2" title="">2019</a>)</cite>, Physical Interaction: Question Answering (PIQA)
<cite class="ltx_cite ltx_citemacro_cite">Bisk et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib1" title="">2020</a>)</cite>,
HellaSwag
<cite class="ltx_cite ltx_citemacro_cite">Zellers et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib30" title="">2019</a>)</cite>, Large-scale Winograd Schema Challenge (WinoGrande)
<cite class="ltx_cite ltx_citemacro_cite">Sakaguchi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib23" title="">2021</a>)</cite>, AI2 Reasoning Challenges (Arc-e, Arc-c)
<cite class="ltx_cite ltx_citemacro_cite">Clark et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib3" title="">2018</a>)</cite>, and
Open Book Question Answering (OBQA) <cite class="ltx_cite ltx_citemacro_cite">Mihaylov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib18" title="">2018</a>)</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Evaluation Settings</h5>
<div class="ltx_para" id="S3.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px3.p1.1">The evaluations of our experiments are conducted utilizing <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS0.Px3.p1.1.1">lm-eval-harness</em> <cite class="ltx_cite ltx_citemacro_cite">Gao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib10" title="">2023</a>)</cite> in both setting 1 and 3 while following the evaluation from LLM-Adapters in setting 2. We present a comparative analysis of the results obtained from our various pipelines and also compare with vanilla LoRA <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib13" title="">2022</a>)</cite>, Shears <cite class="ltx_cite ltx_citemacro_cite">Munoz et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib19" title="">2024a</a>)</cite> (a parameter-efficient fine-tuning method for sparse models), and GPTQ + LoRA. For fair comparison, all methods are run in the same environment and with the same configuration.
SQFT employs the implementation of Wanda <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib24" title="">2023</a>)</cite> as default method for sparsification, and GPTQ in Huggingface <span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>https://huggingface.co/blog/gptq-integration</span></span></span> for quantizing the LPMs and adapters. The hyperparameters used in our experiments are detailed in the Appendix.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Reference Configuration</h5>
<div class="ltx_para" id="S3.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px4.p1.1">Unless stated in the results, we report a reference configuration for SQFT. This configuration is obtained utilizing the heuristic proposed in <cite class="ltx_cite ltx_citemacro_citet">Munoz et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib20" title="">2024b</a>)</cite>. The heuristic is intuitive and straightforward, activating the configuration with the median of each set of elastic values per module. Spending additional cycles to search the space of configurations might yield even more competitive results, presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.T4" title="Table 4 ‣ 3.2.3 Fine-tuning on Commonsense Reasoning ‣ 3.2 Main Results ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">4</span></a>. Next, we discuss experimental results and studies conducted using SQFT.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results from adapting <span class="ltx_text ltx_font_bold" id="S3.T2.4.1">Mistral-7B-v0.3</span> and <span class="ltx_text ltx_font_bold" id="S3.T2.5.2">Phi-3-Mini-4K-Instruct</span> with math instruction tuning. <em class="ltx_emph ltx_font_italic" id="S3.T2.6.3">Mergeable</em> means that merging the dense adapters with the sparse weights is possible without losing the induced sparsity levels or affecting the desired low numerical precision.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.7">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.7.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T2.7.1.1.1" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T2.7.1.1.2" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.1.1.2.1">Sparsity</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T2.7.1.1.3" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.1.1.3.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.7.1.1.4" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.1.1.4.1">Mergeable</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.7.1.1.5" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.1.1.5.1">Final Precision</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S3.T2.7.1.1.6" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.1.1.6.1">Datasets | Accuracy(%)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.7.1.1.7" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.1.1.7.1">Average</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.7.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.7.2.2.1" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.2.2.1.1">(Base + Adapter / Base)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.7.2.2.2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.2.2.2.1">GSM8K</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.7.2.2.3" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.2.2.3.1">MAWPS</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.7.2.2.4" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.2.2.4.1">SVAMP</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.7.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T2.7.3.3.1" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.3.3.1.1">Mistral-7B-v0.3</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T2.7.3.3.2" style="padding:1pt 2.0pt;">0%</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T2.7.3.3.3" style="padding:1pt 2.0pt;">w/o tune</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.7.3.3.4" style="padding:1pt 2.0pt;">-</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.7.3.3.5" style="padding:1pt 2.0pt;">FP16</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.7.3.3.6" style="padding:1pt 2.0pt;">-</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.7.3.3.7" style="padding:1pt 2.0pt;">-</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.7.3.3.8" style="padding:1pt 2.0pt;">-</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.7.3.3.9" style="padding:1pt 2.0pt;">-</th>
</tr>
<tr class="ltx_tr" id="S3.T2.7.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T2.7.4.4.1" rowspan="10" style="padding:1pt 2.0pt;"><span class="ltx_text" id="S3.T2.7.4.4.1.1">50%</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="7" id="S3.T2.7.4.4.2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T2.7.4.4.2.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.7.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.5.5.1" style="padding:1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S3.T2.7.5.5.1.1">\cdashline</span>3-9</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.5.5.2" style="padding:1pt 2.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.5.5.3" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.5.5.4" style="padding:1pt 2.0pt;">FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.5.5.5" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.5.5.6" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.5.5.7" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.5.5.8" style="padding:1pt 2.0pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.6.6">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.6.6.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.6.6.2" style="padding:1pt 2.0pt;">LoRA</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.6.6.3" style="padding:1pt 2.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.6.6.4" style="padding:1pt 2.0pt;">FP16 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.6.6.5" style="padding:1pt 2.0pt;">53.8</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.6.6.6" style="padding:1pt 2.0pt;">85.7</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.6.6.7" style="padding:1pt 2.0pt;">58.2</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.6.6.8" style="padding:1pt 2.0pt;">65.9</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.7.7">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.7.7.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.7.7.2" style="padding:1pt 2.0pt;">Shears</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.7.7.3" style="padding:1pt 2.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.7.7.4" style="padding:1pt 2.0pt;">FP16 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.7.7.5" style="padding:1pt 2.0pt;">53.0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.7.7.6" style="padding:1pt 2.0pt;">87.4</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.7.7.7" style="padding:1pt 2.0pt;">61.7</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.7.7.8" style="padding:1pt 2.0pt;">67.4</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.8.8">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.8.8.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.8.8.2" style="padding:1pt 2.0pt;">SQFT + SparsePEFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.8.8.3" style="padding:1pt 2.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.8.8.4" style="padding:1pt 2.0pt;">FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.8.8.5" style="padding:1pt 2.0pt;">55.3</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.8.8.6" style="padding:1pt 2.0pt;">87.4</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.8.8.7" style="padding:1pt 2.0pt;">59.8</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.8.8.8" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.8.8.8.1">67.5</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.9.9.1" style="padding:1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S3.T2.7.9.9.1.1">\cdashline</span>3-9</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="7" id="S3.T2.7.9.9.2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T2.7.9.9.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.7.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.10.10.1" style="padding:1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S3.T2.7.10.10.1.1">\cdashline</span>3-9</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.10.10.2" style="padding:1pt 2.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.10.10.3" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.10.10.4" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.10.10.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.10.10.5" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.10.10.6" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.10.10.7" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.10.10.8" style="padding:1pt 2.0pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.11.11">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.11.11.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.11.11.2" style="padding:1pt 2.0pt;">GPTQ + LoRA</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.11.11.3" style="padding:1pt 2.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.11.11.4" style="padding:1pt 2.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.11.11.5" style="padding:1pt 2.0pt;">51.4</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.11.11.6" style="padding:1pt 2.0pt;">87.4</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.11.11.7" style="padding:1pt 2.0pt;">60.3</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.11.11.8" style="padding:1pt 2.0pt;">66.4</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.12.12">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.12.12.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.12.12.2" style="padding:1pt 2.0pt;">SQFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.12.12.3" style="padding:1pt 2.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.12.12.4" style="padding:1pt 2.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.12.12.5" style="padding:1pt 2.0pt;">51.3</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.12.12.6" style="padding:1pt 2.0pt;">87.0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.12.12.7" style="padding:1pt 2.0pt;">62.8</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.12.12.8" style="padding:1pt 2.0pt;">67.0</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.13.13">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.13.13.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.13.13.2" style="padding:1pt 2.0pt;">SQFT + QA-SparsePEFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.13.13.3" style="padding:1pt 2.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.13.13.4" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.13.13.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.13.13.5" style="padding:1pt 2.0pt;">54.1</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.13.13.6" style="padding:1pt 2.0pt;">88.2</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.13.13.7" style="padding:1pt 2.0pt;">59.1</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.13.13.8" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.13.13.8.1">67.2</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.7.14.14.1" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.14.14.1.1">Phi-3-Mini-4K-Instruct</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T2.7.14.14.2" style="padding:1pt 2.0pt;">0%</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.7.14.14.3" style="padding:1pt 2.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.7.14.14.4" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.7.14.14.5" style="padding:1pt 2.0pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.7.14.14.6" style="padding:1pt 2.0pt;">64.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.7.14.14.7" style="padding:1pt 2.0pt;">84.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.7.14.14.8" style="padding:1pt 2.0pt;">85.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.7.14.14.9" style="padding:1pt 2.0pt;">78.2</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S3.T2.7.15.15.1" rowspan="10" style="padding:1pt 2.0pt;"><span class="ltx_text" id="S3.T2.7.15.15.1.1">50%</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="7" id="S3.T2.7.15.15.2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T2.7.15.15.2.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.7.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.16.16.1" style="padding:1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S3.T2.7.16.16.1.1">\cdashline</span>3-9</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.16.16.2" style="padding:1pt 2.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.16.16.3" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.16.16.4" style="padding:1pt 2.0pt;">FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.16.16.5" style="padding:1pt 2.0pt;">38.9</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.16.16.6" style="padding:1pt 2.0pt;">64.7</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.16.16.7" style="padding:1pt 2.0pt;">66.8</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.16.16.8" style="padding:1pt 2.0pt;">56.8</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.17.17">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.17.17.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.17.17.2" style="padding:1pt 2.0pt;">LoRA</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.17.17.3" style="padding:1pt 2.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.17.17.4" style="padding:1pt 2.0pt;">FP16 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.17.17.5" style="padding:1pt 2.0pt;">62.5</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.17.17.6" style="padding:1pt 2.0pt;">90.3</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.17.17.7" style="padding:1pt 2.0pt;">77.8</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.17.17.8" style="padding:1pt 2.0pt;">76.9</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.18.18">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.18.18.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.18.18.2" style="padding:1pt 2.0pt;">Shears</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.18.18.3" style="padding:1pt 2.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.18.18.4" style="padding:1pt 2.0pt;">FP16 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.18.18.5" style="padding:1pt 2.0pt;">62.3</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.18.18.6" style="padding:1pt 2.0pt;">90.8</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.18.18.7" style="padding:1pt 2.0pt;">76.1</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.18.18.8" style="padding:1pt 2.0pt;">76.4</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.19.19">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.19.19.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.19.19.2" style="padding:1pt 2.0pt;">SQFT + SparsePEFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.19.19.3" style="padding:1pt 2.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.19.19.4" style="padding:1pt 2.0pt;">FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.19.19.5" style="padding:1pt 2.0pt;">61.9</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.19.19.6" style="padding:1pt 2.0pt;">91.2</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.19.19.7" style="padding:1pt 2.0pt;">78.7</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.19.19.8" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.19.19.8.1">77.3</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.20.20.1" style="padding:1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S3.T2.7.20.20.1.1">\cdashline</span>3-9</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="7" id="S3.T2.7.20.20.2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_italic" id="S3.T2.7.20.20.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.7.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.21.21.1" style="padding:1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S3.T2.7.21.21.1.1">\cdashline</span>3-9</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.21.21.2" style="padding:1pt 2.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.21.21.3" style="padding:1pt 2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.21.21.4" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.21.21.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.21.21.5" style="padding:1pt 2.0pt;">33.4</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.21.21.6" style="padding:1pt 2.0pt;">56.7</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.21.21.7" style="padding:1pt 2.0pt;">64.2</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.21.21.8" style="padding:1pt 2.0pt;">51.4</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.22.22">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.22.22.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.22.22.2" style="padding:1pt 2.0pt;">GPTQ + LoRA</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.22.22.3" style="padding:1pt 2.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.22.22.4" style="padding:1pt 2.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.22.22.5" style="padding:1pt 2.0pt;">60.3</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.22.22.6" style="padding:1pt 2.0pt;">89.5</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.22.22.7" style="padding:1pt 2.0pt;">74.8</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.22.22.8" style="padding:1pt 2.0pt;">74.9</td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.23.23">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.7.23.23.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.7.23.23.2" style="padding:1pt 2.0pt;">SQFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="S3.T2.7.23.23.3" style="padding:1pt 2.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.23.23.4" style="padding:1pt 2.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.23.23.5" style="padding:1pt 2.0pt;">60.3</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.23.23.6" style="padding:1pt 2.0pt;">90.8</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.23.23.7" style="padding:1pt 2.0pt;">75.6</td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.23.23.8" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.23.23.8.1">75.5</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.7.24.24">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb" id="S3.T2.7.24.24.1" style="padding:1pt 2.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T2.7.24.24.2" style="padding:1pt 2.0pt;">SQFT + QA-SparsePEFT (Ours)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.7.24.24.3" style="padding:1pt 2.0pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.7.24.24.4" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.7.24.24.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.7.24.24.5" style="padding:1pt 2.0pt;">61.8</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.7.24.24.6" style="padding:1pt 2.0pt;">88.7</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.7.24.24.7" style="padding:1pt 2.0pt;">75.5</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.7.24.24.8" style="padding:1pt 2.0pt;">75.3</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Main Results</h3>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Fine-tuning on GSM8K</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">We begin our evaluation with Llama-3-8B and Mistral-7B-v0.3, assessing their accuracy in a dense mode and after inducing 50% sparsity without fine-tuning on the GSM8K dataset. Subsequently, we execute various pipelines of SQFT.
As described in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.T1" title="Table 1 ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">1</span></a>, for Llama-3-8B at the 50% sparsity level, SQFT recovers the model’s accuracy from 12.5% to 52.5% without employing quantization, while allowing for the merging of adapters without sacrificing sparsity (SparsePEFT) and incorporating quantization into the pipeline results in a minor drop in accuracy to 50.2% when enabling the adjustment to merge adapters (QA-SparsePEFT).</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">More importantly, SQFT with SparsePEFT and QA-SparsePEFT exhibit comparable performance to their corresponding non-mergeable approaches. This behavior is particularly evident in the non-quantized experimental setup for the Mistral-7B-v0.3 model, where SQFT + SparsePEFT (50.1%) significantly outperforms its two baselines, LoRA (44.1%) and Shears (45.1%). These results suggest that SQFT with SparsePEFT (QA-SparsePEFT) effectively addresses the limitation of the merging problem encountered when fine-tuning adapters into sparse models (or sparse and quantized models) without any degradation in accuracy.
Furthermore, the comparison between LoRA and SQFT with SparsePEFT (or Shears), and between GPTQ + LoRA and SQFT, highlights the superior performance of NLS (elastic rank) compared with LoRA (fixed rank).
We explore the performance of a broader range of sparsity levels and conduct more detailed ablation experiments in this experimental setting, which can be found in Sections <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS4" title="3.4 Exploring a Broader Range of Sparsity Levels ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3.4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS6" title="3.6 Ablation Studies - LoRA vs NLS ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3.6</span></a>, respectively. The Appendix includes ablation experiments without sparsity and only utilizing SQFT to fine-tune quantized models.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Math Reasoning with Instruction Tuning</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">In addition to fine-tuning on GSM8K, we also investigated the performance of SQFT with Mistral-v0.3 and Phi-3. Since the Phi-3-series models released by Microsoft are the best-suited instruction models for a chat prompt, we evaluate SQFT on three math reasoning datasets for instruction tuning.
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.T2" title="Table 2 ‣ Reference Configuration ‣ 3.1 Setup ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">2</span></a> presents the test accuracy for our approaches and baselines.
Interestingly, in the full-precision mode (<span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.p1.1.1">w/o Quantization</span>), our proposed SparsePEFT not only achieves the highest average accuracy (67.5% for Mistral-v0.3 and 77.3% for Phi-3) compared to other approaches but also uniquely allows for the merging of adapters and sparse weights without any loss of sparsity. This result is achieved without needing an expensive search and by utilizing the heuristic detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS1" title="3.1 Setup ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3.1</span></a>.
In the quantization mode, the accuracy of SQFT + QA-SparsePEFT (mergeable) is comparable to the non-mergeable approaches (67.2% vs. 66.4%/67.0% and 75.3% vs. 74.9%/75.5%). This result suggests a need to balance the trade-off between accuracy and efficiency. Fortunately, SQFT + QA-SparsePEFT results in a merged fine-tuned quantized model, eliminating the overhead associated with dense adapters.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Fine-tuning on Commonsense Reasoning</h4>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results from adapting <span class="ltx_text ltx_font_bold" id="S3.T3.2.1">Phi-3-Mini-4K-Instruct</span> with commonsense reasoning. SQFT obtains competitive fine-tuned models with an additional benefit over Shears and LoRA applied to low-precision weights, i.e., SQFT’s adapters can be efficiently merged into the weights without any loss of precision or accuracy. We are reporting a reference submodel for SQFT obtained the heuristic detailed in <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS1" title="3.1 Setup ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3.1</span></a>, which means that, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.T4" title="Table 4 ‣ 3.2.3 Fine-tuning on Commonsense Reasoning ‣ 3.2 Main Results ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">4</span></a>, with an additional cost, SQFT can discover submodels with even higher performance. </figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T3.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.3.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T3.3.1.1.1" rowspan="2" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T3.3.1.1.2" rowspan="2" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.1.2.1">Sparsity</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T3.3.1.1.3" rowspan="2" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.1.3.1">Method</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T3.3.1.1.4" rowspan="2" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.1.4.1">Mergeable</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T3.3.1.1.5" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.1.5.1">Final Precision</span></th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="7" id="S3.T3.3.1.1.6" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.1.6.1">Datasets | Accuracy(%)</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T3.3.1.1.7" rowspan="2" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.1.7.1">Average</span></th>
</tr>
<tr class="ltx_tr" id="S3.T3.3.2.2">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.2.2.1" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.1.1">(Base + Adapter / Base)</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.2.2.2" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.2.1">BoolQ</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.2.2.3" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.3.1">PIQA</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.2.2.4" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.4.1">HellaS</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.2.2.5" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.5.1">WinoG</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.2.2.6" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.6.1">Arc-e</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.2.2.7" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.7.1">Arc-c</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.2.2.8" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.8.1">OBQA</span></th>
</tr>
<tr class="ltx_tr" id="S3.T3.3.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T3.3.3.3.1" rowspan="2" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.3.3.1.1">Phi-3-Mini-4K-Instruct</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T3.3.3.3.2" style="padding:2.5pt 0.1pt;">0%</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T3.3.3.3.3" style="padding:2.5pt 0.1pt;">w/o tune</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.4" style="padding:2.5pt 0.1pt;">-</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.5" style="padding:2.5pt 0.1pt;">FP16</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.6" style="padding:2.5pt 0.1pt;">86.1</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.7" style="padding:2.5pt 0.1pt;">80.3</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.8" style="padding:2.5pt 0.1pt;">78.5</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.9" style="padding:2.5pt 0.1pt;">73.7</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.10" style="padding:2.5pt 0.1pt;">83.2</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.11" style="padding:2.5pt 0.1pt;">57.5</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.12" style="padding:2.5pt 0.1pt;">46.8</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.13" style="padding:2.5pt 0.1pt;">72.3</th>
</tr>
<tr class="ltx_tr" id="S3.T3.3.4.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S3.T3.3.4.4.1" rowspan="10" style="padding:2.5pt 0.1pt;"><span class="ltx_text" id="S3.T3.3.4.4.1.1">50%</span></th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="11" id="S3.T3.3.4.4.2" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_italic" id="S3.T3.3.4.4.2.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="S3.T3.3.5.5">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.5.5.1" style="padding:2.5pt 0.1pt;">
<span class="ltx_ERROR undefined" id="S3.T3.3.5.5.1.1">\cdashline</span>3-13</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.5.5.2" style="padding:2.5pt 0.1pt;">w/o tune</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.5.5.3" style="padding:2.5pt 0.1pt;">-</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.5.5.4" style="padding:2.5pt 0.1pt;">FP16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.5.5.5" style="padding:2.5pt 0.1pt;">82.5</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.5.5.6" style="padding:2.5pt 0.1pt;">75.9</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.5.5.7" style="padding:2.5pt 0.1pt;">69.9</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.5.5.8" style="padding:2.5pt 0.1pt;">69.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.5.5.9" style="padding:2.5pt 0.1pt;">76.9</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.5.5.10" style="padding:2.5pt 0.1pt;">50.9</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.5.5.11" style="padding:2.5pt 0.1pt;">43.4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.5.5.12" style="padding:2.5pt 0.1pt;">66.9</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.6.6">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="S3.T3.3.6.6.1" style="padding:2.5pt 0.1pt;"></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.6.6.2" style="padding:2.5pt 0.1pt;">LoRA</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.6.6.3" style="padding:2.5pt 0.1pt;">✗</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.6.6.4" style="padding:2.5pt 0.1pt;">FP16 + FP16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.6.6.5" style="padding:2.5pt 0.1pt;">85.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.6.6.6" style="padding:2.5pt 0.1pt;">79.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.6.6.7" style="padding:2.5pt 0.1pt;">75.8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.6.6.8" style="padding:2.5pt 0.1pt;">71.5</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.6.6.9" style="padding:2.5pt 0.1pt;">79.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.6.6.10" style="padding:2.5pt 0.1pt;">53.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.6.6.11" style="padding:2.5pt 0.1pt;">49.4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.6.6.12" style="padding:2.5pt 0.1pt;">70.6</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.7.7">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="S3.T3.3.7.7.1" style="padding:2.5pt 0.1pt;"></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.7.7.2" style="padding:2.5pt 0.1pt;">Shears</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.7.7.3" style="padding:2.5pt 0.1pt;">✗</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.7.7.4" style="padding:2.5pt 0.1pt;">FP16 + FP16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.7.7.5" style="padding:2.5pt 0.1pt;">85.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.7.7.6" style="padding:2.5pt 0.1pt;">78.9</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.7.7.7" style="padding:2.5pt 0.1pt;">75.7</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.7.7.8" style="padding:2.5pt 0.1pt;">72.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.7.7.9" style="padding:2.5pt 0.1pt;">80.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.7.7.10" style="padding:2.5pt 0.1pt;">53.3</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.7.7.11" style="padding:2.5pt 0.1pt;">50.4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.7.7.12" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.7.7.12.1">70.9</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.8.8">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="S3.T3.3.8.8.1" style="padding:2.5pt 0.1pt;"></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.8.8.2" style="padding:2.5pt 0.1pt;">SQFT + SparsePEFT (Ours)</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.8.8.3" style="padding:2.5pt 0.1pt;">✓</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.8.8.4" style="padding:2.5pt 0.1pt;">FP16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.8.8.5" style="padding:2.5pt 0.1pt;">84.0</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.8.8.6" style="padding:2.5pt 0.1pt;">78.8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.8.8.7" style="padding:2.5pt 0.1pt;">75.5</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.8.8.8" style="padding:2.5pt 0.1pt;">72.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.8.8.9" style="padding:2.5pt 0.1pt;">80.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.8.8.10" style="padding:2.5pt 0.1pt;">53.5</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.8.8.11" style="padding:2.5pt 0.1pt;">48.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.8.8.12" style="padding:2.5pt 0.1pt;">70.4</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.9.9">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.9.9.1" style="padding:2.5pt 0.1pt;">
<span class="ltx_ERROR undefined" id="S3.T3.3.9.9.1.1">\cdashline</span>3-13</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" colspan="11" id="S3.T3.3.9.9.2" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_italic" id="S3.T3.3.9.9.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="S3.T3.3.10.10">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.10.10.1" style="padding:2.5pt 0.1pt;">
<span class="ltx_ERROR undefined" id="S3.T3.3.10.10.1.1">\cdashline</span>3-13</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.10.10.2" style="padding:2.5pt 0.1pt;">w/o tune</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.10.10.3" style="padding:2.5pt 0.1pt;">-</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.10.10.4" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.10.10.4.1">INT4</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.10.10.5" style="padding:2.5pt 0.1pt;">81.4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.10.10.6" style="padding:2.5pt 0.1pt;">75.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.10.10.7" style="padding:2.5pt 0.1pt;">68.5</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.10.10.8" style="padding:2.5pt 0.1pt;">68.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.10.10.9" style="padding:2.5pt 0.1pt;">75.9</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.10.10.10" style="padding:2.5pt 0.1pt;">50.3</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.10.10.11" style="padding:2.5pt 0.1pt;">40.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.10.10.12" style="padding:2.5pt 0.1pt;">65.7</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.11.11">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="S3.T3.3.11.11.1" style="padding:2.5pt 0.1pt;"></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.11.11.2" style="padding:2.5pt 0.1pt;">GPTQ + LoRA</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.11.11.3" style="padding:2.5pt 0.1pt;">✗</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.11.11.4" style="padding:2.5pt 0.1pt;">INT4 + FP16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.11.11.5" style="padding:2.5pt 0.1pt;">85.3</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.11.11.6" style="padding:2.5pt 0.1pt;">79.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.11.11.7" style="padding:2.5pt 0.1pt;">75.3</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.11.11.8" style="padding:2.5pt 0.1pt;">72.5</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.11.11.9" style="padding:2.5pt 0.1pt;">79.5</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.11.11.10" style="padding:2.5pt 0.1pt;">54.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.11.11.11" style="padding:2.5pt 0.1pt;">47.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.11.11.12" style="padding:2.5pt 0.1pt;">70.5</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.12.12">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="S3.T3.3.12.12.1" style="padding:2.5pt 0.1pt;"></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.12.12.2" style="padding:2.5pt 0.1pt;">SQFT (Ours)</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.12.12.3" style="padding:2.5pt 0.1pt;">✗</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.12.12.4" style="padding:2.5pt 0.1pt;">INT4 + FP16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.12.12.5" style="padding:2.5pt 0.1pt;">85.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.12.12.6" style="padding:2.5pt 0.1pt;">79.0</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.12.12.7" style="padding:2.5pt 0.1pt;">75.4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.12.12.8" style="padding:2.5pt 0.1pt;">71.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.12.12.9" style="padding:2.5pt 0.1pt;">79.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.12.12.10" style="padding:2.5pt 0.1pt;">54.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.12.12.11" style="padding:2.5pt 0.1pt;">48.8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.T3.3.12.12.12" style="padding:2.5pt 0.1pt;">70.5</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.13.13">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row ltx_border_bb" id="S3.T3.3.13.13.1" style="padding:2.5pt 0.1pt;"></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T3.3.13.13.2" style="padding:2.5pt 0.1pt;">SQFT + QA-SparsePEFT (Ours)</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T3.3.13.13.3" style="padding:2.5pt 0.1pt;">✓</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T3.3.13.13.4" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.13.13.4.1">INT4</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T3.3.13.13.5" style="padding:2.5pt 0.1pt;">83.7</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T3.3.13.13.6" style="padding:2.5pt 0.1pt;">80.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T3.3.13.13.7" style="padding:2.5pt 0.1pt;">74.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T3.3.13.13.8" style="padding:2.5pt 0.1pt;">73.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T3.3.13.13.9" style="padding:2.5pt 0.1pt;">80.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T3.3.13.13.10" style="padding:2.5pt 0.1pt;">55.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T3.3.13.13.11" style="padding:2.5pt 0.1pt;">48.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T3.3.13.13.12" style="padding:2.5pt 0.1pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.13.13.12.1">70.7</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span> Hill-climbing searching results for <span class="ltx_text ltx_font_bold" id="S3.T4.2.1">Phi-3-Mini-4K-Instruct</span> with the commonsense reasoning dataset.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T4.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T4.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S3.T4.3.1.1.1" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T4.3.1.1.2" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.1.1.2.1">Sparsity</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S3.T4.3.1.1.3" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.1.1.3.1">Method</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S3.T4.3.1.1.4" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.1.1.4.1">Sub-Adapter</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S3.T4.3.1.1.5" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.1.1.5.1">Validation Datasets | Accuracy(%)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="8" id="S3.T4.3.1.1.6" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.1.1.6.1">Test Datasets | Accuracy(%)</span></th>
</tr>
<tr class="ltx_tr" id="S3.T4.3.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.1" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.1.1">Arc-e</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.2.1">Arc-c</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.3" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.3.1">OBQA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.4" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.4.1">Average</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.5" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.5.1">BoolQ</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.6" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.6.1">PIQA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.7" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.7.1">HellaS</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.8" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.8.1">WinoG</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.9" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.9.1">Arc-e</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.10" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.10.1">Arc-c</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.11" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.11.1">OBQA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.3.2.2.12" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.12.1">Average</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.3.3.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.3.3.1.1" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.3.1.1.1">Phi-3-Mini-4K-Instruct</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T4.3.3.1.2" rowspan="4" style="padding:1pt 2.0pt;"><span class="ltx_text" id="S3.T4.3.3.1.2.1">50%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.3.3.1.3" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text" id="S3.T4.3.3.1.3.1">SQFT + SparsePEFT</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.3.3.1.4" style="padding:1pt 2.0pt;">Heuristic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.5" style="padding:1pt 2.0pt;">79.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.6" style="padding:1pt 2.0pt;">50.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.7" style="padding:1pt 2.0pt;">47.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.8" style="padding:1pt 2.0pt;">59.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.9" style="padding:1pt 2.0pt;">84.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.10" style="padding:1pt 2.0pt;">78.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.11" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.3.1.11.1">75.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.12" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.3.1.12.1">72.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.13" style="padding:1pt 2.0pt;">80.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.14" style="padding:1pt 2.0pt;">53.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.15" style="padding:1pt 2.0pt;">48.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.1.16" style="padding:1pt 2.0pt;">70.4</td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.4.2">
<td class="ltx_td ltx_align_left" id="S3.T4.3.4.2.1" style="padding:1pt 2.0pt;">Hill-climbing</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.2" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.4.2.2.1">80.2</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.3" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.4.2.3.1">51.8</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.4" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.4.2.4.1">47.6</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.5" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.4.2.5.1">59.9</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.6" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.4.2.6.1">84.3</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.7" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.4.2.7.1">78.9</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.8" style="padding:1pt 2.0pt;">75.4</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.9" style="padding:1pt 2.0pt;">72.0</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.10" style="padding:1pt 2.0pt;">80.1</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.11" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.4.2.11.1">54.3</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.12" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.4.2.12.1">49.4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.4.2.13" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.4.2.13.1">70.6</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.5.3">
<td class="ltx_td ltx_align_left" id="S3.T4.3.5.3.1" style="padding:1pt 2.0pt;">
<span class="ltx_ERROR undefined" id="S3.T4.3.5.3.1.1">\cdashline</span>3-16</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T4.3.5.3.2" rowspan="2" style="padding:1pt 2.0pt;"><span class="ltx_text" id="S3.T4.3.5.3.2.1">SQFT + QA-SparsePEFT</span></td>
<td class="ltx_td ltx_align_left" id="S3.T4.3.5.3.3" style="padding:1pt 2.0pt;">Heuristic</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.4" style="padding:1pt 2.0pt;">80.0</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.5" style="padding:1pt 2.0pt;">51.5</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.6" style="padding:1pt 2.0pt;">45.4</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.7" style="padding:1pt 2.0pt;">59.0</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.8" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.3.8.1">83.7</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.9" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.3.9.1">80.1</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.10" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.3.10.1">74.1</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.11" style="padding:1pt 2.0pt;">73.6</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.12" style="padding:1pt 2.0pt;">80.1</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.13" style="padding:1pt 2.0pt;">55.1</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.14" style="padding:1pt 2.0pt;">48.2</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.3.15" style="padding:1pt 2.0pt;">70.7</td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.6.4">
<td class="ltx_td ltx_border_bb" id="S3.T4.3.6.4.1" style="padding:1pt 2.0pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T4.3.6.4.2" style="padding:1pt 2.0pt;">Hill-climbing</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.3" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.3.1">80.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.4" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.4.1">53.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.5" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.5.1">46.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.6" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.6.1">60.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.7" style="padding:1pt 2.0pt;">83.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.8" style="padding:1pt 2.0pt;">79.7</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.9" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.9.1">74.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.10" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.10.1">73.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.11" style="padding:1pt 2.0pt;">80.1</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.12" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.12.1">56.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.13" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.13.1">48.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.6.4.14" style="padding:1pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.14.1">70.9</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.1">Besides the mathematical domain of the first two experimental settings, we also explore SQFT in other areas, e.g., commonsense reasoning.
We apply SQFT to fine-tuning the Phi-3 model on a set of unified commonsense training datasets with 83K samples for fine-tuning from BoolQ, PIQA, HellaSwag, WinoGrande, Arc-e, Arc-c, and OBQA. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.T3" title="Table 3 ‣ 3.2.3 Fine-tuning on Commonsense Reasoning ‣ 3.2 Main Results ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3</span></a> compares the test accuracy of the evaluated approaches. SQFT obtains a competitive configuration with Shears, LoRA, and GPTQ + LoRA. However, SQFT has the additional benefit of allowing for the merging without losing the previously induced sparsity, both in full-precision and quantized modes.
It is worth noting that SQFT with QA-SparsePEFT shows super competitiveness here, i.e., the most efficient model with high accuracy (among all full-precision and quantized cases).</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="261" id="S3.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The adapter rank distribution of the optimal configurations obtained from the hill-climbing search algorithm (<span class="ltx_text ltx_font_bold" id="S3.F4.2.1">Phi-3-Mini-4K-Instruct</span> with commonsense reasoning).
</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Hill-climbing to Better Configurations</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The results presented in the previous sections employ the simple heuristic (as detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS1" title="3.1 Setup ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3.1</span></a>) to obtain a reference configuration from the NLS search space. However, superior configurations can be discovered with an additional budget. We apply a well-designed hill-climbing search algorithm (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#alg1" title="Algorithm 1 ‣ Parameter-efficient Fine-tuning (PEFT) ‣ Appendix A Related Work ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">1</span></a> in Appendix), which starts from the configuration derived from the heuristic and explores its neighboring configurations in a hill-climbing matter based on their validation accuracy.
For this purpose, we employed the validation sets from Arc-e, Arc-c, and OBQA, as other datasets do not provide a validation set.
As demonstrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.T4" title="Table 4 ‣ 3.2.3 Fine-tuning on Commonsense Reasoning ‣ 3.2 Main Results ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">4</span></a>, a more optimal configuration can be discovered, outperforming the default adapter configuration obtained from the heuristic. Exploring further the search space of elastic adapter ranks produces richer adapter distributions as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.F4" title="Figure 4 ‣ 3.2.3 Fine-tuning on Commonsense Reasoning ‣ 3.2 Main Results ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">4</span></a>.
More importantly, the test set results reveal a significant improvement in the performance of the Arc-c and OBQA datasets, which suggests that an appropriate validation set can assist in identifying the optimal adapter configuration.</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="415" id="S3.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Comparison of various sparsity levels for <span class="ltx_text ltx_font_bold" id="S3.F5.2.1">Llama-3-8B</span> with GSM8K. SQFT achieves similar performance as Shears but with the added benefit of merging adapters with different numerical precision.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Exploring a Broader Range of Sparsity Levels</h3>
<figure class="ltx_table" id="S3.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Ablation studies for LoRA vs. NLS (<span class="ltx_text ltx_font_bold" id="S3.T5.14.1">Llama-3-8B</span> with GSM8K). Compared to LoRA, NLS obtains significantly better accuracy across all possible pipelines of SQFT and different sparsity levels.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T5.12">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T5.12.13.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T5.12.13.1.1" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.13.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T5.12.13.1.2" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.13.1.2.1">Sparsity</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T5.12.13.1.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.13.1.3.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.12.13.1.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.13.1.4.1">Mergeable</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.12.13.1.5" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.13.1.5.1">Final Precision</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.12.13.1.6" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.13.1.6.1">Fine-tune</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.12.13.1.7" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.13.1.7.1">GSM8K Test</span></th>
</tr>
<tr class="ltx_tr" id="S3.T5.12.14.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.12.14.2.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.14.2.1.1">(Base + Adapter / Base)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.12.14.2.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.14.2.2.1">Approach</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.12.14.2.3" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.14.2.3.1">Accuracy(%)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.12.15.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T5.12.15.1.1" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.15.1.1.1">Llama-3-8B</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.12.15.1.2" rowspan="8" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.15.1.2.1">30%</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T5.12.15.1.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.15.1.3.1">Shears</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.15.1.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.15.1.4.1">✗</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.15.1.5" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.15.1.5.1">FP16 + FP16</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.15.1.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.15.1.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">58.2</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1">
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1">59.8<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.6}}}" class="ltx_Math" display="inline" id="S3.T5.1.1.1.1.m1.1"><semantics id="S3.T5.1.1.1.1.m1.1a"><msub id="S3.T5.1.1.1.1.m1.1.1" xref="S3.T5.1.1.1.1.m1.1.1.cmml"><mi id="S3.T5.1.1.1.1.m1.1.1a" xref="S3.T5.1.1.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.1.1.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.1.1.1.1.m1.1.1.1a.cmml">+1.6</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.1.1.1.1.m1.1b"><apply id="S3.T5.1.1.1.1.m1.1.1.cmml" xref="S3.T5.1.1.1.1.m1.1.1"><ci id="S3.T5.1.1.1.1.m1.1.1.1a.cmml" xref="S3.T5.1.1.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.1.1.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.1.1.1.1.m1.1.1.1">+1.6</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.1.1.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.6}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.1.1.1.1.m1.1d">start_FLOATSUBSCRIPT +1.6 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.16.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.16.2.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span class="ltx_ERROR undefined" id="S3.T5.12.16.2.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.16.2.2" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.16.2.2.1">SQFT + SparsePEFT (Ours)</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.12.16.2.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.16.2.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.16.2.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.16.2.4.1">FP16</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.16.2.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.16.2.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">60.0</td>
</tr>
<tr class="ltx_tr" id="S3.T5.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.2.2.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center" id="S3.T5.2.2.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.2.2.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.2.2.1.1">61.2<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.2}}}" class="ltx_Math" display="inline" id="S3.T5.2.2.1.1.m1.1"><semantics id="S3.T5.2.2.1.1.m1.1a"><msub id="S3.T5.2.2.1.1.m1.1.1" xref="S3.T5.2.2.1.1.m1.1.1.cmml"><mi id="S3.T5.2.2.1.1.m1.1.1a" xref="S3.T5.2.2.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.2.2.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.2.2.1.1.m1.1.1.1a.cmml">+1.2</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.2.2.1.1.m1.1b"><apply id="S3.T5.2.2.1.1.m1.1.1.cmml" xref="S3.T5.2.2.1.1.m1.1.1"><ci id="S3.T5.2.2.1.1.m1.1.1.1a.cmml" xref="S3.T5.2.2.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.2.2.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.2.2.1.1.m1.1.1.1">+1.2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.2.2.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.2}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.2.2.1.1.m1.1d">start_FLOATSUBSCRIPT +1.2 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.17.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.17.3.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span class="ltx_ERROR undefined" id="S3.T5.12.17.3.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.17.3.2" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.17.3.2.1">SQFT (Ours)</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.12.17.3.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.17.3.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.17.3.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.17.3.4.1">INT4 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.17.3.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.17.3.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">56.7</td>
</tr>
<tr class="ltx_tr" id="S3.T5.3.3">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.3.3.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center" id="S3.T5.3.3.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.3.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.3.3.1.1">57.6<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.9}}}" class="ltx_Math" display="inline" id="S3.T5.3.3.1.1.m1.1"><semantics id="S3.T5.3.3.1.1.m1.1a"><msub id="S3.T5.3.3.1.1.m1.1.1" xref="S3.T5.3.3.1.1.m1.1.1.cmml"><mi id="S3.T5.3.3.1.1.m1.1.1a" xref="S3.T5.3.3.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.3.3.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.3.3.1.1.m1.1.1.1a.cmml">+0.9</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.3.3.1.1.m1.1b"><apply id="S3.T5.3.3.1.1.m1.1.1.cmml" xref="S3.T5.3.3.1.1.m1.1.1"><ci id="S3.T5.3.3.1.1.m1.1.1.1a.cmml" xref="S3.T5.3.3.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.3.3.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.3.3.1.1.m1.1.1.1">+0.9</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.3.3.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.9}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.3.3.1.1.m1.1d">start_FLOATSUBSCRIPT +0.9 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.18.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.18.4.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span class="ltx_ERROR undefined" id="S3.T5.12.18.4.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.18.4.2" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.18.4.2.1">SQFT + QA-SparsePEFT (Ours)</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.12.18.4.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.18.4.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.18.4.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.18.4.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.18.4.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.18.4.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">54.8</td>
</tr>
<tr class="ltx_tr" id="S3.T5.4.4">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.4.4.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center" id="S3.T5.4.4.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.4.4.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.4.4.1.1">56.0<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.2}}}" class="ltx_Math" display="inline" id="S3.T5.4.4.1.1.m1.1"><semantics id="S3.T5.4.4.1.1.m1.1a"><msub id="S3.T5.4.4.1.1.m1.1.1" xref="S3.T5.4.4.1.1.m1.1.1.cmml"><mi id="S3.T5.4.4.1.1.m1.1.1a" xref="S3.T5.4.4.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.4.4.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.4.4.1.1.m1.1.1.1a.cmml">+1.2</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.4.4.1.1.m1.1b"><apply id="S3.T5.4.4.1.1.m1.1.1.cmml" xref="S3.T5.4.4.1.1.m1.1.1"><ci id="S3.T5.4.4.1.1.m1.1.1.1a.cmml" xref="S3.T5.4.4.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.4.4.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.4.4.1.1.m1.1.1.1">+1.2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.4.4.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.2}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.4.4.1.1.m1.1d">start_FLOATSUBSCRIPT +1.2 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.19.5">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.12.19.5.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.12.19.5.2" rowspan="8" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.19.5.2.1">50%</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T5.12.19.5.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.19.5.3.1">Shears</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.19.5.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.19.5.4.1">✗</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.19.5.5" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.19.5.5.1">FP16 + FP16</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.19.5.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.19.5.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">50.6</td>
</tr>
<tr class="ltx_tr" id="S3.T5.5.5">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.5.5.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center" id="S3.T5.5.5.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.5.5.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.5.5.1.1">52.2<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.6}}}" class="ltx_Math" display="inline" id="S3.T5.5.5.1.1.m1.1"><semantics id="S3.T5.5.5.1.1.m1.1a"><msub id="S3.T5.5.5.1.1.m1.1.1" xref="S3.T5.5.5.1.1.m1.1.1.cmml"><mi id="S3.T5.5.5.1.1.m1.1.1a" xref="S3.T5.5.5.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.5.5.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.5.5.1.1.m1.1.1.1a.cmml">+1.6</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.5.5.1.1.m1.1b"><apply id="S3.T5.5.5.1.1.m1.1.1.cmml" xref="S3.T5.5.5.1.1.m1.1.1"><ci id="S3.T5.5.5.1.1.m1.1.1.1a.cmml" xref="S3.T5.5.5.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.5.5.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.5.5.1.1.m1.1.1.1">+1.6</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.5.5.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.6}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.5.5.1.1.m1.1d">start_FLOATSUBSCRIPT +1.6 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.20.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.20.6.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span class="ltx_ERROR undefined" id="S3.T5.12.20.6.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.20.6.2" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.20.6.2.1">SQFT + SparsePEFT (Ours)</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.12.20.6.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.20.6.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.20.6.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.20.6.4.1">FP16</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.20.6.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.20.6.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">50.6</td>
</tr>
<tr class="ltx_tr" id="S3.T5.6.6">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.6.6.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center" id="S3.T5.6.6.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.6.6.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.6.6.1.1">52.5<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.9}}}" class="ltx_Math" display="inline" id="S3.T5.6.6.1.1.m1.1"><semantics id="S3.T5.6.6.1.1.m1.1a"><msub id="S3.T5.6.6.1.1.m1.1.1" xref="S3.T5.6.6.1.1.m1.1.1.cmml"><mi id="S3.T5.6.6.1.1.m1.1.1a" xref="S3.T5.6.6.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.6.6.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.6.6.1.1.m1.1.1.1a.cmml">+1.9</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.6.6.1.1.m1.1b"><apply id="S3.T5.6.6.1.1.m1.1.1.cmml" xref="S3.T5.6.6.1.1.m1.1.1"><ci id="S3.T5.6.6.1.1.m1.1.1.1a.cmml" xref="S3.T5.6.6.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.6.6.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.6.6.1.1.m1.1.1.1">+1.9</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.6.6.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.9}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.6.6.1.1.m1.1d">start_FLOATSUBSCRIPT +1.9 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.21.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.21.7.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span class="ltx_ERROR undefined" id="S3.T5.12.21.7.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.21.7.2" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.21.7.2.1">SQFT (Ours)</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.12.21.7.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.21.7.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.21.7.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.21.7.4.1">INT4 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.21.7.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.21.7.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">48.9</td>
</tr>
<tr class="ltx_tr" id="S3.T5.7.7">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.7.7.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center" id="S3.T5.7.7.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.7.7.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.7.7.1.1">50.0<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.1}}}" class="ltx_Math" display="inline" id="S3.T5.7.7.1.1.m1.1"><semantics id="S3.T5.7.7.1.1.m1.1a"><msub id="S3.T5.7.7.1.1.m1.1.1" xref="S3.T5.7.7.1.1.m1.1.1.cmml"><mi id="S3.T5.7.7.1.1.m1.1.1a" xref="S3.T5.7.7.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.7.7.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.7.7.1.1.m1.1.1.1a.cmml">+1.1</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.7.7.1.1.m1.1b"><apply id="S3.T5.7.7.1.1.m1.1.1.cmml" xref="S3.T5.7.7.1.1.m1.1.1"><ci id="S3.T5.7.7.1.1.m1.1.1.1a.cmml" xref="S3.T5.7.7.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.7.7.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.7.7.1.1.m1.1.1.1">+1.1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.7.7.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.1}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.7.7.1.1.m1.1d">start_FLOATSUBSCRIPT +1.1 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.22.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.22.8.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span class="ltx_ERROR undefined" id="S3.T5.12.22.8.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.22.8.2" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.22.8.2.1">SQFT + QA-SparsePEFT (Ours)</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.12.22.8.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.22.8.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.22.8.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.22.8.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.22.8.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.22.8.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">48.2</td>
</tr>
<tr class="ltx_tr" id="S3.T5.8.8">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.8.8.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center" id="S3.T5.8.8.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.8.8.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.8.8.1.1">50.2<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.0}}}" class="ltx_Math" display="inline" id="S3.T5.8.8.1.1.m1.1"><semantics id="S3.T5.8.8.1.1.m1.1a"><msub id="S3.T5.8.8.1.1.m1.1.1" xref="S3.T5.8.8.1.1.m1.1.1.cmml"><mi id="S3.T5.8.8.1.1.m1.1.1a" xref="S3.T5.8.8.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.8.8.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.8.8.1.1.m1.1.1.1a.cmml">+2.0</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.8.8.1.1.m1.1b"><apply id="S3.T5.8.8.1.1.m1.1.1.cmml" xref="S3.T5.8.8.1.1.m1.1.1"><ci id="S3.T5.8.8.1.1.m1.1.1.1a.cmml" xref="S3.T5.8.8.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.8.8.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.8.8.1.1.m1.1.1.1">+2.0</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.8.8.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.0}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.8.8.1.1.m1.1d">start_FLOATSUBSCRIPT +2.0 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.23.9">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.12.23.9.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S3.T5.12.23.9.2" rowspan="8" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.23.9.2.1">70%</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T5.12.23.9.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.23.9.3.1">Shears</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.23.9.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.23.9.4.1">✗</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.23.9.5" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.23.9.5.1">FP16 + FP16</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.23.9.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.12.23.9.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.5</td>
</tr>
<tr class="ltx_tr" id="S3.T5.9.9">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.9.9.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center" id="S3.T5.9.9.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.9.9.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.9.9.1.1">27.9<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.4}}}" class="ltx_Math" display="inline" id="S3.T5.9.9.1.1.m1.1"><semantics id="S3.T5.9.9.1.1.m1.1a"><msub id="S3.T5.9.9.1.1.m1.1.1" xref="S3.T5.9.9.1.1.m1.1.1.cmml"><mi id="S3.T5.9.9.1.1.m1.1.1a" xref="S3.T5.9.9.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.9.9.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.9.9.1.1.m1.1.1.1a.cmml">+2.4</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.9.9.1.1.m1.1b"><apply id="S3.T5.9.9.1.1.m1.1.1.cmml" xref="S3.T5.9.9.1.1.m1.1.1"><ci id="S3.T5.9.9.1.1.m1.1.1.1a.cmml" xref="S3.T5.9.9.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.9.9.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.9.9.1.1.m1.1.1.1">+2.4</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.9.9.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.4}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.9.9.1.1.m1.1d">start_FLOATSUBSCRIPT +2.4 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.24.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.24.10.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span class="ltx_ERROR undefined" id="S3.T5.12.24.10.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.24.10.2" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.24.10.2.1">SQFT + SparsePEFT (Ours)</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.12.24.10.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.24.10.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.24.10.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.24.10.4.1">FP16</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.24.10.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.24.10.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">22.1</td>
</tr>
<tr class="ltx_tr" id="S3.T5.10.10">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.10.10.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center" id="S3.T5.10.10.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.10.10.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.10.10.1.1">24.9<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.8}}}" class="ltx_Math" display="inline" id="S3.T5.10.10.1.1.m1.1"><semantics id="S3.T5.10.10.1.1.m1.1a"><msub id="S3.T5.10.10.1.1.m1.1.1" xref="S3.T5.10.10.1.1.m1.1.1.cmml"><mi id="S3.T5.10.10.1.1.m1.1.1a" xref="S3.T5.10.10.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.10.10.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.10.10.1.1.m1.1.1.1a.cmml">+2.8</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.10.10.1.1.m1.1b"><apply id="S3.T5.10.10.1.1.m1.1.1.cmml" xref="S3.T5.10.10.1.1.m1.1.1"><ci id="S3.T5.10.10.1.1.m1.1.1.1a.cmml" xref="S3.T5.10.10.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.10.10.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.10.10.1.1.m1.1.1.1">+2.8</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.10.10.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.8}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.10.10.1.1.m1.1d">start_FLOATSUBSCRIPT +2.8 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.25.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.25.11.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span class="ltx_ERROR undefined" id="S3.T5.12.25.11.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.25.11.2" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.25.11.2.1">SQFT (Ours)</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.12.25.11.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.25.11.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.25.11.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.25.11.4.1">INT4 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.25.11.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.25.11.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">24.2</td>
</tr>
<tr class="ltx_tr" id="S3.T5.11.11">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T5.11.11.2" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center" id="S3.T5.11.11.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="S3.T5.11.11.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.11.11.1.1">25.2<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.0}}}" class="ltx_Math" display="inline" id="S3.T5.11.11.1.1.m1.1"><semantics id="S3.T5.11.11.1.1.m1.1a"><msub id="S3.T5.11.11.1.1.m1.1.1" xref="S3.T5.11.11.1.1.m1.1.1.cmml"><mi id="S3.T5.11.11.1.1.m1.1.1a" xref="S3.T5.11.11.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.11.11.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.11.11.1.1.m1.1.1.1a.cmml">+1.0</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.11.11.1.1.m1.1b"><apply id="S3.T5.11.11.1.1.m1.1.1.cmml" xref="S3.T5.11.11.1.1.m1.1.1"><ci id="S3.T5.11.11.1.1.m1.1.1.1a.cmml" xref="S3.T5.11.11.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.11.11.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.11.11.1.1.m1.1.1.1">+1.0</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.11.11.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.0}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.11.11.1.1.m1.1d">start_FLOATSUBSCRIPT +1.0 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.12.12.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
<span class="ltx_ERROR undefined" id="S3.T5.12.12.2.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T5.12.12.3" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.12.3.1">SQFT + QA-SparsePEFT (Ours)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.12.12.4" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.12.4.1">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.12.12.5" rowspan="2" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text" id="S3.T5.12.12.5.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.12.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.12.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.12.12.1.1">22.6<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.2}}}" class="ltx_Math" display="inline" id="S3.T5.12.12.1.1.m1.1"><semantics id="S3.T5.12.12.1.1.m1.1a"><msub id="S3.T5.12.12.1.1.m1.1.1" xref="S3.T5.12.12.1.1.m1.1.1.cmml"><mi id="S3.T5.12.12.1.1.m1.1.1a" xref="S3.T5.12.12.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S3.T5.12.12.1.1.m1.1.1.1" mathcolor="#FF0000" xref="S3.T5.12.12.1.1.m1.1.1.1a.cmml">+0.2</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T5.12.12.1.1.m1.1b"><apply id="S3.T5.12.12.1.1.m1.1.1.cmml" xref="S3.T5.12.12.1.1.m1.1.1"><ci id="S3.T5.12.12.1.1.m1.1.1.1a.cmml" xref="S3.T5.12.12.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.T5.12.12.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="S3.T5.12.12.1.1.m1.1.1.1">+0.2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.12.12.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.2}}}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.12.12.1.1.m1.1d">start_FLOATSUBSCRIPT +0.2 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.12.26.12">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb" id="S3.T5.12.26.12.1" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.12.26.12.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">NLS</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.12.26.12.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">22.4</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">All our previous experiments employ 50% sparsity as it is moderate and mild. In this section, we explored the behavior of SQFT in a broader range of sparsity levels.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.F5" title="Figure 5 ‣ 3.3 Hill-climbing to Better Configurations ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">5</span></a>, the model’s accuracy experiences a significant drop between a sparsity of 60% and 70%. We denote this range as the critical sparsity threshold, representing the boundary at which the model’s performance notably degrades.
Through our recovery downstream fine-tuning strategy, models with up to 50% sparsity (even with quantization) can achieve comparable performance with the original dense model (represented by the baseline in the figure) on the downstream task. This 50% sparsity can be defined as the optimal sparsity level, as it represents the point of balance where the model maintains high performance while achieving computational efficiency.
Moreover, there is little difference in accuracy between our mergeable and non-mergeable approaches, which illustrates the effectiveness of our proposed SparsePEFT.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Cost Analysis of Pipeline Configurations</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">The different versions of SQFT’s pipelines incur various costs that allow users to choose based on their fine-tuning budget. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.T6" title="Table 6 ‣ 3.5 Cost Analysis of Pipeline Configurations ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">6</span></a> details the characteristics of each pipeline configuration, e.g., whether we can merge the adapters, the precision of the based model and the adapters, and the cost of each configuration.
Two assumptions are made regarding model storage, inference speedup, or memory: merging is better than unmerging due to the overhead from the unmerged adapters, and quantization mode is better than full-precision mode.
As for accuracy, the mergeable method we propose is competitive with the previous non-mergeable method.
Regarding the fine-tuning time, our mergeable method is slightly slower than the non-mergeable method due to the additional mask and adapter calculations.
In summary, SQFT with SparsePEFT is the best choice for full-precision mode because it eliminates the adapter’s additional path without sacrificing accuracy.
Suppose memory usage during fine-tuning is a priority for the quantization mode. In that case, vanilla SQFT (first configuration in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">2</span></a>) is the best choice because it only requires the quantized model with little overhead of different precision adapters. Otherwise, SQFT with QA-SparsePEFT is better because it can ultimately produce a most efficient model that will be of great benefit at deployment time.</p>
</div>
<figure class="ltx_table" id="S3.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Cost analysis for different pipelines (<span class="ltx_text ltx_font_bold" id="S3.T6.14.1">rank</span>). ID 1, 2, 3, and 4 represent LoRA/Shears, SQFT, SQFT + SparsePEFT, and SQFT + QA-SparsePEFT, respectively.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T6.12">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T6.12.13.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T6.12.13.1.1" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.12.13.1.1.1">ID</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.12.13.1.2" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.12.13.1.2.1">1</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.12.13.1.3" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.12.13.1.3.1">2</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.12.13.1.4" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.12.13.1.4.1">3</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.12.13.1.5" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.12.13.1.5.1">4</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.12.14.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T6.12.14.2.1" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.12.14.2.1.1">Mergeable</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.12.14.2.2" style="padding:1pt 4.0pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.12.14.2.3" style="padding:1pt 4.0pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.12.14.2.4" style="padding:1pt 4.0pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.12.14.2.5" style="padding:1pt 4.0pt;">✓</td>
</tr>
<tr class="ltx_tr" id="S3.T6.12.15.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.12.15.3.1" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.12.15.3.1.1">Final Precision</span></th>
<td class="ltx_td ltx_align_center" id="S3.T6.12.15.3.2" style="padding:1pt 4.0pt;">FP16 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T6.12.15.3.3" style="padding:1pt 4.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T6.12.15.3.4" style="padding:1pt 4.0pt;">FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T6.12.15.3.5" style="padding:1pt 4.0pt;">INT4</td>
</tr>
<tr class="ltx_tr" id="S3.T6.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T6.1.1.1" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.1.1">Model Storage (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T6.1.1.1.1.m1.1"><semantics id="S3.T6.1.1.1.1.m1.1a"><mo id="S3.T6.1.1.1.1.m1.1.1" stretchy="false" xref="S3.T6.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T6.1.1.1.1.m1.1b"><ci id="S3.T6.1.1.1.1.m1.1.1.cmml" xref="S3.T6.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T6.1.1.1.1.m1.1d">↓</annotation></semantics></math>)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S3.T6.2.2.2" style="padding:1pt 4.0pt;"><math alttext="1&gt;3\gg 2&gt;4" class="ltx_Math" display="inline" id="S3.T6.2.2.2.m1.1"><semantics id="S3.T6.2.2.2.m1.1a"><mrow id="S3.T6.2.2.2.m1.1.1" xref="S3.T6.2.2.2.m1.1.1.cmml"><mn id="S3.T6.2.2.2.m1.1.1.2" xref="S3.T6.2.2.2.m1.1.1.2.cmml">1</mn><mo id="S3.T6.2.2.2.m1.1.1.3" xref="S3.T6.2.2.2.m1.1.1.3.cmml">&gt;</mo><mn id="S3.T6.2.2.2.m1.1.1.4" xref="S3.T6.2.2.2.m1.1.1.4.cmml">3</mn><mo id="S3.T6.2.2.2.m1.1.1.5" xref="S3.T6.2.2.2.m1.1.1.5.cmml">≫</mo><mn id="S3.T6.2.2.2.m1.1.1.6" xref="S3.T6.2.2.2.m1.1.1.6.cmml">2</mn><mo id="S3.T6.2.2.2.m1.1.1.7" xref="S3.T6.2.2.2.m1.1.1.7.cmml">&gt;</mo><mn id="S3.T6.2.2.2.m1.1.1.8" xref="S3.T6.2.2.2.m1.1.1.8.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T6.2.2.2.m1.1b"><apply id="S3.T6.2.2.2.m1.1.1.cmml" xref="S3.T6.2.2.2.m1.1.1"><and id="S3.T6.2.2.2.m1.1.1a.cmml" xref="S3.T6.2.2.2.m1.1.1"></and><apply id="S3.T6.2.2.2.m1.1.1b.cmml" xref="S3.T6.2.2.2.m1.1.1"><gt id="S3.T6.2.2.2.m1.1.1.3.cmml" xref="S3.T6.2.2.2.m1.1.1.3"></gt><cn id="S3.T6.2.2.2.m1.1.1.2.cmml" type="integer" xref="S3.T6.2.2.2.m1.1.1.2">1</cn><cn id="S3.T6.2.2.2.m1.1.1.4.cmml" type="integer" xref="S3.T6.2.2.2.m1.1.1.4">3</cn></apply><apply id="S3.T6.2.2.2.m1.1.1c.cmml" xref="S3.T6.2.2.2.m1.1.1"><csymbol cd="latexml" id="S3.T6.2.2.2.m1.1.1.5.cmml" xref="S3.T6.2.2.2.m1.1.1.5">much-greater-than</csymbol><share href="https://arxiv.org/html/2410.03750v1#S3.T6.2.2.2.m1.1.1.4.cmml" id="S3.T6.2.2.2.m1.1.1d.cmml" xref="S3.T6.2.2.2.m1.1.1"></share><cn id="S3.T6.2.2.2.m1.1.1.6.cmml" type="integer" xref="S3.T6.2.2.2.m1.1.1.6">2</cn></apply><apply id="S3.T6.2.2.2.m1.1.1e.cmml" xref="S3.T6.2.2.2.m1.1.1"><gt id="S3.T6.2.2.2.m1.1.1.7.cmml" xref="S3.T6.2.2.2.m1.1.1.7"></gt><share href="https://arxiv.org/html/2410.03750v1#S3.T6.2.2.2.m1.1.1.6.cmml" id="S3.T6.2.2.2.m1.1.1f.cmml" xref="S3.T6.2.2.2.m1.1.1"></share><cn id="S3.T6.2.2.2.m1.1.1.8.cmml" type="integer" xref="S3.T6.2.2.2.m1.1.1.8">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.2.2.2.m1.1c">1&gt;3\gg 2&gt;4</annotation><annotation encoding="application/x-llamapun" id="S3.T6.2.2.2.m1.1d">1 &gt; 3 ≫ 2 &gt; 4</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T6.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.3.3.1" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.3.3.1.1">Fine-tuning Time (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T6.3.3.1.1.m1.1"><semantics id="S3.T6.3.3.1.1.m1.1a"><mo id="S3.T6.3.3.1.1.m1.1.1" stretchy="false" xref="S3.T6.3.3.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T6.3.3.1.1.m1.1b"><ci id="S3.T6.3.3.1.1.m1.1.1.cmml" xref="S3.T6.3.3.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.3.3.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T6.3.3.1.1.m1.1d">↓</annotation></semantics></math>)</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S3.T6.4.4.2" style="padding:1pt 4.0pt;"><math alttext="1\approx 2&lt;3\approx 4" class="ltx_Math" display="inline" id="S3.T6.4.4.2.m1.1"><semantics id="S3.T6.4.4.2.m1.1a"><mrow id="S3.T6.4.4.2.m1.1.1" xref="S3.T6.4.4.2.m1.1.1.cmml"><mn id="S3.T6.4.4.2.m1.1.1.2" xref="S3.T6.4.4.2.m1.1.1.2.cmml">1</mn><mo id="S3.T6.4.4.2.m1.1.1.3" xref="S3.T6.4.4.2.m1.1.1.3.cmml">≈</mo><mn id="S3.T6.4.4.2.m1.1.1.4" xref="S3.T6.4.4.2.m1.1.1.4.cmml">2</mn><mo id="S3.T6.4.4.2.m1.1.1.5" xref="S3.T6.4.4.2.m1.1.1.5.cmml">&lt;</mo><mn id="S3.T6.4.4.2.m1.1.1.6" xref="S3.T6.4.4.2.m1.1.1.6.cmml">3</mn><mo id="S3.T6.4.4.2.m1.1.1.7" xref="S3.T6.4.4.2.m1.1.1.7.cmml">≈</mo><mn id="S3.T6.4.4.2.m1.1.1.8" xref="S3.T6.4.4.2.m1.1.1.8.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T6.4.4.2.m1.1b"><apply id="S3.T6.4.4.2.m1.1.1.cmml" xref="S3.T6.4.4.2.m1.1.1"><and id="S3.T6.4.4.2.m1.1.1a.cmml" xref="S3.T6.4.4.2.m1.1.1"></and><apply id="S3.T6.4.4.2.m1.1.1b.cmml" xref="S3.T6.4.4.2.m1.1.1"><approx id="S3.T6.4.4.2.m1.1.1.3.cmml" xref="S3.T6.4.4.2.m1.1.1.3"></approx><cn id="S3.T6.4.4.2.m1.1.1.2.cmml" type="integer" xref="S3.T6.4.4.2.m1.1.1.2">1</cn><cn id="S3.T6.4.4.2.m1.1.1.4.cmml" type="integer" xref="S3.T6.4.4.2.m1.1.1.4">2</cn></apply><apply id="S3.T6.4.4.2.m1.1.1c.cmml" xref="S3.T6.4.4.2.m1.1.1"><lt id="S3.T6.4.4.2.m1.1.1.5.cmml" xref="S3.T6.4.4.2.m1.1.1.5"></lt><share href="https://arxiv.org/html/2410.03750v1#S3.T6.4.4.2.m1.1.1.4.cmml" id="S3.T6.4.4.2.m1.1.1d.cmml" xref="S3.T6.4.4.2.m1.1.1"></share><cn id="S3.T6.4.4.2.m1.1.1.6.cmml" type="integer" xref="S3.T6.4.4.2.m1.1.1.6">3</cn></apply><apply id="S3.T6.4.4.2.m1.1.1e.cmml" xref="S3.T6.4.4.2.m1.1.1"><approx id="S3.T6.4.4.2.m1.1.1.7.cmml" xref="S3.T6.4.4.2.m1.1.1.7"></approx><share href="https://arxiv.org/html/2410.03750v1#S3.T6.4.4.2.m1.1.1.6.cmml" id="S3.T6.4.4.2.m1.1.1f.cmml" xref="S3.T6.4.4.2.m1.1.1"></share><cn id="S3.T6.4.4.2.m1.1.1.8.cmml" type="integer" xref="S3.T6.4.4.2.m1.1.1.8">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.4.4.2.m1.1c">1\approx 2&lt;3\approx 4</annotation><annotation encoding="application/x-llamapun" id="S3.T6.4.4.2.m1.1d">1 ≈ 2 &lt; 3 ≈ 4</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.5.5.1" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.5.5.1.1">Fine-tuning Memory (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T6.5.5.1.1.m1.1"><semantics id="S3.T6.5.5.1.1.m1.1a"><mo id="S3.T6.5.5.1.1.m1.1.1" stretchy="false" xref="S3.T6.5.5.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T6.5.5.1.1.m1.1b"><ci id="S3.T6.5.5.1.1.m1.1.1.cmml" xref="S3.T6.5.5.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.5.5.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T6.5.5.1.1.m1.1d">↓</annotation></semantics></math>)</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S3.T6.6.6.2" style="padding:1pt 4.0pt;"><math alttext="2&lt;1\approx 3\approx 4" class="ltx_Math" display="inline" id="S3.T6.6.6.2.m1.1"><semantics id="S3.T6.6.6.2.m1.1a"><mrow id="S3.T6.6.6.2.m1.1.1" xref="S3.T6.6.6.2.m1.1.1.cmml"><mn id="S3.T6.6.6.2.m1.1.1.2" xref="S3.T6.6.6.2.m1.1.1.2.cmml">2</mn><mo id="S3.T6.6.6.2.m1.1.1.3" xref="S3.T6.6.6.2.m1.1.1.3.cmml">&lt;</mo><mn id="S3.T6.6.6.2.m1.1.1.4" xref="S3.T6.6.6.2.m1.1.1.4.cmml">1</mn><mo id="S3.T6.6.6.2.m1.1.1.5" xref="S3.T6.6.6.2.m1.1.1.5.cmml">≈</mo><mn id="S3.T6.6.6.2.m1.1.1.6" xref="S3.T6.6.6.2.m1.1.1.6.cmml">3</mn><mo id="S3.T6.6.6.2.m1.1.1.7" xref="S3.T6.6.6.2.m1.1.1.7.cmml">≈</mo><mn id="S3.T6.6.6.2.m1.1.1.8" xref="S3.T6.6.6.2.m1.1.1.8.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T6.6.6.2.m1.1b"><apply id="S3.T6.6.6.2.m1.1.1.cmml" xref="S3.T6.6.6.2.m1.1.1"><and id="S3.T6.6.6.2.m1.1.1a.cmml" xref="S3.T6.6.6.2.m1.1.1"></and><apply id="S3.T6.6.6.2.m1.1.1b.cmml" xref="S3.T6.6.6.2.m1.1.1"><lt id="S3.T6.6.6.2.m1.1.1.3.cmml" xref="S3.T6.6.6.2.m1.1.1.3"></lt><cn id="S3.T6.6.6.2.m1.1.1.2.cmml" type="integer" xref="S3.T6.6.6.2.m1.1.1.2">2</cn><cn id="S3.T6.6.6.2.m1.1.1.4.cmml" type="integer" xref="S3.T6.6.6.2.m1.1.1.4">1</cn></apply><apply id="S3.T6.6.6.2.m1.1.1c.cmml" xref="S3.T6.6.6.2.m1.1.1"><approx id="S3.T6.6.6.2.m1.1.1.5.cmml" xref="S3.T6.6.6.2.m1.1.1.5"></approx><share href="https://arxiv.org/html/2410.03750v1#S3.T6.6.6.2.m1.1.1.4.cmml" id="S3.T6.6.6.2.m1.1.1d.cmml" xref="S3.T6.6.6.2.m1.1.1"></share><cn id="S3.T6.6.6.2.m1.1.1.6.cmml" type="integer" xref="S3.T6.6.6.2.m1.1.1.6">3</cn></apply><apply id="S3.T6.6.6.2.m1.1.1e.cmml" xref="S3.T6.6.6.2.m1.1.1"><approx id="S3.T6.6.6.2.m1.1.1.7.cmml" xref="S3.T6.6.6.2.m1.1.1.7"></approx><share href="https://arxiv.org/html/2410.03750v1#S3.T6.6.6.2.m1.1.1.6.cmml" id="S3.T6.6.6.2.m1.1.1f.cmml" xref="S3.T6.6.6.2.m1.1.1"></share><cn id="S3.T6.6.6.2.m1.1.1.8.cmml" type="integer" xref="S3.T6.6.6.2.m1.1.1.8">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.6.6.2.m1.1c">2&lt;1\approx 3\approx 4</annotation><annotation encoding="application/x-llamapun" id="S3.T6.6.6.2.m1.1d">2 &lt; 1 ≈ 3 ≈ 4</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T6.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.7.7.1" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.7.7.1.1">Inference Speedup (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T6.7.7.1.1.m1.1"><semantics id="S3.T6.7.7.1.1.m1.1a"><mo id="S3.T6.7.7.1.1.m1.1.1" stretchy="false" xref="S3.T6.7.7.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T6.7.7.1.1.m1.1b"><ci id="S3.T6.7.7.1.1.m1.1.1.cmml" xref="S3.T6.7.7.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.7.7.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T6.7.7.1.1.m1.1d">↑</annotation></semantics></math>)</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S3.T6.8.8.2" style="padding:1pt 4.0pt;"><math alttext="4&gt;2&gt;3&gt;1" class="ltx_Math" display="inline" id="S3.T6.8.8.2.m1.1"><semantics id="S3.T6.8.8.2.m1.1a"><mrow id="S3.T6.8.8.2.m1.1.1" xref="S3.T6.8.8.2.m1.1.1.cmml"><mn id="S3.T6.8.8.2.m1.1.1.2" xref="S3.T6.8.8.2.m1.1.1.2.cmml">4</mn><mo id="S3.T6.8.8.2.m1.1.1.3" xref="S3.T6.8.8.2.m1.1.1.3.cmml">&gt;</mo><mn id="S3.T6.8.8.2.m1.1.1.4" xref="S3.T6.8.8.2.m1.1.1.4.cmml">2</mn><mo id="S3.T6.8.8.2.m1.1.1.5" xref="S3.T6.8.8.2.m1.1.1.5.cmml">&gt;</mo><mn id="S3.T6.8.8.2.m1.1.1.6" xref="S3.T6.8.8.2.m1.1.1.6.cmml">3</mn><mo id="S3.T6.8.8.2.m1.1.1.7" xref="S3.T6.8.8.2.m1.1.1.7.cmml">&gt;</mo><mn id="S3.T6.8.8.2.m1.1.1.8" xref="S3.T6.8.8.2.m1.1.1.8.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T6.8.8.2.m1.1b"><apply id="S3.T6.8.8.2.m1.1.1.cmml" xref="S3.T6.8.8.2.m1.1.1"><and id="S3.T6.8.8.2.m1.1.1a.cmml" xref="S3.T6.8.8.2.m1.1.1"></and><apply id="S3.T6.8.8.2.m1.1.1b.cmml" xref="S3.T6.8.8.2.m1.1.1"><gt id="S3.T6.8.8.2.m1.1.1.3.cmml" xref="S3.T6.8.8.2.m1.1.1.3"></gt><cn id="S3.T6.8.8.2.m1.1.1.2.cmml" type="integer" xref="S3.T6.8.8.2.m1.1.1.2">4</cn><cn id="S3.T6.8.8.2.m1.1.1.4.cmml" type="integer" xref="S3.T6.8.8.2.m1.1.1.4">2</cn></apply><apply id="S3.T6.8.8.2.m1.1.1c.cmml" xref="S3.T6.8.8.2.m1.1.1"><gt id="S3.T6.8.8.2.m1.1.1.5.cmml" xref="S3.T6.8.8.2.m1.1.1.5"></gt><share href="https://arxiv.org/html/2410.03750v1#S3.T6.8.8.2.m1.1.1.4.cmml" id="S3.T6.8.8.2.m1.1.1d.cmml" xref="S3.T6.8.8.2.m1.1.1"></share><cn id="S3.T6.8.8.2.m1.1.1.6.cmml" type="integer" xref="S3.T6.8.8.2.m1.1.1.6">3</cn></apply><apply id="S3.T6.8.8.2.m1.1.1e.cmml" xref="S3.T6.8.8.2.m1.1.1"><gt id="S3.T6.8.8.2.m1.1.1.7.cmml" xref="S3.T6.8.8.2.m1.1.1.7"></gt><share href="https://arxiv.org/html/2410.03750v1#S3.T6.8.8.2.m1.1.1.6.cmml" id="S3.T6.8.8.2.m1.1.1f.cmml" xref="S3.T6.8.8.2.m1.1.1"></share><cn id="S3.T6.8.8.2.m1.1.1.8.cmml" type="integer" xref="S3.T6.8.8.2.m1.1.1.8">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.8.8.2.m1.1c">4&gt;2&gt;3&gt;1</annotation><annotation encoding="application/x-llamapun" id="S3.T6.8.8.2.m1.1d">4 &gt; 2 &gt; 3 &gt; 1</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T6.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.9.9.1" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.9.9.1.1">Inference Memory (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T6.9.9.1.1.m1.1"><semantics id="S3.T6.9.9.1.1.m1.1a"><mo id="S3.T6.9.9.1.1.m1.1.1" stretchy="false" xref="S3.T6.9.9.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T6.9.9.1.1.m1.1b"><ci id="S3.T6.9.9.1.1.m1.1.1.cmml" xref="S3.T6.9.9.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.9.9.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T6.9.9.1.1.m1.1d">↓</annotation></semantics></math>)</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S3.T6.10.10.2" style="padding:1pt 4.0pt;"><math alttext="4&lt;2&lt;3&lt;1" class="ltx_Math" display="inline" id="S3.T6.10.10.2.m1.1"><semantics id="S3.T6.10.10.2.m1.1a"><mrow id="S3.T6.10.10.2.m1.1.1" xref="S3.T6.10.10.2.m1.1.1.cmml"><mn id="S3.T6.10.10.2.m1.1.1.2" xref="S3.T6.10.10.2.m1.1.1.2.cmml">4</mn><mo id="S3.T6.10.10.2.m1.1.1.3" xref="S3.T6.10.10.2.m1.1.1.3.cmml">&lt;</mo><mn id="S3.T6.10.10.2.m1.1.1.4" xref="S3.T6.10.10.2.m1.1.1.4.cmml">2</mn><mo id="S3.T6.10.10.2.m1.1.1.5" xref="S3.T6.10.10.2.m1.1.1.5.cmml">&lt;</mo><mn id="S3.T6.10.10.2.m1.1.1.6" xref="S3.T6.10.10.2.m1.1.1.6.cmml">3</mn><mo id="S3.T6.10.10.2.m1.1.1.7" xref="S3.T6.10.10.2.m1.1.1.7.cmml">&lt;</mo><mn id="S3.T6.10.10.2.m1.1.1.8" xref="S3.T6.10.10.2.m1.1.1.8.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T6.10.10.2.m1.1b"><apply id="S3.T6.10.10.2.m1.1.1.cmml" xref="S3.T6.10.10.2.m1.1.1"><and id="S3.T6.10.10.2.m1.1.1a.cmml" xref="S3.T6.10.10.2.m1.1.1"></and><apply id="S3.T6.10.10.2.m1.1.1b.cmml" xref="S3.T6.10.10.2.m1.1.1"><lt id="S3.T6.10.10.2.m1.1.1.3.cmml" xref="S3.T6.10.10.2.m1.1.1.3"></lt><cn id="S3.T6.10.10.2.m1.1.1.2.cmml" type="integer" xref="S3.T6.10.10.2.m1.1.1.2">4</cn><cn id="S3.T6.10.10.2.m1.1.1.4.cmml" type="integer" xref="S3.T6.10.10.2.m1.1.1.4">2</cn></apply><apply id="S3.T6.10.10.2.m1.1.1c.cmml" xref="S3.T6.10.10.2.m1.1.1"><lt id="S3.T6.10.10.2.m1.1.1.5.cmml" xref="S3.T6.10.10.2.m1.1.1.5"></lt><share href="https://arxiv.org/html/2410.03750v1#S3.T6.10.10.2.m1.1.1.4.cmml" id="S3.T6.10.10.2.m1.1.1d.cmml" xref="S3.T6.10.10.2.m1.1.1"></share><cn id="S3.T6.10.10.2.m1.1.1.6.cmml" type="integer" xref="S3.T6.10.10.2.m1.1.1.6">3</cn></apply><apply id="S3.T6.10.10.2.m1.1.1e.cmml" xref="S3.T6.10.10.2.m1.1.1"><lt id="S3.T6.10.10.2.m1.1.1.7.cmml" xref="S3.T6.10.10.2.m1.1.1.7"></lt><share href="https://arxiv.org/html/2410.03750v1#S3.T6.10.10.2.m1.1.1.6.cmml" id="S3.T6.10.10.2.m1.1.1f.cmml" xref="S3.T6.10.10.2.m1.1.1"></share><cn id="S3.T6.10.10.2.m1.1.1.8.cmml" type="integer" xref="S3.T6.10.10.2.m1.1.1.8">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.10.10.2.m1.1c">4&lt;2&lt;3&lt;1</annotation><annotation encoding="application/x-llamapun" id="S3.T6.10.10.2.m1.1d">4 &lt; 2 &lt; 3 &lt; 1</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T6.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T6.11.11.1" style="padding:1pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.11.11.1.1">Accuracy (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T6.11.11.1.1.m1.1"><semantics id="S3.T6.11.11.1.1.m1.1a"><mo id="S3.T6.11.11.1.1.m1.1.1" stretchy="false" xref="S3.T6.11.11.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T6.11.11.1.1.m1.1b"><ci id="S3.T6.11.11.1.1.m1.1.1.cmml" xref="S3.T6.11.11.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.11.11.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T6.11.11.1.1.m1.1d">↑</annotation></semantics></math>)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" colspan="4" id="S3.T6.12.12.2" style="padding:1pt 4.0pt;"><math alttext="1\approx 3&gt;2\approx 4" class="ltx_Math" display="inline" id="S3.T6.12.12.2.m1.1"><semantics id="S3.T6.12.12.2.m1.1a"><mrow id="S3.T6.12.12.2.m1.1.1" xref="S3.T6.12.12.2.m1.1.1.cmml"><mn id="S3.T6.12.12.2.m1.1.1.2" xref="S3.T6.12.12.2.m1.1.1.2.cmml">1</mn><mo id="S3.T6.12.12.2.m1.1.1.3" xref="S3.T6.12.12.2.m1.1.1.3.cmml">≈</mo><mn id="S3.T6.12.12.2.m1.1.1.4" xref="S3.T6.12.12.2.m1.1.1.4.cmml">3</mn><mo id="S3.T6.12.12.2.m1.1.1.5" xref="S3.T6.12.12.2.m1.1.1.5.cmml">&gt;</mo><mn id="S3.T6.12.12.2.m1.1.1.6" xref="S3.T6.12.12.2.m1.1.1.6.cmml">2</mn><mo id="S3.T6.12.12.2.m1.1.1.7" xref="S3.T6.12.12.2.m1.1.1.7.cmml">≈</mo><mn id="S3.T6.12.12.2.m1.1.1.8" xref="S3.T6.12.12.2.m1.1.1.8.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T6.12.12.2.m1.1b"><apply id="S3.T6.12.12.2.m1.1.1.cmml" xref="S3.T6.12.12.2.m1.1.1"><and id="S3.T6.12.12.2.m1.1.1a.cmml" xref="S3.T6.12.12.2.m1.1.1"></and><apply id="S3.T6.12.12.2.m1.1.1b.cmml" xref="S3.T6.12.12.2.m1.1.1"><approx id="S3.T6.12.12.2.m1.1.1.3.cmml" xref="S3.T6.12.12.2.m1.1.1.3"></approx><cn id="S3.T6.12.12.2.m1.1.1.2.cmml" type="integer" xref="S3.T6.12.12.2.m1.1.1.2">1</cn><cn id="S3.T6.12.12.2.m1.1.1.4.cmml" type="integer" xref="S3.T6.12.12.2.m1.1.1.4">3</cn></apply><apply id="S3.T6.12.12.2.m1.1.1c.cmml" xref="S3.T6.12.12.2.m1.1.1"><gt id="S3.T6.12.12.2.m1.1.1.5.cmml" xref="S3.T6.12.12.2.m1.1.1.5"></gt><share href="https://arxiv.org/html/2410.03750v1#S3.T6.12.12.2.m1.1.1.4.cmml" id="S3.T6.12.12.2.m1.1.1d.cmml" xref="S3.T6.12.12.2.m1.1.1"></share><cn id="S3.T6.12.12.2.m1.1.1.6.cmml" type="integer" xref="S3.T6.12.12.2.m1.1.1.6">2</cn></apply><apply id="S3.T6.12.12.2.m1.1.1e.cmml" xref="S3.T6.12.12.2.m1.1.1"><approx id="S3.T6.12.12.2.m1.1.1.7.cmml" xref="S3.T6.12.12.2.m1.1.1.7"></approx><share href="https://arxiv.org/html/2410.03750v1#S3.T6.12.12.2.m1.1.1.6.cmml" id="S3.T6.12.12.2.m1.1.1f.cmml" xref="S3.T6.12.12.2.m1.1.1"></share><cn id="S3.T6.12.12.2.m1.1.1.8.cmml" type="integer" xref="S3.T6.12.12.2.m1.1.1.8">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.12.12.2.m1.1c">1\approx 3&gt;2\approx 4</annotation><annotation encoding="application/x-llamapun" id="S3.T6.12.12.2.m1.1d">1 ≈ 3 &gt; 2 ≈ 4</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Cost analysis for different pipelines (<span class="ltx_text ltx_font_bold" id="S3.T7.3.1">value</span>). ID 1, 2, 3, and 4 represent LoRA/Shears, SQFT, SQFT + SparsePEFT, and SQFT + QA-SparsePEFT, respectively. All numbers are tested on a single Tesla V100-SXM2-32GB GPU. Both training and inference are conducted on <span class="ltx_text ltx_font_bold" id="S3.T7.4.2">Llama-3-8B</span> with GSM8K, with a batch size of 16 during training.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T7.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T7.5.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T7.5.1.1.1" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.1.1.1.1">ID</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T7.5.1.1.2" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.1.1.2.1">1</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T7.5.1.1.3" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.1.1.3.1">2</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T7.5.1.1.4" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.1.1.4.1">3</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T7.5.1.1.5" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.1.1.5.1">4</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T7.5.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T7.5.2.1.1" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.2.1.1.1">Mergeable</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.5.2.1.2" style="padding:1pt 3.0pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.5.2.1.3" style="padding:1pt 3.0pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.5.2.1.4" style="padding:1pt 3.0pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.5.2.1.5" style="padding:1pt 3.0pt;">✓</td>
</tr>
<tr class="ltx_tr" id="S3.T7.5.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T7.5.3.2.1" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.3.2.1.1">Final Precision</span></th>
<td class="ltx_td ltx_align_center" id="S3.T7.5.3.2.2" style="padding:1pt 3.0pt;">FP16 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T7.5.3.2.3" style="padding:1pt 3.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T7.5.3.2.4" style="padding:1pt 3.0pt;">FP16</td>
<td class="ltx_td ltx_align_center" id="S3.T7.5.3.2.5" style="padding:1pt 3.0pt;">INT4</td>
</tr>
<tr class="ltx_tr" id="S3.T7.5.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T7.5.4.3.1" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.4.3.1.1">Model Storage</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.5.4.3.2" style="padding:1pt 3.0pt;">16.33 GB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.5.4.3.3" style="padding:1pt 3.0pt;">6.00 GB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.5.4.3.4" style="padding:1pt 3.0pt;">16.07 GB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.5.4.3.5" style="padding:1pt 3.0pt;">5.74 GB</td>
</tr>
<tr class="ltx_tr" id="S3.T7.5.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T7.5.5.4.1" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.5.4.1.1">Fine-tuning Speed</span></th>
<td class="ltx_td ltx_align_center" id="S3.T7.5.5.4.2" rowspan="2" style="padding:1pt 3.0pt;"><span class="ltx_text" id="S3.T7.5.5.4.2.1">0.3</span></td>
<td class="ltx_td ltx_align_center" id="S3.T7.5.5.4.3" rowspan="2" style="padding:1pt 3.0pt;"><span class="ltx_text" id="S3.T7.5.5.4.3.1">0.3</span></td>
<td class="ltx_td ltx_align_center" id="S3.T7.5.5.4.4" rowspan="2" style="padding:1pt 3.0pt;"><span class="ltx_text" id="S3.T7.5.5.4.4.1">0.2</span></td>
<td class="ltx_td ltx_align_center" id="S3.T7.5.5.4.5" rowspan="2" style="padding:1pt 3.0pt;"><span class="ltx_text" id="S3.T7.5.5.4.5.1">0.2</span></td>
</tr>
<tr class="ltx_tr" id="S3.T7.5.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T7.5.6.5.1" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.6.5.1.1">(steps per second)</span></th>
</tr>
<tr class="ltx_tr" id="S3.T7.5.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T7.5.7.6.1" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.5.7.6.1.1">Fine-tuning Memory</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T7.5.7.6.2" style="padding:1pt 3.0pt;">30 GiB</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T7.5.7.6.3" style="padding:1pt 3.0pt;">21 GiB</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T7.5.7.6.4" style="padding:1pt 3.0pt;">30 GiB</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T7.5.7.6.5" style="padding:1pt 3.0pt;">30 GiB</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Ablation Studies - LoRA vs NLS</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.T5" title="Table 5 ‣ 3.4 Exploring a Broader Range of Sparsity Levels ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">5</span></a>, the ablation studies across 30%, 50%, and 70% sparsity highlight the benefits of elastic adapters and the Neural Low-rank Adapter Search (NLS), which enhance the performance of the models fine-tuned by SQFT. Compared to vanilla LoRA, SQFT with SparsePEFT and NLS further reduces the accuracy gap to the dense or non-quantized models. We include more results with additional sparsity levels in the Appendix, which show the benefits of using SQFT with NLS for sparse and quantized models.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Large pre-trained models often require fine-tuning to downstream target tasks and compression to utilize them in resource-constrained environments. This paper presents SQFT, a low-cost fine-tuning solution for low precision and sparse foundation models. SQFT solves challenges when merging sparse (and quantized) base models and dense (with different numerical precision) adapters without losing the induced sparsity in the base model while delivering high-performing fine-tuned models. SQFT’s models and code are available at <a class="ltx_ref ltx_href" href="https://github.com/IntelLabs/Hardware-Aware-Automated-Machine-Learning" title="">https://github.com/IntelLabs/Hardware-Aware-Automated-Machine-Learning</a>.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Limitations and Ethical Considerations</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">Large pre-trained models have gained popularity and are the base of many applications. However, these models are often used indiscriminately with little analysis of their potential failures and consequences. SQFT solely focuses on these large models’ efficient fine-tuning and compression. However, users of SQFT should also consider the limitations of these models before deployment in environments where they can cause harm or conflict. Although compressing and fine-tuning these models on a particular downstream task would make them perform better, more studies are needed regarding the effects of this specialization.</p>
</div>
<div class="ltx_para" id="Sx1.p2">
<p class="ltx_p" id="Sx1.p2.1">We demonstrate SQFT on several pre-trained models. The benefits obtained from the proposed solution might transfer smoothly to other transformer-based models. However, there might also be models and datasets in which additional considerations must be taken. For instance, in our current experiments, we have noticed that in the case of OpenELM-1.1B <cite class="ltx_cite ltx_citemacro_cite">Mehta et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib17" title="">2024</a>)</cite>, fine-tuning on math reasoning datasets, e.g., GSM8K, does not result in high accuracy, and more experimentation is needed. There is also the case in which a pre-trained model might have been trained on a particular benchmark, a form of data contamination, which is difficult to confirm since often the details of the training data are not shared publicly <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib31" title="">2024</a>)</cite>. In these cases, inducing sparsity might result in a drop in accuracy on that particular benchmark.</p>
</div>
<div class="ltx_para" id="Sx1.p3">
<p class="ltx_p" id="Sx1.p3.1">Due to the many unknowns and complexity of current large models, it is essential to take measures to prevent their use in sensitive applications. With insights obtained by the research community in the years to come, understanding the intricacies of these models will help us use them beneficially and safely.</p>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx2.p1">
<p class="ltx_p" id="Sx2.p1.1">We are grateful to Michael Beale from Intel Labs, who helped us set up the infrastructure for sharing our models during the review stage and the final release and guided us through open-sourcing our compressed models. We also thank the anonymous reviewers for their insightful suggestions, which helped us improve the paper.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bisk et al. (2020)</span>
<span class="ltx_bibblock">
Yonatan Bisk, Rowan Zellers, Ronan Le Bras, Jianfeng Gao, and Yejin Choi. 2020.

</span>
<span class="ltx_bibblock">Piqa: Reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Thirty-Fourth AAAI Conference on Artificial Intelligence</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et al. (2019)</span>
<span class="ltx_bibblock">
Christopher Clark, Kenton Lee, Ming-Wei Chang, Tom Kwiatkowski, Michael Collins, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock">Boolq: Exploring the surprising difficulty of natural yes/no questions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">NAACL</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et al. (2018)</span>
<span class="ltx_bibblock">
Peter Clark, Isaac Cowhey, Oren Etzioni, Tushar Khot, Ashish Sabharwal, Carissa Schoenick, and Oyvind Tafjord. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://api.semanticscholar.org/CorpusID:3922816" title="">Think you have solved question answering? try arc, the ai2 reasoning challenge</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">ArXiv</em>, abs/1803.05457.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cobbe et al. (2021)</span>
<span class="ltx_bibblock">
Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano, Christopher Hesse, and John Schulman. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2110.14168" title="">Training verifiers to solve math word problems</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Preprint</em>, arXiv:2110.14168.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et al. (2022)</span>
<span class="ltx_bibblock">
Tim Dettmers, Mike Lewis, Younes Belkada, and Luke Zettlemoyer. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=dXiGWqBoxaD" title="">GPT3.int8(): 8-bit matrix multiplication for transformers at scale</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in Neural Information Processing Systems</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers and Zettlemoyer (2023)</span>
<span class="ltx_bibblock">
Tim Dettmers and Luke Zettlemoyer. 2023.

</span>
<span class="ltx_bibblock">The case for 4-bit precision: k-bit inference scaling laws.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 40th International Conference on Machine Learning</em>, ICML’23. JMLR.org.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar and Alistarh (2023)</span>
<span class="ltx_bibblock">
Elias Frantar and Dan Alistarh. 2023.

</span>
<span class="ltx_bibblock">SparseGPT: Massive language models can be accurately pruned in one-shot.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2301.00774</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar et al. (2022a)</span>
<span class="ltx_bibblock">
Elias Frantar, Saleh Ashkboos, Torsten Hoefler, and Dan Alistarh. 2022a.

</span>
<span class="ltx_bibblock">GPTQ: Accurate post-training compression for generative pretrained transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2210.17323</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar et al. (2022b)</span>
<span class="ltx_bibblock">
Elias Frantar, Sidak Pal Singh, and Dan Alistarh. 2022b.

</span>
<span class="ltx_bibblock">Optimal Brain Compression: a framework for accurate post-training quantization and pruning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Advances in Neural Information Processing Systems</em>, 36.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2023)</span>
<span class="ltx_bibblock">
Leo Gao, Jonathan Tow, Baber Abbasi, Stella Biderman, Sid Black, Anthony DiPofi, Charles Foster, Laurence Golding, Jeffrey Hsu, Alain Le Noac’h, Haonan Li, Kyle McDonell, Niklas Muennighoff, Chris Ociepa, Jason Phang, Laria Reynolds, Hailey Schoelkopf, Aviya Skowron, Lintang Sutawika, Eric Tang, Anish Thite, Ben Wang, Kevin Wang, and Andy Zou. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.5281/zenodo.10256836" title="">A framework for few-shot language model evaluation</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hagiwara (1994)</span>
<span class="ltx_bibblock">
Masafumi Hagiwara. 1994.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1016/0925-2312(94)90055-8" title="">A simple and effective method for removal of hidden units and weights</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Neurocomputing</em>, 6(2):207–218.

</span>
<span class="ltx_bibblock">Backpropagation, Part IV.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoefler et al. (2021)</span>
<span class="ltx_bibblock">
Torsten Hoefler, Dan Alistarh, Tal Ben-Nun, Nikoli Dryden, and Alexandra Peste. 2021.

</span>
<span class="ltx_bibblock">Sparsity in deep learning: pruning and growth for efficient inference and training in neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">J. Mach. Learn. Res.</em>, 22(1).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2022)</span>
<span class="ltx_bibblock">
Edward J Hu, yelong shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=nZeVKeeFYf9" title="">LoRA: Low-rank adaptation of large language models</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2023)</span>
<span class="ltx_bibblock">
Zhiqiang Hu, Yihuai Lan, Lei Wang, Wanyu Xu, Ee-Peng Lim, Roy Ka-Wei Lee, Lidong Bing, and Soujanya Poria. 2023.

</span>
<span class="ltx_bibblock">Llm-adapters: An adapter family for parameter-efficient fine-tuning of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2304.01933</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koncel-Kedziorski et al. (2016)</span>
<span class="ltx_bibblock">
Rik Koncel-Kedziorski, Subhro Roy, Aida Amini, Nate Kushman, and Hannaneh Hajishirzi. 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/N16-1136" title="">MAWPS: A math word problem repository</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 2016 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em>, pages 1152–1157, San Diego, California. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (1989)</span>
<span class="ltx_bibblock">
Yann LeCun, John Denker, and Sara Solla. 1989.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper_files/paper/1989/file/6c9882bbac1c7093bd25041881277658-Paper.pdf" title="">Optimal brain damage</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Advances in Neural Information Processing Systems</em>, volume 2. Morgan-Kaufmann.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mehta et al. (2024)</span>
<span class="ltx_bibblock">
Sachin Mehta, Mohammad Sekhavat, Qingqing Cao, Max Horton, Yanzi Jin, Frank Sun, Iman Mirzadeh, Mahyar Najibikohnehshahri, Dmitry Belenko, Peter Zatloukal, and Mohammad Rastegari. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2404.14619" title="">Openelm: An efficient language model family with open training and inference framework</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mihaylov et al. (2018)</span>
<span class="ltx_bibblock">
Todor Mihaylov, Peter Clark, Tushar Khot, and Ashish Sabharwal. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://api.semanticscholar.org/CorpusID:52183757" title="">Can a suit of armor conduct electricity? a new dataset for open book question answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Conference on Empirical Methods in Natural Language Processing</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munoz et al. (2024a)</span>
<span class="ltx_bibblock">
J. Pablo Munoz, Jinjie Yuan, and Nilesh Jain. 2024a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2024.naacl-industry.34" title="">Shears: Unstructured sparsity with neural low-rank adapter search</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the 2024 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies (Volume 6: Industry Track)</em>, pages 395–405, Mexico City, Mexico. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munoz et al. (2024b)</span>
<span class="ltx_bibblock">
J. Pablo Munoz, Jinjie Yuan, Yi Zheng, and Nilesh Jain. 2024b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2024.lrec-main.940" title="">LoNAS: Elastic low-rank adapters for efficient large language models</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 2024 Joint International Conference on Computational Linguistics, Language Resources and Evaluation (LREC-COLING 2024)</em>, pages 10760–10776, Torino, Italia. ELRA and ICCL.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nagel et al. (2020)</span>
<span class="ltx_bibblock">
Markus Nagel, Rana Ali Amjad, Mart Van Baalen, Christos Louizos, and Tijmen Blankevoort. 2020.

</span>
<span class="ltx_bibblock">Up or down? adaptive rounding for post-training quantization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 37th International Conference on Machine Learning</em>, ICML’20. JMLR.org.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patel et al. (2021)</span>
<span class="ltx_bibblock">
Arkil Patel, Satwik Bhattamishra, and Navin Goyal. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2021.naacl-main.168" title="">Are NLP models really able to solve simple math word problems?</a>
</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em>, pages 2080–2094, Online. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakaguchi et al. (2021)</span>
<span class="ltx_bibblock">
Keisuke Sakaguchi, Ronan Le Bras, Chandra Bhagavatula, and Yejin Choi. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3474381" title="">Winogrande: An adversarial winograd schema challenge at scale</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Commun. ACM</em>, 64(9):99–106.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2023)</span>
<span class="ltx_bibblock">
Mingjie Sun, Zhuang Liu, Anna Bair, and J. Zico Kolter. 2023.

</span>
<span class="ltx_bibblock">A simple and effective pruning approach for large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2306.11695</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf" title="">Attention is all you need</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Advances in Neural Information Processing Systems</em>, volume 30. Curran Associates, Inc.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Peisong Wang, Qiang Chen, Xiangyu He, and Jian Cheng. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.mlr.press/v119/wang20c.html" title="">Towards accurate post-training network quantization via bit-split and stitching</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 37th International Conference on Machine Learning</em>, volume 119 of <em class="ltx_emph ltx_font_italic" id="bib.bib26.2.2">Proceedings of Machine Learning Research</em>, pages 9847–9856. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2023)</span>
<span class="ltx_bibblock">
Guangxuan Xiao, Ji Lin, Mickael Seznec, Hao Wu, Julien Demouth, and Song Han. 2023.

</span>
<span class="ltx_bibblock">SmoothQuant: Accurate and efficient post-training quantization for large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 40th International Conference on Machine Learning</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2024)</span>
<span class="ltx_bibblock">
Peng Xu, Wenqi Shao, Mengzhao Chen, Shitao Tang, Kaipeng Zhang, Peng Gao, Fengwei An, Yu Qiao, and Ping Luo. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2402.16880" title="">Besa: Pruning large language models with blockwise parameter-efficient sparsity allocation</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Preprint</em>, arXiv:2402.16880.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2022)</span>
<span class="ltx_bibblock">
Zhewei Yao, Reza Yazdani Aminabadi, Minjia Zhang, Xiaoxia Wu, Conglong Li, and Yuxiong He. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper_files/paper/2022/file/adf7fa39d65e2983d724ff7da57f00ac-Paper-Conference.pdf" title="">Zeroquant: Efficient and affordable post-training quantization for large-scale transformers</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems</em>, volume 35, pages 27168–27183. Curran Associates, Inc.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et al. (2019)</span>
<span class="ltx_bibblock">
Rowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi. 2019.

</span>
<span class="ltx_bibblock">Hellaswag: Can a machine really finish your sentence?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Hugh Zhang, Jeff Da, Dean Lee, Vaughn Robinson, Catherine Wu, Will Song, Tiffany Zhao, Pranav Raja, Dylan Slack, Qin Lyu, Sean Hendryx, Russell Kaplan, Michele Lunati, and Summer Yue. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2405.00332" title="">A careful examination of large language model performance on grade school arithmetic</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Preprint</em>, arXiv:2405.00332.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023)</span>
<span class="ltx_bibblock">
Mingyang Zhang, Hao Chen, Chunhua Shen, Zhen Yang, Linlin Ou, Xinyi Yu, and Bohan Zhuang. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2305.18403" title="">Loraprune: Pruning meets low-rank parameter-efficient fine-tuning</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Preprint</em>, arXiv:2305.18403.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Related Work</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">Generative pre-trained models, often based on the Transformer architecture <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib25" title="">2017</a>)</cite>, require the application of compression techniques to reduce their significant computational cost and to address challenges, e.g., related to memory bandwidth. Classic compression techniques like pruning and quantization have been adapted for the age of LPMs, removing inefficiencies that cannot be tolerated when dealing with billions of parameters. We discuss them in more detail next.</p>
</div>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Pruning</h5>
<div class="ltx_para" id="A1.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px1.p1.1">Inducing sparsity, either by zeroing out weights or activations or removing network elements, can improve the efficiency of LPMs during inference, provided that they are executed on a runtime that can exploit sparse patterns. Pruning has a long history <cite class="ltx_cite ltx_citemacro_cite">LeCun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib16" title="">1989</a>)</cite>, but with the advent of LPMs, traditional methods<cite class="ltx_cite ltx_citemacro_cite">Hoefler et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib12" title="">2021</a>)</cite>, e.g., Magnitude Pruning <cite class="ltx_cite ltx_citemacro_cite">Hagiwara (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib11" title="">1994</a>)</cite>, have been replaced by new approaches that are suited for the challenges of these models with their large number of parameters. SparseGPT <cite class="ltx_cite ltx_citemacro_cite">Frantar and Alistarh (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib7" title="">2023</a>)</cite> proposes a one-shot pruning method for transformer-based models that trade minimal accuracy drop for increasing sparsity levels. The method approaches LPMs’ pruning layer-wise with an efficient weight reconstruction algorithm that incrementally prunes the weight matrix elements. Wanda <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib24" title="">2023</a>)</cite> proposes a more straightforward approach that does not require weight updates, computing a score using the weight magnitude and the norm of input activations. This approach obtains better results than SparseGPT. Recently, BESA <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib28" title="">2024</a>)</cite> has improved over SparseGPT and Wanda by targeting individual transformer blocks and allocating sparsity per layer using a differentiable method.
These approaches induce sparsity on pre-trained models and are evaluated on zero-shot benchmarks. Our end-to-end solution, SQFT, focuses on further adapting the sparsified models to new tasks or datasets.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Quantization</h5>
<div class="ltx_para" id="A1.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px2.p1.1">With the advent of large pre-trained foundation/frontier models (LPMs), quantization approaches have evolved to address the challenges of scale and memory bandwidth. Due to the high cost of retraining these models to recover accuracy degradation, special consideration has to be taken when incorporating compression techniques, like quantization-aware training in foundation models. Post-training, one-shot quantization methods have prevailed, obtaining quantized versions of large models in hours.
LLM.Int8() was among the first Int8 quantization procedures for large-scale transformer-based PLMs
<cite class="ltx_cite ltx_citemacro_cite">Dettmers et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib5" title="">2022</a>)</cite>. Using vector-wise quantization and mixed-precision decomposition, LLM.Int8() demonstrated that it can effectively confront the outliers that emerge in activations, which makes traditional quantization methods fail in models with more than 6.7B parameters. In a contemporary work, after running thousands of experiments with various large pre-trained models, it was demonstrated that 4-bit parameters can reach optimal performance compared to other bit-precisions in the 3 to 16-bit range <cite class="ltx_cite ltx_citemacro_cite">Dettmers and Zettlemoyer (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib6" title="">2023</a>)</cite>.
ZeroQuant <cite class="ltx_cite ltx_citemacro_cite">Yao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib29" title="">2022</a>)</cite> quantizes GPT-3 models, obtaining a reduction in latency up to 4.16x by utilizing group-wise quantization for weights, token-wise quantization for activations, and layer-by-layer knowledge distillation. SmoothQuant <cite class="ltx_cite ltx_citemacro_cite">Xiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib27" title="">2023</a>)</cite> makes activations easier to quantize by smoothing them and compensating this operation with a transformation of the weights, resulting in improved results over ZeroQuant and LLM.Int8(). GPTQ is another good representative of one-shot quantization approaches designed especially for LPMs <cite class="ltx_cite ltx_citemacro_cite">Frantar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib8" title="">2022a</a>)</cite>. GPTQ builds on the learnings from Optimal Brain Quantization (OBQ) <cite class="ltx_cite ltx_citemacro_cite">Frantar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib9" title="">2022b</a>)</cite> and applies layer-wise quantization to the full-precision weights of a base LPM. We incorporate GPTQ as the default quantization method in SQFT’s pre-fine-tuning stage.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Parameter-efficient Fine-tuning (PEFT)</h5>
<div class="ltx_para" id="A1.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px3.p1.7">Due to their large number of parameters, it is too costly to fine-tune pre-trained large models. Updating all their weights to improve their performance in a downstream task might require devices with large memory capacity. PEFT techniques attempt to address this challenge by avoiding the update of all weights in the pre-trained model. For instance, low-rank (LoRA) adapters <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib13" title="">2022</a>)</cite> use a fraction (often less than 1%) of additional weights to adapt the model to a new task. LoRA adapters, <math alttext="\boldsymbol{B}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="A1.SS0.SSS0.Px3.p1.1.m1.1a"><mi id="A1.SS0.SSS0.Px3.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="A1.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.1.m1.1c">\boldsymbol{B}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.1.m1.1d">bold_italic_B</annotation></semantics></math> and <math alttext="\boldsymbol{A}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.2.m2.1"><semantics id="A1.SS0.SSS0.Px3.p1.2.m2.1a"><mi id="A1.SS0.SSS0.Px3.p1.2.m2.1.1" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1.cmml">𝑨</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.2.m2.1b"><ci id="A1.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1">𝑨</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.2.m2.1c">\boldsymbol{A}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.2.m2.1d">bold_italic_A</annotation></semantics></math>, are utilized to reparameterize a linear projection, <math alttext="\boldsymbol{Y}=\boldsymbol{WX}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.3.m3.1"><semantics id="A1.SS0.SSS0.Px3.p1.3.m3.1a"><mrow id="A1.SS0.SSS0.Px3.p1.3.m3.1.1" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">𝒀</mi><mo id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.1" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml">=</mo><mrow id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml"><mi id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml">𝑾</mi><mo id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.1" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.3" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.3.cmml">𝑿</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1"><eq id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.1"></eq><ci id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.2">𝒀</ci><apply id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3"><times id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.1"></times><ci id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.2">𝑾</ci><ci id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.3.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.3">𝑿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.3.m3.1c">\boldsymbol{Y}=\boldsymbol{WX}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.3.m3.1d">bold_italic_Y = bold_italic_W bold_italic_X</annotation></semantics></math>, keeping the weights, <math alttext="\boldsymbol{W}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.4.m4.1"><semantics id="A1.SS0.SSS0.Px3.p1.4.m4.1a"><mi id="A1.SS0.SSS0.Px3.p1.4.m4.1.1" xref="A1.SS0.SSS0.Px3.p1.4.m4.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.4.m4.1b"><ci id="A1.SS0.SSS0.Px3.p1.4.m4.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.4.m4.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.4.m4.1c">\boldsymbol{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.4.m4.1d">bold_italic_W</annotation></semantics></math>, frozen and updating only the low-rank adapter matrices, <math alttext="\boldsymbol{A}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.5.m5.1"><semantics id="A1.SS0.SSS0.Px3.p1.5.m5.1a"><mi id="A1.SS0.SSS0.Px3.p1.5.m5.1.1" xref="A1.SS0.SSS0.Px3.p1.5.m5.1.1.cmml">𝑨</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.5.m5.1b"><ci id="A1.SS0.SSS0.Px3.p1.5.m5.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.5.m5.1.1">𝑨</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.5.m5.1c">\boldsymbol{A}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.5.m5.1d">bold_italic_A</annotation></semantics></math> and <math alttext="\boldsymbol{B}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.6.m6.1"><semantics id="A1.SS0.SSS0.Px3.p1.6.m6.1a"><mi id="A1.SS0.SSS0.Px3.p1.6.m6.1.1" xref="A1.SS0.SSS0.Px3.p1.6.m6.1.1.cmml">𝑩</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.6.m6.1b"><ci id="A1.SS0.SSS0.Px3.p1.6.m6.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.6.m6.1.1">𝑩</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.6.m6.1c">\boldsymbol{B}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.6.m6.1d">bold_italic_B</annotation></semantics></math>, i.e., <math alttext="\boldsymbol{Y}=\boldsymbol{WX}+\boldsymbol{BAX}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.7.m7.1"><semantics id="A1.SS0.SSS0.Px3.p1.7.m7.1a"><mrow id="A1.SS0.SSS0.Px3.p1.7.m7.1.1" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.cmml"><mi id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.2" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.2.cmml">𝒀</mi><mo id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.1" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.1.cmml">=</mo><mrow id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.cmml"><mrow id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.cmml"><mi id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.2" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.2.cmml">𝑾</mi><mo id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.1" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.1.cmml">⁢</mo><mi id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.3" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.3.cmml">𝑿</mi></mrow><mo id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.1" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.1.cmml">+</mo><mrow id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.cmml"><mi id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.2" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.2.cmml">𝑩</mi><mo id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.1" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.3" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.3.cmml">𝑨</mi><mo id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.1a" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.4" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.4.cmml">𝑿</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.7.m7.1b"><apply id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1"><eq id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.1"></eq><ci id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.2.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.2">𝒀</ci><apply id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3"><plus id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.1.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.1"></plus><apply id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2"><times id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.1.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.1"></times><ci id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.2.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.2">𝑾</ci><ci id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.3.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.2.3">𝑿</ci></apply><apply id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3"><times id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.1.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.1"></times><ci id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.2.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.2">𝑩</ci><ci id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.3.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.3">𝑨</ci><ci id="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.4.cmml" xref="A1.SS0.SSS0.Px3.p1.7.m7.1.1.3.3.4">𝑿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.7.m7.1c">\boldsymbol{Y}=\boldsymbol{WX}+\boldsymbol{BAX}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.7.m7.1d">bold_italic_Y = bold_italic_W bold_italic_X + bold_italic_B bold_italic_A bold_italic_X</annotation></semantics></math>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Hill-climbing Subnetwork Search</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="algx1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>Number of turns <math alttext="T" class="ltx_Math" display="inline" id="algx1.l1.m1.1"><semantics id="algx1.l1.m1.1a"><mi id="algx1.l1.m1.1.1" xref="algx1.l1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m1.1b"><ci id="algx1.l1.m1.1.1.cmml" xref="algx1.l1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m1.1d">italic_T</annotation></semantics></math>, Number of neighbors <math alttext="N" class="ltx_Math" display="inline" id="algx1.l1.m2.1"><semantics id="algx1.l1.m2.1a"><mi id="algx1.l1.m2.1.1" xref="algx1.l1.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m2.1b"><ci id="algx1.l1.m2.1.1.cmml" xref="algx1.l1.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m2.1d">italic_N</annotation></semantics></math>, Neighbor step size <math alttext="S" class="ltx_Math" display="inline" id="algx1.l1.m3.1"><semantics id="algx1.l1.m3.1a"><mi id="algx1.l1.m3.1.1" xref="algx1.l1.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m3.1b"><ci id="algx1.l1.m3.1.1.cmml" xref="algx1.l1.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m3.1d">italic_S</annotation></semantics></math>, Number of evaluation samples <math alttext="M" class="ltx_Math" display="inline" id="algx1.l1.m4.1"><semantics id="algx1.l1.m4.1a"><mi id="algx1.l1.m4.1.1" xref="algx1.l1.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m4.1b"><ci id="algx1.l1.m4.1.1.cmml" xref="algx1.l1.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m4.1d">italic_M</annotation></semantics></math>, Heuristic configuration <math alttext="c_{h}" class="ltx_Math" display="inline" id="algx1.l1.m5.1"><semantics id="algx1.l1.m5.1a"><msub id="algx1.l1.m5.1.1" xref="algx1.l1.m5.1.1.cmml"><mi id="algx1.l1.m5.1.1.2" xref="algx1.l1.m5.1.1.2.cmml">c</mi><mi id="algx1.l1.m5.1.1.3" xref="algx1.l1.m5.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l1.m5.1b"><apply id="algx1.l1.m5.1.1.cmml" xref="algx1.l1.m5.1.1"><csymbol cd="ambiguous" id="algx1.l1.m5.1.1.1.cmml" xref="algx1.l1.m5.1.1">subscript</csymbol><ci id="algx1.l1.m5.1.1.2.cmml" xref="algx1.l1.m5.1.1.2">𝑐</ci><ci id="algx1.l1.m5.1.1.3.cmml" xref="algx1.l1.m5.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m5.1c">c_{h}</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m5.1d">italic_c start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>, Validation dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="algx1.l1.m6.1"><semantics id="algx1.l1.m6.1a"><mi class="ltx_font_mathcaligraphic" id="algx1.l1.m6.1.1" xref="algx1.l1.m6.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m6.1b"><ci id="algx1.l1.m6.1.1.cmml" xref="algx1.l1.m6.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m6.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="algx1.l1.m6.1d">caligraphic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>Optimal configuration <math alttext="c^{*}" class="ltx_Math" display="inline" id="algx1.l2.m1.1"><semantics id="algx1.l2.m1.1a"><msup id="algx1.l2.m1.1.1" xref="algx1.l2.m1.1.1.cmml"><mi id="algx1.l2.m1.1.1.2" xref="algx1.l2.m1.1.1.2.cmml">c</mi><mo id="algx1.l2.m1.1.1.3" xref="algx1.l2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="algx1.l2.m1.1b"><apply id="algx1.l2.m1.1.1.cmml" xref="algx1.l2.m1.1.1"><csymbol cd="ambiguous" id="algx1.l2.m1.1.1.1.cmml" xref="algx1.l2.m1.1.1">superscript</csymbol><ci id="algx1.l2.m1.1.1.2.cmml" xref="algx1.l2.m1.1.1.2">𝑐</ci><times id="algx1.l2.m1.1.1.3.cmml" xref="algx1.l2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l2.m1.1c">c^{*}</annotation><annotation encoding="application/x-llamapun" id="algx1.l2.m1.1d">italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><math alttext="c_{a}\leftarrow c_{h}" class="ltx_Math" display="inline" id="algx1.l3.m1.1"><semantics id="algx1.l3.m1.1a"><mrow id="algx1.l3.m1.1.1" xref="algx1.l3.m1.1.1.cmml"><msub id="algx1.l3.m1.1.1.2" xref="algx1.l3.m1.1.1.2.cmml"><mi id="algx1.l3.m1.1.1.2.2" xref="algx1.l3.m1.1.1.2.2.cmml">c</mi><mi id="algx1.l3.m1.1.1.2.3" xref="algx1.l3.m1.1.1.2.3.cmml">a</mi></msub><mo id="algx1.l3.m1.1.1.1" stretchy="false" xref="algx1.l3.m1.1.1.1.cmml">←</mo><msub id="algx1.l3.m1.1.1.3" xref="algx1.l3.m1.1.1.3.cmml"><mi id="algx1.l3.m1.1.1.3.2" xref="algx1.l3.m1.1.1.3.2.cmml">c</mi><mi id="algx1.l3.m1.1.1.3.3" xref="algx1.l3.m1.1.1.3.3.cmml">h</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx1.l3.m1.1b"><apply id="algx1.l3.m1.1.1.cmml" xref="algx1.l3.m1.1.1"><ci id="algx1.l3.m1.1.1.1.cmml" xref="algx1.l3.m1.1.1.1">←</ci><apply id="algx1.l3.m1.1.1.2.cmml" xref="algx1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l3.m1.1.1.2.1.cmml" xref="algx1.l3.m1.1.1.2">subscript</csymbol><ci id="algx1.l3.m1.1.1.2.2.cmml" xref="algx1.l3.m1.1.1.2.2">𝑐</ci><ci id="algx1.l3.m1.1.1.2.3.cmml" xref="algx1.l3.m1.1.1.2.3">𝑎</ci></apply><apply id="algx1.l3.m1.1.1.3.cmml" xref="algx1.l3.m1.1.1.3"><csymbol cd="ambiguous" id="algx1.l3.m1.1.1.3.1.cmml" xref="algx1.l3.m1.1.1.3">subscript</csymbol><ci id="algx1.l3.m1.1.1.3.2.cmml" xref="algx1.l3.m1.1.1.3.2">𝑐</ci><ci id="algx1.l3.m1.1.1.3.3.cmml" xref="algx1.l3.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m1.1c">c_{a}\leftarrow c_{h}</annotation><annotation encoding="application/x-llamapun" id="algx1.l3.m1.1d">italic_c start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ← italic_c start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="algx1.l3.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="algx1.l3.1.m1.1"><semantics id="algx1.l3.1.m1.1a"><mo id="algx1.l3.1.m1.1.1" xref="algx1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l3.1.m1.1b"><ci id="algx1.l3.1.m1.1.1.cmml" xref="algx1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="algx1.l3.1.m1.1d">▷</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="algx1.l3.1.1">Initialize anchor with the heuristic configuration</span>
</span>
</div>
<div class="ltx_listingline" id="algx1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span><math alttext="V\leftarrow\{c_{h}\}" class="ltx_Math" display="inline" id="algx1.l4.m1.1"><semantics id="algx1.l4.m1.1a"><mrow id="algx1.l4.m1.1.1" xref="algx1.l4.m1.1.1.cmml"><mi id="algx1.l4.m1.1.1.3" xref="algx1.l4.m1.1.1.3.cmml">V</mi><mo id="algx1.l4.m1.1.1.2" stretchy="false" xref="algx1.l4.m1.1.1.2.cmml">←</mo><mrow id="algx1.l4.m1.1.1.1.1" xref="algx1.l4.m1.1.1.1.2.cmml"><mo id="algx1.l4.m1.1.1.1.1.2" stretchy="false" xref="algx1.l4.m1.1.1.1.2.cmml">{</mo><msub id="algx1.l4.m1.1.1.1.1.1" xref="algx1.l4.m1.1.1.1.1.1.cmml"><mi id="algx1.l4.m1.1.1.1.1.1.2" xref="algx1.l4.m1.1.1.1.1.1.2.cmml">c</mi><mi id="algx1.l4.m1.1.1.1.1.1.3" xref="algx1.l4.m1.1.1.1.1.1.3.cmml">h</mi></msub><mo id="algx1.l4.m1.1.1.1.1.3" stretchy="false" xref="algx1.l4.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l4.m1.1b"><apply id="algx1.l4.m1.1.1.cmml" xref="algx1.l4.m1.1.1"><ci id="algx1.l4.m1.1.1.2.cmml" xref="algx1.l4.m1.1.1.2">←</ci><ci id="algx1.l4.m1.1.1.3.cmml" xref="algx1.l4.m1.1.1.3">𝑉</ci><set id="algx1.l4.m1.1.1.1.2.cmml" xref="algx1.l4.m1.1.1.1.1"><apply id="algx1.l4.m1.1.1.1.1.1.cmml" xref="algx1.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l4.m1.1.1.1.1.1.1.cmml" xref="algx1.l4.m1.1.1.1.1.1">subscript</csymbol><ci id="algx1.l4.m1.1.1.1.1.1.2.cmml" xref="algx1.l4.m1.1.1.1.1.1.2">𝑐</ci><ci id="algx1.l4.m1.1.1.1.1.1.3.cmml" xref="algx1.l4.m1.1.1.1.1.1.3">ℎ</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l4.m1.1c">V\leftarrow\{c_{h}\}</annotation><annotation encoding="application/x-llamapun" id="algx1.l4.m1.1d">italic_V ← { italic_c start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT }</annotation></semantics></math> <span class="ltx_text" id="algx1.l4.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="algx1.l4.1.m1.1"><semantics id="algx1.l4.1.m1.1a"><mo id="algx1.l4.1.m1.1.1" xref="algx1.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l4.1.m1.1b"><ci id="algx1.l4.1.m1.1.1.cmml" xref="algx1.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l4.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="algx1.l4.1.m1.1d">▷</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="algx1.l4.1.1">Initialize the set of visited configurations</span>
</span>
</div>
<div class="ltx_listingline" id="algx1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span><math alttext="\mathcal{D}_{M}\leftarrow" class="ltx_Math" display="inline" id="algx1.l5.m1.1"><semantics id="algx1.l5.m1.1a"><mrow id="algx1.l5.m1.1.1" xref="algx1.l5.m1.1.1.cmml"><msub id="algx1.l5.m1.1.1.2" xref="algx1.l5.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l5.m1.1.1.2.2" xref="algx1.l5.m1.1.1.2.2.cmml">𝒟</mi><mi id="algx1.l5.m1.1.1.2.3" xref="algx1.l5.m1.1.1.2.3.cmml">M</mi></msub><mo id="algx1.l5.m1.1.1.1" stretchy="false" xref="algx1.l5.m1.1.1.1.cmml">←</mo><mi id="algx1.l5.m1.1.1.3" xref="algx1.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algx1.l5.m1.1b"><apply id="algx1.l5.m1.1.1.cmml" xref="algx1.l5.m1.1.1"><ci id="algx1.l5.m1.1.1.1.cmml" xref="algx1.l5.m1.1.1.1">←</ci><apply id="algx1.l5.m1.1.1.2.cmml" xref="algx1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l5.m1.1.1.2.1.cmml" xref="algx1.l5.m1.1.1.2">subscript</csymbol><ci id="algx1.l5.m1.1.1.2.2.cmml" xref="algx1.l5.m1.1.1.2.2">𝒟</ci><ci id="algx1.l5.m1.1.1.2.3.cmml" xref="algx1.l5.m1.1.1.2.3">𝑀</ci></apply><csymbol cd="latexml" id="algx1.l5.m1.1.1.3.cmml" xref="algx1.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m1.1c">\mathcal{D}_{M}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algx1.l5.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ←</annotation></semantics></math> Sample(<math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="algx1.l5.m2.1"><semantics id="algx1.l5.m2.1a"><mi class="ltx_font_mathcaligraphic" id="algx1.l5.m2.1.1" xref="algx1.l5.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="algx1.l5.m2.1b"><ci id="algx1.l5.m2.1.1.cmml" xref="algx1.l5.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="algx1.l5.m2.1d">caligraphic_D</annotation></semantics></math>, <math alttext="M" class="ltx_Math" display="inline" id="algx1.l5.m3.1"><semantics id="algx1.l5.m3.1a"><mi id="algx1.l5.m3.1.1" xref="algx1.l5.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algx1.l5.m3.1b"><ci id="algx1.l5.m3.1.1.cmml" xref="algx1.l5.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="algx1.l5.m3.1d">italic_M</annotation></semantics></math>) <span class="ltx_text" id="algx1.l5.3" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="algx1.l5.1.m1.1"><semantics id="algx1.l5.1.m1.1a"><mo id="algx1.l5.1.m1.1.1" xref="algx1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l5.1.m1.1b"><ci id="algx1.l5.1.m1.1.1.cmml" xref="algx1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="algx1.l5.1.m1.1d">▷</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="algx1.l5.3.2">Create a proxy dataset by randomly sampling <math alttext="M" class="ltx_Math" display="inline" id="algx1.l5.2.1.m1.1"><semantics id="algx1.l5.2.1.m1.1a"><mi id="algx1.l5.2.1.m1.1.1" xref="algx1.l5.2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algx1.l5.2.1.m1.1b"><ci id="algx1.l5.2.1.m1.1.1.cmml" xref="algx1.l5.2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.2.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="algx1.l5.2.1.m1.1d">italic_M</annotation></semantics></math> samples from <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="algx1.l5.3.2.m2.1"><semantics id="algx1.l5.3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="algx1.l5.3.2.m2.1.1" xref="algx1.l5.3.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="algx1.l5.3.2.m2.1b"><ci id="algx1.l5.3.2.m2.1.1.cmml" xref="algx1.l5.3.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.3.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="algx1.l5.3.2.m2.1d">caligraphic_D</annotation></semantics></math></span>
</span>
</div>
<div class="ltx_listingline" id="algx1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span><span class="ltx_text ltx_font_bold" id="algx1.l6.1">for</span> <math alttext="t\leftarrow 1" class="ltx_Math" display="inline" id="algx1.l6.m1.1"><semantics id="algx1.l6.m1.1a"><mrow id="algx1.l6.m1.1.1" xref="algx1.l6.m1.1.1.cmml"><mi id="algx1.l6.m1.1.1.2" xref="algx1.l6.m1.1.1.2.cmml">t</mi><mo id="algx1.l6.m1.1.1.1" stretchy="false" xref="algx1.l6.m1.1.1.1.cmml">←</mo><mn id="algx1.l6.m1.1.1.3" xref="algx1.l6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algx1.l6.m1.1b"><apply id="algx1.l6.m1.1.1.cmml" xref="algx1.l6.m1.1.1"><ci id="algx1.l6.m1.1.1.1.cmml" xref="algx1.l6.m1.1.1.1">←</ci><ci id="algx1.l6.m1.1.1.2.cmml" xref="algx1.l6.m1.1.1.2">𝑡</ci><cn id="algx1.l6.m1.1.1.3.cmml" type="integer" xref="algx1.l6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l6.m1.1c">t\leftarrow 1</annotation><annotation encoding="application/x-llamapun" id="algx1.l6.m1.1d">italic_t ← 1</annotation></semantics></math> to <math alttext="T" class="ltx_Math" display="inline" id="algx1.l6.m2.1"><semantics id="algx1.l6.m2.1a"><mi id="algx1.l6.m2.1.1" xref="algx1.l6.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algx1.l6.m2.1b"><ci id="algx1.l6.m2.1.1.cmml" xref="algx1.l6.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l6.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="algx1.l6.m2.1d">italic_T</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="algx1.l6.2">do</span>
</div>
<div class="ltx_listingline" id="algx1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math alttext="\mathcal{C}\leftarrow" class="ltx_Math" display="inline" id="algx1.l7.m1.1"><semantics id="algx1.l7.m1.1a"><mrow id="algx1.l7.m1.1.1" xref="algx1.l7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l7.m1.1.1.2" xref="algx1.l7.m1.1.1.2.cmml">𝒞</mi><mo id="algx1.l7.m1.1.1.1" stretchy="false" xref="algx1.l7.m1.1.1.1.cmml">←</mo><mi id="algx1.l7.m1.1.1.3" xref="algx1.l7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algx1.l7.m1.1b"><apply id="algx1.l7.m1.1.1.cmml" xref="algx1.l7.m1.1.1"><ci id="algx1.l7.m1.1.1.1.cmml" xref="algx1.l7.m1.1.1.1">←</ci><ci id="algx1.l7.m1.1.1.2.cmml" xref="algx1.l7.m1.1.1.2">𝒞</ci><csymbol cd="latexml" id="algx1.l7.m1.1.1.3.cmml" xref="algx1.l7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m1.1c">\mathcal{C}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.m1.1d">caligraphic_C ←</annotation></semantics></math> Neighbor-sample(<math alttext="c_{a}" class="ltx_Math" display="inline" id="algx1.l7.m2.1"><semantics id="algx1.l7.m2.1a"><msub id="algx1.l7.m2.1.1" xref="algx1.l7.m2.1.1.cmml"><mi id="algx1.l7.m2.1.1.2" xref="algx1.l7.m2.1.1.2.cmml">c</mi><mi id="algx1.l7.m2.1.1.3" xref="algx1.l7.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l7.m2.1b"><apply id="algx1.l7.m2.1.1.cmml" xref="algx1.l7.m2.1.1"><csymbol cd="ambiguous" id="algx1.l7.m2.1.1.1.cmml" xref="algx1.l7.m2.1.1">subscript</csymbol><ci id="algx1.l7.m2.1.1.2.cmml" xref="algx1.l7.m2.1.1.2">𝑐</ci><ci id="algx1.l7.m2.1.1.3.cmml" xref="algx1.l7.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m2.1c">c_{a}</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.m2.1d">italic_c start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="N" class="ltx_Math" display="inline" id="algx1.l7.m3.1"><semantics id="algx1.l7.m3.1a"><mi id="algx1.l7.m3.1.1" xref="algx1.l7.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algx1.l7.m3.1b"><ci id="algx1.l7.m3.1.1.cmml" xref="algx1.l7.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.m3.1d">italic_N</annotation></semantics></math>, <math alttext="S" class="ltx_Math" display="inline" id="algx1.l7.m4.1"><semantics id="algx1.l7.m4.1a"><mi id="algx1.l7.m4.1.1" xref="algx1.l7.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algx1.l7.m4.1b"><ci id="algx1.l7.m4.1.1.cmml" xref="algx1.l7.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.m4.1d">italic_S</annotation></semantics></math>) - <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="algx1.l7.m5.1"><semantics id="algx1.l7.m5.1a"><mi class="ltx_font_mathcaligraphic" id="algx1.l7.m5.1.1" xref="algx1.l7.m5.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="algx1.l7.m5.1b"><ci id="algx1.l7.m5.1.1.cmml" xref="algx1.l7.m5.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m5.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.m5.1d">caligraphic_V</annotation></semantics></math> <span class="ltx_text" id="algx1.l7.3" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="algx1.l7.1.m1.1"><semantics id="algx1.l7.1.m1.1a"><mo id="algx1.l7.1.m1.1.1" xref="algx1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l7.1.m1.1b"><ci id="algx1.l7.1.m1.1.1.cmml" xref="algx1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.1.m1.1d">▷</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="algx1.l7.3.2">Sample <math alttext="N" class="ltx_Math" display="inline" id="algx1.l7.2.1.m1.1"><semantics id="algx1.l7.2.1.m1.1a"><mi id="algx1.l7.2.1.m1.1.1" xref="algx1.l7.2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algx1.l7.2.1.m1.1b"><ci id="algx1.l7.2.1.m1.1.1.cmml" xref="algx1.l7.2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.2.1.m1.1d">italic_N</annotation></semantics></math> unvisited <math alttext="S" class="ltx_Math" display="inline" id="algx1.l7.3.2.m2.1"><semantics id="algx1.l7.3.2.m2.1a"><mi id="algx1.l7.3.2.m2.1.1" xref="algx1.l7.3.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algx1.l7.3.2.m2.1b"><ci id="algx1.l7.3.2.m2.1.1.cmml" xref="algx1.l7.3.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.3.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.3.2.m2.1d">italic_S</annotation></semantics></math>-step neighbor configs</span>
</span>
</div>
<div class="ltx_listingline" id="algx1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math alttext="\mathcal{V}\leftarrow\mathcal{V}\cup\mathcal{C}" class="ltx_Math" display="inline" id="algx1.l8.m1.1"><semantics id="algx1.l8.m1.1a"><mrow id="algx1.l8.m1.1.1" xref="algx1.l8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l8.m1.1.1.2" xref="algx1.l8.m1.1.1.2.cmml">𝒱</mi><mo id="algx1.l8.m1.1.1.1" stretchy="false" xref="algx1.l8.m1.1.1.1.cmml">←</mo><mrow id="algx1.l8.m1.1.1.3" xref="algx1.l8.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l8.m1.1.1.3.2" xref="algx1.l8.m1.1.1.3.2.cmml">𝒱</mi><mo id="algx1.l8.m1.1.1.3.1" xref="algx1.l8.m1.1.1.3.1.cmml">∪</mo><mi class="ltx_font_mathcaligraphic" id="algx1.l8.m1.1.1.3.3" xref="algx1.l8.m1.1.1.3.3.cmml">𝒞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l8.m1.1b"><apply id="algx1.l8.m1.1.1.cmml" xref="algx1.l8.m1.1.1"><ci id="algx1.l8.m1.1.1.1.cmml" xref="algx1.l8.m1.1.1.1">←</ci><ci id="algx1.l8.m1.1.1.2.cmml" xref="algx1.l8.m1.1.1.2">𝒱</ci><apply id="algx1.l8.m1.1.1.3.cmml" xref="algx1.l8.m1.1.1.3"><union id="algx1.l8.m1.1.1.3.1.cmml" xref="algx1.l8.m1.1.1.3.1"></union><ci id="algx1.l8.m1.1.1.3.2.cmml" xref="algx1.l8.m1.1.1.3.2">𝒱</ci><ci id="algx1.l8.m1.1.1.3.3.cmml" xref="algx1.l8.m1.1.1.3.3">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l8.m1.1c">\mathcal{V}\leftarrow\mathcal{V}\cup\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="algx1.l8.m1.1d">caligraphic_V ← caligraphic_V ∪ caligraphic_C</annotation></semantics></math> <span class="ltx_text" id="algx1.l8.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="algx1.l8.1.m1.1"><semantics id="algx1.l8.1.m1.1a"><mo id="algx1.l8.1.m1.1.1" xref="algx1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l8.1.m1.1b"><ci id="algx1.l8.1.m1.1.1.cmml" xref="algx1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l8.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="algx1.l8.1.m1.1d">▷</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="algx1.l8.1.1">Add the sampled configurations to the set of visited configurations</span>
</span>
</div>
<div class="ltx_listingline" id="algx1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math alttext="c_{m}\leftarrow" class="ltx_Math" display="inline" id="algx1.l9.m1.1"><semantics id="algx1.l9.m1.1a"><mrow id="algx1.l9.m1.1.1" xref="algx1.l9.m1.1.1.cmml"><msub id="algx1.l9.m1.1.1.2" xref="algx1.l9.m1.1.1.2.cmml"><mi id="algx1.l9.m1.1.1.2.2" xref="algx1.l9.m1.1.1.2.2.cmml">c</mi><mi id="algx1.l9.m1.1.1.2.3" xref="algx1.l9.m1.1.1.2.3.cmml">m</mi></msub><mo id="algx1.l9.m1.1.1.1" stretchy="false" xref="algx1.l9.m1.1.1.1.cmml">←</mo><mi id="algx1.l9.m1.1.1.3" xref="algx1.l9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algx1.l9.m1.1b"><apply id="algx1.l9.m1.1.1.cmml" xref="algx1.l9.m1.1.1"><ci id="algx1.l9.m1.1.1.1.cmml" xref="algx1.l9.m1.1.1.1">←</ci><apply id="algx1.l9.m1.1.1.2.cmml" xref="algx1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l9.m1.1.1.2.1.cmml" xref="algx1.l9.m1.1.1.2">subscript</csymbol><ci id="algx1.l9.m1.1.1.2.2.cmml" xref="algx1.l9.m1.1.1.2.2">𝑐</ci><ci id="algx1.l9.m1.1.1.2.3.cmml" xref="algx1.l9.m1.1.1.2.3">𝑚</ci></apply><csymbol cd="latexml" id="algx1.l9.m1.1.1.3.cmml" xref="algx1.l9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.m1.1c">c_{m}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algx1.l9.m1.1d">italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ←</annotation></semantics></math> MaxAcc(Eval(<math alttext="\mathcal{D}_{M}" class="ltx_Math" display="inline" id="algx1.l9.m2.1"><semantics id="algx1.l9.m2.1a"><msub id="algx1.l9.m2.1.1" xref="algx1.l9.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l9.m2.1.1.2" xref="algx1.l9.m2.1.1.2.cmml">𝒟</mi><mi id="algx1.l9.m2.1.1.3" xref="algx1.l9.m2.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l9.m2.1b"><apply id="algx1.l9.m2.1.1.cmml" xref="algx1.l9.m2.1.1"><csymbol cd="ambiguous" id="algx1.l9.m2.1.1.1.cmml" xref="algx1.l9.m2.1.1">subscript</csymbol><ci id="algx1.l9.m2.1.1.2.cmml" xref="algx1.l9.m2.1.1.2">𝒟</ci><ci id="algx1.l9.m2.1.1.3.cmml" xref="algx1.l9.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.m2.1c">\mathcal{D}_{M}</annotation><annotation encoding="application/x-llamapun" id="algx1.l9.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="algx1.l9.m3.1"><semantics id="algx1.l9.m3.1a"><mi class="ltx_font_mathcaligraphic" id="algx1.l9.m3.1.1" xref="algx1.l9.m3.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="algx1.l9.m3.1b"><ci id="algx1.l9.m3.1.1.cmml" xref="algx1.l9.m3.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.m3.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="algx1.l9.m3.1d">caligraphic_C</annotation></semantics></math>)) <span class="ltx_text" id="algx1.l9.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="algx1.l9.1.m1.1"><semantics id="algx1.l9.1.m1.1a"><mo id="algx1.l9.1.m1.1.1" xref="algx1.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l9.1.m1.1b"><ci id="algx1.l9.1.m1.1.1.cmml" xref="algx1.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="algx1.l9.1.m1.1d">▷</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="algx1.l9.1.1">The config with the maximum accuracy on proxy data</span>
</span>
</div>
<div class="ltx_listingline" id="algx1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <span class="ltx_text ltx_font_bold" id="algx1.l10.1">if</span> <math alttext="Acc(c_{m})&gt;Acc(c^{*})" class="ltx_Math" display="inline" id="algx1.l10.m1.2"><semantics id="algx1.l10.m1.2a"><mrow id="algx1.l10.m1.2.2" xref="algx1.l10.m1.2.2.cmml"><mrow id="algx1.l10.m1.1.1.1" xref="algx1.l10.m1.1.1.1.cmml"><mi id="algx1.l10.m1.1.1.1.3" xref="algx1.l10.m1.1.1.1.3.cmml">A</mi><mo id="algx1.l10.m1.1.1.1.2" xref="algx1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="algx1.l10.m1.1.1.1.4" xref="algx1.l10.m1.1.1.1.4.cmml">c</mi><mo id="algx1.l10.m1.1.1.1.2a" xref="algx1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="algx1.l10.m1.1.1.1.5" xref="algx1.l10.m1.1.1.1.5.cmml">c</mi><mo id="algx1.l10.m1.1.1.1.2b" xref="algx1.l10.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx1.l10.m1.1.1.1.1.1" xref="algx1.l10.m1.1.1.1.1.1.1.cmml"><mo id="algx1.l10.m1.1.1.1.1.1.2" stretchy="false" xref="algx1.l10.m1.1.1.1.1.1.1.cmml">(</mo><msub id="algx1.l10.m1.1.1.1.1.1.1" xref="algx1.l10.m1.1.1.1.1.1.1.cmml"><mi id="algx1.l10.m1.1.1.1.1.1.1.2" xref="algx1.l10.m1.1.1.1.1.1.1.2.cmml">c</mi><mi id="algx1.l10.m1.1.1.1.1.1.1.3" xref="algx1.l10.m1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo id="algx1.l10.m1.1.1.1.1.1.3" stretchy="false" xref="algx1.l10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algx1.l10.m1.2.2.3" xref="algx1.l10.m1.2.2.3.cmml">&gt;</mo><mrow id="algx1.l10.m1.2.2.2" xref="algx1.l10.m1.2.2.2.cmml"><mi id="algx1.l10.m1.2.2.2.3" xref="algx1.l10.m1.2.2.2.3.cmml">A</mi><mo id="algx1.l10.m1.2.2.2.2" xref="algx1.l10.m1.2.2.2.2.cmml">⁢</mo><mi id="algx1.l10.m1.2.2.2.4" xref="algx1.l10.m1.2.2.2.4.cmml">c</mi><mo id="algx1.l10.m1.2.2.2.2a" xref="algx1.l10.m1.2.2.2.2.cmml">⁢</mo><mi id="algx1.l10.m1.2.2.2.5" xref="algx1.l10.m1.2.2.2.5.cmml">c</mi><mo id="algx1.l10.m1.2.2.2.2b" xref="algx1.l10.m1.2.2.2.2.cmml">⁢</mo><mrow id="algx1.l10.m1.2.2.2.1.1" xref="algx1.l10.m1.2.2.2.1.1.1.cmml"><mo id="algx1.l10.m1.2.2.2.1.1.2" stretchy="false" xref="algx1.l10.m1.2.2.2.1.1.1.cmml">(</mo><msup id="algx1.l10.m1.2.2.2.1.1.1" xref="algx1.l10.m1.2.2.2.1.1.1.cmml"><mi id="algx1.l10.m1.2.2.2.1.1.1.2" xref="algx1.l10.m1.2.2.2.1.1.1.2.cmml">c</mi><mo id="algx1.l10.m1.2.2.2.1.1.1.3" xref="algx1.l10.m1.2.2.2.1.1.1.3.cmml">∗</mo></msup><mo id="algx1.l10.m1.2.2.2.1.1.3" stretchy="false" xref="algx1.l10.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l10.m1.2b"><apply id="algx1.l10.m1.2.2.cmml" xref="algx1.l10.m1.2.2"><gt id="algx1.l10.m1.2.2.3.cmml" xref="algx1.l10.m1.2.2.3"></gt><apply id="algx1.l10.m1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1"><times id="algx1.l10.m1.1.1.1.2.cmml" xref="algx1.l10.m1.1.1.1.2"></times><ci id="algx1.l10.m1.1.1.1.3.cmml" xref="algx1.l10.m1.1.1.1.3">𝐴</ci><ci id="algx1.l10.m1.1.1.1.4.cmml" xref="algx1.l10.m1.1.1.1.4">𝑐</ci><ci id="algx1.l10.m1.1.1.1.5.cmml" xref="algx1.l10.m1.1.1.1.5">𝑐</ci><apply id="algx1.l10.m1.1.1.1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l10.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="algx1.l10.m1.1.1.1.1.1.1.2.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.2">𝑐</ci><ci id="algx1.l10.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.3">𝑚</ci></apply></apply><apply id="algx1.l10.m1.2.2.2.cmml" xref="algx1.l10.m1.2.2.2"><times id="algx1.l10.m1.2.2.2.2.cmml" xref="algx1.l10.m1.2.2.2.2"></times><ci id="algx1.l10.m1.2.2.2.3.cmml" xref="algx1.l10.m1.2.2.2.3">𝐴</ci><ci id="algx1.l10.m1.2.2.2.4.cmml" xref="algx1.l10.m1.2.2.2.4">𝑐</ci><ci id="algx1.l10.m1.2.2.2.5.cmml" xref="algx1.l10.m1.2.2.2.5">𝑐</ci><apply id="algx1.l10.m1.2.2.2.1.1.1.cmml" xref="algx1.l10.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="algx1.l10.m1.2.2.2.1.1.1.1.cmml" xref="algx1.l10.m1.2.2.2.1.1">superscript</csymbol><ci id="algx1.l10.m1.2.2.2.1.1.1.2.cmml" xref="algx1.l10.m1.2.2.2.1.1.1.2">𝑐</ci><times id="algx1.l10.m1.2.2.2.1.1.1.3.cmml" xref="algx1.l10.m1.2.2.2.1.1.1.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l10.m1.2c">Acc(c_{m})&gt;Acc(c^{*})</annotation><annotation encoding="application/x-llamapun" id="algx1.l10.m1.2d">italic_A italic_c italic_c ( italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) &gt; italic_A italic_c italic_c ( italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="algx1.l10.2">then</span>
</div>
<div class="ltx_listingline" id="algx1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>         <math alttext="c_{a}\leftarrow c_{m}" class="ltx_Math" display="inline" id="algx1.l11.m1.1"><semantics id="algx1.l11.m1.1a"><mrow id="algx1.l11.m1.1.1" xref="algx1.l11.m1.1.1.cmml"><msub id="algx1.l11.m1.1.1.2" xref="algx1.l11.m1.1.1.2.cmml"><mi id="algx1.l11.m1.1.1.2.2" xref="algx1.l11.m1.1.1.2.2.cmml">c</mi><mi id="algx1.l11.m1.1.1.2.3" xref="algx1.l11.m1.1.1.2.3.cmml">a</mi></msub><mo id="algx1.l11.m1.1.1.1" stretchy="false" xref="algx1.l11.m1.1.1.1.cmml">←</mo><msub id="algx1.l11.m1.1.1.3" xref="algx1.l11.m1.1.1.3.cmml"><mi id="algx1.l11.m1.1.1.3.2" xref="algx1.l11.m1.1.1.3.2.cmml">c</mi><mi id="algx1.l11.m1.1.1.3.3" xref="algx1.l11.m1.1.1.3.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx1.l11.m1.1b"><apply id="algx1.l11.m1.1.1.cmml" xref="algx1.l11.m1.1.1"><ci id="algx1.l11.m1.1.1.1.cmml" xref="algx1.l11.m1.1.1.1">←</ci><apply id="algx1.l11.m1.1.1.2.cmml" xref="algx1.l11.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l11.m1.1.1.2.1.cmml" xref="algx1.l11.m1.1.1.2">subscript</csymbol><ci id="algx1.l11.m1.1.1.2.2.cmml" xref="algx1.l11.m1.1.1.2.2">𝑐</ci><ci id="algx1.l11.m1.1.1.2.3.cmml" xref="algx1.l11.m1.1.1.2.3">𝑎</ci></apply><apply id="algx1.l11.m1.1.1.3.cmml" xref="algx1.l11.m1.1.1.3"><csymbol cd="ambiguous" id="algx1.l11.m1.1.1.3.1.cmml" xref="algx1.l11.m1.1.1.3">subscript</csymbol><ci id="algx1.l11.m1.1.1.3.2.cmml" xref="algx1.l11.m1.1.1.3.2">𝑐</ci><ci id="algx1.l11.m1.1.1.3.3.cmml" xref="algx1.l11.m1.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m1.1c">c_{a}\leftarrow c_{m}</annotation><annotation encoding="application/x-llamapun" id="algx1.l11.m1.1d">italic_c start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ← italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="algx1.l11.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="algx1.l11.1.m1.1"><semantics id="algx1.l11.1.m1.1a"><mo id="algx1.l11.1.m1.1.1" xref="algx1.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l11.1.m1.1b"><ci id="algx1.l11.1.m1.1.1.cmml" xref="algx1.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="algx1.l11.1.m1.1d">▷</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="algx1.l11.1.1">Update anchor configuration if the new configuration has higher accuracy</span>
</span>
</div>
<div class="ltx_listingline" id="algx1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <span class="ltx_text ltx_font_bold" id="algx1.l12.1">end</span> <span class="ltx_text ltx_font_bold" id="algx1.l12.2">if</span>
</div>
<div class="ltx_listingline" id="algx1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span><span class="ltx_text ltx_font_bold" id="algx1.l13.1">end</span> <span class="ltx_text ltx_font_bold" id="algx1.l13.2">for</span>
</div>
<div class="ltx_listingline" id="algx1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span><math alttext="c^{*}\leftarrow c_{a}" class="ltx_Math" display="inline" id="algx1.l14.m1.1"><semantics id="algx1.l14.m1.1a"><mrow id="algx1.l14.m1.1.1" xref="algx1.l14.m1.1.1.cmml"><msup id="algx1.l14.m1.1.1.2" xref="algx1.l14.m1.1.1.2.cmml"><mi id="algx1.l14.m1.1.1.2.2" xref="algx1.l14.m1.1.1.2.2.cmml">c</mi><mo id="algx1.l14.m1.1.1.2.3" xref="algx1.l14.m1.1.1.2.3.cmml">∗</mo></msup><mo id="algx1.l14.m1.1.1.1" stretchy="false" xref="algx1.l14.m1.1.1.1.cmml">←</mo><msub id="algx1.l14.m1.1.1.3" xref="algx1.l14.m1.1.1.3.cmml"><mi id="algx1.l14.m1.1.1.3.2" xref="algx1.l14.m1.1.1.3.2.cmml">c</mi><mi id="algx1.l14.m1.1.1.3.3" xref="algx1.l14.m1.1.1.3.3.cmml">a</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx1.l14.m1.1b"><apply id="algx1.l14.m1.1.1.cmml" xref="algx1.l14.m1.1.1"><ci id="algx1.l14.m1.1.1.1.cmml" xref="algx1.l14.m1.1.1.1">←</ci><apply id="algx1.l14.m1.1.1.2.cmml" xref="algx1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l14.m1.1.1.2.1.cmml" xref="algx1.l14.m1.1.1.2">superscript</csymbol><ci id="algx1.l14.m1.1.1.2.2.cmml" xref="algx1.l14.m1.1.1.2.2">𝑐</ci><times id="algx1.l14.m1.1.1.2.3.cmml" xref="algx1.l14.m1.1.1.2.3"></times></apply><apply id="algx1.l14.m1.1.1.3.cmml" xref="algx1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="algx1.l14.m1.1.1.3.1.cmml" xref="algx1.l14.m1.1.1.3">subscript</csymbol><ci id="algx1.l14.m1.1.1.3.2.cmml" xref="algx1.l14.m1.1.1.3.2">𝑐</ci><ci id="algx1.l14.m1.1.1.3.3.cmml" xref="algx1.l14.m1.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l14.m1.1c">c^{*}\leftarrow c_{a}</annotation><annotation encoding="application/x-llamapun" id="algx1.l14.m1.1d">italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ← italic_c start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text" id="algx1.l14.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="algx1.l14.1.m1.1"><semantics id="algx1.l14.1.m1.1a"><mo id="algx1.l14.1.m1.1.1" xref="algx1.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l14.1.m1.1b"><ci id="algx1.l14.1.m1.1.1.cmml" xref="algx1.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l14.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="algx1.l14.1.m1.1d">▷</annotation></semantics></math> <span class="ltx_text ltx_font_italic" id="algx1.l14.1.1">The optimal configuration is the final anchor configuration</span>
</span>
</div>
<div class="ltx_listingline" id="algx1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span><span class="ltx_text ltx_font_bold" id="algx1.l15.1">return</span> <math alttext="c^{*}" class="ltx_Math" display="inline" id="algx1.l15.m1.1"><semantics id="algx1.l15.m1.1a"><msup id="algx1.l15.m1.1.1" xref="algx1.l15.m1.1.1.cmml"><mi id="algx1.l15.m1.1.1.2" xref="algx1.l15.m1.1.1.2.cmml">c</mi><mo id="algx1.l15.m1.1.1.3" xref="algx1.l15.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="algx1.l15.m1.1b"><apply id="algx1.l15.m1.1.1.cmml" xref="algx1.l15.m1.1.1"><csymbol cd="ambiguous" id="algx1.l15.m1.1.1.1.cmml" xref="algx1.l15.m1.1.1">superscript</csymbol><ci id="algx1.l15.m1.1.1.2.cmml" xref="algx1.l15.m1.1.1.2">𝑐</ci><times id="algx1.l15.m1.1.1.3.cmml" xref="algx1.l15.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l15.m1.1c">c^{*}</annotation><annotation encoding="application/x-llamapun" id="algx1.l15.m1.1d">italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
</div>
</figure>
<div class="ltx_para" id="A1.SS0.SSS0.Px3.p2">
<p class="ltx_p" id="A1.SS0.SSS0.Px3.p2.1">Recently, Shears proposed Neural Low-rank Adapter Search <cite class="ltx_cite ltx_citemacro_cite">Munoz et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib19" title="">2024a</a>)</cite> and demonstrated that LoRA adapters can be made elastic to allow for the application of weight-sharing schemes and keeping the original weights of the model frozen and compressed, e.g., inducing sparsity before the fine-tuning stage. However, a challenge that emerges is that merging the dense adapters with the sparse weights results in the overall loss of sparsity. LoRAPrune has attempted to address this challenge by using the weights and gradients of the LoRA adapters to remove elements in the model’s weights <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#bib.bib32" title="">2023</a>)</cite>. As demonstrated in the main sections of the paper, SQFT proposes an alternative method for merging the dense adapters with a minimal drop in accuracy.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Hyperparameters</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">The hyperparameters used in our main experiments are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A2.T8" title="Table 8 ‣ Appendix B Hyperparameters ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_table" id="A2.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>Hyperparameters used in our experiments. For all approaches with NLS, we explored several manually designed search spaces and identified the optimal configuration for each pipeline. Note that in our experiments involving GSM8K and math instruction tuning, we conducted trials over 3 or 4 epochs and reported the best results achieved. Interestingly, SQFT with QA-SparsePEFT often necessitates extended training periods to exploit its quantization-aware capabilities fully.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T8.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T8.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.1" rowspan="2" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.2" rowspan="2" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.2.1">Task</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.3" rowspan="2" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.3.1">Sparsity</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.4" rowspan="2" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.4.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.5" rowspan="2" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.5.1">Epoch</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.6" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.6.1">Batch</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.7" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.7.1">Learning</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.8" rowspan="2" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.8.1">Adapter rank</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.9" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.9.1">Adapter</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.10" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.10.1">Adapter</span></th>
</tr>
<tr class="ltx_tr" id="A2.T8.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A2.T8.1.2.2.1" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.2.2.1.1">size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A2.T8.1.2.2.2" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.2.2.2.1">rate</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A2.T8.1.2.2.3" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.2.2.3.1">alpha</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A2.T8.1.2.2.4" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.2.2.4.1">target modules</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T8.1.3.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.3.1.1" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.3.1.1.1">Llama-3-8B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.3.1.2" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text" id="A2.T8.1.3.1.2.1">GSM8K</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.3.1.3" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text" id="A2.T8.1.3.1.3.1">50%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.3.1.4" style="padding:1pt 3.0pt;">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.3.1.5" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.3.1.6" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.3.1.7" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.3.1.8" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.3.1.9" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.3.1.10" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.4.2">
<td class="ltx_td ltx_align_left" id="A2.T8.1.4.2.1" style="padding:1pt 3.0pt;">Shears</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.4.2.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.4.2.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.4.2.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.4.2.5" style="padding:1pt 3.0pt;">32,28,24,20,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.4.2.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.4.2.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.5.3">
<td class="ltx_td ltx_align_left" id="A2.T8.1.5.3.1" style="padding:1pt 3.0pt;">SQFT + SparsePEFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.5.3.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.5.3.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.5.3.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.5.3.5" style="padding:1pt 3.0pt;">48,32,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.5.3.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.5.3.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.6.4">
<td class="ltx_td ltx_align_left" id="A2.T8.1.6.4.1" style="padding:1pt 3.0pt;">GPTQ + LoRA</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.6.4.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.6.4.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.6.4.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.6.4.5" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.6.4.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.6.4.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.7.5">
<td class="ltx_td ltx_align_left" id="A2.T8.1.7.5.1" style="padding:1pt 3.0pt;">SQFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.7.5.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.7.5.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.7.5.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.7.5.5" style="padding:1pt 3.0pt;">40,32,24</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.7.5.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.7.5.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.8.6">
<td class="ltx_td ltx_align_left" id="A2.T8.1.8.6.1" style="padding:1pt 3.0pt;">SQFT + QA-SparsePEFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.8.6.2" style="padding:1pt 3.0pt;">4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.8.6.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.8.6.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.8.6.5" style="padding:1pt 3.0pt;">48,32,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.8.6.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.8.6.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.9.7">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.9.7.1" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.9.7.1.1">Mistral-7B-v0.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.9.7.2" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text" id="A2.T8.1.9.7.2.1">GSM8K</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.9.7.3" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text" id="A2.T8.1.9.7.3.1">50%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.9.7.4" style="padding:1pt 3.0pt;">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.9.7.5" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.9.7.6" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.9.7.7" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.9.7.8" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.9.7.9" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.9.7.10" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.10.8">
<td class="ltx_td ltx_align_left" id="A2.T8.1.10.8.1" style="padding:1pt 3.0pt;">Shears</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.10.8.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.10.8.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.10.8.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.10.8.5" style="padding:1pt 3.0pt;">32,28,24,20,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.10.8.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.10.8.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.11.9">
<td class="ltx_td ltx_align_left" id="A2.T8.1.11.9.1" style="padding:1pt 3.0pt;">SQFT + SparsePEFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.11.9.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.11.9.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.11.9.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.11.9.5" style="padding:1pt 3.0pt;">32,28,24,20,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.11.9.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.11.9.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.12.10">
<td class="ltx_td ltx_align_left" id="A2.T8.1.12.10.1" style="padding:1pt 3.0pt;">GPTQ + LoRA</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.12.10.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.12.10.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.12.10.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.12.10.5" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.12.10.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.12.10.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.13.11">
<td class="ltx_td ltx_align_left" id="A2.T8.1.13.11.1" style="padding:1pt 3.0pt;">SQFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.13.11.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.13.11.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.13.11.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.13.11.5" style="padding:1pt 3.0pt;">32,28,24,20,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.13.11.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.13.11.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.14.12">
<td class="ltx_td ltx_align_left" id="A2.T8.1.14.12.1" style="padding:1pt 3.0pt;">SQFT + QA-SparsePEFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.14.12.2" style="padding:1pt 3.0pt;">4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.14.12.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.14.12.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.14.12.5" style="padding:1pt 3.0pt;">32,28,24,20,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.14.12.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.14.12.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.15.13">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.15.13.1" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.15.13.1.1">Mistral-7B-v0.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.15.13.2" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text" id="A2.T8.1.15.13.2.1">Math</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.15.13.3" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text" id="A2.T8.1.15.13.3.1">50%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.15.13.4" style="padding:1pt 3.0pt;">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.15.13.5" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.15.13.6" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.15.13.7" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.15.13.8" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.15.13.9" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.15.13.10" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.16.14">
<td class="ltx_td ltx_align_left" id="A2.T8.1.16.14.1" style="padding:1pt 3.0pt;">Shears</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.16.14.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.16.14.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.16.14.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.16.14.5" style="padding:1pt 3.0pt;">32,28,24,20,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.16.14.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.16.14.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.17.15">
<td class="ltx_td ltx_align_left" id="A2.T8.1.17.15.1" style="padding:1pt 3.0pt;">SQFT + SparsePEFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.17.15.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.17.15.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.17.15.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.17.15.5" style="padding:1pt 3.0pt;">32,28,24,20,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.17.15.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.17.15.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.18.16">
<td class="ltx_td ltx_align_left" id="A2.T8.1.18.16.1" style="padding:1pt 3.0pt;">GPTQ + LoRA</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.18.16.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.18.16.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.18.16.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.18.16.5" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.18.16.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.18.16.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.19.17">
<td class="ltx_td ltx_align_left" id="A2.T8.1.19.17.1" style="padding:1pt 3.0pt;">SQFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.19.17.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.19.17.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.19.17.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.19.17.5" style="padding:1pt 3.0pt;">32,28,24,20,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.19.17.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.19.17.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.20.18">
<td class="ltx_td ltx_align_left" id="A2.T8.1.20.18.1" style="padding:1pt 3.0pt;">SQFT + QA-SparsePEFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.20.18.2" style="padding:1pt 3.0pt;">4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.20.18.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.20.18.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.20.18.5" style="padding:1pt 3.0pt;">32,28,24,20,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.20.18.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.20.18.7" style="padding:1pt 3.0pt;">Q, K, V, Up, Down</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.21.19">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.21.19.1" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.21.19.1.1">Phi-3-Mini-4K-Instruct</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.21.19.2" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text" id="A2.T8.1.21.19.2.1">Math</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.21.19.3" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text" id="A2.T8.1.21.19.3.1">50%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.21.19.4" style="padding:1pt 3.0pt;">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.21.19.5" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.21.19.6" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.21.19.7" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.21.19.8" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.21.19.9" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.21.19.10" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.22.20">
<td class="ltx_td ltx_align_left" id="A2.T8.1.22.20.1" style="padding:1pt 3.0pt;">Shears</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.22.20.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.22.20.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.22.20.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.22.20.5" style="padding:1pt 3.0pt;">48,40,32,24,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.22.20.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.22.20.7" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.23.21">
<td class="ltx_td ltx_align_left" id="A2.T8.1.23.21.1" style="padding:1pt 3.0pt;">SQFT + SparsePEFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.23.21.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.23.21.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.23.21.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.23.21.5" style="padding:1pt 3.0pt;">48,32,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.23.21.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.23.21.7" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.24.22">
<td class="ltx_td ltx_align_left" id="A2.T8.1.24.22.1" style="padding:1pt 3.0pt;">GPTQ + LoRA</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.24.22.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.24.22.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.24.22.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.24.22.5" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.24.22.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.24.22.7" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.25.23">
<td class="ltx_td ltx_align_left" id="A2.T8.1.25.23.1" style="padding:1pt 3.0pt;">SQFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.25.23.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.25.23.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.25.23.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.25.23.5" style="padding:1pt 3.0pt;">32,28,24,20,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.25.23.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.25.23.7" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.26.24">
<td class="ltx_td ltx_align_left" id="A2.T8.1.26.24.1" style="padding:1pt 3.0pt;">SQFT + QA-SparsePEFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.26.24.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.26.24.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.26.24.4" style="padding:1pt 3.0pt;">3e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.26.24.5" style="padding:1pt 3.0pt;">48,32,16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.26.24.6" style="padding:1pt 3.0pt;">64</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.26.24.7" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.27.25">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A2.T8.1.27.25.1" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.27.25.1.1">Phi-3-Mini-4K-Instruct</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A2.T8.1.27.25.2" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text" id="A2.T8.1.27.25.2.1">CS</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A2.T8.1.27.25.3" rowspan="6" style="padding:1pt 3.0pt;"><span class="ltx_text" id="A2.T8.1.27.25.3.1">50%</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.27.25.4" style="padding:1pt 3.0pt;">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.27.25.5" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.27.25.6" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.27.25.7" style="padding:1pt 3.0pt;">1e-4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.27.25.8" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.27.25.9" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.1.27.25.10" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.28.26">
<td class="ltx_td ltx_align_left" id="A2.T8.1.28.26.1" style="padding:1pt 3.0pt;">Shears</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.28.26.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.28.26.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.28.26.4" style="padding:1pt 3.0pt;">1e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.28.26.5" style="padding:1pt 3.0pt;">16,12,8</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.28.26.6" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.28.26.7" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.29.27">
<td class="ltx_td ltx_align_left" id="A2.T8.1.29.27.1" style="padding:1pt 3.0pt;">SQFT + SparsePEFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.29.27.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.29.27.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.29.27.4" style="padding:1pt 3.0pt;">1e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.29.27.5" style="padding:1pt 3.0pt;">16,12,8</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.29.27.6" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.29.27.7" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.30.28">
<td class="ltx_td ltx_align_left" id="A2.T8.1.30.28.1" style="padding:1pt 3.0pt;">GPTQ + LoRA</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.30.28.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.30.28.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.30.28.4" style="padding:1pt 3.0pt;">1e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.30.28.5" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.30.28.6" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.30.28.7" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.31.29">
<td class="ltx_td ltx_align_left" id="A2.T8.1.31.29.1" style="padding:1pt 3.0pt;">SQFT</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.31.29.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.31.29.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.31.29.4" style="padding:1pt 3.0pt;">1e-4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.31.29.5" style="padding:1pt 3.0pt;">16,12,8</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.31.29.6" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.31.29.7" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.32.30">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T8.1.32.30.1" style="padding:1pt 3.0pt;">SQFT + QA-SparsePEFT</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.32.30.2" style="padding:1pt 3.0pt;">3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.32.30.3" style="padding:1pt 3.0pt;">16</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.32.30.4" style="padding:1pt 3.0pt;">1e-4</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.32.30.5" style="padding:1pt 3.0pt;">16,12,8</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.32.30.6" style="padding:1pt 3.0pt;">32</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.32.30.7" style="padding:1pt 3.0pt;">Qkv</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Hill-climbing search algorithm</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">We propose Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#alg1" title="Algorithm 1 ‣ Parameter-efficient Fine-tuning (PEFT) ‣ Appendix A Related Work ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">1</span></a> to start from the reference configuration (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.SS1" title="3.1 Setup ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">3.1</span></a>) and systematically explore its neighbors. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#S3.T4" title="Table 4 ‣ 3.2.3 Fine-tuning on Commonsense Reasoning ‣ 3.2 Main Results ‣ 3 Experimental Results ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">4</span></a> in the main paper shows the benefits of using any available budget to execute this algorithm and discover better-performing models.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Additional Sparsity Levels and Ablation Studies for Llama-3 on GSM8K</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">We conducted additional experiments and ablations studies with different sparsity levels and compared the underlying NLS approach to LoRA. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A4.T9" title="Table 9 ‣ Appendix D Additional Sparsity Levels and Ablation Studies for Llama-3 on GSM8K ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">9</span></a> shows that up to high sparsity levels, SQFT delivers high-performing models.</p>
</div>
<figure class="ltx_table" id="A4.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span>Ablation studies for various sparsity levels (<span class="ltx_text ltx_font_bold" id="A4.T9.24.1">Llama-3-8B</span> with GSM8K).
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T9.22">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T9.22.23.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T9.22.23.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A4.T9.22.23.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T9.22.23.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="A4.T9.22.23.1.2.1">Sparsity</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T9.22.23.1.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="A4.T9.22.23.1.3.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T9.22.23.1.4" rowspan="2"><span class="ltx_text ltx_font_bold" id="A4.T9.22.23.1.4.1">Mergeable</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T9.22.23.1.5"><span class="ltx_text ltx_font_bold" id="A4.T9.22.23.1.5.1">Final Precision</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T9.22.23.1.6"><span class="ltx_text ltx_font_bold" id="A4.T9.22.23.1.6.1">Fine-tune</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T9.22.23.1.7"><span class="ltx_text ltx_font_bold" id="A4.T9.22.23.1.7.1">GSM8K Test</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.24.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A4.T9.22.24.2.1"><span class="ltx_text ltx_font_bold" id="A4.T9.22.24.2.1.1">(Base + Adapter / Base)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A4.T9.22.24.2.2"><span class="ltx_text ltx_font_bold" id="A4.T9.22.24.2.2.1">Approach</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A4.T9.22.24.2.3"><span class="ltx_text ltx_font_bold" id="A4.T9.22.24.2.3.1">Accuracy(%)</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.25.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A4.T9.22.25.3.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A4.T9.22.25.3.1.1">Llama-3-8B</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A4.T9.22.25.3.2">0%</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A4.T9.22.25.3.3">w/o tune</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A4.T9.22.25.3.4">-</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A4.T9.22.25.3.5">FP16</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A4.T9.22.25.3.6">-</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A4.T9.22.25.3.7">50.0</th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.26.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T9.22.26.4.1" rowspan="12"><span class="ltx_text" id="A4.T9.22.26.4.1.1">20%</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T9.22.26.4.2"><span class="ltx_text ltx_font_italic" id="A4.T9.22.26.4.2.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.27.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.27.5.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.27.5.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.27.5.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.27.5.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.27.5.4">FP16</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.27.5.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.27.5.6">47.5</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.28.6">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.28.6.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.28.6.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.28.6.2.1">Shears</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.28.6.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.28.6.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.28.6.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.28.6.4.1">FP16 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.28.6.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.28.6.6">58.7</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.1.1.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.1.1.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T9.1.1.1.1">61.2<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.5}}}" class="ltx_Math" display="inline" id="A4.T9.1.1.1.1.m1.1"><semantics id="A4.T9.1.1.1.1.m1.1a"><msub id="A4.T9.1.1.1.1.m1.1.1" xref="A4.T9.1.1.1.1.m1.1.1.cmml"><mi id="A4.T9.1.1.1.1.m1.1.1a" xref="A4.T9.1.1.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.1.1.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.1.1.1.1.m1.1.1.1a.cmml">+2.5</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.1.1.1.1.m1.1b"><apply id="A4.T9.1.1.1.1.m1.1.1.cmml" xref="A4.T9.1.1.1.1.m1.1.1"><ci id="A4.T9.1.1.1.1.m1.1.1.1a.cmml" xref="A4.T9.1.1.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.1.1.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.1.1.1.1.m1.1.1.1">+2.5</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.1.1.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.5}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.1.1.1.1.m1.1d">start_FLOATSUBSCRIPT +2.5 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.29.7">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.29.7.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.29.7.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.29.7.2.1">SQFT + SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.29.7.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.29.7.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.29.7.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.29.7.4.1">FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.29.7.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.29.7.6">60.3</td>
</tr>
<tr class="ltx_tr" id="A4.T9.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.2.2.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.2.2.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.2.2.1"><span class="ltx_text ltx_font_bold" id="A4.T9.2.2.1.1">62.0<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.7}}}" class="ltx_Math" display="inline" id="A4.T9.2.2.1.1.m1.1"><semantics id="A4.T9.2.2.1.1.m1.1a"><msub id="A4.T9.2.2.1.1.m1.1.1" xref="A4.T9.2.2.1.1.m1.1.1.cmml"><mi id="A4.T9.2.2.1.1.m1.1.1a" xref="A4.T9.2.2.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.2.2.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.2.2.1.1.m1.1.1.1a.cmml">+1.7</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.2.2.1.1.m1.1b"><apply id="A4.T9.2.2.1.1.m1.1.1.cmml" xref="A4.T9.2.2.1.1.m1.1.1"><ci id="A4.T9.2.2.1.1.m1.1.1.1a.cmml" xref="A4.T9.2.2.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.2.2.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.2.2.1.1.m1.1.1.1">+1.7</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.2.2.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.7}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.2.2.1.1.m1.1d">start_FLOATSUBSCRIPT +1.7 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.30.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.30.8.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.30.8.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="5" id="A4.T9.22.30.8.2"><span class="ltx_text ltx_font_italic" id="A4.T9.22.30.8.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.31.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.31.9.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.31.9.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.31.9.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.31.9.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.31.9.4">INT4</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.31.9.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.31.9.6">36.6</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.32.10">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.32.10.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.32.10.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.32.10.2.1">SQFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.32.10.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.32.10.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.32.10.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.32.10.4.1">INT4 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.32.10.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.32.10.6">57.8</td>
</tr>
<tr class="ltx_tr" id="A4.T9.3.3">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.3.3.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.3.3.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.3.3.1"><span class="ltx_text ltx_font_bold" id="A4.T9.3.3.1.1">60.0<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.2}}}" class="ltx_Math" display="inline" id="A4.T9.3.3.1.1.m1.1"><semantics id="A4.T9.3.3.1.1.m1.1a"><msub id="A4.T9.3.3.1.1.m1.1.1" xref="A4.T9.3.3.1.1.m1.1.1.cmml"><mi id="A4.T9.3.3.1.1.m1.1.1a" xref="A4.T9.3.3.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.3.3.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.3.3.1.1.m1.1.1.1a.cmml">+2.2</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.3.3.1.1.m1.1b"><apply id="A4.T9.3.3.1.1.m1.1.1.cmml" xref="A4.T9.3.3.1.1.m1.1.1"><ci id="A4.T9.3.3.1.1.m1.1.1.1a.cmml" xref="A4.T9.3.3.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.3.3.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.3.3.1.1.m1.1.1.1">+2.2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.3.3.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.2}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.3.3.1.1.m1.1d">start_FLOATSUBSCRIPT +2.2 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.33.11">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.33.11.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.33.11.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.33.11.2.1">SQFT + QA-SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.33.11.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.33.11.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.33.11.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.33.11.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.33.11.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.33.11.6">54.7</td>
</tr>
<tr class="ltx_tr" id="A4.T9.4.4">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.4.4.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.4.4.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.4.4.1"><span class="ltx_text ltx_font_bold" id="A4.T9.4.4.1.1">55.6<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.9}}}" class="ltx_Math" display="inline" id="A4.T9.4.4.1.1.m1.1"><semantics id="A4.T9.4.4.1.1.m1.1a"><msub id="A4.T9.4.4.1.1.m1.1.1" xref="A4.T9.4.4.1.1.m1.1.1.cmml"><mi id="A4.T9.4.4.1.1.m1.1.1a" xref="A4.T9.4.4.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.4.4.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.4.4.1.1.m1.1.1.1a.cmml">+0.9</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.4.4.1.1.m1.1b"><apply id="A4.T9.4.4.1.1.m1.1.1.cmml" xref="A4.T9.4.4.1.1.m1.1.1"><ci id="A4.T9.4.4.1.1.m1.1.1.1a.cmml" xref="A4.T9.4.4.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.4.4.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.4.4.1.1.m1.1.1.1">+0.9</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.4.4.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.9}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.4.4.1.1.m1.1d">start_FLOATSUBSCRIPT +0.9 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.34.12">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.34.12.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T9.22.34.12.2" rowspan="12"><span class="ltx_text" id="A4.T9.22.34.12.2.1">30%</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T9.22.34.12.3"><span class="ltx_text ltx_font_italic" id="A4.T9.22.34.12.3.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.35.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.35.13.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.35.13.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.35.13.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.35.13.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.35.13.4">FP16</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.35.13.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.35.13.6">40.9</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.36.14">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.36.14.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.36.14.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.36.14.2.1">Shears</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.36.14.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.36.14.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.36.14.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.36.14.4.1">FP16 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.36.14.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.36.14.6">58.2</td>
</tr>
<tr class="ltx_tr" id="A4.T9.5.5">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.5.5.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.5.5.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.5.5.1"><span class="ltx_text ltx_font_bold" id="A4.T9.5.5.1.1">59.8<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.6}}}" class="ltx_Math" display="inline" id="A4.T9.5.5.1.1.m1.1"><semantics id="A4.T9.5.5.1.1.m1.1a"><msub id="A4.T9.5.5.1.1.m1.1.1" xref="A4.T9.5.5.1.1.m1.1.1.cmml"><mi id="A4.T9.5.5.1.1.m1.1.1a" xref="A4.T9.5.5.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.5.5.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.5.5.1.1.m1.1.1.1a.cmml">+1.6</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.5.5.1.1.m1.1b"><apply id="A4.T9.5.5.1.1.m1.1.1.cmml" xref="A4.T9.5.5.1.1.m1.1.1"><ci id="A4.T9.5.5.1.1.m1.1.1.1a.cmml" xref="A4.T9.5.5.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.5.5.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.5.5.1.1.m1.1.1.1">+1.6</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.5.5.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.6}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.5.5.1.1.m1.1d">start_FLOATSUBSCRIPT +1.6 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.37.15">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.37.15.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.37.15.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.37.15.2.1">SQFT + SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.37.15.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.37.15.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.37.15.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.37.15.4.1">FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.37.15.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.37.15.6">60.0</td>
</tr>
<tr class="ltx_tr" id="A4.T9.6.6">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.6.6.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.6.6.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.6.6.1"><span class="ltx_text ltx_font_bold" id="A4.T9.6.6.1.1">61.2<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.2}}}" class="ltx_Math" display="inline" id="A4.T9.6.6.1.1.m1.1"><semantics id="A4.T9.6.6.1.1.m1.1a"><msub id="A4.T9.6.6.1.1.m1.1.1" xref="A4.T9.6.6.1.1.m1.1.1.cmml"><mi id="A4.T9.6.6.1.1.m1.1.1a" xref="A4.T9.6.6.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.6.6.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.6.6.1.1.m1.1.1.1a.cmml">+1.2</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.6.6.1.1.m1.1b"><apply id="A4.T9.6.6.1.1.m1.1.1.cmml" xref="A4.T9.6.6.1.1.m1.1.1"><ci id="A4.T9.6.6.1.1.m1.1.1.1a.cmml" xref="A4.T9.6.6.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.6.6.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.6.6.1.1.m1.1.1.1">+1.2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.6.6.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.2}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.6.6.1.1.m1.1d">start_FLOATSUBSCRIPT +1.2 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.38.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.38.16.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.38.16.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="5" id="A4.T9.22.38.16.2"><span class="ltx_text ltx_font_italic" id="A4.T9.22.38.16.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.39.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.39.17.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.39.17.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.39.17.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.39.17.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.39.17.4">INT4</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.39.17.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.39.17.6">30.3</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.40.18">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.40.18.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.40.18.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.40.18.2.1">SQFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.40.18.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.40.18.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.40.18.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.40.18.4.1">INT4 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.40.18.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.40.18.6">56.7</td>
</tr>
<tr class="ltx_tr" id="A4.T9.7.7">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.7.7.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.7.7.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.7.7.1"><span class="ltx_text ltx_font_bold" id="A4.T9.7.7.1.1">57.6<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.9}}}" class="ltx_Math" display="inline" id="A4.T9.7.7.1.1.m1.1"><semantics id="A4.T9.7.7.1.1.m1.1a"><msub id="A4.T9.7.7.1.1.m1.1.1" xref="A4.T9.7.7.1.1.m1.1.1.cmml"><mi id="A4.T9.7.7.1.1.m1.1.1a" xref="A4.T9.7.7.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.7.7.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.7.7.1.1.m1.1.1.1a.cmml">+0.9</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.7.7.1.1.m1.1b"><apply id="A4.T9.7.7.1.1.m1.1.1.cmml" xref="A4.T9.7.7.1.1.m1.1.1"><ci id="A4.T9.7.7.1.1.m1.1.1.1a.cmml" xref="A4.T9.7.7.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.7.7.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.7.7.1.1.m1.1.1.1">+0.9</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.7.7.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.9}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.7.7.1.1.m1.1d">start_FLOATSUBSCRIPT +0.9 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.41.19">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.41.19.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.41.19.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.41.19.2.1">SQFT + QA-SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.41.19.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.41.19.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.41.19.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.41.19.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.41.19.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.41.19.6">54.8</td>
</tr>
<tr class="ltx_tr" id="A4.T9.8.8">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.8.8.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.8.8.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.8.8.1"><span class="ltx_text ltx_font_bold" id="A4.T9.8.8.1.1">56.0<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.2}}}" class="ltx_Math" display="inline" id="A4.T9.8.8.1.1.m1.1"><semantics id="A4.T9.8.8.1.1.m1.1a"><msub id="A4.T9.8.8.1.1.m1.1.1" xref="A4.T9.8.8.1.1.m1.1.1.cmml"><mi id="A4.T9.8.8.1.1.m1.1.1a" xref="A4.T9.8.8.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.8.8.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.8.8.1.1.m1.1.1.1a.cmml">+1.2</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.8.8.1.1.m1.1b"><apply id="A4.T9.8.8.1.1.m1.1.1.cmml" xref="A4.T9.8.8.1.1.m1.1.1"><ci id="A4.T9.8.8.1.1.m1.1.1.1a.cmml" xref="A4.T9.8.8.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.8.8.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.8.8.1.1.m1.1.1.1">+1.2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.8.8.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.2}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.8.8.1.1.m1.1d">start_FLOATSUBSCRIPT +1.2 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.42.20">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.42.20.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T9.22.42.20.2" rowspan="12"><span class="ltx_text" id="A4.T9.22.42.20.2.1">40%</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T9.22.42.20.3"><span class="ltx_text ltx_font_italic" id="A4.T9.22.42.20.3.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.43.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.43.21.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.43.21.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.43.21.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.43.21.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.43.21.4">FP16</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.43.21.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.43.21.6">31.6</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.44.22">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.44.22.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.44.22.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.44.22.2.1">Shears</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.44.22.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.44.22.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.44.22.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.44.22.4.1">FP16 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.44.22.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.44.22.6">56.9</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.45.23">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.45.23.1"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.45.23.2">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.45.23.3">56.9</td>
</tr>
<tr class="ltx_tr" id="A4.T9.9.9">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.9.9.2"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.9.9.3" rowspan="2"><span class="ltx_text" id="A4.T9.9.9.3.1">SQFT + SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.9.9.4" rowspan="2"><span class="ltx_text" id="A4.T9.9.9.4.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.9.9.5" rowspan="2"><span class="ltx_text" id="A4.T9.9.9.5.1">FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.9.9.6">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.9.9.1"><span class="ltx_text ltx_font_bold" id="A4.T9.9.9.1.1">57.9<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.5}}}" class="ltx_Math" display="inline" id="A4.T9.9.9.1.1.m1.1"><semantics id="A4.T9.9.9.1.1.m1.1a"><msub id="A4.T9.9.9.1.1.m1.1.1" xref="A4.T9.9.9.1.1.m1.1.1.cmml"><mi id="A4.T9.9.9.1.1.m1.1.1a" xref="A4.T9.9.9.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.9.9.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.9.9.1.1.m1.1.1.1a.cmml">+1.5</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.9.9.1.1.m1.1b"><apply id="A4.T9.9.9.1.1.m1.1.1.cmml" xref="A4.T9.9.9.1.1.m1.1.1"><ci id="A4.T9.9.9.1.1.m1.1.1.1a.cmml" xref="A4.T9.9.9.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.9.9.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.9.9.1.1.m1.1.1.1">+1.5</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.9.9.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.5}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.9.9.1.1.m1.1d">start_FLOATSUBSCRIPT +1.5 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.46.24">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.46.24.1"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.46.24.2">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.46.24.3">56.4</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.47.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.47.25.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.47.25.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="5" id="A4.T9.22.47.25.2"><span class="ltx_text ltx_font_italic" id="A4.T9.22.47.25.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.48.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.48.26.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.48.26.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.48.26.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.48.26.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.48.26.4">INT4</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.48.26.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.48.26.6">20.1</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.49.27">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.49.27.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.49.27.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.49.27.2.1">SQFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.49.27.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.49.27.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.49.27.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.49.27.4.1">INT4 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.49.27.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.49.27.6">54.9</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.50.28">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.50.28.1"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.50.28.2">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.50.28.3">54.9</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.51.29">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.51.29.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.51.29.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.51.29.2.1">SQFT + QA-SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.51.29.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.51.29.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.51.29.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.51.29.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.51.29.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.51.29.6">53.4</td>
</tr>
<tr class="ltx_tr" id="A4.T9.10.10">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.10.10.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.10.10.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.10.10.1"><span class="ltx_text ltx_font_bold" id="A4.T9.10.10.1.1">53.7<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.3}}}" class="ltx_Math" display="inline" id="A4.T9.10.10.1.1.m1.1"><semantics id="A4.T9.10.10.1.1.m1.1a"><msub id="A4.T9.10.10.1.1.m1.1.1" xref="A4.T9.10.10.1.1.m1.1.1.cmml"><mi id="A4.T9.10.10.1.1.m1.1.1a" xref="A4.T9.10.10.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.10.10.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.10.10.1.1.m1.1.1.1a.cmml">+0.3</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.10.10.1.1.m1.1b"><apply id="A4.T9.10.10.1.1.m1.1.1.cmml" xref="A4.T9.10.10.1.1.m1.1.1"><ci id="A4.T9.10.10.1.1.m1.1.1.1a.cmml" xref="A4.T9.10.10.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.10.10.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.10.10.1.1.m1.1.1.1">+0.3</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.10.10.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.3}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.10.10.1.1.m1.1d">start_FLOATSUBSCRIPT +0.3 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.52.30">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.52.30.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T9.22.52.30.2" rowspan="12"><span class="ltx_text" id="A4.T9.22.52.30.2.1">50%</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T9.22.52.30.3"><span class="ltx_text ltx_font_italic" id="A4.T9.22.52.30.3.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.53.31">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.53.31.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.53.31.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.53.31.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.53.31.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.53.31.4">FP16</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.53.31.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.53.31.6">12.5</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.54.32">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.54.32.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.54.32.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.54.32.2.1">Shears</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.54.32.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.54.32.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.54.32.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.54.32.4.1">FP16 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.54.32.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.54.32.6">50.6</td>
</tr>
<tr class="ltx_tr" id="A4.T9.11.11">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.11.11.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.11.11.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.11.11.1"><span class="ltx_text ltx_font_bold" id="A4.T9.11.11.1.1">52.2<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.6}}}" class="ltx_Math" display="inline" id="A4.T9.11.11.1.1.m1.1"><semantics id="A4.T9.11.11.1.1.m1.1a"><msub id="A4.T9.11.11.1.1.m1.1.1" xref="A4.T9.11.11.1.1.m1.1.1.cmml"><mi id="A4.T9.11.11.1.1.m1.1.1a" xref="A4.T9.11.11.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.11.11.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.11.11.1.1.m1.1.1.1a.cmml">+1.6</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.11.11.1.1.m1.1b"><apply id="A4.T9.11.11.1.1.m1.1.1.cmml" xref="A4.T9.11.11.1.1.m1.1.1"><ci id="A4.T9.11.11.1.1.m1.1.1.1a.cmml" xref="A4.T9.11.11.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.11.11.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.11.11.1.1.m1.1.1.1">+1.6</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.11.11.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.6}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.11.11.1.1.m1.1d">start_FLOATSUBSCRIPT +1.6 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.55.33">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.55.33.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.55.33.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.55.33.2.1">SQFT + SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.55.33.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.55.33.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.55.33.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.55.33.4.1">FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.55.33.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.55.33.6">50.6</td>
</tr>
<tr class="ltx_tr" id="A4.T9.12.12">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.12.12.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.12.12.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.12.12.1"><span class="ltx_text ltx_font_bold" id="A4.T9.12.12.1.1">52.5<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.9}}}" class="ltx_Math" display="inline" id="A4.T9.12.12.1.1.m1.1"><semantics id="A4.T9.12.12.1.1.m1.1a"><msub id="A4.T9.12.12.1.1.m1.1.1" xref="A4.T9.12.12.1.1.m1.1.1.cmml"><mi id="A4.T9.12.12.1.1.m1.1.1a" xref="A4.T9.12.12.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.12.12.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.12.12.1.1.m1.1.1.1a.cmml">+1.9</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.12.12.1.1.m1.1b"><apply id="A4.T9.12.12.1.1.m1.1.1.cmml" xref="A4.T9.12.12.1.1.m1.1.1"><ci id="A4.T9.12.12.1.1.m1.1.1.1a.cmml" xref="A4.T9.12.12.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.12.12.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.12.12.1.1.m1.1.1.1">+1.9</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.12.12.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.9}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.12.12.1.1.m1.1d">start_FLOATSUBSCRIPT +1.9 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.56.34">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.56.34.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.56.34.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="5" id="A4.T9.22.56.34.2"><span class="ltx_text ltx_font_italic" id="A4.T9.22.56.34.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.57.35">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.57.35.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.57.35.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.57.35.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.57.35.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.57.35.4">INT4</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.57.35.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.57.35.6">7.0</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.58.36">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.58.36.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.58.36.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.58.36.2.1">SQFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.58.36.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.58.36.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.58.36.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.58.36.4.1">INT4 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.58.36.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.58.36.6">48.9</td>
</tr>
<tr class="ltx_tr" id="A4.T9.13.13">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.13.13.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.13.13.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.13.13.1"><span class="ltx_text ltx_font_bold" id="A4.T9.13.13.1.1">50.0<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.1}}}" class="ltx_Math" display="inline" id="A4.T9.13.13.1.1.m1.1"><semantics id="A4.T9.13.13.1.1.m1.1a"><msub id="A4.T9.13.13.1.1.m1.1.1" xref="A4.T9.13.13.1.1.m1.1.1.cmml"><mi id="A4.T9.13.13.1.1.m1.1.1a" xref="A4.T9.13.13.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.13.13.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.13.13.1.1.m1.1.1.1a.cmml">+1.1</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.13.13.1.1.m1.1b"><apply id="A4.T9.13.13.1.1.m1.1.1.cmml" xref="A4.T9.13.13.1.1.m1.1.1"><ci id="A4.T9.13.13.1.1.m1.1.1.1a.cmml" xref="A4.T9.13.13.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.13.13.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.13.13.1.1.m1.1.1.1">+1.1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.13.13.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.1}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.13.13.1.1.m1.1d">start_FLOATSUBSCRIPT +1.1 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.59.37">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.59.37.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.59.37.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.59.37.2.1">SQFT + QA-SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.59.37.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.59.37.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.59.37.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.59.37.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.59.37.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.59.37.6">48.2</td>
</tr>
<tr class="ltx_tr" id="A4.T9.14.14">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.14.14.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.14.14.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.14.14.1"><span class="ltx_text ltx_font_bold" id="A4.T9.14.14.1.1">50.2<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.0}}}" class="ltx_Math" display="inline" id="A4.T9.14.14.1.1.m1.1"><semantics id="A4.T9.14.14.1.1.m1.1a"><msub id="A4.T9.14.14.1.1.m1.1.1" xref="A4.T9.14.14.1.1.m1.1.1.cmml"><mi id="A4.T9.14.14.1.1.m1.1.1a" xref="A4.T9.14.14.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.14.14.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.14.14.1.1.m1.1.1.1a.cmml">+2.0</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.14.14.1.1.m1.1b"><apply id="A4.T9.14.14.1.1.m1.1.1.cmml" xref="A4.T9.14.14.1.1.m1.1.1"><ci id="A4.T9.14.14.1.1.m1.1.1.1a.cmml" xref="A4.T9.14.14.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.14.14.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.14.14.1.1.m1.1.1.1">+2.0</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.14.14.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.0}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.14.14.1.1.m1.1d">start_FLOATSUBSCRIPT +2.0 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.60.38">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.60.38.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T9.22.60.38.2" rowspan="12"><span class="ltx_text" id="A4.T9.22.60.38.2.1">60%</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T9.22.60.38.3"><span class="ltx_text ltx_font_italic" id="A4.T9.22.60.38.3.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.61.39">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.61.39.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.61.39.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.61.39.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.61.39.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.61.39.4">FP16</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.61.39.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.61.39.6">-</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.62.40">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.62.40.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.62.40.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.62.40.2.1">Shears</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.62.40.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.62.40.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.62.40.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.62.40.4.1">FP16 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.62.40.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.62.40.6">39.9</td>
</tr>
<tr class="ltx_tr" id="A4.T9.15.15">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.15.15.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.15.15.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.15.15.1"><span class="ltx_text ltx_font_bold" id="A4.T9.15.15.1.1">45.3<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+5%
.4}}}" class="ltx_Math" display="inline" id="A4.T9.15.15.1.1.m1.1"><semantics id="A4.T9.15.15.1.1.m1.1a"><msub id="A4.T9.15.15.1.1.m1.1.1" xref="A4.T9.15.15.1.1.m1.1.1.cmml"><mi id="A4.T9.15.15.1.1.m1.1.1a" xref="A4.T9.15.15.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.15.15.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.15.15.1.1.m1.1.1.1a.cmml">+5.4</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.15.15.1.1.m1.1b"><apply id="A4.T9.15.15.1.1.m1.1.1.cmml" xref="A4.T9.15.15.1.1.m1.1.1"><ci id="A4.T9.15.15.1.1.m1.1.1.1a.cmml" xref="A4.T9.15.15.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.15.15.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.15.15.1.1.m1.1.1.1">+5.4</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.15.15.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+5%
.4}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.15.15.1.1.m1.1d">start_FLOATSUBSCRIPT +5.4 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.63.41">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.63.41.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.63.41.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.63.41.2.1">SQFT + SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.63.41.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.63.41.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.63.41.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.63.41.4.1">FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.63.41.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.63.41.6">40.7</td>
</tr>
<tr class="ltx_tr" id="A4.T9.16.16">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.16.16.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.16.16.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.16.16.1"><span class="ltx_text ltx_font_bold" id="A4.T9.16.16.1.1">42.5<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.8}}}" class="ltx_Math" display="inline" id="A4.T9.16.16.1.1.m1.1"><semantics id="A4.T9.16.16.1.1.m1.1a"><msub id="A4.T9.16.16.1.1.m1.1.1" xref="A4.T9.16.16.1.1.m1.1.1.cmml"><mi id="A4.T9.16.16.1.1.m1.1.1a" xref="A4.T9.16.16.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.16.16.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.16.16.1.1.m1.1.1.1a.cmml">+1.8</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.16.16.1.1.m1.1b"><apply id="A4.T9.16.16.1.1.m1.1.1.cmml" xref="A4.T9.16.16.1.1.m1.1.1"><ci id="A4.T9.16.16.1.1.m1.1.1.1a.cmml" xref="A4.T9.16.16.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.16.16.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.16.16.1.1.m1.1.1.1">+1.8</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.16.16.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.8}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.16.16.1.1.m1.1d">start_FLOATSUBSCRIPT +1.8 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.64.42">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.64.42.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.64.42.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="5" id="A4.T9.22.64.42.2"><span class="ltx_text ltx_font_italic" id="A4.T9.22.64.42.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.65.43">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.65.43.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.65.43.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.65.43.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.65.43.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.65.43.4">INT4</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.65.43.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.65.43.6">-</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.66.44">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.66.44.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.66.44.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.66.44.2.1">SQFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.66.44.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.66.44.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.66.44.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.66.44.4.1">INT4 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.66.44.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.66.44.6">40.1</td>
</tr>
<tr class="ltx_tr" id="A4.T9.17.17">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.17.17.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.17.17.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.17.17.1"><span class="ltx_text ltx_font_bold" id="A4.T9.17.17.1.1">42.0<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.9}}}" class="ltx_Math" display="inline" id="A4.T9.17.17.1.1.m1.1"><semantics id="A4.T9.17.17.1.1.m1.1a"><msub id="A4.T9.17.17.1.1.m1.1.1" xref="A4.T9.17.17.1.1.m1.1.1.cmml"><mi id="A4.T9.17.17.1.1.m1.1.1a" xref="A4.T9.17.17.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.17.17.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.17.17.1.1.m1.1.1.1a.cmml">+1.9</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.17.17.1.1.m1.1b"><apply id="A4.T9.17.17.1.1.m1.1.1.cmml" xref="A4.T9.17.17.1.1.m1.1.1"><ci id="A4.T9.17.17.1.1.m1.1.1.1a.cmml" xref="A4.T9.17.17.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.17.17.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.17.17.1.1.m1.1.1.1">+1.9</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.17.17.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.9}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.17.17.1.1.m1.1d">start_FLOATSUBSCRIPT +1.9 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.67.45">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.67.45.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.67.45.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.67.45.2.1">SQFT + QA-SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.67.45.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.67.45.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.67.45.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.67.45.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.67.45.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.67.45.6">37.6</td>
</tr>
<tr class="ltx_tr" id="A4.T9.18.18">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.18.18.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.18.18.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.18.18.1"><span class="ltx_text ltx_font_bold" id="A4.T9.18.18.1.1">40.9<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+3%
.3}}}" class="ltx_Math" display="inline" id="A4.T9.18.18.1.1.m1.1"><semantics id="A4.T9.18.18.1.1.m1.1a"><msub id="A4.T9.18.18.1.1.m1.1.1" xref="A4.T9.18.18.1.1.m1.1.1.cmml"><mi id="A4.T9.18.18.1.1.m1.1.1a" xref="A4.T9.18.18.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.18.18.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.18.18.1.1.m1.1.1.1a.cmml">+3.3</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.18.18.1.1.m1.1b"><apply id="A4.T9.18.18.1.1.m1.1.1.cmml" xref="A4.T9.18.18.1.1.m1.1.1"><ci id="A4.T9.18.18.1.1.m1.1.1.1a.cmml" xref="A4.T9.18.18.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.18.18.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.18.18.1.1.m1.1.1.1">+3.3</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.18.18.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+3%
.3}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.18.18.1.1.m1.1d">start_FLOATSUBSCRIPT +3.3 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.68.46">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.68.46.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A4.T9.22.68.46.2" rowspan="12"><span class="ltx_text" id="A4.T9.22.68.46.2.1">70%</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T9.22.68.46.3"><span class="ltx_text ltx_font_italic" id="A4.T9.22.68.46.3.1">w/o Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.69.47">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.69.47.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.69.47.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.69.47.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.69.47.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.69.47.4">FP16</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.69.47.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.69.47.6">-</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.70.48">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.70.48.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.70.48.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.70.48.2.1">Shears</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.70.48.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.70.48.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.70.48.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.70.48.4.1">FP16 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.70.48.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.70.48.6">25.5</td>
</tr>
<tr class="ltx_tr" id="A4.T9.19.19">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.19.19.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.19.19.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.19.19.1"><span class="ltx_text ltx_font_bold" id="A4.T9.19.19.1.1">27.9<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.4}}}" class="ltx_Math" display="inline" id="A4.T9.19.19.1.1.m1.1"><semantics id="A4.T9.19.19.1.1.m1.1a"><msub id="A4.T9.19.19.1.1.m1.1.1" xref="A4.T9.19.19.1.1.m1.1.1.cmml"><mi id="A4.T9.19.19.1.1.m1.1.1a" xref="A4.T9.19.19.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.19.19.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.19.19.1.1.m1.1.1.1a.cmml">+2.4</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.19.19.1.1.m1.1b"><apply id="A4.T9.19.19.1.1.m1.1.1.cmml" xref="A4.T9.19.19.1.1.m1.1.1"><ci id="A4.T9.19.19.1.1.m1.1.1.1a.cmml" xref="A4.T9.19.19.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.19.19.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.19.19.1.1.m1.1.1.1">+2.4</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.19.19.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.4}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.19.19.1.1.m1.1d">start_FLOATSUBSCRIPT +2.4 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.71.49">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.71.49.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.71.49.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.71.49.2.1">SQFT + SparsePEFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.71.49.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.71.49.3.1">✓</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.71.49.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.71.49.4.1">FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.71.49.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.71.49.6">22.1</td>
</tr>
<tr class="ltx_tr" id="A4.T9.20.20">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.20.20.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.20.20.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.20.20.1"><span class="ltx_text ltx_font_bold" id="A4.T9.20.20.1.1">24.9<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.8}}}" class="ltx_Math" display="inline" id="A4.T9.20.20.1.1.m1.1"><semantics id="A4.T9.20.20.1.1.m1.1a"><msub id="A4.T9.20.20.1.1.m1.1.1" xref="A4.T9.20.20.1.1.m1.1.1.cmml"><mi id="A4.T9.20.20.1.1.m1.1.1a" xref="A4.T9.20.20.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.20.20.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.20.20.1.1.m1.1.1.1a.cmml">+2.8</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.20.20.1.1.m1.1b"><apply id="A4.T9.20.20.1.1.m1.1.1.cmml" xref="A4.T9.20.20.1.1.m1.1.1"><ci id="A4.T9.20.20.1.1.m1.1.1.1a.cmml" xref="A4.T9.20.20.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.20.20.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.20.20.1.1.m1.1.1.1">+2.8</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.20.20.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+2%
.8}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.20.20.1.1.m1.1d">start_FLOATSUBSCRIPT +2.8 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.72.50">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.72.50.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.72.50.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="5" id="A4.T9.22.72.50.2"><span class="ltx_text ltx_font_italic" id="A4.T9.22.72.50.2.1">Quantization</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.22.73.51">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.73.51.1">
<span class="ltx_ERROR undefined" id="A4.T9.22.73.51.1.1">\cdashline</span>3-7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.73.51.2">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.73.51.3">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.73.51.4">INT4</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.73.51.5">-</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.73.51.6">-</td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.74.52">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.74.52.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T9.22.74.52.2" rowspan="2"><span class="ltx_text" id="A4.T9.22.74.52.2.1">SQFT</span></th>
<td class="ltx_td ltx_align_center" id="A4.T9.22.74.52.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.74.52.3.1">✗</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.74.52.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.74.52.4.1">INT4 + FP16</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.74.52.5">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.74.52.6">24.2</td>
</tr>
<tr class="ltx_tr" id="A4.T9.21.21">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.21.21.2"></th>
<td class="ltx_td ltx_align_center" id="A4.T9.21.21.3">NLS</td>
<td class="ltx_td ltx_align_center" id="A4.T9.21.21.1"><span class="ltx_text ltx_font_bold" id="A4.T9.21.21.1.1">25.2<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.0}}}" class="ltx_Math" display="inline" id="A4.T9.21.21.1.1.m1.1"><semantics id="A4.T9.21.21.1.1.m1.1a"><msub id="A4.T9.21.21.1.1.m1.1.1" xref="A4.T9.21.21.1.1.m1.1.1.cmml"><mi id="A4.T9.21.21.1.1.m1.1.1a" xref="A4.T9.21.21.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.21.21.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.21.21.1.1.m1.1.1.1a.cmml">+1.0</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.21.21.1.1.m1.1b"><apply id="A4.T9.21.21.1.1.m1.1.1.cmml" xref="A4.T9.21.21.1.1.m1.1.1"><ci id="A4.T9.21.21.1.1.m1.1.1.1a.cmml" xref="A4.T9.21.21.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.21.21.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.21.21.1.1.m1.1.1.1">+1.0</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.21.21.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+1%
.0}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.21.21.1.1.m1.1d">start_FLOATSUBSCRIPT +1.0 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.22">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T9.22.22.2"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T9.22.22.3" rowspan="2"><span class="ltx_text" id="A4.T9.22.22.3.1">SQFT + QA-SparsePEFT</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T9.22.22.4" rowspan="2"><span class="ltx_text" id="A4.T9.22.22.4.1">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T9.22.22.5" rowspan="2"><span class="ltx_text" id="A4.T9.22.22.5.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.22.6">LoRA</td>
<td class="ltx_td ltx_align_center" id="A4.T9.22.22.1"><span class="ltx_text ltx_font_bold" id="A4.T9.22.22.1.1">22.6<math alttext="{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.2}}}" class="ltx_Math" display="inline" id="A4.T9.22.22.1.1.m1.1"><semantics id="A4.T9.22.22.1.1.m1.1a"><msub id="A4.T9.22.22.1.1.m1.1.1" xref="A4.T9.22.22.1.1.m1.1.1.cmml"><mi id="A4.T9.22.22.1.1.m1.1.1a" xref="A4.T9.22.22.1.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="A4.T9.22.22.1.1.m1.1.1.1" mathcolor="#FF0000" xref="A4.T9.22.22.1.1.m1.1.1.1a.cmml">+0.2</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.T9.22.22.1.1.m1.1b"><apply id="A4.T9.22.22.1.1.m1.1.1.cmml" xref="A4.T9.22.22.1.1.m1.1.1"><ci id="A4.T9.22.22.1.1.m1.1.1.1a.cmml" xref="A4.T9.22.22.1.1.m1.1.1.1"><mtext class="ltx_mathvariant_bold" id="A4.T9.22.22.1.1.m1.1.1.1.cmml" mathcolor="#FF0000" mathsize="70%" xref="A4.T9.22.22.1.1.m1.1.1.1">+0.2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.22.22.1.1.m1.1c">{}_{\text{{\color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}+0%
.2}}}</annotation><annotation encoding="application/x-llamapun" id="A4.T9.22.22.1.1.m1.1d">start_FLOATSUBSCRIPT +0.2 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.22.75.53">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb" id="A4.T9.22.75.53.1"></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T9.22.75.53.2">NLS</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T9.22.75.53.3">22.4</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>How does SQFT perform without sparsity?</h2>
<figure class="ltx_table" id="A5.T10">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span>Results from adapting <span class="ltx_text ltx_font_bold" id="A5.T10.2.1">Llama-3-8B</span> to GSM8K without introducing sparsity.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T10.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A5.T10.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A5.T10.3.1.1.1" rowspan="2" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A5.T10.3.1.1.2" rowspan="2" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.1.1.2.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T10.3.1.1.3" rowspan="2" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.1.1.3.1">Mergeable</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T10.3.1.1.4" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.1.1.4.1">Final Precision</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T10.3.1.1.5" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.1.1.5.1">Fine-tune</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T10.3.1.1.6" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.1.1.6.1">GSM8K Test</span></th>
</tr>
<tr class="ltx_tr" id="A5.T10.3.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A5.T10.3.2.2.1" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.2.2.1.1">(Base + Adapter / Base)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A5.T10.3.2.2.2" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.2.2.2.1">Approach</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A5.T10.3.2.2.3" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.2.2.3.1">Accuracy(%)</span></th>
</tr>
<tr class="ltx_tr" id="A5.T10.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A5.T10.3.3.3.1" rowspan="2" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.3.3.1.1">Llama-3-8B</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A5.T10.3.3.3.2" style="padding:1pt 10.0pt;">w/o tune</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A5.T10.3.3.3.3" style="padding:1pt 10.0pt;">-</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A5.T10.3.3.3.4" style="padding:1pt 10.0pt;">FP16</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A5.T10.3.3.3.5" style="padding:1pt 10.0pt;">-</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A5.T10.3.3.3.6" style="padding:1pt 10.0pt;">50.0</th>
</tr>
<tr class="ltx_tr" id="A5.T10.3.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" colspan="5" id="A5.T10.3.4.4.1" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_italic" id="A5.T10.3.4.4.1.1">Quantization</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A5.T10.3.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.3.5.1.1" style="padding:1pt 10.0pt;">
<span class="ltx_ERROR undefined" id="A5.T10.3.5.1.1.1">\cdashline</span>2-6</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.3.5.1.2" style="padding:1pt 10.0pt;">w/o tune</th>
<td class="ltx_td ltx_align_center" id="A5.T10.3.5.1.3" style="padding:1pt 10.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.5.1.4" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.5.1.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.5.1.5" style="padding:1pt 10.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.5.1.6" style="padding:1pt 10.0pt;">36.6</td>
</tr>
<tr class="ltx_tr" id="A5.T10.3.6.2">
<th class="ltx_td ltx_th ltx_th_row" id="A5.T10.3.6.2.1" style="padding:1pt 10.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.3.6.2.2" style="padding:1pt 10.0pt;">GPTQ + LoRA</th>
<td class="ltx_td ltx_align_center" id="A5.T10.3.6.2.3" style="padding:1pt 10.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.6.2.4" style="padding:1pt 10.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.6.2.5" style="padding:1pt 10.0pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.6.2.6" style="padding:1pt 10.0pt;">58.8</td>
</tr>
<tr class="ltx_tr" id="A5.T10.3.7.3">
<th class="ltx_td ltx_th ltx_th_row" id="A5.T10.3.7.3.1" style="padding:1pt 10.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.3.7.3.2" style="padding:1pt 10.0pt;">SQFT (Ours)</th>
<td class="ltx_td ltx_align_center" id="A5.T10.3.7.3.3" style="padding:1pt 10.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.7.3.4" style="padding:1pt 10.0pt;">INT4 + FP16</td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.7.3.5" style="padding:1pt 10.0pt;">NLS</td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.7.3.6" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.7.3.6.1">61.0</span></td>
</tr>
<tr class="ltx_tr" id="A5.T10.3.8.4">
<th class="ltx_td ltx_th ltx_th_row" id="A5.T10.3.8.4.1" style="padding:1pt 10.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A5.T10.3.8.4.2" rowspan="2" style="padding:1pt 10.0pt;"><span class="ltx_text" id="A5.T10.3.8.4.2.1">SQFT + QA-SparsePEFT (Ours)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.3.8.4.3" rowspan="2" style="padding:1pt 10.0pt;"><span class="ltx_text" id="A5.T10.3.8.4.3.1">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.3.8.4.4" rowspan="2" style="padding:1pt 10.0pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.3.8.4.4.1">INT4</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.8.4.5" style="padding:1pt 10.0pt;">LoRA</td>
<td class="ltx_td ltx_align_center" id="A5.T10.3.8.4.6" style="padding:1pt 10.0pt;">55.8</td>
</tr>
<tr class="ltx_tr" id="A5.T10.3.9.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb" id="A5.T10.3.9.5.1" style="padding:1pt 10.0pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.3.9.5.2" style="padding:1pt 10.0pt;">NLS</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.3.9.5.3" style="padding:1pt 10.0pt;">57.2</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">In the main paper, we explored SQFT with both sparse + non-quantized and sparse + quantized settings. However, we are also interested in what happens to SQFT if there is no sparsity. Here, we investigate SQFT’s performance with quantization alone. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03750v1#A5.T10" title="Table 10 ‣ Appendix E How does SQFT perform without sparsity? ‣ SQFT: Low-cost Model Adaptation in Low-precision Sparse Foundation Models"><span class="ltx_text ltx_ref_tag">10</span></a>, without sparsity, the quantized model reduces the accuracy from 50% to 36.6%. With the help of fine-tuning, the baseline GPTQ + LoRA improves accuracy to 58.8%. At the same time, our SQFT method further enhances performance, achieving 61.0% accuracy with NLS fine-tuning, demonstrating that NLS outperforms LoRA in the non-sparse setting.
However, for SQFT + QA-SparsePEFT, while NLS outperforms LoRA, the accuracy is slightly lower compared to SQFT. The advantage is that it results in an INT4 model. In summary, users must balance accuracy and efficiency based on their requirements to choose the optimal approach.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct  1 19:46:40 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
