<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2302.05200] End-to-end Semantic Object Detection with Cross-Modal Alignment</title><meta property="og:description" content="Traditional semantic image search methods aim to retrieve images that match the meaning of the text query. However, these methods typically search for objects on the whole image, without considering the localization of…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="End-to-end Semantic Object Detection with Cross-Modal Alignment">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="End-to-end Semantic Object Detection with Cross-Modal Alignment">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2302.05200">

<!--Generated on Fri Mar  1 01:51:24 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">End-to-end Semantic Object Detection with Cross-Modal Alignment
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Silvan Ferreira, Allan Martins, Ivanovitch Silva 
<br class="ltx_break">Federal University of Rio Grande do Norte, Natal, Brazil 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">silvan.junior.051@ufrn.edu.br, allan@dee.ufrn.br, ivanovitch.silva@ufrn.br</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Traditional semantic image search methods aim to retrieve images that match the meaning of the text query. However, these methods typically search for objects on the whole image, without considering the localization of objects within the image. This paper presents an extension of existing object detection models for semantic image search that considers the semantic alignment between object proposals and text queries, with a focus on searching for objects within images. The proposed model uses a single feature extractor, a pre-trained Convolutional Neural Network, and a transformer encoder to encode the text query. Proposal-text alignment is performed using contrastive learning, producing a score for each proposal that reflects its semantic alignment with the text query. The Region Proposal Network (RPN) is used to generate object proposals, and the end-to-end training process allows for an efficient and effective solution for semantic image search. The proposed model was trained end-to-end, providing a promising solution for semantic image search that retrieves images that match the meaning of the text query and generates semantically relevant object proposals.</p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<p id="p1.4" class="ltx_p"><em id="p1.4.1" class="ltx_emph ltx_font_bold ltx_font_italic">K</em><span id="p1.4.2" class="ltx_text ltx_font_bold">eywords</span> Object detection  <math id="p1.1.m1.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.1.m1.1a"><mo id="p1.1.m1.1.1" xref="p1.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.1.m1.1b"><ci id="p1.1.m1.1.1.cmml" xref="p1.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.1.m1.1c">\cdot</annotation></semantics></math>
Semantic alignment  <math id="p1.2.m2.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.2.m2.1a"><mo id="p1.2.m2.1.1" xref="p1.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.2.m2.1b"><ci id="p1.2.m2.1.1.cmml" xref="p1.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.2.m2.1c">\cdot</annotation></semantics></math>
Cross-modal alignment  <math id="p1.3.m3.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.3.m3.1a"><mo id="p1.3.m3.1.1" xref="p1.3.m3.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.3.m3.1b"><ci id="p1.3.m3.1.1.cmml" xref="p1.3.m3.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.3.m3.1c">\cdot</annotation></semantics></math>
Transformers  <math id="p1.4.m4.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.4.m4.1a"><mo id="p1.4.m4.1.1" xref="p1.4.m4.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.4.m4.1b"><ci id="p1.4.m4.1.1.cmml" xref="p1.4.m4.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.4.m4.1c">\cdot</annotation></semantics></math>
Region Proposal Network</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">The ability to detect and categorize objects is a crucial component of human perception and cognitive function. This process is often guided by selective attention, allowing us to efficiently search for and locate objects of interest in our surroundings while ignoring other irrelevant stimuli <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. In computer vision, the task of object detection aims to replicate this ability by automatically identifying and locating objects in images and videos. However, traditional object detection methods often lack the semantic understanding and attentional mechanism present in human object search, leading to limitations in their performance.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Object detection establishes itself with great importance in the field of computer vision, which focuses on identifying and locating objects within an image or video. This problem has been actively researched for decades and has recently gained a surge of attention due to its various real-world applications. Some of the most prominent applications include self-driving cars, surveillance systems, and human-computer interaction. These applications require the accurate detection of objects in real-time, making it an essential tool for many industries <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">The task of object detection can be divided into two subtasks, object proposals generation and classification. The former involves generating candidate regions or proposals within an image or video frame that may contain objects, while the latter is the task of classifying each proposal as foreground or background. This process requires the integration of both subtasks to generate accurate and efficient results.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Despite the advances made in object detection, it remains a challenging task due to the large variability in object appearance and scale, as well as the presence of clutter and occlusions. Additionally, existing object detection models are not designed to take into account the semantic relationships between objects and the text queries used to search for them <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">Semantic image search also plays a significant role in computer vision by allowing users to search for images based on their semantic content. Unlike traditional search methods that rely solely on keyword matching, semantic image search leverages the understanding of visual and textual information to return results that are semantically relevant to a given query. This is an important development in the field of computer vision, as it enables a more natural and intuitive way of searching for visual information, and makes it possible to retrieve images based on the meaning they convey, rather than just their surface features. The common approach for this task is training a cross-modal model to align visual and textual information, as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Nevertheless, traditional methods of semantic image search matches a text input with the whole image, without considering the location of the objects within the image. Which narrows the ability of these approaches to handle real-world scenarios where a user may need to search for objects in a specific image.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">In this paper, we present a novel approach to object detection that addresses the challenges in semantic image search. Our proposed model aims to improve the semantic alignment between the text and object proposals by considering the semantic relationship between the two modalities. The proposed model consists of a single feature extractor, a pre-trained Convolutional Neural Network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, and a Transformer encoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> to encode the text query. Proposal-text alignment is performed using contrastive learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, producing a score for each proposal that reflects its semantic alignment with the text query. The Region Proposal Network (RPN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> is used to generate object proposals, and the end-to-end training process allows for an efficient and effective solution for semantic image search.</p>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p">The contribution of this paper is two-fold. First, we introduce a novel approach to object detection that considers the semantic alignment between object proposals and text queries. Second, we present an end-to-end trainable model that integrates the feature extraction, text encoding, proposal generation, and proposal-text alignment. Our proposed model is evaluated on a simple dataset, demonstrating its ability to improve the semantic alignment between the text and object proposals, leading to more relevant results in semantic image search.</p>
</div>
<div id="S1.p8" class="ltx_para ltx_noindent">
<p id="S1.p8.1" class="ltx_p">The remainder of this paper is organized as follows: Section II explores the related works. Section III provides a detailed description of the proposed model, including the architecture and the training process. Section IV presents the experimental results, including a comparison with existing object detection models. Finally, Section V concludes the paper and discusses future work.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">This sections provides the background and context for the proposed solution by reviewing related work in object detection and semantic image search. It covers a brief overview of traditional object detection methods, as well as image-text alignment methods that are used in semantic image searching algorithms.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Object Detection</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p">The development of object detection algorithms has its roots in the early days of computer vision. The first algorithms focused on detecting simple objects such as edges and corners, such as the edge detection algorithm proposed by Canny <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, which uses the gradient of image intensity to detect edges. Another early object detection algorithm is the Hough Transform <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, a classic technique for detecting lines, circles, and other shapes in an image by transforming the image into a parameter space. The Viola-Jones face detection algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> uses a set of Haar-like features combined in a cascade of classifiers to describe the appearance of a face.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p">The advancement of object detection algorithms has been significantly influenced by the integration of machine learning techniques. Among these techniques, Support Vector Machines (SVM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and Histogram of Oriented Gradients (HOG) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> have emerged as the primary approach for object detection. SVM functions as a linear classifier, training a binary classifier to distinguish between object and non-object regions in an image by maximizing the margin between positive and negative examples in the training set. HOG, on the other hand, acts as a feature descriptor, capturing the shape and texture information of an object by computing histograms of gradient orientation in small cells of an image. These algorithms offer a more automated and scalable way of learning object representations, resulting in the detection of a wider range of object categories with improved accuracy.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para ltx_noindent">
<p id="S2.SS1.p3.1" class="ltx_p">In 2012, the Convolutional Neural Networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> became more feasible to learn more robust and high level features representations. Several object detection models based on CNNs were proposed. These models usually can be categorized in: (i) two-stage detectors, where a set of proposals are first generated and then passed to a separate network to classify and refine the object locations; and (ii) one-stage detectors, which performs object detection in a single stage, increasing its speed while reducing accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para ltx_noindent">
<p id="S2.SS1.p4.1" class="ltx_p">In 2014, Girshick et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> proposed a two-stage detector, the Regions with CNN features (RCNNs), in which by using selective search <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> a set of object proposals is extracted, and then each proposal is rescaled to a fixed size image and sent to a pre-trained CNN in order to have its features extracted. Finally, a SVM classifier is used to detect the presence of an object and predict its class. R-CNN yield a significant improvement in the mean Average Precision with IoU threshold of 0.5 (mAP@.5) of 58.5% on VOC07 dataset. However, the high number of proposals, around 2000 for a single image, resulted in a extremely slow detection speed.</p>
</div>
<div id="S2.SS1.p5" class="ltx_para ltx_noindent">
<p id="S2.SS1.p5.1" class="ltx_p">To address this challenge, another CNN based object detection models were proposed. In 2014, the SPPNet was introduced by He et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> and aimed to address the issue of varying object scales in object detection tasks. The SPPNet uses a spatial pyramid pooling layer to aggregate information from different regions of an image, allowing the network to handle objects of different scales effectively, achieving a mAP of 59.2% on VOC07, more than 20 time faster than R-CNN. On the other hand, Fast R-CNN, introduced by Girshick in 2015 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, is a more efficient variant of R-CNN. Fast R-CNN uses a shared convolutional layer for both region proposals and final classification, leading to faster processing times compared to previous methods and achieved a mAP@.5 of 70.0% on VOC07 with a detection speed over 200 times faster, compared to R-CNN.</p>
</div>
<div id="S2.SS1.p6" class="ltx_para ltx_noindent">
<p id="S2.SS1.p6.1" class="ltx_p">Later, an improved version of Fast RCNN, called Faster RCNN was proposed by Ren et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> which introduced the Region Proposal Network (RPN) to efficiently generate object proposals and the shared convolutional layer for both proposal generation and object classification, leading to faster processing times and high accuracy in object detection tasks when compared to the original R-CNN. Faster R-CNN achieved a mAP@.5 of 42.7% on COCO and 73.2% on VOC07 and 17 fps with ZF-NET.</p>
</div>
<div id="S2.SS1.p7" class="ltx_para ltx_noindent">
<p id="S2.SS1.p7.1" class="ltx_p">In 2015, Redmon et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> introduced You Only Look Once (YOLO). YOLO was the first one-stage detector in the deep learning era, and it immediately stood out for its incredible speed, with a fast version running at 155 fps and a VOC07 mAP@.5 of 52.7%. YOLO operates by applying a single neural network to the full image, dividing the image into regions and predicting bounding boxes and probabilities for each region simultaneously. While its high-speed detection was groundbreaking, YOLO suffered from a drop in localization accuracy compared to two-stage detectors, particularly for small objects. Nevertheless, subsequent versions of YOLO, such as YOLOv7 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, have addressed this issue through techniques like dynamic label assignment and optimized structures, achieving outstanding speed and accuracy ranges from 5 to 160 fps.</p>
</div>
<div id="S2.SS1.p8" class="ltx_para ltx_noindent">
<p id="S2.SS1.p8.1" class="ltx_p">Single-Shot Multibox Detector (SSD), proposed by Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> in 2015, brought a significant improvement in detection accuracy to one-stage detectors. SSD introduced multireference and multiresolution detection techniques, which notably improved the accuracy of one-stage detectors, particularly for small objects. SSD offered advantages in both detection speed, achieving 59 fps, and mAP@.5 of 46.5% on COCO. The key difference between SSD and previous detectors is that SSD performs detection on different layers of the network for objects of different scales, whereas previous detectors only operated on their top layers.</p>
</div>
<div id="S2.SS1.p9" class="ltx_para ltx_noindent">
<p id="S2.SS1.p9.1" class="ltx_p">RetinaNet, introduced by Lin et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> in 2017, tackles the accuracy issues that one-stage detectors had faced compared to two-stage detectors. The authors identified a significant foreground-background class imbalance during the training of dense detectors as the main cause of this gap. To address this, RetinaNet introduced a new loss function named focal loss, which reshaped the standard cross entropy loss to put more focus on hard, misclassified examples during training. With focal loss, RetinaNet was able to achieve a comparable mAP@.5 of 59.1% on COCO, with two-stage detectors while maintaining a high detection speed.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Image-Text Alignment</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p">Image-text alignment is a field of study that explores the relationship between images and their textual description. This field has gained significant attention in recent years due to its wide range of applications, such as visual captioning, visual question answering, and cross-modal retrieval.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.1" class="ltx_p">In 2019, Gu et al. proposed ImageBERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, a pre-trained deep learning model that learns to understand the relationship between images and text by leveraging a large-scale image-text corpus. ImageBERT is based on the BERT (Bidirectional Encoder Representations from Transformers) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> architecture and has been pre-trained on large-scale visual and textual data. The model uses a combination of self-attention mechanisms and fully-connected layers to learn to align visual and textual information in a common semantic space. The pre-training step allows ImageBERT to achieve high performance on a variety of vision and language tasks without the need for task-specific fine-tuning.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.1" class="ltx_p">CLIP (Contrastive Language-Image Pretraining), introduced by Radford et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> in 2021, is another multi-modal architecture designed to learn a common semantic representation between text and images. It uses a large pre-training corpus of textual and visual data and a contrastive learning objective to learn how to align text and image data. The model has two encoders, one for text and one for images, that operate in parallel and are optimized together. The two encoders are trained to predict whether a text description is likely to match the image it is paired with. CLIP has been shown to perform well on various tasks such as cross-modal retrieval, text-to-image generation, and visual question answering.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS2.p4.1" class="ltx_p">Also in 2021, ALIGN (Attentive Language-Image Generative model) is a deep learning model proposed by C. Jia et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. ALIGN is designed to align text and image modalities through an attention mechanism. The model has two encoders for text and images that operate in parallel, and a decoder that combines their representations using an attention mechanism to generate an aligned representation. The attention mechanism allows the model to focus on the most important regions of the image and text representations and to align the two modalities in a meaningful way. The model is trained to reconstruct the input image and text in an autoencoder-style architecture, which allows it to learn to preserve the information that is important for both modalities.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">This section presents the details of our proposed approach for semantic image search. It covers the components of our model, including the Region Proposal Network (RPN), the proposal and text encoders, and the proposal-text alignment model, as shown in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Methodology ‣ End-to-end Semantic Object Detection with Cross-Modal Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We also explain our approach for alignment using contrastive learning, which is a crucial aspect of our method. The section concludes with a description of the end-to-end training process and the experimental setup.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2302.05200/assets/images/architecture.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="145" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Architecture of the proposed model.</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Region Proposal Network</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">Region Proposal Networks (RPNs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> play a significant role in object detection systems. Their purpose is to produce region proposals that have the potential to contain object instances within an image. These proposals are then handed off to a later stage, like a Fast R-CNN network, for further classification and refinement.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2302.05200/assets/images/rpn.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="326" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Inner architecture of the Region Proposal Network module.</figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.1" class="ltx_p">The RPN functions on the feature maps that result from the convolutional layers in a deep neural network. Given an input image, the RPN generates multiple region proposals, each defined by a set of anchor boxes. Anchors are fixed-size boxes with specified aspect ratios that are densely placed over the feature maps. The RPN predicts a binary classification label for each anchor box to determine whether it contains an object or not, and also predicts bounding box regression coefficients to refine the anchor boxes into the final proposals.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.1" class="ltx_p">The process for training the binary classification head of RPNs involves assigning binary class labels, indicating if it is an object or non-object, to each anchor. Positive labels are given to anchors that meet one of two criteria: (i) having the highest Intersection-over-Union (IoU) overlap with a ground-truth box, or (ii) having an IoU overlap higher than a maximum threshold, such as 0.7, with any ground-truth box. Although the second condition is typically enough to identify positive samples, the first condition is also implemented for cases when no positive samples are found through the second criterion. Negative labels are assigned to anchors that have an IoU ratio lower than a minimum threshold, such as 0.3, with all ground-truth boxes. Anchors that do not meet either positive or negative criteria do not play a role in the training. However, it’s worth noting that the number of negative labels usually surpasses the number of positive samples, potentially leading to a bias towards negative samples. To counteract this, negative samples are randomly selected so that the ratio of positive to negative samples is roughly 1:1.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.1" class="ltx_p">For training the regression head of RPNs to predict the bounding boxes, only positive samples are used and the outputs are parameterized by:</p>
</div>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E1.m1.108" class="ltx_math_unparsed" alttext="\displaystyle\begin{split}t_{\mathrm{x}}&amp;=\left(x-x_{\mathrm{a}}\right)/w_{\mathrm{a}},\quad t_{\mathrm{y}}=\left(y-y_{\mathrm{a}}\right)/h_{\mathrm{a}}\\
t_{\mathrm{w}}&amp;=\log\left(w/w_{\mathrm{a}}\right),\quad t_{\mathrm{h}}=\log\left(h/h_{\mathrm{a}}\right)\\
t_{\mathrm{x}}^{*}&amp;=\left(x^{*}-x_{\mathrm{a}}\right)/w_{\mathrm{a}},\quad t_{\mathrm{y}}^{*}=\left(y^{*}-y_{\mathrm{a}}\right)/h_{\mathrm{a}},\\
t_{\mathrm{w}}^{*}&amp;=\log\left(w^{*}/w_{\mathrm{a}}\right),\quad t_{\mathrm{h}}^{*}=\log\left(h^{*}/h_{\mathrm{a}}\right)\end{split}" display="inline"><semantics id="S3.E1.m1.108a"><mtable columnspacing="0pt" rowspacing="0pt" id="S3.E1.m1.108.108.7"><mtr id="S3.E1.m1.108.108.7a"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.108.108.7b"><msub id="S3.E1.m1.2.2.2.2.2a"><mi id="S3.E1.m1.1.1.1.1.1.1">t</mi><mi mathvariant="normal" id="S3.E1.m1.2.2.2.2.2.2.1">x</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.108.108.7c"><mrow id="S3.E1.m1.103.103.2.103.27.25.25"><mrow id="S3.E1.m1.102.102.1.102.26.24.24.1"><mi id="S3.E1.m1.102.102.1.102.26.24.24.1.2"></mi><mo id="S3.E1.m1.3.3.3.3.1.1">=</mo><mrow id="S3.E1.m1.102.102.1.102.26.24.24.1.1"><mrow id="S3.E1.m1.102.102.1.102.26.24.24.1.1.1.1"><mo id="S3.E1.m1.4.4.4.4.2.2">(</mo><mrow id="S3.E1.m1.102.102.1.102.26.24.24.1.1.1.1.1"><mi id="S3.E1.m1.5.5.5.5.3.3">x</mi><mo id="S3.E1.m1.6.6.6.6.4.4">−</mo><msub id="S3.E1.m1.102.102.1.102.26.24.24.1.1.1.1.1.1"><mi id="S3.E1.m1.7.7.7.7.5.5">x</mi><mi mathvariant="normal" id="S3.E1.m1.8.8.8.8.6.6.1">a</mi></msub></mrow><mo id="S3.E1.m1.9.9.9.9.7.7">)</mo></mrow><mo id="S3.E1.m1.10.10.10.10.8.8">/</mo><msub id="S3.E1.m1.102.102.1.102.26.24.24.1.1.2"><mi id="S3.E1.m1.11.11.11.11.9.9">w</mi><mi mathvariant="normal" id="S3.E1.m1.12.12.12.12.10.10.1">a</mi></msub></mrow></mrow><mo rspace="1.167em" id="S3.E1.m1.13.13.13.13.11.11">,</mo><mrow id="S3.E1.m1.103.103.2.103.27.25.25.2"><msub id="S3.E1.m1.103.103.2.103.27.25.25.2.2"><mi id="S3.E1.m1.14.14.14.14.12.12">t</mi><mi mathvariant="normal" id="S3.E1.m1.15.15.15.15.13.13.1">y</mi></msub><mo id="S3.E1.m1.16.16.16.16.14.14">=</mo><mrow id="S3.E1.m1.103.103.2.103.27.25.25.2.1"><mrow id="S3.E1.m1.103.103.2.103.27.25.25.2.1.1.1"><mo id="S3.E1.m1.17.17.17.17.15.15">(</mo><mrow id="S3.E1.m1.103.103.2.103.27.25.25.2.1.1.1.1"><mi id="S3.E1.m1.18.18.18.18.16.16">y</mi><mo id="S3.E1.m1.19.19.19.19.17.17">−</mo><msub id="S3.E1.m1.103.103.2.103.27.25.25.2.1.1.1.1.1"><mi id="S3.E1.m1.20.20.20.20.18.18">y</mi><mi mathvariant="normal" id="S3.E1.m1.21.21.21.21.19.19.1">a</mi></msub></mrow><mo id="S3.E1.m1.22.22.22.22.20.20">)</mo></mrow><mo id="S3.E1.m1.23.23.23.23.21.21">/</mo><msub id="S3.E1.m1.103.103.2.103.27.25.25.2.1.2"><mi id="S3.E1.m1.24.24.24.24.22.22">h</mi><mi mathvariant="normal" id="S3.E1.m1.25.25.25.25.23.23.1">a</mi></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E1.m1.108.108.7d"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.108.108.7e"><msub id="S3.E1.m1.27.27.27.2.2a"><mi id="S3.E1.m1.26.26.26.1.1.1">t</mi><mi mathvariant="normal" id="S3.E1.m1.27.27.27.2.2.2.1">w</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.108.108.7f"><mrow id="S3.E1.m1.105.105.4.105.23.21.21"><mrow id="S3.E1.m1.104.104.3.104.22.20.20.1"><mi id="S3.E1.m1.104.104.3.104.22.20.20.1.2"></mi><mo id="S3.E1.m1.28.28.28.3.1.1">=</mo><mrow id="S3.E1.m1.104.104.3.104.22.20.20.1.1.1"><mi id="S3.E1.m1.29.29.29.4.2.2">log</mi><mo id="S3.E1.m1.104.104.3.104.22.20.20.1.1.1a">⁡</mo><mrow id="S3.E1.m1.104.104.3.104.22.20.20.1.1.1.1"><mo id="S3.E1.m1.30.30.30.5.3.3">(</mo><mrow id="S3.E1.m1.104.104.3.104.22.20.20.1.1.1.1.1"><mi id="S3.E1.m1.31.31.31.6.4.4">w</mi><mo id="S3.E1.m1.32.32.32.7.5.5">/</mo><msub id="S3.E1.m1.104.104.3.104.22.20.20.1.1.1.1.1.1"><mi id="S3.E1.m1.33.33.33.8.6.6">w</mi><mi mathvariant="normal" id="S3.E1.m1.34.34.34.9.7.7.1">a</mi></msub></mrow><mo id="S3.E1.m1.35.35.35.10.8.8">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E1.m1.36.36.36.11.9.9">,</mo><mrow id="S3.E1.m1.105.105.4.105.23.21.21.2"><msub id="S3.E1.m1.105.105.4.105.23.21.21.2.2"><mi id="S3.E1.m1.37.37.37.12.10.10">t</mi><mi mathvariant="normal" id="S3.E1.m1.38.38.38.13.11.11.1">h</mi></msub><mo id="S3.E1.m1.39.39.39.14.12.12">=</mo><mrow id="S3.E1.m1.105.105.4.105.23.21.21.2.1.1"><mi id="S3.E1.m1.40.40.40.15.13.13">log</mi><mo id="S3.E1.m1.105.105.4.105.23.21.21.2.1.1a">⁡</mo><mrow id="S3.E1.m1.105.105.4.105.23.21.21.2.1.1.1"><mo id="S3.E1.m1.41.41.41.16.14.14">(</mo><mrow id="S3.E1.m1.105.105.4.105.23.21.21.2.1.1.1.1"><mi id="S3.E1.m1.42.42.42.17.15.15">h</mi><mo id="S3.E1.m1.43.43.43.18.16.16">/</mo><msub id="S3.E1.m1.105.105.4.105.23.21.21.2.1.1.1.1.1"><mi id="S3.E1.m1.44.44.44.19.17.17">h</mi><mi mathvariant="normal" id="S3.E1.m1.45.45.45.20.18.18.1">a</mi></msub></mrow><mo id="S3.E1.m1.46.46.46.21.19.19">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E1.m1.108.108.7g"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.108.108.7h"><msubsup id="S3.E1.m1.49.49.49.3.3a"><mi id="S3.E1.m1.47.47.47.1.1.1">t</mi><mi mathvariant="normal" id="S3.E1.m1.48.48.48.2.2.2.1">x</mi><mo id="S3.E1.m1.49.49.49.3.3.3.1">∗</mo></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.108.108.7i"><mrow id="S3.E1.m1.106.106.5.106.31.28.28"><mrow id="S3.E1.m1.106.106.5.106.31.28.28.1"><mrow id="S3.E1.m1.106.106.5.106.31.28.28.1.1.1"><mi id="S3.E1.m1.106.106.5.106.31.28.28.1.1.1.2"></mi><mo id="S3.E1.m1.50.50.50.4.1.1">=</mo><mrow id="S3.E1.m1.106.106.5.106.31.28.28.1.1.1.1"><mrow id="S3.E1.m1.106.106.5.106.31.28.28.1.1.1.1.1.1"><mo id="S3.E1.m1.51.51.51.5.2.2">(</mo><mrow id="S3.E1.m1.106.106.5.106.31.28.28.1.1.1.1.1.1.1"><msup id="S3.E1.m1.106.106.5.106.31.28.28.1.1.1.1.1.1.1.1"><mi id="S3.E1.m1.52.52.52.6.3.3">x</mi><mo id="S3.E1.m1.53.53.53.7.4.4.1">∗</mo></msup><mo id="S3.E1.m1.54.54.54.8.5.5">−</mo><msub id="S3.E1.m1.106.106.5.106.31.28.28.1.1.1.1.1.1.1.2"><mi id="S3.E1.m1.55.55.55.9.6.6">x</mi><mi mathvariant="normal" id="S3.E1.m1.56.56.56.10.7.7.1">a</mi></msub></mrow><mo id="S3.E1.m1.57.57.57.11.8.8">)</mo></mrow><mo id="S3.E1.m1.58.58.58.12.9.9">/</mo><msub id="S3.E1.m1.106.106.5.106.31.28.28.1.1.1.1.2"><mi id="S3.E1.m1.59.59.59.13.10.10">w</mi><mi mathvariant="normal" id="S3.E1.m1.60.60.60.14.11.11.1">a</mi></msub></mrow></mrow><mo rspace="1.167em" id="S3.E1.m1.61.61.61.15.12.12">,</mo><mrow id="S3.E1.m1.106.106.5.106.31.28.28.1.2.2"><msubsup id="S3.E1.m1.106.106.5.106.31.28.28.1.2.2.2"><mi id="S3.E1.m1.62.62.62.16.13.13">t</mi><mi mathvariant="normal" id="S3.E1.m1.63.63.63.17.14.14.1">y</mi><mo id="S3.E1.m1.64.64.64.18.15.15.1">∗</mo></msubsup><mo id="S3.E1.m1.65.65.65.19.16.16">=</mo><mrow id="S3.E1.m1.106.106.5.106.31.28.28.1.2.2.1"><mrow id="S3.E1.m1.106.106.5.106.31.28.28.1.2.2.1.1.1"><mo id="S3.E1.m1.66.66.66.20.17.17">(</mo><mrow id="S3.E1.m1.106.106.5.106.31.28.28.1.2.2.1.1.1.1"><msup id="S3.E1.m1.106.106.5.106.31.28.28.1.2.2.1.1.1.1.1"><mi id="S3.E1.m1.67.67.67.21.18.18">y</mi><mo id="S3.E1.m1.68.68.68.22.19.19.1">∗</mo></msup><mo id="S3.E1.m1.69.69.69.23.20.20">−</mo><msub id="S3.E1.m1.106.106.5.106.31.28.28.1.2.2.1.1.1.1.2"><mi id="S3.E1.m1.70.70.70.24.21.21">y</mi><mi mathvariant="normal" id="S3.E1.m1.71.71.71.25.22.22.1">a</mi></msub></mrow><mo id="S3.E1.m1.72.72.72.26.23.23">)</mo></mrow><mo id="S3.E1.m1.73.73.73.27.24.24">/</mo><msub id="S3.E1.m1.106.106.5.106.31.28.28.1.2.2.1.2"><mi id="S3.E1.m1.74.74.74.28.25.25">h</mi><mi mathvariant="normal" id="S3.E1.m1.75.75.75.29.26.26.1">a</mi></msub></mrow></mrow></mrow><mo id="S3.E1.m1.76.76.76.30.27.27">,</mo></mrow></mtd></mtr><mtr id="S3.E1.m1.108.108.7j"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.108.108.7k"><msubsup id="S3.E1.m1.79.79.79.3.3a"><mi id="S3.E1.m1.77.77.77.1.1.1">t</mi><mi mathvariant="normal" id="S3.E1.m1.78.78.78.2.2.2.1">w</mi><mo id="S3.E1.m1.79.79.79.3.3.3.1">∗</mo></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.108.108.7l"><mrow id="S3.E1.m1.108.108.7.108.27.24.24"><mrow id="S3.E1.m1.107.107.6.107.26.23.23.1"><mi id="S3.E1.m1.107.107.6.107.26.23.23.1.2"></mi><mo id="S3.E1.m1.80.80.80.4.1.1">=</mo><mrow id="S3.E1.m1.107.107.6.107.26.23.23.1.1.1"><mi id="S3.E1.m1.81.81.81.5.2.2">log</mi><mo id="S3.E1.m1.107.107.6.107.26.23.23.1.1.1a">⁡</mo><mrow id="S3.E1.m1.107.107.6.107.26.23.23.1.1.1.1"><mo id="S3.E1.m1.82.82.82.6.3.3">(</mo><mrow id="S3.E1.m1.107.107.6.107.26.23.23.1.1.1.1.1"><msup id="S3.E1.m1.107.107.6.107.26.23.23.1.1.1.1.1.1"><mi id="S3.E1.m1.83.83.83.7.4.4">w</mi><mo id="S3.E1.m1.84.84.84.8.5.5.1">∗</mo></msup><mo id="S3.E1.m1.85.85.85.9.6.6">/</mo><msub id="S3.E1.m1.107.107.6.107.26.23.23.1.1.1.1.1.2"><mi id="S3.E1.m1.86.86.86.10.7.7">w</mi><mi mathvariant="normal" id="S3.E1.m1.87.87.87.11.8.8.1">a</mi></msub></mrow><mo id="S3.E1.m1.88.88.88.12.9.9">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E1.m1.89.89.89.13.10.10">,</mo><mrow id="S3.E1.m1.108.108.7.108.27.24.24.2"><msubsup id="S3.E1.m1.108.108.7.108.27.24.24.2.2"><mi id="S3.E1.m1.90.90.90.14.11.11">t</mi><mi mathvariant="normal" id="S3.E1.m1.91.91.91.15.12.12.1">h</mi><mo id="S3.E1.m1.92.92.92.16.13.13.1">∗</mo></msubsup><mo id="S3.E1.m1.93.93.93.17.14.14">=</mo><mrow id="S3.E1.m1.108.108.7.108.27.24.24.2.1.1"><mi id="S3.E1.m1.94.94.94.18.15.15">log</mi><mo id="S3.E1.m1.108.108.7.108.27.24.24.2.1.1a">⁡</mo><mrow id="S3.E1.m1.108.108.7.108.27.24.24.2.1.1.1"><mo id="S3.E1.m1.95.95.95.19.16.16">(</mo><mrow id="S3.E1.m1.108.108.7.108.27.24.24.2.1.1.1.1"><msup id="S3.E1.m1.108.108.7.108.27.24.24.2.1.1.1.1.1"><mi id="S3.E1.m1.96.96.96.20.17.17">h</mi><mo id="S3.E1.m1.97.97.97.21.18.18.1">∗</mo></msup><mo id="S3.E1.m1.98.98.98.22.19.19">/</mo><msub id="S3.E1.m1.108.108.7.108.27.24.24.2.1.1.1.1.2"><mi id="S3.E1.m1.99.99.99.23.20.20">h</mi><mi mathvariant="normal" id="S3.E1.m1.100.100.100.24.21.21.1">a</mi></msub></mrow><mo id="S3.E1.m1.101.101.101.25.22.22">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E1.m1.108b">\displaystyle\begin{split}t_{\mathrm{x}}&amp;=\left(x-x_{\mathrm{a}}\right)/w_{\mathrm{a}},\quad t_{\mathrm{y}}=\left(y-y_{\mathrm{a}}\right)/h_{\mathrm{a}}\\
t_{\mathrm{w}}&amp;=\log\left(w/w_{\mathrm{a}}\right),\quad t_{\mathrm{h}}=\log\left(h/h_{\mathrm{a}}\right)\\
t_{\mathrm{x}}^{*}&amp;=\left(x^{*}-x_{\mathrm{a}}\right)/w_{\mathrm{a}},\quad t_{\mathrm{y}}^{*}=\left(y^{*}-y_{\mathrm{a}}\right)/h_{\mathrm{a}},\\
t_{\mathrm{w}}^{*}&amp;=\log\left(w^{*}/w_{\mathrm{a}}\right),\quad t_{\mathrm{h}}^{*}=\log\left(h^{*}/h_{\mathrm{a}}\right)\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p6" class="ltx_para ltx_noindent">
<p id="S3.SS1.p6.12" class="ltx_p">where <math id="S3.SS1.p6.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p6.1.m1.1a"><mi id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">x</annotation></semantics></math>, <math id="S3.SS1.p6.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p6.2.m2.1a"><mi id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><ci id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">y</annotation></semantics></math>, <math id="S3.SS1.p6.3.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p6.3.m3.1a"><mi id="S3.SS1.p6.3.m3.1.1" xref="S3.SS1.p6.3.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.1b"><ci id="S3.SS1.p6.3.m3.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.1c">w</annotation></semantics></math>, and <math id="S3.SS1.p6.4.m4.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS1.p6.4.m4.1a"><mi id="S3.SS1.p6.4.m4.1.1" xref="S3.SS1.p6.4.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.4.m4.1b"><ci id="S3.SS1.p6.4.m4.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.4.m4.1c">h</annotation></semantics></math> represent the center coordinates and the width and height of the box, respectively. <math id="S3.SS1.p6.5.m5.1" class="ltx_Math" alttext="x_{\mathrm{a}}" display="inline"><semantics id="S3.SS1.p6.5.m5.1a"><msub id="S3.SS1.p6.5.m5.1.1" xref="S3.SS1.p6.5.m5.1.1.cmml"><mi id="S3.SS1.p6.5.m5.1.1.2" xref="S3.SS1.p6.5.m5.1.1.2.cmml">x</mi><mi mathvariant="normal" id="S3.SS1.p6.5.m5.1.1.3" xref="S3.SS1.p6.5.m5.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.5.m5.1b"><apply id="S3.SS1.p6.5.m5.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.5.m5.1.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p6.5.m5.1.1.2.cmml" xref="S3.SS1.p6.5.m5.1.1.2">𝑥</ci><ci id="S3.SS1.p6.5.m5.1.1.3.cmml" xref="S3.SS1.p6.5.m5.1.1.3">a</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.5.m5.1c">x_{\mathrm{a}}</annotation></semantics></math>, <math id="S3.SS1.p6.6.m6.1" class="ltx_Math" alttext="y_{\mathrm{a}}" display="inline"><semantics id="S3.SS1.p6.6.m6.1a"><msub id="S3.SS1.p6.6.m6.1.1" xref="S3.SS1.p6.6.m6.1.1.cmml"><mi id="S3.SS1.p6.6.m6.1.1.2" xref="S3.SS1.p6.6.m6.1.1.2.cmml">y</mi><mi mathvariant="normal" id="S3.SS1.p6.6.m6.1.1.3" xref="S3.SS1.p6.6.m6.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.6.m6.1b"><apply id="S3.SS1.p6.6.m6.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.6.m6.1.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p6.6.m6.1.1.2.cmml" xref="S3.SS1.p6.6.m6.1.1.2">𝑦</ci><ci id="S3.SS1.p6.6.m6.1.1.3.cmml" xref="S3.SS1.p6.6.m6.1.1.3">a</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.6.m6.1c">y_{\mathrm{a}}</annotation></semantics></math>, <math id="S3.SS1.p6.7.m7.1" class="ltx_Math" alttext="w_{\mathrm{a}}" display="inline"><semantics id="S3.SS1.p6.7.m7.1a"><msub id="S3.SS1.p6.7.m7.1.1" xref="S3.SS1.p6.7.m7.1.1.cmml"><mi id="S3.SS1.p6.7.m7.1.1.2" xref="S3.SS1.p6.7.m7.1.1.2.cmml">w</mi><mi mathvariant="normal" id="S3.SS1.p6.7.m7.1.1.3" xref="S3.SS1.p6.7.m7.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.7.m7.1b"><apply id="S3.SS1.p6.7.m7.1.1.cmml" xref="S3.SS1.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.7.m7.1.1.1.cmml" xref="S3.SS1.p6.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p6.7.m7.1.1.2.cmml" xref="S3.SS1.p6.7.m7.1.1.2">𝑤</ci><ci id="S3.SS1.p6.7.m7.1.1.3.cmml" xref="S3.SS1.p6.7.m7.1.1.3">a</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.7.m7.1c">w_{\mathrm{a}}</annotation></semantics></math>, and <math id="S3.SS1.p6.8.m8.1" class="ltx_Math" alttext="h_{\mathrm{a}}" display="inline"><semantics id="S3.SS1.p6.8.m8.1a"><msub id="S3.SS1.p6.8.m8.1.1" xref="S3.SS1.p6.8.m8.1.1.cmml"><mi id="S3.SS1.p6.8.m8.1.1.2" xref="S3.SS1.p6.8.m8.1.1.2.cmml">h</mi><mi mathvariant="normal" id="S3.SS1.p6.8.m8.1.1.3" xref="S3.SS1.p6.8.m8.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.8.m8.1b"><apply id="S3.SS1.p6.8.m8.1.1.cmml" xref="S3.SS1.p6.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.8.m8.1.1.1.cmml" xref="S3.SS1.p6.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p6.8.m8.1.1.2.cmml" xref="S3.SS1.p6.8.m8.1.1.2">ℎ</ci><ci id="S3.SS1.p6.8.m8.1.1.3.cmml" xref="S3.SS1.p6.8.m8.1.1.3">a</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.8.m8.1c">h_{\mathrm{a}}</annotation></semantics></math> denote the corresponding values of the anchor box, and <math id="S3.SS1.p6.9.m9.1" class="ltx_Math" alttext="x^{*}" display="inline"><semantics id="S3.SS1.p6.9.m9.1a"><msup id="S3.SS1.p6.9.m9.1.1" xref="S3.SS1.p6.9.m9.1.1.cmml"><mi id="S3.SS1.p6.9.m9.1.1.2" xref="S3.SS1.p6.9.m9.1.1.2.cmml">x</mi><mo id="S3.SS1.p6.9.m9.1.1.3" xref="S3.SS1.p6.9.m9.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.9.m9.1b"><apply id="S3.SS1.p6.9.m9.1.1.cmml" xref="S3.SS1.p6.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.9.m9.1.1.1.cmml" xref="S3.SS1.p6.9.m9.1.1">superscript</csymbol><ci id="S3.SS1.p6.9.m9.1.1.2.cmml" xref="S3.SS1.p6.9.m9.1.1.2">𝑥</ci><times id="S3.SS1.p6.9.m9.1.1.3.cmml" xref="S3.SS1.p6.9.m9.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.9.m9.1c">x^{*}</annotation></semantics></math>, <math id="S3.SS1.p6.10.m10.1" class="ltx_Math" alttext="y^{*}" display="inline"><semantics id="S3.SS1.p6.10.m10.1a"><msup id="S3.SS1.p6.10.m10.1.1" xref="S3.SS1.p6.10.m10.1.1.cmml"><mi id="S3.SS1.p6.10.m10.1.1.2" xref="S3.SS1.p6.10.m10.1.1.2.cmml">y</mi><mo id="S3.SS1.p6.10.m10.1.1.3" xref="S3.SS1.p6.10.m10.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.10.m10.1b"><apply id="S3.SS1.p6.10.m10.1.1.cmml" xref="S3.SS1.p6.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.10.m10.1.1.1.cmml" xref="S3.SS1.p6.10.m10.1.1">superscript</csymbol><ci id="S3.SS1.p6.10.m10.1.1.2.cmml" xref="S3.SS1.p6.10.m10.1.1.2">𝑦</ci><times id="S3.SS1.p6.10.m10.1.1.3.cmml" xref="S3.SS1.p6.10.m10.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.10.m10.1c">y^{*}</annotation></semantics></math>, <math id="S3.SS1.p6.11.m11.1" class="ltx_Math" alttext="w^{*}" display="inline"><semantics id="S3.SS1.p6.11.m11.1a"><msup id="S3.SS1.p6.11.m11.1.1" xref="S3.SS1.p6.11.m11.1.1.cmml"><mi id="S3.SS1.p6.11.m11.1.1.2" xref="S3.SS1.p6.11.m11.1.1.2.cmml">w</mi><mo id="S3.SS1.p6.11.m11.1.1.3" xref="S3.SS1.p6.11.m11.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.11.m11.1b"><apply id="S3.SS1.p6.11.m11.1.1.cmml" xref="S3.SS1.p6.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.11.m11.1.1.1.cmml" xref="S3.SS1.p6.11.m11.1.1">superscript</csymbol><ci id="S3.SS1.p6.11.m11.1.1.2.cmml" xref="S3.SS1.p6.11.m11.1.1.2">𝑤</ci><times id="S3.SS1.p6.11.m11.1.1.3.cmml" xref="S3.SS1.p6.11.m11.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.11.m11.1c">w^{*}</annotation></semantics></math>, and <math id="S3.SS1.p6.12.m12.1" class="ltx_Math" alttext="h^{*}" display="inline"><semantics id="S3.SS1.p6.12.m12.1a"><msup id="S3.SS1.p6.12.m12.1.1" xref="S3.SS1.p6.12.m12.1.1.cmml"><mi id="S3.SS1.p6.12.m12.1.1.2" xref="S3.SS1.p6.12.m12.1.1.2.cmml">h</mi><mo id="S3.SS1.p6.12.m12.1.1.3" xref="S3.SS1.p6.12.m12.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.12.m12.1b"><apply id="S3.SS1.p6.12.m12.1.1.cmml" xref="S3.SS1.p6.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.12.m12.1.1.1.cmml" xref="S3.SS1.p6.12.m12.1.1">superscript</csymbol><ci id="S3.SS1.p6.12.m12.1.1.2.cmml" xref="S3.SS1.p6.12.m12.1.1.2">ℎ</ci><times id="S3.SS1.p6.12.m12.1.1.3.cmml" xref="S3.SS1.p6.12.m12.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.12.m12.1c">h^{*}</annotation></semantics></math> for the ground-truth box.</p>
</div>
<div id="S3.SS1.p7" class="ltx_para ltx_noindent">
<p id="S3.SS1.p7.1" class="ltx_p">Therefore, the objective of the RPN is to minimize a multi-task loss function that encompasses a component for the binary classification task and another component for the regression task:</p>
</div>
<div id="S3.SS1.p8" class="ltx_para ltx_noindent">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\mathcal{L}_{\text{rpn}}=\frac{1}{N_{cls}}\sum_{i}L_{cls}(p_{i},p_{i}^{*})+\lambda\frac{1}{N_{reg}}\sum_{i}p_{i}^{*}L_{reg}(t_{i},t_{i}^{*})" display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><msub id="S3.E2.m1.4.4.6" xref="S3.E2.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.6.2" xref="S3.E2.m1.4.4.6.2.cmml">ℒ</mi><mtext id="S3.E2.m1.4.4.6.3" xref="S3.E2.m1.4.4.6.3a.cmml">rpn</mtext></msub><mo id="S3.E2.m1.4.4.5" xref="S3.E2.m1.4.4.5.cmml">=</mo><mrow id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml"><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><mfrac id="S3.E2.m1.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.4.cmml"><mn id="S3.E2.m1.2.2.2.2.4.2" xref="S3.E2.m1.2.2.2.2.4.2.cmml">1</mn><msub id="S3.E2.m1.2.2.2.2.4.3" xref="S3.E2.m1.2.2.2.2.4.3.cmml"><mi id="S3.E2.m1.2.2.2.2.4.3.2" xref="S3.E2.m1.2.2.2.2.4.3.2.cmml">N</mi><mrow id="S3.E2.m1.2.2.2.2.4.3.3" xref="S3.E2.m1.2.2.2.2.4.3.3.cmml"><mi id="S3.E2.m1.2.2.2.2.4.3.3.2" xref="S3.E2.m1.2.2.2.2.4.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.4.3.3.1" xref="S3.E2.m1.2.2.2.2.4.3.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.4.3.3.3" xref="S3.E2.m1.2.2.2.2.4.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.4.3.3.1a" xref="S3.E2.m1.2.2.2.2.4.3.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.4.3.3.4" xref="S3.E2.m1.2.2.2.2.4.3.3.4.cmml">s</mi></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.cmml"><munder id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E2.m1.2.2.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.2.3.2.cmml">∑</mo><mi id="S3.E2.m1.2.2.2.2.2.3.3" xref="S3.E2.m1.2.2.2.2.2.3.3.cmml">i</mi></munder><mrow id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml"><msub id="S3.E2.m1.2.2.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.2.2.4.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.4.2" xref="S3.E2.m1.2.2.2.2.2.2.4.2.cmml">L</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.4.3" xref="S3.E2.m1.2.2.2.2.2.2.4.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.4.3.2" xref="S3.E2.m1.2.2.2.2.2.2.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.2.4.3.1" xref="S3.E2.m1.2.2.2.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.2.2.4.3.3" xref="S3.E2.m1.2.2.2.2.2.2.4.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.2.4.3.1a" xref="S3.E2.m1.2.2.2.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.2.2.4.3.4" xref="S3.E2.m1.2.2.2.2.2.2.4.3.4.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.2.2.2.2.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E2.m1.2.2.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2.2.2.cmml">p</mi><mi id="S3.E2.m1.2.2.2.2.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2.2.3.cmml">i</mi><mo id="S3.E2.m1.2.2.2.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.2.2.5" xref="S3.E2.m1.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.4.4.4.5" xref="S3.E2.m1.4.4.4.5.cmml">+</mo><mrow id="S3.E2.m1.4.4.4.4" xref="S3.E2.m1.4.4.4.4.cmml"><mi id="S3.E2.m1.4.4.4.4.4" xref="S3.E2.m1.4.4.4.4.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.3" xref="S3.E2.m1.4.4.4.4.3.cmml">​</mo><mfrac id="S3.E2.m1.4.4.4.4.5" xref="S3.E2.m1.4.4.4.4.5.cmml"><mn id="S3.E2.m1.4.4.4.4.5.2" xref="S3.E2.m1.4.4.4.4.5.2.cmml">1</mn><msub id="S3.E2.m1.4.4.4.4.5.3" xref="S3.E2.m1.4.4.4.4.5.3.cmml"><mi id="S3.E2.m1.4.4.4.4.5.3.2" xref="S3.E2.m1.4.4.4.4.5.3.2.cmml">N</mi><mrow id="S3.E2.m1.4.4.4.4.5.3.3" xref="S3.E2.m1.4.4.4.4.5.3.3.cmml"><mi id="S3.E2.m1.4.4.4.4.5.3.3.2" xref="S3.E2.m1.4.4.4.4.5.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.5.3.3.1" xref="S3.E2.m1.4.4.4.4.5.3.3.1.cmml">​</mo><mi id="S3.E2.m1.4.4.4.4.5.3.3.3" xref="S3.E2.m1.4.4.4.4.5.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.5.3.3.1a" xref="S3.E2.m1.4.4.4.4.5.3.3.1.cmml">​</mo><mi id="S3.E2.m1.4.4.4.4.5.3.3.4" xref="S3.E2.m1.4.4.4.4.5.3.3.4.cmml">g</mi></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.3a" xref="S3.E2.m1.4.4.4.4.3.cmml">​</mo><mrow id="S3.E2.m1.4.4.4.4.2" xref="S3.E2.m1.4.4.4.4.2.cmml"><munder id="S3.E2.m1.4.4.4.4.2.3" xref="S3.E2.m1.4.4.4.4.2.3.cmml"><mo movablelimits="false" id="S3.E2.m1.4.4.4.4.2.3.2" xref="S3.E2.m1.4.4.4.4.2.3.2.cmml">∑</mo><mi id="S3.E2.m1.4.4.4.4.2.3.3" xref="S3.E2.m1.4.4.4.4.2.3.3.cmml">i</mi></munder><mrow id="S3.E2.m1.4.4.4.4.2.2" xref="S3.E2.m1.4.4.4.4.2.2.cmml"><msubsup id="S3.E2.m1.4.4.4.4.2.2.4" xref="S3.E2.m1.4.4.4.4.2.2.4.cmml"><mi id="S3.E2.m1.4.4.4.4.2.2.4.2.2" xref="S3.E2.m1.4.4.4.4.2.2.4.2.2.cmml">p</mi><mi id="S3.E2.m1.4.4.4.4.2.2.4.2.3" xref="S3.E2.m1.4.4.4.4.2.2.4.2.3.cmml">i</mi><mo id="S3.E2.m1.4.4.4.4.2.2.4.3" xref="S3.E2.m1.4.4.4.4.2.2.4.3.cmml">∗</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.2.2.3" xref="S3.E2.m1.4.4.4.4.2.2.3.cmml">​</mo><msub id="S3.E2.m1.4.4.4.4.2.2.5" xref="S3.E2.m1.4.4.4.4.2.2.5.cmml"><mi id="S3.E2.m1.4.4.4.4.2.2.5.2" xref="S3.E2.m1.4.4.4.4.2.2.5.2.cmml">L</mi><mrow id="S3.E2.m1.4.4.4.4.2.2.5.3" xref="S3.E2.m1.4.4.4.4.2.2.5.3.cmml"><mi id="S3.E2.m1.4.4.4.4.2.2.5.3.2" xref="S3.E2.m1.4.4.4.4.2.2.5.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.2.2.5.3.1" xref="S3.E2.m1.4.4.4.4.2.2.5.3.1.cmml">​</mo><mi id="S3.E2.m1.4.4.4.4.2.2.5.3.3" xref="S3.E2.m1.4.4.4.4.2.2.5.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.2.2.5.3.1a" xref="S3.E2.m1.4.4.4.4.2.2.5.3.1.cmml">​</mo><mi id="S3.E2.m1.4.4.4.4.2.2.5.3.4" xref="S3.E2.m1.4.4.4.4.2.2.5.3.4.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.4.2.2.3a" xref="S3.E2.m1.4.4.4.4.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.4.4.4.4.2.2.2.2" xref="S3.E2.m1.4.4.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.4.4.2.2.2.2.3" xref="S3.E2.m1.4.4.4.4.2.2.2.3.cmml">(</mo><msub id="S3.E2.m1.3.3.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.2.cmml">t</mi><mi id="S3.E2.m1.3.3.3.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.4.4.4.4.2.2.2.2.4" xref="S3.E2.m1.4.4.4.4.2.2.2.3.cmml">,</mo><msubsup id="S3.E2.m1.4.4.4.4.2.2.2.2.2" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2.cmml"><mi id="S3.E2.m1.4.4.4.4.2.2.2.2.2.2.2" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2.2.2.cmml">t</mi><mi id="S3.E2.m1.4.4.4.4.2.2.2.2.2.2.3" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2.2.3.cmml">i</mi><mo id="S3.E2.m1.4.4.4.4.2.2.2.2.2.3" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S3.E2.m1.4.4.4.4.2.2.2.2.5" xref="S3.E2.m1.4.4.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><eq id="S3.E2.m1.4.4.5.cmml" xref="S3.E2.m1.4.4.5"></eq><apply id="S3.E2.m1.4.4.6.cmml" xref="S3.E2.m1.4.4.6"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.6.1.cmml" xref="S3.E2.m1.4.4.6">subscript</csymbol><ci id="S3.E2.m1.4.4.6.2.cmml" xref="S3.E2.m1.4.4.6.2">ℒ</ci><ci id="S3.E2.m1.4.4.6.3a.cmml" xref="S3.E2.m1.4.4.6.3"><mtext mathsize="70%" id="S3.E2.m1.4.4.6.3.cmml" xref="S3.E2.m1.4.4.6.3">rpn</mtext></ci></apply><apply id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"><plus id="S3.E2.m1.4.4.4.5.cmml" xref="S3.E2.m1.4.4.4.5"></plus><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3"></times><apply id="S3.E2.m1.2.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.2.4"><divide id="S3.E2.m1.2.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.2.4"></divide><cn type="integer" id="S3.E2.m1.2.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.2.4.2">1</cn><apply id="S3.E2.m1.2.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.4.3.1.cmml" xref="S3.E2.m1.2.2.2.2.4.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.4.3.2.cmml" xref="S3.E2.m1.2.2.2.2.4.3.2">𝑁</ci><apply id="S3.E2.m1.2.2.2.2.4.3.3.cmml" xref="S3.E2.m1.2.2.2.2.4.3.3"><times id="S3.E2.m1.2.2.2.2.4.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.4.3.3.1"></times><ci id="S3.E2.m1.2.2.2.2.4.3.3.2.cmml" xref="S3.E2.m1.2.2.2.2.4.3.3.2">𝑐</ci><ci id="S3.E2.m1.2.2.2.2.4.3.3.3.cmml" xref="S3.E2.m1.2.2.2.2.4.3.3.3">𝑙</ci><ci id="S3.E2.m1.2.2.2.2.4.3.3.4.cmml" xref="S3.E2.m1.2.2.2.2.4.3.3.4">𝑠</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2"><apply id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.3">subscript</csymbol><sum id="S3.E2.m1.2.2.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.3.2"></sum><ci id="S3.E2.m1.2.2.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3.3">𝑖</ci></apply><apply id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3"></times><apply id="S3.E2.m1.2.2.2.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.2">𝐿</ci><apply id="S3.E2.m1.2.2.2.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3"><times id="S3.E2.m1.2.2.2.2.2.2.4.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3.1"></times><ci id="S3.E2.m1.2.2.2.2.2.2.4.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3.2">𝑐</ci><ci id="S3.E2.m1.2.2.2.2.2.2.4.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3.3">𝑙</ci><ci id="S3.E2.m1.2.2.2.2.2.2.4.3.4.cmml" xref="S3.E2.m1.2.2.2.2.2.2.4.3.4">𝑠</ci></apply></apply><interval closure="open" id="S3.E2.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E2.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2.2.2">𝑝</ci><ci id="S3.E2.m1.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><times id="S3.E2.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2.2.3"></times></apply></interval></apply></apply></apply><apply id="S3.E2.m1.4.4.4.4.cmml" xref="S3.E2.m1.4.4.4.4"><times id="S3.E2.m1.4.4.4.4.3.cmml" xref="S3.E2.m1.4.4.4.4.3"></times><ci id="S3.E2.m1.4.4.4.4.4.cmml" xref="S3.E2.m1.4.4.4.4.4">𝜆</ci><apply id="S3.E2.m1.4.4.4.4.5.cmml" xref="S3.E2.m1.4.4.4.4.5"><divide id="S3.E2.m1.4.4.4.4.5.1.cmml" xref="S3.E2.m1.4.4.4.4.5"></divide><cn type="integer" id="S3.E2.m1.4.4.4.4.5.2.cmml" xref="S3.E2.m1.4.4.4.4.5.2">1</cn><apply id="S3.E2.m1.4.4.4.4.5.3.cmml" xref="S3.E2.m1.4.4.4.4.5.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.5.3.1.cmml" xref="S3.E2.m1.4.4.4.4.5.3">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.5.3.2.cmml" xref="S3.E2.m1.4.4.4.4.5.3.2">𝑁</ci><apply id="S3.E2.m1.4.4.4.4.5.3.3.cmml" xref="S3.E2.m1.4.4.4.4.5.3.3"><times id="S3.E2.m1.4.4.4.4.5.3.3.1.cmml" xref="S3.E2.m1.4.4.4.4.5.3.3.1"></times><ci id="S3.E2.m1.4.4.4.4.5.3.3.2.cmml" xref="S3.E2.m1.4.4.4.4.5.3.3.2">𝑟</ci><ci id="S3.E2.m1.4.4.4.4.5.3.3.3.cmml" xref="S3.E2.m1.4.4.4.4.5.3.3.3">𝑒</ci><ci id="S3.E2.m1.4.4.4.4.5.3.3.4.cmml" xref="S3.E2.m1.4.4.4.4.5.3.3.4">𝑔</ci></apply></apply></apply><apply id="S3.E2.m1.4.4.4.4.2.cmml" xref="S3.E2.m1.4.4.4.4.2"><apply id="S3.E2.m1.4.4.4.4.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.3.1.cmml" xref="S3.E2.m1.4.4.4.4.2.3">subscript</csymbol><sum id="S3.E2.m1.4.4.4.4.2.3.2.cmml" xref="S3.E2.m1.4.4.4.4.2.3.2"></sum><ci id="S3.E2.m1.4.4.4.4.2.3.3.cmml" xref="S3.E2.m1.4.4.4.4.2.3.3">𝑖</ci></apply><apply id="S3.E2.m1.4.4.4.4.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2"><times id="S3.E2.m1.4.4.4.4.2.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.3"></times><apply id="S3.E2.m1.4.4.4.4.2.2.4.cmml" xref="S3.E2.m1.4.4.4.4.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.2.4.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.4">superscript</csymbol><apply id="S3.E2.m1.4.4.4.4.2.2.4.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.2.4.2.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.4">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.2.2.4.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.4.2.2">𝑝</ci><ci id="S3.E2.m1.4.4.4.4.2.2.4.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.4.2.3">𝑖</ci></apply><times id="S3.E2.m1.4.4.4.4.2.2.4.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.4.3"></times></apply><apply id="S3.E2.m1.4.4.4.4.2.2.5.cmml" xref="S3.E2.m1.4.4.4.4.2.2.5"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.2.5.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.5">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.2.2.5.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.5.2">𝐿</ci><apply id="S3.E2.m1.4.4.4.4.2.2.5.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.5.3"><times id="S3.E2.m1.4.4.4.4.2.2.5.3.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.5.3.1"></times><ci id="S3.E2.m1.4.4.4.4.2.2.5.3.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.5.3.2">𝑟</ci><ci id="S3.E2.m1.4.4.4.4.2.2.5.3.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.5.3.3">𝑒</ci><ci id="S3.E2.m1.4.4.4.4.2.2.5.3.4.cmml" xref="S3.E2.m1.4.4.4.4.2.2.5.3.4">𝑔</ci></apply></apply><interval closure="open" id="S3.E2.m1.4.4.4.4.2.2.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2.2"><apply id="S3.E2.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.2">𝑡</ci><ci id="S3.E2.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E2.m1.4.4.4.4.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.4.4.4.4.2.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2.2.2">𝑡</ci><ci id="S3.E2.m1.4.4.4.4.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2.2.3">𝑖</ci></apply><times id="S3.E2.m1.4.4.4.4.2.2.2.2.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2.2.2.3"></times></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\mathcal{L}_{\text{rpn}}=\frac{1}{N_{cls}}\sum_{i}L_{cls}(p_{i},p_{i}^{*})+\lambda\frac{1}{N_{reg}}\sum_{i}p_{i}^{*}L_{reg}(t_{i},t_{i}^{*})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p9" class="ltx_para ltx_noindent">
<p id="S3.SS1.p9.10" class="ltx_p">where <math id="S3.SS1.p9.1.m1.1" class="ltx_Math" alttext="N_{cls}" display="inline"><semantics id="S3.SS1.p9.1.m1.1a"><msub id="S3.SS1.p9.1.m1.1.1" xref="S3.SS1.p9.1.m1.1.1.cmml"><mi id="S3.SS1.p9.1.m1.1.1.2" xref="S3.SS1.p9.1.m1.1.1.2.cmml">N</mi><mrow id="S3.SS1.p9.1.m1.1.1.3" xref="S3.SS1.p9.1.m1.1.1.3.cmml"><mi id="S3.SS1.p9.1.m1.1.1.3.2" xref="S3.SS1.p9.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p9.1.m1.1.1.3.1" xref="S3.SS1.p9.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p9.1.m1.1.1.3.3" xref="S3.SS1.p9.1.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p9.1.m1.1.1.3.1a" xref="S3.SS1.p9.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p9.1.m1.1.1.3.4" xref="S3.SS1.p9.1.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.1.m1.1b"><apply id="S3.SS1.p9.1.m1.1.1.cmml" xref="S3.SS1.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.1.m1.1.1.1.cmml" xref="S3.SS1.p9.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p9.1.m1.1.1.2.cmml" xref="S3.SS1.p9.1.m1.1.1.2">𝑁</ci><apply id="S3.SS1.p9.1.m1.1.1.3.cmml" xref="S3.SS1.p9.1.m1.1.1.3"><times id="S3.SS1.p9.1.m1.1.1.3.1.cmml" xref="S3.SS1.p9.1.m1.1.1.3.1"></times><ci id="S3.SS1.p9.1.m1.1.1.3.2.cmml" xref="S3.SS1.p9.1.m1.1.1.3.2">𝑐</ci><ci id="S3.SS1.p9.1.m1.1.1.3.3.cmml" xref="S3.SS1.p9.1.m1.1.1.3.3">𝑙</ci><ci id="S3.SS1.p9.1.m1.1.1.3.4.cmml" xref="S3.SS1.p9.1.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.1.m1.1c">N_{cls}</annotation></semantics></math> and <math id="S3.SS1.p9.2.m2.1" class="ltx_Math" alttext="N_{reg}" display="inline"><semantics id="S3.SS1.p9.2.m2.1a"><msub id="S3.SS1.p9.2.m2.1.1" xref="S3.SS1.p9.2.m2.1.1.cmml"><mi id="S3.SS1.p9.2.m2.1.1.2" xref="S3.SS1.p9.2.m2.1.1.2.cmml">N</mi><mrow id="S3.SS1.p9.2.m2.1.1.3" xref="S3.SS1.p9.2.m2.1.1.3.cmml"><mi id="S3.SS1.p9.2.m2.1.1.3.2" xref="S3.SS1.p9.2.m2.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p9.2.m2.1.1.3.1" xref="S3.SS1.p9.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p9.2.m2.1.1.3.3" xref="S3.SS1.p9.2.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p9.2.m2.1.1.3.1a" xref="S3.SS1.p9.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p9.2.m2.1.1.3.4" xref="S3.SS1.p9.2.m2.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.2.m2.1b"><apply id="S3.SS1.p9.2.m2.1.1.cmml" xref="S3.SS1.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.2.m2.1.1.1.cmml" xref="S3.SS1.p9.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p9.2.m2.1.1.2.cmml" xref="S3.SS1.p9.2.m2.1.1.2">𝑁</ci><apply id="S3.SS1.p9.2.m2.1.1.3.cmml" xref="S3.SS1.p9.2.m2.1.1.3"><times id="S3.SS1.p9.2.m2.1.1.3.1.cmml" xref="S3.SS1.p9.2.m2.1.1.3.1"></times><ci id="S3.SS1.p9.2.m2.1.1.3.2.cmml" xref="S3.SS1.p9.2.m2.1.1.3.2">𝑟</ci><ci id="S3.SS1.p9.2.m2.1.1.3.3.cmml" xref="S3.SS1.p9.2.m2.1.1.3.3">𝑒</ci><ci id="S3.SS1.p9.2.m2.1.1.3.4.cmml" xref="S3.SS1.p9.2.m2.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.2.m2.1c">N_{reg}</annotation></semantics></math> are the total number of anchors used for classification and regression, respectively, <math id="S3.SS1.p9.3.m3.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S3.SS1.p9.3.m3.1a"><msub id="S3.SS1.p9.3.m3.1.1" xref="S3.SS1.p9.3.m3.1.1.cmml"><mi id="S3.SS1.p9.3.m3.1.1.2" xref="S3.SS1.p9.3.m3.1.1.2.cmml">p</mi><mi id="S3.SS1.p9.3.m3.1.1.3" xref="S3.SS1.p9.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.3.m3.1b"><apply id="S3.SS1.p9.3.m3.1.1.cmml" xref="S3.SS1.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.3.m3.1.1.1.cmml" xref="S3.SS1.p9.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p9.3.m3.1.1.2.cmml" xref="S3.SS1.p9.3.m3.1.1.2">𝑝</ci><ci id="S3.SS1.p9.3.m3.1.1.3.cmml" xref="S3.SS1.p9.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.3.m3.1c">p_{i}</annotation></semantics></math> and <math id="S3.SS1.p9.4.m4.1" class="ltx_Math" alttext="t_{i}" display="inline"><semantics id="S3.SS1.p9.4.m4.1a"><msub id="S3.SS1.p9.4.m4.1.1" xref="S3.SS1.p9.4.m4.1.1.cmml"><mi id="S3.SS1.p9.4.m4.1.1.2" xref="S3.SS1.p9.4.m4.1.1.2.cmml">t</mi><mi id="S3.SS1.p9.4.m4.1.1.3" xref="S3.SS1.p9.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.4.m4.1b"><apply id="S3.SS1.p9.4.m4.1.1.cmml" xref="S3.SS1.p9.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.4.m4.1.1.1.cmml" xref="S3.SS1.p9.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p9.4.m4.1.1.2.cmml" xref="S3.SS1.p9.4.m4.1.1.2">𝑡</ci><ci id="S3.SS1.p9.4.m4.1.1.3.cmml" xref="S3.SS1.p9.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.4.m4.1c">t_{i}</annotation></semantics></math> are the predicted class label and bounding box regression coefficients for the <math id="S3.SS1.p9.5.m5.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS1.p9.5.m5.1a"><msup id="S3.SS1.p9.5.m5.1.1" xref="S3.SS1.p9.5.m5.1.1.cmml"><mi id="S3.SS1.p9.5.m5.1.1.2" xref="S3.SS1.p9.5.m5.1.1.2.cmml">i</mi><mrow id="S3.SS1.p9.5.m5.1.1.3" xref="S3.SS1.p9.5.m5.1.1.3.cmml"><mi id="S3.SS1.p9.5.m5.1.1.3.2" xref="S3.SS1.p9.5.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p9.5.m5.1.1.3.1" xref="S3.SS1.p9.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p9.5.m5.1.1.3.3" xref="S3.SS1.p9.5.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.5.m5.1b"><apply id="S3.SS1.p9.5.m5.1.1.cmml" xref="S3.SS1.p9.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.5.m5.1.1.1.cmml" xref="S3.SS1.p9.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p9.5.m5.1.1.2.cmml" xref="S3.SS1.p9.5.m5.1.1.2">𝑖</ci><apply id="S3.SS1.p9.5.m5.1.1.3.cmml" xref="S3.SS1.p9.5.m5.1.1.3"><times id="S3.SS1.p9.5.m5.1.1.3.1.cmml" xref="S3.SS1.p9.5.m5.1.1.3.1"></times><ci id="S3.SS1.p9.5.m5.1.1.3.2.cmml" xref="S3.SS1.p9.5.m5.1.1.3.2">𝑡</ci><ci id="S3.SS1.p9.5.m5.1.1.3.3.cmml" xref="S3.SS1.p9.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.5.m5.1c">i^{th}</annotation></semantics></math> anchor, and <math id="S3.SS1.p9.6.m6.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S3.SS1.p9.6.m6.1a"><msub id="S3.SS1.p9.6.m6.1.1" xref="S3.SS1.p9.6.m6.1.1.cmml"><mi id="S3.SS1.p9.6.m6.1.1.2" xref="S3.SS1.p9.6.m6.1.1.2.cmml">p</mi><mi id="S3.SS1.p9.6.m6.1.1.3" xref="S3.SS1.p9.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.6.m6.1b"><apply id="S3.SS1.p9.6.m6.1.1.cmml" xref="S3.SS1.p9.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.6.m6.1.1.1.cmml" xref="S3.SS1.p9.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p9.6.m6.1.1.2.cmml" xref="S3.SS1.p9.6.m6.1.1.2">𝑝</ci><ci id="S3.SS1.p9.6.m6.1.1.3.cmml" xref="S3.SS1.p9.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.6.m6.1c">p_{i}</annotation></semantics></math> and <math id="S3.SS1.p9.7.m7.1" class="ltx_Math" alttext="t_{i}" display="inline"><semantics id="S3.SS1.p9.7.m7.1a"><msub id="S3.SS1.p9.7.m7.1.1" xref="S3.SS1.p9.7.m7.1.1.cmml"><mi id="S3.SS1.p9.7.m7.1.1.2" xref="S3.SS1.p9.7.m7.1.1.2.cmml">t</mi><mi id="S3.SS1.p9.7.m7.1.1.3" xref="S3.SS1.p9.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.7.m7.1b"><apply id="S3.SS1.p9.7.m7.1.1.cmml" xref="S3.SS1.p9.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.7.m7.1.1.1.cmml" xref="S3.SS1.p9.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p9.7.m7.1.1.2.cmml" xref="S3.SS1.p9.7.m7.1.1.2">𝑡</ci><ci id="S3.SS1.p9.7.m7.1.1.3.cmml" xref="S3.SS1.p9.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.7.m7.1c">t_{i}</annotation></semantics></math> are the ground truth labels. <math id="S3.SS1.p9.8.m8.1" class="ltx_Math" alttext="L_{cls}" display="inline"><semantics id="S3.SS1.p9.8.m8.1a"><msub id="S3.SS1.p9.8.m8.1.1" xref="S3.SS1.p9.8.m8.1.1.cmml"><mi id="S3.SS1.p9.8.m8.1.1.2" xref="S3.SS1.p9.8.m8.1.1.2.cmml">L</mi><mrow id="S3.SS1.p9.8.m8.1.1.3" xref="S3.SS1.p9.8.m8.1.1.3.cmml"><mi id="S3.SS1.p9.8.m8.1.1.3.2" xref="S3.SS1.p9.8.m8.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p9.8.m8.1.1.3.1" xref="S3.SS1.p9.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p9.8.m8.1.1.3.3" xref="S3.SS1.p9.8.m8.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p9.8.m8.1.1.3.1a" xref="S3.SS1.p9.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p9.8.m8.1.1.3.4" xref="S3.SS1.p9.8.m8.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.8.m8.1b"><apply id="S3.SS1.p9.8.m8.1.1.cmml" xref="S3.SS1.p9.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.8.m8.1.1.1.cmml" xref="S3.SS1.p9.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p9.8.m8.1.1.2.cmml" xref="S3.SS1.p9.8.m8.1.1.2">𝐿</ci><apply id="S3.SS1.p9.8.m8.1.1.3.cmml" xref="S3.SS1.p9.8.m8.1.1.3"><times id="S3.SS1.p9.8.m8.1.1.3.1.cmml" xref="S3.SS1.p9.8.m8.1.1.3.1"></times><ci id="S3.SS1.p9.8.m8.1.1.3.2.cmml" xref="S3.SS1.p9.8.m8.1.1.3.2">𝑐</ci><ci id="S3.SS1.p9.8.m8.1.1.3.3.cmml" xref="S3.SS1.p9.8.m8.1.1.3.3">𝑙</ci><ci id="S3.SS1.p9.8.m8.1.1.3.4.cmml" xref="S3.SS1.p9.8.m8.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.8.m8.1c">L_{cls}</annotation></semantics></math> represents the binary cross-entropy loss for classification, and <math id="S3.SS1.p9.9.m9.1" class="ltx_Math" alttext="L_{reg}" display="inline"><semantics id="S3.SS1.p9.9.m9.1a"><msub id="S3.SS1.p9.9.m9.1.1" xref="S3.SS1.p9.9.m9.1.1.cmml"><mi id="S3.SS1.p9.9.m9.1.1.2" xref="S3.SS1.p9.9.m9.1.1.2.cmml">L</mi><mrow id="S3.SS1.p9.9.m9.1.1.3" xref="S3.SS1.p9.9.m9.1.1.3.cmml"><mi id="S3.SS1.p9.9.m9.1.1.3.2" xref="S3.SS1.p9.9.m9.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p9.9.m9.1.1.3.1" xref="S3.SS1.p9.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p9.9.m9.1.1.3.3" xref="S3.SS1.p9.9.m9.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p9.9.m9.1.1.3.1a" xref="S3.SS1.p9.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p9.9.m9.1.1.3.4" xref="S3.SS1.p9.9.m9.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.9.m9.1b"><apply id="S3.SS1.p9.9.m9.1.1.cmml" xref="S3.SS1.p9.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.9.m9.1.1.1.cmml" xref="S3.SS1.p9.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p9.9.m9.1.1.2.cmml" xref="S3.SS1.p9.9.m9.1.1.2">𝐿</ci><apply id="S3.SS1.p9.9.m9.1.1.3.cmml" xref="S3.SS1.p9.9.m9.1.1.3"><times id="S3.SS1.p9.9.m9.1.1.3.1.cmml" xref="S3.SS1.p9.9.m9.1.1.3.1"></times><ci id="S3.SS1.p9.9.m9.1.1.3.2.cmml" xref="S3.SS1.p9.9.m9.1.1.3.2">𝑟</ci><ci id="S3.SS1.p9.9.m9.1.1.3.3.cmml" xref="S3.SS1.p9.9.m9.1.1.3.3">𝑒</ci><ci id="S3.SS1.p9.9.m9.1.1.3.4.cmml" xref="S3.SS1.p9.9.m9.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.9.m9.1c">L_{reg}</annotation></semantics></math> represents the smooth L1 loss for bounding box regression. The hyperparameter <math id="S3.SS1.p9.10.m10.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS1.p9.10.m10.1a"><mi id="S3.SS1.p9.10.m10.1.1" xref="S3.SS1.p9.10.m10.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.10.m10.1b"><ci id="S3.SS1.p9.10.m10.1.1.cmml" xref="S3.SS1.p9.10.m10.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.10.m10.1c">\lambda</annotation></semantics></math> balances the two components.</p>
</div>
<div id="S3.SS1.p10" class="ltx_para ltx_noindent">
<p id="S3.SS1.p10.1" class="ltx_p">The object proposals generated by the RPN are then filtered and refined using non-maximum suppression (NMS) and bounding box regression. NMS eliminates overlapping proposals, while bounding box regression adjusts the dimensions and position of the remaining proposals. The result of this process is a set of high-quality object proposals, which will be fed into the proposal encoder.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Proposal Encoder</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.3" class="ltx_p">The Proposal Encoder is used to map each region proposal, <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="r_{j}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">r</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑟</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">r_{j}</annotation></semantics></math>, predicted by the RPN, into a fixed sized embedding vector <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="f_{r}(r_{j})" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">f</mi><mi id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml">r</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"></times><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝑓</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">𝑟</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2">𝑟</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">f_{r}(r_{j})</annotation></semantics></math> from an embedding vector space <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathbb{R}^{d_{r}}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msup id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">ℝ</mi><msub id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.2" xref="S3.SS2.p1.3.m3.1.1.3.2.cmml">d</mi><mi id="S3.SS2.p1.3.m3.1.1.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.cmml">r</mi></msub></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">ℝ</ci><apply id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.2">𝑑</ci><ci id="S3.SS2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathbb{R}^{d_{r}}</annotation></semantics></math>. We aim for the embedding vectors produced by the Proposal Encoder to capture both spatial and semantic information within each proposal, allowing the proposal-text alignment model to make informed decisions about the relationships between objects and their textual descriptions.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2302.05200/assets/images/proposal_encoder.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="449" height="154" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Inner architecture of the Proposal Encoder module.</figcaption>
</figure>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.4" class="ltx_p">The architecture of the Proposal Encoder Module is comprised of three main components: ROI pooling, a convolutional layer, and two fully connected layers, as shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2 Proposal Encoder ‣ 3 Methodology ‣ End-to-end Semantic Object Detection with Cross-Modal Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The ROI pooling layer resizes each region proposal with shape <math id="S3.SS2.p2.1.m1.3" class="ltx_Math" alttext="(C_{f},W_{f},W_{f})" display="inline"><semantics id="S3.SS2.p2.1.m1.3a"><mrow id="S3.SS2.p2.1.m1.3.3.3" xref="S3.SS2.p2.1.m1.3.3.4.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.3.3.3.4" xref="S3.SS2.p2.1.m1.3.3.4.cmml">(</mo><msub id="S3.SS2.p2.1.m1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.1.2.cmml">C</mi><mi id="S3.SS2.p2.1.m1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.3.cmml">f</mi></msub><mo id="S3.SS2.p2.1.m1.3.3.3.5" xref="S3.SS2.p2.1.m1.3.3.4.cmml">,</mo><msub id="S3.SS2.p2.1.m1.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.2.cmml"><mi id="S3.SS2.p2.1.m1.2.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.2.2.cmml">W</mi><mi id="S3.SS2.p2.1.m1.2.2.2.2.3" xref="S3.SS2.p2.1.m1.2.2.2.2.3.cmml">f</mi></msub><mo id="S3.SS2.p2.1.m1.3.3.3.6" xref="S3.SS2.p2.1.m1.3.3.4.cmml">,</mo><msub id="S3.SS2.p2.1.m1.3.3.3.3" xref="S3.SS2.p2.1.m1.3.3.3.3.cmml"><mi id="S3.SS2.p2.1.m1.3.3.3.3.2" xref="S3.SS2.p2.1.m1.3.3.3.3.2.cmml">W</mi><mi id="S3.SS2.p2.1.m1.3.3.3.3.3" xref="S3.SS2.p2.1.m1.3.3.3.3.3.cmml">f</mi></msub><mo stretchy="false" id="S3.SS2.p2.1.m1.3.3.3.7" xref="S3.SS2.p2.1.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.3b"><vector id="S3.SS2.p2.1.m1.3.3.4.cmml" xref="S3.SS2.p2.1.m1.3.3.3"><apply id="S3.SS2.p2.1.m1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.2">𝐶</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.3">𝑓</ci></apply><apply id="S3.SS2.p2.1.m1.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2">𝑊</ci><ci id="S3.SS2.p2.1.m1.2.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.3">𝑓</ci></apply><apply id="S3.SS2.p2.1.m1.3.3.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.3.3.3.3.1.cmml" xref="S3.SS2.p2.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.3.3.3.3.2.cmml" xref="S3.SS2.p2.1.m1.3.3.3.3.2">𝑊</ci><ci id="S3.SS2.p2.1.m1.3.3.3.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3.3.3.3">𝑓</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.3c">(C_{f},W_{f},W_{f})</annotation></semantics></math> to a fixed size, <math id="S3.SS2.p2.2.m2.3" class="ltx_Math" alttext="(C_{f},S_{R},S_{R})" display="inline"><semantics id="S3.SS2.p2.2.m2.3a"><mrow id="S3.SS2.p2.2.m2.3.3.3" xref="S3.SS2.p2.2.m2.3.3.4.cmml"><mo stretchy="false" id="S3.SS2.p2.2.m2.3.3.3.4" xref="S3.SS2.p2.2.m2.3.3.4.cmml">(</mo><msub id="S3.SS2.p2.2.m2.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.2" xref="S3.SS2.p2.2.m2.1.1.1.1.2.cmml">C</mi><mi id="S3.SS2.p2.2.m2.1.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.1.3.cmml">f</mi></msub><mo id="S3.SS2.p2.2.m2.3.3.3.5" xref="S3.SS2.p2.2.m2.3.3.4.cmml">,</mo><msub id="S3.SS2.p2.2.m2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.cmml"><mi id="S3.SS2.p2.2.m2.2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.2.cmml">S</mi><mi id="S3.SS2.p2.2.m2.2.2.2.2.3" xref="S3.SS2.p2.2.m2.2.2.2.2.3.cmml">R</mi></msub><mo id="S3.SS2.p2.2.m2.3.3.3.6" xref="S3.SS2.p2.2.m2.3.3.4.cmml">,</mo><msub id="S3.SS2.p2.2.m2.3.3.3.3" xref="S3.SS2.p2.2.m2.3.3.3.3.cmml"><mi id="S3.SS2.p2.2.m2.3.3.3.3.2" xref="S3.SS2.p2.2.m2.3.3.3.3.2.cmml">S</mi><mi id="S3.SS2.p2.2.m2.3.3.3.3.3" xref="S3.SS2.p2.2.m2.3.3.3.3.3.cmml">R</mi></msub><mo stretchy="false" id="S3.SS2.p2.2.m2.3.3.3.7" xref="S3.SS2.p2.2.m2.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.3b"><vector id="S3.SS2.p2.2.m2.3.3.4.cmml" xref="S3.SS2.p2.2.m2.3.3.3"><apply id="S3.SS2.p2.2.m2.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.2">𝐶</ci><ci id="S3.SS2.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3">𝑓</ci></apply><apply id="S3.SS2.p2.2.m2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2">𝑆</ci><ci id="S3.SS2.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3">𝑅</ci></apply><apply id="S3.SS2.p2.2.m2.3.3.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.3.3.3.3.1.cmml" xref="S3.SS2.p2.2.m2.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.3.3.3.3.2.cmml" xref="S3.SS2.p2.2.m2.3.3.3.3.2">𝑆</ci><ci id="S3.SS2.p2.2.m2.3.3.3.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3.3.3.3">𝑅</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.3c">(C_{f},S_{R},S_{R})</annotation></semantics></math>, while preserving spatial information. This output is then fed into a convolutional layer with output channels dimension of <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="C_{h}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">C</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝐶</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">C_{h}</annotation></semantics></math>, which further extracts and refines the features of the proposals. The final output of the module is the embedding vectors, produced by the two fully connected layers. Additionally, the embedding vectors are constrained to live in a <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="d_{r}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">d</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑑</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">d_{r}</annotation></semantics></math>-dimensional hyper-sphere through L2-normalization.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p">The size of the encoded proposals, <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="d_{r}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">d</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑑</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">d_{r}</annotation></semantics></math>, is a hyperparameter that can be adjusted depending on the needs of the object detection task. In this way, the Proposal Encoder module effectively converts region proposals into compact and informative feature representations.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Text Encoder</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.2" class="ltx_p">The Text Encoder is designed to transform the textual descriptions of the objects of interest in the image into a fixed-sized dense vector representation, <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="f_{t}(\textbf{t})\in\mathbb{R}^{d_{t}}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.2" xref="S3.SS3.p1.1.m1.1.2.cmml"><mrow id="S3.SS3.p1.1.m1.1.2.2" xref="S3.SS3.p1.1.m1.1.2.2.cmml"><msub id="S3.SS3.p1.1.m1.1.2.2.2" xref="S3.SS3.p1.1.m1.1.2.2.2.cmml"><mi id="S3.SS3.p1.1.m1.1.2.2.2.2" xref="S3.SS3.p1.1.m1.1.2.2.2.2.cmml">f</mi><mi id="S3.SS3.p1.1.m1.1.2.2.2.3" xref="S3.SS3.p1.1.m1.1.2.2.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.2.2.1" xref="S3.SS3.p1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S3.SS3.p1.1.m1.1.2.2.3.2" xref="S3.SS3.p1.1.m1.1.1a.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.1.2.2.3.2.1" xref="S3.SS3.p1.1.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">t</mtext><mo stretchy="false" id="S3.SS3.p1.1.m1.1.2.2.3.2.2" xref="S3.SS3.p1.1.m1.1.1a.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.1.m1.1.2.1" xref="S3.SS3.p1.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS3.p1.1.m1.1.2.3" xref="S3.SS3.p1.1.m1.1.2.3.cmml"><mi id="S3.SS3.p1.1.m1.1.2.3.2" xref="S3.SS3.p1.1.m1.1.2.3.2.cmml">ℝ</mi><msub id="S3.SS3.p1.1.m1.1.2.3.3" xref="S3.SS3.p1.1.m1.1.2.3.3.cmml"><mi id="S3.SS3.p1.1.m1.1.2.3.3.2" xref="S3.SS3.p1.1.m1.1.2.3.3.2.cmml">d</mi><mi id="S3.SS3.p1.1.m1.1.2.3.3.3" xref="S3.SS3.p1.1.m1.1.2.3.3.3.cmml">t</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.2"><in id="S3.SS3.p1.1.m1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.2.1"></in><apply id="S3.SS3.p1.1.m1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.2.2"><times id="S3.SS3.p1.1.m1.1.2.2.1.cmml" xref="S3.SS3.p1.1.m1.1.2.2.1"></times><apply id="S3.SS3.p1.1.m1.1.2.2.2.cmml" xref="S3.SS3.p1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.1.2.2.2.2">𝑓</ci><ci id="S3.SS3.p1.1.m1.1.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.1.2.2.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.1.m1.1.1a.cmml" xref="S3.SS3.p1.1.m1.1.2.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">t</mtext></ci></apply><apply id="S3.SS3.p1.1.m1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.2.3.1.cmml" xref="S3.SS3.p1.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.2.3.2.cmml" xref="S3.SS3.p1.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS3.p1.1.m1.1.2.3.3.cmml" xref="S3.SS3.p1.1.m1.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.2.3.3.1.cmml" xref="S3.SS3.p1.1.m1.1.2.3.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.2.3.3.2.cmml" xref="S3.SS3.p1.1.m1.1.2.3.3.2">𝑑</ci><ci id="S3.SS3.p1.1.m1.1.2.3.3.3.cmml" xref="S3.SS3.p1.1.m1.1.2.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">f_{t}(\textbf{t})\in\mathbb{R}^{d_{t}}</annotation></semantics></math>, which will later be utilized in the Alignment Model. Given a sequence of tokens <math id="S3.SS3.p1.2.m2.4" class="ltx_Math" alttext="\textbf{t}=(t_{0},t_{1},...,t_{n})" display="inline"><semantics id="S3.SS3.p1.2.m2.4a"><mrow id="S3.SS3.p1.2.m2.4.4" xref="S3.SS3.p1.2.m2.4.4.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p1.2.m2.4.4.5" xref="S3.SS3.p1.2.m2.4.4.5a.cmml">t</mtext><mo id="S3.SS3.p1.2.m2.4.4.4" xref="S3.SS3.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS3.p1.2.m2.4.4.3.3" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.4.4.3.3.4" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml">(</mo><msub id="S3.SS3.p1.2.m2.2.2.1.1.1" xref="S3.SS3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.2.m2.2.2.1.1.1.2" xref="S3.SS3.p1.2.m2.2.2.1.1.1.2.cmml">t</mi><mn id="S3.SS3.p1.2.m2.2.2.1.1.1.3" xref="S3.SS3.p1.2.m2.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS3.p1.2.m2.4.4.3.3.5" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p1.2.m2.3.3.2.2.2" xref="S3.SS3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS3.p1.2.m2.3.3.2.2.2.2" xref="S3.SS3.p1.2.m2.3.3.2.2.2.2.cmml">t</mi><mn id="S3.SS3.p1.2.m2.3.3.2.2.2.3" xref="S3.SS3.p1.2.m2.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS3.p1.2.m2.4.4.3.3.6" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.p1.2.m2.4.4.3.3.7" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p1.2.m2.4.4.3.3.3" xref="S3.SS3.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS3.p1.2.m2.4.4.3.3.3.2" xref="S3.SS3.p1.2.m2.4.4.3.3.3.2.cmml">t</mi><mi id="S3.SS3.p1.2.m2.4.4.3.3.3.3" xref="S3.SS3.p1.2.m2.4.4.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS3.p1.2.m2.4.4.3.3.8" xref="S3.SS3.p1.2.m2.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.4b"><apply id="S3.SS3.p1.2.m2.4.4.cmml" xref="S3.SS3.p1.2.m2.4.4"><eq id="S3.SS3.p1.2.m2.4.4.4.cmml" xref="S3.SS3.p1.2.m2.4.4.4"></eq><ci id="S3.SS3.p1.2.m2.4.4.5a.cmml" xref="S3.SS3.p1.2.m2.4.4.5"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p1.2.m2.4.4.5.cmml" xref="S3.SS3.p1.2.m2.4.4.5">t</mtext></ci><vector id="S3.SS3.p1.2.m2.4.4.3.4.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3"><apply id="S3.SS3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.2.m2.2.2.1.1.1.3">0</cn></apply><apply id="S3.SS3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2.2">𝑡</ci><cn type="integer" id="S3.SS3.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS3.p1.2.m2.3.3.2.2.2.3">1</cn></apply><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">…</ci><apply id="S3.SS3.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3.2">𝑡</ci><ci id="S3.SS3.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS3.p1.2.m2.4.4.3.3.3.3">𝑛</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.4c">\textbf{t}=(t_{0},t_{1},...,t_{n})</annotation></semantics></math> represented as word embeddings, the Text Encoder carries out the encoding mechanism through the use of a Transformer encoder architecture, as shown in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.3 Text Encoder ‣ 3 Methodology ‣ End-to-end Semantic Object Detection with Cross-Modal Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The goal is to extract contextual information from the input text sequence.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2302.05200/assets/images/text_encoder.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="419" height="302" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Inner architecture of the Text Encoder module using a stack of Transformer encoders.</figcaption>
</figure>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.1" class="ltx_p">A special token, denoted as <span id="S3.SS3.p2.1.1" class="ltx_text ltx_font_typewriter">&lt;ENC&gt;</span>, is added into the start of the input sequence to serve as an aggregated representation of the entire input text, similar to the [CLS] token in BERT. This allows the Text Encoder to effectively condense the textual information into a compact, fixed-sized vector representation.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.2" class="ltx_p">The size of the encoded textual representation, <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="d_{t}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">d</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝑑</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">d_{t}</annotation></semantics></math>, is a hyperparameter that can be adjusted depending on the needs of the object detection task. The Text Encoder module effectively converts textual descriptions into compact and informative feature representations that are suitable for use in the Alignment Model. Additionally, the embedding vectors are constrained to live in a <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="d_{t}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">d</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝑑</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">d_{t}</annotation></semantics></math>-dimensional hyper-sphere through L2-normalization.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Proposal-Text Alignment</h3>

<div id="S3.SS4.p1" class="ltx_para ltx_noindent">
<p id="S3.SS4.p1.1" class="ltx_p">The Alignment Model is the final component of the proposal-text alignment framework, which aligns the proposals’ embeddings obtained from the Proposal Encoder with the textual embeddings obtained from the Text Encoder. The aim of this model is to predict the similarity between each proposal and the textual description, which can then be used to select the most relevant proposals for a given text description. The inputs of the model are the embedding vectors for a given proposal and a given text, and the output is a value between zero and one, indicating the match between them, as shown in Figure <a href="#S3.F5" title="Figure 5 ‣ 3.4 Proposal-Text Alignment ‣ 3 Methodology ‣ End-to-end Semantic Object Detection with Cross-Modal Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2302.05200/assets/images/proposal_text_align.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="174" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Inner architecture of the Proposal-Text Alignment module.</figcaption>
</figure>
<div id="S3.SS4.p2" class="ltx_para ltx_noindent">
<p id="S3.SS4.p2.4" class="ltx_p">Given the proposal embedding <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="f_{r}(r_{j})\in\mathbb{R}^{d_{r}}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mrow id="S3.SS4.p2.1.m1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.cmml"><msub id="S3.SS4.p2.1.m1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.1.3.2.cmml">f</mi><mi id="S3.SS4.p2.1.m1.1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p2.1.m1.1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.1.m1.1.1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.2.cmml">r</mi><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">∈</mo><msup id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS4.p2.1.m1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.3.3.2" xref="S3.SS4.p2.1.m1.1.1.3.3.2.cmml">d</mi><mi id="S3.SS4.p2.1.m1.1.1.3.3.3" xref="S3.SS4.p2.1.m1.1.1.3.3.3.cmml">r</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><in id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2"></in><apply id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1"><times id="S3.SS4.p2.1.m1.1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.2"></times><apply id="S3.SS4.p2.1.m1.1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.3.2">𝑓</ci><ci id="S3.SS4.p2.1.m1.1.1.1.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.3.3">𝑟</ci></apply><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS4.p2.1.m1.1.1.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS4.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">f_{r}(r_{j})\in\mathbb{R}^{d_{r}}</annotation></semantics></math> and the text embedding <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="f_{t}(\textbf{t})\in\mathbb{R}^{d_{t}}" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><mrow id="S3.SS4.p2.2.m2.1.2" xref="S3.SS4.p2.2.m2.1.2.cmml"><mrow id="S3.SS4.p2.2.m2.1.2.2" xref="S3.SS4.p2.2.m2.1.2.2.cmml"><msub id="S3.SS4.p2.2.m2.1.2.2.2" xref="S3.SS4.p2.2.m2.1.2.2.2.cmml"><mi id="S3.SS4.p2.2.m2.1.2.2.2.2" xref="S3.SS4.p2.2.m2.1.2.2.2.2.cmml">f</mi><mi id="S3.SS4.p2.2.m2.1.2.2.2.3" xref="S3.SS4.p2.2.m2.1.2.2.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p2.2.m2.1.2.2.1" xref="S3.SS4.p2.2.m2.1.2.2.1.cmml">​</mo><mrow id="S3.SS4.p2.2.m2.1.2.2.3.2" xref="S3.SS4.p2.2.m2.1.1a.cmml"><mo stretchy="false" id="S3.SS4.p2.2.m2.1.2.2.3.2.1" xref="S3.SS4.p2.2.m2.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">t</mtext><mo stretchy="false" id="S3.SS4.p2.2.m2.1.2.2.3.2.2" xref="S3.SS4.p2.2.m2.1.1a.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.2.m2.1.2.1" xref="S3.SS4.p2.2.m2.1.2.1.cmml">∈</mo><msup id="S3.SS4.p2.2.m2.1.2.3" xref="S3.SS4.p2.2.m2.1.2.3.cmml"><mi id="S3.SS4.p2.2.m2.1.2.3.2" xref="S3.SS4.p2.2.m2.1.2.3.2.cmml">ℝ</mi><msub id="S3.SS4.p2.2.m2.1.2.3.3" xref="S3.SS4.p2.2.m2.1.2.3.3.cmml"><mi id="S3.SS4.p2.2.m2.1.2.3.3.2" xref="S3.SS4.p2.2.m2.1.2.3.3.2.cmml">d</mi><mi id="S3.SS4.p2.2.m2.1.2.3.3.3" xref="S3.SS4.p2.2.m2.1.2.3.3.3.cmml">t</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.2.cmml" xref="S3.SS4.p2.2.m2.1.2"><in id="S3.SS4.p2.2.m2.1.2.1.cmml" xref="S3.SS4.p2.2.m2.1.2.1"></in><apply id="S3.SS4.p2.2.m2.1.2.2.cmml" xref="S3.SS4.p2.2.m2.1.2.2"><times id="S3.SS4.p2.2.m2.1.2.2.1.cmml" xref="S3.SS4.p2.2.m2.1.2.2.1"></times><apply id="S3.SS4.p2.2.m2.1.2.2.2.cmml" xref="S3.SS4.p2.2.m2.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.2.2.2.1.cmml" xref="S3.SS4.p2.2.m2.1.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.1.2.2.2.2">𝑓</ci><ci id="S3.SS4.p2.2.m2.1.2.2.2.3.cmml" xref="S3.SS4.p2.2.m2.1.2.2.2.3">𝑡</ci></apply><ci id="S3.SS4.p2.2.m2.1.1a.cmml" xref="S3.SS4.p2.2.m2.1.2.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">t</mtext></ci></apply><apply id="S3.SS4.p2.2.m2.1.2.3.cmml" xref="S3.SS4.p2.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.2.3.1.cmml" xref="S3.SS4.p2.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS4.p2.2.m2.1.2.3.2.cmml" xref="S3.SS4.p2.2.m2.1.2.3.2">ℝ</ci><apply id="S3.SS4.p2.2.m2.1.2.3.3.cmml" xref="S3.SS4.p2.2.m2.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.2.3.3.1.cmml" xref="S3.SS4.p2.2.m2.1.2.3.3">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.2.3.3.2.cmml" xref="S3.SS4.p2.2.m2.1.2.3.3.2">𝑑</ci><ci id="S3.SS4.p2.2.m2.1.2.3.3.3.cmml" xref="S3.SS4.p2.2.m2.1.2.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">f_{t}(\textbf{t})\in\mathbb{R}^{d_{t}}</annotation></semantics></math>, the concatenated representation <math id="S3.SS4.p2.3.m3.3" class="ltx_Math" alttext="z_{j}=[f_{r}(r_{j});f_{t}(\textbf{t})]\in\mathbb{R}^{d_{r}+d_{t}}" display="inline"><semantics id="S3.SS4.p2.3.m3.3a"><mrow id="S3.SS4.p2.3.m3.3.3" xref="S3.SS4.p2.3.m3.3.3.cmml"><msub id="S3.SS4.p2.3.m3.3.3.4" xref="S3.SS4.p2.3.m3.3.3.4.cmml"><mi id="S3.SS4.p2.3.m3.3.3.4.2" xref="S3.SS4.p2.3.m3.3.3.4.2.cmml">z</mi><mi id="S3.SS4.p2.3.m3.3.3.4.3" xref="S3.SS4.p2.3.m3.3.3.4.3.cmml">j</mi></msub><mo id="S3.SS4.p2.3.m3.3.3.5" xref="S3.SS4.p2.3.m3.3.3.5.cmml">=</mo><mrow id="S3.SS4.p2.3.m3.3.3.2.2" xref="S3.SS4.p2.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS4.p2.3.m3.3.3.2.2.3" xref="S3.SS4.p2.3.m3.3.3.2.3.cmml">[</mo><mrow id="S3.SS4.p2.3.m3.2.2.1.1.1" xref="S3.SS4.p2.3.m3.2.2.1.1.1.cmml"><msub id="S3.SS4.p2.3.m3.2.2.1.1.1.3" xref="S3.SS4.p2.3.m3.2.2.1.1.1.3.cmml"><mi id="S3.SS4.p2.3.m3.2.2.1.1.1.3.2" xref="S3.SS4.p2.3.m3.2.2.1.1.1.3.2.cmml">f</mi><mi id="S3.SS4.p2.3.m3.2.2.1.1.1.3.3" xref="S3.SS4.p2.3.m3.2.2.1.1.1.3.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p2.3.m3.2.2.1.1.1.2" xref="S3.SS4.p2.3.m3.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p2.3.m3.2.2.1.1.1.1.1" xref="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.2" xref="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1" xref="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.2" xref="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.2.cmml">r</mi><mi id="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.3" xref="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.3" xref="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.3.m3.3.3.2.2.4" xref="S3.SS4.p2.3.m3.3.3.2.3.cmml">;</mo><mrow id="S3.SS4.p2.3.m3.3.3.2.2.2" xref="S3.SS4.p2.3.m3.3.3.2.2.2.cmml"><msub id="S3.SS4.p2.3.m3.3.3.2.2.2.2" xref="S3.SS4.p2.3.m3.3.3.2.2.2.2.cmml"><mi id="S3.SS4.p2.3.m3.3.3.2.2.2.2.2" xref="S3.SS4.p2.3.m3.3.3.2.2.2.2.2.cmml">f</mi><mi id="S3.SS4.p2.3.m3.3.3.2.2.2.2.3" xref="S3.SS4.p2.3.m3.3.3.2.2.2.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p2.3.m3.3.3.2.2.2.1" xref="S3.SS4.p2.3.m3.3.3.2.2.2.1.cmml">​</mo><mrow id="S3.SS4.p2.3.m3.3.3.2.2.2.3.2" xref="S3.SS4.p2.3.m3.1.1a.cmml"><mo stretchy="false" id="S3.SS4.p2.3.m3.3.3.2.2.2.3.2.1" xref="S3.SS4.p2.3.m3.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml">t</mtext><mo stretchy="false" id="S3.SS4.p2.3.m3.3.3.2.2.2.3.2.2" xref="S3.SS4.p2.3.m3.1.1a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS4.p2.3.m3.3.3.2.2.5" xref="S3.SS4.p2.3.m3.3.3.2.3.cmml">]</mo></mrow><mo id="S3.SS4.p2.3.m3.3.3.6" xref="S3.SS4.p2.3.m3.3.3.6.cmml">∈</mo><msup id="S3.SS4.p2.3.m3.3.3.7" xref="S3.SS4.p2.3.m3.3.3.7.cmml"><mi id="S3.SS4.p2.3.m3.3.3.7.2" xref="S3.SS4.p2.3.m3.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS4.p2.3.m3.3.3.7.3" xref="S3.SS4.p2.3.m3.3.3.7.3.cmml"><msub id="S3.SS4.p2.3.m3.3.3.7.3.2" xref="S3.SS4.p2.3.m3.3.3.7.3.2.cmml"><mi id="S3.SS4.p2.3.m3.3.3.7.3.2.2" xref="S3.SS4.p2.3.m3.3.3.7.3.2.2.cmml">d</mi><mi id="S3.SS4.p2.3.m3.3.3.7.3.2.3" xref="S3.SS4.p2.3.m3.3.3.7.3.2.3.cmml">r</mi></msub><mo id="S3.SS4.p2.3.m3.3.3.7.3.1" xref="S3.SS4.p2.3.m3.3.3.7.3.1.cmml">+</mo><msub id="S3.SS4.p2.3.m3.3.3.7.3.3" xref="S3.SS4.p2.3.m3.3.3.7.3.3.cmml"><mi id="S3.SS4.p2.3.m3.3.3.7.3.3.2" xref="S3.SS4.p2.3.m3.3.3.7.3.3.2.cmml">d</mi><mi id="S3.SS4.p2.3.m3.3.3.7.3.3.3" xref="S3.SS4.p2.3.m3.3.3.7.3.3.3.cmml">t</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.3b"><apply id="S3.SS4.p2.3.m3.3.3.cmml" xref="S3.SS4.p2.3.m3.3.3"><and id="S3.SS4.p2.3.m3.3.3a.cmml" xref="S3.SS4.p2.3.m3.3.3"></and><apply id="S3.SS4.p2.3.m3.3.3b.cmml" xref="S3.SS4.p2.3.m3.3.3"><eq id="S3.SS4.p2.3.m3.3.3.5.cmml" xref="S3.SS4.p2.3.m3.3.3.5"></eq><apply id="S3.SS4.p2.3.m3.3.3.4.cmml" xref="S3.SS4.p2.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.3.3.4.1.cmml" xref="S3.SS4.p2.3.m3.3.3.4">subscript</csymbol><ci id="S3.SS4.p2.3.m3.3.3.4.2.cmml" xref="S3.SS4.p2.3.m3.3.3.4.2">𝑧</ci><ci id="S3.SS4.p2.3.m3.3.3.4.3.cmml" xref="S3.SS4.p2.3.m3.3.3.4.3">𝑗</ci></apply><list id="S3.SS4.p2.3.m3.3.3.2.3.cmml" xref="S3.SS4.p2.3.m3.3.3.2.2"><apply id="S3.SS4.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS4.p2.3.m3.2.2.1.1.1"><times id="S3.SS4.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS4.p2.3.m3.2.2.1.1.1.2"></times><apply id="S3.SS4.p2.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS4.p2.3.m3.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.2.2.1.1.1.3.1.cmml" xref="S3.SS4.p2.3.m3.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p2.3.m3.2.2.1.1.1.3.2.cmml" xref="S3.SS4.p2.3.m3.2.2.1.1.1.3.2">𝑓</ci><ci id="S3.SS4.p2.3.m3.2.2.1.1.1.3.3.cmml" xref="S3.SS4.p2.3.m3.2.2.1.1.1.3.3">𝑟</ci></apply><apply id="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.3.m3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.3.m3.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.3.m3.2.2.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.SS4.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS4.p2.3.m3.3.3.2.2.2"><times id="S3.SS4.p2.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS4.p2.3.m3.3.3.2.2.2.1"></times><apply id="S3.SS4.p2.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS4.p2.3.m3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.3.3.2.2.2.2.1.cmml" xref="S3.SS4.p2.3.m3.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.3.m3.3.3.2.2.2.2.2.cmml" xref="S3.SS4.p2.3.m3.3.3.2.2.2.2.2">𝑓</ci><ci id="S3.SS4.p2.3.m3.3.3.2.2.2.2.3.cmml" xref="S3.SS4.p2.3.m3.3.3.2.2.2.2.3">𝑡</ci></apply><ci id="S3.SS4.p2.3.m3.1.1a.cmml" xref="S3.SS4.p2.3.m3.3.3.2.2.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">t</mtext></ci></apply></list></apply><apply id="S3.SS4.p2.3.m3.3.3c.cmml" xref="S3.SS4.p2.3.m3.3.3"><in id="S3.SS4.p2.3.m3.3.3.6.cmml" xref="S3.SS4.p2.3.m3.3.3.6"></in><share href="#S3.SS4.p2.3.m3.3.3.2.cmml" id="S3.SS4.p2.3.m3.3.3d.cmml" xref="S3.SS4.p2.3.m3.3.3"></share><apply id="S3.SS4.p2.3.m3.3.3.7.cmml" xref="S3.SS4.p2.3.m3.3.3.7"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.3.3.7.1.cmml" xref="S3.SS4.p2.3.m3.3.3.7">superscript</csymbol><ci id="S3.SS4.p2.3.m3.3.3.7.2.cmml" xref="S3.SS4.p2.3.m3.3.3.7.2">ℝ</ci><apply id="S3.SS4.p2.3.m3.3.3.7.3.cmml" xref="S3.SS4.p2.3.m3.3.3.7.3"><plus id="S3.SS4.p2.3.m3.3.3.7.3.1.cmml" xref="S3.SS4.p2.3.m3.3.3.7.3.1"></plus><apply id="S3.SS4.p2.3.m3.3.3.7.3.2.cmml" xref="S3.SS4.p2.3.m3.3.3.7.3.2"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.3.3.7.3.2.1.cmml" xref="S3.SS4.p2.3.m3.3.3.7.3.2">subscript</csymbol><ci id="S3.SS4.p2.3.m3.3.3.7.3.2.2.cmml" xref="S3.SS4.p2.3.m3.3.3.7.3.2.2">𝑑</ci><ci id="S3.SS4.p2.3.m3.3.3.7.3.2.3.cmml" xref="S3.SS4.p2.3.m3.3.3.7.3.2.3">𝑟</ci></apply><apply id="S3.SS4.p2.3.m3.3.3.7.3.3.cmml" xref="S3.SS4.p2.3.m3.3.3.7.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.3.3.7.3.3.1.cmml" xref="S3.SS4.p2.3.m3.3.3.7.3.3">subscript</csymbol><ci id="S3.SS4.p2.3.m3.3.3.7.3.3.2.cmml" xref="S3.SS4.p2.3.m3.3.3.7.3.3.2">𝑑</ci><ci id="S3.SS4.p2.3.m3.3.3.7.3.3.3.cmml" xref="S3.SS4.p2.3.m3.3.3.7.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.3c">z_{j}=[f_{r}(r_{j});f_{t}(\textbf{t})]\in\mathbb{R}^{d_{r}+d_{t}}</annotation></semantics></math> is passed to a two-layers fully connected neural network, with the first layer having output dimension of <math id="S3.SS4.p2.4.m4.1" class="ltx_Math" alttext="d_{j}" display="inline"><semantics id="S3.SS4.p2.4.m4.1a"><msub id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml"><mi id="S3.SS4.p2.4.m4.1.1.2" xref="S3.SS4.p2.4.m4.1.1.2.cmml">d</mi><mi id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2">𝑑</ci><ci id="S3.SS4.p2.4.m4.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">d_{j}</annotation></semantics></math> with a ReLU activation and the second layer with output dimension 1 with a sigmoid activation function, representing an alignment score between zero and one, as:</p>
</div>
<div id="S3.SS4.p3" class="ltx_para ltx_noindent">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.5" class="ltx_Math" alttext="\textrm{Align}(r_{j},\textbf{t})=\sigma(\max(0,z_{j}W_{1}+b_{1})W_{2}+b_{2})" display="block"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml"><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.cmml"><mtext id="S3.E3.m1.4.4.1.3" xref="S3.E3.m1.4.4.1.3a.cmml">Align</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.2" xref="S3.E3.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.1.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml">(</mo><msub id="S3.E3.m1.4.4.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.2.cmml">r</mi><mi id="S3.E3.m1.4.4.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E3.m1.4.4.1.1.1.3" xref="S3.E3.m1.4.4.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1a.cmml">t</mtext><mo stretchy="false" id="S3.E3.m1.4.4.1.1.1.4" xref="S3.E3.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.3" xref="S3.E3.m1.5.5.3.cmml">=</mo><mrow id="S3.E3.m1.5.5.2" xref="S3.E3.m1.5.5.2.cmml"><mi id="S3.E3.m1.5.5.2.3" xref="S3.E3.m1.5.5.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.2.2" xref="S3.E3.m1.5.5.2.2.cmml">​</mo><mrow id="S3.E3.m1.5.5.2.1.1" xref="S3.E3.m1.5.5.2.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.2.1.1.2" xref="S3.E3.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.5.5.2.1.1.1" xref="S3.E3.m1.5.5.2.1.1.1.cmml"><mrow id="S3.E3.m1.5.5.2.1.1.1.1" xref="S3.E3.m1.5.5.2.1.1.1.1.cmml"><mrow id="S3.E3.m1.5.5.2.1.1.1.1.1.1" xref="S3.E3.m1.5.5.2.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">max</mi><mo id="S3.E3.m1.5.5.2.1.1.1.1.1.1a" xref="S3.E3.m1.5.5.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.2.1.1.1.1.1.2.cmml">(</mo><mn id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">0</mn><mo id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.2.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.2.cmml">z</mi><mi id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.1" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mn id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mn id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo stretchy="false" id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.4" xref="S3.E3.m1.5.5.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.2.1.1.1.1.2" xref="S3.E3.m1.5.5.2.1.1.1.1.2.cmml">​</mo><msub id="S3.E3.m1.5.5.2.1.1.1.1.3" xref="S3.E3.m1.5.5.2.1.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.2.1.1.1.1.3.2" xref="S3.E3.m1.5.5.2.1.1.1.1.3.2.cmml">W</mi><mn id="S3.E3.m1.5.5.2.1.1.1.1.3.3" xref="S3.E3.m1.5.5.2.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S3.E3.m1.5.5.2.1.1.1.2" xref="S3.E3.m1.5.5.2.1.1.1.2.cmml">+</mo><msub id="S3.E3.m1.5.5.2.1.1.1.3" xref="S3.E3.m1.5.5.2.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.2.1.1.1.3.2" xref="S3.E3.m1.5.5.2.1.1.1.3.2.cmml">b</mi><mn id="S3.E3.m1.5.5.2.1.1.1.3.3" xref="S3.E3.m1.5.5.2.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S3.E3.m1.5.5.2.1.1.3" xref="S3.E3.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5"><eq id="S3.E3.m1.5.5.3.cmml" xref="S3.E3.m1.5.5.3"></eq><apply id="S3.E3.m1.4.4.1.cmml" xref="S3.E3.m1.4.4.1"><times id="S3.E3.m1.4.4.1.2.cmml" xref="S3.E3.m1.4.4.1.2"></times><ci id="S3.E3.m1.4.4.1.3a.cmml" xref="S3.E3.m1.4.4.1.3"><mtext id="S3.E3.m1.4.4.1.3.cmml" xref="S3.E3.m1.4.4.1.3">Align</mtext></ci><interval closure="open" id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1"><apply id="S3.E3.m1.4.4.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.2">𝑟</ci><ci id="S3.E3.m1.4.4.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3">𝑗</ci></apply><ci id="S3.E3.m1.1.1a.cmml" xref="S3.E3.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">t</mtext></ci></interval></apply><apply id="S3.E3.m1.5.5.2.cmml" xref="S3.E3.m1.5.5.2"><times id="S3.E3.m1.5.5.2.2.cmml" xref="S3.E3.m1.5.5.2.2"></times><ci id="S3.E3.m1.5.5.2.3.cmml" xref="S3.E3.m1.5.5.2.3">𝜎</ci><apply id="S3.E3.m1.5.5.2.1.1.1.cmml" xref="S3.E3.m1.5.5.2.1.1"><plus id="S3.E3.m1.5.5.2.1.1.1.2.cmml" xref="S3.E3.m1.5.5.2.1.1.1.2"></plus><apply id="S3.E3.m1.5.5.2.1.1.1.1.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1"><times id="S3.E3.m1.5.5.2.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.2"></times><apply id="S3.E3.m1.5.5.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1"><max id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"></max><cn type="integer" id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">0</cn><apply id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1"><plus id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2"><times id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.2">𝑧</ci><ci id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.2">𝑊</ci><cn type="integer" id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.2">𝑏</ci><cn type="integer" id="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.5.5.2.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.2.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="S3.E3.m1.5.5.2.1.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.2.1.1.1.1.3.3">2</cn></apply></apply><apply id="S3.E3.m1.5.5.2.1.1.1.3.cmml" xref="S3.E3.m1.5.5.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.2.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.2.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.2.1.1.1.3.2">𝑏</ci><cn type="integer" id="S3.E3.m1.5.5.2.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.2.1.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\textrm{Align}(r_{j},\textbf{t})=\sigma(\max(0,z_{j}W_{1}+b_{1})W_{2}+b_{2})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p4" class="ltx_para ltx_noindent">
<p id="S3.SS4.p4.5" class="ltx_p">where <math id="S3.SS4.p4.1.m1.2" class="ltx_Math" alttext="W_{1}\in\mathbb{R}^{d_{r}+d_{t},d_{j}}" display="inline"><semantics id="S3.SS4.p4.1.m1.2a"><mrow id="S3.SS4.p4.1.m1.2.3" xref="S3.SS4.p4.1.m1.2.3.cmml"><msub id="S3.SS4.p4.1.m1.2.3.2" xref="S3.SS4.p4.1.m1.2.3.2.cmml"><mi id="S3.SS4.p4.1.m1.2.3.2.2" xref="S3.SS4.p4.1.m1.2.3.2.2.cmml">W</mi><mn id="S3.SS4.p4.1.m1.2.3.2.3" xref="S3.SS4.p4.1.m1.2.3.2.3.cmml">1</mn></msub><mo id="S3.SS4.p4.1.m1.2.3.1" xref="S3.SS4.p4.1.m1.2.3.1.cmml">∈</mo><msup id="S3.SS4.p4.1.m1.2.3.3" xref="S3.SS4.p4.1.m1.2.3.3.cmml"><mi id="S3.SS4.p4.1.m1.2.3.3.2" xref="S3.SS4.p4.1.m1.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p4.1.m1.2.2.2.2" xref="S3.SS4.p4.1.m1.2.2.2.3.cmml"><mrow id="S3.SS4.p4.1.m1.1.1.1.1.1" xref="S3.SS4.p4.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS4.p4.1.m1.1.1.1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p4.1.m1.1.1.1.1.1.2.2" xref="S3.SS4.p4.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mi id="S3.SS4.p4.1.m1.1.1.1.1.1.2.3" xref="S3.SS4.p4.1.m1.1.1.1.1.1.2.3.cmml">r</mi></msub><mo id="S3.SS4.p4.1.m1.1.1.1.1.1.1" xref="S3.SS4.p4.1.m1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS4.p4.1.m1.1.1.1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS4.p4.1.m1.1.1.1.1.1.3.2" xref="S3.SS4.p4.1.m1.1.1.1.1.1.3.2.cmml">d</mi><mi id="S3.SS4.p4.1.m1.1.1.1.1.1.3.3" xref="S3.SS4.p4.1.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS4.p4.1.m1.2.2.2.2.3" xref="S3.SS4.p4.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p4.1.m1.2.2.2.2.2" xref="S3.SS4.p4.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS4.p4.1.m1.2.2.2.2.2.2" xref="S3.SS4.p4.1.m1.2.2.2.2.2.2.cmml">d</mi><mi id="S3.SS4.p4.1.m1.2.2.2.2.2.3" xref="S3.SS4.p4.1.m1.2.2.2.2.2.3.cmml">j</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.2b"><apply id="S3.SS4.p4.1.m1.2.3.cmml" xref="S3.SS4.p4.1.m1.2.3"><in id="S3.SS4.p4.1.m1.2.3.1.cmml" xref="S3.SS4.p4.1.m1.2.3.1"></in><apply id="S3.SS4.p4.1.m1.2.3.2.cmml" xref="S3.SS4.p4.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.2.3.2.1.cmml" xref="S3.SS4.p4.1.m1.2.3.2">subscript</csymbol><ci id="S3.SS4.p4.1.m1.2.3.2.2.cmml" xref="S3.SS4.p4.1.m1.2.3.2.2">𝑊</ci><cn type="integer" id="S3.SS4.p4.1.m1.2.3.2.3.cmml" xref="S3.SS4.p4.1.m1.2.3.2.3">1</cn></apply><apply id="S3.SS4.p4.1.m1.2.3.3.cmml" xref="S3.SS4.p4.1.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.2.3.3.1.cmml" xref="S3.SS4.p4.1.m1.2.3.3">superscript</csymbol><ci id="S3.SS4.p4.1.m1.2.3.3.2.cmml" xref="S3.SS4.p4.1.m1.2.3.3.2">ℝ</ci><list id="S3.SS4.p4.1.m1.2.2.2.3.cmml" xref="S3.SS4.p4.1.m1.2.2.2.2"><apply id="S3.SS4.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1.1.1.1"><plus id="S3.SS4.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1.1.1.1.1"></plus><apply id="S3.SS4.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p4.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p4.1.m1.1.1.1.1.1.2.2">𝑑</ci><ci id="S3.SS4.p4.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p4.1.m1.1.1.1.1.1.2.3">𝑟</ci></apply><apply id="S3.SS4.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p4.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p4.1.m1.1.1.1.1.1.3.2">𝑑</ci><ci id="S3.SS4.p4.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p4.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.SS4.p4.1.m1.2.2.2.2.2.cmml" xref="S3.SS4.p4.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS4.p4.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p4.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS4.p4.1.m1.2.2.2.2.2.2">𝑑</ci><ci id="S3.SS4.p4.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS4.p4.1.m1.2.2.2.2.2.3">𝑗</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.2c">W_{1}\in\mathbb{R}^{d_{r}+d_{t},d_{j}}</annotation></semantics></math>, <math id="S3.SS4.p4.2.m2.1" class="ltx_Math" alttext="b_{1}\in\mathbb{R}^{d_{j}}" display="inline"><semantics id="S3.SS4.p4.2.m2.1a"><mrow id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml"><msub id="S3.SS4.p4.2.m2.1.1.2" xref="S3.SS4.p4.2.m2.1.1.2.cmml"><mi id="S3.SS4.p4.2.m2.1.1.2.2" xref="S3.SS4.p4.2.m2.1.1.2.2.cmml">b</mi><mn id="S3.SS4.p4.2.m2.1.1.2.3" xref="S3.SS4.p4.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS4.p4.2.m2.1.1.1" xref="S3.SS4.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS4.p4.2.m2.1.1.3" xref="S3.SS4.p4.2.m2.1.1.3.cmml"><mi id="S3.SS4.p4.2.m2.1.1.3.2" xref="S3.SS4.p4.2.m2.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS4.p4.2.m2.1.1.3.3" xref="S3.SS4.p4.2.m2.1.1.3.3.cmml"><mi id="S3.SS4.p4.2.m2.1.1.3.3.2" xref="S3.SS4.p4.2.m2.1.1.3.3.2.cmml">d</mi><mi id="S3.SS4.p4.2.m2.1.1.3.3.3" xref="S3.SS4.p4.2.m2.1.1.3.3.3.cmml">j</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><apply id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1"><in id="S3.SS4.p4.2.m2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1.1"></in><apply id="S3.SS4.p4.2.m2.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.2.1.cmml" xref="S3.SS4.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS4.p4.2.m2.1.1.2.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2.2">𝑏</ci><cn type="integer" id="S3.SS4.p4.2.m2.1.1.2.3.cmml" xref="S3.SS4.p4.2.m2.1.1.2.3">1</cn></apply><apply id="S3.SS4.p4.2.m2.1.1.3.cmml" xref="S3.SS4.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.3.1.cmml" xref="S3.SS4.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.p4.2.m2.1.1.3.2.cmml" xref="S3.SS4.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS4.p4.2.m2.1.1.3.3.cmml" xref="S3.SS4.p4.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS4.p4.2.m2.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS4.p4.2.m2.1.1.3.3.2">𝑑</ci><ci id="S3.SS4.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS4.p4.2.m2.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">b_{1}\in\mathbb{R}^{d_{j}}</annotation></semantics></math>, <math id="S3.SS4.p4.3.m3.2" class="ltx_Math" alttext="W_{2}\in\mathbb{R}^{d_{j},1}" display="inline"><semantics id="S3.SS4.p4.3.m3.2a"><mrow id="S3.SS4.p4.3.m3.2.3" xref="S3.SS4.p4.3.m3.2.3.cmml"><msub id="S3.SS4.p4.3.m3.2.3.2" xref="S3.SS4.p4.3.m3.2.3.2.cmml"><mi id="S3.SS4.p4.3.m3.2.3.2.2" xref="S3.SS4.p4.3.m3.2.3.2.2.cmml">W</mi><mn id="S3.SS4.p4.3.m3.2.3.2.3" xref="S3.SS4.p4.3.m3.2.3.2.3.cmml">2</mn></msub><mo id="S3.SS4.p4.3.m3.2.3.1" xref="S3.SS4.p4.3.m3.2.3.1.cmml">∈</mo><msup id="S3.SS4.p4.3.m3.2.3.3" xref="S3.SS4.p4.3.m3.2.3.3.cmml"><mi id="S3.SS4.p4.3.m3.2.3.3.2" xref="S3.SS4.p4.3.m3.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p4.3.m3.2.2.2.2" xref="S3.SS4.p4.3.m3.2.2.2.3.cmml"><msub id="S3.SS4.p4.3.m3.2.2.2.2.1" xref="S3.SS4.p4.3.m3.2.2.2.2.1.cmml"><mi id="S3.SS4.p4.3.m3.2.2.2.2.1.2" xref="S3.SS4.p4.3.m3.2.2.2.2.1.2.cmml">d</mi><mi id="S3.SS4.p4.3.m3.2.2.2.2.1.3" xref="S3.SS4.p4.3.m3.2.2.2.2.1.3.cmml">j</mi></msub><mo id="S3.SS4.p4.3.m3.2.2.2.2.2" xref="S3.SS4.p4.3.m3.2.2.2.3.cmml">,</mo><mn id="S3.SS4.p4.3.m3.1.1.1.1" xref="S3.SS4.p4.3.m3.1.1.1.1.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.2b"><apply id="S3.SS4.p4.3.m3.2.3.cmml" xref="S3.SS4.p4.3.m3.2.3"><in id="S3.SS4.p4.3.m3.2.3.1.cmml" xref="S3.SS4.p4.3.m3.2.3.1"></in><apply id="S3.SS4.p4.3.m3.2.3.2.cmml" xref="S3.SS4.p4.3.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p4.3.m3.2.3.2.1.cmml" xref="S3.SS4.p4.3.m3.2.3.2">subscript</csymbol><ci id="S3.SS4.p4.3.m3.2.3.2.2.cmml" xref="S3.SS4.p4.3.m3.2.3.2.2">𝑊</ci><cn type="integer" id="S3.SS4.p4.3.m3.2.3.2.3.cmml" xref="S3.SS4.p4.3.m3.2.3.2.3">2</cn></apply><apply id="S3.SS4.p4.3.m3.2.3.3.cmml" xref="S3.SS4.p4.3.m3.2.3.3"><csymbol cd="ambiguous" id="S3.SS4.p4.3.m3.2.3.3.1.cmml" xref="S3.SS4.p4.3.m3.2.3.3">superscript</csymbol><ci id="S3.SS4.p4.3.m3.2.3.3.2.cmml" xref="S3.SS4.p4.3.m3.2.3.3.2">ℝ</ci><list id="S3.SS4.p4.3.m3.2.2.2.3.cmml" xref="S3.SS4.p4.3.m3.2.2.2.2"><apply id="S3.SS4.p4.3.m3.2.2.2.2.1.cmml" xref="S3.SS4.p4.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS4.p4.3.m3.2.2.2.2.1.1.cmml" xref="S3.SS4.p4.3.m3.2.2.2.2.1">subscript</csymbol><ci id="S3.SS4.p4.3.m3.2.2.2.2.1.2.cmml" xref="S3.SS4.p4.3.m3.2.2.2.2.1.2">𝑑</ci><ci id="S3.SS4.p4.3.m3.2.2.2.2.1.3.cmml" xref="S3.SS4.p4.3.m3.2.2.2.2.1.3">𝑗</ci></apply><cn type="integer" id="S3.SS4.p4.3.m3.1.1.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1.1.1">1</cn></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.2c">W_{2}\in\mathbb{R}^{d_{j},1}</annotation></semantics></math> and <math id="S3.SS4.p4.4.m4.1" class="ltx_Math" alttext="b_{2}\in\mathbb{R}^{1}" display="inline"><semantics id="S3.SS4.p4.4.m4.1a"><mrow id="S3.SS4.p4.4.m4.1.1" xref="S3.SS4.p4.4.m4.1.1.cmml"><msub id="S3.SS4.p4.4.m4.1.1.2" xref="S3.SS4.p4.4.m4.1.1.2.cmml"><mi id="S3.SS4.p4.4.m4.1.1.2.2" xref="S3.SS4.p4.4.m4.1.1.2.2.cmml">b</mi><mn id="S3.SS4.p4.4.m4.1.1.2.3" xref="S3.SS4.p4.4.m4.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS4.p4.4.m4.1.1.1" xref="S3.SS4.p4.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS4.p4.4.m4.1.1.3" xref="S3.SS4.p4.4.m4.1.1.3.cmml"><mi id="S3.SS4.p4.4.m4.1.1.3.2" xref="S3.SS4.p4.4.m4.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS4.p4.4.m4.1.1.3.3" xref="S3.SS4.p4.4.m4.1.1.3.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m4.1b"><apply id="S3.SS4.p4.4.m4.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1"><in id="S3.SS4.p4.4.m4.1.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1.1"></in><apply id="S3.SS4.p4.4.m4.1.1.2.cmml" xref="S3.SS4.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.1.1.2.1.cmml" xref="S3.SS4.p4.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS4.p4.4.m4.1.1.2.2.cmml" xref="S3.SS4.p4.4.m4.1.1.2.2">𝑏</ci><cn type="integer" id="S3.SS4.p4.4.m4.1.1.2.3.cmml" xref="S3.SS4.p4.4.m4.1.1.2.3">2</cn></apply><apply id="S3.SS4.p4.4.m4.1.1.3.cmml" xref="S3.SS4.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.1.1.3.1.cmml" xref="S3.SS4.p4.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS4.p4.4.m4.1.1.3.2.cmml" xref="S3.SS4.p4.4.m4.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS4.p4.4.m4.1.1.3.3.cmml" xref="S3.SS4.p4.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m4.1c">b_{2}\in\mathbb{R}^{1}</annotation></semantics></math> are the parameters of the neural network and <math id="S3.SS4.p4.5.m5.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="S3.SS4.p4.5.m5.1a"><mrow id="S3.SS4.p4.5.m5.1.2" xref="S3.SS4.p4.5.m5.1.2.cmml"><mi id="S3.SS4.p4.5.m5.1.2.2" xref="S3.SS4.p4.5.m5.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p4.5.m5.1.2.1" xref="S3.SS4.p4.5.m5.1.2.1.cmml">​</mo><mrow id="S3.SS4.p4.5.m5.1.2.3.2" xref="S3.SS4.p4.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS4.p4.5.m5.1.2.3.2.1" xref="S3.SS4.p4.5.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS4.p4.5.m5.1.1" xref="S3.SS4.p4.5.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS4.p4.5.m5.1.2.3.2.2" xref="S3.SS4.p4.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m5.1b"><apply id="S3.SS4.p4.5.m5.1.2.cmml" xref="S3.SS4.p4.5.m5.1.2"><times id="S3.SS4.p4.5.m5.1.2.1.cmml" xref="S3.SS4.p4.5.m5.1.2.1"></times><ci id="S3.SS4.p4.5.m5.1.2.2.cmml" xref="S3.SS4.p4.5.m5.1.2.2">𝜎</ci><ci id="S3.SS4.p4.5.m5.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m5.1c">\sigma(\cdot)</annotation></semantics></math> is the sigmoid function.</p>
</div>
<div id="S3.SS4.p5" class="ltx_para ltx_noindent">
<p id="S3.SS4.p5.1" class="ltx_p">The Alignment Model can be trained end-to-end using a suitable loss function, such as cross-entropy loss, to maximize the similarity between the positive proposal-text pairs and minimize the similarity between the negative proposal-text pairs. The output of the Alignment Model can be used for various tasks, such as visual grounding, where the goal is to locate a specific object in an image given a textual description.</p>
</div>
<div id="S3.SS4.p6" class="ltx_para ltx_noindent">
<p id="S3.SS4.p6.1" class="ltx_p">The loss function for the Alignment Model is designed to measure the difference between the predicted relationship between a proposal and a textual description, and the ground truth relationship. The prediction is made through the Alignment Model’s binary classification output, which represents the confidence of a given proposal being described by the textual description. The loss is calculated by taking the binary cross-entropy between the predicted probability of the positive class and the ground truth label, which is either 1 (positive) or 0 (negative). The overall loss function is the sum of the binary cross-entropy losses for all the positive and negative proposal-text pairs. The goal is to minimize this loss, which will result in the Alignment Model becoming more accurate in predicting the relationship between proposals and their textual descriptions. By minimizing the loss, the Alignment Model learns to discriminate between proposals that are and are not described by a textual description, leading to improved object detection performance.</p>
</div>
<div id="S3.SS4.p7" class="ltx_para ltx_noindent">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.4" class="ltx_Math" alttext="\mathcal{L}_{\text{align}}=-\frac{1}{N}\sum_{i=1}^{N}(y_{i}\log(\hat{y_{i}})+(1-y_{i})\log(1-\hat{y_{i}}))" display="block"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><msub id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.3.2" xref="S3.E4.m1.4.4.3.2.cmml">ℒ</mi><mtext id="S3.E4.m1.4.4.3.3" xref="S3.E4.m1.4.4.3.3a.cmml">align</mtext></msub><mo id="S3.E4.m1.4.4.2" xref="S3.E4.m1.4.4.2.cmml">=</mo><mrow id="S3.E4.m1.4.4.1" xref="S3.E4.m1.4.4.1.cmml"><mo id="S3.E4.m1.4.4.1a" xref="S3.E4.m1.4.4.1.cmml">−</mo><mrow id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml"><mfrac id="S3.E4.m1.4.4.1.1.3" xref="S3.E4.m1.4.4.1.1.3.cmml"><mn id="S3.E4.m1.4.4.1.1.3.2" xref="S3.E4.m1.4.4.1.1.3.2.cmml">1</mn><mi id="S3.E4.m1.4.4.1.1.3.3" xref="S3.E4.m1.4.4.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.2" xref="S3.E4.m1.4.4.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.4.4.1.1.1" xref="S3.E4.m1.4.4.1.1.1.cmml"><munderover id="S3.E4.m1.4.4.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E4.m1.4.4.1.1.1.2.2.2" xref="S3.E4.m1.4.4.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.4.4.1.1.1.2.2.3" xref="S3.E4.m1.4.4.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.2.2.3.2" xref="S3.E4.m1.4.4.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E4.m1.4.4.1.1.1.2.2.3.1" xref="S3.E4.m1.4.4.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.4.4.1.1.1.2.2.3.3" xref="S3.E4.m1.4.4.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.4.4.1.1.1.2.3" xref="S3.E4.m1.4.4.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E4.m1.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.4" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.cmml"><msub id="S3.E4.m1.4.4.1.1.1.1.1.1.4.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.2.cmml">y</mi><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E4.m1.4.4.1.1.1.1.1.1.4.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.1.cmml">​</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.1.cmml"><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">log</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.2a" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.1.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.2.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.2.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.1.cmml">(</mo><mover accent="true" id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><msub id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml"><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">y</mi><mi id="S3.E4.m1.2.2.2.3" xref="S3.E4.m1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.cmml">^</mo></mover><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.2.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml">+</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E4.m1.4.4.1.1.1.1.1.1.2.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">log</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1a" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.cmml"><mn id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.1.cmml">−</mo><mover accent="true" id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.cmml"><msub id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.2.cmml">y</mi><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.1.cmml">^</mo></mover></mrow><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.2.cmml" xref="S3.E4.m1.4.4.2"></eq><apply id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.cmml" xref="S3.E4.m1.4.4.3">subscript</csymbol><ci id="S3.E4.m1.4.4.3.2.cmml" xref="S3.E4.m1.4.4.3.2">ℒ</ci><ci id="S3.E4.m1.4.4.3.3a.cmml" xref="S3.E4.m1.4.4.3.3"><mtext mathsize="70%" id="S3.E4.m1.4.4.3.3.cmml" xref="S3.E4.m1.4.4.3.3">align</mtext></ci></apply><apply id="S3.E4.m1.4.4.1.cmml" xref="S3.E4.m1.4.4.1"><minus id="S3.E4.m1.4.4.1.2.cmml" xref="S3.E4.m1.4.4.1"></minus><apply id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1"><times id="S3.E4.m1.4.4.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.2"></times><apply id="S3.E4.m1.4.4.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.3"><divide id="S3.E4.m1.4.4.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.3"></divide><cn type="integer" id="S3.E4.m1.4.4.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.3.2">1</cn><ci id="S3.E4.m1.4.4.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.3.3">𝑁</ci></apply><apply id="S3.E4.m1.4.4.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1"><apply id="S3.E4.m1.4.4.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.4.4.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.4.4.1.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.4.4.1.1.1.2.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.2.2.3"><eq id="S3.E4.m1.4.4.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.4.4.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.4.4.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.4.4.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1"><plus id="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3"></plus><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4"><times id="S3.E4.m1.4.4.1.1.1.1.1.1.4.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.1"></times><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.2">𝑦</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.2.3">𝑖</ci></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.4.3.2"><log id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"></log><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><ci id="S3.E4.m1.2.2.1.cmml" xref="S3.E4.m1.2.2.1">^</ci><apply id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑦</ci><ci id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2"><times id="S3.E4.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.3"></times><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1"><minus id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1"><log id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"></log><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1"><minus id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.1"></minus><cn type="integer" id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.2">1</cn><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3"><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.1">^</ci><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.2">𝑦</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\mathcal{L}_{\text{align}}=-\frac{1}{N}\sum_{i=1}^{N}(y_{i}\log(\hat{y_{i}})+(1-y_{i})\log(1-\hat{y_{i}}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p8" class="ltx_para ltx_noindent">
<p id="S3.SS4.p8.5" class="ltx_p">where <math id="S3.SS4.p8.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS4.p8.1.m1.1a"><mi id="S3.SS4.p8.1.m1.1.1" xref="S3.SS4.p8.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p8.1.m1.1b"><ci id="S3.SS4.p8.1.m1.1.1.cmml" xref="S3.SS4.p8.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p8.1.m1.1c">N</annotation></semantics></math> is the number of proposals, <math id="S3.SS4.p8.2.m2.1" class="ltx_Math" alttext="\hat{y_{i}}" display="inline"><semantics id="S3.SS4.p8.2.m2.1a"><mover accent="true" id="S3.SS4.p8.2.m2.1.1" xref="S3.SS4.p8.2.m2.1.1.cmml"><msub id="S3.SS4.p8.2.m2.1.1.2" xref="S3.SS4.p8.2.m2.1.1.2.cmml"><mi id="S3.SS4.p8.2.m2.1.1.2.2" xref="S3.SS4.p8.2.m2.1.1.2.2.cmml">y</mi><mi id="S3.SS4.p8.2.m2.1.1.2.3" xref="S3.SS4.p8.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p8.2.m2.1.1.1" xref="S3.SS4.p8.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p8.2.m2.1b"><apply id="S3.SS4.p8.2.m2.1.1.cmml" xref="S3.SS4.p8.2.m2.1.1"><ci id="S3.SS4.p8.2.m2.1.1.1.cmml" xref="S3.SS4.p8.2.m2.1.1.1">^</ci><apply id="S3.SS4.p8.2.m2.1.1.2.cmml" xref="S3.SS4.p8.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p8.2.m2.1.1.2.1.cmml" xref="S3.SS4.p8.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS4.p8.2.m2.1.1.2.2.cmml" xref="S3.SS4.p8.2.m2.1.1.2.2">𝑦</ci><ci id="S3.SS4.p8.2.m2.1.1.2.3.cmml" xref="S3.SS4.p8.2.m2.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p8.2.m2.1c">\hat{y_{i}}</annotation></semantics></math> is the predicted alignment score for proposal <math id="S3.SS4.p8.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p8.3.m3.1a"><mi id="S3.SS4.p8.3.m3.1.1" xref="S3.SS4.p8.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p8.3.m3.1b"><ci id="S3.SS4.p8.3.m3.1.1.cmml" xref="S3.SS4.p8.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p8.3.m3.1c">i</annotation></semantics></math>, and <math id="S3.SS4.p8.4.m4.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S3.SS4.p8.4.m4.1a"><msub id="S3.SS4.p8.4.m4.1.1" xref="S3.SS4.p8.4.m4.1.1.cmml"><mi id="S3.SS4.p8.4.m4.1.1.2" xref="S3.SS4.p8.4.m4.1.1.2.cmml">y</mi><mi id="S3.SS4.p8.4.m4.1.1.3" xref="S3.SS4.p8.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p8.4.m4.1b"><apply id="S3.SS4.p8.4.m4.1.1.cmml" xref="S3.SS4.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p8.4.m4.1.1.1.cmml" xref="S3.SS4.p8.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p8.4.m4.1.1.2.cmml" xref="S3.SS4.p8.4.m4.1.1.2">𝑦</ci><ci id="S3.SS4.p8.4.m4.1.1.3.cmml" xref="S3.SS4.p8.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p8.4.m4.1c">y_{i}</annotation></semantics></math> is the true label indicating if the proposal <math id="S3.SS4.p8.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p8.5.m5.1a"><mi id="S3.SS4.p8.5.m5.1.1" xref="S3.SS4.p8.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p8.5.m5.1b"><ci id="S3.SS4.p8.5.m5.1.1.cmml" xref="S3.SS4.p8.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p8.5.m5.1c">i</annotation></semantics></math> is aligned with the corresponding textual description or not. The loss function optimizes the model to predict binary alignment scores that are as close as possible to the ground-truth labels.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Scoring Proposals</h3>

<div id="S3.SS5.p1" class="ltx_para ltx_noindent">
<p id="S3.SS5.p1.4" class="ltx_p">The scoring proposals stage is the final step in the proposal-text alignment model. Given a set of region proposals, <span id="S3.SS5.p1.4.1" class="ltx_text ltx_markedasmath ltx_font_bold">r</span>, and a textual description <span id="S3.SS5.p1.4.2" class="ltx_text ltx_markedasmath ltx_font_bold">t</span>, the scoring proposals stage computes a score, <math id="S3.SS5.p1.3.m3.2" class="ltx_Math" alttext="\textrm{Score}(r_{j},\textbf{t})" display="inline"><semantics id="S3.SS5.p1.3.m3.2a"><mrow id="S3.SS5.p1.3.m3.2.2" xref="S3.SS5.p1.3.m3.2.2.cmml"><mtext id="S3.SS5.p1.3.m3.2.2.3" xref="S3.SS5.p1.3.m3.2.2.3a.cmml">Score</mtext><mo lspace="0em" rspace="0em" id="S3.SS5.p1.3.m3.2.2.2" xref="S3.SS5.p1.3.m3.2.2.2.cmml">​</mo><mrow id="S3.SS5.p1.3.m3.2.2.1.1" xref="S3.SS5.p1.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS5.p1.3.m3.2.2.1.1.2" xref="S3.SS5.p1.3.m3.2.2.1.2.cmml">(</mo><msub id="S3.SS5.p1.3.m3.2.2.1.1.1" xref="S3.SS5.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS5.p1.3.m3.2.2.1.1.1.2" xref="S3.SS5.p1.3.m3.2.2.1.1.1.2.cmml">r</mi><mi id="S3.SS5.p1.3.m3.2.2.1.1.1.3" xref="S3.SS5.p1.3.m3.2.2.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS5.p1.3.m3.2.2.1.1.3" xref="S3.SS5.p1.3.m3.2.2.1.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1a.cmml">t</mtext><mo stretchy="false" id="S3.SS5.p1.3.m3.2.2.1.1.4" xref="S3.SS5.p1.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.2b"><apply id="S3.SS5.p1.3.m3.2.2.cmml" xref="S3.SS5.p1.3.m3.2.2"><times id="S3.SS5.p1.3.m3.2.2.2.cmml" xref="S3.SS5.p1.3.m3.2.2.2"></times><ci id="S3.SS5.p1.3.m3.2.2.3a.cmml" xref="S3.SS5.p1.3.m3.2.2.3"><mtext id="S3.SS5.p1.3.m3.2.2.3.cmml" xref="S3.SS5.p1.3.m3.2.2.3">Score</mtext></ci><interval closure="open" id="S3.SS5.p1.3.m3.2.2.1.2.cmml" xref="S3.SS5.p1.3.m3.2.2.1.1"><apply id="S3.SS5.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS5.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS5.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS5.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS5.p1.3.m3.2.2.1.1.1.2">𝑟</ci><ci id="S3.SS5.p1.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS5.p1.3.m3.2.2.1.1.1.3">𝑗</ci></apply><ci id="S3.SS5.p1.3.m3.1.1a.cmml" xref="S3.SS5.p1.3.m3.1.1"><mtext class="ltx_mathvariant_bold" id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1">t</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.2c">\textrm{Score}(r_{j},\textbf{t})</annotation></semantics></math>, for each proposal <math id="S3.SS5.p1.4.m4.1" class="ltx_Math" alttext="r_{j}" display="inline"><semantics id="S3.SS5.p1.4.m4.1a"><msub id="S3.SS5.p1.4.m4.1.1" xref="S3.SS5.p1.4.m4.1.1.cmml"><mi id="S3.SS5.p1.4.m4.1.1.2" xref="S3.SS5.p1.4.m4.1.1.2.cmml">r</mi><mi id="S3.SS5.p1.4.m4.1.1.3" xref="S3.SS5.p1.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.1b"><apply id="S3.SS5.p1.4.m4.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS5.p1.4.m4.1.1.2.cmml" xref="S3.SS5.p1.4.m4.1.1.2">𝑟</ci><ci id="S3.SS5.p1.4.m4.1.1.3.cmml" xref="S3.SS5.p1.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.1c">r_{j}</annotation></semantics></math> that indicates the level of semantic compatibility between the proposal and the text description.</p>
</div>
<div id="S3.SS5.p2" class="ltx_para ltx_noindent">
<p id="S3.SS5.p2.3" class="ltx_p">The score calculation is based on the outputs from the Alignment Model, <math id="S3.SS5.p2.1.m1.2" class="ltx_Math" alttext="\textrm{Align}(r_{j},\textbf{t})" display="inline"><semantics id="S3.SS5.p2.1.m1.2a"><mrow id="S3.SS5.p2.1.m1.2.2" xref="S3.SS5.p2.1.m1.2.2.cmml"><mtext id="S3.SS5.p2.1.m1.2.2.3" xref="S3.SS5.p2.1.m1.2.2.3a.cmml">Align</mtext><mo lspace="0em" rspace="0em" id="S3.SS5.p2.1.m1.2.2.2" xref="S3.SS5.p2.1.m1.2.2.2.cmml">​</mo><mrow id="S3.SS5.p2.1.m1.2.2.1.1" xref="S3.SS5.p2.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS5.p2.1.m1.2.2.1.1.2" xref="S3.SS5.p2.1.m1.2.2.1.2.cmml">(</mo><msub id="S3.SS5.p2.1.m1.2.2.1.1.1" xref="S3.SS5.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS5.p2.1.m1.2.2.1.1.1.2" xref="S3.SS5.p2.1.m1.2.2.1.1.1.2.cmml">r</mi><mi id="S3.SS5.p2.1.m1.2.2.1.1.1.3" xref="S3.SS5.p2.1.m1.2.2.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS5.p2.1.m1.2.2.1.1.3" xref="S3.SS5.p2.1.m1.2.2.1.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.SS5.p2.1.m1.1.1" xref="S3.SS5.p2.1.m1.1.1a.cmml">t</mtext><mo stretchy="false" id="S3.SS5.p2.1.m1.2.2.1.1.4" xref="S3.SS5.p2.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.2b"><apply id="S3.SS5.p2.1.m1.2.2.cmml" xref="S3.SS5.p2.1.m1.2.2"><times id="S3.SS5.p2.1.m1.2.2.2.cmml" xref="S3.SS5.p2.1.m1.2.2.2"></times><ci id="S3.SS5.p2.1.m1.2.2.3a.cmml" xref="S3.SS5.p2.1.m1.2.2.3"><mtext id="S3.SS5.p2.1.m1.2.2.3.cmml" xref="S3.SS5.p2.1.m1.2.2.3">Align</mtext></ci><interval closure="open" id="S3.SS5.p2.1.m1.2.2.1.2.cmml" xref="S3.SS5.p2.1.m1.2.2.1.1"><apply id="S3.SS5.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS5.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS5.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS5.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS5.p2.1.m1.2.2.1.1.1.2">𝑟</ci><ci id="S3.SS5.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS5.p2.1.m1.2.2.1.1.1.3">𝑗</ci></apply><ci id="S3.SS5.p2.1.m1.1.1a.cmml" xref="S3.SS5.p2.1.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.SS5.p2.1.m1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1">t</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.2c">\textrm{Align}(r_{j},\textbf{t})</annotation></semantics></math>. These outputs are interpreted as the probabilities of each proposal <math id="S3.SS5.p2.2.m2.1" class="ltx_Math" alttext="r_{j}" display="inline"><semantics id="S3.SS5.p2.2.m2.1a"><msub id="S3.SS5.p2.2.m2.1.1" xref="S3.SS5.p2.2.m2.1.1.cmml"><mi id="S3.SS5.p2.2.m2.1.1.2" xref="S3.SS5.p2.2.m2.1.1.2.cmml">r</mi><mi id="S3.SS5.p2.2.m2.1.1.3" xref="S3.SS5.p2.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.2.m2.1b"><apply id="S3.SS5.p2.2.m2.1.1.cmml" xref="S3.SS5.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.2.m2.1.1.1.cmml" xref="S3.SS5.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.p2.2.m2.1.1.2.cmml" xref="S3.SS5.p2.2.m2.1.1.2">𝑟</ci><ci id="S3.SS5.p2.2.m2.1.1.3.cmml" xref="S3.SS5.p2.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.2.m2.1c">r_{j}</annotation></semantics></math> being the correct match for the textual description <span id="S3.SS5.p2.3.1" class="ltx_text ltx_markedasmath ltx_font_bold">t</span>. The scores for all the proposals are then combined and ranked, with the proposals with the highest scores being selected as the final detections. The equation for the Score function can be written as follows:</p>
</div>
<div id="S3.SS5.p3" class="ltx_para ltx_noindent">
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.5" class="ltx_Math" alttext="\textrm{Score}(r_{j},\textbf{t})=\textrm{Conf}(r_{j})\times\textrm{Align}(r_{j},\textbf{t})" display="block"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml"><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.cmml"><mtext id="S3.E5.m1.3.3.1.3" xref="S3.E5.m1.3.3.1.3a.cmml">Score</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.2" xref="S3.E5.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.2" xref="S3.E5.m1.3.3.1.1.2.cmml">(</mo><msub id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.2.cmml">r</mi><mi id="S3.E5.m1.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E5.m1.3.3.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1a.cmml">t</mtext><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.4" xref="S3.E5.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.5.5.4" xref="S3.E5.m1.5.5.4.cmml">=</mo><mrow id="S3.E5.m1.5.5.3" xref="S3.E5.m1.5.5.3.cmml"><mrow id="S3.E5.m1.4.4.2.1" xref="S3.E5.m1.4.4.2.1.cmml"><mrow id="S3.E5.m1.4.4.2.1.1" xref="S3.E5.m1.4.4.2.1.1.cmml"><mtext id="S3.E5.m1.4.4.2.1.1.3" xref="S3.E5.m1.4.4.2.1.1.3a.cmml">Conf</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.4.2.1.1.2" xref="S3.E5.m1.4.4.2.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.4.4.2.1.1.1.1" xref="S3.E5.m1.4.4.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.4.4.2.1.1.1.1.2" xref="S3.E5.m1.4.4.2.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.4.4.2.1.1.1.1.1" xref="S3.E5.m1.4.4.2.1.1.1.1.1.cmml"><mi id="S3.E5.m1.4.4.2.1.1.1.1.1.2" xref="S3.E5.m1.4.4.2.1.1.1.1.1.2.cmml">r</mi><mi id="S3.E5.m1.4.4.2.1.1.1.1.1.3" xref="S3.E5.m1.4.4.2.1.1.1.1.1.3.cmml">j</mi></msub><mo rspace="0.055em" stretchy="false" id="S3.E5.m1.4.4.2.1.1.1.1.3" xref="S3.E5.m1.4.4.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E5.m1.4.4.2.1.2" xref="S3.E5.m1.4.4.2.1.2.cmml">×</mo><mtext id="S3.E5.m1.4.4.2.1.3" xref="S3.E5.m1.4.4.2.1.3a.cmml">Align</mtext></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.3.3" xref="S3.E5.m1.5.5.3.3.cmml">​</mo><mrow id="S3.E5.m1.5.5.3.2.1" xref="S3.E5.m1.5.5.3.2.2.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.3.2.1.2" xref="S3.E5.m1.5.5.3.2.2.cmml">(</mo><msub id="S3.E5.m1.5.5.3.2.1.1" xref="S3.E5.m1.5.5.3.2.1.1.cmml"><mi id="S3.E5.m1.5.5.3.2.1.1.2" xref="S3.E5.m1.5.5.3.2.1.1.2.cmml">r</mi><mi id="S3.E5.m1.5.5.3.2.1.1.3" xref="S3.E5.m1.5.5.3.2.1.1.3.cmml">j</mi></msub><mo id="S3.E5.m1.5.5.3.2.1.3" xref="S3.E5.m1.5.5.3.2.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2a.cmml">t</mtext><mo stretchy="false" id="S3.E5.m1.5.5.3.2.1.4" xref="S3.E5.m1.5.5.3.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5"><eq id="S3.E5.m1.5.5.4.cmml" xref="S3.E5.m1.5.5.4"></eq><apply id="S3.E5.m1.3.3.1.cmml" xref="S3.E5.m1.3.3.1"><times id="S3.E5.m1.3.3.1.2.cmml" xref="S3.E5.m1.3.3.1.2"></times><ci id="S3.E5.m1.3.3.1.3a.cmml" xref="S3.E5.m1.3.3.1.3"><mtext id="S3.E5.m1.3.3.1.3.cmml" xref="S3.E5.m1.3.3.1.3">Score</mtext></ci><interval closure="open" id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1"><apply id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2">𝑟</ci><ci id="S3.E5.m1.3.3.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3">𝑗</ci></apply><ci id="S3.E5.m1.1.1a.cmml" xref="S3.E5.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">t</mtext></ci></interval></apply><apply id="S3.E5.m1.5.5.3.cmml" xref="S3.E5.m1.5.5.3"><times id="S3.E5.m1.5.5.3.3.cmml" xref="S3.E5.m1.5.5.3.3"></times><apply id="S3.E5.m1.4.4.2.1.cmml" xref="S3.E5.m1.4.4.2.1"><times id="S3.E5.m1.4.4.2.1.2.cmml" xref="S3.E5.m1.4.4.2.1.2"></times><apply id="S3.E5.m1.4.4.2.1.1.cmml" xref="S3.E5.m1.4.4.2.1.1"><times id="S3.E5.m1.4.4.2.1.1.2.cmml" xref="S3.E5.m1.4.4.2.1.1.2"></times><ci id="S3.E5.m1.4.4.2.1.1.3a.cmml" xref="S3.E5.m1.4.4.2.1.1.3"><mtext id="S3.E5.m1.4.4.2.1.1.3.cmml" xref="S3.E5.m1.4.4.2.1.1.3">Conf</mtext></ci><apply id="S3.E5.m1.4.4.2.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.4.4.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.1.2">𝑟</ci><ci id="S3.E5.m1.4.4.2.1.1.1.1.1.3.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.1.3">𝑗</ci></apply></apply><ci id="S3.E5.m1.4.4.2.1.3a.cmml" xref="S3.E5.m1.4.4.2.1.3"><mtext id="S3.E5.m1.4.4.2.1.3.cmml" xref="S3.E5.m1.4.4.2.1.3">Align</mtext></ci></apply><interval closure="open" id="S3.E5.m1.5.5.3.2.2.cmml" xref="S3.E5.m1.5.5.3.2.1"><apply id="S3.E5.m1.5.5.3.2.1.1.cmml" xref="S3.E5.m1.5.5.3.2.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.3.2.1.1.1.cmml" xref="S3.E5.m1.5.5.3.2.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.3.2.1.1.2.cmml" xref="S3.E5.m1.5.5.3.2.1.1.2">𝑟</ci><ci id="S3.E5.m1.5.5.3.2.1.1.3.cmml" xref="S3.E5.m1.5.5.3.2.1.1.3">𝑗</ci></apply><ci id="S3.E5.m1.2.2a.cmml" xref="S3.E5.m1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">t</mtext></ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\textrm{Score}(r_{j},\textbf{t})=\textrm{Conf}(r_{j})\times\textrm{Align}(r_{j},\textbf{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS5.p4" class="ltx_para ltx_noindent">
<p id="S3.SS5.p4.4" class="ltx_p">where <math id="S3.SS5.p4.1.m1.1" class="ltx_Math" alttext="\textrm{Conf}(r_{j})" display="inline"><semantics id="S3.SS5.p4.1.m1.1a"><mrow id="S3.SS5.p4.1.m1.1.1" xref="S3.SS5.p4.1.m1.1.1.cmml"><mtext id="S3.SS5.p4.1.m1.1.1.3" xref="S3.SS5.p4.1.m1.1.1.3a.cmml">Conf</mtext><mo lspace="0em" rspace="0em" id="S3.SS5.p4.1.m1.1.1.2" xref="S3.SS5.p4.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS5.p4.1.m1.1.1.1.1" xref="S3.SS5.p4.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS5.p4.1.m1.1.1.1.1.2" xref="S3.SS5.p4.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS5.p4.1.m1.1.1.1.1.1" xref="S3.SS5.p4.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS5.p4.1.m1.1.1.1.1.1.2" xref="S3.SS5.p4.1.m1.1.1.1.1.1.2.cmml">r</mi><mi id="S3.SS5.p4.1.m1.1.1.1.1.1.3" xref="S3.SS5.p4.1.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS5.p4.1.m1.1.1.1.1.3" xref="S3.SS5.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p4.1.m1.1b"><apply id="S3.SS5.p4.1.m1.1.1.cmml" xref="S3.SS5.p4.1.m1.1.1"><times id="S3.SS5.p4.1.m1.1.1.2.cmml" xref="S3.SS5.p4.1.m1.1.1.2"></times><ci id="S3.SS5.p4.1.m1.1.1.3a.cmml" xref="S3.SS5.p4.1.m1.1.1.3"><mtext id="S3.SS5.p4.1.m1.1.1.3.cmml" xref="S3.SS5.p4.1.m1.1.1.3">Conf</mtext></ci><apply id="S3.SS5.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS5.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS5.p4.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS5.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS5.p4.1.m1.1.1.1.1.1.2">𝑟</ci><ci id="S3.SS5.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS5.p4.1.m1.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p4.1.m1.1c">\textrm{Conf}(r_{j})</annotation></semantics></math> is the confidence score of the region proposal <math id="S3.SS5.p4.2.m2.1" class="ltx_Math" alttext="r_{j}" display="inline"><semantics id="S3.SS5.p4.2.m2.1a"><msub id="S3.SS5.p4.2.m2.1.1" xref="S3.SS5.p4.2.m2.1.1.cmml"><mi id="S3.SS5.p4.2.m2.1.1.2" xref="S3.SS5.p4.2.m2.1.1.2.cmml">r</mi><mi id="S3.SS5.p4.2.m2.1.1.3" xref="S3.SS5.p4.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p4.2.m2.1b"><apply id="S3.SS5.p4.2.m2.1.1.cmml" xref="S3.SS5.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p4.2.m2.1.1.1.cmml" xref="S3.SS5.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.p4.2.m2.1.1.2.cmml" xref="S3.SS5.p4.2.m2.1.1.2">𝑟</ci><ci id="S3.SS5.p4.2.m2.1.1.3.cmml" xref="S3.SS5.p4.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p4.2.m2.1c">r_{j}</annotation></semantics></math> obtained from the RPN, and <math id="S3.SS5.p4.3.m3.2" class="ltx_Math" alttext="\textrm{Align}(r_{j},\textbf{t})" display="inline"><semantics id="S3.SS5.p4.3.m3.2a"><mrow id="S3.SS5.p4.3.m3.2.2" xref="S3.SS5.p4.3.m3.2.2.cmml"><mtext id="S3.SS5.p4.3.m3.2.2.3" xref="S3.SS5.p4.3.m3.2.2.3a.cmml">Align</mtext><mo lspace="0em" rspace="0em" id="S3.SS5.p4.3.m3.2.2.2" xref="S3.SS5.p4.3.m3.2.2.2.cmml">​</mo><mrow id="S3.SS5.p4.3.m3.2.2.1.1" xref="S3.SS5.p4.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS5.p4.3.m3.2.2.1.1.2" xref="S3.SS5.p4.3.m3.2.2.1.2.cmml">(</mo><msub id="S3.SS5.p4.3.m3.2.2.1.1.1" xref="S3.SS5.p4.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS5.p4.3.m3.2.2.1.1.1.2" xref="S3.SS5.p4.3.m3.2.2.1.1.1.2.cmml">r</mi><mi id="S3.SS5.p4.3.m3.2.2.1.1.1.3" xref="S3.SS5.p4.3.m3.2.2.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS5.p4.3.m3.2.2.1.1.3" xref="S3.SS5.p4.3.m3.2.2.1.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.SS5.p4.3.m3.1.1" xref="S3.SS5.p4.3.m3.1.1a.cmml">t</mtext><mo stretchy="false" id="S3.SS5.p4.3.m3.2.2.1.1.4" xref="S3.SS5.p4.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p4.3.m3.2b"><apply id="S3.SS5.p4.3.m3.2.2.cmml" xref="S3.SS5.p4.3.m3.2.2"><times id="S3.SS5.p4.3.m3.2.2.2.cmml" xref="S3.SS5.p4.3.m3.2.2.2"></times><ci id="S3.SS5.p4.3.m3.2.2.3a.cmml" xref="S3.SS5.p4.3.m3.2.2.3"><mtext id="S3.SS5.p4.3.m3.2.2.3.cmml" xref="S3.SS5.p4.3.m3.2.2.3">Align</mtext></ci><interval closure="open" id="S3.SS5.p4.3.m3.2.2.1.2.cmml" xref="S3.SS5.p4.3.m3.2.2.1.1"><apply id="S3.SS5.p4.3.m3.2.2.1.1.1.cmml" xref="S3.SS5.p4.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p4.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS5.p4.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS5.p4.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS5.p4.3.m3.2.2.1.1.1.2">𝑟</ci><ci id="S3.SS5.p4.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS5.p4.3.m3.2.2.1.1.1.3">𝑗</ci></apply><ci id="S3.SS5.p4.3.m3.1.1a.cmml" xref="S3.SS5.p4.3.m3.1.1"><mtext class="ltx_mathvariant_bold" id="S3.SS5.p4.3.m3.1.1.cmml" xref="S3.SS5.p4.3.m3.1.1">t</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p4.3.m3.2c">\textrm{Align}(r_{j},\textbf{t})</annotation></semantics></math> is the alignment score obtained from the Alignment Model. The final detections are selected by selecting the top-k proposals with the highest scores, where <math id="S3.SS5.p4.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS5.p4.4.m4.1a"><mi id="S3.SS5.p4.4.m4.1.1" xref="S3.SS5.p4.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p4.4.m4.1b"><ci id="S3.SS5.p4.4.m4.1.1.cmml" xref="S3.SS5.p4.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p4.4.m4.1c">k</annotation></semantics></math> is a hyperparameter that can be adjusted depending on the desired level of precision and recall.</p>
</div>
</section>
<section id="S3.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>End-to-End Training</h3>

<div id="S3.SS6.p1" class="ltx_para ltx_noindent">
<p id="S3.SS6.p1.1" class="ltx_p">The end-to-end training of the model involves training both the RPN and the Alignment Model jointly. Each training example consists of a single image, a set of bounding boxes for the objects in the image; a text query and an indicator of the alignment of the text for each object, indicating which objects are positives or negatives depending on the text query.</p>
</div>
<div id="S3.SS6.p2" class="ltx_para ltx_noindent">
<p id="S3.SS6.p2.1" class="ltx_p">To train the RPN we follow the process described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, where the classification and regression heads are trained to predict the confidence and the regression boxes of each object, respectively. The bounding boxes of the positive samples from the RPN training step are used to extract the parts of interests from the feature map and passed to the Proposal Encoder, while the text query from the given training example is encoded through the Text Encoder. Subsequently, the proposals and text encodings are passed on to the Alignment Model, which calculates scores that are used in the computation of the alignment loss. The loss is then backpropagated to both the inputs of the model, updating the weights of the model during the end-to-end training process.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments and Results</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">This section presents the experimental setup and results obtained in the evaluation of the proposed method. The experiment was conducted using simple images, with a single training session. The results show that the proposed method is effective in performing semantic image search and generating semantically relevant object proposals, offering promising performance compared to traditional object detection models. In the following sections, the generation of the training data, the experimental setup, the evaluation metrics, and the results are discussed in detail, providing insights into the effectiveness of the proposed method in solving the task of semantic image search within images.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Data</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">The data used for training in this implementation consisted of 5000 examples generated synthetically, where 4000 were used for training, 500 for validation and 500 for testing. Each example consists of a 512x512 RGB image, containing 10 to 20 randomly placed shapes, including circles, squares, and triangles, with randomly assigned colors including red, green, and blue on a black background. The objects in the images were annotated with bounding boxes, and a sentence in natural language was generated as the text query to describe the objects. Additionally, an annotation indicating which objects were aligned with the text was provided to serve as the ground truth. Figure <a href="#S4.F6" title="Figure 6 ‣ 4.1 Data ‣ 4 Experiments and Results ‣ End-to-end Semantic Object Detection with Cross-Modal Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows a few examples of the images used in training.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2302.05200/assets/images/dataset_examples.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="299" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Examples of images used in training.</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation details</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">For this implementation, we used a pre-trained MobileNetV2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> with its classification head removed, remaining only the CNNs with an output channels size of 1280. In the Region Proposal Network we defined a set of equally spaced anchors, alined with the feature map, with equal widths and heights of 64px. The maximum and minimum IoU thresholds which will defined the positive and negative samples are 0.6 and 0.1 respectively. The Proposal Encoder have the ROI pooling output size of (2,2), and the embedding dimension for the outputs is 64. The Text Encoder consists of a Transformer encoder with embedding dimension of 64, 2 heads and 1 layer. The Proposal-Text Alignment model have a hidden dimension of 64.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Training</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p">The training process was carried out over 10 epochs, with a batch size of 32. The optimization algorithm used was Stochastic Gradient Descent (SGD) with a learning rate of 1e-2, momentum of 0.9, and weight decay of 1e-5. In addition, a step-based learning rate scheduler with step size 3 and gamma 0.9 was employed to adjust the learning rate dynamically during the training process. This helped to mitigate the risk of overfitting and converge to a better optimal solution. The curves for the RPN loss and Align loss can be seen in Figure <a href="#S4.F7" title="Figure 7 ‣ 4.3 Training ‣ 4 Experiments and Results ‣ End-to-end Semantic Object Detection with Cross-Modal Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. It is observed that the RPN loss occurs rapidly converges, while the total loss is primarily impacted by the Align loss. This phenomenon can be attributed to the nature of the Align loss, which measures the semantic alignment between the object proposals and the text query, and hence has a more complex optimization problem than the RPN loss. The interplay between these two losses ultimately determines the overall performance of the proposed model.</p>
</div>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2302.05200/assets/images/train_val_loss.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="236" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Losses curves for training and validation.</figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Quantitative Results</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p">The experiments were divided into two groups. The first group comprised the evaluation of the results obtained from the ground truth and proposals bounding boxes of the RPN, i.e. all the predicted boxes, not considering the text query. The second group consisted of the evaluation of the results obtained from the filtered proposals and bounding boxes that were aligned with text. A threshold of 0.5 was defined to determine true and false positives and negatives. The metrics evaluated were the precision, recall, IoU and align accuracy. The tests were conducted on a test set of 500 examples. Table <a href="#S4.T1" title="Table 1 ‣ 4.4 Quantitative Results ‣ 4 Experiments and Results ‣ End-to-end Semantic Object Detection with Cross-Modal Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the obtained results.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Experiment Results</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">Metric</th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">All Proposals</th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Aligned Proposals</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Mean Precision</th>
<td id="S4.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">0.932</td>
<td id="S4.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.948</td>
</tr>
<tr id="S4.T1.1.3.2" class="ltx_tr">
<th id="S4.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Mean Recall</th>
<td id="S4.T1.1.3.2.2" class="ltx_td ltx_align_center">0.862</td>
<td id="S4.T1.1.3.2.3" class="ltx_td ltx_align_center">0.966</td>
</tr>
<tr id="S4.T1.1.4.3" class="ltx_tr">
<th id="S4.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Mean IoU</th>
<td id="S4.T1.1.4.3.2" class="ltx_td ltx_align_center">0.759</td>
<td id="S4.T1.1.4.3.3" class="ltx_td ltx_align_center">0.767</td>
</tr>
<tr id="S4.T1.1.5.4" class="ltx_tr">
<th id="S4.T1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Alignment Accuracy</th>
<td id="S4.T1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_bb">N/A</td>
<td id="S4.T1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_bb">0.996</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.1" class="ltx_p">For the mean precision metric, it was calculated as the ratio of true positive bounding boxes to the total number of positive bounding boxes predicted by the model. This metric reflects the ability of the model to accurately predict the positive bounding boxes in the image, taking into consideration both true positive and false positive predictions. The higher the mean precision, the more accurate the models’s predictions of positive bounding boxes are, which leads to better object detection performance. The results were 0.932 for all the proposals predicted by the models and 0.948 for the proposals aligned with the text query. It can be observed that the mean precision increased in the second set of experiments, this is because that by removing proposals that were not aligned with the text, the total number of positive predictions is reduced, thus reducing the chance of false positive predictions.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.p3.1" class="ltx_p">For the mean recall metric, it was calculated as the ratio of true positive bounding boxes to the total number of ground truth bounding boxes. This metric reflects the ability of the model to detect all the positive instances in the image, taking into consideration both true positive and false negative predictions. The higher the mean recall, the better the model is at detecting all positive instances in the image, resulting in improved object detection performance. The results were 0.862 for all the proposals predicted by the models and 0.966 for the proposals aligned with the text query. It can be observed that the mean recall increased in the second set of experiments, this is because by filtering out proposals that were not aligned with the text, the model has a better chance of detecting all positive instances, thus increasing the mean recall.</p>
</div>
<div id="S4.SS4.p4" class="ltx_para ltx_noindent">
<p id="S4.SS4.p4.1" class="ltx_p">The Intersection over Union (IoU) metric measures the overlap between the ground truth bounding box and the predicted bounding box. The IoU is calculated as the ratio of the area of overlap between the two boxes and the area of their union. A high IoU value indicates a high level of overlap and hence, a better prediction by the model. In the experiments, the mean IoU was calculated by taking the average of the IoUs of all the bounding boxes predicted by the RPN. The results were 0.759 for all the proposals predicted by the RPN and 0.767 for the proposals aligned with the text query. The results show that the mean IoU values for both sets of experiments were close, which indicates that filtering the proposals based on alignment with text did not have a significant impact on the mean IoU values. The histograms of the IoUs for both experiments sets are shown in Figure <a href="#S4.F8" title="Figure 8 ‣ 4.4 Quantitative Results ‣ 4 Experiments and Results ‣ End-to-end Semantic Object Detection with Cross-Modal Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> also supports this observation, with the majority of the IoUs falling in the range of 0.7 to 0.8.</p>
</div>
<figure id="S4.F8" class="ltx_figure"><img src="/html/2302.05200/assets/images/iou_hist.png" id="S4.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="419" height="303" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Histograms for the IoU for all proposals and filtered proposals based on text alignment.</figcaption>
</figure>
<div id="S4.SS4.p5" class="ltx_para ltx_noindent">
<p id="S4.SS4.p5.1" class="ltx_p">The results obtained indicate that the proposed method performs well in terms of precision, recall and IoU, with a higher mean precision and recall in the second group. The high align accuracy further confirms the effectiveness of the proposed alignment mechanism. These results demonstrate the potential of the proposed method for semantic image search tasks.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Qualitative Results</h3>

<div id="S4.SS5.p1" class="ltx_para ltx_noindent">
<p id="S4.SS5.p1.1" class="ltx_p">The qualitative results of the experiments revealed the effectiveness of both the RPN and the text-filtered proposals in providing accurate bounding boxes on the objects that matched the text query. To demonstrate the performance of the models, multiple examples were displayed, with each example comprising of an image and its corresponding text query. The images in the examples contained bounding boxes that were superimposed on the objects that matched the text query. These bounding boxes were generated by the RPN and filtered accordingly to the Proposal-Text alignment. Several examples were presented to illustrate the performance of the models, with each image accompanied by a corresponding text query. The bounding boxes were drawn on the image only if the score was higher than 0.5, ensuring that the predictions were confident enough to be considered true positive detections. The results are shown in Figure <a href="#S4.F9" title="Figure 9 ‣ 4.5 Qualitative Results ‣ 4 Experiments and Results ‣ End-to-end Semantic Object Detection with Cross-Modal Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<figure id="S4.F9" class="ltx_figure"><img src="/html/2302.05200/assets/images/output_examples.png" id="S4.F9.g1" class="ltx_graphics ltx_centering ltx_img_square" width="479" height="516" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Histograms for the IoU for all proposals and filtered proposals based on text alignment.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In conclusion, this paper presented a novel approach to semantic image search, which is an important task in computer vision. The proposed model leverages a single feature extractor, a pre-trained Convolutional Neural Network, and a transformer encoder to encode the text query and perform proposal-text alignment using contrastive learning. The end-to-end training process of the model allowed for an efficient and effective solution for semantic image search. The qualitative results were consistent with the quantitative results and demonstrated the effectiveness of the text-filtered proposals in providing accurate bounding boxes on the objects that matched the text query. The results showed that the proposed method produced promising results when trained with simple images, demonstrating its potential for further improvement and refinement. Overall, the proposed method provides a step forward in the field of semantic image search and highlights the importance of considering semantic alignment in object detection models.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p">In future works, we aim to evaluate the proposed method on a larger and more diverse dataset to further test its performance and robustness. Additionally, we plan to explore the use of pre-trained text encoders such as BERT, which has shown to be effective in various NLP tasks. The integration of these pre-trained text encoders may further improve the semantic alignment between the image and text, leading to better object detection performance. Furthermore, we plan to investigate different methods for proposal-text alignment, including pre-trained models such as CLIP, to further optimize the performance of the model. By exploring these avenues, we hope to provide a more robust solution for semantic image search and advance the field of computer vision.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Robert Desimone and John Duncan.

</span>
<span class="ltx_bibblock">Neural mechanisms of selective visual attention.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Annual review of neuroscience</span>, 18(1):193–222, 1995.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Zhengxia Zou, Keyan Chen, Zhenwei Shi, Yuhong Guo, and Jieping Ye.

</span>
<span class="ltx_bibblock">Object detection in 20 years: A survey.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE</span>, 2023.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Di Qi, Lin Su, Jia Song, Edward Cui, Taroon Bharti, and Arun Sacheti.

</span>
<span class="ltx_bibblock">Imagebert: Cross-modal pre-training with large-scale weak-supervised
image-text data.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2001.07966</span>, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language
supervision.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">International conference on machine learning</span>, pages
8748–8763. PMLR, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Zewen Li, Fan Liu, Wenjie Yang, Shouheng Peng, and Jun Zhou.

</span>
<span class="ltx_bibblock">A survey of convolutional neural networks: analysis, applications,
and prospects.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">IEEE transactions on neural networks and learning systems</span>,
2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 30, 2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Ashish Jaiswal, Ashwin Ramesh Babu, Mohammad Zaki Zadeh, Debapriya Banerjee,
and Fillia Makedon.

</span>
<span class="ltx_bibblock">A survey on contrastive self-supervised learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Technologies</span>, 9(1):2, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.

</span>
<span class="ltx_bibblock">Faster r-cnn: Towards real-time object detection with region proposal
networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 28, 2015.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
John Canny.

</span>
<span class="ltx_bibblock">A computational approach to edge detection.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on pattern analysis and machine intelligence</span>,
(6):679–698, 1986.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
John Illingworth and Josef Kittler.

</span>
<span class="ltx_bibblock">A survey of the hough transform.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Computer vision, graphics, and image processing</span>, 44(1):87–116,
1988.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Paul Viola and Michael Jones.

</span>
<span class="ltx_bibblock">Rapid object detection using a boosted cascade of simple features.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2001 IEEE computer society conference on
computer vision and pattern recognition. CVPR 2001</span>, volume 1, pages I–I.
Ieee, 2001.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Pedro F Felzenszwalb, Ross B Girshick, David McAllester, and Deva Ramanan.

</span>
<span class="ltx_bibblock">Object detection with discriminatively trained part-based models.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">IEEE transactions on pattern analysis and machine intelligence</span>,
32(9):1627–1645, 2009.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Navneet Dalal and Bill Triggs.

</span>
<span class="ltx_bibblock">Histograms of oriented gradients for human detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">2005 IEEE computer society conference on computer vision and
pattern recognition (CVPR’05)</span>, volume 1, pages 886–893. Ieee, 2005.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hinton.

</span>
<span class="ltx_bibblock">Imagenet classification with deep convolutional neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Communications of the ACM</span>, 60(6):84–90, 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Ross Girshick, Jeff Donahue, Trevor Darrell, and Jitendra Malik.

</span>
<span class="ltx_bibblock">Rich feature hierarchies for accurate object detection and semantic
segmentation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, pages 580–587, 2014.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Ross Girshick, Jeff Donahue, Trevor Darrell, and Jitendra Malik.

</span>
<span class="ltx_bibblock">Region-based convolutional networks for accurate object detection and
segmentation.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">IEEE transactions on pattern analysis and machine intelligence</span>,
38(1):142–158, 2015.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jasper RR Uijlings, Koen EA Van De Sande, Theo Gevers, and Arnold WM Smeulders.

</span>
<span class="ltx_bibblock">Selective search for object recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">International journal of computer vision</span>, 104:154–171, 2013.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Spatial pyramid pooling in deep convolutional networks for visual
recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">IEEE transactions on pattern analysis and machine intelligence</span>,
37(9):1904–1916, 2015.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Ross Girshick.

</span>
<span class="ltx_bibblock">Fast r-cnn.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</span>, pages 1440–1448, 2015.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Joseph Redmon, Santosh Divvala, Ross Girshick, and Ali Farhadi.

</span>
<span class="ltx_bibblock">You only look once: Unified, real-time object detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, pages 779–788, 2016.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Chien-Yao Wang, Alexey Bochkovskiy, and Hong-Yuan Mark Liao.

</span>
<span class="ltx_bibblock">Yolov7: Trainable bag-of-freebies sets new state-of-the-art for
real-time object detectors.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2207.02696</span>, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Wei Liu, Dragomir Anguelov, Dumitru Erhan, Christian Szegedy, Scott Reed,
Cheng-Yang Fu, and Alexander C Berg.

</span>
<span class="ltx_bibblock">Ssd: Single shot multibox detector.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Computer Vision–ECCV 2016: 14th European Conference,
Amsterdam, The Netherlands, October 11–14, 2016, Proceedings, Part I 14</span>,
pages 21–37. Springer, 2016.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Dollár.

</span>
<span class="ltx_bibblock">Focal loss for dense object detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</span>, pages 2980–2988, 2017.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1810.04805</span>, 2018.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Chao Jia, Yinfei Yang, Ye Xia, Yi-Ting Chen, Zarana Parekh, Hieu Pham, Quoc Le,
Yun-Hsuan Sung, Zhen Li, and Tom Duerig.

</span>
<span class="ltx_bibblock">Scaling up visual and vision-language representation learning with
noisy text supervision.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
4904–4916. PMLR, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Mark Sandler, Andrew Howard, Menglong Zhu, Andrey Zhmoginov, and Liang-Chieh
Chen.

</span>
<span class="ltx_bibblock">Mobilenetv2: Inverted residuals and linear bottlenecks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, pages 4510–4520, 2018.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2302.05199" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2302.05200" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2302.05200">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2302.05200" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2302.05201" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 01:51:24 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
