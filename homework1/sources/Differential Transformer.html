<!DOCTYPE html><html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Differential Transformer</title>
<!--Generated on Mon Oct  7 17:58:43 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<base href="https://arxiv.org/html/2410.05258v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.05258v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.05258v1/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.05258v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.05258v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S1" title="In Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S2" title="In Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Differential Transformer</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S2.SS1" title="In 2 Differential Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Differential Attention</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S2.SS1.SSS0.Px1" title="In 2.1 Differential Attention ‣ 2 Differential Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_title">Multi-Head Differential Attention</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S2.SS2" title="In 2 Differential Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Overall Architecture</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3" title="In Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS1" title="In 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Language Modeling Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS2" title="In 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Scalability Compared with Transformer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS3" title="In 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Long-Context Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS4" title="In 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Key Information Retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS5" title="In 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>In-Context Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS6" title="In 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Contextual Hallucination Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS7" title="In 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.7 </span>Activation Outliers Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS8" title="In 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.8 </span>Ablation Studies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S4" title="In Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A1" title="In Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Implementation of Differential Attention</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A2" title="In Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Language Modeling Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A3" title="In Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Hyperparameters for <span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.1</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A4" title="In Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Hyperparameters for <span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.2</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A5" title="In Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Robustness of In-Context Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A6" title="In Differential Transformer"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Gradient Flow of <span class="ltx_text ltx_font_smallcaps">Diff</span> Transformer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div class="package-alerts ltx_document" role="status" aria-label="Conversion errors have been found">
      <button aria-label="Dismiss alert">
          <span aria-hidden="true"><svg role="presentation" width="20" height="20" viewBox="0 0 44 44" aria-hidden="true" focusable="false">
          <path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
          <path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
          </svg></span>
      </button>
      <p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
          <ul arial-label="Unsupported packages used in this paper">
              <li>failed: arydshln</li><li>failed: capt-of</li><li>failed: scalerel</li>
          </ul>
      <p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
    </div><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: arXiv.org perpetual non-exclusive license</a><div id="watermark-tr">arXiv:2410.05258v1 [cs.CL] 07 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Differential Transformer</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Tianzhu Ye<math alttext="~{}~{}^{{\dagger}{\ddagger}}" class="ltx_Math" display="inline" id="id2.2.m1.1"><semantics id="id2.2.m1.1a"><msup id="id2.2.m1.1.1" xref="id2.2.m1.1.1.cmml"><mi id="id2.2.m1.1.1a" xref="id2.2.m1.1.1.cmml"></mi><mrow id="id2.2.m1.1.1.1" xref="id2.2.m1.1.1.1.cmml"><mi id="id2.2.m1.1.1.1.2" xref="id2.2.m1.1.1.1.2.cmml"></mi><mo id="id2.2.m1.1.1.1.1" lspace="0.222em" rspace="0em" xref="id2.2.m1.1.1.1.1.cmml">†</mo><mo id="id2.2.m1.1.1.1.3" lspace="0em" xref="id2.2.m1.1.1.1.3.cmml">‡</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id2.2.m1.1b"><apply id="id2.2.m1.1.1.cmml" xref="id2.2.m1.1.1"><apply id="id2.2.m1.1.1.1.cmml" xref="id2.2.m1.1.1.1"><ci id="id2.2.m1.1.1.1.1.cmml" xref="id2.2.m1.1.1.1.1">†</ci><csymbol cd="latexml" id="id2.2.m1.1.1.1.2.cmml" xref="id2.2.m1.1.1.1.2">absent</csymbol><ci id="id2.2.m1.1.1.1.3.cmml" xref="id2.2.m1.1.1.1.3">‡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m1.1c">~{}~{}^{{\dagger}{\ddagger}}</annotation><annotation encoding="application/x-llamapun" id="id2.2.m1.1d">start_FLOATSUPERSCRIPT † ‡ end_FLOATSUPERSCRIPT</annotation></semantics></math>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Li Dong<span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span><math alttext="~{}~{}^{{\dagger}}" class="ltx_Math" display="inline" id="id3.3.m2.1"><semantics id="id3.3.m2.1a"><msup id="id3.3.m2.1.1" xref="id3.3.m2.1.1.cmml"><mi id="id3.3.m2.1.1a" xref="id3.3.m2.1.1.cmml"></mi><mo id="id3.3.m2.1.1.1" xref="id3.3.m2.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="id3.3.m2.1b"><apply id="id3.3.m2.1.1.cmml" xref="id3.3.m2.1.1"><ci id="id3.3.m2.1.1.1.cmml" xref="id3.3.m2.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m2.1c">~{}~{}^{{\dagger}}</annotation><annotation encoding="application/x-llamapun" id="id3.3.m2.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yuqing Xia<span class="ltx_note ltx_role_footnotemark" id="footnotex2"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span><math alttext="~{}~{}^{{\dagger}}" class="ltx_Math" display="inline" id="id4.4.m3.1"><semantics id="id4.4.m3.1a"><msup id="id4.4.m3.1.1" xref="id4.4.m3.1.1.cmml"><mi id="id4.4.m3.1.1a" xref="id4.4.m3.1.1.cmml"></mi><mo id="id4.4.m3.1.1.1" xref="id4.4.m3.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="id4.4.m3.1b"><apply id="id4.4.m3.1.1.cmml" xref="id4.4.m3.1.1"><ci id="id4.4.m3.1.1.1.cmml" xref="id4.4.m3.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.4.m3.1c">~{}~{}^{{\dagger}}</annotation><annotation encoding="application/x-llamapun" id="id4.4.m3.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yutao Sun<span class="ltx_note ltx_role_footnotemark" id="footnotex3"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span><math alttext="~{}~{}^{{\dagger}{\ddagger}}" class="ltx_Math" display="inline" id="id5.5.m4.1"><semantics id="id5.5.m4.1a"><msup id="id5.5.m4.1.1" xref="id5.5.m4.1.1.cmml"><mi id="id5.5.m4.1.1a" xref="id5.5.m4.1.1.cmml"></mi><mrow id="id5.5.m4.1.1.1" xref="id5.5.m4.1.1.1.cmml"><mi id="id5.5.m4.1.1.1.2" xref="id5.5.m4.1.1.1.2.cmml"></mi><mo id="id5.5.m4.1.1.1.1" lspace="0.222em" rspace="0em" xref="id5.5.m4.1.1.1.1.cmml">†</mo><mo id="id5.5.m4.1.1.1.3" lspace="0em" xref="id5.5.m4.1.1.1.3.cmml">‡</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id5.5.m4.1b"><apply id="id5.5.m4.1.1.cmml" xref="id5.5.m4.1.1"><apply id="id5.5.m4.1.1.1.cmml" xref="id5.5.m4.1.1.1"><ci id="id5.5.m4.1.1.1.1.cmml" xref="id5.5.m4.1.1.1.1">†</ci><csymbol cd="latexml" id="id5.5.m4.1.1.1.2.cmml" xref="id5.5.m4.1.1.1.2">absent</csymbol><ci id="id5.5.m4.1.1.1.3.cmml" xref="id5.5.m4.1.1.1.3">‡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.5.m4.1c">~{}~{}^{{\dagger}{\ddagger}}</annotation><annotation encoding="application/x-llamapun" id="id5.5.m4.1d">start_FLOATSUPERSCRIPT † ‡ end_FLOATSUPERSCRIPT</annotation></semantics></math>
<br class="ltx_break">&nbsp;<span class="ltx_text ltx_font_bold" id="id11.11.6">Yi Zhu<sup class="ltx_sup" id="id11.11.6.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id11.11.6.1.1">†</span></sup>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gao Huang<sup class="ltx_sup" id="id11.11.6.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id11.11.6.2.1">‡</span></sup>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Furu Wei<sup class="ltx_sup" id="id11.11.6.3"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id11.11.6.3.1">†</span></sup><sup class="ltx_sup" id="id11.11.6.4"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id11.11.6.4.1">⋄</span></sup>
<br class="ltx_break">&nbsp;<sup class="ltx_sup" id="id11.11.6.5"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id11.11.6.5.1">†</span></sup> Microsoft Research &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;<sup class="ltx_sup" id="id11.11.6.6"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id11.11.6.6.1">‡</span></sup> Tsinghua University 
<br class="ltx_break">&nbsp;<a class="ltx_ref ltx_href" href="https://aka.ms/GeneralAI" title="">https://aka.ms/GeneralAI</a>
</span>
</span><span class="ltx_author_notes">&nbsp;Equal contribution. <math alttext="\diamond" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">⋄</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><ci id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">⋄</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\diamond</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">⋄</annotation></semantics></math> Corresponding author.</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id12.1">Transformer tends to overallocate attention to irrelevant context. In this work, we introduce <span class="ltx_text ltx_font_smallcaps" id="id12.1.1">Diff</span> Transformer, which amplifies attention to the relevant context while canceling noise. Specifically, the differential attention mechanism calculates attention scores as the difference between two separate <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="id12.1.m1.1"><semantics id="id12.1.m1.1a"><mi id="id12.1.m1.1.1" xref="id12.1.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="id12.1.m1.1b"><ci id="id12.1.m1.1.1.cmml" xref="id12.1.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="id12.1.m1.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="id12.1.m1.1d">roman_softmax</annotation></semantics></math> attention maps. The subtraction cancels noise, promoting the emergence of sparse attention patterns. Experimental results on language modeling show that <span class="ltx_text ltx_font_smallcaps" id="id12.1.2">Diff</span> Transformer outperforms Transformer in various settings of scaling up model size and training tokens. More intriguingly, it offers notable advantages in practical applications, such as long-context modeling, key information retrieval, hallucination mitigation, in-context learning, and reduction of activation outliers. By being less distracted by irrelevant context, <span class="ltx_text ltx_font_smallcaps" id="id12.1.3">Diff</span> Transformer can mitigate hallucination in question answering and text summarization. For in-context learning, <span class="ltx_text ltx_font_smallcaps" id="id12.1.4">Diff</span> Transformer not only enhances accuracy but is also more robust to order permutation, which was considered as a chronic robustness issue. The results position <span class="ltx_text ltx_font_smallcaps" id="id12.1.5">Diff</span> Transformer as a highly effective and promising architecture to advance large language models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Transformer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib41" title="">41</a>]</cite> has garnered significant research interest in recent years, with the decoder-only Transformer emerging as the de facto standard for large language models (LLMs). At the heart of Transformer is the attention mechanism, which employs the <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><mi id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><ci id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">roman_softmax</annotation></semantics></math> function to weigh the importance of various tokens in a sequence.
However, recent studies&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib23" title="">23</a>]</cite> show that LLMs face challenges in accurately retrieving key information from context.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">As illustrated on the left side of <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S1.F1" title="In 1 Introduction ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a>, we visualize the normalized attention scores assigned to different parts of the context by a Transformer.
The task is to retrieve an answer embedded in the middle of a pile of documents.
The visualization reveals that Transformer tends to allocate only a small proportion of attention scores to the correct answer, while disproportionately focusing on irrelevant context.
The experiments in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3" title="3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3</span></a> further substantiate that Transformers struggle with such capabilities.
The issue arises from non-negligible attention scores assigned to irrelevant context, which ultimately drowns out the correct answer.
We term these extraneous scores as <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">attention noise</span>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="260" id="S1.F1.g1" src="https://arxiv.org/html/2410.05258v1/x1.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Transformer often over-attends to irrelevant context (i.e., attention noise). <span class="ltx_text ltx_font_smallcaps" id="S1.F1.2.1">Diff</span> Transformer amplifies attention to answer spans and cancels noise, enhancing the capability of context modeling.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this paper, we introduce Differential Transformer (a.k.a. <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.1">Diff</span> Transformer), a foundation architecture for large language models.
The differential attention mechanism is proposed to cancel attention noise with differential denoising.
Specifically, we partition the query and key vectors into two groups and compute two separate <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">roman_softmax</annotation></semantics></math> attention maps. Then the result of subtracting these two maps is regarded as attention scores.
The differential attention mechanism eliminates attention noise, encouraging models to focus on critical information.
The approach is analogous to noise-canceling headphones and differential amplifiers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib19" title="">19</a>]</cite> in electrical engineering, where the difference between two signals cancels out common-mode noise.
In the middle of <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S1.F1" title="In 1 Introduction ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a>, we also present the normalized distribution of attention scores for <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.2">Diff</span> Transformer.
We observe that <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.3">Diff</span> Transformer assigns significantly higher scores to the correct answer and much lower scores to irrelevant context compared to Transformer.
The right side of <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S1.F1" title="In 1 Introduction ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a> shows that the proposed method achieves notable improvements in retrieval capability.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">We conduct extensive experiments on language modeling.
We scale up <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.1">Diff</span> Transformer in terms of parameter count, training tokens, and context length.
The scaling curves indicate that <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.2">Diff</span> Transformer requires only about 65% of model size or training tokens needed by Transformer to achieve comparable language modeling performance.
Moreover, <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.3">Diff</span> Transformer outperforms Transformer in various downstream tasks.
The long-sequence evaluation also shows that <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.4">Diff</span> Transformer is highly effective in utilizing the increasing context.
In addition, the experimental results demonstrate that <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.5">Diff</span> Transformer has intriguing advantages for large language models.
For example, the proposed method substantially outperforms Transformer in key information retrieval, hallucination mitigation, and in-context learning.
<span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.6">Diff</span> Transformer also reduces outliers in model activations, which provides new opportunities for quantization.
The findings establish <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.7">Diff</span> Transformer as an effective and distinctive foundation architecture for large language models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Differential Transformer</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.7">We propose Differential Transformer (a.k.a. <span class="ltx_text ltx_font_smallcaps" id="S2.p1.7.1">Diff</span> Transformer) as a foundation architecture for sequence modeling, such as large language models (LLMs).
We take a decoder-only model as an example to describe the architecture.
The model is stacked with <math alttext="L" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_L</annotation></semantics></math> <span class="ltx_text ltx_font_smallcaps" id="S2.p1.7.2">Diff</span> Transformer layers.
Given an input sequence <math alttext="x=x_{1}\cdots x_{N}" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mrow id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><mi id="S2.p1.2.m2.1.1.2" xref="S2.p1.2.m2.1.1.2.cmml">x</mi><mo id="S2.p1.2.m2.1.1.1" xref="S2.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S2.p1.2.m2.1.1.3" xref="S2.p1.2.m2.1.1.3.cmml"><msub id="S2.p1.2.m2.1.1.3.2" xref="S2.p1.2.m2.1.1.3.2.cmml"><mi id="S2.p1.2.m2.1.1.3.2.2" xref="S2.p1.2.m2.1.1.3.2.2.cmml">x</mi><mn id="S2.p1.2.m2.1.1.3.2.3" xref="S2.p1.2.m2.1.1.3.2.3.cmml">1</mn></msub><mo id="S2.p1.2.m2.1.1.3.1" xref="S2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.p1.2.m2.1.1.3.3" mathvariant="normal" xref="S2.p1.2.m2.1.1.3.3.cmml">⋯</mi><mo id="S2.p1.2.m2.1.1.3.1a" xref="S2.p1.2.m2.1.1.3.1.cmml">⁢</mo><msub id="S2.p1.2.m2.1.1.3.4" xref="S2.p1.2.m2.1.1.3.4.cmml"><mi id="S2.p1.2.m2.1.1.3.4.2" xref="S2.p1.2.m2.1.1.3.4.2.cmml">x</mi><mi id="S2.p1.2.m2.1.1.3.4.3" xref="S2.p1.2.m2.1.1.3.4.3.cmml">N</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><eq id="S2.p1.2.m2.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1"></eq><ci id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1.2">𝑥</ci><apply id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3"><times id="S2.p1.2.m2.1.1.3.1.cmml" xref="S2.p1.2.m2.1.1.3.1"></times><apply id="S2.p1.2.m2.1.1.3.2.cmml" xref="S2.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.3.2.1.cmml" xref="S2.p1.2.m2.1.1.3.2">subscript</csymbol><ci id="S2.p1.2.m2.1.1.3.2.2.cmml" xref="S2.p1.2.m2.1.1.3.2.2">𝑥</ci><cn id="S2.p1.2.m2.1.1.3.2.3.cmml" type="integer" xref="S2.p1.2.m2.1.1.3.2.3">1</cn></apply><ci id="S2.p1.2.m2.1.1.3.3.cmml" xref="S2.p1.2.m2.1.1.3.3">⋯</ci><apply id="S2.p1.2.m2.1.1.3.4.cmml" xref="S2.p1.2.m2.1.1.3.4"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.3.4.1.cmml" xref="S2.p1.2.m2.1.1.3.4">subscript</csymbol><ci id="S2.p1.2.m2.1.1.3.4.2.cmml" xref="S2.p1.2.m2.1.1.3.4.2">𝑥</ci><ci id="S2.p1.2.m2.1.1.3.4.3.cmml" xref="S2.p1.2.m2.1.1.3.4.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">x=x_{1}\cdots x_{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_x = italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋯ italic_x start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math>, we pack the input embeddings into <math alttext="X^{0}=[{\bm{x}}_{1},\cdots,{\bm{x}}_{N}]\in\mathbb{R}^{N\times d_{\text{model}}}" class="ltx_Math" display="inline" id="S2.p1.3.m3.3"><semantics id="S2.p1.3.m3.3a"><mrow id="S2.p1.3.m3.3.3" xref="S2.p1.3.m3.3.3.cmml"><msup id="S2.p1.3.m3.3.3.4" xref="S2.p1.3.m3.3.3.4.cmml"><mi id="S2.p1.3.m3.3.3.4.2" xref="S2.p1.3.m3.3.3.4.2.cmml">X</mi><mn id="S2.p1.3.m3.3.3.4.3" xref="S2.p1.3.m3.3.3.4.3.cmml">0</mn></msup><mo id="S2.p1.3.m3.3.3.5" xref="S2.p1.3.m3.3.3.5.cmml">=</mo><mrow id="S2.p1.3.m3.3.3.2.2" xref="S2.p1.3.m3.3.3.2.3.cmml"><mo id="S2.p1.3.m3.3.3.2.2.3" stretchy="false" xref="S2.p1.3.m3.3.3.2.3.cmml">[</mo><msub id="S2.p1.3.m3.2.2.1.1.1" xref="S2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S2.p1.3.m3.2.2.1.1.1.2" xref="S2.p1.3.m3.2.2.1.1.1.2.cmml">𝒙</mi><mn id="S2.p1.3.m3.2.2.1.1.1.3" xref="S2.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.3.m3.3.3.2.2.4" xref="S2.p1.3.m3.3.3.2.3.cmml">,</mo><mi id="S2.p1.3.m3.1.1" mathvariant="normal" xref="S2.p1.3.m3.1.1.cmml">⋯</mi><mo id="S2.p1.3.m3.3.3.2.2.5" xref="S2.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S2.p1.3.m3.3.3.2.2.2" xref="S2.p1.3.m3.3.3.2.2.2.cmml"><mi id="S2.p1.3.m3.3.3.2.2.2.2" xref="S2.p1.3.m3.3.3.2.2.2.2.cmml">𝒙</mi><mi id="S2.p1.3.m3.3.3.2.2.2.3" xref="S2.p1.3.m3.3.3.2.2.2.3.cmml">N</mi></msub><mo id="S2.p1.3.m3.3.3.2.2.6" stretchy="false" xref="S2.p1.3.m3.3.3.2.3.cmml">]</mo></mrow><mo id="S2.p1.3.m3.3.3.6" xref="S2.p1.3.m3.3.3.6.cmml">∈</mo><msup id="S2.p1.3.m3.3.3.7" xref="S2.p1.3.m3.3.3.7.cmml"><mi id="S2.p1.3.m3.3.3.7.2" xref="S2.p1.3.m3.3.3.7.2.cmml">ℝ</mi><mrow id="S2.p1.3.m3.3.3.7.3" xref="S2.p1.3.m3.3.3.7.3.cmml"><mi id="S2.p1.3.m3.3.3.7.3.2" xref="S2.p1.3.m3.3.3.7.3.2.cmml">N</mi><mo id="S2.p1.3.m3.3.3.7.3.1" lspace="0.222em" rspace="0.222em" xref="S2.p1.3.m3.3.3.7.3.1.cmml">×</mo><msub id="S2.p1.3.m3.3.3.7.3.3" xref="S2.p1.3.m3.3.3.7.3.3.cmml"><mi id="S2.p1.3.m3.3.3.7.3.3.2" xref="S2.p1.3.m3.3.3.7.3.3.2.cmml">d</mi><mtext id="S2.p1.3.m3.3.3.7.3.3.3" xref="S2.p1.3.m3.3.3.7.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.3b"><apply id="S2.p1.3.m3.3.3.cmml" xref="S2.p1.3.m3.3.3"><and id="S2.p1.3.m3.3.3a.cmml" xref="S2.p1.3.m3.3.3"></and><apply id="S2.p1.3.m3.3.3b.cmml" xref="S2.p1.3.m3.3.3"><eq id="S2.p1.3.m3.3.3.5.cmml" xref="S2.p1.3.m3.3.3.5"></eq><apply id="S2.p1.3.m3.3.3.4.cmml" xref="S2.p1.3.m3.3.3.4"><csymbol cd="ambiguous" id="S2.p1.3.m3.3.3.4.1.cmml" xref="S2.p1.3.m3.3.3.4">superscript</csymbol><ci id="S2.p1.3.m3.3.3.4.2.cmml" xref="S2.p1.3.m3.3.3.4.2">𝑋</ci><cn id="S2.p1.3.m3.3.3.4.3.cmml" type="integer" xref="S2.p1.3.m3.3.3.4.3">0</cn></apply><list id="S2.p1.3.m3.3.3.2.3.cmml" xref="S2.p1.3.m3.3.3.2.2"><apply id="S2.p1.3.m3.2.2.1.1.1.cmml" xref="S2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S2.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S2.p1.3.m3.2.2.1.1.1.2">𝒙</ci><cn id="S2.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S2.p1.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">⋯</ci><apply id="S2.p1.3.m3.3.3.2.2.2.cmml" xref="S2.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.3.3.2.2.2.1.cmml" xref="S2.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S2.p1.3.m3.3.3.2.2.2.2.cmml" xref="S2.p1.3.m3.3.3.2.2.2.2">𝒙</ci><ci id="S2.p1.3.m3.3.3.2.2.2.3.cmml" xref="S2.p1.3.m3.3.3.2.2.2.3">𝑁</ci></apply></list></apply><apply id="S2.p1.3.m3.3.3c.cmml" xref="S2.p1.3.m3.3.3"><in id="S2.p1.3.m3.3.3.6.cmml" xref="S2.p1.3.m3.3.3.6"></in><share href="https://arxiv.org/html/2410.05258v1#S2.p1.3.m3.3.3.2.cmml" id="S2.p1.3.m3.3.3d.cmml" xref="S2.p1.3.m3.3.3"></share><apply id="S2.p1.3.m3.3.3.7.cmml" xref="S2.p1.3.m3.3.3.7"><csymbol cd="ambiguous" id="S2.p1.3.m3.3.3.7.1.cmml" xref="S2.p1.3.m3.3.3.7">superscript</csymbol><ci id="S2.p1.3.m3.3.3.7.2.cmml" xref="S2.p1.3.m3.3.3.7.2">ℝ</ci><apply id="S2.p1.3.m3.3.3.7.3.cmml" xref="S2.p1.3.m3.3.3.7.3"><times id="S2.p1.3.m3.3.3.7.3.1.cmml" xref="S2.p1.3.m3.3.3.7.3.1"></times><ci id="S2.p1.3.m3.3.3.7.3.2.cmml" xref="S2.p1.3.m3.3.3.7.3.2">𝑁</ci><apply id="S2.p1.3.m3.3.3.7.3.3.cmml" xref="S2.p1.3.m3.3.3.7.3.3"><csymbol cd="ambiguous" id="S2.p1.3.m3.3.3.7.3.3.1.cmml" xref="S2.p1.3.m3.3.3.7.3.3">subscript</csymbol><ci id="S2.p1.3.m3.3.3.7.3.3.2.cmml" xref="S2.p1.3.m3.3.3.7.3.3.2">𝑑</ci><ci id="S2.p1.3.m3.3.3.7.3.3.3a.cmml" xref="S2.p1.3.m3.3.3.7.3.3.3"><mtext id="S2.p1.3.m3.3.3.7.3.3.3.cmml" mathsize="50%" xref="S2.p1.3.m3.3.3.7.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.3c">X^{0}=[{\bm{x}}_{1},\cdots,{\bm{x}}_{N}]\in\mathbb{R}^{N\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.3d">italic_X start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT = [ bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , bold_italic_x start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="d_{\text{model}}" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><msub id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><mi id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml">d</mi><mtext id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3a.cmml">model</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2">𝑑</ci><ci id="S2.p1.4.m4.1.1.3a.cmml" xref="S2.p1.4.m4.1.1.3"><mtext id="S2.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S2.p1.4.m4.1.1.3">model</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">d_{\text{model}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT</annotation></semantics></math> represents the hidden dimension of the model.
The input is further contextualized to obtain the output <math alttext="X^{L}" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><msup id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml"><mi id="S2.p1.5.m5.1.1.2" xref="S2.p1.5.m5.1.1.2.cmml">X</mi><mi id="S2.p1.5.m5.1.1.3" xref="S2.p1.5.m5.1.1.3.cmml">L</mi></msup><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.cmml" xref="S2.p1.5.m5.1.1">superscript</csymbol><ci id="S2.p1.5.m5.1.1.2.cmml" xref="S2.p1.5.m5.1.1.2">𝑋</ci><ci id="S2.p1.5.m5.1.1.3.cmml" xref="S2.p1.5.m5.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">X^{L}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">italic_X start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>, i.e., <math alttext="X^{l}=\operatorname{Decoder}(X^{l-1}),\ l\in[1,L]" class="ltx_Math" display="inline" id="S2.p1.6.m6.5"><semantics id="S2.p1.6.m6.5a"><mrow id="S2.p1.6.m6.5.5.2" xref="S2.p1.6.m6.5.5.3.cmml"><mrow id="S2.p1.6.m6.4.4.1.1" xref="S2.p1.6.m6.4.4.1.1.cmml"><msup id="S2.p1.6.m6.4.4.1.1.3" xref="S2.p1.6.m6.4.4.1.1.3.cmml"><mi id="S2.p1.6.m6.4.4.1.1.3.2" xref="S2.p1.6.m6.4.4.1.1.3.2.cmml">X</mi><mi id="S2.p1.6.m6.4.4.1.1.3.3" xref="S2.p1.6.m6.4.4.1.1.3.3.cmml">l</mi></msup><mo id="S2.p1.6.m6.4.4.1.1.2" xref="S2.p1.6.m6.4.4.1.1.2.cmml">=</mo><mrow id="S2.p1.6.m6.4.4.1.1.1.1" xref="S2.p1.6.m6.4.4.1.1.1.2.cmml"><mi id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml">Decoder</mi><mo id="S2.p1.6.m6.4.4.1.1.1.1a" xref="S2.p1.6.m6.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S2.p1.6.m6.4.4.1.1.1.1.1" xref="S2.p1.6.m6.4.4.1.1.1.2.cmml"><mo id="S2.p1.6.m6.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.p1.6.m6.4.4.1.1.1.2.cmml">(</mo><msup id="S2.p1.6.m6.4.4.1.1.1.1.1.1" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.cmml"><mi id="S2.p1.6.m6.4.4.1.1.1.1.1.1.2" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.2.cmml">X</mi><mrow id="S2.p1.6.m6.4.4.1.1.1.1.1.1.3" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.cmml"><mi id="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.2" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.1" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.3" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S2.p1.6.m6.4.4.1.1.1.1.1.3" stretchy="false" xref="S2.p1.6.m6.4.4.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.p1.6.m6.5.5.2.3" rspace="0.667em" xref="S2.p1.6.m6.5.5.3a.cmml">,</mo><mrow id="S2.p1.6.m6.5.5.2.2" xref="S2.p1.6.m6.5.5.2.2.cmml"><mi id="S2.p1.6.m6.5.5.2.2.2" xref="S2.p1.6.m6.5.5.2.2.2.cmml">l</mi><mo id="S2.p1.6.m6.5.5.2.2.1" xref="S2.p1.6.m6.5.5.2.2.1.cmml">∈</mo><mrow id="S2.p1.6.m6.5.5.2.2.3.2" xref="S2.p1.6.m6.5.5.2.2.3.1.cmml"><mo id="S2.p1.6.m6.5.5.2.2.3.2.1" stretchy="false" xref="S2.p1.6.m6.5.5.2.2.3.1.cmml">[</mo><mn id="S2.p1.6.m6.2.2" xref="S2.p1.6.m6.2.2.cmml">1</mn><mo id="S2.p1.6.m6.5.5.2.2.3.2.2" xref="S2.p1.6.m6.5.5.2.2.3.1.cmml">,</mo><mi id="S2.p1.6.m6.3.3" xref="S2.p1.6.m6.3.3.cmml">L</mi><mo id="S2.p1.6.m6.5.5.2.2.3.2.3" stretchy="false" xref="S2.p1.6.m6.5.5.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.5b"><apply id="S2.p1.6.m6.5.5.3.cmml" xref="S2.p1.6.m6.5.5.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.5.5.3a.cmml" xref="S2.p1.6.m6.5.5.2.3">formulae-sequence</csymbol><apply id="S2.p1.6.m6.4.4.1.1.cmml" xref="S2.p1.6.m6.4.4.1.1"><eq id="S2.p1.6.m6.4.4.1.1.2.cmml" xref="S2.p1.6.m6.4.4.1.1.2"></eq><apply id="S2.p1.6.m6.4.4.1.1.3.cmml" xref="S2.p1.6.m6.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.p1.6.m6.4.4.1.1.3.1.cmml" xref="S2.p1.6.m6.4.4.1.1.3">superscript</csymbol><ci id="S2.p1.6.m6.4.4.1.1.3.2.cmml" xref="S2.p1.6.m6.4.4.1.1.3.2">𝑋</ci><ci id="S2.p1.6.m6.4.4.1.1.3.3.cmml" xref="S2.p1.6.m6.4.4.1.1.3.3">𝑙</ci></apply><apply id="S2.p1.6.m6.4.4.1.1.1.2.cmml" xref="S2.p1.6.m6.4.4.1.1.1.1"><ci id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1">Decoder</ci><apply id="S2.p1.6.m6.4.4.1.1.1.1.1.1.cmml" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.4.4.1.1.1.1.1.1.1.cmml" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1">superscript</csymbol><ci id="S2.p1.6.m6.4.4.1.1.1.1.1.1.2.cmml" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.2">𝑋</ci><apply id="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.cmml" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.3"><minus id="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.1.cmml" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.1"></minus><ci id="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.2.cmml" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.2">𝑙</ci><cn id="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.p1.6.m6.4.4.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S2.p1.6.m6.5.5.2.2.cmml" xref="S2.p1.6.m6.5.5.2.2"><in id="S2.p1.6.m6.5.5.2.2.1.cmml" xref="S2.p1.6.m6.5.5.2.2.1"></in><ci id="S2.p1.6.m6.5.5.2.2.2.cmml" xref="S2.p1.6.m6.5.5.2.2.2">𝑙</ci><interval closure="closed" id="S2.p1.6.m6.5.5.2.2.3.1.cmml" xref="S2.p1.6.m6.5.5.2.2.3.2"><cn id="S2.p1.6.m6.2.2.cmml" type="integer" xref="S2.p1.6.m6.2.2">1</cn><ci id="S2.p1.6.m6.3.3.cmml" xref="S2.p1.6.m6.3.3">𝐿</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.5c">X^{l}=\operatorname{Decoder}(X^{l-1}),\ l\in[1,L]</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.5d">italic_X start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = roman_Decoder ( italic_X start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT ) , italic_l ∈ [ 1 , italic_L ]</annotation></semantics></math>.
Each layer consists of two modules: a differential attention module followed by a feed-forward network module.
Compared to Transformer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib41" title="">41</a>]</cite>, the main difference is the replacement of conventional <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="S2.p1.7.m7.1"><semantics id="S2.p1.7.m7.1a"><mi id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><ci id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m7.1d">roman_softmax</annotation></semantics></math> attention with differential attention while the macro layout is kept the same.
We also adopt pre-RMSNorm&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib46" title="">46</a>]</cite> and SwiGLU&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib29" title="">29</a>]</cite> as improvements following LLaMA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib38" title="">38</a>]</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Differential Attention</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S2.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S2.F2.1" style="width:206.7pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="681" id="S2.F2.1.g1" src="https://arxiv.org/html/2410.05258v1/x2.png" width="761">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_minipage ltx_align_middle ltx_listing" id="S2.F2.14" style="width:186.8pt;background-color:#FFFFFF;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZGVmIERpZmZBdHRuKFgsIFdfcSwgV19rLCBXX3YsICRcbGFtYmRhJCk6CiAgICBRMSwgUTIgPSBzcGxpdChYIEAgV19xKQogICAgSzEsIEsyID0gc3BsaXQoWCBAIFdfaykKICAgIFYgPSBYIEAgV192CiAgICAjIFFpLCBLaTogW2IsIG4sIGRdOyBWOiBbYiwgbiwgMmRdCiAgICBzID0gMSAvIHNxcnQoZCkKICAgIEExID0gUTEgQCBLMS50cmFuc3Bvc2UoLTEsIC0yKSAqIHMKICAgIEEyID0gUTIgQCBLMi50cmFuc3Bvc2UoLTEsIC0yKSAqIHMKICAgIHJldHVybgogICAgICAoc29mdG1heChBMSkgLSAkXGxhbWJkYSQgc29mdG1heChBMikpIEAgVgoKZGVmIE11bHRpSGVhZChYLCBXX3EsIFdfaywgV192LCBXX28sICRcbGFtYmRhJCk6CiAgICBPID0gR3JvdXBOb3JtKFtEaWZmQXR0bihYLCBXX3FpLCBXX2tpLCBXX3ZpLCAkXGxhbWJkYSQpIGZvciBpIGluIHJhbmdlKGgpXSkKICAgIE8gPSBPICogKDEgLSAkXGxhbWJkYV97XHRleHR7aW5pdH19JCkKICAgIHJldHVybiBDb25jYXQoTykgQCBXX28=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx1">
<span class="ltx_text ltx_lst_keyword" id="lstnumberx1.2" style="color:#0000FF;">def</span><span class="ltx_text ltx_lst_space" id="lstnumberx1.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx1.4">DiffAttn</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx1.5">X</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx1.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx1.7">W_q</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx1.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx1.9">W_k</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx1.10"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx1.11">W_v</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx1.12"> </span><span class="ltx_text" id="lstnumberx1.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="lstnumberx1.1.m1.1"><semantics id="lstnumberx1.1.m1.1a"><mi id="lstnumberx1.1.m1.1.1" mathbackground="#FFFFFF" xref="lstnumberx1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="lstnumberx1.1.m1.1b"><ci id="lstnumberx1.1.m1.1.1.cmml" xref="lstnumberx1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="lstnumberx1.1.m1.1d">italic_λ</annotation></semantics></math></span>):
</div>
<div class="ltx_listingline" id="lstnumberx2">
<span class="ltx_text ltx_lst_space" id="lstnumberx2.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx2.2">Q1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx2.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx2.4">Q2</span><span class="ltx_text ltx_lst_space" id="lstnumberx2.5"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx2.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx2.7">split</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx2.8">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx2.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx2.10">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx2.11"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx2.12">W_q</span>)
</div>
<div class="ltx_listingline" id="lstnumberx3">
<span class="ltx_text ltx_lst_space" id="lstnumberx3.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx3.2">K1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx3.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx3.4">K2</span><span class="ltx_text ltx_lst_space" id="lstnumberx3.5"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx3.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx3.7">split</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx3.8">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx3.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx3.10">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx3.11"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx3.12">W_k</span>)
</div>
<div class="ltx_listingline" id="lstnumberx4">
<span class="ltx_text ltx_lst_space" id="lstnumberx4.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx4.2">V</span><span class="ltx_text ltx_lst_space" id="lstnumberx4.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx4.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx4.5">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx4.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx4.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx4.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx4.9">W_v</span>
</div>
<div class="ltx_listingline" id="lstnumberx5">
<span class="ltx_text ltx_lst_space" id="lstnumberx5.1"> </span><span class="ltx_text ltx_lst_comment" id="lstnumberx5.2" style="color:#808080;">#<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.1"> </span>Qi,<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.2"> </span>Ki:<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.3"> </span>[b,<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.4"> </span>n,<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.5"> </span>d];<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.6"> </span>V:<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.7"> </span>[b,<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.8"> </span>n,<span class="ltx_text ltx_lst_space" id="lstnumberx5.2.9"> </span>2d]</span>
</div>
<div class="ltx_listingline" id="lstnumberx6">
<span class="ltx_text ltx_lst_space" id="lstnumberx6.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx6.2">s</span><span class="ltx_text ltx_lst_space" id="lstnumberx6.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx6.4"> </span>1<span class="ltx_text ltx_lst_space" id="lstnumberx6.5"> </span>/<span class="ltx_text ltx_lst_space" id="lstnumberx6.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx6.7">sqrt</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx6.8">d</span>)
</div>
<div class="ltx_listingline" id="lstnumberx7">
<span class="ltx_text ltx_lst_space" id="lstnumberx7.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx7.2">A1</span><span class="ltx_text ltx_lst_space" id="lstnumberx7.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx7.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx7.5">Q1</span><span class="ltx_text ltx_lst_space" id="lstnumberx7.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx7.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx7.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx7.9">K1</span>.<span class="ltx_text ltx_lst_identifier" id="lstnumberx7.10">transpose</span>(-1,<span class="ltx_text ltx_lst_space" id="lstnumberx7.11"> </span>-2)<span class="ltx_text ltx_lst_space" id="lstnumberx7.12"> </span>*<span class="ltx_text ltx_lst_space" id="lstnumberx7.13"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx7.14">s</span>
</div>
<div class="ltx_listingline" id="lstnumberx8">
<span class="ltx_text ltx_lst_space" id="lstnumberx8.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx8.2">A2</span><span class="ltx_text ltx_lst_space" id="lstnumberx8.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx8.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx8.5">Q2</span><span class="ltx_text ltx_lst_space" id="lstnumberx8.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx8.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx8.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx8.9">K2</span>.<span class="ltx_text ltx_lst_identifier" id="lstnumberx8.10">transpose</span>(-1,<span class="ltx_text ltx_lst_space" id="lstnumberx8.11"> </span>-2)<span class="ltx_text ltx_lst_space" id="lstnumberx8.12"> </span>*<span class="ltx_text ltx_lst_space" id="lstnumberx8.13"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx8.14">s</span>
</div>
<div class="ltx_listingline" id="lstnumberx9">
<span class="ltx_text ltx_lst_space" id="lstnumberx9.1"> </span><span class="ltx_text ltx_lst_keyword" id="lstnumberx9.2" style="color:#0000FF;">return</span>
</div>
<div class="ltx_listingline" id="lstnumberx10">
<span class="ltx_text ltx_lst_space" id="lstnumberx10.2"> </span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx10.3">softmax</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx10.4">A1</span>)<span class="ltx_text ltx_lst_space" id="lstnumberx10.5"> </span>-<span class="ltx_text ltx_lst_space" id="lstnumberx10.6"> </span><span class="ltx_text" id="lstnumberx10.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="lstnumberx10.1.m1.1"><semantics id="lstnumberx10.1.m1.1a"><mi id="lstnumberx10.1.m1.1.1" mathbackground="#FFFFFF" xref="lstnumberx10.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="lstnumberx10.1.m1.1b"><ci id="lstnumberx10.1.m1.1.1.cmml" xref="lstnumberx10.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx10.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="lstnumberx10.1.m1.1d">italic_λ</annotation></semantics></math></span><span class="ltx_text ltx_lst_space" id="lstnumberx10.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx10.8">softmax</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx10.9">A2</span>))<span class="ltx_text ltx_lst_space" id="lstnumberx10.10"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx10.11">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx10.12"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx10.13">V</span>
</div>
<div class="ltx_listingline" id="lstnumberx11">
</div>
<div class="ltx_listingline" id="lstnumberx12">
<span class="ltx_text ltx_lst_keyword" id="lstnumberx12.2" style="color:#0000FF;">def</span><span class="ltx_text ltx_lst_space" id="lstnumberx12.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx12.4">MultiHead</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx12.5">X</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx12.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx12.7">W_q</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx12.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx12.9">W_k</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx12.10"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx12.11">W_v</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx12.12"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx12.13">W_o</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx12.14"> </span><span class="ltx_text" id="lstnumberx12.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="lstnumberx12.1.m1.1"><semantics id="lstnumberx12.1.m1.1a"><mi id="lstnumberx12.1.m1.1.1" mathbackground="#FFFFFF" xref="lstnumberx12.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="lstnumberx12.1.m1.1b"><ci id="lstnumberx12.1.m1.1.1.cmml" xref="lstnumberx12.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx12.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="lstnumberx12.1.m1.1d">italic_λ</annotation></semantics></math></span>):
</div>
<div class="ltx_listingline" id="lstnumberx13">
<span class="ltx_text ltx_lst_space" id="lstnumberx13.2"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx13.3">O</span><span class="ltx_text ltx_lst_space" id="lstnumberx13.4"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx13.5"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx13.6">GroupNorm</span>([<span class="ltx_text ltx_lst_identifier" id="lstnumberx13.7">DiffAttn</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx13.8">X</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx13.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx13.10">W_qi</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx13.11"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx13.12">W_ki</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx13.13"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx13.14">W_vi</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx13.15"> </span><span class="ltx_text" id="lstnumberx13.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="lstnumberx13.1.m1.1"><semantics id="lstnumberx13.1.m1.1a"><mi id="lstnumberx13.1.m1.1.1" mathbackground="#FFFFFF" xref="lstnumberx13.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="lstnumberx13.1.m1.1b"><ci id="lstnumberx13.1.m1.1.1.cmml" xref="lstnumberx13.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx13.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="lstnumberx13.1.m1.1d">italic_λ</annotation></semantics></math></span>)<span class="ltx_text ltx_lst_space" id="lstnumberx13.16"> </span><span class="ltx_text ltx_lst_keyword" id="lstnumberx13.17" style="color:#0000FF;">for</span><span class="ltx_text ltx_lst_space" id="lstnumberx13.18"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx13.19">i</span><span class="ltx_text ltx_lst_space" id="lstnumberx13.20"> </span><span class="ltx_text ltx_lst_keyword" id="lstnumberx13.21" style="color:#0000FF;">in</span><span class="ltx_text ltx_lst_space" id="lstnumberx13.22"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2" id="lstnumberx13.23" style="color:#0000FF;">range</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx13.24">h</span>)])
</div>
<div class="ltx_listingline" id="lstnumberx14">
<span class="ltx_text ltx_lst_space" id="lstnumberx14.2"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx14.3">O</span><span class="ltx_text ltx_lst_space" id="lstnumberx14.4"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx14.5"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx14.6">O</span><span class="ltx_text ltx_lst_space" id="lstnumberx14.7"> </span>*<span class="ltx_text ltx_lst_space" id="lstnumberx14.8"> </span>(1<span class="ltx_text ltx_lst_space" id="lstnumberx14.9"> </span>-<span class="ltx_text ltx_lst_space" id="lstnumberx14.10"> </span><span class="ltx_text" id="lstnumberx14.1"><math alttext="\lambda_{\text{init}}" class="ltx_Math" display="inline" id="lstnumberx14.1.m1.1"><semantics id="lstnumberx14.1.m1.1a"><msub id="lstnumberx14.1.m1.1.1" xref="lstnumberx14.1.m1.1.1.cmml"><mi id="lstnumberx14.1.m1.1.1.2" mathbackground="#FFFFFF" xref="lstnumberx14.1.m1.1.1.2.cmml">λ</mi><mtext id="lstnumberx14.1.m1.1.1.3" mathbackground="#FFFFFF" xref="lstnumberx14.1.m1.1.1.3a.cmml">init</mtext></msub><annotation-xml encoding="MathML-Content" id="lstnumberx14.1.m1.1b"><apply id="lstnumberx14.1.m1.1.1.cmml" xref="lstnumberx14.1.m1.1.1"><csymbol cd="ambiguous" id="lstnumberx14.1.m1.1.1.1.cmml" xref="lstnumberx14.1.m1.1.1">subscript</csymbol><ci id="lstnumberx14.1.m1.1.1.2.cmml" xref="lstnumberx14.1.m1.1.1.2">𝜆</ci><ci id="lstnumberx14.1.m1.1.1.3a.cmml" xref="lstnumberx14.1.m1.1.1.3"><mtext id="lstnumberx14.1.m1.1.1.3.cmml" mathbackground="#FFFFFF" mathsize="70%" xref="lstnumberx14.1.m1.1.1.3">init</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx14.1.m1.1c">\lambda_{\text{init}}</annotation><annotation encoding="application/x-llamapun" id="lstnumberx14.1.m1.1d">italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math></span>)
</div>
<div class="ltx_listingline" id="lstnumberx15">
<span class="ltx_text ltx_lst_space" id="lstnumberx15.1"> </span><span class="ltx_text ltx_lst_keyword" id="lstnumberx15.2" style="color:#0000FF;">return</span><span class="ltx_text ltx_lst_space" id="lstnumberx15.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx15.4">Concat</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx15.5">O</span>)<span class="ltx_text ltx_lst_space" id="lstnumberx15.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx15.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx15.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx15.9">W_o</span>
</div>
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Multi-head differential attention.
Each head takes the difference between two <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="S2.F2.8.m1.1"><semantics id="S2.F2.8.m1.1b"><mi id="S2.F2.8.m1.1.1" xref="S2.F2.8.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S2.F2.8.m1.1c"><ci id="S2.F2.8.m1.1.1.cmml" xref="S2.F2.8.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.m1.1d">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.8.m1.1e">roman_softmax</annotation></semantics></math> attention maps to cancel out attention noise.
<math alttext="\lambda" class="ltx_Math" display="inline" id="S2.F2.9.m2.1"><semantics id="S2.F2.9.m2.1b"><mi id="S2.F2.9.m2.1.1" xref="S2.F2.9.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.F2.9.m2.1c"><ci id="S2.F2.9.m2.1.1.cmml" xref="S2.F2.9.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.9.m2.1d">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.F2.9.m2.1e">italic_λ</annotation></semantics></math> is a learnable scalar that is initialized to <math alttext="\lambda_{\text{init}}" class="ltx_Math" display="inline" id="S2.F2.10.m3.1"><semantics id="S2.F2.10.m3.1b"><msub id="S2.F2.10.m3.1.1" xref="S2.F2.10.m3.1.1.cmml"><mi id="S2.F2.10.m3.1.1.2" xref="S2.F2.10.m3.1.1.2.cmml">λ</mi><mtext id="S2.F2.10.m3.1.1.3" xref="S2.F2.10.m3.1.1.3a.cmml">init</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.10.m3.1c"><apply id="S2.F2.10.m3.1.1.cmml" xref="S2.F2.10.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.10.m3.1.1.1.cmml" xref="S2.F2.10.m3.1.1">subscript</csymbol><ci id="S2.F2.10.m3.1.1.2.cmml" xref="S2.F2.10.m3.1.1.2">𝜆</ci><ci id="S2.F2.10.m3.1.1.3a.cmml" xref="S2.F2.10.m3.1.1.3"><mtext id="S2.F2.10.m3.1.1.3.cmml" mathsize="70%" xref="S2.F2.10.m3.1.1.3">init</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.10.m3.1d">\lambda_{\text{init}}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.10.m3.1e">italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math>.
<math alttext="\operatorname{GroupNorm}" class="ltx_Math" display="inline" id="S2.F2.11.m4.1"><semantics id="S2.F2.11.m4.1b"><mi id="S2.F2.11.m4.1.1" xref="S2.F2.11.m4.1.1.cmml">GroupNorm</mi><annotation-xml encoding="MathML-Content" id="S2.F2.11.m4.1c"><ci id="S2.F2.11.m4.1.1.cmml" xref="S2.F2.11.m4.1.1">GroupNorm</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.11.m4.1d">\operatorname{GroupNorm}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.11.m4.1e">roman_GroupNorm</annotation></semantics></math> applies normalization to each head independently.
A fixed multiplier <math alttext="(1-\lambda_{\text{init}})" class="ltx_Math" display="inline" id="S2.F2.12.m5.1"><semantics id="S2.F2.12.m5.1b"><mrow id="S2.F2.12.m5.1.1.1" xref="S2.F2.12.m5.1.1.1.1.cmml"><mo id="S2.F2.12.m5.1.1.1.2" stretchy="false" xref="S2.F2.12.m5.1.1.1.1.cmml">(</mo><mrow id="S2.F2.12.m5.1.1.1.1" xref="S2.F2.12.m5.1.1.1.1.cmml"><mn id="S2.F2.12.m5.1.1.1.1.2" xref="S2.F2.12.m5.1.1.1.1.2.cmml">1</mn><mo id="S2.F2.12.m5.1.1.1.1.1" xref="S2.F2.12.m5.1.1.1.1.1.cmml">−</mo><msub id="S2.F2.12.m5.1.1.1.1.3" xref="S2.F2.12.m5.1.1.1.1.3.cmml"><mi id="S2.F2.12.m5.1.1.1.1.3.2" xref="S2.F2.12.m5.1.1.1.1.3.2.cmml">λ</mi><mtext id="S2.F2.12.m5.1.1.1.1.3.3" xref="S2.F2.12.m5.1.1.1.1.3.3a.cmml">init</mtext></msub></mrow><mo id="S2.F2.12.m5.1.1.1.3" stretchy="false" xref="S2.F2.12.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.12.m5.1c"><apply id="S2.F2.12.m5.1.1.1.1.cmml" xref="S2.F2.12.m5.1.1.1"><minus id="S2.F2.12.m5.1.1.1.1.1.cmml" xref="S2.F2.12.m5.1.1.1.1.1"></minus><cn id="S2.F2.12.m5.1.1.1.1.2.cmml" type="integer" xref="S2.F2.12.m5.1.1.1.1.2">1</cn><apply id="S2.F2.12.m5.1.1.1.1.3.cmml" xref="S2.F2.12.m5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.F2.12.m5.1.1.1.1.3.1.cmml" xref="S2.F2.12.m5.1.1.1.1.3">subscript</csymbol><ci id="S2.F2.12.m5.1.1.1.1.3.2.cmml" xref="S2.F2.12.m5.1.1.1.1.3.2">𝜆</ci><ci id="S2.F2.12.m5.1.1.1.1.3.3a.cmml" xref="S2.F2.12.m5.1.1.1.1.3.3"><mtext id="S2.F2.12.m5.1.1.1.1.3.3.cmml" mathsize="70%" xref="S2.F2.12.m5.1.1.1.1.3.3">init</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.12.m5.1d">(1-\lambda_{\text{init}})</annotation><annotation encoding="application/x-llamapun" id="S2.F2.12.m5.1e">( 1 - italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT )</annotation></semantics></math> is used after <math alttext="\operatorname{GroupNorm}" class="ltx_Math" display="inline" id="S2.F2.13.m6.1"><semantics id="S2.F2.13.m6.1b"><mi id="S2.F2.13.m6.1.1" xref="S2.F2.13.m6.1.1.cmml">GroupNorm</mi><annotation-xml encoding="MathML-Content" id="S2.F2.13.m6.1c"><ci id="S2.F2.13.m6.1.1.cmml" xref="S2.F2.13.m6.1.1">GroupNorm</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.13.m6.1d">\operatorname{GroupNorm}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.13.m6.1e">roman_GroupNorm</annotation></semantics></math>, which aligns the gradient flow with Transformer.
The code implementation is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aka.ms/Diff-Transformer" title="">https://aka.ms/Diff-Transformer</a>.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.4">The differential attention mechanism maps query, key, and value vectors to outputs.
We use query and key vectors to compute attention scores, and then compute a weighted sum of value vectors.
The critical design is that we use a pair of <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">roman_softmax</annotation></semantics></math> functions to cancel the noise of attention scores.
Specifically, given input <math alttext="X\in\mathbb{R}^{N\times d_{\text{model}}}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">X</mi><mo id="S2.SS1.p1.2.m2.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.3.2" xref="S2.SS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.2.m2.1.1.3.3" xref="S2.SS1.p1.2.m2.1.1.3.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.3.3.2" xref="S2.SS1.p1.2.m2.1.1.3.3.2.cmml">N</mi><mo id="S2.SS1.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S2.SS1.p1.2.m2.1.1.3.3.3" xref="S2.SS1.p1.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.3.3.3.2" xref="S2.SS1.p1.2.m2.1.1.3.3.3.2.cmml">d</mi><mtext id="S2.SS1.p1.2.m2.1.1.3.3.3.3" xref="S2.SS1.p1.2.m2.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><in id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1"></in><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝑋</ci><apply id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S2.SS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3"><times id="S2.SS1.p1.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3.1"></times><ci id="S2.SS1.p1.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3.2">𝑁</ci><apply id="S2.SS1.p1.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S2.SS1.p1.2.m2.1.1.3.3.3.3a.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3.3.3"><mtext id="S2.SS1.p1.2.m2.1.1.3.3.3.3.cmml" mathsize="50%" xref="S2.SS1.p1.2.m2.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">X\in\mathbb{R}^{N\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, we first project them to query, key, and value <math alttext="Q_{1},Q_{2},K_{1},K_{2}\in\mathbb{R}^{N\times d},\ V\in\mathbb{R}^{N\times 2d}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.2"><semantics id="S2.SS1.p1.3.m3.2a"><mrow id="S2.SS1.p1.3.m3.2.2.2" xref="S2.SS1.p1.3.m3.2.2.3.cmml"><mrow id="S2.SS1.p1.3.m3.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.cmml"><mrow id="S2.SS1.p1.3.m3.1.1.1.1.4.4" xref="S2.SS1.p1.3.m3.1.1.1.1.4.5.cmml"><msub id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.cmml">Q</mi><mn id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.3.m3.1.1.1.1.4.4.5" xref="S2.SS1.p1.3.m3.1.1.1.1.4.5.cmml">,</mo><msub id="S2.SS1.p1.3.m3.1.1.1.1.2.2.2" xref="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.2" xref="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.2.cmml">Q</mi><mn id="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.3" xref="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.3.m3.1.1.1.1.4.4.6" xref="S2.SS1.p1.3.m3.1.1.1.1.4.5.cmml">,</mo><msub id="S2.SS1.p1.3.m3.1.1.1.1.3.3.3" xref="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.2" xref="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.2.cmml">K</mi><mn id="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.3" xref="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.3.cmml">1</mn></msub><mo id="S2.SS1.p1.3.m3.1.1.1.1.4.4.7" xref="S2.SS1.p1.3.m3.1.1.1.1.4.5.cmml">,</mo><msub id="S2.SS1.p1.3.m3.1.1.1.1.4.4.4" xref="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.2" xref="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.2.cmml">K</mi><mn id="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.3" xref="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.3.cmml">2</mn></msub></mrow><mo id="S2.SS1.p1.3.m3.1.1.1.1.5" xref="S2.SS1.p1.3.m3.1.1.1.1.5.cmml">∈</mo><msup id="S2.SS1.p1.3.m3.1.1.1.1.6" xref="S2.SS1.p1.3.m3.1.1.1.1.6.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.6.2" xref="S2.SS1.p1.3.m3.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.3.m3.1.1.1.1.6.3" xref="S2.SS1.p1.3.m3.1.1.1.1.6.3.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.6.3.2" xref="S2.SS1.p1.3.m3.1.1.1.1.6.3.2.cmml">N</mi><mo id="S2.SS1.p1.3.m3.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.3.m3.1.1.1.1.6.3.1.cmml">×</mo><mi id="S2.SS1.p1.3.m3.1.1.1.1.6.3.3" xref="S2.SS1.p1.3.m3.1.1.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><mo id="S2.SS1.p1.3.m3.2.2.2.3" rspace="0.667em" xref="S2.SS1.p1.3.m3.2.2.3a.cmml">,</mo><mrow id="S2.SS1.p1.3.m3.2.2.2.2" xref="S2.SS1.p1.3.m3.2.2.2.2.cmml"><mi id="S2.SS1.p1.3.m3.2.2.2.2.2" xref="S2.SS1.p1.3.m3.2.2.2.2.2.cmml">V</mi><mo id="S2.SS1.p1.3.m3.2.2.2.2.1" xref="S2.SS1.p1.3.m3.2.2.2.2.1.cmml">∈</mo><msup id="S2.SS1.p1.3.m3.2.2.2.2.3" xref="S2.SS1.p1.3.m3.2.2.2.2.3.cmml"><mi id="S2.SS1.p1.3.m3.2.2.2.2.3.2" xref="S2.SS1.p1.3.m3.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.3.m3.2.2.2.2.3.3" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.cmml"><mrow id="S2.SS1.p1.3.m3.2.2.2.2.3.3.2" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.cmml"><mi id="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.2" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.2.cmml">N</mi><mo id="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.1.cmml">×</mo><mn id="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.3" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.3.cmml">2</mn></mrow><mo id="S2.SS1.p1.3.m3.2.2.2.2.3.3.1" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.3.m3.2.2.2.2.3.3.3" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.3.cmml">d</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.2b"><apply id="S2.SS1.p1.3.m3.2.2.3.cmml" xref="S2.SS1.p1.3.m3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.2.2.3a.cmml" xref="S2.SS1.p1.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p1.3.m3.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1"><in id="S2.SS1.p1.3.m3.1.1.1.1.5.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.5"></in><list id="S2.SS1.p1.3.m3.1.1.1.1.4.5.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.4.4"><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2">𝑄</ci><cn id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.2">𝑄</ci><cn id="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.1.1.1.1.2.2.2.3">2</cn></apply><apply id="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.2">𝐾</ci><cn id="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.1.1.1.1.3.3.3.3">1</cn></apply><apply id="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.4.4.4">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.2">𝐾</ci><cn id="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.1.1.1.1.4.4.4.3">2</cn></apply></list><apply id="S2.SS1.p1.3.m3.1.1.1.1.6.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.6.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.6">superscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.6.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.6.2">ℝ</ci><apply id="S2.SS1.p1.3.m3.1.1.1.1.6.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.6.3"><times id="S2.SS1.p1.3.m3.1.1.1.1.6.3.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.6.3.1"></times><ci id="S2.SS1.p1.3.m3.1.1.1.1.6.3.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.6.3.2">𝑁</ci><ci id="S2.SS1.p1.3.m3.1.1.1.1.6.3.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.6.3.3">𝑑</ci></apply></apply></apply><apply id="S2.SS1.p1.3.m3.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2"><in id="S2.SS1.p1.3.m3.2.2.2.2.1.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.1"></in><ci id="S2.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.2">𝑉</ci><apply id="S2.SS1.p1.3.m3.2.2.2.2.3.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.2.2.2.2.3.1.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.3">superscript</csymbol><ci id="S2.SS1.p1.3.m3.2.2.2.2.3.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.3.2">ℝ</ci><apply id="S2.SS1.p1.3.m3.2.2.2.2.3.3.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3"><times id="S2.SS1.p1.3.m3.2.2.2.2.3.3.1.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.1"></times><apply id="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.2"><times id="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.1.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.1"></times><ci id="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.2">𝑁</ci><cn id="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.2.3">2</cn></apply><ci id="S2.SS1.p1.3.m3.2.2.2.2.3.3.3.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2.3.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.2c">Q_{1},Q_{2},K_{1},K_{2}\in\mathbb{R}^{N\times d},\ V\in\mathbb{R}^{N\times 2d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.2d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT , italic_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × 2 italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.
Then the differential attention operator <math alttext="\operatorname{DiffAttn{}}(\cdot)" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.2"><semantics id="S2.SS1.p1.4.m4.2a"><mrow id="S2.SS1.p1.4.m4.2.3.2" xref="S2.SS1.p1.4.m4.2.3.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">DiffAttn</mi><mo id="S2.SS1.p1.4.m4.2.3.2a" xref="S2.SS1.p1.4.m4.2.3.1.cmml">⁡</mo><mrow id="S2.SS1.p1.4.m4.2.3.2.1" xref="S2.SS1.p1.4.m4.2.3.1.cmml"><mo id="S2.SS1.p1.4.m4.2.3.2.1.1" stretchy="false" xref="S2.SS1.p1.4.m4.2.3.1.cmml">(</mo><mo id="S2.SS1.p1.4.m4.2.2" lspace="0em" rspace="0em" xref="S2.SS1.p1.4.m4.2.2.cmml">⋅</mo><mo id="S2.SS1.p1.4.m4.2.3.2.1.2" stretchy="false" xref="S2.SS1.p1.4.m4.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.2b"><apply id="S2.SS1.p1.4.m4.2.3.1.cmml" xref="S2.SS1.p1.4.m4.2.3.2"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">DiffAttn</ci><ci id="S2.SS1.p1.4.m4.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.2c">\operatorname{DiffAttn{}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.2d">roman_DiffAttn ( ⋅ )</annotation></semantics></math> computes outputs via:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E1">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E1X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle[Q_{1};Q_{2}" class="ltx_math_unparsed" display="inline" id="S2.E1X.2.1.1.m1.1"><semantics id="S2.E1X.2.1.1.m1.1a"><mrow id="S2.E1X.2.1.1.m1.1b"><mo id="S2.E1X.2.1.1.m1.1.1" stretchy="false">[</mo><msub id="S2.E1X.2.1.1.m1.1.2"><mi id="S2.E1X.2.1.1.m1.1.2.2">Q</mi><mn id="S2.E1X.2.1.1.m1.1.2.3">1</mn></msub><mo id="S2.E1X.2.1.1.m1.1.3">;</mo><msub id="S2.E1X.2.1.1.m1.1.4"><mi id="S2.E1X.2.1.1.m1.1.4.2">Q</mi><mn id="S2.E1X.2.1.1.m1.1.4.3">2</mn></msub></mrow><annotation encoding="application/x-tex" id="S2.E1X.2.1.1.m1.1c">\displaystyle[Q_{1};Q_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.E1X.2.1.1.m1.1d">[ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle]=XW^{Q},\quad[K_{1};K_{2}]=XW^{K},\quad V=XW^{V}" class="ltx_math_unparsed" display="inline" id="S2.E1X.3.2.2.m1.1"><semantics id="S2.E1X.3.2.2.m1.1a"><mrow id="S2.E1X.3.2.2.m1.1b"><mo id="S2.E1X.3.2.2.m1.1.1" stretchy="false">]</mo><mo id="S2.E1X.3.2.2.m1.1.2">=</mo><mi id="S2.E1X.3.2.2.m1.1.3">X</mi><mi id="S2.E1X.3.2.2.m1.1.4">W</mi><msup id="S2.E1X.3.2.2.m1.1.5"><mi id="S2.E1X.3.2.2.m1.1.5a"></mi><mi id="S2.E1X.3.2.2.m1.1.5.1">Q</mi></msup><mo id="S2.E1X.3.2.2.m1.1.6" rspace="1.167em">,</mo><mo id="S2.E1X.3.2.2.m1.1.7" stretchy="false">[</mo><msub id="S2.E1X.3.2.2.m1.1.8"><mi id="S2.E1X.3.2.2.m1.1.8.2">K</mi><mn id="S2.E1X.3.2.2.m1.1.8.3">1</mn></msub><mo id="S2.E1X.3.2.2.m1.1.9">;</mo><msub id="S2.E1X.3.2.2.m1.1.10"><mi id="S2.E1X.3.2.2.m1.1.10.2">K</mi><mn id="S2.E1X.3.2.2.m1.1.10.3">2</mn></msub><mo id="S2.E1X.3.2.2.m1.1.11" stretchy="false">]</mo><mo id="S2.E1X.3.2.2.m1.1.12">=</mo><mi id="S2.E1X.3.2.2.m1.1.13">X</mi><mi id="S2.E1X.3.2.2.m1.1.14">W</mi><msup id="S2.E1X.3.2.2.m1.1.15"><mi id="S2.E1X.3.2.2.m1.1.15a"></mi><mi id="S2.E1X.3.2.2.m1.1.15.1">K</mi></msup><mo id="S2.E1X.3.2.2.m1.1.16" rspace="1.167em">,</mo><mi id="S2.E1X.3.2.2.m1.1.17">V</mi><mo id="S2.E1X.3.2.2.m1.1.18">=</mo><mi id="S2.E1X.3.2.2.m1.1.19">X</mi><mi id="S2.E1X.3.2.2.m1.1.20">W</mi><msup id="S2.E1X.3.2.2.m1.1.21"><mi id="S2.E1X.3.2.2.m1.1.21a"></mi><mi id="S2.E1X.3.2.2.m1.1.21.1">V</mi></msup></mrow><annotation encoding="application/x-tex" id="S2.E1X.3.2.2.m1.1c">\displaystyle]=XW^{Q},\quad[K_{1};K_{2}]=XW^{K},\quad V=XW^{V}</annotation><annotation encoding="application/x-llamapun" id="S2.E1X.3.2.2.m1.1d">] = italic_X italic_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , [ italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] = italic_X italic_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_V = italic_X italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E1Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\operatorname{DiffAttn}" class="ltx_Math" display="inline" id="S2.E1Xa.2.1.1.m1.1"><semantics id="S2.E1Xa.2.1.1.m1.1a"><mi id="S2.E1Xa.2.1.1.m1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.cmml">DiffAttn</mi><annotation-xml encoding="MathML-Content" id="S2.E1Xa.2.1.1.m1.1b"><ci id="S2.E1Xa.2.1.1.m1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1">DiffAttn</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E1Xa.2.1.1.m1.1c">\displaystyle\operatorname{DiffAttn}</annotation><annotation encoding="application/x-llamapun" id="S2.E1Xa.2.1.1.m1.1d">roman_DiffAttn</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle(X)=(\mathrm{softmax}(\frac{Q_{1}K^{T}_{1}}{\sqrt{d}})-\lambda~{}%
\mathrm{softmax}(\frac{Q_{2}K^{T}_{2}}{\sqrt{d}}))V" class="ltx_Math" display="inline" id="S2.E1Xa.3.2.2.m1.4"><semantics id="S2.E1Xa.3.2.2.m1.4a"><mrow id="S2.E1Xa.3.2.2.m1.4.4" xref="S2.E1Xa.3.2.2.m1.4.4.cmml"><mrow id="S2.E1Xa.3.2.2.m1.4.4.3.2" xref="S2.E1Xa.3.2.2.m1.4.4.cmml"><mo id="S2.E1Xa.3.2.2.m1.4.4.3.2.1" stretchy="false" xref="S2.E1Xa.3.2.2.m1.4.4.cmml">(</mo><mi id="S2.E1Xa.3.2.2.m1.1.1" xref="S2.E1Xa.3.2.2.m1.1.1.cmml">X</mi><mo id="S2.E1Xa.3.2.2.m1.4.4.3.2.2" stretchy="false" xref="S2.E1Xa.3.2.2.m1.4.4.cmml">)</mo></mrow><mo id="S2.E1Xa.3.2.2.m1.4.4.2" xref="S2.E1Xa.3.2.2.m1.4.4.2.cmml">=</mo><mrow id="S2.E1Xa.3.2.2.m1.4.4.1" xref="S2.E1Xa.3.2.2.m1.4.4.1.cmml"><mrow id="S2.E1Xa.3.2.2.m1.4.4.1.1.1" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.cmml"><mo id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.2" stretchy="false" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.cmml"><mrow id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.cmml"><mi id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.2" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.2.cmml">softmax</mi><mo id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.1" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.3.2" xref="S2.E1Xa.3.2.2.m1.2.2.cmml"><mo id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.3.2.1" stretchy="false" xref="S2.E1Xa.3.2.2.m1.2.2.cmml">(</mo><mstyle displaystyle="true" id="S2.E1Xa.3.2.2.m1.2.2" xref="S2.E1Xa.3.2.2.m1.2.2.cmml"><mfrac id="S2.E1Xa.3.2.2.m1.2.2a" xref="S2.E1Xa.3.2.2.m1.2.2.cmml"><mrow id="S2.E1Xa.3.2.2.m1.2.2.2" xref="S2.E1Xa.3.2.2.m1.2.2.2.cmml"><msub id="S2.E1Xa.3.2.2.m1.2.2.2.2" xref="S2.E1Xa.3.2.2.m1.2.2.2.2.cmml"><mi id="S2.E1Xa.3.2.2.m1.2.2.2.2.2" xref="S2.E1Xa.3.2.2.m1.2.2.2.2.2.cmml">Q</mi><mn id="S2.E1Xa.3.2.2.m1.2.2.2.2.3" xref="S2.E1Xa.3.2.2.m1.2.2.2.2.3.cmml">1</mn></msub><mo id="S2.E1Xa.3.2.2.m1.2.2.2.1" xref="S2.E1Xa.3.2.2.m1.2.2.2.1.cmml">⁢</mo><msubsup id="S2.E1Xa.3.2.2.m1.2.2.2.3" xref="S2.E1Xa.3.2.2.m1.2.2.2.3.cmml"><mi id="S2.E1Xa.3.2.2.m1.2.2.2.3.2.2" xref="S2.E1Xa.3.2.2.m1.2.2.2.3.2.2.cmml">K</mi><mn id="S2.E1Xa.3.2.2.m1.2.2.2.3.3" xref="S2.E1Xa.3.2.2.m1.2.2.2.3.3.cmml">1</mn><mi id="S2.E1Xa.3.2.2.m1.2.2.2.3.2.3" xref="S2.E1Xa.3.2.2.m1.2.2.2.3.2.3.cmml">T</mi></msubsup></mrow><msqrt id="S2.E1Xa.3.2.2.m1.2.2.3" xref="S2.E1Xa.3.2.2.m1.2.2.3.cmml"><mi id="S2.E1Xa.3.2.2.m1.2.2.3.2" xref="S2.E1Xa.3.2.2.m1.2.2.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.3.2.2" stretchy="false" xref="S2.E1Xa.3.2.2.m1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.1" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.1.cmml">−</mo><mrow id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.cmml"><mi id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.2" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.2.cmml">λ</mi><mo id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.1" lspace="0.330em" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.3" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.3.cmml">softmax</mi><mo id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.1a" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.4.2" xref="S2.E1Xa.3.2.2.m1.3.3.cmml"><mo id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.4.2.1" stretchy="false" xref="S2.E1Xa.3.2.2.m1.3.3.cmml">(</mo><mstyle displaystyle="true" id="S2.E1Xa.3.2.2.m1.3.3" xref="S2.E1Xa.3.2.2.m1.3.3.cmml"><mfrac id="S2.E1Xa.3.2.2.m1.3.3a" xref="S2.E1Xa.3.2.2.m1.3.3.cmml"><mrow id="S2.E1Xa.3.2.2.m1.3.3.2" xref="S2.E1Xa.3.2.2.m1.3.3.2.cmml"><msub id="S2.E1Xa.3.2.2.m1.3.3.2.2" xref="S2.E1Xa.3.2.2.m1.3.3.2.2.cmml"><mi id="S2.E1Xa.3.2.2.m1.3.3.2.2.2" xref="S2.E1Xa.3.2.2.m1.3.3.2.2.2.cmml">Q</mi><mn id="S2.E1Xa.3.2.2.m1.3.3.2.2.3" xref="S2.E1Xa.3.2.2.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S2.E1Xa.3.2.2.m1.3.3.2.1" xref="S2.E1Xa.3.2.2.m1.3.3.2.1.cmml">⁢</mo><msubsup id="S2.E1Xa.3.2.2.m1.3.3.2.3" xref="S2.E1Xa.3.2.2.m1.3.3.2.3.cmml"><mi id="S2.E1Xa.3.2.2.m1.3.3.2.3.2.2" xref="S2.E1Xa.3.2.2.m1.3.3.2.3.2.2.cmml">K</mi><mn id="S2.E1Xa.3.2.2.m1.3.3.2.3.3" xref="S2.E1Xa.3.2.2.m1.3.3.2.3.3.cmml">2</mn><mi id="S2.E1Xa.3.2.2.m1.3.3.2.3.2.3" xref="S2.E1Xa.3.2.2.m1.3.3.2.3.2.3.cmml">T</mi></msubsup></mrow><msqrt id="S2.E1Xa.3.2.2.m1.3.3.3" xref="S2.E1Xa.3.2.2.m1.3.3.3.cmml"><mi id="S2.E1Xa.3.2.2.m1.3.3.3.2" xref="S2.E1Xa.3.2.2.m1.3.3.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.4.2.2" stretchy="false" xref="S2.E1Xa.3.2.2.m1.3.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.3" stretchy="false" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E1Xa.3.2.2.m1.4.4.1.2" xref="S2.E1Xa.3.2.2.m1.4.4.1.2.cmml">⁢</mo><mi id="S2.E1Xa.3.2.2.m1.4.4.1.3" xref="S2.E1Xa.3.2.2.m1.4.4.1.3.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1Xa.3.2.2.m1.4b"><apply id="S2.E1Xa.3.2.2.m1.4.4.cmml" xref="S2.E1Xa.3.2.2.m1.4.4"><eq id="S2.E1Xa.3.2.2.m1.4.4.2.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.2"></eq><ci id="S2.E1Xa.3.2.2.m1.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.1.1">𝑋</ci><apply id="S2.E1Xa.3.2.2.m1.4.4.1.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1"><times id="S2.E1Xa.3.2.2.m1.4.4.1.2.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.2"></times><apply id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1"><minus id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.1"></minus><apply id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2"><times id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.1"></times><ci id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.2">softmax</ci><apply id="S2.E1Xa.3.2.2.m1.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.3.2"><divide id="S2.E1Xa.3.2.2.m1.2.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.2.3.2"></divide><apply id="S2.E1Xa.3.2.2.m1.2.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2"><times id="S2.E1Xa.3.2.2.m1.2.2.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.1"></times><apply id="S2.E1Xa.3.2.2.m1.2.2.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.2.2.2.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.2">subscript</csymbol><ci id="S2.E1Xa.3.2.2.m1.2.2.2.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.2.2">𝑄</ci><cn id="S2.E1Xa.3.2.2.m1.2.2.2.2.3.cmml" type="integer" xref="S2.E1Xa.3.2.2.m1.2.2.2.2.3">1</cn></apply><apply id="S2.E1Xa.3.2.2.m1.2.2.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.2.2.2.3.1.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.3">subscript</csymbol><apply id="S2.E1Xa.3.2.2.m1.2.2.2.3.2.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.2.2.2.3.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.3">superscript</csymbol><ci id="S2.E1Xa.3.2.2.m1.2.2.2.3.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.3.2.2">𝐾</ci><ci id="S2.E1Xa.3.2.2.m1.2.2.2.3.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.3.2.3">𝑇</ci></apply><cn id="S2.E1Xa.3.2.2.m1.2.2.2.3.3.cmml" type="integer" xref="S2.E1Xa.3.2.2.m1.2.2.2.3.3">1</cn></apply></apply><apply id="S2.E1Xa.3.2.2.m1.2.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.3"><root id="S2.E1Xa.3.2.2.m1.2.2.3a.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.3"></root><ci id="S2.E1Xa.3.2.2.m1.2.2.3.2.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.3.2">𝑑</ci></apply></apply></apply><apply id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3"><times id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.1"></times><ci id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.2">𝜆</ci><ci id="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.3.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.3">softmax</ci><apply id="S2.E1Xa.3.2.2.m1.3.3.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.4.2"><divide id="S2.E1Xa.3.2.2.m1.3.3.1.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.1.1.1.3.4.2"></divide><apply id="S2.E1Xa.3.2.2.m1.3.3.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2"><times id="S2.E1Xa.3.2.2.m1.3.3.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2.1"></times><apply id="S2.E1Xa.3.2.2.m1.3.3.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.3.3.2.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2.2">subscript</csymbol><ci id="S2.E1Xa.3.2.2.m1.3.3.2.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2.2.2">𝑄</ci><cn id="S2.E1Xa.3.2.2.m1.3.3.2.2.3.cmml" type="integer" xref="S2.E1Xa.3.2.2.m1.3.3.2.2.3">2</cn></apply><apply id="S2.E1Xa.3.2.2.m1.3.3.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2.3"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.3.3.2.3.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2.3">subscript</csymbol><apply id="S2.E1Xa.3.2.2.m1.3.3.2.3.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2.3"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.3.3.2.3.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2.3">superscript</csymbol><ci id="S2.E1Xa.3.2.2.m1.3.3.2.3.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2.3.2.2">𝐾</ci><ci id="S2.E1Xa.3.2.2.m1.3.3.2.3.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.2.3.2.3">𝑇</ci></apply><cn id="S2.E1Xa.3.2.2.m1.3.3.2.3.3.cmml" type="integer" xref="S2.E1Xa.3.2.2.m1.3.3.2.3.3">2</cn></apply></apply><apply id="S2.E1Xa.3.2.2.m1.3.3.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.3"><root id="S2.E1Xa.3.2.2.m1.3.3.3a.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.3"></root><ci id="S2.E1Xa.3.2.2.m1.3.3.3.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.3.2">𝑑</ci></apply></apply></apply></apply><ci id="S2.E1Xa.3.2.2.m1.4.4.1.3.cmml" xref="S2.E1Xa.3.2.2.m1.4.4.1.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1Xa.3.2.2.m1.4c">\displaystyle(X)=(\mathrm{softmax}(\frac{Q_{1}K^{T}_{1}}{\sqrt{d}})-\lambda~{}%
\mathrm{softmax}(\frac{Q_{2}K^{T}_{2}}{\sqrt{d}}))V</annotation><annotation encoding="application/x-llamapun" id="S2.E1Xa.3.2.2.m1.4d">( italic_X ) = ( roman_softmax ( divide start_ARG italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) - italic_λ roman_softmax ( divide start_ARG italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) ) italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.7">where <math alttext="W^{Q},W^{K},W^{V}\in\mathbb{R}^{d_{\text{model}}\times 2d}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m1.3"><semantics id="S2.SS1.p1.5.m1.3a"><mrow id="S2.SS1.p1.5.m1.3.3" xref="S2.SS1.p1.5.m1.3.3.cmml"><mrow id="S2.SS1.p1.5.m1.3.3.3.3" xref="S2.SS1.p1.5.m1.3.3.3.4.cmml"><msup id="S2.SS1.p1.5.m1.1.1.1.1.1" xref="S2.SS1.p1.5.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.5.m1.1.1.1.1.1.2" xref="S2.SS1.p1.5.m1.1.1.1.1.1.2.cmml">W</mi><mi id="S2.SS1.p1.5.m1.1.1.1.1.1.3" xref="S2.SS1.p1.5.m1.1.1.1.1.1.3.cmml">Q</mi></msup><mo id="S2.SS1.p1.5.m1.3.3.3.3.4" xref="S2.SS1.p1.5.m1.3.3.3.4.cmml">,</mo><msup id="S2.SS1.p1.5.m1.2.2.2.2.2" xref="S2.SS1.p1.5.m1.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.5.m1.2.2.2.2.2.2" xref="S2.SS1.p1.5.m1.2.2.2.2.2.2.cmml">W</mi><mi id="S2.SS1.p1.5.m1.2.2.2.2.2.3" xref="S2.SS1.p1.5.m1.2.2.2.2.2.3.cmml">K</mi></msup><mo id="S2.SS1.p1.5.m1.3.3.3.3.5" xref="S2.SS1.p1.5.m1.3.3.3.4.cmml">,</mo><msup id="S2.SS1.p1.5.m1.3.3.3.3.3" xref="S2.SS1.p1.5.m1.3.3.3.3.3.cmml"><mi id="S2.SS1.p1.5.m1.3.3.3.3.3.2" xref="S2.SS1.p1.5.m1.3.3.3.3.3.2.cmml">W</mi><mi id="S2.SS1.p1.5.m1.3.3.3.3.3.3" xref="S2.SS1.p1.5.m1.3.3.3.3.3.3.cmml">V</mi></msup></mrow><mo id="S2.SS1.p1.5.m1.3.3.4" xref="S2.SS1.p1.5.m1.3.3.4.cmml">∈</mo><msup id="S2.SS1.p1.5.m1.3.3.5" xref="S2.SS1.p1.5.m1.3.3.5.cmml"><mi id="S2.SS1.p1.5.m1.3.3.5.2" xref="S2.SS1.p1.5.m1.3.3.5.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.5.m1.3.3.5.3" xref="S2.SS1.p1.5.m1.3.3.5.3.cmml"><mrow id="S2.SS1.p1.5.m1.3.3.5.3.2" xref="S2.SS1.p1.5.m1.3.3.5.3.2.cmml"><msub id="S2.SS1.p1.5.m1.3.3.5.3.2.2" xref="S2.SS1.p1.5.m1.3.3.5.3.2.2.cmml"><mi id="S2.SS1.p1.5.m1.3.3.5.3.2.2.2" xref="S2.SS1.p1.5.m1.3.3.5.3.2.2.2.cmml">d</mi><mtext id="S2.SS1.p1.5.m1.3.3.5.3.2.2.3" xref="S2.SS1.p1.5.m1.3.3.5.3.2.2.3a.cmml">model</mtext></msub><mo id="S2.SS1.p1.5.m1.3.3.5.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.5.m1.3.3.5.3.2.1.cmml">×</mo><mn id="S2.SS1.p1.5.m1.3.3.5.3.2.3" xref="S2.SS1.p1.5.m1.3.3.5.3.2.3.cmml">2</mn></mrow><mo id="S2.SS1.p1.5.m1.3.3.5.3.1" xref="S2.SS1.p1.5.m1.3.3.5.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.5.m1.3.3.5.3.3" xref="S2.SS1.p1.5.m1.3.3.5.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m1.3b"><apply id="S2.SS1.p1.5.m1.3.3.cmml" xref="S2.SS1.p1.5.m1.3.3"><in id="S2.SS1.p1.5.m1.3.3.4.cmml" xref="S2.SS1.p1.5.m1.3.3.4"></in><list id="S2.SS1.p1.5.m1.3.3.3.4.cmml" xref="S2.SS1.p1.5.m1.3.3.3.3"><apply id="S2.SS1.p1.5.m1.1.1.1.1.1.cmml" xref="S2.SS1.p1.5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.5.m1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.5.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.5.m1.1.1.1.1.1.2">𝑊</ci><ci id="S2.SS1.p1.5.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.5.m1.1.1.1.1.1.3">𝑄</ci></apply><apply id="S2.SS1.p1.5.m1.2.2.2.2.2.cmml" xref="S2.SS1.p1.5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m1.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.5.m1.2.2.2.2.2">superscript</csymbol><ci id="S2.SS1.p1.5.m1.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.5.m1.2.2.2.2.2.2">𝑊</ci><ci id="S2.SS1.p1.5.m1.2.2.2.2.2.3.cmml" xref="S2.SS1.p1.5.m1.2.2.2.2.2.3">𝐾</ci></apply><apply id="S2.SS1.p1.5.m1.3.3.3.3.3.cmml" xref="S2.SS1.p1.5.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m1.3.3.3.3.3.1.cmml" xref="S2.SS1.p1.5.m1.3.3.3.3.3">superscript</csymbol><ci id="S2.SS1.p1.5.m1.3.3.3.3.3.2.cmml" xref="S2.SS1.p1.5.m1.3.3.3.3.3.2">𝑊</ci><ci id="S2.SS1.p1.5.m1.3.3.3.3.3.3.cmml" xref="S2.SS1.p1.5.m1.3.3.3.3.3.3">𝑉</ci></apply></list><apply id="S2.SS1.p1.5.m1.3.3.5.cmml" xref="S2.SS1.p1.5.m1.3.3.5"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m1.3.3.5.1.cmml" xref="S2.SS1.p1.5.m1.3.3.5">superscript</csymbol><ci id="S2.SS1.p1.5.m1.3.3.5.2.cmml" xref="S2.SS1.p1.5.m1.3.3.5.2">ℝ</ci><apply id="S2.SS1.p1.5.m1.3.3.5.3.cmml" xref="S2.SS1.p1.5.m1.3.3.5.3"><times id="S2.SS1.p1.5.m1.3.3.5.3.1.cmml" xref="S2.SS1.p1.5.m1.3.3.5.3.1"></times><apply id="S2.SS1.p1.5.m1.3.3.5.3.2.cmml" xref="S2.SS1.p1.5.m1.3.3.5.3.2"><times id="S2.SS1.p1.5.m1.3.3.5.3.2.1.cmml" xref="S2.SS1.p1.5.m1.3.3.5.3.2.1"></times><apply id="S2.SS1.p1.5.m1.3.3.5.3.2.2.cmml" xref="S2.SS1.p1.5.m1.3.3.5.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m1.3.3.5.3.2.2.1.cmml" xref="S2.SS1.p1.5.m1.3.3.5.3.2.2">subscript</csymbol><ci id="S2.SS1.p1.5.m1.3.3.5.3.2.2.2.cmml" xref="S2.SS1.p1.5.m1.3.3.5.3.2.2.2">𝑑</ci><ci id="S2.SS1.p1.5.m1.3.3.5.3.2.2.3a.cmml" xref="S2.SS1.p1.5.m1.3.3.5.3.2.2.3"><mtext id="S2.SS1.p1.5.m1.3.3.5.3.2.2.3.cmml" mathsize="50%" xref="S2.SS1.p1.5.m1.3.3.5.3.2.2.3">model</mtext></ci></apply><cn id="S2.SS1.p1.5.m1.3.3.5.3.2.3.cmml" type="integer" xref="S2.SS1.p1.5.m1.3.3.5.3.2.3">2</cn></apply><ci id="S2.SS1.p1.5.m1.3.3.5.3.3.cmml" xref="S2.SS1.p1.5.m1.3.3.5.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m1.3c">W^{Q},W^{K},W^{V}\in\mathbb{R}^{d_{\text{model}}\times 2d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m1.3d">italic_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × 2 italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are parameters, and <math alttext="\lambda" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m2.1"><semantics id="S2.SS1.p1.6.m2.1a"><mi id="S2.SS1.p1.6.m2.1.1" xref="S2.SS1.p1.6.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m2.1b"><ci id="S2.SS1.p1.6.m2.1.1.cmml" xref="S2.SS1.p1.6.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m2.1d">italic_λ</annotation></semantics></math> is a learnable scalar.
In order to synchronize the learning dynamics, we re-parameterize the scalar <math alttext="\lambda" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m3.1"><semantics id="S2.SS1.p1.7.m3.1a"><mi id="S2.SS1.p1.7.m3.1.1" xref="S2.SS1.p1.7.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m3.1b"><ci id="S2.SS1.p1.7.m3.1.1.cmml" xref="S2.SS1.p1.7.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m3.1d">italic_λ</annotation></semantics></math> as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E2">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E2X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\lambda=\exp(\mathbf{\lambda_{q_{1}}}\cdot\mathbf{\lambda_{k_{1}}%
})-\exp(\mathbf{\lambda_{q_{2}}}\cdot\mathbf{\lambda_{k_{2}}})+\lambda_{\text{%
init}}" class="ltx_Math" display="inline" id="S2.E2X.2.1.1.m1.4"><semantics id="S2.E2X.2.1.1.m1.4a"><mrow id="S2.E2X.2.1.1.m1.4.4" xref="S2.E2X.2.1.1.m1.4.4.cmml"><mi id="S2.E2X.2.1.1.m1.4.4.4" xref="S2.E2X.2.1.1.m1.4.4.4.cmml">λ</mi><mo id="S2.E2X.2.1.1.m1.4.4.3" xref="S2.E2X.2.1.1.m1.4.4.3.cmml">=</mo><mrow id="S2.E2X.2.1.1.m1.4.4.2" xref="S2.E2X.2.1.1.m1.4.4.2.cmml"><mrow id="S2.E2X.2.1.1.m1.4.4.2.2" xref="S2.E2X.2.1.1.m1.4.4.2.2.cmml"><mrow id="S2.E2X.2.1.1.m1.3.3.1.1.1.1" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.2.cmml"><mi id="S2.E2X.2.1.1.m1.1.1" xref="S2.E2X.2.1.1.m1.1.1.cmml">exp</mi><mo id="S2.E2X.2.1.1.m1.3.3.1.1.1.1a" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.2.cmml"><mo id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.2.cmml">(</mo><mrow id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.cmml">λ</mi><msub id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">𝐪</mi><mn id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">𝟏</mn></msub></msub><mo id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.cmml">λ</mi><msub id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.2" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.2.cmml">𝐤</mi><mn id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.3" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.3.cmml">𝟏</mn></msub></msub></mrow><mo id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2X.2.1.1.m1.4.4.2.2.3" xref="S2.E2X.2.1.1.m1.4.4.2.2.3.cmml">−</mo><mrow id="S2.E2X.2.1.1.m1.4.4.2.2.2.1" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.2.cmml"><mi id="S2.E2X.2.1.1.m1.2.2" xref="S2.E2X.2.1.1.m1.2.2.cmml">exp</mi><mo id="S2.E2X.2.1.1.m1.4.4.2.2.2.1a" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.2.cmml">⁡</mo><mrow id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.2.cmml"><mo id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.2" stretchy="false" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.2.cmml">(</mo><mrow id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.cmml"><msub id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.cmml"><mi id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.2" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.2.cmml">λ</mi><msub id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.cmml"><mi id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.2" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.2.cmml">𝐪</mi><mn id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.3" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.3.cmml">𝟐</mn></msub></msub><mo id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.1.cmml">⋅</mo><msub id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.cmml"><mi id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.2" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.2.cmml">λ</mi><msub id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.cmml"><mi id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.2" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.2.cmml">𝐤</mi><mn id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.3" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.3.cmml">𝟐</mn></msub></msub></mrow><mo id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.3" stretchy="false" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2X.2.1.1.m1.4.4.2.3" xref="S2.E2X.2.1.1.m1.4.4.2.3.cmml">+</mo><msub id="S2.E2X.2.1.1.m1.4.4.2.4" xref="S2.E2X.2.1.1.m1.4.4.2.4.cmml"><mi id="S2.E2X.2.1.1.m1.4.4.2.4.2" xref="S2.E2X.2.1.1.m1.4.4.2.4.2.cmml">λ</mi><mtext id="S2.E2X.2.1.1.m1.4.4.2.4.3" xref="S2.E2X.2.1.1.m1.4.4.2.4.3a.cmml">init</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.2.1.1.m1.4b"><apply id="S2.E2X.2.1.1.m1.4.4.cmml" xref="S2.E2X.2.1.1.m1.4.4"><eq id="S2.E2X.2.1.1.m1.4.4.3.cmml" xref="S2.E2X.2.1.1.m1.4.4.3"></eq><ci id="S2.E2X.2.1.1.m1.4.4.4.cmml" xref="S2.E2X.2.1.1.m1.4.4.4">𝜆</ci><apply id="S2.E2X.2.1.1.m1.4.4.2.cmml" xref="S2.E2X.2.1.1.m1.4.4.2"><plus id="S2.E2X.2.1.1.m1.4.4.2.3.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.3"></plus><apply id="S2.E2X.2.1.1.m1.4.4.2.2.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2"><minus id="S2.E2X.2.1.1.m1.4.4.2.2.3.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.3"></minus><apply id="S2.E2X.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1"><exp id="S2.E2X.2.1.1.m1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1"></exp><apply id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1"><ci id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.1">⋅</ci><apply id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2">𝜆</ci><apply id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.2">𝐪</ci><cn id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.2">𝜆</ci><apply id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.2">𝐤</ci><cn id="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.E2X.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S2.E2X.2.1.1.m1.4.4.2.2.2.2.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1"><exp id="S2.E2X.2.1.1.m1.2.2.cmml" xref="S2.E2X.2.1.1.m1.2.2"></exp><apply id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1"><ci id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.1">⋅</ci><apply id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.1.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.2.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.2">𝜆</ci><apply id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.1.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.2.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.2">𝐪</ci><cn id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.3.3">2</cn></apply></apply><apply id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.1.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.2.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.2">𝜆</ci><apply id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.1.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.2.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.2">𝐤</ci><cn id="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S2.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply><apply id="S2.E2X.2.1.1.m1.4.4.2.4.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.4"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.4.4.2.4.1.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.4">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.4.4.2.4.2.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.4.2">𝜆</ci><ci id="S2.E2X.2.1.1.m1.4.4.2.4.3a.cmml" xref="S2.E2X.2.1.1.m1.4.4.2.4.3"><mtext id="S2.E2X.2.1.1.m1.4.4.2.4.3.cmml" mathsize="70%" xref="S2.E2X.2.1.1.m1.4.4.2.4.3">init</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.2.1.1.m1.4c">\displaystyle\lambda=\exp(\mathbf{\lambda_{q_{1}}}\cdot\mathbf{\lambda_{k_{1}}%
})-\exp(\mathbf{\lambda_{q_{2}}}\cdot\mathbf{\lambda_{k_{2}}})+\lambda_{\text{%
init}}</annotation><annotation encoding="application/x-llamapun" id="S2.E2X.2.1.1.m1.4d">italic_λ = roman_exp ( italic_λ start_POSTSUBSCRIPT bold_q start_POSTSUBSCRIPT bold_1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⋅ italic_λ start_POSTSUBSCRIPT bold_k start_POSTSUBSCRIPT bold_1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - roman_exp ( italic_λ start_POSTSUBSCRIPT bold_q start_POSTSUBSCRIPT bold_2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⋅ italic_λ start_POSTSUBSCRIPT bold_k start_POSTSUBSCRIPT bold_2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) + italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.13">where <math alttext="\mathbf{\lambda_{q_{1}}},\mathbf{\lambda_{k_{1}}},\mathbf{\lambda_{q_{2}}},%
\mathbf{\lambda_{k_{2}}}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m1.4"><semantics id="S2.SS1.p1.8.m1.4a"><mrow id="S2.SS1.p1.8.m1.4.4" xref="S2.SS1.p1.8.m1.4.4.cmml"><mrow id="S2.SS1.p1.8.m1.4.4.4.4" xref="S2.SS1.p1.8.m1.4.4.4.5.cmml"><msub id="S2.SS1.p1.8.m1.1.1.1.1.1" xref="S2.SS1.p1.8.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.8.m1.1.1.1.1.1.2" xref="S2.SS1.p1.8.m1.1.1.1.1.1.2.cmml">λ</mi><msub id="S2.SS1.p1.8.m1.1.1.1.1.1.3" xref="S2.SS1.p1.8.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.8.m1.1.1.1.1.1.3.2" xref="S2.SS1.p1.8.m1.1.1.1.1.1.3.2.cmml">𝐪</mi><mn id="S2.SS1.p1.8.m1.1.1.1.1.1.3.3" xref="S2.SS1.p1.8.m1.1.1.1.1.1.3.3.cmml">𝟏</mn></msub></msub><mo id="S2.SS1.p1.8.m1.4.4.4.4.5" xref="S2.SS1.p1.8.m1.4.4.4.5.cmml">,</mo><msub id="S2.SS1.p1.8.m1.2.2.2.2.2" xref="S2.SS1.p1.8.m1.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.8.m1.2.2.2.2.2.2" xref="S2.SS1.p1.8.m1.2.2.2.2.2.2.cmml">λ</mi><msub id="S2.SS1.p1.8.m1.2.2.2.2.2.3" xref="S2.SS1.p1.8.m1.2.2.2.2.2.3.cmml"><mi id="S2.SS1.p1.8.m1.2.2.2.2.2.3.2" xref="S2.SS1.p1.8.m1.2.2.2.2.2.3.2.cmml">𝐤</mi><mn id="S2.SS1.p1.8.m1.2.2.2.2.2.3.3" xref="S2.SS1.p1.8.m1.2.2.2.2.2.3.3.cmml">𝟏</mn></msub></msub><mo id="S2.SS1.p1.8.m1.4.4.4.4.6" xref="S2.SS1.p1.8.m1.4.4.4.5.cmml">,</mo><msub id="S2.SS1.p1.8.m1.3.3.3.3.3" xref="S2.SS1.p1.8.m1.3.3.3.3.3.cmml"><mi id="S2.SS1.p1.8.m1.3.3.3.3.3.2" xref="S2.SS1.p1.8.m1.3.3.3.3.3.2.cmml">λ</mi><msub id="S2.SS1.p1.8.m1.3.3.3.3.3.3" xref="S2.SS1.p1.8.m1.3.3.3.3.3.3.cmml"><mi id="S2.SS1.p1.8.m1.3.3.3.3.3.3.2" xref="S2.SS1.p1.8.m1.3.3.3.3.3.3.2.cmml">𝐪</mi><mn id="S2.SS1.p1.8.m1.3.3.3.3.3.3.3" xref="S2.SS1.p1.8.m1.3.3.3.3.3.3.3.cmml">𝟐</mn></msub></msub><mo id="S2.SS1.p1.8.m1.4.4.4.4.7" xref="S2.SS1.p1.8.m1.4.4.4.5.cmml">,</mo><msub id="S2.SS1.p1.8.m1.4.4.4.4.4" xref="S2.SS1.p1.8.m1.4.4.4.4.4.cmml"><mi id="S2.SS1.p1.8.m1.4.4.4.4.4.2" xref="S2.SS1.p1.8.m1.4.4.4.4.4.2.cmml">λ</mi><msub id="S2.SS1.p1.8.m1.4.4.4.4.4.3" xref="S2.SS1.p1.8.m1.4.4.4.4.4.3.cmml"><mi id="S2.SS1.p1.8.m1.4.4.4.4.4.3.2" xref="S2.SS1.p1.8.m1.4.4.4.4.4.3.2.cmml">𝐤</mi><mn id="S2.SS1.p1.8.m1.4.4.4.4.4.3.3" xref="S2.SS1.p1.8.m1.4.4.4.4.4.3.3.cmml">𝟐</mn></msub></msub></mrow><mo id="S2.SS1.p1.8.m1.4.4.5" xref="S2.SS1.p1.8.m1.4.4.5.cmml">∈</mo><msup id="S2.SS1.p1.8.m1.4.4.6" xref="S2.SS1.p1.8.m1.4.4.6.cmml"><mi id="S2.SS1.p1.8.m1.4.4.6.2" xref="S2.SS1.p1.8.m1.4.4.6.2.cmml">ℝ</mi><mi id="S2.SS1.p1.8.m1.4.4.6.3" xref="S2.SS1.p1.8.m1.4.4.6.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m1.4b"><apply id="S2.SS1.p1.8.m1.4.4.cmml" xref="S2.SS1.p1.8.m1.4.4"><in id="S2.SS1.p1.8.m1.4.4.5.cmml" xref="S2.SS1.p1.8.m1.4.4.5"></in><list id="S2.SS1.p1.8.m1.4.4.4.5.cmml" xref="S2.SS1.p1.8.m1.4.4.4.4"><apply id="S2.SS1.p1.8.m1.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.8.m1.1.1.1.1.1.2">𝜆</ci><apply id="S2.SS1.p1.8.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.8.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.8.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.8.m1.1.1.1.1.1.3.2">𝐪</ci><cn id="S2.SS1.p1.8.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p1.8.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.8.m1.2.2.2.2.2.cmml" xref="S2.SS1.p1.8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.8.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.8.m1.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.8.m1.2.2.2.2.2.2">𝜆</ci><apply id="S2.SS1.p1.8.m1.2.2.2.2.2.3.cmml" xref="S2.SS1.p1.8.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.2.2.2.2.2.3.1.cmml" xref="S2.SS1.p1.8.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.8.m1.2.2.2.2.2.3.2.cmml" xref="S2.SS1.p1.8.m1.2.2.2.2.2.3.2">𝐤</ci><cn id="S2.SS1.p1.8.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S2.SS1.p1.8.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.8.m1.3.3.3.3.3.cmml" xref="S2.SS1.p1.8.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.3.3.3.3.3.1.cmml" xref="S2.SS1.p1.8.m1.3.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.8.m1.3.3.3.3.3.2.cmml" xref="S2.SS1.p1.8.m1.3.3.3.3.3.2">𝜆</ci><apply id="S2.SS1.p1.8.m1.3.3.3.3.3.3.cmml" xref="S2.SS1.p1.8.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.3.3.3.3.3.3.1.cmml" xref="S2.SS1.p1.8.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.8.m1.3.3.3.3.3.3.2.cmml" xref="S2.SS1.p1.8.m1.3.3.3.3.3.3.2">𝐪</ci><cn id="S2.SS1.p1.8.m1.3.3.3.3.3.3.3.cmml" type="integer" xref="S2.SS1.p1.8.m1.3.3.3.3.3.3.3">2</cn></apply></apply><apply id="S2.SS1.p1.8.m1.4.4.4.4.4.cmml" xref="S2.SS1.p1.8.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.4.4.4.4.4.1.cmml" xref="S2.SS1.p1.8.m1.4.4.4.4.4">subscript</csymbol><ci id="S2.SS1.p1.8.m1.4.4.4.4.4.2.cmml" xref="S2.SS1.p1.8.m1.4.4.4.4.4.2">𝜆</ci><apply id="S2.SS1.p1.8.m1.4.4.4.4.4.3.cmml" xref="S2.SS1.p1.8.m1.4.4.4.4.4.3"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.4.4.4.4.4.3.1.cmml" xref="S2.SS1.p1.8.m1.4.4.4.4.4.3">subscript</csymbol><ci id="S2.SS1.p1.8.m1.4.4.4.4.4.3.2.cmml" xref="S2.SS1.p1.8.m1.4.4.4.4.4.3.2">𝐤</ci><cn id="S2.SS1.p1.8.m1.4.4.4.4.4.3.3.cmml" type="integer" xref="S2.SS1.p1.8.m1.4.4.4.4.4.3.3">2</cn></apply></apply></list><apply id="S2.SS1.p1.8.m1.4.4.6.cmml" xref="S2.SS1.p1.8.m1.4.4.6"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.4.4.6.1.cmml" xref="S2.SS1.p1.8.m1.4.4.6">superscript</csymbol><ci id="S2.SS1.p1.8.m1.4.4.6.2.cmml" xref="S2.SS1.p1.8.m1.4.4.6.2">ℝ</ci><ci id="S2.SS1.p1.8.m1.4.4.6.3.cmml" xref="S2.SS1.p1.8.m1.4.4.6.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m1.4c">\mathbf{\lambda_{q_{1}}},\mathbf{\lambda_{k_{1}}},\mathbf{\lambda_{q_{2}}},%
\mathbf{\lambda_{k_{2}}}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m1.4d">italic_λ start_POSTSUBSCRIPT bold_q start_POSTSUBSCRIPT bold_1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT bold_k start_POSTSUBSCRIPT bold_1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT bold_q start_POSTSUBSCRIPT bold_2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT bold_k start_POSTSUBSCRIPT bold_2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable vectors, and <math alttext="\lambda_{\text{init}}\in(0,1)" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m2.2"><semantics id="S2.SS1.p1.9.m2.2a"><mrow id="S2.SS1.p1.9.m2.2.3" xref="S2.SS1.p1.9.m2.2.3.cmml"><msub id="S2.SS1.p1.9.m2.2.3.2" xref="S2.SS1.p1.9.m2.2.3.2.cmml"><mi id="S2.SS1.p1.9.m2.2.3.2.2" xref="S2.SS1.p1.9.m2.2.3.2.2.cmml">λ</mi><mtext id="S2.SS1.p1.9.m2.2.3.2.3" xref="S2.SS1.p1.9.m2.2.3.2.3a.cmml">init</mtext></msub><mo id="S2.SS1.p1.9.m2.2.3.1" xref="S2.SS1.p1.9.m2.2.3.1.cmml">∈</mo><mrow id="S2.SS1.p1.9.m2.2.3.3.2" xref="S2.SS1.p1.9.m2.2.3.3.1.cmml"><mo id="S2.SS1.p1.9.m2.2.3.3.2.1" stretchy="false" xref="S2.SS1.p1.9.m2.2.3.3.1.cmml">(</mo><mn id="S2.SS1.p1.9.m2.1.1" xref="S2.SS1.p1.9.m2.1.1.cmml">0</mn><mo id="S2.SS1.p1.9.m2.2.3.3.2.2" xref="S2.SS1.p1.9.m2.2.3.3.1.cmml">,</mo><mn id="S2.SS1.p1.9.m2.2.2" xref="S2.SS1.p1.9.m2.2.2.cmml">1</mn><mo id="S2.SS1.p1.9.m2.2.3.3.2.3" stretchy="false" xref="S2.SS1.p1.9.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m2.2b"><apply id="S2.SS1.p1.9.m2.2.3.cmml" xref="S2.SS1.p1.9.m2.2.3"><in id="S2.SS1.p1.9.m2.2.3.1.cmml" xref="S2.SS1.p1.9.m2.2.3.1"></in><apply id="S2.SS1.p1.9.m2.2.3.2.cmml" xref="S2.SS1.p1.9.m2.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m2.2.3.2.1.cmml" xref="S2.SS1.p1.9.m2.2.3.2">subscript</csymbol><ci id="S2.SS1.p1.9.m2.2.3.2.2.cmml" xref="S2.SS1.p1.9.m2.2.3.2.2">𝜆</ci><ci id="S2.SS1.p1.9.m2.2.3.2.3a.cmml" xref="S2.SS1.p1.9.m2.2.3.2.3"><mtext id="S2.SS1.p1.9.m2.2.3.2.3.cmml" mathsize="70%" xref="S2.SS1.p1.9.m2.2.3.2.3">init</mtext></ci></apply><interval closure="open" id="S2.SS1.p1.9.m2.2.3.3.1.cmml" xref="S2.SS1.p1.9.m2.2.3.3.2"><cn id="S2.SS1.p1.9.m2.1.1.cmml" type="integer" xref="S2.SS1.p1.9.m2.1.1">0</cn><cn id="S2.SS1.p1.9.m2.2.2.cmml" type="integer" xref="S2.SS1.p1.9.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m2.2c">\lambda_{\text{init}}\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m2.2d">italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT ∈ ( 0 , 1 )</annotation></semantics></math> is a constant used for the initialization of <math alttext="\lambda" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m3.1"><semantics id="S2.SS1.p1.10.m3.1a"><mi id="S2.SS1.p1.10.m3.1.1" xref="S2.SS1.p1.10.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m3.1b"><ci id="S2.SS1.p1.10.m3.1.1.cmml" xref="S2.SS1.p1.10.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m3.1d">italic_λ</annotation></semantics></math>.
We empirically find that the setting <math alttext="\lambda_{\text{init}}=0.8-0.6\times\exp(-0.3\cdot(l-1))" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m4.2"><semantics id="S2.SS1.p1.11.m4.2a"><mrow id="S2.SS1.p1.11.m4.2.2" xref="S2.SS1.p1.11.m4.2.2.cmml"><msub id="S2.SS1.p1.11.m4.2.2.3" xref="S2.SS1.p1.11.m4.2.2.3.cmml"><mi id="S2.SS1.p1.11.m4.2.2.3.2" xref="S2.SS1.p1.11.m4.2.2.3.2.cmml">λ</mi><mtext id="S2.SS1.p1.11.m4.2.2.3.3" xref="S2.SS1.p1.11.m4.2.2.3.3a.cmml">init</mtext></msub><mo id="S2.SS1.p1.11.m4.2.2.2" xref="S2.SS1.p1.11.m4.2.2.2.cmml">=</mo><mrow id="S2.SS1.p1.11.m4.2.2.1" xref="S2.SS1.p1.11.m4.2.2.1.cmml"><mn id="S2.SS1.p1.11.m4.2.2.1.3" xref="S2.SS1.p1.11.m4.2.2.1.3.cmml">0.8</mn><mo id="S2.SS1.p1.11.m4.2.2.1.2" xref="S2.SS1.p1.11.m4.2.2.1.2.cmml">−</mo><mrow id="S2.SS1.p1.11.m4.2.2.1.1" xref="S2.SS1.p1.11.m4.2.2.1.1.cmml"><mn id="S2.SS1.p1.11.m4.2.2.1.1.3" xref="S2.SS1.p1.11.m4.2.2.1.1.3.cmml">0.6</mn><mo id="S2.SS1.p1.11.m4.2.2.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.11.m4.2.2.1.1.2.cmml">×</mo><mrow id="S2.SS1.p1.11.m4.2.2.1.1.1.1" xref="S2.SS1.p1.11.m4.2.2.1.1.1.2.cmml"><mi id="S2.SS1.p1.11.m4.1.1" xref="S2.SS1.p1.11.m4.1.1.cmml">exp</mi><mo id="S2.SS1.p1.11.m4.2.2.1.1.1.1a" xref="S2.SS1.p1.11.m4.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1" xref="S2.SS1.p1.11.m4.2.2.1.1.1.2.cmml"><mo id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.11.m4.2.2.1.1.1.2.cmml">(</mo><mrow id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1a" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.cmml"><mn id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.3.cmml">0.3</mn><mo id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">l</mi><mo id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.11.m4.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m4.2b"><apply id="S2.SS1.p1.11.m4.2.2.cmml" xref="S2.SS1.p1.11.m4.2.2"><eq id="S2.SS1.p1.11.m4.2.2.2.cmml" xref="S2.SS1.p1.11.m4.2.2.2"></eq><apply id="S2.SS1.p1.11.m4.2.2.3.cmml" xref="S2.SS1.p1.11.m4.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m4.2.2.3.1.cmml" xref="S2.SS1.p1.11.m4.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.11.m4.2.2.3.2.cmml" xref="S2.SS1.p1.11.m4.2.2.3.2">𝜆</ci><ci id="S2.SS1.p1.11.m4.2.2.3.3a.cmml" xref="S2.SS1.p1.11.m4.2.2.3.3"><mtext id="S2.SS1.p1.11.m4.2.2.3.3.cmml" mathsize="70%" xref="S2.SS1.p1.11.m4.2.2.3.3">init</mtext></ci></apply><apply id="S2.SS1.p1.11.m4.2.2.1.cmml" xref="S2.SS1.p1.11.m4.2.2.1"><minus id="S2.SS1.p1.11.m4.2.2.1.2.cmml" xref="S2.SS1.p1.11.m4.2.2.1.2"></minus><cn id="S2.SS1.p1.11.m4.2.2.1.3.cmml" type="float" xref="S2.SS1.p1.11.m4.2.2.1.3">0.8</cn><apply id="S2.SS1.p1.11.m4.2.2.1.1.cmml" xref="S2.SS1.p1.11.m4.2.2.1.1"><times id="S2.SS1.p1.11.m4.2.2.1.1.2.cmml" xref="S2.SS1.p1.11.m4.2.2.1.1.2"></times><cn id="S2.SS1.p1.11.m4.2.2.1.1.3.cmml" type="float" xref="S2.SS1.p1.11.m4.2.2.1.1.3">0.6</cn><apply id="S2.SS1.p1.11.m4.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1"><exp id="S2.SS1.p1.11.m4.1.1.cmml" xref="S2.SS1.p1.11.m4.1.1"></exp><apply id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1"><minus id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1"></minus><apply id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1"><ci id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.2">⋅</ci><cn id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.3.cmml" type="float" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.3">0.3</cn><apply id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1"><minus id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑙</ci><cn id="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.11.m4.2.2.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m4.2c">\lambda_{\text{init}}=0.8-0.6\times\exp(-0.3\cdot(l-1))</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m4.2d">italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT = 0.8 - 0.6 × roman_exp ( - 0.3 ⋅ ( italic_l - 1 ) )</annotation></semantics></math> works well in practice, where <math alttext="l\in[1,L]" class="ltx_Math" display="inline" id="S2.SS1.p1.12.m5.2"><semantics id="S2.SS1.p1.12.m5.2a"><mrow id="S2.SS1.p1.12.m5.2.3" xref="S2.SS1.p1.12.m5.2.3.cmml"><mi id="S2.SS1.p1.12.m5.2.3.2" xref="S2.SS1.p1.12.m5.2.3.2.cmml">l</mi><mo id="S2.SS1.p1.12.m5.2.3.1" xref="S2.SS1.p1.12.m5.2.3.1.cmml">∈</mo><mrow id="S2.SS1.p1.12.m5.2.3.3.2" xref="S2.SS1.p1.12.m5.2.3.3.1.cmml"><mo id="S2.SS1.p1.12.m5.2.3.3.2.1" stretchy="false" xref="S2.SS1.p1.12.m5.2.3.3.1.cmml">[</mo><mn id="S2.SS1.p1.12.m5.1.1" xref="S2.SS1.p1.12.m5.1.1.cmml">1</mn><mo id="S2.SS1.p1.12.m5.2.3.3.2.2" xref="S2.SS1.p1.12.m5.2.3.3.1.cmml">,</mo><mi id="S2.SS1.p1.12.m5.2.2" xref="S2.SS1.p1.12.m5.2.2.cmml">L</mi><mo id="S2.SS1.p1.12.m5.2.3.3.2.3" stretchy="false" xref="S2.SS1.p1.12.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m5.2b"><apply id="S2.SS1.p1.12.m5.2.3.cmml" xref="S2.SS1.p1.12.m5.2.3"><in id="S2.SS1.p1.12.m5.2.3.1.cmml" xref="S2.SS1.p1.12.m5.2.3.1"></in><ci id="S2.SS1.p1.12.m5.2.3.2.cmml" xref="S2.SS1.p1.12.m5.2.3.2">𝑙</ci><interval closure="closed" id="S2.SS1.p1.12.m5.2.3.3.1.cmml" xref="S2.SS1.p1.12.m5.2.3.3.2"><cn id="S2.SS1.p1.12.m5.1.1.cmml" type="integer" xref="S2.SS1.p1.12.m5.1.1">1</cn><ci id="S2.SS1.p1.12.m5.2.2.cmml" xref="S2.SS1.p1.12.m5.2.2">𝐿</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m5.2c">l\in[1,L]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m5.2d">italic_l ∈ [ 1 , italic_L ]</annotation></semantics></math> represents layer index.
It is used as the default strategy in our experiments.
We also explore using the same <math alttext="\lambda_{\text{init}}" class="ltx_Math" display="inline" id="S2.SS1.p1.13.m6.1"><semantics id="S2.SS1.p1.13.m6.1a"><msub id="S2.SS1.p1.13.m6.1.1" xref="S2.SS1.p1.13.m6.1.1.cmml"><mi id="S2.SS1.p1.13.m6.1.1.2" xref="S2.SS1.p1.13.m6.1.1.2.cmml">λ</mi><mtext id="S2.SS1.p1.13.m6.1.1.3" xref="S2.SS1.p1.13.m6.1.1.3a.cmml">init</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m6.1b"><apply id="S2.SS1.p1.13.m6.1.1.cmml" xref="S2.SS1.p1.13.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m6.1.1.1.cmml" xref="S2.SS1.p1.13.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.13.m6.1.1.2.cmml" xref="S2.SS1.p1.13.m6.1.1.2">𝜆</ci><ci id="S2.SS1.p1.13.m6.1.1.3a.cmml" xref="S2.SS1.p1.13.m6.1.1.3"><mtext id="S2.SS1.p1.13.m6.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p1.13.m6.1.1.3">init</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m6.1c">\lambda_{\text{init}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.13.m6.1d">italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math> (e.g., 0.8) for all layers as another initialization strategy. As shown in the ablation studies (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS8" title="3.8 Ablation Studies ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.8</span></a>), the performance is relatively robust to different initialization strategies.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Differential attention takes the difference between two <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">roman_softmax</annotation></semantics></math> attention functions to eliminate attention noise.
The idea is analogous to differential amplifiers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib19" title="">19</a>]</cite> proposed in electrical engineering, where the difference between two signals is used as output, so that we can null out the common-mode noise of the input.
In addition, the design of noise-canceling headphones is based on a similar idea.
We can directly reuse FlashAttention&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib8" title="">8</a>]</cite> as described in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A1" title="Appendix A Implementation of Differential Attention ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">A</span></a>, which significantly improves model efficiency.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Multi-Head Differential Attention</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p1.3">We also use the multi-head mechanism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib41" title="">41</a>]</cite> in Differential Transformer.
Let <math alttext="h" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S2.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.1.m1.1d">italic_h</annotation></semantics></math> denote the number of attention heads. We use different projection matrices <math alttext="W_{i}^{Q},W_{i}^{K},W_{i}^{V},i\in[1,h]" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.2.m2.6"><semantics id="S2.SS1.SSS0.Px1.p1.2.m2.6a"><mrow id="S2.SS1.SSS0.Px1.p1.2.m2.6.6" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.cmml"><mrow id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.4.cmml"><msubsup id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.2.cmml">W</mi><mi id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.3.cmml">i</mi><mi id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.cmml">Q</mi></msubsup><mo id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.4" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.4.cmml">,</mo><msubsup id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.cmml"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.2.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.2.2.cmml">W</mi><mi id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.2.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.2.3.cmml">i</mi><mi id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.3.cmml">K</mi></msubsup><mo id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.5" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.4.cmml">,</mo><msubsup id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.2.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.2.2.cmml">W</mi><mi id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.2.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.2.3.cmml">i</mi><mi id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.3.cmml">V</mi></msubsup><mo id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.6" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.4.cmml">,</mo><mi id="S2.SS1.SSS0.Px1.p1.2.m2.3.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3.cmml">i</mi></mrow><mo id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.4" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.4.cmml">∈</mo><mrow id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.5.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.5.1.cmml"><mo id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.5.2.1" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.5.1.cmml">[</mo><mn id="S2.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">1</mn><mo id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.5.2.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.5.1.cmml">,</mo><mi id="S2.SS1.SSS0.Px1.p1.2.m2.2.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2.cmml">h</mi><mo id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.5.2.3" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.5.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.2.m2.6b"><apply id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6"><in id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.4.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.4"></in><list id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.4.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3"><apply id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1">superscript</csymbol><apply id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.2">𝑊</ci><ci id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.1.1.1.3">𝑄</ci></apply><apply id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2">superscript</csymbol><apply id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.2.2">𝑊</ci><ci id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.2.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.2.3">𝑖</ci></apply><ci id="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.5.5.2.2.2.3">𝐾</ci></apply><apply id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3">superscript</csymbol><apply id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.2.2">𝑊</ci><ci id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.2.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.2.3">𝑖</ci></apply><ci id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.3.3.3.3">𝑉</ci></apply><ci id="S2.SS1.SSS0.Px1.p1.2.m2.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3">𝑖</ci></list><interval closure="closed" id="S2.SS1.SSS0.Px1.p1.2.m2.6.6.5.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.6.6.5.2"><cn id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1">1</cn><ci id="S2.SS1.SSS0.Px1.p1.2.m2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2">ℎ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.2.m2.6c">W_{i}^{Q},W_{i}^{K},W_{i}^{V},i\in[1,h]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.2.m2.6d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT , italic_i ∈ [ 1 , italic_h ]</annotation></semantics></math> for the heads.
The scalar <math alttext="\lambda" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS1.SSS0.Px1.p1.3.m3.1a"><mi id="S2.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.3.m3.1b"><ci id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.3.m3.1d">italic_λ</annotation></semantics></math> is shared between heads within the same layer.
Then the head outputs are normalized and projected to the final results as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{head}_{i}" class="ltx_Math" display="inline" id="S2.E3X.2.1.1.m1.1"><semantics id="S2.E3X.2.1.1.m1.1a"><msub id="S2.E3X.2.1.1.m1.1.1" xref="S2.E3X.2.1.1.m1.1.1.cmml"><mi id="S2.E3X.2.1.1.m1.1.1.2" xref="S2.E3X.2.1.1.m1.1.1.2.cmml">head</mi><mi id="S2.E3X.2.1.1.m1.1.1.3" xref="S2.E3X.2.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E3X.2.1.1.m1.1b"><apply id="S2.E3X.2.1.1.m1.1.1.cmml" xref="S2.E3X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E3X.2.1.1.m1.1.1.1.cmml" xref="S2.E3X.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E3X.2.1.1.m1.1.1.2.cmml" xref="S2.E3X.2.1.1.m1.1.1.2">head</ci><ci id="S2.E3X.2.1.1.m1.1.1.3.cmml" xref="S2.E3X.2.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.2.1.1.m1.1c">\displaystyle\mathrm{head}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.2.1.1.m1.1d">roman_head start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{DiffAttn}(X;W_{i}^{Q},W_{i}^{K},W_{i}^{V},\lambda)" class="ltx_Math" display="inline" id="S2.E3X.3.2.2.m1.6"><semantics id="S2.E3X.3.2.2.m1.6a"><mrow id="S2.E3X.3.2.2.m1.6.6" xref="S2.E3X.3.2.2.m1.6.6.cmml"><mi id="S2.E3X.3.2.2.m1.6.6.5" xref="S2.E3X.3.2.2.m1.6.6.5.cmml"></mi><mo id="S2.E3X.3.2.2.m1.6.6.4" xref="S2.E3X.3.2.2.m1.6.6.4.cmml">=</mo><mrow id="S2.E3X.3.2.2.m1.6.6.3.3" xref="S2.E3X.3.2.2.m1.6.6.3.4.cmml"><mi id="S2.E3X.3.2.2.m1.1.1" xref="S2.E3X.3.2.2.m1.1.1.cmml">DiffAttn</mi><mo id="S2.E3X.3.2.2.m1.6.6.3.3a" xref="S2.E3X.3.2.2.m1.6.6.3.4.cmml">⁡</mo><mrow id="S2.E3X.3.2.2.m1.6.6.3.3.3" xref="S2.E3X.3.2.2.m1.6.6.3.4.cmml"><mo id="S2.E3X.3.2.2.m1.6.6.3.3.3.4" stretchy="false" xref="S2.E3X.3.2.2.m1.6.6.3.4.cmml">(</mo><mi id="S2.E3X.3.2.2.m1.2.2" xref="S2.E3X.3.2.2.m1.2.2.cmml">X</mi><mo id="S2.E3X.3.2.2.m1.6.6.3.3.3.5" xref="S2.E3X.3.2.2.m1.6.6.3.4.cmml">;</mo><msubsup id="S2.E3X.3.2.2.m1.4.4.1.1.1.1" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1.cmml"><mi id="S2.E3X.3.2.2.m1.4.4.1.1.1.1.2.2" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1.2.2.cmml">W</mi><mi id="S2.E3X.3.2.2.m1.4.4.1.1.1.1.2.3" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1.2.3.cmml">i</mi><mi id="S2.E3X.3.2.2.m1.4.4.1.1.1.1.3" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1.3.cmml">Q</mi></msubsup><mo id="S2.E3X.3.2.2.m1.6.6.3.3.3.6" xref="S2.E3X.3.2.2.m1.6.6.3.4.cmml">,</mo><msubsup id="S2.E3X.3.2.2.m1.5.5.2.2.2.2" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2.cmml"><mi id="S2.E3X.3.2.2.m1.5.5.2.2.2.2.2.2" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2.2.2.cmml">W</mi><mi id="S2.E3X.3.2.2.m1.5.5.2.2.2.2.2.3" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2.2.3.cmml">i</mi><mi id="S2.E3X.3.2.2.m1.5.5.2.2.2.2.3" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2.3.cmml">K</mi></msubsup><mo id="S2.E3X.3.2.2.m1.6.6.3.3.3.7" xref="S2.E3X.3.2.2.m1.6.6.3.4.cmml">,</mo><msubsup id="S2.E3X.3.2.2.m1.6.6.3.3.3.3" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3.cmml"><mi id="S2.E3X.3.2.2.m1.6.6.3.3.3.3.2.2" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3.2.2.cmml">W</mi><mi id="S2.E3X.3.2.2.m1.6.6.3.3.3.3.2.3" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3.2.3.cmml">i</mi><mi id="S2.E3X.3.2.2.m1.6.6.3.3.3.3.3" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3.3.cmml">V</mi></msubsup><mo id="S2.E3X.3.2.2.m1.6.6.3.3.3.8" xref="S2.E3X.3.2.2.m1.6.6.3.4.cmml">,</mo><mi id="S2.E3X.3.2.2.m1.3.3" xref="S2.E3X.3.2.2.m1.3.3.cmml">λ</mi><mo id="S2.E3X.3.2.2.m1.6.6.3.3.3.9" stretchy="false" xref="S2.E3X.3.2.2.m1.6.6.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3X.3.2.2.m1.6b"><apply id="S2.E3X.3.2.2.m1.6.6.cmml" xref="S2.E3X.3.2.2.m1.6.6"><eq id="S2.E3X.3.2.2.m1.6.6.4.cmml" xref="S2.E3X.3.2.2.m1.6.6.4"></eq><csymbol cd="latexml" id="S2.E3X.3.2.2.m1.6.6.5.cmml" xref="S2.E3X.3.2.2.m1.6.6.5">absent</csymbol><apply id="S2.E3X.3.2.2.m1.6.6.3.4.cmml" xref="S2.E3X.3.2.2.m1.6.6.3.3"><ci id="S2.E3X.3.2.2.m1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1">DiffAttn</ci><ci id="S2.E3X.3.2.2.m1.2.2.cmml" xref="S2.E3X.3.2.2.m1.2.2">𝑋</ci><apply id="S2.E3X.3.2.2.m1.4.4.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.4.4.1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1">superscript</csymbol><apply id="S2.E3X.3.2.2.m1.4.4.1.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.4.4.1.1.1.1.2.1.cmml" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.4.4.1.1.1.1.2.2.cmml" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1.2.2">𝑊</ci><ci id="S2.E3X.3.2.2.m1.4.4.1.1.1.1.2.3.cmml" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E3X.3.2.2.m1.4.4.1.1.1.1.3.cmml" xref="S2.E3X.3.2.2.m1.4.4.1.1.1.1.3">𝑄</ci></apply><apply id="S2.E3X.3.2.2.m1.5.5.2.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.2.2.2.2.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2">superscript</csymbol><apply id="S2.E3X.3.2.2.m1.5.5.2.2.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.2.2.2.2.2.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.5.5.2.2.2.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2.2.2">𝑊</ci><ci id="S2.E3X.3.2.2.m1.5.5.2.2.2.2.2.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.E3X.3.2.2.m1.5.5.2.2.2.2.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.2.2.2.2.3">𝐾</ci></apply><apply id="S2.E3X.3.2.2.m1.6.6.3.3.3.3.cmml" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.6.6.3.3.3.3.1.cmml" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3">superscript</csymbol><apply id="S2.E3X.3.2.2.m1.6.6.3.3.3.3.2.cmml" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.6.6.3.3.3.3.2.1.cmml" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.6.6.3.3.3.3.2.2.cmml" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3.2.2">𝑊</ci><ci id="S2.E3X.3.2.2.m1.6.6.3.3.3.3.2.3.cmml" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3.2.3">𝑖</ci></apply><ci id="S2.E3X.3.2.2.m1.6.6.3.3.3.3.3.cmml" xref="S2.E3X.3.2.2.m1.6.6.3.3.3.3.3">𝑉</ci></apply><ci id="S2.E3X.3.2.2.m1.3.3.cmml" xref="S2.E3X.3.2.2.m1.3.3">𝜆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.3.2.2.m1.6c">\displaystyle=\operatorname{DiffAttn}(X;W_{i}^{Q},W_{i}^{K},W_{i}^{V},\lambda)</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.3.2.2.m1.6d">= roman_DiffAttn ( italic_X ; italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT , italic_λ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\overline{{\mathrm{head}_{i}}}" class="ltx_Math" display="inline" id="S2.E3Xa.2.1.1.m1.1"><semantics id="S2.E3Xa.2.1.1.m1.1a"><mover accent="true" id="S2.E3Xa.2.1.1.m1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.cmml"><msub id="S2.E3Xa.2.1.1.m1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.2.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.2.2" xref="S2.E3Xa.2.1.1.m1.1.1.2.2.cmml">head</mi><mi id="S2.E3Xa.2.1.1.m1.1.1.2.3" xref="S2.E3Xa.2.1.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.E3Xa.2.1.1.m1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S2.E3Xa.2.1.1.m1.1b"><apply id="S2.E3Xa.2.1.1.m1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1"><ci id="S2.E3Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1">¯</ci><apply id="S2.E3Xa.2.1.1.m1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.2.2">head</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xa.2.1.1.m1.1c">\displaystyle\overline{{\mathrm{head}_{i}}}</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xa.2.1.1.m1.1d">over¯ start_ARG roman_head start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(1-\lambda_{\text{init}})\cdot\operatorname{LN}(\mathrm{head}_{i})" class="ltx_Math" display="inline" id="S2.E3Xa.3.2.2.m1.3"><semantics id="S2.E3Xa.3.2.2.m1.3a"><mrow id="S2.E3Xa.3.2.2.m1.3.3" xref="S2.E3Xa.3.2.2.m1.3.3.cmml"><mi id="S2.E3Xa.3.2.2.m1.3.3.4" xref="S2.E3Xa.3.2.2.m1.3.3.4.cmml"></mi><mo id="S2.E3Xa.3.2.2.m1.3.3.3" xref="S2.E3Xa.3.2.2.m1.3.3.3.cmml">=</mo><mrow id="S2.E3Xa.3.2.2.m1.3.3.2" xref="S2.E3Xa.3.2.2.m1.3.3.2.cmml"><mrow id="S2.E3Xa.3.2.2.m1.2.2.1.1.1" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.cmml"><mo id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.2" stretchy="false" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.cmml"><mn id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.2" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml">1</mn><mo id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.1" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml">−</mo><msub id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.cmml"><mi id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.2" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.2.cmml">λ</mi><mtext id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.3" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.3a.cmml">init</mtext></msub></mrow><mo id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3Xa.3.2.2.m1.3.3.2.3" rspace="0.222em" xref="S2.E3Xa.3.2.2.m1.3.3.2.3.cmml">⋅</mo><mrow id="S2.E3Xa.3.2.2.m1.3.3.2.2.1" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.2.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1" xref="S2.E3Xa.3.2.2.m1.1.1.cmml">LN</mi><mo id="S2.E3Xa.3.2.2.m1.3.3.2.2.1a" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.2.cmml">⁡</mo><mrow id="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.2.cmml"><mo id="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.2" stretchy="false" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.2.cmml">(</mo><msub id="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.cmml"><mi id="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.2" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.2.cmml">head</mi><mi id="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.3" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.3" stretchy="false" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xa.3.2.2.m1.3b"><apply id="S2.E3Xa.3.2.2.m1.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.3.3"><eq id="S2.E3Xa.3.2.2.m1.3.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.3.3.3"></eq><csymbol cd="latexml" id="S2.E3Xa.3.2.2.m1.3.3.4.cmml" xref="S2.E3Xa.3.2.2.m1.3.3.4">absent</csymbol><apply id="S2.E3Xa.3.2.2.m1.3.3.2.cmml" xref="S2.E3Xa.3.2.2.m1.3.3.2"><ci id="S2.E3Xa.3.2.2.m1.3.3.2.3.cmml" xref="S2.E3Xa.3.2.2.m1.3.3.2.3">⋅</ci><apply id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1"><minus id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.1"></minus><cn id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml" type="integer" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.2">1</cn><apply id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.2">𝜆</ci><ci id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.3a.cmml" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.3"><mtext id="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.3.cmml" mathsize="70%" xref="S2.E3Xa.3.2.2.m1.2.2.1.1.1.1.3.3">init</mtext></ci></apply></apply><apply id="S2.E3Xa.3.2.2.m1.3.3.2.2.2.cmml" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.1"><ci id="S2.E3Xa.3.2.2.m1.1.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1">LN</ci><apply id="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.cmml" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.1.cmml" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1">subscript</csymbol><ci id="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.2.cmml" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.2">head</ci><ci id="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.3.cmml" xref="S2.E3Xa.3.2.2.m1.3.3.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xa.3.2.2.m1.3c">\displaystyle=(1-\lambda_{\text{init}})\cdot\operatorname{LN}(\mathrm{head}_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xa.3.2.2.m1.3d">= ( 1 - italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT ) ⋅ roman_LN ( roman_head start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\operatorname{MultiHead}(X)" class="ltx_Math" display="inline" id="S2.E3Xb.2.1.1.m1.2"><semantics id="S2.E3Xb.2.1.1.m1.2a"><mrow id="S2.E3Xb.2.1.1.m1.2.3.2" xref="S2.E3Xb.2.1.1.m1.2.3.1.cmml"><mi id="S2.E3Xb.2.1.1.m1.1.1" xref="S2.E3Xb.2.1.1.m1.1.1.cmml">MultiHead</mi><mo id="S2.E3Xb.2.1.1.m1.2.3.2a" xref="S2.E3Xb.2.1.1.m1.2.3.1.cmml">⁡</mo><mrow id="S2.E3Xb.2.1.1.m1.2.3.2.1" xref="S2.E3Xb.2.1.1.m1.2.3.1.cmml"><mo id="S2.E3Xb.2.1.1.m1.2.3.2.1.1" stretchy="false" xref="S2.E3Xb.2.1.1.m1.2.3.1.cmml">(</mo><mi id="S2.E3Xb.2.1.1.m1.2.2" xref="S2.E3Xb.2.1.1.m1.2.2.cmml">X</mi><mo id="S2.E3Xb.2.1.1.m1.2.3.2.1.2" stretchy="false" xref="S2.E3Xb.2.1.1.m1.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xb.2.1.1.m1.2b"><apply id="S2.E3Xb.2.1.1.m1.2.3.1.cmml" xref="S2.E3Xb.2.1.1.m1.2.3.2"><ci id="S2.E3Xb.2.1.1.m1.1.1.cmml" xref="S2.E3Xb.2.1.1.m1.1.1">MultiHead</ci><ci id="S2.E3Xb.2.1.1.m1.2.2.cmml" xref="S2.E3Xb.2.1.1.m1.2.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xb.2.1.1.m1.2c">\displaystyle\operatorname{MultiHead}(X)</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xb.2.1.1.m1.2d">roman_MultiHead ( italic_X )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Concat}(\overline{{\mathrm{head}_{1}}},\cdots,%
\overline{{\mathrm{head}_{h}}})W^{O}" class="ltx_Math" display="inline" id="S2.E3Xb.3.2.2.m1.4"><semantics id="S2.E3Xb.3.2.2.m1.4a"><mrow id="S2.E3Xb.3.2.2.m1.4.5" xref="S2.E3Xb.3.2.2.m1.4.5.cmml"><mi id="S2.E3Xb.3.2.2.m1.4.5.2" xref="S2.E3Xb.3.2.2.m1.4.5.2.cmml"></mi><mo id="S2.E3Xb.3.2.2.m1.4.5.1" xref="S2.E3Xb.3.2.2.m1.4.5.1.cmml">=</mo><mrow id="S2.E3Xb.3.2.2.m1.4.5.3" xref="S2.E3Xb.3.2.2.m1.4.5.3.cmml"><mrow id="S2.E3Xb.3.2.2.m1.4.5.3.2.2" xref="S2.E3Xb.3.2.2.m1.4.5.3.2.1.cmml"><mi id="S2.E3Xb.3.2.2.m1.1.1" xref="S2.E3Xb.3.2.2.m1.1.1.cmml">Concat</mi><mo id="S2.E3Xb.3.2.2.m1.4.5.3.2.2a" xref="S2.E3Xb.3.2.2.m1.4.5.3.2.1.cmml">⁡</mo><mrow id="S2.E3Xb.3.2.2.m1.4.5.3.2.2.1" xref="S2.E3Xb.3.2.2.m1.4.5.3.2.1.cmml"><mo id="S2.E3Xb.3.2.2.m1.4.5.3.2.2.1.1" stretchy="false" xref="S2.E3Xb.3.2.2.m1.4.5.3.2.1.cmml">(</mo><mover accent="true" id="S2.E3Xb.3.2.2.m1.2.2" xref="S2.E3Xb.3.2.2.m1.2.2.cmml"><msub id="S2.E3Xb.3.2.2.m1.2.2.2" xref="S2.E3Xb.3.2.2.m1.2.2.2.cmml"><mi id="S2.E3Xb.3.2.2.m1.2.2.2.2" xref="S2.E3Xb.3.2.2.m1.2.2.2.2.cmml">head</mi><mn id="S2.E3Xb.3.2.2.m1.2.2.2.3" xref="S2.E3Xb.3.2.2.m1.2.2.2.3.cmml">1</mn></msub><mo id="S2.E3Xb.3.2.2.m1.2.2.1" xref="S2.E3Xb.3.2.2.m1.2.2.1.cmml">¯</mo></mover><mo id="S2.E3Xb.3.2.2.m1.4.5.3.2.2.1.2" xref="S2.E3Xb.3.2.2.m1.4.5.3.2.1.cmml">,</mo><mi id="S2.E3Xb.3.2.2.m1.3.3" mathvariant="normal" xref="S2.E3Xb.3.2.2.m1.3.3.cmml">⋯</mi><mo id="S2.E3Xb.3.2.2.m1.4.5.3.2.2.1.3" xref="S2.E3Xb.3.2.2.m1.4.5.3.2.1.cmml">,</mo><mover accent="true" id="S2.E3Xb.3.2.2.m1.4.4" xref="S2.E3Xb.3.2.2.m1.4.4.cmml"><msub id="S2.E3Xb.3.2.2.m1.4.4.2" xref="S2.E3Xb.3.2.2.m1.4.4.2.cmml"><mi id="S2.E3Xb.3.2.2.m1.4.4.2.2" xref="S2.E3Xb.3.2.2.m1.4.4.2.2.cmml">head</mi><mi id="S2.E3Xb.3.2.2.m1.4.4.2.3" xref="S2.E3Xb.3.2.2.m1.4.4.2.3.cmml">h</mi></msub><mo id="S2.E3Xb.3.2.2.m1.4.4.1" xref="S2.E3Xb.3.2.2.m1.4.4.1.cmml">¯</mo></mover><mo id="S2.E3Xb.3.2.2.m1.4.5.3.2.2.1.4" stretchy="false" xref="S2.E3Xb.3.2.2.m1.4.5.3.2.1.cmml">)</mo></mrow></mrow><mo id="S2.E3Xb.3.2.2.m1.4.5.3.1" xref="S2.E3Xb.3.2.2.m1.4.5.3.1.cmml">⁢</mo><msup id="S2.E3Xb.3.2.2.m1.4.5.3.3" xref="S2.E3Xb.3.2.2.m1.4.5.3.3.cmml"><mi id="S2.E3Xb.3.2.2.m1.4.5.3.3.2" xref="S2.E3Xb.3.2.2.m1.4.5.3.3.2.cmml">W</mi><mi id="S2.E3Xb.3.2.2.m1.4.5.3.3.3" xref="S2.E3Xb.3.2.2.m1.4.5.3.3.3.cmml">O</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xb.3.2.2.m1.4b"><apply id="S2.E3Xb.3.2.2.m1.4.5.cmml" xref="S2.E3Xb.3.2.2.m1.4.5"><eq id="S2.E3Xb.3.2.2.m1.4.5.1.cmml" xref="S2.E3Xb.3.2.2.m1.4.5.1"></eq><csymbol cd="latexml" id="S2.E3Xb.3.2.2.m1.4.5.2.cmml" xref="S2.E3Xb.3.2.2.m1.4.5.2">absent</csymbol><apply id="S2.E3Xb.3.2.2.m1.4.5.3.cmml" xref="S2.E3Xb.3.2.2.m1.4.5.3"><times id="S2.E3Xb.3.2.2.m1.4.5.3.1.cmml" xref="S2.E3Xb.3.2.2.m1.4.5.3.1"></times><apply id="S2.E3Xb.3.2.2.m1.4.5.3.2.1.cmml" xref="S2.E3Xb.3.2.2.m1.4.5.3.2.2"><ci id="S2.E3Xb.3.2.2.m1.1.1.cmml" xref="S2.E3Xb.3.2.2.m1.1.1">Concat</ci><apply id="S2.E3Xb.3.2.2.m1.2.2.cmml" xref="S2.E3Xb.3.2.2.m1.2.2"><ci id="S2.E3Xb.3.2.2.m1.2.2.1.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1">¯</ci><apply id="S2.E3Xb.3.2.2.m1.2.2.2.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.2"><csymbol cd="ambiguous" id="S2.E3Xb.3.2.2.m1.2.2.2.1.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.2">subscript</csymbol><ci id="S2.E3Xb.3.2.2.m1.2.2.2.2.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.2.2">head</ci><cn id="S2.E3Xb.3.2.2.m1.2.2.2.3.cmml" type="integer" xref="S2.E3Xb.3.2.2.m1.2.2.2.3">1</cn></apply></apply><ci id="S2.E3Xb.3.2.2.m1.3.3.cmml" xref="S2.E3Xb.3.2.2.m1.3.3">⋯</ci><apply id="S2.E3Xb.3.2.2.m1.4.4.cmml" xref="S2.E3Xb.3.2.2.m1.4.4"><ci id="S2.E3Xb.3.2.2.m1.4.4.1.cmml" xref="S2.E3Xb.3.2.2.m1.4.4.1">¯</ci><apply id="S2.E3Xb.3.2.2.m1.4.4.2.cmml" xref="S2.E3Xb.3.2.2.m1.4.4.2"><csymbol cd="ambiguous" id="S2.E3Xb.3.2.2.m1.4.4.2.1.cmml" xref="S2.E3Xb.3.2.2.m1.4.4.2">subscript</csymbol><ci id="S2.E3Xb.3.2.2.m1.4.4.2.2.cmml" xref="S2.E3Xb.3.2.2.m1.4.4.2.2">head</ci><ci id="S2.E3Xb.3.2.2.m1.4.4.2.3.cmml" xref="S2.E3Xb.3.2.2.m1.4.4.2.3">ℎ</ci></apply></apply></apply><apply id="S2.E3Xb.3.2.2.m1.4.5.3.3.cmml" xref="S2.E3Xb.3.2.2.m1.4.5.3.3"><csymbol cd="ambiguous" id="S2.E3Xb.3.2.2.m1.4.5.3.3.1.cmml" xref="S2.E3Xb.3.2.2.m1.4.5.3.3">superscript</csymbol><ci id="S2.E3Xb.3.2.2.m1.4.5.3.3.2.cmml" xref="S2.E3Xb.3.2.2.m1.4.5.3.3.2">𝑊</ci><ci id="S2.E3Xb.3.2.2.m1.4.5.3.3.3.cmml" xref="S2.E3Xb.3.2.2.m1.4.5.3.3.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xb.3.2.2.m1.4c">\displaystyle=\operatorname{Concat}(\overline{{\mathrm{head}_{1}}},\cdots,%
\overline{{\mathrm{head}_{h}}})W^{O}</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xb.3.2.2.m1.4d">= roman_Concat ( over¯ start_ARG roman_head start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG , ⋯ , over¯ start_ARG roman_head start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_ARG ) italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p1.11">where <math alttext="\lambda_{\text{init}}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.4.m1.1"><semantics id="S2.SS1.SSS0.Px1.p1.4.m1.1a"><msub id="S2.SS1.SSS0.Px1.p1.4.m1.1.1" xref="S2.SS1.SSS0.Px1.p1.4.m1.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.4.m1.1.1.2" xref="S2.SS1.SSS0.Px1.p1.4.m1.1.1.2.cmml">λ</mi><mtext id="S2.SS1.SSS0.Px1.p1.4.m1.1.1.3" xref="S2.SS1.SSS0.Px1.p1.4.m1.1.1.3a.cmml">init</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.4.m1.1b"><apply id="S2.SS1.SSS0.Px1.p1.4.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.4.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.4.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m1.1.1.2">𝜆</ci><ci id="S2.SS1.SSS0.Px1.p1.4.m1.1.1.3a.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m1.1.1.3"><mtext id="S2.SS1.SSS0.Px1.p1.4.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS1.SSS0.Px1.p1.4.m1.1.1.3">init</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.4.m1.1c">\lambda_{\text{init}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.4.m1.1d">italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math> is the constant scalar in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S2.E2" title="In 2.1 Differential Attention ‣ 2 Differential Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Equation</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a>, <math alttext="W^{O}\in\mathbb{R}^{d_{\text{model}}\times d_{\text{model}}}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.5.m2.1"><semantics id="S2.SS1.SSS0.Px1.p1.5.m2.1a"><mrow id="S2.SS1.SSS0.Px1.p1.5.m2.1.1" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.cmml"><msup id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.cmml"><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.2.cmml">W</mi><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.3.cmml">O</mi></msup><mo id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.1" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.1.cmml">∈</mo><msup id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.cmml"><msub id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.cmml"><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.2.cmml">d</mi><mtext id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.3a.cmml">model</mtext></msub><mo id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.2.cmml">d</mi><mtext id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.5.m2.1b"><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1"><in id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.1"></in><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2">superscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.2">𝑊</ci><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.3.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.3">𝑂</ci></apply><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3">superscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.2">ℝ</ci><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3"><times id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.1"></times><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.2">𝑑</ci><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.3a.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.3"><mtext id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.3.cmml" mathsize="50%" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.3">model</mtext></ci></apply><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.2">𝑑</ci><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.3a.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.3"><mtext id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.3.cmml" mathsize="50%" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.5.m2.1c">W^{O}\in\mathbb{R}^{d_{\text{model}}\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.5.m2.1d">italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is a learnable projection matrix, <math alttext="\operatorname{LN}(\cdot)" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.6.m3.2"><semantics id="S2.SS1.SSS0.Px1.p1.6.m3.2a"><mrow id="S2.SS1.SSS0.Px1.p1.6.m3.2.3.2" xref="S2.SS1.SSS0.Px1.p1.6.m3.2.3.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.6.m3.1.1" xref="S2.SS1.SSS0.Px1.p1.6.m3.1.1.cmml">LN</mi><mo id="S2.SS1.SSS0.Px1.p1.6.m3.2.3.2a" xref="S2.SS1.SSS0.Px1.p1.6.m3.2.3.1.cmml">⁡</mo><mrow id="S2.SS1.SSS0.Px1.p1.6.m3.2.3.2.1" xref="S2.SS1.SSS0.Px1.p1.6.m3.2.3.1.cmml"><mo id="S2.SS1.SSS0.Px1.p1.6.m3.2.3.2.1.1" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.6.m3.2.3.1.cmml">(</mo><mo id="S2.SS1.SSS0.Px1.p1.6.m3.2.2" lspace="0em" rspace="0em" xref="S2.SS1.SSS0.Px1.p1.6.m3.2.2.cmml">⋅</mo><mo id="S2.SS1.SSS0.Px1.p1.6.m3.2.3.2.1.2" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.6.m3.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.6.m3.2b"><apply id="S2.SS1.SSS0.Px1.p1.6.m3.2.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m3.2.3.2"><ci id="S2.SS1.SSS0.Px1.p1.6.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m3.1.1">LN</ci><ci id="S2.SS1.SSS0.Px1.p1.6.m3.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m3.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.6.m3.2c">\operatorname{LN}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.6.m3.2d">roman_LN ( ⋅ )</annotation></semantics></math> uses RMSNorm&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib46" title="">46</a>]</cite> for each head, and <math alttext="\operatorname{Concat}(\cdot)" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.7.m4.2"><semantics id="S2.SS1.SSS0.Px1.p1.7.m4.2a"><mrow id="S2.SS1.SSS0.Px1.p1.7.m4.2.3.2" xref="S2.SS1.SSS0.Px1.p1.7.m4.2.3.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.7.m4.1.1" xref="S2.SS1.SSS0.Px1.p1.7.m4.1.1.cmml">Concat</mi><mo id="S2.SS1.SSS0.Px1.p1.7.m4.2.3.2a" xref="S2.SS1.SSS0.Px1.p1.7.m4.2.3.1.cmml">⁡</mo><mrow id="S2.SS1.SSS0.Px1.p1.7.m4.2.3.2.1" xref="S2.SS1.SSS0.Px1.p1.7.m4.2.3.1.cmml"><mo id="S2.SS1.SSS0.Px1.p1.7.m4.2.3.2.1.1" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.7.m4.2.3.1.cmml">(</mo><mo id="S2.SS1.SSS0.Px1.p1.7.m4.2.2" lspace="0em" rspace="0em" xref="S2.SS1.SSS0.Px1.p1.7.m4.2.2.cmml">⋅</mo><mo id="S2.SS1.SSS0.Px1.p1.7.m4.2.3.2.1.2" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.7.m4.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.7.m4.2b"><apply id="S2.SS1.SSS0.Px1.p1.7.m4.2.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m4.2.3.2"><ci id="S2.SS1.SSS0.Px1.p1.7.m4.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m4.1.1">Concat</ci><ci id="S2.SS1.SSS0.Px1.p1.7.m4.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m4.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.7.m4.2c">\operatorname{Concat}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.7.m4.2d">roman_Concat ( ⋅ )</annotation></semantics></math> concatenates the heads together along the channel dimension.
We use a fixed multiplier <math alttext="(1-\lambda_{\text{init}})" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.8.m5.1"><semantics id="S2.SS1.SSS0.Px1.p1.8.m5.1a"><mrow id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.cmml"><mo id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.2" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.cmml"><mn id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.2" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.2.cmml">1</mn><mo id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.1" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.1.cmml">−</mo><msub id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.2" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.2.cmml">λ</mi><mtext id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.3" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.3a.cmml">init</mtext></msub></mrow><mo id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.3" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.8.m5.1b"><apply id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1"><minus id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.1"></minus><cn id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.2.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.2">1</cn><apply id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.2">𝜆</ci><ci id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.3a.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.3"><mtext id="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.3.cmml" mathsize="70%" xref="S2.SS1.SSS0.Px1.p1.8.m5.1.1.1.1.3.3">init</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.8.m5.1c">(1-\lambda_{\text{init}})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.8.m5.1d">( 1 - italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT )</annotation></semantics></math> as the scale of <math alttext="\operatorname{LN}(\cdot)" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.9.m6.2"><semantics id="S2.SS1.SSS0.Px1.p1.9.m6.2a"><mrow id="S2.SS1.SSS0.Px1.p1.9.m6.2.3.2" xref="S2.SS1.SSS0.Px1.p1.9.m6.2.3.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.9.m6.1.1" xref="S2.SS1.SSS0.Px1.p1.9.m6.1.1.cmml">LN</mi><mo id="S2.SS1.SSS0.Px1.p1.9.m6.2.3.2a" xref="S2.SS1.SSS0.Px1.p1.9.m6.2.3.1.cmml">⁡</mo><mrow id="S2.SS1.SSS0.Px1.p1.9.m6.2.3.2.1" xref="S2.SS1.SSS0.Px1.p1.9.m6.2.3.1.cmml"><mo id="S2.SS1.SSS0.Px1.p1.9.m6.2.3.2.1.1" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.9.m6.2.3.1.cmml">(</mo><mo id="S2.SS1.SSS0.Px1.p1.9.m6.2.2" lspace="0em" rspace="0em" xref="S2.SS1.SSS0.Px1.p1.9.m6.2.2.cmml">⋅</mo><mo id="S2.SS1.SSS0.Px1.p1.9.m6.2.3.2.1.2" stretchy="false" xref="S2.SS1.SSS0.Px1.p1.9.m6.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.9.m6.2b"><apply id="S2.SS1.SSS0.Px1.p1.9.m6.2.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.9.m6.2.3.2"><ci id="S2.SS1.SSS0.Px1.p1.9.m6.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.9.m6.1.1">LN</ci><ci id="S2.SS1.SSS0.Px1.p1.9.m6.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.9.m6.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.9.m6.2c">\operatorname{LN}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.9.m6.2d">roman_LN ( ⋅ )</annotation></semantics></math> to align the gradients with Transformer.
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A6" title="Appendix F Gradient Flow of Diff Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">F</span></a> proves that the overall gradient flow remains similar to that of Transformer. The nice property enables us to directly inherit similar hyperparameters and ensures training stability.
We set the number of heads <math alttext="h=d_{\text{model}}/2d" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.10.m7.1"><semantics id="S2.SS1.SSS0.Px1.p1.10.m7.1a"><mrow id="S2.SS1.SSS0.Px1.p1.10.m7.1.1" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.2" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.2.cmml">h</mi><mo id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.1" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.1.cmml">=</mo><mrow id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.cmml"><mrow id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.cmml"><msub id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.cmml"><mi id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.2" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.2.cmml">d</mi><mtext id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.3" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.3a.cmml">model</mtext></msub><mo id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.1" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.1.cmml">/</mo><mn id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.3" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.3.cmml">2</mn></mrow><mo id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.1" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.3" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.3.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.10.m7.1b"><apply id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1"><eq id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.1"></eq><ci id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.2">ℎ</ci><apply id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3"><times id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.1"></times><apply id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2"><divide id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.1"></divide><apply id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.2">𝑑</ci><ci id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.3a.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.3"><mtext id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.3.cmml" mathsize="70%" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.2.3">model</mtext></ci></apply><cn id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.3.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.2.3">2</cn></apply><ci id="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m7.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.10.m7.1c">h=d_{\text{model}}/2d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.10.m7.1d">italic_h = italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT / 2 italic_d</annotation></semantics></math>, where <math alttext="d" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.11.m8.1"><semantics id="S2.SS1.SSS0.Px1.p1.11.m8.1a"><mi id="S2.SS1.SSS0.Px1.p1.11.m8.1.1" xref="S2.SS1.SSS0.Px1.p1.11.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.11.m8.1b"><ci id="S2.SS1.SSS0.Px1.p1.11.m8.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.11.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.11.m8.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.11.m8.1d">italic_d</annotation></semantics></math> is equal to the head dimension of Transformer. So we can align the parameter counts and computational complexity.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p2.3"><span class="ltx_text ltx_font_bold" id="S2.SS1.SSS0.Px1.p2.3.1">Headwise Normalization</span>&nbsp;&nbsp;
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S2.F2" title="In 2.1 Differential Attention ‣ 2 Differential Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a> uses <math alttext="\operatorname{GroupNorm}(\cdot)" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p2.1.m1.2"><semantics id="S2.SS1.SSS0.Px1.p2.1.m1.2a"><mrow id="S2.SS1.SSS0.Px1.p2.1.m1.2.3.2" xref="S2.SS1.SSS0.Px1.p2.1.m1.2.3.1.cmml"><mi id="S2.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S2.SS1.SSS0.Px1.p2.1.m1.1.1.cmml">GroupNorm</mi><mo id="S2.SS1.SSS0.Px1.p2.1.m1.2.3.2a" xref="S2.SS1.SSS0.Px1.p2.1.m1.2.3.1.cmml">⁡</mo><mrow id="S2.SS1.SSS0.Px1.p2.1.m1.2.3.2.1" xref="S2.SS1.SSS0.Px1.p2.1.m1.2.3.1.cmml"><mo id="S2.SS1.SSS0.Px1.p2.1.m1.2.3.2.1.1" stretchy="false" xref="S2.SS1.SSS0.Px1.p2.1.m1.2.3.1.cmml">(</mo><mo id="S2.SS1.SSS0.Px1.p2.1.m1.2.2" lspace="0em" rspace="0em" xref="S2.SS1.SSS0.Px1.p2.1.m1.2.2.cmml">⋅</mo><mo id="S2.SS1.SSS0.Px1.p2.1.m1.2.3.2.1.2" stretchy="false" xref="S2.SS1.SSS0.Px1.p2.1.m1.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p2.1.m1.2b"><apply id="S2.SS1.SSS0.Px1.p2.1.m1.2.3.1.cmml" xref="S2.SS1.SSS0.Px1.p2.1.m1.2.3.2"><ci id="S2.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.1.m1.1.1">GroupNorm</ci><ci id="S2.SS1.SSS0.Px1.p2.1.m1.2.2.cmml" xref="S2.SS1.SSS0.Px1.p2.1.m1.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p2.1.m1.2c">\operatorname{GroupNorm}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p2.1.m1.2d">roman_GroupNorm ( ⋅ )</annotation></semantics></math>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib44" title="">44</a>]</cite> to emphasize that <math alttext="\operatorname{LN}(\cdot)" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p2.2.m2.2"><semantics id="S2.SS1.SSS0.Px1.p2.2.m2.2a"><mrow id="S2.SS1.SSS0.Px1.p2.2.m2.2.3.2" xref="S2.SS1.SSS0.Px1.p2.2.m2.2.3.1.cmml"><mi id="S2.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S2.SS1.SSS0.Px1.p2.2.m2.1.1.cmml">LN</mi><mo id="S2.SS1.SSS0.Px1.p2.2.m2.2.3.2a" xref="S2.SS1.SSS0.Px1.p2.2.m2.2.3.1.cmml">⁡</mo><mrow id="S2.SS1.SSS0.Px1.p2.2.m2.2.3.2.1" xref="S2.SS1.SSS0.Px1.p2.2.m2.2.3.1.cmml"><mo id="S2.SS1.SSS0.Px1.p2.2.m2.2.3.2.1.1" stretchy="false" xref="S2.SS1.SSS0.Px1.p2.2.m2.2.3.1.cmml">(</mo><mo id="S2.SS1.SSS0.Px1.p2.2.m2.2.2" lspace="0em" rspace="0em" xref="S2.SS1.SSS0.Px1.p2.2.m2.2.2.cmml">⋅</mo><mo id="S2.SS1.SSS0.Px1.p2.2.m2.2.3.2.1.2" stretchy="false" xref="S2.SS1.SSS0.Px1.p2.2.m2.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p2.2.m2.2b"><apply id="S2.SS1.SSS0.Px1.p2.2.m2.2.3.1.cmml" xref="S2.SS1.SSS0.Px1.p2.2.m2.2.3.2"><ci id="S2.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.2.m2.1.1">LN</ci><ci id="S2.SS1.SSS0.Px1.p2.2.m2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p2.2.m2.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p2.2.m2.2c">\operatorname{LN}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p2.2.m2.2d">roman_LN ( ⋅ )</annotation></semantics></math> is applied to each head independently.
As differential attention tends to have a sparser pattern, statistical information is more diverse between heads.
The <math alttext="\operatorname{LN}(\cdot)" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p2.3.m3.2"><semantics id="S2.SS1.SSS0.Px1.p2.3.m3.2a"><mrow id="S2.SS1.SSS0.Px1.p2.3.m3.2.3.2" xref="S2.SS1.SSS0.Px1.p2.3.m3.2.3.1.cmml"><mi id="S2.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.cmml">LN</mi><mo id="S2.SS1.SSS0.Px1.p2.3.m3.2.3.2a" xref="S2.SS1.SSS0.Px1.p2.3.m3.2.3.1.cmml">⁡</mo><mrow id="S2.SS1.SSS0.Px1.p2.3.m3.2.3.2.1" xref="S2.SS1.SSS0.Px1.p2.3.m3.2.3.1.cmml"><mo id="S2.SS1.SSS0.Px1.p2.3.m3.2.3.2.1.1" stretchy="false" xref="S2.SS1.SSS0.Px1.p2.3.m3.2.3.1.cmml">(</mo><mo id="S2.SS1.SSS0.Px1.p2.3.m3.2.2" lspace="0em" rspace="0em" xref="S2.SS1.SSS0.Px1.p2.3.m3.2.2.cmml">⋅</mo><mo id="S2.SS1.SSS0.Px1.p2.3.m3.2.3.2.1.2" stretchy="false" xref="S2.SS1.SSS0.Px1.p2.3.m3.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p2.3.m3.2b"><apply id="S2.SS1.SSS0.Px1.p2.3.m3.2.3.1.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.2.3.2"><ci id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1">LN</ci><ci id="S2.SS1.SSS0.Px1.p2.3.m3.2.2.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p2.3.m3.2c">\operatorname{LN}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p2.3.m3.2d">roman_LN ( ⋅ )</annotation></semantics></math> operator normalizes each head before concatenation to improve gradient statistics&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib28" title="">28</a>]</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Overall Architecture</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The overall architecture stacks <math alttext="L" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_L</annotation></semantics></math> layers, where each layer contains a multi-head differential attention module, and a feed-forward network module.
We describe the Differential Transformer layer as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A6.EGx1">
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle Y^{l}" class="ltx_Math" display="inline" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><msup id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mi id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">Y</mi><mi id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1">superscript</csymbol><ci id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2">𝑌</ci><ci id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle Y^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">italic_Y start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{MultiHead}(\operatorname{LN}(X^{l}))+X^{l}" class="ltx_Math" display="inline" id="S2.E4.m2.3"><semantics id="S2.E4.m2.3a"><mrow id="S2.E4.m2.3.3" xref="S2.E4.m2.3.3.cmml"><mi id="S2.E4.m2.3.3.3" xref="S2.E4.m2.3.3.3.cmml"></mi><mo id="S2.E4.m2.3.3.2" xref="S2.E4.m2.3.3.2.cmml">=</mo><mrow id="S2.E4.m2.3.3.1" xref="S2.E4.m2.3.3.1.cmml"><mrow id="S2.E4.m2.3.3.1.1.1" xref="S2.E4.m2.3.3.1.1.2.cmml"><mi id="S2.E4.m2.2.2" xref="S2.E4.m2.2.2.cmml">MultiHead</mi><mo id="S2.E4.m2.3.3.1.1.1a" xref="S2.E4.m2.3.3.1.1.2.cmml">⁡</mo><mrow id="S2.E4.m2.3.3.1.1.1.1" xref="S2.E4.m2.3.3.1.1.2.cmml"><mo id="S2.E4.m2.3.3.1.1.1.1.2" stretchy="false" xref="S2.E4.m2.3.3.1.1.2.cmml">(</mo><mrow id="S2.E4.m2.3.3.1.1.1.1.1.1" xref="S2.E4.m2.3.3.1.1.1.1.1.2.cmml"><mi id="S2.E4.m2.1.1" xref="S2.E4.m2.1.1.cmml">LN</mi><mo id="S2.E4.m2.3.3.1.1.1.1.1.1a" xref="S2.E4.m2.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E4.m2.3.3.1.1.1.1.1.1.1" xref="S2.E4.m2.3.3.1.1.1.1.1.2.cmml"><mo id="S2.E4.m2.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m2.3.3.1.1.1.1.1.2.cmml">(</mo><msup id="S2.E4.m2.3.3.1.1.1.1.1.1.1.1" xref="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S2.E4.m2.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m2.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m2.3.3.1.1.1.1.3" stretchy="false" xref="S2.E4.m2.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m2.3.3.1.2" xref="S2.E4.m2.3.3.1.2.cmml">+</mo><msup id="S2.E4.m2.3.3.1.3" xref="S2.E4.m2.3.3.1.3.cmml"><mi id="S2.E4.m2.3.3.1.3.2" xref="S2.E4.m2.3.3.1.3.2.cmml">X</mi><mi id="S2.E4.m2.3.3.1.3.3" xref="S2.E4.m2.3.3.1.3.3.cmml">l</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.3b"><apply id="S2.E4.m2.3.3.cmml" xref="S2.E4.m2.3.3"><eq id="S2.E4.m2.3.3.2.cmml" xref="S2.E4.m2.3.3.2"></eq><csymbol cd="latexml" id="S2.E4.m2.3.3.3.cmml" xref="S2.E4.m2.3.3.3">absent</csymbol><apply id="S2.E4.m2.3.3.1.cmml" xref="S2.E4.m2.3.3.1"><plus id="S2.E4.m2.3.3.1.2.cmml" xref="S2.E4.m2.3.3.1.2"></plus><apply id="S2.E4.m2.3.3.1.1.2.cmml" xref="S2.E4.m2.3.3.1.1.1"><ci id="S2.E4.m2.2.2.cmml" xref="S2.E4.m2.2.2">MultiHead</ci><apply id="S2.E4.m2.3.3.1.1.1.1.1.2.cmml" xref="S2.E4.m2.3.3.1.1.1.1.1.1"><ci id="S2.E4.m2.1.1.cmml" xref="S2.E4.m2.1.1">LN</ci><apply id="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m2.3.3.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S2.E4.m2.3.3.1.3.cmml" xref="S2.E4.m2.3.3.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.3.3.1.3.1.cmml" xref="S2.E4.m2.3.3.1.3">superscript</csymbol><ci id="S2.E4.m2.3.3.1.3.2.cmml" xref="S2.E4.m2.3.3.1.3.2">𝑋</ci><ci id="S2.E4.m2.3.3.1.3.3.cmml" xref="S2.E4.m2.3.3.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.3c">\displaystyle=\operatorname{MultiHead}(\operatorname{LN}(X^{l}))+X^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m2.3d">= roman_MultiHead ( roman_LN ( italic_X start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ) + italic_X start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle X^{l+1}" class="ltx_Math" display="inline" id="S2.E5.m1.1"><semantics id="S2.E5.m1.1a"><msup id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml"><mi id="S2.E5.m1.1.1.2" xref="S2.E5.m1.1.1.2.cmml">X</mi><mrow id="S2.E5.m1.1.1.3" xref="S2.E5.m1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.3.2" xref="S2.E5.m1.1.1.3.2.cmml">l</mi><mo id="S2.E5.m1.1.1.3.1" xref="S2.E5.m1.1.1.3.1.cmml">+</mo><mn id="S2.E5.m1.1.1.3.3" xref="S2.E5.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1">superscript</csymbol><ci id="S2.E5.m1.1.1.2.cmml" xref="S2.E5.m1.1.1.2">𝑋</ci><apply id="S2.E5.m1.1.1.3.cmml" xref="S2.E5.m1.1.1.3"><plus id="S2.E5.m1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.3.1"></plus><ci id="S2.E5.m1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.3.2">𝑙</ci><cn id="S2.E5.m1.1.1.3.3.cmml" type="integer" xref="S2.E5.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle X^{l+1}</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.1d">italic_X start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{SwiGLU}(\operatorname{LN}(Y^{l}))+Y^{l}" class="ltx_Math" display="inline" id="S2.E5.m2.3"><semantics id="S2.E5.m2.3a"><mrow id="S2.E5.m2.3.3" xref="S2.E5.m2.3.3.cmml"><mi id="S2.E5.m2.3.3.3" xref="S2.E5.m2.3.3.3.cmml"></mi><mo id="S2.E5.m2.3.3.2" xref="S2.E5.m2.3.3.2.cmml">=</mo><mrow id="S2.E5.m2.3.3.1" xref="S2.E5.m2.3.3.1.cmml"><mrow id="S2.E5.m2.3.3.1.1.1" xref="S2.E5.m2.3.3.1.1.2.cmml"><mi id="S2.E5.m2.2.2" xref="S2.E5.m2.2.2.cmml">SwiGLU</mi><mo id="S2.E5.m2.3.3.1.1.1a" xref="S2.E5.m2.3.3.1.1.2.cmml">⁡</mo><mrow id="S2.E5.m2.3.3.1.1.1.1" xref="S2.E5.m2.3.3.1.1.2.cmml"><mo id="S2.E5.m2.3.3.1.1.1.1.2" stretchy="false" xref="S2.E5.m2.3.3.1.1.2.cmml">(</mo><mrow id="S2.E5.m2.3.3.1.1.1.1.1.1" xref="S2.E5.m2.3.3.1.1.1.1.1.2.cmml"><mi id="S2.E5.m2.1.1" xref="S2.E5.m2.1.1.cmml">LN</mi><mo id="S2.E5.m2.3.3.1.1.1.1.1.1a" xref="S2.E5.m2.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E5.m2.3.3.1.1.1.1.1.1.1" xref="S2.E5.m2.3.3.1.1.1.1.1.2.cmml"><mo id="S2.E5.m2.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m2.3.3.1.1.1.1.1.2.cmml">(</mo><msup id="S2.E5.m2.3.3.1.1.1.1.1.1.1.1" xref="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">Y</mi><mi id="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S2.E5.m2.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m2.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E5.m2.3.3.1.1.1.1.3" stretchy="false" xref="S2.E5.m2.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E5.m2.3.3.1.2" xref="S2.E5.m2.3.3.1.2.cmml">+</mo><msup id="S2.E5.m2.3.3.1.3" xref="S2.E5.m2.3.3.1.3.cmml"><mi id="S2.E5.m2.3.3.1.3.2" xref="S2.E5.m2.3.3.1.3.2.cmml">Y</mi><mi id="S2.E5.m2.3.3.1.3.3" xref="S2.E5.m2.3.3.1.3.3.cmml">l</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.3b"><apply id="S2.E5.m2.3.3.cmml" xref="S2.E5.m2.3.3"><eq id="S2.E5.m2.3.3.2.cmml" xref="S2.E5.m2.3.3.2"></eq><csymbol cd="latexml" id="S2.E5.m2.3.3.3.cmml" xref="S2.E5.m2.3.3.3">absent</csymbol><apply id="S2.E5.m2.3.3.1.cmml" xref="S2.E5.m2.3.3.1"><plus id="S2.E5.m2.3.3.1.2.cmml" xref="S2.E5.m2.3.3.1.2"></plus><apply id="S2.E5.m2.3.3.1.1.2.cmml" xref="S2.E5.m2.3.3.1.1.1"><ci id="S2.E5.m2.2.2.cmml" xref="S2.E5.m2.2.2">SwiGLU</ci><apply id="S2.E5.m2.3.3.1.1.1.1.1.2.cmml" xref="S2.E5.m2.3.3.1.1.1.1.1.1"><ci id="S2.E5.m2.1.1.cmml" xref="S2.E5.m2.1.1">LN</ci><apply id="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.2">𝑌</ci><ci id="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m2.3.3.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S2.E5.m2.3.3.1.3.cmml" xref="S2.E5.m2.3.3.1.3"><csymbol cd="ambiguous" id="S2.E5.m2.3.3.1.3.1.cmml" xref="S2.E5.m2.3.3.1.3">superscript</csymbol><ci id="S2.E5.m2.3.3.1.3.2.cmml" xref="S2.E5.m2.3.3.1.3.2">𝑌</ci><ci id="S2.E5.m2.3.3.1.3.3.cmml" xref="S2.E5.m2.3.3.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.3c">\displaystyle=\operatorname{SwiGLU}(\operatorname{LN}(Y^{l}))+Y^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m2.3d">= roman_SwiGLU ( roman_LN ( italic_Y start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ) + italic_Y start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.4">where <math alttext="\operatorname{LN}(\cdot)" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m1.2"><semantics id="S2.SS2.p1.2.m1.2a"><mrow id="S2.SS2.p1.2.m1.2.3.2" xref="S2.SS2.p1.2.m1.2.3.1.cmml"><mi id="S2.SS2.p1.2.m1.1.1" xref="S2.SS2.p1.2.m1.1.1.cmml">LN</mi><mo id="S2.SS2.p1.2.m1.2.3.2a" xref="S2.SS2.p1.2.m1.2.3.1.cmml">⁡</mo><mrow id="S2.SS2.p1.2.m1.2.3.2.1" xref="S2.SS2.p1.2.m1.2.3.1.cmml"><mo id="S2.SS2.p1.2.m1.2.3.2.1.1" stretchy="false" xref="S2.SS2.p1.2.m1.2.3.1.cmml">(</mo><mo id="S2.SS2.p1.2.m1.2.2" lspace="0em" rspace="0em" xref="S2.SS2.p1.2.m1.2.2.cmml">⋅</mo><mo id="S2.SS2.p1.2.m1.2.3.2.1.2" stretchy="false" xref="S2.SS2.p1.2.m1.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m1.2b"><apply id="S2.SS2.p1.2.m1.2.3.1.cmml" xref="S2.SS2.p1.2.m1.2.3.2"><ci id="S2.SS2.p1.2.m1.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1">LN</ci><ci id="S2.SS2.p1.2.m1.2.2.cmml" xref="S2.SS2.p1.2.m1.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m1.2c">\operatorname{LN}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m1.2d">roman_LN ( ⋅ )</annotation></semantics></math> is RMSNorm&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib46" title="">46</a>]</cite>, <math alttext="\operatorname{SwiGLU}(X)=(\operatorname{swish}(XW^{G})\odot XW_{1})W_{2}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m2.4"><semantics id="S2.SS2.p1.3.m2.4a"><mrow id="S2.SS2.p1.3.m2.4.4" xref="S2.SS2.p1.3.m2.4.4.cmml"><mrow id="S2.SS2.p1.3.m2.4.4.3.2" xref="S2.SS2.p1.3.m2.4.4.3.1.cmml"><mi id="S2.SS2.p1.3.m2.1.1" xref="S2.SS2.p1.3.m2.1.1.cmml">SwiGLU</mi><mo id="S2.SS2.p1.3.m2.4.4.3.2a" xref="S2.SS2.p1.3.m2.4.4.3.1.cmml">⁡</mo><mrow id="S2.SS2.p1.3.m2.4.4.3.2.1" xref="S2.SS2.p1.3.m2.4.4.3.1.cmml"><mo id="S2.SS2.p1.3.m2.4.4.3.2.1.1" stretchy="false" xref="S2.SS2.p1.3.m2.4.4.3.1.cmml">(</mo><mi id="S2.SS2.p1.3.m2.2.2" xref="S2.SS2.p1.3.m2.2.2.cmml">X</mi><mo id="S2.SS2.p1.3.m2.4.4.3.2.1.2" stretchy="false" xref="S2.SS2.p1.3.m2.4.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.3.m2.4.4.2" xref="S2.SS2.p1.3.m2.4.4.2.cmml">=</mo><mrow id="S2.SS2.p1.3.m2.4.4.1" xref="S2.SS2.p1.3.m2.4.4.1.cmml"><mrow id="S2.SS2.p1.3.m2.4.4.1.1.1" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.cmml"><mo id="S2.SS2.p1.3.m2.4.4.1.1.1.2" stretchy="false" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.3.m2.4.4.1.1.1.1" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.cmml"><mrow id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.cmml"><mrow id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p1.3.m2.3.3" xref="S2.SS2.p1.3.m2.3.3.cmml">swish</mi><mo id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1a" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.2.cmml"><mo id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mo id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.3" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml">G</mi></msup></mrow><mo id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.2" rspace="0.222em" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.2.cmml">⊙</mo><mi id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.3" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S2.SS2.p1.3.m2.4.4.1.1.1.1.2" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.2.cmml">⁢</mo><msub id="S2.SS2.p1.3.m2.4.4.1.1.1.1.3" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.2" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.2.cmml">W</mi><mn id="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.3" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S2.SS2.p1.3.m2.4.4.1.1.1.3" stretchy="false" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS2.p1.3.m2.4.4.1.2" xref="S2.SS2.p1.3.m2.4.4.1.2.cmml">⁢</mo><msub id="S2.SS2.p1.3.m2.4.4.1.3" xref="S2.SS2.p1.3.m2.4.4.1.3.cmml"><mi id="S2.SS2.p1.3.m2.4.4.1.3.2" xref="S2.SS2.p1.3.m2.4.4.1.3.2.cmml">W</mi><mn id="S2.SS2.p1.3.m2.4.4.1.3.3" xref="S2.SS2.p1.3.m2.4.4.1.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m2.4b"><apply id="S2.SS2.p1.3.m2.4.4.cmml" xref="S2.SS2.p1.3.m2.4.4"><eq id="S2.SS2.p1.3.m2.4.4.2.cmml" xref="S2.SS2.p1.3.m2.4.4.2"></eq><apply id="S2.SS2.p1.3.m2.4.4.3.1.cmml" xref="S2.SS2.p1.3.m2.4.4.3.2"><ci id="S2.SS2.p1.3.m2.1.1.cmml" xref="S2.SS2.p1.3.m2.1.1">SwiGLU</ci><ci id="S2.SS2.p1.3.m2.2.2.cmml" xref="S2.SS2.p1.3.m2.2.2">𝑋</ci></apply><apply id="S2.SS2.p1.3.m2.4.4.1.cmml" xref="S2.SS2.p1.3.m2.4.4.1"><times id="S2.SS2.p1.3.m2.4.4.1.2.cmml" xref="S2.SS2.p1.3.m2.4.4.1.2"></times><apply id="S2.SS2.p1.3.m2.4.4.1.1.1.1.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1"><times id="S2.SS2.p1.3.m2.4.4.1.1.1.1.2.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.2"></times><apply id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.2">direct-product</csymbol><apply id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1"><ci id="S2.SS2.p1.3.m2.3.3.cmml" xref="S2.SS2.p1.3.m2.3.3">swish</ci><apply id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1"><times id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.1"></times><ci id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.2">𝑋</ci><apply id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.2">𝑊</ci><ci id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.1.1.1.1.3.3">𝐺</ci></apply></apply></apply><ci id="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.1.3">𝑋</ci></apply><apply id="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.2">𝑊</ci><cn id="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS2.p1.3.m2.4.4.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.SS2.p1.3.m2.4.4.1.3.cmml" xref="S2.SS2.p1.3.m2.4.4.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m2.4.4.1.3.1.cmml" xref="S2.SS2.p1.3.m2.4.4.1.3">subscript</csymbol><ci id="S2.SS2.p1.3.m2.4.4.1.3.2.cmml" xref="S2.SS2.p1.3.m2.4.4.1.3.2">𝑊</ci><cn id="S2.SS2.p1.3.m2.4.4.1.3.3.cmml" type="integer" xref="S2.SS2.p1.3.m2.4.4.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m2.4c">\operatorname{SwiGLU}(X)=(\operatorname{swish}(XW^{G})\odot XW_{1})W_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m2.4d">roman_SwiGLU ( italic_X ) = ( roman_swish ( italic_X italic_W start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT ) ⊙ italic_X italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="W^{G},W_{1}\in\mathbb{R}^{d_{\text{model}}\times\frac{8}{3}d_{\text{model}}},W%
_{2}\in\mathbb{R}^{\frac{8}{3}d_{\text{model}}\times d_{\text{model}}}" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m3.2"><semantics id="S2.SS2.p1.4.m3.2a"><mrow id="S2.SS2.p1.4.m3.2.2.2" xref="S2.SS2.p1.4.m3.2.2.3.cmml"><mrow id="S2.SS2.p1.4.m3.1.1.1.1" xref="S2.SS2.p1.4.m3.1.1.1.1.cmml"><mrow id="S2.SS2.p1.4.m3.1.1.1.1.2.2" xref="S2.SS2.p1.4.m3.1.1.1.1.2.3.cmml"><msup id="S2.SS2.p1.4.m3.1.1.1.1.1.1.1" xref="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.3.cmml">G</mi></msup><mo id="S2.SS2.p1.4.m3.1.1.1.1.2.2.3" xref="S2.SS2.p1.4.m3.1.1.1.1.2.3.cmml">,</mo><msub id="S2.SS2.p1.4.m3.1.1.1.1.2.2.2" xref="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.cmml"><mi id="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.2" xref="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.2.cmml">W</mi><mn id="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.3" xref="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.3.cmml">1</mn></msub></mrow><mo id="S2.SS2.p1.4.m3.1.1.1.1.3" xref="S2.SS2.p1.4.m3.1.1.1.1.3.cmml">∈</mo><msup id="S2.SS2.p1.4.m3.1.1.1.1.4" xref="S2.SS2.p1.4.m3.1.1.1.1.4.cmml"><mi id="S2.SS2.p1.4.m3.1.1.1.1.4.2" xref="S2.SS2.p1.4.m3.1.1.1.1.4.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.4.m3.1.1.1.1.4.3" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.cmml"><mrow id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.cmml"><msub id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.cmml"><mi id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.2" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.2.cmml">d</mi><mtext id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.3" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.3a.cmml">model</mtext></msub><mo id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.1.cmml">×</mo><mfrac id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.cmml"><mn id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.2" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.2.cmml">8</mn><mn id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.3" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.3.cmml">3</mn></mfrac></mrow><mo id="S2.SS2.p1.4.m3.1.1.1.1.4.3.1" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.1.cmml">⁢</mo><msub id="S2.SS2.p1.4.m3.1.1.1.1.4.3.3" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.cmml"><mi id="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.2" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.2.cmml">d</mi><mtext id="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.3" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><mo id="S2.SS2.p1.4.m3.2.2.2.3" xref="S2.SS2.p1.4.m3.2.2.3a.cmml">,</mo><mrow id="S2.SS2.p1.4.m3.2.2.2.2" xref="S2.SS2.p1.4.m3.2.2.2.2.cmml"><msub id="S2.SS2.p1.4.m3.2.2.2.2.2" xref="S2.SS2.p1.4.m3.2.2.2.2.2.cmml"><mi id="S2.SS2.p1.4.m3.2.2.2.2.2.2" xref="S2.SS2.p1.4.m3.2.2.2.2.2.2.cmml">W</mi><mn id="S2.SS2.p1.4.m3.2.2.2.2.2.3" xref="S2.SS2.p1.4.m3.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS2.p1.4.m3.2.2.2.2.1" xref="S2.SS2.p1.4.m3.2.2.2.2.1.cmml">∈</mo><msup id="S2.SS2.p1.4.m3.2.2.2.2.3" xref="S2.SS2.p1.4.m3.2.2.2.2.3.cmml"><mi id="S2.SS2.p1.4.m3.2.2.2.2.3.2" xref="S2.SS2.p1.4.m3.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.4.m3.2.2.2.2.3.3" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.cmml"><mrow id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.cmml"><mfrac id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.cmml"><mn id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.2" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.2.cmml">8</mn><mn id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.3" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.3.cmml">3</mn></mfrac><mo id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.1" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.1.cmml">⁢</mo><msub id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.cmml"><mi id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.2" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.2.cmml">d</mi><mtext id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.3" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.3a.cmml">model</mtext></msub></mrow><mo id="S2.SS2.p1.4.m3.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.1.cmml">×</mo><msub id="S2.SS2.p1.4.m3.2.2.2.2.3.3.3" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.cmml"><mi id="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.2" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.2.cmml">d</mi><mtext id="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.3" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m3.2b"><apply id="S2.SS2.p1.4.m3.2.2.3.cmml" xref="S2.SS2.p1.4.m3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.2.2.3a.cmml" xref="S2.SS2.p1.4.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p1.4.m3.1.1.1.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1"><in id="S2.SS2.p1.4.m3.1.1.1.1.3.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.3"></in><list id="S2.SS2.p1.4.m3.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.2.2"><apply id="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.1.1.1.3">𝐺</ci></apply><apply id="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.2">𝑊</ci><cn id="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.SS2.p1.4.m3.1.1.1.1.2.2.2.3">1</cn></apply></list><apply id="S2.SS2.p1.4.m3.1.1.1.1.4.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.1.1.1.1.4.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4">superscript</csymbol><ci id="S2.SS2.p1.4.m3.1.1.1.1.4.2.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.2">ℝ</ci><apply id="S2.SS2.p1.4.m3.1.1.1.1.4.3.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3"><times id="S2.SS2.p1.4.m3.1.1.1.1.4.3.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.1"></times><apply id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2"><times id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.1"></times><apply id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2">subscript</csymbol><ci id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.2.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.2">𝑑</ci><ci id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.3a.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.3"><mtext id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.3.cmml" mathsize="50%" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.2.3">model</mtext></ci></apply><apply id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3"><divide id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3"></divide><cn id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.2.cmml" type="integer" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.2">8</cn><cn id="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.3.cmml" type="integer" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.2.3.3">3</cn></apply></apply><apply id="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.1.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.3">subscript</csymbol><ci id="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.2.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.2">𝑑</ci><ci id="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.3a.cmml" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.3"><mtext id="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.3.cmml" mathsize="50%" xref="S2.SS2.p1.4.m3.1.1.1.1.4.3.3.3">model</mtext></ci></apply></apply></apply></apply><apply id="S2.SS2.p1.4.m3.2.2.2.2.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2"><in id="S2.SS2.p1.4.m3.2.2.2.2.1.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.1"></in><apply id="S2.SS2.p1.4.m3.2.2.2.2.2.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.2.2.2.2.2.1.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.4.m3.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.2.2">𝑊</ci><cn id="S2.SS2.p1.4.m3.2.2.2.2.2.3.cmml" type="integer" xref="S2.SS2.p1.4.m3.2.2.2.2.2.3">2</cn></apply><apply id="S2.SS2.p1.4.m3.2.2.2.2.3.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.2.2.2.2.3.1.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3">superscript</csymbol><ci id="S2.SS2.p1.4.m3.2.2.2.2.3.2.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.2">ℝ</ci><apply id="S2.SS2.p1.4.m3.2.2.2.2.3.3.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3"><times id="S2.SS2.p1.4.m3.2.2.2.2.3.3.1.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.1"></times><apply id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2"><times id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.1.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.1"></times><apply id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2"><divide id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.1.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2"></divide><cn id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.2.cmml" type="integer" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.2">8</cn><cn id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.3.cmml" type="integer" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.2.3">3</cn></apply><apply id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.1.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3">subscript</csymbol><ci id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.2.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.2">𝑑</ci><ci id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.3a.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.3"><mtext id="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.3.cmml" mathsize="50%" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.2.3.3">model</mtext></ci></apply></apply><apply id="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.1.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.3">subscript</csymbol><ci id="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.2.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.2">𝑑</ci><ci id="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.3a.cmml" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.3"><mtext id="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.3.cmml" mathsize="50%" xref="S2.SS2.p1.4.m3.2.2.2.2.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m3.2c">W^{G},W_{1}\in\mathbb{R}^{d_{\text{model}}\times\frac{8}{3}d_{\text{model}}},W%
_{2}\in\mathbb{R}^{\frac{8}{3}d_{\text{model}}\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m3.2d">italic_W start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × divide start_ARG 8 end_ARG start_ARG 3 end_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT divide start_ARG 8 end_ARG start_ARG 3 end_ARG italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable matrices.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We evaluate Differential Transformer for large language models from the following perspectives.
First, we compare the proposed architecture with Transformers in various downstream tasks (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS1" title="3.1 Language Modeling Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.1</span></a>) and study the properties of scaling up model size and training tokens (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS2" title="3.2 Scalability Compared with Transformer ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.2</span></a>).
Second, we conduct a length extension to 64K and evaluate the long-sequence modeling capability (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS3" title="3.3 Long-Context Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.3</span></a>).
Third, we present the results of key information retrieval, contextual hallucination evaluation, and in-context learning (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS4" title="3.4 Key Information Retrieval ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Sections</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.4</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS6" title="3.6 Contextual Hallucination Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">3.6</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS5" title="3.5 In-Context Learning ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">3.5</span></a>).
Forth, we show that Differential Transformer can reduce outliers in the model activations compared to Transformer (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS7" title="3.7 Activation Outliers Analysis ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.7</span></a>).
Fifth, we conduct extensive ablation studies for various design choices (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS8" title="3.8 Ablation Studies ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.8</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Language Modeling Evaluation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We train 3B-size <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.1.1">Diff</span> Transformer language models on 1T tokens and compare with previous well-trained Transformer-based models&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib40" title="">40</a>]</cite> in various downstream tasks.
As described in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A2" title="Appendix B Language Modeling Evaluation ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">B</span></a>, we follow the same setting to train a 3B-size Transformer language model on 350B tokens.
The checkpoints are also used in the following experiments and analysis to ensure fair comparisons.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.1" style="width:433.6pt;height:74.4pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-100.8pt,17.1pt) scale(0.682674465186622,0.682674465186622) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.1.1">
<tbody><tr class="ltx_tr" id="S3.T1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.2.1">ARC-C</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.3.1">ARC-E</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.4.1">BoolQ</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.5.1">HellaSwag</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.6.1">OBQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.1.1.1.7"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.7.1">PIQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.1.1.1.8"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.8.1">WinoGrande</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.1.1.1.9"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.9.1">Avg</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" colspan="9" id="S3.T1.1.1.2.1"><span class="ltx_text ltx_font_italic" id="S3.T1.1.1.2.1.1">Training with 1T tokens</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.3">
<td class="ltx_td ltx_align_left" id="S3.T1.1.1.3.1">OpenLLaMA-3B-v2&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib13" title="">13</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2">33.9</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.3">67.6</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.4">65.7</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.5">70.0</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.6">26.0</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.7">76.7</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.8">62.9</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.9">57.5</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.4">
<td class="ltx_td ltx_align_left" id="S3.T1.1.1.4.1">StableLM-base-alpha-3B-v2&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib39" title="">39</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.2">32.4</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3">67.3</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4">64.6</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.5">68.6</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.6">26.4</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.7">76.0</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.8">62.1</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.9">56.8</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.5">
<td class="ltx_td ltx_align_left" id="S3.T1.1.1.5.1">StableLM-3B-4E1T&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib40" title="">40</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.2">—</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.3">66.6</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4">—</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.5">—</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.6">—</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.7"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.7.1">76.8</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.8">63.2</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.9">—</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.6">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T1.1.1.6.1">
<span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.6.1.1">Diff</span>-3B</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.2.1">37.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.3.1">72.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.4.1">69.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.5"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.5.1">71.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.6"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.6.1">29.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.7"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.7.1">76.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.8"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.8.1">67.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.9"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.9.1">60.6</span></td>
</tr>
</tbody></table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Eval Harness&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib12" title="">12</a>]</cite> accuracy compared with well-trained Transformer language models&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib13" title="">13</a>]</cite>.
We scale the 3B model to 1 trillion training tokens.
The 1T results of StableLM-3B-4E1T are taken from its technical report&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib40" title="">40</a>]</cite>.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.7"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.7.1">Setup</span>&nbsp;&nbsp;
We follow a similar recipe as StableLM-3B-4E1T&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib40" title="">40</a>]</cite>.
We set hidden size to <math alttext="3072" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mn id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">3072</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><cn id="S3.SS1.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1">3072</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">3072</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">3072</annotation></semantics></math>. The number of layers is <math alttext="28" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mn id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">28</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><cn id="S3.SS1.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1">28</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">28</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">28</annotation></semantics></math>.
The head dimension <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_d</annotation></semantics></math> is <math alttext="128" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mn id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><cn id="S3.SS1.p2.4.m4.1.1.cmml" type="integer" xref="S3.SS1.p2.4.m4.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">128</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">128</annotation></semantics></math>. The number of heads is <math alttext="24" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mn id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><cn id="S3.SS1.p2.5.m5.1.1.cmml" type="integer" xref="S3.SS1.p2.5.m5.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">24</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">24</annotation></semantics></math> for Transformer and <math alttext="12" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mn id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">12</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><cn id="S3.SS1.p2.6.m6.1.1.cmml" type="integer" xref="S3.SS1.p2.6.m6.1.1">12</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">12</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">12</annotation></semantics></math> for <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.7.2">Diff</span> Transformer, to align computation FLOPs and model size.
The total parameter count is about 2.8B.
The training sequence length is 4096.
The batch size is 4M tokens.
We train the models with 1T tokens.
We use AdamW&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib24" title="">24</a>]</cite> optimizer with <math alttext="\beta=0.9,0.95" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.2"><semantics id="S3.SS1.p2.7.m7.2a"><mrow id="S3.SS1.p2.7.m7.2.3" xref="S3.SS1.p2.7.m7.2.3.cmml"><mi id="S3.SS1.p2.7.m7.2.3.2" xref="S3.SS1.p2.7.m7.2.3.2.cmml">β</mi><mo id="S3.SS1.p2.7.m7.2.3.1" xref="S3.SS1.p2.7.m7.2.3.1.cmml">=</mo><mrow id="S3.SS1.p2.7.m7.2.3.3.2" xref="S3.SS1.p2.7.m7.2.3.3.1.cmml"><mn id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">0.9</mn><mo id="S3.SS1.p2.7.m7.2.3.3.2.1" xref="S3.SS1.p2.7.m7.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p2.7.m7.2.2" xref="S3.SS1.p2.7.m7.2.2.cmml">0.95</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.2b"><apply id="S3.SS1.p2.7.m7.2.3.cmml" xref="S3.SS1.p2.7.m7.2.3"><eq id="S3.SS1.p2.7.m7.2.3.1.cmml" xref="S3.SS1.p2.7.m7.2.3.1"></eq><ci id="S3.SS1.p2.7.m7.2.3.2.cmml" xref="S3.SS1.p2.7.m7.2.3.2">𝛽</ci><list id="S3.SS1.p2.7.m7.2.3.3.1.cmml" xref="S3.SS1.p2.7.m7.2.3.3.2"><cn id="S3.SS1.p2.7.m7.1.1.cmml" type="float" xref="S3.SS1.p2.7.m7.1.1">0.9</cn><cn id="S3.SS1.p2.7.m7.2.2.cmml" type="float" xref="S3.SS1.p2.7.m7.2.2">0.95</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.2c">\beta=0.9,0.95</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.2d">italic_β = 0.9 , 0.95</annotation></semantics></math>. The maximal learning rate is 3.2e-4 with 1000 warmup steps and linearly decays to 1.28e-5.
The training corpus also follows StableLM-3B-4E1T&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib40" title="">40</a>]</cite>.
We employ <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.7.3">tiktoken-cl100k_base</span> tokenizer.
Detailed hyperparameters are provided in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A3" title="Appendix C Hyperparameters for Section 3.1 ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">C</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.1.1">Results</span>&nbsp;&nbsp;
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.T1" title="In 3.1 Language Modeling Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a> reports the zero-shot results on the LM Eval Harness benchmark&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib12" title="">12</a>]</cite>.
We compare <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p3.1.2">Diff</span> Transformer with well-trained Transformer-based language models, including OpenLLaMA-v2-3B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib13" title="">13</a>]</cite>, StableLM-base-alpha-3B-v2&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib39" title="">39</a>]</cite>, and StableLM-3B-4E1T&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib40" title="">40</a>]</cite>.
OpenLLaMA-v2-3B and StableLM-base-alpha-3B-v2 are also trained with 1T tokens.
The 1T results of StableLM-3B-4E1T are taken from its technical report&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib40" title="">40</a>]</cite>.
Experimental results show that <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p3.1.3">Diff</span> Transformer achieves favorable performance compared to previous well-tuned Transformer language models.
In addition, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A2" title="Appendix B Language Modeling Evaluation ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">B</span></a> shows that <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p3.1.4">Diff</span> Transformer outperforms Transformer across various tasks, where we use the same setting to train the 3B-size language models for fair comparisons.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Scalability Compared with Transformer</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="602" id="S3.F3.sf1.g1" src="https://arxiv.org/html/2410.05258v1/x3.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Scaling model size ranging from 830M to 13B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="563" id="S3.F3.sf2.g1" src="https://arxiv.org/html/2410.05258v1/x4.png" width="778">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Scaling number of training tokens for 3B models.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Language modeling loss of scaling up parameter count and training tokens.
<span class="ltx_text ltx_font_smallcaps" id="S3.F3.2.1">Diff</span> Transformer requires only about 65% of model size or training tokens to match Transformer’s performance.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We compare the scaling properties of <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.1.1">Diff</span> Transformer and Transformer on language modeling.
We scale up the model size, and the number of training tokens, respectively.
We follow the augmented Transformer architecture as in LLaMA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib38" title="">38</a>]</cite> and use the same setting to ensure fair comparison.
Specifically, the “Transformer” models include improvements in RMSNorm&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib46" title="">46</a>]</cite>, SwiGLU&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib29" title="">29</a>]</cite>, and removal of bias.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">Scaling Model Size</span>&nbsp;&nbsp;
As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F3.sf1" title="In Figure 3 ‣ 3.2 Scalability Compared with Transformer ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">3(a)</span></a>, we train language models with 830M, 1.4B, 2.8B, 6.8B, and 13.1B parameters.
The models are trained with a sequence length of 2048, and a batch size of 0.25M tokens.
We train models for 40K steps.
Detailed hyperparameters are described in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A4" title="Appendix D Hyperparameters for Section 3.2 ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">D</span></a>.
The scaling law&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib18" title="">18</a>]</cite> empirically fits well in this configuration.
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F3.sf1" title="In Figure 3 ‣ 3.2 Scalability Compared with Transformer ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">3(a)</span></a> shows that <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p2.1.2">Diff</span> Transformer outperforms Transformer in various model sizes.
The results indicate that <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p2.1.3">Diff</span> Transformer is scalable in terms of parameter count.
According to the fitted curves, 6.8B-size <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p2.1.4">Diff</span> Transformer achieves a validation loss comparable to 11B-size Transformer, requiring only <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.5">62.2%</span> of parameters.
Similarly, 7.8B-size <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p2.1.6">Diff</span> Transformer matches the performance of 13.1B-size Transformer, requiring only <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.7">59.5%</span> of parameters.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.1.1">Scaling Training Tokens</span>&nbsp;&nbsp;
As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F3.sf2" title="In Figure 3 ‣ 3.2 Scalability Compared with Transformer ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">3(b)</span></a>, we evaluate the 3B language models (as presented in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A2" title="Appendix B Language Modeling Evaluation ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">B</span></a>) every 40B tokens (i.e., 10K steps) up to a total of 360B tokens (i.e., 90K steps).
The fitted curves indicate that <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p3.1.2">Diff</span> Transformer trained with 160B tokens achieves comparable performance as Transformer trained with 251B tokens, consuming only <span class="ltx_text ltx_font_bold" id="S3.SS2.p3.1.3">63.7%</span> of the training tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Long-Context Evaluation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="S3.F4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.F4.1" style="width:166.9pt;height:120.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-116.2pt,84.1pt) scale(0.418012720136518,0.418012720136518) ;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="555" id="S3.F4.1.g1" src="https://arxiv.org/html/2410.05258v1/x5.png" width="761">
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Cumulative average negative log-likelihood (lower is better) on book data.
<span class="ltx_text ltx_font_smallcaps" id="S3.F4.3.1">Diff</span> Transformer leverages long context more effectively.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">We extend the 3B-size language models (described in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A2" title="Appendix B Language Modeling Evaluation ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">B</span></a>) to 64K context length.
We continue training the 3B checkpoints for additional 1.5B tokens. Most hyperparameters are kept the same as in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS1" title="3.1 Language Modeling Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.1</span></a>.
The learning rate is 8e-5. The RoPE&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib36" title="">36</a>]</cite> <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_θ</annotation></semantics></math> is increased to 640,000.
The training corpus is up-sampled according to sequence length&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib11" title="">11</a>]</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.1">Results</span>&nbsp;&nbsp;
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F4" title="In 3.3 Long-Context Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">4</span></a> presents cumulative average negative log-likelihood (NLL) of the tokens at varying positions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib32" title="">32</a>]</cite>, where lower NLL indicates better performance.
The evaluation is conducted on book data within 64K length.
We observe a consistent decrease in NLL as the context length increases.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.1.2">Diff</span> Transformer achieves lower NLL values than Transformer.
The results demonstrate that <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.1.3">Diff</span> Transformer can effectively leverage the increasing context.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Key Information Retrieval</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.3">The Needle-In-A-Haystack&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib17" title="">17</a>]</cite> test is widely used to evaluate the ability to extract critical information embedded in a large context.
We follow the multi-needle evaluation protocol of LWM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib22" title="">22</a>]</cite> and Gemini 1.5&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib32" title="">32</a>]</cite>.
The needles are inserted into varying depths within contexts of different lengths.
Each needle consists of a concise sentence that assigns a unique magic number to a specific city.
The goal is to retrieve the magic numbers corresponding to the query cities.
We position the answer needle at five different depths within the context: 0%, 25%, 50%, 75%, and 100%, while placing other distracting needles randomly.
Each combination of depth and length is evaluated using <math alttext="50" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mn id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><cn id="S3.SS4.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS4.p1.1.m1.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">50</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">50</annotation></semantics></math> samples.
The average accuracy is reported.
Let <math alttext="N" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><mi id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">italic_N</annotation></semantics></math> denote the total number of number-city pairs and <math alttext="R" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_R</annotation></semantics></math> the number of query cities.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table ltx_align_floatright" id="S3.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T2.8" style="width:194.8pt;height:66.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-8.0pt,2.7pt) scale(0.924035825654773,0.924035825654773) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T2.8.8">
<tbody><tr class="ltx_tr" id="S3.T2.4.4.4">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.4.4.4.5" rowspan="2" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.4.4.4.5.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.1" style="padding:1pt 3.4pt;"><math alttext="N=1" class="ltx_Math" display="inline" id="S3.T2.1.1.1.1.m1.1"><semantics id="S3.T2.1.1.1.1.m1.1a"><mrow id="S3.T2.1.1.1.1.m1.1.1" xref="S3.T2.1.1.1.1.m1.1.1.cmml"><mi id="S3.T2.1.1.1.1.m1.1.1.2" xref="S3.T2.1.1.1.1.m1.1.1.2.cmml">N</mi><mo id="S3.T2.1.1.1.1.m1.1.1.1" xref="S3.T2.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S3.T2.1.1.1.1.m1.1.1.3" xref="S3.T2.1.1.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.1.m1.1b"><apply id="S3.T2.1.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.1.m1.1.1"><eq id="S3.T2.1.1.1.1.m1.1.1.1.cmml" xref="S3.T2.1.1.1.1.m1.1.1.1"></eq><ci id="S3.T2.1.1.1.1.m1.1.1.2.cmml" xref="S3.T2.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T2.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T2.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.1.m1.1c">N=1</annotation><annotation encoding="application/x-llamapun" id="S3.T2.1.1.1.1.m1.1d">italic_N = 1</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.2.2.2.2" style="padding:1pt 3.4pt;"><math alttext="N=2" class="ltx_Math" display="inline" id="S3.T2.2.2.2.2.m1.1"><semantics id="S3.T2.2.2.2.2.m1.1a"><mrow id="S3.T2.2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.2.m1.1.1.cmml"><mi id="S3.T2.2.2.2.2.m1.1.1.2" xref="S3.T2.2.2.2.2.m1.1.1.2.cmml">N</mi><mo id="S3.T2.2.2.2.2.m1.1.1.1" xref="S3.T2.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S3.T2.2.2.2.2.m1.1.1.3" xref="S3.T2.2.2.2.2.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.2.m1.1b"><apply id="S3.T2.2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.2.m1.1.1"><eq id="S3.T2.2.2.2.2.m1.1.1.1.cmml" xref="S3.T2.2.2.2.2.m1.1.1.1"></eq><ci id="S3.T2.2.2.2.2.m1.1.1.2.cmml" xref="S3.T2.2.2.2.2.m1.1.1.2">𝑁</ci><cn id="S3.T2.2.2.2.2.m1.1.1.3.cmml" type="integer" xref="S3.T2.2.2.2.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.2.m1.1c">N=2</annotation><annotation encoding="application/x-llamapun" id="S3.T2.2.2.2.2.m1.1d">italic_N = 2</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.3.3.3.3" style="padding:1pt 3.4pt;"><math alttext="N=4" class="ltx_Math" display="inline" id="S3.T2.3.3.3.3.m1.1"><semantics id="S3.T2.3.3.3.3.m1.1a"><mrow id="S3.T2.3.3.3.3.m1.1.1" xref="S3.T2.3.3.3.3.m1.1.1.cmml"><mi id="S3.T2.3.3.3.3.m1.1.1.2" xref="S3.T2.3.3.3.3.m1.1.1.2.cmml">N</mi><mo id="S3.T2.3.3.3.3.m1.1.1.1" xref="S3.T2.3.3.3.3.m1.1.1.1.cmml">=</mo><mn id="S3.T2.3.3.3.3.m1.1.1.3" xref="S3.T2.3.3.3.3.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.3.3.m1.1b"><apply id="S3.T2.3.3.3.3.m1.1.1.cmml" xref="S3.T2.3.3.3.3.m1.1.1"><eq id="S3.T2.3.3.3.3.m1.1.1.1.cmml" xref="S3.T2.3.3.3.3.m1.1.1.1"></eq><ci id="S3.T2.3.3.3.3.m1.1.1.2.cmml" xref="S3.T2.3.3.3.3.m1.1.1.2">𝑁</ci><cn id="S3.T2.3.3.3.3.m1.1.1.3.cmml" type="integer" xref="S3.T2.3.3.3.3.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.3.3.m1.1c">N=4</annotation><annotation encoding="application/x-llamapun" id="S3.T2.3.3.3.3.m1.1d">italic_N = 4</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.4.4.4.4" style="padding:1pt 3.4pt;"><math alttext="N=6" class="ltx_Math" display="inline" id="S3.T2.4.4.4.4.m1.1"><semantics id="S3.T2.4.4.4.4.m1.1a"><mrow id="S3.T2.4.4.4.4.m1.1.1" xref="S3.T2.4.4.4.4.m1.1.1.cmml"><mi id="S3.T2.4.4.4.4.m1.1.1.2" xref="S3.T2.4.4.4.4.m1.1.1.2.cmml">N</mi><mo id="S3.T2.4.4.4.4.m1.1.1.1" xref="S3.T2.4.4.4.4.m1.1.1.1.cmml">=</mo><mn id="S3.T2.4.4.4.4.m1.1.1.3" xref="S3.T2.4.4.4.4.m1.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.4.4.m1.1b"><apply id="S3.T2.4.4.4.4.m1.1.1.cmml" xref="S3.T2.4.4.4.4.m1.1.1"><eq id="S3.T2.4.4.4.4.m1.1.1.1.cmml" xref="S3.T2.4.4.4.4.m1.1.1.1"></eq><ci id="S3.T2.4.4.4.4.m1.1.1.2.cmml" xref="S3.T2.4.4.4.4.m1.1.1.2">𝑁</ci><cn id="S3.T2.4.4.4.4.m1.1.1.3.cmml" type="integer" xref="S3.T2.4.4.4.4.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.4.4.m1.1c">N=6</annotation><annotation encoding="application/x-llamapun" id="S3.T2.4.4.4.4.m1.1d">italic_N = 6</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.8.8.8">
<td class="ltx_td ltx_align_center" id="S3.T2.5.5.5.1" style="padding:1pt 3.4pt;"><math alttext="R=1" class="ltx_Math" display="inline" id="S3.T2.5.5.5.1.m1.1"><semantics id="S3.T2.5.5.5.1.m1.1a"><mrow id="S3.T2.5.5.5.1.m1.1.1" xref="S3.T2.5.5.5.1.m1.1.1.cmml"><mi id="S3.T2.5.5.5.1.m1.1.1.2" xref="S3.T2.5.5.5.1.m1.1.1.2.cmml">R</mi><mo id="S3.T2.5.5.5.1.m1.1.1.1" xref="S3.T2.5.5.5.1.m1.1.1.1.cmml">=</mo><mn id="S3.T2.5.5.5.1.m1.1.1.3" xref="S3.T2.5.5.5.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.5.1.m1.1b"><apply id="S3.T2.5.5.5.1.m1.1.1.cmml" xref="S3.T2.5.5.5.1.m1.1.1"><eq id="S3.T2.5.5.5.1.m1.1.1.1.cmml" xref="S3.T2.5.5.5.1.m1.1.1.1"></eq><ci id="S3.T2.5.5.5.1.m1.1.1.2.cmml" xref="S3.T2.5.5.5.1.m1.1.1.2">𝑅</ci><cn id="S3.T2.5.5.5.1.m1.1.1.3.cmml" type="integer" xref="S3.T2.5.5.5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.5.1.m1.1c">R=1</annotation><annotation encoding="application/x-llamapun" id="S3.T2.5.5.5.1.m1.1d">italic_R = 1</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T2.6.6.6.2" style="padding:1pt 3.4pt;"><math alttext="R=2" class="ltx_Math" display="inline" id="S3.T2.6.6.6.2.m1.1"><semantics id="S3.T2.6.6.6.2.m1.1a"><mrow id="S3.T2.6.6.6.2.m1.1.1" xref="S3.T2.6.6.6.2.m1.1.1.cmml"><mi id="S3.T2.6.6.6.2.m1.1.1.2" xref="S3.T2.6.6.6.2.m1.1.1.2.cmml">R</mi><mo id="S3.T2.6.6.6.2.m1.1.1.1" xref="S3.T2.6.6.6.2.m1.1.1.1.cmml">=</mo><mn id="S3.T2.6.6.6.2.m1.1.1.3" xref="S3.T2.6.6.6.2.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.6.2.m1.1b"><apply id="S3.T2.6.6.6.2.m1.1.1.cmml" xref="S3.T2.6.6.6.2.m1.1.1"><eq id="S3.T2.6.6.6.2.m1.1.1.1.cmml" xref="S3.T2.6.6.6.2.m1.1.1.1"></eq><ci id="S3.T2.6.6.6.2.m1.1.1.2.cmml" xref="S3.T2.6.6.6.2.m1.1.1.2">𝑅</ci><cn id="S3.T2.6.6.6.2.m1.1.1.3.cmml" type="integer" xref="S3.T2.6.6.6.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.6.2.m1.1c">R=2</annotation><annotation encoding="application/x-llamapun" id="S3.T2.6.6.6.2.m1.1d">italic_R = 2</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T2.7.7.7.3" style="padding:1pt 3.4pt;"><math alttext="R=2" class="ltx_Math" display="inline" id="S3.T2.7.7.7.3.m1.1"><semantics id="S3.T2.7.7.7.3.m1.1a"><mrow id="S3.T2.7.7.7.3.m1.1.1" xref="S3.T2.7.7.7.3.m1.1.1.cmml"><mi id="S3.T2.7.7.7.3.m1.1.1.2" xref="S3.T2.7.7.7.3.m1.1.1.2.cmml">R</mi><mo id="S3.T2.7.7.7.3.m1.1.1.1" xref="S3.T2.7.7.7.3.m1.1.1.1.cmml">=</mo><mn id="S3.T2.7.7.7.3.m1.1.1.3" xref="S3.T2.7.7.7.3.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.7.3.m1.1b"><apply id="S3.T2.7.7.7.3.m1.1.1.cmml" xref="S3.T2.7.7.7.3.m1.1.1"><eq id="S3.T2.7.7.7.3.m1.1.1.1.cmml" xref="S3.T2.7.7.7.3.m1.1.1.1"></eq><ci id="S3.T2.7.7.7.3.m1.1.1.2.cmml" xref="S3.T2.7.7.7.3.m1.1.1.2">𝑅</ci><cn id="S3.T2.7.7.7.3.m1.1.1.3.cmml" type="integer" xref="S3.T2.7.7.7.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.7.3.m1.1c">R=2</annotation><annotation encoding="application/x-llamapun" id="S3.T2.7.7.7.3.m1.1d">italic_R = 2</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T2.8.8.8.4" style="padding:1pt 3.4pt;"><math alttext="R=2" class="ltx_Math" display="inline" id="S3.T2.8.8.8.4.m1.1"><semantics id="S3.T2.8.8.8.4.m1.1a"><mrow id="S3.T2.8.8.8.4.m1.1.1" xref="S3.T2.8.8.8.4.m1.1.1.cmml"><mi id="S3.T2.8.8.8.4.m1.1.1.2" xref="S3.T2.8.8.8.4.m1.1.1.2.cmml">R</mi><mo id="S3.T2.8.8.8.4.m1.1.1.1" xref="S3.T2.8.8.8.4.m1.1.1.1.cmml">=</mo><mn id="S3.T2.8.8.8.4.m1.1.1.3" xref="S3.T2.8.8.8.4.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.8.8.8.4.m1.1b"><apply id="S3.T2.8.8.8.4.m1.1.1.cmml" xref="S3.T2.8.8.8.4.m1.1.1"><eq id="S3.T2.8.8.8.4.m1.1.1.1.cmml" xref="S3.T2.8.8.8.4.m1.1.1.1"></eq><ci id="S3.T2.8.8.8.4.m1.1.1.2.cmml" xref="S3.T2.8.8.8.4.m1.1.1.2">𝑅</ci><cn id="S3.T2.8.8.8.4.m1.1.1.3.cmml" type="integer" xref="S3.T2.8.8.8.4.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.8.8.4.m1.1c">R=2</annotation><annotation encoding="application/x-llamapun" id="S3.T2.8.8.8.4.m1.1d">italic_R = 2</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.8.8.9">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.8.8.9.1" style="padding:1pt 3.4pt;">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.8.8.9.2" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.8.8.9.2.1">1.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.8.8.9.3" style="padding:1pt 3.4pt;">0.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.8.8.9.4" style="padding:1pt 3.4pt;">0.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.8.8.9.5" style="padding:1pt 3.4pt;">0.55</td>
</tr>
<tr class="ltx_tr" id="S3.T2.8.8.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.8.8.10.1" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_smallcaps" id="S3.T2.8.8.10.1.1">Diff</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.8.8.10.2" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.8.8.10.2.1">1.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.8.8.10.3" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.8.8.10.3.1">0.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.8.8.10.4" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.8.8.10.4.1">0.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.8.8.10.5" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.8.8.10.5.1">0.85</span></td>
</tr>
</tbody></table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Multi-needle retrieval accuracy in 4K length, averaged over the answer needle positions. <math alttext="N" class="ltx_Math" display="inline" id="S3.T2.11.m1.1"><semantics id="S3.T2.11.m1.1b"><mi id="S3.T2.11.m1.1.1" xref="S3.T2.11.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.T2.11.m1.1c"><ci id="S3.T2.11.m1.1.1.cmml" xref="S3.T2.11.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.11.m1.1d">N</annotation><annotation encoding="application/x-llamapun" id="S3.T2.11.m1.1e">italic_N</annotation></semantics></math> represents the number of needles, and <math alttext="R" class="ltx_Math" display="inline" id="S3.T2.12.m2.1"><semantics id="S3.T2.12.m2.1b"><mi id="S3.T2.12.m2.1.1" xref="S3.T2.12.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.T2.12.m2.1c"><ci id="S3.T2.12.m2.1.1.cmml" xref="S3.T2.12.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.12.m2.1d">R</annotation><annotation encoding="application/x-llamapun" id="S3.T2.12.m2.1e">italic_R</annotation></semantics></math> denotes the number of query cities.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.8"><span class="ltx_text ltx_font_bold" id="S3.SS4.p2.8.1">Retrieve from 4K Context Length</span>&nbsp;&nbsp;
As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.T2" title="In 3.4 Key Information Retrieval ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a>, we insert <math alttext="N=1,2,4,6" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.4"><semantics id="S3.SS4.p2.1.m1.4a"><mrow id="S3.SS4.p2.1.m1.4.5" xref="S3.SS4.p2.1.m1.4.5.cmml"><mi id="S3.SS4.p2.1.m1.4.5.2" xref="S3.SS4.p2.1.m1.4.5.2.cmml">N</mi><mo id="S3.SS4.p2.1.m1.4.5.1" xref="S3.SS4.p2.1.m1.4.5.1.cmml">=</mo><mrow id="S3.SS4.p2.1.m1.4.5.3.2" xref="S3.SS4.p2.1.m1.4.5.3.1.cmml"><mn id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">1</mn><mo id="S3.SS4.p2.1.m1.4.5.3.2.1" xref="S3.SS4.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S3.SS4.p2.1.m1.2.2" xref="S3.SS4.p2.1.m1.2.2.cmml">2</mn><mo id="S3.SS4.p2.1.m1.4.5.3.2.2" xref="S3.SS4.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S3.SS4.p2.1.m1.3.3" xref="S3.SS4.p2.1.m1.3.3.cmml">4</mn><mo id="S3.SS4.p2.1.m1.4.5.3.2.3" xref="S3.SS4.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S3.SS4.p2.1.m1.4.4" xref="S3.SS4.p2.1.m1.4.4.cmml">6</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.4b"><apply id="S3.SS4.p2.1.m1.4.5.cmml" xref="S3.SS4.p2.1.m1.4.5"><eq id="S3.SS4.p2.1.m1.4.5.1.cmml" xref="S3.SS4.p2.1.m1.4.5.1"></eq><ci id="S3.SS4.p2.1.m1.4.5.2.cmml" xref="S3.SS4.p2.1.m1.4.5.2">𝑁</ci><list id="S3.SS4.p2.1.m1.4.5.3.1.cmml" xref="S3.SS4.p2.1.m1.4.5.3.2"><cn id="S3.SS4.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS4.p2.1.m1.1.1">1</cn><cn id="S3.SS4.p2.1.m1.2.2.cmml" type="integer" xref="S3.SS4.p2.1.m1.2.2">2</cn><cn id="S3.SS4.p2.1.m1.3.3.cmml" type="integer" xref="S3.SS4.p2.1.m1.3.3">4</cn><cn id="S3.SS4.p2.1.m1.4.4.cmml" type="integer" xref="S3.SS4.p2.1.m1.4.4">6</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.4c">N=1,2,4,6</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.4d">italic_N = 1 , 2 , 4 , 6</annotation></semantics></math> needles into 4K-length contexts and retrieve <math alttext="R=1,2" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.2"><semantics id="S3.SS4.p2.2.m2.2a"><mrow id="S3.SS4.p2.2.m2.2.3" xref="S3.SS4.p2.2.m2.2.3.cmml"><mi id="S3.SS4.p2.2.m2.2.3.2" xref="S3.SS4.p2.2.m2.2.3.2.cmml">R</mi><mo id="S3.SS4.p2.2.m2.2.3.1" xref="S3.SS4.p2.2.m2.2.3.1.cmml">=</mo><mrow id="S3.SS4.p2.2.m2.2.3.3.2" xref="S3.SS4.p2.2.m2.2.3.3.1.cmml"><mn id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">1</mn><mo id="S3.SS4.p2.2.m2.2.3.3.2.1" xref="S3.SS4.p2.2.m2.2.3.3.1.cmml">,</mo><mn id="S3.SS4.p2.2.m2.2.2" xref="S3.SS4.p2.2.m2.2.2.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.2b"><apply id="S3.SS4.p2.2.m2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.3"><eq id="S3.SS4.p2.2.m2.2.3.1.cmml" xref="S3.SS4.p2.2.m2.2.3.1"></eq><ci id="S3.SS4.p2.2.m2.2.3.2.cmml" xref="S3.SS4.p2.2.m2.2.3.2">𝑅</ci><list id="S3.SS4.p2.2.m2.2.3.3.1.cmml" xref="S3.SS4.p2.2.m2.2.3.3.2"><cn id="S3.SS4.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS4.p2.2.m2.1.1">1</cn><cn id="S3.SS4.p2.2.m2.2.2.cmml" type="integer" xref="S3.SS4.p2.2.m2.2.2">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.2c">R=1,2</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.2d">italic_R = 1 , 2</annotation></semantics></math> needles.
We evaluate 3B-size models trained with 4K input length (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A2" title="Appendix B Language Modeling Evaluation ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">B</span></a>).
We find that both models obtain good accuracy for <math alttext="N=1" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.1"><semantics id="S3.SS4.p2.3.m3.1a"><mrow id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">N</mi><mo id="S3.SS4.p2.3.m3.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><eq id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1"></eq><ci id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2">𝑁</ci><cn id="S3.SS4.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS4.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">N=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m3.1d">italic_N = 1</annotation></semantics></math> and <math alttext="N=2" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m4.1"><semantics id="S3.SS4.p2.4.m4.1a"><mrow id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml"><mi id="S3.SS4.p2.4.m4.1.1.2" xref="S3.SS4.p2.4.m4.1.1.2.cmml">N</mi><mo id="S3.SS4.p2.4.m4.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1"><eq id="S3.SS4.p2.4.m4.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1"></eq><ci id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2">𝑁</ci><cn id="S3.SS4.p2.4.m4.1.1.3.cmml" type="integer" xref="S3.SS4.p2.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">N=2</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.4.m4.1d">italic_N = 2</annotation></semantics></math>.
As <math alttext="N" class="ltx_Math" display="inline" id="S3.SS4.p2.5.m5.1"><semantics id="S3.SS4.p2.5.m5.1a"><mi id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><ci id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.5.m5.1d">italic_N</annotation></semantics></math> and <math alttext="R" class="ltx_Math" display="inline" id="S3.SS4.p2.6.m6.1"><semantics id="S3.SS4.p2.6.m6.1a"><mi id="S3.SS4.p2.6.m6.1.1" xref="S3.SS4.p2.6.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m6.1b"><ci id="S3.SS4.p2.6.m6.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m6.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.6.m6.1d">italic_R</annotation></semantics></math> increase, <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.8.2">Diff</span> Transformer maintains a consistent accuracy, while the performance of Transformer drops significantly.
In particular, at <math alttext="N=6,R=2" class="ltx_Math" display="inline" id="S3.SS4.p2.7.m7.2"><semantics id="S3.SS4.p2.7.m7.2a"><mrow id="S3.SS4.p2.7.m7.2.2.2" xref="S3.SS4.p2.7.m7.2.2.3.cmml"><mrow id="S3.SS4.p2.7.m7.1.1.1.1" xref="S3.SS4.p2.7.m7.1.1.1.1.cmml"><mi id="S3.SS4.p2.7.m7.1.1.1.1.2" xref="S3.SS4.p2.7.m7.1.1.1.1.2.cmml">N</mi><mo id="S3.SS4.p2.7.m7.1.1.1.1.1" xref="S3.SS4.p2.7.m7.1.1.1.1.1.cmml">=</mo><mn id="S3.SS4.p2.7.m7.1.1.1.1.3" xref="S3.SS4.p2.7.m7.1.1.1.1.3.cmml">6</mn></mrow><mo id="S3.SS4.p2.7.m7.2.2.2.3" xref="S3.SS4.p2.7.m7.2.2.3a.cmml">,</mo><mrow id="S3.SS4.p2.7.m7.2.2.2.2" xref="S3.SS4.p2.7.m7.2.2.2.2.cmml"><mi id="S3.SS4.p2.7.m7.2.2.2.2.2" xref="S3.SS4.p2.7.m7.2.2.2.2.2.cmml">R</mi><mo id="S3.SS4.p2.7.m7.2.2.2.2.1" xref="S3.SS4.p2.7.m7.2.2.2.2.1.cmml">=</mo><mn id="S3.SS4.p2.7.m7.2.2.2.2.3" xref="S3.SS4.p2.7.m7.2.2.2.2.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m7.2b"><apply id="S3.SS4.p2.7.m7.2.2.3.cmml" xref="S3.SS4.p2.7.m7.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m7.2.2.3a.cmml" xref="S3.SS4.p2.7.m7.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS4.p2.7.m7.1.1.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1"><eq id="S3.SS4.p2.7.m7.1.1.1.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1.1"></eq><ci id="S3.SS4.p2.7.m7.1.1.1.1.2.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1.2">𝑁</ci><cn id="S3.SS4.p2.7.m7.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p2.7.m7.1.1.1.1.3">6</cn></apply><apply id="S3.SS4.p2.7.m7.2.2.2.2.cmml" xref="S3.SS4.p2.7.m7.2.2.2.2"><eq id="S3.SS4.p2.7.m7.2.2.2.2.1.cmml" xref="S3.SS4.p2.7.m7.2.2.2.2.1"></eq><ci id="S3.SS4.p2.7.m7.2.2.2.2.2.cmml" xref="S3.SS4.p2.7.m7.2.2.2.2.2">𝑅</ci><cn id="S3.SS4.p2.7.m7.2.2.2.2.3.cmml" type="integer" xref="S3.SS4.p2.7.m7.2.2.2.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m7.2c">N=6,R=2</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.7.m7.2d">italic_N = 6 , italic_R = 2</annotation></semantics></math>, the accuracy gap between the two models reaches <math alttext="30\%" class="ltx_Math" display="inline" id="S3.SS4.p2.8.m8.1"><semantics id="S3.SS4.p2.8.m8.1a"><mrow id="S3.SS4.p2.8.m8.1.1" xref="S3.SS4.p2.8.m8.1.1.cmml"><mn id="S3.SS4.p2.8.m8.1.1.2" xref="S3.SS4.p2.8.m8.1.1.2.cmml">30</mn><mo id="S3.SS4.p2.8.m8.1.1.1" xref="S3.SS4.p2.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m8.1b"><apply id="S3.SS4.p2.8.m8.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1"><csymbol cd="latexml" id="S3.SS4.p2.8.m8.1.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1.1">percent</csymbol><cn id="S3.SS4.p2.8.m8.1.1.2.cmml" type="integer" xref="S3.SS4.p2.8.m8.1.1.2">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m8.1c">30\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.8.m8.1d">30 %</annotation></semantics></math>.
The results indicate the superior ability of <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.8.3">Diff</span> Transformer to retrieve key information in distracting contexts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="604" id="S3.F5.sf1.g1" src="https://arxiv.org/html/2410.05258v1/x6.png" width="831">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Transformer.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="604" id="S3.F5.sf2.g1" src="https://arxiv.org/html/2410.05258v1/x7.png" width="831">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text ltx_font_smallcaps" id="S3.F5.sf2.2.1">Diff</span> Transformer.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Multi-needle retrieval results in 64k length.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.2"><span class="ltx_text ltx_font_bold" id="S3.SS4.p3.2.1">Retrieve from 64K Context Length</span>&nbsp;&nbsp;
As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F5" title="In 3.4 Key Information Retrieval ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">5</span></a>, the evaluated context length ranges from 8K to 64K for the <math alttext="N=8,R=1" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.2"><semantics id="S3.SS4.p3.1.m1.2a"><mrow id="S3.SS4.p3.1.m1.2.2.2" xref="S3.SS4.p3.1.m1.2.2.3.cmml"><mrow id="S3.SS4.p3.1.m1.1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.1.1.2.cmml">N</mi><mo id="S3.SS4.p3.1.m1.1.1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S3.SS4.p3.1.m1.1.1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.1.1.3.cmml">8</mn></mrow><mo id="S3.SS4.p3.1.m1.2.2.2.3" xref="S3.SS4.p3.1.m1.2.2.3a.cmml">,</mo><mrow id="S3.SS4.p3.1.m1.2.2.2.2" xref="S3.SS4.p3.1.m1.2.2.2.2.cmml"><mi id="S3.SS4.p3.1.m1.2.2.2.2.2" xref="S3.SS4.p3.1.m1.2.2.2.2.2.cmml">R</mi><mo id="S3.SS4.p3.1.m1.2.2.2.2.1" xref="S3.SS4.p3.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S3.SS4.p3.1.m1.2.2.2.2.3" xref="S3.SS4.p3.1.m1.2.2.2.2.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.2b"><apply id="S3.SS4.p3.1.m1.2.2.3.cmml" xref="S3.SS4.p3.1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.2.2.3a.cmml" xref="S3.SS4.p3.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS4.p3.1.m1.1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1"><eq id="S3.SS4.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1"></eq><ci id="S3.SS4.p3.1.m1.1.1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.2">𝑁</ci><cn id="S3.SS4.p3.1.m1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p3.1.m1.1.1.1.1.3">8</cn></apply><apply id="S3.SS4.p3.1.m1.2.2.2.2.cmml" xref="S3.SS4.p3.1.m1.2.2.2.2"><eq id="S3.SS4.p3.1.m1.2.2.2.2.1.cmml" xref="S3.SS4.p3.1.m1.2.2.2.2.1"></eq><ci id="S3.SS4.p3.1.m1.2.2.2.2.2.cmml" xref="S3.SS4.p3.1.m1.2.2.2.2.2">𝑅</ci><cn id="S3.SS4.p3.1.m1.2.2.2.2.3.cmml" type="integer" xref="S3.SS4.p3.1.m1.2.2.2.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.2c">N=8,R=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.2d">italic_N = 8 , italic_R = 1</annotation></semantics></math> setting.
We evaluate the 3B-size models with length extension (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS3" title="3.3 Long-Context Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.3</span></a>).
We report the accuracy across varying answer needle depths (y-axis) and context lengths (x-axis).
The bottom row is the average accuracy for all depths.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.2.2">Diff</span> Transformer maintains stable performance across different context lengths.
In contrast, Transformer’s average accuracy gradually declines as the context length increases up to the maximal length, i.e., 64K.
Besides, <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.2.3">Diff</span> Transformer outperforms Transformer particularly when key information is positioned within the first half of the context (i.e., 0%, 25%, and 50% depth).
In particular, when needles are placed at the 25% depth in a 64K context, <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.2.4">Diff</span> Transformer achieves <math alttext="76\%" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><mrow id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><mn id="S3.SS4.p3.2.m2.1.1.2" xref="S3.SS4.p3.2.m2.1.1.2.cmml">76</mn><mo id="S3.SS4.p3.2.m2.1.1.1" xref="S3.SS4.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="latexml" id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1">percent</csymbol><cn id="S3.SS4.p3.2.m2.1.1.2.cmml" type="integer" xref="S3.SS4.p3.2.m2.1.1.2">76</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">76\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">76 %</annotation></semantics></math> accuracy improvement over Transformer.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T3.12" style="width:357.7pt;height:67.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-11.6pt,2.2pt) scale(0.938864400784251,0.938864400784251) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T3.12.12">
<tbody><tr class="ltx_tr" id="S3.T3.2.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T3.2.2.2.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T3.2.2.2.3.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S3.T3.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.1.1">Attention to Answer <math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T3.1.1.1.1.1.m1.1"><semantics id="S3.T3.1.1.1.1.1.m1.1a"><mo id="S3.T3.1.1.1.1.1.m1.1.1" stretchy="false" xref="S3.T3.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T3.1.1.1.1.1.m1.1b"><ci id="S3.T3.1.1.1.1.1.m1.1.1.cmml" xref="S3.T3.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T3.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S3.T3.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T3.2.2.2.2.1">Attention Noise <math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T3.2.2.2.2.1.m1.1"><semantics id="S3.T3.2.2.2.2.1.m1.1a"><mo id="S3.T3.2.2.2.2.1.m1.1.1" stretchy="false" xref="S3.T3.2.2.2.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T3.2.2.2.2.1.m1.1b"><ci id="S3.T3.2.2.2.2.1.m1.1.1.cmml" xref="S3.T3.2.2.2.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.2.2.2.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T3.2.2.2.2.1.m1.1d">↓</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.12.12.12">
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.1"><math alttext="0\%" class="ltx_Math" display="inline" id="S3.T3.3.3.3.1.m1.1"><semantics id="S3.T3.3.3.3.1.m1.1a"><mrow id="S3.T3.3.3.3.1.m1.1.1" xref="S3.T3.3.3.3.1.m1.1.1.cmml"><mn id="S3.T3.3.3.3.1.m1.1.1.2" xref="S3.T3.3.3.3.1.m1.1.1.2.cmml">0</mn><mo id="S3.T3.3.3.3.1.m1.1.1.1" xref="S3.T3.3.3.3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.3.3.3.1.m1.1b"><apply id="S3.T3.3.3.3.1.m1.1.1.cmml" xref="S3.T3.3.3.3.1.m1.1.1"><csymbol cd="latexml" id="S3.T3.3.3.3.1.m1.1.1.1.cmml" xref="S3.T3.3.3.3.1.m1.1.1.1">percent</csymbol><cn id="S3.T3.3.3.3.1.m1.1.1.2.cmml" type="integer" xref="S3.T3.3.3.3.1.m1.1.1.2">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.3.3.3.1.m1.1c">0\%</annotation><annotation encoding="application/x-llamapun" id="S3.T3.3.3.3.1.m1.1d">0 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.4.4.2"><math alttext="25\%" class="ltx_Math" display="inline" id="S3.T3.4.4.4.2.m1.1"><semantics id="S3.T3.4.4.4.2.m1.1a"><mrow id="S3.T3.4.4.4.2.m1.1.1" xref="S3.T3.4.4.4.2.m1.1.1.cmml"><mn id="S3.T3.4.4.4.2.m1.1.1.2" xref="S3.T3.4.4.4.2.m1.1.1.2.cmml">25</mn><mo id="S3.T3.4.4.4.2.m1.1.1.1" xref="S3.T3.4.4.4.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.4.4.4.2.m1.1b"><apply id="S3.T3.4.4.4.2.m1.1.1.cmml" xref="S3.T3.4.4.4.2.m1.1.1"><csymbol cd="latexml" id="S3.T3.4.4.4.2.m1.1.1.1.cmml" xref="S3.T3.4.4.4.2.m1.1.1.1">percent</csymbol><cn id="S3.T3.4.4.4.2.m1.1.1.2.cmml" type="integer" xref="S3.T3.4.4.4.2.m1.1.1.2">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.4.4.4.2.m1.1c">25\%</annotation><annotation encoding="application/x-llamapun" id="S3.T3.4.4.4.2.m1.1d">25 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.5.5.5.3"><math alttext="50\%" class="ltx_Math" display="inline" id="S3.T3.5.5.5.3.m1.1"><semantics id="S3.T3.5.5.5.3.m1.1a"><mrow id="S3.T3.5.5.5.3.m1.1.1" xref="S3.T3.5.5.5.3.m1.1.1.cmml"><mn id="S3.T3.5.5.5.3.m1.1.1.2" xref="S3.T3.5.5.5.3.m1.1.1.2.cmml">50</mn><mo id="S3.T3.5.5.5.3.m1.1.1.1" xref="S3.T3.5.5.5.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.5.5.5.3.m1.1b"><apply id="S3.T3.5.5.5.3.m1.1.1.cmml" xref="S3.T3.5.5.5.3.m1.1.1"><csymbol cd="latexml" id="S3.T3.5.5.5.3.m1.1.1.1.cmml" xref="S3.T3.5.5.5.3.m1.1.1.1">percent</csymbol><cn id="S3.T3.5.5.5.3.m1.1.1.2.cmml" type="integer" xref="S3.T3.5.5.5.3.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.5.5.5.3.m1.1c">50\%</annotation><annotation encoding="application/x-llamapun" id="S3.T3.5.5.5.3.m1.1d">50 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.6.6.4"><math alttext="75\%" class="ltx_Math" display="inline" id="S3.T3.6.6.6.4.m1.1"><semantics id="S3.T3.6.6.6.4.m1.1a"><mrow id="S3.T3.6.6.6.4.m1.1.1" xref="S3.T3.6.6.6.4.m1.1.1.cmml"><mn id="S3.T3.6.6.6.4.m1.1.1.2" xref="S3.T3.6.6.6.4.m1.1.1.2.cmml">75</mn><mo id="S3.T3.6.6.6.4.m1.1.1.1" xref="S3.T3.6.6.6.4.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.6.6.6.4.m1.1b"><apply id="S3.T3.6.6.6.4.m1.1.1.cmml" xref="S3.T3.6.6.6.4.m1.1.1"><csymbol cd="latexml" id="S3.T3.6.6.6.4.m1.1.1.1.cmml" xref="S3.T3.6.6.6.4.m1.1.1.1">percent</csymbol><cn id="S3.T3.6.6.6.4.m1.1.1.2.cmml" type="integer" xref="S3.T3.6.6.6.4.m1.1.1.2">75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.6.6.6.4.m1.1c">75\%</annotation><annotation encoding="application/x-llamapun" id="S3.T3.6.6.6.4.m1.1d">75 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.7.7.7.5"><math alttext="100\%" class="ltx_Math" display="inline" id="S3.T3.7.7.7.5.m1.1"><semantics id="S3.T3.7.7.7.5.m1.1a"><mrow id="S3.T3.7.7.7.5.m1.1.1" xref="S3.T3.7.7.7.5.m1.1.1.cmml"><mn id="S3.T3.7.7.7.5.m1.1.1.2" xref="S3.T3.7.7.7.5.m1.1.1.2.cmml">100</mn><mo id="S3.T3.7.7.7.5.m1.1.1.1" xref="S3.T3.7.7.7.5.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.7.7.7.5.m1.1b"><apply id="S3.T3.7.7.7.5.m1.1.1.cmml" xref="S3.T3.7.7.7.5.m1.1.1"><csymbol cd="latexml" id="S3.T3.7.7.7.5.m1.1.1.1.cmml" xref="S3.T3.7.7.7.5.m1.1.1.1">percent</csymbol><cn id="S3.T3.7.7.7.5.m1.1.1.2.cmml" type="integer" xref="S3.T3.7.7.7.5.m1.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.7.7.7.5.m1.1c">100\%</annotation><annotation encoding="application/x-llamapun" id="S3.T3.7.7.7.5.m1.1d">100 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.8.8.6"><math alttext="0\%" class="ltx_Math" display="inline" id="S3.T3.8.8.8.6.m1.1"><semantics id="S3.T3.8.8.8.6.m1.1a"><mrow id="S3.T3.8.8.8.6.m1.1.1" xref="S3.T3.8.8.8.6.m1.1.1.cmml"><mn id="S3.T3.8.8.8.6.m1.1.1.2" xref="S3.T3.8.8.8.6.m1.1.1.2.cmml">0</mn><mo id="S3.T3.8.8.8.6.m1.1.1.1" xref="S3.T3.8.8.8.6.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.8.8.8.6.m1.1b"><apply id="S3.T3.8.8.8.6.m1.1.1.cmml" xref="S3.T3.8.8.8.6.m1.1.1"><csymbol cd="latexml" id="S3.T3.8.8.8.6.m1.1.1.1.cmml" xref="S3.T3.8.8.8.6.m1.1.1.1">percent</csymbol><cn id="S3.T3.8.8.8.6.m1.1.1.2.cmml" type="integer" xref="S3.T3.8.8.8.6.m1.1.1.2">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.8.8.8.6.m1.1c">0\%</annotation><annotation encoding="application/x-llamapun" id="S3.T3.8.8.8.6.m1.1d">0 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.9.9.9.7"><math alttext="25\%" class="ltx_Math" display="inline" id="S3.T3.9.9.9.7.m1.1"><semantics id="S3.T3.9.9.9.7.m1.1a"><mrow id="S3.T3.9.9.9.7.m1.1.1" xref="S3.T3.9.9.9.7.m1.1.1.cmml"><mn id="S3.T3.9.9.9.7.m1.1.1.2" xref="S3.T3.9.9.9.7.m1.1.1.2.cmml">25</mn><mo id="S3.T3.9.9.9.7.m1.1.1.1" xref="S3.T3.9.9.9.7.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.9.9.9.7.m1.1b"><apply id="S3.T3.9.9.9.7.m1.1.1.cmml" xref="S3.T3.9.9.9.7.m1.1.1"><csymbol cd="latexml" id="S3.T3.9.9.9.7.m1.1.1.1.cmml" xref="S3.T3.9.9.9.7.m1.1.1.1">percent</csymbol><cn id="S3.T3.9.9.9.7.m1.1.1.2.cmml" type="integer" xref="S3.T3.9.9.9.7.m1.1.1.2">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.9.9.9.7.m1.1c">25\%</annotation><annotation encoding="application/x-llamapun" id="S3.T3.9.9.9.7.m1.1d">25 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.10.10.10.8"><math alttext="50\%" class="ltx_Math" display="inline" id="S3.T3.10.10.10.8.m1.1"><semantics id="S3.T3.10.10.10.8.m1.1a"><mrow id="S3.T3.10.10.10.8.m1.1.1" xref="S3.T3.10.10.10.8.m1.1.1.cmml"><mn id="S3.T3.10.10.10.8.m1.1.1.2" xref="S3.T3.10.10.10.8.m1.1.1.2.cmml">50</mn><mo id="S3.T3.10.10.10.8.m1.1.1.1" xref="S3.T3.10.10.10.8.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.10.10.10.8.m1.1b"><apply id="S3.T3.10.10.10.8.m1.1.1.cmml" xref="S3.T3.10.10.10.8.m1.1.1"><csymbol cd="latexml" id="S3.T3.10.10.10.8.m1.1.1.1.cmml" xref="S3.T3.10.10.10.8.m1.1.1.1">percent</csymbol><cn id="S3.T3.10.10.10.8.m1.1.1.2.cmml" type="integer" xref="S3.T3.10.10.10.8.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.10.10.10.8.m1.1c">50\%</annotation><annotation encoding="application/x-llamapun" id="S3.T3.10.10.10.8.m1.1d">50 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.11.11.11.9"><math alttext="75\%" class="ltx_Math" display="inline" id="S3.T3.11.11.11.9.m1.1"><semantics id="S3.T3.11.11.11.9.m1.1a"><mrow id="S3.T3.11.11.11.9.m1.1.1" xref="S3.T3.11.11.11.9.m1.1.1.cmml"><mn id="S3.T3.11.11.11.9.m1.1.1.2" xref="S3.T3.11.11.11.9.m1.1.1.2.cmml">75</mn><mo id="S3.T3.11.11.11.9.m1.1.1.1" xref="S3.T3.11.11.11.9.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.11.11.11.9.m1.1b"><apply id="S3.T3.11.11.11.9.m1.1.1.cmml" xref="S3.T3.11.11.11.9.m1.1.1"><csymbol cd="latexml" id="S3.T3.11.11.11.9.m1.1.1.1.cmml" xref="S3.T3.11.11.11.9.m1.1.1.1">percent</csymbol><cn id="S3.T3.11.11.11.9.m1.1.1.2.cmml" type="integer" xref="S3.T3.11.11.11.9.m1.1.1.2">75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.11.11.11.9.m1.1c">75\%</annotation><annotation encoding="application/x-llamapun" id="S3.T3.11.11.11.9.m1.1d">75 %</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.12.12.12.10"><math alttext="100\%" class="ltx_Math" display="inline" id="S3.T3.12.12.12.10.m1.1"><semantics id="S3.T3.12.12.12.10.m1.1a"><mrow id="S3.T3.12.12.12.10.m1.1.1" xref="S3.T3.12.12.12.10.m1.1.1.cmml"><mn id="S3.T3.12.12.12.10.m1.1.1.2" xref="S3.T3.12.12.12.10.m1.1.1.2.cmml">100</mn><mo id="S3.T3.12.12.12.10.m1.1.1.1" xref="S3.T3.12.12.12.10.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.12.12.12.10.m1.1b"><apply id="S3.T3.12.12.12.10.m1.1.1.cmml" xref="S3.T3.12.12.12.10.m1.1.1"><csymbol cd="latexml" id="S3.T3.12.12.12.10.m1.1.1.1.cmml" xref="S3.T3.12.12.12.10.m1.1.1.1">percent</csymbol><cn id="S3.T3.12.12.12.10.m1.1.1.2.cmml" type="integer" xref="S3.T3.12.12.12.10.m1.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.12.12.12.10.m1.1c">100\%</annotation><annotation encoding="application/x-llamapun" id="S3.T3.12.12.12.10.m1.1d">100 %</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T3.12.12.13">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T3.12.12.13.1">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.12.12.13.2">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.12.12.13.3">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.12.12.13.4">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.12.12.13.5">0.07</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.12.12.13.6">0.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.12.12.13.7">0.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.12.12.13.8">0.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.12.12.13.9">0.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.12.12.13.10">0.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.12.12.13.11">0.49</td>
</tr>
<tr class="ltx_tr" id="S3.T3.12.12.14">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S3.T3.12.12.14.1"><span class="ltx_text ltx_font_smallcaps" id="S3.T3.12.12.14.1.1">Diff</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.12.12.14.2"><span class="ltx_text ltx_font_bold" id="S3.T3.12.12.14.2.1">0.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.12.12.14.3"><span class="ltx_text ltx_font_bold" id="S3.T3.12.12.14.3.1">0.30</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.12.12.14.4"><span class="ltx_text ltx_font_bold" id="S3.T3.12.12.14.4.1">0.31</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.12.12.14.5"><span class="ltx_text ltx_font_bold" id="S3.T3.12.12.14.5.1">0.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T3.12.12.14.6"><span class="ltx_text ltx_font_bold" id="S3.T3.12.12.14.6.1">0.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.12.12.14.7"><span class="ltx_text ltx_font_bold" id="S3.T3.12.12.14.7.1">0.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.12.12.14.8"><span class="ltx_text ltx_font_bold" id="S3.T3.12.12.14.8.1">0.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.12.12.14.9"><span class="ltx_text ltx_font_bold" id="S3.T3.12.12.14.9.1">0.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.12.12.14.10"><span class="ltx_text ltx_font_bold" id="S3.T3.12.12.14.10.1">0.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.12.12.14.11"><span class="ltx_text ltx_font_bold" id="S3.T3.12.12.14.11.1">0.01</span></td>
</tr>
</tbody></table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Attention scores allocated to answer spans and noise context in the key information retrieval task. The target answer is inserted in varying positions (i.e., depth) of context.
<span class="ltx_text ltx_font_smallcaps" id="S3.T3.14.1">Diff</span> Transformer allocates more attention scores to useful information and effectively cancels out attention noise.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p4.1.1">Attention Score Analysis</span>&nbsp;&nbsp;
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.T3" title="In 3.4 Key Information Retrieval ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">3</span></a> presents the attention scores allocated to the answer span and the noise context for the key information retrieval task.
The scores indicate the model’s ability to preserve useful information against attention noise.
We compare the normalized attention scores when key information is inserted at different positions (i.e., depths) within the context.
Compared with Transformer, <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p4.1.2">Diff</span> Transformer allocates higher attention scores to the answer span and has lower attention noise.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>In-Context Learning</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">We evaluate in-context learning from two perspectives, including many-shot classification and robustness of in-context learning.
In-context learning is a fundamental capability of language models, which indicates how well a model can utilize input context.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS5.p2.1.1">Many-Shot In-Context Learning</span>&nbsp;&nbsp;
As presented in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F6" title="In 3.5 In-Context Learning ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">6</span></a>, we compare the accuracy of many-shot classification between Transformer and our architecture.
We evaluate the 3B-size language models that support 64K input length (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS3" title="3.3 Long-Context Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.3</span></a>).
We follow the evaluation protocol of <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib3" title="">3</a>]</cite> and use constrained decoding&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib30" title="">30</a>]</cite>.
We incrementally increase the number of demonstration samples from 1-shot until the total length reaches 64K length.
Specifically, the TREC&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib15" title="">15</a>]</cite> dataset has 6 classes, TREC-fine&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib15" title="">15</a>]</cite> has 50 classes, Banking-77&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib5" title="">5</a>]</cite> has 77 classes, and Clinic-150&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib20" title="">20</a>]</cite> has 150 classes.
The results show that <span class="ltx_text ltx_font_smallcaps" id="S3.SS5.p2.1.2">Diff</span> Transformer consistently outperforms Transformer across datasets and varying numbers of demonstration samples.
Moreover, the improvement in average accuracy is substantial, ranging from 5.2% to 21.6%.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="575" id="S3.F6.sf1.g1" src="https://arxiv.org/html/2410.05258v1/x8.png" width="788">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>TREC with 6 classes.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="575" id="S3.F6.sf2.g1" src="https://arxiv.org/html/2410.05258v1/x9.png" width="788">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>TREC-fine with 50 classes.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F6.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="575" id="S3.F6.sf3.g1" src="https://arxiv.org/html/2410.05258v1/x10.png" width="788">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Banking-77 with 77 classes.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F6.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="575" id="S3.F6.sf4.g1" src="https://arxiv.org/html/2410.05258v1/x11.png" width="788">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Clinic-150 with 150 classes.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Many-shot in-context learning accuracy on four datasets.
Demonstration examples increase from 1-shot until the total length reaches 64K tokens. The dashed lines represent the average accuracy after the performance becomes stable.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S3.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="610" id="S3.F7.sf1.g1" src="https://arxiv.org/html/2410.05258v1/x12.png" width="829">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Examples are randomly arranged.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="611" id="S3.F7.sf2.g1" src="https://arxiv.org/html/2410.05258v1/x13.png" width="829">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Examples are arranged alternately by class.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Robustness evaluation of in-context learning on the TREC dataset.
Accuracy is evaluated with order permutations of demonstration examples by sweeping random seeds.
The dash lines represent the margin between the best and worst results.
Smaller margin indicates superior robustness.
Two prompt formats are examined.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS5.p3.1.1">Robustness of In-Context Learning</span>&nbsp;&nbsp;
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F7" title="In 3.5 In-Context Learning ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a> compares the robustness of in-context learning between Transformer and <span class="ltx_text ltx_font_smallcaps" id="S3.SS5.p3.1.2">Diff</span> Transformer.
Given the same demonstration examples, we analyze the performance variance with order permutations.
Lower variance indicates greater robustness and less risk of catastrophic performance degradation.
The evaluation protocol is the same as above.
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F7" title="In 3.5 In-Context Learning ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a> presents the analysis on the TREC dataset.
More results are also provided in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A5" title="Appendix E Robustness of In-Context Learning ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">E</span></a>.
We evaluate two prompt formats, i.e., examples are randomly arranged (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F7.sf1" title="In Figure 7 ‣ 3.5 In-Context Learning ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">7(a)</span></a>), and alternately arranged by class (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F7.sf2" title="In Figure 7 ‣ 3.5 In-Context Learning ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">7(b)</span></a>).
In both settings, <span class="ltx_text ltx_font_smallcaps" id="S3.SS5.p3.1.3">Diff</span> Transformer has much smaller performance variance compared to Transformer.
The results indicate that our approach is more robust for in-context learning.
In contrast, Transformer tends to be distracted by order permutations&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib25" title="">25</a>]</cite>, resulting in a huge margin between the best and worst results.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Contextual Hallucination Evaluation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.1">We evaluate contextual hallucination of the 3B-size language models (described in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A2" title="Appendix B Language Modeling Evaluation ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">B</span></a>) on text summarization and question answering.
Notice that we focus on the cases where the input context contains correct facts, but the model still fails to produce accurate outputs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p2">
<p class="ltx_p" id="S3.SS6.p2.1">We follow the evaluation protocol of <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib6" title="">6</a>]</cite>.
We feed the model output along with ground-truth responses to GPT-4o&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib27" title="">27</a>]</cite>. Then we ask GPT-4o to make binary judgements on whether the model outputs are accurate and free of hallucinations.
Previous studies&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib31" title="">31</a>]</cite> have shown that the above hallucination evaluation protocol has relatively high agreement between GPT-4o judgments and human annotations. The automatic metric is reliable and mirrors the human evaluation.
For each dataset, the accuracy is averaged over 100 samples.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T4">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S3.T4.st1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T4.st1.1" style="width:397.5pt;height:101.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(92.6pt,-23.5pt) scale(1.87165860391395,1.87165860391395) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T4.st1.1.1">
<tbody><tr class="ltx_tr" id="S3.T4.st1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T4.st1.1.1.1.1" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st1.1.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.st1.1.1.1.2" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st1.1.1.1.2.1">XSum</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.st1.1.1.1.3" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st1.1.1.1.3.1">CNN/DM</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.st1.1.1.1.4" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st1.1.1.1.4.1">MultiNews</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.st1.1.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.st1.1.1.2.1" style="padding:1pt 3.4pt;">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.st1.1.1.2.2" style="padding:1pt 3.4pt;">0.44</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.st1.1.1.2.3" style="padding:1pt 3.4pt;">0.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.st1.1.1.2.4" style="padding:1pt 3.4pt;">0.42</td>
</tr>
<tr class="ltx_tr" id="S3.T4.st1.1.1.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T4.st1.1.1.3.1" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_smallcaps" id="S3.T4.st1.1.1.3.1.1">Diff</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.st1.1.1.3.2" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st1.1.1.3.2.1">0.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.st1.1.1.3.3" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st1.1.1.3.3.1">0.41</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.st1.1.1.3.4" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st1.1.1.3.4.1">0.61</span></td>
</tr>
</tbody></table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(a) </span>Accuracy (i.e., free of hallucinations) on text summarization datasets.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S3.T4.st2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T4.st2.1" style="width:397.5pt;height:96.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(87.8pt,-21.3pt) scale(1.79062084344083,1.79062084344083) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T4.st2.1.1">
<tbody><tr class="ltx_tr" id="S3.T4.st2.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T4.st2.1.1.1.1" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st2.1.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.st2.1.1.1.2" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st2.1.1.1.2.1">Qasper</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.st2.1.1.1.3" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st2.1.1.1.3.1">HotpotQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.st2.1.1.1.4" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st2.1.1.1.4.1">2WikiMQA</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.st2.1.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.st2.1.1.2.1" style="padding:1pt 3.4pt;">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.st2.1.1.2.2" style="padding:1pt 3.4pt;">0.28</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.st2.1.1.2.3" style="padding:1pt 3.4pt;">0.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.st2.1.1.2.4" style="padding:1pt 3.4pt;">0.29</td>
</tr>
<tr class="ltx_tr" id="S3.T4.st2.1.1.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T4.st2.1.1.3.1" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_smallcaps" id="S3.T4.st2.1.1.3.1.1">Diff</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.st2.1.1.3.2" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st2.1.1.3.2.1">0.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.st2.1.1.3.3" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st2.1.1.3.3.1">0.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.st2.1.1.3.4" style="padding:1pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.st2.1.1.3.4.1">0.36</span></td>
</tr>
</tbody></table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(b) </span>Accuracy (i.e., free of hallucinations) on question answering datasets.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Evaluation of contextual hallucination on text summarization and question answering.
Higher accuracy indicates less hallucination.
We follow&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Chuang et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib6" title="">6</a>]</cite> to employ GPT-4o to make binary judgments, which has relatively high agreement with human annotation.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS6.p3">
<p class="ltx_p" id="S3.SS6.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS6.p3.1.1">Summarization</span>&nbsp;&nbsp;
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.T4.st1" title="In Table 4 ‣ 3.6 Contextual Hallucination Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">4(a)</span></a> presents hallucination evaluation on summarization datasets XSum&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib26" title="">26</a>]</cite>, CNN/DM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib33" title="">33</a>]</cite>, and MultiNews&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib10" title="">10</a>]</cite>.
The task is to generate summaries for input documents.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p4">
<p class="ltx_p" id="S3.SS6.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS6.p4.1.1">Question Answering</span>&nbsp;&nbsp;
As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.T4.st2" title="In Table 4 ‣ 3.6 Contextual Hallucination Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">4(b)</span></a>, we compare the hallucination rate of <span class="ltx_text ltx_font_smallcaps" id="S3.SS6.p4.1.2">Diff</span> Transformer and Transformer on both single- and multi-document question answering.
The Qasper&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib9" title="">9</a>]</cite> dataset is single-document question answering. In contrast, HotpotQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib45" title="">45</a>]</cite> and 2WikiMultihopQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib14" title="">14</a>]</cite> are multi-document question answering.
The goal is to answer questions about the given context.
All evaluation examples are from LongBench&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib2" title="">2</a>]</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p5">
<p class="ltx_p" id="S3.SS6.p5.1">Compared with Transformer, our method mitigates contextual hallucination on summarization and question answering.
The performance improvement possibly stems from <span class="ltx_text ltx_font_smallcaps" id="S3.SS6.p5.1.1">Diff</span> Transformer’s better focus on essential information needed for the task, instead of irrelevant context.
This aligns with previous observation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib16" title="">16</a>]</cite> that one primary reason for contextual hallucination in Transformer is the misallocation of attention scores.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.7 </span>Activation Outliers Analysis</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS7.p1">
<p class="ltx_p" id="S3.SS7.p1.1">In large language models, a subset of activations manifests with significantly larger values compared to the majority, a phenomenon commonly called activation outliers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib37" title="">37</a>]</cite>.
The outliers result in difficulties for model quantization during training and inference.
We demonstrate that <span class="ltx_text ltx_font_smallcaps" id="S3.SS7.p1.1.1">Diff</span> Transformer can reduce the magnitude of activation outliers, potentially allowing lower bit-widths for quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T5.1" style="width:397.5pt;height:89.8pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-2.8pt,0.6pt) scale(0.986313382267894,0.986313382267894) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T5.1.1">
<tbody><tr class="ltx_tr" id="S3.T5.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T5.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T5.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.2.1">Activation Type</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T5.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.3.1">Top-1</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T5.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.4.1">Top-2</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T5.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.5.1">Top-3</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T5.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.6.1">Top-10</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T5.1.1.1.7"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.7.1">Top-100</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T5.1.1.1.8"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.8.1">Median</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T5.1.1.2.1">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.2">Attention Logits</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.3">318.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.4">308.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.5">304.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.6">284.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.7">251.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.8">5.4</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.3">
<td class="ltx_td ltx_align_left" id="S3.T5.1.1.3.1"><span class="ltx_text ltx_font_smallcaps" id="S3.T5.1.1.3.1.1">Diff</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.2">Attention Logits</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.3">38.8</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.4">38.8</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.5">37.3</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.6">32.0</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.7">27.4</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.8">3.3</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T5.1.1.4.1">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.2">Hidden States</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.3">3608.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.4">3607.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.5">3603.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.6">3552.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.7">2448.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.8">0.6</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.5">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T5.1.1.5.1"><span class="ltx_text ltx_font_smallcaps" id="S3.T5.1.1.5.1.1">Diff</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.5.2">Hidden States</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.5.3">1688.2</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.5.4">1672.5</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.5.5">1672.1</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.5.6">1624.3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.5.7">740.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.5.8">1.2</td>
</tr>
</tbody></table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Largest activation values in attention logits and hidden states. Top activation values are considered as activation outliers, due to their significantly higher magnitude than the median. <span class="ltx_text ltx_font_smallcaps" id="S3.T5.3.1">Diff</span> Transformer mitigates outliers compared to Transformer.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS7.p2">
<p class="ltx_p" id="S3.SS7.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS7.p2.1.1">Statistics of Largest Activation Values</span>&nbsp;&nbsp;
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.T5" title="In 3.7 Activation Outliers Analysis ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">5</span></a> presents the statistics of activation values collected from Transformer and <span class="ltx_text ltx_font_smallcaps" id="S3.SS7.p2.1.2">Diff</span> Transformer models trained in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A2" title="Appendix B Language Modeling Evaluation ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">B</span></a>.
We analyze two types of activations, including attention logits (i.e., pre-<math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="S3.SS7.p2.1.m1.1"><semantics id="S3.SS7.p2.1.m1.1a"><mi id="S3.SS7.p2.1.m1.1.1" xref="S3.SS7.p2.1.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p2.1.m1.1b"><ci id="S3.SS7.p2.1.m1.1.1.cmml" xref="S3.SS7.p2.1.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p2.1.m1.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p2.1.m1.1d">roman_softmax</annotation></semantics></math> activations), and hidden states (i.e., layer outputs).
The statistics are gathered from 0.4M tokens.
As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.T5" title="In 3.7 Activation Outliers Analysis ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">5</span></a>, although the median values are of similar magnitude, <span class="ltx_text ltx_font_smallcaps" id="S3.SS7.p2.1.3">Diff</span> Transformer exhibits much lower top activation values compared to Transformer.
The results show that our method produces fewer activation outliers.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F8">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.F8.1" style="width:174.9pt;height:126.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-112.2pt,81.2pt) scale(0.437922434248271,0.437922434248271) ;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="555" id="S3.F8.1.g1" src="https://arxiv.org/html/2410.05258v1/x14.png" width="761">
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Zero-shot accuracy on the HellaSwag&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib12" title="">12</a>]</cite> dataset. We quantize the attention logits from 16 bits (i.e., unquantized) to 8 bits, 6 bits, and 4 bits.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS7.p3">
<p class="ltx_p" id="S3.SS7.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS7.p3.1.1">Quantization of Attention Logits</span>&nbsp;&nbsp;
As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F8" title="In 3.7 Activation Outliers Analysis ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">8</span></a>, we quantize the attention logits to lower bits.
We apply dynamic post-training quantization using absmax quantization&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib42" title="">42</a>]</cite>.
The 16-bit configuration represents the original results without quantization.
The models are progressively quantized to 8 bits, 6 bits, and 4 bits.
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F8" title="In 3.7 Activation Outliers Analysis ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">8</span></a> reports the zero-shot performance on HellaSwag&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib12" title="">12</a>]</cite>. The other datasets follow a similar trend.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS7.p3.1.2">Diff</span> Transformer retains high performance even at reduced bit-widths, ranging from 16 bits to 6 bits. In comparison, Transformer’s accuracy significantly drops with 6-bit quantization.
The 4-bit <span class="ltx_text ltx_font_smallcaps" id="S3.SS7.p3.1.3">Diff</span> Transformer achieves comparable accuracy as the 6-bit Transformer, and outperforms the 4-bit Transformer by about 25% in accuracy.
The results indicate that <span class="ltx_text ltx_font_smallcaps" id="S3.SS7.p3.1.4">Diff</span> Transformer natively mitigates activation outliers in attention scores, providing new opportunities for low-bit FlashAttention&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib8" title="">8</a>]</cite> implementations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.8 </span>Ablation Studies</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S3.T6">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T6.8">
<tbody><tr class="ltx_tr" id="S3.T6.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T6.2.2.3" rowspan="2" style="padding:0.5pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.2.2.3.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.2.2.4" rowspan="2" style="padding:0.5pt 3.4pt;"><span class="ltx_text" id="S3.T6.2.2.4.1">#heads</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.1.1.1" rowspan="2" style="padding:0.5pt 3.4pt;"><span class="ltx_text" id="S3.T6.1.1.1.1"><math alttext="d" class="ltx_Math" display="inline" id="S3.T6.1.1.1.1.m1.1"><semantics id="S3.T6.1.1.1.1.m1.1a"><mi id="S3.T6.1.1.1.1.m1.1.1" xref="S3.T6.1.1.1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.T6.1.1.1.1.m1.1b"><ci id="S3.T6.1.1.1.1.m1.1.1.cmml" xref="S3.T6.1.1.1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.1.1.1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.T6.1.1.1.1.m1.1d">italic_d</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T6.2.2.5" rowspan="2" style="padding:0.5pt 3.4pt;"><span class="ltx_text" id="S3.T6.2.2.5.1">GN</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.2.2.2" rowspan="2" style="padding:0.5pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.2.2.2.1">Valid. Set<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T6.2.2.2.1.1.m1.1"><semantics id="S3.T6.2.2.2.1.1.m1.1a"><mo id="S3.T6.2.2.2.1.1.m1.1.1" stretchy="false" xref="S3.T6.2.2.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T6.2.2.2.1.1.m1.1b"><ci id="S3.T6.2.2.2.1.1.m1.1.1.cmml" xref="S3.T6.2.2.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.2.2.2.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T6.2.2.2.1.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T6.2.2.6" style="padding:0.5pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.2.2.6.1">Fine-Grained Slices</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.4.4">
<td class="ltx_td ltx_align_center" id="S3.T6.3.3.1" style="padding:0.5pt 3.4pt;">AR-Hit<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T6.3.3.1.m1.1"><semantics id="S3.T6.3.3.1.m1.1a"><mo id="S3.T6.3.3.1.m1.1.1" stretchy="false" xref="S3.T6.3.3.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T6.3.3.1.m1.1b"><ci id="S3.T6.3.3.1.m1.1.1.cmml" xref="S3.T6.3.3.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.3.3.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T6.3.3.1.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T6.4.4.2" style="padding:0.5pt 3.4pt;">Others<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T6.4.4.2.m1.1"><semantics id="S3.T6.4.4.2.m1.1a"><mo id="S3.T6.4.4.2.m1.1.1" stretchy="false" xref="S3.T6.4.4.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T6.4.4.2.m1.1b"><ci id="S3.T6.4.4.2.m1.1.1.cmml" xref="S3.T6.4.4.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.4.4.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T6.4.4.2.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S3.T6.8.9">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T6.8.9.1" style="padding:0.5pt 3.4pt;">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.8.9.2" style="padding:0.5pt 3.4pt;">16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.8.9.3" style="padding:0.5pt 3.4pt;">128</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T6.8.9.4" style="padding:0.5pt 3.4pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.8.9.5" style="padding:0.5pt 3.4pt;">3.087</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.8.9.6" style="padding:0.5pt 3.4pt;">0.898</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.8.9.7" style="padding:0.5pt 3.4pt;">3.272</td>
</tr>
<tr class="ltx_tr" id="S3.T6.8.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T6.8.10.1" style="padding:0.5pt 3.4pt;">Transformer</td>
<td class="ltx_td ltx_align_center" id="S3.T6.8.10.2" style="padding:0.5pt 3.4pt;">8</td>
<td class="ltx_td ltx_align_center" id="S3.T6.8.10.3" style="padding:0.5pt 3.4pt;">256</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.8.10.4" style="padding:0.5pt 3.4pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T6.8.10.5" style="padding:0.5pt 3.4pt;">3.088</td>
<td class="ltx_td ltx_align_center" id="S3.T6.8.10.6" style="padding:0.5pt 3.4pt;">0.899</td>
<td class="ltx_td ltx_align_center" id="S3.T6.8.10.7" style="padding:0.5pt 3.4pt;">3.273</td>
</tr>
<tr class="ltx_tr" id="S3.T6.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T6.5.5.1" style="padding:0.5pt 3.4pt;">
<math alttext="+" class="ltx_Math" display="inline" id="S3.T6.5.5.1.m1.1"><semantics id="S3.T6.5.5.1.m1.1a"><mo id="S3.T6.5.5.1.m1.1.1" xref="S3.T6.5.5.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S3.T6.5.5.1.m1.1b"><plus id="S3.T6.5.5.1.m1.1.1.cmml" xref="S3.T6.5.5.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.5.5.1.m1.1c">+</annotation><annotation encoding="application/x-llamapun" id="S3.T6.5.5.1.m1.1d">+</annotation></semantics></math> GroupNorm</td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.5.2" style="padding:0.5pt 3.4pt;">8</td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.5.3" style="padding:0.5pt 3.4pt;">256</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.5.5.4" style="padding:0.5pt 3.4pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.5.5" style="padding:0.5pt 3.4pt;">3.086</td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.5.6" style="padding:0.5pt 3.4pt;">0.899</td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.5.7" style="padding:0.5pt 3.4pt;">3.271</td>
</tr>
<tr class="ltx_tr" id="S3.T6.8.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T6.8.11.1" style="padding:0.5pt 3.4pt;">
<span class="ltx_text ltx_font_smallcaps" id="S3.T6.8.11.1.1">Diff</span> Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.8.11.2" style="padding:0.5pt 3.4pt;">8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.8.11.3" style="padding:0.5pt 3.4pt;">128</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T6.8.11.4" style="padding:0.5pt 3.4pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.8.11.5" style="padding:0.5pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.8.11.5.1">3.062</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.8.11.6" style="padding:0.5pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.8.11.6.1">0.880</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.8.11.7" style="padding:0.5pt 3.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.8.11.7.1">3.247</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T6.6.6.1" style="padding:0.5pt 3.4pt;">
<math alttext="-" class="ltx_Math" display="inline" id="S3.T6.6.6.1.m1.1"><semantics id="S3.T6.6.6.1.m1.1a"><mo id="S3.T6.6.6.1.m1.1.1" xref="S3.T6.6.6.1.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="S3.T6.6.6.1.m1.1b"><minus id="S3.T6.6.6.1.m1.1.1.cmml" xref="S3.T6.6.6.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.6.6.1.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S3.T6.6.6.1.m1.1d">-</annotation></semantics></math> GroupNorm</td>
<td class="ltx_td ltx_align_center" id="S3.T6.6.6.2" style="padding:0.5pt 3.4pt;">8</td>
<td class="ltx_td ltx_align_center" id="S3.T6.6.6.3" style="padding:0.5pt 3.4pt;">128</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.6.6.4" style="padding:0.5pt 3.4pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T6.6.6.5" style="padding:0.5pt 3.4pt;">3.122</td>
<td class="ltx_td ltx_align_center" id="S3.T6.6.6.6" style="padding:0.5pt 3.4pt;">0.911</td>
<td class="ltx_td ltx_align_center" id="S3.T6.6.6.7" style="padding:0.5pt 3.4pt;">3.309</td>
</tr>
<tr class="ltx_tr" id="S3.T6.7.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T6.7.7.1" style="padding:0.5pt 3.4pt;">with <math alttext="\lambda_{\text{init}}=0.8" class="ltx_Math" display="inline" id="S3.T6.7.7.1.m1.1"><semantics id="S3.T6.7.7.1.m1.1a"><mrow id="S3.T6.7.7.1.m1.1.1" xref="S3.T6.7.7.1.m1.1.1.cmml"><msub id="S3.T6.7.7.1.m1.1.1.2" xref="S3.T6.7.7.1.m1.1.1.2.cmml"><mi id="S3.T6.7.7.1.m1.1.1.2.2" xref="S3.T6.7.7.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S3.T6.7.7.1.m1.1.1.2.3" xref="S3.T6.7.7.1.m1.1.1.2.3a.cmml">init</mtext></msub><mo id="S3.T6.7.7.1.m1.1.1.1" xref="S3.T6.7.7.1.m1.1.1.1.cmml">=</mo><mn id="S3.T6.7.7.1.m1.1.1.3" xref="S3.T6.7.7.1.m1.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T6.7.7.1.m1.1b"><apply id="S3.T6.7.7.1.m1.1.1.cmml" xref="S3.T6.7.7.1.m1.1.1"><eq id="S3.T6.7.7.1.m1.1.1.1.cmml" xref="S3.T6.7.7.1.m1.1.1.1"></eq><apply id="S3.T6.7.7.1.m1.1.1.2.cmml" xref="S3.T6.7.7.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.T6.7.7.1.m1.1.1.2.1.cmml" xref="S3.T6.7.7.1.m1.1.1.2">subscript</csymbol><ci id="S3.T6.7.7.1.m1.1.1.2.2.cmml" xref="S3.T6.7.7.1.m1.1.1.2.2">𝜆</ci><ci id="S3.T6.7.7.1.m1.1.1.2.3a.cmml" xref="S3.T6.7.7.1.m1.1.1.2.3"><mtext id="S3.T6.7.7.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.T6.7.7.1.m1.1.1.2.3">init</mtext></ci></apply><cn id="S3.T6.7.7.1.m1.1.1.3.cmml" type="float" xref="S3.T6.7.7.1.m1.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.7.7.1.m1.1c">\lambda_{\text{init}}=0.8</annotation><annotation encoding="application/x-llamapun" id="S3.T6.7.7.1.m1.1d">italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT = 0.8</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T6.7.7.2" style="padding:0.5pt 3.4pt;">8</td>
<td class="ltx_td ltx_align_center" id="S3.T6.7.7.3" style="padding:0.5pt 3.4pt;">128</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.7.7.4" style="padding:0.5pt 3.4pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T6.7.7.5" style="padding:0.5pt 3.4pt;">3.065</td>
<td class="ltx_td ltx_align_center" id="S3.T6.7.7.6" style="padding:0.5pt 3.4pt;">0.883</td>
<td class="ltx_td ltx_align_center" id="S3.T6.7.7.7" style="padding:0.5pt 3.4pt;">3.250</td>
</tr>
<tr class="ltx_tr" id="S3.T6.8.8">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S3.T6.8.8.1" style="padding:0.5pt 3.4pt;">with <math alttext="\lambda_{\text{init}}=0.5" class="ltx_Math" display="inline" id="S3.T6.8.8.1.m1.1"><semantics id="S3.T6.8.8.1.m1.1a"><mrow id="S3.T6.8.8.1.m1.1.1" xref="S3.T6.8.8.1.m1.1.1.cmml"><msub id="S3.T6.8.8.1.m1.1.1.2" xref="S3.T6.8.8.1.m1.1.1.2.cmml"><mi id="S3.T6.8.8.1.m1.1.1.2.2" xref="S3.T6.8.8.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S3.T6.8.8.1.m1.1.1.2.3" xref="S3.T6.8.8.1.m1.1.1.2.3a.cmml">init</mtext></msub><mo id="S3.T6.8.8.1.m1.1.1.1" xref="S3.T6.8.8.1.m1.1.1.1.cmml">=</mo><mn id="S3.T6.8.8.1.m1.1.1.3" xref="S3.T6.8.8.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T6.8.8.1.m1.1b"><apply id="S3.T6.8.8.1.m1.1.1.cmml" xref="S3.T6.8.8.1.m1.1.1"><eq id="S3.T6.8.8.1.m1.1.1.1.cmml" xref="S3.T6.8.8.1.m1.1.1.1"></eq><apply id="S3.T6.8.8.1.m1.1.1.2.cmml" xref="S3.T6.8.8.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.T6.8.8.1.m1.1.1.2.1.cmml" xref="S3.T6.8.8.1.m1.1.1.2">subscript</csymbol><ci id="S3.T6.8.8.1.m1.1.1.2.2.cmml" xref="S3.T6.8.8.1.m1.1.1.2.2">𝜆</ci><ci id="S3.T6.8.8.1.m1.1.1.2.3a.cmml" xref="S3.T6.8.8.1.m1.1.1.2.3"><mtext id="S3.T6.8.8.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.T6.8.8.1.m1.1.1.2.3">init</mtext></ci></apply><cn id="S3.T6.8.8.1.m1.1.1.3.cmml" type="float" xref="S3.T6.8.8.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.8.8.1.m1.1c">\lambda_{\text{init}}=0.5</annotation><annotation encoding="application/x-llamapun" id="S3.T6.8.8.1.m1.1d">italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT = 0.5</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.8.8.2" style="padding:0.5pt 3.4pt;">8</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.8.8.3" style="padding:0.5pt 3.4pt;">128</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T6.8.8.4" style="padding:0.5pt 3.4pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.8.8.5" style="padding:0.5pt 3.4pt;">3.066</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.8.8.6" style="padding:0.5pt 3.4pt;">0.882</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.8.8.7" style="padding:0.5pt 3.4pt;">3.251</td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Ablation studies of 1.4B-size models.
We report language modeling loss on the validation set.
We also follow <cite class="ltx_cite ltx_citemacro_citet">Arora et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib1" title="">1</a>]</cite> to report fine-grained metrics, where “AR-Hit” evaluates <math alttext="n" class="ltx_Math" display="inline" id="S3.T6.11.m1.1"><semantics id="S3.T6.11.m1.1b"><mi id="S3.T6.11.m1.1.1" xref="S3.T6.11.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.T6.11.m1.1c"><ci id="S3.T6.11.m1.1.1.cmml" xref="S3.T6.11.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.11.m1.1d">n</annotation><annotation encoding="application/x-llamapun" id="S3.T6.11.m1.1e">italic_n</annotation></semantics></math>-grams previously seen in the context.
“#Heads” is number of heads. “<math alttext="d" class="ltx_Math" display="inline" id="S3.T6.12.m2.1"><semantics id="S3.T6.12.m2.1b"><mi id="S3.T6.12.m2.1.1" xref="S3.T6.12.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.T6.12.m2.1c"><ci id="S3.T6.12.m2.1.1.cmml" xref="S3.T6.12.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.12.m2.1d">d</annotation><annotation encoding="application/x-llamapun" id="S3.T6.12.m2.1e">italic_d</annotation></semantics></math>” is head dimension. “GN” indicates whether GroupNorm is used.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS8.p1">
<p class="ltx_p" id="S3.SS8.p1.4">We conduct ablation studies with 1.4B-size language models.
The training setup is the same as the 1.4B model in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS2" title="3.2 Scalability Compared with Transformer ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.2</span></a>.
The models have <math alttext="L=24" class="ltx_Math" display="inline" id="S3.SS8.p1.1.m1.1"><semantics id="S3.SS8.p1.1.m1.1a"><mrow id="S3.SS8.p1.1.m1.1.1" xref="S3.SS8.p1.1.m1.1.1.cmml"><mi id="S3.SS8.p1.1.m1.1.1.2" xref="S3.SS8.p1.1.m1.1.1.2.cmml">L</mi><mo id="S3.SS8.p1.1.m1.1.1.1" xref="S3.SS8.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS8.p1.1.m1.1.1.3" xref="S3.SS8.p1.1.m1.1.1.3.cmml">24</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS8.p1.1.m1.1b"><apply id="S3.SS8.p1.1.m1.1.1.cmml" xref="S3.SS8.p1.1.m1.1.1"><eq id="S3.SS8.p1.1.m1.1.1.1.cmml" xref="S3.SS8.p1.1.m1.1.1.1"></eq><ci id="S3.SS8.p1.1.m1.1.1.2.cmml" xref="S3.SS8.p1.1.m1.1.1.2">𝐿</ci><cn id="S3.SS8.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS8.p1.1.m1.1.1.3">24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p1.1.m1.1c">L=24</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p1.1.m1.1d">italic_L = 24</annotation></semantics></math> layers, <math alttext="h=16" class="ltx_Math" display="inline" id="S3.SS8.p1.2.m2.1"><semantics id="S3.SS8.p1.2.m2.1a"><mrow id="S3.SS8.p1.2.m2.1.1" xref="S3.SS8.p1.2.m2.1.1.cmml"><mi id="S3.SS8.p1.2.m2.1.1.2" xref="S3.SS8.p1.2.m2.1.1.2.cmml">h</mi><mo id="S3.SS8.p1.2.m2.1.1.1" xref="S3.SS8.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS8.p1.2.m2.1.1.3" xref="S3.SS8.p1.2.m2.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS8.p1.2.m2.1b"><apply id="S3.SS8.p1.2.m2.1.1.cmml" xref="S3.SS8.p1.2.m2.1.1"><eq id="S3.SS8.p1.2.m2.1.1.1.cmml" xref="S3.SS8.p1.2.m2.1.1.1"></eq><ci id="S3.SS8.p1.2.m2.1.1.2.cmml" xref="S3.SS8.p1.2.m2.1.1.2">ℎ</ci><cn id="S3.SS8.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS8.p1.2.m2.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p1.2.m2.1c">h=16</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p1.2.m2.1d">italic_h = 16</annotation></semantics></math> heads for Transformer, and <math alttext="h=8" class="ltx_Math" display="inline" id="S3.SS8.p1.3.m3.1"><semantics id="S3.SS8.p1.3.m3.1a"><mrow id="S3.SS8.p1.3.m3.1.1" xref="S3.SS8.p1.3.m3.1.1.cmml"><mi id="S3.SS8.p1.3.m3.1.1.2" xref="S3.SS8.p1.3.m3.1.1.2.cmml">h</mi><mo id="S3.SS8.p1.3.m3.1.1.1" xref="S3.SS8.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS8.p1.3.m3.1.1.3" xref="S3.SS8.p1.3.m3.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS8.p1.3.m3.1b"><apply id="S3.SS8.p1.3.m3.1.1.cmml" xref="S3.SS8.p1.3.m3.1.1"><eq id="S3.SS8.p1.3.m3.1.1.1.cmml" xref="S3.SS8.p1.3.m3.1.1.1"></eq><ci id="S3.SS8.p1.3.m3.1.1.2.cmml" xref="S3.SS8.p1.3.m3.1.1.2">ℎ</ci><cn id="S3.SS8.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS8.p1.3.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p1.3.m3.1c">h=8</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p1.3.m3.1d">italic_h = 8</annotation></semantics></math> heads for <span class="ltx_text ltx_font_smallcaps" id="S3.SS8.p1.4.1">Diff</span> Transformer. The head dimension is <math alttext="d=128" class="ltx_Math" display="inline" id="S3.SS8.p1.4.m4.1"><semantics id="S3.SS8.p1.4.m4.1a"><mrow id="S3.SS8.p1.4.m4.1.1" xref="S3.SS8.p1.4.m4.1.1.cmml"><mi id="S3.SS8.p1.4.m4.1.1.2" xref="S3.SS8.p1.4.m4.1.1.2.cmml">d</mi><mo id="S3.SS8.p1.4.m4.1.1.1" xref="S3.SS8.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS8.p1.4.m4.1.1.3" xref="S3.SS8.p1.4.m4.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS8.p1.4.m4.1b"><apply id="S3.SS8.p1.4.m4.1.1.cmml" xref="S3.SS8.p1.4.m4.1.1"><eq id="S3.SS8.p1.4.m4.1.1.1.cmml" xref="S3.SS8.p1.4.m4.1.1.1"></eq><ci id="S3.SS8.p1.4.m4.1.1.2.cmml" xref="S3.SS8.p1.4.m4.1.1.2">𝑑</ci><cn id="S3.SS8.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS8.p1.4.m4.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p1.4.m4.1c">d=128</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p1.4.m4.1d">italic_d = 128</annotation></semantics></math>.
Detailed hyperparameters are described in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A4" title="Appendix D Hyperparameters for Section 3.2 ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">D</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS8.p2">
<p class="ltx_p" id="S3.SS8.p2.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.T6" title="In 3.8 Ablation Studies ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">6</span></a> reports fine-grained loss on the validation set.
We follow Zoology&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib1" title="">1</a>]</cite> and divide loss into “<span class="ltx_text ltx_font_italic" id="S3.SS8.p2.1.1">Ar-Hit</span>” and “<span class="ltx_text ltx_font_italic" id="S3.SS8.p2.1.2">Others</span>”.
Specifically, “<span class="ltx_text ltx_font_italic" id="S3.SS8.p2.1.3">Ar-Hit</span>” considers the last token of an <math alttext="n" class="ltx_Math" display="inline" id="S3.SS8.p2.1.m1.1"><semantics id="S3.SS8.p2.1.m1.1a"><mi id="S3.SS8.p2.1.m1.1.1" xref="S3.SS8.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS8.p2.1.m1.1b"><ci id="S3.SS8.p2.1.m1.1.1.cmml" xref="S3.SS8.p2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p2.1.m1.1d">italic_n</annotation></semantics></math>-gram previously seen in the context, which evaluates the associative recall capability.
The “<span class="ltx_text ltx_font_italic" id="S3.SS8.p2.1.4">Others</span>” slice represents the tokens that cannot be recalled from the context or frequent tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS8.p3">
<p class="ltx_p" id="S3.SS8.p3.5">As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.T6" title="In 3.8 Ablation Studies ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">6</span></a>, we ablate various design choices of <span class="ltx_text ltx_font_smallcaps" id="S3.SS8.p3.5.1">Diff</span> Transformer and present several Transformer variants.
Notice that all models have comparable size and training FLOPs for fair comparisons.
The first and fourth rows are the default settings for Transformer and <span class="ltx_text ltx_font_smallcaps" id="S3.SS8.p3.5.2">Diff</span> Transformer, respectively, which are directly taken from <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.F3.sf1" title="In Figure 3 ‣ 3.2 Scalability Compared with Transformer ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">3(a)</span></a>.
Our method outperforms Transformer in terms of both overall and fine-grained loss.
As <span class="ltx_text ltx_font_smallcaps" id="S3.SS8.p3.5.3">Diff</span> Transformer halves the number of heads to match model size, the second row shows that the configuration change does not have much impact.
We ablate GroupNorm from <span class="ltx_text ltx_font_smallcaps" id="S3.SS8.p3.5.4">Diff</span> Transformer, which degrades performance due to training instability. Because multiple heads tend to have different statistics in our method, GroupNorm plays a key role in normalizing them to similar values.
In contrast, comparing the third and first rows, adding GroupNorm to Transformer has negligible effect on performance.
The results indicate that the improvements of our method come from the differential attention mechanism, instead of configurations or normalization modules.
Moreover, we compare different strategies to initialize <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS8.p3.1.m1.1"><semantics id="S3.SS8.p3.1.m1.1a"><mi id="S3.SS8.p3.1.m1.1.1" xref="S3.SS8.p3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS8.p3.1.m1.1b"><ci id="S3.SS8.p3.1.m1.1.1.cmml" xref="S3.SS8.p3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p3.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p3.1.m1.1d">italic_λ</annotation></semantics></math>.
As described in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S2.SS1" title="2.1 Differential Attention ‣ 2 Differential Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">2.1</span></a>, the default setting uses exponential initialization, i.e., <math alttext="\lambda_{\text{init}}=0.8-0.6\times\exp(-0.3\cdot(l-1))" class="ltx_Math" display="inline" id="S3.SS8.p3.2.m2.2"><semantics id="S3.SS8.p3.2.m2.2a"><mrow id="S3.SS8.p3.2.m2.2.2" xref="S3.SS8.p3.2.m2.2.2.cmml"><msub id="S3.SS8.p3.2.m2.2.2.3" xref="S3.SS8.p3.2.m2.2.2.3.cmml"><mi id="S3.SS8.p3.2.m2.2.2.3.2" xref="S3.SS8.p3.2.m2.2.2.3.2.cmml">λ</mi><mtext id="S3.SS8.p3.2.m2.2.2.3.3" xref="S3.SS8.p3.2.m2.2.2.3.3a.cmml">init</mtext></msub><mo id="S3.SS8.p3.2.m2.2.2.2" xref="S3.SS8.p3.2.m2.2.2.2.cmml">=</mo><mrow id="S3.SS8.p3.2.m2.2.2.1" xref="S3.SS8.p3.2.m2.2.2.1.cmml"><mn id="S3.SS8.p3.2.m2.2.2.1.3" xref="S3.SS8.p3.2.m2.2.2.1.3.cmml">0.8</mn><mo id="S3.SS8.p3.2.m2.2.2.1.2" xref="S3.SS8.p3.2.m2.2.2.1.2.cmml">−</mo><mrow id="S3.SS8.p3.2.m2.2.2.1.1" xref="S3.SS8.p3.2.m2.2.2.1.1.cmml"><mn id="S3.SS8.p3.2.m2.2.2.1.1.3" xref="S3.SS8.p3.2.m2.2.2.1.1.3.cmml">0.6</mn><mo id="S3.SS8.p3.2.m2.2.2.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS8.p3.2.m2.2.2.1.1.2.cmml">×</mo><mrow id="S3.SS8.p3.2.m2.2.2.1.1.1.1" xref="S3.SS8.p3.2.m2.2.2.1.1.1.2.cmml"><mi id="S3.SS8.p3.2.m2.1.1" xref="S3.SS8.p3.2.m2.1.1.cmml">exp</mi><mo id="S3.SS8.p3.2.m2.2.2.1.1.1.1a" xref="S3.SS8.p3.2.m2.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1" xref="S3.SS8.p3.2.m2.2.2.1.1.1.2.cmml"><mo id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.SS8.p3.2.m2.2.2.1.1.1.2.cmml">(</mo><mrow id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1a" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mn id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.3" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.3.cmml">0.3</mn><mo id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.SS8.p3.2.m2.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS8.p3.2.m2.2b"><apply id="S3.SS8.p3.2.m2.2.2.cmml" xref="S3.SS8.p3.2.m2.2.2"><eq id="S3.SS8.p3.2.m2.2.2.2.cmml" xref="S3.SS8.p3.2.m2.2.2.2"></eq><apply id="S3.SS8.p3.2.m2.2.2.3.cmml" xref="S3.SS8.p3.2.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS8.p3.2.m2.2.2.3.1.cmml" xref="S3.SS8.p3.2.m2.2.2.3">subscript</csymbol><ci id="S3.SS8.p3.2.m2.2.2.3.2.cmml" xref="S3.SS8.p3.2.m2.2.2.3.2">𝜆</ci><ci id="S3.SS8.p3.2.m2.2.2.3.3a.cmml" xref="S3.SS8.p3.2.m2.2.2.3.3"><mtext id="S3.SS8.p3.2.m2.2.2.3.3.cmml" mathsize="70%" xref="S3.SS8.p3.2.m2.2.2.3.3">init</mtext></ci></apply><apply id="S3.SS8.p3.2.m2.2.2.1.cmml" xref="S3.SS8.p3.2.m2.2.2.1"><minus id="S3.SS8.p3.2.m2.2.2.1.2.cmml" xref="S3.SS8.p3.2.m2.2.2.1.2"></minus><cn id="S3.SS8.p3.2.m2.2.2.1.3.cmml" type="float" xref="S3.SS8.p3.2.m2.2.2.1.3">0.8</cn><apply id="S3.SS8.p3.2.m2.2.2.1.1.cmml" xref="S3.SS8.p3.2.m2.2.2.1.1"><times id="S3.SS8.p3.2.m2.2.2.1.1.2.cmml" xref="S3.SS8.p3.2.m2.2.2.1.1.2"></times><cn id="S3.SS8.p3.2.m2.2.2.1.1.3.cmml" type="float" xref="S3.SS8.p3.2.m2.2.2.1.1.3">0.6</cn><apply id="S3.SS8.p3.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1"><exp id="S3.SS8.p3.2.m2.1.1.cmml" xref="S3.SS8.p3.2.m2.1.1"></exp><apply id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1"><minus id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1"></minus><apply id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1"><ci id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.2">⋅</ci><cn id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.3.cmml" type="float" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.3">0.3</cn><apply id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1"><minus id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑙</ci><cn id="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS8.p3.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p3.2.m2.2c">\lambda_{\text{init}}=0.8-0.6\times\exp(-0.3\cdot(l-1))</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p3.2.m2.2d">italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT = 0.8 - 0.6 × roman_exp ( - 0.3 ⋅ ( italic_l - 1 ) )</annotation></semantics></math>, where <math alttext="l" class="ltx_Math" display="inline" id="S3.SS8.p3.3.m3.1"><semantics id="S3.SS8.p3.3.m3.1a"><mi id="S3.SS8.p3.3.m3.1.1" xref="S3.SS8.p3.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS8.p3.3.m3.1b"><ci id="S3.SS8.p3.3.m3.1.1.cmml" xref="S3.SS8.p3.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p3.3.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p3.3.m3.1d">italic_l</annotation></semantics></math> is the layer index.
The last two rows employ constant initialization with <math alttext="\lambda_{\text{init}}=0.8,0.5" class="ltx_Math" display="inline" id="S3.SS8.p3.4.m4.2"><semantics id="S3.SS8.p3.4.m4.2a"><mrow id="S3.SS8.p3.4.m4.2.3" xref="S3.SS8.p3.4.m4.2.3.cmml"><msub id="S3.SS8.p3.4.m4.2.3.2" xref="S3.SS8.p3.4.m4.2.3.2.cmml"><mi id="S3.SS8.p3.4.m4.2.3.2.2" xref="S3.SS8.p3.4.m4.2.3.2.2.cmml">λ</mi><mtext id="S3.SS8.p3.4.m4.2.3.2.3" xref="S3.SS8.p3.4.m4.2.3.2.3a.cmml">init</mtext></msub><mo id="S3.SS8.p3.4.m4.2.3.1" xref="S3.SS8.p3.4.m4.2.3.1.cmml">=</mo><mrow id="S3.SS8.p3.4.m4.2.3.3.2" xref="S3.SS8.p3.4.m4.2.3.3.1.cmml"><mn id="S3.SS8.p3.4.m4.1.1" xref="S3.SS8.p3.4.m4.1.1.cmml">0.8</mn><mo id="S3.SS8.p3.4.m4.2.3.3.2.1" xref="S3.SS8.p3.4.m4.2.3.3.1.cmml">,</mo><mn id="S3.SS8.p3.4.m4.2.2" xref="S3.SS8.p3.4.m4.2.2.cmml">0.5</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS8.p3.4.m4.2b"><apply id="S3.SS8.p3.4.m4.2.3.cmml" xref="S3.SS8.p3.4.m4.2.3"><eq id="S3.SS8.p3.4.m4.2.3.1.cmml" xref="S3.SS8.p3.4.m4.2.3.1"></eq><apply id="S3.SS8.p3.4.m4.2.3.2.cmml" xref="S3.SS8.p3.4.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS8.p3.4.m4.2.3.2.1.cmml" xref="S3.SS8.p3.4.m4.2.3.2">subscript</csymbol><ci id="S3.SS8.p3.4.m4.2.3.2.2.cmml" xref="S3.SS8.p3.4.m4.2.3.2.2">𝜆</ci><ci id="S3.SS8.p3.4.m4.2.3.2.3a.cmml" xref="S3.SS8.p3.4.m4.2.3.2.3"><mtext id="S3.SS8.p3.4.m4.2.3.2.3.cmml" mathsize="70%" xref="S3.SS8.p3.4.m4.2.3.2.3">init</mtext></ci></apply><list id="S3.SS8.p3.4.m4.2.3.3.1.cmml" xref="S3.SS8.p3.4.m4.2.3.3.2"><cn id="S3.SS8.p3.4.m4.1.1.cmml" type="float" xref="S3.SS8.p3.4.m4.1.1">0.8</cn><cn id="S3.SS8.p3.4.m4.2.2.cmml" type="float" xref="S3.SS8.p3.4.m4.2.2">0.5</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p3.4.m4.2c">\lambda_{\text{init}}=0.8,0.5</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p3.4.m4.2d">italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT = 0.8 , 0.5</annotation></semantics></math>.
The minimal change in the validation loss suggests that the models are robust to the choice of <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS8.p3.5.m5.1"><semantics id="S3.SS8.p3.5.m5.1a"><mi id="S3.SS8.p3.5.m5.1.1" xref="S3.SS8.p3.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS8.p3.5.m5.1b"><ci id="S3.SS8.p3.5.m5.1.1.cmml" xref="S3.SS8.p3.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p3.5.m5.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p3.5.m5.1d">italic_λ</annotation></semantics></math> initialization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this work, we introduce Differential Transformer (a.k.a. <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.1">Diff</span> Transformer), which amplifies attention to the relevant context while canceling noise.
Experimental results on language modeling show that <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.2">Diff</span> Transformer outperforms Transformer in terms of scaling properties, long-context modeling, key information retrieval, hallucination mitigation, in-context learning, and reduction of activation outliers.
The results emphasize the importance of reducing attention noise.
Moreover, the differential attention mechanism can be easily implemented with FlashAttention&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib8" title="">8</a>]</cite>.
The findings position <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.3">Diff</span> Transformer as a distinctive and promising foundation architecture for large language models.
In the future, we can develop efficient low-bit attention kernels due to the reduced magnitude of activation outliers.
As the attention pattern becomes much sparser, we would also like to utilize the property to compress key-value caches.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We would like to acknowledge Ben Huntley for maintaining the GPU cluster.
The long-sequence training utilizes <span class="ltx_text ltx_font_typewriter" id="Sx1.p1.1.1">CUBE</span>, which is an internal version of <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib21" title="">21</a>]</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arora et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Simran Arora, Sabri Eyuboglu, Aman Timalsina, Isys Johnson, Michael Poli, James Zou, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Zoology: Measuring and improving recall in efficient language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2312.04927</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yushi Bai, Xin Lv, Jiajie Zhang, Hongchang Lyu, Jiankai Tang, Zhidian Huang, Zhengxiao Du, Xiao Liu, Aohan Zeng, Lei Hou, et&nbsp;al.

</span>
<span class="ltx_bibblock">Longbench: A bilingual, multitask benchmark for long context understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2308.14508</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bertsch et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Amanda Bertsch, Maor Ivgi, Uri Alon, Jonathan Berant, Matthew&nbsp;R. Gormley, and Graham Neubig.

</span>
<span class="ltx_bibblock">In-context learning with long-context models: An in-depth exploration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv:2405.00200</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bondarenko et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yelysei Bondarenko, Markus Nagel, and Tijmen Blankevoort.

</span>
<span class="ltx_bibblock">Quantizable transformers: Removing outliers by helping attention heads do nothing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Casanueva et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Iñigo Casanueva, Tadas Temčinas, Daniela Gerz, Matthew Henderson, and Ivan Vulić.

</span>
<span class="ltx_bibblock">Efficient intent detection with dual sentence encoders.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 2nd Workshop on Natural Language Processing for Conversational AI</em>, pp.&nbsp; 38–45, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chuang et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yung-Sung Chuang, Linlu Qiu, Cheng-Yu Hsieh, Ranjay Krishna, Yoon Kim, and James Glass.

</span>
<span class="ltx_bibblock">Lookback lens: Detecting and mitigating contextual hallucinations in large language models using only attention maps.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2407.07071</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tri Dao.

</span>
<span class="ltx_bibblock">FlashAttention-2: Faster attention with better parallelism and work partitioning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2307.08691</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tri Dao, Dan Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Flashattention: Fast and memory-efficient exact attention with io-awareness.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Advances in Neural Information Processing Systems</em>, 35:16344–16359, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dasigi et&nbsp;al. [2021]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pradeep Dasigi, Kyle Lo, Iz&nbsp;Beltagy, Arman Cohan, Noah&nbsp;A Smith, and Matt Gardner.

</span>
<span class="ltx_bibblock">A dataset of information-seeking questions and answers anchored in research papers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em>, pp.&nbsp; 4599–4610, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fabbri et&nbsp;al. [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexander&nbsp;Richard Fabbri, Irene Li, Tianwei She, Suyi Li, and Dragomir Radev.

</span>
<span class="ltx_bibblock">Multi-news: A large-scale multi-document summarization dataset and abstractive hierarchical model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics</em>, pp.&nbsp; 1074–1084, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yao Fu, Rameswar Panda, Xinyao Niu, Xiang Yue, Hanna Hajishirzi, Yoon Kim, and Hao Peng.

</span>
<span class="ltx_bibblock">Data engineering for scaling language models to 128k context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">ArXiv</em>, abs/2402.10171, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Leo Gao, Jonathan Tow, Baber Abbasi, Stella Biderman, Sid Black, Anthony DiPofi, Charles Foster, Laurence Golding, Jeffrey Hsu, Alain Le&nbsp;Noac’h, Haonan Li, Kyle McDonell, Niklas Muennighoff, Chris Ociepa, Jason Phang, Laria Reynolds, Hailey Schoelkopf, Aviya Skowron, Lintang Sutawika, Eric Tang, Anish Thite, Ben Wang, Kevin Wang, and Andy Zou.

</span>
<span class="ltx_bibblock">A framework for few-shot language model evaluation, 12 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng &amp; Liu [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xinyang Geng and Hao Liu.

</span>
<span class="ltx_bibblock">OpenLLaMA: An open reproduction of LLaMA.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/openlm-research/open_llama" title="">https://github.com/openlm-research/open_llama</a>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xanh Ho, Anh-Khoa&nbsp;Duong Nguyen, Saku Sugawara, and Akiko Aizawa.

</span>
<span class="ltx_bibblock">Constructing a multi-hop qa dataset for comprehensive evaluation of reasoning steps.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 28th International Conference on Computational Linguistics</em>, pp.&nbsp; 6609–6625, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hovy et&nbsp;al. [2001]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Eduard Hovy, Laurie Gerber, Ulf Hermjakob, Chin-Yew Lin, and Deepak Ravichandran.

</span>
<span class="ltx_bibblock">Toward semantics-based answer pinpointing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the first international conference on Human language technology research</em>, 2001.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qidong Huang, Xiaoyi Dong, Pan Zhang, Bin Wang, Conghui He, Jiaqi Wang, Dahua Lin, Weiming Zhang, and Nenghai Yu.

</span>
<span class="ltx_bibblock">Opera: Alleviating hallucination in multi-modal large language models via over-trust penalty and retrospection-allocation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 13418–13427, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kamradt [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Greg Kamradt.

</span>
<span class="ltx_bibblock">Needle in a Haystack - pressure testing LLMs.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/gkamradt/LLMTest_NeedleInAHaystack/tree/main" title="">https://github.com/gkamradt/LLMTest_NeedleInAHaystack/tree/main</a>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaplan et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jared Kaplan, Sam McCandlish, Tom Henighan, Tom&nbsp;B. Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei.

</span>
<span class="ltx_bibblock">Scaling laws for neural language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">CoRR</em>, abs/2001.08361, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Laplante et&nbsp;al. [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Philip&nbsp;A Laplante, Robin Cravey, Lawrence&nbsp;P Dunleavy, James&nbsp;L Antonakos, Rodney LeRoy, Jack East, Nicholas&nbsp;E Buris, Christopher&nbsp;J Conant, Lawrence Fryda, Robert&nbsp;William Boyd, et&nbsp;al.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Comprehensive dictionary of electrical engineering</em>.

</span>
<span class="ltx_bibblock">CRC Press, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Larson et&nbsp;al. [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stefan Larson, Anish Mahendran, Joseph&nbsp;J Peper, Christopher Clarke, Andrew Lee, Parker Hill, Jonathan&nbsp;K Kummerfeld, Kevin Leach, Michael&nbsp;A Laurenzano, Lingjia Tang, et&nbsp;al.

</span>
<span class="ltx_bibblock">An evaluation dataset for intent classification and out-of-scope prediction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pp.&nbsp; 1311–1316, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhiqi Lin, Youshan Miao, Guodong Liu, Xiaoxiang Shi, Quanlu Zhang, Fan Yang, Saeed Maleki, Yi&nbsp;Zhu, Xu&nbsp;Cao, Cheng Li, Mao Yang, Lintao Zhang, and Lidong Zhou.

</span>
<span class="ltx_bibblock">SuperScaler: Supporting flexible DNN parallelization via a unified abstraction, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. [2024a]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hao Liu, Wilson Yan, Matei Zaharia, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">World model on million-length video and language with ringattention.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2402.08268</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. [2024b]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nelson&nbsp;F Liu, Kevin Lin, John Hewitt, Ashwin Paranjape, Michele Bevilacqua, Fabio Petroni, and Percy Liang.

</span>
<span class="ltx_bibblock">Lost in the middle: How language models use long contexts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Transactions of the Association for Computational Linguistics</em>, 12:157–173, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov &amp; Hutter [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yao Lu, Max Bartolo, Alastair Moore, Sebastian Riedel, and Pontus Stenetorp.

</span>
<span class="ltx_bibblock">Fantastically ordered prompts and where to find them: Overcoming few-shot prompt order sensitivity.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics</em>, pp.&nbsp; 8086–8098, Dublin, Ireland, May 2022. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narayan et&nbsp;al. [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shashi Narayan, Shay&nbsp;B Cohen, and Mirella Lapata.

</span>
<span class="ltx_bibblock">Don’t give me the details, just the summary! topic-aware convolutional neural networks for extreme summarization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing</em>. Association for Computational Linguistics, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Hello, gpt-4o.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/index/hello-gpt-4o" title="">https://openai.com/index/hello-gpt-4o</a>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhen Qin, Xiaodong Han, Weixuan Sun, Dongxu Li, Lingpeng Kong, Nick Barnes, and Yiran Zhong.

</span>
<span class="ltx_bibblock">The devil in linear transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 7025–7041, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramachandran et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Prajit Ramachandran, Barret Zoph, and Quoc&nbsp;V. Le.

</span>
<span class="ltx_bibblock">Swish: a self-gated activation function.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv: Neural and Evolutionary Computing</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ratner et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nir Ratner, Yoav Levine, Yonatan Belinkov, Ori Ram, Inbal Magar, Omri Abend, Ehud Karpas, Amnon Shashua, Kevin Leyton-Brown, and Yoav Shoham.

</span>
<span class="ltx_bibblock">Parallel context windows for large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics</em>, pp.&nbsp; 6383–6402, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ravi et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Selvan&nbsp;Sunitha Ravi, Bartosz Mielczarek, Anand Kannappan, Douwe Kiela, and Rebecca Qian.

</span>
<span class="ltx_bibblock">Lynx: An open source hallucination evaluation model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2407.08488</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Machel Reid, Nikolay Savinov, Denis Teplyashin, Dmitry Lepikhin, Timothy Lillicrap, Jean-baptiste Alayrac, Radu Soricut, Angeliki Lazaridou, Orhan Firat, Julian Schrittwieser, et&nbsp;al.

</span>
<span class="ltx_bibblock">Gemini 1.5: Unlocking multimodal understanding across millions of tokens of context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2403.05530</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">See et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Abigail See, Peter&nbsp;J Liu, and Christopher&nbsp;D Manning.

</span>
<span class="ltx_bibblock">Get to the point: Summarization with pointer-generator networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics</em>. Association for Computational Linguistics, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shah et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jay Shah, Ganesh Bikshandi, Ying Zhang, Vijay Thakkar, Pradeep Ramani, and Tri Dao.

</span>
<span class="ltx_bibblock">Flashattention-3: Fast and accurate attention with asynchrony and low-precision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2407.08608</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Noam Shazeer.

</span>
<span class="ltx_bibblock">Glu variants improve transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2002.05202</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et&nbsp;al. [2021]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jianlin Su, Yu&nbsp;Lu, Shengfeng Pan, Bo&nbsp;Wen, and Yunfeng Liu.

</span>
<span class="ltx_bibblock">Roformer: Enhanced transformer with rotary position embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2104.09864</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mingjie Sun, Xinlei Chen, J&nbsp;Zico Kolter, and Zhuang Liu.

</span>
<span class="ltx_bibblock">Massive activations in large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">ICLR 2024 Workshop on Mathematical and Empirical Understanding of Foundation Models</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2302.13971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tow [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jonathan Tow.

</span>
<span class="ltx_bibblock">StableLM Alpha v2 models.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/stabilityai/stablelm-base-alpha-3b-v2" title="">https://huggingface.co/stabilityai/stablelm-base-alpha-3b-v2</a>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tow et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jonathan Tow, Marco Bellagente, Dakota Mahan, and Carlos Riquelme.

</span>
<span class="ltx_bibblock">StableLM 3B 4E1T.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aka.ms/StableLM-3B-4E1T" title="">https://aka.ms/StableLM-3B-4E1T</a>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan&nbsp;N. Gomez, Lukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Advances in Neural Information Processing Systems 30: Annual Conference on Neural Information Processing Systems 2017, 4-9 December 2017, Long Beach, CA, USA</em>, pp.&nbsp; 6000–6010, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wan et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhongwei Wan, Xin Wang, Che Liu, Samiul Alam, Yu&nbsp;Zheng, Jiachen Liu, Zhongnan Qu, Shen Yan, Yi&nbsp;Zhu, Quanlu Zhang, Mosharaf Chowdhury, and Mi&nbsp;Zhang.

</span>
<span class="ltx_bibblock">Efficient large language models: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Transactions on Machine Learning Research</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hongyu Wang, Shuming Ma, Shaohan Huang, Li&nbsp;Dong, Wenhui Wang, Zhiliang Peng, Yu&nbsp;Wu, Payal Bajaj, Saksham Singhal, Alon Benhaim, et&nbsp;al.

</span>
<span class="ltx_bibblock">Magneto: A foundation Transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 36077–36092. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu &amp; He [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yuxin Wu and Kaiming He.

</span>
<span class="ltx_bibblock">Group normalization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Proceedings of the European conference on computer vision (ECCV)</em>, pp.&nbsp; 3–19, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhilin Yang, Peng Qi, Saizheng Zhang, Yoshua Bengio, William Cohen, Ruslan Salakhutdinov, and Christopher&nbsp;D Manning.

</span>
<span class="ltx_bibblock">Hotpotqa: A dataset for diverse, explainable multi-hop question answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 2369–2380, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang &amp; Sennrich [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Biao Zhang and Rico Sennrich.

</span>
<span class="ltx_bibblock">Root mean square layer normalization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Advances in Neural Information Processing Systems</em>, 32, 2019.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Implementation of Differential Attention</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.2">We present the pseudocode for <math alttext="\operatorname{DiffAttn{}(\cdot)}" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mrow id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mi id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">DiffAttn</mi><mo id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.p1.1.m1.1.1.4.2" xref="A1.p1.1.m1.1.1.cmml"><mo id="A1.p1.1.m1.1.1.4.2.1" stretchy="false" xref="A1.p1.1.m1.1.1.cmml">(</mo><mo id="A1.p1.1.m1.1.1.1" lspace="0em" rspace="0em" xref="A1.p1.1.m1.1.1.1.cmml">⋅</mo><mo id="A1.p1.1.m1.1.1.4.2.2" stretchy="false" xref="A1.p1.1.m1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><times id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2"></times><ci id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">DiffAttn</ci><ci id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\operatorname{DiffAttn{}(\cdot)}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">roman_DiffAttn ( ⋅ )</annotation></semantics></math> and conventional <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="A1.p1.2.m2.1"><semantics id="A1.p1.2.m2.1a"><mi id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><ci id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.2.m2.1d">roman_softmax</annotation></semantics></math> attention.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A1.fig1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_minipage ltx_align_top ltx_listing" id="A1.fig1.1" style="width:212.5pt;background-color:#FFFFFF;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZGVmIEF0dGVudGlvbihYLCBXX3EsIFdfaywgV192KToKICAgIFEgPSBYIEAgV19xCiAgICBLID0gWCBAIFdfawogICAgViA9IFggQCBXX3YKICAgICMgUSwgSywgVjogW2IsIG4sIGRdCiAgICBzID0gMSAvIHNxcnQoZCkKICAgIEEgPSBRIEAgSy50cmFuc3Bvc2UoLTEsIC0yKSAqIHMKCiAgICByZXR1cm4KICAgICAgc29mdG1heChBKSBAIFY=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx16">
<span class="ltx_text ltx_lst_keyword" id="lstnumberx16.1" style="color:#0000FF;">def</span><span class="ltx_text ltx_lst_space" id="lstnumberx16.2"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx16.3">Attention</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx16.4">X</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx16.5"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx16.6">W_q</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx16.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx16.8">W_k</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx16.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx16.10">W_v</span>):
</div>
<div class="ltx_listingline" id="lstnumberx17">
<span class="ltx_text ltx_lst_space" id="lstnumberx17.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx17.2">Q</span><span class="ltx_text ltx_lst_space" id="lstnumberx17.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx17.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx17.5">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx17.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx17.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx17.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx17.9">W_q</span>
</div>
<div class="ltx_listingline" id="lstnumberx18">
<span class="ltx_text ltx_lst_space" id="lstnumberx18.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx18.2">K</span><span class="ltx_text ltx_lst_space" id="lstnumberx18.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx18.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx18.5">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx18.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx18.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx18.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx18.9">W_k</span>
</div>
<div class="ltx_listingline" id="lstnumberx19">
<span class="ltx_text ltx_lst_space" id="lstnumberx19.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx19.2">V</span><span class="ltx_text ltx_lst_space" id="lstnumberx19.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx19.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx19.5">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx19.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx19.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx19.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx19.9">W_v</span>
</div>
<div class="ltx_listingline" id="lstnumberx20">
<span class="ltx_text ltx_lst_space" id="lstnumberx20.1"> </span><span class="ltx_text ltx_lst_comment" id="lstnumberx20.2" style="color:#808080;">#<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.1"> </span>Q,<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.2"> </span>K,<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.3"> </span>V:<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.4"> </span>[b,<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.5"> </span>n,<span class="ltx_text ltx_lst_space" id="lstnumberx20.2.6"> </span>d]</span>
</div>
<div class="ltx_listingline" id="lstnumberx21">
<span class="ltx_text ltx_lst_space" id="lstnumberx21.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx21.2">s</span><span class="ltx_text ltx_lst_space" id="lstnumberx21.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx21.4"> </span>1<span class="ltx_text ltx_lst_space" id="lstnumberx21.5"> </span>/<span class="ltx_text ltx_lst_space" id="lstnumberx21.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx21.7">sqrt</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx21.8">d</span>)
</div>
<div class="ltx_listingline" id="lstnumberx22">
<span class="ltx_text ltx_lst_space" id="lstnumberx22.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx22.2">A</span><span class="ltx_text ltx_lst_space" id="lstnumberx22.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx22.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx22.5">Q</span><span class="ltx_text ltx_lst_space" id="lstnumberx22.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx22.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx22.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx22.9">K</span>.<span class="ltx_text ltx_lst_identifier" id="lstnumberx22.10">transpose</span>(-1,<span class="ltx_text ltx_lst_space" id="lstnumberx22.11"> </span>-2)<span class="ltx_text ltx_lst_space" id="lstnumberx22.12"> </span>*<span class="ltx_text ltx_lst_space" id="lstnumberx22.13"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx22.14">s</span>
</div>
<div class="ltx_listingline" id="lstnumberx23">
</div>
<div class="ltx_listingline" id="lstnumberx24">
<span class="ltx_text ltx_lst_space" id="lstnumberx24.1"> </span><span class="ltx_text ltx_lst_keyword" id="lstnumberx24.2" style="color:#0000FF;">return</span>
</div>
<div class="ltx_listingline" id="lstnumberx25">
<span class="ltx_text ltx_lst_space" id="lstnumberx25.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx25.2">softmax</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx25.3">A</span>)<span class="ltx_text ltx_lst_space" id="lstnumberx25.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx25.5">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx25.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx25.7">V</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top ltx_listing" id="A1.fig1.2" style="width:212.5pt;background-color:#FFFFFF;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZGVmICRcdGV4dGNvbG9ye3JlZH17XHRleHR7RGlmZkF0dG59fSQoWCwgV19xLCBXX2ssIFdfdiwgJFxsYW1iZGEkKToKICAgIFExLCBRMiA9IHNwbGl0KFggQCBXX3EpCiAgICBLMSwgSzIgPSBzcGxpdChYIEAgV19rKQogICAgViA9IFggQCBXX3YKICAgICMgUWksIEtpOiBbYiwgbiwgZF07IFY6IFtiLCBuLCAyZF0KICAgIHMgPSAxIC8gc3FydChkKQogICAgQTEgPSBRMSBAIEsxLnRyYW5zcG9zZSgtMSwgLTIpICogcwogICAgQTIgPSBRMiBAIEsyLnRyYW5zcG9zZSgtMSwgLTIpICogcwogICAgcmV0dXJuCiAgICAgIChzb2Z0bWF4KEExKSAtICRcbGFtYmRhJCBzb2Z0bWF4KEEyKSkgQCBW">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx26">
<span class="ltx_text ltx_lst_keyword" id="lstnumberx26.3" style="color:#0000FF;">def</span><span class="ltx_text ltx_lst_space" id="lstnumberx26.4"> </span><span class="ltx_text ltx_markedasmath" id="lstnumberx26.1" style="color:#FF0000;">DiffAttn</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx26.5">X</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx26.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx26.7">W_q</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx26.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx26.9">W_k</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx26.10"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx26.11">W_v</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx26.12"> </span><span class="ltx_text" id="lstnumberx26.2"><math alttext="\lambda" class="ltx_Math" display="inline" id="lstnumberx26.2.m1.1"><semantics id="lstnumberx26.2.m1.1a"><mi id="lstnumberx26.2.m1.1.1" mathbackground="#FFFFFF" xref="lstnumberx26.2.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="lstnumberx26.2.m1.1b"><ci id="lstnumberx26.2.m1.1.1.cmml" xref="lstnumberx26.2.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx26.2.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="lstnumberx26.2.m1.1d">italic_λ</annotation></semantics></math></span>):
</div>
<div class="ltx_listingline" id="lstnumberx27">
<span class="ltx_text ltx_lst_space" id="lstnumberx27.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx27.2">Q1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx27.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx27.4">Q2</span><span class="ltx_text ltx_lst_space" id="lstnumberx27.5"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx27.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx27.7">split</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx27.8">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx27.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx27.10">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx27.11"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx27.12">W_q</span>)
</div>
<div class="ltx_listingline" id="lstnumberx28">
<span class="ltx_text ltx_lst_space" id="lstnumberx28.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx28.2">K1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx28.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx28.4">K2</span><span class="ltx_text ltx_lst_space" id="lstnumberx28.5"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx28.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx28.7">split</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx28.8">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx28.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx28.10">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx28.11"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx28.12">W_k</span>)
</div>
<div class="ltx_listingline" id="lstnumberx29">
<span class="ltx_text ltx_lst_space" id="lstnumberx29.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx29.2">V</span><span class="ltx_text ltx_lst_space" id="lstnumberx29.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx29.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx29.5">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx29.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx29.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx29.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx29.9">W_v</span>
</div>
<div class="ltx_listingline" id="lstnumberx30">
<span class="ltx_text ltx_lst_space" id="lstnumberx30.1"> </span><span class="ltx_text ltx_lst_comment" id="lstnumberx30.2" style="color:#808080;">#<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.1"> </span>Qi,<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.2"> </span>Ki:<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.3"> </span>[b,<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.4"> </span>n,<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.5"> </span>d];<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.6"> </span>V:<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.7"> </span>[b,<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.8"> </span>n,<span class="ltx_text ltx_lst_space" id="lstnumberx30.2.9"> </span>2d]</span>
</div>
<div class="ltx_listingline" id="lstnumberx31">
<span class="ltx_text ltx_lst_space" id="lstnumberx31.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx31.2">s</span><span class="ltx_text ltx_lst_space" id="lstnumberx31.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx31.4"> </span>1<span class="ltx_text ltx_lst_space" id="lstnumberx31.5"> </span>/<span class="ltx_text ltx_lst_space" id="lstnumberx31.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx31.7">sqrt</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx31.8">d</span>)
</div>
<div class="ltx_listingline" id="lstnumberx32">
<span class="ltx_text ltx_lst_space" id="lstnumberx32.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx32.2">A1</span><span class="ltx_text ltx_lst_space" id="lstnumberx32.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx32.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx32.5">Q1</span><span class="ltx_text ltx_lst_space" id="lstnumberx32.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx32.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx32.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx32.9">K1</span>.<span class="ltx_text ltx_lst_identifier" id="lstnumberx32.10">transpose</span>(-1,<span class="ltx_text ltx_lst_space" id="lstnumberx32.11"> </span>-2)<span class="ltx_text ltx_lst_space" id="lstnumberx32.12"> </span>*<span class="ltx_text ltx_lst_space" id="lstnumberx32.13"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx32.14">s</span>
</div>
<div class="ltx_listingline" id="lstnumberx33">
<span class="ltx_text ltx_lst_space" id="lstnumberx33.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx33.2">A2</span><span class="ltx_text ltx_lst_space" id="lstnumberx33.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx33.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx33.5">Q2</span><span class="ltx_text ltx_lst_space" id="lstnumberx33.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx33.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx33.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx33.9">K2</span>.<span class="ltx_text ltx_lst_identifier" id="lstnumberx33.10">transpose</span>(-1,<span class="ltx_text ltx_lst_space" id="lstnumberx33.11"> </span>-2)<span class="ltx_text ltx_lst_space" id="lstnumberx33.12"> </span>*<span class="ltx_text ltx_lst_space" id="lstnumberx33.13"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx33.14">s</span>
</div>
<div class="ltx_listingline" id="lstnumberx34">
<span class="ltx_text ltx_lst_space" id="lstnumberx34.1"> </span><span class="ltx_text ltx_lst_keyword" id="lstnumberx34.2" style="color:#0000FF;">return</span>
</div>
<div class="ltx_listingline" id="lstnumberx35">
<span class="ltx_text ltx_lst_space" id="lstnumberx35.2"> </span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx35.3">softmax</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx35.4">A1</span>)<span class="ltx_text ltx_lst_space" id="lstnumberx35.5"> </span>-<span class="ltx_text ltx_lst_space" id="lstnumberx35.6"> </span><span class="ltx_text" id="lstnumberx35.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="lstnumberx35.1.m1.1"><semantics id="lstnumberx35.1.m1.1a"><mi id="lstnumberx35.1.m1.1.1" mathbackground="#FFFFFF" xref="lstnumberx35.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="lstnumberx35.1.m1.1b"><ci id="lstnumberx35.1.m1.1.1.cmml" xref="lstnumberx35.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx35.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="lstnumberx35.1.m1.1d">italic_λ</annotation></semantics></math></span><span class="ltx_text ltx_lst_space" id="lstnumberx35.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx35.8">softmax</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx35.9">A2</span>))<span class="ltx_text ltx_lst_space" id="lstnumberx35.10"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx35.11">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx35.12"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx35.13">V</span>
</div>
</div>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.p2">
<p class="ltx_p" id="A1.p2.6"><span class="ltx_text ltx_font_bold" id="A1.p2.6.1">Implementation with FlashAttention</span>&nbsp;&nbsp;
Additionally, we provide implementations with FlashAttention&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib8" title="">8</a>]</cite>.
We categorize the implementations into two types by whether it supports using different dimensions between <math alttext="Q,K" class="ltx_Math" display="inline" id="A1.p2.1.m1.2"><semantics id="A1.p2.1.m1.2a"><mrow id="A1.p2.1.m1.2.3.2" xref="A1.p2.1.m1.2.3.1.cmml"><mi id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">Q</mi><mo id="A1.p2.1.m1.2.3.2.1" xref="A1.p2.1.m1.2.3.1.cmml">,</mo><mi id="A1.p2.1.m1.2.2" xref="A1.p2.1.m1.2.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.2b"><list id="A1.p2.1.m1.2.3.1.cmml" xref="A1.p2.1.m1.2.3.2"><ci id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">𝑄</ci><ci id="A1.p2.1.m1.2.2.cmml" xref="A1.p2.1.m1.2.2">𝐾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.2c">Q,K</annotation><annotation encoding="application/x-llamapun" id="A1.p2.1.m1.2d">italic_Q , italic_K</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="A1.p2.2.m2.1"><semantics id="A1.p2.2.m2.1a"><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="A1.p2.2.m2.1d">italic_V</annotation></semantics></math>.
Specifically, let <math alttext="\operatorname{FlashDiffAttn\_1(\cdot)}" class="ltx_Math" display="inline" id="A1.p2.3.m3.1"><semantics id="A1.p2.3.m3.1a"><mrow id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml"><mi id="A1.p2.3.m3.1.1.3" xref="A1.p2.3.m3.1.1.3.cmml">FlashDiffAttn</mi><mo id="A1.p2.3.m3.1.1.2" xref="A1.p2.3.m3.1.1.2.cmml">⁢</mo><mi id="A1.p2.3.m3.1.1.4" mathvariant="normal" xref="A1.p2.3.m3.1.1.4.cmml">_</mi><mo id="A1.p2.3.m3.1.1.2a" xref="A1.p2.3.m3.1.1.2.cmml">⁢</mo><mn id="A1.p2.3.m3.1.1.5" xref="A1.p2.3.m3.1.1.5.cmml">1</mn><mo id="A1.p2.3.m3.1.1.2b" xref="A1.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="A1.p2.3.m3.1.1.6.2" xref="A1.p2.3.m3.1.1.cmml"><mo id="A1.p2.3.m3.1.1.6.2.1" stretchy="false" xref="A1.p2.3.m3.1.1.cmml">(</mo><mo id="A1.p2.3.m3.1.1.1" lspace="0em" rspace="0em" xref="A1.p2.3.m3.1.1.1.cmml">⋅</mo><mo id="A1.p2.3.m3.1.1.6.2.2" stretchy="false" xref="A1.p2.3.m3.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1"><times id="A1.p2.3.m3.1.1.2.cmml" xref="A1.p2.3.m3.1.1.2"></times><ci id="A1.p2.3.m3.1.1.3.cmml" xref="A1.p2.3.m3.1.1.3">FlashDiffAttn</ci><ci id="A1.p2.3.m3.1.1.4.cmml" xref="A1.p2.3.m3.1.1.4">_</ci><cn id="A1.p2.3.m3.1.1.5.cmml" type="integer" xref="A1.p2.3.m3.1.1.5">1</cn><ci id="A1.p2.3.m3.1.1.1.cmml" xref="A1.p2.3.m3.1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">\operatorname{FlashDiffAttn\_1(\cdot)}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.3.m3.1d">roman_FlashDiffAttn _ 1 ( ⋅ )</annotation></semantics></math> denote the package that supports different dimensions (e.g., <span class="ltx_text ltx_font_typewriter" id="A1.p2.6.2">xformers<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote1.1.1.1">1</span></span><a class="ltx_ref ltx_url" href="https://github.com/facebookresearch/xformers" title="">https://github.com/facebookresearch/xformers</a></span></span></span></span>), and <math alttext="\operatorname{FlashDiffAttn\_2(\cdot)}" class="ltx_Math" display="inline" id="A1.p2.4.m4.1"><semantics id="A1.p2.4.m4.1a"><mrow id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml"><mi id="A1.p2.4.m4.1.1.3" xref="A1.p2.4.m4.1.1.3.cmml">FlashDiffAttn</mi><mo id="A1.p2.4.m4.1.1.2" xref="A1.p2.4.m4.1.1.2.cmml">⁢</mo><mi id="A1.p2.4.m4.1.1.4" mathvariant="normal" xref="A1.p2.4.m4.1.1.4.cmml">_</mi><mo id="A1.p2.4.m4.1.1.2a" xref="A1.p2.4.m4.1.1.2.cmml">⁢</mo><mn id="A1.p2.4.m4.1.1.5" xref="A1.p2.4.m4.1.1.5.cmml">2</mn><mo id="A1.p2.4.m4.1.1.2b" xref="A1.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="A1.p2.4.m4.1.1.6.2" xref="A1.p2.4.m4.1.1.cmml"><mo id="A1.p2.4.m4.1.1.6.2.1" stretchy="false" xref="A1.p2.4.m4.1.1.cmml">(</mo><mo id="A1.p2.4.m4.1.1.1" lspace="0em" rspace="0em" xref="A1.p2.4.m4.1.1.1.cmml">⋅</mo><mo id="A1.p2.4.m4.1.1.6.2.2" stretchy="false" xref="A1.p2.4.m4.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><apply id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1"><times id="A1.p2.4.m4.1.1.2.cmml" xref="A1.p2.4.m4.1.1.2"></times><ci id="A1.p2.4.m4.1.1.3.cmml" xref="A1.p2.4.m4.1.1.3">FlashDiffAttn</ci><ci id="A1.p2.4.m4.1.1.4.cmml" xref="A1.p2.4.m4.1.1.4">_</ci><cn id="A1.p2.4.m4.1.1.5.cmml" type="integer" xref="A1.p2.4.m4.1.1.5">2</cn><ci id="A1.p2.4.m4.1.1.1.cmml" xref="A1.p2.4.m4.1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">\operatorname{FlashDiffAttn\_2(\cdot)}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.4.m4.1d">roman_FlashDiffAttn _ 2 ( ⋅ )</annotation></semantics></math> the package that does not (e.g., <span class="ltx_text ltx_font_typewriter" id="A1.p2.6.3">flash-attention<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote2.1.1.1">2</span></span><a class="ltx_ref ltx_url" href="https://github.com/Dao-AILab/flash-attention" title="">https://github.com/Dao-AILab/flash-attention</a></span></span></span></span>).
We also implement a <span class="ltx_text ltx_font_typewriter" id="A1.p2.6.4">customized-flash-attention<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote3.1.1.1">3</span></span><a class="ltx_ref ltx_url" href="https://aka.ms/flash-diff" title="">https://aka.ms/flash-diff</a></span></span></span></span> package, which is modified based on the official FlashAttention2&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib7" title="">7</a>]</cite>, in order to support different dimensions between <math alttext="Q,K" class="ltx_Math" display="inline" id="A1.p2.5.m5.2"><semantics id="A1.p2.5.m5.2a"><mrow id="A1.p2.5.m5.2.3.2" xref="A1.p2.5.m5.2.3.1.cmml"><mi id="A1.p2.5.m5.1.1" xref="A1.p2.5.m5.1.1.cmml">Q</mi><mo id="A1.p2.5.m5.2.3.2.1" xref="A1.p2.5.m5.2.3.1.cmml">,</mo><mi id="A1.p2.5.m5.2.2" xref="A1.p2.5.m5.2.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.5.m5.2b"><list id="A1.p2.5.m5.2.3.1.cmml" xref="A1.p2.5.m5.2.3.2"><ci id="A1.p2.5.m5.1.1.cmml" xref="A1.p2.5.m5.1.1">𝑄</ci><ci id="A1.p2.5.m5.2.2.cmml" xref="A1.p2.5.m5.2.2">𝐾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.5.m5.2c">Q,K</annotation><annotation encoding="application/x-llamapun" id="A1.p2.5.m5.2d">italic_Q , italic_K</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="A1.p2.6.m6.1"><semantics id="A1.p2.6.m6.1a"><mi id="A1.p2.6.m6.1.1" xref="A1.p2.6.m6.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="A1.p2.6.m6.1b"><ci id="A1.p2.6.m6.1.1.cmml" xref="A1.p2.6.m6.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.6.m6.1c">V</annotation><annotation encoding="application/x-llamapun" id="A1.p2.6.m6.1d">italic_V</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.p3">
<p class="ltx_p" id="A1.p3.1">The code implementation is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aka.ms/Diff-Transformer" title="">https://aka.ms/Diff-Transformer</a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A1.fig2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_minipage ltx_align_top ltx_listing" id="A1.fig2.1" style="width:212.5pt;background-color:#FFFFFF;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZGVmIEZsYXNoRGlmZkF0dG5fMShYLCBXX3EsIFdfaywgV192LCAkXGxhbWJkYSQpOgogICAgUTEsIFEyID0gc3BsaXQoWCBAIFdfcSkKICAgIEsxLCBLMiA9IHNwbGl0KFggQCBXX2spCiAgICBWID0gWCBAIFdfdgoKICAgIEExID0gZmxhc2hfYXR0bihRMSwgSzEsIFYpCgoKICAgIEEyID0gZmxhc2hfYXR0bihRMiwgSzIsIFYpCgoKICAgIHJldHVybiBBMSAtICRcbGFtYmRhJCBBMg==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx36">
<span class="ltx_text ltx_lst_keyword" id="lstnumberx36.2" style="color:#0000FF;">def</span><span class="ltx_text ltx_lst_space" id="lstnumberx36.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx36.4">FlashDiffAttn_1</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx36.5">X</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx36.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx36.7">W_q</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx36.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx36.9">W_k</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx36.10"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx36.11">W_v</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx36.12"> </span><span class="ltx_text" id="lstnumberx36.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="lstnumberx36.1.m1.1"><semantics id="lstnumberx36.1.m1.1a"><mi id="lstnumberx36.1.m1.1.1" mathbackground="#FFFFFF" xref="lstnumberx36.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="lstnumberx36.1.m1.1b"><ci id="lstnumberx36.1.m1.1.1.cmml" xref="lstnumberx36.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx36.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="lstnumberx36.1.m1.1d">italic_λ</annotation></semantics></math></span>):
</div>
<div class="ltx_listingline" id="lstnumberx37">
<span class="ltx_text ltx_lst_space" id="lstnumberx37.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx37.2">Q1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx37.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx37.4">Q2</span><span class="ltx_text ltx_lst_space" id="lstnumberx37.5"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx37.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx37.7">split</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx37.8">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx37.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx37.10">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx37.11"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx37.12">W_q</span>)
</div>
<div class="ltx_listingline" id="lstnumberx38">
<span class="ltx_text ltx_lst_space" id="lstnumberx38.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx38.2">K1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx38.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx38.4">K2</span><span class="ltx_text ltx_lst_space" id="lstnumberx38.5"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx38.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx38.7">split</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx38.8">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx38.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx38.10">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx38.11"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx38.12">W_k</span>)
</div>
<div class="ltx_listingline" id="lstnumberx39">
<span class="ltx_text ltx_lst_space" id="lstnumberx39.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx39.2">V</span><span class="ltx_text ltx_lst_space" id="lstnumberx39.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx39.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx39.5">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx39.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx39.7">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx39.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx39.9">W_v</span>
</div>
<div class="ltx_listingline" id="lstnumberx40">
</div>
<div class="ltx_listingline" id="lstnumberx41">
<span class="ltx_text ltx_lst_space" id="lstnumberx41.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx41.2">A1</span><span class="ltx_text ltx_lst_space" id="lstnumberx41.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx41.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx41.5">flash_attn</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx41.6">Q1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx41.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx41.8">K1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx41.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx41.10">V</span>)
</div>
<div class="ltx_listingline" id="lstnumberx42">
</div>
<div class="ltx_listingline" id="lstnumberx43">
</div>
<div class="ltx_listingline" id="lstnumberx44">
<span class="ltx_text ltx_lst_space" id="lstnumberx44.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx44.2">A2</span><span class="ltx_text ltx_lst_space" id="lstnumberx44.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx44.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx44.5">flash_attn</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx44.6">Q2</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx44.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx44.8">K2</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx44.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx44.10">V</span>)
</div>
<div class="ltx_listingline" id="lstnumberx45">
</div>
<div class="ltx_listingline" id="lstnumberx46">
</div>
<div class="ltx_listingline" id="lstnumberx47">
<span class="ltx_text ltx_lst_space" id="lstnumberx47.2"> </span><span class="ltx_text ltx_lst_keyword" id="lstnumberx47.3" style="color:#0000FF;">return</span><span class="ltx_text ltx_lst_space" id="lstnumberx47.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx47.5">A1</span><span class="ltx_text ltx_lst_space" id="lstnumberx47.6"> </span>-<span class="ltx_text ltx_lst_space" id="lstnumberx47.7"> </span><span class="ltx_text" id="lstnumberx47.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="lstnumberx47.1.m1.1"><semantics id="lstnumberx47.1.m1.1a"><mi id="lstnumberx47.1.m1.1.1" mathbackground="#FFFFFF" xref="lstnumberx47.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="lstnumberx47.1.m1.1b"><ci id="lstnumberx47.1.m1.1.1.cmml" xref="lstnumberx47.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx47.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="lstnumberx47.1.m1.1d">italic_λ</annotation></semantics></math></span><span class="ltx_text ltx_lst_space" id="lstnumberx47.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx47.9">A2</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top ltx_listing" id="A1.fig2.2" style="width:212.5pt;background-color:#FFFFFF;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZGVmIEZsYXNoRGlmZkF0dG5fMihYLCBXX3EsIFdfaywgV192LCAkXGxhbWJkYSQpOgogICAgUTEsIFEyID0gc3BsaXQoWCBAIFdfcSkKICAgIEsxLCBLMiA9IHNwbGl0KFggQCBXX2spCiAgICBWMSwgVjIgPSBzcGxpdChYIEAgV192KQoKICAgIEExMSA9IGZsYXNoX2F0dG4oUTEsIEsxLCBWMSkKICAgIEExMiA9IGZsYXNoX2F0dG4oUTEsIEsxLCBWMikKICAgIEExID0gQ29uY2F0KEExMSwgQTEyKQogICAgQTIxID0gZmxhc2hfYXR0bihRMiwgSzIsIFYxKQogICAgQTIyID0gZmxhc2hfYXR0bihRMiwgSzIsIFYyKQogICAgQTIgPSBDb25jYXQoQTIxLCBBMjIpCiAgICByZXR1cm4gQTEgLSAkXGxhbWJkYSQgQTI=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx48">
<span class="ltx_text ltx_lst_keyword" id="lstnumberx48.2" style="color:#0000FF;">def</span><span class="ltx_text ltx_lst_space" id="lstnumberx48.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx48.4">FlashDiffAttn_2</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx48.5">X</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx48.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx48.7">W_q</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx48.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx48.9">W_k</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx48.10"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx48.11">W_v</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx48.12"> </span><span class="ltx_text" id="lstnumberx48.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="lstnumberx48.1.m1.1"><semantics id="lstnumberx48.1.m1.1a"><mi id="lstnumberx48.1.m1.1.1" mathbackground="#FFFFFF" xref="lstnumberx48.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="lstnumberx48.1.m1.1b"><ci id="lstnumberx48.1.m1.1.1.cmml" xref="lstnumberx48.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx48.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="lstnumberx48.1.m1.1d">italic_λ</annotation></semantics></math></span>):
</div>
<div class="ltx_listingline" id="lstnumberx49">
<span class="ltx_text ltx_lst_space" id="lstnumberx49.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx49.2">Q1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx49.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx49.4">Q2</span><span class="ltx_text ltx_lst_space" id="lstnumberx49.5"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx49.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx49.7">split</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx49.8">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx49.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx49.10">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx49.11"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx49.12">W_q</span>)
</div>
<div class="ltx_listingline" id="lstnumberx50">
<span class="ltx_text ltx_lst_space" id="lstnumberx50.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx50.2">K1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx50.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx50.4">K2</span><span class="ltx_text ltx_lst_space" id="lstnumberx50.5"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx50.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx50.7">split</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx50.8">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx50.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx50.10">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx50.11"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx50.12">W_k</span>)
</div>
<div class="ltx_listingline" id="lstnumberx51">
<span class="ltx_text ltx_lst_space" id="lstnumberx51.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx51.2">V1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx51.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx51.4">V2</span><span class="ltx_text ltx_lst_space" id="lstnumberx51.5"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx51.6"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx51.7">split</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx51.8">X</span><span class="ltx_text ltx_lst_space" id="lstnumberx51.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx51.10">@</span><span class="ltx_text ltx_lst_space" id="lstnumberx51.11"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx51.12">W_v</span>)
</div>
<div class="ltx_listingline" id="lstnumberx52">
</div>
<div class="ltx_listingline" id="lstnumberx53">
<span class="ltx_text ltx_lst_space" id="lstnumberx53.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx53.2">A11</span><span class="ltx_text ltx_lst_space" id="lstnumberx53.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx53.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx53.5">flash_attn</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx53.6">Q1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx53.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx53.8">K1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx53.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx53.10">V1</span>)
</div>
<div class="ltx_listingline" id="lstnumberx54">
<span class="ltx_text ltx_lst_space" id="lstnumberx54.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx54.2">A12</span><span class="ltx_text ltx_lst_space" id="lstnumberx54.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx54.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx54.5">flash_attn</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx54.6">Q1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx54.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx54.8">K1</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx54.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx54.10">V2</span>)
</div>
<div class="ltx_listingline" id="lstnumberx55">
<span class="ltx_text ltx_lst_space" id="lstnumberx55.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx55.2">A1</span><span class="ltx_text ltx_lst_space" id="lstnumberx55.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx55.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx55.5">Concat</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx55.6">A11</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx55.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx55.8">A12</span>)
</div>
<div class="ltx_listingline" id="lstnumberx56">
<span class="ltx_text ltx_lst_space" id="lstnumberx56.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx56.2">A21</span><span class="ltx_text ltx_lst_space" id="lstnumberx56.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx56.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx56.5">flash_attn</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx56.6">Q2</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx56.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx56.8">K2</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx56.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx56.10">V1</span>)
</div>
<div class="ltx_listingline" id="lstnumberx57">
<span class="ltx_text ltx_lst_space" id="lstnumberx57.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx57.2">A22</span><span class="ltx_text ltx_lst_space" id="lstnumberx57.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx57.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx57.5">flash_attn</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx57.6">Q2</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx57.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx57.8">K2</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx57.9"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx57.10">V2</span>)
</div>
<div class="ltx_listingline" id="lstnumberx58">
<span class="ltx_text ltx_lst_space" id="lstnumberx58.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx58.2">A2</span><span class="ltx_text ltx_lst_space" id="lstnumberx58.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx58.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx58.5">Concat</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx58.6">A21</span>,<span class="ltx_text ltx_lst_space" id="lstnumberx58.7"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx58.8">A22</span>)
</div>
<div class="ltx_listingline" id="lstnumberx59">
<span class="ltx_text ltx_lst_space" id="lstnumberx59.2"> </span><span class="ltx_text ltx_lst_keyword" id="lstnumberx59.3" style="color:#0000FF;">return</span><span class="ltx_text ltx_lst_space" id="lstnumberx59.4"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx59.5">A1</span><span class="ltx_text ltx_lst_space" id="lstnumberx59.6"> </span>-<span class="ltx_text ltx_lst_space" id="lstnumberx59.7"> </span><span class="ltx_text" id="lstnumberx59.1"><math alttext="\lambda" class="ltx_Math" display="inline" id="lstnumberx59.1.m1.1"><semantics id="lstnumberx59.1.m1.1a"><mi id="lstnumberx59.1.m1.1.1" mathbackground="#FFFFFF" xref="lstnumberx59.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="lstnumberx59.1.m1.1b"><ci id="lstnumberx59.1.m1.1.1.cmml" xref="lstnumberx59.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx59.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="lstnumberx59.1.m1.1d">italic_λ</annotation></semantics></math></span><span class="ltx_text ltx_lst_space" id="lstnumberx59.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx59.9">A2</span>
</div>
</div>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.p4">
<p class="ltx_p" id="A1.p4.1"><span class="ltx_text ltx_font_bold" id="A1.p4.1.1">Efficiency</span>&nbsp;&nbsp;
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A1.T7" title="In Appendix A Implementation of Differential Attention ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a> compares the throughput between <span class="ltx_text ltx_font_smallcaps" id="A1.p4.1.2">Diff</span> Transformer and Transformer.
For fair comparison, we use the <span class="ltx_text ltx_font_typewriter" id="A1.p4.1.3">customized-flash-attention</span> implementation mentioned above for both methods. The experiments are conducted with Nvidia H100-80GB GPU cards.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A1.T7">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T7.6" style="width:318.0pt;height:131.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-15.4pt,6.3pt) scale(0.911940899191071,0.911940899191071) ;">
<table class="ltx_tabular ltx_align_middle" id="A1.T7.6.6">
<tbody><tr class="ltx_tr" id="A1.T7.6.6.7">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T7.6.6.7.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A1.T7.6.6.7.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T7.6.6.7.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="A1.T7.6.6.7.2.1">Model Size</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T7.6.6.7.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="A1.T7.6.6.7.3.1">Length</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="A1.T7.6.6.7.4"><span class="ltx_text ltx_font_bold" id="A1.T7.6.6.7.4.1">Throughput</span></td>
</tr>
<tr class="ltx_tr" id="A1.T7.6.6.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.8.1"><span class="ltx_text ltx_font_bold" id="A1.T7.6.6.8.1.1">Forward + Backward</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.8.2"><span class="ltx_text ltx_font_bold" id="A1.T7.6.6.8.2.1">Forward</span></td>
</tr>
<tr class="ltx_tr" id="A1.T7.6.6.9">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.6.6.9.1">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.9.2">3B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.9.3">2K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.9.4">7247</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.9.5">51228</td>
</tr>
<tr class="ltx_tr" id="A1.T7.2.2.2">
<td class="ltx_td ltx_align_left" id="A1.T7.2.2.2.3"><span class="ltx_text ltx_font_smallcaps" id="A1.T7.2.2.2.3.1">Diff</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.2.2.2.4">3B</td>
<td class="ltx_td ltx_align_center" id="A1.T7.2.2.2.5">2K</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.1.1.1">6635 (<math alttext="-9\%" class="ltx_Math" display="inline" id="A1.T7.1.1.1.1.m1.1"><semantics id="A1.T7.1.1.1.1.m1.1a"><mrow id="A1.T7.1.1.1.1.m1.1.1" xref="A1.T7.1.1.1.1.m1.1.1.cmml"><mo id="A1.T7.1.1.1.1.m1.1.1a" xref="A1.T7.1.1.1.1.m1.1.1.cmml">−</mo><mrow id="A1.T7.1.1.1.1.m1.1.1.2" xref="A1.T7.1.1.1.1.m1.1.1.2.cmml"><mn id="A1.T7.1.1.1.1.m1.1.1.2.2" xref="A1.T7.1.1.1.1.m1.1.1.2.2.cmml">9</mn><mo id="A1.T7.1.1.1.1.m1.1.1.2.1" xref="A1.T7.1.1.1.1.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T7.1.1.1.1.m1.1b"><apply id="A1.T7.1.1.1.1.m1.1.1.cmml" xref="A1.T7.1.1.1.1.m1.1.1"><minus id="A1.T7.1.1.1.1.m1.1.1.1.cmml" xref="A1.T7.1.1.1.1.m1.1.1"></minus><apply id="A1.T7.1.1.1.1.m1.1.1.2.cmml" xref="A1.T7.1.1.1.1.m1.1.1.2"><csymbol cd="latexml" id="A1.T7.1.1.1.1.m1.1.1.2.1.cmml" xref="A1.T7.1.1.1.1.m1.1.1.2.1">percent</csymbol><cn id="A1.T7.1.1.1.1.m1.1.1.2.2.cmml" type="integer" xref="A1.T7.1.1.1.1.m1.1.1.2.2">9</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.1.1.1.1.m1.1c">-9\%</annotation><annotation encoding="application/x-llamapun" id="A1.T7.1.1.1.1.m1.1d">- 9 %</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="A1.T7.2.2.2.2">46811 (<math alttext="-9\%" class="ltx_Math" display="inline" id="A1.T7.2.2.2.2.m1.1"><semantics id="A1.T7.2.2.2.2.m1.1a"><mrow id="A1.T7.2.2.2.2.m1.1.1" xref="A1.T7.2.2.2.2.m1.1.1.cmml"><mo id="A1.T7.2.2.2.2.m1.1.1a" xref="A1.T7.2.2.2.2.m1.1.1.cmml">−</mo><mrow id="A1.T7.2.2.2.2.m1.1.1.2" xref="A1.T7.2.2.2.2.m1.1.1.2.cmml"><mn id="A1.T7.2.2.2.2.m1.1.1.2.2" xref="A1.T7.2.2.2.2.m1.1.1.2.2.cmml">9</mn><mo id="A1.T7.2.2.2.2.m1.1.1.2.1" xref="A1.T7.2.2.2.2.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T7.2.2.2.2.m1.1b"><apply id="A1.T7.2.2.2.2.m1.1.1.cmml" xref="A1.T7.2.2.2.2.m1.1.1"><minus id="A1.T7.2.2.2.2.m1.1.1.1.cmml" xref="A1.T7.2.2.2.2.m1.1.1"></minus><apply id="A1.T7.2.2.2.2.m1.1.1.2.cmml" xref="A1.T7.2.2.2.2.m1.1.1.2"><csymbol cd="latexml" id="A1.T7.2.2.2.2.m1.1.1.2.1.cmml" xref="A1.T7.2.2.2.2.m1.1.1.2.1">percent</csymbol><cn id="A1.T7.2.2.2.2.m1.1.1.2.2.cmml" type="integer" xref="A1.T7.2.2.2.2.m1.1.1.2.2">9</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.2.2.2.2.m1.1c">-9\%</annotation><annotation encoding="application/x-llamapun" id="A1.T7.2.2.2.2.m1.1d">- 9 %</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="A1.T7.6.6.10">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.6.6.10.1">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.10.2">3B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.10.3">4K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.10.4">7491</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.10.5">48762</td>
</tr>
<tr class="ltx_tr" id="A1.T7.4.4.4">
<td class="ltx_td ltx_align_left" id="A1.T7.4.4.4.3"><span class="ltx_text ltx_font_smallcaps" id="A1.T7.4.4.4.3.1">Diff</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.4.4.4.4">3B</td>
<td class="ltx_td ltx_align_center" id="A1.T7.4.4.4.5">4K</td>
<td class="ltx_td ltx_align_center" id="A1.T7.3.3.3.1">6718 (<math alttext="-12\%" class="ltx_Math" display="inline" id="A1.T7.3.3.3.1.m1.1"><semantics id="A1.T7.3.3.3.1.m1.1a"><mrow id="A1.T7.3.3.3.1.m1.1.1" xref="A1.T7.3.3.3.1.m1.1.1.cmml"><mo id="A1.T7.3.3.3.1.m1.1.1a" xref="A1.T7.3.3.3.1.m1.1.1.cmml">−</mo><mrow id="A1.T7.3.3.3.1.m1.1.1.2" xref="A1.T7.3.3.3.1.m1.1.1.2.cmml"><mn id="A1.T7.3.3.3.1.m1.1.1.2.2" xref="A1.T7.3.3.3.1.m1.1.1.2.2.cmml">12</mn><mo id="A1.T7.3.3.3.1.m1.1.1.2.1" xref="A1.T7.3.3.3.1.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T7.3.3.3.1.m1.1b"><apply id="A1.T7.3.3.3.1.m1.1.1.cmml" xref="A1.T7.3.3.3.1.m1.1.1"><minus id="A1.T7.3.3.3.1.m1.1.1.1.cmml" xref="A1.T7.3.3.3.1.m1.1.1"></minus><apply id="A1.T7.3.3.3.1.m1.1.1.2.cmml" xref="A1.T7.3.3.3.1.m1.1.1.2"><csymbol cd="latexml" id="A1.T7.3.3.3.1.m1.1.1.2.1.cmml" xref="A1.T7.3.3.3.1.m1.1.1.2.1">percent</csymbol><cn id="A1.T7.3.3.3.1.m1.1.1.2.2.cmml" type="integer" xref="A1.T7.3.3.3.1.m1.1.1.2.2">12</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.3.3.3.1.m1.1c">-12\%</annotation><annotation encoding="application/x-llamapun" id="A1.T7.3.3.3.1.m1.1d">- 12 %</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="A1.T7.4.4.4.2">44521 (<math alttext="-10\%" class="ltx_Math" display="inline" id="A1.T7.4.4.4.2.m1.1"><semantics id="A1.T7.4.4.4.2.m1.1a"><mrow id="A1.T7.4.4.4.2.m1.1.1" xref="A1.T7.4.4.4.2.m1.1.1.cmml"><mo id="A1.T7.4.4.4.2.m1.1.1a" xref="A1.T7.4.4.4.2.m1.1.1.cmml">−</mo><mrow id="A1.T7.4.4.4.2.m1.1.1.2" xref="A1.T7.4.4.4.2.m1.1.1.2.cmml"><mn id="A1.T7.4.4.4.2.m1.1.1.2.2" xref="A1.T7.4.4.4.2.m1.1.1.2.2.cmml">10</mn><mo id="A1.T7.4.4.4.2.m1.1.1.2.1" xref="A1.T7.4.4.4.2.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T7.4.4.4.2.m1.1b"><apply id="A1.T7.4.4.4.2.m1.1.1.cmml" xref="A1.T7.4.4.4.2.m1.1.1"><minus id="A1.T7.4.4.4.2.m1.1.1.1.cmml" xref="A1.T7.4.4.4.2.m1.1.1"></minus><apply id="A1.T7.4.4.4.2.m1.1.1.2.cmml" xref="A1.T7.4.4.4.2.m1.1.1.2"><csymbol cd="latexml" id="A1.T7.4.4.4.2.m1.1.1.2.1.cmml" xref="A1.T7.4.4.4.2.m1.1.1.2.1">percent</csymbol><cn id="A1.T7.4.4.4.2.m1.1.1.2.2.cmml" type="integer" xref="A1.T7.4.4.4.2.m1.1.1.2.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.4.4.4.2.m1.1c">-10\%</annotation><annotation encoding="application/x-llamapun" id="A1.T7.4.4.4.2.m1.1d">- 10 %</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="A1.T7.6.6.11">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.6.6.11.1">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.11.2">13B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.11.3">2K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.11.4">998</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.6.6.11.5">14346</td>
</tr>
<tr class="ltx_tr" id="A1.T7.6.6.6">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T7.6.6.6.3"><span class="ltx_text ltx_font_smallcaps" id="A1.T7.6.6.6.3.1">Diff</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.6.6.6.4">13B</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.6.6.6.5">2K</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.5.5.5.1">942 (<math alttext="-6\%" class="ltx_Math" display="inline" id="A1.T7.5.5.5.1.m1.1"><semantics id="A1.T7.5.5.5.1.m1.1a"><mrow id="A1.T7.5.5.5.1.m1.1.1" xref="A1.T7.5.5.5.1.m1.1.1.cmml"><mo id="A1.T7.5.5.5.1.m1.1.1a" xref="A1.T7.5.5.5.1.m1.1.1.cmml">−</mo><mrow id="A1.T7.5.5.5.1.m1.1.1.2" xref="A1.T7.5.5.5.1.m1.1.1.2.cmml"><mn id="A1.T7.5.5.5.1.m1.1.1.2.2" xref="A1.T7.5.5.5.1.m1.1.1.2.2.cmml">6</mn><mo id="A1.T7.5.5.5.1.m1.1.1.2.1" xref="A1.T7.5.5.5.1.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T7.5.5.5.1.m1.1b"><apply id="A1.T7.5.5.5.1.m1.1.1.cmml" xref="A1.T7.5.5.5.1.m1.1.1"><minus id="A1.T7.5.5.5.1.m1.1.1.1.cmml" xref="A1.T7.5.5.5.1.m1.1.1"></minus><apply id="A1.T7.5.5.5.1.m1.1.1.2.cmml" xref="A1.T7.5.5.5.1.m1.1.1.2"><csymbol cd="latexml" id="A1.T7.5.5.5.1.m1.1.1.2.1.cmml" xref="A1.T7.5.5.5.1.m1.1.1.2.1">percent</csymbol><cn id="A1.T7.5.5.5.1.m1.1.1.2.2.cmml" type="integer" xref="A1.T7.5.5.5.1.m1.1.1.2.2">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.5.5.5.1.m1.1c">-6\%</annotation><annotation encoding="application/x-llamapun" id="A1.T7.5.5.5.1.m1.1d">- 6 %</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.6.6.6.2">13653 (<math alttext="-5\%" class="ltx_Math" display="inline" id="A1.T7.6.6.6.2.m1.1"><semantics id="A1.T7.6.6.6.2.m1.1a"><mrow id="A1.T7.6.6.6.2.m1.1.1" xref="A1.T7.6.6.6.2.m1.1.1.cmml"><mo id="A1.T7.6.6.6.2.m1.1.1a" xref="A1.T7.6.6.6.2.m1.1.1.cmml">−</mo><mrow id="A1.T7.6.6.6.2.m1.1.1.2" xref="A1.T7.6.6.6.2.m1.1.1.2.cmml"><mn id="A1.T7.6.6.6.2.m1.1.1.2.2" xref="A1.T7.6.6.6.2.m1.1.1.2.2.cmml">5</mn><mo id="A1.T7.6.6.6.2.m1.1.1.2.1" xref="A1.T7.6.6.6.2.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T7.6.6.6.2.m1.1b"><apply id="A1.T7.6.6.6.2.m1.1.1.cmml" xref="A1.T7.6.6.6.2.m1.1.1"><minus id="A1.T7.6.6.6.2.m1.1.1.1.cmml" xref="A1.T7.6.6.6.2.m1.1.1"></minus><apply id="A1.T7.6.6.6.2.m1.1.1.2.cmml" xref="A1.T7.6.6.6.2.m1.1.1.2"><csymbol cd="latexml" id="A1.T7.6.6.6.2.m1.1.1.2.1.cmml" xref="A1.T7.6.6.6.2.m1.1.1.2.1">percent</csymbol><cn id="A1.T7.6.6.6.2.m1.1.1.2.2.cmml" type="integer" xref="A1.T7.6.6.6.2.m1.1.1.2.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.6.6.6.2.m1.1c">-5\%</annotation><annotation encoding="application/x-llamapun" id="A1.T7.6.6.6.2.m1.1d">- 5 %</annotation></semantics></math>)</td>
</tr>
</tbody></table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Throughput is measured with number of tokens per second.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.p5">
<p class="ltx_p" id="A1.p5.1">As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A1.T7" title="In Appendix A Implementation of Differential Attention ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a>, we evaluate the settings with different model size (3B, 13B) and context length (2K, 4K).
For 3B models, there are 12 heads for <span class="ltx_text ltx_font_smallcaps" id="A1.p5.1.1">Diff</span> Transformer and 24 heads for Transformer.
For 13B model there are 20 heads for <span class="ltx_text ltx_font_smallcaps" id="A1.p5.1.2">Diff</span> Transformer and 40 heads for Transformer.
All models have the same head dimension <math alttext="d=128" class="ltx_Math" display="inline" id="A1.p5.1.m1.1"><semantics id="A1.p5.1.m1.1a"><mrow id="A1.p5.1.m1.1.1" xref="A1.p5.1.m1.1.1.cmml"><mi id="A1.p5.1.m1.1.1.2" xref="A1.p5.1.m1.1.1.2.cmml">d</mi><mo id="A1.p5.1.m1.1.1.1" xref="A1.p5.1.m1.1.1.1.cmml">=</mo><mn id="A1.p5.1.m1.1.1.3" xref="A1.p5.1.m1.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p5.1.m1.1b"><apply id="A1.p5.1.m1.1.1.cmml" xref="A1.p5.1.m1.1.1"><eq id="A1.p5.1.m1.1.1.1.cmml" xref="A1.p5.1.m1.1.1.1"></eq><ci id="A1.p5.1.m1.1.1.2.cmml" xref="A1.p5.1.m1.1.1.2">𝑑</ci><cn id="A1.p5.1.m1.1.1.3.cmml" type="integer" xref="A1.p5.1.m1.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.1.m1.1c">d=128</annotation><annotation encoding="application/x-llamapun" id="A1.p5.1.m1.1d">italic_d = 128</annotation></semantics></math>.
Training efficiency consists of forward and backward.
Prefill efficiency only includes forward.
<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A1.T7" title="In Appendix A Implementation of Differential Attention ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a> shows that the throughput results are comparable within an acceptable range.
Notice that the <span class="ltx_text ltx_font_typewriter" id="A1.p5.1.3">customized-flash-attention</span> implementation is built on FlashAttention2&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib7" title="">7</a>]</cite>.
With the recent release of FlashAttention3&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib34" title="">34</a>]</cite>, the gap of throughput can be further reduced.
More advanced kernel implementation, which is specifically designed for differential attention, can also improve throughput.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Language Modeling Evaluation</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">Following the same setting as in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS1" title="3.1 Language Modeling Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.1</span></a>, we train 3B-size language models on 350B tokens and compare <span class="ltx_text ltx_font_smallcaps" id="A2.p1.1.1">Diff</span> Transformer with Transformer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib41" title="">41</a>]</cite> in various downstream tasks.
We use the augmented Transformer architecture as in LLaMA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib38" title="">38</a>]</cite>.
Specifically, the “Transformer” models include improvements in RMSNorm&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib46" title="">46</a>]</cite>, SwiGLU&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib29" title="">29</a>]</cite>, and removal of bias.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A2.T8" title="In Appendix B Language Modeling Evaluation ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">8</span></a> reports the zero-shot and 5-shot results on the LM Eval Harness benchmark&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib12" title="">12</a>]</cite>.
The results show that <span class="ltx_text ltx_font_smallcaps" id="A2.p2.1.1">Diff</span> Transformer outperforms Transformer across various tasks in both zero-shot and few-shot settings.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A2.T8">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A2.T8.1" style="width:433.6pt;height:124.2pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-5.0pt,1.4pt) scale(0.977384426368604,0.977384426368604) ;">
<table class="ltx_tabular ltx_align_middle" id="A2.T8.1.1">
<tbody><tr class="ltx_tr" id="A2.T8.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A2.T8.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.2.1">ARC-C</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.3.1">ARC-E</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.4.1">BoolQ</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.1.1.1.5"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.5.1">HellaSwag</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.1.1.1.6"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.6.1">OBQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.1.1.1.7"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.7.1">PIQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.1.1.1.8"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.8.1">WinoGrande</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.1.1.1.9"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.9.1">Avg</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" colspan="9" id="A2.T8.1.1.2.1"><span class="ltx_text ltx_font_italic" id="A2.T8.1.1.2.1.1">Training with 350B tokens (Zero-Shot)</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.1.3">
<td class="ltx_td ltx_align_left" id="A2.T8.1.1.3.1">Transformer-3B</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.3.2">32.2</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.3.3">66.8</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.3.4"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.3.4.1">62.9</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.3.5">63.4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.3.6">26.2</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.3.7">74.5</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.3.8">61.6</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.3.9">55.4</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.1.4">
<td class="ltx_td ltx_align_left" id="A2.T8.1.1.4.1">
<span class="ltx_text ltx_font_smallcaps" id="A2.T8.1.1.4.1.1">Diff</span>-3B</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.4.2"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.4.2.1">33.0</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.4.3"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.4.3.1">68.3</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.4.4">60.1</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.4.5"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.4.5.1">66.2</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.4.6"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.4.6.1">27.6</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.4.7"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.4.7.1">75.5</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.4.8"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.4.8.1">62.7</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.4.9"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.4.9.1">56.2</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.1.5">
<td class="ltx_td ltx_align_left ltx_border_t" colspan="9" id="A2.T8.1.1.5.1"><span class="ltx_text ltx_font_italic" id="A2.T8.1.1.5.1.1">Training with 350B tokens (5-Shot)</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.1.6">
<td class="ltx_td ltx_align_left" id="A2.T8.1.1.6.1">Transformer-3B</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.6.2">34.0</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.6.3"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.6.3.1">69.5</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.6.4">65.3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.6.5">63.4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.6.6">25.0</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.6.7">75.2</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.6.8">62.6</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.6.9">56.4</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.1.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T8.1.1.7.1">
<span class="ltx_text ltx_font_smallcaps" id="A2.T8.1.1.7.1.1">Diff</span>-3B</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.1.7.2"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.7.2.1">35.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.1.7.3"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.7.3.1">69.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.1.7.4"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.7.4.1">67.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.1.7.5"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.7.5.1">66.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.1.7.6"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.7.6.1">27.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.1.7.7"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.7.7.1">76.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.1.7.8"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.7.8.1">63.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.1.1.7.9"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.7.9.1">58.0</span></td>
</tr>
</tbody></table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Comparison of <span class="ltx_text ltx_font_smallcaps" id="A2.T8.4.1">Diff</span> Transformer with well-trained Transformer language models on LM Eval Harness&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib12" title="">12</a>]</cite>.
<span class="ltx_text ltx_font_smallcaps" id="A2.T8.5.2">Diff</span> Transformer achieves better accuracy in the zero- and few-shot settings.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Hyperparameters for <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS1" title="3.1 Language Modeling Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.1</span></a>
</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A3.T9" title="In Appendix C Hyperparameters for Section 3.1 ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">9</span></a> presents the detailed hyperparameters for the <span class="ltx_text ltx_font_smallcaps" id="A3.p1.1.1">Diff</span> Transformer-3B models in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS1" title="3.1 Language Modeling Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.1</span></a>.
For Transformer-3B, the only difference is that there are 24 heads.
Notice that both Transformer-3B and <span class="ltx_text ltx_font_smallcaps" id="A3.p1.1.2">Diff</span> Transformer-3B have similar FLOPs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A3.T9">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T9.2">
<tbody><tr class="ltx_tr" id="A3.T9.2.3">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A3.T9.2.3.1"><span class="ltx_text ltx_font_bold" id="A3.T9.2.3.1.1">Params</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T9.2.3.2"><span class="ltx_text ltx_font_bold" id="A3.T9.2.3.2.1">Values</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.2.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.2.4.1">Layers</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.2.4.2">28</td>
</tr>
<tr class="ltx_tr" id="A3.T9.2.5">
<td class="ltx_td ltx_align_left" id="A3.T9.2.5.1">Hidden size</td>
<td class="ltx_td ltx_align_center" id="A3.T9.2.5.2">3072</td>
</tr>
<tr class="ltx_tr" id="A3.T9.2.6">
<td class="ltx_td ltx_align_left" id="A3.T9.2.6.1">FFN size</td>
<td class="ltx_td ltx_align_center" id="A3.T9.2.6.2">8192</td>
</tr>
<tr class="ltx_tr" id="A3.T9.2.7">
<td class="ltx_td ltx_align_left" id="A3.T9.2.7.1">Vocab size</td>
<td class="ltx_td ltx_align_center" id="A3.T9.2.7.2">100,288</td>
</tr>
<tr class="ltx_tr" id="A3.T9.2.8">
<td class="ltx_td ltx_align_left" id="A3.T9.2.8.1">Heads</td>
<td class="ltx_td ltx_align_center" id="A3.T9.2.8.2">12</td>
</tr>
<tr class="ltx_tr" id="A3.T9.1.1">
<td class="ltx_td ltx_align_left" id="A3.T9.1.1.1">Adam <math alttext="\beta" class="ltx_Math" display="inline" id="A3.T9.1.1.1.m1.1"><semantics id="A3.T9.1.1.1.m1.1a"><mi id="A3.T9.1.1.1.m1.1.1" xref="A3.T9.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A3.T9.1.1.1.m1.1b"><ci id="A3.T9.1.1.1.m1.1.1.cmml" xref="A3.T9.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.1.1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A3.T9.1.1.1.m1.1d">italic_β</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="A3.T9.1.1.2">(0.9, 0.95)</td>
</tr>
<tr class="ltx_tr" id="A3.T9.2.2">
<td class="ltx_td ltx_align_left" id="A3.T9.2.2.2">LR</td>
<td class="ltx_td ltx_align_center" id="A3.T9.2.2.1"><math alttext="3.2\times 10^{-4}" class="ltx_Math" display="inline" id="A3.T9.2.2.1.m1.1"><semantics id="A3.T9.2.2.1.m1.1a"><mrow id="A3.T9.2.2.1.m1.1.1" xref="A3.T9.2.2.1.m1.1.1.cmml"><mn id="A3.T9.2.2.1.m1.1.1.2" xref="A3.T9.2.2.1.m1.1.1.2.cmml">3.2</mn><mo id="A3.T9.2.2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T9.2.2.1.m1.1.1.1.cmml">×</mo><msup id="A3.T9.2.2.1.m1.1.1.3" xref="A3.T9.2.2.1.m1.1.1.3.cmml"><mn id="A3.T9.2.2.1.m1.1.1.3.2" xref="A3.T9.2.2.1.m1.1.1.3.2.cmml">10</mn><mrow id="A3.T9.2.2.1.m1.1.1.3.3" xref="A3.T9.2.2.1.m1.1.1.3.3.cmml"><mo id="A3.T9.2.2.1.m1.1.1.3.3a" xref="A3.T9.2.2.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.T9.2.2.1.m1.1.1.3.3.2" xref="A3.T9.2.2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.T9.2.2.1.m1.1b"><apply id="A3.T9.2.2.1.m1.1.1.cmml" xref="A3.T9.2.2.1.m1.1.1"><times id="A3.T9.2.2.1.m1.1.1.1.cmml" xref="A3.T9.2.2.1.m1.1.1.1"></times><cn id="A3.T9.2.2.1.m1.1.1.2.cmml" type="float" xref="A3.T9.2.2.1.m1.1.1.2">3.2</cn><apply id="A3.T9.2.2.1.m1.1.1.3.cmml" xref="A3.T9.2.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.T9.2.2.1.m1.1.1.3.1.cmml" xref="A3.T9.2.2.1.m1.1.1.3">superscript</csymbol><cn id="A3.T9.2.2.1.m1.1.1.3.2.cmml" type="integer" xref="A3.T9.2.2.1.m1.1.1.3.2">10</cn><apply id="A3.T9.2.2.1.m1.1.1.3.3.cmml" xref="A3.T9.2.2.1.m1.1.1.3.3"><minus id="A3.T9.2.2.1.m1.1.1.3.3.1.cmml" xref="A3.T9.2.2.1.m1.1.1.3.3"></minus><cn id="A3.T9.2.2.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.T9.2.2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T9.2.2.1.m1.1c">3.2\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.T9.2.2.1.m1.1d">3.2 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A3.T9.2.9">
<td class="ltx_td ltx_align_left" id="A3.T9.2.9.1">Batch size</td>
<td class="ltx_td ltx_align_center" id="A3.T9.2.9.2">4M</td>
</tr>
<tr class="ltx_tr" id="A3.T9.2.10">
<td class="ltx_td ltx_align_left" id="A3.T9.2.10.1">Warmup steps</td>
<td class="ltx_td ltx_align_center" id="A3.T9.2.10.2">1000</td>
</tr>
<tr class="ltx_tr" id="A3.T9.2.11">
<td class="ltx_td ltx_align_left" id="A3.T9.2.11.1">Weight decay</td>
<td class="ltx_td ltx_align_center" id="A3.T9.2.11.2">0.1</td>
</tr>
<tr class="ltx_tr" id="A3.T9.2.12">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T9.2.12.1">Dropout</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.2.12.2">0.0</td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Hyperparamters used for the <span class="ltx_text ltx_font_smallcaps" id="A3.T9.4.1">Diff</span> Transformer-3B model in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS1" title="3.1 Language Modeling Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.1</span></a>.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Hyperparameters for <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS2" title="3.2 Scalability Compared with Transformer ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.2</span></a>
</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.5"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A4.T10" title="In Appendix D Hyperparameters for Section 3.2 ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">10</span></a> reports the hidden dimension, number of layers, and number of heads of <span class="ltx_text ltx_font_smallcaps" id="A4.p1.5.1">Diff</span> Transformer for different model sizes.
For all model sizes of Transformer, we double the number of heads compared with <span class="ltx_text ltx_font_smallcaps" id="A4.p1.5.2">Diff</span> Transformer to align parameters.
The FFN size is <math alttext="\frac{8}{3}\times d_{\text{model}}" class="ltx_Math" display="inline" id="A4.p1.1.m1.1"><semantics id="A4.p1.1.m1.1a"><mrow id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml"><mfrac id="A4.p1.1.m1.1.1.2" xref="A4.p1.1.m1.1.1.2.cmml"><mn id="A4.p1.1.m1.1.1.2.2" xref="A4.p1.1.m1.1.1.2.2.cmml">8</mn><mn id="A4.p1.1.m1.1.1.2.3" xref="A4.p1.1.m1.1.1.2.3.cmml">3</mn></mfrac><mo id="A4.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.p1.1.m1.1.1.1.cmml">×</mo><msub id="A4.p1.1.m1.1.1.3" xref="A4.p1.1.m1.1.1.3.cmml"><mi id="A4.p1.1.m1.1.1.3.2" xref="A4.p1.1.m1.1.1.3.2.cmml">d</mi><mtext id="A4.p1.1.m1.1.1.3.3" xref="A4.p1.1.m1.1.1.3.3a.cmml">model</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><apply id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1"><times id="A4.p1.1.m1.1.1.1.cmml" xref="A4.p1.1.m1.1.1.1"></times><apply id="A4.p1.1.m1.1.1.2.cmml" xref="A4.p1.1.m1.1.1.2"><divide id="A4.p1.1.m1.1.1.2.1.cmml" xref="A4.p1.1.m1.1.1.2"></divide><cn id="A4.p1.1.m1.1.1.2.2.cmml" type="integer" xref="A4.p1.1.m1.1.1.2.2">8</cn><cn id="A4.p1.1.m1.1.1.2.3.cmml" type="integer" xref="A4.p1.1.m1.1.1.2.3">3</cn></apply><apply id="A4.p1.1.m1.1.1.3.cmml" xref="A4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A4.p1.1.m1.1.1.3.1.cmml" xref="A4.p1.1.m1.1.1.3">subscript</csymbol><ci id="A4.p1.1.m1.1.1.3.2.cmml" xref="A4.p1.1.m1.1.1.3.2">𝑑</ci><ci id="A4.p1.1.m1.1.1.3.3a.cmml" xref="A4.p1.1.m1.1.1.3.3"><mtext id="A4.p1.1.m1.1.1.3.3.cmml" mathsize="70%" xref="A4.p1.1.m1.1.1.3.3">model</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">\frac{8}{3}\times d_{\text{model}}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.1.m1.1d">divide start_ARG 8 end_ARG start_ARG 3 end_ARG × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="d_{\text{model}}" class="ltx_Math" display="inline" id="A4.p1.2.m2.1"><semantics id="A4.p1.2.m2.1a"><msub id="A4.p1.2.m2.1.1" xref="A4.p1.2.m2.1.1.cmml"><mi id="A4.p1.2.m2.1.1.2" xref="A4.p1.2.m2.1.1.2.cmml">d</mi><mtext id="A4.p1.2.m2.1.1.3" xref="A4.p1.2.m2.1.1.3a.cmml">model</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.p1.2.m2.1b"><apply id="A4.p1.2.m2.1.1.cmml" xref="A4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A4.p1.2.m2.1.1.1.cmml" xref="A4.p1.2.m2.1.1">subscript</csymbol><ci id="A4.p1.2.m2.1.1.2.cmml" xref="A4.p1.2.m2.1.1.2">𝑑</ci><ci id="A4.p1.2.m2.1.1.3a.cmml" xref="A4.p1.2.m2.1.1.3"><mtext id="A4.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="A4.p1.2.m2.1.1.3">model</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.2.m2.1c">d_{\text{model}}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.2.m2.1d">italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT</annotation></semantics></math> is the hidden dimension.
The training length is set to 2048.
The batch size is set to 0.25M tokens.
We use AdamW&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib24" title="">24</a>]</cite> with <math alttext="\beta_{1}=0.9,\beta_{2}=0.98" class="ltx_Math" display="inline" id="A4.p1.3.m3.2"><semantics id="A4.p1.3.m3.2a"><mrow id="A4.p1.3.m3.2.2.2" xref="A4.p1.3.m3.2.2.3.cmml"><mrow id="A4.p1.3.m3.1.1.1.1" xref="A4.p1.3.m3.1.1.1.1.cmml"><msub id="A4.p1.3.m3.1.1.1.1.2" xref="A4.p1.3.m3.1.1.1.1.2.cmml"><mi id="A4.p1.3.m3.1.1.1.1.2.2" xref="A4.p1.3.m3.1.1.1.1.2.2.cmml">β</mi><mn id="A4.p1.3.m3.1.1.1.1.2.3" xref="A4.p1.3.m3.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A4.p1.3.m3.1.1.1.1.1" xref="A4.p1.3.m3.1.1.1.1.1.cmml">=</mo><mn id="A4.p1.3.m3.1.1.1.1.3" xref="A4.p1.3.m3.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="A4.p1.3.m3.2.2.2.3" xref="A4.p1.3.m3.2.2.3a.cmml">,</mo><mrow id="A4.p1.3.m3.2.2.2.2" xref="A4.p1.3.m3.2.2.2.2.cmml"><msub id="A4.p1.3.m3.2.2.2.2.2" xref="A4.p1.3.m3.2.2.2.2.2.cmml"><mi id="A4.p1.3.m3.2.2.2.2.2.2" xref="A4.p1.3.m3.2.2.2.2.2.2.cmml">β</mi><mn id="A4.p1.3.m3.2.2.2.2.2.3" xref="A4.p1.3.m3.2.2.2.2.2.3.cmml">2</mn></msub><mo id="A4.p1.3.m3.2.2.2.2.1" xref="A4.p1.3.m3.2.2.2.2.1.cmml">=</mo><mn id="A4.p1.3.m3.2.2.2.2.3" xref="A4.p1.3.m3.2.2.2.2.3.cmml">0.98</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.3.m3.2b"><apply id="A4.p1.3.m3.2.2.3.cmml" xref="A4.p1.3.m3.2.2.2"><csymbol cd="ambiguous" id="A4.p1.3.m3.2.2.3a.cmml" xref="A4.p1.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="A4.p1.3.m3.1.1.1.1.cmml" xref="A4.p1.3.m3.1.1.1.1"><eq id="A4.p1.3.m3.1.1.1.1.1.cmml" xref="A4.p1.3.m3.1.1.1.1.1"></eq><apply id="A4.p1.3.m3.1.1.1.1.2.cmml" xref="A4.p1.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.p1.3.m3.1.1.1.1.2.1.cmml" xref="A4.p1.3.m3.1.1.1.1.2">subscript</csymbol><ci id="A4.p1.3.m3.1.1.1.1.2.2.cmml" xref="A4.p1.3.m3.1.1.1.1.2.2">𝛽</ci><cn id="A4.p1.3.m3.1.1.1.1.2.3.cmml" type="integer" xref="A4.p1.3.m3.1.1.1.1.2.3">1</cn></apply><cn id="A4.p1.3.m3.1.1.1.1.3.cmml" type="float" xref="A4.p1.3.m3.1.1.1.1.3">0.9</cn></apply><apply id="A4.p1.3.m3.2.2.2.2.cmml" xref="A4.p1.3.m3.2.2.2.2"><eq id="A4.p1.3.m3.2.2.2.2.1.cmml" xref="A4.p1.3.m3.2.2.2.2.1"></eq><apply id="A4.p1.3.m3.2.2.2.2.2.cmml" xref="A4.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="A4.p1.3.m3.2.2.2.2.2.1.cmml" xref="A4.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="A4.p1.3.m3.2.2.2.2.2.2.cmml" xref="A4.p1.3.m3.2.2.2.2.2.2">𝛽</ci><cn id="A4.p1.3.m3.2.2.2.2.2.3.cmml" type="integer" xref="A4.p1.3.m3.2.2.2.2.2.3">2</cn></apply><cn id="A4.p1.3.m3.2.2.2.2.3.cmml" type="float" xref="A4.p1.3.m3.2.2.2.2.3">0.98</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.3.m3.2c">\beta_{1}=0.9,\beta_{2}=0.98</annotation><annotation encoding="application/x-llamapun" id="A4.p1.3.m3.2d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9 , italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.98</annotation></semantics></math>.
The learning rate is <math alttext="1.5\times 10^{-4}" class="ltx_Math" display="inline" id="A4.p1.4.m4.1"><semantics id="A4.p1.4.m4.1a"><mrow id="A4.p1.4.m4.1.1" xref="A4.p1.4.m4.1.1.cmml"><mn id="A4.p1.4.m4.1.1.2" xref="A4.p1.4.m4.1.1.2.cmml">1.5</mn><mo id="A4.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.p1.4.m4.1.1.1.cmml">×</mo><msup id="A4.p1.4.m4.1.1.3" xref="A4.p1.4.m4.1.1.3.cmml"><mn id="A4.p1.4.m4.1.1.3.2" xref="A4.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="A4.p1.4.m4.1.1.3.3" xref="A4.p1.4.m4.1.1.3.3.cmml"><mo id="A4.p1.4.m4.1.1.3.3a" xref="A4.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="A4.p1.4.m4.1.1.3.3.2" xref="A4.p1.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.4.m4.1b"><apply id="A4.p1.4.m4.1.1.cmml" xref="A4.p1.4.m4.1.1"><times id="A4.p1.4.m4.1.1.1.cmml" xref="A4.p1.4.m4.1.1.1"></times><cn id="A4.p1.4.m4.1.1.2.cmml" type="float" xref="A4.p1.4.m4.1.1.2">1.5</cn><apply id="A4.p1.4.m4.1.1.3.cmml" xref="A4.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="A4.p1.4.m4.1.1.3.1.cmml" xref="A4.p1.4.m4.1.1.3">superscript</csymbol><cn id="A4.p1.4.m4.1.1.3.2.cmml" type="integer" xref="A4.p1.4.m4.1.1.3.2">10</cn><apply id="A4.p1.4.m4.1.1.3.3.cmml" xref="A4.p1.4.m4.1.1.3.3"><minus id="A4.p1.4.m4.1.1.3.3.1.cmml" xref="A4.p1.4.m4.1.1.3.3"></minus><cn id="A4.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="A4.p1.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.4.m4.1c">1.5\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.4.m4.1d">1.5 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> for 830M to 2.8B sizes, and <math alttext="7.5\times 10^{-5}" class="ltx_Math" display="inline" id="A4.p1.5.m5.1"><semantics id="A4.p1.5.m5.1a"><mrow id="A4.p1.5.m5.1.1" xref="A4.p1.5.m5.1.1.cmml"><mn id="A4.p1.5.m5.1.1.2" xref="A4.p1.5.m5.1.1.2.cmml">7.5</mn><mo id="A4.p1.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.p1.5.m5.1.1.1.cmml">×</mo><msup id="A4.p1.5.m5.1.1.3" xref="A4.p1.5.m5.1.1.3.cmml"><mn id="A4.p1.5.m5.1.1.3.2" xref="A4.p1.5.m5.1.1.3.2.cmml">10</mn><mrow id="A4.p1.5.m5.1.1.3.3" xref="A4.p1.5.m5.1.1.3.3.cmml"><mo id="A4.p1.5.m5.1.1.3.3a" xref="A4.p1.5.m5.1.1.3.3.cmml">−</mo><mn id="A4.p1.5.m5.1.1.3.3.2" xref="A4.p1.5.m5.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.5.m5.1b"><apply id="A4.p1.5.m5.1.1.cmml" xref="A4.p1.5.m5.1.1"><times id="A4.p1.5.m5.1.1.1.cmml" xref="A4.p1.5.m5.1.1.1"></times><cn id="A4.p1.5.m5.1.1.2.cmml" type="float" xref="A4.p1.5.m5.1.1.2">7.5</cn><apply id="A4.p1.5.m5.1.1.3.cmml" xref="A4.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="A4.p1.5.m5.1.1.3.1.cmml" xref="A4.p1.5.m5.1.1.3">superscript</csymbol><cn id="A4.p1.5.m5.1.1.3.2.cmml" type="integer" xref="A4.p1.5.m5.1.1.3.2">10</cn><apply id="A4.p1.5.m5.1.1.3.3.cmml" xref="A4.p1.5.m5.1.1.3.3"><minus id="A4.p1.5.m5.1.1.3.3.1.cmml" xref="A4.p1.5.m5.1.1.3.3"></minus><cn id="A4.p1.5.m5.1.1.3.3.2.cmml" type="integer" xref="A4.p1.5.m5.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.5.m5.1c">7.5\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.5.m5.1d">7.5 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> for 6.8B to 13.1B sizes.
The warmup step is 375 with linear rate decay.
The weight decay is set to 0.05.
We train the models with 40k steps, i.e., 10B tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A4.T10">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A4.T10.1">
<tbody><tr class="ltx_tr" id="A4.T10.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A4.T10.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T10.1.1.1.1">Size</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T10.1.1.2"><span class="ltx_text ltx_font_bold" id="A4.T10.1.1.2.1">Hidden Dim.</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T10.1.1.3"><span class="ltx_text ltx_font_bold" id="A4.T10.1.1.3.1">#Layers</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T10.1.1.4"><span class="ltx_text ltx_font_bold" id="A4.T10.1.1.4.1">#Heads</span></td>
</tr>
<tr class="ltx_tr" id="A4.T10.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A4.T10.1.2.1">830M</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.1.2.2">1536</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.1.2.3">24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T10.1.2.4">8</td>
</tr>
<tr class="ltx_tr" id="A4.T10.1.3">
<td class="ltx_td ltx_align_left" id="A4.T10.1.3.1">1.4B</td>
<td class="ltx_td ltx_align_center" id="A4.T10.1.3.2">2048</td>
<td class="ltx_td ltx_align_center" id="A4.T10.1.3.3">24</td>
<td class="ltx_td ltx_align_center" id="A4.T10.1.3.4">8</td>
</tr>
<tr class="ltx_tr" id="A4.T10.1.4">
<td class="ltx_td ltx_align_left" id="A4.T10.1.4.1">2.8B</td>
<td class="ltx_td ltx_align_center" id="A4.T10.1.4.2">2560</td>
<td class="ltx_td ltx_align_center" id="A4.T10.1.4.3">32</td>
<td class="ltx_td ltx_align_center" id="A4.T10.1.4.4">10</td>
</tr>
<tr class="ltx_tr" id="A4.T10.1.5">
<td class="ltx_td ltx_align_left" id="A4.T10.1.5.1">6.8B</td>
<td class="ltx_td ltx_align_center" id="A4.T10.1.5.2">4096</td>
<td class="ltx_td ltx_align_center" id="A4.T10.1.5.3">32</td>
<td class="ltx_td ltx_align_center" id="A4.T10.1.5.4">16</td>
</tr>
<tr class="ltx_tr" id="A4.T10.1.6">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A4.T10.1.6.1">13.1B</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.1.6.2">5120</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.1.6.3">40</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T10.1.6.4">20</td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>Model size and hyperparameters used for <span class="ltx_text ltx_font_smallcaps" id="A4.T10.3.1">Diff</span> Transformer in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS2" title="3.2 Scalability Compared with Transformer ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.2</span></a>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Robustness of In-Context Learning</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">As described in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS5" title="3.5 In-Context Learning ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.5</span></a>, we evaluate the robustness of in-context learning of Transformer and <span class="ltx_text ltx_font_smallcaps" id="A5.p1.1.1">Diff</span> Transformer with permutations of the same in-context examples.
We evaluate the 3B-size language models that are extended to 64K length (<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS3" title="3.3 Long-Context Evaluation ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.3</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A5.p2">
<p class="ltx_p" id="A5.p2.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A5.F9" title="In Appendix E Robustness of In-Context Learning ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">9</span></a> provides comparisons on four datasets, with in-context examples randomly arranged.
The evaluation protocol is the same as in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S3.SS5" title="3.5 In-Context Learning ‣ 3 Experiments ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.5</span></a>.
The variance in accuracy of <span class="ltx_text ltx_font_smallcaps" id="A5.p2.1.1">Diff</span> Transformer is consistently lower than that of Transformer, indicating greater robustness of <span class="ltx_text ltx_font_smallcaps" id="A5.p2.1.2">Diff</span> Transformer for in-context learning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A5.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="610" id="A5.F9.sf1.g1" src="https://arxiv.org/html/2410.05258v1/x15.png" width="829">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>TREC with 6 classes.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="612" id="A5.F9.sf2.g1" src="https://arxiv.org/html/2410.05258v1/x16.png" width="831">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>TREC-fine with 50 classes.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="610" id="A5.F9.sf3.g1" src="https://arxiv.org/html/2410.05258v1/x17.png" width="829">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Banking-77 with 77 classes.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="610" id="A5.F9.sf4.g1" src="https://arxiv.org/html/2410.05258v1/x18.png" width="831">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Clinic-150 with 150 classes.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Robustness evaluation of in-context learning on four datasets.
Accuracy is evaluated with order permutations of demonstration examples by sweeping random seeds.
The dash lines represent the margin between the best and worst results.
Demonstration examples are randomly arranged in the prompt.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Gradient Flow of <span class="ltx_text ltx_font_smallcaps" id="A6.1.1">Diff</span> Transformer</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.p1">
<p class="ltx_p" id="A6.p1.1">We show that the gradient flow in differential attention is similar to that of conventional <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="A6.p1.1.m1.1"><semantics id="A6.p1.1.m1.1a"><mi id="A6.p1.1.m1.1.1" xref="A6.p1.1.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="A6.p1.1.m1.1b"><ci id="A6.p1.1.m1.1.1.cmml" xref="A6.p1.1.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.1.m1.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="A6.p1.1.m1.1d">roman_softmax</annotation></semantics></math> attention. With this property, the same hyperparameters used in Transformer can be applied directly to the corresponding <span class="ltx_text ltx_font_smallcaps" id="A6.p1.1.1">Diff</span> Transformer without concerns about training instability.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.p2">
<p class="ltx_p" id="A6.p2.3">For differential attention, we select a single head in the proof and expand <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S2.E1" title="In 2.1 Differential Attention ‣ 2 Differential Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Equation</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#S2.E3" title="In Multi-Head Differential Attention ‣ 2.1 Differential Attention ‣ 2 Differential Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Equation</span>&nbsp;<span class="ltx_text ltx_ref_tag">3</span></a> as follows.
We have <math alttext="X\in\mathbb{R}^{N\times d_{\text{model}}}" class="ltx_Math" display="inline" id="A6.p2.1.m1.1"><semantics id="A6.p2.1.m1.1a"><mrow id="A6.p2.1.m1.1.1" xref="A6.p2.1.m1.1.1.cmml"><mi id="A6.p2.1.m1.1.1.2" xref="A6.p2.1.m1.1.1.2.cmml">X</mi><mo id="A6.p2.1.m1.1.1.1" xref="A6.p2.1.m1.1.1.1.cmml">∈</mo><msup id="A6.p2.1.m1.1.1.3" xref="A6.p2.1.m1.1.1.3.cmml"><mi id="A6.p2.1.m1.1.1.3.2" xref="A6.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A6.p2.1.m1.1.1.3.3" xref="A6.p2.1.m1.1.1.3.3.cmml"><mi id="A6.p2.1.m1.1.1.3.3.2" xref="A6.p2.1.m1.1.1.3.3.2.cmml">N</mi><mo id="A6.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p2.1.m1.1.1.3.3.1.cmml">×</mo><msub id="A6.p2.1.m1.1.1.3.3.3" xref="A6.p2.1.m1.1.1.3.3.3.cmml"><mi id="A6.p2.1.m1.1.1.3.3.3.2" xref="A6.p2.1.m1.1.1.3.3.3.2.cmml">d</mi><mtext id="A6.p2.1.m1.1.1.3.3.3.3" xref="A6.p2.1.m1.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A6.p2.1.m1.1b"><apply id="A6.p2.1.m1.1.1.cmml" xref="A6.p2.1.m1.1.1"><in id="A6.p2.1.m1.1.1.1.cmml" xref="A6.p2.1.m1.1.1.1"></in><ci id="A6.p2.1.m1.1.1.2.cmml" xref="A6.p2.1.m1.1.1.2">𝑋</ci><apply id="A6.p2.1.m1.1.1.3.cmml" xref="A6.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A6.p2.1.m1.1.1.3.1.cmml" xref="A6.p2.1.m1.1.1.3">superscript</csymbol><ci id="A6.p2.1.m1.1.1.3.2.cmml" xref="A6.p2.1.m1.1.1.3.2">ℝ</ci><apply id="A6.p2.1.m1.1.1.3.3.cmml" xref="A6.p2.1.m1.1.1.3.3"><times id="A6.p2.1.m1.1.1.3.3.1.cmml" xref="A6.p2.1.m1.1.1.3.3.1"></times><ci id="A6.p2.1.m1.1.1.3.3.2.cmml" xref="A6.p2.1.m1.1.1.3.3.2">𝑁</ci><apply id="A6.p2.1.m1.1.1.3.3.3.cmml" xref="A6.p2.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="A6.p2.1.m1.1.1.3.3.3.1.cmml" xref="A6.p2.1.m1.1.1.3.3.3">subscript</csymbol><ci id="A6.p2.1.m1.1.1.3.3.3.2.cmml" xref="A6.p2.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="A6.p2.1.m1.1.1.3.3.3.3a.cmml" xref="A6.p2.1.m1.1.1.3.3.3.3"><mtext id="A6.p2.1.m1.1.1.3.3.3.3.cmml" mathsize="50%" xref="A6.p2.1.m1.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.1.m1.1c">X\in\mathbb{R}^{N\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A6.p2.1.m1.1d">italic_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as the input, <math alttext="Q_{1},Q_{2},K_{1},K_{2}\in\mathbb{R}^{N\times d},\ V\in\mathbb{R}^{N\times 2d}" class="ltx_Math" display="inline" id="A6.p2.2.m2.2"><semantics id="A6.p2.2.m2.2a"><mrow id="A6.p2.2.m2.2.2.2" xref="A6.p2.2.m2.2.2.3.cmml"><mrow id="A6.p2.2.m2.1.1.1.1" xref="A6.p2.2.m2.1.1.1.1.cmml"><mrow id="A6.p2.2.m2.1.1.1.1.4.4" xref="A6.p2.2.m2.1.1.1.1.4.5.cmml"><msub id="A6.p2.2.m2.1.1.1.1.1.1.1" xref="A6.p2.2.m2.1.1.1.1.1.1.1.cmml"><mi id="A6.p2.2.m2.1.1.1.1.1.1.1.2" xref="A6.p2.2.m2.1.1.1.1.1.1.1.2.cmml">Q</mi><mn id="A6.p2.2.m2.1.1.1.1.1.1.1.3" xref="A6.p2.2.m2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A6.p2.2.m2.1.1.1.1.4.4.5" xref="A6.p2.2.m2.1.1.1.1.4.5.cmml">,</mo><msub id="A6.p2.2.m2.1.1.1.1.2.2.2" xref="A6.p2.2.m2.1.1.1.1.2.2.2.cmml"><mi id="A6.p2.2.m2.1.1.1.1.2.2.2.2" xref="A6.p2.2.m2.1.1.1.1.2.2.2.2.cmml">Q</mi><mn id="A6.p2.2.m2.1.1.1.1.2.2.2.3" xref="A6.p2.2.m2.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="A6.p2.2.m2.1.1.1.1.4.4.6" xref="A6.p2.2.m2.1.1.1.1.4.5.cmml">,</mo><msub id="A6.p2.2.m2.1.1.1.1.3.3.3" xref="A6.p2.2.m2.1.1.1.1.3.3.3.cmml"><mi id="A6.p2.2.m2.1.1.1.1.3.3.3.2" xref="A6.p2.2.m2.1.1.1.1.3.3.3.2.cmml">K</mi><mn id="A6.p2.2.m2.1.1.1.1.3.3.3.3" xref="A6.p2.2.m2.1.1.1.1.3.3.3.3.cmml">1</mn></msub><mo id="A6.p2.2.m2.1.1.1.1.4.4.7" xref="A6.p2.2.m2.1.1.1.1.4.5.cmml">,</mo><msub id="A6.p2.2.m2.1.1.1.1.4.4.4" xref="A6.p2.2.m2.1.1.1.1.4.4.4.cmml"><mi id="A6.p2.2.m2.1.1.1.1.4.4.4.2" xref="A6.p2.2.m2.1.1.1.1.4.4.4.2.cmml">K</mi><mn id="A6.p2.2.m2.1.1.1.1.4.4.4.3" xref="A6.p2.2.m2.1.1.1.1.4.4.4.3.cmml">2</mn></msub></mrow><mo id="A6.p2.2.m2.1.1.1.1.5" xref="A6.p2.2.m2.1.1.1.1.5.cmml">∈</mo><msup id="A6.p2.2.m2.1.1.1.1.6" xref="A6.p2.2.m2.1.1.1.1.6.cmml"><mi id="A6.p2.2.m2.1.1.1.1.6.2" xref="A6.p2.2.m2.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="A6.p2.2.m2.1.1.1.1.6.3" xref="A6.p2.2.m2.1.1.1.1.6.3.cmml"><mi id="A6.p2.2.m2.1.1.1.1.6.3.2" xref="A6.p2.2.m2.1.1.1.1.6.3.2.cmml">N</mi><mo id="A6.p2.2.m2.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p2.2.m2.1.1.1.1.6.3.1.cmml">×</mo><mi id="A6.p2.2.m2.1.1.1.1.6.3.3" xref="A6.p2.2.m2.1.1.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><mo id="A6.p2.2.m2.2.2.2.3" rspace="0.667em" xref="A6.p2.2.m2.2.2.3a.cmml">,</mo><mrow id="A6.p2.2.m2.2.2.2.2" xref="A6.p2.2.m2.2.2.2.2.cmml"><mi id="A6.p2.2.m2.2.2.2.2.2" xref="A6.p2.2.m2.2.2.2.2.2.cmml">V</mi><mo id="A6.p2.2.m2.2.2.2.2.1" xref="A6.p2.2.m2.2.2.2.2.1.cmml">∈</mo><msup id="A6.p2.2.m2.2.2.2.2.3" xref="A6.p2.2.m2.2.2.2.2.3.cmml"><mi id="A6.p2.2.m2.2.2.2.2.3.2" xref="A6.p2.2.m2.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="A6.p2.2.m2.2.2.2.2.3.3" xref="A6.p2.2.m2.2.2.2.2.3.3.cmml"><mrow id="A6.p2.2.m2.2.2.2.2.3.3.2" xref="A6.p2.2.m2.2.2.2.2.3.3.2.cmml"><mi id="A6.p2.2.m2.2.2.2.2.3.3.2.2" xref="A6.p2.2.m2.2.2.2.2.3.3.2.2.cmml">N</mi><mo id="A6.p2.2.m2.2.2.2.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A6.p2.2.m2.2.2.2.2.3.3.2.1.cmml">×</mo><mn id="A6.p2.2.m2.2.2.2.2.3.3.2.3" xref="A6.p2.2.m2.2.2.2.2.3.3.2.3.cmml">2</mn></mrow><mo id="A6.p2.2.m2.2.2.2.2.3.3.1" xref="A6.p2.2.m2.2.2.2.2.3.3.1.cmml">⁢</mo><mi id="A6.p2.2.m2.2.2.2.2.3.3.3" xref="A6.p2.2.m2.2.2.2.2.3.3.3.cmml">d</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p2.2.m2.2b"><apply id="A6.p2.2.m2.2.2.3.cmml" xref="A6.p2.2.m2.2.2.2"><csymbol cd="ambiguous" id="A6.p2.2.m2.2.2.3a.cmml" xref="A6.p2.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="A6.p2.2.m2.1.1.1.1.cmml" xref="A6.p2.2.m2.1.1.1.1"><in id="A6.p2.2.m2.1.1.1.1.5.cmml" xref="A6.p2.2.m2.1.1.1.1.5"></in><list id="A6.p2.2.m2.1.1.1.1.4.5.cmml" xref="A6.p2.2.m2.1.1.1.1.4.4"><apply id="A6.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="A6.p2.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.p2.2.m2.1.1.1.1.1.1.1.1.cmml" xref="A6.p2.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A6.p2.2.m2.1.1.1.1.1.1.1.2.cmml" xref="A6.p2.2.m2.1.1.1.1.1.1.1.2">𝑄</ci><cn id="A6.p2.2.m2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A6.p2.2.m2.1.1.1.1.1.1.1.3">1</cn></apply><apply id="A6.p2.2.m2.1.1.1.1.2.2.2.cmml" xref="A6.p2.2.m2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A6.p2.2.m2.1.1.1.1.2.2.2.1.cmml" xref="A6.p2.2.m2.1.1.1.1.2.2.2">subscript</csymbol><ci id="A6.p2.2.m2.1.1.1.1.2.2.2.2.cmml" xref="A6.p2.2.m2.1.1.1.1.2.2.2.2">𝑄</ci><cn id="A6.p2.2.m2.1.1.1.1.2.2.2.3.cmml" type="integer" xref="A6.p2.2.m2.1.1.1.1.2.2.2.3">2</cn></apply><apply id="A6.p2.2.m2.1.1.1.1.3.3.3.cmml" xref="A6.p2.2.m2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A6.p2.2.m2.1.1.1.1.3.3.3.1.cmml" xref="A6.p2.2.m2.1.1.1.1.3.3.3">subscript</csymbol><ci id="A6.p2.2.m2.1.1.1.1.3.3.3.2.cmml" xref="A6.p2.2.m2.1.1.1.1.3.3.3.2">𝐾</ci><cn id="A6.p2.2.m2.1.1.1.1.3.3.3.3.cmml" type="integer" xref="A6.p2.2.m2.1.1.1.1.3.3.3.3">1</cn></apply><apply id="A6.p2.2.m2.1.1.1.1.4.4.4.cmml" xref="A6.p2.2.m2.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="A6.p2.2.m2.1.1.1.1.4.4.4.1.cmml" xref="A6.p2.2.m2.1.1.1.1.4.4.4">subscript</csymbol><ci id="A6.p2.2.m2.1.1.1.1.4.4.4.2.cmml" xref="A6.p2.2.m2.1.1.1.1.4.4.4.2">𝐾</ci><cn id="A6.p2.2.m2.1.1.1.1.4.4.4.3.cmml" type="integer" xref="A6.p2.2.m2.1.1.1.1.4.4.4.3">2</cn></apply></list><apply id="A6.p2.2.m2.1.1.1.1.6.cmml" xref="A6.p2.2.m2.1.1.1.1.6"><csymbol cd="ambiguous" id="A6.p2.2.m2.1.1.1.1.6.1.cmml" xref="A6.p2.2.m2.1.1.1.1.6">superscript</csymbol><ci id="A6.p2.2.m2.1.1.1.1.6.2.cmml" xref="A6.p2.2.m2.1.1.1.1.6.2">ℝ</ci><apply id="A6.p2.2.m2.1.1.1.1.6.3.cmml" xref="A6.p2.2.m2.1.1.1.1.6.3"><times id="A6.p2.2.m2.1.1.1.1.6.3.1.cmml" xref="A6.p2.2.m2.1.1.1.1.6.3.1"></times><ci id="A6.p2.2.m2.1.1.1.1.6.3.2.cmml" xref="A6.p2.2.m2.1.1.1.1.6.3.2">𝑁</ci><ci id="A6.p2.2.m2.1.1.1.1.6.3.3.cmml" xref="A6.p2.2.m2.1.1.1.1.6.3.3">𝑑</ci></apply></apply></apply><apply id="A6.p2.2.m2.2.2.2.2.cmml" xref="A6.p2.2.m2.2.2.2.2"><in id="A6.p2.2.m2.2.2.2.2.1.cmml" xref="A6.p2.2.m2.2.2.2.2.1"></in><ci id="A6.p2.2.m2.2.2.2.2.2.cmml" xref="A6.p2.2.m2.2.2.2.2.2">𝑉</ci><apply id="A6.p2.2.m2.2.2.2.2.3.cmml" xref="A6.p2.2.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="A6.p2.2.m2.2.2.2.2.3.1.cmml" xref="A6.p2.2.m2.2.2.2.2.3">superscript</csymbol><ci id="A6.p2.2.m2.2.2.2.2.3.2.cmml" xref="A6.p2.2.m2.2.2.2.2.3.2">ℝ</ci><apply id="A6.p2.2.m2.2.2.2.2.3.3.cmml" xref="A6.p2.2.m2.2.2.2.2.3.3"><times id="A6.p2.2.m2.2.2.2.2.3.3.1.cmml" xref="A6.p2.2.m2.2.2.2.2.3.3.1"></times><apply id="A6.p2.2.m2.2.2.2.2.3.3.2.cmml" xref="A6.p2.2.m2.2.2.2.2.3.3.2"><times id="A6.p2.2.m2.2.2.2.2.3.3.2.1.cmml" xref="A6.p2.2.m2.2.2.2.2.3.3.2.1"></times><ci id="A6.p2.2.m2.2.2.2.2.3.3.2.2.cmml" xref="A6.p2.2.m2.2.2.2.2.3.3.2.2">𝑁</ci><cn id="A6.p2.2.m2.2.2.2.2.3.3.2.3.cmml" type="integer" xref="A6.p2.2.m2.2.2.2.2.3.3.2.3">2</cn></apply><ci id="A6.p2.2.m2.2.2.2.2.3.3.3.cmml" xref="A6.p2.2.m2.2.2.2.2.3.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.2.m2.2c">Q_{1},Q_{2},K_{1},K_{2}\in\mathbb{R}^{N\times d},\ V\in\mathbb{R}^{N\times 2d}</annotation><annotation encoding="application/x-llamapun" id="A6.p2.2.m2.2d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT , italic_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × 2 italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="O\in\mathbb{R}^{N\times d_{\text{model}}}" class="ltx_Math" display="inline" id="A6.p2.3.m3.1"><semantics id="A6.p2.3.m3.1a"><mrow id="A6.p2.3.m3.1.1" xref="A6.p2.3.m3.1.1.cmml"><mi id="A6.p2.3.m3.1.1.2" xref="A6.p2.3.m3.1.1.2.cmml">O</mi><mo id="A6.p2.3.m3.1.1.1" xref="A6.p2.3.m3.1.1.1.cmml">∈</mo><msup id="A6.p2.3.m3.1.1.3" xref="A6.p2.3.m3.1.1.3.cmml"><mi id="A6.p2.3.m3.1.1.3.2" xref="A6.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="A6.p2.3.m3.1.1.3.3" xref="A6.p2.3.m3.1.1.3.3.cmml"><mi id="A6.p2.3.m3.1.1.3.3.2" xref="A6.p2.3.m3.1.1.3.3.2.cmml">N</mi><mo id="A6.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p2.3.m3.1.1.3.3.1.cmml">×</mo><msub id="A6.p2.3.m3.1.1.3.3.3" xref="A6.p2.3.m3.1.1.3.3.3.cmml"><mi id="A6.p2.3.m3.1.1.3.3.3.2" xref="A6.p2.3.m3.1.1.3.3.3.2.cmml">d</mi><mtext id="A6.p2.3.m3.1.1.3.3.3.3" xref="A6.p2.3.m3.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A6.p2.3.m3.1b"><apply id="A6.p2.3.m3.1.1.cmml" xref="A6.p2.3.m3.1.1"><in id="A6.p2.3.m3.1.1.1.cmml" xref="A6.p2.3.m3.1.1.1"></in><ci id="A6.p2.3.m3.1.1.2.cmml" xref="A6.p2.3.m3.1.1.2">𝑂</ci><apply id="A6.p2.3.m3.1.1.3.cmml" xref="A6.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="A6.p2.3.m3.1.1.3.1.cmml" xref="A6.p2.3.m3.1.1.3">superscript</csymbol><ci id="A6.p2.3.m3.1.1.3.2.cmml" xref="A6.p2.3.m3.1.1.3.2">ℝ</ci><apply id="A6.p2.3.m3.1.1.3.3.cmml" xref="A6.p2.3.m3.1.1.3.3"><times id="A6.p2.3.m3.1.1.3.3.1.cmml" xref="A6.p2.3.m3.1.1.3.3.1"></times><ci id="A6.p2.3.m3.1.1.3.3.2.cmml" xref="A6.p2.3.m3.1.1.3.3.2">𝑁</ci><apply id="A6.p2.3.m3.1.1.3.3.3.cmml" xref="A6.p2.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="A6.p2.3.m3.1.1.3.3.3.1.cmml" xref="A6.p2.3.m3.1.1.3.3.3">subscript</csymbol><ci id="A6.p2.3.m3.1.1.3.3.3.2.cmml" xref="A6.p2.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="A6.p2.3.m3.1.1.3.3.3.3a.cmml" xref="A6.p2.3.m3.1.1.3.3.3.3"><mtext id="A6.p2.3.m3.1.1.3.3.3.3.cmml" mathsize="50%" xref="A6.p2.3.m3.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.3.m3.1c">O\in\mathbb{R}^{N\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A6.p2.3.m3.1d">italic_O ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as the output:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A6.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{gathered}[Q_{1};Q_{2}]=[XW^{Q_{1}};XW^{Q_{2}}],\quad[K_{1};K_{2}]=[XW^{%
K_{1}};XW^{K_{2}}],\quad V=XW^{V}\\
A_{1}=\mathrm{softmax}(\frac{Q_{1}K^{T}_{1}}{\sqrt{d}}),\quad A2=\mathrm{%
softmax}(\frac{Q_{2}K^{T}_{2}}{\sqrt{d}})\\
O=\operatorname{GroupNorm}((A_{1}-\lambda~{}A_{2})V)W^{O}\end{gathered}" class="ltx_math_unparsed" display="block" id="A6.E6.m1.77"><semantics id="A6.E6.m1.77a"><mtable displaystyle="true" id="A6.E6.m1.77.77.5" rowspacing="0pt"><mtr id="A6.E6.m1.77.77.5a"><mtd id="A6.E6.m1.77.77.5b"><mrow id="A6.E6.m1.74.74.2.74.43.43.43"><mrow id="A6.E6.m1.73.73.1.73.42.42.42.1"><mrow id="A6.E6.m1.73.73.1.73.42.42.42.1.2.2"><mo id="A6.E6.m1.1.1.1.1.1.1" stretchy="false">[</mo><msub id="A6.E6.m1.73.73.1.73.42.42.42.1.1.1.1"><mi id="A6.E6.m1.2.2.2.2.2.2">Q</mi><mn id="A6.E6.m1.3.3.3.3.3.3.1">1</mn></msub><mo id="A6.E6.m1.4.4.4.4.4.4">;</mo><msub id="A6.E6.m1.73.73.1.73.42.42.42.1.2.2.2"><mi id="A6.E6.m1.5.5.5.5.5.5">Q</mi><mn id="A6.E6.m1.6.6.6.6.6.6.1">2</mn></msub><mo id="A6.E6.m1.7.7.7.7.7.7" stretchy="false">]</mo></mrow><mo id="A6.E6.m1.8.8.8.8.8.8">=</mo><mrow id="A6.E6.m1.73.73.1.73.42.42.42.1.4.2"><mo id="A6.E6.m1.9.9.9.9.9.9" stretchy="false">[</mo><mrow id="A6.E6.m1.73.73.1.73.42.42.42.1.3.1.1"><mi id="A6.E6.m1.10.10.10.10.10.10">X</mi><mo id="A6.E6.m1.73.73.1.73.42.42.42.1.3.1.1.1">⁢</mo><msup id="A6.E6.m1.73.73.1.73.42.42.42.1.3.1.1.2"><mi id="A6.E6.m1.11.11.11.11.11.11">W</mi><msub id="A6.E6.m1.12.12.12.12.12.12.1"><mi id="A6.E6.m1.12.12.12.12.12.12.1.2">Q</mi><mn id="A6.E6.m1.12.12.12.12.12.12.1.3">1</mn></msub></msup></mrow><mo id="A6.E6.m1.13.13.13.13.13.13">;</mo><mrow id="A6.E6.m1.73.73.1.73.42.42.42.1.4.2.2"><mi id="A6.E6.m1.14.14.14.14.14.14">X</mi><mo id="A6.E6.m1.73.73.1.73.42.42.42.1.4.2.2.1">⁢</mo><msup id="A6.E6.m1.73.73.1.73.42.42.42.1.4.2.2.2"><mi id="A6.E6.m1.15.15.15.15.15.15">W</mi><msub id="A6.E6.m1.16.16.16.16.16.16.1"><mi id="A6.E6.m1.16.16.16.16.16.16.1.2">Q</mi><mn id="A6.E6.m1.16.16.16.16.16.16.1.3">2</mn></msub></msup></mrow><mo id="A6.E6.m1.17.17.17.17.17.17" stretchy="false">]</mo></mrow></mrow><mo id="A6.E6.m1.18.18.18.18.18.18" rspace="1.167em">,</mo><mrow id="A6.E6.m1.74.74.2.74.43.43.43.2"><mrow id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1"><mrow id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1.2.2"><mo id="A6.E6.m1.19.19.19.19.19.19" stretchy="false">[</mo><msub id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1.1.1.1"><mi id="A6.E6.m1.20.20.20.20.20.20">K</mi><mn id="A6.E6.m1.21.21.21.21.21.21.1">1</mn></msub><mo id="A6.E6.m1.22.22.22.22.22.22">;</mo><msub id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1.2.2.2"><mi id="A6.E6.m1.23.23.23.23.23.23">K</mi><mn id="A6.E6.m1.24.24.24.24.24.24.1">2</mn></msub><mo id="A6.E6.m1.25.25.25.25.25.25" stretchy="false">]</mo></mrow><mo id="A6.E6.m1.26.26.26.26.26.26">=</mo><mrow id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1.4.2"><mo id="A6.E6.m1.27.27.27.27.27.27" stretchy="false">[</mo><mrow id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1.3.1.1"><mi id="A6.E6.m1.28.28.28.28.28.28">X</mi><mo id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1.3.1.1.1">⁢</mo><msup id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1.3.1.1.2"><mi id="A6.E6.m1.29.29.29.29.29.29">W</mi><msub id="A6.E6.m1.30.30.30.30.30.30.1"><mi id="A6.E6.m1.30.30.30.30.30.30.1.2">K</mi><mn id="A6.E6.m1.30.30.30.30.30.30.1.3">1</mn></msub></msup></mrow><mo id="A6.E6.m1.31.31.31.31.31.31">;</mo><mrow id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1.4.2.2"><mi id="A6.E6.m1.32.32.32.32.32.32">X</mi><mo id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1.4.2.2.1">⁢</mo><msup id="A6.E6.m1.74.74.2.74.43.43.43.2.1.1.4.2.2.2"><mi id="A6.E6.m1.33.33.33.33.33.33">W</mi><msub id="A6.E6.m1.34.34.34.34.34.34.1"><mi id="A6.E6.m1.34.34.34.34.34.34.1.2">K</mi><mn id="A6.E6.m1.34.34.34.34.34.34.1.3">2</mn></msub></msup></mrow><mo id="A6.E6.m1.35.35.35.35.35.35" stretchy="false">]</mo></mrow></mrow><mo id="A6.E6.m1.36.36.36.36.36.36" rspace="1.167em">,</mo><mrow id="A6.E6.m1.74.74.2.74.43.43.43.2.2.2"><mi id="A6.E6.m1.37.37.37.37.37.37">V</mi><mo id="A6.E6.m1.38.38.38.38.38.38">=</mo><mrow id="A6.E6.m1.74.74.2.74.43.43.43.2.2.2.1"><mi id="A6.E6.m1.39.39.39.39.39.39">X</mi><mo id="A6.E6.m1.74.74.2.74.43.43.43.2.2.2.1.1">⁢</mo><msup id="A6.E6.m1.74.74.2.74.43.43.43.2.2.2.1.2"><mi id="A6.E6.m1.40.40.40.40.40.40">W</mi><mi id="A6.E6.m1.41.41.41.41.41.41.1">V</mi></msup></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="A6.E6.m1.77.77.5c"><mtd id="A6.E6.m1.77.77.5d"><mrow id="A6.E6.m1.76.76.4.76.17.17.17"><mrow id="A6.E6.m1.75.75.3.75.16.16.16.1"><msub id="A6.E6.m1.75.75.3.75.16.16.16.1.1"><mi id="A6.E6.m1.42.42.42.1.1.1">A</mi><mn id="A6.E6.m1.43.43.43.2.2.2.1">1</mn></msub><mo id="A6.E6.m1.44.44.44.3.3.3">=</mo><mrow id="A6.E6.m1.75.75.3.75.16.16.16.1.2"><mi id="A6.E6.m1.45.45.45.4.4.4">softmax</mi><mo id="A6.E6.m1.75.75.3.75.16.16.16.1.2.1">⁢</mo><mrow id="A6.E6.m1.75.75.3.75.16.16.16.1.2.2"><mo id="A6.E6.m1.46.46.46.5.5.5" stretchy="false">(</mo><mfrac id="A6.E6.m1.47.47.47.6.6.6"><mrow id="A6.E6.m1.47.47.47.6.6.6.2"><msub id="A6.E6.m1.47.47.47.6.6.6.2.2"><mi id="A6.E6.m1.47.47.47.6.6.6.2.2.2">Q</mi><mn id="A6.E6.m1.47.47.47.6.6.6.2.2.3">1</mn></msub><mo id="A6.E6.m1.47.47.47.6.6.6.2.1">⁢</mo><msubsup id="A6.E6.m1.47.47.47.6.6.6.2.3"><mi id="A6.E6.m1.47.47.47.6.6.6.2.3.2.2">K</mi><mn id="A6.E6.m1.47.47.47.6.6.6.2.3.3">1</mn><mi id="A6.E6.m1.47.47.47.6.6.6.2.3.2.3">T</mi></msubsup></mrow><msqrt id="A6.E6.m1.47.47.47.6.6.6.3"><mi id="A6.E6.m1.47.47.47.6.6.6.3.2">d</mi></msqrt></mfrac><mo id="A6.E6.m1.48.48.48.7.7.7" stretchy="false">)</mo></mrow></mrow></mrow><mo id="A6.E6.m1.49.49.49.8.8.8" rspace="1.167em">,</mo><mrow id="A6.E6.m1.76.76.4.76.17.17.17.2"><mrow id="A6.E6.m1.76.76.4.76.17.17.17.2.1"><mi id="A6.E6.m1.50.50.50.9.9.9">A</mi><mo id="A6.E6.m1.76.76.4.76.17.17.17.2.1.1">⁢</mo><mn id="A6.E6.m1.51.51.51.10.10.10">2</mn></mrow><mo id="A6.E6.m1.52.52.52.11.11.11">=</mo><mrow id="A6.E6.m1.76.76.4.76.17.17.17.2.2"><mi id="A6.E6.m1.53.53.53.12.12.12">softmax</mi><mo id="A6.E6.m1.76.76.4.76.17.17.17.2.2.1">⁢</mo><mrow id="A6.E6.m1.76.76.4.76.17.17.17.2.2.2"><mo id="A6.E6.m1.54.54.54.13.13.13" stretchy="false">(</mo><mfrac id="A6.E6.m1.55.55.55.14.14.14"><mrow id="A6.E6.m1.55.55.55.14.14.14.2"><msub id="A6.E6.m1.55.55.55.14.14.14.2.2"><mi id="A6.E6.m1.55.55.55.14.14.14.2.2.2">Q</mi><mn id="A6.E6.m1.55.55.55.14.14.14.2.2.3">2</mn></msub><mo id="A6.E6.m1.55.55.55.14.14.14.2.1">⁢</mo><msubsup id="A6.E6.m1.55.55.55.14.14.14.2.3"><mi id="A6.E6.m1.55.55.55.14.14.14.2.3.2.2">K</mi><mn id="A6.E6.m1.55.55.55.14.14.14.2.3.3">2</mn><mi id="A6.E6.m1.55.55.55.14.14.14.2.3.2.3">T</mi></msubsup></mrow><msqrt id="A6.E6.m1.55.55.55.14.14.14.3"><mi id="A6.E6.m1.55.55.55.14.14.14.3.2">d</mi></msqrt></mfrac><mo id="A6.E6.m1.56.56.56.15.15.15" stretchy="false">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="A6.E6.m1.77.77.5e"><mtd id="A6.E6.m1.77.77.5f"><mrow id="A6.E6.m1.77.77.5.77.17.17"><mi id="A6.E6.m1.57.57.57.1.1.1">O</mi><mo id="A6.E6.m1.58.58.58.2.2.2">=</mo><mrow id="A6.E6.m1.77.77.5.77.17.17.17"><mrow id="A6.E6.m1.77.77.5.77.17.17.17.1.1"><mi id="A6.E6.m1.59.59.59.3.3.3">GroupNorm</mi><mo id="A6.E6.m1.77.77.5.77.17.17.17.1.1a">⁡</mo><mrow id="A6.E6.m1.77.77.5.77.17.17.17.1.1.1"><mo id="A6.E6.m1.60.60.60.4.4.4" stretchy="false">(</mo><mrow id="A6.E6.m1.77.77.5.77.17.17.17.1.1.1.1"><mrow id="A6.E6.m1.77.77.5.77.17.17.17.1.1.1.1.1.1"><mo id="A6.E6.m1.61.61.61.5.5.5" stretchy="false">(</mo><mrow id="A6.E6.m1.77.77.5.77.17.17.17.1.1.1.1.1.1.1"><msub id="A6.E6.m1.77.77.5.77.17.17.17.1.1.1.1.1.1.1.1"><mi id="A6.E6.m1.62.62.62.6.6.6">A</mi><mn id="A6.E6.m1.63.63.63.7.7.7.1">1</mn></msub><mo id="A6.E6.m1.64.64.64.8.8.8">−</mo><mrow id="A6.E6.m1.77.77.5.77.17.17.17.1.1.1.1.1.1.1.2"><mi id="A6.E6.m1.65.65.65.9.9.9">λ</mi><mo id="A6.E6.m1.77.77.5.77.17.17.17.1.1.1.1.1.1.1.2.1" lspace="0.330em">⁢</mo><msub id="A6.E6.m1.77.77.5.77.17.17.17.1.1.1.1.1.1.1.2.2"><mi id="A6.E6.m1.66.66.66.10.10.10">A</mi><mn id="A6.E6.m1.67.67.67.11.11.11.1">2</mn></msub></mrow></mrow><mo id="A6.E6.m1.68.68.68.12.12.12" stretchy="false">)</mo></mrow><mo id="A6.E6.m1.77.77.5.77.17.17.17.1.1.1.1.2">⁢</mo><mi id="A6.E6.m1.69.69.69.13.13.13">V</mi></mrow><mo id="A6.E6.m1.70.70.70.14.14.14" stretchy="false">)</mo></mrow></mrow><mo id="A6.E6.m1.77.77.5.77.17.17.17.2">⁢</mo><msup id="A6.E6.m1.77.77.5.77.17.17.17.3"><mi id="A6.E6.m1.71.71.71.15.15.15">W</mi><mi id="A6.E6.m1.72.72.72.16.16.16.1">O</mi></msup></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="A6.E6.m1.77b">\begin{gathered}[Q_{1};Q_{2}]=[XW^{Q_{1}};XW^{Q_{2}}],\quad[K_{1};K_{2}]=[XW^{%
K_{1}};XW^{K_{2}}],\quad V=XW^{V}\\
A_{1}=\mathrm{softmax}(\frac{Q_{1}K^{T}_{1}}{\sqrt{d}}),\quad A2=\mathrm{%
softmax}(\frac{Q_{2}K^{T}_{2}}{\sqrt{d}})\\
O=\operatorname{GroupNorm}((A_{1}-\lambda~{}A_{2})V)W^{O}\end{gathered}</annotation><annotation encoding="application/x-llamapun" id="A6.E6.m1.77c">start_ROW start_CELL [ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] = [ italic_X italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ; italic_X italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ] , [ italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] = [ italic_X italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ; italic_X italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ] , italic_V = italic_X italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = roman_softmax ( divide start_ARG italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) , italic_A 2 = roman_softmax ( divide start_ARG italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) end_CELL end_ROW start_ROW start_CELL italic_O = roman_GroupNorm ( ( italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - italic_λ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) italic_V ) italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A6.p2.12">where <math alttext="W^{Q_{1}},\ W^{Q_{2}},\ W^{K_{1}},\ W^{K_{2}}\in\mathbb{R}^{d_{\text{model}}%
\times d},\ W^{V}\in\mathbb{R}^{d_{\text{model}}\times 2d},\ W^{O}\in\mathbb{R%
}^{2d\times d_{\text{model}}}" class="ltx_Math" display="inline" id="A6.p2.4.m1.2"><semantics id="A6.p2.4.m1.2a"><mrow id="A6.p2.4.m1.2.2.2" xref="A6.p2.4.m1.2.2.3.cmml"><mrow id="A6.p2.4.m1.1.1.1.1" xref="A6.p2.4.m1.1.1.1.1.cmml"><mrow id="A6.p2.4.m1.1.1.1.1.4.4" xref="A6.p2.4.m1.1.1.1.1.4.5.cmml"><msup id="A6.p2.4.m1.1.1.1.1.1.1.1" xref="A6.p2.4.m1.1.1.1.1.1.1.1.cmml"><mi id="A6.p2.4.m1.1.1.1.1.1.1.1.2" xref="A6.p2.4.m1.1.1.1.1.1.1.1.2.cmml">W</mi><msub id="A6.p2.4.m1.1.1.1.1.1.1.1.3" xref="A6.p2.4.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A6.p2.4.m1.1.1.1.1.1.1.1.3.2" xref="A6.p2.4.m1.1.1.1.1.1.1.1.3.2.cmml">Q</mi><mn id="A6.p2.4.m1.1.1.1.1.1.1.1.3.3" xref="A6.p2.4.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></msup><mo id="A6.p2.4.m1.1.1.1.1.4.4.5" rspace="0.667em" xref="A6.p2.4.m1.1.1.1.1.4.5.cmml">,</mo><msup id="A6.p2.4.m1.1.1.1.1.2.2.2" xref="A6.p2.4.m1.1.1.1.1.2.2.2.cmml"><mi id="A6.p2.4.m1.1.1.1.1.2.2.2.2" xref="A6.p2.4.m1.1.1.1.1.2.2.2.2.cmml">W</mi><msub id="A6.p2.4.m1.1.1.1.1.2.2.2.3" xref="A6.p2.4.m1.1.1.1.1.2.2.2.3.cmml"><mi id="A6.p2.4.m1.1.1.1.1.2.2.2.3.2" xref="A6.p2.4.m1.1.1.1.1.2.2.2.3.2.cmml">Q</mi><mn id="A6.p2.4.m1.1.1.1.1.2.2.2.3.3" xref="A6.p2.4.m1.1.1.1.1.2.2.2.3.3.cmml">2</mn></msub></msup><mo id="A6.p2.4.m1.1.1.1.1.4.4.6" rspace="0.667em" xref="A6.p2.4.m1.1.1.1.1.4.5.cmml">,</mo><msup id="A6.p2.4.m1.1.1.1.1.3.3.3" xref="A6.p2.4.m1.1.1.1.1.3.3.3.cmml"><mi id="A6.p2.4.m1.1.1.1.1.3.3.3.2" xref="A6.p2.4.m1.1.1.1.1.3.3.3.2.cmml">W</mi><msub id="A6.p2.4.m1.1.1.1.1.3.3.3.3" xref="A6.p2.4.m1.1.1.1.1.3.3.3.3.cmml"><mi id="A6.p2.4.m1.1.1.1.1.3.3.3.3.2" xref="A6.p2.4.m1.1.1.1.1.3.3.3.3.2.cmml">K</mi><mn id="A6.p2.4.m1.1.1.1.1.3.3.3.3.3" xref="A6.p2.4.m1.1.1.1.1.3.3.3.3.3.cmml">1</mn></msub></msup><mo id="A6.p2.4.m1.1.1.1.1.4.4.7" rspace="0.667em" xref="A6.p2.4.m1.1.1.1.1.4.5.cmml">,</mo><msup id="A6.p2.4.m1.1.1.1.1.4.4.4" xref="A6.p2.4.m1.1.1.1.1.4.4.4.cmml"><mi id="A6.p2.4.m1.1.1.1.1.4.4.4.2" xref="A6.p2.4.m1.1.1.1.1.4.4.4.2.cmml">W</mi><msub id="A6.p2.4.m1.1.1.1.1.4.4.4.3" xref="A6.p2.4.m1.1.1.1.1.4.4.4.3.cmml"><mi id="A6.p2.4.m1.1.1.1.1.4.4.4.3.2" xref="A6.p2.4.m1.1.1.1.1.4.4.4.3.2.cmml">K</mi><mn id="A6.p2.4.m1.1.1.1.1.4.4.4.3.3" xref="A6.p2.4.m1.1.1.1.1.4.4.4.3.3.cmml">2</mn></msub></msup></mrow><mo id="A6.p2.4.m1.1.1.1.1.5" xref="A6.p2.4.m1.1.1.1.1.5.cmml">∈</mo><msup id="A6.p2.4.m1.1.1.1.1.6" xref="A6.p2.4.m1.1.1.1.1.6.cmml"><mi id="A6.p2.4.m1.1.1.1.1.6.2" xref="A6.p2.4.m1.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="A6.p2.4.m1.1.1.1.1.6.3" xref="A6.p2.4.m1.1.1.1.1.6.3.cmml"><msub id="A6.p2.4.m1.1.1.1.1.6.3.2" xref="A6.p2.4.m1.1.1.1.1.6.3.2.cmml"><mi id="A6.p2.4.m1.1.1.1.1.6.3.2.2" xref="A6.p2.4.m1.1.1.1.1.6.3.2.2.cmml">d</mi><mtext id="A6.p2.4.m1.1.1.1.1.6.3.2.3" xref="A6.p2.4.m1.1.1.1.1.6.3.2.3a.cmml">model</mtext></msub><mo id="A6.p2.4.m1.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p2.4.m1.1.1.1.1.6.3.1.cmml">×</mo><mi id="A6.p2.4.m1.1.1.1.1.6.3.3" xref="A6.p2.4.m1.1.1.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><mo id="A6.p2.4.m1.2.2.2.3" rspace="0.667em" xref="A6.p2.4.m1.2.2.3a.cmml">,</mo><mrow id="A6.p2.4.m1.2.2.2.2.2" xref="A6.p2.4.m1.2.2.2.2.3.cmml"><mrow id="A6.p2.4.m1.2.2.2.2.1.1" xref="A6.p2.4.m1.2.2.2.2.1.1.cmml"><msup id="A6.p2.4.m1.2.2.2.2.1.1.2" xref="A6.p2.4.m1.2.2.2.2.1.1.2.cmml"><mi id="A6.p2.4.m1.2.2.2.2.1.1.2.2" xref="A6.p2.4.m1.2.2.2.2.1.1.2.2.cmml">W</mi><mi id="A6.p2.4.m1.2.2.2.2.1.1.2.3" xref="A6.p2.4.m1.2.2.2.2.1.1.2.3.cmml">V</mi></msup><mo id="A6.p2.4.m1.2.2.2.2.1.1.1" xref="A6.p2.4.m1.2.2.2.2.1.1.1.cmml">∈</mo><msup id="A6.p2.4.m1.2.2.2.2.1.1.3" xref="A6.p2.4.m1.2.2.2.2.1.1.3.cmml"><mi id="A6.p2.4.m1.2.2.2.2.1.1.3.2" xref="A6.p2.4.m1.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="A6.p2.4.m1.2.2.2.2.1.1.3.3" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.cmml"><mrow id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.cmml"><msub id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.cmml"><mi id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.2" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.2.cmml">d</mi><mtext id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.3" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.3a.cmml">model</mtext></msub><mo id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.1.cmml">×</mo><mn id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.3" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.3.cmml">2</mn></mrow><mo id="A6.p2.4.m1.2.2.2.2.1.1.3.3.1" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="A6.p2.4.m1.2.2.2.2.1.1.3.3.3" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><mo id="A6.p2.4.m1.2.2.2.2.2.3" rspace="0.667em" xref="A6.p2.4.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A6.p2.4.m1.2.2.2.2.2.2" xref="A6.p2.4.m1.2.2.2.2.2.2.cmml"><msup id="A6.p2.4.m1.2.2.2.2.2.2.2" xref="A6.p2.4.m1.2.2.2.2.2.2.2.cmml"><mi id="A6.p2.4.m1.2.2.2.2.2.2.2.2" xref="A6.p2.4.m1.2.2.2.2.2.2.2.2.cmml">W</mi><mi id="A6.p2.4.m1.2.2.2.2.2.2.2.3" xref="A6.p2.4.m1.2.2.2.2.2.2.2.3.cmml">O</mi></msup><mo id="A6.p2.4.m1.2.2.2.2.2.2.1" xref="A6.p2.4.m1.2.2.2.2.2.2.1.cmml">∈</mo><msup id="A6.p2.4.m1.2.2.2.2.2.2.3" xref="A6.p2.4.m1.2.2.2.2.2.2.3.cmml"><mi id="A6.p2.4.m1.2.2.2.2.2.2.3.2" xref="A6.p2.4.m1.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="A6.p2.4.m1.2.2.2.2.2.2.3.3" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.cmml"><mrow id="A6.p2.4.m1.2.2.2.2.2.2.3.3.2" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.cmml"><mn id="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.2" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.2.cmml">2</mn><mo id="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.1" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.1.cmml">⁢</mo><mi id="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.3" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.3.cmml">d</mi></mrow><mo id="A6.p2.4.m1.2.2.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.1.cmml">×</mo><msub id="A6.p2.4.m1.2.2.2.2.2.2.3.3.3" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.cmml"><mi id="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.2" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.2.cmml">d</mi><mtext id="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.3" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p2.4.m1.2b"><apply id="A6.p2.4.m1.2.2.3.cmml" xref="A6.p2.4.m1.2.2.2"><csymbol cd="ambiguous" id="A6.p2.4.m1.2.2.3a.cmml" xref="A6.p2.4.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A6.p2.4.m1.1.1.1.1.cmml" xref="A6.p2.4.m1.1.1.1.1"><in id="A6.p2.4.m1.1.1.1.1.5.cmml" xref="A6.p2.4.m1.1.1.1.1.5"></in><list id="A6.p2.4.m1.1.1.1.1.4.5.cmml" xref="A6.p2.4.m1.1.1.1.1.4.4"><apply id="A6.p2.4.m1.1.1.1.1.1.1.1.cmml" xref="A6.p2.4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.p2.4.m1.1.1.1.1.1.1.1.1.cmml" xref="A6.p2.4.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.p2.4.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.p2.4.m1.1.1.1.1.1.1.1.2">𝑊</ci><apply id="A6.p2.4.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.p2.4.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.p2.4.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.p2.4.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.p2.4.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.p2.4.m1.1.1.1.1.1.1.1.3.2">𝑄</ci><cn id="A6.p2.4.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A6.p2.4.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="A6.p2.4.m1.1.1.1.1.2.2.2.cmml" xref="A6.p2.4.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A6.p2.4.m1.1.1.1.1.2.2.2.1.cmml" xref="A6.p2.4.m1.1.1.1.1.2.2.2">superscript</csymbol><ci id="A6.p2.4.m1.1.1.1.1.2.2.2.2.cmml" xref="A6.p2.4.m1.1.1.1.1.2.2.2.2">𝑊</ci><apply id="A6.p2.4.m1.1.1.1.1.2.2.2.3.cmml" xref="A6.p2.4.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="A6.p2.4.m1.1.1.1.1.2.2.2.3.1.cmml" xref="A6.p2.4.m1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="A6.p2.4.m1.1.1.1.1.2.2.2.3.2.cmml" xref="A6.p2.4.m1.1.1.1.1.2.2.2.3.2">𝑄</ci><cn id="A6.p2.4.m1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="A6.p2.4.m1.1.1.1.1.2.2.2.3.3">2</cn></apply></apply><apply id="A6.p2.4.m1.1.1.1.1.3.3.3.cmml" xref="A6.p2.4.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A6.p2.4.m1.1.1.1.1.3.3.3.1.cmml" xref="A6.p2.4.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="A6.p2.4.m1.1.1.1.1.3.3.3.2.cmml" xref="A6.p2.4.m1.1.1.1.1.3.3.3.2">𝑊</ci><apply id="A6.p2.4.m1.1.1.1.1.3.3.3.3.cmml" xref="A6.p2.4.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="A6.p2.4.m1.1.1.1.1.3.3.3.3.1.cmml" xref="A6.p2.4.m1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="A6.p2.4.m1.1.1.1.1.3.3.3.3.2.cmml" xref="A6.p2.4.m1.1.1.1.1.3.3.3.3.2">𝐾</ci><cn id="A6.p2.4.m1.1.1.1.1.3.3.3.3.3.cmml" type="integer" xref="A6.p2.4.m1.1.1.1.1.3.3.3.3.3">1</cn></apply></apply><apply id="A6.p2.4.m1.1.1.1.1.4.4.4.cmml" xref="A6.p2.4.m1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="A6.p2.4.m1.1.1.1.1.4.4.4.1.cmml" xref="A6.p2.4.m1.1.1.1.1.4.4.4">superscript</csymbol><ci id="A6.p2.4.m1.1.1.1.1.4.4.4.2.cmml" xref="A6.p2.4.m1.1.1.1.1.4.4.4.2">𝑊</ci><apply id="A6.p2.4.m1.1.1.1.1.4.4.4.3.cmml" xref="A6.p2.4.m1.1.1.1.1.4.4.4.3"><csymbol cd="ambiguous" id="A6.p2.4.m1.1.1.1.1.4.4.4.3.1.cmml" xref="A6.p2.4.m1.1.1.1.1.4.4.4.3">subscript</csymbol><ci id="A6.p2.4.m1.1.1.1.1.4.4.4.3.2.cmml" xref="A6.p2.4.m1.1.1.1.1.4.4.4.3.2">𝐾</ci><cn id="A6.p2.4.m1.1.1.1.1.4.4.4.3.3.cmml" type="integer" xref="A6.p2.4.m1.1.1.1.1.4.4.4.3.3">2</cn></apply></apply></list><apply id="A6.p2.4.m1.1.1.1.1.6.cmml" xref="A6.p2.4.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="A6.p2.4.m1.1.1.1.1.6.1.cmml" xref="A6.p2.4.m1.1.1.1.1.6">superscript</csymbol><ci id="A6.p2.4.m1.1.1.1.1.6.2.cmml" xref="A6.p2.4.m1.1.1.1.1.6.2">ℝ</ci><apply id="A6.p2.4.m1.1.1.1.1.6.3.cmml" xref="A6.p2.4.m1.1.1.1.1.6.3"><times id="A6.p2.4.m1.1.1.1.1.6.3.1.cmml" xref="A6.p2.4.m1.1.1.1.1.6.3.1"></times><apply id="A6.p2.4.m1.1.1.1.1.6.3.2.cmml" xref="A6.p2.4.m1.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="A6.p2.4.m1.1.1.1.1.6.3.2.1.cmml" xref="A6.p2.4.m1.1.1.1.1.6.3.2">subscript</csymbol><ci id="A6.p2.4.m1.1.1.1.1.6.3.2.2.cmml" xref="A6.p2.4.m1.1.1.1.1.6.3.2.2">𝑑</ci><ci id="A6.p2.4.m1.1.1.1.1.6.3.2.3a.cmml" xref="A6.p2.4.m1.1.1.1.1.6.3.2.3"><mtext id="A6.p2.4.m1.1.1.1.1.6.3.2.3.cmml" mathsize="50%" xref="A6.p2.4.m1.1.1.1.1.6.3.2.3">model</mtext></ci></apply><ci id="A6.p2.4.m1.1.1.1.1.6.3.3.cmml" xref="A6.p2.4.m1.1.1.1.1.6.3.3">𝑑</ci></apply></apply></apply><apply id="A6.p2.4.m1.2.2.2.2.3.cmml" xref="A6.p2.4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A6.p2.4.m1.2.2.2.2.3a.cmml" xref="A6.p2.4.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A6.p2.4.m1.2.2.2.2.1.1.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1"><in id="A6.p2.4.m1.2.2.2.2.1.1.1.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.1"></in><apply id="A6.p2.4.m1.2.2.2.2.1.1.2.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A6.p2.4.m1.2.2.2.2.1.1.2.1.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.2">superscript</csymbol><ci id="A6.p2.4.m1.2.2.2.2.1.1.2.2.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.2.2">𝑊</ci><ci id="A6.p2.4.m1.2.2.2.2.1.1.2.3.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.2.3">𝑉</ci></apply><apply id="A6.p2.4.m1.2.2.2.2.1.1.3.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A6.p2.4.m1.2.2.2.2.1.1.3.1.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3">superscript</csymbol><ci id="A6.p2.4.m1.2.2.2.2.1.1.3.2.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3.2">ℝ</ci><apply id="A6.p2.4.m1.2.2.2.2.1.1.3.3.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3"><times id="A6.p2.4.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.1"></times><apply id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2"><times id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.1.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.1"></times><apply id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.1.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2">subscript</csymbol><ci id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.2.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.2">𝑑</ci><ci id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.3a.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.3"><mtext id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.3.cmml" mathsize="50%" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.2.3">model</mtext></ci></apply><cn id="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.3.cmml" type="integer" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.2.3">2</cn></apply><ci id="A6.p2.4.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A6.p2.4.m1.2.2.2.2.1.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="A6.p2.4.m1.2.2.2.2.2.2.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2"><in id="A6.p2.4.m1.2.2.2.2.2.2.1.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.1"></in><apply id="A6.p2.4.m1.2.2.2.2.2.2.2.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A6.p2.4.m1.2.2.2.2.2.2.2.1.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="A6.p2.4.m1.2.2.2.2.2.2.2.2.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.2.2">𝑊</ci><ci id="A6.p2.4.m1.2.2.2.2.2.2.2.3.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.2.3">𝑂</ci></apply><apply id="A6.p2.4.m1.2.2.2.2.2.2.3.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A6.p2.4.m1.2.2.2.2.2.2.3.1.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3">superscript</csymbol><ci id="A6.p2.4.m1.2.2.2.2.2.2.3.2.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3.2">ℝ</ci><apply id="A6.p2.4.m1.2.2.2.2.2.2.3.3.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3"><times id="A6.p2.4.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.1"></times><apply id="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.2"><times id="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.1.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.1"></times><cn id="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.2.cmml" type="integer" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.2">2</cn><ci id="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.3.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.2.3">𝑑</ci></apply><apply id="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.1.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.2.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.2">𝑑</ci><ci id="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.3a.cmml" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.3"><mtext id="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.3.cmml" mathsize="50%" xref="A6.p2.4.m1.2.2.2.2.2.2.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.4.m1.2c">W^{Q_{1}},\ W^{Q_{2}},\ W^{K_{1}},\ W^{K_{2}}\in\mathbb{R}^{d_{\text{model}}%
\times d},\ W^{V}\in\mathbb{R}^{d_{\text{model}}\times 2d},\ W^{O}\in\mathbb{R%
}^{2d\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A6.p2.4.m1.2d">italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × 2 italic_d end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 2 italic_d × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are parameters, <math alttext="\lambda" class="ltx_Math" display="inline" id="A6.p2.5.m2.1"><semantics id="A6.p2.5.m2.1a"><mi id="A6.p2.5.m2.1.1" xref="A6.p2.5.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A6.p2.5.m2.1b"><ci id="A6.p2.5.m2.1.1.cmml" xref="A6.p2.5.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.5.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A6.p2.5.m2.1d">italic_λ</annotation></semantics></math> is a learnable scalar, and GroupNorm has a fixed multiplier as scale: <math alttext="\gamma=1-\lambda_{\text{init}}" class="ltx_Math" display="inline" id="A6.p2.6.m3.1"><semantics id="A6.p2.6.m3.1a"><mrow id="A6.p2.6.m3.1.1" xref="A6.p2.6.m3.1.1.cmml"><mi id="A6.p2.6.m3.1.1.2" xref="A6.p2.6.m3.1.1.2.cmml">γ</mi><mo id="A6.p2.6.m3.1.1.1" xref="A6.p2.6.m3.1.1.1.cmml">=</mo><mrow id="A6.p2.6.m3.1.1.3" xref="A6.p2.6.m3.1.1.3.cmml"><mn id="A6.p2.6.m3.1.1.3.2" xref="A6.p2.6.m3.1.1.3.2.cmml">1</mn><mo id="A6.p2.6.m3.1.1.3.1" xref="A6.p2.6.m3.1.1.3.1.cmml">−</mo><msub id="A6.p2.6.m3.1.1.3.3" xref="A6.p2.6.m3.1.1.3.3.cmml"><mi id="A6.p2.6.m3.1.1.3.3.2" xref="A6.p2.6.m3.1.1.3.3.2.cmml">λ</mi><mtext id="A6.p2.6.m3.1.1.3.3.3" xref="A6.p2.6.m3.1.1.3.3.3a.cmml">init</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p2.6.m3.1b"><apply id="A6.p2.6.m3.1.1.cmml" xref="A6.p2.6.m3.1.1"><eq id="A6.p2.6.m3.1.1.1.cmml" xref="A6.p2.6.m3.1.1.1"></eq><ci id="A6.p2.6.m3.1.1.2.cmml" xref="A6.p2.6.m3.1.1.2">𝛾</ci><apply id="A6.p2.6.m3.1.1.3.cmml" xref="A6.p2.6.m3.1.1.3"><minus id="A6.p2.6.m3.1.1.3.1.cmml" xref="A6.p2.6.m3.1.1.3.1"></minus><cn id="A6.p2.6.m3.1.1.3.2.cmml" type="integer" xref="A6.p2.6.m3.1.1.3.2">1</cn><apply id="A6.p2.6.m3.1.1.3.3.cmml" xref="A6.p2.6.m3.1.1.3.3"><csymbol cd="ambiguous" id="A6.p2.6.m3.1.1.3.3.1.cmml" xref="A6.p2.6.m3.1.1.3.3">subscript</csymbol><ci id="A6.p2.6.m3.1.1.3.3.2.cmml" xref="A6.p2.6.m3.1.1.3.3.2">𝜆</ci><ci id="A6.p2.6.m3.1.1.3.3.3a.cmml" xref="A6.p2.6.m3.1.1.3.3.3"><mtext id="A6.p2.6.m3.1.1.3.3.3.cmml" mathsize="70%" xref="A6.p2.6.m3.1.1.3.3.3">init</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.6.m3.1c">\gamma=1-\lambda_{\text{init}}</annotation><annotation encoding="application/x-llamapun" id="A6.p2.6.m3.1d">italic_γ = 1 - italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math>. For a token <math alttext="x" class="ltx_Math" display="inline" id="A6.p2.7.m4.1"><semantics id="A6.p2.7.m4.1a"><mi id="A6.p2.7.m4.1.1" xref="A6.p2.7.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A6.p2.7.m4.1b"><ci id="A6.p2.7.m4.1.1.cmml" xref="A6.p2.7.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.7.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="A6.p2.7.m4.1d">italic_x</annotation></semantics></math> in <math alttext="(A_{1}-\lambda~{}A_{2})V" class="ltx_Math" display="inline" id="A6.p2.8.m5.1"><semantics id="A6.p2.8.m5.1a"><mrow id="A6.p2.8.m5.1.1" xref="A6.p2.8.m5.1.1.cmml"><mrow id="A6.p2.8.m5.1.1.1.1" xref="A6.p2.8.m5.1.1.1.1.1.cmml"><mo id="A6.p2.8.m5.1.1.1.1.2" stretchy="false" xref="A6.p2.8.m5.1.1.1.1.1.cmml">(</mo><mrow id="A6.p2.8.m5.1.1.1.1.1" xref="A6.p2.8.m5.1.1.1.1.1.cmml"><msub id="A6.p2.8.m5.1.1.1.1.1.2" xref="A6.p2.8.m5.1.1.1.1.1.2.cmml"><mi id="A6.p2.8.m5.1.1.1.1.1.2.2" xref="A6.p2.8.m5.1.1.1.1.1.2.2.cmml">A</mi><mn id="A6.p2.8.m5.1.1.1.1.1.2.3" xref="A6.p2.8.m5.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A6.p2.8.m5.1.1.1.1.1.1" xref="A6.p2.8.m5.1.1.1.1.1.1.cmml">−</mo><mrow id="A6.p2.8.m5.1.1.1.1.1.3" xref="A6.p2.8.m5.1.1.1.1.1.3.cmml"><mi id="A6.p2.8.m5.1.1.1.1.1.3.2" xref="A6.p2.8.m5.1.1.1.1.1.3.2.cmml">λ</mi><mo id="A6.p2.8.m5.1.1.1.1.1.3.1" lspace="0.330em" xref="A6.p2.8.m5.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A6.p2.8.m5.1.1.1.1.1.3.3" xref="A6.p2.8.m5.1.1.1.1.1.3.3.cmml"><mi id="A6.p2.8.m5.1.1.1.1.1.3.3.2" xref="A6.p2.8.m5.1.1.1.1.1.3.3.2.cmml">A</mi><mn id="A6.p2.8.m5.1.1.1.1.1.3.3.3" xref="A6.p2.8.m5.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="A6.p2.8.m5.1.1.1.1.3" stretchy="false" xref="A6.p2.8.m5.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.p2.8.m5.1.1.2" xref="A6.p2.8.m5.1.1.2.cmml">⁢</mo><mi id="A6.p2.8.m5.1.1.3" xref="A6.p2.8.m5.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="A6.p2.8.m5.1b"><apply id="A6.p2.8.m5.1.1.cmml" xref="A6.p2.8.m5.1.1"><times id="A6.p2.8.m5.1.1.2.cmml" xref="A6.p2.8.m5.1.1.2"></times><apply id="A6.p2.8.m5.1.1.1.1.1.cmml" xref="A6.p2.8.m5.1.1.1.1"><minus id="A6.p2.8.m5.1.1.1.1.1.1.cmml" xref="A6.p2.8.m5.1.1.1.1.1.1"></minus><apply id="A6.p2.8.m5.1.1.1.1.1.2.cmml" xref="A6.p2.8.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.p2.8.m5.1.1.1.1.1.2.1.cmml" xref="A6.p2.8.m5.1.1.1.1.1.2">subscript</csymbol><ci id="A6.p2.8.m5.1.1.1.1.1.2.2.cmml" xref="A6.p2.8.m5.1.1.1.1.1.2.2">𝐴</ci><cn id="A6.p2.8.m5.1.1.1.1.1.2.3.cmml" type="integer" xref="A6.p2.8.m5.1.1.1.1.1.2.3">1</cn></apply><apply id="A6.p2.8.m5.1.1.1.1.1.3.cmml" xref="A6.p2.8.m5.1.1.1.1.1.3"><times id="A6.p2.8.m5.1.1.1.1.1.3.1.cmml" xref="A6.p2.8.m5.1.1.1.1.1.3.1"></times><ci id="A6.p2.8.m5.1.1.1.1.1.3.2.cmml" xref="A6.p2.8.m5.1.1.1.1.1.3.2">𝜆</ci><apply id="A6.p2.8.m5.1.1.1.1.1.3.3.cmml" xref="A6.p2.8.m5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A6.p2.8.m5.1.1.1.1.1.3.3.1.cmml" xref="A6.p2.8.m5.1.1.1.1.1.3.3">subscript</csymbol><ci id="A6.p2.8.m5.1.1.1.1.1.3.3.2.cmml" xref="A6.p2.8.m5.1.1.1.1.1.3.3.2">𝐴</ci><cn id="A6.p2.8.m5.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A6.p2.8.m5.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><ci id="A6.p2.8.m5.1.1.3.cmml" xref="A6.p2.8.m5.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.8.m5.1c">(A_{1}-\lambda~{}A_{2})V</annotation><annotation encoding="application/x-llamapun" id="A6.p2.8.m5.1d">( italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - italic_λ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) italic_V</annotation></semantics></math>, we have <math alttext="\cfrac{\partial\text{GN}(x)}{\partial x}=\Theta(\cfrac{\sqrt{2d}\cdot\gamma}{|%
|x||_{2}})=\Theta(1)" class="ltx_Math" display="inline" id="A6.p2.9.m6.3"><semantics id="A6.p2.9.m6.3a"><mrow id="A6.p2.9.m6.3.4" xref="A6.p2.9.m6.3.4.cmml"><mfrac id="A6.p2.9.m6.1.1" xref="A6.p2.9.m6.1.1.cmml"><mrow id="A6.p2.9.m6.1.1.1" xref="A6.p2.9.m6.1.1.1.cmml"><mo id="A6.p2.9.m6.1.1.1.2" rspace="0em" xref="A6.p2.9.m6.1.1.1.2.cmml">∂</mo><mrow id="A6.p2.9.m6.1.1.1.3" xref="A6.p2.9.m6.1.1.1.3.cmml"><mtext id="A6.p2.9.m6.1.1.1.3.2" xref="A6.p2.9.m6.1.1.1.3.2a.cmml">GN</mtext><mo id="A6.p2.9.m6.1.1.1.3.1" xref="A6.p2.9.m6.1.1.1.3.1.cmml">⁢</mo><mrow id="A6.p2.9.m6.1.1.1.3.3.2" xref="A6.p2.9.m6.1.1.1.3.cmml"><mo id="A6.p2.9.m6.1.1.1.3.3.2.1" stretchy="false" xref="A6.p2.9.m6.1.1.1.3.cmml">(</mo><mi id="A6.p2.9.m6.1.1.1.1" xref="A6.p2.9.m6.1.1.1.1.cmml">x</mi><mo id="A6.p2.9.m6.1.1.1.3.3.2.2" stretchy="false" xref="A6.p2.9.m6.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="A6.p2.9.m6.1.1.3" xref="A6.p2.9.m6.1.1.3.cmml"><mo id="A6.p2.9.m6.1.1.3.1" rspace="0em" xref="A6.p2.9.m6.1.1.3.1.cmml">∂</mo><mi id="A6.p2.9.m6.1.1.3.2" xref="A6.p2.9.m6.1.1.3.2.cmml">x</mi></mrow></mfrac><mo id="A6.p2.9.m6.3.4.2" xref="A6.p2.9.m6.3.4.2.cmml">=</mo><mrow id="A6.p2.9.m6.3.4.3" xref="A6.p2.9.m6.3.4.3.cmml"><mi id="A6.p2.9.m6.3.4.3.2" mathvariant="normal" xref="A6.p2.9.m6.3.4.3.2.cmml">Θ</mi><mo id="A6.p2.9.m6.3.4.3.1" xref="A6.p2.9.m6.3.4.3.1.cmml">⁢</mo><mrow id="A6.p2.9.m6.3.4.3.3.2" xref="A6.p2.9.m6.2.2.cmml"><mo id="A6.p2.9.m6.3.4.3.3.2.1" stretchy="false" xref="A6.p2.9.m6.2.2.cmml">(</mo><mfrac id="A6.p2.9.m6.2.2" xref="A6.p2.9.m6.2.2.cmml"><mrow id="A6.p2.9.m6.2.2.3" xref="A6.p2.9.m6.2.2.3.cmml"><msqrt id="A6.p2.9.m6.2.2.3.2" xref="A6.p2.9.m6.2.2.3.2.cmml"><mrow id="A6.p2.9.m6.2.2.3.2.2" xref="A6.p2.9.m6.2.2.3.2.2.cmml"><mn id="A6.p2.9.m6.2.2.3.2.2.2" xref="A6.p2.9.m6.2.2.3.2.2.2.cmml">2</mn><mo id="A6.p2.9.m6.2.2.3.2.2.1" xref="A6.p2.9.m6.2.2.3.2.2.1.cmml">⁢</mo><mi id="A6.p2.9.m6.2.2.3.2.2.3" xref="A6.p2.9.m6.2.2.3.2.2.3.cmml">d</mi></mrow></msqrt><mo id="A6.p2.9.m6.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p2.9.m6.2.2.3.1.cmml">⋅</mo><mi id="A6.p2.9.m6.2.2.3.3" xref="A6.p2.9.m6.2.2.3.3.cmml">γ</mi></mrow><msub id="A6.p2.9.m6.2.2.1" xref="A6.p2.9.m6.2.2.1.cmml"><mrow id="A6.p2.9.m6.2.2.1.3.2" xref="A6.p2.9.m6.2.2.1.3.1.cmml"><mo id="A6.p2.9.m6.2.2.1.3.2.1" maxsize="142%" minsize="142%" xref="A6.p2.9.m6.2.2.1.3.1.1.cmml">‖</mo><mi id="A6.p2.9.m6.2.2.1.1" xref="A6.p2.9.m6.2.2.1.1.cmml">x</mi><mo id="A6.p2.9.m6.2.2.1.3.2.2" maxsize="142%" minsize="142%" xref="A6.p2.9.m6.2.2.1.3.1.1.cmml">‖</mo></mrow><mn id="A6.p2.9.m6.2.2.1.4" xref="A6.p2.9.m6.2.2.1.4.cmml">2</mn></msub></mfrac><mo id="A6.p2.9.m6.3.4.3.3.2.2" stretchy="false" xref="A6.p2.9.m6.2.2.cmml">)</mo></mrow></mrow><mo id="A6.p2.9.m6.3.4.4" xref="A6.p2.9.m6.3.4.4.cmml">=</mo><mrow id="A6.p2.9.m6.3.4.5" xref="A6.p2.9.m6.3.4.5.cmml"><mi id="A6.p2.9.m6.3.4.5.2" mathvariant="normal" xref="A6.p2.9.m6.3.4.5.2.cmml">Θ</mi><mo id="A6.p2.9.m6.3.4.5.1" xref="A6.p2.9.m6.3.4.5.1.cmml">⁢</mo><mrow id="A6.p2.9.m6.3.4.5.3.2" xref="A6.p2.9.m6.3.4.5.cmml"><mo id="A6.p2.9.m6.3.4.5.3.2.1" stretchy="false" xref="A6.p2.9.m6.3.4.5.cmml">(</mo><mn id="A6.p2.9.m6.3.3" xref="A6.p2.9.m6.3.3.cmml">1</mn><mo id="A6.p2.9.m6.3.4.5.3.2.2" stretchy="false" xref="A6.p2.9.m6.3.4.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p2.9.m6.3b"><apply id="A6.p2.9.m6.3.4.cmml" xref="A6.p2.9.m6.3.4"><and id="A6.p2.9.m6.3.4a.cmml" xref="A6.p2.9.m6.3.4"></and><apply id="A6.p2.9.m6.3.4b.cmml" xref="A6.p2.9.m6.3.4"><eq id="A6.p2.9.m6.3.4.2.cmml" xref="A6.p2.9.m6.3.4.2"></eq><apply id="A6.p2.9.m6.1.1.cmml" xref="A6.p2.9.m6.1.1"><csymbol cd="latexml" id="A6.p2.9.m6.1.1.2.cmml" xref="A6.p2.9.m6.1.1">continued-fraction</csymbol><apply id="A6.p2.9.m6.1.1.1.cmml" xref="A6.p2.9.m6.1.1.1"><partialdiff id="A6.p2.9.m6.1.1.1.2.cmml" xref="A6.p2.9.m6.1.1.1.2"></partialdiff><apply id="A6.p2.9.m6.1.1.1.3.cmml" xref="A6.p2.9.m6.1.1.1.3"><times id="A6.p2.9.m6.1.1.1.3.1.cmml" xref="A6.p2.9.m6.1.1.1.3.1"></times><ci id="A6.p2.9.m6.1.1.1.3.2a.cmml" xref="A6.p2.9.m6.1.1.1.3.2"><mtext id="A6.p2.9.m6.1.1.1.3.2.cmml" mathsize="70%" xref="A6.p2.9.m6.1.1.1.3.2">GN</mtext></ci><ci id="A6.p2.9.m6.1.1.1.1.cmml" xref="A6.p2.9.m6.1.1.1.1">𝑥</ci></apply></apply><apply id="A6.p2.9.m6.1.1.3.cmml" xref="A6.p2.9.m6.1.1.3"><partialdiff id="A6.p2.9.m6.1.1.3.1.cmml" xref="A6.p2.9.m6.1.1.3.1"></partialdiff><ci id="A6.p2.9.m6.1.1.3.2.cmml" xref="A6.p2.9.m6.1.1.3.2">𝑥</ci></apply></apply><apply id="A6.p2.9.m6.3.4.3.cmml" xref="A6.p2.9.m6.3.4.3"><times id="A6.p2.9.m6.3.4.3.1.cmml" xref="A6.p2.9.m6.3.4.3.1"></times><ci id="A6.p2.9.m6.3.4.3.2.cmml" xref="A6.p2.9.m6.3.4.3.2">Θ</ci><apply id="A6.p2.9.m6.2.2.cmml" xref="A6.p2.9.m6.3.4.3.3.2"><csymbol cd="latexml" id="A6.p2.9.m6.2.2.2.cmml" xref="A6.p2.9.m6.3.4.3.3.2">continued-fraction</csymbol><apply id="A6.p2.9.m6.2.2.3.cmml" xref="A6.p2.9.m6.2.2.3"><ci id="A6.p2.9.m6.2.2.3.1.cmml" xref="A6.p2.9.m6.2.2.3.1">⋅</ci><apply id="A6.p2.9.m6.2.2.3.2.cmml" xref="A6.p2.9.m6.2.2.3.2"><root id="A6.p2.9.m6.2.2.3.2a.cmml" xref="A6.p2.9.m6.2.2.3.2"></root><apply id="A6.p2.9.m6.2.2.3.2.2.cmml" xref="A6.p2.9.m6.2.2.3.2.2"><times id="A6.p2.9.m6.2.2.3.2.2.1.cmml" xref="A6.p2.9.m6.2.2.3.2.2.1"></times><cn id="A6.p2.9.m6.2.2.3.2.2.2.cmml" type="integer" xref="A6.p2.9.m6.2.2.3.2.2.2">2</cn><ci id="A6.p2.9.m6.2.2.3.2.2.3.cmml" xref="A6.p2.9.m6.2.2.3.2.2.3">𝑑</ci></apply></apply><ci id="A6.p2.9.m6.2.2.3.3.cmml" xref="A6.p2.9.m6.2.2.3.3">𝛾</ci></apply><apply id="A6.p2.9.m6.2.2.1.cmml" xref="A6.p2.9.m6.2.2.1"><csymbol cd="ambiguous" id="A6.p2.9.m6.2.2.1.2.cmml" xref="A6.p2.9.m6.2.2.1">subscript</csymbol><apply id="A6.p2.9.m6.2.2.1.3.1.cmml" xref="A6.p2.9.m6.2.2.1.3.2"><csymbol cd="latexml" id="A6.p2.9.m6.2.2.1.3.1.1.cmml" xref="A6.p2.9.m6.2.2.1.3.2.1">norm</csymbol><ci id="A6.p2.9.m6.2.2.1.1.cmml" xref="A6.p2.9.m6.2.2.1.1">𝑥</ci></apply><cn id="A6.p2.9.m6.2.2.1.4.cmml" type="integer" xref="A6.p2.9.m6.2.2.1.4">2</cn></apply></apply></apply></apply><apply id="A6.p2.9.m6.3.4c.cmml" xref="A6.p2.9.m6.3.4"><eq id="A6.p2.9.m6.3.4.4.cmml" xref="A6.p2.9.m6.3.4.4"></eq><share href="https://arxiv.org/html/2410.05258v1#A6.p2.9.m6.3.4.3.cmml" id="A6.p2.9.m6.3.4d.cmml" xref="A6.p2.9.m6.3.4"></share><apply id="A6.p2.9.m6.3.4.5.cmml" xref="A6.p2.9.m6.3.4.5"><times id="A6.p2.9.m6.3.4.5.1.cmml" xref="A6.p2.9.m6.3.4.5.1"></times><ci id="A6.p2.9.m6.3.4.5.2.cmml" xref="A6.p2.9.m6.3.4.5.2">Θ</ci><cn id="A6.p2.9.m6.3.3.cmml" type="integer" xref="A6.p2.9.m6.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.9.m6.3c">\cfrac{\partial\text{GN}(x)}{\partial x}=\Theta(\cfrac{\sqrt{2d}\cdot\gamma}{|%
|x||_{2}})=\Theta(1)</annotation><annotation encoding="application/x-llamapun" id="A6.p2.9.m6.3d">continued-fraction start_ARG ∂ GN ( italic_x ) end_ARG start_ARG ∂ italic_x end_ARG = roman_Θ ( continued-fraction start_ARG square-root start_ARG 2 italic_d end_ARG ⋅ italic_γ end_ARG start_ARG | | italic_x | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG ) = roman_Θ ( 1 )</annotation></semantics></math> as <math alttext="\cfrac{||x||_{2}}{\sqrt{2d}}=\Theta(1-\lambda_{\text{init}})" class="ltx_Math" display="inline" id="A6.p2.10.m7.2"><semantics id="A6.p2.10.m7.2a"><mrow id="A6.p2.10.m7.2.2" xref="A6.p2.10.m7.2.2.cmml"><mfrac id="A6.p2.10.m7.1.1" xref="A6.p2.10.m7.1.1.cmml"><msub id="A6.p2.10.m7.1.1.1" xref="A6.p2.10.m7.1.1.1.cmml"><mrow id="A6.p2.10.m7.1.1.1.3.2" xref="A6.p2.10.m7.1.1.1.3.1.cmml"><mo id="A6.p2.10.m7.1.1.1.3.2.1" maxsize="142%" minsize="142%" xref="A6.p2.10.m7.1.1.1.3.1.1.cmml">‖</mo><mi id="A6.p2.10.m7.1.1.1.1" xref="A6.p2.10.m7.1.1.1.1.cmml">x</mi><mo id="A6.p2.10.m7.1.1.1.3.2.2" maxsize="142%" minsize="142%" xref="A6.p2.10.m7.1.1.1.3.1.1.cmml">‖</mo></mrow><mn id="A6.p2.10.m7.1.1.1.4" xref="A6.p2.10.m7.1.1.1.4.cmml">2</mn></msub><msqrt id="A6.p2.10.m7.1.1.3" xref="A6.p2.10.m7.1.1.3.cmml"><mrow id="A6.p2.10.m7.1.1.3.2" xref="A6.p2.10.m7.1.1.3.2.cmml"><mn id="A6.p2.10.m7.1.1.3.2.2" xref="A6.p2.10.m7.1.1.3.2.2.cmml">2</mn><mo id="A6.p2.10.m7.1.1.3.2.1" xref="A6.p2.10.m7.1.1.3.2.1.cmml">⁢</mo><mi id="A6.p2.10.m7.1.1.3.2.3" xref="A6.p2.10.m7.1.1.3.2.3.cmml">d</mi></mrow></msqrt></mfrac><mo id="A6.p2.10.m7.2.2.2" xref="A6.p2.10.m7.2.2.2.cmml">=</mo><mrow id="A6.p2.10.m7.2.2.1" xref="A6.p2.10.m7.2.2.1.cmml"><mi id="A6.p2.10.m7.2.2.1.3" mathvariant="normal" xref="A6.p2.10.m7.2.2.1.3.cmml">Θ</mi><mo id="A6.p2.10.m7.2.2.1.2" xref="A6.p2.10.m7.2.2.1.2.cmml">⁢</mo><mrow id="A6.p2.10.m7.2.2.1.1.1" xref="A6.p2.10.m7.2.2.1.1.1.1.cmml"><mo id="A6.p2.10.m7.2.2.1.1.1.2" stretchy="false" xref="A6.p2.10.m7.2.2.1.1.1.1.cmml">(</mo><mrow id="A6.p2.10.m7.2.2.1.1.1.1" xref="A6.p2.10.m7.2.2.1.1.1.1.cmml"><mn id="A6.p2.10.m7.2.2.1.1.1.1.2" xref="A6.p2.10.m7.2.2.1.1.1.1.2.cmml">1</mn><mo id="A6.p2.10.m7.2.2.1.1.1.1.1" xref="A6.p2.10.m7.2.2.1.1.1.1.1.cmml">−</mo><msub id="A6.p2.10.m7.2.2.1.1.1.1.3" xref="A6.p2.10.m7.2.2.1.1.1.1.3.cmml"><mi id="A6.p2.10.m7.2.2.1.1.1.1.3.2" xref="A6.p2.10.m7.2.2.1.1.1.1.3.2.cmml">λ</mi><mtext id="A6.p2.10.m7.2.2.1.1.1.1.3.3" xref="A6.p2.10.m7.2.2.1.1.1.1.3.3a.cmml">init</mtext></msub></mrow><mo id="A6.p2.10.m7.2.2.1.1.1.3" stretchy="false" xref="A6.p2.10.m7.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p2.10.m7.2b"><apply id="A6.p2.10.m7.2.2.cmml" xref="A6.p2.10.m7.2.2"><eq id="A6.p2.10.m7.2.2.2.cmml" xref="A6.p2.10.m7.2.2.2"></eq><apply id="A6.p2.10.m7.1.1.cmml" xref="A6.p2.10.m7.1.1"><csymbol cd="latexml" id="A6.p2.10.m7.1.1.2.cmml" xref="A6.p2.10.m7.1.1">continued-fraction</csymbol><apply id="A6.p2.10.m7.1.1.1.cmml" xref="A6.p2.10.m7.1.1.1"><csymbol cd="ambiguous" id="A6.p2.10.m7.1.1.1.2.cmml" xref="A6.p2.10.m7.1.1.1">subscript</csymbol><apply id="A6.p2.10.m7.1.1.1.3.1.cmml" xref="A6.p2.10.m7.1.1.1.3.2"><csymbol cd="latexml" id="A6.p2.10.m7.1.1.1.3.1.1.cmml" xref="A6.p2.10.m7.1.1.1.3.2.1">norm</csymbol><ci id="A6.p2.10.m7.1.1.1.1.cmml" xref="A6.p2.10.m7.1.1.1.1">𝑥</ci></apply><cn id="A6.p2.10.m7.1.1.1.4.cmml" type="integer" xref="A6.p2.10.m7.1.1.1.4">2</cn></apply><apply id="A6.p2.10.m7.1.1.3.cmml" xref="A6.p2.10.m7.1.1.3"><root id="A6.p2.10.m7.1.1.3a.cmml" xref="A6.p2.10.m7.1.1.3"></root><apply id="A6.p2.10.m7.1.1.3.2.cmml" xref="A6.p2.10.m7.1.1.3.2"><times id="A6.p2.10.m7.1.1.3.2.1.cmml" xref="A6.p2.10.m7.1.1.3.2.1"></times><cn id="A6.p2.10.m7.1.1.3.2.2.cmml" type="integer" xref="A6.p2.10.m7.1.1.3.2.2">2</cn><ci id="A6.p2.10.m7.1.1.3.2.3.cmml" xref="A6.p2.10.m7.1.1.3.2.3">𝑑</ci></apply></apply></apply><apply id="A6.p2.10.m7.2.2.1.cmml" xref="A6.p2.10.m7.2.2.1"><times id="A6.p2.10.m7.2.2.1.2.cmml" xref="A6.p2.10.m7.2.2.1.2"></times><ci id="A6.p2.10.m7.2.2.1.3.cmml" xref="A6.p2.10.m7.2.2.1.3">Θ</ci><apply id="A6.p2.10.m7.2.2.1.1.1.1.cmml" xref="A6.p2.10.m7.2.2.1.1.1"><minus id="A6.p2.10.m7.2.2.1.1.1.1.1.cmml" xref="A6.p2.10.m7.2.2.1.1.1.1.1"></minus><cn id="A6.p2.10.m7.2.2.1.1.1.1.2.cmml" type="integer" xref="A6.p2.10.m7.2.2.1.1.1.1.2">1</cn><apply id="A6.p2.10.m7.2.2.1.1.1.1.3.cmml" xref="A6.p2.10.m7.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.p2.10.m7.2.2.1.1.1.1.3.1.cmml" xref="A6.p2.10.m7.2.2.1.1.1.1.3">subscript</csymbol><ci id="A6.p2.10.m7.2.2.1.1.1.1.3.2.cmml" xref="A6.p2.10.m7.2.2.1.1.1.1.3.2">𝜆</ci><ci id="A6.p2.10.m7.2.2.1.1.1.1.3.3a.cmml" xref="A6.p2.10.m7.2.2.1.1.1.1.3.3"><mtext id="A6.p2.10.m7.2.2.1.1.1.1.3.3.cmml" mathsize="70%" xref="A6.p2.10.m7.2.2.1.1.1.1.3.3">init</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.10.m7.2c">\cfrac{||x||_{2}}{\sqrt{2d}}=\Theta(1-\lambda_{\text{init}})</annotation><annotation encoding="application/x-llamapun" id="A6.p2.10.m7.2d">continued-fraction start_ARG | | italic_x | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG 2 italic_d end_ARG end_ARG = roman_Θ ( 1 - italic_λ start_POSTSUBSCRIPT init end_POSTSUBSCRIPT )</annotation></semantics></math> at the early training stage.
With this formulation and given the gradient of <math alttext="O" class="ltx_Math" display="inline" id="A6.p2.11.m8.1"><semantics id="A6.p2.11.m8.1a"><mi id="A6.p2.11.m8.1.1" xref="A6.p2.11.m8.1.1.cmml">O</mi><annotation-xml encoding="MathML-Content" id="A6.p2.11.m8.1b"><ci id="A6.p2.11.m8.1.1.cmml" xref="A6.p2.11.m8.1.1">𝑂</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.11.m8.1c">O</annotation><annotation encoding="application/x-llamapun" id="A6.p2.11.m8.1d">italic_O</annotation></semantics></math> as <math alttext="\cfrac{\partial L}{\partial O}" class="ltx_Math" display="inline" id="A6.p2.12.m9.1"><semantics id="A6.p2.12.m9.1a"><mfrac id="A6.p2.12.m9.1.1" xref="A6.p2.12.m9.1.1.cmml"><mrow id="A6.p2.12.m9.1.1.2" xref="A6.p2.12.m9.1.1.2.cmml"><mo id="A6.p2.12.m9.1.1.2.1" rspace="0em" xref="A6.p2.12.m9.1.1.2.1.cmml">∂</mo><mi id="A6.p2.12.m9.1.1.2.2" xref="A6.p2.12.m9.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.p2.12.m9.1.1.3" xref="A6.p2.12.m9.1.1.3.cmml"><mo id="A6.p2.12.m9.1.1.3.1" rspace="0em" xref="A6.p2.12.m9.1.1.3.1.cmml">∂</mo><mi id="A6.p2.12.m9.1.1.3.2" xref="A6.p2.12.m9.1.1.3.2.cmml">O</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="A6.p2.12.m9.1b"><apply id="A6.p2.12.m9.1.1.cmml" xref="A6.p2.12.m9.1.1"><csymbol cd="latexml" id="A6.p2.12.m9.1.1.1.cmml" xref="A6.p2.12.m9.1.1">continued-fraction</csymbol><apply id="A6.p2.12.m9.1.1.2.cmml" xref="A6.p2.12.m9.1.1.2"><partialdiff id="A6.p2.12.m9.1.1.2.1.cmml" xref="A6.p2.12.m9.1.1.2.1"></partialdiff><ci id="A6.p2.12.m9.1.1.2.2.cmml" xref="A6.p2.12.m9.1.1.2.2">𝐿</ci></apply><apply id="A6.p2.12.m9.1.1.3.cmml" xref="A6.p2.12.m9.1.1.3"><partialdiff id="A6.p2.12.m9.1.1.3.1.cmml" xref="A6.p2.12.m9.1.1.3.1"></partialdiff><ci id="A6.p2.12.m9.1.1.3.2.cmml" xref="A6.p2.12.m9.1.1.3.2">𝑂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.12.m9.1c">\cfrac{\partial L}{\partial O}</annotation><annotation encoding="application/x-llamapun" id="A6.p2.12.m9.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG</annotation></semantics></math>, we formulate gradients of parameters as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="A6.E7">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{O}}" class="ltx_Math" display="inline" id="A6.E7X.2.1.1.m1.1"><semantics id="A6.E7X.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E7X.2.1.1.m1.1.1" xref="A6.E7X.2.1.1.m1.1.1.cmml"><mfrac id="A6.E7X.2.1.1.m1.1.1a" xref="A6.E7X.2.1.1.m1.1.1.cmml"><mrow id="A6.E7X.2.1.1.m1.1.1.2" xref="A6.E7X.2.1.1.m1.1.1.2.cmml"><mo id="A6.E7X.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E7X.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E7X.2.1.1.m1.1.1.2.2" xref="A6.E7X.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E7X.2.1.1.m1.1.1.3" xref="A6.E7X.2.1.1.m1.1.1.3.cmml"><mo id="A6.E7X.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E7X.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E7X.2.1.1.m1.1.1.3.2" xref="A6.E7X.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E7X.2.1.1.m1.1.1.3.2.2" xref="A6.E7X.2.1.1.m1.1.1.3.2.2.cmml">W</mi><mi id="A6.E7X.2.1.1.m1.1.1.3.2.3" xref="A6.E7X.2.1.1.m1.1.1.3.2.3.cmml">O</mi></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E7X.2.1.1.m1.1b"><apply id="A6.E7X.2.1.1.m1.1.1.cmml" xref="A6.E7X.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E7X.2.1.1.m1.1.1.1.cmml" xref="A6.E7X.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E7X.2.1.1.m1.1.1.2.cmml" xref="A6.E7X.2.1.1.m1.1.1.2"><partialdiff id="A6.E7X.2.1.1.m1.1.1.2.1.cmml" xref="A6.E7X.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E7X.2.1.1.m1.1.1.2.2.cmml" xref="A6.E7X.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E7X.2.1.1.m1.1.1.3.cmml" xref="A6.E7X.2.1.1.m1.1.1.3"><partialdiff id="A6.E7X.2.1.1.m1.1.1.3.1.cmml" xref="A6.E7X.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E7X.2.1.1.m1.1.1.3.2.cmml" xref="A6.E7X.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E7X.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E7X.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E7X.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E7X.2.1.1.m1.1.1.3.2.2">𝑊</ci><ci id="A6.E7X.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E7X.2.1.1.m1.1.1.3.2.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7X.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{O}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7X.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial W^{O}}" class="ltx_Math" display="inline" id="A6.E7X.3.2.2.m1.1"><semantics id="A6.E7X.3.2.2.m1.1a"><mrow id="A6.E7X.3.2.2.m1.1.1" xref="A6.E7X.3.2.2.m1.1.1.cmml"><mi id="A6.E7X.3.2.2.m1.1.1.2" xref="A6.E7X.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E7X.3.2.2.m1.1.1.1" xref="A6.E7X.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E7X.3.2.2.m1.1.1.3" xref="A6.E7X.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E7X.3.2.2.m1.1.1.3.2" xref="A6.E7X.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E7X.3.2.2.m1.1.1.3.2a" xref="A6.E7X.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E7X.3.2.2.m1.1.1.3.2.2" xref="A6.E7X.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E7X.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E7X.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E7X.3.2.2.m1.1.1.3.2.2.2" xref="A6.E7X.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E7X.3.2.2.m1.1.1.3.2.3" xref="A6.E7X.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E7X.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E7X.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E7X.3.2.2.m1.1.1.3.2.3.2" xref="A6.E7X.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7X.3.2.2.m1.1.1.3.1" xref="A6.E7X.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7X.3.2.2.m1.1.1.3.3" xref="A6.E7X.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E7X.3.2.2.m1.1.1.3.3a" xref="A6.E7X.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E7X.3.2.2.m1.1.1.3.3.2" xref="A6.E7X.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E7X.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E7X.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E7X.3.2.2.m1.1.1.3.3.2.2" xref="A6.E7X.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E7X.3.2.2.m1.1.1.3.3.3" xref="A6.E7X.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E7X.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E7X.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><msup id="A6.E7X.3.2.2.m1.1.1.3.3.3.2" xref="A6.E7X.3.2.2.m1.1.1.3.3.3.2.cmml"><mi id="A6.E7X.3.2.2.m1.1.1.3.3.3.2.2" xref="A6.E7X.3.2.2.m1.1.1.3.3.3.2.2.cmml">W</mi><mi id="A6.E7X.3.2.2.m1.1.1.3.3.3.2.3" xref="A6.E7X.3.2.2.m1.1.1.3.3.3.2.3.cmml">O</mi></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7X.3.2.2.m1.1b"><apply id="A6.E7X.3.2.2.m1.1.1.cmml" xref="A6.E7X.3.2.2.m1.1.1"><eq id="A6.E7X.3.2.2.m1.1.1.1.cmml" xref="A6.E7X.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E7X.3.2.2.m1.1.1.2.cmml" xref="A6.E7X.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E7X.3.2.2.m1.1.1.3.cmml" xref="A6.E7X.3.2.2.m1.1.1.3"><times id="A6.E7X.3.2.2.m1.1.1.3.1.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.1"></times><apply id="A6.E7X.3.2.2.m1.1.1.3.2.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E7X.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E7X.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E7X.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E7X.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E7X.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E7X.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E7X.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E7X.3.2.2.m1.1.1.3.3.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E7X.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E7X.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E7X.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E7X.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E7X.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E7X.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3.3.1"></partialdiff><apply id="A6.E7X.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="A6.E7X.3.2.2.m1.1.1.3.3.3.2.1.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3.3.2">superscript</csymbol><ci id="A6.E7X.3.2.2.m1.1.1.3.3.3.2.2.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3.3.2.2">𝑊</ci><ci id="A6.E7X.3.2.2.m1.1.1.3.3.3.2.3.cmml" xref="A6.E7X.3.2.2.m1.1.1.3.3.3.2.3">𝑂</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7X.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial W^{O}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7X.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="12"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=((A_{1}-\lambda~{}A_{2})V)^{\intercal}\cfrac{\partial L}{%
\partial O}" class="ltx_Math" display="inline" id="A6.E7Xa.2.1.1.m1.1"><semantics id="A6.E7Xa.2.1.1.m1.1a"><mrow id="A6.E7Xa.2.1.1.m1.1.1" xref="A6.E7Xa.2.1.1.m1.1.1.cmml"><mi id="A6.E7Xa.2.1.1.m1.1.1.3" xref="A6.E7Xa.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E7Xa.2.1.1.m1.1.1.2" xref="A6.E7Xa.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E7Xa.2.1.1.m1.1.1.1" xref="A6.E7Xa.2.1.1.m1.1.1.1.cmml"><msup id="A6.E7Xa.2.1.1.m1.1.1.1.1" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">A</mi><mn id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mo id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1" lspace="0.330em" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">A</mi><mn id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">V</mi></mrow><mo id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xa.2.1.1.m1.1.1.1.1.3" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xa.2.1.1.m1.1.1.1.2" xref="A6.E7Xa.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xa.2.1.1.m1.1.1.1.3" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.cmml"><mfrac id="A6.E7Xa.2.1.1.m1.1.1.1.3a" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.cmml"><mrow id="A6.E7Xa.2.1.1.m1.1.1.1.3.2" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.2.cmml"><mo id="A6.E7Xa.2.1.1.m1.1.1.1.3.2.1" rspace="0em" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E7Xa.2.1.1.m1.1.1.1.3.2.2" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xa.2.1.1.m1.1.1.1.3.3" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.3.cmml"><mo id="A6.E7Xa.2.1.1.m1.1.1.1.3.3.1" rspace="0em" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E7Xa.2.1.1.m1.1.1.1.3.3.2" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xa.2.1.1.m1.1b"><apply id="A6.E7Xa.2.1.1.m1.1.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1"><eq id="A6.E7Xa.2.1.1.m1.1.1.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E7Xa.2.1.1.m1.1.1.3.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E7Xa.2.1.1.m1.1.1.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1"><times id="A6.E7Xa.2.1.1.m1.1.1.1.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.2"></times><apply id="A6.E7Xa.2.1.1.m1.1.1.1.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1"><times id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.2"></times><apply id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><minus id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐴</ci><cn id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><times id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝜆</ci><apply id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝐴</ci><cn id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><ci id="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.1.1.1.3">𝑉</ci></apply><ci id="A6.E7Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xa.2.1.1.m1.1.1.1.3.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xa.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xa.2.1.1.m1.1.1.1.3.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.2"><partialdiff id="A6.E7Xa.2.1.1.m1.1.1.1.3.2.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.2.1"></partialdiff><ci id="A6.E7Xa.2.1.1.m1.1.1.1.3.2.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E7Xa.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.3"><partialdiff id="A6.E7Xa.2.1.1.m1.1.1.1.3.3.1.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.3.1"></partialdiff><ci id="A6.E7Xa.2.1.1.m1.1.1.1.3.3.2.cmml" xref="A6.E7Xa.2.1.1.m1.1.1.1.3.3.2">𝑂</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xa.2.1.1.m1.1c">\displaystyle=((A_{1}-\lambda~{}A_{2})V)^{\intercal}\cfrac{\partial L}{%
\partial O}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xa.2.1.1.m1.1d">= ( ( italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - italic_λ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) italic_V ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{V}}" class="ltx_Math" display="inline" id="A6.E7Xb.2.1.1.m1.1"><semantics id="A6.E7Xb.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E7Xb.2.1.1.m1.1.1" xref="A6.E7Xb.2.1.1.m1.1.1.cmml"><mfrac id="A6.E7Xb.2.1.1.m1.1.1a" xref="A6.E7Xb.2.1.1.m1.1.1.cmml"><mrow id="A6.E7Xb.2.1.1.m1.1.1.2" xref="A6.E7Xb.2.1.1.m1.1.1.2.cmml"><mo id="A6.E7Xb.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E7Xb.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E7Xb.2.1.1.m1.1.1.2.2" xref="A6.E7Xb.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xb.2.1.1.m1.1.1.3" xref="A6.E7Xb.2.1.1.m1.1.1.3.cmml"><mo id="A6.E7Xb.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E7Xb.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E7Xb.2.1.1.m1.1.1.3.2" xref="A6.E7Xb.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E7Xb.2.1.1.m1.1.1.3.2.2" xref="A6.E7Xb.2.1.1.m1.1.1.3.2.2.cmml">W</mi><mi id="A6.E7Xb.2.1.1.m1.1.1.3.2.3" xref="A6.E7Xb.2.1.1.m1.1.1.3.2.3.cmml">V</mi></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E7Xb.2.1.1.m1.1b"><apply id="A6.E7Xb.2.1.1.m1.1.1.cmml" xref="A6.E7Xb.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E7Xb.2.1.1.m1.1.1.1.cmml" xref="A6.E7Xb.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E7Xb.2.1.1.m1.1.1.2.cmml" xref="A6.E7Xb.2.1.1.m1.1.1.2"><partialdiff id="A6.E7Xb.2.1.1.m1.1.1.2.1.cmml" xref="A6.E7Xb.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E7Xb.2.1.1.m1.1.1.2.2.cmml" xref="A6.E7Xb.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E7Xb.2.1.1.m1.1.1.3.cmml" xref="A6.E7Xb.2.1.1.m1.1.1.3"><partialdiff id="A6.E7Xb.2.1.1.m1.1.1.3.1.cmml" xref="A6.E7Xb.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E7Xb.2.1.1.m1.1.1.3.2.cmml" xref="A6.E7Xb.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E7Xb.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E7Xb.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E7Xb.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E7Xb.2.1.1.m1.1.1.3.2.2">𝑊</ci><ci id="A6.E7Xb.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E7Xb.2.1.1.m1.1.1.3.2.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xb.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{V}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xb.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial V}%
\cfrac{\partial V}{\partial W^{V}}" class="ltx_Math" display="inline" id="A6.E7Xb.3.2.2.m1.1"><semantics id="A6.E7Xb.3.2.2.m1.1a"><mrow id="A6.E7Xb.3.2.2.m1.1.1" xref="A6.E7Xb.3.2.2.m1.1.1.cmml"><mi id="A6.E7Xb.3.2.2.m1.1.1.2" xref="A6.E7Xb.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E7Xb.3.2.2.m1.1.1.1" xref="A6.E7Xb.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E7Xb.3.2.2.m1.1.1.3" xref="A6.E7Xb.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E7Xb.3.2.2.m1.1.1.3.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E7Xb.3.2.2.m1.1.1.3.2a" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E7Xb.3.2.2.m1.1.1.3.2.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E7Xb.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E7Xb.3.2.2.m1.1.1.3.2.2.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xb.3.2.2.m1.1.1.3.2.3" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E7Xb.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E7Xb.3.2.2.m1.1.1.3.2.3.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xb.3.2.2.m1.1.1.3.1" xref="A6.E7Xb.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xb.3.2.2.m1.1.1.3.3" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E7Xb.3.2.2.m1.1.1.3.3a" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E7Xb.3.2.2.m1.1.1.3.3.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E7Xb.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E7Xb.3.2.2.m1.1.1.3.3.2.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E7Xb.3.2.2.m1.1.1.3.3.3" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E7Xb.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><mi id="A6.E7Xb.3.2.2.m1.1.1.3.3.3.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.3.2.cmml">V</mi></mrow></mfrac></mstyle><mo id="A6.E7Xb.3.2.2.m1.1.1.3.1a" xref="A6.E7Xb.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xb.3.2.2.m1.1.1.3.4" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.cmml"><mfrac id="A6.E7Xb.3.2.2.m1.1.1.3.4a" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.cmml"><mrow id="A6.E7Xb.3.2.2.m1.1.1.3.4.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.2.cmml"><mo id="A6.E7Xb.3.2.2.m1.1.1.3.4.2.1" rspace="0em" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.2.1.cmml">∂</mo><mi id="A6.E7Xb.3.2.2.m1.1.1.3.4.2.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.2.2.cmml">V</mi></mrow><mrow id="A6.E7Xb.3.2.2.m1.1.1.3.4.3" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3.cmml"><mo id="A6.E7Xb.3.2.2.m1.1.1.3.4.3.1" rspace="0em" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3.1.cmml">∂</mo><msup id="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.cmml"><mi id="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.2" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.2.cmml">W</mi><mi id="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.3" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.3.cmml">V</mi></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xb.3.2.2.m1.1b"><apply id="A6.E7Xb.3.2.2.m1.1.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1"><eq id="A6.E7Xb.3.2.2.m1.1.1.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E7Xb.3.2.2.m1.1.1.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E7Xb.3.2.2.m1.1.1.3.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3"><times id="A6.E7Xb.3.2.2.m1.1.1.3.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.1"></times><apply id="A6.E7Xb.3.2.2.m1.1.1.3.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E7Xb.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E7Xb.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E7Xb.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E7Xb.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E7Xb.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E7Xb.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E7Xb.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xb.3.2.2.m1.1.1.3.3.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E7Xb.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E7Xb.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E7Xb.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E7Xb.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E7Xb.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E7Xb.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.3.1"></partialdiff><ci id="A6.E7Xb.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.3.3.2">𝑉</ci></apply></apply><apply id="A6.E7Xb.3.2.2.m1.1.1.3.4.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4"><csymbol cd="latexml" id="A6.E7Xb.3.2.2.m1.1.1.3.4.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4">continued-fraction</csymbol><apply id="A6.E7Xb.3.2.2.m1.1.1.3.4.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.2"><partialdiff id="A6.E7Xb.3.2.2.m1.1.1.3.4.2.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.2.1"></partialdiff><ci id="A6.E7Xb.3.2.2.m1.1.1.3.4.2.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.2.2">𝑉</ci></apply><apply id="A6.E7Xb.3.2.2.m1.1.1.3.4.3.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3"><partialdiff id="A6.E7Xb.3.2.2.m1.1.1.3.4.3.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3.1"></partialdiff><apply id="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2"><csymbol cd="ambiguous" id="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.1.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2">superscript</csymbol><ci id="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.2.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.2">𝑊</ci><ci id="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.3.cmml" xref="A6.E7Xb.3.2.2.m1.1.1.3.4.3.2.3">𝑉</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xb.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial V}%
\cfrac{\partial V}{\partial W^{V}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xb.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_V end_ARG continued-fraction start_ARG ∂ italic_V end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xc">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=X^{\intercal}(A_{1}-\lambda~{}A_{2})^{\intercal}\cfrac{\partial L%
}{\partial O}(W^{O})^{\intercal}" class="ltx_Math" display="inline" id="A6.E7Xc.2.1.1.m1.2"><semantics id="A6.E7Xc.2.1.1.m1.2a"><mrow id="A6.E7Xc.2.1.1.m1.2.2" xref="A6.E7Xc.2.1.1.m1.2.2.cmml"><mi id="A6.E7Xc.2.1.1.m1.2.2.4" xref="A6.E7Xc.2.1.1.m1.2.2.4.cmml"></mi><mo id="A6.E7Xc.2.1.1.m1.2.2.3" xref="A6.E7Xc.2.1.1.m1.2.2.3.cmml">=</mo><mrow id="A6.E7Xc.2.1.1.m1.2.2.2" xref="A6.E7Xc.2.1.1.m1.2.2.2.cmml"><msup id="A6.E7Xc.2.1.1.m1.2.2.2.4" xref="A6.E7Xc.2.1.1.m1.2.2.2.4.cmml"><mi id="A6.E7Xc.2.1.1.m1.2.2.2.4.2" xref="A6.E7Xc.2.1.1.m1.2.2.2.4.2.cmml">X</mi><mo id="A6.E7Xc.2.1.1.m1.2.2.2.4.3" xref="A6.E7Xc.2.1.1.m1.2.2.2.4.3.cmml">⊺</mo></msup><mo id="A6.E7Xc.2.1.1.m1.2.2.2.3" xref="A6.E7Xc.2.1.1.m1.2.2.2.3.cmml">⁢</mo><msup id="A6.E7Xc.2.1.1.m1.1.1.1.1" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.cmml"><mrow id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml"><msub id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.2" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml">A</mi><mn id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.3" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.1" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mo id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.1" lspace="0.330em" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.2" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml">A</mi><mn id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.3" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xc.2.1.1.m1.1.1.1.1.3" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xc.2.1.1.m1.2.2.2.3a" xref="A6.E7Xc.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xc.2.1.1.m1.2.2.2.5" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.cmml"><mfrac id="A6.E7Xc.2.1.1.m1.2.2.2.5a" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.cmml"><mrow id="A6.E7Xc.2.1.1.m1.2.2.2.5.2" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.2.cmml"><mo id="A6.E7Xc.2.1.1.m1.2.2.2.5.2.1" rspace="0em" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.2.1.cmml">∂</mo><mi id="A6.E7Xc.2.1.1.m1.2.2.2.5.2.2" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xc.2.1.1.m1.2.2.2.5.3" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.3.cmml"><mo id="A6.E7Xc.2.1.1.m1.2.2.2.5.3.1" rspace="0em" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.3.1.cmml">∂</mo><mi id="A6.E7Xc.2.1.1.m1.2.2.2.5.3.2" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xc.2.1.1.m1.2.2.2.3b" xref="A6.E7Xc.2.1.1.m1.2.2.2.3.cmml">⁢</mo><msup id="A6.E7Xc.2.1.1.m1.2.2.2.2" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.cmml"><mrow id="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.cmml"><mo id="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.2" stretchy="false" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.cmml">(</mo><msup id="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.cmml"><mi id="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.2" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.2.cmml">W</mi><mi id="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.3" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.3.cmml">O</mi></msup><mo id="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.3" stretchy="false" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xc.2.1.1.m1.2.2.2.2.3" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.3.cmml">⊺</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xc.2.1.1.m1.2b"><apply id="A6.E7Xc.2.1.1.m1.2.2.cmml" xref="A6.E7Xc.2.1.1.m1.2.2"><eq id="A6.E7Xc.2.1.1.m1.2.2.3.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.3"></eq><csymbol cd="latexml" id="A6.E7Xc.2.1.1.m1.2.2.4.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.4">absent</csymbol><apply id="A6.E7Xc.2.1.1.m1.2.2.2.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2"><times id="A6.E7Xc.2.1.1.m1.2.2.2.3.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.3"></times><apply id="A6.E7Xc.2.1.1.m1.2.2.2.4.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.4"><csymbol cd="ambiguous" id="A6.E7Xc.2.1.1.m1.2.2.2.4.1.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.4">superscript</csymbol><ci id="A6.E7Xc.2.1.1.m1.2.2.2.4.2.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.4.2">𝑋</ci><ci id="A6.E7Xc.2.1.1.m1.2.2.2.4.3.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.4.3">⊺</ci></apply><apply id="A6.E7Xc.2.1.1.m1.1.1.1.1.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xc.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1"><minus id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.1"></minus><apply id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.2">𝐴</ci><cn id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3"><times id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.1"></times><ci id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.2">𝜆</ci><apply id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.2">𝐴</ci><cn id="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><ci id="A6.E7Xc.2.1.1.m1.1.1.1.1.3.cmml" xref="A6.E7Xc.2.1.1.m1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xc.2.1.1.m1.2.2.2.5.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.5"><csymbol cd="latexml" id="A6.E7Xc.2.1.1.m1.2.2.2.5.1.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.5">continued-fraction</csymbol><apply id="A6.E7Xc.2.1.1.m1.2.2.2.5.2.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.2"><partialdiff id="A6.E7Xc.2.1.1.m1.2.2.2.5.2.1.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.2.1"></partialdiff><ci id="A6.E7Xc.2.1.1.m1.2.2.2.5.2.2.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.2.2">𝐿</ci></apply><apply id="A6.E7Xc.2.1.1.m1.2.2.2.5.3.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.3"><partialdiff id="A6.E7Xc.2.1.1.m1.2.2.2.5.3.1.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.3.1"></partialdiff><ci id="A6.E7Xc.2.1.1.m1.2.2.2.5.3.2.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.5.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xc.2.1.1.m1.2.2.2.2.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A6.E7Xc.2.1.1.m1.2.2.2.2.2.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.2">superscript</csymbol><apply id="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.1.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1">superscript</csymbol><ci id="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.2">𝑊</ci><ci id="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.3.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.1.1.1.3">𝑂</ci></apply><ci id="A6.E7Xc.2.1.1.m1.2.2.2.2.3.cmml" xref="A6.E7Xc.2.1.1.m1.2.2.2.2.3">⊺</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xc.2.1.1.m1.2c">\displaystyle=X^{\intercal}(A_{1}-\lambda~{}A_{2})^{\intercal}\cfrac{\partial L%
}{\partial O}(W^{O})^{\intercal}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xc.2.1.1.m1.2d">= italic_X start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT ( italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - italic_λ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xd">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{Q_{1}}}" class="ltx_Math" display="inline" id="A6.E7Xd.2.1.1.m1.1"><semantics id="A6.E7Xd.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E7Xd.2.1.1.m1.1.1" xref="A6.E7Xd.2.1.1.m1.1.1.cmml"><mfrac id="A6.E7Xd.2.1.1.m1.1.1a" xref="A6.E7Xd.2.1.1.m1.1.1.cmml"><mrow id="A6.E7Xd.2.1.1.m1.1.1.2" xref="A6.E7Xd.2.1.1.m1.1.1.2.cmml"><mo id="A6.E7Xd.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E7Xd.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E7Xd.2.1.1.m1.1.1.2.2" xref="A6.E7Xd.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xd.2.1.1.m1.1.1.3" xref="A6.E7Xd.2.1.1.m1.1.1.3.cmml"><mo id="A6.E7Xd.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E7Xd.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E7Xd.2.1.1.m1.1.1.3.2" xref="A6.E7Xd.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E7Xd.2.1.1.m1.1.1.3.2.2" xref="A6.E7Xd.2.1.1.m1.1.1.3.2.2.cmml">W</mi><msub id="A6.E7Xd.2.1.1.m1.1.1.3.2.3" xref="A6.E7Xd.2.1.1.m1.1.1.3.2.3.cmml"><mi id="A6.E7Xd.2.1.1.m1.1.1.3.2.3.2" xref="A6.E7Xd.2.1.1.m1.1.1.3.2.3.2.cmml">Q</mi><mn id="A6.E7Xd.2.1.1.m1.1.1.3.2.3.3" xref="A6.E7Xd.2.1.1.m1.1.1.3.2.3.3.cmml">1</mn></msub></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E7Xd.2.1.1.m1.1b"><apply id="A6.E7Xd.2.1.1.m1.1.1.cmml" xref="A6.E7Xd.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E7Xd.2.1.1.m1.1.1.1.cmml" xref="A6.E7Xd.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E7Xd.2.1.1.m1.1.1.2.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.2"><partialdiff id="A6.E7Xd.2.1.1.m1.1.1.2.1.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E7Xd.2.1.1.m1.1.1.2.2.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E7Xd.2.1.1.m1.1.1.3.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.3"><partialdiff id="A6.E7Xd.2.1.1.m1.1.1.3.1.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E7Xd.2.1.1.m1.1.1.3.2.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E7Xd.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E7Xd.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.3.2.2">𝑊</ci><apply id="A6.E7Xd.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A6.E7Xd.2.1.1.m1.1.1.3.2.3.1.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="A6.E7Xd.2.1.1.m1.1.1.3.2.3.2.cmml" xref="A6.E7Xd.2.1.1.m1.1.1.3.2.3.2">𝑄</ci><cn id="A6.E7Xd.2.1.1.m1.1.1.3.2.3.3.cmml" type="integer" xref="A6.E7Xd.2.1.1.m1.1.1.3.2.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xd.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{Q_{1}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xd.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A_{1}}%
\cfrac{\partial A_{1}}{\partial Q_{1}}\cfrac{\partial Q_{1}}{\partial W^{Q_{1}}}" class="ltx_Math" display="inline" id="A6.E7Xd.3.2.2.m1.1"><semantics id="A6.E7Xd.3.2.2.m1.1a"><mrow id="A6.E7Xd.3.2.2.m1.1.1" xref="A6.E7Xd.3.2.2.m1.1.1.cmml"><mi id="A6.E7Xd.3.2.2.m1.1.1.2" xref="A6.E7Xd.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E7Xd.3.2.2.m1.1.1.1" xref="A6.E7Xd.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E7Xd.3.2.2.m1.1.1.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E7Xd.3.2.2.m1.1.1.3.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E7Xd.3.2.2.m1.1.1.3.2a" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E7Xd.3.2.2.m1.1.1.3.2.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E7Xd.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E7Xd.3.2.2.m1.1.1.3.2.2.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xd.3.2.2.m1.1.1.3.2.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E7Xd.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E7Xd.3.2.2.m1.1.1.3.2.3.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xd.3.2.2.m1.1.1.3.1" xref="A6.E7Xd.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xd.3.2.2.m1.1.1.3.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E7Xd.3.2.2.m1.1.1.3.3a" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E7Xd.3.2.2.m1.1.1.3.3.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E7Xd.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E7Xd.3.2.2.m1.1.1.3.3.2.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E7Xd.3.2.2.m1.1.1.3.3.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E7Xd.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><msub id="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.cmml"><mi id="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.2.cmml">A</mi><mn id="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.3.cmml">1</mn></msub></mrow></mfrac></mstyle><mo id="A6.E7Xd.3.2.2.m1.1.1.3.1a" xref="A6.E7Xd.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xd.3.2.2.m1.1.1.3.4" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.cmml"><mfrac id="A6.E7Xd.3.2.2.m1.1.1.3.4a" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.cmml"><mrow id="A6.E7Xd.3.2.2.m1.1.1.3.4.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2.cmml"><mo id="A6.E7Xd.3.2.2.m1.1.1.3.4.2.1" rspace="0em" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2.1.cmml">∂</mo><msub id="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.cmml"><mi id="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.2.cmml">A</mi><mn id="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.3.cmml">1</mn></msub></mrow><mrow id="A6.E7Xd.3.2.2.m1.1.1.3.4.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3.cmml"><mo id="A6.E7Xd.3.2.2.m1.1.1.3.4.3.1" rspace="0em" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3.1.cmml">∂</mo><msub id="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.cmml"><mi id="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.2.cmml">Q</mi><mn id="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.3.cmml">1</mn></msub></mrow></mfrac></mstyle><mo id="A6.E7Xd.3.2.2.m1.1.1.3.1b" xref="A6.E7Xd.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xd.3.2.2.m1.1.1.3.5" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.cmml"><mfrac id="A6.E7Xd.3.2.2.m1.1.1.3.5a" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.cmml"><mrow id="A6.E7Xd.3.2.2.m1.1.1.3.5.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2.cmml"><mo id="A6.E7Xd.3.2.2.m1.1.1.3.5.2.1" rspace="0em" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2.1.cmml">∂</mo><msub id="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.cmml"><mi id="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.2.cmml">Q</mi><mn id="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.3.cmml">1</mn></msub></mrow><mrow id="A6.E7Xd.3.2.2.m1.1.1.3.5.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.cmml"><mo id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.1" rspace="0em" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.1.cmml">∂</mo><msup id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.cmml"><mi id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.2.cmml">W</mi><msub id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.cmml"><mi id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.2" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.2.cmml">Q</mi><mn id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.3" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.3.cmml">1</mn></msub></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xd.3.2.2.m1.1b"><apply id="A6.E7Xd.3.2.2.m1.1.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1"><eq id="A6.E7Xd.3.2.2.m1.1.1.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E7Xd.3.2.2.m1.1.1.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E7Xd.3.2.2.m1.1.1.3.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3"><times id="A6.E7Xd.3.2.2.m1.1.1.3.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.1"></times><apply id="A6.E7Xd.3.2.2.m1.1.1.3.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E7Xd.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E7Xd.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E7Xd.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E7Xd.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E7Xd.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E7Xd.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E7Xd.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xd.3.2.2.m1.1.1.3.3.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E7Xd.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E7Xd.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E7Xd.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E7Xd.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E7Xd.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E7Xd.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3.1"></partialdiff><apply id="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2">subscript</csymbol><ci id="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.2">𝐴</ci><cn id="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.3.cmml" type="integer" xref="A6.E7Xd.3.2.2.m1.1.1.3.3.3.2.3">1</cn></apply></apply></apply><apply id="A6.E7Xd.3.2.2.m1.1.1.3.4.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4"><csymbol cd="latexml" id="A6.E7Xd.3.2.2.m1.1.1.3.4.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4">continued-fraction</csymbol><apply id="A6.E7Xd.3.2.2.m1.1.1.3.4.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2"><partialdiff id="A6.E7Xd.3.2.2.m1.1.1.3.4.2.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2.1"></partialdiff><apply id="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2"><csymbol cd="ambiguous" id="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2">subscript</csymbol><ci id="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.2">𝐴</ci><cn id="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.3.cmml" type="integer" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.2.2.3">1</cn></apply></apply><apply id="A6.E7Xd.3.2.2.m1.1.1.3.4.3.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3"><partialdiff id="A6.E7Xd.3.2.2.m1.1.1.3.4.3.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3.1"></partialdiff><apply id="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2"><csymbol cd="ambiguous" id="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2">subscript</csymbol><ci id="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.2">𝑄</ci><cn id="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.3.cmml" type="integer" xref="A6.E7Xd.3.2.2.m1.1.1.3.4.3.2.3">1</cn></apply></apply></apply><apply id="A6.E7Xd.3.2.2.m1.1.1.3.5.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5"><csymbol cd="latexml" id="A6.E7Xd.3.2.2.m1.1.1.3.5.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5">continued-fraction</csymbol><apply id="A6.E7Xd.3.2.2.m1.1.1.3.5.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2"><partialdiff id="A6.E7Xd.3.2.2.m1.1.1.3.5.2.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2.1"></partialdiff><apply id="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2"><csymbol cd="ambiguous" id="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2">subscript</csymbol><ci id="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.2">𝑄</ci><cn id="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.3.cmml" type="integer" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.2.2.3">1</cn></apply></apply><apply id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3"><partialdiff id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.1"></partialdiff><apply id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2"><csymbol cd="ambiguous" id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2">superscript</csymbol><ci id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.2">𝑊</ci><apply id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3"><csymbol cd="ambiguous" id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.1.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3">subscript</csymbol><ci id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.2.cmml" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.2">𝑄</ci><cn id="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.3.cmml" type="integer" xref="A6.E7Xd.3.2.2.m1.1.1.3.5.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xd.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A_{1}}%
\cfrac{\partial A_{1}}{\partial Q_{1}}\cfrac{\partial Q_{1}}{\partial W^{Q_{1}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xd.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xe">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{1}{\sqrt{d}}~{}X^{\intercal}[A_{1}\odot(\cfrac{\partial L%
}{\partial O}(W^{O})^{\intercal}V^{\intercal}-(A_{1}\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]K_{1}" class="ltx_Math" display="inline" id="A6.E7Xe.2.1.1.m1.1"><semantics id="A6.E7Xe.2.1.1.m1.1a"><mrow id="A6.E7Xe.2.1.1.m1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.cmml"><mi id="A6.E7Xe.2.1.1.m1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E7Xe.2.1.1.m1.1.1.2" xref="A6.E7Xe.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E7Xe.2.1.1.m1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xe.2.1.1.m1.1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.3.cmml"><mfrac id="A6.E7Xe.2.1.1.m1.1.1.1.3a" xref="A6.E7Xe.2.1.1.m1.1.1.1.3.cmml"><mn id="A6.E7Xe.2.1.1.m1.1.1.1.3.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.3.2.cmml">1</mn><msqrt id="A6.E7Xe.2.1.1.m1.1.1.1.3.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.3.3.cmml"><mi id="A6.E7Xe.2.1.1.m1.1.1.1.3.3.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.3.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="A6.E7Xe.2.1.1.m1.1.1.1.2" lspace="0.330em" xref="A6.E7Xe.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xe.2.1.1.m1.1.1.1.4" xref="A6.E7Xe.2.1.1.m1.1.1.1.4.cmml"><mi id="A6.E7Xe.2.1.1.m1.1.1.1.4.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.4.2.cmml">X</mi><mo id="A6.E7Xe.2.1.1.m1.1.1.1.4.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.4.3.cmml">⊺</mo></msup><mo id="A6.E7Xe.2.1.1.m1.1.1.1.2a" xref="A6.E7Xe.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.2.cmml"><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.cmml"><msub id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">A</mi><mn id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3a" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2a" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><msub id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">A</mi><mn id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">1</mn></msub><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">⊙</mo><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3a" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2a" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">J</mi></mrow></mrow><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="A6.E7Xe.2.1.1.m1.1.1.1.2b" xref="A6.E7Xe.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msub id="A6.E7Xe.2.1.1.m1.1.1.1.5" xref="A6.E7Xe.2.1.1.m1.1.1.1.5.cmml"><mi id="A6.E7Xe.2.1.1.m1.1.1.1.5.2" xref="A6.E7Xe.2.1.1.m1.1.1.1.5.2.cmml">K</mi><mn id="A6.E7Xe.2.1.1.m1.1.1.1.5.3" xref="A6.E7Xe.2.1.1.m1.1.1.1.5.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xe.2.1.1.m1.1b"><apply id="A6.E7Xe.2.1.1.m1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1"><eq id="A6.E7Xe.2.1.1.m1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E7Xe.2.1.1.m1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E7Xe.2.1.1.m1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1"><times id="A6.E7Xe.2.1.1.m1.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.2"></times><apply id="A6.E7Xe.2.1.1.m1.1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xe.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.3">continued-fraction</csymbol><cn id="A6.E7Xe.2.1.1.m1.1.1.1.3.2.cmml" type="integer" xref="A6.E7Xe.2.1.1.m1.1.1.1.3.2">1</cn><apply id="A6.E7Xe.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.3.3"><root id="A6.E7Xe.2.1.1.m1.1.1.1.3.3a.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.3.3"></root><ci id="A6.E7Xe.2.1.1.m1.1.1.1.3.3.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.3.3.2">𝑑</ci></apply></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.4.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xe.2.1.1.m1.1.1.1.4.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xe.2.1.1.m1.1.1.1.4.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.4.2">𝑋</ci><ci id="A6.E7Xe.2.1.1.m1.1.1.1.4.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.4.3">⊺</ci></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E7Xe.2.1.1.m1.1.1.1.1.2.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.2">𝐴</ci><cn id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1"><minus id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><times id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2"><partialdiff id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3"><partialdiff id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3">⊺</ci></apply></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"><times id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">direct-product</csymbol><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝐴</ci><cn id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" type="integer" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3">1</cn></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><times id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2"></times><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2"><partialdiff id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3"><partialdiff id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3">⊺</ci></apply></apply></apply><ci id="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝐽</ci></apply></apply></apply></apply><apply id="A6.E7Xe.2.1.1.m1.1.1.1.5.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.5"><csymbol cd="ambiguous" id="A6.E7Xe.2.1.1.m1.1.1.1.5.1.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.5">subscript</csymbol><ci id="A6.E7Xe.2.1.1.m1.1.1.1.5.2.cmml" xref="A6.E7Xe.2.1.1.m1.1.1.1.5.2">𝐾</ci><cn id="A6.E7Xe.2.1.1.m1.1.1.1.5.3.cmml" type="integer" xref="A6.E7Xe.2.1.1.m1.1.1.1.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xe.2.1.1.m1.1c">\displaystyle=\cfrac{1}{\sqrt{d}}~{}X^{\intercal}[A_{1}\odot(\cfrac{\partial L%
}{\partial O}(W^{O})^{\intercal}V^{\intercal}-(A_{1}\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]K_{1}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xe.2.1.1.m1.1d">= continued-fraction start_ARG 1 end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG italic_X start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT [ italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT - ( italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT ) ) italic_J ) ] italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xf">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{Q_{2}}}" class="ltx_Math" display="inline" id="A6.E7Xf.2.1.1.m1.1"><semantics id="A6.E7Xf.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E7Xf.2.1.1.m1.1.1" xref="A6.E7Xf.2.1.1.m1.1.1.cmml"><mfrac id="A6.E7Xf.2.1.1.m1.1.1a" xref="A6.E7Xf.2.1.1.m1.1.1.cmml"><mrow id="A6.E7Xf.2.1.1.m1.1.1.2" xref="A6.E7Xf.2.1.1.m1.1.1.2.cmml"><mo id="A6.E7Xf.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E7Xf.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E7Xf.2.1.1.m1.1.1.2.2" xref="A6.E7Xf.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xf.2.1.1.m1.1.1.3" xref="A6.E7Xf.2.1.1.m1.1.1.3.cmml"><mo id="A6.E7Xf.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E7Xf.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E7Xf.2.1.1.m1.1.1.3.2" xref="A6.E7Xf.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E7Xf.2.1.1.m1.1.1.3.2.2" xref="A6.E7Xf.2.1.1.m1.1.1.3.2.2.cmml">W</mi><msub id="A6.E7Xf.2.1.1.m1.1.1.3.2.3" xref="A6.E7Xf.2.1.1.m1.1.1.3.2.3.cmml"><mi id="A6.E7Xf.2.1.1.m1.1.1.3.2.3.2" xref="A6.E7Xf.2.1.1.m1.1.1.3.2.3.2.cmml">Q</mi><mn id="A6.E7Xf.2.1.1.m1.1.1.3.2.3.3" xref="A6.E7Xf.2.1.1.m1.1.1.3.2.3.3.cmml">2</mn></msub></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E7Xf.2.1.1.m1.1b"><apply id="A6.E7Xf.2.1.1.m1.1.1.cmml" xref="A6.E7Xf.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E7Xf.2.1.1.m1.1.1.1.cmml" xref="A6.E7Xf.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E7Xf.2.1.1.m1.1.1.2.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.2"><partialdiff id="A6.E7Xf.2.1.1.m1.1.1.2.1.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E7Xf.2.1.1.m1.1.1.2.2.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E7Xf.2.1.1.m1.1.1.3.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.3"><partialdiff id="A6.E7Xf.2.1.1.m1.1.1.3.1.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E7Xf.2.1.1.m1.1.1.3.2.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E7Xf.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E7Xf.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.3.2.2">𝑊</ci><apply id="A6.E7Xf.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A6.E7Xf.2.1.1.m1.1.1.3.2.3.1.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="A6.E7Xf.2.1.1.m1.1.1.3.2.3.2.cmml" xref="A6.E7Xf.2.1.1.m1.1.1.3.2.3.2">𝑄</ci><cn id="A6.E7Xf.2.1.1.m1.1.1.3.2.3.3.cmml" type="integer" xref="A6.E7Xf.2.1.1.m1.1.1.3.2.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xf.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{Q_{2}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xf.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A_{2}}%
\cfrac{\partial A_{2}}{\partial Q_{2}}\cfrac{\partial Q_{2}}{\partial W^{Q_{2}}}" class="ltx_Math" display="inline" id="A6.E7Xf.3.2.2.m1.1"><semantics id="A6.E7Xf.3.2.2.m1.1a"><mrow id="A6.E7Xf.3.2.2.m1.1.1" xref="A6.E7Xf.3.2.2.m1.1.1.cmml"><mi id="A6.E7Xf.3.2.2.m1.1.1.2" xref="A6.E7Xf.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E7Xf.3.2.2.m1.1.1.1" xref="A6.E7Xf.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E7Xf.3.2.2.m1.1.1.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E7Xf.3.2.2.m1.1.1.3.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E7Xf.3.2.2.m1.1.1.3.2a" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E7Xf.3.2.2.m1.1.1.3.2.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E7Xf.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E7Xf.3.2.2.m1.1.1.3.2.2.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xf.3.2.2.m1.1.1.3.2.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E7Xf.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E7Xf.3.2.2.m1.1.1.3.2.3.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xf.3.2.2.m1.1.1.3.1" xref="A6.E7Xf.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xf.3.2.2.m1.1.1.3.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E7Xf.3.2.2.m1.1.1.3.3a" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E7Xf.3.2.2.m1.1.1.3.3.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E7Xf.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E7Xf.3.2.2.m1.1.1.3.3.2.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E7Xf.3.2.2.m1.1.1.3.3.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E7Xf.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><msub id="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.cmml"><mi id="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.2.cmml">A</mi><mn id="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo id="A6.E7Xf.3.2.2.m1.1.1.3.1a" xref="A6.E7Xf.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xf.3.2.2.m1.1.1.3.4" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.cmml"><mfrac id="A6.E7Xf.3.2.2.m1.1.1.3.4a" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.cmml"><mrow id="A6.E7Xf.3.2.2.m1.1.1.3.4.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2.cmml"><mo id="A6.E7Xf.3.2.2.m1.1.1.3.4.2.1" rspace="0em" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2.1.cmml">∂</mo><msub id="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.cmml"><mi id="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.2.cmml">A</mi><mn id="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.3.cmml">2</mn></msub></mrow><mrow id="A6.E7Xf.3.2.2.m1.1.1.3.4.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3.cmml"><mo id="A6.E7Xf.3.2.2.m1.1.1.3.4.3.1" rspace="0em" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3.1.cmml">∂</mo><msub id="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.cmml"><mi id="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.2.cmml">Q</mi><mn id="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo id="A6.E7Xf.3.2.2.m1.1.1.3.1b" xref="A6.E7Xf.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xf.3.2.2.m1.1.1.3.5" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.cmml"><mfrac id="A6.E7Xf.3.2.2.m1.1.1.3.5a" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.cmml"><mrow id="A6.E7Xf.3.2.2.m1.1.1.3.5.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2.cmml"><mo id="A6.E7Xf.3.2.2.m1.1.1.3.5.2.1" rspace="0em" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2.1.cmml">∂</mo><msub id="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.cmml"><mi id="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.2.cmml">Q</mi><mn id="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.3.cmml">2</mn></msub></mrow><mrow id="A6.E7Xf.3.2.2.m1.1.1.3.5.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.cmml"><mo id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.1" rspace="0em" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.1.cmml">∂</mo><msup id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.cmml"><mi id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.2.cmml">W</mi><msub id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.cmml"><mi id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.2" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.2.cmml">Q</mi><mn id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.3" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.3.cmml">2</mn></msub></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xf.3.2.2.m1.1b"><apply id="A6.E7Xf.3.2.2.m1.1.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1"><eq id="A6.E7Xf.3.2.2.m1.1.1.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E7Xf.3.2.2.m1.1.1.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E7Xf.3.2.2.m1.1.1.3.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3"><times id="A6.E7Xf.3.2.2.m1.1.1.3.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.1"></times><apply id="A6.E7Xf.3.2.2.m1.1.1.3.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E7Xf.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E7Xf.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E7Xf.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E7Xf.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E7Xf.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E7Xf.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E7Xf.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xf.3.2.2.m1.1.1.3.3.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E7Xf.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E7Xf.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E7Xf.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E7Xf.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E7Xf.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E7Xf.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3.1"></partialdiff><apply id="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2">subscript</csymbol><ci id="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.2">𝐴</ci><cn id="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.3.cmml" type="integer" xref="A6.E7Xf.3.2.2.m1.1.1.3.3.3.2.3">2</cn></apply></apply></apply><apply id="A6.E7Xf.3.2.2.m1.1.1.3.4.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4"><csymbol cd="latexml" id="A6.E7Xf.3.2.2.m1.1.1.3.4.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4">continued-fraction</csymbol><apply id="A6.E7Xf.3.2.2.m1.1.1.3.4.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2"><partialdiff id="A6.E7Xf.3.2.2.m1.1.1.3.4.2.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2.1"></partialdiff><apply id="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2"><csymbol cd="ambiguous" id="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2">subscript</csymbol><ci id="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.2">𝐴</ci><cn id="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.3.cmml" type="integer" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.2.2.3">2</cn></apply></apply><apply id="A6.E7Xf.3.2.2.m1.1.1.3.4.3.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3"><partialdiff id="A6.E7Xf.3.2.2.m1.1.1.3.4.3.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3.1"></partialdiff><apply id="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2"><csymbol cd="ambiguous" id="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2">subscript</csymbol><ci id="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.2">𝑄</ci><cn id="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.3.cmml" type="integer" xref="A6.E7Xf.3.2.2.m1.1.1.3.4.3.2.3">2</cn></apply></apply></apply><apply id="A6.E7Xf.3.2.2.m1.1.1.3.5.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5"><csymbol cd="latexml" id="A6.E7Xf.3.2.2.m1.1.1.3.5.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5">continued-fraction</csymbol><apply id="A6.E7Xf.3.2.2.m1.1.1.3.5.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2"><partialdiff id="A6.E7Xf.3.2.2.m1.1.1.3.5.2.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2.1"></partialdiff><apply id="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2"><csymbol cd="ambiguous" id="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2">subscript</csymbol><ci id="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.2">𝑄</ci><cn id="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.3.cmml" type="integer" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.2.2.3">2</cn></apply></apply><apply id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3"><partialdiff id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.1"></partialdiff><apply id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2"><csymbol cd="ambiguous" id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2">superscript</csymbol><ci id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.2">𝑊</ci><apply id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3"><csymbol cd="ambiguous" id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.1.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3">subscript</csymbol><ci id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.2.cmml" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.2">𝑄</ci><cn id="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.3.cmml" type="integer" xref="A6.E7Xf.3.2.2.m1.1.1.3.5.3.2.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xf.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A_{2}}%
\cfrac{\partial A_{2}}{\partial Q_{2}}\cfrac{\partial Q_{2}}{\partial W^{Q_{2}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xf.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xg">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{-\lambda}{\sqrt{d}}~{}X^{\intercal}[A_{2}\odot(\cfrac{%
\partial L}{\partial O}(W^{O})^{\intercal}V^{\intercal}-(A_{2}\odot(\cfrac{%
\partial L}{\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]K_{2}" class="ltx_Math" display="inline" id="A6.E7Xg.2.1.1.m1.1"><semantics id="A6.E7Xg.2.1.1.m1.1a"><mrow id="A6.E7Xg.2.1.1.m1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.cmml"><mi id="A6.E7Xg.2.1.1.m1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E7Xg.2.1.1.m1.1.1.2" xref="A6.E7Xg.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E7Xg.2.1.1.m1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xg.2.1.1.m1.1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.cmml"><mfrac id="A6.E7Xg.2.1.1.m1.1.1.1.3a" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.cmml"><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.3.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.2.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.3.2a" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.2.cmml">−</mo><mi id="A6.E7Xg.2.1.1.m1.1.1.1.3.2.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.2.2.cmml">λ</mi></mrow><msqrt id="A6.E7Xg.2.1.1.m1.1.1.1.3.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.3.cmml"><mi id="A6.E7Xg.2.1.1.m1.1.1.1.3.3.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="A6.E7Xg.2.1.1.m1.1.1.1.2" lspace="0.330em" xref="A6.E7Xg.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xg.2.1.1.m1.1.1.1.4" xref="A6.E7Xg.2.1.1.m1.1.1.1.4.cmml"><mi id="A6.E7Xg.2.1.1.m1.1.1.1.4.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.4.2.cmml">X</mi><mo id="A6.E7Xg.2.1.1.m1.1.1.1.4.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.4.3.cmml">⊺</mo></msup><mo id="A6.E7Xg.2.1.1.m1.1.1.1.2a" xref="A6.E7Xg.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.2.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.cmml"><msub id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">A</mi><mn id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3a" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2a" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><msub id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">A</mi><mn id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">2</mn></msub><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">⊙</mo><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3a" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2a" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">J</mi></mrow></mrow><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="A6.E7Xg.2.1.1.m1.1.1.1.2b" xref="A6.E7Xg.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msub id="A6.E7Xg.2.1.1.m1.1.1.1.5" xref="A6.E7Xg.2.1.1.m1.1.1.1.5.cmml"><mi id="A6.E7Xg.2.1.1.m1.1.1.1.5.2" xref="A6.E7Xg.2.1.1.m1.1.1.1.5.2.cmml">K</mi><mn id="A6.E7Xg.2.1.1.m1.1.1.1.5.3" xref="A6.E7Xg.2.1.1.m1.1.1.1.5.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xg.2.1.1.m1.1b"><apply id="A6.E7Xg.2.1.1.m1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1"><eq id="A6.E7Xg.2.1.1.m1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E7Xg.2.1.1.m1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E7Xg.2.1.1.m1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1"><times id="A6.E7Xg.2.1.1.m1.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.2"></times><apply id="A6.E7Xg.2.1.1.m1.1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xg.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xg.2.1.1.m1.1.1.1.3.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.2"><minus id="A6.E7Xg.2.1.1.m1.1.1.1.3.2.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.2"></minus><ci id="A6.E7Xg.2.1.1.m1.1.1.1.3.2.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.2.2">𝜆</ci></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.3"><root id="A6.E7Xg.2.1.1.m1.1.1.1.3.3a.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.3"></root><ci id="A6.E7Xg.2.1.1.m1.1.1.1.3.3.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.3.3.2">𝑑</ci></apply></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.4.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xg.2.1.1.m1.1.1.1.4.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xg.2.1.1.m1.1.1.1.4.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.4.2">𝑋</ci><ci id="A6.E7Xg.2.1.1.m1.1.1.1.4.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.4.3">⊺</ci></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E7Xg.2.1.1.m1.1.1.1.1.2.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.2">𝐴</ci><cn id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1"><minus id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><times id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2"><partialdiff id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3"><partialdiff id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3">⊺</ci></apply></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"><times id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">direct-product</csymbol><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝐴</ci><cn id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" type="integer" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3">2</cn></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><times id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2"></times><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2"><partialdiff id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3"><partialdiff id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3">⊺</ci></apply></apply></apply><ci id="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝐽</ci></apply></apply></apply></apply><apply id="A6.E7Xg.2.1.1.m1.1.1.1.5.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.5"><csymbol cd="ambiguous" id="A6.E7Xg.2.1.1.m1.1.1.1.5.1.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.5">subscript</csymbol><ci id="A6.E7Xg.2.1.1.m1.1.1.1.5.2.cmml" xref="A6.E7Xg.2.1.1.m1.1.1.1.5.2">𝐾</ci><cn id="A6.E7Xg.2.1.1.m1.1.1.1.5.3.cmml" type="integer" xref="A6.E7Xg.2.1.1.m1.1.1.1.5.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xg.2.1.1.m1.1c">\displaystyle=\cfrac{-\lambda}{\sqrt{d}}~{}X^{\intercal}[A_{2}\odot(\cfrac{%
\partial L}{\partial O}(W^{O})^{\intercal}V^{\intercal}-(A_{2}\odot(\cfrac{%
\partial L}{\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]K_{2}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xg.2.1.1.m1.1d">= continued-fraction start_ARG - italic_λ end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG italic_X start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT [ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT - ( italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT ) ) italic_J ) ] italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xh">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{K_{1}}}" class="ltx_Math" display="inline" id="A6.E7Xh.2.1.1.m1.1"><semantics id="A6.E7Xh.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E7Xh.2.1.1.m1.1.1" xref="A6.E7Xh.2.1.1.m1.1.1.cmml"><mfrac id="A6.E7Xh.2.1.1.m1.1.1a" xref="A6.E7Xh.2.1.1.m1.1.1.cmml"><mrow id="A6.E7Xh.2.1.1.m1.1.1.2" xref="A6.E7Xh.2.1.1.m1.1.1.2.cmml"><mo id="A6.E7Xh.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E7Xh.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E7Xh.2.1.1.m1.1.1.2.2" xref="A6.E7Xh.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xh.2.1.1.m1.1.1.3" xref="A6.E7Xh.2.1.1.m1.1.1.3.cmml"><mo id="A6.E7Xh.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E7Xh.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E7Xh.2.1.1.m1.1.1.3.2" xref="A6.E7Xh.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E7Xh.2.1.1.m1.1.1.3.2.2" xref="A6.E7Xh.2.1.1.m1.1.1.3.2.2.cmml">W</mi><msub id="A6.E7Xh.2.1.1.m1.1.1.3.2.3" xref="A6.E7Xh.2.1.1.m1.1.1.3.2.3.cmml"><mi id="A6.E7Xh.2.1.1.m1.1.1.3.2.3.2" xref="A6.E7Xh.2.1.1.m1.1.1.3.2.3.2.cmml">K</mi><mn id="A6.E7Xh.2.1.1.m1.1.1.3.2.3.3" xref="A6.E7Xh.2.1.1.m1.1.1.3.2.3.3.cmml">1</mn></msub></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E7Xh.2.1.1.m1.1b"><apply id="A6.E7Xh.2.1.1.m1.1.1.cmml" xref="A6.E7Xh.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E7Xh.2.1.1.m1.1.1.1.cmml" xref="A6.E7Xh.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E7Xh.2.1.1.m1.1.1.2.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.2"><partialdiff id="A6.E7Xh.2.1.1.m1.1.1.2.1.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E7Xh.2.1.1.m1.1.1.2.2.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E7Xh.2.1.1.m1.1.1.3.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.3"><partialdiff id="A6.E7Xh.2.1.1.m1.1.1.3.1.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E7Xh.2.1.1.m1.1.1.3.2.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E7Xh.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E7Xh.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.3.2.2">𝑊</ci><apply id="A6.E7Xh.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A6.E7Xh.2.1.1.m1.1.1.3.2.3.1.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="A6.E7Xh.2.1.1.m1.1.1.3.2.3.2.cmml" xref="A6.E7Xh.2.1.1.m1.1.1.3.2.3.2">𝐾</ci><cn id="A6.E7Xh.2.1.1.m1.1.1.3.2.3.3.cmml" type="integer" xref="A6.E7Xh.2.1.1.m1.1.1.3.2.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xh.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{K_{1}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xh.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A_{1}}%
\cfrac{\partial A_{1}}{\partial K_{1}}\cfrac{\partial K_{1}}{\partial W^{K_{1}}}" class="ltx_Math" display="inline" id="A6.E7Xh.3.2.2.m1.1"><semantics id="A6.E7Xh.3.2.2.m1.1a"><mrow id="A6.E7Xh.3.2.2.m1.1.1" xref="A6.E7Xh.3.2.2.m1.1.1.cmml"><mi id="A6.E7Xh.3.2.2.m1.1.1.2" xref="A6.E7Xh.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E7Xh.3.2.2.m1.1.1.1" xref="A6.E7Xh.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E7Xh.3.2.2.m1.1.1.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E7Xh.3.2.2.m1.1.1.3.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E7Xh.3.2.2.m1.1.1.3.2a" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E7Xh.3.2.2.m1.1.1.3.2.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E7Xh.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E7Xh.3.2.2.m1.1.1.3.2.2.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xh.3.2.2.m1.1.1.3.2.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E7Xh.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E7Xh.3.2.2.m1.1.1.3.2.3.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xh.3.2.2.m1.1.1.3.1" xref="A6.E7Xh.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xh.3.2.2.m1.1.1.3.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E7Xh.3.2.2.m1.1.1.3.3a" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E7Xh.3.2.2.m1.1.1.3.3.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E7Xh.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E7Xh.3.2.2.m1.1.1.3.3.2.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E7Xh.3.2.2.m1.1.1.3.3.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E7Xh.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><msub id="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.cmml"><mi id="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.2.cmml">A</mi><mn id="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.3.cmml">1</mn></msub></mrow></mfrac></mstyle><mo id="A6.E7Xh.3.2.2.m1.1.1.3.1a" xref="A6.E7Xh.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xh.3.2.2.m1.1.1.3.4" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.cmml"><mfrac id="A6.E7Xh.3.2.2.m1.1.1.3.4a" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.cmml"><mrow id="A6.E7Xh.3.2.2.m1.1.1.3.4.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2.cmml"><mo id="A6.E7Xh.3.2.2.m1.1.1.3.4.2.1" rspace="0em" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2.1.cmml">∂</mo><msub id="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.cmml"><mi id="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.2.cmml">A</mi><mn id="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.3.cmml">1</mn></msub></mrow><mrow id="A6.E7Xh.3.2.2.m1.1.1.3.4.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3.cmml"><mo id="A6.E7Xh.3.2.2.m1.1.1.3.4.3.1" rspace="0em" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3.1.cmml">∂</mo><msub id="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.cmml"><mi id="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.2.cmml">K</mi><mn id="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.3.cmml">1</mn></msub></mrow></mfrac></mstyle><mo id="A6.E7Xh.3.2.2.m1.1.1.3.1b" xref="A6.E7Xh.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xh.3.2.2.m1.1.1.3.5" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.cmml"><mfrac id="A6.E7Xh.3.2.2.m1.1.1.3.5a" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.cmml"><mrow id="A6.E7Xh.3.2.2.m1.1.1.3.5.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2.cmml"><mo id="A6.E7Xh.3.2.2.m1.1.1.3.5.2.1" rspace="0em" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2.1.cmml">∂</mo><msub id="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.cmml"><mi id="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.2.cmml">K</mi><mn id="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.3.cmml">1</mn></msub></mrow><mrow id="A6.E7Xh.3.2.2.m1.1.1.3.5.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.cmml"><mo id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.1" rspace="0em" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.1.cmml">∂</mo><msup id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.cmml"><mi id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.2.cmml">W</mi><msub id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.cmml"><mi id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.2" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.2.cmml">K</mi><mn id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.3" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.3.cmml">1</mn></msub></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xh.3.2.2.m1.1b"><apply id="A6.E7Xh.3.2.2.m1.1.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1"><eq id="A6.E7Xh.3.2.2.m1.1.1.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E7Xh.3.2.2.m1.1.1.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E7Xh.3.2.2.m1.1.1.3.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3"><times id="A6.E7Xh.3.2.2.m1.1.1.3.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.1"></times><apply id="A6.E7Xh.3.2.2.m1.1.1.3.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E7Xh.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E7Xh.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E7Xh.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E7Xh.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E7Xh.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E7Xh.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E7Xh.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xh.3.2.2.m1.1.1.3.3.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E7Xh.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E7Xh.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E7Xh.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E7Xh.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E7Xh.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E7Xh.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3.1"></partialdiff><apply id="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2">subscript</csymbol><ci id="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.2">𝐴</ci><cn id="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.3.cmml" type="integer" xref="A6.E7Xh.3.2.2.m1.1.1.3.3.3.2.3">1</cn></apply></apply></apply><apply id="A6.E7Xh.3.2.2.m1.1.1.3.4.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4"><csymbol cd="latexml" id="A6.E7Xh.3.2.2.m1.1.1.3.4.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4">continued-fraction</csymbol><apply id="A6.E7Xh.3.2.2.m1.1.1.3.4.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2"><partialdiff id="A6.E7Xh.3.2.2.m1.1.1.3.4.2.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2.1"></partialdiff><apply id="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2"><csymbol cd="ambiguous" id="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2">subscript</csymbol><ci id="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.2">𝐴</ci><cn id="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.3.cmml" type="integer" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.2.2.3">1</cn></apply></apply><apply id="A6.E7Xh.3.2.2.m1.1.1.3.4.3.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3"><partialdiff id="A6.E7Xh.3.2.2.m1.1.1.3.4.3.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3.1"></partialdiff><apply id="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2"><csymbol cd="ambiguous" id="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2">subscript</csymbol><ci id="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.2">𝐾</ci><cn id="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.3.cmml" type="integer" xref="A6.E7Xh.3.2.2.m1.1.1.3.4.3.2.3">1</cn></apply></apply></apply><apply id="A6.E7Xh.3.2.2.m1.1.1.3.5.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5"><csymbol cd="latexml" id="A6.E7Xh.3.2.2.m1.1.1.3.5.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5">continued-fraction</csymbol><apply id="A6.E7Xh.3.2.2.m1.1.1.3.5.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2"><partialdiff id="A6.E7Xh.3.2.2.m1.1.1.3.5.2.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2.1"></partialdiff><apply id="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2"><csymbol cd="ambiguous" id="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2">subscript</csymbol><ci id="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.2">𝐾</ci><cn id="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.3.cmml" type="integer" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.2.2.3">1</cn></apply></apply><apply id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3"><partialdiff id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.1"></partialdiff><apply id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2"><csymbol cd="ambiguous" id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2">superscript</csymbol><ci id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.2">𝑊</ci><apply id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3"><csymbol cd="ambiguous" id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.1.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3">subscript</csymbol><ci id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.2.cmml" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.2">𝐾</ci><cn id="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.3.cmml" type="integer" xref="A6.E7Xh.3.2.2.m1.1.1.3.5.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xh.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A_{1}}%
\cfrac{\partial A_{1}}{\partial K_{1}}\cfrac{\partial K_{1}}{\partial W^{K_{1}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xh.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xi">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{1}{\sqrt{d}}~{}X^{\intercal}[A_{1}\odot(\cfrac{\partial L%
}{\partial O}(W^{O})^{\intercal}V^{\intercal}-(A_{1}\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]^{\intercal}Q_{1}" class="ltx_Math" display="inline" id="A6.E7Xi.2.1.1.m1.1"><semantics id="A6.E7Xi.2.1.1.m1.1a"><mrow id="A6.E7Xi.2.1.1.m1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.cmml"><mi id="A6.E7Xi.2.1.1.m1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E7Xi.2.1.1.m1.1.1.2" xref="A6.E7Xi.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E7Xi.2.1.1.m1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xi.2.1.1.m1.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.3.cmml"><mfrac id="A6.E7Xi.2.1.1.m1.1.1.1.3a" xref="A6.E7Xi.2.1.1.m1.1.1.1.3.cmml"><mn id="A6.E7Xi.2.1.1.m1.1.1.1.3.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.3.2.cmml">1</mn><msqrt id="A6.E7Xi.2.1.1.m1.1.1.1.3.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.3.3.cmml"><mi id="A6.E7Xi.2.1.1.m1.1.1.1.3.3.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.3.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="A6.E7Xi.2.1.1.m1.1.1.1.2" lspace="0.330em" xref="A6.E7Xi.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xi.2.1.1.m1.1.1.1.4" xref="A6.E7Xi.2.1.1.m1.1.1.1.4.cmml"><mi id="A6.E7Xi.2.1.1.m1.1.1.1.4.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.4.2.cmml">X</mi><mo id="A6.E7Xi.2.1.1.m1.1.1.1.4.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.4.3.cmml">⊺</mo></msup><mo id="A6.E7Xi.2.1.1.m1.1.1.1.2a" xref="A6.E7Xi.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xi.2.1.1.m1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.cmml"><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.2.cmml"><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.cmml"><msub id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">A</mi><mn id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3a" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><msub id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">A</mi><mn id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">1</mn></msub><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">⊙</mo><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3a" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2a" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">J</mi></mrow></mrow><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="A6.E7Xi.2.1.1.m1.1.1.1.1.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xi.2.1.1.m1.1.1.1.2b" xref="A6.E7Xi.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msub id="A6.E7Xi.2.1.1.m1.1.1.1.5" xref="A6.E7Xi.2.1.1.m1.1.1.1.5.cmml"><mi id="A6.E7Xi.2.1.1.m1.1.1.1.5.2" xref="A6.E7Xi.2.1.1.m1.1.1.1.5.2.cmml">Q</mi><mn id="A6.E7Xi.2.1.1.m1.1.1.1.5.3" xref="A6.E7Xi.2.1.1.m1.1.1.1.5.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xi.2.1.1.m1.1b"><apply id="A6.E7Xi.2.1.1.m1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1"><eq id="A6.E7Xi.2.1.1.m1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E7Xi.2.1.1.m1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E7Xi.2.1.1.m1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1"><times id="A6.E7Xi.2.1.1.m1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.2"></times><apply id="A6.E7Xi.2.1.1.m1.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xi.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.3">continued-fraction</csymbol><cn id="A6.E7Xi.2.1.1.m1.1.1.1.3.2.cmml" type="integer" xref="A6.E7Xi.2.1.1.m1.1.1.1.3.2">1</cn><apply id="A6.E7Xi.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.3.3"><root id="A6.E7Xi.2.1.1.m1.1.1.1.3.3a.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.3.3"></root><ci id="A6.E7Xi.2.1.1.m1.1.1.1.3.3.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.3.3.2">𝑑</ci></apply></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.4.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.4.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xi.2.1.1.m1.1.1.1.4.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.4.2">𝑋</ci><ci id="A6.E7Xi.2.1.1.m1.1.1.1.4.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.4.3">⊺</ci></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.2">𝐴</ci><cn id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1"><minus id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2"><partialdiff id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><partialdiff id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3">⊺</ci></apply></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"><times id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">direct-product</csymbol><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝐴</ci><cn id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" type="integer" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3">1</cn></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><times id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2"></times><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2"><partialdiff id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3"><partialdiff id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3">⊺</ci></apply></apply></apply><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝐽</ci></apply></apply></apply></apply><ci id="A6.E7Xi.2.1.1.m1.1.1.1.1.3.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xi.2.1.1.m1.1.1.1.5.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.5"><csymbol cd="ambiguous" id="A6.E7Xi.2.1.1.m1.1.1.1.5.1.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.5">subscript</csymbol><ci id="A6.E7Xi.2.1.1.m1.1.1.1.5.2.cmml" xref="A6.E7Xi.2.1.1.m1.1.1.1.5.2">𝑄</ci><cn id="A6.E7Xi.2.1.1.m1.1.1.1.5.3.cmml" type="integer" xref="A6.E7Xi.2.1.1.m1.1.1.1.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xi.2.1.1.m1.1c">\displaystyle=\cfrac{1}{\sqrt{d}}~{}X^{\intercal}[A_{1}\odot(\cfrac{\partial L%
}{\partial O}(W^{O})^{\intercal}V^{\intercal}-(A_{1}\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]^{\intercal}Q_{1}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xi.2.1.1.m1.1d">= continued-fraction start_ARG 1 end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG italic_X start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT [ italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT - ( italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT ) ) italic_J ) ] start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xj">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{K_{2}}}" class="ltx_Math" display="inline" id="A6.E7Xj.2.1.1.m1.1"><semantics id="A6.E7Xj.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E7Xj.2.1.1.m1.1.1" xref="A6.E7Xj.2.1.1.m1.1.1.cmml"><mfrac id="A6.E7Xj.2.1.1.m1.1.1a" xref="A6.E7Xj.2.1.1.m1.1.1.cmml"><mrow id="A6.E7Xj.2.1.1.m1.1.1.2" xref="A6.E7Xj.2.1.1.m1.1.1.2.cmml"><mo id="A6.E7Xj.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E7Xj.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E7Xj.2.1.1.m1.1.1.2.2" xref="A6.E7Xj.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xj.2.1.1.m1.1.1.3" xref="A6.E7Xj.2.1.1.m1.1.1.3.cmml"><mo id="A6.E7Xj.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E7Xj.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E7Xj.2.1.1.m1.1.1.3.2" xref="A6.E7Xj.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E7Xj.2.1.1.m1.1.1.3.2.2" xref="A6.E7Xj.2.1.1.m1.1.1.3.2.2.cmml">W</mi><msub id="A6.E7Xj.2.1.1.m1.1.1.3.2.3" xref="A6.E7Xj.2.1.1.m1.1.1.3.2.3.cmml"><mi id="A6.E7Xj.2.1.1.m1.1.1.3.2.3.2" xref="A6.E7Xj.2.1.1.m1.1.1.3.2.3.2.cmml">K</mi><mn id="A6.E7Xj.2.1.1.m1.1.1.3.2.3.3" xref="A6.E7Xj.2.1.1.m1.1.1.3.2.3.3.cmml">2</mn></msub></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E7Xj.2.1.1.m1.1b"><apply id="A6.E7Xj.2.1.1.m1.1.1.cmml" xref="A6.E7Xj.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E7Xj.2.1.1.m1.1.1.1.cmml" xref="A6.E7Xj.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E7Xj.2.1.1.m1.1.1.2.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.2"><partialdiff id="A6.E7Xj.2.1.1.m1.1.1.2.1.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E7Xj.2.1.1.m1.1.1.2.2.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E7Xj.2.1.1.m1.1.1.3.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.3"><partialdiff id="A6.E7Xj.2.1.1.m1.1.1.3.1.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E7Xj.2.1.1.m1.1.1.3.2.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E7Xj.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E7Xj.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.3.2.2">𝑊</ci><apply id="A6.E7Xj.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A6.E7Xj.2.1.1.m1.1.1.3.2.3.1.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="A6.E7Xj.2.1.1.m1.1.1.3.2.3.2.cmml" xref="A6.E7Xj.2.1.1.m1.1.1.3.2.3.2">𝐾</ci><cn id="A6.E7Xj.2.1.1.m1.1.1.3.2.3.3.cmml" type="integer" xref="A6.E7Xj.2.1.1.m1.1.1.3.2.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xj.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{K_{2}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xj.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A_{2}}%
\cfrac{\partial A_{2}}{\partial K_{2}}\cfrac{\partial K_{2}}{\partial W^{K_{2}}}" class="ltx_Math" display="inline" id="A6.E7Xj.3.2.2.m1.1"><semantics id="A6.E7Xj.3.2.2.m1.1a"><mrow id="A6.E7Xj.3.2.2.m1.1.1" xref="A6.E7Xj.3.2.2.m1.1.1.cmml"><mi id="A6.E7Xj.3.2.2.m1.1.1.2" xref="A6.E7Xj.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E7Xj.3.2.2.m1.1.1.1" xref="A6.E7Xj.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E7Xj.3.2.2.m1.1.1.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E7Xj.3.2.2.m1.1.1.3.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E7Xj.3.2.2.m1.1.1.3.2a" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E7Xj.3.2.2.m1.1.1.3.2.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E7Xj.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E7Xj.3.2.2.m1.1.1.3.2.2.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xj.3.2.2.m1.1.1.3.2.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E7Xj.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E7Xj.3.2.2.m1.1.1.3.2.3.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xj.3.2.2.m1.1.1.3.1" xref="A6.E7Xj.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xj.3.2.2.m1.1.1.3.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E7Xj.3.2.2.m1.1.1.3.3a" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E7Xj.3.2.2.m1.1.1.3.3.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E7Xj.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E7Xj.3.2.2.m1.1.1.3.3.2.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E7Xj.3.2.2.m1.1.1.3.3.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E7Xj.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><msub id="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.cmml"><mi id="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.2.cmml">A</mi><mn id="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo id="A6.E7Xj.3.2.2.m1.1.1.3.1a" xref="A6.E7Xj.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xj.3.2.2.m1.1.1.3.4" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.cmml"><mfrac id="A6.E7Xj.3.2.2.m1.1.1.3.4a" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.cmml"><mrow id="A6.E7Xj.3.2.2.m1.1.1.3.4.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2.cmml"><mo id="A6.E7Xj.3.2.2.m1.1.1.3.4.2.1" rspace="0em" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2.1.cmml">∂</mo><msub id="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.cmml"><mi id="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.2.cmml">A</mi><mn id="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.3.cmml">2</mn></msub></mrow><mrow id="A6.E7Xj.3.2.2.m1.1.1.3.4.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3.cmml"><mo id="A6.E7Xj.3.2.2.m1.1.1.3.4.3.1" rspace="0em" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3.1.cmml">∂</mo><msub id="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.cmml"><mi id="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.2.cmml">K</mi><mn id="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo id="A6.E7Xj.3.2.2.m1.1.1.3.1b" xref="A6.E7Xj.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E7Xj.3.2.2.m1.1.1.3.5" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.cmml"><mfrac id="A6.E7Xj.3.2.2.m1.1.1.3.5a" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.cmml"><mrow id="A6.E7Xj.3.2.2.m1.1.1.3.5.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2.cmml"><mo id="A6.E7Xj.3.2.2.m1.1.1.3.5.2.1" rspace="0em" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2.1.cmml">∂</mo><msub id="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.cmml"><mi id="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.2.cmml">K</mi><mn id="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.3.cmml">2</mn></msub></mrow><mrow id="A6.E7Xj.3.2.2.m1.1.1.3.5.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.cmml"><mo id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.1" rspace="0em" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.1.cmml">∂</mo><msup id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.cmml"><mi id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.2.cmml">W</mi><msub id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.cmml"><mi id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.2" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.2.cmml">K</mi><mn id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.3" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.3.cmml">2</mn></msub></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xj.3.2.2.m1.1b"><apply id="A6.E7Xj.3.2.2.m1.1.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1"><eq id="A6.E7Xj.3.2.2.m1.1.1.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E7Xj.3.2.2.m1.1.1.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E7Xj.3.2.2.m1.1.1.3.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3"><times id="A6.E7Xj.3.2.2.m1.1.1.3.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.1"></times><apply id="A6.E7Xj.3.2.2.m1.1.1.3.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E7Xj.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E7Xj.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E7Xj.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E7Xj.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E7Xj.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E7Xj.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E7Xj.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xj.3.2.2.m1.1.1.3.3.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E7Xj.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E7Xj.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E7Xj.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E7Xj.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E7Xj.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E7Xj.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3.1"></partialdiff><apply id="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2">subscript</csymbol><ci id="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.2">𝐴</ci><cn id="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.3.cmml" type="integer" xref="A6.E7Xj.3.2.2.m1.1.1.3.3.3.2.3">2</cn></apply></apply></apply><apply id="A6.E7Xj.3.2.2.m1.1.1.3.4.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4"><csymbol cd="latexml" id="A6.E7Xj.3.2.2.m1.1.1.3.4.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4">continued-fraction</csymbol><apply id="A6.E7Xj.3.2.2.m1.1.1.3.4.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2"><partialdiff id="A6.E7Xj.3.2.2.m1.1.1.3.4.2.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2.1"></partialdiff><apply id="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2"><csymbol cd="ambiguous" id="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2">subscript</csymbol><ci id="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.2">𝐴</ci><cn id="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.3.cmml" type="integer" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.2.2.3">2</cn></apply></apply><apply id="A6.E7Xj.3.2.2.m1.1.1.3.4.3.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3"><partialdiff id="A6.E7Xj.3.2.2.m1.1.1.3.4.3.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3.1"></partialdiff><apply id="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2"><csymbol cd="ambiguous" id="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2">subscript</csymbol><ci id="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.2">𝐾</ci><cn id="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.3.cmml" type="integer" xref="A6.E7Xj.3.2.2.m1.1.1.3.4.3.2.3">2</cn></apply></apply></apply><apply id="A6.E7Xj.3.2.2.m1.1.1.3.5.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5"><csymbol cd="latexml" id="A6.E7Xj.3.2.2.m1.1.1.3.5.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5">continued-fraction</csymbol><apply id="A6.E7Xj.3.2.2.m1.1.1.3.5.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2"><partialdiff id="A6.E7Xj.3.2.2.m1.1.1.3.5.2.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2.1"></partialdiff><apply id="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2"><csymbol cd="ambiguous" id="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2">subscript</csymbol><ci id="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.2">𝐾</ci><cn id="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.3.cmml" type="integer" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.2.2.3">2</cn></apply></apply><apply id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3"><partialdiff id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.1"></partialdiff><apply id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2"><csymbol cd="ambiguous" id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2">superscript</csymbol><ci id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.2">𝑊</ci><apply id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3"><csymbol cd="ambiguous" id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.1.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3">subscript</csymbol><ci id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.2.cmml" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.2">𝐾</ci><cn id="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.3.cmml" type="integer" xref="A6.E7Xj.3.2.2.m1.1.1.3.5.3.2.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xj.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A_{2}}%
\cfrac{\partial A_{2}}{\partial K_{2}}\cfrac{\partial K_{2}}{\partial W^{K_{2}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xj.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E7Xk">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{-\lambda}{\sqrt{d}}~{}X^{\intercal}[A_{2}\odot(\cfrac{%
\partial L}{\partial O}(W^{O})^{\intercal}V^{\intercal}-(A_{2}\odot(\cfrac{%
\partial L}{\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]^{\intercal}Q_{2}" class="ltx_Math" display="inline" id="A6.E7Xk.2.1.1.m1.1"><semantics id="A6.E7Xk.2.1.1.m1.1a"><mrow id="A6.E7Xk.2.1.1.m1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.cmml"><mi id="A6.E7Xk.2.1.1.m1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E7Xk.2.1.1.m1.1.1.2" xref="A6.E7Xk.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E7Xk.2.1.1.m1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xk.2.1.1.m1.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.cmml"><mfrac id="A6.E7Xk.2.1.1.m1.1.1.1.3a" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.cmml"><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.3.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.2.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.3.2a" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.2.cmml">−</mo><mi id="A6.E7Xk.2.1.1.m1.1.1.1.3.2.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.2.2.cmml">λ</mi></mrow><msqrt id="A6.E7Xk.2.1.1.m1.1.1.1.3.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.3.cmml"><mi id="A6.E7Xk.2.1.1.m1.1.1.1.3.3.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="A6.E7Xk.2.1.1.m1.1.1.1.2" lspace="0.330em" xref="A6.E7Xk.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xk.2.1.1.m1.1.1.1.4" xref="A6.E7Xk.2.1.1.m1.1.1.1.4.cmml"><mi id="A6.E7Xk.2.1.1.m1.1.1.1.4.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.4.2.cmml">X</mi><mo id="A6.E7Xk.2.1.1.m1.1.1.1.4.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.4.3.cmml">⊺</mo></msup><mo id="A6.E7Xk.2.1.1.m1.1.1.1.2a" xref="A6.E7Xk.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xk.2.1.1.m1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.cmml"><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.2.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.cmml"><msub id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">A</mi><mn id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3a" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><msub id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">A</mi><mn id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">2</mn></msub><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">⊙</mo><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3a" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2a" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">J</mi></mrow></mrow><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="A6.E7Xk.2.1.1.m1.1.1.1.1.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E7Xk.2.1.1.m1.1.1.1.2b" xref="A6.E7Xk.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msub id="A6.E7Xk.2.1.1.m1.1.1.1.5" xref="A6.E7Xk.2.1.1.m1.1.1.1.5.cmml"><mi id="A6.E7Xk.2.1.1.m1.1.1.1.5.2" xref="A6.E7Xk.2.1.1.m1.1.1.1.5.2.cmml">Q</mi><mn id="A6.E7Xk.2.1.1.m1.1.1.1.5.3" xref="A6.E7Xk.2.1.1.m1.1.1.1.5.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E7Xk.2.1.1.m1.1b"><apply id="A6.E7Xk.2.1.1.m1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1"><eq id="A6.E7Xk.2.1.1.m1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E7Xk.2.1.1.m1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E7Xk.2.1.1.m1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1"><times id="A6.E7Xk.2.1.1.m1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.2"></times><apply id="A6.E7Xk.2.1.1.m1.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xk.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xk.2.1.1.m1.1.1.1.3.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.2"><minus id="A6.E7Xk.2.1.1.m1.1.1.1.3.2.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.2"></minus><ci id="A6.E7Xk.2.1.1.m1.1.1.1.3.2.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.2.2">𝜆</ci></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.3"><root id="A6.E7Xk.2.1.1.m1.1.1.1.3.3a.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.3"></root><ci id="A6.E7Xk.2.1.1.m1.1.1.1.3.3.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.3.3.2">𝑑</ci></apply></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.4.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.4.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xk.2.1.1.m1.1.1.1.4.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.4.2">𝑋</ci><ci id="A6.E7Xk.2.1.1.m1.1.1.1.4.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.4.3">⊺</ci></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.2">𝐴</ci><cn id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1"><minus id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2"><partialdiff id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><partialdiff id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3">⊺</ci></apply></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"><times id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">direct-product</csymbol><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝐴</ci><cn id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" type="integer" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3">2</cn></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><times id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2"></times><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2"><partialdiff id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3"><partialdiff id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3">⊺</ci></apply></apply></apply><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝐽</ci></apply></apply></apply></apply><ci id="A6.E7Xk.2.1.1.m1.1.1.1.1.3.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E7Xk.2.1.1.m1.1.1.1.5.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.5"><csymbol cd="ambiguous" id="A6.E7Xk.2.1.1.m1.1.1.1.5.1.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.5">subscript</csymbol><ci id="A6.E7Xk.2.1.1.m1.1.1.1.5.2.cmml" xref="A6.E7Xk.2.1.1.m1.1.1.1.5.2">𝑄</ci><cn id="A6.E7Xk.2.1.1.m1.1.1.1.5.3.cmml" type="integer" xref="A6.E7Xk.2.1.1.m1.1.1.1.5.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E7Xk.2.1.1.m1.1c">\displaystyle=\cfrac{-\lambda}{\sqrt{d}}~{}X^{\intercal}[A_{2}\odot(\cfrac{%
\partial L}{\partial O}(W^{O})^{\intercal}V^{\intercal}-(A_{2}\odot(\cfrac{%
\partial L}{\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]^{\intercal}Q_{2}</annotation><annotation encoding="application/x-llamapun" id="A6.E7Xk.2.1.1.m1.1d">= continued-fraction start_ARG - italic_λ end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG italic_X start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT [ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT - ( italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT ) ) italic_J ) ] start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A6.p2.13">where <math alttext="J\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="A6.p2.13.m1.1"><semantics id="A6.p2.13.m1.1a"><mrow id="A6.p2.13.m1.1.1" xref="A6.p2.13.m1.1.1.cmml"><mi id="A6.p2.13.m1.1.1.2" xref="A6.p2.13.m1.1.1.2.cmml">J</mi><mo id="A6.p2.13.m1.1.1.1" xref="A6.p2.13.m1.1.1.1.cmml">∈</mo><msup id="A6.p2.13.m1.1.1.3" xref="A6.p2.13.m1.1.1.3.cmml"><mi id="A6.p2.13.m1.1.1.3.2" xref="A6.p2.13.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A6.p2.13.m1.1.1.3.3" xref="A6.p2.13.m1.1.1.3.3.cmml"><mi id="A6.p2.13.m1.1.1.3.3.2" xref="A6.p2.13.m1.1.1.3.3.2.cmml">N</mi><mo id="A6.p2.13.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p2.13.m1.1.1.3.3.1.cmml">×</mo><mi id="A6.p2.13.m1.1.1.3.3.3" xref="A6.p2.13.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A6.p2.13.m1.1b"><apply id="A6.p2.13.m1.1.1.cmml" xref="A6.p2.13.m1.1.1"><in id="A6.p2.13.m1.1.1.1.cmml" xref="A6.p2.13.m1.1.1.1"></in><ci id="A6.p2.13.m1.1.1.2.cmml" xref="A6.p2.13.m1.1.1.2">𝐽</ci><apply id="A6.p2.13.m1.1.1.3.cmml" xref="A6.p2.13.m1.1.1.3"><csymbol cd="ambiguous" id="A6.p2.13.m1.1.1.3.1.cmml" xref="A6.p2.13.m1.1.1.3">superscript</csymbol><ci id="A6.p2.13.m1.1.1.3.2.cmml" xref="A6.p2.13.m1.1.1.3.2">ℝ</ci><apply id="A6.p2.13.m1.1.1.3.3.cmml" xref="A6.p2.13.m1.1.1.3.3"><times id="A6.p2.13.m1.1.1.3.3.1.cmml" xref="A6.p2.13.m1.1.1.3.3.1"></times><ci id="A6.p2.13.m1.1.1.3.3.2.cmml" xref="A6.p2.13.m1.1.1.3.3.2">𝑁</ci><ci id="A6.p2.13.m1.1.1.3.3.3.cmml" xref="A6.p2.13.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.13.m1.1c">J\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="A6.p2.13.m1.1d">italic_J ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> is a all-one matrix.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.p3">
<p class="ltx_p" id="A6.p3.5">As a comparison, we reformulate conventional <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="A6.p3.1.m1.1"><semantics id="A6.p3.1.m1.1a"><mi id="A6.p3.1.m1.1.1" xref="A6.p3.1.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="A6.p3.1.m1.1b"><ci id="A6.p3.1.m1.1.1.cmml" xref="A6.p3.1.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p3.1.m1.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="A6.p3.1.m1.1d">roman_softmax</annotation></semantics></math> attention. For attention with <math alttext="2d" class="ltx_Math" display="inline" id="A6.p3.2.m2.1"><semantics id="A6.p3.2.m2.1a"><mrow id="A6.p3.2.m2.1.1" xref="A6.p3.2.m2.1.1.cmml"><mn id="A6.p3.2.m2.1.1.2" xref="A6.p3.2.m2.1.1.2.cmml">2</mn><mo id="A6.p3.2.m2.1.1.1" xref="A6.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="A6.p3.2.m2.1.1.3" xref="A6.p3.2.m2.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="A6.p3.2.m2.1b"><apply id="A6.p3.2.m2.1.1.cmml" xref="A6.p3.2.m2.1.1"><times id="A6.p3.2.m2.1.1.1.cmml" xref="A6.p3.2.m2.1.1.1"></times><cn id="A6.p3.2.m2.1.1.2.cmml" type="integer" xref="A6.p3.2.m2.1.1.2">2</cn><ci id="A6.p3.2.m2.1.1.3.cmml" xref="A6.p3.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p3.2.m2.1c">2d</annotation><annotation encoding="application/x-llamapun" id="A6.p3.2.m2.1d">2 italic_d</annotation></semantics></math> dimension, we have <math alttext="X\in\mathbb{R}^{N\times d_{\text{model}}}" class="ltx_Math" display="inline" id="A6.p3.3.m3.1"><semantics id="A6.p3.3.m3.1a"><mrow id="A6.p3.3.m3.1.1" xref="A6.p3.3.m3.1.1.cmml"><mi id="A6.p3.3.m3.1.1.2" xref="A6.p3.3.m3.1.1.2.cmml">X</mi><mo id="A6.p3.3.m3.1.1.1" xref="A6.p3.3.m3.1.1.1.cmml">∈</mo><msup id="A6.p3.3.m3.1.1.3" xref="A6.p3.3.m3.1.1.3.cmml"><mi id="A6.p3.3.m3.1.1.3.2" xref="A6.p3.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="A6.p3.3.m3.1.1.3.3" xref="A6.p3.3.m3.1.1.3.3.cmml"><mi id="A6.p3.3.m3.1.1.3.3.2" xref="A6.p3.3.m3.1.1.3.3.2.cmml">N</mi><mo id="A6.p3.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p3.3.m3.1.1.3.3.1.cmml">×</mo><msub id="A6.p3.3.m3.1.1.3.3.3" xref="A6.p3.3.m3.1.1.3.3.3.cmml"><mi id="A6.p3.3.m3.1.1.3.3.3.2" xref="A6.p3.3.m3.1.1.3.3.3.2.cmml">d</mi><mtext id="A6.p3.3.m3.1.1.3.3.3.3" xref="A6.p3.3.m3.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A6.p3.3.m3.1b"><apply id="A6.p3.3.m3.1.1.cmml" xref="A6.p3.3.m3.1.1"><in id="A6.p3.3.m3.1.1.1.cmml" xref="A6.p3.3.m3.1.1.1"></in><ci id="A6.p3.3.m3.1.1.2.cmml" xref="A6.p3.3.m3.1.1.2">𝑋</ci><apply id="A6.p3.3.m3.1.1.3.cmml" xref="A6.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="A6.p3.3.m3.1.1.3.1.cmml" xref="A6.p3.3.m3.1.1.3">superscript</csymbol><ci id="A6.p3.3.m3.1.1.3.2.cmml" xref="A6.p3.3.m3.1.1.3.2">ℝ</ci><apply id="A6.p3.3.m3.1.1.3.3.cmml" xref="A6.p3.3.m3.1.1.3.3"><times id="A6.p3.3.m3.1.1.3.3.1.cmml" xref="A6.p3.3.m3.1.1.3.3.1"></times><ci id="A6.p3.3.m3.1.1.3.3.2.cmml" xref="A6.p3.3.m3.1.1.3.3.2">𝑁</ci><apply id="A6.p3.3.m3.1.1.3.3.3.cmml" xref="A6.p3.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="A6.p3.3.m3.1.1.3.3.3.1.cmml" xref="A6.p3.3.m3.1.1.3.3.3">subscript</csymbol><ci id="A6.p3.3.m3.1.1.3.3.3.2.cmml" xref="A6.p3.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="A6.p3.3.m3.1.1.3.3.3.3a.cmml" xref="A6.p3.3.m3.1.1.3.3.3.3"><mtext id="A6.p3.3.m3.1.1.3.3.3.3.cmml" mathsize="50%" xref="A6.p3.3.m3.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p3.3.m3.1c">X\in\mathbb{R}^{N\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A6.p3.3.m3.1d">italic_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as the input, <math alttext="Q_{1},Q_{2},K_{1},K_{2}\in\mathbb{R}^{N\times d},\ V\in\mathbb{R}^{N\times 2d}" class="ltx_Math" display="inline" id="A6.p3.4.m4.2"><semantics id="A6.p3.4.m4.2a"><mrow id="A6.p3.4.m4.2.2.2" xref="A6.p3.4.m4.2.2.3.cmml"><mrow id="A6.p3.4.m4.1.1.1.1" xref="A6.p3.4.m4.1.1.1.1.cmml"><mrow id="A6.p3.4.m4.1.1.1.1.4.4" xref="A6.p3.4.m4.1.1.1.1.4.5.cmml"><msub id="A6.p3.4.m4.1.1.1.1.1.1.1" xref="A6.p3.4.m4.1.1.1.1.1.1.1.cmml"><mi id="A6.p3.4.m4.1.1.1.1.1.1.1.2" xref="A6.p3.4.m4.1.1.1.1.1.1.1.2.cmml">Q</mi><mn id="A6.p3.4.m4.1.1.1.1.1.1.1.3" xref="A6.p3.4.m4.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A6.p3.4.m4.1.1.1.1.4.4.5" xref="A6.p3.4.m4.1.1.1.1.4.5.cmml">,</mo><msub id="A6.p3.4.m4.1.1.1.1.2.2.2" xref="A6.p3.4.m4.1.1.1.1.2.2.2.cmml"><mi id="A6.p3.4.m4.1.1.1.1.2.2.2.2" xref="A6.p3.4.m4.1.1.1.1.2.2.2.2.cmml">Q</mi><mn id="A6.p3.4.m4.1.1.1.1.2.2.2.3" xref="A6.p3.4.m4.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="A6.p3.4.m4.1.1.1.1.4.4.6" xref="A6.p3.4.m4.1.1.1.1.4.5.cmml">,</mo><msub id="A6.p3.4.m4.1.1.1.1.3.3.3" xref="A6.p3.4.m4.1.1.1.1.3.3.3.cmml"><mi id="A6.p3.4.m4.1.1.1.1.3.3.3.2" xref="A6.p3.4.m4.1.1.1.1.3.3.3.2.cmml">K</mi><mn id="A6.p3.4.m4.1.1.1.1.3.3.3.3" xref="A6.p3.4.m4.1.1.1.1.3.3.3.3.cmml">1</mn></msub><mo id="A6.p3.4.m4.1.1.1.1.4.4.7" xref="A6.p3.4.m4.1.1.1.1.4.5.cmml">,</mo><msub id="A6.p3.4.m4.1.1.1.1.4.4.4" xref="A6.p3.4.m4.1.1.1.1.4.4.4.cmml"><mi id="A6.p3.4.m4.1.1.1.1.4.4.4.2" xref="A6.p3.4.m4.1.1.1.1.4.4.4.2.cmml">K</mi><mn id="A6.p3.4.m4.1.1.1.1.4.4.4.3" xref="A6.p3.4.m4.1.1.1.1.4.4.4.3.cmml">2</mn></msub></mrow><mo id="A6.p3.4.m4.1.1.1.1.5" xref="A6.p3.4.m4.1.1.1.1.5.cmml">∈</mo><msup id="A6.p3.4.m4.1.1.1.1.6" xref="A6.p3.4.m4.1.1.1.1.6.cmml"><mi id="A6.p3.4.m4.1.1.1.1.6.2" xref="A6.p3.4.m4.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="A6.p3.4.m4.1.1.1.1.6.3" xref="A6.p3.4.m4.1.1.1.1.6.3.cmml"><mi id="A6.p3.4.m4.1.1.1.1.6.3.2" xref="A6.p3.4.m4.1.1.1.1.6.3.2.cmml">N</mi><mo id="A6.p3.4.m4.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p3.4.m4.1.1.1.1.6.3.1.cmml">×</mo><mi id="A6.p3.4.m4.1.1.1.1.6.3.3" xref="A6.p3.4.m4.1.1.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><mo id="A6.p3.4.m4.2.2.2.3" rspace="0.667em" xref="A6.p3.4.m4.2.2.3a.cmml">,</mo><mrow id="A6.p3.4.m4.2.2.2.2" xref="A6.p3.4.m4.2.2.2.2.cmml"><mi id="A6.p3.4.m4.2.2.2.2.2" xref="A6.p3.4.m4.2.2.2.2.2.cmml">V</mi><mo id="A6.p3.4.m4.2.2.2.2.1" xref="A6.p3.4.m4.2.2.2.2.1.cmml">∈</mo><msup id="A6.p3.4.m4.2.2.2.2.3" xref="A6.p3.4.m4.2.2.2.2.3.cmml"><mi id="A6.p3.4.m4.2.2.2.2.3.2" xref="A6.p3.4.m4.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="A6.p3.4.m4.2.2.2.2.3.3" xref="A6.p3.4.m4.2.2.2.2.3.3.cmml"><mrow id="A6.p3.4.m4.2.2.2.2.3.3.2" xref="A6.p3.4.m4.2.2.2.2.3.3.2.cmml"><mi id="A6.p3.4.m4.2.2.2.2.3.3.2.2" xref="A6.p3.4.m4.2.2.2.2.3.3.2.2.cmml">N</mi><mo id="A6.p3.4.m4.2.2.2.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A6.p3.4.m4.2.2.2.2.3.3.2.1.cmml">×</mo><mn id="A6.p3.4.m4.2.2.2.2.3.3.2.3" xref="A6.p3.4.m4.2.2.2.2.3.3.2.3.cmml">2</mn></mrow><mo id="A6.p3.4.m4.2.2.2.2.3.3.1" xref="A6.p3.4.m4.2.2.2.2.3.3.1.cmml">⁢</mo><mi id="A6.p3.4.m4.2.2.2.2.3.3.3" xref="A6.p3.4.m4.2.2.2.2.3.3.3.cmml">d</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p3.4.m4.2b"><apply id="A6.p3.4.m4.2.2.3.cmml" xref="A6.p3.4.m4.2.2.2"><csymbol cd="ambiguous" id="A6.p3.4.m4.2.2.3a.cmml" xref="A6.p3.4.m4.2.2.2.3">formulae-sequence</csymbol><apply id="A6.p3.4.m4.1.1.1.1.cmml" xref="A6.p3.4.m4.1.1.1.1"><in id="A6.p3.4.m4.1.1.1.1.5.cmml" xref="A6.p3.4.m4.1.1.1.1.5"></in><list id="A6.p3.4.m4.1.1.1.1.4.5.cmml" xref="A6.p3.4.m4.1.1.1.1.4.4"><apply id="A6.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="A6.p3.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.p3.4.m4.1.1.1.1.1.1.1.1.cmml" xref="A6.p3.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="A6.p3.4.m4.1.1.1.1.1.1.1.2.cmml" xref="A6.p3.4.m4.1.1.1.1.1.1.1.2">𝑄</ci><cn id="A6.p3.4.m4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A6.p3.4.m4.1.1.1.1.1.1.1.3">1</cn></apply><apply id="A6.p3.4.m4.1.1.1.1.2.2.2.cmml" xref="A6.p3.4.m4.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A6.p3.4.m4.1.1.1.1.2.2.2.1.cmml" xref="A6.p3.4.m4.1.1.1.1.2.2.2">subscript</csymbol><ci id="A6.p3.4.m4.1.1.1.1.2.2.2.2.cmml" xref="A6.p3.4.m4.1.1.1.1.2.2.2.2">𝑄</ci><cn id="A6.p3.4.m4.1.1.1.1.2.2.2.3.cmml" type="integer" xref="A6.p3.4.m4.1.1.1.1.2.2.2.3">2</cn></apply><apply id="A6.p3.4.m4.1.1.1.1.3.3.3.cmml" xref="A6.p3.4.m4.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A6.p3.4.m4.1.1.1.1.3.3.3.1.cmml" xref="A6.p3.4.m4.1.1.1.1.3.3.3">subscript</csymbol><ci id="A6.p3.4.m4.1.1.1.1.3.3.3.2.cmml" xref="A6.p3.4.m4.1.1.1.1.3.3.3.2">𝐾</ci><cn id="A6.p3.4.m4.1.1.1.1.3.3.3.3.cmml" type="integer" xref="A6.p3.4.m4.1.1.1.1.3.3.3.3">1</cn></apply><apply id="A6.p3.4.m4.1.1.1.1.4.4.4.cmml" xref="A6.p3.4.m4.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="A6.p3.4.m4.1.1.1.1.4.4.4.1.cmml" xref="A6.p3.4.m4.1.1.1.1.4.4.4">subscript</csymbol><ci id="A6.p3.4.m4.1.1.1.1.4.4.4.2.cmml" xref="A6.p3.4.m4.1.1.1.1.4.4.4.2">𝐾</ci><cn id="A6.p3.4.m4.1.1.1.1.4.4.4.3.cmml" type="integer" xref="A6.p3.4.m4.1.1.1.1.4.4.4.3">2</cn></apply></list><apply id="A6.p3.4.m4.1.1.1.1.6.cmml" xref="A6.p3.4.m4.1.1.1.1.6"><csymbol cd="ambiguous" id="A6.p3.4.m4.1.1.1.1.6.1.cmml" xref="A6.p3.4.m4.1.1.1.1.6">superscript</csymbol><ci id="A6.p3.4.m4.1.1.1.1.6.2.cmml" xref="A6.p3.4.m4.1.1.1.1.6.2">ℝ</ci><apply id="A6.p3.4.m4.1.1.1.1.6.3.cmml" xref="A6.p3.4.m4.1.1.1.1.6.3"><times id="A6.p3.4.m4.1.1.1.1.6.3.1.cmml" xref="A6.p3.4.m4.1.1.1.1.6.3.1"></times><ci id="A6.p3.4.m4.1.1.1.1.6.3.2.cmml" xref="A6.p3.4.m4.1.1.1.1.6.3.2">𝑁</ci><ci id="A6.p3.4.m4.1.1.1.1.6.3.3.cmml" xref="A6.p3.4.m4.1.1.1.1.6.3.3">𝑑</ci></apply></apply></apply><apply id="A6.p3.4.m4.2.2.2.2.cmml" xref="A6.p3.4.m4.2.2.2.2"><in id="A6.p3.4.m4.2.2.2.2.1.cmml" xref="A6.p3.4.m4.2.2.2.2.1"></in><ci id="A6.p3.4.m4.2.2.2.2.2.cmml" xref="A6.p3.4.m4.2.2.2.2.2">𝑉</ci><apply id="A6.p3.4.m4.2.2.2.2.3.cmml" xref="A6.p3.4.m4.2.2.2.2.3"><csymbol cd="ambiguous" id="A6.p3.4.m4.2.2.2.2.3.1.cmml" xref="A6.p3.4.m4.2.2.2.2.3">superscript</csymbol><ci id="A6.p3.4.m4.2.2.2.2.3.2.cmml" xref="A6.p3.4.m4.2.2.2.2.3.2">ℝ</ci><apply id="A6.p3.4.m4.2.2.2.2.3.3.cmml" xref="A6.p3.4.m4.2.2.2.2.3.3"><times id="A6.p3.4.m4.2.2.2.2.3.3.1.cmml" xref="A6.p3.4.m4.2.2.2.2.3.3.1"></times><apply id="A6.p3.4.m4.2.2.2.2.3.3.2.cmml" xref="A6.p3.4.m4.2.2.2.2.3.3.2"><times id="A6.p3.4.m4.2.2.2.2.3.3.2.1.cmml" xref="A6.p3.4.m4.2.2.2.2.3.3.2.1"></times><ci id="A6.p3.4.m4.2.2.2.2.3.3.2.2.cmml" xref="A6.p3.4.m4.2.2.2.2.3.3.2.2">𝑁</ci><cn id="A6.p3.4.m4.2.2.2.2.3.3.2.3.cmml" type="integer" xref="A6.p3.4.m4.2.2.2.2.3.3.2.3">2</cn></apply><ci id="A6.p3.4.m4.2.2.2.2.3.3.3.cmml" xref="A6.p3.4.m4.2.2.2.2.3.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p3.4.m4.2c">Q_{1},Q_{2},K_{1},K_{2}\in\mathbb{R}^{N\times d},\ V\in\mathbb{R}^{N\times 2d}</annotation><annotation encoding="application/x-llamapun" id="A6.p3.4.m4.2d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT , italic_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × 2 italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="O\in\mathbb{R}^{N\times d_{\text{model}}}" class="ltx_Math" display="inline" id="A6.p3.5.m5.1"><semantics id="A6.p3.5.m5.1a"><mrow id="A6.p3.5.m5.1.1" xref="A6.p3.5.m5.1.1.cmml"><mi id="A6.p3.5.m5.1.1.2" xref="A6.p3.5.m5.1.1.2.cmml">O</mi><mo id="A6.p3.5.m5.1.1.1" xref="A6.p3.5.m5.1.1.1.cmml">∈</mo><msup id="A6.p3.5.m5.1.1.3" xref="A6.p3.5.m5.1.1.3.cmml"><mi id="A6.p3.5.m5.1.1.3.2" xref="A6.p3.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="A6.p3.5.m5.1.1.3.3" xref="A6.p3.5.m5.1.1.3.3.cmml"><mi id="A6.p3.5.m5.1.1.3.3.2" xref="A6.p3.5.m5.1.1.3.3.2.cmml">N</mi><mo id="A6.p3.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p3.5.m5.1.1.3.3.1.cmml">×</mo><msub id="A6.p3.5.m5.1.1.3.3.3" xref="A6.p3.5.m5.1.1.3.3.3.cmml"><mi id="A6.p3.5.m5.1.1.3.3.3.2" xref="A6.p3.5.m5.1.1.3.3.3.2.cmml">d</mi><mtext id="A6.p3.5.m5.1.1.3.3.3.3" xref="A6.p3.5.m5.1.1.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A6.p3.5.m5.1b"><apply id="A6.p3.5.m5.1.1.cmml" xref="A6.p3.5.m5.1.1"><in id="A6.p3.5.m5.1.1.1.cmml" xref="A6.p3.5.m5.1.1.1"></in><ci id="A6.p3.5.m5.1.1.2.cmml" xref="A6.p3.5.m5.1.1.2">𝑂</ci><apply id="A6.p3.5.m5.1.1.3.cmml" xref="A6.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="A6.p3.5.m5.1.1.3.1.cmml" xref="A6.p3.5.m5.1.1.3">superscript</csymbol><ci id="A6.p3.5.m5.1.1.3.2.cmml" xref="A6.p3.5.m5.1.1.3.2">ℝ</ci><apply id="A6.p3.5.m5.1.1.3.3.cmml" xref="A6.p3.5.m5.1.1.3.3"><times id="A6.p3.5.m5.1.1.3.3.1.cmml" xref="A6.p3.5.m5.1.1.3.3.1"></times><ci id="A6.p3.5.m5.1.1.3.3.2.cmml" xref="A6.p3.5.m5.1.1.3.3.2">𝑁</ci><apply id="A6.p3.5.m5.1.1.3.3.3.cmml" xref="A6.p3.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="A6.p3.5.m5.1.1.3.3.3.1.cmml" xref="A6.p3.5.m5.1.1.3.3.3">subscript</csymbol><ci id="A6.p3.5.m5.1.1.3.3.3.2.cmml" xref="A6.p3.5.m5.1.1.3.3.3.2">𝑑</ci><ci id="A6.p3.5.m5.1.1.3.3.3.3a.cmml" xref="A6.p3.5.m5.1.1.3.3.3.3"><mtext id="A6.p3.5.m5.1.1.3.3.3.3.cmml" mathsize="50%" xref="A6.p3.5.m5.1.1.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p3.5.m5.1c">O\in\mathbb{R}^{N\times d_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A6.p3.5.m5.1d">italic_O ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as the output:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A6.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{gathered}[Q_{1};Q_{2}]=[XW^{Q_{1}};XW^{Q_{2}}],\quad[K_{1};K_{2}]=[XW^{%
K_{1}};XW^{K_{2}}],\quad V=XW^{V}\\
A=\mathrm{softmax}(\frac{Q_{1}K^{T}_{1}+Q_{2}K^{T}_{2}}{\sqrt{2d}})\\
O=(AV)W^{O}\end{gathered}" class="ltx_math_unparsed" display="block" id="A6.E8.m1.58"><semantics id="A6.E8.m1.58a"><mtable displaystyle="true" id="A6.E8.m1.58.58.3" rowspacing="0pt"><mtr id="A6.E8.m1.58.58.3a"><mtd id="A6.E8.m1.58.58.3b"><mrow id="A6.E8.m1.57.57.2.57.43.43.43"><mrow id="A6.E8.m1.56.56.1.56.42.42.42.1"><mrow id="A6.E8.m1.56.56.1.56.42.42.42.1.2.2"><mo id="A6.E8.m1.1.1.1.1.1.1" stretchy="false">[</mo><msub id="A6.E8.m1.56.56.1.56.42.42.42.1.1.1.1"><mi id="A6.E8.m1.2.2.2.2.2.2">Q</mi><mn id="A6.E8.m1.3.3.3.3.3.3.1">1</mn></msub><mo id="A6.E8.m1.4.4.4.4.4.4">;</mo><msub id="A6.E8.m1.56.56.1.56.42.42.42.1.2.2.2"><mi id="A6.E8.m1.5.5.5.5.5.5">Q</mi><mn id="A6.E8.m1.6.6.6.6.6.6.1">2</mn></msub><mo id="A6.E8.m1.7.7.7.7.7.7" stretchy="false">]</mo></mrow><mo id="A6.E8.m1.8.8.8.8.8.8">=</mo><mrow id="A6.E8.m1.56.56.1.56.42.42.42.1.4.2"><mo id="A6.E8.m1.9.9.9.9.9.9" stretchy="false">[</mo><mrow id="A6.E8.m1.56.56.1.56.42.42.42.1.3.1.1"><mi id="A6.E8.m1.10.10.10.10.10.10">X</mi><mo id="A6.E8.m1.56.56.1.56.42.42.42.1.3.1.1.1">⁢</mo><msup id="A6.E8.m1.56.56.1.56.42.42.42.1.3.1.1.2"><mi id="A6.E8.m1.11.11.11.11.11.11">W</mi><msub id="A6.E8.m1.12.12.12.12.12.12.1"><mi id="A6.E8.m1.12.12.12.12.12.12.1.2">Q</mi><mn id="A6.E8.m1.12.12.12.12.12.12.1.3">1</mn></msub></msup></mrow><mo id="A6.E8.m1.13.13.13.13.13.13">;</mo><mrow id="A6.E8.m1.56.56.1.56.42.42.42.1.4.2.2"><mi id="A6.E8.m1.14.14.14.14.14.14">X</mi><mo id="A6.E8.m1.56.56.1.56.42.42.42.1.4.2.2.1">⁢</mo><msup id="A6.E8.m1.56.56.1.56.42.42.42.1.4.2.2.2"><mi id="A6.E8.m1.15.15.15.15.15.15">W</mi><msub id="A6.E8.m1.16.16.16.16.16.16.1"><mi id="A6.E8.m1.16.16.16.16.16.16.1.2">Q</mi><mn id="A6.E8.m1.16.16.16.16.16.16.1.3">2</mn></msub></msup></mrow><mo id="A6.E8.m1.17.17.17.17.17.17" stretchy="false">]</mo></mrow></mrow><mo id="A6.E8.m1.18.18.18.18.18.18" rspace="1.167em">,</mo><mrow id="A6.E8.m1.57.57.2.57.43.43.43.2"><mrow id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1"><mrow id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1.2.2"><mo id="A6.E8.m1.19.19.19.19.19.19" stretchy="false">[</mo><msub id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1.1.1.1"><mi id="A6.E8.m1.20.20.20.20.20.20">K</mi><mn id="A6.E8.m1.21.21.21.21.21.21.1">1</mn></msub><mo id="A6.E8.m1.22.22.22.22.22.22">;</mo><msub id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1.2.2.2"><mi id="A6.E8.m1.23.23.23.23.23.23">K</mi><mn id="A6.E8.m1.24.24.24.24.24.24.1">2</mn></msub><mo id="A6.E8.m1.25.25.25.25.25.25" stretchy="false">]</mo></mrow><mo id="A6.E8.m1.26.26.26.26.26.26">=</mo><mrow id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1.4.2"><mo id="A6.E8.m1.27.27.27.27.27.27" stretchy="false">[</mo><mrow id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1.3.1.1"><mi id="A6.E8.m1.28.28.28.28.28.28">X</mi><mo id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1.3.1.1.1">⁢</mo><msup id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1.3.1.1.2"><mi id="A6.E8.m1.29.29.29.29.29.29">W</mi><msub id="A6.E8.m1.30.30.30.30.30.30.1"><mi id="A6.E8.m1.30.30.30.30.30.30.1.2">K</mi><mn id="A6.E8.m1.30.30.30.30.30.30.1.3">1</mn></msub></msup></mrow><mo id="A6.E8.m1.31.31.31.31.31.31">;</mo><mrow id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1.4.2.2"><mi id="A6.E8.m1.32.32.32.32.32.32">X</mi><mo id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1.4.2.2.1">⁢</mo><msup id="A6.E8.m1.57.57.2.57.43.43.43.2.1.1.4.2.2.2"><mi id="A6.E8.m1.33.33.33.33.33.33">W</mi><msub id="A6.E8.m1.34.34.34.34.34.34.1"><mi id="A6.E8.m1.34.34.34.34.34.34.1.2">K</mi><mn id="A6.E8.m1.34.34.34.34.34.34.1.3">2</mn></msub></msup></mrow><mo id="A6.E8.m1.35.35.35.35.35.35" stretchy="false">]</mo></mrow></mrow><mo id="A6.E8.m1.36.36.36.36.36.36" rspace="1.167em">,</mo><mrow id="A6.E8.m1.57.57.2.57.43.43.43.2.2.2"><mi id="A6.E8.m1.37.37.37.37.37.37">V</mi><mo id="A6.E8.m1.38.38.38.38.38.38">=</mo><mrow id="A6.E8.m1.57.57.2.57.43.43.43.2.2.2.1"><mi id="A6.E8.m1.39.39.39.39.39.39">X</mi><mo id="A6.E8.m1.57.57.2.57.43.43.43.2.2.2.1.1">⁢</mo><msup id="A6.E8.m1.57.57.2.57.43.43.43.2.2.2.1.2"><mi id="A6.E8.m1.40.40.40.40.40.40">W</mi><mi id="A6.E8.m1.41.41.41.41.41.41.1">V</mi></msup></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="A6.E8.m1.58.58.3c"><mtd id="A6.E8.m1.58.58.3d"><mrow id="A6.E8.m1.47.47.47.6.6"><mi id="A6.E8.m1.42.42.42.1.1.1">A</mi><mo id="A6.E8.m1.43.43.43.2.2.2">=</mo><mrow id="A6.E8.m1.47.47.47.6.6.7"><mi id="A6.E8.m1.44.44.44.3.3.3">softmax</mi><mo id="A6.E8.m1.47.47.47.6.6.7.1">⁢</mo><mrow id="A6.E8.m1.47.47.47.6.6.7.2"><mo id="A6.E8.m1.45.45.45.4.4.4" stretchy="false">(</mo><mfrac id="A6.E8.m1.46.46.46.5.5.5"><mrow id="A6.E8.m1.46.46.46.5.5.5.2"><mrow id="A6.E8.m1.46.46.46.5.5.5.2.2"><msub id="A6.E8.m1.46.46.46.5.5.5.2.2.2"><mi id="A6.E8.m1.46.46.46.5.5.5.2.2.2.2">Q</mi><mn id="A6.E8.m1.46.46.46.5.5.5.2.2.2.3">1</mn></msub><mo id="A6.E8.m1.46.46.46.5.5.5.2.2.1">⁢</mo><msubsup id="A6.E8.m1.46.46.46.5.5.5.2.2.3"><mi id="A6.E8.m1.46.46.46.5.5.5.2.2.3.2.2">K</mi><mn id="A6.E8.m1.46.46.46.5.5.5.2.2.3.3">1</mn><mi id="A6.E8.m1.46.46.46.5.5.5.2.2.3.2.3">T</mi></msubsup></mrow><mo id="A6.E8.m1.46.46.46.5.5.5.2.1">+</mo><mrow id="A6.E8.m1.46.46.46.5.5.5.2.3"><msub id="A6.E8.m1.46.46.46.5.5.5.2.3.2"><mi id="A6.E8.m1.46.46.46.5.5.5.2.3.2.2">Q</mi><mn id="A6.E8.m1.46.46.46.5.5.5.2.3.2.3">2</mn></msub><mo id="A6.E8.m1.46.46.46.5.5.5.2.3.1">⁢</mo><msubsup id="A6.E8.m1.46.46.46.5.5.5.2.3.3"><mi id="A6.E8.m1.46.46.46.5.5.5.2.3.3.2.2">K</mi><mn id="A6.E8.m1.46.46.46.5.5.5.2.3.3.3">2</mn><mi id="A6.E8.m1.46.46.46.5.5.5.2.3.3.2.3">T</mi></msubsup></mrow></mrow><msqrt id="A6.E8.m1.46.46.46.5.5.5.3"><mrow id="A6.E8.m1.46.46.46.5.5.5.3.2"><mn id="A6.E8.m1.46.46.46.5.5.5.3.2.2">2</mn><mo id="A6.E8.m1.46.46.46.5.5.5.3.2.1">⁢</mo><mi id="A6.E8.m1.46.46.46.5.5.5.3.2.3">d</mi></mrow></msqrt></mfrac><mo id="A6.E8.m1.47.47.47.6.6.6" stretchy="false">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="A6.E8.m1.58.58.3e"><mtd id="A6.E8.m1.58.58.3f"><mrow id="A6.E8.m1.58.58.3.58.9.9"><mi id="A6.E8.m1.48.48.48.1.1.1">O</mi><mo id="A6.E8.m1.49.49.49.2.2.2">=</mo><mrow id="A6.E8.m1.58.58.3.58.9.9.9"><mrow id="A6.E8.m1.58.58.3.58.9.9.9.1.1"><mo id="A6.E8.m1.50.50.50.3.3.3" stretchy="false">(</mo><mrow id="A6.E8.m1.58.58.3.58.9.9.9.1.1.1"><mi id="A6.E8.m1.51.51.51.4.4.4">A</mi><mo id="A6.E8.m1.58.58.3.58.9.9.9.1.1.1.1">⁢</mo><mi id="A6.E8.m1.52.52.52.5.5.5">V</mi></mrow><mo id="A6.E8.m1.53.53.53.6.6.6" stretchy="false">)</mo></mrow><mo id="A6.E8.m1.58.58.3.58.9.9.9.2">⁢</mo><msup id="A6.E8.m1.58.58.3.58.9.9.9.3"><mi id="A6.E8.m1.54.54.54.7.7.7">W</mi><mi id="A6.E8.m1.55.55.55.8.8.8.1">O</mi></msup></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="A6.E8.m1.58b">\begin{gathered}[Q_{1};Q_{2}]=[XW^{Q_{1}};XW^{Q_{2}}],\quad[K_{1};K_{2}]=[XW^{%
K_{1}};XW^{K_{2}}],\quad V=XW^{V}\\
A=\mathrm{softmax}(\frac{Q_{1}K^{T}_{1}+Q_{2}K^{T}_{2}}{\sqrt{2d}})\\
O=(AV)W^{O}\end{gathered}</annotation><annotation encoding="application/x-llamapun" id="A6.E8.m1.58c">start_ROW start_CELL [ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] = [ italic_X italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ; italic_X italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ] , [ italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] = [ italic_X italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ; italic_X italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ] , italic_V = italic_X italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL italic_A = roman_softmax ( divide start_ARG italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG 2 italic_d end_ARG end_ARG ) end_CELL end_ROW start_ROW start_CELL italic_O = ( italic_A italic_V ) italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A6.p3.8">where <math alttext="W^{Q_{1}},W^{Q_{2}},W^{K_{1}},W^{K_{2}}\in\mathbb{R}^{d_{\text{model}}\times d%
},W^{V}\in\mathbb{R}^{d_{\text{model}}\times 2d},W^{O}\in\mathbb{R}^{2d\times d%
_{\text{model}}}" class="ltx_Math" display="inline" id="A6.p3.6.m1.2"><semantics id="A6.p3.6.m1.2a"><mrow id="A6.p3.6.m1.2.2.2" xref="A6.p3.6.m1.2.2.3.cmml"><mrow id="A6.p3.6.m1.1.1.1.1" xref="A6.p3.6.m1.1.1.1.1.cmml"><mrow id="A6.p3.6.m1.1.1.1.1.4.4" xref="A6.p3.6.m1.1.1.1.1.4.5.cmml"><msup id="A6.p3.6.m1.1.1.1.1.1.1.1" xref="A6.p3.6.m1.1.1.1.1.1.1.1.cmml"><mi id="A6.p3.6.m1.1.1.1.1.1.1.1.2" xref="A6.p3.6.m1.1.1.1.1.1.1.1.2.cmml">W</mi><msub id="A6.p3.6.m1.1.1.1.1.1.1.1.3" xref="A6.p3.6.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A6.p3.6.m1.1.1.1.1.1.1.1.3.2" xref="A6.p3.6.m1.1.1.1.1.1.1.1.3.2.cmml">Q</mi><mn id="A6.p3.6.m1.1.1.1.1.1.1.1.3.3" xref="A6.p3.6.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></msup><mo id="A6.p3.6.m1.1.1.1.1.4.4.5" xref="A6.p3.6.m1.1.1.1.1.4.5.cmml">,</mo><msup id="A6.p3.6.m1.1.1.1.1.2.2.2" xref="A6.p3.6.m1.1.1.1.1.2.2.2.cmml"><mi id="A6.p3.6.m1.1.1.1.1.2.2.2.2" xref="A6.p3.6.m1.1.1.1.1.2.2.2.2.cmml">W</mi><msub id="A6.p3.6.m1.1.1.1.1.2.2.2.3" xref="A6.p3.6.m1.1.1.1.1.2.2.2.3.cmml"><mi id="A6.p3.6.m1.1.1.1.1.2.2.2.3.2" xref="A6.p3.6.m1.1.1.1.1.2.2.2.3.2.cmml">Q</mi><mn id="A6.p3.6.m1.1.1.1.1.2.2.2.3.3" xref="A6.p3.6.m1.1.1.1.1.2.2.2.3.3.cmml">2</mn></msub></msup><mo id="A6.p3.6.m1.1.1.1.1.4.4.6" xref="A6.p3.6.m1.1.1.1.1.4.5.cmml">,</mo><msup id="A6.p3.6.m1.1.1.1.1.3.3.3" xref="A6.p3.6.m1.1.1.1.1.3.3.3.cmml"><mi id="A6.p3.6.m1.1.1.1.1.3.3.3.2" xref="A6.p3.6.m1.1.1.1.1.3.3.3.2.cmml">W</mi><msub id="A6.p3.6.m1.1.1.1.1.3.3.3.3" xref="A6.p3.6.m1.1.1.1.1.3.3.3.3.cmml"><mi id="A6.p3.6.m1.1.1.1.1.3.3.3.3.2" xref="A6.p3.6.m1.1.1.1.1.3.3.3.3.2.cmml">K</mi><mn id="A6.p3.6.m1.1.1.1.1.3.3.3.3.3" xref="A6.p3.6.m1.1.1.1.1.3.3.3.3.3.cmml">1</mn></msub></msup><mo id="A6.p3.6.m1.1.1.1.1.4.4.7" xref="A6.p3.6.m1.1.1.1.1.4.5.cmml">,</mo><msup id="A6.p3.6.m1.1.1.1.1.4.4.4" xref="A6.p3.6.m1.1.1.1.1.4.4.4.cmml"><mi id="A6.p3.6.m1.1.1.1.1.4.4.4.2" xref="A6.p3.6.m1.1.1.1.1.4.4.4.2.cmml">W</mi><msub id="A6.p3.6.m1.1.1.1.1.4.4.4.3" xref="A6.p3.6.m1.1.1.1.1.4.4.4.3.cmml"><mi id="A6.p3.6.m1.1.1.1.1.4.4.4.3.2" xref="A6.p3.6.m1.1.1.1.1.4.4.4.3.2.cmml">K</mi><mn id="A6.p3.6.m1.1.1.1.1.4.4.4.3.3" xref="A6.p3.6.m1.1.1.1.1.4.4.4.3.3.cmml">2</mn></msub></msup></mrow><mo id="A6.p3.6.m1.1.1.1.1.5" xref="A6.p3.6.m1.1.1.1.1.5.cmml">∈</mo><msup id="A6.p3.6.m1.1.1.1.1.6" xref="A6.p3.6.m1.1.1.1.1.6.cmml"><mi id="A6.p3.6.m1.1.1.1.1.6.2" xref="A6.p3.6.m1.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="A6.p3.6.m1.1.1.1.1.6.3" xref="A6.p3.6.m1.1.1.1.1.6.3.cmml"><msub id="A6.p3.6.m1.1.1.1.1.6.3.2" xref="A6.p3.6.m1.1.1.1.1.6.3.2.cmml"><mi id="A6.p3.6.m1.1.1.1.1.6.3.2.2" xref="A6.p3.6.m1.1.1.1.1.6.3.2.2.cmml">d</mi><mtext id="A6.p3.6.m1.1.1.1.1.6.3.2.3" xref="A6.p3.6.m1.1.1.1.1.6.3.2.3a.cmml">model</mtext></msub><mo id="A6.p3.6.m1.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p3.6.m1.1.1.1.1.6.3.1.cmml">×</mo><mi id="A6.p3.6.m1.1.1.1.1.6.3.3" xref="A6.p3.6.m1.1.1.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><mo id="A6.p3.6.m1.2.2.2.3" xref="A6.p3.6.m1.2.2.3a.cmml">,</mo><mrow id="A6.p3.6.m1.2.2.2.2.2" xref="A6.p3.6.m1.2.2.2.2.3.cmml"><mrow id="A6.p3.6.m1.2.2.2.2.1.1" xref="A6.p3.6.m1.2.2.2.2.1.1.cmml"><msup id="A6.p3.6.m1.2.2.2.2.1.1.2" xref="A6.p3.6.m1.2.2.2.2.1.1.2.cmml"><mi id="A6.p3.6.m1.2.2.2.2.1.1.2.2" xref="A6.p3.6.m1.2.2.2.2.1.1.2.2.cmml">W</mi><mi id="A6.p3.6.m1.2.2.2.2.1.1.2.3" xref="A6.p3.6.m1.2.2.2.2.1.1.2.3.cmml">V</mi></msup><mo id="A6.p3.6.m1.2.2.2.2.1.1.1" xref="A6.p3.6.m1.2.2.2.2.1.1.1.cmml">∈</mo><msup id="A6.p3.6.m1.2.2.2.2.1.1.3" xref="A6.p3.6.m1.2.2.2.2.1.1.3.cmml"><mi id="A6.p3.6.m1.2.2.2.2.1.1.3.2" xref="A6.p3.6.m1.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="A6.p3.6.m1.2.2.2.2.1.1.3.3" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.cmml"><mrow id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.cmml"><msub id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.cmml"><mi id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.2" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.2.cmml">d</mi><mtext id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.3" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.3a.cmml">model</mtext></msub><mo id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.1.cmml">×</mo><mn id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.3" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.3.cmml">2</mn></mrow><mo id="A6.p3.6.m1.2.2.2.2.1.1.3.3.1" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="A6.p3.6.m1.2.2.2.2.1.1.3.3.3" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><mo id="A6.p3.6.m1.2.2.2.2.2.3" xref="A6.p3.6.m1.2.2.2.2.3a.cmml">,</mo><mrow id="A6.p3.6.m1.2.2.2.2.2.2" xref="A6.p3.6.m1.2.2.2.2.2.2.cmml"><msup id="A6.p3.6.m1.2.2.2.2.2.2.2" xref="A6.p3.6.m1.2.2.2.2.2.2.2.cmml"><mi id="A6.p3.6.m1.2.2.2.2.2.2.2.2" xref="A6.p3.6.m1.2.2.2.2.2.2.2.2.cmml">W</mi><mi id="A6.p3.6.m1.2.2.2.2.2.2.2.3" xref="A6.p3.6.m1.2.2.2.2.2.2.2.3.cmml">O</mi></msup><mo id="A6.p3.6.m1.2.2.2.2.2.2.1" xref="A6.p3.6.m1.2.2.2.2.2.2.1.cmml">∈</mo><msup id="A6.p3.6.m1.2.2.2.2.2.2.3" xref="A6.p3.6.m1.2.2.2.2.2.2.3.cmml"><mi id="A6.p3.6.m1.2.2.2.2.2.2.3.2" xref="A6.p3.6.m1.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="A6.p3.6.m1.2.2.2.2.2.2.3.3" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.cmml"><mrow id="A6.p3.6.m1.2.2.2.2.2.2.3.3.2" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.cmml"><mn id="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.2" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.2.cmml">2</mn><mo id="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.1" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.1.cmml">⁢</mo><mi id="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.3" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.3.cmml">d</mi></mrow><mo id="A6.p3.6.m1.2.2.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.1.cmml">×</mo><msub id="A6.p3.6.m1.2.2.2.2.2.2.3.3.3" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.cmml"><mi id="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.2" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.2.cmml">d</mi><mtext id="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.3" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.3a.cmml">model</mtext></msub></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p3.6.m1.2b"><apply id="A6.p3.6.m1.2.2.3.cmml" xref="A6.p3.6.m1.2.2.2"><csymbol cd="ambiguous" id="A6.p3.6.m1.2.2.3a.cmml" xref="A6.p3.6.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A6.p3.6.m1.1.1.1.1.cmml" xref="A6.p3.6.m1.1.1.1.1"><in id="A6.p3.6.m1.1.1.1.1.5.cmml" xref="A6.p3.6.m1.1.1.1.1.5"></in><list id="A6.p3.6.m1.1.1.1.1.4.5.cmml" xref="A6.p3.6.m1.1.1.1.1.4.4"><apply id="A6.p3.6.m1.1.1.1.1.1.1.1.cmml" xref="A6.p3.6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.p3.6.m1.1.1.1.1.1.1.1.1.cmml" xref="A6.p3.6.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.p3.6.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.p3.6.m1.1.1.1.1.1.1.1.2">𝑊</ci><apply id="A6.p3.6.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.p3.6.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.p3.6.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.p3.6.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.p3.6.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.p3.6.m1.1.1.1.1.1.1.1.3.2">𝑄</ci><cn id="A6.p3.6.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A6.p3.6.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="A6.p3.6.m1.1.1.1.1.2.2.2.cmml" xref="A6.p3.6.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A6.p3.6.m1.1.1.1.1.2.2.2.1.cmml" xref="A6.p3.6.m1.1.1.1.1.2.2.2">superscript</csymbol><ci id="A6.p3.6.m1.1.1.1.1.2.2.2.2.cmml" xref="A6.p3.6.m1.1.1.1.1.2.2.2.2">𝑊</ci><apply id="A6.p3.6.m1.1.1.1.1.2.2.2.3.cmml" xref="A6.p3.6.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="A6.p3.6.m1.1.1.1.1.2.2.2.3.1.cmml" xref="A6.p3.6.m1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="A6.p3.6.m1.1.1.1.1.2.2.2.3.2.cmml" xref="A6.p3.6.m1.1.1.1.1.2.2.2.3.2">𝑄</ci><cn id="A6.p3.6.m1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="A6.p3.6.m1.1.1.1.1.2.2.2.3.3">2</cn></apply></apply><apply id="A6.p3.6.m1.1.1.1.1.3.3.3.cmml" xref="A6.p3.6.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A6.p3.6.m1.1.1.1.1.3.3.3.1.cmml" xref="A6.p3.6.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="A6.p3.6.m1.1.1.1.1.3.3.3.2.cmml" xref="A6.p3.6.m1.1.1.1.1.3.3.3.2">𝑊</ci><apply id="A6.p3.6.m1.1.1.1.1.3.3.3.3.cmml" xref="A6.p3.6.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="A6.p3.6.m1.1.1.1.1.3.3.3.3.1.cmml" xref="A6.p3.6.m1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="A6.p3.6.m1.1.1.1.1.3.3.3.3.2.cmml" xref="A6.p3.6.m1.1.1.1.1.3.3.3.3.2">𝐾</ci><cn id="A6.p3.6.m1.1.1.1.1.3.3.3.3.3.cmml" type="integer" xref="A6.p3.6.m1.1.1.1.1.3.3.3.3.3">1</cn></apply></apply><apply id="A6.p3.6.m1.1.1.1.1.4.4.4.cmml" xref="A6.p3.6.m1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="A6.p3.6.m1.1.1.1.1.4.4.4.1.cmml" xref="A6.p3.6.m1.1.1.1.1.4.4.4">superscript</csymbol><ci id="A6.p3.6.m1.1.1.1.1.4.4.4.2.cmml" xref="A6.p3.6.m1.1.1.1.1.4.4.4.2">𝑊</ci><apply id="A6.p3.6.m1.1.1.1.1.4.4.4.3.cmml" xref="A6.p3.6.m1.1.1.1.1.4.4.4.3"><csymbol cd="ambiguous" id="A6.p3.6.m1.1.1.1.1.4.4.4.3.1.cmml" xref="A6.p3.6.m1.1.1.1.1.4.4.4.3">subscript</csymbol><ci id="A6.p3.6.m1.1.1.1.1.4.4.4.3.2.cmml" xref="A6.p3.6.m1.1.1.1.1.4.4.4.3.2">𝐾</ci><cn id="A6.p3.6.m1.1.1.1.1.4.4.4.3.3.cmml" type="integer" xref="A6.p3.6.m1.1.1.1.1.4.4.4.3.3">2</cn></apply></apply></list><apply id="A6.p3.6.m1.1.1.1.1.6.cmml" xref="A6.p3.6.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="A6.p3.6.m1.1.1.1.1.6.1.cmml" xref="A6.p3.6.m1.1.1.1.1.6">superscript</csymbol><ci id="A6.p3.6.m1.1.1.1.1.6.2.cmml" xref="A6.p3.6.m1.1.1.1.1.6.2">ℝ</ci><apply id="A6.p3.6.m1.1.1.1.1.6.3.cmml" xref="A6.p3.6.m1.1.1.1.1.6.3"><times id="A6.p3.6.m1.1.1.1.1.6.3.1.cmml" xref="A6.p3.6.m1.1.1.1.1.6.3.1"></times><apply id="A6.p3.6.m1.1.1.1.1.6.3.2.cmml" xref="A6.p3.6.m1.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="A6.p3.6.m1.1.1.1.1.6.3.2.1.cmml" xref="A6.p3.6.m1.1.1.1.1.6.3.2">subscript</csymbol><ci id="A6.p3.6.m1.1.1.1.1.6.3.2.2.cmml" xref="A6.p3.6.m1.1.1.1.1.6.3.2.2">𝑑</ci><ci id="A6.p3.6.m1.1.1.1.1.6.3.2.3a.cmml" xref="A6.p3.6.m1.1.1.1.1.6.3.2.3"><mtext id="A6.p3.6.m1.1.1.1.1.6.3.2.3.cmml" mathsize="50%" xref="A6.p3.6.m1.1.1.1.1.6.3.2.3">model</mtext></ci></apply><ci id="A6.p3.6.m1.1.1.1.1.6.3.3.cmml" xref="A6.p3.6.m1.1.1.1.1.6.3.3">𝑑</ci></apply></apply></apply><apply id="A6.p3.6.m1.2.2.2.2.3.cmml" xref="A6.p3.6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A6.p3.6.m1.2.2.2.2.3a.cmml" xref="A6.p3.6.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A6.p3.6.m1.2.2.2.2.1.1.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1"><in id="A6.p3.6.m1.2.2.2.2.1.1.1.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.1"></in><apply id="A6.p3.6.m1.2.2.2.2.1.1.2.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A6.p3.6.m1.2.2.2.2.1.1.2.1.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.2">superscript</csymbol><ci id="A6.p3.6.m1.2.2.2.2.1.1.2.2.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.2.2">𝑊</ci><ci id="A6.p3.6.m1.2.2.2.2.1.1.2.3.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.2.3">𝑉</ci></apply><apply id="A6.p3.6.m1.2.2.2.2.1.1.3.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A6.p3.6.m1.2.2.2.2.1.1.3.1.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3">superscript</csymbol><ci id="A6.p3.6.m1.2.2.2.2.1.1.3.2.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3.2">ℝ</ci><apply id="A6.p3.6.m1.2.2.2.2.1.1.3.3.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3"><times id="A6.p3.6.m1.2.2.2.2.1.1.3.3.1.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.1"></times><apply id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2"><times id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.1.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.1"></times><apply id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.1.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2">subscript</csymbol><ci id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.2.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.2">𝑑</ci><ci id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.3a.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.3"><mtext id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.3.cmml" mathsize="50%" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.2.3">model</mtext></ci></apply><cn id="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.3.cmml" type="integer" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.2.3">2</cn></apply><ci id="A6.p3.6.m1.2.2.2.2.1.1.3.3.3.cmml" xref="A6.p3.6.m1.2.2.2.2.1.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="A6.p3.6.m1.2.2.2.2.2.2.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2"><in id="A6.p3.6.m1.2.2.2.2.2.2.1.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.1"></in><apply id="A6.p3.6.m1.2.2.2.2.2.2.2.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A6.p3.6.m1.2.2.2.2.2.2.2.1.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="A6.p3.6.m1.2.2.2.2.2.2.2.2.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.2.2">𝑊</ci><ci id="A6.p3.6.m1.2.2.2.2.2.2.2.3.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.2.3">𝑂</ci></apply><apply id="A6.p3.6.m1.2.2.2.2.2.2.3.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A6.p3.6.m1.2.2.2.2.2.2.3.1.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3">superscript</csymbol><ci id="A6.p3.6.m1.2.2.2.2.2.2.3.2.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3.2">ℝ</ci><apply id="A6.p3.6.m1.2.2.2.2.2.2.3.3.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3"><times id="A6.p3.6.m1.2.2.2.2.2.2.3.3.1.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.1"></times><apply id="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.2"><times id="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.1.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.1"></times><cn id="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.2.cmml" type="integer" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.2">2</cn><ci id="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.3.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.2.3">𝑑</ci></apply><apply id="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.1.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.2.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.2">𝑑</ci><ci id="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.3a.cmml" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.3"><mtext id="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.3.cmml" mathsize="50%" xref="A6.p3.6.m1.2.2.2.2.2.2.3.3.3.3">model</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p3.6.m1.2c">W^{Q_{1}},W^{Q_{2}},W^{K_{1}},W^{K_{2}}\in\mathbb{R}^{d_{\text{model}}\times d%
},W^{V}\in\mathbb{R}^{d_{\text{model}}\times 2d},W^{O}\in\mathbb{R}^{2d\times d%
_{\text{model}}}</annotation><annotation encoding="application/x-llamapun" id="A6.p3.6.m1.2d">italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × 2 italic_d end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 2 italic_d × italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are parameters. Denote the gradient of <math alttext="O" class="ltx_Math" display="inline" id="A6.p3.7.m2.1"><semantics id="A6.p3.7.m2.1a"><mi id="A6.p3.7.m2.1.1" xref="A6.p3.7.m2.1.1.cmml">O</mi><annotation-xml encoding="MathML-Content" id="A6.p3.7.m2.1b"><ci id="A6.p3.7.m2.1.1.cmml" xref="A6.p3.7.m2.1.1">𝑂</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p3.7.m2.1c">O</annotation><annotation encoding="application/x-llamapun" id="A6.p3.7.m2.1d">italic_O</annotation></semantics></math> as <math alttext="\cfrac{\partial L}{\partial O}" class="ltx_Math" display="inline" id="A6.p3.8.m3.1"><semantics id="A6.p3.8.m3.1a"><mfrac id="A6.p3.8.m3.1.1" xref="A6.p3.8.m3.1.1.cmml"><mrow id="A6.p3.8.m3.1.1.2" xref="A6.p3.8.m3.1.1.2.cmml"><mo id="A6.p3.8.m3.1.1.2.1" rspace="0em" xref="A6.p3.8.m3.1.1.2.1.cmml">∂</mo><mi id="A6.p3.8.m3.1.1.2.2" xref="A6.p3.8.m3.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.p3.8.m3.1.1.3" xref="A6.p3.8.m3.1.1.3.cmml"><mo id="A6.p3.8.m3.1.1.3.1" rspace="0em" xref="A6.p3.8.m3.1.1.3.1.cmml">∂</mo><mi id="A6.p3.8.m3.1.1.3.2" xref="A6.p3.8.m3.1.1.3.2.cmml">O</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="A6.p3.8.m3.1b"><apply id="A6.p3.8.m3.1.1.cmml" xref="A6.p3.8.m3.1.1"><csymbol cd="latexml" id="A6.p3.8.m3.1.1.1.cmml" xref="A6.p3.8.m3.1.1">continued-fraction</csymbol><apply id="A6.p3.8.m3.1.1.2.cmml" xref="A6.p3.8.m3.1.1.2"><partialdiff id="A6.p3.8.m3.1.1.2.1.cmml" xref="A6.p3.8.m3.1.1.2.1"></partialdiff><ci id="A6.p3.8.m3.1.1.2.2.cmml" xref="A6.p3.8.m3.1.1.2.2">𝐿</ci></apply><apply id="A6.p3.8.m3.1.1.3.cmml" xref="A6.p3.8.m3.1.1.3"><partialdiff id="A6.p3.8.m3.1.1.3.1.cmml" xref="A6.p3.8.m3.1.1.3.1"></partialdiff><ci id="A6.p3.8.m3.1.1.3.2.cmml" xref="A6.p3.8.m3.1.1.3.2">𝑂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p3.8.m3.1c">\cfrac{\partial L}{\partial O}</annotation><annotation encoding="application/x-llamapun" id="A6.p3.8.m3.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG</annotation></semantics></math>, we formulate gradients of parameters via:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="A6.E9">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{O}}" class="ltx_Math" display="inline" id="A6.E9X.2.1.1.m1.1"><semantics id="A6.E9X.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E9X.2.1.1.m1.1.1" xref="A6.E9X.2.1.1.m1.1.1.cmml"><mfrac id="A6.E9X.2.1.1.m1.1.1a" xref="A6.E9X.2.1.1.m1.1.1.cmml"><mrow id="A6.E9X.2.1.1.m1.1.1.2" xref="A6.E9X.2.1.1.m1.1.1.2.cmml"><mo id="A6.E9X.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E9X.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E9X.2.1.1.m1.1.1.2.2" xref="A6.E9X.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E9X.2.1.1.m1.1.1.3" xref="A6.E9X.2.1.1.m1.1.1.3.cmml"><mo id="A6.E9X.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E9X.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E9X.2.1.1.m1.1.1.3.2" xref="A6.E9X.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E9X.2.1.1.m1.1.1.3.2.2" xref="A6.E9X.2.1.1.m1.1.1.3.2.2.cmml">W</mi><mi id="A6.E9X.2.1.1.m1.1.1.3.2.3" xref="A6.E9X.2.1.1.m1.1.1.3.2.3.cmml">O</mi></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E9X.2.1.1.m1.1b"><apply id="A6.E9X.2.1.1.m1.1.1.cmml" xref="A6.E9X.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E9X.2.1.1.m1.1.1.1.cmml" xref="A6.E9X.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E9X.2.1.1.m1.1.1.2.cmml" xref="A6.E9X.2.1.1.m1.1.1.2"><partialdiff id="A6.E9X.2.1.1.m1.1.1.2.1.cmml" xref="A6.E9X.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E9X.2.1.1.m1.1.1.2.2.cmml" xref="A6.E9X.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E9X.2.1.1.m1.1.1.3.cmml" xref="A6.E9X.2.1.1.m1.1.1.3"><partialdiff id="A6.E9X.2.1.1.m1.1.1.3.1.cmml" xref="A6.E9X.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E9X.2.1.1.m1.1.1.3.2.cmml" xref="A6.E9X.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E9X.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E9X.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E9X.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E9X.2.1.1.m1.1.1.3.2.2">𝑊</ci><ci id="A6.E9X.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E9X.2.1.1.m1.1.1.3.2.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9X.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{O}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9X.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial W^{O}}" class="ltx_Math" display="inline" id="A6.E9X.3.2.2.m1.1"><semantics id="A6.E9X.3.2.2.m1.1a"><mrow id="A6.E9X.3.2.2.m1.1.1" xref="A6.E9X.3.2.2.m1.1.1.cmml"><mi id="A6.E9X.3.2.2.m1.1.1.2" xref="A6.E9X.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E9X.3.2.2.m1.1.1.1" xref="A6.E9X.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E9X.3.2.2.m1.1.1.3" xref="A6.E9X.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E9X.3.2.2.m1.1.1.3.2" xref="A6.E9X.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E9X.3.2.2.m1.1.1.3.2a" xref="A6.E9X.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E9X.3.2.2.m1.1.1.3.2.2" xref="A6.E9X.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E9X.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E9X.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E9X.3.2.2.m1.1.1.3.2.2.2" xref="A6.E9X.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E9X.3.2.2.m1.1.1.3.2.3" xref="A6.E9X.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E9X.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E9X.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E9X.3.2.2.m1.1.1.3.2.3.2" xref="A6.E9X.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9X.3.2.2.m1.1.1.3.1" xref="A6.E9X.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9X.3.2.2.m1.1.1.3.3" xref="A6.E9X.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E9X.3.2.2.m1.1.1.3.3a" xref="A6.E9X.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E9X.3.2.2.m1.1.1.3.3.2" xref="A6.E9X.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E9X.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E9X.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E9X.3.2.2.m1.1.1.3.3.2.2" xref="A6.E9X.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E9X.3.2.2.m1.1.1.3.3.3" xref="A6.E9X.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E9X.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E9X.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><msup id="A6.E9X.3.2.2.m1.1.1.3.3.3.2" xref="A6.E9X.3.2.2.m1.1.1.3.3.3.2.cmml"><mi id="A6.E9X.3.2.2.m1.1.1.3.3.3.2.2" xref="A6.E9X.3.2.2.m1.1.1.3.3.3.2.2.cmml">W</mi><mi id="A6.E9X.3.2.2.m1.1.1.3.3.3.2.3" xref="A6.E9X.3.2.2.m1.1.1.3.3.3.2.3.cmml">O</mi></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9X.3.2.2.m1.1b"><apply id="A6.E9X.3.2.2.m1.1.1.cmml" xref="A6.E9X.3.2.2.m1.1.1"><eq id="A6.E9X.3.2.2.m1.1.1.1.cmml" xref="A6.E9X.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E9X.3.2.2.m1.1.1.2.cmml" xref="A6.E9X.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E9X.3.2.2.m1.1.1.3.cmml" xref="A6.E9X.3.2.2.m1.1.1.3"><times id="A6.E9X.3.2.2.m1.1.1.3.1.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.1"></times><apply id="A6.E9X.3.2.2.m1.1.1.3.2.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E9X.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E9X.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E9X.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E9X.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E9X.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E9X.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E9X.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E9X.3.2.2.m1.1.1.3.3.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E9X.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E9X.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E9X.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E9X.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E9X.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E9X.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3.3.1"></partialdiff><apply id="A6.E9X.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="A6.E9X.3.2.2.m1.1.1.3.3.3.2.1.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3.3.2">superscript</csymbol><ci id="A6.E9X.3.2.2.m1.1.1.3.3.3.2.2.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3.3.2.2">𝑊</ci><ci id="A6.E9X.3.2.2.m1.1.1.3.3.3.2.3.cmml" xref="A6.E9X.3.2.2.m1.1.1.3.3.3.2.3">𝑂</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9X.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial W^{O}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9X.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="12"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(AV)^{\intercal}\cfrac{\partial L}{\partial O}" class="ltx_Math" display="inline" id="A6.E9Xa.2.1.1.m1.1"><semantics id="A6.E9Xa.2.1.1.m1.1a"><mrow id="A6.E9Xa.2.1.1.m1.1.1" xref="A6.E9Xa.2.1.1.m1.1.1.cmml"><mi id="A6.E9Xa.2.1.1.m1.1.1.3" xref="A6.E9Xa.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E9Xa.2.1.1.m1.1.1.2" xref="A6.E9Xa.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E9Xa.2.1.1.m1.1.1.1" xref="A6.E9Xa.2.1.1.m1.1.1.1.cmml"><msup id="A6.E9Xa.2.1.1.m1.1.1.1.1" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">A</mi><mo id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">V</mi></mrow><mo id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xa.2.1.1.m1.1.1.1.1.3" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xa.2.1.1.m1.1.1.1.2" xref="A6.E9Xa.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xa.2.1.1.m1.1.1.1.3" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.cmml"><mfrac id="A6.E9Xa.2.1.1.m1.1.1.1.3a" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.cmml"><mrow id="A6.E9Xa.2.1.1.m1.1.1.1.3.2" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.2.cmml"><mo id="A6.E9Xa.2.1.1.m1.1.1.1.3.2.1" rspace="0em" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E9Xa.2.1.1.m1.1.1.1.3.2.2" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xa.2.1.1.m1.1.1.1.3.3" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.3.cmml"><mo id="A6.E9Xa.2.1.1.m1.1.1.1.3.3.1" rspace="0em" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E9Xa.2.1.1.m1.1.1.1.3.3.2" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xa.2.1.1.m1.1b"><apply id="A6.E9Xa.2.1.1.m1.1.1.cmml" xref="A6.E9Xa.2.1.1.m1.1.1"><eq id="A6.E9Xa.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E9Xa.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E9Xa.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1"><times id="A6.E9Xa.2.1.1.m1.1.1.1.2.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.2"></times><apply id="A6.E9Xa.2.1.1.m1.1.1.1.1.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1"><times id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.1"></times><ci id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.2">𝐴</ci><ci id="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.1.1.1.3">𝑉</ci></apply><ci id="A6.E9Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xa.2.1.1.m1.1.1.1.3.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xa.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E9Xa.2.1.1.m1.1.1.1.3.2.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.2"><partialdiff id="A6.E9Xa.2.1.1.m1.1.1.1.3.2.1.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.2.1"></partialdiff><ci id="A6.E9Xa.2.1.1.m1.1.1.1.3.2.2.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E9Xa.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.3"><partialdiff id="A6.E9Xa.2.1.1.m1.1.1.1.3.3.1.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.3.1"></partialdiff><ci id="A6.E9Xa.2.1.1.m1.1.1.1.3.3.2.cmml" xref="A6.E9Xa.2.1.1.m1.1.1.1.3.3.2">𝑂</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xa.2.1.1.m1.1c">\displaystyle=(AV)^{\intercal}\cfrac{\partial L}{\partial O}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xa.2.1.1.m1.1d">= ( italic_A italic_V ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{V}}" class="ltx_Math" display="inline" id="A6.E9Xb.2.1.1.m1.1"><semantics id="A6.E9Xb.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E9Xb.2.1.1.m1.1.1" xref="A6.E9Xb.2.1.1.m1.1.1.cmml"><mfrac id="A6.E9Xb.2.1.1.m1.1.1a" xref="A6.E9Xb.2.1.1.m1.1.1.cmml"><mrow id="A6.E9Xb.2.1.1.m1.1.1.2" xref="A6.E9Xb.2.1.1.m1.1.1.2.cmml"><mo id="A6.E9Xb.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E9Xb.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E9Xb.2.1.1.m1.1.1.2.2" xref="A6.E9Xb.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xb.2.1.1.m1.1.1.3" xref="A6.E9Xb.2.1.1.m1.1.1.3.cmml"><mo id="A6.E9Xb.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E9Xb.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E9Xb.2.1.1.m1.1.1.3.2" xref="A6.E9Xb.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E9Xb.2.1.1.m1.1.1.3.2.2" xref="A6.E9Xb.2.1.1.m1.1.1.3.2.2.cmml">W</mi><mi id="A6.E9Xb.2.1.1.m1.1.1.3.2.3" xref="A6.E9Xb.2.1.1.m1.1.1.3.2.3.cmml">V</mi></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E9Xb.2.1.1.m1.1b"><apply id="A6.E9Xb.2.1.1.m1.1.1.cmml" xref="A6.E9Xb.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E9Xb.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xb.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E9Xb.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xb.2.1.1.m1.1.1.2"><partialdiff id="A6.E9Xb.2.1.1.m1.1.1.2.1.cmml" xref="A6.E9Xb.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E9Xb.2.1.1.m1.1.1.2.2.cmml" xref="A6.E9Xb.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E9Xb.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xb.2.1.1.m1.1.1.3"><partialdiff id="A6.E9Xb.2.1.1.m1.1.1.3.1.cmml" xref="A6.E9Xb.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E9Xb.2.1.1.m1.1.1.3.2.cmml" xref="A6.E9Xb.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E9Xb.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E9Xb.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E9Xb.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E9Xb.2.1.1.m1.1.1.3.2.2">𝑊</ci><ci id="A6.E9Xb.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E9Xb.2.1.1.m1.1.1.3.2.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xb.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{V}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xb.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial V}%
\cfrac{\partial V}{\partial W^{V}}" class="ltx_Math" display="inline" id="A6.E9Xb.3.2.2.m1.1"><semantics id="A6.E9Xb.3.2.2.m1.1a"><mrow id="A6.E9Xb.3.2.2.m1.1.1" xref="A6.E9Xb.3.2.2.m1.1.1.cmml"><mi id="A6.E9Xb.3.2.2.m1.1.1.2" xref="A6.E9Xb.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E9Xb.3.2.2.m1.1.1.1" xref="A6.E9Xb.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E9Xb.3.2.2.m1.1.1.3" xref="A6.E9Xb.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E9Xb.3.2.2.m1.1.1.3.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E9Xb.3.2.2.m1.1.1.3.2a" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E9Xb.3.2.2.m1.1.1.3.2.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E9Xb.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E9Xb.3.2.2.m1.1.1.3.2.2.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xb.3.2.2.m1.1.1.3.2.3" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E9Xb.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E9Xb.3.2.2.m1.1.1.3.2.3.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xb.3.2.2.m1.1.1.3.1" xref="A6.E9Xb.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xb.3.2.2.m1.1.1.3.3" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E9Xb.3.2.2.m1.1.1.3.3a" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E9Xb.3.2.2.m1.1.1.3.3.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E9Xb.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E9Xb.3.2.2.m1.1.1.3.3.2.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E9Xb.3.2.2.m1.1.1.3.3.3" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E9Xb.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><mi id="A6.E9Xb.3.2.2.m1.1.1.3.3.3.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.3.2.cmml">V</mi></mrow></mfrac></mstyle><mo id="A6.E9Xb.3.2.2.m1.1.1.3.1a" xref="A6.E9Xb.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xb.3.2.2.m1.1.1.3.4" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.cmml"><mfrac id="A6.E9Xb.3.2.2.m1.1.1.3.4a" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.cmml"><mrow id="A6.E9Xb.3.2.2.m1.1.1.3.4.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.2.cmml"><mo id="A6.E9Xb.3.2.2.m1.1.1.3.4.2.1" rspace="0em" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.2.1.cmml">∂</mo><mi id="A6.E9Xb.3.2.2.m1.1.1.3.4.2.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.2.2.cmml">V</mi></mrow><mrow id="A6.E9Xb.3.2.2.m1.1.1.3.4.3" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3.cmml"><mo id="A6.E9Xb.3.2.2.m1.1.1.3.4.3.1" rspace="0em" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3.1.cmml">∂</mo><msup id="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.cmml"><mi id="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.2" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.2.cmml">W</mi><mi id="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.3" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.3.cmml">V</mi></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xb.3.2.2.m1.1b"><apply id="A6.E9Xb.3.2.2.m1.1.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1"><eq id="A6.E9Xb.3.2.2.m1.1.1.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E9Xb.3.2.2.m1.1.1.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E9Xb.3.2.2.m1.1.1.3.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3"><times id="A6.E9Xb.3.2.2.m1.1.1.3.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.1"></times><apply id="A6.E9Xb.3.2.2.m1.1.1.3.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E9Xb.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E9Xb.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E9Xb.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E9Xb.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E9Xb.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E9Xb.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E9Xb.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xb.3.2.2.m1.1.1.3.3.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E9Xb.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E9Xb.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E9Xb.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E9Xb.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E9Xb.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E9Xb.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.3.1"></partialdiff><ci id="A6.E9Xb.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.3.3.2">𝑉</ci></apply></apply><apply id="A6.E9Xb.3.2.2.m1.1.1.3.4.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4"><csymbol cd="latexml" id="A6.E9Xb.3.2.2.m1.1.1.3.4.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4">continued-fraction</csymbol><apply id="A6.E9Xb.3.2.2.m1.1.1.3.4.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.2"><partialdiff id="A6.E9Xb.3.2.2.m1.1.1.3.4.2.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.2.1"></partialdiff><ci id="A6.E9Xb.3.2.2.m1.1.1.3.4.2.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.2.2">𝑉</ci></apply><apply id="A6.E9Xb.3.2.2.m1.1.1.3.4.3.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3"><partialdiff id="A6.E9Xb.3.2.2.m1.1.1.3.4.3.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3.1"></partialdiff><apply id="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2"><csymbol cd="ambiguous" id="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.1.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2">superscript</csymbol><ci id="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.2.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.2">𝑊</ci><ci id="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.3.cmml" xref="A6.E9Xb.3.2.2.m1.1.1.3.4.3.2.3">𝑉</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xb.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial V}%
\cfrac{\partial V}{\partial W^{V}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xb.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_V end_ARG continued-fraction start_ARG ∂ italic_V end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xc">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=X^{\intercal}A^{\intercal}\cfrac{\partial L}{\partial O}(W^{O})^%
{\intercal}" class="ltx_Math" display="inline" id="A6.E9Xc.2.1.1.m1.1"><semantics id="A6.E9Xc.2.1.1.m1.1a"><mrow id="A6.E9Xc.2.1.1.m1.1.1" xref="A6.E9Xc.2.1.1.m1.1.1.cmml"><mi id="A6.E9Xc.2.1.1.m1.1.1.3" xref="A6.E9Xc.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E9Xc.2.1.1.m1.1.1.2" xref="A6.E9Xc.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E9Xc.2.1.1.m1.1.1.1" xref="A6.E9Xc.2.1.1.m1.1.1.1.cmml"><msup id="A6.E9Xc.2.1.1.m1.1.1.1.3" xref="A6.E9Xc.2.1.1.m1.1.1.1.3.cmml"><mi id="A6.E9Xc.2.1.1.m1.1.1.1.3.2" xref="A6.E9Xc.2.1.1.m1.1.1.1.3.2.cmml">X</mi><mo id="A6.E9Xc.2.1.1.m1.1.1.1.3.3" xref="A6.E9Xc.2.1.1.m1.1.1.1.3.3.cmml">⊺</mo></msup><mo id="A6.E9Xc.2.1.1.m1.1.1.1.2" xref="A6.E9Xc.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xc.2.1.1.m1.1.1.1.4" xref="A6.E9Xc.2.1.1.m1.1.1.1.4.cmml"><mi id="A6.E9Xc.2.1.1.m1.1.1.1.4.2" xref="A6.E9Xc.2.1.1.m1.1.1.1.4.2.cmml">A</mi><mo id="A6.E9Xc.2.1.1.m1.1.1.1.4.3" xref="A6.E9Xc.2.1.1.m1.1.1.1.4.3.cmml">⊺</mo></msup><mo id="A6.E9Xc.2.1.1.m1.1.1.1.2a" xref="A6.E9Xc.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xc.2.1.1.m1.1.1.1.5" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.cmml"><mfrac id="A6.E9Xc.2.1.1.m1.1.1.1.5a" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.cmml"><mrow id="A6.E9Xc.2.1.1.m1.1.1.1.5.2" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.2.cmml"><mo id="A6.E9Xc.2.1.1.m1.1.1.1.5.2.1" rspace="0em" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.2.1.cmml">∂</mo><mi id="A6.E9Xc.2.1.1.m1.1.1.1.5.2.2" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xc.2.1.1.m1.1.1.1.5.3" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.3.cmml"><mo id="A6.E9Xc.2.1.1.m1.1.1.1.5.3.1" rspace="0em" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.3.1.cmml">∂</mo><mi id="A6.E9Xc.2.1.1.m1.1.1.1.5.3.2" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xc.2.1.1.m1.1.1.1.2b" xref="A6.E9Xc.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xc.2.1.1.m1.1.1.1.1" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.cmml"><mrow id="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.2" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xc.2.1.1.m1.1.1.1.1.3" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.3.cmml">⊺</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xc.2.1.1.m1.1b"><apply id="A6.E9Xc.2.1.1.m1.1.1.cmml" xref="A6.E9Xc.2.1.1.m1.1.1"><eq id="A6.E9Xc.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E9Xc.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E9Xc.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1"><times id="A6.E9Xc.2.1.1.m1.1.1.1.2.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.2"></times><apply id="A6.E9Xc.2.1.1.m1.1.1.1.3.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A6.E9Xc.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.3">superscript</csymbol><ci id="A6.E9Xc.2.1.1.m1.1.1.1.3.2.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.3.2">𝑋</ci><ci id="A6.E9Xc.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.3.3">⊺</ci></apply><apply id="A6.E9Xc.2.1.1.m1.1.1.1.4.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xc.2.1.1.m1.1.1.1.4.1.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xc.2.1.1.m1.1.1.1.4.2.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.4.2">𝐴</ci><ci id="A6.E9Xc.2.1.1.m1.1.1.1.4.3.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.4.3">⊺</ci></apply><apply id="A6.E9Xc.2.1.1.m1.1.1.1.5.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.5"><csymbol cd="latexml" id="A6.E9Xc.2.1.1.m1.1.1.1.5.1.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.5">continued-fraction</csymbol><apply id="A6.E9Xc.2.1.1.m1.1.1.1.5.2.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.2"><partialdiff id="A6.E9Xc.2.1.1.m1.1.1.1.5.2.1.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.2.1"></partialdiff><ci id="A6.E9Xc.2.1.1.m1.1.1.1.5.2.2.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.2.2">𝐿</ci></apply><apply id="A6.E9Xc.2.1.1.m1.1.1.1.5.3.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.3"><partialdiff id="A6.E9Xc.2.1.1.m1.1.1.1.5.3.1.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.3.1"></partialdiff><ci id="A6.E9Xc.2.1.1.m1.1.1.1.5.3.2.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.5.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xc.2.1.1.m1.1.1.1.1.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xc.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E9Xc.2.1.1.m1.1.1.1.1.3.cmml" xref="A6.E9Xc.2.1.1.m1.1.1.1.1.3">⊺</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xc.2.1.1.m1.1c">\displaystyle=X^{\intercal}A^{\intercal}\cfrac{\partial L}{\partial O}(W^{O})^%
{\intercal}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xc.2.1.1.m1.1d">= italic_X start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_A start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xd">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{Q_{1}}}" class="ltx_Math" display="inline" id="A6.E9Xd.2.1.1.m1.1"><semantics id="A6.E9Xd.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E9Xd.2.1.1.m1.1.1" xref="A6.E9Xd.2.1.1.m1.1.1.cmml"><mfrac id="A6.E9Xd.2.1.1.m1.1.1a" xref="A6.E9Xd.2.1.1.m1.1.1.cmml"><mrow id="A6.E9Xd.2.1.1.m1.1.1.2" xref="A6.E9Xd.2.1.1.m1.1.1.2.cmml"><mo id="A6.E9Xd.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E9Xd.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E9Xd.2.1.1.m1.1.1.2.2" xref="A6.E9Xd.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xd.2.1.1.m1.1.1.3" xref="A6.E9Xd.2.1.1.m1.1.1.3.cmml"><mo id="A6.E9Xd.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E9Xd.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E9Xd.2.1.1.m1.1.1.3.2" xref="A6.E9Xd.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E9Xd.2.1.1.m1.1.1.3.2.2" xref="A6.E9Xd.2.1.1.m1.1.1.3.2.2.cmml">W</mi><msub id="A6.E9Xd.2.1.1.m1.1.1.3.2.3" xref="A6.E9Xd.2.1.1.m1.1.1.3.2.3.cmml"><mi id="A6.E9Xd.2.1.1.m1.1.1.3.2.3.2" xref="A6.E9Xd.2.1.1.m1.1.1.3.2.3.2.cmml">Q</mi><mn id="A6.E9Xd.2.1.1.m1.1.1.3.2.3.3" xref="A6.E9Xd.2.1.1.m1.1.1.3.2.3.3.cmml">1</mn></msub></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E9Xd.2.1.1.m1.1b"><apply id="A6.E9Xd.2.1.1.m1.1.1.cmml" xref="A6.E9Xd.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E9Xd.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xd.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E9Xd.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.2"><partialdiff id="A6.E9Xd.2.1.1.m1.1.1.2.1.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E9Xd.2.1.1.m1.1.1.2.2.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E9Xd.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.3"><partialdiff id="A6.E9Xd.2.1.1.m1.1.1.3.1.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E9Xd.2.1.1.m1.1.1.3.2.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E9Xd.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E9Xd.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.3.2.2">𝑊</ci><apply id="A6.E9Xd.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A6.E9Xd.2.1.1.m1.1.1.3.2.3.1.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="A6.E9Xd.2.1.1.m1.1.1.3.2.3.2.cmml" xref="A6.E9Xd.2.1.1.m1.1.1.3.2.3.2">𝑄</ci><cn id="A6.E9Xd.2.1.1.m1.1.1.3.2.3.3.cmml" type="integer" xref="A6.E9Xd.2.1.1.m1.1.1.3.2.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xd.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{Q_{1}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xd.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A}%
\cfrac{\partial A}{\partial Q_{1}}\cfrac{\partial Q_{1}}{\partial W^{Q_{1}}}" class="ltx_Math" display="inline" id="A6.E9Xd.3.2.2.m1.1"><semantics id="A6.E9Xd.3.2.2.m1.1a"><mrow id="A6.E9Xd.3.2.2.m1.1.1" xref="A6.E9Xd.3.2.2.m1.1.1.cmml"><mi id="A6.E9Xd.3.2.2.m1.1.1.2" xref="A6.E9Xd.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E9Xd.3.2.2.m1.1.1.1" xref="A6.E9Xd.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E9Xd.3.2.2.m1.1.1.3" xref="A6.E9Xd.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E9Xd.3.2.2.m1.1.1.3.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E9Xd.3.2.2.m1.1.1.3.2a" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E9Xd.3.2.2.m1.1.1.3.2.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E9Xd.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E9Xd.3.2.2.m1.1.1.3.2.2.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xd.3.2.2.m1.1.1.3.2.3" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E9Xd.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E9Xd.3.2.2.m1.1.1.3.2.3.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xd.3.2.2.m1.1.1.3.1" xref="A6.E9Xd.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xd.3.2.2.m1.1.1.3.3" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E9Xd.3.2.2.m1.1.1.3.3a" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E9Xd.3.2.2.m1.1.1.3.3.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E9Xd.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E9Xd.3.2.2.m1.1.1.3.3.2.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E9Xd.3.2.2.m1.1.1.3.3.3" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E9Xd.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><mi id="A6.E9Xd.3.2.2.m1.1.1.3.3.3.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.3.2.cmml">A</mi></mrow></mfrac></mstyle><mo id="A6.E9Xd.3.2.2.m1.1.1.3.1a" xref="A6.E9Xd.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xd.3.2.2.m1.1.1.3.4" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.cmml"><mfrac id="A6.E9Xd.3.2.2.m1.1.1.3.4a" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.cmml"><mrow id="A6.E9Xd.3.2.2.m1.1.1.3.4.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.2.cmml"><mo id="A6.E9Xd.3.2.2.m1.1.1.3.4.2.1" rspace="0em" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.2.1.cmml">∂</mo><mi id="A6.E9Xd.3.2.2.m1.1.1.3.4.2.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.2.2.cmml">A</mi></mrow><mrow id="A6.E9Xd.3.2.2.m1.1.1.3.4.3" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3.cmml"><mo id="A6.E9Xd.3.2.2.m1.1.1.3.4.3.1" rspace="0em" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3.1.cmml">∂</mo><msub id="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.cmml"><mi id="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.2.cmml">Q</mi><mn id="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.3" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.3.cmml">1</mn></msub></mrow></mfrac></mstyle><mo id="A6.E9Xd.3.2.2.m1.1.1.3.1b" xref="A6.E9Xd.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xd.3.2.2.m1.1.1.3.5" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.cmml"><mfrac id="A6.E9Xd.3.2.2.m1.1.1.3.5a" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.cmml"><mrow id="A6.E9Xd.3.2.2.m1.1.1.3.5.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2.cmml"><mo id="A6.E9Xd.3.2.2.m1.1.1.3.5.2.1" rspace="0em" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2.1.cmml">∂</mo><msub id="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.cmml"><mi id="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.2.cmml">Q</mi><mn id="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.3" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.3.cmml">1</mn></msub></mrow><mrow id="A6.E9Xd.3.2.2.m1.1.1.3.5.3" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.cmml"><mo id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.1" rspace="0em" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.1.cmml">∂</mo><msup id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.cmml"><mi id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.2.cmml">W</mi><msub id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.cmml"><mi id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.2" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.2.cmml">Q</mi><mn id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.3" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.3.cmml">1</mn></msub></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xd.3.2.2.m1.1b"><apply id="A6.E9Xd.3.2.2.m1.1.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1"><eq id="A6.E9Xd.3.2.2.m1.1.1.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E9Xd.3.2.2.m1.1.1.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E9Xd.3.2.2.m1.1.1.3.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3"><times id="A6.E9Xd.3.2.2.m1.1.1.3.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.1"></times><apply id="A6.E9Xd.3.2.2.m1.1.1.3.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E9Xd.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E9Xd.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E9Xd.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E9Xd.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E9Xd.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E9Xd.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E9Xd.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xd.3.2.2.m1.1.1.3.3.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E9Xd.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E9Xd.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E9Xd.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E9Xd.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E9Xd.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E9Xd.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.3.1"></partialdiff><ci id="A6.E9Xd.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.3.3.2">𝐴</ci></apply></apply><apply id="A6.E9Xd.3.2.2.m1.1.1.3.4.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.4"><csymbol cd="latexml" id="A6.E9Xd.3.2.2.m1.1.1.3.4.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.4">continued-fraction</csymbol><apply id="A6.E9Xd.3.2.2.m1.1.1.3.4.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.2"><partialdiff id="A6.E9Xd.3.2.2.m1.1.1.3.4.2.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.2.1"></partialdiff><ci id="A6.E9Xd.3.2.2.m1.1.1.3.4.2.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.2.2">𝐴</ci></apply><apply id="A6.E9Xd.3.2.2.m1.1.1.3.4.3.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3"><partialdiff id="A6.E9Xd.3.2.2.m1.1.1.3.4.3.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3.1"></partialdiff><apply id="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2"><csymbol cd="ambiguous" id="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2">subscript</csymbol><ci id="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.2">𝑄</ci><cn id="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.3.cmml" type="integer" xref="A6.E9Xd.3.2.2.m1.1.1.3.4.3.2.3">1</cn></apply></apply></apply><apply id="A6.E9Xd.3.2.2.m1.1.1.3.5.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5"><csymbol cd="latexml" id="A6.E9Xd.3.2.2.m1.1.1.3.5.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5">continued-fraction</csymbol><apply id="A6.E9Xd.3.2.2.m1.1.1.3.5.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2"><partialdiff id="A6.E9Xd.3.2.2.m1.1.1.3.5.2.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2.1"></partialdiff><apply id="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2"><csymbol cd="ambiguous" id="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2">subscript</csymbol><ci id="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.2">𝑄</ci><cn id="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.3.cmml" type="integer" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.2.2.3">1</cn></apply></apply><apply id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3"><partialdiff id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.1"></partialdiff><apply id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2"><csymbol cd="ambiguous" id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2">superscript</csymbol><ci id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.2">𝑊</ci><apply id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3"><csymbol cd="ambiguous" id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.1.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3">subscript</csymbol><ci id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.2.cmml" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.2">𝑄</ci><cn id="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.3.cmml" type="integer" xref="A6.E9Xd.3.2.2.m1.1.1.3.5.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xd.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A}%
\cfrac{\partial A}{\partial Q_{1}}\cfrac{\partial Q_{1}}{\partial W^{Q_{1}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xd.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_A end_ARG continued-fraction start_ARG ∂ italic_A end_ARG start_ARG ∂ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xe">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{1}{\sqrt{2d}}~{}X^{\intercal}[A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}-(A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]K_{1}" class="ltx_Math" display="inline" id="A6.E9Xe.2.1.1.m1.1"><semantics id="A6.E9Xe.2.1.1.m1.1a"><mrow id="A6.E9Xe.2.1.1.m1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.cmml"><mi id="A6.E9Xe.2.1.1.m1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E9Xe.2.1.1.m1.1.1.2" xref="A6.E9Xe.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E9Xe.2.1.1.m1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xe.2.1.1.m1.1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.cmml"><mfrac id="A6.E9Xe.2.1.1.m1.1.1.1.3a" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.cmml"><mn id="A6.E9Xe.2.1.1.m1.1.1.1.3.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.2.cmml">1</mn><msqrt id="A6.E9Xe.2.1.1.m1.1.1.1.3.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3.cmml"><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.cmml"><mn id="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.2.cmml">2</mn><mo id="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.1.cmml">⁢</mo><mi id="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.3.cmml">d</mi></mrow></msqrt></mfrac></mstyle><mo id="A6.E9Xe.2.1.1.m1.1.1.1.2" lspace="0.330em" xref="A6.E9Xe.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xe.2.1.1.m1.1.1.1.4" xref="A6.E9Xe.2.1.1.m1.1.1.1.4.cmml"><mi id="A6.E9Xe.2.1.1.m1.1.1.1.4.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.4.2.cmml">X</mi><mo id="A6.E9Xe.2.1.1.m1.1.1.1.4.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.4.3.cmml">⊺</mo></msup><mo id="A6.E9Xe.2.1.1.m1.1.1.1.2a" xref="A6.E9Xe.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.2.cmml"><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.3.cmml">A</mi><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3a" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2a" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">A</mi><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">⊙</mo><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3a" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2a" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">J</mi></mrow></mrow><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="A6.E9Xe.2.1.1.m1.1.1.1.2b" xref="A6.E9Xe.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msub id="A6.E9Xe.2.1.1.m1.1.1.1.5" xref="A6.E9Xe.2.1.1.m1.1.1.1.5.cmml"><mi id="A6.E9Xe.2.1.1.m1.1.1.1.5.2" xref="A6.E9Xe.2.1.1.m1.1.1.1.5.2.cmml">K</mi><mn id="A6.E9Xe.2.1.1.m1.1.1.1.5.3" xref="A6.E9Xe.2.1.1.m1.1.1.1.5.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xe.2.1.1.m1.1b"><apply id="A6.E9Xe.2.1.1.m1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1"><eq id="A6.E9Xe.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E9Xe.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E9Xe.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1"><times id="A6.E9Xe.2.1.1.m1.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.2"></times><apply id="A6.E9Xe.2.1.1.m1.1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xe.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.3">continued-fraction</csymbol><cn id="A6.E9Xe.2.1.1.m1.1.1.1.3.2.cmml" type="integer" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.2">1</cn><apply id="A6.E9Xe.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3"><root id="A6.E9Xe.2.1.1.m1.1.1.1.3.3a.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3"></root><apply id="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2"><times id="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.1"></times><cn id="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.2.cmml" type="integer" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.2">2</cn><ci id="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.3.3.2.3">𝑑</ci></apply></apply></apply><apply id="A6.E9Xe.2.1.1.m1.1.1.1.4.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xe.2.1.1.m1.1.1.1.4.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xe.2.1.1.m1.1.1.1.4.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.4.2">𝑋</ci><ci id="A6.E9Xe.2.1.1.m1.1.1.1.4.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.4.3">⊺</ci></apply><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E9Xe.2.1.1.m1.1.1.1.1.2.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.2">direct-product</csymbol><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.3">𝐴</ci><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1"><minus id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><times id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2"><partialdiff id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3"><partialdiff id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3">⊺</ci></apply></apply><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"><times id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">direct-product</csymbol><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">𝐴</ci><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><times id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2"></times><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2"><partialdiff id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3"><partialdiff id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3">⊺</ci></apply></apply></apply><ci id="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝐽</ci></apply></apply></apply></apply><apply id="A6.E9Xe.2.1.1.m1.1.1.1.5.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.5"><csymbol cd="ambiguous" id="A6.E9Xe.2.1.1.m1.1.1.1.5.1.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.5">subscript</csymbol><ci id="A6.E9Xe.2.1.1.m1.1.1.1.5.2.cmml" xref="A6.E9Xe.2.1.1.m1.1.1.1.5.2">𝐾</ci><cn id="A6.E9Xe.2.1.1.m1.1.1.1.5.3.cmml" type="integer" xref="A6.E9Xe.2.1.1.m1.1.1.1.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xe.2.1.1.m1.1c">\displaystyle=\cfrac{1}{\sqrt{2d}}~{}X^{\intercal}[A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}-(A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]K_{1}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xe.2.1.1.m1.1d">= continued-fraction start_ARG 1 end_ARG start_ARG square-root start_ARG 2 italic_d end_ARG end_ARG italic_X start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT [ italic_A ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT - ( italic_A ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT ) ) italic_J ) ] italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xf">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{Q_{2}}}" class="ltx_Math" display="inline" id="A6.E9Xf.2.1.1.m1.1"><semantics id="A6.E9Xf.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E9Xf.2.1.1.m1.1.1" xref="A6.E9Xf.2.1.1.m1.1.1.cmml"><mfrac id="A6.E9Xf.2.1.1.m1.1.1a" xref="A6.E9Xf.2.1.1.m1.1.1.cmml"><mrow id="A6.E9Xf.2.1.1.m1.1.1.2" xref="A6.E9Xf.2.1.1.m1.1.1.2.cmml"><mo id="A6.E9Xf.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E9Xf.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E9Xf.2.1.1.m1.1.1.2.2" xref="A6.E9Xf.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xf.2.1.1.m1.1.1.3" xref="A6.E9Xf.2.1.1.m1.1.1.3.cmml"><mo id="A6.E9Xf.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E9Xf.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E9Xf.2.1.1.m1.1.1.3.2" xref="A6.E9Xf.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E9Xf.2.1.1.m1.1.1.3.2.2" xref="A6.E9Xf.2.1.1.m1.1.1.3.2.2.cmml">W</mi><msub id="A6.E9Xf.2.1.1.m1.1.1.3.2.3" xref="A6.E9Xf.2.1.1.m1.1.1.3.2.3.cmml"><mi id="A6.E9Xf.2.1.1.m1.1.1.3.2.3.2" xref="A6.E9Xf.2.1.1.m1.1.1.3.2.3.2.cmml">Q</mi><mn id="A6.E9Xf.2.1.1.m1.1.1.3.2.3.3" xref="A6.E9Xf.2.1.1.m1.1.1.3.2.3.3.cmml">2</mn></msub></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E9Xf.2.1.1.m1.1b"><apply id="A6.E9Xf.2.1.1.m1.1.1.cmml" xref="A6.E9Xf.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E9Xf.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xf.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E9Xf.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.2"><partialdiff id="A6.E9Xf.2.1.1.m1.1.1.2.1.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E9Xf.2.1.1.m1.1.1.2.2.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E9Xf.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.3"><partialdiff id="A6.E9Xf.2.1.1.m1.1.1.3.1.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E9Xf.2.1.1.m1.1.1.3.2.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E9Xf.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E9Xf.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.3.2.2">𝑊</ci><apply id="A6.E9Xf.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A6.E9Xf.2.1.1.m1.1.1.3.2.3.1.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="A6.E9Xf.2.1.1.m1.1.1.3.2.3.2.cmml" xref="A6.E9Xf.2.1.1.m1.1.1.3.2.3.2">𝑄</ci><cn id="A6.E9Xf.2.1.1.m1.1.1.3.2.3.3.cmml" type="integer" xref="A6.E9Xf.2.1.1.m1.1.1.3.2.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xf.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{Q_{2}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xf.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A}%
\cfrac{\partial A}{\partial Q_{2}}\cfrac{\partial Q_{2}}{\partial W^{Q_{2}}}" class="ltx_Math" display="inline" id="A6.E9Xf.3.2.2.m1.1"><semantics id="A6.E9Xf.3.2.2.m1.1a"><mrow id="A6.E9Xf.3.2.2.m1.1.1" xref="A6.E9Xf.3.2.2.m1.1.1.cmml"><mi id="A6.E9Xf.3.2.2.m1.1.1.2" xref="A6.E9Xf.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E9Xf.3.2.2.m1.1.1.1" xref="A6.E9Xf.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E9Xf.3.2.2.m1.1.1.3" xref="A6.E9Xf.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E9Xf.3.2.2.m1.1.1.3.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E9Xf.3.2.2.m1.1.1.3.2a" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E9Xf.3.2.2.m1.1.1.3.2.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E9Xf.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E9Xf.3.2.2.m1.1.1.3.2.2.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xf.3.2.2.m1.1.1.3.2.3" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E9Xf.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E9Xf.3.2.2.m1.1.1.3.2.3.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xf.3.2.2.m1.1.1.3.1" xref="A6.E9Xf.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xf.3.2.2.m1.1.1.3.3" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E9Xf.3.2.2.m1.1.1.3.3a" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E9Xf.3.2.2.m1.1.1.3.3.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E9Xf.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E9Xf.3.2.2.m1.1.1.3.3.2.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E9Xf.3.2.2.m1.1.1.3.3.3" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E9Xf.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><mi id="A6.E9Xf.3.2.2.m1.1.1.3.3.3.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.3.2.cmml">A</mi></mrow></mfrac></mstyle><mo id="A6.E9Xf.3.2.2.m1.1.1.3.1a" xref="A6.E9Xf.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xf.3.2.2.m1.1.1.3.4" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.cmml"><mfrac id="A6.E9Xf.3.2.2.m1.1.1.3.4a" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.cmml"><mrow id="A6.E9Xf.3.2.2.m1.1.1.3.4.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.2.cmml"><mo id="A6.E9Xf.3.2.2.m1.1.1.3.4.2.1" rspace="0em" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.2.1.cmml">∂</mo><mi id="A6.E9Xf.3.2.2.m1.1.1.3.4.2.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.2.2.cmml">A</mi></mrow><mrow id="A6.E9Xf.3.2.2.m1.1.1.3.4.3" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3.cmml"><mo id="A6.E9Xf.3.2.2.m1.1.1.3.4.3.1" rspace="0em" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3.1.cmml">∂</mo><msub id="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.cmml"><mi id="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.2.cmml">Q</mi><mn id="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.3" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo id="A6.E9Xf.3.2.2.m1.1.1.3.1b" xref="A6.E9Xf.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xf.3.2.2.m1.1.1.3.5" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.cmml"><mfrac id="A6.E9Xf.3.2.2.m1.1.1.3.5a" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.cmml"><mrow id="A6.E9Xf.3.2.2.m1.1.1.3.5.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2.cmml"><mo id="A6.E9Xf.3.2.2.m1.1.1.3.5.2.1" rspace="0em" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2.1.cmml">∂</mo><msub id="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.cmml"><mi id="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.2.cmml">Q</mi><mn id="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.3" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.3.cmml">2</mn></msub></mrow><mrow id="A6.E9Xf.3.2.2.m1.1.1.3.5.3" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.cmml"><mo id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.1" rspace="0em" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.1.cmml">∂</mo><msup id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.cmml"><mi id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.2.cmml">W</mi><msub id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.cmml"><mi id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.2" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.2.cmml">Q</mi><mn id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.3" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.3.cmml">2</mn></msub></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xf.3.2.2.m1.1b"><apply id="A6.E9Xf.3.2.2.m1.1.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1"><eq id="A6.E9Xf.3.2.2.m1.1.1.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E9Xf.3.2.2.m1.1.1.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E9Xf.3.2.2.m1.1.1.3.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3"><times id="A6.E9Xf.3.2.2.m1.1.1.3.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.1"></times><apply id="A6.E9Xf.3.2.2.m1.1.1.3.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E9Xf.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E9Xf.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E9Xf.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E9Xf.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E9Xf.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E9Xf.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E9Xf.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xf.3.2.2.m1.1.1.3.3.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E9Xf.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E9Xf.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E9Xf.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E9Xf.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E9Xf.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E9Xf.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.3.1"></partialdiff><ci id="A6.E9Xf.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.3.3.2">𝐴</ci></apply></apply><apply id="A6.E9Xf.3.2.2.m1.1.1.3.4.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.4"><csymbol cd="latexml" id="A6.E9Xf.3.2.2.m1.1.1.3.4.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.4">continued-fraction</csymbol><apply id="A6.E9Xf.3.2.2.m1.1.1.3.4.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.2"><partialdiff id="A6.E9Xf.3.2.2.m1.1.1.3.4.2.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.2.1"></partialdiff><ci id="A6.E9Xf.3.2.2.m1.1.1.3.4.2.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.2.2">𝐴</ci></apply><apply id="A6.E9Xf.3.2.2.m1.1.1.3.4.3.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3"><partialdiff id="A6.E9Xf.3.2.2.m1.1.1.3.4.3.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3.1"></partialdiff><apply id="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2"><csymbol cd="ambiguous" id="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2">subscript</csymbol><ci id="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.2">𝑄</ci><cn id="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.3.cmml" type="integer" xref="A6.E9Xf.3.2.2.m1.1.1.3.4.3.2.3">2</cn></apply></apply></apply><apply id="A6.E9Xf.3.2.2.m1.1.1.3.5.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5"><csymbol cd="latexml" id="A6.E9Xf.3.2.2.m1.1.1.3.5.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5">continued-fraction</csymbol><apply id="A6.E9Xf.3.2.2.m1.1.1.3.5.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2"><partialdiff id="A6.E9Xf.3.2.2.m1.1.1.3.5.2.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2.1"></partialdiff><apply id="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2"><csymbol cd="ambiguous" id="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2">subscript</csymbol><ci id="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.2">𝑄</ci><cn id="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.3.cmml" type="integer" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.2.2.3">2</cn></apply></apply><apply id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3"><partialdiff id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.1"></partialdiff><apply id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2"><csymbol cd="ambiguous" id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2">superscript</csymbol><ci id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.2">𝑊</ci><apply id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3"><csymbol cd="ambiguous" id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.1.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3">subscript</csymbol><ci id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.2.cmml" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.2">𝑄</ci><cn id="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.3.cmml" type="integer" xref="A6.E9Xf.3.2.2.m1.1.1.3.5.3.2.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xf.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A}%
\cfrac{\partial A}{\partial Q_{2}}\cfrac{\partial Q_{2}}{\partial W^{Q_{2}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xf.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_A end_ARG continued-fraction start_ARG ∂ italic_A end_ARG start_ARG ∂ italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xg">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{1}{\sqrt{2d}}~{}X^{\intercal}[A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}-(A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]K_{2}" class="ltx_Math" display="inline" id="A6.E9Xg.2.1.1.m1.1"><semantics id="A6.E9Xg.2.1.1.m1.1a"><mrow id="A6.E9Xg.2.1.1.m1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.cmml"><mi id="A6.E9Xg.2.1.1.m1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E9Xg.2.1.1.m1.1.1.2" xref="A6.E9Xg.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E9Xg.2.1.1.m1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xg.2.1.1.m1.1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.cmml"><mfrac id="A6.E9Xg.2.1.1.m1.1.1.1.3a" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.cmml"><mn id="A6.E9Xg.2.1.1.m1.1.1.1.3.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.2.cmml">1</mn><msqrt id="A6.E9Xg.2.1.1.m1.1.1.1.3.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3.cmml"><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.cmml"><mn id="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.2.cmml">2</mn><mo id="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.1.cmml">⁢</mo><mi id="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.3.cmml">d</mi></mrow></msqrt></mfrac></mstyle><mo id="A6.E9Xg.2.1.1.m1.1.1.1.2" lspace="0.330em" xref="A6.E9Xg.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xg.2.1.1.m1.1.1.1.4" xref="A6.E9Xg.2.1.1.m1.1.1.1.4.cmml"><mi id="A6.E9Xg.2.1.1.m1.1.1.1.4.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.4.2.cmml">X</mi><mo id="A6.E9Xg.2.1.1.m1.1.1.1.4.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.4.3.cmml">⊺</mo></msup><mo id="A6.E9Xg.2.1.1.m1.1.1.1.2a" xref="A6.E9Xg.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.2.cmml"><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.3.cmml">A</mi><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3a" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2a" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">A</mi><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">⊙</mo><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3a" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2a" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">J</mi></mrow></mrow><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="A6.E9Xg.2.1.1.m1.1.1.1.2b" xref="A6.E9Xg.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msub id="A6.E9Xg.2.1.1.m1.1.1.1.5" xref="A6.E9Xg.2.1.1.m1.1.1.1.5.cmml"><mi id="A6.E9Xg.2.1.1.m1.1.1.1.5.2" xref="A6.E9Xg.2.1.1.m1.1.1.1.5.2.cmml">K</mi><mn id="A6.E9Xg.2.1.1.m1.1.1.1.5.3" xref="A6.E9Xg.2.1.1.m1.1.1.1.5.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xg.2.1.1.m1.1b"><apply id="A6.E9Xg.2.1.1.m1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1"><eq id="A6.E9Xg.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E9Xg.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E9Xg.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1"><times id="A6.E9Xg.2.1.1.m1.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.2"></times><apply id="A6.E9Xg.2.1.1.m1.1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xg.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.3">continued-fraction</csymbol><cn id="A6.E9Xg.2.1.1.m1.1.1.1.3.2.cmml" type="integer" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.2">1</cn><apply id="A6.E9Xg.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3"><root id="A6.E9Xg.2.1.1.m1.1.1.1.3.3a.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3"></root><apply id="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2"><times id="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.1"></times><cn id="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.2.cmml" type="integer" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.2">2</cn><ci id="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.3.3.2.3">𝑑</ci></apply></apply></apply><apply id="A6.E9Xg.2.1.1.m1.1.1.1.4.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xg.2.1.1.m1.1.1.1.4.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xg.2.1.1.m1.1.1.1.4.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.4.2">𝑋</ci><ci id="A6.E9Xg.2.1.1.m1.1.1.1.4.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.4.3">⊺</ci></apply><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E9Xg.2.1.1.m1.1.1.1.1.2.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.2">direct-product</csymbol><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.3">𝐴</ci><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1"><minus id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><times id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2"><partialdiff id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3"><partialdiff id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.4.3">⊺</ci></apply></apply><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"><times id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">direct-product</csymbol><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">𝐴</ci><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><times id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2"></times><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2"><partialdiff id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3"><partialdiff id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3">⊺</ci></apply></apply></apply><ci id="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝐽</ci></apply></apply></apply></apply><apply id="A6.E9Xg.2.1.1.m1.1.1.1.5.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.5"><csymbol cd="ambiguous" id="A6.E9Xg.2.1.1.m1.1.1.1.5.1.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.5">subscript</csymbol><ci id="A6.E9Xg.2.1.1.m1.1.1.1.5.2.cmml" xref="A6.E9Xg.2.1.1.m1.1.1.1.5.2">𝐾</ci><cn id="A6.E9Xg.2.1.1.m1.1.1.1.5.3.cmml" type="integer" xref="A6.E9Xg.2.1.1.m1.1.1.1.5.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xg.2.1.1.m1.1c">\displaystyle=\cfrac{1}{\sqrt{2d}}~{}X^{\intercal}[A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}-(A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]K_{2}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xg.2.1.1.m1.1d">= continued-fraction start_ARG 1 end_ARG start_ARG square-root start_ARG 2 italic_d end_ARG end_ARG italic_X start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT [ italic_A ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT - ( italic_A ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT ) ) italic_J ) ] italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xh">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{K_{1}}}" class="ltx_Math" display="inline" id="A6.E9Xh.2.1.1.m1.1"><semantics id="A6.E9Xh.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E9Xh.2.1.1.m1.1.1" xref="A6.E9Xh.2.1.1.m1.1.1.cmml"><mfrac id="A6.E9Xh.2.1.1.m1.1.1a" xref="A6.E9Xh.2.1.1.m1.1.1.cmml"><mrow id="A6.E9Xh.2.1.1.m1.1.1.2" xref="A6.E9Xh.2.1.1.m1.1.1.2.cmml"><mo id="A6.E9Xh.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E9Xh.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E9Xh.2.1.1.m1.1.1.2.2" xref="A6.E9Xh.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xh.2.1.1.m1.1.1.3" xref="A6.E9Xh.2.1.1.m1.1.1.3.cmml"><mo id="A6.E9Xh.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E9Xh.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E9Xh.2.1.1.m1.1.1.3.2" xref="A6.E9Xh.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E9Xh.2.1.1.m1.1.1.3.2.2" xref="A6.E9Xh.2.1.1.m1.1.1.3.2.2.cmml">W</mi><msub id="A6.E9Xh.2.1.1.m1.1.1.3.2.3" xref="A6.E9Xh.2.1.1.m1.1.1.3.2.3.cmml"><mi id="A6.E9Xh.2.1.1.m1.1.1.3.2.3.2" xref="A6.E9Xh.2.1.1.m1.1.1.3.2.3.2.cmml">K</mi><mn id="A6.E9Xh.2.1.1.m1.1.1.3.2.3.3" xref="A6.E9Xh.2.1.1.m1.1.1.3.2.3.3.cmml">1</mn></msub></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E9Xh.2.1.1.m1.1b"><apply id="A6.E9Xh.2.1.1.m1.1.1.cmml" xref="A6.E9Xh.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E9Xh.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xh.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E9Xh.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.2"><partialdiff id="A6.E9Xh.2.1.1.m1.1.1.2.1.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E9Xh.2.1.1.m1.1.1.2.2.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E9Xh.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.3"><partialdiff id="A6.E9Xh.2.1.1.m1.1.1.3.1.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E9Xh.2.1.1.m1.1.1.3.2.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E9Xh.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E9Xh.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.3.2.2">𝑊</ci><apply id="A6.E9Xh.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A6.E9Xh.2.1.1.m1.1.1.3.2.3.1.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="A6.E9Xh.2.1.1.m1.1.1.3.2.3.2.cmml" xref="A6.E9Xh.2.1.1.m1.1.1.3.2.3.2">𝐾</ci><cn id="A6.E9Xh.2.1.1.m1.1.1.3.2.3.3.cmml" type="integer" xref="A6.E9Xh.2.1.1.m1.1.1.3.2.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xh.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{K_{1}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xh.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A}%
\cfrac{\partial A}{\partial K_{1}}\cfrac{\partial K_{1}}{\partial W^{K_{1}}}" class="ltx_Math" display="inline" id="A6.E9Xh.3.2.2.m1.1"><semantics id="A6.E9Xh.3.2.2.m1.1a"><mrow id="A6.E9Xh.3.2.2.m1.1.1" xref="A6.E9Xh.3.2.2.m1.1.1.cmml"><mi id="A6.E9Xh.3.2.2.m1.1.1.2" xref="A6.E9Xh.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E9Xh.3.2.2.m1.1.1.1" xref="A6.E9Xh.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E9Xh.3.2.2.m1.1.1.3" xref="A6.E9Xh.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E9Xh.3.2.2.m1.1.1.3.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E9Xh.3.2.2.m1.1.1.3.2a" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E9Xh.3.2.2.m1.1.1.3.2.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E9Xh.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E9Xh.3.2.2.m1.1.1.3.2.2.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xh.3.2.2.m1.1.1.3.2.3" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E9Xh.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E9Xh.3.2.2.m1.1.1.3.2.3.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xh.3.2.2.m1.1.1.3.1" xref="A6.E9Xh.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xh.3.2.2.m1.1.1.3.3" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E9Xh.3.2.2.m1.1.1.3.3a" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E9Xh.3.2.2.m1.1.1.3.3.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E9Xh.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E9Xh.3.2.2.m1.1.1.3.3.2.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E9Xh.3.2.2.m1.1.1.3.3.3" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E9Xh.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><mi id="A6.E9Xh.3.2.2.m1.1.1.3.3.3.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.3.2.cmml">A</mi></mrow></mfrac></mstyle><mo id="A6.E9Xh.3.2.2.m1.1.1.3.1a" xref="A6.E9Xh.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xh.3.2.2.m1.1.1.3.4" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.cmml"><mfrac id="A6.E9Xh.3.2.2.m1.1.1.3.4a" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.cmml"><mrow id="A6.E9Xh.3.2.2.m1.1.1.3.4.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.2.cmml"><mo id="A6.E9Xh.3.2.2.m1.1.1.3.4.2.1" rspace="0em" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.2.1.cmml">∂</mo><mi id="A6.E9Xh.3.2.2.m1.1.1.3.4.2.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.2.2.cmml">A</mi></mrow><mrow id="A6.E9Xh.3.2.2.m1.1.1.3.4.3" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3.cmml"><mo id="A6.E9Xh.3.2.2.m1.1.1.3.4.3.1" rspace="0em" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3.1.cmml">∂</mo><msub id="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.cmml"><mi id="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.2.cmml">K</mi><mn id="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.3" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.3.cmml">1</mn></msub></mrow></mfrac></mstyle><mo id="A6.E9Xh.3.2.2.m1.1.1.3.1b" xref="A6.E9Xh.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xh.3.2.2.m1.1.1.3.5" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.cmml"><mfrac id="A6.E9Xh.3.2.2.m1.1.1.3.5a" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.cmml"><mrow id="A6.E9Xh.3.2.2.m1.1.1.3.5.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2.cmml"><mo id="A6.E9Xh.3.2.2.m1.1.1.3.5.2.1" rspace="0em" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2.1.cmml">∂</mo><msub id="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.cmml"><mi id="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.2.cmml">K</mi><mn id="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.3" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.3.cmml">1</mn></msub></mrow><mrow id="A6.E9Xh.3.2.2.m1.1.1.3.5.3" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.cmml"><mo id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.1" rspace="0em" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.1.cmml">∂</mo><msup id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.cmml"><mi id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.2.cmml">W</mi><msub id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.cmml"><mi id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.2" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.2.cmml">K</mi><mn id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.3" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.3.cmml">1</mn></msub></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xh.3.2.2.m1.1b"><apply id="A6.E9Xh.3.2.2.m1.1.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1"><eq id="A6.E9Xh.3.2.2.m1.1.1.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E9Xh.3.2.2.m1.1.1.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E9Xh.3.2.2.m1.1.1.3.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3"><times id="A6.E9Xh.3.2.2.m1.1.1.3.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.1"></times><apply id="A6.E9Xh.3.2.2.m1.1.1.3.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E9Xh.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E9Xh.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E9Xh.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E9Xh.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E9Xh.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E9Xh.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E9Xh.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xh.3.2.2.m1.1.1.3.3.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E9Xh.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E9Xh.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E9Xh.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E9Xh.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E9Xh.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E9Xh.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.3.1"></partialdiff><ci id="A6.E9Xh.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.3.3.2">𝐴</ci></apply></apply><apply id="A6.E9Xh.3.2.2.m1.1.1.3.4.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.4"><csymbol cd="latexml" id="A6.E9Xh.3.2.2.m1.1.1.3.4.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.4">continued-fraction</csymbol><apply id="A6.E9Xh.3.2.2.m1.1.1.3.4.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.2"><partialdiff id="A6.E9Xh.3.2.2.m1.1.1.3.4.2.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.2.1"></partialdiff><ci id="A6.E9Xh.3.2.2.m1.1.1.3.4.2.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.2.2">𝐴</ci></apply><apply id="A6.E9Xh.3.2.2.m1.1.1.3.4.3.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3"><partialdiff id="A6.E9Xh.3.2.2.m1.1.1.3.4.3.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3.1"></partialdiff><apply id="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2"><csymbol cd="ambiguous" id="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2">subscript</csymbol><ci id="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.2">𝐾</ci><cn id="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.3.cmml" type="integer" xref="A6.E9Xh.3.2.2.m1.1.1.3.4.3.2.3">1</cn></apply></apply></apply><apply id="A6.E9Xh.3.2.2.m1.1.1.3.5.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5"><csymbol cd="latexml" id="A6.E9Xh.3.2.2.m1.1.1.3.5.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5">continued-fraction</csymbol><apply id="A6.E9Xh.3.2.2.m1.1.1.3.5.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2"><partialdiff id="A6.E9Xh.3.2.2.m1.1.1.3.5.2.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2.1"></partialdiff><apply id="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2"><csymbol cd="ambiguous" id="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2">subscript</csymbol><ci id="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.2">𝐾</ci><cn id="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.3.cmml" type="integer" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.2.2.3">1</cn></apply></apply><apply id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3"><partialdiff id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.1"></partialdiff><apply id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2"><csymbol cd="ambiguous" id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2">superscript</csymbol><ci id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.2">𝑊</ci><apply id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3"><csymbol cd="ambiguous" id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.1.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3">subscript</csymbol><ci id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.2.cmml" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.2">𝐾</ci><cn id="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.3.cmml" type="integer" xref="A6.E9Xh.3.2.2.m1.1.1.3.5.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xh.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A}%
\cfrac{\partial A}{\partial K_{1}}\cfrac{\partial K_{1}}{\partial W^{K_{1}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xh.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_A end_ARG continued-fraction start_ARG ∂ italic_A end_ARG start_ARG ∂ italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xi">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{1}{\sqrt{2d}}~{}X^{\intercal}[A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}-(A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]^{\intercal}Q_{1}" class="ltx_Math" display="inline" id="A6.E9Xi.2.1.1.m1.1"><semantics id="A6.E9Xi.2.1.1.m1.1a"><mrow id="A6.E9Xi.2.1.1.m1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.cmml"><mi id="A6.E9Xi.2.1.1.m1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E9Xi.2.1.1.m1.1.1.2" xref="A6.E9Xi.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E9Xi.2.1.1.m1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xi.2.1.1.m1.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.cmml"><mfrac id="A6.E9Xi.2.1.1.m1.1.1.1.3a" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.cmml"><mn id="A6.E9Xi.2.1.1.m1.1.1.1.3.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.2.cmml">1</mn><msqrt id="A6.E9Xi.2.1.1.m1.1.1.1.3.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3.cmml"><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.cmml"><mn id="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.2.cmml">2</mn><mo id="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.1.cmml">⁢</mo><mi id="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.3.cmml">d</mi></mrow></msqrt></mfrac></mstyle><mo id="A6.E9Xi.2.1.1.m1.1.1.1.2" lspace="0.330em" xref="A6.E9Xi.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xi.2.1.1.m1.1.1.1.4" xref="A6.E9Xi.2.1.1.m1.1.1.1.4.cmml"><mi id="A6.E9Xi.2.1.1.m1.1.1.1.4.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.4.2.cmml">X</mi><mo id="A6.E9Xi.2.1.1.m1.1.1.1.4.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.4.3.cmml">⊺</mo></msup><mo id="A6.E9Xi.2.1.1.m1.1.1.1.2a" xref="A6.E9Xi.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xi.2.1.1.m1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.cmml"><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.2.cmml"><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">A</mi><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3a" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">A</mi><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">⊙</mo><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3a" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2a" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">J</mi></mrow></mrow><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="A6.E9Xi.2.1.1.m1.1.1.1.1.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xi.2.1.1.m1.1.1.1.2b" xref="A6.E9Xi.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msub id="A6.E9Xi.2.1.1.m1.1.1.1.5" xref="A6.E9Xi.2.1.1.m1.1.1.1.5.cmml"><mi id="A6.E9Xi.2.1.1.m1.1.1.1.5.2" xref="A6.E9Xi.2.1.1.m1.1.1.1.5.2.cmml">Q</mi><mn id="A6.E9Xi.2.1.1.m1.1.1.1.5.3" xref="A6.E9Xi.2.1.1.m1.1.1.1.5.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xi.2.1.1.m1.1b"><apply id="A6.E9Xi.2.1.1.m1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1"><eq id="A6.E9Xi.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E9Xi.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E9Xi.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1"><times id="A6.E9Xi.2.1.1.m1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.2"></times><apply id="A6.E9Xi.2.1.1.m1.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xi.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.3">continued-fraction</csymbol><cn id="A6.E9Xi.2.1.1.m1.1.1.1.3.2.cmml" type="integer" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.2">1</cn><apply id="A6.E9Xi.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3"><root id="A6.E9Xi.2.1.1.m1.1.1.1.3.3a.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3"></root><apply id="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2"><times id="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.1"></times><cn id="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.2.cmml" type="integer" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.2">2</cn><ci id="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.3.3.2.3">𝑑</ci></apply></apply></apply><apply id="A6.E9Xi.2.1.1.m1.1.1.1.4.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xi.2.1.1.m1.1.1.1.4.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xi.2.1.1.m1.1.1.1.4.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.4.2">𝑋</ci><ci id="A6.E9Xi.2.1.1.m1.1.1.1.4.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.4.3">⊺</ci></apply><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xi.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.2">direct-product</csymbol><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.3">𝐴</ci><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1"><minus id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2"><partialdiff id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><partialdiff id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3">⊺</ci></apply></apply><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"><times id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">direct-product</csymbol><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">𝐴</ci><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><times id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2"></times><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2"><partialdiff id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3"><partialdiff id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3">⊺</ci></apply></apply></apply><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝐽</ci></apply></apply></apply></apply><ci id="A6.E9Xi.2.1.1.m1.1.1.1.1.3.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xi.2.1.1.m1.1.1.1.5.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.5"><csymbol cd="ambiguous" id="A6.E9Xi.2.1.1.m1.1.1.1.5.1.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.5">subscript</csymbol><ci id="A6.E9Xi.2.1.1.m1.1.1.1.5.2.cmml" xref="A6.E9Xi.2.1.1.m1.1.1.1.5.2">𝑄</ci><cn id="A6.E9Xi.2.1.1.m1.1.1.1.5.3.cmml" type="integer" xref="A6.E9Xi.2.1.1.m1.1.1.1.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xi.2.1.1.m1.1c">\displaystyle=\cfrac{1}{\sqrt{2d}}~{}X^{\intercal}[A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}-(A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]^{\intercal}Q_{1}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xi.2.1.1.m1.1d">= continued-fraction start_ARG 1 end_ARG start_ARG square-root start_ARG 2 italic_d end_ARG end_ARG italic_X start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT [ italic_A ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT - ( italic_A ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT ) ) italic_J ) ] start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xj">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cfrac{\partial L}{\partial W^{K_{2}}}" class="ltx_Math" display="inline" id="A6.E9Xj.2.1.1.m1.1"><semantics id="A6.E9Xj.2.1.1.m1.1a"><mstyle displaystyle="true" id="A6.E9Xj.2.1.1.m1.1.1" xref="A6.E9Xj.2.1.1.m1.1.1.cmml"><mfrac id="A6.E9Xj.2.1.1.m1.1.1a" xref="A6.E9Xj.2.1.1.m1.1.1.cmml"><mrow id="A6.E9Xj.2.1.1.m1.1.1.2" xref="A6.E9Xj.2.1.1.m1.1.1.2.cmml"><mo id="A6.E9Xj.2.1.1.m1.1.1.2.1" rspace="0em" xref="A6.E9Xj.2.1.1.m1.1.1.2.1.cmml">∂</mo><mi id="A6.E9Xj.2.1.1.m1.1.1.2.2" xref="A6.E9Xj.2.1.1.m1.1.1.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xj.2.1.1.m1.1.1.3" xref="A6.E9Xj.2.1.1.m1.1.1.3.cmml"><mo id="A6.E9Xj.2.1.1.m1.1.1.3.1" rspace="0em" xref="A6.E9Xj.2.1.1.m1.1.1.3.1.cmml">∂</mo><msup id="A6.E9Xj.2.1.1.m1.1.1.3.2" xref="A6.E9Xj.2.1.1.m1.1.1.3.2.cmml"><mi id="A6.E9Xj.2.1.1.m1.1.1.3.2.2" xref="A6.E9Xj.2.1.1.m1.1.1.3.2.2.cmml">W</mi><msub id="A6.E9Xj.2.1.1.m1.1.1.3.2.3" xref="A6.E9Xj.2.1.1.m1.1.1.3.2.3.cmml"><mi id="A6.E9Xj.2.1.1.m1.1.1.3.2.3.2" xref="A6.E9Xj.2.1.1.m1.1.1.3.2.3.2.cmml">K</mi><mn id="A6.E9Xj.2.1.1.m1.1.1.3.2.3.3" xref="A6.E9Xj.2.1.1.m1.1.1.3.2.3.3.cmml">2</mn></msub></msup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A6.E9Xj.2.1.1.m1.1b"><apply id="A6.E9Xj.2.1.1.m1.1.1.cmml" xref="A6.E9Xj.2.1.1.m1.1.1"><csymbol cd="latexml" id="A6.E9Xj.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xj.2.1.1.m1.1.1">continued-fraction</csymbol><apply id="A6.E9Xj.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.2"><partialdiff id="A6.E9Xj.2.1.1.m1.1.1.2.1.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.2.1"></partialdiff><ci id="A6.E9Xj.2.1.1.m1.1.1.2.2.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.2.2">𝐿</ci></apply><apply id="A6.E9Xj.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.3"><partialdiff id="A6.E9Xj.2.1.1.m1.1.1.3.1.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.3.1"></partialdiff><apply id="A6.E9Xj.2.1.1.m1.1.1.3.2.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A6.E9Xj.2.1.1.m1.1.1.3.2.1.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A6.E9Xj.2.1.1.m1.1.1.3.2.2.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.3.2.2">𝑊</ci><apply id="A6.E9Xj.2.1.1.m1.1.1.3.2.3.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="A6.E9Xj.2.1.1.m1.1.1.3.2.3.1.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="A6.E9Xj.2.1.1.m1.1.1.3.2.3.2.cmml" xref="A6.E9Xj.2.1.1.m1.1.1.3.2.3.2">𝐾</ci><cn id="A6.E9Xj.2.1.1.m1.1.1.3.2.3.3.cmml" type="integer" xref="A6.E9Xj.2.1.1.m1.1.1.3.2.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xj.2.1.1.m1.1c">\displaystyle\cfrac{\partial L}{\partial W^{K_{2}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xj.2.1.1.m1.1d">continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A}%
\cfrac{\partial A}{\partial K_{2}}\cfrac{\partial K_{2}}{\partial W^{K_{2}}}" class="ltx_Math" display="inline" id="A6.E9Xj.3.2.2.m1.1"><semantics id="A6.E9Xj.3.2.2.m1.1a"><mrow id="A6.E9Xj.3.2.2.m1.1.1" xref="A6.E9Xj.3.2.2.m1.1.1.cmml"><mi id="A6.E9Xj.3.2.2.m1.1.1.2" xref="A6.E9Xj.3.2.2.m1.1.1.2.cmml"></mi><mo id="A6.E9Xj.3.2.2.m1.1.1.1" xref="A6.E9Xj.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A6.E9Xj.3.2.2.m1.1.1.3" xref="A6.E9Xj.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="A6.E9Xj.3.2.2.m1.1.1.3.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.cmml"><mfrac id="A6.E9Xj.3.2.2.m1.1.1.3.2a" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.cmml"><mrow id="A6.E9Xj.3.2.2.m1.1.1.3.2.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.2.cmml"><mo id="A6.E9Xj.3.2.2.m1.1.1.3.2.2.1" rspace="0em" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.2.1.cmml">∂</mo><mi id="A6.E9Xj.3.2.2.m1.1.1.3.2.2.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xj.3.2.2.m1.1.1.3.2.3" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.3.cmml"><mo id="A6.E9Xj.3.2.2.m1.1.1.3.2.3.1" rspace="0em" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.3.1.cmml">∂</mo><mi id="A6.E9Xj.3.2.2.m1.1.1.3.2.3.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xj.3.2.2.m1.1.1.3.1" xref="A6.E9Xj.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xj.3.2.2.m1.1.1.3.3" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.cmml"><mfrac id="A6.E9Xj.3.2.2.m1.1.1.3.3a" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.cmml"><mrow id="A6.E9Xj.3.2.2.m1.1.1.3.3.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.2.cmml"><mo id="A6.E9Xj.3.2.2.m1.1.1.3.3.2.1" rspace="0em" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.2.1.cmml">∂</mo><mi id="A6.E9Xj.3.2.2.m1.1.1.3.3.2.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.2.2.cmml">O</mi></mrow><mrow id="A6.E9Xj.3.2.2.m1.1.1.3.3.3" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.3.cmml"><mo id="A6.E9Xj.3.2.2.m1.1.1.3.3.3.1" rspace="0em" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.3.1.cmml">∂</mo><mi id="A6.E9Xj.3.2.2.m1.1.1.3.3.3.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.3.2.cmml">A</mi></mrow></mfrac></mstyle><mo id="A6.E9Xj.3.2.2.m1.1.1.3.1a" xref="A6.E9Xj.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xj.3.2.2.m1.1.1.3.4" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.cmml"><mfrac id="A6.E9Xj.3.2.2.m1.1.1.3.4a" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.cmml"><mrow id="A6.E9Xj.3.2.2.m1.1.1.3.4.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.2.cmml"><mo id="A6.E9Xj.3.2.2.m1.1.1.3.4.2.1" rspace="0em" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.2.1.cmml">∂</mo><mi id="A6.E9Xj.3.2.2.m1.1.1.3.4.2.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.2.2.cmml">A</mi></mrow><mrow id="A6.E9Xj.3.2.2.m1.1.1.3.4.3" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3.cmml"><mo id="A6.E9Xj.3.2.2.m1.1.1.3.4.3.1" rspace="0em" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3.1.cmml">∂</mo><msub id="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.cmml"><mi id="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.2.cmml">K</mi><mn id="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.3" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo id="A6.E9Xj.3.2.2.m1.1.1.3.1b" xref="A6.E9Xj.3.2.2.m1.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A6.E9Xj.3.2.2.m1.1.1.3.5" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.cmml"><mfrac id="A6.E9Xj.3.2.2.m1.1.1.3.5a" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.cmml"><mrow id="A6.E9Xj.3.2.2.m1.1.1.3.5.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2.cmml"><mo id="A6.E9Xj.3.2.2.m1.1.1.3.5.2.1" rspace="0em" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2.1.cmml">∂</mo><msub id="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.cmml"><mi id="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.2.cmml">K</mi><mn id="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.3" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.3.cmml">2</mn></msub></mrow><mrow id="A6.E9Xj.3.2.2.m1.1.1.3.5.3" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.cmml"><mo id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.1" rspace="0em" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.1.cmml">∂</mo><msup id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.cmml"><mi id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.2.cmml">W</mi><msub id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.cmml"><mi id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.2" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.2.cmml">K</mi><mn id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.3" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.3.cmml">2</mn></msub></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xj.3.2.2.m1.1b"><apply id="A6.E9Xj.3.2.2.m1.1.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1"><eq id="A6.E9Xj.3.2.2.m1.1.1.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A6.E9Xj.3.2.2.m1.1.1.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.2">absent</csymbol><apply id="A6.E9Xj.3.2.2.m1.1.1.3.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3"><times id="A6.E9Xj.3.2.2.m1.1.1.3.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.1"></times><apply id="A6.E9Xj.3.2.2.m1.1.1.3.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.2"><csymbol cd="latexml" id="A6.E9Xj.3.2.2.m1.1.1.3.2.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.2">continued-fraction</csymbol><apply id="A6.E9Xj.3.2.2.m1.1.1.3.2.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.2"><partialdiff id="A6.E9Xj.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.2.1"></partialdiff><ci id="A6.E9Xj.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A6.E9Xj.3.2.2.m1.1.1.3.2.3.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.3"><partialdiff id="A6.E9Xj.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.3.1"></partialdiff><ci id="A6.E9Xj.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.2.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xj.3.2.2.m1.1.1.3.3.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.3"><csymbol cd="latexml" id="A6.E9Xj.3.2.2.m1.1.1.3.3.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.3">continued-fraction</csymbol><apply id="A6.E9Xj.3.2.2.m1.1.1.3.3.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.2"><partialdiff id="A6.E9Xj.3.2.2.m1.1.1.3.3.2.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.2.1"></partialdiff><ci id="A6.E9Xj.3.2.2.m1.1.1.3.3.2.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.2.2">𝑂</ci></apply><apply id="A6.E9Xj.3.2.2.m1.1.1.3.3.3.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.3"><partialdiff id="A6.E9Xj.3.2.2.m1.1.1.3.3.3.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.3.1"></partialdiff><ci id="A6.E9Xj.3.2.2.m1.1.1.3.3.3.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.3.3.2">𝐴</ci></apply></apply><apply id="A6.E9Xj.3.2.2.m1.1.1.3.4.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.4"><csymbol cd="latexml" id="A6.E9Xj.3.2.2.m1.1.1.3.4.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.4">continued-fraction</csymbol><apply id="A6.E9Xj.3.2.2.m1.1.1.3.4.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.2"><partialdiff id="A6.E9Xj.3.2.2.m1.1.1.3.4.2.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.2.1"></partialdiff><ci id="A6.E9Xj.3.2.2.m1.1.1.3.4.2.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.2.2">𝐴</ci></apply><apply id="A6.E9Xj.3.2.2.m1.1.1.3.4.3.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3"><partialdiff id="A6.E9Xj.3.2.2.m1.1.1.3.4.3.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3.1"></partialdiff><apply id="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2"><csymbol cd="ambiguous" id="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2">subscript</csymbol><ci id="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.2">𝐾</ci><cn id="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.3.cmml" type="integer" xref="A6.E9Xj.3.2.2.m1.1.1.3.4.3.2.3">2</cn></apply></apply></apply><apply id="A6.E9Xj.3.2.2.m1.1.1.3.5.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5"><csymbol cd="latexml" id="A6.E9Xj.3.2.2.m1.1.1.3.5.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5">continued-fraction</csymbol><apply id="A6.E9Xj.3.2.2.m1.1.1.3.5.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2"><partialdiff id="A6.E9Xj.3.2.2.m1.1.1.3.5.2.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2.1"></partialdiff><apply id="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2"><csymbol cd="ambiguous" id="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2">subscript</csymbol><ci id="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.2">𝐾</ci><cn id="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.3.cmml" type="integer" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.2.2.3">2</cn></apply></apply><apply id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3"><partialdiff id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.1"></partialdiff><apply id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2"><csymbol cd="ambiguous" id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2">superscript</csymbol><ci id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.2">𝑊</ci><apply id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3"><csymbol cd="ambiguous" id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.1.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3">subscript</csymbol><ci id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.2.cmml" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.2">𝐾</ci><cn id="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.3.cmml" type="integer" xref="A6.E9Xj.3.2.2.m1.1.1.3.5.3.2.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xj.3.2.2.m1.1c">\displaystyle=\cfrac{\partial L}{\partial O}\cfrac{\partial O}{\partial A}%
\cfrac{\partial A}{\partial K_{2}}\cfrac{\partial K_{2}}{\partial W^{K_{2}}}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xj.3.2.2.m1.1d">= continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG continued-fraction start_ARG ∂ italic_O end_ARG start_ARG ∂ italic_A end_ARG continued-fraction start_ARG ∂ italic_A end_ARG start_ARG ∂ italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG continued-fraction start_ARG ∂ italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_W start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A6.E9Xk">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cfrac{1}{\sqrt{2d}}~{}X^{\intercal}[A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}-(A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]^{\intercal}Q_{2}" class="ltx_Math" display="inline" id="A6.E9Xk.2.1.1.m1.1"><semantics id="A6.E9Xk.2.1.1.m1.1a"><mrow id="A6.E9Xk.2.1.1.m1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.cmml"><mi id="A6.E9Xk.2.1.1.m1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.3.cmml"></mi><mo id="A6.E9Xk.2.1.1.m1.1.1.2" xref="A6.E9Xk.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A6.E9Xk.2.1.1.m1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xk.2.1.1.m1.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.cmml"><mfrac id="A6.E9Xk.2.1.1.m1.1.1.1.3a" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.cmml"><mn id="A6.E9Xk.2.1.1.m1.1.1.1.3.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.2.cmml">1</mn><msqrt id="A6.E9Xk.2.1.1.m1.1.1.1.3.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3.cmml"><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.cmml"><mn id="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.2.cmml">2</mn><mo id="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.1.cmml">⁢</mo><mi id="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.3.cmml">d</mi></mrow></msqrt></mfrac></mstyle><mo id="A6.E9Xk.2.1.1.m1.1.1.1.2" lspace="0.330em" xref="A6.E9Xk.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xk.2.1.1.m1.1.1.1.4" xref="A6.E9Xk.2.1.1.m1.1.1.1.4.cmml"><mi id="A6.E9Xk.2.1.1.m1.1.1.1.4.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.4.2.cmml">X</mi><mo id="A6.E9Xk.2.1.1.m1.1.1.1.4.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.4.3.cmml">⊺</mo></msup><mo id="A6.E9Xk.2.1.1.m1.1.1.1.2a" xref="A6.E9Xk.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xk.2.1.1.m1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.cmml"><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.2.cmml"><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">A</mi><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3a" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">A</mi><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">⊙</mo><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mfrac id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3a" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml"><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" rspace="0em" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml"><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1" rspace="0em" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml">O</mi></mrow></mfrac></mstyle><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi></msup><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2a" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml">V</mi><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml">⊺</mo></msup></mrow><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mi id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">J</mi></mrow></mrow><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="A6.E9Xk.2.1.1.m1.1.1.1.1.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.3.cmml">⊺</mo></msup><mo id="A6.E9Xk.2.1.1.m1.1.1.1.2b" xref="A6.E9Xk.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msub id="A6.E9Xk.2.1.1.m1.1.1.1.5" xref="A6.E9Xk.2.1.1.m1.1.1.1.5.cmml"><mi id="A6.E9Xk.2.1.1.m1.1.1.1.5.2" xref="A6.E9Xk.2.1.1.m1.1.1.1.5.2.cmml">Q</mi><mn id="A6.E9Xk.2.1.1.m1.1.1.1.5.3" xref="A6.E9Xk.2.1.1.m1.1.1.1.5.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E9Xk.2.1.1.m1.1b"><apply id="A6.E9Xk.2.1.1.m1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1"><eq id="A6.E9Xk.2.1.1.m1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="A6.E9Xk.2.1.1.m1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.3">absent</csymbol><apply id="A6.E9Xk.2.1.1.m1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1"><times id="A6.E9Xk.2.1.1.m1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.2"></times><apply id="A6.E9Xk.2.1.1.m1.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xk.2.1.1.m1.1.1.1.3.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.3">continued-fraction</csymbol><cn id="A6.E9Xk.2.1.1.m1.1.1.1.3.2.cmml" type="integer" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.2">1</cn><apply id="A6.E9Xk.2.1.1.m1.1.1.1.3.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3"><root id="A6.E9Xk.2.1.1.m1.1.1.1.3.3a.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3"></root><apply id="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2"><times id="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.1"></times><cn id="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.2.cmml" type="integer" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.2">2</cn><ci id="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.3.3.2.3">𝑑</ci></apply></apply></apply><apply id="A6.E9Xk.2.1.1.m1.1.1.1.4.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xk.2.1.1.m1.1.1.1.4.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xk.2.1.1.m1.1.1.1.4.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.4.2">𝑋</ci><ci id="A6.E9Xk.2.1.1.m1.1.1.1.4.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.4.3">⊺</ci></apply><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xk.2.1.1.m1.1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.2">direct-product</csymbol><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.3">𝐴</ci><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1"><minus id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2"><partialdiff id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><partialdiff id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3">⊺</ci></apply></apply><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2"><times id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">direct-product</csymbol><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">𝐴</ci><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><times id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2"></times><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3">continued-fraction</csymbol><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2"><partialdiff id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3"><partialdiff id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.3.2">𝑂</ci></apply></apply><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci></apply><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.2">𝑉</ci><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.4.3">⊺</ci></apply></apply></apply><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝐽</ci></apply></apply></apply></apply><ci id="A6.E9Xk.2.1.1.m1.1.1.1.1.3.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.1.3">⊺</ci></apply><apply id="A6.E9Xk.2.1.1.m1.1.1.1.5.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.5"><csymbol cd="ambiguous" id="A6.E9Xk.2.1.1.m1.1.1.1.5.1.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.5">subscript</csymbol><ci id="A6.E9Xk.2.1.1.m1.1.1.1.5.2.cmml" xref="A6.E9Xk.2.1.1.m1.1.1.1.5.2">𝑄</ci><cn id="A6.E9Xk.2.1.1.m1.1.1.1.5.3.cmml" type="integer" xref="A6.E9Xk.2.1.1.m1.1.1.1.5.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E9Xk.2.1.1.m1.1c">\displaystyle=\cfrac{1}{\sqrt{2d}}~{}X^{\intercal}[A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}-(A\odot(\cfrac{\partial L}{%
\partial O}(W^{O})^{\intercal}V^{\intercal}))J)]^{\intercal}Q_{2}</annotation><annotation encoding="application/x-llamapun" id="A6.E9Xk.2.1.1.m1.1d">= continued-fraction start_ARG 1 end_ARG start_ARG square-root start_ARG 2 italic_d end_ARG end_ARG italic_X start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT [ italic_A ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT - ( italic_A ⊙ ( continued-fraction start_ARG ∂ italic_L end_ARG start_ARG ∂ italic_O end_ARG ( italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_V start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT ) ) italic_J ) ] start_POSTSUPERSCRIPT ⊺ end_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A6.p4">
<p class="ltx_p" id="A6.p4.2">With the property of <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="A6.p4.1.m1.1"><semantics id="A6.p4.1.m1.1a"><mi id="A6.p4.1.m1.1.1" xref="A6.p4.1.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="A6.p4.1.m1.1b"><ci id="A6.p4.1.m1.1.1.cmml" xref="A6.p4.1.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p4.1.m1.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="A6.p4.1.m1.1d">roman_softmax</annotation></semantics></math>, we have <math alttext="A\overset{\Theta}{=}A_{1}\overset{\Theta}{=}A_{2}\overset{\Theta}{=}A_{1}-%
\lambda A_{2}" class="ltx_Math" display="inline" id="A6.p4.2.m2.1"><semantics id="A6.p4.2.m2.1a"><mrow id="A6.p4.2.m2.1.1" xref="A6.p4.2.m2.1.1.cmml"><mrow id="A6.p4.2.m2.1.1.2" xref="A6.p4.2.m2.1.1.2.cmml"><mi id="A6.p4.2.m2.1.1.2.2" xref="A6.p4.2.m2.1.1.2.2.cmml">A</mi><mo id="A6.p4.2.m2.1.1.2.1" xref="A6.p4.2.m2.1.1.2.1.cmml">⁢</mo><mover accent="true" id="A6.p4.2.m2.1.1.2.3" xref="A6.p4.2.m2.1.1.2.3.cmml"><mo id="A6.p4.2.m2.1.1.2.3.2" xref="A6.p4.2.m2.1.1.2.3.2.cmml">=</mo><mo id="A6.p4.2.m2.1.1.2.3.1" xref="A6.p4.2.m2.1.1.2.3.1.cmml">Θ</mo></mover><mo id="A6.p4.2.m2.1.1.2.1a" xref="A6.p4.2.m2.1.1.2.1.cmml">⁢</mo><msub id="A6.p4.2.m2.1.1.2.4" xref="A6.p4.2.m2.1.1.2.4.cmml"><mi id="A6.p4.2.m2.1.1.2.4.2" xref="A6.p4.2.m2.1.1.2.4.2.cmml">A</mi><mn id="A6.p4.2.m2.1.1.2.4.3" xref="A6.p4.2.m2.1.1.2.4.3.cmml">1</mn></msub><mo id="A6.p4.2.m2.1.1.2.1b" xref="A6.p4.2.m2.1.1.2.1.cmml">⁢</mo><mover accent="true" id="A6.p4.2.m2.1.1.2.5" xref="A6.p4.2.m2.1.1.2.5.cmml"><mo id="A6.p4.2.m2.1.1.2.5.2" xref="A6.p4.2.m2.1.1.2.5.2.cmml">=</mo><mo id="A6.p4.2.m2.1.1.2.5.1" xref="A6.p4.2.m2.1.1.2.5.1.cmml">Θ</mo></mover><mo id="A6.p4.2.m2.1.1.2.1c" xref="A6.p4.2.m2.1.1.2.1.cmml">⁢</mo><msub id="A6.p4.2.m2.1.1.2.6" xref="A6.p4.2.m2.1.1.2.6.cmml"><mi id="A6.p4.2.m2.1.1.2.6.2" xref="A6.p4.2.m2.1.1.2.6.2.cmml">A</mi><mn id="A6.p4.2.m2.1.1.2.6.3" xref="A6.p4.2.m2.1.1.2.6.3.cmml">2</mn></msub><mo id="A6.p4.2.m2.1.1.2.1d" xref="A6.p4.2.m2.1.1.2.1.cmml">⁢</mo><mover accent="true" id="A6.p4.2.m2.1.1.2.7" xref="A6.p4.2.m2.1.1.2.7.cmml"><mo id="A6.p4.2.m2.1.1.2.7.2" xref="A6.p4.2.m2.1.1.2.7.2.cmml">=</mo><mo id="A6.p4.2.m2.1.1.2.7.1" xref="A6.p4.2.m2.1.1.2.7.1.cmml">Θ</mo></mover><mo id="A6.p4.2.m2.1.1.2.1e" xref="A6.p4.2.m2.1.1.2.1.cmml">⁢</mo><msub id="A6.p4.2.m2.1.1.2.8" xref="A6.p4.2.m2.1.1.2.8.cmml"><mi id="A6.p4.2.m2.1.1.2.8.2" xref="A6.p4.2.m2.1.1.2.8.2.cmml">A</mi><mn id="A6.p4.2.m2.1.1.2.8.3" xref="A6.p4.2.m2.1.1.2.8.3.cmml">1</mn></msub></mrow><mo id="A6.p4.2.m2.1.1.1" xref="A6.p4.2.m2.1.1.1.cmml">−</mo><mrow id="A6.p4.2.m2.1.1.3" xref="A6.p4.2.m2.1.1.3.cmml"><mi id="A6.p4.2.m2.1.1.3.2" xref="A6.p4.2.m2.1.1.3.2.cmml">λ</mi><mo id="A6.p4.2.m2.1.1.3.1" xref="A6.p4.2.m2.1.1.3.1.cmml">⁢</mo><msub id="A6.p4.2.m2.1.1.3.3" xref="A6.p4.2.m2.1.1.3.3.cmml"><mi id="A6.p4.2.m2.1.1.3.3.2" xref="A6.p4.2.m2.1.1.3.3.2.cmml">A</mi><mn id="A6.p4.2.m2.1.1.3.3.3" xref="A6.p4.2.m2.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p4.2.m2.1b"><apply id="A6.p4.2.m2.1.1.cmml" xref="A6.p4.2.m2.1.1"><minus id="A6.p4.2.m2.1.1.1.cmml" xref="A6.p4.2.m2.1.1.1"></minus><apply id="A6.p4.2.m2.1.1.2.cmml" xref="A6.p4.2.m2.1.1.2"><times id="A6.p4.2.m2.1.1.2.1.cmml" xref="A6.p4.2.m2.1.1.2.1"></times><ci id="A6.p4.2.m2.1.1.2.2.cmml" xref="A6.p4.2.m2.1.1.2.2">𝐴</ci><apply id="A6.p4.2.m2.1.1.2.3.cmml" xref="A6.p4.2.m2.1.1.2.3"><ci id="A6.p4.2.m2.1.1.2.3.1.cmml" xref="A6.p4.2.m2.1.1.2.3.1">Θ</ci><eq id="A6.p4.2.m2.1.1.2.3.2.cmml" xref="A6.p4.2.m2.1.1.2.3.2"></eq></apply><apply id="A6.p4.2.m2.1.1.2.4.cmml" xref="A6.p4.2.m2.1.1.2.4"><csymbol cd="ambiguous" id="A6.p4.2.m2.1.1.2.4.1.cmml" xref="A6.p4.2.m2.1.1.2.4">subscript</csymbol><ci id="A6.p4.2.m2.1.1.2.4.2.cmml" xref="A6.p4.2.m2.1.1.2.4.2">𝐴</ci><cn id="A6.p4.2.m2.1.1.2.4.3.cmml" type="integer" xref="A6.p4.2.m2.1.1.2.4.3">1</cn></apply><apply id="A6.p4.2.m2.1.1.2.5.cmml" xref="A6.p4.2.m2.1.1.2.5"><ci id="A6.p4.2.m2.1.1.2.5.1.cmml" xref="A6.p4.2.m2.1.1.2.5.1">Θ</ci><eq id="A6.p4.2.m2.1.1.2.5.2.cmml" xref="A6.p4.2.m2.1.1.2.5.2"></eq></apply><apply id="A6.p4.2.m2.1.1.2.6.cmml" xref="A6.p4.2.m2.1.1.2.6"><csymbol cd="ambiguous" id="A6.p4.2.m2.1.1.2.6.1.cmml" xref="A6.p4.2.m2.1.1.2.6">subscript</csymbol><ci id="A6.p4.2.m2.1.1.2.6.2.cmml" xref="A6.p4.2.m2.1.1.2.6.2">𝐴</ci><cn id="A6.p4.2.m2.1.1.2.6.3.cmml" type="integer" xref="A6.p4.2.m2.1.1.2.6.3">2</cn></apply><apply id="A6.p4.2.m2.1.1.2.7.cmml" xref="A6.p4.2.m2.1.1.2.7"><ci id="A6.p4.2.m2.1.1.2.7.1.cmml" xref="A6.p4.2.m2.1.1.2.7.1">Θ</ci><eq id="A6.p4.2.m2.1.1.2.7.2.cmml" xref="A6.p4.2.m2.1.1.2.7.2"></eq></apply><apply id="A6.p4.2.m2.1.1.2.8.cmml" xref="A6.p4.2.m2.1.1.2.8"><csymbol cd="ambiguous" id="A6.p4.2.m2.1.1.2.8.1.cmml" xref="A6.p4.2.m2.1.1.2.8">subscript</csymbol><ci id="A6.p4.2.m2.1.1.2.8.2.cmml" xref="A6.p4.2.m2.1.1.2.8.2">𝐴</ci><cn id="A6.p4.2.m2.1.1.2.8.3.cmml" type="integer" xref="A6.p4.2.m2.1.1.2.8.3">1</cn></apply></apply><apply id="A6.p4.2.m2.1.1.3.cmml" xref="A6.p4.2.m2.1.1.3"><times id="A6.p4.2.m2.1.1.3.1.cmml" xref="A6.p4.2.m2.1.1.3.1"></times><ci id="A6.p4.2.m2.1.1.3.2.cmml" xref="A6.p4.2.m2.1.1.3.2">𝜆</ci><apply id="A6.p4.2.m2.1.1.3.3.cmml" xref="A6.p4.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A6.p4.2.m2.1.1.3.3.1.cmml" xref="A6.p4.2.m2.1.1.3.3">subscript</csymbol><ci id="A6.p4.2.m2.1.1.3.3.2.cmml" xref="A6.p4.2.m2.1.1.3.3.2">𝐴</ci><cn id="A6.p4.2.m2.1.1.3.3.3.cmml" type="integer" xref="A6.p4.2.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p4.2.m2.1c">A\overset{\Theta}{=}A_{1}\overset{\Theta}{=}A_{2}\overset{\Theta}{=}A_{1}-%
\lambda A_{2}</annotation><annotation encoding="application/x-llamapun" id="A6.p4.2.m2.1d">italic_A overroman_Θ start_ARG = end_ARG italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT overroman_Θ start_ARG = end_ARG italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT overroman_Θ start_ARG = end_ARG italic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - italic_λ italic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, considering gradient magnitude. Therefore, the gradients of the corresponding parameters of attention and differential attention are equivalent in magnitude, differing by some constant factors, as shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A6.E7" title="In Appendix F Gradient Flow of Diff Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Equation</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#A6.E9" title="In Appendix F Gradient Flow of Diff Transformer ‣ Differential Transformer"><span class="ltx_text ltx_ref_tag">Equation</span>&nbsp;<span class="ltx_text ltx_ref_tag">9</span></a>. When using an optimizer that is invariant to gradient magnitude, such as AdamW&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05258v1#bib.bib24" title="">24</a>]</cite>, parameter updates in <span class="ltx_text ltx_font_smallcaps" id="A6.p4.2.1">Diff</span> Transformer are similar to those of Transformer. This allows us to reuse Transformer hyperparameters without risking training instability.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>