<!DOCTYPE html>
<html lang="en" prefix="dcterms: http://purl.org/dc/terms/">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting</title>
<!--Generated on Fri Oct  4 11:29:28 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03805v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S1" title="In Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2" title="In Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Transformers for Long Sequence Time-series Forecasting</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS1" title="In 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Attention Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS2" title="In 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Probabilistic Attention</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS3" title="In 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Positional encoding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS4" title="In 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>The Encoder-Decoder architecture</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3" title="In Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Local Attention Mechanism (LAM)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4" title="In Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Empirical comparison to the state of the art</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.SS1" title="In 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.SS2" title="In 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Local Attention Mechanism against the state-of-the-art</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.SS3" title="In 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Comparing LAM and ProbAttn within the same architecture framework</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.SS4" title="In 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>On the suitability of benchmark models for the LSTF problem</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5" title="In Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Towards a suitable collection of datasets for LSTF benchmarking</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.SS1" title="In 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.SS2" title="In 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Results and Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S6" title="In Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusions and future work</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Ignacio Aguilera-Martos <sup class="ltx_sup" id="id5.1.id1">*</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><sup class="ltx_sup" id="id6.2.id1">*</sup> Andalusian Institute of Data Science and Computational Intelligence (DaSCI), University of Granada, Spain. 
<br class="ltx_break"/>Emails: <span class="ltx_text ltx_font_typewriter" id="id7.3.id2">divadhp@ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id8.4.id3">jdrull@correo.ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id9.5.id4">rosana@ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id10.6.id5">herrera@decsai.ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id11.7.id6">andreshp@ugr.es</span>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Andrés Herrera-Poyatos <sup class="ltx_sup" id="id12.1.id1">*</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><sup class="ltx_sup" id="id13.2.id1">*</sup> Andalusian Institute of Data Science and Computational Intelligence (DaSCI), University of Granada, Spain. 
<br class="ltx_break"/>Emails: <span class="ltx_text ltx_font_typewriter" id="id14.3.id2">divadhp@ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id15.4.id3">jdrull@correo.ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id16.5.id4">rosana@ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id17.6.id5">herrera@decsai.ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id18.7.id6">andreshp@ugr.es</span>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Julián Luengo <sup class="ltx_sup" id="id19.1.id1">*</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><sup class="ltx_sup" id="id20.2.id1">*</sup> Andalusian Institute of Data Science and Computational Intelligence (DaSCI), University of Granada, Spain. 
<br class="ltx_break"/>Emails: <span class="ltx_text ltx_font_typewriter" id="id21.3.id2">divadhp@ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id22.4.id3">jdrull@correo.ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id23.5.id4">rosana@ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id24.6.id5">herrera@decsai.ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id25.7.id6">andreshp@ugr.es</span>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Francisco Herrera <sup class="ltx_sup" id="id26.2.id1">*</sup> <sup class="ltx_sup" id="id2.1.1"><math alttext="\dagger" class="ltx_Math" display="inline" id="id2.1.1.m1.1"><semantics id="id2.1.1.m1.1a"><mo id="id2.1.1.m1.1.1" xref="id2.1.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id2.1.1.m1.1b"><ci id="id2.1.1.m1.1.1.cmml" xref="id2.1.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id2.1.1.m1.1c">\dagger</annotation><annotation encoding="application/x-llamapun" id="id2.1.1.m1.1d">†</annotation></semantics></math></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><sup class="ltx_sup" id="id27.3.id1">*</sup> Andalusian Institute of Data Science and Computational Intelligence (DaSCI), University of Granada, Spain. 
<br class="ltx_break"/>Emails: <span class="ltx_text ltx_font_typewriter" id="id28.4.id2">divadhp@ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id29.5.id3">jdrull@correo.ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id30.6.id4">rosana@ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id31.7.id5">herrera@decsai.ugr.es</span>, <span class="ltx_text ltx_font_typewriter" id="id32.8.id6">andreshp@ugr.es</span>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id33.id1">Transformers have become the leading choice in natural language processing over other deep learning architectures. This trend has also permeated the field of time series analysis, especially for long-horizon forecasting, showcasing promising results both in performance and running time.</p>
<p class="ltx_p" id="id4.2">In this paper, we introduce Local Attention Mechanism (LAM), an efficient attention mechanism tailored for time series analysis. This mechanism exploits the continuity properties of time series to reduce the number of attention scores computed. We present an algorithm for implementing LAM in tensor algebra that runs in time and memory <math alttext="\Theta(n\log n)" class="ltx_Math" display="inline" id="id3.1.m1.1"><semantics id="id3.1.m1.1a"><mrow id="id3.1.m1.1.1" xref="id3.1.m1.1.1.cmml"><mi id="id3.1.m1.1.1.3" mathvariant="normal" xref="id3.1.m1.1.1.3.cmml">Θ</mi><mo id="id3.1.m1.1.1.2" xref="id3.1.m1.1.1.2.cmml">⁢</mo><mrow id="id3.1.m1.1.1.1.1" xref="id3.1.m1.1.1.1.1.1.cmml"><mo id="id3.1.m1.1.1.1.1.2" stretchy="false" xref="id3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="id3.1.m1.1.1.1.1.1" xref="id3.1.m1.1.1.1.1.1.cmml"><mi id="id3.1.m1.1.1.1.1.1.2" xref="id3.1.m1.1.1.1.1.1.2.cmml">n</mi><mo id="id3.1.m1.1.1.1.1.1.1" lspace="0.167em" xref="id3.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="id3.1.m1.1.1.1.1.1.3" xref="id3.1.m1.1.1.1.1.1.3.cmml"><mi id="id3.1.m1.1.1.1.1.1.3.1" xref="id3.1.m1.1.1.1.1.1.3.1.cmml">log</mi><mo id="id3.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="id3.1.m1.1.1.1.1.1.3.cmml">⁡</mo><mi id="id3.1.m1.1.1.1.1.1.3.2" xref="id3.1.m1.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="id3.1.m1.1.1.1.1.3" stretchy="false" xref="id3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="id3.1.m1.1b"><apply id="id3.1.m1.1.1.cmml" xref="id3.1.m1.1.1"><times id="id3.1.m1.1.1.2.cmml" xref="id3.1.m1.1.1.2"></times><ci id="id3.1.m1.1.1.3.cmml" xref="id3.1.m1.1.1.3">Θ</ci><apply id="id3.1.m1.1.1.1.1.1.cmml" xref="id3.1.m1.1.1.1.1"><times id="id3.1.m1.1.1.1.1.1.1.cmml" xref="id3.1.m1.1.1.1.1.1.1"></times><ci id="id3.1.m1.1.1.1.1.1.2.cmml" xref="id3.1.m1.1.1.1.1.1.2">𝑛</ci><apply id="id3.1.m1.1.1.1.1.1.3.cmml" xref="id3.1.m1.1.1.1.1.1.3"><log id="id3.1.m1.1.1.1.1.1.3.1.cmml" xref="id3.1.m1.1.1.1.1.1.3.1"></log><ci id="id3.1.m1.1.1.1.1.1.3.2.cmml" xref="id3.1.m1.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.1.m1.1c">\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="id3.1.m1.1d">roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math>, significantly improving upon the <math alttext="\Theta(n^{2})" class="ltx_Math" display="inline" id="id4.2.m2.1"><semantics id="id4.2.m2.1a"><mrow id="id4.2.m2.1.1" xref="id4.2.m2.1.1.cmml"><mi id="id4.2.m2.1.1.3" mathvariant="normal" xref="id4.2.m2.1.1.3.cmml">Θ</mi><mo id="id4.2.m2.1.1.2" xref="id4.2.m2.1.1.2.cmml">⁢</mo><mrow id="id4.2.m2.1.1.1.1" xref="id4.2.m2.1.1.1.1.1.cmml"><mo id="id4.2.m2.1.1.1.1.2" stretchy="false" xref="id4.2.m2.1.1.1.1.1.cmml">(</mo><msup id="id4.2.m2.1.1.1.1.1" xref="id4.2.m2.1.1.1.1.1.cmml"><mi id="id4.2.m2.1.1.1.1.1.2" xref="id4.2.m2.1.1.1.1.1.2.cmml">n</mi><mn id="id4.2.m2.1.1.1.1.1.3" xref="id4.2.m2.1.1.1.1.1.3.cmml">2</mn></msup><mo id="id4.2.m2.1.1.1.1.3" stretchy="false" xref="id4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="id4.2.m2.1b"><apply id="id4.2.m2.1.1.cmml" xref="id4.2.m2.1.1"><times id="id4.2.m2.1.1.2.cmml" xref="id4.2.m2.1.1.2"></times><ci id="id4.2.m2.1.1.3.cmml" xref="id4.2.m2.1.1.3">Θ</ci><apply id="id4.2.m2.1.1.1.1.1.cmml" xref="id4.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="id4.2.m2.1.1.1.1.1.1.cmml" xref="id4.2.m2.1.1.1.1">superscript</csymbol><ci id="id4.2.m2.1.1.1.1.1.2.cmml" xref="id4.2.m2.1.1.1.1.1.2">𝑛</ci><cn id="id4.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="id4.2.m2.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.2.m2.1c">\Theta(n^{2})</annotation><annotation encoding="application/x-llamapun" id="id4.2.m2.1d">roman_Θ ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> time and memory complexity of traditional attention mechanisms. We also note the lack of proper datasets to evaluate long-horizon forecast models. Thus, we propose a novel set of datasets to improve the evaluation of models addressing long-horizon forecasting challenges.</p>
<p class="ltx_p" id="id34.id2">Our experimental analysis demonstrates that the vanilla transformer architecture magnified with LAM surpasses state-of-the-art models, including the vanilla attention mechanism. These results confirm the effectiveness of our approach and highlight a range of future challenges in long-sequence time series forecasting.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<p class="ltx_p" id="p1.3"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="p1.3.1">Keywords</em> Disease detection  <math alttext="\cdot" class="ltx_Math" display="inline" id="p1.1.m1.1"><semantics id="p1.1.m1.1a"><mo id="p1.1.m1.1.1" xref="p1.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.1.m1.1b"><ci id="p1.1.m1.1.1.cmml" xref="p1.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.1.m1.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p1.1.m1.1d">⋅</annotation></semantics></math>
Deep Learning  <math alttext="\cdot" class="ltx_Math" display="inline" id="p1.2.m2.1"><semantics id="p1.2.m2.1a"><mo id="p1.2.m2.1.1" xref="p1.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.2.m2.1b"><ci id="p1.2.m2.1.1.cmml" xref="p1.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.2.m2.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p1.2.m2.1d">⋅</annotation></semantics></math>
Small Data  <math alttext="\cdot" class="ltx_Math" display="inline" id="p1.3.m3.1"><semantics id="p1.3.m3.1a"><mo id="p1.3.m3.1.1" xref="p1.3.m3.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.3.m3.1b"><ci id="p1.3.m3.1.1.cmml" xref="p1.3.m3.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.3.m3.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p1.3.m3.1d">⋅</annotation></semantics></math>
Computer Vision</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">We are currently living in the information age, with vast amounts of data being continuously generated and requiring processing to maximise their utility. From this type of data, time series emerge as the natural choice for representation in several applications <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib1" title="">1</a>]</cite>. Time series, which consist of sequentially related data, are commonly encountered in sectors such as finance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib2" title="">2</a>]</cite>, industry <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib3" title="">3</a>]</cite>, telecommunications <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib4" title="">4</a>]</cite>, electricity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib6" title="">6</a>]</cite>, and climatology <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib8" title="">8</a>]</cite>. Time series forecasting involves predicting future time instances based on past information. An specific scenario of this problem is Long Sequence Time Series Forecasting (LSTF) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib9" title="">9</a>]</cite>, which implies a longer prediction horizon and represents the most interesting and complex problem in time series forecasting. One of the main concerns of the LSTF problem is capturing long-term trends in the data. To adequately predict these long-term patterns, a substantial number of instances is required to model complex behaviour effectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Traditionally, the forecasting problem has been addressed using statistical methods like ARIMA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib10" title="">10</a>]</cite>. However, these models are prone to significant long-term error accumulation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib11" title="">11</a>]</cite>, prompting the exploration of new alternatives within the field of Deep Learning. Convolutional models for time series <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib13" title="">13</a>]</cite> leverage the concept correlation in consecutive time steps. Various models have been developed based on this architecture, typically incorporating recurrent layers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib14" title="">14</a>]</cite> such as Long-Short Term Memory (LSTM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib17" title="">17</a>]</cite>. This type of network faces clear limitations due to the complexity of recurrent operations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib18" title="">18</a>]</cite> and the lack of capacity to capture long-term time dependencies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib19" title="">19</a>]</cite>. Transformers, originally proposed for natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib20" title="">20</a>]</cite>, have been incorporated into the field of time series and forecasting to address these needs. Nonetheless, current transformer models present two main limitations. First of all, the computational evaluation of the attention mechanism requires significant time and memory due to its quadratic complexity on the length of the input. Secondly, the utilisation of attention mechanisms results in a significant loss of positional information, which poses a critical challenge for time series forecasting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib21" title="">21</a>]</cite>. As a first step to address the computational cost issue, an efficient attention mechanism based on probabilistic sampling of attentions has been proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>. However, to date, methodologies employing transformers for time-series forecasting have not sufficiently mitigated the loss of positional information <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib21" title="">21</a>]</cite>. Consequently, emerges a necessity for an innovative attention mechanism that leverages the local and long-term temporal dependency properties of time series, does not incur information loss and minimises computational and memory overheads.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Previously existing transformer models within the field of time series do not exploit this conception of locality and present experimental studies with data sets of limited size, not only in terms of features but particularly in terms of instances. If the goal is capturing long-term dependencies, large datasets are needed to adequately train the model weights. The primary defining feature of a time series is the dependence of past time steps on the current time instant <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib23" title="">23</a>]</cite>. This dependence is more likely to be higher in closer time steps, specially in the case where the time series comes from discretizising a continuous stochastic process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">This paper aims to achieve two primary objectives:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.2">We introduce Local Attention Mechanism  (LAM), a locality-based attention mechanism designed to enhance both the efficiency and performance of time series transformers. This novel attention mechanism reduces computational and memory complexity to <math alttext="\Theta(n\log n)" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.m1.1"><semantics id="S1.I1.i1.p1.1.m1.1a"><mrow id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml"><mi id="S1.I1.i1.p1.1.m1.1.1.3" mathvariant="normal" xref="S1.I1.i1.p1.1.m1.1.1.3.cmml">Θ</mi><mo id="S1.I1.i1.p1.1.m1.1.1.2" xref="S1.I1.i1.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S1.I1.i1.p1.1.m1.1.1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.cmml"><mo id="S1.I1.i1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S1.I1.i1.p1.1.m1.1.1.1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S1.I1.i1.p1.1.m1.1.1.1.1.1.2" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml">n</mi><mo id="S1.I1.i1.p1.1.m1.1.1.1.1.1.1" lspace="0.167em" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.1" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S1.I1.i1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><apply id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1"><times id="S1.I1.i1.p1.1.m1.1.1.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.2"></times><ci id="S1.I1.i1.p1.1.m1.1.1.3.cmml" xref="S1.I1.i1.p1.1.m1.1.1.3">Θ</ci><apply id="S1.I1.i1.p1.1.m1.1.1.1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1"><times id="S1.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.1"></times><ci id="S1.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.2">𝑛</ci><apply id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3"><log id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.1"></log><ci id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.m1.1d">roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math> by excluding non-relevant computations in the attention matrix through the use of an additive mask. The key contribution here is a derivation of this attention mechanism that can be written in tensor algebra in such a way that only <math alttext="\Theta(n\log n)" class="ltx_Math" display="inline" id="S1.I1.i1.p1.2.m2.1"><semantics id="S1.I1.i1.p1.2.m2.1a"><mrow id="S1.I1.i1.p1.2.m2.1.1" xref="S1.I1.i1.p1.2.m2.1.1.cmml"><mi id="S1.I1.i1.p1.2.m2.1.1.3" mathvariant="normal" xref="S1.I1.i1.p1.2.m2.1.1.3.cmml">Θ</mi><mo id="S1.I1.i1.p1.2.m2.1.1.2" xref="S1.I1.i1.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S1.I1.i1.p1.2.m2.1.1.1.1" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.cmml"><mo id="S1.I1.i1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S1.I1.i1.p1.2.m2.1.1.1.1.1" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S1.I1.i1.p1.2.m2.1.1.1.1.1.2" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.2.cmml">n</mi><mo id="S1.I1.i1.p1.2.m2.1.1.1.1.1.1" lspace="0.167em" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S1.I1.i1.p1.2.m2.1.1.1.1.1.3" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.1" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S1.I1.i1.p1.2.m2.1.1.1.1.1.3a" lspace="0.167em" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.cmml">⁡</mo><mi id="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.2" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S1.I1.i1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.2.m2.1b"><apply id="S1.I1.i1.p1.2.m2.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1"><times id="S1.I1.i1.p1.2.m2.1.1.2.cmml" xref="S1.I1.i1.p1.2.m2.1.1.2"></times><ci id="S1.I1.i1.p1.2.m2.1.1.3.cmml" xref="S1.I1.i1.p1.2.m2.1.1.3">Θ</ci><apply id="S1.I1.i1.p1.2.m2.1.1.1.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1.1.1"><times id="S1.I1.i1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.1"></times><ci id="S1.I1.i1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.2">𝑛</ci><apply id="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.3"><log id="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.1"></log><ci id="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S1.I1.i1.p1.2.m2.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.2.m2.1c">\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.2.m2.1d">roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math> memory is needed.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a more suitable benchmark for the LSTF problem, comprising four interdisciplinary and substantially larger datasets than previous studies. This new experimental environments encompass datasets related to taxi usage, electricity consumption and industrial real-world problems.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To validate the proposed approach, the second objective outlined above will be pursued to generate a robust dataset for performance analysis. For fairness and consistency, we will first utilize the datasets employed in the Informer papers and other state-of-the-art methods as an initial benchmark, before incorporating our own proposed dataset into the study.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The rest of this paper is structured as follows. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2" title="2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2</span></a>, we discuss the background on transformers and the LSTF problem. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3" title="3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">3</span></a>, we detail our proposed mechanism, introducing all relevant details. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4" title="4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4</span></a>, we compare our approach with the state-of-the-art methods using currently employed LSTF datasets. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5" title="5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">5</span></a>, we extend the datasets used to better represent the complexities of the LSTF problem and establish a more comprehensive benchmark. Finally, we present our conclusions and outline future work in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S6" title="6 Conclusions and future work ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Transformers for Long Sequence Time-series Forecasting</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.6">A time series is a sequence of random vectors <math alttext="X_{t}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><msub id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml"><mi id="S2.p1.1.m1.1.1.2.2" xref="S2.p1.1.m1.1.1.2.2.cmml">X</mi><mi id="S2.p1.1.m1.1.1.2.3" xref="S2.p1.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="S2.p1.1.m1.1.1.1" xref="S2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml"><mi id="S2.p1.1.m1.1.1.3.2" xref="S2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S2.p1.1.m1.1.1.3.3" xref="S2.p1.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><in id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1.1"></in><apply id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.2.1.cmml" xref="S2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.p1.1.m1.1.1.2.2.cmml" xref="S2.p1.1.m1.1.1.2.2">𝑋</ci><ci id="S2.p1.1.m1.1.1.2.3.cmml" xref="S2.p1.1.m1.1.1.2.3">𝑡</ci></apply><apply id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.3.1.cmml" xref="S2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.p1.1.m1.1.1.3.2.cmml" xref="S2.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S2.p1.1.m1.1.1.3.3.cmml" xref="S2.p1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">X_{t}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> recorded at regular time intervals, typically denoted as <math alttext="\{X_{t}\}_{t=1}^{T}" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><msubsup id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><mrow id="S2.p1.2.m2.1.1.1.1.1" xref="S2.p1.2.m2.1.1.1.1.2.cmml"><mo id="S2.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S2.p1.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S2.p1.2.m2.1.1.1.1.1.1" xref="S2.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S2.p1.2.m2.1.1.1.1.1.1.2" xref="S2.p1.2.m2.1.1.1.1.1.1.2.cmml">X</mi><mi id="S2.p1.2.m2.1.1.1.1.1.1.3" xref="S2.p1.2.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S2.p1.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.2.m2.1.1.1.3" xref="S2.p1.2.m2.1.1.1.3.cmml"><mi id="S2.p1.2.m2.1.1.1.3.2" xref="S2.p1.2.m2.1.1.1.3.2.cmml">t</mi><mo id="S2.p1.2.m2.1.1.1.3.1" xref="S2.p1.2.m2.1.1.1.3.1.cmml">=</mo><mn id="S2.p1.2.m2.1.1.1.3.3" xref="S2.p1.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p1.2.m2.1.1.3" xref="S2.p1.2.m2.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1">superscript</csymbol><apply id="S2.p1.2.m2.1.1.1.cmml" xref="S2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.1.2.cmml" xref="S2.p1.2.m2.1.1">subscript</csymbol><set id="S2.p1.2.m2.1.1.1.1.2.cmml" xref="S2.p1.2.m2.1.1.1.1.1"><apply id="S2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.p1.2.m2.1.1.1.1.1.1.2">𝑋</ci><ci id="S2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.p1.2.m2.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S2.p1.2.m2.1.1.1.3.cmml" xref="S2.p1.2.m2.1.1.1.3"><eq id="S2.p1.2.m2.1.1.1.3.1.cmml" xref="S2.p1.2.m2.1.1.1.3.1"></eq><ci id="S2.p1.2.m2.1.1.1.3.2.cmml" xref="S2.p1.2.m2.1.1.1.3.2">𝑡</ci><cn id="S2.p1.2.m2.1.1.1.3.3.cmml" type="integer" xref="S2.p1.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">\{X_{t}\}_{t=1}^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">{ italic_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>. We use <math alttext="X_{t}" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><msub id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">X</mi><mi id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2">𝑋</ci><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">X_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to refer to the random vector and <math alttext="x_{t}" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><msub id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><mi id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml">x</mi><mi id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2">𝑥</ci><ci id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to represent the observation at time <math alttext="t" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">italic_t</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib24" title="">24</a>]</cite>. Time series data is characterised by its temporal dependency, where each observation relies on previous values, potentially exhibiting long-term patterns <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib25" title="">25</a>]</cite>. Such data often features distinct elements: trend (long-term data direction), seasonality (predictable periodic fluctuations) and cyclic patterns (less regular variations influenced by external factors). In this work we focus on time series forecasting, which corresponds to the problem of estimating <math alttext="\mathbb{E}\left[\left.X_{t+1}\right|X_{1}=x_{1},\ldots,X_{t}=x_{t}\right]" class="ltx_Math" display="inline" id="S2.p1.6.m6.2"><semantics id="S2.p1.6.m6.2a"><mrow id="S2.p1.6.m6.2.2" xref="S2.p1.6.m6.2.2.cmml"><mi id="S2.p1.6.m6.2.2.3" xref="S2.p1.6.m6.2.2.3.cmml">𝔼</mi><mo id="S2.p1.6.m6.2.2.2" xref="S2.p1.6.m6.2.2.2.cmml">⁢</mo><mrow id="S2.p1.6.m6.2.2.1.1" xref="S2.p1.6.m6.2.2.1.2.cmml"><mo id="S2.p1.6.m6.2.2.1.1.2" xref="S2.p1.6.m6.2.2.1.2.1.cmml">[</mo><mrow id="S2.p1.6.m6.2.2.1.1.1.2" xref="S2.p1.6.m6.2.2.1.1.1.3.cmml"><mrow id="S2.p1.6.m6.2.2.1.1.1.1.1" xref="S2.p1.6.m6.2.2.1.1.1.1.1.cmml"><mrow id="S2.p1.6.m6.2.2.1.1.1.1.1.3" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.cmml"><msub id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.cmml"><mi id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.2" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.2.cmml">X</mi><mrow id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.cmml"><mi id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.2" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.1" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.1.cmml">+</mo><mn id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.3" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S2.p1.6.m6.2.2.1.1.1.1.1.3.1" stretchy="true" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.1.cmml">|</mo><msub id="S2.p1.6.m6.2.2.1.1.1.1.1.3.3" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.cmml"><mi id="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.2" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.2.cmml">X</mi><mn id="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.3" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.3.cmml">1</mn></msub></mrow><mo id="S2.p1.6.m6.2.2.1.1.1.1.1.2" xref="S2.p1.6.m6.2.2.1.1.1.1.1.2.cmml">=</mo><mrow id="S2.p1.6.m6.2.2.1.1.1.1.1.1.1" xref="S2.p1.6.m6.2.2.1.1.1.1.1.1.2.cmml"><msub id="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1" xref="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.2" xref="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mn id="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.3" xref="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.2" xref="S2.p1.6.m6.2.2.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.p1.6.m6.1.1" mathvariant="normal" xref="S2.p1.6.m6.1.1.cmml">…</mi></mrow></mrow><mo id="S2.p1.6.m6.2.2.1.1.1.2.3" xref="S2.p1.6.m6.2.2.1.1.1.3a.cmml">,</mo><mrow id="S2.p1.6.m6.2.2.1.1.1.2.2" xref="S2.p1.6.m6.2.2.1.1.1.2.2.cmml"><msub id="S2.p1.6.m6.2.2.1.1.1.2.2.2" xref="S2.p1.6.m6.2.2.1.1.1.2.2.2.cmml"><mi id="S2.p1.6.m6.2.2.1.1.1.2.2.2.2" xref="S2.p1.6.m6.2.2.1.1.1.2.2.2.2.cmml">X</mi><mi id="S2.p1.6.m6.2.2.1.1.1.2.2.2.3" xref="S2.p1.6.m6.2.2.1.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S2.p1.6.m6.2.2.1.1.1.2.2.1" xref="S2.p1.6.m6.2.2.1.1.1.2.2.1.cmml">=</mo><msub id="S2.p1.6.m6.2.2.1.1.1.2.2.3" xref="S2.p1.6.m6.2.2.1.1.1.2.2.3.cmml"><mi id="S2.p1.6.m6.2.2.1.1.1.2.2.3.2" xref="S2.p1.6.m6.2.2.1.1.1.2.2.3.2.cmml">x</mi><mi id="S2.p1.6.m6.2.2.1.1.1.2.2.3.3" xref="S2.p1.6.m6.2.2.1.1.1.2.2.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S2.p1.6.m6.2.2.1.1.3" xref="S2.p1.6.m6.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.2b"><apply id="S2.p1.6.m6.2.2.cmml" xref="S2.p1.6.m6.2.2"><times id="S2.p1.6.m6.2.2.2.cmml" xref="S2.p1.6.m6.2.2.2"></times><ci id="S2.p1.6.m6.2.2.3.cmml" xref="S2.p1.6.m6.2.2.3">𝔼</ci><apply id="S2.p1.6.m6.2.2.1.2.cmml" xref="S2.p1.6.m6.2.2.1.1"><csymbol cd="latexml" id="S2.p1.6.m6.2.2.1.2.1.cmml" xref="S2.p1.6.m6.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.p1.6.m6.2.2.1.1.1.3.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.2.2.1.1.1.3a.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.p1.6.m6.2.2.1.1.1.1.1.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1"><eq id="S2.p1.6.m6.2.2.1.1.1.1.1.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.2"></eq><apply id="S2.p1.6.m6.2.2.1.1.1.1.1.3.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.p1.6.m6.2.2.1.1.1.1.1.3.1.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.1">conditional</csymbol><apply id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.1.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.2">𝑋</ci><apply id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3"><plus id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.1.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.1"></plus><ci id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.1.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.2">𝑋</ci><cn id="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.p1.6.m6.2.2.1.1.1.1.1.3.3.3">1</cn></apply></apply><list id="S2.p1.6.m6.2.2.1.1.1.1.1.1.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.1.1"><apply id="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.2">𝑥</ci><cn id="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.p1.6.m6.2.2.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1">…</ci></list></apply><apply id="S2.p1.6.m6.2.2.1.1.1.2.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.2"><eq id="S2.p1.6.m6.2.2.1.1.1.2.2.1.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.2.1"></eq><apply id="S2.p1.6.m6.2.2.1.1.1.2.2.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.p1.6.m6.2.2.1.1.1.2.2.2.1.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="S2.p1.6.m6.2.2.1.1.1.2.2.2.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.2.2.2">𝑋</ci><ci id="S2.p1.6.m6.2.2.1.1.1.2.2.2.3.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.2.2.3">𝑡</ci></apply><apply id="S2.p1.6.m6.2.2.1.1.1.2.2.3.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.p1.6.m6.2.2.1.1.1.2.2.3.1.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.2.3">subscript</csymbol><ci id="S2.p1.6.m6.2.2.1.1.1.2.2.3.2.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.2.3.2">𝑥</ci><ci id="S2.p1.6.m6.2.2.1.1.1.2.2.3.3.cmml" xref="S2.p1.6.m6.2.2.1.1.1.2.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.2c">\mathbb{E}\left[\left.X_{t+1}\right|X_{1}=x_{1},\ldots,X_{t}=x_{t}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.2d">blackboard_E [ italic_X start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math>. Specifically, we address long sequence time-series forecasting (LSTF)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib9" title="">9</a>]</cite>, where the goal is predicting long sequences of future data points in datasets with extensive historical records, requiring of the application of advanced techniques to understand complex patterns and trends.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">Neural networks, particularly one-dimensional convolutional neural networks (1D CNNs) and Long Short-Term Memory (LSTM) networks, offer black-box solutions for time-series forecasting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib27" title="">27</a>]</cite>. 1D CNNs use convolutional layers to identify local patterns and hierarchies within time series data, but are unable to capture longer time dependencies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib19" title="">19</a>]</cite>. Indeed, short-term prediction are greatly affected by locality, that is, the last few elements of the sequence greatly determine the trend of the model and, thus, the short-term prediction, unless seasonality and cyclic patterns play a role at that specific timestamp. LSTMs are able to take into account seasonality and cyclic patterns for medium-term dependencies thanks to the use memory cells, overcoming the vanishing gradient problem via gating mechanisms. However, the recursive nature of LSTMs and the memory cells limitations makes them less efficient and effective for long-term predictions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">Transformers have surpassed RNNs and LSTMs in several applications, such as NLP, thanks to their ability to model long-range dependencies, learn from large datasets, and parallelise computations efficiently. Motivated by these properties, transformers have been deemed as excellent candidates to the LSTF problem <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>. Indeed, unlike traditional methods that rely on fixed time windows, lagged observations and/or recursive neural networks, transformers can process long sequences efficiently, making them suitable for both short-term and long-term forecasting tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib29" title="">29</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">Transformers are complex encoder-decoder architectures that encode the sequence of samples and use the extracted information to predict the several future elements of the sequence via a decoder. The key element to understand these architectures is the attention mechanism, see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib20" title="">20</a>]</cite>. In a nutshell, the main conclusion of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib20" title="">20</a>]</cite> is that performance in NLP applications can be significantly improved by eliminating the recurrence structure of deep learning models and instead focusing exclusively on exploiting the attention mechanism to extract relevant information from sequences of data. In this work we refer to this encoding-decoding model as the <em class="ltx_emph ltx_font_italic" id="S2.p4.1.1">vanilla transformer</em>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p5">
<p class="ltx_p" id="S2.p5.3">When it comes to the application of transformers to time-series problems, progress has been significantly slower than in NLP. This is due to the fact that the attention mechanism presents two main limitations: loss of positional information, and computational and memory cost <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib28" title="">28</a>]</cite>. The former problem is solved in the application of the vanilla transformer to NLP problems via a positional encoding of the input, and residual connections, which we will be explained in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS3" title="2.3 Positional encoding ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2.3</span></a> and Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS4" title="2.4 The Encoder-Decoder architecture ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2.4</span></a> respectively. However, the validity of this approach in the case of time series remains controversial, see, for instance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib21" title="">21</a>]</cite>, suggesting that further research is needed. We will come back to this problem when introducing our attention mechanism, LAM, in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3" title="3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">3</span></a>, which greatly reduces the impact of loss of positional information. On the other hand, improving the computational and memory cost of the attention mechanism has actually been addressed in the time-series literature. The evaluation of the original attention mechanism has time and memory complexity <math alttext="\Theta(n^{2})" class="ltx_Math" display="inline" id="S2.p5.1.m1.1"><semantics id="S2.p5.1.m1.1a"><mrow id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml"><mi id="S2.p5.1.m1.1.1.3" mathvariant="normal" xref="S2.p5.1.m1.1.1.3.cmml">Θ</mi><mo id="S2.p5.1.m1.1.1.2" xref="S2.p5.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p5.1.m1.1.1.1.1" xref="S2.p5.1.m1.1.1.1.1.1.cmml"><mo id="S2.p5.1.m1.1.1.1.1.2" stretchy="false" xref="S2.p5.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S2.p5.1.m1.1.1.1.1.1" xref="S2.p5.1.m1.1.1.1.1.1.cmml"><mi id="S2.p5.1.m1.1.1.1.1.1.2" xref="S2.p5.1.m1.1.1.1.1.1.2.cmml">n</mi><mn id="S2.p5.1.m1.1.1.1.1.1.3" xref="S2.p5.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.p5.1.m1.1.1.1.1.3" stretchy="false" xref="S2.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><apply id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1"><times id="S2.p5.1.m1.1.1.2.cmml" xref="S2.p5.1.m1.1.1.2"></times><ci id="S2.p5.1.m1.1.1.3.cmml" xref="S2.p5.1.m1.1.1.3">Θ</ci><apply id="S2.p5.1.m1.1.1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p5.1.m1.1.1.1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1.1">superscript</csymbol><ci id="S2.p5.1.m1.1.1.1.1.1.2.cmml" xref="S2.p5.1.m1.1.1.1.1.1.2">𝑛</ci><cn id="S2.p5.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.p5.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">\Theta(n^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.p5.1.m1.1d">roman_Θ ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="n" class="ltx_Math" display="inline" id="S2.p5.2.m2.1"><semantics id="S2.p5.2.m2.1a"><mi id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.1b"><ci id="S2.p5.2.m2.1.1.cmml" xref="S2.p5.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.p5.2.m2.1d">italic_n</annotation></semantics></math> is the width of this layer. As a consequence of the memory bottleneck, not every data scientist has access to the computing resources needed to train and evaluate a transformer model with the full attention mechanism on large sequences of data, preventing transformers from becoming a machine learning state of the art in time series forecasting in practice. The most remarkable solution to accelerate the attention mechanism for time series forecasting is that of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>, where the authors propose a probabilistic attention mechanism that runs in time and memory <math alttext="\Theta(n\log n)" class="ltx_Math" display="inline" id="S2.p5.3.m3.1"><semantics id="S2.p5.3.m3.1a"><mrow id="S2.p5.3.m3.1.1" xref="S2.p5.3.m3.1.1.cmml"><mi id="S2.p5.3.m3.1.1.3" mathvariant="normal" xref="S2.p5.3.m3.1.1.3.cmml">Θ</mi><mo id="S2.p5.3.m3.1.1.2" xref="S2.p5.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.p5.3.m3.1.1.1.1" xref="S2.p5.3.m3.1.1.1.1.1.cmml"><mo id="S2.p5.3.m3.1.1.1.1.2" stretchy="false" xref="S2.p5.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.p5.3.m3.1.1.1.1.1" xref="S2.p5.3.m3.1.1.1.1.1.cmml"><mi id="S2.p5.3.m3.1.1.1.1.1.2" xref="S2.p5.3.m3.1.1.1.1.1.2.cmml">n</mi><mo id="S2.p5.3.m3.1.1.1.1.1.1" lspace="0.167em" xref="S2.p5.3.m3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.p5.3.m3.1.1.1.1.1.3" xref="S2.p5.3.m3.1.1.1.1.1.3.cmml"><mi id="S2.p5.3.m3.1.1.1.1.1.3.1" xref="S2.p5.3.m3.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.p5.3.m3.1.1.1.1.1.3a" lspace="0.167em" xref="S2.p5.3.m3.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.p5.3.m3.1.1.1.1.1.3.2" xref="S2.p5.3.m3.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S2.p5.3.m3.1.1.1.1.3" stretchy="false" xref="S2.p5.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.3.m3.1b"><apply id="S2.p5.3.m3.1.1.cmml" xref="S2.p5.3.m3.1.1"><times id="S2.p5.3.m3.1.1.2.cmml" xref="S2.p5.3.m3.1.1.2"></times><ci id="S2.p5.3.m3.1.1.3.cmml" xref="S2.p5.3.m3.1.1.3">Θ</ci><apply id="S2.p5.3.m3.1.1.1.1.1.cmml" xref="S2.p5.3.m3.1.1.1.1"><times id="S2.p5.3.m3.1.1.1.1.1.1.cmml" xref="S2.p5.3.m3.1.1.1.1.1.1"></times><ci id="S2.p5.3.m3.1.1.1.1.1.2.cmml" xref="S2.p5.3.m3.1.1.1.1.1.2">𝑛</ci><apply id="S2.p5.3.m3.1.1.1.1.1.3.cmml" xref="S2.p5.3.m3.1.1.1.1.1.3"><log id="S2.p5.3.m3.1.1.1.1.1.3.1.cmml" xref="S2.p5.3.m3.1.1.1.1.1.3.1"></log><ci id="S2.p5.3.m3.1.1.1.1.1.3.2.cmml" xref="S2.p5.3.m3.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.3.m3.1c">\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S2.p5.3.m3.1d">roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math>. Other proposed solutions to this problem involve applying other sorts of mechanisms to the sequence of data instead of the attention mechanism, see for instance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib30" title="">30</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p6">
<p class="ltx_p" id="S2.p6.1">In the rest of this section, we describe the elements of the vanilla transformer, which will serve as the base model for our experimentation, and the probabilistic attention mechanism of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>. This section is organised as follows. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS1" title="2.1 Attention Mechanism ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2.1</span></a> we briefly recapitulate the canonical attention mechanism introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib20" title="">20</a>]</cite>. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS2" title="2.2 Probabilistic Attention ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2.2</span></a> we summarise the concept of probabilistic attention and point out some of its weaknesses. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS3" title="2.3 Positional encoding ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2.3</span></a> we describe the positional encoding used in our experiments. Finally, in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS4" title="2.4 The Encoder-Decoder architecture ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2.4</span></a> we summarise the encoder-architecture of the vanilla transformer.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Attention Mechanism</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.12">The attention mechanism is a layer of a neural network whose inputs consist of three sequences with <math alttext="n" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_n</annotation></semantics></math> elements: the lists of queries and keys, each entry being a vector of dimension <math alttext="d_{q}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><msub id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">d</mi><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝑑</ci><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">d_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, and the list of values, each entry having dimension <math alttext="d_{v}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">d</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝑑</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">d_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>. For example, when applied to time series as a first layer, these three sequences could be set to the input of model, that is, <math alttext="n" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_n</annotation></semantics></math> consecutive data points of the time series, <math alttext="X=(x_{1},x_{2},\ldots,x_{n})" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.4"><semantics id="S2.SS1.p1.5.m5.4a"><mrow id="S2.SS1.p1.5.m5.4.4" xref="S2.SS1.p1.5.m5.4.4.cmml"><mi id="S2.SS1.p1.5.m5.4.4.5" xref="S2.SS1.p1.5.m5.4.4.5.cmml">X</mi><mo id="S2.SS1.p1.5.m5.4.4.4" xref="S2.SS1.p1.5.m5.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.5.m5.4.4.3.3" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml"><mo id="S2.SS1.p1.5.m5.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml">(</mo><msub id="S2.SS1.p1.5.m5.2.2.1.1.1" xref="S2.SS1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.5.m5.2.2.1.1.1.2" xref="S2.SS1.p1.5.m5.2.2.1.1.1.2.cmml">x</mi><mn id="S2.SS1.p1.5.m5.2.2.1.1.1.3" xref="S2.SS1.p1.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.5.m5.4.4.3.3.5" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.5.m5.3.3.2.2.2" xref="S2.SS1.p1.5.m5.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.5.m5.3.3.2.2.2.2" xref="S2.SS1.p1.5.m5.3.3.2.2.2.2.cmml">x</mi><mn id="S2.SS1.p1.5.m5.3.3.2.2.2.3" xref="S2.SS1.p1.5.m5.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.5.m5.4.4.3.3.6" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.5.m5.1.1" mathvariant="normal" xref="S2.SS1.p1.5.m5.1.1.cmml">…</mi><mo id="S2.SS1.p1.5.m5.4.4.3.3.7" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.5.m5.4.4.3.3.3" xref="S2.SS1.p1.5.m5.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.5.m5.4.4.3.3.3.2" xref="S2.SS1.p1.5.m5.4.4.3.3.3.2.cmml">x</mi><mi id="S2.SS1.p1.5.m5.4.4.3.3.3.3" xref="S2.SS1.p1.5.m5.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S2.SS1.p1.5.m5.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.4b"><apply id="S2.SS1.p1.5.m5.4.4.cmml" xref="S2.SS1.p1.5.m5.4.4"><eq id="S2.SS1.p1.5.m5.4.4.4.cmml" xref="S2.SS1.p1.5.m5.4.4.4"></eq><ci id="S2.SS1.p1.5.m5.4.4.5.cmml" xref="S2.SS1.p1.5.m5.4.4.5">𝑋</ci><vector id="S2.SS1.p1.5.m5.4.4.3.4.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3"><apply id="S2.SS1.p1.5.m5.2.2.1.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.2">𝑥</ci><cn id="S2.SS1.p1.5.m5.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.5.m5.3.3.2.2.2.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2.2.2">𝑥</ci><cn id="S2.SS1.p1.5.m5.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">…</ci><apply id="S2.SS1.p1.5.m5.4.4.3.3.3.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.5.m5.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3.2">𝑥</ci><ci id="S2.SS1.p1.5.m5.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3.3">𝑛</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.4c">X=(x_{1},x_{2},\ldots,x_{n})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.4d">italic_X = ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math>. In this particular case, <math alttext="d_{q}=d_{v}=d_{\operatorname{model}}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mrow id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><msub id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2.2" xref="S2.SS1.p1.6.m6.1.1.2.2.cmml">d</mi><mi id="S2.SS1.p1.6.m6.1.1.2.3" xref="S2.SS1.p1.6.m6.1.1.2.3.cmml">q</mi></msub><mo id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">=</mo><msub id="S2.SS1.p1.6.m6.1.1.4" xref="S2.SS1.p1.6.m6.1.1.4.cmml"><mi id="S2.SS1.p1.6.m6.1.1.4.2" xref="S2.SS1.p1.6.m6.1.1.4.2.cmml">d</mi><mi id="S2.SS1.p1.6.m6.1.1.4.3" xref="S2.SS1.p1.6.m6.1.1.4.3.cmml">v</mi></msub><mo id="S2.SS1.p1.6.m6.1.1.5" xref="S2.SS1.p1.6.m6.1.1.5.cmml">=</mo><msub id="S2.SS1.p1.6.m6.1.1.6" xref="S2.SS1.p1.6.m6.1.1.6.cmml"><mi id="S2.SS1.p1.6.m6.1.1.6.2" xref="S2.SS1.p1.6.m6.1.1.6.2.cmml">d</mi><mi id="S2.SS1.p1.6.m6.1.1.6.3" xref="S2.SS1.p1.6.m6.1.1.6.3.cmml">model</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><and id="S2.SS1.p1.6.m6.1.1a.cmml" xref="S2.SS1.p1.6.m6.1.1"></and><apply id="S2.SS1.p1.6.m6.1.1b.cmml" xref="S2.SS1.p1.6.m6.1.1"><eq id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3"></eq><apply id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.2.1.cmml" xref="S2.SS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2.2">𝑑</ci><ci id="S2.SS1.p1.6.m6.1.1.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.2.3">𝑞</ci></apply><apply id="S2.SS1.p1.6.m6.1.1.4.cmml" xref="S2.SS1.p1.6.m6.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.4.1.cmml" xref="S2.SS1.p1.6.m6.1.1.4">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.4.2.cmml" xref="S2.SS1.p1.6.m6.1.1.4.2">𝑑</ci><ci id="S2.SS1.p1.6.m6.1.1.4.3.cmml" xref="S2.SS1.p1.6.m6.1.1.4.3">𝑣</ci></apply></apply><apply id="S2.SS1.p1.6.m6.1.1c.cmml" xref="S2.SS1.p1.6.m6.1.1"><eq id="S2.SS1.p1.6.m6.1.1.5.cmml" xref="S2.SS1.p1.6.m6.1.1.5"></eq><share href="https://arxiv.org/html/2410.03805v1#S2.SS1.p1.6.m6.1.1.4.cmml" id="S2.SS1.p1.6.m6.1.1d.cmml" xref="S2.SS1.p1.6.m6.1.1"></share><apply id="S2.SS1.p1.6.m6.1.1.6.cmml" xref="S2.SS1.p1.6.m6.1.1.6"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.6.1.cmml" xref="S2.SS1.p1.6.m6.1.1.6">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.6.2.cmml" xref="S2.SS1.p1.6.m6.1.1.6.2">𝑑</ci><ci id="S2.SS1.p1.6.m6.1.1.6.3.cmml" xref="S2.SS1.p1.6.m6.1.1.6.3">model</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">d_{q}=d_{v}=d_{\operatorname{model}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT</annotation></semantics></math>, so each of the three inputs of the attention layer is actually an <math alttext="n\times d_{\operatorname{model}}" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mrow id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mi id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml">n</mi><mo id="S2.SS1.p1.7.m7.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.7.m7.1.1.1.cmml">×</mo><msub id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml"><mi id="S2.SS1.p1.7.m7.1.1.3.2" xref="S2.SS1.p1.7.m7.1.1.3.2.cmml">d</mi><mi id="S2.SS1.p1.7.m7.1.1.3.3" xref="S2.SS1.p1.7.m7.1.1.3.3.cmml">model</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><times id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1.1"></times><ci id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2">𝑛</ci><apply id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.3.1.cmml" xref="S2.SS1.p1.7.m7.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.3.2.cmml" xref="S2.SS1.p1.7.m7.1.1.3.2">𝑑</ci><ci id="S2.SS1.p1.7.m7.1.1.3.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3.3">model</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">n\times d_{\operatorname{model}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_n × italic_d start_POSTSUBSCRIPT roman_model end_POSTSUBSCRIPT</annotation></semantics></math> matrix. In the general case, the queries, keys and values are matrices <math alttext="Q" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_Q</annotation></semantics></math>, <math alttext="K" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.1"><semantics id="S2.SS1.p1.9.m9.1a"><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">italic_K</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.1"><semantics id="S2.SS1.p1.10.m10.1a"><mi id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><ci id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">italic_V</annotation></semantics></math> with dimensions <math alttext="n\times d_{q},n\times d_{q}" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.2"><semantics id="S2.SS1.p1.11.m11.2a"><mrow id="S2.SS1.p1.11.m11.2.2.2" xref="S2.SS1.p1.11.m11.2.2.3.cmml"><mrow id="S2.SS1.p1.11.m11.1.1.1.1" xref="S2.SS1.p1.11.m11.1.1.1.1.cmml"><mi id="S2.SS1.p1.11.m11.1.1.1.1.2" xref="S2.SS1.p1.11.m11.1.1.1.1.2.cmml">n</mi><mo id="S2.SS1.p1.11.m11.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.11.m11.1.1.1.1.1.cmml">×</mo><msub id="S2.SS1.p1.11.m11.1.1.1.1.3" xref="S2.SS1.p1.11.m11.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.11.m11.1.1.1.1.3.2" xref="S2.SS1.p1.11.m11.1.1.1.1.3.2.cmml">d</mi><mi id="S2.SS1.p1.11.m11.1.1.1.1.3.3" xref="S2.SS1.p1.11.m11.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="S2.SS1.p1.11.m11.2.2.2.3" xref="S2.SS1.p1.11.m11.2.2.3.cmml">,</mo><mrow id="S2.SS1.p1.11.m11.2.2.2.2" xref="S2.SS1.p1.11.m11.2.2.2.2.cmml"><mi id="S2.SS1.p1.11.m11.2.2.2.2.2" xref="S2.SS1.p1.11.m11.2.2.2.2.2.cmml">n</mi><mo id="S2.SS1.p1.11.m11.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.11.m11.2.2.2.2.1.cmml">×</mo><msub id="S2.SS1.p1.11.m11.2.2.2.2.3" xref="S2.SS1.p1.11.m11.2.2.2.2.3.cmml"><mi id="S2.SS1.p1.11.m11.2.2.2.2.3.2" xref="S2.SS1.p1.11.m11.2.2.2.2.3.2.cmml">d</mi><mi id="S2.SS1.p1.11.m11.2.2.2.2.3.3" xref="S2.SS1.p1.11.m11.2.2.2.2.3.3.cmml">q</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.2b"><list id="S2.SS1.p1.11.m11.2.2.3.cmml" xref="S2.SS1.p1.11.m11.2.2.2"><apply id="S2.SS1.p1.11.m11.1.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1.1.1"><times id="S2.SS1.p1.11.m11.1.1.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1.1.1.1"></times><ci id="S2.SS1.p1.11.m11.1.1.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1.1.1.2">𝑛</ci><apply id="S2.SS1.p1.11.m11.1.1.1.1.3.cmml" xref="S2.SS1.p1.11.m11.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.11.m11.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.11.m11.1.1.1.1.3.2">𝑑</ci><ci id="S2.SS1.p1.11.m11.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.11.m11.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S2.SS1.p1.11.m11.2.2.2.2.cmml" xref="S2.SS1.p1.11.m11.2.2.2.2"><times id="S2.SS1.p1.11.m11.2.2.2.2.1.cmml" xref="S2.SS1.p1.11.m11.2.2.2.2.1"></times><ci id="S2.SS1.p1.11.m11.2.2.2.2.2.cmml" xref="S2.SS1.p1.11.m11.2.2.2.2.2">𝑛</ci><apply id="S2.SS1.p1.11.m11.2.2.2.2.3.cmml" xref="S2.SS1.p1.11.m11.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.2.2.2.2.3.1.cmml" xref="S2.SS1.p1.11.m11.2.2.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.11.m11.2.2.2.2.3.2.cmml" xref="S2.SS1.p1.11.m11.2.2.2.2.3.2">𝑑</ci><ci id="S2.SS1.p1.11.m11.2.2.2.2.3.3.cmml" xref="S2.SS1.p1.11.m11.2.2.2.2.3.3">𝑞</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.2c">n\times d_{q},n\times d_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.2d">italic_n × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_n × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="n\times d_{v}" class="ltx_Math" display="inline" id="S2.SS1.p1.12.m12.1"><semantics id="S2.SS1.p1.12.m12.1a"><mrow id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml"><mi id="S2.SS1.p1.12.m12.1.1.2" xref="S2.SS1.p1.12.m12.1.1.2.cmml">n</mi><mo id="S2.SS1.p1.12.m12.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.12.m12.1.1.1.cmml">×</mo><msub id="S2.SS1.p1.12.m12.1.1.3" xref="S2.SS1.p1.12.m12.1.1.3.cmml"><mi id="S2.SS1.p1.12.m12.1.1.3.2" xref="S2.SS1.p1.12.m12.1.1.3.2.cmml">d</mi><mi id="S2.SS1.p1.12.m12.1.1.3.3" xref="S2.SS1.p1.12.m12.1.1.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><apply id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1"><times id="S2.SS1.p1.12.m12.1.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1.1"></times><ci id="S2.SS1.p1.12.m12.1.1.2.cmml" xref="S2.SS1.p1.12.m12.1.1.2">𝑛</ci><apply id="S2.SS1.p1.12.m12.1.1.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.3.1.cmml" xref="S2.SS1.p1.12.m12.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.12.m12.1.1.3.2.cmml" xref="S2.SS1.p1.12.m12.1.1.3.2">𝑑</ci><ci id="S2.SS1.p1.12.m12.1.1.3.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">n\times d_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m12.1d">italic_n × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.2">The <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.2.1">attention matrix</em> of <math alttext="Q" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_Q</annotation></semantics></math> and <math alttext="K" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_K</annotation></semantics></math> is defined as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{FullAttentionScores(Q,K)}=\operatorname{softmax}\left(\frac{QK^{%
T}}{\sqrt{d_{q}}}\right)," class="ltx_Math" display="block" id="S2.E1.m1.5"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mi id="S2.E1.m1.2.2.4" xref="S2.E1.m1.2.2.4.cmml">FullAttentionScores</mi><mo id="S2.E1.m1.2.2.3" xref="S2.E1.m1.2.2.3.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.5.2" xref="S2.E1.m1.2.2.5.1.cmml"><mo id="S2.E1.m1.2.2.5.2.1" stretchy="false" xref="S2.E1.m1.2.2.5.1.cmml">(</mo><mi id="S2.E1.m1.1.1.1" mathvariant="normal" xref="S2.E1.m1.1.1.1.cmml">Q</mi><mo id="S2.E1.m1.2.2.5.2.2" xref="S2.E1.m1.2.2.5.1.cmml">,</mo><mi id="S2.E1.m1.2.2.2" mathvariant="normal" xref="S2.E1.m1.2.2.2.cmml">K</mi><mo id="S2.E1.m1.2.2.5.2.3" stretchy="false" xref="S2.E1.m1.2.2.5.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.5.5.1.1.1" xref="S2.E1.m1.5.5.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.5.5.1.1.2.2" xref="S2.E1.m1.5.5.1.1.2.1.cmml"><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">softmax</mi><mo id="S2.E1.m1.5.5.1.1.2.2a" xref="S2.E1.m1.5.5.1.1.2.1.cmml">⁡</mo><mrow id="S2.E1.m1.5.5.1.1.2.2.1" xref="S2.E1.m1.5.5.1.1.2.1.cmml"><mo id="S2.E1.m1.5.5.1.1.2.2.1.1" xref="S2.E1.m1.5.5.1.1.2.1.cmml">(</mo><mfrac id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><mrow id="S2.E1.m1.4.4.2" xref="S2.E1.m1.4.4.2.cmml"><mi id="S2.E1.m1.4.4.2.2" xref="S2.E1.m1.4.4.2.2.cmml">Q</mi><mo id="S2.E1.m1.4.4.2.1" xref="S2.E1.m1.4.4.2.1.cmml">⁢</mo><msup id="S2.E1.m1.4.4.2.3" xref="S2.E1.m1.4.4.2.3.cmml"><mi id="S2.E1.m1.4.4.2.3.2" xref="S2.E1.m1.4.4.2.3.2.cmml">K</mi><mi id="S2.E1.m1.4.4.2.3.3" xref="S2.E1.m1.4.4.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S2.E1.m1.4.4.3" xref="S2.E1.m1.4.4.3.cmml"><msub id="S2.E1.m1.4.4.3.2" xref="S2.E1.m1.4.4.3.2.cmml"><mi id="S2.E1.m1.4.4.3.2.2" xref="S2.E1.m1.4.4.3.2.2.cmml">d</mi><mi id="S2.E1.m1.4.4.3.2.3" xref="S2.E1.m1.4.4.3.2.3.cmml">q</mi></msub></msqrt></mfrac><mo id="S2.E1.m1.5.5.1.1.2.2.1.2" xref="S2.E1.m1.5.5.1.1.2.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.5.5.1.2" xref="S2.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.1.1.cmml" xref="S2.E1.m1.5.5.1"><eq id="S2.E1.m1.5.5.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1"></eq><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><times id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2.3"></times><ci id="S2.E1.m1.2.2.4.cmml" xref="S2.E1.m1.2.2.4">FullAttentionScores</ci><interval closure="open" id="S2.E1.m1.2.2.5.1.cmml" xref="S2.E1.m1.2.2.5.2"><ci id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1">Q</ci><ci id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2">K</ci></interval></apply><apply id="S2.E1.m1.5.5.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.2.2"><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">softmax</ci><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4"><divide id="S2.E1.m1.4.4.1.cmml" xref="S2.E1.m1.4.4"></divide><apply id="S2.E1.m1.4.4.2.cmml" xref="S2.E1.m1.4.4.2"><times id="S2.E1.m1.4.4.2.1.cmml" xref="S2.E1.m1.4.4.2.1"></times><ci id="S2.E1.m1.4.4.2.2.cmml" xref="S2.E1.m1.4.4.2.2">𝑄</ci><apply id="S2.E1.m1.4.4.2.3.cmml" xref="S2.E1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.3.1.cmml" xref="S2.E1.m1.4.4.2.3">superscript</csymbol><ci id="S2.E1.m1.4.4.2.3.2.cmml" xref="S2.E1.m1.4.4.2.3.2">𝐾</ci><ci id="S2.E1.m1.4.4.2.3.3.cmml" xref="S2.E1.m1.4.4.2.3.3">𝑇</ci></apply></apply><apply id="S2.E1.m1.4.4.3.cmml" xref="S2.E1.m1.4.4.3"><root id="S2.E1.m1.4.4.3a.cmml" xref="S2.E1.m1.4.4.3"></root><apply id="S2.E1.m1.4.4.3.2.cmml" xref="S2.E1.m1.4.4.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.3.2.1.cmml" xref="S2.E1.m1.4.4.3.2">subscript</csymbol><ci id="S2.E1.m1.4.4.3.2.2.cmml" xref="S2.E1.m1.4.4.3.2.2">𝑑</ci><ci id="S2.E1.m1.4.4.3.2.3.cmml" xref="S2.E1.m1.4.4.3.2.3">𝑞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">\operatorname{FullAttentionScores(Q,K)}=\operatorname{softmax}\left(\frac{QK^{%
T}}{\sqrt{d_{q}}}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.5d">start_OPFUNCTION roman_FullAttentionScores ( roman_Q , roman_K ) end_OPFUNCTION = roman_softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.16">which has dimension <math alttext="n\times n" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m1.1"><semantics id="S2.SS1.p2.3.m1.1a"><mrow id="S2.SS1.p2.3.m1.1.1" xref="S2.SS1.p2.3.m1.1.1.cmml"><mi id="S2.SS1.p2.3.m1.1.1.2" xref="S2.SS1.p2.3.m1.1.1.2.cmml">n</mi><mo id="S2.SS1.p2.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p2.3.m1.1.1.1.cmml">×</mo><mi id="S2.SS1.p2.3.m1.1.1.3" xref="S2.SS1.p2.3.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m1.1b"><apply id="S2.SS1.p2.3.m1.1.1.cmml" xref="S2.SS1.p2.3.m1.1.1"><times id="S2.SS1.p2.3.m1.1.1.1.cmml" xref="S2.SS1.p2.3.m1.1.1.1"></times><ci id="S2.SS1.p2.3.m1.1.1.2.cmml" xref="S2.SS1.p2.3.m1.1.1.2">𝑛</ci><ci id="S2.SS1.p2.3.m1.1.1.3.cmml" xref="S2.SS1.p2.3.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m1.1c">n\times n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m1.1d">italic_n × italic_n</annotation></semantics></math>. Note that the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m2.1"><semantics id="S2.SS1.p2.4.m2.1a"><mi id="S2.SS1.p2.4.m2.1.1" xref="S2.SS1.p2.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m2.1b"><ci id="S2.SS1.p2.4.m2.1.1.cmml" xref="S2.SS1.p2.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m2.1d">italic_i</annotation></semantics></math>-th row of <math alttext="QK^{T}" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m3.1"><semantics id="S2.SS1.p2.5.m3.1a"><mrow id="S2.SS1.p2.5.m3.1.1" xref="S2.SS1.p2.5.m3.1.1.cmml"><mi id="S2.SS1.p2.5.m3.1.1.2" xref="S2.SS1.p2.5.m3.1.1.2.cmml">Q</mi><mo id="S2.SS1.p2.5.m3.1.1.1" xref="S2.SS1.p2.5.m3.1.1.1.cmml">⁢</mo><msup id="S2.SS1.p2.5.m3.1.1.3" xref="S2.SS1.p2.5.m3.1.1.3.cmml"><mi id="S2.SS1.p2.5.m3.1.1.3.2" xref="S2.SS1.p2.5.m3.1.1.3.2.cmml">K</mi><mi id="S2.SS1.p2.5.m3.1.1.3.3" xref="S2.SS1.p2.5.m3.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m3.1b"><apply id="S2.SS1.p2.5.m3.1.1.cmml" xref="S2.SS1.p2.5.m3.1.1"><times id="S2.SS1.p2.5.m3.1.1.1.cmml" xref="S2.SS1.p2.5.m3.1.1.1"></times><ci id="S2.SS1.p2.5.m3.1.1.2.cmml" xref="S2.SS1.p2.5.m3.1.1.2">𝑄</ci><apply id="S2.SS1.p2.5.m3.1.1.3.cmml" xref="S2.SS1.p2.5.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m3.1.1.3.1.cmml" xref="S2.SS1.p2.5.m3.1.1.3">superscript</csymbol><ci id="S2.SS1.p2.5.m3.1.1.3.2.cmml" xref="S2.SS1.p2.5.m3.1.1.3.2">𝐾</ci><ci id="S2.SS1.p2.5.m3.1.1.3.3.cmml" xref="S2.SS1.p2.5.m3.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m3.1c">QK^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m3.1d">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> consists of the scalar products of the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m4.1"><semantics id="S2.SS1.p2.6.m4.1a"><mi id="S2.SS1.p2.6.m4.1.1" xref="S2.SS1.p2.6.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m4.1b"><ci id="S2.SS1.p2.6.m4.1.1.cmml" xref="S2.SS1.p2.6.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m4.1d">italic_i</annotation></semantics></math>-th query with all the keys. Provided that the scalar product of two vectors <math alttext="a" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m5.1"><semantics id="S2.SS1.p2.7.m5.1a"><mi id="S2.SS1.p2.7.m5.1.1" xref="S2.SS1.p2.7.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m5.1b"><ci id="S2.SS1.p2.7.m5.1.1.cmml" xref="S2.SS1.p2.7.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m5.1c">a</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m5.1d">italic_a</annotation></semantics></math> and <math alttext="b" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m6.1"><semantics id="S2.SS1.p2.8.m6.1a"><mi id="S2.SS1.p2.8.m6.1.1" xref="S2.SS1.p2.8.m6.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m6.1b"><ci id="S2.SS1.p2.8.m6.1.1.cmml" xref="S2.SS1.p2.8.m6.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m6.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m6.1d">italic_b</annotation></semantics></math> satisfies <math alttext="\langle a,b\rangle=\lVert a\rVert_{2}\lVert b\rVert_{2}\cos\theta" class="ltx_Math" display="inline" id="S2.SS1.p2.9.m7.4"><semantics id="S2.SS1.p2.9.m7.4a"><mrow id="S2.SS1.p2.9.m7.4.5" xref="S2.SS1.p2.9.m7.4.5.cmml"><mrow id="S2.SS1.p2.9.m7.4.5.2.2" xref="S2.SS1.p2.9.m7.4.5.2.1.cmml"><mo id="S2.SS1.p2.9.m7.4.5.2.2.1" stretchy="false" xref="S2.SS1.p2.9.m7.4.5.2.1.cmml">⟨</mo><mi id="S2.SS1.p2.9.m7.1.1" xref="S2.SS1.p2.9.m7.1.1.cmml">a</mi><mo id="S2.SS1.p2.9.m7.4.5.2.2.2" xref="S2.SS1.p2.9.m7.4.5.2.1.cmml">,</mo><mi id="S2.SS1.p2.9.m7.2.2" xref="S2.SS1.p2.9.m7.2.2.cmml">b</mi><mo id="S2.SS1.p2.9.m7.4.5.2.2.3" stretchy="false" xref="S2.SS1.p2.9.m7.4.5.2.1.cmml">⟩</mo></mrow><mo id="S2.SS1.p2.9.m7.4.5.1" rspace="0.1389em" xref="S2.SS1.p2.9.m7.4.5.1.cmml">=</mo><mrow id="S2.SS1.p2.9.m7.4.5.3" xref="S2.SS1.p2.9.m7.4.5.3.cmml"><msub id="S2.SS1.p2.9.m7.4.5.3.2" xref="S2.SS1.p2.9.m7.4.5.3.2.cmml"><mrow id="S2.SS1.p2.9.m7.4.5.3.2.2.2" xref="S2.SS1.p2.9.m7.4.5.3.2.2.1.cmml"><mo fence="true" id="S2.SS1.p2.9.m7.4.5.3.2.2.2.1" lspace="0.1389em" rspace="0em" xref="S2.SS1.p2.9.m7.4.5.3.2.2.1.1.cmml">∥</mo><mi id="S2.SS1.p2.9.m7.3.3" xref="S2.SS1.p2.9.m7.3.3.cmml">a</mi><mo fence="true" id="S2.SS1.p2.9.m7.4.5.3.2.2.2.2" lspace="0em" xref="S2.SS1.p2.9.m7.4.5.3.2.2.1.1.cmml">∥</mo></mrow><mn id="S2.SS1.p2.9.m7.4.5.3.2.3" xref="S2.SS1.p2.9.m7.4.5.3.2.3.cmml">2</mn></msub><mo id="S2.SS1.p2.9.m7.4.5.3.1" lspace="0em" xref="S2.SS1.p2.9.m7.4.5.3.1.cmml">⁢</mo><msub id="S2.SS1.p2.9.m7.4.5.3.3" xref="S2.SS1.p2.9.m7.4.5.3.3.cmml"><mrow id="S2.SS1.p2.9.m7.4.5.3.3.2.2" xref="S2.SS1.p2.9.m7.4.5.3.3.2.1.cmml"><mo fence="true" id="S2.SS1.p2.9.m7.4.5.3.3.2.2.1" rspace="0em" xref="S2.SS1.p2.9.m7.4.5.3.3.2.1.1.cmml">∥</mo><mi id="S2.SS1.p2.9.m7.4.4" xref="S2.SS1.p2.9.m7.4.4.cmml">b</mi><mo fence="true" id="S2.SS1.p2.9.m7.4.5.3.3.2.2.2" lspace="0em" xref="S2.SS1.p2.9.m7.4.5.3.3.2.1.1.cmml">∥</mo></mrow><mn id="S2.SS1.p2.9.m7.4.5.3.3.3" xref="S2.SS1.p2.9.m7.4.5.3.3.3.cmml">2</mn></msub><mo id="S2.SS1.p2.9.m7.4.5.3.1a" lspace="0.167em" xref="S2.SS1.p2.9.m7.4.5.3.1.cmml">⁢</mo><mrow id="S2.SS1.p2.9.m7.4.5.3.4" xref="S2.SS1.p2.9.m7.4.5.3.4.cmml"><mi id="S2.SS1.p2.9.m7.4.5.3.4.1" xref="S2.SS1.p2.9.m7.4.5.3.4.1.cmml">cos</mi><mo id="S2.SS1.p2.9.m7.4.5.3.4a" lspace="0.167em" xref="S2.SS1.p2.9.m7.4.5.3.4.cmml">⁡</mo><mi id="S2.SS1.p2.9.m7.4.5.3.4.2" xref="S2.SS1.p2.9.m7.4.5.3.4.2.cmml">θ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m7.4b"><apply id="S2.SS1.p2.9.m7.4.5.cmml" xref="S2.SS1.p2.9.m7.4.5"><eq id="S2.SS1.p2.9.m7.4.5.1.cmml" xref="S2.SS1.p2.9.m7.4.5.1"></eq><list id="S2.SS1.p2.9.m7.4.5.2.1.cmml" xref="S2.SS1.p2.9.m7.4.5.2.2"><ci id="S2.SS1.p2.9.m7.1.1.cmml" xref="S2.SS1.p2.9.m7.1.1">𝑎</ci><ci id="S2.SS1.p2.9.m7.2.2.cmml" xref="S2.SS1.p2.9.m7.2.2">𝑏</ci></list><apply id="S2.SS1.p2.9.m7.4.5.3.cmml" xref="S2.SS1.p2.9.m7.4.5.3"><times id="S2.SS1.p2.9.m7.4.5.3.1.cmml" xref="S2.SS1.p2.9.m7.4.5.3.1"></times><apply id="S2.SS1.p2.9.m7.4.5.3.2.cmml" xref="S2.SS1.p2.9.m7.4.5.3.2"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m7.4.5.3.2.1.cmml" xref="S2.SS1.p2.9.m7.4.5.3.2">subscript</csymbol><apply id="S2.SS1.p2.9.m7.4.5.3.2.2.1.cmml" xref="S2.SS1.p2.9.m7.4.5.3.2.2.2"><csymbol cd="latexml" id="S2.SS1.p2.9.m7.4.5.3.2.2.1.1.cmml" xref="S2.SS1.p2.9.m7.4.5.3.2.2.2.1">delimited-∥∥</csymbol><ci id="S2.SS1.p2.9.m7.3.3.cmml" xref="S2.SS1.p2.9.m7.3.3">𝑎</ci></apply><cn id="S2.SS1.p2.9.m7.4.5.3.2.3.cmml" type="integer" xref="S2.SS1.p2.9.m7.4.5.3.2.3">2</cn></apply><apply id="S2.SS1.p2.9.m7.4.5.3.3.cmml" xref="S2.SS1.p2.9.m7.4.5.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m7.4.5.3.3.1.cmml" xref="S2.SS1.p2.9.m7.4.5.3.3">subscript</csymbol><apply id="S2.SS1.p2.9.m7.4.5.3.3.2.1.cmml" xref="S2.SS1.p2.9.m7.4.5.3.3.2.2"><csymbol cd="latexml" id="S2.SS1.p2.9.m7.4.5.3.3.2.1.1.cmml" xref="S2.SS1.p2.9.m7.4.5.3.3.2.2.1">delimited-∥∥</csymbol><ci id="S2.SS1.p2.9.m7.4.4.cmml" xref="S2.SS1.p2.9.m7.4.4">𝑏</ci></apply><cn id="S2.SS1.p2.9.m7.4.5.3.3.3.cmml" type="integer" xref="S2.SS1.p2.9.m7.4.5.3.3.3">2</cn></apply><apply id="S2.SS1.p2.9.m7.4.5.3.4.cmml" xref="S2.SS1.p2.9.m7.4.5.3.4"><cos id="S2.SS1.p2.9.m7.4.5.3.4.1.cmml" xref="S2.SS1.p2.9.m7.4.5.3.4.1"></cos><ci id="S2.SS1.p2.9.m7.4.5.3.4.2.cmml" xref="S2.SS1.p2.9.m7.4.5.3.4.2">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m7.4c">\langle a,b\rangle=\lVert a\rVert_{2}\lVert b\rVert_{2}\cos\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.9.m7.4d">⟨ italic_a , italic_b ⟩ = ∥ italic_a ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ italic_b ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT roman_cos italic_θ</annotation></semantics></math>, where <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS1.p2.10.m8.1"><semantics id="S2.SS1.p2.10.m8.1a"><mi id="S2.SS1.p2.10.m8.1.1" xref="S2.SS1.p2.10.m8.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.10.m8.1b"><ci id="S2.SS1.p2.10.m8.1.1.cmml" xref="S2.SS1.p2.10.m8.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.10.m8.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.10.m8.1d">italic_θ</annotation></semantics></math> is the angle between the vectors <math alttext="a" class="ltx_Math" display="inline" id="S2.SS1.p2.11.m9.1"><semantics id="S2.SS1.p2.11.m9.1a"><mi id="S2.SS1.p2.11.m9.1.1" xref="S2.SS1.p2.11.m9.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.11.m9.1b"><ci id="S2.SS1.p2.11.m9.1.1.cmml" xref="S2.SS1.p2.11.m9.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.11.m9.1c">a</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.11.m9.1d">italic_a</annotation></semantics></math> and <math alttext="b" class="ltx_Math" display="inline" id="S2.SS1.p2.12.m10.1"><semantics id="S2.SS1.p2.12.m10.1a"><mi id="S2.SS1.p2.12.m10.1.1" xref="S2.SS1.p2.12.m10.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.12.m10.1b"><ci id="S2.SS1.p2.12.m10.1.1.cmml" xref="S2.SS1.p2.12.m10.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.12.m10.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.12.m10.1d">italic_b</annotation></semantics></math>. Thus, the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p2.13.m11.1"><semantics id="S2.SS1.p2.13.m11.1a"><mi id="S2.SS1.p2.13.m11.1.1" xref="S2.SS1.p2.13.m11.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.13.m11.1b"><ci id="S2.SS1.p2.13.m11.1.1.cmml" xref="S2.SS1.p2.13.m11.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.13.m11.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.13.m11.1d">italic_i</annotation></semantics></math>-th row of <math alttext="QK^{T}" class="ltx_Math" display="inline" id="S2.SS1.p2.14.m12.1"><semantics id="S2.SS1.p2.14.m12.1a"><mrow id="S2.SS1.p2.14.m12.1.1" xref="S2.SS1.p2.14.m12.1.1.cmml"><mi id="S2.SS1.p2.14.m12.1.1.2" xref="S2.SS1.p2.14.m12.1.1.2.cmml">Q</mi><mo id="S2.SS1.p2.14.m12.1.1.1" xref="S2.SS1.p2.14.m12.1.1.1.cmml">⁢</mo><msup id="S2.SS1.p2.14.m12.1.1.3" xref="S2.SS1.p2.14.m12.1.1.3.cmml"><mi id="S2.SS1.p2.14.m12.1.1.3.2" xref="S2.SS1.p2.14.m12.1.1.3.2.cmml">K</mi><mi id="S2.SS1.p2.14.m12.1.1.3.3" xref="S2.SS1.p2.14.m12.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.14.m12.1b"><apply id="S2.SS1.p2.14.m12.1.1.cmml" xref="S2.SS1.p2.14.m12.1.1"><times id="S2.SS1.p2.14.m12.1.1.1.cmml" xref="S2.SS1.p2.14.m12.1.1.1"></times><ci id="S2.SS1.p2.14.m12.1.1.2.cmml" xref="S2.SS1.p2.14.m12.1.1.2">𝑄</ci><apply id="S2.SS1.p2.14.m12.1.1.3.cmml" xref="S2.SS1.p2.14.m12.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.14.m12.1.1.3.1.cmml" xref="S2.SS1.p2.14.m12.1.1.3">superscript</csymbol><ci id="S2.SS1.p2.14.m12.1.1.3.2.cmml" xref="S2.SS1.p2.14.m12.1.1.3.2">𝐾</ci><ci id="S2.SS1.p2.14.m12.1.1.3.3.cmml" xref="S2.SS1.p2.14.m12.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.14.m12.1c">QK^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.14.m12.1d">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> ranges from <math alttext="-\lVert Q_{i}\rVert_{2}\lVert K_{j}\rVert_{2}" class="ltx_Math" display="inline" id="S2.SS1.p2.15.m13.2"><semantics id="S2.SS1.p2.15.m13.2a"><mrow id="S2.SS1.p2.15.m13.2.2" xref="S2.SS1.p2.15.m13.2.2.cmml"><mo id="S2.SS1.p2.15.m13.2.2a" xref="S2.SS1.p2.15.m13.2.2.cmml">−</mo><mrow id="S2.SS1.p2.15.m13.2.2.2" xref="S2.SS1.p2.15.m13.2.2.2.cmml"><msub id="S2.SS1.p2.15.m13.1.1.1.1" xref="S2.SS1.p2.15.m13.1.1.1.1.cmml"><mrow id="S2.SS1.p2.15.m13.1.1.1.1.1.1" xref="S2.SS1.p2.15.m13.1.1.1.1.1.2.cmml"><mo fence="true" id="S2.SS1.p2.15.m13.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S2.SS1.p2.15.m13.1.1.1.1.1.2.1.cmml">∥</mo><msub id="S2.SS1.p2.15.m13.1.1.1.1.1.1.1" xref="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.2" xref="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.2.cmml">Q</mi><mi id="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.3" xref="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo fence="true" id="S2.SS1.p2.15.m13.1.1.1.1.1.1.3" lspace="0em" xref="S2.SS1.p2.15.m13.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S2.SS1.p2.15.m13.1.1.1.1.3" xref="S2.SS1.p2.15.m13.1.1.1.1.3.cmml">2</mn></msub><mo id="S2.SS1.p2.15.m13.2.2.2.3" lspace="0em" xref="S2.SS1.p2.15.m13.2.2.2.3.cmml">⁢</mo><msub id="S2.SS1.p2.15.m13.2.2.2.2" xref="S2.SS1.p2.15.m13.2.2.2.2.cmml"><mrow id="S2.SS1.p2.15.m13.2.2.2.2.1.1" xref="S2.SS1.p2.15.m13.2.2.2.2.1.2.cmml"><mo fence="true" id="S2.SS1.p2.15.m13.2.2.2.2.1.1.2" rspace="0em" xref="S2.SS1.p2.15.m13.2.2.2.2.1.2.1.cmml">∥</mo><msub id="S2.SS1.p2.15.m13.2.2.2.2.1.1.1" xref="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.2" xref="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.2.cmml">K</mi><mi id="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.3" xref="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo fence="true" id="S2.SS1.p2.15.m13.2.2.2.2.1.1.3" lspace="0em" xref="S2.SS1.p2.15.m13.2.2.2.2.1.2.1.cmml">∥</mo></mrow><mn id="S2.SS1.p2.15.m13.2.2.2.2.3" xref="S2.SS1.p2.15.m13.2.2.2.2.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.15.m13.2b"><apply id="S2.SS1.p2.15.m13.2.2.cmml" xref="S2.SS1.p2.15.m13.2.2"><minus id="S2.SS1.p2.15.m13.2.2.3.cmml" xref="S2.SS1.p2.15.m13.2.2"></minus><apply id="S2.SS1.p2.15.m13.2.2.2.cmml" xref="S2.SS1.p2.15.m13.2.2.2"><times id="S2.SS1.p2.15.m13.2.2.2.3.cmml" xref="S2.SS1.p2.15.m13.2.2.2.3"></times><apply id="S2.SS1.p2.15.m13.1.1.1.1.cmml" xref="S2.SS1.p2.15.m13.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.15.m13.1.1.1.1.2.cmml" xref="S2.SS1.p2.15.m13.1.1.1.1">subscript</csymbol><apply id="S2.SS1.p2.15.m13.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.15.m13.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.15.m13.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.15.m13.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.15.m13.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.15.m13.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.2">𝑄</ci><ci id="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.15.m13.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S2.SS1.p2.15.m13.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.15.m13.1.1.1.1.3">2</cn></apply><apply id="S2.SS1.p2.15.m13.2.2.2.2.cmml" xref="S2.SS1.p2.15.m13.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.15.m13.2.2.2.2.2.cmml" xref="S2.SS1.p2.15.m13.2.2.2.2">subscript</csymbol><apply id="S2.SS1.p2.15.m13.2.2.2.2.1.2.cmml" xref="S2.SS1.p2.15.m13.2.2.2.2.1.1"><csymbol cd="latexml" id="S2.SS1.p2.15.m13.2.2.2.2.1.2.1.cmml" xref="S2.SS1.p2.15.m13.2.2.2.2.1.1.2">delimited-∥∥</csymbol><apply id="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.cmml" xref="S2.SS1.p2.15.m13.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.15.m13.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.2">𝐾</ci><ci id="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.3.cmml" xref="S2.SS1.p2.15.m13.2.2.2.2.1.1.1.3">𝑗</ci></apply></apply><cn id="S2.SS1.p2.15.m13.2.2.2.2.3.cmml" type="integer" xref="S2.SS1.p2.15.m13.2.2.2.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.15.m13.2c">-\lVert Q_{i}\rVert_{2}\lVert K_{j}\rVert_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.15.m13.2d">- ∥ italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\lVert Q_{i}\rVert_{2}\lVert K_{j}\rVert_{2}" class="ltx_Math" display="inline" id="S2.SS1.p2.16.m14.2"><semantics id="S2.SS1.p2.16.m14.2a"><mrow id="S2.SS1.p2.16.m14.2.2" xref="S2.SS1.p2.16.m14.2.2.cmml"><msub id="S2.SS1.p2.16.m14.1.1.1" xref="S2.SS1.p2.16.m14.1.1.1.cmml"><mrow id="S2.SS1.p2.16.m14.1.1.1.1.1" xref="S2.SS1.p2.16.m14.1.1.1.1.2.cmml"><mo fence="true" id="S2.SS1.p2.16.m14.1.1.1.1.1.2" rspace="0em" xref="S2.SS1.p2.16.m14.1.1.1.1.2.1.cmml">∥</mo><msub id="S2.SS1.p2.16.m14.1.1.1.1.1.1" xref="S2.SS1.p2.16.m14.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.16.m14.1.1.1.1.1.1.2" xref="S2.SS1.p2.16.m14.1.1.1.1.1.1.2.cmml">Q</mi><mi id="S2.SS1.p2.16.m14.1.1.1.1.1.1.3" xref="S2.SS1.p2.16.m14.1.1.1.1.1.1.3.cmml">i</mi></msub><mo fence="true" id="S2.SS1.p2.16.m14.1.1.1.1.1.3" lspace="0em" xref="S2.SS1.p2.16.m14.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S2.SS1.p2.16.m14.1.1.1.3" xref="S2.SS1.p2.16.m14.1.1.1.3.cmml">2</mn></msub><mo id="S2.SS1.p2.16.m14.2.2.3" lspace="0em" xref="S2.SS1.p2.16.m14.2.2.3.cmml">⁢</mo><msub id="S2.SS1.p2.16.m14.2.2.2" xref="S2.SS1.p2.16.m14.2.2.2.cmml"><mrow id="S2.SS1.p2.16.m14.2.2.2.1.1" xref="S2.SS1.p2.16.m14.2.2.2.1.2.cmml"><mo fence="true" id="S2.SS1.p2.16.m14.2.2.2.1.1.2" rspace="0em" xref="S2.SS1.p2.16.m14.2.2.2.1.2.1.cmml">∥</mo><msub id="S2.SS1.p2.16.m14.2.2.2.1.1.1" xref="S2.SS1.p2.16.m14.2.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.16.m14.2.2.2.1.1.1.2" xref="S2.SS1.p2.16.m14.2.2.2.1.1.1.2.cmml">K</mi><mi id="S2.SS1.p2.16.m14.2.2.2.1.1.1.3" xref="S2.SS1.p2.16.m14.2.2.2.1.1.1.3.cmml">j</mi></msub><mo fence="true" id="S2.SS1.p2.16.m14.2.2.2.1.1.3" lspace="0em" xref="S2.SS1.p2.16.m14.2.2.2.1.2.1.cmml">∥</mo></mrow><mn id="S2.SS1.p2.16.m14.2.2.2.3" xref="S2.SS1.p2.16.m14.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.16.m14.2b"><apply id="S2.SS1.p2.16.m14.2.2.cmml" xref="S2.SS1.p2.16.m14.2.2"><times id="S2.SS1.p2.16.m14.2.2.3.cmml" xref="S2.SS1.p2.16.m14.2.2.3"></times><apply id="S2.SS1.p2.16.m14.1.1.1.cmml" xref="S2.SS1.p2.16.m14.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.16.m14.1.1.1.2.cmml" xref="S2.SS1.p2.16.m14.1.1.1">subscript</csymbol><apply id="S2.SS1.p2.16.m14.1.1.1.1.2.cmml" xref="S2.SS1.p2.16.m14.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.16.m14.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.16.m14.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S2.SS1.p2.16.m14.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.16.m14.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.16.m14.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.16.m14.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.16.m14.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.16.m14.1.1.1.1.1.1.2">𝑄</ci><ci id="S2.SS1.p2.16.m14.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.16.m14.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S2.SS1.p2.16.m14.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.16.m14.1.1.1.3">2</cn></apply><apply id="S2.SS1.p2.16.m14.2.2.2.cmml" xref="S2.SS1.p2.16.m14.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.16.m14.2.2.2.2.cmml" xref="S2.SS1.p2.16.m14.2.2.2">subscript</csymbol><apply id="S2.SS1.p2.16.m14.2.2.2.1.2.cmml" xref="S2.SS1.p2.16.m14.2.2.2.1.1"><csymbol cd="latexml" id="S2.SS1.p2.16.m14.2.2.2.1.2.1.cmml" xref="S2.SS1.p2.16.m14.2.2.2.1.1.2">delimited-∥∥</csymbol><apply id="S2.SS1.p2.16.m14.2.2.2.1.1.1.cmml" xref="S2.SS1.p2.16.m14.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.16.m14.2.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.16.m14.2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.16.m14.2.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.16.m14.2.2.2.1.1.1.2">𝐾</ci><ci id="S2.SS1.p2.16.m14.2.2.2.1.1.1.3.cmml" xref="S2.SS1.p2.16.m14.2.2.2.1.1.1.3">𝑗</ci></apply></apply><cn id="S2.SS1.p2.16.m14.2.2.2.3.cmml" type="integer" xref="S2.SS1.p2.16.m14.2.2.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.16.m14.2c">\lVert Q_{i}\rVert_{2}\lVert K_{j}\rVert_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.16.m14.2d">∥ italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. The softmax function here guarantees that attention matrix is stochastic, that is, each row consists of non-negative real numbers that add up to one. The entries of the attention matrix are called <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.16.1">attention scores</em>. The canonical attention mechanism (refereed in this work as full attention mechanism) is then defined as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{FullAttn(Q,K,V)}=\operatorname{softmax}\left(\frac{QK^{T}}{\sqrt%
{d_{q}}}\right)V," class="ltx_Math" display="block" id="S2.E2.m1.6"><semantics id="S2.E2.m1.6a"><mrow id="S2.E2.m1.6.6.1" xref="S2.E2.m1.6.6.1.1.cmml"><mrow id="S2.E2.m1.6.6.1.1" xref="S2.E2.m1.6.6.1.1.cmml"><mrow id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml"><mi id="S2.E2.m1.3.3.5" xref="S2.E2.m1.3.3.5.cmml">FullAttn</mi><mo id="S2.E2.m1.3.3.4" xref="S2.E2.m1.3.3.4.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.6.2" xref="S2.E2.m1.3.3.6.1.cmml"><mo id="S2.E2.m1.3.3.6.2.1" stretchy="false" xref="S2.E2.m1.3.3.6.1.cmml">(</mo><mi id="S2.E2.m1.1.1.1" mathvariant="normal" xref="S2.E2.m1.1.1.1.cmml">Q</mi><mo id="S2.E2.m1.3.3.6.2.2" xref="S2.E2.m1.3.3.6.1.cmml">,</mo><mi id="S2.E2.m1.2.2.2" mathvariant="normal" xref="S2.E2.m1.2.2.2.cmml">K</mi><mo id="S2.E2.m1.3.3.6.2.3" xref="S2.E2.m1.3.3.6.1.cmml">,</mo><mi id="S2.E2.m1.3.3.3" mathvariant="normal" xref="S2.E2.m1.3.3.3.cmml">V</mi><mo id="S2.E2.m1.3.3.6.2.4" stretchy="false" xref="S2.E2.m1.3.3.6.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.1" xref="S2.E2.m1.6.6.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.6.6.1.1.2" xref="S2.E2.m1.6.6.1.1.2.cmml"><mrow id="S2.E2.m1.6.6.1.1.2.2.2" xref="S2.E2.m1.6.6.1.1.2.2.1.cmml"><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">softmax</mi><mo id="S2.E2.m1.6.6.1.1.2.2.2a" xref="S2.E2.m1.6.6.1.1.2.2.1.cmml">⁡</mo><mrow id="S2.E2.m1.6.6.1.1.2.2.2.1" xref="S2.E2.m1.6.6.1.1.2.2.1.cmml"><mo id="S2.E2.m1.6.6.1.1.2.2.2.1.1" xref="S2.E2.m1.6.6.1.1.2.2.1.cmml">(</mo><mfrac id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml"><mrow id="S2.E2.m1.5.5.2" xref="S2.E2.m1.5.5.2.cmml"><mi id="S2.E2.m1.5.5.2.2" xref="S2.E2.m1.5.5.2.2.cmml">Q</mi><mo id="S2.E2.m1.5.5.2.1" xref="S2.E2.m1.5.5.2.1.cmml">⁢</mo><msup id="S2.E2.m1.5.5.2.3" xref="S2.E2.m1.5.5.2.3.cmml"><mi id="S2.E2.m1.5.5.2.3.2" xref="S2.E2.m1.5.5.2.3.2.cmml">K</mi><mi id="S2.E2.m1.5.5.2.3.3" xref="S2.E2.m1.5.5.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S2.E2.m1.5.5.3" xref="S2.E2.m1.5.5.3.cmml"><msub id="S2.E2.m1.5.5.3.2" xref="S2.E2.m1.5.5.3.2.cmml"><mi id="S2.E2.m1.5.5.3.2.2" xref="S2.E2.m1.5.5.3.2.2.cmml">d</mi><mi id="S2.E2.m1.5.5.3.2.3" xref="S2.E2.m1.5.5.3.2.3.cmml">q</mi></msub></msqrt></mfrac><mo id="S2.E2.m1.6.6.1.1.2.2.2.1.2" xref="S2.E2.m1.6.6.1.1.2.2.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.2.1" xref="S2.E2.m1.6.6.1.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.6.6.1.1.2.3" xref="S2.E2.m1.6.6.1.1.2.3.cmml">V</mi></mrow></mrow><mo id="S2.E2.m1.6.6.1.2" xref="S2.E2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.6b"><apply id="S2.E2.m1.6.6.1.1.cmml" xref="S2.E2.m1.6.6.1"><eq id="S2.E2.m1.6.6.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1"></eq><apply id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3"><times id="S2.E2.m1.3.3.4.cmml" xref="S2.E2.m1.3.3.4"></times><ci id="S2.E2.m1.3.3.5.cmml" xref="S2.E2.m1.3.3.5">FullAttn</ci><vector id="S2.E2.m1.3.3.6.1.cmml" xref="S2.E2.m1.3.3.6.2"><ci id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1">Q</ci><ci id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2">K</ci><ci id="S2.E2.m1.3.3.3.cmml" xref="S2.E2.m1.3.3.3">V</ci></vector></apply><apply id="S2.E2.m1.6.6.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2"><times id="S2.E2.m1.6.6.1.1.2.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1"></times><apply id="S2.E2.m1.6.6.1.1.2.2.1.cmml" xref="S2.E2.m1.6.6.1.1.2.2.2"><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">softmax</ci><apply id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5"><divide id="S2.E2.m1.5.5.1.cmml" xref="S2.E2.m1.5.5"></divide><apply id="S2.E2.m1.5.5.2.cmml" xref="S2.E2.m1.5.5.2"><times id="S2.E2.m1.5.5.2.1.cmml" xref="S2.E2.m1.5.5.2.1"></times><ci id="S2.E2.m1.5.5.2.2.cmml" xref="S2.E2.m1.5.5.2.2">𝑄</ci><apply id="S2.E2.m1.5.5.2.3.cmml" xref="S2.E2.m1.5.5.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.3.1.cmml" xref="S2.E2.m1.5.5.2.3">superscript</csymbol><ci id="S2.E2.m1.5.5.2.3.2.cmml" xref="S2.E2.m1.5.5.2.3.2">𝐾</ci><ci id="S2.E2.m1.5.5.2.3.3.cmml" xref="S2.E2.m1.5.5.2.3.3">𝑇</ci></apply></apply><apply id="S2.E2.m1.5.5.3.cmml" xref="S2.E2.m1.5.5.3"><root id="S2.E2.m1.5.5.3a.cmml" xref="S2.E2.m1.5.5.3"></root><apply id="S2.E2.m1.5.5.3.2.cmml" xref="S2.E2.m1.5.5.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.3.2.1.cmml" xref="S2.E2.m1.5.5.3.2">subscript</csymbol><ci id="S2.E2.m1.5.5.3.2.2.cmml" xref="S2.E2.m1.5.5.3.2.2">𝑑</ci><ci id="S2.E2.m1.5.5.3.2.3.cmml" xref="S2.E2.m1.5.5.3.2.3">𝑞</ci></apply></apply></apply></apply><ci id="S2.E2.m1.6.6.1.1.2.3.cmml" xref="S2.E2.m1.6.6.1.1.2.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.6c">\operatorname{FullAttn(Q,K,V)}=\operatorname{softmax}\left(\frac{QK^{T}}{\sqrt%
{d_{q}}}\right)V,</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.6d">start_OPFUNCTION roman_FullAttn ( roman_Q , roman_K , roman_V ) end_OPFUNCTION = roman_softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.21">so the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p2.17.m1.1"><semantics id="S2.SS1.p2.17.m1.1a"><mi id="S2.SS1.p2.17.m1.1.1" xref="S2.SS1.p2.17.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.17.m1.1b"><ci id="S2.SS1.p2.17.m1.1.1.cmml" xref="S2.SS1.p2.17.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.17.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.17.m1.1d">italic_i</annotation></semantics></math>-th output is a weighted average of the values. The scale factor <math alttext="1/\sqrt{d_{q}}" class="ltx_Math" display="inline" id="S2.SS1.p2.18.m2.1"><semantics id="S2.SS1.p2.18.m2.1a"><mrow id="S2.SS1.p2.18.m2.1.1" xref="S2.SS1.p2.18.m2.1.1.cmml"><mn id="S2.SS1.p2.18.m2.1.1.2" xref="S2.SS1.p2.18.m2.1.1.2.cmml">1</mn><mo id="S2.SS1.p2.18.m2.1.1.1" xref="S2.SS1.p2.18.m2.1.1.1.cmml">/</mo><msqrt id="S2.SS1.p2.18.m2.1.1.3" xref="S2.SS1.p2.18.m2.1.1.3.cmml"><msub id="S2.SS1.p2.18.m2.1.1.3.2" xref="S2.SS1.p2.18.m2.1.1.3.2.cmml"><mi id="S2.SS1.p2.18.m2.1.1.3.2.2" xref="S2.SS1.p2.18.m2.1.1.3.2.2.cmml">d</mi><mi id="S2.SS1.p2.18.m2.1.1.3.2.3" xref="S2.SS1.p2.18.m2.1.1.3.2.3.cmml">q</mi></msub></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.18.m2.1b"><apply id="S2.SS1.p2.18.m2.1.1.cmml" xref="S2.SS1.p2.18.m2.1.1"><divide id="S2.SS1.p2.18.m2.1.1.1.cmml" xref="S2.SS1.p2.18.m2.1.1.1"></divide><cn id="S2.SS1.p2.18.m2.1.1.2.cmml" type="integer" xref="S2.SS1.p2.18.m2.1.1.2">1</cn><apply id="S2.SS1.p2.18.m2.1.1.3.cmml" xref="S2.SS1.p2.18.m2.1.1.3"><root id="S2.SS1.p2.18.m2.1.1.3a.cmml" xref="S2.SS1.p2.18.m2.1.1.3"></root><apply id="S2.SS1.p2.18.m2.1.1.3.2.cmml" xref="S2.SS1.p2.18.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p2.18.m2.1.1.3.2.1.cmml" xref="S2.SS1.p2.18.m2.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p2.18.m2.1.1.3.2.2.cmml" xref="S2.SS1.p2.18.m2.1.1.3.2.2">𝑑</ci><ci id="S2.SS1.p2.18.m2.1.1.3.2.3.cmml" xref="S2.SS1.p2.18.m2.1.1.3.2.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.18.m2.1c">1/\sqrt{d_{q}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.18.m2.1d">1 / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> does not change the output of <math alttext="\operatorname{softmax}" class="ltx_Math" display="inline" id="S2.SS1.p2.19.m3.1"><semantics id="S2.SS1.p2.19.m3.1a"><mi id="S2.SS1.p2.19.m3.1.1" xref="S2.SS1.p2.19.m3.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.19.m3.1b"><ci id="S2.SS1.p2.19.m3.1.1.cmml" xref="S2.SS1.p2.19.m3.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.19.m3.1c">\operatorname{softmax}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.19.m3.1d">roman_softmax</annotation></semantics></math>; its purpose is to help scaling the gradients of <math alttext="\operatorname{softmax}" class="ltx_Math" display="inline" id="S2.SS1.p2.20.m4.1"><semantics id="S2.SS1.p2.20.m4.1a"><mi id="S2.SS1.p2.20.m4.1.1" xref="S2.SS1.p2.20.m4.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.20.m4.1b"><ci id="S2.SS1.p2.20.m4.1.1.cmml" xref="S2.SS1.p2.20.m4.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.20.m4.1c">\operatorname{softmax}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.20.m4.1d">roman_softmax</annotation></semantics></math> during training in order to avoid gradients too close to <math alttext="0" class="ltx_Math" display="inline" id="S2.SS1.p2.21.m5.1"><semantics id="S2.SS1.p2.21.m5.1a"><mn id="S2.SS1.p2.21.m5.1.1" xref="S2.SS1.p2.21.m5.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.21.m5.1b"><cn id="S2.SS1.p2.21.m5.1.1.cmml" type="integer" xref="S2.SS1.p2.21.m5.1.1">0</cn></annotation-xml></semantics></math>, which may decrease the rate at which a transformer is able to learn from data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.5">The most common application of attention in transformers corresponds to the case <math alttext="Q=K" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1"><semantics id="S2.SS1.p3.1.m1.1a"><mrow id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">Q</mi><mo id="S2.SS1.p3.1.m1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.cmml">=</mo><mi id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><eq id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1"></eq><ci id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2">𝑄</ci><ci id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">Q=K</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">italic_Q = italic_K</annotation></semantics></math>. In this setting, the full attention mechanism resembles a smooth non-parametric regression <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib32" title="">32</a>]</cite> of <math alttext="V" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.1"><semantics id="S2.SS1.p3.2.m2.1a"><mi id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><ci id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">italic_V</annotation></semantics></math> in terms of <math alttext="Q=K" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.1"><semantics id="S2.SS1.p3.3.m3.1a"><mrow id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml"><mi id="S2.SS1.p3.3.m3.1.1.2" xref="S2.SS1.p3.3.m3.1.1.2.cmml">Q</mi><mo id="S2.SS1.p3.3.m3.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.cmml">=</mo><mi id="S2.SS1.p3.3.m3.1.1.3" xref="S2.SS1.p3.3.m3.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.1b"><apply id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1"><eq id="S2.SS1.p3.3.m3.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1"></eq><ci id="S2.SS1.p3.3.m3.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1.2">𝑄</ci><ci id="S2.SS1.p3.3.m3.1.1.3.cmml" xref="S2.SS1.p3.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.1c">Q=K</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.1d">italic_Q = italic_K</annotation></semantics></math>,  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib33" title="">33</a>]</cite>, effectively providing a smoothing of <math alttext="V" class="ltx_Math" display="inline" id="S2.SS1.p3.4.m4.1"><semantics id="S2.SS1.p3.4.m4.1a"><mi id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.1b"><ci id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.1c">V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m4.1d">italic_V</annotation></semantics></math>. We refer to <em class="ltx_emph ltx_font_italic" id="S2.SS1.p3.5.1">self-attention</em> as the case when <math alttext="Q=K=V" class="ltx_Math" display="inline" id="S2.SS1.p3.5.m5.1"><semantics id="S2.SS1.p3.5.m5.1a"><mrow id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml"><mi id="S2.SS1.p3.5.m5.1.1.2" xref="S2.SS1.p3.5.m5.1.1.2.cmml">Q</mi><mo id="S2.SS1.p3.5.m5.1.1.3" xref="S2.SS1.p3.5.m5.1.1.3.cmml">=</mo><mi id="S2.SS1.p3.5.m5.1.1.4" xref="S2.SS1.p3.5.m5.1.1.4.cmml">K</mi><mo id="S2.SS1.p3.5.m5.1.1.5" xref="S2.SS1.p3.5.m5.1.1.5.cmml">=</mo><mi id="S2.SS1.p3.5.m5.1.1.6" xref="S2.SS1.p3.5.m5.1.1.6.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><apply id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1"><and id="S2.SS1.p3.5.m5.1.1a.cmml" xref="S2.SS1.p3.5.m5.1.1"></and><apply id="S2.SS1.p3.5.m5.1.1b.cmml" xref="S2.SS1.p3.5.m5.1.1"><eq id="S2.SS1.p3.5.m5.1.1.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3"></eq><ci id="S2.SS1.p3.5.m5.1.1.2.cmml" xref="S2.SS1.p3.5.m5.1.1.2">𝑄</ci><ci id="S2.SS1.p3.5.m5.1.1.4.cmml" xref="S2.SS1.p3.5.m5.1.1.4">𝐾</ci></apply><apply id="S2.SS1.p3.5.m5.1.1c.cmml" xref="S2.SS1.p3.5.m5.1.1"><eq id="S2.SS1.p3.5.m5.1.1.5.cmml" xref="S2.SS1.p3.5.m5.1.1.5"></eq><share href="https://arxiv.org/html/2410.03805v1#S2.SS1.p3.5.m5.1.1.4.cmml" id="S2.SS1.p3.5.m5.1.1d.cmml" xref="S2.SS1.p3.5.m5.1.1"></share><ci id="S2.SS1.p3.5.m5.1.1.6.cmml" xref="S2.SS1.p3.5.m5.1.1.6">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">Q=K=V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.5.m5.1d">italic_Q = italic_K = italic_V</annotation></semantics></math>. Intuitively, self-attention weighs in the similarity of different elements in a sequence and smooths the input data. Empirically this process has been shown to be highly effective in capturing both local and global patterns in data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib34" title="">34</a>]</cite>. However, this intuition has not been corroborated from a theoretical point of view, where mathematical results have only managed to unveil the Lipschitz constant of the attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib35" title="">35</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.13">Transformers use an improvement of the attention mechanism, known as multi-head attention. Given an attention mechanism <math alttext="\operatorname{Attn(\cdot,\cdot,\cdot)}" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.3"><semantics id="S2.SS1.p4.1.m1.3a"><mrow id="S2.SS1.p4.1.m1.3.3" xref="S2.SS1.p4.1.m1.3.3.cmml"><mi id="S2.SS1.p4.1.m1.3.3.5" xref="S2.SS1.p4.1.m1.3.3.5.cmml">Attn</mi><mo id="S2.SS1.p4.1.m1.3.3.4" xref="S2.SS1.p4.1.m1.3.3.4.cmml">⁢</mo><mrow id="S2.SS1.p4.1.m1.3.3.6.2" xref="S2.SS1.p4.1.m1.3.3.6.1.cmml"><mo id="S2.SS1.p4.1.m1.3.3.6.2.1" stretchy="false" xref="S2.SS1.p4.1.m1.3.3.6.1.cmml">(</mo><mo id="S2.SS1.p4.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S2.SS1.p4.1.m1.1.1.1.cmml">⋅</mo><mo id="S2.SS1.p4.1.m1.3.3.6.2.2" rspace="0em" xref="S2.SS1.p4.1.m1.3.3.6.1.cmml">,</mo><mo id="S2.SS1.p4.1.m1.2.2.2" lspace="0em" rspace="0em" xref="S2.SS1.p4.1.m1.2.2.2.cmml">⋅</mo><mo id="S2.SS1.p4.1.m1.3.3.6.2.3" rspace="0em" xref="S2.SS1.p4.1.m1.3.3.6.1.cmml">,</mo><mo id="S2.SS1.p4.1.m1.3.3.3" lspace="0em" rspace="0em" xref="S2.SS1.p4.1.m1.3.3.3.cmml">⋅</mo><mo id="S2.SS1.p4.1.m1.3.3.6.2.4" stretchy="false" xref="S2.SS1.p4.1.m1.3.3.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.3b"><apply id="S2.SS1.p4.1.m1.3.3.cmml" xref="S2.SS1.p4.1.m1.3.3"><times id="S2.SS1.p4.1.m1.3.3.4.cmml" xref="S2.SS1.p4.1.m1.3.3.4"></times><ci id="S2.SS1.p4.1.m1.3.3.5.cmml" xref="S2.SS1.p4.1.m1.3.3.5">Attn</ci><vector id="S2.SS1.p4.1.m1.3.3.6.1.cmml" xref="S2.SS1.p4.1.m1.3.3.6.2"><ci id="S2.SS1.p4.1.m1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1">⋅</ci><ci id="S2.SS1.p4.1.m1.2.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.2">⋅</ci><ci id="S2.SS1.p4.1.m1.3.3.3.cmml" xref="S2.SS1.p4.1.m1.3.3.3">⋅</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.3c">\operatorname{Attn(\cdot,\cdot,\cdot)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.3d">roman_Attn ( ⋅ , ⋅ , ⋅ )</annotation></semantics></math>, which may be <math alttext="\operatorname{FullAttn}" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m2.1"><semantics id="S2.SS1.p4.2.m2.1a"><mi id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml">FullAttn</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><ci id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1">FullAttn</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">\operatorname{FullAttn}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m2.1d">roman_FullAttn</annotation></semantics></math> or one of the other mechanisms that we will introduce later in this work. The idea here is applying linear projections (on the dimension of the characteristics) to learn <math alttext="h" class="ltx_Math" display="inline" id="S2.SS1.p4.3.m3.1"><semantics id="S2.SS1.p4.3.m3.1a"><mi id="S2.SS1.p4.3.m3.1.1" xref="S2.SS1.p4.3.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m3.1b"><ci id="S2.SS1.p4.3.m3.1.1.cmml" xref="S2.SS1.p4.3.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m3.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.3.m3.1d">italic_h</annotation></semantics></math> representations of the inputs <math alttext="Q" class="ltx_Math" display="inline" id="S2.SS1.p4.4.m4.1"><semantics id="S2.SS1.p4.4.m4.1a"><mi id="S2.SS1.p4.4.m4.1.1" xref="S2.SS1.p4.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m4.1b"><ci id="S2.SS1.p4.4.m4.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m4.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.4.m4.1d">italic_Q</annotation></semantics></math>, <math alttext="K" class="ltx_Math" display="inline" id="S2.SS1.p4.5.m5.1"><semantics id="S2.SS1.p4.5.m5.1a"><mi id="S2.SS1.p4.5.m5.1.1" xref="S2.SS1.p4.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.5.m5.1b"><ci id="S2.SS1.p4.5.m5.1.1.cmml" xref="S2.SS1.p4.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.5.m5.1d">italic_K</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S2.SS1.p4.6.m6.1"><semantics id="S2.SS1.p4.6.m6.1a"><mi id="S2.SS1.p4.6.m6.1.1" xref="S2.SS1.p4.6.m6.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.6.m6.1b"><ci id="S2.SS1.p4.6.m6.1.1.cmml" xref="S2.SS1.p4.6.m6.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.6.m6.1c">V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.6.m6.1d">italic_V</annotation></semantics></math>. The weights of these linear projections will be optimised in the learning phase, aiming to learn representations that boost the performance of the attention mechanism. Then the attention mechanism is applied to each of the <math alttext="h" class="ltx_Math" display="inline" id="S2.SS1.p4.7.m7.1"><semantics id="S2.SS1.p4.7.m7.1a"><mi id="S2.SS1.p4.7.m7.1.1" xref="S2.SS1.p4.7.m7.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.7.m7.1b"><ci id="S2.SS1.p4.7.m7.1.1.cmml" xref="S2.SS1.p4.7.m7.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.7.m7.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.7.m7.1d">italic_h</annotation></semantics></math> triples formed by the projections of <math alttext="Q" class="ltx_Math" display="inline" id="S2.SS1.p4.8.m8.1"><semantics id="S2.SS1.p4.8.m8.1a"><mi id="S2.SS1.p4.8.m8.1.1" xref="S2.SS1.p4.8.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.8.m8.1b"><ci id="S2.SS1.p4.8.m8.1.1.cmml" xref="S2.SS1.p4.8.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.8.m8.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.8.m8.1d">italic_Q</annotation></semantics></math>, <math alttext="K" class="ltx_Math" display="inline" id="S2.SS1.p4.9.m9.1"><semantics id="S2.SS1.p4.9.m9.1a"><mi id="S2.SS1.p4.9.m9.1.1" xref="S2.SS1.p4.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.9.m9.1b"><ci id="S2.SS1.p4.9.m9.1.1.cmml" xref="S2.SS1.p4.9.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.9.m9.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.9.m9.1d">italic_K</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S2.SS1.p4.10.m10.1"><semantics id="S2.SS1.p4.10.m10.1a"><mi id="S2.SS1.p4.10.m10.1.1" xref="S2.SS1.p4.10.m10.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.10.m10.1b"><ci id="S2.SS1.p4.10.m10.1.1.cmml" xref="S2.SS1.p4.10.m10.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.10.m10.1c">V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.10.m10.1d">italic_V</annotation></semantics></math>. Here <math alttext="h" class="ltx_Math" display="inline" id="S2.SS1.p4.11.m11.1"><semantics id="S2.SS1.p4.11.m11.1a"><mi id="S2.SS1.p4.11.m11.1.1" xref="S2.SS1.p4.11.m11.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.11.m11.1b"><ci id="S2.SS1.p4.11.m11.1.1.cmml" xref="S2.SS1.p4.11.m11.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.11.m11.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.11.m11.1d">italic_h</annotation></semantics></math> is called the <em class="ltx_emph ltx_font_italic" id="S2.SS1.p4.13.1">number of heads</em>. Formally, for positive integers <math alttext="d_{a}" class="ltx_Math" display="inline" id="S2.SS1.p4.12.m12.1"><semantics id="S2.SS1.p4.12.m12.1a"><msub id="S2.SS1.p4.12.m12.1.1" xref="S2.SS1.p4.12.m12.1.1.cmml"><mi id="S2.SS1.p4.12.m12.1.1.2" xref="S2.SS1.p4.12.m12.1.1.2.cmml">d</mi><mi id="S2.SS1.p4.12.m12.1.1.3" xref="S2.SS1.p4.12.m12.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.12.m12.1b"><apply id="S2.SS1.p4.12.m12.1.1.cmml" xref="S2.SS1.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.12.m12.1.1.1.cmml" xref="S2.SS1.p4.12.m12.1.1">subscript</csymbol><ci id="S2.SS1.p4.12.m12.1.1.2.cmml" xref="S2.SS1.p4.12.m12.1.1.2">𝑑</ci><ci id="S2.SS1.p4.12.m12.1.1.3.cmml" xref="S2.SS1.p4.12.m12.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.12.m12.1c">d_{a}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.12.m12.1d">italic_d start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="h" class="ltx_Math" display="inline" id="S2.SS1.p4.13.m13.1"><semantics id="S2.SS1.p4.13.m13.1a"><mi id="S2.SS1.p4.13.m13.1.1" xref="S2.SS1.p4.13.m13.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.13.m13.1b"><ci id="S2.SS1.p4.13.m13.1.1.cmml" xref="S2.SS1.p4.13.m13.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.13.m13.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.13.m13.1d">italic_h</annotation></semantics></math>, the <em class="ltx_emph ltx_font_italic" id="S2.SS1.p4.13.2">multi-head attention layer</em> is defined as</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.Ex1">
<tbody id="S2.Ex1X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\operatorname{MultiHead}(Q,K,V)" class="ltx_Math" display="inline" id="S2.Ex1X.2.1.1.m1.4"><semantics id="S2.Ex1X.2.1.1.m1.4a"><mrow id="S2.Ex1X.2.1.1.m1.4.5.2" xref="S2.Ex1X.2.1.1.m1.4.5.1.cmml"><mi id="S2.Ex1X.2.1.1.m1.1.1" xref="S2.Ex1X.2.1.1.m1.1.1.cmml">MultiHead</mi><mo id="S2.Ex1X.2.1.1.m1.4.5.2a" xref="S2.Ex1X.2.1.1.m1.4.5.1.cmml">⁡</mo><mrow id="S2.Ex1X.2.1.1.m1.4.5.2.1" xref="S2.Ex1X.2.1.1.m1.4.5.1.cmml"><mo id="S2.Ex1X.2.1.1.m1.4.5.2.1.1" stretchy="false" xref="S2.Ex1X.2.1.1.m1.4.5.1.cmml">(</mo><mi id="S2.Ex1X.2.1.1.m1.2.2" xref="S2.Ex1X.2.1.1.m1.2.2.cmml">Q</mi><mo id="S2.Ex1X.2.1.1.m1.4.5.2.1.2" xref="S2.Ex1X.2.1.1.m1.4.5.1.cmml">,</mo><mi id="S2.Ex1X.2.1.1.m1.3.3" xref="S2.Ex1X.2.1.1.m1.3.3.cmml">K</mi><mo id="S2.Ex1X.2.1.1.m1.4.5.2.1.3" xref="S2.Ex1X.2.1.1.m1.4.5.1.cmml">,</mo><mi id="S2.Ex1X.2.1.1.m1.4.4" xref="S2.Ex1X.2.1.1.m1.4.4.cmml">V</mi><mo id="S2.Ex1X.2.1.1.m1.4.5.2.1.4" stretchy="false" xref="S2.Ex1X.2.1.1.m1.4.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1X.2.1.1.m1.4b"><apply id="S2.Ex1X.2.1.1.m1.4.5.1.cmml" xref="S2.Ex1X.2.1.1.m1.4.5.2"><ci id="S2.Ex1X.2.1.1.m1.1.1.cmml" xref="S2.Ex1X.2.1.1.m1.1.1">MultiHead</ci><ci id="S2.Ex1X.2.1.1.m1.2.2.cmml" xref="S2.Ex1X.2.1.1.m1.2.2">𝑄</ci><ci id="S2.Ex1X.2.1.1.m1.3.3.cmml" xref="S2.Ex1X.2.1.1.m1.3.3">𝐾</ci><ci id="S2.Ex1X.2.1.1.m1.4.4.cmml" xref="S2.Ex1X.2.1.1.m1.4.4">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1X.2.1.1.m1.4c">\displaystyle\operatorname{MultiHead}(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1X.2.1.1.m1.4d">roman_MultiHead ( italic_Q , italic_K , italic_V )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Concat}(head_{1},\ldots,head_{h})W^{O}," class="ltx_Math" display="inline" id="S2.Ex1X.3.2.2.m1.3"><semantics id="S2.Ex1X.3.2.2.m1.3a"><mrow id="S2.Ex1X.3.2.2.m1.3.3.1" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.cmml"><mrow id="S2.Ex1X.3.2.2.m1.3.3.1.1" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.cmml"><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.4" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.4.cmml"></mi><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.3" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.Ex1X.3.2.2.m1.3.3.1.1.2" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.cmml"><mrow id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.3.cmml"><mi id="S2.Ex1X.3.2.2.m1.1.1" xref="S2.Ex1X.3.2.2.m1.1.1.cmml">Concat</mi><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2a" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.3.cmml">⁡</mo><mrow id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.3.cmml"><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.3" stretchy="false" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.3.cmml">(</mo><mrow id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml">h</mi><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1a" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.4" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.4.cmml">a</mi><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1b" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.cmml"><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.2" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.2.cmml">d</mi><mn id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.3" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.3.cmml">1</mn></msub></mrow><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.4" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.3.cmml">,</mo><mi id="S2.Ex1X.3.2.2.m1.2.2" mathvariant="normal" xref="S2.Ex1X.3.2.2.m1.2.2.cmml">…</mi><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.5" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.3.cmml">,</mo><mrow id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.2" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.2.cmml">h</mi><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.1" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.3" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.3.cmml">e</mi><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.1a" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.4" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.4.cmml">a</mi><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.1b" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.1.cmml">⁢</mo><msub id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.cmml"><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.2" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.2.cmml">d</mi><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.3" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.3.cmml">h</mi></msub></mrow><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.6" stretchy="false" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.3" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.3.cmml">⁢</mo><msup id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.cmml"><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.2" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.2.cmml">W</mi><mi id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.3" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.3.cmml">O</mi></msup></mrow></mrow><mo id="S2.Ex1X.3.2.2.m1.3.3.1.2" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1X.3.2.2.m1.3b"><apply id="S2.Ex1X.3.2.2.m1.3.3.1.1.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1"><eq id="S2.Ex1X.3.2.2.m1.3.3.1.1.3.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.3"></eq><csymbol cd="latexml" id="S2.Ex1X.3.2.2.m1.3.3.1.1.4.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.4">absent</csymbol><apply id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2"><times id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.3.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.3"></times><apply id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.3.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2"><ci id="S2.Ex1X.3.2.2.m1.1.1.cmml" xref="S2.Ex1X.3.2.2.m1.1.1">Concat</ci><apply id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1"><times id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1"></times><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.4.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.4">𝑎</ci><apply id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.1.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.2.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.2">𝑑</ci><cn id="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.3.cmml" type="integer" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.5.3">1</cn></apply></apply><ci id="S2.Ex1X.3.2.2.m1.2.2.cmml" xref="S2.Ex1X.3.2.2.m1.2.2">…</ci><apply id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2"><times id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.1"></times><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.2">ℎ</ci><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.3">𝑒</ci><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.4.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.4">𝑎</ci><apply id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.1.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5">subscript</csymbol><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.2.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.2">𝑑</ci><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.3.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.2.2.2.2.5.3">ℎ</ci></apply></apply></apply><apply id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.1.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4">superscript</csymbol><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.2.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.2">𝑊</ci><ci id="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.3.cmml" xref="S2.Ex1X.3.2.2.m1.3.3.1.1.2.4.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1X.3.2.2.m1.3c">\displaystyle=\operatorname{Concat}(head_{1},\ldots,head_{h})W^{O},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1X.3.2.2.m1.3d">= roman_Concat ( italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex1Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{where }head_{i}" class="ltx_Math" display="inline" id="S2.Ex1Xa.2.1.1.m1.1"><semantics id="S2.Ex1Xa.2.1.1.m1.1a"><mrow id="S2.Ex1Xa.2.1.1.m1.1.1" xref="S2.Ex1Xa.2.1.1.m1.1.1.cmml"><mtext id="S2.Ex1Xa.2.1.1.m1.1.1.2" xref="S2.Ex1Xa.2.1.1.m1.1.1.2a.cmml">where </mtext><mo id="S2.Ex1Xa.2.1.1.m1.1.1.1" xref="S2.Ex1Xa.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.Ex1Xa.2.1.1.m1.1.1.3" xref="S2.Ex1Xa.2.1.1.m1.1.1.3.cmml">h</mi><mo id="S2.Ex1Xa.2.1.1.m1.1.1.1a" xref="S2.Ex1Xa.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.Ex1Xa.2.1.1.m1.1.1.4" xref="S2.Ex1Xa.2.1.1.m1.1.1.4.cmml">e</mi><mo id="S2.Ex1Xa.2.1.1.m1.1.1.1b" xref="S2.Ex1Xa.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.Ex1Xa.2.1.1.m1.1.1.5" xref="S2.Ex1Xa.2.1.1.m1.1.1.5.cmml">a</mi><mo id="S2.Ex1Xa.2.1.1.m1.1.1.1c" xref="S2.Ex1Xa.2.1.1.m1.1.1.1.cmml">⁢</mo><msub id="S2.Ex1Xa.2.1.1.m1.1.1.6" xref="S2.Ex1Xa.2.1.1.m1.1.1.6.cmml"><mi id="S2.Ex1Xa.2.1.1.m1.1.1.6.2" xref="S2.Ex1Xa.2.1.1.m1.1.1.6.2.cmml">d</mi><mi id="S2.Ex1Xa.2.1.1.m1.1.1.6.3" xref="S2.Ex1Xa.2.1.1.m1.1.1.6.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1Xa.2.1.1.m1.1b"><apply id="S2.Ex1Xa.2.1.1.m1.1.1.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1"><times id="S2.Ex1Xa.2.1.1.m1.1.1.1.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1.1"></times><ci id="S2.Ex1Xa.2.1.1.m1.1.1.2a.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1.2"><mtext id="S2.Ex1Xa.2.1.1.m1.1.1.2.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1.2">where </mtext></ci><ci id="S2.Ex1Xa.2.1.1.m1.1.1.3.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1.3">ℎ</ci><ci id="S2.Ex1Xa.2.1.1.m1.1.1.4.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1.4">𝑒</ci><ci id="S2.Ex1Xa.2.1.1.m1.1.1.5.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1.5">𝑎</ci><apply id="S2.Ex1Xa.2.1.1.m1.1.1.6.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1.6"><csymbol cd="ambiguous" id="S2.Ex1Xa.2.1.1.m1.1.1.6.1.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1.6">subscript</csymbol><ci id="S2.Ex1Xa.2.1.1.m1.1.1.6.2.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1.6.2">𝑑</ci><ci id="S2.Ex1Xa.2.1.1.m1.1.1.6.3.cmml" xref="S2.Ex1Xa.2.1.1.m1.1.1.6.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1Xa.2.1.1.m1.1c">\displaystyle\text{where }head_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1Xa.2.1.1.m1.1d">where italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Attn}(QW_{i}^{Q},KW_{i}^{K},VW_{i}^{V})," class="ltx_Math" display="inline" id="S2.Ex1Xa.3.2.2.m1.2"><semantics id="S2.Ex1Xa.3.2.2.m1.2a"><mrow id="S2.Ex1Xa.3.2.2.m1.2.2.1" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.cmml"><mrow id="S2.Ex1Xa.3.2.2.m1.2.2.1.1" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.cmml"><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.5" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.5.cmml"></mi><mo id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.4" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.4.cmml">=</mo><mrow id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.4.cmml"><mi id="S2.Ex1Xa.3.2.2.m1.1.1" xref="S2.Ex1Xa.3.2.2.m1.1.1.cmml">Attn</mi><mo id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3a" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.4.cmml">⁡</mo><mrow id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.4.cmml"><mo id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.4" stretchy="false" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.4.cmml">(</mo><mrow id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">Q</mi><mo id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml">Q</mi></msubsup></mrow><mo id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.5" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.4.cmml">,</mo><mrow id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.cmml">K</mi><mo id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.1" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.1.cmml">⁢</mo><msubsup id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.2.2" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.2.2.cmml">W</mi><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.2.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.2.3.cmml">i</mi><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.3.cmml">K</mi></msubsup></mrow><mo id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.6" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.4.cmml">,</mo><mrow id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.cmml"><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.2" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.2.cmml">V</mi><mo id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.1" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.1.cmml">⁢</mo><msubsup id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.cmml"><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.2.2" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.2.2.cmml">W</mi><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.2.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.2.3.cmml">i</mi><mi id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.3" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.3.cmml">V</mi></msubsup></mrow><mo id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.7" stretchy="false" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex1Xa.3.2.2.m1.2.2.1.2" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1Xa.3.2.2.m1.2b"><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1"><eq id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.4.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.4"></eq><csymbol cd="latexml" id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.5.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.5">absent</csymbol><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.4.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3"><ci id="S2.Ex1Xa.3.2.2.m1.1.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.1.1">Attn</ci><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1"><times id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1"></times><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2">𝑄</ci><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2"><times id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.1"></times><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2">𝐾</ci><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3">superscript</csymbol><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.2.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3">subscript</csymbol><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.2.2.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.2.2">𝑊</ci><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.2.3.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3.3">𝐾</ci></apply></apply><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3"><times id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.1"></times><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.2">𝑉</ci><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3">superscript</csymbol><apply id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.2.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.2.1.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3">subscript</csymbol><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.2.2.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.2.2">𝑊</ci><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.2.3.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.2.3">𝑖</ci></apply><ci id="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.3.cmml" xref="S2.Ex1Xa.3.2.2.m1.2.2.1.1.3.3.3.3.3.3">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1Xa.3.2.2.m1.2c">\displaystyle=\operatorname{Attn}(QW_{i}^{Q},KW_{i}^{K},VW_{i}^{V}),</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1Xa.3.2.2.m1.2d">= roman_Attn ( italic_Q italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_K italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_V italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p4.23">and the matrices <math alttext="W_{i}^{Q}" class="ltx_Math" display="inline" id="S2.SS1.p4.14.m1.1"><semantics id="S2.SS1.p4.14.m1.1a"><msubsup id="S2.SS1.p4.14.m1.1.1" xref="S2.SS1.p4.14.m1.1.1.cmml"><mi id="S2.SS1.p4.14.m1.1.1.2.2" xref="S2.SS1.p4.14.m1.1.1.2.2.cmml">W</mi><mi id="S2.SS1.p4.14.m1.1.1.2.3" xref="S2.SS1.p4.14.m1.1.1.2.3.cmml">i</mi><mi id="S2.SS1.p4.14.m1.1.1.3" xref="S2.SS1.p4.14.m1.1.1.3.cmml">Q</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.14.m1.1b"><apply id="S2.SS1.p4.14.m1.1.1.cmml" xref="S2.SS1.p4.14.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.14.m1.1.1.1.cmml" xref="S2.SS1.p4.14.m1.1.1">superscript</csymbol><apply id="S2.SS1.p4.14.m1.1.1.2.cmml" xref="S2.SS1.p4.14.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.14.m1.1.1.2.1.cmml" xref="S2.SS1.p4.14.m1.1.1">subscript</csymbol><ci id="S2.SS1.p4.14.m1.1.1.2.2.cmml" xref="S2.SS1.p4.14.m1.1.1.2.2">𝑊</ci><ci id="S2.SS1.p4.14.m1.1.1.2.3.cmml" xref="S2.SS1.p4.14.m1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p4.14.m1.1.1.3.cmml" xref="S2.SS1.p4.14.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.14.m1.1c">W_{i}^{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.14.m1.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="W_{i}^{K}" class="ltx_Math" display="inline" id="S2.SS1.p4.15.m2.1"><semantics id="S2.SS1.p4.15.m2.1a"><msubsup id="S2.SS1.p4.15.m2.1.1" xref="S2.SS1.p4.15.m2.1.1.cmml"><mi id="S2.SS1.p4.15.m2.1.1.2.2" xref="S2.SS1.p4.15.m2.1.1.2.2.cmml">W</mi><mi id="S2.SS1.p4.15.m2.1.1.2.3" xref="S2.SS1.p4.15.m2.1.1.2.3.cmml">i</mi><mi id="S2.SS1.p4.15.m2.1.1.3" xref="S2.SS1.p4.15.m2.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.15.m2.1b"><apply id="S2.SS1.p4.15.m2.1.1.cmml" xref="S2.SS1.p4.15.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.15.m2.1.1.1.cmml" xref="S2.SS1.p4.15.m2.1.1">superscript</csymbol><apply id="S2.SS1.p4.15.m2.1.1.2.cmml" xref="S2.SS1.p4.15.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.15.m2.1.1.2.1.cmml" xref="S2.SS1.p4.15.m2.1.1">subscript</csymbol><ci id="S2.SS1.p4.15.m2.1.1.2.2.cmml" xref="S2.SS1.p4.15.m2.1.1.2.2">𝑊</ci><ci id="S2.SS1.p4.15.m2.1.1.2.3.cmml" xref="S2.SS1.p4.15.m2.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p4.15.m2.1.1.3.cmml" xref="S2.SS1.p4.15.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.15.m2.1c">W_{i}^{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.15.m2.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="W_{i}^{V}" class="ltx_Math" display="inline" id="S2.SS1.p4.16.m3.1"><semantics id="S2.SS1.p4.16.m3.1a"><msubsup id="S2.SS1.p4.16.m3.1.1" xref="S2.SS1.p4.16.m3.1.1.cmml"><mi id="S2.SS1.p4.16.m3.1.1.2.2" xref="S2.SS1.p4.16.m3.1.1.2.2.cmml">W</mi><mi id="S2.SS1.p4.16.m3.1.1.2.3" xref="S2.SS1.p4.16.m3.1.1.2.3.cmml">i</mi><mi id="S2.SS1.p4.16.m3.1.1.3" xref="S2.SS1.p4.16.m3.1.1.3.cmml">V</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.16.m3.1b"><apply id="S2.SS1.p4.16.m3.1.1.cmml" xref="S2.SS1.p4.16.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.16.m3.1.1.1.cmml" xref="S2.SS1.p4.16.m3.1.1">superscript</csymbol><apply id="S2.SS1.p4.16.m3.1.1.2.cmml" xref="S2.SS1.p4.16.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.16.m3.1.1.2.1.cmml" xref="S2.SS1.p4.16.m3.1.1">subscript</csymbol><ci id="S2.SS1.p4.16.m3.1.1.2.2.cmml" xref="S2.SS1.p4.16.m3.1.1.2.2">𝑊</ci><ci id="S2.SS1.p4.16.m3.1.1.2.3.cmml" xref="S2.SS1.p4.16.m3.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p4.16.m3.1.1.3.cmml" xref="S2.SS1.p4.16.m3.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.16.m3.1c">W_{i}^{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.16.m3.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="W_{i}^{O}" class="ltx_Math" display="inline" id="S2.SS1.p4.17.m4.1"><semantics id="S2.SS1.p4.17.m4.1a"><msubsup id="S2.SS1.p4.17.m4.1.1" xref="S2.SS1.p4.17.m4.1.1.cmml"><mi id="S2.SS1.p4.17.m4.1.1.2.2" xref="S2.SS1.p4.17.m4.1.1.2.2.cmml">W</mi><mi id="S2.SS1.p4.17.m4.1.1.2.3" xref="S2.SS1.p4.17.m4.1.1.2.3.cmml">i</mi><mi id="S2.SS1.p4.17.m4.1.1.3" xref="S2.SS1.p4.17.m4.1.1.3.cmml">O</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.17.m4.1b"><apply id="S2.SS1.p4.17.m4.1.1.cmml" xref="S2.SS1.p4.17.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.17.m4.1.1.1.cmml" xref="S2.SS1.p4.17.m4.1.1">superscript</csymbol><apply id="S2.SS1.p4.17.m4.1.1.2.cmml" xref="S2.SS1.p4.17.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.17.m4.1.1.2.1.cmml" xref="S2.SS1.p4.17.m4.1.1">subscript</csymbol><ci id="S2.SS1.p4.17.m4.1.1.2.2.cmml" xref="S2.SS1.p4.17.m4.1.1.2.2">𝑊</ci><ci id="S2.SS1.p4.17.m4.1.1.2.3.cmml" xref="S2.SS1.p4.17.m4.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p4.17.m4.1.1.3.cmml" xref="S2.SS1.p4.17.m4.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.17.m4.1c">W_{i}^{O}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.17.m4.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT</annotation></semantics></math> are parameter matrices of the model with <math alttext="W_{i}^{Q}\in\mathbb{R}^{d_{a}\times d_{q}}" class="ltx_Math" display="inline" id="S2.SS1.p4.18.m5.1"><semantics id="S2.SS1.p4.18.m5.1a"><mrow id="S2.SS1.p4.18.m5.1.1" xref="S2.SS1.p4.18.m5.1.1.cmml"><msubsup id="S2.SS1.p4.18.m5.1.1.2" xref="S2.SS1.p4.18.m5.1.1.2.cmml"><mi id="S2.SS1.p4.18.m5.1.1.2.2.2" xref="S2.SS1.p4.18.m5.1.1.2.2.2.cmml">W</mi><mi id="S2.SS1.p4.18.m5.1.1.2.2.3" xref="S2.SS1.p4.18.m5.1.1.2.2.3.cmml">i</mi><mi id="S2.SS1.p4.18.m5.1.1.2.3" xref="S2.SS1.p4.18.m5.1.1.2.3.cmml">Q</mi></msubsup><mo id="S2.SS1.p4.18.m5.1.1.1" xref="S2.SS1.p4.18.m5.1.1.1.cmml">∈</mo><msup id="S2.SS1.p4.18.m5.1.1.3" xref="S2.SS1.p4.18.m5.1.1.3.cmml"><mi id="S2.SS1.p4.18.m5.1.1.3.2" xref="S2.SS1.p4.18.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p4.18.m5.1.1.3.3" xref="S2.SS1.p4.18.m5.1.1.3.3.cmml"><msub id="S2.SS1.p4.18.m5.1.1.3.3.2" xref="S2.SS1.p4.18.m5.1.1.3.3.2.cmml"><mi id="S2.SS1.p4.18.m5.1.1.3.3.2.2" xref="S2.SS1.p4.18.m5.1.1.3.3.2.2.cmml">d</mi><mi id="S2.SS1.p4.18.m5.1.1.3.3.2.3" xref="S2.SS1.p4.18.m5.1.1.3.3.2.3.cmml">a</mi></msub><mo id="S2.SS1.p4.18.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p4.18.m5.1.1.3.3.1.cmml">×</mo><msub id="S2.SS1.p4.18.m5.1.1.3.3.3" xref="S2.SS1.p4.18.m5.1.1.3.3.3.cmml"><mi id="S2.SS1.p4.18.m5.1.1.3.3.3.2" xref="S2.SS1.p4.18.m5.1.1.3.3.3.2.cmml">d</mi><mi id="S2.SS1.p4.18.m5.1.1.3.3.3.3" xref="S2.SS1.p4.18.m5.1.1.3.3.3.3.cmml">q</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.18.m5.1b"><apply id="S2.SS1.p4.18.m5.1.1.cmml" xref="S2.SS1.p4.18.m5.1.1"><in id="S2.SS1.p4.18.m5.1.1.1.cmml" xref="S2.SS1.p4.18.m5.1.1.1"></in><apply id="S2.SS1.p4.18.m5.1.1.2.cmml" xref="S2.SS1.p4.18.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.18.m5.1.1.2.1.cmml" xref="S2.SS1.p4.18.m5.1.1.2">superscript</csymbol><apply id="S2.SS1.p4.18.m5.1.1.2.2.cmml" xref="S2.SS1.p4.18.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.18.m5.1.1.2.2.1.cmml" xref="S2.SS1.p4.18.m5.1.1.2">subscript</csymbol><ci id="S2.SS1.p4.18.m5.1.1.2.2.2.cmml" xref="S2.SS1.p4.18.m5.1.1.2.2.2">𝑊</ci><ci id="S2.SS1.p4.18.m5.1.1.2.2.3.cmml" xref="S2.SS1.p4.18.m5.1.1.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p4.18.m5.1.1.2.3.cmml" xref="S2.SS1.p4.18.m5.1.1.2.3">𝑄</ci></apply><apply id="S2.SS1.p4.18.m5.1.1.3.cmml" xref="S2.SS1.p4.18.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.18.m5.1.1.3.1.cmml" xref="S2.SS1.p4.18.m5.1.1.3">superscript</csymbol><ci id="S2.SS1.p4.18.m5.1.1.3.2.cmml" xref="S2.SS1.p4.18.m5.1.1.3.2">ℝ</ci><apply id="S2.SS1.p4.18.m5.1.1.3.3.cmml" xref="S2.SS1.p4.18.m5.1.1.3.3"><times id="S2.SS1.p4.18.m5.1.1.3.3.1.cmml" xref="S2.SS1.p4.18.m5.1.1.3.3.1"></times><apply id="S2.SS1.p4.18.m5.1.1.3.3.2.cmml" xref="S2.SS1.p4.18.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.p4.18.m5.1.1.3.3.2.1.cmml" xref="S2.SS1.p4.18.m5.1.1.3.3.2">subscript</csymbol><ci id="S2.SS1.p4.18.m5.1.1.3.3.2.2.cmml" xref="S2.SS1.p4.18.m5.1.1.3.3.2.2">𝑑</ci><ci id="S2.SS1.p4.18.m5.1.1.3.3.2.3.cmml" xref="S2.SS1.p4.18.m5.1.1.3.3.2.3">𝑎</ci></apply><apply id="S2.SS1.p4.18.m5.1.1.3.3.3.cmml" xref="S2.SS1.p4.18.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.18.m5.1.1.3.3.3.1.cmml" xref="S2.SS1.p4.18.m5.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p4.18.m5.1.1.3.3.3.2.cmml" xref="S2.SS1.p4.18.m5.1.1.3.3.3.2">𝑑</ci><ci id="S2.SS1.p4.18.m5.1.1.3.3.3.3.cmml" xref="S2.SS1.p4.18.m5.1.1.3.3.3.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.18.m5.1c">W_{i}^{Q}\in\mathbb{R}^{d_{a}\times d_{q}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.18.m5.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="W_{i}^{K}\in\mathbb{R}^{d_{a}\times d_{q}}" class="ltx_Math" display="inline" id="S2.SS1.p4.19.m6.1"><semantics id="S2.SS1.p4.19.m6.1a"><mrow id="S2.SS1.p4.19.m6.1.1" xref="S2.SS1.p4.19.m6.1.1.cmml"><msubsup id="S2.SS1.p4.19.m6.1.1.2" xref="S2.SS1.p4.19.m6.1.1.2.cmml"><mi id="S2.SS1.p4.19.m6.1.1.2.2.2" xref="S2.SS1.p4.19.m6.1.1.2.2.2.cmml">W</mi><mi id="S2.SS1.p4.19.m6.1.1.2.2.3" xref="S2.SS1.p4.19.m6.1.1.2.2.3.cmml">i</mi><mi id="S2.SS1.p4.19.m6.1.1.2.3" xref="S2.SS1.p4.19.m6.1.1.2.3.cmml">K</mi></msubsup><mo id="S2.SS1.p4.19.m6.1.1.1" xref="S2.SS1.p4.19.m6.1.1.1.cmml">∈</mo><msup id="S2.SS1.p4.19.m6.1.1.3" xref="S2.SS1.p4.19.m6.1.1.3.cmml"><mi id="S2.SS1.p4.19.m6.1.1.3.2" xref="S2.SS1.p4.19.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p4.19.m6.1.1.3.3" xref="S2.SS1.p4.19.m6.1.1.3.3.cmml"><msub id="S2.SS1.p4.19.m6.1.1.3.3.2" xref="S2.SS1.p4.19.m6.1.1.3.3.2.cmml"><mi id="S2.SS1.p4.19.m6.1.1.3.3.2.2" xref="S2.SS1.p4.19.m6.1.1.3.3.2.2.cmml">d</mi><mi id="S2.SS1.p4.19.m6.1.1.3.3.2.3" xref="S2.SS1.p4.19.m6.1.1.3.3.2.3.cmml">a</mi></msub><mo id="S2.SS1.p4.19.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p4.19.m6.1.1.3.3.1.cmml">×</mo><msub id="S2.SS1.p4.19.m6.1.1.3.3.3" xref="S2.SS1.p4.19.m6.1.1.3.3.3.cmml"><mi id="S2.SS1.p4.19.m6.1.1.3.3.3.2" xref="S2.SS1.p4.19.m6.1.1.3.3.3.2.cmml">d</mi><mi id="S2.SS1.p4.19.m6.1.1.3.3.3.3" xref="S2.SS1.p4.19.m6.1.1.3.3.3.3.cmml">q</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.19.m6.1b"><apply id="S2.SS1.p4.19.m6.1.1.cmml" xref="S2.SS1.p4.19.m6.1.1"><in id="S2.SS1.p4.19.m6.1.1.1.cmml" xref="S2.SS1.p4.19.m6.1.1.1"></in><apply id="S2.SS1.p4.19.m6.1.1.2.cmml" xref="S2.SS1.p4.19.m6.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.19.m6.1.1.2.1.cmml" xref="S2.SS1.p4.19.m6.1.1.2">superscript</csymbol><apply id="S2.SS1.p4.19.m6.1.1.2.2.cmml" xref="S2.SS1.p4.19.m6.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.19.m6.1.1.2.2.1.cmml" xref="S2.SS1.p4.19.m6.1.1.2">subscript</csymbol><ci id="S2.SS1.p4.19.m6.1.1.2.2.2.cmml" xref="S2.SS1.p4.19.m6.1.1.2.2.2">𝑊</ci><ci id="S2.SS1.p4.19.m6.1.1.2.2.3.cmml" xref="S2.SS1.p4.19.m6.1.1.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p4.19.m6.1.1.2.3.cmml" xref="S2.SS1.p4.19.m6.1.1.2.3">𝐾</ci></apply><apply id="S2.SS1.p4.19.m6.1.1.3.cmml" xref="S2.SS1.p4.19.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.19.m6.1.1.3.1.cmml" xref="S2.SS1.p4.19.m6.1.1.3">superscript</csymbol><ci id="S2.SS1.p4.19.m6.1.1.3.2.cmml" xref="S2.SS1.p4.19.m6.1.1.3.2">ℝ</ci><apply id="S2.SS1.p4.19.m6.1.1.3.3.cmml" xref="S2.SS1.p4.19.m6.1.1.3.3"><times id="S2.SS1.p4.19.m6.1.1.3.3.1.cmml" xref="S2.SS1.p4.19.m6.1.1.3.3.1"></times><apply id="S2.SS1.p4.19.m6.1.1.3.3.2.cmml" xref="S2.SS1.p4.19.m6.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.p4.19.m6.1.1.3.3.2.1.cmml" xref="S2.SS1.p4.19.m6.1.1.3.3.2">subscript</csymbol><ci id="S2.SS1.p4.19.m6.1.1.3.3.2.2.cmml" xref="S2.SS1.p4.19.m6.1.1.3.3.2.2">𝑑</ci><ci id="S2.SS1.p4.19.m6.1.1.3.3.2.3.cmml" xref="S2.SS1.p4.19.m6.1.1.3.3.2.3">𝑎</ci></apply><apply id="S2.SS1.p4.19.m6.1.1.3.3.3.cmml" xref="S2.SS1.p4.19.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.19.m6.1.1.3.3.3.1.cmml" xref="S2.SS1.p4.19.m6.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p4.19.m6.1.1.3.3.3.2.cmml" xref="S2.SS1.p4.19.m6.1.1.3.3.3.2">𝑑</ci><ci id="S2.SS1.p4.19.m6.1.1.3.3.3.3.cmml" xref="S2.SS1.p4.19.m6.1.1.3.3.3.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.19.m6.1c">W_{i}^{K}\in\mathbb{R}^{d_{a}\times d_{q}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.19.m6.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="W_{i}^{V}\in\mathbb{R}^{d_{a}\times d_{v}}" class="ltx_Math" display="inline" id="S2.SS1.p4.20.m7.1"><semantics id="S2.SS1.p4.20.m7.1a"><mrow id="S2.SS1.p4.20.m7.1.1" xref="S2.SS1.p4.20.m7.1.1.cmml"><msubsup id="S2.SS1.p4.20.m7.1.1.2" xref="S2.SS1.p4.20.m7.1.1.2.cmml"><mi id="S2.SS1.p4.20.m7.1.1.2.2.2" xref="S2.SS1.p4.20.m7.1.1.2.2.2.cmml">W</mi><mi id="S2.SS1.p4.20.m7.1.1.2.2.3" xref="S2.SS1.p4.20.m7.1.1.2.2.3.cmml">i</mi><mi id="S2.SS1.p4.20.m7.1.1.2.3" xref="S2.SS1.p4.20.m7.1.1.2.3.cmml">V</mi></msubsup><mo id="S2.SS1.p4.20.m7.1.1.1" xref="S2.SS1.p4.20.m7.1.1.1.cmml">∈</mo><msup id="S2.SS1.p4.20.m7.1.1.3" xref="S2.SS1.p4.20.m7.1.1.3.cmml"><mi id="S2.SS1.p4.20.m7.1.1.3.2" xref="S2.SS1.p4.20.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p4.20.m7.1.1.3.3" xref="S2.SS1.p4.20.m7.1.1.3.3.cmml"><msub id="S2.SS1.p4.20.m7.1.1.3.3.2" xref="S2.SS1.p4.20.m7.1.1.3.3.2.cmml"><mi id="S2.SS1.p4.20.m7.1.1.3.3.2.2" xref="S2.SS1.p4.20.m7.1.1.3.3.2.2.cmml">d</mi><mi id="S2.SS1.p4.20.m7.1.1.3.3.2.3" xref="S2.SS1.p4.20.m7.1.1.3.3.2.3.cmml">a</mi></msub><mo id="S2.SS1.p4.20.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p4.20.m7.1.1.3.3.1.cmml">×</mo><msub id="S2.SS1.p4.20.m7.1.1.3.3.3" xref="S2.SS1.p4.20.m7.1.1.3.3.3.cmml"><mi id="S2.SS1.p4.20.m7.1.1.3.3.3.2" xref="S2.SS1.p4.20.m7.1.1.3.3.3.2.cmml">d</mi><mi id="S2.SS1.p4.20.m7.1.1.3.3.3.3" xref="S2.SS1.p4.20.m7.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.20.m7.1b"><apply id="S2.SS1.p4.20.m7.1.1.cmml" xref="S2.SS1.p4.20.m7.1.1"><in id="S2.SS1.p4.20.m7.1.1.1.cmml" xref="S2.SS1.p4.20.m7.1.1.1"></in><apply id="S2.SS1.p4.20.m7.1.1.2.cmml" xref="S2.SS1.p4.20.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.20.m7.1.1.2.1.cmml" xref="S2.SS1.p4.20.m7.1.1.2">superscript</csymbol><apply id="S2.SS1.p4.20.m7.1.1.2.2.cmml" xref="S2.SS1.p4.20.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.20.m7.1.1.2.2.1.cmml" xref="S2.SS1.p4.20.m7.1.1.2">subscript</csymbol><ci id="S2.SS1.p4.20.m7.1.1.2.2.2.cmml" xref="S2.SS1.p4.20.m7.1.1.2.2.2">𝑊</ci><ci id="S2.SS1.p4.20.m7.1.1.2.2.3.cmml" xref="S2.SS1.p4.20.m7.1.1.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p4.20.m7.1.1.2.3.cmml" xref="S2.SS1.p4.20.m7.1.1.2.3">𝑉</ci></apply><apply id="S2.SS1.p4.20.m7.1.1.3.cmml" xref="S2.SS1.p4.20.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.20.m7.1.1.3.1.cmml" xref="S2.SS1.p4.20.m7.1.1.3">superscript</csymbol><ci id="S2.SS1.p4.20.m7.1.1.3.2.cmml" xref="S2.SS1.p4.20.m7.1.1.3.2">ℝ</ci><apply id="S2.SS1.p4.20.m7.1.1.3.3.cmml" xref="S2.SS1.p4.20.m7.1.1.3.3"><times id="S2.SS1.p4.20.m7.1.1.3.3.1.cmml" xref="S2.SS1.p4.20.m7.1.1.3.3.1"></times><apply id="S2.SS1.p4.20.m7.1.1.3.3.2.cmml" xref="S2.SS1.p4.20.m7.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.p4.20.m7.1.1.3.3.2.1.cmml" xref="S2.SS1.p4.20.m7.1.1.3.3.2">subscript</csymbol><ci id="S2.SS1.p4.20.m7.1.1.3.3.2.2.cmml" xref="S2.SS1.p4.20.m7.1.1.3.3.2.2">𝑑</ci><ci id="S2.SS1.p4.20.m7.1.1.3.3.2.3.cmml" xref="S2.SS1.p4.20.m7.1.1.3.3.2.3">𝑎</ci></apply><apply id="S2.SS1.p4.20.m7.1.1.3.3.3.cmml" xref="S2.SS1.p4.20.m7.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.20.m7.1.1.3.3.3.1.cmml" xref="S2.SS1.p4.20.m7.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p4.20.m7.1.1.3.3.3.2.cmml" xref="S2.SS1.p4.20.m7.1.1.3.3.3.2">𝑑</ci><ci id="S2.SS1.p4.20.m7.1.1.3.3.3.3.cmml" xref="S2.SS1.p4.20.m7.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.20.m7.1c">W_{i}^{V}\in\mathbb{R}^{d_{a}\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.20.m7.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="W_{i}^{O}\in\mathbb{R}^{hd_{a}\times d_{v}}" class="ltx_Math" display="inline" id="S2.SS1.p4.21.m8.1"><semantics id="S2.SS1.p4.21.m8.1a"><mrow id="S2.SS1.p4.21.m8.1.1" xref="S2.SS1.p4.21.m8.1.1.cmml"><msubsup id="S2.SS1.p4.21.m8.1.1.2" xref="S2.SS1.p4.21.m8.1.1.2.cmml"><mi id="S2.SS1.p4.21.m8.1.1.2.2.2" xref="S2.SS1.p4.21.m8.1.1.2.2.2.cmml">W</mi><mi id="S2.SS1.p4.21.m8.1.1.2.2.3" xref="S2.SS1.p4.21.m8.1.1.2.2.3.cmml">i</mi><mi id="S2.SS1.p4.21.m8.1.1.2.3" xref="S2.SS1.p4.21.m8.1.1.2.3.cmml">O</mi></msubsup><mo id="S2.SS1.p4.21.m8.1.1.1" xref="S2.SS1.p4.21.m8.1.1.1.cmml">∈</mo><msup id="S2.SS1.p4.21.m8.1.1.3" xref="S2.SS1.p4.21.m8.1.1.3.cmml"><mi id="S2.SS1.p4.21.m8.1.1.3.2" xref="S2.SS1.p4.21.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p4.21.m8.1.1.3.3" xref="S2.SS1.p4.21.m8.1.1.3.3.cmml"><mrow id="S2.SS1.p4.21.m8.1.1.3.3.2" xref="S2.SS1.p4.21.m8.1.1.3.3.2.cmml"><mi id="S2.SS1.p4.21.m8.1.1.3.3.2.2" xref="S2.SS1.p4.21.m8.1.1.3.3.2.2.cmml">h</mi><mo id="S2.SS1.p4.21.m8.1.1.3.3.2.1" xref="S2.SS1.p4.21.m8.1.1.3.3.2.1.cmml">⁢</mo><msub id="S2.SS1.p4.21.m8.1.1.3.3.2.3" xref="S2.SS1.p4.21.m8.1.1.3.3.2.3.cmml"><mi id="S2.SS1.p4.21.m8.1.1.3.3.2.3.2" xref="S2.SS1.p4.21.m8.1.1.3.3.2.3.2.cmml">d</mi><mi id="S2.SS1.p4.21.m8.1.1.3.3.2.3.3" xref="S2.SS1.p4.21.m8.1.1.3.3.2.3.3.cmml">a</mi></msub></mrow><mo id="S2.SS1.p4.21.m8.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p4.21.m8.1.1.3.3.1.cmml">×</mo><msub id="S2.SS1.p4.21.m8.1.1.3.3.3" xref="S2.SS1.p4.21.m8.1.1.3.3.3.cmml"><mi id="S2.SS1.p4.21.m8.1.1.3.3.3.2" xref="S2.SS1.p4.21.m8.1.1.3.3.3.2.cmml">d</mi><mi id="S2.SS1.p4.21.m8.1.1.3.3.3.3" xref="S2.SS1.p4.21.m8.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.21.m8.1b"><apply id="S2.SS1.p4.21.m8.1.1.cmml" xref="S2.SS1.p4.21.m8.1.1"><in id="S2.SS1.p4.21.m8.1.1.1.cmml" xref="S2.SS1.p4.21.m8.1.1.1"></in><apply id="S2.SS1.p4.21.m8.1.1.2.cmml" xref="S2.SS1.p4.21.m8.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.21.m8.1.1.2.1.cmml" xref="S2.SS1.p4.21.m8.1.1.2">superscript</csymbol><apply id="S2.SS1.p4.21.m8.1.1.2.2.cmml" xref="S2.SS1.p4.21.m8.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.21.m8.1.1.2.2.1.cmml" xref="S2.SS1.p4.21.m8.1.1.2">subscript</csymbol><ci id="S2.SS1.p4.21.m8.1.1.2.2.2.cmml" xref="S2.SS1.p4.21.m8.1.1.2.2.2">𝑊</ci><ci id="S2.SS1.p4.21.m8.1.1.2.2.3.cmml" xref="S2.SS1.p4.21.m8.1.1.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p4.21.m8.1.1.2.3.cmml" xref="S2.SS1.p4.21.m8.1.1.2.3">𝑂</ci></apply><apply id="S2.SS1.p4.21.m8.1.1.3.cmml" xref="S2.SS1.p4.21.m8.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.21.m8.1.1.3.1.cmml" xref="S2.SS1.p4.21.m8.1.1.3">superscript</csymbol><ci id="S2.SS1.p4.21.m8.1.1.3.2.cmml" xref="S2.SS1.p4.21.m8.1.1.3.2">ℝ</ci><apply id="S2.SS1.p4.21.m8.1.1.3.3.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3"><times id="S2.SS1.p4.21.m8.1.1.3.3.1.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.1"></times><apply id="S2.SS1.p4.21.m8.1.1.3.3.2.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.2"><times id="S2.SS1.p4.21.m8.1.1.3.3.2.1.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.2.1"></times><ci id="S2.SS1.p4.21.m8.1.1.3.3.2.2.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.2.2">ℎ</ci><apply id="S2.SS1.p4.21.m8.1.1.3.3.2.3.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p4.21.m8.1.1.3.3.2.3.1.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.2.3">subscript</csymbol><ci id="S2.SS1.p4.21.m8.1.1.3.3.2.3.2.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.2.3.2">𝑑</ci><ci id="S2.SS1.p4.21.m8.1.1.3.3.2.3.3.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.2.3.3">𝑎</ci></apply></apply><apply id="S2.SS1.p4.21.m8.1.1.3.3.3.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.21.m8.1.1.3.3.3.1.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p4.21.m8.1.1.3.3.3.2.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.3.2">𝑑</ci><ci id="S2.SS1.p4.21.m8.1.1.3.3.3.3.cmml" xref="S2.SS1.p4.21.m8.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.21.m8.1c">W_{i}^{O}\in\mathbb{R}^{hd_{a}\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.21.m8.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_h italic_d start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Here the <math alttext="\operatorname{Concat}" class="ltx_Math" display="inline" id="S2.SS1.p4.22.m9.1"><semantics id="S2.SS1.p4.22.m9.1a"><mi id="S2.SS1.p4.22.m9.1.1" xref="S2.SS1.p4.22.m9.1.1.cmml">Concat</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.22.m9.1b"><ci id="S2.SS1.p4.22.m9.1.1.cmml" xref="S2.SS1.p4.22.m9.1.1">Concat</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.22.m9.1c">\operatorname{Concat}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.22.m9.1d">roman_Concat</annotation></semantics></math> operator concatenates tensors <math alttext="head_{1},head_{2},\ldots,head_{h}" class="ltx_Math" display="inline" id="S2.SS1.p4.23.m10.4"><semantics id="S2.SS1.p4.23.m10.4a"><mrow id="S2.SS1.p4.23.m10.4.4.3" xref="S2.SS1.p4.23.m10.4.4.4.cmml"><mrow id="S2.SS1.p4.23.m10.2.2.1.1" xref="S2.SS1.p4.23.m10.2.2.1.1.cmml"><mi id="S2.SS1.p4.23.m10.2.2.1.1.2" xref="S2.SS1.p4.23.m10.2.2.1.1.2.cmml">h</mi><mo id="S2.SS1.p4.23.m10.2.2.1.1.1" xref="S2.SS1.p4.23.m10.2.2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.23.m10.2.2.1.1.3" xref="S2.SS1.p4.23.m10.2.2.1.1.3.cmml">e</mi><mo id="S2.SS1.p4.23.m10.2.2.1.1.1a" xref="S2.SS1.p4.23.m10.2.2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.23.m10.2.2.1.1.4" xref="S2.SS1.p4.23.m10.2.2.1.1.4.cmml">a</mi><mo id="S2.SS1.p4.23.m10.2.2.1.1.1b" xref="S2.SS1.p4.23.m10.2.2.1.1.1.cmml">⁢</mo><msub id="S2.SS1.p4.23.m10.2.2.1.1.5" xref="S2.SS1.p4.23.m10.2.2.1.1.5.cmml"><mi id="S2.SS1.p4.23.m10.2.2.1.1.5.2" xref="S2.SS1.p4.23.m10.2.2.1.1.5.2.cmml">d</mi><mn id="S2.SS1.p4.23.m10.2.2.1.1.5.3" xref="S2.SS1.p4.23.m10.2.2.1.1.5.3.cmml">1</mn></msub></mrow><mo id="S2.SS1.p4.23.m10.4.4.3.4" xref="S2.SS1.p4.23.m10.4.4.4.cmml">,</mo><mrow id="S2.SS1.p4.23.m10.3.3.2.2" xref="S2.SS1.p4.23.m10.3.3.2.2.cmml"><mi id="S2.SS1.p4.23.m10.3.3.2.2.2" xref="S2.SS1.p4.23.m10.3.3.2.2.2.cmml">h</mi><mo id="S2.SS1.p4.23.m10.3.3.2.2.1" xref="S2.SS1.p4.23.m10.3.3.2.2.1.cmml">⁢</mo><mi id="S2.SS1.p4.23.m10.3.3.2.2.3" xref="S2.SS1.p4.23.m10.3.3.2.2.3.cmml">e</mi><mo id="S2.SS1.p4.23.m10.3.3.2.2.1a" xref="S2.SS1.p4.23.m10.3.3.2.2.1.cmml">⁢</mo><mi id="S2.SS1.p4.23.m10.3.3.2.2.4" xref="S2.SS1.p4.23.m10.3.3.2.2.4.cmml">a</mi><mo id="S2.SS1.p4.23.m10.3.3.2.2.1b" xref="S2.SS1.p4.23.m10.3.3.2.2.1.cmml">⁢</mo><msub id="S2.SS1.p4.23.m10.3.3.2.2.5" xref="S2.SS1.p4.23.m10.3.3.2.2.5.cmml"><mi id="S2.SS1.p4.23.m10.3.3.2.2.5.2" xref="S2.SS1.p4.23.m10.3.3.2.2.5.2.cmml">d</mi><mn id="S2.SS1.p4.23.m10.3.3.2.2.5.3" xref="S2.SS1.p4.23.m10.3.3.2.2.5.3.cmml">2</mn></msub></mrow><mo id="S2.SS1.p4.23.m10.4.4.3.5" xref="S2.SS1.p4.23.m10.4.4.4.cmml">,</mo><mi id="S2.SS1.p4.23.m10.1.1" mathvariant="normal" xref="S2.SS1.p4.23.m10.1.1.cmml">…</mi><mo id="S2.SS1.p4.23.m10.4.4.3.6" xref="S2.SS1.p4.23.m10.4.4.4.cmml">,</mo><mrow id="S2.SS1.p4.23.m10.4.4.3.3" xref="S2.SS1.p4.23.m10.4.4.3.3.cmml"><mi id="S2.SS1.p4.23.m10.4.4.3.3.2" xref="S2.SS1.p4.23.m10.4.4.3.3.2.cmml">h</mi><mo id="S2.SS1.p4.23.m10.4.4.3.3.1" xref="S2.SS1.p4.23.m10.4.4.3.3.1.cmml">⁢</mo><mi id="S2.SS1.p4.23.m10.4.4.3.3.3" xref="S2.SS1.p4.23.m10.4.4.3.3.3.cmml">e</mi><mo id="S2.SS1.p4.23.m10.4.4.3.3.1a" xref="S2.SS1.p4.23.m10.4.4.3.3.1.cmml">⁢</mo><mi id="S2.SS1.p4.23.m10.4.4.3.3.4" xref="S2.SS1.p4.23.m10.4.4.3.3.4.cmml">a</mi><mo id="S2.SS1.p4.23.m10.4.4.3.3.1b" xref="S2.SS1.p4.23.m10.4.4.3.3.1.cmml">⁢</mo><msub id="S2.SS1.p4.23.m10.4.4.3.3.5" xref="S2.SS1.p4.23.m10.4.4.3.3.5.cmml"><mi id="S2.SS1.p4.23.m10.4.4.3.3.5.2" xref="S2.SS1.p4.23.m10.4.4.3.3.5.2.cmml">d</mi><mi id="S2.SS1.p4.23.m10.4.4.3.3.5.3" xref="S2.SS1.p4.23.m10.4.4.3.3.5.3.cmml">h</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.23.m10.4b"><list id="S2.SS1.p4.23.m10.4.4.4.cmml" xref="S2.SS1.p4.23.m10.4.4.3"><apply id="S2.SS1.p4.23.m10.2.2.1.1.cmml" xref="S2.SS1.p4.23.m10.2.2.1.1"><times id="S2.SS1.p4.23.m10.2.2.1.1.1.cmml" xref="S2.SS1.p4.23.m10.2.2.1.1.1"></times><ci id="S2.SS1.p4.23.m10.2.2.1.1.2.cmml" xref="S2.SS1.p4.23.m10.2.2.1.1.2">ℎ</ci><ci id="S2.SS1.p4.23.m10.2.2.1.1.3.cmml" xref="S2.SS1.p4.23.m10.2.2.1.1.3">𝑒</ci><ci id="S2.SS1.p4.23.m10.2.2.1.1.4.cmml" xref="S2.SS1.p4.23.m10.2.2.1.1.4">𝑎</ci><apply id="S2.SS1.p4.23.m10.2.2.1.1.5.cmml" xref="S2.SS1.p4.23.m10.2.2.1.1.5"><csymbol cd="ambiguous" id="S2.SS1.p4.23.m10.2.2.1.1.5.1.cmml" xref="S2.SS1.p4.23.m10.2.2.1.1.5">subscript</csymbol><ci id="S2.SS1.p4.23.m10.2.2.1.1.5.2.cmml" xref="S2.SS1.p4.23.m10.2.2.1.1.5.2">𝑑</ci><cn id="S2.SS1.p4.23.m10.2.2.1.1.5.3.cmml" type="integer" xref="S2.SS1.p4.23.m10.2.2.1.1.5.3">1</cn></apply></apply><apply id="S2.SS1.p4.23.m10.3.3.2.2.cmml" xref="S2.SS1.p4.23.m10.3.3.2.2"><times id="S2.SS1.p4.23.m10.3.3.2.2.1.cmml" xref="S2.SS1.p4.23.m10.3.3.2.2.1"></times><ci id="S2.SS1.p4.23.m10.3.3.2.2.2.cmml" xref="S2.SS1.p4.23.m10.3.3.2.2.2">ℎ</ci><ci id="S2.SS1.p4.23.m10.3.3.2.2.3.cmml" xref="S2.SS1.p4.23.m10.3.3.2.2.3">𝑒</ci><ci id="S2.SS1.p4.23.m10.3.3.2.2.4.cmml" xref="S2.SS1.p4.23.m10.3.3.2.2.4">𝑎</ci><apply id="S2.SS1.p4.23.m10.3.3.2.2.5.cmml" xref="S2.SS1.p4.23.m10.3.3.2.2.5"><csymbol cd="ambiguous" id="S2.SS1.p4.23.m10.3.3.2.2.5.1.cmml" xref="S2.SS1.p4.23.m10.3.3.2.2.5">subscript</csymbol><ci id="S2.SS1.p4.23.m10.3.3.2.2.5.2.cmml" xref="S2.SS1.p4.23.m10.3.3.2.2.5.2">𝑑</ci><cn id="S2.SS1.p4.23.m10.3.3.2.2.5.3.cmml" type="integer" xref="S2.SS1.p4.23.m10.3.3.2.2.5.3">2</cn></apply></apply><ci id="S2.SS1.p4.23.m10.1.1.cmml" xref="S2.SS1.p4.23.m10.1.1">…</ci><apply id="S2.SS1.p4.23.m10.4.4.3.3.cmml" xref="S2.SS1.p4.23.m10.4.4.3.3"><times id="S2.SS1.p4.23.m10.4.4.3.3.1.cmml" xref="S2.SS1.p4.23.m10.4.4.3.3.1"></times><ci id="S2.SS1.p4.23.m10.4.4.3.3.2.cmml" xref="S2.SS1.p4.23.m10.4.4.3.3.2">ℎ</ci><ci id="S2.SS1.p4.23.m10.4.4.3.3.3.cmml" xref="S2.SS1.p4.23.m10.4.4.3.3.3">𝑒</ci><ci id="S2.SS1.p4.23.m10.4.4.3.3.4.cmml" xref="S2.SS1.p4.23.m10.4.4.3.3.4">𝑎</ci><apply id="S2.SS1.p4.23.m10.4.4.3.3.5.cmml" xref="S2.SS1.p4.23.m10.4.4.3.3.5"><csymbol cd="ambiguous" id="S2.SS1.p4.23.m10.4.4.3.3.5.1.cmml" xref="S2.SS1.p4.23.m10.4.4.3.3.5">subscript</csymbol><ci id="S2.SS1.p4.23.m10.4.4.3.3.5.2.cmml" xref="S2.SS1.p4.23.m10.4.4.3.3.5.2">𝑑</ci><ci id="S2.SS1.p4.23.m10.4.4.3.3.5.3.cmml" xref="S2.SS1.p4.23.m10.4.4.3.3.5.3">ℎ</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.23.m10.4c">head_{1},head_{2},\ldots,head_{h}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.23.m10.4d">italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> on the last dimension.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.7">One usually picks <math alttext="h" class="ltx_Math" display="inline" id="S2.SS1.p5.1.m1.1"><semantics id="S2.SS1.p5.1.m1.1a"><mi id="S2.SS1.p5.1.m1.1.1" xref="S2.SS1.p5.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.1.m1.1b"><ci id="S2.SS1.p5.1.m1.1.1.cmml" xref="S2.SS1.p5.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.1.m1.1d">italic_h</annotation></semantics></math> and <math alttext="d_{a}" class="ltx_Math" display="inline" id="S2.SS1.p5.2.m2.1"><semantics id="S2.SS1.p5.2.m2.1a"><msub id="S2.SS1.p5.2.m2.1.1" xref="S2.SS1.p5.2.m2.1.1.cmml"><mi id="S2.SS1.p5.2.m2.1.1.2" xref="S2.SS1.p5.2.m2.1.1.2.cmml">d</mi><mi id="S2.SS1.p5.2.m2.1.1.3" xref="S2.SS1.p5.2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.2.m2.1b"><apply id="S2.SS1.p5.2.m2.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.2.m2.1.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p5.2.m2.1.1.2.cmml" xref="S2.SS1.p5.2.m2.1.1.2">𝑑</ci><ci id="S2.SS1.p5.2.m2.1.1.3.cmml" xref="S2.SS1.p5.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.2.m2.1c">d_{a}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="hd_{a}=d_{v}" class="ltx_Math" display="inline" id="S2.SS1.p5.3.m3.1"><semantics id="S2.SS1.p5.3.m3.1a"><mrow id="S2.SS1.p5.3.m3.1.1" xref="S2.SS1.p5.3.m3.1.1.cmml"><mrow id="S2.SS1.p5.3.m3.1.1.2" xref="S2.SS1.p5.3.m3.1.1.2.cmml"><mi id="S2.SS1.p5.3.m3.1.1.2.2" xref="S2.SS1.p5.3.m3.1.1.2.2.cmml">h</mi><mo id="S2.SS1.p5.3.m3.1.1.2.1" xref="S2.SS1.p5.3.m3.1.1.2.1.cmml">⁢</mo><msub id="S2.SS1.p5.3.m3.1.1.2.3" xref="S2.SS1.p5.3.m3.1.1.2.3.cmml"><mi id="S2.SS1.p5.3.m3.1.1.2.3.2" xref="S2.SS1.p5.3.m3.1.1.2.3.2.cmml">d</mi><mi id="S2.SS1.p5.3.m3.1.1.2.3.3" xref="S2.SS1.p5.3.m3.1.1.2.3.3.cmml">a</mi></msub></mrow><mo id="S2.SS1.p5.3.m3.1.1.1" xref="S2.SS1.p5.3.m3.1.1.1.cmml">=</mo><msub id="S2.SS1.p5.3.m3.1.1.3" xref="S2.SS1.p5.3.m3.1.1.3.cmml"><mi id="S2.SS1.p5.3.m3.1.1.3.2" xref="S2.SS1.p5.3.m3.1.1.3.2.cmml">d</mi><mi id="S2.SS1.p5.3.m3.1.1.3.3" xref="S2.SS1.p5.3.m3.1.1.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.3.m3.1b"><apply id="S2.SS1.p5.3.m3.1.1.cmml" xref="S2.SS1.p5.3.m3.1.1"><eq id="S2.SS1.p5.3.m3.1.1.1.cmml" xref="S2.SS1.p5.3.m3.1.1.1"></eq><apply id="S2.SS1.p5.3.m3.1.1.2.cmml" xref="S2.SS1.p5.3.m3.1.1.2"><times id="S2.SS1.p5.3.m3.1.1.2.1.cmml" xref="S2.SS1.p5.3.m3.1.1.2.1"></times><ci id="S2.SS1.p5.3.m3.1.1.2.2.cmml" xref="S2.SS1.p5.3.m3.1.1.2.2">ℎ</ci><apply id="S2.SS1.p5.3.m3.1.1.2.3.cmml" xref="S2.SS1.p5.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p5.3.m3.1.1.2.3.1.cmml" xref="S2.SS1.p5.3.m3.1.1.2.3">subscript</csymbol><ci id="S2.SS1.p5.3.m3.1.1.2.3.2.cmml" xref="S2.SS1.p5.3.m3.1.1.2.3.2">𝑑</ci><ci id="S2.SS1.p5.3.m3.1.1.2.3.3.cmml" xref="S2.SS1.p5.3.m3.1.1.2.3.3">𝑎</ci></apply></apply><apply id="S2.SS1.p5.3.m3.1.1.3.cmml" xref="S2.SS1.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p5.3.m3.1.1.3.1.cmml" xref="S2.SS1.p5.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS1.p5.3.m3.1.1.3.2.cmml" xref="S2.SS1.p5.3.m3.1.1.3.2">𝑑</ci><ci id="S2.SS1.p5.3.m3.1.1.3.3.cmml" xref="S2.SS1.p5.3.m3.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.3.m3.1c">hd_{a}=d_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.3.m3.1d">italic_h italic_d start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>. In the time series literature <math alttext="h" class="ltx_Math" display="inline" id="S2.SS1.p5.4.m4.1"><semantics id="S2.SS1.p5.4.m4.1a"><mi id="S2.SS1.p5.4.m4.1.1" xref="S2.SS1.p5.4.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.4.m4.1b"><ci id="S2.SS1.p5.4.m4.1.1.cmml" xref="S2.SS1.p5.4.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.4.m4.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.4.m4.1d">italic_h</annotation></semantics></math> is typically set to the number of variables in the model, so <math alttext="d_{a}=1" class="ltx_Math" display="inline" id="S2.SS1.p5.5.m5.1"><semantics id="S2.SS1.p5.5.m5.1a"><mrow id="S2.SS1.p5.5.m5.1.1" xref="S2.SS1.p5.5.m5.1.1.cmml"><msub id="S2.SS1.p5.5.m5.1.1.2" xref="S2.SS1.p5.5.m5.1.1.2.cmml"><mi id="S2.SS1.p5.5.m5.1.1.2.2" xref="S2.SS1.p5.5.m5.1.1.2.2.cmml">d</mi><mi id="S2.SS1.p5.5.m5.1.1.2.3" xref="S2.SS1.p5.5.m5.1.1.2.3.cmml">a</mi></msub><mo id="S2.SS1.p5.5.m5.1.1.1" xref="S2.SS1.p5.5.m5.1.1.1.cmml">=</mo><mn id="S2.SS1.p5.5.m5.1.1.3" xref="S2.SS1.p5.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.5.m5.1b"><apply id="S2.SS1.p5.5.m5.1.1.cmml" xref="S2.SS1.p5.5.m5.1.1"><eq id="S2.SS1.p5.5.m5.1.1.1.cmml" xref="S2.SS1.p5.5.m5.1.1.1"></eq><apply id="S2.SS1.p5.5.m5.1.1.2.cmml" xref="S2.SS1.p5.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p5.5.m5.1.1.2.1.cmml" xref="S2.SS1.p5.5.m5.1.1.2">subscript</csymbol><ci id="S2.SS1.p5.5.m5.1.1.2.2.cmml" xref="S2.SS1.p5.5.m5.1.1.2.2">𝑑</ci><ci id="S2.SS1.p5.5.m5.1.1.2.3.cmml" xref="S2.SS1.p5.5.m5.1.1.2.3">𝑎</ci></apply><cn id="S2.SS1.p5.5.m5.1.1.3.cmml" type="integer" xref="S2.SS1.p5.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.5.m5.1c">d_{a}=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.5.m5.1d">italic_d start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT = 1</annotation></semantics></math>. We highlight that the number of parameters of this layer is <math alttext="d_{a}(2d_{q}+(h+1)d_{v})" class="ltx_Math" display="inline" id="S2.SS1.p5.6.m6.1"><semantics id="S2.SS1.p5.6.m6.1a"><mrow id="S2.SS1.p5.6.m6.1.1" xref="S2.SS1.p5.6.m6.1.1.cmml"><msub id="S2.SS1.p5.6.m6.1.1.3" xref="S2.SS1.p5.6.m6.1.1.3.cmml"><mi id="S2.SS1.p5.6.m6.1.1.3.2" xref="S2.SS1.p5.6.m6.1.1.3.2.cmml">d</mi><mi id="S2.SS1.p5.6.m6.1.1.3.3" xref="S2.SS1.p5.6.m6.1.1.3.3.cmml">a</mi></msub><mo id="S2.SS1.p5.6.m6.1.1.2" xref="S2.SS1.p5.6.m6.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p5.6.m6.1.1.1.1" xref="S2.SS1.p5.6.m6.1.1.1.1.1.cmml"><mo id="S2.SS1.p5.6.m6.1.1.1.1.2" stretchy="false" xref="S2.SS1.p5.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p5.6.m6.1.1.1.1.1" xref="S2.SS1.p5.6.m6.1.1.1.1.1.cmml"><mrow id="S2.SS1.p5.6.m6.1.1.1.1.1.3" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.cmml"><mn id="S2.SS1.p5.6.m6.1.1.1.1.1.3.2" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.2.cmml">2</mn><mo id="S2.SS1.p5.6.m6.1.1.1.1.1.3.1" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.SS1.p5.6.m6.1.1.1.1.1.3.3" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.cmml"><mi id="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.2" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.2.cmml">d</mi><mi id="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.3" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.3.cmml">q</mi></msub></mrow><mo id="S2.SS1.p5.6.m6.1.1.1.1.1.2" xref="S2.SS1.p5.6.m6.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.SS1.p5.6.m6.1.1.1.1.1.1" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.cmml"><mrow id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mo id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS1.p5.6.m6.1.1.1.1.1.1.2" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S2.SS1.p5.6.m6.1.1.1.1.1.1.3" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.2" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.2.cmml">d</mi><mi id="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.3" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.3.cmml">v</mi></msub></mrow></mrow><mo id="S2.SS1.p5.6.m6.1.1.1.1.3" stretchy="false" xref="S2.SS1.p5.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.6.m6.1b"><apply id="S2.SS1.p5.6.m6.1.1.cmml" xref="S2.SS1.p5.6.m6.1.1"><times id="S2.SS1.p5.6.m6.1.1.2.cmml" xref="S2.SS1.p5.6.m6.1.1.2"></times><apply id="S2.SS1.p5.6.m6.1.1.3.cmml" xref="S2.SS1.p5.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p5.6.m6.1.1.3.1.cmml" xref="S2.SS1.p5.6.m6.1.1.3">subscript</csymbol><ci id="S2.SS1.p5.6.m6.1.1.3.2.cmml" xref="S2.SS1.p5.6.m6.1.1.3.2">𝑑</ci><ci id="S2.SS1.p5.6.m6.1.1.3.3.cmml" xref="S2.SS1.p5.6.m6.1.1.3.3">𝑎</ci></apply><apply id="S2.SS1.p5.6.m6.1.1.1.1.1.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1"><plus id="S2.SS1.p5.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.2"></plus><apply id="S2.SS1.p5.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3"><times id="S2.SS1.p5.6.m6.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.1"></times><cn id="S2.SS1.p5.6.m6.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.2">2</cn><apply id="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.1.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.2.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.2">𝑑</ci><ci id="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.3.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.3.3.3">𝑞</ci></apply></apply><apply id="S2.SS1.p5.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1"><times id="S2.SS1.p5.6.m6.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.2"></times><apply id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1"><plus id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.2">ℎ</ci><cn id="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p5.6.m6.1.1.1.1.1.1.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.6.m6.1c">d_{a}(2d_{q}+(h+1)d_{v})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.6.m6.1d">italic_d start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( 2 italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT + ( italic_h + 1 ) italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT )</annotation></semantics></math>, which does not depend on <math alttext="n" class="ltx_Math" display="inline" id="S2.SS1.p5.7.m7.1"><semantics id="S2.SS1.p5.7.m7.1a"><mi id="S2.SS1.p5.7.m7.1.1" xref="S2.SS1.p5.7.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.7.m7.1b"><ci id="S2.SS1.p5.7.m7.1.1.cmml" xref="S2.SS1.p5.7.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.7.m7.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.7.m7.1d">italic_n</annotation></semantics></math>. Thus, the multi-head attention mechanism allows us to add extra layers to the model without significantly increasing the number of parameters.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p6">
<p class="ltx_p" id="S2.SS1.p6.13">A critique to the full attention mechanism is the potential loss of positional information. First of all, note that the output of <math alttext="\operatorname{FullAttn(Q,K,V)}" class="ltx_Math" display="inline" id="S2.SS1.p6.1.m1.3"><semantics id="S2.SS1.p6.1.m1.3a"><mrow id="S2.SS1.p6.1.m1.3.3" xref="S2.SS1.p6.1.m1.3.3.cmml"><mi id="S2.SS1.p6.1.m1.3.3.5" xref="S2.SS1.p6.1.m1.3.3.5.cmml">FullAttn</mi><mo id="S2.SS1.p6.1.m1.3.3.4" xref="S2.SS1.p6.1.m1.3.3.4.cmml">⁢</mo><mrow id="S2.SS1.p6.1.m1.3.3.6.2" xref="S2.SS1.p6.1.m1.3.3.6.1.cmml"><mo id="S2.SS1.p6.1.m1.3.3.6.2.1" stretchy="false" xref="S2.SS1.p6.1.m1.3.3.6.1.cmml">(</mo><mi id="S2.SS1.p6.1.m1.1.1.1" mathvariant="normal" xref="S2.SS1.p6.1.m1.1.1.1.cmml">Q</mi><mo id="S2.SS1.p6.1.m1.3.3.6.2.2" xref="S2.SS1.p6.1.m1.3.3.6.1.cmml">,</mo><mi id="S2.SS1.p6.1.m1.2.2.2" mathvariant="normal" xref="S2.SS1.p6.1.m1.2.2.2.cmml">K</mi><mo id="S2.SS1.p6.1.m1.3.3.6.2.3" xref="S2.SS1.p6.1.m1.3.3.6.1.cmml">,</mo><mi id="S2.SS1.p6.1.m1.3.3.3" mathvariant="normal" xref="S2.SS1.p6.1.m1.3.3.3.cmml">V</mi><mo id="S2.SS1.p6.1.m1.3.3.6.2.4" stretchy="false" xref="S2.SS1.p6.1.m1.3.3.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.1.m1.3b"><apply id="S2.SS1.p6.1.m1.3.3.cmml" xref="S2.SS1.p6.1.m1.3.3"><times id="S2.SS1.p6.1.m1.3.3.4.cmml" xref="S2.SS1.p6.1.m1.3.3.4"></times><ci id="S2.SS1.p6.1.m1.3.3.5.cmml" xref="S2.SS1.p6.1.m1.3.3.5">FullAttn</ci><vector id="S2.SS1.p6.1.m1.3.3.6.1.cmml" xref="S2.SS1.p6.1.m1.3.3.6.2"><ci id="S2.SS1.p6.1.m1.1.1.1.cmml" xref="S2.SS1.p6.1.m1.1.1.1">Q</ci><ci id="S2.SS1.p6.1.m1.2.2.2.cmml" xref="S2.SS1.p6.1.m1.2.2.2">K</ci><ci id="S2.SS1.p6.1.m1.3.3.3.cmml" xref="S2.SS1.p6.1.m1.3.3.3">V</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.1.m1.3c">\operatorname{FullAttn(Q,K,V)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.1.m1.3d">roman_FullAttn ( roman_Q , roman_K , roman_V )</annotation></semantics></math> is a matrix whose <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p6.2.m2.1"><semantics id="S2.SS1.p6.2.m2.1a"><mi id="S2.SS1.p6.2.m2.1.1" xref="S2.SS1.p6.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.2.m2.1b"><ci id="S2.SS1.p6.2.m2.1.1.cmml" xref="S2.SS1.p6.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.2.m2.1d">italic_i</annotation></semantics></math>-th row is <math alttext="\sum_{j=1}a_{i,j}V_{j}" class="ltx_Math" display="inline" id="S2.SS1.p6.3.m3.2"><semantics id="S2.SS1.p6.3.m3.2a"><mrow id="S2.SS1.p6.3.m3.2.3" xref="S2.SS1.p6.3.m3.2.3.cmml"><msub id="S2.SS1.p6.3.m3.2.3.1" xref="S2.SS1.p6.3.m3.2.3.1.cmml"><mo id="S2.SS1.p6.3.m3.2.3.1.2" xref="S2.SS1.p6.3.m3.2.3.1.2.cmml">∑</mo><mrow id="S2.SS1.p6.3.m3.2.3.1.3" xref="S2.SS1.p6.3.m3.2.3.1.3.cmml"><mi id="S2.SS1.p6.3.m3.2.3.1.3.2" xref="S2.SS1.p6.3.m3.2.3.1.3.2.cmml">j</mi><mo id="S2.SS1.p6.3.m3.2.3.1.3.1" xref="S2.SS1.p6.3.m3.2.3.1.3.1.cmml">=</mo><mn id="S2.SS1.p6.3.m3.2.3.1.3.3" xref="S2.SS1.p6.3.m3.2.3.1.3.3.cmml">1</mn></mrow></msub><mrow id="S2.SS1.p6.3.m3.2.3.2" xref="S2.SS1.p6.3.m3.2.3.2.cmml"><msub id="S2.SS1.p6.3.m3.2.3.2.2" xref="S2.SS1.p6.3.m3.2.3.2.2.cmml"><mi id="S2.SS1.p6.3.m3.2.3.2.2.2" xref="S2.SS1.p6.3.m3.2.3.2.2.2.cmml">a</mi><mrow id="S2.SS1.p6.3.m3.2.2.2.4" xref="S2.SS1.p6.3.m3.2.2.2.3.cmml"><mi id="S2.SS1.p6.3.m3.1.1.1.1" xref="S2.SS1.p6.3.m3.1.1.1.1.cmml">i</mi><mo id="S2.SS1.p6.3.m3.2.2.2.4.1" xref="S2.SS1.p6.3.m3.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p6.3.m3.2.2.2.2" xref="S2.SS1.p6.3.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S2.SS1.p6.3.m3.2.3.2.1" xref="S2.SS1.p6.3.m3.2.3.2.1.cmml">⁢</mo><msub id="S2.SS1.p6.3.m3.2.3.2.3" xref="S2.SS1.p6.3.m3.2.3.2.3.cmml"><mi id="S2.SS1.p6.3.m3.2.3.2.3.2" xref="S2.SS1.p6.3.m3.2.3.2.3.2.cmml">V</mi><mi id="S2.SS1.p6.3.m3.2.3.2.3.3" xref="S2.SS1.p6.3.m3.2.3.2.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.3.m3.2b"><apply id="S2.SS1.p6.3.m3.2.3.cmml" xref="S2.SS1.p6.3.m3.2.3"><apply id="S2.SS1.p6.3.m3.2.3.1.cmml" xref="S2.SS1.p6.3.m3.2.3.1"><csymbol cd="ambiguous" id="S2.SS1.p6.3.m3.2.3.1.1.cmml" xref="S2.SS1.p6.3.m3.2.3.1">subscript</csymbol><sum id="S2.SS1.p6.3.m3.2.3.1.2.cmml" xref="S2.SS1.p6.3.m3.2.3.1.2"></sum><apply id="S2.SS1.p6.3.m3.2.3.1.3.cmml" xref="S2.SS1.p6.3.m3.2.3.1.3"><eq id="S2.SS1.p6.3.m3.2.3.1.3.1.cmml" xref="S2.SS1.p6.3.m3.2.3.1.3.1"></eq><ci id="S2.SS1.p6.3.m3.2.3.1.3.2.cmml" xref="S2.SS1.p6.3.m3.2.3.1.3.2">𝑗</ci><cn id="S2.SS1.p6.3.m3.2.3.1.3.3.cmml" type="integer" xref="S2.SS1.p6.3.m3.2.3.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p6.3.m3.2.3.2.cmml" xref="S2.SS1.p6.3.m3.2.3.2"><times id="S2.SS1.p6.3.m3.2.3.2.1.cmml" xref="S2.SS1.p6.3.m3.2.3.2.1"></times><apply id="S2.SS1.p6.3.m3.2.3.2.2.cmml" xref="S2.SS1.p6.3.m3.2.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p6.3.m3.2.3.2.2.1.cmml" xref="S2.SS1.p6.3.m3.2.3.2.2">subscript</csymbol><ci id="S2.SS1.p6.3.m3.2.3.2.2.2.cmml" xref="S2.SS1.p6.3.m3.2.3.2.2.2">𝑎</ci><list id="S2.SS1.p6.3.m3.2.2.2.3.cmml" xref="S2.SS1.p6.3.m3.2.2.2.4"><ci id="S2.SS1.p6.3.m3.1.1.1.1.cmml" xref="S2.SS1.p6.3.m3.1.1.1.1">𝑖</ci><ci id="S2.SS1.p6.3.m3.2.2.2.2.cmml" xref="S2.SS1.p6.3.m3.2.2.2.2">𝑗</ci></list></apply><apply id="S2.SS1.p6.3.m3.2.3.2.3.cmml" xref="S2.SS1.p6.3.m3.2.3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p6.3.m3.2.3.2.3.1.cmml" xref="S2.SS1.p6.3.m3.2.3.2.3">subscript</csymbol><ci id="S2.SS1.p6.3.m3.2.3.2.3.2.cmml" xref="S2.SS1.p6.3.m3.2.3.2.3.2">𝑉</ci><ci id="S2.SS1.p6.3.m3.2.3.2.3.3.cmml" xref="S2.SS1.p6.3.m3.2.3.2.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.3.m3.2c">\sum_{j=1}a_{i,j}V_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.3.m3.2d">∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. This average <math alttext="\sum_{j=1}a_{i,j}V_{j}" class="ltx_Math" display="inline" id="S2.SS1.p6.4.m4.2"><semantics id="S2.SS1.p6.4.m4.2a"><mrow id="S2.SS1.p6.4.m4.2.3" xref="S2.SS1.p6.4.m4.2.3.cmml"><msub id="S2.SS1.p6.4.m4.2.3.1" xref="S2.SS1.p6.4.m4.2.3.1.cmml"><mo id="S2.SS1.p6.4.m4.2.3.1.2" xref="S2.SS1.p6.4.m4.2.3.1.2.cmml">∑</mo><mrow id="S2.SS1.p6.4.m4.2.3.1.3" xref="S2.SS1.p6.4.m4.2.3.1.3.cmml"><mi id="S2.SS1.p6.4.m4.2.3.1.3.2" xref="S2.SS1.p6.4.m4.2.3.1.3.2.cmml">j</mi><mo id="S2.SS1.p6.4.m4.2.3.1.3.1" xref="S2.SS1.p6.4.m4.2.3.1.3.1.cmml">=</mo><mn id="S2.SS1.p6.4.m4.2.3.1.3.3" xref="S2.SS1.p6.4.m4.2.3.1.3.3.cmml">1</mn></mrow></msub><mrow id="S2.SS1.p6.4.m4.2.3.2" xref="S2.SS1.p6.4.m4.2.3.2.cmml"><msub id="S2.SS1.p6.4.m4.2.3.2.2" xref="S2.SS1.p6.4.m4.2.3.2.2.cmml"><mi id="S2.SS1.p6.4.m4.2.3.2.2.2" xref="S2.SS1.p6.4.m4.2.3.2.2.2.cmml">a</mi><mrow id="S2.SS1.p6.4.m4.2.2.2.4" xref="S2.SS1.p6.4.m4.2.2.2.3.cmml"><mi id="S2.SS1.p6.4.m4.1.1.1.1" xref="S2.SS1.p6.4.m4.1.1.1.1.cmml">i</mi><mo id="S2.SS1.p6.4.m4.2.2.2.4.1" xref="S2.SS1.p6.4.m4.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p6.4.m4.2.2.2.2" xref="S2.SS1.p6.4.m4.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S2.SS1.p6.4.m4.2.3.2.1" xref="S2.SS1.p6.4.m4.2.3.2.1.cmml">⁢</mo><msub id="S2.SS1.p6.4.m4.2.3.2.3" xref="S2.SS1.p6.4.m4.2.3.2.3.cmml"><mi id="S2.SS1.p6.4.m4.2.3.2.3.2" xref="S2.SS1.p6.4.m4.2.3.2.3.2.cmml">V</mi><mi id="S2.SS1.p6.4.m4.2.3.2.3.3" xref="S2.SS1.p6.4.m4.2.3.2.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.4.m4.2b"><apply id="S2.SS1.p6.4.m4.2.3.cmml" xref="S2.SS1.p6.4.m4.2.3"><apply id="S2.SS1.p6.4.m4.2.3.1.cmml" xref="S2.SS1.p6.4.m4.2.3.1"><csymbol cd="ambiguous" id="S2.SS1.p6.4.m4.2.3.1.1.cmml" xref="S2.SS1.p6.4.m4.2.3.1">subscript</csymbol><sum id="S2.SS1.p6.4.m4.2.3.1.2.cmml" xref="S2.SS1.p6.4.m4.2.3.1.2"></sum><apply id="S2.SS1.p6.4.m4.2.3.1.3.cmml" xref="S2.SS1.p6.4.m4.2.3.1.3"><eq id="S2.SS1.p6.4.m4.2.3.1.3.1.cmml" xref="S2.SS1.p6.4.m4.2.3.1.3.1"></eq><ci id="S2.SS1.p6.4.m4.2.3.1.3.2.cmml" xref="S2.SS1.p6.4.m4.2.3.1.3.2">𝑗</ci><cn id="S2.SS1.p6.4.m4.2.3.1.3.3.cmml" type="integer" xref="S2.SS1.p6.4.m4.2.3.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p6.4.m4.2.3.2.cmml" xref="S2.SS1.p6.4.m4.2.3.2"><times id="S2.SS1.p6.4.m4.2.3.2.1.cmml" xref="S2.SS1.p6.4.m4.2.3.2.1"></times><apply id="S2.SS1.p6.4.m4.2.3.2.2.cmml" xref="S2.SS1.p6.4.m4.2.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p6.4.m4.2.3.2.2.1.cmml" xref="S2.SS1.p6.4.m4.2.3.2.2">subscript</csymbol><ci id="S2.SS1.p6.4.m4.2.3.2.2.2.cmml" xref="S2.SS1.p6.4.m4.2.3.2.2.2">𝑎</ci><list id="S2.SS1.p6.4.m4.2.2.2.3.cmml" xref="S2.SS1.p6.4.m4.2.2.2.4"><ci id="S2.SS1.p6.4.m4.1.1.1.1.cmml" xref="S2.SS1.p6.4.m4.1.1.1.1">𝑖</ci><ci id="S2.SS1.p6.4.m4.2.2.2.2.cmml" xref="S2.SS1.p6.4.m4.2.2.2.2">𝑗</ci></list></apply><apply id="S2.SS1.p6.4.m4.2.3.2.3.cmml" xref="S2.SS1.p6.4.m4.2.3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p6.4.m4.2.3.2.3.1.cmml" xref="S2.SS1.p6.4.m4.2.3.2.3">subscript</csymbol><ci id="S2.SS1.p6.4.m4.2.3.2.3.2.cmml" xref="S2.SS1.p6.4.m4.2.3.2.3.2">𝑉</ci><ci id="S2.SS1.p6.4.m4.2.3.2.3.3.cmml" xref="S2.SS1.p6.4.m4.2.3.2.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.4.m4.2c">\sum_{j=1}a_{i,j}V_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.4.m4.2d">∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> results in a partial loss of position as it may be the case that <math alttext="a_{i,j}" class="ltx_Math" display="inline" id="S2.SS1.p6.5.m5.2"><semantics id="S2.SS1.p6.5.m5.2a"><msub id="S2.SS1.p6.5.m5.2.3" xref="S2.SS1.p6.5.m5.2.3.cmml"><mi id="S2.SS1.p6.5.m5.2.3.2" xref="S2.SS1.p6.5.m5.2.3.2.cmml">a</mi><mrow id="S2.SS1.p6.5.m5.2.2.2.4" xref="S2.SS1.p6.5.m5.2.2.2.3.cmml"><mi id="S2.SS1.p6.5.m5.1.1.1.1" xref="S2.SS1.p6.5.m5.1.1.1.1.cmml">i</mi><mo id="S2.SS1.p6.5.m5.2.2.2.4.1" xref="S2.SS1.p6.5.m5.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p6.5.m5.2.2.2.2" xref="S2.SS1.p6.5.m5.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.5.m5.2b"><apply id="S2.SS1.p6.5.m5.2.3.cmml" xref="S2.SS1.p6.5.m5.2.3"><csymbol cd="ambiguous" id="S2.SS1.p6.5.m5.2.3.1.cmml" xref="S2.SS1.p6.5.m5.2.3">subscript</csymbol><ci id="S2.SS1.p6.5.m5.2.3.2.cmml" xref="S2.SS1.p6.5.m5.2.3.2">𝑎</ci><list id="S2.SS1.p6.5.m5.2.2.2.3.cmml" xref="S2.SS1.p6.5.m5.2.2.2.4"><ci id="S2.SS1.p6.5.m5.1.1.1.1.cmml" xref="S2.SS1.p6.5.m5.1.1.1.1">𝑖</ci><ci id="S2.SS1.p6.5.m5.2.2.2.2.cmml" xref="S2.SS1.p6.5.m5.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.5.m5.2c">a_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.5.m5.2d">italic_a start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is large for a <math alttext="V_{j}" class="ltx_Math" display="inline" id="S2.SS1.p6.6.m6.1"><semantics id="S2.SS1.p6.6.m6.1a"><msub id="S2.SS1.p6.6.m6.1.1" xref="S2.SS1.p6.6.m6.1.1.cmml"><mi id="S2.SS1.p6.6.m6.1.1.2" xref="S2.SS1.p6.6.m6.1.1.2.cmml">V</mi><mi id="S2.SS1.p6.6.m6.1.1.3" xref="S2.SS1.p6.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.6.m6.1b"><apply id="S2.SS1.p6.6.m6.1.1.cmml" xref="S2.SS1.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p6.6.m6.1.1.1.cmml" xref="S2.SS1.p6.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p6.6.m6.1.1.2.cmml" xref="S2.SS1.p6.6.m6.1.1.2">𝑉</ci><ci id="S2.SS1.p6.6.m6.1.1.3.cmml" xref="S2.SS1.p6.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.6.m6.1c">V_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.6.m6.1d">italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> that is far away from <math alttext="V_{i}" class="ltx_Math" display="inline" id="S2.SS1.p6.7.m7.1"><semantics id="S2.SS1.p6.7.m7.1a"><msub id="S2.SS1.p6.7.m7.1.1" xref="S2.SS1.p6.7.m7.1.1.cmml"><mi id="S2.SS1.p6.7.m7.1.1.2" xref="S2.SS1.p6.7.m7.1.1.2.cmml">V</mi><mi id="S2.SS1.p6.7.m7.1.1.3" xref="S2.SS1.p6.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.7.m7.1b"><apply id="S2.SS1.p6.7.m7.1.1.cmml" xref="S2.SS1.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p6.7.m7.1.1.1.cmml" xref="S2.SS1.p6.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p6.7.m7.1.1.2.cmml" xref="S2.SS1.p6.7.m7.1.1.2">𝑉</ci><ci id="S2.SS1.p6.7.m7.1.1.3.cmml" xref="S2.SS1.p6.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.7.m7.1c">V_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.7.m7.1d">italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in the input sequence. That is, we lose the sense of temporal locality of the values as we average values with entries far away in the input sequence. We formalise this loss of local information is in Proposition <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm1" title="Proposition 1. ‣ 2.1 Attention Mechanism ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">1</span></a>. First, let us introduce some notation. For a permutation <math alttext="\pi\colon\{0,1,\ldots,n-1\}\to\{0,1,\ldots,n-1\}" class="ltx_Math" display="inline" id="S2.SS1.p6.8.m8.8"><semantics id="S2.SS1.p6.8.m8.8a"><mrow id="S2.SS1.p6.8.m8.8.8" xref="S2.SS1.p6.8.m8.8.8.cmml"><mi id="S2.SS1.p6.8.m8.8.8.4" xref="S2.SS1.p6.8.m8.8.8.4.cmml">π</mi><mo id="S2.SS1.p6.8.m8.8.8.3" lspace="0.278em" rspace="0.278em" xref="S2.SS1.p6.8.m8.8.8.3.cmml">:</mo><mrow id="S2.SS1.p6.8.m8.8.8.2" xref="S2.SS1.p6.8.m8.8.8.2.cmml"><mrow id="S2.SS1.p6.8.m8.7.7.1.1.1" xref="S2.SS1.p6.8.m8.7.7.1.1.2.cmml"><mo id="S2.SS1.p6.8.m8.7.7.1.1.1.2" stretchy="false" xref="S2.SS1.p6.8.m8.7.7.1.1.2.cmml">{</mo><mn id="S2.SS1.p6.8.m8.1.1" xref="S2.SS1.p6.8.m8.1.1.cmml">0</mn><mo id="S2.SS1.p6.8.m8.7.7.1.1.1.3" xref="S2.SS1.p6.8.m8.7.7.1.1.2.cmml">,</mo><mn id="S2.SS1.p6.8.m8.2.2" xref="S2.SS1.p6.8.m8.2.2.cmml">1</mn><mo id="S2.SS1.p6.8.m8.7.7.1.1.1.4" xref="S2.SS1.p6.8.m8.7.7.1.1.2.cmml">,</mo><mi id="S2.SS1.p6.8.m8.3.3" mathvariant="normal" xref="S2.SS1.p6.8.m8.3.3.cmml">…</mi><mo id="S2.SS1.p6.8.m8.7.7.1.1.1.5" xref="S2.SS1.p6.8.m8.7.7.1.1.2.cmml">,</mo><mrow id="S2.SS1.p6.8.m8.7.7.1.1.1.1" xref="S2.SS1.p6.8.m8.7.7.1.1.1.1.cmml"><mi id="S2.SS1.p6.8.m8.7.7.1.1.1.1.2" xref="S2.SS1.p6.8.m8.7.7.1.1.1.1.2.cmml">n</mi><mo id="S2.SS1.p6.8.m8.7.7.1.1.1.1.1" xref="S2.SS1.p6.8.m8.7.7.1.1.1.1.1.cmml">−</mo><mn id="S2.SS1.p6.8.m8.7.7.1.1.1.1.3" xref="S2.SS1.p6.8.m8.7.7.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS1.p6.8.m8.7.7.1.1.1.6" stretchy="false" xref="S2.SS1.p6.8.m8.7.7.1.1.2.cmml">}</mo></mrow><mo id="S2.SS1.p6.8.m8.8.8.2.3" stretchy="false" xref="S2.SS1.p6.8.m8.8.8.2.3.cmml">→</mo><mrow id="S2.SS1.p6.8.m8.8.8.2.2.1" xref="S2.SS1.p6.8.m8.8.8.2.2.2.cmml"><mo id="S2.SS1.p6.8.m8.8.8.2.2.1.2" stretchy="false" xref="S2.SS1.p6.8.m8.8.8.2.2.2.cmml">{</mo><mn id="S2.SS1.p6.8.m8.4.4" xref="S2.SS1.p6.8.m8.4.4.cmml">0</mn><mo id="S2.SS1.p6.8.m8.8.8.2.2.1.3" xref="S2.SS1.p6.8.m8.8.8.2.2.2.cmml">,</mo><mn id="S2.SS1.p6.8.m8.5.5" xref="S2.SS1.p6.8.m8.5.5.cmml">1</mn><mo id="S2.SS1.p6.8.m8.8.8.2.2.1.4" xref="S2.SS1.p6.8.m8.8.8.2.2.2.cmml">,</mo><mi id="S2.SS1.p6.8.m8.6.6" mathvariant="normal" xref="S2.SS1.p6.8.m8.6.6.cmml">…</mi><mo id="S2.SS1.p6.8.m8.8.8.2.2.1.5" xref="S2.SS1.p6.8.m8.8.8.2.2.2.cmml">,</mo><mrow id="S2.SS1.p6.8.m8.8.8.2.2.1.1" xref="S2.SS1.p6.8.m8.8.8.2.2.1.1.cmml"><mi id="S2.SS1.p6.8.m8.8.8.2.2.1.1.2" xref="S2.SS1.p6.8.m8.8.8.2.2.1.1.2.cmml">n</mi><mo id="S2.SS1.p6.8.m8.8.8.2.2.1.1.1" xref="S2.SS1.p6.8.m8.8.8.2.2.1.1.1.cmml">−</mo><mn id="S2.SS1.p6.8.m8.8.8.2.2.1.1.3" xref="S2.SS1.p6.8.m8.8.8.2.2.1.1.3.cmml">1</mn></mrow><mo id="S2.SS1.p6.8.m8.8.8.2.2.1.6" stretchy="false" xref="S2.SS1.p6.8.m8.8.8.2.2.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.8.m8.8b"><apply id="S2.SS1.p6.8.m8.8.8.cmml" xref="S2.SS1.p6.8.m8.8.8"><ci id="S2.SS1.p6.8.m8.8.8.3.cmml" xref="S2.SS1.p6.8.m8.8.8.3">:</ci><ci id="S2.SS1.p6.8.m8.8.8.4.cmml" xref="S2.SS1.p6.8.m8.8.8.4">𝜋</ci><apply id="S2.SS1.p6.8.m8.8.8.2.cmml" xref="S2.SS1.p6.8.m8.8.8.2"><ci id="S2.SS1.p6.8.m8.8.8.2.3.cmml" xref="S2.SS1.p6.8.m8.8.8.2.3">→</ci><set id="S2.SS1.p6.8.m8.7.7.1.1.2.cmml" xref="S2.SS1.p6.8.m8.7.7.1.1.1"><cn id="S2.SS1.p6.8.m8.1.1.cmml" type="integer" xref="S2.SS1.p6.8.m8.1.1">0</cn><cn id="S2.SS1.p6.8.m8.2.2.cmml" type="integer" xref="S2.SS1.p6.8.m8.2.2">1</cn><ci id="S2.SS1.p6.8.m8.3.3.cmml" xref="S2.SS1.p6.8.m8.3.3">…</ci><apply id="S2.SS1.p6.8.m8.7.7.1.1.1.1.cmml" xref="S2.SS1.p6.8.m8.7.7.1.1.1.1"><minus id="S2.SS1.p6.8.m8.7.7.1.1.1.1.1.cmml" xref="S2.SS1.p6.8.m8.7.7.1.1.1.1.1"></minus><ci id="S2.SS1.p6.8.m8.7.7.1.1.1.1.2.cmml" xref="S2.SS1.p6.8.m8.7.7.1.1.1.1.2">𝑛</ci><cn id="S2.SS1.p6.8.m8.7.7.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p6.8.m8.7.7.1.1.1.1.3">1</cn></apply></set><set id="S2.SS1.p6.8.m8.8.8.2.2.2.cmml" xref="S2.SS1.p6.8.m8.8.8.2.2.1"><cn id="S2.SS1.p6.8.m8.4.4.cmml" type="integer" xref="S2.SS1.p6.8.m8.4.4">0</cn><cn id="S2.SS1.p6.8.m8.5.5.cmml" type="integer" xref="S2.SS1.p6.8.m8.5.5">1</cn><ci id="S2.SS1.p6.8.m8.6.6.cmml" xref="S2.SS1.p6.8.m8.6.6">…</ci><apply id="S2.SS1.p6.8.m8.8.8.2.2.1.1.cmml" xref="S2.SS1.p6.8.m8.8.8.2.2.1.1"><minus id="S2.SS1.p6.8.m8.8.8.2.2.1.1.1.cmml" xref="S2.SS1.p6.8.m8.8.8.2.2.1.1.1"></minus><ci id="S2.SS1.p6.8.m8.8.8.2.2.1.1.2.cmml" xref="S2.SS1.p6.8.m8.8.8.2.2.1.1.2">𝑛</ci><cn id="S2.SS1.p6.8.m8.8.8.2.2.1.1.3.cmml" type="integer" xref="S2.SS1.p6.8.m8.8.8.2.2.1.1.3">1</cn></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.8.m8.8c">\pi\colon\{0,1,\ldots,n-1\}\to\{0,1,\ldots,n-1\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.8.m8.8d">italic_π : { 0 , 1 , … , italic_n - 1 } → { 0 , 1 , … , italic_n - 1 }</annotation></semantics></math>, the <em class="ltx_emph ltx_font_italic" id="S2.SS1.p6.13.1">permutation matrix</em> <math alttext="P_{\pi}" class="ltx_Math" display="inline" id="S2.SS1.p6.9.m9.1"><semantics id="S2.SS1.p6.9.m9.1a"><msub id="S2.SS1.p6.9.m9.1.1" xref="S2.SS1.p6.9.m9.1.1.cmml"><mi id="S2.SS1.p6.9.m9.1.1.2" xref="S2.SS1.p6.9.m9.1.1.2.cmml">P</mi><mi id="S2.SS1.p6.9.m9.1.1.3" xref="S2.SS1.p6.9.m9.1.1.3.cmml">π</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.9.m9.1b"><apply id="S2.SS1.p6.9.m9.1.1.cmml" xref="S2.SS1.p6.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p6.9.m9.1.1.1.cmml" xref="S2.SS1.p6.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p6.9.m9.1.1.2.cmml" xref="S2.SS1.p6.9.m9.1.1.2">𝑃</ci><ci id="S2.SS1.p6.9.m9.1.1.3.cmml" xref="S2.SS1.p6.9.m9.1.1.3">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.9.m9.1c">P_{\pi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.9.m9.1d">italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT</annotation></semantics></math> is the matrix with dimensions <math alttext="n\times n" class="ltx_Math" display="inline" id="S2.SS1.p6.10.m10.1"><semantics id="S2.SS1.p6.10.m10.1a"><mrow id="S2.SS1.p6.10.m10.1.1" xref="S2.SS1.p6.10.m10.1.1.cmml"><mi id="S2.SS1.p6.10.m10.1.1.2" xref="S2.SS1.p6.10.m10.1.1.2.cmml">n</mi><mo id="S2.SS1.p6.10.m10.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p6.10.m10.1.1.1.cmml">×</mo><mi id="S2.SS1.p6.10.m10.1.1.3" xref="S2.SS1.p6.10.m10.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.10.m10.1b"><apply id="S2.SS1.p6.10.m10.1.1.cmml" xref="S2.SS1.p6.10.m10.1.1"><times id="S2.SS1.p6.10.m10.1.1.1.cmml" xref="S2.SS1.p6.10.m10.1.1.1"></times><ci id="S2.SS1.p6.10.m10.1.1.2.cmml" xref="S2.SS1.p6.10.m10.1.1.2">𝑛</ci><ci id="S2.SS1.p6.10.m10.1.1.3.cmml" xref="S2.SS1.p6.10.m10.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.10.m10.1c">n\times n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.10.m10.1d">italic_n × italic_n</annotation></semantics></math> defined as <math alttext="P_{\pi}[i,j]=1" class="ltx_Math" display="inline" id="S2.SS1.p6.11.m11.2"><semantics id="S2.SS1.p6.11.m11.2a"><mrow id="S2.SS1.p6.11.m11.2.3" xref="S2.SS1.p6.11.m11.2.3.cmml"><mrow id="S2.SS1.p6.11.m11.2.3.2" xref="S2.SS1.p6.11.m11.2.3.2.cmml"><msub id="S2.SS1.p6.11.m11.2.3.2.2" xref="S2.SS1.p6.11.m11.2.3.2.2.cmml"><mi id="S2.SS1.p6.11.m11.2.3.2.2.2" xref="S2.SS1.p6.11.m11.2.3.2.2.2.cmml">P</mi><mi id="S2.SS1.p6.11.m11.2.3.2.2.3" xref="S2.SS1.p6.11.m11.2.3.2.2.3.cmml">π</mi></msub><mo id="S2.SS1.p6.11.m11.2.3.2.1" xref="S2.SS1.p6.11.m11.2.3.2.1.cmml">⁢</mo><mrow id="S2.SS1.p6.11.m11.2.3.2.3.2" xref="S2.SS1.p6.11.m11.2.3.2.3.1.cmml"><mo id="S2.SS1.p6.11.m11.2.3.2.3.2.1" stretchy="false" xref="S2.SS1.p6.11.m11.2.3.2.3.1.cmml">[</mo><mi id="S2.SS1.p6.11.m11.1.1" xref="S2.SS1.p6.11.m11.1.1.cmml">i</mi><mo id="S2.SS1.p6.11.m11.2.3.2.3.2.2" xref="S2.SS1.p6.11.m11.2.3.2.3.1.cmml">,</mo><mi id="S2.SS1.p6.11.m11.2.2" xref="S2.SS1.p6.11.m11.2.2.cmml">j</mi><mo id="S2.SS1.p6.11.m11.2.3.2.3.2.3" stretchy="false" xref="S2.SS1.p6.11.m11.2.3.2.3.1.cmml">]</mo></mrow></mrow><mo id="S2.SS1.p6.11.m11.2.3.1" xref="S2.SS1.p6.11.m11.2.3.1.cmml">=</mo><mn id="S2.SS1.p6.11.m11.2.3.3" xref="S2.SS1.p6.11.m11.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.11.m11.2b"><apply id="S2.SS1.p6.11.m11.2.3.cmml" xref="S2.SS1.p6.11.m11.2.3"><eq id="S2.SS1.p6.11.m11.2.3.1.cmml" xref="S2.SS1.p6.11.m11.2.3.1"></eq><apply id="S2.SS1.p6.11.m11.2.3.2.cmml" xref="S2.SS1.p6.11.m11.2.3.2"><times id="S2.SS1.p6.11.m11.2.3.2.1.cmml" xref="S2.SS1.p6.11.m11.2.3.2.1"></times><apply id="S2.SS1.p6.11.m11.2.3.2.2.cmml" xref="S2.SS1.p6.11.m11.2.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p6.11.m11.2.3.2.2.1.cmml" xref="S2.SS1.p6.11.m11.2.3.2.2">subscript</csymbol><ci id="S2.SS1.p6.11.m11.2.3.2.2.2.cmml" xref="S2.SS1.p6.11.m11.2.3.2.2.2">𝑃</ci><ci id="S2.SS1.p6.11.m11.2.3.2.2.3.cmml" xref="S2.SS1.p6.11.m11.2.3.2.2.3">𝜋</ci></apply><interval closure="closed" id="S2.SS1.p6.11.m11.2.3.2.3.1.cmml" xref="S2.SS1.p6.11.m11.2.3.2.3.2"><ci id="S2.SS1.p6.11.m11.1.1.cmml" xref="S2.SS1.p6.11.m11.1.1">𝑖</ci><ci id="S2.SS1.p6.11.m11.2.2.cmml" xref="S2.SS1.p6.11.m11.2.2">𝑗</ci></interval></apply><cn id="S2.SS1.p6.11.m11.2.3.3.cmml" type="integer" xref="S2.SS1.p6.11.m11.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.11.m11.2c">P_{\pi}[i,j]=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.11.m11.2d">italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT [ italic_i , italic_j ] = 1</annotation></semantics></math> for <math alttext="j=\pi(i)" class="ltx_Math" display="inline" id="S2.SS1.p6.12.m12.1"><semantics id="S2.SS1.p6.12.m12.1a"><mrow id="S2.SS1.p6.12.m12.1.2" xref="S2.SS1.p6.12.m12.1.2.cmml"><mi id="S2.SS1.p6.12.m12.1.2.2" xref="S2.SS1.p6.12.m12.1.2.2.cmml">j</mi><mo id="S2.SS1.p6.12.m12.1.2.1" xref="S2.SS1.p6.12.m12.1.2.1.cmml">=</mo><mrow id="S2.SS1.p6.12.m12.1.2.3" xref="S2.SS1.p6.12.m12.1.2.3.cmml"><mi id="S2.SS1.p6.12.m12.1.2.3.2" xref="S2.SS1.p6.12.m12.1.2.3.2.cmml">π</mi><mo id="S2.SS1.p6.12.m12.1.2.3.1" xref="S2.SS1.p6.12.m12.1.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p6.12.m12.1.2.3.3.2" xref="S2.SS1.p6.12.m12.1.2.3.cmml"><mo id="S2.SS1.p6.12.m12.1.2.3.3.2.1" stretchy="false" xref="S2.SS1.p6.12.m12.1.2.3.cmml">(</mo><mi id="S2.SS1.p6.12.m12.1.1" xref="S2.SS1.p6.12.m12.1.1.cmml">i</mi><mo id="S2.SS1.p6.12.m12.1.2.3.3.2.2" stretchy="false" xref="S2.SS1.p6.12.m12.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.12.m12.1b"><apply id="S2.SS1.p6.12.m12.1.2.cmml" xref="S2.SS1.p6.12.m12.1.2"><eq id="S2.SS1.p6.12.m12.1.2.1.cmml" xref="S2.SS1.p6.12.m12.1.2.1"></eq><ci id="S2.SS1.p6.12.m12.1.2.2.cmml" xref="S2.SS1.p6.12.m12.1.2.2">𝑗</ci><apply id="S2.SS1.p6.12.m12.1.2.3.cmml" xref="S2.SS1.p6.12.m12.1.2.3"><times id="S2.SS1.p6.12.m12.1.2.3.1.cmml" xref="S2.SS1.p6.12.m12.1.2.3.1"></times><ci id="S2.SS1.p6.12.m12.1.2.3.2.cmml" xref="S2.SS1.p6.12.m12.1.2.3.2">𝜋</ci><ci id="S2.SS1.p6.12.m12.1.1.cmml" xref="S2.SS1.p6.12.m12.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.12.m12.1c">j=\pi(i)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.12.m12.1d">italic_j = italic_π ( italic_i )</annotation></semantics></math> and <math alttext="P_{\pi}[i,j]=0" class="ltx_Math" display="inline" id="S2.SS1.p6.13.m13.2"><semantics id="S2.SS1.p6.13.m13.2a"><mrow id="S2.SS1.p6.13.m13.2.3" xref="S2.SS1.p6.13.m13.2.3.cmml"><mrow id="S2.SS1.p6.13.m13.2.3.2" xref="S2.SS1.p6.13.m13.2.3.2.cmml"><msub id="S2.SS1.p6.13.m13.2.3.2.2" xref="S2.SS1.p6.13.m13.2.3.2.2.cmml"><mi id="S2.SS1.p6.13.m13.2.3.2.2.2" xref="S2.SS1.p6.13.m13.2.3.2.2.2.cmml">P</mi><mi id="S2.SS1.p6.13.m13.2.3.2.2.3" xref="S2.SS1.p6.13.m13.2.3.2.2.3.cmml">π</mi></msub><mo id="S2.SS1.p6.13.m13.2.3.2.1" xref="S2.SS1.p6.13.m13.2.3.2.1.cmml">⁢</mo><mrow id="S2.SS1.p6.13.m13.2.3.2.3.2" xref="S2.SS1.p6.13.m13.2.3.2.3.1.cmml"><mo id="S2.SS1.p6.13.m13.2.3.2.3.2.1" stretchy="false" xref="S2.SS1.p6.13.m13.2.3.2.3.1.cmml">[</mo><mi id="S2.SS1.p6.13.m13.1.1" xref="S2.SS1.p6.13.m13.1.1.cmml">i</mi><mo id="S2.SS1.p6.13.m13.2.3.2.3.2.2" xref="S2.SS1.p6.13.m13.2.3.2.3.1.cmml">,</mo><mi id="S2.SS1.p6.13.m13.2.2" xref="S2.SS1.p6.13.m13.2.2.cmml">j</mi><mo id="S2.SS1.p6.13.m13.2.3.2.3.2.3" stretchy="false" xref="S2.SS1.p6.13.m13.2.3.2.3.1.cmml">]</mo></mrow></mrow><mo id="S2.SS1.p6.13.m13.2.3.1" xref="S2.SS1.p6.13.m13.2.3.1.cmml">=</mo><mn id="S2.SS1.p6.13.m13.2.3.3" xref="S2.SS1.p6.13.m13.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.13.m13.2b"><apply id="S2.SS1.p6.13.m13.2.3.cmml" xref="S2.SS1.p6.13.m13.2.3"><eq id="S2.SS1.p6.13.m13.2.3.1.cmml" xref="S2.SS1.p6.13.m13.2.3.1"></eq><apply id="S2.SS1.p6.13.m13.2.3.2.cmml" xref="S2.SS1.p6.13.m13.2.3.2"><times id="S2.SS1.p6.13.m13.2.3.2.1.cmml" xref="S2.SS1.p6.13.m13.2.3.2.1"></times><apply id="S2.SS1.p6.13.m13.2.3.2.2.cmml" xref="S2.SS1.p6.13.m13.2.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p6.13.m13.2.3.2.2.1.cmml" xref="S2.SS1.p6.13.m13.2.3.2.2">subscript</csymbol><ci id="S2.SS1.p6.13.m13.2.3.2.2.2.cmml" xref="S2.SS1.p6.13.m13.2.3.2.2.2">𝑃</ci><ci id="S2.SS1.p6.13.m13.2.3.2.2.3.cmml" xref="S2.SS1.p6.13.m13.2.3.2.2.3">𝜋</ci></apply><interval closure="closed" id="S2.SS1.p6.13.m13.2.3.2.3.1.cmml" xref="S2.SS1.p6.13.m13.2.3.2.3.2"><ci id="S2.SS1.p6.13.m13.1.1.cmml" xref="S2.SS1.p6.13.m13.1.1">𝑖</ci><ci id="S2.SS1.p6.13.m13.2.2.cmml" xref="S2.SS1.p6.13.m13.2.2">𝑗</ci></interval></apply><cn id="S2.SS1.p6.13.m13.2.3.3.cmml" type="integer" xref="S2.SS1.p6.13.m13.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.13.m13.2c">P_{\pi}[i,j]=0</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.13.m13.2d">italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT [ italic_i , italic_j ] = 0</annotation></semantics></math> otherwise.</p>
</div>
<div class="ltx_theorem ltx_theorem_prop" id="Thmthm1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm1.1.1.1">Proposition 1</span></span><span class="ltx_text ltx_font_bold" id="Thmthm1.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm1.p1">
<p class="ltx_p" id="Thmthm1.p1.3"><span class="ltx_text ltx_font_italic" id="Thmthm1.p1.3.3">In the case of the full attention mechanism, for any positive integers <math alttext="h" class="ltx_Math" display="inline" id="Thmthm1.p1.1.1.m1.1"><semantics id="Thmthm1.p1.1.1.m1.1a"><mi id="Thmthm1.p1.1.1.m1.1.1" xref="Thmthm1.p1.1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.1.1.m1.1b"><ci id="Thmthm1.p1.1.1.m1.1.1.cmml" xref="Thmthm1.p1.1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.1.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.1.1.m1.1d">italic_h</annotation></semantics></math> and <math alttext="d_{a}" class="ltx_Math" display="inline" id="Thmthm1.p1.2.2.m2.1"><semantics id="Thmthm1.p1.2.2.m2.1a"><msub id="Thmthm1.p1.2.2.m2.1.1" xref="Thmthm1.p1.2.2.m2.1.1.cmml"><mi id="Thmthm1.p1.2.2.m2.1.1.2" xref="Thmthm1.p1.2.2.m2.1.1.2.cmml">d</mi><mi id="Thmthm1.p1.2.2.m2.1.1.3" xref="Thmthm1.p1.2.2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.2.2.m2.1b"><apply id="Thmthm1.p1.2.2.m2.1.1.cmml" xref="Thmthm1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.2.2.m2.1.1.1.cmml" xref="Thmthm1.p1.2.2.m2.1.1">subscript</csymbol><ci id="Thmthm1.p1.2.2.m2.1.1.2.cmml" xref="Thmthm1.p1.2.2.m2.1.1.2">𝑑</ci><ci id="Thmthm1.p1.2.2.m2.1.1.3.cmml" xref="Thmthm1.p1.2.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.2.2.m2.1c">d_{a}</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.2.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and any permutation matrix <math alttext="P_{\pi}" class="ltx_Math" display="inline" id="Thmthm1.p1.3.3.m3.1"><semantics id="Thmthm1.p1.3.3.m3.1a"><msub id="Thmthm1.p1.3.3.m3.1.1" xref="Thmthm1.p1.3.3.m3.1.1.cmml"><mi id="Thmthm1.p1.3.3.m3.1.1.2" xref="Thmthm1.p1.3.3.m3.1.1.2.cmml">P</mi><mi id="Thmthm1.p1.3.3.m3.1.1.3" xref="Thmthm1.p1.3.3.m3.1.1.3.cmml">π</mi></msub><annotation-xml encoding="MathML-Content" id="Thmthm1.p1.3.3.m3.1b"><apply id="Thmthm1.p1.3.3.m3.1.1.cmml" xref="Thmthm1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmthm1.p1.3.3.m3.1.1.1.cmml" xref="Thmthm1.p1.3.3.m3.1.1">subscript</csymbol><ci id="Thmthm1.p1.3.3.m3.1.1.2.cmml" xref="Thmthm1.p1.3.3.m3.1.1.2">𝑃</ci><ci id="Thmthm1.p1.3.3.m3.1.1.3.cmml" xref="Thmthm1.p1.3.3.m3.1.1.3">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm1.p1.3.3.m3.1c">P_{\pi}</annotation><annotation encoding="application/x-llamapun" id="Thmthm1.p1.3.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT</annotation></semantics></math>, we have</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{MultiHead}(P_{\pi}Q,P_{\pi}K,P_{\pi}V)=P_{\pi}\operatorname{%
MultiHead}(Q,K,V)." class="ltx_Math" display="block" id="S2.Ex2.m1.6"><semantics id="S2.Ex2.m1.6a"><mrow id="S2.Ex2.m1.6.6.1" xref="S2.Ex2.m1.6.6.1.1.cmml"><mrow id="S2.Ex2.m1.6.6.1.1" xref="S2.Ex2.m1.6.6.1.1.cmml"><mrow id="S2.Ex2.m1.6.6.1.1.3.3" xref="S2.Ex2.m1.6.6.1.1.3.4.cmml"><mi id="S2.Ex2.m1.1.1" xref="S2.Ex2.m1.1.1.cmml">MultiHead</mi><mo id="S2.Ex2.m1.6.6.1.1.3.3a" xref="S2.Ex2.m1.6.6.1.1.3.4.cmml">⁡</mo><mrow id="S2.Ex2.m1.6.6.1.1.3.3.3" xref="S2.Ex2.m1.6.6.1.1.3.4.cmml"><mo id="S2.Ex2.m1.6.6.1.1.3.3.3.4" stretchy="false" xref="S2.Ex2.m1.6.6.1.1.3.4.cmml">(</mo><mrow id="S2.Ex2.m1.6.6.1.1.1.1.1.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.cmml"><msub id="S2.Ex2.m1.6.6.1.1.1.1.1.1.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.2.cmml">P</mi><mi id="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.3" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.3.cmml">π</mi></msub><mo id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.Ex2.m1.6.6.1.1.1.1.1.1.3" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.3.cmml">Q</mi></mrow><mo id="S2.Ex2.m1.6.6.1.1.3.3.3.5" xref="S2.Ex2.m1.6.6.1.1.3.4.cmml">,</mo><mrow id="S2.Ex2.m1.6.6.1.1.2.2.2.2" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.cmml"><msub id="S2.Ex2.m1.6.6.1.1.2.2.2.2.2" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.cmml"><mi id="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.2" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.2.cmml">P</mi><mi id="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.3" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.3.cmml">π</mi></msub><mo id="S2.Ex2.m1.6.6.1.1.2.2.2.2.1" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.1.cmml">⁢</mo><mi id="S2.Ex2.m1.6.6.1.1.2.2.2.2.3" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.3.cmml">K</mi></mrow><mo id="S2.Ex2.m1.6.6.1.1.3.3.3.6" xref="S2.Ex2.m1.6.6.1.1.3.4.cmml">,</mo><mrow id="S2.Ex2.m1.6.6.1.1.3.3.3.3" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.cmml"><msub id="S2.Ex2.m1.6.6.1.1.3.3.3.3.2" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.cmml"><mi id="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.2" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.2.cmml">P</mi><mi id="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.3" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.3.cmml">π</mi></msub><mo id="S2.Ex2.m1.6.6.1.1.3.3.3.3.1" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.Ex2.m1.6.6.1.1.3.3.3.3.3" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.3.cmml">V</mi></mrow><mo id="S2.Ex2.m1.6.6.1.1.3.3.3.7" stretchy="false" xref="S2.Ex2.m1.6.6.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="S2.Ex2.m1.6.6.1.1.4" xref="S2.Ex2.m1.6.6.1.1.4.cmml">=</mo><mrow id="S2.Ex2.m1.6.6.1.1.5" xref="S2.Ex2.m1.6.6.1.1.5.cmml"><msub id="S2.Ex2.m1.6.6.1.1.5.2" xref="S2.Ex2.m1.6.6.1.1.5.2.cmml"><mi id="S2.Ex2.m1.6.6.1.1.5.2.2" xref="S2.Ex2.m1.6.6.1.1.5.2.2.cmml">P</mi><mi id="S2.Ex2.m1.6.6.1.1.5.2.3" xref="S2.Ex2.m1.6.6.1.1.5.2.3.cmml">π</mi></msub><mo id="S2.Ex2.m1.6.6.1.1.5.1" lspace="0.167em" xref="S2.Ex2.m1.6.6.1.1.5.1.cmml">⁢</mo><mrow id="S2.Ex2.m1.6.6.1.1.5.3.2" xref="S2.Ex2.m1.6.6.1.1.5.3.1.cmml"><mi id="S2.Ex2.m1.2.2" xref="S2.Ex2.m1.2.2.cmml">MultiHead</mi><mo id="S2.Ex2.m1.6.6.1.1.5.3.2a" xref="S2.Ex2.m1.6.6.1.1.5.3.1.cmml">⁡</mo><mrow id="S2.Ex2.m1.6.6.1.1.5.3.2.1" xref="S2.Ex2.m1.6.6.1.1.5.3.1.cmml"><mo id="S2.Ex2.m1.6.6.1.1.5.3.2.1.1" stretchy="false" xref="S2.Ex2.m1.6.6.1.1.5.3.1.cmml">(</mo><mi id="S2.Ex2.m1.3.3" xref="S2.Ex2.m1.3.3.cmml">Q</mi><mo id="S2.Ex2.m1.6.6.1.1.5.3.2.1.2" xref="S2.Ex2.m1.6.6.1.1.5.3.1.cmml">,</mo><mi id="S2.Ex2.m1.4.4" xref="S2.Ex2.m1.4.4.cmml">K</mi><mo id="S2.Ex2.m1.6.6.1.1.5.3.2.1.3" xref="S2.Ex2.m1.6.6.1.1.5.3.1.cmml">,</mo><mi id="S2.Ex2.m1.5.5" xref="S2.Ex2.m1.5.5.cmml">V</mi><mo id="S2.Ex2.m1.6.6.1.1.5.3.2.1.4" stretchy="false" xref="S2.Ex2.m1.6.6.1.1.5.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex2.m1.6.6.1.2" lspace="0em" xref="S2.Ex2.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.6b"><apply id="S2.Ex2.m1.6.6.1.1.cmml" xref="S2.Ex2.m1.6.6.1"><eq id="S2.Ex2.m1.6.6.1.1.4.cmml" xref="S2.Ex2.m1.6.6.1.1.4"></eq><apply id="S2.Ex2.m1.6.6.1.1.3.4.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3"><ci id="S2.Ex2.m1.1.1.cmml" xref="S2.Ex2.m1.1.1">MultiHead</ci><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1"><times id="S2.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.1"></times><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.2">𝑃</ci><ci id="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.2.3">𝜋</ci></apply><ci id="S2.Ex2.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.1.3">𝑄</ci></apply><apply id="S2.Ex2.m1.6.6.1.1.2.2.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2"><times id="S2.Ex2.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.1"></times><apply id="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.2">𝑃</ci><ci id="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.3.cmml" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.2.3">𝜋</ci></apply><ci id="S2.Ex2.m1.6.6.1.1.2.2.2.2.3.cmml" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.3">𝐾</ci></apply><apply id="S2.Ex2.m1.6.6.1.1.3.3.3.3.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3"><times id="S2.Ex2.m1.6.6.1.1.3.3.3.3.1.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.1"></times><apply id="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.2">subscript</csymbol><ci id="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.2">𝑃</ci><ci id="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.3.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.2.3">𝜋</ci></apply><ci id="S2.Ex2.m1.6.6.1.1.3.3.3.3.3.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.3">𝑉</ci></apply></apply><apply id="S2.Ex2.m1.6.6.1.1.5.cmml" xref="S2.Ex2.m1.6.6.1.1.5"><times id="S2.Ex2.m1.6.6.1.1.5.1.cmml" xref="S2.Ex2.m1.6.6.1.1.5.1"></times><apply id="S2.Ex2.m1.6.6.1.1.5.2.cmml" xref="S2.Ex2.m1.6.6.1.1.5.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.5.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.5.2">subscript</csymbol><ci id="S2.Ex2.m1.6.6.1.1.5.2.2.cmml" xref="S2.Ex2.m1.6.6.1.1.5.2.2">𝑃</ci><ci id="S2.Ex2.m1.6.6.1.1.5.2.3.cmml" xref="S2.Ex2.m1.6.6.1.1.5.2.3">𝜋</ci></apply><apply id="S2.Ex2.m1.6.6.1.1.5.3.1.cmml" xref="S2.Ex2.m1.6.6.1.1.5.3.2"><ci id="S2.Ex2.m1.2.2.cmml" xref="S2.Ex2.m1.2.2">MultiHead</ci><ci id="S2.Ex2.m1.3.3.cmml" xref="S2.Ex2.m1.3.3">𝑄</ci><ci id="S2.Ex2.m1.4.4.cmml" xref="S2.Ex2.m1.4.4">𝐾</ci><ci id="S2.Ex2.m1.5.5.cmml" xref="S2.Ex2.m1.5.5">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.6c">\operatorname{MultiHead}(P_{\pi}Q,P_{\pi}K,P_{\pi}V)=P_{\pi}\operatorname{%
MultiHead}(Q,K,V).</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.6d">roman_MultiHead ( italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_Q , italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_K , italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_V ) = italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT roman_MultiHead ( italic_Q , italic_K , italic_V ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof" id="S2.SS1.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS1.1.p1">
<p class="ltx_p" id="S2.SS1.1.p1.1">We first prove the proposition for <math alttext="h=1" class="ltx_Math" display="inline" id="S2.SS1.1.p1.1.m1.1"><semantics id="S2.SS1.1.p1.1.m1.1a"><mrow id="S2.SS1.1.p1.1.m1.1.1" xref="S2.SS1.1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.1.p1.1.m1.1.1.2" xref="S2.SS1.1.p1.1.m1.1.1.2.cmml">h</mi><mo id="S2.SS1.1.p1.1.m1.1.1.1" xref="S2.SS1.1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S2.SS1.1.p1.1.m1.1.1.3" xref="S2.SS1.1.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.1.m1.1b"><apply id="S2.SS1.1.p1.1.m1.1.1.cmml" xref="S2.SS1.1.p1.1.m1.1.1"><eq id="S2.SS1.1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.1.p1.1.m1.1.1.1"></eq><ci id="S2.SS1.1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.1.p1.1.m1.1.1.2">ℎ</ci><cn id="S2.SS1.1.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS1.1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.1.m1.1c">h=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.1.m1.1d">italic_h = 1</annotation></semantics></math>, that is, we show that</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{FullAttn}(P_{\pi}Q,P_{\pi}K,P_{\pi}V)=P_{\pi}\operatorname{%
FullAttn}(Q,K,V)" class="ltx_Math" display="block" id="S2.Ex3.m1.8"><semantics id="S2.Ex3.m1.8a"><mrow id="S2.Ex3.m1.8.8" xref="S2.Ex3.m1.8.8.cmml"><mrow id="S2.Ex3.m1.8.8.3.3" xref="S2.Ex3.m1.8.8.3.4.cmml"><mi id="S2.Ex3.m1.1.1" xref="S2.Ex3.m1.1.1.cmml">FullAttn</mi><mo id="S2.Ex3.m1.8.8.3.3a" xref="S2.Ex3.m1.8.8.3.4.cmml">⁡</mo><mrow id="S2.Ex3.m1.8.8.3.3.3" xref="S2.Ex3.m1.8.8.3.4.cmml"><mo id="S2.Ex3.m1.8.8.3.3.3.4" stretchy="false" xref="S2.Ex3.m1.8.8.3.4.cmml">(</mo><mrow id="S2.Ex3.m1.6.6.1.1.1.1" xref="S2.Ex3.m1.6.6.1.1.1.1.cmml"><msub id="S2.Ex3.m1.6.6.1.1.1.1.2" xref="S2.Ex3.m1.6.6.1.1.1.1.2.cmml"><mi id="S2.Ex3.m1.6.6.1.1.1.1.2.2" xref="S2.Ex3.m1.6.6.1.1.1.1.2.2.cmml">P</mi><mi id="S2.Ex3.m1.6.6.1.1.1.1.2.3" xref="S2.Ex3.m1.6.6.1.1.1.1.2.3.cmml">π</mi></msub><mo id="S2.Ex3.m1.6.6.1.1.1.1.1" xref="S2.Ex3.m1.6.6.1.1.1.1.1.cmml">⁢</mo><mi id="S2.Ex3.m1.6.6.1.1.1.1.3" xref="S2.Ex3.m1.6.6.1.1.1.1.3.cmml">Q</mi></mrow><mo id="S2.Ex3.m1.8.8.3.3.3.5" xref="S2.Ex3.m1.8.8.3.4.cmml">,</mo><mrow id="S2.Ex3.m1.7.7.2.2.2.2" xref="S2.Ex3.m1.7.7.2.2.2.2.cmml"><msub id="S2.Ex3.m1.7.7.2.2.2.2.2" xref="S2.Ex3.m1.7.7.2.2.2.2.2.cmml"><mi id="S2.Ex3.m1.7.7.2.2.2.2.2.2" xref="S2.Ex3.m1.7.7.2.2.2.2.2.2.cmml">P</mi><mi id="S2.Ex3.m1.7.7.2.2.2.2.2.3" xref="S2.Ex3.m1.7.7.2.2.2.2.2.3.cmml">π</mi></msub><mo id="S2.Ex3.m1.7.7.2.2.2.2.1" xref="S2.Ex3.m1.7.7.2.2.2.2.1.cmml">⁢</mo><mi id="S2.Ex3.m1.7.7.2.2.2.2.3" xref="S2.Ex3.m1.7.7.2.2.2.2.3.cmml">K</mi></mrow><mo id="S2.Ex3.m1.8.8.3.3.3.6" xref="S2.Ex3.m1.8.8.3.4.cmml">,</mo><mrow id="S2.Ex3.m1.8.8.3.3.3.3" xref="S2.Ex3.m1.8.8.3.3.3.3.cmml"><msub id="S2.Ex3.m1.8.8.3.3.3.3.2" xref="S2.Ex3.m1.8.8.3.3.3.3.2.cmml"><mi id="S2.Ex3.m1.8.8.3.3.3.3.2.2" xref="S2.Ex3.m1.8.8.3.3.3.3.2.2.cmml">P</mi><mi id="S2.Ex3.m1.8.8.3.3.3.3.2.3" xref="S2.Ex3.m1.8.8.3.3.3.3.2.3.cmml">π</mi></msub><mo id="S2.Ex3.m1.8.8.3.3.3.3.1" xref="S2.Ex3.m1.8.8.3.3.3.3.1.cmml">⁢</mo><mi id="S2.Ex3.m1.8.8.3.3.3.3.3" xref="S2.Ex3.m1.8.8.3.3.3.3.3.cmml">V</mi></mrow><mo id="S2.Ex3.m1.8.8.3.3.3.7" stretchy="false" xref="S2.Ex3.m1.8.8.3.4.cmml">)</mo></mrow></mrow><mo id="S2.Ex3.m1.8.8.4" xref="S2.Ex3.m1.8.8.4.cmml">=</mo><mrow id="S2.Ex3.m1.8.8.5" xref="S2.Ex3.m1.8.8.5.cmml"><msub id="S2.Ex3.m1.8.8.5.2" xref="S2.Ex3.m1.8.8.5.2.cmml"><mi id="S2.Ex3.m1.8.8.5.2.2" xref="S2.Ex3.m1.8.8.5.2.2.cmml">P</mi><mi id="S2.Ex3.m1.8.8.5.2.3" xref="S2.Ex3.m1.8.8.5.2.3.cmml">π</mi></msub><mo id="S2.Ex3.m1.8.8.5.1" lspace="0.167em" xref="S2.Ex3.m1.8.8.5.1.cmml">⁢</mo><mrow id="S2.Ex3.m1.8.8.5.3.2" xref="S2.Ex3.m1.8.8.5.3.1.cmml"><mi id="S2.Ex3.m1.2.2" xref="S2.Ex3.m1.2.2.cmml">FullAttn</mi><mo id="S2.Ex3.m1.8.8.5.3.2a" xref="S2.Ex3.m1.8.8.5.3.1.cmml">⁡</mo><mrow id="S2.Ex3.m1.8.8.5.3.2.1" xref="S2.Ex3.m1.8.8.5.3.1.cmml"><mo id="S2.Ex3.m1.8.8.5.3.2.1.1" stretchy="false" xref="S2.Ex3.m1.8.8.5.3.1.cmml">(</mo><mi id="S2.Ex3.m1.3.3" xref="S2.Ex3.m1.3.3.cmml">Q</mi><mo id="S2.Ex3.m1.8.8.5.3.2.1.2" xref="S2.Ex3.m1.8.8.5.3.1.cmml">,</mo><mi id="S2.Ex3.m1.4.4" xref="S2.Ex3.m1.4.4.cmml">K</mi><mo id="S2.Ex3.m1.8.8.5.3.2.1.3" xref="S2.Ex3.m1.8.8.5.3.1.cmml">,</mo><mi id="S2.Ex3.m1.5.5" xref="S2.Ex3.m1.5.5.cmml">V</mi><mo id="S2.Ex3.m1.8.8.5.3.2.1.4" stretchy="false" xref="S2.Ex3.m1.8.8.5.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.8b"><apply id="S2.Ex3.m1.8.8.cmml" xref="S2.Ex3.m1.8.8"><eq id="S2.Ex3.m1.8.8.4.cmml" xref="S2.Ex3.m1.8.8.4"></eq><apply id="S2.Ex3.m1.8.8.3.4.cmml" xref="S2.Ex3.m1.8.8.3.3"><ci id="S2.Ex3.m1.1.1.cmml" xref="S2.Ex3.m1.1.1">FullAttn</ci><apply id="S2.Ex3.m1.6.6.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1"><times id="S2.Ex3.m1.6.6.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1"></times><apply id="S2.Ex3.m1.6.6.1.1.1.1.2.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.1.1.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.1.1.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.2.2">𝑃</ci><ci id="S2.Ex3.m1.6.6.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.2.3">𝜋</ci></apply><ci id="S2.Ex3.m1.6.6.1.1.1.1.3.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.3">𝑄</ci></apply><apply id="S2.Ex3.m1.7.7.2.2.2.2.cmml" xref="S2.Ex3.m1.7.7.2.2.2.2"><times id="S2.Ex3.m1.7.7.2.2.2.2.1.cmml" xref="S2.Ex3.m1.7.7.2.2.2.2.1"></times><apply id="S2.Ex3.m1.7.7.2.2.2.2.2.cmml" xref="S2.Ex3.m1.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.7.7.2.2.2.2.2.1.cmml" xref="S2.Ex3.m1.7.7.2.2.2.2.2">subscript</csymbol><ci id="S2.Ex3.m1.7.7.2.2.2.2.2.2.cmml" xref="S2.Ex3.m1.7.7.2.2.2.2.2.2">𝑃</ci><ci id="S2.Ex3.m1.7.7.2.2.2.2.2.3.cmml" xref="S2.Ex3.m1.7.7.2.2.2.2.2.3">𝜋</ci></apply><ci id="S2.Ex3.m1.7.7.2.2.2.2.3.cmml" xref="S2.Ex3.m1.7.7.2.2.2.2.3">𝐾</ci></apply><apply id="S2.Ex3.m1.8.8.3.3.3.3.cmml" xref="S2.Ex3.m1.8.8.3.3.3.3"><times id="S2.Ex3.m1.8.8.3.3.3.3.1.cmml" xref="S2.Ex3.m1.8.8.3.3.3.3.1"></times><apply id="S2.Ex3.m1.8.8.3.3.3.3.2.cmml" xref="S2.Ex3.m1.8.8.3.3.3.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.8.8.3.3.3.3.2.1.cmml" xref="S2.Ex3.m1.8.8.3.3.3.3.2">subscript</csymbol><ci id="S2.Ex3.m1.8.8.3.3.3.3.2.2.cmml" xref="S2.Ex3.m1.8.8.3.3.3.3.2.2">𝑃</ci><ci id="S2.Ex3.m1.8.8.3.3.3.3.2.3.cmml" xref="S2.Ex3.m1.8.8.3.3.3.3.2.3">𝜋</ci></apply><ci id="S2.Ex3.m1.8.8.3.3.3.3.3.cmml" xref="S2.Ex3.m1.8.8.3.3.3.3.3">𝑉</ci></apply></apply><apply id="S2.Ex3.m1.8.8.5.cmml" xref="S2.Ex3.m1.8.8.5"><times id="S2.Ex3.m1.8.8.5.1.cmml" xref="S2.Ex3.m1.8.8.5.1"></times><apply id="S2.Ex3.m1.8.8.5.2.cmml" xref="S2.Ex3.m1.8.8.5.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.8.8.5.2.1.cmml" xref="S2.Ex3.m1.8.8.5.2">subscript</csymbol><ci id="S2.Ex3.m1.8.8.5.2.2.cmml" xref="S2.Ex3.m1.8.8.5.2.2">𝑃</ci><ci id="S2.Ex3.m1.8.8.5.2.3.cmml" xref="S2.Ex3.m1.8.8.5.2.3">𝜋</ci></apply><apply id="S2.Ex3.m1.8.8.5.3.1.cmml" xref="S2.Ex3.m1.8.8.5.3.2"><ci id="S2.Ex3.m1.2.2.cmml" xref="S2.Ex3.m1.2.2">FullAttn</ci><ci id="S2.Ex3.m1.3.3.cmml" xref="S2.Ex3.m1.3.3">𝑄</ci><ci id="S2.Ex3.m1.4.4.cmml" xref="S2.Ex3.m1.4.4">𝐾</ci><ci id="S2.Ex3.m1.5.5.cmml" xref="S2.Ex3.m1.5.5">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.8c">\operatorname{FullAttn}(P_{\pi}Q,P_{\pi}K,P_{\pi}V)=P_{\pi}\operatorname{%
FullAttn}(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m1.8d">roman_FullAttn ( italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_Q , italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_K , italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_V ) = italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT roman_FullAttn ( italic_Q , italic_K , italic_V )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.1.p1.11">Let <math alttext="a_{i,j}" class="ltx_Math" display="inline" id="S2.SS1.1.p1.2.m1.2"><semantics id="S2.SS1.1.p1.2.m1.2a"><msub id="S2.SS1.1.p1.2.m1.2.3" xref="S2.SS1.1.p1.2.m1.2.3.cmml"><mi id="S2.SS1.1.p1.2.m1.2.3.2" xref="S2.SS1.1.p1.2.m1.2.3.2.cmml">a</mi><mrow id="S2.SS1.1.p1.2.m1.2.2.2.4" xref="S2.SS1.1.p1.2.m1.2.2.2.3.cmml"><mi id="S2.SS1.1.p1.2.m1.1.1.1.1" xref="S2.SS1.1.p1.2.m1.1.1.1.1.cmml">i</mi><mo id="S2.SS1.1.p1.2.m1.2.2.2.4.1" xref="S2.SS1.1.p1.2.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS1.1.p1.2.m1.2.2.2.2" xref="S2.SS1.1.p1.2.m1.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.2.m1.2b"><apply id="S2.SS1.1.p1.2.m1.2.3.cmml" xref="S2.SS1.1.p1.2.m1.2.3"><csymbol cd="ambiguous" id="S2.SS1.1.p1.2.m1.2.3.1.cmml" xref="S2.SS1.1.p1.2.m1.2.3">subscript</csymbol><ci id="S2.SS1.1.p1.2.m1.2.3.2.cmml" xref="S2.SS1.1.p1.2.m1.2.3.2">𝑎</ci><list id="S2.SS1.1.p1.2.m1.2.2.2.3.cmml" xref="S2.SS1.1.p1.2.m1.2.2.2.4"><ci id="S2.SS1.1.p1.2.m1.1.1.1.1.cmml" xref="S2.SS1.1.p1.2.m1.1.1.1.1">𝑖</ci><ci id="S2.SS1.1.p1.2.m1.2.2.2.2.cmml" xref="S2.SS1.1.p1.2.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.2.m1.2c">a_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.2.m1.2d">italic_a start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\hat{a}_{i,j}" class="ltx_Math" display="inline" id="S2.SS1.1.p1.3.m2.2"><semantics id="S2.SS1.1.p1.3.m2.2a"><msub id="S2.SS1.1.p1.3.m2.2.3" xref="S2.SS1.1.p1.3.m2.2.3.cmml"><mover accent="true" id="S2.SS1.1.p1.3.m2.2.3.2" xref="S2.SS1.1.p1.3.m2.2.3.2.cmml"><mi id="S2.SS1.1.p1.3.m2.2.3.2.2" xref="S2.SS1.1.p1.3.m2.2.3.2.2.cmml">a</mi><mo id="S2.SS1.1.p1.3.m2.2.3.2.1" xref="S2.SS1.1.p1.3.m2.2.3.2.1.cmml">^</mo></mover><mrow id="S2.SS1.1.p1.3.m2.2.2.2.4" xref="S2.SS1.1.p1.3.m2.2.2.2.3.cmml"><mi id="S2.SS1.1.p1.3.m2.1.1.1.1" xref="S2.SS1.1.p1.3.m2.1.1.1.1.cmml">i</mi><mo id="S2.SS1.1.p1.3.m2.2.2.2.4.1" xref="S2.SS1.1.p1.3.m2.2.2.2.3.cmml">,</mo><mi id="S2.SS1.1.p1.3.m2.2.2.2.2" xref="S2.SS1.1.p1.3.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.3.m2.2b"><apply id="S2.SS1.1.p1.3.m2.2.3.cmml" xref="S2.SS1.1.p1.3.m2.2.3"><csymbol cd="ambiguous" id="S2.SS1.1.p1.3.m2.2.3.1.cmml" xref="S2.SS1.1.p1.3.m2.2.3">subscript</csymbol><apply id="S2.SS1.1.p1.3.m2.2.3.2.cmml" xref="S2.SS1.1.p1.3.m2.2.3.2"><ci id="S2.SS1.1.p1.3.m2.2.3.2.1.cmml" xref="S2.SS1.1.p1.3.m2.2.3.2.1">^</ci><ci id="S2.SS1.1.p1.3.m2.2.3.2.2.cmml" xref="S2.SS1.1.p1.3.m2.2.3.2.2">𝑎</ci></apply><list id="S2.SS1.1.p1.3.m2.2.2.2.3.cmml" xref="S2.SS1.1.p1.3.m2.2.2.2.4"><ci id="S2.SS1.1.p1.3.m2.1.1.1.1.cmml" xref="S2.SS1.1.p1.3.m2.1.1.1.1">𝑖</ci><ci id="S2.SS1.1.p1.3.m2.2.2.2.2.cmml" xref="S2.SS1.1.p1.3.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.3.m2.2c">\hat{a}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.3.m2.2d">over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> be the attention scores for the original inputs and the permuted inputs, respectively. Note that <math alttext="(P_{\pi}Q)(P_{\pi}K)^{T}=P_{\pi}QK^{T}P_{\pi}^{T}" class="ltx_Math" display="inline" id="S2.SS1.1.p1.4.m3.2"><semantics id="S2.SS1.1.p1.4.m3.2a"><mrow id="S2.SS1.1.p1.4.m3.2.2" xref="S2.SS1.1.p1.4.m3.2.2.cmml"><mrow id="S2.SS1.1.p1.4.m3.2.2.2" xref="S2.SS1.1.p1.4.m3.2.2.2.cmml"><mrow id="S2.SS1.1.p1.4.m3.1.1.1.1.1" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.cmml"><mo id="S2.SS1.1.p1.4.m3.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.cmml"><msub id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.2" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.2.cmml">P</mi><mi id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.3" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.3.cmml">π</mi></msub><mo id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.1" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.3" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.3.cmml">Q</mi></mrow><mo id="S2.SS1.1.p1.4.m3.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS1.1.p1.4.m3.2.2.2.3" xref="S2.SS1.1.p1.4.m3.2.2.2.3.cmml">⁢</mo><msup id="S2.SS1.1.p1.4.m3.2.2.2.2" xref="S2.SS1.1.p1.4.m3.2.2.2.2.cmml"><mrow id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.cmml"><mo id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.2" stretchy="false" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.cmml"><msub id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.cmml"><mi id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.2" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.2.cmml">P</mi><mi id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.3" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.3.cmml">π</mi></msub><mo id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.1" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.3" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.3.cmml">K</mi></mrow><mo id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.3" stretchy="false" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S2.SS1.1.p1.4.m3.2.2.2.2.3" xref="S2.SS1.1.p1.4.m3.2.2.2.2.3.cmml">T</mi></msup></mrow><mo id="S2.SS1.1.p1.4.m3.2.2.3" xref="S2.SS1.1.p1.4.m3.2.2.3.cmml">=</mo><mrow id="S2.SS1.1.p1.4.m3.2.2.4" xref="S2.SS1.1.p1.4.m3.2.2.4.cmml"><msub id="S2.SS1.1.p1.4.m3.2.2.4.2" xref="S2.SS1.1.p1.4.m3.2.2.4.2.cmml"><mi id="S2.SS1.1.p1.4.m3.2.2.4.2.2" xref="S2.SS1.1.p1.4.m3.2.2.4.2.2.cmml">P</mi><mi id="S2.SS1.1.p1.4.m3.2.2.4.2.3" xref="S2.SS1.1.p1.4.m3.2.2.4.2.3.cmml">π</mi></msub><mo id="S2.SS1.1.p1.4.m3.2.2.4.1" xref="S2.SS1.1.p1.4.m3.2.2.4.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.4.m3.2.2.4.3" xref="S2.SS1.1.p1.4.m3.2.2.4.3.cmml">Q</mi><mo id="S2.SS1.1.p1.4.m3.2.2.4.1a" xref="S2.SS1.1.p1.4.m3.2.2.4.1.cmml">⁢</mo><msup id="S2.SS1.1.p1.4.m3.2.2.4.4" xref="S2.SS1.1.p1.4.m3.2.2.4.4.cmml"><mi id="S2.SS1.1.p1.4.m3.2.2.4.4.2" xref="S2.SS1.1.p1.4.m3.2.2.4.4.2.cmml">K</mi><mi id="S2.SS1.1.p1.4.m3.2.2.4.4.3" xref="S2.SS1.1.p1.4.m3.2.2.4.4.3.cmml">T</mi></msup><mo id="S2.SS1.1.p1.4.m3.2.2.4.1b" xref="S2.SS1.1.p1.4.m3.2.2.4.1.cmml">⁢</mo><msubsup id="S2.SS1.1.p1.4.m3.2.2.4.5" xref="S2.SS1.1.p1.4.m3.2.2.4.5.cmml"><mi id="S2.SS1.1.p1.4.m3.2.2.4.5.2.2" xref="S2.SS1.1.p1.4.m3.2.2.4.5.2.2.cmml">P</mi><mi id="S2.SS1.1.p1.4.m3.2.2.4.5.2.3" xref="S2.SS1.1.p1.4.m3.2.2.4.5.2.3.cmml">π</mi><mi id="S2.SS1.1.p1.4.m3.2.2.4.5.3" xref="S2.SS1.1.p1.4.m3.2.2.4.5.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.4.m3.2b"><apply id="S2.SS1.1.p1.4.m3.2.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2"><eq id="S2.SS1.1.p1.4.m3.2.2.3.cmml" xref="S2.SS1.1.p1.4.m3.2.2.3"></eq><apply id="S2.SS1.1.p1.4.m3.2.2.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2"><times id="S2.SS1.1.p1.4.m3.2.2.2.3.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.3"></times><apply id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1"><times id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.1"></times><apply id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.2">𝑃</ci><ci id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.2.3">𝜋</ci></apply><ci id="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.3.cmml" xref="S2.SS1.1.p1.4.m3.1.1.1.1.1.1.3">𝑄</ci></apply><apply id="S2.SS1.1.p1.4.m3.2.2.2.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.4.m3.2.2.2.2.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.2">superscript</csymbol><apply id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1"><times id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.1.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.1"></times><apply id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.1.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.2">𝑃</ci><ci id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.3.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.2.3">𝜋</ci></apply><ci id="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.3.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.2.1.1.1.3">𝐾</ci></apply><ci id="S2.SS1.1.p1.4.m3.2.2.2.2.3.cmml" xref="S2.SS1.1.p1.4.m3.2.2.2.2.3">𝑇</ci></apply></apply><apply id="S2.SS1.1.p1.4.m3.2.2.4.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4"><times id="S2.SS1.1.p1.4.m3.2.2.4.1.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.1"></times><apply id="S2.SS1.1.p1.4.m3.2.2.4.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.4.m3.2.2.4.2.1.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.2">subscript</csymbol><ci id="S2.SS1.1.p1.4.m3.2.2.4.2.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.2.2">𝑃</ci><ci id="S2.SS1.1.p1.4.m3.2.2.4.2.3.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.2.3">𝜋</ci></apply><ci id="S2.SS1.1.p1.4.m3.2.2.4.3.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.3">𝑄</ci><apply id="S2.SS1.1.p1.4.m3.2.2.4.4.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.4"><csymbol cd="ambiguous" id="S2.SS1.1.p1.4.m3.2.2.4.4.1.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.4">superscript</csymbol><ci id="S2.SS1.1.p1.4.m3.2.2.4.4.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.4.2">𝐾</ci><ci id="S2.SS1.1.p1.4.m3.2.2.4.4.3.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.4.3">𝑇</ci></apply><apply id="S2.SS1.1.p1.4.m3.2.2.4.5.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.5"><csymbol cd="ambiguous" id="S2.SS1.1.p1.4.m3.2.2.4.5.1.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.5">superscript</csymbol><apply id="S2.SS1.1.p1.4.m3.2.2.4.5.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.5"><csymbol cd="ambiguous" id="S2.SS1.1.p1.4.m3.2.2.4.5.2.1.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.5">subscript</csymbol><ci id="S2.SS1.1.p1.4.m3.2.2.4.5.2.2.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.5.2.2">𝑃</ci><ci id="S2.SS1.1.p1.4.m3.2.2.4.5.2.3.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.5.2.3">𝜋</ci></apply><ci id="S2.SS1.1.p1.4.m3.2.2.4.5.3.cmml" xref="S2.SS1.1.p1.4.m3.2.2.4.5.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.4.m3.2c">(P_{\pi}Q)(P_{\pi}K)^{T}=P_{\pi}QK^{T}P_{\pi}^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.4.m3.2d">( italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_Q ) ( italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_K ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT = italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>. That is, <math alttext="\hat{a}_{i,j}=a_{\pi(i),\pi(j)}" class="ltx_Math" display="inline" id="S2.SS1.1.p1.5.m4.6"><semantics id="S2.SS1.1.p1.5.m4.6a"><mrow id="S2.SS1.1.p1.5.m4.6.7" xref="S2.SS1.1.p1.5.m4.6.7.cmml"><msub id="S2.SS1.1.p1.5.m4.6.7.2" xref="S2.SS1.1.p1.5.m4.6.7.2.cmml"><mover accent="true" id="S2.SS1.1.p1.5.m4.6.7.2.2" xref="S2.SS1.1.p1.5.m4.6.7.2.2.cmml"><mi id="S2.SS1.1.p1.5.m4.6.7.2.2.2" xref="S2.SS1.1.p1.5.m4.6.7.2.2.2.cmml">a</mi><mo id="S2.SS1.1.p1.5.m4.6.7.2.2.1" xref="S2.SS1.1.p1.5.m4.6.7.2.2.1.cmml">^</mo></mover><mrow id="S2.SS1.1.p1.5.m4.2.2.2.4" xref="S2.SS1.1.p1.5.m4.2.2.2.3.cmml"><mi id="S2.SS1.1.p1.5.m4.1.1.1.1" xref="S2.SS1.1.p1.5.m4.1.1.1.1.cmml">i</mi><mo id="S2.SS1.1.p1.5.m4.2.2.2.4.1" xref="S2.SS1.1.p1.5.m4.2.2.2.3.cmml">,</mo><mi id="S2.SS1.1.p1.5.m4.2.2.2.2" xref="S2.SS1.1.p1.5.m4.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S2.SS1.1.p1.5.m4.6.7.1" xref="S2.SS1.1.p1.5.m4.6.7.1.cmml">=</mo><msub id="S2.SS1.1.p1.5.m4.6.7.3" xref="S2.SS1.1.p1.5.m4.6.7.3.cmml"><mi id="S2.SS1.1.p1.5.m4.6.7.3.2" xref="S2.SS1.1.p1.5.m4.6.7.3.2.cmml">a</mi><mrow id="S2.SS1.1.p1.5.m4.6.6.4.4" xref="S2.SS1.1.p1.5.m4.6.6.4.5.cmml"><mrow id="S2.SS1.1.p1.5.m4.5.5.3.3.1" xref="S2.SS1.1.p1.5.m4.5.5.3.3.1.cmml"><mi id="S2.SS1.1.p1.5.m4.5.5.3.3.1.2" xref="S2.SS1.1.p1.5.m4.5.5.3.3.1.2.cmml">π</mi><mo id="S2.SS1.1.p1.5.m4.5.5.3.3.1.1" xref="S2.SS1.1.p1.5.m4.5.5.3.3.1.1.cmml">⁢</mo><mrow id="S2.SS1.1.p1.5.m4.5.5.3.3.1.3.2" xref="S2.SS1.1.p1.5.m4.5.5.3.3.1.cmml"><mo id="S2.SS1.1.p1.5.m4.5.5.3.3.1.3.2.1" stretchy="false" xref="S2.SS1.1.p1.5.m4.5.5.3.3.1.cmml">(</mo><mi id="S2.SS1.1.p1.5.m4.3.3.1.1" xref="S2.SS1.1.p1.5.m4.3.3.1.1.cmml">i</mi><mo id="S2.SS1.1.p1.5.m4.5.5.3.3.1.3.2.2" stretchy="false" xref="S2.SS1.1.p1.5.m4.5.5.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.1.p1.5.m4.6.6.4.4.3" xref="S2.SS1.1.p1.5.m4.6.6.4.5.cmml">,</mo><mrow id="S2.SS1.1.p1.5.m4.6.6.4.4.2" xref="S2.SS1.1.p1.5.m4.6.6.4.4.2.cmml"><mi id="S2.SS1.1.p1.5.m4.6.6.4.4.2.2" xref="S2.SS1.1.p1.5.m4.6.6.4.4.2.2.cmml">π</mi><mo id="S2.SS1.1.p1.5.m4.6.6.4.4.2.1" xref="S2.SS1.1.p1.5.m4.6.6.4.4.2.1.cmml">⁢</mo><mrow id="S2.SS1.1.p1.5.m4.6.6.4.4.2.3.2" xref="S2.SS1.1.p1.5.m4.6.6.4.4.2.cmml"><mo id="S2.SS1.1.p1.5.m4.6.6.4.4.2.3.2.1" stretchy="false" xref="S2.SS1.1.p1.5.m4.6.6.4.4.2.cmml">(</mo><mi id="S2.SS1.1.p1.5.m4.4.4.2.2" xref="S2.SS1.1.p1.5.m4.4.4.2.2.cmml">j</mi><mo id="S2.SS1.1.p1.5.m4.6.6.4.4.2.3.2.2" stretchy="false" xref="S2.SS1.1.p1.5.m4.6.6.4.4.2.cmml">)</mo></mrow></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.5.m4.6b"><apply id="S2.SS1.1.p1.5.m4.6.7.cmml" xref="S2.SS1.1.p1.5.m4.6.7"><eq id="S2.SS1.1.p1.5.m4.6.7.1.cmml" xref="S2.SS1.1.p1.5.m4.6.7.1"></eq><apply id="S2.SS1.1.p1.5.m4.6.7.2.cmml" xref="S2.SS1.1.p1.5.m4.6.7.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.5.m4.6.7.2.1.cmml" xref="S2.SS1.1.p1.5.m4.6.7.2">subscript</csymbol><apply id="S2.SS1.1.p1.5.m4.6.7.2.2.cmml" xref="S2.SS1.1.p1.5.m4.6.7.2.2"><ci id="S2.SS1.1.p1.5.m4.6.7.2.2.1.cmml" xref="S2.SS1.1.p1.5.m4.6.7.2.2.1">^</ci><ci id="S2.SS1.1.p1.5.m4.6.7.2.2.2.cmml" xref="S2.SS1.1.p1.5.m4.6.7.2.2.2">𝑎</ci></apply><list id="S2.SS1.1.p1.5.m4.2.2.2.3.cmml" xref="S2.SS1.1.p1.5.m4.2.2.2.4"><ci id="S2.SS1.1.p1.5.m4.1.1.1.1.cmml" xref="S2.SS1.1.p1.5.m4.1.1.1.1">𝑖</ci><ci id="S2.SS1.1.p1.5.m4.2.2.2.2.cmml" xref="S2.SS1.1.p1.5.m4.2.2.2.2">𝑗</ci></list></apply><apply id="S2.SS1.1.p1.5.m4.6.7.3.cmml" xref="S2.SS1.1.p1.5.m4.6.7.3"><csymbol cd="ambiguous" id="S2.SS1.1.p1.5.m4.6.7.3.1.cmml" xref="S2.SS1.1.p1.5.m4.6.7.3">subscript</csymbol><ci id="S2.SS1.1.p1.5.m4.6.7.3.2.cmml" xref="S2.SS1.1.p1.5.m4.6.7.3.2">𝑎</ci><list id="S2.SS1.1.p1.5.m4.6.6.4.5.cmml" xref="S2.SS1.1.p1.5.m4.6.6.4.4"><apply id="S2.SS1.1.p1.5.m4.5.5.3.3.1.cmml" xref="S2.SS1.1.p1.5.m4.5.5.3.3.1"><times id="S2.SS1.1.p1.5.m4.5.5.3.3.1.1.cmml" xref="S2.SS1.1.p1.5.m4.5.5.3.3.1.1"></times><ci id="S2.SS1.1.p1.5.m4.5.5.3.3.1.2.cmml" xref="S2.SS1.1.p1.5.m4.5.5.3.3.1.2">𝜋</ci><ci id="S2.SS1.1.p1.5.m4.3.3.1.1.cmml" xref="S2.SS1.1.p1.5.m4.3.3.1.1">𝑖</ci></apply><apply id="S2.SS1.1.p1.5.m4.6.6.4.4.2.cmml" xref="S2.SS1.1.p1.5.m4.6.6.4.4.2"><times id="S2.SS1.1.p1.5.m4.6.6.4.4.2.1.cmml" xref="S2.SS1.1.p1.5.m4.6.6.4.4.2.1"></times><ci id="S2.SS1.1.p1.5.m4.6.6.4.4.2.2.cmml" xref="S2.SS1.1.p1.5.m4.6.6.4.4.2.2">𝜋</ci><ci id="S2.SS1.1.p1.5.m4.4.4.2.2.cmml" xref="S2.SS1.1.p1.5.m4.4.4.2.2">𝑗</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.5.m4.6c">\hat{a}_{i,j}=a_{\pi(i),\pi(j)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.5.m4.6d">over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = italic_a start_POSTSUBSCRIPT italic_π ( italic_i ) , italic_π ( italic_j ) end_POSTSUBSCRIPT</annotation></semantics></math>. Thus, the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.1.p1.6.m5.1"><semantics id="S2.SS1.1.p1.6.m5.1a"><mi id="S2.SS1.1.p1.6.m5.1.1" xref="S2.SS1.1.p1.6.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.6.m5.1b"><ci id="S2.SS1.1.p1.6.m5.1.1.cmml" xref="S2.SS1.1.p1.6.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.6.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.6.m5.1d">italic_i</annotation></semantics></math>-th row of <math alttext="\operatorname{FullAttn}(P_{\pi}Q,P_{\pi}K,P_{\pi}V)" class="ltx_Math" display="inline" id="S2.SS1.1.p1.7.m6.4"><semantics id="S2.SS1.1.p1.7.m6.4a"><mrow id="S2.SS1.1.p1.7.m6.4.4.3" xref="S2.SS1.1.p1.7.m6.4.4.4.cmml"><mi id="S2.SS1.1.p1.7.m6.1.1" xref="S2.SS1.1.p1.7.m6.1.1.cmml">FullAttn</mi><mo id="S2.SS1.1.p1.7.m6.4.4.3a" xref="S2.SS1.1.p1.7.m6.4.4.4.cmml">⁡</mo><mrow id="S2.SS1.1.p1.7.m6.4.4.3.3" xref="S2.SS1.1.p1.7.m6.4.4.4.cmml"><mo id="S2.SS1.1.p1.7.m6.4.4.3.3.4" stretchy="false" xref="S2.SS1.1.p1.7.m6.4.4.4.cmml">(</mo><mrow id="S2.SS1.1.p1.7.m6.2.2.1.1.1" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.cmml"><msub id="S2.SS1.1.p1.7.m6.2.2.1.1.1.2" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.cmml"><mi id="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.2" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.2.cmml">P</mi><mi id="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.3" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.3.cmml">π</mi></msub><mo id="S2.SS1.1.p1.7.m6.2.2.1.1.1.1" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.7.m6.2.2.1.1.1.3" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.3.cmml">Q</mi></mrow><mo id="S2.SS1.1.p1.7.m6.4.4.3.3.5" xref="S2.SS1.1.p1.7.m6.4.4.4.cmml">,</mo><mrow id="S2.SS1.1.p1.7.m6.3.3.2.2.2" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.cmml"><msub id="S2.SS1.1.p1.7.m6.3.3.2.2.2.2" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.cmml"><mi id="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.2" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.2.cmml">P</mi><mi id="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.3" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.3.cmml">π</mi></msub><mo id="S2.SS1.1.p1.7.m6.3.3.2.2.2.1" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.7.m6.3.3.2.2.2.3" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.3.cmml">K</mi></mrow><mo id="S2.SS1.1.p1.7.m6.4.4.3.3.6" xref="S2.SS1.1.p1.7.m6.4.4.4.cmml">,</mo><mrow id="S2.SS1.1.p1.7.m6.4.4.3.3.3" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.cmml"><msub id="S2.SS1.1.p1.7.m6.4.4.3.3.3.2" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.cmml"><mi id="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.2" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.2.cmml">P</mi><mi id="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.3" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.3.cmml">π</mi></msub><mo id="S2.SS1.1.p1.7.m6.4.4.3.3.3.1" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.7.m6.4.4.3.3.3.3" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.3.cmml">V</mi></mrow><mo id="S2.SS1.1.p1.7.m6.4.4.3.3.7" stretchy="false" xref="S2.SS1.1.p1.7.m6.4.4.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.7.m6.4b"><apply id="S2.SS1.1.p1.7.m6.4.4.4.cmml" xref="S2.SS1.1.p1.7.m6.4.4.3"><ci id="S2.SS1.1.p1.7.m6.1.1.cmml" xref="S2.SS1.1.p1.7.m6.1.1">FullAttn</ci><apply id="S2.SS1.1.p1.7.m6.2.2.1.1.1.cmml" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1"><times id="S2.SS1.1.p1.7.m6.2.2.1.1.1.1.cmml" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.1"></times><apply id="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.cmml" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.1.cmml" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.2">subscript</csymbol><ci id="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.2.cmml" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.2">𝑃</ci><ci id="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.3.cmml" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.2.3">𝜋</ci></apply><ci id="S2.SS1.1.p1.7.m6.2.2.1.1.1.3.cmml" xref="S2.SS1.1.p1.7.m6.2.2.1.1.1.3">𝑄</ci></apply><apply id="S2.SS1.1.p1.7.m6.3.3.2.2.2.cmml" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2"><times id="S2.SS1.1.p1.7.m6.3.3.2.2.2.1.cmml" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.1"></times><apply id="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.cmml" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.1.cmml" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.2">subscript</csymbol><ci id="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.2.cmml" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.2">𝑃</ci><ci id="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.3.cmml" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.2.3">𝜋</ci></apply><ci id="S2.SS1.1.p1.7.m6.3.3.2.2.2.3.cmml" xref="S2.SS1.1.p1.7.m6.3.3.2.2.2.3">𝐾</ci></apply><apply id="S2.SS1.1.p1.7.m6.4.4.3.3.3.cmml" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3"><times id="S2.SS1.1.p1.7.m6.4.4.3.3.3.1.cmml" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.1"></times><apply id="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.cmml" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.1.cmml" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.2">subscript</csymbol><ci id="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.2.cmml" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.2">𝑃</ci><ci id="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.3.cmml" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.2.3">𝜋</ci></apply><ci id="S2.SS1.1.p1.7.m6.4.4.3.3.3.3.cmml" xref="S2.SS1.1.p1.7.m6.4.4.3.3.3.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.7.m6.4c">\operatorname{FullAttn}(P_{\pi}Q,P_{\pi}K,P_{\pi}V)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.7.m6.4d">roman_FullAttn ( italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_Q , italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_K , italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_V )</annotation></semantics></math> is the vector <math alttext="\sum_{j=1}^{n}a_{\pi(i),\pi(j)}V_{\pi(j)}=\sum_{j=1}^{n}a_{\pi(i),j}V_{j}" class="ltx_Math" display="inline" id="S2.SS1.1.p1.8.m7.8"><semantics id="S2.SS1.1.p1.8.m7.8a"><mrow id="S2.SS1.1.p1.8.m7.8.9" xref="S2.SS1.1.p1.8.m7.8.9.cmml"><mrow id="S2.SS1.1.p1.8.m7.8.9.2" xref="S2.SS1.1.p1.8.m7.8.9.2.cmml"><msubsup id="S2.SS1.1.p1.8.m7.8.9.2.1" xref="S2.SS1.1.p1.8.m7.8.9.2.1.cmml"><mo id="S2.SS1.1.p1.8.m7.8.9.2.1.2.2" xref="S2.SS1.1.p1.8.m7.8.9.2.1.2.2.cmml">∑</mo><mrow id="S2.SS1.1.p1.8.m7.8.9.2.1.2.3" xref="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.cmml"><mi id="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.2" xref="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.2.cmml">j</mi><mo id="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.1" xref="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.1.cmml">=</mo><mn id="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.3" xref="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS1.1.p1.8.m7.8.9.2.1.3" xref="S2.SS1.1.p1.8.m7.8.9.2.1.3.cmml">n</mi></msubsup><mrow id="S2.SS1.1.p1.8.m7.8.9.2.2" xref="S2.SS1.1.p1.8.m7.8.9.2.2.cmml"><msub id="S2.SS1.1.p1.8.m7.8.9.2.2.2" xref="S2.SS1.1.p1.8.m7.8.9.2.2.2.cmml"><mi id="S2.SS1.1.p1.8.m7.8.9.2.2.2.2" xref="S2.SS1.1.p1.8.m7.8.9.2.2.2.2.cmml">a</mi><mrow id="S2.SS1.1.p1.8.m7.4.4.4.4" xref="S2.SS1.1.p1.8.m7.4.4.4.5.cmml"><mrow id="S2.SS1.1.p1.8.m7.3.3.3.3.1" xref="S2.SS1.1.p1.8.m7.3.3.3.3.1.cmml"><mi id="S2.SS1.1.p1.8.m7.3.3.3.3.1.2" xref="S2.SS1.1.p1.8.m7.3.3.3.3.1.2.cmml">π</mi><mo id="S2.SS1.1.p1.8.m7.3.3.3.3.1.1" xref="S2.SS1.1.p1.8.m7.3.3.3.3.1.1.cmml">⁢</mo><mrow id="S2.SS1.1.p1.8.m7.3.3.3.3.1.3.2" xref="S2.SS1.1.p1.8.m7.3.3.3.3.1.cmml"><mo id="S2.SS1.1.p1.8.m7.3.3.3.3.1.3.2.1" stretchy="false" xref="S2.SS1.1.p1.8.m7.3.3.3.3.1.cmml">(</mo><mi id="S2.SS1.1.p1.8.m7.1.1.1.1" xref="S2.SS1.1.p1.8.m7.1.1.1.1.cmml">i</mi><mo id="S2.SS1.1.p1.8.m7.3.3.3.3.1.3.2.2" stretchy="false" xref="S2.SS1.1.p1.8.m7.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.1.p1.8.m7.4.4.4.4.3" xref="S2.SS1.1.p1.8.m7.4.4.4.5.cmml">,</mo><mrow id="S2.SS1.1.p1.8.m7.4.4.4.4.2" xref="S2.SS1.1.p1.8.m7.4.4.4.4.2.cmml"><mi id="S2.SS1.1.p1.8.m7.4.4.4.4.2.2" xref="S2.SS1.1.p1.8.m7.4.4.4.4.2.2.cmml">π</mi><mo id="S2.SS1.1.p1.8.m7.4.4.4.4.2.1" xref="S2.SS1.1.p1.8.m7.4.4.4.4.2.1.cmml">⁢</mo><mrow id="S2.SS1.1.p1.8.m7.4.4.4.4.2.3.2" xref="S2.SS1.1.p1.8.m7.4.4.4.4.2.cmml"><mo id="S2.SS1.1.p1.8.m7.4.4.4.4.2.3.2.1" stretchy="false" xref="S2.SS1.1.p1.8.m7.4.4.4.4.2.cmml">(</mo><mi id="S2.SS1.1.p1.8.m7.2.2.2.2" xref="S2.SS1.1.p1.8.m7.2.2.2.2.cmml">j</mi><mo id="S2.SS1.1.p1.8.m7.4.4.4.4.2.3.2.2" stretchy="false" xref="S2.SS1.1.p1.8.m7.4.4.4.4.2.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S2.SS1.1.p1.8.m7.8.9.2.2.1" xref="S2.SS1.1.p1.8.m7.8.9.2.2.1.cmml">⁢</mo><msub id="S2.SS1.1.p1.8.m7.8.9.2.2.3" xref="S2.SS1.1.p1.8.m7.8.9.2.2.3.cmml"><mi id="S2.SS1.1.p1.8.m7.8.9.2.2.3.2" xref="S2.SS1.1.p1.8.m7.8.9.2.2.3.2.cmml">V</mi><mrow id="S2.SS1.1.p1.8.m7.5.5.1" xref="S2.SS1.1.p1.8.m7.5.5.1.cmml"><mi id="S2.SS1.1.p1.8.m7.5.5.1.3" xref="S2.SS1.1.p1.8.m7.5.5.1.3.cmml">π</mi><mo id="S2.SS1.1.p1.8.m7.5.5.1.2" xref="S2.SS1.1.p1.8.m7.5.5.1.2.cmml">⁢</mo><mrow id="S2.SS1.1.p1.8.m7.5.5.1.4.2" xref="S2.SS1.1.p1.8.m7.5.5.1.cmml"><mo id="S2.SS1.1.p1.8.m7.5.5.1.4.2.1" stretchy="false" xref="S2.SS1.1.p1.8.m7.5.5.1.cmml">(</mo><mi id="S2.SS1.1.p1.8.m7.5.5.1.1" xref="S2.SS1.1.p1.8.m7.5.5.1.1.cmml">j</mi><mo id="S2.SS1.1.p1.8.m7.5.5.1.4.2.2" stretchy="false" xref="S2.SS1.1.p1.8.m7.5.5.1.cmml">)</mo></mrow></mrow></msub></mrow></mrow><mo id="S2.SS1.1.p1.8.m7.8.9.1" rspace="0.111em" xref="S2.SS1.1.p1.8.m7.8.9.1.cmml">=</mo><mrow id="S2.SS1.1.p1.8.m7.8.9.3" xref="S2.SS1.1.p1.8.m7.8.9.3.cmml"><msubsup id="S2.SS1.1.p1.8.m7.8.9.3.1" xref="S2.SS1.1.p1.8.m7.8.9.3.1.cmml"><mo id="S2.SS1.1.p1.8.m7.8.9.3.1.2.2" xref="S2.SS1.1.p1.8.m7.8.9.3.1.2.2.cmml">∑</mo><mrow id="S2.SS1.1.p1.8.m7.8.9.3.1.2.3" xref="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.cmml"><mi id="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.2" xref="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.2.cmml">j</mi><mo id="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.1" xref="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.1.cmml">=</mo><mn id="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.3" xref="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS1.1.p1.8.m7.8.9.3.1.3" xref="S2.SS1.1.p1.8.m7.8.9.3.1.3.cmml">n</mi></msubsup><mrow id="S2.SS1.1.p1.8.m7.8.9.3.2" xref="S2.SS1.1.p1.8.m7.8.9.3.2.cmml"><msub id="S2.SS1.1.p1.8.m7.8.9.3.2.2" xref="S2.SS1.1.p1.8.m7.8.9.3.2.2.cmml"><mi id="S2.SS1.1.p1.8.m7.8.9.3.2.2.2" xref="S2.SS1.1.p1.8.m7.8.9.3.2.2.2.cmml">a</mi><mrow id="S2.SS1.1.p1.8.m7.8.8.3.3" xref="S2.SS1.1.p1.8.m7.8.8.3.4.cmml"><mrow id="S2.SS1.1.p1.8.m7.8.8.3.3.1" xref="S2.SS1.1.p1.8.m7.8.8.3.3.1.cmml"><mi id="S2.SS1.1.p1.8.m7.8.8.3.3.1.2" xref="S2.SS1.1.p1.8.m7.8.8.3.3.1.2.cmml">π</mi><mo id="S2.SS1.1.p1.8.m7.8.8.3.3.1.1" xref="S2.SS1.1.p1.8.m7.8.8.3.3.1.1.cmml">⁢</mo><mrow id="S2.SS1.1.p1.8.m7.8.8.3.3.1.3.2" xref="S2.SS1.1.p1.8.m7.8.8.3.3.1.cmml"><mo id="S2.SS1.1.p1.8.m7.8.8.3.3.1.3.2.1" stretchy="false" xref="S2.SS1.1.p1.8.m7.8.8.3.3.1.cmml">(</mo><mi id="S2.SS1.1.p1.8.m7.6.6.1.1" xref="S2.SS1.1.p1.8.m7.6.6.1.1.cmml">i</mi><mo id="S2.SS1.1.p1.8.m7.8.8.3.3.1.3.2.2" stretchy="false" xref="S2.SS1.1.p1.8.m7.8.8.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.1.p1.8.m7.8.8.3.3.2" xref="S2.SS1.1.p1.8.m7.8.8.3.4.cmml">,</mo><mi id="S2.SS1.1.p1.8.m7.7.7.2.2" xref="S2.SS1.1.p1.8.m7.7.7.2.2.cmml">j</mi></mrow></msub><mo id="S2.SS1.1.p1.8.m7.8.9.3.2.1" xref="S2.SS1.1.p1.8.m7.8.9.3.2.1.cmml">⁢</mo><msub id="S2.SS1.1.p1.8.m7.8.9.3.2.3" xref="S2.SS1.1.p1.8.m7.8.9.3.2.3.cmml"><mi id="S2.SS1.1.p1.8.m7.8.9.3.2.3.2" xref="S2.SS1.1.p1.8.m7.8.9.3.2.3.2.cmml">V</mi><mi id="S2.SS1.1.p1.8.m7.8.9.3.2.3.3" xref="S2.SS1.1.p1.8.m7.8.9.3.2.3.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.8.m7.8b"><apply id="S2.SS1.1.p1.8.m7.8.9.cmml" xref="S2.SS1.1.p1.8.m7.8.9"><eq id="S2.SS1.1.p1.8.m7.8.9.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.1"></eq><apply id="S2.SS1.1.p1.8.m7.8.9.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2"><apply id="S2.SS1.1.p1.8.m7.8.9.2.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.1"><csymbol cd="ambiguous" id="S2.SS1.1.p1.8.m7.8.9.2.1.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.1">superscript</csymbol><apply id="S2.SS1.1.p1.8.m7.8.9.2.1.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.1"><csymbol cd="ambiguous" id="S2.SS1.1.p1.8.m7.8.9.2.1.2.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.1">subscript</csymbol><sum id="S2.SS1.1.p1.8.m7.8.9.2.1.2.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.1.2.2"></sum><apply id="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.1.2.3"><eq id="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.1"></eq><ci id="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.2">𝑗</ci><cn id="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.3.cmml" type="integer" xref="S2.SS1.1.p1.8.m7.8.9.2.1.2.3.3">1</cn></apply></apply><ci id="S2.SS1.1.p1.8.m7.8.9.2.1.3.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.1.3">𝑛</ci></apply><apply id="S2.SS1.1.p1.8.m7.8.9.2.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.2"><times id="S2.SS1.1.p1.8.m7.8.9.2.2.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.2.1"></times><apply id="S2.SS1.1.p1.8.m7.8.9.2.2.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.8.m7.8.9.2.2.2.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.2.2">subscript</csymbol><ci id="S2.SS1.1.p1.8.m7.8.9.2.2.2.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.2.2.2">𝑎</ci><list id="S2.SS1.1.p1.8.m7.4.4.4.5.cmml" xref="S2.SS1.1.p1.8.m7.4.4.4.4"><apply id="S2.SS1.1.p1.8.m7.3.3.3.3.1.cmml" xref="S2.SS1.1.p1.8.m7.3.3.3.3.1"><times id="S2.SS1.1.p1.8.m7.3.3.3.3.1.1.cmml" xref="S2.SS1.1.p1.8.m7.3.3.3.3.1.1"></times><ci id="S2.SS1.1.p1.8.m7.3.3.3.3.1.2.cmml" xref="S2.SS1.1.p1.8.m7.3.3.3.3.1.2">𝜋</ci><ci id="S2.SS1.1.p1.8.m7.1.1.1.1.cmml" xref="S2.SS1.1.p1.8.m7.1.1.1.1">𝑖</ci></apply><apply id="S2.SS1.1.p1.8.m7.4.4.4.4.2.cmml" xref="S2.SS1.1.p1.8.m7.4.4.4.4.2"><times id="S2.SS1.1.p1.8.m7.4.4.4.4.2.1.cmml" xref="S2.SS1.1.p1.8.m7.4.4.4.4.2.1"></times><ci id="S2.SS1.1.p1.8.m7.4.4.4.4.2.2.cmml" xref="S2.SS1.1.p1.8.m7.4.4.4.4.2.2">𝜋</ci><ci id="S2.SS1.1.p1.8.m7.2.2.2.2.cmml" xref="S2.SS1.1.p1.8.m7.2.2.2.2">𝑗</ci></apply></list></apply><apply id="S2.SS1.1.p1.8.m7.8.9.2.2.3.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.1.p1.8.m7.8.9.2.2.3.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.2.3">subscript</csymbol><ci id="S2.SS1.1.p1.8.m7.8.9.2.2.3.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.2.2.3.2">𝑉</ci><apply id="S2.SS1.1.p1.8.m7.5.5.1.cmml" xref="S2.SS1.1.p1.8.m7.5.5.1"><times id="S2.SS1.1.p1.8.m7.5.5.1.2.cmml" xref="S2.SS1.1.p1.8.m7.5.5.1.2"></times><ci id="S2.SS1.1.p1.8.m7.5.5.1.3.cmml" xref="S2.SS1.1.p1.8.m7.5.5.1.3">𝜋</ci><ci id="S2.SS1.1.p1.8.m7.5.5.1.1.cmml" xref="S2.SS1.1.p1.8.m7.5.5.1.1">𝑗</ci></apply></apply></apply></apply><apply id="S2.SS1.1.p1.8.m7.8.9.3.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3"><apply id="S2.SS1.1.p1.8.m7.8.9.3.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.1"><csymbol cd="ambiguous" id="S2.SS1.1.p1.8.m7.8.9.3.1.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.1">superscript</csymbol><apply id="S2.SS1.1.p1.8.m7.8.9.3.1.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.1"><csymbol cd="ambiguous" id="S2.SS1.1.p1.8.m7.8.9.3.1.2.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.1">subscript</csymbol><sum id="S2.SS1.1.p1.8.m7.8.9.3.1.2.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.1.2.2"></sum><apply id="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.1.2.3"><eq id="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.1"></eq><ci id="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.2">𝑗</ci><cn id="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.3.cmml" type="integer" xref="S2.SS1.1.p1.8.m7.8.9.3.1.2.3.3">1</cn></apply></apply><ci id="S2.SS1.1.p1.8.m7.8.9.3.1.3.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.1.3">𝑛</ci></apply><apply id="S2.SS1.1.p1.8.m7.8.9.3.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.2"><times id="S2.SS1.1.p1.8.m7.8.9.3.2.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.2.1"></times><apply id="S2.SS1.1.p1.8.m7.8.9.3.2.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.8.m7.8.9.3.2.2.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.2.2">subscript</csymbol><ci id="S2.SS1.1.p1.8.m7.8.9.3.2.2.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.2.2.2">𝑎</ci><list id="S2.SS1.1.p1.8.m7.8.8.3.4.cmml" xref="S2.SS1.1.p1.8.m7.8.8.3.3"><apply id="S2.SS1.1.p1.8.m7.8.8.3.3.1.cmml" xref="S2.SS1.1.p1.8.m7.8.8.3.3.1"><times id="S2.SS1.1.p1.8.m7.8.8.3.3.1.1.cmml" xref="S2.SS1.1.p1.8.m7.8.8.3.3.1.1"></times><ci id="S2.SS1.1.p1.8.m7.8.8.3.3.1.2.cmml" xref="S2.SS1.1.p1.8.m7.8.8.3.3.1.2">𝜋</ci><ci id="S2.SS1.1.p1.8.m7.6.6.1.1.cmml" xref="S2.SS1.1.p1.8.m7.6.6.1.1">𝑖</ci></apply><ci id="S2.SS1.1.p1.8.m7.7.7.2.2.cmml" xref="S2.SS1.1.p1.8.m7.7.7.2.2">𝑗</ci></list></apply><apply id="S2.SS1.1.p1.8.m7.8.9.3.2.3.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.2.3"><csymbol cd="ambiguous" id="S2.SS1.1.p1.8.m7.8.9.3.2.3.1.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.2.3">subscript</csymbol><ci id="S2.SS1.1.p1.8.m7.8.9.3.2.3.2.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.2.3.2">𝑉</ci><ci id="S2.SS1.1.p1.8.m7.8.9.3.2.3.3.cmml" xref="S2.SS1.1.p1.8.m7.8.9.3.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.8.m7.8c">\sum_{j=1}^{n}a_{\pi(i),\pi(j)}V_{\pi(j)}=\sum_{j=1}^{n}a_{\pi(i),j}V_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.8.m7.8d">∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_π ( italic_i ) , italic_π ( italic_j ) end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_π ( italic_j ) end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_π ( italic_i ) , italic_j end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> as we wanted. Finally, we note that <math alttext="\operatorname{Concat}(P_{\pi}head_{1},\ldots,P_{\pi}head_{h})W^{O}=P_{\pi}%
\operatorname{Concat}(head_{1},\ldots,head_{h})W^{O}" class="ltx_Math" display="inline" id="S2.SS1.1.p1.9.m8.8"><semantics id="S2.SS1.1.p1.9.m8.8a"><mrow id="S2.SS1.1.p1.9.m8.8.8" xref="S2.SS1.1.p1.9.m8.8.8.cmml"><mrow id="S2.SS1.1.p1.9.m8.6.6.2" xref="S2.SS1.1.p1.9.m8.6.6.2.cmml"><mrow id="S2.SS1.1.p1.9.m8.6.6.2.2.2" xref="S2.SS1.1.p1.9.m8.6.6.2.2.3.cmml"><mi id="S2.SS1.1.p1.9.m8.1.1" xref="S2.SS1.1.p1.9.m8.1.1.cmml">Concat</mi><mo id="S2.SS1.1.p1.9.m8.6.6.2.2.2a" xref="S2.SS1.1.p1.9.m8.6.6.2.2.3.cmml">⁡</mo><mrow id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2" xref="S2.SS1.1.p1.9.m8.6.6.2.2.3.cmml"><mo id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.3" stretchy="false" xref="S2.SS1.1.p1.9.m8.6.6.2.2.3.cmml">(</mo><mrow id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.cmml"><msub id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.cmml"><mi id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.2" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.2.cmml">P</mi><mi id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.3" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.3.cmml">π</mi></msub><mo id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.1" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.3" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.3.cmml">h</mi><mo id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.1a" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.4" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.4.cmml">e</mi><mo id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.1b" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.5" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.5.cmml">a</mi><mo id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.1c" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.cmml"><mi id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.2" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.2.cmml">d</mi><mn id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.3" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.3.cmml">1</mn></msub></mrow><mo id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.4" xref="S2.SS1.1.p1.9.m8.6.6.2.2.3.cmml">,</mo><mi id="S2.SS1.1.p1.9.m8.2.2" mathvariant="normal" xref="S2.SS1.1.p1.9.m8.2.2.cmml">…</mi><mo id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.5" xref="S2.SS1.1.p1.9.m8.6.6.2.2.3.cmml">,</mo><mrow id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.cmml"><msub id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.cmml"><mi id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.2" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.2.cmml">P</mi><mi id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.3" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.3.cmml">π</mi></msub><mo id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.1" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.3" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.3.cmml">h</mi><mo id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.1a" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.4" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.4.cmml">e</mi><mo id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.1b" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.5" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.5.cmml">a</mi><mo id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.1c" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.1.cmml">⁢</mo><msub id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.cmml"><mi id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.2" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.2.cmml">d</mi><mi id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.3" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.3.cmml">h</mi></msub></mrow><mo id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.6" stretchy="false" xref="S2.SS1.1.p1.9.m8.6.6.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS1.1.p1.9.m8.6.6.2.3" xref="S2.SS1.1.p1.9.m8.6.6.2.3.cmml">⁢</mo><msup id="S2.SS1.1.p1.9.m8.6.6.2.4" xref="S2.SS1.1.p1.9.m8.6.6.2.4.cmml"><mi id="S2.SS1.1.p1.9.m8.6.6.2.4.2" xref="S2.SS1.1.p1.9.m8.6.6.2.4.2.cmml">W</mi><mi id="S2.SS1.1.p1.9.m8.6.6.2.4.3" xref="S2.SS1.1.p1.9.m8.6.6.2.4.3.cmml">O</mi></msup></mrow><mo id="S2.SS1.1.p1.9.m8.8.8.5" xref="S2.SS1.1.p1.9.m8.8.8.5.cmml">=</mo><mrow id="S2.SS1.1.p1.9.m8.8.8.4" xref="S2.SS1.1.p1.9.m8.8.8.4.cmml"><msub id="S2.SS1.1.p1.9.m8.8.8.4.4" xref="S2.SS1.1.p1.9.m8.8.8.4.4.cmml"><mi id="S2.SS1.1.p1.9.m8.8.8.4.4.2" xref="S2.SS1.1.p1.9.m8.8.8.4.4.2.cmml">P</mi><mi id="S2.SS1.1.p1.9.m8.8.8.4.4.3" xref="S2.SS1.1.p1.9.m8.8.8.4.4.3.cmml">π</mi></msub><mo id="S2.SS1.1.p1.9.m8.8.8.4.3" lspace="0.167em" xref="S2.SS1.1.p1.9.m8.8.8.4.3.cmml">⁢</mo><mrow id="S2.SS1.1.p1.9.m8.8.8.4.2.2" xref="S2.SS1.1.p1.9.m8.8.8.4.2.3.cmml"><mi id="S2.SS1.1.p1.9.m8.3.3" xref="S2.SS1.1.p1.9.m8.3.3.cmml">Concat</mi><mo id="S2.SS1.1.p1.9.m8.8.8.4.2.2a" xref="S2.SS1.1.p1.9.m8.8.8.4.2.3.cmml">⁡</mo><mrow id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2" xref="S2.SS1.1.p1.9.m8.8.8.4.2.3.cmml"><mo id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.3" stretchy="false" xref="S2.SS1.1.p1.9.m8.8.8.4.2.3.cmml">(</mo><mrow id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.cmml"><mi id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.2" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.2.cmml">h</mi><mo id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.1" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.3" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.3.cmml">e</mi><mo id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.1a" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.4" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.4.cmml">a</mi><mo id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.1b" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.1.cmml">⁢</mo><msub id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.cmml"><mi id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.2" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.2.cmml">d</mi><mn id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.3" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.3.cmml">1</mn></msub></mrow><mo id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.4" xref="S2.SS1.1.p1.9.m8.8.8.4.2.3.cmml">,</mo><mi id="S2.SS1.1.p1.9.m8.4.4" mathvariant="normal" xref="S2.SS1.1.p1.9.m8.4.4.cmml">…</mi><mo id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.5" xref="S2.SS1.1.p1.9.m8.8.8.4.2.3.cmml">,</mo><mrow id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.cmml"><mi id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.2" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.2.cmml">h</mi><mo id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.1" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.3" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.3.cmml">e</mi><mo id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.1a" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.4" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.4.cmml">a</mi><mo id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.1b" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.1.cmml">⁢</mo><msub id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.cmml"><mi id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.2" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.2.cmml">d</mi><mi id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.3" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.3.cmml">h</mi></msub></mrow><mo id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.6" stretchy="false" xref="S2.SS1.1.p1.9.m8.8.8.4.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS1.1.p1.9.m8.8.8.4.3a" xref="S2.SS1.1.p1.9.m8.8.8.4.3.cmml">⁢</mo><msup id="S2.SS1.1.p1.9.m8.8.8.4.5" xref="S2.SS1.1.p1.9.m8.8.8.4.5.cmml"><mi id="S2.SS1.1.p1.9.m8.8.8.4.5.2" xref="S2.SS1.1.p1.9.m8.8.8.4.5.2.cmml">W</mi><mi id="S2.SS1.1.p1.9.m8.8.8.4.5.3" xref="S2.SS1.1.p1.9.m8.8.8.4.5.3.cmml">O</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.9.m8.8b"><apply id="S2.SS1.1.p1.9.m8.8.8.cmml" xref="S2.SS1.1.p1.9.m8.8.8"><eq id="S2.SS1.1.p1.9.m8.8.8.5.cmml" xref="S2.SS1.1.p1.9.m8.8.8.5"></eq><apply id="S2.SS1.1.p1.9.m8.6.6.2.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2"><times id="S2.SS1.1.p1.9.m8.6.6.2.3.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.3"></times><apply id="S2.SS1.1.p1.9.m8.6.6.2.2.3.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2"><ci id="S2.SS1.1.p1.9.m8.1.1.cmml" xref="S2.SS1.1.p1.9.m8.1.1">Concat</ci><apply id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1"><times id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.1.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.1"></times><apply id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.1.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.2.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.2">𝑃</ci><ci id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.3.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.2.3">𝜋</ci></apply><ci id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.3.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.3">ℎ</ci><ci id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.4.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.4">𝑒</ci><ci id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.5.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.5">𝑎</ci><apply id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.1.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6">subscript</csymbol><ci id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.2.cmml" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.2">𝑑</ci><cn id="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.3.cmml" type="integer" xref="S2.SS1.1.p1.9.m8.5.5.1.1.1.1.1.6.3">1</cn></apply></apply><ci id="S2.SS1.1.p1.9.m8.2.2.cmml" xref="S2.SS1.1.p1.9.m8.2.2">…</ci><apply id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2"><times id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.1.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.1"></times><apply id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.1.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.2.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.2">𝑃</ci><ci id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.3.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.2.3">𝜋</ci></apply><ci id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.3.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.3">ℎ</ci><ci id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.4.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.4">𝑒</ci><ci id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.5.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.5">𝑎</ci><apply id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.1.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6">subscript</csymbol><ci id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.2.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.2">𝑑</ci><ci id="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.3.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.2.2.2.2.6.3">ℎ</ci></apply></apply></apply><apply id="S2.SS1.1.p1.9.m8.6.6.2.4.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.4"><csymbol cd="ambiguous" id="S2.SS1.1.p1.9.m8.6.6.2.4.1.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.4">superscript</csymbol><ci id="S2.SS1.1.p1.9.m8.6.6.2.4.2.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.4.2">𝑊</ci><ci id="S2.SS1.1.p1.9.m8.6.6.2.4.3.cmml" xref="S2.SS1.1.p1.9.m8.6.6.2.4.3">𝑂</ci></apply></apply><apply id="S2.SS1.1.p1.9.m8.8.8.4.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4"><times id="S2.SS1.1.p1.9.m8.8.8.4.3.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.3"></times><apply id="S2.SS1.1.p1.9.m8.8.8.4.4.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.4"><csymbol cd="ambiguous" id="S2.SS1.1.p1.9.m8.8.8.4.4.1.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.4">subscript</csymbol><ci id="S2.SS1.1.p1.9.m8.8.8.4.4.2.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.4.2">𝑃</ci><ci id="S2.SS1.1.p1.9.m8.8.8.4.4.3.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.4.3">𝜋</ci></apply><apply id="S2.SS1.1.p1.9.m8.8.8.4.2.3.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2"><ci id="S2.SS1.1.p1.9.m8.3.3.cmml" xref="S2.SS1.1.p1.9.m8.3.3">Concat</ci><apply id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.cmml" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1"><times id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.1.cmml" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.1"></times><ci id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.2.cmml" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.2">ℎ</ci><ci id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.3.cmml" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.3">𝑒</ci><ci id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.4.cmml" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.4">𝑎</ci><apply id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.cmml" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.1.cmml" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5">subscript</csymbol><ci id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.2.cmml" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.2">𝑑</ci><cn id="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.3.cmml" type="integer" xref="S2.SS1.1.p1.9.m8.7.7.3.1.1.1.1.5.3">1</cn></apply></apply><ci id="S2.SS1.1.p1.9.m8.4.4.cmml" xref="S2.SS1.1.p1.9.m8.4.4">…</ci><apply id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2"><times id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.1.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.1"></times><ci id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.2.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.2">ℎ</ci><ci id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.3.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.3">𝑒</ci><ci id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.4.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.4">𝑎</ci><apply id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5"><csymbol cd="ambiguous" id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.1.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5">subscript</csymbol><ci id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.2.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.2">𝑑</ci><ci id="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.3.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.2.2.2.2.5.3">ℎ</ci></apply></apply></apply><apply id="S2.SS1.1.p1.9.m8.8.8.4.5.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.5"><csymbol cd="ambiguous" id="S2.SS1.1.p1.9.m8.8.8.4.5.1.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.5">superscript</csymbol><ci id="S2.SS1.1.p1.9.m8.8.8.4.5.2.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.5.2">𝑊</ci><ci id="S2.SS1.1.p1.9.m8.8.8.4.5.3.cmml" xref="S2.SS1.1.p1.9.m8.8.8.4.5.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.9.m8.8c">\operatorname{Concat}(P_{\pi}head_{1},\ldots,P_{\pi}head_{h})W^{O}=P_{\pi}%
\operatorname{Concat}(head_{1},\ldots,head_{h})W^{O}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.9.m8.8d">roman_Concat ( italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT = italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT roman_Concat ( italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT</annotation></semantics></math>, as the tensors <math alttext="head_{1},head_{2},\ldots,head_{h}" class="ltx_Math" display="inline" id="S2.SS1.1.p1.10.m9.4"><semantics id="S2.SS1.1.p1.10.m9.4a"><mrow id="S2.SS1.1.p1.10.m9.4.4.3" xref="S2.SS1.1.p1.10.m9.4.4.4.cmml"><mrow id="S2.SS1.1.p1.10.m9.2.2.1.1" xref="S2.SS1.1.p1.10.m9.2.2.1.1.cmml"><mi id="S2.SS1.1.p1.10.m9.2.2.1.1.2" xref="S2.SS1.1.p1.10.m9.2.2.1.1.2.cmml">h</mi><mo id="S2.SS1.1.p1.10.m9.2.2.1.1.1" xref="S2.SS1.1.p1.10.m9.2.2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.10.m9.2.2.1.1.3" xref="S2.SS1.1.p1.10.m9.2.2.1.1.3.cmml">e</mi><mo id="S2.SS1.1.p1.10.m9.2.2.1.1.1a" xref="S2.SS1.1.p1.10.m9.2.2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.10.m9.2.2.1.1.4" xref="S2.SS1.1.p1.10.m9.2.2.1.1.4.cmml">a</mi><mo id="S2.SS1.1.p1.10.m9.2.2.1.1.1b" xref="S2.SS1.1.p1.10.m9.2.2.1.1.1.cmml">⁢</mo><msub id="S2.SS1.1.p1.10.m9.2.2.1.1.5" xref="S2.SS1.1.p1.10.m9.2.2.1.1.5.cmml"><mi id="S2.SS1.1.p1.10.m9.2.2.1.1.5.2" xref="S2.SS1.1.p1.10.m9.2.2.1.1.5.2.cmml">d</mi><mn id="S2.SS1.1.p1.10.m9.2.2.1.1.5.3" xref="S2.SS1.1.p1.10.m9.2.2.1.1.5.3.cmml">1</mn></msub></mrow><mo id="S2.SS1.1.p1.10.m9.4.4.3.4" xref="S2.SS1.1.p1.10.m9.4.4.4.cmml">,</mo><mrow id="S2.SS1.1.p1.10.m9.3.3.2.2" xref="S2.SS1.1.p1.10.m9.3.3.2.2.cmml"><mi id="S2.SS1.1.p1.10.m9.3.3.2.2.2" xref="S2.SS1.1.p1.10.m9.3.3.2.2.2.cmml">h</mi><mo id="S2.SS1.1.p1.10.m9.3.3.2.2.1" xref="S2.SS1.1.p1.10.m9.3.3.2.2.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.10.m9.3.3.2.2.3" xref="S2.SS1.1.p1.10.m9.3.3.2.2.3.cmml">e</mi><mo id="S2.SS1.1.p1.10.m9.3.3.2.2.1a" xref="S2.SS1.1.p1.10.m9.3.3.2.2.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.10.m9.3.3.2.2.4" xref="S2.SS1.1.p1.10.m9.3.3.2.2.4.cmml">a</mi><mo id="S2.SS1.1.p1.10.m9.3.3.2.2.1b" xref="S2.SS1.1.p1.10.m9.3.3.2.2.1.cmml">⁢</mo><msub id="S2.SS1.1.p1.10.m9.3.3.2.2.5" xref="S2.SS1.1.p1.10.m9.3.3.2.2.5.cmml"><mi id="S2.SS1.1.p1.10.m9.3.3.2.2.5.2" xref="S2.SS1.1.p1.10.m9.3.3.2.2.5.2.cmml">d</mi><mn id="S2.SS1.1.p1.10.m9.3.3.2.2.5.3" xref="S2.SS1.1.p1.10.m9.3.3.2.2.5.3.cmml">2</mn></msub></mrow><mo id="S2.SS1.1.p1.10.m9.4.4.3.5" xref="S2.SS1.1.p1.10.m9.4.4.4.cmml">,</mo><mi id="S2.SS1.1.p1.10.m9.1.1" mathvariant="normal" xref="S2.SS1.1.p1.10.m9.1.1.cmml">…</mi><mo id="S2.SS1.1.p1.10.m9.4.4.3.6" xref="S2.SS1.1.p1.10.m9.4.4.4.cmml">,</mo><mrow id="S2.SS1.1.p1.10.m9.4.4.3.3" xref="S2.SS1.1.p1.10.m9.4.4.3.3.cmml"><mi id="S2.SS1.1.p1.10.m9.4.4.3.3.2" xref="S2.SS1.1.p1.10.m9.4.4.3.3.2.cmml">h</mi><mo id="S2.SS1.1.p1.10.m9.4.4.3.3.1" xref="S2.SS1.1.p1.10.m9.4.4.3.3.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.10.m9.4.4.3.3.3" xref="S2.SS1.1.p1.10.m9.4.4.3.3.3.cmml">e</mi><mo id="S2.SS1.1.p1.10.m9.4.4.3.3.1a" xref="S2.SS1.1.p1.10.m9.4.4.3.3.1.cmml">⁢</mo><mi id="S2.SS1.1.p1.10.m9.4.4.3.3.4" xref="S2.SS1.1.p1.10.m9.4.4.3.3.4.cmml">a</mi><mo id="S2.SS1.1.p1.10.m9.4.4.3.3.1b" xref="S2.SS1.1.p1.10.m9.4.4.3.3.1.cmml">⁢</mo><msub id="S2.SS1.1.p1.10.m9.4.4.3.3.5" xref="S2.SS1.1.p1.10.m9.4.4.3.3.5.cmml"><mi id="S2.SS1.1.p1.10.m9.4.4.3.3.5.2" xref="S2.SS1.1.p1.10.m9.4.4.3.3.5.2.cmml">d</mi><mi id="S2.SS1.1.p1.10.m9.4.4.3.3.5.3" xref="S2.SS1.1.p1.10.m9.4.4.3.3.5.3.cmml">h</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.10.m9.4b"><list id="S2.SS1.1.p1.10.m9.4.4.4.cmml" xref="S2.SS1.1.p1.10.m9.4.4.3"><apply id="S2.SS1.1.p1.10.m9.2.2.1.1.cmml" xref="S2.SS1.1.p1.10.m9.2.2.1.1"><times id="S2.SS1.1.p1.10.m9.2.2.1.1.1.cmml" xref="S2.SS1.1.p1.10.m9.2.2.1.1.1"></times><ci id="S2.SS1.1.p1.10.m9.2.2.1.1.2.cmml" xref="S2.SS1.1.p1.10.m9.2.2.1.1.2">ℎ</ci><ci id="S2.SS1.1.p1.10.m9.2.2.1.1.3.cmml" xref="S2.SS1.1.p1.10.m9.2.2.1.1.3">𝑒</ci><ci id="S2.SS1.1.p1.10.m9.2.2.1.1.4.cmml" xref="S2.SS1.1.p1.10.m9.2.2.1.1.4">𝑎</ci><apply id="S2.SS1.1.p1.10.m9.2.2.1.1.5.cmml" xref="S2.SS1.1.p1.10.m9.2.2.1.1.5"><csymbol cd="ambiguous" id="S2.SS1.1.p1.10.m9.2.2.1.1.5.1.cmml" xref="S2.SS1.1.p1.10.m9.2.2.1.1.5">subscript</csymbol><ci id="S2.SS1.1.p1.10.m9.2.2.1.1.5.2.cmml" xref="S2.SS1.1.p1.10.m9.2.2.1.1.5.2">𝑑</ci><cn id="S2.SS1.1.p1.10.m9.2.2.1.1.5.3.cmml" type="integer" xref="S2.SS1.1.p1.10.m9.2.2.1.1.5.3">1</cn></apply></apply><apply id="S2.SS1.1.p1.10.m9.3.3.2.2.cmml" xref="S2.SS1.1.p1.10.m9.3.3.2.2"><times id="S2.SS1.1.p1.10.m9.3.3.2.2.1.cmml" xref="S2.SS1.1.p1.10.m9.3.3.2.2.1"></times><ci id="S2.SS1.1.p1.10.m9.3.3.2.2.2.cmml" xref="S2.SS1.1.p1.10.m9.3.3.2.2.2">ℎ</ci><ci id="S2.SS1.1.p1.10.m9.3.3.2.2.3.cmml" xref="S2.SS1.1.p1.10.m9.3.3.2.2.3">𝑒</ci><ci id="S2.SS1.1.p1.10.m9.3.3.2.2.4.cmml" xref="S2.SS1.1.p1.10.m9.3.3.2.2.4">𝑎</ci><apply id="S2.SS1.1.p1.10.m9.3.3.2.2.5.cmml" xref="S2.SS1.1.p1.10.m9.3.3.2.2.5"><csymbol cd="ambiguous" id="S2.SS1.1.p1.10.m9.3.3.2.2.5.1.cmml" xref="S2.SS1.1.p1.10.m9.3.3.2.2.5">subscript</csymbol><ci id="S2.SS1.1.p1.10.m9.3.3.2.2.5.2.cmml" xref="S2.SS1.1.p1.10.m9.3.3.2.2.5.2">𝑑</ci><cn id="S2.SS1.1.p1.10.m9.3.3.2.2.5.3.cmml" type="integer" xref="S2.SS1.1.p1.10.m9.3.3.2.2.5.3">2</cn></apply></apply><ci id="S2.SS1.1.p1.10.m9.1.1.cmml" xref="S2.SS1.1.p1.10.m9.1.1">…</ci><apply id="S2.SS1.1.p1.10.m9.4.4.3.3.cmml" xref="S2.SS1.1.p1.10.m9.4.4.3.3"><times id="S2.SS1.1.p1.10.m9.4.4.3.3.1.cmml" xref="S2.SS1.1.p1.10.m9.4.4.3.3.1"></times><ci id="S2.SS1.1.p1.10.m9.4.4.3.3.2.cmml" xref="S2.SS1.1.p1.10.m9.4.4.3.3.2">ℎ</ci><ci id="S2.SS1.1.p1.10.m9.4.4.3.3.3.cmml" xref="S2.SS1.1.p1.10.m9.4.4.3.3.3">𝑒</ci><ci id="S2.SS1.1.p1.10.m9.4.4.3.3.4.cmml" xref="S2.SS1.1.p1.10.m9.4.4.3.3.4">𝑎</ci><apply id="S2.SS1.1.p1.10.m9.4.4.3.3.5.cmml" xref="S2.SS1.1.p1.10.m9.4.4.3.3.5"><csymbol cd="ambiguous" id="S2.SS1.1.p1.10.m9.4.4.3.3.5.1.cmml" xref="S2.SS1.1.p1.10.m9.4.4.3.3.5">subscript</csymbol><ci id="S2.SS1.1.p1.10.m9.4.4.3.3.5.2.cmml" xref="S2.SS1.1.p1.10.m9.4.4.3.3.5.2">𝑑</ci><ci id="S2.SS1.1.p1.10.m9.4.4.3.3.5.3.cmml" xref="S2.SS1.1.p1.10.m9.4.4.3.3.5.3">ℎ</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.10.m9.4c">head_{1},head_{2},\ldots,head_{h}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.10.m9.4d">italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> are concatenated on the last dimension and <math alttext="P_{\pi}" class="ltx_Math" display="inline" id="S2.SS1.1.p1.11.m10.1"><semantics id="S2.SS1.1.p1.11.m10.1a"><msub id="S2.SS1.1.p1.11.m10.1.1" xref="S2.SS1.1.p1.11.m10.1.1.cmml"><mi id="S2.SS1.1.p1.11.m10.1.1.2" xref="S2.SS1.1.p1.11.m10.1.1.2.cmml">P</mi><mi id="S2.SS1.1.p1.11.m10.1.1.3" xref="S2.SS1.1.p1.11.m10.1.1.3.cmml">π</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.1.p1.11.m10.1b"><apply id="S2.SS1.1.p1.11.m10.1.1.cmml" xref="S2.SS1.1.p1.11.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.1.p1.11.m10.1.1.1.cmml" xref="S2.SS1.1.p1.11.m10.1.1">subscript</csymbol><ci id="S2.SS1.1.p1.11.m10.1.1.2.cmml" xref="S2.SS1.1.p1.11.m10.1.1.2">𝑃</ci><ci id="S2.SS1.1.p1.11.m10.1.1.3.cmml" xref="S2.SS1.1.p1.11.m10.1.1.3">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.1.p1.11.m10.1c">P_{\pi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.1.p1.11.m10.1d">italic_P start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT</annotation></semantics></math> permutes the second to last dimension.
∎</p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p7">
<p class="ltx_p" id="S2.SS1.p7.1">As we will see in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.SS4" title="2.4 The Encoder-Decoder architecture ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2.4</span></a>, usually only the last layer of the vanilla transformer is a fully-linear layer; the rest of layers are attention layers with projections acting on the dimension of the characteristics. Therefore, positional information is only exploited in these last fully-linear layers. However, during the repeated application of attention layers positional information is reduced due to the averages carried out in the full attention mechanism. This issue is addressed by the implementation of the positional encoding, which aims to minimise this reduction of positional information when applying attention layers. However, it seems that, in the case of time series, positional encoding is not enough. Indeed, in experiments, on average a vanilla transformer trained for a particular time series produces similar predictions on an original input and a permuted version of this input  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib21" title="">21</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Probabilistic Attention</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.10">Among state-of-the-art models, Informer is distinguished as one of the most frequently cited and top-performing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>. The authors propose a probabilistic attention mechanism that runs in time and memory <math alttext="\Theta(n\log n)" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3" mathvariant="normal" xref="S2.SS2.p1.1.m1.1.1.3.cmml">Θ</mi><mo id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.cmml">n</mi><mo id="S2.SS2.p1.1.m1.1.1.1.1.1.1" lspace="0.167em" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.3.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.SS2.p1.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S2.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><times id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2"></times><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">Θ</ci><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1"><times id="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1"></times><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2">𝑛</ci><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3"><log id="S2.SS2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.1"></log><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math>. The key idea here is selecting <math alttext="u" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_u</annotation></semantics></math> queries, where <math alttext="u=5\lceil\log n\rceil" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mrow id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">u</mi><mo id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">=</mo><mrow id="S2.SS2.p1.3.m3.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.cmml"><mn id="S2.SS2.p1.3.m3.1.1.1.3" xref="S2.SS2.p1.3.m3.1.1.1.3.cmml">5</mn><mo id="S2.SS2.p1.3.m3.1.1.1.2" xref="S2.SS2.p1.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.3.m3.1.1.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.1.2.cmml"><mo id="S2.SS2.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.3.m3.1.1.1.1.2.1.cmml">⌈</mo><mrow id="S2.SS2.p1.3.m3.1.1.1.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.cmml">log</mi><mo id="S2.SS2.p1.3.m3.1.1.1.1.1.1a" lspace="0.167em" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.cmml">⁡</mo><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.1.2" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.2.cmml">n</mi></mrow><mo id="S2.SS2.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.3.m3.1.1.1.1.2.1.cmml">⌉</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><eq id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2"></eq><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑢</ci><apply id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1"><times id="S2.SS2.p1.3.m3.1.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.1.2"></times><cn id="S2.SS2.p1.3.m3.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.1.1.1.3">5</cn><apply id="S2.SS2.p1.3.m3.1.1.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1"><ceiling id="S2.SS2.p1.3.m3.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2"></ceiling><apply id="S2.SS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1"><log id="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.1"></log><ci id="S2.SS2.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.2">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">u=5\lceil\log n\rceil</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_u = 5 ⌈ roman_log italic_n ⌉</annotation></semantics></math>, and setting the rest of the queries to zeroes. To select these queries, the authors introduce a sparsity measurement for the queries, which approximates the Kullback-Leibler divergence of the attention scores of a query and the uniform distribution. Finding the queries whose attention scores have largest sparsity measurement would require to compute the whole attention matrix to begin with. Instead, the authors propose a heuristic method: for each query <math alttext="Q_{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><msub id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">Q</mi><mi id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">𝑄</ci><ci id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">Q_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, they sample <math alttext="\Theta(\log n)" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><mrow id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.3" mathvariant="normal" xref="S2.SS2.p1.5.m5.1.1.3.cmml">Θ</mi><mo id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.5.m5.1.1.1.1" xref="S2.SS2.p1.5.m5.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.5.m5.1.1.1.1.1" xref="S2.SS2.p1.5.m5.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.1.1.1.1" xref="S2.SS2.p1.5.m5.1.1.1.1.1.1.cmml">log</mi><mo id="S2.SS2.p1.5.m5.1.1.1.1.1a" lspace="0.167em" xref="S2.SS2.p1.5.m5.1.1.1.1.1.cmml">⁡</mo><mi id="S2.SS2.p1.5.m5.1.1.1.1.1.2" xref="S2.SS2.p1.5.m5.1.1.1.1.1.2.cmml">n</mi></mrow><mo id="S2.SS2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><times id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2"></times><ci id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3">Θ</ci><apply id="S2.SS2.p1.5.m5.1.1.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1.1.1"><log id="S2.SS2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1.1.1.1.1"></log><ci id="S2.SS2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.1.1.1.2">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">\Theta(\log n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">roman_Θ ( roman_log italic_n )</annotation></semantics></math> scalar products of the form <math alttext="\langle Q_{i},K_{j}\rangle" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.2"><semantics id="S2.SS2.p1.6.m6.2a"><mrow id="S2.SS2.p1.6.m6.2.2.2" xref="S2.SS2.p1.6.m6.2.2.3.cmml"><mo id="S2.SS2.p1.6.m6.2.2.2.3" stretchy="false" xref="S2.SS2.p1.6.m6.2.2.3.cmml">⟨</mo><msub id="S2.SS2.p1.6.m6.1.1.1.1" xref="S2.SS2.p1.6.m6.1.1.1.1.cmml"><mi id="S2.SS2.p1.6.m6.1.1.1.1.2" xref="S2.SS2.p1.6.m6.1.1.1.1.2.cmml">Q</mi><mi id="S2.SS2.p1.6.m6.1.1.1.1.3" xref="S2.SS2.p1.6.m6.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p1.6.m6.2.2.2.4" xref="S2.SS2.p1.6.m6.2.2.3.cmml">,</mo><msub id="S2.SS2.p1.6.m6.2.2.2.2" xref="S2.SS2.p1.6.m6.2.2.2.2.cmml"><mi id="S2.SS2.p1.6.m6.2.2.2.2.2" xref="S2.SS2.p1.6.m6.2.2.2.2.2.cmml">K</mi><mi id="S2.SS2.p1.6.m6.2.2.2.2.3" xref="S2.SS2.p1.6.m6.2.2.2.2.3.cmml">j</mi></msub><mo id="S2.SS2.p1.6.m6.2.2.2.5" stretchy="false" xref="S2.SS2.p1.6.m6.2.2.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.2b"><list id="S2.SS2.p1.6.m6.2.2.3.cmml" xref="S2.SS2.p1.6.m6.2.2.2"><apply id="S2.SS2.p1.6.m6.1.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1.2">𝑄</ci><ci id="S2.SS2.p1.6.m6.1.1.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS2.p1.6.m6.2.2.2.2.cmml" xref="S2.SS2.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.2.2.2.2.1.cmml" xref="S2.SS2.p1.6.m6.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.6.m6.2.2.2.2.2.cmml" xref="S2.SS2.p1.6.m6.2.2.2.2.2">𝐾</ci><ci id="S2.SS2.p1.6.m6.2.2.2.2.3.cmml" xref="S2.SS2.p1.6.m6.2.2.2.2.3">𝑗</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.2c">\langle Q_{i},K_{j}\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.2d">⟨ italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩</annotation></semantics></math> and approximate the sparsity measurement of the query <math alttext="Q_{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.1"><semantics id="S2.SS2.p1.7.m7.1a"><msub id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml"><mi id="S2.SS2.p1.7.m7.1.1.2" xref="S2.SS2.p1.7.m7.1.1.2.cmml">Q</mi><mi id="S2.SS2.p1.7.m7.1.1.3" xref="S2.SS2.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><apply id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS2.p1.7.m7.1.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1.2">𝑄</ci><ci id="S2.SS2.p1.7.m7.1.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">Q_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> using these samples. Let us denote by <math alttext="\operatorname{ProbSelect}(Q,K)" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.3"><semantics id="S2.SS2.p1.8.m8.3a"><mrow id="S2.SS2.p1.8.m8.3.4.2" xref="S2.SS2.p1.8.m8.3.4.1.cmml"><mi id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">ProbSelect</mi><mo id="S2.SS2.p1.8.m8.3.4.2a" xref="S2.SS2.p1.8.m8.3.4.1.cmml">⁡</mo><mrow id="S2.SS2.p1.8.m8.3.4.2.1" xref="S2.SS2.p1.8.m8.3.4.1.cmml"><mo id="S2.SS2.p1.8.m8.3.4.2.1.1" stretchy="false" xref="S2.SS2.p1.8.m8.3.4.1.cmml">(</mo><mi id="S2.SS2.p1.8.m8.2.2" xref="S2.SS2.p1.8.m8.2.2.cmml">Q</mi><mo id="S2.SS2.p1.8.m8.3.4.2.1.2" xref="S2.SS2.p1.8.m8.3.4.1.cmml">,</mo><mi id="S2.SS2.p1.8.m8.3.3" xref="S2.SS2.p1.8.m8.3.3.cmml">K</mi><mo id="S2.SS2.p1.8.m8.3.4.2.1.3" stretchy="false" xref="S2.SS2.p1.8.m8.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.3b"><apply id="S2.SS2.p1.8.m8.3.4.1.cmml" xref="S2.SS2.p1.8.m8.3.4.2"><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">ProbSelect</ci><ci id="S2.SS2.p1.8.m8.2.2.cmml" xref="S2.SS2.p1.8.m8.2.2">𝑄</ci><ci id="S2.SS2.p1.8.m8.3.3.cmml" xref="S2.SS2.p1.8.m8.3.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.3c">\operatorname{ProbSelect}(Q,K)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.3d">roman_ProbSelect ( italic_Q , italic_K )</annotation></semantics></math> the method that selects the top <math alttext="u" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m9.1"><semantics id="S2.SS2.p1.9.m9.1a"><mi id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><ci id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m9.1d">italic_u</annotation></semantics></math> queries of <math alttext="Q" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m10.1"><semantics id="S2.SS2.p1.10.m10.1a"><mi id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><ci id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m10.1d">italic_Q</annotation></semantics></math> with this sampling heuristic and masks the rest of the queries to zeroes. Then, the probabilistic attention mechanism is</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{ProbAttn(Q,K,V)}=\operatorname{softmax}\left(\frac{\operatorname%
{ProbSelect}(Q,K)K^{T}}{\sqrt{d_{q}}}\right)V." class="ltx_Math" display="block" id="S2.Ex4.m1.8"><semantics id="S2.Ex4.m1.8a"><mrow id="S2.Ex4.m1.8.8.1" xref="S2.Ex4.m1.8.8.1.1.cmml"><mrow id="S2.Ex4.m1.8.8.1.1" xref="S2.Ex4.m1.8.8.1.1.cmml"><mrow id="S2.Ex4.m1.3.3" xref="S2.Ex4.m1.3.3.cmml"><mi id="S2.Ex4.m1.3.3.5" xref="S2.Ex4.m1.3.3.5.cmml">ProbAttn</mi><mo id="S2.Ex4.m1.3.3.4" xref="S2.Ex4.m1.3.3.4.cmml">⁢</mo><mrow id="S2.Ex4.m1.3.3.6.2" xref="S2.Ex4.m1.3.3.6.1.cmml"><mo id="S2.Ex4.m1.3.3.6.2.1" stretchy="false" xref="S2.Ex4.m1.3.3.6.1.cmml">(</mo><mi id="S2.Ex4.m1.1.1.1" mathvariant="normal" xref="S2.Ex4.m1.1.1.1.cmml">Q</mi><mo id="S2.Ex4.m1.3.3.6.2.2" xref="S2.Ex4.m1.3.3.6.1.cmml">,</mo><mi id="S2.Ex4.m1.2.2.2" mathvariant="normal" xref="S2.Ex4.m1.2.2.2.cmml">K</mi><mo id="S2.Ex4.m1.3.3.6.2.3" xref="S2.Ex4.m1.3.3.6.1.cmml">,</mo><mi id="S2.Ex4.m1.3.3.3" mathvariant="normal" xref="S2.Ex4.m1.3.3.3.cmml">V</mi><mo id="S2.Ex4.m1.3.3.6.2.4" stretchy="false" xref="S2.Ex4.m1.3.3.6.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex4.m1.8.8.1.1.1" xref="S2.Ex4.m1.8.8.1.1.1.cmml">=</mo><mrow id="S2.Ex4.m1.8.8.1.1.2" xref="S2.Ex4.m1.8.8.1.1.2.cmml"><mrow id="S2.Ex4.m1.8.8.1.1.2.2.2" xref="S2.Ex4.m1.8.8.1.1.2.2.1.cmml"><mi id="S2.Ex4.m1.7.7" xref="S2.Ex4.m1.7.7.cmml">softmax</mi><mo id="S2.Ex4.m1.8.8.1.1.2.2.2a" xref="S2.Ex4.m1.8.8.1.1.2.2.1.cmml">⁡</mo><mrow id="S2.Ex4.m1.8.8.1.1.2.2.2.1" xref="S2.Ex4.m1.8.8.1.1.2.2.1.cmml"><mo id="S2.Ex4.m1.8.8.1.1.2.2.2.1.1" xref="S2.Ex4.m1.8.8.1.1.2.2.1.cmml">(</mo><mfrac id="S2.Ex4.m1.6.6" xref="S2.Ex4.m1.6.6.cmml"><mrow id="S2.Ex4.m1.6.6.3" xref="S2.Ex4.m1.6.6.3.cmml"><mrow id="S2.Ex4.m1.6.6.3.5.2" xref="S2.Ex4.m1.6.6.3.5.1.cmml"><mi id="S2.Ex4.m1.4.4.1.1" xref="S2.Ex4.m1.4.4.1.1.cmml">ProbSelect</mi><mo id="S2.Ex4.m1.6.6.3.5.2a" xref="S2.Ex4.m1.6.6.3.5.1.cmml">⁡</mo><mrow id="S2.Ex4.m1.6.6.3.5.2.1" xref="S2.Ex4.m1.6.6.3.5.1.cmml"><mo id="S2.Ex4.m1.6.6.3.5.2.1.1" stretchy="false" xref="S2.Ex4.m1.6.6.3.5.1.cmml">(</mo><mi id="S2.Ex4.m1.5.5.2.2" xref="S2.Ex4.m1.5.5.2.2.cmml">Q</mi><mo id="S2.Ex4.m1.6.6.3.5.2.1.2" xref="S2.Ex4.m1.6.6.3.5.1.cmml">,</mo><mi id="S2.Ex4.m1.6.6.3.3" xref="S2.Ex4.m1.6.6.3.3.cmml">K</mi><mo id="S2.Ex4.m1.6.6.3.5.2.1.3" stretchy="false" xref="S2.Ex4.m1.6.6.3.5.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex4.m1.6.6.3.4" xref="S2.Ex4.m1.6.6.3.4.cmml">⁢</mo><msup id="S2.Ex4.m1.6.6.3.6" xref="S2.Ex4.m1.6.6.3.6.cmml"><mi id="S2.Ex4.m1.6.6.3.6.2" xref="S2.Ex4.m1.6.6.3.6.2.cmml">K</mi><mi id="S2.Ex4.m1.6.6.3.6.3" xref="S2.Ex4.m1.6.6.3.6.3.cmml">T</mi></msup></mrow><msqrt id="S2.Ex4.m1.6.6.5" xref="S2.Ex4.m1.6.6.5.cmml"><msub id="S2.Ex4.m1.6.6.5.2" xref="S2.Ex4.m1.6.6.5.2.cmml"><mi id="S2.Ex4.m1.6.6.5.2.2" xref="S2.Ex4.m1.6.6.5.2.2.cmml">d</mi><mi id="S2.Ex4.m1.6.6.5.2.3" xref="S2.Ex4.m1.6.6.5.2.3.cmml">q</mi></msub></msqrt></mfrac><mo id="S2.Ex4.m1.8.8.1.1.2.2.2.1.2" xref="S2.Ex4.m1.8.8.1.1.2.2.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex4.m1.8.8.1.1.2.1" xref="S2.Ex4.m1.8.8.1.1.2.1.cmml">⁢</mo><mi id="S2.Ex4.m1.8.8.1.1.2.3" xref="S2.Ex4.m1.8.8.1.1.2.3.cmml">V</mi></mrow></mrow><mo id="S2.Ex4.m1.8.8.1.2" lspace="0em" xref="S2.Ex4.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex4.m1.8b"><apply id="S2.Ex4.m1.8.8.1.1.cmml" xref="S2.Ex4.m1.8.8.1"><eq id="S2.Ex4.m1.8.8.1.1.1.cmml" xref="S2.Ex4.m1.8.8.1.1.1"></eq><apply id="S2.Ex4.m1.3.3.cmml" xref="S2.Ex4.m1.3.3"><times id="S2.Ex4.m1.3.3.4.cmml" xref="S2.Ex4.m1.3.3.4"></times><ci id="S2.Ex4.m1.3.3.5.cmml" xref="S2.Ex4.m1.3.3.5">ProbAttn</ci><vector id="S2.Ex4.m1.3.3.6.1.cmml" xref="S2.Ex4.m1.3.3.6.2"><ci id="S2.Ex4.m1.1.1.1.cmml" xref="S2.Ex4.m1.1.1.1">Q</ci><ci id="S2.Ex4.m1.2.2.2.cmml" xref="S2.Ex4.m1.2.2.2">K</ci><ci id="S2.Ex4.m1.3.3.3.cmml" xref="S2.Ex4.m1.3.3.3">V</ci></vector></apply><apply id="S2.Ex4.m1.8.8.1.1.2.cmml" xref="S2.Ex4.m1.8.8.1.1.2"><times id="S2.Ex4.m1.8.8.1.1.2.1.cmml" xref="S2.Ex4.m1.8.8.1.1.2.1"></times><apply id="S2.Ex4.m1.8.8.1.1.2.2.1.cmml" xref="S2.Ex4.m1.8.8.1.1.2.2.2"><ci id="S2.Ex4.m1.7.7.cmml" xref="S2.Ex4.m1.7.7">softmax</ci><apply id="S2.Ex4.m1.6.6.cmml" xref="S2.Ex4.m1.6.6"><divide id="S2.Ex4.m1.6.6.4.cmml" xref="S2.Ex4.m1.6.6"></divide><apply id="S2.Ex4.m1.6.6.3.cmml" xref="S2.Ex4.m1.6.6.3"><times id="S2.Ex4.m1.6.6.3.4.cmml" xref="S2.Ex4.m1.6.6.3.4"></times><apply id="S2.Ex4.m1.6.6.3.5.1.cmml" xref="S2.Ex4.m1.6.6.3.5.2"><ci id="S2.Ex4.m1.4.4.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1">ProbSelect</ci><ci id="S2.Ex4.m1.5.5.2.2.cmml" xref="S2.Ex4.m1.5.5.2.2">𝑄</ci><ci id="S2.Ex4.m1.6.6.3.3.cmml" xref="S2.Ex4.m1.6.6.3.3">𝐾</ci></apply><apply id="S2.Ex4.m1.6.6.3.6.cmml" xref="S2.Ex4.m1.6.6.3.6"><csymbol cd="ambiguous" id="S2.Ex4.m1.6.6.3.6.1.cmml" xref="S2.Ex4.m1.6.6.3.6">superscript</csymbol><ci id="S2.Ex4.m1.6.6.3.6.2.cmml" xref="S2.Ex4.m1.6.6.3.6.2">𝐾</ci><ci id="S2.Ex4.m1.6.6.3.6.3.cmml" xref="S2.Ex4.m1.6.6.3.6.3">𝑇</ci></apply></apply><apply id="S2.Ex4.m1.6.6.5.cmml" xref="S2.Ex4.m1.6.6.5"><root id="S2.Ex4.m1.6.6.5a.cmml" xref="S2.Ex4.m1.6.6.5"></root><apply id="S2.Ex4.m1.6.6.5.2.cmml" xref="S2.Ex4.m1.6.6.5.2"><csymbol cd="ambiguous" id="S2.Ex4.m1.6.6.5.2.1.cmml" xref="S2.Ex4.m1.6.6.5.2">subscript</csymbol><ci id="S2.Ex4.m1.6.6.5.2.2.cmml" xref="S2.Ex4.m1.6.6.5.2.2">𝑑</ci><ci id="S2.Ex4.m1.6.6.5.2.3.cmml" xref="S2.Ex4.m1.6.6.5.2.3">𝑞</ci></apply></apply></apply></apply><ci id="S2.Ex4.m1.8.8.1.1.2.3.cmml" xref="S2.Ex4.m1.8.8.1.1.2.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4.m1.8c">\operatorname{ProbAttn(Q,K,V)}=\operatorname{softmax}\left(\frac{\operatorname%
{ProbSelect}(Q,K)K^{T}}{\sqrt{d_{q}}}\right)V.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex4.m1.8d">start_OPFUNCTION roman_ProbAttn ( roman_Q , roman_K , roman_V ) end_OPFUNCTION = roman_softmax ( divide start_ARG roman_ProbSelect ( italic_Q , italic_K ) italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.18">The product <math alttext="\operatorname{ProbSelect}(Q,K)K^{T}" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m1.3"><semantics id="S2.SS2.p1.11.m1.3a"><mrow id="S2.SS2.p1.11.m1.3.4" xref="S2.SS2.p1.11.m1.3.4.cmml"><mrow id="S2.SS2.p1.11.m1.3.4.2.2" xref="S2.SS2.p1.11.m1.3.4.2.1.cmml"><mi id="S2.SS2.p1.11.m1.1.1" xref="S2.SS2.p1.11.m1.1.1.cmml">ProbSelect</mi><mo id="S2.SS2.p1.11.m1.3.4.2.2a" xref="S2.SS2.p1.11.m1.3.4.2.1.cmml">⁡</mo><mrow id="S2.SS2.p1.11.m1.3.4.2.2.1" xref="S2.SS2.p1.11.m1.3.4.2.1.cmml"><mo id="S2.SS2.p1.11.m1.3.4.2.2.1.1" stretchy="false" xref="S2.SS2.p1.11.m1.3.4.2.1.cmml">(</mo><mi id="S2.SS2.p1.11.m1.2.2" xref="S2.SS2.p1.11.m1.2.2.cmml">Q</mi><mo id="S2.SS2.p1.11.m1.3.4.2.2.1.2" xref="S2.SS2.p1.11.m1.3.4.2.1.cmml">,</mo><mi id="S2.SS2.p1.11.m1.3.3" xref="S2.SS2.p1.11.m1.3.3.cmml">K</mi><mo id="S2.SS2.p1.11.m1.3.4.2.2.1.3" stretchy="false" xref="S2.SS2.p1.11.m1.3.4.2.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.11.m1.3.4.1" xref="S2.SS2.p1.11.m1.3.4.1.cmml">⁢</mo><msup id="S2.SS2.p1.11.m1.3.4.3" xref="S2.SS2.p1.11.m1.3.4.3.cmml"><mi id="S2.SS2.p1.11.m1.3.4.3.2" xref="S2.SS2.p1.11.m1.3.4.3.2.cmml">K</mi><mi id="S2.SS2.p1.11.m1.3.4.3.3" xref="S2.SS2.p1.11.m1.3.4.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m1.3b"><apply id="S2.SS2.p1.11.m1.3.4.cmml" xref="S2.SS2.p1.11.m1.3.4"><times id="S2.SS2.p1.11.m1.3.4.1.cmml" xref="S2.SS2.p1.11.m1.3.4.1"></times><apply id="S2.SS2.p1.11.m1.3.4.2.1.cmml" xref="S2.SS2.p1.11.m1.3.4.2.2"><ci id="S2.SS2.p1.11.m1.1.1.cmml" xref="S2.SS2.p1.11.m1.1.1">ProbSelect</ci><ci id="S2.SS2.p1.11.m1.2.2.cmml" xref="S2.SS2.p1.11.m1.2.2">𝑄</ci><ci id="S2.SS2.p1.11.m1.3.3.cmml" xref="S2.SS2.p1.11.m1.3.3">𝐾</ci></apply><apply id="S2.SS2.p1.11.m1.3.4.3.cmml" xref="S2.SS2.p1.11.m1.3.4.3"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m1.3.4.3.1.cmml" xref="S2.SS2.p1.11.m1.3.4.3">superscript</csymbol><ci id="S2.SS2.p1.11.m1.3.4.3.2.cmml" xref="S2.SS2.p1.11.m1.3.4.3.2">𝐾</ci><ci id="S2.SS2.p1.11.m1.3.4.3.3.cmml" xref="S2.SS2.p1.11.m1.3.4.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m1.3c">\operatorname{ProbSelect}(Q,K)K^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m1.3d">roman_ProbSelect ( italic_Q , italic_K ) italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> does not have to be fully computed. Indeed, for each query <math alttext="Q_{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.12.m2.1"><semantics id="S2.SS2.p1.12.m2.1a"><msub id="S2.SS2.p1.12.m2.1.1" xref="S2.SS2.p1.12.m2.1.1.cmml"><mi id="S2.SS2.p1.12.m2.1.1.2" xref="S2.SS2.p1.12.m2.1.1.2.cmml">Q</mi><mi id="S2.SS2.p1.12.m2.1.1.3" xref="S2.SS2.p1.12.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m2.1b"><apply id="S2.SS2.p1.12.m2.1.1.cmml" xref="S2.SS2.p1.12.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m2.1.1.1.cmml" xref="S2.SS2.p1.12.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.12.m2.1.1.2.cmml" xref="S2.SS2.p1.12.m2.1.1.2">𝑄</ci><ci id="S2.SS2.p1.12.m2.1.1.3.cmml" xref="S2.SS2.p1.12.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m2.1c">Q_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.12.m2.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> that is not selected, the corresponding attention scores are uniform, that is, <math alttext="a_{ij}=1/n" class="ltx_Math" display="inline" id="S2.SS2.p1.13.m3.1"><semantics id="S2.SS2.p1.13.m3.1a"><mrow id="S2.SS2.p1.13.m3.1.1" xref="S2.SS2.p1.13.m3.1.1.cmml"><msub id="S2.SS2.p1.13.m3.1.1.2" xref="S2.SS2.p1.13.m3.1.1.2.cmml"><mi id="S2.SS2.p1.13.m3.1.1.2.2" xref="S2.SS2.p1.13.m3.1.1.2.2.cmml">a</mi><mrow id="S2.SS2.p1.13.m3.1.1.2.3" xref="S2.SS2.p1.13.m3.1.1.2.3.cmml"><mi id="S2.SS2.p1.13.m3.1.1.2.3.2" xref="S2.SS2.p1.13.m3.1.1.2.3.2.cmml">i</mi><mo id="S2.SS2.p1.13.m3.1.1.2.3.1" xref="S2.SS2.p1.13.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.13.m3.1.1.2.3.3" xref="S2.SS2.p1.13.m3.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS2.p1.13.m3.1.1.1" xref="S2.SS2.p1.13.m3.1.1.1.cmml">=</mo><mrow id="S2.SS2.p1.13.m3.1.1.3" xref="S2.SS2.p1.13.m3.1.1.3.cmml"><mn id="S2.SS2.p1.13.m3.1.1.3.2" xref="S2.SS2.p1.13.m3.1.1.3.2.cmml">1</mn><mo id="S2.SS2.p1.13.m3.1.1.3.1" xref="S2.SS2.p1.13.m3.1.1.3.1.cmml">/</mo><mi id="S2.SS2.p1.13.m3.1.1.3.3" xref="S2.SS2.p1.13.m3.1.1.3.3.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m3.1b"><apply id="S2.SS2.p1.13.m3.1.1.cmml" xref="S2.SS2.p1.13.m3.1.1"><eq id="S2.SS2.p1.13.m3.1.1.1.cmml" xref="S2.SS2.p1.13.m3.1.1.1"></eq><apply id="S2.SS2.p1.13.m3.1.1.2.cmml" xref="S2.SS2.p1.13.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.13.m3.1.1.2.1.cmml" xref="S2.SS2.p1.13.m3.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.13.m3.1.1.2.2.cmml" xref="S2.SS2.p1.13.m3.1.1.2.2">𝑎</ci><apply id="S2.SS2.p1.13.m3.1.1.2.3.cmml" xref="S2.SS2.p1.13.m3.1.1.2.3"><times id="S2.SS2.p1.13.m3.1.1.2.3.1.cmml" xref="S2.SS2.p1.13.m3.1.1.2.3.1"></times><ci id="S2.SS2.p1.13.m3.1.1.2.3.2.cmml" xref="S2.SS2.p1.13.m3.1.1.2.3.2">𝑖</ci><ci id="S2.SS2.p1.13.m3.1.1.2.3.3.cmml" xref="S2.SS2.p1.13.m3.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS2.p1.13.m3.1.1.3.cmml" xref="S2.SS2.p1.13.m3.1.1.3"><divide id="S2.SS2.p1.13.m3.1.1.3.1.cmml" xref="S2.SS2.p1.13.m3.1.1.3.1"></divide><cn id="S2.SS2.p1.13.m3.1.1.3.2.cmml" type="integer" xref="S2.SS2.p1.13.m3.1.1.3.2">1</cn><ci id="S2.SS2.p1.13.m3.1.1.3.3.cmml" xref="S2.SS2.p1.13.m3.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m3.1c">a_{ij}=1/n</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.13.m3.1d">italic_a start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = 1 / italic_n</annotation></semantics></math>, as <math alttext="Q_{i}=0" class="ltx_Math" display="inline" id="S2.SS2.p1.14.m4.1"><semantics id="S2.SS2.p1.14.m4.1a"><mrow id="S2.SS2.p1.14.m4.1.1" xref="S2.SS2.p1.14.m4.1.1.cmml"><msub id="S2.SS2.p1.14.m4.1.1.2" xref="S2.SS2.p1.14.m4.1.1.2.cmml"><mi id="S2.SS2.p1.14.m4.1.1.2.2" xref="S2.SS2.p1.14.m4.1.1.2.2.cmml">Q</mi><mi id="S2.SS2.p1.14.m4.1.1.2.3" xref="S2.SS2.p1.14.m4.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS2.p1.14.m4.1.1.1" xref="S2.SS2.p1.14.m4.1.1.1.cmml">=</mo><mn id="S2.SS2.p1.14.m4.1.1.3" xref="S2.SS2.p1.14.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m4.1b"><apply id="S2.SS2.p1.14.m4.1.1.cmml" xref="S2.SS2.p1.14.m4.1.1"><eq id="S2.SS2.p1.14.m4.1.1.1.cmml" xref="S2.SS2.p1.14.m4.1.1.1"></eq><apply id="S2.SS2.p1.14.m4.1.1.2.cmml" xref="S2.SS2.p1.14.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m4.1.1.2.1.cmml" xref="S2.SS2.p1.14.m4.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.14.m4.1.1.2.2.cmml" xref="S2.SS2.p1.14.m4.1.1.2.2">𝑄</ci><ci id="S2.SS2.p1.14.m4.1.1.2.3.cmml" xref="S2.SS2.p1.14.m4.1.1.2.3">𝑖</ci></apply><cn id="S2.SS2.p1.14.m4.1.1.3.cmml" type="integer" xref="S2.SS2.p1.14.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m4.1c">Q_{i}=0</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.14.m4.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0</annotation></semantics></math>. Thus, we only have to carry out <math alttext="n" class="ltx_Math" display="inline" id="S2.SS2.p1.15.m5.1"><semantics id="S2.SS2.p1.15.m5.1a"><mi id="S2.SS2.p1.15.m5.1.1" xref="S2.SS2.p1.15.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m5.1b"><ci id="S2.SS2.p1.15.m5.1.1.cmml" xref="S2.SS2.p1.15.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.15.m5.1d">italic_n</annotation></semantics></math> scalar products for each one of the <math alttext="u=\Theta(\log n)" class="ltx_Math" display="inline" id="S2.SS2.p1.16.m6.1"><semantics id="S2.SS2.p1.16.m6.1a"><mrow id="S2.SS2.p1.16.m6.1.1" xref="S2.SS2.p1.16.m6.1.1.cmml"><mi id="S2.SS2.p1.16.m6.1.1.3" xref="S2.SS2.p1.16.m6.1.1.3.cmml">u</mi><mo id="S2.SS2.p1.16.m6.1.1.2" xref="S2.SS2.p1.16.m6.1.1.2.cmml">=</mo><mrow id="S2.SS2.p1.16.m6.1.1.1" xref="S2.SS2.p1.16.m6.1.1.1.cmml"><mi id="S2.SS2.p1.16.m6.1.1.1.3" mathvariant="normal" xref="S2.SS2.p1.16.m6.1.1.1.3.cmml">Θ</mi><mo id="S2.SS2.p1.16.m6.1.1.1.2" xref="S2.SS2.p1.16.m6.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.16.m6.1.1.1.1.1" xref="S2.SS2.p1.16.m6.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.16.m6.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.16.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.16.m6.1.1.1.1.1.1" xref="S2.SS2.p1.16.m6.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.16.m6.1.1.1.1.1.1.1" xref="S2.SS2.p1.16.m6.1.1.1.1.1.1.1.cmml">log</mi><mo id="S2.SS2.p1.16.m6.1.1.1.1.1.1a" lspace="0.167em" xref="S2.SS2.p1.16.m6.1.1.1.1.1.1.cmml">⁡</mo><mi id="S2.SS2.p1.16.m6.1.1.1.1.1.1.2" xref="S2.SS2.p1.16.m6.1.1.1.1.1.1.2.cmml">n</mi></mrow><mo id="S2.SS2.p1.16.m6.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.16.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.m6.1b"><apply id="S2.SS2.p1.16.m6.1.1.cmml" xref="S2.SS2.p1.16.m6.1.1"><eq id="S2.SS2.p1.16.m6.1.1.2.cmml" xref="S2.SS2.p1.16.m6.1.1.2"></eq><ci id="S2.SS2.p1.16.m6.1.1.3.cmml" xref="S2.SS2.p1.16.m6.1.1.3">𝑢</ci><apply id="S2.SS2.p1.16.m6.1.1.1.cmml" xref="S2.SS2.p1.16.m6.1.1.1"><times id="S2.SS2.p1.16.m6.1.1.1.2.cmml" xref="S2.SS2.p1.16.m6.1.1.1.2"></times><ci id="S2.SS2.p1.16.m6.1.1.1.3.cmml" xref="S2.SS2.p1.16.m6.1.1.1.3">Θ</ci><apply id="S2.SS2.p1.16.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.16.m6.1.1.1.1.1"><log id="S2.SS2.p1.16.m6.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.16.m6.1.1.1.1.1.1.1"></log><ci id="S2.SS2.p1.16.m6.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.16.m6.1.1.1.1.1.1.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.16.m6.1c">u=\Theta(\log n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.16.m6.1d">italic_u = roman_Θ ( roman_log italic_n )</annotation></semantics></math> rows selected to calculate <math alttext="\operatorname{ProbAttn(Q,K,V)}" class="ltx_Math" display="inline" id="S2.SS2.p1.17.m7.3"><semantics id="S2.SS2.p1.17.m7.3a"><mrow id="S2.SS2.p1.17.m7.3.3" xref="S2.SS2.p1.17.m7.3.3.cmml"><mi id="S2.SS2.p1.17.m7.3.3.5" xref="S2.SS2.p1.17.m7.3.3.5.cmml">ProbAttn</mi><mo id="S2.SS2.p1.17.m7.3.3.4" xref="S2.SS2.p1.17.m7.3.3.4.cmml">⁢</mo><mrow id="S2.SS2.p1.17.m7.3.3.6.2" xref="S2.SS2.p1.17.m7.3.3.6.1.cmml"><mo id="S2.SS2.p1.17.m7.3.3.6.2.1" stretchy="false" xref="S2.SS2.p1.17.m7.3.3.6.1.cmml">(</mo><mi id="S2.SS2.p1.17.m7.1.1.1" mathvariant="normal" xref="S2.SS2.p1.17.m7.1.1.1.cmml">Q</mi><mo id="S2.SS2.p1.17.m7.3.3.6.2.2" xref="S2.SS2.p1.17.m7.3.3.6.1.cmml">,</mo><mi id="S2.SS2.p1.17.m7.2.2.2" mathvariant="normal" xref="S2.SS2.p1.17.m7.2.2.2.cmml">K</mi><mo id="S2.SS2.p1.17.m7.3.3.6.2.3" xref="S2.SS2.p1.17.m7.3.3.6.1.cmml">,</mo><mi id="S2.SS2.p1.17.m7.3.3.3" mathvariant="normal" xref="S2.SS2.p1.17.m7.3.3.3.cmml">V</mi><mo id="S2.SS2.p1.17.m7.3.3.6.2.4" stretchy="false" xref="S2.SS2.p1.17.m7.3.3.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.17.m7.3b"><apply id="S2.SS2.p1.17.m7.3.3.cmml" xref="S2.SS2.p1.17.m7.3.3"><times id="S2.SS2.p1.17.m7.3.3.4.cmml" xref="S2.SS2.p1.17.m7.3.3.4"></times><ci id="S2.SS2.p1.17.m7.3.3.5.cmml" xref="S2.SS2.p1.17.m7.3.3.5">ProbAttn</ci><vector id="S2.SS2.p1.17.m7.3.3.6.1.cmml" xref="S2.SS2.p1.17.m7.3.3.6.2"><ci id="S2.SS2.p1.17.m7.1.1.1.cmml" xref="S2.SS2.p1.17.m7.1.1.1">Q</ci><ci id="S2.SS2.p1.17.m7.2.2.2.cmml" xref="S2.SS2.p1.17.m7.2.2.2">K</ci><ci id="S2.SS2.p1.17.m7.3.3.3.cmml" xref="S2.SS2.p1.17.m7.3.3.3">V</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.17.m7.3c">\operatorname{ProbAttn(Q,K,V)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.17.m7.3d">roman_ProbAttn ( roman_Q , roman_K , roman_V )</annotation></semantics></math>, leading to <math alttext="\Theta(n\log n)" class="ltx_Math" display="inline" id="S2.SS2.p1.18.m8.1"><semantics id="S2.SS2.p1.18.m8.1a"><mrow id="S2.SS2.p1.18.m8.1.1" xref="S2.SS2.p1.18.m8.1.1.cmml"><mi id="S2.SS2.p1.18.m8.1.1.3" mathvariant="normal" xref="S2.SS2.p1.18.m8.1.1.3.cmml">Θ</mi><mo id="S2.SS2.p1.18.m8.1.1.2" xref="S2.SS2.p1.18.m8.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.18.m8.1.1.1.1" xref="S2.SS2.p1.18.m8.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.18.m8.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.18.m8.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.18.m8.1.1.1.1.1" xref="S2.SS2.p1.18.m8.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.18.m8.1.1.1.1.1.2" xref="S2.SS2.p1.18.m8.1.1.1.1.1.2.cmml">n</mi><mo id="S2.SS2.p1.18.m8.1.1.1.1.1.1" lspace="0.167em" xref="S2.SS2.p1.18.m8.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS2.p1.18.m8.1.1.1.1.1.3" xref="S2.SS2.p1.18.m8.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.18.m8.1.1.1.1.1.3.1" xref="S2.SS2.p1.18.m8.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.SS2.p1.18.m8.1.1.1.1.1.3a" lspace="0.167em" xref="S2.SS2.p1.18.m8.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.SS2.p1.18.m8.1.1.1.1.1.3.2" xref="S2.SS2.p1.18.m8.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S2.SS2.p1.18.m8.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.18.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.18.m8.1b"><apply id="S2.SS2.p1.18.m8.1.1.cmml" xref="S2.SS2.p1.18.m8.1.1"><times id="S2.SS2.p1.18.m8.1.1.2.cmml" xref="S2.SS2.p1.18.m8.1.1.2"></times><ci id="S2.SS2.p1.18.m8.1.1.3.cmml" xref="S2.SS2.p1.18.m8.1.1.3">Θ</ci><apply id="S2.SS2.p1.18.m8.1.1.1.1.1.cmml" xref="S2.SS2.p1.18.m8.1.1.1.1"><times id="S2.SS2.p1.18.m8.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.18.m8.1.1.1.1.1.1"></times><ci id="S2.SS2.p1.18.m8.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.18.m8.1.1.1.1.1.2">𝑛</ci><apply id="S2.SS2.p1.18.m8.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.18.m8.1.1.1.1.1.3"><log id="S2.SS2.p1.18.m8.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.18.m8.1.1.1.1.1.3.1"></log><ci id="S2.SS2.p1.18.m8.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.18.m8.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.18.m8.1c">\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.18.m8.1d">roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math> complexity.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.2">Even though the ProbAttn method does significantly reduce the time and memory complexity of the attention mechanism and seems to be able to capture the most significant attention scores in practice according to the experiments carried out in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>, it does lead to a significant loss of information. Indeed, the output of <math alttext="\operatorname{ProbAttn(Q,K,V)}" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.3"><semantics id="S2.SS2.p2.1.m1.3a"><mrow id="S2.SS2.p2.1.m1.3.3" xref="S2.SS2.p2.1.m1.3.3.cmml"><mi id="S2.SS2.p2.1.m1.3.3.5" xref="S2.SS2.p2.1.m1.3.3.5.cmml">ProbAttn</mi><mo id="S2.SS2.p2.1.m1.3.3.4" xref="S2.SS2.p2.1.m1.3.3.4.cmml">⁢</mo><mrow id="S2.SS2.p2.1.m1.3.3.6.2" xref="S2.SS2.p2.1.m1.3.3.6.1.cmml"><mo id="S2.SS2.p2.1.m1.3.3.6.2.1" stretchy="false" xref="S2.SS2.p2.1.m1.3.3.6.1.cmml">(</mo><mi id="S2.SS2.p2.1.m1.1.1.1" mathvariant="normal" xref="S2.SS2.p2.1.m1.1.1.1.cmml">Q</mi><mo id="S2.SS2.p2.1.m1.3.3.6.2.2" xref="S2.SS2.p2.1.m1.3.3.6.1.cmml">,</mo><mi id="S2.SS2.p2.1.m1.2.2.2" mathvariant="normal" xref="S2.SS2.p2.1.m1.2.2.2.cmml">K</mi><mo id="S2.SS2.p2.1.m1.3.3.6.2.3" xref="S2.SS2.p2.1.m1.3.3.6.1.cmml">,</mo><mi id="S2.SS2.p2.1.m1.3.3.3" mathvariant="normal" xref="S2.SS2.p2.1.m1.3.3.3.cmml">V</mi><mo id="S2.SS2.p2.1.m1.3.3.6.2.4" stretchy="false" xref="S2.SS2.p2.1.m1.3.3.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.3b"><apply id="S2.SS2.p2.1.m1.3.3.cmml" xref="S2.SS2.p2.1.m1.3.3"><times id="S2.SS2.p2.1.m1.3.3.4.cmml" xref="S2.SS2.p2.1.m1.3.3.4"></times><ci id="S2.SS2.p2.1.m1.3.3.5.cmml" xref="S2.SS2.p2.1.m1.3.3.5">ProbAttn</ci><vector id="S2.SS2.p2.1.m1.3.3.6.1.cmml" xref="S2.SS2.p2.1.m1.3.3.6.2"><ci id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1">Q</ci><ci id="S2.SS2.p2.1.m1.2.2.2.cmml" xref="S2.SS2.p2.1.m1.2.2.2">K</ci><ci id="S2.SS2.p2.1.m1.3.3.3.cmml" xref="S2.SS2.p2.1.m1.3.3.3">V</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.3c">\operatorname{ProbAttn(Q,K,V)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.3d">roman_ProbAttn ( roman_Q , roman_K , roman_V )</annotation></semantics></math> has <math alttext="n-u" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">n</mi><mo id="S2.SS2.p2.2.m2.1.1.1" xref="S2.SS2.p2.2.m2.1.1.1.cmml">−</mo><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">u</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><minus id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1"></minus><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑛</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">n-u</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_n - italic_u</annotation></semantics></math> entries that are equal to the average of the values. We believe this to be a major drawback of this attention mechanism, and this is corroborated in our experimentation. The authors of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite> try to fix this issue by applying residual connections in their model, as well as a complex architecture that exploits convolutions in conjunction with ProbAttn. However, our experiments show that this is not enough, as the vanilla transformer is able to significantly outperform Informer.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Positional encoding</h3>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Positional encoding in transformers is essential for providing sequence information to the model, which inherently lacks an understanding of order due to its self-attention mechanism (see Proposition <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm1" title="Proposition 1. ‣ 2.1 Attention Mechanism ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">1</span></a>). Positional encoding involves adding a positional tensor to the input sequence, which is usually derived from sine and cosine functions, to indicate each entry relative or absolute position. In our experiments, we add to the input matrix the positional encoding employed in the vanilla model,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{PE}(i,j)=\sin(i/10000^{j/d_{model}})+\cos(i/10000^{j/d_{model}})." class="ltx_Math" display="block" id="S2.Ex5.m1.6"><semantics id="S2.Ex5.m1.6a"><mrow id="S2.Ex5.m1.6.6.1" xref="S2.Ex5.m1.6.6.1.1.cmml"><mrow id="S2.Ex5.m1.6.6.1.1" xref="S2.Ex5.m1.6.6.1.1.cmml"><mrow id="S2.Ex5.m1.6.6.1.1.4.2" xref="S2.Ex5.m1.6.6.1.1.4.1.cmml"><mi id="S2.Ex5.m1.1.1" xref="S2.Ex5.m1.1.1.cmml">PE</mi><mo id="S2.Ex5.m1.6.6.1.1.4.2a" xref="S2.Ex5.m1.6.6.1.1.4.1.cmml">⁡</mo><mrow id="S2.Ex5.m1.6.6.1.1.4.2.1" xref="S2.Ex5.m1.6.6.1.1.4.1.cmml"><mo id="S2.Ex5.m1.6.6.1.1.4.2.1.1" stretchy="false" xref="S2.Ex5.m1.6.6.1.1.4.1.cmml">(</mo><mi id="S2.Ex5.m1.2.2" xref="S2.Ex5.m1.2.2.cmml">i</mi><mo id="S2.Ex5.m1.6.6.1.1.4.2.1.2" xref="S2.Ex5.m1.6.6.1.1.4.1.cmml">,</mo><mi id="S2.Ex5.m1.3.3" xref="S2.Ex5.m1.3.3.cmml">j</mi><mo id="S2.Ex5.m1.6.6.1.1.4.2.1.3" stretchy="false" xref="S2.Ex5.m1.6.6.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex5.m1.6.6.1.1.3" xref="S2.Ex5.m1.6.6.1.1.3.cmml">=</mo><mrow id="S2.Ex5.m1.6.6.1.1.2" xref="S2.Ex5.m1.6.6.1.1.2.cmml"><mrow id="S2.Ex5.m1.6.6.1.1.1.1.1" xref="S2.Ex5.m1.6.6.1.1.1.1.2.cmml"><mi id="S2.Ex5.m1.4.4" xref="S2.Ex5.m1.4.4.cmml">sin</mi><mo id="S2.Ex5.m1.6.6.1.1.1.1.1a" xref="S2.Ex5.m1.6.6.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.Ex5.m1.6.6.1.1.1.1.1.1" xref="S2.Ex5.m1.6.6.1.1.1.1.2.cmml"><mo id="S2.Ex5.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="S2.Ex5.m1.6.6.1.1.1.1.2.cmml">(</mo><mrow id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.2" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.1" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.1.cmml">/</mo><msup id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mn id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.cmml">10000</mn><mrow id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.2" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.2.cmml">j</mi><mo id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.1" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.1.cmml">/</mo><msub id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.2" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.2.cmml">d</mi><mrow id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.2" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.2.cmml">m</mi><mo id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.1" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.3" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.3.cmml">o</mi><mo id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.1a" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.4" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.4.cmml">d</mi><mo id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.1b" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.5" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.5.cmml">e</mi><mo id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.1c" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.6" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow><mo id="S2.Ex5.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="S2.Ex5.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.Ex5.m1.6.6.1.1.2.3" xref="S2.Ex5.m1.6.6.1.1.2.3.cmml">+</mo><mrow id="S2.Ex5.m1.6.6.1.1.2.2.1" xref="S2.Ex5.m1.6.6.1.1.2.2.2.cmml"><mi id="S2.Ex5.m1.5.5" xref="S2.Ex5.m1.5.5.cmml">cos</mi><mo id="S2.Ex5.m1.6.6.1.1.2.2.1a" xref="S2.Ex5.m1.6.6.1.1.2.2.2.cmml">⁡</mo><mrow id="S2.Ex5.m1.6.6.1.1.2.2.1.1" xref="S2.Ex5.m1.6.6.1.1.2.2.2.cmml"><mo id="S2.Ex5.m1.6.6.1.1.2.2.1.1.2" stretchy="false" xref="S2.Ex5.m1.6.6.1.1.2.2.2.cmml">(</mo><mrow id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.cmml"><mi id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.2" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.2.cmml">i</mi><mo id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.1" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.1.cmml">/</mo><msup id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.cmml"><mn id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.2" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.2.cmml">10000</mn><mrow id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.cmml"><mi id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.2" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.2.cmml">j</mi><mo id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.1" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.1.cmml">/</mo><msub id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.cmml"><mi id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.2" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.2.cmml">d</mi><mrow id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.cmml"><mi id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.2" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.2.cmml">m</mi><mo id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.1" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.3" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.3.cmml">o</mi><mo id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.1a" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.4" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.4.cmml">d</mi><mo id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.1b" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.5" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.5.cmml">e</mi><mo id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.1c" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.6" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow><mo id="S2.Ex5.m1.6.6.1.1.2.2.1.1.3" stretchy="false" xref="S2.Ex5.m1.6.6.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex5.m1.6.6.1.2" lspace="0em" xref="S2.Ex5.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex5.m1.6b"><apply id="S2.Ex5.m1.6.6.1.1.cmml" xref="S2.Ex5.m1.6.6.1"><eq id="S2.Ex5.m1.6.6.1.1.3.cmml" xref="S2.Ex5.m1.6.6.1.1.3"></eq><apply id="S2.Ex5.m1.6.6.1.1.4.1.cmml" xref="S2.Ex5.m1.6.6.1.1.4.2"><ci id="S2.Ex5.m1.1.1.cmml" xref="S2.Ex5.m1.1.1">PE</ci><ci id="S2.Ex5.m1.2.2.cmml" xref="S2.Ex5.m1.2.2">𝑖</ci><ci id="S2.Ex5.m1.3.3.cmml" xref="S2.Ex5.m1.3.3">𝑗</ci></apply><apply id="S2.Ex5.m1.6.6.1.1.2.cmml" xref="S2.Ex5.m1.6.6.1.1.2"><plus id="S2.Ex5.m1.6.6.1.1.2.3.cmml" xref="S2.Ex5.m1.6.6.1.1.2.3"></plus><apply id="S2.Ex5.m1.6.6.1.1.1.1.2.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1"><sin id="S2.Ex5.m1.4.4.cmml" xref="S2.Ex5.m1.4.4"></sin><apply id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1"><divide id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.1"></divide><ci id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.2">𝑖</ci><apply id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3">superscript</csymbol><cn id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2">10000</cn><apply id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3"><divide id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.1"></divide><ci id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.2">𝑗</ci><apply id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.2">𝑑</ci><apply id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3"><times id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.1"></times><ci id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.2">𝑚</ci><ci id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.3">𝑜</ci><ci id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.4.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.4">𝑑</ci><ci id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.5.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.5">𝑒</ci><ci id="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.6.cmml" xref="S2.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.3.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply><apply id="S2.Ex5.m1.6.6.1.1.2.2.2.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1"><cos id="S2.Ex5.m1.5.5.cmml" xref="S2.Ex5.m1.5.5"></cos><apply id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1"><divide id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.1.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.1"></divide><ci id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.2.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.2">𝑖</ci><apply id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.1.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3">superscript</csymbol><cn id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.2.cmml" type="integer" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.2">10000</cn><apply id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3"><divide id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.1.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.1"></divide><ci id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.2.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.2">𝑗</ci><apply id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.1.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3">subscript</csymbol><ci id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.2.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.2">𝑑</ci><apply id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3"><times id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.1.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.1"></times><ci id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.2.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.2">𝑚</ci><ci id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.3.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.3">𝑜</ci><ci id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.4.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.4">𝑑</ci><ci id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.5.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.5">𝑒</ci><ci id="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.6.cmml" xref="S2.Ex5.m1.6.6.1.1.2.2.1.1.1.3.3.3.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex5.m1.6c">\operatorname{PE}(i,j)=\sin(i/10000^{j/d_{model}})+\cos(i/10000^{j/d_{model}}).</annotation><annotation encoding="application/x-llamapun" id="S2.Ex5.m1.6d">roman_PE ( italic_i , italic_j ) = roman_sin ( italic_i / 10000 start_POSTSUPERSCRIPT italic_j / italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) + roman_cos ( italic_i / 10000 start_POSTSUPERSCRIPT italic_j / italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>The Encoder-Decoder architecture</h3>
<div class="ltx_para ltx_noindent" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.3">The encoder-decoder architecture in transformers forms the backbone of many advanced models in natural language processing and beyond. In this architecture, the encoder processes the input sequence, transforming it into a rich, contextual representation. Here we briefly describe the architecture proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib20" title="">20</a>]</cite>, which we use in our model in conjunction with LAM. Each encoder layer consists of a multi-head self-attention mechanism, which allows the model to weigh the importance of different parts of the input relative to each other, and two linear projections acting on the dimension of the variables (i.e. the last dimension of the input) with activation functions. Formally, these linear projections act as the matrix <math alttext="W^{O}" class="ltx_Math" display="inline" id="S2.SS4.p1.1.m1.1"><semantics id="S2.SS4.p1.1.m1.1a"><msup id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml"><mi id="S2.SS4.p1.1.m1.1.1.2" xref="S2.SS4.p1.1.m1.1.1.2.cmml">W</mi><mi id="S2.SS4.p1.1.m1.1.1.3" xref="S2.SS4.p1.1.m1.1.1.3.cmml">O</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><apply id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS4.p1.1.m1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.1.2">𝑊</ci><ci id="S2.SS4.p1.1.m1.1.1.3.cmml" xref="S2.SS4.p1.1.m1.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">W^{O}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.1d">italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT</annotation></semantics></math> in the definition of <math alttext="\operatorname{MultiHead}" class="ltx_Math" display="inline" id="S2.SS4.p1.2.m2.1"><semantics id="S2.SS4.p1.2.m2.1a"><mi id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml">MultiHead</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><ci id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">MultiHead</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">\operatorname{MultiHead}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">roman_MultiHead</annotation></semantics></math>, they are represented as <math alttext="d_{model}\times d_{model}" class="ltx_Math" display="inline" id="S2.SS4.p1.3.m3.1"><semantics id="S2.SS4.p1.3.m3.1a"><mrow id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml"><msub id="S2.SS4.p1.3.m3.1.1.2" xref="S2.SS4.p1.3.m3.1.1.2.cmml"><mi id="S2.SS4.p1.3.m3.1.1.2.2" xref="S2.SS4.p1.3.m3.1.1.2.2.cmml">d</mi><mrow id="S2.SS4.p1.3.m3.1.1.2.3" xref="S2.SS4.p1.3.m3.1.1.2.3.cmml"><mi id="S2.SS4.p1.3.m3.1.1.2.3.2" xref="S2.SS4.p1.3.m3.1.1.2.3.2.cmml">m</mi><mo id="S2.SS4.p1.3.m3.1.1.2.3.1" xref="S2.SS4.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p1.3.m3.1.1.2.3.3" xref="S2.SS4.p1.3.m3.1.1.2.3.3.cmml">o</mi><mo id="S2.SS4.p1.3.m3.1.1.2.3.1a" xref="S2.SS4.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p1.3.m3.1.1.2.3.4" xref="S2.SS4.p1.3.m3.1.1.2.3.4.cmml">d</mi><mo id="S2.SS4.p1.3.m3.1.1.2.3.1b" xref="S2.SS4.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p1.3.m3.1.1.2.3.5" xref="S2.SS4.p1.3.m3.1.1.2.3.5.cmml">e</mi><mo id="S2.SS4.p1.3.m3.1.1.2.3.1c" xref="S2.SS4.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p1.3.m3.1.1.2.3.6" xref="S2.SS4.p1.3.m3.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.SS4.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p1.3.m3.1.1.1.cmml">×</mo><msub id="S2.SS4.p1.3.m3.1.1.3" xref="S2.SS4.p1.3.m3.1.1.3.cmml"><mi id="S2.SS4.p1.3.m3.1.1.3.2" xref="S2.SS4.p1.3.m3.1.1.3.2.cmml">d</mi><mrow id="S2.SS4.p1.3.m3.1.1.3.3" xref="S2.SS4.p1.3.m3.1.1.3.3.cmml"><mi id="S2.SS4.p1.3.m3.1.1.3.3.2" xref="S2.SS4.p1.3.m3.1.1.3.3.2.cmml">m</mi><mo id="S2.SS4.p1.3.m3.1.1.3.3.1" xref="S2.SS4.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS4.p1.3.m3.1.1.3.3.3" xref="S2.SS4.p1.3.m3.1.1.3.3.3.cmml">o</mi><mo id="S2.SS4.p1.3.m3.1.1.3.3.1a" xref="S2.SS4.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS4.p1.3.m3.1.1.3.3.4" xref="S2.SS4.p1.3.m3.1.1.3.3.4.cmml">d</mi><mo id="S2.SS4.p1.3.m3.1.1.3.3.1b" xref="S2.SS4.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS4.p1.3.m3.1.1.3.3.5" xref="S2.SS4.p1.3.m3.1.1.3.3.5.cmml">e</mi><mo id="S2.SS4.p1.3.m3.1.1.3.3.1c" xref="S2.SS4.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS4.p1.3.m3.1.1.3.3.6" xref="S2.SS4.p1.3.m3.1.1.3.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><apply id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1"><times id="S2.SS4.p1.3.m3.1.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1.1"></times><apply id="S2.SS4.p1.3.m3.1.1.2.cmml" xref="S2.SS4.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p1.3.m3.1.1.2.1.cmml" xref="S2.SS4.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.SS4.p1.3.m3.1.1.2.2.cmml" xref="S2.SS4.p1.3.m3.1.1.2.2">𝑑</ci><apply id="S2.SS4.p1.3.m3.1.1.2.3.cmml" xref="S2.SS4.p1.3.m3.1.1.2.3"><times id="S2.SS4.p1.3.m3.1.1.2.3.1.cmml" xref="S2.SS4.p1.3.m3.1.1.2.3.1"></times><ci id="S2.SS4.p1.3.m3.1.1.2.3.2.cmml" xref="S2.SS4.p1.3.m3.1.1.2.3.2">𝑚</ci><ci id="S2.SS4.p1.3.m3.1.1.2.3.3.cmml" xref="S2.SS4.p1.3.m3.1.1.2.3.3">𝑜</ci><ci id="S2.SS4.p1.3.m3.1.1.2.3.4.cmml" xref="S2.SS4.p1.3.m3.1.1.2.3.4">𝑑</ci><ci id="S2.SS4.p1.3.m3.1.1.2.3.5.cmml" xref="S2.SS4.p1.3.m3.1.1.2.3.5">𝑒</ci><ci id="S2.SS4.p1.3.m3.1.1.2.3.6.cmml" xref="S2.SS4.p1.3.m3.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S2.SS4.p1.3.m3.1.1.3.cmml" xref="S2.SS4.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p1.3.m3.1.1.3.1.cmml" xref="S2.SS4.p1.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS4.p1.3.m3.1.1.3.2.cmml" xref="S2.SS4.p1.3.m3.1.1.3.2">𝑑</ci><apply id="S2.SS4.p1.3.m3.1.1.3.3.cmml" xref="S2.SS4.p1.3.m3.1.1.3.3"><times id="S2.SS4.p1.3.m3.1.1.3.3.1.cmml" xref="S2.SS4.p1.3.m3.1.1.3.3.1"></times><ci id="S2.SS4.p1.3.m3.1.1.3.3.2.cmml" xref="S2.SS4.p1.3.m3.1.1.3.3.2">𝑚</ci><ci id="S2.SS4.p1.3.m3.1.1.3.3.3.cmml" xref="S2.SS4.p1.3.m3.1.1.3.3.3">𝑜</ci><ci id="S2.SS4.p1.3.m3.1.1.3.3.4.cmml" xref="S2.SS4.p1.3.m3.1.1.3.3.4">𝑑</ci><ci id="S2.SS4.p1.3.m3.1.1.3.3.5.cmml" xref="S2.SS4.p1.3.m3.1.1.3.3.5">𝑒</ci><ci id="S2.SS4.p1.3.m3.1.1.3.3.6.cmml" xref="S2.SS4.p1.3.m3.1.1.3.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">d_{model}\times d_{model}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.3.m3.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math> matrices, but they have LeakyReLu activation functions on the outputs. The purpose of projection layers is to learn a domain representation that boosts the performance of the attention mechanism.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.1">The decoder layers are similar to the encoder layers. The main difference is that they apply two multi-head self-attention layers. In the first multi-head self-attention, the queries, keys and values are set to the input of the layer, whereas in the second one the keys and queries are set to the output of the encoder and the values to the input of the layer. This is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S2.F1" title="Figure 1 ‣ 2.4 The Encoder-Decoder architecture ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">1</span></a>. This second attention layer that helps the decoder to focus on relevant parts of the input sequence, enhancing its ability to produce contextually relevant outputs. We highlight the presence of residual connections in the encoder and decoder layers. These residual connections consist in adding the input of the attention mechanism its the output, reducing the loss of positional information.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.6">Once the encoder and decoder layers are defined, the architecture of the vanilla transformer is relatively simple: the encoder consists of <math alttext="N" class="ltx_Math" display="inline" id="S2.SS4.p3.1.m1.1"><semantics id="S2.SS4.p3.1.m1.1a"><mi id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b"><ci id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.1.m1.1d">italic_N</annotation></semantics></math> consecutive applications of the encoder layer and the decoder consists of <math alttext="N" class="ltx_Math" display="inline" id="S2.SS4.p3.2.m2.1"><semantics id="S2.SS4.p3.2.m2.1a"><mi id="S2.SS4.p3.2.m2.1.1" xref="S2.SS4.p3.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.2.m2.1b"><ci id="S2.SS4.p3.2.m2.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.2.m2.1d">italic_N</annotation></semantics></math> consecutive applications of the decoder layer. The value of <math alttext="N" class="ltx_Math" display="inline" id="S2.SS4.p3.3.m3.1"><semantics id="S2.SS4.p3.3.m3.1a"><mi id="S2.SS4.p3.3.m3.1.1" xref="S2.SS4.p3.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.3.m3.1b"><ci id="S2.SS4.p3.3.m3.1.1.cmml" xref="S2.SS4.p3.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.3.m3.1d">italic_N</annotation></semantics></math> can be picked in each application, and will be provided it in each one of our experiments. We note that increasing <math alttext="N" class="ltx_Math" display="inline" id="S2.SS4.p3.4.m4.1"><semantics id="S2.SS4.p3.4.m4.1a"><mi id="S2.SS4.p3.4.m4.1.1" xref="S2.SS4.p3.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.4.m4.1b"><ci id="S2.SS4.p3.4.m4.1.1.cmml" xref="S2.SS4.p3.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.4.m4.1d">italic_N</annotation></semantics></math> does not significantly change the number of parameters of the model, as the feed forward layers applied in the encoder and decoder layers are linear projections, as described above, which have <math alttext="d_{model}^{2}" class="ltx_Math" display="inline" id="S2.SS4.p3.5.m5.1"><semantics id="S2.SS4.p3.5.m5.1a"><msubsup id="S2.SS4.p3.5.m5.1.1" xref="S2.SS4.p3.5.m5.1.1.cmml"><mi id="S2.SS4.p3.5.m5.1.1.2.2" xref="S2.SS4.p3.5.m5.1.1.2.2.cmml">d</mi><mrow id="S2.SS4.p3.5.m5.1.1.2.3" xref="S2.SS4.p3.5.m5.1.1.2.3.cmml"><mi id="S2.SS4.p3.5.m5.1.1.2.3.2" xref="S2.SS4.p3.5.m5.1.1.2.3.2.cmml">m</mi><mo id="S2.SS4.p3.5.m5.1.1.2.3.1" xref="S2.SS4.p3.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p3.5.m5.1.1.2.3.3" xref="S2.SS4.p3.5.m5.1.1.2.3.3.cmml">o</mi><mo id="S2.SS4.p3.5.m5.1.1.2.3.1a" xref="S2.SS4.p3.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p3.5.m5.1.1.2.3.4" xref="S2.SS4.p3.5.m5.1.1.2.3.4.cmml">d</mi><mo id="S2.SS4.p3.5.m5.1.1.2.3.1b" xref="S2.SS4.p3.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p3.5.m5.1.1.2.3.5" xref="S2.SS4.p3.5.m5.1.1.2.3.5.cmml">e</mi><mo id="S2.SS4.p3.5.m5.1.1.2.3.1c" xref="S2.SS4.p3.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p3.5.m5.1.1.2.3.6" xref="S2.SS4.p3.5.m5.1.1.2.3.6.cmml">l</mi></mrow><mn id="S2.SS4.p3.5.m5.1.1.3" xref="S2.SS4.p3.5.m5.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.5.m5.1b"><apply id="S2.SS4.p3.5.m5.1.1.cmml" xref="S2.SS4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.5.m5.1.1.1.cmml" xref="S2.SS4.p3.5.m5.1.1">superscript</csymbol><apply id="S2.SS4.p3.5.m5.1.1.2.cmml" xref="S2.SS4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.5.m5.1.1.2.1.cmml" xref="S2.SS4.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS4.p3.5.m5.1.1.2.2.cmml" xref="S2.SS4.p3.5.m5.1.1.2.2">𝑑</ci><apply id="S2.SS4.p3.5.m5.1.1.2.3.cmml" xref="S2.SS4.p3.5.m5.1.1.2.3"><times id="S2.SS4.p3.5.m5.1.1.2.3.1.cmml" xref="S2.SS4.p3.5.m5.1.1.2.3.1"></times><ci id="S2.SS4.p3.5.m5.1.1.2.3.2.cmml" xref="S2.SS4.p3.5.m5.1.1.2.3.2">𝑚</ci><ci id="S2.SS4.p3.5.m5.1.1.2.3.3.cmml" xref="S2.SS4.p3.5.m5.1.1.2.3.3">𝑜</ci><ci id="S2.SS4.p3.5.m5.1.1.2.3.4.cmml" xref="S2.SS4.p3.5.m5.1.1.2.3.4">𝑑</ci><ci id="S2.SS4.p3.5.m5.1.1.2.3.5.cmml" xref="S2.SS4.p3.5.m5.1.1.2.3.5">𝑒</ci><ci id="S2.SS4.p3.5.m5.1.1.2.3.6.cmml" xref="S2.SS4.p3.5.m5.1.1.2.3.6">𝑙</ci></apply></apply><cn id="S2.SS4.p3.5.m5.1.1.3.cmml" type="integer" xref="S2.SS4.p3.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.5.m5.1c">d_{model}^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.5.m5.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> parameters. That is, the number of parameters in the encoder and the decoder layers is <math alttext="\Theta(d_{model}^{2})" class="ltx_Math" display="inline" id="S2.SS4.p3.6.m6.1"><semantics id="S2.SS4.p3.6.m6.1a"><mrow id="S2.SS4.p3.6.m6.1.1" xref="S2.SS4.p3.6.m6.1.1.cmml"><mi id="S2.SS4.p3.6.m6.1.1.3" mathvariant="normal" xref="S2.SS4.p3.6.m6.1.1.3.cmml">Θ</mi><mo id="S2.SS4.p3.6.m6.1.1.2" xref="S2.SS4.p3.6.m6.1.1.2.cmml">⁢</mo><mrow id="S2.SS4.p3.6.m6.1.1.1.1" xref="S2.SS4.p3.6.m6.1.1.1.1.1.cmml"><mo id="S2.SS4.p3.6.m6.1.1.1.1.2" stretchy="false" xref="S2.SS4.p3.6.m6.1.1.1.1.1.cmml">(</mo><msubsup id="S2.SS4.p3.6.m6.1.1.1.1.1" xref="S2.SS4.p3.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS4.p3.6.m6.1.1.1.1.1.2.2" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.cmml"><mi id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.2" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.2.cmml">m</mi><mo id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.1" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.3" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.3.cmml">o</mi><mo id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.1a" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.4" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.4.cmml">d</mi><mo id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.1b" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.5" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.5.cmml">e</mi><mo id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.1c" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.6" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.6.cmml">l</mi></mrow><mn id="S2.SS4.p3.6.m6.1.1.1.1.1.3" xref="S2.SS4.p3.6.m6.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S2.SS4.p3.6.m6.1.1.1.1.3" stretchy="false" xref="S2.SS4.p3.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.6.m6.1b"><apply id="S2.SS4.p3.6.m6.1.1.cmml" xref="S2.SS4.p3.6.m6.1.1"><times id="S2.SS4.p3.6.m6.1.1.2.cmml" xref="S2.SS4.p3.6.m6.1.1.2"></times><ci id="S2.SS4.p3.6.m6.1.1.3.cmml" xref="S2.SS4.p3.6.m6.1.1.3">Θ</ci><apply id="S2.SS4.p3.6.m6.1.1.1.1.1.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1">superscript</csymbol><apply id="S2.SS4.p3.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m6.1.1.1.1.1.2.1.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p3.6.m6.1.1.1.1.1.2.2.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3"><times id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.1.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.1"></times><ci id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.2.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.2">𝑚</ci><ci id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.3.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.3">𝑜</ci><ci id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.4.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.4">𝑑</ci><ci id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.5.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.5">𝑒</ci><ci id="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.6.cmml" xref="S2.SS4.p3.6.m6.1.1.1.1.1.2.3.6">𝑙</ci></apply></apply><cn id="S2.SS4.p3.6.m6.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS4.p3.6.m6.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.6.m6.1c">\Theta(d_{model}^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.6.m6.1d">roman_Θ ( italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.p4">
<p class="ltx_p" id="S2.SS4.p4.5">Finally, the output of the last decoder layer goes through a linear layer. To reduce the number of parameters, we have implemented this layer as a projection on the time dimension, that is, if the input of the transformer has <math alttext="n" class="ltx_Math" display="inline" id="S2.SS4.p4.1.m1.1"><semantics id="S2.SS4.p4.1.m1.1a"><mi id="S2.SS4.p4.1.m1.1.1" xref="S2.SS4.p4.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.1.m1.1b"><ci id="S2.SS4.p4.1.m1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.1.m1.1d">italic_n</annotation></semantics></math> elements of the time series, this linear layer corresponds to a matrix <math alttext="n\times m" class="ltx_Math" display="inline" id="S2.SS4.p4.2.m2.1"><semantics id="S2.SS4.p4.2.m2.1a"><mrow id="S2.SS4.p4.2.m2.1.1" xref="S2.SS4.p4.2.m2.1.1.cmml"><mi id="S2.SS4.p4.2.m2.1.1.2" xref="S2.SS4.p4.2.m2.1.1.2.cmml">n</mi><mo id="S2.SS4.p4.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p4.2.m2.1.1.1.cmml">×</mo><mi id="S2.SS4.p4.2.m2.1.1.3" xref="S2.SS4.p4.2.m2.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.2.m2.1b"><apply id="S2.SS4.p4.2.m2.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1"><times id="S2.SS4.p4.2.m2.1.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1.1"></times><ci id="S2.SS4.p4.2.m2.1.1.2.cmml" xref="S2.SS4.p4.2.m2.1.1.2">𝑛</ci><ci id="S2.SS4.p4.2.m2.1.1.3.cmml" xref="S2.SS4.p4.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.2.m2.1c">n\times m</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.2.m2.1d">italic_n × italic_m</annotation></semantics></math> that <math alttext="m" class="ltx_Math" display="inline" id="S2.SS4.p4.3.m3.1"><semantics id="S2.SS4.p4.3.m3.1a"><mi id="S2.SS4.p4.3.m3.1.1" xref="S2.SS4.p4.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.3.m3.1b"><ci id="S2.SS4.p4.3.m3.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.3.m3.1d">italic_m</annotation></semantics></math> computes linear combinations of the <math alttext="n" class="ltx_Math" display="inline" id="S2.SS4.p4.4.m4.1"><semantics id="S2.SS4.p4.4.m4.1a"><mi id="S2.SS4.p4.4.m4.1.1" xref="S2.SS4.p4.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.4.m4.1b"><ci id="S2.SS4.p4.4.m4.1.1.cmml" xref="S2.SS4.p4.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.4.m4.1d">italic_n</annotation></semantics></math> points produced in the last decoding layer, where <math alttext="m" class="ltx_Math" display="inline" id="S2.SS4.p4.5.m5.1"><semantics id="S2.SS4.p4.5.m5.1a"><mi id="S2.SS4.p4.5.m5.1.1" xref="S2.SS4.p4.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.5.m5.1b"><ci id="S2.SS4.p4.5.m5.1.1.cmml" xref="S2.SS4.p4.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.5.m5.1d">italic_m</annotation></semantics></math> is the number of points that we want to forecast. This is the output of our model, as we do not need to perform a softmax layer to compute probabilities.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="562" id="S2.F1.g1" src="x1.png" width="450"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Transformer architecture used for LAM.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Local Attention Mechanism (LAM)</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section we introduce our proposal, the LAM mechanism, and an efficient algorithm, based on expressing LAM in tensor algebra, that leads to <math alttext="\Theta(n\log n)" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.3" mathvariant="normal" xref="S3.p1.1.m1.1.1.3.cmml">Θ</mi><mo id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.p1.1.m1.1.1.1.1" xref="S3.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.1.m1.1.1.1.1.1" xref="S3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.1.1.1.2" xref="S3.p1.1.m1.1.1.1.1.1.2.cmml">n</mi><mo id="S3.p1.1.m1.1.1.1.1.1.1" lspace="0.167em" xref="S3.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.p1.1.m1.1.1.1.1.1.3" xref="S3.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.1.1.1.3.1" xref="S3.p1.1.m1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.p1.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.p1.1.m1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.p1.1.m1.1.1.1.1.1.3.2" xref="S3.p1.1.m1.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><times id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2"></times><ci id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3">Θ</ci><apply id="S3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1"><times id="S3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1"></times><ci id="S3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.2">𝑛</ci><apply id="S3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.1.1.1.3"><log id="S3.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.3.1"></log><ci id="S3.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math> memory and time complexity. This algorithm has been implemented in stock Pytorch and TensorFlow without the need for any low level CUDA code.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">The high-level fundamental behind LAM is exploiting locality in order to re-define the attention mechanism. Previous studies on time series have empirically shown that the rows of the attention scores matrix behave as long tail distributions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>. This behaviour is present at <span class="ltx_text ltx_font_italic" id="S3.p2.1.1">any</span> layer independently of the depth. For example, the coefficients <math alttext="a_{n-1,0},a_{n-1,1},\ldots,a_{n-1,n-1}" class="ltx_Math" display="inline" id="S3.p2.1.m1.10"><semantics id="S3.p2.1.m1.10a"><mrow id="S3.p2.1.m1.10.10.3" xref="S3.p2.1.m1.10.10.4.cmml"><msub id="S3.p2.1.m1.8.8.1.1" xref="S3.p2.1.m1.8.8.1.1.cmml"><mi id="S3.p2.1.m1.8.8.1.1.2" xref="S3.p2.1.m1.8.8.1.1.2.cmml">a</mi><mrow id="S3.p2.1.m1.2.2.2.2" xref="S3.p2.1.m1.2.2.2.3.cmml"><mrow id="S3.p2.1.m1.2.2.2.2.1" xref="S3.p2.1.m1.2.2.2.2.1.cmml"><mi id="S3.p2.1.m1.2.2.2.2.1.2" xref="S3.p2.1.m1.2.2.2.2.1.2.cmml">n</mi><mo id="S3.p2.1.m1.2.2.2.2.1.1" xref="S3.p2.1.m1.2.2.2.2.1.1.cmml">−</mo><mn id="S3.p2.1.m1.2.2.2.2.1.3" xref="S3.p2.1.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.p2.1.m1.2.2.2.2.2" xref="S3.p2.1.m1.2.2.2.3.cmml">,</mo><mn id="S3.p2.1.m1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.cmml">0</mn></mrow></msub><mo id="S3.p2.1.m1.10.10.3.4" xref="S3.p2.1.m1.10.10.4.cmml">,</mo><msub id="S3.p2.1.m1.9.9.2.2" xref="S3.p2.1.m1.9.9.2.2.cmml"><mi id="S3.p2.1.m1.9.9.2.2.2" xref="S3.p2.1.m1.9.9.2.2.2.cmml">a</mi><mrow id="S3.p2.1.m1.4.4.2.2" xref="S3.p2.1.m1.4.4.2.3.cmml"><mrow id="S3.p2.1.m1.4.4.2.2.1" xref="S3.p2.1.m1.4.4.2.2.1.cmml"><mi id="S3.p2.1.m1.4.4.2.2.1.2" xref="S3.p2.1.m1.4.4.2.2.1.2.cmml">n</mi><mo id="S3.p2.1.m1.4.4.2.2.1.1" xref="S3.p2.1.m1.4.4.2.2.1.1.cmml">−</mo><mn id="S3.p2.1.m1.4.4.2.2.1.3" xref="S3.p2.1.m1.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S3.p2.1.m1.4.4.2.2.2" xref="S3.p2.1.m1.4.4.2.3.cmml">,</mo><mn id="S3.p2.1.m1.3.3.1.1" xref="S3.p2.1.m1.3.3.1.1.cmml">1</mn></mrow></msub><mo id="S3.p2.1.m1.10.10.3.5" xref="S3.p2.1.m1.10.10.4.cmml">,</mo><mi id="S3.p2.1.m1.7.7" mathvariant="normal" xref="S3.p2.1.m1.7.7.cmml">…</mi><mo id="S3.p2.1.m1.10.10.3.6" xref="S3.p2.1.m1.10.10.4.cmml">,</mo><msub id="S3.p2.1.m1.10.10.3.3" xref="S3.p2.1.m1.10.10.3.3.cmml"><mi id="S3.p2.1.m1.10.10.3.3.2" xref="S3.p2.1.m1.10.10.3.3.2.cmml">a</mi><mrow id="S3.p2.1.m1.6.6.2.2" xref="S3.p2.1.m1.6.6.2.3.cmml"><mrow id="S3.p2.1.m1.5.5.1.1.1" xref="S3.p2.1.m1.5.5.1.1.1.cmml"><mi id="S3.p2.1.m1.5.5.1.1.1.2" xref="S3.p2.1.m1.5.5.1.1.1.2.cmml">n</mi><mo id="S3.p2.1.m1.5.5.1.1.1.1" xref="S3.p2.1.m1.5.5.1.1.1.1.cmml">−</mo><mn id="S3.p2.1.m1.5.5.1.1.1.3" xref="S3.p2.1.m1.5.5.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p2.1.m1.6.6.2.2.3" xref="S3.p2.1.m1.6.6.2.3.cmml">,</mo><mrow id="S3.p2.1.m1.6.6.2.2.2" xref="S3.p2.1.m1.6.6.2.2.2.cmml"><mi id="S3.p2.1.m1.6.6.2.2.2.2" xref="S3.p2.1.m1.6.6.2.2.2.2.cmml">n</mi><mo id="S3.p2.1.m1.6.6.2.2.2.1" xref="S3.p2.1.m1.6.6.2.2.2.1.cmml">−</mo><mn id="S3.p2.1.m1.6.6.2.2.2.3" xref="S3.p2.1.m1.6.6.2.2.2.3.cmml">1</mn></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.10b"><list id="S3.p2.1.m1.10.10.4.cmml" xref="S3.p2.1.m1.10.10.3"><apply id="S3.p2.1.m1.8.8.1.1.cmml" xref="S3.p2.1.m1.8.8.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.8.8.1.1.1.cmml" xref="S3.p2.1.m1.8.8.1.1">subscript</csymbol><ci id="S3.p2.1.m1.8.8.1.1.2.cmml" xref="S3.p2.1.m1.8.8.1.1.2">𝑎</ci><list id="S3.p2.1.m1.2.2.2.3.cmml" xref="S3.p2.1.m1.2.2.2.2"><apply id="S3.p2.1.m1.2.2.2.2.1.cmml" xref="S3.p2.1.m1.2.2.2.2.1"><minus id="S3.p2.1.m1.2.2.2.2.1.1.cmml" xref="S3.p2.1.m1.2.2.2.2.1.1"></minus><ci id="S3.p2.1.m1.2.2.2.2.1.2.cmml" xref="S3.p2.1.m1.2.2.2.2.1.2">𝑛</ci><cn id="S3.p2.1.m1.2.2.2.2.1.3.cmml" type="integer" xref="S3.p2.1.m1.2.2.2.2.1.3">1</cn></apply><cn id="S3.p2.1.m1.1.1.1.1.cmml" type="integer" xref="S3.p2.1.m1.1.1.1.1">0</cn></list></apply><apply id="S3.p2.1.m1.9.9.2.2.cmml" xref="S3.p2.1.m1.9.9.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.9.9.2.2.1.cmml" xref="S3.p2.1.m1.9.9.2.2">subscript</csymbol><ci id="S3.p2.1.m1.9.9.2.2.2.cmml" xref="S3.p2.1.m1.9.9.2.2.2">𝑎</ci><list id="S3.p2.1.m1.4.4.2.3.cmml" xref="S3.p2.1.m1.4.4.2.2"><apply id="S3.p2.1.m1.4.4.2.2.1.cmml" xref="S3.p2.1.m1.4.4.2.2.1"><minus id="S3.p2.1.m1.4.4.2.2.1.1.cmml" xref="S3.p2.1.m1.4.4.2.2.1.1"></minus><ci id="S3.p2.1.m1.4.4.2.2.1.2.cmml" xref="S3.p2.1.m1.4.4.2.2.1.2">𝑛</ci><cn id="S3.p2.1.m1.4.4.2.2.1.3.cmml" type="integer" xref="S3.p2.1.m1.4.4.2.2.1.3">1</cn></apply><cn id="S3.p2.1.m1.3.3.1.1.cmml" type="integer" xref="S3.p2.1.m1.3.3.1.1">1</cn></list></apply><ci id="S3.p2.1.m1.7.7.cmml" xref="S3.p2.1.m1.7.7">…</ci><apply id="S3.p2.1.m1.10.10.3.3.cmml" xref="S3.p2.1.m1.10.10.3.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.10.10.3.3.1.cmml" xref="S3.p2.1.m1.10.10.3.3">subscript</csymbol><ci id="S3.p2.1.m1.10.10.3.3.2.cmml" xref="S3.p2.1.m1.10.10.3.3.2">𝑎</ci><list id="S3.p2.1.m1.6.6.2.3.cmml" xref="S3.p2.1.m1.6.6.2.2"><apply id="S3.p2.1.m1.5.5.1.1.1.cmml" xref="S3.p2.1.m1.5.5.1.1.1"><minus id="S3.p2.1.m1.5.5.1.1.1.1.cmml" xref="S3.p2.1.m1.5.5.1.1.1.1"></minus><ci id="S3.p2.1.m1.5.5.1.1.1.2.cmml" xref="S3.p2.1.m1.5.5.1.1.1.2">𝑛</ci><cn id="S3.p2.1.m1.5.5.1.1.1.3.cmml" type="integer" xref="S3.p2.1.m1.5.5.1.1.1.3">1</cn></apply><apply id="S3.p2.1.m1.6.6.2.2.2.cmml" xref="S3.p2.1.m1.6.6.2.2.2"><minus id="S3.p2.1.m1.6.6.2.2.2.1.cmml" xref="S3.p2.1.m1.6.6.2.2.2.1"></minus><ci id="S3.p2.1.m1.6.6.2.2.2.2.cmml" xref="S3.p2.1.m1.6.6.2.2.2.2">𝑛</ci><cn id="S3.p2.1.m1.6.6.2.2.2.3.cmml" type="integer" xref="S3.p2.1.m1.6.6.2.2.2.3">1</cn></apply></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.10c">a_{n-1,0},a_{n-1,1},\ldots,a_{n-1,n-1}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.10d">italic_a start_POSTSUBSCRIPT italic_n - 1 , 0 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_n - 1 , 1 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_n - 1 , italic_n - 1 end_POSTSUBSCRIPT</annotation></semantics></math> of the last row of the score matrix are mostly increasing, with most of the probability mass function being allocated to the last few coefficients, which contrasts to the behaviour of the attention mechanism on language related tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib36" title="">36</a>]</cite>. Even though both NLP and time series forecasting deal with sequences of data, the main difference relies on the nature of this data. In NLP words are embedded into a vector space so that words related in meaning have similar dot product. Moreover, words with related meaning may come up far apart in a paragraph whereas consecutive words may have small dot product. On the other hand, most variables in time series problems are continuous and, thus, data tends to be extremely similar around a particular timestamp, hence leading to the larger attention scores in that region. This motivates the following working hypothesis for this research.</p>
</div>
<div class="ltx_theorem ltx_theorem_hyp" id="Thmhyp1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmhyp1.1.1.1">Hypothesis 1</span></span><span class="ltx_text ltx_font_bold" id="Thmhyp1.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmhyp1.p1">
<p class="ltx_p" id="Thmhyp1.p1.6"><span class="ltx_text ltx_font_italic" id="Thmhyp1.p1.6.6">Let <math alttext="X_{t}" class="ltx_Math" display="inline" id="Thmhyp1.p1.1.1.m1.1"><semantics id="Thmhyp1.p1.1.1.m1.1a"><msub id="Thmhyp1.p1.1.1.m1.1.1" xref="Thmhyp1.p1.1.1.m1.1.1.cmml"><mi id="Thmhyp1.p1.1.1.m1.1.1.2" xref="Thmhyp1.p1.1.1.m1.1.1.2.cmml">X</mi><mi id="Thmhyp1.p1.1.1.m1.1.1.3" xref="Thmhyp1.p1.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Thmhyp1.p1.1.1.m1.1b"><apply id="Thmhyp1.p1.1.1.m1.1.1.cmml" xref="Thmhyp1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="Thmhyp1.p1.1.1.m1.1.1.1.cmml" xref="Thmhyp1.p1.1.1.m1.1.1">subscript</csymbol><ci id="Thmhyp1.p1.1.1.m1.1.1.2.cmml" xref="Thmhyp1.p1.1.1.m1.1.1.2">𝑋</ci><ci id="Thmhyp1.p1.1.1.m1.1.1.3.cmml" xref="Thmhyp1.p1.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmhyp1.p1.1.1.m1.1c">X_{t}</annotation><annotation encoding="application/x-llamapun" id="Thmhyp1.p1.1.1.m1.1d">italic_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> be a (mostly) continuous time series. On inputs <math alttext="x_{t-n+1},\ldots,x_{t}" class="ltx_Math" display="inline" id="Thmhyp1.p1.2.2.m2.3"><semantics id="Thmhyp1.p1.2.2.m2.3a"><mrow id="Thmhyp1.p1.2.2.m2.3.3.2" xref="Thmhyp1.p1.2.2.m2.3.3.3.cmml"><msub id="Thmhyp1.p1.2.2.m2.2.2.1.1" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.cmml"><mi id="Thmhyp1.p1.2.2.m2.2.2.1.1.2" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.2.cmml">x</mi><mrow id="Thmhyp1.p1.2.2.m2.2.2.1.1.3" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.cmml"><mrow id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.cmml"><mi id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.2" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.2.cmml">t</mi><mo id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.1" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.1.cmml">−</mo><mi id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.3" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.3.cmml">n</mi></mrow><mo id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.1" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.1.cmml">+</mo><mn id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.3" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="Thmhyp1.p1.2.2.m2.3.3.2.3" xref="Thmhyp1.p1.2.2.m2.3.3.3.cmml">,</mo><mi id="Thmhyp1.p1.2.2.m2.1.1" mathvariant="normal" xref="Thmhyp1.p1.2.2.m2.1.1.cmml">…</mi><mo id="Thmhyp1.p1.2.2.m2.3.3.2.4" xref="Thmhyp1.p1.2.2.m2.3.3.3.cmml">,</mo><msub id="Thmhyp1.p1.2.2.m2.3.3.2.2" xref="Thmhyp1.p1.2.2.m2.3.3.2.2.cmml"><mi id="Thmhyp1.p1.2.2.m2.3.3.2.2.2" xref="Thmhyp1.p1.2.2.m2.3.3.2.2.2.cmml">x</mi><mi id="Thmhyp1.p1.2.2.m2.3.3.2.2.3" xref="Thmhyp1.p1.2.2.m2.3.3.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Thmhyp1.p1.2.2.m2.3b"><list id="Thmhyp1.p1.2.2.m2.3.3.3.cmml" xref="Thmhyp1.p1.2.2.m2.3.3.2"><apply id="Thmhyp1.p1.2.2.m2.2.2.1.1.cmml" xref="Thmhyp1.p1.2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="Thmhyp1.p1.2.2.m2.2.2.1.1.1.cmml" xref="Thmhyp1.p1.2.2.m2.2.2.1.1">subscript</csymbol><ci id="Thmhyp1.p1.2.2.m2.2.2.1.1.2.cmml" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.2">𝑥</ci><apply id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.cmml" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3"><plus id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.1.cmml" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.1"></plus><apply id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.cmml" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2"><minus id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.1.cmml" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.1"></minus><ci id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.2.cmml" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.2">𝑡</ci><ci id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.3.cmml" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.2.3">𝑛</ci></apply><cn id="Thmhyp1.p1.2.2.m2.2.2.1.1.3.3.cmml" type="integer" xref="Thmhyp1.p1.2.2.m2.2.2.1.1.3.3">1</cn></apply></apply><ci id="Thmhyp1.p1.2.2.m2.1.1.cmml" xref="Thmhyp1.p1.2.2.m2.1.1">…</ci><apply id="Thmhyp1.p1.2.2.m2.3.3.2.2.cmml" xref="Thmhyp1.p1.2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="Thmhyp1.p1.2.2.m2.3.3.2.2.1.cmml" xref="Thmhyp1.p1.2.2.m2.3.3.2.2">subscript</csymbol><ci id="Thmhyp1.p1.2.2.m2.3.3.2.2.2.cmml" xref="Thmhyp1.p1.2.2.m2.3.3.2.2.2">𝑥</ci><ci id="Thmhyp1.p1.2.2.m2.3.3.2.2.3.cmml" xref="Thmhyp1.p1.2.2.m2.3.3.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Thmhyp1.p1.2.2.m2.3c">x_{t-n+1},\ldots,x_{t}</annotation><annotation encoding="application/x-llamapun" id="Thmhyp1.p1.2.2.m2.3d">italic_x start_POSTSUBSCRIPT italic_t - italic_n + 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, for any <math alttext="j\in\{0,1,\ldots,n-1\}" class="ltx_Math" display="inline" id="Thmhyp1.p1.3.3.m3.4"><semantics id="Thmhyp1.p1.3.3.m3.4a"><mrow id="Thmhyp1.p1.3.3.m3.4.4" xref="Thmhyp1.p1.3.3.m3.4.4.cmml"><mi id="Thmhyp1.p1.3.3.m3.4.4.3" xref="Thmhyp1.p1.3.3.m3.4.4.3.cmml">j</mi><mo id="Thmhyp1.p1.3.3.m3.4.4.2" xref="Thmhyp1.p1.3.3.m3.4.4.2.cmml">∈</mo><mrow id="Thmhyp1.p1.3.3.m3.4.4.1.1" xref="Thmhyp1.p1.3.3.m3.4.4.1.2.cmml"><mo id="Thmhyp1.p1.3.3.m3.4.4.1.1.2" stretchy="false" xref="Thmhyp1.p1.3.3.m3.4.4.1.2.cmml">{</mo><mn id="Thmhyp1.p1.3.3.m3.1.1" xref="Thmhyp1.p1.3.3.m3.1.1.cmml">0</mn><mo id="Thmhyp1.p1.3.3.m3.4.4.1.1.3" xref="Thmhyp1.p1.3.3.m3.4.4.1.2.cmml">,</mo><mn id="Thmhyp1.p1.3.3.m3.2.2" xref="Thmhyp1.p1.3.3.m3.2.2.cmml">1</mn><mo id="Thmhyp1.p1.3.3.m3.4.4.1.1.4" xref="Thmhyp1.p1.3.3.m3.4.4.1.2.cmml">,</mo><mi id="Thmhyp1.p1.3.3.m3.3.3" mathvariant="normal" xref="Thmhyp1.p1.3.3.m3.3.3.cmml">…</mi><mo id="Thmhyp1.p1.3.3.m3.4.4.1.1.5" xref="Thmhyp1.p1.3.3.m3.4.4.1.2.cmml">,</mo><mrow id="Thmhyp1.p1.3.3.m3.4.4.1.1.1" xref="Thmhyp1.p1.3.3.m3.4.4.1.1.1.cmml"><mi id="Thmhyp1.p1.3.3.m3.4.4.1.1.1.2" xref="Thmhyp1.p1.3.3.m3.4.4.1.1.1.2.cmml">n</mi><mo id="Thmhyp1.p1.3.3.m3.4.4.1.1.1.1" xref="Thmhyp1.p1.3.3.m3.4.4.1.1.1.1.cmml">−</mo><mn id="Thmhyp1.p1.3.3.m3.4.4.1.1.1.3" xref="Thmhyp1.p1.3.3.m3.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmhyp1.p1.3.3.m3.4.4.1.1.6" stretchy="false" xref="Thmhyp1.p1.3.3.m3.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmhyp1.p1.3.3.m3.4b"><apply id="Thmhyp1.p1.3.3.m3.4.4.cmml" xref="Thmhyp1.p1.3.3.m3.4.4"><in id="Thmhyp1.p1.3.3.m3.4.4.2.cmml" xref="Thmhyp1.p1.3.3.m3.4.4.2"></in><ci id="Thmhyp1.p1.3.3.m3.4.4.3.cmml" xref="Thmhyp1.p1.3.3.m3.4.4.3">𝑗</ci><set id="Thmhyp1.p1.3.3.m3.4.4.1.2.cmml" xref="Thmhyp1.p1.3.3.m3.4.4.1.1"><cn id="Thmhyp1.p1.3.3.m3.1.1.cmml" type="integer" xref="Thmhyp1.p1.3.3.m3.1.1">0</cn><cn id="Thmhyp1.p1.3.3.m3.2.2.cmml" type="integer" xref="Thmhyp1.p1.3.3.m3.2.2">1</cn><ci id="Thmhyp1.p1.3.3.m3.3.3.cmml" xref="Thmhyp1.p1.3.3.m3.3.3">…</ci><apply id="Thmhyp1.p1.3.3.m3.4.4.1.1.1.cmml" xref="Thmhyp1.p1.3.3.m3.4.4.1.1.1"><minus id="Thmhyp1.p1.3.3.m3.4.4.1.1.1.1.cmml" xref="Thmhyp1.p1.3.3.m3.4.4.1.1.1.1"></minus><ci id="Thmhyp1.p1.3.3.m3.4.4.1.1.1.2.cmml" xref="Thmhyp1.p1.3.3.m3.4.4.1.1.1.2">𝑛</ci><cn id="Thmhyp1.p1.3.3.m3.4.4.1.1.1.3.cmml" type="integer" xref="Thmhyp1.p1.3.3.m3.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmhyp1.p1.3.3.m3.4c">j\in\{0,1,\ldots,n-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmhyp1.p1.3.3.m3.4d">italic_j ∈ { 0 , 1 , … , italic_n - 1 }</annotation></semantics></math>, the attention scores of the row corresponding to <math alttext="x_{t-n+1+i}" class="ltx_Math" display="inline" id="Thmhyp1.p1.4.4.m4.1"><semantics id="Thmhyp1.p1.4.4.m4.1a"><msub id="Thmhyp1.p1.4.4.m4.1.1" xref="Thmhyp1.p1.4.4.m4.1.1.cmml"><mi id="Thmhyp1.p1.4.4.m4.1.1.2" xref="Thmhyp1.p1.4.4.m4.1.1.2.cmml">x</mi><mrow id="Thmhyp1.p1.4.4.m4.1.1.3" xref="Thmhyp1.p1.4.4.m4.1.1.3.cmml"><mrow id="Thmhyp1.p1.4.4.m4.1.1.3.2" xref="Thmhyp1.p1.4.4.m4.1.1.3.2.cmml"><mi id="Thmhyp1.p1.4.4.m4.1.1.3.2.2" xref="Thmhyp1.p1.4.4.m4.1.1.3.2.2.cmml">t</mi><mo id="Thmhyp1.p1.4.4.m4.1.1.3.2.1" xref="Thmhyp1.p1.4.4.m4.1.1.3.2.1.cmml">−</mo><mi id="Thmhyp1.p1.4.4.m4.1.1.3.2.3" xref="Thmhyp1.p1.4.4.m4.1.1.3.2.3.cmml">n</mi></mrow><mo id="Thmhyp1.p1.4.4.m4.1.1.3.1" xref="Thmhyp1.p1.4.4.m4.1.1.3.1.cmml">+</mo><mn id="Thmhyp1.p1.4.4.m4.1.1.3.3" xref="Thmhyp1.p1.4.4.m4.1.1.3.3.cmml">1</mn><mo id="Thmhyp1.p1.4.4.m4.1.1.3.1a" xref="Thmhyp1.p1.4.4.m4.1.1.3.1.cmml">+</mo><mi id="Thmhyp1.p1.4.4.m4.1.1.3.4" xref="Thmhyp1.p1.4.4.m4.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmhyp1.p1.4.4.m4.1b"><apply id="Thmhyp1.p1.4.4.m4.1.1.cmml" xref="Thmhyp1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="Thmhyp1.p1.4.4.m4.1.1.1.cmml" xref="Thmhyp1.p1.4.4.m4.1.1">subscript</csymbol><ci id="Thmhyp1.p1.4.4.m4.1.1.2.cmml" xref="Thmhyp1.p1.4.4.m4.1.1.2">𝑥</ci><apply id="Thmhyp1.p1.4.4.m4.1.1.3.cmml" xref="Thmhyp1.p1.4.4.m4.1.1.3"><plus id="Thmhyp1.p1.4.4.m4.1.1.3.1.cmml" xref="Thmhyp1.p1.4.4.m4.1.1.3.1"></plus><apply id="Thmhyp1.p1.4.4.m4.1.1.3.2.cmml" xref="Thmhyp1.p1.4.4.m4.1.1.3.2"><minus id="Thmhyp1.p1.4.4.m4.1.1.3.2.1.cmml" xref="Thmhyp1.p1.4.4.m4.1.1.3.2.1"></minus><ci id="Thmhyp1.p1.4.4.m4.1.1.3.2.2.cmml" xref="Thmhyp1.p1.4.4.m4.1.1.3.2.2">𝑡</ci><ci id="Thmhyp1.p1.4.4.m4.1.1.3.2.3.cmml" xref="Thmhyp1.p1.4.4.m4.1.1.3.2.3">𝑛</ci></apply><cn id="Thmhyp1.p1.4.4.m4.1.1.3.3.cmml" type="integer" xref="Thmhyp1.p1.4.4.m4.1.1.3.3">1</cn><ci id="Thmhyp1.p1.4.4.m4.1.1.3.4.cmml" xref="Thmhyp1.p1.4.4.m4.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmhyp1.p1.4.4.m4.1c">x_{t-n+1+i}</annotation><annotation encoding="application/x-llamapun" id="Thmhyp1.p1.4.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_t - italic_n + 1 + italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, denoted <math alttext="a_{i,0},a_{i,1},\ldots,a_{i,n-1}" class="ltx_Math" display="inline" id="Thmhyp1.p1.5.5.m5.10"><semantics id="Thmhyp1.p1.5.5.m5.10a"><mrow id="Thmhyp1.p1.5.5.m5.10.10.3" xref="Thmhyp1.p1.5.5.m5.10.10.4.cmml"><msub id="Thmhyp1.p1.5.5.m5.8.8.1.1" xref="Thmhyp1.p1.5.5.m5.8.8.1.1.cmml"><mi id="Thmhyp1.p1.5.5.m5.8.8.1.1.2" xref="Thmhyp1.p1.5.5.m5.8.8.1.1.2.cmml">a</mi><mrow id="Thmhyp1.p1.5.5.m5.2.2.2.4" xref="Thmhyp1.p1.5.5.m5.2.2.2.3.cmml"><mi id="Thmhyp1.p1.5.5.m5.1.1.1.1" xref="Thmhyp1.p1.5.5.m5.1.1.1.1.cmml">i</mi><mo id="Thmhyp1.p1.5.5.m5.2.2.2.4.1" xref="Thmhyp1.p1.5.5.m5.2.2.2.3.cmml">,</mo><mn id="Thmhyp1.p1.5.5.m5.2.2.2.2" xref="Thmhyp1.p1.5.5.m5.2.2.2.2.cmml">0</mn></mrow></msub><mo id="Thmhyp1.p1.5.5.m5.10.10.3.4" xref="Thmhyp1.p1.5.5.m5.10.10.4.cmml">,</mo><msub id="Thmhyp1.p1.5.5.m5.9.9.2.2" xref="Thmhyp1.p1.5.5.m5.9.9.2.2.cmml"><mi id="Thmhyp1.p1.5.5.m5.9.9.2.2.2" xref="Thmhyp1.p1.5.5.m5.9.9.2.2.2.cmml">a</mi><mrow id="Thmhyp1.p1.5.5.m5.4.4.2.4" xref="Thmhyp1.p1.5.5.m5.4.4.2.3.cmml"><mi id="Thmhyp1.p1.5.5.m5.3.3.1.1" xref="Thmhyp1.p1.5.5.m5.3.3.1.1.cmml">i</mi><mo id="Thmhyp1.p1.5.5.m5.4.4.2.4.1" xref="Thmhyp1.p1.5.5.m5.4.4.2.3.cmml">,</mo><mn id="Thmhyp1.p1.5.5.m5.4.4.2.2" xref="Thmhyp1.p1.5.5.m5.4.4.2.2.cmml">1</mn></mrow></msub><mo id="Thmhyp1.p1.5.5.m5.10.10.3.5" xref="Thmhyp1.p1.5.5.m5.10.10.4.cmml">,</mo><mi id="Thmhyp1.p1.5.5.m5.7.7" mathvariant="normal" xref="Thmhyp1.p1.5.5.m5.7.7.cmml">…</mi><mo id="Thmhyp1.p1.5.5.m5.10.10.3.6" xref="Thmhyp1.p1.5.5.m5.10.10.4.cmml">,</mo><msub id="Thmhyp1.p1.5.5.m5.10.10.3.3" xref="Thmhyp1.p1.5.5.m5.10.10.3.3.cmml"><mi id="Thmhyp1.p1.5.5.m5.10.10.3.3.2" xref="Thmhyp1.p1.5.5.m5.10.10.3.3.2.cmml">a</mi><mrow id="Thmhyp1.p1.5.5.m5.6.6.2.2" xref="Thmhyp1.p1.5.5.m5.6.6.2.3.cmml"><mi id="Thmhyp1.p1.5.5.m5.5.5.1.1" xref="Thmhyp1.p1.5.5.m5.5.5.1.1.cmml">i</mi><mo id="Thmhyp1.p1.5.5.m5.6.6.2.2.2" xref="Thmhyp1.p1.5.5.m5.6.6.2.3.cmml">,</mo><mrow id="Thmhyp1.p1.5.5.m5.6.6.2.2.1" xref="Thmhyp1.p1.5.5.m5.6.6.2.2.1.cmml"><mi id="Thmhyp1.p1.5.5.m5.6.6.2.2.1.2" xref="Thmhyp1.p1.5.5.m5.6.6.2.2.1.2.cmml">n</mi><mo id="Thmhyp1.p1.5.5.m5.6.6.2.2.1.1" xref="Thmhyp1.p1.5.5.m5.6.6.2.2.1.1.cmml">−</mo><mn id="Thmhyp1.p1.5.5.m5.6.6.2.2.1.3" xref="Thmhyp1.p1.5.5.m5.6.6.2.2.1.3.cmml">1</mn></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="Thmhyp1.p1.5.5.m5.10b"><list id="Thmhyp1.p1.5.5.m5.10.10.4.cmml" xref="Thmhyp1.p1.5.5.m5.10.10.3"><apply id="Thmhyp1.p1.5.5.m5.8.8.1.1.cmml" xref="Thmhyp1.p1.5.5.m5.8.8.1.1"><csymbol cd="ambiguous" id="Thmhyp1.p1.5.5.m5.8.8.1.1.1.cmml" xref="Thmhyp1.p1.5.5.m5.8.8.1.1">subscript</csymbol><ci id="Thmhyp1.p1.5.5.m5.8.8.1.1.2.cmml" xref="Thmhyp1.p1.5.5.m5.8.8.1.1.2">𝑎</ci><list id="Thmhyp1.p1.5.5.m5.2.2.2.3.cmml" xref="Thmhyp1.p1.5.5.m5.2.2.2.4"><ci id="Thmhyp1.p1.5.5.m5.1.1.1.1.cmml" xref="Thmhyp1.p1.5.5.m5.1.1.1.1">𝑖</ci><cn id="Thmhyp1.p1.5.5.m5.2.2.2.2.cmml" type="integer" xref="Thmhyp1.p1.5.5.m5.2.2.2.2">0</cn></list></apply><apply id="Thmhyp1.p1.5.5.m5.9.9.2.2.cmml" xref="Thmhyp1.p1.5.5.m5.9.9.2.2"><csymbol cd="ambiguous" id="Thmhyp1.p1.5.5.m5.9.9.2.2.1.cmml" xref="Thmhyp1.p1.5.5.m5.9.9.2.2">subscript</csymbol><ci id="Thmhyp1.p1.5.5.m5.9.9.2.2.2.cmml" xref="Thmhyp1.p1.5.5.m5.9.9.2.2.2">𝑎</ci><list id="Thmhyp1.p1.5.5.m5.4.4.2.3.cmml" xref="Thmhyp1.p1.5.5.m5.4.4.2.4"><ci id="Thmhyp1.p1.5.5.m5.3.3.1.1.cmml" xref="Thmhyp1.p1.5.5.m5.3.3.1.1">𝑖</ci><cn id="Thmhyp1.p1.5.5.m5.4.4.2.2.cmml" type="integer" xref="Thmhyp1.p1.5.5.m5.4.4.2.2">1</cn></list></apply><ci id="Thmhyp1.p1.5.5.m5.7.7.cmml" xref="Thmhyp1.p1.5.5.m5.7.7">…</ci><apply id="Thmhyp1.p1.5.5.m5.10.10.3.3.cmml" xref="Thmhyp1.p1.5.5.m5.10.10.3.3"><csymbol cd="ambiguous" id="Thmhyp1.p1.5.5.m5.10.10.3.3.1.cmml" xref="Thmhyp1.p1.5.5.m5.10.10.3.3">subscript</csymbol><ci id="Thmhyp1.p1.5.5.m5.10.10.3.3.2.cmml" xref="Thmhyp1.p1.5.5.m5.10.10.3.3.2">𝑎</ci><list id="Thmhyp1.p1.5.5.m5.6.6.2.3.cmml" xref="Thmhyp1.p1.5.5.m5.6.6.2.2"><ci id="Thmhyp1.p1.5.5.m5.5.5.1.1.cmml" xref="Thmhyp1.p1.5.5.m5.5.5.1.1">𝑖</ci><apply id="Thmhyp1.p1.5.5.m5.6.6.2.2.1.cmml" xref="Thmhyp1.p1.5.5.m5.6.6.2.2.1"><minus id="Thmhyp1.p1.5.5.m5.6.6.2.2.1.1.cmml" xref="Thmhyp1.p1.5.5.m5.6.6.2.2.1.1"></minus><ci id="Thmhyp1.p1.5.5.m5.6.6.2.2.1.2.cmml" xref="Thmhyp1.p1.5.5.m5.6.6.2.2.1.2">𝑛</ci><cn id="Thmhyp1.p1.5.5.m5.6.6.2.2.1.3.cmml" type="integer" xref="Thmhyp1.p1.5.5.m5.6.6.2.2.1.3">1</cn></apply></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Thmhyp1.p1.5.5.m5.10c">a_{i,0},a_{i,1},\ldots,a_{i,n-1}</annotation><annotation encoding="application/x-llamapun" id="Thmhyp1.p1.5.5.m5.10d">italic_a start_POSTSUBSCRIPT italic_i , 0 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i , 1 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_i , italic_n - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, are mostly concentrated around <math alttext="a_{j,j}" class="ltx_Math" display="inline" id="Thmhyp1.p1.6.6.m6.2"><semantics id="Thmhyp1.p1.6.6.m6.2a"><msub id="Thmhyp1.p1.6.6.m6.2.3" xref="Thmhyp1.p1.6.6.m6.2.3.cmml"><mi id="Thmhyp1.p1.6.6.m6.2.3.2" xref="Thmhyp1.p1.6.6.m6.2.3.2.cmml">a</mi><mrow id="Thmhyp1.p1.6.6.m6.2.2.2.4" xref="Thmhyp1.p1.6.6.m6.2.2.2.3.cmml"><mi id="Thmhyp1.p1.6.6.m6.1.1.1.1" xref="Thmhyp1.p1.6.6.m6.1.1.1.1.cmml">j</mi><mo id="Thmhyp1.p1.6.6.m6.2.2.2.4.1" xref="Thmhyp1.p1.6.6.m6.2.2.2.3.cmml">,</mo><mi id="Thmhyp1.p1.6.6.m6.2.2.2.2" xref="Thmhyp1.p1.6.6.m6.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmhyp1.p1.6.6.m6.2b"><apply id="Thmhyp1.p1.6.6.m6.2.3.cmml" xref="Thmhyp1.p1.6.6.m6.2.3"><csymbol cd="ambiguous" id="Thmhyp1.p1.6.6.m6.2.3.1.cmml" xref="Thmhyp1.p1.6.6.m6.2.3">subscript</csymbol><ci id="Thmhyp1.p1.6.6.m6.2.3.2.cmml" xref="Thmhyp1.p1.6.6.m6.2.3.2">𝑎</ci><list id="Thmhyp1.p1.6.6.m6.2.2.2.3.cmml" xref="Thmhyp1.p1.6.6.m6.2.2.2.4"><ci id="Thmhyp1.p1.6.6.m6.1.1.1.1.cmml" xref="Thmhyp1.p1.6.6.m6.1.1.1.1">𝑗</ci><ci id="Thmhyp1.p1.6.6.m6.2.2.2.2.cmml" xref="Thmhyp1.p1.6.6.m6.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmhyp1.p1.6.6.m6.2c">a_{j,j}</annotation><annotation encoding="application/x-llamapun" id="Thmhyp1.p1.6.6.m6.2d">italic_a start_POSTSUBSCRIPT italic_j , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.p3">
<p class="ltx_p" id="S3.p3.6">Previous attempts have exploited this sparsity properties of self-attention in time series modelling to design selective masking strategies that, for each row of the attention scores matrix, set most entries to zero. For example, the LogSparse Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib28" title="">28</a>]</cite> (denoted LogTrans in our experimentation) uses, for each key with timestamp <math alttext="t_{0}" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">t</mi><mn id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝑡</ci><cn id="S3.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">t_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, attention scores with those queries whose timestamp <math alttext="t" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_t</annotation></semantics></math> is in a local neighbourhood of <math alttext="t_{0}" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">t</mi><mn id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝑡</ci><cn id="S3.p3.3.m3.1.1.3.cmml" type="integer" xref="S3.p3.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">t_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and those queries whose timestamp <math alttext="t" class="ltx_Math" display="inline" id="S3.p3.4.m4.1"><semantics id="S3.p3.4.m4.1a"><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">italic_t</annotation></semantics></math> satisfies <math alttext="t_{0}-t=2^{j}" class="ltx_Math" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><mrow id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml"><mrow id="S3.p3.5.m5.1.1.2" xref="S3.p3.5.m5.1.1.2.cmml"><msub id="S3.p3.5.m5.1.1.2.2" xref="S3.p3.5.m5.1.1.2.2.cmml"><mi id="S3.p3.5.m5.1.1.2.2.2" xref="S3.p3.5.m5.1.1.2.2.2.cmml">t</mi><mn id="S3.p3.5.m5.1.1.2.2.3" xref="S3.p3.5.m5.1.1.2.2.3.cmml">0</mn></msub><mo id="S3.p3.5.m5.1.1.2.1" xref="S3.p3.5.m5.1.1.2.1.cmml">−</mo><mi id="S3.p3.5.m5.1.1.2.3" xref="S3.p3.5.m5.1.1.2.3.cmml">t</mi></mrow><mo id="S3.p3.5.m5.1.1.1" xref="S3.p3.5.m5.1.1.1.cmml">=</mo><msup id="S3.p3.5.m5.1.1.3" xref="S3.p3.5.m5.1.1.3.cmml"><mn id="S3.p3.5.m5.1.1.3.2" xref="S3.p3.5.m5.1.1.3.2.cmml">2</mn><mi id="S3.p3.5.m5.1.1.3.3" xref="S3.p3.5.m5.1.1.3.3.cmml">j</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1"><eq id="S3.p3.5.m5.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1"></eq><apply id="S3.p3.5.m5.1.1.2.cmml" xref="S3.p3.5.m5.1.1.2"><minus id="S3.p3.5.m5.1.1.2.1.cmml" xref="S3.p3.5.m5.1.1.2.1"></minus><apply id="S3.p3.5.m5.1.1.2.2.cmml" xref="S3.p3.5.m5.1.1.2.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.2.2.1.cmml" xref="S3.p3.5.m5.1.1.2.2">subscript</csymbol><ci id="S3.p3.5.m5.1.1.2.2.2.cmml" xref="S3.p3.5.m5.1.1.2.2.2">𝑡</ci><cn id="S3.p3.5.m5.1.1.2.2.3.cmml" type="integer" xref="S3.p3.5.m5.1.1.2.2.3">0</cn></apply><ci id="S3.p3.5.m5.1.1.2.3.cmml" xref="S3.p3.5.m5.1.1.2.3">𝑡</ci></apply><apply id="S3.p3.5.m5.1.1.3.cmml" xref="S3.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.3.1.cmml" xref="S3.p3.5.m5.1.1.3">superscript</csymbol><cn id="S3.p3.5.m5.1.1.3.2.cmml" type="integer" xref="S3.p3.5.m5.1.1.3.2">2</cn><ci id="S3.p3.5.m5.1.1.3.3.cmml" xref="S3.p3.5.m5.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">t_{0}-t=2^{j}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - italic_t = 2 start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> for some positive integer <math alttext="j" class="ltx_Math" display="inline" id="S3.p3.6.m6.1"><semantics id="S3.p3.6.m6.1a"><mi id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><ci id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m6.1d">italic_j</annotation></semantics></math>. The LongFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib37" title="">37</a>]</cite> extends the above work to a more complicated sparse configuration in the realm of NLP. These masking strategies partially resolve the loss of positional information problem of the attention mechanism as the input is only partially combined at each attention layer and, thus, Proposition <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm1" title="Proposition 1. ‣ 2.1 Attention Mechanism ‣ 2 Transformers for Long Sequence Time-series Forecasting ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">1</span></a> does not hold for such mechanisms. However, it is not clear how to obtain an improvement in time and memory complexity, as these attention mechanisms have not been written in tensor algebra in an efficient way. Instead, sparse matrices are used to perform computations and represent the attention matrix, leading to minor memory and computational efficiency improvements.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p4">
<p class="ltx_p" id="S3.p4.1">In this work, we propose the Local Attention Mechanism (LAM), which only computes dot products on nearby inputs of the attention layer. As we will see, our proposed attention can be implemented efficiently in tensor algebra, leading to almost linear time and memory complexity in practice.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdefinition1.1.1.1">Definition 1</span></span><span class="ltx_text ltx_font_bold" id="Thmdefinition1.2.2"> </span>(Local Attention)<span class="ltx_text ltx_font_bold" id="Thmdefinition1.3.3">.</span>
</h6>
<div class="ltx_para ltx_noindent" id="Thmdefinition1.p1">
<p class="ltx_p" id="Thmdefinition1.p1.6"><span class="ltx_text ltx_font_italic" id="Thmdefinition1.p1.6.6">Let <math alttext="L" class="ltx_Math" display="inline" id="Thmdefinition1.p1.1.1.m1.1"><semantics id="Thmdefinition1.p1.1.1.m1.1a"><mi id="Thmdefinition1.p1.1.1.m1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.1.1.m1.1b"><ci id="Thmdefinition1.p1.1.1.m1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.1.1.m1.1d">italic_L</annotation></semantics></math> be a neighbourhood size (in our experiments <math alttext="L=4\lceil\log n\rceil" class="ltx_Math" display="inline" id="Thmdefinition1.p1.2.2.m2.1"><semantics id="Thmdefinition1.p1.2.2.m2.1a"><mrow id="Thmdefinition1.p1.2.2.m2.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.cmml"><mi id="Thmdefinition1.p1.2.2.m2.1.1.3" xref="Thmdefinition1.p1.2.2.m2.1.1.3.cmml">L</mi><mo id="Thmdefinition1.p1.2.2.m2.1.1.2" xref="Thmdefinition1.p1.2.2.m2.1.1.2.cmml">=</mo><mrow id="Thmdefinition1.p1.2.2.m2.1.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.1.cmml"><mn id="Thmdefinition1.p1.2.2.m2.1.1.1.3" xref="Thmdefinition1.p1.2.2.m2.1.1.1.3.cmml">4</mn><mo id="Thmdefinition1.p1.2.2.m2.1.1.1.2" xref="Thmdefinition1.p1.2.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="Thmdefinition1.p1.2.2.m2.1.1.1.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.2.cmml"><mo id="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.2" stretchy="false" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.2.1.cmml">⌈</mo><mrow id="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.cmml"><mi id="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.1.cmml">log</mi><mo id="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1a" lspace="0.167em" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.cmml">⁡</mo><mi id="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.2" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.2.cmml">n</mi></mrow><mo id="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.3" stretchy="false" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.2.1.cmml">⌉</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.2.2.m2.1b"><apply id="Thmdefinition1.p1.2.2.m2.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1"><eq id="Thmdefinition1.p1.2.2.m2.1.1.2.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.2"></eq><ci id="Thmdefinition1.p1.2.2.m2.1.1.3.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.3">𝐿</ci><apply id="Thmdefinition1.p1.2.2.m2.1.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.1"><times id="Thmdefinition1.p1.2.2.m2.1.1.1.2.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.1.2"></times><cn id="Thmdefinition1.p1.2.2.m2.1.1.1.3.cmml" type="integer" xref="Thmdefinition1.p1.2.2.m2.1.1.1.3">4</cn><apply id="Thmdefinition1.p1.2.2.m2.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.1"><ceiling id="Thmdefinition1.p1.2.2.m2.1.1.1.1.2.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.2"></ceiling><apply id="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1"><log id="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.1"></log><ci id="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.1.1.1.1.2">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.2.2.m2.1c">L=4\lceil\log n\rceil</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.2.2.m2.1d">italic_L = 4 ⌈ roman_log italic_n ⌉</annotation></semantics></math>) and let <math alttext="M\in\{0,-\infty\}^{n\times n}" class="ltx_Math" display="inline" id="Thmdefinition1.p1.3.3.m3.2"><semantics id="Thmdefinition1.p1.3.3.m3.2a"><mrow id="Thmdefinition1.p1.3.3.m3.2.2" xref="Thmdefinition1.p1.3.3.m3.2.2.cmml"><mi id="Thmdefinition1.p1.3.3.m3.2.2.3" xref="Thmdefinition1.p1.3.3.m3.2.2.3.cmml">M</mi><mo id="Thmdefinition1.p1.3.3.m3.2.2.2" xref="Thmdefinition1.p1.3.3.m3.2.2.2.cmml">∈</mo><msup id="Thmdefinition1.p1.3.3.m3.2.2.1" xref="Thmdefinition1.p1.3.3.m3.2.2.1.cmml"><mrow id="Thmdefinition1.p1.3.3.m3.2.2.1.1.1" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.2.cmml"><mo id="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.2" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.2.cmml">{</mo><mn id="Thmdefinition1.p1.3.3.m3.1.1" xref="Thmdefinition1.p1.3.3.m3.1.1.cmml">0</mn><mo id="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.3" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.2.cmml">,</mo><mrow id="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1.cmml"><mo id="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1a" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1.cmml">−</mo><mi id="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1.2" mathvariant="normal" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1.2.cmml">∞</mi></mrow><mo id="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.4" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.2.cmml">}</mo></mrow><mrow id="Thmdefinition1.p1.3.3.m3.2.2.1.3" xref="Thmdefinition1.p1.3.3.m3.2.2.1.3.cmml"><mi id="Thmdefinition1.p1.3.3.m3.2.2.1.3.2" xref="Thmdefinition1.p1.3.3.m3.2.2.1.3.2.cmml">n</mi><mo id="Thmdefinition1.p1.3.3.m3.2.2.1.3.1" lspace="0.222em" rspace="0.222em" xref="Thmdefinition1.p1.3.3.m3.2.2.1.3.1.cmml">×</mo><mi id="Thmdefinition1.p1.3.3.m3.2.2.1.3.3" xref="Thmdefinition1.p1.3.3.m3.2.2.1.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.3.3.m3.2b"><apply id="Thmdefinition1.p1.3.3.m3.2.2.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2"><in id="Thmdefinition1.p1.3.3.m3.2.2.2.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.2"></in><ci id="Thmdefinition1.p1.3.3.m3.2.2.3.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.3">𝑀</ci><apply id="Thmdefinition1.p1.3.3.m3.2.2.1.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.3.3.m3.2.2.1.2.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.1">superscript</csymbol><set id="Thmdefinition1.p1.3.3.m3.2.2.1.1.2.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.1"><cn id="Thmdefinition1.p1.3.3.m3.1.1.cmml" type="integer" xref="Thmdefinition1.p1.3.3.m3.1.1">0</cn><apply id="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1"><minus id="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1"></minus><infinity id="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.1.1.1.1.2"></infinity></apply></set><apply id="Thmdefinition1.p1.3.3.m3.2.2.1.3.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.1.3"><times id="Thmdefinition1.p1.3.3.m3.2.2.1.3.1.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.1.3.1"></times><ci id="Thmdefinition1.p1.3.3.m3.2.2.1.3.2.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.1.3.2">𝑛</ci><ci id="Thmdefinition1.p1.3.3.m3.2.2.1.3.3.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2.1.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.3.3.m3.2c">M\in\{0,-\infty\}^{n\times n}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.3.3.m3.2d">italic_M ∈ { 0 , - ∞ } start_POSTSUPERSCRIPT italic_n × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> be the square matrix with <math alttext="M_{i,j}=0" class="ltx_Math" display="inline" id="Thmdefinition1.p1.4.4.m4.2"><semantics id="Thmdefinition1.p1.4.4.m4.2a"><mrow id="Thmdefinition1.p1.4.4.m4.2.3" xref="Thmdefinition1.p1.4.4.m4.2.3.cmml"><msub id="Thmdefinition1.p1.4.4.m4.2.3.2" xref="Thmdefinition1.p1.4.4.m4.2.3.2.cmml"><mi id="Thmdefinition1.p1.4.4.m4.2.3.2.2" xref="Thmdefinition1.p1.4.4.m4.2.3.2.2.cmml">M</mi><mrow id="Thmdefinition1.p1.4.4.m4.2.2.2.4" xref="Thmdefinition1.p1.4.4.m4.2.2.2.3.cmml"><mi id="Thmdefinition1.p1.4.4.m4.1.1.1.1" xref="Thmdefinition1.p1.4.4.m4.1.1.1.1.cmml">i</mi><mo id="Thmdefinition1.p1.4.4.m4.2.2.2.4.1" xref="Thmdefinition1.p1.4.4.m4.2.2.2.3.cmml">,</mo><mi id="Thmdefinition1.p1.4.4.m4.2.2.2.2" xref="Thmdefinition1.p1.4.4.m4.2.2.2.2.cmml">j</mi></mrow></msub><mo id="Thmdefinition1.p1.4.4.m4.2.3.1" xref="Thmdefinition1.p1.4.4.m4.2.3.1.cmml">=</mo><mn id="Thmdefinition1.p1.4.4.m4.2.3.3" xref="Thmdefinition1.p1.4.4.m4.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.4.4.m4.2b"><apply id="Thmdefinition1.p1.4.4.m4.2.3.cmml" xref="Thmdefinition1.p1.4.4.m4.2.3"><eq id="Thmdefinition1.p1.4.4.m4.2.3.1.cmml" xref="Thmdefinition1.p1.4.4.m4.2.3.1"></eq><apply id="Thmdefinition1.p1.4.4.m4.2.3.2.cmml" xref="Thmdefinition1.p1.4.4.m4.2.3.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.4.4.m4.2.3.2.1.cmml" xref="Thmdefinition1.p1.4.4.m4.2.3.2">subscript</csymbol><ci id="Thmdefinition1.p1.4.4.m4.2.3.2.2.cmml" xref="Thmdefinition1.p1.4.4.m4.2.3.2.2">𝑀</ci><list id="Thmdefinition1.p1.4.4.m4.2.2.2.3.cmml" xref="Thmdefinition1.p1.4.4.m4.2.2.2.4"><ci id="Thmdefinition1.p1.4.4.m4.1.1.1.1.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1.1.1">𝑖</ci><ci id="Thmdefinition1.p1.4.4.m4.2.2.2.2.cmml" xref="Thmdefinition1.p1.4.4.m4.2.2.2.2">𝑗</ci></list></apply><cn id="Thmdefinition1.p1.4.4.m4.2.3.3.cmml" type="integer" xref="Thmdefinition1.p1.4.4.m4.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.4.4.m4.2c">M_{i,j}=0</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.4.4.m4.2d">italic_M start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = 0</annotation></semantics></math> when <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="Thmdefinition1.p1.5.5.m5.1"><semantics id="Thmdefinition1.p1.5.5.m5.1a"><mrow id="Thmdefinition1.p1.5.5.m5.1.1" xref="Thmdefinition1.p1.5.5.m5.1.1.cmml"><mrow id="Thmdefinition1.p1.5.5.m5.1.1.2" xref="Thmdefinition1.p1.5.5.m5.1.1.2.cmml"><mrow id="Thmdefinition1.p1.5.5.m5.1.1.2.2" xref="Thmdefinition1.p1.5.5.m5.1.1.2.2.cmml"><mi id="Thmdefinition1.p1.5.5.m5.1.1.2.2.2" xref="Thmdefinition1.p1.5.5.m5.1.1.2.2.2.cmml">i</mi><mo id="Thmdefinition1.p1.5.5.m5.1.1.2.2.1" xref="Thmdefinition1.p1.5.5.m5.1.1.2.2.1.cmml">−</mo><mi id="Thmdefinition1.p1.5.5.m5.1.1.2.2.3" xref="Thmdefinition1.p1.5.5.m5.1.1.2.2.3.cmml">L</mi></mrow><mo id="Thmdefinition1.p1.5.5.m5.1.1.2.1" xref="Thmdefinition1.p1.5.5.m5.1.1.2.1.cmml">+</mo><mn id="Thmdefinition1.p1.5.5.m5.1.1.2.3" xref="Thmdefinition1.p1.5.5.m5.1.1.2.3.cmml">1</mn></mrow><mo id="Thmdefinition1.p1.5.5.m5.1.1.3" xref="Thmdefinition1.p1.5.5.m5.1.1.3.cmml">≤</mo><mi id="Thmdefinition1.p1.5.5.m5.1.1.4" xref="Thmdefinition1.p1.5.5.m5.1.1.4.cmml">j</mi><mo id="Thmdefinition1.p1.5.5.m5.1.1.5" xref="Thmdefinition1.p1.5.5.m5.1.1.5.cmml">≤</mo><mi id="Thmdefinition1.p1.5.5.m5.1.1.6" xref="Thmdefinition1.p1.5.5.m5.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.5.5.m5.1b"><apply id="Thmdefinition1.p1.5.5.m5.1.1.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1"><and id="Thmdefinition1.p1.5.5.m5.1.1a.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1"></and><apply id="Thmdefinition1.p1.5.5.m5.1.1b.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1"><leq id="Thmdefinition1.p1.5.5.m5.1.1.3.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.3"></leq><apply id="Thmdefinition1.p1.5.5.m5.1.1.2.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.2"><plus id="Thmdefinition1.p1.5.5.m5.1.1.2.1.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.2.1"></plus><apply id="Thmdefinition1.p1.5.5.m5.1.1.2.2.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.2.2"><minus id="Thmdefinition1.p1.5.5.m5.1.1.2.2.1.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.2.2.1"></minus><ci id="Thmdefinition1.p1.5.5.m5.1.1.2.2.2.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.2.2.2">𝑖</ci><ci id="Thmdefinition1.p1.5.5.m5.1.1.2.2.3.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.2.2.3">𝐿</ci></apply><cn id="Thmdefinition1.p1.5.5.m5.1.1.2.3.cmml" type="integer" xref="Thmdefinition1.p1.5.5.m5.1.1.2.3">1</cn></apply><ci id="Thmdefinition1.p1.5.5.m5.1.1.4.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.4">𝑗</ci></apply><apply id="Thmdefinition1.p1.5.5.m5.1.1c.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1"><leq id="Thmdefinition1.p1.5.5.m5.1.1.5.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#Thmdefinition1.p1.5.5.m5.1.1.4.cmml" id="Thmdefinition1.p1.5.5.m5.1.1d.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1"></share><ci id="Thmdefinition1.p1.5.5.m5.1.1.6.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.5.5.m5.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.5.5.m5.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math> and <math alttext="M_{i,j}=-\infty" class="ltx_Math" display="inline" id="Thmdefinition1.p1.6.6.m6.2"><semantics id="Thmdefinition1.p1.6.6.m6.2a"><mrow id="Thmdefinition1.p1.6.6.m6.2.3" xref="Thmdefinition1.p1.6.6.m6.2.3.cmml"><msub id="Thmdefinition1.p1.6.6.m6.2.3.2" xref="Thmdefinition1.p1.6.6.m6.2.3.2.cmml"><mi id="Thmdefinition1.p1.6.6.m6.2.3.2.2" xref="Thmdefinition1.p1.6.6.m6.2.3.2.2.cmml">M</mi><mrow id="Thmdefinition1.p1.6.6.m6.2.2.2.4" xref="Thmdefinition1.p1.6.6.m6.2.2.2.3.cmml"><mi id="Thmdefinition1.p1.6.6.m6.1.1.1.1" xref="Thmdefinition1.p1.6.6.m6.1.1.1.1.cmml">i</mi><mo id="Thmdefinition1.p1.6.6.m6.2.2.2.4.1" xref="Thmdefinition1.p1.6.6.m6.2.2.2.3.cmml">,</mo><mi id="Thmdefinition1.p1.6.6.m6.2.2.2.2" xref="Thmdefinition1.p1.6.6.m6.2.2.2.2.cmml">j</mi></mrow></msub><mo id="Thmdefinition1.p1.6.6.m6.2.3.1" xref="Thmdefinition1.p1.6.6.m6.2.3.1.cmml">=</mo><mrow id="Thmdefinition1.p1.6.6.m6.2.3.3" xref="Thmdefinition1.p1.6.6.m6.2.3.3.cmml"><mo id="Thmdefinition1.p1.6.6.m6.2.3.3a" xref="Thmdefinition1.p1.6.6.m6.2.3.3.cmml">−</mo><mi id="Thmdefinition1.p1.6.6.m6.2.3.3.2" mathvariant="normal" xref="Thmdefinition1.p1.6.6.m6.2.3.3.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.6.6.m6.2b"><apply id="Thmdefinition1.p1.6.6.m6.2.3.cmml" xref="Thmdefinition1.p1.6.6.m6.2.3"><eq id="Thmdefinition1.p1.6.6.m6.2.3.1.cmml" xref="Thmdefinition1.p1.6.6.m6.2.3.1"></eq><apply id="Thmdefinition1.p1.6.6.m6.2.3.2.cmml" xref="Thmdefinition1.p1.6.6.m6.2.3.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.6.m6.2.3.2.1.cmml" xref="Thmdefinition1.p1.6.6.m6.2.3.2">subscript</csymbol><ci id="Thmdefinition1.p1.6.6.m6.2.3.2.2.cmml" xref="Thmdefinition1.p1.6.6.m6.2.3.2.2">𝑀</ci><list id="Thmdefinition1.p1.6.6.m6.2.2.2.3.cmml" xref="Thmdefinition1.p1.6.6.m6.2.2.2.4"><ci id="Thmdefinition1.p1.6.6.m6.1.1.1.1.cmml" xref="Thmdefinition1.p1.6.6.m6.1.1.1.1">𝑖</ci><ci id="Thmdefinition1.p1.6.6.m6.2.2.2.2.cmml" xref="Thmdefinition1.p1.6.6.m6.2.2.2.2">𝑗</ci></list></apply><apply id="Thmdefinition1.p1.6.6.m6.2.3.3.cmml" xref="Thmdefinition1.p1.6.6.m6.2.3.3"><minus id="Thmdefinition1.p1.6.6.m6.2.3.3.1.cmml" xref="Thmdefinition1.p1.6.6.m6.2.3.3"></minus><infinity id="Thmdefinition1.p1.6.6.m6.2.3.3.2.cmml" xref="Thmdefinition1.p1.6.6.m6.2.3.3.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.6.6.m6.2c">M_{i,j}=-\infty</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.6.6.m6.2d">italic_M start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = - ∞</annotation></semantics></math> otherwise. Then LAM is defined as</span></p>
</div>
<div class="ltx_para" id="Thmdefinition1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{LAM}(Q,K,V)=\operatorname{softmax}\left(\frac{QK^{T}+M}{\sqrt{d_%
{q}}}\right)V." class="ltx_Math" display="block" id="S3.E3.m1.7"><semantics id="S3.E3.m1.7a"><mrow id="S3.E3.m1.7.7.1" xref="S3.E3.m1.7.7.1.1.cmml"><mrow id="S3.E3.m1.7.7.1.1" xref="S3.E3.m1.7.7.1.1.cmml"><mrow id="S3.E3.m1.7.7.1.1.2.2" xref="S3.E3.m1.7.7.1.1.2.1.cmml"><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">LAM</mi><mo id="S3.E3.m1.7.7.1.1.2.2a" xref="S3.E3.m1.7.7.1.1.2.1.cmml">⁡</mo><mrow id="S3.E3.m1.7.7.1.1.2.2.1" xref="S3.E3.m1.7.7.1.1.2.1.cmml"><mo id="S3.E3.m1.7.7.1.1.2.2.1.1" stretchy="false" xref="S3.E3.m1.7.7.1.1.2.1.cmml">(</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">Q</mi><mo id="S3.E3.m1.7.7.1.1.2.2.1.2" xref="S3.E3.m1.7.7.1.1.2.1.cmml">,</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">K</mi><mo id="S3.E3.m1.7.7.1.1.2.2.1.3" xref="S3.E3.m1.7.7.1.1.2.1.cmml">,</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">V</mi><mo id="S3.E3.m1.7.7.1.1.2.2.1.4" stretchy="false" xref="S3.E3.m1.7.7.1.1.2.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.7.7.1.1.1" xref="S3.E3.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.7.7.1.1.3" xref="S3.E3.m1.7.7.1.1.3.cmml"><mrow id="S3.E3.m1.7.7.1.1.3.2.2" xref="S3.E3.m1.7.7.1.1.3.2.1.cmml"><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">softmax</mi><mo id="S3.E3.m1.7.7.1.1.3.2.2a" xref="S3.E3.m1.7.7.1.1.3.2.1.cmml">⁡</mo><mrow id="S3.E3.m1.7.7.1.1.3.2.2.1" xref="S3.E3.m1.7.7.1.1.3.2.1.cmml"><mo id="S3.E3.m1.7.7.1.1.3.2.2.1.1" xref="S3.E3.m1.7.7.1.1.3.2.1.cmml">(</mo><mfrac id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml"><mrow id="S3.E3.m1.6.6.2" xref="S3.E3.m1.6.6.2.cmml"><mrow id="S3.E3.m1.6.6.2.2" xref="S3.E3.m1.6.6.2.2.cmml"><mi id="S3.E3.m1.6.6.2.2.2" xref="S3.E3.m1.6.6.2.2.2.cmml">Q</mi><mo id="S3.E3.m1.6.6.2.2.1" xref="S3.E3.m1.6.6.2.2.1.cmml">⁢</mo><msup id="S3.E3.m1.6.6.2.2.3" xref="S3.E3.m1.6.6.2.2.3.cmml"><mi id="S3.E3.m1.6.6.2.2.3.2" xref="S3.E3.m1.6.6.2.2.3.2.cmml">K</mi><mi id="S3.E3.m1.6.6.2.2.3.3" xref="S3.E3.m1.6.6.2.2.3.3.cmml">T</mi></msup></mrow><mo id="S3.E3.m1.6.6.2.1" xref="S3.E3.m1.6.6.2.1.cmml">+</mo><mi id="S3.E3.m1.6.6.2.3" xref="S3.E3.m1.6.6.2.3.cmml">M</mi></mrow><msqrt id="S3.E3.m1.6.6.3" xref="S3.E3.m1.6.6.3.cmml"><msub id="S3.E3.m1.6.6.3.2" xref="S3.E3.m1.6.6.3.2.cmml"><mi id="S3.E3.m1.6.6.3.2.2" xref="S3.E3.m1.6.6.3.2.2.cmml">d</mi><mi id="S3.E3.m1.6.6.3.2.3" xref="S3.E3.m1.6.6.3.2.3.cmml">q</mi></msub></msqrt></mfrac><mo id="S3.E3.m1.7.7.1.1.3.2.2.1.2" xref="S3.E3.m1.7.7.1.1.3.2.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.7.7.1.1.3.1" xref="S3.E3.m1.7.7.1.1.3.1.cmml">⁢</mo><mi id="S3.E3.m1.7.7.1.1.3.3" xref="S3.E3.m1.7.7.1.1.3.3.cmml">V</mi></mrow></mrow><mo id="S3.E3.m1.7.7.1.2" lspace="0em" xref="S3.E3.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.7b"><apply id="S3.E3.m1.7.7.1.1.cmml" xref="S3.E3.m1.7.7.1"><eq id="S3.E3.m1.7.7.1.1.1.cmml" xref="S3.E3.m1.7.7.1.1.1"></eq><apply id="S3.E3.m1.7.7.1.1.2.1.cmml" xref="S3.E3.m1.7.7.1.1.2.2"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">LAM</ci><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝑄</ci><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝐾</ci><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑉</ci></apply><apply id="S3.E3.m1.7.7.1.1.3.cmml" xref="S3.E3.m1.7.7.1.1.3"><times id="S3.E3.m1.7.7.1.1.3.1.cmml" xref="S3.E3.m1.7.7.1.1.3.1"></times><apply id="S3.E3.m1.7.7.1.1.3.2.1.cmml" xref="S3.E3.m1.7.7.1.1.3.2.2"><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">softmax</ci><apply id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6"><divide id="S3.E3.m1.6.6.1.cmml" xref="S3.E3.m1.6.6"></divide><apply id="S3.E3.m1.6.6.2.cmml" xref="S3.E3.m1.6.6.2"><plus id="S3.E3.m1.6.6.2.1.cmml" xref="S3.E3.m1.6.6.2.1"></plus><apply id="S3.E3.m1.6.6.2.2.cmml" xref="S3.E3.m1.6.6.2.2"><times id="S3.E3.m1.6.6.2.2.1.cmml" xref="S3.E3.m1.6.6.2.2.1"></times><ci id="S3.E3.m1.6.6.2.2.2.cmml" xref="S3.E3.m1.6.6.2.2.2">𝑄</ci><apply id="S3.E3.m1.6.6.2.2.3.cmml" xref="S3.E3.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.2.2.3.1.cmml" xref="S3.E3.m1.6.6.2.2.3">superscript</csymbol><ci id="S3.E3.m1.6.6.2.2.3.2.cmml" xref="S3.E3.m1.6.6.2.2.3.2">𝐾</ci><ci id="S3.E3.m1.6.6.2.2.3.3.cmml" xref="S3.E3.m1.6.6.2.2.3.3">𝑇</ci></apply></apply><ci id="S3.E3.m1.6.6.2.3.cmml" xref="S3.E3.m1.6.6.2.3">𝑀</ci></apply><apply id="S3.E3.m1.6.6.3.cmml" xref="S3.E3.m1.6.6.3"><root id="S3.E3.m1.6.6.3a.cmml" xref="S3.E3.m1.6.6.3"></root><apply id="S3.E3.m1.6.6.3.2.cmml" xref="S3.E3.m1.6.6.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.3.2.1.cmml" xref="S3.E3.m1.6.6.3.2">subscript</csymbol><ci id="S3.E3.m1.6.6.3.2.2.cmml" xref="S3.E3.m1.6.6.3.2.2">𝑑</ci><ci id="S3.E3.m1.6.6.3.2.3.cmml" xref="S3.E3.m1.6.6.3.2.3">𝑞</ci></apply></apply></apply></apply><ci id="S3.E3.m1.7.7.1.1.3.3.cmml" xref="S3.E3.m1.7.7.1.1.3.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.7c">\operatorname{LAM}(Q,K,V)=\operatorname{softmax}\left(\frac{QK^{T}+M}{\sqrt{d_%
{q}}}\right)V.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.7d">roman_LAM ( italic_Q , italic_K , italic_V ) = roman_softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_M end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.p5">
<p class="ltx_p" id="S3.p5.8">Note that adding the matrix <math alttext="M" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><mi id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><ci id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">italic_M</annotation></semantics></math> and applying softmax leads to several zero entries in the matrix <math alttext="\operatorname{softmax}\left((QK^{T}+M)/\sqrt{d_{q}}\right)" class="ltx_Math" display="inline" id="S3.p5.2.m2.2"><semantics id="S3.p5.2.m2.2a"><mrow id="S3.p5.2.m2.2.2.1" xref="S3.p5.2.m2.2.2.2.cmml"><mi id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml">softmax</mi><mo id="S3.p5.2.m2.2.2.1a" xref="S3.p5.2.m2.2.2.2.cmml">⁡</mo><mrow id="S3.p5.2.m2.2.2.1.1" xref="S3.p5.2.m2.2.2.2.cmml"><mo id="S3.p5.2.m2.2.2.1.1.2" xref="S3.p5.2.m2.2.2.2.cmml">(</mo><mrow id="S3.p5.2.m2.2.2.1.1.1" xref="S3.p5.2.m2.2.2.1.1.1.cmml"><mrow id="S3.p5.2.m2.2.2.1.1.1.1.1" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.p5.2.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p5.2.m2.2.2.1.1.1.1.1.1" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.2" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.2.cmml">Q</mi><mo id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.1" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.2" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.2.cmml">K</mi><mi id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.3" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="S3.p5.2.m2.2.2.1.1.1.1.1.1.1" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.p5.2.m2.2.2.1.1.1.1.1.1.3" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.3.cmml">M</mi></mrow><mo id="S3.p5.2.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p5.2.m2.2.2.1.1.1.2" xref="S3.p5.2.m2.2.2.1.1.1.2.cmml">/</mo><msqrt id="S3.p5.2.m2.2.2.1.1.1.3" xref="S3.p5.2.m2.2.2.1.1.1.3.cmml"><msub id="S3.p5.2.m2.2.2.1.1.1.3.2" xref="S3.p5.2.m2.2.2.1.1.1.3.2.cmml"><mi id="S3.p5.2.m2.2.2.1.1.1.3.2.2" xref="S3.p5.2.m2.2.2.1.1.1.3.2.2.cmml">d</mi><mi id="S3.p5.2.m2.2.2.1.1.1.3.2.3" xref="S3.p5.2.m2.2.2.1.1.1.3.2.3.cmml">q</mi></msub></msqrt></mrow><mo id="S3.p5.2.m2.2.2.1.1.3" xref="S3.p5.2.m2.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.2b"><apply id="S3.p5.2.m2.2.2.2.cmml" xref="S3.p5.2.m2.2.2.1"><ci id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1">softmax</ci><apply id="S3.p5.2.m2.2.2.1.1.1.cmml" xref="S3.p5.2.m2.2.2.1.1.1"><divide id="S3.p5.2.m2.2.2.1.1.1.2.cmml" xref="S3.p5.2.m2.2.2.1.1.1.2"></divide><apply id="S3.p5.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.p5.2.m2.2.2.1.1.1.1.1"><plus id="S3.p5.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2"><times id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.1"></times><ci id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.2">𝑄</ci><apply id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.2">𝐾</ci><ci id="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S3.p5.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.p5.2.m2.2.2.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.p5.2.m2.2.2.1.1.1.3.cmml" xref="S3.p5.2.m2.2.2.1.1.1.3"><root id="S3.p5.2.m2.2.2.1.1.1.3a.cmml" xref="S3.p5.2.m2.2.2.1.1.1.3"></root><apply id="S3.p5.2.m2.2.2.1.1.1.3.2.cmml" xref="S3.p5.2.m2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p5.2.m2.2.2.1.1.1.3.2.1.cmml" xref="S3.p5.2.m2.2.2.1.1.1.3.2">subscript</csymbol><ci id="S3.p5.2.m2.2.2.1.1.1.3.2.2.cmml" xref="S3.p5.2.m2.2.2.1.1.1.3.2.2">𝑑</ci><ci id="S3.p5.2.m2.2.2.1.1.1.3.2.3.cmml" xref="S3.p5.2.m2.2.2.1.1.1.3.2.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.2c">\operatorname{softmax}\left((QK^{T}+M)/\sqrt{d_{q}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m2.2d">roman_softmax ( ( italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_M ) / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math>. In fact, the scores corresponding to the scalar/dot product of the query <math alttext="Q_{i}" class="ltx_Math" display="inline" id="S3.p5.3.m3.1"><semantics id="S3.p5.3.m3.1a"><msub id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml"><mi id="S3.p5.3.m3.1.1.2" xref="S3.p5.3.m3.1.1.2.cmml">Q</mi><mi id="S3.p5.3.m3.1.1.3" xref="S3.p5.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><apply id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p5.3.m3.1.1.1.cmml" xref="S3.p5.3.m3.1.1">subscript</csymbol><ci id="S3.p5.3.m3.1.1.2.cmml" xref="S3.p5.3.m3.1.1.2">𝑄</ci><ci id="S3.p5.3.m3.1.1.3.cmml" xref="S3.p5.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">Q_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.3.m3.1d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with the keys <math alttext="K_{j}" class="ltx_Math" display="inline" id="S3.p5.4.m4.1"><semantics id="S3.p5.4.m4.1a"><msub id="S3.p5.4.m4.1.1" xref="S3.p5.4.m4.1.1.cmml"><mi id="S3.p5.4.m4.1.1.2" xref="S3.p5.4.m4.1.1.2.cmml">K</mi><mi id="S3.p5.4.m4.1.1.3" xref="S3.p5.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.4.m4.1b"><apply id="S3.p5.4.m4.1.1.cmml" xref="S3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p5.4.m4.1.1.1.cmml" xref="S3.p5.4.m4.1.1">subscript</csymbol><ci id="S3.p5.4.m4.1.1.2.cmml" xref="S3.p5.4.m4.1.1.2">𝐾</ci><ci id="S3.p5.4.m4.1.1.3.cmml" xref="S3.p5.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.m4.1c">K_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.4.m4.1d">italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="S3.p5.5.m5.1"><semantics id="S3.p5.5.m5.1a"><mrow id="S3.p5.5.m5.1.1" xref="S3.p5.5.m5.1.1.cmml"><mrow id="S3.p5.5.m5.1.1.2" xref="S3.p5.5.m5.1.1.2.cmml"><mrow id="S3.p5.5.m5.1.1.2.2" xref="S3.p5.5.m5.1.1.2.2.cmml"><mi id="S3.p5.5.m5.1.1.2.2.2" xref="S3.p5.5.m5.1.1.2.2.2.cmml">i</mi><mo id="S3.p5.5.m5.1.1.2.2.1" xref="S3.p5.5.m5.1.1.2.2.1.cmml">−</mo><mi id="S3.p5.5.m5.1.1.2.2.3" xref="S3.p5.5.m5.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.p5.5.m5.1.1.2.1" xref="S3.p5.5.m5.1.1.2.1.cmml">+</mo><mn id="S3.p5.5.m5.1.1.2.3" xref="S3.p5.5.m5.1.1.2.3.cmml">1</mn></mrow><mo id="S3.p5.5.m5.1.1.3" xref="S3.p5.5.m5.1.1.3.cmml">≤</mo><mi id="S3.p5.5.m5.1.1.4" xref="S3.p5.5.m5.1.1.4.cmml">j</mi><mo id="S3.p5.5.m5.1.1.5" xref="S3.p5.5.m5.1.1.5.cmml">≤</mo><mi id="S3.p5.5.m5.1.1.6" xref="S3.p5.5.m5.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.5.m5.1b"><apply id="S3.p5.5.m5.1.1.cmml" xref="S3.p5.5.m5.1.1"><and id="S3.p5.5.m5.1.1a.cmml" xref="S3.p5.5.m5.1.1"></and><apply id="S3.p5.5.m5.1.1b.cmml" xref="S3.p5.5.m5.1.1"><leq id="S3.p5.5.m5.1.1.3.cmml" xref="S3.p5.5.m5.1.1.3"></leq><apply id="S3.p5.5.m5.1.1.2.cmml" xref="S3.p5.5.m5.1.1.2"><plus id="S3.p5.5.m5.1.1.2.1.cmml" xref="S3.p5.5.m5.1.1.2.1"></plus><apply id="S3.p5.5.m5.1.1.2.2.cmml" xref="S3.p5.5.m5.1.1.2.2"><minus id="S3.p5.5.m5.1.1.2.2.1.cmml" xref="S3.p5.5.m5.1.1.2.2.1"></minus><ci id="S3.p5.5.m5.1.1.2.2.2.cmml" xref="S3.p5.5.m5.1.1.2.2.2">𝑖</ci><ci id="S3.p5.5.m5.1.1.2.2.3.cmml" xref="S3.p5.5.m5.1.1.2.2.3">𝐿</ci></apply><cn id="S3.p5.5.m5.1.1.2.3.cmml" type="integer" xref="S3.p5.5.m5.1.1.2.3">1</cn></apply><ci id="S3.p5.5.m5.1.1.4.cmml" xref="S3.p5.5.m5.1.1.4">𝑗</ci></apply><apply id="S3.p5.5.m5.1.1c.cmml" xref="S3.p5.5.m5.1.1"><leq id="S3.p5.5.m5.1.1.5.cmml" xref="S3.p5.5.m5.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.p5.5.m5.1.1.4.cmml" id="S3.p5.5.m5.1.1d.cmml" xref="S3.p5.5.m5.1.1"></share><ci id="S3.p5.5.m5.1.1.6.cmml" xref="S3.p5.5.m5.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.5.m5.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="S3.p5.5.m5.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math> are the only ones that may not be zero. That is, the <math alttext="j" class="ltx_Math" display="inline" id="S3.p5.6.m6.1"><semantics id="S3.p5.6.m6.1a"><mi id="S3.p5.6.m6.1.1" xref="S3.p5.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.p5.6.m6.1b"><ci id="S3.p5.6.m6.1.1.cmml" xref="S3.p5.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.p5.6.m6.1d">italic_j</annotation></semantics></math>-th output of <math alttext="\operatorname{LAM}(Q,K,V)" class="ltx_Math" display="inline" id="S3.p5.7.m7.4"><semantics id="S3.p5.7.m7.4a"><mrow id="S3.p5.7.m7.4.5.2" xref="S3.p5.7.m7.4.5.1.cmml"><mi id="S3.p5.7.m7.1.1" xref="S3.p5.7.m7.1.1.cmml">LAM</mi><mo id="S3.p5.7.m7.4.5.2a" xref="S3.p5.7.m7.4.5.1.cmml">⁡</mo><mrow id="S3.p5.7.m7.4.5.2.1" xref="S3.p5.7.m7.4.5.1.cmml"><mo id="S3.p5.7.m7.4.5.2.1.1" stretchy="false" xref="S3.p5.7.m7.4.5.1.cmml">(</mo><mi id="S3.p5.7.m7.2.2" xref="S3.p5.7.m7.2.2.cmml">Q</mi><mo id="S3.p5.7.m7.4.5.2.1.2" xref="S3.p5.7.m7.4.5.1.cmml">,</mo><mi id="S3.p5.7.m7.3.3" xref="S3.p5.7.m7.3.3.cmml">K</mi><mo id="S3.p5.7.m7.4.5.2.1.3" xref="S3.p5.7.m7.4.5.1.cmml">,</mo><mi id="S3.p5.7.m7.4.4" xref="S3.p5.7.m7.4.4.cmml">V</mi><mo id="S3.p5.7.m7.4.5.2.1.4" stretchy="false" xref="S3.p5.7.m7.4.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.7.m7.4b"><apply id="S3.p5.7.m7.4.5.1.cmml" xref="S3.p5.7.m7.4.5.2"><ci id="S3.p5.7.m7.1.1.cmml" xref="S3.p5.7.m7.1.1">LAM</ci><ci id="S3.p5.7.m7.2.2.cmml" xref="S3.p5.7.m7.2.2">𝑄</ci><ci id="S3.p5.7.m7.3.3.cmml" xref="S3.p5.7.m7.3.3">𝐾</ci><ci id="S3.p5.7.m7.4.4.cmml" xref="S3.p5.7.m7.4.4">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.7.m7.4c">\operatorname{LAM}(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.7.m7.4d">roman_LAM ( italic_Q , italic_K , italic_V )</annotation></semantics></math> is a weighted average of <math alttext="V_{j-L+1},V_{j-L+2},\ldots,V_{j}" class="ltx_Math" display="inline" id="S3.p5.8.m8.4"><semantics id="S3.p5.8.m8.4a"><mrow id="S3.p5.8.m8.4.4.3" xref="S3.p5.8.m8.4.4.4.cmml"><msub id="S3.p5.8.m8.2.2.1.1" xref="S3.p5.8.m8.2.2.1.1.cmml"><mi id="S3.p5.8.m8.2.2.1.1.2" xref="S3.p5.8.m8.2.2.1.1.2.cmml">V</mi><mrow id="S3.p5.8.m8.2.2.1.1.3" xref="S3.p5.8.m8.2.2.1.1.3.cmml"><mrow id="S3.p5.8.m8.2.2.1.1.3.2" xref="S3.p5.8.m8.2.2.1.1.3.2.cmml"><mi id="S3.p5.8.m8.2.2.1.1.3.2.2" xref="S3.p5.8.m8.2.2.1.1.3.2.2.cmml">j</mi><mo id="S3.p5.8.m8.2.2.1.1.3.2.1" xref="S3.p5.8.m8.2.2.1.1.3.2.1.cmml">−</mo><mi id="S3.p5.8.m8.2.2.1.1.3.2.3" xref="S3.p5.8.m8.2.2.1.1.3.2.3.cmml">L</mi></mrow><mo id="S3.p5.8.m8.2.2.1.1.3.1" xref="S3.p5.8.m8.2.2.1.1.3.1.cmml">+</mo><mn id="S3.p5.8.m8.2.2.1.1.3.3" xref="S3.p5.8.m8.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.p5.8.m8.4.4.3.4" xref="S3.p5.8.m8.4.4.4.cmml">,</mo><msub id="S3.p5.8.m8.3.3.2.2" xref="S3.p5.8.m8.3.3.2.2.cmml"><mi id="S3.p5.8.m8.3.3.2.2.2" xref="S3.p5.8.m8.3.3.2.2.2.cmml">V</mi><mrow id="S3.p5.8.m8.3.3.2.2.3" xref="S3.p5.8.m8.3.3.2.2.3.cmml"><mrow id="S3.p5.8.m8.3.3.2.2.3.2" xref="S3.p5.8.m8.3.3.2.2.3.2.cmml"><mi id="S3.p5.8.m8.3.3.2.2.3.2.2" xref="S3.p5.8.m8.3.3.2.2.3.2.2.cmml">j</mi><mo id="S3.p5.8.m8.3.3.2.2.3.2.1" xref="S3.p5.8.m8.3.3.2.2.3.2.1.cmml">−</mo><mi id="S3.p5.8.m8.3.3.2.2.3.2.3" xref="S3.p5.8.m8.3.3.2.2.3.2.3.cmml">L</mi></mrow><mo id="S3.p5.8.m8.3.3.2.2.3.1" xref="S3.p5.8.m8.3.3.2.2.3.1.cmml">+</mo><mn id="S3.p5.8.m8.3.3.2.2.3.3" xref="S3.p5.8.m8.3.3.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S3.p5.8.m8.4.4.3.5" xref="S3.p5.8.m8.4.4.4.cmml">,</mo><mi id="S3.p5.8.m8.1.1" mathvariant="normal" xref="S3.p5.8.m8.1.1.cmml">…</mi><mo id="S3.p5.8.m8.4.4.3.6" xref="S3.p5.8.m8.4.4.4.cmml">,</mo><msub id="S3.p5.8.m8.4.4.3.3" xref="S3.p5.8.m8.4.4.3.3.cmml"><mi id="S3.p5.8.m8.4.4.3.3.2" xref="S3.p5.8.m8.4.4.3.3.2.cmml">V</mi><mi id="S3.p5.8.m8.4.4.3.3.3" xref="S3.p5.8.m8.4.4.3.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.8.m8.4b"><list id="S3.p5.8.m8.4.4.4.cmml" xref="S3.p5.8.m8.4.4.3"><apply id="S3.p5.8.m8.2.2.1.1.cmml" xref="S3.p5.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="S3.p5.8.m8.2.2.1.1.1.cmml" xref="S3.p5.8.m8.2.2.1.1">subscript</csymbol><ci id="S3.p5.8.m8.2.2.1.1.2.cmml" xref="S3.p5.8.m8.2.2.1.1.2">𝑉</ci><apply id="S3.p5.8.m8.2.2.1.1.3.cmml" xref="S3.p5.8.m8.2.2.1.1.3"><plus id="S3.p5.8.m8.2.2.1.1.3.1.cmml" xref="S3.p5.8.m8.2.2.1.1.3.1"></plus><apply id="S3.p5.8.m8.2.2.1.1.3.2.cmml" xref="S3.p5.8.m8.2.2.1.1.3.2"><minus id="S3.p5.8.m8.2.2.1.1.3.2.1.cmml" xref="S3.p5.8.m8.2.2.1.1.3.2.1"></minus><ci id="S3.p5.8.m8.2.2.1.1.3.2.2.cmml" xref="S3.p5.8.m8.2.2.1.1.3.2.2">𝑗</ci><ci id="S3.p5.8.m8.2.2.1.1.3.2.3.cmml" xref="S3.p5.8.m8.2.2.1.1.3.2.3">𝐿</ci></apply><cn id="S3.p5.8.m8.2.2.1.1.3.3.cmml" type="integer" xref="S3.p5.8.m8.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.p5.8.m8.3.3.2.2.cmml" xref="S3.p5.8.m8.3.3.2.2"><csymbol cd="ambiguous" id="S3.p5.8.m8.3.3.2.2.1.cmml" xref="S3.p5.8.m8.3.3.2.2">subscript</csymbol><ci id="S3.p5.8.m8.3.3.2.2.2.cmml" xref="S3.p5.8.m8.3.3.2.2.2">𝑉</ci><apply id="S3.p5.8.m8.3.3.2.2.3.cmml" xref="S3.p5.8.m8.3.3.2.2.3"><plus id="S3.p5.8.m8.3.3.2.2.3.1.cmml" xref="S3.p5.8.m8.3.3.2.2.3.1"></plus><apply id="S3.p5.8.m8.3.3.2.2.3.2.cmml" xref="S3.p5.8.m8.3.3.2.2.3.2"><minus id="S3.p5.8.m8.3.3.2.2.3.2.1.cmml" xref="S3.p5.8.m8.3.3.2.2.3.2.1"></minus><ci id="S3.p5.8.m8.3.3.2.2.3.2.2.cmml" xref="S3.p5.8.m8.3.3.2.2.3.2.2">𝑗</ci><ci id="S3.p5.8.m8.3.3.2.2.3.2.3.cmml" xref="S3.p5.8.m8.3.3.2.2.3.2.3">𝐿</ci></apply><cn id="S3.p5.8.m8.3.3.2.2.3.3.cmml" type="integer" xref="S3.p5.8.m8.3.3.2.2.3.3">2</cn></apply></apply><ci id="S3.p5.8.m8.1.1.cmml" xref="S3.p5.8.m8.1.1">…</ci><apply id="S3.p5.8.m8.4.4.3.3.cmml" xref="S3.p5.8.m8.4.4.3.3"><csymbol cd="ambiguous" id="S3.p5.8.m8.4.4.3.3.1.cmml" xref="S3.p5.8.m8.4.4.3.3">subscript</csymbol><ci id="S3.p5.8.m8.4.4.3.3.2.cmml" xref="S3.p5.8.m8.4.4.3.3.2">𝑉</ci><ci id="S3.p5.8.m8.4.4.3.3.3.cmml" xref="S3.p5.8.m8.4.4.3.3.3">𝑗</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.8.m8.4c">V_{j-L+1},V_{j-L+2},\ldots,V_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.8.m8.4d">italic_V start_POSTSUBSCRIPT italic_j - italic_L + 1 end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_j - italic_L + 2 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. This is visualised in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.F2.sf1" title="In Figure 2 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2(a)</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p6">
<p class="ltx_p" id="S3.p6.4">At first glance, the brute force implementation of LAM by computing <math alttext="QK^{T}" class="ltx_Math" display="inline" id="S3.p6.1.m1.1"><semantics id="S3.p6.1.m1.1a"><mrow id="S3.p6.1.m1.1.1" xref="S3.p6.1.m1.1.1.cmml"><mi id="S3.p6.1.m1.1.1.2" xref="S3.p6.1.m1.1.1.2.cmml">Q</mi><mo id="S3.p6.1.m1.1.1.1" xref="S3.p6.1.m1.1.1.1.cmml">⁢</mo><msup id="S3.p6.1.m1.1.1.3" xref="S3.p6.1.m1.1.1.3.cmml"><mi id="S3.p6.1.m1.1.1.3.2" xref="S3.p6.1.m1.1.1.3.2.cmml">K</mi><mi id="S3.p6.1.m1.1.1.3.3" xref="S3.p6.1.m1.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.1.m1.1b"><apply id="S3.p6.1.m1.1.1.cmml" xref="S3.p6.1.m1.1.1"><times id="S3.p6.1.m1.1.1.1.cmml" xref="S3.p6.1.m1.1.1.1"></times><ci id="S3.p6.1.m1.1.1.2.cmml" xref="S3.p6.1.m1.1.1.2">𝑄</ci><apply id="S3.p6.1.m1.1.1.3.cmml" xref="S3.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p6.1.m1.1.1.3.1.cmml" xref="S3.p6.1.m1.1.1.3">superscript</csymbol><ci id="S3.p6.1.m1.1.1.3.2.cmml" xref="S3.p6.1.m1.1.1.3.2">𝐾</ci><ci id="S3.p6.1.m1.1.1.3.3.cmml" xref="S3.p6.1.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.1.m1.1c">QK^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p6.1.m1.1d">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> gives quadratic time and memory complexity. Here we explain how to achieve <math alttext="\Theta(n\log n)" class="ltx_Math" display="inline" id="S3.p6.2.m2.1"><semantics id="S3.p6.2.m2.1a"><mrow id="S3.p6.2.m2.1.1" xref="S3.p6.2.m2.1.1.cmml"><mi id="S3.p6.2.m2.1.1.3" mathvariant="normal" xref="S3.p6.2.m2.1.1.3.cmml">Θ</mi><mo id="S3.p6.2.m2.1.1.2" xref="S3.p6.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.p6.2.m2.1.1.1.1" xref="S3.p6.2.m2.1.1.1.1.1.cmml"><mo id="S3.p6.2.m2.1.1.1.1.2" stretchy="false" xref="S3.p6.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.p6.2.m2.1.1.1.1.1" xref="S3.p6.2.m2.1.1.1.1.1.cmml"><mi id="S3.p6.2.m2.1.1.1.1.1.2" xref="S3.p6.2.m2.1.1.1.1.1.2.cmml">n</mi><mo id="S3.p6.2.m2.1.1.1.1.1.1" lspace="0.167em" xref="S3.p6.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.p6.2.m2.1.1.1.1.1.3" xref="S3.p6.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.p6.2.m2.1.1.1.1.1.3.1" xref="S3.p6.2.m2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.p6.2.m2.1.1.1.1.1.3a" lspace="0.167em" xref="S3.p6.2.m2.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.p6.2.m2.1.1.1.1.1.3.2" xref="S3.p6.2.m2.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S3.p6.2.m2.1.1.1.1.3" stretchy="false" xref="S3.p6.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.2.m2.1b"><apply id="S3.p6.2.m2.1.1.cmml" xref="S3.p6.2.m2.1.1"><times id="S3.p6.2.m2.1.1.2.cmml" xref="S3.p6.2.m2.1.1.2"></times><ci id="S3.p6.2.m2.1.1.3.cmml" xref="S3.p6.2.m2.1.1.3">Θ</ci><apply id="S3.p6.2.m2.1.1.1.1.1.cmml" xref="S3.p6.2.m2.1.1.1.1"><times id="S3.p6.2.m2.1.1.1.1.1.1.cmml" xref="S3.p6.2.m2.1.1.1.1.1.1"></times><ci id="S3.p6.2.m2.1.1.1.1.1.2.cmml" xref="S3.p6.2.m2.1.1.1.1.1.2">𝑛</ci><apply id="S3.p6.2.m2.1.1.1.1.1.3.cmml" xref="S3.p6.2.m2.1.1.1.1.1.3"><log id="S3.p6.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.p6.2.m2.1.1.1.1.1.3.1"></log><ci id="S3.p6.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.p6.2.m2.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.2.m2.1c">\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S3.p6.2.m2.1d">roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math> complexity in time and memory with a tensor algebra re-formulation of LAM. For ease of exposition, assume that <math alttext="L" class="ltx_Math" display="inline" id="S3.p6.3.m3.1"><semantics id="S3.p6.3.m3.1a"><mi id="S3.p6.3.m3.1.1" xref="S3.p6.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p6.3.m3.1b"><ci id="S3.p6.3.m3.1.1.cmml" xref="S3.p6.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.p6.3.m3.1d">italic_L</annotation></semantics></math> divides <math alttext="n" class="ltx_Math" display="inline" id="S3.p6.4.m4.1"><semantics id="S3.p6.4.m4.1a"><mi id="S3.p6.4.m4.1.1" xref="S3.p6.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p6.4.m4.1b"><ci id="S3.p6.4.m4.1.1.cmml" xref="S3.p6.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.p6.4.m4.1d">italic_n</annotation></semantics></math> (the general case will be addressed at the end of this section). Our algorithm to compute LAM is provided in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#alg1" title="Algorithm 1 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">1</span></a>, although the reader may find the following mathematical description useful.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p7">
<p class="ltx_p" id="S3.p7.5">Let <math alttext="s=n/L" class="ltx_Math" display="inline" id="S3.p7.1.m1.1"><semantics id="S3.p7.1.m1.1a"><mrow id="S3.p7.1.m1.1.1" xref="S3.p7.1.m1.1.1.cmml"><mi id="S3.p7.1.m1.1.1.2" xref="S3.p7.1.m1.1.1.2.cmml">s</mi><mo id="S3.p7.1.m1.1.1.1" xref="S3.p7.1.m1.1.1.1.cmml">=</mo><mrow id="S3.p7.1.m1.1.1.3" xref="S3.p7.1.m1.1.1.3.cmml"><mi id="S3.p7.1.m1.1.1.3.2" xref="S3.p7.1.m1.1.1.3.2.cmml">n</mi><mo id="S3.p7.1.m1.1.1.3.1" xref="S3.p7.1.m1.1.1.3.1.cmml">/</mo><mi id="S3.p7.1.m1.1.1.3.3" xref="S3.p7.1.m1.1.1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.1.m1.1b"><apply id="S3.p7.1.m1.1.1.cmml" xref="S3.p7.1.m1.1.1"><eq id="S3.p7.1.m1.1.1.1.cmml" xref="S3.p7.1.m1.1.1.1"></eq><ci id="S3.p7.1.m1.1.1.2.cmml" xref="S3.p7.1.m1.1.1.2">𝑠</ci><apply id="S3.p7.1.m1.1.1.3.cmml" xref="S3.p7.1.m1.1.1.3"><divide id="S3.p7.1.m1.1.1.3.1.cmml" xref="S3.p7.1.m1.1.1.3.1"></divide><ci id="S3.p7.1.m1.1.1.3.2.cmml" xref="S3.p7.1.m1.1.1.3.2">𝑛</ci><ci id="S3.p7.1.m1.1.1.3.3.cmml" xref="S3.p7.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.1.m1.1c">s=n/L</annotation><annotation encoding="application/x-llamapun" id="S3.p7.1.m1.1d">italic_s = italic_n / italic_L</annotation></semantics></math>. The key idea is splitting <math alttext="Q" class="ltx_Math" display="inline" id="S3.p7.2.m2.1"><semantics id="S3.p7.2.m2.1a"><mi id="S3.p7.2.m2.1.1" xref="S3.p7.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.p7.2.m2.1b"><ci id="S3.p7.2.m2.1.1.cmml" xref="S3.p7.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.p7.2.m2.1d">italic_Q</annotation></semantics></math> into <math alttext="s" class="ltx_Math" display="inline" id="S3.p7.3.m3.1"><semantics id="S3.p7.3.m3.1a"><mi id="S3.p7.3.m3.1.1" xref="S3.p7.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.p7.3.m3.1b"><ci id="S3.p7.3.m3.1.1.cmml" xref="S3.p7.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.3.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.p7.3.m3.1d">italic_s</annotation></semantics></math> blocks of dimensions <math alttext="L\times d_{q}" class="ltx_Math" display="inline" id="S3.p7.4.m4.1"><semantics id="S3.p7.4.m4.1a"><mrow id="S3.p7.4.m4.1.1" xref="S3.p7.4.m4.1.1.cmml"><mi id="S3.p7.4.m4.1.1.2" xref="S3.p7.4.m4.1.1.2.cmml">L</mi><mo id="S3.p7.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p7.4.m4.1.1.1.cmml">×</mo><msub id="S3.p7.4.m4.1.1.3" xref="S3.p7.4.m4.1.1.3.cmml"><mi id="S3.p7.4.m4.1.1.3.2" xref="S3.p7.4.m4.1.1.3.2.cmml">d</mi><mi id="S3.p7.4.m4.1.1.3.3" xref="S3.p7.4.m4.1.1.3.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.4.m4.1b"><apply id="S3.p7.4.m4.1.1.cmml" xref="S3.p7.4.m4.1.1"><times id="S3.p7.4.m4.1.1.1.cmml" xref="S3.p7.4.m4.1.1.1"></times><ci id="S3.p7.4.m4.1.1.2.cmml" xref="S3.p7.4.m4.1.1.2">𝐿</ci><apply id="S3.p7.4.m4.1.1.3.cmml" xref="S3.p7.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p7.4.m4.1.1.3.1.cmml" xref="S3.p7.4.m4.1.1.3">subscript</csymbol><ci id="S3.p7.4.m4.1.1.3.2.cmml" xref="S3.p7.4.m4.1.1.3.2">𝑑</ci><ci id="S3.p7.4.m4.1.1.3.3.cmml" xref="S3.p7.4.m4.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.4.m4.1c">L\times d_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.p7.4.m4.1d">italic_L × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and determining the smallest submatrices of <math alttext="K^{T}" class="ltx_Math" display="inline" id="S3.p7.5.m5.1"><semantics id="S3.p7.5.m5.1a"><msup id="S3.p7.5.m5.1.1" xref="S3.p7.5.m5.1.1.cmml"><mi id="S3.p7.5.m5.1.1.2" xref="S3.p7.5.m5.1.1.2.cmml">K</mi><mi id="S3.p7.5.m5.1.1.3" xref="S3.p7.5.m5.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p7.5.m5.1b"><apply id="S3.p7.5.m5.1.1.cmml" xref="S3.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p7.5.m5.1.1.1.cmml" xref="S3.p7.5.m5.1.1">superscript</csymbol><ci id="S3.p7.5.m5.1.1.2.cmml" xref="S3.p7.5.m5.1.1.2">𝐾</ci><ci id="S3.p7.5.m5.1.1.3.cmml" xref="S3.p7.5.m5.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.5.m5.1c">K^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p7.5.m5.1d">italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> that we have to multiply these blocks by so that the end results contain the dot products</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\langle Q_{i},K_{j}\rangle\text{ for all }" class="ltx_Math" display="inline" id="S3.E4X.2.1.1.m1.2"><semantics id="S3.E4X.2.1.1.m1.2a"><mrow id="S3.E4X.2.1.1.m1.2.2" xref="S3.E4X.2.1.1.m1.2.2.cmml"><mrow id="S3.E4X.2.1.1.m1.2.2.2.2" xref="S3.E4X.2.1.1.m1.2.2.2.3.cmml"><mo id="S3.E4X.2.1.1.m1.2.2.2.2.3" stretchy="false" xref="S3.E4X.2.1.1.m1.2.2.2.3.cmml">⟨</mo><msub id="S3.E4X.2.1.1.m1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.2.cmml">Q</mi><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4X.2.1.1.m1.2.2.2.2.4" xref="S3.E4X.2.1.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.E4X.2.1.1.m1.2.2.2.2.2" xref="S3.E4X.2.1.1.m1.2.2.2.2.2.cmml"><mi id="S3.E4X.2.1.1.m1.2.2.2.2.2.2" xref="S3.E4X.2.1.1.m1.2.2.2.2.2.2.cmml">K</mi><mi id="S3.E4X.2.1.1.m1.2.2.2.2.2.3" xref="S3.E4X.2.1.1.m1.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E4X.2.1.1.m1.2.2.2.2.5" stretchy="false" xref="S3.E4X.2.1.1.m1.2.2.2.3.cmml">⟩</mo></mrow><mo id="S3.E4X.2.1.1.m1.2.2.3" xref="S3.E4X.2.1.1.m1.2.2.3.cmml">⁢</mo><mtext id="S3.E4X.2.1.1.m1.2.2.4" xref="S3.E4X.2.1.1.m1.2.2.4a.cmml"> for all</mtext></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.2b"><apply id="S3.E4X.2.1.1.m1.2.2.cmml" xref="S3.E4X.2.1.1.m1.2.2"><times id="S3.E4X.2.1.1.m1.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.3"></times><list id="S3.E4X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.2.2"><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.2">𝑄</ci><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E4X.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.2.2.2.2">𝐾</ci><ci id="S3.E4X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.2.2.2.3">𝑗</ci></apply></list><ci id="S3.E4X.2.1.1.m1.2.2.4a.cmml" xref="S3.E4X.2.1.1.m1.2.2.4"><mtext id="S3.E4X.2.1.1.m1.2.2.4.cmml" xref="S3.E4X.2.1.1.m1.2.2.4"> for all</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.2c">\displaystyle\langle Q_{i},K_{j}\rangle\text{ for all }</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.2.1.1.m1.2d">⟨ italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ for all</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle r\in\{0,1,\ldots,s-1\},i\in\{rL,r(L+1)-1\}" class="ltx_Math" display="inline" id="S3.E4X.3.2.2.m1.5"><semantics id="S3.E4X.3.2.2.m1.5a"><mrow id="S3.E4X.3.2.2.m1.5.5.2" xref="S3.E4X.3.2.2.m1.5.5.3.cmml"><mrow id="S3.E4X.3.2.2.m1.4.4.1.1" xref="S3.E4X.3.2.2.m1.4.4.1.1.cmml"><mi id="S3.E4X.3.2.2.m1.4.4.1.1.3" xref="S3.E4X.3.2.2.m1.4.4.1.1.3.cmml">r</mi><mo id="S3.E4X.3.2.2.m1.4.4.1.1.2" xref="S3.E4X.3.2.2.m1.4.4.1.1.2.cmml">∈</mo><mrow id="S3.E4X.3.2.2.m1.4.4.1.1.1.1" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.2.cmml"><mo id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.2" stretchy="false" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.2.cmml">{</mo><mn id="S3.E4X.3.2.2.m1.1.1" xref="S3.E4X.3.2.2.m1.1.1.cmml">0</mn><mo id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.2.cmml">,</mo><mn id="S3.E4X.3.2.2.m1.2.2" xref="S3.E4X.3.2.2.m1.2.2.cmml">1</mn><mo id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.4" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.2.cmml">,</mo><mi id="S3.E4X.3.2.2.m1.3.3" mathvariant="normal" xref="S3.E4X.3.2.2.m1.3.3.cmml">…</mi><mo id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.5" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.2.cmml">,</mo><mrow id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.2.cmml">s</mi><mo id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.6" stretchy="false" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S3.E4X.3.2.2.m1.5.5.2.3" xref="S3.E4X.3.2.2.m1.5.5.3a.cmml">,</mo><mrow id="S3.E4X.3.2.2.m1.5.5.2.2" xref="S3.E4X.3.2.2.m1.5.5.2.2.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.2.2.4" xref="S3.E4X.3.2.2.m1.5.5.2.2.4.cmml">i</mi><mo id="S3.E4X.3.2.2.m1.5.5.2.2.3" xref="S3.E4X.3.2.2.m1.5.5.2.2.3.cmml">∈</mo><mrow id="S3.E4X.3.2.2.m1.5.5.2.2.2.2" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.3.cmml"><mo id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.3" stretchy="false" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.3.cmml">{</mo><mrow id="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.2" xref="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.2.cmml">r</mi><mo id="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.3" xref="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.3.cmml">L</mi></mrow><mo id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.4" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.3.cmml">,</mo><mrow id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.cmml"><mrow id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.3" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.3.cmml">r</mi><mo id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.2" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.cmml"><mo id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.2" stretchy="false" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.2.cmml">L</mi><mo id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.1.cmml">+</mo><mn id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.3" stretchy="false" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.2" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.2.cmml">−</mo><mn id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.3" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.3.cmml">1</mn></mrow><mo id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.5" stretchy="false" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.3.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.3.2.2.m1.5b"><apply id="S3.E4X.3.2.2.m1.5.5.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.5.5.3a.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E4X.3.2.2.m1.4.4.1.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1"><in id="S3.E4X.3.2.2.m1.4.4.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.2"></in><ci id="S3.E4X.3.2.2.m1.4.4.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.3">𝑟</ci><set id="S3.E4X.3.2.2.m1.4.4.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1"><cn id="S3.E4X.3.2.2.m1.1.1.cmml" type="integer" xref="S3.E4X.3.2.2.m1.1.1">0</cn><cn id="S3.E4X.3.2.2.m1.2.2.cmml" type="integer" xref="S3.E4X.3.2.2.m1.2.2">1</cn><ci id="S3.E4X.3.2.2.m1.3.3.cmml" xref="S3.E4X.3.2.2.m1.3.3">…</ci><apply id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1"><minus id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.1"></minus><ci id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.2">𝑠</ci><cn id="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.4.4.1.1.1.1.1.3">1</cn></apply></set></apply><apply id="S3.E4X.3.2.2.m1.5.5.2.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2"><in id="S3.E4X.3.2.2.m1.5.5.2.2.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.3"></in><ci id="S3.E4X.3.2.2.m1.5.5.2.2.4.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.4">𝑖</ci><set id="S3.E4X.3.2.2.m1.5.5.2.2.2.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2"><apply id="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1"><times id="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.1"></times><ci id="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.2">𝑟</ci><ci id="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.1.1.1.3">𝐿</ci></apply><apply id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2"><minus id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.2"></minus><apply id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1"><times id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.2"></times><ci id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.3">𝑟</ci><apply id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1"><plus id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.1"></plus><ci id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.2">𝐿</ci><cn id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.1.1.1.1.3">1</cn></apply></apply><cn id="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.3.cmml" type="integer" xref="S3.E4X.3.2.2.m1.5.5.2.2.2.2.2.3">1</cn></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.3.2.2.m1.5c">\displaystyle r\in\{0,1,\ldots,s-1\},i\in\{rL,r(L+1)-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.3.2.2.m1.5d">italic_r ∈ { 0 , 1 , … , italic_s - 1 } , italic_i ∈ { italic_r italic_L , italic_r ( italic_L + 1 ) - 1 }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{ and }j\text{ with }i-L+1\leq j\leq i." class="ltx_Math" display="inline" id="S3.E4Xa.2.1.1.m1.1"><semantics id="S3.E4Xa.2.1.1.m1.1a"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.cmml"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.cmml"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml"><mtext id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.2a.cmml">and </mtext><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">j</mi><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.1a" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mtext id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.4" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.4a.cmml"> with </mtext><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.1b" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.5" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.5.cmml">i</mi></mrow><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.1.cmml">−</mo><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.1.cmml">+</mo><mn id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.3.cmml">1</mn></mrow><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3.cmml">≤</mo><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.4" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.4.cmml">j</mi><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.5" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.5.cmml">≤</mo><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.6" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.6.cmml">i</mi></mrow><mo id="S3.E4Xa.2.1.1.m1.1.1.1.2" lspace="0em" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4Xa.2.1.1.m1.1b"><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1"><and id="S3.E4Xa.2.1.1.m1.1.1.1.1a.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1"></and><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1b.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1"><leq id="S3.E4Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3"></leq><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2"><plus id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.1"></plus><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2"><minus id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.1"></minus><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2"><times id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.1"></times><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.2a.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.2"><mtext id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.2">and </mtext></ci><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.3">𝑗</ci><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.4a.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.4"><mtext id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.4.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.4"> with </mtext></ci><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.5.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.2.5">𝑖</ci></apply><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.2.3">𝐿</ci></apply><cn id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.3">1</cn></apply><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.4.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.4">𝑗</ci></apply><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1c.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1"><leq id="S3.E4Xa.2.1.1.m1.1.1.1.1.5.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.E4Xa.2.1.1.m1.1.1.1.1.4.cmml" id="S3.E4Xa.2.1.1.m1.1.1.1.1d.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1"></share><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.6.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4Xa.2.1.1.m1.1c">\displaystyle\text{ and }j\text{ with }i-L+1\leq j\leq i.</annotation><annotation encoding="application/x-llamapun" id="S3.E4Xa.2.1.1.m1.1d">and italic_j with italic_i - italic_L + 1 ≤ italic_j ≤ italic_i .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.p7.9">Note that these dot products are exactly the ones not masked by <math alttext="M" class="ltx_Math" display="inline" id="S3.p7.6.m1.1"><semantics id="S3.p7.6.m1.1a"><mi id="S3.p7.6.m1.1.1" xref="S3.p7.6.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p7.6.m1.1b"><ci id="S3.p7.6.m1.1.1.cmml" xref="S3.p7.6.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.6.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p7.6.m1.1d">italic_M</annotation></semantics></math> in the definition of LAM. In our algorithm, we compute <math alttext="2L-1" class="ltx_Math" display="inline" id="S3.p7.7.m2.1"><semantics id="S3.p7.7.m2.1a"><mrow id="S3.p7.7.m2.1.1" xref="S3.p7.7.m2.1.1.cmml"><mrow id="S3.p7.7.m2.1.1.2" xref="S3.p7.7.m2.1.1.2.cmml"><mn id="S3.p7.7.m2.1.1.2.2" xref="S3.p7.7.m2.1.1.2.2.cmml">2</mn><mo id="S3.p7.7.m2.1.1.2.1" xref="S3.p7.7.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.p7.7.m2.1.1.2.3" xref="S3.p7.7.m2.1.1.2.3.cmml">L</mi></mrow><mo id="S3.p7.7.m2.1.1.1" xref="S3.p7.7.m2.1.1.1.cmml">−</mo><mn id="S3.p7.7.m2.1.1.3" xref="S3.p7.7.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.7.m2.1b"><apply id="S3.p7.7.m2.1.1.cmml" xref="S3.p7.7.m2.1.1"><minus id="S3.p7.7.m2.1.1.1.cmml" xref="S3.p7.7.m2.1.1.1"></minus><apply id="S3.p7.7.m2.1.1.2.cmml" xref="S3.p7.7.m2.1.1.2"><times id="S3.p7.7.m2.1.1.2.1.cmml" xref="S3.p7.7.m2.1.1.2.1"></times><cn id="S3.p7.7.m2.1.1.2.2.cmml" type="integer" xref="S3.p7.7.m2.1.1.2.2">2</cn><ci id="S3.p7.7.m2.1.1.2.3.cmml" xref="S3.p7.7.m2.1.1.2.3">𝐿</ci></apply><cn id="S3.p7.7.m2.1.1.3.cmml" type="integer" xref="S3.p7.7.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.7.m2.1c">2L-1</annotation><annotation encoding="application/x-llamapun" id="S3.p7.7.m2.1d">2 italic_L - 1</annotation></semantics></math> dot products for each row of <math alttext="Q" class="ltx_Math" display="inline" id="S3.p7.8.m3.1"><semantics id="S3.p7.8.m3.1a"><mi id="S3.p7.8.m3.1.1" xref="S3.p7.8.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.p7.8.m3.1b"><ci id="S3.p7.8.m3.1.1.cmml" xref="S3.p7.8.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.8.m3.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.p7.8.m3.1d">italic_Q</annotation></semantics></math> instead of the <math alttext="L" class="ltx_Math" display="inline" id="S3.p7.9.m4.1"><semantics id="S3.p7.9.m4.1a"><mi id="S3.p7.9.m4.1.1" xref="S3.p7.9.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p7.9.m4.1b"><ci id="S3.p7.9.m4.1.1.cmml" xref="S3.p7.9.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.9.m4.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.p7.9.m4.1d">italic_L</annotation></semantics></math> dot products described in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.E4" title="Equation 4 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4</span></a>). The extra number of dot products computed will allow us to write LAM in tensor algebra, without affecting the time and memory complexity. We formally introduce this “splitting” idea in Definition <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmdefinition2" title="Definition 2 (The tensor 𝑇_𝑄). ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdefinition2.2.1.1">Definition 2</span></span><span class="ltx_text ltx_font_bold" id="Thmdefinition2.3.2"> </span>(The tensor <math alttext="T_{Q}" class="ltx_Math" display="inline" id="Thmdefinition2.1.m1.1"><semantics id="Thmdefinition2.1.m1.1b"><msub id="Thmdefinition2.1.m1.1.1" xref="Thmdefinition2.1.m1.1.1.cmml"><mi id="Thmdefinition2.1.m1.1.1.2" xref="Thmdefinition2.1.m1.1.1.2.cmml">T</mi><mi id="Thmdefinition2.1.m1.1.1.3" xref="Thmdefinition2.1.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition2.1.m1.1c"><apply id="Thmdefinition2.1.m1.1.1.cmml" xref="Thmdefinition2.1.m1.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.1.m1.1.1.1.cmml" xref="Thmdefinition2.1.m1.1.1">subscript</csymbol><ci id="Thmdefinition2.1.m1.1.1.2.cmml" xref="Thmdefinition2.1.m1.1.1.2">𝑇</ci><ci id="Thmdefinition2.1.m1.1.1.3.cmml" xref="Thmdefinition2.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.1.m1.1d">T_{Q}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.1.m1.1e">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>)<span class="ltx_text ltx_font_bold" id="Thmdefinition2.4.3">.</span>
</h6>
<div class="ltx_para" id="Thmdefinition2.p1">
<p class="ltx_p" id="Thmdefinition2.p1.7"><span class="ltx_text ltx_font_italic" id="Thmdefinition2.p1.7.7">Let <math alttext="s=n/L" class="ltx_Math" display="inline" id="Thmdefinition2.p1.1.1.m1.1"><semantics id="Thmdefinition2.p1.1.1.m1.1a"><mrow id="Thmdefinition2.p1.1.1.m1.1.1" xref="Thmdefinition2.p1.1.1.m1.1.1.cmml"><mi id="Thmdefinition2.p1.1.1.m1.1.1.2" xref="Thmdefinition2.p1.1.1.m1.1.1.2.cmml">s</mi><mo id="Thmdefinition2.p1.1.1.m1.1.1.1" xref="Thmdefinition2.p1.1.1.m1.1.1.1.cmml">=</mo><mrow id="Thmdefinition2.p1.1.1.m1.1.1.3" xref="Thmdefinition2.p1.1.1.m1.1.1.3.cmml"><mi id="Thmdefinition2.p1.1.1.m1.1.1.3.2" xref="Thmdefinition2.p1.1.1.m1.1.1.3.2.cmml">n</mi><mo id="Thmdefinition2.p1.1.1.m1.1.1.3.1" xref="Thmdefinition2.p1.1.1.m1.1.1.3.1.cmml">/</mo><mi id="Thmdefinition2.p1.1.1.m1.1.1.3.3" xref="Thmdefinition2.p1.1.1.m1.1.1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.1.1.m1.1b"><apply id="Thmdefinition2.p1.1.1.m1.1.1.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1"><eq id="Thmdefinition2.p1.1.1.m1.1.1.1.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1.1"></eq><ci id="Thmdefinition2.p1.1.1.m1.1.1.2.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1.2">𝑠</ci><apply id="Thmdefinition2.p1.1.1.m1.1.1.3.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1.3"><divide id="Thmdefinition2.p1.1.1.m1.1.1.3.1.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1.3.1"></divide><ci id="Thmdefinition2.p1.1.1.m1.1.1.3.2.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1.3.2">𝑛</ci><ci id="Thmdefinition2.p1.1.1.m1.1.1.3.3.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.1.1.m1.1c">s=n/L</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.1.1.m1.1d">italic_s = italic_n / italic_L</annotation></semantics></math>. We define <math alttext="T_{Q}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.2.2.m2.1"><semantics id="Thmdefinition2.p1.2.2.m2.1a"><msub id="Thmdefinition2.p1.2.2.m2.1.1" xref="Thmdefinition2.p1.2.2.m2.1.1.cmml"><mi id="Thmdefinition2.p1.2.2.m2.1.1.2" xref="Thmdefinition2.p1.2.2.m2.1.1.2.cmml">T</mi><mi id="Thmdefinition2.p1.2.2.m2.1.1.3" xref="Thmdefinition2.p1.2.2.m2.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.2.2.m2.1b"><apply id="Thmdefinition2.p1.2.2.m2.1.1.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.2.2.m2.1.1.1.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1">subscript</csymbol><ci id="Thmdefinition2.p1.2.2.m2.1.1.2.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1.2">𝑇</ci><ci id="Thmdefinition2.p1.2.2.m2.1.1.3.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.2.2.m2.1c">T_{Q}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.2.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> as the tensor with dimension <math alttext="s\times L\times d_{q}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.3.3.m3.1"><semantics id="Thmdefinition2.p1.3.3.m3.1a"><mrow id="Thmdefinition2.p1.3.3.m3.1.1" xref="Thmdefinition2.p1.3.3.m3.1.1.cmml"><mi id="Thmdefinition2.p1.3.3.m3.1.1.2" xref="Thmdefinition2.p1.3.3.m3.1.1.2.cmml">s</mi><mo id="Thmdefinition2.p1.3.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="Thmdefinition2.p1.3.3.m3.1.1.1.cmml">×</mo><mi id="Thmdefinition2.p1.3.3.m3.1.1.3" xref="Thmdefinition2.p1.3.3.m3.1.1.3.cmml">L</mi><mo id="Thmdefinition2.p1.3.3.m3.1.1.1a" lspace="0.222em" rspace="0.222em" xref="Thmdefinition2.p1.3.3.m3.1.1.1.cmml">×</mo><msub id="Thmdefinition2.p1.3.3.m3.1.1.4" xref="Thmdefinition2.p1.3.3.m3.1.1.4.cmml"><mi id="Thmdefinition2.p1.3.3.m3.1.1.4.2" xref="Thmdefinition2.p1.3.3.m3.1.1.4.2.cmml">d</mi><mi id="Thmdefinition2.p1.3.3.m3.1.1.4.3" xref="Thmdefinition2.p1.3.3.m3.1.1.4.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.3.3.m3.1b"><apply id="Thmdefinition2.p1.3.3.m3.1.1.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1"><times id="Thmdefinition2.p1.3.3.m3.1.1.1.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1.1"></times><ci id="Thmdefinition2.p1.3.3.m3.1.1.2.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1.2">𝑠</ci><ci id="Thmdefinition2.p1.3.3.m3.1.1.3.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1.3">𝐿</ci><apply id="Thmdefinition2.p1.3.3.m3.1.1.4.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1.4"><csymbol cd="ambiguous" id="Thmdefinition2.p1.3.3.m3.1.1.4.1.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1.4">subscript</csymbol><ci id="Thmdefinition2.p1.3.3.m3.1.1.4.2.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1.4.2">𝑑</ci><ci id="Thmdefinition2.p1.3.3.m3.1.1.4.3.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1.4.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.3.3.m3.1c">s\times L\times d_{q}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.3.3.m3.1d">italic_s × italic_L × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="T_{Q}[r,i_{1},t]=Q[rL+i_{1},t]" class="ltx_Math" display="inline" id="Thmdefinition2.p1.4.4.m4.5"><semantics id="Thmdefinition2.p1.4.4.m4.5a"><mrow id="Thmdefinition2.p1.4.4.m4.5.5" xref="Thmdefinition2.p1.4.4.m4.5.5.cmml"><mrow id="Thmdefinition2.p1.4.4.m4.4.4.1" xref="Thmdefinition2.p1.4.4.m4.4.4.1.cmml"><msub id="Thmdefinition2.p1.4.4.m4.4.4.1.3" xref="Thmdefinition2.p1.4.4.m4.4.4.1.3.cmml"><mi id="Thmdefinition2.p1.4.4.m4.4.4.1.3.2" xref="Thmdefinition2.p1.4.4.m4.4.4.1.3.2.cmml">T</mi><mi id="Thmdefinition2.p1.4.4.m4.4.4.1.3.3" xref="Thmdefinition2.p1.4.4.m4.4.4.1.3.3.cmml">Q</mi></msub><mo id="Thmdefinition2.p1.4.4.m4.4.4.1.2" xref="Thmdefinition2.p1.4.4.m4.4.4.1.2.cmml">⁢</mo><mrow id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.2.cmml"><mo id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.2" stretchy="false" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.2.cmml">[</mo><mi id="Thmdefinition2.p1.4.4.m4.1.1" xref="Thmdefinition2.p1.4.4.m4.1.1.cmml">r</mi><mo id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.3" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.2.cmml">,</mo><msub id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.cmml"><mi id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.2" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.2.cmml">i</mi><mn id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.3" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.4" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.2.cmml">,</mo><mi id="Thmdefinition2.p1.4.4.m4.2.2" xref="Thmdefinition2.p1.4.4.m4.2.2.cmml">t</mi><mo id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.5" stretchy="false" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.2.cmml">]</mo></mrow></mrow><mo id="Thmdefinition2.p1.4.4.m4.5.5.3" xref="Thmdefinition2.p1.4.4.m4.5.5.3.cmml">=</mo><mrow id="Thmdefinition2.p1.4.4.m4.5.5.2" xref="Thmdefinition2.p1.4.4.m4.5.5.2.cmml"><mi id="Thmdefinition2.p1.4.4.m4.5.5.2.3" xref="Thmdefinition2.p1.4.4.m4.5.5.2.3.cmml">Q</mi><mo id="Thmdefinition2.p1.4.4.m4.5.5.2.2" xref="Thmdefinition2.p1.4.4.m4.5.5.2.2.cmml">⁢</mo><mrow id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.2.cmml"><mo id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.2" stretchy="false" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.2.cmml">[</mo><mrow id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.cmml"><mrow id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.cmml"><mi id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.2" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.2.cmml">r</mi><mo id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.1" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.1.cmml">⁢</mo><mi id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.3" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.3.cmml">L</mi></mrow><mo id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.1" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.1.cmml">+</mo><msub id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.cmml"><mi id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.2" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.2.cmml">i</mi><mn id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.3" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.3" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.2.cmml">,</mo><mi id="Thmdefinition2.p1.4.4.m4.3.3" xref="Thmdefinition2.p1.4.4.m4.3.3.cmml">t</mi><mo id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.4" stretchy="false" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.4.4.m4.5b"><apply id="Thmdefinition2.p1.4.4.m4.5.5.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5"><eq id="Thmdefinition2.p1.4.4.m4.5.5.3.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.3"></eq><apply id="Thmdefinition2.p1.4.4.m4.4.4.1.cmml" xref="Thmdefinition2.p1.4.4.m4.4.4.1"><times id="Thmdefinition2.p1.4.4.m4.4.4.1.2.cmml" xref="Thmdefinition2.p1.4.4.m4.4.4.1.2"></times><apply id="Thmdefinition2.p1.4.4.m4.4.4.1.3.cmml" xref="Thmdefinition2.p1.4.4.m4.4.4.1.3"><csymbol cd="ambiguous" id="Thmdefinition2.p1.4.4.m4.4.4.1.3.1.cmml" xref="Thmdefinition2.p1.4.4.m4.4.4.1.3">subscript</csymbol><ci id="Thmdefinition2.p1.4.4.m4.4.4.1.3.2.cmml" xref="Thmdefinition2.p1.4.4.m4.4.4.1.3.2">𝑇</ci><ci id="Thmdefinition2.p1.4.4.m4.4.4.1.3.3.cmml" xref="Thmdefinition2.p1.4.4.m4.4.4.1.3.3">𝑄</ci></apply><list id="Thmdefinition2.p1.4.4.m4.4.4.1.1.2.cmml" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.1"><ci id="Thmdefinition2.p1.4.4.m4.1.1.cmml" xref="Thmdefinition2.p1.4.4.m4.1.1">𝑟</ci><apply id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.cmml" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.1.cmml" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1">subscript</csymbol><ci id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.2.cmml" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.2">𝑖</ci><cn id="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition2.p1.4.4.m4.4.4.1.1.1.1.3">1</cn></apply><ci id="Thmdefinition2.p1.4.4.m4.2.2.cmml" xref="Thmdefinition2.p1.4.4.m4.2.2">𝑡</ci></list></apply><apply id="Thmdefinition2.p1.4.4.m4.5.5.2.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2"><times id="Thmdefinition2.p1.4.4.m4.5.5.2.2.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.2"></times><ci id="Thmdefinition2.p1.4.4.m4.5.5.2.3.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.3">𝑄</ci><interval closure="closed" id="Thmdefinition2.p1.4.4.m4.5.5.2.1.2.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1"><apply id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1"><plus id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.1.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.1"></plus><apply id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2"><times id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.1.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.1"></times><ci id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.2.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.2">𝑟</ci><ci id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.3.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.2.3">𝐿</ci></apply><apply id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3"><csymbol cd="ambiguous" id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.1.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3">subscript</csymbol><ci id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.2.cmml" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.2">𝑖</ci><cn id="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.3.cmml" type="integer" xref="Thmdefinition2.p1.4.4.m4.5.5.2.1.1.1.3.3">1</cn></apply></apply><ci id="Thmdefinition2.p1.4.4.m4.3.3.cmml" xref="Thmdefinition2.p1.4.4.m4.3.3">𝑡</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.4.4.m4.5c">T_{Q}[r,i_{1},t]=Q[rL+i_{1},t]</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.4.4.m4.5d">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ] = italic_Q [ italic_r italic_L + italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ]</annotation></semantics></math> for all <math alttext="r\in\{0,1,\ldots,s-1\}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.5.5.m5.4"><semantics id="Thmdefinition2.p1.5.5.m5.4a"><mrow id="Thmdefinition2.p1.5.5.m5.4.4" xref="Thmdefinition2.p1.5.5.m5.4.4.cmml"><mi id="Thmdefinition2.p1.5.5.m5.4.4.3" xref="Thmdefinition2.p1.5.5.m5.4.4.3.cmml">r</mi><mo id="Thmdefinition2.p1.5.5.m5.4.4.2" xref="Thmdefinition2.p1.5.5.m5.4.4.2.cmml">∈</mo><mrow id="Thmdefinition2.p1.5.5.m5.4.4.1.1" xref="Thmdefinition2.p1.5.5.m5.4.4.1.2.cmml"><mo id="Thmdefinition2.p1.5.5.m5.4.4.1.1.2" stretchy="false" xref="Thmdefinition2.p1.5.5.m5.4.4.1.2.cmml">{</mo><mn id="Thmdefinition2.p1.5.5.m5.1.1" xref="Thmdefinition2.p1.5.5.m5.1.1.cmml">0</mn><mo id="Thmdefinition2.p1.5.5.m5.4.4.1.1.3" xref="Thmdefinition2.p1.5.5.m5.4.4.1.2.cmml">,</mo><mn id="Thmdefinition2.p1.5.5.m5.2.2" xref="Thmdefinition2.p1.5.5.m5.2.2.cmml">1</mn><mo id="Thmdefinition2.p1.5.5.m5.4.4.1.1.4" xref="Thmdefinition2.p1.5.5.m5.4.4.1.2.cmml">,</mo><mi id="Thmdefinition2.p1.5.5.m5.3.3" mathvariant="normal" xref="Thmdefinition2.p1.5.5.m5.3.3.cmml">…</mi><mo id="Thmdefinition2.p1.5.5.m5.4.4.1.1.5" xref="Thmdefinition2.p1.5.5.m5.4.4.1.2.cmml">,</mo><mrow id="Thmdefinition2.p1.5.5.m5.4.4.1.1.1" xref="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.cmml"><mi id="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.2" xref="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.2.cmml">s</mi><mo id="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.1" xref="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.1.cmml">−</mo><mn id="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.3" xref="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition2.p1.5.5.m5.4.4.1.1.6" stretchy="false" xref="Thmdefinition2.p1.5.5.m5.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.5.5.m5.4b"><apply id="Thmdefinition2.p1.5.5.m5.4.4.cmml" xref="Thmdefinition2.p1.5.5.m5.4.4"><in id="Thmdefinition2.p1.5.5.m5.4.4.2.cmml" xref="Thmdefinition2.p1.5.5.m5.4.4.2"></in><ci id="Thmdefinition2.p1.5.5.m5.4.4.3.cmml" xref="Thmdefinition2.p1.5.5.m5.4.4.3">𝑟</ci><set id="Thmdefinition2.p1.5.5.m5.4.4.1.2.cmml" xref="Thmdefinition2.p1.5.5.m5.4.4.1.1"><cn id="Thmdefinition2.p1.5.5.m5.1.1.cmml" type="integer" xref="Thmdefinition2.p1.5.5.m5.1.1">0</cn><cn id="Thmdefinition2.p1.5.5.m5.2.2.cmml" type="integer" xref="Thmdefinition2.p1.5.5.m5.2.2">1</cn><ci id="Thmdefinition2.p1.5.5.m5.3.3.cmml" xref="Thmdefinition2.p1.5.5.m5.3.3">…</ci><apply id="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.cmml" xref="Thmdefinition2.p1.5.5.m5.4.4.1.1.1"><minus id="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.1.cmml" xref="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.1"></minus><ci id="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.2.cmml" xref="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.2">𝑠</ci><cn id="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.3.cmml" type="integer" xref="Thmdefinition2.p1.5.5.m5.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.5.5.m5.4c">r\in\{0,1,\ldots,s-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.5.5.m5.4d">italic_r ∈ { 0 , 1 , … , italic_s - 1 }</annotation></semantics></math>, <math alttext="i_{1}\in\{0,1,\ldots,L-1\}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.6.6.m6.4"><semantics id="Thmdefinition2.p1.6.6.m6.4a"><mrow id="Thmdefinition2.p1.6.6.m6.4.4" xref="Thmdefinition2.p1.6.6.m6.4.4.cmml"><msub id="Thmdefinition2.p1.6.6.m6.4.4.3" xref="Thmdefinition2.p1.6.6.m6.4.4.3.cmml"><mi id="Thmdefinition2.p1.6.6.m6.4.4.3.2" xref="Thmdefinition2.p1.6.6.m6.4.4.3.2.cmml">i</mi><mn id="Thmdefinition2.p1.6.6.m6.4.4.3.3" xref="Thmdefinition2.p1.6.6.m6.4.4.3.3.cmml">1</mn></msub><mo id="Thmdefinition2.p1.6.6.m6.4.4.2" xref="Thmdefinition2.p1.6.6.m6.4.4.2.cmml">∈</mo><mrow id="Thmdefinition2.p1.6.6.m6.4.4.1.1" xref="Thmdefinition2.p1.6.6.m6.4.4.1.2.cmml"><mo id="Thmdefinition2.p1.6.6.m6.4.4.1.1.2" stretchy="false" xref="Thmdefinition2.p1.6.6.m6.4.4.1.2.cmml">{</mo><mn id="Thmdefinition2.p1.6.6.m6.1.1" xref="Thmdefinition2.p1.6.6.m6.1.1.cmml">0</mn><mo id="Thmdefinition2.p1.6.6.m6.4.4.1.1.3" xref="Thmdefinition2.p1.6.6.m6.4.4.1.2.cmml">,</mo><mn id="Thmdefinition2.p1.6.6.m6.2.2" xref="Thmdefinition2.p1.6.6.m6.2.2.cmml">1</mn><mo id="Thmdefinition2.p1.6.6.m6.4.4.1.1.4" xref="Thmdefinition2.p1.6.6.m6.4.4.1.2.cmml">,</mo><mi id="Thmdefinition2.p1.6.6.m6.3.3" mathvariant="normal" xref="Thmdefinition2.p1.6.6.m6.3.3.cmml">…</mi><mo id="Thmdefinition2.p1.6.6.m6.4.4.1.1.5" xref="Thmdefinition2.p1.6.6.m6.4.4.1.2.cmml">,</mo><mrow id="Thmdefinition2.p1.6.6.m6.4.4.1.1.1" xref="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.cmml"><mi id="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.2" xref="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.2.cmml">L</mi><mo id="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.1" xref="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.1.cmml">−</mo><mn id="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.3" xref="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition2.p1.6.6.m6.4.4.1.1.6" stretchy="false" xref="Thmdefinition2.p1.6.6.m6.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.6.6.m6.4b"><apply id="Thmdefinition2.p1.6.6.m6.4.4.cmml" xref="Thmdefinition2.p1.6.6.m6.4.4"><in id="Thmdefinition2.p1.6.6.m6.4.4.2.cmml" xref="Thmdefinition2.p1.6.6.m6.4.4.2"></in><apply id="Thmdefinition2.p1.6.6.m6.4.4.3.cmml" xref="Thmdefinition2.p1.6.6.m6.4.4.3"><csymbol cd="ambiguous" id="Thmdefinition2.p1.6.6.m6.4.4.3.1.cmml" xref="Thmdefinition2.p1.6.6.m6.4.4.3">subscript</csymbol><ci id="Thmdefinition2.p1.6.6.m6.4.4.3.2.cmml" xref="Thmdefinition2.p1.6.6.m6.4.4.3.2">𝑖</ci><cn id="Thmdefinition2.p1.6.6.m6.4.4.3.3.cmml" type="integer" xref="Thmdefinition2.p1.6.6.m6.4.4.3.3">1</cn></apply><set id="Thmdefinition2.p1.6.6.m6.4.4.1.2.cmml" xref="Thmdefinition2.p1.6.6.m6.4.4.1.1"><cn id="Thmdefinition2.p1.6.6.m6.1.1.cmml" type="integer" xref="Thmdefinition2.p1.6.6.m6.1.1">0</cn><cn id="Thmdefinition2.p1.6.6.m6.2.2.cmml" type="integer" xref="Thmdefinition2.p1.6.6.m6.2.2">1</cn><ci id="Thmdefinition2.p1.6.6.m6.3.3.cmml" xref="Thmdefinition2.p1.6.6.m6.3.3">…</ci><apply id="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.cmml" xref="Thmdefinition2.p1.6.6.m6.4.4.1.1.1"><minus id="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.1.cmml" xref="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.1"></minus><ci id="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.2.cmml" xref="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.2">𝐿</ci><cn id="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.3.cmml" type="integer" xref="Thmdefinition2.p1.6.6.m6.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.6.6.m6.4c">i_{1}\in\{0,1,\ldots,L-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.6.6.m6.4d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , italic_L - 1 }</annotation></semantics></math> and <math alttext="t\in\{0,1,\ldots,d_{q}-1\}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.7.7.m7.4"><semantics id="Thmdefinition2.p1.7.7.m7.4a"><mrow id="Thmdefinition2.p1.7.7.m7.4.4" xref="Thmdefinition2.p1.7.7.m7.4.4.cmml"><mi id="Thmdefinition2.p1.7.7.m7.4.4.3" xref="Thmdefinition2.p1.7.7.m7.4.4.3.cmml">t</mi><mo id="Thmdefinition2.p1.7.7.m7.4.4.2" xref="Thmdefinition2.p1.7.7.m7.4.4.2.cmml">∈</mo><mrow id="Thmdefinition2.p1.7.7.m7.4.4.1.1" xref="Thmdefinition2.p1.7.7.m7.4.4.1.2.cmml"><mo id="Thmdefinition2.p1.7.7.m7.4.4.1.1.2" stretchy="false" xref="Thmdefinition2.p1.7.7.m7.4.4.1.2.cmml">{</mo><mn id="Thmdefinition2.p1.7.7.m7.1.1" xref="Thmdefinition2.p1.7.7.m7.1.1.cmml">0</mn><mo id="Thmdefinition2.p1.7.7.m7.4.4.1.1.3" xref="Thmdefinition2.p1.7.7.m7.4.4.1.2.cmml">,</mo><mn id="Thmdefinition2.p1.7.7.m7.2.2" xref="Thmdefinition2.p1.7.7.m7.2.2.cmml">1</mn><mo id="Thmdefinition2.p1.7.7.m7.4.4.1.1.4" xref="Thmdefinition2.p1.7.7.m7.4.4.1.2.cmml">,</mo><mi id="Thmdefinition2.p1.7.7.m7.3.3" mathvariant="normal" xref="Thmdefinition2.p1.7.7.m7.3.3.cmml">…</mi><mo id="Thmdefinition2.p1.7.7.m7.4.4.1.1.5" xref="Thmdefinition2.p1.7.7.m7.4.4.1.2.cmml">,</mo><mrow id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.cmml"><msub id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.cmml"><mi id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.2" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.2.cmml">d</mi><mi id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.3" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.3.cmml">q</mi></msub><mo id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.1" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.1.cmml">−</mo><mn id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.3" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition2.p1.7.7.m7.4.4.1.1.6" stretchy="false" xref="Thmdefinition2.p1.7.7.m7.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.7.7.m7.4b"><apply id="Thmdefinition2.p1.7.7.m7.4.4.cmml" xref="Thmdefinition2.p1.7.7.m7.4.4"><in id="Thmdefinition2.p1.7.7.m7.4.4.2.cmml" xref="Thmdefinition2.p1.7.7.m7.4.4.2"></in><ci id="Thmdefinition2.p1.7.7.m7.4.4.3.cmml" xref="Thmdefinition2.p1.7.7.m7.4.4.3">𝑡</ci><set id="Thmdefinition2.p1.7.7.m7.4.4.1.2.cmml" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1"><cn id="Thmdefinition2.p1.7.7.m7.1.1.cmml" type="integer" xref="Thmdefinition2.p1.7.7.m7.1.1">0</cn><cn id="Thmdefinition2.p1.7.7.m7.2.2.cmml" type="integer" xref="Thmdefinition2.p1.7.7.m7.2.2">1</cn><ci id="Thmdefinition2.p1.7.7.m7.3.3.cmml" xref="Thmdefinition2.p1.7.7.m7.3.3">…</ci><apply id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.cmml" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1"><minus id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.1.cmml" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.1"></minus><apply id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.cmml" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2"><csymbol cd="ambiguous" id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.1.cmml" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2">subscript</csymbol><ci id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.2.cmml" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.2">𝑑</ci><ci id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.3.cmml" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.2.3">𝑞</ci></apply><cn id="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.3.cmml" type="integer" xref="Thmdefinition2.p1.7.7.m7.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.7.7.m7.4c">t\in\{0,1,\ldots,d_{q}-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.7.7.m7.4d">italic_t ∈ { 0 , 1 , … , italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT - 1 }</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para" id="S3.p8">
<p class="ltx_p" id="S3.p8.2">Let <math alttext="r\in\{0,1,\ldots,s-1\}" class="ltx_Math" display="inline" id="S3.p8.1.m1.4"><semantics id="S3.p8.1.m1.4a"><mrow id="S3.p8.1.m1.4.4" xref="S3.p8.1.m1.4.4.cmml"><mi id="S3.p8.1.m1.4.4.3" xref="S3.p8.1.m1.4.4.3.cmml">r</mi><mo id="S3.p8.1.m1.4.4.2" xref="S3.p8.1.m1.4.4.2.cmml">∈</mo><mrow id="S3.p8.1.m1.4.4.1.1" xref="S3.p8.1.m1.4.4.1.2.cmml"><mo id="S3.p8.1.m1.4.4.1.1.2" stretchy="false" xref="S3.p8.1.m1.4.4.1.2.cmml">{</mo><mn id="S3.p8.1.m1.1.1" xref="S3.p8.1.m1.1.1.cmml">0</mn><mo id="S3.p8.1.m1.4.4.1.1.3" xref="S3.p8.1.m1.4.4.1.2.cmml">,</mo><mn id="S3.p8.1.m1.2.2" xref="S3.p8.1.m1.2.2.cmml">1</mn><mo id="S3.p8.1.m1.4.4.1.1.4" xref="S3.p8.1.m1.4.4.1.2.cmml">,</mo><mi id="S3.p8.1.m1.3.3" mathvariant="normal" xref="S3.p8.1.m1.3.3.cmml">…</mi><mo id="S3.p8.1.m1.4.4.1.1.5" xref="S3.p8.1.m1.4.4.1.2.cmml">,</mo><mrow id="S3.p8.1.m1.4.4.1.1.1" xref="S3.p8.1.m1.4.4.1.1.1.cmml"><mi id="S3.p8.1.m1.4.4.1.1.1.2" xref="S3.p8.1.m1.4.4.1.1.1.2.cmml">s</mi><mo id="S3.p8.1.m1.4.4.1.1.1.1" xref="S3.p8.1.m1.4.4.1.1.1.1.cmml">−</mo><mn id="S3.p8.1.m1.4.4.1.1.1.3" xref="S3.p8.1.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p8.1.m1.4.4.1.1.6" stretchy="false" xref="S3.p8.1.m1.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.1.m1.4b"><apply id="S3.p8.1.m1.4.4.cmml" xref="S3.p8.1.m1.4.4"><in id="S3.p8.1.m1.4.4.2.cmml" xref="S3.p8.1.m1.4.4.2"></in><ci id="S3.p8.1.m1.4.4.3.cmml" xref="S3.p8.1.m1.4.4.3">𝑟</ci><set id="S3.p8.1.m1.4.4.1.2.cmml" xref="S3.p8.1.m1.4.4.1.1"><cn id="S3.p8.1.m1.1.1.cmml" type="integer" xref="S3.p8.1.m1.1.1">0</cn><cn id="S3.p8.1.m1.2.2.cmml" type="integer" xref="S3.p8.1.m1.2.2">1</cn><ci id="S3.p8.1.m1.3.3.cmml" xref="S3.p8.1.m1.3.3">…</ci><apply id="S3.p8.1.m1.4.4.1.1.1.cmml" xref="S3.p8.1.m1.4.4.1.1.1"><minus id="S3.p8.1.m1.4.4.1.1.1.1.cmml" xref="S3.p8.1.m1.4.4.1.1.1.1"></minus><ci id="S3.p8.1.m1.4.4.1.1.1.2.cmml" xref="S3.p8.1.m1.4.4.1.1.1.2">𝑠</ci><cn id="S3.p8.1.m1.4.4.1.1.1.3.cmml" type="integer" xref="S3.p8.1.m1.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.1.m1.4c">r\in\{0,1,\ldots,s-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.1.m1.4d">italic_r ∈ { 0 , 1 , … , italic_s - 1 }</annotation></semantics></math> be the index of the block of <math alttext="Q" class="ltx_Math" display="inline" id="S3.p8.2.m2.1"><semantics id="S3.p8.2.m2.1a"><mi id="S3.p8.2.m2.1.1" xref="S3.p8.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.p8.2.m2.1b"><ci id="S3.p8.2.m2.1.1.cmml" xref="S3.p8.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.p8.2.m2.1d">italic_Q</annotation></semantics></math> under consideration. We claim that it suffices to compute the dot products</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.Ex6">
<tbody id="S3.Ex6X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\langle Q_{rL+i_{1}},K_{j}\rangle=\langle T_{Q}[r,i_{1},\cdot],K_%
{j}\rangle" class="ltx_Math" display="inline" id="S3.Ex6X.2.1.1.m1.6"><semantics id="S3.Ex6X.2.1.1.m1.6a"><mrow id="S3.Ex6X.2.1.1.m1.6.6" xref="S3.Ex6X.2.1.1.m1.6.6.cmml"><mrow id="S3.Ex6X.2.1.1.m1.4.4.2.2" xref="S3.Ex6X.2.1.1.m1.4.4.2.3.cmml"><mo id="S3.Ex6X.2.1.1.m1.4.4.2.2.3" stretchy="false" xref="S3.Ex6X.2.1.1.m1.4.4.2.3.cmml">⟨</mo><msub id="S3.Ex6X.2.1.1.m1.3.3.1.1.1" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.2" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.2.cmml">Q</mi><mrow id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.cmml"><mrow id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.cmml"><mi id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.2" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.2.cmml">r</mi><mo id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.1" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.3" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.3.cmml">L</mi></mrow><mo id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.1" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.1.cmml">+</mo><msub id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.cmml"><mi id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.2" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.2.cmml">i</mi><mn id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.3" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.3.cmml">1</mn></msub></mrow></msub><mo id="S3.Ex6X.2.1.1.m1.4.4.2.2.4" xref="S3.Ex6X.2.1.1.m1.4.4.2.3.cmml">,</mo><msub id="S3.Ex6X.2.1.1.m1.4.4.2.2.2" xref="S3.Ex6X.2.1.1.m1.4.4.2.2.2.cmml"><mi id="S3.Ex6X.2.1.1.m1.4.4.2.2.2.2" xref="S3.Ex6X.2.1.1.m1.4.4.2.2.2.2.cmml">K</mi><mi id="S3.Ex6X.2.1.1.m1.4.4.2.2.2.3" xref="S3.Ex6X.2.1.1.m1.4.4.2.2.2.3.cmml">j</mi></msub><mo id="S3.Ex6X.2.1.1.m1.4.4.2.2.5" stretchy="false" xref="S3.Ex6X.2.1.1.m1.4.4.2.3.cmml">⟩</mo></mrow><mo id="S3.Ex6X.2.1.1.m1.6.6.5" xref="S3.Ex6X.2.1.1.m1.6.6.5.cmml">=</mo><mrow id="S3.Ex6X.2.1.1.m1.6.6.4.2" xref="S3.Ex6X.2.1.1.m1.6.6.4.3.cmml"><mo id="S3.Ex6X.2.1.1.m1.6.6.4.2.3" stretchy="false" xref="S3.Ex6X.2.1.1.m1.6.6.4.3.cmml">⟨</mo><mrow id="S3.Ex6X.2.1.1.m1.5.5.3.1.1" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.cmml"><msub id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.cmml"><mi id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.2" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.2.cmml">T</mi><mi id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.3" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.3.cmml">Q</mi></msub><mo id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.2" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.2.cmml">⁢</mo><mrow id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.2.cmml"><mo id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.2" stretchy="false" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.2.cmml">[</mo><mi id="S3.Ex6X.2.1.1.m1.1.1" xref="S3.Ex6X.2.1.1.m1.1.1.cmml">r</mi><mo id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.3" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.2.cmml">,</mo><msub id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.cmml"><mi id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.2" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.2.cmml">i</mi><mn id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.3" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.4" rspace="0em" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.2.cmml">,</mo><mo id="S3.Ex6X.2.1.1.m1.2.2" lspace="0em" rspace="0em" xref="S3.Ex6X.2.1.1.m1.2.2.cmml">⋅</mo><mo id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.5" stretchy="false" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.2.cmml">]</mo></mrow></mrow><mo id="S3.Ex6X.2.1.1.m1.6.6.4.2.4" xref="S3.Ex6X.2.1.1.m1.6.6.4.3.cmml">,</mo><msub id="S3.Ex6X.2.1.1.m1.6.6.4.2.2" xref="S3.Ex6X.2.1.1.m1.6.6.4.2.2.cmml"><mi id="S3.Ex6X.2.1.1.m1.6.6.4.2.2.2" xref="S3.Ex6X.2.1.1.m1.6.6.4.2.2.2.cmml">K</mi><mi id="S3.Ex6X.2.1.1.m1.6.6.4.2.2.3" xref="S3.Ex6X.2.1.1.m1.6.6.4.2.2.3.cmml">j</mi></msub><mo id="S3.Ex6X.2.1.1.m1.6.6.4.2.5" stretchy="false" xref="S3.Ex6X.2.1.1.m1.6.6.4.3.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6X.2.1.1.m1.6b"><apply id="S3.Ex6X.2.1.1.m1.6.6.cmml" xref="S3.Ex6X.2.1.1.m1.6.6"><eq id="S3.Ex6X.2.1.1.m1.6.6.5.cmml" xref="S3.Ex6X.2.1.1.m1.6.6.5"></eq><list id="S3.Ex6X.2.1.1.m1.4.4.2.3.cmml" xref="S3.Ex6X.2.1.1.m1.4.4.2.2"><apply id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.2">𝑄</ci><apply id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3"><plus id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.1"></plus><apply id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2"><times id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.1.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.1"></times><ci id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.2.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.2">𝑟</ci><ci id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.3.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.2.3">𝐿</ci></apply><apply id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.1.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.2.cmml" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.2">𝑖</ci><cn id="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.3.cmml" type="integer" xref="S3.Ex6X.2.1.1.m1.3.3.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex6X.2.1.1.m1.4.4.2.2.2.cmml" xref="S3.Ex6X.2.1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.Ex6X.2.1.1.m1.4.4.2.2.2.1.cmml" xref="S3.Ex6X.2.1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.Ex6X.2.1.1.m1.4.4.2.2.2.2.cmml" xref="S3.Ex6X.2.1.1.m1.4.4.2.2.2.2">𝐾</ci><ci id="S3.Ex6X.2.1.1.m1.4.4.2.2.2.3.cmml" xref="S3.Ex6X.2.1.1.m1.4.4.2.2.2.3">𝑗</ci></apply></list><list id="S3.Ex6X.2.1.1.m1.6.6.4.3.cmml" xref="S3.Ex6X.2.1.1.m1.6.6.4.2"><apply id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.cmml" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1"><times id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.2.cmml" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.2"></times><apply id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.cmml" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.1.cmml" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3">subscript</csymbol><ci id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.2.cmml" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.2">𝑇</ci><ci id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.3.cmml" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.3.3">𝑄</ci></apply><list id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.2.cmml" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1"><ci id="S3.Ex6X.2.1.1.m1.1.1.cmml" xref="S3.Ex6X.2.1.1.m1.1.1">𝑟</ci><apply id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.cmml" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.1.cmml" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.2.cmml" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.2">𝑖</ci><cn id="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex6X.2.1.1.m1.5.5.3.1.1.1.1.1.3">1</cn></apply><ci id="S3.Ex6X.2.1.1.m1.2.2.cmml" xref="S3.Ex6X.2.1.1.m1.2.2">⋅</ci></list></apply><apply id="S3.Ex6X.2.1.1.m1.6.6.4.2.2.cmml" xref="S3.Ex6X.2.1.1.m1.6.6.4.2.2"><csymbol cd="ambiguous" id="S3.Ex6X.2.1.1.m1.6.6.4.2.2.1.cmml" xref="S3.Ex6X.2.1.1.m1.6.6.4.2.2">subscript</csymbol><ci id="S3.Ex6X.2.1.1.m1.6.6.4.2.2.2.cmml" xref="S3.Ex6X.2.1.1.m1.6.6.4.2.2.2">𝐾</ci><ci id="S3.Ex6X.2.1.1.m1.6.6.4.2.2.3.cmml" xref="S3.Ex6X.2.1.1.m1.6.6.4.2.2.3">𝑗</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6X.2.1.1.m1.6c">\displaystyle\langle Q_{rL+i_{1}},K_{j}\rangle=\langle T_{Q}[r,i_{1},\cdot],K_%
{j}\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6X.2.1.1.m1.6d">⟨ italic_Q start_POSTSUBSCRIPT italic_r italic_L + italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ = ⟨ italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋅ ] , italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{ for all }r\in\{0,1,\ldots,s-1\}," class="ltx_Math" display="inline" id="S3.Ex6X.3.2.2.m1.4"><semantics id="S3.Ex6X.3.2.2.m1.4a"><mrow id="S3.Ex6X.3.2.2.m1.4.4.1" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.cmml"><mrow id="S3.Ex6X.3.2.2.m1.4.4.1.1" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.cmml"><mrow id="S3.Ex6X.3.2.2.m1.4.4.1.1.3" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.3.cmml"><mtext id="S3.Ex6X.3.2.2.m1.4.4.1.1.3.2" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.3.2a.cmml">for all </mtext><mo id="S3.Ex6X.3.2.2.m1.4.4.1.1.3.1" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex6X.3.2.2.m1.4.4.1.1.3.3" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.3.3.cmml">r</mi></mrow><mo id="S3.Ex6X.3.2.2.m1.4.4.1.1.2" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.2.cmml">∈</mo><mrow id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.2.cmml"><mo id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.2" stretchy="false" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.2.cmml">{</mo><mn id="S3.Ex6X.3.2.2.m1.1.1" xref="S3.Ex6X.3.2.2.m1.1.1.cmml">0</mn><mo id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.3" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.2.cmml">,</mo><mn id="S3.Ex6X.3.2.2.m1.2.2" xref="S3.Ex6X.3.2.2.m1.2.2.cmml">1</mn><mo id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.4" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.2.cmml">,</mo><mi id="S3.Ex6X.3.2.2.m1.3.3" mathvariant="normal" xref="S3.Ex6X.3.2.2.m1.3.3.cmml">…</mi><mo id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.5" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.2.cmml">,</mo><mrow id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.2" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.2.cmml">s</mi><mo id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.1" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml">−</mo><mn id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.3" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.6" stretchy="false" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S3.Ex6X.3.2.2.m1.4.4.1.2" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6X.3.2.2.m1.4b"><apply id="S3.Ex6X.3.2.2.m1.4.4.1.1.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1"><in id="S3.Ex6X.3.2.2.m1.4.4.1.1.2.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.2"></in><apply id="S3.Ex6X.3.2.2.m1.4.4.1.1.3.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.3"><times id="S3.Ex6X.3.2.2.m1.4.4.1.1.3.1.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.3.1"></times><ci id="S3.Ex6X.3.2.2.m1.4.4.1.1.3.2a.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.3.2"><mtext id="S3.Ex6X.3.2.2.m1.4.4.1.1.3.2.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.3.2">for all </mtext></ci><ci id="S3.Ex6X.3.2.2.m1.4.4.1.1.3.3.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.3.3">𝑟</ci></apply><set id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.2.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1"><cn id="S3.Ex6X.3.2.2.m1.1.1.cmml" type="integer" xref="S3.Ex6X.3.2.2.m1.1.1">0</cn><cn id="S3.Ex6X.3.2.2.m1.2.2.cmml" type="integer" xref="S3.Ex6X.3.2.2.m1.2.2">1</cn><ci id="S3.Ex6X.3.2.2.m1.3.3.cmml" xref="S3.Ex6X.3.2.2.m1.3.3">…</ci><apply id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1"><minus id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.1"></minus><ci id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.2">𝑠</ci><cn id="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex6X.3.2.2.m1.4.4.1.1.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6X.3.2.2.m1.4c">\displaystyle\text{ for all }r\in\{0,1,\ldots,s-1\},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6X.3.2.2.m1.4d">for all italic_r ∈ { 0 , 1 , … , italic_s - 1 } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex6Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle i_{1}\in\{0,1,\ldots,L-1\}\text{ and }" class="ltx_Math" display="inline" id="S3.Ex6Xa.2.1.1.m1.4"><semantics id="S3.Ex6Xa.2.1.1.m1.4a"><mrow id="S3.Ex6Xa.2.1.1.m1.4.4" xref="S3.Ex6Xa.2.1.1.m1.4.4.cmml"><msub id="S3.Ex6Xa.2.1.1.m1.4.4.3" xref="S3.Ex6Xa.2.1.1.m1.4.4.3.cmml"><mi id="S3.Ex6Xa.2.1.1.m1.4.4.3.2" xref="S3.Ex6Xa.2.1.1.m1.4.4.3.2.cmml">i</mi><mn id="S3.Ex6Xa.2.1.1.m1.4.4.3.3" xref="S3.Ex6Xa.2.1.1.m1.4.4.3.3.cmml">1</mn></msub><mo id="S3.Ex6Xa.2.1.1.m1.4.4.2" xref="S3.Ex6Xa.2.1.1.m1.4.4.2.cmml">∈</mo><mrow id="S3.Ex6Xa.2.1.1.m1.4.4.1" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.cmml"><mrow id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.2.cmml"><mo id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.2" stretchy="false" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.2.cmml">{</mo><mn id="S3.Ex6Xa.2.1.1.m1.1.1" xref="S3.Ex6Xa.2.1.1.m1.1.1.cmml">0</mn><mo id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.3" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.2.cmml">,</mo><mn id="S3.Ex6Xa.2.1.1.m1.2.2" xref="S3.Ex6Xa.2.1.1.m1.2.2.cmml">1</mn><mo id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.4" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.2.cmml">,</mo><mi id="S3.Ex6Xa.2.1.1.m1.3.3" mathvariant="normal" xref="S3.Ex6Xa.2.1.1.m1.3.3.cmml">…</mi><mo id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.5" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.2.cmml">,</mo><mrow id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.cmml"><mi id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.2" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml">L</mi><mo id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.1" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.1.cmml">−</mo><mn id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.3" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.6" stretchy="false" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.2.cmml">}</mo></mrow><mo id="S3.Ex6Xa.2.1.1.m1.4.4.1.2" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.2.cmml">⁢</mo><mtext id="S3.Ex6Xa.2.1.1.m1.4.4.1.3" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.3a.cmml"> and</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6Xa.2.1.1.m1.4b"><apply id="S3.Ex6Xa.2.1.1.m1.4.4.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4"><in id="S3.Ex6Xa.2.1.1.m1.4.4.2.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.2"></in><apply id="S3.Ex6Xa.2.1.1.m1.4.4.3.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.3"><csymbol cd="ambiguous" id="S3.Ex6Xa.2.1.1.m1.4.4.3.1.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.3">subscript</csymbol><ci id="S3.Ex6Xa.2.1.1.m1.4.4.3.2.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.3.2">𝑖</ci><cn id="S3.Ex6Xa.2.1.1.m1.4.4.3.3.cmml" type="integer" xref="S3.Ex6Xa.2.1.1.m1.4.4.3.3">1</cn></apply><apply id="S3.Ex6Xa.2.1.1.m1.4.4.1.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.1"><times id="S3.Ex6Xa.2.1.1.m1.4.4.1.2.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.2"></times><set id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.2.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1"><cn id="S3.Ex6Xa.2.1.1.m1.1.1.cmml" type="integer" xref="S3.Ex6Xa.2.1.1.m1.1.1">0</cn><cn id="S3.Ex6Xa.2.1.1.m1.2.2.cmml" type="integer" xref="S3.Ex6Xa.2.1.1.m1.2.2">1</cn><ci id="S3.Ex6Xa.2.1.1.m1.3.3.cmml" xref="S3.Ex6Xa.2.1.1.m1.3.3">…</ci><apply id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1"><minus id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.1"></minus><ci id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.2">𝐿</ci><cn id="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.3.cmml" type="integer" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.1.1.1.3">1</cn></apply></set><ci id="S3.Ex6Xa.2.1.1.m1.4.4.1.3a.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.3"><mtext id="S3.Ex6Xa.2.1.1.m1.4.4.1.3.cmml" xref="S3.Ex6Xa.2.1.1.m1.4.4.1.3"> and</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6Xa.2.1.1.m1.4c">\displaystyle i_{1}\in\{0,1,\ldots,L-1\}\text{ and }</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6Xa.2.1.1.m1.4d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , italic_L - 1 } and</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex6Xb"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle j\text{ with }(r-1)L+1\leq j\leq(r+1)L-1." class="ltx_Math" display="inline" id="S3.Ex6Xb.2.1.1.m1.1"><semantics id="S3.Ex6Xb.2.1.1.m1.1a"><mrow id="S3.Ex6Xb.2.1.1.m1.1.1.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.Ex6Xb.2.1.1.m1.1.1.1.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.cmml"><mrow id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.3.cmml">j</mi><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mtext id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.4" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.4a.cmml"> with </mtext><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.2a" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.2b" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.5" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.5.cmml">L</mi></mrow><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.2" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.2.cmml">+</mo><mn id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.3" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.4" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.4.cmml">≤</mo><mi id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.5" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.5.cmml">j</mi><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.6" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.6.cmml">≤</mo><mrow id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.cmml"><mrow id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.cmml"><mrow id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.cmml"><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.2" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.2.cmml">r</mi><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.1" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.1.cmml">+</mo><mn id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.3" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.3" stretchy="false" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.2" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.2.cmml">⁢</mo><mi id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.3" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.3.cmml">L</mi></mrow><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.2" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.2.cmml">−</mo><mn id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.3" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.3.cmml">1</mn></mrow></mrow><mo id="S3.Ex6Xb.2.1.1.m1.1.1.1.2" lspace="0em" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6Xb.2.1.1.m1.1b"><apply id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1"><and id="S3.Ex6Xb.2.1.1.m1.1.1.1.1a.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1"></and><apply id="S3.Ex6Xb.2.1.1.m1.1.1.1.1b.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1"><leq id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.4.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.4"></leq><apply id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1"><plus id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.2"></plus><apply id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1"><times id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.2"></times><ci id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.3">𝑗</ci><ci id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.4a.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.4"><mtext id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.4.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.4"> with </mtext></ci><apply id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1"><minus id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">𝑟</ci><cn id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.5.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.1.5">𝐿</ci></apply><cn id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.1.3">1</cn></apply><ci id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.5.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.5">𝑗</ci></apply><apply id="S3.Ex6Xb.2.1.1.m1.1.1.1.1c.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1"><leq id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.6.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.6"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.Ex6Xb.2.1.1.m1.1.1.1.1.5.cmml" id="S3.Ex6Xb.2.1.1.m1.1.1.1.1d.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1"></share><apply id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2"><minus id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.2"></minus><apply id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1"><times id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.2.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.2"></times><apply id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1"><plus id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.1"></plus><ci id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.2">𝑟</ci><cn id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.3.cmml" type="integer" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.1.1.1.3">1</cn></apply><ci id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.3.cmml" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.1.3">𝐿</ci></apply><cn id="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.3.cmml" type="integer" xref="S3.Ex6Xb.2.1.1.m1.1.1.1.1.2.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6Xb.2.1.1.m1.1c">\displaystyle j\text{ with }(r-1)L+1\leq j\leq(r+1)L-1.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6Xb.2.1.1.m1.1d">italic_j with ( italic_r - 1 ) italic_L + 1 ≤ italic_j ≤ ( italic_r + 1 ) italic_L - 1 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p8.5">Indeed, with the change of variables <math alttext="i=rL+i_{1}" class="ltx_Math" display="inline" id="S3.p8.3.m1.1"><semantics id="S3.p8.3.m1.1a"><mrow id="S3.p8.3.m1.1.1" xref="S3.p8.3.m1.1.1.cmml"><mi id="S3.p8.3.m1.1.1.2" xref="S3.p8.3.m1.1.1.2.cmml">i</mi><mo id="S3.p8.3.m1.1.1.1" xref="S3.p8.3.m1.1.1.1.cmml">=</mo><mrow id="S3.p8.3.m1.1.1.3" xref="S3.p8.3.m1.1.1.3.cmml"><mrow id="S3.p8.3.m1.1.1.3.2" xref="S3.p8.3.m1.1.1.3.2.cmml"><mi id="S3.p8.3.m1.1.1.3.2.2" xref="S3.p8.3.m1.1.1.3.2.2.cmml">r</mi><mo id="S3.p8.3.m1.1.1.3.2.1" xref="S3.p8.3.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.p8.3.m1.1.1.3.2.3" xref="S3.p8.3.m1.1.1.3.2.3.cmml">L</mi></mrow><mo id="S3.p8.3.m1.1.1.3.1" xref="S3.p8.3.m1.1.1.3.1.cmml">+</mo><msub id="S3.p8.3.m1.1.1.3.3" xref="S3.p8.3.m1.1.1.3.3.cmml"><mi id="S3.p8.3.m1.1.1.3.3.2" xref="S3.p8.3.m1.1.1.3.3.2.cmml">i</mi><mn id="S3.p8.3.m1.1.1.3.3.3" xref="S3.p8.3.m1.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.3.m1.1b"><apply id="S3.p8.3.m1.1.1.cmml" xref="S3.p8.3.m1.1.1"><eq id="S3.p8.3.m1.1.1.1.cmml" xref="S3.p8.3.m1.1.1.1"></eq><ci id="S3.p8.3.m1.1.1.2.cmml" xref="S3.p8.3.m1.1.1.2">𝑖</ci><apply id="S3.p8.3.m1.1.1.3.cmml" xref="S3.p8.3.m1.1.1.3"><plus id="S3.p8.3.m1.1.1.3.1.cmml" xref="S3.p8.3.m1.1.1.3.1"></plus><apply id="S3.p8.3.m1.1.1.3.2.cmml" xref="S3.p8.3.m1.1.1.3.2"><times id="S3.p8.3.m1.1.1.3.2.1.cmml" xref="S3.p8.3.m1.1.1.3.2.1"></times><ci id="S3.p8.3.m1.1.1.3.2.2.cmml" xref="S3.p8.3.m1.1.1.3.2.2">𝑟</ci><ci id="S3.p8.3.m1.1.1.3.2.3.cmml" xref="S3.p8.3.m1.1.1.3.2.3">𝐿</ci></apply><apply id="S3.p8.3.m1.1.1.3.3.cmml" xref="S3.p8.3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p8.3.m1.1.1.3.3.1.cmml" xref="S3.p8.3.m1.1.1.3.3">subscript</csymbol><ci id="S3.p8.3.m1.1.1.3.3.2.cmml" xref="S3.p8.3.m1.1.1.3.3.2">𝑖</ci><cn id="S3.p8.3.m1.1.1.3.3.3.cmml" type="integer" xref="S3.p8.3.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.3.m1.1c">i=rL+i_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.3.m1.1d">italic_i = italic_r italic_L + italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, using <math alttext="i_{1}\in\{0,1,\ldots,L-1\}" class="ltx_Math" display="inline" id="S3.p8.4.m2.4"><semantics id="S3.p8.4.m2.4a"><mrow id="S3.p8.4.m2.4.4" xref="S3.p8.4.m2.4.4.cmml"><msub id="S3.p8.4.m2.4.4.3" xref="S3.p8.4.m2.4.4.3.cmml"><mi id="S3.p8.4.m2.4.4.3.2" xref="S3.p8.4.m2.4.4.3.2.cmml">i</mi><mn id="S3.p8.4.m2.4.4.3.3" xref="S3.p8.4.m2.4.4.3.3.cmml">1</mn></msub><mo id="S3.p8.4.m2.4.4.2" xref="S3.p8.4.m2.4.4.2.cmml">∈</mo><mrow id="S3.p8.4.m2.4.4.1.1" xref="S3.p8.4.m2.4.4.1.2.cmml"><mo id="S3.p8.4.m2.4.4.1.1.2" stretchy="false" xref="S3.p8.4.m2.4.4.1.2.cmml">{</mo><mn id="S3.p8.4.m2.1.1" xref="S3.p8.4.m2.1.1.cmml">0</mn><mo id="S3.p8.4.m2.4.4.1.1.3" xref="S3.p8.4.m2.4.4.1.2.cmml">,</mo><mn id="S3.p8.4.m2.2.2" xref="S3.p8.4.m2.2.2.cmml">1</mn><mo id="S3.p8.4.m2.4.4.1.1.4" xref="S3.p8.4.m2.4.4.1.2.cmml">,</mo><mi id="S3.p8.4.m2.3.3" mathvariant="normal" xref="S3.p8.4.m2.3.3.cmml">…</mi><mo id="S3.p8.4.m2.4.4.1.1.5" xref="S3.p8.4.m2.4.4.1.2.cmml">,</mo><mrow id="S3.p8.4.m2.4.4.1.1.1" xref="S3.p8.4.m2.4.4.1.1.1.cmml"><mi id="S3.p8.4.m2.4.4.1.1.1.2" xref="S3.p8.4.m2.4.4.1.1.1.2.cmml">L</mi><mo id="S3.p8.4.m2.4.4.1.1.1.1" xref="S3.p8.4.m2.4.4.1.1.1.1.cmml">−</mo><mn id="S3.p8.4.m2.4.4.1.1.1.3" xref="S3.p8.4.m2.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p8.4.m2.4.4.1.1.6" stretchy="false" xref="S3.p8.4.m2.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.4.m2.4b"><apply id="S3.p8.4.m2.4.4.cmml" xref="S3.p8.4.m2.4.4"><in id="S3.p8.4.m2.4.4.2.cmml" xref="S3.p8.4.m2.4.4.2"></in><apply id="S3.p8.4.m2.4.4.3.cmml" xref="S3.p8.4.m2.4.4.3"><csymbol cd="ambiguous" id="S3.p8.4.m2.4.4.3.1.cmml" xref="S3.p8.4.m2.4.4.3">subscript</csymbol><ci id="S3.p8.4.m2.4.4.3.2.cmml" xref="S3.p8.4.m2.4.4.3.2">𝑖</ci><cn id="S3.p8.4.m2.4.4.3.3.cmml" type="integer" xref="S3.p8.4.m2.4.4.3.3">1</cn></apply><set id="S3.p8.4.m2.4.4.1.2.cmml" xref="S3.p8.4.m2.4.4.1.1"><cn id="S3.p8.4.m2.1.1.cmml" type="integer" xref="S3.p8.4.m2.1.1">0</cn><cn id="S3.p8.4.m2.2.2.cmml" type="integer" xref="S3.p8.4.m2.2.2">1</cn><ci id="S3.p8.4.m2.3.3.cmml" xref="S3.p8.4.m2.3.3">…</ci><apply id="S3.p8.4.m2.4.4.1.1.1.cmml" xref="S3.p8.4.m2.4.4.1.1.1"><minus id="S3.p8.4.m2.4.4.1.1.1.1.cmml" xref="S3.p8.4.m2.4.4.1.1.1.1"></minus><ci id="S3.p8.4.m2.4.4.1.1.1.2.cmml" xref="S3.p8.4.m2.4.4.1.1.1.2">𝐿</ci><cn id="S3.p8.4.m2.4.4.1.1.1.3.cmml" type="integer" xref="S3.p8.4.m2.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.4.m2.4c">i_{1}\in\{0,1,\ldots,L-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.4.m2.4d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , italic_L - 1 }</annotation></semantics></math> we find that <math alttext="rL\leq i\leq(r+1)L-1" class="ltx_Math" display="inline" id="S3.p8.5.m3.1"><semantics id="S3.p8.5.m3.1a"><mrow id="S3.p8.5.m3.1.1" xref="S3.p8.5.m3.1.1.cmml"><mrow id="S3.p8.5.m3.1.1.3" xref="S3.p8.5.m3.1.1.3.cmml"><mi id="S3.p8.5.m3.1.1.3.2" xref="S3.p8.5.m3.1.1.3.2.cmml">r</mi><mo id="S3.p8.5.m3.1.1.3.1" xref="S3.p8.5.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.p8.5.m3.1.1.3.3" xref="S3.p8.5.m3.1.1.3.3.cmml">L</mi></mrow><mo id="S3.p8.5.m3.1.1.4" xref="S3.p8.5.m3.1.1.4.cmml">≤</mo><mi id="S3.p8.5.m3.1.1.5" xref="S3.p8.5.m3.1.1.5.cmml">i</mi><mo id="S3.p8.5.m3.1.1.6" xref="S3.p8.5.m3.1.1.6.cmml">≤</mo><mrow id="S3.p8.5.m3.1.1.1" xref="S3.p8.5.m3.1.1.1.cmml"><mrow id="S3.p8.5.m3.1.1.1.1" xref="S3.p8.5.m3.1.1.1.1.cmml"><mrow id="S3.p8.5.m3.1.1.1.1.1.1" xref="S3.p8.5.m3.1.1.1.1.1.1.1.cmml"><mo id="S3.p8.5.m3.1.1.1.1.1.1.2" stretchy="false" xref="S3.p8.5.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p8.5.m3.1.1.1.1.1.1.1" xref="S3.p8.5.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.p8.5.m3.1.1.1.1.1.1.1.2" xref="S3.p8.5.m3.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.p8.5.m3.1.1.1.1.1.1.1.1" xref="S3.p8.5.m3.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.p8.5.m3.1.1.1.1.1.1.1.3" xref="S3.p8.5.m3.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p8.5.m3.1.1.1.1.1.1.3" stretchy="false" xref="S3.p8.5.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p8.5.m3.1.1.1.1.2" xref="S3.p8.5.m3.1.1.1.1.2.cmml">⁢</mo><mi id="S3.p8.5.m3.1.1.1.1.3" xref="S3.p8.5.m3.1.1.1.1.3.cmml">L</mi></mrow><mo id="S3.p8.5.m3.1.1.1.2" xref="S3.p8.5.m3.1.1.1.2.cmml">−</mo><mn id="S3.p8.5.m3.1.1.1.3" xref="S3.p8.5.m3.1.1.1.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.5.m3.1b"><apply id="S3.p8.5.m3.1.1.cmml" xref="S3.p8.5.m3.1.1"><and id="S3.p8.5.m3.1.1a.cmml" xref="S3.p8.5.m3.1.1"></and><apply id="S3.p8.5.m3.1.1b.cmml" xref="S3.p8.5.m3.1.1"><leq id="S3.p8.5.m3.1.1.4.cmml" xref="S3.p8.5.m3.1.1.4"></leq><apply id="S3.p8.5.m3.1.1.3.cmml" xref="S3.p8.5.m3.1.1.3"><times id="S3.p8.5.m3.1.1.3.1.cmml" xref="S3.p8.5.m3.1.1.3.1"></times><ci id="S3.p8.5.m3.1.1.3.2.cmml" xref="S3.p8.5.m3.1.1.3.2">𝑟</ci><ci id="S3.p8.5.m3.1.1.3.3.cmml" xref="S3.p8.5.m3.1.1.3.3">𝐿</ci></apply><ci id="S3.p8.5.m3.1.1.5.cmml" xref="S3.p8.5.m3.1.1.5">𝑖</ci></apply><apply id="S3.p8.5.m3.1.1c.cmml" xref="S3.p8.5.m3.1.1"><leq id="S3.p8.5.m3.1.1.6.cmml" xref="S3.p8.5.m3.1.1.6"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.p8.5.m3.1.1.5.cmml" id="S3.p8.5.m3.1.1d.cmml" xref="S3.p8.5.m3.1.1"></share><apply id="S3.p8.5.m3.1.1.1.cmml" xref="S3.p8.5.m3.1.1.1"><minus id="S3.p8.5.m3.1.1.1.2.cmml" xref="S3.p8.5.m3.1.1.1.2"></minus><apply id="S3.p8.5.m3.1.1.1.1.cmml" xref="S3.p8.5.m3.1.1.1.1"><times id="S3.p8.5.m3.1.1.1.1.2.cmml" xref="S3.p8.5.m3.1.1.1.1.2"></times><apply id="S3.p8.5.m3.1.1.1.1.1.1.1.cmml" xref="S3.p8.5.m3.1.1.1.1.1.1"><plus id="S3.p8.5.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.p8.5.m3.1.1.1.1.1.1.1.1"></plus><ci id="S3.p8.5.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.p8.5.m3.1.1.1.1.1.1.1.2">𝑟</ci><cn id="S3.p8.5.m3.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.p8.5.m3.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.p8.5.m3.1.1.1.1.3.cmml" xref="S3.p8.5.m3.1.1.1.1.3">𝐿</ci></apply><cn id="S3.p8.5.m3.1.1.1.3.cmml" type="integer" xref="S3.p8.5.m3.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.5.m3.1c">rL\leq i\leq(r+1)L-1</annotation><annotation encoding="application/x-llamapun" id="S3.p8.5.m3.1d">italic_r italic_L ≤ italic_i ≤ ( italic_r + 1 ) italic_L - 1</annotation></semantics></math> and, thus,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[i-L+1,i]\subseteq[(r-1)L+1,(r+1)L-1]." class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.2.cmml"><mo id="S3.E5.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.2.cmml">[</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.2.cmml">i</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.2.1" xref="S3.E5.m1.2.2.1.1.1.1.1.2.1.cmml">−</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E5.m1.2.2.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.2.cmml">,</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">i</mi><mo id="S3.E5.m1.2.2.1.1.1.1.4" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.2.cmml">]</mo></mrow><mo id="S3.E5.m1.2.2.1.1.4" xref="S3.E5.m1.2.2.1.1.4.cmml">⊆</mo><mrow id="S3.E5.m1.2.2.1.1.3.2" xref="S3.E5.m1.2.2.1.1.3.3.cmml"><mo id="S3.E5.m1.2.2.1.1.3.2.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.3.3.cmml">[</mo><mrow id="S3.E5.m1.2.2.1.1.2.1.1" xref="S3.E5.m1.2.2.1.1.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.2.1.1.1" xref="S3.E5.m1.2.2.1.1.2.1.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E5.m1.2.2.1.1.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.2.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.2.1.1.1.3.cmml">L</mi></mrow><mo id="S3.E5.m1.2.2.1.1.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.1.1.2.cmml">+</mo><mn id="S3.E5.m1.2.2.1.1.2.1.1.3" xref="S3.E5.m1.2.2.1.1.2.1.1.3.cmml">1</mn></mrow><mo id="S3.E5.m1.2.2.1.1.3.2.4" xref="S3.E5.m1.2.2.1.1.3.3.cmml">,</mo><mrow id="S3.E5.m1.2.2.1.1.3.2.2" xref="S3.E5.m1.2.2.1.1.3.2.2.cmml"><mrow id="S3.E5.m1.2.2.1.1.3.2.2.1" xref="S3.E5.m1.2.2.1.1.3.2.2.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.cmml"><mo id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.2.cmml">r</mi><mo id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.1.cmml">+</mo><mn id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E5.m1.2.2.1.1.3.2.2.1.2" xref="S3.E5.m1.2.2.1.1.3.2.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.3.2.2.1.3" xref="S3.E5.m1.2.2.1.1.3.2.2.1.3.cmml">L</mi></mrow><mo id="S3.E5.m1.2.2.1.1.3.2.2.2" xref="S3.E5.m1.2.2.1.1.3.2.2.2.cmml">−</mo><mn id="S3.E5.m1.2.2.1.1.3.2.2.3" xref="S3.E5.m1.2.2.1.1.3.2.2.3.cmml">1</mn></mrow><mo id="S3.E5.m1.2.2.1.1.3.2.5" stretchy="false" xref="S3.E5.m1.2.2.1.1.3.3.cmml">]</mo></mrow></mrow><mo id="S3.E5.m1.2.2.1.2" lspace="0em" xref="S3.E5.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1"><subset id="S3.E5.m1.2.2.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.4"></subset><interval closure="closed" id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><apply id="S3.E5.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"><plus id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"></plus><apply id="S3.E5.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2"><minus id="S3.E5.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.1"></minus><ci id="S3.E5.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.2">𝑖</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="S3.E5.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.1.1.1.3">1</cn></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑖</ci></interval><interval closure="closed" id="S3.E5.m1.2.2.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.3.2"><apply id="S3.E5.m1.2.2.1.1.2.1.1.cmml" xref="S3.E5.m1.2.2.1.1.2.1.1"><plus id="S3.E5.m1.2.2.1.1.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2.1.1.2"></plus><apply id="S3.E5.m1.2.2.1.1.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.2.1.1.1"><times id="S3.E5.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1"><minus id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1"></minus><ci id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.2">𝑟</ci><cn id="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.2.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E5.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.2.1.1.1.3">𝐿</ci></apply><cn id="S3.E5.m1.2.2.1.1.2.1.1.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.2.1.1.3">1</cn></apply><apply id="S3.E5.m1.2.2.1.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2"><minus id="S3.E5.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2.2"></minus><apply id="S3.E5.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2.1"><times id="S3.E5.m1.2.2.1.1.3.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2.1.2"></times><apply id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1"><plus id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.1"></plus><ci id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.2">𝑟</ci><cn id="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.3.2.2.1.1.1.1.3">1</cn></apply><ci id="S3.E5.m1.2.2.1.1.3.2.2.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2.1.3">𝐿</ci></apply><cn id="S3.E5.m1.2.2.1.1.3.2.2.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.3.2.2.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">[i-L+1,i]\subseteq[(r-1)L+1,(r+1)L-1].</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">[ italic_i - italic_L + 1 , italic_i ] ⊆ [ ( italic_r - 1 ) italic_L + 1 , ( italic_r + 1 ) italic_L - 1 ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p8.6">This motivates the following definition.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdefinition3.2.1.1">Definition 3</span></span><span class="ltx_text ltx_font_bold" id="Thmdefinition3.3.2"> </span>(The tensor <math alttext="T_{K}" class="ltx_Math" display="inline" id="Thmdefinition3.1.m1.1"><semantics id="Thmdefinition3.1.m1.1b"><msub id="Thmdefinition3.1.m1.1.1" xref="Thmdefinition3.1.m1.1.1.cmml"><mi id="Thmdefinition3.1.m1.1.1.2" xref="Thmdefinition3.1.m1.1.1.2.cmml">T</mi><mi id="Thmdefinition3.1.m1.1.1.3" xref="Thmdefinition3.1.m1.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition3.1.m1.1c"><apply id="Thmdefinition3.1.m1.1.1.cmml" xref="Thmdefinition3.1.m1.1.1"><csymbol cd="ambiguous" id="Thmdefinition3.1.m1.1.1.1.cmml" xref="Thmdefinition3.1.m1.1.1">subscript</csymbol><ci id="Thmdefinition3.1.m1.1.1.2.cmml" xref="Thmdefinition3.1.m1.1.1.2">𝑇</ci><ci id="Thmdefinition3.1.m1.1.1.3.cmml" xref="Thmdefinition3.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition3.1.m1.1d">T_{K}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition3.1.m1.1e">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>)<span class="ltx_text ltx_font_bold" id="Thmdefinition3.4.3">.</span>
</h6>
<div class="ltx_para" id="Thmdefinition3.p1">
<p class="ltx_p" id="Thmdefinition3.p1.9"><span class="ltx_text ltx_font_italic" id="Thmdefinition3.p1.9.9">Let <math alttext="s=n/L" class="ltx_Math" display="inline" id="Thmdefinition3.p1.1.1.m1.1"><semantics id="Thmdefinition3.p1.1.1.m1.1a"><mrow id="Thmdefinition3.p1.1.1.m1.1.1" xref="Thmdefinition3.p1.1.1.m1.1.1.cmml"><mi id="Thmdefinition3.p1.1.1.m1.1.1.2" xref="Thmdefinition3.p1.1.1.m1.1.1.2.cmml">s</mi><mo id="Thmdefinition3.p1.1.1.m1.1.1.1" xref="Thmdefinition3.p1.1.1.m1.1.1.1.cmml">=</mo><mrow id="Thmdefinition3.p1.1.1.m1.1.1.3" xref="Thmdefinition3.p1.1.1.m1.1.1.3.cmml"><mi id="Thmdefinition3.p1.1.1.m1.1.1.3.2" xref="Thmdefinition3.p1.1.1.m1.1.1.3.2.cmml">n</mi><mo id="Thmdefinition3.p1.1.1.m1.1.1.3.1" xref="Thmdefinition3.p1.1.1.m1.1.1.3.1.cmml">/</mo><mi id="Thmdefinition3.p1.1.1.m1.1.1.3.3" xref="Thmdefinition3.p1.1.1.m1.1.1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition3.p1.1.1.m1.1b"><apply id="Thmdefinition3.p1.1.1.m1.1.1.cmml" xref="Thmdefinition3.p1.1.1.m1.1.1"><eq id="Thmdefinition3.p1.1.1.m1.1.1.1.cmml" xref="Thmdefinition3.p1.1.1.m1.1.1.1"></eq><ci id="Thmdefinition3.p1.1.1.m1.1.1.2.cmml" xref="Thmdefinition3.p1.1.1.m1.1.1.2">𝑠</ci><apply id="Thmdefinition3.p1.1.1.m1.1.1.3.cmml" xref="Thmdefinition3.p1.1.1.m1.1.1.3"><divide id="Thmdefinition3.p1.1.1.m1.1.1.3.1.cmml" xref="Thmdefinition3.p1.1.1.m1.1.1.3.1"></divide><ci id="Thmdefinition3.p1.1.1.m1.1.1.3.2.cmml" xref="Thmdefinition3.p1.1.1.m1.1.1.3.2">𝑛</ci><ci id="Thmdefinition3.p1.1.1.m1.1.1.3.3.cmml" xref="Thmdefinition3.p1.1.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition3.p1.1.1.m1.1c">s=n/L</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition3.p1.1.1.m1.1d">italic_s = italic_n / italic_L</annotation></semantics></math>. We define <math alttext="T_{K}" class="ltx_Math" display="inline" id="Thmdefinition3.p1.2.2.m2.1"><semantics id="Thmdefinition3.p1.2.2.m2.1a"><msub id="Thmdefinition3.p1.2.2.m2.1.1" xref="Thmdefinition3.p1.2.2.m2.1.1.cmml"><mi id="Thmdefinition3.p1.2.2.m2.1.1.2" xref="Thmdefinition3.p1.2.2.m2.1.1.2.cmml">T</mi><mi id="Thmdefinition3.p1.2.2.m2.1.1.3" xref="Thmdefinition3.p1.2.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition3.p1.2.2.m2.1b"><apply id="Thmdefinition3.p1.2.2.m2.1.1.cmml" xref="Thmdefinition3.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmdefinition3.p1.2.2.m2.1.1.1.cmml" xref="Thmdefinition3.p1.2.2.m2.1.1">subscript</csymbol><ci id="Thmdefinition3.p1.2.2.m2.1.1.2.cmml" xref="Thmdefinition3.p1.2.2.m2.1.1.2">𝑇</ci><ci id="Thmdefinition3.p1.2.2.m2.1.1.3.cmml" xref="Thmdefinition3.p1.2.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition3.p1.2.2.m2.1c">T_{K}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition3.p1.2.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> as the tensor with dimensions <math alttext="s\times(2L-1)\times d_{q}" class="ltx_Math" display="inline" id="Thmdefinition3.p1.3.3.m3.1"><semantics id="Thmdefinition3.p1.3.3.m3.1a"><mrow id="Thmdefinition3.p1.3.3.m3.1.1" xref="Thmdefinition3.p1.3.3.m3.1.1.cmml"><mi id="Thmdefinition3.p1.3.3.m3.1.1.3" xref="Thmdefinition3.p1.3.3.m3.1.1.3.cmml">s</mi><mo id="Thmdefinition3.p1.3.3.m3.1.1.2" lspace="0.222em" rspace="0.222em" xref="Thmdefinition3.p1.3.3.m3.1.1.2.cmml">×</mo><mrow id="Thmdefinition3.p1.3.3.m3.1.1.1.1" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.cmml"><mo id="Thmdefinition3.p1.3.3.m3.1.1.1.1.2" stretchy="false" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.cmml"><mrow id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.cmml"><mn id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.2" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.2.cmml">2</mn><mo id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.1" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.3" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.1" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.3" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition3.p1.3.3.m3.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmdefinition3.p1.3.3.m3.1.1.2a" rspace="0.222em" xref="Thmdefinition3.p1.3.3.m3.1.1.2.cmml">×</mo><msub id="Thmdefinition3.p1.3.3.m3.1.1.4" xref="Thmdefinition3.p1.3.3.m3.1.1.4.cmml"><mi id="Thmdefinition3.p1.3.3.m3.1.1.4.2" xref="Thmdefinition3.p1.3.3.m3.1.1.4.2.cmml">d</mi><mi id="Thmdefinition3.p1.3.3.m3.1.1.4.3" xref="Thmdefinition3.p1.3.3.m3.1.1.4.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition3.p1.3.3.m3.1b"><apply id="Thmdefinition3.p1.3.3.m3.1.1.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1"><times id="Thmdefinition3.p1.3.3.m3.1.1.2.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.2"></times><ci id="Thmdefinition3.p1.3.3.m3.1.1.3.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.3">𝑠</ci><apply id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1"><minus id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.1"></minus><apply id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2"><times id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.1.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.1"></times><cn id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.2.cmml" type="integer" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.2">2</cn><ci id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.3.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.3.3.m3.1.1.1.1.1.3">1</cn></apply><apply id="Thmdefinition3.p1.3.3.m3.1.1.4.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.4"><csymbol cd="ambiguous" id="Thmdefinition3.p1.3.3.m3.1.1.4.1.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.4">subscript</csymbol><ci id="Thmdefinition3.p1.3.3.m3.1.1.4.2.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.4.2">𝑑</ci><ci id="Thmdefinition3.p1.3.3.m3.1.1.4.3.cmml" xref="Thmdefinition3.p1.3.3.m3.1.1.4.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition3.p1.3.3.m3.1c">s\times(2L-1)\times d_{q}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition3.p1.3.3.m3.1d">italic_s × ( 2 italic_L - 1 ) × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> such that, for each for all <math alttext="r\in\{0,\ldots,s-1\}" class="ltx_Math" display="inline" id="Thmdefinition3.p1.4.4.m4.3"><semantics id="Thmdefinition3.p1.4.4.m4.3a"><mrow id="Thmdefinition3.p1.4.4.m4.3.3" xref="Thmdefinition3.p1.4.4.m4.3.3.cmml"><mi id="Thmdefinition3.p1.4.4.m4.3.3.3" xref="Thmdefinition3.p1.4.4.m4.3.3.3.cmml">r</mi><mo id="Thmdefinition3.p1.4.4.m4.3.3.2" xref="Thmdefinition3.p1.4.4.m4.3.3.2.cmml">∈</mo><mrow id="Thmdefinition3.p1.4.4.m4.3.3.1.1" xref="Thmdefinition3.p1.4.4.m4.3.3.1.2.cmml"><mo id="Thmdefinition3.p1.4.4.m4.3.3.1.1.2" stretchy="false" xref="Thmdefinition3.p1.4.4.m4.3.3.1.2.cmml">{</mo><mn id="Thmdefinition3.p1.4.4.m4.1.1" xref="Thmdefinition3.p1.4.4.m4.1.1.cmml">0</mn><mo id="Thmdefinition3.p1.4.4.m4.3.3.1.1.3" xref="Thmdefinition3.p1.4.4.m4.3.3.1.2.cmml">,</mo><mi id="Thmdefinition3.p1.4.4.m4.2.2" mathvariant="normal" xref="Thmdefinition3.p1.4.4.m4.2.2.cmml">…</mi><mo id="Thmdefinition3.p1.4.4.m4.3.3.1.1.4" xref="Thmdefinition3.p1.4.4.m4.3.3.1.2.cmml">,</mo><mrow id="Thmdefinition3.p1.4.4.m4.3.3.1.1.1" xref="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.cmml"><mi id="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.2" xref="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.2.cmml">s</mi><mo id="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.1" xref="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.1.cmml">−</mo><mn id="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.3" xref="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition3.p1.4.4.m4.3.3.1.1.5" stretchy="false" xref="Thmdefinition3.p1.4.4.m4.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition3.p1.4.4.m4.3b"><apply id="Thmdefinition3.p1.4.4.m4.3.3.cmml" xref="Thmdefinition3.p1.4.4.m4.3.3"><in id="Thmdefinition3.p1.4.4.m4.3.3.2.cmml" xref="Thmdefinition3.p1.4.4.m4.3.3.2"></in><ci id="Thmdefinition3.p1.4.4.m4.3.3.3.cmml" xref="Thmdefinition3.p1.4.4.m4.3.3.3">𝑟</ci><set id="Thmdefinition3.p1.4.4.m4.3.3.1.2.cmml" xref="Thmdefinition3.p1.4.4.m4.3.3.1.1"><cn id="Thmdefinition3.p1.4.4.m4.1.1.cmml" type="integer" xref="Thmdefinition3.p1.4.4.m4.1.1">0</cn><ci id="Thmdefinition3.p1.4.4.m4.2.2.cmml" xref="Thmdefinition3.p1.4.4.m4.2.2">…</ci><apply id="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.cmml" xref="Thmdefinition3.p1.4.4.m4.3.3.1.1.1"><minus id="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.1.cmml" xref="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.1"></minus><ci id="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.2.cmml" xref="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.2">𝑠</ci><cn id="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.4.4.m4.3.3.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition3.p1.4.4.m4.3c">r\in\{0,\ldots,s-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition3.p1.4.4.m4.3d">italic_r ∈ { 0 , … , italic_s - 1 }</annotation></semantics></math>, <math alttext="j_{1}\in\{0,1,\ldots,2L-2\}" class="ltx_Math" display="inline" id="Thmdefinition3.p1.5.5.m5.4"><semantics id="Thmdefinition3.p1.5.5.m5.4a"><mrow id="Thmdefinition3.p1.5.5.m5.4.4" xref="Thmdefinition3.p1.5.5.m5.4.4.cmml"><msub id="Thmdefinition3.p1.5.5.m5.4.4.3" xref="Thmdefinition3.p1.5.5.m5.4.4.3.cmml"><mi id="Thmdefinition3.p1.5.5.m5.4.4.3.2" xref="Thmdefinition3.p1.5.5.m5.4.4.3.2.cmml">j</mi><mn id="Thmdefinition3.p1.5.5.m5.4.4.3.3" xref="Thmdefinition3.p1.5.5.m5.4.4.3.3.cmml">1</mn></msub><mo id="Thmdefinition3.p1.5.5.m5.4.4.2" xref="Thmdefinition3.p1.5.5.m5.4.4.2.cmml">∈</mo><mrow id="Thmdefinition3.p1.5.5.m5.4.4.1.1" xref="Thmdefinition3.p1.5.5.m5.4.4.1.2.cmml"><mo id="Thmdefinition3.p1.5.5.m5.4.4.1.1.2" stretchy="false" xref="Thmdefinition3.p1.5.5.m5.4.4.1.2.cmml">{</mo><mn id="Thmdefinition3.p1.5.5.m5.1.1" xref="Thmdefinition3.p1.5.5.m5.1.1.cmml">0</mn><mo id="Thmdefinition3.p1.5.5.m5.4.4.1.1.3" xref="Thmdefinition3.p1.5.5.m5.4.4.1.2.cmml">,</mo><mn id="Thmdefinition3.p1.5.5.m5.2.2" xref="Thmdefinition3.p1.5.5.m5.2.2.cmml">1</mn><mo id="Thmdefinition3.p1.5.5.m5.4.4.1.1.4" xref="Thmdefinition3.p1.5.5.m5.4.4.1.2.cmml">,</mo><mi id="Thmdefinition3.p1.5.5.m5.3.3" mathvariant="normal" xref="Thmdefinition3.p1.5.5.m5.3.3.cmml">…</mi><mo id="Thmdefinition3.p1.5.5.m5.4.4.1.1.5" xref="Thmdefinition3.p1.5.5.m5.4.4.1.2.cmml">,</mo><mrow id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.cmml"><mrow id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.cmml"><mn id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.2" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.2.cmml">2</mn><mo id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.1" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.3" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.3.cmml">L</mi></mrow><mo id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.1" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.1.cmml">−</mo><mn id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.3" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="Thmdefinition3.p1.5.5.m5.4.4.1.1.6" stretchy="false" xref="Thmdefinition3.p1.5.5.m5.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition3.p1.5.5.m5.4b"><apply id="Thmdefinition3.p1.5.5.m5.4.4.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4"><in id="Thmdefinition3.p1.5.5.m5.4.4.2.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4.2"></in><apply id="Thmdefinition3.p1.5.5.m5.4.4.3.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4.3"><csymbol cd="ambiguous" id="Thmdefinition3.p1.5.5.m5.4.4.3.1.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4.3">subscript</csymbol><ci id="Thmdefinition3.p1.5.5.m5.4.4.3.2.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4.3.2">𝑗</ci><cn id="Thmdefinition3.p1.5.5.m5.4.4.3.3.cmml" type="integer" xref="Thmdefinition3.p1.5.5.m5.4.4.3.3">1</cn></apply><set id="Thmdefinition3.p1.5.5.m5.4.4.1.2.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1"><cn id="Thmdefinition3.p1.5.5.m5.1.1.cmml" type="integer" xref="Thmdefinition3.p1.5.5.m5.1.1">0</cn><cn id="Thmdefinition3.p1.5.5.m5.2.2.cmml" type="integer" xref="Thmdefinition3.p1.5.5.m5.2.2">1</cn><ci id="Thmdefinition3.p1.5.5.m5.3.3.cmml" xref="Thmdefinition3.p1.5.5.m5.3.3">…</ci><apply id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1"><minus id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.1.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.1"></minus><apply id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2"><times id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.1.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.1"></times><cn id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.2.cmml" type="integer" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.2">2</cn><ci id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.3.cmml" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.2.3">𝐿</ci></apply><cn id="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.5.5.m5.4.4.1.1.1.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition3.p1.5.5.m5.4c">j_{1}\in\{0,1,\ldots,2L-2\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition3.p1.5.5.m5.4d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , 2 italic_L - 2 }</annotation></semantics></math> and <math alttext="t\in\{0,1,\ldots,d_{q}-1\}" class="ltx_Math" display="inline" id="Thmdefinition3.p1.6.6.m6.4"><semantics id="Thmdefinition3.p1.6.6.m6.4a"><mrow id="Thmdefinition3.p1.6.6.m6.4.4" xref="Thmdefinition3.p1.6.6.m6.4.4.cmml"><mi id="Thmdefinition3.p1.6.6.m6.4.4.3" xref="Thmdefinition3.p1.6.6.m6.4.4.3.cmml">t</mi><mo id="Thmdefinition3.p1.6.6.m6.4.4.2" xref="Thmdefinition3.p1.6.6.m6.4.4.2.cmml">∈</mo><mrow id="Thmdefinition3.p1.6.6.m6.4.4.1.1" xref="Thmdefinition3.p1.6.6.m6.4.4.1.2.cmml"><mo id="Thmdefinition3.p1.6.6.m6.4.4.1.1.2" stretchy="false" xref="Thmdefinition3.p1.6.6.m6.4.4.1.2.cmml">{</mo><mn id="Thmdefinition3.p1.6.6.m6.1.1" xref="Thmdefinition3.p1.6.6.m6.1.1.cmml">0</mn><mo id="Thmdefinition3.p1.6.6.m6.4.4.1.1.3" xref="Thmdefinition3.p1.6.6.m6.4.4.1.2.cmml">,</mo><mn id="Thmdefinition3.p1.6.6.m6.2.2" xref="Thmdefinition3.p1.6.6.m6.2.2.cmml">1</mn><mo id="Thmdefinition3.p1.6.6.m6.4.4.1.1.4" xref="Thmdefinition3.p1.6.6.m6.4.4.1.2.cmml">,</mo><mi id="Thmdefinition3.p1.6.6.m6.3.3" mathvariant="normal" xref="Thmdefinition3.p1.6.6.m6.3.3.cmml">…</mi><mo id="Thmdefinition3.p1.6.6.m6.4.4.1.1.5" xref="Thmdefinition3.p1.6.6.m6.4.4.1.2.cmml">,</mo><mrow id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.cmml"><msub id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.cmml"><mi id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.2" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.2.cmml">d</mi><mi id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.3" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.3.cmml">q</mi></msub><mo id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.1" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.1.cmml">−</mo><mn id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.3" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition3.p1.6.6.m6.4.4.1.1.6" stretchy="false" xref="Thmdefinition3.p1.6.6.m6.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition3.p1.6.6.m6.4b"><apply id="Thmdefinition3.p1.6.6.m6.4.4.cmml" xref="Thmdefinition3.p1.6.6.m6.4.4"><in id="Thmdefinition3.p1.6.6.m6.4.4.2.cmml" xref="Thmdefinition3.p1.6.6.m6.4.4.2"></in><ci id="Thmdefinition3.p1.6.6.m6.4.4.3.cmml" xref="Thmdefinition3.p1.6.6.m6.4.4.3">𝑡</ci><set id="Thmdefinition3.p1.6.6.m6.4.4.1.2.cmml" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1"><cn id="Thmdefinition3.p1.6.6.m6.1.1.cmml" type="integer" xref="Thmdefinition3.p1.6.6.m6.1.1">0</cn><cn id="Thmdefinition3.p1.6.6.m6.2.2.cmml" type="integer" xref="Thmdefinition3.p1.6.6.m6.2.2">1</cn><ci id="Thmdefinition3.p1.6.6.m6.3.3.cmml" xref="Thmdefinition3.p1.6.6.m6.3.3">…</ci><apply id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.cmml" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1"><minus id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.1.cmml" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.1"></minus><apply id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.cmml" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2"><csymbol cd="ambiguous" id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.1.cmml" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2">subscript</csymbol><ci id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.2.cmml" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.2">𝑑</ci><ci id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.3.cmml" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.2.3">𝑞</ci></apply><cn id="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.6.6.m6.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition3.p1.6.6.m6.4c">t\in\{0,1,\ldots,d_{q}-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition3.p1.6.6.m6.4d">italic_t ∈ { 0 , 1 , … , italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT - 1 }</annotation></semantics></math>, <math alttext="T_{K}[r,j_{1},t]=K[(r-1)L+1+j_{1},t]" class="ltx_Math" display="inline" id="Thmdefinition3.p1.7.7.m7.5"><semantics id="Thmdefinition3.p1.7.7.m7.5a"><mrow id="Thmdefinition3.p1.7.7.m7.5.5" xref="Thmdefinition3.p1.7.7.m7.5.5.cmml"><mrow id="Thmdefinition3.p1.7.7.m7.4.4.1" xref="Thmdefinition3.p1.7.7.m7.4.4.1.cmml"><msub id="Thmdefinition3.p1.7.7.m7.4.4.1.3" xref="Thmdefinition3.p1.7.7.m7.4.4.1.3.cmml"><mi id="Thmdefinition3.p1.7.7.m7.4.4.1.3.2" xref="Thmdefinition3.p1.7.7.m7.4.4.1.3.2.cmml">T</mi><mi id="Thmdefinition3.p1.7.7.m7.4.4.1.3.3" xref="Thmdefinition3.p1.7.7.m7.4.4.1.3.3.cmml">K</mi></msub><mo id="Thmdefinition3.p1.7.7.m7.4.4.1.2" xref="Thmdefinition3.p1.7.7.m7.4.4.1.2.cmml">⁢</mo><mrow id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.2.cmml"><mo id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.2" stretchy="false" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.2.cmml">[</mo><mi id="Thmdefinition3.p1.7.7.m7.1.1" xref="Thmdefinition3.p1.7.7.m7.1.1.cmml">r</mi><mo id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.3" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.2.cmml">,</mo><msub id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.cmml"><mi id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.2" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.2.cmml">j</mi><mn id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.3" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.4" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.2.cmml">,</mo><mi id="Thmdefinition3.p1.7.7.m7.2.2" xref="Thmdefinition3.p1.7.7.m7.2.2.cmml">t</mi><mo id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.5" stretchy="false" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.2.cmml">]</mo></mrow></mrow><mo id="Thmdefinition3.p1.7.7.m7.5.5.3" xref="Thmdefinition3.p1.7.7.m7.5.5.3.cmml">=</mo><mrow id="Thmdefinition3.p1.7.7.m7.5.5.2" xref="Thmdefinition3.p1.7.7.m7.5.5.2.cmml"><mi id="Thmdefinition3.p1.7.7.m7.5.5.2.3" xref="Thmdefinition3.p1.7.7.m7.5.5.2.3.cmml">K</mi><mo id="Thmdefinition3.p1.7.7.m7.5.5.2.2" xref="Thmdefinition3.p1.7.7.m7.5.5.2.2.cmml">⁢</mo><mrow id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.2.cmml"><mo id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.2" stretchy="false" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.2.cmml">[</mo><mrow id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.cmml"><mrow id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.cmml"><mrow id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.cmml"><mo id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.2" stretchy="false" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.cmml"><mi id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.2" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.1" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.3" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.3" stretchy="false" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.2" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.2.cmml">⁢</mo><mi id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.3" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.3.cmml">L</mi></mrow><mo id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.2" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.2.cmml">+</mo><mn id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.3" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.3.cmml">1</mn><mo id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.2a" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.2.cmml">+</mo><msub id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.cmml"><mi id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.2" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.2.cmml">j</mi><mn id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.3" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.3" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.2.cmml">,</mo><mi id="Thmdefinition3.p1.7.7.m7.3.3" xref="Thmdefinition3.p1.7.7.m7.3.3.cmml">t</mi><mo id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.4" stretchy="false" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition3.p1.7.7.m7.5b"><apply id="Thmdefinition3.p1.7.7.m7.5.5.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5"><eq id="Thmdefinition3.p1.7.7.m7.5.5.3.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.3"></eq><apply id="Thmdefinition3.p1.7.7.m7.4.4.1.cmml" xref="Thmdefinition3.p1.7.7.m7.4.4.1"><times id="Thmdefinition3.p1.7.7.m7.4.4.1.2.cmml" xref="Thmdefinition3.p1.7.7.m7.4.4.1.2"></times><apply id="Thmdefinition3.p1.7.7.m7.4.4.1.3.cmml" xref="Thmdefinition3.p1.7.7.m7.4.4.1.3"><csymbol cd="ambiguous" id="Thmdefinition3.p1.7.7.m7.4.4.1.3.1.cmml" xref="Thmdefinition3.p1.7.7.m7.4.4.1.3">subscript</csymbol><ci id="Thmdefinition3.p1.7.7.m7.4.4.1.3.2.cmml" xref="Thmdefinition3.p1.7.7.m7.4.4.1.3.2">𝑇</ci><ci id="Thmdefinition3.p1.7.7.m7.4.4.1.3.3.cmml" xref="Thmdefinition3.p1.7.7.m7.4.4.1.3.3">𝐾</ci></apply><list id="Thmdefinition3.p1.7.7.m7.4.4.1.1.2.cmml" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.1"><ci id="Thmdefinition3.p1.7.7.m7.1.1.cmml" xref="Thmdefinition3.p1.7.7.m7.1.1">𝑟</ci><apply id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.cmml" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.1.cmml" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1">subscript</csymbol><ci id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.2.cmml" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.2">𝑗</ci><cn id="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.7.7.m7.4.4.1.1.1.1.3">1</cn></apply><ci id="Thmdefinition3.p1.7.7.m7.2.2.cmml" xref="Thmdefinition3.p1.7.7.m7.2.2">𝑡</ci></list></apply><apply id="Thmdefinition3.p1.7.7.m7.5.5.2.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2"><times id="Thmdefinition3.p1.7.7.m7.5.5.2.2.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.2"></times><ci id="Thmdefinition3.p1.7.7.m7.5.5.2.3.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.3">𝐾</ci><interval closure="closed" id="Thmdefinition3.p1.7.7.m7.5.5.2.1.2.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1"><apply id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1"><plus id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.2.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.2"></plus><apply id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1"><times id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.2.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.2"></times><apply id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1"><minus id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.1"></minus><ci id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.2.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.2">𝑟</ci><cn id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.3">1</cn></apply><ci id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.3.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.1.3">𝐿</ci></apply><cn id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.3">1</cn><apply id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4"><csymbol cd="ambiguous" id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.1.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4">subscript</csymbol><ci id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.2.cmml" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.2">𝑗</ci><cn id="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.3.cmml" type="integer" xref="Thmdefinition3.p1.7.7.m7.5.5.2.1.1.1.4.3">1</cn></apply></apply><ci id="Thmdefinition3.p1.7.7.m7.3.3.cmml" xref="Thmdefinition3.p1.7.7.m7.3.3">𝑡</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition3.p1.7.7.m7.5c">T_{K}[r,j_{1},t]=K[(r-1)L+1+j_{1},t]</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition3.p1.7.7.m7.5d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ italic_r , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ] = italic_K [ ( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ]</annotation></semantics></math> when <math alttext="(r-1)L+1+j_{1}\geq 0" class="ltx_Math" display="inline" id="Thmdefinition3.p1.8.8.m8.1"><semantics id="Thmdefinition3.p1.8.8.m8.1a"><mrow id="Thmdefinition3.p1.8.8.m8.1.1" xref="Thmdefinition3.p1.8.8.m8.1.1.cmml"><mrow id="Thmdefinition3.p1.8.8.m8.1.1.1" xref="Thmdefinition3.p1.8.8.m8.1.1.1.cmml"><mrow id="Thmdefinition3.p1.8.8.m8.1.1.1.1" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.cmml"><mrow id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.cmml"><mo id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.2" stretchy="false" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.cmml"><mi id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.2" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.1" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.3" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.3" stretchy="false" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmdefinition3.p1.8.8.m8.1.1.1.1.2" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.2.cmml">⁢</mo><mi id="Thmdefinition3.p1.8.8.m8.1.1.1.1.3" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.3.cmml">L</mi></mrow><mo id="Thmdefinition3.p1.8.8.m8.1.1.1.2" xref="Thmdefinition3.p1.8.8.m8.1.1.1.2.cmml">+</mo><mn id="Thmdefinition3.p1.8.8.m8.1.1.1.3" xref="Thmdefinition3.p1.8.8.m8.1.1.1.3.cmml">1</mn><mo id="Thmdefinition3.p1.8.8.m8.1.1.1.2a" xref="Thmdefinition3.p1.8.8.m8.1.1.1.2.cmml">+</mo><msub id="Thmdefinition3.p1.8.8.m8.1.1.1.4" xref="Thmdefinition3.p1.8.8.m8.1.1.1.4.cmml"><mi id="Thmdefinition3.p1.8.8.m8.1.1.1.4.2" xref="Thmdefinition3.p1.8.8.m8.1.1.1.4.2.cmml">j</mi><mn id="Thmdefinition3.p1.8.8.m8.1.1.1.4.3" xref="Thmdefinition3.p1.8.8.m8.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="Thmdefinition3.p1.8.8.m8.1.1.2" xref="Thmdefinition3.p1.8.8.m8.1.1.2.cmml">≥</mo><mn id="Thmdefinition3.p1.8.8.m8.1.1.3" xref="Thmdefinition3.p1.8.8.m8.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition3.p1.8.8.m8.1b"><apply id="Thmdefinition3.p1.8.8.m8.1.1.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1"><geq id="Thmdefinition3.p1.8.8.m8.1.1.2.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.2"></geq><apply id="Thmdefinition3.p1.8.8.m8.1.1.1.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1"><plus id="Thmdefinition3.p1.8.8.m8.1.1.1.2.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1.2"></plus><apply id="Thmdefinition3.p1.8.8.m8.1.1.1.1.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1"><times id="Thmdefinition3.p1.8.8.m8.1.1.1.1.2.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.2"></times><apply id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1"><minus id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.1.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.1"></minus><ci id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.2.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.2">𝑟</ci><cn id="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.1.1.1.3">1</cn></apply><ci id="Thmdefinition3.p1.8.8.m8.1.1.1.1.3.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1.1.3">𝐿</ci></apply><cn id="Thmdefinition3.p1.8.8.m8.1.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.8.8.m8.1.1.1.3">1</cn><apply id="Thmdefinition3.p1.8.8.m8.1.1.1.4.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1.4"><csymbol cd="ambiguous" id="Thmdefinition3.p1.8.8.m8.1.1.1.4.1.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1.4">subscript</csymbol><ci id="Thmdefinition3.p1.8.8.m8.1.1.1.4.2.cmml" xref="Thmdefinition3.p1.8.8.m8.1.1.1.4.2">𝑗</ci><cn id="Thmdefinition3.p1.8.8.m8.1.1.1.4.3.cmml" type="integer" xref="Thmdefinition3.p1.8.8.m8.1.1.1.4.3">1</cn></apply></apply><cn id="Thmdefinition3.p1.8.8.m8.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.8.8.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition3.p1.8.8.m8.1c">(r-1)L+1+j_{1}\geq 0</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition3.p1.8.8.m8.1d">( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≥ 0</annotation></semantics></math> and <math alttext="T_{K}[0,j_{1},t]=0" class="ltx_Math" display="inline" id="Thmdefinition3.p1.9.9.m9.3"><semantics id="Thmdefinition3.p1.9.9.m9.3a"><mrow id="Thmdefinition3.p1.9.9.m9.3.3" xref="Thmdefinition3.p1.9.9.m9.3.3.cmml"><mrow id="Thmdefinition3.p1.9.9.m9.3.3.1" xref="Thmdefinition3.p1.9.9.m9.3.3.1.cmml"><msub id="Thmdefinition3.p1.9.9.m9.3.3.1.3" xref="Thmdefinition3.p1.9.9.m9.3.3.1.3.cmml"><mi id="Thmdefinition3.p1.9.9.m9.3.3.1.3.2" xref="Thmdefinition3.p1.9.9.m9.3.3.1.3.2.cmml">T</mi><mi id="Thmdefinition3.p1.9.9.m9.3.3.1.3.3" xref="Thmdefinition3.p1.9.9.m9.3.3.1.3.3.cmml">K</mi></msub><mo id="Thmdefinition3.p1.9.9.m9.3.3.1.2" xref="Thmdefinition3.p1.9.9.m9.3.3.1.2.cmml">⁢</mo><mrow id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.2.cmml"><mo id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.2" stretchy="false" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.2.cmml">[</mo><mn id="Thmdefinition3.p1.9.9.m9.1.1" xref="Thmdefinition3.p1.9.9.m9.1.1.cmml">0</mn><mo id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.3" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.2.cmml">,</mo><msub id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.cmml"><mi id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.2" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.2.cmml">j</mi><mn id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.3" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.4" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.2.cmml">,</mo><mi id="Thmdefinition3.p1.9.9.m9.2.2" xref="Thmdefinition3.p1.9.9.m9.2.2.cmml">t</mi><mo id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.5" stretchy="false" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.2.cmml">]</mo></mrow></mrow><mo id="Thmdefinition3.p1.9.9.m9.3.3.2" xref="Thmdefinition3.p1.9.9.m9.3.3.2.cmml">=</mo><mn id="Thmdefinition3.p1.9.9.m9.3.3.3" xref="Thmdefinition3.p1.9.9.m9.3.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition3.p1.9.9.m9.3b"><apply id="Thmdefinition3.p1.9.9.m9.3.3.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3"><eq id="Thmdefinition3.p1.9.9.m9.3.3.2.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.2"></eq><apply id="Thmdefinition3.p1.9.9.m9.3.3.1.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.1"><times id="Thmdefinition3.p1.9.9.m9.3.3.1.2.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.1.2"></times><apply id="Thmdefinition3.p1.9.9.m9.3.3.1.3.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.1.3"><csymbol cd="ambiguous" id="Thmdefinition3.p1.9.9.m9.3.3.1.3.1.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.1.3">subscript</csymbol><ci id="Thmdefinition3.p1.9.9.m9.3.3.1.3.2.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.1.3.2">𝑇</ci><ci id="Thmdefinition3.p1.9.9.m9.3.3.1.3.3.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.1.3.3">𝐾</ci></apply><list id="Thmdefinition3.p1.9.9.m9.3.3.1.1.2.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.1"><cn id="Thmdefinition3.p1.9.9.m9.1.1.cmml" type="integer" xref="Thmdefinition3.p1.9.9.m9.1.1">0</cn><apply id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.1.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1">subscript</csymbol><ci id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.2.cmml" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.2">𝑗</ci><cn id="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition3.p1.9.9.m9.3.3.1.1.1.1.3">1</cn></apply><ci id="Thmdefinition3.p1.9.9.m9.2.2.cmml" xref="Thmdefinition3.p1.9.9.m9.2.2">𝑡</ci></list></apply><cn id="Thmdefinition3.p1.9.9.m9.3.3.3.cmml" type="integer" xref="Thmdefinition3.p1.9.9.m9.3.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition3.p1.9.9.m9.3c">T_{K}[0,j_{1},t]=0</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition3.p1.9.9.m9.3d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ 0 , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ] = 0</annotation></semantics></math> otherwise.</span></p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.p9">
<p class="ltx_p" id="S3.p9.15">We note that <math alttext="(r-1)L+1+j_{1}&lt;0" class="ltx_Math" display="inline" id="S3.p9.1.m1.1"><semantics id="S3.p9.1.m1.1a"><mrow id="S3.p9.1.m1.1.1" xref="S3.p9.1.m1.1.1.cmml"><mrow id="S3.p9.1.m1.1.1.1" xref="S3.p9.1.m1.1.1.1.cmml"><mrow id="S3.p9.1.m1.1.1.1.1" xref="S3.p9.1.m1.1.1.1.1.cmml"><mrow id="S3.p9.1.m1.1.1.1.1.1.1" xref="S3.p9.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.p9.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.p9.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p9.1.m1.1.1.1.1.1.1.1" xref="S3.p9.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.p9.1.m1.1.1.1.1.1.1.1.2" xref="S3.p9.1.m1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.p9.1.m1.1.1.1.1.1.1.1.1" xref="S3.p9.1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.p9.1.m1.1.1.1.1.1.1.1.3" xref="S3.p9.1.m1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p9.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.p9.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p9.1.m1.1.1.1.1.2" xref="S3.p9.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.p9.1.m1.1.1.1.1.3" xref="S3.p9.1.m1.1.1.1.1.3.cmml">L</mi></mrow><mo id="S3.p9.1.m1.1.1.1.2" xref="S3.p9.1.m1.1.1.1.2.cmml">+</mo><mn id="S3.p9.1.m1.1.1.1.3" xref="S3.p9.1.m1.1.1.1.3.cmml">1</mn><mo id="S3.p9.1.m1.1.1.1.2a" xref="S3.p9.1.m1.1.1.1.2.cmml">+</mo><msub id="S3.p9.1.m1.1.1.1.4" xref="S3.p9.1.m1.1.1.1.4.cmml"><mi id="S3.p9.1.m1.1.1.1.4.2" xref="S3.p9.1.m1.1.1.1.4.2.cmml">j</mi><mn id="S3.p9.1.m1.1.1.1.4.3" xref="S3.p9.1.m1.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S3.p9.1.m1.1.1.2" xref="S3.p9.1.m1.1.1.2.cmml">&lt;</mo><mn id="S3.p9.1.m1.1.1.3" xref="S3.p9.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.1.m1.1b"><apply id="S3.p9.1.m1.1.1.cmml" xref="S3.p9.1.m1.1.1"><lt id="S3.p9.1.m1.1.1.2.cmml" xref="S3.p9.1.m1.1.1.2"></lt><apply id="S3.p9.1.m1.1.1.1.cmml" xref="S3.p9.1.m1.1.1.1"><plus id="S3.p9.1.m1.1.1.1.2.cmml" xref="S3.p9.1.m1.1.1.1.2"></plus><apply id="S3.p9.1.m1.1.1.1.1.cmml" xref="S3.p9.1.m1.1.1.1.1"><times id="S3.p9.1.m1.1.1.1.1.2.cmml" xref="S3.p9.1.m1.1.1.1.1.2"></times><apply id="S3.p9.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.p9.1.m1.1.1.1.1.1.1"><minus id="S3.p9.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.p9.1.m1.1.1.1.1.1.1.1.1"></minus><ci id="S3.p9.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.p9.1.m1.1.1.1.1.1.1.1.2">𝑟</ci><cn id="S3.p9.1.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.p9.1.m1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.p9.1.m1.1.1.1.1.3.cmml" xref="S3.p9.1.m1.1.1.1.1.3">𝐿</ci></apply><cn id="S3.p9.1.m1.1.1.1.3.cmml" type="integer" xref="S3.p9.1.m1.1.1.1.3">1</cn><apply id="S3.p9.1.m1.1.1.1.4.cmml" xref="S3.p9.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="S3.p9.1.m1.1.1.1.4.1.cmml" xref="S3.p9.1.m1.1.1.1.4">subscript</csymbol><ci id="S3.p9.1.m1.1.1.1.4.2.cmml" xref="S3.p9.1.m1.1.1.1.4.2">𝑗</ci><cn id="S3.p9.1.m1.1.1.1.4.3.cmml" type="integer" xref="S3.p9.1.m1.1.1.1.4.3">1</cn></apply></apply><cn id="S3.p9.1.m1.1.1.3.cmml" type="integer" xref="S3.p9.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.1.m1.1c">(r-1)L+1+j_{1}&lt;0</annotation><annotation encoding="application/x-llamapun" id="S3.p9.1.m1.1d">( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &lt; 0</annotation></semantics></math> only when <math alttext="j_{1}&lt;(1-r)L-1" class="ltx_Math" display="inline" id="S3.p9.2.m2.1"><semantics id="S3.p9.2.m2.1a"><mrow id="S3.p9.2.m2.1.1" xref="S3.p9.2.m2.1.1.cmml"><msub id="S3.p9.2.m2.1.1.3" xref="S3.p9.2.m2.1.1.3.cmml"><mi id="S3.p9.2.m2.1.1.3.2" xref="S3.p9.2.m2.1.1.3.2.cmml">j</mi><mn id="S3.p9.2.m2.1.1.3.3" xref="S3.p9.2.m2.1.1.3.3.cmml">1</mn></msub><mo id="S3.p9.2.m2.1.1.2" xref="S3.p9.2.m2.1.1.2.cmml">&lt;</mo><mrow id="S3.p9.2.m2.1.1.1" xref="S3.p9.2.m2.1.1.1.cmml"><mrow id="S3.p9.2.m2.1.1.1.1" xref="S3.p9.2.m2.1.1.1.1.cmml"><mrow id="S3.p9.2.m2.1.1.1.1.1.1" xref="S3.p9.2.m2.1.1.1.1.1.1.1.cmml"><mo id="S3.p9.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S3.p9.2.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p9.2.m2.1.1.1.1.1.1.1" xref="S3.p9.2.m2.1.1.1.1.1.1.1.cmml"><mn id="S3.p9.2.m2.1.1.1.1.1.1.1.2" xref="S3.p9.2.m2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.p9.2.m2.1.1.1.1.1.1.1.1" xref="S3.p9.2.m2.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.p9.2.m2.1.1.1.1.1.1.1.3" xref="S3.p9.2.m2.1.1.1.1.1.1.1.3.cmml">r</mi></mrow><mo id="S3.p9.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S3.p9.2.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p9.2.m2.1.1.1.1.2" xref="S3.p9.2.m2.1.1.1.1.2.cmml">⁢</mo><mi id="S3.p9.2.m2.1.1.1.1.3" xref="S3.p9.2.m2.1.1.1.1.3.cmml">L</mi></mrow><mo id="S3.p9.2.m2.1.1.1.2" xref="S3.p9.2.m2.1.1.1.2.cmml">−</mo><mn id="S3.p9.2.m2.1.1.1.3" xref="S3.p9.2.m2.1.1.1.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.2.m2.1b"><apply id="S3.p9.2.m2.1.1.cmml" xref="S3.p9.2.m2.1.1"><lt id="S3.p9.2.m2.1.1.2.cmml" xref="S3.p9.2.m2.1.1.2"></lt><apply id="S3.p9.2.m2.1.1.3.cmml" xref="S3.p9.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p9.2.m2.1.1.3.1.cmml" xref="S3.p9.2.m2.1.1.3">subscript</csymbol><ci id="S3.p9.2.m2.1.1.3.2.cmml" xref="S3.p9.2.m2.1.1.3.2">𝑗</ci><cn id="S3.p9.2.m2.1.1.3.3.cmml" type="integer" xref="S3.p9.2.m2.1.1.3.3">1</cn></apply><apply id="S3.p9.2.m2.1.1.1.cmml" xref="S3.p9.2.m2.1.1.1"><minus id="S3.p9.2.m2.1.1.1.2.cmml" xref="S3.p9.2.m2.1.1.1.2"></minus><apply id="S3.p9.2.m2.1.1.1.1.cmml" xref="S3.p9.2.m2.1.1.1.1"><times id="S3.p9.2.m2.1.1.1.1.2.cmml" xref="S3.p9.2.m2.1.1.1.1.2"></times><apply id="S3.p9.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.p9.2.m2.1.1.1.1.1.1"><minus id="S3.p9.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.p9.2.m2.1.1.1.1.1.1.1.1"></minus><cn id="S3.p9.2.m2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.p9.2.m2.1.1.1.1.1.1.1.2">1</cn><ci id="S3.p9.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.p9.2.m2.1.1.1.1.1.1.1.3">𝑟</ci></apply><ci id="S3.p9.2.m2.1.1.1.1.3.cmml" xref="S3.p9.2.m2.1.1.1.1.3">𝐿</ci></apply><cn id="S3.p9.2.m2.1.1.1.3.cmml" type="integer" xref="S3.p9.2.m2.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.2.m2.1c">j_{1}&lt;(1-r)L-1</annotation><annotation encoding="application/x-llamapun" id="S3.p9.2.m2.1d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &lt; ( 1 - italic_r ) italic_L - 1</annotation></semantics></math>, which only occurs in the case <math alttext="r=0" class="ltx_Math" display="inline" id="S3.p9.3.m3.1"><semantics id="S3.p9.3.m3.1a"><mrow id="S3.p9.3.m3.1.1" xref="S3.p9.3.m3.1.1.cmml"><mi id="S3.p9.3.m3.1.1.2" xref="S3.p9.3.m3.1.1.2.cmml">r</mi><mo id="S3.p9.3.m3.1.1.1" xref="S3.p9.3.m3.1.1.1.cmml">=</mo><mn id="S3.p9.3.m3.1.1.3" xref="S3.p9.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.3.m3.1b"><apply id="S3.p9.3.m3.1.1.cmml" xref="S3.p9.3.m3.1.1"><eq id="S3.p9.3.m3.1.1.1.cmml" xref="S3.p9.3.m3.1.1.1"></eq><ci id="S3.p9.3.m3.1.1.2.cmml" xref="S3.p9.3.m3.1.1.2">𝑟</ci><cn id="S3.p9.3.m3.1.1.3.cmml" type="integer" xref="S3.p9.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.3.m3.1c">r=0</annotation><annotation encoding="application/x-llamapun" id="S3.p9.3.m3.1d">italic_r = 0</annotation></semantics></math> and <math alttext="j_{1}\leq L-2" class="ltx_Math" display="inline" id="S3.p9.4.m4.1"><semantics id="S3.p9.4.m4.1a"><mrow id="S3.p9.4.m4.1.1" xref="S3.p9.4.m4.1.1.cmml"><msub id="S3.p9.4.m4.1.1.2" xref="S3.p9.4.m4.1.1.2.cmml"><mi id="S3.p9.4.m4.1.1.2.2" xref="S3.p9.4.m4.1.1.2.2.cmml">j</mi><mn id="S3.p9.4.m4.1.1.2.3" xref="S3.p9.4.m4.1.1.2.3.cmml">1</mn></msub><mo id="S3.p9.4.m4.1.1.1" xref="S3.p9.4.m4.1.1.1.cmml">≤</mo><mrow id="S3.p9.4.m4.1.1.3" xref="S3.p9.4.m4.1.1.3.cmml"><mi id="S3.p9.4.m4.1.1.3.2" xref="S3.p9.4.m4.1.1.3.2.cmml">L</mi><mo id="S3.p9.4.m4.1.1.3.1" xref="S3.p9.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.p9.4.m4.1.1.3.3" xref="S3.p9.4.m4.1.1.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.4.m4.1b"><apply id="S3.p9.4.m4.1.1.cmml" xref="S3.p9.4.m4.1.1"><leq id="S3.p9.4.m4.1.1.1.cmml" xref="S3.p9.4.m4.1.1.1"></leq><apply id="S3.p9.4.m4.1.1.2.cmml" xref="S3.p9.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.p9.4.m4.1.1.2.1.cmml" xref="S3.p9.4.m4.1.1.2">subscript</csymbol><ci id="S3.p9.4.m4.1.1.2.2.cmml" xref="S3.p9.4.m4.1.1.2.2">𝑗</ci><cn id="S3.p9.4.m4.1.1.2.3.cmml" type="integer" xref="S3.p9.4.m4.1.1.2.3">1</cn></apply><apply id="S3.p9.4.m4.1.1.3.cmml" xref="S3.p9.4.m4.1.1.3"><minus id="S3.p9.4.m4.1.1.3.1.cmml" xref="S3.p9.4.m4.1.1.3.1"></minus><ci id="S3.p9.4.m4.1.1.3.2.cmml" xref="S3.p9.4.m4.1.1.3.2">𝐿</ci><cn id="S3.p9.4.m4.1.1.3.3.cmml" type="integer" xref="S3.p9.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.4.m4.1c">j_{1}\leq L-2</annotation><annotation encoding="application/x-llamapun" id="S3.p9.4.m4.1d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_L - 2</annotation></semantics></math>. Indeed, for <math alttext="r=0" class="ltx_Math" display="inline" id="S3.p9.5.m5.1"><semantics id="S3.p9.5.m5.1a"><mrow id="S3.p9.5.m5.1.1" xref="S3.p9.5.m5.1.1.cmml"><mi id="S3.p9.5.m5.1.1.2" xref="S3.p9.5.m5.1.1.2.cmml">r</mi><mo id="S3.p9.5.m5.1.1.1" xref="S3.p9.5.m5.1.1.1.cmml">=</mo><mn id="S3.p9.5.m5.1.1.3" xref="S3.p9.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.5.m5.1b"><apply id="S3.p9.5.m5.1.1.cmml" xref="S3.p9.5.m5.1.1"><eq id="S3.p9.5.m5.1.1.1.cmml" xref="S3.p9.5.m5.1.1.1"></eq><ci id="S3.p9.5.m5.1.1.2.cmml" xref="S3.p9.5.m5.1.1.2">𝑟</ci><cn id="S3.p9.5.m5.1.1.3.cmml" type="integer" xref="S3.p9.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.5.m5.1c">r=0</annotation><annotation encoding="application/x-llamapun" id="S3.p9.5.m5.1d">italic_r = 0</annotation></semantics></math> in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.E4" title="Equation 4 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4</span></a>), we only have to compute the dot product <math alttext="\langle Q_{i_{1}},K_{j}\rangle" class="ltx_Math" display="inline" id="S3.p9.6.m6.2"><semantics id="S3.p9.6.m6.2a"><mrow id="S3.p9.6.m6.2.2.2" xref="S3.p9.6.m6.2.2.3.cmml"><mo id="S3.p9.6.m6.2.2.2.3" stretchy="false" xref="S3.p9.6.m6.2.2.3.cmml">⟨</mo><msub id="S3.p9.6.m6.1.1.1.1" xref="S3.p9.6.m6.1.1.1.1.cmml"><mi id="S3.p9.6.m6.1.1.1.1.2" xref="S3.p9.6.m6.1.1.1.1.2.cmml">Q</mi><msub id="S3.p9.6.m6.1.1.1.1.3" xref="S3.p9.6.m6.1.1.1.1.3.cmml"><mi id="S3.p9.6.m6.1.1.1.1.3.2" xref="S3.p9.6.m6.1.1.1.1.3.2.cmml">i</mi><mn id="S3.p9.6.m6.1.1.1.1.3.3" xref="S3.p9.6.m6.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.p9.6.m6.2.2.2.4" xref="S3.p9.6.m6.2.2.3.cmml">,</mo><msub id="S3.p9.6.m6.2.2.2.2" xref="S3.p9.6.m6.2.2.2.2.cmml"><mi id="S3.p9.6.m6.2.2.2.2.2" xref="S3.p9.6.m6.2.2.2.2.2.cmml">K</mi><mi id="S3.p9.6.m6.2.2.2.2.3" xref="S3.p9.6.m6.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.p9.6.m6.2.2.2.5" stretchy="false" xref="S3.p9.6.m6.2.2.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.6.m6.2b"><list id="S3.p9.6.m6.2.2.3.cmml" xref="S3.p9.6.m6.2.2.2"><apply id="S3.p9.6.m6.1.1.1.1.cmml" xref="S3.p9.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.p9.6.m6.1.1.1.1.1.cmml" xref="S3.p9.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.p9.6.m6.1.1.1.1.2.cmml" xref="S3.p9.6.m6.1.1.1.1.2">𝑄</ci><apply id="S3.p9.6.m6.1.1.1.1.3.cmml" xref="S3.p9.6.m6.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p9.6.m6.1.1.1.1.3.1.cmml" xref="S3.p9.6.m6.1.1.1.1.3">subscript</csymbol><ci id="S3.p9.6.m6.1.1.1.1.3.2.cmml" xref="S3.p9.6.m6.1.1.1.1.3.2">𝑖</ci><cn id="S3.p9.6.m6.1.1.1.1.3.3.cmml" type="integer" xref="S3.p9.6.m6.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.p9.6.m6.2.2.2.2.cmml" xref="S3.p9.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.p9.6.m6.2.2.2.2.1.cmml" xref="S3.p9.6.m6.2.2.2.2">subscript</csymbol><ci id="S3.p9.6.m6.2.2.2.2.2.cmml" xref="S3.p9.6.m6.2.2.2.2.2">𝐾</ci><ci id="S3.p9.6.m6.2.2.2.2.3.cmml" xref="S3.p9.6.m6.2.2.2.2.3">𝑗</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.6.m6.2c">\langle Q_{i_{1}},K_{j}\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.p9.6.m6.2d">⟨ italic_Q start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩</annotation></semantics></math> for <math alttext="0\leq j\leq i_{1}" class="ltx_Math" display="inline" id="S3.p9.7.m7.1"><semantics id="S3.p9.7.m7.1a"><mrow id="S3.p9.7.m7.1.1" xref="S3.p9.7.m7.1.1.cmml"><mn id="S3.p9.7.m7.1.1.2" xref="S3.p9.7.m7.1.1.2.cmml">0</mn><mo id="S3.p9.7.m7.1.1.3" xref="S3.p9.7.m7.1.1.3.cmml">≤</mo><mi id="S3.p9.7.m7.1.1.4" xref="S3.p9.7.m7.1.1.4.cmml">j</mi><mo id="S3.p9.7.m7.1.1.5" xref="S3.p9.7.m7.1.1.5.cmml">≤</mo><msub id="S3.p9.7.m7.1.1.6" xref="S3.p9.7.m7.1.1.6.cmml"><mi id="S3.p9.7.m7.1.1.6.2" xref="S3.p9.7.m7.1.1.6.2.cmml">i</mi><mn id="S3.p9.7.m7.1.1.6.3" xref="S3.p9.7.m7.1.1.6.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.7.m7.1b"><apply id="S3.p9.7.m7.1.1.cmml" xref="S3.p9.7.m7.1.1"><and id="S3.p9.7.m7.1.1a.cmml" xref="S3.p9.7.m7.1.1"></and><apply id="S3.p9.7.m7.1.1b.cmml" xref="S3.p9.7.m7.1.1"><leq id="S3.p9.7.m7.1.1.3.cmml" xref="S3.p9.7.m7.1.1.3"></leq><cn id="S3.p9.7.m7.1.1.2.cmml" type="integer" xref="S3.p9.7.m7.1.1.2">0</cn><ci id="S3.p9.7.m7.1.1.4.cmml" xref="S3.p9.7.m7.1.1.4">𝑗</ci></apply><apply id="S3.p9.7.m7.1.1c.cmml" xref="S3.p9.7.m7.1.1"><leq id="S3.p9.7.m7.1.1.5.cmml" xref="S3.p9.7.m7.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.p9.7.m7.1.1.4.cmml" id="S3.p9.7.m7.1.1d.cmml" xref="S3.p9.7.m7.1.1"></share><apply id="S3.p9.7.m7.1.1.6.cmml" xref="S3.p9.7.m7.1.1.6"><csymbol cd="ambiguous" id="S3.p9.7.m7.1.1.6.1.cmml" xref="S3.p9.7.m7.1.1.6">subscript</csymbol><ci id="S3.p9.7.m7.1.1.6.2.cmml" xref="S3.p9.7.m7.1.1.6.2">𝑖</ci><cn id="S3.p9.7.m7.1.1.6.3.cmml" type="integer" xref="S3.p9.7.m7.1.1.6.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.7.m7.1c">0\leq j\leq i_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.p9.7.m7.1d">0 ≤ italic_j ≤ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>. The extra zeroes added in <math alttext="T_{k}" class="ltx_Math" display="inline" id="S3.p9.8.m8.1"><semantics id="S3.p9.8.m8.1a"><msub id="S3.p9.8.m8.1.1" xref="S3.p9.8.m8.1.1.cmml"><mi id="S3.p9.8.m8.1.1.2" xref="S3.p9.8.m8.1.1.2.cmml">T</mi><mi id="S3.p9.8.m8.1.1.3" xref="S3.p9.8.m8.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p9.8.m8.1b"><apply id="S3.p9.8.m8.1.1.cmml" xref="S3.p9.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p9.8.m8.1.1.1.cmml" xref="S3.p9.8.m8.1.1">subscript</csymbol><ci id="S3.p9.8.m8.1.1.2.cmml" xref="S3.p9.8.m8.1.1.2">𝑇</ci><ci id="S3.p9.8.m8.1.1.3.cmml" xref="S3.p9.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.8.m8.1c">T_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.p9.8.m8.1d">italic_T start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="r=0" class="ltx_Math" display="inline" id="S3.p9.9.m9.1"><semantics id="S3.p9.9.m9.1a"><mrow id="S3.p9.9.m9.1.1" xref="S3.p9.9.m9.1.1.cmml"><mi id="S3.p9.9.m9.1.1.2" xref="S3.p9.9.m9.1.1.2.cmml">r</mi><mo id="S3.p9.9.m9.1.1.1" xref="S3.p9.9.m9.1.1.1.cmml">=</mo><mn id="S3.p9.9.m9.1.1.3" xref="S3.p9.9.m9.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.9.m9.1b"><apply id="S3.p9.9.m9.1.1.cmml" xref="S3.p9.9.m9.1.1"><eq id="S3.p9.9.m9.1.1.1.cmml" xref="S3.p9.9.m9.1.1.1"></eq><ci id="S3.p9.9.m9.1.1.2.cmml" xref="S3.p9.9.m9.1.1.2">𝑟</ci><cn id="S3.p9.9.m9.1.1.3.cmml" type="integer" xref="S3.p9.9.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.9.m9.1c">r=0</annotation><annotation encoding="application/x-llamapun" id="S3.p9.9.m9.1d">italic_r = 0</annotation></semantics></math> allow us to maintain the dimension of <math alttext="T_{K}[r,\cdot,\cdot]" class="ltx_Math" display="inline" id="S3.p9.10.m10.3"><semantics id="S3.p9.10.m10.3a"><mrow id="S3.p9.10.m10.3.4" xref="S3.p9.10.m10.3.4.cmml"><msub id="S3.p9.10.m10.3.4.2" xref="S3.p9.10.m10.3.4.2.cmml"><mi id="S3.p9.10.m10.3.4.2.2" xref="S3.p9.10.m10.3.4.2.2.cmml">T</mi><mi id="S3.p9.10.m10.3.4.2.3" xref="S3.p9.10.m10.3.4.2.3.cmml">K</mi></msub><mo id="S3.p9.10.m10.3.4.1" xref="S3.p9.10.m10.3.4.1.cmml">⁢</mo><mrow id="S3.p9.10.m10.3.4.3.2" xref="S3.p9.10.m10.3.4.3.1.cmml"><mo id="S3.p9.10.m10.3.4.3.2.1" stretchy="false" xref="S3.p9.10.m10.3.4.3.1.cmml">[</mo><mi id="S3.p9.10.m10.1.1" xref="S3.p9.10.m10.1.1.cmml">r</mi><mo id="S3.p9.10.m10.3.4.3.2.2" rspace="0em" xref="S3.p9.10.m10.3.4.3.1.cmml">,</mo><mo id="S3.p9.10.m10.2.2" lspace="0em" rspace="0em" xref="S3.p9.10.m10.2.2.cmml">⋅</mo><mo id="S3.p9.10.m10.3.4.3.2.3" rspace="0em" xref="S3.p9.10.m10.3.4.3.1.cmml">,</mo><mo id="S3.p9.10.m10.3.3" lspace="0em" rspace="0em" xref="S3.p9.10.m10.3.3.cmml">⋅</mo><mo id="S3.p9.10.m10.3.4.3.2.4" stretchy="false" xref="S3.p9.10.m10.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.10.m10.3b"><apply id="S3.p9.10.m10.3.4.cmml" xref="S3.p9.10.m10.3.4"><times id="S3.p9.10.m10.3.4.1.cmml" xref="S3.p9.10.m10.3.4.1"></times><apply id="S3.p9.10.m10.3.4.2.cmml" xref="S3.p9.10.m10.3.4.2"><csymbol cd="ambiguous" id="S3.p9.10.m10.3.4.2.1.cmml" xref="S3.p9.10.m10.3.4.2">subscript</csymbol><ci id="S3.p9.10.m10.3.4.2.2.cmml" xref="S3.p9.10.m10.3.4.2.2">𝑇</ci><ci id="S3.p9.10.m10.3.4.2.3.cmml" xref="S3.p9.10.m10.3.4.2.3">𝐾</ci></apply><list id="S3.p9.10.m10.3.4.3.1.cmml" xref="S3.p9.10.m10.3.4.3.2"><ci id="S3.p9.10.m10.1.1.cmml" xref="S3.p9.10.m10.1.1">𝑟</ci><ci id="S3.p9.10.m10.2.2.cmml" xref="S3.p9.10.m10.2.2">⋅</ci><ci id="S3.p9.10.m10.3.3.cmml" xref="S3.p9.10.m10.3.3">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.10.m10.3c">T_{K}[r,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.p9.10.m10.3d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ]</annotation></semantics></math> across all values of <math alttext="r" class="ltx_Math" display="inline" id="S3.p9.11.m11.1"><semantics id="S3.p9.11.m11.1a"><mi id="S3.p9.11.m11.1.1" xref="S3.p9.11.m11.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.p9.11.m11.1b"><ci id="S3.p9.11.m11.1.1.cmml" xref="S3.p9.11.m11.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.11.m11.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.p9.11.m11.1d">italic_r</annotation></semantics></math>. <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm2" title="Lemma 2. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Lemma</span> <span class="ltx_text ltx_ref_tag">2</span></a> allows us to go back and forth between the indexes <math alttext="(i,j)" class="ltx_Math" display="inline" id="S3.p9.12.m12.2"><semantics id="S3.p9.12.m12.2a"><mrow id="S3.p9.12.m12.2.3.2" xref="S3.p9.12.m12.2.3.1.cmml"><mo id="S3.p9.12.m12.2.3.2.1" stretchy="false" xref="S3.p9.12.m12.2.3.1.cmml">(</mo><mi id="S3.p9.12.m12.1.1" xref="S3.p9.12.m12.1.1.cmml">i</mi><mo id="S3.p9.12.m12.2.3.2.2" xref="S3.p9.12.m12.2.3.1.cmml">,</mo><mi id="S3.p9.12.m12.2.2" xref="S3.p9.12.m12.2.2.cmml">j</mi><mo id="S3.p9.12.m12.2.3.2.3" stretchy="false" xref="S3.p9.12.m12.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.12.m12.2b"><interval closure="open" id="S3.p9.12.m12.2.3.1.cmml" xref="S3.p9.12.m12.2.3.2"><ci id="S3.p9.12.m12.1.1.cmml" xref="S3.p9.12.m12.1.1">𝑖</ci><ci id="S3.p9.12.m12.2.2.cmml" xref="S3.p9.12.m12.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.12.m12.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="S3.p9.12.m12.2d">( italic_i , italic_j )</annotation></semantics></math> and <math alttext="(i_{1},j_{1})" class="ltx_Math" display="inline" id="S3.p9.13.m13.2"><semantics id="S3.p9.13.m13.2a"><mrow id="S3.p9.13.m13.2.2.2" xref="S3.p9.13.m13.2.2.3.cmml"><mo id="S3.p9.13.m13.2.2.2.3" stretchy="false" xref="S3.p9.13.m13.2.2.3.cmml">(</mo><msub id="S3.p9.13.m13.1.1.1.1" xref="S3.p9.13.m13.1.1.1.1.cmml"><mi id="S3.p9.13.m13.1.1.1.1.2" xref="S3.p9.13.m13.1.1.1.1.2.cmml">i</mi><mn id="S3.p9.13.m13.1.1.1.1.3" xref="S3.p9.13.m13.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.p9.13.m13.2.2.2.4" xref="S3.p9.13.m13.2.2.3.cmml">,</mo><msub id="S3.p9.13.m13.2.2.2.2" xref="S3.p9.13.m13.2.2.2.2.cmml"><mi id="S3.p9.13.m13.2.2.2.2.2" xref="S3.p9.13.m13.2.2.2.2.2.cmml">j</mi><mn id="S3.p9.13.m13.2.2.2.2.3" xref="S3.p9.13.m13.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.p9.13.m13.2.2.2.5" stretchy="false" xref="S3.p9.13.m13.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.13.m13.2b"><interval closure="open" id="S3.p9.13.m13.2.2.3.cmml" xref="S3.p9.13.m13.2.2.2"><apply id="S3.p9.13.m13.1.1.1.1.cmml" xref="S3.p9.13.m13.1.1.1.1"><csymbol cd="ambiguous" id="S3.p9.13.m13.1.1.1.1.1.cmml" xref="S3.p9.13.m13.1.1.1.1">subscript</csymbol><ci id="S3.p9.13.m13.1.1.1.1.2.cmml" xref="S3.p9.13.m13.1.1.1.1.2">𝑖</ci><cn id="S3.p9.13.m13.1.1.1.1.3.cmml" type="integer" xref="S3.p9.13.m13.1.1.1.1.3">1</cn></apply><apply id="S3.p9.13.m13.2.2.2.2.cmml" xref="S3.p9.13.m13.2.2.2.2"><csymbol cd="ambiguous" id="S3.p9.13.m13.2.2.2.2.1.cmml" xref="S3.p9.13.m13.2.2.2.2">subscript</csymbol><ci id="S3.p9.13.m13.2.2.2.2.2.cmml" xref="S3.p9.13.m13.2.2.2.2.2">𝑗</ci><cn id="S3.p9.13.m13.2.2.2.2.3.cmml" type="integer" xref="S3.p9.13.m13.2.2.2.2.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.13.m13.2c">(i_{1},j_{1})</annotation><annotation encoding="application/x-llamapun" id="S3.p9.13.m13.2d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math> for the changes of variables <math alttext="i=rL+i_{1}" class="ltx_Math" display="inline" id="S3.p9.14.m14.1"><semantics id="S3.p9.14.m14.1a"><mrow id="S3.p9.14.m14.1.1" xref="S3.p9.14.m14.1.1.cmml"><mi id="S3.p9.14.m14.1.1.2" xref="S3.p9.14.m14.1.1.2.cmml">i</mi><mo id="S3.p9.14.m14.1.1.1" xref="S3.p9.14.m14.1.1.1.cmml">=</mo><mrow id="S3.p9.14.m14.1.1.3" xref="S3.p9.14.m14.1.1.3.cmml"><mrow id="S3.p9.14.m14.1.1.3.2" xref="S3.p9.14.m14.1.1.3.2.cmml"><mi id="S3.p9.14.m14.1.1.3.2.2" xref="S3.p9.14.m14.1.1.3.2.2.cmml">r</mi><mo id="S3.p9.14.m14.1.1.3.2.1" xref="S3.p9.14.m14.1.1.3.2.1.cmml">⁢</mo><mi id="S3.p9.14.m14.1.1.3.2.3" xref="S3.p9.14.m14.1.1.3.2.3.cmml">L</mi></mrow><mo id="S3.p9.14.m14.1.1.3.1" xref="S3.p9.14.m14.1.1.3.1.cmml">+</mo><msub id="S3.p9.14.m14.1.1.3.3" xref="S3.p9.14.m14.1.1.3.3.cmml"><mi id="S3.p9.14.m14.1.1.3.3.2" xref="S3.p9.14.m14.1.1.3.3.2.cmml">i</mi><mn id="S3.p9.14.m14.1.1.3.3.3" xref="S3.p9.14.m14.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.14.m14.1b"><apply id="S3.p9.14.m14.1.1.cmml" xref="S3.p9.14.m14.1.1"><eq id="S3.p9.14.m14.1.1.1.cmml" xref="S3.p9.14.m14.1.1.1"></eq><ci id="S3.p9.14.m14.1.1.2.cmml" xref="S3.p9.14.m14.1.1.2">𝑖</ci><apply id="S3.p9.14.m14.1.1.3.cmml" xref="S3.p9.14.m14.1.1.3"><plus id="S3.p9.14.m14.1.1.3.1.cmml" xref="S3.p9.14.m14.1.1.3.1"></plus><apply id="S3.p9.14.m14.1.1.3.2.cmml" xref="S3.p9.14.m14.1.1.3.2"><times id="S3.p9.14.m14.1.1.3.2.1.cmml" xref="S3.p9.14.m14.1.1.3.2.1"></times><ci id="S3.p9.14.m14.1.1.3.2.2.cmml" xref="S3.p9.14.m14.1.1.3.2.2">𝑟</ci><ci id="S3.p9.14.m14.1.1.3.2.3.cmml" xref="S3.p9.14.m14.1.1.3.2.3">𝐿</ci></apply><apply id="S3.p9.14.m14.1.1.3.3.cmml" xref="S3.p9.14.m14.1.1.3.3"><csymbol cd="ambiguous" id="S3.p9.14.m14.1.1.3.3.1.cmml" xref="S3.p9.14.m14.1.1.3.3">subscript</csymbol><ci id="S3.p9.14.m14.1.1.3.3.2.cmml" xref="S3.p9.14.m14.1.1.3.3.2">𝑖</ci><cn id="S3.p9.14.m14.1.1.3.3.3.cmml" type="integer" xref="S3.p9.14.m14.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.14.m14.1c">i=rL+i_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.p9.14.m14.1d">italic_i = italic_r italic_L + italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="j=(r-1)L+1+j_{1}" class="ltx_Math" display="inline" id="S3.p9.15.m15.1"><semantics id="S3.p9.15.m15.1a"><mrow id="S3.p9.15.m15.1.1" xref="S3.p9.15.m15.1.1.cmml"><mi id="S3.p9.15.m15.1.1.3" xref="S3.p9.15.m15.1.1.3.cmml">j</mi><mo id="S3.p9.15.m15.1.1.2" xref="S3.p9.15.m15.1.1.2.cmml">=</mo><mrow id="S3.p9.15.m15.1.1.1" xref="S3.p9.15.m15.1.1.1.cmml"><mrow id="S3.p9.15.m15.1.1.1.1" xref="S3.p9.15.m15.1.1.1.1.cmml"><mrow id="S3.p9.15.m15.1.1.1.1.1.1" xref="S3.p9.15.m15.1.1.1.1.1.1.1.cmml"><mo id="S3.p9.15.m15.1.1.1.1.1.1.2" stretchy="false" xref="S3.p9.15.m15.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p9.15.m15.1.1.1.1.1.1.1" xref="S3.p9.15.m15.1.1.1.1.1.1.1.cmml"><mi id="S3.p9.15.m15.1.1.1.1.1.1.1.2" xref="S3.p9.15.m15.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.p9.15.m15.1.1.1.1.1.1.1.1" xref="S3.p9.15.m15.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.p9.15.m15.1.1.1.1.1.1.1.3" xref="S3.p9.15.m15.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p9.15.m15.1.1.1.1.1.1.3" stretchy="false" xref="S3.p9.15.m15.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p9.15.m15.1.1.1.1.2" xref="S3.p9.15.m15.1.1.1.1.2.cmml">⁢</mo><mi id="S3.p9.15.m15.1.1.1.1.3" xref="S3.p9.15.m15.1.1.1.1.3.cmml">L</mi></mrow><mo id="S3.p9.15.m15.1.1.1.2" xref="S3.p9.15.m15.1.1.1.2.cmml">+</mo><mn id="S3.p9.15.m15.1.1.1.3" xref="S3.p9.15.m15.1.1.1.3.cmml">1</mn><mo id="S3.p9.15.m15.1.1.1.2a" xref="S3.p9.15.m15.1.1.1.2.cmml">+</mo><msub id="S3.p9.15.m15.1.1.1.4" xref="S3.p9.15.m15.1.1.1.4.cmml"><mi id="S3.p9.15.m15.1.1.1.4.2" xref="S3.p9.15.m15.1.1.1.4.2.cmml">j</mi><mn id="S3.p9.15.m15.1.1.1.4.3" xref="S3.p9.15.m15.1.1.1.4.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.15.m15.1b"><apply id="S3.p9.15.m15.1.1.cmml" xref="S3.p9.15.m15.1.1"><eq id="S3.p9.15.m15.1.1.2.cmml" xref="S3.p9.15.m15.1.1.2"></eq><ci id="S3.p9.15.m15.1.1.3.cmml" xref="S3.p9.15.m15.1.1.3">𝑗</ci><apply id="S3.p9.15.m15.1.1.1.cmml" xref="S3.p9.15.m15.1.1.1"><plus id="S3.p9.15.m15.1.1.1.2.cmml" xref="S3.p9.15.m15.1.1.1.2"></plus><apply id="S3.p9.15.m15.1.1.1.1.cmml" xref="S3.p9.15.m15.1.1.1.1"><times id="S3.p9.15.m15.1.1.1.1.2.cmml" xref="S3.p9.15.m15.1.1.1.1.2"></times><apply id="S3.p9.15.m15.1.1.1.1.1.1.1.cmml" xref="S3.p9.15.m15.1.1.1.1.1.1"><minus id="S3.p9.15.m15.1.1.1.1.1.1.1.1.cmml" xref="S3.p9.15.m15.1.1.1.1.1.1.1.1"></minus><ci id="S3.p9.15.m15.1.1.1.1.1.1.1.2.cmml" xref="S3.p9.15.m15.1.1.1.1.1.1.1.2">𝑟</ci><cn id="S3.p9.15.m15.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.p9.15.m15.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.p9.15.m15.1.1.1.1.3.cmml" xref="S3.p9.15.m15.1.1.1.1.3">𝐿</ci></apply><cn id="S3.p9.15.m15.1.1.1.3.cmml" type="integer" xref="S3.p9.15.m15.1.1.1.3">1</cn><apply id="S3.p9.15.m15.1.1.1.4.cmml" xref="S3.p9.15.m15.1.1.1.4"><csymbol cd="ambiguous" id="S3.p9.15.m15.1.1.1.4.1.cmml" xref="S3.p9.15.m15.1.1.1.4">subscript</csymbol><ci id="S3.p9.15.m15.1.1.1.4.2.cmml" xref="S3.p9.15.m15.1.1.1.4.2">𝑗</ci><cn id="S3.p9.15.m15.1.1.1.4.3.cmml" type="integer" xref="S3.p9.15.m15.1.1.1.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.15.m15.1c">j=(r-1)L+1+j_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.p9.15.m15.1d">italic_j = ( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmthm2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm2.1.1.1">Lemma 2</span></span><span class="ltx_text ltx_font_bold" id="Thmthm2.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm2.p1">
<p class="ltx_p" id="Thmthm2.p1.7"><span class="ltx_text ltx_font_italic" id="Thmthm2.p1.7.7">Let <math alttext="r\in\{0,1,\ldots,s-1\}" class="ltx_Math" display="inline" id="Thmthm2.p1.1.1.m1.4"><semantics id="Thmthm2.p1.1.1.m1.4a"><mrow id="Thmthm2.p1.1.1.m1.4.4" xref="Thmthm2.p1.1.1.m1.4.4.cmml"><mi id="Thmthm2.p1.1.1.m1.4.4.3" xref="Thmthm2.p1.1.1.m1.4.4.3.cmml">r</mi><mo id="Thmthm2.p1.1.1.m1.4.4.2" xref="Thmthm2.p1.1.1.m1.4.4.2.cmml">∈</mo><mrow id="Thmthm2.p1.1.1.m1.4.4.1.1" xref="Thmthm2.p1.1.1.m1.4.4.1.2.cmml"><mo id="Thmthm2.p1.1.1.m1.4.4.1.1.2" stretchy="false" xref="Thmthm2.p1.1.1.m1.4.4.1.2.cmml">{</mo><mn id="Thmthm2.p1.1.1.m1.1.1" xref="Thmthm2.p1.1.1.m1.1.1.cmml">0</mn><mo id="Thmthm2.p1.1.1.m1.4.4.1.1.3" xref="Thmthm2.p1.1.1.m1.4.4.1.2.cmml">,</mo><mn id="Thmthm2.p1.1.1.m1.2.2" xref="Thmthm2.p1.1.1.m1.2.2.cmml">1</mn><mo id="Thmthm2.p1.1.1.m1.4.4.1.1.4" xref="Thmthm2.p1.1.1.m1.4.4.1.2.cmml">,</mo><mi id="Thmthm2.p1.1.1.m1.3.3" mathvariant="normal" xref="Thmthm2.p1.1.1.m1.3.3.cmml">…</mi><mo id="Thmthm2.p1.1.1.m1.4.4.1.1.5" xref="Thmthm2.p1.1.1.m1.4.4.1.2.cmml">,</mo><mrow id="Thmthm2.p1.1.1.m1.4.4.1.1.1" xref="Thmthm2.p1.1.1.m1.4.4.1.1.1.cmml"><mi id="Thmthm2.p1.1.1.m1.4.4.1.1.1.2" xref="Thmthm2.p1.1.1.m1.4.4.1.1.1.2.cmml">s</mi><mo id="Thmthm2.p1.1.1.m1.4.4.1.1.1.1" xref="Thmthm2.p1.1.1.m1.4.4.1.1.1.1.cmml">−</mo><mn id="Thmthm2.p1.1.1.m1.4.4.1.1.1.3" xref="Thmthm2.p1.1.1.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm2.p1.1.1.m1.4.4.1.1.6" stretchy="false" xref="Thmthm2.p1.1.1.m1.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.1.1.m1.4b"><apply id="Thmthm2.p1.1.1.m1.4.4.cmml" xref="Thmthm2.p1.1.1.m1.4.4"><in id="Thmthm2.p1.1.1.m1.4.4.2.cmml" xref="Thmthm2.p1.1.1.m1.4.4.2"></in><ci id="Thmthm2.p1.1.1.m1.4.4.3.cmml" xref="Thmthm2.p1.1.1.m1.4.4.3">𝑟</ci><set id="Thmthm2.p1.1.1.m1.4.4.1.2.cmml" xref="Thmthm2.p1.1.1.m1.4.4.1.1"><cn id="Thmthm2.p1.1.1.m1.1.1.cmml" type="integer" xref="Thmthm2.p1.1.1.m1.1.1">0</cn><cn id="Thmthm2.p1.1.1.m1.2.2.cmml" type="integer" xref="Thmthm2.p1.1.1.m1.2.2">1</cn><ci id="Thmthm2.p1.1.1.m1.3.3.cmml" xref="Thmthm2.p1.1.1.m1.3.3">…</ci><apply id="Thmthm2.p1.1.1.m1.4.4.1.1.1.cmml" xref="Thmthm2.p1.1.1.m1.4.4.1.1.1"><minus id="Thmthm2.p1.1.1.m1.4.4.1.1.1.1.cmml" xref="Thmthm2.p1.1.1.m1.4.4.1.1.1.1"></minus><ci id="Thmthm2.p1.1.1.m1.4.4.1.1.1.2.cmml" xref="Thmthm2.p1.1.1.m1.4.4.1.1.1.2">𝑠</ci><cn id="Thmthm2.p1.1.1.m1.4.4.1.1.1.3.cmml" type="integer" xref="Thmthm2.p1.1.1.m1.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.1.1.m1.4c">r\in\{0,1,\ldots,s-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.1.1.m1.4d">italic_r ∈ { 0 , 1 , … , italic_s - 1 }</annotation></semantics></math>. For each <math alttext="i_{1}\in\{0,1,\ldots,L-1\}" class="ltx_Math" display="inline" id="Thmthm2.p1.2.2.m2.4"><semantics id="Thmthm2.p1.2.2.m2.4a"><mrow id="Thmthm2.p1.2.2.m2.4.4" xref="Thmthm2.p1.2.2.m2.4.4.cmml"><msub id="Thmthm2.p1.2.2.m2.4.4.3" xref="Thmthm2.p1.2.2.m2.4.4.3.cmml"><mi id="Thmthm2.p1.2.2.m2.4.4.3.2" xref="Thmthm2.p1.2.2.m2.4.4.3.2.cmml">i</mi><mn id="Thmthm2.p1.2.2.m2.4.4.3.3" xref="Thmthm2.p1.2.2.m2.4.4.3.3.cmml">1</mn></msub><mo id="Thmthm2.p1.2.2.m2.4.4.2" xref="Thmthm2.p1.2.2.m2.4.4.2.cmml">∈</mo><mrow id="Thmthm2.p1.2.2.m2.4.4.1.1" xref="Thmthm2.p1.2.2.m2.4.4.1.2.cmml"><mo id="Thmthm2.p1.2.2.m2.4.4.1.1.2" stretchy="false" xref="Thmthm2.p1.2.2.m2.4.4.1.2.cmml">{</mo><mn id="Thmthm2.p1.2.2.m2.1.1" xref="Thmthm2.p1.2.2.m2.1.1.cmml">0</mn><mo id="Thmthm2.p1.2.2.m2.4.4.1.1.3" xref="Thmthm2.p1.2.2.m2.4.4.1.2.cmml">,</mo><mn id="Thmthm2.p1.2.2.m2.2.2" xref="Thmthm2.p1.2.2.m2.2.2.cmml">1</mn><mo id="Thmthm2.p1.2.2.m2.4.4.1.1.4" xref="Thmthm2.p1.2.2.m2.4.4.1.2.cmml">,</mo><mi id="Thmthm2.p1.2.2.m2.3.3" mathvariant="normal" xref="Thmthm2.p1.2.2.m2.3.3.cmml">…</mi><mo id="Thmthm2.p1.2.2.m2.4.4.1.1.5" xref="Thmthm2.p1.2.2.m2.4.4.1.2.cmml">,</mo><mrow id="Thmthm2.p1.2.2.m2.4.4.1.1.1" xref="Thmthm2.p1.2.2.m2.4.4.1.1.1.cmml"><mi id="Thmthm2.p1.2.2.m2.4.4.1.1.1.2" xref="Thmthm2.p1.2.2.m2.4.4.1.1.1.2.cmml">L</mi><mo id="Thmthm2.p1.2.2.m2.4.4.1.1.1.1" xref="Thmthm2.p1.2.2.m2.4.4.1.1.1.1.cmml">−</mo><mn id="Thmthm2.p1.2.2.m2.4.4.1.1.1.3" xref="Thmthm2.p1.2.2.m2.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm2.p1.2.2.m2.4.4.1.1.6" stretchy="false" xref="Thmthm2.p1.2.2.m2.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.2.2.m2.4b"><apply id="Thmthm2.p1.2.2.m2.4.4.cmml" xref="Thmthm2.p1.2.2.m2.4.4"><in id="Thmthm2.p1.2.2.m2.4.4.2.cmml" xref="Thmthm2.p1.2.2.m2.4.4.2"></in><apply id="Thmthm2.p1.2.2.m2.4.4.3.cmml" xref="Thmthm2.p1.2.2.m2.4.4.3"><csymbol cd="ambiguous" id="Thmthm2.p1.2.2.m2.4.4.3.1.cmml" xref="Thmthm2.p1.2.2.m2.4.4.3">subscript</csymbol><ci id="Thmthm2.p1.2.2.m2.4.4.3.2.cmml" xref="Thmthm2.p1.2.2.m2.4.4.3.2">𝑖</ci><cn id="Thmthm2.p1.2.2.m2.4.4.3.3.cmml" type="integer" xref="Thmthm2.p1.2.2.m2.4.4.3.3">1</cn></apply><set id="Thmthm2.p1.2.2.m2.4.4.1.2.cmml" xref="Thmthm2.p1.2.2.m2.4.4.1.1"><cn id="Thmthm2.p1.2.2.m2.1.1.cmml" type="integer" xref="Thmthm2.p1.2.2.m2.1.1">0</cn><cn id="Thmthm2.p1.2.2.m2.2.2.cmml" type="integer" xref="Thmthm2.p1.2.2.m2.2.2">1</cn><ci id="Thmthm2.p1.2.2.m2.3.3.cmml" xref="Thmthm2.p1.2.2.m2.3.3">…</ci><apply id="Thmthm2.p1.2.2.m2.4.4.1.1.1.cmml" xref="Thmthm2.p1.2.2.m2.4.4.1.1.1"><minus id="Thmthm2.p1.2.2.m2.4.4.1.1.1.1.cmml" xref="Thmthm2.p1.2.2.m2.4.4.1.1.1.1"></minus><ci id="Thmthm2.p1.2.2.m2.4.4.1.1.1.2.cmml" xref="Thmthm2.p1.2.2.m2.4.4.1.1.1.2">𝐿</ci><cn id="Thmthm2.p1.2.2.m2.4.4.1.1.1.3.cmml" type="integer" xref="Thmthm2.p1.2.2.m2.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.2.2.m2.4c">i_{1}\in\{0,1,\ldots,L-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.2.2.m2.4d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , italic_L - 1 }</annotation></semantics></math> and <math alttext="j_{1}\in\{0,1,\ldots,2L-2\}" class="ltx_Math" display="inline" id="Thmthm2.p1.3.3.m3.4"><semantics id="Thmthm2.p1.3.3.m3.4a"><mrow id="Thmthm2.p1.3.3.m3.4.4" xref="Thmthm2.p1.3.3.m3.4.4.cmml"><msub id="Thmthm2.p1.3.3.m3.4.4.3" xref="Thmthm2.p1.3.3.m3.4.4.3.cmml"><mi id="Thmthm2.p1.3.3.m3.4.4.3.2" xref="Thmthm2.p1.3.3.m3.4.4.3.2.cmml">j</mi><mn id="Thmthm2.p1.3.3.m3.4.4.3.3" xref="Thmthm2.p1.3.3.m3.4.4.3.3.cmml">1</mn></msub><mo id="Thmthm2.p1.3.3.m3.4.4.2" xref="Thmthm2.p1.3.3.m3.4.4.2.cmml">∈</mo><mrow id="Thmthm2.p1.3.3.m3.4.4.1.1" xref="Thmthm2.p1.3.3.m3.4.4.1.2.cmml"><mo id="Thmthm2.p1.3.3.m3.4.4.1.1.2" stretchy="false" xref="Thmthm2.p1.3.3.m3.4.4.1.2.cmml">{</mo><mn id="Thmthm2.p1.3.3.m3.1.1" xref="Thmthm2.p1.3.3.m3.1.1.cmml">0</mn><mo id="Thmthm2.p1.3.3.m3.4.4.1.1.3" xref="Thmthm2.p1.3.3.m3.4.4.1.2.cmml">,</mo><mn id="Thmthm2.p1.3.3.m3.2.2" xref="Thmthm2.p1.3.3.m3.2.2.cmml">1</mn><mo id="Thmthm2.p1.3.3.m3.4.4.1.1.4" xref="Thmthm2.p1.3.3.m3.4.4.1.2.cmml">,</mo><mi id="Thmthm2.p1.3.3.m3.3.3" mathvariant="normal" xref="Thmthm2.p1.3.3.m3.3.3.cmml">…</mi><mo id="Thmthm2.p1.3.3.m3.4.4.1.1.5" xref="Thmthm2.p1.3.3.m3.4.4.1.2.cmml">,</mo><mrow id="Thmthm2.p1.3.3.m3.4.4.1.1.1" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.cmml"><mrow id="Thmthm2.p1.3.3.m3.4.4.1.1.1.2" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.cmml"><mn id="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.2" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.2.cmml">2</mn><mo id="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.1" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.3" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.3.cmml">L</mi></mrow><mo id="Thmthm2.p1.3.3.m3.4.4.1.1.1.1" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.1.cmml">−</mo><mn id="Thmthm2.p1.3.3.m3.4.4.1.1.1.3" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="Thmthm2.p1.3.3.m3.4.4.1.1.6" stretchy="false" xref="Thmthm2.p1.3.3.m3.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.3.3.m3.4b"><apply id="Thmthm2.p1.3.3.m3.4.4.cmml" xref="Thmthm2.p1.3.3.m3.4.4"><in id="Thmthm2.p1.3.3.m3.4.4.2.cmml" xref="Thmthm2.p1.3.3.m3.4.4.2"></in><apply id="Thmthm2.p1.3.3.m3.4.4.3.cmml" xref="Thmthm2.p1.3.3.m3.4.4.3"><csymbol cd="ambiguous" id="Thmthm2.p1.3.3.m3.4.4.3.1.cmml" xref="Thmthm2.p1.3.3.m3.4.4.3">subscript</csymbol><ci id="Thmthm2.p1.3.3.m3.4.4.3.2.cmml" xref="Thmthm2.p1.3.3.m3.4.4.3.2">𝑗</ci><cn id="Thmthm2.p1.3.3.m3.4.4.3.3.cmml" type="integer" xref="Thmthm2.p1.3.3.m3.4.4.3.3">1</cn></apply><set id="Thmthm2.p1.3.3.m3.4.4.1.2.cmml" xref="Thmthm2.p1.3.3.m3.4.4.1.1"><cn id="Thmthm2.p1.3.3.m3.1.1.cmml" type="integer" xref="Thmthm2.p1.3.3.m3.1.1">0</cn><cn id="Thmthm2.p1.3.3.m3.2.2.cmml" type="integer" xref="Thmthm2.p1.3.3.m3.2.2">1</cn><ci id="Thmthm2.p1.3.3.m3.3.3.cmml" xref="Thmthm2.p1.3.3.m3.3.3">…</ci><apply id="Thmthm2.p1.3.3.m3.4.4.1.1.1.cmml" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1"><minus id="Thmthm2.p1.3.3.m3.4.4.1.1.1.1.cmml" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.1"></minus><apply id="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.cmml" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.2"><times id="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.1.cmml" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.1"></times><cn id="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.2.cmml" type="integer" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.2">2</cn><ci id="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.3.cmml" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.2.3">𝐿</ci></apply><cn id="Thmthm2.p1.3.3.m3.4.4.1.1.1.3.cmml" type="integer" xref="Thmthm2.p1.3.3.m3.4.4.1.1.1.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.3.3.m3.4c">j_{1}\in\{0,1,\ldots,2L-2\}</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.3.3.m3.4d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , 2 italic_L - 2 }</annotation></semantics></math>, let <math alttext="i=rL+i_{1}" class="ltx_Math" display="inline" id="Thmthm2.p1.4.4.m4.1"><semantics id="Thmthm2.p1.4.4.m4.1a"><mrow id="Thmthm2.p1.4.4.m4.1.1" xref="Thmthm2.p1.4.4.m4.1.1.cmml"><mi id="Thmthm2.p1.4.4.m4.1.1.2" xref="Thmthm2.p1.4.4.m4.1.1.2.cmml">i</mi><mo id="Thmthm2.p1.4.4.m4.1.1.1" xref="Thmthm2.p1.4.4.m4.1.1.1.cmml">=</mo><mrow id="Thmthm2.p1.4.4.m4.1.1.3" xref="Thmthm2.p1.4.4.m4.1.1.3.cmml"><mrow id="Thmthm2.p1.4.4.m4.1.1.3.2" xref="Thmthm2.p1.4.4.m4.1.1.3.2.cmml"><mi id="Thmthm2.p1.4.4.m4.1.1.3.2.2" xref="Thmthm2.p1.4.4.m4.1.1.3.2.2.cmml">r</mi><mo id="Thmthm2.p1.4.4.m4.1.1.3.2.1" xref="Thmthm2.p1.4.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="Thmthm2.p1.4.4.m4.1.1.3.2.3" xref="Thmthm2.p1.4.4.m4.1.1.3.2.3.cmml">L</mi></mrow><mo id="Thmthm2.p1.4.4.m4.1.1.3.1" xref="Thmthm2.p1.4.4.m4.1.1.3.1.cmml">+</mo><msub id="Thmthm2.p1.4.4.m4.1.1.3.3" xref="Thmthm2.p1.4.4.m4.1.1.3.3.cmml"><mi id="Thmthm2.p1.4.4.m4.1.1.3.3.2" xref="Thmthm2.p1.4.4.m4.1.1.3.3.2.cmml">i</mi><mn id="Thmthm2.p1.4.4.m4.1.1.3.3.3" xref="Thmthm2.p1.4.4.m4.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.4.4.m4.1b"><apply id="Thmthm2.p1.4.4.m4.1.1.cmml" xref="Thmthm2.p1.4.4.m4.1.1"><eq id="Thmthm2.p1.4.4.m4.1.1.1.cmml" xref="Thmthm2.p1.4.4.m4.1.1.1"></eq><ci id="Thmthm2.p1.4.4.m4.1.1.2.cmml" xref="Thmthm2.p1.4.4.m4.1.1.2">𝑖</ci><apply id="Thmthm2.p1.4.4.m4.1.1.3.cmml" xref="Thmthm2.p1.4.4.m4.1.1.3"><plus id="Thmthm2.p1.4.4.m4.1.1.3.1.cmml" xref="Thmthm2.p1.4.4.m4.1.1.3.1"></plus><apply id="Thmthm2.p1.4.4.m4.1.1.3.2.cmml" xref="Thmthm2.p1.4.4.m4.1.1.3.2"><times id="Thmthm2.p1.4.4.m4.1.1.3.2.1.cmml" xref="Thmthm2.p1.4.4.m4.1.1.3.2.1"></times><ci id="Thmthm2.p1.4.4.m4.1.1.3.2.2.cmml" xref="Thmthm2.p1.4.4.m4.1.1.3.2.2">𝑟</ci><ci id="Thmthm2.p1.4.4.m4.1.1.3.2.3.cmml" xref="Thmthm2.p1.4.4.m4.1.1.3.2.3">𝐿</ci></apply><apply id="Thmthm2.p1.4.4.m4.1.1.3.3.cmml" xref="Thmthm2.p1.4.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="Thmthm2.p1.4.4.m4.1.1.3.3.1.cmml" xref="Thmthm2.p1.4.4.m4.1.1.3.3">subscript</csymbol><ci id="Thmthm2.p1.4.4.m4.1.1.3.3.2.cmml" xref="Thmthm2.p1.4.4.m4.1.1.3.3.2">𝑖</ci><cn id="Thmthm2.p1.4.4.m4.1.1.3.3.3.cmml" type="integer" xref="Thmthm2.p1.4.4.m4.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.4.4.m4.1c">i=rL+i_{1}</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.4.4.m4.1d">italic_i = italic_r italic_L + italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="j=(r-1)L+1+j_{1}" class="ltx_Math" display="inline" id="Thmthm2.p1.5.5.m5.1"><semantics id="Thmthm2.p1.5.5.m5.1a"><mrow id="Thmthm2.p1.5.5.m5.1.1" xref="Thmthm2.p1.5.5.m5.1.1.cmml"><mi id="Thmthm2.p1.5.5.m5.1.1.3" xref="Thmthm2.p1.5.5.m5.1.1.3.cmml">j</mi><mo id="Thmthm2.p1.5.5.m5.1.1.2" xref="Thmthm2.p1.5.5.m5.1.1.2.cmml">=</mo><mrow id="Thmthm2.p1.5.5.m5.1.1.1" xref="Thmthm2.p1.5.5.m5.1.1.1.cmml"><mrow id="Thmthm2.p1.5.5.m5.1.1.1.1" xref="Thmthm2.p1.5.5.m5.1.1.1.1.cmml"><mrow id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.cmml"><mo id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.2" stretchy="false" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.cmml"><mi id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.2" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.1" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.3" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.3" stretchy="false" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmthm2.p1.5.5.m5.1.1.1.1.2" xref="Thmthm2.p1.5.5.m5.1.1.1.1.2.cmml">⁢</mo><mi id="Thmthm2.p1.5.5.m5.1.1.1.1.3" xref="Thmthm2.p1.5.5.m5.1.1.1.1.3.cmml">L</mi></mrow><mo id="Thmthm2.p1.5.5.m5.1.1.1.2" xref="Thmthm2.p1.5.5.m5.1.1.1.2.cmml">+</mo><mn id="Thmthm2.p1.5.5.m5.1.1.1.3" xref="Thmthm2.p1.5.5.m5.1.1.1.3.cmml">1</mn><mo id="Thmthm2.p1.5.5.m5.1.1.1.2a" xref="Thmthm2.p1.5.5.m5.1.1.1.2.cmml">+</mo><msub id="Thmthm2.p1.5.5.m5.1.1.1.4" xref="Thmthm2.p1.5.5.m5.1.1.1.4.cmml"><mi id="Thmthm2.p1.5.5.m5.1.1.1.4.2" xref="Thmthm2.p1.5.5.m5.1.1.1.4.2.cmml">j</mi><mn id="Thmthm2.p1.5.5.m5.1.1.1.4.3" xref="Thmthm2.p1.5.5.m5.1.1.1.4.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.5.5.m5.1b"><apply id="Thmthm2.p1.5.5.m5.1.1.cmml" xref="Thmthm2.p1.5.5.m5.1.1"><eq id="Thmthm2.p1.5.5.m5.1.1.2.cmml" xref="Thmthm2.p1.5.5.m5.1.1.2"></eq><ci id="Thmthm2.p1.5.5.m5.1.1.3.cmml" xref="Thmthm2.p1.5.5.m5.1.1.3">𝑗</ci><apply id="Thmthm2.p1.5.5.m5.1.1.1.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1"><plus id="Thmthm2.p1.5.5.m5.1.1.1.2.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1.2"></plus><apply id="Thmthm2.p1.5.5.m5.1.1.1.1.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1.1"><times id="Thmthm2.p1.5.5.m5.1.1.1.1.2.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1.1.2"></times><apply id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1"><minus id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.1.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.1"></minus><ci id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.2.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.2">𝑟</ci><cn id="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmthm2.p1.5.5.m5.1.1.1.1.1.1.1.3">1</cn></apply><ci id="Thmthm2.p1.5.5.m5.1.1.1.1.3.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1.1.3">𝐿</ci></apply><cn id="Thmthm2.p1.5.5.m5.1.1.1.3.cmml" type="integer" xref="Thmthm2.p1.5.5.m5.1.1.1.3">1</cn><apply id="Thmthm2.p1.5.5.m5.1.1.1.4.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1.4"><csymbol cd="ambiguous" id="Thmthm2.p1.5.5.m5.1.1.1.4.1.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1.4">subscript</csymbol><ci id="Thmthm2.p1.5.5.m5.1.1.1.4.2.cmml" xref="Thmthm2.p1.5.5.m5.1.1.1.4.2">𝑗</ci><cn id="Thmthm2.p1.5.5.m5.1.1.1.4.3.cmml" type="integer" xref="Thmthm2.p1.5.5.m5.1.1.1.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.5.5.m5.1c">j=(r-1)L+1+j_{1}</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.5.5.m5.1d">italic_j = ( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>. We have <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="Thmthm2.p1.6.6.m6.1"><semantics id="Thmthm2.p1.6.6.m6.1a"><mrow id="Thmthm2.p1.6.6.m6.1.1" xref="Thmthm2.p1.6.6.m6.1.1.cmml"><mrow id="Thmthm2.p1.6.6.m6.1.1.2" xref="Thmthm2.p1.6.6.m6.1.1.2.cmml"><mrow id="Thmthm2.p1.6.6.m6.1.1.2.2" xref="Thmthm2.p1.6.6.m6.1.1.2.2.cmml"><mi id="Thmthm2.p1.6.6.m6.1.1.2.2.2" xref="Thmthm2.p1.6.6.m6.1.1.2.2.2.cmml">i</mi><mo id="Thmthm2.p1.6.6.m6.1.1.2.2.1" xref="Thmthm2.p1.6.6.m6.1.1.2.2.1.cmml">−</mo><mi id="Thmthm2.p1.6.6.m6.1.1.2.2.3" xref="Thmthm2.p1.6.6.m6.1.1.2.2.3.cmml">L</mi></mrow><mo id="Thmthm2.p1.6.6.m6.1.1.2.1" xref="Thmthm2.p1.6.6.m6.1.1.2.1.cmml">+</mo><mn id="Thmthm2.p1.6.6.m6.1.1.2.3" xref="Thmthm2.p1.6.6.m6.1.1.2.3.cmml">1</mn></mrow><mo id="Thmthm2.p1.6.6.m6.1.1.3" xref="Thmthm2.p1.6.6.m6.1.1.3.cmml">≤</mo><mi id="Thmthm2.p1.6.6.m6.1.1.4" xref="Thmthm2.p1.6.6.m6.1.1.4.cmml">j</mi><mo id="Thmthm2.p1.6.6.m6.1.1.5" xref="Thmthm2.p1.6.6.m6.1.1.5.cmml">≤</mo><mi id="Thmthm2.p1.6.6.m6.1.1.6" xref="Thmthm2.p1.6.6.m6.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.6.6.m6.1b"><apply id="Thmthm2.p1.6.6.m6.1.1.cmml" xref="Thmthm2.p1.6.6.m6.1.1"><and id="Thmthm2.p1.6.6.m6.1.1a.cmml" xref="Thmthm2.p1.6.6.m6.1.1"></and><apply id="Thmthm2.p1.6.6.m6.1.1b.cmml" xref="Thmthm2.p1.6.6.m6.1.1"><leq id="Thmthm2.p1.6.6.m6.1.1.3.cmml" xref="Thmthm2.p1.6.6.m6.1.1.3"></leq><apply id="Thmthm2.p1.6.6.m6.1.1.2.cmml" xref="Thmthm2.p1.6.6.m6.1.1.2"><plus id="Thmthm2.p1.6.6.m6.1.1.2.1.cmml" xref="Thmthm2.p1.6.6.m6.1.1.2.1"></plus><apply id="Thmthm2.p1.6.6.m6.1.1.2.2.cmml" xref="Thmthm2.p1.6.6.m6.1.1.2.2"><minus id="Thmthm2.p1.6.6.m6.1.1.2.2.1.cmml" xref="Thmthm2.p1.6.6.m6.1.1.2.2.1"></minus><ci id="Thmthm2.p1.6.6.m6.1.1.2.2.2.cmml" xref="Thmthm2.p1.6.6.m6.1.1.2.2.2">𝑖</ci><ci id="Thmthm2.p1.6.6.m6.1.1.2.2.3.cmml" xref="Thmthm2.p1.6.6.m6.1.1.2.2.3">𝐿</ci></apply><cn id="Thmthm2.p1.6.6.m6.1.1.2.3.cmml" type="integer" xref="Thmthm2.p1.6.6.m6.1.1.2.3">1</cn></apply><ci id="Thmthm2.p1.6.6.m6.1.1.4.cmml" xref="Thmthm2.p1.6.6.m6.1.1.4">𝑗</ci></apply><apply id="Thmthm2.p1.6.6.m6.1.1c.cmml" xref="Thmthm2.p1.6.6.m6.1.1"><leq id="Thmthm2.p1.6.6.m6.1.1.5.cmml" xref="Thmthm2.p1.6.6.m6.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#Thmthm2.p1.6.6.m6.1.1.4.cmml" id="Thmthm2.p1.6.6.m6.1.1d.cmml" xref="Thmthm2.p1.6.6.m6.1.1"></share><ci id="Thmthm2.p1.6.6.m6.1.1.6.cmml" xref="Thmthm2.p1.6.6.m6.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.6.6.m6.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.6.6.m6.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math> if and only if <math alttext="i_{1}\leq j_{1}\leq i_{1}+L-1" class="ltx_Math" display="inline" id="Thmthm2.p1.7.7.m7.1"><semantics id="Thmthm2.p1.7.7.m7.1a"><mrow id="Thmthm2.p1.7.7.m7.1.1" xref="Thmthm2.p1.7.7.m7.1.1.cmml"><msub id="Thmthm2.p1.7.7.m7.1.1.2" xref="Thmthm2.p1.7.7.m7.1.1.2.cmml"><mi id="Thmthm2.p1.7.7.m7.1.1.2.2" xref="Thmthm2.p1.7.7.m7.1.1.2.2.cmml">i</mi><mn id="Thmthm2.p1.7.7.m7.1.1.2.3" xref="Thmthm2.p1.7.7.m7.1.1.2.3.cmml">1</mn></msub><mo id="Thmthm2.p1.7.7.m7.1.1.3" xref="Thmthm2.p1.7.7.m7.1.1.3.cmml">≤</mo><msub id="Thmthm2.p1.7.7.m7.1.1.4" xref="Thmthm2.p1.7.7.m7.1.1.4.cmml"><mi id="Thmthm2.p1.7.7.m7.1.1.4.2" xref="Thmthm2.p1.7.7.m7.1.1.4.2.cmml">j</mi><mn id="Thmthm2.p1.7.7.m7.1.1.4.3" xref="Thmthm2.p1.7.7.m7.1.1.4.3.cmml">1</mn></msub><mo id="Thmthm2.p1.7.7.m7.1.1.5" xref="Thmthm2.p1.7.7.m7.1.1.5.cmml">≤</mo><mrow id="Thmthm2.p1.7.7.m7.1.1.6" xref="Thmthm2.p1.7.7.m7.1.1.6.cmml"><mrow id="Thmthm2.p1.7.7.m7.1.1.6.2" xref="Thmthm2.p1.7.7.m7.1.1.6.2.cmml"><msub id="Thmthm2.p1.7.7.m7.1.1.6.2.2" xref="Thmthm2.p1.7.7.m7.1.1.6.2.2.cmml"><mi id="Thmthm2.p1.7.7.m7.1.1.6.2.2.2" xref="Thmthm2.p1.7.7.m7.1.1.6.2.2.2.cmml">i</mi><mn id="Thmthm2.p1.7.7.m7.1.1.6.2.2.3" xref="Thmthm2.p1.7.7.m7.1.1.6.2.2.3.cmml">1</mn></msub><mo id="Thmthm2.p1.7.7.m7.1.1.6.2.1" xref="Thmthm2.p1.7.7.m7.1.1.6.2.1.cmml">+</mo><mi id="Thmthm2.p1.7.7.m7.1.1.6.2.3" xref="Thmthm2.p1.7.7.m7.1.1.6.2.3.cmml">L</mi></mrow><mo id="Thmthm2.p1.7.7.m7.1.1.6.1" xref="Thmthm2.p1.7.7.m7.1.1.6.1.cmml">−</mo><mn id="Thmthm2.p1.7.7.m7.1.1.6.3" xref="Thmthm2.p1.7.7.m7.1.1.6.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm2.p1.7.7.m7.1b"><apply id="Thmthm2.p1.7.7.m7.1.1.cmml" xref="Thmthm2.p1.7.7.m7.1.1"><and id="Thmthm2.p1.7.7.m7.1.1a.cmml" xref="Thmthm2.p1.7.7.m7.1.1"></and><apply id="Thmthm2.p1.7.7.m7.1.1b.cmml" xref="Thmthm2.p1.7.7.m7.1.1"><leq id="Thmthm2.p1.7.7.m7.1.1.3.cmml" xref="Thmthm2.p1.7.7.m7.1.1.3"></leq><apply id="Thmthm2.p1.7.7.m7.1.1.2.cmml" xref="Thmthm2.p1.7.7.m7.1.1.2"><csymbol cd="ambiguous" id="Thmthm2.p1.7.7.m7.1.1.2.1.cmml" xref="Thmthm2.p1.7.7.m7.1.1.2">subscript</csymbol><ci id="Thmthm2.p1.7.7.m7.1.1.2.2.cmml" xref="Thmthm2.p1.7.7.m7.1.1.2.2">𝑖</ci><cn id="Thmthm2.p1.7.7.m7.1.1.2.3.cmml" type="integer" xref="Thmthm2.p1.7.7.m7.1.1.2.3">1</cn></apply><apply id="Thmthm2.p1.7.7.m7.1.1.4.cmml" xref="Thmthm2.p1.7.7.m7.1.1.4"><csymbol cd="ambiguous" id="Thmthm2.p1.7.7.m7.1.1.4.1.cmml" xref="Thmthm2.p1.7.7.m7.1.1.4">subscript</csymbol><ci id="Thmthm2.p1.7.7.m7.1.1.4.2.cmml" xref="Thmthm2.p1.7.7.m7.1.1.4.2">𝑗</ci><cn id="Thmthm2.p1.7.7.m7.1.1.4.3.cmml" type="integer" xref="Thmthm2.p1.7.7.m7.1.1.4.3">1</cn></apply></apply><apply id="Thmthm2.p1.7.7.m7.1.1c.cmml" xref="Thmthm2.p1.7.7.m7.1.1"><leq id="Thmthm2.p1.7.7.m7.1.1.5.cmml" xref="Thmthm2.p1.7.7.m7.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#Thmthm2.p1.7.7.m7.1.1.4.cmml" id="Thmthm2.p1.7.7.m7.1.1d.cmml" xref="Thmthm2.p1.7.7.m7.1.1"></share><apply id="Thmthm2.p1.7.7.m7.1.1.6.cmml" xref="Thmthm2.p1.7.7.m7.1.1.6"><minus id="Thmthm2.p1.7.7.m7.1.1.6.1.cmml" xref="Thmthm2.p1.7.7.m7.1.1.6.1"></minus><apply id="Thmthm2.p1.7.7.m7.1.1.6.2.cmml" xref="Thmthm2.p1.7.7.m7.1.1.6.2"><plus id="Thmthm2.p1.7.7.m7.1.1.6.2.1.cmml" xref="Thmthm2.p1.7.7.m7.1.1.6.2.1"></plus><apply id="Thmthm2.p1.7.7.m7.1.1.6.2.2.cmml" xref="Thmthm2.p1.7.7.m7.1.1.6.2.2"><csymbol cd="ambiguous" id="Thmthm2.p1.7.7.m7.1.1.6.2.2.1.cmml" xref="Thmthm2.p1.7.7.m7.1.1.6.2.2">subscript</csymbol><ci id="Thmthm2.p1.7.7.m7.1.1.6.2.2.2.cmml" xref="Thmthm2.p1.7.7.m7.1.1.6.2.2.2">𝑖</ci><cn id="Thmthm2.p1.7.7.m7.1.1.6.2.2.3.cmml" type="integer" xref="Thmthm2.p1.7.7.m7.1.1.6.2.2.3">1</cn></apply><ci id="Thmthm2.p1.7.7.m7.1.1.6.2.3.cmml" xref="Thmthm2.p1.7.7.m7.1.1.6.2.3">𝐿</ci></apply><cn id="Thmthm2.p1.7.7.m7.1.1.6.3.cmml" type="integer" xref="Thmthm2.p1.7.7.m7.1.1.6.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm2.p1.7.7.m7.1c">i_{1}\leq j_{1}\leq i_{1}+L-1</annotation><annotation encoding="application/x-llamapun" id="Thmthm2.p1.7.7.m7.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_L - 1</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_proof" id="S3.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.1.p1">
<p class="ltx_p" id="S3.1.p1.12">We note that <math alttext="j-i+L-1=j_{1}-i_{1}" class="ltx_Math" display="inline" id="S3.1.p1.1.m1.1"><semantics id="S3.1.p1.1.m1.1a"><mrow id="S3.1.p1.1.m1.1.1" xref="S3.1.p1.1.m1.1.1.cmml"><mrow id="S3.1.p1.1.m1.1.1.2" xref="S3.1.p1.1.m1.1.1.2.cmml"><mrow id="S3.1.p1.1.m1.1.1.2.2" xref="S3.1.p1.1.m1.1.1.2.2.cmml"><mrow id="S3.1.p1.1.m1.1.1.2.2.2" xref="S3.1.p1.1.m1.1.1.2.2.2.cmml"><mi id="S3.1.p1.1.m1.1.1.2.2.2.2" xref="S3.1.p1.1.m1.1.1.2.2.2.2.cmml">j</mi><mo id="S3.1.p1.1.m1.1.1.2.2.2.1" xref="S3.1.p1.1.m1.1.1.2.2.2.1.cmml">−</mo><mi id="S3.1.p1.1.m1.1.1.2.2.2.3" xref="S3.1.p1.1.m1.1.1.2.2.2.3.cmml">i</mi></mrow><mo id="S3.1.p1.1.m1.1.1.2.2.1" xref="S3.1.p1.1.m1.1.1.2.2.1.cmml">+</mo><mi id="S3.1.p1.1.m1.1.1.2.2.3" xref="S3.1.p1.1.m1.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.1.p1.1.m1.1.1.2.1" xref="S3.1.p1.1.m1.1.1.2.1.cmml">−</mo><mn id="S3.1.p1.1.m1.1.1.2.3" xref="S3.1.p1.1.m1.1.1.2.3.cmml">1</mn></mrow><mo id="S3.1.p1.1.m1.1.1.1" xref="S3.1.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.1.p1.1.m1.1.1.3" xref="S3.1.p1.1.m1.1.1.3.cmml"><msub id="S3.1.p1.1.m1.1.1.3.2" xref="S3.1.p1.1.m1.1.1.3.2.cmml"><mi id="S3.1.p1.1.m1.1.1.3.2.2" xref="S3.1.p1.1.m1.1.1.3.2.2.cmml">j</mi><mn id="S3.1.p1.1.m1.1.1.3.2.3" xref="S3.1.p1.1.m1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.1.p1.1.m1.1.1.3.1" xref="S3.1.p1.1.m1.1.1.3.1.cmml">−</mo><msub id="S3.1.p1.1.m1.1.1.3.3" xref="S3.1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.1.p1.1.m1.1.1.3.3.2" xref="S3.1.p1.1.m1.1.1.3.3.2.cmml">i</mi><mn id="S3.1.p1.1.m1.1.1.3.3.3" xref="S3.1.p1.1.m1.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.1.p1.1.m1.1b"><apply id="S3.1.p1.1.m1.1.1.cmml" xref="S3.1.p1.1.m1.1.1"><eq id="S3.1.p1.1.m1.1.1.1.cmml" xref="S3.1.p1.1.m1.1.1.1"></eq><apply id="S3.1.p1.1.m1.1.1.2.cmml" xref="S3.1.p1.1.m1.1.1.2"><minus id="S3.1.p1.1.m1.1.1.2.1.cmml" xref="S3.1.p1.1.m1.1.1.2.1"></minus><apply id="S3.1.p1.1.m1.1.1.2.2.cmml" xref="S3.1.p1.1.m1.1.1.2.2"><plus id="S3.1.p1.1.m1.1.1.2.2.1.cmml" xref="S3.1.p1.1.m1.1.1.2.2.1"></plus><apply id="S3.1.p1.1.m1.1.1.2.2.2.cmml" xref="S3.1.p1.1.m1.1.1.2.2.2"><minus id="S3.1.p1.1.m1.1.1.2.2.2.1.cmml" xref="S3.1.p1.1.m1.1.1.2.2.2.1"></minus><ci id="S3.1.p1.1.m1.1.1.2.2.2.2.cmml" xref="S3.1.p1.1.m1.1.1.2.2.2.2">𝑗</ci><ci id="S3.1.p1.1.m1.1.1.2.2.2.3.cmml" xref="S3.1.p1.1.m1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.1.p1.1.m1.1.1.2.2.3.cmml" xref="S3.1.p1.1.m1.1.1.2.2.3">𝐿</ci></apply><cn id="S3.1.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S3.1.p1.1.m1.1.1.2.3">1</cn></apply><apply id="S3.1.p1.1.m1.1.1.3.cmml" xref="S3.1.p1.1.m1.1.1.3"><minus id="S3.1.p1.1.m1.1.1.3.1.cmml" xref="S3.1.p1.1.m1.1.1.3.1"></minus><apply id="S3.1.p1.1.m1.1.1.3.2.cmml" xref="S3.1.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.1.p1.1.m1.1.1.3.2.1.cmml" xref="S3.1.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.1.p1.1.m1.1.1.3.2.2.cmml" xref="S3.1.p1.1.m1.1.1.3.2.2">𝑗</ci><cn id="S3.1.p1.1.m1.1.1.3.2.3.cmml" type="integer" xref="S3.1.p1.1.m1.1.1.3.2.3">1</cn></apply><apply id="S3.1.p1.1.m1.1.1.3.3.cmml" xref="S3.1.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.1.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S3.1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.1.p1.1.m1.1.1.3.3.2">𝑖</ci><cn id="S3.1.p1.1.m1.1.1.3.3.3.cmml" type="integer" xref="S3.1.p1.1.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.1.m1.1c">j-i+L-1=j_{1}-i_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.1.m1.1d">italic_j - italic_i + italic_L - 1 = italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="i-j=i_{1}+L-1-j_{1}" class="ltx_Math" display="inline" id="S3.1.p1.2.m2.1"><semantics id="S3.1.p1.2.m2.1a"><mrow id="S3.1.p1.2.m2.1.1" xref="S3.1.p1.2.m2.1.1.cmml"><mrow id="S3.1.p1.2.m2.1.1.2" xref="S3.1.p1.2.m2.1.1.2.cmml"><mi id="S3.1.p1.2.m2.1.1.2.2" xref="S3.1.p1.2.m2.1.1.2.2.cmml">i</mi><mo id="S3.1.p1.2.m2.1.1.2.1" xref="S3.1.p1.2.m2.1.1.2.1.cmml">−</mo><mi id="S3.1.p1.2.m2.1.1.2.3" xref="S3.1.p1.2.m2.1.1.2.3.cmml">j</mi></mrow><mo id="S3.1.p1.2.m2.1.1.1" xref="S3.1.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S3.1.p1.2.m2.1.1.3" xref="S3.1.p1.2.m2.1.1.3.cmml"><mrow id="S3.1.p1.2.m2.1.1.3.2" xref="S3.1.p1.2.m2.1.1.3.2.cmml"><msub id="S3.1.p1.2.m2.1.1.3.2.2" xref="S3.1.p1.2.m2.1.1.3.2.2.cmml"><mi id="S3.1.p1.2.m2.1.1.3.2.2.2" xref="S3.1.p1.2.m2.1.1.3.2.2.2.cmml">i</mi><mn id="S3.1.p1.2.m2.1.1.3.2.2.3" xref="S3.1.p1.2.m2.1.1.3.2.2.3.cmml">1</mn></msub><mo id="S3.1.p1.2.m2.1.1.3.2.1" xref="S3.1.p1.2.m2.1.1.3.2.1.cmml">+</mo><mi id="S3.1.p1.2.m2.1.1.3.2.3" xref="S3.1.p1.2.m2.1.1.3.2.3.cmml">L</mi></mrow><mo id="S3.1.p1.2.m2.1.1.3.1" xref="S3.1.p1.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.1.p1.2.m2.1.1.3.3" xref="S3.1.p1.2.m2.1.1.3.3.cmml">1</mn><mo id="S3.1.p1.2.m2.1.1.3.1a" xref="S3.1.p1.2.m2.1.1.3.1.cmml">−</mo><msub id="S3.1.p1.2.m2.1.1.3.4" xref="S3.1.p1.2.m2.1.1.3.4.cmml"><mi id="S3.1.p1.2.m2.1.1.3.4.2" xref="S3.1.p1.2.m2.1.1.3.4.2.cmml">j</mi><mn id="S3.1.p1.2.m2.1.1.3.4.3" xref="S3.1.p1.2.m2.1.1.3.4.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.1.p1.2.m2.1b"><apply id="S3.1.p1.2.m2.1.1.cmml" xref="S3.1.p1.2.m2.1.1"><eq id="S3.1.p1.2.m2.1.1.1.cmml" xref="S3.1.p1.2.m2.1.1.1"></eq><apply id="S3.1.p1.2.m2.1.1.2.cmml" xref="S3.1.p1.2.m2.1.1.2"><minus id="S3.1.p1.2.m2.1.1.2.1.cmml" xref="S3.1.p1.2.m2.1.1.2.1"></minus><ci id="S3.1.p1.2.m2.1.1.2.2.cmml" xref="S3.1.p1.2.m2.1.1.2.2">𝑖</ci><ci id="S3.1.p1.2.m2.1.1.2.3.cmml" xref="S3.1.p1.2.m2.1.1.2.3">𝑗</ci></apply><apply id="S3.1.p1.2.m2.1.1.3.cmml" xref="S3.1.p1.2.m2.1.1.3"><minus id="S3.1.p1.2.m2.1.1.3.1.cmml" xref="S3.1.p1.2.m2.1.1.3.1"></minus><apply id="S3.1.p1.2.m2.1.1.3.2.cmml" xref="S3.1.p1.2.m2.1.1.3.2"><plus id="S3.1.p1.2.m2.1.1.3.2.1.cmml" xref="S3.1.p1.2.m2.1.1.3.2.1"></plus><apply id="S3.1.p1.2.m2.1.1.3.2.2.cmml" xref="S3.1.p1.2.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.1.p1.2.m2.1.1.3.2.2.1.cmml" xref="S3.1.p1.2.m2.1.1.3.2.2">subscript</csymbol><ci id="S3.1.p1.2.m2.1.1.3.2.2.2.cmml" xref="S3.1.p1.2.m2.1.1.3.2.2.2">𝑖</ci><cn id="S3.1.p1.2.m2.1.1.3.2.2.3.cmml" type="integer" xref="S3.1.p1.2.m2.1.1.3.2.2.3">1</cn></apply><ci id="S3.1.p1.2.m2.1.1.3.2.3.cmml" xref="S3.1.p1.2.m2.1.1.3.2.3">𝐿</ci></apply><cn id="S3.1.p1.2.m2.1.1.3.3.cmml" type="integer" xref="S3.1.p1.2.m2.1.1.3.3">1</cn><apply id="S3.1.p1.2.m2.1.1.3.4.cmml" xref="S3.1.p1.2.m2.1.1.3.4"><csymbol cd="ambiguous" id="S3.1.p1.2.m2.1.1.3.4.1.cmml" xref="S3.1.p1.2.m2.1.1.3.4">subscript</csymbol><ci id="S3.1.p1.2.m2.1.1.3.4.2.cmml" xref="S3.1.p1.2.m2.1.1.3.4.2">𝑗</ci><cn id="S3.1.p1.2.m2.1.1.3.4.3.cmml" type="integer" xref="S3.1.p1.2.m2.1.1.3.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.2.m2.1c">i-j=i_{1}+L-1-j_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.2.m2.1d">italic_i - italic_j = italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_L - 1 - italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> by definition of <math alttext="i" class="ltx_Math" display="inline" id="S3.1.p1.3.m3.1"><semantics id="S3.1.p1.3.m3.1a"><mi id="S3.1.p1.3.m3.1.1" xref="S3.1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.1.p1.3.m3.1b"><ci id="S3.1.p1.3.m3.1.1.cmml" xref="S3.1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.3.m3.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S3.1.p1.4.m4.1"><semantics id="S3.1.p1.4.m4.1a"><mi id="S3.1.p1.4.m4.1.1" xref="S3.1.p1.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.1.p1.4.m4.1b"><ci id="S3.1.p1.4.m4.1.1.cmml" xref="S3.1.p1.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.4.m4.1d">italic_j</annotation></semantics></math>. Thus, we have <math alttext="j_{1}-i_{1}\geq 0" class="ltx_Math" display="inline" id="S3.1.p1.5.m5.1"><semantics id="S3.1.p1.5.m5.1a"><mrow id="S3.1.p1.5.m5.1.1" xref="S3.1.p1.5.m5.1.1.cmml"><mrow id="S3.1.p1.5.m5.1.1.2" xref="S3.1.p1.5.m5.1.1.2.cmml"><msub id="S3.1.p1.5.m5.1.1.2.2" xref="S3.1.p1.5.m5.1.1.2.2.cmml"><mi id="S3.1.p1.5.m5.1.1.2.2.2" xref="S3.1.p1.5.m5.1.1.2.2.2.cmml">j</mi><mn id="S3.1.p1.5.m5.1.1.2.2.3" xref="S3.1.p1.5.m5.1.1.2.2.3.cmml">1</mn></msub><mo id="S3.1.p1.5.m5.1.1.2.1" xref="S3.1.p1.5.m5.1.1.2.1.cmml">−</mo><msub id="S3.1.p1.5.m5.1.1.2.3" xref="S3.1.p1.5.m5.1.1.2.3.cmml"><mi id="S3.1.p1.5.m5.1.1.2.3.2" xref="S3.1.p1.5.m5.1.1.2.3.2.cmml">i</mi><mn id="S3.1.p1.5.m5.1.1.2.3.3" xref="S3.1.p1.5.m5.1.1.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.1.p1.5.m5.1.1.1" xref="S3.1.p1.5.m5.1.1.1.cmml">≥</mo><mn id="S3.1.p1.5.m5.1.1.3" xref="S3.1.p1.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.1.p1.5.m5.1b"><apply id="S3.1.p1.5.m5.1.1.cmml" xref="S3.1.p1.5.m5.1.1"><geq id="S3.1.p1.5.m5.1.1.1.cmml" xref="S3.1.p1.5.m5.1.1.1"></geq><apply id="S3.1.p1.5.m5.1.1.2.cmml" xref="S3.1.p1.5.m5.1.1.2"><minus id="S3.1.p1.5.m5.1.1.2.1.cmml" xref="S3.1.p1.5.m5.1.1.2.1"></minus><apply id="S3.1.p1.5.m5.1.1.2.2.cmml" xref="S3.1.p1.5.m5.1.1.2.2"><csymbol cd="ambiguous" id="S3.1.p1.5.m5.1.1.2.2.1.cmml" xref="S3.1.p1.5.m5.1.1.2.2">subscript</csymbol><ci id="S3.1.p1.5.m5.1.1.2.2.2.cmml" xref="S3.1.p1.5.m5.1.1.2.2.2">𝑗</ci><cn id="S3.1.p1.5.m5.1.1.2.2.3.cmml" type="integer" xref="S3.1.p1.5.m5.1.1.2.2.3">1</cn></apply><apply id="S3.1.p1.5.m5.1.1.2.3.cmml" xref="S3.1.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.1.p1.5.m5.1.1.2.3.1.cmml" xref="S3.1.p1.5.m5.1.1.2.3">subscript</csymbol><ci id="S3.1.p1.5.m5.1.1.2.3.2.cmml" xref="S3.1.p1.5.m5.1.1.2.3.2">𝑖</ci><cn id="S3.1.p1.5.m5.1.1.2.3.3.cmml" type="integer" xref="S3.1.p1.5.m5.1.1.2.3.3">1</cn></apply></apply><cn id="S3.1.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.1.p1.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.5.m5.1c">j_{1}-i_{1}\geq 0</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.5.m5.1d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≥ 0</annotation></semantics></math> if and only if <math alttext="j-i+L-1\geq 0" class="ltx_Math" display="inline" id="S3.1.p1.6.m6.1"><semantics id="S3.1.p1.6.m6.1a"><mrow id="S3.1.p1.6.m6.1.1" xref="S3.1.p1.6.m6.1.1.cmml"><mrow id="S3.1.p1.6.m6.1.1.2" xref="S3.1.p1.6.m6.1.1.2.cmml"><mrow id="S3.1.p1.6.m6.1.1.2.2" xref="S3.1.p1.6.m6.1.1.2.2.cmml"><mrow id="S3.1.p1.6.m6.1.1.2.2.2" xref="S3.1.p1.6.m6.1.1.2.2.2.cmml"><mi id="S3.1.p1.6.m6.1.1.2.2.2.2" xref="S3.1.p1.6.m6.1.1.2.2.2.2.cmml">j</mi><mo id="S3.1.p1.6.m6.1.1.2.2.2.1" xref="S3.1.p1.6.m6.1.1.2.2.2.1.cmml">−</mo><mi id="S3.1.p1.6.m6.1.1.2.2.2.3" xref="S3.1.p1.6.m6.1.1.2.2.2.3.cmml">i</mi></mrow><mo id="S3.1.p1.6.m6.1.1.2.2.1" xref="S3.1.p1.6.m6.1.1.2.2.1.cmml">+</mo><mi id="S3.1.p1.6.m6.1.1.2.2.3" xref="S3.1.p1.6.m6.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.1.p1.6.m6.1.1.2.1" xref="S3.1.p1.6.m6.1.1.2.1.cmml">−</mo><mn id="S3.1.p1.6.m6.1.1.2.3" xref="S3.1.p1.6.m6.1.1.2.3.cmml">1</mn></mrow><mo id="S3.1.p1.6.m6.1.1.1" xref="S3.1.p1.6.m6.1.1.1.cmml">≥</mo><mn id="S3.1.p1.6.m6.1.1.3" xref="S3.1.p1.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.1.p1.6.m6.1b"><apply id="S3.1.p1.6.m6.1.1.cmml" xref="S3.1.p1.6.m6.1.1"><geq id="S3.1.p1.6.m6.1.1.1.cmml" xref="S3.1.p1.6.m6.1.1.1"></geq><apply id="S3.1.p1.6.m6.1.1.2.cmml" xref="S3.1.p1.6.m6.1.1.2"><minus id="S3.1.p1.6.m6.1.1.2.1.cmml" xref="S3.1.p1.6.m6.1.1.2.1"></minus><apply id="S3.1.p1.6.m6.1.1.2.2.cmml" xref="S3.1.p1.6.m6.1.1.2.2"><plus id="S3.1.p1.6.m6.1.1.2.2.1.cmml" xref="S3.1.p1.6.m6.1.1.2.2.1"></plus><apply id="S3.1.p1.6.m6.1.1.2.2.2.cmml" xref="S3.1.p1.6.m6.1.1.2.2.2"><minus id="S3.1.p1.6.m6.1.1.2.2.2.1.cmml" xref="S3.1.p1.6.m6.1.1.2.2.2.1"></minus><ci id="S3.1.p1.6.m6.1.1.2.2.2.2.cmml" xref="S3.1.p1.6.m6.1.1.2.2.2.2">𝑗</ci><ci id="S3.1.p1.6.m6.1.1.2.2.2.3.cmml" xref="S3.1.p1.6.m6.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.1.p1.6.m6.1.1.2.2.3.cmml" xref="S3.1.p1.6.m6.1.1.2.2.3">𝐿</ci></apply><cn id="S3.1.p1.6.m6.1.1.2.3.cmml" type="integer" xref="S3.1.p1.6.m6.1.1.2.3">1</cn></apply><cn id="S3.1.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.1.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.6.m6.1c">j-i+L-1\geq 0</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.6.m6.1d">italic_j - italic_i + italic_L - 1 ≥ 0</annotation></semantics></math>. Equivalently, <math alttext="i_{1}\leq j_{1}" class="ltx_Math" display="inline" id="S3.1.p1.7.m7.1"><semantics id="S3.1.p1.7.m7.1a"><mrow id="S3.1.p1.7.m7.1.1" xref="S3.1.p1.7.m7.1.1.cmml"><msub id="S3.1.p1.7.m7.1.1.2" xref="S3.1.p1.7.m7.1.1.2.cmml"><mi id="S3.1.p1.7.m7.1.1.2.2" xref="S3.1.p1.7.m7.1.1.2.2.cmml">i</mi><mn id="S3.1.p1.7.m7.1.1.2.3" xref="S3.1.p1.7.m7.1.1.2.3.cmml">1</mn></msub><mo id="S3.1.p1.7.m7.1.1.1" xref="S3.1.p1.7.m7.1.1.1.cmml">≤</mo><msub id="S3.1.p1.7.m7.1.1.3" xref="S3.1.p1.7.m7.1.1.3.cmml"><mi id="S3.1.p1.7.m7.1.1.3.2" xref="S3.1.p1.7.m7.1.1.3.2.cmml">j</mi><mn id="S3.1.p1.7.m7.1.1.3.3" xref="S3.1.p1.7.m7.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.1.p1.7.m7.1b"><apply id="S3.1.p1.7.m7.1.1.cmml" xref="S3.1.p1.7.m7.1.1"><leq id="S3.1.p1.7.m7.1.1.1.cmml" xref="S3.1.p1.7.m7.1.1.1"></leq><apply id="S3.1.p1.7.m7.1.1.2.cmml" xref="S3.1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.1.p1.7.m7.1.1.2.1.cmml" xref="S3.1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.1.p1.7.m7.1.1.2.2.cmml" xref="S3.1.p1.7.m7.1.1.2.2">𝑖</ci><cn id="S3.1.p1.7.m7.1.1.2.3.cmml" type="integer" xref="S3.1.p1.7.m7.1.1.2.3">1</cn></apply><apply id="S3.1.p1.7.m7.1.1.3.cmml" xref="S3.1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.1.p1.7.m7.1.1.3.1.cmml" xref="S3.1.p1.7.m7.1.1.3">subscript</csymbol><ci id="S3.1.p1.7.m7.1.1.3.2.cmml" xref="S3.1.p1.7.m7.1.1.3.2">𝑗</ci><cn id="S3.1.p1.7.m7.1.1.3.3.cmml" type="integer" xref="S3.1.p1.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.7.m7.1c">i_{1}\leq j_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.7.m7.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> if and only if <math alttext="i-L+1\leq j" class="ltx_Math" display="inline" id="S3.1.p1.8.m8.1"><semantics id="S3.1.p1.8.m8.1a"><mrow id="S3.1.p1.8.m8.1.1" xref="S3.1.p1.8.m8.1.1.cmml"><mrow id="S3.1.p1.8.m8.1.1.2" xref="S3.1.p1.8.m8.1.1.2.cmml"><mrow id="S3.1.p1.8.m8.1.1.2.2" xref="S3.1.p1.8.m8.1.1.2.2.cmml"><mi id="S3.1.p1.8.m8.1.1.2.2.2" xref="S3.1.p1.8.m8.1.1.2.2.2.cmml">i</mi><mo id="S3.1.p1.8.m8.1.1.2.2.1" xref="S3.1.p1.8.m8.1.1.2.2.1.cmml">−</mo><mi id="S3.1.p1.8.m8.1.1.2.2.3" xref="S3.1.p1.8.m8.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.1.p1.8.m8.1.1.2.1" xref="S3.1.p1.8.m8.1.1.2.1.cmml">+</mo><mn id="S3.1.p1.8.m8.1.1.2.3" xref="S3.1.p1.8.m8.1.1.2.3.cmml">1</mn></mrow><mo id="S3.1.p1.8.m8.1.1.1" xref="S3.1.p1.8.m8.1.1.1.cmml">≤</mo><mi id="S3.1.p1.8.m8.1.1.3" xref="S3.1.p1.8.m8.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.1.p1.8.m8.1b"><apply id="S3.1.p1.8.m8.1.1.cmml" xref="S3.1.p1.8.m8.1.1"><leq id="S3.1.p1.8.m8.1.1.1.cmml" xref="S3.1.p1.8.m8.1.1.1"></leq><apply id="S3.1.p1.8.m8.1.1.2.cmml" xref="S3.1.p1.8.m8.1.1.2"><plus id="S3.1.p1.8.m8.1.1.2.1.cmml" xref="S3.1.p1.8.m8.1.1.2.1"></plus><apply id="S3.1.p1.8.m8.1.1.2.2.cmml" xref="S3.1.p1.8.m8.1.1.2.2"><minus id="S3.1.p1.8.m8.1.1.2.2.1.cmml" xref="S3.1.p1.8.m8.1.1.2.2.1"></minus><ci id="S3.1.p1.8.m8.1.1.2.2.2.cmml" xref="S3.1.p1.8.m8.1.1.2.2.2">𝑖</ci><ci id="S3.1.p1.8.m8.1.1.2.2.3.cmml" xref="S3.1.p1.8.m8.1.1.2.2.3">𝐿</ci></apply><cn id="S3.1.p1.8.m8.1.1.2.3.cmml" type="integer" xref="S3.1.p1.8.m8.1.1.2.3">1</cn></apply><ci id="S3.1.p1.8.m8.1.1.3.cmml" xref="S3.1.p1.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.8.m8.1c">i-L+1\leq j</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.8.m8.1d">italic_i - italic_L + 1 ≤ italic_j</annotation></semantics></math>, which deals with the lower bounds of the statement. Analogously, <math alttext="i-j\geq 0" class="ltx_Math" display="inline" id="S3.1.p1.9.m9.1"><semantics id="S3.1.p1.9.m9.1a"><mrow id="S3.1.p1.9.m9.1.1" xref="S3.1.p1.9.m9.1.1.cmml"><mrow id="S3.1.p1.9.m9.1.1.2" xref="S3.1.p1.9.m9.1.1.2.cmml"><mi id="S3.1.p1.9.m9.1.1.2.2" xref="S3.1.p1.9.m9.1.1.2.2.cmml">i</mi><mo id="S3.1.p1.9.m9.1.1.2.1" xref="S3.1.p1.9.m9.1.1.2.1.cmml">−</mo><mi id="S3.1.p1.9.m9.1.1.2.3" xref="S3.1.p1.9.m9.1.1.2.3.cmml">j</mi></mrow><mo id="S3.1.p1.9.m9.1.1.1" xref="S3.1.p1.9.m9.1.1.1.cmml">≥</mo><mn id="S3.1.p1.9.m9.1.1.3" xref="S3.1.p1.9.m9.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.1.p1.9.m9.1b"><apply id="S3.1.p1.9.m9.1.1.cmml" xref="S3.1.p1.9.m9.1.1"><geq id="S3.1.p1.9.m9.1.1.1.cmml" xref="S3.1.p1.9.m9.1.1.1"></geq><apply id="S3.1.p1.9.m9.1.1.2.cmml" xref="S3.1.p1.9.m9.1.1.2"><minus id="S3.1.p1.9.m9.1.1.2.1.cmml" xref="S3.1.p1.9.m9.1.1.2.1"></minus><ci id="S3.1.p1.9.m9.1.1.2.2.cmml" xref="S3.1.p1.9.m9.1.1.2.2">𝑖</ci><ci id="S3.1.p1.9.m9.1.1.2.3.cmml" xref="S3.1.p1.9.m9.1.1.2.3">𝑗</ci></apply><cn id="S3.1.p1.9.m9.1.1.3.cmml" type="integer" xref="S3.1.p1.9.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.9.m9.1c">i-j\geq 0</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.9.m9.1d">italic_i - italic_j ≥ 0</annotation></semantics></math> if and only if <math alttext="i_{1}+L-1-j_{1}\geq 0" class="ltx_Math" display="inline" id="S3.1.p1.10.m10.1"><semantics id="S3.1.p1.10.m10.1a"><mrow id="S3.1.p1.10.m10.1.1" xref="S3.1.p1.10.m10.1.1.cmml"><mrow id="S3.1.p1.10.m10.1.1.2" xref="S3.1.p1.10.m10.1.1.2.cmml"><mrow id="S3.1.p1.10.m10.1.1.2.2" xref="S3.1.p1.10.m10.1.1.2.2.cmml"><msub id="S3.1.p1.10.m10.1.1.2.2.2" xref="S3.1.p1.10.m10.1.1.2.2.2.cmml"><mi id="S3.1.p1.10.m10.1.1.2.2.2.2" xref="S3.1.p1.10.m10.1.1.2.2.2.2.cmml">i</mi><mn id="S3.1.p1.10.m10.1.1.2.2.2.3" xref="S3.1.p1.10.m10.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S3.1.p1.10.m10.1.1.2.2.1" xref="S3.1.p1.10.m10.1.1.2.2.1.cmml">+</mo><mi id="S3.1.p1.10.m10.1.1.2.2.3" xref="S3.1.p1.10.m10.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.1.p1.10.m10.1.1.2.1" xref="S3.1.p1.10.m10.1.1.2.1.cmml">−</mo><mn id="S3.1.p1.10.m10.1.1.2.3" xref="S3.1.p1.10.m10.1.1.2.3.cmml">1</mn><mo id="S3.1.p1.10.m10.1.1.2.1a" xref="S3.1.p1.10.m10.1.1.2.1.cmml">−</mo><msub id="S3.1.p1.10.m10.1.1.2.4" xref="S3.1.p1.10.m10.1.1.2.4.cmml"><mi id="S3.1.p1.10.m10.1.1.2.4.2" xref="S3.1.p1.10.m10.1.1.2.4.2.cmml">j</mi><mn id="S3.1.p1.10.m10.1.1.2.4.3" xref="S3.1.p1.10.m10.1.1.2.4.3.cmml">1</mn></msub></mrow><mo id="S3.1.p1.10.m10.1.1.1" xref="S3.1.p1.10.m10.1.1.1.cmml">≥</mo><mn id="S3.1.p1.10.m10.1.1.3" xref="S3.1.p1.10.m10.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.1.p1.10.m10.1b"><apply id="S3.1.p1.10.m10.1.1.cmml" xref="S3.1.p1.10.m10.1.1"><geq id="S3.1.p1.10.m10.1.1.1.cmml" xref="S3.1.p1.10.m10.1.1.1"></geq><apply id="S3.1.p1.10.m10.1.1.2.cmml" xref="S3.1.p1.10.m10.1.1.2"><minus id="S3.1.p1.10.m10.1.1.2.1.cmml" xref="S3.1.p1.10.m10.1.1.2.1"></minus><apply id="S3.1.p1.10.m10.1.1.2.2.cmml" xref="S3.1.p1.10.m10.1.1.2.2"><plus id="S3.1.p1.10.m10.1.1.2.2.1.cmml" xref="S3.1.p1.10.m10.1.1.2.2.1"></plus><apply id="S3.1.p1.10.m10.1.1.2.2.2.cmml" xref="S3.1.p1.10.m10.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.1.p1.10.m10.1.1.2.2.2.1.cmml" xref="S3.1.p1.10.m10.1.1.2.2.2">subscript</csymbol><ci id="S3.1.p1.10.m10.1.1.2.2.2.2.cmml" xref="S3.1.p1.10.m10.1.1.2.2.2.2">𝑖</ci><cn id="S3.1.p1.10.m10.1.1.2.2.2.3.cmml" type="integer" xref="S3.1.p1.10.m10.1.1.2.2.2.3">1</cn></apply><ci id="S3.1.p1.10.m10.1.1.2.2.3.cmml" xref="S3.1.p1.10.m10.1.1.2.2.3">𝐿</ci></apply><cn id="S3.1.p1.10.m10.1.1.2.3.cmml" type="integer" xref="S3.1.p1.10.m10.1.1.2.3">1</cn><apply id="S3.1.p1.10.m10.1.1.2.4.cmml" xref="S3.1.p1.10.m10.1.1.2.4"><csymbol cd="ambiguous" id="S3.1.p1.10.m10.1.1.2.4.1.cmml" xref="S3.1.p1.10.m10.1.1.2.4">subscript</csymbol><ci id="S3.1.p1.10.m10.1.1.2.4.2.cmml" xref="S3.1.p1.10.m10.1.1.2.4.2">𝑗</ci><cn id="S3.1.p1.10.m10.1.1.2.4.3.cmml" type="integer" xref="S3.1.p1.10.m10.1.1.2.4.3">1</cn></apply></apply><cn id="S3.1.p1.10.m10.1.1.3.cmml" type="integer" xref="S3.1.p1.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.10.m10.1c">i_{1}+L-1-j_{1}\geq 0</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.10.m10.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_L - 1 - italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≥ 0</annotation></semantics></math> or, equivalently, <math alttext="j\leq i" class="ltx_Math" display="inline" id="S3.1.p1.11.m11.1"><semantics id="S3.1.p1.11.m11.1a"><mrow id="S3.1.p1.11.m11.1.1" xref="S3.1.p1.11.m11.1.1.cmml"><mi id="S3.1.p1.11.m11.1.1.2" xref="S3.1.p1.11.m11.1.1.2.cmml">j</mi><mo id="S3.1.p1.11.m11.1.1.1" xref="S3.1.p1.11.m11.1.1.1.cmml">≤</mo><mi id="S3.1.p1.11.m11.1.1.3" xref="S3.1.p1.11.m11.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.1.p1.11.m11.1b"><apply id="S3.1.p1.11.m11.1.1.cmml" xref="S3.1.p1.11.m11.1.1"><leq id="S3.1.p1.11.m11.1.1.1.cmml" xref="S3.1.p1.11.m11.1.1.1"></leq><ci id="S3.1.p1.11.m11.1.1.2.cmml" xref="S3.1.p1.11.m11.1.1.2">𝑗</ci><ci id="S3.1.p1.11.m11.1.1.3.cmml" xref="S3.1.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.11.m11.1c">j\leq i</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.11.m11.1d">italic_j ≤ italic_i</annotation></semantics></math> if and only if <math alttext="j_{1}\leq i_{1}+L-1" class="ltx_Math" display="inline" id="S3.1.p1.12.m12.1"><semantics id="S3.1.p1.12.m12.1a"><mrow id="S3.1.p1.12.m12.1.1" xref="S3.1.p1.12.m12.1.1.cmml"><msub id="S3.1.p1.12.m12.1.1.2" xref="S3.1.p1.12.m12.1.1.2.cmml"><mi id="S3.1.p1.12.m12.1.1.2.2" xref="S3.1.p1.12.m12.1.1.2.2.cmml">j</mi><mn id="S3.1.p1.12.m12.1.1.2.3" xref="S3.1.p1.12.m12.1.1.2.3.cmml">1</mn></msub><mo id="S3.1.p1.12.m12.1.1.1" xref="S3.1.p1.12.m12.1.1.1.cmml">≤</mo><mrow id="S3.1.p1.12.m12.1.1.3" xref="S3.1.p1.12.m12.1.1.3.cmml"><mrow id="S3.1.p1.12.m12.1.1.3.2" xref="S3.1.p1.12.m12.1.1.3.2.cmml"><msub id="S3.1.p1.12.m12.1.1.3.2.2" xref="S3.1.p1.12.m12.1.1.3.2.2.cmml"><mi id="S3.1.p1.12.m12.1.1.3.2.2.2" xref="S3.1.p1.12.m12.1.1.3.2.2.2.cmml">i</mi><mn id="S3.1.p1.12.m12.1.1.3.2.2.3" xref="S3.1.p1.12.m12.1.1.3.2.2.3.cmml">1</mn></msub><mo id="S3.1.p1.12.m12.1.1.3.2.1" xref="S3.1.p1.12.m12.1.1.3.2.1.cmml">+</mo><mi id="S3.1.p1.12.m12.1.1.3.2.3" xref="S3.1.p1.12.m12.1.1.3.2.3.cmml">L</mi></mrow><mo id="S3.1.p1.12.m12.1.1.3.1" xref="S3.1.p1.12.m12.1.1.3.1.cmml">−</mo><mn id="S3.1.p1.12.m12.1.1.3.3" xref="S3.1.p1.12.m12.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.1.p1.12.m12.1b"><apply id="S3.1.p1.12.m12.1.1.cmml" xref="S3.1.p1.12.m12.1.1"><leq id="S3.1.p1.12.m12.1.1.1.cmml" xref="S3.1.p1.12.m12.1.1.1"></leq><apply id="S3.1.p1.12.m12.1.1.2.cmml" xref="S3.1.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.1.p1.12.m12.1.1.2.1.cmml" xref="S3.1.p1.12.m12.1.1.2">subscript</csymbol><ci id="S3.1.p1.12.m12.1.1.2.2.cmml" xref="S3.1.p1.12.m12.1.1.2.2">𝑗</ci><cn id="S3.1.p1.12.m12.1.1.2.3.cmml" type="integer" xref="S3.1.p1.12.m12.1.1.2.3">1</cn></apply><apply id="S3.1.p1.12.m12.1.1.3.cmml" xref="S3.1.p1.12.m12.1.1.3"><minus id="S3.1.p1.12.m12.1.1.3.1.cmml" xref="S3.1.p1.12.m12.1.1.3.1"></minus><apply id="S3.1.p1.12.m12.1.1.3.2.cmml" xref="S3.1.p1.12.m12.1.1.3.2"><plus id="S3.1.p1.12.m12.1.1.3.2.1.cmml" xref="S3.1.p1.12.m12.1.1.3.2.1"></plus><apply id="S3.1.p1.12.m12.1.1.3.2.2.cmml" xref="S3.1.p1.12.m12.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.1.p1.12.m12.1.1.3.2.2.1.cmml" xref="S3.1.p1.12.m12.1.1.3.2.2">subscript</csymbol><ci id="S3.1.p1.12.m12.1.1.3.2.2.2.cmml" xref="S3.1.p1.12.m12.1.1.3.2.2.2">𝑖</ci><cn id="S3.1.p1.12.m12.1.1.3.2.2.3.cmml" type="integer" xref="S3.1.p1.12.m12.1.1.3.2.2.3">1</cn></apply><ci id="S3.1.p1.12.m12.1.1.3.2.3.cmml" xref="S3.1.p1.12.m12.1.1.3.2.3">𝐿</ci></apply><cn id="S3.1.p1.12.m12.1.1.3.3.cmml" type="integer" xref="S3.1.p1.12.m12.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.p1.12.m12.1c">j_{1}\leq i_{1}+L-1</annotation><annotation encoding="application/x-llamapun" id="S3.1.p1.12.m12.1d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_L - 1</annotation></semantics></math>, which finishes the proof.
∎</p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.p10">
<p class="ltx_p" id="S3.p10.2">Now we can formally prove that our definition of <math alttext="T_{Q}" class="ltx_Math" display="inline" id="S3.p10.1.m1.1"><semantics id="S3.p10.1.m1.1a"><msub id="S3.p10.1.m1.1.1" xref="S3.p10.1.m1.1.1.cmml"><mi id="S3.p10.1.m1.1.1.2" xref="S3.p10.1.m1.1.1.2.cmml">T</mi><mi id="S3.p10.1.m1.1.1.3" xref="S3.p10.1.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p10.1.m1.1b"><apply id="S3.p10.1.m1.1.1.cmml" xref="S3.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p10.1.m1.1.1.1.cmml" xref="S3.p10.1.m1.1.1">subscript</csymbol><ci id="S3.p10.1.m1.1.1.2.cmml" xref="S3.p10.1.m1.1.1.2">𝑇</ci><ci id="S3.p10.1.m1.1.1.3.cmml" xref="S3.p10.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p10.1.m1.1c">T_{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.p10.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="T_{K}" class="ltx_Math" display="inline" id="S3.p10.2.m2.1"><semantics id="S3.p10.2.m2.1a"><msub id="S3.p10.2.m2.1.1" xref="S3.p10.2.m2.1.1.cmml"><mi id="S3.p10.2.m2.1.1.2" xref="S3.p10.2.m2.1.1.2.cmml">T</mi><mi id="S3.p10.2.m2.1.1.3" xref="S3.p10.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p10.2.m2.1b"><apply id="S3.p10.2.m2.1.1.cmml" xref="S3.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p10.2.m2.1.1.1.cmml" xref="S3.p10.2.m2.1.1">subscript</csymbol><ci id="S3.p10.2.m2.1.1.2.cmml" xref="S3.p10.2.m2.1.1.2">𝑇</ci><ci id="S3.p10.2.m2.1.1.3.cmml" xref="S3.p10.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p10.2.m2.1c">T_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.p10.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> capture all the dot products needed in the definition of LAM (<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmdefinition1" title="Definition 1 (Local Attention). ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">definition</span> <span class="ltx_text ltx_ref_tag">1</span></a>), which is also visualised in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.F2" title="Figure 2 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmthm3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm3.1.1.1">Lemma 3</span></span><span class="ltx_text ltx_font_bold" id="Thmthm3.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm3.p1">
<p class="ltx_p" id="Thmthm3.p1.13"><span class="ltx_text ltx_font_italic" id="Thmthm3.p1.13.13">For each <math alttext="r\in\{0,1,\ldots,s-1\}" class="ltx_Math" display="inline" id="Thmthm3.p1.1.1.m1.4"><semantics id="Thmthm3.p1.1.1.m1.4a"><mrow id="Thmthm3.p1.1.1.m1.4.4" xref="Thmthm3.p1.1.1.m1.4.4.cmml"><mi id="Thmthm3.p1.1.1.m1.4.4.3" xref="Thmthm3.p1.1.1.m1.4.4.3.cmml">r</mi><mo id="Thmthm3.p1.1.1.m1.4.4.2" xref="Thmthm3.p1.1.1.m1.4.4.2.cmml">∈</mo><mrow id="Thmthm3.p1.1.1.m1.4.4.1.1" xref="Thmthm3.p1.1.1.m1.4.4.1.2.cmml"><mo id="Thmthm3.p1.1.1.m1.4.4.1.1.2" stretchy="false" xref="Thmthm3.p1.1.1.m1.4.4.1.2.cmml">{</mo><mn id="Thmthm3.p1.1.1.m1.1.1" xref="Thmthm3.p1.1.1.m1.1.1.cmml">0</mn><mo id="Thmthm3.p1.1.1.m1.4.4.1.1.3" xref="Thmthm3.p1.1.1.m1.4.4.1.2.cmml">,</mo><mn id="Thmthm3.p1.1.1.m1.2.2" xref="Thmthm3.p1.1.1.m1.2.2.cmml">1</mn><mo id="Thmthm3.p1.1.1.m1.4.4.1.1.4" xref="Thmthm3.p1.1.1.m1.4.4.1.2.cmml">,</mo><mi id="Thmthm3.p1.1.1.m1.3.3" mathvariant="normal" xref="Thmthm3.p1.1.1.m1.3.3.cmml">…</mi><mo id="Thmthm3.p1.1.1.m1.4.4.1.1.5" xref="Thmthm3.p1.1.1.m1.4.4.1.2.cmml">,</mo><mrow id="Thmthm3.p1.1.1.m1.4.4.1.1.1" xref="Thmthm3.p1.1.1.m1.4.4.1.1.1.cmml"><mi id="Thmthm3.p1.1.1.m1.4.4.1.1.1.2" xref="Thmthm3.p1.1.1.m1.4.4.1.1.1.2.cmml">s</mi><mo id="Thmthm3.p1.1.1.m1.4.4.1.1.1.1" xref="Thmthm3.p1.1.1.m1.4.4.1.1.1.1.cmml">−</mo><mn id="Thmthm3.p1.1.1.m1.4.4.1.1.1.3" xref="Thmthm3.p1.1.1.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm3.p1.1.1.m1.4.4.1.1.6" stretchy="false" xref="Thmthm3.p1.1.1.m1.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.1.1.m1.4b"><apply id="Thmthm3.p1.1.1.m1.4.4.cmml" xref="Thmthm3.p1.1.1.m1.4.4"><in id="Thmthm3.p1.1.1.m1.4.4.2.cmml" xref="Thmthm3.p1.1.1.m1.4.4.2"></in><ci id="Thmthm3.p1.1.1.m1.4.4.3.cmml" xref="Thmthm3.p1.1.1.m1.4.4.3">𝑟</ci><set id="Thmthm3.p1.1.1.m1.4.4.1.2.cmml" xref="Thmthm3.p1.1.1.m1.4.4.1.1"><cn id="Thmthm3.p1.1.1.m1.1.1.cmml" type="integer" xref="Thmthm3.p1.1.1.m1.1.1">0</cn><cn id="Thmthm3.p1.1.1.m1.2.2.cmml" type="integer" xref="Thmthm3.p1.1.1.m1.2.2">1</cn><ci id="Thmthm3.p1.1.1.m1.3.3.cmml" xref="Thmthm3.p1.1.1.m1.3.3">…</ci><apply id="Thmthm3.p1.1.1.m1.4.4.1.1.1.cmml" xref="Thmthm3.p1.1.1.m1.4.4.1.1.1"><minus id="Thmthm3.p1.1.1.m1.4.4.1.1.1.1.cmml" xref="Thmthm3.p1.1.1.m1.4.4.1.1.1.1"></minus><ci id="Thmthm3.p1.1.1.m1.4.4.1.1.1.2.cmml" xref="Thmthm3.p1.1.1.m1.4.4.1.1.1.2">𝑠</ci><cn id="Thmthm3.p1.1.1.m1.4.4.1.1.1.3.cmml" type="integer" xref="Thmthm3.p1.1.1.m1.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.1.1.m1.4c">r\in\{0,1,\ldots,s-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.1.1.m1.4d">italic_r ∈ { 0 , 1 , … , italic_s - 1 }</annotation></semantics></math>, the matrix defined as <math alttext="T_{A}[r,\cdot,\cdot]=T_{Q}[r,\cdot,\cdot]T_{K}[r,\cdot,\cdot]^{T}" class="ltx_Math" display="inline" id="Thmthm3.p1.2.2.m2.9"><semantics id="Thmthm3.p1.2.2.m2.9a"><mrow id="Thmthm3.p1.2.2.m2.9.10" xref="Thmthm3.p1.2.2.m2.9.10.cmml"><mrow id="Thmthm3.p1.2.2.m2.9.10.2" xref="Thmthm3.p1.2.2.m2.9.10.2.cmml"><msub id="Thmthm3.p1.2.2.m2.9.10.2.2" xref="Thmthm3.p1.2.2.m2.9.10.2.2.cmml"><mi id="Thmthm3.p1.2.2.m2.9.10.2.2.2" xref="Thmthm3.p1.2.2.m2.9.10.2.2.2.cmml">T</mi><mi id="Thmthm3.p1.2.2.m2.9.10.2.2.3" xref="Thmthm3.p1.2.2.m2.9.10.2.2.3.cmml">A</mi></msub><mo id="Thmthm3.p1.2.2.m2.9.10.2.1" xref="Thmthm3.p1.2.2.m2.9.10.2.1.cmml">⁢</mo><mrow id="Thmthm3.p1.2.2.m2.9.10.2.3.2" xref="Thmthm3.p1.2.2.m2.9.10.2.3.1.cmml"><mo id="Thmthm3.p1.2.2.m2.9.10.2.3.2.1" stretchy="false" xref="Thmthm3.p1.2.2.m2.9.10.2.3.1.cmml">[</mo><mi id="Thmthm3.p1.2.2.m2.1.1" xref="Thmthm3.p1.2.2.m2.1.1.cmml">r</mi><mo id="Thmthm3.p1.2.2.m2.9.10.2.3.2.2" rspace="0em" xref="Thmthm3.p1.2.2.m2.9.10.2.3.1.cmml">,</mo><mo id="Thmthm3.p1.2.2.m2.2.2" lspace="0em" rspace="0em" xref="Thmthm3.p1.2.2.m2.2.2.cmml">⋅</mo><mo id="Thmthm3.p1.2.2.m2.9.10.2.3.2.3" rspace="0em" xref="Thmthm3.p1.2.2.m2.9.10.2.3.1.cmml">,</mo><mo id="Thmthm3.p1.2.2.m2.3.3" lspace="0em" rspace="0em" xref="Thmthm3.p1.2.2.m2.3.3.cmml">⋅</mo><mo id="Thmthm3.p1.2.2.m2.9.10.2.3.2.4" stretchy="false" xref="Thmthm3.p1.2.2.m2.9.10.2.3.1.cmml">]</mo></mrow></mrow><mo id="Thmthm3.p1.2.2.m2.9.10.1" xref="Thmthm3.p1.2.2.m2.9.10.1.cmml">=</mo><mrow id="Thmthm3.p1.2.2.m2.9.10.3" xref="Thmthm3.p1.2.2.m2.9.10.3.cmml"><msub id="Thmthm3.p1.2.2.m2.9.10.3.2" xref="Thmthm3.p1.2.2.m2.9.10.3.2.cmml"><mi id="Thmthm3.p1.2.2.m2.9.10.3.2.2" xref="Thmthm3.p1.2.2.m2.9.10.3.2.2.cmml">T</mi><mi id="Thmthm3.p1.2.2.m2.9.10.3.2.3" xref="Thmthm3.p1.2.2.m2.9.10.3.2.3.cmml">Q</mi></msub><mo id="Thmthm3.p1.2.2.m2.9.10.3.1" xref="Thmthm3.p1.2.2.m2.9.10.3.1.cmml">⁢</mo><mrow id="Thmthm3.p1.2.2.m2.9.10.3.3.2" xref="Thmthm3.p1.2.2.m2.9.10.3.3.1.cmml"><mo id="Thmthm3.p1.2.2.m2.9.10.3.3.2.1" stretchy="false" xref="Thmthm3.p1.2.2.m2.9.10.3.3.1.cmml">[</mo><mi id="Thmthm3.p1.2.2.m2.4.4" xref="Thmthm3.p1.2.2.m2.4.4.cmml">r</mi><mo id="Thmthm3.p1.2.2.m2.9.10.3.3.2.2" rspace="0em" xref="Thmthm3.p1.2.2.m2.9.10.3.3.1.cmml">,</mo><mo id="Thmthm3.p1.2.2.m2.5.5" lspace="0em" rspace="0em" xref="Thmthm3.p1.2.2.m2.5.5.cmml">⋅</mo><mo id="Thmthm3.p1.2.2.m2.9.10.3.3.2.3" rspace="0em" xref="Thmthm3.p1.2.2.m2.9.10.3.3.1.cmml">,</mo><mo id="Thmthm3.p1.2.2.m2.6.6" lspace="0em" rspace="0em" xref="Thmthm3.p1.2.2.m2.6.6.cmml">⋅</mo><mo id="Thmthm3.p1.2.2.m2.9.10.3.3.2.4" stretchy="false" xref="Thmthm3.p1.2.2.m2.9.10.3.3.1.cmml">]</mo></mrow><mo id="Thmthm3.p1.2.2.m2.9.10.3.1a" xref="Thmthm3.p1.2.2.m2.9.10.3.1.cmml">⁢</mo><msub id="Thmthm3.p1.2.2.m2.9.10.3.4" xref="Thmthm3.p1.2.2.m2.9.10.3.4.cmml"><mi id="Thmthm3.p1.2.2.m2.9.10.3.4.2" xref="Thmthm3.p1.2.2.m2.9.10.3.4.2.cmml">T</mi><mi id="Thmthm3.p1.2.2.m2.9.10.3.4.3" xref="Thmthm3.p1.2.2.m2.9.10.3.4.3.cmml">K</mi></msub><mo id="Thmthm3.p1.2.2.m2.9.10.3.1b" xref="Thmthm3.p1.2.2.m2.9.10.3.1.cmml">⁢</mo><msup id="Thmthm3.p1.2.2.m2.9.10.3.5" xref="Thmthm3.p1.2.2.m2.9.10.3.5.cmml"><mrow id="Thmthm3.p1.2.2.m2.9.10.3.5.2.2" xref="Thmthm3.p1.2.2.m2.9.10.3.5.2.1.cmml"><mo id="Thmthm3.p1.2.2.m2.9.10.3.5.2.2.1" stretchy="false" xref="Thmthm3.p1.2.2.m2.9.10.3.5.2.1.cmml">[</mo><mi id="Thmthm3.p1.2.2.m2.7.7" xref="Thmthm3.p1.2.2.m2.7.7.cmml">r</mi><mo id="Thmthm3.p1.2.2.m2.9.10.3.5.2.2.2" rspace="0em" xref="Thmthm3.p1.2.2.m2.9.10.3.5.2.1.cmml">,</mo><mo id="Thmthm3.p1.2.2.m2.8.8" lspace="0em" rspace="0em" xref="Thmthm3.p1.2.2.m2.8.8.cmml">⋅</mo><mo id="Thmthm3.p1.2.2.m2.9.10.3.5.2.2.3" rspace="0em" xref="Thmthm3.p1.2.2.m2.9.10.3.5.2.1.cmml">,</mo><mo id="Thmthm3.p1.2.2.m2.9.9" lspace="0em" rspace="0em" xref="Thmthm3.p1.2.2.m2.9.9.cmml">⋅</mo><mo id="Thmthm3.p1.2.2.m2.9.10.3.5.2.2.4" stretchy="false" xref="Thmthm3.p1.2.2.m2.9.10.3.5.2.1.cmml">]</mo></mrow><mi id="Thmthm3.p1.2.2.m2.9.10.3.5.3" xref="Thmthm3.p1.2.2.m2.9.10.3.5.3.cmml">T</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.2.2.m2.9b"><apply id="Thmthm3.p1.2.2.m2.9.10.cmml" xref="Thmthm3.p1.2.2.m2.9.10"><eq id="Thmthm3.p1.2.2.m2.9.10.1.cmml" xref="Thmthm3.p1.2.2.m2.9.10.1"></eq><apply id="Thmthm3.p1.2.2.m2.9.10.2.cmml" xref="Thmthm3.p1.2.2.m2.9.10.2"><times id="Thmthm3.p1.2.2.m2.9.10.2.1.cmml" xref="Thmthm3.p1.2.2.m2.9.10.2.1"></times><apply id="Thmthm3.p1.2.2.m2.9.10.2.2.cmml" xref="Thmthm3.p1.2.2.m2.9.10.2.2"><csymbol cd="ambiguous" id="Thmthm3.p1.2.2.m2.9.10.2.2.1.cmml" xref="Thmthm3.p1.2.2.m2.9.10.2.2">subscript</csymbol><ci id="Thmthm3.p1.2.2.m2.9.10.2.2.2.cmml" xref="Thmthm3.p1.2.2.m2.9.10.2.2.2">𝑇</ci><ci id="Thmthm3.p1.2.2.m2.9.10.2.2.3.cmml" xref="Thmthm3.p1.2.2.m2.9.10.2.2.3">𝐴</ci></apply><list id="Thmthm3.p1.2.2.m2.9.10.2.3.1.cmml" xref="Thmthm3.p1.2.2.m2.9.10.2.3.2"><ci id="Thmthm3.p1.2.2.m2.1.1.cmml" xref="Thmthm3.p1.2.2.m2.1.1">𝑟</ci><ci id="Thmthm3.p1.2.2.m2.2.2.cmml" xref="Thmthm3.p1.2.2.m2.2.2">⋅</ci><ci id="Thmthm3.p1.2.2.m2.3.3.cmml" xref="Thmthm3.p1.2.2.m2.3.3">⋅</ci></list></apply><apply id="Thmthm3.p1.2.2.m2.9.10.3.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3"><times id="Thmthm3.p1.2.2.m2.9.10.3.1.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.1"></times><apply id="Thmthm3.p1.2.2.m2.9.10.3.2.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.2"><csymbol cd="ambiguous" id="Thmthm3.p1.2.2.m2.9.10.3.2.1.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.2">subscript</csymbol><ci id="Thmthm3.p1.2.2.m2.9.10.3.2.2.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.2.2">𝑇</ci><ci id="Thmthm3.p1.2.2.m2.9.10.3.2.3.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.2.3">𝑄</ci></apply><list id="Thmthm3.p1.2.2.m2.9.10.3.3.1.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.3.2"><ci id="Thmthm3.p1.2.2.m2.4.4.cmml" xref="Thmthm3.p1.2.2.m2.4.4">𝑟</ci><ci id="Thmthm3.p1.2.2.m2.5.5.cmml" xref="Thmthm3.p1.2.2.m2.5.5">⋅</ci><ci id="Thmthm3.p1.2.2.m2.6.6.cmml" xref="Thmthm3.p1.2.2.m2.6.6">⋅</ci></list><apply id="Thmthm3.p1.2.2.m2.9.10.3.4.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.4"><csymbol cd="ambiguous" id="Thmthm3.p1.2.2.m2.9.10.3.4.1.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.4">subscript</csymbol><ci id="Thmthm3.p1.2.2.m2.9.10.3.4.2.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.4.2">𝑇</ci><ci id="Thmthm3.p1.2.2.m2.9.10.3.4.3.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.4.3">𝐾</ci></apply><apply id="Thmthm3.p1.2.2.m2.9.10.3.5.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.5"><csymbol cd="ambiguous" id="Thmthm3.p1.2.2.m2.9.10.3.5.1.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.5">superscript</csymbol><list id="Thmthm3.p1.2.2.m2.9.10.3.5.2.1.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.5.2.2"><ci id="Thmthm3.p1.2.2.m2.7.7.cmml" xref="Thmthm3.p1.2.2.m2.7.7">𝑟</ci><ci id="Thmthm3.p1.2.2.m2.8.8.cmml" xref="Thmthm3.p1.2.2.m2.8.8">⋅</ci><ci id="Thmthm3.p1.2.2.m2.9.9.cmml" xref="Thmthm3.p1.2.2.m2.9.9">⋅</ci></list><ci id="Thmthm3.p1.2.2.m2.9.10.3.5.3.cmml" xref="Thmthm3.p1.2.2.m2.9.10.3.5.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.2.2.m2.9c">T_{A}[r,\cdot,\cdot]=T_{Q}[r,\cdot,\cdot]T_{K}[r,\cdot,\cdot]^{T}</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.2.2.m2.9d">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ] = italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ] italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> has dimensions <math alttext="L\times(2L-1)" class="ltx_Math" display="inline" id="Thmthm3.p1.3.3.m3.1"><semantics id="Thmthm3.p1.3.3.m3.1a"><mrow id="Thmthm3.p1.3.3.m3.1.1" xref="Thmthm3.p1.3.3.m3.1.1.cmml"><mi id="Thmthm3.p1.3.3.m3.1.1.3" xref="Thmthm3.p1.3.3.m3.1.1.3.cmml">L</mi><mo id="Thmthm3.p1.3.3.m3.1.1.2" lspace="0.222em" rspace="0.222em" xref="Thmthm3.p1.3.3.m3.1.1.2.cmml">×</mo><mrow id="Thmthm3.p1.3.3.m3.1.1.1.1" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.cmml"><mo id="Thmthm3.p1.3.3.m3.1.1.1.1.2" stretchy="false" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm3.p1.3.3.m3.1.1.1.1.1" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.cmml"><mrow id="Thmthm3.p1.3.3.m3.1.1.1.1.1.2" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.cmml"><mn id="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.2" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.2.cmml">2</mn><mo id="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.1" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.3" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="Thmthm3.p1.3.3.m3.1.1.1.1.1.1" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="Thmthm3.p1.3.3.m3.1.1.1.1.1.3" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm3.p1.3.3.m3.1.1.1.1.3" stretchy="false" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.3.3.m3.1b"><apply id="Thmthm3.p1.3.3.m3.1.1.cmml" xref="Thmthm3.p1.3.3.m3.1.1"><times id="Thmthm3.p1.3.3.m3.1.1.2.cmml" xref="Thmthm3.p1.3.3.m3.1.1.2"></times><ci id="Thmthm3.p1.3.3.m3.1.1.3.cmml" xref="Thmthm3.p1.3.3.m3.1.1.3">𝐿</ci><apply id="Thmthm3.p1.3.3.m3.1.1.1.1.1.cmml" xref="Thmthm3.p1.3.3.m3.1.1.1.1"><minus id="Thmthm3.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.1"></minus><apply id="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.2"><times id="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.1.cmml" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.1"></times><cn id="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.2.cmml" type="integer" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.2">2</cn><ci id="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.3.cmml" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="Thmthm3.p1.3.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="Thmthm3.p1.3.3.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.3.3.m3.1c">L\times(2L-1)</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.3.3.m3.1d">italic_L × ( 2 italic_L - 1 )</annotation></semantics></math>. For each <math alttext="i\in\{0,1,\ldots,n-1\}" class="ltx_Math" display="inline" id="Thmthm3.p1.4.4.m4.4"><semantics id="Thmthm3.p1.4.4.m4.4a"><mrow id="Thmthm3.p1.4.4.m4.4.4" xref="Thmthm3.p1.4.4.m4.4.4.cmml"><mi id="Thmthm3.p1.4.4.m4.4.4.3" xref="Thmthm3.p1.4.4.m4.4.4.3.cmml">i</mi><mo id="Thmthm3.p1.4.4.m4.4.4.2" xref="Thmthm3.p1.4.4.m4.4.4.2.cmml">∈</mo><mrow id="Thmthm3.p1.4.4.m4.4.4.1.1" xref="Thmthm3.p1.4.4.m4.4.4.1.2.cmml"><mo id="Thmthm3.p1.4.4.m4.4.4.1.1.2" stretchy="false" xref="Thmthm3.p1.4.4.m4.4.4.1.2.cmml">{</mo><mn id="Thmthm3.p1.4.4.m4.1.1" xref="Thmthm3.p1.4.4.m4.1.1.cmml">0</mn><mo id="Thmthm3.p1.4.4.m4.4.4.1.1.3" xref="Thmthm3.p1.4.4.m4.4.4.1.2.cmml">,</mo><mn id="Thmthm3.p1.4.4.m4.2.2" xref="Thmthm3.p1.4.4.m4.2.2.cmml">1</mn><mo id="Thmthm3.p1.4.4.m4.4.4.1.1.4" xref="Thmthm3.p1.4.4.m4.4.4.1.2.cmml">,</mo><mi id="Thmthm3.p1.4.4.m4.3.3" mathvariant="normal" xref="Thmthm3.p1.4.4.m4.3.3.cmml">…</mi><mo id="Thmthm3.p1.4.4.m4.4.4.1.1.5" xref="Thmthm3.p1.4.4.m4.4.4.1.2.cmml">,</mo><mrow id="Thmthm3.p1.4.4.m4.4.4.1.1.1" xref="Thmthm3.p1.4.4.m4.4.4.1.1.1.cmml"><mi id="Thmthm3.p1.4.4.m4.4.4.1.1.1.2" xref="Thmthm3.p1.4.4.m4.4.4.1.1.1.2.cmml">n</mi><mo id="Thmthm3.p1.4.4.m4.4.4.1.1.1.1" xref="Thmthm3.p1.4.4.m4.4.4.1.1.1.1.cmml">−</mo><mn id="Thmthm3.p1.4.4.m4.4.4.1.1.1.3" xref="Thmthm3.p1.4.4.m4.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm3.p1.4.4.m4.4.4.1.1.6" stretchy="false" xref="Thmthm3.p1.4.4.m4.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.4.4.m4.4b"><apply id="Thmthm3.p1.4.4.m4.4.4.cmml" xref="Thmthm3.p1.4.4.m4.4.4"><in id="Thmthm3.p1.4.4.m4.4.4.2.cmml" xref="Thmthm3.p1.4.4.m4.4.4.2"></in><ci id="Thmthm3.p1.4.4.m4.4.4.3.cmml" xref="Thmthm3.p1.4.4.m4.4.4.3">𝑖</ci><set id="Thmthm3.p1.4.4.m4.4.4.1.2.cmml" xref="Thmthm3.p1.4.4.m4.4.4.1.1"><cn id="Thmthm3.p1.4.4.m4.1.1.cmml" type="integer" xref="Thmthm3.p1.4.4.m4.1.1">0</cn><cn id="Thmthm3.p1.4.4.m4.2.2.cmml" type="integer" xref="Thmthm3.p1.4.4.m4.2.2">1</cn><ci id="Thmthm3.p1.4.4.m4.3.3.cmml" xref="Thmthm3.p1.4.4.m4.3.3">…</ci><apply id="Thmthm3.p1.4.4.m4.4.4.1.1.1.cmml" xref="Thmthm3.p1.4.4.m4.4.4.1.1.1"><minus id="Thmthm3.p1.4.4.m4.4.4.1.1.1.1.cmml" xref="Thmthm3.p1.4.4.m4.4.4.1.1.1.1"></minus><ci id="Thmthm3.p1.4.4.m4.4.4.1.1.1.2.cmml" xref="Thmthm3.p1.4.4.m4.4.4.1.1.1.2">𝑛</ci><cn id="Thmthm3.p1.4.4.m4.4.4.1.1.1.3.cmml" type="integer" xref="Thmthm3.p1.4.4.m4.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.4.4.m4.4c">i\in\{0,1,\ldots,n-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.4.4.m4.4d">italic_i ∈ { 0 , 1 , … , italic_n - 1 }</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="Thmthm3.p1.5.5.m5.1"><semantics id="Thmthm3.p1.5.5.m5.1a"><mi id="Thmthm3.p1.5.5.m5.1.1" xref="Thmthm3.p1.5.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.5.5.m5.1b"><ci id="Thmthm3.p1.5.5.m5.1.1.cmml" xref="Thmthm3.p1.5.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.5.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.5.5.m5.1d">italic_j</annotation></semantics></math> with <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="Thmthm3.p1.6.6.m6.1"><semantics id="Thmthm3.p1.6.6.m6.1a"><mrow id="Thmthm3.p1.6.6.m6.1.1" xref="Thmthm3.p1.6.6.m6.1.1.cmml"><mrow id="Thmthm3.p1.6.6.m6.1.1.2" xref="Thmthm3.p1.6.6.m6.1.1.2.cmml"><mrow id="Thmthm3.p1.6.6.m6.1.1.2.2" xref="Thmthm3.p1.6.6.m6.1.1.2.2.cmml"><mi id="Thmthm3.p1.6.6.m6.1.1.2.2.2" xref="Thmthm3.p1.6.6.m6.1.1.2.2.2.cmml">i</mi><mo id="Thmthm3.p1.6.6.m6.1.1.2.2.1" xref="Thmthm3.p1.6.6.m6.1.1.2.2.1.cmml">−</mo><mi id="Thmthm3.p1.6.6.m6.1.1.2.2.3" xref="Thmthm3.p1.6.6.m6.1.1.2.2.3.cmml">L</mi></mrow><mo id="Thmthm3.p1.6.6.m6.1.1.2.1" xref="Thmthm3.p1.6.6.m6.1.1.2.1.cmml">+</mo><mn id="Thmthm3.p1.6.6.m6.1.1.2.3" xref="Thmthm3.p1.6.6.m6.1.1.2.3.cmml">1</mn></mrow><mo id="Thmthm3.p1.6.6.m6.1.1.3" xref="Thmthm3.p1.6.6.m6.1.1.3.cmml">≤</mo><mi id="Thmthm3.p1.6.6.m6.1.1.4" xref="Thmthm3.p1.6.6.m6.1.1.4.cmml">j</mi><mo id="Thmthm3.p1.6.6.m6.1.1.5" xref="Thmthm3.p1.6.6.m6.1.1.5.cmml">≤</mo><mi id="Thmthm3.p1.6.6.m6.1.1.6" xref="Thmthm3.p1.6.6.m6.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.6.6.m6.1b"><apply id="Thmthm3.p1.6.6.m6.1.1.cmml" xref="Thmthm3.p1.6.6.m6.1.1"><and id="Thmthm3.p1.6.6.m6.1.1a.cmml" xref="Thmthm3.p1.6.6.m6.1.1"></and><apply id="Thmthm3.p1.6.6.m6.1.1b.cmml" xref="Thmthm3.p1.6.6.m6.1.1"><leq id="Thmthm3.p1.6.6.m6.1.1.3.cmml" xref="Thmthm3.p1.6.6.m6.1.1.3"></leq><apply id="Thmthm3.p1.6.6.m6.1.1.2.cmml" xref="Thmthm3.p1.6.6.m6.1.1.2"><plus id="Thmthm3.p1.6.6.m6.1.1.2.1.cmml" xref="Thmthm3.p1.6.6.m6.1.1.2.1"></plus><apply id="Thmthm3.p1.6.6.m6.1.1.2.2.cmml" xref="Thmthm3.p1.6.6.m6.1.1.2.2"><minus id="Thmthm3.p1.6.6.m6.1.1.2.2.1.cmml" xref="Thmthm3.p1.6.6.m6.1.1.2.2.1"></minus><ci id="Thmthm3.p1.6.6.m6.1.1.2.2.2.cmml" xref="Thmthm3.p1.6.6.m6.1.1.2.2.2">𝑖</ci><ci id="Thmthm3.p1.6.6.m6.1.1.2.2.3.cmml" xref="Thmthm3.p1.6.6.m6.1.1.2.2.3">𝐿</ci></apply><cn id="Thmthm3.p1.6.6.m6.1.1.2.3.cmml" type="integer" xref="Thmthm3.p1.6.6.m6.1.1.2.3">1</cn></apply><ci id="Thmthm3.p1.6.6.m6.1.1.4.cmml" xref="Thmthm3.p1.6.6.m6.1.1.4">𝑗</ci></apply><apply id="Thmthm3.p1.6.6.m6.1.1c.cmml" xref="Thmthm3.p1.6.6.m6.1.1"><leq id="Thmthm3.p1.6.6.m6.1.1.5.cmml" xref="Thmthm3.p1.6.6.m6.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#Thmthm3.p1.6.6.m6.1.1.4.cmml" id="Thmthm3.p1.6.6.m6.1.1d.cmml" xref="Thmthm3.p1.6.6.m6.1.1"></share><ci id="Thmthm3.p1.6.6.m6.1.1.6.cmml" xref="Thmthm3.p1.6.6.m6.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.6.6.m6.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.6.6.m6.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math>, setting <math alttext="i_{1}=i\pmod{L}" class="ltx_Math" display="inline" id="Thmthm3.p1.7.7.m7.2"><semantics id="Thmthm3.p1.7.7.m7.2a"><mrow id="Thmthm3.p1.7.7.m7.2.3" xref="Thmthm3.p1.7.7.m7.2.3.cmml"><msub id="Thmthm3.p1.7.7.m7.2.3.2" xref="Thmthm3.p1.7.7.m7.2.3.2.cmml"><mi id="Thmthm3.p1.7.7.m7.2.3.2.2" xref="Thmthm3.p1.7.7.m7.2.3.2.2.cmml">i</mi><mn id="Thmthm3.p1.7.7.m7.2.3.2.3" xref="Thmthm3.p1.7.7.m7.2.3.2.3.cmml">1</mn></msub><mo id="Thmthm3.p1.7.7.m7.2.3.1" xref="Thmthm3.p1.7.7.m7.2.3.1.cmml">=</mo><mrow id="Thmthm3.p1.7.7.m7.2.3.3" xref="Thmthm3.p1.7.7.m7.2.3.3.cmml"><mi id="Thmthm3.p1.7.7.m7.2.3.3.2" xref="Thmthm3.p1.7.7.m7.2.3.3.2.cmml">i</mi><mspace id="Thmthm3.p1.7.7.m7.2.3.3a" width="0.949em" xref="Thmthm3.p1.7.7.m7.2.3.3.cmml"></mspace><mrow id="Thmthm3.p1.7.7.m7.2.2.2.2" xref="Thmthm3.p1.7.7.m7.2.2.3.cmml"><mo id="Thmthm3.p1.7.7.m7.2.2.2.2.2" stretchy="false" xref="Thmthm3.p1.7.7.m7.2.2.3.1.cmml">(</mo><mrow id="Thmthm3.p1.7.7.m7.2.2.2.2.1" xref="Thmthm3.p1.7.7.m7.2.2.3.cmml"><mo id="Thmthm3.p1.7.7.m7.2.2.2.2.1.1" lspace="0em" rspace="0.167em" xref="Thmthm3.p1.7.7.m7.2.2.3.1.cmml">mod</mo><mi id="Thmthm3.p1.7.7.m7.1.1.1.1" xref="Thmthm3.p1.7.7.m7.1.1.1.1.cmml">L</mi></mrow><mo id="Thmthm3.p1.7.7.m7.2.2.2.2.3" stretchy="false" xref="Thmthm3.p1.7.7.m7.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.7.7.m7.2b"><apply id="Thmthm3.p1.7.7.m7.2.3.cmml" xref="Thmthm3.p1.7.7.m7.2.3"><eq id="Thmthm3.p1.7.7.m7.2.3.1.cmml" xref="Thmthm3.p1.7.7.m7.2.3.1"></eq><apply id="Thmthm3.p1.7.7.m7.2.3.2.cmml" xref="Thmthm3.p1.7.7.m7.2.3.2"><csymbol cd="ambiguous" id="Thmthm3.p1.7.7.m7.2.3.2.1.cmml" xref="Thmthm3.p1.7.7.m7.2.3.2">subscript</csymbol><ci id="Thmthm3.p1.7.7.m7.2.3.2.2.cmml" xref="Thmthm3.p1.7.7.m7.2.3.2.2">𝑖</ci><cn id="Thmthm3.p1.7.7.m7.2.3.2.3.cmml" type="integer" xref="Thmthm3.p1.7.7.m7.2.3.2.3">1</cn></apply><apply id="Thmthm3.p1.7.7.m7.2.3.3.cmml" xref="Thmthm3.p1.7.7.m7.2.3.3"><csymbol cd="latexml" id="Thmthm3.p1.7.7.m7.2.3.3.1.cmml" xref="Thmthm3.p1.7.7.m7.2.3.3">annotated</csymbol><ci id="Thmthm3.p1.7.7.m7.2.3.3.2.cmml" xref="Thmthm3.p1.7.7.m7.2.3.3.2">𝑖</ci><apply id="Thmthm3.p1.7.7.m7.2.2.3.cmml" xref="Thmthm3.p1.7.7.m7.2.2.2.2"><ci id="Thmthm3.p1.7.7.m7.2.2.3.1.cmml" xref="Thmthm3.p1.7.7.m7.2.2.2.2.2">𝑝𝑚𝑜𝑑</ci><ci id="Thmthm3.p1.7.7.m7.1.1.1.1.cmml" xref="Thmthm3.p1.7.7.m7.1.1.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.7.7.m7.2c">i_{1}=i\pmod{L}</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.7.7.m7.2d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_i start_MODIFIER ( roman_mod start_ARG italic_L end_ARG ) end_MODIFIER</annotation></semantics></math>, <math alttext="r=(i-i_{1})/L" class="ltx_Math" display="inline" id="Thmthm3.p1.8.8.m8.1"><semantics id="Thmthm3.p1.8.8.m8.1a"><mrow id="Thmthm3.p1.8.8.m8.1.1" xref="Thmthm3.p1.8.8.m8.1.1.cmml"><mi id="Thmthm3.p1.8.8.m8.1.1.3" xref="Thmthm3.p1.8.8.m8.1.1.3.cmml">r</mi><mo id="Thmthm3.p1.8.8.m8.1.1.2" xref="Thmthm3.p1.8.8.m8.1.1.2.cmml">=</mo><mrow id="Thmthm3.p1.8.8.m8.1.1.1" xref="Thmthm3.p1.8.8.m8.1.1.1.cmml"><mrow id="Thmthm3.p1.8.8.m8.1.1.1.1.1" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.cmml"><mo id="Thmthm3.p1.8.8.m8.1.1.1.1.1.2" stretchy="false" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.cmml"><mi id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.2" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.2.cmml">i</mi><mo id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.1" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.1.cmml">−</mo><msub id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.cmml"><mi id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.2" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.2.cmml">i</mi><mn id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.3" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="Thmthm3.p1.8.8.m8.1.1.1.1.1.3" stretchy="false" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmthm3.p1.8.8.m8.1.1.1.2" xref="Thmthm3.p1.8.8.m8.1.1.1.2.cmml">/</mo><mi id="Thmthm3.p1.8.8.m8.1.1.1.3" xref="Thmthm3.p1.8.8.m8.1.1.1.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.8.8.m8.1b"><apply id="Thmthm3.p1.8.8.m8.1.1.cmml" xref="Thmthm3.p1.8.8.m8.1.1"><eq id="Thmthm3.p1.8.8.m8.1.1.2.cmml" xref="Thmthm3.p1.8.8.m8.1.1.2"></eq><ci id="Thmthm3.p1.8.8.m8.1.1.3.cmml" xref="Thmthm3.p1.8.8.m8.1.1.3">𝑟</ci><apply id="Thmthm3.p1.8.8.m8.1.1.1.cmml" xref="Thmthm3.p1.8.8.m8.1.1.1"><divide id="Thmthm3.p1.8.8.m8.1.1.1.2.cmml" xref="Thmthm3.p1.8.8.m8.1.1.1.2"></divide><apply id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.cmml" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1"><minus id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.1.cmml" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.1"></minus><ci id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.2.cmml" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.2">𝑖</ci><apply id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.cmml" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.1.cmml" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3">subscript</csymbol><ci id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.2.cmml" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.2">𝑖</ci><cn id="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.3.cmml" type="integer" xref="Thmthm3.p1.8.8.m8.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="Thmthm3.p1.8.8.m8.1.1.1.3.cmml" xref="Thmthm3.p1.8.8.m8.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.8.8.m8.1c">r=(i-i_{1})/L</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.8.8.m8.1d">italic_r = ( italic_i - italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) / italic_L</annotation></semantics></math> and <math alttext="j_{1}=j-(r-1)L-1" class="ltx_Math" display="inline" id="Thmthm3.p1.9.9.m9.1"><semantics id="Thmthm3.p1.9.9.m9.1a"><mrow id="Thmthm3.p1.9.9.m9.1.1" xref="Thmthm3.p1.9.9.m9.1.1.cmml"><msub id="Thmthm3.p1.9.9.m9.1.1.3" xref="Thmthm3.p1.9.9.m9.1.1.3.cmml"><mi id="Thmthm3.p1.9.9.m9.1.1.3.2" xref="Thmthm3.p1.9.9.m9.1.1.3.2.cmml">j</mi><mn id="Thmthm3.p1.9.9.m9.1.1.3.3" xref="Thmthm3.p1.9.9.m9.1.1.3.3.cmml">1</mn></msub><mo id="Thmthm3.p1.9.9.m9.1.1.2" xref="Thmthm3.p1.9.9.m9.1.1.2.cmml">=</mo><mrow id="Thmthm3.p1.9.9.m9.1.1.1" xref="Thmthm3.p1.9.9.m9.1.1.1.cmml"><mi id="Thmthm3.p1.9.9.m9.1.1.1.3" xref="Thmthm3.p1.9.9.m9.1.1.1.3.cmml">j</mi><mo id="Thmthm3.p1.9.9.m9.1.1.1.2" xref="Thmthm3.p1.9.9.m9.1.1.1.2.cmml">−</mo><mrow id="Thmthm3.p1.9.9.m9.1.1.1.1" xref="Thmthm3.p1.9.9.m9.1.1.1.1.cmml"><mrow id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.cmml"><mo id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.2" stretchy="false" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.cmml"><mi id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.2" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.1" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.3" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.3" stretchy="false" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmthm3.p1.9.9.m9.1.1.1.1.2" xref="Thmthm3.p1.9.9.m9.1.1.1.1.2.cmml">⁢</mo><mi id="Thmthm3.p1.9.9.m9.1.1.1.1.3" xref="Thmthm3.p1.9.9.m9.1.1.1.1.3.cmml">L</mi></mrow><mo id="Thmthm3.p1.9.9.m9.1.1.1.2a" xref="Thmthm3.p1.9.9.m9.1.1.1.2.cmml">−</mo><mn id="Thmthm3.p1.9.9.m9.1.1.1.4" xref="Thmthm3.p1.9.9.m9.1.1.1.4.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.9.9.m9.1b"><apply id="Thmthm3.p1.9.9.m9.1.1.cmml" xref="Thmthm3.p1.9.9.m9.1.1"><eq id="Thmthm3.p1.9.9.m9.1.1.2.cmml" xref="Thmthm3.p1.9.9.m9.1.1.2"></eq><apply id="Thmthm3.p1.9.9.m9.1.1.3.cmml" xref="Thmthm3.p1.9.9.m9.1.1.3"><csymbol cd="ambiguous" id="Thmthm3.p1.9.9.m9.1.1.3.1.cmml" xref="Thmthm3.p1.9.9.m9.1.1.3">subscript</csymbol><ci id="Thmthm3.p1.9.9.m9.1.1.3.2.cmml" xref="Thmthm3.p1.9.9.m9.1.1.3.2">𝑗</ci><cn id="Thmthm3.p1.9.9.m9.1.1.3.3.cmml" type="integer" xref="Thmthm3.p1.9.9.m9.1.1.3.3">1</cn></apply><apply id="Thmthm3.p1.9.9.m9.1.1.1.cmml" xref="Thmthm3.p1.9.9.m9.1.1.1"><minus id="Thmthm3.p1.9.9.m9.1.1.1.2.cmml" xref="Thmthm3.p1.9.9.m9.1.1.1.2"></minus><ci id="Thmthm3.p1.9.9.m9.1.1.1.3.cmml" xref="Thmthm3.p1.9.9.m9.1.1.1.3">𝑗</ci><apply id="Thmthm3.p1.9.9.m9.1.1.1.1.cmml" xref="Thmthm3.p1.9.9.m9.1.1.1.1"><times id="Thmthm3.p1.9.9.m9.1.1.1.1.2.cmml" xref="Thmthm3.p1.9.9.m9.1.1.1.1.2"></times><apply id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.cmml" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1"><minus id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.1"></minus><ci id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.2.cmml" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.2">𝑟</ci><cn id="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmthm3.p1.9.9.m9.1.1.1.1.1.1.1.3">1</cn></apply><ci id="Thmthm3.p1.9.9.m9.1.1.1.1.3.cmml" xref="Thmthm3.p1.9.9.m9.1.1.1.1.3">𝐿</ci></apply><cn id="Thmthm3.p1.9.9.m9.1.1.1.4.cmml" type="integer" xref="Thmthm3.p1.9.9.m9.1.1.1.4">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.9.9.m9.1c">j_{1}=j-(r-1)L-1</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.9.9.m9.1d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_j - ( italic_r - 1 ) italic_L - 1</annotation></semantics></math>, we have <math alttext="r\in\{0,1,\ldots,s-1\}" class="ltx_Math" display="inline" id="Thmthm3.p1.10.10.m10.4"><semantics id="Thmthm3.p1.10.10.m10.4a"><mrow id="Thmthm3.p1.10.10.m10.4.4" xref="Thmthm3.p1.10.10.m10.4.4.cmml"><mi id="Thmthm3.p1.10.10.m10.4.4.3" xref="Thmthm3.p1.10.10.m10.4.4.3.cmml">r</mi><mo id="Thmthm3.p1.10.10.m10.4.4.2" xref="Thmthm3.p1.10.10.m10.4.4.2.cmml">∈</mo><mrow id="Thmthm3.p1.10.10.m10.4.4.1.1" xref="Thmthm3.p1.10.10.m10.4.4.1.2.cmml"><mo id="Thmthm3.p1.10.10.m10.4.4.1.1.2" stretchy="false" xref="Thmthm3.p1.10.10.m10.4.4.1.2.cmml">{</mo><mn id="Thmthm3.p1.10.10.m10.1.1" xref="Thmthm3.p1.10.10.m10.1.1.cmml">0</mn><mo id="Thmthm3.p1.10.10.m10.4.4.1.1.3" xref="Thmthm3.p1.10.10.m10.4.4.1.2.cmml">,</mo><mn id="Thmthm3.p1.10.10.m10.2.2" xref="Thmthm3.p1.10.10.m10.2.2.cmml">1</mn><mo id="Thmthm3.p1.10.10.m10.4.4.1.1.4" xref="Thmthm3.p1.10.10.m10.4.4.1.2.cmml">,</mo><mi id="Thmthm3.p1.10.10.m10.3.3" mathvariant="normal" xref="Thmthm3.p1.10.10.m10.3.3.cmml">…</mi><mo id="Thmthm3.p1.10.10.m10.4.4.1.1.5" xref="Thmthm3.p1.10.10.m10.4.4.1.2.cmml">,</mo><mrow id="Thmthm3.p1.10.10.m10.4.4.1.1.1" xref="Thmthm3.p1.10.10.m10.4.4.1.1.1.cmml"><mi id="Thmthm3.p1.10.10.m10.4.4.1.1.1.2" xref="Thmthm3.p1.10.10.m10.4.4.1.1.1.2.cmml">s</mi><mo id="Thmthm3.p1.10.10.m10.4.4.1.1.1.1" xref="Thmthm3.p1.10.10.m10.4.4.1.1.1.1.cmml">−</mo><mn id="Thmthm3.p1.10.10.m10.4.4.1.1.1.3" xref="Thmthm3.p1.10.10.m10.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm3.p1.10.10.m10.4.4.1.1.6" stretchy="false" xref="Thmthm3.p1.10.10.m10.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.10.10.m10.4b"><apply id="Thmthm3.p1.10.10.m10.4.4.cmml" xref="Thmthm3.p1.10.10.m10.4.4"><in id="Thmthm3.p1.10.10.m10.4.4.2.cmml" xref="Thmthm3.p1.10.10.m10.4.4.2"></in><ci id="Thmthm3.p1.10.10.m10.4.4.3.cmml" xref="Thmthm3.p1.10.10.m10.4.4.3">𝑟</ci><set id="Thmthm3.p1.10.10.m10.4.4.1.2.cmml" xref="Thmthm3.p1.10.10.m10.4.4.1.1"><cn id="Thmthm3.p1.10.10.m10.1.1.cmml" type="integer" xref="Thmthm3.p1.10.10.m10.1.1">0</cn><cn id="Thmthm3.p1.10.10.m10.2.2.cmml" type="integer" xref="Thmthm3.p1.10.10.m10.2.2">1</cn><ci id="Thmthm3.p1.10.10.m10.3.3.cmml" xref="Thmthm3.p1.10.10.m10.3.3">…</ci><apply id="Thmthm3.p1.10.10.m10.4.4.1.1.1.cmml" xref="Thmthm3.p1.10.10.m10.4.4.1.1.1"><minus id="Thmthm3.p1.10.10.m10.4.4.1.1.1.1.cmml" xref="Thmthm3.p1.10.10.m10.4.4.1.1.1.1"></minus><ci id="Thmthm3.p1.10.10.m10.4.4.1.1.1.2.cmml" xref="Thmthm3.p1.10.10.m10.4.4.1.1.1.2">𝑠</ci><cn id="Thmthm3.p1.10.10.m10.4.4.1.1.1.3.cmml" type="integer" xref="Thmthm3.p1.10.10.m10.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.10.10.m10.4c">r\in\{0,1,\ldots,s-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.10.10.m10.4d">italic_r ∈ { 0 , 1 , … , italic_s - 1 }</annotation></semantics></math>, <math alttext="i_{1}\in\{0,1,\ldots,L-1\}" class="ltx_Math" display="inline" id="Thmthm3.p1.11.11.m11.4"><semantics id="Thmthm3.p1.11.11.m11.4a"><mrow id="Thmthm3.p1.11.11.m11.4.4" xref="Thmthm3.p1.11.11.m11.4.4.cmml"><msub id="Thmthm3.p1.11.11.m11.4.4.3" xref="Thmthm3.p1.11.11.m11.4.4.3.cmml"><mi id="Thmthm3.p1.11.11.m11.4.4.3.2" xref="Thmthm3.p1.11.11.m11.4.4.3.2.cmml">i</mi><mn id="Thmthm3.p1.11.11.m11.4.4.3.3" xref="Thmthm3.p1.11.11.m11.4.4.3.3.cmml">1</mn></msub><mo id="Thmthm3.p1.11.11.m11.4.4.2" xref="Thmthm3.p1.11.11.m11.4.4.2.cmml">∈</mo><mrow id="Thmthm3.p1.11.11.m11.4.4.1.1" xref="Thmthm3.p1.11.11.m11.4.4.1.2.cmml"><mo id="Thmthm3.p1.11.11.m11.4.4.1.1.2" stretchy="false" xref="Thmthm3.p1.11.11.m11.4.4.1.2.cmml">{</mo><mn id="Thmthm3.p1.11.11.m11.1.1" xref="Thmthm3.p1.11.11.m11.1.1.cmml">0</mn><mo id="Thmthm3.p1.11.11.m11.4.4.1.1.3" xref="Thmthm3.p1.11.11.m11.4.4.1.2.cmml">,</mo><mn id="Thmthm3.p1.11.11.m11.2.2" xref="Thmthm3.p1.11.11.m11.2.2.cmml">1</mn><mo id="Thmthm3.p1.11.11.m11.4.4.1.1.4" xref="Thmthm3.p1.11.11.m11.4.4.1.2.cmml">,</mo><mi id="Thmthm3.p1.11.11.m11.3.3" mathvariant="normal" xref="Thmthm3.p1.11.11.m11.3.3.cmml">…</mi><mo id="Thmthm3.p1.11.11.m11.4.4.1.1.5" xref="Thmthm3.p1.11.11.m11.4.4.1.2.cmml">,</mo><mrow id="Thmthm3.p1.11.11.m11.4.4.1.1.1" xref="Thmthm3.p1.11.11.m11.4.4.1.1.1.cmml"><mi id="Thmthm3.p1.11.11.m11.4.4.1.1.1.2" xref="Thmthm3.p1.11.11.m11.4.4.1.1.1.2.cmml">L</mi><mo id="Thmthm3.p1.11.11.m11.4.4.1.1.1.1" xref="Thmthm3.p1.11.11.m11.4.4.1.1.1.1.cmml">−</mo><mn id="Thmthm3.p1.11.11.m11.4.4.1.1.1.3" xref="Thmthm3.p1.11.11.m11.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm3.p1.11.11.m11.4.4.1.1.6" stretchy="false" xref="Thmthm3.p1.11.11.m11.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.11.11.m11.4b"><apply id="Thmthm3.p1.11.11.m11.4.4.cmml" xref="Thmthm3.p1.11.11.m11.4.4"><in id="Thmthm3.p1.11.11.m11.4.4.2.cmml" xref="Thmthm3.p1.11.11.m11.4.4.2"></in><apply id="Thmthm3.p1.11.11.m11.4.4.3.cmml" xref="Thmthm3.p1.11.11.m11.4.4.3"><csymbol cd="ambiguous" id="Thmthm3.p1.11.11.m11.4.4.3.1.cmml" xref="Thmthm3.p1.11.11.m11.4.4.3">subscript</csymbol><ci id="Thmthm3.p1.11.11.m11.4.4.3.2.cmml" xref="Thmthm3.p1.11.11.m11.4.4.3.2">𝑖</ci><cn id="Thmthm3.p1.11.11.m11.4.4.3.3.cmml" type="integer" xref="Thmthm3.p1.11.11.m11.4.4.3.3">1</cn></apply><set id="Thmthm3.p1.11.11.m11.4.4.1.2.cmml" xref="Thmthm3.p1.11.11.m11.4.4.1.1"><cn id="Thmthm3.p1.11.11.m11.1.1.cmml" type="integer" xref="Thmthm3.p1.11.11.m11.1.1">0</cn><cn id="Thmthm3.p1.11.11.m11.2.2.cmml" type="integer" xref="Thmthm3.p1.11.11.m11.2.2">1</cn><ci id="Thmthm3.p1.11.11.m11.3.3.cmml" xref="Thmthm3.p1.11.11.m11.3.3">…</ci><apply id="Thmthm3.p1.11.11.m11.4.4.1.1.1.cmml" xref="Thmthm3.p1.11.11.m11.4.4.1.1.1"><minus id="Thmthm3.p1.11.11.m11.4.4.1.1.1.1.cmml" xref="Thmthm3.p1.11.11.m11.4.4.1.1.1.1"></minus><ci id="Thmthm3.p1.11.11.m11.4.4.1.1.1.2.cmml" xref="Thmthm3.p1.11.11.m11.4.4.1.1.1.2">𝐿</ci><cn id="Thmthm3.p1.11.11.m11.4.4.1.1.1.3.cmml" type="integer" xref="Thmthm3.p1.11.11.m11.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.11.11.m11.4c">i_{1}\in\{0,1,\ldots,L-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.11.11.m11.4d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , italic_L - 1 }</annotation></semantics></math> and <math alttext="j_{1}\in\{0,1,\ldots,2L-2\}" class="ltx_Math" display="inline" id="Thmthm3.p1.12.12.m12.4"><semantics id="Thmthm3.p1.12.12.m12.4a"><mrow id="Thmthm3.p1.12.12.m12.4.4" xref="Thmthm3.p1.12.12.m12.4.4.cmml"><msub id="Thmthm3.p1.12.12.m12.4.4.3" xref="Thmthm3.p1.12.12.m12.4.4.3.cmml"><mi id="Thmthm3.p1.12.12.m12.4.4.3.2" xref="Thmthm3.p1.12.12.m12.4.4.3.2.cmml">j</mi><mn id="Thmthm3.p1.12.12.m12.4.4.3.3" xref="Thmthm3.p1.12.12.m12.4.4.3.3.cmml">1</mn></msub><mo id="Thmthm3.p1.12.12.m12.4.4.2" xref="Thmthm3.p1.12.12.m12.4.4.2.cmml">∈</mo><mrow id="Thmthm3.p1.12.12.m12.4.4.1.1" xref="Thmthm3.p1.12.12.m12.4.4.1.2.cmml"><mo id="Thmthm3.p1.12.12.m12.4.4.1.1.2" stretchy="false" xref="Thmthm3.p1.12.12.m12.4.4.1.2.cmml">{</mo><mn id="Thmthm3.p1.12.12.m12.1.1" xref="Thmthm3.p1.12.12.m12.1.1.cmml">0</mn><mo id="Thmthm3.p1.12.12.m12.4.4.1.1.3" xref="Thmthm3.p1.12.12.m12.4.4.1.2.cmml">,</mo><mn id="Thmthm3.p1.12.12.m12.2.2" xref="Thmthm3.p1.12.12.m12.2.2.cmml">1</mn><mo id="Thmthm3.p1.12.12.m12.4.4.1.1.4" xref="Thmthm3.p1.12.12.m12.4.4.1.2.cmml">,</mo><mi id="Thmthm3.p1.12.12.m12.3.3" mathvariant="normal" xref="Thmthm3.p1.12.12.m12.3.3.cmml">…</mi><mo id="Thmthm3.p1.12.12.m12.4.4.1.1.5" xref="Thmthm3.p1.12.12.m12.4.4.1.2.cmml">,</mo><mrow id="Thmthm3.p1.12.12.m12.4.4.1.1.1" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.cmml"><mrow id="Thmthm3.p1.12.12.m12.4.4.1.1.1.2" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.cmml"><mn id="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.2" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.2.cmml">2</mn><mo id="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.1" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.3" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.3.cmml">L</mi></mrow><mo id="Thmthm3.p1.12.12.m12.4.4.1.1.1.1" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.1.cmml">−</mo><mn id="Thmthm3.p1.12.12.m12.4.4.1.1.1.3" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="Thmthm3.p1.12.12.m12.4.4.1.1.6" stretchy="false" xref="Thmthm3.p1.12.12.m12.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.12.12.m12.4b"><apply id="Thmthm3.p1.12.12.m12.4.4.cmml" xref="Thmthm3.p1.12.12.m12.4.4"><in id="Thmthm3.p1.12.12.m12.4.4.2.cmml" xref="Thmthm3.p1.12.12.m12.4.4.2"></in><apply id="Thmthm3.p1.12.12.m12.4.4.3.cmml" xref="Thmthm3.p1.12.12.m12.4.4.3"><csymbol cd="ambiguous" id="Thmthm3.p1.12.12.m12.4.4.3.1.cmml" xref="Thmthm3.p1.12.12.m12.4.4.3">subscript</csymbol><ci id="Thmthm3.p1.12.12.m12.4.4.3.2.cmml" xref="Thmthm3.p1.12.12.m12.4.4.3.2">𝑗</ci><cn id="Thmthm3.p1.12.12.m12.4.4.3.3.cmml" type="integer" xref="Thmthm3.p1.12.12.m12.4.4.3.3">1</cn></apply><set id="Thmthm3.p1.12.12.m12.4.4.1.2.cmml" xref="Thmthm3.p1.12.12.m12.4.4.1.1"><cn id="Thmthm3.p1.12.12.m12.1.1.cmml" type="integer" xref="Thmthm3.p1.12.12.m12.1.1">0</cn><cn id="Thmthm3.p1.12.12.m12.2.2.cmml" type="integer" xref="Thmthm3.p1.12.12.m12.2.2">1</cn><ci id="Thmthm3.p1.12.12.m12.3.3.cmml" xref="Thmthm3.p1.12.12.m12.3.3">…</ci><apply id="Thmthm3.p1.12.12.m12.4.4.1.1.1.cmml" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1"><minus id="Thmthm3.p1.12.12.m12.4.4.1.1.1.1.cmml" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.1"></minus><apply id="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.cmml" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.2"><times id="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.1.cmml" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.1"></times><cn id="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.2.cmml" type="integer" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.2">2</cn><ci id="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.3.cmml" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.2.3">𝐿</ci></apply><cn id="Thmthm3.p1.12.12.m12.4.4.1.1.1.3.cmml" type="integer" xref="Thmthm3.p1.12.12.m12.4.4.1.1.1.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.12.12.m12.4c">j_{1}\in\{0,1,\ldots,2L-2\}</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.12.12.m12.4d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , 2 italic_L - 2 }</annotation></semantics></math>. Moreover, the equality <math alttext="\langle Q_{i},K_{j}\rangle=T_{A}[r,i_{1},j_{1}]" class="ltx_Math" display="inline" id="Thmthm3.p1.13.13.m13.5"><semantics id="Thmthm3.p1.13.13.m13.5a"><mrow id="Thmthm3.p1.13.13.m13.5.5" xref="Thmthm3.p1.13.13.m13.5.5.cmml"><mrow id="Thmthm3.p1.13.13.m13.3.3.2.2" xref="Thmthm3.p1.13.13.m13.3.3.2.3.cmml"><mo id="Thmthm3.p1.13.13.m13.3.3.2.2.3" stretchy="false" xref="Thmthm3.p1.13.13.m13.3.3.2.3.cmml">⟨</mo><msub id="Thmthm3.p1.13.13.m13.2.2.1.1.1" xref="Thmthm3.p1.13.13.m13.2.2.1.1.1.cmml"><mi id="Thmthm3.p1.13.13.m13.2.2.1.1.1.2" xref="Thmthm3.p1.13.13.m13.2.2.1.1.1.2.cmml">Q</mi><mi id="Thmthm3.p1.13.13.m13.2.2.1.1.1.3" xref="Thmthm3.p1.13.13.m13.2.2.1.1.1.3.cmml">i</mi></msub><mo id="Thmthm3.p1.13.13.m13.3.3.2.2.4" xref="Thmthm3.p1.13.13.m13.3.3.2.3.cmml">,</mo><msub id="Thmthm3.p1.13.13.m13.3.3.2.2.2" xref="Thmthm3.p1.13.13.m13.3.3.2.2.2.cmml"><mi id="Thmthm3.p1.13.13.m13.3.3.2.2.2.2" xref="Thmthm3.p1.13.13.m13.3.3.2.2.2.2.cmml">K</mi><mi id="Thmthm3.p1.13.13.m13.3.3.2.2.2.3" xref="Thmthm3.p1.13.13.m13.3.3.2.2.2.3.cmml">j</mi></msub><mo id="Thmthm3.p1.13.13.m13.3.3.2.2.5" stretchy="false" xref="Thmthm3.p1.13.13.m13.3.3.2.3.cmml">⟩</mo></mrow><mo id="Thmthm3.p1.13.13.m13.5.5.5" xref="Thmthm3.p1.13.13.m13.5.5.5.cmml">=</mo><mrow id="Thmthm3.p1.13.13.m13.5.5.4" xref="Thmthm3.p1.13.13.m13.5.5.4.cmml"><msub id="Thmthm3.p1.13.13.m13.5.5.4.4" xref="Thmthm3.p1.13.13.m13.5.5.4.4.cmml"><mi id="Thmthm3.p1.13.13.m13.5.5.4.4.2" xref="Thmthm3.p1.13.13.m13.5.5.4.4.2.cmml">T</mi><mi id="Thmthm3.p1.13.13.m13.5.5.4.4.3" xref="Thmthm3.p1.13.13.m13.5.5.4.4.3.cmml">A</mi></msub><mo id="Thmthm3.p1.13.13.m13.5.5.4.3" xref="Thmthm3.p1.13.13.m13.5.5.4.3.cmml">⁢</mo><mrow id="Thmthm3.p1.13.13.m13.5.5.4.2.2" xref="Thmthm3.p1.13.13.m13.5.5.4.2.3.cmml"><mo id="Thmthm3.p1.13.13.m13.5.5.4.2.2.3" stretchy="false" xref="Thmthm3.p1.13.13.m13.5.5.4.2.3.cmml">[</mo><mi id="Thmthm3.p1.13.13.m13.1.1" xref="Thmthm3.p1.13.13.m13.1.1.cmml">r</mi><mo id="Thmthm3.p1.13.13.m13.5.5.4.2.2.4" xref="Thmthm3.p1.13.13.m13.5.5.4.2.3.cmml">,</mo><msub id="Thmthm3.p1.13.13.m13.4.4.3.1.1.1" xref="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.cmml"><mi id="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.2" xref="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.2.cmml">i</mi><mn id="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.3" xref="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.3.cmml">1</mn></msub><mo id="Thmthm3.p1.13.13.m13.5.5.4.2.2.5" xref="Thmthm3.p1.13.13.m13.5.5.4.2.3.cmml">,</mo><msub id="Thmthm3.p1.13.13.m13.5.5.4.2.2.2" xref="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.cmml"><mi id="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.2" xref="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.2.cmml">j</mi><mn id="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.3" xref="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.3.cmml">1</mn></msub><mo id="Thmthm3.p1.13.13.m13.5.5.4.2.2.6" stretchy="false" xref="Thmthm3.p1.13.13.m13.5.5.4.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm3.p1.13.13.m13.5b"><apply id="Thmthm3.p1.13.13.m13.5.5.cmml" xref="Thmthm3.p1.13.13.m13.5.5"><eq id="Thmthm3.p1.13.13.m13.5.5.5.cmml" xref="Thmthm3.p1.13.13.m13.5.5.5"></eq><list id="Thmthm3.p1.13.13.m13.3.3.2.3.cmml" xref="Thmthm3.p1.13.13.m13.3.3.2.2"><apply id="Thmthm3.p1.13.13.m13.2.2.1.1.1.cmml" xref="Thmthm3.p1.13.13.m13.2.2.1.1.1"><csymbol cd="ambiguous" id="Thmthm3.p1.13.13.m13.2.2.1.1.1.1.cmml" xref="Thmthm3.p1.13.13.m13.2.2.1.1.1">subscript</csymbol><ci id="Thmthm3.p1.13.13.m13.2.2.1.1.1.2.cmml" xref="Thmthm3.p1.13.13.m13.2.2.1.1.1.2">𝑄</ci><ci id="Thmthm3.p1.13.13.m13.2.2.1.1.1.3.cmml" xref="Thmthm3.p1.13.13.m13.2.2.1.1.1.3">𝑖</ci></apply><apply id="Thmthm3.p1.13.13.m13.3.3.2.2.2.cmml" xref="Thmthm3.p1.13.13.m13.3.3.2.2.2"><csymbol cd="ambiguous" id="Thmthm3.p1.13.13.m13.3.3.2.2.2.1.cmml" xref="Thmthm3.p1.13.13.m13.3.3.2.2.2">subscript</csymbol><ci id="Thmthm3.p1.13.13.m13.3.3.2.2.2.2.cmml" xref="Thmthm3.p1.13.13.m13.3.3.2.2.2.2">𝐾</ci><ci id="Thmthm3.p1.13.13.m13.3.3.2.2.2.3.cmml" xref="Thmthm3.p1.13.13.m13.3.3.2.2.2.3">𝑗</ci></apply></list><apply id="Thmthm3.p1.13.13.m13.5.5.4.cmml" xref="Thmthm3.p1.13.13.m13.5.5.4"><times id="Thmthm3.p1.13.13.m13.5.5.4.3.cmml" xref="Thmthm3.p1.13.13.m13.5.5.4.3"></times><apply id="Thmthm3.p1.13.13.m13.5.5.4.4.cmml" xref="Thmthm3.p1.13.13.m13.5.5.4.4"><csymbol cd="ambiguous" id="Thmthm3.p1.13.13.m13.5.5.4.4.1.cmml" xref="Thmthm3.p1.13.13.m13.5.5.4.4">subscript</csymbol><ci id="Thmthm3.p1.13.13.m13.5.5.4.4.2.cmml" xref="Thmthm3.p1.13.13.m13.5.5.4.4.2">𝑇</ci><ci id="Thmthm3.p1.13.13.m13.5.5.4.4.3.cmml" xref="Thmthm3.p1.13.13.m13.5.5.4.4.3">𝐴</ci></apply><list id="Thmthm3.p1.13.13.m13.5.5.4.2.3.cmml" xref="Thmthm3.p1.13.13.m13.5.5.4.2.2"><ci id="Thmthm3.p1.13.13.m13.1.1.cmml" xref="Thmthm3.p1.13.13.m13.1.1">𝑟</ci><apply id="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.cmml" xref="Thmthm3.p1.13.13.m13.4.4.3.1.1.1"><csymbol cd="ambiguous" id="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.1.cmml" xref="Thmthm3.p1.13.13.m13.4.4.3.1.1.1">subscript</csymbol><ci id="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.2.cmml" xref="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.2">𝑖</ci><cn id="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.3.cmml" type="integer" xref="Thmthm3.p1.13.13.m13.4.4.3.1.1.1.3">1</cn></apply><apply id="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.cmml" xref="Thmthm3.p1.13.13.m13.5.5.4.2.2.2"><csymbol cd="ambiguous" id="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.1.cmml" xref="Thmthm3.p1.13.13.m13.5.5.4.2.2.2">subscript</csymbol><ci id="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.2.cmml" xref="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.2">𝑗</ci><cn id="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.3.cmml" type="integer" xref="Thmthm3.p1.13.13.m13.5.5.4.2.2.2.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm3.p1.13.13.m13.5c">\langle Q_{i},K_{j}\rangle=T_{A}[r,i_{1},j_{1}]</annotation><annotation encoding="application/x-llamapun" id="Thmthm3.p1.13.13.m13.5d">⟨ italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ = italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math> holds.</span></p>
</div>
</div>
<div class="ltx_proof" id="S3.2">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.2.p1">
<p class="ltx_p" id="S3.2.p1.16">Recall that <math alttext="T_{Q}" class="ltx_Math" display="inline" id="S3.2.p1.1.m1.1"><semantics id="S3.2.p1.1.m1.1a"><msub id="S3.2.p1.1.m1.1.1" xref="S3.2.p1.1.m1.1.1.cmml"><mi id="S3.2.p1.1.m1.1.1.2" xref="S3.2.p1.1.m1.1.1.2.cmml">T</mi><mi id="S3.2.p1.1.m1.1.1.3" xref="S3.2.p1.1.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.2.p1.1.m1.1b"><apply id="S3.2.p1.1.m1.1.1.cmml" xref="S3.2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.2.p1.1.m1.1.1.1.cmml" xref="S3.2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.2.p1.1.m1.1.1.2.cmml" xref="S3.2.p1.1.m1.1.1.2">𝑇</ci><ci id="S3.2.p1.1.m1.1.1.3.cmml" xref="S3.2.p1.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.1.m1.1c">T_{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> has dimension <math alttext="s\times L\times d_{q}" class="ltx_Math" display="inline" id="S3.2.p1.2.m2.1"><semantics id="S3.2.p1.2.m2.1a"><mrow id="S3.2.p1.2.m2.1.1" xref="S3.2.p1.2.m2.1.1.cmml"><mi id="S3.2.p1.2.m2.1.1.2" xref="S3.2.p1.2.m2.1.1.2.cmml">s</mi><mo id="S3.2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.2.p1.2.m2.1.1.1.cmml">×</mo><mi id="S3.2.p1.2.m2.1.1.3" xref="S3.2.p1.2.m2.1.1.3.cmml">L</mi><mo id="S3.2.p1.2.m2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.2.p1.2.m2.1.1.1.cmml">×</mo><msub id="S3.2.p1.2.m2.1.1.4" xref="S3.2.p1.2.m2.1.1.4.cmml"><mi id="S3.2.p1.2.m2.1.1.4.2" xref="S3.2.p1.2.m2.1.1.4.2.cmml">d</mi><mi id="S3.2.p1.2.m2.1.1.4.3" xref="S3.2.p1.2.m2.1.1.4.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.2.m2.1b"><apply id="S3.2.p1.2.m2.1.1.cmml" xref="S3.2.p1.2.m2.1.1"><times id="S3.2.p1.2.m2.1.1.1.cmml" xref="S3.2.p1.2.m2.1.1.1"></times><ci id="S3.2.p1.2.m2.1.1.2.cmml" xref="S3.2.p1.2.m2.1.1.2">𝑠</ci><ci id="S3.2.p1.2.m2.1.1.3.cmml" xref="S3.2.p1.2.m2.1.1.3">𝐿</ci><apply id="S3.2.p1.2.m2.1.1.4.cmml" xref="S3.2.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S3.2.p1.2.m2.1.1.4.1.cmml" xref="S3.2.p1.2.m2.1.1.4">subscript</csymbol><ci id="S3.2.p1.2.m2.1.1.4.2.cmml" xref="S3.2.p1.2.m2.1.1.4.2">𝑑</ci><ci id="S3.2.p1.2.m2.1.1.4.3.cmml" xref="S3.2.p1.2.m2.1.1.4.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.2.m2.1c">s\times L\times d_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.2.m2.1d">italic_s × italic_L × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="T_{K}" class="ltx_Math" display="inline" id="S3.2.p1.3.m3.1"><semantics id="S3.2.p1.3.m3.1a"><msub id="S3.2.p1.3.m3.1.1" xref="S3.2.p1.3.m3.1.1.cmml"><mi id="S3.2.p1.3.m3.1.1.2" xref="S3.2.p1.3.m3.1.1.2.cmml">T</mi><mi id="S3.2.p1.3.m3.1.1.3" xref="S3.2.p1.3.m3.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.2.p1.3.m3.1b"><apply id="S3.2.p1.3.m3.1.1.cmml" xref="S3.2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.2.p1.3.m3.1.1.1.cmml" xref="S3.2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.2.p1.3.m3.1.1.2.cmml" xref="S3.2.p1.3.m3.1.1.2">𝑇</ci><ci id="S3.2.p1.3.m3.1.1.3.cmml" xref="S3.2.p1.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.3.m3.1c">T_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.3.m3.1d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> has dimension <math alttext="s\times(2L-1)\times d_{q}" class="ltx_Math" display="inline" id="S3.2.p1.4.m4.1"><semantics id="S3.2.p1.4.m4.1a"><mrow id="S3.2.p1.4.m4.1.1" xref="S3.2.p1.4.m4.1.1.cmml"><mi id="S3.2.p1.4.m4.1.1.3" xref="S3.2.p1.4.m4.1.1.3.cmml">s</mi><mo id="S3.2.p1.4.m4.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.2.p1.4.m4.1.1.2.cmml">×</mo><mrow id="S3.2.p1.4.m4.1.1.1.1" xref="S3.2.p1.4.m4.1.1.1.1.1.cmml"><mo id="S3.2.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S3.2.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.2.p1.4.m4.1.1.1.1.1" xref="S3.2.p1.4.m4.1.1.1.1.1.cmml"><mrow id="S3.2.p1.4.m4.1.1.1.1.1.2" xref="S3.2.p1.4.m4.1.1.1.1.1.2.cmml"><mn id="S3.2.p1.4.m4.1.1.1.1.1.2.2" xref="S3.2.p1.4.m4.1.1.1.1.1.2.2.cmml">2</mn><mo id="S3.2.p1.4.m4.1.1.1.1.1.2.1" xref="S3.2.p1.4.m4.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.2.p1.4.m4.1.1.1.1.1.2.3" xref="S3.2.p1.4.m4.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.2.p1.4.m4.1.1.1.1.1.1" xref="S3.2.p1.4.m4.1.1.1.1.1.1.cmml">−</mo><mn id="S3.2.p1.4.m4.1.1.1.1.1.3" xref="S3.2.p1.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.2.p1.4.m4.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.2.p1.4.m4.1.1.2a" rspace="0.222em" xref="S3.2.p1.4.m4.1.1.2.cmml">×</mo><msub id="S3.2.p1.4.m4.1.1.4" xref="S3.2.p1.4.m4.1.1.4.cmml"><mi id="S3.2.p1.4.m4.1.1.4.2" xref="S3.2.p1.4.m4.1.1.4.2.cmml">d</mi><mi id="S3.2.p1.4.m4.1.1.4.3" xref="S3.2.p1.4.m4.1.1.4.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.4.m4.1b"><apply id="S3.2.p1.4.m4.1.1.cmml" xref="S3.2.p1.4.m4.1.1"><times id="S3.2.p1.4.m4.1.1.2.cmml" xref="S3.2.p1.4.m4.1.1.2"></times><ci id="S3.2.p1.4.m4.1.1.3.cmml" xref="S3.2.p1.4.m4.1.1.3">𝑠</ci><apply id="S3.2.p1.4.m4.1.1.1.1.1.cmml" xref="S3.2.p1.4.m4.1.1.1.1"><minus id="S3.2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.2.p1.4.m4.1.1.1.1.1.1"></minus><apply id="S3.2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.2.p1.4.m4.1.1.1.1.1.2"><times id="S3.2.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.2.p1.4.m4.1.1.1.1.1.2.1"></times><cn id="S3.2.p1.4.m4.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.2.p1.4.m4.1.1.1.1.1.2.2">2</cn><ci id="S3.2.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.2.p1.4.m4.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="S3.2.p1.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S3.2.p1.4.m4.1.1.1.1.1.3">1</cn></apply><apply id="S3.2.p1.4.m4.1.1.4.cmml" xref="S3.2.p1.4.m4.1.1.4"><csymbol cd="ambiguous" id="S3.2.p1.4.m4.1.1.4.1.cmml" xref="S3.2.p1.4.m4.1.1.4">subscript</csymbol><ci id="S3.2.p1.4.m4.1.1.4.2.cmml" xref="S3.2.p1.4.m4.1.1.4.2">𝑑</ci><ci id="S3.2.p1.4.m4.1.1.4.3.cmml" xref="S3.2.p1.4.m4.1.1.4.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.4.m4.1c">s\times(2L-1)\times d_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.4.m4.1d">italic_s × ( 2 italic_L - 1 ) × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, so <math alttext="T_{K}[r,\cdot,\cdot]^{T}" class="ltx_Math" display="inline" id="S3.2.p1.5.m5.3"><semantics id="S3.2.p1.5.m5.3a"><mrow id="S3.2.p1.5.m5.3.4" xref="S3.2.p1.5.m5.3.4.cmml"><msub id="S3.2.p1.5.m5.3.4.2" xref="S3.2.p1.5.m5.3.4.2.cmml"><mi id="S3.2.p1.5.m5.3.4.2.2" xref="S3.2.p1.5.m5.3.4.2.2.cmml">T</mi><mi id="S3.2.p1.5.m5.3.4.2.3" xref="S3.2.p1.5.m5.3.4.2.3.cmml">K</mi></msub><mo id="S3.2.p1.5.m5.3.4.1" xref="S3.2.p1.5.m5.3.4.1.cmml">⁢</mo><msup id="S3.2.p1.5.m5.3.4.3" xref="S3.2.p1.5.m5.3.4.3.cmml"><mrow id="S3.2.p1.5.m5.3.4.3.2.2" xref="S3.2.p1.5.m5.3.4.3.2.1.cmml"><mo id="S3.2.p1.5.m5.3.4.3.2.2.1" stretchy="false" xref="S3.2.p1.5.m5.3.4.3.2.1.cmml">[</mo><mi id="S3.2.p1.5.m5.1.1" xref="S3.2.p1.5.m5.1.1.cmml">r</mi><mo id="S3.2.p1.5.m5.3.4.3.2.2.2" rspace="0em" xref="S3.2.p1.5.m5.3.4.3.2.1.cmml">,</mo><mo id="S3.2.p1.5.m5.2.2" lspace="0em" rspace="0em" xref="S3.2.p1.5.m5.2.2.cmml">⋅</mo><mo id="S3.2.p1.5.m5.3.4.3.2.2.3" rspace="0em" xref="S3.2.p1.5.m5.3.4.3.2.1.cmml">,</mo><mo id="S3.2.p1.5.m5.3.3" lspace="0em" rspace="0em" xref="S3.2.p1.5.m5.3.3.cmml">⋅</mo><mo id="S3.2.p1.5.m5.3.4.3.2.2.4" stretchy="false" xref="S3.2.p1.5.m5.3.4.3.2.1.cmml">]</mo></mrow><mi id="S3.2.p1.5.m5.3.4.3.3" xref="S3.2.p1.5.m5.3.4.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.5.m5.3b"><apply id="S3.2.p1.5.m5.3.4.cmml" xref="S3.2.p1.5.m5.3.4"><times id="S3.2.p1.5.m5.3.4.1.cmml" xref="S3.2.p1.5.m5.3.4.1"></times><apply id="S3.2.p1.5.m5.3.4.2.cmml" xref="S3.2.p1.5.m5.3.4.2"><csymbol cd="ambiguous" id="S3.2.p1.5.m5.3.4.2.1.cmml" xref="S3.2.p1.5.m5.3.4.2">subscript</csymbol><ci id="S3.2.p1.5.m5.3.4.2.2.cmml" xref="S3.2.p1.5.m5.3.4.2.2">𝑇</ci><ci id="S3.2.p1.5.m5.3.4.2.3.cmml" xref="S3.2.p1.5.m5.3.4.2.3">𝐾</ci></apply><apply id="S3.2.p1.5.m5.3.4.3.cmml" xref="S3.2.p1.5.m5.3.4.3"><csymbol cd="ambiguous" id="S3.2.p1.5.m5.3.4.3.1.cmml" xref="S3.2.p1.5.m5.3.4.3">superscript</csymbol><list id="S3.2.p1.5.m5.3.4.3.2.1.cmml" xref="S3.2.p1.5.m5.3.4.3.2.2"><ci id="S3.2.p1.5.m5.1.1.cmml" xref="S3.2.p1.5.m5.1.1">𝑟</ci><ci id="S3.2.p1.5.m5.2.2.cmml" xref="S3.2.p1.5.m5.2.2">⋅</ci><ci id="S3.2.p1.5.m5.3.3.cmml" xref="S3.2.p1.5.m5.3.3">⋅</ci></list><ci id="S3.2.p1.5.m5.3.4.3.3.cmml" xref="S3.2.p1.5.m5.3.4.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.5.m5.3c">T_{K}[r,\cdot,\cdot]^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.5.m5.3d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> has dimensions <math alttext="d_{q}\times(2L-1)" class="ltx_Math" display="inline" id="S3.2.p1.6.m6.1"><semantics id="S3.2.p1.6.m6.1a"><mrow id="S3.2.p1.6.m6.1.1" xref="S3.2.p1.6.m6.1.1.cmml"><msub id="S3.2.p1.6.m6.1.1.3" xref="S3.2.p1.6.m6.1.1.3.cmml"><mi id="S3.2.p1.6.m6.1.1.3.2" xref="S3.2.p1.6.m6.1.1.3.2.cmml">d</mi><mi id="S3.2.p1.6.m6.1.1.3.3" xref="S3.2.p1.6.m6.1.1.3.3.cmml">q</mi></msub><mo id="S3.2.p1.6.m6.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.2.p1.6.m6.1.1.2.cmml">×</mo><mrow id="S3.2.p1.6.m6.1.1.1.1" xref="S3.2.p1.6.m6.1.1.1.1.1.cmml"><mo id="S3.2.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S3.2.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.2.p1.6.m6.1.1.1.1.1" xref="S3.2.p1.6.m6.1.1.1.1.1.cmml"><mrow id="S3.2.p1.6.m6.1.1.1.1.1.2" xref="S3.2.p1.6.m6.1.1.1.1.1.2.cmml"><mn id="S3.2.p1.6.m6.1.1.1.1.1.2.2" xref="S3.2.p1.6.m6.1.1.1.1.1.2.2.cmml">2</mn><mo id="S3.2.p1.6.m6.1.1.1.1.1.2.1" xref="S3.2.p1.6.m6.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.2.p1.6.m6.1.1.1.1.1.2.3" xref="S3.2.p1.6.m6.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.2.p1.6.m6.1.1.1.1.1.1" xref="S3.2.p1.6.m6.1.1.1.1.1.1.cmml">−</mo><mn id="S3.2.p1.6.m6.1.1.1.1.1.3" xref="S3.2.p1.6.m6.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.2.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S3.2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.6.m6.1b"><apply id="S3.2.p1.6.m6.1.1.cmml" xref="S3.2.p1.6.m6.1.1"><times id="S3.2.p1.6.m6.1.1.2.cmml" xref="S3.2.p1.6.m6.1.1.2"></times><apply id="S3.2.p1.6.m6.1.1.3.cmml" xref="S3.2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.2.p1.6.m6.1.1.3.1.cmml" xref="S3.2.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.2.p1.6.m6.1.1.3.2.cmml" xref="S3.2.p1.6.m6.1.1.3.2">𝑑</ci><ci id="S3.2.p1.6.m6.1.1.3.3.cmml" xref="S3.2.p1.6.m6.1.1.3.3">𝑞</ci></apply><apply id="S3.2.p1.6.m6.1.1.1.1.1.cmml" xref="S3.2.p1.6.m6.1.1.1.1"><minus id="S3.2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.2.p1.6.m6.1.1.1.1.1.1"></minus><apply id="S3.2.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.2.p1.6.m6.1.1.1.1.1.2"><times id="S3.2.p1.6.m6.1.1.1.1.1.2.1.cmml" xref="S3.2.p1.6.m6.1.1.1.1.1.2.1"></times><cn id="S3.2.p1.6.m6.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.2.p1.6.m6.1.1.1.1.1.2.2">2</cn><ci id="S3.2.p1.6.m6.1.1.1.1.1.2.3.cmml" xref="S3.2.p1.6.m6.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="S3.2.p1.6.m6.1.1.1.1.1.3.cmml" type="integer" xref="S3.2.p1.6.m6.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.6.m6.1c">d_{q}\times(2L-1)</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.6.m6.1d">italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT × ( 2 italic_L - 1 )</annotation></semantics></math> and <math alttext="T_{Q}[r,\cdot,\cdot]T_{K}[r,\cdot,\cdot]^{T}" class="ltx_Math" display="inline" id="S3.2.p1.7.m7.6"><semantics id="S3.2.p1.7.m7.6a"><mrow id="S3.2.p1.7.m7.6.7" xref="S3.2.p1.7.m7.6.7.cmml"><msub id="S3.2.p1.7.m7.6.7.2" xref="S3.2.p1.7.m7.6.7.2.cmml"><mi id="S3.2.p1.7.m7.6.7.2.2" xref="S3.2.p1.7.m7.6.7.2.2.cmml">T</mi><mi id="S3.2.p1.7.m7.6.7.2.3" xref="S3.2.p1.7.m7.6.7.2.3.cmml">Q</mi></msub><mo id="S3.2.p1.7.m7.6.7.1" xref="S3.2.p1.7.m7.6.7.1.cmml">⁢</mo><mrow id="S3.2.p1.7.m7.6.7.3.2" xref="S3.2.p1.7.m7.6.7.3.1.cmml"><mo id="S3.2.p1.7.m7.6.7.3.2.1" stretchy="false" xref="S3.2.p1.7.m7.6.7.3.1.cmml">[</mo><mi id="S3.2.p1.7.m7.1.1" xref="S3.2.p1.7.m7.1.1.cmml">r</mi><mo id="S3.2.p1.7.m7.6.7.3.2.2" rspace="0em" xref="S3.2.p1.7.m7.6.7.3.1.cmml">,</mo><mo id="S3.2.p1.7.m7.2.2" lspace="0em" rspace="0em" xref="S3.2.p1.7.m7.2.2.cmml">⋅</mo><mo id="S3.2.p1.7.m7.6.7.3.2.3" rspace="0em" xref="S3.2.p1.7.m7.6.7.3.1.cmml">,</mo><mo id="S3.2.p1.7.m7.3.3" lspace="0em" rspace="0em" xref="S3.2.p1.7.m7.3.3.cmml">⋅</mo><mo id="S3.2.p1.7.m7.6.7.3.2.4" stretchy="false" xref="S3.2.p1.7.m7.6.7.3.1.cmml">]</mo></mrow><mo id="S3.2.p1.7.m7.6.7.1a" xref="S3.2.p1.7.m7.6.7.1.cmml">⁢</mo><msub id="S3.2.p1.7.m7.6.7.4" xref="S3.2.p1.7.m7.6.7.4.cmml"><mi id="S3.2.p1.7.m7.6.7.4.2" xref="S3.2.p1.7.m7.6.7.4.2.cmml">T</mi><mi id="S3.2.p1.7.m7.6.7.4.3" xref="S3.2.p1.7.m7.6.7.4.3.cmml">K</mi></msub><mo id="S3.2.p1.7.m7.6.7.1b" xref="S3.2.p1.7.m7.6.7.1.cmml">⁢</mo><msup id="S3.2.p1.7.m7.6.7.5" xref="S3.2.p1.7.m7.6.7.5.cmml"><mrow id="S3.2.p1.7.m7.6.7.5.2.2" xref="S3.2.p1.7.m7.6.7.5.2.1.cmml"><mo id="S3.2.p1.7.m7.6.7.5.2.2.1" stretchy="false" xref="S3.2.p1.7.m7.6.7.5.2.1.cmml">[</mo><mi id="S3.2.p1.7.m7.4.4" xref="S3.2.p1.7.m7.4.4.cmml">r</mi><mo id="S3.2.p1.7.m7.6.7.5.2.2.2" rspace="0em" xref="S3.2.p1.7.m7.6.7.5.2.1.cmml">,</mo><mo id="S3.2.p1.7.m7.5.5" lspace="0em" rspace="0em" xref="S3.2.p1.7.m7.5.5.cmml">⋅</mo><mo id="S3.2.p1.7.m7.6.7.5.2.2.3" rspace="0em" xref="S3.2.p1.7.m7.6.7.5.2.1.cmml">,</mo><mo id="S3.2.p1.7.m7.6.6" lspace="0em" rspace="0em" xref="S3.2.p1.7.m7.6.6.cmml">⋅</mo><mo id="S3.2.p1.7.m7.6.7.5.2.2.4" stretchy="false" xref="S3.2.p1.7.m7.6.7.5.2.1.cmml">]</mo></mrow><mi id="S3.2.p1.7.m7.6.7.5.3" xref="S3.2.p1.7.m7.6.7.5.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.7.m7.6b"><apply id="S3.2.p1.7.m7.6.7.cmml" xref="S3.2.p1.7.m7.6.7"><times id="S3.2.p1.7.m7.6.7.1.cmml" xref="S3.2.p1.7.m7.6.7.1"></times><apply id="S3.2.p1.7.m7.6.7.2.cmml" xref="S3.2.p1.7.m7.6.7.2"><csymbol cd="ambiguous" id="S3.2.p1.7.m7.6.7.2.1.cmml" xref="S3.2.p1.7.m7.6.7.2">subscript</csymbol><ci id="S3.2.p1.7.m7.6.7.2.2.cmml" xref="S3.2.p1.7.m7.6.7.2.2">𝑇</ci><ci id="S3.2.p1.7.m7.6.7.2.3.cmml" xref="S3.2.p1.7.m7.6.7.2.3">𝑄</ci></apply><list id="S3.2.p1.7.m7.6.7.3.1.cmml" xref="S3.2.p1.7.m7.6.7.3.2"><ci id="S3.2.p1.7.m7.1.1.cmml" xref="S3.2.p1.7.m7.1.1">𝑟</ci><ci id="S3.2.p1.7.m7.2.2.cmml" xref="S3.2.p1.7.m7.2.2">⋅</ci><ci id="S3.2.p1.7.m7.3.3.cmml" xref="S3.2.p1.7.m7.3.3">⋅</ci></list><apply id="S3.2.p1.7.m7.6.7.4.cmml" xref="S3.2.p1.7.m7.6.7.4"><csymbol cd="ambiguous" id="S3.2.p1.7.m7.6.7.4.1.cmml" xref="S3.2.p1.7.m7.6.7.4">subscript</csymbol><ci id="S3.2.p1.7.m7.6.7.4.2.cmml" xref="S3.2.p1.7.m7.6.7.4.2">𝑇</ci><ci id="S3.2.p1.7.m7.6.7.4.3.cmml" xref="S3.2.p1.7.m7.6.7.4.3">𝐾</ci></apply><apply id="S3.2.p1.7.m7.6.7.5.cmml" xref="S3.2.p1.7.m7.6.7.5"><csymbol cd="ambiguous" id="S3.2.p1.7.m7.6.7.5.1.cmml" xref="S3.2.p1.7.m7.6.7.5">superscript</csymbol><list id="S3.2.p1.7.m7.6.7.5.2.1.cmml" xref="S3.2.p1.7.m7.6.7.5.2.2"><ci id="S3.2.p1.7.m7.4.4.cmml" xref="S3.2.p1.7.m7.4.4">𝑟</ci><ci id="S3.2.p1.7.m7.5.5.cmml" xref="S3.2.p1.7.m7.5.5">⋅</ci><ci id="S3.2.p1.7.m7.6.6.cmml" xref="S3.2.p1.7.m7.6.6">⋅</ci></list><ci id="S3.2.p1.7.m7.6.7.5.3.cmml" xref="S3.2.p1.7.m7.6.7.5.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.7.m7.6c">T_{Q}[r,\cdot,\cdot]T_{K}[r,\cdot,\cdot]^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.7.m7.6d">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ] italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> has dimensions <math alttext="L\times(2L-1)" class="ltx_Math" display="inline" id="S3.2.p1.8.m8.1"><semantics id="S3.2.p1.8.m8.1a"><mrow id="S3.2.p1.8.m8.1.1" xref="S3.2.p1.8.m8.1.1.cmml"><mi id="S3.2.p1.8.m8.1.1.3" xref="S3.2.p1.8.m8.1.1.3.cmml">L</mi><mo id="S3.2.p1.8.m8.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.2.p1.8.m8.1.1.2.cmml">×</mo><mrow id="S3.2.p1.8.m8.1.1.1.1" xref="S3.2.p1.8.m8.1.1.1.1.1.cmml"><mo id="S3.2.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S3.2.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.2.p1.8.m8.1.1.1.1.1" xref="S3.2.p1.8.m8.1.1.1.1.1.cmml"><mrow id="S3.2.p1.8.m8.1.1.1.1.1.2" xref="S3.2.p1.8.m8.1.1.1.1.1.2.cmml"><mn id="S3.2.p1.8.m8.1.1.1.1.1.2.2" xref="S3.2.p1.8.m8.1.1.1.1.1.2.2.cmml">2</mn><mo id="S3.2.p1.8.m8.1.1.1.1.1.2.1" xref="S3.2.p1.8.m8.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.2.p1.8.m8.1.1.1.1.1.2.3" xref="S3.2.p1.8.m8.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.2.p1.8.m8.1.1.1.1.1.1" xref="S3.2.p1.8.m8.1.1.1.1.1.1.cmml">−</mo><mn id="S3.2.p1.8.m8.1.1.1.1.1.3" xref="S3.2.p1.8.m8.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.2.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S3.2.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.8.m8.1b"><apply id="S3.2.p1.8.m8.1.1.cmml" xref="S3.2.p1.8.m8.1.1"><times id="S3.2.p1.8.m8.1.1.2.cmml" xref="S3.2.p1.8.m8.1.1.2"></times><ci id="S3.2.p1.8.m8.1.1.3.cmml" xref="S3.2.p1.8.m8.1.1.3">𝐿</ci><apply id="S3.2.p1.8.m8.1.1.1.1.1.cmml" xref="S3.2.p1.8.m8.1.1.1.1"><minus id="S3.2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.2.p1.8.m8.1.1.1.1.1.1"></minus><apply id="S3.2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.2.p1.8.m8.1.1.1.1.1.2"><times id="S3.2.p1.8.m8.1.1.1.1.1.2.1.cmml" xref="S3.2.p1.8.m8.1.1.1.1.1.2.1"></times><cn id="S3.2.p1.8.m8.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.2.p1.8.m8.1.1.1.1.1.2.2">2</cn><ci id="S3.2.p1.8.m8.1.1.1.1.1.2.3.cmml" xref="S3.2.p1.8.m8.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="S3.2.p1.8.m8.1.1.1.1.1.3.cmml" type="integer" xref="S3.2.p1.8.m8.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.8.m8.1c">L\times(2L-1)</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.8.m8.1d">italic_L × ( 2 italic_L - 1 )</annotation></semantics></math> as we wanted. For the second claim, first, we check that indeed <math alttext="i_{1}\in\{0,1,\ldots,L-1\}" class="ltx_Math" display="inline" id="S3.2.p1.9.m9.4"><semantics id="S3.2.p1.9.m9.4a"><mrow id="S3.2.p1.9.m9.4.4" xref="S3.2.p1.9.m9.4.4.cmml"><msub id="S3.2.p1.9.m9.4.4.3" xref="S3.2.p1.9.m9.4.4.3.cmml"><mi id="S3.2.p1.9.m9.4.4.3.2" xref="S3.2.p1.9.m9.4.4.3.2.cmml">i</mi><mn id="S3.2.p1.9.m9.4.4.3.3" xref="S3.2.p1.9.m9.4.4.3.3.cmml">1</mn></msub><mo id="S3.2.p1.9.m9.4.4.2" xref="S3.2.p1.9.m9.4.4.2.cmml">∈</mo><mrow id="S3.2.p1.9.m9.4.4.1.1" xref="S3.2.p1.9.m9.4.4.1.2.cmml"><mo id="S3.2.p1.9.m9.4.4.1.1.2" stretchy="false" xref="S3.2.p1.9.m9.4.4.1.2.cmml">{</mo><mn id="S3.2.p1.9.m9.1.1" xref="S3.2.p1.9.m9.1.1.cmml">0</mn><mo id="S3.2.p1.9.m9.4.4.1.1.3" xref="S3.2.p1.9.m9.4.4.1.2.cmml">,</mo><mn id="S3.2.p1.9.m9.2.2" xref="S3.2.p1.9.m9.2.2.cmml">1</mn><mo id="S3.2.p1.9.m9.4.4.1.1.4" xref="S3.2.p1.9.m9.4.4.1.2.cmml">,</mo><mi id="S3.2.p1.9.m9.3.3" mathvariant="normal" xref="S3.2.p1.9.m9.3.3.cmml">…</mi><mo id="S3.2.p1.9.m9.4.4.1.1.5" xref="S3.2.p1.9.m9.4.4.1.2.cmml">,</mo><mrow id="S3.2.p1.9.m9.4.4.1.1.1" xref="S3.2.p1.9.m9.4.4.1.1.1.cmml"><mi id="S3.2.p1.9.m9.4.4.1.1.1.2" xref="S3.2.p1.9.m9.4.4.1.1.1.2.cmml">L</mi><mo id="S3.2.p1.9.m9.4.4.1.1.1.1" xref="S3.2.p1.9.m9.4.4.1.1.1.1.cmml">−</mo><mn id="S3.2.p1.9.m9.4.4.1.1.1.3" xref="S3.2.p1.9.m9.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.2.p1.9.m9.4.4.1.1.6" stretchy="false" xref="S3.2.p1.9.m9.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.9.m9.4b"><apply id="S3.2.p1.9.m9.4.4.cmml" xref="S3.2.p1.9.m9.4.4"><in id="S3.2.p1.9.m9.4.4.2.cmml" xref="S3.2.p1.9.m9.4.4.2"></in><apply id="S3.2.p1.9.m9.4.4.3.cmml" xref="S3.2.p1.9.m9.4.4.3"><csymbol cd="ambiguous" id="S3.2.p1.9.m9.4.4.3.1.cmml" xref="S3.2.p1.9.m9.4.4.3">subscript</csymbol><ci id="S3.2.p1.9.m9.4.4.3.2.cmml" xref="S3.2.p1.9.m9.4.4.3.2">𝑖</ci><cn id="S3.2.p1.9.m9.4.4.3.3.cmml" type="integer" xref="S3.2.p1.9.m9.4.4.3.3">1</cn></apply><set id="S3.2.p1.9.m9.4.4.1.2.cmml" xref="S3.2.p1.9.m9.4.4.1.1"><cn id="S3.2.p1.9.m9.1.1.cmml" type="integer" xref="S3.2.p1.9.m9.1.1">0</cn><cn id="S3.2.p1.9.m9.2.2.cmml" type="integer" xref="S3.2.p1.9.m9.2.2">1</cn><ci id="S3.2.p1.9.m9.3.3.cmml" xref="S3.2.p1.9.m9.3.3">…</ci><apply id="S3.2.p1.9.m9.4.4.1.1.1.cmml" xref="S3.2.p1.9.m9.4.4.1.1.1"><minus id="S3.2.p1.9.m9.4.4.1.1.1.1.cmml" xref="S3.2.p1.9.m9.4.4.1.1.1.1"></minus><ci id="S3.2.p1.9.m9.4.4.1.1.1.2.cmml" xref="S3.2.p1.9.m9.4.4.1.1.1.2">𝐿</ci><cn id="S3.2.p1.9.m9.4.4.1.1.1.3.cmml" type="integer" xref="S3.2.p1.9.m9.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.9.m9.4c">i_{1}\in\{0,1,\ldots,L-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.9.m9.4d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , italic_L - 1 }</annotation></semantics></math> (which follows by the definition of <math alttext="\mod L" class="ltx_Math" display="inline" id="S3.2.p1.10.m10.1"><semantics id="S3.2.p1.10.m10.1a"><mrow id="S3.2.p1.10.m10.1.1" xref="S3.2.p1.10.m10.1.1.cmml"><mi id="S3.2.p1.10.m10.1.1.2" xref="S3.2.p1.10.m10.1.1.2.cmml"></mi><mo id="S3.2.p1.10.m10.1.1.1" xref="S3.2.p1.10.m10.1.1.1.cmml">mod</mo><mi id="S3.2.p1.10.m10.1.1.3" xref="S3.2.p1.10.m10.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.10.m10.1b"><apply id="S3.2.p1.10.m10.1.1.cmml" xref="S3.2.p1.10.m10.1.1"><csymbol cd="latexml" id="S3.2.p1.10.m10.1.1.1.cmml" xref="S3.2.p1.10.m10.1.1.1">modulo</csymbol><csymbol cd="latexml" id="S3.2.p1.10.m10.1.1.2.cmml" xref="S3.2.p1.10.m10.1.1.2">absent</csymbol><ci id="S3.2.p1.10.m10.1.1.3.cmml" xref="S3.2.p1.10.m10.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.10.m10.1c">\mod L</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.10.m10.1d">roman_mod italic_L</annotation></semantics></math>) and <math alttext="r\in\{0,1,\ldots,s-1\}" class="ltx_Math" display="inline" id="S3.2.p1.11.m11.4"><semantics id="S3.2.p1.11.m11.4a"><mrow id="S3.2.p1.11.m11.4.4" xref="S3.2.p1.11.m11.4.4.cmml"><mi id="S3.2.p1.11.m11.4.4.3" xref="S3.2.p1.11.m11.4.4.3.cmml">r</mi><mo id="S3.2.p1.11.m11.4.4.2" xref="S3.2.p1.11.m11.4.4.2.cmml">∈</mo><mrow id="S3.2.p1.11.m11.4.4.1.1" xref="S3.2.p1.11.m11.4.4.1.2.cmml"><mo id="S3.2.p1.11.m11.4.4.1.1.2" stretchy="false" xref="S3.2.p1.11.m11.4.4.1.2.cmml">{</mo><mn id="S3.2.p1.11.m11.1.1" xref="S3.2.p1.11.m11.1.1.cmml">0</mn><mo id="S3.2.p1.11.m11.4.4.1.1.3" xref="S3.2.p1.11.m11.4.4.1.2.cmml">,</mo><mn id="S3.2.p1.11.m11.2.2" xref="S3.2.p1.11.m11.2.2.cmml">1</mn><mo id="S3.2.p1.11.m11.4.4.1.1.4" xref="S3.2.p1.11.m11.4.4.1.2.cmml">,</mo><mi id="S3.2.p1.11.m11.3.3" mathvariant="normal" xref="S3.2.p1.11.m11.3.3.cmml">…</mi><mo id="S3.2.p1.11.m11.4.4.1.1.5" xref="S3.2.p1.11.m11.4.4.1.2.cmml">,</mo><mrow id="S3.2.p1.11.m11.4.4.1.1.1" xref="S3.2.p1.11.m11.4.4.1.1.1.cmml"><mi id="S3.2.p1.11.m11.4.4.1.1.1.2" xref="S3.2.p1.11.m11.4.4.1.1.1.2.cmml">s</mi><mo id="S3.2.p1.11.m11.4.4.1.1.1.1" xref="S3.2.p1.11.m11.4.4.1.1.1.1.cmml">−</mo><mn id="S3.2.p1.11.m11.4.4.1.1.1.3" xref="S3.2.p1.11.m11.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.2.p1.11.m11.4.4.1.1.6" stretchy="false" xref="S3.2.p1.11.m11.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.11.m11.4b"><apply id="S3.2.p1.11.m11.4.4.cmml" xref="S3.2.p1.11.m11.4.4"><in id="S3.2.p1.11.m11.4.4.2.cmml" xref="S3.2.p1.11.m11.4.4.2"></in><ci id="S3.2.p1.11.m11.4.4.3.cmml" xref="S3.2.p1.11.m11.4.4.3">𝑟</ci><set id="S3.2.p1.11.m11.4.4.1.2.cmml" xref="S3.2.p1.11.m11.4.4.1.1"><cn id="S3.2.p1.11.m11.1.1.cmml" type="integer" xref="S3.2.p1.11.m11.1.1">0</cn><cn id="S3.2.p1.11.m11.2.2.cmml" type="integer" xref="S3.2.p1.11.m11.2.2">1</cn><ci id="S3.2.p1.11.m11.3.3.cmml" xref="S3.2.p1.11.m11.3.3">…</ci><apply id="S3.2.p1.11.m11.4.4.1.1.1.cmml" xref="S3.2.p1.11.m11.4.4.1.1.1"><minus id="S3.2.p1.11.m11.4.4.1.1.1.1.cmml" xref="S3.2.p1.11.m11.4.4.1.1.1.1"></minus><ci id="S3.2.p1.11.m11.4.4.1.1.1.2.cmml" xref="S3.2.p1.11.m11.4.4.1.1.1.2">𝑠</ci><cn id="S3.2.p1.11.m11.4.4.1.1.1.3.cmml" type="integer" xref="S3.2.p1.11.m11.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.11.m11.4c">r\in\{0,1,\ldots,s-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.11.m11.4d">italic_r ∈ { 0 , 1 , … , italic_s - 1 }</annotation></semantics></math> (which follows from <math alttext="s=n/L&gt;(i-i_{1})/L=r" class="ltx_Math" display="inline" id="S3.2.p1.12.m12.1"><semantics id="S3.2.p1.12.m12.1a"><mrow id="S3.2.p1.12.m12.1.1" xref="S3.2.p1.12.m12.1.1.cmml"><mi id="S3.2.p1.12.m12.1.1.3" xref="S3.2.p1.12.m12.1.1.3.cmml">s</mi><mo id="S3.2.p1.12.m12.1.1.4" xref="S3.2.p1.12.m12.1.1.4.cmml">=</mo><mrow id="S3.2.p1.12.m12.1.1.5" xref="S3.2.p1.12.m12.1.1.5.cmml"><mi id="S3.2.p1.12.m12.1.1.5.2" xref="S3.2.p1.12.m12.1.1.5.2.cmml">n</mi><mo id="S3.2.p1.12.m12.1.1.5.1" xref="S3.2.p1.12.m12.1.1.5.1.cmml">/</mo><mi id="S3.2.p1.12.m12.1.1.5.3" xref="S3.2.p1.12.m12.1.1.5.3.cmml">L</mi></mrow><mo id="S3.2.p1.12.m12.1.1.6" xref="S3.2.p1.12.m12.1.1.6.cmml">&gt;</mo><mrow id="S3.2.p1.12.m12.1.1.1" xref="S3.2.p1.12.m12.1.1.1.cmml"><mrow id="S3.2.p1.12.m12.1.1.1.1.1" xref="S3.2.p1.12.m12.1.1.1.1.1.1.cmml"><mo id="S3.2.p1.12.m12.1.1.1.1.1.2" stretchy="false" xref="S3.2.p1.12.m12.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.2.p1.12.m12.1.1.1.1.1.1" xref="S3.2.p1.12.m12.1.1.1.1.1.1.cmml"><mi id="S3.2.p1.12.m12.1.1.1.1.1.1.2" xref="S3.2.p1.12.m12.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.2.p1.12.m12.1.1.1.1.1.1.1" xref="S3.2.p1.12.m12.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.2.p1.12.m12.1.1.1.1.1.1.3" xref="S3.2.p1.12.m12.1.1.1.1.1.1.3.cmml"><mi id="S3.2.p1.12.m12.1.1.1.1.1.1.3.2" xref="S3.2.p1.12.m12.1.1.1.1.1.1.3.2.cmml">i</mi><mn id="S3.2.p1.12.m12.1.1.1.1.1.1.3.3" xref="S3.2.p1.12.m12.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.2.p1.12.m12.1.1.1.1.1.3" stretchy="false" xref="S3.2.p1.12.m12.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.2.p1.12.m12.1.1.1.2" xref="S3.2.p1.12.m12.1.1.1.2.cmml">/</mo><mi id="S3.2.p1.12.m12.1.1.1.3" xref="S3.2.p1.12.m12.1.1.1.3.cmml">L</mi></mrow><mo id="S3.2.p1.12.m12.1.1.7" xref="S3.2.p1.12.m12.1.1.7.cmml">=</mo><mi id="S3.2.p1.12.m12.1.1.8" xref="S3.2.p1.12.m12.1.1.8.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.12.m12.1b"><apply id="S3.2.p1.12.m12.1.1.cmml" xref="S3.2.p1.12.m12.1.1"><and id="S3.2.p1.12.m12.1.1a.cmml" xref="S3.2.p1.12.m12.1.1"></and><apply id="S3.2.p1.12.m12.1.1b.cmml" xref="S3.2.p1.12.m12.1.1"><eq id="S3.2.p1.12.m12.1.1.4.cmml" xref="S3.2.p1.12.m12.1.1.4"></eq><ci id="S3.2.p1.12.m12.1.1.3.cmml" xref="S3.2.p1.12.m12.1.1.3">𝑠</ci><apply id="S3.2.p1.12.m12.1.1.5.cmml" xref="S3.2.p1.12.m12.1.1.5"><divide id="S3.2.p1.12.m12.1.1.5.1.cmml" xref="S3.2.p1.12.m12.1.1.5.1"></divide><ci id="S3.2.p1.12.m12.1.1.5.2.cmml" xref="S3.2.p1.12.m12.1.1.5.2">𝑛</ci><ci id="S3.2.p1.12.m12.1.1.5.3.cmml" xref="S3.2.p1.12.m12.1.1.5.3">𝐿</ci></apply></apply><apply id="S3.2.p1.12.m12.1.1c.cmml" xref="S3.2.p1.12.m12.1.1"><gt id="S3.2.p1.12.m12.1.1.6.cmml" xref="S3.2.p1.12.m12.1.1.6"></gt><share href="https://arxiv.org/html/2410.03805v1#S3.2.p1.12.m12.1.1.5.cmml" id="S3.2.p1.12.m12.1.1d.cmml" xref="S3.2.p1.12.m12.1.1"></share><apply id="S3.2.p1.12.m12.1.1.1.cmml" xref="S3.2.p1.12.m12.1.1.1"><divide id="S3.2.p1.12.m12.1.1.1.2.cmml" xref="S3.2.p1.12.m12.1.1.1.2"></divide><apply id="S3.2.p1.12.m12.1.1.1.1.1.1.cmml" xref="S3.2.p1.12.m12.1.1.1.1.1"><minus id="S3.2.p1.12.m12.1.1.1.1.1.1.1.cmml" xref="S3.2.p1.12.m12.1.1.1.1.1.1.1"></minus><ci id="S3.2.p1.12.m12.1.1.1.1.1.1.2.cmml" xref="S3.2.p1.12.m12.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.2.p1.12.m12.1.1.1.1.1.1.3.cmml" xref="S3.2.p1.12.m12.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.2.p1.12.m12.1.1.1.1.1.1.3.1.cmml" xref="S3.2.p1.12.m12.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.2.p1.12.m12.1.1.1.1.1.1.3.2.cmml" xref="S3.2.p1.12.m12.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.2.p1.12.m12.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.2.p1.12.m12.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.2.p1.12.m12.1.1.1.3.cmml" xref="S3.2.p1.12.m12.1.1.1.3">𝐿</ci></apply></apply><apply id="S3.2.p1.12.m12.1.1e.cmml" xref="S3.2.p1.12.m12.1.1"><eq id="S3.2.p1.12.m12.1.1.7.cmml" xref="S3.2.p1.12.m12.1.1.7"></eq><share href="https://arxiv.org/html/2410.03805v1#S3.2.p1.12.m12.1.1.1.cmml" id="S3.2.p1.12.m12.1.1f.cmml" xref="S3.2.p1.12.m12.1.1"></share><ci id="S3.2.p1.12.m12.1.1.8.cmml" xref="S3.2.p1.12.m12.1.1.8">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.12.m12.1c">s=n/L&gt;(i-i_{1})/L=r</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.12.m12.1d">italic_s = italic_n / italic_L &gt; ( italic_i - italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) / italic_L = italic_r</annotation></semantics></math>). To prove that <math alttext="j_{1}\in\{0,1,\ldots,2L-2\}" class="ltx_Math" display="inline" id="S3.2.p1.13.m13.4"><semantics id="S3.2.p1.13.m13.4a"><mrow id="S3.2.p1.13.m13.4.4" xref="S3.2.p1.13.m13.4.4.cmml"><msub id="S3.2.p1.13.m13.4.4.3" xref="S3.2.p1.13.m13.4.4.3.cmml"><mi id="S3.2.p1.13.m13.4.4.3.2" xref="S3.2.p1.13.m13.4.4.3.2.cmml">j</mi><mn id="S3.2.p1.13.m13.4.4.3.3" xref="S3.2.p1.13.m13.4.4.3.3.cmml">1</mn></msub><mo id="S3.2.p1.13.m13.4.4.2" xref="S3.2.p1.13.m13.4.4.2.cmml">∈</mo><mrow id="S3.2.p1.13.m13.4.4.1.1" xref="S3.2.p1.13.m13.4.4.1.2.cmml"><mo id="S3.2.p1.13.m13.4.4.1.1.2" stretchy="false" xref="S3.2.p1.13.m13.4.4.1.2.cmml">{</mo><mn id="S3.2.p1.13.m13.1.1" xref="S3.2.p1.13.m13.1.1.cmml">0</mn><mo id="S3.2.p1.13.m13.4.4.1.1.3" xref="S3.2.p1.13.m13.4.4.1.2.cmml">,</mo><mn id="S3.2.p1.13.m13.2.2" xref="S3.2.p1.13.m13.2.2.cmml">1</mn><mo id="S3.2.p1.13.m13.4.4.1.1.4" xref="S3.2.p1.13.m13.4.4.1.2.cmml">,</mo><mi id="S3.2.p1.13.m13.3.3" mathvariant="normal" xref="S3.2.p1.13.m13.3.3.cmml">…</mi><mo id="S3.2.p1.13.m13.4.4.1.1.5" xref="S3.2.p1.13.m13.4.4.1.2.cmml">,</mo><mrow id="S3.2.p1.13.m13.4.4.1.1.1" xref="S3.2.p1.13.m13.4.4.1.1.1.cmml"><mrow id="S3.2.p1.13.m13.4.4.1.1.1.2" xref="S3.2.p1.13.m13.4.4.1.1.1.2.cmml"><mn id="S3.2.p1.13.m13.4.4.1.1.1.2.2" xref="S3.2.p1.13.m13.4.4.1.1.1.2.2.cmml">2</mn><mo id="S3.2.p1.13.m13.4.4.1.1.1.2.1" xref="S3.2.p1.13.m13.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="S3.2.p1.13.m13.4.4.1.1.1.2.3" xref="S3.2.p1.13.m13.4.4.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.2.p1.13.m13.4.4.1.1.1.1" xref="S3.2.p1.13.m13.4.4.1.1.1.1.cmml">−</mo><mn id="S3.2.p1.13.m13.4.4.1.1.1.3" xref="S3.2.p1.13.m13.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="S3.2.p1.13.m13.4.4.1.1.6" stretchy="false" xref="S3.2.p1.13.m13.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.13.m13.4b"><apply id="S3.2.p1.13.m13.4.4.cmml" xref="S3.2.p1.13.m13.4.4"><in id="S3.2.p1.13.m13.4.4.2.cmml" xref="S3.2.p1.13.m13.4.4.2"></in><apply id="S3.2.p1.13.m13.4.4.3.cmml" xref="S3.2.p1.13.m13.4.4.3"><csymbol cd="ambiguous" id="S3.2.p1.13.m13.4.4.3.1.cmml" xref="S3.2.p1.13.m13.4.4.3">subscript</csymbol><ci id="S3.2.p1.13.m13.4.4.3.2.cmml" xref="S3.2.p1.13.m13.4.4.3.2">𝑗</ci><cn id="S3.2.p1.13.m13.4.4.3.3.cmml" type="integer" xref="S3.2.p1.13.m13.4.4.3.3">1</cn></apply><set id="S3.2.p1.13.m13.4.4.1.2.cmml" xref="S3.2.p1.13.m13.4.4.1.1"><cn id="S3.2.p1.13.m13.1.1.cmml" type="integer" xref="S3.2.p1.13.m13.1.1">0</cn><cn id="S3.2.p1.13.m13.2.2.cmml" type="integer" xref="S3.2.p1.13.m13.2.2">1</cn><ci id="S3.2.p1.13.m13.3.3.cmml" xref="S3.2.p1.13.m13.3.3">…</ci><apply id="S3.2.p1.13.m13.4.4.1.1.1.cmml" xref="S3.2.p1.13.m13.4.4.1.1.1"><minus id="S3.2.p1.13.m13.4.4.1.1.1.1.cmml" xref="S3.2.p1.13.m13.4.4.1.1.1.1"></minus><apply id="S3.2.p1.13.m13.4.4.1.1.1.2.cmml" xref="S3.2.p1.13.m13.4.4.1.1.1.2"><times id="S3.2.p1.13.m13.4.4.1.1.1.2.1.cmml" xref="S3.2.p1.13.m13.4.4.1.1.1.2.1"></times><cn id="S3.2.p1.13.m13.4.4.1.1.1.2.2.cmml" type="integer" xref="S3.2.p1.13.m13.4.4.1.1.1.2.2">2</cn><ci id="S3.2.p1.13.m13.4.4.1.1.1.2.3.cmml" xref="S3.2.p1.13.m13.4.4.1.1.1.2.3">𝐿</ci></apply><cn id="S3.2.p1.13.m13.4.4.1.1.1.3.cmml" type="integer" xref="S3.2.p1.13.m13.4.4.1.1.1.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.13.m13.4c">j_{1}\in\{0,1,\ldots,2L-2\}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.13.m13.4d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , 2 italic_L - 2 }</annotation></semantics></math>, we use <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="S3.2.p1.14.m14.1"><semantics id="S3.2.p1.14.m14.1a"><mrow id="S3.2.p1.14.m14.1.1" xref="S3.2.p1.14.m14.1.1.cmml"><mrow id="S3.2.p1.14.m14.1.1.2" xref="S3.2.p1.14.m14.1.1.2.cmml"><mrow id="S3.2.p1.14.m14.1.1.2.2" xref="S3.2.p1.14.m14.1.1.2.2.cmml"><mi id="S3.2.p1.14.m14.1.1.2.2.2" xref="S3.2.p1.14.m14.1.1.2.2.2.cmml">i</mi><mo id="S3.2.p1.14.m14.1.1.2.2.1" xref="S3.2.p1.14.m14.1.1.2.2.1.cmml">−</mo><mi id="S3.2.p1.14.m14.1.1.2.2.3" xref="S3.2.p1.14.m14.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.2.p1.14.m14.1.1.2.1" xref="S3.2.p1.14.m14.1.1.2.1.cmml">+</mo><mn id="S3.2.p1.14.m14.1.1.2.3" xref="S3.2.p1.14.m14.1.1.2.3.cmml">1</mn></mrow><mo id="S3.2.p1.14.m14.1.1.3" xref="S3.2.p1.14.m14.1.1.3.cmml">≤</mo><mi id="S3.2.p1.14.m14.1.1.4" xref="S3.2.p1.14.m14.1.1.4.cmml">j</mi><mo id="S3.2.p1.14.m14.1.1.5" xref="S3.2.p1.14.m14.1.1.5.cmml">≤</mo><mi id="S3.2.p1.14.m14.1.1.6" xref="S3.2.p1.14.m14.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.14.m14.1b"><apply id="S3.2.p1.14.m14.1.1.cmml" xref="S3.2.p1.14.m14.1.1"><and id="S3.2.p1.14.m14.1.1a.cmml" xref="S3.2.p1.14.m14.1.1"></and><apply id="S3.2.p1.14.m14.1.1b.cmml" xref="S3.2.p1.14.m14.1.1"><leq id="S3.2.p1.14.m14.1.1.3.cmml" xref="S3.2.p1.14.m14.1.1.3"></leq><apply id="S3.2.p1.14.m14.1.1.2.cmml" xref="S3.2.p1.14.m14.1.1.2"><plus id="S3.2.p1.14.m14.1.1.2.1.cmml" xref="S3.2.p1.14.m14.1.1.2.1"></plus><apply id="S3.2.p1.14.m14.1.1.2.2.cmml" xref="S3.2.p1.14.m14.1.1.2.2"><minus id="S3.2.p1.14.m14.1.1.2.2.1.cmml" xref="S3.2.p1.14.m14.1.1.2.2.1"></minus><ci id="S3.2.p1.14.m14.1.1.2.2.2.cmml" xref="S3.2.p1.14.m14.1.1.2.2.2">𝑖</ci><ci id="S3.2.p1.14.m14.1.1.2.2.3.cmml" xref="S3.2.p1.14.m14.1.1.2.2.3">𝐿</ci></apply><cn id="S3.2.p1.14.m14.1.1.2.3.cmml" type="integer" xref="S3.2.p1.14.m14.1.1.2.3">1</cn></apply><ci id="S3.2.p1.14.m14.1.1.4.cmml" xref="S3.2.p1.14.m14.1.1.4">𝑗</ci></apply><apply id="S3.2.p1.14.m14.1.1c.cmml" xref="S3.2.p1.14.m14.1.1"><leq id="S3.2.p1.14.m14.1.1.5.cmml" xref="S3.2.p1.14.m14.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.2.p1.14.m14.1.1.4.cmml" id="S3.2.p1.14.m14.1.1d.cmml" xref="S3.2.p1.14.m14.1.1"></share><ci id="S3.2.p1.14.m14.1.1.6.cmml" xref="S3.2.p1.14.m14.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.14.m14.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.14.m14.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math>, <math alttext="i=i_{1}+rL" class="ltx_Math" display="inline" id="S3.2.p1.15.m15.1"><semantics id="S3.2.p1.15.m15.1a"><mrow id="S3.2.p1.15.m15.1.1" xref="S3.2.p1.15.m15.1.1.cmml"><mi id="S3.2.p1.15.m15.1.1.2" xref="S3.2.p1.15.m15.1.1.2.cmml">i</mi><mo id="S3.2.p1.15.m15.1.1.1" xref="S3.2.p1.15.m15.1.1.1.cmml">=</mo><mrow id="S3.2.p1.15.m15.1.1.3" xref="S3.2.p1.15.m15.1.1.3.cmml"><msub id="S3.2.p1.15.m15.1.1.3.2" xref="S3.2.p1.15.m15.1.1.3.2.cmml"><mi id="S3.2.p1.15.m15.1.1.3.2.2" xref="S3.2.p1.15.m15.1.1.3.2.2.cmml">i</mi><mn id="S3.2.p1.15.m15.1.1.3.2.3" xref="S3.2.p1.15.m15.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.2.p1.15.m15.1.1.3.1" xref="S3.2.p1.15.m15.1.1.3.1.cmml">+</mo><mrow id="S3.2.p1.15.m15.1.1.3.3" xref="S3.2.p1.15.m15.1.1.3.3.cmml"><mi id="S3.2.p1.15.m15.1.1.3.3.2" xref="S3.2.p1.15.m15.1.1.3.3.2.cmml">r</mi><mo id="S3.2.p1.15.m15.1.1.3.3.1" xref="S3.2.p1.15.m15.1.1.3.3.1.cmml">⁢</mo><mi id="S3.2.p1.15.m15.1.1.3.3.3" xref="S3.2.p1.15.m15.1.1.3.3.3.cmml">L</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.15.m15.1b"><apply id="S3.2.p1.15.m15.1.1.cmml" xref="S3.2.p1.15.m15.1.1"><eq id="S3.2.p1.15.m15.1.1.1.cmml" xref="S3.2.p1.15.m15.1.1.1"></eq><ci id="S3.2.p1.15.m15.1.1.2.cmml" xref="S3.2.p1.15.m15.1.1.2">𝑖</ci><apply id="S3.2.p1.15.m15.1.1.3.cmml" xref="S3.2.p1.15.m15.1.1.3"><plus id="S3.2.p1.15.m15.1.1.3.1.cmml" xref="S3.2.p1.15.m15.1.1.3.1"></plus><apply id="S3.2.p1.15.m15.1.1.3.2.cmml" xref="S3.2.p1.15.m15.1.1.3.2"><csymbol cd="ambiguous" id="S3.2.p1.15.m15.1.1.3.2.1.cmml" xref="S3.2.p1.15.m15.1.1.3.2">subscript</csymbol><ci id="S3.2.p1.15.m15.1.1.3.2.2.cmml" xref="S3.2.p1.15.m15.1.1.3.2.2">𝑖</ci><cn id="S3.2.p1.15.m15.1.1.3.2.3.cmml" type="integer" xref="S3.2.p1.15.m15.1.1.3.2.3">1</cn></apply><apply id="S3.2.p1.15.m15.1.1.3.3.cmml" xref="S3.2.p1.15.m15.1.1.3.3"><times id="S3.2.p1.15.m15.1.1.3.3.1.cmml" xref="S3.2.p1.15.m15.1.1.3.3.1"></times><ci id="S3.2.p1.15.m15.1.1.3.3.2.cmml" xref="S3.2.p1.15.m15.1.1.3.3.2">𝑟</ci><ci id="S3.2.p1.15.m15.1.1.3.3.3.cmml" xref="S3.2.p1.15.m15.1.1.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.15.m15.1c">i=i_{1}+rL</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.15.m15.1d">italic_i = italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_r italic_L</annotation></semantics></math> and <math alttext="j_{1}=j-(r-1)L-1" class="ltx_Math" display="inline" id="S3.2.p1.16.m16.1"><semantics id="S3.2.p1.16.m16.1a"><mrow id="S3.2.p1.16.m16.1.1" xref="S3.2.p1.16.m16.1.1.cmml"><msub id="S3.2.p1.16.m16.1.1.3" xref="S3.2.p1.16.m16.1.1.3.cmml"><mi id="S3.2.p1.16.m16.1.1.3.2" xref="S3.2.p1.16.m16.1.1.3.2.cmml">j</mi><mn id="S3.2.p1.16.m16.1.1.3.3" xref="S3.2.p1.16.m16.1.1.3.3.cmml">1</mn></msub><mo id="S3.2.p1.16.m16.1.1.2" xref="S3.2.p1.16.m16.1.1.2.cmml">=</mo><mrow id="S3.2.p1.16.m16.1.1.1" xref="S3.2.p1.16.m16.1.1.1.cmml"><mi id="S3.2.p1.16.m16.1.1.1.3" xref="S3.2.p1.16.m16.1.1.1.3.cmml">j</mi><mo id="S3.2.p1.16.m16.1.1.1.2" xref="S3.2.p1.16.m16.1.1.1.2.cmml">−</mo><mrow id="S3.2.p1.16.m16.1.1.1.1" xref="S3.2.p1.16.m16.1.1.1.1.cmml"><mrow id="S3.2.p1.16.m16.1.1.1.1.1.1" xref="S3.2.p1.16.m16.1.1.1.1.1.1.1.cmml"><mo id="S3.2.p1.16.m16.1.1.1.1.1.1.2" stretchy="false" xref="S3.2.p1.16.m16.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.2.p1.16.m16.1.1.1.1.1.1.1" xref="S3.2.p1.16.m16.1.1.1.1.1.1.1.cmml"><mi id="S3.2.p1.16.m16.1.1.1.1.1.1.1.2" xref="S3.2.p1.16.m16.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.2.p1.16.m16.1.1.1.1.1.1.1.1" xref="S3.2.p1.16.m16.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.2.p1.16.m16.1.1.1.1.1.1.1.3" xref="S3.2.p1.16.m16.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.2.p1.16.m16.1.1.1.1.1.1.3" stretchy="false" xref="S3.2.p1.16.m16.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.2.p1.16.m16.1.1.1.1.2" xref="S3.2.p1.16.m16.1.1.1.1.2.cmml">⁢</mo><mi id="S3.2.p1.16.m16.1.1.1.1.3" xref="S3.2.p1.16.m16.1.1.1.1.3.cmml">L</mi></mrow><mo id="S3.2.p1.16.m16.1.1.1.2a" xref="S3.2.p1.16.m16.1.1.1.2.cmml">−</mo><mn id="S3.2.p1.16.m16.1.1.1.4" xref="S3.2.p1.16.m16.1.1.1.4.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.16.m16.1b"><apply id="S3.2.p1.16.m16.1.1.cmml" xref="S3.2.p1.16.m16.1.1"><eq id="S3.2.p1.16.m16.1.1.2.cmml" xref="S3.2.p1.16.m16.1.1.2"></eq><apply id="S3.2.p1.16.m16.1.1.3.cmml" xref="S3.2.p1.16.m16.1.1.3"><csymbol cd="ambiguous" id="S3.2.p1.16.m16.1.1.3.1.cmml" xref="S3.2.p1.16.m16.1.1.3">subscript</csymbol><ci id="S3.2.p1.16.m16.1.1.3.2.cmml" xref="S3.2.p1.16.m16.1.1.3.2">𝑗</ci><cn id="S3.2.p1.16.m16.1.1.3.3.cmml" type="integer" xref="S3.2.p1.16.m16.1.1.3.3">1</cn></apply><apply id="S3.2.p1.16.m16.1.1.1.cmml" xref="S3.2.p1.16.m16.1.1.1"><minus id="S3.2.p1.16.m16.1.1.1.2.cmml" xref="S3.2.p1.16.m16.1.1.1.2"></minus><ci id="S3.2.p1.16.m16.1.1.1.3.cmml" xref="S3.2.p1.16.m16.1.1.1.3">𝑗</ci><apply id="S3.2.p1.16.m16.1.1.1.1.cmml" xref="S3.2.p1.16.m16.1.1.1.1"><times id="S3.2.p1.16.m16.1.1.1.1.2.cmml" xref="S3.2.p1.16.m16.1.1.1.1.2"></times><apply id="S3.2.p1.16.m16.1.1.1.1.1.1.1.cmml" xref="S3.2.p1.16.m16.1.1.1.1.1.1"><minus id="S3.2.p1.16.m16.1.1.1.1.1.1.1.1.cmml" xref="S3.2.p1.16.m16.1.1.1.1.1.1.1.1"></minus><ci id="S3.2.p1.16.m16.1.1.1.1.1.1.1.2.cmml" xref="S3.2.p1.16.m16.1.1.1.1.1.1.1.2">𝑟</ci><cn id="S3.2.p1.16.m16.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.2.p1.16.m16.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.2.p1.16.m16.1.1.1.1.3.cmml" xref="S3.2.p1.16.m16.1.1.1.1.3">𝐿</ci></apply><cn id="S3.2.p1.16.m16.1.1.1.4.cmml" type="integer" xref="S3.2.p1.16.m16.1.1.1.4">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.16.m16.1c">j_{1}=j-(r-1)L-1</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.16.m16.1d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_j - ( italic_r - 1 ) italic_L - 1</annotation></semantics></math>, obtaining</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="0\leq j-i+L-1=j-i_{1}-rL+L-1=j_{1}-i_{1}\leq j_{1}" class="ltx_Math" display="block" id="S3.Ex7.m1.1"><semantics id="S3.Ex7.m1.1a"><mrow id="S3.Ex7.m1.1.1" xref="S3.Ex7.m1.1.1.cmml"><mn id="S3.Ex7.m1.1.1.2" xref="S3.Ex7.m1.1.1.2.cmml">0</mn><mo id="S3.Ex7.m1.1.1.3" xref="S3.Ex7.m1.1.1.3.cmml">≤</mo><mrow id="S3.Ex7.m1.1.1.4" xref="S3.Ex7.m1.1.1.4.cmml"><mrow id="S3.Ex7.m1.1.1.4.2" xref="S3.Ex7.m1.1.1.4.2.cmml"><mrow id="S3.Ex7.m1.1.1.4.2.2" xref="S3.Ex7.m1.1.1.4.2.2.cmml"><mi id="S3.Ex7.m1.1.1.4.2.2.2" xref="S3.Ex7.m1.1.1.4.2.2.2.cmml">j</mi><mo id="S3.Ex7.m1.1.1.4.2.2.1" xref="S3.Ex7.m1.1.1.4.2.2.1.cmml">−</mo><mi id="S3.Ex7.m1.1.1.4.2.2.3" xref="S3.Ex7.m1.1.1.4.2.2.3.cmml">i</mi></mrow><mo id="S3.Ex7.m1.1.1.4.2.1" xref="S3.Ex7.m1.1.1.4.2.1.cmml">+</mo><mi id="S3.Ex7.m1.1.1.4.2.3" xref="S3.Ex7.m1.1.1.4.2.3.cmml">L</mi></mrow><mo id="S3.Ex7.m1.1.1.4.1" xref="S3.Ex7.m1.1.1.4.1.cmml">−</mo><mn id="S3.Ex7.m1.1.1.4.3" xref="S3.Ex7.m1.1.1.4.3.cmml">1</mn></mrow><mo id="S3.Ex7.m1.1.1.5" xref="S3.Ex7.m1.1.1.5.cmml">=</mo><mrow id="S3.Ex7.m1.1.1.6" xref="S3.Ex7.m1.1.1.6.cmml"><mrow id="S3.Ex7.m1.1.1.6.2" xref="S3.Ex7.m1.1.1.6.2.cmml"><mrow id="S3.Ex7.m1.1.1.6.2.2" xref="S3.Ex7.m1.1.1.6.2.2.cmml"><mi id="S3.Ex7.m1.1.1.6.2.2.2" xref="S3.Ex7.m1.1.1.6.2.2.2.cmml">j</mi><mo id="S3.Ex7.m1.1.1.6.2.2.1" xref="S3.Ex7.m1.1.1.6.2.2.1.cmml">−</mo><msub id="S3.Ex7.m1.1.1.6.2.2.3" xref="S3.Ex7.m1.1.1.6.2.2.3.cmml"><mi id="S3.Ex7.m1.1.1.6.2.2.3.2" xref="S3.Ex7.m1.1.1.6.2.2.3.2.cmml">i</mi><mn id="S3.Ex7.m1.1.1.6.2.2.3.3" xref="S3.Ex7.m1.1.1.6.2.2.3.3.cmml">1</mn></msub><mo id="S3.Ex7.m1.1.1.6.2.2.1a" xref="S3.Ex7.m1.1.1.6.2.2.1.cmml">−</mo><mrow id="S3.Ex7.m1.1.1.6.2.2.4" xref="S3.Ex7.m1.1.1.6.2.2.4.cmml"><mi id="S3.Ex7.m1.1.1.6.2.2.4.2" xref="S3.Ex7.m1.1.1.6.2.2.4.2.cmml">r</mi><mo id="S3.Ex7.m1.1.1.6.2.2.4.1" xref="S3.Ex7.m1.1.1.6.2.2.4.1.cmml">⁢</mo><mi id="S3.Ex7.m1.1.1.6.2.2.4.3" xref="S3.Ex7.m1.1.1.6.2.2.4.3.cmml">L</mi></mrow></mrow><mo id="S3.Ex7.m1.1.1.6.2.1" xref="S3.Ex7.m1.1.1.6.2.1.cmml">+</mo><mi id="S3.Ex7.m1.1.1.6.2.3" xref="S3.Ex7.m1.1.1.6.2.3.cmml">L</mi></mrow><mo id="S3.Ex7.m1.1.1.6.1" xref="S3.Ex7.m1.1.1.6.1.cmml">−</mo><mn id="S3.Ex7.m1.1.1.6.3" xref="S3.Ex7.m1.1.1.6.3.cmml">1</mn></mrow><mo id="S3.Ex7.m1.1.1.7" xref="S3.Ex7.m1.1.1.7.cmml">=</mo><mrow id="S3.Ex7.m1.1.1.8" xref="S3.Ex7.m1.1.1.8.cmml"><msub id="S3.Ex7.m1.1.1.8.2" xref="S3.Ex7.m1.1.1.8.2.cmml"><mi id="S3.Ex7.m1.1.1.8.2.2" xref="S3.Ex7.m1.1.1.8.2.2.cmml">j</mi><mn id="S3.Ex7.m1.1.1.8.2.3" xref="S3.Ex7.m1.1.1.8.2.3.cmml">1</mn></msub><mo id="S3.Ex7.m1.1.1.8.1" xref="S3.Ex7.m1.1.1.8.1.cmml">−</mo><msub id="S3.Ex7.m1.1.1.8.3" xref="S3.Ex7.m1.1.1.8.3.cmml"><mi id="S3.Ex7.m1.1.1.8.3.2" xref="S3.Ex7.m1.1.1.8.3.2.cmml">i</mi><mn id="S3.Ex7.m1.1.1.8.3.3" xref="S3.Ex7.m1.1.1.8.3.3.cmml">1</mn></msub></mrow><mo id="S3.Ex7.m1.1.1.9" xref="S3.Ex7.m1.1.1.9.cmml">≤</mo><msub id="S3.Ex7.m1.1.1.10" xref="S3.Ex7.m1.1.1.10.cmml"><mi id="S3.Ex7.m1.1.1.10.2" xref="S3.Ex7.m1.1.1.10.2.cmml">j</mi><mn id="S3.Ex7.m1.1.1.10.3" xref="S3.Ex7.m1.1.1.10.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.1b"><apply id="S3.Ex7.m1.1.1.cmml" xref="S3.Ex7.m1.1.1"><and id="S3.Ex7.m1.1.1a.cmml" xref="S3.Ex7.m1.1.1"></and><apply id="S3.Ex7.m1.1.1b.cmml" xref="S3.Ex7.m1.1.1"><leq id="S3.Ex7.m1.1.1.3.cmml" xref="S3.Ex7.m1.1.1.3"></leq><cn id="S3.Ex7.m1.1.1.2.cmml" type="integer" xref="S3.Ex7.m1.1.1.2">0</cn><apply id="S3.Ex7.m1.1.1.4.cmml" xref="S3.Ex7.m1.1.1.4"><minus id="S3.Ex7.m1.1.1.4.1.cmml" xref="S3.Ex7.m1.1.1.4.1"></minus><apply id="S3.Ex7.m1.1.1.4.2.cmml" xref="S3.Ex7.m1.1.1.4.2"><plus id="S3.Ex7.m1.1.1.4.2.1.cmml" xref="S3.Ex7.m1.1.1.4.2.1"></plus><apply id="S3.Ex7.m1.1.1.4.2.2.cmml" xref="S3.Ex7.m1.1.1.4.2.2"><minus id="S3.Ex7.m1.1.1.4.2.2.1.cmml" xref="S3.Ex7.m1.1.1.4.2.2.1"></minus><ci id="S3.Ex7.m1.1.1.4.2.2.2.cmml" xref="S3.Ex7.m1.1.1.4.2.2.2">𝑗</ci><ci id="S3.Ex7.m1.1.1.4.2.2.3.cmml" xref="S3.Ex7.m1.1.1.4.2.2.3">𝑖</ci></apply><ci id="S3.Ex7.m1.1.1.4.2.3.cmml" xref="S3.Ex7.m1.1.1.4.2.3">𝐿</ci></apply><cn id="S3.Ex7.m1.1.1.4.3.cmml" type="integer" xref="S3.Ex7.m1.1.1.4.3">1</cn></apply></apply><apply id="S3.Ex7.m1.1.1c.cmml" xref="S3.Ex7.m1.1.1"><eq id="S3.Ex7.m1.1.1.5.cmml" xref="S3.Ex7.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.03805v1#S3.Ex7.m1.1.1.4.cmml" id="S3.Ex7.m1.1.1d.cmml" xref="S3.Ex7.m1.1.1"></share><apply id="S3.Ex7.m1.1.1.6.cmml" xref="S3.Ex7.m1.1.1.6"><minus id="S3.Ex7.m1.1.1.6.1.cmml" xref="S3.Ex7.m1.1.1.6.1"></minus><apply id="S3.Ex7.m1.1.1.6.2.cmml" xref="S3.Ex7.m1.1.1.6.2"><plus id="S3.Ex7.m1.1.1.6.2.1.cmml" xref="S3.Ex7.m1.1.1.6.2.1"></plus><apply id="S3.Ex7.m1.1.1.6.2.2.cmml" xref="S3.Ex7.m1.1.1.6.2.2"><minus id="S3.Ex7.m1.1.1.6.2.2.1.cmml" xref="S3.Ex7.m1.1.1.6.2.2.1"></minus><ci id="S3.Ex7.m1.1.1.6.2.2.2.cmml" xref="S3.Ex7.m1.1.1.6.2.2.2">𝑗</ci><apply id="S3.Ex7.m1.1.1.6.2.2.3.cmml" xref="S3.Ex7.m1.1.1.6.2.2.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.1.1.6.2.2.3.1.cmml" xref="S3.Ex7.m1.1.1.6.2.2.3">subscript</csymbol><ci id="S3.Ex7.m1.1.1.6.2.2.3.2.cmml" xref="S3.Ex7.m1.1.1.6.2.2.3.2">𝑖</ci><cn id="S3.Ex7.m1.1.1.6.2.2.3.3.cmml" type="integer" xref="S3.Ex7.m1.1.1.6.2.2.3.3">1</cn></apply><apply id="S3.Ex7.m1.1.1.6.2.2.4.cmml" xref="S3.Ex7.m1.1.1.6.2.2.4"><times id="S3.Ex7.m1.1.1.6.2.2.4.1.cmml" xref="S3.Ex7.m1.1.1.6.2.2.4.1"></times><ci id="S3.Ex7.m1.1.1.6.2.2.4.2.cmml" xref="S3.Ex7.m1.1.1.6.2.2.4.2">𝑟</ci><ci id="S3.Ex7.m1.1.1.6.2.2.4.3.cmml" xref="S3.Ex7.m1.1.1.6.2.2.4.3">𝐿</ci></apply></apply><ci id="S3.Ex7.m1.1.1.6.2.3.cmml" xref="S3.Ex7.m1.1.1.6.2.3">𝐿</ci></apply><cn id="S3.Ex7.m1.1.1.6.3.cmml" type="integer" xref="S3.Ex7.m1.1.1.6.3">1</cn></apply></apply><apply id="S3.Ex7.m1.1.1e.cmml" xref="S3.Ex7.m1.1.1"><eq id="S3.Ex7.m1.1.1.7.cmml" xref="S3.Ex7.m1.1.1.7"></eq><share href="https://arxiv.org/html/2410.03805v1#S3.Ex7.m1.1.1.6.cmml" id="S3.Ex7.m1.1.1f.cmml" xref="S3.Ex7.m1.1.1"></share><apply id="S3.Ex7.m1.1.1.8.cmml" xref="S3.Ex7.m1.1.1.8"><minus id="S3.Ex7.m1.1.1.8.1.cmml" xref="S3.Ex7.m1.1.1.8.1"></minus><apply id="S3.Ex7.m1.1.1.8.2.cmml" xref="S3.Ex7.m1.1.1.8.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.1.1.8.2.1.cmml" xref="S3.Ex7.m1.1.1.8.2">subscript</csymbol><ci id="S3.Ex7.m1.1.1.8.2.2.cmml" xref="S3.Ex7.m1.1.1.8.2.2">𝑗</ci><cn id="S3.Ex7.m1.1.1.8.2.3.cmml" type="integer" xref="S3.Ex7.m1.1.1.8.2.3">1</cn></apply><apply id="S3.Ex7.m1.1.1.8.3.cmml" xref="S3.Ex7.m1.1.1.8.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.1.1.8.3.1.cmml" xref="S3.Ex7.m1.1.1.8.3">subscript</csymbol><ci id="S3.Ex7.m1.1.1.8.3.2.cmml" xref="S3.Ex7.m1.1.1.8.3.2">𝑖</ci><cn id="S3.Ex7.m1.1.1.8.3.3.cmml" type="integer" xref="S3.Ex7.m1.1.1.8.3.3">1</cn></apply></apply></apply><apply id="S3.Ex7.m1.1.1g.cmml" xref="S3.Ex7.m1.1.1"><leq id="S3.Ex7.m1.1.1.9.cmml" xref="S3.Ex7.m1.1.1.9"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.Ex7.m1.1.1.8.cmml" id="S3.Ex7.m1.1.1h.cmml" xref="S3.Ex7.m1.1.1"></share><apply id="S3.Ex7.m1.1.1.10.cmml" xref="S3.Ex7.m1.1.1.10"><csymbol cd="ambiguous" id="S3.Ex7.m1.1.1.10.1.cmml" xref="S3.Ex7.m1.1.1.10">subscript</csymbol><ci id="S3.Ex7.m1.1.1.10.2.cmml" xref="S3.Ex7.m1.1.1.10.2">𝑗</ci><cn id="S3.Ex7.m1.1.1.10.3.cmml" type="integer" xref="S3.Ex7.m1.1.1.10.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.1c">0\leq j-i+L-1=j-i_{1}-rL+L-1=j_{1}-i_{1}\leq j_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex7.m1.1d">0 ≤ italic_j - italic_i + italic_L - 1 = italic_j - italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - italic_r italic_L + italic_L - 1 = italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.2.p1.24">and</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.Ex8">
<tbody id="S3.Ex8X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle j_{1}" class="ltx_Math" display="inline" id="S3.Ex8X.2.1.1.m1.1"><semantics id="S3.Ex8X.2.1.1.m1.1a"><msub id="S3.Ex8X.2.1.1.m1.1.1" xref="S3.Ex8X.2.1.1.m1.1.1.cmml"><mi id="S3.Ex8X.2.1.1.m1.1.1.2" xref="S3.Ex8X.2.1.1.m1.1.1.2.cmml">j</mi><mn id="S3.Ex8X.2.1.1.m1.1.1.3" xref="S3.Ex8X.2.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.Ex8X.2.1.1.m1.1b"><apply id="S3.Ex8X.2.1.1.m1.1.1.cmml" xref="S3.Ex8X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex8X.2.1.1.m1.1.1.1.cmml" xref="S3.Ex8X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.Ex8X.2.1.1.m1.1.1.2.cmml" xref="S3.Ex8X.2.1.1.m1.1.1.2">𝑗</ci><cn id="S3.Ex8X.2.1.1.m1.1.1.3.cmml" type="integer" xref="S3.Ex8X.2.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex8X.2.1.1.m1.1c">\displaystyle j_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex8X.2.1.1.m1.1d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=j-(r-1)L-1\leq i-(r-1)L-1=i_{1}+rL-(r-1)L-1" class="ltx_Math" display="inline" id="S3.Ex8X.3.2.2.m1.3"><semantics id="S3.Ex8X.3.2.2.m1.3a"><mrow id="S3.Ex8X.3.2.2.m1.3.3" xref="S3.Ex8X.3.2.2.m1.3.3.cmml"><mi id="S3.Ex8X.3.2.2.m1.3.3.5" xref="S3.Ex8X.3.2.2.m1.3.3.5.cmml"></mi><mo id="S3.Ex8X.3.2.2.m1.3.3.6" xref="S3.Ex8X.3.2.2.m1.3.3.6.cmml">=</mo><mrow id="S3.Ex8X.3.2.2.m1.1.1.1" xref="S3.Ex8X.3.2.2.m1.1.1.1.cmml"><mi id="S3.Ex8X.3.2.2.m1.1.1.1.3" xref="S3.Ex8X.3.2.2.m1.1.1.1.3.cmml">j</mi><mo id="S3.Ex8X.3.2.2.m1.1.1.1.2" xref="S3.Ex8X.3.2.2.m1.1.1.1.2.cmml">−</mo><mrow id="S3.Ex8X.3.2.2.m1.1.1.1.1" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex8X.3.2.2.m1.1.1.1.1.2" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex8X.3.2.2.m1.1.1.1.1.3" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.3.cmml">L</mi></mrow><mo id="S3.Ex8X.3.2.2.m1.1.1.1.2a" xref="S3.Ex8X.3.2.2.m1.1.1.1.2.cmml">−</mo><mn id="S3.Ex8X.3.2.2.m1.1.1.1.4" xref="S3.Ex8X.3.2.2.m1.1.1.1.4.cmml">1</mn></mrow><mo id="S3.Ex8X.3.2.2.m1.3.3.7" xref="S3.Ex8X.3.2.2.m1.3.3.7.cmml">≤</mo><mrow id="S3.Ex8X.3.2.2.m1.2.2.2" xref="S3.Ex8X.3.2.2.m1.2.2.2.cmml"><mi id="S3.Ex8X.3.2.2.m1.2.2.2.3" xref="S3.Ex8X.3.2.2.m1.2.2.2.3.cmml">i</mi><mo id="S3.Ex8X.3.2.2.m1.2.2.2.2" xref="S3.Ex8X.3.2.2.m1.2.2.2.2.cmml">−</mo><mrow id="S3.Ex8X.3.2.2.m1.2.2.2.1" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.cmml"><mrow id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.cmml"><mo id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.2" stretchy="false" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.cmml"><mi id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.2" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.2.cmml">r</mi><mo id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.1" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.1.cmml">−</mo><mn id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.3" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.3" stretchy="false" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex8X.3.2.2.m1.2.2.2.1.2" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.2.cmml">⁢</mo><mi id="S3.Ex8X.3.2.2.m1.2.2.2.1.3" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.3.cmml">L</mi></mrow><mo id="S3.Ex8X.3.2.2.m1.2.2.2.2a" xref="S3.Ex8X.3.2.2.m1.2.2.2.2.cmml">−</mo><mn id="S3.Ex8X.3.2.2.m1.2.2.2.4" xref="S3.Ex8X.3.2.2.m1.2.2.2.4.cmml">1</mn></mrow><mo id="S3.Ex8X.3.2.2.m1.3.3.8" xref="S3.Ex8X.3.2.2.m1.3.3.8.cmml">=</mo><mrow id="S3.Ex8X.3.2.2.m1.3.3.3" xref="S3.Ex8X.3.2.2.m1.3.3.3.cmml"><mrow id="S3.Ex8X.3.2.2.m1.3.3.3.3" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.cmml"><msub id="S3.Ex8X.3.2.2.m1.3.3.3.3.2" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.2.cmml"><mi id="S3.Ex8X.3.2.2.m1.3.3.3.3.2.2" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.2.2.cmml">i</mi><mn id="S3.Ex8X.3.2.2.m1.3.3.3.3.2.3" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.2.3.cmml">1</mn></msub><mo id="S3.Ex8X.3.2.2.m1.3.3.3.3.1" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.1.cmml">+</mo><mrow id="S3.Ex8X.3.2.2.m1.3.3.3.3.3" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.3.cmml"><mi id="S3.Ex8X.3.2.2.m1.3.3.3.3.3.2" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.3.2.cmml">r</mi><mo id="S3.Ex8X.3.2.2.m1.3.3.3.3.3.1" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex8X.3.2.2.m1.3.3.3.3.3.3" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.3.3.cmml">L</mi></mrow></mrow><mo id="S3.Ex8X.3.2.2.m1.3.3.3.2" xref="S3.Ex8X.3.2.2.m1.3.3.3.2.cmml">−</mo><mrow id="S3.Ex8X.3.2.2.m1.3.3.3.1" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.cmml"><mrow id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.cmml"><mo id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.2" stretchy="false" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.cmml"><mi id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.2" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.2.cmml">r</mi><mo id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.1" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.1.cmml">−</mo><mn id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.3" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.3" stretchy="false" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex8X.3.2.2.m1.3.3.3.1.2" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.2.cmml">⁢</mo><mi id="S3.Ex8X.3.2.2.m1.3.3.3.1.3" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.3.cmml">L</mi></mrow><mo id="S3.Ex8X.3.2.2.m1.3.3.3.2a" xref="S3.Ex8X.3.2.2.m1.3.3.3.2.cmml">−</mo><mn id="S3.Ex8X.3.2.2.m1.3.3.3.4" xref="S3.Ex8X.3.2.2.m1.3.3.3.4.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex8X.3.2.2.m1.3b"><apply id="S3.Ex8X.3.2.2.m1.3.3.cmml" xref="S3.Ex8X.3.2.2.m1.3.3"><and id="S3.Ex8X.3.2.2.m1.3.3a.cmml" xref="S3.Ex8X.3.2.2.m1.3.3"></and><apply id="S3.Ex8X.3.2.2.m1.3.3b.cmml" xref="S3.Ex8X.3.2.2.m1.3.3"><eq id="S3.Ex8X.3.2.2.m1.3.3.6.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.6"></eq><csymbol cd="latexml" id="S3.Ex8X.3.2.2.m1.3.3.5.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.5">absent</csymbol><apply id="S3.Ex8X.3.2.2.m1.1.1.1.cmml" xref="S3.Ex8X.3.2.2.m1.1.1.1"><minus id="S3.Ex8X.3.2.2.m1.1.1.1.2.cmml" xref="S3.Ex8X.3.2.2.m1.1.1.1.2"></minus><ci id="S3.Ex8X.3.2.2.m1.1.1.1.3.cmml" xref="S3.Ex8X.3.2.2.m1.1.1.1.3">𝑗</ci><apply id="S3.Ex8X.3.2.2.m1.1.1.1.1.cmml" xref="S3.Ex8X.3.2.2.m1.1.1.1.1"><times id="S3.Ex8X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.2"></times><apply id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1"><minus id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.1"></minus><ci id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.2">𝑟</ci><cn id="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.Ex8X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.Ex8X.3.2.2.m1.1.1.1.1.3">𝐿</ci></apply><cn id="S3.Ex8X.3.2.2.m1.1.1.1.4.cmml" type="integer" xref="S3.Ex8X.3.2.2.m1.1.1.1.4">1</cn></apply></apply><apply id="S3.Ex8X.3.2.2.m1.3.3c.cmml" xref="S3.Ex8X.3.2.2.m1.3.3"><leq id="S3.Ex8X.3.2.2.m1.3.3.7.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.7"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.Ex8X.3.2.2.m1.1.1.1.cmml" id="S3.Ex8X.3.2.2.m1.3.3d.cmml" xref="S3.Ex8X.3.2.2.m1.3.3"></share><apply id="S3.Ex8X.3.2.2.m1.2.2.2.cmml" xref="S3.Ex8X.3.2.2.m1.2.2.2"><minus id="S3.Ex8X.3.2.2.m1.2.2.2.2.cmml" xref="S3.Ex8X.3.2.2.m1.2.2.2.2"></minus><ci id="S3.Ex8X.3.2.2.m1.2.2.2.3.cmml" xref="S3.Ex8X.3.2.2.m1.2.2.2.3">𝑖</ci><apply id="S3.Ex8X.3.2.2.m1.2.2.2.1.cmml" xref="S3.Ex8X.3.2.2.m1.2.2.2.1"><times id="S3.Ex8X.3.2.2.m1.2.2.2.1.2.cmml" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.2"></times><apply id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.cmml" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1"><minus id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.1"></minus><ci id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.2">𝑟</ci><cn id="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.1.1.1.3">1</cn></apply><ci id="S3.Ex8X.3.2.2.m1.2.2.2.1.3.cmml" xref="S3.Ex8X.3.2.2.m1.2.2.2.1.3">𝐿</ci></apply><cn id="S3.Ex8X.3.2.2.m1.2.2.2.4.cmml" type="integer" xref="S3.Ex8X.3.2.2.m1.2.2.2.4">1</cn></apply></apply><apply id="S3.Ex8X.3.2.2.m1.3.3e.cmml" xref="S3.Ex8X.3.2.2.m1.3.3"><eq id="S3.Ex8X.3.2.2.m1.3.3.8.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.8"></eq><share href="https://arxiv.org/html/2410.03805v1#S3.Ex8X.3.2.2.m1.2.2.2.cmml" id="S3.Ex8X.3.2.2.m1.3.3f.cmml" xref="S3.Ex8X.3.2.2.m1.3.3"></share><apply id="S3.Ex8X.3.2.2.m1.3.3.3.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3"><minus id="S3.Ex8X.3.2.2.m1.3.3.3.2.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.2"></minus><apply id="S3.Ex8X.3.2.2.m1.3.3.3.3.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.3"><plus id="S3.Ex8X.3.2.2.m1.3.3.3.3.1.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.1"></plus><apply id="S3.Ex8X.3.2.2.m1.3.3.3.3.2.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.Ex8X.3.2.2.m1.3.3.3.3.2.1.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.2">subscript</csymbol><ci id="S3.Ex8X.3.2.2.m1.3.3.3.3.2.2.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.2.2">𝑖</ci><cn id="S3.Ex8X.3.2.2.m1.3.3.3.3.2.3.cmml" type="integer" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.2.3">1</cn></apply><apply id="S3.Ex8X.3.2.2.m1.3.3.3.3.3.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.3"><times id="S3.Ex8X.3.2.2.m1.3.3.3.3.3.1.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.3.1"></times><ci id="S3.Ex8X.3.2.2.m1.3.3.3.3.3.2.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.3.2">𝑟</ci><ci id="S3.Ex8X.3.2.2.m1.3.3.3.3.3.3.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.3.3.3">𝐿</ci></apply></apply><apply id="S3.Ex8X.3.2.2.m1.3.3.3.1.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.1"><times id="S3.Ex8X.3.2.2.m1.3.3.3.1.2.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.2"></times><apply id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1"><minus id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.1.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.1"></minus><ci id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.2.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.2">𝑟</ci><cn id="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.1.1.1.3">1</cn></apply><ci id="S3.Ex8X.3.2.2.m1.3.3.3.1.3.cmml" xref="S3.Ex8X.3.2.2.m1.3.3.3.1.3">𝐿</ci></apply><cn id="S3.Ex8X.3.2.2.m1.3.3.3.4.cmml" type="integer" xref="S3.Ex8X.3.2.2.m1.3.3.3.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex8X.3.2.2.m1.3c">\displaystyle=j-(r-1)L-1\leq i-(r-1)L-1=i_{1}+rL-(r-1)L-1</annotation><annotation encoding="application/x-llamapun" id="S3.Ex8X.3.2.2.m1.3d">= italic_j - ( italic_r - 1 ) italic_L - 1 ≤ italic_i - ( italic_r - 1 ) italic_L - 1 = italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_r italic_L - ( italic_r - 1 ) italic_L - 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex8Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=i_{1}+L-1\leq L-1+L-1=2L-2." class="ltx_Math" display="inline" id="S3.Ex8Xa.2.1.1.m1.1"><semantics id="S3.Ex8Xa.2.1.1.m1.1a"><mrow id="S3.Ex8Xa.2.1.1.m1.1.1.1" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.Ex8Xa.2.1.1.m1.1.1.1.1" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.2" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.2.cmml"></mi><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.3" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.cmml"><mrow id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.cmml"><msub id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.cmml"><mi id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.2" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.2.cmml">i</mi><mn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.3" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.3.cmml">1</mn></msub><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.1" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.1.cmml">+</mo><mi id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.3" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.3.cmml">L</mi></mrow><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.1" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.1.cmml">−</mo><mn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.3" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.3.cmml">1</mn></mrow><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.5" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.5.cmml">≤</mo><mrow id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.cmml"><mrow id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.cmml"><mrow id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.cmml"><mi id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.2" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.2.cmml">L</mi><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.1" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.1.cmml">−</mo><mn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.3" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.3.cmml">1</mn></mrow><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.1" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.1.cmml">+</mo><mi id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.3" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.3.cmml">L</mi></mrow><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.1" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.1.cmml">−</mo><mn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.3" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.3.cmml">1</mn></mrow><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.7" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.7.cmml">=</mo><mrow id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.cmml"><mrow id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.cmml"><mn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.2" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.2.cmml">2</mn><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.1" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.1.cmml">⁢</mo><mi id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.3" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.3.cmml">L</mi></mrow><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.1" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.1.cmml">−</mo><mn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.3" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.3.cmml">2</mn></mrow></mrow><mo id="S3.Ex8Xa.2.1.1.m1.1.1.1.2" lspace="0em" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex8Xa.2.1.1.m1.1b"><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1"><and id="S3.Ex8Xa.2.1.1.m1.1.1.1.1a.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1"></and><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1b.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1"><eq id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.2">absent</csymbol><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4"><minus id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.1.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.1"></minus><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2"><plus id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.1.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.1"></plus><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.1.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2">subscript</csymbol><ci id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.2.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.2">𝑖</ci><cn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.3.cmml" type="integer" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.2.3">1</cn></apply><ci id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.3.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.2.3">𝐿</ci></apply><cn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.3.cmml" type="integer" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.3">1</cn></apply></apply><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1c.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1"><leq id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.5.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.Ex8Xa.2.1.1.m1.1.1.1.1.4.cmml" id="S3.Ex8Xa.2.1.1.m1.1.1.1.1d.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1"></share><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6"><minus id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.1.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.1"></minus><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2"><plus id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.1.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.1"></plus><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2"><minus id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.1.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.1"></minus><ci id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.2.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.2">𝐿</ci><cn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.3.cmml" type="integer" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.2.3">1</cn></apply><ci id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.3.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.2.3">𝐿</ci></apply><cn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.3.cmml" type="integer" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.3">1</cn></apply></apply><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1e.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1"><eq id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.7.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.7"></eq><share href="https://arxiv.org/html/2410.03805v1#S3.Ex8Xa.2.1.1.m1.1.1.1.1.6.cmml" id="S3.Ex8Xa.2.1.1.m1.1.1.1.1f.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1"></share><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8"><minus id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.1.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.1"></minus><apply id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2"><times id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.1.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.1"></times><cn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.2.cmml" type="integer" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.2">2</cn><ci id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.3.cmml" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.2.3">𝐿</ci></apply><cn id="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.3.cmml" type="integer" xref="S3.Ex8Xa.2.1.1.m1.1.1.1.1.8.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex8Xa.2.1.1.m1.1c">\displaystyle=i_{1}+L-1\leq L-1+L-1=2L-2.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex8Xa.2.1.1.m1.1d">= italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_L - 1 ≤ italic_L - 1 + italic_L - 1 = 2 italic_L - 2 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.2.p1.23">Finally, note that by definition of <math alttext="T_{Q}" class="ltx_Math" display="inline" id="S3.2.p1.17.m1.1"><semantics id="S3.2.p1.17.m1.1a"><msub id="S3.2.p1.17.m1.1.1" xref="S3.2.p1.17.m1.1.1.cmml"><mi id="S3.2.p1.17.m1.1.1.2" xref="S3.2.p1.17.m1.1.1.2.cmml">T</mi><mi id="S3.2.p1.17.m1.1.1.3" xref="S3.2.p1.17.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.2.p1.17.m1.1b"><apply id="S3.2.p1.17.m1.1.1.cmml" xref="S3.2.p1.17.m1.1.1"><csymbol cd="ambiguous" id="S3.2.p1.17.m1.1.1.1.cmml" xref="S3.2.p1.17.m1.1.1">subscript</csymbol><ci id="S3.2.p1.17.m1.1.1.2.cmml" xref="S3.2.p1.17.m1.1.1.2">𝑇</ci><ci id="S3.2.p1.17.m1.1.1.3.cmml" xref="S3.2.p1.17.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.17.m1.1c">T_{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.17.m1.1d">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="T_{K}" class="ltx_Math" display="inline" id="S3.2.p1.18.m2.1"><semantics id="S3.2.p1.18.m2.1a"><msub id="S3.2.p1.18.m2.1.1" xref="S3.2.p1.18.m2.1.1.cmml"><mi id="S3.2.p1.18.m2.1.1.2" xref="S3.2.p1.18.m2.1.1.2.cmml">T</mi><mi id="S3.2.p1.18.m2.1.1.3" xref="S3.2.p1.18.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.2.p1.18.m2.1b"><apply id="S3.2.p1.18.m2.1.1.cmml" xref="S3.2.p1.18.m2.1.1"><csymbol cd="ambiguous" id="S3.2.p1.18.m2.1.1.1.cmml" xref="S3.2.p1.18.m2.1.1">subscript</csymbol><ci id="S3.2.p1.18.m2.1.1.2.cmml" xref="S3.2.p1.18.m2.1.1.2">𝑇</ci><ci id="S3.2.p1.18.m2.1.1.3.cmml" xref="S3.2.p1.18.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.18.m2.1c">T_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.18.m2.1d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, we have <math alttext="Q_{i}=T_{Q}[r,i_{1},\cdot]" class="ltx_Math" display="inline" id="S3.2.p1.19.m3.3"><semantics id="S3.2.p1.19.m3.3a"><mrow id="S3.2.p1.19.m3.3.3" xref="S3.2.p1.19.m3.3.3.cmml"><msub id="S3.2.p1.19.m3.3.3.3" xref="S3.2.p1.19.m3.3.3.3.cmml"><mi id="S3.2.p1.19.m3.3.3.3.2" xref="S3.2.p1.19.m3.3.3.3.2.cmml">Q</mi><mi id="S3.2.p1.19.m3.3.3.3.3" xref="S3.2.p1.19.m3.3.3.3.3.cmml">i</mi></msub><mo id="S3.2.p1.19.m3.3.3.2" xref="S3.2.p1.19.m3.3.3.2.cmml">=</mo><mrow id="S3.2.p1.19.m3.3.3.1" xref="S3.2.p1.19.m3.3.3.1.cmml"><msub id="S3.2.p1.19.m3.3.3.1.3" xref="S3.2.p1.19.m3.3.3.1.3.cmml"><mi id="S3.2.p1.19.m3.3.3.1.3.2" xref="S3.2.p1.19.m3.3.3.1.3.2.cmml">T</mi><mi id="S3.2.p1.19.m3.3.3.1.3.3" xref="S3.2.p1.19.m3.3.3.1.3.3.cmml">Q</mi></msub><mo id="S3.2.p1.19.m3.3.3.1.2" xref="S3.2.p1.19.m3.3.3.1.2.cmml">⁢</mo><mrow id="S3.2.p1.19.m3.3.3.1.1.1" xref="S3.2.p1.19.m3.3.3.1.1.2.cmml"><mo id="S3.2.p1.19.m3.3.3.1.1.1.2" stretchy="false" xref="S3.2.p1.19.m3.3.3.1.1.2.cmml">[</mo><mi id="S3.2.p1.19.m3.1.1" xref="S3.2.p1.19.m3.1.1.cmml">r</mi><mo id="S3.2.p1.19.m3.3.3.1.1.1.3" xref="S3.2.p1.19.m3.3.3.1.1.2.cmml">,</mo><msub id="S3.2.p1.19.m3.3.3.1.1.1.1" xref="S3.2.p1.19.m3.3.3.1.1.1.1.cmml"><mi id="S3.2.p1.19.m3.3.3.1.1.1.1.2" xref="S3.2.p1.19.m3.3.3.1.1.1.1.2.cmml">i</mi><mn id="S3.2.p1.19.m3.3.3.1.1.1.1.3" xref="S3.2.p1.19.m3.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.2.p1.19.m3.3.3.1.1.1.4" rspace="0em" xref="S3.2.p1.19.m3.3.3.1.1.2.cmml">,</mo><mo id="S3.2.p1.19.m3.2.2" lspace="0em" rspace="0em" xref="S3.2.p1.19.m3.2.2.cmml">⋅</mo><mo id="S3.2.p1.19.m3.3.3.1.1.1.5" stretchy="false" xref="S3.2.p1.19.m3.3.3.1.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.19.m3.3b"><apply id="S3.2.p1.19.m3.3.3.cmml" xref="S3.2.p1.19.m3.3.3"><eq id="S3.2.p1.19.m3.3.3.2.cmml" xref="S3.2.p1.19.m3.3.3.2"></eq><apply id="S3.2.p1.19.m3.3.3.3.cmml" xref="S3.2.p1.19.m3.3.3.3"><csymbol cd="ambiguous" id="S3.2.p1.19.m3.3.3.3.1.cmml" xref="S3.2.p1.19.m3.3.3.3">subscript</csymbol><ci id="S3.2.p1.19.m3.3.3.3.2.cmml" xref="S3.2.p1.19.m3.3.3.3.2">𝑄</ci><ci id="S3.2.p1.19.m3.3.3.3.3.cmml" xref="S3.2.p1.19.m3.3.3.3.3">𝑖</ci></apply><apply id="S3.2.p1.19.m3.3.3.1.cmml" xref="S3.2.p1.19.m3.3.3.1"><times id="S3.2.p1.19.m3.3.3.1.2.cmml" xref="S3.2.p1.19.m3.3.3.1.2"></times><apply id="S3.2.p1.19.m3.3.3.1.3.cmml" xref="S3.2.p1.19.m3.3.3.1.3"><csymbol cd="ambiguous" id="S3.2.p1.19.m3.3.3.1.3.1.cmml" xref="S3.2.p1.19.m3.3.3.1.3">subscript</csymbol><ci id="S3.2.p1.19.m3.3.3.1.3.2.cmml" xref="S3.2.p1.19.m3.3.3.1.3.2">𝑇</ci><ci id="S3.2.p1.19.m3.3.3.1.3.3.cmml" xref="S3.2.p1.19.m3.3.3.1.3.3">𝑄</ci></apply><list id="S3.2.p1.19.m3.3.3.1.1.2.cmml" xref="S3.2.p1.19.m3.3.3.1.1.1"><ci id="S3.2.p1.19.m3.1.1.cmml" xref="S3.2.p1.19.m3.1.1">𝑟</ci><apply id="S3.2.p1.19.m3.3.3.1.1.1.1.cmml" xref="S3.2.p1.19.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.2.p1.19.m3.3.3.1.1.1.1.1.cmml" xref="S3.2.p1.19.m3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.2.p1.19.m3.3.3.1.1.1.1.2.cmml" xref="S3.2.p1.19.m3.3.3.1.1.1.1.2">𝑖</ci><cn id="S3.2.p1.19.m3.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.2.p1.19.m3.3.3.1.1.1.1.3">1</cn></apply><ci id="S3.2.p1.19.m3.2.2.cmml" xref="S3.2.p1.19.m3.2.2">⋅</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.19.m3.3c">Q_{i}=T_{Q}[r,i_{1},\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.19.m3.3d">italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋅ ]</annotation></semantics></math> and <math alttext="K_{j}=T_{K}[r,j_{1},\cdot]" class="ltx_Math" display="inline" id="S3.2.p1.20.m4.3"><semantics id="S3.2.p1.20.m4.3a"><mrow id="S3.2.p1.20.m4.3.3" xref="S3.2.p1.20.m4.3.3.cmml"><msub id="S3.2.p1.20.m4.3.3.3" xref="S3.2.p1.20.m4.3.3.3.cmml"><mi id="S3.2.p1.20.m4.3.3.3.2" xref="S3.2.p1.20.m4.3.3.3.2.cmml">K</mi><mi id="S3.2.p1.20.m4.3.3.3.3" xref="S3.2.p1.20.m4.3.3.3.3.cmml">j</mi></msub><mo id="S3.2.p1.20.m4.3.3.2" xref="S3.2.p1.20.m4.3.3.2.cmml">=</mo><mrow id="S3.2.p1.20.m4.3.3.1" xref="S3.2.p1.20.m4.3.3.1.cmml"><msub id="S3.2.p1.20.m4.3.3.1.3" xref="S3.2.p1.20.m4.3.3.1.3.cmml"><mi id="S3.2.p1.20.m4.3.3.1.3.2" xref="S3.2.p1.20.m4.3.3.1.3.2.cmml">T</mi><mi id="S3.2.p1.20.m4.3.3.1.3.3" xref="S3.2.p1.20.m4.3.3.1.3.3.cmml">K</mi></msub><mo id="S3.2.p1.20.m4.3.3.1.2" xref="S3.2.p1.20.m4.3.3.1.2.cmml">⁢</mo><mrow id="S3.2.p1.20.m4.3.3.1.1.1" xref="S3.2.p1.20.m4.3.3.1.1.2.cmml"><mo id="S3.2.p1.20.m4.3.3.1.1.1.2" stretchy="false" xref="S3.2.p1.20.m4.3.3.1.1.2.cmml">[</mo><mi id="S3.2.p1.20.m4.1.1" xref="S3.2.p1.20.m4.1.1.cmml">r</mi><mo id="S3.2.p1.20.m4.3.3.1.1.1.3" xref="S3.2.p1.20.m4.3.3.1.1.2.cmml">,</mo><msub id="S3.2.p1.20.m4.3.3.1.1.1.1" xref="S3.2.p1.20.m4.3.3.1.1.1.1.cmml"><mi id="S3.2.p1.20.m4.3.3.1.1.1.1.2" xref="S3.2.p1.20.m4.3.3.1.1.1.1.2.cmml">j</mi><mn id="S3.2.p1.20.m4.3.3.1.1.1.1.3" xref="S3.2.p1.20.m4.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.2.p1.20.m4.3.3.1.1.1.4" rspace="0em" xref="S3.2.p1.20.m4.3.3.1.1.2.cmml">,</mo><mo id="S3.2.p1.20.m4.2.2" lspace="0em" rspace="0em" xref="S3.2.p1.20.m4.2.2.cmml">⋅</mo><mo id="S3.2.p1.20.m4.3.3.1.1.1.5" stretchy="false" xref="S3.2.p1.20.m4.3.3.1.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.20.m4.3b"><apply id="S3.2.p1.20.m4.3.3.cmml" xref="S3.2.p1.20.m4.3.3"><eq id="S3.2.p1.20.m4.3.3.2.cmml" xref="S3.2.p1.20.m4.3.3.2"></eq><apply id="S3.2.p1.20.m4.3.3.3.cmml" xref="S3.2.p1.20.m4.3.3.3"><csymbol cd="ambiguous" id="S3.2.p1.20.m4.3.3.3.1.cmml" xref="S3.2.p1.20.m4.3.3.3">subscript</csymbol><ci id="S3.2.p1.20.m4.3.3.3.2.cmml" xref="S3.2.p1.20.m4.3.3.3.2">𝐾</ci><ci id="S3.2.p1.20.m4.3.3.3.3.cmml" xref="S3.2.p1.20.m4.3.3.3.3">𝑗</ci></apply><apply id="S3.2.p1.20.m4.3.3.1.cmml" xref="S3.2.p1.20.m4.3.3.1"><times id="S3.2.p1.20.m4.3.3.1.2.cmml" xref="S3.2.p1.20.m4.3.3.1.2"></times><apply id="S3.2.p1.20.m4.3.3.1.3.cmml" xref="S3.2.p1.20.m4.3.3.1.3"><csymbol cd="ambiguous" id="S3.2.p1.20.m4.3.3.1.3.1.cmml" xref="S3.2.p1.20.m4.3.3.1.3">subscript</csymbol><ci id="S3.2.p1.20.m4.3.3.1.3.2.cmml" xref="S3.2.p1.20.m4.3.3.1.3.2">𝑇</ci><ci id="S3.2.p1.20.m4.3.3.1.3.3.cmml" xref="S3.2.p1.20.m4.3.3.1.3.3">𝐾</ci></apply><list id="S3.2.p1.20.m4.3.3.1.1.2.cmml" xref="S3.2.p1.20.m4.3.3.1.1.1"><ci id="S3.2.p1.20.m4.1.1.cmml" xref="S3.2.p1.20.m4.1.1">𝑟</ci><apply id="S3.2.p1.20.m4.3.3.1.1.1.1.cmml" xref="S3.2.p1.20.m4.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.2.p1.20.m4.3.3.1.1.1.1.1.cmml" xref="S3.2.p1.20.m4.3.3.1.1.1.1">subscript</csymbol><ci id="S3.2.p1.20.m4.3.3.1.1.1.1.2.cmml" xref="S3.2.p1.20.m4.3.3.1.1.1.1.2">𝑗</ci><cn id="S3.2.p1.20.m4.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.2.p1.20.m4.3.3.1.1.1.1.3">1</cn></apply><ci id="S3.2.p1.20.m4.2.2.cmml" xref="S3.2.p1.20.m4.2.2">⋅</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.20.m4.3c">K_{j}=T_{K}[r,j_{1},\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.20.m4.3d">italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ italic_r , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋅ ]</annotation></semantics></math> as <math alttext="(r-1)L+1+j_{1}=j\geq 0" class="ltx_Math" display="inline" id="S3.2.p1.21.m5.1"><semantics id="S3.2.p1.21.m5.1a"><mrow id="S3.2.p1.21.m5.1.1" xref="S3.2.p1.21.m5.1.1.cmml"><mrow id="S3.2.p1.21.m5.1.1.1" xref="S3.2.p1.21.m5.1.1.1.cmml"><mrow id="S3.2.p1.21.m5.1.1.1.1" xref="S3.2.p1.21.m5.1.1.1.1.cmml"><mrow id="S3.2.p1.21.m5.1.1.1.1.1.1" xref="S3.2.p1.21.m5.1.1.1.1.1.1.1.cmml"><mo id="S3.2.p1.21.m5.1.1.1.1.1.1.2" stretchy="false" xref="S3.2.p1.21.m5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.2.p1.21.m5.1.1.1.1.1.1.1" xref="S3.2.p1.21.m5.1.1.1.1.1.1.1.cmml"><mi id="S3.2.p1.21.m5.1.1.1.1.1.1.1.2" xref="S3.2.p1.21.m5.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.2.p1.21.m5.1.1.1.1.1.1.1.1" xref="S3.2.p1.21.m5.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.2.p1.21.m5.1.1.1.1.1.1.1.3" xref="S3.2.p1.21.m5.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.2.p1.21.m5.1.1.1.1.1.1.3" stretchy="false" xref="S3.2.p1.21.m5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.2.p1.21.m5.1.1.1.1.2" xref="S3.2.p1.21.m5.1.1.1.1.2.cmml">⁢</mo><mi id="S3.2.p1.21.m5.1.1.1.1.3" xref="S3.2.p1.21.m5.1.1.1.1.3.cmml">L</mi></mrow><mo id="S3.2.p1.21.m5.1.1.1.2" xref="S3.2.p1.21.m5.1.1.1.2.cmml">+</mo><mn id="S3.2.p1.21.m5.1.1.1.3" xref="S3.2.p1.21.m5.1.1.1.3.cmml">1</mn><mo id="S3.2.p1.21.m5.1.1.1.2a" xref="S3.2.p1.21.m5.1.1.1.2.cmml">+</mo><msub id="S3.2.p1.21.m5.1.1.1.4" xref="S3.2.p1.21.m5.1.1.1.4.cmml"><mi id="S3.2.p1.21.m5.1.1.1.4.2" xref="S3.2.p1.21.m5.1.1.1.4.2.cmml">j</mi><mn id="S3.2.p1.21.m5.1.1.1.4.3" xref="S3.2.p1.21.m5.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S3.2.p1.21.m5.1.1.3" xref="S3.2.p1.21.m5.1.1.3.cmml">=</mo><mi id="S3.2.p1.21.m5.1.1.4" xref="S3.2.p1.21.m5.1.1.4.cmml">j</mi><mo id="S3.2.p1.21.m5.1.1.5" xref="S3.2.p1.21.m5.1.1.5.cmml">≥</mo><mn id="S3.2.p1.21.m5.1.1.6" xref="S3.2.p1.21.m5.1.1.6.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.21.m5.1b"><apply id="S3.2.p1.21.m5.1.1.cmml" xref="S3.2.p1.21.m5.1.1"><and id="S3.2.p1.21.m5.1.1a.cmml" xref="S3.2.p1.21.m5.1.1"></and><apply id="S3.2.p1.21.m5.1.1b.cmml" xref="S3.2.p1.21.m5.1.1"><eq id="S3.2.p1.21.m5.1.1.3.cmml" xref="S3.2.p1.21.m5.1.1.3"></eq><apply id="S3.2.p1.21.m5.1.1.1.cmml" xref="S3.2.p1.21.m5.1.1.1"><plus id="S3.2.p1.21.m5.1.1.1.2.cmml" xref="S3.2.p1.21.m5.1.1.1.2"></plus><apply id="S3.2.p1.21.m5.1.1.1.1.cmml" xref="S3.2.p1.21.m5.1.1.1.1"><times id="S3.2.p1.21.m5.1.1.1.1.2.cmml" xref="S3.2.p1.21.m5.1.1.1.1.2"></times><apply id="S3.2.p1.21.m5.1.1.1.1.1.1.1.cmml" xref="S3.2.p1.21.m5.1.1.1.1.1.1"><minus id="S3.2.p1.21.m5.1.1.1.1.1.1.1.1.cmml" xref="S3.2.p1.21.m5.1.1.1.1.1.1.1.1"></minus><ci id="S3.2.p1.21.m5.1.1.1.1.1.1.1.2.cmml" xref="S3.2.p1.21.m5.1.1.1.1.1.1.1.2">𝑟</ci><cn id="S3.2.p1.21.m5.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.2.p1.21.m5.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.2.p1.21.m5.1.1.1.1.3.cmml" xref="S3.2.p1.21.m5.1.1.1.1.3">𝐿</ci></apply><cn id="S3.2.p1.21.m5.1.1.1.3.cmml" type="integer" xref="S3.2.p1.21.m5.1.1.1.3">1</cn><apply id="S3.2.p1.21.m5.1.1.1.4.cmml" xref="S3.2.p1.21.m5.1.1.1.4"><csymbol cd="ambiguous" id="S3.2.p1.21.m5.1.1.1.4.1.cmml" xref="S3.2.p1.21.m5.1.1.1.4">subscript</csymbol><ci id="S3.2.p1.21.m5.1.1.1.4.2.cmml" xref="S3.2.p1.21.m5.1.1.1.4.2">𝑗</ci><cn id="S3.2.p1.21.m5.1.1.1.4.3.cmml" type="integer" xref="S3.2.p1.21.m5.1.1.1.4.3">1</cn></apply></apply><ci id="S3.2.p1.21.m5.1.1.4.cmml" xref="S3.2.p1.21.m5.1.1.4">𝑗</ci></apply><apply id="S3.2.p1.21.m5.1.1c.cmml" xref="S3.2.p1.21.m5.1.1"><geq id="S3.2.p1.21.m5.1.1.5.cmml" xref="S3.2.p1.21.m5.1.1.5"></geq><share href="https://arxiv.org/html/2410.03805v1#S3.2.p1.21.m5.1.1.4.cmml" id="S3.2.p1.21.m5.1.1d.cmml" xref="S3.2.p1.21.m5.1.1"></share><cn id="S3.2.p1.21.m5.1.1.6.cmml" type="integer" xref="S3.2.p1.21.m5.1.1.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.21.m5.1c">(r-1)L+1+j_{1}=j\geq 0</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.21.m5.1d">( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_j ≥ 0</annotation></semantics></math>. Note that <math alttext="T_{A}[r,i_{1},j_{1}]=\langle T_{Q}[r,i_{1},\cdot],T_{K}[r,j_{1},\cdot]\rangle" class="ltx_Math" display="inline" id="S3.2.p1.22.m6.9"><semantics id="S3.2.p1.22.m6.9a"><mrow id="S3.2.p1.22.m6.9.9" xref="S3.2.p1.22.m6.9.9.cmml"><mrow id="S3.2.p1.22.m6.7.7.2" xref="S3.2.p1.22.m6.7.7.2.cmml"><msub id="S3.2.p1.22.m6.7.7.2.4" xref="S3.2.p1.22.m6.7.7.2.4.cmml"><mi id="S3.2.p1.22.m6.7.7.2.4.2" xref="S3.2.p1.22.m6.7.7.2.4.2.cmml">T</mi><mi id="S3.2.p1.22.m6.7.7.2.4.3" xref="S3.2.p1.22.m6.7.7.2.4.3.cmml">A</mi></msub><mo id="S3.2.p1.22.m6.7.7.2.3" xref="S3.2.p1.22.m6.7.7.2.3.cmml">⁢</mo><mrow id="S3.2.p1.22.m6.7.7.2.2.2" xref="S3.2.p1.22.m6.7.7.2.2.3.cmml"><mo id="S3.2.p1.22.m6.7.7.2.2.2.3" stretchy="false" xref="S3.2.p1.22.m6.7.7.2.2.3.cmml">[</mo><mi id="S3.2.p1.22.m6.1.1" xref="S3.2.p1.22.m6.1.1.cmml">r</mi><mo id="S3.2.p1.22.m6.7.7.2.2.2.4" xref="S3.2.p1.22.m6.7.7.2.2.3.cmml">,</mo><msub id="S3.2.p1.22.m6.6.6.1.1.1.1" xref="S3.2.p1.22.m6.6.6.1.1.1.1.cmml"><mi id="S3.2.p1.22.m6.6.6.1.1.1.1.2" xref="S3.2.p1.22.m6.6.6.1.1.1.1.2.cmml">i</mi><mn id="S3.2.p1.22.m6.6.6.1.1.1.1.3" xref="S3.2.p1.22.m6.6.6.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.2.p1.22.m6.7.7.2.2.2.5" xref="S3.2.p1.22.m6.7.7.2.2.3.cmml">,</mo><msub id="S3.2.p1.22.m6.7.7.2.2.2.2" xref="S3.2.p1.22.m6.7.7.2.2.2.2.cmml"><mi id="S3.2.p1.22.m6.7.7.2.2.2.2.2" xref="S3.2.p1.22.m6.7.7.2.2.2.2.2.cmml">j</mi><mn id="S3.2.p1.22.m6.7.7.2.2.2.2.3" xref="S3.2.p1.22.m6.7.7.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.2.p1.22.m6.7.7.2.2.2.6" stretchy="false" xref="S3.2.p1.22.m6.7.7.2.2.3.cmml">]</mo></mrow></mrow><mo id="S3.2.p1.22.m6.9.9.5" xref="S3.2.p1.22.m6.9.9.5.cmml">=</mo><mrow id="S3.2.p1.22.m6.9.9.4.2" xref="S3.2.p1.22.m6.9.9.4.3.cmml"><mo id="S3.2.p1.22.m6.9.9.4.2.3" stretchy="false" xref="S3.2.p1.22.m6.9.9.4.3.cmml">⟨</mo><mrow id="S3.2.p1.22.m6.8.8.3.1.1" xref="S3.2.p1.22.m6.8.8.3.1.1.cmml"><msub id="S3.2.p1.22.m6.8.8.3.1.1.3" xref="S3.2.p1.22.m6.8.8.3.1.1.3.cmml"><mi id="S3.2.p1.22.m6.8.8.3.1.1.3.2" xref="S3.2.p1.22.m6.8.8.3.1.1.3.2.cmml">T</mi><mi id="S3.2.p1.22.m6.8.8.3.1.1.3.3" xref="S3.2.p1.22.m6.8.8.3.1.1.3.3.cmml">Q</mi></msub><mo id="S3.2.p1.22.m6.8.8.3.1.1.2" xref="S3.2.p1.22.m6.8.8.3.1.1.2.cmml">⁢</mo><mrow id="S3.2.p1.22.m6.8.8.3.1.1.1.1" xref="S3.2.p1.22.m6.8.8.3.1.1.1.2.cmml"><mo id="S3.2.p1.22.m6.8.8.3.1.1.1.1.2" stretchy="false" xref="S3.2.p1.22.m6.8.8.3.1.1.1.2.cmml">[</mo><mi id="S3.2.p1.22.m6.2.2" xref="S3.2.p1.22.m6.2.2.cmml">r</mi><mo id="S3.2.p1.22.m6.8.8.3.1.1.1.1.3" xref="S3.2.p1.22.m6.8.8.3.1.1.1.2.cmml">,</mo><msub id="S3.2.p1.22.m6.8.8.3.1.1.1.1.1" xref="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.cmml"><mi id="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.2" xref="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.2.cmml">i</mi><mn id="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.3" xref="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.2.p1.22.m6.8.8.3.1.1.1.1.4" rspace="0em" xref="S3.2.p1.22.m6.8.8.3.1.1.1.2.cmml">,</mo><mo id="S3.2.p1.22.m6.3.3" lspace="0em" rspace="0em" xref="S3.2.p1.22.m6.3.3.cmml">⋅</mo><mo id="S3.2.p1.22.m6.8.8.3.1.1.1.1.5" stretchy="false" xref="S3.2.p1.22.m6.8.8.3.1.1.1.2.cmml">]</mo></mrow></mrow><mo id="S3.2.p1.22.m6.9.9.4.2.4" xref="S3.2.p1.22.m6.9.9.4.3.cmml">,</mo><mrow id="S3.2.p1.22.m6.9.9.4.2.2" xref="S3.2.p1.22.m6.9.9.4.2.2.cmml"><msub id="S3.2.p1.22.m6.9.9.4.2.2.3" xref="S3.2.p1.22.m6.9.9.4.2.2.3.cmml"><mi id="S3.2.p1.22.m6.9.9.4.2.2.3.2" xref="S3.2.p1.22.m6.9.9.4.2.2.3.2.cmml">T</mi><mi id="S3.2.p1.22.m6.9.9.4.2.2.3.3" xref="S3.2.p1.22.m6.9.9.4.2.2.3.3.cmml">K</mi></msub><mo id="S3.2.p1.22.m6.9.9.4.2.2.2" xref="S3.2.p1.22.m6.9.9.4.2.2.2.cmml">⁢</mo><mrow id="S3.2.p1.22.m6.9.9.4.2.2.1.1" xref="S3.2.p1.22.m6.9.9.4.2.2.1.2.cmml"><mo id="S3.2.p1.22.m6.9.9.4.2.2.1.1.2" stretchy="false" xref="S3.2.p1.22.m6.9.9.4.2.2.1.2.cmml">[</mo><mi id="S3.2.p1.22.m6.4.4" xref="S3.2.p1.22.m6.4.4.cmml">r</mi><mo id="S3.2.p1.22.m6.9.9.4.2.2.1.1.3" xref="S3.2.p1.22.m6.9.9.4.2.2.1.2.cmml">,</mo><msub id="S3.2.p1.22.m6.9.9.4.2.2.1.1.1" xref="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.cmml"><mi id="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.2" xref="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.2.cmml">j</mi><mn id="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.3" xref="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.2.p1.22.m6.9.9.4.2.2.1.1.4" rspace="0em" xref="S3.2.p1.22.m6.9.9.4.2.2.1.2.cmml">,</mo><mo id="S3.2.p1.22.m6.5.5" lspace="0em" rspace="0em" xref="S3.2.p1.22.m6.5.5.cmml">⋅</mo><mo id="S3.2.p1.22.m6.9.9.4.2.2.1.1.5" stretchy="false" xref="S3.2.p1.22.m6.9.9.4.2.2.1.2.cmml">]</mo></mrow></mrow><mo id="S3.2.p1.22.m6.9.9.4.2.5" stretchy="false" xref="S3.2.p1.22.m6.9.9.4.3.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.22.m6.9b"><apply id="S3.2.p1.22.m6.9.9.cmml" xref="S3.2.p1.22.m6.9.9"><eq id="S3.2.p1.22.m6.9.9.5.cmml" xref="S3.2.p1.22.m6.9.9.5"></eq><apply id="S3.2.p1.22.m6.7.7.2.cmml" xref="S3.2.p1.22.m6.7.7.2"><times id="S3.2.p1.22.m6.7.7.2.3.cmml" xref="S3.2.p1.22.m6.7.7.2.3"></times><apply id="S3.2.p1.22.m6.7.7.2.4.cmml" xref="S3.2.p1.22.m6.7.7.2.4"><csymbol cd="ambiguous" id="S3.2.p1.22.m6.7.7.2.4.1.cmml" xref="S3.2.p1.22.m6.7.7.2.4">subscript</csymbol><ci id="S3.2.p1.22.m6.7.7.2.4.2.cmml" xref="S3.2.p1.22.m6.7.7.2.4.2">𝑇</ci><ci id="S3.2.p1.22.m6.7.7.2.4.3.cmml" xref="S3.2.p1.22.m6.7.7.2.4.3">𝐴</ci></apply><list id="S3.2.p1.22.m6.7.7.2.2.3.cmml" xref="S3.2.p1.22.m6.7.7.2.2.2"><ci id="S3.2.p1.22.m6.1.1.cmml" xref="S3.2.p1.22.m6.1.1">𝑟</ci><apply id="S3.2.p1.22.m6.6.6.1.1.1.1.cmml" xref="S3.2.p1.22.m6.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.2.p1.22.m6.6.6.1.1.1.1.1.cmml" xref="S3.2.p1.22.m6.6.6.1.1.1.1">subscript</csymbol><ci id="S3.2.p1.22.m6.6.6.1.1.1.1.2.cmml" xref="S3.2.p1.22.m6.6.6.1.1.1.1.2">𝑖</ci><cn id="S3.2.p1.22.m6.6.6.1.1.1.1.3.cmml" type="integer" xref="S3.2.p1.22.m6.6.6.1.1.1.1.3">1</cn></apply><apply id="S3.2.p1.22.m6.7.7.2.2.2.2.cmml" xref="S3.2.p1.22.m6.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.2.p1.22.m6.7.7.2.2.2.2.1.cmml" xref="S3.2.p1.22.m6.7.7.2.2.2.2">subscript</csymbol><ci id="S3.2.p1.22.m6.7.7.2.2.2.2.2.cmml" xref="S3.2.p1.22.m6.7.7.2.2.2.2.2">𝑗</ci><cn id="S3.2.p1.22.m6.7.7.2.2.2.2.3.cmml" type="integer" xref="S3.2.p1.22.m6.7.7.2.2.2.2.3">1</cn></apply></list></apply><list id="S3.2.p1.22.m6.9.9.4.3.cmml" xref="S3.2.p1.22.m6.9.9.4.2"><apply id="S3.2.p1.22.m6.8.8.3.1.1.cmml" xref="S3.2.p1.22.m6.8.8.3.1.1"><times id="S3.2.p1.22.m6.8.8.3.1.1.2.cmml" xref="S3.2.p1.22.m6.8.8.3.1.1.2"></times><apply id="S3.2.p1.22.m6.8.8.3.1.1.3.cmml" xref="S3.2.p1.22.m6.8.8.3.1.1.3"><csymbol cd="ambiguous" id="S3.2.p1.22.m6.8.8.3.1.1.3.1.cmml" xref="S3.2.p1.22.m6.8.8.3.1.1.3">subscript</csymbol><ci id="S3.2.p1.22.m6.8.8.3.1.1.3.2.cmml" xref="S3.2.p1.22.m6.8.8.3.1.1.3.2">𝑇</ci><ci id="S3.2.p1.22.m6.8.8.3.1.1.3.3.cmml" xref="S3.2.p1.22.m6.8.8.3.1.1.3.3">𝑄</ci></apply><list id="S3.2.p1.22.m6.8.8.3.1.1.1.2.cmml" xref="S3.2.p1.22.m6.8.8.3.1.1.1.1"><ci id="S3.2.p1.22.m6.2.2.cmml" xref="S3.2.p1.22.m6.2.2">𝑟</ci><apply id="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.cmml" xref="S3.2.p1.22.m6.8.8.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.1.cmml" xref="S3.2.p1.22.m6.8.8.3.1.1.1.1.1">subscript</csymbol><ci id="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.2.cmml" xref="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.2">𝑖</ci><cn id="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.3.cmml" type="integer" xref="S3.2.p1.22.m6.8.8.3.1.1.1.1.1.3">1</cn></apply><ci id="S3.2.p1.22.m6.3.3.cmml" xref="S3.2.p1.22.m6.3.3">⋅</ci></list></apply><apply id="S3.2.p1.22.m6.9.9.4.2.2.cmml" xref="S3.2.p1.22.m6.9.9.4.2.2"><times id="S3.2.p1.22.m6.9.9.4.2.2.2.cmml" xref="S3.2.p1.22.m6.9.9.4.2.2.2"></times><apply id="S3.2.p1.22.m6.9.9.4.2.2.3.cmml" xref="S3.2.p1.22.m6.9.9.4.2.2.3"><csymbol cd="ambiguous" id="S3.2.p1.22.m6.9.9.4.2.2.3.1.cmml" xref="S3.2.p1.22.m6.9.9.4.2.2.3">subscript</csymbol><ci id="S3.2.p1.22.m6.9.9.4.2.2.3.2.cmml" xref="S3.2.p1.22.m6.9.9.4.2.2.3.2">𝑇</ci><ci id="S3.2.p1.22.m6.9.9.4.2.2.3.3.cmml" xref="S3.2.p1.22.m6.9.9.4.2.2.3.3">𝐾</ci></apply><list id="S3.2.p1.22.m6.9.9.4.2.2.1.2.cmml" xref="S3.2.p1.22.m6.9.9.4.2.2.1.1"><ci id="S3.2.p1.22.m6.4.4.cmml" xref="S3.2.p1.22.m6.4.4">𝑟</ci><apply id="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.cmml" xref="S3.2.p1.22.m6.9.9.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.1.cmml" xref="S3.2.p1.22.m6.9.9.4.2.2.1.1.1">subscript</csymbol><ci id="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.2.cmml" xref="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.2">𝑗</ci><cn id="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.3.cmml" type="integer" xref="S3.2.p1.22.m6.9.9.4.2.2.1.1.1.3">1</cn></apply><ci id="S3.2.p1.22.m6.5.5.cmml" xref="S3.2.p1.22.m6.5.5">⋅</ci></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.22.m6.9c">T_{A}[r,i_{1},j_{1}]=\langle T_{Q}[r,i_{1},\cdot],T_{K}[r,j_{1},\cdot]\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.22.m6.9d">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = ⟨ italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋅ ] , italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ italic_r , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋅ ] ⟩</annotation></semantics></math> by definition of matrix multiplication. Thus, we conclude that <math alttext="\langle Q_{i},K_{j}\rangle=T_{A}[r,i_{1},j_{1}]" class="ltx_Math" display="inline" id="S3.2.p1.23.m7.5"><semantics id="S3.2.p1.23.m7.5a"><mrow id="S3.2.p1.23.m7.5.5" xref="S3.2.p1.23.m7.5.5.cmml"><mrow id="S3.2.p1.23.m7.3.3.2.2" xref="S3.2.p1.23.m7.3.3.2.3.cmml"><mo id="S3.2.p1.23.m7.3.3.2.2.3" stretchy="false" xref="S3.2.p1.23.m7.3.3.2.3.cmml">⟨</mo><msub id="S3.2.p1.23.m7.2.2.1.1.1" xref="S3.2.p1.23.m7.2.2.1.1.1.cmml"><mi id="S3.2.p1.23.m7.2.2.1.1.1.2" xref="S3.2.p1.23.m7.2.2.1.1.1.2.cmml">Q</mi><mi id="S3.2.p1.23.m7.2.2.1.1.1.3" xref="S3.2.p1.23.m7.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.2.p1.23.m7.3.3.2.2.4" xref="S3.2.p1.23.m7.3.3.2.3.cmml">,</mo><msub id="S3.2.p1.23.m7.3.3.2.2.2" xref="S3.2.p1.23.m7.3.3.2.2.2.cmml"><mi id="S3.2.p1.23.m7.3.3.2.2.2.2" xref="S3.2.p1.23.m7.3.3.2.2.2.2.cmml">K</mi><mi id="S3.2.p1.23.m7.3.3.2.2.2.3" xref="S3.2.p1.23.m7.3.3.2.2.2.3.cmml">j</mi></msub><mo id="S3.2.p1.23.m7.3.3.2.2.5" stretchy="false" xref="S3.2.p1.23.m7.3.3.2.3.cmml">⟩</mo></mrow><mo id="S3.2.p1.23.m7.5.5.5" xref="S3.2.p1.23.m7.5.5.5.cmml">=</mo><mrow id="S3.2.p1.23.m7.5.5.4" xref="S3.2.p1.23.m7.5.5.4.cmml"><msub id="S3.2.p1.23.m7.5.5.4.4" xref="S3.2.p1.23.m7.5.5.4.4.cmml"><mi id="S3.2.p1.23.m7.5.5.4.4.2" xref="S3.2.p1.23.m7.5.5.4.4.2.cmml">T</mi><mi id="S3.2.p1.23.m7.5.5.4.4.3" xref="S3.2.p1.23.m7.5.5.4.4.3.cmml">A</mi></msub><mo id="S3.2.p1.23.m7.5.5.4.3" xref="S3.2.p1.23.m7.5.5.4.3.cmml">⁢</mo><mrow id="S3.2.p1.23.m7.5.5.4.2.2" xref="S3.2.p1.23.m7.5.5.4.2.3.cmml"><mo id="S3.2.p1.23.m7.5.5.4.2.2.3" stretchy="false" xref="S3.2.p1.23.m7.5.5.4.2.3.cmml">[</mo><mi id="S3.2.p1.23.m7.1.1" xref="S3.2.p1.23.m7.1.1.cmml">r</mi><mo id="S3.2.p1.23.m7.5.5.4.2.2.4" xref="S3.2.p1.23.m7.5.5.4.2.3.cmml">,</mo><msub id="S3.2.p1.23.m7.4.4.3.1.1.1" xref="S3.2.p1.23.m7.4.4.3.1.1.1.cmml"><mi id="S3.2.p1.23.m7.4.4.3.1.1.1.2" xref="S3.2.p1.23.m7.4.4.3.1.1.1.2.cmml">i</mi><mn id="S3.2.p1.23.m7.4.4.3.1.1.1.3" xref="S3.2.p1.23.m7.4.4.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.2.p1.23.m7.5.5.4.2.2.5" xref="S3.2.p1.23.m7.5.5.4.2.3.cmml">,</mo><msub id="S3.2.p1.23.m7.5.5.4.2.2.2" xref="S3.2.p1.23.m7.5.5.4.2.2.2.cmml"><mi id="S3.2.p1.23.m7.5.5.4.2.2.2.2" xref="S3.2.p1.23.m7.5.5.4.2.2.2.2.cmml">j</mi><mn id="S3.2.p1.23.m7.5.5.4.2.2.2.3" xref="S3.2.p1.23.m7.5.5.4.2.2.2.3.cmml">1</mn></msub><mo id="S3.2.p1.23.m7.5.5.4.2.2.6" stretchy="false" xref="S3.2.p1.23.m7.5.5.4.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.2.p1.23.m7.5b"><apply id="S3.2.p1.23.m7.5.5.cmml" xref="S3.2.p1.23.m7.5.5"><eq id="S3.2.p1.23.m7.5.5.5.cmml" xref="S3.2.p1.23.m7.5.5.5"></eq><list id="S3.2.p1.23.m7.3.3.2.3.cmml" xref="S3.2.p1.23.m7.3.3.2.2"><apply id="S3.2.p1.23.m7.2.2.1.1.1.cmml" xref="S3.2.p1.23.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.2.p1.23.m7.2.2.1.1.1.1.cmml" xref="S3.2.p1.23.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.2.p1.23.m7.2.2.1.1.1.2.cmml" xref="S3.2.p1.23.m7.2.2.1.1.1.2">𝑄</ci><ci id="S3.2.p1.23.m7.2.2.1.1.1.3.cmml" xref="S3.2.p1.23.m7.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.2.p1.23.m7.3.3.2.2.2.cmml" xref="S3.2.p1.23.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.2.p1.23.m7.3.3.2.2.2.1.cmml" xref="S3.2.p1.23.m7.3.3.2.2.2">subscript</csymbol><ci id="S3.2.p1.23.m7.3.3.2.2.2.2.cmml" xref="S3.2.p1.23.m7.3.3.2.2.2.2">𝐾</ci><ci id="S3.2.p1.23.m7.3.3.2.2.2.3.cmml" xref="S3.2.p1.23.m7.3.3.2.2.2.3">𝑗</ci></apply></list><apply id="S3.2.p1.23.m7.5.5.4.cmml" xref="S3.2.p1.23.m7.5.5.4"><times id="S3.2.p1.23.m7.5.5.4.3.cmml" xref="S3.2.p1.23.m7.5.5.4.3"></times><apply id="S3.2.p1.23.m7.5.5.4.4.cmml" xref="S3.2.p1.23.m7.5.5.4.4"><csymbol cd="ambiguous" id="S3.2.p1.23.m7.5.5.4.4.1.cmml" xref="S3.2.p1.23.m7.5.5.4.4">subscript</csymbol><ci id="S3.2.p1.23.m7.5.5.4.4.2.cmml" xref="S3.2.p1.23.m7.5.5.4.4.2">𝑇</ci><ci id="S3.2.p1.23.m7.5.5.4.4.3.cmml" xref="S3.2.p1.23.m7.5.5.4.4.3">𝐴</ci></apply><list id="S3.2.p1.23.m7.5.5.4.2.3.cmml" xref="S3.2.p1.23.m7.5.5.4.2.2"><ci id="S3.2.p1.23.m7.1.1.cmml" xref="S3.2.p1.23.m7.1.1">𝑟</ci><apply id="S3.2.p1.23.m7.4.4.3.1.1.1.cmml" xref="S3.2.p1.23.m7.4.4.3.1.1.1"><csymbol cd="ambiguous" id="S3.2.p1.23.m7.4.4.3.1.1.1.1.cmml" xref="S3.2.p1.23.m7.4.4.3.1.1.1">subscript</csymbol><ci id="S3.2.p1.23.m7.4.4.3.1.1.1.2.cmml" xref="S3.2.p1.23.m7.4.4.3.1.1.1.2">𝑖</ci><cn id="S3.2.p1.23.m7.4.4.3.1.1.1.3.cmml" type="integer" xref="S3.2.p1.23.m7.4.4.3.1.1.1.3">1</cn></apply><apply id="S3.2.p1.23.m7.5.5.4.2.2.2.cmml" xref="S3.2.p1.23.m7.5.5.4.2.2.2"><csymbol cd="ambiguous" id="S3.2.p1.23.m7.5.5.4.2.2.2.1.cmml" xref="S3.2.p1.23.m7.5.5.4.2.2.2">subscript</csymbol><ci id="S3.2.p1.23.m7.5.5.4.2.2.2.2.cmml" xref="S3.2.p1.23.m7.5.5.4.2.2.2.2">𝑗</ci><cn id="S3.2.p1.23.m7.5.5.4.2.2.2.3.cmml" type="integer" xref="S3.2.p1.23.m7.5.5.4.2.2.2.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.2.p1.23.m7.5c">\langle Q_{i},K_{j}\rangle=T_{A}[r,i_{1},j_{1}]</annotation><annotation encoding="application/x-llamapun" id="S3.2.p1.23.m7.5d">⟨ italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ = italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>.
∎</p>
</div>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="336" id="S3.F2.sf1.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Visualisation of the product <math alttext="QK^{T}" class="ltx_Math" display="inline" id="S3.F2.sf1.4.m1.1"><semantics id="S3.F2.sf1.4.m1.1b"><mrow id="S3.F2.sf1.4.m1.1.1" xref="S3.F2.sf1.4.m1.1.1.cmml"><mi id="S3.F2.sf1.4.m1.1.1.2" xref="S3.F2.sf1.4.m1.1.1.2.cmml">Q</mi><mo id="S3.F2.sf1.4.m1.1.1.1" xref="S3.F2.sf1.4.m1.1.1.1.cmml">⁢</mo><msup id="S3.F2.sf1.4.m1.1.1.3" xref="S3.F2.sf1.4.m1.1.1.3.cmml"><mi id="S3.F2.sf1.4.m1.1.1.3.2" xref="S3.F2.sf1.4.m1.1.1.3.2.cmml">K</mi><mi id="S3.F2.sf1.4.m1.1.1.3.3" xref="S3.F2.sf1.4.m1.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf1.4.m1.1c"><apply id="S3.F2.sf1.4.m1.1.1.cmml" xref="S3.F2.sf1.4.m1.1.1"><times id="S3.F2.sf1.4.m1.1.1.1.cmml" xref="S3.F2.sf1.4.m1.1.1.1"></times><ci id="S3.F2.sf1.4.m1.1.1.2.cmml" xref="S3.F2.sf1.4.m1.1.1.2">𝑄</ci><apply id="S3.F2.sf1.4.m1.1.1.3.cmml" xref="S3.F2.sf1.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.sf1.4.m1.1.1.3.1.cmml" xref="S3.F2.sf1.4.m1.1.1.3">superscript</csymbol><ci id="S3.F2.sf1.4.m1.1.1.3.2.cmml" xref="S3.F2.sf1.4.m1.1.1.3.2">𝐾</ci><ci id="S3.F2.sf1.4.m1.1.1.3.3.cmml" xref="S3.F2.sf1.4.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf1.4.m1.1d">QK^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf1.4.m1.1e">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>. In green, we highlight the dot products needed in LAM, as the rest are set to <math alttext="-\infty" class="ltx_Math" display="inline" id="S3.F2.sf1.5.m2.1"><semantics id="S3.F2.sf1.5.m2.1b"><mrow id="S3.F2.sf1.5.m2.1.1" xref="S3.F2.sf1.5.m2.1.1.cmml"><mo id="S3.F2.sf1.5.m2.1.1b" xref="S3.F2.sf1.5.m2.1.1.cmml">−</mo><mi id="S3.F2.sf1.5.m2.1.1.2" mathvariant="normal" xref="S3.F2.sf1.5.m2.1.1.2.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf1.5.m2.1c"><apply id="S3.F2.sf1.5.m2.1.1.cmml" xref="S3.F2.sf1.5.m2.1.1"><minus id="S3.F2.sf1.5.m2.1.1.1.cmml" xref="S3.F2.sf1.5.m2.1.1"></minus><infinity id="S3.F2.sf1.5.m2.1.1.2.cmml" xref="S3.F2.sf1.5.m2.1.1.2"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf1.5.m2.1d">-\infty</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf1.5.m2.1e">- ∞</annotation></semantics></math> when adding <math alttext="M" class="ltx_Math" display="inline" id="S3.F2.sf1.6.m3.1"><semantics id="S3.F2.sf1.6.m3.1b"><mi id="S3.F2.sf1.6.m3.1.1" xref="S3.F2.sf1.6.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.F2.sf1.6.m3.1c"><ci id="S3.F2.sf1.6.m3.1.1.cmml" xref="S3.F2.sf1.6.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf1.6.m3.1d">M</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf1.6.m3.1e">italic_M</annotation></semantics></math> in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.E3" title="Equation 3 ‣ Definition 1 (Local Attention). ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">3</span></a>).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="336" id="S3.F2.sf2.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>In light brown we have the block <math alttext="T_{Q}[0,\cdot,\cdot]" class="ltx_Math" display="inline" id="S3.F2.sf2.6.m1.3"><semantics id="S3.F2.sf2.6.m1.3b"><mrow id="S3.F2.sf2.6.m1.3.4" xref="S3.F2.sf2.6.m1.3.4.cmml"><msub id="S3.F2.sf2.6.m1.3.4.2" xref="S3.F2.sf2.6.m1.3.4.2.cmml"><mi id="S3.F2.sf2.6.m1.3.4.2.2" xref="S3.F2.sf2.6.m1.3.4.2.2.cmml">T</mi><mi id="S3.F2.sf2.6.m1.3.4.2.3" xref="S3.F2.sf2.6.m1.3.4.2.3.cmml">Q</mi></msub><mo id="S3.F2.sf2.6.m1.3.4.1" xref="S3.F2.sf2.6.m1.3.4.1.cmml">⁢</mo><mrow id="S3.F2.sf2.6.m1.3.4.3.2" xref="S3.F2.sf2.6.m1.3.4.3.1.cmml"><mo id="S3.F2.sf2.6.m1.3.4.3.2.1" stretchy="false" xref="S3.F2.sf2.6.m1.3.4.3.1.cmml">[</mo><mn id="S3.F2.sf2.6.m1.1.1" xref="S3.F2.sf2.6.m1.1.1.cmml">0</mn><mo id="S3.F2.sf2.6.m1.3.4.3.2.2" rspace="0em" xref="S3.F2.sf2.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F2.sf2.6.m1.2.2" lspace="0em" rspace="0em" xref="S3.F2.sf2.6.m1.2.2.cmml">⋅</mo><mo id="S3.F2.sf2.6.m1.3.4.3.2.3" rspace="0em" xref="S3.F2.sf2.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F2.sf2.6.m1.3.3" lspace="0em" rspace="0em" xref="S3.F2.sf2.6.m1.3.3.cmml">⋅</mo><mo id="S3.F2.sf2.6.m1.3.4.3.2.4" stretchy="false" xref="S3.F2.sf2.6.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf2.6.m1.3c"><apply id="S3.F2.sf2.6.m1.3.4.cmml" xref="S3.F2.sf2.6.m1.3.4"><times id="S3.F2.sf2.6.m1.3.4.1.cmml" xref="S3.F2.sf2.6.m1.3.4.1"></times><apply id="S3.F2.sf2.6.m1.3.4.2.cmml" xref="S3.F2.sf2.6.m1.3.4.2"><csymbol cd="ambiguous" id="S3.F2.sf2.6.m1.3.4.2.1.cmml" xref="S3.F2.sf2.6.m1.3.4.2">subscript</csymbol><ci id="S3.F2.sf2.6.m1.3.4.2.2.cmml" xref="S3.F2.sf2.6.m1.3.4.2.2">𝑇</ci><ci id="S3.F2.sf2.6.m1.3.4.2.3.cmml" xref="S3.F2.sf2.6.m1.3.4.2.3">𝑄</ci></apply><list id="S3.F2.sf2.6.m1.3.4.3.1.cmml" xref="S3.F2.sf2.6.m1.3.4.3.2"><cn id="S3.F2.sf2.6.m1.1.1.cmml" type="integer" xref="S3.F2.sf2.6.m1.1.1">0</cn><ci id="S3.F2.sf2.6.m1.2.2.cmml" xref="S3.F2.sf2.6.m1.2.2">⋅</ci><ci id="S3.F2.sf2.6.m1.3.3.cmml" xref="S3.F2.sf2.6.m1.3.3">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf2.6.m1.3d">T_{Q}[0,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf2.6.m1.3e">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ 0 , ⋅ , ⋅ ]</annotation></semantics></math> of <math alttext="Q" class="ltx_Math" display="inline" id="S3.F2.sf2.7.m2.1"><semantics id="S3.F2.sf2.7.m2.1b"><mi id="S3.F2.sf2.7.m2.1.1" xref="S3.F2.sf2.7.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.F2.sf2.7.m2.1c"><ci id="S3.F2.sf2.7.m2.1.1.cmml" xref="S3.F2.sf2.7.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf2.7.m2.1d">Q</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf2.7.m2.1e">italic_Q</annotation></semantics></math>, the non-zero elements of the block <math alttext="T_{K}[0,\cdot,\cdot]^{T}" class="ltx_Math" display="inline" id="S3.F2.sf2.8.m3.3"><semantics id="S3.F2.sf2.8.m3.3b"><mrow id="S3.F2.sf2.8.m3.3.4" xref="S3.F2.sf2.8.m3.3.4.cmml"><msub id="S3.F2.sf2.8.m3.3.4.2" xref="S3.F2.sf2.8.m3.3.4.2.cmml"><mi id="S3.F2.sf2.8.m3.3.4.2.2" xref="S3.F2.sf2.8.m3.3.4.2.2.cmml">T</mi><mi id="S3.F2.sf2.8.m3.3.4.2.3" xref="S3.F2.sf2.8.m3.3.4.2.3.cmml">K</mi></msub><mo id="S3.F2.sf2.8.m3.3.4.1" xref="S3.F2.sf2.8.m3.3.4.1.cmml">⁢</mo><msup id="S3.F2.sf2.8.m3.3.4.3" xref="S3.F2.sf2.8.m3.3.4.3.cmml"><mrow id="S3.F2.sf2.8.m3.3.4.3.2.2" xref="S3.F2.sf2.8.m3.3.4.3.2.1.cmml"><mo id="S3.F2.sf2.8.m3.3.4.3.2.2.1" stretchy="false" xref="S3.F2.sf2.8.m3.3.4.3.2.1.cmml">[</mo><mn id="S3.F2.sf2.8.m3.1.1" xref="S3.F2.sf2.8.m3.1.1.cmml">0</mn><mo id="S3.F2.sf2.8.m3.3.4.3.2.2.2" rspace="0em" xref="S3.F2.sf2.8.m3.3.4.3.2.1.cmml">,</mo><mo id="S3.F2.sf2.8.m3.2.2" lspace="0em" rspace="0em" xref="S3.F2.sf2.8.m3.2.2.cmml">⋅</mo><mo id="S3.F2.sf2.8.m3.3.4.3.2.2.3" rspace="0em" xref="S3.F2.sf2.8.m3.3.4.3.2.1.cmml">,</mo><mo id="S3.F2.sf2.8.m3.3.3" lspace="0em" rspace="0em" xref="S3.F2.sf2.8.m3.3.3.cmml">⋅</mo><mo id="S3.F2.sf2.8.m3.3.4.3.2.2.4" stretchy="false" xref="S3.F2.sf2.8.m3.3.4.3.2.1.cmml">]</mo></mrow><mi id="S3.F2.sf2.8.m3.3.4.3.3" xref="S3.F2.sf2.8.m3.3.4.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf2.8.m3.3c"><apply id="S3.F2.sf2.8.m3.3.4.cmml" xref="S3.F2.sf2.8.m3.3.4"><times id="S3.F2.sf2.8.m3.3.4.1.cmml" xref="S3.F2.sf2.8.m3.3.4.1"></times><apply id="S3.F2.sf2.8.m3.3.4.2.cmml" xref="S3.F2.sf2.8.m3.3.4.2"><csymbol cd="ambiguous" id="S3.F2.sf2.8.m3.3.4.2.1.cmml" xref="S3.F2.sf2.8.m3.3.4.2">subscript</csymbol><ci id="S3.F2.sf2.8.m3.3.4.2.2.cmml" xref="S3.F2.sf2.8.m3.3.4.2.2">𝑇</ci><ci id="S3.F2.sf2.8.m3.3.4.2.3.cmml" xref="S3.F2.sf2.8.m3.3.4.2.3">𝐾</ci></apply><apply id="S3.F2.sf2.8.m3.3.4.3.cmml" xref="S3.F2.sf2.8.m3.3.4.3"><csymbol cd="ambiguous" id="S3.F2.sf2.8.m3.3.4.3.1.cmml" xref="S3.F2.sf2.8.m3.3.4.3">superscript</csymbol><list id="S3.F2.sf2.8.m3.3.4.3.2.1.cmml" xref="S3.F2.sf2.8.m3.3.4.3.2.2"><cn id="S3.F2.sf2.8.m3.1.1.cmml" type="integer" xref="S3.F2.sf2.8.m3.1.1">0</cn><ci id="S3.F2.sf2.8.m3.2.2.cmml" xref="S3.F2.sf2.8.m3.2.2">⋅</ci><ci id="S3.F2.sf2.8.m3.3.3.cmml" xref="S3.F2.sf2.8.m3.3.3">⋅</ci></list><ci id="S3.F2.sf2.8.m3.3.4.3.3.cmml" xref="S3.F2.sf2.8.m3.3.4.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf2.8.m3.3d">T_{K}[0,\cdot,\cdot]^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf2.8.m3.3e">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ 0 , ⋅ , ⋅ ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> of <math alttext="K^{T}" class="ltx_Math" display="inline" id="S3.F2.sf2.9.m4.1"><semantics id="S3.F2.sf2.9.m4.1b"><msup id="S3.F2.sf2.9.m4.1.1" xref="S3.F2.sf2.9.m4.1.1.cmml"><mi id="S3.F2.sf2.9.m4.1.1.2" xref="S3.F2.sf2.9.m4.1.1.2.cmml">K</mi><mi id="S3.F2.sf2.9.m4.1.1.3" xref="S3.F2.sf2.9.m4.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="S3.F2.sf2.9.m4.1c"><apply id="S3.F2.sf2.9.m4.1.1.cmml" xref="S3.F2.sf2.9.m4.1.1"><csymbol cd="ambiguous" id="S3.F2.sf2.9.m4.1.1.1.cmml" xref="S3.F2.sf2.9.m4.1.1">superscript</csymbol><ci id="S3.F2.sf2.9.m4.1.1.2.cmml" xref="S3.F2.sf2.9.m4.1.1.2">𝐾</ci><ci id="S3.F2.sf2.9.m4.1.1.3.cmml" xref="S3.F2.sf2.9.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf2.9.m4.1d">K^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf2.9.m4.1e">italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, and the dot products corresponding to <math alttext="T_{Q}[0,\cdot,\cdot]T_{K}[0,\cdot,\cdot]^{T}" class="ltx_Math" display="inline" id="S3.F2.sf2.10.m5.6"><semantics id="S3.F2.sf2.10.m5.6b"><mrow id="S3.F2.sf2.10.m5.6.7" xref="S3.F2.sf2.10.m5.6.7.cmml"><msub id="S3.F2.sf2.10.m5.6.7.2" xref="S3.F2.sf2.10.m5.6.7.2.cmml"><mi id="S3.F2.sf2.10.m5.6.7.2.2" xref="S3.F2.sf2.10.m5.6.7.2.2.cmml">T</mi><mi id="S3.F2.sf2.10.m5.6.7.2.3" xref="S3.F2.sf2.10.m5.6.7.2.3.cmml">Q</mi></msub><mo id="S3.F2.sf2.10.m5.6.7.1" xref="S3.F2.sf2.10.m5.6.7.1.cmml">⁢</mo><mrow id="S3.F2.sf2.10.m5.6.7.3.2" xref="S3.F2.sf2.10.m5.6.7.3.1.cmml"><mo id="S3.F2.sf2.10.m5.6.7.3.2.1" stretchy="false" xref="S3.F2.sf2.10.m5.6.7.3.1.cmml">[</mo><mn id="S3.F2.sf2.10.m5.1.1" xref="S3.F2.sf2.10.m5.1.1.cmml">0</mn><mo id="S3.F2.sf2.10.m5.6.7.3.2.2" rspace="0em" xref="S3.F2.sf2.10.m5.6.7.3.1.cmml">,</mo><mo id="S3.F2.sf2.10.m5.2.2" lspace="0em" rspace="0em" xref="S3.F2.sf2.10.m5.2.2.cmml">⋅</mo><mo id="S3.F2.sf2.10.m5.6.7.3.2.3" rspace="0em" xref="S3.F2.sf2.10.m5.6.7.3.1.cmml">,</mo><mo id="S3.F2.sf2.10.m5.3.3" lspace="0em" rspace="0em" xref="S3.F2.sf2.10.m5.3.3.cmml">⋅</mo><mo id="S3.F2.sf2.10.m5.6.7.3.2.4" stretchy="false" xref="S3.F2.sf2.10.m5.6.7.3.1.cmml">]</mo></mrow><mo id="S3.F2.sf2.10.m5.6.7.1b" xref="S3.F2.sf2.10.m5.6.7.1.cmml">⁢</mo><msub id="S3.F2.sf2.10.m5.6.7.4" xref="S3.F2.sf2.10.m5.6.7.4.cmml"><mi id="S3.F2.sf2.10.m5.6.7.4.2" xref="S3.F2.sf2.10.m5.6.7.4.2.cmml">T</mi><mi id="S3.F2.sf2.10.m5.6.7.4.3" xref="S3.F2.sf2.10.m5.6.7.4.3.cmml">K</mi></msub><mo id="S3.F2.sf2.10.m5.6.7.1c" xref="S3.F2.sf2.10.m5.6.7.1.cmml">⁢</mo><msup id="S3.F2.sf2.10.m5.6.7.5" xref="S3.F2.sf2.10.m5.6.7.5.cmml"><mrow id="S3.F2.sf2.10.m5.6.7.5.2.2" xref="S3.F2.sf2.10.m5.6.7.5.2.1.cmml"><mo id="S3.F2.sf2.10.m5.6.7.5.2.2.1" stretchy="false" xref="S3.F2.sf2.10.m5.6.7.5.2.1.cmml">[</mo><mn id="S3.F2.sf2.10.m5.4.4" xref="S3.F2.sf2.10.m5.4.4.cmml">0</mn><mo id="S3.F2.sf2.10.m5.6.7.5.2.2.2" rspace="0em" xref="S3.F2.sf2.10.m5.6.7.5.2.1.cmml">,</mo><mo id="S3.F2.sf2.10.m5.5.5" lspace="0em" rspace="0em" xref="S3.F2.sf2.10.m5.5.5.cmml">⋅</mo><mo id="S3.F2.sf2.10.m5.6.7.5.2.2.3" rspace="0em" xref="S3.F2.sf2.10.m5.6.7.5.2.1.cmml">,</mo><mo id="S3.F2.sf2.10.m5.6.6" lspace="0em" rspace="0em" xref="S3.F2.sf2.10.m5.6.6.cmml">⋅</mo><mo id="S3.F2.sf2.10.m5.6.7.5.2.2.4" stretchy="false" xref="S3.F2.sf2.10.m5.6.7.5.2.1.cmml">]</mo></mrow><mi id="S3.F2.sf2.10.m5.6.7.5.3" xref="S3.F2.sf2.10.m5.6.7.5.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf2.10.m5.6c"><apply id="S3.F2.sf2.10.m5.6.7.cmml" xref="S3.F2.sf2.10.m5.6.7"><times id="S3.F2.sf2.10.m5.6.7.1.cmml" xref="S3.F2.sf2.10.m5.6.7.1"></times><apply id="S3.F2.sf2.10.m5.6.7.2.cmml" xref="S3.F2.sf2.10.m5.6.7.2"><csymbol cd="ambiguous" id="S3.F2.sf2.10.m5.6.7.2.1.cmml" xref="S3.F2.sf2.10.m5.6.7.2">subscript</csymbol><ci id="S3.F2.sf2.10.m5.6.7.2.2.cmml" xref="S3.F2.sf2.10.m5.6.7.2.2">𝑇</ci><ci id="S3.F2.sf2.10.m5.6.7.2.3.cmml" xref="S3.F2.sf2.10.m5.6.7.2.3">𝑄</ci></apply><list id="S3.F2.sf2.10.m5.6.7.3.1.cmml" xref="S3.F2.sf2.10.m5.6.7.3.2"><cn id="S3.F2.sf2.10.m5.1.1.cmml" type="integer" xref="S3.F2.sf2.10.m5.1.1">0</cn><ci id="S3.F2.sf2.10.m5.2.2.cmml" xref="S3.F2.sf2.10.m5.2.2">⋅</ci><ci id="S3.F2.sf2.10.m5.3.3.cmml" xref="S3.F2.sf2.10.m5.3.3">⋅</ci></list><apply id="S3.F2.sf2.10.m5.6.7.4.cmml" xref="S3.F2.sf2.10.m5.6.7.4"><csymbol cd="ambiguous" id="S3.F2.sf2.10.m5.6.7.4.1.cmml" xref="S3.F2.sf2.10.m5.6.7.4">subscript</csymbol><ci id="S3.F2.sf2.10.m5.6.7.4.2.cmml" xref="S3.F2.sf2.10.m5.6.7.4.2">𝑇</ci><ci id="S3.F2.sf2.10.m5.6.7.4.3.cmml" xref="S3.F2.sf2.10.m5.6.7.4.3">𝐾</ci></apply><apply id="S3.F2.sf2.10.m5.6.7.5.cmml" xref="S3.F2.sf2.10.m5.6.7.5"><csymbol cd="ambiguous" id="S3.F2.sf2.10.m5.6.7.5.1.cmml" xref="S3.F2.sf2.10.m5.6.7.5">superscript</csymbol><list id="S3.F2.sf2.10.m5.6.7.5.2.1.cmml" xref="S3.F2.sf2.10.m5.6.7.5.2.2"><cn id="S3.F2.sf2.10.m5.4.4.cmml" type="integer" xref="S3.F2.sf2.10.m5.4.4">0</cn><ci id="S3.F2.sf2.10.m5.5.5.cmml" xref="S3.F2.sf2.10.m5.5.5">⋅</ci><ci id="S3.F2.sf2.10.m5.6.6.cmml" xref="S3.F2.sf2.10.m5.6.6">⋅</ci></list><ci id="S3.F2.sf2.10.m5.6.7.5.3.cmml" xref="S3.F2.sf2.10.m5.6.7.5.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf2.10.m5.6d">T_{Q}[0,\cdot,\cdot]T_{K}[0,\cdot,\cdot]^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf2.10.m5.6e">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ 0 , ⋅ , ⋅ ] italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ 0 , ⋅ , ⋅ ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="336" id="S3.F2.sf3.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>In brown we have the block <math alttext="T_{Q}[1,\cdot,\cdot]" class="ltx_Math" display="inline" id="S3.F2.sf3.6.m1.3"><semantics id="S3.F2.sf3.6.m1.3b"><mrow id="S3.F2.sf3.6.m1.3.4" xref="S3.F2.sf3.6.m1.3.4.cmml"><msub id="S3.F2.sf3.6.m1.3.4.2" xref="S3.F2.sf3.6.m1.3.4.2.cmml"><mi id="S3.F2.sf3.6.m1.3.4.2.2" xref="S3.F2.sf3.6.m1.3.4.2.2.cmml">T</mi><mi id="S3.F2.sf3.6.m1.3.4.2.3" xref="S3.F2.sf3.6.m1.3.4.2.3.cmml">Q</mi></msub><mo id="S3.F2.sf3.6.m1.3.4.1" xref="S3.F2.sf3.6.m1.3.4.1.cmml">⁢</mo><mrow id="S3.F2.sf3.6.m1.3.4.3.2" xref="S3.F2.sf3.6.m1.3.4.3.1.cmml"><mo id="S3.F2.sf3.6.m1.3.4.3.2.1" stretchy="false" xref="S3.F2.sf3.6.m1.3.4.3.1.cmml">[</mo><mn id="S3.F2.sf3.6.m1.1.1" xref="S3.F2.sf3.6.m1.1.1.cmml">1</mn><mo id="S3.F2.sf3.6.m1.3.4.3.2.2" rspace="0em" xref="S3.F2.sf3.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F2.sf3.6.m1.2.2" lspace="0em" rspace="0em" xref="S3.F2.sf3.6.m1.2.2.cmml">⋅</mo><mo id="S3.F2.sf3.6.m1.3.4.3.2.3" rspace="0em" xref="S3.F2.sf3.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F2.sf3.6.m1.3.3" lspace="0em" rspace="0em" xref="S3.F2.sf3.6.m1.3.3.cmml">⋅</mo><mo id="S3.F2.sf3.6.m1.3.4.3.2.4" stretchy="false" xref="S3.F2.sf3.6.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf3.6.m1.3c"><apply id="S3.F2.sf3.6.m1.3.4.cmml" xref="S3.F2.sf3.6.m1.3.4"><times id="S3.F2.sf3.6.m1.3.4.1.cmml" xref="S3.F2.sf3.6.m1.3.4.1"></times><apply id="S3.F2.sf3.6.m1.3.4.2.cmml" xref="S3.F2.sf3.6.m1.3.4.2"><csymbol cd="ambiguous" id="S3.F2.sf3.6.m1.3.4.2.1.cmml" xref="S3.F2.sf3.6.m1.3.4.2">subscript</csymbol><ci id="S3.F2.sf3.6.m1.3.4.2.2.cmml" xref="S3.F2.sf3.6.m1.3.4.2.2">𝑇</ci><ci id="S3.F2.sf3.6.m1.3.4.2.3.cmml" xref="S3.F2.sf3.6.m1.3.4.2.3">𝑄</ci></apply><list id="S3.F2.sf3.6.m1.3.4.3.1.cmml" xref="S3.F2.sf3.6.m1.3.4.3.2"><cn id="S3.F2.sf3.6.m1.1.1.cmml" type="integer" xref="S3.F2.sf3.6.m1.1.1">1</cn><ci id="S3.F2.sf3.6.m1.2.2.cmml" xref="S3.F2.sf3.6.m1.2.2">⋅</ci><ci id="S3.F2.sf3.6.m1.3.3.cmml" xref="S3.F2.sf3.6.m1.3.3">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf3.6.m1.3d">T_{Q}[1,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf3.6.m1.3e">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ 1 , ⋅ , ⋅ ]</annotation></semantics></math> of <math alttext="Q" class="ltx_Math" display="inline" id="S3.F2.sf3.7.m2.1"><semantics id="S3.F2.sf3.7.m2.1b"><mi id="S3.F2.sf3.7.m2.1.1" xref="S3.F2.sf3.7.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.F2.sf3.7.m2.1c"><ci id="S3.F2.sf3.7.m2.1.1.cmml" xref="S3.F2.sf3.7.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf3.7.m2.1d">Q</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf3.7.m2.1e">italic_Q</annotation></semantics></math>, the block <math alttext="T_{K}[1,\cdot,\cdot]^{T}" class="ltx_Math" display="inline" id="S3.F2.sf3.8.m3.3"><semantics id="S3.F2.sf3.8.m3.3b"><mrow id="S3.F2.sf3.8.m3.3.4" xref="S3.F2.sf3.8.m3.3.4.cmml"><msub id="S3.F2.sf3.8.m3.3.4.2" xref="S3.F2.sf3.8.m3.3.4.2.cmml"><mi id="S3.F2.sf3.8.m3.3.4.2.2" xref="S3.F2.sf3.8.m3.3.4.2.2.cmml">T</mi><mi id="S3.F2.sf3.8.m3.3.4.2.3" xref="S3.F2.sf3.8.m3.3.4.2.3.cmml">K</mi></msub><mo id="S3.F2.sf3.8.m3.3.4.1" xref="S3.F2.sf3.8.m3.3.4.1.cmml">⁢</mo><msup id="S3.F2.sf3.8.m3.3.4.3" xref="S3.F2.sf3.8.m3.3.4.3.cmml"><mrow id="S3.F2.sf3.8.m3.3.4.3.2.2" xref="S3.F2.sf3.8.m3.3.4.3.2.1.cmml"><mo id="S3.F2.sf3.8.m3.3.4.3.2.2.1" stretchy="false" xref="S3.F2.sf3.8.m3.3.4.3.2.1.cmml">[</mo><mn id="S3.F2.sf3.8.m3.1.1" xref="S3.F2.sf3.8.m3.1.1.cmml">1</mn><mo id="S3.F2.sf3.8.m3.3.4.3.2.2.2" rspace="0em" xref="S3.F2.sf3.8.m3.3.4.3.2.1.cmml">,</mo><mo id="S3.F2.sf3.8.m3.2.2" lspace="0em" rspace="0em" xref="S3.F2.sf3.8.m3.2.2.cmml">⋅</mo><mo id="S3.F2.sf3.8.m3.3.4.3.2.2.3" rspace="0em" xref="S3.F2.sf3.8.m3.3.4.3.2.1.cmml">,</mo><mo id="S3.F2.sf3.8.m3.3.3" lspace="0em" rspace="0em" xref="S3.F2.sf3.8.m3.3.3.cmml">⋅</mo><mo id="S3.F2.sf3.8.m3.3.4.3.2.2.4" stretchy="false" xref="S3.F2.sf3.8.m3.3.4.3.2.1.cmml">]</mo></mrow><mi id="S3.F2.sf3.8.m3.3.4.3.3" xref="S3.F2.sf3.8.m3.3.4.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf3.8.m3.3c"><apply id="S3.F2.sf3.8.m3.3.4.cmml" xref="S3.F2.sf3.8.m3.3.4"><times id="S3.F2.sf3.8.m3.3.4.1.cmml" xref="S3.F2.sf3.8.m3.3.4.1"></times><apply id="S3.F2.sf3.8.m3.3.4.2.cmml" xref="S3.F2.sf3.8.m3.3.4.2"><csymbol cd="ambiguous" id="S3.F2.sf3.8.m3.3.4.2.1.cmml" xref="S3.F2.sf3.8.m3.3.4.2">subscript</csymbol><ci id="S3.F2.sf3.8.m3.3.4.2.2.cmml" xref="S3.F2.sf3.8.m3.3.4.2.2">𝑇</ci><ci id="S3.F2.sf3.8.m3.3.4.2.3.cmml" xref="S3.F2.sf3.8.m3.3.4.2.3">𝐾</ci></apply><apply id="S3.F2.sf3.8.m3.3.4.3.cmml" xref="S3.F2.sf3.8.m3.3.4.3"><csymbol cd="ambiguous" id="S3.F2.sf3.8.m3.3.4.3.1.cmml" xref="S3.F2.sf3.8.m3.3.4.3">superscript</csymbol><list id="S3.F2.sf3.8.m3.3.4.3.2.1.cmml" xref="S3.F2.sf3.8.m3.3.4.3.2.2"><cn id="S3.F2.sf3.8.m3.1.1.cmml" type="integer" xref="S3.F2.sf3.8.m3.1.1">1</cn><ci id="S3.F2.sf3.8.m3.2.2.cmml" xref="S3.F2.sf3.8.m3.2.2">⋅</ci><ci id="S3.F2.sf3.8.m3.3.3.cmml" xref="S3.F2.sf3.8.m3.3.3">⋅</ci></list><ci id="S3.F2.sf3.8.m3.3.4.3.3.cmml" xref="S3.F2.sf3.8.m3.3.4.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf3.8.m3.3d">T_{K}[1,\cdot,\cdot]^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf3.8.m3.3e">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ 1 , ⋅ , ⋅ ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> of <math alttext="K^{T}" class="ltx_Math" display="inline" id="S3.F2.sf3.9.m4.1"><semantics id="S3.F2.sf3.9.m4.1b"><msup id="S3.F2.sf3.9.m4.1.1" xref="S3.F2.sf3.9.m4.1.1.cmml"><mi id="S3.F2.sf3.9.m4.1.1.2" xref="S3.F2.sf3.9.m4.1.1.2.cmml">K</mi><mi id="S3.F2.sf3.9.m4.1.1.3" xref="S3.F2.sf3.9.m4.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="S3.F2.sf3.9.m4.1c"><apply id="S3.F2.sf3.9.m4.1.1.cmml" xref="S3.F2.sf3.9.m4.1.1"><csymbol cd="ambiguous" id="S3.F2.sf3.9.m4.1.1.1.cmml" xref="S3.F2.sf3.9.m4.1.1">superscript</csymbol><ci id="S3.F2.sf3.9.m4.1.1.2.cmml" xref="S3.F2.sf3.9.m4.1.1.2">𝐾</ci><ci id="S3.F2.sf3.9.m4.1.1.3.cmml" xref="S3.F2.sf3.9.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf3.9.m4.1d">K^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf3.9.m4.1e">italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, and the dot products corresponding to <math alttext="T_{Q}[1,\cdot,\cdot]T_{K}[1,\cdot,\cdot]^{T}" class="ltx_Math" display="inline" id="S3.F2.sf3.10.m5.6"><semantics id="S3.F2.sf3.10.m5.6b"><mrow id="S3.F2.sf3.10.m5.6.7" xref="S3.F2.sf3.10.m5.6.7.cmml"><msub id="S3.F2.sf3.10.m5.6.7.2" xref="S3.F2.sf3.10.m5.6.7.2.cmml"><mi id="S3.F2.sf3.10.m5.6.7.2.2" xref="S3.F2.sf3.10.m5.6.7.2.2.cmml">T</mi><mi id="S3.F2.sf3.10.m5.6.7.2.3" xref="S3.F2.sf3.10.m5.6.7.2.3.cmml">Q</mi></msub><mo id="S3.F2.sf3.10.m5.6.7.1" xref="S3.F2.sf3.10.m5.6.7.1.cmml">⁢</mo><mrow id="S3.F2.sf3.10.m5.6.7.3.2" xref="S3.F2.sf3.10.m5.6.7.3.1.cmml"><mo id="S3.F2.sf3.10.m5.6.7.3.2.1" stretchy="false" xref="S3.F2.sf3.10.m5.6.7.3.1.cmml">[</mo><mn id="S3.F2.sf3.10.m5.1.1" xref="S3.F2.sf3.10.m5.1.1.cmml">1</mn><mo id="S3.F2.sf3.10.m5.6.7.3.2.2" rspace="0em" xref="S3.F2.sf3.10.m5.6.7.3.1.cmml">,</mo><mo id="S3.F2.sf3.10.m5.2.2" lspace="0em" rspace="0em" xref="S3.F2.sf3.10.m5.2.2.cmml">⋅</mo><mo id="S3.F2.sf3.10.m5.6.7.3.2.3" rspace="0em" xref="S3.F2.sf3.10.m5.6.7.3.1.cmml">,</mo><mo id="S3.F2.sf3.10.m5.3.3" lspace="0em" rspace="0em" xref="S3.F2.sf3.10.m5.3.3.cmml">⋅</mo><mo id="S3.F2.sf3.10.m5.6.7.3.2.4" stretchy="false" xref="S3.F2.sf3.10.m5.6.7.3.1.cmml">]</mo></mrow><mo id="S3.F2.sf3.10.m5.6.7.1b" xref="S3.F2.sf3.10.m5.6.7.1.cmml">⁢</mo><msub id="S3.F2.sf3.10.m5.6.7.4" xref="S3.F2.sf3.10.m5.6.7.4.cmml"><mi id="S3.F2.sf3.10.m5.6.7.4.2" xref="S3.F2.sf3.10.m5.6.7.4.2.cmml">T</mi><mi id="S3.F2.sf3.10.m5.6.7.4.3" xref="S3.F2.sf3.10.m5.6.7.4.3.cmml">K</mi></msub><mo id="S3.F2.sf3.10.m5.6.7.1c" xref="S3.F2.sf3.10.m5.6.7.1.cmml">⁢</mo><msup id="S3.F2.sf3.10.m5.6.7.5" xref="S3.F2.sf3.10.m5.6.7.5.cmml"><mrow id="S3.F2.sf3.10.m5.6.7.5.2.2" xref="S3.F2.sf3.10.m5.6.7.5.2.1.cmml"><mo id="S3.F2.sf3.10.m5.6.7.5.2.2.1" stretchy="false" xref="S3.F2.sf3.10.m5.6.7.5.2.1.cmml">[</mo><mn id="S3.F2.sf3.10.m5.4.4" xref="S3.F2.sf3.10.m5.4.4.cmml">1</mn><mo id="S3.F2.sf3.10.m5.6.7.5.2.2.2" rspace="0em" xref="S3.F2.sf3.10.m5.6.7.5.2.1.cmml">,</mo><mo id="S3.F2.sf3.10.m5.5.5" lspace="0em" rspace="0em" xref="S3.F2.sf3.10.m5.5.5.cmml">⋅</mo><mo id="S3.F2.sf3.10.m5.6.7.5.2.2.3" rspace="0em" xref="S3.F2.sf3.10.m5.6.7.5.2.1.cmml">,</mo><mo id="S3.F2.sf3.10.m5.6.6" lspace="0em" rspace="0em" xref="S3.F2.sf3.10.m5.6.6.cmml">⋅</mo><mo id="S3.F2.sf3.10.m5.6.7.5.2.2.4" stretchy="false" xref="S3.F2.sf3.10.m5.6.7.5.2.1.cmml">]</mo></mrow><mi id="S3.F2.sf3.10.m5.6.7.5.3" xref="S3.F2.sf3.10.m5.6.7.5.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf3.10.m5.6c"><apply id="S3.F2.sf3.10.m5.6.7.cmml" xref="S3.F2.sf3.10.m5.6.7"><times id="S3.F2.sf3.10.m5.6.7.1.cmml" xref="S3.F2.sf3.10.m5.6.7.1"></times><apply id="S3.F2.sf3.10.m5.6.7.2.cmml" xref="S3.F2.sf3.10.m5.6.7.2"><csymbol cd="ambiguous" id="S3.F2.sf3.10.m5.6.7.2.1.cmml" xref="S3.F2.sf3.10.m5.6.7.2">subscript</csymbol><ci id="S3.F2.sf3.10.m5.6.7.2.2.cmml" xref="S3.F2.sf3.10.m5.6.7.2.2">𝑇</ci><ci id="S3.F2.sf3.10.m5.6.7.2.3.cmml" xref="S3.F2.sf3.10.m5.6.7.2.3">𝑄</ci></apply><list id="S3.F2.sf3.10.m5.6.7.3.1.cmml" xref="S3.F2.sf3.10.m5.6.7.3.2"><cn id="S3.F2.sf3.10.m5.1.1.cmml" type="integer" xref="S3.F2.sf3.10.m5.1.1">1</cn><ci id="S3.F2.sf3.10.m5.2.2.cmml" xref="S3.F2.sf3.10.m5.2.2">⋅</ci><ci id="S3.F2.sf3.10.m5.3.3.cmml" xref="S3.F2.sf3.10.m5.3.3">⋅</ci></list><apply id="S3.F2.sf3.10.m5.6.7.4.cmml" xref="S3.F2.sf3.10.m5.6.7.4"><csymbol cd="ambiguous" id="S3.F2.sf3.10.m5.6.7.4.1.cmml" xref="S3.F2.sf3.10.m5.6.7.4">subscript</csymbol><ci id="S3.F2.sf3.10.m5.6.7.4.2.cmml" xref="S3.F2.sf3.10.m5.6.7.4.2">𝑇</ci><ci id="S3.F2.sf3.10.m5.6.7.4.3.cmml" xref="S3.F2.sf3.10.m5.6.7.4.3">𝐾</ci></apply><apply id="S3.F2.sf3.10.m5.6.7.5.cmml" xref="S3.F2.sf3.10.m5.6.7.5"><csymbol cd="ambiguous" id="S3.F2.sf3.10.m5.6.7.5.1.cmml" xref="S3.F2.sf3.10.m5.6.7.5">superscript</csymbol><list id="S3.F2.sf3.10.m5.6.7.5.2.1.cmml" xref="S3.F2.sf3.10.m5.6.7.5.2.2"><cn id="S3.F2.sf3.10.m5.4.4.cmml" type="integer" xref="S3.F2.sf3.10.m5.4.4">1</cn><ci id="S3.F2.sf3.10.m5.5.5.cmml" xref="S3.F2.sf3.10.m5.5.5">⋅</ci><ci id="S3.F2.sf3.10.m5.6.6.cmml" xref="S3.F2.sf3.10.m5.6.6">⋅</ci></list><ci id="S3.F2.sf3.10.m5.6.7.5.3.cmml" xref="S3.F2.sf3.10.m5.6.7.5.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf3.10.m5.6d">T_{Q}[1,\cdot,\cdot]T_{K}[1,\cdot,\cdot]^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf3.10.m5.6e">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ 1 , ⋅ , ⋅ ] italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ 1 , ⋅ , ⋅ ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="336" id="S3.F2.sf4.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>In dark brown we have the block <math alttext="T_{Q}[2,\cdot,\cdot]" class="ltx_Math" display="inline" id="S3.F2.sf4.6.m1.3"><semantics id="S3.F2.sf4.6.m1.3b"><mrow id="S3.F2.sf4.6.m1.3.4" xref="S3.F2.sf4.6.m1.3.4.cmml"><msub id="S3.F2.sf4.6.m1.3.4.2" xref="S3.F2.sf4.6.m1.3.4.2.cmml"><mi id="S3.F2.sf4.6.m1.3.4.2.2" xref="S3.F2.sf4.6.m1.3.4.2.2.cmml">T</mi><mi id="S3.F2.sf4.6.m1.3.4.2.3" xref="S3.F2.sf4.6.m1.3.4.2.3.cmml">Q</mi></msub><mo id="S3.F2.sf4.6.m1.3.4.1" xref="S3.F2.sf4.6.m1.3.4.1.cmml">⁢</mo><mrow id="S3.F2.sf4.6.m1.3.4.3.2" xref="S3.F2.sf4.6.m1.3.4.3.1.cmml"><mo id="S3.F2.sf4.6.m1.3.4.3.2.1" stretchy="false" xref="S3.F2.sf4.6.m1.3.4.3.1.cmml">[</mo><mn id="S3.F2.sf4.6.m1.1.1" xref="S3.F2.sf4.6.m1.1.1.cmml">2</mn><mo id="S3.F2.sf4.6.m1.3.4.3.2.2" rspace="0em" xref="S3.F2.sf4.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F2.sf4.6.m1.2.2" lspace="0em" rspace="0em" xref="S3.F2.sf4.6.m1.2.2.cmml">⋅</mo><mo id="S3.F2.sf4.6.m1.3.4.3.2.3" rspace="0em" xref="S3.F2.sf4.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F2.sf4.6.m1.3.3" lspace="0em" rspace="0em" xref="S3.F2.sf4.6.m1.3.3.cmml">⋅</mo><mo id="S3.F2.sf4.6.m1.3.4.3.2.4" stretchy="false" xref="S3.F2.sf4.6.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf4.6.m1.3c"><apply id="S3.F2.sf4.6.m1.3.4.cmml" xref="S3.F2.sf4.6.m1.3.4"><times id="S3.F2.sf4.6.m1.3.4.1.cmml" xref="S3.F2.sf4.6.m1.3.4.1"></times><apply id="S3.F2.sf4.6.m1.3.4.2.cmml" xref="S3.F2.sf4.6.m1.3.4.2"><csymbol cd="ambiguous" id="S3.F2.sf4.6.m1.3.4.2.1.cmml" xref="S3.F2.sf4.6.m1.3.4.2">subscript</csymbol><ci id="S3.F2.sf4.6.m1.3.4.2.2.cmml" xref="S3.F2.sf4.6.m1.3.4.2.2">𝑇</ci><ci id="S3.F2.sf4.6.m1.3.4.2.3.cmml" xref="S3.F2.sf4.6.m1.3.4.2.3">𝑄</ci></apply><list id="S3.F2.sf4.6.m1.3.4.3.1.cmml" xref="S3.F2.sf4.6.m1.3.4.3.2"><cn id="S3.F2.sf4.6.m1.1.1.cmml" type="integer" xref="S3.F2.sf4.6.m1.1.1">2</cn><ci id="S3.F2.sf4.6.m1.2.2.cmml" xref="S3.F2.sf4.6.m1.2.2">⋅</ci><ci id="S3.F2.sf4.6.m1.3.3.cmml" xref="S3.F2.sf4.6.m1.3.3">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf4.6.m1.3d">T_{Q}[2,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf4.6.m1.3e">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ 2 , ⋅ , ⋅ ]</annotation></semantics></math> of <math alttext="Q" class="ltx_Math" display="inline" id="S3.F2.sf4.7.m2.1"><semantics id="S3.F2.sf4.7.m2.1b"><mi id="S3.F2.sf4.7.m2.1.1" xref="S3.F2.sf4.7.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.F2.sf4.7.m2.1c"><ci id="S3.F2.sf4.7.m2.1.1.cmml" xref="S3.F2.sf4.7.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf4.7.m2.1d">Q</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf4.7.m2.1e">italic_Q</annotation></semantics></math>, the block <math alttext="T_{K}[2,\cdot,\cdot]^{T}" class="ltx_Math" display="inline" id="S3.F2.sf4.8.m3.3"><semantics id="S3.F2.sf4.8.m3.3b"><mrow id="S3.F2.sf4.8.m3.3.4" xref="S3.F2.sf4.8.m3.3.4.cmml"><msub id="S3.F2.sf4.8.m3.3.4.2" xref="S3.F2.sf4.8.m3.3.4.2.cmml"><mi id="S3.F2.sf4.8.m3.3.4.2.2" xref="S3.F2.sf4.8.m3.3.4.2.2.cmml">T</mi><mi id="S3.F2.sf4.8.m3.3.4.2.3" xref="S3.F2.sf4.8.m3.3.4.2.3.cmml">K</mi></msub><mo id="S3.F2.sf4.8.m3.3.4.1" xref="S3.F2.sf4.8.m3.3.4.1.cmml">⁢</mo><msup id="S3.F2.sf4.8.m3.3.4.3" xref="S3.F2.sf4.8.m3.3.4.3.cmml"><mrow id="S3.F2.sf4.8.m3.3.4.3.2.2" xref="S3.F2.sf4.8.m3.3.4.3.2.1.cmml"><mo id="S3.F2.sf4.8.m3.3.4.3.2.2.1" stretchy="false" xref="S3.F2.sf4.8.m3.3.4.3.2.1.cmml">[</mo><mn id="S3.F2.sf4.8.m3.1.1" xref="S3.F2.sf4.8.m3.1.1.cmml">2</mn><mo id="S3.F2.sf4.8.m3.3.4.3.2.2.2" rspace="0em" xref="S3.F2.sf4.8.m3.3.4.3.2.1.cmml">,</mo><mo id="S3.F2.sf4.8.m3.2.2" lspace="0em" rspace="0em" xref="S3.F2.sf4.8.m3.2.2.cmml">⋅</mo><mo id="S3.F2.sf4.8.m3.3.4.3.2.2.3" rspace="0em" xref="S3.F2.sf4.8.m3.3.4.3.2.1.cmml">,</mo><mo id="S3.F2.sf4.8.m3.3.3" lspace="0em" rspace="0em" xref="S3.F2.sf4.8.m3.3.3.cmml">⋅</mo><mo id="S3.F2.sf4.8.m3.3.4.3.2.2.4" stretchy="false" xref="S3.F2.sf4.8.m3.3.4.3.2.1.cmml">]</mo></mrow><mi id="S3.F2.sf4.8.m3.3.4.3.3" xref="S3.F2.sf4.8.m3.3.4.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf4.8.m3.3c"><apply id="S3.F2.sf4.8.m3.3.4.cmml" xref="S3.F2.sf4.8.m3.3.4"><times id="S3.F2.sf4.8.m3.3.4.1.cmml" xref="S3.F2.sf4.8.m3.3.4.1"></times><apply id="S3.F2.sf4.8.m3.3.4.2.cmml" xref="S3.F2.sf4.8.m3.3.4.2"><csymbol cd="ambiguous" id="S3.F2.sf4.8.m3.3.4.2.1.cmml" xref="S3.F2.sf4.8.m3.3.4.2">subscript</csymbol><ci id="S3.F2.sf4.8.m3.3.4.2.2.cmml" xref="S3.F2.sf4.8.m3.3.4.2.2">𝑇</ci><ci id="S3.F2.sf4.8.m3.3.4.2.3.cmml" xref="S3.F2.sf4.8.m3.3.4.2.3">𝐾</ci></apply><apply id="S3.F2.sf4.8.m3.3.4.3.cmml" xref="S3.F2.sf4.8.m3.3.4.3"><csymbol cd="ambiguous" id="S3.F2.sf4.8.m3.3.4.3.1.cmml" xref="S3.F2.sf4.8.m3.3.4.3">superscript</csymbol><list id="S3.F2.sf4.8.m3.3.4.3.2.1.cmml" xref="S3.F2.sf4.8.m3.3.4.3.2.2"><cn id="S3.F2.sf4.8.m3.1.1.cmml" type="integer" xref="S3.F2.sf4.8.m3.1.1">2</cn><ci id="S3.F2.sf4.8.m3.2.2.cmml" xref="S3.F2.sf4.8.m3.2.2">⋅</ci><ci id="S3.F2.sf4.8.m3.3.3.cmml" xref="S3.F2.sf4.8.m3.3.3">⋅</ci></list><ci id="S3.F2.sf4.8.m3.3.4.3.3.cmml" xref="S3.F2.sf4.8.m3.3.4.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf4.8.m3.3d">T_{K}[2,\cdot,\cdot]^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf4.8.m3.3e">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ 2 , ⋅ , ⋅ ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> of <math alttext="K^{T}" class="ltx_Math" display="inline" id="S3.F2.sf4.9.m4.1"><semantics id="S3.F2.sf4.9.m4.1b"><msup id="S3.F2.sf4.9.m4.1.1" xref="S3.F2.sf4.9.m4.1.1.cmml"><mi id="S3.F2.sf4.9.m4.1.1.2" xref="S3.F2.sf4.9.m4.1.1.2.cmml">K</mi><mi id="S3.F2.sf4.9.m4.1.1.3" xref="S3.F2.sf4.9.m4.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="S3.F2.sf4.9.m4.1c"><apply id="S3.F2.sf4.9.m4.1.1.cmml" xref="S3.F2.sf4.9.m4.1.1"><csymbol cd="ambiguous" id="S3.F2.sf4.9.m4.1.1.1.cmml" xref="S3.F2.sf4.9.m4.1.1">superscript</csymbol><ci id="S3.F2.sf4.9.m4.1.1.2.cmml" xref="S3.F2.sf4.9.m4.1.1.2">𝐾</ci><ci id="S3.F2.sf4.9.m4.1.1.3.cmml" xref="S3.F2.sf4.9.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf4.9.m4.1d">K^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf4.9.m4.1e">italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, and the dot products corresponding to <math alttext="T_{Q}[2,\cdot,\cdot]T_{K}[2,\cdot,\cdot]^{T}" class="ltx_Math" display="inline" id="S3.F2.sf4.10.m5.6"><semantics id="S3.F2.sf4.10.m5.6b"><mrow id="S3.F2.sf4.10.m5.6.7" xref="S3.F2.sf4.10.m5.6.7.cmml"><msub id="S3.F2.sf4.10.m5.6.7.2" xref="S3.F2.sf4.10.m5.6.7.2.cmml"><mi id="S3.F2.sf4.10.m5.6.7.2.2" xref="S3.F2.sf4.10.m5.6.7.2.2.cmml">T</mi><mi id="S3.F2.sf4.10.m5.6.7.2.3" xref="S3.F2.sf4.10.m5.6.7.2.3.cmml">Q</mi></msub><mo id="S3.F2.sf4.10.m5.6.7.1" xref="S3.F2.sf4.10.m5.6.7.1.cmml">⁢</mo><mrow id="S3.F2.sf4.10.m5.6.7.3.2" xref="S3.F2.sf4.10.m5.6.7.3.1.cmml"><mo id="S3.F2.sf4.10.m5.6.7.3.2.1" stretchy="false" xref="S3.F2.sf4.10.m5.6.7.3.1.cmml">[</mo><mn id="S3.F2.sf4.10.m5.1.1" xref="S3.F2.sf4.10.m5.1.1.cmml">2</mn><mo id="S3.F2.sf4.10.m5.6.7.3.2.2" rspace="0em" xref="S3.F2.sf4.10.m5.6.7.3.1.cmml">,</mo><mo id="S3.F2.sf4.10.m5.2.2" lspace="0em" rspace="0em" xref="S3.F2.sf4.10.m5.2.2.cmml">⋅</mo><mo id="S3.F2.sf4.10.m5.6.7.3.2.3" rspace="0em" xref="S3.F2.sf4.10.m5.6.7.3.1.cmml">,</mo><mo id="S3.F2.sf4.10.m5.3.3" lspace="0em" rspace="0em" xref="S3.F2.sf4.10.m5.3.3.cmml">⋅</mo><mo id="S3.F2.sf4.10.m5.6.7.3.2.4" stretchy="false" xref="S3.F2.sf4.10.m5.6.7.3.1.cmml">]</mo></mrow><mo id="S3.F2.sf4.10.m5.6.7.1b" xref="S3.F2.sf4.10.m5.6.7.1.cmml">⁢</mo><msub id="S3.F2.sf4.10.m5.6.7.4" xref="S3.F2.sf4.10.m5.6.7.4.cmml"><mi id="S3.F2.sf4.10.m5.6.7.4.2" xref="S3.F2.sf4.10.m5.6.7.4.2.cmml">T</mi><mi id="S3.F2.sf4.10.m5.6.7.4.3" xref="S3.F2.sf4.10.m5.6.7.4.3.cmml">K</mi></msub><mo id="S3.F2.sf4.10.m5.6.7.1c" xref="S3.F2.sf4.10.m5.6.7.1.cmml">⁢</mo><msup id="S3.F2.sf4.10.m5.6.7.5" xref="S3.F2.sf4.10.m5.6.7.5.cmml"><mrow id="S3.F2.sf4.10.m5.6.7.5.2.2" xref="S3.F2.sf4.10.m5.6.7.5.2.1.cmml"><mo id="S3.F2.sf4.10.m5.6.7.5.2.2.1" stretchy="false" xref="S3.F2.sf4.10.m5.6.7.5.2.1.cmml">[</mo><mn id="S3.F2.sf4.10.m5.4.4" xref="S3.F2.sf4.10.m5.4.4.cmml">2</mn><mo id="S3.F2.sf4.10.m5.6.7.5.2.2.2" rspace="0em" xref="S3.F2.sf4.10.m5.6.7.5.2.1.cmml">,</mo><mo id="S3.F2.sf4.10.m5.5.5" lspace="0em" rspace="0em" xref="S3.F2.sf4.10.m5.5.5.cmml">⋅</mo><mo id="S3.F2.sf4.10.m5.6.7.5.2.2.3" rspace="0em" xref="S3.F2.sf4.10.m5.6.7.5.2.1.cmml">,</mo><mo id="S3.F2.sf4.10.m5.6.6" lspace="0em" rspace="0em" xref="S3.F2.sf4.10.m5.6.6.cmml">⋅</mo><mo id="S3.F2.sf4.10.m5.6.7.5.2.2.4" stretchy="false" xref="S3.F2.sf4.10.m5.6.7.5.2.1.cmml">]</mo></mrow><mi id="S3.F2.sf4.10.m5.6.7.5.3" xref="S3.F2.sf4.10.m5.6.7.5.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.sf4.10.m5.6c"><apply id="S3.F2.sf4.10.m5.6.7.cmml" xref="S3.F2.sf4.10.m5.6.7"><times id="S3.F2.sf4.10.m5.6.7.1.cmml" xref="S3.F2.sf4.10.m5.6.7.1"></times><apply id="S3.F2.sf4.10.m5.6.7.2.cmml" xref="S3.F2.sf4.10.m5.6.7.2"><csymbol cd="ambiguous" id="S3.F2.sf4.10.m5.6.7.2.1.cmml" xref="S3.F2.sf4.10.m5.6.7.2">subscript</csymbol><ci id="S3.F2.sf4.10.m5.6.7.2.2.cmml" xref="S3.F2.sf4.10.m5.6.7.2.2">𝑇</ci><ci id="S3.F2.sf4.10.m5.6.7.2.3.cmml" xref="S3.F2.sf4.10.m5.6.7.2.3">𝑄</ci></apply><list id="S3.F2.sf4.10.m5.6.7.3.1.cmml" xref="S3.F2.sf4.10.m5.6.7.3.2"><cn id="S3.F2.sf4.10.m5.1.1.cmml" type="integer" xref="S3.F2.sf4.10.m5.1.1">2</cn><ci id="S3.F2.sf4.10.m5.2.2.cmml" xref="S3.F2.sf4.10.m5.2.2">⋅</ci><ci id="S3.F2.sf4.10.m5.3.3.cmml" xref="S3.F2.sf4.10.m5.3.3">⋅</ci></list><apply id="S3.F2.sf4.10.m5.6.7.4.cmml" xref="S3.F2.sf4.10.m5.6.7.4"><csymbol cd="ambiguous" id="S3.F2.sf4.10.m5.6.7.4.1.cmml" xref="S3.F2.sf4.10.m5.6.7.4">subscript</csymbol><ci id="S3.F2.sf4.10.m5.6.7.4.2.cmml" xref="S3.F2.sf4.10.m5.6.7.4.2">𝑇</ci><ci id="S3.F2.sf4.10.m5.6.7.4.3.cmml" xref="S3.F2.sf4.10.m5.6.7.4.3">𝐾</ci></apply><apply id="S3.F2.sf4.10.m5.6.7.5.cmml" xref="S3.F2.sf4.10.m5.6.7.5"><csymbol cd="ambiguous" id="S3.F2.sf4.10.m5.6.7.5.1.cmml" xref="S3.F2.sf4.10.m5.6.7.5">superscript</csymbol><list id="S3.F2.sf4.10.m5.6.7.5.2.1.cmml" xref="S3.F2.sf4.10.m5.6.7.5.2.2"><cn id="S3.F2.sf4.10.m5.4.4.cmml" type="integer" xref="S3.F2.sf4.10.m5.4.4">2</cn><ci id="S3.F2.sf4.10.m5.5.5.cmml" xref="S3.F2.sf4.10.m5.5.5">⋅</ci><ci id="S3.F2.sf4.10.m5.6.6.cmml" xref="S3.F2.sf4.10.m5.6.6">⋅</ci></list><ci id="S3.F2.sf4.10.m5.6.7.5.3.cmml" xref="S3.F2.sf4.10.m5.6.7.5.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.sf4.10.m5.6d">T_{Q}[2,\cdot,\cdot]T_{K}[2,\cdot,\cdot]^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.sf4.10.m5.6e">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ 2 , ⋅ , ⋅ ] italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ 2 , ⋅ , ⋅ ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Example of our algorithm to compute the dot products of <math alttext="QK^{T}" class="ltx_Math" display="inline" id="S3.F2.7.m1.1"><semantics id="S3.F2.7.m1.1b"><mrow id="S3.F2.7.m1.1.1" xref="S3.F2.7.m1.1.1.cmml"><mi id="S3.F2.7.m1.1.1.2" xref="S3.F2.7.m1.1.1.2.cmml">Q</mi><mo id="S3.F2.7.m1.1.1.1" xref="S3.F2.7.m1.1.1.1.cmml">⁢</mo><msup id="S3.F2.7.m1.1.1.3" xref="S3.F2.7.m1.1.1.3.cmml"><mi id="S3.F2.7.m1.1.1.3.2" xref="S3.F2.7.m1.1.1.3.2.cmml">K</mi><mi id="S3.F2.7.m1.1.1.3.3" xref="S3.F2.7.m1.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.7.m1.1c"><apply id="S3.F2.7.m1.1.1.cmml" xref="S3.F2.7.m1.1.1"><times id="S3.F2.7.m1.1.1.1.cmml" xref="S3.F2.7.m1.1.1.1"></times><ci id="S3.F2.7.m1.1.1.2.cmml" xref="S3.F2.7.m1.1.1.2">𝑄</ci><apply id="S3.F2.7.m1.1.1.3.cmml" xref="S3.F2.7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.7.m1.1.1.3.1.cmml" xref="S3.F2.7.m1.1.1.3">superscript</csymbol><ci id="S3.F2.7.m1.1.1.3.2.cmml" xref="S3.F2.7.m1.1.1.3.2">𝐾</ci><ci id="S3.F2.7.m1.1.1.3.3.cmml" xref="S3.F2.7.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.7.m1.1d">QK^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.7.m1.1e">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> needed in LAM for <math alttext="n=6" class="ltx_Math" display="inline" id="S3.F2.8.m2.1"><semantics id="S3.F2.8.m2.1b"><mrow id="S3.F2.8.m2.1.1" xref="S3.F2.8.m2.1.1.cmml"><mi id="S3.F2.8.m2.1.1.2" xref="S3.F2.8.m2.1.1.2.cmml">n</mi><mo id="S3.F2.8.m2.1.1.1" xref="S3.F2.8.m2.1.1.1.cmml">=</mo><mn id="S3.F2.8.m2.1.1.3" xref="S3.F2.8.m2.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.8.m2.1c"><apply id="S3.F2.8.m2.1.1.cmml" xref="S3.F2.8.m2.1.1"><eq id="S3.F2.8.m2.1.1.1.cmml" xref="S3.F2.8.m2.1.1.1"></eq><ci id="S3.F2.8.m2.1.1.2.cmml" xref="S3.F2.8.m2.1.1.2">𝑛</ci><cn id="S3.F2.8.m2.1.1.3.cmml" type="integer" xref="S3.F2.8.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.8.m2.1d">n=6</annotation><annotation encoding="application/x-llamapun" id="S3.F2.8.m2.1e">italic_n = 6</annotation></semantics></math>, <math alttext="d_{q}=3" class="ltx_Math" display="inline" id="S3.F2.9.m3.1"><semantics id="S3.F2.9.m3.1b"><mrow id="S3.F2.9.m3.1.1" xref="S3.F2.9.m3.1.1.cmml"><msub id="S3.F2.9.m3.1.1.2" xref="S3.F2.9.m3.1.1.2.cmml"><mi id="S3.F2.9.m3.1.1.2.2" xref="S3.F2.9.m3.1.1.2.2.cmml">d</mi><mi id="S3.F2.9.m3.1.1.2.3" xref="S3.F2.9.m3.1.1.2.3.cmml">q</mi></msub><mo id="S3.F2.9.m3.1.1.1" xref="S3.F2.9.m3.1.1.1.cmml">=</mo><mn id="S3.F2.9.m3.1.1.3" xref="S3.F2.9.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.9.m3.1c"><apply id="S3.F2.9.m3.1.1.cmml" xref="S3.F2.9.m3.1.1"><eq id="S3.F2.9.m3.1.1.1.cmml" xref="S3.F2.9.m3.1.1.1"></eq><apply id="S3.F2.9.m3.1.1.2.cmml" xref="S3.F2.9.m3.1.1.2"><csymbol cd="ambiguous" id="S3.F2.9.m3.1.1.2.1.cmml" xref="S3.F2.9.m3.1.1.2">subscript</csymbol><ci id="S3.F2.9.m3.1.1.2.2.cmml" xref="S3.F2.9.m3.1.1.2.2">𝑑</ci><ci id="S3.F2.9.m3.1.1.2.3.cmml" xref="S3.F2.9.m3.1.1.2.3">𝑞</ci></apply><cn id="S3.F2.9.m3.1.1.3.cmml" type="integer" xref="S3.F2.9.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.9.m3.1d">d_{q}=3</annotation><annotation encoding="application/x-llamapun" id="S3.F2.9.m3.1e">italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = 3</annotation></semantics></math> and <math alttext="L=2" class="ltx_Math" display="inline" id="S3.F2.10.m4.1"><semantics id="S3.F2.10.m4.1b"><mrow id="S3.F2.10.m4.1.1" xref="S3.F2.10.m4.1.1.cmml"><mi id="S3.F2.10.m4.1.1.2" xref="S3.F2.10.m4.1.1.2.cmml">L</mi><mo id="S3.F2.10.m4.1.1.1" xref="S3.F2.10.m4.1.1.1.cmml">=</mo><mn id="S3.F2.10.m4.1.1.3" xref="S3.F2.10.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.10.m4.1c"><apply id="S3.F2.10.m4.1.1.cmml" xref="S3.F2.10.m4.1.1"><eq id="S3.F2.10.m4.1.1.1.cmml" xref="S3.F2.10.m4.1.1.1"></eq><ci id="S3.F2.10.m4.1.1.2.cmml" xref="S3.F2.10.m4.1.1.2">𝐿</ci><cn id="S3.F2.10.m4.1.1.3.cmml" type="integer" xref="S3.F2.10.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.10.m4.1d">L=2</annotation><annotation encoding="application/x-llamapun" id="S3.F2.10.m4.1e">italic_L = 2</annotation></semantics></math>. We note that <math alttext="s=n/L=3" class="ltx_Math" display="inline" id="S3.F2.11.m5.1"><semantics id="S3.F2.11.m5.1b"><mrow id="S3.F2.11.m5.1.1" xref="S3.F2.11.m5.1.1.cmml"><mi id="S3.F2.11.m5.1.1.2" xref="S3.F2.11.m5.1.1.2.cmml">s</mi><mo id="S3.F2.11.m5.1.1.3" xref="S3.F2.11.m5.1.1.3.cmml">=</mo><mrow id="S3.F2.11.m5.1.1.4" xref="S3.F2.11.m5.1.1.4.cmml"><mi id="S3.F2.11.m5.1.1.4.2" xref="S3.F2.11.m5.1.1.4.2.cmml">n</mi><mo id="S3.F2.11.m5.1.1.4.1" xref="S3.F2.11.m5.1.1.4.1.cmml">/</mo><mi id="S3.F2.11.m5.1.1.4.3" xref="S3.F2.11.m5.1.1.4.3.cmml">L</mi></mrow><mo id="S3.F2.11.m5.1.1.5" xref="S3.F2.11.m5.1.1.5.cmml">=</mo><mn id="S3.F2.11.m5.1.1.6" xref="S3.F2.11.m5.1.1.6.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.11.m5.1c"><apply id="S3.F2.11.m5.1.1.cmml" xref="S3.F2.11.m5.1.1"><and id="S3.F2.11.m5.1.1a.cmml" xref="S3.F2.11.m5.1.1"></and><apply id="S3.F2.11.m5.1.1b.cmml" xref="S3.F2.11.m5.1.1"><eq id="S3.F2.11.m5.1.1.3.cmml" xref="S3.F2.11.m5.1.1.3"></eq><ci id="S3.F2.11.m5.1.1.2.cmml" xref="S3.F2.11.m5.1.1.2">𝑠</ci><apply id="S3.F2.11.m5.1.1.4.cmml" xref="S3.F2.11.m5.1.1.4"><divide id="S3.F2.11.m5.1.1.4.1.cmml" xref="S3.F2.11.m5.1.1.4.1"></divide><ci id="S3.F2.11.m5.1.1.4.2.cmml" xref="S3.F2.11.m5.1.1.4.2">𝑛</ci><ci id="S3.F2.11.m5.1.1.4.3.cmml" xref="S3.F2.11.m5.1.1.4.3">𝐿</ci></apply></apply><apply id="S3.F2.11.m5.1.1c.cmml" xref="S3.F2.11.m5.1.1"><eq id="S3.F2.11.m5.1.1.5.cmml" xref="S3.F2.11.m5.1.1.5"></eq><share href="https://arxiv.org/html/2410.03805v1#S3.F2.11.m5.1.1.4.cmml" id="S3.F2.11.m5.1.1d.cmml" xref="S3.F2.11.m5.1.1"></share><cn id="S3.F2.11.m5.1.1.6.cmml" type="integer" xref="S3.F2.11.m5.1.1.6">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.11.m5.1d">s=n/L=3</annotation><annotation encoding="application/x-llamapun" id="S3.F2.11.m5.1e">italic_s = italic_n / italic_L = 3</annotation></semantics></math>. The dot products needed in LAM are highlighted in green in (a), the dot products computed in our algorithm are highlighted in a shade of brown in <math alttext="QK^{T}" class="ltx_Math" display="inline" id="S3.F2.12.m6.1"><semantics id="S3.F2.12.m6.1b"><mrow id="S3.F2.12.m6.1.1" xref="S3.F2.12.m6.1.1.cmml"><mi id="S3.F2.12.m6.1.1.2" xref="S3.F2.12.m6.1.1.2.cmml">Q</mi><mo id="S3.F2.12.m6.1.1.1" xref="S3.F2.12.m6.1.1.1.cmml">⁢</mo><msup id="S3.F2.12.m6.1.1.3" xref="S3.F2.12.m6.1.1.3.cmml"><mi id="S3.F2.12.m6.1.1.3.2" xref="S3.F2.12.m6.1.1.3.2.cmml">K</mi><mi id="S3.F2.12.m6.1.1.3.3" xref="S3.F2.12.m6.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.12.m6.1c"><apply id="S3.F2.12.m6.1.1.cmml" xref="S3.F2.12.m6.1.1"><times id="S3.F2.12.m6.1.1.1.cmml" xref="S3.F2.12.m6.1.1.1"></times><ci id="S3.F2.12.m6.1.1.2.cmml" xref="S3.F2.12.m6.1.1.2">𝑄</ci><apply id="S3.F2.12.m6.1.1.3.cmml" xref="S3.F2.12.m6.1.1.3"><csymbol cd="ambiguous" id="S3.F2.12.m6.1.1.3.1.cmml" xref="S3.F2.12.m6.1.1.3">superscript</csymbol><ci id="S3.F2.12.m6.1.1.3.2.cmml" xref="S3.F2.12.m6.1.1.3.2">𝐾</ci><ci id="S3.F2.12.m6.1.1.3.3.cmml" xref="S3.F2.12.m6.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.12.m6.1d">QK^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.12.m6.1e">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> in Subfigures (b), (c), (d). We note that every dot product highlighted in green in (a) is in brown in either (b), (c) or (d), as Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm3" title="Lemma 3. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">3</span></a> claims.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p11">
<p class="ltx_p" id="S3.p11.4">At this point we describe how we express <math alttext="\operatorname{softmax}\left((QK^{T}+M)/\sqrt{d_{q}}\right)" class="ltx_Math" display="inline" id="S3.p11.1.m1.2"><semantics id="S3.p11.1.m1.2a"><mrow id="S3.p11.1.m1.2.2.1" xref="S3.p11.1.m1.2.2.2.cmml"><mi id="S3.p11.1.m1.1.1" xref="S3.p11.1.m1.1.1.cmml">softmax</mi><mo id="S3.p11.1.m1.2.2.1a" xref="S3.p11.1.m1.2.2.2.cmml">⁡</mo><mrow id="S3.p11.1.m1.2.2.1.1" xref="S3.p11.1.m1.2.2.2.cmml"><mo id="S3.p11.1.m1.2.2.1.1.2" xref="S3.p11.1.m1.2.2.2.cmml">(</mo><mrow id="S3.p11.1.m1.2.2.1.1.1" xref="S3.p11.1.m1.2.2.1.1.1.cmml"><mrow id="S3.p11.1.m1.2.2.1.1.1.1.1" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.p11.1.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p11.1.m1.2.2.1.1.1.1.1.1" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.2.cmml">Q</mi><mo id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.2" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">K</mi><mi id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.3" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="S3.p11.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.p11.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.3.cmml">M</mi></mrow><mo id="S3.p11.1.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p11.1.m1.2.2.1.1.1.2" xref="S3.p11.1.m1.2.2.1.1.1.2.cmml">/</mo><msqrt id="S3.p11.1.m1.2.2.1.1.1.3" xref="S3.p11.1.m1.2.2.1.1.1.3.cmml"><msub id="S3.p11.1.m1.2.2.1.1.1.3.2" xref="S3.p11.1.m1.2.2.1.1.1.3.2.cmml"><mi id="S3.p11.1.m1.2.2.1.1.1.3.2.2" xref="S3.p11.1.m1.2.2.1.1.1.3.2.2.cmml">d</mi><mi id="S3.p11.1.m1.2.2.1.1.1.3.2.3" xref="S3.p11.1.m1.2.2.1.1.1.3.2.3.cmml">q</mi></msub></msqrt></mrow><mo id="S3.p11.1.m1.2.2.1.1.3" xref="S3.p11.1.m1.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p11.1.m1.2b"><apply id="S3.p11.1.m1.2.2.2.cmml" xref="S3.p11.1.m1.2.2.1"><ci id="S3.p11.1.m1.1.1.cmml" xref="S3.p11.1.m1.1.1">softmax</ci><apply id="S3.p11.1.m1.2.2.1.1.1.cmml" xref="S3.p11.1.m1.2.2.1.1.1"><divide id="S3.p11.1.m1.2.2.1.1.1.2.cmml" xref="S3.p11.1.m1.2.2.1.1.1.2"></divide><apply id="S3.p11.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.p11.1.m1.2.2.1.1.1.1.1"><plus id="S3.p11.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2"><times id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.1"></times><ci id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.2">𝑄</ci><apply id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.2">𝐾</ci><ci id="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S3.p11.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.p11.1.m1.2.2.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.p11.1.m1.2.2.1.1.1.3.cmml" xref="S3.p11.1.m1.2.2.1.1.1.3"><root id="S3.p11.1.m1.2.2.1.1.1.3a.cmml" xref="S3.p11.1.m1.2.2.1.1.1.3"></root><apply id="S3.p11.1.m1.2.2.1.1.1.3.2.cmml" xref="S3.p11.1.m1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p11.1.m1.2.2.1.1.1.3.2.1.cmml" xref="S3.p11.1.m1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S3.p11.1.m1.2.2.1.1.1.3.2.2.cmml" xref="S3.p11.1.m1.2.2.1.1.1.3.2.2">𝑑</ci><ci id="S3.p11.1.m1.2.2.1.1.1.3.2.3.cmml" xref="S3.p11.1.m1.2.2.1.1.1.3.2.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p11.1.m1.2c">\operatorname{softmax}\left((QK^{T}+M)/\sqrt{d_{q}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.p11.1.m1.2d">roman_softmax ( ( italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_M ) / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math> in terms of <math alttext="T_{A}[r,\cdot,\cdot]=T_{Q}[r,\cdot,\cdot]T_{K}[r,\cdot,\cdot]^{T}" class="ltx_Math" display="inline" id="S3.p11.2.m2.9"><semantics id="S3.p11.2.m2.9a"><mrow id="S3.p11.2.m2.9.10" xref="S3.p11.2.m2.9.10.cmml"><mrow id="S3.p11.2.m2.9.10.2" xref="S3.p11.2.m2.9.10.2.cmml"><msub id="S3.p11.2.m2.9.10.2.2" xref="S3.p11.2.m2.9.10.2.2.cmml"><mi id="S3.p11.2.m2.9.10.2.2.2" xref="S3.p11.2.m2.9.10.2.2.2.cmml">T</mi><mi id="S3.p11.2.m2.9.10.2.2.3" xref="S3.p11.2.m2.9.10.2.2.3.cmml">A</mi></msub><mo id="S3.p11.2.m2.9.10.2.1" xref="S3.p11.2.m2.9.10.2.1.cmml">⁢</mo><mrow id="S3.p11.2.m2.9.10.2.3.2" xref="S3.p11.2.m2.9.10.2.3.1.cmml"><mo id="S3.p11.2.m2.9.10.2.3.2.1" stretchy="false" xref="S3.p11.2.m2.9.10.2.3.1.cmml">[</mo><mi id="S3.p11.2.m2.1.1" xref="S3.p11.2.m2.1.1.cmml">r</mi><mo id="S3.p11.2.m2.9.10.2.3.2.2" rspace="0em" xref="S3.p11.2.m2.9.10.2.3.1.cmml">,</mo><mo id="S3.p11.2.m2.2.2" lspace="0em" rspace="0em" xref="S3.p11.2.m2.2.2.cmml">⋅</mo><mo id="S3.p11.2.m2.9.10.2.3.2.3" rspace="0em" xref="S3.p11.2.m2.9.10.2.3.1.cmml">,</mo><mo id="S3.p11.2.m2.3.3" lspace="0em" rspace="0em" xref="S3.p11.2.m2.3.3.cmml">⋅</mo><mo id="S3.p11.2.m2.9.10.2.3.2.4" stretchy="false" xref="S3.p11.2.m2.9.10.2.3.1.cmml">]</mo></mrow></mrow><mo id="S3.p11.2.m2.9.10.1" xref="S3.p11.2.m2.9.10.1.cmml">=</mo><mrow id="S3.p11.2.m2.9.10.3" xref="S3.p11.2.m2.9.10.3.cmml"><msub id="S3.p11.2.m2.9.10.3.2" xref="S3.p11.2.m2.9.10.3.2.cmml"><mi id="S3.p11.2.m2.9.10.3.2.2" xref="S3.p11.2.m2.9.10.3.2.2.cmml">T</mi><mi id="S3.p11.2.m2.9.10.3.2.3" xref="S3.p11.2.m2.9.10.3.2.3.cmml">Q</mi></msub><mo id="S3.p11.2.m2.9.10.3.1" xref="S3.p11.2.m2.9.10.3.1.cmml">⁢</mo><mrow id="S3.p11.2.m2.9.10.3.3.2" xref="S3.p11.2.m2.9.10.3.3.1.cmml"><mo id="S3.p11.2.m2.9.10.3.3.2.1" stretchy="false" xref="S3.p11.2.m2.9.10.3.3.1.cmml">[</mo><mi id="S3.p11.2.m2.4.4" xref="S3.p11.2.m2.4.4.cmml">r</mi><mo id="S3.p11.2.m2.9.10.3.3.2.2" rspace="0em" xref="S3.p11.2.m2.9.10.3.3.1.cmml">,</mo><mo id="S3.p11.2.m2.5.5" lspace="0em" rspace="0em" xref="S3.p11.2.m2.5.5.cmml">⋅</mo><mo id="S3.p11.2.m2.9.10.3.3.2.3" rspace="0em" xref="S3.p11.2.m2.9.10.3.3.1.cmml">,</mo><mo id="S3.p11.2.m2.6.6" lspace="0em" rspace="0em" xref="S3.p11.2.m2.6.6.cmml">⋅</mo><mo id="S3.p11.2.m2.9.10.3.3.2.4" stretchy="false" xref="S3.p11.2.m2.9.10.3.3.1.cmml">]</mo></mrow><mo id="S3.p11.2.m2.9.10.3.1a" xref="S3.p11.2.m2.9.10.3.1.cmml">⁢</mo><msub id="S3.p11.2.m2.9.10.3.4" xref="S3.p11.2.m2.9.10.3.4.cmml"><mi id="S3.p11.2.m2.9.10.3.4.2" xref="S3.p11.2.m2.9.10.3.4.2.cmml">T</mi><mi id="S3.p11.2.m2.9.10.3.4.3" xref="S3.p11.2.m2.9.10.3.4.3.cmml">K</mi></msub><mo id="S3.p11.2.m2.9.10.3.1b" xref="S3.p11.2.m2.9.10.3.1.cmml">⁢</mo><msup id="S3.p11.2.m2.9.10.3.5" xref="S3.p11.2.m2.9.10.3.5.cmml"><mrow id="S3.p11.2.m2.9.10.3.5.2.2" xref="S3.p11.2.m2.9.10.3.5.2.1.cmml"><mo id="S3.p11.2.m2.9.10.3.5.2.2.1" stretchy="false" xref="S3.p11.2.m2.9.10.3.5.2.1.cmml">[</mo><mi id="S3.p11.2.m2.7.7" xref="S3.p11.2.m2.7.7.cmml">r</mi><mo id="S3.p11.2.m2.9.10.3.5.2.2.2" rspace="0em" xref="S3.p11.2.m2.9.10.3.5.2.1.cmml">,</mo><mo id="S3.p11.2.m2.8.8" lspace="0em" rspace="0em" xref="S3.p11.2.m2.8.8.cmml">⋅</mo><mo id="S3.p11.2.m2.9.10.3.5.2.2.3" rspace="0em" xref="S3.p11.2.m2.9.10.3.5.2.1.cmml">,</mo><mo id="S3.p11.2.m2.9.9" lspace="0em" rspace="0em" xref="S3.p11.2.m2.9.9.cmml">⋅</mo><mo id="S3.p11.2.m2.9.10.3.5.2.2.4" stretchy="false" xref="S3.p11.2.m2.9.10.3.5.2.1.cmml">]</mo></mrow><mi id="S3.p11.2.m2.9.10.3.5.3" xref="S3.p11.2.m2.9.10.3.5.3.cmml">T</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p11.2.m2.9b"><apply id="S3.p11.2.m2.9.10.cmml" xref="S3.p11.2.m2.9.10"><eq id="S3.p11.2.m2.9.10.1.cmml" xref="S3.p11.2.m2.9.10.1"></eq><apply id="S3.p11.2.m2.9.10.2.cmml" xref="S3.p11.2.m2.9.10.2"><times id="S3.p11.2.m2.9.10.2.1.cmml" xref="S3.p11.2.m2.9.10.2.1"></times><apply id="S3.p11.2.m2.9.10.2.2.cmml" xref="S3.p11.2.m2.9.10.2.2"><csymbol cd="ambiguous" id="S3.p11.2.m2.9.10.2.2.1.cmml" xref="S3.p11.2.m2.9.10.2.2">subscript</csymbol><ci id="S3.p11.2.m2.9.10.2.2.2.cmml" xref="S3.p11.2.m2.9.10.2.2.2">𝑇</ci><ci id="S3.p11.2.m2.9.10.2.2.3.cmml" xref="S3.p11.2.m2.9.10.2.2.3">𝐴</ci></apply><list id="S3.p11.2.m2.9.10.2.3.1.cmml" xref="S3.p11.2.m2.9.10.2.3.2"><ci id="S3.p11.2.m2.1.1.cmml" xref="S3.p11.2.m2.1.1">𝑟</ci><ci id="S3.p11.2.m2.2.2.cmml" xref="S3.p11.2.m2.2.2">⋅</ci><ci id="S3.p11.2.m2.3.3.cmml" xref="S3.p11.2.m2.3.3">⋅</ci></list></apply><apply id="S3.p11.2.m2.9.10.3.cmml" xref="S3.p11.2.m2.9.10.3"><times id="S3.p11.2.m2.9.10.3.1.cmml" xref="S3.p11.2.m2.9.10.3.1"></times><apply id="S3.p11.2.m2.9.10.3.2.cmml" xref="S3.p11.2.m2.9.10.3.2"><csymbol cd="ambiguous" id="S3.p11.2.m2.9.10.3.2.1.cmml" xref="S3.p11.2.m2.9.10.3.2">subscript</csymbol><ci id="S3.p11.2.m2.9.10.3.2.2.cmml" xref="S3.p11.2.m2.9.10.3.2.2">𝑇</ci><ci id="S3.p11.2.m2.9.10.3.2.3.cmml" xref="S3.p11.2.m2.9.10.3.2.3">𝑄</ci></apply><list id="S3.p11.2.m2.9.10.3.3.1.cmml" xref="S3.p11.2.m2.9.10.3.3.2"><ci id="S3.p11.2.m2.4.4.cmml" xref="S3.p11.2.m2.4.4">𝑟</ci><ci id="S3.p11.2.m2.5.5.cmml" xref="S3.p11.2.m2.5.5">⋅</ci><ci id="S3.p11.2.m2.6.6.cmml" xref="S3.p11.2.m2.6.6">⋅</ci></list><apply id="S3.p11.2.m2.9.10.3.4.cmml" xref="S3.p11.2.m2.9.10.3.4"><csymbol cd="ambiguous" id="S3.p11.2.m2.9.10.3.4.1.cmml" xref="S3.p11.2.m2.9.10.3.4">subscript</csymbol><ci id="S3.p11.2.m2.9.10.3.4.2.cmml" xref="S3.p11.2.m2.9.10.3.4.2">𝑇</ci><ci id="S3.p11.2.m2.9.10.3.4.3.cmml" xref="S3.p11.2.m2.9.10.3.4.3">𝐾</ci></apply><apply id="S3.p11.2.m2.9.10.3.5.cmml" xref="S3.p11.2.m2.9.10.3.5"><csymbol cd="ambiguous" id="S3.p11.2.m2.9.10.3.5.1.cmml" xref="S3.p11.2.m2.9.10.3.5">superscript</csymbol><list id="S3.p11.2.m2.9.10.3.5.2.1.cmml" xref="S3.p11.2.m2.9.10.3.5.2.2"><ci id="S3.p11.2.m2.7.7.cmml" xref="S3.p11.2.m2.7.7">𝑟</ci><ci id="S3.p11.2.m2.8.8.cmml" xref="S3.p11.2.m2.8.8">⋅</ci><ci id="S3.p11.2.m2.9.9.cmml" xref="S3.p11.2.m2.9.9">⋅</ci></list><ci id="S3.p11.2.m2.9.10.3.5.3.cmml" xref="S3.p11.2.m2.9.10.3.5.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p11.2.m2.9c">T_{A}[r,\cdot,\cdot]=T_{Q}[r,\cdot,\cdot]T_{K}[r,\cdot,\cdot]^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p11.2.m2.9d">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ] = italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ] italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>. First, we mask the undesired dot products using a tensor of dimension <math alttext="s\times L\times(2L-2)" class="ltx_Math" display="inline" id="S3.p11.3.m3.1"><semantics id="S3.p11.3.m3.1a"><mrow id="S3.p11.3.m3.1.1" xref="S3.p11.3.m3.1.1.cmml"><mi id="S3.p11.3.m3.1.1.3" xref="S3.p11.3.m3.1.1.3.cmml">s</mi><mo id="S3.p11.3.m3.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.p11.3.m3.1.1.2.cmml">×</mo><mi id="S3.p11.3.m3.1.1.4" xref="S3.p11.3.m3.1.1.4.cmml">L</mi><mo id="S3.p11.3.m3.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.p11.3.m3.1.1.2.cmml">×</mo><mrow id="S3.p11.3.m3.1.1.1.1" xref="S3.p11.3.m3.1.1.1.1.1.cmml"><mo id="S3.p11.3.m3.1.1.1.1.2" stretchy="false" xref="S3.p11.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.p11.3.m3.1.1.1.1.1" xref="S3.p11.3.m3.1.1.1.1.1.cmml"><mrow id="S3.p11.3.m3.1.1.1.1.1.2" xref="S3.p11.3.m3.1.1.1.1.1.2.cmml"><mn id="S3.p11.3.m3.1.1.1.1.1.2.2" xref="S3.p11.3.m3.1.1.1.1.1.2.2.cmml">2</mn><mo id="S3.p11.3.m3.1.1.1.1.1.2.1" xref="S3.p11.3.m3.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.p11.3.m3.1.1.1.1.1.2.3" xref="S3.p11.3.m3.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.p11.3.m3.1.1.1.1.1.1" xref="S3.p11.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="S3.p11.3.m3.1.1.1.1.1.3" xref="S3.p11.3.m3.1.1.1.1.1.3.cmml">2</mn></mrow><mo id="S3.p11.3.m3.1.1.1.1.3" stretchy="false" xref="S3.p11.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p11.3.m3.1b"><apply id="S3.p11.3.m3.1.1.cmml" xref="S3.p11.3.m3.1.1"><times id="S3.p11.3.m3.1.1.2.cmml" xref="S3.p11.3.m3.1.1.2"></times><ci id="S3.p11.3.m3.1.1.3.cmml" xref="S3.p11.3.m3.1.1.3">𝑠</ci><ci id="S3.p11.3.m3.1.1.4.cmml" xref="S3.p11.3.m3.1.1.4">𝐿</ci><apply id="S3.p11.3.m3.1.1.1.1.1.cmml" xref="S3.p11.3.m3.1.1.1.1"><minus id="S3.p11.3.m3.1.1.1.1.1.1.cmml" xref="S3.p11.3.m3.1.1.1.1.1.1"></minus><apply id="S3.p11.3.m3.1.1.1.1.1.2.cmml" xref="S3.p11.3.m3.1.1.1.1.1.2"><times id="S3.p11.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.p11.3.m3.1.1.1.1.1.2.1"></times><cn id="S3.p11.3.m3.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.p11.3.m3.1.1.1.1.1.2.2">2</cn><ci id="S3.p11.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.p11.3.m3.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="S3.p11.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S3.p11.3.m3.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p11.3.m3.1c">s\times L\times(2L-2)</annotation><annotation encoding="application/x-llamapun" id="S3.p11.3.m3.1d">italic_s × italic_L × ( 2 italic_L - 2 )</annotation></semantics></math> that emulates the matrix <math alttext="M" class="ltx_Math" display="inline" id="S3.p11.4.m4.1"><semantics id="S3.p11.4.m4.1a"><mi id="S3.p11.4.m4.1.1" xref="S3.p11.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p11.4.m4.1b"><ci id="S3.p11.4.m4.1.1.cmml" xref="S3.p11.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p11.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p11.4.m4.1d">italic_M</annotation></semantics></math> of Definition <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmdefinition1" title="Definition 1 (Local Attention). ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition4">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdefinition4.2.1.1">Definition 4</span></span><span class="ltx_text ltx_font_bold" id="Thmdefinition4.3.2"> </span>(The tensor <math alttext="T_{M}" class="ltx_Math" display="inline" id="Thmdefinition4.1.m1.1"><semantics id="Thmdefinition4.1.m1.1b"><msub id="Thmdefinition4.1.m1.1.1" xref="Thmdefinition4.1.m1.1.1.cmml"><mi id="Thmdefinition4.1.m1.1.1.2" xref="Thmdefinition4.1.m1.1.1.2.cmml">T</mi><mi id="Thmdefinition4.1.m1.1.1.3" xref="Thmdefinition4.1.m1.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition4.1.m1.1c"><apply id="Thmdefinition4.1.m1.1.1.cmml" xref="Thmdefinition4.1.m1.1.1"><csymbol cd="ambiguous" id="Thmdefinition4.1.m1.1.1.1.cmml" xref="Thmdefinition4.1.m1.1.1">subscript</csymbol><ci id="Thmdefinition4.1.m1.1.1.2.cmml" xref="Thmdefinition4.1.m1.1.1.2">𝑇</ci><ci id="Thmdefinition4.1.m1.1.1.3.cmml" xref="Thmdefinition4.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition4.1.m1.1d">T_{M}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition4.1.m1.1e">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math>)<span class="ltx_text ltx_font_bold" id="Thmdefinition4.4.3">.</span>
</h6>
<div class="ltx_para" id="Thmdefinition4.p1">
<p class="ltx_p" id="Thmdefinition4.p1.6"><span class="ltx_text ltx_font_italic" id="Thmdefinition4.p1.6.6">Let <math alttext="s=n/L" class="ltx_Math" display="inline" id="Thmdefinition4.p1.1.1.m1.1"><semantics id="Thmdefinition4.p1.1.1.m1.1a"><mrow id="Thmdefinition4.p1.1.1.m1.1.1" xref="Thmdefinition4.p1.1.1.m1.1.1.cmml"><mi id="Thmdefinition4.p1.1.1.m1.1.1.2" xref="Thmdefinition4.p1.1.1.m1.1.1.2.cmml">s</mi><mo id="Thmdefinition4.p1.1.1.m1.1.1.1" xref="Thmdefinition4.p1.1.1.m1.1.1.1.cmml">=</mo><mrow id="Thmdefinition4.p1.1.1.m1.1.1.3" xref="Thmdefinition4.p1.1.1.m1.1.1.3.cmml"><mi id="Thmdefinition4.p1.1.1.m1.1.1.3.2" xref="Thmdefinition4.p1.1.1.m1.1.1.3.2.cmml">n</mi><mo id="Thmdefinition4.p1.1.1.m1.1.1.3.1" xref="Thmdefinition4.p1.1.1.m1.1.1.3.1.cmml">/</mo><mi id="Thmdefinition4.p1.1.1.m1.1.1.3.3" xref="Thmdefinition4.p1.1.1.m1.1.1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition4.p1.1.1.m1.1b"><apply id="Thmdefinition4.p1.1.1.m1.1.1.cmml" xref="Thmdefinition4.p1.1.1.m1.1.1"><eq id="Thmdefinition4.p1.1.1.m1.1.1.1.cmml" xref="Thmdefinition4.p1.1.1.m1.1.1.1"></eq><ci id="Thmdefinition4.p1.1.1.m1.1.1.2.cmml" xref="Thmdefinition4.p1.1.1.m1.1.1.2">𝑠</ci><apply id="Thmdefinition4.p1.1.1.m1.1.1.3.cmml" xref="Thmdefinition4.p1.1.1.m1.1.1.3"><divide id="Thmdefinition4.p1.1.1.m1.1.1.3.1.cmml" xref="Thmdefinition4.p1.1.1.m1.1.1.3.1"></divide><ci id="Thmdefinition4.p1.1.1.m1.1.1.3.2.cmml" xref="Thmdefinition4.p1.1.1.m1.1.1.3.2">𝑛</ci><ci id="Thmdefinition4.p1.1.1.m1.1.1.3.3.cmml" xref="Thmdefinition4.p1.1.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition4.p1.1.1.m1.1c">s=n/L</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition4.p1.1.1.m1.1d">italic_s = italic_n / italic_L</annotation></semantics></math>. We define <math alttext="T_{M}" class="ltx_Math" display="inline" id="Thmdefinition4.p1.2.2.m2.1"><semantics id="Thmdefinition4.p1.2.2.m2.1a"><msub id="Thmdefinition4.p1.2.2.m2.1.1" xref="Thmdefinition4.p1.2.2.m2.1.1.cmml"><mi id="Thmdefinition4.p1.2.2.m2.1.1.2" xref="Thmdefinition4.p1.2.2.m2.1.1.2.cmml">T</mi><mi id="Thmdefinition4.p1.2.2.m2.1.1.3" xref="Thmdefinition4.p1.2.2.m2.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition4.p1.2.2.m2.1b"><apply id="Thmdefinition4.p1.2.2.m2.1.1.cmml" xref="Thmdefinition4.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmdefinition4.p1.2.2.m2.1.1.1.cmml" xref="Thmdefinition4.p1.2.2.m2.1.1">subscript</csymbol><ci id="Thmdefinition4.p1.2.2.m2.1.1.2.cmml" xref="Thmdefinition4.p1.2.2.m2.1.1.2">𝑇</ci><ci id="Thmdefinition4.p1.2.2.m2.1.1.3.cmml" xref="Thmdefinition4.p1.2.2.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition4.p1.2.2.m2.1c">T_{M}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition4.p1.2.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> as the tensor with dimension <math alttext="s\times L\times(2L-2)" class="ltx_Math" display="inline" id="Thmdefinition4.p1.3.3.m3.1"><semantics id="Thmdefinition4.p1.3.3.m3.1a"><mrow id="Thmdefinition4.p1.3.3.m3.1.1" xref="Thmdefinition4.p1.3.3.m3.1.1.cmml"><mi id="Thmdefinition4.p1.3.3.m3.1.1.3" xref="Thmdefinition4.p1.3.3.m3.1.1.3.cmml">s</mi><mo id="Thmdefinition4.p1.3.3.m3.1.1.2" lspace="0.222em" rspace="0.222em" xref="Thmdefinition4.p1.3.3.m3.1.1.2.cmml">×</mo><mi id="Thmdefinition4.p1.3.3.m3.1.1.4" xref="Thmdefinition4.p1.3.3.m3.1.1.4.cmml">L</mi><mo id="Thmdefinition4.p1.3.3.m3.1.1.2a" lspace="0.222em" rspace="0.222em" xref="Thmdefinition4.p1.3.3.m3.1.1.2.cmml">×</mo><mrow id="Thmdefinition4.p1.3.3.m3.1.1.1.1" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.cmml"><mo id="Thmdefinition4.p1.3.3.m3.1.1.1.1.2" stretchy="false" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.cmml"><mrow id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.cmml"><mn id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.2" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.2.cmml">2</mn><mo id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.1" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.3" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.1" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.3" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.3.cmml">2</mn></mrow><mo id="Thmdefinition4.p1.3.3.m3.1.1.1.1.3" stretchy="false" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition4.p1.3.3.m3.1b"><apply id="Thmdefinition4.p1.3.3.m3.1.1.cmml" xref="Thmdefinition4.p1.3.3.m3.1.1"><times id="Thmdefinition4.p1.3.3.m3.1.1.2.cmml" xref="Thmdefinition4.p1.3.3.m3.1.1.2"></times><ci id="Thmdefinition4.p1.3.3.m3.1.1.3.cmml" xref="Thmdefinition4.p1.3.3.m3.1.1.3">𝑠</ci><ci id="Thmdefinition4.p1.3.3.m3.1.1.4.cmml" xref="Thmdefinition4.p1.3.3.m3.1.1.4">𝐿</ci><apply id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.cmml" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1"><minus id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.1"></minus><apply id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2"><times id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.1.cmml" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.1"></times><cn id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.2.cmml" type="integer" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.2">2</cn><ci id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.3.cmml" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition4.p1.3.3.m3.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition4.p1.3.3.m3.1c">s\times L\times(2L-2)</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition4.p1.3.3.m3.1d">italic_s × italic_L × ( 2 italic_L - 2 )</annotation></semantics></math> such that <math alttext="T_{M}[r,i_{1},j_{1}]=0" class="ltx_Math" display="inline" id="Thmdefinition4.p1.4.4.m4.3"><semantics id="Thmdefinition4.p1.4.4.m4.3a"><mrow id="Thmdefinition4.p1.4.4.m4.3.3" xref="Thmdefinition4.p1.4.4.m4.3.3.cmml"><mrow id="Thmdefinition4.p1.4.4.m4.3.3.2" xref="Thmdefinition4.p1.4.4.m4.3.3.2.cmml"><msub id="Thmdefinition4.p1.4.4.m4.3.3.2.4" xref="Thmdefinition4.p1.4.4.m4.3.3.2.4.cmml"><mi id="Thmdefinition4.p1.4.4.m4.3.3.2.4.2" xref="Thmdefinition4.p1.4.4.m4.3.3.2.4.2.cmml">T</mi><mi id="Thmdefinition4.p1.4.4.m4.3.3.2.4.3" xref="Thmdefinition4.p1.4.4.m4.3.3.2.4.3.cmml">M</mi></msub><mo id="Thmdefinition4.p1.4.4.m4.3.3.2.3" xref="Thmdefinition4.p1.4.4.m4.3.3.2.3.cmml">⁢</mo><mrow id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.3.cmml"><mo id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.3" stretchy="false" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.3.cmml">[</mo><mi id="Thmdefinition4.p1.4.4.m4.1.1" xref="Thmdefinition4.p1.4.4.m4.1.1.cmml">r</mi><mo id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.4" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.3.cmml">,</mo><msub id="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1" xref="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.cmml"><mi id="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.2" xref="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.2.cmml">i</mi><mn id="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.3" xref="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.5" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.3.cmml">,</mo><msub id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.cmml"><mi id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.2" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.2.cmml">j</mi><mn id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.3" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.3.cmml">1</mn></msub><mo id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.6" stretchy="false" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.3.cmml">]</mo></mrow></mrow><mo id="Thmdefinition4.p1.4.4.m4.3.3.3" xref="Thmdefinition4.p1.4.4.m4.3.3.3.cmml">=</mo><mn id="Thmdefinition4.p1.4.4.m4.3.3.4" xref="Thmdefinition4.p1.4.4.m4.3.3.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition4.p1.4.4.m4.3b"><apply id="Thmdefinition4.p1.4.4.m4.3.3.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3"><eq id="Thmdefinition4.p1.4.4.m4.3.3.3.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.3"></eq><apply id="Thmdefinition4.p1.4.4.m4.3.3.2.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.2"><times id="Thmdefinition4.p1.4.4.m4.3.3.2.3.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.2.3"></times><apply id="Thmdefinition4.p1.4.4.m4.3.3.2.4.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.2.4"><csymbol cd="ambiguous" id="Thmdefinition4.p1.4.4.m4.3.3.2.4.1.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.2.4">subscript</csymbol><ci id="Thmdefinition4.p1.4.4.m4.3.3.2.4.2.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.2.4.2">𝑇</ci><ci id="Thmdefinition4.p1.4.4.m4.3.3.2.4.3.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.2.4.3">𝑀</ci></apply><list id="Thmdefinition4.p1.4.4.m4.3.3.2.2.3.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.2"><ci id="Thmdefinition4.p1.4.4.m4.1.1.cmml" xref="Thmdefinition4.p1.4.4.m4.1.1">𝑟</ci><apply id="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.cmml" xref="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.1.cmml" xref="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1">subscript</csymbol><ci id="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.2.cmml" xref="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.2">𝑖</ci><cn id="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition4.p1.4.4.m4.2.2.1.1.1.1.3">1</cn></apply><apply id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2"><csymbol cd="ambiguous" id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.1.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2">subscript</csymbol><ci id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.2.cmml" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.2">𝑗</ci><cn id="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.3.cmml" type="integer" xref="Thmdefinition4.p1.4.4.m4.3.3.2.2.2.2.3">1</cn></apply></list></apply><cn id="Thmdefinition4.p1.4.4.m4.3.3.4.cmml" type="integer" xref="Thmdefinition4.p1.4.4.m4.3.3.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition4.p1.4.4.m4.3c">T_{M}[r,i_{1},j_{1}]=0</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition4.p1.4.4.m4.3d">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = 0</annotation></semantics></math> when <math alttext="i_{1}\leq j_{1}\leq i_{1}+L-1" class="ltx_Math" display="inline" id="Thmdefinition4.p1.5.5.m5.1"><semantics id="Thmdefinition4.p1.5.5.m5.1a"><mrow id="Thmdefinition4.p1.5.5.m5.1.1" xref="Thmdefinition4.p1.5.5.m5.1.1.cmml"><msub id="Thmdefinition4.p1.5.5.m5.1.1.2" xref="Thmdefinition4.p1.5.5.m5.1.1.2.cmml"><mi id="Thmdefinition4.p1.5.5.m5.1.1.2.2" xref="Thmdefinition4.p1.5.5.m5.1.1.2.2.cmml">i</mi><mn id="Thmdefinition4.p1.5.5.m5.1.1.2.3" xref="Thmdefinition4.p1.5.5.m5.1.1.2.3.cmml">1</mn></msub><mo id="Thmdefinition4.p1.5.5.m5.1.1.3" xref="Thmdefinition4.p1.5.5.m5.1.1.3.cmml">≤</mo><msub id="Thmdefinition4.p1.5.5.m5.1.1.4" xref="Thmdefinition4.p1.5.5.m5.1.1.4.cmml"><mi id="Thmdefinition4.p1.5.5.m5.1.1.4.2" xref="Thmdefinition4.p1.5.5.m5.1.1.4.2.cmml">j</mi><mn id="Thmdefinition4.p1.5.5.m5.1.1.4.3" xref="Thmdefinition4.p1.5.5.m5.1.1.4.3.cmml">1</mn></msub><mo id="Thmdefinition4.p1.5.5.m5.1.1.5" xref="Thmdefinition4.p1.5.5.m5.1.1.5.cmml">≤</mo><mrow id="Thmdefinition4.p1.5.5.m5.1.1.6" xref="Thmdefinition4.p1.5.5.m5.1.1.6.cmml"><mrow id="Thmdefinition4.p1.5.5.m5.1.1.6.2" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.cmml"><msub id="Thmdefinition4.p1.5.5.m5.1.1.6.2.2" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.cmml"><mi id="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.2" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.2.cmml">i</mi><mn id="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.3" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.3.cmml">1</mn></msub><mo id="Thmdefinition4.p1.5.5.m5.1.1.6.2.1" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.1.cmml">+</mo><mi id="Thmdefinition4.p1.5.5.m5.1.1.6.2.3" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.3.cmml">L</mi></mrow><mo id="Thmdefinition4.p1.5.5.m5.1.1.6.1" xref="Thmdefinition4.p1.5.5.m5.1.1.6.1.cmml">−</mo><mn id="Thmdefinition4.p1.5.5.m5.1.1.6.3" xref="Thmdefinition4.p1.5.5.m5.1.1.6.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition4.p1.5.5.m5.1b"><apply id="Thmdefinition4.p1.5.5.m5.1.1.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1"><and id="Thmdefinition4.p1.5.5.m5.1.1a.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1"></and><apply id="Thmdefinition4.p1.5.5.m5.1.1b.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1"><leq id="Thmdefinition4.p1.5.5.m5.1.1.3.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.3"></leq><apply id="Thmdefinition4.p1.5.5.m5.1.1.2.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.2"><csymbol cd="ambiguous" id="Thmdefinition4.p1.5.5.m5.1.1.2.1.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.2">subscript</csymbol><ci id="Thmdefinition4.p1.5.5.m5.1.1.2.2.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.2.2">𝑖</ci><cn id="Thmdefinition4.p1.5.5.m5.1.1.2.3.cmml" type="integer" xref="Thmdefinition4.p1.5.5.m5.1.1.2.3">1</cn></apply><apply id="Thmdefinition4.p1.5.5.m5.1.1.4.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.4"><csymbol cd="ambiguous" id="Thmdefinition4.p1.5.5.m5.1.1.4.1.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.4">subscript</csymbol><ci id="Thmdefinition4.p1.5.5.m5.1.1.4.2.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.4.2">𝑗</ci><cn id="Thmdefinition4.p1.5.5.m5.1.1.4.3.cmml" type="integer" xref="Thmdefinition4.p1.5.5.m5.1.1.4.3">1</cn></apply></apply><apply id="Thmdefinition4.p1.5.5.m5.1.1c.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1"><leq id="Thmdefinition4.p1.5.5.m5.1.1.5.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#Thmdefinition4.p1.5.5.m5.1.1.4.cmml" id="Thmdefinition4.p1.5.5.m5.1.1d.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1"></share><apply id="Thmdefinition4.p1.5.5.m5.1.1.6.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.6"><minus id="Thmdefinition4.p1.5.5.m5.1.1.6.1.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.6.1"></minus><apply id="Thmdefinition4.p1.5.5.m5.1.1.6.2.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2"><plus id="Thmdefinition4.p1.5.5.m5.1.1.6.2.1.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.1"></plus><apply id="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.2"><csymbol cd="ambiguous" id="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.1.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.2">subscript</csymbol><ci id="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.2.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.2">𝑖</ci><cn id="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.3.cmml" type="integer" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.2.3">1</cn></apply><ci id="Thmdefinition4.p1.5.5.m5.1.1.6.2.3.cmml" xref="Thmdefinition4.p1.5.5.m5.1.1.6.2.3">𝐿</ci></apply><cn id="Thmdefinition4.p1.5.5.m5.1.1.6.3.cmml" type="integer" xref="Thmdefinition4.p1.5.5.m5.1.1.6.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition4.p1.5.5.m5.1c">i_{1}\leq j_{1}\leq i_{1}+L-1</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition4.p1.5.5.m5.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_L - 1</annotation></semantics></math> and <math alttext="T_{M}[r,i_{1},j_{1}]=-\infty" class="ltx_Math" display="inline" id="Thmdefinition4.p1.6.6.m6.3"><semantics id="Thmdefinition4.p1.6.6.m6.3a"><mrow id="Thmdefinition4.p1.6.6.m6.3.3" xref="Thmdefinition4.p1.6.6.m6.3.3.cmml"><mrow id="Thmdefinition4.p1.6.6.m6.3.3.2" xref="Thmdefinition4.p1.6.6.m6.3.3.2.cmml"><msub id="Thmdefinition4.p1.6.6.m6.3.3.2.4" xref="Thmdefinition4.p1.6.6.m6.3.3.2.4.cmml"><mi id="Thmdefinition4.p1.6.6.m6.3.3.2.4.2" xref="Thmdefinition4.p1.6.6.m6.3.3.2.4.2.cmml">T</mi><mi id="Thmdefinition4.p1.6.6.m6.3.3.2.4.3" xref="Thmdefinition4.p1.6.6.m6.3.3.2.4.3.cmml">M</mi></msub><mo id="Thmdefinition4.p1.6.6.m6.3.3.2.3" xref="Thmdefinition4.p1.6.6.m6.3.3.2.3.cmml">⁢</mo><mrow id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.3.cmml"><mo id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.3" stretchy="false" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.3.cmml">[</mo><mi id="Thmdefinition4.p1.6.6.m6.1.1" xref="Thmdefinition4.p1.6.6.m6.1.1.cmml">r</mi><mo id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.4" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.3.cmml">,</mo><msub id="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1" xref="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.cmml"><mi id="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.2" xref="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.2.cmml">i</mi><mn id="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.3" xref="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.5" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.3.cmml">,</mo><msub id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.cmml"><mi id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.2" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.2.cmml">j</mi><mn id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.3" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.3.cmml">1</mn></msub><mo id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.6" stretchy="false" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.3.cmml">]</mo></mrow></mrow><mo id="Thmdefinition4.p1.6.6.m6.3.3.3" xref="Thmdefinition4.p1.6.6.m6.3.3.3.cmml">=</mo><mrow id="Thmdefinition4.p1.6.6.m6.3.3.4" xref="Thmdefinition4.p1.6.6.m6.3.3.4.cmml"><mo id="Thmdefinition4.p1.6.6.m6.3.3.4a" xref="Thmdefinition4.p1.6.6.m6.3.3.4.cmml">−</mo><mi id="Thmdefinition4.p1.6.6.m6.3.3.4.2" mathvariant="normal" xref="Thmdefinition4.p1.6.6.m6.3.3.4.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition4.p1.6.6.m6.3b"><apply id="Thmdefinition4.p1.6.6.m6.3.3.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3"><eq id="Thmdefinition4.p1.6.6.m6.3.3.3.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.3"></eq><apply id="Thmdefinition4.p1.6.6.m6.3.3.2.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.2"><times id="Thmdefinition4.p1.6.6.m6.3.3.2.3.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.2.3"></times><apply id="Thmdefinition4.p1.6.6.m6.3.3.2.4.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.2.4"><csymbol cd="ambiguous" id="Thmdefinition4.p1.6.6.m6.3.3.2.4.1.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.2.4">subscript</csymbol><ci id="Thmdefinition4.p1.6.6.m6.3.3.2.4.2.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.2.4.2">𝑇</ci><ci id="Thmdefinition4.p1.6.6.m6.3.3.2.4.3.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.2.4.3">𝑀</ci></apply><list id="Thmdefinition4.p1.6.6.m6.3.3.2.2.3.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.2"><ci id="Thmdefinition4.p1.6.6.m6.1.1.cmml" xref="Thmdefinition4.p1.6.6.m6.1.1">𝑟</ci><apply id="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.cmml" xref="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.1.cmml" xref="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1">subscript</csymbol><ci id="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.2.cmml" xref="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.2">𝑖</ci><cn id="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition4.p1.6.6.m6.2.2.1.1.1.1.3">1</cn></apply><apply id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2"><csymbol cd="ambiguous" id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.1.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2">subscript</csymbol><ci id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.2.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.2">𝑗</ci><cn id="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.3.cmml" type="integer" xref="Thmdefinition4.p1.6.6.m6.3.3.2.2.2.2.3">1</cn></apply></list></apply><apply id="Thmdefinition4.p1.6.6.m6.3.3.4.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.4"><minus id="Thmdefinition4.p1.6.6.m6.3.3.4.1.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.4"></minus><infinity id="Thmdefinition4.p1.6.6.m6.3.3.4.2.cmml" xref="Thmdefinition4.p1.6.6.m6.3.3.4.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition4.p1.6.6.m6.3c">T_{M}[r,i_{1},j_{1}]=-\infty</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition4.p1.6.6.m6.3d">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = - ∞</annotation></semantics></math> otherwise.</span></p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.p12">
<p class="ltx_p" id="S3.p12.7">In view of Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm2" title="Lemma 2. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2</span></a>, adding <math alttext="T_{M}" class="ltx_Math" display="inline" id="S3.p12.1.m1.1"><semantics id="S3.p12.1.m1.1a"><msub id="S3.p12.1.m1.1.1" xref="S3.p12.1.m1.1.1.cmml"><mi id="S3.p12.1.m1.1.1.2" xref="S3.p12.1.m1.1.1.2.cmml">T</mi><mi id="S3.p12.1.m1.1.1.3" xref="S3.p12.1.m1.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p12.1.m1.1b"><apply id="S3.p12.1.m1.1.1.cmml" xref="S3.p12.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p12.1.m1.1.1.1.cmml" xref="S3.p12.1.m1.1.1">subscript</csymbol><ci id="S3.p12.1.m1.1.1.2.cmml" xref="S3.p12.1.m1.1.1.2">𝑇</ci><ci id="S3.p12.1.m1.1.1.3.cmml" xref="S3.p12.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p12.1.m1.1c">T_{M}</annotation><annotation encoding="application/x-llamapun" id="S3.p12.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="T_{A}" class="ltx_Math" display="inline" id="S3.p12.2.m2.1"><semantics id="S3.p12.2.m2.1a"><msub id="S3.p12.2.m2.1.1" xref="S3.p12.2.m2.1.1.cmml"><mi id="S3.p12.2.m2.1.1.2" xref="S3.p12.2.m2.1.1.2.cmml">T</mi><mi id="S3.p12.2.m2.1.1.3" xref="S3.p12.2.m2.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p12.2.m2.1b"><apply id="S3.p12.2.m2.1.1.cmml" xref="S3.p12.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p12.2.m2.1.1.1.cmml" xref="S3.p12.2.m2.1.1">subscript</csymbol><ci id="S3.p12.2.m2.1.1.2.cmml" xref="S3.p12.2.m2.1.1.2">𝑇</ci><ci id="S3.p12.2.m2.1.1.3.cmml" xref="S3.p12.2.m2.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p12.2.m2.1c">T_{A}</annotation><annotation encoding="application/x-llamapun" id="S3.p12.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math> acts as the same masking as adding <math alttext="M" class="ltx_Math" display="inline" id="S3.p12.3.m3.1"><semantics id="S3.p12.3.m3.1a"><mi id="S3.p12.3.m3.1.1" xref="S3.p12.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p12.3.m3.1b"><ci id="S3.p12.3.m3.1.1.cmml" xref="S3.p12.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p12.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p12.3.m3.1d">italic_M</annotation></semantics></math> to <math alttext="QK^{T}" class="ltx_Math" display="inline" id="S3.p12.4.m4.1"><semantics id="S3.p12.4.m4.1a"><mrow id="S3.p12.4.m4.1.1" xref="S3.p12.4.m4.1.1.cmml"><mi id="S3.p12.4.m4.1.1.2" xref="S3.p12.4.m4.1.1.2.cmml">Q</mi><mo id="S3.p12.4.m4.1.1.1" xref="S3.p12.4.m4.1.1.1.cmml">⁢</mo><msup id="S3.p12.4.m4.1.1.3" xref="S3.p12.4.m4.1.1.3.cmml"><mi id="S3.p12.4.m4.1.1.3.2" xref="S3.p12.4.m4.1.1.3.2.cmml">K</mi><mi id="S3.p12.4.m4.1.1.3.3" xref="S3.p12.4.m4.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p12.4.m4.1b"><apply id="S3.p12.4.m4.1.1.cmml" xref="S3.p12.4.m4.1.1"><times id="S3.p12.4.m4.1.1.1.cmml" xref="S3.p12.4.m4.1.1.1"></times><ci id="S3.p12.4.m4.1.1.2.cmml" xref="S3.p12.4.m4.1.1.2">𝑄</ci><apply id="S3.p12.4.m4.1.1.3.cmml" xref="S3.p12.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p12.4.m4.1.1.3.1.cmml" xref="S3.p12.4.m4.1.1.3">superscript</csymbol><ci id="S3.p12.4.m4.1.1.3.2.cmml" xref="S3.p12.4.m4.1.1.3.2">𝐾</ci><ci id="S3.p12.4.m4.1.1.3.3.cmml" xref="S3.p12.4.m4.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p12.4.m4.1c">QK^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p12.4.m4.1d">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, we are just operating on the variables <math alttext="(i_{1},j_{1})" class="ltx_Math" display="inline" id="S3.p12.5.m5.2"><semantics id="S3.p12.5.m5.2a"><mrow id="S3.p12.5.m5.2.2.2" xref="S3.p12.5.m5.2.2.3.cmml"><mo id="S3.p12.5.m5.2.2.2.3" stretchy="false" xref="S3.p12.5.m5.2.2.3.cmml">(</mo><msub id="S3.p12.5.m5.1.1.1.1" xref="S3.p12.5.m5.1.1.1.1.cmml"><mi id="S3.p12.5.m5.1.1.1.1.2" xref="S3.p12.5.m5.1.1.1.1.2.cmml">i</mi><mn id="S3.p12.5.m5.1.1.1.1.3" xref="S3.p12.5.m5.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.p12.5.m5.2.2.2.4" xref="S3.p12.5.m5.2.2.3.cmml">,</mo><msub id="S3.p12.5.m5.2.2.2.2" xref="S3.p12.5.m5.2.2.2.2.cmml"><mi id="S3.p12.5.m5.2.2.2.2.2" xref="S3.p12.5.m5.2.2.2.2.2.cmml">j</mi><mn id="S3.p12.5.m5.2.2.2.2.3" xref="S3.p12.5.m5.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.p12.5.m5.2.2.2.5" stretchy="false" xref="S3.p12.5.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p12.5.m5.2b"><interval closure="open" id="S3.p12.5.m5.2.2.3.cmml" xref="S3.p12.5.m5.2.2.2"><apply id="S3.p12.5.m5.1.1.1.1.cmml" xref="S3.p12.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.p12.5.m5.1.1.1.1.1.cmml" xref="S3.p12.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.p12.5.m5.1.1.1.1.2.cmml" xref="S3.p12.5.m5.1.1.1.1.2">𝑖</ci><cn id="S3.p12.5.m5.1.1.1.1.3.cmml" type="integer" xref="S3.p12.5.m5.1.1.1.1.3">1</cn></apply><apply id="S3.p12.5.m5.2.2.2.2.cmml" xref="S3.p12.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.p12.5.m5.2.2.2.2.1.cmml" xref="S3.p12.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.p12.5.m5.2.2.2.2.2.cmml" xref="S3.p12.5.m5.2.2.2.2.2">𝑗</ci><cn id="S3.p12.5.m5.2.2.2.2.3.cmml" type="integer" xref="S3.p12.5.m5.2.2.2.2.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p12.5.m5.2c">(i_{1},j_{1})</annotation><annotation encoding="application/x-llamapun" id="S3.p12.5.m5.2d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math> instead of <math alttext="(i,j)" class="ltx_Math" display="inline" id="S3.p12.6.m6.2"><semantics id="S3.p12.6.m6.2a"><mrow id="S3.p12.6.m6.2.3.2" xref="S3.p12.6.m6.2.3.1.cmml"><mo id="S3.p12.6.m6.2.3.2.1" stretchy="false" xref="S3.p12.6.m6.2.3.1.cmml">(</mo><mi id="S3.p12.6.m6.1.1" xref="S3.p12.6.m6.1.1.cmml">i</mi><mo id="S3.p12.6.m6.2.3.2.2" xref="S3.p12.6.m6.2.3.1.cmml">,</mo><mi id="S3.p12.6.m6.2.2" xref="S3.p12.6.m6.2.2.cmml">j</mi><mo id="S3.p12.6.m6.2.3.2.3" stretchy="false" xref="S3.p12.6.m6.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p12.6.m6.2b"><interval closure="open" id="S3.p12.6.m6.2.3.1.cmml" xref="S3.p12.6.m6.2.3.2"><ci id="S3.p12.6.m6.1.1.cmml" xref="S3.p12.6.m6.1.1">𝑖</ci><ci id="S3.p12.6.m6.2.2.cmml" xref="S3.p12.6.m6.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p12.6.m6.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="S3.p12.6.m6.2d">( italic_i , italic_j )</annotation></semantics></math>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.F3" title="Figure 3 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">3</span></a> visualises the computation <math alttext="\operatorname{softmax}(T_{A}+T_{M})" class="ltx_Math" display="inline" id="S3.p12.7.m7.2"><semantics id="S3.p12.7.m7.2a"><mrow id="S3.p12.7.m7.2.2.1" xref="S3.p12.7.m7.2.2.2.cmml"><mi id="S3.p12.7.m7.1.1" xref="S3.p12.7.m7.1.1.cmml">softmax</mi><mo id="S3.p12.7.m7.2.2.1a" xref="S3.p12.7.m7.2.2.2.cmml">⁡</mo><mrow id="S3.p12.7.m7.2.2.1.1" xref="S3.p12.7.m7.2.2.2.cmml"><mo id="S3.p12.7.m7.2.2.1.1.2" stretchy="false" xref="S3.p12.7.m7.2.2.2.cmml">(</mo><mrow id="S3.p12.7.m7.2.2.1.1.1" xref="S3.p12.7.m7.2.2.1.1.1.cmml"><msub id="S3.p12.7.m7.2.2.1.1.1.2" xref="S3.p12.7.m7.2.2.1.1.1.2.cmml"><mi id="S3.p12.7.m7.2.2.1.1.1.2.2" xref="S3.p12.7.m7.2.2.1.1.1.2.2.cmml">T</mi><mi id="S3.p12.7.m7.2.2.1.1.1.2.3" xref="S3.p12.7.m7.2.2.1.1.1.2.3.cmml">A</mi></msub><mo id="S3.p12.7.m7.2.2.1.1.1.1" xref="S3.p12.7.m7.2.2.1.1.1.1.cmml">+</mo><msub id="S3.p12.7.m7.2.2.1.1.1.3" xref="S3.p12.7.m7.2.2.1.1.1.3.cmml"><mi id="S3.p12.7.m7.2.2.1.1.1.3.2" xref="S3.p12.7.m7.2.2.1.1.1.3.2.cmml">T</mi><mi id="S3.p12.7.m7.2.2.1.1.1.3.3" xref="S3.p12.7.m7.2.2.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S3.p12.7.m7.2.2.1.1.3" stretchy="false" xref="S3.p12.7.m7.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p12.7.m7.2b"><apply id="S3.p12.7.m7.2.2.2.cmml" xref="S3.p12.7.m7.2.2.1"><ci id="S3.p12.7.m7.1.1.cmml" xref="S3.p12.7.m7.1.1">softmax</ci><apply id="S3.p12.7.m7.2.2.1.1.1.cmml" xref="S3.p12.7.m7.2.2.1.1.1"><plus id="S3.p12.7.m7.2.2.1.1.1.1.cmml" xref="S3.p12.7.m7.2.2.1.1.1.1"></plus><apply id="S3.p12.7.m7.2.2.1.1.1.2.cmml" xref="S3.p12.7.m7.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.p12.7.m7.2.2.1.1.1.2.1.cmml" xref="S3.p12.7.m7.2.2.1.1.1.2">subscript</csymbol><ci id="S3.p12.7.m7.2.2.1.1.1.2.2.cmml" xref="S3.p12.7.m7.2.2.1.1.1.2.2">𝑇</ci><ci id="S3.p12.7.m7.2.2.1.1.1.2.3.cmml" xref="S3.p12.7.m7.2.2.1.1.1.2.3">𝐴</ci></apply><apply id="S3.p12.7.m7.2.2.1.1.1.3.cmml" xref="S3.p12.7.m7.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.p12.7.m7.2.2.1.1.1.3.1.cmml" xref="S3.p12.7.m7.2.2.1.1.1.3">subscript</csymbol><ci id="S3.p12.7.m7.2.2.1.1.1.3.2.cmml" xref="S3.p12.7.m7.2.2.1.1.1.3.2">𝑇</ci><ci id="S3.p12.7.m7.2.2.1.1.1.3.3.cmml" xref="S3.p12.7.m7.2.2.1.1.1.3.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p12.7.m7.2c">\operatorname{softmax}(T_{A}+T_{M})</annotation><annotation encoding="application/x-llamapun" id="S3.p12.7.m7.2d">roman_softmax ( italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT + italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure ltx_align_center" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="253" id="S3.F3.1.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Visualisation of computation of the attention scores for LAM. For the matrix <math alttext="QK^{T}" class="ltx_Math" display="inline" id="S3.F3.7.m1.1"><semantics id="S3.F3.7.m1.1b"><mrow id="S3.F3.7.m1.1.1" xref="S3.F3.7.m1.1.1.cmml"><mi id="S3.F3.7.m1.1.1.2" xref="S3.F3.7.m1.1.1.2.cmml">Q</mi><mo id="S3.F3.7.m1.1.1.1" xref="S3.F3.7.m1.1.1.1.cmml">⁢</mo><msup id="S3.F3.7.m1.1.1.3" xref="S3.F3.7.m1.1.1.3.cmml"><mi id="S3.F3.7.m1.1.1.3.2" xref="S3.F3.7.m1.1.1.3.2.cmml">K</mi><mi id="S3.F3.7.m1.1.1.3.3" xref="S3.F3.7.m1.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.7.m1.1c"><apply id="S3.F3.7.m1.1.1.cmml" xref="S3.F3.7.m1.1.1"><times id="S3.F3.7.m1.1.1.1.cmml" xref="S3.F3.7.m1.1.1.1"></times><ci id="S3.F3.7.m1.1.1.2.cmml" xref="S3.F3.7.m1.1.1.2">𝑄</ci><apply id="S3.F3.7.m1.1.1.3.cmml" xref="S3.F3.7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F3.7.m1.1.1.3.1.cmml" xref="S3.F3.7.m1.1.1.3">superscript</csymbol><ci id="S3.F3.7.m1.1.1.3.2.cmml" xref="S3.F3.7.m1.1.1.3.2">𝐾</ci><ci id="S3.F3.7.m1.1.1.3.3.cmml" xref="S3.F3.7.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.7.m1.1d">QK^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.7.m1.1e">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> we show in brown the dot products computed in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.F2" title="In 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a> (that is, those dot products computed for <math alttext="T_{A}" class="ltx_Math" display="inline" id="S3.F3.8.m2.1"><semantics id="S3.F3.8.m2.1b"><msub id="S3.F3.8.m2.1.1" xref="S3.F3.8.m2.1.1.cmml"><mi id="S3.F3.8.m2.1.1.2" xref="S3.F3.8.m2.1.1.2.cmml">T</mi><mi id="S3.F3.8.m2.1.1.3" xref="S3.F3.8.m2.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.8.m2.1c"><apply id="S3.F3.8.m2.1.1.cmml" xref="S3.F3.8.m2.1.1"><csymbol cd="ambiguous" id="S3.F3.8.m2.1.1.1.cmml" xref="S3.F3.8.m2.1.1">subscript</csymbol><ci id="S3.F3.8.m2.1.1.2.cmml" xref="S3.F3.8.m2.1.1.2">𝑇</ci><ci id="S3.F3.8.m2.1.1.3.cmml" xref="S3.F3.8.m2.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.8.m2.1d">T_{A}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.8.m2.1e">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math>), where light brown corresponds to <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.F2.sf2" title="In Figure 2 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2(b)</span></a>, medium brown corresponds to <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.F2.sf3" title="In Figure 2 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2(c)</span></a> and dark brown corresponds to <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.F2.sf4" title="In Figure 2 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2(d)</span></a>. The attention scores of LAM are computed after adding <math alttext="T_{M}" class="ltx_Math" display="inline" id="S3.F3.9.m3.1"><semantics id="S3.F3.9.m3.1b"><msub id="S3.F3.9.m3.1.1" xref="S3.F3.9.m3.1.1.cmml"><mi id="S3.F3.9.m3.1.1.2" xref="S3.F3.9.m3.1.1.2.cmml">T</mi><mi id="S3.F3.9.m3.1.1.3" xref="S3.F3.9.m3.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.9.m3.1c"><apply id="S3.F3.9.m3.1.1.cmml" xref="S3.F3.9.m3.1.1"><csymbol cd="ambiguous" id="S3.F3.9.m3.1.1.1.cmml" xref="S3.F3.9.m3.1.1">subscript</csymbol><ci id="S3.F3.9.m3.1.1.2.cmml" xref="S3.F3.9.m3.1.1.2">𝑇</ci><ci id="S3.F3.9.m3.1.1.3.cmml" xref="S3.F3.9.m3.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.9.m3.1d">T_{M}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.9.m3.1e">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> (the sub-blocks of <math alttext="M" class="ltx_Math" display="inline" id="S3.F3.10.m4.1"><semantics id="S3.F3.10.m4.1b"><mi id="S3.F3.10.m4.1.1" xref="S3.F3.10.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.F3.10.m4.1c"><ci id="S3.F3.10.m4.1.1.cmml" xref="S3.F3.10.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.10.m4.1d">M</annotation><annotation encoding="application/x-llamapun" id="S3.F3.10.m4.1e">italic_M</annotation></semantics></math> given in Definition <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmdefinition4" title="Definition 4 (The tensor 𝑇_𝑀). ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4</span></a>), to <math alttext="T_{A}" class="ltx_Math" display="inline" id="S3.F3.11.m5.1"><semantics id="S3.F3.11.m5.1b"><msub id="S3.F3.11.m5.1.1" xref="S3.F3.11.m5.1.1.cmml"><mi id="S3.F3.11.m5.1.1.2" xref="S3.F3.11.m5.1.1.2.cmml">T</mi><mi id="S3.F3.11.m5.1.1.3" xref="S3.F3.11.m5.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.11.m5.1c"><apply id="S3.F3.11.m5.1.1.cmml" xref="S3.F3.11.m5.1.1"><csymbol cd="ambiguous" id="S3.F3.11.m5.1.1.1.cmml" xref="S3.F3.11.m5.1.1">subscript</csymbol><ci id="S3.F3.11.m5.1.1.2.cmml" xref="S3.F3.11.m5.1.1.2">𝑇</ci><ci id="S3.F3.11.m5.1.1.3.cmml" xref="S3.F3.11.m5.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.11.m5.1d">T_{A}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.11.m5.1e">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math> and applying the Softmax function to each row.
In green, we highlight the attention scores computed by LAM.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p13">
<p class="ltx_p" id="S3.p13.2">We can now prove that <math alttext="T_{S}=\operatorname{softmax}((T_{Q}T_{K}^{T}+T_{M})/\sqrt{d_{q}})" class="ltx_Math" display="inline" id="S3.p13.1.m1.2"><semantics id="S3.p13.1.m1.2a"><mrow id="S3.p13.1.m1.2.2" xref="S3.p13.1.m1.2.2.cmml"><msub id="S3.p13.1.m1.2.2.3" xref="S3.p13.1.m1.2.2.3.cmml"><mi id="S3.p13.1.m1.2.2.3.2" xref="S3.p13.1.m1.2.2.3.2.cmml">T</mi><mi id="S3.p13.1.m1.2.2.3.3" xref="S3.p13.1.m1.2.2.3.3.cmml">S</mi></msub><mo id="S3.p13.1.m1.2.2.2" xref="S3.p13.1.m1.2.2.2.cmml">=</mo><mrow id="S3.p13.1.m1.2.2.1.1" xref="S3.p13.1.m1.2.2.1.2.cmml"><mi id="S3.p13.1.m1.1.1" xref="S3.p13.1.m1.1.1.cmml">softmax</mi><mo id="S3.p13.1.m1.2.2.1.1a" xref="S3.p13.1.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.p13.1.m1.2.2.1.1.1" xref="S3.p13.1.m1.2.2.1.2.cmml"><mo id="S3.p13.1.m1.2.2.1.1.1.2" stretchy="false" xref="S3.p13.1.m1.2.2.1.2.cmml">(</mo><mrow id="S3.p13.1.m1.2.2.1.1.1.1" xref="S3.p13.1.m1.2.2.1.1.1.1.cmml"><mrow id="S3.p13.1.m1.2.2.1.1.1.1.1.1" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.p13.1.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">T</mi><mi id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml">Q</mi></msub><mo id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.1" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2.cmml">T</mi><mi id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3.cmml">K</mi><mi id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">T</mi><mi id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S3.p13.1.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p13.1.m1.2.2.1.1.1.1.2" xref="S3.p13.1.m1.2.2.1.1.1.1.2.cmml">/</mo><msqrt id="S3.p13.1.m1.2.2.1.1.1.1.3" xref="S3.p13.1.m1.2.2.1.1.1.1.3.cmml"><msub id="S3.p13.1.m1.2.2.1.1.1.1.3.2" xref="S3.p13.1.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S3.p13.1.m1.2.2.1.1.1.1.3.2.2" xref="S3.p13.1.m1.2.2.1.1.1.1.3.2.2.cmml">d</mi><mi id="S3.p13.1.m1.2.2.1.1.1.1.3.2.3" xref="S3.p13.1.m1.2.2.1.1.1.1.3.2.3.cmml">q</mi></msub></msqrt></mrow><mo id="S3.p13.1.m1.2.2.1.1.1.3" stretchy="false" xref="S3.p13.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p13.1.m1.2b"><apply id="S3.p13.1.m1.2.2.cmml" xref="S3.p13.1.m1.2.2"><eq id="S3.p13.1.m1.2.2.2.cmml" xref="S3.p13.1.m1.2.2.2"></eq><apply id="S3.p13.1.m1.2.2.3.cmml" xref="S3.p13.1.m1.2.2.3"><csymbol cd="ambiguous" id="S3.p13.1.m1.2.2.3.1.cmml" xref="S3.p13.1.m1.2.2.3">subscript</csymbol><ci id="S3.p13.1.m1.2.2.3.2.cmml" xref="S3.p13.1.m1.2.2.3.2">𝑇</ci><ci id="S3.p13.1.m1.2.2.3.3.cmml" xref="S3.p13.1.m1.2.2.3.3">𝑆</ci></apply><apply id="S3.p13.1.m1.2.2.1.2.cmml" xref="S3.p13.1.m1.2.2.1.1"><ci id="S3.p13.1.m1.1.1.cmml" xref="S3.p13.1.m1.1.1">softmax</ci><apply id="S3.p13.1.m1.2.2.1.1.1.1.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1"><divide id="S3.p13.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.2"></divide><apply id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1"><plus id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.1"></plus><apply id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2"><times id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑇</ci><ci id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.2.3">𝑄</ci></apply><apply id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2">𝑇</ci><ci id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3">𝐾</ci></apply><ci id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.2">𝑇</ci><ci id="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.1.1.1.3.3">𝑀</ci></apply></apply><apply id="S3.p13.1.m1.2.2.1.1.1.1.3.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.3"><root id="S3.p13.1.m1.2.2.1.1.1.1.3a.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.3"></root><apply id="S3.p13.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p13.1.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.p13.1.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.3.2.2">𝑑</ci><ci id="S3.p13.1.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.p13.1.m1.2.2.1.1.1.1.3.2.3">𝑞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p13.1.m1.2c">T_{S}=\operatorname{softmax}((T_{Q}T_{K}^{T}+T_{M})/\sqrt{d_{q}})</annotation><annotation encoding="application/x-llamapun" id="S3.p13.1.m1.2d">italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = roman_softmax ( ( italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math> contains the attention scores of <math alttext="\operatorname{softmax}\left((QK^{T}+M)/\sqrt{d_{q}}\right)" class="ltx_Math" display="inline" id="S3.p13.2.m2.2"><semantics id="S3.p13.2.m2.2a"><mrow id="S3.p13.2.m2.2.2.1" xref="S3.p13.2.m2.2.2.2.cmml"><mi id="S3.p13.2.m2.1.1" xref="S3.p13.2.m2.1.1.cmml">softmax</mi><mo id="S3.p13.2.m2.2.2.1a" xref="S3.p13.2.m2.2.2.2.cmml">⁡</mo><mrow id="S3.p13.2.m2.2.2.1.1" xref="S3.p13.2.m2.2.2.2.cmml"><mo id="S3.p13.2.m2.2.2.1.1.2" xref="S3.p13.2.m2.2.2.2.cmml">(</mo><mrow id="S3.p13.2.m2.2.2.1.1.1" xref="S3.p13.2.m2.2.2.1.1.1.cmml"><mrow id="S3.p13.2.m2.2.2.1.1.1.1.1" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.p13.2.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p13.2.m2.2.2.1.1.1.1.1.1" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.2" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.2.cmml">Q</mi><mo id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.1" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.2" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.2.cmml">K</mi><mi id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.3" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="S3.p13.2.m2.2.2.1.1.1.1.1.1.1" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.p13.2.m2.2.2.1.1.1.1.1.1.3" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.3.cmml">M</mi></mrow><mo id="S3.p13.2.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p13.2.m2.2.2.1.1.1.2" xref="S3.p13.2.m2.2.2.1.1.1.2.cmml">/</mo><msqrt id="S3.p13.2.m2.2.2.1.1.1.3" xref="S3.p13.2.m2.2.2.1.1.1.3.cmml"><msub id="S3.p13.2.m2.2.2.1.1.1.3.2" xref="S3.p13.2.m2.2.2.1.1.1.3.2.cmml"><mi id="S3.p13.2.m2.2.2.1.1.1.3.2.2" xref="S3.p13.2.m2.2.2.1.1.1.3.2.2.cmml">d</mi><mi id="S3.p13.2.m2.2.2.1.1.1.3.2.3" xref="S3.p13.2.m2.2.2.1.1.1.3.2.3.cmml">q</mi></msub></msqrt></mrow><mo id="S3.p13.2.m2.2.2.1.1.3" xref="S3.p13.2.m2.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p13.2.m2.2b"><apply id="S3.p13.2.m2.2.2.2.cmml" xref="S3.p13.2.m2.2.2.1"><ci id="S3.p13.2.m2.1.1.cmml" xref="S3.p13.2.m2.1.1">softmax</ci><apply id="S3.p13.2.m2.2.2.1.1.1.cmml" xref="S3.p13.2.m2.2.2.1.1.1"><divide id="S3.p13.2.m2.2.2.1.1.1.2.cmml" xref="S3.p13.2.m2.2.2.1.1.1.2"></divide><apply id="S3.p13.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.p13.2.m2.2.2.1.1.1.1.1"><plus id="S3.p13.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2"><times id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.1"></times><ci id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.2">𝑄</ci><apply id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.2">𝐾</ci><ci id="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S3.p13.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.p13.2.m2.2.2.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.p13.2.m2.2.2.1.1.1.3.cmml" xref="S3.p13.2.m2.2.2.1.1.1.3"><root id="S3.p13.2.m2.2.2.1.1.1.3a.cmml" xref="S3.p13.2.m2.2.2.1.1.1.3"></root><apply id="S3.p13.2.m2.2.2.1.1.1.3.2.cmml" xref="S3.p13.2.m2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p13.2.m2.2.2.1.1.1.3.2.1.cmml" xref="S3.p13.2.m2.2.2.1.1.1.3.2">subscript</csymbol><ci id="S3.p13.2.m2.2.2.1.1.1.3.2.2.cmml" xref="S3.p13.2.m2.2.2.1.1.1.3.2.2">𝑑</ci><ci id="S3.p13.2.m2.2.2.1.1.1.3.2.3.cmml" xref="S3.p13.2.m2.2.2.1.1.1.3.2.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p13.2.m2.2c">\operatorname{softmax}\left((QK^{T}+M)/\sqrt{d_{q}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.p13.2.m2.2d">roman_softmax ( ( italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_M ) / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math>, other than the extra zeroes that we have not computed.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmthm4">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm4.1.1.1">Lemma 4</span></span><span class="ltx_text ltx_font_bold" id="Thmthm4.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm4.p1">
<p class="ltx_p" id="Thmthm4.p1.14"><span class="ltx_text ltx_font_italic" id="Thmthm4.p1.14.14">The tensor defined as <math alttext="T_{S}=\operatorname{softmax}((T_{Q}T_{K}^{T}+T_{M})/\sqrt{d_{q}})" class="ltx_Math" display="inline" id="Thmthm4.p1.1.1.m1.2"><semantics id="Thmthm4.p1.1.1.m1.2a"><mrow id="Thmthm4.p1.1.1.m1.2.2" xref="Thmthm4.p1.1.1.m1.2.2.cmml"><msub id="Thmthm4.p1.1.1.m1.2.2.3" xref="Thmthm4.p1.1.1.m1.2.2.3.cmml"><mi id="Thmthm4.p1.1.1.m1.2.2.3.2" xref="Thmthm4.p1.1.1.m1.2.2.3.2.cmml">T</mi><mi id="Thmthm4.p1.1.1.m1.2.2.3.3" xref="Thmthm4.p1.1.1.m1.2.2.3.3.cmml">S</mi></msub><mo id="Thmthm4.p1.1.1.m1.2.2.2" xref="Thmthm4.p1.1.1.m1.2.2.2.cmml">=</mo><mrow id="Thmthm4.p1.1.1.m1.2.2.1.1" xref="Thmthm4.p1.1.1.m1.2.2.1.2.cmml"><mi id="Thmthm4.p1.1.1.m1.1.1" xref="Thmthm4.p1.1.1.m1.1.1.cmml">softmax</mi><mo id="Thmthm4.p1.1.1.m1.2.2.1.1a" xref="Thmthm4.p1.1.1.m1.2.2.1.2.cmml">⁡</mo><mrow id="Thmthm4.p1.1.1.m1.2.2.1.1.1" xref="Thmthm4.p1.1.1.m1.2.2.1.2.cmml"><mo id="Thmthm4.p1.1.1.m1.2.2.1.1.1.2" stretchy="false" xref="Thmthm4.p1.1.1.m1.2.2.1.2.cmml">(</mo><mrow id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.cmml"><mrow id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">T</mi><mi id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml">Q</mi></msub><mo id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.1" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2.cmml">T</mi><mi id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3.cmml">K</mi><mi id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.2" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">T</mi><mi id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.3" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.2" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.2.cmml">/</mo><msqrt id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.cmml"><msub id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.cmml"><mi id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.2" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.2.cmml">d</mi><mi id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.3" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.3.cmml">q</mi></msub></msqrt></mrow><mo id="Thmthm4.p1.1.1.m1.2.2.1.1.1.3" stretchy="false" xref="Thmthm4.p1.1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.1.1.m1.2b"><apply id="Thmthm4.p1.1.1.m1.2.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2"><eq id="Thmthm4.p1.1.1.m1.2.2.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.2"></eq><apply id="Thmthm4.p1.1.1.m1.2.2.3.cmml" xref="Thmthm4.p1.1.1.m1.2.2.3"><csymbol cd="ambiguous" id="Thmthm4.p1.1.1.m1.2.2.3.1.cmml" xref="Thmthm4.p1.1.1.m1.2.2.3">subscript</csymbol><ci id="Thmthm4.p1.1.1.m1.2.2.3.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.3.2">𝑇</ci><ci id="Thmthm4.p1.1.1.m1.2.2.3.3.cmml" xref="Thmthm4.p1.1.1.m1.2.2.3.3">𝑆</ci></apply><apply id="Thmthm4.p1.1.1.m1.2.2.1.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1"><ci id="Thmthm4.p1.1.1.m1.1.1.cmml" xref="Thmthm4.p1.1.1.m1.1.1">softmax</ci><apply id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1"><divide id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.2"></divide><apply id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1"><plus id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1"></plus><apply id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2"><times id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.1"></times><apply id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑇</ci><ci id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3">𝑄</ci></apply><apply id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2">𝑇</ci><ci id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3">𝐾</ci></apply><ci id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.2">𝑇</ci><ci id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3.3">𝑀</ci></apply></apply><apply id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3"><root id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3a.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3"></root><apply id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.1.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.2.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.2">𝑑</ci><ci id="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.3.cmml" xref="Thmthm4.p1.1.1.m1.2.2.1.1.1.1.3.2.3">𝑞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.1.1.m1.2c">T_{S}=\operatorname{softmax}((T_{Q}T_{K}^{T}+T_{M})/\sqrt{d_{q}})</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.1.1.m1.2d">italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = roman_softmax ( ( italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math>, where <math alttext="\operatorname{softmax}" class="ltx_Math" display="inline" id="Thmthm4.p1.2.2.m2.1"><semantics id="Thmthm4.p1.2.2.m2.1a"><mi id="Thmthm4.p1.2.2.m2.1.1" xref="Thmthm4.p1.2.2.m2.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.2.2.m2.1b"><ci id="Thmthm4.p1.2.2.m2.1.1.cmml" xref="Thmthm4.p1.2.2.m2.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.2.2.m2.1c">\operatorname{softmax}</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.2.2.m2.1d">roman_softmax</annotation></semantics></math> is applied on the last dimension, has dimensions <math alttext="s\times L\times(2L-1)" class="ltx_Math" display="inline" id="Thmthm4.p1.3.3.m3.1"><semantics id="Thmthm4.p1.3.3.m3.1a"><mrow id="Thmthm4.p1.3.3.m3.1.1" xref="Thmthm4.p1.3.3.m3.1.1.cmml"><mi id="Thmthm4.p1.3.3.m3.1.1.3" xref="Thmthm4.p1.3.3.m3.1.1.3.cmml">s</mi><mo id="Thmthm4.p1.3.3.m3.1.1.2" lspace="0.222em" rspace="0.222em" xref="Thmthm4.p1.3.3.m3.1.1.2.cmml">×</mo><mi id="Thmthm4.p1.3.3.m3.1.1.4" xref="Thmthm4.p1.3.3.m3.1.1.4.cmml">L</mi><mo id="Thmthm4.p1.3.3.m3.1.1.2a" lspace="0.222em" rspace="0.222em" xref="Thmthm4.p1.3.3.m3.1.1.2.cmml">×</mo><mrow id="Thmthm4.p1.3.3.m3.1.1.1.1" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.cmml"><mo id="Thmthm4.p1.3.3.m3.1.1.1.1.2" stretchy="false" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm4.p1.3.3.m3.1.1.1.1.1" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.cmml"><mrow id="Thmthm4.p1.3.3.m3.1.1.1.1.1.2" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.cmml"><mn id="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.2" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.2.cmml">2</mn><mo id="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.1" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.3" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="Thmthm4.p1.3.3.m3.1.1.1.1.1.1" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="Thmthm4.p1.3.3.m3.1.1.1.1.1.3" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm4.p1.3.3.m3.1.1.1.1.3" stretchy="false" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.3.3.m3.1b"><apply id="Thmthm4.p1.3.3.m3.1.1.cmml" xref="Thmthm4.p1.3.3.m3.1.1"><times id="Thmthm4.p1.3.3.m3.1.1.2.cmml" xref="Thmthm4.p1.3.3.m3.1.1.2"></times><ci id="Thmthm4.p1.3.3.m3.1.1.3.cmml" xref="Thmthm4.p1.3.3.m3.1.1.3">𝑠</ci><ci id="Thmthm4.p1.3.3.m3.1.1.4.cmml" xref="Thmthm4.p1.3.3.m3.1.1.4">𝐿</ci><apply id="Thmthm4.p1.3.3.m3.1.1.1.1.1.cmml" xref="Thmthm4.p1.3.3.m3.1.1.1.1"><minus id="Thmthm4.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.1"></minus><apply id="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.2"><times id="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.1.cmml" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.1"></times><cn id="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.2.cmml" type="integer" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.2">2</cn><ci id="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.3.cmml" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="Thmthm4.p1.3.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="Thmthm4.p1.3.3.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.3.3.m3.1c">s\times L\times(2L-1)</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.3.3.m3.1d">italic_s × italic_L × ( 2 italic_L - 1 )</annotation></semantics></math>. Let <math alttext="S" class="ltx_Math" display="inline" id="Thmthm4.p1.4.4.m4.1"><semantics id="Thmthm4.p1.4.4.m4.1a"><mi id="Thmthm4.p1.4.4.m4.1.1" xref="Thmthm4.p1.4.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.4.4.m4.1b"><ci id="Thmthm4.p1.4.4.m4.1.1.cmml" xref="Thmthm4.p1.4.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.4.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.4.4.m4.1d">italic_S</annotation></semantics></math> be the matrix <math alttext="\operatorname{softmax}\left((QK^{T}+M)/\sqrt{d_{q}}\right)" class="ltx_Math" display="inline" id="Thmthm4.p1.5.5.m5.2"><semantics id="Thmthm4.p1.5.5.m5.2a"><mrow id="Thmthm4.p1.5.5.m5.2.2.1" xref="Thmthm4.p1.5.5.m5.2.2.2.cmml"><mi id="Thmthm4.p1.5.5.m5.1.1" xref="Thmthm4.p1.5.5.m5.1.1.cmml">softmax</mi><mo id="Thmthm4.p1.5.5.m5.2.2.1a" xref="Thmthm4.p1.5.5.m5.2.2.2.cmml">⁡</mo><mrow id="Thmthm4.p1.5.5.m5.2.2.1.1" xref="Thmthm4.p1.5.5.m5.2.2.2.cmml"><mo id="Thmthm4.p1.5.5.m5.2.2.1.1.2" xref="Thmthm4.p1.5.5.m5.2.2.2.cmml">(</mo><mrow id="Thmthm4.p1.5.5.m5.2.2.1.1.1" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.cmml"><mrow id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.cmml"><mo id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.2" stretchy="false" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.cmml"><mrow id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.cmml"><mi id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.2" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.2.cmml">Q</mi><mo id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.1" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.2" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.2.cmml">K</mi><mi id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.3" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.1" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.1.cmml">+</mo><mi id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.3" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.3.cmml">M</mi></mrow><mo id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.3" stretchy="false" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmthm4.p1.5.5.m5.2.2.1.1.1.2" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.2.cmml">/</mo><msqrt id="Thmthm4.p1.5.5.m5.2.2.1.1.1.3" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.cmml"><msub id="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.cmml"><mi id="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.2" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.2.cmml">d</mi><mi id="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.3" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.3.cmml">q</mi></msub></msqrt></mrow><mo id="Thmthm4.p1.5.5.m5.2.2.1.1.3" xref="Thmthm4.p1.5.5.m5.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.5.5.m5.2b"><apply id="Thmthm4.p1.5.5.m5.2.2.2.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1"><ci id="Thmthm4.p1.5.5.m5.1.1.cmml" xref="Thmthm4.p1.5.5.m5.1.1">softmax</ci><apply id="Thmthm4.p1.5.5.m5.2.2.1.1.1.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1"><divide id="Thmthm4.p1.5.5.m5.2.2.1.1.1.2.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.2"></divide><apply id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1"><plus id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.1.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.1"></plus><apply id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2"><times id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.1.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.1"></times><ci id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.2.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.2">𝑄</ci><apply id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.2">𝐾</ci><ci id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.3.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.3"><root id="Thmthm4.p1.5.5.m5.2.2.1.1.1.3a.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.3"></root><apply id="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.1.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2">subscript</csymbol><ci id="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.2.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.2">𝑑</ci><ci id="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.3.cmml" xref="Thmthm4.p1.5.5.m5.2.2.1.1.1.3.2.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.5.5.m5.2c">\operatorname{softmax}\left((QK^{T}+M)/\sqrt{d_{q}}\right)</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.5.5.m5.2d">roman_softmax ( ( italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_M ) / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math>. For each <math alttext="i\in\{0,1,\ldots,n-1\}" class="ltx_Math" display="inline" id="Thmthm4.p1.6.6.m6.4"><semantics id="Thmthm4.p1.6.6.m6.4a"><mrow id="Thmthm4.p1.6.6.m6.4.4" xref="Thmthm4.p1.6.6.m6.4.4.cmml"><mi id="Thmthm4.p1.6.6.m6.4.4.3" xref="Thmthm4.p1.6.6.m6.4.4.3.cmml">i</mi><mo id="Thmthm4.p1.6.6.m6.4.4.2" xref="Thmthm4.p1.6.6.m6.4.4.2.cmml">∈</mo><mrow id="Thmthm4.p1.6.6.m6.4.4.1.1" xref="Thmthm4.p1.6.6.m6.4.4.1.2.cmml"><mo id="Thmthm4.p1.6.6.m6.4.4.1.1.2" stretchy="false" xref="Thmthm4.p1.6.6.m6.4.4.1.2.cmml">{</mo><mn id="Thmthm4.p1.6.6.m6.1.1" xref="Thmthm4.p1.6.6.m6.1.1.cmml">0</mn><mo id="Thmthm4.p1.6.6.m6.4.4.1.1.3" xref="Thmthm4.p1.6.6.m6.4.4.1.2.cmml">,</mo><mn id="Thmthm4.p1.6.6.m6.2.2" xref="Thmthm4.p1.6.6.m6.2.2.cmml">1</mn><mo id="Thmthm4.p1.6.6.m6.4.4.1.1.4" xref="Thmthm4.p1.6.6.m6.4.4.1.2.cmml">,</mo><mi id="Thmthm4.p1.6.6.m6.3.3" mathvariant="normal" xref="Thmthm4.p1.6.6.m6.3.3.cmml">…</mi><mo id="Thmthm4.p1.6.6.m6.4.4.1.1.5" xref="Thmthm4.p1.6.6.m6.4.4.1.2.cmml">,</mo><mrow id="Thmthm4.p1.6.6.m6.4.4.1.1.1" xref="Thmthm4.p1.6.6.m6.4.4.1.1.1.cmml"><mi id="Thmthm4.p1.6.6.m6.4.4.1.1.1.2" xref="Thmthm4.p1.6.6.m6.4.4.1.1.1.2.cmml">n</mi><mo id="Thmthm4.p1.6.6.m6.4.4.1.1.1.1" xref="Thmthm4.p1.6.6.m6.4.4.1.1.1.1.cmml">−</mo><mn id="Thmthm4.p1.6.6.m6.4.4.1.1.1.3" xref="Thmthm4.p1.6.6.m6.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm4.p1.6.6.m6.4.4.1.1.6" stretchy="false" xref="Thmthm4.p1.6.6.m6.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.6.6.m6.4b"><apply id="Thmthm4.p1.6.6.m6.4.4.cmml" xref="Thmthm4.p1.6.6.m6.4.4"><in id="Thmthm4.p1.6.6.m6.4.4.2.cmml" xref="Thmthm4.p1.6.6.m6.4.4.2"></in><ci id="Thmthm4.p1.6.6.m6.4.4.3.cmml" xref="Thmthm4.p1.6.6.m6.4.4.3">𝑖</ci><set id="Thmthm4.p1.6.6.m6.4.4.1.2.cmml" xref="Thmthm4.p1.6.6.m6.4.4.1.1"><cn id="Thmthm4.p1.6.6.m6.1.1.cmml" type="integer" xref="Thmthm4.p1.6.6.m6.1.1">0</cn><cn id="Thmthm4.p1.6.6.m6.2.2.cmml" type="integer" xref="Thmthm4.p1.6.6.m6.2.2">1</cn><ci id="Thmthm4.p1.6.6.m6.3.3.cmml" xref="Thmthm4.p1.6.6.m6.3.3">…</ci><apply id="Thmthm4.p1.6.6.m6.4.4.1.1.1.cmml" xref="Thmthm4.p1.6.6.m6.4.4.1.1.1"><minus id="Thmthm4.p1.6.6.m6.4.4.1.1.1.1.cmml" xref="Thmthm4.p1.6.6.m6.4.4.1.1.1.1"></minus><ci id="Thmthm4.p1.6.6.m6.4.4.1.1.1.2.cmml" xref="Thmthm4.p1.6.6.m6.4.4.1.1.1.2">𝑛</ci><cn id="Thmthm4.p1.6.6.m6.4.4.1.1.1.3.cmml" type="integer" xref="Thmthm4.p1.6.6.m6.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.6.6.m6.4c">i\in\{0,1,\ldots,n-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.6.6.m6.4d">italic_i ∈ { 0 , 1 , … , italic_n - 1 }</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="Thmthm4.p1.7.7.m7.1"><semantics id="Thmthm4.p1.7.7.m7.1a"><mi id="Thmthm4.p1.7.7.m7.1.1" xref="Thmthm4.p1.7.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.7.7.m7.1b"><ci id="Thmthm4.p1.7.7.m7.1.1.cmml" xref="Thmthm4.p1.7.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.7.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.7.7.m7.1d">italic_j</annotation></semantics></math> with <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="Thmthm4.p1.8.8.m8.1"><semantics id="Thmthm4.p1.8.8.m8.1a"><mrow id="Thmthm4.p1.8.8.m8.1.1" xref="Thmthm4.p1.8.8.m8.1.1.cmml"><mrow id="Thmthm4.p1.8.8.m8.1.1.2" xref="Thmthm4.p1.8.8.m8.1.1.2.cmml"><mrow id="Thmthm4.p1.8.8.m8.1.1.2.2" xref="Thmthm4.p1.8.8.m8.1.1.2.2.cmml"><mi id="Thmthm4.p1.8.8.m8.1.1.2.2.2" xref="Thmthm4.p1.8.8.m8.1.1.2.2.2.cmml">i</mi><mo id="Thmthm4.p1.8.8.m8.1.1.2.2.1" xref="Thmthm4.p1.8.8.m8.1.1.2.2.1.cmml">−</mo><mi id="Thmthm4.p1.8.8.m8.1.1.2.2.3" xref="Thmthm4.p1.8.8.m8.1.1.2.2.3.cmml">L</mi></mrow><mo id="Thmthm4.p1.8.8.m8.1.1.2.1" xref="Thmthm4.p1.8.8.m8.1.1.2.1.cmml">+</mo><mn id="Thmthm4.p1.8.8.m8.1.1.2.3" xref="Thmthm4.p1.8.8.m8.1.1.2.3.cmml">1</mn></mrow><mo id="Thmthm4.p1.8.8.m8.1.1.3" xref="Thmthm4.p1.8.8.m8.1.1.3.cmml">≤</mo><mi id="Thmthm4.p1.8.8.m8.1.1.4" xref="Thmthm4.p1.8.8.m8.1.1.4.cmml">j</mi><mo id="Thmthm4.p1.8.8.m8.1.1.5" xref="Thmthm4.p1.8.8.m8.1.1.5.cmml">≤</mo><mi id="Thmthm4.p1.8.8.m8.1.1.6" xref="Thmthm4.p1.8.8.m8.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.8.8.m8.1b"><apply id="Thmthm4.p1.8.8.m8.1.1.cmml" xref="Thmthm4.p1.8.8.m8.1.1"><and id="Thmthm4.p1.8.8.m8.1.1a.cmml" xref="Thmthm4.p1.8.8.m8.1.1"></and><apply id="Thmthm4.p1.8.8.m8.1.1b.cmml" xref="Thmthm4.p1.8.8.m8.1.1"><leq id="Thmthm4.p1.8.8.m8.1.1.3.cmml" xref="Thmthm4.p1.8.8.m8.1.1.3"></leq><apply id="Thmthm4.p1.8.8.m8.1.1.2.cmml" xref="Thmthm4.p1.8.8.m8.1.1.2"><plus id="Thmthm4.p1.8.8.m8.1.1.2.1.cmml" xref="Thmthm4.p1.8.8.m8.1.1.2.1"></plus><apply id="Thmthm4.p1.8.8.m8.1.1.2.2.cmml" xref="Thmthm4.p1.8.8.m8.1.1.2.2"><minus id="Thmthm4.p1.8.8.m8.1.1.2.2.1.cmml" xref="Thmthm4.p1.8.8.m8.1.1.2.2.1"></minus><ci id="Thmthm4.p1.8.8.m8.1.1.2.2.2.cmml" xref="Thmthm4.p1.8.8.m8.1.1.2.2.2">𝑖</ci><ci id="Thmthm4.p1.8.8.m8.1.1.2.2.3.cmml" xref="Thmthm4.p1.8.8.m8.1.1.2.2.3">𝐿</ci></apply><cn id="Thmthm4.p1.8.8.m8.1.1.2.3.cmml" type="integer" xref="Thmthm4.p1.8.8.m8.1.1.2.3">1</cn></apply><ci id="Thmthm4.p1.8.8.m8.1.1.4.cmml" xref="Thmthm4.p1.8.8.m8.1.1.4">𝑗</ci></apply><apply id="Thmthm4.p1.8.8.m8.1.1c.cmml" xref="Thmthm4.p1.8.8.m8.1.1"><leq id="Thmthm4.p1.8.8.m8.1.1.5.cmml" xref="Thmthm4.p1.8.8.m8.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#Thmthm4.p1.8.8.m8.1.1.4.cmml" id="Thmthm4.p1.8.8.m8.1.1d.cmml" xref="Thmthm4.p1.8.8.m8.1.1"></share><ci id="Thmthm4.p1.8.8.m8.1.1.6.cmml" xref="Thmthm4.p1.8.8.m8.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.8.8.m8.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.8.8.m8.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math>, setting <math alttext="i_{1}=i\pmod{L}" class="ltx_Math" display="inline" id="Thmthm4.p1.9.9.m9.2"><semantics id="Thmthm4.p1.9.9.m9.2a"><mrow id="Thmthm4.p1.9.9.m9.2.3" xref="Thmthm4.p1.9.9.m9.2.3.cmml"><msub id="Thmthm4.p1.9.9.m9.2.3.2" xref="Thmthm4.p1.9.9.m9.2.3.2.cmml"><mi id="Thmthm4.p1.9.9.m9.2.3.2.2" xref="Thmthm4.p1.9.9.m9.2.3.2.2.cmml">i</mi><mn id="Thmthm4.p1.9.9.m9.2.3.2.3" xref="Thmthm4.p1.9.9.m9.2.3.2.3.cmml">1</mn></msub><mo id="Thmthm4.p1.9.9.m9.2.3.1" xref="Thmthm4.p1.9.9.m9.2.3.1.cmml">=</mo><mrow id="Thmthm4.p1.9.9.m9.2.3.3" xref="Thmthm4.p1.9.9.m9.2.3.3.cmml"><mi id="Thmthm4.p1.9.9.m9.2.3.3.2" xref="Thmthm4.p1.9.9.m9.2.3.3.2.cmml">i</mi><mspace id="Thmthm4.p1.9.9.m9.2.3.3a" width="0.949em" xref="Thmthm4.p1.9.9.m9.2.3.3.cmml"></mspace><mrow id="Thmthm4.p1.9.9.m9.2.2.2.2" xref="Thmthm4.p1.9.9.m9.2.2.3.cmml"><mo id="Thmthm4.p1.9.9.m9.2.2.2.2.2" stretchy="false" xref="Thmthm4.p1.9.9.m9.2.2.3.1.cmml">(</mo><mrow id="Thmthm4.p1.9.9.m9.2.2.2.2.1" xref="Thmthm4.p1.9.9.m9.2.2.3.cmml"><mo id="Thmthm4.p1.9.9.m9.2.2.2.2.1.1" lspace="0em" rspace="0.167em" xref="Thmthm4.p1.9.9.m9.2.2.3.1.cmml">mod</mo><mi id="Thmthm4.p1.9.9.m9.1.1.1.1" xref="Thmthm4.p1.9.9.m9.1.1.1.1.cmml">L</mi></mrow><mo id="Thmthm4.p1.9.9.m9.2.2.2.2.3" stretchy="false" xref="Thmthm4.p1.9.9.m9.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.9.9.m9.2b"><apply id="Thmthm4.p1.9.9.m9.2.3.cmml" xref="Thmthm4.p1.9.9.m9.2.3"><eq id="Thmthm4.p1.9.9.m9.2.3.1.cmml" xref="Thmthm4.p1.9.9.m9.2.3.1"></eq><apply id="Thmthm4.p1.9.9.m9.2.3.2.cmml" xref="Thmthm4.p1.9.9.m9.2.3.2"><csymbol cd="ambiguous" id="Thmthm4.p1.9.9.m9.2.3.2.1.cmml" xref="Thmthm4.p1.9.9.m9.2.3.2">subscript</csymbol><ci id="Thmthm4.p1.9.9.m9.2.3.2.2.cmml" xref="Thmthm4.p1.9.9.m9.2.3.2.2">𝑖</ci><cn id="Thmthm4.p1.9.9.m9.2.3.2.3.cmml" type="integer" xref="Thmthm4.p1.9.9.m9.2.3.2.3">1</cn></apply><apply id="Thmthm4.p1.9.9.m9.2.3.3.cmml" xref="Thmthm4.p1.9.9.m9.2.3.3"><csymbol cd="latexml" id="Thmthm4.p1.9.9.m9.2.3.3.1.cmml" xref="Thmthm4.p1.9.9.m9.2.3.3">annotated</csymbol><ci id="Thmthm4.p1.9.9.m9.2.3.3.2.cmml" xref="Thmthm4.p1.9.9.m9.2.3.3.2">𝑖</ci><apply id="Thmthm4.p1.9.9.m9.2.2.3.cmml" xref="Thmthm4.p1.9.9.m9.2.2.2.2"><ci id="Thmthm4.p1.9.9.m9.2.2.3.1.cmml" xref="Thmthm4.p1.9.9.m9.2.2.2.2.2">𝑝𝑚𝑜𝑑</ci><ci id="Thmthm4.p1.9.9.m9.1.1.1.1.cmml" xref="Thmthm4.p1.9.9.m9.1.1.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.9.9.m9.2c">i_{1}=i\pmod{L}</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.9.9.m9.2d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_i start_MODIFIER ( roman_mod start_ARG italic_L end_ARG ) end_MODIFIER</annotation></semantics></math>, <math alttext="r=(i-i_{1})/L" class="ltx_Math" display="inline" id="Thmthm4.p1.10.10.m10.1"><semantics id="Thmthm4.p1.10.10.m10.1a"><mrow id="Thmthm4.p1.10.10.m10.1.1" xref="Thmthm4.p1.10.10.m10.1.1.cmml"><mi id="Thmthm4.p1.10.10.m10.1.1.3" xref="Thmthm4.p1.10.10.m10.1.1.3.cmml">r</mi><mo id="Thmthm4.p1.10.10.m10.1.1.2" xref="Thmthm4.p1.10.10.m10.1.1.2.cmml">=</mo><mrow id="Thmthm4.p1.10.10.m10.1.1.1" xref="Thmthm4.p1.10.10.m10.1.1.1.cmml"><mrow id="Thmthm4.p1.10.10.m10.1.1.1.1.1" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.cmml"><mo id="Thmthm4.p1.10.10.m10.1.1.1.1.1.2" stretchy="false" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.cmml"><mi id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.2" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.2.cmml">i</mi><mo id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.1" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.1.cmml">−</mo><msub id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.cmml"><mi id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.2" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.2.cmml">i</mi><mn id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.3" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="Thmthm4.p1.10.10.m10.1.1.1.1.1.3" stretchy="false" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmthm4.p1.10.10.m10.1.1.1.2" xref="Thmthm4.p1.10.10.m10.1.1.1.2.cmml">/</mo><mi id="Thmthm4.p1.10.10.m10.1.1.1.3" xref="Thmthm4.p1.10.10.m10.1.1.1.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.10.10.m10.1b"><apply id="Thmthm4.p1.10.10.m10.1.1.cmml" xref="Thmthm4.p1.10.10.m10.1.1"><eq id="Thmthm4.p1.10.10.m10.1.1.2.cmml" xref="Thmthm4.p1.10.10.m10.1.1.2"></eq><ci id="Thmthm4.p1.10.10.m10.1.1.3.cmml" xref="Thmthm4.p1.10.10.m10.1.1.3">𝑟</ci><apply id="Thmthm4.p1.10.10.m10.1.1.1.cmml" xref="Thmthm4.p1.10.10.m10.1.1.1"><divide id="Thmthm4.p1.10.10.m10.1.1.1.2.cmml" xref="Thmthm4.p1.10.10.m10.1.1.1.2"></divide><apply id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.cmml" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1"><minus id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.1.cmml" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.1"></minus><ci id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.2.cmml" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.2">𝑖</ci><apply id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.cmml" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.1.cmml" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3">subscript</csymbol><ci id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.2.cmml" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.2">𝑖</ci><cn id="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.3.cmml" type="integer" xref="Thmthm4.p1.10.10.m10.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="Thmthm4.p1.10.10.m10.1.1.1.3.cmml" xref="Thmthm4.p1.10.10.m10.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.10.10.m10.1c">r=(i-i_{1})/L</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.10.10.m10.1d">italic_r = ( italic_i - italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) / italic_L</annotation></semantics></math> and <math alttext="j_{1}=j-(r-1)L-1" class="ltx_Math" display="inline" id="Thmthm4.p1.11.11.m11.1"><semantics id="Thmthm4.p1.11.11.m11.1a"><mrow id="Thmthm4.p1.11.11.m11.1.1" xref="Thmthm4.p1.11.11.m11.1.1.cmml"><msub id="Thmthm4.p1.11.11.m11.1.1.3" xref="Thmthm4.p1.11.11.m11.1.1.3.cmml"><mi id="Thmthm4.p1.11.11.m11.1.1.3.2" xref="Thmthm4.p1.11.11.m11.1.1.3.2.cmml">j</mi><mn id="Thmthm4.p1.11.11.m11.1.1.3.3" xref="Thmthm4.p1.11.11.m11.1.1.3.3.cmml">1</mn></msub><mo id="Thmthm4.p1.11.11.m11.1.1.2" xref="Thmthm4.p1.11.11.m11.1.1.2.cmml">=</mo><mrow id="Thmthm4.p1.11.11.m11.1.1.1" xref="Thmthm4.p1.11.11.m11.1.1.1.cmml"><mi id="Thmthm4.p1.11.11.m11.1.1.1.3" xref="Thmthm4.p1.11.11.m11.1.1.1.3.cmml">j</mi><mo id="Thmthm4.p1.11.11.m11.1.1.1.2" xref="Thmthm4.p1.11.11.m11.1.1.1.2.cmml">−</mo><mrow id="Thmthm4.p1.11.11.m11.1.1.1.1" xref="Thmthm4.p1.11.11.m11.1.1.1.1.cmml"><mrow id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.cmml"><mo id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.2" stretchy="false" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.cmml"><mi id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.2" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.1" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.3" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.3" stretchy="false" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmthm4.p1.11.11.m11.1.1.1.1.2" xref="Thmthm4.p1.11.11.m11.1.1.1.1.2.cmml">⁢</mo><mi id="Thmthm4.p1.11.11.m11.1.1.1.1.3" xref="Thmthm4.p1.11.11.m11.1.1.1.1.3.cmml">L</mi></mrow><mo id="Thmthm4.p1.11.11.m11.1.1.1.2a" xref="Thmthm4.p1.11.11.m11.1.1.1.2.cmml">−</mo><mn id="Thmthm4.p1.11.11.m11.1.1.1.4" xref="Thmthm4.p1.11.11.m11.1.1.1.4.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.11.11.m11.1b"><apply id="Thmthm4.p1.11.11.m11.1.1.cmml" xref="Thmthm4.p1.11.11.m11.1.1"><eq id="Thmthm4.p1.11.11.m11.1.1.2.cmml" xref="Thmthm4.p1.11.11.m11.1.1.2"></eq><apply id="Thmthm4.p1.11.11.m11.1.1.3.cmml" xref="Thmthm4.p1.11.11.m11.1.1.3"><csymbol cd="ambiguous" id="Thmthm4.p1.11.11.m11.1.1.3.1.cmml" xref="Thmthm4.p1.11.11.m11.1.1.3">subscript</csymbol><ci id="Thmthm4.p1.11.11.m11.1.1.3.2.cmml" xref="Thmthm4.p1.11.11.m11.1.1.3.2">𝑗</ci><cn id="Thmthm4.p1.11.11.m11.1.1.3.3.cmml" type="integer" xref="Thmthm4.p1.11.11.m11.1.1.3.3">1</cn></apply><apply id="Thmthm4.p1.11.11.m11.1.1.1.cmml" xref="Thmthm4.p1.11.11.m11.1.1.1"><minus id="Thmthm4.p1.11.11.m11.1.1.1.2.cmml" xref="Thmthm4.p1.11.11.m11.1.1.1.2"></minus><ci id="Thmthm4.p1.11.11.m11.1.1.1.3.cmml" xref="Thmthm4.p1.11.11.m11.1.1.1.3">𝑗</ci><apply id="Thmthm4.p1.11.11.m11.1.1.1.1.cmml" xref="Thmthm4.p1.11.11.m11.1.1.1.1"><times id="Thmthm4.p1.11.11.m11.1.1.1.1.2.cmml" xref="Thmthm4.p1.11.11.m11.1.1.1.1.2"></times><apply id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.cmml" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1"><minus id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.1.cmml" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.1"></minus><ci id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.2.cmml" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.2">𝑟</ci><cn id="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmthm4.p1.11.11.m11.1.1.1.1.1.1.1.3">1</cn></apply><ci id="Thmthm4.p1.11.11.m11.1.1.1.1.3.cmml" xref="Thmthm4.p1.11.11.m11.1.1.1.1.3">𝐿</ci></apply><cn id="Thmthm4.p1.11.11.m11.1.1.1.4.cmml" type="integer" xref="Thmthm4.p1.11.11.m11.1.1.1.4">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.11.11.m11.1c">j_{1}=j-(r-1)L-1</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.11.11.m11.1d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_j - ( italic_r - 1 ) italic_L - 1</annotation></semantics></math>, we have <math alttext="S[i,j]=T_{S}[r,i_{1},j_{1}]" class="ltx_Math" display="inline" id="Thmthm4.p1.12.12.m12.5"><semantics id="Thmthm4.p1.12.12.m12.5a"><mrow id="Thmthm4.p1.12.12.m12.5.5" xref="Thmthm4.p1.12.12.m12.5.5.cmml"><mrow id="Thmthm4.p1.12.12.m12.5.5.4" xref="Thmthm4.p1.12.12.m12.5.5.4.cmml"><mi id="Thmthm4.p1.12.12.m12.5.5.4.2" xref="Thmthm4.p1.12.12.m12.5.5.4.2.cmml">S</mi><mo id="Thmthm4.p1.12.12.m12.5.5.4.1" xref="Thmthm4.p1.12.12.m12.5.5.4.1.cmml">⁢</mo><mrow id="Thmthm4.p1.12.12.m12.5.5.4.3.2" xref="Thmthm4.p1.12.12.m12.5.5.4.3.1.cmml"><mo id="Thmthm4.p1.12.12.m12.5.5.4.3.2.1" stretchy="false" xref="Thmthm4.p1.12.12.m12.5.5.4.3.1.cmml">[</mo><mi id="Thmthm4.p1.12.12.m12.1.1" xref="Thmthm4.p1.12.12.m12.1.1.cmml">i</mi><mo id="Thmthm4.p1.12.12.m12.5.5.4.3.2.2" xref="Thmthm4.p1.12.12.m12.5.5.4.3.1.cmml">,</mo><mi id="Thmthm4.p1.12.12.m12.2.2" xref="Thmthm4.p1.12.12.m12.2.2.cmml">j</mi><mo id="Thmthm4.p1.12.12.m12.5.5.4.3.2.3" stretchy="false" xref="Thmthm4.p1.12.12.m12.5.5.4.3.1.cmml">]</mo></mrow></mrow><mo id="Thmthm4.p1.12.12.m12.5.5.3" xref="Thmthm4.p1.12.12.m12.5.5.3.cmml">=</mo><mrow id="Thmthm4.p1.12.12.m12.5.5.2" xref="Thmthm4.p1.12.12.m12.5.5.2.cmml"><msub id="Thmthm4.p1.12.12.m12.5.5.2.4" xref="Thmthm4.p1.12.12.m12.5.5.2.4.cmml"><mi id="Thmthm4.p1.12.12.m12.5.5.2.4.2" xref="Thmthm4.p1.12.12.m12.5.5.2.4.2.cmml">T</mi><mi id="Thmthm4.p1.12.12.m12.5.5.2.4.3" xref="Thmthm4.p1.12.12.m12.5.5.2.4.3.cmml">S</mi></msub><mo id="Thmthm4.p1.12.12.m12.5.5.2.3" xref="Thmthm4.p1.12.12.m12.5.5.2.3.cmml">⁢</mo><mrow id="Thmthm4.p1.12.12.m12.5.5.2.2.2" xref="Thmthm4.p1.12.12.m12.5.5.2.2.3.cmml"><mo id="Thmthm4.p1.12.12.m12.5.5.2.2.2.3" stretchy="false" xref="Thmthm4.p1.12.12.m12.5.5.2.2.3.cmml">[</mo><mi id="Thmthm4.p1.12.12.m12.3.3" xref="Thmthm4.p1.12.12.m12.3.3.cmml">r</mi><mo id="Thmthm4.p1.12.12.m12.5.5.2.2.2.4" xref="Thmthm4.p1.12.12.m12.5.5.2.2.3.cmml">,</mo><msub id="Thmthm4.p1.12.12.m12.4.4.1.1.1.1" xref="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.cmml"><mi id="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.2" xref="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.2.cmml">i</mi><mn id="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.3" xref="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmthm4.p1.12.12.m12.5.5.2.2.2.5" xref="Thmthm4.p1.12.12.m12.5.5.2.2.3.cmml">,</mo><msub id="Thmthm4.p1.12.12.m12.5.5.2.2.2.2" xref="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.cmml"><mi id="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.2" xref="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.2.cmml">j</mi><mn id="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.3" xref="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.3.cmml">1</mn></msub><mo id="Thmthm4.p1.12.12.m12.5.5.2.2.2.6" stretchy="false" xref="Thmthm4.p1.12.12.m12.5.5.2.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.12.12.m12.5b"><apply id="Thmthm4.p1.12.12.m12.5.5.cmml" xref="Thmthm4.p1.12.12.m12.5.5"><eq id="Thmthm4.p1.12.12.m12.5.5.3.cmml" xref="Thmthm4.p1.12.12.m12.5.5.3"></eq><apply id="Thmthm4.p1.12.12.m12.5.5.4.cmml" xref="Thmthm4.p1.12.12.m12.5.5.4"><times id="Thmthm4.p1.12.12.m12.5.5.4.1.cmml" xref="Thmthm4.p1.12.12.m12.5.5.4.1"></times><ci id="Thmthm4.p1.12.12.m12.5.5.4.2.cmml" xref="Thmthm4.p1.12.12.m12.5.5.4.2">𝑆</ci><interval closure="closed" id="Thmthm4.p1.12.12.m12.5.5.4.3.1.cmml" xref="Thmthm4.p1.12.12.m12.5.5.4.3.2"><ci id="Thmthm4.p1.12.12.m12.1.1.cmml" xref="Thmthm4.p1.12.12.m12.1.1">𝑖</ci><ci id="Thmthm4.p1.12.12.m12.2.2.cmml" xref="Thmthm4.p1.12.12.m12.2.2">𝑗</ci></interval></apply><apply id="Thmthm4.p1.12.12.m12.5.5.2.cmml" xref="Thmthm4.p1.12.12.m12.5.5.2"><times id="Thmthm4.p1.12.12.m12.5.5.2.3.cmml" xref="Thmthm4.p1.12.12.m12.5.5.2.3"></times><apply id="Thmthm4.p1.12.12.m12.5.5.2.4.cmml" xref="Thmthm4.p1.12.12.m12.5.5.2.4"><csymbol cd="ambiguous" id="Thmthm4.p1.12.12.m12.5.5.2.4.1.cmml" xref="Thmthm4.p1.12.12.m12.5.5.2.4">subscript</csymbol><ci id="Thmthm4.p1.12.12.m12.5.5.2.4.2.cmml" xref="Thmthm4.p1.12.12.m12.5.5.2.4.2">𝑇</ci><ci id="Thmthm4.p1.12.12.m12.5.5.2.4.3.cmml" xref="Thmthm4.p1.12.12.m12.5.5.2.4.3">𝑆</ci></apply><list id="Thmthm4.p1.12.12.m12.5.5.2.2.3.cmml" xref="Thmthm4.p1.12.12.m12.5.5.2.2.2"><ci id="Thmthm4.p1.12.12.m12.3.3.cmml" xref="Thmthm4.p1.12.12.m12.3.3">𝑟</ci><apply id="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.cmml" xref="Thmthm4.p1.12.12.m12.4.4.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.1.cmml" xref="Thmthm4.p1.12.12.m12.4.4.1.1.1.1">subscript</csymbol><ci id="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.2.cmml" xref="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.2">𝑖</ci><cn id="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.3.cmml" type="integer" xref="Thmthm4.p1.12.12.m12.4.4.1.1.1.1.3">1</cn></apply><apply id="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.cmml" xref="Thmthm4.p1.12.12.m12.5.5.2.2.2.2"><csymbol cd="ambiguous" id="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.1.cmml" xref="Thmthm4.p1.12.12.m12.5.5.2.2.2.2">subscript</csymbol><ci id="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.2.cmml" xref="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.2">𝑗</ci><cn id="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.3.cmml" type="integer" xref="Thmthm4.p1.12.12.m12.5.5.2.2.2.2.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.12.12.m12.5c">S[i,j]=T_{S}[r,i_{1},j_{1}]</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.12.12.m12.5d">italic_S [ italic_i , italic_j ] = italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>. Moreover, all the other entries of <math alttext="S" class="ltx_Math" display="inline" id="Thmthm4.p1.13.13.m13.1"><semantics id="Thmthm4.p1.13.13.m13.1a"><mi id="Thmthm4.p1.13.13.m13.1.1" xref="Thmthm4.p1.13.13.m13.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.13.13.m13.1b"><ci id="Thmthm4.p1.13.13.m13.1.1.cmml" xref="Thmthm4.p1.13.13.m13.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.13.13.m13.1c">S</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.13.13.m13.1d">italic_S</annotation></semantics></math> and <math alttext="T_{A}" class="ltx_Math" display="inline" id="Thmthm4.p1.14.14.m14.1"><semantics id="Thmthm4.p1.14.14.m14.1a"><msub id="Thmthm4.p1.14.14.m14.1.1" xref="Thmthm4.p1.14.14.m14.1.1.cmml"><mi id="Thmthm4.p1.14.14.m14.1.1.2" xref="Thmthm4.p1.14.14.m14.1.1.2.cmml">T</mi><mi id="Thmthm4.p1.14.14.m14.1.1.3" xref="Thmthm4.p1.14.14.m14.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="Thmthm4.p1.14.14.m14.1b"><apply id="Thmthm4.p1.14.14.m14.1.1.cmml" xref="Thmthm4.p1.14.14.m14.1.1"><csymbol cd="ambiguous" id="Thmthm4.p1.14.14.m14.1.1.1.cmml" xref="Thmthm4.p1.14.14.m14.1.1">subscript</csymbol><ci id="Thmthm4.p1.14.14.m14.1.1.2.cmml" xref="Thmthm4.p1.14.14.m14.1.1.2">𝑇</ci><ci id="Thmthm4.p1.14.14.m14.1.1.3.cmml" xref="Thmthm4.p1.14.14.m14.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm4.p1.14.14.m14.1c">T_{A}</annotation><annotation encoding="application/x-llamapun" id="Thmthm4.p1.14.14.m14.1d">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math> are zero.</span></p>
</div>
</div>
<div class="ltx_proof" id="S3.3">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.3.p1">
<p class="ltx_p" id="S3.3.p1.6">The dimensions of <math alttext="T_{S}" class="ltx_Math" display="inline" id="S3.3.p1.1.m1.1"><semantics id="S3.3.p1.1.m1.1a"><msub id="S3.3.p1.1.m1.1.1" xref="S3.3.p1.1.m1.1.1.cmml"><mi id="S3.3.p1.1.m1.1.1.2" xref="S3.3.p1.1.m1.1.1.2.cmml">T</mi><mi id="S3.3.p1.1.m1.1.1.3" xref="S3.3.p1.1.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S3.3.p1.1.m1.1b"><apply id="S3.3.p1.1.m1.1.1.cmml" xref="S3.3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.3.p1.1.m1.1.1.1.cmml" xref="S3.3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.3.p1.1.m1.1.1.2.cmml" xref="S3.3.p1.1.m1.1.1.2">𝑇</ci><ci id="S3.3.p1.1.m1.1.1.3.cmml" xref="S3.3.p1.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.1.m1.1c">T_{S}</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> follow from the dimensions of <math alttext="T_{A}=T_{Q}T_{K}^{T}" class="ltx_Math" display="inline" id="S3.3.p1.2.m2.1"><semantics id="S3.3.p1.2.m2.1a"><mrow id="S3.3.p1.2.m2.1.1" xref="S3.3.p1.2.m2.1.1.cmml"><msub id="S3.3.p1.2.m2.1.1.2" xref="S3.3.p1.2.m2.1.1.2.cmml"><mi id="S3.3.p1.2.m2.1.1.2.2" xref="S3.3.p1.2.m2.1.1.2.2.cmml">T</mi><mi id="S3.3.p1.2.m2.1.1.2.3" xref="S3.3.p1.2.m2.1.1.2.3.cmml">A</mi></msub><mo id="S3.3.p1.2.m2.1.1.1" xref="S3.3.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S3.3.p1.2.m2.1.1.3" xref="S3.3.p1.2.m2.1.1.3.cmml"><msub id="S3.3.p1.2.m2.1.1.3.2" xref="S3.3.p1.2.m2.1.1.3.2.cmml"><mi id="S3.3.p1.2.m2.1.1.3.2.2" xref="S3.3.p1.2.m2.1.1.3.2.2.cmml">T</mi><mi id="S3.3.p1.2.m2.1.1.3.2.3" xref="S3.3.p1.2.m2.1.1.3.2.3.cmml">Q</mi></msub><mo id="S3.3.p1.2.m2.1.1.3.1" xref="S3.3.p1.2.m2.1.1.3.1.cmml">⁢</mo><msubsup id="S3.3.p1.2.m2.1.1.3.3" xref="S3.3.p1.2.m2.1.1.3.3.cmml"><mi id="S3.3.p1.2.m2.1.1.3.3.2.2" xref="S3.3.p1.2.m2.1.1.3.3.2.2.cmml">T</mi><mi id="S3.3.p1.2.m2.1.1.3.3.2.3" xref="S3.3.p1.2.m2.1.1.3.3.2.3.cmml">K</mi><mi id="S3.3.p1.2.m2.1.1.3.3.3" xref="S3.3.p1.2.m2.1.1.3.3.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.2.m2.1b"><apply id="S3.3.p1.2.m2.1.1.cmml" xref="S3.3.p1.2.m2.1.1"><eq id="S3.3.p1.2.m2.1.1.1.cmml" xref="S3.3.p1.2.m2.1.1.1"></eq><apply id="S3.3.p1.2.m2.1.1.2.cmml" xref="S3.3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.3.p1.2.m2.1.1.2.1.cmml" xref="S3.3.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.3.p1.2.m2.1.1.2.2.cmml" xref="S3.3.p1.2.m2.1.1.2.2">𝑇</ci><ci id="S3.3.p1.2.m2.1.1.2.3.cmml" xref="S3.3.p1.2.m2.1.1.2.3">𝐴</ci></apply><apply id="S3.3.p1.2.m2.1.1.3.cmml" xref="S3.3.p1.2.m2.1.1.3"><times id="S3.3.p1.2.m2.1.1.3.1.cmml" xref="S3.3.p1.2.m2.1.1.3.1"></times><apply id="S3.3.p1.2.m2.1.1.3.2.cmml" xref="S3.3.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.3.p1.2.m2.1.1.3.2.1.cmml" xref="S3.3.p1.2.m2.1.1.3.2">subscript</csymbol><ci id="S3.3.p1.2.m2.1.1.3.2.2.cmml" xref="S3.3.p1.2.m2.1.1.3.2.2">𝑇</ci><ci id="S3.3.p1.2.m2.1.1.3.2.3.cmml" xref="S3.3.p1.2.m2.1.1.3.2.3">𝑄</ci></apply><apply id="S3.3.p1.2.m2.1.1.3.3.cmml" xref="S3.3.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.3.p1.2.m2.1.1.3.3.1.cmml" xref="S3.3.p1.2.m2.1.1.3.3">superscript</csymbol><apply id="S3.3.p1.2.m2.1.1.3.3.2.cmml" xref="S3.3.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.3.p1.2.m2.1.1.3.3.2.1.cmml" xref="S3.3.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="S3.3.p1.2.m2.1.1.3.3.2.2.cmml" xref="S3.3.p1.2.m2.1.1.3.3.2.2">𝑇</ci><ci id="S3.3.p1.2.m2.1.1.3.3.2.3.cmml" xref="S3.3.p1.2.m2.1.1.3.3.2.3">𝐾</ci></apply><ci id="S3.3.p1.2.m2.1.1.3.3.3.cmml" xref="S3.3.p1.2.m2.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.2.m2.1c">T_{A}=T_{Q}T_{K}^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT = italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, see Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm3" title="Lemma 3. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">3</span></a>. Let <math alttext="i,j\in\{0,1,\ldots,n-1\}" class="ltx_Math" display="inline" id="S3.3.p1.3.m3.6"><semantics id="S3.3.p1.3.m3.6a"><mrow id="S3.3.p1.3.m3.6.6" xref="S3.3.p1.3.m3.6.6.cmml"><mrow id="S3.3.p1.3.m3.6.6.3.2" xref="S3.3.p1.3.m3.6.6.3.1.cmml"><mi id="S3.3.p1.3.m3.4.4" xref="S3.3.p1.3.m3.4.4.cmml">i</mi><mo id="S3.3.p1.3.m3.6.6.3.2.1" xref="S3.3.p1.3.m3.6.6.3.1.cmml">,</mo><mi id="S3.3.p1.3.m3.5.5" xref="S3.3.p1.3.m3.5.5.cmml">j</mi></mrow><mo id="S3.3.p1.3.m3.6.6.2" xref="S3.3.p1.3.m3.6.6.2.cmml">∈</mo><mrow id="S3.3.p1.3.m3.6.6.1.1" xref="S3.3.p1.3.m3.6.6.1.2.cmml"><mo id="S3.3.p1.3.m3.6.6.1.1.2" stretchy="false" xref="S3.3.p1.3.m3.6.6.1.2.cmml">{</mo><mn id="S3.3.p1.3.m3.1.1" xref="S3.3.p1.3.m3.1.1.cmml">0</mn><mo id="S3.3.p1.3.m3.6.6.1.1.3" xref="S3.3.p1.3.m3.6.6.1.2.cmml">,</mo><mn id="S3.3.p1.3.m3.2.2" xref="S3.3.p1.3.m3.2.2.cmml">1</mn><mo id="S3.3.p1.3.m3.6.6.1.1.4" xref="S3.3.p1.3.m3.6.6.1.2.cmml">,</mo><mi id="S3.3.p1.3.m3.3.3" mathvariant="normal" xref="S3.3.p1.3.m3.3.3.cmml">…</mi><mo id="S3.3.p1.3.m3.6.6.1.1.5" xref="S3.3.p1.3.m3.6.6.1.2.cmml">,</mo><mrow id="S3.3.p1.3.m3.6.6.1.1.1" xref="S3.3.p1.3.m3.6.6.1.1.1.cmml"><mi id="S3.3.p1.3.m3.6.6.1.1.1.2" xref="S3.3.p1.3.m3.6.6.1.1.1.2.cmml">n</mi><mo id="S3.3.p1.3.m3.6.6.1.1.1.1" xref="S3.3.p1.3.m3.6.6.1.1.1.1.cmml">−</mo><mn id="S3.3.p1.3.m3.6.6.1.1.1.3" xref="S3.3.p1.3.m3.6.6.1.1.1.3.cmml">1</mn></mrow><mo id="S3.3.p1.3.m3.6.6.1.1.6" stretchy="false" xref="S3.3.p1.3.m3.6.6.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.3.m3.6b"><apply id="S3.3.p1.3.m3.6.6.cmml" xref="S3.3.p1.3.m3.6.6"><in id="S3.3.p1.3.m3.6.6.2.cmml" xref="S3.3.p1.3.m3.6.6.2"></in><list id="S3.3.p1.3.m3.6.6.3.1.cmml" xref="S3.3.p1.3.m3.6.6.3.2"><ci id="S3.3.p1.3.m3.4.4.cmml" xref="S3.3.p1.3.m3.4.4">𝑖</ci><ci id="S3.3.p1.3.m3.5.5.cmml" xref="S3.3.p1.3.m3.5.5">𝑗</ci></list><set id="S3.3.p1.3.m3.6.6.1.2.cmml" xref="S3.3.p1.3.m3.6.6.1.1"><cn id="S3.3.p1.3.m3.1.1.cmml" type="integer" xref="S3.3.p1.3.m3.1.1">0</cn><cn id="S3.3.p1.3.m3.2.2.cmml" type="integer" xref="S3.3.p1.3.m3.2.2">1</cn><ci id="S3.3.p1.3.m3.3.3.cmml" xref="S3.3.p1.3.m3.3.3">…</ci><apply id="S3.3.p1.3.m3.6.6.1.1.1.cmml" xref="S3.3.p1.3.m3.6.6.1.1.1"><minus id="S3.3.p1.3.m3.6.6.1.1.1.1.cmml" xref="S3.3.p1.3.m3.6.6.1.1.1.1"></minus><ci id="S3.3.p1.3.m3.6.6.1.1.1.2.cmml" xref="S3.3.p1.3.m3.6.6.1.1.1.2">𝑛</ci><cn id="S3.3.p1.3.m3.6.6.1.1.1.3.cmml" type="integer" xref="S3.3.p1.3.m3.6.6.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.3.m3.6c">i,j\in\{0,1,\ldots,n-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.3.m3.6d">italic_i , italic_j ∈ { 0 , 1 , … , italic_n - 1 }</annotation></semantics></math>. We consider the change of variables <math alttext="i_{1}=i\pmod{L}" class="ltx_Math" display="inline" id="S3.3.p1.4.m4.2"><semantics id="S3.3.p1.4.m4.2a"><mrow id="S3.3.p1.4.m4.2.3" xref="S3.3.p1.4.m4.2.3.cmml"><msub id="S3.3.p1.4.m4.2.3.2" xref="S3.3.p1.4.m4.2.3.2.cmml"><mi id="S3.3.p1.4.m4.2.3.2.2" xref="S3.3.p1.4.m4.2.3.2.2.cmml">i</mi><mn id="S3.3.p1.4.m4.2.3.2.3" xref="S3.3.p1.4.m4.2.3.2.3.cmml">1</mn></msub><mo id="S3.3.p1.4.m4.2.3.1" xref="S3.3.p1.4.m4.2.3.1.cmml">=</mo><mrow id="S3.3.p1.4.m4.2.3.3" xref="S3.3.p1.4.m4.2.3.3.cmml"><mi id="S3.3.p1.4.m4.2.3.3.2" xref="S3.3.p1.4.m4.2.3.3.2.cmml">i</mi><mspace id="S3.3.p1.4.m4.2.3.3a" width="0.949em" xref="S3.3.p1.4.m4.2.3.3.cmml"></mspace><mrow id="S3.3.p1.4.m4.2.2.2.2" xref="S3.3.p1.4.m4.2.2.3.cmml"><mo id="S3.3.p1.4.m4.2.2.2.2.2" stretchy="false" xref="S3.3.p1.4.m4.2.2.3.1.cmml">(</mo><mrow id="S3.3.p1.4.m4.2.2.2.2.1" xref="S3.3.p1.4.m4.2.2.3.cmml"><mo id="S3.3.p1.4.m4.2.2.2.2.1.1" lspace="0em" rspace="0.167em" xref="S3.3.p1.4.m4.2.2.3.1.cmml">mod</mo><mi id="S3.3.p1.4.m4.1.1.1.1" xref="S3.3.p1.4.m4.1.1.1.1.cmml">L</mi></mrow><mo id="S3.3.p1.4.m4.2.2.2.2.3" stretchy="false" xref="S3.3.p1.4.m4.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.4.m4.2b"><apply id="S3.3.p1.4.m4.2.3.cmml" xref="S3.3.p1.4.m4.2.3"><eq id="S3.3.p1.4.m4.2.3.1.cmml" xref="S3.3.p1.4.m4.2.3.1"></eq><apply id="S3.3.p1.4.m4.2.3.2.cmml" xref="S3.3.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="S3.3.p1.4.m4.2.3.2.1.cmml" xref="S3.3.p1.4.m4.2.3.2">subscript</csymbol><ci id="S3.3.p1.4.m4.2.3.2.2.cmml" xref="S3.3.p1.4.m4.2.3.2.2">𝑖</ci><cn id="S3.3.p1.4.m4.2.3.2.3.cmml" type="integer" xref="S3.3.p1.4.m4.2.3.2.3">1</cn></apply><apply id="S3.3.p1.4.m4.2.3.3.cmml" xref="S3.3.p1.4.m4.2.3.3"><csymbol cd="latexml" id="S3.3.p1.4.m4.2.3.3.1.cmml" xref="S3.3.p1.4.m4.2.3.3">annotated</csymbol><ci id="S3.3.p1.4.m4.2.3.3.2.cmml" xref="S3.3.p1.4.m4.2.3.3.2">𝑖</ci><apply id="S3.3.p1.4.m4.2.2.3.cmml" xref="S3.3.p1.4.m4.2.2.2.2"><ci id="S3.3.p1.4.m4.2.2.3.1.cmml" xref="S3.3.p1.4.m4.2.2.2.2.2">pmod</ci><ci id="S3.3.p1.4.m4.1.1.1.1.cmml" xref="S3.3.p1.4.m4.1.1.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.4.m4.2c">i_{1}=i\pmod{L}</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.4.m4.2d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_i start_MODIFIER ( roman_mod start_ARG italic_L end_ARG ) end_MODIFIER</annotation></semantics></math>, <math alttext="r=(i-i_{1})/L" class="ltx_Math" display="inline" id="S3.3.p1.5.m5.1"><semantics id="S3.3.p1.5.m5.1a"><mrow id="S3.3.p1.5.m5.1.1" xref="S3.3.p1.5.m5.1.1.cmml"><mi id="S3.3.p1.5.m5.1.1.3" xref="S3.3.p1.5.m5.1.1.3.cmml">r</mi><mo id="S3.3.p1.5.m5.1.1.2" xref="S3.3.p1.5.m5.1.1.2.cmml">=</mo><mrow id="S3.3.p1.5.m5.1.1.1" xref="S3.3.p1.5.m5.1.1.1.cmml"><mrow id="S3.3.p1.5.m5.1.1.1.1.1" xref="S3.3.p1.5.m5.1.1.1.1.1.1.cmml"><mo id="S3.3.p1.5.m5.1.1.1.1.1.2" stretchy="false" xref="S3.3.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.3.p1.5.m5.1.1.1.1.1.1" xref="S3.3.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="S3.3.p1.5.m5.1.1.1.1.1.1.2" xref="S3.3.p1.5.m5.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.3.p1.5.m5.1.1.1.1.1.1.1" xref="S3.3.p1.5.m5.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.3.p1.5.m5.1.1.1.1.1.1.3" xref="S3.3.p1.5.m5.1.1.1.1.1.1.3.cmml"><mi id="S3.3.p1.5.m5.1.1.1.1.1.1.3.2" xref="S3.3.p1.5.m5.1.1.1.1.1.1.3.2.cmml">i</mi><mn id="S3.3.p1.5.m5.1.1.1.1.1.1.3.3" xref="S3.3.p1.5.m5.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.3.p1.5.m5.1.1.1.1.1.3" stretchy="false" xref="S3.3.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.3.p1.5.m5.1.1.1.2" xref="S3.3.p1.5.m5.1.1.1.2.cmml">/</mo><mi id="S3.3.p1.5.m5.1.1.1.3" xref="S3.3.p1.5.m5.1.1.1.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.5.m5.1b"><apply id="S3.3.p1.5.m5.1.1.cmml" xref="S3.3.p1.5.m5.1.1"><eq id="S3.3.p1.5.m5.1.1.2.cmml" xref="S3.3.p1.5.m5.1.1.2"></eq><ci id="S3.3.p1.5.m5.1.1.3.cmml" xref="S3.3.p1.5.m5.1.1.3">𝑟</ci><apply id="S3.3.p1.5.m5.1.1.1.cmml" xref="S3.3.p1.5.m5.1.1.1"><divide id="S3.3.p1.5.m5.1.1.1.2.cmml" xref="S3.3.p1.5.m5.1.1.1.2"></divide><apply id="S3.3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.3.p1.5.m5.1.1.1.1.1"><minus id="S3.3.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.3.p1.5.m5.1.1.1.1.1.1.1"></minus><ci id="S3.3.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.3.p1.5.m5.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.3.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.3.p1.5.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.3.p1.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S3.3.p1.5.m5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.3.p1.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S3.3.p1.5.m5.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.3.p1.5.m5.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.3.p1.5.m5.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.3.p1.5.m5.1.1.1.3.cmml" xref="S3.3.p1.5.m5.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.5.m5.1c">r=(i-i_{1})/L</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.5.m5.1d">italic_r = ( italic_i - italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) / italic_L</annotation></semantics></math> and <math alttext="j_{1}=j-(r-1)L-1" class="ltx_Math" display="inline" id="S3.3.p1.6.m6.1"><semantics id="S3.3.p1.6.m6.1a"><mrow id="S3.3.p1.6.m6.1.1" xref="S3.3.p1.6.m6.1.1.cmml"><msub id="S3.3.p1.6.m6.1.1.3" xref="S3.3.p1.6.m6.1.1.3.cmml"><mi id="S3.3.p1.6.m6.1.1.3.2" xref="S3.3.p1.6.m6.1.1.3.2.cmml">j</mi><mn id="S3.3.p1.6.m6.1.1.3.3" xref="S3.3.p1.6.m6.1.1.3.3.cmml">1</mn></msub><mo id="S3.3.p1.6.m6.1.1.2" xref="S3.3.p1.6.m6.1.1.2.cmml">=</mo><mrow id="S3.3.p1.6.m6.1.1.1" xref="S3.3.p1.6.m6.1.1.1.cmml"><mi id="S3.3.p1.6.m6.1.1.1.3" xref="S3.3.p1.6.m6.1.1.1.3.cmml">j</mi><mo id="S3.3.p1.6.m6.1.1.1.2" xref="S3.3.p1.6.m6.1.1.1.2.cmml">−</mo><mrow id="S3.3.p1.6.m6.1.1.1.1" xref="S3.3.p1.6.m6.1.1.1.1.cmml"><mrow id="S3.3.p1.6.m6.1.1.1.1.1.1" xref="S3.3.p1.6.m6.1.1.1.1.1.1.1.cmml"><mo id="S3.3.p1.6.m6.1.1.1.1.1.1.2" stretchy="false" xref="S3.3.p1.6.m6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.3.p1.6.m6.1.1.1.1.1.1.1" xref="S3.3.p1.6.m6.1.1.1.1.1.1.1.cmml"><mi id="S3.3.p1.6.m6.1.1.1.1.1.1.1.2" xref="S3.3.p1.6.m6.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S3.3.p1.6.m6.1.1.1.1.1.1.1.1" xref="S3.3.p1.6.m6.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.3.p1.6.m6.1.1.1.1.1.1.1.3" xref="S3.3.p1.6.m6.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.3.p1.6.m6.1.1.1.1.1.1.3" stretchy="false" xref="S3.3.p1.6.m6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.3.p1.6.m6.1.1.1.1.2" xref="S3.3.p1.6.m6.1.1.1.1.2.cmml">⁢</mo><mi id="S3.3.p1.6.m6.1.1.1.1.3" xref="S3.3.p1.6.m6.1.1.1.1.3.cmml">L</mi></mrow><mo id="S3.3.p1.6.m6.1.1.1.2a" xref="S3.3.p1.6.m6.1.1.1.2.cmml">−</mo><mn id="S3.3.p1.6.m6.1.1.1.4" xref="S3.3.p1.6.m6.1.1.1.4.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.6.m6.1b"><apply id="S3.3.p1.6.m6.1.1.cmml" xref="S3.3.p1.6.m6.1.1"><eq id="S3.3.p1.6.m6.1.1.2.cmml" xref="S3.3.p1.6.m6.1.1.2"></eq><apply id="S3.3.p1.6.m6.1.1.3.cmml" xref="S3.3.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.3.p1.6.m6.1.1.3.1.cmml" xref="S3.3.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.3.p1.6.m6.1.1.3.2.cmml" xref="S3.3.p1.6.m6.1.1.3.2">𝑗</ci><cn id="S3.3.p1.6.m6.1.1.3.3.cmml" type="integer" xref="S3.3.p1.6.m6.1.1.3.3">1</cn></apply><apply id="S3.3.p1.6.m6.1.1.1.cmml" xref="S3.3.p1.6.m6.1.1.1"><minus id="S3.3.p1.6.m6.1.1.1.2.cmml" xref="S3.3.p1.6.m6.1.1.1.2"></minus><ci id="S3.3.p1.6.m6.1.1.1.3.cmml" xref="S3.3.p1.6.m6.1.1.1.3">𝑗</ci><apply id="S3.3.p1.6.m6.1.1.1.1.cmml" xref="S3.3.p1.6.m6.1.1.1.1"><times id="S3.3.p1.6.m6.1.1.1.1.2.cmml" xref="S3.3.p1.6.m6.1.1.1.1.2"></times><apply id="S3.3.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.3.p1.6.m6.1.1.1.1.1.1"><minus id="S3.3.p1.6.m6.1.1.1.1.1.1.1.1.cmml" xref="S3.3.p1.6.m6.1.1.1.1.1.1.1.1"></minus><ci id="S3.3.p1.6.m6.1.1.1.1.1.1.1.2.cmml" xref="S3.3.p1.6.m6.1.1.1.1.1.1.1.2">𝑟</ci><cn id="S3.3.p1.6.m6.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.3.p1.6.m6.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.3.p1.6.m6.1.1.1.1.3.cmml" xref="S3.3.p1.6.m6.1.1.1.1.3">𝐿</ci></apply><cn id="S3.3.p1.6.m6.1.1.1.4.cmml" type="integer" xref="S3.3.p1.6.m6.1.1.1.4">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.6.m6.1c">j_{1}=j-(r-1)L-1</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.6.m6.1d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_j - ( italic_r - 1 ) italic_L - 1</annotation></semantics></math>. For the rest of the proof we distinguish two cases:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.6">The case when <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.1"><semantics id="S3.I1.i1.p1.1.m1.1a"><mrow id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml"><mrow id="S3.I1.i1.p1.1.m1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.2.cmml"><mrow id="S3.I1.i1.p1.1.m1.1.1.2.2" xref="S3.I1.i1.p1.1.m1.1.1.2.2.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.2.2.2" xref="S3.I1.i1.p1.1.m1.1.1.2.2.2.cmml">i</mi><mo id="S3.I1.i1.p1.1.m1.1.1.2.2.1" xref="S3.I1.i1.p1.1.m1.1.1.2.2.1.cmml">−</mo><mi id="S3.I1.i1.p1.1.m1.1.1.2.2.3" xref="S3.I1.i1.p1.1.m1.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.I1.i1.p1.1.m1.1.1.2.1" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">+</mo><mn id="S3.I1.i1.p1.1.m1.1.1.2.3" xref="S3.I1.i1.p1.1.m1.1.1.2.3.cmml">1</mn></mrow><mo id="S3.I1.i1.p1.1.m1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.3.cmml">≤</mo><mi id="S3.I1.i1.p1.1.m1.1.1.4" xref="S3.I1.i1.p1.1.m1.1.1.4.cmml">j</mi><mo id="S3.I1.i1.p1.1.m1.1.1.5" xref="S3.I1.i1.p1.1.m1.1.1.5.cmml">≤</mo><mi id="S3.I1.i1.p1.1.m1.1.1.6" xref="S3.I1.i1.p1.1.m1.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><apply id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><and id="S3.I1.i1.p1.1.m1.1.1a.cmml" xref="S3.I1.i1.p1.1.m1.1.1"></and><apply id="S3.I1.i1.p1.1.m1.1.1b.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><leq id="S3.I1.i1.p1.1.m1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3"></leq><apply id="S3.I1.i1.p1.1.m1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2"><plus id="S3.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.1"></plus><apply id="S3.I1.i1.p1.1.m1.1.1.2.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.2"><minus id="S3.I1.i1.p1.1.m1.1.1.2.2.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.2.1"></minus><ci id="S3.I1.i1.p1.1.m1.1.1.2.2.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.2.2">𝑖</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.2.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.2.3">𝐿</ci></apply><cn id="S3.I1.i1.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S3.I1.i1.p1.1.m1.1.1.2.3">1</cn></apply><ci id="S3.I1.i1.p1.1.m1.1.1.4.cmml" xref="S3.I1.i1.p1.1.m1.1.1.4">𝑗</ci></apply><apply id="S3.I1.i1.p1.1.m1.1.1c.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><leq id="S3.I1.i1.p1.1.m1.1.1.5.cmml" xref="S3.I1.i1.p1.1.m1.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.I1.i1.p1.1.m1.1.1.4.cmml" id="S3.I1.i1.p1.1.m1.1.1d.cmml" xref="S3.I1.i1.p1.1.m1.1.1"></share><ci id="S3.I1.i1.p1.1.m1.1.1.6.cmml" xref="S3.I1.i1.p1.1.m1.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math>. In view of Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm3" title="Lemma 3. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">3</span></a>, we have <math alttext="r\in\{0,1,\ldots,s-1\}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.4"><semantics id="S3.I1.i1.p1.2.m2.4a"><mrow id="S3.I1.i1.p1.2.m2.4.4" xref="S3.I1.i1.p1.2.m2.4.4.cmml"><mi id="S3.I1.i1.p1.2.m2.4.4.3" xref="S3.I1.i1.p1.2.m2.4.4.3.cmml">r</mi><mo id="S3.I1.i1.p1.2.m2.4.4.2" xref="S3.I1.i1.p1.2.m2.4.4.2.cmml">∈</mo><mrow id="S3.I1.i1.p1.2.m2.4.4.1.1" xref="S3.I1.i1.p1.2.m2.4.4.1.2.cmml"><mo id="S3.I1.i1.p1.2.m2.4.4.1.1.2" stretchy="false" xref="S3.I1.i1.p1.2.m2.4.4.1.2.cmml">{</mo><mn id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">0</mn><mo id="S3.I1.i1.p1.2.m2.4.4.1.1.3" xref="S3.I1.i1.p1.2.m2.4.4.1.2.cmml">,</mo><mn id="S3.I1.i1.p1.2.m2.2.2" xref="S3.I1.i1.p1.2.m2.2.2.cmml">1</mn><mo id="S3.I1.i1.p1.2.m2.4.4.1.1.4" xref="S3.I1.i1.p1.2.m2.4.4.1.2.cmml">,</mo><mi id="S3.I1.i1.p1.2.m2.3.3" mathvariant="normal" xref="S3.I1.i1.p1.2.m2.3.3.cmml">…</mi><mo id="S3.I1.i1.p1.2.m2.4.4.1.1.5" xref="S3.I1.i1.p1.2.m2.4.4.1.2.cmml">,</mo><mrow id="S3.I1.i1.p1.2.m2.4.4.1.1.1" xref="S3.I1.i1.p1.2.m2.4.4.1.1.1.cmml"><mi id="S3.I1.i1.p1.2.m2.4.4.1.1.1.2" xref="S3.I1.i1.p1.2.m2.4.4.1.1.1.2.cmml">s</mi><mo id="S3.I1.i1.p1.2.m2.4.4.1.1.1.1" xref="S3.I1.i1.p1.2.m2.4.4.1.1.1.1.cmml">−</mo><mn id="S3.I1.i1.p1.2.m2.4.4.1.1.1.3" xref="S3.I1.i1.p1.2.m2.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.I1.i1.p1.2.m2.4.4.1.1.6" stretchy="false" xref="S3.I1.i1.p1.2.m2.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.4b"><apply id="S3.I1.i1.p1.2.m2.4.4.cmml" xref="S3.I1.i1.p1.2.m2.4.4"><in id="S3.I1.i1.p1.2.m2.4.4.2.cmml" xref="S3.I1.i1.p1.2.m2.4.4.2"></in><ci id="S3.I1.i1.p1.2.m2.4.4.3.cmml" xref="S3.I1.i1.p1.2.m2.4.4.3">𝑟</ci><set id="S3.I1.i1.p1.2.m2.4.4.1.2.cmml" xref="S3.I1.i1.p1.2.m2.4.4.1.1"><cn id="S3.I1.i1.p1.2.m2.1.1.cmml" type="integer" xref="S3.I1.i1.p1.2.m2.1.1">0</cn><cn id="S3.I1.i1.p1.2.m2.2.2.cmml" type="integer" xref="S3.I1.i1.p1.2.m2.2.2">1</cn><ci id="S3.I1.i1.p1.2.m2.3.3.cmml" xref="S3.I1.i1.p1.2.m2.3.3">…</ci><apply id="S3.I1.i1.p1.2.m2.4.4.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.4.4.1.1.1"><minus id="S3.I1.i1.p1.2.m2.4.4.1.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.4.4.1.1.1.1"></minus><ci id="S3.I1.i1.p1.2.m2.4.4.1.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.4.4.1.1.1.2">𝑠</ci><cn id="S3.I1.i1.p1.2.m2.4.4.1.1.1.3.cmml" type="integer" xref="S3.I1.i1.p1.2.m2.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.4c">r\in\{0,1,\ldots,s-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.2.m2.4d">italic_r ∈ { 0 , 1 , … , italic_s - 1 }</annotation></semantics></math>, <math alttext="i_{1}\in\{0,1,\ldots,L-1\}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.3.m3.4"><semantics id="S3.I1.i1.p1.3.m3.4a"><mrow id="S3.I1.i1.p1.3.m3.4.4" xref="S3.I1.i1.p1.3.m3.4.4.cmml"><msub id="S3.I1.i1.p1.3.m3.4.4.3" xref="S3.I1.i1.p1.3.m3.4.4.3.cmml"><mi id="S3.I1.i1.p1.3.m3.4.4.3.2" xref="S3.I1.i1.p1.3.m3.4.4.3.2.cmml">i</mi><mn id="S3.I1.i1.p1.3.m3.4.4.3.3" xref="S3.I1.i1.p1.3.m3.4.4.3.3.cmml">1</mn></msub><mo id="S3.I1.i1.p1.3.m3.4.4.2" xref="S3.I1.i1.p1.3.m3.4.4.2.cmml">∈</mo><mrow id="S3.I1.i1.p1.3.m3.4.4.1.1" xref="S3.I1.i1.p1.3.m3.4.4.1.2.cmml"><mo id="S3.I1.i1.p1.3.m3.4.4.1.1.2" stretchy="false" xref="S3.I1.i1.p1.3.m3.4.4.1.2.cmml">{</mo><mn id="S3.I1.i1.p1.3.m3.1.1" xref="S3.I1.i1.p1.3.m3.1.1.cmml">0</mn><mo id="S3.I1.i1.p1.3.m3.4.4.1.1.3" xref="S3.I1.i1.p1.3.m3.4.4.1.2.cmml">,</mo><mn id="S3.I1.i1.p1.3.m3.2.2" xref="S3.I1.i1.p1.3.m3.2.2.cmml">1</mn><mo id="S3.I1.i1.p1.3.m3.4.4.1.1.4" xref="S3.I1.i1.p1.3.m3.4.4.1.2.cmml">,</mo><mi id="S3.I1.i1.p1.3.m3.3.3" mathvariant="normal" xref="S3.I1.i1.p1.3.m3.3.3.cmml">…</mi><mo id="S3.I1.i1.p1.3.m3.4.4.1.1.5" xref="S3.I1.i1.p1.3.m3.4.4.1.2.cmml">,</mo><mrow id="S3.I1.i1.p1.3.m3.4.4.1.1.1" xref="S3.I1.i1.p1.3.m3.4.4.1.1.1.cmml"><mi id="S3.I1.i1.p1.3.m3.4.4.1.1.1.2" xref="S3.I1.i1.p1.3.m3.4.4.1.1.1.2.cmml">L</mi><mo id="S3.I1.i1.p1.3.m3.4.4.1.1.1.1" xref="S3.I1.i1.p1.3.m3.4.4.1.1.1.1.cmml">−</mo><mn id="S3.I1.i1.p1.3.m3.4.4.1.1.1.3" xref="S3.I1.i1.p1.3.m3.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.I1.i1.p1.3.m3.4.4.1.1.6" stretchy="false" xref="S3.I1.i1.p1.3.m3.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.4b"><apply id="S3.I1.i1.p1.3.m3.4.4.cmml" xref="S3.I1.i1.p1.3.m3.4.4"><in id="S3.I1.i1.p1.3.m3.4.4.2.cmml" xref="S3.I1.i1.p1.3.m3.4.4.2"></in><apply id="S3.I1.i1.p1.3.m3.4.4.3.cmml" xref="S3.I1.i1.p1.3.m3.4.4.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.3.m3.4.4.3.1.cmml" xref="S3.I1.i1.p1.3.m3.4.4.3">subscript</csymbol><ci id="S3.I1.i1.p1.3.m3.4.4.3.2.cmml" xref="S3.I1.i1.p1.3.m3.4.4.3.2">𝑖</ci><cn id="S3.I1.i1.p1.3.m3.4.4.3.3.cmml" type="integer" xref="S3.I1.i1.p1.3.m3.4.4.3.3">1</cn></apply><set id="S3.I1.i1.p1.3.m3.4.4.1.2.cmml" xref="S3.I1.i1.p1.3.m3.4.4.1.1"><cn id="S3.I1.i1.p1.3.m3.1.1.cmml" type="integer" xref="S3.I1.i1.p1.3.m3.1.1">0</cn><cn id="S3.I1.i1.p1.3.m3.2.2.cmml" type="integer" xref="S3.I1.i1.p1.3.m3.2.2">1</cn><ci id="S3.I1.i1.p1.3.m3.3.3.cmml" xref="S3.I1.i1.p1.3.m3.3.3">…</ci><apply id="S3.I1.i1.p1.3.m3.4.4.1.1.1.cmml" xref="S3.I1.i1.p1.3.m3.4.4.1.1.1"><minus id="S3.I1.i1.p1.3.m3.4.4.1.1.1.1.cmml" xref="S3.I1.i1.p1.3.m3.4.4.1.1.1.1"></minus><ci id="S3.I1.i1.p1.3.m3.4.4.1.1.1.2.cmml" xref="S3.I1.i1.p1.3.m3.4.4.1.1.1.2">𝐿</ci><cn id="S3.I1.i1.p1.3.m3.4.4.1.1.1.3.cmml" type="integer" xref="S3.I1.i1.p1.3.m3.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.4c">i_{1}\in\{0,1,\ldots,L-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.3.m3.4d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , italic_L - 1 }</annotation></semantics></math> and <math alttext="j_{1}\in\{0,1,\ldots,2L-2\}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.4.m4.4"><semantics id="S3.I1.i1.p1.4.m4.4a"><mrow id="S3.I1.i1.p1.4.m4.4.4" xref="S3.I1.i1.p1.4.m4.4.4.cmml"><msub id="S3.I1.i1.p1.4.m4.4.4.3" xref="S3.I1.i1.p1.4.m4.4.4.3.cmml"><mi id="S3.I1.i1.p1.4.m4.4.4.3.2" xref="S3.I1.i1.p1.4.m4.4.4.3.2.cmml">j</mi><mn id="S3.I1.i1.p1.4.m4.4.4.3.3" xref="S3.I1.i1.p1.4.m4.4.4.3.3.cmml">1</mn></msub><mo id="S3.I1.i1.p1.4.m4.4.4.2" xref="S3.I1.i1.p1.4.m4.4.4.2.cmml">∈</mo><mrow id="S3.I1.i1.p1.4.m4.4.4.1.1" xref="S3.I1.i1.p1.4.m4.4.4.1.2.cmml"><mo id="S3.I1.i1.p1.4.m4.4.4.1.1.2" stretchy="false" xref="S3.I1.i1.p1.4.m4.4.4.1.2.cmml">{</mo><mn id="S3.I1.i1.p1.4.m4.1.1" xref="S3.I1.i1.p1.4.m4.1.1.cmml">0</mn><mo id="S3.I1.i1.p1.4.m4.4.4.1.1.3" xref="S3.I1.i1.p1.4.m4.4.4.1.2.cmml">,</mo><mn id="S3.I1.i1.p1.4.m4.2.2" xref="S3.I1.i1.p1.4.m4.2.2.cmml">1</mn><mo id="S3.I1.i1.p1.4.m4.4.4.1.1.4" xref="S3.I1.i1.p1.4.m4.4.4.1.2.cmml">,</mo><mi id="S3.I1.i1.p1.4.m4.3.3" mathvariant="normal" xref="S3.I1.i1.p1.4.m4.3.3.cmml">…</mi><mo id="S3.I1.i1.p1.4.m4.4.4.1.1.5" xref="S3.I1.i1.p1.4.m4.4.4.1.2.cmml">,</mo><mrow id="S3.I1.i1.p1.4.m4.4.4.1.1.1" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.cmml"><mrow id="S3.I1.i1.p1.4.m4.4.4.1.1.1.2" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.cmml"><mn id="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.2" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.2.cmml">2</mn><mo id="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.1" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.3" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.I1.i1.p1.4.m4.4.4.1.1.1.1" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.1.cmml">−</mo><mn id="S3.I1.i1.p1.4.m4.4.4.1.1.1.3" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="S3.I1.i1.p1.4.m4.4.4.1.1.6" stretchy="false" xref="S3.I1.i1.p1.4.m4.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.4.m4.4b"><apply id="S3.I1.i1.p1.4.m4.4.4.cmml" xref="S3.I1.i1.p1.4.m4.4.4"><in id="S3.I1.i1.p1.4.m4.4.4.2.cmml" xref="S3.I1.i1.p1.4.m4.4.4.2"></in><apply id="S3.I1.i1.p1.4.m4.4.4.3.cmml" xref="S3.I1.i1.p1.4.m4.4.4.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.4.m4.4.4.3.1.cmml" xref="S3.I1.i1.p1.4.m4.4.4.3">subscript</csymbol><ci id="S3.I1.i1.p1.4.m4.4.4.3.2.cmml" xref="S3.I1.i1.p1.4.m4.4.4.3.2">𝑗</ci><cn id="S3.I1.i1.p1.4.m4.4.4.3.3.cmml" type="integer" xref="S3.I1.i1.p1.4.m4.4.4.3.3">1</cn></apply><set id="S3.I1.i1.p1.4.m4.4.4.1.2.cmml" xref="S3.I1.i1.p1.4.m4.4.4.1.1"><cn id="S3.I1.i1.p1.4.m4.1.1.cmml" type="integer" xref="S3.I1.i1.p1.4.m4.1.1">0</cn><cn id="S3.I1.i1.p1.4.m4.2.2.cmml" type="integer" xref="S3.I1.i1.p1.4.m4.2.2">1</cn><ci id="S3.I1.i1.p1.4.m4.3.3.cmml" xref="S3.I1.i1.p1.4.m4.3.3">…</ci><apply id="S3.I1.i1.p1.4.m4.4.4.1.1.1.cmml" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1"><minus id="S3.I1.i1.p1.4.m4.4.4.1.1.1.1.cmml" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.1"></minus><apply id="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.cmml" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.2"><times id="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.1.cmml" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.1"></times><cn id="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.2.cmml" type="integer" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.2">2</cn><ci id="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.3.cmml" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.2.3">𝐿</ci></apply><cn id="S3.I1.i1.p1.4.m4.4.4.1.1.1.3.cmml" type="integer" xref="S3.I1.i1.p1.4.m4.4.4.1.1.1.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.4.m4.4c">j_{1}\in\{0,1,\ldots,2L-2\}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.4.m4.4d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , 2 italic_L - 2 }</annotation></semantics></math>, and, moreover, <math alttext="\langle Q_{i},K_{j}\rangle=T_{A}[r,i_{1},j_{1}]" class="ltx_Math" display="inline" id="S3.I1.i1.p1.5.m5.5"><semantics id="S3.I1.i1.p1.5.m5.5a"><mrow id="S3.I1.i1.p1.5.m5.5.5" xref="S3.I1.i1.p1.5.m5.5.5.cmml"><mrow id="S3.I1.i1.p1.5.m5.3.3.2.2" xref="S3.I1.i1.p1.5.m5.3.3.2.3.cmml"><mo id="S3.I1.i1.p1.5.m5.3.3.2.2.3" stretchy="false" xref="S3.I1.i1.p1.5.m5.3.3.2.3.cmml">⟨</mo><msub id="S3.I1.i1.p1.5.m5.2.2.1.1.1" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.cmml">Q</mi><mi id="S3.I1.i1.p1.5.m5.2.2.1.1.1.3" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.I1.i1.p1.5.m5.3.3.2.2.4" xref="S3.I1.i1.p1.5.m5.3.3.2.3.cmml">,</mo><msub id="S3.I1.i1.p1.5.m5.3.3.2.2.2" xref="S3.I1.i1.p1.5.m5.3.3.2.2.2.cmml"><mi id="S3.I1.i1.p1.5.m5.3.3.2.2.2.2" xref="S3.I1.i1.p1.5.m5.3.3.2.2.2.2.cmml">K</mi><mi id="S3.I1.i1.p1.5.m5.3.3.2.2.2.3" xref="S3.I1.i1.p1.5.m5.3.3.2.2.2.3.cmml">j</mi></msub><mo id="S3.I1.i1.p1.5.m5.3.3.2.2.5" stretchy="false" xref="S3.I1.i1.p1.5.m5.3.3.2.3.cmml">⟩</mo></mrow><mo id="S3.I1.i1.p1.5.m5.5.5.5" xref="S3.I1.i1.p1.5.m5.5.5.5.cmml">=</mo><mrow id="S3.I1.i1.p1.5.m5.5.5.4" xref="S3.I1.i1.p1.5.m5.5.5.4.cmml"><msub id="S3.I1.i1.p1.5.m5.5.5.4.4" xref="S3.I1.i1.p1.5.m5.5.5.4.4.cmml"><mi id="S3.I1.i1.p1.5.m5.5.5.4.4.2" xref="S3.I1.i1.p1.5.m5.5.5.4.4.2.cmml">T</mi><mi id="S3.I1.i1.p1.5.m5.5.5.4.4.3" xref="S3.I1.i1.p1.5.m5.5.5.4.4.3.cmml">A</mi></msub><mo id="S3.I1.i1.p1.5.m5.5.5.4.3" xref="S3.I1.i1.p1.5.m5.5.5.4.3.cmml">⁢</mo><mrow id="S3.I1.i1.p1.5.m5.5.5.4.2.2" xref="S3.I1.i1.p1.5.m5.5.5.4.2.3.cmml"><mo id="S3.I1.i1.p1.5.m5.5.5.4.2.2.3" stretchy="false" xref="S3.I1.i1.p1.5.m5.5.5.4.2.3.cmml">[</mo><mi id="S3.I1.i1.p1.5.m5.1.1" xref="S3.I1.i1.p1.5.m5.1.1.cmml">r</mi><mo id="S3.I1.i1.p1.5.m5.5.5.4.2.2.4" xref="S3.I1.i1.p1.5.m5.5.5.4.2.3.cmml">,</mo><msub id="S3.I1.i1.p1.5.m5.4.4.3.1.1.1" xref="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.cmml"><mi id="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.2" xref="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.2.cmml">i</mi><mn id="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.3" xref="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.I1.i1.p1.5.m5.5.5.4.2.2.5" xref="S3.I1.i1.p1.5.m5.5.5.4.2.3.cmml">,</mo><msub id="S3.I1.i1.p1.5.m5.5.5.4.2.2.2" xref="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.cmml"><mi id="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.2" xref="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.2.cmml">j</mi><mn id="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.3" xref="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.3.cmml">1</mn></msub><mo id="S3.I1.i1.p1.5.m5.5.5.4.2.2.6" stretchy="false" xref="S3.I1.i1.p1.5.m5.5.5.4.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.5.m5.5b"><apply id="S3.I1.i1.p1.5.m5.5.5.cmml" xref="S3.I1.i1.p1.5.m5.5.5"><eq id="S3.I1.i1.p1.5.m5.5.5.5.cmml" xref="S3.I1.i1.p1.5.m5.5.5.5"></eq><list id="S3.I1.i1.p1.5.m5.3.3.2.3.cmml" xref="S3.I1.i1.p1.5.m5.3.3.2.2"><apply id="S3.I1.i1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2">𝑄</ci><ci id="S3.I1.i1.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.I1.i1.p1.5.m5.3.3.2.2.2.cmml" xref="S3.I1.i1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.I1.i1.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.I1.i1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.I1.i1.p1.5.m5.3.3.2.2.2.2">𝐾</ci><ci id="S3.I1.i1.p1.5.m5.3.3.2.2.2.3.cmml" xref="S3.I1.i1.p1.5.m5.3.3.2.2.2.3">𝑗</ci></apply></list><apply id="S3.I1.i1.p1.5.m5.5.5.4.cmml" xref="S3.I1.i1.p1.5.m5.5.5.4"><times id="S3.I1.i1.p1.5.m5.5.5.4.3.cmml" xref="S3.I1.i1.p1.5.m5.5.5.4.3"></times><apply id="S3.I1.i1.p1.5.m5.5.5.4.4.cmml" xref="S3.I1.i1.p1.5.m5.5.5.4.4"><csymbol cd="ambiguous" id="S3.I1.i1.p1.5.m5.5.5.4.4.1.cmml" xref="S3.I1.i1.p1.5.m5.5.5.4.4">subscript</csymbol><ci id="S3.I1.i1.p1.5.m5.5.5.4.4.2.cmml" xref="S3.I1.i1.p1.5.m5.5.5.4.4.2">𝑇</ci><ci id="S3.I1.i1.p1.5.m5.5.5.4.4.3.cmml" xref="S3.I1.i1.p1.5.m5.5.5.4.4.3">𝐴</ci></apply><list id="S3.I1.i1.p1.5.m5.5.5.4.2.3.cmml" xref="S3.I1.i1.p1.5.m5.5.5.4.2.2"><ci id="S3.I1.i1.p1.5.m5.1.1.cmml" xref="S3.I1.i1.p1.5.m5.1.1">𝑟</ci><apply id="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.4.4.3.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.4.4.3.1.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.2.cmml" xref="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.2">𝑖</ci><cn id="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.3.cmml" type="integer" xref="S3.I1.i1.p1.5.m5.4.4.3.1.1.1.3">1</cn></apply><apply id="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.cmml" xref="S3.I1.i1.p1.5.m5.5.5.4.2.2.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.1.cmml" xref="S3.I1.i1.p1.5.m5.5.5.4.2.2.2">subscript</csymbol><ci id="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.2.cmml" xref="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.2">𝑗</ci><cn id="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.3.cmml" type="integer" xref="S3.I1.i1.p1.5.m5.5.5.4.2.2.2.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.5.m5.5c">\langle Q_{i},K_{j}\rangle=T_{A}[r,i_{1},j_{1}]</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.5.m5.5d">⟨ italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ = italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="T_{A}=T_{Q}T_{K}^{T}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.6.m6.1"><semantics id="S3.I1.i1.p1.6.m6.1a"><mrow id="S3.I1.i1.p1.6.m6.1.1" xref="S3.I1.i1.p1.6.m6.1.1.cmml"><msub id="S3.I1.i1.p1.6.m6.1.1.2" xref="S3.I1.i1.p1.6.m6.1.1.2.cmml"><mi id="S3.I1.i1.p1.6.m6.1.1.2.2" xref="S3.I1.i1.p1.6.m6.1.1.2.2.cmml">T</mi><mi id="S3.I1.i1.p1.6.m6.1.1.2.3" xref="S3.I1.i1.p1.6.m6.1.1.2.3.cmml">A</mi></msub><mo id="S3.I1.i1.p1.6.m6.1.1.1" xref="S3.I1.i1.p1.6.m6.1.1.1.cmml">=</mo><mrow id="S3.I1.i1.p1.6.m6.1.1.3" xref="S3.I1.i1.p1.6.m6.1.1.3.cmml"><msub id="S3.I1.i1.p1.6.m6.1.1.3.2" xref="S3.I1.i1.p1.6.m6.1.1.3.2.cmml"><mi id="S3.I1.i1.p1.6.m6.1.1.3.2.2" xref="S3.I1.i1.p1.6.m6.1.1.3.2.2.cmml">T</mi><mi id="S3.I1.i1.p1.6.m6.1.1.3.2.3" xref="S3.I1.i1.p1.6.m6.1.1.3.2.3.cmml">Q</mi></msub><mo id="S3.I1.i1.p1.6.m6.1.1.3.1" xref="S3.I1.i1.p1.6.m6.1.1.3.1.cmml">⁢</mo><msubsup id="S3.I1.i1.p1.6.m6.1.1.3.3" xref="S3.I1.i1.p1.6.m6.1.1.3.3.cmml"><mi id="S3.I1.i1.p1.6.m6.1.1.3.3.2.2" xref="S3.I1.i1.p1.6.m6.1.1.3.3.2.2.cmml">T</mi><mi id="S3.I1.i1.p1.6.m6.1.1.3.3.2.3" xref="S3.I1.i1.p1.6.m6.1.1.3.3.2.3.cmml">K</mi><mi id="S3.I1.i1.p1.6.m6.1.1.3.3.3" xref="S3.I1.i1.p1.6.m6.1.1.3.3.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.6.m6.1b"><apply id="S3.I1.i1.p1.6.m6.1.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1"><eq id="S3.I1.i1.p1.6.m6.1.1.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1.1"></eq><apply id="S3.I1.i1.p1.6.m6.1.1.2.cmml" xref="S3.I1.i1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.6.m6.1.1.2.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.I1.i1.p1.6.m6.1.1.2.2.cmml" xref="S3.I1.i1.p1.6.m6.1.1.2.2">𝑇</ci><ci id="S3.I1.i1.p1.6.m6.1.1.2.3.cmml" xref="S3.I1.i1.p1.6.m6.1.1.2.3">𝐴</ci></apply><apply id="S3.I1.i1.p1.6.m6.1.1.3.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3"><times id="S3.I1.i1.p1.6.m6.1.1.3.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.1"></times><apply id="S3.I1.i1.p1.6.m6.1.1.3.2.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.6.m6.1.1.3.2.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.2">subscript</csymbol><ci id="S3.I1.i1.p1.6.m6.1.1.3.2.2.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.2.2">𝑇</ci><ci id="S3.I1.i1.p1.6.m6.1.1.3.2.3.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.2.3">𝑄</ci></apply><apply id="S3.I1.i1.p1.6.m6.1.1.3.3.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.6.m6.1.1.3.3.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.3">superscript</csymbol><apply id="S3.I1.i1.p1.6.m6.1.1.3.3.2.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.6.m6.1.1.3.3.2.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.3">subscript</csymbol><ci id="S3.I1.i1.p1.6.m6.1.1.3.3.2.2.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.3.2.2">𝑇</ci><ci id="S3.I1.i1.p1.6.m6.1.1.3.3.2.3.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.3.2.3">𝐾</ci></apply><ci id="S3.I1.i1.p1.6.m6.1.1.3.3.3.cmml" xref="S3.I1.i1.p1.6.m6.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.6.m6.1c">T_{A}=T_{Q}T_{K}^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.6.m6.1d">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT = italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.14">The case when the <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><mrow id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml"><mrow id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml"><mrow id="S3.I1.i2.p1.1.m1.1.1.2.2" xref="S3.I1.i2.p1.1.m1.1.1.2.2.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.2.2.2" xref="S3.I1.i2.p1.1.m1.1.1.2.2.2.cmml">i</mi><mo id="S3.I1.i2.p1.1.m1.1.1.2.2.1" xref="S3.I1.i2.p1.1.m1.1.1.2.2.1.cmml">−</mo><mi id="S3.I1.i2.p1.1.m1.1.1.2.2.3" xref="S3.I1.i2.p1.1.m1.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.I1.i2.p1.1.m1.1.1.2.1" xref="S3.I1.i2.p1.1.m1.1.1.2.1.cmml">+</mo><mn id="S3.I1.i2.p1.1.m1.1.1.2.3" xref="S3.I1.i2.p1.1.m1.1.1.2.3.cmml">1</mn></mrow><mo id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml">≤</mo><mi id="S3.I1.i2.p1.1.m1.1.1.4" xref="S3.I1.i2.p1.1.m1.1.1.4.cmml">j</mi><mo id="S3.I1.i2.p1.1.m1.1.1.5" xref="S3.I1.i2.p1.1.m1.1.1.5.cmml">≤</mo><mi id="S3.I1.i2.p1.1.m1.1.1.6" xref="S3.I1.i2.p1.1.m1.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><and id="S3.I1.i2.p1.1.m1.1.1a.cmml" xref="S3.I1.i2.p1.1.m1.1.1"></and><apply id="S3.I1.i2.p1.1.m1.1.1b.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><leq id="S3.I1.i2.p1.1.m1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3"></leq><apply id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2"><plus id="S3.I1.i2.p1.1.m1.1.1.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2.1"></plus><apply id="S3.I1.i2.p1.1.m1.1.1.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2.2"><minus id="S3.I1.i2.p1.1.m1.1.1.2.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2.2.1"></minus><ci id="S3.I1.i2.p1.1.m1.1.1.2.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2.2.2">𝑖</ci><ci id="S3.I1.i2.p1.1.m1.1.1.2.2.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2.2.3">𝐿</ci></apply><cn id="S3.I1.i2.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S3.I1.i2.p1.1.m1.1.1.2.3">1</cn></apply><ci id="S3.I1.i2.p1.1.m1.1.1.4.cmml" xref="S3.I1.i2.p1.1.m1.1.1.4">𝑗</ci></apply><apply id="S3.I1.i2.p1.1.m1.1.1c.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><leq id="S3.I1.i2.p1.1.m1.1.1.5.cmml" xref="S3.I1.i2.p1.1.m1.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.I1.i2.p1.1.m1.1.1.4.cmml" id="S3.I1.i2.p1.1.m1.1.1d.cmml" xref="S3.I1.i2.p1.1.m1.1.1"></share><ci id="S3.I1.i2.p1.1.m1.1.1.6.cmml" xref="S3.I1.i2.p1.1.m1.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math> does not hold. In such case, <math alttext="M[i,j]=-\infty" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.2"><semantics id="S3.I1.i2.p1.2.m2.2a"><mrow id="S3.I1.i2.p1.2.m2.2.3" xref="S3.I1.i2.p1.2.m2.2.3.cmml"><mrow id="S3.I1.i2.p1.2.m2.2.3.2" xref="S3.I1.i2.p1.2.m2.2.3.2.cmml"><mi id="S3.I1.i2.p1.2.m2.2.3.2.2" xref="S3.I1.i2.p1.2.m2.2.3.2.2.cmml">M</mi><mo id="S3.I1.i2.p1.2.m2.2.3.2.1" xref="S3.I1.i2.p1.2.m2.2.3.2.1.cmml">⁢</mo><mrow id="S3.I1.i2.p1.2.m2.2.3.2.3.2" xref="S3.I1.i2.p1.2.m2.2.3.2.3.1.cmml"><mo id="S3.I1.i2.p1.2.m2.2.3.2.3.2.1" stretchy="false" xref="S3.I1.i2.p1.2.m2.2.3.2.3.1.cmml">[</mo><mi id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml">i</mi><mo id="S3.I1.i2.p1.2.m2.2.3.2.3.2.2" xref="S3.I1.i2.p1.2.m2.2.3.2.3.1.cmml">,</mo><mi id="S3.I1.i2.p1.2.m2.2.2" xref="S3.I1.i2.p1.2.m2.2.2.cmml">j</mi><mo id="S3.I1.i2.p1.2.m2.2.3.2.3.2.3" stretchy="false" xref="S3.I1.i2.p1.2.m2.2.3.2.3.1.cmml">]</mo></mrow></mrow><mo id="S3.I1.i2.p1.2.m2.2.3.1" xref="S3.I1.i2.p1.2.m2.2.3.1.cmml">=</mo><mrow id="S3.I1.i2.p1.2.m2.2.3.3" xref="S3.I1.i2.p1.2.m2.2.3.3.cmml"><mo id="S3.I1.i2.p1.2.m2.2.3.3a" xref="S3.I1.i2.p1.2.m2.2.3.3.cmml">−</mo><mi id="S3.I1.i2.p1.2.m2.2.3.3.2" mathvariant="normal" xref="S3.I1.i2.p1.2.m2.2.3.3.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.2b"><apply id="S3.I1.i2.p1.2.m2.2.3.cmml" xref="S3.I1.i2.p1.2.m2.2.3"><eq id="S3.I1.i2.p1.2.m2.2.3.1.cmml" xref="S3.I1.i2.p1.2.m2.2.3.1"></eq><apply id="S3.I1.i2.p1.2.m2.2.3.2.cmml" xref="S3.I1.i2.p1.2.m2.2.3.2"><times id="S3.I1.i2.p1.2.m2.2.3.2.1.cmml" xref="S3.I1.i2.p1.2.m2.2.3.2.1"></times><ci id="S3.I1.i2.p1.2.m2.2.3.2.2.cmml" xref="S3.I1.i2.p1.2.m2.2.3.2.2">𝑀</ci><interval closure="closed" id="S3.I1.i2.p1.2.m2.2.3.2.3.1.cmml" xref="S3.I1.i2.p1.2.m2.2.3.2.3.2"><ci id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">𝑖</ci><ci id="S3.I1.i2.p1.2.m2.2.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2">𝑗</ci></interval></apply><apply id="S3.I1.i2.p1.2.m2.2.3.3.cmml" xref="S3.I1.i2.p1.2.m2.2.3.3"><minus id="S3.I1.i2.p1.2.m2.2.3.3.1.cmml" xref="S3.I1.i2.p1.2.m2.2.3.3"></minus><infinity id="S3.I1.i2.p1.2.m2.2.3.3.2.cmml" xref="S3.I1.i2.p1.2.m2.2.3.3.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.2c">M[i,j]=-\infty</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.2.m2.2d">italic_M [ italic_i , italic_j ] = - ∞</annotation></semantics></math> by definition, so <math alttext="(QK^{T}+M)[i,j]=-\infty" class="ltx_Math" display="inline" id="S3.I1.i2.p1.3.m3.3"><semantics id="S3.I1.i2.p1.3.m3.3a"><mrow id="S3.I1.i2.p1.3.m3.3.3" xref="S3.I1.i2.p1.3.m3.3.3.cmml"><mrow id="S3.I1.i2.p1.3.m3.3.3.1" xref="S3.I1.i2.p1.3.m3.3.3.1.cmml"><mrow id="S3.I1.i2.p1.3.m3.3.3.1.1.1" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.cmml"><mo id="S3.I1.i2.p1.3.m3.3.3.1.1.1.2" stretchy="false" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.cmml"><mrow id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.cmml"><mi id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.2" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.2.cmml">Q</mi><mo id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.1" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.cmml"><mi id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.2" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.2.cmml">K</mi><mi id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.3" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.1" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.1.cmml">+</mo><mi id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.3" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.3.cmml">M</mi></mrow><mo id="S3.I1.i2.p1.3.m3.3.3.1.1.1.3" stretchy="false" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S3.I1.i2.p1.3.m3.3.3.1.2" xref="S3.I1.i2.p1.3.m3.3.3.1.2.cmml">⁢</mo><mrow id="S3.I1.i2.p1.3.m3.3.3.1.3.2" xref="S3.I1.i2.p1.3.m3.3.3.1.3.1.cmml"><mo id="S3.I1.i2.p1.3.m3.3.3.1.3.2.1" stretchy="false" xref="S3.I1.i2.p1.3.m3.3.3.1.3.1.cmml">[</mo><mi id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml">i</mi><mo id="S3.I1.i2.p1.3.m3.3.3.1.3.2.2" xref="S3.I1.i2.p1.3.m3.3.3.1.3.1.cmml">,</mo><mi id="S3.I1.i2.p1.3.m3.2.2" xref="S3.I1.i2.p1.3.m3.2.2.cmml">j</mi><mo id="S3.I1.i2.p1.3.m3.3.3.1.3.2.3" stretchy="false" xref="S3.I1.i2.p1.3.m3.3.3.1.3.1.cmml">]</mo></mrow></mrow><mo id="S3.I1.i2.p1.3.m3.3.3.2" xref="S3.I1.i2.p1.3.m3.3.3.2.cmml">=</mo><mrow id="S3.I1.i2.p1.3.m3.3.3.3" xref="S3.I1.i2.p1.3.m3.3.3.3.cmml"><mo id="S3.I1.i2.p1.3.m3.3.3.3a" xref="S3.I1.i2.p1.3.m3.3.3.3.cmml">−</mo><mi id="S3.I1.i2.p1.3.m3.3.3.3.2" mathvariant="normal" xref="S3.I1.i2.p1.3.m3.3.3.3.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.3b"><apply id="S3.I1.i2.p1.3.m3.3.3.cmml" xref="S3.I1.i2.p1.3.m3.3.3"><eq id="S3.I1.i2.p1.3.m3.3.3.2.cmml" xref="S3.I1.i2.p1.3.m3.3.3.2"></eq><apply id="S3.I1.i2.p1.3.m3.3.3.1.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1"><times id="S3.I1.i2.p1.3.m3.3.3.1.2.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.2"></times><apply id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1"><plus id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.1"></plus><apply id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2"><times id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.1"></times><ci id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.2.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.2">𝑄</ci><apply id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.1.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3">superscript</csymbol><ci id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.2.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.2">𝐾</ci><ci id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.3.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.3.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.1.1.1.3">𝑀</ci></apply><interval closure="closed" id="S3.I1.i2.p1.3.m3.3.3.1.3.1.cmml" xref="S3.I1.i2.p1.3.m3.3.3.1.3.2"><ci id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">𝑖</ci><ci id="S3.I1.i2.p1.3.m3.2.2.cmml" xref="S3.I1.i2.p1.3.m3.2.2">𝑗</ci></interval></apply><apply id="S3.I1.i2.p1.3.m3.3.3.3.cmml" xref="S3.I1.i2.p1.3.m3.3.3.3"><minus id="S3.I1.i2.p1.3.m3.3.3.3.1.cmml" xref="S3.I1.i2.p1.3.m3.3.3.3"></minus><infinity id="S3.I1.i2.p1.3.m3.3.3.3.2.cmml" xref="S3.I1.i2.p1.3.m3.3.3.3.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.3c">(QK^{T}+M)[i,j]=-\infty</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.3.m3.3d">( italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_M ) [ italic_i , italic_j ] = - ∞</annotation></semantics></math>. Moreover, either <math alttext="j_{1}\not\in\{0,2,\ldots,2L-2\}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.4.m4.4"><semantics id="S3.I1.i2.p1.4.m4.4a"><mrow id="S3.I1.i2.p1.4.m4.4.4" xref="S3.I1.i2.p1.4.m4.4.4.cmml"><msub id="S3.I1.i2.p1.4.m4.4.4.3" xref="S3.I1.i2.p1.4.m4.4.4.3.cmml"><mi id="S3.I1.i2.p1.4.m4.4.4.3.2" xref="S3.I1.i2.p1.4.m4.4.4.3.2.cmml">j</mi><mn id="S3.I1.i2.p1.4.m4.4.4.3.3" xref="S3.I1.i2.p1.4.m4.4.4.3.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.4.m4.4.4.2" xref="S3.I1.i2.p1.4.m4.4.4.2.cmml">∉</mo><mrow id="S3.I1.i2.p1.4.m4.4.4.1.1" xref="S3.I1.i2.p1.4.m4.4.4.1.2.cmml"><mo id="S3.I1.i2.p1.4.m4.4.4.1.1.2" stretchy="false" xref="S3.I1.i2.p1.4.m4.4.4.1.2.cmml">{</mo><mn id="S3.I1.i2.p1.4.m4.1.1" xref="S3.I1.i2.p1.4.m4.1.1.cmml">0</mn><mo id="S3.I1.i2.p1.4.m4.4.4.1.1.3" xref="S3.I1.i2.p1.4.m4.4.4.1.2.cmml">,</mo><mn id="S3.I1.i2.p1.4.m4.2.2" xref="S3.I1.i2.p1.4.m4.2.2.cmml">2</mn><mo id="S3.I1.i2.p1.4.m4.4.4.1.1.4" xref="S3.I1.i2.p1.4.m4.4.4.1.2.cmml">,</mo><mi id="S3.I1.i2.p1.4.m4.3.3" mathvariant="normal" xref="S3.I1.i2.p1.4.m4.3.3.cmml">…</mi><mo id="S3.I1.i2.p1.4.m4.4.4.1.1.5" xref="S3.I1.i2.p1.4.m4.4.4.1.2.cmml">,</mo><mrow id="S3.I1.i2.p1.4.m4.4.4.1.1.1" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.cmml"><mrow id="S3.I1.i2.p1.4.m4.4.4.1.1.1.2" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.cmml"><mn id="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.2" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.2.cmml">2</mn><mo id="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.1" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.3" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.I1.i2.p1.4.m4.4.4.1.1.1.1" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.1.cmml">−</mo><mn id="S3.I1.i2.p1.4.m4.4.4.1.1.1.3" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="S3.I1.i2.p1.4.m4.4.4.1.1.6" stretchy="false" xref="S3.I1.i2.p1.4.m4.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.4.m4.4b"><apply id="S3.I1.i2.p1.4.m4.4.4.cmml" xref="S3.I1.i2.p1.4.m4.4.4"><notin id="S3.I1.i2.p1.4.m4.4.4.2.cmml" xref="S3.I1.i2.p1.4.m4.4.4.2"></notin><apply id="S3.I1.i2.p1.4.m4.4.4.3.cmml" xref="S3.I1.i2.p1.4.m4.4.4.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.4.m4.4.4.3.1.cmml" xref="S3.I1.i2.p1.4.m4.4.4.3">subscript</csymbol><ci id="S3.I1.i2.p1.4.m4.4.4.3.2.cmml" xref="S3.I1.i2.p1.4.m4.4.4.3.2">𝑗</ci><cn id="S3.I1.i2.p1.4.m4.4.4.3.3.cmml" type="integer" xref="S3.I1.i2.p1.4.m4.4.4.3.3">1</cn></apply><set id="S3.I1.i2.p1.4.m4.4.4.1.2.cmml" xref="S3.I1.i2.p1.4.m4.4.4.1.1"><cn id="S3.I1.i2.p1.4.m4.1.1.cmml" type="integer" xref="S3.I1.i2.p1.4.m4.1.1">0</cn><cn id="S3.I1.i2.p1.4.m4.2.2.cmml" type="integer" xref="S3.I1.i2.p1.4.m4.2.2">2</cn><ci id="S3.I1.i2.p1.4.m4.3.3.cmml" xref="S3.I1.i2.p1.4.m4.3.3">…</ci><apply id="S3.I1.i2.p1.4.m4.4.4.1.1.1.cmml" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1"><minus id="S3.I1.i2.p1.4.m4.4.4.1.1.1.1.cmml" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.1"></minus><apply id="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.cmml" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.2"><times id="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.1"></times><cn id="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.2.cmml" type="integer" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.2">2</cn><ci id="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.3.cmml" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.2.3">𝐿</ci></apply><cn id="S3.I1.i2.p1.4.m4.4.4.1.1.1.3.cmml" type="integer" xref="S3.I1.i2.p1.4.m4.4.4.1.1.1.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.4.m4.4c">j_{1}\not\in\{0,2,\ldots,2L-2\}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.4.m4.4d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∉ { 0 , 2 , … , 2 italic_L - 2 }</annotation></semantics></math> and <math alttext="T_{M}[r,i_{1},j_{1}]" class="ltx_Math" display="inline" id="S3.I1.i2.p1.5.m5.3"><semantics id="S3.I1.i2.p1.5.m5.3a"><mrow id="S3.I1.i2.p1.5.m5.3.3" xref="S3.I1.i2.p1.5.m5.3.3.cmml"><msub id="S3.I1.i2.p1.5.m5.3.3.4" xref="S3.I1.i2.p1.5.m5.3.3.4.cmml"><mi id="S3.I1.i2.p1.5.m5.3.3.4.2" xref="S3.I1.i2.p1.5.m5.3.3.4.2.cmml">T</mi><mi id="S3.I1.i2.p1.5.m5.3.3.4.3" xref="S3.I1.i2.p1.5.m5.3.3.4.3.cmml">M</mi></msub><mo id="S3.I1.i2.p1.5.m5.3.3.3" xref="S3.I1.i2.p1.5.m5.3.3.3.cmml">⁢</mo><mrow id="S3.I1.i2.p1.5.m5.3.3.2.2" xref="S3.I1.i2.p1.5.m5.3.3.2.3.cmml"><mo id="S3.I1.i2.p1.5.m5.3.3.2.2.3" stretchy="false" xref="S3.I1.i2.p1.5.m5.3.3.2.3.cmml">[</mo><mi id="S3.I1.i2.p1.5.m5.1.1" xref="S3.I1.i2.p1.5.m5.1.1.cmml">r</mi><mo id="S3.I1.i2.p1.5.m5.3.3.2.2.4" xref="S3.I1.i2.p1.5.m5.3.3.2.3.cmml">,</mo><msub id="S3.I1.i2.p1.5.m5.2.2.1.1.1" xref="S3.I1.i2.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.I1.i2.p1.5.m5.2.2.1.1.1.2" xref="S3.I1.i2.p1.5.m5.2.2.1.1.1.2.cmml">i</mi><mn id="S3.I1.i2.p1.5.m5.2.2.1.1.1.3" xref="S3.I1.i2.p1.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.5.m5.3.3.2.2.5" xref="S3.I1.i2.p1.5.m5.3.3.2.3.cmml">,</mo><msub id="S3.I1.i2.p1.5.m5.3.3.2.2.2" xref="S3.I1.i2.p1.5.m5.3.3.2.2.2.cmml"><mi id="S3.I1.i2.p1.5.m5.3.3.2.2.2.2" xref="S3.I1.i2.p1.5.m5.3.3.2.2.2.2.cmml">j</mi><mn id="S3.I1.i2.p1.5.m5.3.3.2.2.2.3" xref="S3.I1.i2.p1.5.m5.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.5.m5.3.3.2.2.6" stretchy="false" xref="S3.I1.i2.p1.5.m5.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.5.m5.3b"><apply id="S3.I1.i2.p1.5.m5.3.3.cmml" xref="S3.I1.i2.p1.5.m5.3.3"><times id="S3.I1.i2.p1.5.m5.3.3.3.cmml" xref="S3.I1.i2.p1.5.m5.3.3.3"></times><apply id="S3.I1.i2.p1.5.m5.3.3.4.cmml" xref="S3.I1.i2.p1.5.m5.3.3.4"><csymbol cd="ambiguous" id="S3.I1.i2.p1.5.m5.3.3.4.1.cmml" xref="S3.I1.i2.p1.5.m5.3.3.4">subscript</csymbol><ci id="S3.I1.i2.p1.5.m5.3.3.4.2.cmml" xref="S3.I1.i2.p1.5.m5.3.3.4.2">𝑇</ci><ci id="S3.I1.i2.p1.5.m5.3.3.4.3.cmml" xref="S3.I1.i2.p1.5.m5.3.3.4.3">𝑀</ci></apply><list id="S3.I1.i2.p1.5.m5.3.3.2.3.cmml" xref="S3.I1.i2.p1.5.m5.3.3.2.2"><ci id="S3.I1.i2.p1.5.m5.1.1.cmml" xref="S3.I1.i2.p1.5.m5.1.1">𝑟</ci><apply id="S3.I1.i2.p1.5.m5.2.2.1.1.1.cmml" xref="S3.I1.i2.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.I1.i2.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.I1.i2.p1.5.m5.2.2.1.1.1.2">𝑖</ci><cn id="S3.I1.i2.p1.5.m5.2.2.1.1.1.3.cmml" type="integer" xref="S3.I1.i2.p1.5.m5.2.2.1.1.1.3">1</cn></apply><apply id="S3.I1.i2.p1.5.m5.3.3.2.2.2.cmml" xref="S3.I1.i2.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.I1.i2.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.I1.i2.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.I1.i2.p1.5.m5.3.3.2.2.2.2">𝑗</ci><cn id="S3.I1.i2.p1.5.m5.3.3.2.2.2.3.cmml" type="integer" xref="S3.I1.i2.p1.5.m5.3.3.2.2.2.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.5.m5.3c">T_{M}[r,i_{1},j_{1}]</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.5.m5.3d">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math> is not defined, or <math alttext="j_{1}\in\{0,2,\ldots,2L-2\}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.6.m6.4"><semantics id="S3.I1.i2.p1.6.m6.4a"><mrow id="S3.I1.i2.p1.6.m6.4.4" xref="S3.I1.i2.p1.6.m6.4.4.cmml"><msub id="S3.I1.i2.p1.6.m6.4.4.3" xref="S3.I1.i2.p1.6.m6.4.4.3.cmml"><mi id="S3.I1.i2.p1.6.m6.4.4.3.2" xref="S3.I1.i2.p1.6.m6.4.4.3.2.cmml">j</mi><mn id="S3.I1.i2.p1.6.m6.4.4.3.3" xref="S3.I1.i2.p1.6.m6.4.4.3.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.6.m6.4.4.2" xref="S3.I1.i2.p1.6.m6.4.4.2.cmml">∈</mo><mrow id="S3.I1.i2.p1.6.m6.4.4.1.1" xref="S3.I1.i2.p1.6.m6.4.4.1.2.cmml"><mo id="S3.I1.i2.p1.6.m6.4.4.1.1.2" stretchy="false" xref="S3.I1.i2.p1.6.m6.4.4.1.2.cmml">{</mo><mn id="S3.I1.i2.p1.6.m6.1.1" xref="S3.I1.i2.p1.6.m6.1.1.cmml">0</mn><mo id="S3.I1.i2.p1.6.m6.4.4.1.1.3" xref="S3.I1.i2.p1.6.m6.4.4.1.2.cmml">,</mo><mn id="S3.I1.i2.p1.6.m6.2.2" xref="S3.I1.i2.p1.6.m6.2.2.cmml">2</mn><mo id="S3.I1.i2.p1.6.m6.4.4.1.1.4" xref="S3.I1.i2.p1.6.m6.4.4.1.2.cmml">,</mo><mi id="S3.I1.i2.p1.6.m6.3.3" mathvariant="normal" xref="S3.I1.i2.p1.6.m6.3.3.cmml">…</mi><mo id="S3.I1.i2.p1.6.m6.4.4.1.1.5" xref="S3.I1.i2.p1.6.m6.4.4.1.2.cmml">,</mo><mrow id="S3.I1.i2.p1.6.m6.4.4.1.1.1" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.cmml"><mrow id="S3.I1.i2.p1.6.m6.4.4.1.1.1.2" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.cmml"><mn id="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.2" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.2.cmml">2</mn><mo id="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.1" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.3" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.I1.i2.p1.6.m6.4.4.1.1.1.1" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.1.cmml">−</mo><mn id="S3.I1.i2.p1.6.m6.4.4.1.1.1.3" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="S3.I1.i2.p1.6.m6.4.4.1.1.6" stretchy="false" xref="S3.I1.i2.p1.6.m6.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.6.m6.4b"><apply id="S3.I1.i2.p1.6.m6.4.4.cmml" xref="S3.I1.i2.p1.6.m6.4.4"><in id="S3.I1.i2.p1.6.m6.4.4.2.cmml" xref="S3.I1.i2.p1.6.m6.4.4.2"></in><apply id="S3.I1.i2.p1.6.m6.4.4.3.cmml" xref="S3.I1.i2.p1.6.m6.4.4.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.6.m6.4.4.3.1.cmml" xref="S3.I1.i2.p1.6.m6.4.4.3">subscript</csymbol><ci id="S3.I1.i2.p1.6.m6.4.4.3.2.cmml" xref="S3.I1.i2.p1.6.m6.4.4.3.2">𝑗</ci><cn id="S3.I1.i2.p1.6.m6.4.4.3.3.cmml" type="integer" xref="S3.I1.i2.p1.6.m6.4.4.3.3">1</cn></apply><set id="S3.I1.i2.p1.6.m6.4.4.1.2.cmml" xref="S3.I1.i2.p1.6.m6.4.4.1.1"><cn id="S3.I1.i2.p1.6.m6.1.1.cmml" type="integer" xref="S3.I1.i2.p1.6.m6.1.1">0</cn><cn id="S3.I1.i2.p1.6.m6.2.2.cmml" type="integer" xref="S3.I1.i2.p1.6.m6.2.2">2</cn><ci id="S3.I1.i2.p1.6.m6.3.3.cmml" xref="S3.I1.i2.p1.6.m6.3.3">…</ci><apply id="S3.I1.i2.p1.6.m6.4.4.1.1.1.cmml" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1"><minus id="S3.I1.i2.p1.6.m6.4.4.1.1.1.1.cmml" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.1"></minus><apply id="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.cmml" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.2"><times id="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.1"></times><cn id="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.2.cmml" type="integer" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.2">2</cn><ci id="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.3.cmml" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.2.3">𝐿</ci></apply><cn id="S3.I1.i2.p1.6.m6.4.4.1.1.1.3.cmml" type="integer" xref="S3.I1.i2.p1.6.m6.4.4.1.1.1.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.6.m6.4c">j_{1}\in\{0,2,\ldots,2L-2\}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.6.m6.4d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 2 , … , 2 italic_L - 2 }</annotation></semantics></math>. In the latter case, we are in the setting of Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm2" title="Lemma 2. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">2</span></a>, so, as <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="S3.I1.i2.p1.7.m7.1"><semantics id="S3.I1.i2.p1.7.m7.1a"><mrow id="S3.I1.i2.p1.7.m7.1.1" xref="S3.I1.i2.p1.7.m7.1.1.cmml"><mrow id="S3.I1.i2.p1.7.m7.1.1.2" xref="S3.I1.i2.p1.7.m7.1.1.2.cmml"><mrow id="S3.I1.i2.p1.7.m7.1.1.2.2" xref="S3.I1.i2.p1.7.m7.1.1.2.2.cmml"><mi id="S3.I1.i2.p1.7.m7.1.1.2.2.2" xref="S3.I1.i2.p1.7.m7.1.1.2.2.2.cmml">i</mi><mo id="S3.I1.i2.p1.7.m7.1.1.2.2.1" xref="S3.I1.i2.p1.7.m7.1.1.2.2.1.cmml">−</mo><mi id="S3.I1.i2.p1.7.m7.1.1.2.2.3" xref="S3.I1.i2.p1.7.m7.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.I1.i2.p1.7.m7.1.1.2.1" xref="S3.I1.i2.p1.7.m7.1.1.2.1.cmml">+</mo><mn id="S3.I1.i2.p1.7.m7.1.1.2.3" xref="S3.I1.i2.p1.7.m7.1.1.2.3.cmml">1</mn></mrow><mo id="S3.I1.i2.p1.7.m7.1.1.3" xref="S3.I1.i2.p1.7.m7.1.1.3.cmml">≤</mo><mi id="S3.I1.i2.p1.7.m7.1.1.4" xref="S3.I1.i2.p1.7.m7.1.1.4.cmml">j</mi><mo id="S3.I1.i2.p1.7.m7.1.1.5" xref="S3.I1.i2.p1.7.m7.1.1.5.cmml">≤</mo><mi id="S3.I1.i2.p1.7.m7.1.1.6" xref="S3.I1.i2.p1.7.m7.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.7.m7.1b"><apply id="S3.I1.i2.p1.7.m7.1.1.cmml" xref="S3.I1.i2.p1.7.m7.1.1"><and id="S3.I1.i2.p1.7.m7.1.1a.cmml" xref="S3.I1.i2.p1.7.m7.1.1"></and><apply id="S3.I1.i2.p1.7.m7.1.1b.cmml" xref="S3.I1.i2.p1.7.m7.1.1"><leq id="S3.I1.i2.p1.7.m7.1.1.3.cmml" xref="S3.I1.i2.p1.7.m7.1.1.3"></leq><apply id="S3.I1.i2.p1.7.m7.1.1.2.cmml" xref="S3.I1.i2.p1.7.m7.1.1.2"><plus id="S3.I1.i2.p1.7.m7.1.1.2.1.cmml" xref="S3.I1.i2.p1.7.m7.1.1.2.1"></plus><apply id="S3.I1.i2.p1.7.m7.1.1.2.2.cmml" xref="S3.I1.i2.p1.7.m7.1.1.2.2"><minus id="S3.I1.i2.p1.7.m7.1.1.2.2.1.cmml" xref="S3.I1.i2.p1.7.m7.1.1.2.2.1"></minus><ci id="S3.I1.i2.p1.7.m7.1.1.2.2.2.cmml" xref="S3.I1.i2.p1.7.m7.1.1.2.2.2">𝑖</ci><ci id="S3.I1.i2.p1.7.m7.1.1.2.2.3.cmml" xref="S3.I1.i2.p1.7.m7.1.1.2.2.3">𝐿</ci></apply><cn id="S3.I1.i2.p1.7.m7.1.1.2.3.cmml" type="integer" xref="S3.I1.i2.p1.7.m7.1.1.2.3">1</cn></apply><ci id="S3.I1.i2.p1.7.m7.1.1.4.cmml" xref="S3.I1.i2.p1.7.m7.1.1.4">𝑗</ci></apply><apply id="S3.I1.i2.p1.7.m7.1.1c.cmml" xref="S3.I1.i2.p1.7.m7.1.1"><leq id="S3.I1.i2.p1.7.m7.1.1.5.cmml" xref="S3.I1.i2.p1.7.m7.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.I1.i2.p1.7.m7.1.1.4.cmml" id="S3.I1.i2.p1.7.m7.1.1d.cmml" xref="S3.I1.i2.p1.7.m7.1.1"></share><ci id="S3.I1.i2.p1.7.m7.1.1.6.cmml" xref="S3.I1.i2.p1.7.m7.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.7.m7.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.7.m7.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math> does not hold, the inequality <math alttext="i_{1}\leq j_{1}\leq i_{1}+L-1" class="ltx_Math" display="inline" id="S3.I1.i2.p1.8.m8.1"><semantics id="S3.I1.i2.p1.8.m8.1a"><mrow id="S3.I1.i2.p1.8.m8.1.1" xref="S3.I1.i2.p1.8.m8.1.1.cmml"><msub id="S3.I1.i2.p1.8.m8.1.1.2" xref="S3.I1.i2.p1.8.m8.1.1.2.cmml"><mi id="S3.I1.i2.p1.8.m8.1.1.2.2" xref="S3.I1.i2.p1.8.m8.1.1.2.2.cmml">i</mi><mn id="S3.I1.i2.p1.8.m8.1.1.2.3" xref="S3.I1.i2.p1.8.m8.1.1.2.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.8.m8.1.1.3" xref="S3.I1.i2.p1.8.m8.1.1.3.cmml">≤</mo><msub id="S3.I1.i2.p1.8.m8.1.1.4" xref="S3.I1.i2.p1.8.m8.1.1.4.cmml"><mi id="S3.I1.i2.p1.8.m8.1.1.4.2" xref="S3.I1.i2.p1.8.m8.1.1.4.2.cmml">j</mi><mn id="S3.I1.i2.p1.8.m8.1.1.4.3" xref="S3.I1.i2.p1.8.m8.1.1.4.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.8.m8.1.1.5" xref="S3.I1.i2.p1.8.m8.1.1.5.cmml">≤</mo><mrow id="S3.I1.i2.p1.8.m8.1.1.6" xref="S3.I1.i2.p1.8.m8.1.1.6.cmml"><mrow id="S3.I1.i2.p1.8.m8.1.1.6.2" xref="S3.I1.i2.p1.8.m8.1.1.6.2.cmml"><msub id="S3.I1.i2.p1.8.m8.1.1.6.2.2" xref="S3.I1.i2.p1.8.m8.1.1.6.2.2.cmml"><mi id="S3.I1.i2.p1.8.m8.1.1.6.2.2.2" xref="S3.I1.i2.p1.8.m8.1.1.6.2.2.2.cmml">i</mi><mn id="S3.I1.i2.p1.8.m8.1.1.6.2.2.3" xref="S3.I1.i2.p1.8.m8.1.1.6.2.2.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.8.m8.1.1.6.2.1" xref="S3.I1.i2.p1.8.m8.1.1.6.2.1.cmml">+</mo><mi id="S3.I1.i2.p1.8.m8.1.1.6.2.3" xref="S3.I1.i2.p1.8.m8.1.1.6.2.3.cmml">L</mi></mrow><mo id="S3.I1.i2.p1.8.m8.1.1.6.1" xref="S3.I1.i2.p1.8.m8.1.1.6.1.cmml">−</mo><mn id="S3.I1.i2.p1.8.m8.1.1.6.3" xref="S3.I1.i2.p1.8.m8.1.1.6.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.8.m8.1b"><apply id="S3.I1.i2.p1.8.m8.1.1.cmml" xref="S3.I1.i2.p1.8.m8.1.1"><and id="S3.I1.i2.p1.8.m8.1.1a.cmml" xref="S3.I1.i2.p1.8.m8.1.1"></and><apply id="S3.I1.i2.p1.8.m8.1.1b.cmml" xref="S3.I1.i2.p1.8.m8.1.1"><leq id="S3.I1.i2.p1.8.m8.1.1.3.cmml" xref="S3.I1.i2.p1.8.m8.1.1.3"></leq><apply id="S3.I1.i2.p1.8.m8.1.1.2.cmml" xref="S3.I1.i2.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.8.m8.1.1.2.1.cmml" xref="S3.I1.i2.p1.8.m8.1.1.2">subscript</csymbol><ci id="S3.I1.i2.p1.8.m8.1.1.2.2.cmml" xref="S3.I1.i2.p1.8.m8.1.1.2.2">𝑖</ci><cn id="S3.I1.i2.p1.8.m8.1.1.2.3.cmml" type="integer" xref="S3.I1.i2.p1.8.m8.1.1.2.3">1</cn></apply><apply id="S3.I1.i2.p1.8.m8.1.1.4.cmml" xref="S3.I1.i2.p1.8.m8.1.1.4"><csymbol cd="ambiguous" id="S3.I1.i2.p1.8.m8.1.1.4.1.cmml" xref="S3.I1.i2.p1.8.m8.1.1.4">subscript</csymbol><ci id="S3.I1.i2.p1.8.m8.1.1.4.2.cmml" xref="S3.I1.i2.p1.8.m8.1.1.4.2">𝑗</ci><cn id="S3.I1.i2.p1.8.m8.1.1.4.3.cmml" type="integer" xref="S3.I1.i2.p1.8.m8.1.1.4.3">1</cn></apply></apply><apply id="S3.I1.i2.p1.8.m8.1.1c.cmml" xref="S3.I1.i2.p1.8.m8.1.1"><leq id="S3.I1.i2.p1.8.m8.1.1.5.cmml" xref="S3.I1.i2.p1.8.m8.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.I1.i2.p1.8.m8.1.1.4.cmml" id="S3.I1.i2.p1.8.m8.1.1d.cmml" xref="S3.I1.i2.p1.8.m8.1.1"></share><apply id="S3.I1.i2.p1.8.m8.1.1.6.cmml" xref="S3.I1.i2.p1.8.m8.1.1.6"><minus id="S3.I1.i2.p1.8.m8.1.1.6.1.cmml" xref="S3.I1.i2.p1.8.m8.1.1.6.1"></minus><apply id="S3.I1.i2.p1.8.m8.1.1.6.2.cmml" xref="S3.I1.i2.p1.8.m8.1.1.6.2"><plus id="S3.I1.i2.p1.8.m8.1.1.6.2.1.cmml" xref="S3.I1.i2.p1.8.m8.1.1.6.2.1"></plus><apply id="S3.I1.i2.p1.8.m8.1.1.6.2.2.cmml" xref="S3.I1.i2.p1.8.m8.1.1.6.2.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.8.m8.1.1.6.2.2.1.cmml" xref="S3.I1.i2.p1.8.m8.1.1.6.2.2">subscript</csymbol><ci id="S3.I1.i2.p1.8.m8.1.1.6.2.2.2.cmml" xref="S3.I1.i2.p1.8.m8.1.1.6.2.2.2">𝑖</ci><cn id="S3.I1.i2.p1.8.m8.1.1.6.2.2.3.cmml" type="integer" xref="S3.I1.i2.p1.8.m8.1.1.6.2.2.3">1</cn></apply><ci id="S3.I1.i2.p1.8.m8.1.1.6.2.3.cmml" xref="S3.I1.i2.p1.8.m8.1.1.6.2.3">𝐿</ci></apply><cn id="S3.I1.i2.p1.8.m8.1.1.6.3.cmml" type="integer" xref="S3.I1.i2.p1.8.m8.1.1.6.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.8.m8.1c">i_{1}\leq j_{1}\leq i_{1}+L-1</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.8.m8.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_L - 1</annotation></semantics></math> does not hold. From the definition of <math alttext="T_{M}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.9.m9.1"><semantics id="S3.I1.i2.p1.9.m9.1a"><msub id="S3.I1.i2.p1.9.m9.1.1" xref="S3.I1.i2.p1.9.m9.1.1.cmml"><mi id="S3.I1.i2.p1.9.m9.1.1.2" xref="S3.I1.i2.p1.9.m9.1.1.2.cmml">T</mi><mi id="S3.I1.i2.p1.9.m9.1.1.3" xref="S3.I1.i2.p1.9.m9.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.9.m9.1b"><apply id="S3.I1.i2.p1.9.m9.1.1.cmml" xref="S3.I1.i2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.9.m9.1.1.1.cmml" xref="S3.I1.i2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.9.m9.1.1.2.cmml" xref="S3.I1.i2.p1.9.m9.1.1.2">𝑇</ci><ci id="S3.I1.i2.p1.9.m9.1.1.3.cmml" xref="S3.I1.i2.p1.9.m9.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.9.m9.1c">T_{M}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.9.m9.1d">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math>, we conclude that <math alttext="(T_{A}+T_{M})[r,i_{1},j_{1}]=-\infty" class="ltx_Math" display="inline" id="S3.I1.i2.p1.10.m10.4"><semantics id="S3.I1.i2.p1.10.m10.4a"><mrow id="S3.I1.i2.p1.10.m10.4.4" xref="S3.I1.i2.p1.10.m10.4.4.cmml"><mrow id="S3.I1.i2.p1.10.m10.4.4.3" xref="S3.I1.i2.p1.10.m10.4.4.3.cmml"><mrow id="S3.I1.i2.p1.10.m10.2.2.1.1.1" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.cmml"><mo id="S3.I1.i2.p1.10.m10.2.2.1.1.1.2" stretchy="false" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.cmml"><msub id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.cmml"><mi id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.2" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.2.cmml">T</mi><mi id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.3" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.3.cmml">A</mi></msub><mo id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.1" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.1.cmml">+</mo><msub id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.cmml"><mi id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.2" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.2.cmml">T</mi><mi id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.3" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S3.I1.i2.p1.10.m10.2.2.1.1.1.3" stretchy="false" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.I1.i2.p1.10.m10.4.4.3.4" xref="S3.I1.i2.p1.10.m10.4.4.3.4.cmml">⁢</mo><mrow id="S3.I1.i2.p1.10.m10.4.4.3.3.2" xref="S3.I1.i2.p1.10.m10.4.4.3.3.3.cmml"><mo id="S3.I1.i2.p1.10.m10.4.4.3.3.2.3" stretchy="false" xref="S3.I1.i2.p1.10.m10.4.4.3.3.3.cmml">[</mo><mi id="S3.I1.i2.p1.10.m10.1.1" xref="S3.I1.i2.p1.10.m10.1.1.cmml">r</mi><mo id="S3.I1.i2.p1.10.m10.4.4.3.3.2.4" xref="S3.I1.i2.p1.10.m10.4.4.3.3.3.cmml">,</mo><msub id="S3.I1.i2.p1.10.m10.3.3.2.2.1.1" xref="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.cmml"><mi id="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.2" xref="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.2.cmml">i</mi><mn id="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.3" xref="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.10.m10.4.4.3.3.2.5" xref="S3.I1.i2.p1.10.m10.4.4.3.3.3.cmml">,</mo><msub id="S3.I1.i2.p1.10.m10.4.4.3.3.2.2" xref="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.cmml"><mi id="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.2" xref="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.2.cmml">j</mi><mn id="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.3" xref="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.10.m10.4.4.3.3.2.6" stretchy="false" xref="S3.I1.i2.p1.10.m10.4.4.3.3.3.cmml">]</mo></mrow></mrow><mo id="S3.I1.i2.p1.10.m10.4.4.4" xref="S3.I1.i2.p1.10.m10.4.4.4.cmml">=</mo><mrow id="S3.I1.i2.p1.10.m10.4.4.5" xref="S3.I1.i2.p1.10.m10.4.4.5.cmml"><mo id="S3.I1.i2.p1.10.m10.4.4.5a" xref="S3.I1.i2.p1.10.m10.4.4.5.cmml">−</mo><mi id="S3.I1.i2.p1.10.m10.4.4.5.2" mathvariant="normal" xref="S3.I1.i2.p1.10.m10.4.4.5.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.10.m10.4b"><apply id="S3.I1.i2.p1.10.m10.4.4.cmml" xref="S3.I1.i2.p1.10.m10.4.4"><eq id="S3.I1.i2.p1.10.m10.4.4.4.cmml" xref="S3.I1.i2.p1.10.m10.4.4.4"></eq><apply id="S3.I1.i2.p1.10.m10.4.4.3.cmml" xref="S3.I1.i2.p1.10.m10.4.4.3"><times id="S3.I1.i2.p1.10.m10.4.4.3.4.cmml" xref="S3.I1.i2.p1.10.m10.4.4.3.4"></times><apply id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.cmml" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1"><plus id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.1"></plus><apply id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.2.cmml" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.2">𝑇</ci><ci id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.3.cmml" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.2.3">𝐴</ci></apply><apply id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.cmml" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.1.cmml" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.2.cmml" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.2">𝑇</ci><ci id="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.3.cmml" xref="S3.I1.i2.p1.10.m10.2.2.1.1.1.1.3.3">𝑀</ci></apply></apply><list id="S3.I1.i2.p1.10.m10.4.4.3.3.3.cmml" xref="S3.I1.i2.p1.10.m10.4.4.3.3.2"><ci id="S3.I1.i2.p1.10.m10.1.1.cmml" xref="S3.I1.i2.p1.10.m10.1.1">𝑟</ci><apply id="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.cmml" xref="S3.I1.i2.p1.10.m10.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.1.cmml" xref="S3.I1.i2.p1.10.m10.3.3.2.2.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.2.cmml" xref="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.2">𝑖</ci><cn id="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.3.cmml" type="integer" xref="S3.I1.i2.p1.10.m10.3.3.2.2.1.1.3">1</cn></apply><apply id="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.cmml" xref="S3.I1.i2.p1.10.m10.4.4.3.3.2.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.1.cmml" xref="S3.I1.i2.p1.10.m10.4.4.3.3.2.2">subscript</csymbol><ci id="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.2.cmml" xref="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.2">𝑗</ci><cn id="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.3.cmml" type="integer" xref="S3.I1.i2.p1.10.m10.4.4.3.3.2.2.3">1</cn></apply></list></apply><apply id="S3.I1.i2.p1.10.m10.4.4.5.cmml" xref="S3.I1.i2.p1.10.m10.4.4.5"><minus id="S3.I1.i2.p1.10.m10.4.4.5.1.cmml" xref="S3.I1.i2.p1.10.m10.4.4.5"></minus><infinity id="S3.I1.i2.p1.10.m10.4.4.5.2.cmml" xref="S3.I1.i2.p1.10.m10.4.4.5.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.10.m10.4c">(T_{A}+T_{M})[r,i_{1},j_{1}]=-\infty</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.10.m10.4d">( italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT + italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = - ∞</annotation></semantics></math>. That is, we have shown that either <math alttext="(T_{A}+T_{M})[r,i_{1},j_{1}]" class="ltx_Math" display="inline" id="S3.I1.i2.p1.11.m11.4"><semantics id="S3.I1.i2.p1.11.m11.4a"><mrow id="S3.I1.i2.p1.11.m11.4.4" xref="S3.I1.i2.p1.11.m11.4.4.cmml"><mrow id="S3.I1.i2.p1.11.m11.2.2.1.1" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.cmml"><mo id="S3.I1.i2.p1.11.m11.2.2.1.1.2" stretchy="false" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.11.m11.2.2.1.1.1" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.cmml"><msub id="S3.I1.i2.p1.11.m11.2.2.1.1.1.2" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.cmml"><mi id="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.2" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.2.cmml">T</mi><mi id="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.3" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.3.cmml">A</mi></msub><mo id="S3.I1.i2.p1.11.m11.2.2.1.1.1.1" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.1.cmml">+</mo><msub id="S3.I1.i2.p1.11.m11.2.2.1.1.1.3" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.cmml"><mi id="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.2" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.2.cmml">T</mi><mi id="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.3" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S3.I1.i2.p1.11.m11.2.2.1.1.3" stretchy="false" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.I1.i2.p1.11.m11.4.4.4" xref="S3.I1.i2.p1.11.m11.4.4.4.cmml">⁢</mo><mrow id="S3.I1.i2.p1.11.m11.4.4.3.2" xref="S3.I1.i2.p1.11.m11.4.4.3.3.cmml"><mo id="S3.I1.i2.p1.11.m11.4.4.3.2.3" stretchy="false" xref="S3.I1.i2.p1.11.m11.4.4.3.3.cmml">[</mo><mi id="S3.I1.i2.p1.11.m11.1.1" xref="S3.I1.i2.p1.11.m11.1.1.cmml">r</mi><mo id="S3.I1.i2.p1.11.m11.4.4.3.2.4" xref="S3.I1.i2.p1.11.m11.4.4.3.3.cmml">,</mo><msub id="S3.I1.i2.p1.11.m11.3.3.2.1.1" xref="S3.I1.i2.p1.11.m11.3.3.2.1.1.cmml"><mi id="S3.I1.i2.p1.11.m11.3.3.2.1.1.2" xref="S3.I1.i2.p1.11.m11.3.3.2.1.1.2.cmml">i</mi><mn id="S3.I1.i2.p1.11.m11.3.3.2.1.1.3" xref="S3.I1.i2.p1.11.m11.3.3.2.1.1.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.11.m11.4.4.3.2.5" xref="S3.I1.i2.p1.11.m11.4.4.3.3.cmml">,</mo><msub id="S3.I1.i2.p1.11.m11.4.4.3.2.2" xref="S3.I1.i2.p1.11.m11.4.4.3.2.2.cmml"><mi id="S3.I1.i2.p1.11.m11.4.4.3.2.2.2" xref="S3.I1.i2.p1.11.m11.4.4.3.2.2.2.cmml">j</mi><mn id="S3.I1.i2.p1.11.m11.4.4.3.2.2.3" xref="S3.I1.i2.p1.11.m11.4.4.3.2.2.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.11.m11.4.4.3.2.6" stretchy="false" xref="S3.I1.i2.p1.11.m11.4.4.3.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.11.m11.4b"><apply id="S3.I1.i2.p1.11.m11.4.4.cmml" xref="S3.I1.i2.p1.11.m11.4.4"><times id="S3.I1.i2.p1.11.m11.4.4.4.cmml" xref="S3.I1.i2.p1.11.m11.4.4.4"></times><apply id="S3.I1.i2.p1.11.m11.2.2.1.1.1.cmml" xref="S3.I1.i2.p1.11.m11.2.2.1.1"><plus id="S3.I1.i2.p1.11.m11.2.2.1.1.1.1.cmml" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.1"></plus><apply id="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.cmml" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.2">subscript</csymbol><ci id="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.2.cmml" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.2">𝑇</ci><ci id="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.3.cmml" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.2.3">𝐴</ci></apply><apply id="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.cmml" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.1.cmml" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.3">subscript</csymbol><ci id="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.2.cmml" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.2">𝑇</ci><ci id="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.3.cmml" xref="S3.I1.i2.p1.11.m11.2.2.1.1.1.3.3">𝑀</ci></apply></apply><list id="S3.I1.i2.p1.11.m11.4.4.3.3.cmml" xref="S3.I1.i2.p1.11.m11.4.4.3.2"><ci id="S3.I1.i2.p1.11.m11.1.1.cmml" xref="S3.I1.i2.p1.11.m11.1.1">𝑟</ci><apply id="S3.I1.i2.p1.11.m11.3.3.2.1.1.cmml" xref="S3.I1.i2.p1.11.m11.3.3.2.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.11.m11.3.3.2.1.1.1.cmml" xref="S3.I1.i2.p1.11.m11.3.3.2.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.11.m11.3.3.2.1.1.2.cmml" xref="S3.I1.i2.p1.11.m11.3.3.2.1.1.2">𝑖</ci><cn id="S3.I1.i2.p1.11.m11.3.3.2.1.1.3.cmml" type="integer" xref="S3.I1.i2.p1.11.m11.3.3.2.1.1.3">1</cn></apply><apply id="S3.I1.i2.p1.11.m11.4.4.3.2.2.cmml" xref="S3.I1.i2.p1.11.m11.4.4.3.2.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.11.m11.4.4.3.2.2.1.cmml" xref="S3.I1.i2.p1.11.m11.4.4.3.2.2">subscript</csymbol><ci id="S3.I1.i2.p1.11.m11.4.4.3.2.2.2.cmml" xref="S3.I1.i2.p1.11.m11.4.4.3.2.2.2">𝑗</ci><cn id="S3.I1.i2.p1.11.m11.4.4.3.2.2.3.cmml" type="integer" xref="S3.I1.i2.p1.11.m11.4.4.3.2.2.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.11.m11.4c">(T_{A}+T_{M})[r,i_{1},j_{1}]</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.11.m11.4d">( italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT + italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math> is not defined and <math alttext="(QK^{T}+M)[i,j]=-\infty" class="ltx_Math" display="inline" id="S3.I1.i2.p1.12.m12.3"><semantics id="S3.I1.i2.p1.12.m12.3a"><mrow id="S3.I1.i2.p1.12.m12.3.3" xref="S3.I1.i2.p1.12.m12.3.3.cmml"><mrow id="S3.I1.i2.p1.12.m12.3.3.1" xref="S3.I1.i2.p1.12.m12.3.3.1.cmml"><mrow id="S3.I1.i2.p1.12.m12.3.3.1.1.1" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.cmml"><mo id="S3.I1.i2.p1.12.m12.3.3.1.1.1.2" stretchy="false" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.cmml"><mrow id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.cmml"><mi id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.2" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.2.cmml">Q</mi><mo id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.1" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.cmml"><mi id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.2" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.2.cmml">K</mi><mi id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.3" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.1" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.1.cmml">+</mo><mi id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.3" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.3.cmml">M</mi></mrow><mo id="S3.I1.i2.p1.12.m12.3.3.1.1.1.3" stretchy="false" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S3.I1.i2.p1.12.m12.3.3.1.2" xref="S3.I1.i2.p1.12.m12.3.3.1.2.cmml">⁢</mo><mrow id="S3.I1.i2.p1.12.m12.3.3.1.3.2" xref="S3.I1.i2.p1.12.m12.3.3.1.3.1.cmml"><mo id="S3.I1.i2.p1.12.m12.3.3.1.3.2.1" stretchy="false" xref="S3.I1.i2.p1.12.m12.3.3.1.3.1.cmml">[</mo><mi id="S3.I1.i2.p1.12.m12.1.1" xref="S3.I1.i2.p1.12.m12.1.1.cmml">i</mi><mo id="S3.I1.i2.p1.12.m12.3.3.1.3.2.2" xref="S3.I1.i2.p1.12.m12.3.3.1.3.1.cmml">,</mo><mi id="S3.I1.i2.p1.12.m12.2.2" xref="S3.I1.i2.p1.12.m12.2.2.cmml">j</mi><mo id="S3.I1.i2.p1.12.m12.3.3.1.3.2.3" stretchy="false" xref="S3.I1.i2.p1.12.m12.3.3.1.3.1.cmml">]</mo></mrow></mrow><mo id="S3.I1.i2.p1.12.m12.3.3.2" xref="S3.I1.i2.p1.12.m12.3.3.2.cmml">=</mo><mrow id="S3.I1.i2.p1.12.m12.3.3.3" xref="S3.I1.i2.p1.12.m12.3.3.3.cmml"><mo id="S3.I1.i2.p1.12.m12.3.3.3a" xref="S3.I1.i2.p1.12.m12.3.3.3.cmml">−</mo><mi id="S3.I1.i2.p1.12.m12.3.3.3.2" mathvariant="normal" xref="S3.I1.i2.p1.12.m12.3.3.3.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.12.m12.3b"><apply id="S3.I1.i2.p1.12.m12.3.3.cmml" xref="S3.I1.i2.p1.12.m12.3.3"><eq id="S3.I1.i2.p1.12.m12.3.3.2.cmml" xref="S3.I1.i2.p1.12.m12.3.3.2"></eq><apply id="S3.I1.i2.p1.12.m12.3.3.1.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1"><times id="S3.I1.i2.p1.12.m12.3.3.1.2.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.2"></times><apply id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1"><plus id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.1"></plus><apply id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2"><times id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.1"></times><ci id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.2.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.2">𝑄</ci><apply id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.1.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3">superscript</csymbol><ci id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.2.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.2">𝐾</ci><ci id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.3.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.3.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.1.1.1.3">𝑀</ci></apply><interval closure="closed" id="S3.I1.i2.p1.12.m12.3.3.1.3.1.cmml" xref="S3.I1.i2.p1.12.m12.3.3.1.3.2"><ci id="S3.I1.i2.p1.12.m12.1.1.cmml" xref="S3.I1.i2.p1.12.m12.1.1">𝑖</ci><ci id="S3.I1.i2.p1.12.m12.2.2.cmml" xref="S3.I1.i2.p1.12.m12.2.2">𝑗</ci></interval></apply><apply id="S3.I1.i2.p1.12.m12.3.3.3.cmml" xref="S3.I1.i2.p1.12.m12.3.3.3"><minus id="S3.I1.i2.p1.12.m12.3.3.3.1.cmml" xref="S3.I1.i2.p1.12.m12.3.3.3"></minus><infinity id="S3.I1.i2.p1.12.m12.3.3.3.2.cmml" xref="S3.I1.i2.p1.12.m12.3.3.3.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.12.m12.3c">(QK^{T}+M)[i,j]=-\infty</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.12.m12.3d">( italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_M ) [ italic_i , italic_j ] = - ∞</annotation></semantics></math>, or <math alttext="(T_{A}+T_{M})[r,i_{1},j_{1}]=-\infty" class="ltx_Math" display="inline" id="S3.I1.i2.p1.13.m13.4"><semantics id="S3.I1.i2.p1.13.m13.4a"><mrow id="S3.I1.i2.p1.13.m13.4.4" xref="S3.I1.i2.p1.13.m13.4.4.cmml"><mrow id="S3.I1.i2.p1.13.m13.4.4.3" xref="S3.I1.i2.p1.13.m13.4.4.3.cmml"><mrow id="S3.I1.i2.p1.13.m13.2.2.1.1.1" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.cmml"><mo id="S3.I1.i2.p1.13.m13.2.2.1.1.1.2" stretchy="false" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.cmml"><msub id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.cmml"><mi id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.2" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.2.cmml">T</mi><mi id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.3" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.3.cmml">A</mi></msub><mo id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.1" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.1.cmml">+</mo><msub id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.cmml"><mi id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.2" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.2.cmml">T</mi><mi id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.3" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S3.I1.i2.p1.13.m13.2.2.1.1.1.3" stretchy="false" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.I1.i2.p1.13.m13.4.4.3.4" xref="S3.I1.i2.p1.13.m13.4.4.3.4.cmml">⁢</mo><mrow id="S3.I1.i2.p1.13.m13.4.4.3.3.2" xref="S3.I1.i2.p1.13.m13.4.4.3.3.3.cmml"><mo id="S3.I1.i2.p1.13.m13.4.4.3.3.2.3" stretchy="false" xref="S3.I1.i2.p1.13.m13.4.4.3.3.3.cmml">[</mo><mi id="S3.I1.i2.p1.13.m13.1.1" xref="S3.I1.i2.p1.13.m13.1.1.cmml">r</mi><mo id="S3.I1.i2.p1.13.m13.4.4.3.3.2.4" xref="S3.I1.i2.p1.13.m13.4.4.3.3.3.cmml">,</mo><msub id="S3.I1.i2.p1.13.m13.3.3.2.2.1.1" xref="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.cmml"><mi id="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.2" xref="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.2.cmml">i</mi><mn id="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.3" xref="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.13.m13.4.4.3.3.2.5" xref="S3.I1.i2.p1.13.m13.4.4.3.3.3.cmml">,</mo><msub id="S3.I1.i2.p1.13.m13.4.4.3.3.2.2" xref="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.cmml"><mi id="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.2" xref="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.2.cmml">j</mi><mn id="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.3" xref="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.13.m13.4.4.3.3.2.6" stretchy="false" xref="S3.I1.i2.p1.13.m13.4.4.3.3.3.cmml">]</mo></mrow></mrow><mo id="S3.I1.i2.p1.13.m13.4.4.4" xref="S3.I1.i2.p1.13.m13.4.4.4.cmml">=</mo><mrow id="S3.I1.i2.p1.13.m13.4.4.5" xref="S3.I1.i2.p1.13.m13.4.4.5.cmml"><mo id="S3.I1.i2.p1.13.m13.4.4.5a" xref="S3.I1.i2.p1.13.m13.4.4.5.cmml">−</mo><mi id="S3.I1.i2.p1.13.m13.4.4.5.2" mathvariant="normal" xref="S3.I1.i2.p1.13.m13.4.4.5.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.13.m13.4b"><apply id="S3.I1.i2.p1.13.m13.4.4.cmml" xref="S3.I1.i2.p1.13.m13.4.4"><eq id="S3.I1.i2.p1.13.m13.4.4.4.cmml" xref="S3.I1.i2.p1.13.m13.4.4.4"></eq><apply id="S3.I1.i2.p1.13.m13.4.4.3.cmml" xref="S3.I1.i2.p1.13.m13.4.4.3"><times id="S3.I1.i2.p1.13.m13.4.4.3.4.cmml" xref="S3.I1.i2.p1.13.m13.4.4.3.4"></times><apply id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.cmml" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1"><plus id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.1"></plus><apply id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.2.cmml" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.2">𝑇</ci><ci id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.3.cmml" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.2.3">𝐴</ci></apply><apply id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.cmml" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.1.cmml" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.2.cmml" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.2">𝑇</ci><ci id="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.3.cmml" xref="S3.I1.i2.p1.13.m13.2.2.1.1.1.1.3.3">𝑀</ci></apply></apply><list id="S3.I1.i2.p1.13.m13.4.4.3.3.3.cmml" xref="S3.I1.i2.p1.13.m13.4.4.3.3.2"><ci id="S3.I1.i2.p1.13.m13.1.1.cmml" xref="S3.I1.i2.p1.13.m13.1.1">𝑟</ci><apply id="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.cmml" xref="S3.I1.i2.p1.13.m13.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.1.cmml" xref="S3.I1.i2.p1.13.m13.3.3.2.2.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.2.cmml" xref="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.2">𝑖</ci><cn id="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.3.cmml" type="integer" xref="S3.I1.i2.p1.13.m13.3.3.2.2.1.1.3">1</cn></apply><apply id="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.cmml" xref="S3.I1.i2.p1.13.m13.4.4.3.3.2.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.1.cmml" xref="S3.I1.i2.p1.13.m13.4.4.3.3.2.2">subscript</csymbol><ci id="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.2.cmml" xref="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.2">𝑗</ci><cn id="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.3.cmml" type="integer" xref="S3.I1.i2.p1.13.m13.4.4.3.3.2.2.3">1</cn></apply></list></apply><apply id="S3.I1.i2.p1.13.m13.4.4.5.cmml" xref="S3.I1.i2.p1.13.m13.4.4.5"><minus id="S3.I1.i2.p1.13.m13.4.4.5.1.cmml" xref="S3.I1.i2.p1.13.m13.4.4.5"></minus><infinity id="S3.I1.i2.p1.13.m13.4.4.5.2.cmml" xref="S3.I1.i2.p1.13.m13.4.4.5.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.13.m13.4c">(T_{A}+T_{M})[r,i_{1},j_{1}]=-\infty</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.13.m13.4d">( italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT + italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = - ∞</annotation></semantics></math> and <math alttext="(QK^{T}+M)[i,j]=-\infty" class="ltx_Math" display="inline" id="S3.I1.i2.p1.14.m14.3"><semantics id="S3.I1.i2.p1.14.m14.3a"><mrow id="S3.I1.i2.p1.14.m14.3.3" xref="S3.I1.i2.p1.14.m14.3.3.cmml"><mrow id="S3.I1.i2.p1.14.m14.3.3.1" xref="S3.I1.i2.p1.14.m14.3.3.1.cmml"><mrow id="S3.I1.i2.p1.14.m14.3.3.1.1.1" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.cmml"><mo id="S3.I1.i2.p1.14.m14.3.3.1.1.1.2" stretchy="false" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.cmml"><mrow id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.cmml"><mi id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.2" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.2.cmml">Q</mi><mo id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.1" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.cmml"><mi id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.2" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.2.cmml">K</mi><mi id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.3" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.1" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.1.cmml">+</mo><mi id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.3" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.3.cmml">M</mi></mrow><mo id="S3.I1.i2.p1.14.m14.3.3.1.1.1.3" stretchy="false" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S3.I1.i2.p1.14.m14.3.3.1.2" xref="S3.I1.i2.p1.14.m14.3.3.1.2.cmml">⁢</mo><mrow id="S3.I1.i2.p1.14.m14.3.3.1.3.2" xref="S3.I1.i2.p1.14.m14.3.3.1.3.1.cmml"><mo id="S3.I1.i2.p1.14.m14.3.3.1.3.2.1" stretchy="false" xref="S3.I1.i2.p1.14.m14.3.3.1.3.1.cmml">[</mo><mi id="S3.I1.i2.p1.14.m14.1.1" xref="S3.I1.i2.p1.14.m14.1.1.cmml">i</mi><mo id="S3.I1.i2.p1.14.m14.3.3.1.3.2.2" xref="S3.I1.i2.p1.14.m14.3.3.1.3.1.cmml">,</mo><mi id="S3.I1.i2.p1.14.m14.2.2" xref="S3.I1.i2.p1.14.m14.2.2.cmml">j</mi><mo id="S3.I1.i2.p1.14.m14.3.3.1.3.2.3" stretchy="false" xref="S3.I1.i2.p1.14.m14.3.3.1.3.1.cmml">]</mo></mrow></mrow><mo id="S3.I1.i2.p1.14.m14.3.3.2" xref="S3.I1.i2.p1.14.m14.3.3.2.cmml">=</mo><mrow id="S3.I1.i2.p1.14.m14.3.3.3" xref="S3.I1.i2.p1.14.m14.3.3.3.cmml"><mo id="S3.I1.i2.p1.14.m14.3.3.3a" xref="S3.I1.i2.p1.14.m14.3.3.3.cmml">−</mo><mi id="S3.I1.i2.p1.14.m14.3.3.3.2" mathvariant="normal" xref="S3.I1.i2.p1.14.m14.3.3.3.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.14.m14.3b"><apply id="S3.I1.i2.p1.14.m14.3.3.cmml" xref="S3.I1.i2.p1.14.m14.3.3"><eq id="S3.I1.i2.p1.14.m14.3.3.2.cmml" xref="S3.I1.i2.p1.14.m14.3.3.2"></eq><apply id="S3.I1.i2.p1.14.m14.3.3.1.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1"><times id="S3.I1.i2.p1.14.m14.3.3.1.2.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.2"></times><apply id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1"><plus id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.1"></plus><apply id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2"><times id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.1"></times><ci id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.2.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.2">𝑄</ci><apply id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.1.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3">superscript</csymbol><ci id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.2.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.2">𝐾</ci><ci id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.3.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.3.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.1.1.1.3">𝑀</ci></apply><interval closure="closed" id="S3.I1.i2.p1.14.m14.3.3.1.3.1.cmml" xref="S3.I1.i2.p1.14.m14.3.3.1.3.2"><ci id="S3.I1.i2.p1.14.m14.1.1.cmml" xref="S3.I1.i2.p1.14.m14.1.1">𝑖</ci><ci id="S3.I1.i2.p1.14.m14.2.2.cmml" xref="S3.I1.i2.p1.14.m14.2.2">𝑗</ci></interval></apply><apply id="S3.I1.i2.p1.14.m14.3.3.3.cmml" xref="S3.I1.i2.p1.14.m14.3.3.3"><minus id="S3.I1.i2.p1.14.m14.3.3.3.1.cmml" xref="S3.I1.i2.p1.14.m14.3.3.3"></minus><infinity id="S3.I1.i2.p1.14.m14.3.3.3.2.cmml" xref="S3.I1.i2.p1.14.m14.3.3.3.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.14.m14.3c">(QK^{T}+M)[i,j]=-\infty</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.14.m14.3d">( italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_M ) [ italic_i , italic_j ] = - ∞</annotation></semantics></math>.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S3.3.p1.18">Applying the operator <math alttext="\operatorname{softmax}" class="ltx_Math" display="inline" id="S3.3.p1.7.m1.1"><semantics id="S3.3.p1.7.m1.1a"><mi id="S3.3.p1.7.m1.1.1" xref="S3.3.p1.7.m1.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S3.3.p1.7.m1.1b"><ci id="S3.3.p1.7.m1.1.1.cmml" xref="S3.3.p1.7.m1.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.7.m1.1c">\operatorname{softmax}</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.7.m1.1d">roman_softmax</annotation></semantics></math> to the <math alttext="i" class="ltx_Math" display="inline" id="S3.3.p1.8.m2.1"><semantics id="S3.3.p1.8.m2.1a"><mi id="S3.3.p1.8.m2.1.1" xref="S3.3.p1.8.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.3.p1.8.m2.1b"><ci id="S3.3.p1.8.m2.1.1.cmml" xref="S3.3.p1.8.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.8.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.8.m2.1d">italic_i</annotation></semantics></math>-th row of <math alttext="(QK^{T}+M)" class="ltx_Math" display="inline" id="S3.3.p1.9.m3.1"><semantics id="S3.3.p1.9.m3.1a"><mrow id="S3.3.p1.9.m3.1.1.1" xref="S3.3.p1.9.m3.1.1.1.1.cmml"><mo id="S3.3.p1.9.m3.1.1.1.2" stretchy="false" xref="S3.3.p1.9.m3.1.1.1.1.cmml">(</mo><mrow id="S3.3.p1.9.m3.1.1.1.1" xref="S3.3.p1.9.m3.1.1.1.1.cmml"><mrow id="S3.3.p1.9.m3.1.1.1.1.2" xref="S3.3.p1.9.m3.1.1.1.1.2.cmml"><mi id="S3.3.p1.9.m3.1.1.1.1.2.2" xref="S3.3.p1.9.m3.1.1.1.1.2.2.cmml">Q</mi><mo id="S3.3.p1.9.m3.1.1.1.1.2.1" xref="S3.3.p1.9.m3.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.3.p1.9.m3.1.1.1.1.2.3" xref="S3.3.p1.9.m3.1.1.1.1.2.3.cmml"><mi id="S3.3.p1.9.m3.1.1.1.1.2.3.2" xref="S3.3.p1.9.m3.1.1.1.1.2.3.2.cmml">K</mi><mi id="S3.3.p1.9.m3.1.1.1.1.2.3.3" xref="S3.3.p1.9.m3.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="S3.3.p1.9.m3.1.1.1.1.1" xref="S3.3.p1.9.m3.1.1.1.1.1.cmml">+</mo><mi id="S3.3.p1.9.m3.1.1.1.1.3" xref="S3.3.p1.9.m3.1.1.1.1.3.cmml">M</mi></mrow><mo id="S3.3.p1.9.m3.1.1.1.3" stretchy="false" xref="S3.3.p1.9.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.9.m3.1b"><apply id="S3.3.p1.9.m3.1.1.1.1.cmml" xref="S3.3.p1.9.m3.1.1.1"><plus id="S3.3.p1.9.m3.1.1.1.1.1.cmml" xref="S3.3.p1.9.m3.1.1.1.1.1"></plus><apply id="S3.3.p1.9.m3.1.1.1.1.2.cmml" xref="S3.3.p1.9.m3.1.1.1.1.2"><times id="S3.3.p1.9.m3.1.1.1.1.2.1.cmml" xref="S3.3.p1.9.m3.1.1.1.1.2.1"></times><ci id="S3.3.p1.9.m3.1.1.1.1.2.2.cmml" xref="S3.3.p1.9.m3.1.1.1.1.2.2">𝑄</ci><apply id="S3.3.p1.9.m3.1.1.1.1.2.3.cmml" xref="S3.3.p1.9.m3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.3.p1.9.m3.1.1.1.1.2.3.1.cmml" xref="S3.3.p1.9.m3.1.1.1.1.2.3">superscript</csymbol><ci id="S3.3.p1.9.m3.1.1.1.1.2.3.2.cmml" xref="S3.3.p1.9.m3.1.1.1.1.2.3.2">𝐾</ci><ci id="S3.3.p1.9.m3.1.1.1.1.2.3.3.cmml" xref="S3.3.p1.9.m3.1.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S3.3.p1.9.m3.1.1.1.1.3.cmml" xref="S3.3.p1.9.m3.1.1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.9.m3.1c">(QK^{T}+M)</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.9.m3.1d">( italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_M )</annotation></semantics></math>, leads to all entries equal to zero except for those entries indexed by <math alttext="(i,j)" class="ltx_Math" display="inline" id="S3.3.p1.10.m4.2"><semantics id="S3.3.p1.10.m4.2a"><mrow id="S3.3.p1.10.m4.2.3.2" xref="S3.3.p1.10.m4.2.3.1.cmml"><mo id="S3.3.p1.10.m4.2.3.2.1" stretchy="false" xref="S3.3.p1.10.m4.2.3.1.cmml">(</mo><mi id="S3.3.p1.10.m4.1.1" xref="S3.3.p1.10.m4.1.1.cmml">i</mi><mo id="S3.3.p1.10.m4.2.3.2.2" xref="S3.3.p1.10.m4.2.3.1.cmml">,</mo><mi id="S3.3.p1.10.m4.2.2" xref="S3.3.p1.10.m4.2.2.cmml">j</mi><mo id="S3.3.p1.10.m4.2.3.2.3" stretchy="false" xref="S3.3.p1.10.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.10.m4.2b"><interval closure="open" id="S3.3.p1.10.m4.2.3.1.cmml" xref="S3.3.p1.10.m4.2.3.2"><ci id="S3.3.p1.10.m4.1.1.cmml" xref="S3.3.p1.10.m4.1.1">𝑖</ci><ci id="S3.3.p1.10.m4.2.2.cmml" xref="S3.3.p1.10.m4.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.10.m4.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.10.m4.2d">( italic_i , italic_j )</annotation></semantics></math> with <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="S3.3.p1.11.m5.1"><semantics id="S3.3.p1.11.m5.1a"><mrow id="S3.3.p1.11.m5.1.1" xref="S3.3.p1.11.m5.1.1.cmml"><mrow id="S3.3.p1.11.m5.1.1.2" xref="S3.3.p1.11.m5.1.1.2.cmml"><mrow id="S3.3.p1.11.m5.1.1.2.2" xref="S3.3.p1.11.m5.1.1.2.2.cmml"><mi id="S3.3.p1.11.m5.1.1.2.2.2" xref="S3.3.p1.11.m5.1.1.2.2.2.cmml">i</mi><mo id="S3.3.p1.11.m5.1.1.2.2.1" xref="S3.3.p1.11.m5.1.1.2.2.1.cmml">−</mo><mi id="S3.3.p1.11.m5.1.1.2.2.3" xref="S3.3.p1.11.m5.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.3.p1.11.m5.1.1.2.1" xref="S3.3.p1.11.m5.1.1.2.1.cmml">+</mo><mn id="S3.3.p1.11.m5.1.1.2.3" xref="S3.3.p1.11.m5.1.1.2.3.cmml">1</mn></mrow><mo id="S3.3.p1.11.m5.1.1.3" xref="S3.3.p1.11.m5.1.1.3.cmml">≤</mo><mi id="S3.3.p1.11.m5.1.1.4" xref="S3.3.p1.11.m5.1.1.4.cmml">j</mi><mo id="S3.3.p1.11.m5.1.1.5" xref="S3.3.p1.11.m5.1.1.5.cmml">≤</mo><mi id="S3.3.p1.11.m5.1.1.6" xref="S3.3.p1.11.m5.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.11.m5.1b"><apply id="S3.3.p1.11.m5.1.1.cmml" xref="S3.3.p1.11.m5.1.1"><and id="S3.3.p1.11.m5.1.1a.cmml" xref="S3.3.p1.11.m5.1.1"></and><apply id="S3.3.p1.11.m5.1.1b.cmml" xref="S3.3.p1.11.m5.1.1"><leq id="S3.3.p1.11.m5.1.1.3.cmml" xref="S3.3.p1.11.m5.1.1.3"></leq><apply id="S3.3.p1.11.m5.1.1.2.cmml" xref="S3.3.p1.11.m5.1.1.2"><plus id="S3.3.p1.11.m5.1.1.2.1.cmml" xref="S3.3.p1.11.m5.1.1.2.1"></plus><apply id="S3.3.p1.11.m5.1.1.2.2.cmml" xref="S3.3.p1.11.m5.1.1.2.2"><minus id="S3.3.p1.11.m5.1.1.2.2.1.cmml" xref="S3.3.p1.11.m5.1.1.2.2.1"></minus><ci id="S3.3.p1.11.m5.1.1.2.2.2.cmml" xref="S3.3.p1.11.m5.1.1.2.2.2">𝑖</ci><ci id="S3.3.p1.11.m5.1.1.2.2.3.cmml" xref="S3.3.p1.11.m5.1.1.2.2.3">𝐿</ci></apply><cn id="S3.3.p1.11.m5.1.1.2.3.cmml" type="integer" xref="S3.3.p1.11.m5.1.1.2.3">1</cn></apply><ci id="S3.3.p1.11.m5.1.1.4.cmml" xref="S3.3.p1.11.m5.1.1.4">𝑗</ci></apply><apply id="S3.3.p1.11.m5.1.1c.cmml" xref="S3.3.p1.11.m5.1.1"><leq id="S3.3.p1.11.m5.1.1.5.cmml" xref="S3.3.p1.11.m5.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.3.p1.11.m5.1.1.4.cmml" id="S3.3.p1.11.m5.1.1d.cmml" xref="S3.3.p1.11.m5.1.1"></share><ci id="S3.3.p1.11.m5.1.1.6.cmml" xref="S3.3.p1.11.m5.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.11.m5.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.11.m5.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math> (a total of <math alttext="L" class="ltx_Math" display="inline" id="S3.3.p1.12.m6.1"><semantics id="S3.3.p1.12.m6.1a"><mi id="S3.3.p1.12.m6.1.1" xref="S3.3.p1.12.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.3.p1.12.m6.1b"><ci id="S3.3.p1.12.m6.1.1.cmml" xref="S3.3.p1.12.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.12.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.12.m6.1d">italic_L</annotation></semantics></math> entries). Analogously, applying the operator <math alttext="\operatorname{softmax}" class="ltx_Math" display="inline" id="S3.3.p1.13.m7.1"><semantics id="S3.3.p1.13.m7.1a"><mi id="S3.3.p1.13.m7.1.1" xref="S3.3.p1.13.m7.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="S3.3.p1.13.m7.1b"><ci id="S3.3.p1.13.m7.1.1.cmml" xref="S3.3.p1.13.m7.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.13.m7.1c">\operatorname{softmax}</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.13.m7.1d">roman_softmax</annotation></semantics></math> to <math alttext="(T_{A}+T_{M})[r,i_{1},\cdot]" class="ltx_Math" display="inline" id="S3.3.p1.14.m8.4"><semantics id="S3.3.p1.14.m8.4a"><mrow id="S3.3.p1.14.m8.4.4" xref="S3.3.p1.14.m8.4.4.cmml"><mrow id="S3.3.p1.14.m8.3.3.1.1" xref="S3.3.p1.14.m8.3.3.1.1.1.cmml"><mo id="S3.3.p1.14.m8.3.3.1.1.2" stretchy="false" xref="S3.3.p1.14.m8.3.3.1.1.1.cmml">(</mo><mrow id="S3.3.p1.14.m8.3.3.1.1.1" xref="S3.3.p1.14.m8.3.3.1.1.1.cmml"><msub id="S3.3.p1.14.m8.3.3.1.1.1.2" xref="S3.3.p1.14.m8.3.3.1.1.1.2.cmml"><mi id="S3.3.p1.14.m8.3.3.1.1.1.2.2" xref="S3.3.p1.14.m8.3.3.1.1.1.2.2.cmml">T</mi><mi id="S3.3.p1.14.m8.3.3.1.1.1.2.3" xref="S3.3.p1.14.m8.3.3.1.1.1.2.3.cmml">A</mi></msub><mo id="S3.3.p1.14.m8.3.3.1.1.1.1" xref="S3.3.p1.14.m8.3.3.1.1.1.1.cmml">+</mo><msub id="S3.3.p1.14.m8.3.3.1.1.1.3" xref="S3.3.p1.14.m8.3.3.1.1.1.3.cmml"><mi id="S3.3.p1.14.m8.3.3.1.1.1.3.2" xref="S3.3.p1.14.m8.3.3.1.1.1.3.2.cmml">T</mi><mi id="S3.3.p1.14.m8.3.3.1.1.1.3.3" xref="S3.3.p1.14.m8.3.3.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S3.3.p1.14.m8.3.3.1.1.3" stretchy="false" xref="S3.3.p1.14.m8.3.3.1.1.1.cmml">)</mo></mrow><mo id="S3.3.p1.14.m8.4.4.3" xref="S3.3.p1.14.m8.4.4.3.cmml">⁢</mo><mrow id="S3.3.p1.14.m8.4.4.2.1" xref="S3.3.p1.14.m8.4.4.2.2.cmml"><mo id="S3.3.p1.14.m8.4.4.2.1.2" stretchy="false" xref="S3.3.p1.14.m8.4.4.2.2.cmml">[</mo><mi id="S3.3.p1.14.m8.1.1" xref="S3.3.p1.14.m8.1.1.cmml">r</mi><mo id="S3.3.p1.14.m8.4.4.2.1.3" xref="S3.3.p1.14.m8.4.4.2.2.cmml">,</mo><msub id="S3.3.p1.14.m8.4.4.2.1.1" xref="S3.3.p1.14.m8.4.4.2.1.1.cmml"><mi id="S3.3.p1.14.m8.4.4.2.1.1.2" xref="S3.3.p1.14.m8.4.4.2.1.1.2.cmml">i</mi><mn id="S3.3.p1.14.m8.4.4.2.1.1.3" xref="S3.3.p1.14.m8.4.4.2.1.1.3.cmml">1</mn></msub><mo id="S3.3.p1.14.m8.4.4.2.1.4" rspace="0em" xref="S3.3.p1.14.m8.4.4.2.2.cmml">,</mo><mo id="S3.3.p1.14.m8.2.2" lspace="0em" rspace="0em" xref="S3.3.p1.14.m8.2.2.cmml">⋅</mo><mo id="S3.3.p1.14.m8.4.4.2.1.5" stretchy="false" xref="S3.3.p1.14.m8.4.4.2.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.14.m8.4b"><apply id="S3.3.p1.14.m8.4.4.cmml" xref="S3.3.p1.14.m8.4.4"><times id="S3.3.p1.14.m8.4.4.3.cmml" xref="S3.3.p1.14.m8.4.4.3"></times><apply id="S3.3.p1.14.m8.3.3.1.1.1.cmml" xref="S3.3.p1.14.m8.3.3.1.1"><plus id="S3.3.p1.14.m8.3.3.1.1.1.1.cmml" xref="S3.3.p1.14.m8.3.3.1.1.1.1"></plus><apply id="S3.3.p1.14.m8.3.3.1.1.1.2.cmml" xref="S3.3.p1.14.m8.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.3.p1.14.m8.3.3.1.1.1.2.1.cmml" xref="S3.3.p1.14.m8.3.3.1.1.1.2">subscript</csymbol><ci id="S3.3.p1.14.m8.3.3.1.1.1.2.2.cmml" xref="S3.3.p1.14.m8.3.3.1.1.1.2.2">𝑇</ci><ci id="S3.3.p1.14.m8.3.3.1.1.1.2.3.cmml" xref="S3.3.p1.14.m8.3.3.1.1.1.2.3">𝐴</ci></apply><apply id="S3.3.p1.14.m8.3.3.1.1.1.3.cmml" xref="S3.3.p1.14.m8.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.3.p1.14.m8.3.3.1.1.1.3.1.cmml" xref="S3.3.p1.14.m8.3.3.1.1.1.3">subscript</csymbol><ci id="S3.3.p1.14.m8.3.3.1.1.1.3.2.cmml" xref="S3.3.p1.14.m8.3.3.1.1.1.3.2">𝑇</ci><ci id="S3.3.p1.14.m8.3.3.1.1.1.3.3.cmml" xref="S3.3.p1.14.m8.3.3.1.1.1.3.3">𝑀</ci></apply></apply><list id="S3.3.p1.14.m8.4.4.2.2.cmml" xref="S3.3.p1.14.m8.4.4.2.1"><ci id="S3.3.p1.14.m8.1.1.cmml" xref="S3.3.p1.14.m8.1.1">𝑟</ci><apply id="S3.3.p1.14.m8.4.4.2.1.1.cmml" xref="S3.3.p1.14.m8.4.4.2.1.1"><csymbol cd="ambiguous" id="S3.3.p1.14.m8.4.4.2.1.1.1.cmml" xref="S3.3.p1.14.m8.4.4.2.1.1">subscript</csymbol><ci id="S3.3.p1.14.m8.4.4.2.1.1.2.cmml" xref="S3.3.p1.14.m8.4.4.2.1.1.2">𝑖</ci><cn id="S3.3.p1.14.m8.4.4.2.1.1.3.cmml" type="integer" xref="S3.3.p1.14.m8.4.4.2.1.1.3">1</cn></apply><ci id="S3.3.p1.14.m8.2.2.cmml" xref="S3.3.p1.14.m8.2.2">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.14.m8.4c">(T_{A}+T_{M})[r,i_{1},\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.14.m8.4d">( italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT + italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋅ ]</annotation></semantics></math>, leads to all entries equal to zero except for those entries indexed by <math alttext="(i_{1},j_{1})" class="ltx_Math" display="inline" id="S3.3.p1.15.m9.2"><semantics id="S3.3.p1.15.m9.2a"><mrow id="S3.3.p1.15.m9.2.2.2" xref="S3.3.p1.15.m9.2.2.3.cmml"><mo id="S3.3.p1.15.m9.2.2.2.3" stretchy="false" xref="S3.3.p1.15.m9.2.2.3.cmml">(</mo><msub id="S3.3.p1.15.m9.1.1.1.1" xref="S3.3.p1.15.m9.1.1.1.1.cmml"><mi id="S3.3.p1.15.m9.1.1.1.1.2" xref="S3.3.p1.15.m9.1.1.1.1.2.cmml">i</mi><mn id="S3.3.p1.15.m9.1.1.1.1.3" xref="S3.3.p1.15.m9.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.3.p1.15.m9.2.2.2.4" xref="S3.3.p1.15.m9.2.2.3.cmml">,</mo><msub id="S3.3.p1.15.m9.2.2.2.2" xref="S3.3.p1.15.m9.2.2.2.2.cmml"><mi id="S3.3.p1.15.m9.2.2.2.2.2" xref="S3.3.p1.15.m9.2.2.2.2.2.cmml">j</mi><mn id="S3.3.p1.15.m9.2.2.2.2.3" xref="S3.3.p1.15.m9.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.3.p1.15.m9.2.2.2.5" stretchy="false" xref="S3.3.p1.15.m9.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.15.m9.2b"><interval closure="open" id="S3.3.p1.15.m9.2.2.3.cmml" xref="S3.3.p1.15.m9.2.2.2"><apply id="S3.3.p1.15.m9.1.1.1.1.cmml" xref="S3.3.p1.15.m9.1.1.1.1"><csymbol cd="ambiguous" id="S3.3.p1.15.m9.1.1.1.1.1.cmml" xref="S3.3.p1.15.m9.1.1.1.1">subscript</csymbol><ci id="S3.3.p1.15.m9.1.1.1.1.2.cmml" xref="S3.3.p1.15.m9.1.1.1.1.2">𝑖</ci><cn id="S3.3.p1.15.m9.1.1.1.1.3.cmml" type="integer" xref="S3.3.p1.15.m9.1.1.1.1.3">1</cn></apply><apply id="S3.3.p1.15.m9.2.2.2.2.cmml" xref="S3.3.p1.15.m9.2.2.2.2"><csymbol cd="ambiguous" id="S3.3.p1.15.m9.2.2.2.2.1.cmml" xref="S3.3.p1.15.m9.2.2.2.2">subscript</csymbol><ci id="S3.3.p1.15.m9.2.2.2.2.2.cmml" xref="S3.3.p1.15.m9.2.2.2.2.2">𝑗</ci><cn id="S3.3.p1.15.m9.2.2.2.2.3.cmml" type="integer" xref="S3.3.p1.15.m9.2.2.2.2.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.15.m9.2c">(i_{1},j_{1})</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.15.m9.2d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math> with <math alttext="i_{1}\leq j_{1}\leq i_{1}+L-1" class="ltx_Math" display="inline" id="S3.3.p1.16.m10.1"><semantics id="S3.3.p1.16.m10.1a"><mrow id="S3.3.p1.16.m10.1.1" xref="S3.3.p1.16.m10.1.1.cmml"><msub id="S3.3.p1.16.m10.1.1.2" xref="S3.3.p1.16.m10.1.1.2.cmml"><mi id="S3.3.p1.16.m10.1.1.2.2" xref="S3.3.p1.16.m10.1.1.2.2.cmml">i</mi><mn id="S3.3.p1.16.m10.1.1.2.3" xref="S3.3.p1.16.m10.1.1.2.3.cmml">1</mn></msub><mo id="S3.3.p1.16.m10.1.1.3" xref="S3.3.p1.16.m10.1.1.3.cmml">≤</mo><msub id="S3.3.p1.16.m10.1.1.4" xref="S3.3.p1.16.m10.1.1.4.cmml"><mi id="S3.3.p1.16.m10.1.1.4.2" xref="S3.3.p1.16.m10.1.1.4.2.cmml">j</mi><mn id="S3.3.p1.16.m10.1.1.4.3" xref="S3.3.p1.16.m10.1.1.4.3.cmml">1</mn></msub><mo id="S3.3.p1.16.m10.1.1.5" xref="S3.3.p1.16.m10.1.1.5.cmml">≤</mo><mrow id="S3.3.p1.16.m10.1.1.6" xref="S3.3.p1.16.m10.1.1.6.cmml"><mrow id="S3.3.p1.16.m10.1.1.6.2" xref="S3.3.p1.16.m10.1.1.6.2.cmml"><msub id="S3.3.p1.16.m10.1.1.6.2.2" xref="S3.3.p1.16.m10.1.1.6.2.2.cmml"><mi id="S3.3.p1.16.m10.1.1.6.2.2.2" xref="S3.3.p1.16.m10.1.1.6.2.2.2.cmml">i</mi><mn id="S3.3.p1.16.m10.1.1.6.2.2.3" xref="S3.3.p1.16.m10.1.1.6.2.2.3.cmml">1</mn></msub><mo id="S3.3.p1.16.m10.1.1.6.2.1" xref="S3.3.p1.16.m10.1.1.6.2.1.cmml">+</mo><mi id="S3.3.p1.16.m10.1.1.6.2.3" xref="S3.3.p1.16.m10.1.1.6.2.3.cmml">L</mi></mrow><mo id="S3.3.p1.16.m10.1.1.6.1" xref="S3.3.p1.16.m10.1.1.6.1.cmml">−</mo><mn id="S3.3.p1.16.m10.1.1.6.3" xref="S3.3.p1.16.m10.1.1.6.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.3.p1.16.m10.1b"><apply id="S3.3.p1.16.m10.1.1.cmml" xref="S3.3.p1.16.m10.1.1"><and id="S3.3.p1.16.m10.1.1a.cmml" xref="S3.3.p1.16.m10.1.1"></and><apply id="S3.3.p1.16.m10.1.1b.cmml" xref="S3.3.p1.16.m10.1.1"><leq id="S3.3.p1.16.m10.1.1.3.cmml" xref="S3.3.p1.16.m10.1.1.3"></leq><apply id="S3.3.p1.16.m10.1.1.2.cmml" xref="S3.3.p1.16.m10.1.1.2"><csymbol cd="ambiguous" id="S3.3.p1.16.m10.1.1.2.1.cmml" xref="S3.3.p1.16.m10.1.1.2">subscript</csymbol><ci id="S3.3.p1.16.m10.1.1.2.2.cmml" xref="S3.3.p1.16.m10.1.1.2.2">𝑖</ci><cn id="S3.3.p1.16.m10.1.1.2.3.cmml" type="integer" xref="S3.3.p1.16.m10.1.1.2.3">1</cn></apply><apply id="S3.3.p1.16.m10.1.1.4.cmml" xref="S3.3.p1.16.m10.1.1.4"><csymbol cd="ambiguous" id="S3.3.p1.16.m10.1.1.4.1.cmml" xref="S3.3.p1.16.m10.1.1.4">subscript</csymbol><ci id="S3.3.p1.16.m10.1.1.4.2.cmml" xref="S3.3.p1.16.m10.1.1.4.2">𝑗</ci><cn id="S3.3.p1.16.m10.1.1.4.3.cmml" type="integer" xref="S3.3.p1.16.m10.1.1.4.3">1</cn></apply></apply><apply id="S3.3.p1.16.m10.1.1c.cmml" xref="S3.3.p1.16.m10.1.1"><leq id="S3.3.p1.16.m10.1.1.5.cmml" xref="S3.3.p1.16.m10.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.3.p1.16.m10.1.1.4.cmml" id="S3.3.p1.16.m10.1.1d.cmml" xref="S3.3.p1.16.m10.1.1"></share><apply id="S3.3.p1.16.m10.1.1.6.cmml" xref="S3.3.p1.16.m10.1.1.6"><minus id="S3.3.p1.16.m10.1.1.6.1.cmml" xref="S3.3.p1.16.m10.1.1.6.1"></minus><apply id="S3.3.p1.16.m10.1.1.6.2.cmml" xref="S3.3.p1.16.m10.1.1.6.2"><plus id="S3.3.p1.16.m10.1.1.6.2.1.cmml" xref="S3.3.p1.16.m10.1.1.6.2.1"></plus><apply id="S3.3.p1.16.m10.1.1.6.2.2.cmml" xref="S3.3.p1.16.m10.1.1.6.2.2"><csymbol cd="ambiguous" id="S3.3.p1.16.m10.1.1.6.2.2.1.cmml" xref="S3.3.p1.16.m10.1.1.6.2.2">subscript</csymbol><ci id="S3.3.p1.16.m10.1.1.6.2.2.2.cmml" xref="S3.3.p1.16.m10.1.1.6.2.2.2">𝑖</ci><cn id="S3.3.p1.16.m10.1.1.6.2.2.3.cmml" type="integer" xref="S3.3.p1.16.m10.1.1.6.2.2.3">1</cn></apply><ci id="S3.3.p1.16.m10.1.1.6.2.3.cmml" xref="S3.3.p1.16.m10.1.1.6.2.3">𝐿</ci></apply><cn id="S3.3.p1.16.m10.1.1.6.3.cmml" type="integer" xref="S3.3.p1.16.m10.1.1.6.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.16.m10.1c">i_{1}\leq j_{1}\leq i_{1}+L-1</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.16.m10.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_L - 1</annotation></semantics></math> (a total of <math alttext="L" class="ltx_Math" display="inline" id="S3.3.p1.17.m11.1"><semantics id="S3.3.p1.17.m11.1a"><mi id="S3.3.p1.17.m11.1.1" xref="S3.3.p1.17.m11.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.3.p1.17.m11.1b"><ci id="S3.3.p1.17.m11.1.1.cmml" xref="S3.3.p1.17.m11.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.17.m11.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.17.m11.1d">italic_L</annotation></semantics></math> entries). Moreover, <math alttext="L" class="ltx_Math" display="inline" id="S3.3.p1.18.m12.1"><semantics id="S3.3.p1.18.m12.1a"><mi id="S3.3.p1.18.m12.1.1" xref="S3.3.p1.18.m12.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.3.p1.18.m12.1b"><ci id="S3.3.p1.18.m12.1.1.cmml" xref="S3.3.p1.18.m12.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.3.p1.18.m12.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.3.p1.18.m12.1d">italic_L</annotation></semantics></math> non-zero entries are the same in both cases. Summarising, we have shown that:</p>
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.2">when <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="S3.I2.i1.p1.1.m1.1"><semantics id="S3.I2.i1.p1.1.m1.1a"><mrow id="S3.I2.i1.p1.1.m1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.cmml"><mrow id="S3.I2.i1.p1.1.m1.1.1.2" xref="S3.I2.i1.p1.1.m1.1.1.2.cmml"><mrow id="S3.I2.i1.p1.1.m1.1.1.2.2" xref="S3.I2.i1.p1.1.m1.1.1.2.2.cmml"><mi id="S3.I2.i1.p1.1.m1.1.1.2.2.2" xref="S3.I2.i1.p1.1.m1.1.1.2.2.2.cmml">i</mi><mo id="S3.I2.i1.p1.1.m1.1.1.2.2.1" xref="S3.I2.i1.p1.1.m1.1.1.2.2.1.cmml">−</mo><mi id="S3.I2.i1.p1.1.m1.1.1.2.2.3" xref="S3.I2.i1.p1.1.m1.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.I2.i1.p1.1.m1.1.1.2.1" xref="S3.I2.i1.p1.1.m1.1.1.2.1.cmml">+</mo><mn id="S3.I2.i1.p1.1.m1.1.1.2.3" xref="S3.I2.i1.p1.1.m1.1.1.2.3.cmml">1</mn></mrow><mo id="S3.I2.i1.p1.1.m1.1.1.3" xref="S3.I2.i1.p1.1.m1.1.1.3.cmml">≤</mo><mi id="S3.I2.i1.p1.1.m1.1.1.4" xref="S3.I2.i1.p1.1.m1.1.1.4.cmml">j</mi><mo id="S3.I2.i1.p1.1.m1.1.1.5" xref="S3.I2.i1.p1.1.m1.1.1.5.cmml">≤</mo><mi id="S3.I2.i1.p1.1.m1.1.1.6" xref="S3.I2.i1.p1.1.m1.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.m1.1b"><apply id="S3.I2.i1.p1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1"><and id="S3.I2.i1.p1.1.m1.1.1a.cmml" xref="S3.I2.i1.p1.1.m1.1.1"></and><apply id="S3.I2.i1.p1.1.m1.1.1b.cmml" xref="S3.I2.i1.p1.1.m1.1.1"><leq id="S3.I2.i1.p1.1.m1.1.1.3.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3"></leq><apply id="S3.I2.i1.p1.1.m1.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2"><plus id="S3.I2.i1.p1.1.m1.1.1.2.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2.1"></plus><apply id="S3.I2.i1.p1.1.m1.1.1.2.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2.2"><minus id="S3.I2.i1.p1.1.m1.1.1.2.2.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2.2.1"></minus><ci id="S3.I2.i1.p1.1.m1.1.1.2.2.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2.2.2">𝑖</ci><ci id="S3.I2.i1.p1.1.m1.1.1.2.2.3.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2.2.3">𝐿</ci></apply><cn id="S3.I2.i1.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S3.I2.i1.p1.1.m1.1.1.2.3">1</cn></apply><ci id="S3.I2.i1.p1.1.m1.1.1.4.cmml" xref="S3.I2.i1.p1.1.m1.1.1.4">𝑗</ci></apply><apply id="S3.I2.i1.p1.1.m1.1.1c.cmml" xref="S3.I2.i1.p1.1.m1.1.1"><leq id="S3.I2.i1.p1.1.m1.1.1.5.cmml" xref="S3.I2.i1.p1.1.m1.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.I2.i1.p1.1.m1.1.1.4.cmml" id="S3.I2.i1.p1.1.m1.1.1d.cmml" xref="S3.I2.i1.p1.1.m1.1.1"></share><ci id="S3.I2.i1.p1.1.m1.1.1.6.cmml" xref="S3.I2.i1.p1.1.m1.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.m1.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.1.m1.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math>, we have <math alttext="S[i,j]=T_{S}[r,i_{1},j_{1}]" class="ltx_Math" display="inline" id="S3.I2.i1.p1.2.m2.5"><semantics id="S3.I2.i1.p1.2.m2.5a"><mrow id="S3.I2.i1.p1.2.m2.5.5" xref="S3.I2.i1.p1.2.m2.5.5.cmml"><mrow id="S3.I2.i1.p1.2.m2.5.5.4" xref="S3.I2.i1.p1.2.m2.5.5.4.cmml"><mi id="S3.I2.i1.p1.2.m2.5.5.4.2" xref="S3.I2.i1.p1.2.m2.5.5.4.2.cmml">S</mi><mo id="S3.I2.i1.p1.2.m2.5.5.4.1" xref="S3.I2.i1.p1.2.m2.5.5.4.1.cmml">⁢</mo><mrow id="S3.I2.i1.p1.2.m2.5.5.4.3.2" xref="S3.I2.i1.p1.2.m2.5.5.4.3.1.cmml"><mo id="S3.I2.i1.p1.2.m2.5.5.4.3.2.1" stretchy="false" xref="S3.I2.i1.p1.2.m2.5.5.4.3.1.cmml">[</mo><mi id="S3.I2.i1.p1.2.m2.1.1" xref="S3.I2.i1.p1.2.m2.1.1.cmml">i</mi><mo id="S3.I2.i1.p1.2.m2.5.5.4.3.2.2" xref="S3.I2.i1.p1.2.m2.5.5.4.3.1.cmml">,</mo><mi id="S3.I2.i1.p1.2.m2.2.2" xref="S3.I2.i1.p1.2.m2.2.2.cmml">j</mi><mo id="S3.I2.i1.p1.2.m2.5.5.4.3.2.3" stretchy="false" xref="S3.I2.i1.p1.2.m2.5.5.4.3.1.cmml">]</mo></mrow></mrow><mo id="S3.I2.i1.p1.2.m2.5.5.3" xref="S3.I2.i1.p1.2.m2.5.5.3.cmml">=</mo><mrow id="S3.I2.i1.p1.2.m2.5.5.2" xref="S3.I2.i1.p1.2.m2.5.5.2.cmml"><msub id="S3.I2.i1.p1.2.m2.5.5.2.4" xref="S3.I2.i1.p1.2.m2.5.5.2.4.cmml"><mi id="S3.I2.i1.p1.2.m2.5.5.2.4.2" xref="S3.I2.i1.p1.2.m2.5.5.2.4.2.cmml">T</mi><mi id="S3.I2.i1.p1.2.m2.5.5.2.4.3" xref="S3.I2.i1.p1.2.m2.5.5.2.4.3.cmml">S</mi></msub><mo id="S3.I2.i1.p1.2.m2.5.5.2.3" xref="S3.I2.i1.p1.2.m2.5.5.2.3.cmml">⁢</mo><mrow id="S3.I2.i1.p1.2.m2.5.5.2.2.2" xref="S3.I2.i1.p1.2.m2.5.5.2.2.3.cmml"><mo id="S3.I2.i1.p1.2.m2.5.5.2.2.2.3" stretchy="false" xref="S3.I2.i1.p1.2.m2.5.5.2.2.3.cmml">[</mo><mi id="S3.I2.i1.p1.2.m2.3.3" xref="S3.I2.i1.p1.2.m2.3.3.cmml">r</mi><mo id="S3.I2.i1.p1.2.m2.5.5.2.2.2.4" xref="S3.I2.i1.p1.2.m2.5.5.2.2.3.cmml">,</mo><msub id="S3.I2.i1.p1.2.m2.4.4.1.1.1.1" xref="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.cmml"><mi id="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.2" xref="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.2.cmml">i</mi><mn id="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.3" xref="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.I2.i1.p1.2.m2.5.5.2.2.2.5" xref="S3.I2.i1.p1.2.m2.5.5.2.2.3.cmml">,</mo><msub id="S3.I2.i1.p1.2.m2.5.5.2.2.2.2" xref="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.cmml"><mi id="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.2" xref="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.2.cmml">j</mi><mn id="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.3" xref="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.I2.i1.p1.2.m2.5.5.2.2.2.6" stretchy="false" xref="S3.I2.i1.p1.2.m2.5.5.2.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.2.m2.5b"><apply id="S3.I2.i1.p1.2.m2.5.5.cmml" xref="S3.I2.i1.p1.2.m2.5.5"><eq id="S3.I2.i1.p1.2.m2.5.5.3.cmml" xref="S3.I2.i1.p1.2.m2.5.5.3"></eq><apply id="S3.I2.i1.p1.2.m2.5.5.4.cmml" xref="S3.I2.i1.p1.2.m2.5.5.4"><times id="S3.I2.i1.p1.2.m2.5.5.4.1.cmml" xref="S3.I2.i1.p1.2.m2.5.5.4.1"></times><ci id="S3.I2.i1.p1.2.m2.5.5.4.2.cmml" xref="S3.I2.i1.p1.2.m2.5.5.4.2">𝑆</ci><interval closure="closed" id="S3.I2.i1.p1.2.m2.5.5.4.3.1.cmml" xref="S3.I2.i1.p1.2.m2.5.5.4.3.2"><ci id="S3.I2.i1.p1.2.m2.1.1.cmml" xref="S3.I2.i1.p1.2.m2.1.1">𝑖</ci><ci id="S3.I2.i1.p1.2.m2.2.2.cmml" xref="S3.I2.i1.p1.2.m2.2.2">𝑗</ci></interval></apply><apply id="S3.I2.i1.p1.2.m2.5.5.2.cmml" xref="S3.I2.i1.p1.2.m2.5.5.2"><times id="S3.I2.i1.p1.2.m2.5.5.2.3.cmml" xref="S3.I2.i1.p1.2.m2.5.5.2.3"></times><apply id="S3.I2.i1.p1.2.m2.5.5.2.4.cmml" xref="S3.I2.i1.p1.2.m2.5.5.2.4"><csymbol cd="ambiguous" id="S3.I2.i1.p1.2.m2.5.5.2.4.1.cmml" xref="S3.I2.i1.p1.2.m2.5.5.2.4">subscript</csymbol><ci id="S3.I2.i1.p1.2.m2.5.5.2.4.2.cmml" xref="S3.I2.i1.p1.2.m2.5.5.2.4.2">𝑇</ci><ci id="S3.I2.i1.p1.2.m2.5.5.2.4.3.cmml" xref="S3.I2.i1.p1.2.m2.5.5.2.4.3">𝑆</ci></apply><list id="S3.I2.i1.p1.2.m2.5.5.2.2.3.cmml" xref="S3.I2.i1.p1.2.m2.5.5.2.2.2"><ci id="S3.I2.i1.p1.2.m2.3.3.cmml" xref="S3.I2.i1.p1.2.m2.3.3">𝑟</ci><apply id="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.cmml" xref="S3.I2.i1.p1.2.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.1.cmml" xref="S3.I2.i1.p1.2.m2.4.4.1.1.1.1">subscript</csymbol><ci id="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.2.cmml" xref="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.2">𝑖</ci><cn id="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.3.cmml" type="integer" xref="S3.I2.i1.p1.2.m2.4.4.1.1.1.1.3">1</cn></apply><apply id="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.cmml" xref="S3.I2.i1.p1.2.m2.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.1.cmml" xref="S3.I2.i1.p1.2.m2.5.5.2.2.2.2">subscript</csymbol><ci id="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.2.cmml" xref="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.2">𝑗</ci><cn id="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.3.cmml" type="integer" xref="S3.I2.i1.p1.2.m2.5.5.2.2.2.2.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.2.m2.5c">S[i,j]=T_{S}[r,i_{1},j_{1}]</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.2.m2.5d">italic_S [ italic_i , italic_j ] = italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.5">when <math alttext="i-L+1\leq j\leq i" class="ltx_Math" display="inline" id="S3.I2.i2.p1.1.m1.1"><semantics id="S3.I2.i2.p1.1.m1.1a"><mrow id="S3.I2.i2.p1.1.m1.1.1" xref="S3.I2.i2.p1.1.m1.1.1.cmml"><mrow id="S3.I2.i2.p1.1.m1.1.1.2" xref="S3.I2.i2.p1.1.m1.1.1.2.cmml"><mrow id="S3.I2.i2.p1.1.m1.1.1.2.2" xref="S3.I2.i2.p1.1.m1.1.1.2.2.cmml"><mi id="S3.I2.i2.p1.1.m1.1.1.2.2.2" xref="S3.I2.i2.p1.1.m1.1.1.2.2.2.cmml">i</mi><mo id="S3.I2.i2.p1.1.m1.1.1.2.2.1" xref="S3.I2.i2.p1.1.m1.1.1.2.2.1.cmml">−</mo><mi id="S3.I2.i2.p1.1.m1.1.1.2.2.3" xref="S3.I2.i2.p1.1.m1.1.1.2.2.3.cmml">L</mi></mrow><mo id="S3.I2.i2.p1.1.m1.1.1.2.1" xref="S3.I2.i2.p1.1.m1.1.1.2.1.cmml">+</mo><mn id="S3.I2.i2.p1.1.m1.1.1.2.3" xref="S3.I2.i2.p1.1.m1.1.1.2.3.cmml">1</mn></mrow><mo id="S3.I2.i2.p1.1.m1.1.1.3" xref="S3.I2.i2.p1.1.m1.1.1.3.cmml">≤</mo><mi id="S3.I2.i2.p1.1.m1.1.1.4" xref="S3.I2.i2.p1.1.m1.1.1.4.cmml">j</mi><mo id="S3.I2.i2.p1.1.m1.1.1.5" xref="S3.I2.i2.p1.1.m1.1.1.5.cmml">≤</mo><mi id="S3.I2.i2.p1.1.m1.1.1.6" xref="S3.I2.i2.p1.1.m1.1.1.6.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.1.m1.1b"><apply id="S3.I2.i2.p1.1.m1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1"><and id="S3.I2.i2.p1.1.m1.1.1a.cmml" xref="S3.I2.i2.p1.1.m1.1.1"></and><apply id="S3.I2.i2.p1.1.m1.1.1b.cmml" xref="S3.I2.i2.p1.1.m1.1.1"><leq id="S3.I2.i2.p1.1.m1.1.1.3.cmml" xref="S3.I2.i2.p1.1.m1.1.1.3"></leq><apply id="S3.I2.i2.p1.1.m1.1.1.2.cmml" xref="S3.I2.i2.p1.1.m1.1.1.2"><plus id="S3.I2.i2.p1.1.m1.1.1.2.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1.2.1"></plus><apply id="S3.I2.i2.p1.1.m1.1.1.2.2.cmml" xref="S3.I2.i2.p1.1.m1.1.1.2.2"><minus id="S3.I2.i2.p1.1.m1.1.1.2.2.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1.2.2.1"></minus><ci id="S3.I2.i2.p1.1.m1.1.1.2.2.2.cmml" xref="S3.I2.i2.p1.1.m1.1.1.2.2.2">𝑖</ci><ci id="S3.I2.i2.p1.1.m1.1.1.2.2.3.cmml" xref="S3.I2.i2.p1.1.m1.1.1.2.2.3">𝐿</ci></apply><cn id="S3.I2.i2.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S3.I2.i2.p1.1.m1.1.1.2.3">1</cn></apply><ci id="S3.I2.i2.p1.1.m1.1.1.4.cmml" xref="S3.I2.i2.p1.1.m1.1.1.4">𝑗</ci></apply><apply id="S3.I2.i2.p1.1.m1.1.1c.cmml" xref="S3.I2.i2.p1.1.m1.1.1"><leq id="S3.I2.i2.p1.1.m1.1.1.5.cmml" xref="S3.I2.i2.p1.1.m1.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#S3.I2.i2.p1.1.m1.1.1.4.cmml" id="S3.I2.i2.p1.1.m1.1.1d.cmml" xref="S3.I2.i2.p1.1.m1.1.1"></share><ci id="S3.I2.i2.p1.1.m1.1.1.6.cmml" xref="S3.I2.i2.p1.1.m1.1.1.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.1.m1.1c">i-L+1\leq j\leq i</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.1.m1.1d">italic_i - italic_L + 1 ≤ italic_j ≤ italic_i</annotation></semantics></math> does not hold, we have <math alttext="S[i,j]=0" class="ltx_Math" display="inline" id="S3.I2.i2.p1.2.m2.2"><semantics id="S3.I2.i2.p1.2.m2.2a"><mrow id="S3.I2.i2.p1.2.m2.2.3" xref="S3.I2.i2.p1.2.m2.2.3.cmml"><mrow id="S3.I2.i2.p1.2.m2.2.3.2" xref="S3.I2.i2.p1.2.m2.2.3.2.cmml"><mi id="S3.I2.i2.p1.2.m2.2.3.2.2" xref="S3.I2.i2.p1.2.m2.2.3.2.2.cmml">S</mi><mo id="S3.I2.i2.p1.2.m2.2.3.2.1" xref="S3.I2.i2.p1.2.m2.2.3.2.1.cmml">⁢</mo><mrow id="S3.I2.i2.p1.2.m2.2.3.2.3.2" xref="S3.I2.i2.p1.2.m2.2.3.2.3.1.cmml"><mo id="S3.I2.i2.p1.2.m2.2.3.2.3.2.1" stretchy="false" xref="S3.I2.i2.p1.2.m2.2.3.2.3.1.cmml">[</mo><mi id="S3.I2.i2.p1.2.m2.1.1" xref="S3.I2.i2.p1.2.m2.1.1.cmml">i</mi><mo id="S3.I2.i2.p1.2.m2.2.3.2.3.2.2" xref="S3.I2.i2.p1.2.m2.2.3.2.3.1.cmml">,</mo><mi id="S3.I2.i2.p1.2.m2.2.2" xref="S3.I2.i2.p1.2.m2.2.2.cmml">j</mi><mo id="S3.I2.i2.p1.2.m2.2.3.2.3.2.3" stretchy="false" xref="S3.I2.i2.p1.2.m2.2.3.2.3.1.cmml">]</mo></mrow></mrow><mo id="S3.I2.i2.p1.2.m2.2.3.1" xref="S3.I2.i2.p1.2.m2.2.3.1.cmml">=</mo><mn id="S3.I2.i2.p1.2.m2.2.3.3" xref="S3.I2.i2.p1.2.m2.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.2.m2.2b"><apply id="S3.I2.i2.p1.2.m2.2.3.cmml" xref="S3.I2.i2.p1.2.m2.2.3"><eq id="S3.I2.i2.p1.2.m2.2.3.1.cmml" xref="S3.I2.i2.p1.2.m2.2.3.1"></eq><apply id="S3.I2.i2.p1.2.m2.2.3.2.cmml" xref="S3.I2.i2.p1.2.m2.2.3.2"><times id="S3.I2.i2.p1.2.m2.2.3.2.1.cmml" xref="S3.I2.i2.p1.2.m2.2.3.2.1"></times><ci id="S3.I2.i2.p1.2.m2.2.3.2.2.cmml" xref="S3.I2.i2.p1.2.m2.2.3.2.2">𝑆</ci><interval closure="closed" id="S3.I2.i2.p1.2.m2.2.3.2.3.1.cmml" xref="S3.I2.i2.p1.2.m2.2.3.2.3.2"><ci id="S3.I2.i2.p1.2.m2.1.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1">𝑖</ci><ci id="S3.I2.i2.p1.2.m2.2.2.cmml" xref="S3.I2.i2.p1.2.m2.2.2">𝑗</ci></interval></apply><cn id="S3.I2.i2.p1.2.m2.2.3.3.cmml" type="integer" xref="S3.I2.i2.p1.2.m2.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.2.m2.2c">S[i,j]=0</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.2.m2.2d">italic_S [ italic_i , italic_j ] = 0</annotation></semantics></math> and either <math alttext="T_{S}[r,i_{1},j_{1}]" class="ltx_Math" display="inline" id="S3.I2.i2.p1.3.m3.3"><semantics id="S3.I2.i2.p1.3.m3.3a"><mrow id="S3.I2.i2.p1.3.m3.3.3" xref="S3.I2.i2.p1.3.m3.3.3.cmml"><msub id="S3.I2.i2.p1.3.m3.3.3.4" xref="S3.I2.i2.p1.3.m3.3.3.4.cmml"><mi id="S3.I2.i2.p1.3.m3.3.3.4.2" xref="S3.I2.i2.p1.3.m3.3.3.4.2.cmml">T</mi><mi id="S3.I2.i2.p1.3.m3.3.3.4.3" xref="S3.I2.i2.p1.3.m3.3.3.4.3.cmml">S</mi></msub><mo id="S3.I2.i2.p1.3.m3.3.3.3" xref="S3.I2.i2.p1.3.m3.3.3.3.cmml">⁢</mo><mrow id="S3.I2.i2.p1.3.m3.3.3.2.2" xref="S3.I2.i2.p1.3.m3.3.3.2.3.cmml"><mo id="S3.I2.i2.p1.3.m3.3.3.2.2.3" stretchy="false" xref="S3.I2.i2.p1.3.m3.3.3.2.3.cmml">[</mo><mi id="S3.I2.i2.p1.3.m3.1.1" xref="S3.I2.i2.p1.3.m3.1.1.cmml">r</mi><mo id="S3.I2.i2.p1.3.m3.3.3.2.2.4" xref="S3.I2.i2.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.I2.i2.p1.3.m3.2.2.1.1.1" xref="S3.I2.i2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.I2.i2.p1.3.m3.2.2.1.1.1.2" xref="S3.I2.i2.p1.3.m3.2.2.1.1.1.2.cmml">i</mi><mn id="S3.I2.i2.p1.3.m3.2.2.1.1.1.3" xref="S3.I2.i2.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.I2.i2.p1.3.m3.3.3.2.2.5" xref="S3.I2.i2.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.I2.i2.p1.3.m3.3.3.2.2.2" xref="S3.I2.i2.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.I2.i2.p1.3.m3.3.3.2.2.2.2" xref="S3.I2.i2.p1.3.m3.3.3.2.2.2.2.cmml">j</mi><mn id="S3.I2.i2.p1.3.m3.3.3.2.2.2.3" xref="S3.I2.i2.p1.3.m3.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.I2.i2.p1.3.m3.3.3.2.2.6" stretchy="false" xref="S3.I2.i2.p1.3.m3.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.3.m3.3b"><apply id="S3.I2.i2.p1.3.m3.3.3.cmml" xref="S3.I2.i2.p1.3.m3.3.3"><times id="S3.I2.i2.p1.3.m3.3.3.3.cmml" xref="S3.I2.i2.p1.3.m3.3.3.3"></times><apply id="S3.I2.i2.p1.3.m3.3.3.4.cmml" xref="S3.I2.i2.p1.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.I2.i2.p1.3.m3.3.3.4.1.cmml" xref="S3.I2.i2.p1.3.m3.3.3.4">subscript</csymbol><ci id="S3.I2.i2.p1.3.m3.3.3.4.2.cmml" xref="S3.I2.i2.p1.3.m3.3.3.4.2">𝑇</ci><ci id="S3.I2.i2.p1.3.m3.3.3.4.3.cmml" xref="S3.I2.i2.p1.3.m3.3.3.4.3">𝑆</ci></apply><list id="S3.I2.i2.p1.3.m3.3.3.2.3.cmml" xref="S3.I2.i2.p1.3.m3.3.3.2.2"><ci id="S3.I2.i2.p1.3.m3.1.1.cmml" xref="S3.I2.i2.p1.3.m3.1.1">𝑟</ci><apply id="S3.I2.i2.p1.3.m3.2.2.1.1.1.cmml" xref="S3.I2.i2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.I2.i2.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.I2.i2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.I2.i2.p1.3.m3.2.2.1.1.1.2">𝑖</ci><cn id="S3.I2.i2.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.I2.i2.p1.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S3.I2.i2.p1.3.m3.3.3.2.2.2.cmml" xref="S3.I2.i2.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.I2.i2.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.I2.i2.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.I2.i2.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.I2.i2.p1.3.m3.3.3.2.2.2.2">𝑗</ci><cn id="S3.I2.i2.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.I2.i2.p1.3.m3.3.3.2.2.2.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.3.m3.3c">T_{S}[r,i_{1},j_{1}]</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.3.m3.3d">italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math> is not defined (case <math alttext="j_{1}\not\in\{0,1,\ldots,2L-2\}" class="ltx_Math" display="inline" id="S3.I2.i2.p1.4.m4.4"><semantics id="S3.I2.i2.p1.4.m4.4a"><mrow id="S3.I2.i2.p1.4.m4.4.4" xref="S3.I2.i2.p1.4.m4.4.4.cmml"><msub id="S3.I2.i2.p1.4.m4.4.4.3" xref="S3.I2.i2.p1.4.m4.4.4.3.cmml"><mi id="S3.I2.i2.p1.4.m4.4.4.3.2" xref="S3.I2.i2.p1.4.m4.4.4.3.2.cmml">j</mi><mn id="S3.I2.i2.p1.4.m4.4.4.3.3" xref="S3.I2.i2.p1.4.m4.4.4.3.3.cmml">1</mn></msub><mo id="S3.I2.i2.p1.4.m4.4.4.2" xref="S3.I2.i2.p1.4.m4.4.4.2.cmml">∉</mo><mrow id="S3.I2.i2.p1.4.m4.4.4.1.1" xref="S3.I2.i2.p1.4.m4.4.4.1.2.cmml"><mo id="S3.I2.i2.p1.4.m4.4.4.1.1.2" stretchy="false" xref="S3.I2.i2.p1.4.m4.4.4.1.2.cmml">{</mo><mn id="S3.I2.i2.p1.4.m4.1.1" xref="S3.I2.i2.p1.4.m4.1.1.cmml">0</mn><mo id="S3.I2.i2.p1.4.m4.4.4.1.1.3" xref="S3.I2.i2.p1.4.m4.4.4.1.2.cmml">,</mo><mn id="S3.I2.i2.p1.4.m4.2.2" xref="S3.I2.i2.p1.4.m4.2.2.cmml">1</mn><mo id="S3.I2.i2.p1.4.m4.4.4.1.1.4" xref="S3.I2.i2.p1.4.m4.4.4.1.2.cmml">,</mo><mi id="S3.I2.i2.p1.4.m4.3.3" mathvariant="normal" xref="S3.I2.i2.p1.4.m4.3.3.cmml">…</mi><mo id="S3.I2.i2.p1.4.m4.4.4.1.1.5" xref="S3.I2.i2.p1.4.m4.4.4.1.2.cmml">,</mo><mrow id="S3.I2.i2.p1.4.m4.4.4.1.1.1" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.cmml"><mrow id="S3.I2.i2.p1.4.m4.4.4.1.1.1.2" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.cmml"><mn id="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.2" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.2.cmml">2</mn><mo id="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.1" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.3" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.I2.i2.p1.4.m4.4.4.1.1.1.1" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.1.cmml">−</mo><mn id="S3.I2.i2.p1.4.m4.4.4.1.1.1.3" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="S3.I2.i2.p1.4.m4.4.4.1.1.6" stretchy="false" xref="S3.I2.i2.p1.4.m4.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.4.m4.4b"><apply id="S3.I2.i2.p1.4.m4.4.4.cmml" xref="S3.I2.i2.p1.4.m4.4.4"><notin id="S3.I2.i2.p1.4.m4.4.4.2.cmml" xref="S3.I2.i2.p1.4.m4.4.4.2"></notin><apply id="S3.I2.i2.p1.4.m4.4.4.3.cmml" xref="S3.I2.i2.p1.4.m4.4.4.3"><csymbol cd="ambiguous" id="S3.I2.i2.p1.4.m4.4.4.3.1.cmml" xref="S3.I2.i2.p1.4.m4.4.4.3">subscript</csymbol><ci id="S3.I2.i2.p1.4.m4.4.4.3.2.cmml" xref="S3.I2.i2.p1.4.m4.4.4.3.2">𝑗</ci><cn id="S3.I2.i2.p1.4.m4.4.4.3.3.cmml" type="integer" xref="S3.I2.i2.p1.4.m4.4.4.3.3">1</cn></apply><set id="S3.I2.i2.p1.4.m4.4.4.1.2.cmml" xref="S3.I2.i2.p1.4.m4.4.4.1.1"><cn id="S3.I2.i2.p1.4.m4.1.1.cmml" type="integer" xref="S3.I2.i2.p1.4.m4.1.1">0</cn><cn id="S3.I2.i2.p1.4.m4.2.2.cmml" type="integer" xref="S3.I2.i2.p1.4.m4.2.2">1</cn><ci id="S3.I2.i2.p1.4.m4.3.3.cmml" xref="S3.I2.i2.p1.4.m4.3.3">…</ci><apply id="S3.I2.i2.p1.4.m4.4.4.1.1.1.cmml" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1"><minus id="S3.I2.i2.p1.4.m4.4.4.1.1.1.1.cmml" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.1"></minus><apply id="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.cmml" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.2"><times id="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.1.cmml" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.1"></times><cn id="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.2.cmml" type="integer" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.2">2</cn><ci id="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.3.cmml" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.2.3">𝐿</ci></apply><cn id="S3.I2.i2.p1.4.m4.4.4.1.1.1.3.cmml" type="integer" xref="S3.I2.i2.p1.4.m4.4.4.1.1.1.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.4.m4.4c">j_{1}\not\in\{0,1,\ldots,2L-2\}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.4.m4.4d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∉ { 0 , 1 , … , 2 italic_L - 2 }</annotation></semantics></math>) or <math alttext="T_{S}[r,i_{1},j_{1}]=0" class="ltx_Math" display="inline" id="S3.I2.i2.p1.5.m5.3"><semantics id="S3.I2.i2.p1.5.m5.3a"><mrow id="S3.I2.i2.p1.5.m5.3.3" xref="S3.I2.i2.p1.5.m5.3.3.cmml"><mrow id="S3.I2.i2.p1.5.m5.3.3.2" xref="S3.I2.i2.p1.5.m5.3.3.2.cmml"><msub id="S3.I2.i2.p1.5.m5.3.3.2.4" xref="S3.I2.i2.p1.5.m5.3.3.2.4.cmml"><mi id="S3.I2.i2.p1.5.m5.3.3.2.4.2" xref="S3.I2.i2.p1.5.m5.3.3.2.4.2.cmml">T</mi><mi id="S3.I2.i2.p1.5.m5.3.3.2.4.3" xref="S3.I2.i2.p1.5.m5.3.3.2.4.3.cmml">S</mi></msub><mo id="S3.I2.i2.p1.5.m5.3.3.2.3" xref="S3.I2.i2.p1.5.m5.3.3.2.3.cmml">⁢</mo><mrow id="S3.I2.i2.p1.5.m5.3.3.2.2.2" xref="S3.I2.i2.p1.5.m5.3.3.2.2.3.cmml"><mo id="S3.I2.i2.p1.5.m5.3.3.2.2.2.3" stretchy="false" xref="S3.I2.i2.p1.5.m5.3.3.2.2.3.cmml">[</mo><mi id="S3.I2.i2.p1.5.m5.1.1" xref="S3.I2.i2.p1.5.m5.1.1.cmml">r</mi><mo id="S3.I2.i2.p1.5.m5.3.3.2.2.2.4" xref="S3.I2.i2.p1.5.m5.3.3.2.2.3.cmml">,</mo><msub id="S3.I2.i2.p1.5.m5.2.2.1.1.1.1" xref="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.cmml"><mi id="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.2" xref="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.2.cmml">i</mi><mn id="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.3" xref="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.I2.i2.p1.5.m5.3.3.2.2.2.5" xref="S3.I2.i2.p1.5.m5.3.3.2.2.3.cmml">,</mo><msub id="S3.I2.i2.p1.5.m5.3.3.2.2.2.2" xref="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.cmml"><mi id="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.2" xref="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.2.cmml">j</mi><mn id="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.3" xref="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.I2.i2.p1.5.m5.3.3.2.2.2.6" stretchy="false" xref="S3.I2.i2.p1.5.m5.3.3.2.2.3.cmml">]</mo></mrow></mrow><mo id="S3.I2.i2.p1.5.m5.3.3.3" xref="S3.I2.i2.p1.5.m5.3.3.3.cmml">=</mo><mn id="S3.I2.i2.p1.5.m5.3.3.4" xref="S3.I2.i2.p1.5.m5.3.3.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.5.m5.3b"><apply id="S3.I2.i2.p1.5.m5.3.3.cmml" xref="S3.I2.i2.p1.5.m5.3.3"><eq id="S3.I2.i2.p1.5.m5.3.3.3.cmml" xref="S3.I2.i2.p1.5.m5.3.3.3"></eq><apply id="S3.I2.i2.p1.5.m5.3.3.2.cmml" xref="S3.I2.i2.p1.5.m5.3.3.2"><times id="S3.I2.i2.p1.5.m5.3.3.2.3.cmml" xref="S3.I2.i2.p1.5.m5.3.3.2.3"></times><apply id="S3.I2.i2.p1.5.m5.3.3.2.4.cmml" xref="S3.I2.i2.p1.5.m5.3.3.2.4"><csymbol cd="ambiguous" id="S3.I2.i2.p1.5.m5.3.3.2.4.1.cmml" xref="S3.I2.i2.p1.5.m5.3.3.2.4">subscript</csymbol><ci id="S3.I2.i2.p1.5.m5.3.3.2.4.2.cmml" xref="S3.I2.i2.p1.5.m5.3.3.2.4.2">𝑇</ci><ci id="S3.I2.i2.p1.5.m5.3.3.2.4.3.cmml" xref="S3.I2.i2.p1.5.m5.3.3.2.4.3">𝑆</ci></apply><list id="S3.I2.i2.p1.5.m5.3.3.2.2.3.cmml" xref="S3.I2.i2.p1.5.m5.3.3.2.2.2"><ci id="S3.I2.i2.p1.5.m5.1.1.cmml" xref="S3.I2.i2.p1.5.m5.1.1">𝑟</ci><apply id="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.I2.i2.p1.5.m5.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.1.cmml" xref="S3.I2.i2.p1.5.m5.2.2.1.1.1.1">subscript</csymbol><ci id="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.2.cmml" xref="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.2">𝑖</ci><cn id="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.I2.i2.p1.5.m5.2.2.1.1.1.1.3">1</cn></apply><apply id="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.I2.i2.p1.5.m5.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.1.cmml" xref="S3.I2.i2.p1.5.m5.3.3.2.2.2.2">subscript</csymbol><ci id="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.2.cmml" xref="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.2">𝑗</ci><cn id="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.I2.i2.p1.5.m5.3.3.2.2.2.2.3">1</cn></apply></list></apply><cn id="S3.I2.i2.p1.5.m5.3.3.4.cmml" type="integer" xref="S3.I2.i2.p1.5.m5.3.3.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.5.m5.3c">T_{S}[r,i_{1},j_{1}]=0</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.5.m5.3d">italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = 0</annotation></semantics></math>.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S3.3.p1.19">This dichotomy concludes the proof.
∎</p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.p14">
<p class="ltx_p" id="S3.p14.3">Up to now, we have managed to determine the attention scores of LAM while avoiding to compute all the entries of the product <math alttext="QK^{T}" class="ltx_Math" display="inline" id="S3.p14.1.m1.1"><semantics id="S3.p14.1.m1.1a"><mrow id="S3.p14.1.m1.1.1" xref="S3.p14.1.m1.1.1.cmml"><mi id="S3.p14.1.m1.1.1.2" xref="S3.p14.1.m1.1.1.2.cmml">Q</mi><mo id="S3.p14.1.m1.1.1.1" xref="S3.p14.1.m1.1.1.1.cmml">⁢</mo><msup id="S3.p14.1.m1.1.1.3" xref="S3.p14.1.m1.1.1.3.cmml"><mi id="S3.p14.1.m1.1.1.3.2" xref="S3.p14.1.m1.1.1.3.2.cmml">K</mi><mi id="S3.p14.1.m1.1.1.3.3" xref="S3.p14.1.m1.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p14.1.m1.1b"><apply id="S3.p14.1.m1.1.1.cmml" xref="S3.p14.1.m1.1.1"><times id="S3.p14.1.m1.1.1.1.cmml" xref="S3.p14.1.m1.1.1.1"></times><ci id="S3.p14.1.m1.1.1.2.cmml" xref="S3.p14.1.m1.1.1.2">𝑄</ci><apply id="S3.p14.1.m1.1.1.3.cmml" xref="S3.p14.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p14.1.m1.1.1.3.1.cmml" xref="S3.p14.1.m1.1.1.3">superscript</csymbol><ci id="S3.p14.1.m1.1.1.3.2.cmml" xref="S3.p14.1.m1.1.1.3.2">𝐾</ci><ci id="S3.p14.1.m1.1.1.3.3.cmml" xref="S3.p14.1.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p14.1.m1.1c">QK^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p14.1.m1.1d">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>. It remains to multiply the attention scores matrix by the values tensor <math alttext="V" class="ltx_Math" display="inline" id="S3.p14.2.m2.1"><semantics id="S3.p14.2.m2.1a"><mi id="S3.p14.2.m2.1.1" xref="S3.p14.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.p14.2.m2.1b"><ci id="S3.p14.2.m2.1.1.cmml" xref="S3.p14.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p14.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.p14.2.m2.1d">italic_V</annotation></semantics></math>. This operation can be similarly performed by extracting blocks of <math alttext="V" class="ltx_Math" display="inline" id="S3.p14.3.m3.1"><semantics id="S3.p14.3.m3.1a"><mi id="S3.p14.3.m3.1.1" xref="S3.p14.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.p14.3.m3.1b"><ci id="S3.p14.3.m3.1.1.cmml" xref="S3.p14.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p14.3.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.p14.3.m3.1d">italic_V</annotation></semantics></math>, which motivates Definition <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmdefinition5" title="Definition 5 (The tensor 𝑇_𝑉). ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">5</span></a>, and can be visualised in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.F4" title="Figure 4 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition5">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdefinition5.2.1.1">Definition 5</span></span><span class="ltx_text ltx_font_bold" id="Thmdefinition5.3.2"> </span>(The tensor <math alttext="T_{V}" class="ltx_Math" display="inline" id="Thmdefinition5.1.m1.1"><semantics id="Thmdefinition5.1.m1.1b"><msub id="Thmdefinition5.1.m1.1.1" xref="Thmdefinition5.1.m1.1.1.cmml"><mi id="Thmdefinition5.1.m1.1.1.2" xref="Thmdefinition5.1.m1.1.1.2.cmml">T</mi><mi id="Thmdefinition5.1.m1.1.1.3" xref="Thmdefinition5.1.m1.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition5.1.m1.1c"><apply id="Thmdefinition5.1.m1.1.1.cmml" xref="Thmdefinition5.1.m1.1.1"><csymbol cd="ambiguous" id="Thmdefinition5.1.m1.1.1.1.cmml" xref="Thmdefinition5.1.m1.1.1">subscript</csymbol><ci id="Thmdefinition5.1.m1.1.1.2.cmml" xref="Thmdefinition5.1.m1.1.1.2">𝑇</ci><ci id="Thmdefinition5.1.m1.1.1.3.cmml" xref="Thmdefinition5.1.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition5.1.m1.1d">T_{V}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition5.1.m1.1e">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>)<span class="ltx_text ltx_font_bold" id="Thmdefinition5.4.3">.</span>
</h6>
<div class="ltx_para" id="Thmdefinition5.p1">
<p class="ltx_p" id="Thmdefinition5.p1.9"><span class="ltx_text ltx_font_italic" id="Thmdefinition5.p1.9.9">Let <math alttext="s=n/L" class="ltx_Math" display="inline" id="Thmdefinition5.p1.1.1.m1.1"><semantics id="Thmdefinition5.p1.1.1.m1.1a"><mrow id="Thmdefinition5.p1.1.1.m1.1.1" xref="Thmdefinition5.p1.1.1.m1.1.1.cmml"><mi id="Thmdefinition5.p1.1.1.m1.1.1.2" xref="Thmdefinition5.p1.1.1.m1.1.1.2.cmml">s</mi><mo id="Thmdefinition5.p1.1.1.m1.1.1.1" xref="Thmdefinition5.p1.1.1.m1.1.1.1.cmml">=</mo><mrow id="Thmdefinition5.p1.1.1.m1.1.1.3" xref="Thmdefinition5.p1.1.1.m1.1.1.3.cmml"><mi id="Thmdefinition5.p1.1.1.m1.1.1.3.2" xref="Thmdefinition5.p1.1.1.m1.1.1.3.2.cmml">n</mi><mo id="Thmdefinition5.p1.1.1.m1.1.1.3.1" xref="Thmdefinition5.p1.1.1.m1.1.1.3.1.cmml">/</mo><mi id="Thmdefinition5.p1.1.1.m1.1.1.3.3" xref="Thmdefinition5.p1.1.1.m1.1.1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition5.p1.1.1.m1.1b"><apply id="Thmdefinition5.p1.1.1.m1.1.1.cmml" xref="Thmdefinition5.p1.1.1.m1.1.1"><eq id="Thmdefinition5.p1.1.1.m1.1.1.1.cmml" xref="Thmdefinition5.p1.1.1.m1.1.1.1"></eq><ci id="Thmdefinition5.p1.1.1.m1.1.1.2.cmml" xref="Thmdefinition5.p1.1.1.m1.1.1.2">𝑠</ci><apply id="Thmdefinition5.p1.1.1.m1.1.1.3.cmml" xref="Thmdefinition5.p1.1.1.m1.1.1.3"><divide id="Thmdefinition5.p1.1.1.m1.1.1.3.1.cmml" xref="Thmdefinition5.p1.1.1.m1.1.1.3.1"></divide><ci id="Thmdefinition5.p1.1.1.m1.1.1.3.2.cmml" xref="Thmdefinition5.p1.1.1.m1.1.1.3.2">𝑛</ci><ci id="Thmdefinition5.p1.1.1.m1.1.1.3.3.cmml" xref="Thmdefinition5.p1.1.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition5.p1.1.1.m1.1c">s=n/L</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition5.p1.1.1.m1.1d">italic_s = italic_n / italic_L</annotation></semantics></math>. We define <math alttext="T_{V}" class="ltx_Math" display="inline" id="Thmdefinition5.p1.2.2.m2.1"><semantics id="Thmdefinition5.p1.2.2.m2.1a"><msub id="Thmdefinition5.p1.2.2.m2.1.1" xref="Thmdefinition5.p1.2.2.m2.1.1.cmml"><mi id="Thmdefinition5.p1.2.2.m2.1.1.2" xref="Thmdefinition5.p1.2.2.m2.1.1.2.cmml">T</mi><mi id="Thmdefinition5.p1.2.2.m2.1.1.3" xref="Thmdefinition5.p1.2.2.m2.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition5.p1.2.2.m2.1b"><apply id="Thmdefinition5.p1.2.2.m2.1.1.cmml" xref="Thmdefinition5.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmdefinition5.p1.2.2.m2.1.1.1.cmml" xref="Thmdefinition5.p1.2.2.m2.1.1">subscript</csymbol><ci id="Thmdefinition5.p1.2.2.m2.1.1.2.cmml" xref="Thmdefinition5.p1.2.2.m2.1.1.2">𝑇</ci><ci id="Thmdefinition5.p1.2.2.m2.1.1.3.cmml" xref="Thmdefinition5.p1.2.2.m2.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition5.p1.2.2.m2.1c">T_{V}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition5.p1.2.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> as the tensor with dimensions <math alttext="s\times(2L-1)\times d_{model}" class="ltx_Math" display="inline" id="Thmdefinition5.p1.3.3.m3.1"><semantics id="Thmdefinition5.p1.3.3.m3.1a"><mrow id="Thmdefinition5.p1.3.3.m3.1.1" xref="Thmdefinition5.p1.3.3.m3.1.1.cmml"><mi id="Thmdefinition5.p1.3.3.m3.1.1.3" xref="Thmdefinition5.p1.3.3.m3.1.1.3.cmml">s</mi><mo id="Thmdefinition5.p1.3.3.m3.1.1.2" lspace="0.222em" rspace="0.222em" xref="Thmdefinition5.p1.3.3.m3.1.1.2.cmml">×</mo><mrow id="Thmdefinition5.p1.3.3.m3.1.1.1.1" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.cmml"><mo id="Thmdefinition5.p1.3.3.m3.1.1.1.1.2" stretchy="false" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.cmml"><mrow id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.cmml"><mn id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.2" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.2.cmml">2</mn><mo id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.1" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.3" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.1" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.3" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition5.p1.3.3.m3.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmdefinition5.p1.3.3.m3.1.1.2a" rspace="0.222em" xref="Thmdefinition5.p1.3.3.m3.1.1.2.cmml">×</mo><msub id="Thmdefinition5.p1.3.3.m3.1.1.4" xref="Thmdefinition5.p1.3.3.m3.1.1.4.cmml"><mi id="Thmdefinition5.p1.3.3.m3.1.1.4.2" xref="Thmdefinition5.p1.3.3.m3.1.1.4.2.cmml">d</mi><mrow id="Thmdefinition5.p1.3.3.m3.1.1.4.3" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.cmml"><mi id="Thmdefinition5.p1.3.3.m3.1.1.4.3.2" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.2.cmml">m</mi><mo id="Thmdefinition5.p1.3.3.m3.1.1.4.3.1" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.1.cmml">⁢</mo><mi id="Thmdefinition5.p1.3.3.m3.1.1.4.3.3" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.3.cmml">o</mi><mo id="Thmdefinition5.p1.3.3.m3.1.1.4.3.1a" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.1.cmml">⁢</mo><mi id="Thmdefinition5.p1.3.3.m3.1.1.4.3.4" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.4.cmml">d</mi><mo id="Thmdefinition5.p1.3.3.m3.1.1.4.3.1b" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.1.cmml">⁢</mo><mi id="Thmdefinition5.p1.3.3.m3.1.1.4.3.5" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.5.cmml">e</mi><mo id="Thmdefinition5.p1.3.3.m3.1.1.4.3.1c" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.1.cmml">⁢</mo><mi id="Thmdefinition5.p1.3.3.m3.1.1.4.3.6" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition5.p1.3.3.m3.1b"><apply id="Thmdefinition5.p1.3.3.m3.1.1.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1"><times id="Thmdefinition5.p1.3.3.m3.1.1.2.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.2"></times><ci id="Thmdefinition5.p1.3.3.m3.1.1.3.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.3">𝑠</ci><apply id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1"><minus id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.1"></minus><apply id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2"><times id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.1.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.1"></times><cn id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.2.cmml" type="integer" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.2">2</cn><ci id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.3.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.3.3.m3.1.1.1.1.1.3">1</cn></apply><apply id="Thmdefinition5.p1.3.3.m3.1.1.4.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.4"><csymbol cd="ambiguous" id="Thmdefinition5.p1.3.3.m3.1.1.4.1.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.4">subscript</csymbol><ci id="Thmdefinition5.p1.3.3.m3.1.1.4.2.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.4.2">𝑑</ci><apply id="Thmdefinition5.p1.3.3.m3.1.1.4.3.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3"><times id="Thmdefinition5.p1.3.3.m3.1.1.4.3.1.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.1"></times><ci id="Thmdefinition5.p1.3.3.m3.1.1.4.3.2.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.2">𝑚</ci><ci id="Thmdefinition5.p1.3.3.m3.1.1.4.3.3.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.3">𝑜</ci><ci id="Thmdefinition5.p1.3.3.m3.1.1.4.3.4.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.4">𝑑</ci><ci id="Thmdefinition5.p1.3.3.m3.1.1.4.3.5.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.5">𝑒</ci><ci id="Thmdefinition5.p1.3.3.m3.1.1.4.3.6.cmml" xref="Thmdefinition5.p1.3.3.m3.1.1.4.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition5.p1.3.3.m3.1c">s\times(2L-1)\times d_{model}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition5.p1.3.3.m3.1d">italic_s × ( 2 italic_L - 1 ) × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math> such that, for each for all <math alttext="r\in\{0,\ldots,s-1\}" class="ltx_Math" display="inline" id="Thmdefinition5.p1.4.4.m4.3"><semantics id="Thmdefinition5.p1.4.4.m4.3a"><mrow id="Thmdefinition5.p1.4.4.m4.3.3" xref="Thmdefinition5.p1.4.4.m4.3.3.cmml"><mi id="Thmdefinition5.p1.4.4.m4.3.3.3" xref="Thmdefinition5.p1.4.4.m4.3.3.3.cmml">r</mi><mo id="Thmdefinition5.p1.4.4.m4.3.3.2" xref="Thmdefinition5.p1.4.4.m4.3.3.2.cmml">∈</mo><mrow id="Thmdefinition5.p1.4.4.m4.3.3.1.1" xref="Thmdefinition5.p1.4.4.m4.3.3.1.2.cmml"><mo id="Thmdefinition5.p1.4.4.m4.3.3.1.1.2" stretchy="false" xref="Thmdefinition5.p1.4.4.m4.3.3.1.2.cmml">{</mo><mn id="Thmdefinition5.p1.4.4.m4.1.1" xref="Thmdefinition5.p1.4.4.m4.1.1.cmml">0</mn><mo id="Thmdefinition5.p1.4.4.m4.3.3.1.1.3" xref="Thmdefinition5.p1.4.4.m4.3.3.1.2.cmml">,</mo><mi id="Thmdefinition5.p1.4.4.m4.2.2" mathvariant="normal" xref="Thmdefinition5.p1.4.4.m4.2.2.cmml">…</mi><mo id="Thmdefinition5.p1.4.4.m4.3.3.1.1.4" xref="Thmdefinition5.p1.4.4.m4.3.3.1.2.cmml">,</mo><mrow id="Thmdefinition5.p1.4.4.m4.3.3.1.1.1" xref="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.cmml"><mi id="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.2" xref="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.2.cmml">s</mi><mo id="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.1" xref="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.1.cmml">−</mo><mn id="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.3" xref="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition5.p1.4.4.m4.3.3.1.1.5" stretchy="false" xref="Thmdefinition5.p1.4.4.m4.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition5.p1.4.4.m4.3b"><apply id="Thmdefinition5.p1.4.4.m4.3.3.cmml" xref="Thmdefinition5.p1.4.4.m4.3.3"><in id="Thmdefinition5.p1.4.4.m4.3.3.2.cmml" xref="Thmdefinition5.p1.4.4.m4.3.3.2"></in><ci id="Thmdefinition5.p1.4.4.m4.3.3.3.cmml" xref="Thmdefinition5.p1.4.4.m4.3.3.3">𝑟</ci><set id="Thmdefinition5.p1.4.4.m4.3.3.1.2.cmml" xref="Thmdefinition5.p1.4.4.m4.3.3.1.1"><cn id="Thmdefinition5.p1.4.4.m4.1.1.cmml" type="integer" xref="Thmdefinition5.p1.4.4.m4.1.1">0</cn><ci id="Thmdefinition5.p1.4.4.m4.2.2.cmml" xref="Thmdefinition5.p1.4.4.m4.2.2">…</ci><apply id="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.cmml" xref="Thmdefinition5.p1.4.4.m4.3.3.1.1.1"><minus id="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.1.cmml" xref="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.1"></minus><ci id="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.2.cmml" xref="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.2">𝑠</ci><cn id="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.4.4.m4.3.3.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition5.p1.4.4.m4.3c">r\in\{0,\ldots,s-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition5.p1.4.4.m4.3d">italic_r ∈ { 0 , … , italic_s - 1 }</annotation></semantics></math>, <math alttext="j_{1}\in\{0,1,\ldots,2L-2\}" class="ltx_Math" display="inline" id="Thmdefinition5.p1.5.5.m5.4"><semantics id="Thmdefinition5.p1.5.5.m5.4a"><mrow id="Thmdefinition5.p1.5.5.m5.4.4" xref="Thmdefinition5.p1.5.5.m5.4.4.cmml"><msub id="Thmdefinition5.p1.5.5.m5.4.4.3" xref="Thmdefinition5.p1.5.5.m5.4.4.3.cmml"><mi id="Thmdefinition5.p1.5.5.m5.4.4.3.2" xref="Thmdefinition5.p1.5.5.m5.4.4.3.2.cmml">j</mi><mn id="Thmdefinition5.p1.5.5.m5.4.4.3.3" xref="Thmdefinition5.p1.5.5.m5.4.4.3.3.cmml">1</mn></msub><mo id="Thmdefinition5.p1.5.5.m5.4.4.2" xref="Thmdefinition5.p1.5.5.m5.4.4.2.cmml">∈</mo><mrow id="Thmdefinition5.p1.5.5.m5.4.4.1.1" xref="Thmdefinition5.p1.5.5.m5.4.4.1.2.cmml"><mo id="Thmdefinition5.p1.5.5.m5.4.4.1.1.2" stretchy="false" xref="Thmdefinition5.p1.5.5.m5.4.4.1.2.cmml">{</mo><mn id="Thmdefinition5.p1.5.5.m5.1.1" xref="Thmdefinition5.p1.5.5.m5.1.1.cmml">0</mn><mo id="Thmdefinition5.p1.5.5.m5.4.4.1.1.3" xref="Thmdefinition5.p1.5.5.m5.4.4.1.2.cmml">,</mo><mn id="Thmdefinition5.p1.5.5.m5.2.2" xref="Thmdefinition5.p1.5.5.m5.2.2.cmml">1</mn><mo id="Thmdefinition5.p1.5.5.m5.4.4.1.1.4" xref="Thmdefinition5.p1.5.5.m5.4.4.1.2.cmml">,</mo><mi id="Thmdefinition5.p1.5.5.m5.3.3" mathvariant="normal" xref="Thmdefinition5.p1.5.5.m5.3.3.cmml">…</mi><mo id="Thmdefinition5.p1.5.5.m5.4.4.1.1.5" xref="Thmdefinition5.p1.5.5.m5.4.4.1.2.cmml">,</mo><mrow id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.cmml"><mrow id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.cmml"><mn id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.2" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.2.cmml">2</mn><mo id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.1" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.3" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.3.cmml">L</mi></mrow><mo id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.1" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.1.cmml">−</mo><mn id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.3" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="Thmdefinition5.p1.5.5.m5.4.4.1.1.6" stretchy="false" xref="Thmdefinition5.p1.5.5.m5.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition5.p1.5.5.m5.4b"><apply id="Thmdefinition5.p1.5.5.m5.4.4.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4"><in id="Thmdefinition5.p1.5.5.m5.4.4.2.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4.2"></in><apply id="Thmdefinition5.p1.5.5.m5.4.4.3.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4.3"><csymbol cd="ambiguous" id="Thmdefinition5.p1.5.5.m5.4.4.3.1.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4.3">subscript</csymbol><ci id="Thmdefinition5.p1.5.5.m5.4.4.3.2.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4.3.2">𝑗</ci><cn id="Thmdefinition5.p1.5.5.m5.4.4.3.3.cmml" type="integer" xref="Thmdefinition5.p1.5.5.m5.4.4.3.3">1</cn></apply><set id="Thmdefinition5.p1.5.5.m5.4.4.1.2.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1"><cn id="Thmdefinition5.p1.5.5.m5.1.1.cmml" type="integer" xref="Thmdefinition5.p1.5.5.m5.1.1">0</cn><cn id="Thmdefinition5.p1.5.5.m5.2.2.cmml" type="integer" xref="Thmdefinition5.p1.5.5.m5.2.2">1</cn><ci id="Thmdefinition5.p1.5.5.m5.3.3.cmml" xref="Thmdefinition5.p1.5.5.m5.3.3">…</ci><apply id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1"><minus id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.1.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.1"></minus><apply id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2"><times id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.1.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.1"></times><cn id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.2.cmml" type="integer" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.2">2</cn><ci id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.3.cmml" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.2.3">𝐿</ci></apply><cn id="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.5.5.m5.4.4.1.1.1.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition5.p1.5.5.m5.4c">j_{1}\in\{0,1,\ldots,2L-2\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition5.p1.5.5.m5.4d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , 2 italic_L - 2 }</annotation></semantics></math> and <math alttext="t\in\{0,1,\ldots,d_{model}-1\}" class="ltx_Math" display="inline" id="Thmdefinition5.p1.6.6.m6.4"><semantics id="Thmdefinition5.p1.6.6.m6.4a"><mrow id="Thmdefinition5.p1.6.6.m6.4.4" xref="Thmdefinition5.p1.6.6.m6.4.4.cmml"><mi id="Thmdefinition5.p1.6.6.m6.4.4.3" xref="Thmdefinition5.p1.6.6.m6.4.4.3.cmml">t</mi><mo id="Thmdefinition5.p1.6.6.m6.4.4.2" xref="Thmdefinition5.p1.6.6.m6.4.4.2.cmml">∈</mo><mrow id="Thmdefinition5.p1.6.6.m6.4.4.1.1" xref="Thmdefinition5.p1.6.6.m6.4.4.1.2.cmml"><mo id="Thmdefinition5.p1.6.6.m6.4.4.1.1.2" stretchy="false" xref="Thmdefinition5.p1.6.6.m6.4.4.1.2.cmml">{</mo><mn id="Thmdefinition5.p1.6.6.m6.1.1" xref="Thmdefinition5.p1.6.6.m6.1.1.cmml">0</mn><mo id="Thmdefinition5.p1.6.6.m6.4.4.1.1.3" xref="Thmdefinition5.p1.6.6.m6.4.4.1.2.cmml">,</mo><mn id="Thmdefinition5.p1.6.6.m6.2.2" xref="Thmdefinition5.p1.6.6.m6.2.2.cmml">1</mn><mo id="Thmdefinition5.p1.6.6.m6.4.4.1.1.4" xref="Thmdefinition5.p1.6.6.m6.4.4.1.2.cmml">,</mo><mi id="Thmdefinition5.p1.6.6.m6.3.3" mathvariant="normal" xref="Thmdefinition5.p1.6.6.m6.3.3.cmml">…</mi><mo id="Thmdefinition5.p1.6.6.m6.4.4.1.1.5" xref="Thmdefinition5.p1.6.6.m6.4.4.1.2.cmml">,</mo><mrow id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.cmml"><msub id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.cmml"><mi id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.2" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.2.cmml">d</mi><mrow id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.cmml"><mi id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.2" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.2.cmml">m</mi><mo id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.1" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.1.cmml">⁢</mo><mi id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.3" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.3.cmml">o</mi><mo id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.1a" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.1.cmml">⁢</mo><mi id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.4" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.4.cmml">d</mi><mo id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.1b" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.1.cmml">⁢</mo><mi id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.5" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.5.cmml">e</mi><mo id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.1c" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.1.cmml">⁢</mo><mi id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.6" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.1" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.1.cmml">−</mo><mn id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.3" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition5.p1.6.6.m6.4.4.1.1.6" stretchy="false" xref="Thmdefinition5.p1.6.6.m6.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition5.p1.6.6.m6.4b"><apply id="Thmdefinition5.p1.6.6.m6.4.4.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4"><in id="Thmdefinition5.p1.6.6.m6.4.4.2.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.2"></in><ci id="Thmdefinition5.p1.6.6.m6.4.4.3.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.3">𝑡</ci><set id="Thmdefinition5.p1.6.6.m6.4.4.1.2.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1"><cn id="Thmdefinition5.p1.6.6.m6.1.1.cmml" type="integer" xref="Thmdefinition5.p1.6.6.m6.1.1">0</cn><cn id="Thmdefinition5.p1.6.6.m6.2.2.cmml" type="integer" xref="Thmdefinition5.p1.6.6.m6.2.2">1</cn><ci id="Thmdefinition5.p1.6.6.m6.3.3.cmml" xref="Thmdefinition5.p1.6.6.m6.3.3">…</ci><apply id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1"><minus id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.1.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.1"></minus><apply id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2"><csymbol cd="ambiguous" id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.1.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2">subscript</csymbol><ci id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.2.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.2">𝑑</ci><apply id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3"><times id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.1.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.1"></times><ci id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.2.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.2">𝑚</ci><ci id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.3.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.3">𝑜</ci><ci id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.4.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.4">𝑑</ci><ci id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.5.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.5">𝑒</ci><ci id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.6.cmml" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.2.3.6">𝑙</ci></apply></apply><cn id="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.6.6.m6.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition5.p1.6.6.m6.4c">t\in\{0,1,\ldots,d_{model}-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition5.p1.6.6.m6.4d">italic_t ∈ { 0 , 1 , … , italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT - 1 }</annotation></semantics></math>, <math alttext="T_{V}[r,j_{1},t]=V[(r-1)L+1+j_{1},t]" class="ltx_Math" display="inline" id="Thmdefinition5.p1.7.7.m7.5"><semantics id="Thmdefinition5.p1.7.7.m7.5a"><mrow id="Thmdefinition5.p1.7.7.m7.5.5" xref="Thmdefinition5.p1.7.7.m7.5.5.cmml"><mrow id="Thmdefinition5.p1.7.7.m7.4.4.1" xref="Thmdefinition5.p1.7.7.m7.4.4.1.cmml"><msub id="Thmdefinition5.p1.7.7.m7.4.4.1.3" xref="Thmdefinition5.p1.7.7.m7.4.4.1.3.cmml"><mi id="Thmdefinition5.p1.7.7.m7.4.4.1.3.2" xref="Thmdefinition5.p1.7.7.m7.4.4.1.3.2.cmml">T</mi><mi id="Thmdefinition5.p1.7.7.m7.4.4.1.3.3" xref="Thmdefinition5.p1.7.7.m7.4.4.1.3.3.cmml">V</mi></msub><mo id="Thmdefinition5.p1.7.7.m7.4.4.1.2" xref="Thmdefinition5.p1.7.7.m7.4.4.1.2.cmml">⁢</mo><mrow id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.2.cmml"><mo id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.2" stretchy="false" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.2.cmml">[</mo><mi id="Thmdefinition5.p1.7.7.m7.1.1" xref="Thmdefinition5.p1.7.7.m7.1.1.cmml">r</mi><mo id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.3" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.2.cmml">,</mo><msub id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.cmml"><mi id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.2" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.2.cmml">j</mi><mn id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.3" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.4" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.2.cmml">,</mo><mi id="Thmdefinition5.p1.7.7.m7.2.2" xref="Thmdefinition5.p1.7.7.m7.2.2.cmml">t</mi><mo id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.5" stretchy="false" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.2.cmml">]</mo></mrow></mrow><mo id="Thmdefinition5.p1.7.7.m7.5.5.3" xref="Thmdefinition5.p1.7.7.m7.5.5.3.cmml">=</mo><mrow id="Thmdefinition5.p1.7.7.m7.5.5.2" xref="Thmdefinition5.p1.7.7.m7.5.5.2.cmml"><mi id="Thmdefinition5.p1.7.7.m7.5.5.2.3" xref="Thmdefinition5.p1.7.7.m7.5.5.2.3.cmml">V</mi><mo id="Thmdefinition5.p1.7.7.m7.5.5.2.2" xref="Thmdefinition5.p1.7.7.m7.5.5.2.2.cmml">⁢</mo><mrow id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.2.cmml"><mo id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.2" stretchy="false" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.2.cmml">[</mo><mrow id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.cmml"><mrow id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.cmml"><mrow id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.cmml"><mo id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.2" stretchy="false" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.cmml"><mi id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.2" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.1" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.3" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.3" stretchy="false" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.2" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.2.cmml">⁢</mo><mi id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.3" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.3.cmml">L</mi></mrow><mo id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.2" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.2.cmml">+</mo><mn id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.3" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.3.cmml">1</mn><mo id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.2a" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.2.cmml">+</mo><msub id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.cmml"><mi id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.2" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.2.cmml">j</mi><mn id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.3" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.3" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.2.cmml">,</mo><mi id="Thmdefinition5.p1.7.7.m7.3.3" xref="Thmdefinition5.p1.7.7.m7.3.3.cmml">t</mi><mo id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.4" stretchy="false" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition5.p1.7.7.m7.5b"><apply id="Thmdefinition5.p1.7.7.m7.5.5.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5"><eq id="Thmdefinition5.p1.7.7.m7.5.5.3.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.3"></eq><apply id="Thmdefinition5.p1.7.7.m7.4.4.1.cmml" xref="Thmdefinition5.p1.7.7.m7.4.4.1"><times id="Thmdefinition5.p1.7.7.m7.4.4.1.2.cmml" xref="Thmdefinition5.p1.7.7.m7.4.4.1.2"></times><apply id="Thmdefinition5.p1.7.7.m7.4.4.1.3.cmml" xref="Thmdefinition5.p1.7.7.m7.4.4.1.3"><csymbol cd="ambiguous" id="Thmdefinition5.p1.7.7.m7.4.4.1.3.1.cmml" xref="Thmdefinition5.p1.7.7.m7.4.4.1.3">subscript</csymbol><ci id="Thmdefinition5.p1.7.7.m7.4.4.1.3.2.cmml" xref="Thmdefinition5.p1.7.7.m7.4.4.1.3.2">𝑇</ci><ci id="Thmdefinition5.p1.7.7.m7.4.4.1.3.3.cmml" xref="Thmdefinition5.p1.7.7.m7.4.4.1.3.3">𝑉</ci></apply><list id="Thmdefinition5.p1.7.7.m7.4.4.1.1.2.cmml" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.1"><ci id="Thmdefinition5.p1.7.7.m7.1.1.cmml" xref="Thmdefinition5.p1.7.7.m7.1.1">𝑟</ci><apply id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.cmml" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.1.cmml" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1">subscript</csymbol><ci id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.2.cmml" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.2">𝑗</ci><cn id="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.7.7.m7.4.4.1.1.1.1.3">1</cn></apply><ci id="Thmdefinition5.p1.7.7.m7.2.2.cmml" xref="Thmdefinition5.p1.7.7.m7.2.2">𝑡</ci></list></apply><apply id="Thmdefinition5.p1.7.7.m7.5.5.2.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2"><times id="Thmdefinition5.p1.7.7.m7.5.5.2.2.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.2"></times><ci id="Thmdefinition5.p1.7.7.m7.5.5.2.3.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.3">𝑉</ci><interval closure="closed" id="Thmdefinition5.p1.7.7.m7.5.5.2.1.2.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1"><apply id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1"><plus id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.2.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.2"></plus><apply id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1"><times id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.2.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.2"></times><apply id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1"><minus id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.1"></minus><ci id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.2.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.2">𝑟</ci><cn id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.1.1.1.3">1</cn></apply><ci id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.3.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.1.3">𝐿</ci></apply><cn id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.3">1</cn><apply id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4"><csymbol cd="ambiguous" id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.1.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4">subscript</csymbol><ci id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.2.cmml" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.2">𝑗</ci><cn id="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.3.cmml" type="integer" xref="Thmdefinition5.p1.7.7.m7.5.5.2.1.1.1.4.3">1</cn></apply></apply><ci id="Thmdefinition5.p1.7.7.m7.3.3.cmml" xref="Thmdefinition5.p1.7.7.m7.3.3">𝑡</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition5.p1.7.7.m7.5c">T_{V}[r,j_{1},t]=V[(r-1)L+1+j_{1},t]</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition5.p1.7.7.m7.5d">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ italic_r , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ] = italic_V [ ( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ]</annotation></semantics></math> when <math alttext="(r-1)L+1+j_{1}\geq 0" class="ltx_Math" display="inline" id="Thmdefinition5.p1.8.8.m8.1"><semantics id="Thmdefinition5.p1.8.8.m8.1a"><mrow id="Thmdefinition5.p1.8.8.m8.1.1" xref="Thmdefinition5.p1.8.8.m8.1.1.cmml"><mrow id="Thmdefinition5.p1.8.8.m8.1.1.1" xref="Thmdefinition5.p1.8.8.m8.1.1.1.cmml"><mrow id="Thmdefinition5.p1.8.8.m8.1.1.1.1" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.cmml"><mrow id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.cmml"><mo id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.2" stretchy="false" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.cmml"><mi id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.2" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.1" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.3" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.3" stretchy="false" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmdefinition5.p1.8.8.m8.1.1.1.1.2" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.2.cmml">⁢</mo><mi id="Thmdefinition5.p1.8.8.m8.1.1.1.1.3" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.3.cmml">L</mi></mrow><mo id="Thmdefinition5.p1.8.8.m8.1.1.1.2" xref="Thmdefinition5.p1.8.8.m8.1.1.1.2.cmml">+</mo><mn id="Thmdefinition5.p1.8.8.m8.1.1.1.3" xref="Thmdefinition5.p1.8.8.m8.1.1.1.3.cmml">1</mn><mo id="Thmdefinition5.p1.8.8.m8.1.1.1.2a" xref="Thmdefinition5.p1.8.8.m8.1.1.1.2.cmml">+</mo><msub id="Thmdefinition5.p1.8.8.m8.1.1.1.4" xref="Thmdefinition5.p1.8.8.m8.1.1.1.4.cmml"><mi id="Thmdefinition5.p1.8.8.m8.1.1.1.4.2" xref="Thmdefinition5.p1.8.8.m8.1.1.1.4.2.cmml">j</mi><mn id="Thmdefinition5.p1.8.8.m8.1.1.1.4.3" xref="Thmdefinition5.p1.8.8.m8.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="Thmdefinition5.p1.8.8.m8.1.1.2" xref="Thmdefinition5.p1.8.8.m8.1.1.2.cmml">≥</mo><mn id="Thmdefinition5.p1.8.8.m8.1.1.3" xref="Thmdefinition5.p1.8.8.m8.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition5.p1.8.8.m8.1b"><apply id="Thmdefinition5.p1.8.8.m8.1.1.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1"><geq id="Thmdefinition5.p1.8.8.m8.1.1.2.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.2"></geq><apply id="Thmdefinition5.p1.8.8.m8.1.1.1.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1"><plus id="Thmdefinition5.p1.8.8.m8.1.1.1.2.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1.2"></plus><apply id="Thmdefinition5.p1.8.8.m8.1.1.1.1.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1"><times id="Thmdefinition5.p1.8.8.m8.1.1.1.1.2.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.2"></times><apply id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1"><minus id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.1.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.1"></minus><ci id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.2.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.2">𝑟</ci><cn id="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.1.1.1.3">1</cn></apply><ci id="Thmdefinition5.p1.8.8.m8.1.1.1.1.3.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1.1.3">𝐿</ci></apply><cn id="Thmdefinition5.p1.8.8.m8.1.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.8.8.m8.1.1.1.3">1</cn><apply id="Thmdefinition5.p1.8.8.m8.1.1.1.4.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1.4"><csymbol cd="ambiguous" id="Thmdefinition5.p1.8.8.m8.1.1.1.4.1.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1.4">subscript</csymbol><ci id="Thmdefinition5.p1.8.8.m8.1.1.1.4.2.cmml" xref="Thmdefinition5.p1.8.8.m8.1.1.1.4.2">𝑗</ci><cn id="Thmdefinition5.p1.8.8.m8.1.1.1.4.3.cmml" type="integer" xref="Thmdefinition5.p1.8.8.m8.1.1.1.4.3">1</cn></apply></apply><cn id="Thmdefinition5.p1.8.8.m8.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.8.8.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition5.p1.8.8.m8.1c">(r-1)L+1+j_{1}\geq 0</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition5.p1.8.8.m8.1d">( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≥ 0</annotation></semantics></math> and <math alttext="T_{V}[0,j_{1},t]=0" class="ltx_Math" display="inline" id="Thmdefinition5.p1.9.9.m9.3"><semantics id="Thmdefinition5.p1.9.9.m9.3a"><mrow id="Thmdefinition5.p1.9.9.m9.3.3" xref="Thmdefinition5.p1.9.9.m9.3.3.cmml"><mrow id="Thmdefinition5.p1.9.9.m9.3.3.1" xref="Thmdefinition5.p1.9.9.m9.3.3.1.cmml"><msub id="Thmdefinition5.p1.9.9.m9.3.3.1.3" xref="Thmdefinition5.p1.9.9.m9.3.3.1.3.cmml"><mi id="Thmdefinition5.p1.9.9.m9.3.3.1.3.2" xref="Thmdefinition5.p1.9.9.m9.3.3.1.3.2.cmml">T</mi><mi id="Thmdefinition5.p1.9.9.m9.3.3.1.3.3" xref="Thmdefinition5.p1.9.9.m9.3.3.1.3.3.cmml">V</mi></msub><mo id="Thmdefinition5.p1.9.9.m9.3.3.1.2" xref="Thmdefinition5.p1.9.9.m9.3.3.1.2.cmml">⁢</mo><mrow id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.2.cmml"><mo id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.2" stretchy="false" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.2.cmml">[</mo><mn id="Thmdefinition5.p1.9.9.m9.1.1" xref="Thmdefinition5.p1.9.9.m9.1.1.cmml">0</mn><mo id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.3" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.2.cmml">,</mo><msub id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.cmml"><mi id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.2" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.2.cmml">j</mi><mn id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.3" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.4" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.2.cmml">,</mo><mi id="Thmdefinition5.p1.9.9.m9.2.2" xref="Thmdefinition5.p1.9.9.m9.2.2.cmml">t</mi><mo id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.5" stretchy="false" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.2.cmml">]</mo></mrow></mrow><mo id="Thmdefinition5.p1.9.9.m9.3.3.2" xref="Thmdefinition5.p1.9.9.m9.3.3.2.cmml">=</mo><mn id="Thmdefinition5.p1.9.9.m9.3.3.3" xref="Thmdefinition5.p1.9.9.m9.3.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition5.p1.9.9.m9.3b"><apply id="Thmdefinition5.p1.9.9.m9.3.3.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3"><eq id="Thmdefinition5.p1.9.9.m9.3.3.2.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.2"></eq><apply id="Thmdefinition5.p1.9.9.m9.3.3.1.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.1"><times id="Thmdefinition5.p1.9.9.m9.3.3.1.2.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.1.2"></times><apply id="Thmdefinition5.p1.9.9.m9.3.3.1.3.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.1.3"><csymbol cd="ambiguous" id="Thmdefinition5.p1.9.9.m9.3.3.1.3.1.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.1.3">subscript</csymbol><ci id="Thmdefinition5.p1.9.9.m9.3.3.1.3.2.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.1.3.2">𝑇</ci><ci id="Thmdefinition5.p1.9.9.m9.3.3.1.3.3.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.1.3.3">𝑉</ci></apply><list id="Thmdefinition5.p1.9.9.m9.3.3.1.1.2.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.1"><cn id="Thmdefinition5.p1.9.9.m9.1.1.cmml" type="integer" xref="Thmdefinition5.p1.9.9.m9.1.1">0</cn><apply id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.1.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1">subscript</csymbol><ci id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.2.cmml" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.2">𝑗</ci><cn id="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition5.p1.9.9.m9.3.3.1.1.1.1.3">1</cn></apply><ci id="Thmdefinition5.p1.9.9.m9.2.2.cmml" xref="Thmdefinition5.p1.9.9.m9.2.2">𝑡</ci></list></apply><cn id="Thmdefinition5.p1.9.9.m9.3.3.3.cmml" type="integer" xref="Thmdefinition5.p1.9.9.m9.3.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition5.p1.9.9.m9.3c">T_{V}[0,j_{1},t]=0</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition5.p1.9.9.m9.3d">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ 0 , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ] = 0</annotation></semantics></math> otherwise.</span></p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmthm5">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm5.1.1.1">Lemma 5</span></span><span class="ltx_text ltx_font_bold" id="Thmthm5.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm5.p1">
<p class="ltx_p" id="Thmthm5.p1.7"><span class="ltx_text ltx_font_italic" id="Thmthm5.p1.7.7">The tensor defined as <math alttext="T_{LAM}=\operatorname{softmax}((T_{Q}T_{K}^{T}+T_{M})/\sqrt{d_{q}})T_{V}" class="ltx_Math" display="inline" id="Thmthm5.p1.1.1.m1.2"><semantics id="Thmthm5.p1.1.1.m1.2a"><mrow id="Thmthm5.p1.1.1.m1.2.2" xref="Thmthm5.p1.1.1.m1.2.2.cmml"><msub id="Thmthm5.p1.1.1.m1.2.2.3" xref="Thmthm5.p1.1.1.m1.2.2.3.cmml"><mi id="Thmthm5.p1.1.1.m1.2.2.3.2" xref="Thmthm5.p1.1.1.m1.2.2.3.2.cmml">T</mi><mrow id="Thmthm5.p1.1.1.m1.2.2.3.3" xref="Thmthm5.p1.1.1.m1.2.2.3.3.cmml"><mi id="Thmthm5.p1.1.1.m1.2.2.3.3.2" xref="Thmthm5.p1.1.1.m1.2.2.3.3.2.cmml">L</mi><mo id="Thmthm5.p1.1.1.m1.2.2.3.3.1" xref="Thmthm5.p1.1.1.m1.2.2.3.3.1.cmml">⁢</mo><mi id="Thmthm5.p1.1.1.m1.2.2.3.3.3" xref="Thmthm5.p1.1.1.m1.2.2.3.3.3.cmml">A</mi><mo id="Thmthm5.p1.1.1.m1.2.2.3.3.1a" xref="Thmthm5.p1.1.1.m1.2.2.3.3.1.cmml">⁢</mo><mi id="Thmthm5.p1.1.1.m1.2.2.3.3.4" xref="Thmthm5.p1.1.1.m1.2.2.3.3.4.cmml">M</mi></mrow></msub><mo id="Thmthm5.p1.1.1.m1.2.2.2" xref="Thmthm5.p1.1.1.m1.2.2.2.cmml">=</mo><mrow id="Thmthm5.p1.1.1.m1.2.2.1" xref="Thmthm5.p1.1.1.m1.2.2.1.cmml"><mrow id="Thmthm5.p1.1.1.m1.2.2.1.1.1" xref="Thmthm5.p1.1.1.m1.2.2.1.1.2.cmml"><mi id="Thmthm5.p1.1.1.m1.1.1" xref="Thmthm5.p1.1.1.m1.1.1.cmml">softmax</mi><mo id="Thmthm5.p1.1.1.m1.2.2.1.1.1a" xref="Thmthm5.p1.1.1.m1.2.2.1.1.2.cmml">⁡</mo><mrow id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1" xref="Thmthm5.p1.1.1.m1.2.2.1.1.2.cmml"><mo id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.2" stretchy="false" xref="Thmthm5.p1.1.1.m1.2.2.1.1.2.cmml">(</mo><mrow id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.cmml"><mrow id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><msub id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml">T</mi><mi id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml">Q</mi></msub><mo id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.1" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.2" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.2.cmml">T</mi><mi id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.3" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.3.cmml">K</mi><mi id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">T</mi><mi id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.2" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.2.cmml">/</mo><msqrt id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.cmml"><msub id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.cmml"><mi id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.2" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.2.cmml">d</mi><mi id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.3" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.3.cmml">q</mi></msub></msqrt></mrow><mo id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.3" stretchy="false" xref="Thmthm5.p1.1.1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="Thmthm5.p1.1.1.m1.2.2.1.2" xref="Thmthm5.p1.1.1.m1.2.2.1.2.cmml">⁢</mo><msub id="Thmthm5.p1.1.1.m1.2.2.1.3" xref="Thmthm5.p1.1.1.m1.2.2.1.3.cmml"><mi id="Thmthm5.p1.1.1.m1.2.2.1.3.2" xref="Thmthm5.p1.1.1.m1.2.2.1.3.2.cmml">T</mi><mi id="Thmthm5.p1.1.1.m1.2.2.1.3.3" xref="Thmthm5.p1.1.1.m1.2.2.1.3.3.cmml">V</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm5.p1.1.1.m1.2b"><apply id="Thmthm5.p1.1.1.m1.2.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2"><eq id="Thmthm5.p1.1.1.m1.2.2.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.2"></eq><apply id="Thmthm5.p1.1.1.m1.2.2.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.3"><csymbol cd="ambiguous" id="Thmthm5.p1.1.1.m1.2.2.3.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.3">subscript</csymbol><ci id="Thmthm5.p1.1.1.m1.2.2.3.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.3.2">𝑇</ci><apply id="Thmthm5.p1.1.1.m1.2.2.3.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.3.3"><times id="Thmthm5.p1.1.1.m1.2.2.3.3.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.3.3.1"></times><ci id="Thmthm5.p1.1.1.m1.2.2.3.3.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.3.3.2">𝐿</ci><ci id="Thmthm5.p1.1.1.m1.2.2.3.3.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.3.3.3">𝐴</ci><ci id="Thmthm5.p1.1.1.m1.2.2.3.3.4.cmml" xref="Thmthm5.p1.1.1.m1.2.2.3.3.4">𝑀</ci></apply></apply><apply id="Thmthm5.p1.1.1.m1.2.2.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1"><times id="Thmthm5.p1.1.1.m1.2.2.1.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.2"></times><apply id="Thmthm5.p1.1.1.m1.2.2.1.1.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1"><ci id="Thmthm5.p1.1.1.m1.1.1.cmml" xref="Thmthm5.p1.1.1.m1.1.1">softmax</ci><apply id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1"><divide id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.2"></divide><apply id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1"><plus id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.1"></plus><apply id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2"><times id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.1"></times><apply id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.2">𝑇</ci><ci id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.3">𝑄</ci></apply><apply id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.2">𝑇</ci><ci id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.3">𝐾</ci></apply><ci id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑇</ci><ci id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑀</ci></apply></apply><apply id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3"><root id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3a.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3"></root><apply id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.2">𝑑</ci><ci id="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.1.1.1.1.3.2.3">𝑞</ci></apply></apply></apply></apply><apply id="Thmthm5.p1.1.1.m1.2.2.1.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.3"><csymbol cd="ambiguous" id="Thmthm5.p1.1.1.m1.2.2.1.3.1.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.3">subscript</csymbol><ci id="Thmthm5.p1.1.1.m1.2.2.1.3.2.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.3.2">𝑇</ci><ci id="Thmthm5.p1.1.1.m1.2.2.1.3.3.cmml" xref="Thmthm5.p1.1.1.m1.2.2.1.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm5.p1.1.1.m1.2c">T_{LAM}=\operatorname{softmax}((T_{Q}T_{K}^{T}+T_{M})/\sqrt{d_{q}})T_{V}</annotation><annotation encoding="application/x-llamapun" id="Thmthm5.p1.1.1.m1.2d">italic_T start_POSTSUBSCRIPT italic_L italic_A italic_M end_POSTSUBSCRIPT = roman_softmax ( ( italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG ) italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\operatorname{softmax}" class="ltx_Math" display="inline" id="Thmthm5.p1.2.2.m2.1"><semantics id="Thmthm5.p1.2.2.m2.1a"><mi id="Thmthm5.p1.2.2.m2.1.1" xref="Thmthm5.p1.2.2.m2.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="Thmthm5.p1.2.2.m2.1b"><ci id="Thmthm5.p1.2.2.m2.1.1.cmml" xref="Thmthm5.p1.2.2.m2.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmthm5.p1.2.2.m2.1c">\operatorname{softmax}</annotation><annotation encoding="application/x-llamapun" id="Thmthm5.p1.2.2.m2.1d">roman_softmax</annotation></semantics></math> is applied on the last dimension, has dimensions <math alttext="s\times L\times d_{model}" class="ltx_Math" display="inline" id="Thmthm5.p1.3.3.m3.1"><semantics id="Thmthm5.p1.3.3.m3.1a"><mrow id="Thmthm5.p1.3.3.m3.1.1" xref="Thmthm5.p1.3.3.m3.1.1.cmml"><mi id="Thmthm5.p1.3.3.m3.1.1.2" xref="Thmthm5.p1.3.3.m3.1.1.2.cmml">s</mi><mo id="Thmthm5.p1.3.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="Thmthm5.p1.3.3.m3.1.1.1.cmml">×</mo><mi id="Thmthm5.p1.3.3.m3.1.1.3" xref="Thmthm5.p1.3.3.m3.1.1.3.cmml">L</mi><mo id="Thmthm5.p1.3.3.m3.1.1.1a" lspace="0.222em" rspace="0.222em" xref="Thmthm5.p1.3.3.m3.1.1.1.cmml">×</mo><msub id="Thmthm5.p1.3.3.m3.1.1.4" xref="Thmthm5.p1.3.3.m3.1.1.4.cmml"><mi id="Thmthm5.p1.3.3.m3.1.1.4.2" xref="Thmthm5.p1.3.3.m3.1.1.4.2.cmml">d</mi><mrow id="Thmthm5.p1.3.3.m3.1.1.4.3" xref="Thmthm5.p1.3.3.m3.1.1.4.3.cmml"><mi id="Thmthm5.p1.3.3.m3.1.1.4.3.2" xref="Thmthm5.p1.3.3.m3.1.1.4.3.2.cmml">m</mi><mo id="Thmthm5.p1.3.3.m3.1.1.4.3.1" xref="Thmthm5.p1.3.3.m3.1.1.4.3.1.cmml">⁢</mo><mi id="Thmthm5.p1.3.3.m3.1.1.4.3.3" xref="Thmthm5.p1.3.3.m3.1.1.4.3.3.cmml">o</mi><mo id="Thmthm5.p1.3.3.m3.1.1.4.3.1a" xref="Thmthm5.p1.3.3.m3.1.1.4.3.1.cmml">⁢</mo><mi id="Thmthm5.p1.3.3.m3.1.1.4.3.4" xref="Thmthm5.p1.3.3.m3.1.1.4.3.4.cmml">d</mi><mo id="Thmthm5.p1.3.3.m3.1.1.4.3.1b" xref="Thmthm5.p1.3.3.m3.1.1.4.3.1.cmml">⁢</mo><mi id="Thmthm5.p1.3.3.m3.1.1.4.3.5" xref="Thmthm5.p1.3.3.m3.1.1.4.3.5.cmml">e</mi><mo id="Thmthm5.p1.3.3.m3.1.1.4.3.1c" xref="Thmthm5.p1.3.3.m3.1.1.4.3.1.cmml">⁢</mo><mi id="Thmthm5.p1.3.3.m3.1.1.4.3.6" xref="Thmthm5.p1.3.3.m3.1.1.4.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="Thmthm5.p1.3.3.m3.1b"><apply id="Thmthm5.p1.3.3.m3.1.1.cmml" xref="Thmthm5.p1.3.3.m3.1.1"><times id="Thmthm5.p1.3.3.m3.1.1.1.cmml" xref="Thmthm5.p1.3.3.m3.1.1.1"></times><ci id="Thmthm5.p1.3.3.m3.1.1.2.cmml" xref="Thmthm5.p1.3.3.m3.1.1.2">𝑠</ci><ci id="Thmthm5.p1.3.3.m3.1.1.3.cmml" xref="Thmthm5.p1.3.3.m3.1.1.3">𝐿</ci><apply id="Thmthm5.p1.3.3.m3.1.1.4.cmml" xref="Thmthm5.p1.3.3.m3.1.1.4"><csymbol cd="ambiguous" id="Thmthm5.p1.3.3.m3.1.1.4.1.cmml" xref="Thmthm5.p1.3.3.m3.1.1.4">subscript</csymbol><ci id="Thmthm5.p1.3.3.m3.1.1.4.2.cmml" xref="Thmthm5.p1.3.3.m3.1.1.4.2">𝑑</ci><apply id="Thmthm5.p1.3.3.m3.1.1.4.3.cmml" xref="Thmthm5.p1.3.3.m3.1.1.4.3"><times id="Thmthm5.p1.3.3.m3.1.1.4.3.1.cmml" xref="Thmthm5.p1.3.3.m3.1.1.4.3.1"></times><ci id="Thmthm5.p1.3.3.m3.1.1.4.3.2.cmml" xref="Thmthm5.p1.3.3.m3.1.1.4.3.2">𝑚</ci><ci id="Thmthm5.p1.3.3.m3.1.1.4.3.3.cmml" xref="Thmthm5.p1.3.3.m3.1.1.4.3.3">𝑜</ci><ci id="Thmthm5.p1.3.3.m3.1.1.4.3.4.cmml" xref="Thmthm5.p1.3.3.m3.1.1.4.3.4">𝑑</ci><ci id="Thmthm5.p1.3.3.m3.1.1.4.3.5.cmml" xref="Thmthm5.p1.3.3.m3.1.1.4.3.5">𝑒</ci><ci id="Thmthm5.p1.3.3.m3.1.1.4.3.6.cmml" xref="Thmthm5.p1.3.3.m3.1.1.4.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm5.p1.3.3.m3.1c">s\times L\times d_{model}</annotation><annotation encoding="application/x-llamapun" id="Thmthm5.p1.3.3.m3.1d">italic_s × italic_L × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. For each <math alttext="i\in\{0,1,\ldots,n-1\}" class="ltx_Math" display="inline" id="Thmthm5.p1.4.4.m4.4"><semantics id="Thmthm5.p1.4.4.m4.4a"><mrow id="Thmthm5.p1.4.4.m4.4.4" xref="Thmthm5.p1.4.4.m4.4.4.cmml"><mi id="Thmthm5.p1.4.4.m4.4.4.3" xref="Thmthm5.p1.4.4.m4.4.4.3.cmml">i</mi><mo id="Thmthm5.p1.4.4.m4.4.4.2" xref="Thmthm5.p1.4.4.m4.4.4.2.cmml">∈</mo><mrow id="Thmthm5.p1.4.4.m4.4.4.1.1" xref="Thmthm5.p1.4.4.m4.4.4.1.2.cmml"><mo id="Thmthm5.p1.4.4.m4.4.4.1.1.2" stretchy="false" xref="Thmthm5.p1.4.4.m4.4.4.1.2.cmml">{</mo><mn id="Thmthm5.p1.4.4.m4.1.1" xref="Thmthm5.p1.4.4.m4.1.1.cmml">0</mn><mo id="Thmthm5.p1.4.4.m4.4.4.1.1.3" xref="Thmthm5.p1.4.4.m4.4.4.1.2.cmml">,</mo><mn id="Thmthm5.p1.4.4.m4.2.2" xref="Thmthm5.p1.4.4.m4.2.2.cmml">1</mn><mo id="Thmthm5.p1.4.4.m4.4.4.1.1.4" xref="Thmthm5.p1.4.4.m4.4.4.1.2.cmml">,</mo><mi id="Thmthm5.p1.4.4.m4.3.3" mathvariant="normal" xref="Thmthm5.p1.4.4.m4.3.3.cmml">…</mi><mo id="Thmthm5.p1.4.4.m4.4.4.1.1.5" xref="Thmthm5.p1.4.4.m4.4.4.1.2.cmml">,</mo><mrow id="Thmthm5.p1.4.4.m4.4.4.1.1.1" xref="Thmthm5.p1.4.4.m4.4.4.1.1.1.cmml"><mi id="Thmthm5.p1.4.4.m4.4.4.1.1.1.2" xref="Thmthm5.p1.4.4.m4.4.4.1.1.1.2.cmml">n</mi><mo id="Thmthm5.p1.4.4.m4.4.4.1.1.1.1" xref="Thmthm5.p1.4.4.m4.4.4.1.1.1.1.cmml">−</mo><mn id="Thmthm5.p1.4.4.m4.4.4.1.1.1.3" xref="Thmthm5.p1.4.4.m4.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="Thmthm5.p1.4.4.m4.4.4.1.1.6" stretchy="false" xref="Thmthm5.p1.4.4.m4.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm5.p1.4.4.m4.4b"><apply id="Thmthm5.p1.4.4.m4.4.4.cmml" xref="Thmthm5.p1.4.4.m4.4.4"><in id="Thmthm5.p1.4.4.m4.4.4.2.cmml" xref="Thmthm5.p1.4.4.m4.4.4.2"></in><ci id="Thmthm5.p1.4.4.m4.4.4.3.cmml" xref="Thmthm5.p1.4.4.m4.4.4.3">𝑖</ci><set id="Thmthm5.p1.4.4.m4.4.4.1.2.cmml" xref="Thmthm5.p1.4.4.m4.4.4.1.1"><cn id="Thmthm5.p1.4.4.m4.1.1.cmml" type="integer" xref="Thmthm5.p1.4.4.m4.1.1">0</cn><cn id="Thmthm5.p1.4.4.m4.2.2.cmml" type="integer" xref="Thmthm5.p1.4.4.m4.2.2">1</cn><ci id="Thmthm5.p1.4.4.m4.3.3.cmml" xref="Thmthm5.p1.4.4.m4.3.3">…</ci><apply id="Thmthm5.p1.4.4.m4.4.4.1.1.1.cmml" xref="Thmthm5.p1.4.4.m4.4.4.1.1.1"><minus id="Thmthm5.p1.4.4.m4.4.4.1.1.1.1.cmml" xref="Thmthm5.p1.4.4.m4.4.4.1.1.1.1"></minus><ci id="Thmthm5.p1.4.4.m4.4.4.1.1.1.2.cmml" xref="Thmthm5.p1.4.4.m4.4.4.1.1.1.2">𝑛</ci><cn id="Thmthm5.p1.4.4.m4.4.4.1.1.1.3.cmml" type="integer" xref="Thmthm5.p1.4.4.m4.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm5.p1.4.4.m4.4c">i\in\{0,1,\ldots,n-1\}</annotation><annotation encoding="application/x-llamapun" id="Thmthm5.p1.4.4.m4.4d">italic_i ∈ { 0 , 1 , … , italic_n - 1 }</annotation></semantics></math>, setting <math alttext="i_{1}=i\pmod{L}" class="ltx_Math" display="inline" id="Thmthm5.p1.5.5.m5.2"><semantics id="Thmthm5.p1.5.5.m5.2a"><mrow id="Thmthm5.p1.5.5.m5.2.3" xref="Thmthm5.p1.5.5.m5.2.3.cmml"><msub id="Thmthm5.p1.5.5.m5.2.3.2" xref="Thmthm5.p1.5.5.m5.2.3.2.cmml"><mi id="Thmthm5.p1.5.5.m5.2.3.2.2" xref="Thmthm5.p1.5.5.m5.2.3.2.2.cmml">i</mi><mn id="Thmthm5.p1.5.5.m5.2.3.2.3" xref="Thmthm5.p1.5.5.m5.2.3.2.3.cmml">1</mn></msub><mo id="Thmthm5.p1.5.5.m5.2.3.1" xref="Thmthm5.p1.5.5.m5.2.3.1.cmml">=</mo><mrow id="Thmthm5.p1.5.5.m5.2.3.3" xref="Thmthm5.p1.5.5.m5.2.3.3.cmml"><mi id="Thmthm5.p1.5.5.m5.2.3.3.2" xref="Thmthm5.p1.5.5.m5.2.3.3.2.cmml">i</mi><mspace id="Thmthm5.p1.5.5.m5.2.3.3a" width="0.949em" xref="Thmthm5.p1.5.5.m5.2.3.3.cmml"></mspace><mrow id="Thmthm5.p1.5.5.m5.2.2.2.2" xref="Thmthm5.p1.5.5.m5.2.2.3.cmml"><mo id="Thmthm5.p1.5.5.m5.2.2.2.2.2" stretchy="false" xref="Thmthm5.p1.5.5.m5.2.2.3.1.cmml">(</mo><mrow id="Thmthm5.p1.5.5.m5.2.2.2.2.1" xref="Thmthm5.p1.5.5.m5.2.2.3.cmml"><mo id="Thmthm5.p1.5.5.m5.2.2.2.2.1.1" lspace="0em" rspace="0.167em" xref="Thmthm5.p1.5.5.m5.2.2.3.1.cmml">mod</mo><mi id="Thmthm5.p1.5.5.m5.1.1.1.1" xref="Thmthm5.p1.5.5.m5.1.1.1.1.cmml">L</mi></mrow><mo id="Thmthm5.p1.5.5.m5.2.2.2.2.3" stretchy="false" xref="Thmthm5.p1.5.5.m5.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm5.p1.5.5.m5.2b"><apply id="Thmthm5.p1.5.5.m5.2.3.cmml" xref="Thmthm5.p1.5.5.m5.2.3"><eq id="Thmthm5.p1.5.5.m5.2.3.1.cmml" xref="Thmthm5.p1.5.5.m5.2.3.1"></eq><apply id="Thmthm5.p1.5.5.m5.2.3.2.cmml" xref="Thmthm5.p1.5.5.m5.2.3.2"><csymbol cd="ambiguous" id="Thmthm5.p1.5.5.m5.2.3.2.1.cmml" xref="Thmthm5.p1.5.5.m5.2.3.2">subscript</csymbol><ci id="Thmthm5.p1.5.5.m5.2.3.2.2.cmml" xref="Thmthm5.p1.5.5.m5.2.3.2.2">𝑖</ci><cn id="Thmthm5.p1.5.5.m5.2.3.2.3.cmml" type="integer" xref="Thmthm5.p1.5.5.m5.2.3.2.3">1</cn></apply><apply id="Thmthm5.p1.5.5.m5.2.3.3.cmml" xref="Thmthm5.p1.5.5.m5.2.3.3"><csymbol cd="latexml" id="Thmthm5.p1.5.5.m5.2.3.3.1.cmml" xref="Thmthm5.p1.5.5.m5.2.3.3">annotated</csymbol><ci id="Thmthm5.p1.5.5.m5.2.3.3.2.cmml" xref="Thmthm5.p1.5.5.m5.2.3.3.2">𝑖</ci><apply id="Thmthm5.p1.5.5.m5.2.2.3.cmml" xref="Thmthm5.p1.5.5.m5.2.2.2.2"><ci id="Thmthm5.p1.5.5.m5.2.2.3.1.cmml" xref="Thmthm5.p1.5.5.m5.2.2.2.2.2">𝑝𝑚𝑜𝑑</ci><ci id="Thmthm5.p1.5.5.m5.1.1.1.1.cmml" xref="Thmthm5.p1.5.5.m5.1.1.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm5.p1.5.5.m5.2c">i_{1}=i\pmod{L}</annotation><annotation encoding="application/x-llamapun" id="Thmthm5.p1.5.5.m5.2d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_i start_MODIFIER ( roman_mod start_ARG italic_L end_ARG ) end_MODIFIER</annotation></semantics></math> and <math alttext="r=(i-i_{1})/L" class="ltx_Math" display="inline" id="Thmthm5.p1.6.6.m6.1"><semantics id="Thmthm5.p1.6.6.m6.1a"><mrow id="Thmthm5.p1.6.6.m6.1.1" xref="Thmthm5.p1.6.6.m6.1.1.cmml"><mi id="Thmthm5.p1.6.6.m6.1.1.3" xref="Thmthm5.p1.6.6.m6.1.1.3.cmml">r</mi><mo id="Thmthm5.p1.6.6.m6.1.1.2" xref="Thmthm5.p1.6.6.m6.1.1.2.cmml">=</mo><mrow id="Thmthm5.p1.6.6.m6.1.1.1" xref="Thmthm5.p1.6.6.m6.1.1.1.cmml"><mrow id="Thmthm5.p1.6.6.m6.1.1.1.1.1" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.cmml"><mo id="Thmthm5.p1.6.6.m6.1.1.1.1.1.2" stretchy="false" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.cmml"><mi id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.2" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.2.cmml">i</mi><mo id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.1" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.1.cmml">−</mo><msub id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.cmml"><mi id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.2" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.2.cmml">i</mi><mn id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.3" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="Thmthm5.p1.6.6.m6.1.1.1.1.1.3" stretchy="false" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmthm5.p1.6.6.m6.1.1.1.2" xref="Thmthm5.p1.6.6.m6.1.1.1.2.cmml">/</mo><mi id="Thmthm5.p1.6.6.m6.1.1.1.3" xref="Thmthm5.p1.6.6.m6.1.1.1.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm5.p1.6.6.m6.1b"><apply id="Thmthm5.p1.6.6.m6.1.1.cmml" xref="Thmthm5.p1.6.6.m6.1.1"><eq id="Thmthm5.p1.6.6.m6.1.1.2.cmml" xref="Thmthm5.p1.6.6.m6.1.1.2"></eq><ci id="Thmthm5.p1.6.6.m6.1.1.3.cmml" xref="Thmthm5.p1.6.6.m6.1.1.3">𝑟</ci><apply id="Thmthm5.p1.6.6.m6.1.1.1.cmml" xref="Thmthm5.p1.6.6.m6.1.1.1"><divide id="Thmthm5.p1.6.6.m6.1.1.1.2.cmml" xref="Thmthm5.p1.6.6.m6.1.1.1.2"></divide><apply id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.cmml" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1"><minus id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.1.cmml" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.1"></minus><ci id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.2.cmml" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.2">𝑖</ci><apply id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.cmml" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.1.cmml" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3">subscript</csymbol><ci id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.2.cmml" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.2">𝑖</ci><cn id="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.3.cmml" type="integer" xref="Thmthm5.p1.6.6.m6.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="Thmthm5.p1.6.6.m6.1.1.1.3.cmml" xref="Thmthm5.p1.6.6.m6.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm5.p1.6.6.m6.1c">r=(i-i_{1})/L</annotation><annotation encoding="application/x-llamapun" id="Thmthm5.p1.6.6.m6.1d">italic_r = ( italic_i - italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) / italic_L</annotation></semantics></math>, we have <math alttext="LAM(Q,K,V)[i,\cdot]=T_{LAM}[r,i_{1},\cdot]" class="ltx_Math" display="inline" id="Thmthm5.p1.7.7.m7.8"><semantics id="Thmthm5.p1.7.7.m7.8a"><mrow id="Thmthm5.p1.7.7.m7.8.8" xref="Thmthm5.p1.7.7.m7.8.8.cmml"><mrow id="Thmthm5.p1.7.7.m7.8.8.3" xref="Thmthm5.p1.7.7.m7.8.8.3.cmml"><mi id="Thmthm5.p1.7.7.m7.8.8.3.2" xref="Thmthm5.p1.7.7.m7.8.8.3.2.cmml">L</mi><mo id="Thmthm5.p1.7.7.m7.8.8.3.1" xref="Thmthm5.p1.7.7.m7.8.8.3.1.cmml">⁢</mo><mi id="Thmthm5.p1.7.7.m7.8.8.3.3" xref="Thmthm5.p1.7.7.m7.8.8.3.3.cmml">A</mi><mo id="Thmthm5.p1.7.7.m7.8.8.3.1a" xref="Thmthm5.p1.7.7.m7.8.8.3.1.cmml">⁢</mo><mi id="Thmthm5.p1.7.7.m7.8.8.3.4" xref="Thmthm5.p1.7.7.m7.8.8.3.4.cmml">M</mi><mo id="Thmthm5.p1.7.7.m7.8.8.3.1b" xref="Thmthm5.p1.7.7.m7.8.8.3.1.cmml">⁢</mo><mrow id="Thmthm5.p1.7.7.m7.8.8.3.5.2" xref="Thmthm5.p1.7.7.m7.8.8.3.5.1.cmml"><mo id="Thmthm5.p1.7.7.m7.8.8.3.5.2.1" stretchy="false" xref="Thmthm5.p1.7.7.m7.8.8.3.5.1.cmml">(</mo><mi id="Thmthm5.p1.7.7.m7.1.1" xref="Thmthm5.p1.7.7.m7.1.1.cmml">Q</mi><mo id="Thmthm5.p1.7.7.m7.8.8.3.5.2.2" xref="Thmthm5.p1.7.7.m7.8.8.3.5.1.cmml">,</mo><mi id="Thmthm5.p1.7.7.m7.2.2" xref="Thmthm5.p1.7.7.m7.2.2.cmml">K</mi><mo id="Thmthm5.p1.7.7.m7.8.8.3.5.2.3" xref="Thmthm5.p1.7.7.m7.8.8.3.5.1.cmml">,</mo><mi id="Thmthm5.p1.7.7.m7.3.3" xref="Thmthm5.p1.7.7.m7.3.3.cmml">V</mi><mo id="Thmthm5.p1.7.7.m7.8.8.3.5.2.4" stretchy="false" xref="Thmthm5.p1.7.7.m7.8.8.3.5.1.cmml">)</mo></mrow><mo id="Thmthm5.p1.7.7.m7.8.8.3.1c" xref="Thmthm5.p1.7.7.m7.8.8.3.1.cmml">⁢</mo><mrow id="Thmthm5.p1.7.7.m7.8.8.3.6.2" xref="Thmthm5.p1.7.7.m7.8.8.3.6.1.cmml"><mo id="Thmthm5.p1.7.7.m7.8.8.3.6.2.1" stretchy="false" xref="Thmthm5.p1.7.7.m7.8.8.3.6.1.cmml">[</mo><mi id="Thmthm5.p1.7.7.m7.4.4" xref="Thmthm5.p1.7.7.m7.4.4.cmml">i</mi><mo id="Thmthm5.p1.7.7.m7.8.8.3.6.2.2" rspace="0em" xref="Thmthm5.p1.7.7.m7.8.8.3.6.1.cmml">,</mo><mo id="Thmthm5.p1.7.7.m7.5.5" lspace="0em" rspace="0em" xref="Thmthm5.p1.7.7.m7.5.5.cmml">⋅</mo><mo id="Thmthm5.p1.7.7.m7.8.8.3.6.2.3" stretchy="false" xref="Thmthm5.p1.7.7.m7.8.8.3.6.1.cmml">]</mo></mrow></mrow><mo id="Thmthm5.p1.7.7.m7.8.8.2" xref="Thmthm5.p1.7.7.m7.8.8.2.cmml">=</mo><mrow id="Thmthm5.p1.7.7.m7.8.8.1" xref="Thmthm5.p1.7.7.m7.8.8.1.cmml"><msub id="Thmthm5.p1.7.7.m7.8.8.1.3" xref="Thmthm5.p1.7.7.m7.8.8.1.3.cmml"><mi id="Thmthm5.p1.7.7.m7.8.8.1.3.2" xref="Thmthm5.p1.7.7.m7.8.8.1.3.2.cmml">T</mi><mrow id="Thmthm5.p1.7.7.m7.8.8.1.3.3" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3.cmml"><mi id="Thmthm5.p1.7.7.m7.8.8.1.3.3.2" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3.2.cmml">L</mi><mo id="Thmthm5.p1.7.7.m7.8.8.1.3.3.1" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3.1.cmml">⁢</mo><mi id="Thmthm5.p1.7.7.m7.8.8.1.3.3.3" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3.3.cmml">A</mi><mo id="Thmthm5.p1.7.7.m7.8.8.1.3.3.1a" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3.1.cmml">⁢</mo><mi id="Thmthm5.p1.7.7.m7.8.8.1.3.3.4" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3.4.cmml">M</mi></mrow></msub><mo id="Thmthm5.p1.7.7.m7.8.8.1.2" xref="Thmthm5.p1.7.7.m7.8.8.1.2.cmml">⁢</mo><mrow id="Thmthm5.p1.7.7.m7.8.8.1.1.1" xref="Thmthm5.p1.7.7.m7.8.8.1.1.2.cmml"><mo id="Thmthm5.p1.7.7.m7.8.8.1.1.1.2" stretchy="false" xref="Thmthm5.p1.7.7.m7.8.8.1.1.2.cmml">[</mo><mi id="Thmthm5.p1.7.7.m7.6.6" xref="Thmthm5.p1.7.7.m7.6.6.cmml">r</mi><mo id="Thmthm5.p1.7.7.m7.8.8.1.1.1.3" xref="Thmthm5.p1.7.7.m7.8.8.1.1.2.cmml">,</mo><msub id="Thmthm5.p1.7.7.m7.8.8.1.1.1.1" xref="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.cmml"><mi id="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.2" xref="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.2.cmml">i</mi><mn id="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.3" xref="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmthm5.p1.7.7.m7.8.8.1.1.1.4" rspace="0em" xref="Thmthm5.p1.7.7.m7.8.8.1.1.2.cmml">,</mo><mo id="Thmthm5.p1.7.7.m7.7.7" lspace="0em" rspace="0em" xref="Thmthm5.p1.7.7.m7.7.7.cmml">⋅</mo><mo id="Thmthm5.p1.7.7.m7.8.8.1.1.1.5" stretchy="false" xref="Thmthm5.p1.7.7.m7.8.8.1.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm5.p1.7.7.m7.8b"><apply id="Thmthm5.p1.7.7.m7.8.8.cmml" xref="Thmthm5.p1.7.7.m7.8.8"><eq id="Thmthm5.p1.7.7.m7.8.8.2.cmml" xref="Thmthm5.p1.7.7.m7.8.8.2"></eq><apply id="Thmthm5.p1.7.7.m7.8.8.3.cmml" xref="Thmthm5.p1.7.7.m7.8.8.3"><times id="Thmthm5.p1.7.7.m7.8.8.3.1.cmml" xref="Thmthm5.p1.7.7.m7.8.8.3.1"></times><ci id="Thmthm5.p1.7.7.m7.8.8.3.2.cmml" xref="Thmthm5.p1.7.7.m7.8.8.3.2">𝐿</ci><ci id="Thmthm5.p1.7.7.m7.8.8.3.3.cmml" xref="Thmthm5.p1.7.7.m7.8.8.3.3">𝐴</ci><ci id="Thmthm5.p1.7.7.m7.8.8.3.4.cmml" xref="Thmthm5.p1.7.7.m7.8.8.3.4">𝑀</ci><vector id="Thmthm5.p1.7.7.m7.8.8.3.5.1.cmml" xref="Thmthm5.p1.7.7.m7.8.8.3.5.2"><ci id="Thmthm5.p1.7.7.m7.1.1.cmml" xref="Thmthm5.p1.7.7.m7.1.1">𝑄</ci><ci id="Thmthm5.p1.7.7.m7.2.2.cmml" xref="Thmthm5.p1.7.7.m7.2.2">𝐾</ci><ci id="Thmthm5.p1.7.7.m7.3.3.cmml" xref="Thmthm5.p1.7.7.m7.3.3">𝑉</ci></vector><interval closure="closed" id="Thmthm5.p1.7.7.m7.8.8.3.6.1.cmml" xref="Thmthm5.p1.7.7.m7.8.8.3.6.2"><ci id="Thmthm5.p1.7.7.m7.4.4.cmml" xref="Thmthm5.p1.7.7.m7.4.4">𝑖</ci><ci id="Thmthm5.p1.7.7.m7.5.5.cmml" xref="Thmthm5.p1.7.7.m7.5.5">⋅</ci></interval></apply><apply id="Thmthm5.p1.7.7.m7.8.8.1.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1"><times id="Thmthm5.p1.7.7.m7.8.8.1.2.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.2"></times><apply id="Thmthm5.p1.7.7.m7.8.8.1.3.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.3"><csymbol cd="ambiguous" id="Thmthm5.p1.7.7.m7.8.8.1.3.1.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.3">subscript</csymbol><ci id="Thmthm5.p1.7.7.m7.8.8.1.3.2.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.3.2">𝑇</ci><apply id="Thmthm5.p1.7.7.m7.8.8.1.3.3.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3"><times id="Thmthm5.p1.7.7.m7.8.8.1.3.3.1.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3.1"></times><ci id="Thmthm5.p1.7.7.m7.8.8.1.3.3.2.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3.2">𝐿</ci><ci id="Thmthm5.p1.7.7.m7.8.8.1.3.3.3.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3.3">𝐴</ci><ci id="Thmthm5.p1.7.7.m7.8.8.1.3.3.4.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.3.3.4">𝑀</ci></apply></apply><list id="Thmthm5.p1.7.7.m7.8.8.1.1.2.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.1.1"><ci id="Thmthm5.p1.7.7.m7.6.6.cmml" xref="Thmthm5.p1.7.7.m7.6.6">𝑟</ci><apply id="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.1.1.1"><csymbol cd="ambiguous" id="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.1.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.1.1.1">subscript</csymbol><ci id="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.2.cmml" xref="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.2">𝑖</ci><cn id="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.3.cmml" type="integer" xref="Thmthm5.p1.7.7.m7.8.8.1.1.1.1.3">1</cn></apply><ci id="Thmthm5.p1.7.7.m7.7.7.cmml" xref="Thmthm5.p1.7.7.m7.7.7">⋅</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm5.p1.7.7.m7.8c">LAM(Q,K,V)[i,\cdot]=T_{LAM}[r,i_{1},\cdot]</annotation><annotation encoding="application/x-llamapun" id="Thmthm5.p1.7.7.m7.8d">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V ) [ italic_i , ⋅ ] = italic_T start_POSTSUBSCRIPT italic_L italic_A italic_M end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋅ ]</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_proof" id="S3.4">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.4.p1">
<p class="ltx_p" id="S3.4.p1.16">Recall that <math alttext="T_{S}=\operatorname{softmax}((T_{Q}T_{K}^{T}+T_{M})/\sqrt{d_{q}})" class="ltx_Math" display="inline" id="S3.4.p1.1.m1.2"><semantics id="S3.4.p1.1.m1.2a"><mrow id="S3.4.p1.1.m1.2.2" xref="S3.4.p1.1.m1.2.2.cmml"><msub id="S3.4.p1.1.m1.2.2.3" xref="S3.4.p1.1.m1.2.2.3.cmml"><mi id="S3.4.p1.1.m1.2.2.3.2" xref="S3.4.p1.1.m1.2.2.3.2.cmml">T</mi><mi id="S3.4.p1.1.m1.2.2.3.3" xref="S3.4.p1.1.m1.2.2.3.3.cmml">S</mi></msub><mo id="S3.4.p1.1.m1.2.2.2" xref="S3.4.p1.1.m1.2.2.2.cmml">=</mo><mrow id="S3.4.p1.1.m1.2.2.1.1" xref="S3.4.p1.1.m1.2.2.1.2.cmml"><mi id="S3.4.p1.1.m1.1.1" xref="S3.4.p1.1.m1.1.1.cmml">softmax</mi><mo id="S3.4.p1.1.m1.2.2.1.1a" xref="S3.4.p1.1.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.4.p1.1.m1.2.2.1.1.1" xref="S3.4.p1.1.m1.2.2.1.2.cmml"><mo id="S3.4.p1.1.m1.2.2.1.1.1.2" stretchy="false" xref="S3.4.p1.1.m1.2.2.1.2.cmml">(</mo><mrow id="S3.4.p1.1.m1.2.2.1.1.1.1" xref="S3.4.p1.1.m1.2.2.1.1.1.1.cmml"><mrow id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">T</mi><mi id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml">Q</mi></msub><mo id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2.cmml">T</mi><mi id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3.cmml">K</mi><mi id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">T</mi><mi id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.4.p1.1.m1.2.2.1.1.1.1.2" xref="S3.4.p1.1.m1.2.2.1.1.1.1.2.cmml">/</mo><msqrt id="S3.4.p1.1.m1.2.2.1.1.1.1.3" xref="S3.4.p1.1.m1.2.2.1.1.1.1.3.cmml"><msub id="S3.4.p1.1.m1.2.2.1.1.1.1.3.2" xref="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.2" xref="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.2.cmml">d</mi><mi id="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.3" xref="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.3.cmml">q</mi></msub></msqrt></mrow><mo id="S3.4.p1.1.m1.2.2.1.1.1.3" stretchy="false" xref="S3.4.p1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.1.m1.2b"><apply id="S3.4.p1.1.m1.2.2.cmml" xref="S3.4.p1.1.m1.2.2"><eq id="S3.4.p1.1.m1.2.2.2.cmml" xref="S3.4.p1.1.m1.2.2.2"></eq><apply id="S3.4.p1.1.m1.2.2.3.cmml" xref="S3.4.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S3.4.p1.1.m1.2.2.3.1.cmml" xref="S3.4.p1.1.m1.2.2.3">subscript</csymbol><ci id="S3.4.p1.1.m1.2.2.3.2.cmml" xref="S3.4.p1.1.m1.2.2.3.2">𝑇</ci><ci id="S3.4.p1.1.m1.2.2.3.3.cmml" xref="S3.4.p1.1.m1.2.2.3.3">𝑆</ci></apply><apply id="S3.4.p1.1.m1.2.2.1.2.cmml" xref="S3.4.p1.1.m1.2.2.1.1"><ci id="S3.4.p1.1.m1.1.1.cmml" xref="S3.4.p1.1.m1.1.1">softmax</ci><apply id="S3.4.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1"><divide id="S3.4.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.2"></divide><apply id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1"><plus id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.1"></plus><apply id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2"><times id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑇</ci><ci id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3">𝑄</ci></apply><apply id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2">𝑇</ci><ci id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3">𝐾</ci></apply><ci id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.2">𝑇</ci><ci id="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.1.1.1.3.3">𝑀</ci></apply></apply><apply id="S3.4.p1.1.m1.2.2.1.1.1.1.3.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.3"><root id="S3.4.p1.1.m1.2.2.1.1.1.1.3a.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.3"></root><apply id="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.2">𝑑</ci><ci id="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.4.p1.1.m1.2.2.1.1.1.1.3.2.3">𝑞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.1.m1.2c">T_{S}=\operatorname{softmax}((T_{Q}T_{K}^{T}+T_{M})/\sqrt{d_{q}})</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.1.m1.2d">italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = roman_softmax ( ( italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math> has dimensions <math alttext="s\times L\times(2L-1)" class="ltx_Math" display="inline" id="S3.4.p1.2.m2.1"><semantics id="S3.4.p1.2.m2.1a"><mrow id="S3.4.p1.2.m2.1.1" xref="S3.4.p1.2.m2.1.1.cmml"><mi id="S3.4.p1.2.m2.1.1.3" xref="S3.4.p1.2.m2.1.1.3.cmml">s</mi><mo id="S3.4.p1.2.m2.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.4.p1.2.m2.1.1.2.cmml">×</mo><mi id="S3.4.p1.2.m2.1.1.4" xref="S3.4.p1.2.m2.1.1.4.cmml">L</mi><mo id="S3.4.p1.2.m2.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.4.p1.2.m2.1.1.2.cmml">×</mo><mrow id="S3.4.p1.2.m2.1.1.1.1" xref="S3.4.p1.2.m2.1.1.1.1.1.cmml"><mo id="S3.4.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.4.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.4.p1.2.m2.1.1.1.1.1" xref="S3.4.p1.2.m2.1.1.1.1.1.cmml"><mrow id="S3.4.p1.2.m2.1.1.1.1.1.2" xref="S3.4.p1.2.m2.1.1.1.1.1.2.cmml"><mn id="S3.4.p1.2.m2.1.1.1.1.1.2.2" xref="S3.4.p1.2.m2.1.1.1.1.1.2.2.cmml">2</mn><mo id="S3.4.p1.2.m2.1.1.1.1.1.2.1" xref="S3.4.p1.2.m2.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.4.p1.2.m2.1.1.1.1.1.2.3" xref="S3.4.p1.2.m2.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.4.p1.2.m2.1.1.1.1.1.1" xref="S3.4.p1.2.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S3.4.p1.2.m2.1.1.1.1.1.3" xref="S3.4.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.4.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.4.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.2.m2.1b"><apply id="S3.4.p1.2.m2.1.1.cmml" xref="S3.4.p1.2.m2.1.1"><times id="S3.4.p1.2.m2.1.1.2.cmml" xref="S3.4.p1.2.m2.1.1.2"></times><ci id="S3.4.p1.2.m2.1.1.3.cmml" xref="S3.4.p1.2.m2.1.1.3">𝑠</ci><ci id="S3.4.p1.2.m2.1.1.4.cmml" xref="S3.4.p1.2.m2.1.1.4">𝐿</ci><apply id="S3.4.p1.2.m2.1.1.1.1.1.cmml" xref="S3.4.p1.2.m2.1.1.1.1"><minus id="S3.4.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.4.p1.2.m2.1.1.1.1.1.1"></minus><apply id="S3.4.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.4.p1.2.m2.1.1.1.1.1.2"><times id="S3.4.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.4.p1.2.m2.1.1.1.1.1.2.1"></times><cn id="S3.4.p1.2.m2.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.4.p1.2.m2.1.1.1.1.1.2.2">2</cn><ci id="S3.4.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.4.p1.2.m2.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="S3.4.p1.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S3.4.p1.2.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.2.m2.1c">s\times L\times(2L-1)</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.2.m2.1d">italic_s × italic_L × ( 2 italic_L - 1 )</annotation></semantics></math>, see Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm4" title="Lemma 4. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4</span></a>, and <math alttext="T_{V}" class="ltx_Math" display="inline" id="S3.4.p1.3.m3.1"><semantics id="S3.4.p1.3.m3.1a"><msub id="S3.4.p1.3.m3.1.1" xref="S3.4.p1.3.m3.1.1.cmml"><mi id="S3.4.p1.3.m3.1.1.2" xref="S3.4.p1.3.m3.1.1.2.cmml">T</mi><mi id="S3.4.p1.3.m3.1.1.3" xref="S3.4.p1.3.m3.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.4.p1.3.m3.1b"><apply id="S3.4.p1.3.m3.1.1.cmml" xref="S3.4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.4.p1.3.m3.1.1.1.cmml" xref="S3.4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.4.p1.3.m3.1.1.2.cmml" xref="S3.4.p1.3.m3.1.1.2">𝑇</ci><ci id="S3.4.p1.3.m3.1.1.3.cmml" xref="S3.4.p1.3.m3.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.3.m3.1c">T_{V}</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.3.m3.1d">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> has dimensions <math alttext="s\times(2L-1)\times d_{model}" class="ltx_Math" display="inline" id="S3.4.p1.4.m4.1"><semantics id="S3.4.p1.4.m4.1a"><mrow id="S3.4.p1.4.m4.1.1" xref="S3.4.p1.4.m4.1.1.cmml"><mi id="S3.4.p1.4.m4.1.1.3" xref="S3.4.p1.4.m4.1.1.3.cmml">s</mi><mo id="S3.4.p1.4.m4.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.4.p1.4.m4.1.1.2.cmml">×</mo><mrow id="S3.4.p1.4.m4.1.1.1.1" xref="S3.4.p1.4.m4.1.1.1.1.1.cmml"><mo id="S3.4.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S3.4.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.4.p1.4.m4.1.1.1.1.1" xref="S3.4.p1.4.m4.1.1.1.1.1.cmml"><mrow id="S3.4.p1.4.m4.1.1.1.1.1.2" xref="S3.4.p1.4.m4.1.1.1.1.1.2.cmml"><mn id="S3.4.p1.4.m4.1.1.1.1.1.2.2" xref="S3.4.p1.4.m4.1.1.1.1.1.2.2.cmml">2</mn><mo id="S3.4.p1.4.m4.1.1.1.1.1.2.1" xref="S3.4.p1.4.m4.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.4.p1.4.m4.1.1.1.1.1.2.3" xref="S3.4.p1.4.m4.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.4.p1.4.m4.1.1.1.1.1.1" xref="S3.4.p1.4.m4.1.1.1.1.1.1.cmml">−</mo><mn id="S3.4.p1.4.m4.1.1.1.1.1.3" xref="S3.4.p1.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.4.p1.4.m4.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.4.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.4.p1.4.m4.1.1.2a" rspace="0.222em" xref="S3.4.p1.4.m4.1.1.2.cmml">×</mo><msub id="S3.4.p1.4.m4.1.1.4" xref="S3.4.p1.4.m4.1.1.4.cmml"><mi id="S3.4.p1.4.m4.1.1.4.2" xref="S3.4.p1.4.m4.1.1.4.2.cmml">d</mi><mrow id="S3.4.p1.4.m4.1.1.4.3" xref="S3.4.p1.4.m4.1.1.4.3.cmml"><mi id="S3.4.p1.4.m4.1.1.4.3.2" xref="S3.4.p1.4.m4.1.1.4.3.2.cmml">m</mi><mo id="S3.4.p1.4.m4.1.1.4.3.1" xref="S3.4.p1.4.m4.1.1.4.3.1.cmml">⁢</mo><mi id="S3.4.p1.4.m4.1.1.4.3.3" xref="S3.4.p1.4.m4.1.1.4.3.3.cmml">o</mi><mo id="S3.4.p1.4.m4.1.1.4.3.1a" xref="S3.4.p1.4.m4.1.1.4.3.1.cmml">⁢</mo><mi id="S3.4.p1.4.m4.1.1.4.3.4" xref="S3.4.p1.4.m4.1.1.4.3.4.cmml">d</mi><mo id="S3.4.p1.4.m4.1.1.4.3.1b" xref="S3.4.p1.4.m4.1.1.4.3.1.cmml">⁢</mo><mi id="S3.4.p1.4.m4.1.1.4.3.5" xref="S3.4.p1.4.m4.1.1.4.3.5.cmml">e</mi><mo id="S3.4.p1.4.m4.1.1.4.3.1c" xref="S3.4.p1.4.m4.1.1.4.3.1.cmml">⁢</mo><mi id="S3.4.p1.4.m4.1.1.4.3.6" xref="S3.4.p1.4.m4.1.1.4.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.4.m4.1b"><apply id="S3.4.p1.4.m4.1.1.cmml" xref="S3.4.p1.4.m4.1.1"><times id="S3.4.p1.4.m4.1.1.2.cmml" xref="S3.4.p1.4.m4.1.1.2"></times><ci id="S3.4.p1.4.m4.1.1.3.cmml" xref="S3.4.p1.4.m4.1.1.3">𝑠</ci><apply id="S3.4.p1.4.m4.1.1.1.1.1.cmml" xref="S3.4.p1.4.m4.1.1.1.1"><minus id="S3.4.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.4.p1.4.m4.1.1.1.1.1.1"></minus><apply id="S3.4.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.4.p1.4.m4.1.1.1.1.1.2"><times id="S3.4.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.4.p1.4.m4.1.1.1.1.1.2.1"></times><cn id="S3.4.p1.4.m4.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.4.p1.4.m4.1.1.1.1.1.2.2">2</cn><ci id="S3.4.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.4.p1.4.m4.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="S3.4.p1.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S3.4.p1.4.m4.1.1.1.1.1.3">1</cn></apply><apply id="S3.4.p1.4.m4.1.1.4.cmml" xref="S3.4.p1.4.m4.1.1.4"><csymbol cd="ambiguous" id="S3.4.p1.4.m4.1.1.4.1.cmml" xref="S3.4.p1.4.m4.1.1.4">subscript</csymbol><ci id="S3.4.p1.4.m4.1.1.4.2.cmml" xref="S3.4.p1.4.m4.1.1.4.2">𝑑</ci><apply id="S3.4.p1.4.m4.1.1.4.3.cmml" xref="S3.4.p1.4.m4.1.1.4.3"><times id="S3.4.p1.4.m4.1.1.4.3.1.cmml" xref="S3.4.p1.4.m4.1.1.4.3.1"></times><ci id="S3.4.p1.4.m4.1.1.4.3.2.cmml" xref="S3.4.p1.4.m4.1.1.4.3.2">𝑚</ci><ci id="S3.4.p1.4.m4.1.1.4.3.3.cmml" xref="S3.4.p1.4.m4.1.1.4.3.3">𝑜</ci><ci id="S3.4.p1.4.m4.1.1.4.3.4.cmml" xref="S3.4.p1.4.m4.1.1.4.3.4">𝑑</ci><ci id="S3.4.p1.4.m4.1.1.4.3.5.cmml" xref="S3.4.p1.4.m4.1.1.4.3.5">𝑒</ci><ci id="S3.4.p1.4.m4.1.1.4.3.6.cmml" xref="S3.4.p1.4.m4.1.1.4.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.4.m4.1c">s\times(2L-1)\times d_{model}</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.4.m4.1d">italic_s × ( 2 italic_L - 1 ) × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. Thus, <math alttext="T_{LAM}" class="ltx_Math" display="inline" id="S3.4.p1.5.m5.1"><semantics id="S3.4.p1.5.m5.1a"><msub id="S3.4.p1.5.m5.1.1" xref="S3.4.p1.5.m5.1.1.cmml"><mi id="S3.4.p1.5.m5.1.1.2" xref="S3.4.p1.5.m5.1.1.2.cmml">T</mi><mrow id="S3.4.p1.5.m5.1.1.3" xref="S3.4.p1.5.m5.1.1.3.cmml"><mi id="S3.4.p1.5.m5.1.1.3.2" xref="S3.4.p1.5.m5.1.1.3.2.cmml">L</mi><mo id="S3.4.p1.5.m5.1.1.3.1" xref="S3.4.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.4.p1.5.m5.1.1.3.3" xref="S3.4.p1.5.m5.1.1.3.3.cmml">A</mi><mo id="S3.4.p1.5.m5.1.1.3.1a" xref="S3.4.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.4.p1.5.m5.1.1.3.4" xref="S3.4.p1.5.m5.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.4.p1.5.m5.1b"><apply id="S3.4.p1.5.m5.1.1.cmml" xref="S3.4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.4.p1.5.m5.1.1.1.cmml" xref="S3.4.p1.5.m5.1.1">subscript</csymbol><ci id="S3.4.p1.5.m5.1.1.2.cmml" xref="S3.4.p1.5.m5.1.1.2">𝑇</ci><apply id="S3.4.p1.5.m5.1.1.3.cmml" xref="S3.4.p1.5.m5.1.1.3"><times id="S3.4.p1.5.m5.1.1.3.1.cmml" xref="S3.4.p1.5.m5.1.1.3.1"></times><ci id="S3.4.p1.5.m5.1.1.3.2.cmml" xref="S3.4.p1.5.m5.1.1.3.2">𝐿</ci><ci id="S3.4.p1.5.m5.1.1.3.3.cmml" xref="S3.4.p1.5.m5.1.1.3.3">𝐴</ci><ci id="S3.4.p1.5.m5.1.1.3.4.cmml" xref="S3.4.p1.5.m5.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.5.m5.1c">T_{LAM}</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.5.m5.1d">italic_T start_POSTSUBSCRIPT italic_L italic_A italic_M end_POSTSUBSCRIPT</annotation></semantics></math> has dimensions <math alttext="s\times L\times d_{model}" class="ltx_Math" display="inline" id="S3.4.p1.6.m6.1"><semantics id="S3.4.p1.6.m6.1a"><mrow id="S3.4.p1.6.m6.1.1" xref="S3.4.p1.6.m6.1.1.cmml"><mi id="S3.4.p1.6.m6.1.1.2" xref="S3.4.p1.6.m6.1.1.2.cmml">s</mi><mo id="S3.4.p1.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.4.p1.6.m6.1.1.1.cmml">×</mo><mi id="S3.4.p1.6.m6.1.1.3" xref="S3.4.p1.6.m6.1.1.3.cmml">L</mi><mo id="S3.4.p1.6.m6.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.4.p1.6.m6.1.1.1.cmml">×</mo><msub id="S3.4.p1.6.m6.1.1.4" xref="S3.4.p1.6.m6.1.1.4.cmml"><mi id="S3.4.p1.6.m6.1.1.4.2" xref="S3.4.p1.6.m6.1.1.4.2.cmml">d</mi><mrow id="S3.4.p1.6.m6.1.1.4.3" xref="S3.4.p1.6.m6.1.1.4.3.cmml"><mi id="S3.4.p1.6.m6.1.1.4.3.2" xref="S3.4.p1.6.m6.1.1.4.3.2.cmml">m</mi><mo id="S3.4.p1.6.m6.1.1.4.3.1" xref="S3.4.p1.6.m6.1.1.4.3.1.cmml">⁢</mo><mi id="S3.4.p1.6.m6.1.1.4.3.3" xref="S3.4.p1.6.m6.1.1.4.3.3.cmml">o</mi><mo id="S3.4.p1.6.m6.1.1.4.3.1a" xref="S3.4.p1.6.m6.1.1.4.3.1.cmml">⁢</mo><mi id="S3.4.p1.6.m6.1.1.4.3.4" xref="S3.4.p1.6.m6.1.1.4.3.4.cmml">d</mi><mo id="S3.4.p1.6.m6.1.1.4.3.1b" xref="S3.4.p1.6.m6.1.1.4.3.1.cmml">⁢</mo><mi id="S3.4.p1.6.m6.1.1.4.3.5" xref="S3.4.p1.6.m6.1.1.4.3.5.cmml">e</mi><mo id="S3.4.p1.6.m6.1.1.4.3.1c" xref="S3.4.p1.6.m6.1.1.4.3.1.cmml">⁢</mo><mi id="S3.4.p1.6.m6.1.1.4.3.6" xref="S3.4.p1.6.m6.1.1.4.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.6.m6.1b"><apply id="S3.4.p1.6.m6.1.1.cmml" xref="S3.4.p1.6.m6.1.1"><times id="S3.4.p1.6.m6.1.1.1.cmml" xref="S3.4.p1.6.m6.1.1.1"></times><ci id="S3.4.p1.6.m6.1.1.2.cmml" xref="S3.4.p1.6.m6.1.1.2">𝑠</ci><ci id="S3.4.p1.6.m6.1.1.3.cmml" xref="S3.4.p1.6.m6.1.1.3">𝐿</ci><apply id="S3.4.p1.6.m6.1.1.4.cmml" xref="S3.4.p1.6.m6.1.1.4"><csymbol cd="ambiguous" id="S3.4.p1.6.m6.1.1.4.1.cmml" xref="S3.4.p1.6.m6.1.1.4">subscript</csymbol><ci id="S3.4.p1.6.m6.1.1.4.2.cmml" xref="S3.4.p1.6.m6.1.1.4.2">𝑑</ci><apply id="S3.4.p1.6.m6.1.1.4.3.cmml" xref="S3.4.p1.6.m6.1.1.4.3"><times id="S3.4.p1.6.m6.1.1.4.3.1.cmml" xref="S3.4.p1.6.m6.1.1.4.3.1"></times><ci id="S3.4.p1.6.m6.1.1.4.3.2.cmml" xref="S3.4.p1.6.m6.1.1.4.3.2">𝑚</ci><ci id="S3.4.p1.6.m6.1.1.4.3.3.cmml" xref="S3.4.p1.6.m6.1.1.4.3.3">𝑜</ci><ci id="S3.4.p1.6.m6.1.1.4.3.4.cmml" xref="S3.4.p1.6.m6.1.1.4.3.4">𝑑</ci><ci id="S3.4.p1.6.m6.1.1.4.3.5.cmml" xref="S3.4.p1.6.m6.1.1.4.3.5">𝑒</ci><ci id="S3.4.p1.6.m6.1.1.4.3.6.cmml" xref="S3.4.p1.6.m6.1.1.4.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.6.m6.1c">s\times L\times d_{model}</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.6.m6.1d">italic_s × italic_L × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. Now, le t<math alttext="i\in\{0,1,\ldots,n-1\}" class="ltx_Math" display="inline" id="S3.4.p1.7.m7.4"><semantics id="S3.4.p1.7.m7.4a"><mrow id="S3.4.p1.7.m7.4.4" xref="S3.4.p1.7.m7.4.4.cmml"><mi id="S3.4.p1.7.m7.4.4.3" xref="S3.4.p1.7.m7.4.4.3.cmml">i</mi><mo id="S3.4.p1.7.m7.4.4.2" xref="S3.4.p1.7.m7.4.4.2.cmml">∈</mo><mrow id="S3.4.p1.7.m7.4.4.1.1" xref="S3.4.p1.7.m7.4.4.1.2.cmml"><mo id="S3.4.p1.7.m7.4.4.1.1.2" stretchy="false" xref="S3.4.p1.7.m7.4.4.1.2.cmml">{</mo><mn id="S3.4.p1.7.m7.1.1" xref="S3.4.p1.7.m7.1.1.cmml">0</mn><mo id="S3.4.p1.7.m7.4.4.1.1.3" xref="S3.4.p1.7.m7.4.4.1.2.cmml">,</mo><mn id="S3.4.p1.7.m7.2.2" xref="S3.4.p1.7.m7.2.2.cmml">1</mn><mo id="S3.4.p1.7.m7.4.4.1.1.4" xref="S3.4.p1.7.m7.4.4.1.2.cmml">,</mo><mi id="S3.4.p1.7.m7.3.3" mathvariant="normal" xref="S3.4.p1.7.m7.3.3.cmml">…</mi><mo id="S3.4.p1.7.m7.4.4.1.1.5" xref="S3.4.p1.7.m7.4.4.1.2.cmml">,</mo><mrow id="S3.4.p1.7.m7.4.4.1.1.1" xref="S3.4.p1.7.m7.4.4.1.1.1.cmml"><mi id="S3.4.p1.7.m7.4.4.1.1.1.2" xref="S3.4.p1.7.m7.4.4.1.1.1.2.cmml">n</mi><mo id="S3.4.p1.7.m7.4.4.1.1.1.1" xref="S3.4.p1.7.m7.4.4.1.1.1.1.cmml">−</mo><mn id="S3.4.p1.7.m7.4.4.1.1.1.3" xref="S3.4.p1.7.m7.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.4.p1.7.m7.4.4.1.1.6" stretchy="false" xref="S3.4.p1.7.m7.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.7.m7.4b"><apply id="S3.4.p1.7.m7.4.4.cmml" xref="S3.4.p1.7.m7.4.4"><in id="S3.4.p1.7.m7.4.4.2.cmml" xref="S3.4.p1.7.m7.4.4.2"></in><ci id="S3.4.p1.7.m7.4.4.3.cmml" xref="S3.4.p1.7.m7.4.4.3">𝑖</ci><set id="S3.4.p1.7.m7.4.4.1.2.cmml" xref="S3.4.p1.7.m7.4.4.1.1"><cn id="S3.4.p1.7.m7.1.1.cmml" type="integer" xref="S3.4.p1.7.m7.1.1">0</cn><cn id="S3.4.p1.7.m7.2.2.cmml" type="integer" xref="S3.4.p1.7.m7.2.2">1</cn><ci id="S3.4.p1.7.m7.3.3.cmml" xref="S3.4.p1.7.m7.3.3">…</ci><apply id="S3.4.p1.7.m7.4.4.1.1.1.cmml" xref="S3.4.p1.7.m7.4.4.1.1.1"><minus id="S3.4.p1.7.m7.4.4.1.1.1.1.cmml" xref="S3.4.p1.7.m7.4.4.1.1.1.1"></minus><ci id="S3.4.p1.7.m7.4.4.1.1.1.2.cmml" xref="S3.4.p1.7.m7.4.4.1.1.1.2">𝑛</ci><cn id="S3.4.p1.7.m7.4.4.1.1.1.3.cmml" type="integer" xref="S3.4.p1.7.m7.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.7.m7.4c">i\in\{0,1,\ldots,n-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.7.m7.4d">italic_i ∈ { 0 , 1 , … , italic_n - 1 }</annotation></semantics></math> and set <math alttext="i_{1}=i\pmod{L}" class="ltx_Math" display="inline" id="S3.4.p1.8.m8.2"><semantics id="S3.4.p1.8.m8.2a"><mrow id="S3.4.p1.8.m8.2.3" xref="S3.4.p1.8.m8.2.3.cmml"><msub id="S3.4.p1.8.m8.2.3.2" xref="S3.4.p1.8.m8.2.3.2.cmml"><mi id="S3.4.p1.8.m8.2.3.2.2" xref="S3.4.p1.8.m8.2.3.2.2.cmml">i</mi><mn id="S3.4.p1.8.m8.2.3.2.3" xref="S3.4.p1.8.m8.2.3.2.3.cmml">1</mn></msub><mo id="S3.4.p1.8.m8.2.3.1" xref="S3.4.p1.8.m8.2.3.1.cmml">=</mo><mrow id="S3.4.p1.8.m8.2.3.3" xref="S3.4.p1.8.m8.2.3.3.cmml"><mi id="S3.4.p1.8.m8.2.3.3.2" xref="S3.4.p1.8.m8.2.3.3.2.cmml">i</mi><mspace id="S3.4.p1.8.m8.2.3.3a" width="0.949em" xref="S3.4.p1.8.m8.2.3.3.cmml"></mspace><mrow id="S3.4.p1.8.m8.2.2.2.2" xref="S3.4.p1.8.m8.2.2.3.cmml"><mo id="S3.4.p1.8.m8.2.2.2.2.2" stretchy="false" xref="S3.4.p1.8.m8.2.2.3.1.cmml">(</mo><mrow id="S3.4.p1.8.m8.2.2.2.2.1" xref="S3.4.p1.8.m8.2.2.3.cmml"><mo id="S3.4.p1.8.m8.2.2.2.2.1.1" lspace="0em" rspace="0.167em" xref="S3.4.p1.8.m8.2.2.3.1.cmml">mod</mo><mi id="S3.4.p1.8.m8.1.1.1.1" xref="S3.4.p1.8.m8.1.1.1.1.cmml">L</mi></mrow><mo id="S3.4.p1.8.m8.2.2.2.2.3" stretchy="false" xref="S3.4.p1.8.m8.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.8.m8.2b"><apply id="S3.4.p1.8.m8.2.3.cmml" xref="S3.4.p1.8.m8.2.3"><eq id="S3.4.p1.8.m8.2.3.1.cmml" xref="S3.4.p1.8.m8.2.3.1"></eq><apply id="S3.4.p1.8.m8.2.3.2.cmml" xref="S3.4.p1.8.m8.2.3.2"><csymbol cd="ambiguous" id="S3.4.p1.8.m8.2.3.2.1.cmml" xref="S3.4.p1.8.m8.2.3.2">subscript</csymbol><ci id="S3.4.p1.8.m8.2.3.2.2.cmml" xref="S3.4.p1.8.m8.2.3.2.2">𝑖</ci><cn id="S3.4.p1.8.m8.2.3.2.3.cmml" type="integer" xref="S3.4.p1.8.m8.2.3.2.3">1</cn></apply><apply id="S3.4.p1.8.m8.2.3.3.cmml" xref="S3.4.p1.8.m8.2.3.3"><csymbol cd="latexml" id="S3.4.p1.8.m8.2.3.3.1.cmml" xref="S3.4.p1.8.m8.2.3.3">annotated</csymbol><ci id="S3.4.p1.8.m8.2.3.3.2.cmml" xref="S3.4.p1.8.m8.2.3.3.2">𝑖</ci><apply id="S3.4.p1.8.m8.2.2.3.cmml" xref="S3.4.p1.8.m8.2.2.2.2"><ci id="S3.4.p1.8.m8.2.2.3.1.cmml" xref="S3.4.p1.8.m8.2.2.2.2.2">pmod</ci><ci id="S3.4.p1.8.m8.1.1.1.1.cmml" xref="S3.4.p1.8.m8.1.1.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.8.m8.2c">i_{1}=i\pmod{L}</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.8.m8.2d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_i start_MODIFIER ( roman_mod start_ARG italic_L end_ARG ) end_MODIFIER</annotation></semantics></math> and <math alttext="r=(i-i_{1})/L" class="ltx_Math" display="inline" id="S3.4.p1.9.m9.1"><semantics id="S3.4.p1.9.m9.1a"><mrow id="S3.4.p1.9.m9.1.1" xref="S3.4.p1.9.m9.1.1.cmml"><mi id="S3.4.p1.9.m9.1.1.3" xref="S3.4.p1.9.m9.1.1.3.cmml">r</mi><mo id="S3.4.p1.9.m9.1.1.2" xref="S3.4.p1.9.m9.1.1.2.cmml">=</mo><mrow id="S3.4.p1.9.m9.1.1.1" xref="S3.4.p1.9.m9.1.1.1.cmml"><mrow id="S3.4.p1.9.m9.1.1.1.1.1" xref="S3.4.p1.9.m9.1.1.1.1.1.1.cmml"><mo id="S3.4.p1.9.m9.1.1.1.1.1.2" stretchy="false" xref="S3.4.p1.9.m9.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.4.p1.9.m9.1.1.1.1.1.1" xref="S3.4.p1.9.m9.1.1.1.1.1.1.cmml"><mi id="S3.4.p1.9.m9.1.1.1.1.1.1.2" xref="S3.4.p1.9.m9.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.4.p1.9.m9.1.1.1.1.1.1.1" xref="S3.4.p1.9.m9.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.4.p1.9.m9.1.1.1.1.1.1.3" xref="S3.4.p1.9.m9.1.1.1.1.1.1.3.cmml"><mi id="S3.4.p1.9.m9.1.1.1.1.1.1.3.2" xref="S3.4.p1.9.m9.1.1.1.1.1.1.3.2.cmml">i</mi><mn id="S3.4.p1.9.m9.1.1.1.1.1.1.3.3" xref="S3.4.p1.9.m9.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.4.p1.9.m9.1.1.1.1.1.3" stretchy="false" xref="S3.4.p1.9.m9.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.4.p1.9.m9.1.1.1.2" xref="S3.4.p1.9.m9.1.1.1.2.cmml">/</mo><mi id="S3.4.p1.9.m9.1.1.1.3" xref="S3.4.p1.9.m9.1.1.1.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.9.m9.1b"><apply id="S3.4.p1.9.m9.1.1.cmml" xref="S3.4.p1.9.m9.1.1"><eq id="S3.4.p1.9.m9.1.1.2.cmml" xref="S3.4.p1.9.m9.1.1.2"></eq><ci id="S3.4.p1.9.m9.1.1.3.cmml" xref="S3.4.p1.9.m9.1.1.3">𝑟</ci><apply id="S3.4.p1.9.m9.1.1.1.cmml" xref="S3.4.p1.9.m9.1.1.1"><divide id="S3.4.p1.9.m9.1.1.1.2.cmml" xref="S3.4.p1.9.m9.1.1.1.2"></divide><apply id="S3.4.p1.9.m9.1.1.1.1.1.1.cmml" xref="S3.4.p1.9.m9.1.1.1.1.1"><minus id="S3.4.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="S3.4.p1.9.m9.1.1.1.1.1.1.1"></minus><ci id="S3.4.p1.9.m9.1.1.1.1.1.1.2.cmml" xref="S3.4.p1.9.m9.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.4.p1.9.m9.1.1.1.1.1.1.3.cmml" xref="S3.4.p1.9.m9.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.4.p1.9.m9.1.1.1.1.1.1.3.1.cmml" xref="S3.4.p1.9.m9.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.4.p1.9.m9.1.1.1.1.1.1.3.2.cmml" xref="S3.4.p1.9.m9.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.4.p1.9.m9.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.4.p1.9.m9.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.4.p1.9.m9.1.1.1.3.cmml" xref="S3.4.p1.9.m9.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.9.m9.1c">r=(i-i_{1})/L</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.9.m9.1d">italic_r = ( italic_i - italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) / italic_L</annotation></semantics></math>. We note that <math alttext="i_{1}\in\{0,1,\ldots,L-1\}" class="ltx_Math" display="inline" id="S3.4.p1.10.m10.4"><semantics id="S3.4.p1.10.m10.4a"><mrow id="S3.4.p1.10.m10.4.4" xref="S3.4.p1.10.m10.4.4.cmml"><msub id="S3.4.p1.10.m10.4.4.3" xref="S3.4.p1.10.m10.4.4.3.cmml"><mi id="S3.4.p1.10.m10.4.4.3.2" xref="S3.4.p1.10.m10.4.4.3.2.cmml">i</mi><mn id="S3.4.p1.10.m10.4.4.3.3" xref="S3.4.p1.10.m10.4.4.3.3.cmml">1</mn></msub><mo id="S3.4.p1.10.m10.4.4.2" xref="S3.4.p1.10.m10.4.4.2.cmml">∈</mo><mrow id="S3.4.p1.10.m10.4.4.1.1" xref="S3.4.p1.10.m10.4.4.1.2.cmml"><mo id="S3.4.p1.10.m10.4.4.1.1.2" stretchy="false" xref="S3.4.p1.10.m10.4.4.1.2.cmml">{</mo><mn id="S3.4.p1.10.m10.1.1" xref="S3.4.p1.10.m10.1.1.cmml">0</mn><mo id="S3.4.p1.10.m10.4.4.1.1.3" xref="S3.4.p1.10.m10.4.4.1.2.cmml">,</mo><mn id="S3.4.p1.10.m10.2.2" xref="S3.4.p1.10.m10.2.2.cmml">1</mn><mo id="S3.4.p1.10.m10.4.4.1.1.4" xref="S3.4.p1.10.m10.4.4.1.2.cmml">,</mo><mi id="S3.4.p1.10.m10.3.3" mathvariant="normal" xref="S3.4.p1.10.m10.3.3.cmml">…</mi><mo id="S3.4.p1.10.m10.4.4.1.1.5" xref="S3.4.p1.10.m10.4.4.1.2.cmml">,</mo><mrow id="S3.4.p1.10.m10.4.4.1.1.1" xref="S3.4.p1.10.m10.4.4.1.1.1.cmml"><mi id="S3.4.p1.10.m10.4.4.1.1.1.2" xref="S3.4.p1.10.m10.4.4.1.1.1.2.cmml">L</mi><mo id="S3.4.p1.10.m10.4.4.1.1.1.1" xref="S3.4.p1.10.m10.4.4.1.1.1.1.cmml">−</mo><mn id="S3.4.p1.10.m10.4.4.1.1.1.3" xref="S3.4.p1.10.m10.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.4.p1.10.m10.4.4.1.1.6" stretchy="false" xref="S3.4.p1.10.m10.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.10.m10.4b"><apply id="S3.4.p1.10.m10.4.4.cmml" xref="S3.4.p1.10.m10.4.4"><in id="S3.4.p1.10.m10.4.4.2.cmml" xref="S3.4.p1.10.m10.4.4.2"></in><apply id="S3.4.p1.10.m10.4.4.3.cmml" xref="S3.4.p1.10.m10.4.4.3"><csymbol cd="ambiguous" id="S3.4.p1.10.m10.4.4.3.1.cmml" xref="S3.4.p1.10.m10.4.4.3">subscript</csymbol><ci id="S3.4.p1.10.m10.4.4.3.2.cmml" xref="S3.4.p1.10.m10.4.4.3.2">𝑖</ci><cn id="S3.4.p1.10.m10.4.4.3.3.cmml" type="integer" xref="S3.4.p1.10.m10.4.4.3.3">1</cn></apply><set id="S3.4.p1.10.m10.4.4.1.2.cmml" xref="S3.4.p1.10.m10.4.4.1.1"><cn id="S3.4.p1.10.m10.1.1.cmml" type="integer" xref="S3.4.p1.10.m10.1.1">0</cn><cn id="S3.4.p1.10.m10.2.2.cmml" type="integer" xref="S3.4.p1.10.m10.2.2">1</cn><ci id="S3.4.p1.10.m10.3.3.cmml" xref="S3.4.p1.10.m10.3.3">…</ci><apply id="S3.4.p1.10.m10.4.4.1.1.1.cmml" xref="S3.4.p1.10.m10.4.4.1.1.1"><minus id="S3.4.p1.10.m10.4.4.1.1.1.1.cmml" xref="S3.4.p1.10.m10.4.4.1.1.1.1"></minus><ci id="S3.4.p1.10.m10.4.4.1.1.1.2.cmml" xref="S3.4.p1.10.m10.4.4.1.1.1.2">𝐿</ci><cn id="S3.4.p1.10.m10.4.4.1.1.1.3.cmml" type="integer" xref="S3.4.p1.10.m10.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.10.m10.4c">i_{1}\in\{0,1,\ldots,L-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.10.m10.4d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , italic_L - 1 }</annotation></semantics></math> and <math alttext="r\in\{0,1,\ldots,s-1\}" class="ltx_Math" display="inline" id="S3.4.p1.11.m11.4"><semantics id="S3.4.p1.11.m11.4a"><mrow id="S3.4.p1.11.m11.4.4" xref="S3.4.p1.11.m11.4.4.cmml"><mi id="S3.4.p1.11.m11.4.4.3" xref="S3.4.p1.11.m11.4.4.3.cmml">r</mi><mo id="S3.4.p1.11.m11.4.4.2" xref="S3.4.p1.11.m11.4.4.2.cmml">∈</mo><mrow id="S3.4.p1.11.m11.4.4.1.1" xref="S3.4.p1.11.m11.4.4.1.2.cmml"><mo id="S3.4.p1.11.m11.4.4.1.1.2" stretchy="false" xref="S3.4.p1.11.m11.4.4.1.2.cmml">{</mo><mn id="S3.4.p1.11.m11.1.1" xref="S3.4.p1.11.m11.1.1.cmml">0</mn><mo id="S3.4.p1.11.m11.4.4.1.1.3" xref="S3.4.p1.11.m11.4.4.1.2.cmml">,</mo><mn id="S3.4.p1.11.m11.2.2" xref="S3.4.p1.11.m11.2.2.cmml">1</mn><mo id="S3.4.p1.11.m11.4.4.1.1.4" xref="S3.4.p1.11.m11.4.4.1.2.cmml">,</mo><mi id="S3.4.p1.11.m11.3.3" mathvariant="normal" xref="S3.4.p1.11.m11.3.3.cmml">…</mi><mo id="S3.4.p1.11.m11.4.4.1.1.5" xref="S3.4.p1.11.m11.4.4.1.2.cmml">,</mo><mrow id="S3.4.p1.11.m11.4.4.1.1.1" xref="S3.4.p1.11.m11.4.4.1.1.1.cmml"><mi id="S3.4.p1.11.m11.4.4.1.1.1.2" xref="S3.4.p1.11.m11.4.4.1.1.1.2.cmml">s</mi><mo id="S3.4.p1.11.m11.4.4.1.1.1.1" xref="S3.4.p1.11.m11.4.4.1.1.1.1.cmml">−</mo><mn id="S3.4.p1.11.m11.4.4.1.1.1.3" xref="S3.4.p1.11.m11.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.4.p1.11.m11.4.4.1.1.6" stretchy="false" xref="S3.4.p1.11.m11.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.11.m11.4b"><apply id="S3.4.p1.11.m11.4.4.cmml" xref="S3.4.p1.11.m11.4.4"><in id="S3.4.p1.11.m11.4.4.2.cmml" xref="S3.4.p1.11.m11.4.4.2"></in><ci id="S3.4.p1.11.m11.4.4.3.cmml" xref="S3.4.p1.11.m11.4.4.3">𝑟</ci><set id="S3.4.p1.11.m11.4.4.1.2.cmml" xref="S3.4.p1.11.m11.4.4.1.1"><cn id="S3.4.p1.11.m11.1.1.cmml" type="integer" xref="S3.4.p1.11.m11.1.1">0</cn><cn id="S3.4.p1.11.m11.2.2.cmml" type="integer" xref="S3.4.p1.11.m11.2.2">1</cn><ci id="S3.4.p1.11.m11.3.3.cmml" xref="S3.4.p1.11.m11.3.3">…</ci><apply id="S3.4.p1.11.m11.4.4.1.1.1.cmml" xref="S3.4.p1.11.m11.4.4.1.1.1"><minus id="S3.4.p1.11.m11.4.4.1.1.1.1.cmml" xref="S3.4.p1.11.m11.4.4.1.1.1.1"></minus><ci id="S3.4.p1.11.m11.4.4.1.1.1.2.cmml" xref="S3.4.p1.11.m11.4.4.1.1.1.2">𝑠</ci><cn id="S3.4.p1.11.m11.4.4.1.1.1.3.cmml" type="integer" xref="S3.4.p1.11.m11.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.11.m11.4c">r\in\{0,1,\ldots,s-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.11.m11.4d">italic_r ∈ { 0 , 1 , … , italic_s - 1 }</annotation></semantics></math>. By Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm4" title="Lemma 4. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4</span></a>, for all <math alttext="j_{1}\in\{0,1,\ldots,2L-2\}" class="ltx_Math" display="inline" id="S3.4.p1.12.m12.4"><semantics id="S3.4.p1.12.m12.4a"><mrow id="S3.4.p1.12.m12.4.4" xref="S3.4.p1.12.m12.4.4.cmml"><msub id="S3.4.p1.12.m12.4.4.3" xref="S3.4.p1.12.m12.4.4.3.cmml"><mi id="S3.4.p1.12.m12.4.4.3.2" xref="S3.4.p1.12.m12.4.4.3.2.cmml">j</mi><mn id="S3.4.p1.12.m12.4.4.3.3" xref="S3.4.p1.12.m12.4.4.3.3.cmml">1</mn></msub><mo id="S3.4.p1.12.m12.4.4.2" xref="S3.4.p1.12.m12.4.4.2.cmml">∈</mo><mrow id="S3.4.p1.12.m12.4.4.1.1" xref="S3.4.p1.12.m12.4.4.1.2.cmml"><mo id="S3.4.p1.12.m12.4.4.1.1.2" stretchy="false" xref="S3.4.p1.12.m12.4.4.1.2.cmml">{</mo><mn id="S3.4.p1.12.m12.1.1" xref="S3.4.p1.12.m12.1.1.cmml">0</mn><mo id="S3.4.p1.12.m12.4.4.1.1.3" xref="S3.4.p1.12.m12.4.4.1.2.cmml">,</mo><mn id="S3.4.p1.12.m12.2.2" xref="S3.4.p1.12.m12.2.2.cmml">1</mn><mo id="S3.4.p1.12.m12.4.4.1.1.4" xref="S3.4.p1.12.m12.4.4.1.2.cmml">,</mo><mi id="S3.4.p1.12.m12.3.3" mathvariant="normal" xref="S3.4.p1.12.m12.3.3.cmml">…</mi><mo id="S3.4.p1.12.m12.4.4.1.1.5" xref="S3.4.p1.12.m12.4.4.1.2.cmml">,</mo><mrow id="S3.4.p1.12.m12.4.4.1.1.1" xref="S3.4.p1.12.m12.4.4.1.1.1.cmml"><mrow id="S3.4.p1.12.m12.4.4.1.1.1.2" xref="S3.4.p1.12.m12.4.4.1.1.1.2.cmml"><mn id="S3.4.p1.12.m12.4.4.1.1.1.2.2" xref="S3.4.p1.12.m12.4.4.1.1.1.2.2.cmml">2</mn><mo id="S3.4.p1.12.m12.4.4.1.1.1.2.1" xref="S3.4.p1.12.m12.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="S3.4.p1.12.m12.4.4.1.1.1.2.3" xref="S3.4.p1.12.m12.4.4.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.4.p1.12.m12.4.4.1.1.1.1" xref="S3.4.p1.12.m12.4.4.1.1.1.1.cmml">−</mo><mn id="S3.4.p1.12.m12.4.4.1.1.1.3" xref="S3.4.p1.12.m12.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="S3.4.p1.12.m12.4.4.1.1.6" stretchy="false" xref="S3.4.p1.12.m12.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.12.m12.4b"><apply id="S3.4.p1.12.m12.4.4.cmml" xref="S3.4.p1.12.m12.4.4"><in id="S3.4.p1.12.m12.4.4.2.cmml" xref="S3.4.p1.12.m12.4.4.2"></in><apply id="S3.4.p1.12.m12.4.4.3.cmml" xref="S3.4.p1.12.m12.4.4.3"><csymbol cd="ambiguous" id="S3.4.p1.12.m12.4.4.3.1.cmml" xref="S3.4.p1.12.m12.4.4.3">subscript</csymbol><ci id="S3.4.p1.12.m12.4.4.3.2.cmml" xref="S3.4.p1.12.m12.4.4.3.2">𝑗</ci><cn id="S3.4.p1.12.m12.4.4.3.3.cmml" type="integer" xref="S3.4.p1.12.m12.4.4.3.3">1</cn></apply><set id="S3.4.p1.12.m12.4.4.1.2.cmml" xref="S3.4.p1.12.m12.4.4.1.1"><cn id="S3.4.p1.12.m12.1.1.cmml" type="integer" xref="S3.4.p1.12.m12.1.1">0</cn><cn id="S3.4.p1.12.m12.2.2.cmml" type="integer" xref="S3.4.p1.12.m12.2.2">1</cn><ci id="S3.4.p1.12.m12.3.3.cmml" xref="S3.4.p1.12.m12.3.3">…</ci><apply id="S3.4.p1.12.m12.4.4.1.1.1.cmml" xref="S3.4.p1.12.m12.4.4.1.1.1"><minus id="S3.4.p1.12.m12.4.4.1.1.1.1.cmml" xref="S3.4.p1.12.m12.4.4.1.1.1.1"></minus><apply id="S3.4.p1.12.m12.4.4.1.1.1.2.cmml" xref="S3.4.p1.12.m12.4.4.1.1.1.2"><times id="S3.4.p1.12.m12.4.4.1.1.1.2.1.cmml" xref="S3.4.p1.12.m12.4.4.1.1.1.2.1"></times><cn id="S3.4.p1.12.m12.4.4.1.1.1.2.2.cmml" type="integer" xref="S3.4.p1.12.m12.4.4.1.1.1.2.2">2</cn><ci id="S3.4.p1.12.m12.4.4.1.1.1.2.3.cmml" xref="S3.4.p1.12.m12.4.4.1.1.1.2.3">𝐿</ci></apply><cn id="S3.4.p1.12.m12.4.4.1.1.1.3.cmml" type="integer" xref="S3.4.p1.12.m12.4.4.1.1.1.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.12.m12.4c">j_{1}\in\{0,1,\ldots,2L-2\}</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.12.m12.4d">italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ { 0 , 1 , … , 2 italic_L - 2 }</annotation></semantics></math>, we have <math alttext="T_{S}[r,i_{1},j_{1}]=S[i,j]" class="ltx_Math" display="inline" id="S3.4.p1.13.m13.5"><semantics id="S3.4.p1.13.m13.5a"><mrow id="S3.4.p1.13.m13.5.5" xref="S3.4.p1.13.m13.5.5.cmml"><mrow id="S3.4.p1.13.m13.5.5.2" xref="S3.4.p1.13.m13.5.5.2.cmml"><msub id="S3.4.p1.13.m13.5.5.2.4" xref="S3.4.p1.13.m13.5.5.2.4.cmml"><mi id="S3.4.p1.13.m13.5.5.2.4.2" xref="S3.4.p1.13.m13.5.5.2.4.2.cmml">T</mi><mi id="S3.4.p1.13.m13.5.5.2.4.3" xref="S3.4.p1.13.m13.5.5.2.4.3.cmml">S</mi></msub><mo id="S3.4.p1.13.m13.5.5.2.3" xref="S3.4.p1.13.m13.5.5.2.3.cmml">⁢</mo><mrow id="S3.4.p1.13.m13.5.5.2.2.2" xref="S3.4.p1.13.m13.5.5.2.2.3.cmml"><mo id="S3.4.p1.13.m13.5.5.2.2.2.3" stretchy="false" xref="S3.4.p1.13.m13.5.5.2.2.3.cmml">[</mo><mi id="S3.4.p1.13.m13.1.1" xref="S3.4.p1.13.m13.1.1.cmml">r</mi><mo id="S3.4.p1.13.m13.5.5.2.2.2.4" xref="S3.4.p1.13.m13.5.5.2.2.3.cmml">,</mo><msub id="S3.4.p1.13.m13.4.4.1.1.1.1" xref="S3.4.p1.13.m13.4.4.1.1.1.1.cmml"><mi id="S3.4.p1.13.m13.4.4.1.1.1.1.2" xref="S3.4.p1.13.m13.4.4.1.1.1.1.2.cmml">i</mi><mn id="S3.4.p1.13.m13.4.4.1.1.1.1.3" xref="S3.4.p1.13.m13.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.4.p1.13.m13.5.5.2.2.2.5" xref="S3.4.p1.13.m13.5.5.2.2.3.cmml">,</mo><msub id="S3.4.p1.13.m13.5.5.2.2.2.2" xref="S3.4.p1.13.m13.5.5.2.2.2.2.cmml"><mi id="S3.4.p1.13.m13.5.5.2.2.2.2.2" xref="S3.4.p1.13.m13.5.5.2.2.2.2.2.cmml">j</mi><mn id="S3.4.p1.13.m13.5.5.2.2.2.2.3" xref="S3.4.p1.13.m13.5.5.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.4.p1.13.m13.5.5.2.2.2.6" stretchy="false" xref="S3.4.p1.13.m13.5.5.2.2.3.cmml">]</mo></mrow></mrow><mo id="S3.4.p1.13.m13.5.5.3" xref="S3.4.p1.13.m13.5.5.3.cmml">=</mo><mrow id="S3.4.p1.13.m13.5.5.4" xref="S3.4.p1.13.m13.5.5.4.cmml"><mi id="S3.4.p1.13.m13.5.5.4.2" xref="S3.4.p1.13.m13.5.5.4.2.cmml">S</mi><mo id="S3.4.p1.13.m13.5.5.4.1" xref="S3.4.p1.13.m13.5.5.4.1.cmml">⁢</mo><mrow id="S3.4.p1.13.m13.5.5.4.3.2" xref="S3.4.p1.13.m13.5.5.4.3.1.cmml"><mo id="S3.4.p1.13.m13.5.5.4.3.2.1" stretchy="false" xref="S3.4.p1.13.m13.5.5.4.3.1.cmml">[</mo><mi id="S3.4.p1.13.m13.2.2" xref="S3.4.p1.13.m13.2.2.cmml">i</mi><mo id="S3.4.p1.13.m13.5.5.4.3.2.2" xref="S3.4.p1.13.m13.5.5.4.3.1.cmml">,</mo><mi id="S3.4.p1.13.m13.3.3" xref="S3.4.p1.13.m13.3.3.cmml">j</mi><mo id="S3.4.p1.13.m13.5.5.4.3.2.3" stretchy="false" xref="S3.4.p1.13.m13.5.5.4.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.13.m13.5b"><apply id="S3.4.p1.13.m13.5.5.cmml" xref="S3.4.p1.13.m13.5.5"><eq id="S3.4.p1.13.m13.5.5.3.cmml" xref="S3.4.p1.13.m13.5.5.3"></eq><apply id="S3.4.p1.13.m13.5.5.2.cmml" xref="S3.4.p1.13.m13.5.5.2"><times id="S3.4.p1.13.m13.5.5.2.3.cmml" xref="S3.4.p1.13.m13.5.5.2.3"></times><apply id="S3.4.p1.13.m13.5.5.2.4.cmml" xref="S3.4.p1.13.m13.5.5.2.4"><csymbol cd="ambiguous" id="S3.4.p1.13.m13.5.5.2.4.1.cmml" xref="S3.4.p1.13.m13.5.5.2.4">subscript</csymbol><ci id="S3.4.p1.13.m13.5.5.2.4.2.cmml" xref="S3.4.p1.13.m13.5.5.2.4.2">𝑇</ci><ci id="S3.4.p1.13.m13.5.5.2.4.3.cmml" xref="S3.4.p1.13.m13.5.5.2.4.3">𝑆</ci></apply><list id="S3.4.p1.13.m13.5.5.2.2.3.cmml" xref="S3.4.p1.13.m13.5.5.2.2.2"><ci id="S3.4.p1.13.m13.1.1.cmml" xref="S3.4.p1.13.m13.1.1">𝑟</ci><apply id="S3.4.p1.13.m13.4.4.1.1.1.1.cmml" xref="S3.4.p1.13.m13.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.4.p1.13.m13.4.4.1.1.1.1.1.cmml" xref="S3.4.p1.13.m13.4.4.1.1.1.1">subscript</csymbol><ci id="S3.4.p1.13.m13.4.4.1.1.1.1.2.cmml" xref="S3.4.p1.13.m13.4.4.1.1.1.1.2">𝑖</ci><cn id="S3.4.p1.13.m13.4.4.1.1.1.1.3.cmml" type="integer" xref="S3.4.p1.13.m13.4.4.1.1.1.1.3">1</cn></apply><apply id="S3.4.p1.13.m13.5.5.2.2.2.2.cmml" xref="S3.4.p1.13.m13.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.4.p1.13.m13.5.5.2.2.2.2.1.cmml" xref="S3.4.p1.13.m13.5.5.2.2.2.2">subscript</csymbol><ci id="S3.4.p1.13.m13.5.5.2.2.2.2.2.cmml" xref="S3.4.p1.13.m13.5.5.2.2.2.2.2">𝑗</ci><cn id="S3.4.p1.13.m13.5.5.2.2.2.2.3.cmml" type="integer" xref="S3.4.p1.13.m13.5.5.2.2.2.2.3">1</cn></apply></list></apply><apply id="S3.4.p1.13.m13.5.5.4.cmml" xref="S3.4.p1.13.m13.5.5.4"><times id="S3.4.p1.13.m13.5.5.4.1.cmml" xref="S3.4.p1.13.m13.5.5.4.1"></times><ci id="S3.4.p1.13.m13.5.5.4.2.cmml" xref="S3.4.p1.13.m13.5.5.4.2">𝑆</ci><interval closure="closed" id="S3.4.p1.13.m13.5.5.4.3.1.cmml" xref="S3.4.p1.13.m13.5.5.4.3.2"><ci id="S3.4.p1.13.m13.2.2.cmml" xref="S3.4.p1.13.m13.2.2">𝑖</ci><ci id="S3.4.p1.13.m13.3.3.cmml" xref="S3.4.p1.13.m13.3.3">𝑗</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.13.m13.5c">T_{S}[r,i_{1},j_{1}]=S[i,j]</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.13.m13.5d">italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = italic_S [ italic_i , italic_j ]</annotation></semantics></math> for <math alttext="j=r(L-1)+1+j_{1}" class="ltx_Math" display="inline" id="S3.4.p1.14.m14.1"><semantics id="S3.4.p1.14.m14.1a"><mrow id="S3.4.p1.14.m14.1.1" xref="S3.4.p1.14.m14.1.1.cmml"><mi id="S3.4.p1.14.m14.1.1.3" xref="S3.4.p1.14.m14.1.1.3.cmml">j</mi><mo id="S3.4.p1.14.m14.1.1.2" xref="S3.4.p1.14.m14.1.1.2.cmml">=</mo><mrow id="S3.4.p1.14.m14.1.1.1" xref="S3.4.p1.14.m14.1.1.1.cmml"><mrow id="S3.4.p1.14.m14.1.1.1.1" xref="S3.4.p1.14.m14.1.1.1.1.cmml"><mi id="S3.4.p1.14.m14.1.1.1.1.3" xref="S3.4.p1.14.m14.1.1.1.1.3.cmml">r</mi><mo id="S3.4.p1.14.m14.1.1.1.1.2" xref="S3.4.p1.14.m14.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.4.p1.14.m14.1.1.1.1.1.1" xref="S3.4.p1.14.m14.1.1.1.1.1.1.1.cmml"><mo id="S3.4.p1.14.m14.1.1.1.1.1.1.2" stretchy="false" xref="S3.4.p1.14.m14.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.4.p1.14.m14.1.1.1.1.1.1.1" xref="S3.4.p1.14.m14.1.1.1.1.1.1.1.cmml"><mi id="S3.4.p1.14.m14.1.1.1.1.1.1.1.2" xref="S3.4.p1.14.m14.1.1.1.1.1.1.1.2.cmml">L</mi><mo id="S3.4.p1.14.m14.1.1.1.1.1.1.1.1" xref="S3.4.p1.14.m14.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.4.p1.14.m14.1.1.1.1.1.1.1.3" xref="S3.4.p1.14.m14.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.4.p1.14.m14.1.1.1.1.1.1.3" stretchy="false" xref="S3.4.p1.14.m14.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.4.p1.14.m14.1.1.1.2" xref="S3.4.p1.14.m14.1.1.1.2.cmml">+</mo><mn id="S3.4.p1.14.m14.1.1.1.3" xref="S3.4.p1.14.m14.1.1.1.3.cmml">1</mn><mo id="S3.4.p1.14.m14.1.1.1.2a" xref="S3.4.p1.14.m14.1.1.1.2.cmml">+</mo><msub id="S3.4.p1.14.m14.1.1.1.4" xref="S3.4.p1.14.m14.1.1.1.4.cmml"><mi id="S3.4.p1.14.m14.1.1.1.4.2" xref="S3.4.p1.14.m14.1.1.1.4.2.cmml">j</mi><mn id="S3.4.p1.14.m14.1.1.1.4.3" xref="S3.4.p1.14.m14.1.1.1.4.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.14.m14.1b"><apply id="S3.4.p1.14.m14.1.1.cmml" xref="S3.4.p1.14.m14.1.1"><eq id="S3.4.p1.14.m14.1.1.2.cmml" xref="S3.4.p1.14.m14.1.1.2"></eq><ci id="S3.4.p1.14.m14.1.1.3.cmml" xref="S3.4.p1.14.m14.1.1.3">𝑗</ci><apply id="S3.4.p1.14.m14.1.1.1.cmml" xref="S3.4.p1.14.m14.1.1.1"><plus id="S3.4.p1.14.m14.1.1.1.2.cmml" xref="S3.4.p1.14.m14.1.1.1.2"></plus><apply id="S3.4.p1.14.m14.1.1.1.1.cmml" xref="S3.4.p1.14.m14.1.1.1.1"><times id="S3.4.p1.14.m14.1.1.1.1.2.cmml" xref="S3.4.p1.14.m14.1.1.1.1.2"></times><ci id="S3.4.p1.14.m14.1.1.1.1.3.cmml" xref="S3.4.p1.14.m14.1.1.1.1.3">𝑟</ci><apply id="S3.4.p1.14.m14.1.1.1.1.1.1.1.cmml" xref="S3.4.p1.14.m14.1.1.1.1.1.1"><minus id="S3.4.p1.14.m14.1.1.1.1.1.1.1.1.cmml" xref="S3.4.p1.14.m14.1.1.1.1.1.1.1.1"></minus><ci id="S3.4.p1.14.m14.1.1.1.1.1.1.1.2.cmml" xref="S3.4.p1.14.m14.1.1.1.1.1.1.1.2">𝐿</ci><cn id="S3.4.p1.14.m14.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.4.p1.14.m14.1.1.1.1.1.1.1.3">1</cn></apply></apply><cn id="S3.4.p1.14.m14.1.1.1.3.cmml" type="integer" xref="S3.4.p1.14.m14.1.1.1.3">1</cn><apply id="S3.4.p1.14.m14.1.1.1.4.cmml" xref="S3.4.p1.14.m14.1.1.1.4"><csymbol cd="ambiguous" id="S3.4.p1.14.m14.1.1.1.4.1.cmml" xref="S3.4.p1.14.m14.1.1.1.4">subscript</csymbol><ci id="S3.4.p1.14.m14.1.1.1.4.2.cmml" xref="S3.4.p1.14.m14.1.1.1.4.2">𝑗</ci><cn id="S3.4.p1.14.m14.1.1.1.4.3.cmml" type="integer" xref="S3.4.p1.14.m14.1.1.1.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.14.m14.1c">j=r(L-1)+1+j_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.14.m14.1d">italic_j = italic_r ( italic_L - 1 ) + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="S[i,j]=0" class="ltx_Math" display="inline" id="S3.4.p1.15.m15.2"><semantics id="S3.4.p1.15.m15.2a"><mrow id="S3.4.p1.15.m15.2.3" xref="S3.4.p1.15.m15.2.3.cmml"><mrow id="S3.4.p1.15.m15.2.3.2" xref="S3.4.p1.15.m15.2.3.2.cmml"><mi id="S3.4.p1.15.m15.2.3.2.2" xref="S3.4.p1.15.m15.2.3.2.2.cmml">S</mi><mo id="S3.4.p1.15.m15.2.3.2.1" xref="S3.4.p1.15.m15.2.3.2.1.cmml">⁢</mo><mrow id="S3.4.p1.15.m15.2.3.2.3.2" xref="S3.4.p1.15.m15.2.3.2.3.1.cmml"><mo id="S3.4.p1.15.m15.2.3.2.3.2.1" stretchy="false" xref="S3.4.p1.15.m15.2.3.2.3.1.cmml">[</mo><mi id="S3.4.p1.15.m15.1.1" xref="S3.4.p1.15.m15.1.1.cmml">i</mi><mo id="S3.4.p1.15.m15.2.3.2.3.2.2" xref="S3.4.p1.15.m15.2.3.2.3.1.cmml">,</mo><mi id="S3.4.p1.15.m15.2.2" xref="S3.4.p1.15.m15.2.2.cmml">j</mi><mo id="S3.4.p1.15.m15.2.3.2.3.2.3" stretchy="false" xref="S3.4.p1.15.m15.2.3.2.3.1.cmml">]</mo></mrow></mrow><mo id="S3.4.p1.15.m15.2.3.1" xref="S3.4.p1.15.m15.2.3.1.cmml">=</mo><mn id="S3.4.p1.15.m15.2.3.3" xref="S3.4.p1.15.m15.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.15.m15.2b"><apply id="S3.4.p1.15.m15.2.3.cmml" xref="S3.4.p1.15.m15.2.3"><eq id="S3.4.p1.15.m15.2.3.1.cmml" xref="S3.4.p1.15.m15.2.3.1"></eq><apply id="S3.4.p1.15.m15.2.3.2.cmml" xref="S3.4.p1.15.m15.2.3.2"><times id="S3.4.p1.15.m15.2.3.2.1.cmml" xref="S3.4.p1.15.m15.2.3.2.1"></times><ci id="S3.4.p1.15.m15.2.3.2.2.cmml" xref="S3.4.p1.15.m15.2.3.2.2">𝑆</ci><interval closure="closed" id="S3.4.p1.15.m15.2.3.2.3.1.cmml" xref="S3.4.p1.15.m15.2.3.2.3.2"><ci id="S3.4.p1.15.m15.1.1.cmml" xref="S3.4.p1.15.m15.1.1">𝑖</ci><ci id="S3.4.p1.15.m15.2.2.cmml" xref="S3.4.p1.15.m15.2.2">𝑗</ci></interval></apply><cn id="S3.4.p1.15.m15.2.3.3.cmml" type="integer" xref="S3.4.p1.15.m15.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.15.m15.2c">S[i,j]=0</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.15.m15.2d">italic_S [ italic_i , italic_j ] = 0</annotation></semantics></math> for other values of <math alttext="j" class="ltx_Math" display="inline" id="S3.4.p1.16.m16.1"><semantics id="S3.4.p1.16.m16.1a"><mi id="S3.4.p1.16.m16.1.1" xref="S3.4.p1.16.m16.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.4.p1.16.m16.1b"><ci id="S3.4.p1.16.m16.1.1.cmml" xref="S3.4.p1.16.m16.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.16.m16.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.16.m16.1d">italic_j</annotation></semantics></math>. Therefore,
we find that</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="T_{LAM}[r,i,\cdot]=T_{S}[r,i_{1},\cdot]T_{V}[r,\cdot,\cdot]=S[i,\cdot]V," class="ltx_Math" display="block" id="S3.Ex9.m1.11"><semantics id="S3.Ex9.m1.11a"><mrow id="S3.Ex9.m1.11.11.1" xref="S3.Ex9.m1.11.11.1.1.cmml"><mrow id="S3.Ex9.m1.11.11.1.1" xref="S3.Ex9.m1.11.11.1.1.cmml"><mrow id="S3.Ex9.m1.11.11.1.1.3" xref="S3.Ex9.m1.11.11.1.1.3.cmml"><msub id="S3.Ex9.m1.11.11.1.1.3.2" xref="S3.Ex9.m1.11.11.1.1.3.2.cmml"><mi id="S3.Ex9.m1.11.11.1.1.3.2.2" xref="S3.Ex9.m1.11.11.1.1.3.2.2.cmml">T</mi><mrow id="S3.Ex9.m1.11.11.1.1.3.2.3" xref="S3.Ex9.m1.11.11.1.1.3.2.3.cmml"><mi id="S3.Ex9.m1.11.11.1.1.3.2.3.2" xref="S3.Ex9.m1.11.11.1.1.3.2.3.2.cmml">L</mi><mo id="S3.Ex9.m1.11.11.1.1.3.2.3.1" xref="S3.Ex9.m1.11.11.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex9.m1.11.11.1.1.3.2.3.3" xref="S3.Ex9.m1.11.11.1.1.3.2.3.3.cmml">A</mi><mo id="S3.Ex9.m1.11.11.1.1.3.2.3.1a" xref="S3.Ex9.m1.11.11.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex9.m1.11.11.1.1.3.2.3.4" xref="S3.Ex9.m1.11.11.1.1.3.2.3.4.cmml">M</mi></mrow></msub><mo id="S3.Ex9.m1.11.11.1.1.3.1" xref="S3.Ex9.m1.11.11.1.1.3.1.cmml">⁢</mo><mrow id="S3.Ex9.m1.11.11.1.1.3.3.2" xref="S3.Ex9.m1.11.11.1.1.3.3.1.cmml"><mo id="S3.Ex9.m1.11.11.1.1.3.3.2.1" stretchy="false" xref="S3.Ex9.m1.11.11.1.1.3.3.1.cmml">[</mo><mi id="S3.Ex9.m1.1.1" xref="S3.Ex9.m1.1.1.cmml">r</mi><mo id="S3.Ex9.m1.11.11.1.1.3.3.2.2" xref="S3.Ex9.m1.11.11.1.1.3.3.1.cmml">,</mo><mi id="S3.Ex9.m1.2.2" xref="S3.Ex9.m1.2.2.cmml">i</mi><mo id="S3.Ex9.m1.11.11.1.1.3.3.2.3" rspace="0em" xref="S3.Ex9.m1.11.11.1.1.3.3.1.cmml">,</mo><mo id="S3.Ex9.m1.3.3" lspace="0em" rspace="0em" xref="S3.Ex9.m1.3.3.cmml">⋅</mo><mo id="S3.Ex9.m1.11.11.1.1.3.3.2.4" stretchy="false" xref="S3.Ex9.m1.11.11.1.1.3.3.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex9.m1.11.11.1.1.4" xref="S3.Ex9.m1.11.11.1.1.4.cmml">=</mo><mrow id="S3.Ex9.m1.11.11.1.1.1" xref="S3.Ex9.m1.11.11.1.1.1.cmml"><msub id="S3.Ex9.m1.11.11.1.1.1.3" xref="S3.Ex9.m1.11.11.1.1.1.3.cmml"><mi id="S3.Ex9.m1.11.11.1.1.1.3.2" xref="S3.Ex9.m1.11.11.1.1.1.3.2.cmml">T</mi><mi id="S3.Ex9.m1.11.11.1.1.1.3.3" xref="S3.Ex9.m1.11.11.1.1.1.3.3.cmml">S</mi></msub><mo id="S3.Ex9.m1.11.11.1.1.1.2" xref="S3.Ex9.m1.11.11.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.11.11.1.1.1.1.1" xref="S3.Ex9.m1.11.11.1.1.1.1.2.cmml"><mo id="S3.Ex9.m1.11.11.1.1.1.1.1.2" stretchy="false" xref="S3.Ex9.m1.11.11.1.1.1.1.2.cmml">[</mo><mi id="S3.Ex9.m1.4.4" xref="S3.Ex9.m1.4.4.cmml">r</mi><mo id="S3.Ex9.m1.11.11.1.1.1.1.1.3" xref="S3.Ex9.m1.11.11.1.1.1.1.2.cmml">,</mo><msub id="S3.Ex9.m1.11.11.1.1.1.1.1.1" xref="S3.Ex9.m1.11.11.1.1.1.1.1.1.cmml"><mi id="S3.Ex9.m1.11.11.1.1.1.1.1.1.2" xref="S3.Ex9.m1.11.11.1.1.1.1.1.1.2.cmml">i</mi><mn id="S3.Ex9.m1.11.11.1.1.1.1.1.1.3" xref="S3.Ex9.m1.11.11.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex9.m1.11.11.1.1.1.1.1.4" rspace="0em" xref="S3.Ex9.m1.11.11.1.1.1.1.2.cmml">,</mo><mo id="S3.Ex9.m1.5.5" lspace="0em" rspace="0em" xref="S3.Ex9.m1.5.5.cmml">⋅</mo><mo id="S3.Ex9.m1.11.11.1.1.1.1.1.5" stretchy="false" xref="S3.Ex9.m1.11.11.1.1.1.1.2.cmml">]</mo></mrow><mo id="S3.Ex9.m1.11.11.1.1.1.2a" xref="S3.Ex9.m1.11.11.1.1.1.2.cmml">⁢</mo><msub id="S3.Ex9.m1.11.11.1.1.1.4" xref="S3.Ex9.m1.11.11.1.1.1.4.cmml"><mi id="S3.Ex9.m1.11.11.1.1.1.4.2" xref="S3.Ex9.m1.11.11.1.1.1.4.2.cmml">T</mi><mi id="S3.Ex9.m1.11.11.1.1.1.4.3" xref="S3.Ex9.m1.11.11.1.1.1.4.3.cmml">V</mi></msub><mo id="S3.Ex9.m1.11.11.1.1.1.2b" xref="S3.Ex9.m1.11.11.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.11.11.1.1.1.5.2" xref="S3.Ex9.m1.11.11.1.1.1.5.1.cmml"><mo id="S3.Ex9.m1.11.11.1.1.1.5.2.1" stretchy="false" xref="S3.Ex9.m1.11.11.1.1.1.5.1.cmml">[</mo><mi id="S3.Ex9.m1.6.6" xref="S3.Ex9.m1.6.6.cmml">r</mi><mo id="S3.Ex9.m1.11.11.1.1.1.5.2.2" rspace="0em" xref="S3.Ex9.m1.11.11.1.1.1.5.1.cmml">,</mo><mo id="S3.Ex9.m1.7.7" lspace="0em" rspace="0em" xref="S3.Ex9.m1.7.7.cmml">⋅</mo><mo id="S3.Ex9.m1.11.11.1.1.1.5.2.3" rspace="0em" xref="S3.Ex9.m1.11.11.1.1.1.5.1.cmml">,</mo><mo id="S3.Ex9.m1.8.8" lspace="0em" rspace="0em" xref="S3.Ex9.m1.8.8.cmml">⋅</mo><mo id="S3.Ex9.m1.11.11.1.1.1.5.2.4" stretchy="false" xref="S3.Ex9.m1.11.11.1.1.1.5.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex9.m1.11.11.1.1.5" xref="S3.Ex9.m1.11.11.1.1.5.cmml">=</mo><mrow id="S3.Ex9.m1.11.11.1.1.6" xref="S3.Ex9.m1.11.11.1.1.6.cmml"><mi id="S3.Ex9.m1.11.11.1.1.6.2" xref="S3.Ex9.m1.11.11.1.1.6.2.cmml">S</mi><mo id="S3.Ex9.m1.11.11.1.1.6.1" xref="S3.Ex9.m1.11.11.1.1.6.1.cmml">⁢</mo><mrow id="S3.Ex9.m1.11.11.1.1.6.3.2" xref="S3.Ex9.m1.11.11.1.1.6.3.1.cmml"><mo id="S3.Ex9.m1.11.11.1.1.6.3.2.1" stretchy="false" xref="S3.Ex9.m1.11.11.1.1.6.3.1.cmml">[</mo><mi id="S3.Ex9.m1.9.9" xref="S3.Ex9.m1.9.9.cmml">i</mi><mo id="S3.Ex9.m1.11.11.1.1.6.3.2.2" rspace="0em" xref="S3.Ex9.m1.11.11.1.1.6.3.1.cmml">,</mo><mo id="S3.Ex9.m1.10.10" lspace="0em" rspace="0em" xref="S3.Ex9.m1.10.10.cmml">⋅</mo><mo id="S3.Ex9.m1.11.11.1.1.6.3.2.3" stretchy="false" xref="S3.Ex9.m1.11.11.1.1.6.3.1.cmml">]</mo></mrow><mo id="S3.Ex9.m1.11.11.1.1.6.1a" xref="S3.Ex9.m1.11.11.1.1.6.1.cmml">⁢</mo><mi id="S3.Ex9.m1.11.11.1.1.6.4" xref="S3.Ex9.m1.11.11.1.1.6.4.cmml">V</mi></mrow></mrow><mo id="S3.Ex9.m1.11.11.1.2" xref="S3.Ex9.m1.11.11.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex9.m1.11b"><apply id="S3.Ex9.m1.11.11.1.1.cmml" xref="S3.Ex9.m1.11.11.1"><and id="S3.Ex9.m1.11.11.1.1a.cmml" xref="S3.Ex9.m1.11.11.1"></and><apply id="S3.Ex9.m1.11.11.1.1b.cmml" xref="S3.Ex9.m1.11.11.1"><eq id="S3.Ex9.m1.11.11.1.1.4.cmml" xref="S3.Ex9.m1.11.11.1.1.4"></eq><apply id="S3.Ex9.m1.11.11.1.1.3.cmml" xref="S3.Ex9.m1.11.11.1.1.3"><times id="S3.Ex9.m1.11.11.1.1.3.1.cmml" xref="S3.Ex9.m1.11.11.1.1.3.1"></times><apply id="S3.Ex9.m1.11.11.1.1.3.2.cmml" xref="S3.Ex9.m1.11.11.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex9.m1.11.11.1.1.3.2.1.cmml" xref="S3.Ex9.m1.11.11.1.1.3.2">subscript</csymbol><ci id="S3.Ex9.m1.11.11.1.1.3.2.2.cmml" xref="S3.Ex9.m1.11.11.1.1.3.2.2">𝑇</ci><apply id="S3.Ex9.m1.11.11.1.1.3.2.3.cmml" xref="S3.Ex9.m1.11.11.1.1.3.2.3"><times id="S3.Ex9.m1.11.11.1.1.3.2.3.1.cmml" xref="S3.Ex9.m1.11.11.1.1.3.2.3.1"></times><ci id="S3.Ex9.m1.11.11.1.1.3.2.3.2.cmml" xref="S3.Ex9.m1.11.11.1.1.3.2.3.2">𝐿</ci><ci id="S3.Ex9.m1.11.11.1.1.3.2.3.3.cmml" xref="S3.Ex9.m1.11.11.1.1.3.2.3.3">𝐴</ci><ci id="S3.Ex9.m1.11.11.1.1.3.2.3.4.cmml" xref="S3.Ex9.m1.11.11.1.1.3.2.3.4">𝑀</ci></apply></apply><list id="S3.Ex9.m1.11.11.1.1.3.3.1.cmml" xref="S3.Ex9.m1.11.11.1.1.3.3.2"><ci id="S3.Ex9.m1.1.1.cmml" xref="S3.Ex9.m1.1.1">𝑟</ci><ci id="S3.Ex9.m1.2.2.cmml" xref="S3.Ex9.m1.2.2">𝑖</ci><ci id="S3.Ex9.m1.3.3.cmml" xref="S3.Ex9.m1.3.3">⋅</ci></list></apply><apply id="S3.Ex9.m1.11.11.1.1.1.cmml" xref="S3.Ex9.m1.11.11.1.1.1"><times id="S3.Ex9.m1.11.11.1.1.1.2.cmml" xref="S3.Ex9.m1.11.11.1.1.1.2"></times><apply id="S3.Ex9.m1.11.11.1.1.1.3.cmml" xref="S3.Ex9.m1.11.11.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex9.m1.11.11.1.1.1.3.1.cmml" xref="S3.Ex9.m1.11.11.1.1.1.3">subscript</csymbol><ci id="S3.Ex9.m1.11.11.1.1.1.3.2.cmml" xref="S3.Ex9.m1.11.11.1.1.1.3.2">𝑇</ci><ci id="S3.Ex9.m1.11.11.1.1.1.3.3.cmml" xref="S3.Ex9.m1.11.11.1.1.1.3.3">𝑆</ci></apply><list id="S3.Ex9.m1.11.11.1.1.1.1.2.cmml" xref="S3.Ex9.m1.11.11.1.1.1.1.1"><ci id="S3.Ex9.m1.4.4.cmml" xref="S3.Ex9.m1.4.4">𝑟</ci><apply id="S3.Ex9.m1.11.11.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.11.11.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex9.m1.11.11.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.11.11.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex9.m1.11.11.1.1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.11.11.1.1.1.1.1.1.2">𝑖</ci><cn id="S3.Ex9.m1.11.11.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex9.m1.11.11.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.Ex9.m1.5.5.cmml" xref="S3.Ex9.m1.5.5">⋅</ci></list><apply id="S3.Ex9.m1.11.11.1.1.1.4.cmml" xref="S3.Ex9.m1.11.11.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex9.m1.11.11.1.1.1.4.1.cmml" xref="S3.Ex9.m1.11.11.1.1.1.4">subscript</csymbol><ci id="S3.Ex9.m1.11.11.1.1.1.4.2.cmml" xref="S3.Ex9.m1.11.11.1.1.1.4.2">𝑇</ci><ci id="S3.Ex9.m1.11.11.1.1.1.4.3.cmml" xref="S3.Ex9.m1.11.11.1.1.1.4.3">𝑉</ci></apply><list id="S3.Ex9.m1.11.11.1.1.1.5.1.cmml" xref="S3.Ex9.m1.11.11.1.1.1.5.2"><ci id="S3.Ex9.m1.6.6.cmml" xref="S3.Ex9.m1.6.6">𝑟</ci><ci id="S3.Ex9.m1.7.7.cmml" xref="S3.Ex9.m1.7.7">⋅</ci><ci id="S3.Ex9.m1.8.8.cmml" xref="S3.Ex9.m1.8.8">⋅</ci></list></apply></apply><apply id="S3.Ex9.m1.11.11.1.1c.cmml" xref="S3.Ex9.m1.11.11.1"><eq id="S3.Ex9.m1.11.11.1.1.5.cmml" xref="S3.Ex9.m1.11.11.1.1.5"></eq><share href="https://arxiv.org/html/2410.03805v1#S3.Ex9.m1.11.11.1.1.1.cmml" id="S3.Ex9.m1.11.11.1.1d.cmml" xref="S3.Ex9.m1.11.11.1"></share><apply id="S3.Ex9.m1.11.11.1.1.6.cmml" xref="S3.Ex9.m1.11.11.1.1.6"><times id="S3.Ex9.m1.11.11.1.1.6.1.cmml" xref="S3.Ex9.m1.11.11.1.1.6.1"></times><ci id="S3.Ex9.m1.11.11.1.1.6.2.cmml" xref="S3.Ex9.m1.11.11.1.1.6.2">𝑆</ci><interval closure="closed" id="S3.Ex9.m1.11.11.1.1.6.3.1.cmml" xref="S3.Ex9.m1.11.11.1.1.6.3.2"><ci id="S3.Ex9.m1.9.9.cmml" xref="S3.Ex9.m1.9.9">𝑖</ci><ci id="S3.Ex9.m1.10.10.cmml" xref="S3.Ex9.m1.10.10">⋅</ci></interval><ci id="S3.Ex9.m1.11.11.1.1.6.4.cmml" xref="S3.Ex9.m1.11.11.1.1.6.4">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex9.m1.11c">T_{LAM}[r,i,\cdot]=T_{S}[r,i_{1},\cdot]T_{V}[r,\cdot,\cdot]=S[i,\cdot]V,</annotation><annotation encoding="application/x-llamapun" id="S3.Ex9.m1.11d">italic_T start_POSTSUBSCRIPT italic_L italic_A italic_M end_POSTSUBSCRIPT [ italic_r , italic_i , ⋅ ] = italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋅ ] italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ italic_r , ⋅ , ⋅ ] = italic_S [ italic_i , ⋅ ] italic_V ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.4.p1.17">which equals <math alttext="LAM(Q,K,V)[i,\cdot]" class="ltx_Math" display="inline" id="S3.4.p1.17.m1.5"><semantics id="S3.4.p1.17.m1.5a"><mrow id="S3.4.p1.17.m1.5.6" xref="S3.4.p1.17.m1.5.6.cmml"><mi id="S3.4.p1.17.m1.5.6.2" xref="S3.4.p1.17.m1.5.6.2.cmml">L</mi><mo id="S3.4.p1.17.m1.5.6.1" xref="S3.4.p1.17.m1.5.6.1.cmml">⁢</mo><mi id="S3.4.p1.17.m1.5.6.3" xref="S3.4.p1.17.m1.5.6.3.cmml">A</mi><mo id="S3.4.p1.17.m1.5.6.1a" xref="S3.4.p1.17.m1.5.6.1.cmml">⁢</mo><mi id="S3.4.p1.17.m1.5.6.4" xref="S3.4.p1.17.m1.5.6.4.cmml">M</mi><mo id="S3.4.p1.17.m1.5.6.1b" xref="S3.4.p1.17.m1.5.6.1.cmml">⁢</mo><mrow id="S3.4.p1.17.m1.5.6.5.2" xref="S3.4.p1.17.m1.5.6.5.1.cmml"><mo id="S3.4.p1.17.m1.5.6.5.2.1" stretchy="false" xref="S3.4.p1.17.m1.5.6.5.1.cmml">(</mo><mi id="S3.4.p1.17.m1.1.1" xref="S3.4.p1.17.m1.1.1.cmml">Q</mi><mo id="S3.4.p1.17.m1.5.6.5.2.2" xref="S3.4.p1.17.m1.5.6.5.1.cmml">,</mo><mi id="S3.4.p1.17.m1.2.2" xref="S3.4.p1.17.m1.2.2.cmml">K</mi><mo id="S3.4.p1.17.m1.5.6.5.2.3" xref="S3.4.p1.17.m1.5.6.5.1.cmml">,</mo><mi id="S3.4.p1.17.m1.3.3" xref="S3.4.p1.17.m1.3.3.cmml">V</mi><mo id="S3.4.p1.17.m1.5.6.5.2.4" stretchy="false" xref="S3.4.p1.17.m1.5.6.5.1.cmml">)</mo></mrow><mo id="S3.4.p1.17.m1.5.6.1c" xref="S3.4.p1.17.m1.5.6.1.cmml">⁢</mo><mrow id="S3.4.p1.17.m1.5.6.6.2" xref="S3.4.p1.17.m1.5.6.6.1.cmml"><mo id="S3.4.p1.17.m1.5.6.6.2.1" stretchy="false" xref="S3.4.p1.17.m1.5.6.6.1.cmml">[</mo><mi id="S3.4.p1.17.m1.4.4" xref="S3.4.p1.17.m1.4.4.cmml">i</mi><mo id="S3.4.p1.17.m1.5.6.6.2.2" rspace="0em" xref="S3.4.p1.17.m1.5.6.6.1.cmml">,</mo><mo id="S3.4.p1.17.m1.5.5" lspace="0em" rspace="0em" xref="S3.4.p1.17.m1.5.5.cmml">⋅</mo><mo id="S3.4.p1.17.m1.5.6.6.2.3" stretchy="false" xref="S3.4.p1.17.m1.5.6.6.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.4.p1.17.m1.5b"><apply id="S3.4.p1.17.m1.5.6.cmml" xref="S3.4.p1.17.m1.5.6"><times id="S3.4.p1.17.m1.5.6.1.cmml" xref="S3.4.p1.17.m1.5.6.1"></times><ci id="S3.4.p1.17.m1.5.6.2.cmml" xref="S3.4.p1.17.m1.5.6.2">𝐿</ci><ci id="S3.4.p1.17.m1.5.6.3.cmml" xref="S3.4.p1.17.m1.5.6.3">𝐴</ci><ci id="S3.4.p1.17.m1.5.6.4.cmml" xref="S3.4.p1.17.m1.5.6.4">𝑀</ci><vector id="S3.4.p1.17.m1.5.6.5.1.cmml" xref="S3.4.p1.17.m1.5.6.5.2"><ci id="S3.4.p1.17.m1.1.1.cmml" xref="S3.4.p1.17.m1.1.1">𝑄</ci><ci id="S3.4.p1.17.m1.2.2.cmml" xref="S3.4.p1.17.m1.2.2">𝐾</ci><ci id="S3.4.p1.17.m1.3.3.cmml" xref="S3.4.p1.17.m1.3.3">𝑉</ci></vector><interval closure="closed" id="S3.4.p1.17.m1.5.6.6.1.cmml" xref="S3.4.p1.17.m1.5.6.6.2"><ci id="S3.4.p1.17.m1.4.4.cmml" xref="S3.4.p1.17.m1.4.4">𝑖</ci><ci id="S3.4.p1.17.m1.5.5.cmml" xref="S3.4.p1.17.m1.5.5">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.p1.17.m1.5c">LAM(Q,K,V)[i,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.4.p1.17.m1.5d">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V ) [ italic_i , ⋅ ]</annotation></semantics></math>, as we wanted to prove.
∎</p>
</div>
</div>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="394" id="S3.F4.sf1.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Visualisation of the product <math alttext="A\cdot V" class="ltx_Math" display="inline" id="S3.F4.sf1.4.m1.1"><semantics id="S3.F4.sf1.4.m1.1b"><mrow id="S3.F4.sf1.4.m1.1.1" xref="S3.F4.sf1.4.m1.1.1.cmml"><mi id="S3.F4.sf1.4.m1.1.1.2" xref="S3.F4.sf1.4.m1.1.1.2.cmml">A</mi><mo id="S3.F4.sf1.4.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.F4.sf1.4.m1.1.1.1.cmml">⋅</mo><mi id="S3.F4.sf1.4.m1.1.1.3" xref="S3.F4.sf1.4.m1.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.sf1.4.m1.1c"><apply id="S3.F4.sf1.4.m1.1.1.cmml" xref="S3.F4.sf1.4.m1.1.1"><ci id="S3.F4.sf1.4.m1.1.1.1.cmml" xref="S3.F4.sf1.4.m1.1.1.1">⋅</ci><ci id="S3.F4.sf1.4.m1.1.1.2.cmml" xref="S3.F4.sf1.4.m1.1.1.2">𝐴</ci><ci id="S3.F4.sf1.4.m1.1.1.3.cmml" xref="S3.F4.sf1.4.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.sf1.4.m1.1d">A\cdot V</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf1.4.m1.1e">italic_A ⋅ italic_V</annotation></semantics></math>. In green we have the attention scores computed in <math alttext="T_{S}" class="ltx_Math" display="inline" id="S3.F4.sf1.5.m2.1"><semantics id="S3.F4.sf1.5.m2.1b"><msub id="S3.F4.sf1.5.m2.1.1" xref="S3.F4.sf1.5.m2.1.1.cmml"><mi id="S3.F4.sf1.5.m2.1.1.2" xref="S3.F4.sf1.5.m2.1.1.2.cmml">T</mi><mi id="S3.F4.sf1.5.m2.1.1.3" xref="S3.F4.sf1.5.m2.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.sf1.5.m2.1c"><apply id="S3.F4.sf1.5.m2.1.1.cmml" xref="S3.F4.sf1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.F4.sf1.5.m2.1.1.1.cmml" xref="S3.F4.sf1.5.m2.1.1">subscript</csymbol><ci id="S3.F4.sf1.5.m2.1.1.2.cmml" xref="S3.F4.sf1.5.m2.1.1.2">𝑇</ci><ci id="S3.F4.sf1.5.m2.1.1.3.cmml" xref="S3.F4.sf1.5.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.sf1.5.m2.1d">T_{S}</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf1.5.m2.1e">italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>, which correspond to the non-zero attention scores of <math alttext="S" class="ltx_Math" display="inline" id="S3.F4.sf1.6.m3.1"><semantics id="S3.F4.sf1.6.m3.1b"><mi id="S3.F4.sf1.6.m3.1.1" xref="S3.F4.sf1.6.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.F4.sf1.6.m3.1c"><ci id="S3.F4.sf1.6.m3.1.1.cmml" xref="S3.F4.sf1.6.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.sf1.6.m3.1d">S</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf1.6.m3.1e">italic_S</annotation></semantics></math> (Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm4" title="Lemma 4. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4</span></a>).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="394" id="S3.F4.sf2.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>In light brown we have the block <math alttext="T_{V}[0,\cdot,\cdot]" class="ltx_Math" display="inline" id="S3.F4.sf2.6.m1.3"><semantics id="S3.F4.sf2.6.m1.3b"><mrow id="S3.F4.sf2.6.m1.3.4" xref="S3.F4.sf2.6.m1.3.4.cmml"><msub id="S3.F4.sf2.6.m1.3.4.2" xref="S3.F4.sf2.6.m1.3.4.2.cmml"><mi id="S3.F4.sf2.6.m1.3.4.2.2" xref="S3.F4.sf2.6.m1.3.4.2.2.cmml">T</mi><mi id="S3.F4.sf2.6.m1.3.4.2.3" xref="S3.F4.sf2.6.m1.3.4.2.3.cmml">V</mi></msub><mo id="S3.F4.sf2.6.m1.3.4.1" xref="S3.F4.sf2.6.m1.3.4.1.cmml">⁢</mo><mrow id="S3.F4.sf2.6.m1.3.4.3.2" xref="S3.F4.sf2.6.m1.3.4.3.1.cmml"><mo id="S3.F4.sf2.6.m1.3.4.3.2.1" stretchy="false" xref="S3.F4.sf2.6.m1.3.4.3.1.cmml">[</mo><mn id="S3.F4.sf2.6.m1.1.1" xref="S3.F4.sf2.6.m1.1.1.cmml">0</mn><mo id="S3.F4.sf2.6.m1.3.4.3.2.2" rspace="0em" xref="S3.F4.sf2.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F4.sf2.6.m1.2.2" lspace="0em" rspace="0em" xref="S3.F4.sf2.6.m1.2.2.cmml">⋅</mo><mo id="S3.F4.sf2.6.m1.3.4.3.2.3" rspace="0em" xref="S3.F4.sf2.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F4.sf2.6.m1.3.3" lspace="0em" rspace="0em" xref="S3.F4.sf2.6.m1.3.3.cmml">⋅</mo><mo id="S3.F4.sf2.6.m1.3.4.3.2.4" stretchy="false" xref="S3.F4.sf2.6.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.sf2.6.m1.3c"><apply id="S3.F4.sf2.6.m1.3.4.cmml" xref="S3.F4.sf2.6.m1.3.4"><times id="S3.F4.sf2.6.m1.3.4.1.cmml" xref="S3.F4.sf2.6.m1.3.4.1"></times><apply id="S3.F4.sf2.6.m1.3.4.2.cmml" xref="S3.F4.sf2.6.m1.3.4.2"><csymbol cd="ambiguous" id="S3.F4.sf2.6.m1.3.4.2.1.cmml" xref="S3.F4.sf2.6.m1.3.4.2">subscript</csymbol><ci id="S3.F4.sf2.6.m1.3.4.2.2.cmml" xref="S3.F4.sf2.6.m1.3.4.2.2">𝑇</ci><ci id="S3.F4.sf2.6.m1.3.4.2.3.cmml" xref="S3.F4.sf2.6.m1.3.4.2.3">𝑉</ci></apply><list id="S3.F4.sf2.6.m1.3.4.3.1.cmml" xref="S3.F4.sf2.6.m1.3.4.3.2"><cn id="S3.F4.sf2.6.m1.1.1.cmml" type="integer" xref="S3.F4.sf2.6.m1.1.1">0</cn><ci id="S3.F4.sf2.6.m1.2.2.cmml" xref="S3.F4.sf2.6.m1.2.2">⋅</ci><ci id="S3.F4.sf2.6.m1.3.3.cmml" xref="S3.F4.sf2.6.m1.3.3">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.sf2.6.m1.3d">T_{V}[0,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf2.6.m1.3e">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ 0 , ⋅ , ⋅ ]</annotation></semantics></math> and the block <math alttext="LAM(Q,K,V)[0:L,\cdot]" class="ltx_math_unparsed" display="inline" id="S3.F4.sf2.7.m2.3"><semantics id="S3.F4.sf2.7.m2.3b"><mrow id="S3.F4.sf2.7.m2.3c"><mi id="S3.F4.sf2.7.m2.3.4">L</mi><mi id="S3.F4.sf2.7.m2.3.5">A</mi><mi id="S3.F4.sf2.7.m2.3.6">M</mi><mrow id="S3.F4.sf2.7.m2.3.7"><mo id="S3.F4.sf2.7.m2.3.7.1" stretchy="false">(</mo><mi id="S3.F4.sf2.7.m2.1.1">Q</mi><mo id="S3.F4.sf2.7.m2.3.7.2">,</mo><mi id="S3.F4.sf2.7.m2.2.2">K</mi><mo id="S3.F4.sf2.7.m2.3.7.3">,</mo><mi id="S3.F4.sf2.7.m2.3.3">V</mi><mo id="S3.F4.sf2.7.m2.3.7.4" stretchy="false">)</mo></mrow><mrow id="S3.F4.sf2.7.m2.3.8"><mo id="S3.F4.sf2.7.m2.3.8.1" stretchy="false">[</mo><mn id="S3.F4.sf2.7.m2.3.8.2">0</mn><mo id="S3.F4.sf2.7.m2.3.8.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.F4.sf2.7.m2.3.8.4">L</mi><mo id="S3.F4.sf2.7.m2.3.8.5" rspace="0em">,</mo><mo id="S3.F4.sf2.7.m2.3.8.6" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf2.7.m2.3.8.7" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.F4.sf2.7.m2.3d">LAM(Q,K,V)[0:L,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf2.7.m2.3e">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V ) [ 0 : italic_L , ⋅ ]</annotation></semantics></math>. We note that <math alttext="LAM(Q,K,V)[0:L,\cdot]" class="ltx_math_unparsed" display="inline" id="S3.F4.sf2.8.m3.3"><semantics id="S3.F4.sf2.8.m3.3b"><mrow id="S3.F4.sf2.8.m3.3c"><mi id="S3.F4.sf2.8.m3.3.4">L</mi><mi id="S3.F4.sf2.8.m3.3.5">A</mi><mi id="S3.F4.sf2.8.m3.3.6">M</mi><mrow id="S3.F4.sf2.8.m3.3.7"><mo id="S3.F4.sf2.8.m3.3.7.1" stretchy="false">(</mo><mi id="S3.F4.sf2.8.m3.1.1">Q</mi><mo id="S3.F4.sf2.8.m3.3.7.2">,</mo><mi id="S3.F4.sf2.8.m3.2.2">K</mi><mo id="S3.F4.sf2.8.m3.3.7.3">,</mo><mi id="S3.F4.sf2.8.m3.3.3">V</mi><mo id="S3.F4.sf2.8.m3.3.7.4" stretchy="false">)</mo></mrow><mrow id="S3.F4.sf2.8.m3.3.8"><mo id="S3.F4.sf2.8.m3.3.8.1" stretchy="false">[</mo><mn id="S3.F4.sf2.8.m3.3.8.2">0</mn><mo id="S3.F4.sf2.8.m3.3.8.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.F4.sf2.8.m3.3.8.4">L</mi><mo id="S3.F4.sf2.8.m3.3.8.5" rspace="0em">,</mo><mo id="S3.F4.sf2.8.m3.3.8.6" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf2.8.m3.3.8.7" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.F4.sf2.8.m3.3d">LAM(Q,K,V)[0:L,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf2.8.m3.3e">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V ) [ 0 : italic_L , ⋅ ]</annotation></semantics></math> equals the product        <math alttext="A[0:L,0:L]T_{V}[0,\cdot,\cdot]" class="ltx_math_unparsed" display="inline" id="S3.F4.sf2.10.m5.1"><semantics id="S3.F4.sf2.10.m5.1b"><mrow id="S3.F4.sf2.10.m5.1c"><mi id="S3.F4.sf2.10.m5.1.1">A</mi><mrow id="S3.F4.sf2.10.m5.1.2"><mo id="S3.F4.sf2.10.m5.1.2.1" stretchy="false">[</mo><mn id="S3.F4.sf2.10.m5.1.2.2">0</mn><mo id="S3.F4.sf2.10.m5.1.2.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.F4.sf2.10.m5.1.2.4">L</mi><mo id="S3.F4.sf2.10.m5.1.2.5">,</mo><mn id="S3.F4.sf2.10.m5.1.2.6">0</mn><mo id="S3.F4.sf2.10.m5.1.2.7" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.F4.sf2.10.m5.1.2.8">L</mi><mo id="S3.F4.sf2.10.m5.1.2.9" stretchy="false">]</mo></mrow><msub id="S3.F4.sf2.10.m5.1.3"><mi id="S3.F4.sf2.10.m5.1.3.2">T</mi><mi id="S3.F4.sf2.10.m5.1.3.3">V</mi></msub><mrow id="S3.F4.sf2.10.m5.1.4"><mo id="S3.F4.sf2.10.m5.1.4.1" stretchy="false">[</mo><mn id="S3.F4.sf2.10.m5.1.4.2">0</mn><mo id="S3.F4.sf2.10.m5.1.4.3" rspace="0em">,</mo><mo id="S3.F4.sf2.10.m5.1.4.4" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf2.10.m5.1.4.5" rspace="0em">,</mo><mo id="S3.F4.sf2.10.m5.1.4.6" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf2.10.m5.1.4.7" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.F4.sf2.10.m5.1d">A[0:L,0:L]T_{V}[0,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf2.10.m5.1e">italic_A [ 0 : italic_L , 0 : italic_L ] italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ 0 , ⋅ , ⋅ ]</annotation></semantics></math>.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="394" id="S3.F4.sf3.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>In brown we have the block <math alttext="T_{V}[1,\cdot,\cdot]" class="ltx_Math" display="inline" id="S3.F4.sf3.6.m1.3"><semantics id="S3.F4.sf3.6.m1.3b"><mrow id="S3.F4.sf3.6.m1.3.4" xref="S3.F4.sf3.6.m1.3.4.cmml"><msub id="S3.F4.sf3.6.m1.3.4.2" xref="S3.F4.sf3.6.m1.3.4.2.cmml"><mi id="S3.F4.sf3.6.m1.3.4.2.2" xref="S3.F4.sf3.6.m1.3.4.2.2.cmml">T</mi><mi id="S3.F4.sf3.6.m1.3.4.2.3" xref="S3.F4.sf3.6.m1.3.4.2.3.cmml">V</mi></msub><mo id="S3.F4.sf3.6.m1.3.4.1" xref="S3.F4.sf3.6.m1.3.4.1.cmml">⁢</mo><mrow id="S3.F4.sf3.6.m1.3.4.3.2" xref="S3.F4.sf3.6.m1.3.4.3.1.cmml"><mo id="S3.F4.sf3.6.m1.3.4.3.2.1" stretchy="false" xref="S3.F4.sf3.6.m1.3.4.3.1.cmml">[</mo><mn id="S3.F4.sf3.6.m1.1.1" xref="S3.F4.sf3.6.m1.1.1.cmml">1</mn><mo id="S3.F4.sf3.6.m1.3.4.3.2.2" rspace="0em" xref="S3.F4.sf3.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F4.sf3.6.m1.2.2" lspace="0em" rspace="0em" xref="S3.F4.sf3.6.m1.2.2.cmml">⋅</mo><mo id="S3.F4.sf3.6.m1.3.4.3.2.3" rspace="0em" xref="S3.F4.sf3.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F4.sf3.6.m1.3.3" lspace="0em" rspace="0em" xref="S3.F4.sf3.6.m1.3.3.cmml">⋅</mo><mo id="S3.F4.sf3.6.m1.3.4.3.2.4" stretchy="false" xref="S3.F4.sf3.6.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.sf3.6.m1.3c"><apply id="S3.F4.sf3.6.m1.3.4.cmml" xref="S3.F4.sf3.6.m1.3.4"><times id="S3.F4.sf3.6.m1.3.4.1.cmml" xref="S3.F4.sf3.6.m1.3.4.1"></times><apply id="S3.F4.sf3.6.m1.3.4.2.cmml" xref="S3.F4.sf3.6.m1.3.4.2"><csymbol cd="ambiguous" id="S3.F4.sf3.6.m1.3.4.2.1.cmml" xref="S3.F4.sf3.6.m1.3.4.2">subscript</csymbol><ci id="S3.F4.sf3.6.m1.3.4.2.2.cmml" xref="S3.F4.sf3.6.m1.3.4.2.2">𝑇</ci><ci id="S3.F4.sf3.6.m1.3.4.2.3.cmml" xref="S3.F4.sf3.6.m1.3.4.2.3">𝑉</ci></apply><list id="S3.F4.sf3.6.m1.3.4.3.1.cmml" xref="S3.F4.sf3.6.m1.3.4.3.2"><cn id="S3.F4.sf3.6.m1.1.1.cmml" type="integer" xref="S3.F4.sf3.6.m1.1.1">1</cn><ci id="S3.F4.sf3.6.m1.2.2.cmml" xref="S3.F4.sf3.6.m1.2.2">⋅</ci><ci id="S3.F4.sf3.6.m1.3.3.cmml" xref="S3.F4.sf3.6.m1.3.3">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.sf3.6.m1.3d">T_{V}[1,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf3.6.m1.3e">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ 1 , ⋅ , ⋅ ]</annotation></semantics></math> and the block <math alttext="LAM(Q,K,V)[L:2L,\cdot]" class="ltx_math_unparsed" display="inline" id="S3.F4.sf3.7.m2.3"><semantics id="S3.F4.sf3.7.m2.3b"><mrow id="S3.F4.sf3.7.m2.3c"><mi id="S3.F4.sf3.7.m2.3.4">L</mi><mi id="S3.F4.sf3.7.m2.3.5">A</mi><mi id="S3.F4.sf3.7.m2.3.6">M</mi><mrow id="S3.F4.sf3.7.m2.3.7"><mo id="S3.F4.sf3.7.m2.3.7.1" stretchy="false">(</mo><mi id="S3.F4.sf3.7.m2.1.1">Q</mi><mo id="S3.F4.sf3.7.m2.3.7.2">,</mo><mi id="S3.F4.sf3.7.m2.2.2">K</mi><mo id="S3.F4.sf3.7.m2.3.7.3">,</mo><mi id="S3.F4.sf3.7.m2.3.3">V</mi><mo id="S3.F4.sf3.7.m2.3.7.4" stretchy="false">)</mo></mrow><mrow id="S3.F4.sf3.7.m2.3.8"><mo id="S3.F4.sf3.7.m2.3.8.1" stretchy="false">[</mo><mi id="S3.F4.sf3.7.m2.3.8.2">L</mi><mo id="S3.F4.sf3.7.m2.3.8.3" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.F4.sf3.7.m2.3.8.4">2</mn><mi id="S3.F4.sf3.7.m2.3.8.5">L</mi><mo id="S3.F4.sf3.7.m2.3.8.6" rspace="0em">,</mo><mo id="S3.F4.sf3.7.m2.3.8.7" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf3.7.m2.3.8.8" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.F4.sf3.7.m2.3d">LAM(Q,K,V)[L:2L,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf3.7.m2.3e">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V ) [ italic_L : 2 italic_L , ⋅ ]</annotation></semantics></math>. We note that <math alttext="LAM(Q,K,V)[L:2L,\cdot]" class="ltx_math_unparsed" display="inline" id="S3.F4.sf3.8.m3.3"><semantics id="S3.F4.sf3.8.m3.3b"><mrow id="S3.F4.sf3.8.m3.3c"><mi id="S3.F4.sf3.8.m3.3.4">L</mi><mi id="S3.F4.sf3.8.m3.3.5">A</mi><mi id="S3.F4.sf3.8.m3.3.6">M</mi><mrow id="S3.F4.sf3.8.m3.3.7"><mo id="S3.F4.sf3.8.m3.3.7.1" stretchy="false">(</mo><mi id="S3.F4.sf3.8.m3.1.1">Q</mi><mo id="S3.F4.sf3.8.m3.3.7.2">,</mo><mi id="S3.F4.sf3.8.m3.2.2">K</mi><mo id="S3.F4.sf3.8.m3.3.7.3">,</mo><mi id="S3.F4.sf3.8.m3.3.3">V</mi><mo id="S3.F4.sf3.8.m3.3.7.4" stretchy="false">)</mo></mrow><mrow id="S3.F4.sf3.8.m3.3.8"><mo id="S3.F4.sf3.8.m3.3.8.1" stretchy="false">[</mo><mi id="S3.F4.sf3.8.m3.3.8.2">L</mi><mo id="S3.F4.sf3.8.m3.3.8.3" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.F4.sf3.8.m3.3.8.4">2</mn><mi id="S3.F4.sf3.8.m3.3.8.5">L</mi><mo id="S3.F4.sf3.8.m3.3.8.6" rspace="0em">,</mo><mo id="S3.F4.sf3.8.m3.3.8.7" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf3.8.m3.3.8.8" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.F4.sf3.8.m3.3d">LAM(Q,K,V)[L:2L,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf3.8.m3.3e">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V ) [ italic_L : 2 italic_L , ⋅ ]</annotation></semantics></math> equals the product     <math alttext="A[L:2L,L-1:2L]T_{V}[1,\cdot,\cdot]" class="ltx_math_unparsed" display="inline" id="S3.F4.sf3.10.m5.1"><semantics id="S3.F4.sf3.10.m5.1b"><mrow id="S3.F4.sf3.10.m5.1c"><mi id="S3.F4.sf3.10.m5.1.1">A</mi><mrow id="S3.F4.sf3.10.m5.1.2"><mo id="S3.F4.sf3.10.m5.1.2.1" stretchy="false">[</mo><mi id="S3.F4.sf3.10.m5.1.2.2">L</mi><mo id="S3.F4.sf3.10.m5.1.2.3" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.F4.sf3.10.m5.1.2.4">2</mn><mi id="S3.F4.sf3.10.m5.1.2.5">L</mi><mo id="S3.F4.sf3.10.m5.1.2.6">,</mo><mi id="S3.F4.sf3.10.m5.1.2.7">L</mi><mo id="S3.F4.sf3.10.m5.1.2.8">−</mo><mn id="S3.F4.sf3.10.m5.1.2.9">1</mn><mo id="S3.F4.sf3.10.m5.1.2.10" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.F4.sf3.10.m5.1.2.11">2</mn><mi id="S3.F4.sf3.10.m5.1.2.12">L</mi><mo id="S3.F4.sf3.10.m5.1.2.13" stretchy="false">]</mo></mrow><msub id="S3.F4.sf3.10.m5.1.3"><mi id="S3.F4.sf3.10.m5.1.3.2">T</mi><mi id="S3.F4.sf3.10.m5.1.3.3">V</mi></msub><mrow id="S3.F4.sf3.10.m5.1.4"><mo id="S3.F4.sf3.10.m5.1.4.1" stretchy="false">[</mo><mn id="S3.F4.sf3.10.m5.1.4.2">1</mn><mo id="S3.F4.sf3.10.m5.1.4.3" rspace="0em">,</mo><mo id="S3.F4.sf3.10.m5.1.4.4" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf3.10.m5.1.4.5" rspace="0em">,</mo><mo id="S3.F4.sf3.10.m5.1.4.6" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf3.10.m5.1.4.7" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.F4.sf3.10.m5.1d">A[L:2L,L-1:2L]T_{V}[1,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf3.10.m5.1e">italic_A [ italic_L : 2 italic_L , italic_L - 1 : 2 italic_L ] italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ 1 , ⋅ , ⋅ ]</annotation></semantics></math>.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="394" id="S3.F4.sf4.g1" src="x10.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>In dark brown we have the blocks <math alttext="T_{V}[2,\cdot,\cdot]" class="ltx_Math" display="inline" id="S3.F4.sf4.6.m1.3"><semantics id="S3.F4.sf4.6.m1.3b"><mrow id="S3.F4.sf4.6.m1.3.4" xref="S3.F4.sf4.6.m1.3.4.cmml"><msub id="S3.F4.sf4.6.m1.3.4.2" xref="S3.F4.sf4.6.m1.3.4.2.cmml"><mi id="S3.F4.sf4.6.m1.3.4.2.2" xref="S3.F4.sf4.6.m1.3.4.2.2.cmml">T</mi><mi id="S3.F4.sf4.6.m1.3.4.2.3" xref="S3.F4.sf4.6.m1.3.4.2.3.cmml">V</mi></msub><mo id="S3.F4.sf4.6.m1.3.4.1" xref="S3.F4.sf4.6.m1.3.4.1.cmml">⁢</mo><mrow id="S3.F4.sf4.6.m1.3.4.3.2" xref="S3.F4.sf4.6.m1.3.4.3.1.cmml"><mo id="S3.F4.sf4.6.m1.3.4.3.2.1" stretchy="false" xref="S3.F4.sf4.6.m1.3.4.3.1.cmml">[</mo><mn id="S3.F4.sf4.6.m1.1.1" xref="S3.F4.sf4.6.m1.1.1.cmml">2</mn><mo id="S3.F4.sf4.6.m1.3.4.3.2.2" rspace="0em" xref="S3.F4.sf4.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F4.sf4.6.m1.2.2" lspace="0em" rspace="0em" xref="S3.F4.sf4.6.m1.2.2.cmml">⋅</mo><mo id="S3.F4.sf4.6.m1.3.4.3.2.3" rspace="0em" xref="S3.F4.sf4.6.m1.3.4.3.1.cmml">,</mo><mo id="S3.F4.sf4.6.m1.3.3" lspace="0em" rspace="0em" xref="S3.F4.sf4.6.m1.3.3.cmml">⋅</mo><mo id="S3.F4.sf4.6.m1.3.4.3.2.4" stretchy="false" xref="S3.F4.sf4.6.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.sf4.6.m1.3c"><apply id="S3.F4.sf4.6.m1.3.4.cmml" xref="S3.F4.sf4.6.m1.3.4"><times id="S3.F4.sf4.6.m1.3.4.1.cmml" xref="S3.F4.sf4.6.m1.3.4.1"></times><apply id="S3.F4.sf4.6.m1.3.4.2.cmml" xref="S3.F4.sf4.6.m1.3.4.2"><csymbol cd="ambiguous" id="S3.F4.sf4.6.m1.3.4.2.1.cmml" xref="S3.F4.sf4.6.m1.3.4.2">subscript</csymbol><ci id="S3.F4.sf4.6.m1.3.4.2.2.cmml" xref="S3.F4.sf4.6.m1.3.4.2.2">𝑇</ci><ci id="S3.F4.sf4.6.m1.3.4.2.3.cmml" xref="S3.F4.sf4.6.m1.3.4.2.3">𝑉</ci></apply><list id="S3.F4.sf4.6.m1.3.4.3.1.cmml" xref="S3.F4.sf4.6.m1.3.4.3.2"><cn id="S3.F4.sf4.6.m1.1.1.cmml" type="integer" xref="S3.F4.sf4.6.m1.1.1">2</cn><ci id="S3.F4.sf4.6.m1.2.2.cmml" xref="S3.F4.sf4.6.m1.2.2">⋅</ci><ci id="S3.F4.sf4.6.m1.3.3.cmml" xref="S3.F4.sf4.6.m1.3.3">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.sf4.6.m1.3d">T_{V}[2,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf4.6.m1.3e">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ 2 , ⋅ , ⋅ ]</annotation></semantics></math> and <math alttext="LAM(Q,K,V)[2L:3L,\cdot]" class="ltx_math_unparsed" display="inline" id="S3.F4.sf4.7.m2.3"><semantics id="S3.F4.sf4.7.m2.3b"><mrow id="S3.F4.sf4.7.m2.3c"><mi id="S3.F4.sf4.7.m2.3.4">L</mi><mi id="S3.F4.sf4.7.m2.3.5">A</mi><mi id="S3.F4.sf4.7.m2.3.6">M</mi><mrow id="S3.F4.sf4.7.m2.3.7"><mo id="S3.F4.sf4.7.m2.3.7.1" stretchy="false">(</mo><mi id="S3.F4.sf4.7.m2.1.1">Q</mi><mo id="S3.F4.sf4.7.m2.3.7.2">,</mo><mi id="S3.F4.sf4.7.m2.2.2">K</mi><mo id="S3.F4.sf4.7.m2.3.7.3">,</mo><mi id="S3.F4.sf4.7.m2.3.3">V</mi><mo id="S3.F4.sf4.7.m2.3.7.4" stretchy="false">)</mo></mrow><mrow id="S3.F4.sf4.7.m2.3.8"><mo id="S3.F4.sf4.7.m2.3.8.1" stretchy="false">[</mo><mn id="S3.F4.sf4.7.m2.3.8.2">2</mn><mi id="S3.F4.sf4.7.m2.3.8.3">L</mi><mo id="S3.F4.sf4.7.m2.3.8.4" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.F4.sf4.7.m2.3.8.5">3</mn><mi id="S3.F4.sf4.7.m2.3.8.6">L</mi><mo id="S3.F4.sf4.7.m2.3.8.7" rspace="0em">,</mo><mo id="S3.F4.sf4.7.m2.3.8.8" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf4.7.m2.3.8.9" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.F4.sf4.7.m2.3d">LAM(Q,K,V)[2L:3L,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf4.7.m2.3e">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V ) [ 2 italic_L : 3 italic_L , ⋅ ]</annotation></semantics></math>. We note <math alttext="LAM(Q,K,V)[2L:3L,\cdot]" class="ltx_math_unparsed" display="inline" id="S3.F4.sf4.8.m3.3"><semantics id="S3.F4.sf4.8.m3.3b"><mrow id="S3.F4.sf4.8.m3.3c"><mi id="S3.F4.sf4.8.m3.3.4">L</mi><mi id="S3.F4.sf4.8.m3.3.5">A</mi><mi id="S3.F4.sf4.8.m3.3.6">M</mi><mrow id="S3.F4.sf4.8.m3.3.7"><mo id="S3.F4.sf4.8.m3.3.7.1" stretchy="false">(</mo><mi id="S3.F4.sf4.8.m3.1.1">Q</mi><mo id="S3.F4.sf4.8.m3.3.7.2">,</mo><mi id="S3.F4.sf4.8.m3.2.2">K</mi><mo id="S3.F4.sf4.8.m3.3.7.3">,</mo><mi id="S3.F4.sf4.8.m3.3.3">V</mi><mo id="S3.F4.sf4.8.m3.3.7.4" stretchy="false">)</mo></mrow><mrow id="S3.F4.sf4.8.m3.3.8"><mo id="S3.F4.sf4.8.m3.3.8.1" stretchy="false">[</mo><mn id="S3.F4.sf4.8.m3.3.8.2">2</mn><mi id="S3.F4.sf4.8.m3.3.8.3">L</mi><mo id="S3.F4.sf4.8.m3.3.8.4" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.F4.sf4.8.m3.3.8.5">3</mn><mi id="S3.F4.sf4.8.m3.3.8.6">L</mi><mo id="S3.F4.sf4.8.m3.3.8.7" rspace="0em">,</mo><mo id="S3.F4.sf4.8.m3.3.8.8" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf4.8.m3.3.8.9" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.F4.sf4.8.m3.3d">LAM(Q,K,V)[2L:3L,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf4.8.m3.3e">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V ) [ 2 italic_L : 3 italic_L , ⋅ ]</annotation></semantics></math> equals the product     <math alttext="A[2L:3L,2L-1:3L]T_{V}[1,\cdot,\cdot]" class="ltx_math_unparsed" display="inline" id="S3.F4.sf4.10.m5.1"><semantics id="S3.F4.sf4.10.m5.1b"><mrow id="S3.F4.sf4.10.m5.1c"><mi id="S3.F4.sf4.10.m5.1.1">A</mi><mrow id="S3.F4.sf4.10.m5.1.2"><mo id="S3.F4.sf4.10.m5.1.2.1" stretchy="false">[</mo><mn id="S3.F4.sf4.10.m5.1.2.2">2</mn><mi id="S3.F4.sf4.10.m5.1.2.3">L</mi><mo id="S3.F4.sf4.10.m5.1.2.4" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.F4.sf4.10.m5.1.2.5">3</mn><mi id="S3.F4.sf4.10.m5.1.2.6">L</mi><mo id="S3.F4.sf4.10.m5.1.2.7">,</mo><mn id="S3.F4.sf4.10.m5.1.2.8">2</mn><mi id="S3.F4.sf4.10.m5.1.2.9">L</mi><mo id="S3.F4.sf4.10.m5.1.2.10">−</mo><mn id="S3.F4.sf4.10.m5.1.2.11">1</mn><mo id="S3.F4.sf4.10.m5.1.2.12" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.F4.sf4.10.m5.1.2.13">3</mn><mi id="S3.F4.sf4.10.m5.1.2.14">L</mi><mo id="S3.F4.sf4.10.m5.1.2.15" stretchy="false">]</mo></mrow><msub id="S3.F4.sf4.10.m5.1.3"><mi id="S3.F4.sf4.10.m5.1.3.2">T</mi><mi id="S3.F4.sf4.10.m5.1.3.3">V</mi></msub><mrow id="S3.F4.sf4.10.m5.1.4"><mo id="S3.F4.sf4.10.m5.1.4.1" stretchy="false">[</mo><mn id="S3.F4.sf4.10.m5.1.4.2">1</mn><mo id="S3.F4.sf4.10.m5.1.4.3" rspace="0em">,</mo><mo id="S3.F4.sf4.10.m5.1.4.4" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf4.10.m5.1.4.5" rspace="0em">,</mo><mo id="S3.F4.sf4.10.m5.1.4.6" lspace="0em" rspace="0em">⋅</mo><mo id="S3.F4.sf4.10.m5.1.4.7" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.F4.sf4.10.m5.1d">A[2L:3L,2L-1:3L]T_{V}[1,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.sf4.10.m5.1e">italic_A [ 2 italic_L : 3 italic_L , 2 italic_L - 1 : 3 italic_L ] italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ 1 , ⋅ , ⋅ ]</annotation></semantics></math>.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Example of our algorithm to compute the dot products of <math alttext="SV" class="ltx_Math" display="inline" id="S3.F4.8.m1.1"><semantics id="S3.F4.8.m1.1b"><mrow id="S3.F4.8.m1.1.1" xref="S3.F4.8.m1.1.1.cmml"><mi id="S3.F4.8.m1.1.1.2" xref="S3.F4.8.m1.1.1.2.cmml">S</mi><mo id="S3.F4.8.m1.1.1.1" xref="S3.F4.8.m1.1.1.1.cmml">⁢</mo><mi id="S3.F4.8.m1.1.1.3" xref="S3.F4.8.m1.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.8.m1.1c"><apply id="S3.F4.8.m1.1.1.cmml" xref="S3.F4.8.m1.1.1"><times id="S3.F4.8.m1.1.1.1.cmml" xref="S3.F4.8.m1.1.1.1"></times><ci id="S3.F4.8.m1.1.1.2.cmml" xref="S3.F4.8.m1.1.1.2">𝑆</ci><ci id="S3.F4.8.m1.1.1.3.cmml" xref="S3.F4.8.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.8.m1.1d">SV</annotation><annotation encoding="application/x-llamapun" id="S3.F4.8.m1.1e">italic_S italic_V</annotation></semantics></math> needed in LAM for <math alttext="n=6" class="ltx_Math" display="inline" id="S3.F4.9.m2.1"><semantics id="S3.F4.9.m2.1b"><mrow id="S3.F4.9.m2.1.1" xref="S3.F4.9.m2.1.1.cmml"><mi id="S3.F4.9.m2.1.1.2" xref="S3.F4.9.m2.1.1.2.cmml">n</mi><mo id="S3.F4.9.m2.1.1.1" xref="S3.F4.9.m2.1.1.1.cmml">=</mo><mn id="S3.F4.9.m2.1.1.3" xref="S3.F4.9.m2.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.9.m2.1c"><apply id="S3.F4.9.m2.1.1.cmml" xref="S3.F4.9.m2.1.1"><eq id="S3.F4.9.m2.1.1.1.cmml" xref="S3.F4.9.m2.1.1.1"></eq><ci id="S3.F4.9.m2.1.1.2.cmml" xref="S3.F4.9.m2.1.1.2">𝑛</ci><cn id="S3.F4.9.m2.1.1.3.cmml" type="integer" xref="S3.F4.9.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.9.m2.1d">n=6</annotation><annotation encoding="application/x-llamapun" id="S3.F4.9.m2.1e">italic_n = 6</annotation></semantics></math>, <math alttext="d_{model}=3" class="ltx_Math" display="inline" id="S3.F4.10.m3.1"><semantics id="S3.F4.10.m3.1b"><mrow id="S3.F4.10.m3.1.1" xref="S3.F4.10.m3.1.1.cmml"><msub id="S3.F4.10.m3.1.1.2" xref="S3.F4.10.m3.1.1.2.cmml"><mi id="S3.F4.10.m3.1.1.2.2" xref="S3.F4.10.m3.1.1.2.2.cmml">d</mi><mrow id="S3.F4.10.m3.1.1.2.3" xref="S3.F4.10.m3.1.1.2.3.cmml"><mi id="S3.F4.10.m3.1.1.2.3.2" xref="S3.F4.10.m3.1.1.2.3.2.cmml">m</mi><mo id="S3.F4.10.m3.1.1.2.3.1" xref="S3.F4.10.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F4.10.m3.1.1.2.3.3" xref="S3.F4.10.m3.1.1.2.3.3.cmml">o</mi><mo id="S3.F4.10.m3.1.1.2.3.1b" xref="S3.F4.10.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F4.10.m3.1.1.2.3.4" xref="S3.F4.10.m3.1.1.2.3.4.cmml">d</mi><mo id="S3.F4.10.m3.1.1.2.3.1c" xref="S3.F4.10.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F4.10.m3.1.1.2.3.5" xref="S3.F4.10.m3.1.1.2.3.5.cmml">e</mi><mo id="S3.F4.10.m3.1.1.2.3.1d" xref="S3.F4.10.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F4.10.m3.1.1.2.3.6" xref="S3.F4.10.m3.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S3.F4.10.m3.1.1.1" xref="S3.F4.10.m3.1.1.1.cmml">=</mo><mn id="S3.F4.10.m3.1.1.3" xref="S3.F4.10.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.10.m3.1c"><apply id="S3.F4.10.m3.1.1.cmml" xref="S3.F4.10.m3.1.1"><eq id="S3.F4.10.m3.1.1.1.cmml" xref="S3.F4.10.m3.1.1.1"></eq><apply id="S3.F4.10.m3.1.1.2.cmml" xref="S3.F4.10.m3.1.1.2"><csymbol cd="ambiguous" id="S3.F4.10.m3.1.1.2.1.cmml" xref="S3.F4.10.m3.1.1.2">subscript</csymbol><ci id="S3.F4.10.m3.1.1.2.2.cmml" xref="S3.F4.10.m3.1.1.2.2">𝑑</ci><apply id="S3.F4.10.m3.1.1.2.3.cmml" xref="S3.F4.10.m3.1.1.2.3"><times id="S3.F4.10.m3.1.1.2.3.1.cmml" xref="S3.F4.10.m3.1.1.2.3.1"></times><ci id="S3.F4.10.m3.1.1.2.3.2.cmml" xref="S3.F4.10.m3.1.1.2.3.2">𝑚</ci><ci id="S3.F4.10.m3.1.1.2.3.3.cmml" xref="S3.F4.10.m3.1.1.2.3.3">𝑜</ci><ci id="S3.F4.10.m3.1.1.2.3.4.cmml" xref="S3.F4.10.m3.1.1.2.3.4">𝑑</ci><ci id="S3.F4.10.m3.1.1.2.3.5.cmml" xref="S3.F4.10.m3.1.1.2.3.5">𝑒</ci><ci id="S3.F4.10.m3.1.1.2.3.6.cmml" xref="S3.F4.10.m3.1.1.2.3.6">𝑙</ci></apply></apply><cn id="S3.F4.10.m3.1.1.3.cmml" type="integer" xref="S3.F4.10.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.10.m3.1d">d_{model}=3</annotation><annotation encoding="application/x-llamapun" id="S3.F4.10.m3.1e">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT = 3</annotation></semantics></math> and <math alttext="L=2" class="ltx_Math" display="inline" id="S3.F4.11.m4.1"><semantics id="S3.F4.11.m4.1b"><mrow id="S3.F4.11.m4.1.1" xref="S3.F4.11.m4.1.1.cmml"><mi id="S3.F4.11.m4.1.1.2" xref="S3.F4.11.m4.1.1.2.cmml">L</mi><mo id="S3.F4.11.m4.1.1.1" xref="S3.F4.11.m4.1.1.1.cmml">=</mo><mn id="S3.F4.11.m4.1.1.3" xref="S3.F4.11.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.11.m4.1c"><apply id="S3.F4.11.m4.1.1.cmml" xref="S3.F4.11.m4.1.1"><eq id="S3.F4.11.m4.1.1.1.cmml" xref="S3.F4.11.m4.1.1.1"></eq><ci id="S3.F4.11.m4.1.1.2.cmml" xref="S3.F4.11.m4.1.1.2">𝐿</ci><cn id="S3.F4.11.m4.1.1.3.cmml" type="integer" xref="S3.F4.11.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.11.m4.1d">L=2</annotation><annotation encoding="application/x-llamapun" id="S3.F4.11.m4.1e">italic_L = 2</annotation></semantics></math>, where <math alttext="S=\operatorname{softmax}\left((QK^{T}+M)/\sqrt{d_{q}}\right)" class="ltx_Math" display="inline" id="S3.F4.12.m5.2"><semantics id="S3.F4.12.m5.2b"><mrow id="S3.F4.12.m5.2.2" xref="S3.F4.12.m5.2.2.cmml"><mi id="S3.F4.12.m5.2.2.3" xref="S3.F4.12.m5.2.2.3.cmml">S</mi><mo id="S3.F4.12.m5.2.2.2" xref="S3.F4.12.m5.2.2.2.cmml">=</mo><mrow id="S3.F4.12.m5.2.2.1.1" xref="S3.F4.12.m5.2.2.1.2.cmml"><mi id="S3.F4.12.m5.1.1" xref="S3.F4.12.m5.1.1.cmml">softmax</mi><mo id="S3.F4.12.m5.2.2.1.1b" xref="S3.F4.12.m5.2.2.1.2.cmml">⁡</mo><mrow id="S3.F4.12.m5.2.2.1.1.1" xref="S3.F4.12.m5.2.2.1.2.cmml"><mo id="S3.F4.12.m5.2.2.1.1.1.2" xref="S3.F4.12.m5.2.2.1.2.cmml">(</mo><mrow id="S3.F4.12.m5.2.2.1.1.1.1" xref="S3.F4.12.m5.2.2.1.1.1.1.cmml"><mrow id="S3.F4.12.m5.2.2.1.1.1.1.1.1" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.F4.12.m5.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.2" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.2.cmml">Q</mi><mo id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.1" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.2.cmml">K</mi><mi id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.1" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.3" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.3.cmml">M</mi></mrow><mo id="S3.F4.12.m5.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.F4.12.m5.2.2.1.1.1.1.2" xref="S3.F4.12.m5.2.2.1.1.1.1.2.cmml">/</mo><msqrt id="S3.F4.12.m5.2.2.1.1.1.1.3" xref="S3.F4.12.m5.2.2.1.1.1.1.3.cmml"><msub id="S3.F4.12.m5.2.2.1.1.1.1.3.2" xref="S3.F4.12.m5.2.2.1.1.1.1.3.2.cmml"><mi id="S3.F4.12.m5.2.2.1.1.1.1.3.2.2" xref="S3.F4.12.m5.2.2.1.1.1.1.3.2.2.cmml">d</mi><mi id="S3.F4.12.m5.2.2.1.1.1.1.3.2.3" xref="S3.F4.12.m5.2.2.1.1.1.1.3.2.3.cmml">q</mi></msub></msqrt></mrow><mo id="S3.F4.12.m5.2.2.1.1.1.3" xref="S3.F4.12.m5.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.12.m5.2c"><apply id="S3.F4.12.m5.2.2.cmml" xref="S3.F4.12.m5.2.2"><eq id="S3.F4.12.m5.2.2.2.cmml" xref="S3.F4.12.m5.2.2.2"></eq><ci id="S3.F4.12.m5.2.2.3.cmml" xref="S3.F4.12.m5.2.2.3">𝑆</ci><apply id="S3.F4.12.m5.2.2.1.2.cmml" xref="S3.F4.12.m5.2.2.1.1"><ci id="S3.F4.12.m5.1.1.cmml" xref="S3.F4.12.m5.1.1">softmax</ci><apply id="S3.F4.12.m5.2.2.1.1.1.1.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1"><divide id="S3.F4.12.m5.2.2.1.1.1.1.2.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.2"></divide><apply id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1"><plus id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.1"></plus><apply id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2"><times id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.1"></times><ci id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.2">𝑄</ci><apply id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.2">𝐾</ci><ci id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.F4.12.m5.2.2.1.1.1.1.3.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.3"><root id="S3.F4.12.m5.2.2.1.1.1.1.3a.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.3"></root><apply id="S3.F4.12.m5.2.2.1.1.1.1.3.2.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.F4.12.m5.2.2.1.1.1.1.3.2.1.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.F4.12.m5.2.2.1.1.1.1.3.2.2.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.3.2.2">𝑑</ci><ci id="S3.F4.12.m5.2.2.1.1.1.1.3.2.3.cmml" xref="S3.F4.12.m5.2.2.1.1.1.1.3.2.3">𝑞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.12.m5.2d">S=\operatorname{softmax}\left((QK^{T}+M)/\sqrt{d_{q}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.F4.12.m5.2e">italic_S = roman_softmax ( ( italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_M ) / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math>. We note that <math alttext="s=n/L=3" class="ltx_Math" display="inline" id="S3.F4.13.m6.1"><semantics id="S3.F4.13.m6.1b"><mrow id="S3.F4.13.m6.1.1" xref="S3.F4.13.m6.1.1.cmml"><mi id="S3.F4.13.m6.1.1.2" xref="S3.F4.13.m6.1.1.2.cmml">s</mi><mo id="S3.F4.13.m6.1.1.3" xref="S3.F4.13.m6.1.1.3.cmml">=</mo><mrow id="S3.F4.13.m6.1.1.4" xref="S3.F4.13.m6.1.1.4.cmml"><mi id="S3.F4.13.m6.1.1.4.2" xref="S3.F4.13.m6.1.1.4.2.cmml">n</mi><mo id="S3.F4.13.m6.1.1.4.1" xref="S3.F4.13.m6.1.1.4.1.cmml">/</mo><mi id="S3.F4.13.m6.1.1.4.3" xref="S3.F4.13.m6.1.1.4.3.cmml">L</mi></mrow><mo id="S3.F4.13.m6.1.1.5" xref="S3.F4.13.m6.1.1.5.cmml">=</mo><mn id="S3.F4.13.m6.1.1.6" xref="S3.F4.13.m6.1.1.6.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.13.m6.1c"><apply id="S3.F4.13.m6.1.1.cmml" xref="S3.F4.13.m6.1.1"><and id="S3.F4.13.m6.1.1a.cmml" xref="S3.F4.13.m6.1.1"></and><apply id="S3.F4.13.m6.1.1b.cmml" xref="S3.F4.13.m6.1.1"><eq id="S3.F4.13.m6.1.1.3.cmml" xref="S3.F4.13.m6.1.1.3"></eq><ci id="S3.F4.13.m6.1.1.2.cmml" xref="S3.F4.13.m6.1.1.2">𝑠</ci><apply id="S3.F4.13.m6.1.1.4.cmml" xref="S3.F4.13.m6.1.1.4"><divide id="S3.F4.13.m6.1.1.4.1.cmml" xref="S3.F4.13.m6.1.1.4.1"></divide><ci id="S3.F4.13.m6.1.1.4.2.cmml" xref="S3.F4.13.m6.1.1.4.2">𝑛</ci><ci id="S3.F4.13.m6.1.1.4.3.cmml" xref="S3.F4.13.m6.1.1.4.3">𝐿</ci></apply></apply><apply id="S3.F4.13.m6.1.1c.cmml" xref="S3.F4.13.m6.1.1"><eq id="S3.F4.13.m6.1.1.5.cmml" xref="S3.F4.13.m6.1.1.5"></eq><share href="https://arxiv.org/html/2410.03805v1#S3.F4.13.m6.1.1.4.cmml" id="S3.F4.13.m6.1.1d.cmml" xref="S3.F4.13.m6.1.1"></share><cn id="S3.F4.13.m6.1.1.6.cmml" type="integer" xref="S3.F4.13.m6.1.1.6">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.13.m6.1d">s=n/L=3</annotation><annotation encoding="application/x-llamapun" id="S3.F4.13.m6.1e">italic_s = italic_n / italic_L = 3</annotation></semantics></math>. The values tensor is divided <math alttext="s" class="ltx_Math" display="inline" id="S3.F4.14.m7.1"><semantics id="S3.F4.14.m7.1b"><mi id="S3.F4.14.m7.1.1" xref="S3.F4.14.m7.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.F4.14.m7.1c"><ci id="S3.F4.14.m7.1.1.cmml" xref="S3.F4.14.m7.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.14.m7.1d">s</annotation><annotation encoding="application/x-llamapun" id="S3.F4.14.m7.1e">italic_s</annotation></semantics></math> in blocks, with a different shadow of brown, in Subfigures (b), (c), (d).</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p15">
<p class="ltx_p" id="S3.p15.1">Our algorithm to compute <math alttext="LAM(Q,K,V)" class="ltx_Math" display="inline" id="S3.p15.1.m1.3"><semantics id="S3.p15.1.m1.3a"><mrow id="S3.p15.1.m1.3.4" xref="S3.p15.1.m1.3.4.cmml"><mi id="S3.p15.1.m1.3.4.2" xref="S3.p15.1.m1.3.4.2.cmml">L</mi><mo id="S3.p15.1.m1.3.4.1" xref="S3.p15.1.m1.3.4.1.cmml">⁢</mo><mi id="S3.p15.1.m1.3.4.3" xref="S3.p15.1.m1.3.4.3.cmml">A</mi><mo id="S3.p15.1.m1.3.4.1a" xref="S3.p15.1.m1.3.4.1.cmml">⁢</mo><mi id="S3.p15.1.m1.3.4.4" xref="S3.p15.1.m1.3.4.4.cmml">M</mi><mo id="S3.p15.1.m1.3.4.1b" xref="S3.p15.1.m1.3.4.1.cmml">⁢</mo><mrow id="S3.p15.1.m1.3.4.5.2" xref="S3.p15.1.m1.3.4.5.1.cmml"><mo id="S3.p15.1.m1.3.4.5.2.1" stretchy="false" xref="S3.p15.1.m1.3.4.5.1.cmml">(</mo><mi id="S3.p15.1.m1.1.1" xref="S3.p15.1.m1.1.1.cmml">Q</mi><mo id="S3.p15.1.m1.3.4.5.2.2" xref="S3.p15.1.m1.3.4.5.1.cmml">,</mo><mi id="S3.p15.1.m1.2.2" xref="S3.p15.1.m1.2.2.cmml">K</mi><mo id="S3.p15.1.m1.3.4.5.2.3" xref="S3.p15.1.m1.3.4.5.1.cmml">,</mo><mi id="S3.p15.1.m1.3.3" xref="S3.p15.1.m1.3.3.cmml">V</mi><mo id="S3.p15.1.m1.3.4.5.2.4" stretchy="false" xref="S3.p15.1.m1.3.4.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p15.1.m1.3b"><apply id="S3.p15.1.m1.3.4.cmml" xref="S3.p15.1.m1.3.4"><times id="S3.p15.1.m1.3.4.1.cmml" xref="S3.p15.1.m1.3.4.1"></times><ci id="S3.p15.1.m1.3.4.2.cmml" xref="S3.p15.1.m1.3.4.2">𝐿</ci><ci id="S3.p15.1.m1.3.4.3.cmml" xref="S3.p15.1.m1.3.4.3">𝐴</ci><ci id="S3.p15.1.m1.3.4.4.cmml" xref="S3.p15.1.m1.3.4.4">𝑀</ci><vector id="S3.p15.1.m1.3.4.5.1.cmml" xref="S3.p15.1.m1.3.4.5.2"><ci id="S3.p15.1.m1.1.1.cmml" xref="S3.p15.1.m1.1.1">𝑄</ci><ci id="S3.p15.1.m1.2.2.cmml" xref="S3.p15.1.m1.2.2">𝐾</ci><ci id="S3.p15.1.m1.3.3.cmml" xref="S3.p15.1.m1.3.3">𝑉</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p15.1.m1.3c">LAM(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="S3.p15.1.m1.3d">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V )</annotation></semantics></math> can now be inferred from Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm5" title="Lemma 5. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">5</span></a> and is explicitly given in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#alg1" title="Algorithm 1 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<div class="ltx_listing ltx_listing" id="alg1.2">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline">0:</span>  The query and key matrices <math alttext="Q" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">italic_Q</annotation></semantics></math> and <math alttext="K" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">italic_K</annotation></semantics></math>, and the value matrix <math alttext="V" class="ltx_Math" display="inline" id="alg1.l0.m3.1"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.1d">italic_V</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l0a">
<span class="ltx_tag ltx_tag_listingline">0:</span>  <math alttext="Q" class="ltx_Math" display="inline" id="alg1.l0a.m1.1"><semantics id="alg1.l0a.m1.1a"><mi id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><ci id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m1.1d">italic_Q</annotation></semantics></math> and <math alttext="K" class="ltx_Math" display="inline" id="alg1.l0a.m2.1"><semantics id="alg1.l0a.m2.1a"><mi id="alg1.l0a.m2.1.1" xref="alg1.l0a.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m2.1b"><ci id="alg1.l0a.m2.1.1.cmml" xref="alg1.l0a.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m2.1d">italic_K</annotation></semantics></math> have dimensions <math alttext="n\times d_{q}" class="ltx_Math" display="inline" id="alg1.l0a.m3.1"><semantics id="alg1.l0a.m3.1a"><mrow id="alg1.l0a.m3.1.1" xref="alg1.l0a.m3.1.1.cmml"><mi id="alg1.l0a.m3.1.1.2" xref="alg1.l0a.m3.1.1.2.cmml">n</mi><mo id="alg1.l0a.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="alg1.l0a.m3.1.1.1.cmml">×</mo><msub id="alg1.l0a.m3.1.1.3" xref="alg1.l0a.m3.1.1.3.cmml"><mi id="alg1.l0a.m3.1.1.3.2" xref="alg1.l0a.m3.1.1.3.2.cmml">d</mi><mi id="alg1.l0a.m3.1.1.3.3" xref="alg1.l0a.m3.1.1.3.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m3.1b"><apply id="alg1.l0a.m3.1.1.cmml" xref="alg1.l0a.m3.1.1"><times id="alg1.l0a.m3.1.1.1.cmml" xref="alg1.l0a.m3.1.1.1"></times><ci id="alg1.l0a.m3.1.1.2.cmml" xref="alg1.l0a.m3.1.1.2">𝑛</ci><apply id="alg1.l0a.m3.1.1.3.cmml" xref="alg1.l0a.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l0a.m3.1.1.3.1.cmml" xref="alg1.l0a.m3.1.1.3">subscript</csymbol><ci id="alg1.l0a.m3.1.1.3.2.cmml" xref="alg1.l0a.m3.1.1.3.2">𝑑</ci><ci id="alg1.l0a.m3.1.1.3.3.cmml" xref="alg1.l0a.m3.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m3.1c">n\times d_{q}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m3.1d">italic_n × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="alg1.l0a.m4.1"><semantics id="alg1.l0a.m4.1a"><mi id="alg1.l0a.m4.1.1" xref="alg1.l0a.m4.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m4.1b"><ci id="alg1.l0a.m4.1.1.cmml" xref="alg1.l0a.m4.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m4.1c">V</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m4.1d">italic_V</annotation></semantics></math> has dimensions <math alttext="n\times d_{v}" class="ltx_Math" display="inline" id="alg1.l0a.m5.1"><semantics id="alg1.l0a.m5.1a"><mrow id="alg1.l0a.m5.1.1" xref="alg1.l0a.m5.1.1.cmml"><mi id="alg1.l0a.m5.1.1.2" xref="alg1.l0a.m5.1.1.2.cmml">n</mi><mo id="alg1.l0a.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="alg1.l0a.m5.1.1.1.cmml">×</mo><msub id="alg1.l0a.m5.1.1.3" xref="alg1.l0a.m5.1.1.3.cmml"><mi id="alg1.l0a.m5.1.1.3.2" xref="alg1.l0a.m5.1.1.3.2.cmml">d</mi><mi id="alg1.l0a.m5.1.1.3.3" xref="alg1.l0a.m5.1.1.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m5.1b"><apply id="alg1.l0a.m5.1.1.cmml" xref="alg1.l0a.m5.1.1"><times id="alg1.l0a.m5.1.1.1.cmml" xref="alg1.l0a.m5.1.1.1"></times><ci id="alg1.l0a.m5.1.1.2.cmml" xref="alg1.l0a.m5.1.1.2">𝑛</ci><apply id="alg1.l0a.m5.1.1.3.cmml" xref="alg1.l0a.m5.1.1.3"><csymbol cd="ambiguous" id="alg1.l0a.m5.1.1.3.1.cmml" xref="alg1.l0a.m5.1.1.3">subscript</csymbol><ci id="alg1.l0a.m5.1.1.3.2.cmml" xref="alg1.l0a.m5.1.1.3.2">𝑑</ci><ci id="alg1.l0a.m5.1.1.3.3.cmml" xref="alg1.l0a.m5.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m5.1c">n\times d_{v}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m5.1d">italic_n × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>. Let <math alttext="s=n/L" class="ltx_Math" display="inline" id="alg1.l0a.m6.1"><semantics id="alg1.l0a.m6.1a"><mrow id="alg1.l0a.m6.1.1" xref="alg1.l0a.m6.1.1.cmml"><mi id="alg1.l0a.m6.1.1.2" xref="alg1.l0a.m6.1.1.2.cmml">s</mi><mo id="alg1.l0a.m6.1.1.1" xref="alg1.l0a.m6.1.1.1.cmml">=</mo><mrow id="alg1.l0a.m6.1.1.3" xref="alg1.l0a.m6.1.1.3.cmml"><mi id="alg1.l0a.m6.1.1.3.2" xref="alg1.l0a.m6.1.1.3.2.cmml">n</mi><mo id="alg1.l0a.m6.1.1.3.1" xref="alg1.l0a.m6.1.1.3.1.cmml">/</mo><mi id="alg1.l0a.m6.1.1.3.3" xref="alg1.l0a.m6.1.1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m6.1b"><apply id="alg1.l0a.m6.1.1.cmml" xref="alg1.l0a.m6.1.1"><eq id="alg1.l0a.m6.1.1.1.cmml" xref="alg1.l0a.m6.1.1.1"></eq><ci id="alg1.l0a.m6.1.1.2.cmml" xref="alg1.l0a.m6.1.1.2">𝑠</ci><apply id="alg1.l0a.m6.1.1.3.cmml" xref="alg1.l0a.m6.1.1.3"><divide id="alg1.l0a.m6.1.1.3.1.cmml" xref="alg1.l0a.m6.1.1.3.1"></divide><ci id="alg1.l0a.m6.1.1.3.2.cmml" xref="alg1.l0a.m6.1.1.3.2">𝑛</ci><ci id="alg1.l0a.m6.1.1.3.3.cmml" xref="alg1.l0a.m6.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m6.1c">s=n/L</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m6.1d">italic_s = italic_n / italic_L</annotation></semantics></math>. Let <math alttext="T_{M}" class="ltx_Math" display="inline" id="alg1.l0a.m7.1"><semantics id="alg1.l0a.m7.1a"><msub id="alg1.l0a.m7.1.1" xref="alg1.l0a.m7.1.1.cmml"><mi id="alg1.l0a.m7.1.1.2" xref="alg1.l0a.m7.1.1.2.cmml">T</mi><mi id="alg1.l0a.m7.1.1.3" xref="alg1.l0a.m7.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0a.m7.1b"><apply id="alg1.l0a.m7.1.1.cmml" xref="alg1.l0a.m7.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m7.1.1.1.cmml" xref="alg1.l0a.m7.1.1">subscript</csymbol><ci id="alg1.l0a.m7.1.1.2.cmml" xref="alg1.l0a.m7.1.1.2">𝑇</ci><ci id="alg1.l0a.m7.1.1.3.cmml" xref="alg1.l0a.m7.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m7.1c">T_{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m7.1d">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> be the tensor with dimensions <math alttext="s\times L\times(2L-1)" class="ltx_Math" display="inline" id="alg1.l0a.m8.1"><semantics id="alg1.l0a.m8.1a"><mrow id="alg1.l0a.m8.1.1" xref="alg1.l0a.m8.1.1.cmml"><mi id="alg1.l0a.m8.1.1.3" xref="alg1.l0a.m8.1.1.3.cmml">s</mi><mo id="alg1.l0a.m8.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg1.l0a.m8.1.1.2.cmml">×</mo><mi id="alg1.l0a.m8.1.1.4" xref="alg1.l0a.m8.1.1.4.cmml">L</mi><mo id="alg1.l0a.m8.1.1.2a" lspace="0.222em" rspace="0.222em" xref="alg1.l0a.m8.1.1.2.cmml">×</mo><mrow id="alg1.l0a.m8.1.1.1.1" xref="alg1.l0a.m8.1.1.1.1.1.cmml"><mo id="alg1.l0a.m8.1.1.1.1.2" stretchy="false" xref="alg1.l0a.m8.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l0a.m8.1.1.1.1.1" xref="alg1.l0a.m8.1.1.1.1.1.cmml"><mrow id="alg1.l0a.m8.1.1.1.1.1.2" xref="alg1.l0a.m8.1.1.1.1.1.2.cmml"><mn id="alg1.l0a.m8.1.1.1.1.1.2.2" xref="alg1.l0a.m8.1.1.1.1.1.2.2.cmml">2</mn><mo id="alg1.l0a.m8.1.1.1.1.1.2.1" xref="alg1.l0a.m8.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l0a.m8.1.1.1.1.1.2.3" xref="alg1.l0a.m8.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="alg1.l0a.m8.1.1.1.1.1.1" xref="alg1.l0a.m8.1.1.1.1.1.1.cmml">−</mo><mn id="alg1.l0a.m8.1.1.1.1.1.3" xref="alg1.l0a.m8.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l0a.m8.1.1.1.1.3" stretchy="false" xref="alg1.l0a.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m8.1b"><apply id="alg1.l0a.m8.1.1.cmml" xref="alg1.l0a.m8.1.1"><times id="alg1.l0a.m8.1.1.2.cmml" xref="alg1.l0a.m8.1.1.2"></times><ci id="alg1.l0a.m8.1.1.3.cmml" xref="alg1.l0a.m8.1.1.3">𝑠</ci><ci id="alg1.l0a.m8.1.1.4.cmml" xref="alg1.l0a.m8.1.1.4">𝐿</ci><apply id="alg1.l0a.m8.1.1.1.1.1.cmml" xref="alg1.l0a.m8.1.1.1.1"><minus id="alg1.l0a.m8.1.1.1.1.1.1.cmml" xref="alg1.l0a.m8.1.1.1.1.1.1"></minus><apply id="alg1.l0a.m8.1.1.1.1.1.2.cmml" xref="alg1.l0a.m8.1.1.1.1.1.2"><times id="alg1.l0a.m8.1.1.1.1.1.2.1.cmml" xref="alg1.l0a.m8.1.1.1.1.1.2.1"></times><cn id="alg1.l0a.m8.1.1.1.1.1.2.2.cmml" type="integer" xref="alg1.l0a.m8.1.1.1.1.1.2.2">2</cn><ci id="alg1.l0a.m8.1.1.1.1.1.2.3.cmml" xref="alg1.l0a.m8.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="alg1.l0a.m8.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l0a.m8.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m8.1c">s\times L\times(2L-1)</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m8.1d">italic_s × italic_L × ( 2 italic_L - 1 )</annotation></semantics></math> such that <math alttext="T_{M}[r,i_{1},j_{1}]=0" class="ltx_Math" display="inline" id="alg1.l0a.m9.3"><semantics id="alg1.l0a.m9.3a"><mrow id="alg1.l0a.m9.3.3" xref="alg1.l0a.m9.3.3.cmml"><mrow id="alg1.l0a.m9.3.3.2" xref="alg1.l0a.m9.3.3.2.cmml"><msub id="alg1.l0a.m9.3.3.2.4" xref="alg1.l0a.m9.3.3.2.4.cmml"><mi id="alg1.l0a.m9.3.3.2.4.2" xref="alg1.l0a.m9.3.3.2.4.2.cmml">T</mi><mi id="alg1.l0a.m9.3.3.2.4.3" xref="alg1.l0a.m9.3.3.2.4.3.cmml">M</mi></msub><mo id="alg1.l0a.m9.3.3.2.3" xref="alg1.l0a.m9.3.3.2.3.cmml">⁢</mo><mrow id="alg1.l0a.m9.3.3.2.2.2" xref="alg1.l0a.m9.3.3.2.2.3.cmml"><mo id="alg1.l0a.m9.3.3.2.2.2.3" stretchy="false" xref="alg1.l0a.m9.3.3.2.2.3.cmml">[</mo><mi id="alg1.l0a.m9.1.1" xref="alg1.l0a.m9.1.1.cmml">r</mi><mo id="alg1.l0a.m9.3.3.2.2.2.4" xref="alg1.l0a.m9.3.3.2.2.3.cmml">,</mo><msub id="alg1.l0a.m9.2.2.1.1.1.1" xref="alg1.l0a.m9.2.2.1.1.1.1.cmml"><mi id="alg1.l0a.m9.2.2.1.1.1.1.2" xref="alg1.l0a.m9.2.2.1.1.1.1.2.cmml">i</mi><mn id="alg1.l0a.m9.2.2.1.1.1.1.3" xref="alg1.l0a.m9.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l0a.m9.3.3.2.2.2.5" xref="alg1.l0a.m9.3.3.2.2.3.cmml">,</mo><msub id="alg1.l0a.m9.3.3.2.2.2.2" xref="alg1.l0a.m9.3.3.2.2.2.2.cmml"><mi id="alg1.l0a.m9.3.3.2.2.2.2.2" xref="alg1.l0a.m9.3.3.2.2.2.2.2.cmml">j</mi><mn id="alg1.l0a.m9.3.3.2.2.2.2.3" xref="alg1.l0a.m9.3.3.2.2.2.2.3.cmml">1</mn></msub><mo id="alg1.l0a.m9.3.3.2.2.2.6" stretchy="false" xref="alg1.l0a.m9.3.3.2.2.3.cmml">]</mo></mrow></mrow><mo id="alg1.l0a.m9.3.3.3" xref="alg1.l0a.m9.3.3.3.cmml">=</mo><mn id="alg1.l0a.m9.3.3.4" xref="alg1.l0a.m9.3.3.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m9.3b"><apply id="alg1.l0a.m9.3.3.cmml" xref="alg1.l0a.m9.3.3"><eq id="alg1.l0a.m9.3.3.3.cmml" xref="alg1.l0a.m9.3.3.3"></eq><apply id="alg1.l0a.m9.3.3.2.cmml" xref="alg1.l0a.m9.3.3.2"><times id="alg1.l0a.m9.3.3.2.3.cmml" xref="alg1.l0a.m9.3.3.2.3"></times><apply id="alg1.l0a.m9.3.3.2.4.cmml" xref="alg1.l0a.m9.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l0a.m9.3.3.2.4.1.cmml" xref="alg1.l0a.m9.3.3.2.4">subscript</csymbol><ci id="alg1.l0a.m9.3.3.2.4.2.cmml" xref="alg1.l0a.m9.3.3.2.4.2">𝑇</ci><ci id="alg1.l0a.m9.3.3.2.4.3.cmml" xref="alg1.l0a.m9.3.3.2.4.3">𝑀</ci></apply><list id="alg1.l0a.m9.3.3.2.2.3.cmml" xref="alg1.l0a.m9.3.3.2.2.2"><ci id="alg1.l0a.m9.1.1.cmml" xref="alg1.l0a.m9.1.1">𝑟</ci><apply id="alg1.l0a.m9.2.2.1.1.1.1.cmml" xref="alg1.l0a.m9.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m9.2.2.1.1.1.1.1.cmml" xref="alg1.l0a.m9.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l0a.m9.2.2.1.1.1.1.2.cmml" xref="alg1.l0a.m9.2.2.1.1.1.1.2">𝑖</ci><cn id="alg1.l0a.m9.2.2.1.1.1.1.3.cmml" type="integer" xref="alg1.l0a.m9.2.2.1.1.1.1.3">1</cn></apply><apply id="alg1.l0a.m9.3.3.2.2.2.2.cmml" xref="alg1.l0a.m9.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l0a.m9.3.3.2.2.2.2.1.cmml" xref="alg1.l0a.m9.3.3.2.2.2.2">subscript</csymbol><ci id="alg1.l0a.m9.3.3.2.2.2.2.2.cmml" xref="alg1.l0a.m9.3.3.2.2.2.2.2">𝑗</ci><cn id="alg1.l0a.m9.3.3.2.2.2.2.3.cmml" type="integer" xref="alg1.l0a.m9.3.3.2.2.2.2.3">1</cn></apply></list></apply><cn id="alg1.l0a.m9.3.3.4.cmml" type="integer" xref="alg1.l0a.m9.3.3.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m9.3c">T_{M}[r,i_{1},j_{1}]=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m9.3d">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = 0</annotation></semantics></math> when <math alttext="i_{1}\leq j_{1}\leq i_{1}+L-1" class="ltx_Math" display="inline" id="alg1.l0a.m10.1"><semantics id="alg1.l0a.m10.1a"><mrow id="alg1.l0a.m10.1.1" xref="alg1.l0a.m10.1.1.cmml"><msub id="alg1.l0a.m10.1.1.2" xref="alg1.l0a.m10.1.1.2.cmml"><mi id="alg1.l0a.m10.1.1.2.2" xref="alg1.l0a.m10.1.1.2.2.cmml">i</mi><mn id="alg1.l0a.m10.1.1.2.3" xref="alg1.l0a.m10.1.1.2.3.cmml">1</mn></msub><mo id="alg1.l0a.m10.1.1.3" xref="alg1.l0a.m10.1.1.3.cmml">≤</mo><msub id="alg1.l0a.m10.1.1.4" xref="alg1.l0a.m10.1.1.4.cmml"><mi id="alg1.l0a.m10.1.1.4.2" xref="alg1.l0a.m10.1.1.4.2.cmml">j</mi><mn id="alg1.l0a.m10.1.1.4.3" xref="alg1.l0a.m10.1.1.4.3.cmml">1</mn></msub><mo id="alg1.l0a.m10.1.1.5" xref="alg1.l0a.m10.1.1.5.cmml">≤</mo><mrow id="alg1.l0a.m10.1.1.6" xref="alg1.l0a.m10.1.1.6.cmml"><mrow id="alg1.l0a.m10.1.1.6.2" xref="alg1.l0a.m10.1.1.6.2.cmml"><msub id="alg1.l0a.m10.1.1.6.2.2" xref="alg1.l0a.m10.1.1.6.2.2.cmml"><mi id="alg1.l0a.m10.1.1.6.2.2.2" xref="alg1.l0a.m10.1.1.6.2.2.2.cmml">i</mi><mn id="alg1.l0a.m10.1.1.6.2.2.3" xref="alg1.l0a.m10.1.1.6.2.2.3.cmml">1</mn></msub><mo id="alg1.l0a.m10.1.1.6.2.1" xref="alg1.l0a.m10.1.1.6.2.1.cmml">+</mo><mi id="alg1.l0a.m10.1.1.6.2.3" xref="alg1.l0a.m10.1.1.6.2.3.cmml">L</mi></mrow><mo id="alg1.l0a.m10.1.1.6.1" xref="alg1.l0a.m10.1.1.6.1.cmml">−</mo><mn id="alg1.l0a.m10.1.1.6.3" xref="alg1.l0a.m10.1.1.6.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m10.1b"><apply id="alg1.l0a.m10.1.1.cmml" xref="alg1.l0a.m10.1.1"><and id="alg1.l0a.m10.1.1a.cmml" xref="alg1.l0a.m10.1.1"></and><apply id="alg1.l0a.m10.1.1b.cmml" xref="alg1.l0a.m10.1.1"><leq id="alg1.l0a.m10.1.1.3.cmml" xref="alg1.l0a.m10.1.1.3"></leq><apply id="alg1.l0a.m10.1.1.2.cmml" xref="alg1.l0a.m10.1.1.2"><csymbol cd="ambiguous" id="alg1.l0a.m10.1.1.2.1.cmml" xref="alg1.l0a.m10.1.1.2">subscript</csymbol><ci id="alg1.l0a.m10.1.1.2.2.cmml" xref="alg1.l0a.m10.1.1.2.2">𝑖</ci><cn id="alg1.l0a.m10.1.1.2.3.cmml" type="integer" xref="alg1.l0a.m10.1.1.2.3">1</cn></apply><apply id="alg1.l0a.m10.1.1.4.cmml" xref="alg1.l0a.m10.1.1.4"><csymbol cd="ambiguous" id="alg1.l0a.m10.1.1.4.1.cmml" xref="alg1.l0a.m10.1.1.4">subscript</csymbol><ci id="alg1.l0a.m10.1.1.4.2.cmml" xref="alg1.l0a.m10.1.1.4.2">𝑗</ci><cn id="alg1.l0a.m10.1.1.4.3.cmml" type="integer" xref="alg1.l0a.m10.1.1.4.3">1</cn></apply></apply><apply id="alg1.l0a.m10.1.1c.cmml" xref="alg1.l0a.m10.1.1"><leq id="alg1.l0a.m10.1.1.5.cmml" xref="alg1.l0a.m10.1.1.5"></leq><share href="https://arxiv.org/html/2410.03805v1#alg1.l0a.m10.1.1.4.cmml" id="alg1.l0a.m10.1.1d.cmml" xref="alg1.l0a.m10.1.1"></share><apply id="alg1.l0a.m10.1.1.6.cmml" xref="alg1.l0a.m10.1.1.6"><minus id="alg1.l0a.m10.1.1.6.1.cmml" xref="alg1.l0a.m10.1.1.6.1"></minus><apply id="alg1.l0a.m10.1.1.6.2.cmml" xref="alg1.l0a.m10.1.1.6.2"><plus id="alg1.l0a.m10.1.1.6.2.1.cmml" xref="alg1.l0a.m10.1.1.6.2.1"></plus><apply id="alg1.l0a.m10.1.1.6.2.2.cmml" xref="alg1.l0a.m10.1.1.6.2.2"><csymbol cd="ambiguous" id="alg1.l0a.m10.1.1.6.2.2.1.cmml" xref="alg1.l0a.m10.1.1.6.2.2">subscript</csymbol><ci id="alg1.l0a.m10.1.1.6.2.2.2.cmml" xref="alg1.l0a.m10.1.1.6.2.2.2">𝑖</ci><cn id="alg1.l0a.m10.1.1.6.2.2.3.cmml" type="integer" xref="alg1.l0a.m10.1.1.6.2.2.3">1</cn></apply><ci id="alg1.l0a.m10.1.1.6.2.3.cmml" xref="alg1.l0a.m10.1.1.6.2.3">𝐿</ci></apply><cn id="alg1.l0a.m10.1.1.6.3.cmml" type="integer" xref="alg1.l0a.m10.1.1.6.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m10.1c">i_{1}\leq j_{1}\leq i_{1}+L-1</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m10.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_L - 1</annotation></semantics></math> and <math alttext="T_{M}[r,i_{1},j_{1}]=-\infty" class="ltx_Math" display="inline" id="alg1.l0a.m11.3"><semantics id="alg1.l0a.m11.3a"><mrow id="alg1.l0a.m11.3.3" xref="alg1.l0a.m11.3.3.cmml"><mrow id="alg1.l0a.m11.3.3.2" xref="alg1.l0a.m11.3.3.2.cmml"><msub id="alg1.l0a.m11.3.3.2.4" xref="alg1.l0a.m11.3.3.2.4.cmml"><mi id="alg1.l0a.m11.3.3.2.4.2" xref="alg1.l0a.m11.3.3.2.4.2.cmml">T</mi><mi id="alg1.l0a.m11.3.3.2.4.3" xref="alg1.l0a.m11.3.3.2.4.3.cmml">M</mi></msub><mo id="alg1.l0a.m11.3.3.2.3" xref="alg1.l0a.m11.3.3.2.3.cmml">⁢</mo><mrow id="alg1.l0a.m11.3.3.2.2.2" xref="alg1.l0a.m11.3.3.2.2.3.cmml"><mo id="alg1.l0a.m11.3.3.2.2.2.3" stretchy="false" xref="alg1.l0a.m11.3.3.2.2.3.cmml">[</mo><mi id="alg1.l0a.m11.1.1" xref="alg1.l0a.m11.1.1.cmml">r</mi><mo id="alg1.l0a.m11.3.3.2.2.2.4" xref="alg1.l0a.m11.3.3.2.2.3.cmml">,</mo><msub id="alg1.l0a.m11.2.2.1.1.1.1" xref="alg1.l0a.m11.2.2.1.1.1.1.cmml"><mi id="alg1.l0a.m11.2.2.1.1.1.1.2" xref="alg1.l0a.m11.2.2.1.1.1.1.2.cmml">i</mi><mn id="alg1.l0a.m11.2.2.1.1.1.1.3" xref="alg1.l0a.m11.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l0a.m11.3.3.2.2.2.5" xref="alg1.l0a.m11.3.3.2.2.3.cmml">,</mo><msub id="alg1.l0a.m11.3.3.2.2.2.2" xref="alg1.l0a.m11.3.3.2.2.2.2.cmml"><mi id="alg1.l0a.m11.3.3.2.2.2.2.2" xref="alg1.l0a.m11.3.3.2.2.2.2.2.cmml">j</mi><mn id="alg1.l0a.m11.3.3.2.2.2.2.3" xref="alg1.l0a.m11.3.3.2.2.2.2.3.cmml">1</mn></msub><mo id="alg1.l0a.m11.3.3.2.2.2.6" stretchy="false" xref="alg1.l0a.m11.3.3.2.2.3.cmml">]</mo></mrow></mrow><mo id="alg1.l0a.m11.3.3.3" xref="alg1.l0a.m11.3.3.3.cmml">=</mo><mrow id="alg1.l0a.m11.3.3.4" xref="alg1.l0a.m11.3.3.4.cmml"><mo id="alg1.l0a.m11.3.3.4a" xref="alg1.l0a.m11.3.3.4.cmml">−</mo><mi id="alg1.l0a.m11.3.3.4.2" mathvariant="normal" xref="alg1.l0a.m11.3.3.4.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m11.3b"><apply id="alg1.l0a.m11.3.3.cmml" xref="alg1.l0a.m11.3.3"><eq id="alg1.l0a.m11.3.3.3.cmml" xref="alg1.l0a.m11.3.3.3"></eq><apply id="alg1.l0a.m11.3.3.2.cmml" xref="alg1.l0a.m11.3.3.2"><times id="alg1.l0a.m11.3.3.2.3.cmml" xref="alg1.l0a.m11.3.3.2.3"></times><apply id="alg1.l0a.m11.3.3.2.4.cmml" xref="alg1.l0a.m11.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l0a.m11.3.3.2.4.1.cmml" xref="alg1.l0a.m11.3.3.2.4">subscript</csymbol><ci id="alg1.l0a.m11.3.3.2.4.2.cmml" xref="alg1.l0a.m11.3.3.2.4.2">𝑇</ci><ci id="alg1.l0a.m11.3.3.2.4.3.cmml" xref="alg1.l0a.m11.3.3.2.4.3">𝑀</ci></apply><list id="alg1.l0a.m11.3.3.2.2.3.cmml" xref="alg1.l0a.m11.3.3.2.2.2"><ci id="alg1.l0a.m11.1.1.cmml" xref="alg1.l0a.m11.1.1">𝑟</ci><apply id="alg1.l0a.m11.2.2.1.1.1.1.cmml" xref="alg1.l0a.m11.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m11.2.2.1.1.1.1.1.cmml" xref="alg1.l0a.m11.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l0a.m11.2.2.1.1.1.1.2.cmml" xref="alg1.l0a.m11.2.2.1.1.1.1.2">𝑖</ci><cn id="alg1.l0a.m11.2.2.1.1.1.1.3.cmml" type="integer" xref="alg1.l0a.m11.2.2.1.1.1.1.3">1</cn></apply><apply id="alg1.l0a.m11.3.3.2.2.2.2.cmml" xref="alg1.l0a.m11.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l0a.m11.3.3.2.2.2.2.1.cmml" xref="alg1.l0a.m11.3.3.2.2.2.2">subscript</csymbol><ci id="alg1.l0a.m11.3.3.2.2.2.2.2.cmml" xref="alg1.l0a.m11.3.3.2.2.2.2.2">𝑗</ci><cn id="alg1.l0a.m11.3.3.2.2.2.2.3.cmml" type="integer" xref="alg1.l0a.m11.3.3.2.2.2.2.3">1</cn></apply></list></apply><apply id="alg1.l0a.m11.3.3.4.cmml" xref="alg1.l0a.m11.3.3.4"><minus id="alg1.l0a.m11.3.3.4.1.cmml" xref="alg1.l0a.m11.3.3.4"></minus><infinity id="alg1.l0a.m11.3.3.4.2.cmml" xref="alg1.l0a.m11.3.3.4.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m11.3c">T_{M}[r,i_{1},j_{1}]=-\infty</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m11.3d">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = - ∞</annotation></semantics></math> otherwise. Here the tensor <math alttext="T_{M}" class="ltx_Math" display="inline" id="alg1.l0a.m12.1"><semantics id="alg1.l0a.m12.1a"><msub id="alg1.l0a.m12.1.1" xref="alg1.l0a.m12.1.1.cmml"><mi id="alg1.l0a.m12.1.1.2" xref="alg1.l0a.m12.1.1.2.cmml">T</mi><mi id="alg1.l0a.m12.1.1.3" xref="alg1.l0a.m12.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0a.m12.1b"><apply id="alg1.l0a.m12.1.1.cmml" xref="alg1.l0a.m12.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m12.1.1.1.cmml" xref="alg1.l0a.m12.1.1">subscript</csymbol><ci id="alg1.l0a.m12.1.1.2.cmml" xref="alg1.l0a.m12.1.1.2">𝑇</ci><ci id="alg1.l0a.m12.1.1.3.cmml" xref="alg1.l0a.m12.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m12.1c">T_{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m12.1d">italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> is a local mask, that will be applied to each one of the <math alttext="s" class="ltx_Math" display="inline" id="alg1.l0a.m13.1"><semantics id="alg1.l0a.m13.1a"><mi id="alg1.l0a.m13.1.1" xref="alg1.l0a.m13.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m13.1b"><ci id="alg1.l0a.m13.1.1.cmml" xref="alg1.l0a.m13.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m13.1c">s</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m13.1d">italic_s</annotation></semantics></math> ”splits" or blocks of <math alttext="QK^{T}" class="ltx_Math" display="inline" id="alg1.l0a.m14.1"><semantics id="alg1.l0a.m14.1a"><mrow id="alg1.l0a.m14.1.1" xref="alg1.l0a.m14.1.1.cmml"><mi id="alg1.l0a.m14.1.1.2" xref="alg1.l0a.m14.1.1.2.cmml">Q</mi><mo id="alg1.l0a.m14.1.1.1" xref="alg1.l0a.m14.1.1.1.cmml">⁢</mo><msup id="alg1.l0a.m14.1.1.3" xref="alg1.l0a.m14.1.1.3.cmml"><mi id="alg1.l0a.m14.1.1.3.2" xref="alg1.l0a.m14.1.1.3.2.cmml">K</mi><mi id="alg1.l0a.m14.1.1.3.3" xref="alg1.l0a.m14.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m14.1b"><apply id="alg1.l0a.m14.1.1.cmml" xref="alg1.l0a.m14.1.1"><times id="alg1.l0a.m14.1.1.1.cmml" xref="alg1.l0a.m14.1.1.1"></times><ci id="alg1.l0a.m14.1.1.2.cmml" xref="alg1.l0a.m14.1.1.2">𝑄</ci><apply id="alg1.l0a.m14.1.1.3.cmml" xref="alg1.l0a.m14.1.1.3"><csymbol cd="ambiguous" id="alg1.l0a.m14.1.1.3.1.cmml" xref="alg1.l0a.m14.1.1.3">superscript</csymbol><ci id="alg1.l0a.m14.1.1.3.2.cmml" xref="alg1.l0a.m14.1.1.3.2">𝐾</ci><ci id="alg1.l0a.m14.1.1.3.3.cmml" xref="alg1.l0a.m14.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m14.1c">QK^{T}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m14.1d">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> that we compute, emulating the work of the mask <math alttext="M" class="ltx_Math" display="inline" id="alg1.l0a.m15.1"><semantics id="alg1.l0a.m15.1a"><mi id="alg1.l0a.m15.1.1" xref="alg1.l0a.m15.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m15.1b"><ci id="alg1.l0a.m15.1.1.cmml" xref="alg1.l0a.m15.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m15.1c">M</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m15.1d">italic_M</annotation></semantics></math> in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S3.E3" title="Equation 3 ‣ Definition 1 (Local Attention). ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">3</span></a>). This tensor is pre-computed.

</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  Let <math alttext="T_{Q}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">T</mi><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑇</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">T_{Q}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> be the tensor with dimension <math alttext="s\times L\times d_{q}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mrow id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">s</mi><mo id="alg1.l1.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="alg1.l1.m2.1.1.1.cmml">×</mo><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">L</mi><mo id="alg1.l1.m2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="alg1.l1.m2.1.1.1.cmml">×</mo><msub id="alg1.l1.m2.1.1.4" xref="alg1.l1.m2.1.1.4.cmml"><mi id="alg1.l1.m2.1.1.4.2" xref="alg1.l1.m2.1.1.4.2.cmml">d</mi><mi id="alg1.l1.m2.1.1.4.3" xref="alg1.l1.m2.1.1.4.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><times id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1.1"></times><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑠</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝐿</ci><apply id="alg1.l1.m2.1.1.4.cmml" xref="alg1.l1.m2.1.1.4"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.4.1.cmml" xref="alg1.l1.m2.1.1.4">subscript</csymbol><ci id="alg1.l1.m2.1.1.4.2.cmml" xref="alg1.l1.m2.1.1.4.2">𝑑</ci><ci id="alg1.l1.m2.1.1.4.3.cmml" xref="alg1.l1.m2.1.1.4.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">s\times L\times d_{q}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_s × italic_L × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="T_{Q}[r,i_{1},t]=Q[rL+i_{1},t]" class="ltx_Math" display="inline" id="alg1.l1.m3.5"><semantics id="alg1.l1.m3.5a"><mrow id="alg1.l1.m3.5.5" xref="alg1.l1.m3.5.5.cmml"><mrow id="alg1.l1.m3.4.4.1" xref="alg1.l1.m3.4.4.1.cmml"><msub id="alg1.l1.m3.4.4.1.3" xref="alg1.l1.m3.4.4.1.3.cmml"><mi id="alg1.l1.m3.4.4.1.3.2" xref="alg1.l1.m3.4.4.1.3.2.cmml">T</mi><mi id="alg1.l1.m3.4.4.1.3.3" xref="alg1.l1.m3.4.4.1.3.3.cmml">Q</mi></msub><mo id="alg1.l1.m3.4.4.1.2" xref="alg1.l1.m3.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l1.m3.4.4.1.1.1" xref="alg1.l1.m3.4.4.1.1.2.cmml"><mo id="alg1.l1.m3.4.4.1.1.1.2" stretchy="false" xref="alg1.l1.m3.4.4.1.1.2.cmml">[</mo><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">r</mi><mo id="alg1.l1.m3.4.4.1.1.1.3" xref="alg1.l1.m3.4.4.1.1.2.cmml">,</mo><msub id="alg1.l1.m3.4.4.1.1.1.1" xref="alg1.l1.m3.4.4.1.1.1.1.cmml"><mi id="alg1.l1.m3.4.4.1.1.1.1.2" xref="alg1.l1.m3.4.4.1.1.1.1.2.cmml">i</mi><mn id="alg1.l1.m3.4.4.1.1.1.1.3" xref="alg1.l1.m3.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l1.m3.4.4.1.1.1.4" xref="alg1.l1.m3.4.4.1.1.2.cmml">,</mo><mi id="alg1.l1.m3.2.2" xref="alg1.l1.m3.2.2.cmml">t</mi><mo id="alg1.l1.m3.4.4.1.1.1.5" stretchy="false" xref="alg1.l1.m3.4.4.1.1.2.cmml">]</mo></mrow></mrow><mo id="alg1.l1.m3.5.5.3" xref="alg1.l1.m3.5.5.3.cmml">=</mo><mrow id="alg1.l1.m3.5.5.2" xref="alg1.l1.m3.5.5.2.cmml"><mi id="alg1.l1.m3.5.5.2.3" xref="alg1.l1.m3.5.5.2.3.cmml">Q</mi><mo id="alg1.l1.m3.5.5.2.2" xref="alg1.l1.m3.5.5.2.2.cmml">⁢</mo><mrow id="alg1.l1.m3.5.5.2.1.1" xref="alg1.l1.m3.5.5.2.1.2.cmml"><mo id="alg1.l1.m3.5.5.2.1.1.2" stretchy="false" xref="alg1.l1.m3.5.5.2.1.2.cmml">[</mo><mrow id="alg1.l1.m3.5.5.2.1.1.1" xref="alg1.l1.m3.5.5.2.1.1.1.cmml"><mrow id="alg1.l1.m3.5.5.2.1.1.1.2" xref="alg1.l1.m3.5.5.2.1.1.1.2.cmml"><mi id="alg1.l1.m3.5.5.2.1.1.1.2.2" xref="alg1.l1.m3.5.5.2.1.1.1.2.2.cmml">r</mi><mo id="alg1.l1.m3.5.5.2.1.1.1.2.1" xref="alg1.l1.m3.5.5.2.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l1.m3.5.5.2.1.1.1.2.3" xref="alg1.l1.m3.5.5.2.1.1.1.2.3.cmml">L</mi></mrow><mo id="alg1.l1.m3.5.5.2.1.1.1.1" xref="alg1.l1.m3.5.5.2.1.1.1.1.cmml">+</mo><msub id="alg1.l1.m3.5.5.2.1.1.1.3" xref="alg1.l1.m3.5.5.2.1.1.1.3.cmml"><mi id="alg1.l1.m3.5.5.2.1.1.1.3.2" xref="alg1.l1.m3.5.5.2.1.1.1.3.2.cmml">i</mi><mn id="alg1.l1.m3.5.5.2.1.1.1.3.3" xref="alg1.l1.m3.5.5.2.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="alg1.l1.m3.5.5.2.1.1.3" xref="alg1.l1.m3.5.5.2.1.2.cmml">,</mo><mi id="alg1.l1.m3.3.3" xref="alg1.l1.m3.3.3.cmml">t</mi><mo id="alg1.l1.m3.5.5.2.1.1.4" stretchy="false" xref="alg1.l1.m3.5.5.2.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.5b"><apply id="alg1.l1.m3.5.5.cmml" xref="alg1.l1.m3.5.5"><eq id="alg1.l1.m3.5.5.3.cmml" xref="alg1.l1.m3.5.5.3"></eq><apply id="alg1.l1.m3.4.4.1.cmml" xref="alg1.l1.m3.4.4.1"><times id="alg1.l1.m3.4.4.1.2.cmml" xref="alg1.l1.m3.4.4.1.2"></times><apply id="alg1.l1.m3.4.4.1.3.cmml" xref="alg1.l1.m3.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l1.m3.4.4.1.3.1.cmml" xref="alg1.l1.m3.4.4.1.3">subscript</csymbol><ci id="alg1.l1.m3.4.4.1.3.2.cmml" xref="alg1.l1.m3.4.4.1.3.2">𝑇</ci><ci id="alg1.l1.m3.4.4.1.3.3.cmml" xref="alg1.l1.m3.4.4.1.3.3">𝑄</ci></apply><list id="alg1.l1.m3.4.4.1.1.2.cmml" xref="alg1.l1.m3.4.4.1.1.1"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝑟</ci><apply id="alg1.l1.m3.4.4.1.1.1.1.cmml" xref="alg1.l1.m3.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.4.4.1.1.1.1.1.cmml" xref="alg1.l1.m3.4.4.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m3.4.4.1.1.1.1.2.cmml" xref="alg1.l1.m3.4.4.1.1.1.1.2">𝑖</ci><cn id="alg1.l1.m3.4.4.1.1.1.1.3.cmml" type="integer" xref="alg1.l1.m3.4.4.1.1.1.1.3">1</cn></apply><ci id="alg1.l1.m3.2.2.cmml" xref="alg1.l1.m3.2.2">𝑡</ci></list></apply><apply id="alg1.l1.m3.5.5.2.cmml" xref="alg1.l1.m3.5.5.2"><times id="alg1.l1.m3.5.5.2.2.cmml" xref="alg1.l1.m3.5.5.2.2"></times><ci id="alg1.l1.m3.5.5.2.3.cmml" xref="alg1.l1.m3.5.5.2.3">𝑄</ci><interval closure="closed" id="alg1.l1.m3.5.5.2.1.2.cmml" xref="alg1.l1.m3.5.5.2.1.1"><apply id="alg1.l1.m3.5.5.2.1.1.1.cmml" xref="alg1.l1.m3.5.5.2.1.1.1"><plus id="alg1.l1.m3.5.5.2.1.1.1.1.cmml" xref="alg1.l1.m3.5.5.2.1.1.1.1"></plus><apply id="alg1.l1.m3.5.5.2.1.1.1.2.cmml" xref="alg1.l1.m3.5.5.2.1.1.1.2"><times id="alg1.l1.m3.5.5.2.1.1.1.2.1.cmml" xref="alg1.l1.m3.5.5.2.1.1.1.2.1"></times><ci id="alg1.l1.m3.5.5.2.1.1.1.2.2.cmml" xref="alg1.l1.m3.5.5.2.1.1.1.2.2">𝑟</ci><ci id="alg1.l1.m3.5.5.2.1.1.1.2.3.cmml" xref="alg1.l1.m3.5.5.2.1.1.1.2.3">𝐿</ci></apply><apply id="alg1.l1.m3.5.5.2.1.1.1.3.cmml" xref="alg1.l1.m3.5.5.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m3.5.5.2.1.1.1.3.1.cmml" xref="alg1.l1.m3.5.5.2.1.1.1.3">subscript</csymbol><ci id="alg1.l1.m3.5.5.2.1.1.1.3.2.cmml" xref="alg1.l1.m3.5.5.2.1.1.1.3.2">𝑖</ci><cn id="alg1.l1.m3.5.5.2.1.1.1.3.3.cmml" type="integer" xref="alg1.l1.m3.5.5.2.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m3.3.3.cmml" xref="alg1.l1.m3.3.3">𝑡</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.5c">T_{Q}[r,i_{1},t]=Q[rL+i_{1},t]</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.5d">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ italic_r , italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ] = italic_Q [ italic_r italic_L + italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ]</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  Let <math alttext="T_{K}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">T</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑇</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">T_{K}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> be the tensor with dimension <math alttext="s\times(2L-1)\times d_{q}" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><mrow id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">s</mi><mo id="alg1.l2.m2.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg1.l2.m2.1.1.2.cmml">×</mo><mrow id="alg1.l2.m2.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.1.cmml"><mo id="alg1.l2.m2.1.1.1.1.2" stretchy="false" xref="alg1.l2.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l2.m2.1.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.1.cmml"><mrow id="alg1.l2.m2.1.1.1.1.1.2" xref="alg1.l2.m2.1.1.1.1.1.2.cmml"><mn id="alg1.l2.m2.1.1.1.1.1.2.2" xref="alg1.l2.m2.1.1.1.1.1.2.2.cmml">2</mn><mo id="alg1.l2.m2.1.1.1.1.1.2.1" xref="alg1.l2.m2.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l2.m2.1.1.1.1.1.2.3" xref="alg1.l2.m2.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="alg1.l2.m2.1.1.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.1.1.cmml">−</mo><mn id="alg1.l2.m2.1.1.1.1.1.3" xref="alg1.l2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l2.m2.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="alg1.l2.m2.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l2.m2.1.1.2a" rspace="0.222em" xref="alg1.l2.m2.1.1.2.cmml">×</mo><msub id="alg1.l2.m2.1.1.4" xref="alg1.l2.m2.1.1.4.cmml"><mi id="alg1.l2.m2.1.1.4.2" xref="alg1.l2.m2.1.1.4.2.cmml">d</mi><mi id="alg1.l2.m2.1.1.4.3" xref="alg1.l2.m2.1.1.4.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><times id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2"></times><ci id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">𝑠</ci><apply id="alg1.l2.m2.1.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1"><minus id="alg1.l2.m2.1.1.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1.1.1"></minus><apply id="alg1.l2.m2.1.1.1.1.1.2.cmml" xref="alg1.l2.m2.1.1.1.1.1.2"><times id="alg1.l2.m2.1.1.1.1.1.2.1.cmml" xref="alg1.l2.m2.1.1.1.1.1.2.1"></times><cn id="alg1.l2.m2.1.1.1.1.1.2.2.cmml" type="integer" xref="alg1.l2.m2.1.1.1.1.1.2.2">2</cn><ci id="alg1.l2.m2.1.1.1.1.1.2.3.cmml" xref="alg1.l2.m2.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="alg1.l2.m2.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l2.m2.1.1.1.1.1.3">1</cn></apply><apply id="alg1.l2.m2.1.1.4.cmml" xref="alg1.l2.m2.1.1.4"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.4.1.cmml" xref="alg1.l2.m2.1.1.4">subscript</csymbol><ci id="alg1.l2.m2.1.1.4.2.cmml" xref="alg1.l2.m2.1.1.4.2">𝑑</ci><ci id="alg1.l2.m2.1.1.4.3.cmml" xref="alg1.l2.m2.1.1.4.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">s\times(2L-1)\times d_{q}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_s × ( 2 italic_L - 1 ) × italic_d start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="T_{K}[r,j_{1},t]=0" class="ltx_Math" display="inline" id="alg1.l2.m3.3"><semantics id="alg1.l2.m3.3a"><mrow id="alg1.l2.m3.3.3" xref="alg1.l2.m3.3.3.cmml"><mrow id="alg1.l2.m3.3.3.1" xref="alg1.l2.m3.3.3.1.cmml"><msub id="alg1.l2.m3.3.3.1.3" xref="alg1.l2.m3.3.3.1.3.cmml"><mi id="alg1.l2.m3.3.3.1.3.2" xref="alg1.l2.m3.3.3.1.3.2.cmml">T</mi><mi id="alg1.l2.m3.3.3.1.3.3" xref="alg1.l2.m3.3.3.1.3.3.cmml">K</mi></msub><mo id="alg1.l2.m3.3.3.1.2" xref="alg1.l2.m3.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l2.m3.3.3.1.1.1" xref="alg1.l2.m3.3.3.1.1.2.cmml"><mo id="alg1.l2.m3.3.3.1.1.1.2" stretchy="false" xref="alg1.l2.m3.3.3.1.1.2.cmml">[</mo><mi id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml">r</mi><mo id="alg1.l2.m3.3.3.1.1.1.3" xref="alg1.l2.m3.3.3.1.1.2.cmml">,</mo><msub id="alg1.l2.m3.3.3.1.1.1.1" xref="alg1.l2.m3.3.3.1.1.1.1.cmml"><mi id="alg1.l2.m3.3.3.1.1.1.1.2" xref="alg1.l2.m3.3.3.1.1.1.1.2.cmml">j</mi><mn id="alg1.l2.m3.3.3.1.1.1.1.3" xref="alg1.l2.m3.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l2.m3.3.3.1.1.1.4" xref="alg1.l2.m3.3.3.1.1.2.cmml">,</mo><mi id="alg1.l2.m3.2.2" xref="alg1.l2.m3.2.2.cmml">t</mi><mo id="alg1.l2.m3.3.3.1.1.1.5" stretchy="false" xref="alg1.l2.m3.3.3.1.1.2.cmml">]</mo></mrow></mrow><mo id="alg1.l2.m3.3.3.2" xref="alg1.l2.m3.3.3.2.cmml">=</mo><mn id="alg1.l2.m3.3.3.3" xref="alg1.l2.m3.3.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.3b"><apply id="alg1.l2.m3.3.3.cmml" xref="alg1.l2.m3.3.3"><eq id="alg1.l2.m3.3.3.2.cmml" xref="alg1.l2.m3.3.3.2"></eq><apply id="alg1.l2.m3.3.3.1.cmml" xref="alg1.l2.m3.3.3.1"><times id="alg1.l2.m3.3.3.1.2.cmml" xref="alg1.l2.m3.3.3.1.2"></times><apply id="alg1.l2.m3.3.3.1.3.cmml" xref="alg1.l2.m3.3.3.1.3"><csymbol cd="ambiguous" id="alg1.l2.m3.3.3.1.3.1.cmml" xref="alg1.l2.m3.3.3.1.3">subscript</csymbol><ci id="alg1.l2.m3.3.3.1.3.2.cmml" xref="alg1.l2.m3.3.3.1.3.2">𝑇</ci><ci id="alg1.l2.m3.3.3.1.3.3.cmml" xref="alg1.l2.m3.3.3.1.3.3">𝐾</ci></apply><list id="alg1.l2.m3.3.3.1.1.2.cmml" xref="alg1.l2.m3.3.3.1.1.1"><ci id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1">𝑟</ci><apply id="alg1.l2.m3.3.3.1.1.1.1.cmml" xref="alg1.l2.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.3.3.1.1.1.1.1.cmml" xref="alg1.l2.m3.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m3.3.3.1.1.1.1.2.cmml" xref="alg1.l2.m3.3.3.1.1.1.1.2">𝑗</ci><cn id="alg1.l2.m3.3.3.1.1.1.1.3.cmml" type="integer" xref="alg1.l2.m3.3.3.1.1.1.1.3">1</cn></apply><ci id="alg1.l2.m3.2.2.cmml" xref="alg1.l2.m3.2.2">𝑡</ci></list></apply><cn id="alg1.l2.m3.3.3.3.cmml" type="integer" xref="alg1.l2.m3.3.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.3c">T_{K}[r,j_{1},t]=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.3d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ italic_r , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ] = 0</annotation></semantics></math> when <math alttext="(r-1)L+1+j_{1}&lt;0" class="ltx_Math" display="inline" id="alg1.l2.m4.1"><semantics id="alg1.l2.m4.1a"><mrow id="alg1.l2.m4.1.1" xref="alg1.l2.m4.1.1.cmml"><mrow id="alg1.l2.m4.1.1.1" xref="alg1.l2.m4.1.1.1.cmml"><mrow id="alg1.l2.m4.1.1.1.1" xref="alg1.l2.m4.1.1.1.1.cmml"><mrow id="alg1.l2.m4.1.1.1.1.1.1" xref="alg1.l2.m4.1.1.1.1.1.1.1.cmml"><mo id="alg1.l2.m4.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l2.m4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l2.m4.1.1.1.1.1.1.1" xref="alg1.l2.m4.1.1.1.1.1.1.1.cmml"><mi id="alg1.l2.m4.1.1.1.1.1.1.1.2" xref="alg1.l2.m4.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="alg1.l2.m4.1.1.1.1.1.1.1.1" xref="alg1.l2.m4.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="alg1.l2.m4.1.1.1.1.1.1.1.3" xref="alg1.l2.m4.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l2.m4.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l2.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l2.m4.1.1.1.1.2" xref="alg1.l2.m4.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l2.m4.1.1.1.1.3" xref="alg1.l2.m4.1.1.1.1.3.cmml">L</mi></mrow><mo id="alg1.l2.m4.1.1.1.2" xref="alg1.l2.m4.1.1.1.2.cmml">+</mo><mn id="alg1.l2.m4.1.1.1.3" xref="alg1.l2.m4.1.1.1.3.cmml">1</mn><mo id="alg1.l2.m4.1.1.1.2a" xref="alg1.l2.m4.1.1.1.2.cmml">+</mo><msub id="alg1.l2.m4.1.1.1.4" xref="alg1.l2.m4.1.1.1.4.cmml"><mi id="alg1.l2.m4.1.1.1.4.2" xref="alg1.l2.m4.1.1.1.4.2.cmml">j</mi><mn id="alg1.l2.m4.1.1.1.4.3" xref="alg1.l2.m4.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="alg1.l2.m4.1.1.2" xref="alg1.l2.m4.1.1.2.cmml">&lt;</mo><mn id="alg1.l2.m4.1.1.3" xref="alg1.l2.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m4.1b"><apply id="alg1.l2.m4.1.1.cmml" xref="alg1.l2.m4.1.1"><lt id="alg1.l2.m4.1.1.2.cmml" xref="alg1.l2.m4.1.1.2"></lt><apply id="alg1.l2.m4.1.1.1.cmml" xref="alg1.l2.m4.1.1.1"><plus id="alg1.l2.m4.1.1.1.2.cmml" xref="alg1.l2.m4.1.1.1.2"></plus><apply id="alg1.l2.m4.1.1.1.1.cmml" xref="alg1.l2.m4.1.1.1.1"><times id="alg1.l2.m4.1.1.1.1.2.cmml" xref="alg1.l2.m4.1.1.1.1.2"></times><apply id="alg1.l2.m4.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m4.1.1.1.1.1.1"><minus id="alg1.l2.m4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m4.1.1.1.1.1.1.1.1"></minus><ci id="alg1.l2.m4.1.1.1.1.1.1.1.2.cmml" xref="alg1.l2.m4.1.1.1.1.1.1.1.2">𝑟</ci><cn id="alg1.l2.m4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l2.m4.1.1.1.1.1.1.1.3">1</cn></apply><ci id="alg1.l2.m4.1.1.1.1.3.cmml" xref="alg1.l2.m4.1.1.1.1.3">𝐿</ci></apply><cn id="alg1.l2.m4.1.1.1.3.cmml" type="integer" xref="alg1.l2.m4.1.1.1.3">1</cn><apply id="alg1.l2.m4.1.1.1.4.cmml" xref="alg1.l2.m4.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l2.m4.1.1.1.4.1.cmml" xref="alg1.l2.m4.1.1.1.4">subscript</csymbol><ci id="alg1.l2.m4.1.1.1.4.2.cmml" xref="alg1.l2.m4.1.1.1.4.2">𝑗</ci><cn id="alg1.l2.m4.1.1.1.4.3.cmml" type="integer" xref="alg1.l2.m4.1.1.1.4.3">1</cn></apply></apply><cn id="alg1.l2.m4.1.1.3.cmml" type="integer" xref="alg1.l2.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m4.1c">(r-1)L+1+j_{1}&lt;0</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m4.1d">( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &lt; 0</annotation></semantics></math> and <math alttext="T_{K}[r,j_{1},t]=K[(r-1)L+1+j_{1},t]" class="ltx_Math" display="inline" id="alg1.l2.m5.5"><semantics id="alg1.l2.m5.5a"><mrow id="alg1.l2.m5.5.5" xref="alg1.l2.m5.5.5.cmml"><mrow id="alg1.l2.m5.4.4.1" xref="alg1.l2.m5.4.4.1.cmml"><msub id="alg1.l2.m5.4.4.1.3" xref="alg1.l2.m5.4.4.1.3.cmml"><mi id="alg1.l2.m5.4.4.1.3.2" xref="alg1.l2.m5.4.4.1.3.2.cmml">T</mi><mi id="alg1.l2.m5.4.4.1.3.3" xref="alg1.l2.m5.4.4.1.3.3.cmml">K</mi></msub><mo id="alg1.l2.m5.4.4.1.2" xref="alg1.l2.m5.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l2.m5.4.4.1.1.1" xref="alg1.l2.m5.4.4.1.1.2.cmml"><mo id="alg1.l2.m5.4.4.1.1.1.2" stretchy="false" xref="alg1.l2.m5.4.4.1.1.2.cmml">[</mo><mi id="alg1.l2.m5.1.1" xref="alg1.l2.m5.1.1.cmml">r</mi><mo id="alg1.l2.m5.4.4.1.1.1.3" xref="alg1.l2.m5.4.4.1.1.2.cmml">,</mo><msub id="alg1.l2.m5.4.4.1.1.1.1" xref="alg1.l2.m5.4.4.1.1.1.1.cmml"><mi id="alg1.l2.m5.4.4.1.1.1.1.2" xref="alg1.l2.m5.4.4.1.1.1.1.2.cmml">j</mi><mn id="alg1.l2.m5.4.4.1.1.1.1.3" xref="alg1.l2.m5.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l2.m5.4.4.1.1.1.4" xref="alg1.l2.m5.4.4.1.1.2.cmml">,</mo><mi id="alg1.l2.m5.2.2" xref="alg1.l2.m5.2.2.cmml">t</mi><mo id="alg1.l2.m5.4.4.1.1.1.5" stretchy="false" xref="alg1.l2.m5.4.4.1.1.2.cmml">]</mo></mrow></mrow><mo id="alg1.l2.m5.5.5.3" xref="alg1.l2.m5.5.5.3.cmml">=</mo><mrow id="alg1.l2.m5.5.5.2" xref="alg1.l2.m5.5.5.2.cmml"><mi id="alg1.l2.m5.5.5.2.3" xref="alg1.l2.m5.5.5.2.3.cmml">K</mi><mo id="alg1.l2.m5.5.5.2.2" xref="alg1.l2.m5.5.5.2.2.cmml">⁢</mo><mrow id="alg1.l2.m5.5.5.2.1.1" xref="alg1.l2.m5.5.5.2.1.2.cmml"><mo id="alg1.l2.m5.5.5.2.1.1.2" stretchy="false" xref="alg1.l2.m5.5.5.2.1.2.cmml">[</mo><mrow id="alg1.l2.m5.5.5.2.1.1.1" xref="alg1.l2.m5.5.5.2.1.1.1.cmml"><mrow id="alg1.l2.m5.5.5.2.1.1.1.1" xref="alg1.l2.m5.5.5.2.1.1.1.1.cmml"><mrow id="alg1.l2.m5.5.5.2.1.1.1.1.1.1" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.cmml"><mo id="alg1.l2.m5.5.5.2.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.cmml"><mi id="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.2" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.1" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.3" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l2.m5.5.5.2.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l2.m5.5.5.2.1.1.1.1.2" xref="alg1.l2.m5.5.5.2.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l2.m5.5.5.2.1.1.1.1.3" xref="alg1.l2.m5.5.5.2.1.1.1.1.3.cmml">L</mi></mrow><mo id="alg1.l2.m5.5.5.2.1.1.1.2" xref="alg1.l2.m5.5.5.2.1.1.1.2.cmml">+</mo><mn id="alg1.l2.m5.5.5.2.1.1.1.3" xref="alg1.l2.m5.5.5.2.1.1.1.3.cmml">1</mn><mo id="alg1.l2.m5.5.5.2.1.1.1.2a" xref="alg1.l2.m5.5.5.2.1.1.1.2.cmml">+</mo><msub id="alg1.l2.m5.5.5.2.1.1.1.4" xref="alg1.l2.m5.5.5.2.1.1.1.4.cmml"><mi id="alg1.l2.m5.5.5.2.1.1.1.4.2" xref="alg1.l2.m5.5.5.2.1.1.1.4.2.cmml">j</mi><mn id="alg1.l2.m5.5.5.2.1.1.1.4.3" xref="alg1.l2.m5.5.5.2.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="alg1.l2.m5.5.5.2.1.1.3" xref="alg1.l2.m5.5.5.2.1.2.cmml">,</mo><mi id="alg1.l2.m5.3.3" xref="alg1.l2.m5.3.3.cmml">t</mi><mo id="alg1.l2.m5.5.5.2.1.1.4" stretchy="false" xref="alg1.l2.m5.5.5.2.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m5.5b"><apply id="alg1.l2.m5.5.5.cmml" xref="alg1.l2.m5.5.5"><eq id="alg1.l2.m5.5.5.3.cmml" xref="alg1.l2.m5.5.5.3"></eq><apply id="alg1.l2.m5.4.4.1.cmml" xref="alg1.l2.m5.4.4.1"><times id="alg1.l2.m5.4.4.1.2.cmml" xref="alg1.l2.m5.4.4.1.2"></times><apply id="alg1.l2.m5.4.4.1.3.cmml" xref="alg1.l2.m5.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l2.m5.4.4.1.3.1.cmml" xref="alg1.l2.m5.4.4.1.3">subscript</csymbol><ci id="alg1.l2.m5.4.4.1.3.2.cmml" xref="alg1.l2.m5.4.4.1.3.2">𝑇</ci><ci id="alg1.l2.m5.4.4.1.3.3.cmml" xref="alg1.l2.m5.4.4.1.3.3">𝐾</ci></apply><list id="alg1.l2.m5.4.4.1.1.2.cmml" xref="alg1.l2.m5.4.4.1.1.1"><ci id="alg1.l2.m5.1.1.cmml" xref="alg1.l2.m5.1.1">𝑟</ci><apply id="alg1.l2.m5.4.4.1.1.1.1.cmml" xref="alg1.l2.m5.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m5.4.4.1.1.1.1.1.cmml" xref="alg1.l2.m5.4.4.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m5.4.4.1.1.1.1.2.cmml" xref="alg1.l2.m5.4.4.1.1.1.1.2">𝑗</ci><cn id="alg1.l2.m5.4.4.1.1.1.1.3.cmml" type="integer" xref="alg1.l2.m5.4.4.1.1.1.1.3">1</cn></apply><ci id="alg1.l2.m5.2.2.cmml" xref="alg1.l2.m5.2.2">𝑡</ci></list></apply><apply id="alg1.l2.m5.5.5.2.cmml" xref="alg1.l2.m5.5.5.2"><times id="alg1.l2.m5.5.5.2.2.cmml" xref="alg1.l2.m5.5.5.2.2"></times><ci id="alg1.l2.m5.5.5.2.3.cmml" xref="alg1.l2.m5.5.5.2.3">𝐾</ci><interval closure="closed" id="alg1.l2.m5.5.5.2.1.2.cmml" xref="alg1.l2.m5.5.5.2.1.1"><apply id="alg1.l2.m5.5.5.2.1.1.1.cmml" xref="alg1.l2.m5.5.5.2.1.1.1"><plus id="alg1.l2.m5.5.5.2.1.1.1.2.cmml" xref="alg1.l2.m5.5.5.2.1.1.1.2"></plus><apply id="alg1.l2.m5.5.5.2.1.1.1.1.cmml" xref="alg1.l2.m5.5.5.2.1.1.1.1"><times id="alg1.l2.m5.5.5.2.1.1.1.1.2.cmml" xref="alg1.l2.m5.5.5.2.1.1.1.1.2"></times><apply id="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1"><minus id="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.1"></minus><ci id="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.2">𝑟</ci><cn id="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l2.m5.5.5.2.1.1.1.1.1.1.1.3">1</cn></apply><ci id="alg1.l2.m5.5.5.2.1.1.1.1.3.cmml" xref="alg1.l2.m5.5.5.2.1.1.1.1.3">𝐿</ci></apply><cn id="alg1.l2.m5.5.5.2.1.1.1.3.cmml" type="integer" xref="alg1.l2.m5.5.5.2.1.1.1.3">1</cn><apply id="alg1.l2.m5.5.5.2.1.1.1.4.cmml" xref="alg1.l2.m5.5.5.2.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l2.m5.5.5.2.1.1.1.4.1.cmml" xref="alg1.l2.m5.5.5.2.1.1.1.4">subscript</csymbol><ci id="alg1.l2.m5.5.5.2.1.1.1.4.2.cmml" xref="alg1.l2.m5.5.5.2.1.1.1.4.2">𝑗</ci><cn id="alg1.l2.m5.5.5.2.1.1.1.4.3.cmml" type="integer" xref="alg1.l2.m5.5.5.2.1.1.1.4.3">1</cn></apply></apply><ci id="alg1.l2.m5.3.3.cmml" xref="alg1.l2.m5.3.3">𝑡</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m5.5c">T_{K}[r,j_{1},t]=K[(r-1)L+1+j_{1},t]</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m5.5d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT [ italic_r , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ] = italic_K [ ( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ]</annotation></semantics></math> otherwise.

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>  Let <math alttext="T_{V}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">T</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑇</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">T_{V}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> be the tensor with dimension <math alttext="s\times(2L-1)\times d_{model}" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mrow id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml">s</mi><mo id="alg1.l3.m2.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg1.l3.m2.1.1.2.cmml">×</mo><mrow id="alg1.l3.m2.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.1.cmml"><mo id="alg1.l3.m2.1.1.1.1.2" stretchy="false" xref="alg1.l3.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l3.m2.1.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.1.cmml"><mrow id="alg1.l3.m2.1.1.1.1.1.2" xref="alg1.l3.m2.1.1.1.1.1.2.cmml"><mn id="alg1.l3.m2.1.1.1.1.1.2.2" xref="alg1.l3.m2.1.1.1.1.1.2.2.cmml">2</mn><mo id="alg1.l3.m2.1.1.1.1.1.2.1" xref="alg1.l3.m2.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.1.1.1.2.3" xref="alg1.l3.m2.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="alg1.l3.m2.1.1.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.1.1.cmml">−</mo><mn id="alg1.l3.m2.1.1.1.1.1.3" xref="alg1.l3.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l3.m2.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="alg1.l3.m2.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l3.m2.1.1.2a" rspace="0.222em" xref="alg1.l3.m2.1.1.2.cmml">×</mo><msub id="alg1.l3.m2.1.1.4" xref="alg1.l3.m2.1.1.4.cmml"><mi id="alg1.l3.m2.1.1.4.2" xref="alg1.l3.m2.1.1.4.2.cmml">d</mi><mrow id="alg1.l3.m2.1.1.4.3" xref="alg1.l3.m2.1.1.4.3.cmml"><mi id="alg1.l3.m2.1.1.4.3.2" xref="alg1.l3.m2.1.1.4.3.2.cmml">m</mi><mo id="alg1.l3.m2.1.1.4.3.1" xref="alg1.l3.m2.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.4.3.3" xref="alg1.l3.m2.1.1.4.3.3.cmml">o</mi><mo id="alg1.l3.m2.1.1.4.3.1a" xref="alg1.l3.m2.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.4.3.4" xref="alg1.l3.m2.1.1.4.3.4.cmml">d</mi><mo id="alg1.l3.m2.1.1.4.3.1b" xref="alg1.l3.m2.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.4.3.5" xref="alg1.l3.m2.1.1.4.3.5.cmml">e</mi><mo id="alg1.l3.m2.1.1.4.3.1c" xref="alg1.l3.m2.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.4.3.6" xref="alg1.l3.m2.1.1.4.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><times id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2"></times><ci id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3">𝑠</ci><apply id="alg1.l3.m2.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1"><minus id="alg1.l3.m2.1.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1.1.1"></minus><apply id="alg1.l3.m2.1.1.1.1.1.2.cmml" xref="alg1.l3.m2.1.1.1.1.1.2"><times id="alg1.l3.m2.1.1.1.1.1.2.1.cmml" xref="alg1.l3.m2.1.1.1.1.1.2.1"></times><cn id="alg1.l3.m2.1.1.1.1.1.2.2.cmml" type="integer" xref="alg1.l3.m2.1.1.1.1.1.2.2">2</cn><ci id="alg1.l3.m2.1.1.1.1.1.2.3.cmml" xref="alg1.l3.m2.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="alg1.l3.m2.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l3.m2.1.1.1.1.1.3">1</cn></apply><apply id="alg1.l3.m2.1.1.4.cmml" xref="alg1.l3.m2.1.1.4"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.4.1.cmml" xref="alg1.l3.m2.1.1.4">subscript</csymbol><ci id="alg1.l3.m2.1.1.4.2.cmml" xref="alg1.l3.m2.1.1.4.2">𝑑</ci><apply id="alg1.l3.m2.1.1.4.3.cmml" xref="alg1.l3.m2.1.1.4.3"><times id="alg1.l3.m2.1.1.4.3.1.cmml" xref="alg1.l3.m2.1.1.4.3.1"></times><ci id="alg1.l3.m2.1.1.4.3.2.cmml" xref="alg1.l3.m2.1.1.4.3.2">𝑚</ci><ci id="alg1.l3.m2.1.1.4.3.3.cmml" xref="alg1.l3.m2.1.1.4.3.3">𝑜</ci><ci id="alg1.l3.m2.1.1.4.3.4.cmml" xref="alg1.l3.m2.1.1.4.3.4">𝑑</ci><ci id="alg1.l3.m2.1.1.4.3.5.cmml" xref="alg1.l3.m2.1.1.4.3.5">𝑒</ci><ci id="alg1.l3.m2.1.1.4.3.6.cmml" xref="alg1.l3.m2.1.1.4.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">s\times(2L-1)\times d_{model}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_s × ( 2 italic_L - 1 ) × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="T_{V}[r,j_{1},t]=-\infty" class="ltx_Math" display="inline" id="alg1.l3.m3.3"><semantics id="alg1.l3.m3.3a"><mrow id="alg1.l3.m3.3.3" xref="alg1.l3.m3.3.3.cmml"><mrow id="alg1.l3.m3.3.3.1" xref="alg1.l3.m3.3.3.1.cmml"><msub id="alg1.l3.m3.3.3.1.3" xref="alg1.l3.m3.3.3.1.3.cmml"><mi id="alg1.l3.m3.3.3.1.3.2" xref="alg1.l3.m3.3.3.1.3.2.cmml">T</mi><mi id="alg1.l3.m3.3.3.1.3.3" xref="alg1.l3.m3.3.3.1.3.3.cmml">V</mi></msub><mo id="alg1.l3.m3.3.3.1.2" xref="alg1.l3.m3.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l3.m3.3.3.1.1.1" xref="alg1.l3.m3.3.3.1.1.2.cmml"><mo id="alg1.l3.m3.3.3.1.1.1.2" stretchy="false" xref="alg1.l3.m3.3.3.1.1.2.cmml">[</mo><mi id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml">r</mi><mo id="alg1.l3.m3.3.3.1.1.1.3" xref="alg1.l3.m3.3.3.1.1.2.cmml">,</mo><msub id="alg1.l3.m3.3.3.1.1.1.1" xref="alg1.l3.m3.3.3.1.1.1.1.cmml"><mi id="alg1.l3.m3.3.3.1.1.1.1.2" xref="alg1.l3.m3.3.3.1.1.1.1.2.cmml">j</mi><mn id="alg1.l3.m3.3.3.1.1.1.1.3" xref="alg1.l3.m3.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l3.m3.3.3.1.1.1.4" xref="alg1.l3.m3.3.3.1.1.2.cmml">,</mo><mi id="alg1.l3.m3.2.2" xref="alg1.l3.m3.2.2.cmml">t</mi><mo id="alg1.l3.m3.3.3.1.1.1.5" stretchy="false" xref="alg1.l3.m3.3.3.1.1.2.cmml">]</mo></mrow></mrow><mo id="alg1.l3.m3.3.3.2" xref="alg1.l3.m3.3.3.2.cmml">=</mo><mrow id="alg1.l3.m3.3.3.3" xref="alg1.l3.m3.3.3.3.cmml"><mo id="alg1.l3.m3.3.3.3a" xref="alg1.l3.m3.3.3.3.cmml">−</mo><mi id="alg1.l3.m3.3.3.3.2" mathvariant="normal" xref="alg1.l3.m3.3.3.3.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.3b"><apply id="alg1.l3.m3.3.3.cmml" xref="alg1.l3.m3.3.3"><eq id="alg1.l3.m3.3.3.2.cmml" xref="alg1.l3.m3.3.3.2"></eq><apply id="alg1.l3.m3.3.3.1.cmml" xref="alg1.l3.m3.3.3.1"><times id="alg1.l3.m3.3.3.1.2.cmml" xref="alg1.l3.m3.3.3.1.2"></times><apply id="alg1.l3.m3.3.3.1.3.cmml" xref="alg1.l3.m3.3.3.1.3"><csymbol cd="ambiguous" id="alg1.l3.m3.3.3.1.3.1.cmml" xref="alg1.l3.m3.3.3.1.3">subscript</csymbol><ci id="alg1.l3.m3.3.3.1.3.2.cmml" xref="alg1.l3.m3.3.3.1.3.2">𝑇</ci><ci id="alg1.l3.m3.3.3.1.3.3.cmml" xref="alg1.l3.m3.3.3.1.3.3">𝑉</ci></apply><list id="alg1.l3.m3.3.3.1.1.2.cmml" xref="alg1.l3.m3.3.3.1.1.1"><ci id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1">𝑟</ci><apply id="alg1.l3.m3.3.3.1.1.1.1.cmml" xref="alg1.l3.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m3.3.3.1.1.1.1.1.cmml" xref="alg1.l3.m3.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m3.3.3.1.1.1.1.2.cmml" xref="alg1.l3.m3.3.3.1.1.1.1.2">𝑗</ci><cn id="alg1.l3.m3.3.3.1.1.1.1.3.cmml" type="integer" xref="alg1.l3.m3.3.3.1.1.1.1.3">1</cn></apply><ci id="alg1.l3.m3.2.2.cmml" xref="alg1.l3.m3.2.2">𝑡</ci></list></apply><apply id="alg1.l3.m3.3.3.3.cmml" xref="alg1.l3.m3.3.3.3"><minus id="alg1.l3.m3.3.3.3.1.cmml" xref="alg1.l3.m3.3.3.3"></minus><infinity id="alg1.l3.m3.3.3.3.2.cmml" xref="alg1.l3.m3.3.3.3.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.3c">T_{V}[r,j_{1},t]=-\infty</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m3.3d">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ italic_r , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ] = - ∞</annotation></semantics></math> when <math alttext="(r-1)L+1+j_{1}&lt;0" class="ltx_Math" display="inline" id="alg1.l3.m4.1"><semantics id="alg1.l3.m4.1a"><mrow id="alg1.l3.m4.1.1" xref="alg1.l3.m4.1.1.cmml"><mrow id="alg1.l3.m4.1.1.1" xref="alg1.l3.m4.1.1.1.cmml"><mrow id="alg1.l3.m4.1.1.1.1" xref="alg1.l3.m4.1.1.1.1.cmml"><mrow id="alg1.l3.m4.1.1.1.1.1.1" xref="alg1.l3.m4.1.1.1.1.1.1.1.cmml"><mo id="alg1.l3.m4.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l3.m4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l3.m4.1.1.1.1.1.1.1" xref="alg1.l3.m4.1.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m4.1.1.1.1.1.1.1.2" xref="alg1.l3.m4.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="alg1.l3.m4.1.1.1.1.1.1.1.1" xref="alg1.l3.m4.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="alg1.l3.m4.1.1.1.1.1.1.1.3" xref="alg1.l3.m4.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l3.m4.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l3.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l3.m4.1.1.1.1.2" xref="alg1.l3.m4.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l3.m4.1.1.1.1.3" xref="alg1.l3.m4.1.1.1.1.3.cmml">L</mi></mrow><mo id="alg1.l3.m4.1.1.1.2" xref="alg1.l3.m4.1.1.1.2.cmml">+</mo><mn id="alg1.l3.m4.1.1.1.3" xref="alg1.l3.m4.1.1.1.3.cmml">1</mn><mo id="alg1.l3.m4.1.1.1.2a" xref="alg1.l3.m4.1.1.1.2.cmml">+</mo><msub id="alg1.l3.m4.1.1.1.4" xref="alg1.l3.m4.1.1.1.4.cmml"><mi id="alg1.l3.m4.1.1.1.4.2" xref="alg1.l3.m4.1.1.1.4.2.cmml">j</mi><mn id="alg1.l3.m4.1.1.1.4.3" xref="alg1.l3.m4.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="alg1.l3.m4.1.1.2" xref="alg1.l3.m4.1.1.2.cmml">&lt;</mo><mn id="alg1.l3.m4.1.1.3" xref="alg1.l3.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m4.1b"><apply id="alg1.l3.m4.1.1.cmml" xref="alg1.l3.m4.1.1"><lt id="alg1.l3.m4.1.1.2.cmml" xref="alg1.l3.m4.1.1.2"></lt><apply id="alg1.l3.m4.1.1.1.cmml" xref="alg1.l3.m4.1.1.1"><plus id="alg1.l3.m4.1.1.1.2.cmml" xref="alg1.l3.m4.1.1.1.2"></plus><apply id="alg1.l3.m4.1.1.1.1.cmml" xref="alg1.l3.m4.1.1.1.1"><times id="alg1.l3.m4.1.1.1.1.2.cmml" xref="alg1.l3.m4.1.1.1.1.2"></times><apply id="alg1.l3.m4.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m4.1.1.1.1.1.1"><minus id="alg1.l3.m4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m4.1.1.1.1.1.1.1.1"></minus><ci id="alg1.l3.m4.1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m4.1.1.1.1.1.1.1.2">𝑟</ci><cn id="alg1.l3.m4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l3.m4.1.1.1.1.1.1.1.3">1</cn></apply><ci id="alg1.l3.m4.1.1.1.1.3.cmml" xref="alg1.l3.m4.1.1.1.1.3">𝐿</ci></apply><cn id="alg1.l3.m4.1.1.1.3.cmml" type="integer" xref="alg1.l3.m4.1.1.1.3">1</cn><apply id="alg1.l3.m4.1.1.1.4.cmml" xref="alg1.l3.m4.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l3.m4.1.1.1.4.1.cmml" xref="alg1.l3.m4.1.1.1.4">subscript</csymbol><ci id="alg1.l3.m4.1.1.1.4.2.cmml" xref="alg1.l3.m4.1.1.1.4.2">𝑗</ci><cn id="alg1.l3.m4.1.1.1.4.3.cmml" type="integer" xref="alg1.l3.m4.1.1.1.4.3">1</cn></apply></apply><cn id="alg1.l3.m4.1.1.3.cmml" type="integer" xref="alg1.l3.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m4.1c">(r-1)L+1+j_{1}&lt;0</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m4.1d">( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &lt; 0</annotation></semantics></math> and <math alttext="T_{V}[r,j_{1},t]=V[(r-1)L+1+j_{1},t]" class="ltx_Math" display="inline" id="alg1.l3.m5.5"><semantics id="alg1.l3.m5.5a"><mrow id="alg1.l3.m5.5.5" xref="alg1.l3.m5.5.5.cmml"><mrow id="alg1.l3.m5.4.4.1" xref="alg1.l3.m5.4.4.1.cmml"><msub id="alg1.l3.m5.4.4.1.3" xref="alg1.l3.m5.4.4.1.3.cmml"><mi id="alg1.l3.m5.4.4.1.3.2" xref="alg1.l3.m5.4.4.1.3.2.cmml">T</mi><mi id="alg1.l3.m5.4.4.1.3.3" xref="alg1.l3.m5.4.4.1.3.3.cmml">V</mi></msub><mo id="alg1.l3.m5.4.4.1.2" xref="alg1.l3.m5.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l3.m5.4.4.1.1.1" xref="alg1.l3.m5.4.4.1.1.2.cmml"><mo id="alg1.l3.m5.4.4.1.1.1.2" stretchy="false" xref="alg1.l3.m5.4.4.1.1.2.cmml">[</mo><mi id="alg1.l3.m5.1.1" xref="alg1.l3.m5.1.1.cmml">r</mi><mo id="alg1.l3.m5.4.4.1.1.1.3" xref="alg1.l3.m5.4.4.1.1.2.cmml">,</mo><msub id="alg1.l3.m5.4.4.1.1.1.1" xref="alg1.l3.m5.4.4.1.1.1.1.cmml"><mi id="alg1.l3.m5.4.4.1.1.1.1.2" xref="alg1.l3.m5.4.4.1.1.1.1.2.cmml">j</mi><mn id="alg1.l3.m5.4.4.1.1.1.1.3" xref="alg1.l3.m5.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l3.m5.4.4.1.1.1.4" xref="alg1.l3.m5.4.4.1.1.2.cmml">,</mo><mi id="alg1.l3.m5.2.2" xref="alg1.l3.m5.2.2.cmml">t</mi><mo id="alg1.l3.m5.4.4.1.1.1.5" stretchy="false" xref="alg1.l3.m5.4.4.1.1.2.cmml">]</mo></mrow></mrow><mo id="alg1.l3.m5.5.5.3" xref="alg1.l3.m5.5.5.3.cmml">=</mo><mrow id="alg1.l3.m5.5.5.2" xref="alg1.l3.m5.5.5.2.cmml"><mi id="alg1.l3.m5.5.5.2.3" xref="alg1.l3.m5.5.5.2.3.cmml">V</mi><mo id="alg1.l3.m5.5.5.2.2" xref="alg1.l3.m5.5.5.2.2.cmml">⁢</mo><mrow id="alg1.l3.m5.5.5.2.1.1" xref="alg1.l3.m5.5.5.2.1.2.cmml"><mo id="alg1.l3.m5.5.5.2.1.1.2" stretchy="false" xref="alg1.l3.m5.5.5.2.1.2.cmml">[</mo><mrow id="alg1.l3.m5.5.5.2.1.1.1" xref="alg1.l3.m5.5.5.2.1.1.1.cmml"><mrow id="alg1.l3.m5.5.5.2.1.1.1.1" xref="alg1.l3.m5.5.5.2.1.1.1.1.cmml"><mrow id="alg1.l3.m5.5.5.2.1.1.1.1.1.1" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.cmml"><mo id="alg1.l3.m5.5.5.2.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.2" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.1" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.3" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l3.m5.5.5.2.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l3.m5.5.5.2.1.1.1.1.2" xref="alg1.l3.m5.5.5.2.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l3.m5.5.5.2.1.1.1.1.3" xref="alg1.l3.m5.5.5.2.1.1.1.1.3.cmml">L</mi></mrow><mo id="alg1.l3.m5.5.5.2.1.1.1.2" xref="alg1.l3.m5.5.5.2.1.1.1.2.cmml">+</mo><mn id="alg1.l3.m5.5.5.2.1.1.1.3" xref="alg1.l3.m5.5.5.2.1.1.1.3.cmml">1</mn><mo id="alg1.l3.m5.5.5.2.1.1.1.2a" xref="alg1.l3.m5.5.5.2.1.1.1.2.cmml">+</mo><msub id="alg1.l3.m5.5.5.2.1.1.1.4" xref="alg1.l3.m5.5.5.2.1.1.1.4.cmml"><mi id="alg1.l3.m5.5.5.2.1.1.1.4.2" xref="alg1.l3.m5.5.5.2.1.1.1.4.2.cmml">j</mi><mn id="alg1.l3.m5.5.5.2.1.1.1.4.3" xref="alg1.l3.m5.5.5.2.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="alg1.l3.m5.5.5.2.1.1.3" xref="alg1.l3.m5.5.5.2.1.2.cmml">,</mo><mi id="alg1.l3.m5.3.3" xref="alg1.l3.m5.3.3.cmml">t</mi><mo id="alg1.l3.m5.5.5.2.1.1.4" stretchy="false" xref="alg1.l3.m5.5.5.2.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m5.5b"><apply id="alg1.l3.m5.5.5.cmml" xref="alg1.l3.m5.5.5"><eq id="alg1.l3.m5.5.5.3.cmml" xref="alg1.l3.m5.5.5.3"></eq><apply id="alg1.l3.m5.4.4.1.cmml" xref="alg1.l3.m5.4.4.1"><times id="alg1.l3.m5.4.4.1.2.cmml" xref="alg1.l3.m5.4.4.1.2"></times><apply id="alg1.l3.m5.4.4.1.3.cmml" xref="alg1.l3.m5.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l3.m5.4.4.1.3.1.cmml" xref="alg1.l3.m5.4.4.1.3">subscript</csymbol><ci id="alg1.l3.m5.4.4.1.3.2.cmml" xref="alg1.l3.m5.4.4.1.3.2">𝑇</ci><ci id="alg1.l3.m5.4.4.1.3.3.cmml" xref="alg1.l3.m5.4.4.1.3.3">𝑉</ci></apply><list id="alg1.l3.m5.4.4.1.1.2.cmml" xref="alg1.l3.m5.4.4.1.1.1"><ci id="alg1.l3.m5.1.1.cmml" xref="alg1.l3.m5.1.1">𝑟</ci><apply id="alg1.l3.m5.4.4.1.1.1.1.cmml" xref="alg1.l3.m5.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m5.4.4.1.1.1.1.1.cmml" xref="alg1.l3.m5.4.4.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m5.4.4.1.1.1.1.2.cmml" xref="alg1.l3.m5.4.4.1.1.1.1.2">𝑗</ci><cn id="alg1.l3.m5.4.4.1.1.1.1.3.cmml" type="integer" xref="alg1.l3.m5.4.4.1.1.1.1.3">1</cn></apply><ci id="alg1.l3.m5.2.2.cmml" xref="alg1.l3.m5.2.2">𝑡</ci></list></apply><apply id="alg1.l3.m5.5.5.2.cmml" xref="alg1.l3.m5.5.5.2"><times id="alg1.l3.m5.5.5.2.2.cmml" xref="alg1.l3.m5.5.5.2.2"></times><ci id="alg1.l3.m5.5.5.2.3.cmml" xref="alg1.l3.m5.5.5.2.3">𝑉</ci><interval closure="closed" id="alg1.l3.m5.5.5.2.1.2.cmml" xref="alg1.l3.m5.5.5.2.1.1"><apply id="alg1.l3.m5.5.5.2.1.1.1.cmml" xref="alg1.l3.m5.5.5.2.1.1.1"><plus id="alg1.l3.m5.5.5.2.1.1.1.2.cmml" xref="alg1.l3.m5.5.5.2.1.1.1.2"></plus><apply id="alg1.l3.m5.5.5.2.1.1.1.1.cmml" xref="alg1.l3.m5.5.5.2.1.1.1.1"><times id="alg1.l3.m5.5.5.2.1.1.1.1.2.cmml" xref="alg1.l3.m5.5.5.2.1.1.1.1.2"></times><apply id="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1"><minus id="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.1"></minus><ci id="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.2">𝑟</ci><cn id="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l3.m5.5.5.2.1.1.1.1.1.1.1.3">1</cn></apply><ci id="alg1.l3.m5.5.5.2.1.1.1.1.3.cmml" xref="alg1.l3.m5.5.5.2.1.1.1.1.3">𝐿</ci></apply><cn id="alg1.l3.m5.5.5.2.1.1.1.3.cmml" type="integer" xref="alg1.l3.m5.5.5.2.1.1.1.3">1</cn><apply id="alg1.l3.m5.5.5.2.1.1.1.4.cmml" xref="alg1.l3.m5.5.5.2.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l3.m5.5.5.2.1.1.1.4.1.cmml" xref="alg1.l3.m5.5.5.2.1.1.1.4">subscript</csymbol><ci id="alg1.l3.m5.5.5.2.1.1.1.4.2.cmml" xref="alg1.l3.m5.5.5.2.1.1.1.4.2">𝑗</ci><cn id="alg1.l3.m5.5.5.2.1.1.1.4.3.cmml" type="integer" xref="alg1.l3.m5.5.5.2.1.1.1.4.3">1</cn></apply></apply><ci id="alg1.l3.m5.3.3.cmml" xref="alg1.l3.m5.3.3">𝑡</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m5.5c">T_{V}[r,j_{1},t]=V[(r-1)L+1+j_{1},t]</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m5.5d">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT [ italic_r , italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ] = italic_V [ ( italic_r - 1 ) italic_L + 1 + italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ]</annotation></semantics></math> otherwise.

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <math alttext="T_{A}=T_{Q}T_{K}^{T}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">T</mi><mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">A</mi></msub><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><msub id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml"><mi id="alg1.l4.m1.1.1.3.2.2" xref="alg1.l4.m1.1.1.3.2.2.cmml">T</mi><mi id="alg1.l4.m1.1.1.3.2.3" xref="alg1.l4.m1.1.1.3.2.3.cmml">Q</mi></msub><mo id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><msubsup id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml"><mi id="alg1.l4.m1.1.1.3.3.2.2" xref="alg1.l4.m1.1.1.3.3.2.2.cmml">T</mi><mi id="alg1.l4.m1.1.1.3.3.2.3" xref="alg1.l4.m1.1.1.3.3.2.3.cmml">K</mi><mi id="alg1.l4.m1.1.1.3.3.3" xref="alg1.l4.m1.1.1.3.3.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝑇</ci><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">𝐴</ci></apply><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><apply id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.2.1.cmml" xref="alg1.l4.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.2.2.cmml" xref="alg1.l4.m1.1.1.3.2.2">𝑇</ci><ci id="alg1.l4.m1.1.1.3.2.3.cmml" xref="alg1.l4.m1.1.1.3.2.3">𝑄</ci></apply><apply id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.3.1.cmml" xref="alg1.l4.m1.1.1.3.3">superscript</csymbol><apply id="alg1.l4.m1.1.1.3.3.2.cmml" xref="alg1.l4.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.3.2.1.cmml" xref="alg1.l4.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.3.2.2.cmml" xref="alg1.l4.m1.1.1.3.3.2.2">𝑇</ci><ci id="alg1.l4.m1.1.1.3.3.2.3.cmml" xref="alg1.l4.m1.1.1.3.3.2.3">𝐾</ci></apply><ci id="alg1.l4.m1.1.1.3.3.3.cmml" xref="alg1.l4.m1.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">T_{A}=T_{Q}T_{K}^{T}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT = italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>. Note that <math alttext="T_{A}" class="ltx_Math" display="inline" id="alg1.l4.m2.1"><semantics id="alg1.l4.m2.1a"><msub id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mi id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml">T</mi><mi id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1">subscript</csymbol><ci id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2">𝑇</ci><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">T_{A}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m2.1d">italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math> has dimensions <math alttext="s\times L\times(2L-1)" class="ltx_Math" display="inline" id="alg1.l4.m3.1"><semantics id="alg1.l4.m3.1a"><mrow id="alg1.l4.m3.1.1" xref="alg1.l4.m3.1.1.cmml"><mi id="alg1.l4.m3.1.1.3" xref="alg1.l4.m3.1.1.3.cmml">s</mi><mo id="alg1.l4.m3.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg1.l4.m3.1.1.2.cmml">×</mo><mi id="alg1.l4.m3.1.1.4" xref="alg1.l4.m3.1.1.4.cmml">L</mi><mo id="alg1.l4.m3.1.1.2a" lspace="0.222em" rspace="0.222em" xref="alg1.l4.m3.1.1.2.cmml">×</mo><mrow id="alg1.l4.m3.1.1.1.1" xref="alg1.l4.m3.1.1.1.1.1.cmml"><mo id="alg1.l4.m3.1.1.1.1.2" stretchy="false" xref="alg1.l4.m3.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m3.1.1.1.1.1" xref="alg1.l4.m3.1.1.1.1.1.cmml"><mrow id="alg1.l4.m3.1.1.1.1.1.2" xref="alg1.l4.m3.1.1.1.1.1.2.cmml"><mn id="alg1.l4.m3.1.1.1.1.1.2.2" xref="alg1.l4.m3.1.1.1.1.1.2.2.cmml">2</mn><mo id="alg1.l4.m3.1.1.1.1.1.2.1" xref="alg1.l4.m3.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l4.m3.1.1.1.1.1.2.3" xref="alg1.l4.m3.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="alg1.l4.m3.1.1.1.1.1.1" xref="alg1.l4.m3.1.1.1.1.1.1.cmml">−</mo><mn id="alg1.l4.m3.1.1.1.1.1.3" xref="alg1.l4.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l4.m3.1.1.1.1.3" stretchy="false" xref="alg1.l4.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.1b"><apply id="alg1.l4.m3.1.1.cmml" xref="alg1.l4.m3.1.1"><times id="alg1.l4.m3.1.1.2.cmml" xref="alg1.l4.m3.1.1.2"></times><ci id="alg1.l4.m3.1.1.3.cmml" xref="alg1.l4.m3.1.1.3">𝑠</ci><ci id="alg1.l4.m3.1.1.4.cmml" xref="alg1.l4.m3.1.1.4">𝐿</ci><apply id="alg1.l4.m3.1.1.1.1.1.cmml" xref="alg1.l4.m3.1.1.1.1"><minus id="alg1.l4.m3.1.1.1.1.1.1.cmml" xref="alg1.l4.m3.1.1.1.1.1.1"></minus><apply id="alg1.l4.m3.1.1.1.1.1.2.cmml" xref="alg1.l4.m3.1.1.1.1.1.2"><times id="alg1.l4.m3.1.1.1.1.1.2.1.cmml" xref="alg1.l4.m3.1.1.1.1.1.2.1"></times><cn id="alg1.l4.m3.1.1.1.1.1.2.2.cmml" type="integer" xref="alg1.l4.m3.1.1.1.1.1.2.2">2</cn><ci id="alg1.l4.m3.1.1.1.1.1.2.3.cmml" xref="alg1.l4.m3.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="alg1.l4.m3.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l4.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.1c">s\times L\times(2L-1)</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m3.1d">italic_s × italic_L × ( 2 italic_L - 1 )</annotation></semantics></math> and that the matrix multiplication is on the last two dimensions of the tensor.

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>  <math alttext="T_{S}=\operatorname{SoftMax}(T_{A}+T_{M})" class="ltx_Math" display="inline" id="alg1.l5.m1.2"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml"><msub id="alg1.l5.m1.2.2.3" xref="alg1.l5.m1.2.2.3.cmml"><mi id="alg1.l5.m1.2.2.3.2" xref="alg1.l5.m1.2.2.3.2.cmml">T</mi><mi id="alg1.l5.m1.2.2.3.3" xref="alg1.l5.m1.2.2.3.3.cmml">S</mi></msub><mo id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.2.cmml">=</mo><mrow id="alg1.l5.m1.2.2.1.1" xref="alg1.l5.m1.2.2.1.2.cmml"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">SoftMax</mi><mo id="alg1.l5.m1.2.2.1.1a" xref="alg1.l5.m1.2.2.1.2.cmml">⁡</mo><mrow id="alg1.l5.m1.2.2.1.1.1" xref="alg1.l5.m1.2.2.1.2.cmml"><mo id="alg1.l5.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l5.m1.2.2.1.2.cmml">(</mo><mrow id="alg1.l5.m1.2.2.1.1.1.1" xref="alg1.l5.m1.2.2.1.1.1.1.cmml"><msub id="alg1.l5.m1.2.2.1.1.1.1.2" xref="alg1.l5.m1.2.2.1.1.1.1.2.cmml"><mi id="alg1.l5.m1.2.2.1.1.1.1.2.2" xref="alg1.l5.m1.2.2.1.1.1.1.2.2.cmml">T</mi><mi id="alg1.l5.m1.2.2.1.1.1.1.2.3" xref="alg1.l5.m1.2.2.1.1.1.1.2.3.cmml">A</mi></msub><mo id="alg1.l5.m1.2.2.1.1.1.1.1" xref="alg1.l5.m1.2.2.1.1.1.1.1.cmml">+</mo><msub id="alg1.l5.m1.2.2.1.1.1.1.3" xref="alg1.l5.m1.2.2.1.1.1.1.3.cmml"><mi id="alg1.l5.m1.2.2.1.1.1.1.3.2" xref="alg1.l5.m1.2.2.1.1.1.1.3.2.cmml">T</mi><mi id="alg1.l5.m1.2.2.1.1.1.1.3.3" xref="alg1.l5.m1.2.2.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="alg1.l5.m1.2.2.1.1.1.3" stretchy="false" xref="alg1.l5.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2"><eq id="alg1.l5.m1.2.2.2.cmml" xref="alg1.l5.m1.2.2.2"></eq><apply id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.3.1.cmml" xref="alg1.l5.m1.2.2.3">subscript</csymbol><ci id="alg1.l5.m1.2.2.3.2.cmml" xref="alg1.l5.m1.2.2.3.2">𝑇</ci><ci id="alg1.l5.m1.2.2.3.3.cmml" xref="alg1.l5.m1.2.2.3.3">𝑆</ci></apply><apply id="alg1.l5.m1.2.2.1.2.cmml" xref="alg1.l5.m1.2.2.1.1"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">SoftMax</ci><apply id="alg1.l5.m1.2.2.1.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.1"><plus id="alg1.l5.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.1"></plus><apply id="alg1.l5.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.1.1.1.1.2.2.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.2.2">𝑇</ci><ci id="alg1.l5.m1.2.2.1.1.1.1.2.3.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.2.3">𝐴</ci></apply><apply id="alg1.l5.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.2.2.1.1.1.1.3.2.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.3.2">𝑇</ci><ci id="alg1.l5.m1.2.2.1.1.1.1.3.3.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.3.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">T_{S}=\operatorname{SoftMax}(T_{A}+T_{M})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.2d">italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = roman_SoftMax ( italic_T start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT + italic_T start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>  We compute the tensor <math alttext="T_{R}=T_{S}\cdot T_{V}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">T</mi><mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">R</mi></msub><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">=</mo><mrow id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><msub id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml"><mi id="alg1.l6.m1.1.1.3.2.2" xref="alg1.l6.m1.1.1.3.2.2.cmml">T</mi><mi id="alg1.l6.m1.1.1.3.2.3" xref="alg1.l6.m1.1.1.3.2.3.cmml">S</mi></msub><mo id="alg1.l6.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="alg1.l6.m1.1.1.3.1.cmml">⋅</mo><msub id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml"><mi id="alg1.l6.m1.1.1.3.3.2" xref="alg1.l6.m1.1.1.3.3.2.cmml">T</mi><mi id="alg1.l6.m1.1.1.3.3.3" xref="alg1.l6.m1.1.1.3.3.3.cmml">V</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><eq id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></eq><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">𝑇</ci><ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">𝑅</ci></apply><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><ci id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3.1">⋅</ci><apply id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.3.2.2">𝑇</ci><ci id="alg1.l6.m1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.3.2.3">𝑆</ci></apply><apply id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.3.1.cmml" xref="alg1.l6.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.3.2.cmml" xref="alg1.l6.m1.1.1.3.3.2">𝑇</ci><ci id="alg1.l6.m1.1.1.3.3.3.cmml" xref="alg1.l6.m1.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">T_{R}=T_{S}\cdot T_{V}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_T start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT = italic_T start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ⋅ italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>, which has dimensions <math alttext="s\times L\times d_{model}" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><mrow id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">s</mi><mo id="alg1.l6.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="alg1.l6.m2.1.1.1.cmml">×</mo><mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">L</mi><mo id="alg1.l6.m2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="alg1.l6.m2.1.1.1.cmml">×</mo><msub id="alg1.l6.m2.1.1.4" xref="alg1.l6.m2.1.1.4.cmml"><mi id="alg1.l6.m2.1.1.4.2" xref="alg1.l6.m2.1.1.4.2.cmml">d</mi><mrow id="alg1.l6.m2.1.1.4.3" xref="alg1.l6.m2.1.1.4.3.cmml"><mi id="alg1.l6.m2.1.1.4.3.2" xref="alg1.l6.m2.1.1.4.3.2.cmml">m</mi><mo id="alg1.l6.m2.1.1.4.3.1" xref="alg1.l6.m2.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.4.3.3" xref="alg1.l6.m2.1.1.4.3.3.cmml">o</mi><mo id="alg1.l6.m2.1.1.4.3.1a" xref="alg1.l6.m2.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.4.3.4" xref="alg1.l6.m2.1.1.4.3.4.cmml">d</mi><mo id="alg1.l6.m2.1.1.4.3.1b" xref="alg1.l6.m2.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.4.3.5" xref="alg1.l6.m2.1.1.4.3.5.cmml">e</mi><mo id="alg1.l6.m2.1.1.4.3.1c" xref="alg1.l6.m2.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.4.3.6" xref="alg1.l6.m2.1.1.4.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><times id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1.1"></times><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝑠</ci><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">𝐿</ci><apply id="alg1.l6.m2.1.1.4.cmml" xref="alg1.l6.m2.1.1.4"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.4.1.cmml" xref="alg1.l6.m2.1.1.4">subscript</csymbol><ci id="alg1.l6.m2.1.1.4.2.cmml" xref="alg1.l6.m2.1.1.4.2">𝑑</ci><apply id="alg1.l6.m2.1.1.4.3.cmml" xref="alg1.l6.m2.1.1.4.3"><times id="alg1.l6.m2.1.1.4.3.1.cmml" xref="alg1.l6.m2.1.1.4.3.1"></times><ci id="alg1.l6.m2.1.1.4.3.2.cmml" xref="alg1.l6.m2.1.1.4.3.2">𝑚</ci><ci id="alg1.l6.m2.1.1.4.3.3.cmml" xref="alg1.l6.m2.1.1.4.3.3">𝑜</ci><ci id="alg1.l6.m2.1.1.4.3.4.cmml" xref="alg1.l6.m2.1.1.4.3.4">𝑑</ci><ci id="alg1.l6.m2.1.1.4.3.5.cmml" xref="alg1.l6.m2.1.1.4.3.5">𝑒</ci><ci id="alg1.l6.m2.1.1.4.3.6.cmml" xref="alg1.l6.m2.1.1.4.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">s\times L\times d_{model}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">italic_s × italic_L × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l7.1">return</span>  Concatenate <math alttext="T_{R}[0,\cdot,\cdot],\ldots,T_{R}[s-1,\cdot,\cdot]" class="ltx_Math" display="inline" id="alg1.l7.m1.8"><semantics id="alg1.l7.m1.8a"><mrow id="alg1.l7.m1.8.8.2" xref="alg1.l7.m1.8.8.3.cmml"><mrow id="alg1.l7.m1.7.7.1.1" xref="alg1.l7.m1.7.7.1.1.cmml"><msub id="alg1.l7.m1.7.7.1.1.2" xref="alg1.l7.m1.7.7.1.1.2.cmml"><mi id="alg1.l7.m1.7.7.1.1.2.2" xref="alg1.l7.m1.7.7.1.1.2.2.cmml">T</mi><mi id="alg1.l7.m1.7.7.1.1.2.3" xref="alg1.l7.m1.7.7.1.1.2.3.cmml">R</mi></msub><mo id="alg1.l7.m1.7.7.1.1.1" xref="alg1.l7.m1.7.7.1.1.1.cmml">⁢</mo><mrow id="alg1.l7.m1.7.7.1.1.3.2" xref="alg1.l7.m1.7.7.1.1.3.1.cmml"><mo id="alg1.l7.m1.7.7.1.1.3.2.1" stretchy="false" xref="alg1.l7.m1.7.7.1.1.3.1.cmml">[</mo><mn id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">0</mn><mo id="alg1.l7.m1.7.7.1.1.3.2.2" rspace="0em" xref="alg1.l7.m1.7.7.1.1.3.1.cmml">,</mo><mo id="alg1.l7.m1.2.2" lspace="0em" rspace="0em" xref="alg1.l7.m1.2.2.cmml">⋅</mo><mo id="alg1.l7.m1.7.7.1.1.3.2.3" rspace="0em" xref="alg1.l7.m1.7.7.1.1.3.1.cmml">,</mo><mo id="alg1.l7.m1.3.3" lspace="0em" rspace="0em" xref="alg1.l7.m1.3.3.cmml">⋅</mo><mo id="alg1.l7.m1.7.7.1.1.3.2.4" stretchy="false" xref="alg1.l7.m1.7.7.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="alg1.l7.m1.8.8.2.3" xref="alg1.l7.m1.8.8.3.cmml">,</mo><mi id="alg1.l7.m1.6.6" mathvariant="normal" xref="alg1.l7.m1.6.6.cmml">…</mi><mo id="alg1.l7.m1.8.8.2.4" xref="alg1.l7.m1.8.8.3.cmml">,</mo><mrow id="alg1.l7.m1.8.8.2.2" xref="alg1.l7.m1.8.8.2.2.cmml"><msub id="alg1.l7.m1.8.8.2.2.3" xref="alg1.l7.m1.8.8.2.2.3.cmml"><mi id="alg1.l7.m1.8.8.2.2.3.2" xref="alg1.l7.m1.8.8.2.2.3.2.cmml">T</mi><mi id="alg1.l7.m1.8.8.2.2.3.3" xref="alg1.l7.m1.8.8.2.2.3.3.cmml">R</mi></msub><mo id="alg1.l7.m1.8.8.2.2.2" xref="alg1.l7.m1.8.8.2.2.2.cmml">⁢</mo><mrow id="alg1.l7.m1.8.8.2.2.1.1" xref="alg1.l7.m1.8.8.2.2.1.2.cmml"><mo id="alg1.l7.m1.8.8.2.2.1.1.2" stretchy="false" xref="alg1.l7.m1.8.8.2.2.1.2.cmml">[</mo><mrow id="alg1.l7.m1.8.8.2.2.1.1.1" xref="alg1.l7.m1.8.8.2.2.1.1.1.cmml"><mi id="alg1.l7.m1.8.8.2.2.1.1.1.2" xref="alg1.l7.m1.8.8.2.2.1.1.1.2.cmml">s</mi><mo id="alg1.l7.m1.8.8.2.2.1.1.1.1" xref="alg1.l7.m1.8.8.2.2.1.1.1.1.cmml">−</mo><mn id="alg1.l7.m1.8.8.2.2.1.1.1.3" xref="alg1.l7.m1.8.8.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l7.m1.8.8.2.2.1.1.3" rspace="0em" xref="alg1.l7.m1.8.8.2.2.1.2.cmml">,</mo><mo id="alg1.l7.m1.4.4" lspace="0em" rspace="0em" xref="alg1.l7.m1.4.4.cmml">⋅</mo><mo id="alg1.l7.m1.8.8.2.2.1.1.4" rspace="0em" xref="alg1.l7.m1.8.8.2.2.1.2.cmml">,</mo><mo id="alg1.l7.m1.5.5" lspace="0em" rspace="0em" xref="alg1.l7.m1.5.5.cmml">⋅</mo><mo id="alg1.l7.m1.8.8.2.2.1.1.5" stretchy="false" xref="alg1.l7.m1.8.8.2.2.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.8b"><list id="alg1.l7.m1.8.8.3.cmml" xref="alg1.l7.m1.8.8.2"><apply id="alg1.l7.m1.7.7.1.1.cmml" xref="alg1.l7.m1.7.7.1.1"><times id="alg1.l7.m1.7.7.1.1.1.cmml" xref="alg1.l7.m1.7.7.1.1.1"></times><apply id="alg1.l7.m1.7.7.1.1.2.cmml" xref="alg1.l7.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.7.7.1.1.2.1.cmml" xref="alg1.l7.m1.7.7.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.7.7.1.1.2.2.cmml" xref="alg1.l7.m1.7.7.1.1.2.2">𝑇</ci><ci id="alg1.l7.m1.7.7.1.1.2.3.cmml" xref="alg1.l7.m1.7.7.1.1.2.3">𝑅</ci></apply><list id="alg1.l7.m1.7.7.1.1.3.1.cmml" xref="alg1.l7.m1.7.7.1.1.3.2"><cn id="alg1.l7.m1.1.1.cmml" type="integer" xref="alg1.l7.m1.1.1">0</cn><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">⋅</ci><ci id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3">⋅</ci></list></apply><ci id="alg1.l7.m1.6.6.cmml" xref="alg1.l7.m1.6.6">…</ci><apply id="alg1.l7.m1.8.8.2.2.cmml" xref="alg1.l7.m1.8.8.2.2"><times id="alg1.l7.m1.8.8.2.2.2.cmml" xref="alg1.l7.m1.8.8.2.2.2"></times><apply id="alg1.l7.m1.8.8.2.2.3.cmml" xref="alg1.l7.m1.8.8.2.2.3"><csymbol cd="ambiguous" id="alg1.l7.m1.8.8.2.2.3.1.cmml" xref="alg1.l7.m1.8.8.2.2.3">subscript</csymbol><ci id="alg1.l7.m1.8.8.2.2.3.2.cmml" xref="alg1.l7.m1.8.8.2.2.3.2">𝑇</ci><ci id="alg1.l7.m1.8.8.2.2.3.3.cmml" xref="alg1.l7.m1.8.8.2.2.3.3">𝑅</ci></apply><list id="alg1.l7.m1.8.8.2.2.1.2.cmml" xref="alg1.l7.m1.8.8.2.2.1.1"><apply id="alg1.l7.m1.8.8.2.2.1.1.1.cmml" xref="alg1.l7.m1.8.8.2.2.1.1.1"><minus id="alg1.l7.m1.8.8.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.8.8.2.2.1.1.1.1"></minus><ci id="alg1.l7.m1.8.8.2.2.1.1.1.2.cmml" xref="alg1.l7.m1.8.8.2.2.1.1.1.2">𝑠</ci><cn id="alg1.l7.m1.8.8.2.2.1.1.1.3.cmml" type="integer" xref="alg1.l7.m1.8.8.2.2.1.1.1.3">1</cn></apply><ci id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4">⋅</ci><ci id="alg1.l7.m1.5.5.cmml" xref="alg1.l7.m1.5.5">⋅</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.8c">T_{R}[0,\cdot,\cdot],\ldots,T_{R}[s-1,\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.8d">italic_T start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT [ 0 , ⋅ , ⋅ ] , … , italic_T start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT [ italic_s - 1 , ⋅ , ⋅ ]</annotation></semantics></math> on the dimension corresponding to <math alttext="L" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">italic_L</annotation></semantics></math>, obtaining a tensor with dimensions <math alttext="n\times d_{model}" class="ltx_Math" display="inline" id="alg1.l7.m3.1"><semantics id="alg1.l7.m3.1a"><mrow id="alg1.l7.m3.1.1" xref="alg1.l7.m3.1.1.cmml"><mi id="alg1.l7.m3.1.1.2" xref="alg1.l7.m3.1.1.2.cmml">n</mi><mo id="alg1.l7.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="alg1.l7.m3.1.1.1.cmml">×</mo><msub id="alg1.l7.m3.1.1.3" xref="alg1.l7.m3.1.1.3.cmml"><mi id="alg1.l7.m3.1.1.3.2" xref="alg1.l7.m3.1.1.3.2.cmml">d</mi><mrow id="alg1.l7.m3.1.1.3.3" xref="alg1.l7.m3.1.1.3.3.cmml"><mi id="alg1.l7.m3.1.1.3.3.2" xref="alg1.l7.m3.1.1.3.3.2.cmml">m</mi><mo id="alg1.l7.m3.1.1.3.3.1" xref="alg1.l7.m3.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l7.m3.1.1.3.3.3" xref="alg1.l7.m3.1.1.3.3.3.cmml">o</mi><mo id="alg1.l7.m3.1.1.3.3.1a" xref="alg1.l7.m3.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l7.m3.1.1.3.3.4" xref="alg1.l7.m3.1.1.3.3.4.cmml">d</mi><mo id="alg1.l7.m3.1.1.3.3.1b" xref="alg1.l7.m3.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l7.m3.1.1.3.3.5" xref="alg1.l7.m3.1.1.3.3.5.cmml">e</mi><mo id="alg1.l7.m3.1.1.3.3.1c" xref="alg1.l7.m3.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l7.m3.1.1.3.3.6" xref="alg1.l7.m3.1.1.3.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.1b"><apply id="alg1.l7.m3.1.1.cmml" xref="alg1.l7.m3.1.1"><times id="alg1.l7.m3.1.1.1.cmml" xref="alg1.l7.m3.1.1.1"></times><ci id="alg1.l7.m3.1.1.2.cmml" xref="alg1.l7.m3.1.1.2">𝑛</ci><apply id="alg1.l7.m3.1.1.3.cmml" xref="alg1.l7.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m3.1.1.3.1.cmml" xref="alg1.l7.m3.1.1.3">subscript</csymbol><ci id="alg1.l7.m3.1.1.3.2.cmml" xref="alg1.l7.m3.1.1.3.2">𝑑</ci><apply id="alg1.l7.m3.1.1.3.3.cmml" xref="alg1.l7.m3.1.1.3.3"><times id="alg1.l7.m3.1.1.3.3.1.cmml" xref="alg1.l7.m3.1.1.3.3.1"></times><ci id="alg1.l7.m3.1.1.3.3.2.cmml" xref="alg1.l7.m3.1.1.3.3.2">𝑚</ci><ci id="alg1.l7.m3.1.1.3.3.3.cmml" xref="alg1.l7.m3.1.1.3.3.3">𝑜</ci><ci id="alg1.l7.m3.1.1.3.3.4.cmml" xref="alg1.l7.m3.1.1.3.3.4">𝑑</ci><ci id="alg1.l7.m3.1.1.3.3.5.cmml" xref="alg1.l7.m3.1.1.3.3.5">𝑒</ci><ci id="alg1.l7.m3.1.1.3.3.6.cmml" xref="alg1.l7.m3.1.1.3.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.1c">n\times d_{model}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m3.1d">italic_n × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. This is the output of the algorithm.

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.3.1.1">Algorithm 1</span> </span> Efficient implementation of LAM  with tensor algebra</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p16">
<p class="ltx_p" id="S3.p16.21">The computation of <math alttext="T_{Q}" class="ltx_Math" display="inline" id="S3.p16.1.m1.1"><semantics id="S3.p16.1.m1.1a"><msub id="S3.p16.1.m1.1.1" xref="S3.p16.1.m1.1.1.cmml"><mi id="S3.p16.1.m1.1.1.2" xref="S3.p16.1.m1.1.1.2.cmml">T</mi><mi id="S3.p16.1.m1.1.1.3" xref="S3.p16.1.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p16.1.m1.1b"><apply id="S3.p16.1.m1.1.1.cmml" xref="S3.p16.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p16.1.m1.1.1.1.cmml" xref="S3.p16.1.m1.1.1">subscript</csymbol><ci id="S3.p16.1.m1.1.1.2.cmml" xref="S3.p16.1.m1.1.1.2">𝑇</ci><ci id="S3.p16.1.m1.1.1.3.cmml" xref="S3.p16.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.1.m1.1c">T_{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.p16.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="T_{K}" class="ltx_Math" display="inline" id="S3.p16.2.m2.1"><semantics id="S3.p16.2.m2.1a"><msub id="S3.p16.2.m2.1.1" xref="S3.p16.2.m2.1.1.cmml"><mi id="S3.p16.2.m2.1.1.2" xref="S3.p16.2.m2.1.1.2.cmml">T</mi><mi id="S3.p16.2.m2.1.1.3" xref="S3.p16.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p16.2.m2.1b"><apply id="S3.p16.2.m2.1.1.cmml" xref="S3.p16.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p16.2.m2.1.1.1.cmml" xref="S3.p16.2.m2.1.1">subscript</csymbol><ci id="S3.p16.2.m2.1.1.2.cmml" xref="S3.p16.2.m2.1.1.2">𝑇</ci><ci id="S3.p16.2.m2.1.1.3.cmml" xref="S3.p16.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.2.m2.1c">T_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.p16.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="T_{V}" class="ltx_Math" display="inline" id="S3.p16.3.m3.1"><semantics id="S3.p16.3.m3.1a"><msub id="S3.p16.3.m3.1.1" xref="S3.p16.3.m3.1.1.cmml"><mi id="S3.p16.3.m3.1.1.2" xref="S3.p16.3.m3.1.1.2.cmml">T</mi><mi id="S3.p16.3.m3.1.1.3" xref="S3.p16.3.m3.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p16.3.m3.1b"><apply id="S3.p16.3.m3.1.1.cmml" xref="S3.p16.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p16.3.m3.1.1.1.cmml" xref="S3.p16.3.m3.1.1">subscript</csymbol><ci id="S3.p16.3.m3.1.1.2.cmml" xref="S3.p16.3.m3.1.1.2">𝑇</ci><ci id="S3.p16.3.m3.1.1.3.cmml" xref="S3.p16.3.m3.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.3.m3.1c">T_{V}</annotation><annotation encoding="application/x-llamapun" id="S3.p16.3.m3.1d">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> can be performed in linear time on the sizes of <math alttext="Q,K" class="ltx_Math" display="inline" id="S3.p16.4.m4.2"><semantics id="S3.p16.4.m4.2a"><mrow id="S3.p16.4.m4.2.3.2" xref="S3.p16.4.m4.2.3.1.cmml"><mi id="S3.p16.4.m4.1.1" xref="S3.p16.4.m4.1.1.cmml">Q</mi><mo id="S3.p16.4.m4.2.3.2.1" xref="S3.p16.4.m4.2.3.1.cmml">,</mo><mi id="S3.p16.4.m4.2.2" xref="S3.p16.4.m4.2.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p16.4.m4.2b"><list id="S3.p16.4.m4.2.3.1.cmml" xref="S3.p16.4.m4.2.3.2"><ci id="S3.p16.4.m4.1.1.cmml" xref="S3.p16.4.m4.1.1">𝑄</ci><ci id="S3.p16.4.m4.2.2.cmml" xref="S3.p16.4.m4.2.2">𝐾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.4.m4.2c">Q,K</annotation><annotation encoding="application/x-llamapun" id="S3.p16.4.m4.2d">italic_Q , italic_K</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S3.p16.5.m5.1"><semantics id="S3.p16.5.m5.1a"><mi id="S3.p16.5.m5.1.1" xref="S3.p16.5.m5.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.p16.5.m5.1b"><ci id="S3.p16.5.m5.1.1.cmml" xref="S3.p16.5.m5.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.5.m5.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.p16.5.m5.1d">italic_V</annotation></semantics></math>. In order to do so, we pre-compute a tensor with the indexes that we want to extract from <math alttext="Q,K" class="ltx_Math" display="inline" id="S3.p16.6.m6.2"><semantics id="S3.p16.6.m6.2a"><mrow id="S3.p16.6.m6.2.3.2" xref="S3.p16.6.m6.2.3.1.cmml"><mi id="S3.p16.6.m6.1.1" xref="S3.p16.6.m6.1.1.cmml">Q</mi><mo id="S3.p16.6.m6.2.3.2.1" xref="S3.p16.6.m6.2.3.1.cmml">,</mo><mi id="S3.p16.6.m6.2.2" xref="S3.p16.6.m6.2.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p16.6.m6.2b"><list id="S3.p16.6.m6.2.3.1.cmml" xref="S3.p16.6.m6.2.3.2"><ci id="S3.p16.6.m6.1.1.cmml" xref="S3.p16.6.m6.1.1">𝑄</ci><ci id="S3.p16.6.m6.2.2.cmml" xref="S3.p16.6.m6.2.2">𝐾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.6.m6.2c">Q,K</annotation><annotation encoding="application/x-llamapun" id="S3.p16.6.m6.2d">italic_Q , italic_K</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S3.p16.7.m7.1"><semantics id="S3.p16.7.m7.1a"><mi id="S3.p16.7.m7.1.1" xref="S3.p16.7.m7.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.p16.7.m7.1b"><ci id="S3.p16.7.m7.1.1.cmml" xref="S3.p16.7.m7.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.7.m7.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.p16.7.m7.1d">italic_V</annotation></semantics></math> for each one of the <math alttext="s" class="ltx_Math" display="inline" id="S3.p16.8.m8.1"><semantics id="S3.p16.8.m8.1a"><mi id="S3.p16.8.m8.1.1" xref="S3.p16.8.m8.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.p16.8.m8.1b"><ci id="S3.p16.8.m8.1.1.cmml" xref="S3.p16.8.m8.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.8.m8.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.p16.8.m8.1d">italic_s</annotation></semantics></math> blocks of <math alttext="T_{Q},T_{K}" class="ltx_Math" display="inline" id="S3.p16.9.m9.2"><semantics id="S3.p16.9.m9.2a"><mrow id="S3.p16.9.m9.2.2.2" xref="S3.p16.9.m9.2.2.3.cmml"><msub id="S3.p16.9.m9.1.1.1.1" xref="S3.p16.9.m9.1.1.1.1.cmml"><mi id="S3.p16.9.m9.1.1.1.1.2" xref="S3.p16.9.m9.1.1.1.1.2.cmml">T</mi><mi id="S3.p16.9.m9.1.1.1.1.3" xref="S3.p16.9.m9.1.1.1.1.3.cmml">Q</mi></msub><mo id="S3.p16.9.m9.2.2.2.3" xref="S3.p16.9.m9.2.2.3.cmml">,</mo><msub id="S3.p16.9.m9.2.2.2.2" xref="S3.p16.9.m9.2.2.2.2.cmml"><mi id="S3.p16.9.m9.2.2.2.2.2" xref="S3.p16.9.m9.2.2.2.2.2.cmml">T</mi><mi id="S3.p16.9.m9.2.2.2.2.3" xref="S3.p16.9.m9.2.2.2.2.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p16.9.m9.2b"><list id="S3.p16.9.m9.2.2.3.cmml" xref="S3.p16.9.m9.2.2.2"><apply id="S3.p16.9.m9.1.1.1.1.cmml" xref="S3.p16.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S3.p16.9.m9.1.1.1.1.1.cmml" xref="S3.p16.9.m9.1.1.1.1">subscript</csymbol><ci id="S3.p16.9.m9.1.1.1.1.2.cmml" xref="S3.p16.9.m9.1.1.1.1.2">𝑇</ci><ci id="S3.p16.9.m9.1.1.1.1.3.cmml" xref="S3.p16.9.m9.1.1.1.1.3">𝑄</ci></apply><apply id="S3.p16.9.m9.2.2.2.2.cmml" xref="S3.p16.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S3.p16.9.m9.2.2.2.2.1.cmml" xref="S3.p16.9.m9.2.2.2.2">subscript</csymbol><ci id="S3.p16.9.m9.2.2.2.2.2.cmml" xref="S3.p16.9.m9.2.2.2.2.2">𝑇</ci><ci id="S3.p16.9.m9.2.2.2.2.3.cmml" xref="S3.p16.9.m9.2.2.2.2.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.9.m9.2c">T_{Q},T_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.p16.9.m9.2d">italic_T start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="T_{V}" class="ltx_Math" display="inline" id="S3.p16.10.m10.1"><semantics id="S3.p16.10.m10.1a"><msub id="S3.p16.10.m10.1.1" xref="S3.p16.10.m10.1.1.cmml"><mi id="S3.p16.10.m10.1.1.2" xref="S3.p16.10.m10.1.1.2.cmml">T</mi><mi id="S3.p16.10.m10.1.1.3" xref="S3.p16.10.m10.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p16.10.m10.1b"><apply id="S3.p16.10.m10.1.1.cmml" xref="S3.p16.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p16.10.m10.1.1.1.cmml" xref="S3.p16.10.m10.1.1">subscript</csymbol><ci id="S3.p16.10.m10.1.1.2.cmml" xref="S3.p16.10.m10.1.1.2">𝑇</ci><ci id="S3.p16.10.m10.1.1.3.cmml" xref="S3.p16.10.m10.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.10.m10.1c">T_{V}</annotation><annotation encoding="application/x-llamapun" id="S3.p16.10.m10.1d">italic_T start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>. This allows us to implement <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#alg1" title="In 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a> in any environment for deep learning based on tensor algebra, see the repository<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/ari-dasci/S-LAM</span></span></span> for our Pytorch implementation. The case when <math alttext="L" class="ltx_Math" display="inline" id="S3.p16.11.m11.1"><semantics id="S3.p16.11.m11.1a"><mi id="S3.p16.11.m11.1.1" xref="S3.p16.11.m11.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p16.11.m11.1b"><ci id="S3.p16.11.m11.1.1.cmml" xref="S3.p16.11.m11.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.11.m11.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.p16.11.m11.1d">italic_L</annotation></semantics></math> does not divide <math alttext="n" class="ltx_Math" display="inline" id="S3.p16.12.m12.1"><semantics id="S3.p16.12.m12.1a"><mi id="S3.p16.12.m12.1.1" xref="S3.p16.12.m12.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p16.12.m12.1b"><ci id="S3.p16.12.m12.1.1.cmml" xref="S3.p16.12.m12.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.12.m12.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.p16.12.m12.1d">italic_n</annotation></semantics></math> is analogous, with the difference that the block <math alttext="s-1" class="ltx_Math" display="inline" id="S3.p16.13.m13.1"><semantics id="S3.p16.13.m13.1a"><mrow id="S3.p16.13.m13.1.1" xref="S3.p16.13.m13.1.1.cmml"><mi id="S3.p16.13.m13.1.1.2" xref="S3.p16.13.m13.1.1.2.cmml">s</mi><mo id="S3.p16.13.m13.1.1.1" xref="S3.p16.13.m13.1.1.1.cmml">−</mo><mn id="S3.p16.13.m13.1.1.3" xref="S3.p16.13.m13.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p16.13.m13.1b"><apply id="S3.p16.13.m13.1.1.cmml" xref="S3.p16.13.m13.1.1"><minus id="S3.p16.13.m13.1.1.1.cmml" xref="S3.p16.13.m13.1.1.1"></minus><ci id="S3.p16.13.m13.1.1.2.cmml" xref="S3.p16.13.m13.1.1.2">𝑠</ci><cn id="S3.p16.13.m13.1.1.3.cmml" type="integer" xref="S3.p16.13.m13.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.13.m13.1c">s-1</annotation><annotation encoding="application/x-llamapun" id="S3.p16.13.m13.1d">italic_s - 1</annotation></semantics></math> of <math alttext="Q" class="ltx_Math" display="inline" id="S3.p16.14.m14.1"><semantics id="S3.p16.14.m14.1a"><mi id="S3.p16.14.m14.1.1" xref="S3.p16.14.m14.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.p16.14.m14.1b"><ci id="S3.p16.14.m14.1.1.cmml" xref="S3.p16.14.m14.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.14.m14.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.p16.14.m14.1d">italic_Q</annotation></semantics></math>, <math alttext="K" class="ltx_Math" display="inline" id="S3.p16.15.m15.1"><semantics id="S3.p16.15.m15.1a"><mi id="S3.p16.15.m15.1.1" xref="S3.p16.15.m15.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p16.15.m15.1b"><ci id="S3.p16.15.m15.1.1.cmml" xref="S3.p16.15.m15.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.15.m15.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p16.15.m15.1d">italic_K</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S3.p16.16.m16.1"><semantics id="S3.p16.16.m16.1a"><mi id="S3.p16.16.m16.1.1" xref="S3.p16.16.m16.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.p16.16.m16.1b"><ci id="S3.p16.16.m16.1.1.cmml" xref="S3.p16.16.m16.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.16.m16.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.p16.16.m16.1d">italic_V</annotation></semantics></math> is treated separately in the code to account for the extra number of entries. That is, we use Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#alg1" title="Algorithm 1 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">1</span></a> to compute the first <math alttext="(s-1)L" class="ltx_Math" display="inline" id="S3.p16.17.m17.1"><semantics id="S3.p16.17.m17.1a"><mrow id="S3.p16.17.m17.1.1" xref="S3.p16.17.m17.1.1.cmml"><mrow id="S3.p16.17.m17.1.1.1.1" xref="S3.p16.17.m17.1.1.1.1.1.cmml"><mo id="S3.p16.17.m17.1.1.1.1.2" stretchy="false" xref="S3.p16.17.m17.1.1.1.1.1.cmml">(</mo><mrow id="S3.p16.17.m17.1.1.1.1.1" xref="S3.p16.17.m17.1.1.1.1.1.cmml"><mi id="S3.p16.17.m17.1.1.1.1.1.2" xref="S3.p16.17.m17.1.1.1.1.1.2.cmml">s</mi><mo id="S3.p16.17.m17.1.1.1.1.1.1" xref="S3.p16.17.m17.1.1.1.1.1.1.cmml">−</mo><mn id="S3.p16.17.m17.1.1.1.1.1.3" xref="S3.p16.17.m17.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p16.17.m17.1.1.1.1.3" stretchy="false" xref="S3.p16.17.m17.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p16.17.m17.1.1.2" xref="S3.p16.17.m17.1.1.2.cmml">⁢</mo><mi id="S3.p16.17.m17.1.1.3" xref="S3.p16.17.m17.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p16.17.m17.1b"><apply id="S3.p16.17.m17.1.1.cmml" xref="S3.p16.17.m17.1.1"><times id="S3.p16.17.m17.1.1.2.cmml" xref="S3.p16.17.m17.1.1.2"></times><apply id="S3.p16.17.m17.1.1.1.1.1.cmml" xref="S3.p16.17.m17.1.1.1.1"><minus id="S3.p16.17.m17.1.1.1.1.1.1.cmml" xref="S3.p16.17.m17.1.1.1.1.1.1"></minus><ci id="S3.p16.17.m17.1.1.1.1.1.2.cmml" xref="S3.p16.17.m17.1.1.1.1.1.2">𝑠</ci><cn id="S3.p16.17.m17.1.1.1.1.1.3.cmml" type="integer" xref="S3.p16.17.m17.1.1.1.1.1.3">1</cn></apply><ci id="S3.p16.17.m17.1.1.3.cmml" xref="S3.p16.17.m17.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.17.m17.1c">(s-1)L</annotation><annotation encoding="application/x-llamapun" id="S3.p16.17.m17.1d">( italic_s - 1 ) italic_L</annotation></semantics></math> rows of <math alttext="LAM(Q,K,V)" class="ltx_Math" display="inline" id="S3.p16.18.m18.3"><semantics id="S3.p16.18.m18.3a"><mrow id="S3.p16.18.m18.3.4" xref="S3.p16.18.m18.3.4.cmml"><mi id="S3.p16.18.m18.3.4.2" xref="S3.p16.18.m18.3.4.2.cmml">L</mi><mo id="S3.p16.18.m18.3.4.1" xref="S3.p16.18.m18.3.4.1.cmml">⁢</mo><mi id="S3.p16.18.m18.3.4.3" xref="S3.p16.18.m18.3.4.3.cmml">A</mi><mo id="S3.p16.18.m18.3.4.1a" xref="S3.p16.18.m18.3.4.1.cmml">⁢</mo><mi id="S3.p16.18.m18.3.4.4" xref="S3.p16.18.m18.3.4.4.cmml">M</mi><mo id="S3.p16.18.m18.3.4.1b" xref="S3.p16.18.m18.3.4.1.cmml">⁢</mo><mrow id="S3.p16.18.m18.3.4.5.2" xref="S3.p16.18.m18.3.4.5.1.cmml"><mo id="S3.p16.18.m18.3.4.5.2.1" stretchy="false" xref="S3.p16.18.m18.3.4.5.1.cmml">(</mo><mi id="S3.p16.18.m18.1.1" xref="S3.p16.18.m18.1.1.cmml">Q</mi><mo id="S3.p16.18.m18.3.4.5.2.2" xref="S3.p16.18.m18.3.4.5.1.cmml">,</mo><mi id="S3.p16.18.m18.2.2" xref="S3.p16.18.m18.2.2.cmml">K</mi><mo id="S3.p16.18.m18.3.4.5.2.3" xref="S3.p16.18.m18.3.4.5.1.cmml">,</mo><mi id="S3.p16.18.m18.3.3" xref="S3.p16.18.m18.3.3.cmml">V</mi><mo id="S3.p16.18.m18.3.4.5.2.4" stretchy="false" xref="S3.p16.18.m18.3.4.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p16.18.m18.3b"><apply id="S3.p16.18.m18.3.4.cmml" xref="S3.p16.18.m18.3.4"><times id="S3.p16.18.m18.3.4.1.cmml" xref="S3.p16.18.m18.3.4.1"></times><ci id="S3.p16.18.m18.3.4.2.cmml" xref="S3.p16.18.m18.3.4.2">𝐿</ci><ci id="S3.p16.18.m18.3.4.3.cmml" xref="S3.p16.18.m18.3.4.3">𝐴</ci><ci id="S3.p16.18.m18.3.4.4.cmml" xref="S3.p16.18.m18.3.4.4">𝑀</ci><vector id="S3.p16.18.m18.3.4.5.1.cmml" xref="S3.p16.18.m18.3.4.5.2"><ci id="S3.p16.18.m18.1.1.cmml" xref="S3.p16.18.m18.1.1">𝑄</ci><ci id="S3.p16.18.m18.2.2.cmml" xref="S3.p16.18.m18.2.2">𝐾</ci><ci id="S3.p16.18.m18.3.3.cmml" xref="S3.p16.18.m18.3.3">𝑉</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.18.m18.3c">LAM(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="S3.p16.18.m18.3d">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V )</annotation></semantics></math>, and compute the last <math alttext="n-(s-1)L" class="ltx_Math" display="inline" id="S3.p16.19.m19.1"><semantics id="S3.p16.19.m19.1a"><mrow id="S3.p16.19.m19.1.1" xref="S3.p16.19.m19.1.1.cmml"><mi id="S3.p16.19.m19.1.1.3" xref="S3.p16.19.m19.1.1.3.cmml">n</mi><mo id="S3.p16.19.m19.1.1.2" xref="S3.p16.19.m19.1.1.2.cmml">−</mo><mrow id="S3.p16.19.m19.1.1.1" xref="S3.p16.19.m19.1.1.1.cmml"><mrow id="S3.p16.19.m19.1.1.1.1.1" xref="S3.p16.19.m19.1.1.1.1.1.1.cmml"><mo id="S3.p16.19.m19.1.1.1.1.1.2" stretchy="false" xref="S3.p16.19.m19.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p16.19.m19.1.1.1.1.1.1" xref="S3.p16.19.m19.1.1.1.1.1.1.cmml"><mi id="S3.p16.19.m19.1.1.1.1.1.1.2" xref="S3.p16.19.m19.1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.p16.19.m19.1.1.1.1.1.1.1" xref="S3.p16.19.m19.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.p16.19.m19.1.1.1.1.1.1.3" xref="S3.p16.19.m19.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p16.19.m19.1.1.1.1.1.3" stretchy="false" xref="S3.p16.19.m19.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p16.19.m19.1.1.1.2" xref="S3.p16.19.m19.1.1.1.2.cmml">⁢</mo><mi id="S3.p16.19.m19.1.1.1.3" xref="S3.p16.19.m19.1.1.1.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p16.19.m19.1b"><apply id="S3.p16.19.m19.1.1.cmml" xref="S3.p16.19.m19.1.1"><minus id="S3.p16.19.m19.1.1.2.cmml" xref="S3.p16.19.m19.1.1.2"></minus><ci id="S3.p16.19.m19.1.1.3.cmml" xref="S3.p16.19.m19.1.1.3">𝑛</ci><apply id="S3.p16.19.m19.1.1.1.cmml" xref="S3.p16.19.m19.1.1.1"><times id="S3.p16.19.m19.1.1.1.2.cmml" xref="S3.p16.19.m19.1.1.1.2"></times><apply id="S3.p16.19.m19.1.1.1.1.1.1.cmml" xref="S3.p16.19.m19.1.1.1.1.1"><minus id="S3.p16.19.m19.1.1.1.1.1.1.1.cmml" xref="S3.p16.19.m19.1.1.1.1.1.1.1"></minus><ci id="S3.p16.19.m19.1.1.1.1.1.1.2.cmml" xref="S3.p16.19.m19.1.1.1.1.1.1.2">𝑠</ci><cn id="S3.p16.19.m19.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.p16.19.m19.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.p16.19.m19.1.1.1.3.cmml" xref="S3.p16.19.m19.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.19.m19.1c">n-(s-1)L</annotation><annotation encoding="application/x-llamapun" id="S3.p16.19.m19.1d">italic_n - ( italic_s - 1 ) italic_L</annotation></semantics></math> rows of <math alttext="LAM(Q,K,V)" class="ltx_Math" display="inline" id="S3.p16.20.m20.3"><semantics id="S3.p16.20.m20.3a"><mrow id="S3.p16.20.m20.3.4" xref="S3.p16.20.m20.3.4.cmml"><mi id="S3.p16.20.m20.3.4.2" xref="S3.p16.20.m20.3.4.2.cmml">L</mi><mo id="S3.p16.20.m20.3.4.1" xref="S3.p16.20.m20.3.4.1.cmml">⁢</mo><mi id="S3.p16.20.m20.3.4.3" xref="S3.p16.20.m20.3.4.3.cmml">A</mi><mo id="S3.p16.20.m20.3.4.1a" xref="S3.p16.20.m20.3.4.1.cmml">⁢</mo><mi id="S3.p16.20.m20.3.4.4" xref="S3.p16.20.m20.3.4.4.cmml">M</mi><mo id="S3.p16.20.m20.3.4.1b" xref="S3.p16.20.m20.3.4.1.cmml">⁢</mo><mrow id="S3.p16.20.m20.3.4.5.2" xref="S3.p16.20.m20.3.4.5.1.cmml"><mo id="S3.p16.20.m20.3.4.5.2.1" stretchy="false" xref="S3.p16.20.m20.3.4.5.1.cmml">(</mo><mi id="S3.p16.20.m20.1.1" xref="S3.p16.20.m20.1.1.cmml">Q</mi><mo id="S3.p16.20.m20.3.4.5.2.2" xref="S3.p16.20.m20.3.4.5.1.cmml">,</mo><mi id="S3.p16.20.m20.2.2" xref="S3.p16.20.m20.2.2.cmml">K</mi><mo id="S3.p16.20.m20.3.4.5.2.3" xref="S3.p16.20.m20.3.4.5.1.cmml">,</mo><mi id="S3.p16.20.m20.3.3" xref="S3.p16.20.m20.3.3.cmml">V</mi><mo id="S3.p16.20.m20.3.4.5.2.4" stretchy="false" xref="S3.p16.20.m20.3.4.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p16.20.m20.3b"><apply id="S3.p16.20.m20.3.4.cmml" xref="S3.p16.20.m20.3.4"><times id="S3.p16.20.m20.3.4.1.cmml" xref="S3.p16.20.m20.3.4.1"></times><ci id="S3.p16.20.m20.3.4.2.cmml" xref="S3.p16.20.m20.3.4.2">𝐿</ci><ci id="S3.p16.20.m20.3.4.3.cmml" xref="S3.p16.20.m20.3.4.3">𝐴</ci><ci id="S3.p16.20.m20.3.4.4.cmml" xref="S3.p16.20.m20.3.4.4">𝑀</ci><vector id="S3.p16.20.m20.3.4.5.1.cmml" xref="S3.p16.20.m20.3.4.5.2"><ci id="S3.p16.20.m20.1.1.cmml" xref="S3.p16.20.m20.1.1">𝑄</ci><ci id="S3.p16.20.m20.2.2.cmml" xref="S3.p16.20.m20.2.2">𝐾</ci><ci id="S3.p16.20.m20.3.3.cmml" xref="S3.p16.20.m20.3.3">𝑉</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.20.m20.3c">LAM(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="S3.p16.20.m20.3d">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V )</annotation></semantics></math> as a separate tensor computation. As this extra rows are most <math alttext="L-1" class="ltx_Math" display="inline" id="S3.p16.21.m21.1"><semantics id="S3.p16.21.m21.1a"><mrow id="S3.p16.21.m21.1.1" xref="S3.p16.21.m21.1.1.cmml"><mi id="S3.p16.21.m21.1.1.2" xref="S3.p16.21.m21.1.1.2.cmml">L</mi><mo id="S3.p16.21.m21.1.1.1" xref="S3.p16.21.m21.1.1.1.cmml">−</mo><mn id="S3.p16.21.m21.1.1.3" xref="S3.p16.21.m21.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p16.21.m21.1b"><apply id="S3.p16.21.m21.1.1.cmml" xref="S3.p16.21.m21.1.1"><minus id="S3.p16.21.m21.1.1.1.cmml" xref="S3.p16.21.m21.1.1.1"></minus><ci id="S3.p16.21.m21.1.1.2.cmml" xref="S3.p16.21.m21.1.1.2">𝐿</ci><cn id="S3.p16.21.m21.1.1.3.cmml" type="integer" xref="S3.p16.21.m21.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p16.21.m21.1c">L-1</annotation><annotation encoding="application/x-llamapun" id="S3.p16.21.m21.1d">italic_L - 1</annotation></semantics></math>, the complexity of the algorithm does not change. We refer to our code for details.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p17">
<p class="ltx_p" id="S3.p17.1">We can now prove the main theoretical result of this work on combining the lemmas proved in this section and counting how many steps are performed in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#alg1" title="Algorithm 1 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_theorem ltx_theorem_thm" id="Thmthm6">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm6.1.1.1">Theorem 6</span></span><span class="ltx_text ltx_font_bold" id="Thmthm6.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm6.p1">
<p class="ltx_p" id="Thmthm6.p1.2"><span class="ltx_text ltx_font_italic" id="Thmthm6.p1.2.2">Algorithm 1 computes <math alttext="\operatorname{LAM}(Q,K,V)" class="ltx_Math" display="inline" id="Thmthm6.p1.1.1.m1.4"><semantics id="Thmthm6.p1.1.1.m1.4a"><mrow id="Thmthm6.p1.1.1.m1.4.5.2" xref="Thmthm6.p1.1.1.m1.4.5.1.cmml"><mi id="Thmthm6.p1.1.1.m1.1.1" xref="Thmthm6.p1.1.1.m1.1.1.cmml">LAM</mi><mo id="Thmthm6.p1.1.1.m1.4.5.2a" xref="Thmthm6.p1.1.1.m1.4.5.1.cmml">⁡</mo><mrow id="Thmthm6.p1.1.1.m1.4.5.2.1" xref="Thmthm6.p1.1.1.m1.4.5.1.cmml"><mo id="Thmthm6.p1.1.1.m1.4.5.2.1.1" stretchy="false" xref="Thmthm6.p1.1.1.m1.4.5.1.cmml">(</mo><mi id="Thmthm6.p1.1.1.m1.2.2" xref="Thmthm6.p1.1.1.m1.2.2.cmml">Q</mi><mo id="Thmthm6.p1.1.1.m1.4.5.2.1.2" xref="Thmthm6.p1.1.1.m1.4.5.1.cmml">,</mo><mi id="Thmthm6.p1.1.1.m1.3.3" xref="Thmthm6.p1.1.1.m1.3.3.cmml">K</mi><mo id="Thmthm6.p1.1.1.m1.4.5.2.1.3" xref="Thmthm6.p1.1.1.m1.4.5.1.cmml">,</mo><mi id="Thmthm6.p1.1.1.m1.4.4" xref="Thmthm6.p1.1.1.m1.4.4.cmml">V</mi><mo id="Thmthm6.p1.1.1.m1.4.5.2.1.4" stretchy="false" xref="Thmthm6.p1.1.1.m1.4.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm6.p1.1.1.m1.4b"><apply id="Thmthm6.p1.1.1.m1.4.5.1.cmml" xref="Thmthm6.p1.1.1.m1.4.5.2"><ci id="Thmthm6.p1.1.1.m1.1.1.cmml" xref="Thmthm6.p1.1.1.m1.1.1">LAM</ci><ci id="Thmthm6.p1.1.1.m1.2.2.cmml" xref="Thmthm6.p1.1.1.m1.2.2">𝑄</ci><ci id="Thmthm6.p1.1.1.m1.3.3.cmml" xref="Thmthm6.p1.1.1.m1.3.3">𝐾</ci><ci id="Thmthm6.p1.1.1.m1.4.4.cmml" xref="Thmthm6.p1.1.1.m1.4.4">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm6.p1.1.1.m1.4c">\operatorname{LAM}(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="Thmthm6.p1.1.1.m1.4d">roman_LAM ( italic_Q , italic_K , italic_V )</annotation></semantics></math> in time and memory <math alttext="\Theta(nL)" class="ltx_Math" display="inline" id="Thmthm6.p1.2.2.m2.1"><semantics id="Thmthm6.p1.2.2.m2.1a"><mrow id="Thmthm6.p1.2.2.m2.1.1" xref="Thmthm6.p1.2.2.m2.1.1.cmml"><mi id="Thmthm6.p1.2.2.m2.1.1.3" mathvariant="normal" xref="Thmthm6.p1.2.2.m2.1.1.3.cmml">Θ</mi><mo id="Thmthm6.p1.2.2.m2.1.1.2" xref="Thmthm6.p1.2.2.m2.1.1.2.cmml">⁢</mo><mrow id="Thmthm6.p1.2.2.m2.1.1.1.1" xref="Thmthm6.p1.2.2.m2.1.1.1.1.1.cmml"><mo id="Thmthm6.p1.2.2.m2.1.1.1.1.2" stretchy="false" xref="Thmthm6.p1.2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm6.p1.2.2.m2.1.1.1.1.1" xref="Thmthm6.p1.2.2.m2.1.1.1.1.1.cmml"><mi id="Thmthm6.p1.2.2.m2.1.1.1.1.1.2" xref="Thmthm6.p1.2.2.m2.1.1.1.1.1.2.cmml">n</mi><mo id="Thmthm6.p1.2.2.m2.1.1.1.1.1.1" xref="Thmthm6.p1.2.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="Thmthm6.p1.2.2.m2.1.1.1.1.1.3" xref="Thmthm6.p1.2.2.m2.1.1.1.1.1.3.cmml">L</mi></mrow><mo id="Thmthm6.p1.2.2.m2.1.1.1.1.3" stretchy="false" xref="Thmthm6.p1.2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm6.p1.2.2.m2.1b"><apply id="Thmthm6.p1.2.2.m2.1.1.cmml" xref="Thmthm6.p1.2.2.m2.1.1"><times id="Thmthm6.p1.2.2.m2.1.1.2.cmml" xref="Thmthm6.p1.2.2.m2.1.1.2"></times><ci id="Thmthm6.p1.2.2.m2.1.1.3.cmml" xref="Thmthm6.p1.2.2.m2.1.1.3">Θ</ci><apply id="Thmthm6.p1.2.2.m2.1.1.1.1.1.cmml" xref="Thmthm6.p1.2.2.m2.1.1.1.1"><times id="Thmthm6.p1.2.2.m2.1.1.1.1.1.1.cmml" xref="Thmthm6.p1.2.2.m2.1.1.1.1.1.1"></times><ci id="Thmthm6.p1.2.2.m2.1.1.1.1.1.2.cmml" xref="Thmthm6.p1.2.2.m2.1.1.1.1.1.2">𝑛</ci><ci id="Thmthm6.p1.2.2.m2.1.1.1.1.1.3.cmml" xref="Thmthm6.p1.2.2.m2.1.1.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm6.p1.2.2.m2.1c">\Theta(nL)</annotation><annotation encoding="application/x-llamapun" id="Thmthm6.p1.2.2.m2.1d">roman_Θ ( italic_n italic_L )</annotation></semantics></math>, where time complexity is measured in the number of dot products of vectors performed.</span></p>
</div>
</div>
<div class="ltx_proof" id="S3.5">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.5.p1">
<p class="ltx_p" id="S3.5.p1.3">The fact that Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#alg1" title="Algorithm 1 ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">1</span></a> does indeed compute the attention scores that we are interested in and that the output is that of <math alttext="LAM(Q,K,V)" class="ltx_Math" display="inline" id="S3.5.p1.1.m1.3"><semantics id="S3.5.p1.1.m1.3a"><mrow id="S3.5.p1.1.m1.3.4" xref="S3.5.p1.1.m1.3.4.cmml"><mi id="S3.5.p1.1.m1.3.4.2" xref="S3.5.p1.1.m1.3.4.2.cmml">L</mi><mo id="S3.5.p1.1.m1.3.4.1" xref="S3.5.p1.1.m1.3.4.1.cmml">⁢</mo><mi id="S3.5.p1.1.m1.3.4.3" xref="S3.5.p1.1.m1.3.4.3.cmml">A</mi><mo id="S3.5.p1.1.m1.3.4.1a" xref="S3.5.p1.1.m1.3.4.1.cmml">⁢</mo><mi id="S3.5.p1.1.m1.3.4.4" xref="S3.5.p1.1.m1.3.4.4.cmml">M</mi><mo id="S3.5.p1.1.m1.3.4.1b" xref="S3.5.p1.1.m1.3.4.1.cmml">⁢</mo><mrow id="S3.5.p1.1.m1.3.4.5.2" xref="S3.5.p1.1.m1.3.4.5.1.cmml"><mo id="S3.5.p1.1.m1.3.4.5.2.1" stretchy="false" xref="S3.5.p1.1.m1.3.4.5.1.cmml">(</mo><mi id="S3.5.p1.1.m1.1.1" xref="S3.5.p1.1.m1.1.1.cmml">Q</mi><mo id="S3.5.p1.1.m1.3.4.5.2.2" xref="S3.5.p1.1.m1.3.4.5.1.cmml">,</mo><mi id="S3.5.p1.1.m1.2.2" xref="S3.5.p1.1.m1.2.2.cmml">K</mi><mo id="S3.5.p1.1.m1.3.4.5.2.3" xref="S3.5.p1.1.m1.3.4.5.1.cmml">,</mo><mi id="S3.5.p1.1.m1.3.3" xref="S3.5.p1.1.m1.3.3.cmml">V</mi><mo id="S3.5.p1.1.m1.3.4.5.2.4" stretchy="false" xref="S3.5.p1.1.m1.3.4.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.5.p1.1.m1.3b"><apply id="S3.5.p1.1.m1.3.4.cmml" xref="S3.5.p1.1.m1.3.4"><times id="S3.5.p1.1.m1.3.4.1.cmml" xref="S3.5.p1.1.m1.3.4.1"></times><ci id="S3.5.p1.1.m1.3.4.2.cmml" xref="S3.5.p1.1.m1.3.4.2">𝐿</ci><ci id="S3.5.p1.1.m1.3.4.3.cmml" xref="S3.5.p1.1.m1.3.4.3">𝐴</ci><ci id="S3.5.p1.1.m1.3.4.4.cmml" xref="S3.5.p1.1.m1.3.4.4">𝑀</ci><vector id="S3.5.p1.1.m1.3.4.5.1.cmml" xref="S3.5.p1.1.m1.3.4.5.2"><ci id="S3.5.p1.1.m1.1.1.cmml" xref="S3.5.p1.1.m1.1.1">𝑄</ci><ci id="S3.5.p1.1.m1.2.2.cmml" xref="S3.5.p1.1.m1.2.2">𝐾</ci><ci id="S3.5.p1.1.m1.3.3.cmml" xref="S3.5.p1.1.m1.3.3">𝑉</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.5.p1.1.m1.3c">LAM(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="S3.5.p1.1.m1.3d">italic_L italic_A italic_M ( italic_Q , italic_K , italic_V )</annotation></semantics></math> follows from Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm5" title="Lemma 5. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">5</span></a>. We have performed <math alttext="sL\cdot(2L-1)=(2L-1)n=\Theta(n\log n)" class="ltx_Math" display="inline" id="S3.5.p1.2.m2.3"><semantics id="S3.5.p1.2.m2.3a"><mrow id="S3.5.p1.2.m2.3.3" xref="S3.5.p1.2.m2.3.3.cmml"><mrow id="S3.5.p1.2.m2.1.1.1" xref="S3.5.p1.2.m2.1.1.1.cmml"><mrow id="S3.5.p1.2.m2.1.1.1.3" xref="S3.5.p1.2.m2.1.1.1.3.cmml"><mi id="S3.5.p1.2.m2.1.1.1.3.2" xref="S3.5.p1.2.m2.1.1.1.3.2.cmml">s</mi><mo id="S3.5.p1.2.m2.1.1.1.3.1" xref="S3.5.p1.2.m2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.5.p1.2.m2.1.1.1.3.3" xref="S3.5.p1.2.m2.1.1.1.3.3.cmml">L</mi></mrow><mo id="S3.5.p1.2.m2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.5.p1.2.m2.1.1.1.2.cmml">⋅</mo><mrow id="S3.5.p1.2.m2.1.1.1.1.1" xref="S3.5.p1.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.5.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.5.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.5.p1.2.m2.1.1.1.1.1.1" xref="S3.5.p1.2.m2.1.1.1.1.1.1.cmml"><mrow id="S3.5.p1.2.m2.1.1.1.1.1.1.2" xref="S3.5.p1.2.m2.1.1.1.1.1.1.2.cmml"><mn id="S3.5.p1.2.m2.1.1.1.1.1.1.2.2" xref="S3.5.p1.2.m2.1.1.1.1.1.1.2.2.cmml">2</mn><mo id="S3.5.p1.2.m2.1.1.1.1.1.1.2.1" xref="S3.5.p1.2.m2.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.5.p1.2.m2.1.1.1.1.1.1.2.3" xref="S3.5.p1.2.m2.1.1.1.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.5.p1.2.m2.1.1.1.1.1.1.1" xref="S3.5.p1.2.m2.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.5.p1.2.m2.1.1.1.1.1.1.3" xref="S3.5.p1.2.m2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.5.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.5.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.5.p1.2.m2.3.3.5" xref="S3.5.p1.2.m2.3.3.5.cmml">=</mo><mrow id="S3.5.p1.2.m2.2.2.2" xref="S3.5.p1.2.m2.2.2.2.cmml"><mrow id="S3.5.p1.2.m2.2.2.2.1.1" xref="S3.5.p1.2.m2.2.2.2.1.1.1.cmml"><mo id="S3.5.p1.2.m2.2.2.2.1.1.2" stretchy="false" xref="S3.5.p1.2.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.5.p1.2.m2.2.2.2.1.1.1" xref="S3.5.p1.2.m2.2.2.2.1.1.1.cmml"><mrow id="S3.5.p1.2.m2.2.2.2.1.1.1.2" xref="S3.5.p1.2.m2.2.2.2.1.1.1.2.cmml"><mn id="S3.5.p1.2.m2.2.2.2.1.1.1.2.2" xref="S3.5.p1.2.m2.2.2.2.1.1.1.2.2.cmml">2</mn><mo id="S3.5.p1.2.m2.2.2.2.1.1.1.2.1" xref="S3.5.p1.2.m2.2.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="S3.5.p1.2.m2.2.2.2.1.1.1.2.3" xref="S3.5.p1.2.m2.2.2.2.1.1.1.2.3.cmml">L</mi></mrow><mo id="S3.5.p1.2.m2.2.2.2.1.1.1.1" xref="S3.5.p1.2.m2.2.2.2.1.1.1.1.cmml">−</mo><mn id="S3.5.p1.2.m2.2.2.2.1.1.1.3" xref="S3.5.p1.2.m2.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.5.p1.2.m2.2.2.2.1.1.3" stretchy="false" xref="S3.5.p1.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.5.p1.2.m2.2.2.2.2" xref="S3.5.p1.2.m2.2.2.2.2.cmml">⁢</mo><mi id="S3.5.p1.2.m2.2.2.2.3" xref="S3.5.p1.2.m2.2.2.2.3.cmml">n</mi></mrow><mo id="S3.5.p1.2.m2.3.3.6" xref="S3.5.p1.2.m2.3.3.6.cmml">=</mo><mrow id="S3.5.p1.2.m2.3.3.3" xref="S3.5.p1.2.m2.3.3.3.cmml"><mi id="S3.5.p1.2.m2.3.3.3.3" mathvariant="normal" xref="S3.5.p1.2.m2.3.3.3.3.cmml">Θ</mi><mo id="S3.5.p1.2.m2.3.3.3.2" xref="S3.5.p1.2.m2.3.3.3.2.cmml">⁢</mo><mrow id="S3.5.p1.2.m2.3.3.3.1.1" xref="S3.5.p1.2.m2.3.3.3.1.1.1.cmml"><mo id="S3.5.p1.2.m2.3.3.3.1.1.2" stretchy="false" xref="S3.5.p1.2.m2.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.5.p1.2.m2.3.3.3.1.1.1" xref="S3.5.p1.2.m2.3.3.3.1.1.1.cmml"><mi id="S3.5.p1.2.m2.3.3.3.1.1.1.2" xref="S3.5.p1.2.m2.3.3.3.1.1.1.2.cmml">n</mi><mo id="S3.5.p1.2.m2.3.3.3.1.1.1.1" lspace="0.167em" xref="S3.5.p1.2.m2.3.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S3.5.p1.2.m2.3.3.3.1.1.1.3" xref="S3.5.p1.2.m2.3.3.3.1.1.1.3.cmml"><mi id="S3.5.p1.2.m2.3.3.3.1.1.1.3.1" xref="S3.5.p1.2.m2.3.3.3.1.1.1.3.1.cmml">log</mi><mo id="S3.5.p1.2.m2.3.3.3.1.1.1.3a" lspace="0.167em" xref="S3.5.p1.2.m2.3.3.3.1.1.1.3.cmml">⁡</mo><mi id="S3.5.p1.2.m2.3.3.3.1.1.1.3.2" xref="S3.5.p1.2.m2.3.3.3.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S3.5.p1.2.m2.3.3.3.1.1.3" stretchy="false" xref="S3.5.p1.2.m2.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.5.p1.2.m2.3b"><apply id="S3.5.p1.2.m2.3.3.cmml" xref="S3.5.p1.2.m2.3.3"><and id="S3.5.p1.2.m2.3.3a.cmml" xref="S3.5.p1.2.m2.3.3"></and><apply id="S3.5.p1.2.m2.3.3b.cmml" xref="S3.5.p1.2.m2.3.3"><eq id="S3.5.p1.2.m2.3.3.5.cmml" xref="S3.5.p1.2.m2.3.3.5"></eq><apply id="S3.5.p1.2.m2.1.1.1.cmml" xref="S3.5.p1.2.m2.1.1.1"><ci id="S3.5.p1.2.m2.1.1.1.2.cmml" xref="S3.5.p1.2.m2.1.1.1.2">⋅</ci><apply id="S3.5.p1.2.m2.1.1.1.3.cmml" xref="S3.5.p1.2.m2.1.1.1.3"><times id="S3.5.p1.2.m2.1.1.1.3.1.cmml" xref="S3.5.p1.2.m2.1.1.1.3.1"></times><ci id="S3.5.p1.2.m2.1.1.1.3.2.cmml" xref="S3.5.p1.2.m2.1.1.1.3.2">𝑠</ci><ci id="S3.5.p1.2.m2.1.1.1.3.3.cmml" xref="S3.5.p1.2.m2.1.1.1.3.3">𝐿</ci></apply><apply id="S3.5.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.5.p1.2.m2.1.1.1.1.1"><minus id="S3.5.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.5.p1.2.m2.1.1.1.1.1.1.1"></minus><apply id="S3.5.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.5.p1.2.m2.1.1.1.1.1.1.2"><times id="S3.5.p1.2.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.5.p1.2.m2.1.1.1.1.1.1.2.1"></times><cn id="S3.5.p1.2.m2.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.5.p1.2.m2.1.1.1.1.1.1.2.2">2</cn><ci id="S3.5.p1.2.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.5.p1.2.m2.1.1.1.1.1.1.2.3">𝐿</ci></apply><cn id="S3.5.p1.2.m2.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.5.p1.2.m2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.5.p1.2.m2.2.2.2.cmml" xref="S3.5.p1.2.m2.2.2.2"><times id="S3.5.p1.2.m2.2.2.2.2.cmml" xref="S3.5.p1.2.m2.2.2.2.2"></times><apply id="S3.5.p1.2.m2.2.2.2.1.1.1.cmml" xref="S3.5.p1.2.m2.2.2.2.1.1"><minus id="S3.5.p1.2.m2.2.2.2.1.1.1.1.cmml" xref="S3.5.p1.2.m2.2.2.2.1.1.1.1"></minus><apply id="S3.5.p1.2.m2.2.2.2.1.1.1.2.cmml" xref="S3.5.p1.2.m2.2.2.2.1.1.1.2"><times id="S3.5.p1.2.m2.2.2.2.1.1.1.2.1.cmml" xref="S3.5.p1.2.m2.2.2.2.1.1.1.2.1"></times><cn id="S3.5.p1.2.m2.2.2.2.1.1.1.2.2.cmml" type="integer" xref="S3.5.p1.2.m2.2.2.2.1.1.1.2.2">2</cn><ci id="S3.5.p1.2.m2.2.2.2.1.1.1.2.3.cmml" xref="S3.5.p1.2.m2.2.2.2.1.1.1.2.3">𝐿</ci></apply><cn id="S3.5.p1.2.m2.2.2.2.1.1.1.3.cmml" type="integer" xref="S3.5.p1.2.m2.2.2.2.1.1.1.3">1</cn></apply><ci id="S3.5.p1.2.m2.2.2.2.3.cmml" xref="S3.5.p1.2.m2.2.2.2.3">𝑛</ci></apply></apply><apply id="S3.5.p1.2.m2.3.3c.cmml" xref="S3.5.p1.2.m2.3.3"><eq id="S3.5.p1.2.m2.3.3.6.cmml" xref="S3.5.p1.2.m2.3.3.6"></eq><share href="https://arxiv.org/html/2410.03805v1#S3.5.p1.2.m2.2.2.2.cmml" id="S3.5.p1.2.m2.3.3d.cmml" xref="S3.5.p1.2.m2.3.3"></share><apply id="S3.5.p1.2.m2.3.3.3.cmml" xref="S3.5.p1.2.m2.3.3.3"><times id="S3.5.p1.2.m2.3.3.3.2.cmml" xref="S3.5.p1.2.m2.3.3.3.2"></times><ci id="S3.5.p1.2.m2.3.3.3.3.cmml" xref="S3.5.p1.2.m2.3.3.3.3">Θ</ci><apply id="S3.5.p1.2.m2.3.3.3.1.1.1.cmml" xref="S3.5.p1.2.m2.3.3.3.1.1"><times id="S3.5.p1.2.m2.3.3.3.1.1.1.1.cmml" xref="S3.5.p1.2.m2.3.3.3.1.1.1.1"></times><ci id="S3.5.p1.2.m2.3.3.3.1.1.1.2.cmml" xref="S3.5.p1.2.m2.3.3.3.1.1.1.2">𝑛</ci><apply id="S3.5.p1.2.m2.3.3.3.1.1.1.3.cmml" xref="S3.5.p1.2.m2.3.3.3.1.1.1.3"><log id="S3.5.p1.2.m2.3.3.3.1.1.1.3.1.cmml" xref="S3.5.p1.2.m2.3.3.3.1.1.1.3.1"></log><ci id="S3.5.p1.2.m2.3.3.3.1.1.1.3.2.cmml" xref="S3.5.p1.2.m2.3.3.3.1.1.1.3.2">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.5.p1.2.m2.3c">sL\cdot(2L-1)=(2L-1)n=\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S3.5.p1.2.m2.3d">italic_s italic_L ⋅ ( 2 italic_L - 1 ) = ( 2 italic_L - 1 ) italic_n = roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math> dot products. This computation takes time and memory <math alttext="\Theta(sL^{2})=\Theta(Ln)" class="ltx_Math" display="inline" id="S3.5.p1.3.m3.2"><semantics id="S3.5.p1.3.m3.2a"><mrow id="S3.5.p1.3.m3.2.2" xref="S3.5.p1.3.m3.2.2.cmml"><mrow id="S3.5.p1.3.m3.1.1.1" xref="S3.5.p1.3.m3.1.1.1.cmml"><mi id="S3.5.p1.3.m3.1.1.1.3" mathvariant="normal" xref="S3.5.p1.3.m3.1.1.1.3.cmml">Θ</mi><mo id="S3.5.p1.3.m3.1.1.1.2" xref="S3.5.p1.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.5.p1.3.m3.1.1.1.1.1" xref="S3.5.p1.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.5.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.5.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.5.p1.3.m3.1.1.1.1.1.1" xref="S3.5.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.5.p1.3.m3.1.1.1.1.1.1.2" xref="S3.5.p1.3.m3.1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.5.p1.3.m3.1.1.1.1.1.1.1" xref="S3.5.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S3.5.p1.3.m3.1.1.1.1.1.1.3" xref="S3.5.p1.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S3.5.p1.3.m3.1.1.1.1.1.1.3.2" xref="S3.5.p1.3.m3.1.1.1.1.1.1.3.2.cmml">L</mi><mn id="S3.5.p1.3.m3.1.1.1.1.1.1.3.3" xref="S3.5.p1.3.m3.1.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S3.5.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S3.5.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.5.p1.3.m3.2.2.3" xref="S3.5.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S3.5.p1.3.m3.2.2.2" xref="S3.5.p1.3.m3.2.2.2.cmml"><mi id="S3.5.p1.3.m3.2.2.2.3" mathvariant="normal" xref="S3.5.p1.3.m3.2.2.2.3.cmml">Θ</mi><mo id="S3.5.p1.3.m3.2.2.2.2" xref="S3.5.p1.3.m3.2.2.2.2.cmml">⁢</mo><mrow id="S3.5.p1.3.m3.2.2.2.1.1" xref="S3.5.p1.3.m3.2.2.2.1.1.1.cmml"><mo id="S3.5.p1.3.m3.2.2.2.1.1.2" stretchy="false" xref="S3.5.p1.3.m3.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.5.p1.3.m3.2.2.2.1.1.1" xref="S3.5.p1.3.m3.2.2.2.1.1.1.cmml"><mi id="S3.5.p1.3.m3.2.2.2.1.1.1.2" xref="S3.5.p1.3.m3.2.2.2.1.1.1.2.cmml">L</mi><mo id="S3.5.p1.3.m3.2.2.2.1.1.1.1" xref="S3.5.p1.3.m3.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.5.p1.3.m3.2.2.2.1.1.1.3" xref="S3.5.p1.3.m3.2.2.2.1.1.1.3.cmml">n</mi></mrow><mo id="S3.5.p1.3.m3.2.2.2.1.1.3" stretchy="false" xref="S3.5.p1.3.m3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.5.p1.3.m3.2b"><apply id="S3.5.p1.3.m3.2.2.cmml" xref="S3.5.p1.3.m3.2.2"><eq id="S3.5.p1.3.m3.2.2.3.cmml" xref="S3.5.p1.3.m3.2.2.3"></eq><apply id="S3.5.p1.3.m3.1.1.1.cmml" xref="S3.5.p1.3.m3.1.1.1"><times id="S3.5.p1.3.m3.1.1.1.2.cmml" xref="S3.5.p1.3.m3.1.1.1.2"></times><ci id="S3.5.p1.3.m3.1.1.1.3.cmml" xref="S3.5.p1.3.m3.1.1.1.3">Θ</ci><apply id="S3.5.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.5.p1.3.m3.1.1.1.1.1"><times id="S3.5.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.5.p1.3.m3.1.1.1.1.1.1.1"></times><ci id="S3.5.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.5.p1.3.m3.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.5.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.5.p1.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.5.p1.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.5.p1.3.m3.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.5.p1.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.5.p1.3.m3.1.1.1.1.1.1.3.2">𝐿</ci><cn id="S3.5.p1.3.m3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.5.p1.3.m3.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply><apply id="S3.5.p1.3.m3.2.2.2.cmml" xref="S3.5.p1.3.m3.2.2.2"><times id="S3.5.p1.3.m3.2.2.2.2.cmml" xref="S3.5.p1.3.m3.2.2.2.2"></times><ci id="S3.5.p1.3.m3.2.2.2.3.cmml" xref="S3.5.p1.3.m3.2.2.2.3">Θ</ci><apply id="S3.5.p1.3.m3.2.2.2.1.1.1.cmml" xref="S3.5.p1.3.m3.2.2.2.1.1"><times id="S3.5.p1.3.m3.2.2.2.1.1.1.1.cmml" xref="S3.5.p1.3.m3.2.2.2.1.1.1.1"></times><ci id="S3.5.p1.3.m3.2.2.2.1.1.1.2.cmml" xref="S3.5.p1.3.m3.2.2.2.1.1.1.2">𝐿</ci><ci id="S3.5.p1.3.m3.2.2.2.1.1.1.3.cmml" xref="S3.5.p1.3.m3.2.2.2.1.1.1.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.5.p1.3.m3.2c">\Theta(sL^{2})=\Theta(Ln)</annotation><annotation encoding="application/x-llamapun" id="S3.5.p1.3.m3.2d">roman_Θ ( italic_s italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) = roman_Θ ( italic_L italic_n )</annotation></semantics></math>.
∎</p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_cor" id="Thmthm7">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmthm7.1.1.1">Corollary 7</span></span><span class="ltx_text ltx_font_bold" id="Thmthm7.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmthm7.p1">
<p class="ltx_p" id="Thmthm7.p1.3"><span class="ltx_text ltx_font_italic" id="Thmthm7.p1.3.3">For <math alttext="L=\lceil 4\log n\rceil" class="ltx_Math" display="inline" id="Thmthm7.p1.1.1.m1.1"><semantics id="Thmthm7.p1.1.1.m1.1a"><mrow id="Thmthm7.p1.1.1.m1.1.1" xref="Thmthm7.p1.1.1.m1.1.1.cmml"><mi id="Thmthm7.p1.1.1.m1.1.1.3" xref="Thmthm7.p1.1.1.m1.1.1.3.cmml">L</mi><mo id="Thmthm7.p1.1.1.m1.1.1.2" xref="Thmthm7.p1.1.1.m1.1.1.2.cmml">=</mo><mrow id="Thmthm7.p1.1.1.m1.1.1.1.1" xref="Thmthm7.p1.1.1.m1.1.1.1.2.cmml"><mo id="Thmthm7.p1.1.1.m1.1.1.1.1.2" stretchy="false" xref="Thmthm7.p1.1.1.m1.1.1.1.2.1.cmml">⌈</mo><mrow id="Thmthm7.p1.1.1.m1.1.1.1.1.1" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.cmml"><mn id="Thmthm7.p1.1.1.m1.1.1.1.1.1.2" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.2.cmml">4</mn><mo id="Thmthm7.p1.1.1.m1.1.1.1.1.1.1" lspace="0.167em" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Thmthm7.p1.1.1.m1.1.1.1.1.1.3" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.cmml"><mi id="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.1" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.1.cmml">log</mi><mo id="Thmthm7.p1.1.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.cmml">⁡</mo><mi id="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.2" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="Thmthm7.p1.1.1.m1.1.1.1.1.3" stretchy="false" xref="Thmthm7.p1.1.1.m1.1.1.1.2.1.cmml">⌉</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm7.p1.1.1.m1.1b"><apply id="Thmthm7.p1.1.1.m1.1.1.cmml" xref="Thmthm7.p1.1.1.m1.1.1"><eq id="Thmthm7.p1.1.1.m1.1.1.2.cmml" xref="Thmthm7.p1.1.1.m1.1.1.2"></eq><ci id="Thmthm7.p1.1.1.m1.1.1.3.cmml" xref="Thmthm7.p1.1.1.m1.1.1.3">𝐿</ci><apply id="Thmthm7.p1.1.1.m1.1.1.1.2.cmml" xref="Thmthm7.p1.1.1.m1.1.1.1.1"><ceiling id="Thmthm7.p1.1.1.m1.1.1.1.2.1.cmml" xref="Thmthm7.p1.1.1.m1.1.1.1.1.2"></ceiling><apply id="Thmthm7.p1.1.1.m1.1.1.1.1.1.cmml" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1"><times id="Thmthm7.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.1"></times><cn id="Thmthm7.p1.1.1.m1.1.1.1.1.1.2.cmml" type="integer" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.2">4</cn><apply id="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.cmml" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.3"><log id="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.1.cmml" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.1"></log><ci id="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.2.cmml" xref="Thmthm7.p1.1.1.m1.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm7.p1.1.1.m1.1c">L=\lceil 4\log n\rceil</annotation><annotation encoding="application/x-llamapun" id="Thmthm7.p1.1.1.m1.1d">italic_L = ⌈ 4 roman_log italic_n ⌉</annotation></semantics></math>, Algorithm 1 computes <math alttext="\operatorname{LAM}(Q,K,V)" class="ltx_Math" display="inline" id="Thmthm7.p1.2.2.m2.4"><semantics id="Thmthm7.p1.2.2.m2.4a"><mrow id="Thmthm7.p1.2.2.m2.4.5.2" xref="Thmthm7.p1.2.2.m2.4.5.1.cmml"><mi id="Thmthm7.p1.2.2.m2.1.1" xref="Thmthm7.p1.2.2.m2.1.1.cmml">LAM</mi><mo id="Thmthm7.p1.2.2.m2.4.5.2a" xref="Thmthm7.p1.2.2.m2.4.5.1.cmml">⁡</mo><mrow id="Thmthm7.p1.2.2.m2.4.5.2.1" xref="Thmthm7.p1.2.2.m2.4.5.1.cmml"><mo id="Thmthm7.p1.2.2.m2.4.5.2.1.1" stretchy="false" xref="Thmthm7.p1.2.2.m2.4.5.1.cmml">(</mo><mi id="Thmthm7.p1.2.2.m2.2.2" xref="Thmthm7.p1.2.2.m2.2.2.cmml">Q</mi><mo id="Thmthm7.p1.2.2.m2.4.5.2.1.2" xref="Thmthm7.p1.2.2.m2.4.5.1.cmml">,</mo><mi id="Thmthm7.p1.2.2.m2.3.3" xref="Thmthm7.p1.2.2.m2.3.3.cmml">K</mi><mo id="Thmthm7.p1.2.2.m2.4.5.2.1.3" xref="Thmthm7.p1.2.2.m2.4.5.1.cmml">,</mo><mi id="Thmthm7.p1.2.2.m2.4.4" xref="Thmthm7.p1.2.2.m2.4.4.cmml">V</mi><mo id="Thmthm7.p1.2.2.m2.4.5.2.1.4" stretchy="false" xref="Thmthm7.p1.2.2.m2.4.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm7.p1.2.2.m2.4b"><apply id="Thmthm7.p1.2.2.m2.4.5.1.cmml" xref="Thmthm7.p1.2.2.m2.4.5.2"><ci id="Thmthm7.p1.2.2.m2.1.1.cmml" xref="Thmthm7.p1.2.2.m2.1.1">LAM</ci><ci id="Thmthm7.p1.2.2.m2.2.2.cmml" xref="Thmthm7.p1.2.2.m2.2.2">𝑄</ci><ci id="Thmthm7.p1.2.2.m2.3.3.cmml" xref="Thmthm7.p1.2.2.m2.3.3">𝐾</ci><ci id="Thmthm7.p1.2.2.m2.4.4.cmml" xref="Thmthm7.p1.2.2.m2.4.4">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm7.p1.2.2.m2.4c">\operatorname{LAM}(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="Thmthm7.p1.2.2.m2.4d">roman_LAM ( italic_Q , italic_K , italic_V )</annotation></semantics></math> in time and memory <math alttext="\Theta(n\log n)" class="ltx_Math" display="inline" id="Thmthm7.p1.3.3.m3.1"><semantics id="Thmthm7.p1.3.3.m3.1a"><mrow id="Thmthm7.p1.3.3.m3.1.1" xref="Thmthm7.p1.3.3.m3.1.1.cmml"><mi id="Thmthm7.p1.3.3.m3.1.1.3" mathvariant="normal" xref="Thmthm7.p1.3.3.m3.1.1.3.cmml">Θ</mi><mo id="Thmthm7.p1.3.3.m3.1.1.2" xref="Thmthm7.p1.3.3.m3.1.1.2.cmml">⁢</mo><mrow id="Thmthm7.p1.3.3.m3.1.1.1.1" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.cmml"><mo id="Thmthm7.p1.3.3.m3.1.1.1.1.2" stretchy="false" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Thmthm7.p1.3.3.m3.1.1.1.1.1" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.cmml"><mi id="Thmthm7.p1.3.3.m3.1.1.1.1.1.2" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.2.cmml">n</mi><mo id="Thmthm7.p1.3.3.m3.1.1.1.1.1.1" lspace="0.167em" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Thmthm7.p1.3.3.m3.1.1.1.1.1.3" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.cmml"><mi id="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.1" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.1.cmml">log</mi><mo id="Thmthm7.p1.3.3.m3.1.1.1.1.1.3a" lspace="0.167em" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.cmml">⁡</mo><mi id="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.2" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="Thmthm7.p1.3.3.m3.1.1.1.1.3" stretchy="false" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmthm7.p1.3.3.m3.1b"><apply id="Thmthm7.p1.3.3.m3.1.1.cmml" xref="Thmthm7.p1.3.3.m3.1.1"><times id="Thmthm7.p1.3.3.m3.1.1.2.cmml" xref="Thmthm7.p1.3.3.m3.1.1.2"></times><ci id="Thmthm7.p1.3.3.m3.1.1.3.cmml" xref="Thmthm7.p1.3.3.m3.1.1.3">Θ</ci><apply id="Thmthm7.p1.3.3.m3.1.1.1.1.1.cmml" xref="Thmthm7.p1.3.3.m3.1.1.1.1"><times id="Thmthm7.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.1"></times><ci id="Thmthm7.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.2">𝑛</ci><apply id="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.cmml" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.3"><log id="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.1.cmml" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.1"></log><ci id="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.2.cmml" xref="Thmthm7.p1.3.3.m3.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmthm7.p1.3.3.m3.1c">\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="Thmthm7.p1.3.3.m3.1d">roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_proof" id="S3.6">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.6.p1">
<p class="ltx_p" id="S3.6.p1.1">This follows from instantiating <math alttext="L" class="ltx_Math" display="inline" id="S3.6.p1.1.m1.1"><semantics id="S3.6.p1.1.m1.1a"><mi id="S3.6.p1.1.m1.1.1" xref="S3.6.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.6.p1.1.m1.1b"><ci id="S3.6.p1.1.m1.1.1.cmml" xref="S3.6.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.6.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.6.p1.1.m1.1d">italic_L</annotation></semantics></math> in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#Thmthm6" title="Theorem 6. ‣ 3 Local Attention Mechanism (LAM) ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">6</span></a>.
∎</p>
</div>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Empirical comparison to the state of the art</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we present the experimental setup and results yielded by the vanilla transformer fuelled by our attention mechanism, LAM, and compare these to the state of the art in time-series forecasting via transformers. In this section we follow the evaluation framework proposed in the Informer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite> paper. We will begin with a brief explanation of the datasets utilised and the algorithms involved in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.SS1" title="4.1 Experimental Details ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4.1</span></a>, moreover, we will provide details regarding the hardware used in our experiments and the open-access repository where the code is published. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.SS2" title="4.2 Local Attention Mechanism against the state-of-the-art ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4.2</span></a>, we analyse the results obtained including a Bayes test analysis. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.SS3" title="4.3 Comparing LAM and ProbAttn within the same architecture framework ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4.3</span></a> we perform a comparison between the attention mechanisms LAM and ProbAttn utilising the vanilla transformer architecture. Finally, in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.SS4" title="4.4 On the suitability of benchmark models for the LSTF problem ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4.4</span></a> we argue that the datasets that are used in the literature for benchmarking of models for the LSTF problem are not sufficient, which motivates Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5" title="5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Details</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Datasets:</span> For the sake of fairness we first follow the experimental methodology of Informer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>, we use four subsets of ETT: ETTh1 and ETTh2 (with hourly sampling), and ETTm1 and ETTm2 (with a 15-minute granularity). The ECL dataset records electricity consumption data for 321 clients, converted into hourly consumption, with ’MT 320’ as the target variable. The Weather dataset consists of climatological data from approximately 1,600 locations in the United States, collected hourly over four years, featuring ’wet bulb’ as the target variable along with 11 other climate features. Each dataset was divided into training, validation, and test sets. Details of the datasets can be observed in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.T1" title="In 4.1 Experimental Details ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.2.1">Instances</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.3.1">Features</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.4.1">Sampling rate</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.2.1.1">ETTh1</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.2.1.2">8,640</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.2.1.3">7</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.2.1.4">1 hour</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.2">
<td class="ltx_td ltx_align_left" id="S4.T1.1.3.2.1">ETTh2</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.3.2.2">8,640</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.3.2.3">7</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.3.2.4">1 hour</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.3">
<td class="ltx_td ltx_align_left" id="S4.T1.1.4.3.1">ETTm1</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.4.3.2">34,560</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.4.3.3">7</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.4.3.4">15 minutes</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.5.4">
<td class="ltx_td ltx_align_left" id="S4.T1.1.5.4.1">ETTm2</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.5.4.2">34,560</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.5.4.3">7</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.5.4.4">15 minutes</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.6.5">
<td class="ltx_td ltx_align_left" id="S4.T1.1.6.5.1">Weather</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.6.5.2">24,544</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.6.5.3">12</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.6.5.4">1 hour</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.7.6">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.1.7.6.1">ECL</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.1.7.6.2">18,412</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.1.7.6.3">321</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.1.7.6.4">1 hour</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Datasets description. Number of instances, features and sampling rates are displayed in the table.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Multivariate prediction, error metrics and validation:</span> The primary objective of this comparison is to determine which model produces the least error in multivariate predictions on the datasets described above. Multivariate prediction involves using a fixed-size input sequence to predict a fixed-size output sequence across all variables in the dataset. The problem of multi-variable forecasting is significantly more challenging than single-variable forecasting. Incorporating more than one input variable allows for the extraction of more valuable information by capturing dependencies between variables. However, forecasting multiple variables simultaneously requires more sophisticated modelling, as errors can accumulate across each component. Furthermore, including more variables increases the model’s complexity, posing a challenge to assigning meaningful values to the weights. Consequently, the results obtained from multi-variable forecasting carry more significance and provide a more comprehensive evaluation of model performance. To ensure the validity and representativeness of the results, we have incorporated Bayesian tests <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib38" title="">38</a>]</cite>, which serve to facilitate and formalise the evaluation process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">Data has been standardised to have a mean of zero and a standard deviation of one. Errors were assessed using reconstruction error, with Mean Absolute Error (MAE) and Mean Squared Error (MSE) serving as the evaluation metrics.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">Given the long training times needed in the LSTF problem, we present the results of one training execution, as it is standard in the literature. Due to the nature of time series, the methodology employed consists in dividing each dataset into training, validation, and test sets to monitor training and assess performance effectively. Specifically, the division is 12/4/4 months for ETT, 15/3/4 months for ECL, and 28/10/10 months for WTH as in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.1.1">Algorithms: </span> We have maintained the same comparative framework as presented in the Informer paper, utilising the five algorithms selected by the original authors, being a representative sample of algorithms involving statistical methods and recurrent networks. This selection comprises ARIMA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib39" title="">39</a>]</cite>, Prophet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib40" title="">40</a>]</cite>, LSTMa <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib41" title="">41</a>]</cite>, LST-Net <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib24" title="">24</a>]</cite>, and DeepAR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib42" title="">42</a>]</cite>. To better represent the state-of-the-art in time series forecasting, we have also included Reformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib43" title="">43</a>]</cite> and LogSparse self-attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib28" title="">28</a>]</cite>, alongside the Informer model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>. All these models have undergone hyperparameter optimisation to determine the most suitable configuration for each dataset.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p6">
<p class="ltx_p" id="S4.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p6.1.1">Hardware and Code: </span> The experiments were conducted on an NVIDIA DGX-A100 workstation, which includes 1TB of RAM, two AMD Rome 7742 processors, and eight NVIDIA A100 graphics cards, each equipped with 40GB of memory. For implementation and experimentation, we developed a Python-based codebase, utilising the PyTorch framework for the development and training of neural networks. To ensure transparency and reproducibility, we have made the source code available through a dedicated GitHub repository within the ARI-DaSCI organisation<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Link to our GitHub repository: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ari-dasci/S-LAM" title="">https://github.com/ari-dasci/S-LAM</a></span></span></span>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Local Attention Mechanism against the state-of-the-art</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">First, we will analyse a comparison between Informer and the number of parameters of the vanilla transformer incorporating LAM as attention mechanism, in order to test the improvement that arises from incorporating our proposal on vanilla architecture. It is important to highlight that the architecture accompanying our attention mechanism is exactly the vanilla architecture, based on Vaswani’s <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib20" title="">20</a>]</cite> original paper, without any modifications to the encoding-decoding framework or the positional encoding. The only difference between both models is the inclusion of LAM instead of the full attention mechanism. In the experimentation presented in this section the number of encoding and decoding layers in the vanilla transformer is 3, as opposed to 4 encoding layers and 2 decoding layers in the Informer architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite>.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.7" style="width:433.6pt;height:226.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(27.2pt,-14.2pt) scale(1.14344377531209,1.14344377531209) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.7.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.7.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.7.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.1.2.1">Seq_len</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.7.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.1.3.1">Parameters</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T2.7.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.1.4.1">Ratio</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.7.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.1.5.1">Num. encoding/decoding layers</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.7.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.2.1.1">Informer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.2.1.2" rowspan="2"><span class="ltx_text" id="S4.T2.7.1.2.1.2.1">48</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.2.1.3">12,455,745</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.2.1.4" rowspan="2"><span class="ltx_text" id="S4.T2.7.1.2.1.4.1">2.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.2.1.5">4/2</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.3.2">
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.3.2.1">Local Attention</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.3.2.2">5,900,000</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.3.2.3">6</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.4.3.1">Informer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.4.3.2" rowspan="2"><span class="ltx_text" id="S4.T2.7.1.4.3.2.1">168</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.4.3.3">12,455,745</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.4.3.4" rowspan="2"><span class="ltx_text" id="S4.T2.7.1.4.3.4.1">2.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.4.3.5">3/3</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.5.4">
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.5.4.1">Local Attention</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.5.4.2">5,900,000</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.5.4.3">6</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.6.5.1">Informer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.6.5.2" rowspan="2"><span class="ltx_text" id="S4.T2.7.1.6.5.2.1">336</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.6.5.3">12,455,745</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.6.5.4" rowspan="2"><span class="ltx_text" id="S4.T2.7.1.6.5.4.1">2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.6.5.5">4/2</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.7.6">
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.7.6.1">Local Attention</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.7.6.2">6,000,000</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.7.6.3">6</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.8.7">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.8.7.1">Informer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.8.7.2" rowspan="2"><span class="ltx_text" id="S4.T2.7.1.8.7.2.1">720</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.8.7.3">12,455,745</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.8.7.4" rowspan="2"><span class="ltx_text" id="S4.T2.7.1.8.7.4.1">1.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.8.7.5">3/3</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.9.8">
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.9.8.1">Local Attention</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.9.8.2">6,400,000</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.1.9.8.3">6</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.10.9">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.10.9.1">Informer</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.7.1.10.9.2" rowspan="2"><span class="ltx_text" id="S4.T2.7.1.10.9.2.1">960</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.10.9.3">12,455,745</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.7.1.10.9.4" rowspan="2"><span class="ltx_text" id="S4.T2.7.1.10.9.4.1">1.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.1.10.9.5">4/2</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.11.10">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.7.1.11.10.1">Local Attention</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.7.1.11.10.2">6,800,000</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.7.1.11.10.3">6</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Number of parameters of Informer and our Local Attention transformer model over the ECL dataset. The ratio is computed as Local Attention model parameters divided by Informer parameters. Seq_len parameter stands for the size of the input and prediction window. The number of encoding/decoding layers presents two numbers, <math alttext="a/b" class="ltx_Math" display="inline" id="S4.T2.4.m1.1"><semantics id="S4.T2.4.m1.1b"><mrow id="S4.T2.4.m1.1.1" xref="S4.T2.4.m1.1.1.cmml"><mi id="S4.T2.4.m1.1.1.2" xref="S4.T2.4.m1.1.1.2.cmml">a</mi><mo id="S4.T2.4.m1.1.1.1" xref="S4.T2.4.m1.1.1.1.cmml">/</mo><mi id="S4.T2.4.m1.1.1.3" xref="S4.T2.4.m1.1.1.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.m1.1c"><apply id="S4.T2.4.m1.1.1.cmml" xref="S4.T2.4.m1.1.1"><divide id="S4.T2.4.m1.1.1.1.cmml" xref="S4.T2.4.m1.1.1.1"></divide><ci id="S4.T2.4.m1.1.1.2.cmml" xref="S4.T2.4.m1.1.1.2">𝑎</ci><ci id="S4.T2.4.m1.1.1.3.cmml" xref="S4.T2.4.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.m1.1d">a/b</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.m1.1e">italic_a / italic_b</annotation></semantics></math>, where <math alttext="a" class="ltx_Math" display="inline" id="S4.T2.5.m2.1"><semantics id="S4.T2.5.m2.1b"><mi id="S4.T2.5.m2.1.1" xref="S4.T2.5.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.5.m2.1c"><ci id="S4.T2.5.m2.1.1.cmml" xref="S4.T2.5.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.m2.1d">a</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.m2.1e">italic_a</annotation></semantics></math> is the number of encoding layers in the model and <math alttext="b" class="ltx_Math" display="inline" id="S4.T2.6.m3.1"><semantics id="S4.T2.6.m3.1b"><mi id="S4.T2.6.m3.1.1" xref="S4.T2.6.m3.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.6.m3.1c"><ci id="S4.T2.6.m3.1.1.cmml" xref="S4.T2.6.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.m3.1d">b</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.m3.1e">italic_b</annotation></semantics></math> is the number of decoding layers.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.2"><a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.T2" title="In 4.2 Local Attention Mechanism against the state-of-the-art ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a> presents the size of both models on a fixed dataset while varying the size of the input window. Our model exhibits sensitivity to this variation, whereas Informer does not. The reason for this is that Informer has a fixed architecture that accepts an input window of size at most 512 time-steps. For smaller input window sizes, the input is extended with zeroes until reaching the mentioned size. Note that all the parameters in the Informer model are still used in the model independently of the size of the input window. In the optimal scenario, we achieve a parameter reduction factor of <math alttext="2.1" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mn id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">2.1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><cn id="S4.SS2.p2.1.m1.1.1.cmml" type="float" xref="S4.SS2.p2.1.m1.1.1">2.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">2.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">2.1</annotation></semantics></math>, and in the worst scenario, a factor of <math alttext="1.9" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mn id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">1.9</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><cn id="S4.SS2.p2.2.m2.1.1.cmml" type="float" xref="S4.SS2.p2.2.m2.1.1">1.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">1.9</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">1.9</annotation></semantics></math>. Therefore, the model incorporating LAM is significantly more compact in terms of the number of parameters compared to Informer, and consequently, in terms of memory usage. This compactness could allow us to concatenate more layers of our attention mechanism, thereby more accurately capturing long-term temporal dependencies. However, to highlight the effect of our attention mechanism in prediction accuracy, we have chosen to have a similar number of encoding and decoding layers as Informer.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.3" style="width:433.6pt;height:465.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-17.8pt,19.1pt) scale(0.924070975645557,0.924070975645557) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.3.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.3.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="2" id="S4.T3.3.3.4.1.1">Methods</th>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S4.T3.3.3.4.1.2">LAM</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S4.T3.3.3.4.1.3">Informer</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S4.T3.3.3.4.1.4">LogTrans</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S4.T3.3.3.4.1.5">Reformer</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S4.T3.3.3.4.1.6">LSTMa</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S4.T3.3.3.4.1.7">LSTnet</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.5.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" colspan="2" id="S4.T3.3.3.5.2.1">Metric</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.5.2.2">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.5.2.3">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.5.2.4">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.5.2.5">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.5.2.6">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.5.2.7">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.5.2.8">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.5.2.9">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.5.2.10">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.5.2.11">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.5.2.12">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.5.2.13">MAE</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.1.1" rowspan="5"><span class="ltx_text" id="S4.T3.1.1.1.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T3.1.1.1.1.1.1" style="width:8.7pt;height:29.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:29.6pt;transform:translate(-10.43pt,-9.53pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T3.1.1.1.1.1.1.1">ETTh<sub class="ltx_sub" id="S4.T3.1.1.1.1.1.1.1.1">1</sub></span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.1.2">24</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.3.1">0.471</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.4.1">0.448</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.5">0.577</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.1.6">0.549</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.7">0.686</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.1.8">0.604</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.9">0.991</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.1.10">0.754</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.11">0.650</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.1.12">0.624</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.13">1.293</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.14">0.901</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.6.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.6.3.1">48</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.6.3.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.6.3.2.1">0.560</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.6.3.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.6.3.3.1">0.545</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.6.3.4">0.685</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.6.3.5">0.625</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.6.3.6">0.766</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.6.3.7">0.757</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.6.3.8">1.313</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.6.3.9">0.906</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.6.3.10">0.702</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.6.3.11">0.675</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.6.3.12">1.456</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.6.3.13">0.960</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.7.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.7.4.1">168</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.7.4.2">1.011</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.7.4.3">0.807</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.7.4.4"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.7.4.4.1">0.931</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.7.4.5"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.7.4.5.1">0.752</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.7.4.6">1.002</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.7.4.7">0.846</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.7.4.8">1.824</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.7.4.9">1.138</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.7.4.10">1.212</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.7.4.11">0.867</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.7.4.12">1.997</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.7.4.13">1.214</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.8.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.8.5.1">336</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.8.5.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.8.5.2.1">0.923</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.8.5.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.8.5.3.1">0.756</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.8.5.4">1.128</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.8.5.5">0.873</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.8.5.6">1.362</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.8.5.7">0.952</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.8.5.8">2.117</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.8.5.9">1.280</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.8.5.10">1.424</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.8.5.11">0.994</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.8.5.12">2.655</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.8.5.13">1.369</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.9.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.9.6.1">720</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.9.6.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.9.6.2.1">0.993</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.9.6.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.9.6.3.1">0.732</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.9.6.4">1.215</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.9.6.5">0.896</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.9.6.6">1.397</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.9.6.7">1.291</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.9.6.8">2.415</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.9.6.9">1.520</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.9.6.10">1.960</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.9.6.11">1.322</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.9.6.12">2.143</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.9.6.13">1.380</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.2.2.2.1" rowspan="5"><span class="ltx_text" id="S4.T3.2.2.2.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T3.2.2.2.1.1.1" style="width:8.7pt;height:29.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:29.6pt;transform:translate(-10.43pt,-9.53pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T3.2.2.2.1.1.1.1">ETTh<sub class="ltx_sub" id="S4.T3.2.2.2.1.1.1.1.1">2</sub></span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.2.2.2.2">24</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T3.2.2.2.3.1">0.588</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.2.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.T3.2.2.2.4.1">0.543</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2.5">0.720</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.2.2.2.6">0.665</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2.7">0.828</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.2.2.2.8">0.750</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2.9">1.531</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.2.2.2.10">1.613</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2.11">1.143</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.2.2.2.12">0.813</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2.13">2.742</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2.14">1.457</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.10.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.10.7.1">48</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.10.7.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.10.7.2.1">0.780</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.10.7.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.10.7.3.1">0.692</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.10.7.4">1.457</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.10.7.5">1.001</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.10.7.6">1.806</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.10.7.7">1.034</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.10.7.8">1.871</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.10.7.9">1.735</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.10.7.10">1.671</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.10.7.11">1.221</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.10.7.12">3.567</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.10.7.13">1.687</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.11.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.11.8.1">168</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.11.8.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.11.8.2.1">3.209</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.11.8.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.11.8.3.1">1.479</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.11.8.4">3.489</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.11.8.5">1.515</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.11.8.6">4.070</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.11.8.7">1.681</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.11.8.8">4.660</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.11.8.9">1.846</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.11.8.10">4.117</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.11.8.11">1.674</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.11.8.12">3.242</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.11.8.13">2.513</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.12.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.12.9.1">336</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.12.9.2">6.289</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.12.9.3">2.192</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.12.9.4"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.12.9.4.1">2.723</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.12.9.5"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.12.9.5.1">1.340</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.12.9.6">3.875</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.12.9.7">1.763</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.12.9.8">4.028</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.12.9.9">1.688</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.12.9.10">3.434</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.12.9.11">1.549</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.12.9.12">2.544</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.12.9.13">2.591</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.13.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.13.10.1">720</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.13.10.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.13.10.2.1">2.835</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.13.10.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.13.10.3.1">1.204</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.13.10.4">3.467</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.13.10.5">1.473</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.13.10.6">3.913</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.13.10.7">1.552</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.13.10.8">5.381</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.13.10.9">2.015</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.13.10.10">3.963</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.13.10.11">1.788</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.13.10.12">4.625</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.13.10.13">3.709</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.3.3.3.1" rowspan="5"><span class="ltx_text" id="S4.T3.3.3.3.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T3.3.3.3.1.1.1" style="width:8.6pt;height:32.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:32.4pt;transform:translate(-11.87pt,-10.97pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T3.3.3.3.1.1.1.1">ETTm<sub class="ltx_sub" id="S4.T3.3.3.3.1.1.1.1.1">1</sub></span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.3.3.3.2">24</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.3.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.3.3.1">0.264</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.3.4"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.3.4.1">0.301</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.3.5">0.323</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.3.6">0.369</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.3.7">0.419</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.3.8">0.412</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.3.9">0.724</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.3.10">0.607</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.3.11">0.621</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.3.12">0.629</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.3.13">1.968</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.3.14">1.170</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.14.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.14.11.1">48</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.14.11.2">0.714</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.14.11.3">0.561</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.14.11.4"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.14.11.4.1">0.494</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.14.11.5"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.14.11.5.1">0.503</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.14.11.6">0.507</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.14.11.7">0.583</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.14.11.8">1.098</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.14.11.9">0.777</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.14.11.10">1.392</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.14.11.11">0.939</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.14.11.12">1.999</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.14.11.13">1.215</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.15.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.15.12.1">96</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.15.12.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.15.12.2.1">0.487</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.15.12.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.15.12.3.1">0.511</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.15.12.4">0.678</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.15.12.5">0.614</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.15.12.6">0.768</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.15.12.7">0.792</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.15.12.8">1.433</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.15.12.9">0.945</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.15.12.10">1.339</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.15.12.11">0.913</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.15.12.12">2.762</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.15.12.13">1.542</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.16.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.16.13.1">288</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.16.13.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.16.13.2.1">0.522</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.16.13.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.16.13.3.1">0.522</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.16.13.4">1.056</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.16.13.5">0.786</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.16.13.6">1.462</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.16.13.7">1.320</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.16.13.8">1.820</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.16.13.9">1.094</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.16.13.10">1.740</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.16.13.11">1.124</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.16.13.12">1.257</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.16.13.13">2.076</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.17.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.17.14.1">672</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.17.14.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.17.14.2.1">0.774</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.17.14.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.17.14.3.1">0.658</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.17.14.4">1.192</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.17.14.5">0.926</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.17.14.6">1.669</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.17.14.7">1.461</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.17.14.8">2.187</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.17.14.9">1.232</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.17.14.10">2.736</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.17.14.11">1.555</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.17.14.12">1.917</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.17.14.13">2.941</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.18.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.3.3.18.15.1" rowspan="5"><span class="ltx_text" id="S4.T3.3.3.18.15.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T3.3.3.18.15.1.1.1" style="width:6.9pt;height:36.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:36.7pt;transform:translate(-14.88pt,-14.88pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T3.3.3.18.15.1.1.1.1">Weather</span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.3.3.18.15.2">24</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.18.15.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.18.15.3.1">0.307</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.18.15.4"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.18.15.4.1">0.349</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.18.15.5">0.335</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.18.15.6">0.381</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.18.15.7">0.435</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.18.15.8">0.477</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.18.15.9">0.655</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.18.15.10">0.583</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.18.15.11">0.546</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.18.15.12">0.570</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.18.15.13">0.615</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.18.15.14">0.545</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.19.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.19.16.1">48</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.19.16.2">0.409</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.19.16.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.19.16.3.1">0.450</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.19.16.4"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.19.16.4.1">0.395</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.19.16.5">0.459</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.19.16.6">0.426</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.19.16.7">0.495</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.19.16.8">0.729</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.19.16.9">0.666</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.19.16.10">0.829</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.19.16.11">0.677</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.19.16.12">0.660</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.19.16.13">0.589</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.20.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.20.17.1">168</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.20.17.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.20.17.2.1">0.527</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.20.17.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.20.17.3.1">0.537</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.20.17.4">0.608</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.20.17.5">0.567</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.20.17.6">0.727</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.20.17.7">0.671</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.20.17.8">1.318</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.20.17.9">0.855</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.20.17.10">1.038</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.20.17.11">0.835</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.20.17.12">0.748</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.20.17.13">0.647</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.21.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.21.18.1">336</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.21.18.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.21.18.2.1">0.582</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.21.18.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.21.18.3.1">0.576</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.21.18.4">0.702</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.21.18.5">0.620</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.21.18.6">0.754</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.21.18.7">0.670</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.21.18.8">1.930</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.21.18.9">1.167</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.21.18.10">1.657</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.21.18.11">1.059</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.21.18.12">0.782</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.21.18.13">0.683</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.22.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.22.19.1">720</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.22.19.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.22.19.2.1">0.762</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.22.19.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.22.19.3.1">0.670</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.22.19.4">0.831</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.22.19.5">0.731</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.22.19.6">0.885</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.22.19.7">0.773</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.22.19.8">2.726</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.22.19.9">1.575</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.22.19.10">1.536</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.22.19.11">1.109</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.22.19.12">0.851</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.22.19.13">0.757</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.23.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.3.3.23.20.1" rowspan="5"><span class="ltx_text" id="S4.T3.3.3.23.20.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T3.3.3.23.20.1.1.1" style="width:6.8pt;height:20.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:20.3pt;transform:translate(-6.72pt,-6.72pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T3.3.3.23.20.1.1.1.1">ECL</span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.3.3.23.20.2">48</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.23.20.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.23.20.3.1">0.294</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.23.20.4"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.23.20.4.1">0.379</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.23.20.5">0.344</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.23.20.6">0.393</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.23.20.7">0.355</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.23.20.8">0.418</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.23.20.9">1.404</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.23.20.10">0.999</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.23.20.11">0.486</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.23.20.12">0.572</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.23.20.13">0.369</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.23.20.14">0.445</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.24.21">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.24.21.1">168</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.24.21.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.24.21.2.1">0.282</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.24.21.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.24.21.3.1">0.375</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.24.21.4">0.368</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.24.21.5">0.424</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.24.21.6">0.368</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.24.21.7">0.432</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.24.21.8">1.515</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.24.21.9">1.069</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.24.21.10">0.574</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.24.21.11">0.602</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.24.21.12">0.394</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.24.21.13">0.476</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.25.22">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.25.22.1">336</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.25.22.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.25.22.2.1">0.287</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.25.22.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.25.22.3.1">0.375</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.25.22.4">0.381</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.25.22.5">0.431</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.25.22.6">0.373</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.25.22.7">0.439</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.25.22.8">1.601</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.25.22.9">1.104</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.25.22.10">0.886</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.25.22.11">0.795</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.25.22.12">0.419</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.25.22.13">0.477</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.26.23">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.26.23.1">720</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.26.23.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.26.23.2.1">0.368</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.26.23.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.26.23.3.1">0.391</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.26.23.4">0.406</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.26.23.5">0.443</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.26.23.6">0.409</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.26.23.7">0.454</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.26.23.8">2.009</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.26.23.9">1.170</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.26.23.10">1.676</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.26.23.11">1.095</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.26.23.12">0.556</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.26.23.13">0.565</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.27.24">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.27.24.1">960</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.27.24.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.27.24.2.1">0.417</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.27.24.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.27.24.3.1">0.497</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.27.24.4">0.460</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.27.24.5">0.548</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.27.24.6">0.477</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.27.24.7">0.589</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.27.24.8">2.141</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.27.24.9">1.387</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.27.24.10">1.591</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.3.3.27.24.11">1.128</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.27.24.12">0.605</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.27.24.13">0.599</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3.28.25">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" colspan="2" id="S4.T3.3.3.28.25.1">Count</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_t" colspan="2" id="S4.T3.3.3.28.25.2">43</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_t" colspan="2" id="S4.T3.3.3.28.25.3">7</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_t" colspan="2" id="S4.T3.3.3.28.25.4">0</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_t" colspan="2" id="S4.T3.3.3.28.25.5">0</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_t" colspan="2" id="S4.T3.3.3.28.25.6">0</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_t" colspan="2" id="S4.T3.3.3.28.25.7">0</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Multivariate long sequence time-series forecasting results on the datasets described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.SS1" title="4.1 Experimental Details ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">After comparing the sizes of the models, we proceed to examine the results of multivariate predictions. A comprehensive comparison of all algorithms for the ETTh1, ETTh2, ETTm1, Weather, and ECL datasets is presented in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.T3" title="In 4.2 Local Attention Mechanism against the state-of-the-art ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">3</span></a>. The most notable aspect of the table is the superior performance of LAM. Out of 50 combinations of results and metrics, LAM ranks highest in 43, followed by Informer, which leads in 7. When compared to Reformer and LogTrans, our approach significantly outperforms their results. This superiority is even more pronounced in comparison to LSTMa and LST-Net, particularly with longer prediction horizons, where the performance gap is the largest. This can be attributed to the capability of our architecture to capture long-term dependencies. While LSTM-based algorithms perform well with short prediction horizons, LAM demonstrates substantial improvement and superior performance with longer prediction horizons, supporting the hypothesis that transformers are better equipped for LSTF problems.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.3">Focusing on a direct comparison between LAM and Informer allows for a more detailed case-by-case analysis. Overall, LAM outperforms Informer, particularly for large forecast horizons in the ETT datasets. For example, in the case of ETTh2 with a forecast window of <math alttext="720" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mn id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">720</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><cn id="S4.SS2.p4.1.m1.1.1.cmml" type="integer" xref="S4.SS2.p4.1.m1.1.1">720</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">720</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">720</annotation></semantics></math>, LAM achieves an MSE of <math alttext="2.8" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mn id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">2.8</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><cn id="S4.SS2.p4.2.m2.1.1.cmml" type="float" xref="S4.SS2.p4.2.m2.1.1">2.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">2.8</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">2.8</annotation></semantics></math> compared to Informer’s <math alttext="3.4" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mn id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml">3.4</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><cn id="S4.SS2.p4.3.m3.1.1.cmml" type="float" xref="S4.SS2.p4.3.m3.1.1">3.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">3.4</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">3.4</annotation></semantics></math>. Although LAM also demonstrates superior performance in the ECL and Weather datasets, the margin of superiority is not as pronounced as in the ETT datasets.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="741" id="S4.F5.sf1.g1" src="x11.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>MSE Bayesian test</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="741" id="S4.F5.sf2.g1" src="x12.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MAE Bayesian test</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Bayesian tests for Informer vs LAM</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1">To better support this comparison, we conducted two Bayesian tests: one focusing on the MSE and the other on the MAE, using a <math alttext="0.05" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><mn id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">0.05</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><cn id="S4.SS2.p5.1.m1.1.1.cmml" type="float" xref="S4.SS2.p5.1.m1.1.1">0.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">0.05</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">0.05</annotation></semantics></math> ROPE. As illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.F5.sf1" title="In Figure 5 ‣ 4.2 Local Attention Mechanism against the state-of-the-art ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5(a)</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.F5.sf2" title="In Figure 5 ‣ 4.2 Local Attention Mechanism against the state-of-the-art ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5(b)</span></a>, there is statistically significant superiority of LAM with respect to the rest of algorithms considered. These significant differences underscore the robustness and effectiveness of our model compared to existing LSTF algorithms. Consequently, this provides strong validation for our experimentation methodology and supports the reliability of the conclusions drawn from our study.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Comparing LAM and ProbAttn within the same architecture framework</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Following the above comparison, it is pertinent to consider whether the two attention mechanisms, LAM and ProbAttn (Informer’s attention mechanism) are competing on equal terms. Informer is a significantly more complex model than the vanilla transformer integrating LAM. The Informer model utilises its own positional encoding based on various time frequencies (seconds, minutes, hours, weeks, etc.) and incorporates layers such as one-dimensional convolutions to facilitate feature extraction from the dataset. Therefore, before proceeding with further experimentation, it is essential to compare LAM and ProbAttn by aligning the frameworks under which both attention mechanisms are implemented. To this end, we will compare the results obtained by ProbAttn and LAM within the vanilla transformer architecture, to isolate the effects of Informer’s attention mechanism with respect to the characteristics of its architecture. This involves using only fully connected layers and the sine-based positional encoding from the original proposal by Vaswani et al <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib20" title="">20</a>]</cite>, instead of the complex architecture of Informer.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.4" style="width:260.2pt;height:769.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(26.7pt,-78.9pt) scale(1.25773062113026,1.25773062113026) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.4.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.4.4.5.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="2" id="S4.T4.4.4.5.1.1">Attention</th>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S4.T4.4.4.5.1.2">LAM</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S4.T4.4.4.5.1.3">ProbAttn</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.6.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" colspan="2" id="S4.T4.4.4.6.2.1">Metric</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.6.2.2">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.4.6.2.3">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.6.2.4">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.6.2.5">MAE</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.1.1.1.1" rowspan="5"><span class="ltx_text" id="S4.T4.1.1.1.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T4.1.1.1.1.1.1" style="width:8.7pt;height:29.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:29.6pt;transform:translate(-10.43pt,-9.53pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T4.1.1.1.1.1.1.1">ETTh<sub class="ltx_sub" id="S4.T4.1.1.1.1.1.1.1.1">1</sub></span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.1.1.1.2">24</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.1.3.1">0.471</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.1.4.1">0.448</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.5">0.498</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.6">0.507</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.7.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.7.3.1">48</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.7.3.2">0.560</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.7.3.3">0.545</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.7.3.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.7.3.4.1">0.501</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.7.3.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.7.3.5.1">0.515</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.8.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.8.4.1">168</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.8.4.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.8.4.2.1">1.011</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.8.4.3">0.807</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.8.4.4">1.071</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.8.4.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.8.4.5.1">0.804</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.9.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.9.5.1">336</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.9.5.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.9.5.2.1">0.923</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.9.5.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.9.5.3.1">0.756</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.9.5.4">1.002</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.9.5.5">0.796</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.10.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.10.6.1">720</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.10.6.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.10.6.2.1">0.993</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.10.6.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.10.6.3.1">0.732</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.10.6.4">1.470</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.10.6.5">0.963</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.2.2.2.1" rowspan="5"><span class="ltx_text" id="S4.T4.2.2.2.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T4.2.2.2.1.1.1" style="width:8.7pt;height:29.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:29.6pt;transform:translate(-10.43pt,-9.53pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T4.2.2.2.1.1.1.1">ETTh<sub class="ltx_sub" id="S4.T4.2.2.2.1.1.1.1.1">2</sub></span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.2.2.2.2">24</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.2.3.1">0.588</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.2.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.2.4.1">0.543</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.2.2.5">0.742</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.2.2.6">0.683</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.11.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.11.7.1">48</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.11.7.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.11.7.2.1">0.780</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.11.7.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.11.7.3.1">0.692</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.11.7.4">0.881</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.11.7.5">0.715</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.12.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.12.8.1">168</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.12.8.2">3.209</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.12.8.3">1.479</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.12.8.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.12.8.4.1">2.652</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.12.8.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.12.8.5.1">1.380</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.13.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.13.9.1">336</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.13.9.2">6.289</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.13.9.3">2.192</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.13.9.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.13.9.4.1">1.487</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.13.9.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.13.9.5.1">0.950</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.14.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.14.10.1">720</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.14.10.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.14.10.2.1">2.835</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.14.10.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.14.10.3.1">1.204</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.14.10.4">3.234</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.14.10.5">1.314</td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.3.3.1" rowspan="5"><span class="ltx_text" id="S4.T4.3.3.3.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T4.3.3.3.1.1.1" style="width:8.6pt;height:32.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:32.4pt;transform:translate(-11.87pt,-10.97pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T4.3.3.3.1.1.1.1">ETTm<sub class="ltx_sub" id="S4.T4.3.3.3.1.1.1.1.1">1</sub></span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.3.3.3.2">24</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.3.3.3"><span class="ltx_text ltx_font_bold" id="S4.T4.3.3.3.3.1">0.264</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.3.3.3.4"><span class="ltx_text ltx_font_bold" id="S4.T4.3.3.3.4.1">0.301</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.3.3.5">0.543</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.3.3.3.6">0.495</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.15.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.15.11.1">48</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.15.11.2">0.714</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.15.11.3">0.561</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.15.11.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.15.11.4.1">0.698</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.15.11.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.15.11.5.1">0.560</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.16.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.16.12.1">96</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.16.12.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.16.12.2.1">0.487</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.16.12.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.16.12.3.1">0.511</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.16.12.4">0.547</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.16.12.5">0.522</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.17.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.17.13.1">288</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.17.13.2">0.522</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.17.13.3">0.522</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.17.13.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.17.13.4.1">0.502</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.17.13.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.17.13.5.1">0.505</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.18.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.18.14.1">672</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.18.14.2">0.774</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.18.14.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.18.14.3.1">0.658</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.18.14.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.18.14.4.1">0.737</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.18.14.5">0.661</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.4.4.4.1" rowspan="5"><span class="ltx_text" id="S4.T4.4.4.4.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T4.4.4.4.1.1.1" style="width:8.6pt;height:32.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:32.4pt;transform:translate(-11.87pt,-10.97pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T4.4.4.4.1.1.1.1">ETTm<sub class="ltx_sub" id="S4.T4.4.4.4.1.1.1.1.1">2</sub></span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.4.4.4.2">24</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.4.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.4.3.1">0.453</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.4.4.4">0.507</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.4.5">0.482</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.4.6"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.4.6.1">0.502</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.19.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.19.15.1">48</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.19.15.2">0.874</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.19.15.3">0.661</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.19.15.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.19.15.4.1">0.521</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.19.15.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.19.15.5.1">0.535</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.20.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.20.16.1">96</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.20.16.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.20.16.2.1">0.520</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.20.16.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.20.16.3.1">0.526</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.20.16.4">0.788</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.20.16.5">0.641</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.21.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.21.17.1">288</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.21.17.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.21.17.2.1">1.137</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.21.17.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.21.17.3.1">0.799</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.21.17.4">1.639</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.21.17.5">1.045</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.22.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.22.18.1">672</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.22.18.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.22.18.2.1">1.340</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.22.18.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.22.18.3.1">0.933</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.22.18.4">10.35</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.22.18.5">2.609</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.23.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.4.4.23.19.1" rowspan="5"><span class="ltx_text" id="S4.T4.4.4.23.19.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T4.4.4.23.19.1.1.1" style="width:6.8pt;height:25pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:25.0pt;transform:translate(-9.08pt,-9.08pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T4.4.4.23.19.1.1.1.1">WTH</span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.4.4.23.19.2">24</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.23.19.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.23.19.3.1">0.307</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.4.23.19.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.23.19.4.1">0.349</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.23.19.5">0.375</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.23.19.6">0.406</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.24.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.24.20.1">48</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.24.20.2">0.409</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.24.20.3">0.450</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.24.20.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.24.20.4.1">0.406</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.24.20.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.24.20.5.1">0.449</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.25.21">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.25.21.1">168</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.25.21.2">0.527</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.25.21.3">0.537</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.25.21.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.25.21.4.1">0.524</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.25.21.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.25.21.5.1">0.533</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.26.22">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.26.22.1">336</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.26.22.2">0.582</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.26.22.3">0.576</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.26.22.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.26.22.4.1">0.563</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.26.22.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.26.22.5.1">0.563</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.27.23">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.27.23.1">720</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.27.23.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.27.23.2.1">0.762</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.27.23.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.27.23.3.1">0.670</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.27.23.4">0.854</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.27.23.5">0.832</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.28.24">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.4.4.28.24.1" rowspan="5"><span class="ltx_text" id="S4.T4.4.4.28.24.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T4.4.4.28.24.1.1.1" style="width:6.8pt;height:20.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:20.3pt;transform:translate(-6.72pt,-6.72pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T4.4.4.28.24.1.1.1.1">ECL</span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.4.4.28.24.2">48</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.28.24.3">0.294</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.4.4.28.24.4">0.379</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.28.24.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.28.24.5.1">0.279</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.4.4.28.24.6"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.28.24.6.1">0.372</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.29.25">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.29.25.1">168</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.29.25.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.29.25.2.1">0.282</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.29.25.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.29.25.3.1">0.375</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.29.25.4">0.288</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.29.25.5">0.382</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.30.26">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.30.26.1">336</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.30.26.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.30.26.2.1">0.287</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.30.26.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.30.26.3.1">0.375</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.30.26.4">0.333</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.30.26.5">0.417</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.31.27">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.31.27.1">720</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.31.27.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.31.27.2.1">0.368</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.31.27.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.31.27.3.1">0.391</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.31.27.4">0.406</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.31.27.5">0.443</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.32.28">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.32.28.1">960</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.32.28.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.32.28.2.1">0.417</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.4.4.32.28.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.32.28.3.1">0.497</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.32.28.4">0.468</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.32.28.5">0.567</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.33.29">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="2" id="S4.T4.4.4.33.29.1">Count</th>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="2" id="S4.T4.4.4.33.29.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.33.29.2.1">37</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="2" id="S4.T4.4.4.33.29.3">23</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.34.30">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" colspan="2" id="S4.T4.4.4.34.30.1">Accumulated</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.4.34.30.2"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.34.30.2.1">28.979</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.4.4.34.30.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.34.30.3.1">19.976</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.4.34.30.4">34.841</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.4.34.30.5">21.666</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>MSE and MAE comparison between LAM and ProbAttn mechanism. Best results in bold.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.4">The results presented in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.T4" title="In 4.3 Comparing LAM and ProbAttn within the same architecture framework ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a> provide a clear illustration of the performance differences. Notably, LAM outperforms ProbAttn in 37 instances, while ProbAttn prevails in 23. However, it is crucial to also examine the cumulative error across all datasets and scenarios to establish a comprehensive metric. Specifically, the cumulative MSE for LAM is <math alttext="28.979" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mn id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">28.979</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><cn id="S4.SS3.p2.1.m1.1.1.cmml" type="float" xref="S4.SS3.p2.1.m1.1.1">28.979</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">28.979</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">28.979</annotation></semantics></math>, compared to <math alttext="34.841" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mn id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">34.841</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><cn id="S4.SS3.p2.2.m2.1.1.cmml" type="float" xref="S4.SS3.p2.2.m2.1.1">34.841</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">34.841</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">34.841</annotation></semantics></math> for ProbAttn. This indicates that, overall, LAM exhibits a lower cumulative error than ProbAttn. Similarly, for MAE, LAM achieves an accumulated value of <math alttext="19.976" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><mn id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">19.976</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><cn id="S4.SS3.p2.3.m3.1.1.cmml" type="float" xref="S4.SS3.p2.3.m3.1.1">19.976</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">19.976</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">19.976</annotation></semantics></math>, whereas ProbAttn records <math alttext="21.666" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mn id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">21.666</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><cn id="S4.SS3.p2.4.m4.1.1.cmml" type="float" xref="S4.SS3.p2.4.m4.1.1">21.666</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">21.666</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">21.666</annotation></semantics></math>. Additionally, it is noteworthy that, on average, LAM reduces the error of ProbAttn by approximately 25% for longer prediction horizons. This finding corroborates the improvement and stability of our model’s results under the LSTF problem.</p>
</div>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="706" id="S4.F6.sf1.g1" src="x13.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>MSE Bayesian test</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="706" id="S4.F6.sf2.g1" src="x14.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MAE Bayesian test</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Bayesian tests ProbAttn vs LAM</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">To corroborate the data presented in the table, we include the corresponding Bayesian tests, as illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.F6" title="In 4.3 Comparing LAM and ProbAttn within the same architecture framework ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">6</span></a>. These tests reveal that the differences are significant in favour of our proposal, with a probability of 97.2% for MSE and a probability of 93.9% for MAE of LAM being better than ProbAttn. These results support the effectiveness of our proposal within the same comparison framework.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1">In view of the results obtained in this experimentation, we argue that the complex architecture used in Informer is not properly justified. Therefore, the question of determining a transformer architecture that successfully exploits the structure of long-term time series forecasting problems remains open. We note that in the paper that introduced Informer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib22" title="">22</a>]</cite> there is no comparison to the vanilla transformer and, thus, no empirical justification of the changes introduced at the architecture level – the study focuses on comparing ProbAttn with FullAttention within their own architecture and comparing Informer to other models specifically designed for time series forecasting. For completeness, we also include comparisons between LAM and FullAttention in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5" title="5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>On the suitability of benchmark models for the LSTF problem</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">As a conclusion to this experimentation, we have identified several areas for improvement in the literature. Firstly, all datasets utilised have a relatively small number of samples; none exceeds 100,000 instances (<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4.T1" title="In 4.1 Experimental Details ‣ 4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>). Transformer models for long-sequence time series forecasting, being highly complex architectures in terms of the number of weights, require a substantial amount of data to effectively train all parameters. The current datasets are insufficient in terms of sample size for this task, which produces results that are not sufficiently conclusive. Additionally, the datasets do not always encompass a large set of features. An increase in the number of variables or features inherently increases the complexity of multivariate prediction for LSTF, leading to more interesting problems.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">Analysing the ETT datasets in greater detail, we observe that there are four variants of the same dataset. Specifically, the nature of the data for ETTh1 and ETTm1 is the same as for ETTh2 and ETTm2; they represent the same problem but are derived from different sources. Additionally, each dataset has been sampled at 15-minute intervals (ETTm) and one-hour intervals (ETTh). In the context of long-term time series forecasting, it is crucial to provide as much granularity as possible to extend the prediction horizon effectively and meaningfully as otherwise the model will essentially be trained to predict averages. Thus, including two variants of the same problem with different sampling intervals does not appear to be justified.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1">Recall that the WTH dataset is deals with the prediction of weather-related values. Weather forecasting is known to be an exceedingly complex problem that requires extensive information to predict future instances with any degree of accuracy. Despite this complexity, weather forecasting is typically not aimed at long prediction horizons due to the inherent increase in error over time. Therefore, we consider this dataset to be unsuitable as a benchmark dataset for long-term time series forecasting. Additionally, the WTH dataset only provides hourly resolution, limiting the ability to extend the prediction horizon per instance without significantly increasing the risk of a high margin of error.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.1">Lastly, let us analyse the ECL dataset, which represents the electricity consumption of 321 stations within the electricity grid over approximately two years with an hourly sampling frequency. While the scope of this dataset is relatively similar to that of the ETT dataset, certain distinctions can be observed. Notably, the dataset has a very low resolution of data collection. With only two years of data and an hourly sampling frequency to model a total of 321 variables representing all stations, the feature-to-instance ratio is excessively high. This imbalance makes it challenging to effectively address the problem using this dataset.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p5">
<p class="ltx_p" id="S4.SS4.p5.1">For these reasons, we believe that the currently used datasets, while useful for measuring model performance, are insufficient to establish a comprehensive benchmark for time series analysis in general, or for the Long Sequence Time-series Forecasting (LSTF) problem in particular. Consequently, we recognise the necessity of obtaining new datasets that more accurately represent the LSTF problem to better evaluate model performance. This need will be addressed in the following section of this paper.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Towards a suitable collection of datasets for LSTF benchmarking</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">To evaluate the performance of LAM in LSTF problems, we have highlighted a new set of experiments using datasets from various domains with real-world characteristics, allowing the exploration of inherent characteristics of transformers for LSTF. This section details the experimental framework, including the datasets and algorithms involved. Finally, we present and discuss the results obtained.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Details</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">Datasets:</span> For this experiment, we selected four datasets: Individual Household Electric Power (IHEP) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib44" title="">44</a>]</cite>, New York Taxi (NYTaxi) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib45" title="">45</a>]</cite>, Residential Power Battery (RPB) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib46" title="">46</a>]</cite>, and Time-series Industrial Anomaly (TiNA) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib48" title="">48</a>]</cite>. The IHEP dataset contains over 200,000 samples with 9 features, representing household electricity consumption measurements over a 4-year period. The NYTaxi dataset includes over 2 million instances with 6 features, such as distance travelled, number of passengers, amount paid, and trip duration. These metrics are aggregated by summing all trips within the same hour, allowing the dataset to support predictions for subsequent hours, days, or weeks. The RPB dataset comprises more than 500,000 samples with 6 features, measuring the actual consumption of a population, solar power generation, and battery levels. Finally, the TiNA dataset includes over 38 million instances with 108 features, sampled every two seconds. This dataset is a real-world dataset provided by ArcelorMittal, reflecting data from an ore mining machine.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">These datasets contain a large number of instances, allowing us to extend the prediction horizons substantially compared to the Informer-derived experimentation. Specifically, for the RPB and IHEP datasets, the window sizes are 180, 360, 720, 1440, and 4320, corresponding to 3 hours, 6 hours, 12 hours, 24 hours, and 3 days, respectively. For the NYTaxi dataset, the sequence sizes used were 120, 240, 720, 1440, and 2160, representing 2 days, 4 days, 12 days, 24 days, and 36 days, respectively. Finally, for the TiNA dataset, sequence sizes of 360, 720, 1440, 2880, and 5760 were used, corresponding to 3 hours, 6 hours, 12 hours, 24 hours, and 2 days, respectively. As shown, the predictions are long-term, aiming for the longest possible prediction horizon that is meaningful for each problem. The sequence size refers to both the input size of the network and the size of the prediction to be made.</p>
</div>
<figure class="ltx_table" id="S5.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.2.1">Instances</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.3.1">Features</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.4.1">Sampling</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T5.1.2.1.1">IHEP</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T5.1.2.1.2">2,075,259</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T5.1.2.1.3">7</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T5.1.2.1.4">1 minute</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.3.2">
<td class="ltx_td ltx_align_left" id="S5.T5.1.3.2.1">NYTaxi</td>
<td class="ltx_td ltx_align_left" id="S5.T5.1.3.2.2">2,091,896</td>
<td class="ltx_td ltx_align_left" id="S5.T5.1.3.2.3">6</td>
<td class="ltx_td ltx_align_left" id="S5.T5.1.3.2.4">1 hour</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.4.3">
<td class="ltx_td ltx_align_left" id="S5.T5.1.4.3.1">RPB</td>
<td class="ltx_td ltx_align_left" id="S5.T5.1.4.3.2">614,880</td>
<td class="ltx_td ltx_align_left" id="S5.T5.1.4.3.3">4</td>
<td class="ltx_td ltx_align_left" id="S5.T5.1.4.3.4">1 minute</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T5.1.5.4.1">TiNA</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T5.1.5.4.2">38,000,000</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T5.1.5.4.3">103</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T5.1.5.4.4">1 second</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Datasets description. Number of instances, features and sampling rates are displayed in the table.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.1">Multivariate prediction and error metrics:</span>
Within this framework, the same target task and metrics outlined in the previous section are employed, alongside Bayesian tests. For validation, a data partitioning scheme of 70% training data and 30% testing data has been utilised.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">Algorithms:</span> In the experimentation provided in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4" title="4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4</span></a>, Informer and LAM are the closest models in terms of performance. The other algorithms, including transformers such as LogTrans and Reformer, showed significantly poorer results. Consequently, we have decided to exclude these algorithms from this comparison to obtain concise and more interpretable results. Therefore, we have retained Informer and our proposed model, and added the vanilla transformer with its attention mechanism (FullAttention) to serve as a baseline. For our proposed model and the vanilla attention mechanism, the optimal depth was determined through hyperparameter tuning. The transformer architecture employed is a fully connected, symmetric structure with an equal number of encoding and decoding layers. The depth was varied between 2, 3, 5, 7, and 10 layers, contingent upon memory capacity, to identify the best configuration. This parameter will be named as number of encoding-decoding layers for the rest of the section. By using the same architecture to baseline the vanilla attention mechanism, we ensure that the observed results can be solely attributed to our proposal and the network depth. The same standardisation and metrics introduced in the previous section are used for the present one. The train/validation/test split utilised in this study allocated 70% of the data for training, with 15% of this subset further designated for validation and the remaining 85% for training. The remaining 30% of the data was used as the test set.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p5">
<p class="ltx_p" id="S5.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p5.1.1">Hardware and Code:</span> The same hardware used in the experimentation of Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4" title="4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">4</span></a> has been kept in order to obtain consistent results. The code is also hosted in the repository<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://github.com/ari-dasci/S-LAM</span></span></span> provided in previous sections.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Results and Analysis</h3>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.2">In this section, we will analyse the results obtained from the datasets previously described in the framework explanation section. First, we refer to the results presented in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.T6" title="In 5.2 Results and Analysis ‣ 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">6</span></a>. A notable observation from this table is the presence of empty cells, which indicate execution problems due to memory limitations for certain parameter combinations. As evident, our proposed model is the only one capable of running in all scenarios. This is attributable to the low number of parameters in our model (shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S4" title="4 Empirical comparison to the state of the art ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a>), resulting from its simplicity in the encoder-decoder architecture as opposed to Informer’s architecture, and the <math alttext="\Theta(n\log n)" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.3" mathvariant="normal" xref="S5.SS2.p1.1.m1.1.1.3.cmml">Θ</mi><mo id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S5.SS2.p1.1.m1.1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S5.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S5.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS2.p1.1.m1.1.1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.1.1.1.2.cmml">n</mi><mo id="S5.SS2.p1.1.m1.1.1.1.1.1.1" lspace="0.167em" xref="S5.SS2.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S5.SS2.p1.1.m1.1.1.1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S5.SS2.p1.1.m1.1.1.1.1.1.3.1" xref="S5.SS2.p1.1.m1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S5.SS2.p1.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="S5.SS2.p1.1.m1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S5.SS2.p1.1.m1.1.1.1.1.1.3.2" xref="S5.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S5.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S5.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><times id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2"></times><ci id="S5.SS2.p1.1.m1.1.1.3.cmml" xref="S5.SS2.p1.1.m1.1.1.3">Θ</ci><apply id="S5.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1"><times id="S5.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1.1.1"></times><ci id="S5.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1.1.2">𝑛</ci><apply id="S5.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1.1.3"><log id="S5.SS2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1.1.3.1"></log><ci id="S5.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\Theta(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">roman_Θ ( italic_n roman_log italic_n )</annotation></semantics></math> memory requirement for LAM as opposed to the <math alttext="\Theta(n^{2})" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mrow id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.p1.2.m2.1.1.3" mathvariant="normal" xref="S5.SS2.p1.2.m2.1.1.3.cmml">Θ</mi><mo id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S5.SS2.p1.2.m2.1.1.1.1" xref="S5.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo id="S5.SS2.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S5.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><msup id="S5.SS2.p1.2.m2.1.1.1.1.1" xref="S5.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S5.SS2.p1.2.m2.1.1.1.1.1.2" xref="S5.SS2.p1.2.m2.1.1.1.1.1.2.cmml">n</mi><mn id="S5.SS2.p1.2.m2.1.1.1.1.1.3" xref="S5.SS2.p1.2.m2.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S5.SS2.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S5.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><times id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2"></times><ci id="S5.SS2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3">Θ</ci><apply id="S5.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1.1">superscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.1.1.1.2">𝑛</ci><cn id="S5.SS2.p1.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS2.p1.2.m2.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\Theta(n^{2})</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">roman_Θ ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> memory ussage of FullAttention. Out of the total 20 execution scenarios, Informer successfully executes in 17, while the vanilla transformer executes in 12. These findings highlight the superior performance of our model when dealing with large prediction horizons and highlights the importance of efficient attention mechanisms, both from a time and memory point of view.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">In terms of performance, LAM shows clear superiority. The table presents error results using MSE and MAE metrics. Out of the 40 cells that summarise both metrics, LAM achieves the lowest error in 32 instances and ties in 2. Informer prevails in 4 instances, while the Vanilla transformer ties in 2 and wins in 2. When analysed by dataset, NYTaxi appears to be the easiest to address, as all three algorithms exhibit lower error rates for this dataset. Conversely, for the RPB dataset, Informer and our proposal yield similar results, indicating close performance. In the IHEP dataset, and particularly in the TiNA dataset, there is a significant performance gap favouring our proposal. Comparing with the Vanilla transformer, it is evident that while it runs in fewer instances, it generally performs better than Informer, except perhaps for the RPB dataset, where their results are comparable.</p>
</div>
<figure class="ltx_table" id="S5.T6">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T6.1" style="width:137.4pt;height:173.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-102.4pt,129.3pt) scale(0.401493849577727,0.401493849577727) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T6.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T6.1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S5.T6.1.1.1.1.1">Attention</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="3" id="S5.T6.1.1.1.1.2">LAM</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S5.T6.1.1.1.1.3">Informer</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="3" id="S5.T6.1.1.1.1.4">Vanilla</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T6.1.1.2.2.1">Metric</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.2.2.2">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.2.2.3">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.2.2.4">Layers</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.2.2.5">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.2.2.6">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.2.2.7">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.2.2.8">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.2.2.9">Layers</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.3.3.1" rowspan="5"><span class="ltx_text" id="S5.T6.1.1.3.3.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T6.1.1.3.3.1.1.1" style="width:6.8pt;height:24.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:24.7pt;transform:translate(-8.94pt,-8.94pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T6.1.1.3.3.1.1.1.1">IHEP</span>
</span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.3.3.2">180</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.3.3.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.3.3.3.1">0.956</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.3.3.4"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.3.3.4.1">0.665</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.3.3.5">5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.3.3.6">1.272</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.3.3.7">0.818</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.3.3.8">1.021</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.3.3.9">0.702</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.3.3.10">5</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.4.4.1">360</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.4.4.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.4.4.2.1">0.942</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.4.4.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.4.4.3.1">0.670</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.4.4.4">7</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.4.4.5">1.295</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.4.4.6">0.828</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.4.4.7">0.979</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.4.4.8">0.706</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.4.4.9">5</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.5.5.1">720</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.5.5.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.5.5.2.1">0.973</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.5.5.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.5.5.3.1">0.678</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.5.5.4">5</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.5.5.5">1.244</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.5.5.6">0.817</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.5.5.7"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.5.5.7.1">0.973</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.5.5.8"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.5.5.8.1">0.678</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.5.5.9">3</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.6.6.1">1440</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.6.6.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.6.6.2.1">0.898</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.6.6.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.6.6.3.1">0.644</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.6.6.4">10</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.6.6.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.6.6.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.6.6.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.6.6.8">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.6.6.9">-</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.7.7.1">4320</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.7.7.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.7.7.2.1">0.977</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.7.7.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.7.7.3.1">0.698</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.7.7.4">3</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.7.7.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.7.7.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.7.7.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.7.7.8">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.7.7.9">-</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.8.8.1" rowspan="5"><span class="ltx_text" id="S5.T6.1.1.8.8.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T6.1.1.8.8.1.1.1" style="width:6.8pt;height:34.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:34.4pt;transform:translate(-13.81pt,-13.81pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T6.1.1.8.8.1.1.1.1">NYTaxi</span>
</span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.8.8.2">120</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.8.8.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.8.8.3.1">0.076</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.8.8.4"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.8.8.4.1">0.209</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.8.8.5">5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.8.8.6">0.366</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.8.8.7">0.480</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.8.8.8">0.112</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.8.8.9">0.248</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.8.8.10">3</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.9.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.9.9.1">240</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.9.9.2">0.082</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.9.9.3">0.221</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.9.9.4">5</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.9.9.5">0.376</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.9.9.6">0.515</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.9.9.7"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.9.9.7.1">0.068</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.9.9.8"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.9.9.8.1">0.203</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.9.9.9">2</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.10.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.10.10.1">720</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.10.10.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.10.10.2.1">0.082</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.10.10.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.10.10.3.1">0.212</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.10.10.4">5</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.10.10.5">0.359</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.10.10.6">0.496</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.10.10.7">0.092</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.10.10.8">0.223</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.10.10.9">3</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.11.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.11.11.1">1440</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.11.11.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.11.11.2.1">0.112</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.11.11.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.11.11.3.1">0.239</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.11.11.4">3</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.11.11.5">0.291</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.11.11.6">0.435</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.11.11.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.11.11.8">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.11.11.9">-</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.12.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.12.12.1">2160</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.12.12.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.12.12.2.1">0.103</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.12.12.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.12.12.3.1">0.223</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.12.12.4">10</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.12.12.5">0.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.12.12.6">0.505</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.12.12.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.12.12.8">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.12.12.9">-</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.13.13">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.13.13.1" rowspan="5"><span class="ltx_text" id="S5.T6.1.1.13.13.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T6.1.1.13.13.1.1.1" style="width:6.8pt;height:21.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:21.3pt;transform:translate(-7.21pt,-7.21pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T6.1.1.13.13.1.1.1.1">RPB</span>
</span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.13.13.2">180</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.13.13.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.13.13.3.1">2.999</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.13.13.4"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.13.13.4.1">1.321</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.13.13.5">3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.13.13.6">3.402</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.13.13.7">1.431</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.13.13.8">3.123</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.13.13.9">1.335</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.13.13.10">2</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.14.14">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.14.14.1">360</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.14.14.2">2.985</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.14.14.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.14.14.3.1">1.304</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.14.14.4">7</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.14.14.5"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.14.14.5.1">2.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.14.14.6">1.344</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.14.14.7">3.015</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.14.14.8">1.327</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.14.14.9">3</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.15.15">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.15.15.1">720</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.15.15.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.15.15.2.1">2.996</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.15.15.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.15.15.3.1">1.319</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.15.15.4">3</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.15.15.5">3.383</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.15.15.6">1.419</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.15.15.7">3.054</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.15.15.8">1.334</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.15.15.9">2</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.16.16">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.16.16.1">1440</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.16.16.2">3.081</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.16.16.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.16.16.3.1">1.346</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.16.16.4">3</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.16.16.5"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.16.16.5.1">2.926</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.16.16.6">1.35</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.16.16.7">3.114</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.16.16.8">1.362</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.16.16.9">2</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.17.17">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.17.17.1">4320</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.17.17.2">3.027</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.17.17.3">1.325</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.17.17.4">2</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.17.17.5"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.17.17.5.1">2.822</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.17.17.6"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.17.17.6.1">1.314</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.17.17.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.17.17.8">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.17.17.9">-</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.18.18">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.18.18.1" rowspan="5"><span class="ltx_text" id="S5.T6.1.1.18.18.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T6.1.1.18.18.1.1.1" style="width:6.8pt;height:25pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:25.0pt;transform:translate(-9.08pt,-9.08pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T6.1.1.18.18.1.1.1.1">TiNA</span>
</span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.18.18.2">360</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.18.18.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.18.18.3.1">1.843</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.18.18.4"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.18.18.4.1">0.858</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.18.18.5">3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.18.18.6">2.044</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.18.18.7">0.954</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.18.18.8">1.854</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.18.18.9">0.863</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.18.18.10">3</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.19.19">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.19.19.1">720</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.19.19.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.19.19.2.1">1.849</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.19.19.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.19.19.3.1">0.863</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.19.19.4">7</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.19.19.5">2.148</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.19.19.6">0.976</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.19.19.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.19.19.8">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.19.19.9">-</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.20.20">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.20.20.1">1440</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.20.20.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.20.20.2.1">1.857</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.20.20.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.20.20.3.1">0.867</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.20.20.4">10</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.20.20.5">2.033</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.20.20.6">0.940</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.20.20.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.20.20.8">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.20.20.9">-</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.21.21">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.21.21.1">2880</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.21.21.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.21.21.2.1">1.827</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.21.21.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.21.21.3.1">0.850</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.21.21.4">10</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.21.21.5">2.020</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.21.21.6">0.944</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.21.21.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.21.21.8">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.21.21.9">-</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.22.22">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.22.22.1">5760</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.22.22.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.22.22.2.1">1.838</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.22.22.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.22.22.3.1">0.853</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.22.22.4">7</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.22.22.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.22.22.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.22.22.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.22.22.8">-</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.22.22.9">-</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.23.23">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T6.1.1.23.23.1">Count</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="3" id="S5.T6.1.1.23.23.2">34</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="2" id="S5.T6.1.1.23.23.3">4</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="3" id="S5.T6.1.1.23.23.4">4</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.24.24">
<td class="ltx_td ltx_align_center ltx_border_bb" colspan="2" id="S5.T6.1.1.24.24.1">Mean Accumulated</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.1.24.24.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.24.24.2.1">1.475</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.1.24.24.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.24.24.3.1">0.768</span></td>
<td class="ltx_td ltx_border_bb ltx_border_r" id="S5.T6.1.1.24.24.4"></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.1.24.24.5">1.722</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T6.1.1.24.24.6">0.915</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.1.24.24.7">1.582</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.1.24.24.8">0.816</td>
<td class="ltx_td ltx_border_bb" id="S5.T6.1.1.24.24.9"></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Multivariate forecasting over the Individual Household Electric Power dataset (IHEP), New York Taxi dataset (NYTaxi), Residential Power Battery dataset (RPB) and Time-series Industrial Anomaly dataset (TiNA). MSE and MAE are presented in the table, the lower the better, best results in bold. Empty cells are due to the impossibility of executing the algorithm for these parameters due to memory problems given the size of the model. Layers represent the best configuration of encoding-decoding layers used to obtain the presented results. Count stands for best result counts. Mean Accumulated is computed as the added error divided by the number of valid rows in the table (non-empty). The Vanilla algorithm is the original transformer proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib20" title="">20</a>]</cite>.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">Although the results presented in the aforementioned table demonstrate the validity and quality of our proposal, the influence of the number of layers within this comparison warrants further examination. The results may be highly sensitive to this configuration, potentially presenting a distorted image of the outcomes. As observed in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.T6" title="In 5.2 Results and Analysis ‣ 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">6</span></a>, there is a variety of optimal configurations for each dataset and sequence size. Therefore, we present the results with a fixed architecture for both Vanilla and LAMin <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.T7" title="In 5.2 Results and Analysis ‣ 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">7</span></a>. These results were obtained using the largest architecture that can run completely on all datasets for both models: 5 encoding-decoding layers for Vanilla and 7 encoding-decoding layers for LAM. This approach provides a consistent performance comparison with a fixed architecture, allowing us to contrast these findings with the results in the aforementioned table.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p4">
<p class="ltx_p" id="S5.SS2.p4.1">As observed in the <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.T7" title="In 5.2 Results and Analysis ‣ 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">7</span></a>, LAM consistently emerges as the superior algorithm in this comparison. Specifically, it outperforms the other algorithms 31 times, whereas Informer obtains better results 5 times, and Vanilla wins 4 times. This demonstrates the clear superiority of our proposal over both the baseline and Informer models. Regarding the mean of the MSE and MAE across rows with valid values, Vanilla appears to have a slight edge. However, it is important to note that these results are significantly influenced by Vanilla’s inability to run under numerous circumstances due to its computational demands. Consequently, these findings strongly establish the validity of our proposal, even when utilising a fixed architecture.</p>
</div>
<figure class="ltx_table" id="S5.T7">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T7.1" style="width:105.0pt;height:173.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-78.3pt,129.3pt) scale(0.401493849577727,0.401493849577727) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T7.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T7.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="2" id="S5.T7.1.1.1.1.1">Attention</th>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S5.T7.1.1.1.1.2">LAM</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S5.T7.1.1.1.1.3">Informer</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S5.T7.1.1.1.1.4">Vanilla</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" colspan="2" id="S5.T7.1.1.2.2.1">Metric</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.2.2.2">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.2.2.3">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.2.2.4">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.2.2.5">MAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.2.2.6">MSE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.2.2.7">MAE</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.3.3.1" rowspan="5"><span class="ltx_text" id="S5.T7.1.1.3.3.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T7.1.1.3.3.1.1.1" style="width:6.8pt;height:24.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:24.7pt;transform:translate(-8.94pt,-8.94pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T7.1.1.3.3.1.1.1.1">IHEP</span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.3.3.2">180</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.3.3.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.3.3.3.1">0.994</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.3.3.4"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.3.3.4.1">0.692</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.3.3.5">1.272</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.3.3.6">0.818</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.3.3.7">1.036</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.3.3.8">0.706</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.4.4.1">360</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.4.4.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.4.4.2.1">0.942</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.4.4.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.4.4.3.1">0.670</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.4.4.4">1.295</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.4.4.5">0.828</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.4.4.6">0.979</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.4.4.7">0.706</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.5.5.1">720</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.5.5.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.5.5.2.1">0.984</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.5.5.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.5.5.3.1">0.695</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.5.5.4">1.244</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.5.5.5">0.817</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.5.5.6">1.070</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.5.5.7">0.730</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.6.6.1">1440</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.6.6.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.6.6.2.1">1.030</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.6.6.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.6.6.3.1">0.739</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.6.6.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.6.6.5">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.6.6.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.6.6.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.7.7.1">4320</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.7.7.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.7.7.2.1">1.013</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.7.7.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.7.7.3.1">0.702</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.7.7.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.7.7.5">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.7.7.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.7.7.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.8.8.1" rowspan="5"><span class="ltx_text" id="S5.T7.1.1.8.8.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T7.1.1.8.8.1.1.1" style="width:6.8pt;height:34.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:34.4pt;transform:translate(-13.81pt,-13.81pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T7.1.1.8.8.1.1.1.1">NYTaxi</span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.8.8.2">120</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.8.8.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.8.8.3.1">0.147</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.8.8.4"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.8.8.4.1">0.285</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.8.8.5">0.366</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.8.8.6">0.480</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.8.8.7">0.162</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.8.8.8">0.286</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.9.9.1">240</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.9.9.2">0.119</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.9.9.3">0.263</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.9.9.4">0.376</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.9.9.5">0.515</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.9.9.6"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.9.9.6.1">0.105</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.9.9.7"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.9.9.7.1">0.248</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.10.10.1">720</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.10.10.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.10.10.2.1">0.112</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.10.10.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.10.10.3.1">0.244</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.10.10.4">0.359</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.10.10.5">0.496</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.10.10.6">0.119</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.10.10.7">0.248</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.11.11.1">1440</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.11.11.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.11.11.2.1">0.151</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.11.11.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.11.11.3.1">0.270</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.11.11.4">0.291</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.11.11.5">0.435</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.11.11.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.11.11.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.12.12.1">2160</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.12.12.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.12.12.2.1">0.182</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.12.12.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.12.12.3.1">0.312</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.12.12.4">0.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.12.12.5">0.505</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.12.12.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.12.12.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.13.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.13.13.1" rowspan="5"><span class="ltx_text" id="S5.T7.1.1.13.13.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T7.1.1.13.13.1.1.1" style="width:6.8pt;height:21.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:21.3pt;transform:translate(-7.21pt,-7.21pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T7.1.1.13.13.1.1.1.1">RPB</span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.13.13.2">180</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.13.13.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.13.13.3.1">2.977</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.13.13.4"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.13.13.4.1">1.312</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.13.13.5">3.402</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.13.13.6">1.431</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.13.13.7">3.196</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.13.13.8">1.387</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.14.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.14.14.1">360</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.14.14.2">2.985</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.14.14.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.14.14.3.1">1.304</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.14.14.4"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.14.14.4.1">2.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.14.14.5">1.344</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.14.14.6">3.024</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.14.14.7">1.325</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.15.15.1">720</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.15.15.2">3.168</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.15.15.3">1.378</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.15.15.4">3.383</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.15.15.5">1.419</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.15.15.6"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.15.15.6.1">3.153</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.15.15.7"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.15.15.7.1">1.372</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.16.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.16.16.1">1440</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.16.16.2">3.137</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.16.16.3">1.368</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.16.16.4"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.16.16.4.1">2.926</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.16.16.5"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.16.16.5.1">1.35</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.16.16.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.16.16.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.17.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.17.17.1">4320</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.17.17.2">3.093</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.17.17.3">1.342</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.17.17.4"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.17.17.4.1">2.822</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.17.17.5"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.17.17.5.1">1.314</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.17.17.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.17.17.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.18.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.18.18.1" rowspan="5"><span class="ltx_text" id="S5.T7.1.1.18.18.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T7.1.1.18.18.1.1.1" style="width:6.8pt;height:25pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:25.0pt;transform:translate(-9.08pt,-9.08pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T7.1.1.18.18.1.1.1.1">TiNA</span>
</span></span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.18.18.2">360</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.18.18.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.18.18.3.1">1.862</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.18.18.4"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.18.18.4.1">0.870</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.18.18.5">2.044</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.18.18.6">0.954</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.18.18.7">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.18.18.8">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.19.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.19.19.1">720</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.19.19.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.19.19.2.1">1.849</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.19.19.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.19.19.3.1">0.863</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.19.19.4">2.148</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.19.19.5">0.976</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.19.19.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.19.19.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.20.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.20.20.1">1440</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.20.20.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.20.20.2.1">1.863</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.20.20.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.20.20.3.1">0.867</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.20.20.4">2.033</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.20.20.5">0.940</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.20.20.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.20.20.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.21.21">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.21.21.1">2880</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.21.21.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.21.21.2.1">1.851</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.21.21.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.21.21.3.1">0.860</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.21.21.4">2.020</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.21.21.5">0.944</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.21.21.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.21.21.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.22.22">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.22.22.1">5760</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.22.22.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.22.22.2.1">1.838</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.22.22.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.22.22.3.1">0.853</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.22.22.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.22.22.5">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.22.22.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.22.22.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.23.23">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="2" id="S5.T7.1.1.23.23.1">Count</th>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="2" id="S5.T7.1.1.23.23.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.23.23.2.1">31</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="2" id="S5.T7.1.1.23.23.3">5</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="2" id="S5.T7.1.1.23.23.4">4</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.24.24">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" colspan="2" id="S5.T7.1.1.24.24.1">Mean Accumulated</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.1.1.24.24.2">1.514</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T7.1.1.24.24.3">0.794</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.1.1.24.24.4">1.722</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T7.1.1.24.24.5">0.915</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.1.1.24.24.6"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.24.24.6.1">1.427</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.1.1.24.24.7"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.24.24.7.1">0.778</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Multivariate forecasting over the Individual Household Electric Power dataset (IHEP), New York Taxi dataset (NYTaxi), Residential Power Battery dataset (RPB) and Time-series Industrial Anomaly dataset (TiNA). MSE and MAE are presented in the table, the lower the better, best results in bold. Empty cells are due to the impossibility of executing the algorithm for these parameters due to memory problems given the size of the model. <span class="ltx_text ltx_font_bold" id="S5.T7.3.1">Fixed architectures</span> for LAM and Vanilla have been employed, being 7 encoding-decoding layers for LAM and 5 for Vanilla. Count stands for best result counts. Mean Accumulated is computed as the added error divided by the number of valid rows in the table (non-empty). The Vanilla algorithm is the original transformer proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#bib.bib20" title="">20</a>]</cite>.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p5">
<p class="ltx_p" id="S5.SS2.p5.1">To obtain an overall assessment, we utilised the mean cumulative error in both MAE and MSE as summary metrics. This average was calculated by considering only the rows with valid values for each algorithm, excluding those without results. This approach may inadvertently favour the Vanilla transformer and Informer, as they do not execute in scenarios with higher error rates (i.e., long prediction horizons), and therefore, lack results in those contexts. Despite this potential bias, our model still achieves the lowest average cumulative error in both MSE and MAE. The Vanilla transformer follows, with Informer exhibiting the highest average cumulative error.</p>
</div>
<figure class="ltx_figure" id="S5.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="756" id="S5.F7.sf1.g1" src="x15.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>MSE Bayesian test</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="756" id="S5.F7.sf2.g1" src="x16.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MAE Bayesian test</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Bayesian tests for Vanilla vs LAM</figcaption>
</figure>
<figure class="ltx_figure" id="S5.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="741" id="S5.F8.sf1.g1" src="x17.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>MSE Bayesian test</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="741" id="S5.F8.sf2.g1" src="x18.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MAE Bayesian test</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Bayesian tests for Informer vs LAM</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p6">
<p class="ltx_p" id="S5.SS2.p6.1">To substantiate the argument that our algorithm outperforms both Informer and the Vanilla transformer, we conducted two Bayesian tests. The results, presented in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.F7" title="In 5.2 Results and Analysis ‣ 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">7</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.F8" title="In 5.2 Results and Analysis ‣ 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">8</span></a>, clearly indicate statistically significant differences between the algorithms, favouring our proposal. These findings affirm the validity of our model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p7">
<p class="ltx_p" id="S5.SS2.p7.1">In this experimentation, as mentioned at the beginning of this section, we varied the number of encoding-decoding layers to determine the optimal configuration. To study the effect of these architectural variations, the results are presented in bar charts, which can be viewed in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.F9" title="In 5.2 Results and Analysis ‣ 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">9</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.F10" title="In 5.2 Results and Analysis ‣ 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">10</span></a>, with a common legend in <a class="ltx_ref" href="https://arxiv.org/html/2410.03805v1#S5.F9.sf3" title="In Figure 9 ‣ 5.2 Results and Analysis ‣ 5 Towards a suitable collection of datasets for LSTF benchmarking ‣ Local Attention Mechanism: Boosting the Transformer Architecture for Long-Sequence Time Series Forecasting"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">9(c)</span></a>. It is important to note that, depending on the dataset size, some combinations of model layers may encounter memory issues and fail to execute, as observed in the TiNA dataset for sizes 1440, 2880, and 5760.</p>
</div>
<figure class="ltx_figure" id="S5.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F9.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S5.F9.sf1.g1" src="x19.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>IHE dataset</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F9.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S5.F9.sf2.g1" src="x20.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>NYTaxi dataset</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F9.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="76" id="S5.F9.sf3.g1" src="x21.png" width="178"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Legend for the barplots.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Barplots for the MSE of LAM to showcase the performance depending on the number of encoding-decoding layers used. The datasets shown are IHE and NYTaxi. MSE is presented in the barplot in the y-axis, sequence size (input and output) is presented in the x-axis. The colour of the bar is defined by the number of layers of the model.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p8">
<p class="ltx_p" id="S5.SS2.p8.3">The results exhibit some variation. Let us call by <math alttext="N" class="ltx_Math" display="inline" id="S5.SS2.p8.1.m1.1"><semantics id="S5.SS2.p8.1.m1.1a"><mi id="S5.SS2.p8.1.m1.1.1" xref="S5.SS2.p8.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p8.1.m1.1b"><ci id="S5.SS2.p8.1.m1.1.1.cmml" xref="S5.SS2.p8.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p8.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p8.1.m1.1d">italic_N</annotation></semantics></math>-encoder-decoder the LAM model with <math alttext="N" class="ltx_Math" display="inline" id="S5.SS2.p8.2.m2.1"><semantics id="S5.SS2.p8.2.m2.1a"><mi id="S5.SS2.p8.2.m2.1.1" xref="S5.SS2.p8.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p8.2.m2.1b"><ci id="S5.SS2.p8.2.m2.1.1.cmml" xref="S5.SS2.p8.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p8.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p8.2.m2.1d">italic_N</annotation></semantics></math> encoding layers and <math alttext="N" class="ltx_Math" display="inline" id="S5.SS2.p8.3.m3.1"><semantics id="S5.SS2.p8.3.m3.1a"><mi id="S5.SS2.p8.3.m3.1.1" xref="S5.SS2.p8.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p8.3.m3.1b"><ci id="S5.SS2.p8.3.m3.1.1.cmml" xref="S5.SS2.p8.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p8.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p8.3.m3.1d">italic_N</annotation></semantics></math> decoding layers. For the IHEP dataset, the 2-encoder-decoder model is not optimal in any scenario. Specifically, the 5-encoder-decoder model performs best for size 180, the 7-encoder-decoder model for size 360, the 5-encoder-decoder model for size 720, the 10-encoder-decoder model for size 1440, and the 3-encoder-decoder model for size 4320. This indicates that there is no consistent trend across all sequence sizes for this dataset. However, the 10-encoder-decoder configuration yields favourable results for the longer sequence sizes of 1440 and 4320, suggesting that a higher number of layers may be beneficial for longer prediction horizons.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p9">
<p class="ltx_p" id="S5.SS2.p9.1">For the NYTaxi dataset, the most effective configurations generally consist of 2 and 3 encoding and decoding layers, with the 10-encoder-decoder architecture performing best for the longest prediction horizon. These results are expected, as the dataset does not represent a particularly complex problem, allowing it to be effectively addressed with a smaller architectural configuration in most cases.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p10">
<p class="ltx_p" id="S5.SS2.p10.1">For the RPB dataset, the optimal architecture is the 7-encoder-decoder model for sizes 180 and 360, the 3-encoder-decoder model for sizes 720 and 1440, and a tie between the 2-encoder-decoder and 4-encoder-decoder for size 4320. This dataset does not appear to represent a particularly complex problem over extended prediction horizons, as evidenced by the lack of improvement in results with an increased number of attention layers.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p11">
<p class="ltx_p" id="S5.SS2.p11.1">Finally, we present the results obtained from the TiNA dataset, which is the most complex due to its large number of instances and variables. Consequently, it is the dataset that stands to benefit the most from architectures with more parameters. For this dataset, the 10-encoder-decoder architecture is unable to execute for sizes 1440 and above. For size 360, the optimal architecture is the 3-encoder-decoder configuration, while the 7-encoder-decoder model performs best for all other cases. The TiNA dataset clearly demonstrates the performance advantages of higher architectural depth, particularly for the sequence size of 5760.</p>
</div>
<figure class="ltx_figure" id="S5.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F10.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S5.F10.sf1.g1" src="x22.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>RPB dataset</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F10.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S5.F10.sf2.g1" src="x23.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>TiNA dataset</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F10.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="76" id="S5.F10.sf3.g1" src="x21.png" width="178"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Legend for the barplots.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Barplots for the MSE of LAM to showcase the performance depending on the number of encoding-decoding layers used. The datasets shown are RPB and TiNa. MSE is presented in the barplot in the y-axis, sequence size (input and output) is presented in the x-axis. The colour of the bar is defined by the number of layers of the model.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions and future work</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">This paper proposes a novel attention mechanism for transformers, specifically designed for time series prediction. This mechanism leverages the locality of the data and maintains a theoretical efficiency of <math alttext="\Theta(log(n))" class="ltx_Math" display="inline" id="S6.p1.1.m1.2"><semantics id="S6.p1.1.m1.2a"><mrow id="S6.p1.1.m1.2.2" xref="S6.p1.1.m1.2.2.cmml"><mi id="S6.p1.1.m1.2.2.3" mathvariant="normal" xref="S6.p1.1.m1.2.2.3.cmml">Θ</mi><mo id="S6.p1.1.m1.2.2.2" xref="S6.p1.1.m1.2.2.2.cmml">⁢</mo><mrow id="S6.p1.1.m1.2.2.1.1" xref="S6.p1.1.m1.2.2.1.1.1.cmml"><mo id="S6.p1.1.m1.2.2.1.1.2" stretchy="false" xref="S6.p1.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S6.p1.1.m1.2.2.1.1.1" xref="S6.p1.1.m1.2.2.1.1.1.cmml"><mi id="S6.p1.1.m1.2.2.1.1.1.2" xref="S6.p1.1.m1.2.2.1.1.1.2.cmml">l</mi><mo id="S6.p1.1.m1.2.2.1.1.1.1" xref="S6.p1.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="S6.p1.1.m1.2.2.1.1.1.3" xref="S6.p1.1.m1.2.2.1.1.1.3.cmml">o</mi><mo id="S6.p1.1.m1.2.2.1.1.1.1a" xref="S6.p1.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="S6.p1.1.m1.2.2.1.1.1.4" xref="S6.p1.1.m1.2.2.1.1.1.4.cmml">g</mi><mo id="S6.p1.1.m1.2.2.1.1.1.1b" xref="S6.p1.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S6.p1.1.m1.2.2.1.1.1.5.2" xref="S6.p1.1.m1.2.2.1.1.1.cmml"><mo id="S6.p1.1.m1.2.2.1.1.1.5.2.1" stretchy="false" xref="S6.p1.1.m1.2.2.1.1.1.cmml">(</mo><mi id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">n</mi><mo id="S6.p1.1.m1.2.2.1.1.1.5.2.2" stretchy="false" xref="S6.p1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.p1.1.m1.2.2.1.1.3" stretchy="false" xref="S6.p1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.2b"><apply id="S6.p1.1.m1.2.2.cmml" xref="S6.p1.1.m1.2.2"><times id="S6.p1.1.m1.2.2.2.cmml" xref="S6.p1.1.m1.2.2.2"></times><ci id="S6.p1.1.m1.2.2.3.cmml" xref="S6.p1.1.m1.2.2.3">Θ</ci><apply id="S6.p1.1.m1.2.2.1.1.1.cmml" xref="S6.p1.1.m1.2.2.1.1"><times id="S6.p1.1.m1.2.2.1.1.1.1.cmml" xref="S6.p1.1.m1.2.2.1.1.1.1"></times><ci id="S6.p1.1.m1.2.2.1.1.1.2.cmml" xref="S6.p1.1.m1.2.2.1.1.1.2">𝑙</ci><ci id="S6.p1.1.m1.2.2.1.1.1.3.cmml" xref="S6.p1.1.m1.2.2.1.1.1.3">𝑜</ci><ci id="S6.p1.1.m1.2.2.1.1.1.4.cmml" xref="S6.p1.1.m1.2.2.1.1.1.4">𝑔</ci><ci id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.2c">\Theta(log(n))</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.2d">roman_Θ ( italic_l italic_o italic_g ( italic_n ) )</annotation></semantics></math>. Our proposed mechanism has demonstrated superior performance compared to state-of-the-art attention-based mechanisms and models, including Informer, LogFormer, and Reformer, as well as LSTM models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">Additionally, we have highlighted the necessity for new and improved datasets for the evaluation of the Long Sequence Time-series Forecasting (LSTF) problem, in contrast to existing benchmarks. To address this need, we have introduced new datasets that facilitate a more accurate assessment of model quality in these scenarios.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">On larger and more challenging datasets, our proposed mechanism LAM has consistently outperformed not only Informer but also the baseline represented by the vanilla model across nearly all scenarios. Furthermore, due to the simplicity of the model accompanying our mechanism, our proposal is uniquely capable of executing effectively in all the studied scenarios. Additionally, we observed that the results exhibit low sensitivity to the depth of the architecture employed. By maintaining a fixed architecture size, we confirmed that the hypothesis remains valid.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p4">
<p class="ltx_p" id="S6.p4.1">Conducted experiments have also yielded a strong model performance and improved metrics when employing a larger number of attention layers for complex problems. This suggests that, for problems that are challenging to model or that involve long prediction horizons, the results benefit significantly from utilising a greater number of attention layers.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p5">
<p class="ltx_p" id="S6.p5.1">Finally, we have identified several areas for improvement and further research to enhance the performance of future models and advance the field. Firstly, as an existing challenge, it is essential to establish a comprehensive benchmark that includes datasets, methodologies, and metrics to evaluate new proposals consistently. Maintaining an up-to-date table of state-of-the-art model results is also crucial. Additionally, our study exclusively proposes an attention mechanism without a dedicated architecture; thus, future work should focus on developing and integrating such architectures. Lastly, considering the promising results obtained with a basic model employing a novel attention mechanism, it is imperative to conduct rigorous ablation studies. These studies will help discern which components positively impact the results and which do not, thereby guiding the development of more effective models.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>
<div class="ltx_para ltx_noindent" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This research results from the Strategic Project IAFER-Cib (C074/23), as a result of the collaboration agreement signed between the National Institute of Cybersecurity (INCIBE) and the University of Granada. This initiative is carried out within the framework of the Recovery, Transformation and Resilience Plan funds, financed by the European Union (Next Generation). Ignacio Aguilera-Martos was supported by the Ministry of Science of Spain under the FPI programme PRE2021-100169.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Jessica Lin, Eamonn Keogh, Stefano Lonardi, and Bill Chiu.

</span>
<span class="ltx_bibblock">A symbolic representation of time series, with implications for
streaming algorithms.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Proceedings of the 8th ACM SIGMOD workshop on Research issues
in data mining and knowledge discovery</span>, pages 2–11, 2003.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Omer Berat Sezer, Mehmet Ugur Gudelek, and Ahmet Murat Ozbayoglu.

</span>
<span class="ltx_bibblock">Financial time series forecasting with deep learning: A systematic
literature review: 2005–2019.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Applied Soft Computing</span>, 90:106181, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Tianyu Wang, Henry Leung, Jun Zhao, and Wei Wang.

</span>
<span class="ltx_bibblock">Multiseries featural lstm for partial periodic time-series
prediction: A case study for steel industry.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">IEEE Transactions on Instrumentation and Measurement</span>,
69(9):1–10, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Mousa Alizadeh, Mohammad TH Beheshti, Amin Ramezani, and Hadis Saadatinezhad.

</span>
<span class="ltx_bibblock">Network traffic forecasting based on fixed telecommunication data
using deep learning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">2020 6th Iranian Conference on Signal Processing and
Intelligent Systems (ICSPIS)</span>, pages 1–7. IEEE, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Carlos E Velasquez, Matheus Zocatelli, Fidellis BGL Estanislau, and Victor F
Castro.

</span>
<span class="ltx_bibblock">Analysis of time series models for brazilian electricity demand
forecasting.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Energy</span>, 247:1–16, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Ismail Shah, Hasnain Iftikhar, and Sajid Ali.

</span>
<span class="ltx_bibblock">Modeling and forecasting electricity demand and prices: A comparison
of alternative approaches.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Journal of Mathematics</span>, 2022(1):1–14, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Zahra Karevan and Johan AK Suykens.

</span>
<span class="ltx_bibblock">Transductive lstm for time-series prediction: An application to
weather forecasting.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">Neural Networks</span>, 125:1–9, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Pradeep Hewage, Ardhendu Behera, Marcello Trovati, Ella Pereira, Morteza
Ghahremani, Francesco Palmieri, and Yonghuai Liu.

</span>
<span class="ltx_bibblock">Temporal convolutional neural (tcn) network for an effective weather
forecasting using time-series data from the local weather station.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Soft Computing</span>, 24:16453–16482, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Zonglei Chen, Minbo Ma, Tianrui Li, Hongjun Wang, and Chongshou Li.

</span>
<span class="ltx_bibblock">Long sequence time-series forecasting with deep learning: A survey.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Information Fusion</span>, 97:1–36, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
George EP Box, Gwilym M Jenkins, Gregory C Reinsel, and Greta M Ljung.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Time series analysis: forecasting and control</span>.

</span>
<span class="ltx_bibblock">John Wiley &amp; Sons, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Chu-Cheng Lin, Aaron Jaech, Xin Li, Matthew R Gormley, and Jason Eisner.

</span>
<span class="ltx_bibblock">Limitations of autoregressive models and their alternatives.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2010.11939</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Irena Koprinska, Dengsong Wu, and Zheng Wang.

</span>
<span class="ltx_bibblock">Convolutional neural networks for energy time series forecasting.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">2018 International Joint Conference on Neural Networks
(IJCNN)</span>, pages 1–8, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Renzhuo Wan, Shuping Mei, Jun Wang, Min Liu, and Fan Yang.

</span>
<span class="ltx_bibblock">Multivariate temporal convolutional network: A deep neural networks
approach for multivariate time series forecasting.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">Electronics</span>, 8(8), 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Hansika Hewamalage, Christoph Bergmeir, and Kasun Bandara.

</span>
<span class="ltx_bibblock">Recurrent neural networks for time series forecasting: Current status
and future directions.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">International Journal of Forecasting</span>, 37(1):388–427, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Felipe P. Marinho, Paulo A. C. Rocha, Ajalmar R. R. Neto, and Francisco D. V.
Bezerra.

</span>
<span class="ltx_bibblock">Short-Term Solar Irradiance Forecasting Using CNN-1D, LSTM, and
CNN-LSTM Deep Neural Networks: A Case Study With the Folsom (USA) Dataset.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">Journal of Solar Energy Engineering</span>, 145(4):1–11, 11 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Hatice Vildan Dudukcu, Murat Taskiran, Zehra Gulru Cam Taskiran, and Tulay
Yildirim.

</span>
<span class="ltx_bibblock">Temporal convolutional networks with rnn approach for chaotic time
series prediction.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">Applied Soft Computing</span>, 133:1–14, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Ignacio Aguilera-Martos, Ángel M. García-Vico, Julián Luengo, Sergio Damas,
Francisco J. Melero, José Javier Valle-Alonso, and Francisco Herrera.

</span>
<span class="ltx_bibblock">Tsfedl: A python library for time series spatio-temporal feature
extraction and prediction using deep learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Neurocomputing</span>, 517:223–228, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Zachary C Lipton, John Berkowitz, and Charles Elkan.

</span>
<span class="ltx_bibblock">A critical review of recurrent neural networks for sequence learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:1506.00019</span>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Safwan Mahmood Al-Selwi, Mohd Fadzil Hassan, Said Jadid Abdulkadir, and Amgad
Muneer.

</span>
<span class="ltx_bibblock">Lstm inefficiency in long-term dependencies regression problems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">Journal of Advanced Research in Applied Sciences and Engineering
Technology</span>, 30(3):16–31, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">Advances in neural information processing systems</span>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Ailing Zeng, Muxi Chen, Lei Zhang, and Qiang Xu.

</span>
<span class="ltx_bibblock">Are transformers effective for time series forecasting?

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">Proceedings of the AAAI conference on artificial
intelligence</span>, number 9, pages 1–8, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Haoyi Zhou, Jianxin Li, Shanghang Zhang, Shuai Zhang, Mengyi Yan, and Hui
Xiong.

</span>
<span class="ltx_bibblock">Expanding the prediction capacity in long sequence time-series
forecasting.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">Artificial Intelligence</span>, 318:Paper No. 103886, 29, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Peter Bloomfield.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">Fourier analysis of time series: an introduction</span>.

</span>
<span class="ltx_bibblock">John Wiley &amp; Sons, 2004.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Guokun Lai, Wei-Cheng Chang, Yiming Yang, and Hanxiao Liu.

</span>
<span class="ltx_bibblock">Modeling long-and short-term temporal patterns with deep neural
networks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">The 41st international ACM SIGIR conference on research &amp;
development in information retrieval</span>, pages 95–104, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Rob J Hyndman and George Athanasopoulos.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">Forecasting: principles and practice</span>.

</span>
<span class="ltx_bibblock">OTexts, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Muhammad Sajjad, Zulfiqar Ahmad Khan, Amin Ullah, Tanveer Hussain, Waseem
Ullah, Mi Young Lee, and Sung Wook Baik.

</span>
<span class="ltx_bibblock">A novel CNN-GRU-based hybrid approach for short-term residential
load forecasting.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">IEEE Access</span>, 8:1–10, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Tae-Young Kim and Sung-Bae Cho.

</span>
<span class="ltx_bibblock">Predicting residential energy consumption using CNN-LSTM neural
networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">Energy</span>, 182:72–81, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Shiyang Li, Xiaoyong Jin, Yao Xuan, Xiyou Zhou, Wenhu Chen, Yu-Xiang Wang, and
Xifeng Yan.

</span>
<span class="ltx_bibblock">Enhancing the locality and breaking the memory bottleneck of
transformer on time series forecasting.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">Advances in neural information processing systems</span>, 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Bryan Lim, Sercan Ö Arık, Nicolas Loeff, and Tomas Pfister.

</span>
<span class="ltx_bibblock">Temporal fusion transformers for interpretable multi-horizon time
series forecasting.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">International Journal of Forecasting</span>, 37(4):1748–1764, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Tian Zhou, Ziqing Ma, Qingsong Wen, Xue Wang, Liang Sun, and Rong Jin.

</span>
<span class="ltx_bibblock">Fedformer: Frequency enhanced decomposed transformer for long-term
series forecasting.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">International Conference on Machine Learning</span>, pages 1–19.
PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Geoffrey S Watson.

</span>
<span class="ltx_bibblock">Smooth regression analysis.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">Sankhyā: The Indian Journal of Statistics, Series A</span>, pages
359–372, 1964.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Gordon J Johnston.

</span>
<span class="ltx_bibblock">Smooth nonparametric regression analysis.

</span>
<span class="ltx_bibblock">Technical report, North Carolina State University. Dept. of
Statistics, 1979.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Tan Nguyen, Minh Pham, Tam Nguyen, Khai Nguyen, Stanley Osher, and Nhat Ho.

</span>
<span class="ltx_bibblock">Fourierformer: Transformer meets generalized fourier integral
theorem.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Advances in Neural Information Processing Systems</span>, 35:1–15,
2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Leo Feng, Frederick Tung, Hossein Hajimirsadeghi, Mohamed Osama Ahmed, Yoshua
Bengio, and Greg Mori.

</span>
<span class="ltx_bibblock">Attention as an rnn.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2405.13956</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
James Vuckovic, Aristide Baratin, and Remi Tachet des Combes.

</span>
<span class="ltx_bibblock">A mathematical theory of attention.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2007.02876</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Andrea Galassi, Marco Lippi, and Paolo Torroni.

</span>
<span class="ltx_bibblock">Attention in natural language processing.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">IEEE Transactions on Neural Networks and Learning Systems</span>,
32(10):4291–4308, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Iz Beltagy, Matthew E Peters, and Arman Cohan.

</span>
<span class="ltx_bibblock">Longformer: The long-document transformer.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2004.05150</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Alessio Benavoli, Giorgio Corani, Francesca Mangili, Marco Zaffalon, and
Fabrizio Ruggeri.

</span>
<span class="ltx_bibblock">A bayesian wilcoxon signed-rank test based on the dirichlet process.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">International Conference on Machine Learning</span>, pages
1026–1034. PMLR, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Adebiyi A Ariyo, Adewumi O Adewumi, and Charles K Ayo.

</span>
<span class="ltx_bibblock">Stock price prediction using the arima model.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">2014 UKSim-AMSS 16th international conference on computer
modelling and simulation</span>, pages 106–112. IEEE, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Sean J Taylor and Benjamin Letham.

</span>
<span class="ltx_bibblock">Forecasting at scale.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">The American Statistician</span>, 72(1):37–45, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Neural machine translation by jointly learning to align and
translate.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:1409.0473</span>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
David Salinas, Valentin Flunkert, Jan Gasthaus, and Tim Januschowski.

</span>
<span class="ltx_bibblock">Deepar: Probabilistic forecasting with autoregressive recurrent
networks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">International Journal of Forecasting</span>, 36(3):1–11, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Nikita Kitaev, Łukasz Kaiser, and Anselm Levskaya.

</span>
<span class="ltx_bibblock">Reformer: The efficient transformer.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2001.04451</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Georges Hebrail and Alice Berard.

</span>
<span class="ltx_bibblock">Individual Household Electric Power Consumption.

</span>
<span class="ltx_bibblock">UCI Machine Learning Repository, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
New York Taxi and Limousine Commission.

</span>
<span class="ltx_bibblock">Tcl trip record data, July 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Christoph Bergmeir, Quang Bui, Frits de Nijs, and Peter Stuckey.

</span>
<span class="ltx_bibblock">Residential power and battery data, August 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Time-series industrial anomaly dataset, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Ignacio Aguilera-Martos, Marta García-Barzana, Diego García-Gil, Jacinto
Carrasco, David López, Julián Luengo, and Francisco Herrera.

</span>
<span class="ltx_bibblock">Multi-step histogram based outlier scores for unsupervised anomaly
detection: Arcelormittal engineering dataset case of study.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib48.1.1">Neurocomputing</span>, 544:1–32, 2023.

</span>
</li>
</ul>
</section><div about="" class="ltx_rdf" content="David S. Hippocampus, Elias D. Striatum" property="dcterms:creator"></div>
<div about="" class="ltx_rdf" content="First keyword, Second keyword, More" property="dcterms:subject"></div>
<div about="" class="ltx_rdf" content="q-bio.NC, q-bio.QM" property="dcterms:subject"></div>
<div about="" class="ltx_rdf" content="A template for the arxiv style" property="dcterms:title"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 11:29:28 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
