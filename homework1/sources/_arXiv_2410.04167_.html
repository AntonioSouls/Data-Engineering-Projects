<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Beyond Language: Applying MLX Transformers to Engineering Physics</title>
<!--Generated on Sat Oct  5 14:01:28 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.04167v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S1" title="In Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction and motivation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2" title="In Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>A High-Level Introduction to Transformers</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.SS1" title="In 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Understanding Transformers One Step Further: The Encoder and Decoder Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.SS2" title="In 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Inside the ‘Input Transformation’ Box: Self-Attention Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.SS3" title="In 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>The engineering perspective: Self-Attention Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.SS4" title="In 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Inside the ‘Output Transformation’ Box: Cross-Attention Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.SS5" title="In 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>The Engineering Perspective: Cross-Attention Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.SS6" title="In 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.6 </span>Multi-Headed Attention</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.SS7" title="In 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.7 </span>Positional embeddings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.SS8" title="In 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.8 </span>The final touches (inference)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.SS9" title="In 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.9 </span>Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.SS10" title="In 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.10 </span>The final touches (training)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3" title="In Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methods</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.SS1" title="In 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>The physical problem: basic configuration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.SS2" title="In 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>The physical problem: challenge configuration 1</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.SS3" title="In 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>The physical problem: challenge configuration 2</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.SS4" title="In 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Finite Differences Discretization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.SS5" title="In 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>The physics-informed loss</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.SS6" title="In 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Implementation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.SS7" title="In 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.7 </span>The Transformer Model Class</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.SS8" title="In 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.8 </span>Training, Validation and Testing Strategy</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4" title="In Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.SS1" title="In 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Results for the Base Case (block prediction mode)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.SS2" title="In 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Results for the Base Case (auto-regressive prediction mode)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.SS3" title="In 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Results for Challenge 1 (block prediction mode)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.SS4" title="In 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Results for Challenge 1 (auto-regressive prediction mode)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.SS5" title="In 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Results for Challenge 2 (block prediction mode)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.SS6" title="In 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Results for Challenge 2 (auto-regressive prediction mode)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S5" title="In Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Discussion, Limitations and Insights</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S6" title="In Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Broader Outlook</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#A1" title="In Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>The MLX Transformer Class</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document">Beyond Language: Applying MLX Transformers to Engineering Physics</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Stavros Kassinos
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:kassinos@ucy.ac.cy">kassinos@ucy.ac.cy</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Alessio Alexiadis
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:a.alexiadis@bham.ac.uk">a.alexiadis@bham.ac.uk</a>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Transformer Neural Networks are driving an explosion of activity and discovery in the field of Large Language Models (LLMs). In contrast, there have been only a few attempts to apply Transformers in engineering physics. Aiming to offer an easy entry point to physics-centric Transformers, we introduce a physics-informed Transformer model for solving the heat conduction problem in a 2D plate with Dirichlet boundary conditions. The model is implemented in the machine learning framework MLX and leverages the unified memory of Apple M-series processors. The use of MLX means that the models can be trained and perform predictions efficiently on personal machines with only modest memory requirements. To train, validate and test the Transformer model we solve the 2D heat conduction problem using central finite differences. Each finite difference solution in these sets is initialized with four random Dirichlet boundary conditions, a uniform but random internal temperature distribution and a randomly selected thermal diffusivity. Validation is performed in-line during training to monitor against over-fitting. The excellent performance of the trained model is demonstrated by predicting the evolution of the temperature field to steady state for the unseen test set of conditions.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Physics-informed Transformers , MLX Framework , Heat Conduction

</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">PACS: </h6>02.30.Jr , 02.60.Cb , 02.70.-c , 07.05.Mh , 44.10.+i

</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journal" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>Results in Engineering</span></span></span>
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\affiliation</span>
<p class="ltx_p" id="p1.2">[inst1]organization=Computational Sciences Laboratory, Department of Mechanical Engineering, University of Cyprus,addressline=1 University Avenue,
city=Aglantzia,
postcode=2109,
state=Nicosia,
country=Cyprus</p>
</div>
<div class="ltx_para" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">\affiliation</span>
<p class="ltx_p" id="p2.2">[inst2]organization=School of Chemical Engineering, University of Birmingham,addressline=Edgbaston,
city=Birmingham, B15 2TT,
postcode=22222,
state=State Two,
country=United Kingdom</p>
</div>
<div class="ltx_para" id="p3">
<span class="ltx_ERROR undefined" id="p3.1">{graphicalabstract}</span><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_landscape" height="150" id="p3.g1" src="extracted/5903850/FIGURES/GRAPHICAL_ABSTRACT/example_20_step_400.png" width="299"/>
</div>
<div class="ltx_para" id="p4">
<span class="ltx_ERROR undefined" id="p4.1">{highlights}</span>
</div>
<div class="ltx_para" id="p5">
<p class="ltx_p" id="p5.1">Parallels are drawn between key features of Transformers and established concepts in mathematical physics.</p>
</div>
<div class="ltx_para" id="p6">
<p class="ltx_p" id="p6.1">A standard Transformer architecture is trained using the MLX framework.</p>
</div>
<div class="ltx_para" id="p7">
<p class="ltx_p" id="p7.1">MLX is optimized for the unified memory architecture of Apple M-series processors and the code can run on personal machines.</p>
</div>
<div class="ltx_para" id="p8">
<p class="ltx_p" id="p8.1">The trained physics-informed Transformer achieves excellent inference performance.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction and motivation</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The landmark paper "Attention is all you need" introduced Transformers in 2017 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib1" title="">1</a>]</cite>. Since then, Transformers have expanded their reach into a wide range of different applications within the field of Artificial Intelligence (AI). To date, however, the potential of Transformer-based neural networks (NNs) in physics and engineering remains relatively unexplored. One reason for this is that the community is faced with the challenge of translating the available information on Transformers, which is mostly framed in the context of Natural Language Processing (NLP), to a completely different paradigm.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">A few recent studies have introduced Transformers in conjunction with physical problems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib7" title="">7</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib8" title="">8</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib10" title="">10</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib13" title="">13</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib9" title="">9</a>]</cite>. These works employ specialized, ad-hoc architectures that are tailored to applying physics-informed machine learning (ML) to specific challenges expressed as Partial Differential Equations (PDEs). They have demonstrated the potential of Transformers in solving complex physical problems by incorporating specialized architectures and mechanisms designed to handle specific PDEs.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In contrast, this work focuses on demonstrating the general applicability and efficiency of Transformers. It highlights the potential of using ‘pure’ Transformer models, not as part of an ad-hoc physics-informed architecture, in engineering physics. This is demonstrated in conjunction with the practical benefits of Transformers’ parallel processing capabilities, especially when combined with efficient frameworks like MLX <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib2" title="">2</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">MLX entered the AI and ML scene in the Fall of 2023 and has quickly gained attention for its lean and highly efficient coding platform. It leverages the unified memory hardware of Apple silicon (currently M1, M2, and M3 processors, with M4 processors coming soon). This integration means that tensors do not need to be explicitly moved between the CPU and GPU, keeping the code lean and avoiding unnecessary complexity. The synergy of unified memory with the ‘lazy execution’ paradigm used in MLX enables efficient computations on personal computers (see <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#A1" title="Appendix A The MLX Transformer Class ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">A</span></a>).</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">This paper, therefore, addresses the research question of whether standard Transformer architectures are capable of ‘learning’ differential operators by themselves, without the support of ad-hoc solutions. To provide a friendly introduction to these physics-centric Transformers, we train a Transformer model to predict the solutions of heat conduction in a 2D plate with Dirichlet boundary conditions (BCs). This particular setup strikes a good balance between being simple enough to avoid obscuring basic concepts and being sufficiently rich in long-term temporal and spatial relationships. It has been chosen to provide an opportunity to explore the most important features of Transformers. In fact, Transformers are specifically designed to discover and model long-term patterns in data due to their self-attention mechanism. In our case study, we will test their ability to capture the long-term evolution of temperature profiles resulting from different sets of BCs. This is in contrast with particle methods such as Molecular Dynamics, which are modeled by large systems of Ordinary Differential Equations (ODEs) rather than PDEs. In these systems, the positions and velocities of particles quickly become decorrelated from their initial values due to the inherently chaotic nature of the dynamics. Consequently, Transformers have not shown significant advantages in these contexts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib15" title="">15</a>]</cite>, and often other approaches might be preferred <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib14" title="">14</a>]</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>A High-Level Introduction to Transformers</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">The goal of this work is to provide an introduction to Transformers for engineering applications when the data are numerical, such as those coming from time series, spatial data, or, as in the case under study, solutions of differential equations. However, to begin with, let us start with a very high-level view of how Transformers work for their intended scope, NLP.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">Introductions to Transformer models typically fall into two categories: they are either highly simplified to support those with minimal machine learning knowledge, or they are highly detailed, targeting those with a strong background in computer science. In this article, we aim to strike a balance by targeting an intermediate audience—those who find the first approach too basic and the second too complex.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">We assume our readers are engineers or scientists with a solid understanding of mathematical concepts like linear algebra, approximation theory, signal processing, and integral transforms, such as Fourier analysis. Additionally, we expect that our readers have a basic familiarity with artificial neural networks, backpropagation, stochastic gradient descent, and related topics. This profile aligns with many scientists and engineers who have recently begun exploring the basics of machine learning but do not yet consider themselves experts.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">According to well-established educational theories  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib11" title="">11</a>]</cite> , new concepts are more effectively learned when connected to prior knowledge. Therefore, we will build on our readers’ existing knowledge to gradually introduce the Transformer architecture. To gain some intuition on the subject, we will show that many concepts, which may initially seem complex or unfamiliar, are conceptually similar to ideas the reader already understands. For instance, we will explore how the self-attention mechanism in Transformers parallels the Fourier transform, as both employ a similar mathematical framework to uncover patterns and relationships across data points—whether these are sequences of words or frequencies in a signal. Additionally, we will draw comparisons between positional embeddings and the time-localization capabilities of wavelet transforms, which introduce temporal information that the Fourier transform alone does not capture. Furthermore, we’ll extend this analogy by comparing cross-attention in Transformers to cross-correlation in signal processing. While cross-correlation measures the similarity between two signals as a function of the time-lag applied to one of them, cross-attention in Transformers similarly aligns and integrates information from two different sequences (the encoder’s and decoder’s outputs) to enhance the model’s understanding and prediction capability. Therefore, readers familiar with concepts like Fourier analysis, wavelet transforms, or cross-correlation can relate these to the ideas such as self-attention and cross-attention in Transformers. These connections help demystify what might initially seem like exotic concepts by anchoring them to existing knowledge.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1">We will begin our exploration by initially looking at the Transformer as a black box during inference.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="689" id="S2.F1.g1" src="extracted/5903850/FIGURES/Fig_high_level_transf_iteration.png" width="234"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.4.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S2.F1.5.2" style="font-size:90%;">Step-by-step process of text generation using a Transformer model. At each iteration, the model takes the initial input ("I am") and the previously generated output to predict the next token. The model adds a special token <span class="ltx_text ltx_font_typewriter" id="S2.F1.5.2.1">&lt;s&gt;</span> to the user’s input, indicating the start of the sequence. The process continues, adding tokens to the sequence, until the end-of-sequence token <span class="ltx_text ltx_font_typewriter" id="S2.F1.5.2.2">&lt;eos&gt;</span> is generated.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.p6">
<p class="ltx_p" id="S2.p6.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F1" title="Figure 1 ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">1</span></a> shows the iterative process of a Transformer model generating a sentence, starting with an initial input and progressively adding words to construct a complete sentence. For now, we will focus only on inference and not training. Let us see how it works through each iteration, assuming that the initial user’s input are the words "I am":</p>
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.1.1">Iteration 1:</span></p>
<ul class="ltx_itemize" id="S2.I1.i1.I1">
<li class="ltx_item" id="S2.I1.i1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span>
<div class="ltx_para" id="S2.I1.i1.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.I1.i1.p1.1.1">User Input:</span> "I am"
<br class="ltx_break"/>This is the initial fixed input provided to the Transformer .</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span>
<div class="ltx_para" id="S2.I1.i1.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i1.I1.i2.p1.4"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.I1.i2.p1.4.1">Transformer Input:</span> "<math alttext="&lt;" class="ltx_Math" display="inline" id="S2.I1.i1.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i1.I1.i2.p1.1.m1.1a"><mo id="S2.I1.i1.I1.i2.p1.1.m1.1.1" xref="S2.I1.i1.I1.i2.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i1.I1.i2.p1.1.m1.1b"><lt id="S2.I1.i1.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i1.I1.i2.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.I1.i2.p1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.I1.i2.p1.1.m1.1d">&lt;</annotation></semantics></math>s<math alttext="&gt;" class="ltx_Math" display="inline" id="S2.I1.i1.I1.i2.p1.2.m2.1"><semantics id="S2.I1.i1.I1.i2.p1.2.m2.1a"><mo id="S2.I1.i1.I1.i2.p1.2.m2.1.1" xref="S2.I1.i1.I1.i2.p1.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i1.I1.i2.p1.2.m2.1b"><gt id="S2.I1.i1.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i1.I1.i2.p1.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.I1.i2.p1.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.I1.i2.p1.2.m2.1d">&gt;</annotation></semantics></math>"
<br class="ltx_break"/>The Transformer starts by using the start-of-sequence token "<math alttext="&lt;" class="ltx_Math" display="inline" id="S2.I1.i1.I1.i2.p1.3.m3.1"><semantics id="S2.I1.i1.I1.i2.p1.3.m3.1a"><mo id="S2.I1.i1.I1.i2.p1.3.m3.1.1" xref="S2.I1.i1.I1.i2.p1.3.m3.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i1.I1.i2.p1.3.m3.1b"><lt id="S2.I1.i1.I1.i2.p1.3.m3.1.1.cmml" xref="S2.I1.i1.I1.i2.p1.3.m3.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.I1.i2.p1.3.m3.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.I1.i2.p1.3.m3.1d">&lt;</annotation></semantics></math>s<math alttext="&gt;" class="ltx_Math" display="inline" id="S2.I1.i1.I1.i2.p1.4.m4.1"><semantics id="S2.I1.i1.I1.i2.p1.4.m4.1a"><mo id="S2.I1.i1.I1.i2.p1.4.m4.1.1" xref="S2.I1.i1.I1.i2.p1.4.m4.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i1.I1.i2.p1.4.m4.1b"><gt id="S2.I1.i1.I1.i2.p1.4.m4.1.1.cmml" xref="S2.I1.i1.I1.i2.p1.4.m4.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.I1.i2.p1.4.m4.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.I1.i2.p1.4.m4.1d">&gt;</annotation></semantics></math>" as input.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(c)</span>
<div class="ltx_para" id="S2.I1.i1.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i1.I1.i3.p1.2"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.I1.i3.p1.2.1">Output:</span> "a"
<br class="ltx_break"/>The Transformer processes the user input "I am" along with the start-of-sequence token "<math alttext="&lt;" class="ltx_Math" display="inline" id="S2.I1.i1.I1.i3.p1.1.m1.1"><semantics id="S2.I1.i1.I1.i3.p1.1.m1.1a"><mo id="S2.I1.i1.I1.i3.p1.1.m1.1.1" xref="S2.I1.i1.I1.i3.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i1.I1.i3.p1.1.m1.1b"><lt id="S2.I1.i1.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i1.I1.i3.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.I1.i3.p1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.I1.i3.p1.1.m1.1d">&lt;</annotation></semantics></math>s<math alttext="&gt;" class="ltx_Math" display="inline" id="S2.I1.i1.I1.i3.p1.2.m2.1"><semantics id="S2.I1.i1.I1.i3.p1.2.m2.1a"><mo id="S2.I1.i1.I1.i3.p1.2.m2.1.1" xref="S2.I1.i1.I1.i3.p1.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i1.I1.i3.p1.2.m2.1b"><gt id="S2.I1.i1.I1.i3.p1.2.m2.1.1.cmml" xref="S2.I1.i1.I1.i3.p1.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.I1.i3.p1.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.I1.i3.p1.2.m2.1d">&gt;</annotation></semantics></math>" and predicts "a" as the most probable next word.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.1.1">Iteration 2:</span></p>
<ul class="ltx_itemize" id="S2.I1.i2.I1">
<li class="ltx_item" id="S2.I1.i2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span>
<div class="ltx_para" id="S2.I1.i2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.I1.i1.p1.1.1">User Input:</span> "I am"
<br class="ltx_break"/>The user input remains the same for the whole inference process.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span>
<div class="ltx_para" id="S2.I1.i2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.I1.i2.p1.2"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.I1.i2.p1.2.1">Transformer Input:</span> "<math alttext="&lt;" class="ltx_Math" display="inline" id="S2.I1.i2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.I1.i2.p1.1.m1.1a"><mo id="S2.I1.i2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.I1.i2.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i2.I1.i2.p1.1.m1.1b"><lt id="S2.I1.i2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.I1.i2.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.I1.i2.p1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.I1.i2.p1.1.m1.1d">&lt;</annotation></semantics></math>s<math alttext="&gt;" class="ltx_Math" display="inline" id="S2.I1.i2.I1.i2.p1.2.m2.1"><semantics id="S2.I1.i2.I1.i2.p1.2.m2.1a"><mo id="S2.I1.i2.I1.i2.p1.2.m2.1.1" xref="S2.I1.i2.I1.i2.p1.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i2.I1.i2.p1.2.m2.1b"><gt id="S2.I1.i2.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i2.I1.i2.p1.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.I1.i2.p1.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.I1.i2.p1.2.m2.1d">&gt;</annotation></semantics></math> a"
<br class="ltx_break"/>Together with the user input "I am", the Transformer now uses the start-of-sequence token followed by the previously generated word "a" as input.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(c)</span>
<div class="ltx_para" id="S2.I1.i2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i2.I1.i3.p1.2"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.I1.i3.p1.2.1">Output:</span> "teacher"
<br class="ltx_break"/>Using the input sequences "I am" and "<math alttext="&lt;" class="ltx_Math" display="inline" id="S2.I1.i2.I1.i3.p1.1.m1.1"><semantics id="S2.I1.i2.I1.i3.p1.1.m1.1a"><mo id="S2.I1.i2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i2.I1.i3.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i2.I1.i3.p1.1.m1.1b"><lt id="S2.I1.i2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i2.I1.i3.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.I1.i3.p1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.I1.i3.p1.1.m1.1d">&lt;</annotation></semantics></math>s<math alttext="&gt;" class="ltx_Math" display="inline" id="S2.I1.i2.I1.i3.p1.2.m2.1"><semantics id="S2.I1.i2.I1.i3.p1.2.m2.1a"><mo id="S2.I1.i2.I1.i3.p1.2.m2.1.1" xref="S2.I1.i2.I1.i3.p1.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i2.I1.i3.p1.2.m2.1b"><gt id="S2.I1.i2.I1.i3.p1.2.m2.1.1.cmml" xref="S2.I1.i2.I1.i3.p1.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.I1.i3.p1.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.I1.i3.p1.2.m2.1d">&gt;</annotation></semantics></math> a", the Transformer predicts the next word "teacher".</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i3.p1.1.1">Iteration 3:</span></p>
<ul class="ltx_itemize" id="S2.I1.i3.I1">
<li class="ltx_item" id="S2.I1.i3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span>
<div class="ltx_para" id="S2.I1.i3.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i3.I1.i1.p1.1.1">User Input:</span> "I am"</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span>
<div class="ltx_para" id="S2.I1.i3.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i3.I1.i2.p1.4"><span class="ltx_text ltx_font_bold" id="S2.I1.i3.I1.i2.p1.4.1">Transformer Input:</span> "<math alttext="&lt;" class="ltx_Math" display="inline" id="S2.I1.i3.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i3.I1.i2.p1.1.m1.1a"><mo id="S2.I1.i3.I1.i2.p1.1.m1.1.1" xref="S2.I1.i3.I1.i2.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i3.I1.i2.p1.1.m1.1b"><lt id="S2.I1.i3.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i3.I1.i2.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.I1.i2.p1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.I1.i2.p1.1.m1.1d">&lt;</annotation></semantics></math>s<math alttext="&gt;" class="ltx_Math" display="inline" id="S2.I1.i3.I1.i2.p1.2.m2.1"><semantics id="S2.I1.i3.I1.i2.p1.2.m2.1a"><mo id="S2.I1.i3.I1.i2.p1.2.m2.1.1" xref="S2.I1.i3.I1.i2.p1.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i3.I1.i2.p1.2.m2.1b"><gt id="S2.I1.i3.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i3.I1.i2.p1.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.I1.i2.p1.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.I1.i2.p1.2.m2.1d">&gt;</annotation></semantics></math> a teacher"
<br class="ltx_break"/>The Transformer uses the user input "I am" together with the sequence "<math alttext="&lt;" class="ltx_Math" display="inline" id="S2.I1.i3.I1.i2.p1.3.m3.1"><semantics id="S2.I1.i3.I1.i2.p1.3.m3.1a"><mo id="S2.I1.i3.I1.i2.p1.3.m3.1.1" xref="S2.I1.i3.I1.i2.p1.3.m3.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i3.I1.i2.p1.3.m3.1b"><lt id="S2.I1.i3.I1.i2.p1.3.m3.1.1.cmml" xref="S2.I1.i3.I1.i2.p1.3.m3.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.I1.i2.p1.3.m3.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.I1.i2.p1.3.m3.1d">&lt;</annotation></semantics></math>s<math alttext="&gt;" class="ltx_Math" display="inline" id="S2.I1.i3.I1.i2.p1.4.m4.1"><semantics id="S2.I1.i3.I1.i2.p1.4.m4.1a"><mo id="S2.I1.i3.I1.i2.p1.4.m4.1.1" xref="S2.I1.i3.I1.i2.p1.4.m4.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S2.I1.i3.I1.i2.p1.4.m4.1b"><gt id="S2.I1.i3.I1.i2.p1.4.m4.1.1.cmml" xref="S2.I1.i3.I1.i2.p1.4.m4.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.I1.i2.p1.4.m4.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.I1.i2.p1.4.m4.1d">&gt;</annotation></semantics></math> a teacher" as input.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(c)</span>
<div class="ltx_para" id="S2.I1.i3.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i3.I1.i3.p1.1.1">Output:</span> "and"
<br class="ltx_break"/>Based on these inputs, the Transformer predicts the next word "and".</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S2.p7">
<p class="ltx_p" id="S2.p7.2">And the process continues until the Transformer predicts the end-of-sequence token "<math alttext="&lt;" class="ltx_Math" display="inline" id="S2.p7.1.m1.1"><semantics id="S2.p7.1.m1.1a"><mo id="S2.p7.1.m1.1.1" xref="S2.p7.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S2.p7.1.m1.1b"><lt id="S2.p7.1.m1.1.1.cmml" xref="S2.p7.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S2.p7.1.m1.1d">&lt;</annotation></semantics></math>eos<math alttext="&gt;" class="ltx_Math" display="inline" id="S2.p7.2.m2.1"><semantics id="S2.p7.2.m2.1a"><mo id="S2.p7.2.m2.1.1" xref="S2.p7.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S2.p7.2.m2.1b"><gt id="S2.p7.2.m2.1.1.cmml" xref="S2.p7.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S2.p7.2.m2.1d">&gt;</annotation></semantics></math>", indicating that the sentence is complete. Thus, one word at a time, the Transformer completes the user input to form the sentence "I am a teacher and you a student".</p>
</div>
<div class="ltx_para" id="S2.p8">
<p class="ltx_p" id="S2.p8.1">This very high-level overview requires some clarifications. First, the model does not always produce the same word for a given input. Instead, it generates a set of probabilities for each potential next word in the sequence and then chooses one word from this set based on these probabilities. Second, the model does not process words directly but uses numerical representations. Each word is converted into a numerical vector, called an embedding, before being processed by the Transformer. Therefore, the Transformer architecture, although originally developed for NLP, can be applied to any sequence of numerical vectors. These vectors can represent not only words but also time series, spatial data, or solutions of differential equations. We leverage this flexibility of Transformers for the heat conduction problem presented in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3" title="3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Understanding Transformers One Step Further: The Encoder and Decoder Architecture</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In the previous section, we provided a very high-level introduction to Transformers, focusing on how they generate text in natural language processing (NLP) tasks. Now, we will take a step further by introducing the core components of the Transformer architecture: the encoder and decoder. For now, we will still consider these components as black boxes. The Transformer has two components, the Encoder and the Decoder Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F2" title="Figure 2 ‣ 2.1 Understanding Transformers One Step Further: The Encoder and Decoder Architecture ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="126" id="S2.F2.g1" src="extracted/5903850/FIGURES/Fig_high_level_encoder_decoder.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.3.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S2.F2.4.2" style="font-size:90%;">Encoder-Decoder architecture. This figure corresponds to Iteration 3 in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F1" title="Figure 1 ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">1</span></a>, where the encoder has processed the input ("I am") into an encoded representation. The decoder uses this encoded input and the previously generated output (<span class="ltx_text ltx_font_typewriter" id="S2.F2.4.2.1">&lt;s&gt;</span> a teacher) to predict the next word in the sequence ("and").</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">The encoder’s primary function is to process the user input sequence and transform it into a set of abstract, high-dimensional representations. These representations capture the essential information about the input data, allowing the model to understand its context and meaning. To provide a engineering perspective on how Transformers work, we can relate the underlying ideas to concepts in mathematics or physics that are familiar to engineers. In this case, we can think of the encoder as performing a transformation on the input sequence, converting it into a different representation of the same input.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">In engineering, we often use transformations to analyze data. For example, the Fourier transform takes a time-domain signal and converts it into a frequency-domain representation, revealing the different frequencies present in the original signal. Similarly, the encoder in a Transformer takes an input sequence and transforms it into a set of encoded vectors. These vectors encapsulate the important features and context of the input data like frequencies for the Fourier transform.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.1">The decoder performs the inverse operation of the encoder; it takes the encoded vectors and transforms them back into a sequence that matches the format of the original input (in the case of NLP, into word embeddings), progressively predicting one more term of the sequence at each step. Following the previous analogy, the decoder can be thought of as a sort of inverse Fourier transform, where the frequencies are converted back to a time-domain signal.</p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.1">One step further, we can divide the decoder into two main phases Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F3" title="Figure 3 ‣ 2.1 Understanding Transformers One Step Further: The Encoder and Decoder Architecture ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="S2.F3.g1" src="extracted/5903850/FIGURES/Fig_high_level_encoder_decoder_2.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F3.3.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S2.F3.4.2" style="font-size:90%;">Encoder-Decoder architecture. Building on Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F2" title="Figure 2 ‣ 2.1 Understanding Transformers One Step Further: The Encoder and Decoder Architecture ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">2</span></a>, this figure shows how the decoder transforms its input sequence (<span class="ltx_text ltx_font_typewriter" id="S2.F3.4.2.1">&lt;s&gt;</span> a teacher) into an internal representation before generating the next token ("and"). This process is similar to having an ‘encoder within the decoder,’ as the input transformation in the decoder works in a way that is comparable to how the encoder processes the original input.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS1.p6">
<p class="ltx_p" id="S2.SS1.p6.2">The first phase is the input transformation phase, which processes the decoder input (e.g., <math alttext="&lt;" class="ltx_Math" display="inline" id="S2.SS1.p6.1.m1.1"><semantics id="S2.SS1.p6.1.m1.1a"><mo id="S2.SS1.p6.1.m1.1.1" xref="S2.SS1.p6.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.1.m1.1b"><lt id="S2.SS1.p6.1.m1.1.1.cmml" xref="S2.SS1.p6.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.1.m1.1d">&lt;</annotation></semantics></math>s<math alttext="&gt;" class="ltx_Math" display="inline" id="S2.SS1.p6.2.m2.1"><semantics id="S2.SS1.p6.2.m2.1a"><mo id="S2.SS1.p6.2.m2.1.1" xref="S2.SS1.p6.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.2.m2.1b"><gt id="S2.SS1.p6.2.m2.1.1.cmml" xref="S2.SS1.p6.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.2.m2.1d">&gt;</annotation></semantics></math> a teacher in Figure  <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F3" title="Figure 3 ‣ 2.1 Understanding Transformers One Step Further: The Encoder and Decoder Architecture ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">3</span></a>). This phase converts the decoder input sequence in a way conceptually analogous to what the encoder does with the encoder input. We can think of it as an encoder within the decoder. Using the previous analogy, we can say that both user’s and Transformer’s inputs are transformed using a mathematical device conceptually similar to a Fourier transform. The transformations performed by the encoder and this part of the decoder are conceptually similar but not identical, as each one performs a different transformation that is determined during training.</p>
</div>
<div class="ltx_para" id="S2.SS1.p7">
<p class="ltx_p" id="S2.SS1.p7.1">After this transformation, the decoder combines the intermediate vectors derived from both the encoder and the first phase of the decoder. The second phase of the decoder is the output generation phase. In this phase, the decoder re-transforms the combined representations back into a sequence that matches the original input format, effectively predicting the next word or term in the sequence. Using our previous analogy, this is the phase that properly functions as a sort of inverse Fourier transform.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Inside the ‘Input Transformation’ Box: Self-Attention Mechanism</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">At the heart of the Transformer architecture is the self-attention mechanism, which is central to the ‘Input Transformation’ boxes in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F3" title="Figure 3 ‣ 2.1 Understanding Transformers One Step Further: The Encoder and Decoder Architecture ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">3</span></a>. This section focuses on the mathematical steps carried out by a self-attention layer during inference. For the moment, we will present these steps without providing any interpretation or context. While numerous introductory articles explain the reasoning behind these steps within the field of NLP (with many available on divulgative platforms like Towards Data Science, e.g., <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib3" title="">3</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib4" title="">4</a>]</cite>), our goal is to offer a practical introduction that extends beyond NLP. Initially, however, we will present only the bare mathematical steps.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SSx1">
<h3 class="ltx_title ltx_title_subsection">Input Sequence</h3>
<div class="ltx_para" id="S2.SSx1.p1">
<p class="ltx_p" id="S2.SSx1.p1.5">We start with a sequence of input vectors <math alttext="\bf{x}_{i}" class="ltx_Math" display="inline" id="S2.SSx1.p1.1.m1.1"><semantics id="S2.SSx1.p1.1.m1.1a"><msub id="S2.SSx1.p1.1.m1.1.1" xref="S2.SSx1.p1.1.m1.1.1.cmml"><mi id="S2.SSx1.p1.1.m1.1.1.2" xref="S2.SSx1.p1.1.m1.1.1.2.cmml">𝐱</mi><mi id="S2.SSx1.p1.1.m1.1.1.3" xref="S2.SSx1.p1.1.m1.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx1.p1.1.m1.1b"><apply id="S2.SSx1.p1.1.m1.1.1.cmml" xref="S2.SSx1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SSx1.p1.1.m1.1.1.1.cmml" xref="S2.SSx1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SSx1.p1.1.m1.1.1.2.cmml" xref="S2.SSx1.p1.1.m1.1.1.2">𝐱</ci><ci id="S2.SSx1.p1.1.m1.1.1.3.cmml" xref="S2.SSx1.p1.1.m1.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx1.p1.1.m1.1c">\bf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx1.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT</annotation></semantics></math> (for instance the embeddings of the user’s input), where each vector <math alttext="\bf{x}_{i}" class="ltx_Math" display="inline" id="S2.SSx1.p1.2.m2.1"><semantics id="S2.SSx1.p1.2.m2.1a"><msub id="S2.SSx1.p1.2.m2.1.1" xref="S2.SSx1.p1.2.m2.1.1.cmml"><mi id="S2.SSx1.p1.2.m2.1.1.2" xref="S2.SSx1.p1.2.m2.1.1.2.cmml">𝐱</mi><mi id="S2.SSx1.p1.2.m2.1.1.3" xref="S2.SSx1.p1.2.m2.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx1.p1.2.m2.1b"><apply id="S2.SSx1.p1.2.m2.1.1.cmml" xref="S2.SSx1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SSx1.p1.2.m2.1.1.1.cmml" xref="S2.SSx1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SSx1.p1.2.m2.1.1.2.cmml" xref="S2.SSx1.p1.2.m2.1.1.2">𝐱</ci><ci id="S2.SSx1.p1.2.m2.1.1.3.cmml" xref="S2.SSx1.p1.2.m2.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx1.p1.2.m2.1c">\bf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx1.p1.2.m2.1d">bold_x start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT</annotation></semantics></math> has a dimension of <math alttext="d" class="ltx_Math" display="inline" id="S2.SSx1.p1.3.m3.1"><semantics id="S2.SSx1.p1.3.m3.1a"><mi id="S2.SSx1.p1.3.m3.1.1" xref="S2.SSx1.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SSx1.p1.3.m3.1b"><ci id="S2.SSx1.p1.3.m3.1.1.cmml" xref="S2.SSx1.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx1.p1.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SSx1.p1.3.m3.1d">italic_d</annotation></semantics></math>. The sequence length is <math alttext="N" class="ltx_Math" display="inline" id="S2.SSx1.p1.4.m4.1"><semantics id="S2.SSx1.p1.4.m4.1a"><mi id="S2.SSx1.p1.4.m4.1.1" xref="S2.SSx1.p1.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SSx1.p1.4.m4.1b"><ci id="S2.SSx1.p1.4.m4.1.1.cmml" xref="S2.SSx1.p1.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx1.p1.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SSx1.p1.4.m4.1d">italic_N</annotation></semantics></math>, meaning there are <math alttext="N" class="ltx_Math" display="inline" id="S2.SSx1.p1.5.m5.1"><semantics id="S2.SSx1.p1.5.m5.1a"><mi id="S2.SSx1.p1.5.m5.1.1" xref="S2.SSx1.p1.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SSx1.p1.5.m5.1b"><ci id="S2.SSx1.p1.5.m5.1.1.cmml" xref="S2.SSx1.p1.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx1.p1.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SSx1.p1.5.m5.1d">italic_N</annotation></semantics></math> such vectors in the sequence.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SSx2">
<h3 class="ltx_title ltx_title_subsection">Linear Transformations</h3>
<div class="ltx_para" id="S2.SSx2.p1">
<p class="ltx_p" id="S2.SSx2.p1.11">Three linear transformations of the input sequence are carried by multiplying <math alttext="\bf{x}_{i}" class="ltx_Math" display="inline" id="S2.SSx2.p1.1.m1.1"><semantics id="S2.SSx2.p1.1.m1.1a"><msub id="S2.SSx2.p1.1.m1.1.1" xref="S2.SSx2.p1.1.m1.1.1.cmml"><mi id="S2.SSx2.p1.1.m1.1.1.2" xref="S2.SSx2.p1.1.m1.1.1.2.cmml">𝐱</mi><mi id="S2.SSx2.p1.1.m1.1.1.3" xref="S2.SSx2.p1.1.m1.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.1.m1.1b"><apply id="S2.SSx2.p1.1.m1.1.1.cmml" xref="S2.SSx2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SSx2.p1.1.m1.1.1.1.cmml" xref="S2.SSx2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SSx2.p1.1.m1.1.1.2.cmml" xref="S2.SSx2.p1.1.m1.1.1.2">𝐱</ci><ci id="S2.SSx2.p1.1.m1.1.1.3.cmml" xref="S2.SSx2.p1.1.m1.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.1.m1.1c">\bf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT</annotation></semantics></math> with the matrices <math alttext="\bm{W}_{K}" class="ltx_Math" display="inline" id="S2.SSx2.p1.2.m2.1"><semantics id="S2.SSx2.p1.2.m2.1a"><msub id="S2.SSx2.p1.2.m2.1.1" xref="S2.SSx2.p1.2.m2.1.1.cmml"><mi id="S2.SSx2.p1.2.m2.1.1.2" xref="S2.SSx2.p1.2.m2.1.1.2.cmml">𝑾</mi><mi id="S2.SSx2.p1.2.m2.1.1.3" xref="S2.SSx2.p1.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.2.m2.1b"><apply id="S2.SSx2.p1.2.m2.1.1.cmml" xref="S2.SSx2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SSx2.p1.2.m2.1.1.1.cmml" xref="S2.SSx2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SSx2.p1.2.m2.1.1.2.cmml" xref="S2.SSx2.p1.2.m2.1.1.2">𝑾</ci><ci id="S2.SSx2.p1.2.m2.1.1.3.cmml" xref="S2.SSx2.p1.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.2.m2.1c">\bm{W}_{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.2.m2.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\bm{W}_{Q}" class="ltx_Math" display="inline" id="S2.SSx2.p1.3.m3.1"><semantics id="S2.SSx2.p1.3.m3.1a"><msub id="S2.SSx2.p1.3.m3.1.1" xref="S2.SSx2.p1.3.m3.1.1.cmml"><mi id="S2.SSx2.p1.3.m3.1.1.2" xref="S2.SSx2.p1.3.m3.1.1.2.cmml">𝑾</mi><mi id="S2.SSx2.p1.3.m3.1.1.3" xref="S2.SSx2.p1.3.m3.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.3.m3.1b"><apply id="S2.SSx2.p1.3.m3.1.1.cmml" xref="S2.SSx2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SSx2.p1.3.m3.1.1.1.cmml" xref="S2.SSx2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SSx2.p1.3.m3.1.1.2.cmml" xref="S2.SSx2.p1.3.m3.1.1.2">𝑾</ci><ci id="S2.SSx2.p1.3.m3.1.1.3.cmml" xref="S2.SSx2.p1.3.m3.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.3.m3.1c">\bm{W}_{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.3.m3.1d">bold_italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\bm{W}_{V}" class="ltx_Math" display="inline" id="S2.SSx2.p1.4.m4.1"><semantics id="S2.SSx2.p1.4.m4.1a"><msub id="S2.SSx2.p1.4.m4.1.1" xref="S2.SSx2.p1.4.m4.1.1.cmml"><mi id="S2.SSx2.p1.4.m4.1.1.2" xref="S2.SSx2.p1.4.m4.1.1.2.cmml">𝑾</mi><mi id="S2.SSx2.p1.4.m4.1.1.3" xref="S2.SSx2.p1.4.m4.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.4.m4.1b"><apply id="S2.SSx2.p1.4.m4.1.1.cmml" xref="S2.SSx2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SSx2.p1.4.m4.1.1.1.cmml" xref="S2.SSx2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SSx2.p1.4.m4.1.1.2.cmml" xref="S2.SSx2.p1.4.m4.1.1.2">𝑾</ci><ci id="S2.SSx2.p1.4.m4.1.1.3.cmml" xref="S2.SSx2.p1.4.m4.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.4.m4.1c">\bm{W}_{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.4.m4.1d">bold_italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>, each of size <math alttext="d\times d^{\prime}" class="ltx_Math" display="inline" id="S2.SSx2.p1.5.m5.1"><semantics id="S2.SSx2.p1.5.m5.1a"><mrow id="S2.SSx2.p1.5.m5.1.1" xref="S2.SSx2.p1.5.m5.1.1.cmml"><mi id="S2.SSx2.p1.5.m5.1.1.2" xref="S2.SSx2.p1.5.m5.1.1.2.cmml">d</mi><mo id="S2.SSx2.p1.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SSx2.p1.5.m5.1.1.1.cmml">×</mo><msup id="S2.SSx2.p1.5.m5.1.1.3" xref="S2.SSx2.p1.5.m5.1.1.3.cmml"><mi id="S2.SSx2.p1.5.m5.1.1.3.2" xref="S2.SSx2.p1.5.m5.1.1.3.2.cmml">d</mi><mo id="S2.SSx2.p1.5.m5.1.1.3.3" xref="S2.SSx2.p1.5.m5.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.5.m5.1b"><apply id="S2.SSx2.p1.5.m5.1.1.cmml" xref="S2.SSx2.p1.5.m5.1.1"><times id="S2.SSx2.p1.5.m5.1.1.1.cmml" xref="S2.SSx2.p1.5.m5.1.1.1"></times><ci id="S2.SSx2.p1.5.m5.1.1.2.cmml" xref="S2.SSx2.p1.5.m5.1.1.2">𝑑</ci><apply id="S2.SSx2.p1.5.m5.1.1.3.cmml" xref="S2.SSx2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SSx2.p1.5.m5.1.1.3.1.cmml" xref="S2.SSx2.p1.5.m5.1.1.3">superscript</csymbol><ci id="S2.SSx2.p1.5.m5.1.1.3.2.cmml" xref="S2.SSx2.p1.5.m5.1.1.3.2">𝑑</ci><ci id="S2.SSx2.p1.5.m5.1.1.3.3.cmml" xref="S2.SSx2.p1.5.m5.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.5.m5.1c">d\times d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.5.m5.1d">italic_d × italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. The transformed vectors <math alttext="\bm{K}" class="ltx_Math" display="inline" id="S2.SSx2.p1.6.m6.1"><semantics id="S2.SSx2.p1.6.m6.1a"><mi id="S2.SSx2.p1.6.m6.1.1" xref="S2.SSx2.p1.6.m6.1.1.cmml">𝑲</mi><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.6.m6.1b"><ci id="S2.SSx2.p1.6.m6.1.1.cmml" xref="S2.SSx2.p1.6.m6.1.1">𝑲</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.6.m6.1c">\bm{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.6.m6.1d">bold_italic_K</annotation></semantics></math>, <math alttext="\bm{Q}" class="ltx_Math" display="inline" id="S2.SSx2.p1.7.m7.1"><semantics id="S2.SSx2.p1.7.m7.1a"><mi id="S2.SSx2.p1.7.m7.1.1" xref="S2.SSx2.p1.7.m7.1.1.cmml">𝑸</mi><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.7.m7.1b"><ci id="S2.SSx2.p1.7.m7.1.1.cmml" xref="S2.SSx2.p1.7.m7.1.1">𝑸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.7.m7.1c">\bm{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.7.m7.1d">bold_italic_Q</annotation></semantics></math>, and <math alttext="\bm{V}" class="ltx_Math" display="inline" id="S2.SSx2.p1.8.m8.1"><semantics id="S2.SSx2.p1.8.m8.1a"><mi id="S2.SSx2.p1.8.m8.1.1" xref="S2.SSx2.p1.8.m8.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.8.m8.1b"><ci id="S2.SSx2.p1.8.m8.1.1.cmml" xref="S2.SSx2.p1.8.m8.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.8.m8.1c">\bm{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.8.m8.1d">bold_italic_V</annotation></semantics></math> have dimension <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S2.SSx2.p1.9.m9.1"><semantics id="S2.SSx2.p1.9.m9.1a"><msup id="S2.SSx2.p1.9.m9.1.1" xref="S2.SSx2.p1.9.m9.1.1.cmml"><mi id="S2.SSx2.p1.9.m9.1.1.2" xref="S2.SSx2.p1.9.m9.1.1.2.cmml">d</mi><mo id="S2.SSx2.p1.9.m9.1.1.3" xref="S2.SSx2.p1.9.m9.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.9.m9.1b"><apply id="S2.SSx2.p1.9.m9.1.1.cmml" xref="S2.SSx2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SSx2.p1.9.m9.1.1.1.cmml" xref="S2.SSx2.p1.9.m9.1.1">superscript</csymbol><ci id="S2.SSx2.p1.9.m9.1.1.2.cmml" xref="S2.SSx2.p1.9.m9.1.1.2">𝑑</ci><ci id="S2.SSx2.p1.9.m9.1.1.3.cmml" xref="S2.SSx2.p1.9.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.9.m9.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.9.m9.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and are called keys, queries and values. These names originate from terminology commonly used in the field of NLP, and while their specific origins are not relevant to our discussion, we adopt them here for consistency with existing literature. From our point of view, we can view these linearly transformed vectors as re-representations of the original sequence. These linear transformations, which may include rotation, scaling, shear, or projection of the original input data, preserve the fundamental properties of the original data while altering its dimensionality from <math alttext="d" class="ltx_Math" display="inline" id="S2.SSx2.p1.10.m10.1"><semantics id="S2.SSx2.p1.10.m10.1a"><mi id="S2.SSx2.p1.10.m10.1.1" xref="S2.SSx2.p1.10.m10.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.10.m10.1b"><ci id="S2.SSx2.p1.10.m10.1.1.cmml" xref="S2.SSx2.p1.10.m10.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.10.m10.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.10.m10.1d">italic_d</annotation></semantics></math> to <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S2.SSx2.p1.11.m11.1"><semantics id="S2.SSx2.p1.11.m11.1a"><msup id="S2.SSx2.p1.11.m11.1.1" xref="S2.SSx2.p1.11.m11.1.1.cmml"><mi id="S2.SSx2.p1.11.m11.1.1.2" xref="S2.SSx2.p1.11.m11.1.1.2.cmml">d</mi><mo id="S2.SSx2.p1.11.m11.1.1.3" xref="S2.SSx2.p1.11.m11.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SSx2.p1.11.m11.1b"><apply id="S2.SSx2.p1.11.m11.1.1.cmml" xref="S2.SSx2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SSx2.p1.11.m11.1.1.1.cmml" xref="S2.SSx2.p1.11.m11.1.1">superscript</csymbol><ci id="S2.SSx2.p1.11.m11.1.1.2.cmml" xref="S2.SSx2.p1.11.m11.1.1.2">𝑑</ci><ci id="S2.SSx2.p1.11.m11.1.1.3.cmml" xref="S2.SSx2.p1.11.m11.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p1.11.m11.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p1.11.m11.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SSx2.p2">
<p class="ltx_p" id="S2.SSx2.p2.1">For each input vector <math alttext="\mathbf{x}_{\mathit{i}}" class="ltx_Math" display="inline" id="S2.SSx2.p2.1.m1.1"><semantics id="S2.SSx2.p2.1.m1.1a"><msub id="S2.SSx2.p2.1.m1.1.1" xref="S2.SSx2.p2.1.m1.1.1.cmml"><mi id="S2.SSx2.p2.1.m1.1.1.2" xref="S2.SSx2.p2.1.m1.1.1.2.cmml">𝐱</mi><mi id="S2.SSx2.p2.1.m1.1.1.3" xref="S2.SSx2.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx2.p2.1.m1.1b"><apply id="S2.SSx2.p2.1.m1.1.1.cmml" xref="S2.SSx2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SSx2.p2.1.m1.1.1.1.cmml" xref="S2.SSx2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SSx2.p2.1.m1.1.1.2.cmml" xref="S2.SSx2.p2.1.m1.1.1.2">𝐱</ci><ci id="S2.SSx2.p2.1.m1.1.1.3.cmml" xref="S2.SSx2.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p2.1.m1.1c">\mathbf{x}_{\mathit{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p2.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we calculate:</p>
<ul class="ltx_itemize" id="S2.I2">
<li class="ltx_item" id="S2.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I2.i1.p1">
<p class="ltx_p" id="S2.I2.i1.p1.1">The key vector <math alttext="\bm{K}_{i}=\bm{W}_{K}\mathbf{x}_{\mathit{i}}" class="ltx_Math" display="inline" id="S2.I2.i1.p1.1.m1.1"><semantics id="S2.I2.i1.p1.1.m1.1a"><mrow id="S2.I2.i1.p1.1.m1.1.1" xref="S2.I2.i1.p1.1.m1.1.1.cmml"><msub id="S2.I2.i1.p1.1.m1.1.1.2" xref="S2.I2.i1.p1.1.m1.1.1.2.cmml"><mi id="S2.I2.i1.p1.1.m1.1.1.2.2" xref="S2.I2.i1.p1.1.m1.1.1.2.2.cmml">𝑲</mi><mi id="S2.I2.i1.p1.1.m1.1.1.2.3" xref="S2.I2.i1.p1.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.I2.i1.p1.1.m1.1.1.1" xref="S2.I2.i1.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S2.I2.i1.p1.1.m1.1.1.3" xref="S2.I2.i1.p1.1.m1.1.1.3.cmml"><msub id="S2.I2.i1.p1.1.m1.1.1.3.2" xref="S2.I2.i1.p1.1.m1.1.1.3.2.cmml"><mi id="S2.I2.i1.p1.1.m1.1.1.3.2.2" xref="S2.I2.i1.p1.1.m1.1.1.3.2.2.cmml">𝑾</mi><mi id="S2.I2.i1.p1.1.m1.1.1.3.2.3" xref="S2.I2.i1.p1.1.m1.1.1.3.2.3.cmml">K</mi></msub><mo id="S2.I2.i1.p1.1.m1.1.1.3.1" xref="S2.I2.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.I2.i1.p1.1.m1.1.1.3.3" xref="S2.I2.i1.p1.1.m1.1.1.3.3.cmml"><mi id="S2.I2.i1.p1.1.m1.1.1.3.3.2" xref="S2.I2.i1.p1.1.m1.1.1.3.3.2.cmml">𝐱</mi><mi id="S2.I2.i1.p1.1.m1.1.1.3.3.3" xref="S2.I2.i1.p1.1.m1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I2.i1.p1.1.m1.1b"><apply id="S2.I2.i1.p1.1.m1.1.1.cmml" xref="S2.I2.i1.p1.1.m1.1.1"><eq id="S2.I2.i1.p1.1.m1.1.1.1.cmml" xref="S2.I2.i1.p1.1.m1.1.1.1"></eq><apply id="S2.I2.i1.p1.1.m1.1.1.2.cmml" xref="S2.I2.i1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.I2.i1.p1.1.m1.1.1.2.1.cmml" xref="S2.I2.i1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.I2.i1.p1.1.m1.1.1.2.2.cmml" xref="S2.I2.i1.p1.1.m1.1.1.2.2">𝑲</ci><ci id="S2.I2.i1.p1.1.m1.1.1.2.3.cmml" xref="S2.I2.i1.p1.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.I2.i1.p1.1.m1.1.1.3.cmml" xref="S2.I2.i1.p1.1.m1.1.1.3"><times id="S2.I2.i1.p1.1.m1.1.1.3.1.cmml" xref="S2.I2.i1.p1.1.m1.1.1.3.1"></times><apply id="S2.I2.i1.p1.1.m1.1.1.3.2.cmml" xref="S2.I2.i1.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.I2.i1.p1.1.m1.1.1.3.2.1.cmml" xref="S2.I2.i1.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S2.I2.i1.p1.1.m1.1.1.3.2.2.cmml" xref="S2.I2.i1.p1.1.m1.1.1.3.2.2">𝑾</ci><ci id="S2.I2.i1.p1.1.m1.1.1.3.2.3.cmml" xref="S2.I2.i1.p1.1.m1.1.1.3.2.3">𝐾</ci></apply><apply id="S2.I2.i1.p1.1.m1.1.1.3.3.cmml" xref="S2.I2.i1.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.I2.i1.p1.1.m1.1.1.3.3.1.cmml" xref="S2.I2.i1.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S2.I2.i1.p1.1.m1.1.1.3.3.2.cmml" xref="S2.I2.i1.p1.1.m1.1.1.3.3.2">𝐱</ci><ci id="S2.I2.i1.p1.1.m1.1.1.3.3.3.cmml" xref="S2.I2.i1.p1.1.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i1.p1.1.m1.1c">\bm{K}_{i}=\bm{W}_{K}\mathbf{x}_{\mathit{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i1.p1.1.m1.1d">bold_italic_K start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I2.i2.p1">
<p class="ltx_p" id="S2.I2.i2.p1.1">The query vector <math alttext="\bm{Q}_{i}=\bm{W}_{Q}\mathbf{x}_{\mathit{i}}" class="ltx_Math" display="inline" id="S2.I2.i2.p1.1.m1.1"><semantics id="S2.I2.i2.p1.1.m1.1a"><mrow id="S2.I2.i2.p1.1.m1.1.1" xref="S2.I2.i2.p1.1.m1.1.1.cmml"><msub id="S2.I2.i2.p1.1.m1.1.1.2" xref="S2.I2.i2.p1.1.m1.1.1.2.cmml"><mi id="S2.I2.i2.p1.1.m1.1.1.2.2" xref="S2.I2.i2.p1.1.m1.1.1.2.2.cmml">𝑸</mi><mi id="S2.I2.i2.p1.1.m1.1.1.2.3" xref="S2.I2.i2.p1.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.I2.i2.p1.1.m1.1.1.1" xref="S2.I2.i2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S2.I2.i2.p1.1.m1.1.1.3" xref="S2.I2.i2.p1.1.m1.1.1.3.cmml"><msub id="S2.I2.i2.p1.1.m1.1.1.3.2" xref="S2.I2.i2.p1.1.m1.1.1.3.2.cmml"><mi id="S2.I2.i2.p1.1.m1.1.1.3.2.2" xref="S2.I2.i2.p1.1.m1.1.1.3.2.2.cmml">𝑾</mi><mi id="S2.I2.i2.p1.1.m1.1.1.3.2.3" xref="S2.I2.i2.p1.1.m1.1.1.3.2.3.cmml">Q</mi></msub><mo id="S2.I2.i2.p1.1.m1.1.1.3.1" xref="S2.I2.i2.p1.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.I2.i2.p1.1.m1.1.1.3.3" xref="S2.I2.i2.p1.1.m1.1.1.3.3.cmml"><mi id="S2.I2.i2.p1.1.m1.1.1.3.3.2" xref="S2.I2.i2.p1.1.m1.1.1.3.3.2.cmml">𝐱</mi><mi id="S2.I2.i2.p1.1.m1.1.1.3.3.3" xref="S2.I2.i2.p1.1.m1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I2.i2.p1.1.m1.1b"><apply id="S2.I2.i2.p1.1.m1.1.1.cmml" xref="S2.I2.i2.p1.1.m1.1.1"><eq id="S2.I2.i2.p1.1.m1.1.1.1.cmml" xref="S2.I2.i2.p1.1.m1.1.1.1"></eq><apply id="S2.I2.i2.p1.1.m1.1.1.2.cmml" xref="S2.I2.i2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.I2.i2.p1.1.m1.1.1.2.1.cmml" xref="S2.I2.i2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.I2.i2.p1.1.m1.1.1.2.2.cmml" xref="S2.I2.i2.p1.1.m1.1.1.2.2">𝑸</ci><ci id="S2.I2.i2.p1.1.m1.1.1.2.3.cmml" xref="S2.I2.i2.p1.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.I2.i2.p1.1.m1.1.1.3.cmml" xref="S2.I2.i2.p1.1.m1.1.1.3"><times id="S2.I2.i2.p1.1.m1.1.1.3.1.cmml" xref="S2.I2.i2.p1.1.m1.1.1.3.1"></times><apply id="S2.I2.i2.p1.1.m1.1.1.3.2.cmml" xref="S2.I2.i2.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.I2.i2.p1.1.m1.1.1.3.2.1.cmml" xref="S2.I2.i2.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S2.I2.i2.p1.1.m1.1.1.3.2.2.cmml" xref="S2.I2.i2.p1.1.m1.1.1.3.2.2">𝑾</ci><ci id="S2.I2.i2.p1.1.m1.1.1.3.2.3.cmml" xref="S2.I2.i2.p1.1.m1.1.1.3.2.3">𝑄</ci></apply><apply id="S2.I2.i2.p1.1.m1.1.1.3.3.cmml" xref="S2.I2.i2.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.I2.i2.p1.1.m1.1.1.3.3.1.cmml" xref="S2.I2.i2.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S2.I2.i2.p1.1.m1.1.1.3.3.2.cmml" xref="S2.I2.i2.p1.1.m1.1.1.3.3.2">𝐱</ci><ci id="S2.I2.i2.p1.1.m1.1.1.3.3.3.cmml" xref="S2.I2.i2.p1.1.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i2.p1.1.m1.1c">\bm{Q}_{i}=\bm{W}_{Q}\mathbf{x}_{\mathit{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i2.p1.1.m1.1d">bold_italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S2.I2.i3.p1">
<p class="ltx_p" id="S2.I2.i3.p1.1">The value vector <math alttext="\bm{V}_{i}=\bm{W}_{V}\mathbf{x}_{\mathit{i}}" class="ltx_Math" display="inline" id="S2.I2.i3.p1.1.m1.1"><semantics id="S2.I2.i3.p1.1.m1.1a"><mrow id="S2.I2.i3.p1.1.m1.1.1" xref="S2.I2.i3.p1.1.m1.1.1.cmml"><msub id="S2.I2.i3.p1.1.m1.1.1.2" xref="S2.I2.i3.p1.1.m1.1.1.2.cmml"><mi id="S2.I2.i3.p1.1.m1.1.1.2.2" xref="S2.I2.i3.p1.1.m1.1.1.2.2.cmml">𝑽</mi><mi id="S2.I2.i3.p1.1.m1.1.1.2.3" xref="S2.I2.i3.p1.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.I2.i3.p1.1.m1.1.1.1" xref="S2.I2.i3.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S2.I2.i3.p1.1.m1.1.1.3" xref="S2.I2.i3.p1.1.m1.1.1.3.cmml"><msub id="S2.I2.i3.p1.1.m1.1.1.3.2" xref="S2.I2.i3.p1.1.m1.1.1.3.2.cmml"><mi id="S2.I2.i3.p1.1.m1.1.1.3.2.2" xref="S2.I2.i3.p1.1.m1.1.1.3.2.2.cmml">𝑾</mi><mi id="S2.I2.i3.p1.1.m1.1.1.3.2.3" xref="S2.I2.i3.p1.1.m1.1.1.3.2.3.cmml">V</mi></msub><mo id="S2.I2.i3.p1.1.m1.1.1.3.1" xref="S2.I2.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.I2.i3.p1.1.m1.1.1.3.3" xref="S2.I2.i3.p1.1.m1.1.1.3.3.cmml"><mi id="S2.I2.i3.p1.1.m1.1.1.3.3.2" xref="S2.I2.i3.p1.1.m1.1.1.3.3.2.cmml">𝐱</mi><mi id="S2.I2.i3.p1.1.m1.1.1.3.3.3" xref="S2.I2.i3.p1.1.m1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I2.i3.p1.1.m1.1b"><apply id="S2.I2.i3.p1.1.m1.1.1.cmml" xref="S2.I2.i3.p1.1.m1.1.1"><eq id="S2.I2.i3.p1.1.m1.1.1.1.cmml" xref="S2.I2.i3.p1.1.m1.1.1.1"></eq><apply id="S2.I2.i3.p1.1.m1.1.1.2.cmml" xref="S2.I2.i3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.I2.i3.p1.1.m1.1.1.2.1.cmml" xref="S2.I2.i3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.I2.i3.p1.1.m1.1.1.2.2.cmml" xref="S2.I2.i3.p1.1.m1.1.1.2.2">𝑽</ci><ci id="S2.I2.i3.p1.1.m1.1.1.2.3.cmml" xref="S2.I2.i3.p1.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.I2.i3.p1.1.m1.1.1.3.cmml" xref="S2.I2.i3.p1.1.m1.1.1.3"><times id="S2.I2.i3.p1.1.m1.1.1.3.1.cmml" xref="S2.I2.i3.p1.1.m1.1.1.3.1"></times><apply id="S2.I2.i3.p1.1.m1.1.1.3.2.cmml" xref="S2.I2.i3.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.I2.i3.p1.1.m1.1.1.3.2.1.cmml" xref="S2.I2.i3.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S2.I2.i3.p1.1.m1.1.1.3.2.2.cmml" xref="S2.I2.i3.p1.1.m1.1.1.3.2.2">𝑾</ci><ci id="S2.I2.i3.p1.1.m1.1.1.3.2.3.cmml" xref="S2.I2.i3.p1.1.m1.1.1.3.2.3">𝑉</ci></apply><apply id="S2.I2.i3.p1.1.m1.1.1.3.3.cmml" xref="S2.I2.i3.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.I2.i3.p1.1.m1.1.1.3.3.1.cmml" xref="S2.I2.i3.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S2.I2.i3.p1.1.m1.1.1.3.3.2.cmml" xref="S2.I2.i3.p1.1.m1.1.1.3.3.2">𝐱</ci><ci id="S2.I2.i3.p1.1.m1.1.1.3.3.3.cmml" xref="S2.I2.i3.p1.1.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i3.p1.1.m1.1c">\bm{V}_{i}=\bm{W}_{V}\mathbf{x}_{\mathit{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i3.p1.1.m1.1d">bold_italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></p>
</div>
</li>
</ul>
<p class="ltx_p" id="S2.SSx2.p2.4">The numerical values of <math alttext="\bm{W}_{K}" class="ltx_Math" display="inline" id="S2.SSx2.p2.2.m1.1"><semantics id="S2.SSx2.p2.2.m1.1a"><msub id="S2.SSx2.p2.2.m1.1.1" xref="S2.SSx2.p2.2.m1.1.1.cmml"><mi id="S2.SSx2.p2.2.m1.1.1.2" xref="S2.SSx2.p2.2.m1.1.1.2.cmml">𝑾</mi><mi id="S2.SSx2.p2.2.m1.1.1.3" xref="S2.SSx2.p2.2.m1.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx2.p2.2.m1.1b"><apply id="S2.SSx2.p2.2.m1.1.1.cmml" xref="S2.SSx2.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SSx2.p2.2.m1.1.1.1.cmml" xref="S2.SSx2.p2.2.m1.1.1">subscript</csymbol><ci id="S2.SSx2.p2.2.m1.1.1.2.cmml" xref="S2.SSx2.p2.2.m1.1.1.2">𝑾</ci><ci id="S2.SSx2.p2.2.m1.1.1.3.cmml" xref="S2.SSx2.p2.2.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p2.2.m1.1c">\bm{W}_{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p2.2.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\bm{W}_{Q}" class="ltx_Math" display="inline" id="S2.SSx2.p2.3.m2.1"><semantics id="S2.SSx2.p2.3.m2.1a"><msub id="S2.SSx2.p2.3.m2.1.1" xref="S2.SSx2.p2.3.m2.1.1.cmml"><mi id="S2.SSx2.p2.3.m2.1.1.2" xref="S2.SSx2.p2.3.m2.1.1.2.cmml">𝑾</mi><mi id="S2.SSx2.p2.3.m2.1.1.3" xref="S2.SSx2.p2.3.m2.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx2.p2.3.m2.1b"><apply id="S2.SSx2.p2.3.m2.1.1.cmml" xref="S2.SSx2.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SSx2.p2.3.m2.1.1.1.cmml" xref="S2.SSx2.p2.3.m2.1.1">subscript</csymbol><ci id="S2.SSx2.p2.3.m2.1.1.2.cmml" xref="S2.SSx2.p2.3.m2.1.1.2">𝑾</ci><ci id="S2.SSx2.p2.3.m2.1.1.3.cmml" xref="S2.SSx2.p2.3.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p2.3.m2.1c">\bm{W}_{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p2.3.m2.1d">bold_italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\bm{W}_{V}" class="ltx_Math" display="inline" id="S2.SSx2.p2.4.m3.1"><semantics id="S2.SSx2.p2.4.m3.1a"><msub id="S2.SSx2.p2.4.m3.1.1" xref="S2.SSx2.p2.4.m3.1.1.cmml"><mi id="S2.SSx2.p2.4.m3.1.1.2" xref="S2.SSx2.p2.4.m3.1.1.2.cmml">𝑾</mi><mi id="S2.SSx2.p2.4.m3.1.1.3" xref="S2.SSx2.p2.4.m3.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx2.p2.4.m3.1b"><apply id="S2.SSx2.p2.4.m3.1.1.cmml" xref="S2.SSx2.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S2.SSx2.p2.4.m3.1.1.1.cmml" xref="S2.SSx2.p2.4.m3.1.1">subscript</csymbol><ci id="S2.SSx2.p2.4.m3.1.1.2.cmml" xref="S2.SSx2.p2.4.m3.1.1.2">𝑾</ci><ci id="S2.SSx2.p2.4.m3.1.1.3.cmml" xref="S2.SSx2.p2.4.m3.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx2.p2.4.m3.1c">\bm{W}_{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx2.p2.4.m3.1d">bold_italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> are determined during training.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SSx3">
<h3 class="ltx_title ltx_title_subsection">Compute Attention Scores</h3>
<div class="ltx_para" id="S2.SSx3.p1">
<p class="ltx_p" id="S2.SSx3.p1.7">For each pair of input vectors <math alttext="(\bf{x}_{i},\bf{x}_{j})" class="ltx_Math" display="inline" id="S2.SSx3.p1.1.m1.2"><semantics id="S2.SSx3.p1.1.m1.2a"><mrow id="S2.SSx3.p1.1.m1.2.2.2" xref="S2.SSx3.p1.1.m1.2.2.3.cmml"><mo id="S2.SSx3.p1.1.m1.2.2.2.3" stretchy="false" xref="S2.SSx3.p1.1.m1.2.2.3.cmml">(</mo><msub id="S2.SSx3.p1.1.m1.1.1.1.1" xref="S2.SSx3.p1.1.m1.1.1.1.1.cmml"><mi id="S2.SSx3.p1.1.m1.1.1.1.1.2" xref="S2.SSx3.p1.1.m1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SSx3.p1.1.m1.1.1.1.1.3" xref="S2.SSx3.p1.1.m1.1.1.1.1.3.cmml">𝐢</mi></msub><mo id="S2.SSx3.p1.1.m1.2.2.2.4" xref="S2.SSx3.p1.1.m1.2.2.3.cmml">,</mo><msub id="S2.SSx3.p1.1.m1.2.2.2.2" xref="S2.SSx3.p1.1.m1.2.2.2.2.cmml"><mi id="S2.SSx3.p1.1.m1.2.2.2.2.2" xref="S2.SSx3.p1.1.m1.2.2.2.2.2.cmml">𝐱</mi><mi id="S2.SSx3.p1.1.m1.2.2.2.2.3" xref="S2.SSx3.p1.1.m1.2.2.2.2.3.cmml">𝐣</mi></msub><mo id="S2.SSx3.p1.1.m1.2.2.2.5" stretchy="false" xref="S2.SSx3.p1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SSx3.p1.1.m1.2b"><interval closure="open" id="S2.SSx3.p1.1.m1.2.2.3.cmml" xref="S2.SSx3.p1.1.m1.2.2.2"><apply id="S2.SSx3.p1.1.m1.1.1.1.1.cmml" xref="S2.SSx3.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SSx3.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SSx3.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SSx3.p1.1.m1.1.1.1.1.2.cmml" xref="S2.SSx3.p1.1.m1.1.1.1.1.2">𝐱</ci><ci id="S2.SSx3.p1.1.m1.1.1.1.1.3.cmml" xref="S2.SSx3.p1.1.m1.1.1.1.1.3">𝐢</ci></apply><apply id="S2.SSx3.p1.1.m1.2.2.2.2.cmml" xref="S2.SSx3.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SSx3.p1.1.m1.2.2.2.2.1.cmml" xref="S2.SSx3.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="S2.SSx3.p1.1.m1.2.2.2.2.2.cmml" xref="S2.SSx3.p1.1.m1.2.2.2.2.2">𝐱</ci><ci id="S2.SSx3.p1.1.m1.2.2.2.2.3.cmml" xref="S2.SSx3.p1.1.m1.2.2.2.2.3">𝐣</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx3.p1.1.m1.2c">(\bf{x}_{i},\bf{x}_{j})</annotation><annotation encoding="application/x-llamapun" id="S2.SSx3.p1.1.m1.2d">( bold_x start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT bold_j end_POSTSUBSCRIPT )</annotation></semantics></math> in the sequence, we define the attention score <math alttext="s_{ij}" class="ltx_Math" display="inline" id="S2.SSx3.p1.2.m2.1"><semantics id="S2.SSx3.p1.2.m2.1a"><msub id="S2.SSx3.p1.2.m2.1.1" xref="S2.SSx3.p1.2.m2.1.1.cmml"><mi id="S2.SSx3.p1.2.m2.1.1.2" xref="S2.SSx3.p1.2.m2.1.1.2.cmml">s</mi><mrow id="S2.SSx3.p1.2.m2.1.1.3" xref="S2.SSx3.p1.2.m2.1.1.3.cmml"><mi id="S2.SSx3.p1.2.m2.1.1.3.2" xref="S2.SSx3.p1.2.m2.1.1.3.2.cmml">i</mi><mo id="S2.SSx3.p1.2.m2.1.1.3.1" xref="S2.SSx3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SSx3.p1.2.m2.1.1.3.3" xref="S2.SSx3.p1.2.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SSx3.p1.2.m2.1b"><apply id="S2.SSx3.p1.2.m2.1.1.cmml" xref="S2.SSx3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SSx3.p1.2.m2.1.1.1.cmml" xref="S2.SSx3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SSx3.p1.2.m2.1.1.2.cmml" xref="S2.SSx3.p1.2.m2.1.1.2">𝑠</ci><apply id="S2.SSx3.p1.2.m2.1.1.3.cmml" xref="S2.SSx3.p1.2.m2.1.1.3"><times id="S2.SSx3.p1.2.m2.1.1.3.1.cmml" xref="S2.SSx3.p1.2.m2.1.1.3.1"></times><ci id="S2.SSx3.p1.2.m2.1.1.3.2.cmml" xref="S2.SSx3.p1.2.m2.1.1.3.2">𝑖</ci><ci id="S2.SSx3.p1.2.m2.1.1.3.3.cmml" xref="S2.SSx3.p1.2.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx3.p1.2.m2.1c">s_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx3.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> as the dot product of the query vector <math alttext="\bm{Q}_{i}" class="ltx_Math" display="inline" id="S2.SSx3.p1.3.m3.1"><semantics id="S2.SSx3.p1.3.m3.1a"><msub id="S2.SSx3.p1.3.m3.1.1" xref="S2.SSx3.p1.3.m3.1.1.cmml"><mi id="S2.SSx3.p1.3.m3.1.1.2" xref="S2.SSx3.p1.3.m3.1.1.2.cmml">𝑸</mi><mi id="S2.SSx3.p1.3.m3.1.1.3" xref="S2.SSx3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx3.p1.3.m3.1b"><apply id="S2.SSx3.p1.3.m3.1.1.cmml" xref="S2.SSx3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SSx3.p1.3.m3.1.1.1.cmml" xref="S2.SSx3.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SSx3.p1.3.m3.1.1.2.cmml" xref="S2.SSx3.p1.3.m3.1.1.2">𝑸</ci><ci id="S2.SSx3.p1.3.m3.1.1.3.cmml" xref="S2.SSx3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx3.p1.3.m3.1c">\bm{Q}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx3.p1.3.m3.1d">bold_italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="\bf{x}_{i}" class="ltx_Math" display="inline" id="S2.SSx3.p1.4.m4.1"><semantics id="S2.SSx3.p1.4.m4.1a"><msub id="S2.SSx3.p1.4.m4.1.1" xref="S2.SSx3.p1.4.m4.1.1.cmml"><mi id="S2.SSx3.p1.4.m4.1.1.2" xref="S2.SSx3.p1.4.m4.1.1.2.cmml">𝐱</mi><mi id="S2.SSx3.p1.4.m4.1.1.3" xref="S2.SSx3.p1.4.m4.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx3.p1.4.m4.1b"><apply id="S2.SSx3.p1.4.m4.1.1.cmml" xref="S2.SSx3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SSx3.p1.4.m4.1.1.1.cmml" xref="S2.SSx3.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SSx3.p1.4.m4.1.1.2.cmml" xref="S2.SSx3.p1.4.m4.1.1.2">𝐱</ci><ci id="S2.SSx3.p1.4.m4.1.1.3.cmml" xref="S2.SSx3.p1.4.m4.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx3.p1.4.m4.1c">\bf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx3.p1.4.m4.1d">bold_x start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT</annotation></semantics></math>, and the key vector <math alttext="\bm{K}_{j}" class="ltx_Math" display="inline" id="S2.SSx3.p1.5.m5.1"><semantics id="S2.SSx3.p1.5.m5.1a"><msub id="S2.SSx3.p1.5.m5.1.1" xref="S2.SSx3.p1.5.m5.1.1.cmml"><mi id="S2.SSx3.p1.5.m5.1.1.2" xref="S2.SSx3.p1.5.m5.1.1.2.cmml">𝑲</mi><mi id="S2.SSx3.p1.5.m5.1.1.3" xref="S2.SSx3.p1.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx3.p1.5.m5.1b"><apply id="S2.SSx3.p1.5.m5.1.1.cmml" xref="S2.SSx3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SSx3.p1.5.m5.1.1.1.cmml" xref="S2.SSx3.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SSx3.p1.5.m5.1.1.2.cmml" xref="S2.SSx3.p1.5.m5.1.1.2">𝑲</ci><ci id="S2.SSx3.p1.5.m5.1.1.3.cmml" xref="S2.SSx3.p1.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx3.p1.5.m5.1c">\bm{K}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx3.p1.5.m5.1d">bold_italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="\bf{x}_{j}" class="ltx_Math" display="inline" id="S2.SSx3.p1.6.m6.1"><semantics id="S2.SSx3.p1.6.m6.1a"><msub id="S2.SSx3.p1.6.m6.1.1" xref="S2.SSx3.p1.6.m6.1.1.cmml"><mi id="S2.SSx3.p1.6.m6.1.1.2" xref="S2.SSx3.p1.6.m6.1.1.2.cmml">𝐱</mi><mi id="S2.SSx3.p1.6.m6.1.1.3" xref="S2.SSx3.p1.6.m6.1.1.3.cmml">𝐣</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx3.p1.6.m6.1b"><apply id="S2.SSx3.p1.6.m6.1.1.cmml" xref="S2.SSx3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SSx3.p1.6.m6.1.1.1.cmml" xref="S2.SSx3.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SSx3.p1.6.m6.1.1.2.cmml" xref="S2.SSx3.p1.6.m6.1.1.2">𝐱</ci><ci id="S2.SSx3.p1.6.m6.1.1.3.cmml" xref="S2.SSx3.p1.6.m6.1.1.3">𝐣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx3.p1.6.m6.1c">\bf{x}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx3.p1.6.m6.1d">bold_x start_POSTSUBSCRIPT bold_j end_POSTSUBSCRIPT</annotation></semantics></math>, rescaled by the square root of <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S2.SSx3.p1.7.m7.1"><semantics id="S2.SSx3.p1.7.m7.1a"><msup id="S2.SSx3.p1.7.m7.1.1" xref="S2.SSx3.p1.7.m7.1.1.cmml"><mi id="S2.SSx3.p1.7.m7.1.1.2" xref="S2.SSx3.p1.7.m7.1.1.2.cmml">d</mi><mo id="S2.SSx3.p1.7.m7.1.1.3" xref="S2.SSx3.p1.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SSx3.p1.7.m7.1b"><apply id="S2.SSx3.p1.7.m7.1.1.cmml" xref="S2.SSx3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SSx3.p1.7.m7.1.1.1.cmml" xref="S2.SSx3.p1.7.m7.1.1">superscript</csymbol><ci id="S2.SSx3.p1.7.m7.1.1.2.cmml" xref="S2.SSx3.p1.7.m7.1.1.2">𝑑</ci><ci id="S2.SSx3.p1.7.m7.1.1.3.cmml" xref="S2.SSx3.p1.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx3.p1.7.m7.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx3.p1.7.m7.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="s_{ij}=\frac{\bm{Q}_{i}\bm{K}_{j}}{\sqrt{d^{\prime}}}" class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><msub id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.2.2" xref="S2.E1.m1.1.1.2.2.cmml">s</mi><mrow id="S2.E1.m1.1.1.2.3" xref="S2.E1.m1.1.1.2.3.cmml"><mi id="S2.E1.m1.1.1.2.3.2" xref="S2.E1.m1.1.1.2.3.2.cmml">i</mi><mo id="S2.E1.m1.1.1.2.3.1" xref="S2.E1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.2.3.3" xref="S2.E1.m1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml">=</mo><mfrac id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml"><mrow id="S2.E1.m1.1.1.3.2" xref="S2.E1.m1.1.1.3.2.cmml"><msub id="S2.E1.m1.1.1.3.2.2" xref="S2.E1.m1.1.1.3.2.2.cmml"><mi id="S2.E1.m1.1.1.3.2.2.2" xref="S2.E1.m1.1.1.3.2.2.2.cmml">𝑸</mi><mi id="S2.E1.m1.1.1.3.2.2.3" xref="S2.E1.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo id="S2.E1.m1.1.1.3.2.1" xref="S2.E1.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.3.2.3" xref="S2.E1.m1.1.1.3.2.3.cmml"><mi id="S2.E1.m1.1.1.3.2.3.2" xref="S2.E1.m1.1.1.3.2.3.2.cmml">𝑲</mi><mi id="S2.E1.m1.1.1.3.2.3.3" xref="S2.E1.m1.1.1.3.2.3.3.cmml">j</mi></msub></mrow><msqrt id="S2.E1.m1.1.1.3.3" xref="S2.E1.m1.1.1.3.3.cmml"><msup id="S2.E1.m1.1.1.3.3.2" xref="S2.E1.m1.1.1.3.3.2.cmml"><mi id="S2.E1.m1.1.1.3.3.2.2" xref="S2.E1.m1.1.1.3.3.2.2.cmml">d</mi><mo id="S2.E1.m1.1.1.3.3.2.3" xref="S2.E1.m1.1.1.3.3.2.3.cmml">′</mo></msup></msqrt></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><eq id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"></eq><apply id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.2.2">𝑠</ci><apply id="S2.E1.m1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.2.3"><times id="S2.E1.m1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.2.3.1"></times><ci id="S2.E1.m1.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.2.3.2">𝑖</ci><ci id="S2.E1.m1.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3"><divide id="S2.E1.m1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.3"></divide><apply id="S2.E1.m1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.3.2"><times id="S2.E1.m1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.3.2.1"></times><apply id="S2.E1.m1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.2.2.1.cmml" xref="S2.E1.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E1.m1.1.1.3.2.2.2.cmml" xref="S2.E1.m1.1.1.3.2.2.2">𝑸</ci><ci id="S2.E1.m1.1.1.3.2.2.3.cmml" xref="S2.E1.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S2.E1.m1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.2.3.1.cmml" xref="S2.E1.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.3.2.3.2.cmml" xref="S2.E1.m1.1.1.3.2.3.2">𝑲</ci><ci id="S2.E1.m1.1.1.3.2.3.3.cmml" xref="S2.E1.m1.1.1.3.2.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.3.3"><root id="S2.E1.m1.1.1.3.3a.cmml" xref="S2.E1.m1.1.1.3.3"></root><apply id="S2.E1.m1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.3.2.1.cmml" xref="S2.E1.m1.1.1.3.3.2">superscript</csymbol><ci id="S2.E1.m1.1.1.3.3.2.2.cmml" xref="S2.E1.m1.1.1.3.3.2.2">𝑑</ci><ci id="S2.E1.m1.1.1.3.3.2.3.cmml" xref="S2.E1.m1.1.1.3.3.2.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">s_{ij}=\frac{\bm{Q}_{i}\bm{K}_{j}}{\sqrt{d^{\prime}}}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">italic_s start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG bold_italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_ARG end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SSx3.p2">
<p class="ltx_p" id="S2.SSx3.p2.1">This results in a matrix of scores <math alttext="\bm{s_{ij}}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="S2.SSx3.p2.1.m1.1"><semantics id="S2.SSx3.p2.1.m1.1a"><mrow id="S2.SSx3.p2.1.m1.1.1" xref="S2.SSx3.p2.1.m1.1.1.cmml"><msub id="S2.SSx3.p2.1.m1.1.1.2" xref="S2.SSx3.p2.1.m1.1.1.2.cmml"><mi id="S2.SSx3.p2.1.m1.1.1.2.2" xref="S2.SSx3.p2.1.m1.1.1.2.2.cmml">𝒔</mi><mrow id="S2.SSx3.p2.1.m1.1.1.2.3" xref="S2.SSx3.p2.1.m1.1.1.2.3.cmml"><mi id="S2.SSx3.p2.1.m1.1.1.2.3.2" xref="S2.SSx3.p2.1.m1.1.1.2.3.2.cmml">𝒊</mi><mo id="S2.SSx3.p2.1.m1.1.1.2.3.1" xref="S2.SSx3.p2.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SSx3.p2.1.m1.1.1.2.3.3" xref="S2.SSx3.p2.1.m1.1.1.2.3.3.cmml">𝒋</mi></mrow></msub><mo id="S2.SSx3.p2.1.m1.1.1.1" xref="S2.SSx3.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SSx3.p2.1.m1.1.1.3" xref="S2.SSx3.p2.1.m1.1.1.3.cmml"><mi id="S2.SSx3.p2.1.m1.1.1.3.2" xref="S2.SSx3.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SSx3.p2.1.m1.1.1.3.3" xref="S2.SSx3.p2.1.m1.1.1.3.3.cmml"><mi id="S2.SSx3.p2.1.m1.1.1.3.3.2" xref="S2.SSx3.p2.1.m1.1.1.3.3.2.cmml">N</mi><mo id="S2.SSx3.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SSx3.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SSx3.p2.1.m1.1.1.3.3.3" xref="S2.SSx3.p2.1.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SSx3.p2.1.m1.1b"><apply id="S2.SSx3.p2.1.m1.1.1.cmml" xref="S2.SSx3.p2.1.m1.1.1"><in id="S2.SSx3.p2.1.m1.1.1.1.cmml" xref="S2.SSx3.p2.1.m1.1.1.1"></in><apply id="S2.SSx3.p2.1.m1.1.1.2.cmml" xref="S2.SSx3.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SSx3.p2.1.m1.1.1.2.1.cmml" xref="S2.SSx3.p2.1.m1.1.1.2">subscript</csymbol><ci id="S2.SSx3.p2.1.m1.1.1.2.2.cmml" xref="S2.SSx3.p2.1.m1.1.1.2.2">𝒔</ci><apply id="S2.SSx3.p2.1.m1.1.1.2.3.cmml" xref="S2.SSx3.p2.1.m1.1.1.2.3"><times id="S2.SSx3.p2.1.m1.1.1.2.3.1.cmml" xref="S2.SSx3.p2.1.m1.1.1.2.3.1"></times><ci id="S2.SSx3.p2.1.m1.1.1.2.3.2.cmml" xref="S2.SSx3.p2.1.m1.1.1.2.3.2">𝒊</ci><ci id="S2.SSx3.p2.1.m1.1.1.2.3.3.cmml" xref="S2.SSx3.p2.1.m1.1.1.2.3.3">𝒋</ci></apply></apply><apply id="S2.SSx3.p2.1.m1.1.1.3.cmml" xref="S2.SSx3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SSx3.p2.1.m1.1.1.3.1.cmml" xref="S2.SSx3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S2.SSx3.p2.1.m1.1.1.3.2.cmml" xref="S2.SSx3.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S2.SSx3.p2.1.m1.1.1.3.3.cmml" xref="S2.SSx3.p2.1.m1.1.1.3.3"><times id="S2.SSx3.p2.1.m1.1.1.3.3.1.cmml" xref="S2.SSx3.p2.1.m1.1.1.3.3.1"></times><ci id="S2.SSx3.p2.1.m1.1.1.3.3.2.cmml" xref="S2.SSx3.p2.1.m1.1.1.3.3.2">𝑁</ci><ci id="S2.SSx3.p2.1.m1.1.1.3.3.3.cmml" xref="S2.SSx3.p2.1.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx3.p2.1.m1.1c">\bm{s_{ij}}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx3.p2.1.m1.1d">bold_italic_s start_POSTSUBSCRIPT bold_italic_i bold_italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SSx4">
<h3 class="ltx_title ltx_title_subsection">Apply Softmax to Obtain Attention Weights</h3>
<div class="ltx_para" id="S2.SSx4.p1">
<p class="ltx_p" id="S2.SSx4.p1.1">We apply the softmax function to each row of the score matrix to get the attention weights <math alttext="\bm{S}_{ij}" class="ltx_Math" display="inline" id="S2.SSx4.p1.1.m1.1"><semantics id="S2.SSx4.p1.1.m1.1a"><msub id="S2.SSx4.p1.1.m1.1.1" xref="S2.SSx4.p1.1.m1.1.1.cmml"><mi id="S2.SSx4.p1.1.m1.1.1.2" xref="S2.SSx4.p1.1.m1.1.1.2.cmml">𝑺</mi><mrow id="S2.SSx4.p1.1.m1.1.1.3" xref="S2.SSx4.p1.1.m1.1.1.3.cmml"><mi id="S2.SSx4.p1.1.m1.1.1.3.2" xref="S2.SSx4.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S2.SSx4.p1.1.m1.1.1.3.1" xref="S2.SSx4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SSx4.p1.1.m1.1.1.3.3" xref="S2.SSx4.p1.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SSx4.p1.1.m1.1b"><apply id="S2.SSx4.p1.1.m1.1.1.cmml" xref="S2.SSx4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SSx4.p1.1.m1.1.1.1.cmml" xref="S2.SSx4.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SSx4.p1.1.m1.1.1.2.cmml" xref="S2.SSx4.p1.1.m1.1.1.2">𝑺</ci><apply id="S2.SSx4.p1.1.m1.1.1.3.cmml" xref="S2.SSx4.p1.1.m1.1.1.3"><times id="S2.SSx4.p1.1.m1.1.1.3.1.cmml" xref="S2.SSx4.p1.1.m1.1.1.3.1"></times><ci id="S2.SSx4.p1.1.m1.1.1.3.2.cmml" xref="S2.SSx4.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S2.SSx4.p1.1.m1.1.1.3.3.cmml" xref="S2.SSx4.p1.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx4.p1.1.m1.1c">\bm{S}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx4.p1.1.m1.1d">bold_italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\bm{S}_{ij}=\frac{\exp(s_{ij})}{\sum_{k=1}^{N}\exp(s_{ik})}" class="ltx_Math" display="block" id="S2.E2.m1.4"><semantics id="S2.E2.m1.4a"><mrow id="S2.E2.m1.4.5" xref="S2.E2.m1.4.5.cmml"><msub id="S2.E2.m1.4.5.2" xref="S2.E2.m1.4.5.2.cmml"><mi id="S2.E2.m1.4.5.2.2" xref="S2.E2.m1.4.5.2.2.cmml">𝑺</mi><mrow id="S2.E2.m1.4.5.2.3" xref="S2.E2.m1.4.5.2.3.cmml"><mi id="S2.E2.m1.4.5.2.3.2" xref="S2.E2.m1.4.5.2.3.2.cmml">i</mi><mo id="S2.E2.m1.4.5.2.3.1" xref="S2.E2.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.4.5.2.3.3" xref="S2.E2.m1.4.5.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E2.m1.4.5.1" xref="S2.E2.m1.4.5.1.cmml">=</mo><mfrac id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml"><mrow id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">exp</mi><mo id="S2.E2.m1.2.2.2.2a" xref="S2.E2.m1.2.2.2.3.cmml">⁡</mo><mrow id="S2.E2.m1.2.2.2.2.1" xref="S2.E2.m1.2.2.2.3.cmml"><mo id="S2.E2.m1.2.2.2.2.1.2" stretchy="false" xref="S2.E2.m1.2.2.2.3.cmml">(</mo><msub id="S2.E2.m1.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.1.1.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.2.cmml">s</mi><mrow id="S2.E2.m1.2.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.3.2" xref="S2.E2.m1.2.2.2.2.1.1.3.2.cmml">i</mi><mo id="S2.E2.m1.2.2.2.2.1.1.3.1" xref="S2.E2.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.2.2.1.1.3.3" xref="S2.E2.m1.2.2.2.2.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S2.E2.m1.2.2.2.2.1.3" stretchy="false" xref="S2.E2.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S2.E2.m1.4.4.4" xref="S2.E2.m1.4.4.4.cmml"><msubsup id="S2.E2.m1.4.4.4.3" xref="S2.E2.m1.4.4.4.3.cmml"><mo id="S2.E2.m1.4.4.4.3.2.2" xref="S2.E2.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S2.E2.m1.4.4.4.3.2.3" xref="S2.E2.m1.4.4.4.3.2.3.cmml"><mi id="S2.E2.m1.4.4.4.3.2.3.2" xref="S2.E2.m1.4.4.4.3.2.3.2.cmml">k</mi><mo id="S2.E2.m1.4.4.4.3.2.3.1" xref="S2.E2.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S2.E2.m1.4.4.4.3.2.3.3" xref="S2.E2.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.4.4.4.3.3" xref="S2.E2.m1.4.4.4.3.3.cmml">N</mi></msubsup><mrow id="S2.E2.m1.4.4.4.2.1" xref="S2.E2.m1.4.4.4.2.2.cmml"><mi id="S2.E2.m1.3.3.3.1" xref="S2.E2.m1.3.3.3.1.cmml">exp</mi><mo id="S2.E2.m1.4.4.4.2.1a" xref="S2.E2.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S2.E2.m1.4.4.4.2.1.1" xref="S2.E2.m1.4.4.4.2.2.cmml"><mo id="S2.E2.m1.4.4.4.2.1.1.2" stretchy="false" xref="S2.E2.m1.4.4.4.2.2.cmml">(</mo><msub id="S2.E2.m1.4.4.4.2.1.1.1" xref="S2.E2.m1.4.4.4.2.1.1.1.cmml"><mi id="S2.E2.m1.4.4.4.2.1.1.1.2" xref="S2.E2.m1.4.4.4.2.1.1.1.2.cmml">s</mi><mrow id="S2.E2.m1.4.4.4.2.1.1.1.3" xref="S2.E2.m1.4.4.4.2.1.1.1.3.cmml"><mi id="S2.E2.m1.4.4.4.2.1.1.1.3.2" xref="S2.E2.m1.4.4.4.2.1.1.1.3.2.cmml">i</mi><mo id="S2.E2.m1.4.4.4.2.1.1.1.3.1" xref="S2.E2.m1.4.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.4.4.4.2.1.1.1.3.3" xref="S2.E2.m1.4.4.4.2.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S2.E2.m1.4.4.4.2.1.1.3" stretchy="false" xref="S2.E2.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.4b"><apply id="S2.E2.m1.4.5.cmml" xref="S2.E2.m1.4.5"><eq id="S2.E2.m1.4.5.1.cmml" xref="S2.E2.m1.4.5.1"></eq><apply id="S2.E2.m1.4.5.2.cmml" xref="S2.E2.m1.4.5.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.5.2.1.cmml" xref="S2.E2.m1.4.5.2">subscript</csymbol><ci id="S2.E2.m1.4.5.2.2.cmml" xref="S2.E2.m1.4.5.2.2">𝑺</ci><apply id="S2.E2.m1.4.5.2.3.cmml" xref="S2.E2.m1.4.5.2.3"><times id="S2.E2.m1.4.5.2.3.1.cmml" xref="S2.E2.m1.4.5.2.3.1"></times><ci id="S2.E2.m1.4.5.2.3.2.cmml" xref="S2.E2.m1.4.5.2.3.2">𝑖</ci><ci id="S2.E2.m1.4.5.2.3.3.cmml" xref="S2.E2.m1.4.5.2.3.3">𝑗</ci></apply></apply><apply id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"><divide id="S2.E2.m1.4.4.5.cmml" xref="S2.E2.m1.4.4"></divide><apply id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2"><exp id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1"></exp><apply id="S2.E2.m1.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2">𝑠</ci><apply id="S2.E2.m1.2.2.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3"><times id="S2.E2.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.1"></times><ci id="S2.E2.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.2">𝑖</ci><ci id="S2.E2.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S2.E2.m1.4.4.4.cmml" xref="S2.E2.m1.4.4.4"><apply id="S2.E2.m1.4.4.4.3.cmml" xref="S2.E2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.3.1.cmml" xref="S2.E2.m1.4.4.4.3">superscript</csymbol><apply id="S2.E2.m1.4.4.4.3.2.cmml" xref="S2.E2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.3.2.1.cmml" xref="S2.E2.m1.4.4.4.3">subscript</csymbol><sum id="S2.E2.m1.4.4.4.3.2.2.cmml" xref="S2.E2.m1.4.4.4.3.2.2"></sum><apply id="S2.E2.m1.4.4.4.3.2.3.cmml" xref="S2.E2.m1.4.4.4.3.2.3"><eq id="S2.E2.m1.4.4.4.3.2.3.1.cmml" xref="S2.E2.m1.4.4.4.3.2.3.1"></eq><ci id="S2.E2.m1.4.4.4.3.2.3.2.cmml" xref="S2.E2.m1.4.4.4.3.2.3.2">𝑘</ci><cn id="S2.E2.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="S2.E2.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.4.4.4.3.3.cmml" xref="S2.E2.m1.4.4.4.3.3">𝑁</ci></apply><apply id="S2.E2.m1.4.4.4.2.2.cmml" xref="S2.E2.m1.4.4.4.2.1"><exp id="S2.E2.m1.3.3.3.1.cmml" xref="S2.E2.m1.3.3.3.1"></exp><apply id="S2.E2.m1.4.4.4.2.1.1.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.1.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.4.4.4.2.1.1.1.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2">𝑠</ci><apply id="S2.E2.m1.4.4.4.2.1.1.1.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3"><times id="S2.E2.m1.4.4.4.2.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3.1"></times><ci id="S2.E2.m1.4.4.4.2.1.1.1.3.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3.2">𝑖</ci><ci id="S2.E2.m1.4.4.4.2.1.1.1.3.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.4c">\bm{S}_{ij}=\frac{\exp(s_{ij})}{\sum_{k=1}^{N}\exp(s_{ik})}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.4d">bold_italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG roman_exp ( italic_s start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT roman_exp ( italic_s start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SSx4.p2">
<p class="ltx_p" id="S2.SSx4.p2.1">The softmax ensures that the attention weights for each vector sum to 1, making them comparable to probabilities.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SSx5">
<h3 class="ltx_title ltx_title_subsection">Compute Attention Output</h3>
<div class="ltx_para" id="S2.SSx5.p1">
<p class="ltx_p" id="S2.SSx5.p1.4">For each input vector <math alttext="\bf{x}_{i}" class="ltx_Math" display="inline" id="S2.SSx5.p1.1.m1.1"><semantics id="S2.SSx5.p1.1.m1.1a"><msub id="S2.SSx5.p1.1.m1.1.1" xref="S2.SSx5.p1.1.m1.1.1.cmml"><mi id="S2.SSx5.p1.1.m1.1.1.2" xref="S2.SSx5.p1.1.m1.1.1.2.cmml">𝐱</mi><mi id="S2.SSx5.p1.1.m1.1.1.3" xref="S2.SSx5.p1.1.m1.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx5.p1.1.m1.1b"><apply id="S2.SSx5.p1.1.m1.1.1.cmml" xref="S2.SSx5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SSx5.p1.1.m1.1.1.1.cmml" xref="S2.SSx5.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SSx5.p1.1.m1.1.1.2.cmml" xref="S2.SSx5.p1.1.m1.1.1.2">𝐱</ci><ci id="S2.SSx5.p1.1.m1.1.1.3.cmml" xref="S2.SSx5.p1.1.m1.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx5.p1.1.m1.1c">\bf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx5.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT</annotation></semantics></math>, we compute the output vector <math alttext="\bm{A}_{i}" class="ltx_Math" display="inline" id="S2.SSx5.p1.2.m2.1"><semantics id="S2.SSx5.p1.2.m2.1a"><msub id="S2.SSx5.p1.2.m2.1.1" xref="S2.SSx5.p1.2.m2.1.1.cmml"><mi id="S2.SSx5.p1.2.m2.1.1.2" xref="S2.SSx5.p1.2.m2.1.1.2.cmml">𝑨</mi><mi id="S2.SSx5.p1.2.m2.1.1.3" xref="S2.SSx5.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx5.p1.2.m2.1b"><apply id="S2.SSx5.p1.2.m2.1.1.cmml" xref="S2.SSx5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SSx5.p1.2.m2.1.1.1.cmml" xref="S2.SSx5.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SSx5.p1.2.m2.1.1.2.cmml" xref="S2.SSx5.p1.2.m2.1.1.2">𝑨</ci><ci id="S2.SSx5.p1.2.m2.1.1.3.cmml" xref="S2.SSx5.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx5.p1.2.m2.1c">\bm{A}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx5.p1.2.m2.1d">bold_italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as the weighted sum of the value vectors <math alttext="\bm{V}_{j}" class="ltx_Math" display="inline" id="S2.SSx5.p1.3.m3.1"><semantics id="S2.SSx5.p1.3.m3.1a"><msub id="S2.SSx5.p1.3.m3.1.1" xref="S2.SSx5.p1.3.m3.1.1.cmml"><mi id="S2.SSx5.p1.3.m3.1.1.2" xref="S2.SSx5.p1.3.m3.1.1.2.cmml">𝑽</mi><mi id="S2.SSx5.p1.3.m3.1.1.3" xref="S2.SSx5.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx5.p1.3.m3.1b"><apply id="S2.SSx5.p1.3.m3.1.1.cmml" xref="S2.SSx5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SSx5.p1.3.m3.1.1.1.cmml" xref="S2.SSx5.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SSx5.p1.3.m3.1.1.2.cmml" xref="S2.SSx5.p1.3.m3.1.1.2">𝑽</ci><ci id="S2.SSx5.p1.3.m3.1.1.3.cmml" xref="S2.SSx5.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx5.p1.3.m3.1c">\bm{V}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx5.p1.3.m3.1d">bold_italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, using the attention weights <math alttext="\bm{S}_{ij}" class="ltx_Math" display="inline" id="S2.SSx5.p1.4.m4.1"><semantics id="S2.SSx5.p1.4.m4.1a"><msub id="S2.SSx5.p1.4.m4.1.1" xref="S2.SSx5.p1.4.m4.1.1.cmml"><mi id="S2.SSx5.p1.4.m4.1.1.2" xref="S2.SSx5.p1.4.m4.1.1.2.cmml">𝑺</mi><mrow id="S2.SSx5.p1.4.m4.1.1.3" xref="S2.SSx5.p1.4.m4.1.1.3.cmml"><mi id="S2.SSx5.p1.4.m4.1.1.3.2" xref="S2.SSx5.p1.4.m4.1.1.3.2.cmml">i</mi><mo id="S2.SSx5.p1.4.m4.1.1.3.1" xref="S2.SSx5.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SSx5.p1.4.m4.1.1.3.3" xref="S2.SSx5.p1.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SSx5.p1.4.m4.1b"><apply id="S2.SSx5.p1.4.m4.1.1.cmml" xref="S2.SSx5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SSx5.p1.4.m4.1.1.1.cmml" xref="S2.SSx5.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SSx5.p1.4.m4.1.1.2.cmml" xref="S2.SSx5.p1.4.m4.1.1.2">𝑺</ci><apply id="S2.SSx5.p1.4.m4.1.1.3.cmml" xref="S2.SSx5.p1.4.m4.1.1.3"><times id="S2.SSx5.p1.4.m4.1.1.3.1.cmml" xref="S2.SSx5.p1.4.m4.1.1.3.1"></times><ci id="S2.SSx5.p1.4.m4.1.1.3.2.cmml" xref="S2.SSx5.p1.4.m4.1.1.3.2">𝑖</ci><ci id="S2.SSx5.p1.4.m4.1.1.3.3.cmml" xref="S2.SSx5.p1.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx5.p1.4.m4.1c">\bm{S}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx5.p1.4.m4.1d">bold_italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\bm{A}_{i}=\sum_{j=0}^{N-1}\bm{S}_{ij}\bm{V}_{j}" class="ltx_Math" display="block" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><msub id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml"><mi id="S2.E3.m1.1.1.2.2" xref="S2.E3.m1.1.1.2.2.cmml">𝑨</mi><mi id="S2.E3.m1.1.1.2.3" xref="S2.E3.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.E3.m1.1.1.1" rspace="0.111em" xref="S2.E3.m1.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml"><munderover id="S2.E3.m1.1.1.3.1" xref="S2.E3.m1.1.1.3.1.cmml"><mo id="S2.E3.m1.1.1.3.1.2.2" movablelimits="false" xref="S2.E3.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E3.m1.1.1.3.1.2.3" xref="S2.E3.m1.1.1.3.1.2.3.cmml"><mi id="S2.E3.m1.1.1.3.1.2.3.2" xref="S2.E3.m1.1.1.3.1.2.3.2.cmml">j</mi><mo id="S2.E3.m1.1.1.3.1.2.3.1" xref="S2.E3.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E3.m1.1.1.3.1.2.3.3" xref="S2.E3.m1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="S2.E3.m1.1.1.3.1.3" xref="S2.E3.m1.1.1.3.1.3.cmml"><mi id="S2.E3.m1.1.1.3.1.3.2" xref="S2.E3.m1.1.1.3.1.3.2.cmml">N</mi><mo id="S2.E3.m1.1.1.3.1.3.1" xref="S2.E3.m1.1.1.3.1.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.3.1.3.3" xref="S2.E3.m1.1.1.3.1.3.3.cmml">1</mn></mrow></munderover><mrow id="S2.E3.m1.1.1.3.2" xref="S2.E3.m1.1.1.3.2.cmml"><msub id="S2.E3.m1.1.1.3.2.2" xref="S2.E3.m1.1.1.3.2.2.cmml"><mi id="S2.E3.m1.1.1.3.2.2.2" xref="S2.E3.m1.1.1.3.2.2.2.cmml">𝑺</mi><mrow id="S2.E3.m1.1.1.3.2.2.3" xref="S2.E3.m1.1.1.3.2.2.3.cmml"><mi id="S2.E3.m1.1.1.3.2.2.3.2" xref="S2.E3.m1.1.1.3.2.2.3.2.cmml">i</mi><mo id="S2.E3.m1.1.1.3.2.2.3.1" xref="S2.E3.m1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.3.2.2.3.3" xref="S2.E3.m1.1.1.3.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E3.m1.1.1.3.2.1" xref="S2.E3.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S2.E3.m1.1.1.3.2.3" xref="S2.E3.m1.1.1.3.2.3.cmml"><mi id="S2.E3.m1.1.1.3.2.3.2" xref="S2.E3.m1.1.1.3.2.3.2.cmml">𝑽</mi><mi id="S2.E3.m1.1.1.3.2.3.3" xref="S2.E3.m1.1.1.3.2.3.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><eq id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"></eq><apply id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.2.2">𝑨</ci><ci id="S2.E3.m1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3"><apply id="S2.E3.m1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.1.1.cmml" xref="S2.E3.m1.1.1.3.1">superscript</csymbol><apply id="S2.E3.m1.1.1.3.1.2.cmml" xref="S2.E3.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.1.2.1.cmml" xref="S2.E3.m1.1.1.3.1">subscript</csymbol><sum id="S2.E3.m1.1.1.3.1.2.2.cmml" xref="S2.E3.m1.1.1.3.1.2.2"></sum><apply id="S2.E3.m1.1.1.3.1.2.3.cmml" xref="S2.E3.m1.1.1.3.1.2.3"><eq id="S2.E3.m1.1.1.3.1.2.3.1.cmml" xref="S2.E3.m1.1.1.3.1.2.3.1"></eq><ci id="S2.E3.m1.1.1.3.1.2.3.2.cmml" xref="S2.E3.m1.1.1.3.1.2.3.2">𝑗</ci><cn id="S2.E3.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="S2.E3.m1.1.1.3.1.3.cmml" xref="S2.E3.m1.1.1.3.1.3"><minus id="S2.E3.m1.1.1.3.1.3.1.cmml" xref="S2.E3.m1.1.1.3.1.3.1"></minus><ci id="S2.E3.m1.1.1.3.1.3.2.cmml" xref="S2.E3.m1.1.1.3.1.3.2">𝑁</ci><cn id="S2.E3.m1.1.1.3.1.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.3.1.3.3">1</cn></apply></apply><apply id="S2.E3.m1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.3.2"><times id="S2.E3.m1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.3.2.1"></times><apply id="S2.E3.m1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.2.2.1.cmml" xref="S2.E3.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E3.m1.1.1.3.2.2.2.cmml" xref="S2.E3.m1.1.1.3.2.2.2">𝑺</ci><apply id="S2.E3.m1.1.1.3.2.2.3.cmml" xref="S2.E3.m1.1.1.3.2.2.3"><times id="S2.E3.m1.1.1.3.2.2.3.1.cmml" xref="S2.E3.m1.1.1.3.2.2.3.1"></times><ci id="S2.E3.m1.1.1.3.2.2.3.2.cmml" xref="S2.E3.m1.1.1.3.2.2.3.2">𝑖</ci><ci id="S2.E3.m1.1.1.3.2.2.3.3.cmml" xref="S2.E3.m1.1.1.3.2.2.3.3">𝑗</ci></apply></apply><apply id="S2.E3.m1.1.1.3.2.3.cmml" xref="S2.E3.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.2.3.1.cmml" xref="S2.E3.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.E3.m1.1.1.3.2.3.2.cmml" xref="S2.E3.m1.1.1.3.2.3.2">𝑽</ci><ci id="S2.E3.m1.1.1.3.2.3.3.cmml" xref="S2.E3.m1.1.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\bm{A}_{i}=\sum_{j=0}^{N-1}\bm{S}_{ij}\bm{V}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">bold_italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT bold_italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT bold_italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SSx5.p1.6">The final output of the self-attention mechanism is a new sequence of vectors <math alttext="\bm{A}_{i}" class="ltx_Math" display="inline" id="S2.SSx5.p1.5.m1.1"><semantics id="S2.SSx5.p1.5.m1.1a"><msub id="S2.SSx5.p1.5.m1.1.1" xref="S2.SSx5.p1.5.m1.1.1.cmml"><mi id="S2.SSx5.p1.5.m1.1.1.2" xref="S2.SSx5.p1.5.m1.1.1.2.cmml">𝑨</mi><mi id="S2.SSx5.p1.5.m1.1.1.3" xref="S2.SSx5.p1.5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SSx5.p1.5.m1.1b"><apply id="S2.SSx5.p1.5.m1.1.1.cmml" xref="S2.SSx5.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S2.SSx5.p1.5.m1.1.1.1.cmml" xref="S2.SSx5.p1.5.m1.1.1">subscript</csymbol><ci id="S2.SSx5.p1.5.m1.1.1.2.cmml" xref="S2.SSx5.p1.5.m1.1.1.2">𝑨</ci><ci id="S2.SSx5.p1.5.m1.1.1.3.cmml" xref="S2.SSx5.p1.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx5.p1.5.m1.1c">\bm{A}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx5.p1.5.m1.1d">bold_italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of size <math alttext="N\times d^{\prime}" class="ltx_Math" display="inline" id="S2.SSx5.p1.6.m2.1"><semantics id="S2.SSx5.p1.6.m2.1a"><mrow id="S2.SSx5.p1.6.m2.1.1" xref="S2.SSx5.p1.6.m2.1.1.cmml"><mi id="S2.SSx5.p1.6.m2.1.1.2" xref="S2.SSx5.p1.6.m2.1.1.2.cmml">N</mi><mo id="S2.SSx5.p1.6.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SSx5.p1.6.m2.1.1.1.cmml">×</mo><msup id="S2.SSx5.p1.6.m2.1.1.3" xref="S2.SSx5.p1.6.m2.1.1.3.cmml"><mi id="S2.SSx5.p1.6.m2.1.1.3.2" xref="S2.SSx5.p1.6.m2.1.1.3.2.cmml">d</mi><mo id="S2.SSx5.p1.6.m2.1.1.3.3" xref="S2.SSx5.p1.6.m2.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SSx5.p1.6.m2.1b"><apply id="S2.SSx5.p1.6.m2.1.1.cmml" xref="S2.SSx5.p1.6.m2.1.1"><times id="S2.SSx5.p1.6.m2.1.1.1.cmml" xref="S2.SSx5.p1.6.m2.1.1.1"></times><ci id="S2.SSx5.p1.6.m2.1.1.2.cmml" xref="S2.SSx5.p1.6.m2.1.1.2">𝑁</ci><apply id="S2.SSx5.p1.6.m2.1.1.3.cmml" xref="S2.SSx5.p1.6.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SSx5.p1.6.m2.1.1.3.1.cmml" xref="S2.SSx5.p1.6.m2.1.1.3">superscript</csymbol><ci id="S2.SSx5.p1.6.m2.1.1.3.2.cmml" xref="S2.SSx5.p1.6.m2.1.1.3.2">𝑑</ci><ci id="S2.SSx5.p1.6.m2.1.1.3.3.cmml" xref="S2.SSx5.p1.6.m2.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx5.p1.6.m2.1c">N\times d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SSx5.p1.6.m2.1d">italic_N × italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. Each output vector is influenced by the entire input sequence, weighted by their respective attention scores.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>The engineering perspective: Self-Attention Mechanism</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.3">At first glance, the previous steps may seem quite arbitrary. To gain some intuition, we can relate these to similar concepts in physics and mathematics that are commonly familiar to engineers. We can think of Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.E3" title="In Compute Attention Output ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">3</span></a>) as having the same form as a discrete integral transform where the sequence <math alttext="\bm{V}_{j}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><msub id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">𝑽</mi><mi id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝑽</ci><ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\bm{V}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">bold_italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is transformed into the sequence <math alttext="\bm{A}_{i}" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1"><semantics id="S2.SS3.p1.2.m2.1a"><msub id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">𝑨</mi><mi id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">𝑨</ci><ci id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">\bm{A}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">bold_italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> by the kernel <math alttext="\bm{S}_{ij}" class="ltx_Math" display="inline" id="S2.SS3.p1.3.m3.1"><semantics id="S2.SS3.p1.3.m3.1a"><msub id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml"><mi id="S2.SS3.p1.3.m3.1.1.2" xref="S2.SS3.p1.3.m3.1.1.2.cmml">𝑺</mi><mrow id="S2.SS3.p1.3.m3.1.1.3" xref="S2.SS3.p1.3.m3.1.1.3.cmml"><mi id="S2.SS3.p1.3.m3.1.1.3.2" xref="S2.SS3.p1.3.m3.1.1.3.2.cmml">i</mi><mo id="S2.SS3.p1.3.m3.1.1.3.1" xref="S2.SS3.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p1.3.m3.1.1.3.3" xref="S2.SS3.p1.3.m3.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><apply id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p1.3.m3.1.1.2.cmml" xref="S2.SS3.p1.3.m3.1.1.2">𝑺</ci><apply id="S2.SS3.p1.3.m3.1.1.3.cmml" xref="S2.SS3.p1.3.m3.1.1.3"><times id="S2.SS3.p1.3.m3.1.1.3.1.cmml" xref="S2.SS3.p1.3.m3.1.1.3.1"></times><ci id="S2.SS3.p1.3.m3.1.1.3.2.cmml" xref="S2.SS3.p1.3.m3.1.1.3.2">𝑖</ci><ci id="S2.SS3.p1.3.m3.1.1.3.3.cmml" xref="S2.SS3.p1.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">\bm{S}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.3.m3.1d">bold_italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
For comparison, a common integral transform, the discrete Fourier transform (DFT), can be written as:</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="X_{k}=\sum_{n=0}^{N-1}x_{n}e^{-i2\pi kn/N}" class="ltx_Math" display="block" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><msub id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml"><mi id="S2.E4.m1.1.1.2.2" xref="S2.E4.m1.1.1.2.2.cmml">X</mi><mi id="S2.E4.m1.1.1.2.3" xref="S2.E4.m1.1.1.2.3.cmml">k</mi></msub><mo id="S2.E4.m1.1.1.1" rspace="0.111em" xref="S2.E4.m1.1.1.1.cmml">=</mo><mrow id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml"><munderover id="S2.E4.m1.1.1.3.1" xref="S2.E4.m1.1.1.3.1.cmml"><mo id="S2.E4.m1.1.1.3.1.2.2" movablelimits="false" xref="S2.E4.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E4.m1.1.1.3.1.2.3" xref="S2.E4.m1.1.1.3.1.2.3.cmml"><mi id="S2.E4.m1.1.1.3.1.2.3.2" xref="S2.E4.m1.1.1.3.1.2.3.2.cmml">n</mi><mo id="S2.E4.m1.1.1.3.1.2.3.1" xref="S2.E4.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E4.m1.1.1.3.1.2.3.3" xref="S2.E4.m1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="S2.E4.m1.1.1.3.1.3" xref="S2.E4.m1.1.1.3.1.3.cmml"><mi id="S2.E4.m1.1.1.3.1.3.2" xref="S2.E4.m1.1.1.3.1.3.2.cmml">N</mi><mo id="S2.E4.m1.1.1.3.1.3.1" xref="S2.E4.m1.1.1.3.1.3.1.cmml">−</mo><mn id="S2.E4.m1.1.1.3.1.3.3" xref="S2.E4.m1.1.1.3.1.3.3.cmml">1</mn></mrow></munderover><mrow id="S2.E4.m1.1.1.3.2" xref="S2.E4.m1.1.1.3.2.cmml"><msub id="S2.E4.m1.1.1.3.2.2" xref="S2.E4.m1.1.1.3.2.2.cmml"><mi id="S2.E4.m1.1.1.3.2.2.2" xref="S2.E4.m1.1.1.3.2.2.2.cmml">x</mi><mi id="S2.E4.m1.1.1.3.2.2.3" xref="S2.E4.m1.1.1.3.2.2.3.cmml">n</mi></msub><mo id="S2.E4.m1.1.1.3.2.1" xref="S2.E4.m1.1.1.3.2.1.cmml">⁢</mo><msup id="S2.E4.m1.1.1.3.2.3" xref="S2.E4.m1.1.1.3.2.3.cmml"><mi id="S2.E4.m1.1.1.3.2.3.2" xref="S2.E4.m1.1.1.3.2.3.2.cmml">e</mi><mrow id="S2.E4.m1.1.1.3.2.3.3" xref="S2.E4.m1.1.1.3.2.3.3.cmml"><mo id="S2.E4.m1.1.1.3.2.3.3a" xref="S2.E4.m1.1.1.3.2.3.3.cmml">−</mo><mrow id="S2.E4.m1.1.1.3.2.3.3.2" xref="S2.E4.m1.1.1.3.2.3.3.2.cmml"><mrow id="S2.E4.m1.1.1.3.2.3.3.2.2" xref="S2.E4.m1.1.1.3.2.3.3.2.2.cmml"><mi id="S2.E4.m1.1.1.3.2.3.3.2.2.2" xref="S2.E4.m1.1.1.3.2.3.3.2.2.2.cmml">i</mi><mo id="S2.E4.m1.1.1.3.2.3.3.2.2.1" xref="S2.E4.m1.1.1.3.2.3.3.2.2.1.cmml">⁢</mo><mn id="S2.E4.m1.1.1.3.2.3.3.2.2.3" xref="S2.E4.m1.1.1.3.2.3.3.2.2.3.cmml">2</mn><mo id="S2.E4.m1.1.1.3.2.3.3.2.2.1a" xref="S2.E4.m1.1.1.3.2.3.3.2.2.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.3.2.3.3.2.2.4" xref="S2.E4.m1.1.1.3.2.3.3.2.2.4.cmml">π</mi><mo id="S2.E4.m1.1.1.3.2.3.3.2.2.1b" xref="S2.E4.m1.1.1.3.2.3.3.2.2.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.3.2.3.3.2.2.5" xref="S2.E4.m1.1.1.3.2.3.3.2.2.5.cmml">k</mi><mo id="S2.E4.m1.1.1.3.2.3.3.2.2.1c" xref="S2.E4.m1.1.1.3.2.3.3.2.2.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.3.2.3.3.2.2.6" xref="S2.E4.m1.1.1.3.2.3.3.2.2.6.cmml">n</mi></mrow><mo id="S2.E4.m1.1.1.3.2.3.3.2.1" xref="S2.E4.m1.1.1.3.2.3.3.2.1.cmml">/</mo><mi id="S2.E4.m1.1.1.3.2.3.3.2.3" xref="S2.E4.m1.1.1.3.2.3.3.2.3.cmml">N</mi></mrow></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><eq id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"></eq><apply id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.2">subscript</csymbol><ci id="S2.E4.m1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.2.2">𝑋</ci><ci id="S2.E4.m1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.2.3">𝑘</ci></apply><apply id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3"><apply id="S2.E4.m1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.1.1.cmml" xref="S2.E4.m1.1.1.3.1">superscript</csymbol><apply id="S2.E4.m1.1.1.3.1.2.cmml" xref="S2.E4.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.1.2.1.cmml" xref="S2.E4.m1.1.1.3.1">subscript</csymbol><sum id="S2.E4.m1.1.1.3.1.2.2.cmml" xref="S2.E4.m1.1.1.3.1.2.2"></sum><apply id="S2.E4.m1.1.1.3.1.2.3.cmml" xref="S2.E4.m1.1.1.3.1.2.3"><eq id="S2.E4.m1.1.1.3.1.2.3.1.cmml" xref="S2.E4.m1.1.1.3.1.2.3.1"></eq><ci id="S2.E4.m1.1.1.3.1.2.3.2.cmml" xref="S2.E4.m1.1.1.3.1.2.3.2">𝑛</ci><cn id="S2.E4.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.E4.m1.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="S2.E4.m1.1.1.3.1.3.cmml" xref="S2.E4.m1.1.1.3.1.3"><minus id="S2.E4.m1.1.1.3.1.3.1.cmml" xref="S2.E4.m1.1.1.3.1.3.1"></minus><ci id="S2.E4.m1.1.1.3.1.3.2.cmml" xref="S2.E4.m1.1.1.3.1.3.2">𝑁</ci><cn id="S2.E4.m1.1.1.3.1.3.3.cmml" type="integer" xref="S2.E4.m1.1.1.3.1.3.3">1</cn></apply></apply><apply id="S2.E4.m1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.3.2"><times id="S2.E4.m1.1.1.3.2.1.cmml" xref="S2.E4.m1.1.1.3.2.1"></times><apply id="S2.E4.m1.1.1.3.2.2.cmml" xref="S2.E4.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.2.2.1.cmml" xref="S2.E4.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E4.m1.1.1.3.2.2.2.cmml" xref="S2.E4.m1.1.1.3.2.2.2">𝑥</ci><ci id="S2.E4.m1.1.1.3.2.2.3.cmml" xref="S2.E4.m1.1.1.3.2.2.3">𝑛</ci></apply><apply id="S2.E4.m1.1.1.3.2.3.cmml" xref="S2.E4.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.2.3.1.cmml" xref="S2.E4.m1.1.1.3.2.3">superscript</csymbol><ci id="S2.E4.m1.1.1.3.2.3.2.cmml" xref="S2.E4.m1.1.1.3.2.3.2">𝑒</ci><apply id="S2.E4.m1.1.1.3.2.3.3.cmml" xref="S2.E4.m1.1.1.3.2.3.3"><minus id="S2.E4.m1.1.1.3.2.3.3.1.cmml" xref="S2.E4.m1.1.1.3.2.3.3"></minus><apply id="S2.E4.m1.1.1.3.2.3.3.2.cmml" xref="S2.E4.m1.1.1.3.2.3.3.2"><divide id="S2.E4.m1.1.1.3.2.3.3.2.1.cmml" xref="S2.E4.m1.1.1.3.2.3.3.2.1"></divide><apply id="S2.E4.m1.1.1.3.2.3.3.2.2.cmml" xref="S2.E4.m1.1.1.3.2.3.3.2.2"><times id="S2.E4.m1.1.1.3.2.3.3.2.2.1.cmml" xref="S2.E4.m1.1.1.3.2.3.3.2.2.1"></times><ci id="S2.E4.m1.1.1.3.2.3.3.2.2.2.cmml" xref="S2.E4.m1.1.1.3.2.3.3.2.2.2">𝑖</ci><cn id="S2.E4.m1.1.1.3.2.3.3.2.2.3.cmml" type="integer" xref="S2.E4.m1.1.1.3.2.3.3.2.2.3">2</cn><ci id="S2.E4.m1.1.1.3.2.3.3.2.2.4.cmml" xref="S2.E4.m1.1.1.3.2.3.3.2.2.4">𝜋</ci><ci id="S2.E4.m1.1.1.3.2.3.3.2.2.5.cmml" xref="S2.E4.m1.1.1.3.2.3.3.2.2.5">𝑘</ci><ci id="S2.E4.m1.1.1.3.2.3.3.2.2.6.cmml" xref="S2.E4.m1.1.1.3.2.3.3.2.2.6">𝑛</ci></apply><ci id="S2.E4.m1.1.1.3.2.3.3.2.3.cmml" xref="S2.E4.m1.1.1.3.2.3.3.2.3">𝑁</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">X_{k}=\sum_{n=0}^{N-1}x_{n}e^{-i2\pi kn/N}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT - italic_i 2 italic_π italic_k italic_n / italic_N end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.12">In this expression, the time-sequence <math alttext="x_{n}" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.1"><semantics id="S2.SS3.p3.1.m1.1a"><msub id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml"><mi id="S2.SS3.p3.1.m1.1.1.2" xref="S2.SS3.p3.1.m1.1.1.2.cmml">x</mi><mi id="S2.SS3.p3.1.m1.1.1.3" xref="S2.SS3.p3.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><apply id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p3.1.m1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2">𝑥</ci><ci id="S2.SS3.p3.1.m1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">x_{n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> is transformed into the frequency-sequence <math alttext="X_{k}" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.1"><semantics id="S2.SS3.p3.2.m2.1a"><msub id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml"><mi id="S2.SS3.p3.2.m2.1.1.2" xref="S2.SS3.p3.2.m2.1.1.2.cmml">X</mi><mi id="S2.SS3.p3.2.m2.1.1.3" xref="S2.SS3.p3.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p3.2.m2.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1.2">𝑋</ci><ci id="S2.SS3.p3.2.m2.1.1.3.cmml" xref="S2.SS3.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">X_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.1d">italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> by the kernel <math alttext="e^{-i2\pi kn/N}" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m3.1"><semantics id="S2.SS3.p3.3.m3.1a"><msup id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml"><mi id="S2.SS3.p3.3.m3.1.1.2" xref="S2.SS3.p3.3.m3.1.1.2.cmml">e</mi><mrow id="S2.SS3.p3.3.m3.1.1.3" xref="S2.SS3.p3.3.m3.1.1.3.cmml"><mo id="S2.SS3.p3.3.m3.1.1.3a" xref="S2.SS3.p3.3.m3.1.1.3.cmml">−</mo><mrow id="S2.SS3.p3.3.m3.1.1.3.2" xref="S2.SS3.p3.3.m3.1.1.3.2.cmml"><mrow id="S2.SS3.p3.3.m3.1.1.3.2.2" xref="S2.SS3.p3.3.m3.1.1.3.2.2.cmml"><mi id="S2.SS3.p3.3.m3.1.1.3.2.2.2" xref="S2.SS3.p3.3.m3.1.1.3.2.2.2.cmml">i</mi><mo id="S2.SS3.p3.3.m3.1.1.3.2.2.1" xref="S2.SS3.p3.3.m3.1.1.3.2.2.1.cmml">⁢</mo><mn id="S2.SS3.p3.3.m3.1.1.3.2.2.3" xref="S2.SS3.p3.3.m3.1.1.3.2.2.3.cmml">2</mn><mo id="S2.SS3.p3.3.m3.1.1.3.2.2.1a" xref="S2.SS3.p3.3.m3.1.1.3.2.2.1.cmml">⁢</mo><mi id="S2.SS3.p3.3.m3.1.1.3.2.2.4" xref="S2.SS3.p3.3.m3.1.1.3.2.2.4.cmml">π</mi><mo id="S2.SS3.p3.3.m3.1.1.3.2.2.1b" xref="S2.SS3.p3.3.m3.1.1.3.2.2.1.cmml">⁢</mo><mi id="S2.SS3.p3.3.m3.1.1.3.2.2.5" xref="S2.SS3.p3.3.m3.1.1.3.2.2.5.cmml">k</mi><mo id="S2.SS3.p3.3.m3.1.1.3.2.2.1c" xref="S2.SS3.p3.3.m3.1.1.3.2.2.1.cmml">⁢</mo><mi id="S2.SS3.p3.3.m3.1.1.3.2.2.6" xref="S2.SS3.p3.3.m3.1.1.3.2.2.6.cmml">n</mi></mrow><mo id="S2.SS3.p3.3.m3.1.1.3.2.1" xref="S2.SS3.p3.3.m3.1.1.3.2.1.cmml">/</mo><mi id="S2.SS3.p3.3.m3.1.1.3.2.3" xref="S2.SS3.p3.3.m3.1.1.3.2.3.cmml">N</mi></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><apply id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.1.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.p3.3.m3.1.1.2.cmml" xref="S2.SS3.p3.3.m3.1.1.2">𝑒</ci><apply id="S2.SS3.p3.3.m3.1.1.3.cmml" xref="S2.SS3.p3.3.m3.1.1.3"><minus id="S2.SS3.p3.3.m3.1.1.3.1.cmml" xref="S2.SS3.p3.3.m3.1.1.3"></minus><apply id="S2.SS3.p3.3.m3.1.1.3.2.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2"><divide id="S2.SS3.p3.3.m3.1.1.3.2.1.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2.1"></divide><apply id="S2.SS3.p3.3.m3.1.1.3.2.2.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2.2"><times id="S2.SS3.p3.3.m3.1.1.3.2.2.1.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2.2.1"></times><ci id="S2.SS3.p3.3.m3.1.1.3.2.2.2.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2.2.2">𝑖</ci><cn id="S2.SS3.p3.3.m3.1.1.3.2.2.3.cmml" type="integer" xref="S2.SS3.p3.3.m3.1.1.3.2.2.3">2</cn><ci id="S2.SS3.p3.3.m3.1.1.3.2.2.4.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2.2.4">𝜋</ci><ci id="S2.SS3.p3.3.m3.1.1.3.2.2.5.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2.2.5">𝑘</ci><ci id="S2.SS3.p3.3.m3.1.1.3.2.2.6.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2.2.6">𝑛</ci></apply><ci id="S2.SS3.p3.3.m3.1.1.3.2.3.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">e^{-i2\pi kn/N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.1d">italic_e start_POSTSUPERSCRIPT - italic_i 2 italic_π italic_k italic_n / italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>.
Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.E3" title="In Compute Attention Output ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">3</span></a>) is analogous to a Fourier series, but with a different kernel that is calculated from the data during training. Moreover, the <math alttext="{s}_{ij}" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m4.1"><semantics id="S2.SS3.p3.4.m4.1a"><msub id="S2.SS3.p3.4.m4.1.1" xref="S2.SS3.p3.4.m4.1.1.cmml"><mi id="S2.SS3.p3.4.m4.1.1.2" xref="S2.SS3.p3.4.m4.1.1.2.cmml">s</mi><mrow id="S2.SS3.p3.4.m4.1.1.3" xref="S2.SS3.p3.4.m4.1.1.3.cmml"><mi id="S2.SS3.p3.4.m4.1.1.3.2" xref="S2.SS3.p3.4.m4.1.1.3.2.cmml">i</mi><mo id="S2.SS3.p3.4.m4.1.1.3.1" xref="S2.SS3.p3.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p3.4.m4.1.1.3.3" xref="S2.SS3.p3.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><apply id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m4.1.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.p3.4.m4.1.1.2.cmml" xref="S2.SS3.p3.4.m4.1.1.2">𝑠</ci><apply id="S2.SS3.p3.4.m4.1.1.3.cmml" xref="S2.SS3.p3.4.m4.1.1.3"><times id="S2.SS3.p3.4.m4.1.1.3.1.cmml" xref="S2.SS3.p3.4.m4.1.1.3.1"></times><ci id="S2.SS3.p3.4.m4.1.1.3.2.cmml" xref="S2.SS3.p3.4.m4.1.1.3.2">𝑖</ci><ci id="S2.SS3.p3.4.m4.1.1.3.3.cmml" xref="S2.SS3.p3.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">{s}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> attention scores are the elements of the (centered) covariance matrix between <math alttext="\bm{Q}_{i}" class="ltx_Math" display="inline" id="S2.SS3.p3.5.m5.1"><semantics id="S2.SS3.p3.5.m5.1a"><msub id="S2.SS3.p3.5.m5.1.1" xref="S2.SS3.p3.5.m5.1.1.cmml"><mi id="S2.SS3.p3.5.m5.1.1.2" xref="S2.SS3.p3.5.m5.1.1.2.cmml">𝑸</mi><mi id="S2.SS3.p3.5.m5.1.1.3" xref="S2.SS3.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m5.1b"><apply id="S2.SS3.p3.5.m5.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.5.m5.1.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.p3.5.m5.1.1.2.cmml" xref="S2.SS3.p3.5.m5.1.1.2">𝑸</ci><ci id="S2.SS3.p3.5.m5.1.1.3.cmml" xref="S2.SS3.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m5.1c">\bm{Q}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.5.m5.1d">bold_italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\bm{K}_{j}" class="ltx_Math" display="inline" id="S2.SS3.p3.6.m6.1"><semantics id="S2.SS3.p3.6.m6.1a"><msub id="S2.SS3.p3.6.m6.1.1" xref="S2.SS3.p3.6.m6.1.1.cmml"><mi id="S2.SS3.p3.6.m6.1.1.2" xref="S2.SS3.p3.6.m6.1.1.2.cmml">𝑲</mi><mi id="S2.SS3.p3.6.m6.1.1.3" xref="S2.SS3.p3.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m6.1b"><apply id="S2.SS3.p3.6.m6.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.6.m6.1.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.p3.6.m6.1.1.2.cmml" xref="S2.SS3.p3.6.m6.1.1.2">𝑲</ci><ci id="S2.SS3.p3.6.m6.1.1.3.cmml" xref="S2.SS3.p3.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m6.1c">\bm{K}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.6.m6.1d">bold_italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, just rescaled by <math alttext="\sqrt{d^{\prime}}" class="ltx_Math" display="inline" id="S2.SS3.p3.7.m7.1"><semantics id="S2.SS3.p3.7.m7.1a"><msqrt id="S2.SS3.p3.7.m7.1.1" xref="S2.SS3.p3.7.m7.1.1.cmml"><msup id="S2.SS3.p3.7.m7.1.1.2" xref="S2.SS3.p3.7.m7.1.1.2.cmml"><mi id="S2.SS3.p3.7.m7.1.1.2.2" xref="S2.SS3.p3.7.m7.1.1.2.2.cmml">d</mi><mo id="S2.SS3.p3.7.m7.1.1.2.3" xref="S2.SS3.p3.7.m7.1.1.2.3.cmml">′</mo></msup></msqrt><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.7.m7.1b"><apply id="S2.SS3.p3.7.m7.1.1.cmml" xref="S2.SS3.p3.7.m7.1.1"><root id="S2.SS3.p3.7.m7.1.1a.cmml" xref="S2.SS3.p3.7.m7.1.1"></root><apply id="S2.SS3.p3.7.m7.1.1.2.cmml" xref="S2.SS3.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p3.7.m7.1.1.2.1.cmml" xref="S2.SS3.p3.7.m7.1.1.2">superscript</csymbol><ci id="S2.SS3.p3.7.m7.1.1.2.2.cmml" xref="S2.SS3.p3.7.m7.1.1.2.2">𝑑</ci><ci id="S2.SS3.p3.7.m7.1.1.2.3.cmml" xref="S2.SS3.p3.7.m7.1.1.2.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.7.m7.1c">\sqrt{d^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.7.m7.1d">square-root start_ARG italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math>. But because <math alttext="\bm{Q}_{i}" class="ltx_Math" display="inline" id="S2.SS3.p3.8.m8.1"><semantics id="S2.SS3.p3.8.m8.1a"><msub id="S2.SS3.p3.8.m8.1.1" xref="S2.SS3.p3.8.m8.1.1.cmml"><mi id="S2.SS3.p3.8.m8.1.1.2" xref="S2.SS3.p3.8.m8.1.1.2.cmml">𝑸</mi><mi id="S2.SS3.p3.8.m8.1.1.3" xref="S2.SS3.p3.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.8.m8.1b"><apply id="S2.SS3.p3.8.m8.1.1.cmml" xref="S2.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.8.m8.1.1.1.cmml" xref="S2.SS3.p3.8.m8.1.1">subscript</csymbol><ci id="S2.SS3.p3.8.m8.1.1.2.cmml" xref="S2.SS3.p3.8.m8.1.1.2">𝑸</ci><ci id="S2.SS3.p3.8.m8.1.1.3.cmml" xref="S2.SS3.p3.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.8.m8.1c">\bm{Q}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.8.m8.1d">bold_italic_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\bm{K}_{j}" class="ltx_Math" display="inline" id="S2.SS3.p3.9.m9.1"><semantics id="S2.SS3.p3.9.m9.1a"><msub id="S2.SS3.p3.9.m9.1.1" xref="S2.SS3.p3.9.m9.1.1.cmml"><mi id="S2.SS3.p3.9.m9.1.1.2" xref="S2.SS3.p3.9.m9.1.1.2.cmml">𝑲</mi><mi id="S2.SS3.p3.9.m9.1.1.3" xref="S2.SS3.p3.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.9.m9.1b"><apply id="S2.SS3.p3.9.m9.1.1.cmml" xref="S2.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.9.m9.1.1.1.cmml" xref="S2.SS3.p3.9.m9.1.1">subscript</csymbol><ci id="S2.SS3.p3.9.m9.1.1.2.cmml" xref="S2.SS3.p3.9.m9.1.1.2">𝑲</ci><ci id="S2.SS3.p3.9.m9.1.1.3.cmml" xref="S2.SS3.p3.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.9.m9.1c">\bm{K}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.9.m9.1d">bold_italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are both linear transformations of the original sequence <math alttext="\mathbf{x}_{\mathit{i}}" class="ltx_Math" display="inline" id="S2.SS3.p3.10.m10.1"><semantics id="S2.SS3.p3.10.m10.1a"><msub id="S2.SS3.p3.10.m10.1.1" xref="S2.SS3.p3.10.m10.1.1.cmml"><mi id="S2.SS3.p3.10.m10.1.1.2" xref="S2.SS3.p3.10.m10.1.1.2.cmml">𝐱</mi><mi id="S2.SS3.p3.10.m10.1.1.3" xref="S2.SS3.p3.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.10.m10.1b"><apply id="S2.SS3.p3.10.m10.1.1.cmml" xref="S2.SS3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.10.m10.1.1.1.cmml" xref="S2.SS3.p3.10.m10.1.1">subscript</csymbol><ci id="S2.SS3.p3.10.m10.1.1.2.cmml" xref="S2.SS3.p3.10.m10.1.1.2">𝐱</ci><ci id="S2.SS3.p3.10.m10.1.1.3.cmml" xref="S2.SS3.p3.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.10.m10.1c">\mathbf{x}_{\mathit{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.10.m10.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, the kernel <math alttext="\bm{S}_{ij}" class="ltx_Math" display="inline" id="S2.SS3.p3.11.m11.1"><semantics id="S2.SS3.p3.11.m11.1a"><msub id="S2.SS3.p3.11.m11.1.1" xref="S2.SS3.p3.11.m11.1.1.cmml"><mi id="S2.SS3.p3.11.m11.1.1.2" xref="S2.SS3.p3.11.m11.1.1.2.cmml">𝑺</mi><mrow id="S2.SS3.p3.11.m11.1.1.3" xref="S2.SS3.p3.11.m11.1.1.3.cmml"><mi id="S2.SS3.p3.11.m11.1.1.3.2" xref="S2.SS3.p3.11.m11.1.1.3.2.cmml">i</mi><mo id="S2.SS3.p3.11.m11.1.1.3.1" xref="S2.SS3.p3.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p3.11.m11.1.1.3.3" xref="S2.SS3.p3.11.m11.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.11.m11.1b"><apply id="S2.SS3.p3.11.m11.1.1.cmml" xref="S2.SS3.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.11.m11.1.1.1.cmml" xref="S2.SS3.p3.11.m11.1.1">subscript</csymbol><ci id="S2.SS3.p3.11.m11.1.1.2.cmml" xref="S2.SS3.p3.11.m11.1.1.2">𝑺</ci><apply id="S2.SS3.p3.11.m11.1.1.3.cmml" xref="S2.SS3.p3.11.m11.1.1.3"><times id="S2.SS3.p3.11.m11.1.1.3.1.cmml" xref="S2.SS3.p3.11.m11.1.1.3.1"></times><ci id="S2.SS3.p3.11.m11.1.1.3.2.cmml" xref="S2.SS3.p3.11.m11.1.1.3.2">𝑖</ci><ci id="S2.SS3.p3.11.m11.1.1.3.3.cmml" xref="S2.SS3.p3.11.m11.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.11.m11.1c">\bm{S}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.11.m11.1d">bold_italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> provides the same information of an auto-covariance matrix.
Incidentally, an integral transform where the kernel is the autocorrelation matrix of the input sequence <math alttext="\mathbf{x}_{\mathit{i}}" class="ltx_Math" display="inline" id="S2.SS3.p3.12.m12.1"><semantics id="S2.SS3.p3.12.m12.1a"><msub id="S2.SS3.p3.12.m12.1.1" xref="S2.SS3.p3.12.m12.1.1.cmml"><mi id="S2.SS3.p3.12.m12.1.1.2" xref="S2.SS3.p3.12.m12.1.1.2.cmml">𝐱</mi><mi id="S2.SS3.p3.12.m12.1.1.3" xref="S2.SS3.p3.12.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.12.m12.1b"><apply id="S2.SS3.p3.12.m12.1.1.cmml" xref="S2.SS3.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.12.m12.1.1.1.cmml" xref="S2.SS3.p3.12.m12.1.1">subscript</csymbol><ci id="S2.SS3.p3.12.m12.1.1.2.cmml" xref="S2.SS3.p3.12.m12.1.1.2">𝐱</ci><ci id="S2.SS3.p3.12.m12.1.1.3.cmml" xref="S2.SS3.p3.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.12.m12.1c">\mathbf{x}_{\mathit{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.12.m12.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is called a Karhunen-Loève transform <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib12" title="">12</a>]</cite>, which is closely related to the principal component analysis (PCA) technique widely used in data analysis. Unlike a Fourier transform, where the kernel is predetermined, the kernel in the Karhunen-Loève transform is data-dependent, just as in Transformers.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Inside the ‘Output Transformation’ Box: Cross-Attention Mechanism</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">Let us delve one step deeper into the Transformer architecture (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F4" title="Figure 4 ‣ 2.4 Inside the ‘Output Transformation’ Box: Cross-Attention Mechanism ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">4</span></a>). From the previous section, we know that both the encoder and decoder inputs are transformed into keys, queries, and values through linear transformations.</p>
</div>
<figure class="ltx_figure" id="S2.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="298" id="S2.F4.g1" src="extracted/5903850/FIGURES/Fig_cross_attention.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S2.F4.3.2" style="font-size:90%;">Self-attention and cross-attention. This figure expands on Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F3" title="Figure 3 ‣ 2.1 Understanding Transformers One Step Further: The Encoder and Decoder Architecture ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">3</span></a> by ‘opening up’ the Input Transformation and Output Generation boxes to show the self-attention mechanism inside the encoder and decoder, and the cross-attention mechanism inside the decoder. Self-attention helps capture dependencies within the input, while cross-attention allows the decoder to focus on relevant parts of the encoder’s output.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.3">These are then processed by the self-attention layers to produce attention outputs. In the cross-attention mechanism within the decoder, the keys and values are derived from the encoder’s output, while the queries come from the decoder’s self-attention outputs.
This means that the decoder attends to the encoder’s outputs, allowing it to incorporate information from the entire input sequence while generating each output token.
Mathematically, cross-attention works in the same way of self-attention (<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.E1" title="In Compute Attention Scores ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">1</span></a> to <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.E3" title="In Compute Attention Output ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">3</span></a>) with the difference that now <math alttext="\bm{Q}" class="ltx_Math" display="inline" id="S2.SS4.p2.1.m1.1"><semantics id="S2.SS4.p2.1.m1.1a"><mi id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml">𝑸</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><ci id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">𝑸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">\bm{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.1d">bold_italic_Q</annotation></semantics></math> comes from the decoder while <math alttext="\bm{K}" class="ltx_Math" display="inline" id="S2.SS4.p2.2.m2.1"><semantics id="S2.SS4.p2.2.m2.1a"><mi id="S2.SS4.p2.2.m2.1.1" xref="S2.SS4.p2.2.m2.1.1.cmml">𝑲</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.2.m2.1b"><ci id="S2.SS4.p2.2.m2.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1">𝑲</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.2.m2.1c">\bm{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.2.m2.1d">bold_italic_K</annotation></semantics></math> and <math alttext="\bm{V}" class="ltx_Math" display="inline" id="S2.SS4.p2.3.m3.1"><semantics id="S2.SS4.p2.3.m3.1a"><mi id="S2.SS4.p2.3.m3.1.1" xref="S2.SS4.p2.3.m3.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.3.m3.1b"><ci id="S2.SS4.p2.3.m3.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.3.m3.1c">\bm{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.3.m3.1d">bold_italic_V</annotation></semantics></math> from the encoder.</p>
</div>
<div class="ltx_para" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F4" title="Figure 4 ‣ 2.4 Inside the ‘Output Transformation’ Box: Cross-Attention Mechanism ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">4</span></a> also shows the presence of Feed Forward Neural Networks (FFNNs) after the self-attention layer. These FFNNs are crucial for the functioning of the Transformer as they introduce non-linearity and increase the model’s capacity by adding more trainable parameters.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>The Engineering Perspective: Cross-Attention Mechanism</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.1">In line with our previous analogy to the Fourier transform, we can see the cross-attention mechanism as a specialized transformation that utilizes the interactions between two different sets of representations, just as self-attention does with one set. In fact, self-attention captures relationships within the same set of inputs, while cross-attention combines information from the encoder’s output with the decoder’s queries.</p>
</div>
<div class="ltx_para" id="S2.SS5.p2">
<p class="ltx_p" id="S2.SS5.p2.1">While self-attention can be viewed as a form of auto-correlation, identifying relationships within the same input sequence, cross-attention operates more like a cross-correlation. In this context, the kernel used in cross-attention reflects the dependencies between the output of the encoder (serving as keys and values) and the intermediate representations in the decoder (serving as queries).</p>
</div>
<div class="ltx_para" id="S2.SS5.p3">
<p class="ltx_p" id="S2.SS5.p3.1">To draw an engineering analogy, think of the encoder’s output as a complex signal that has been transformed into a frequency domain representation. The decoder’s queries then act as a set of filters that selectively extract and recombine specific frequency components from this signal to reconstruct the desired output sequence. This process is similar to how engineers might use cross-correlation techniques in signal processing to compare and align different signals for analysis or reconstruction.</p>
</div>
<div class="ltx_para" id="S2.SS5.p4">
<p class="ltx_p" id="S2.SS5.p4.2">Mathematically, the continuous cross-correlation of two continuous functions <math alttext="f" class="ltx_Math" display="inline" id="S2.SS5.p4.1.m1.1"><semantics id="S2.SS5.p4.1.m1.1a"><mi id="S2.SS5.p4.1.m1.1.1" xref="S2.SS5.p4.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p4.1.m1.1b"><ci id="S2.SS5.p4.1.m1.1.1.cmml" xref="S2.SS5.p4.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p4.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p4.1.m1.1d">italic_f</annotation></semantics></math> and <math alttext="g" class="ltx_Math" display="inline" id="S2.SS5.p4.2.m2.1"><semantics id="S2.SS5.p4.2.m2.1a"><mi id="S2.SS5.p4.2.m2.1.1" xref="S2.SS5.p4.2.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p4.2.m2.1b"><ci id="S2.SS5.p4.2.m2.1.1.cmml" xref="S2.SS5.p4.2.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p4.2.m2.1c">g</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p4.2.m2.1d">italic_g</annotation></semantics></math> is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="(f\star g)(t)=\int_{-\infty}^{\infty}f(\tau)g(\tau+t)\,d\tau" class="ltx_Math" display="block" id="S2.E5.m1.4"><semantics id="S2.E5.m1.4a"><mrow id="S2.E5.m1.4.4" xref="S2.E5.m1.4.4.cmml"><mrow id="S2.E5.m1.3.3.1" xref="S2.E5.m1.3.3.1.cmml"><mrow id="S2.E5.m1.3.3.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.cmml"><mo id="S2.E5.m1.3.3.1.1.1.2" stretchy="false" xref="S2.E5.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.3.3.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.2.cmml">f</mi><mo id="S2.E5.m1.3.3.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E5.m1.3.3.1.1.1.1.1.cmml">⋆</mo><mi id="S2.E5.m1.3.3.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.1.3.cmml">g</mi></mrow><mo id="S2.E5.m1.3.3.1.1.1.3" stretchy="false" xref="S2.E5.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.3.3.1.2" xref="S2.E5.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.1.3.2" xref="S2.E5.m1.3.3.1.cmml"><mo id="S2.E5.m1.3.3.1.3.2.1" stretchy="false" xref="S2.E5.m1.3.3.1.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">t</mi><mo id="S2.E5.m1.3.3.1.3.2.2" stretchy="false" xref="S2.E5.m1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.4.4.3" rspace="0.111em" xref="S2.E5.m1.4.4.3.cmml">=</mo><mrow id="S2.E5.m1.4.4.2" xref="S2.E5.m1.4.4.2.cmml"><msubsup id="S2.E5.m1.4.4.2.2" xref="S2.E5.m1.4.4.2.2.cmml"><mo id="S2.E5.m1.4.4.2.2.2.2" xref="S2.E5.m1.4.4.2.2.2.2.cmml">∫</mo><mrow id="S2.E5.m1.4.4.2.2.2.3" xref="S2.E5.m1.4.4.2.2.2.3.cmml"><mo id="S2.E5.m1.4.4.2.2.2.3a" xref="S2.E5.m1.4.4.2.2.2.3.cmml">−</mo><mi id="S2.E5.m1.4.4.2.2.2.3.2" mathvariant="normal" xref="S2.E5.m1.4.4.2.2.2.3.2.cmml">∞</mi></mrow><mi id="S2.E5.m1.4.4.2.2.3" mathvariant="normal" xref="S2.E5.m1.4.4.2.2.3.cmml">∞</mi></msubsup><mrow id="S2.E5.m1.4.4.2.1" xref="S2.E5.m1.4.4.2.1.cmml"><mi id="S2.E5.m1.4.4.2.1.3" xref="S2.E5.m1.4.4.2.1.3.cmml">f</mi><mo id="S2.E5.m1.4.4.2.1.2" xref="S2.E5.m1.4.4.2.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.2.1.4.2" xref="S2.E5.m1.4.4.2.1.cmml"><mo id="S2.E5.m1.4.4.2.1.4.2.1" stretchy="false" xref="S2.E5.m1.4.4.2.1.cmml">(</mo><mi id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml">τ</mi><mo id="S2.E5.m1.4.4.2.1.4.2.2" stretchy="false" xref="S2.E5.m1.4.4.2.1.cmml">)</mo></mrow><mo id="S2.E5.m1.4.4.2.1.2a" xref="S2.E5.m1.4.4.2.1.2.cmml">⁢</mo><mi id="S2.E5.m1.4.4.2.1.5" xref="S2.E5.m1.4.4.2.1.5.cmml">g</mi><mo id="S2.E5.m1.4.4.2.1.2b" xref="S2.E5.m1.4.4.2.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.2.1.1.1" xref="S2.E5.m1.4.4.2.1.1.1.1.cmml"><mo id="S2.E5.m1.4.4.2.1.1.1.2" stretchy="false" xref="S2.E5.m1.4.4.2.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.4.4.2.1.1.1.1" xref="S2.E5.m1.4.4.2.1.1.1.1.cmml"><mi id="S2.E5.m1.4.4.2.1.1.1.1.2" xref="S2.E5.m1.4.4.2.1.1.1.1.2.cmml">τ</mi><mo id="S2.E5.m1.4.4.2.1.1.1.1.1" xref="S2.E5.m1.4.4.2.1.1.1.1.1.cmml">+</mo><mi id="S2.E5.m1.4.4.2.1.1.1.1.3" xref="S2.E5.m1.4.4.2.1.1.1.1.3.cmml">t</mi></mrow><mo id="S2.E5.m1.4.4.2.1.1.1.3" stretchy="false" xref="S2.E5.m1.4.4.2.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.4.4.2.1.2c" lspace="0.170em" xref="S2.E5.m1.4.4.2.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.2.1.6" xref="S2.E5.m1.4.4.2.1.6.cmml"><mo id="S2.E5.m1.4.4.2.1.6.1" rspace="0em" xref="S2.E5.m1.4.4.2.1.6.1.cmml">𝑑</mo><mi id="S2.E5.m1.4.4.2.1.6.2" xref="S2.E5.m1.4.4.2.1.6.2.cmml">τ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.4b"><apply id="S2.E5.m1.4.4.cmml" xref="S2.E5.m1.4.4"><eq id="S2.E5.m1.4.4.3.cmml" xref="S2.E5.m1.4.4.3"></eq><apply id="S2.E5.m1.3.3.1.cmml" xref="S2.E5.m1.3.3.1"><times id="S2.E5.m1.3.3.1.2.cmml" xref="S2.E5.m1.3.3.1.2"></times><apply id="S2.E5.m1.3.3.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1"><ci id="S2.E5.m1.3.3.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1">⋆</ci><ci id="S2.E5.m1.3.3.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.2">𝑓</ci><ci id="S2.E5.m1.3.3.1.1.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.3">𝑔</ci></apply><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝑡</ci></apply><apply id="S2.E5.m1.4.4.2.cmml" xref="S2.E5.m1.4.4.2"><apply id="S2.E5.m1.4.4.2.2.cmml" xref="S2.E5.m1.4.4.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.2.2.1.cmml" xref="S2.E5.m1.4.4.2.2">superscript</csymbol><apply id="S2.E5.m1.4.4.2.2.2.cmml" xref="S2.E5.m1.4.4.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.2.2.2.1.cmml" xref="S2.E5.m1.4.4.2.2">subscript</csymbol><int id="S2.E5.m1.4.4.2.2.2.2.cmml" xref="S2.E5.m1.4.4.2.2.2.2"></int><apply id="S2.E5.m1.4.4.2.2.2.3.cmml" xref="S2.E5.m1.4.4.2.2.2.3"><minus id="S2.E5.m1.4.4.2.2.2.3.1.cmml" xref="S2.E5.m1.4.4.2.2.2.3"></minus><infinity id="S2.E5.m1.4.4.2.2.2.3.2.cmml" xref="S2.E5.m1.4.4.2.2.2.3.2"></infinity></apply></apply><infinity id="S2.E5.m1.4.4.2.2.3.cmml" xref="S2.E5.m1.4.4.2.2.3"></infinity></apply><apply id="S2.E5.m1.4.4.2.1.cmml" xref="S2.E5.m1.4.4.2.1"><times id="S2.E5.m1.4.4.2.1.2.cmml" xref="S2.E5.m1.4.4.2.1.2"></times><ci id="S2.E5.m1.4.4.2.1.3.cmml" xref="S2.E5.m1.4.4.2.1.3">𝑓</ci><ci id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2">𝜏</ci><ci id="S2.E5.m1.4.4.2.1.5.cmml" xref="S2.E5.m1.4.4.2.1.5">𝑔</ci><apply id="S2.E5.m1.4.4.2.1.1.1.1.cmml" xref="S2.E5.m1.4.4.2.1.1.1"><plus id="S2.E5.m1.4.4.2.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.2.1.1.1.1.1"></plus><ci id="S2.E5.m1.4.4.2.1.1.1.1.2.cmml" xref="S2.E5.m1.4.4.2.1.1.1.1.2">𝜏</ci><ci id="S2.E5.m1.4.4.2.1.1.1.1.3.cmml" xref="S2.E5.m1.4.4.2.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E5.m1.4.4.2.1.6.cmml" xref="S2.E5.m1.4.4.2.1.6"><csymbol cd="latexml" id="S2.E5.m1.4.4.2.1.6.1.cmml" xref="S2.E5.m1.4.4.2.1.6.1">differential-d</csymbol><ci id="S2.E5.m1.4.4.2.1.6.2.cmml" xref="S2.E5.m1.4.4.2.1.6.2">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.4c">(f\star g)(t)=\int_{-\infty}^{\infty}f(\tau)g(\tau+t)\,d\tau</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.4d">( italic_f ⋆ italic_g ) ( italic_t ) = ∫ start_POSTSUBSCRIPT - ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_f ( italic_τ ) italic_g ( italic_τ + italic_t ) italic_d italic_τ</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS5.p5">
<p class="ltx_p" id="S2.SS5.p5.2">In practice, for discrete signals, the cross-correlation is often computed over a finite range:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="(f\star g)[n]=\sum_{m=0}^{N-1}f[m]\cdot g[m+n]" class="ltx_Math" display="block" id="S2.E6.m1.4"><semantics id="S2.E6.m1.4a"><mrow id="S2.E6.m1.4.4" xref="S2.E6.m1.4.4.cmml"><mrow id="S2.E6.m1.3.3.1" xref="S2.E6.m1.3.3.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.cmml"><mo id="S2.E6.m1.3.3.1.1.1.2" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.3.3.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.2.cmml">f</mi><mo id="S2.E6.m1.3.3.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E6.m1.3.3.1.1.1.1.1.cmml">⋆</mo><mi id="S2.E6.m1.3.3.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.3.cmml">g</mi></mrow><mo id="S2.E6.m1.3.3.1.1.1.3" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E6.m1.3.3.1.2" xref="S2.E6.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.E6.m1.3.3.1.3.2" xref="S2.E6.m1.3.3.1.3.1.cmml"><mo id="S2.E6.m1.3.3.1.3.2.1" stretchy="false" xref="S2.E6.m1.3.3.1.3.1.1.cmml">[</mo><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">n</mi><mo id="S2.E6.m1.3.3.1.3.2.2" stretchy="false" xref="S2.E6.m1.3.3.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E6.m1.4.4.3" rspace="0.111em" xref="S2.E6.m1.4.4.3.cmml">=</mo><mrow id="S2.E6.m1.4.4.2" xref="S2.E6.m1.4.4.2.cmml"><munderover id="S2.E6.m1.4.4.2.2" xref="S2.E6.m1.4.4.2.2.cmml"><mo id="S2.E6.m1.4.4.2.2.2.2" movablelimits="false" xref="S2.E6.m1.4.4.2.2.2.2.cmml">∑</mo><mrow id="S2.E6.m1.4.4.2.2.2.3" xref="S2.E6.m1.4.4.2.2.2.3.cmml"><mi id="S2.E6.m1.4.4.2.2.2.3.2" xref="S2.E6.m1.4.4.2.2.2.3.2.cmml">m</mi><mo id="S2.E6.m1.4.4.2.2.2.3.1" xref="S2.E6.m1.4.4.2.2.2.3.1.cmml">=</mo><mn id="S2.E6.m1.4.4.2.2.2.3.3" xref="S2.E6.m1.4.4.2.2.2.3.3.cmml">0</mn></mrow><mrow id="S2.E6.m1.4.4.2.2.3" xref="S2.E6.m1.4.4.2.2.3.cmml"><mi id="S2.E6.m1.4.4.2.2.3.2" xref="S2.E6.m1.4.4.2.2.3.2.cmml">N</mi><mo id="S2.E6.m1.4.4.2.2.3.1" xref="S2.E6.m1.4.4.2.2.3.1.cmml">−</mo><mn id="S2.E6.m1.4.4.2.2.3.3" xref="S2.E6.m1.4.4.2.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S2.E6.m1.4.4.2.1" xref="S2.E6.m1.4.4.2.1.cmml"><mrow id="S2.E6.m1.4.4.2.1.3" xref="S2.E6.m1.4.4.2.1.3.cmml"><mrow id="S2.E6.m1.4.4.2.1.3.2" xref="S2.E6.m1.4.4.2.1.3.2.cmml"><mi id="S2.E6.m1.4.4.2.1.3.2.2" xref="S2.E6.m1.4.4.2.1.3.2.2.cmml">f</mi><mo id="S2.E6.m1.4.4.2.1.3.2.1" xref="S2.E6.m1.4.4.2.1.3.2.1.cmml">⁢</mo><mrow id="S2.E6.m1.4.4.2.1.3.2.3.2" xref="S2.E6.m1.4.4.2.1.3.2.3.1.cmml"><mo id="S2.E6.m1.4.4.2.1.3.2.3.2.1" stretchy="false" xref="S2.E6.m1.4.4.2.1.3.2.3.1.1.cmml">[</mo><mi id="S2.E6.m1.2.2" xref="S2.E6.m1.2.2.cmml">m</mi><mo id="S2.E6.m1.4.4.2.1.3.2.3.2.2" rspace="0.055em" stretchy="false" xref="S2.E6.m1.4.4.2.1.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E6.m1.4.4.2.1.3.1" rspace="0.222em" xref="S2.E6.m1.4.4.2.1.3.1.cmml">⋅</mo><mi id="S2.E6.m1.4.4.2.1.3.3" xref="S2.E6.m1.4.4.2.1.3.3.cmml">g</mi></mrow><mo id="S2.E6.m1.4.4.2.1.2" xref="S2.E6.m1.4.4.2.1.2.cmml">⁢</mo><mrow id="S2.E6.m1.4.4.2.1.1.1" xref="S2.E6.m1.4.4.2.1.1.2.cmml"><mo id="S2.E6.m1.4.4.2.1.1.1.2" stretchy="false" xref="S2.E6.m1.4.4.2.1.1.2.1.cmml">[</mo><mrow id="S2.E6.m1.4.4.2.1.1.1.1" xref="S2.E6.m1.4.4.2.1.1.1.1.cmml"><mi id="S2.E6.m1.4.4.2.1.1.1.1.2" xref="S2.E6.m1.4.4.2.1.1.1.1.2.cmml">m</mi><mo id="S2.E6.m1.4.4.2.1.1.1.1.1" xref="S2.E6.m1.4.4.2.1.1.1.1.1.cmml">+</mo><mi id="S2.E6.m1.4.4.2.1.1.1.1.3" xref="S2.E6.m1.4.4.2.1.1.1.1.3.cmml">n</mi></mrow><mo id="S2.E6.m1.4.4.2.1.1.1.3" stretchy="false" xref="S2.E6.m1.4.4.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.4b"><apply id="S2.E6.m1.4.4.cmml" xref="S2.E6.m1.4.4"><eq id="S2.E6.m1.4.4.3.cmml" xref="S2.E6.m1.4.4.3"></eq><apply id="S2.E6.m1.3.3.1.cmml" xref="S2.E6.m1.3.3.1"><times id="S2.E6.m1.3.3.1.2.cmml" xref="S2.E6.m1.3.3.1.2"></times><apply id="S2.E6.m1.3.3.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1"><ci id="S2.E6.m1.3.3.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1">⋆</ci><ci id="S2.E6.m1.3.3.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.2">𝑓</ci><ci id="S2.E6.m1.3.3.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3">𝑔</ci></apply><apply id="S2.E6.m1.3.3.1.3.1.cmml" xref="S2.E6.m1.3.3.1.3.2"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.3.1.1.cmml" xref="S2.E6.m1.3.3.1.3.2.1">delimited-[]</csymbol><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝑛</ci></apply></apply><apply id="S2.E6.m1.4.4.2.cmml" xref="S2.E6.m1.4.4.2"><apply id="S2.E6.m1.4.4.2.2.cmml" xref="S2.E6.m1.4.4.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.2.2.1.cmml" xref="S2.E6.m1.4.4.2.2">superscript</csymbol><apply id="S2.E6.m1.4.4.2.2.2.cmml" xref="S2.E6.m1.4.4.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.2.2.2.1.cmml" xref="S2.E6.m1.4.4.2.2">subscript</csymbol><sum id="S2.E6.m1.4.4.2.2.2.2.cmml" xref="S2.E6.m1.4.4.2.2.2.2"></sum><apply id="S2.E6.m1.4.4.2.2.2.3.cmml" xref="S2.E6.m1.4.4.2.2.2.3"><eq id="S2.E6.m1.4.4.2.2.2.3.1.cmml" xref="S2.E6.m1.4.4.2.2.2.3.1"></eq><ci id="S2.E6.m1.4.4.2.2.2.3.2.cmml" xref="S2.E6.m1.4.4.2.2.2.3.2">𝑚</ci><cn id="S2.E6.m1.4.4.2.2.2.3.3.cmml" type="integer" xref="S2.E6.m1.4.4.2.2.2.3.3">0</cn></apply></apply><apply id="S2.E6.m1.4.4.2.2.3.cmml" xref="S2.E6.m1.4.4.2.2.3"><minus id="S2.E6.m1.4.4.2.2.3.1.cmml" xref="S2.E6.m1.4.4.2.2.3.1"></minus><ci id="S2.E6.m1.4.4.2.2.3.2.cmml" xref="S2.E6.m1.4.4.2.2.3.2">𝑁</ci><cn id="S2.E6.m1.4.4.2.2.3.3.cmml" type="integer" xref="S2.E6.m1.4.4.2.2.3.3">1</cn></apply></apply><apply id="S2.E6.m1.4.4.2.1.cmml" xref="S2.E6.m1.4.4.2.1"><times id="S2.E6.m1.4.4.2.1.2.cmml" xref="S2.E6.m1.4.4.2.1.2"></times><apply id="S2.E6.m1.4.4.2.1.3.cmml" xref="S2.E6.m1.4.4.2.1.3"><ci id="S2.E6.m1.4.4.2.1.3.1.cmml" xref="S2.E6.m1.4.4.2.1.3.1">⋅</ci><apply id="S2.E6.m1.4.4.2.1.3.2.cmml" xref="S2.E6.m1.4.4.2.1.3.2"><times id="S2.E6.m1.4.4.2.1.3.2.1.cmml" xref="S2.E6.m1.4.4.2.1.3.2.1"></times><ci id="S2.E6.m1.4.4.2.1.3.2.2.cmml" xref="S2.E6.m1.4.4.2.1.3.2.2">𝑓</ci><apply id="S2.E6.m1.4.4.2.1.3.2.3.1.cmml" xref="S2.E6.m1.4.4.2.1.3.2.3.2"><csymbol cd="latexml" id="S2.E6.m1.4.4.2.1.3.2.3.1.1.cmml" xref="S2.E6.m1.4.4.2.1.3.2.3.2.1">delimited-[]</csymbol><ci id="S2.E6.m1.2.2.cmml" xref="S2.E6.m1.2.2">𝑚</ci></apply></apply><ci id="S2.E6.m1.4.4.2.1.3.3.cmml" xref="S2.E6.m1.4.4.2.1.3.3">𝑔</ci></apply><apply id="S2.E6.m1.4.4.2.1.1.2.cmml" xref="S2.E6.m1.4.4.2.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.4.4.2.1.1.2.1.cmml" xref="S2.E6.m1.4.4.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E6.m1.4.4.2.1.1.1.1.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1"><plus id="S2.E6.m1.4.4.2.1.1.1.1.1.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.1"></plus><ci id="S2.E6.m1.4.4.2.1.1.1.1.2.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.2">𝑚</ci><ci id="S2.E6.m1.4.4.2.1.1.1.1.3.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.4c">(f\star g)[n]=\sum_{m=0}^{N-1}f[m]\cdot g[m+n]</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.4d">( italic_f ⋆ italic_g ) [ italic_n ] = ∑ start_POSTSUBSCRIPT italic_m = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT italic_f [ italic_m ] ⋅ italic_g [ italic_m + italic_n ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.p5.1">where <math alttext="N" class="ltx_Math" display="inline" id="S2.SS5.p5.1.m1.1"><semantics id="S2.SS5.p5.1.m1.1a"><mi id="S2.SS5.p5.1.m1.1.1" xref="S2.SS5.p5.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p5.1.m1.1b"><ci id="S2.SS5.p5.1.m1.1.1.cmml" xref="S2.SS5.p5.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p5.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p5.1.m1.1d">italic_N</annotation></semantics></math> is the length of the signals.</p>
</div>
<div class="ltx_para" id="S2.SS5.p6">
<p class="ltx_p" id="S2.SS5.p6.1">Cross-correlation is used to measure the similarity between two signals as a function of the time-lag applied to one of them. For instance, in radar signal processing, cross-correlation helps detect the presence of a target by comparing the received signal with a known transmitted signal. The peak in the cross-correlation function indicates the time delay at which the signals best align, revealing the target’s location.</p>
</div>
<div class="ltx_para" id="S2.SS5.p7">
<p class="ltx_p" id="S2.SS5.p7.1">Applying this analogy to Transformers, consider the encoder’s output as the reference signal and the decoder’s queries as the signal being shifted. Cross-attention computes how much each part of the encoder’s output (keys and values) should influence the current part of the decoder’s output (queries). The resulting attention weights indicate the degree of relevance or similarity, guiding the integration of information from the encoder to the decoder.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.6 </span>Multi-Headed Attention</h3>
<div class="ltx_para" id="S2.SS6.p1">
<p class="ltx_p" id="S2.SS6.p1.1">In the previous sections, we discussed the self-attention mechanism and its analogy to integral transforms, such as the Fourier transform. We saw how a single self-attention layer can transform an input sequence into a set of weighted representations. Now, we will introduce the concept of multi-headed attention, which can be understood as performing multiple, parallel transformations on the input data, each potentially capturing different aspects of the underlying structure.</p>
</div>
<div class="ltx_para" id="S2.SS6.p2">
<p class="ltx_p" id="S2.SS6.p2.1">Multi-headed attention can be thought of as performing several distinct Fourier-like transforms on the input data, each one with a different kernel learned from the data during the training process. Each head in multi-headed attention applies its own set of linear transformations to the input sequence, generating unique sets of keys, queries, and values. This results in different attention outputs for each head, enabling the model to capture a richer set of relationships in the data.</p>
</div>
<div class="ltx_para" id="S2.SS6.p3">
<p class="ltx_p" id="S2.SS6.p3.1">For example, one head might capture short-term dependencies in the data, analogous to detecting high-frequency components in a Fourier transform, while another might focus on long-term dependencies, similar to identifying low-frequency components. However, this comparison to the Fourier transform is just a simplification to help engineers understand the concept. In reality, each head is likely to capture more complex and nuanced patterns that are not easily interpreted through this simple analogy.</p>
</div>
<div class="ltx_para" id="S2.SS6.p4">
<p class="ltx_p" id="S2.SS6.p4.1">The outputs from the different heads are combined to produce the final representation. This is typically done in the following sequential steps:</p>
<ol class="ltx_enumerate" id="S2.I3">
<li class="ltx_item" id="S2.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I3.i1.p1">
<p class="ltx_p" id="S2.I3.i1.p1.3"><span class="ltx_text ltx_font_bold" id="S2.I3.i1.p1.3.1">Concatenation</span>: The output vectors from all heads are concatenated along the feature dimension. If there are <math alttext="h" class="ltx_Math" display="inline" id="S2.I3.i1.p1.1.m1.1"><semantics id="S2.I3.i1.p1.1.m1.1a"><mi id="S2.I3.i1.p1.1.m1.1.1" xref="S2.I3.i1.p1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.I3.i1.p1.1.m1.1b"><ci id="S2.I3.i1.p1.1.m1.1.1.cmml" xref="S2.I3.i1.p1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I3.i1.p1.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.I3.i1.p1.1.m1.1d">italic_h</annotation></semantics></math> heads and each head produces an output of dimension <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S2.I3.i1.p1.2.m2.1"><semantics id="S2.I3.i1.p1.2.m2.1a"><msup id="S2.I3.i1.p1.2.m2.1.1" xref="S2.I3.i1.p1.2.m2.1.1.cmml"><mi id="S2.I3.i1.p1.2.m2.1.1.2" xref="S2.I3.i1.p1.2.m2.1.1.2.cmml">d</mi><mo id="S2.I3.i1.p1.2.m2.1.1.3" xref="S2.I3.i1.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.I3.i1.p1.2.m2.1b"><apply id="S2.I3.i1.p1.2.m2.1.1.cmml" xref="S2.I3.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I3.i1.p1.2.m2.1.1.1.cmml" xref="S2.I3.i1.p1.2.m2.1.1">superscript</csymbol><ci id="S2.I3.i1.p1.2.m2.1.1.2.cmml" xref="S2.I3.i1.p1.2.m2.1.1.2">𝑑</ci><ci id="S2.I3.i1.p1.2.m2.1.1.3.cmml" xref="S2.I3.i1.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I3.i1.p1.2.m2.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.I3.i1.p1.2.m2.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, the concatenated output will have a dimension of <math alttext="h\times d^{\prime}" class="ltx_Math" display="inline" id="S2.I3.i1.p1.3.m3.1"><semantics id="S2.I3.i1.p1.3.m3.1a"><mrow id="S2.I3.i1.p1.3.m3.1.1" xref="S2.I3.i1.p1.3.m3.1.1.cmml"><mi id="S2.I3.i1.p1.3.m3.1.1.2" xref="S2.I3.i1.p1.3.m3.1.1.2.cmml">h</mi><mo id="S2.I3.i1.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.I3.i1.p1.3.m3.1.1.1.cmml">×</mo><msup id="S2.I3.i1.p1.3.m3.1.1.3" xref="S2.I3.i1.p1.3.m3.1.1.3.cmml"><mi id="S2.I3.i1.p1.3.m3.1.1.3.2" xref="S2.I3.i1.p1.3.m3.1.1.3.2.cmml">d</mi><mo id="S2.I3.i1.p1.3.m3.1.1.3.3" xref="S2.I3.i1.p1.3.m3.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.I3.i1.p1.3.m3.1b"><apply id="S2.I3.i1.p1.3.m3.1.1.cmml" xref="S2.I3.i1.p1.3.m3.1.1"><times id="S2.I3.i1.p1.3.m3.1.1.1.cmml" xref="S2.I3.i1.p1.3.m3.1.1.1"></times><ci id="S2.I3.i1.p1.3.m3.1.1.2.cmml" xref="S2.I3.i1.p1.3.m3.1.1.2">ℎ</ci><apply id="S2.I3.i1.p1.3.m3.1.1.3.cmml" xref="S2.I3.i1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.I3.i1.p1.3.m3.1.1.3.1.cmml" xref="S2.I3.i1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S2.I3.i1.p1.3.m3.1.1.3.2.cmml" xref="S2.I3.i1.p1.3.m3.1.1.3.2">𝑑</ci><ci id="S2.I3.i1.p1.3.m3.1.1.3.3.cmml" xref="S2.I3.i1.p1.3.m3.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I3.i1.p1.3.m3.1c">h\times d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.I3.i1.p1.3.m3.1d">italic_h × italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I3.i2.p1">
<p class="ltx_p" id="S2.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I3.i2.p1.1.1">Linear Transformation</span>: The concatenated output is then linearly transformed using a weight matrix <math alttext="\bm{W}_{O}" class="ltx_Math" display="inline" id="S2.I3.i2.p1.1.m1.1"><semantics id="S2.I3.i2.p1.1.m1.1a"><msub id="S2.I3.i2.p1.1.m1.1.1" xref="S2.I3.i2.p1.1.m1.1.1.cmml"><mi id="S2.I3.i2.p1.1.m1.1.1.2" xref="S2.I3.i2.p1.1.m1.1.1.2.cmml">𝑾</mi><mi id="S2.I3.i2.p1.1.m1.1.1.3" xref="S2.I3.i2.p1.1.m1.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I3.i2.p1.1.m1.1b"><apply id="S2.I3.i2.p1.1.m1.1.1.cmml" xref="S2.I3.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I3.i2.p1.1.m1.1.1.1.cmml" xref="S2.I3.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I3.i2.p1.1.m1.1.1.2.cmml" xref="S2.I3.i2.p1.1.m1.1.1.2">𝑾</ci><ci id="S2.I3.i2.p1.1.m1.1.1.3.cmml" xref="S2.I3.i2.p1.1.m1.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I3.i2.p1.1.m1.1c">\bm{W}_{O}</annotation><annotation encoding="application/x-llamapun" id="S2.I3.i2.p1.1.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math> to produce the final output of the multi-headed attention layer. This step ensures that the combined output has the desired dimension for subsequent layers.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S2.SS6.p5">
<p class="ltx_p" id="S2.SS6.p5.4">Mathematically, if <math alttext="\bm{A}_{i}^{(j)}" class="ltx_Math" display="inline" id="S2.SS6.p5.1.m1.1"><semantics id="S2.SS6.p5.1.m1.1a"><msubsup id="S2.SS6.p5.1.m1.1.2" xref="S2.SS6.p5.1.m1.1.2.cmml"><mi id="S2.SS6.p5.1.m1.1.2.2.2" xref="S2.SS6.p5.1.m1.1.2.2.2.cmml">𝑨</mi><mi id="S2.SS6.p5.1.m1.1.2.2.3" xref="S2.SS6.p5.1.m1.1.2.2.3.cmml">i</mi><mrow id="S2.SS6.p5.1.m1.1.1.1.3" xref="S2.SS6.p5.1.m1.1.2.cmml"><mo id="S2.SS6.p5.1.m1.1.1.1.3.1" stretchy="false" xref="S2.SS6.p5.1.m1.1.2.cmml">(</mo><mi id="S2.SS6.p5.1.m1.1.1.1.1" xref="S2.SS6.p5.1.m1.1.1.1.1.cmml">j</mi><mo id="S2.SS6.p5.1.m1.1.1.1.3.2" stretchy="false" xref="S2.SS6.p5.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS6.p5.1.m1.1b"><apply id="S2.SS6.p5.1.m1.1.2.cmml" xref="S2.SS6.p5.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS6.p5.1.m1.1.2.1.cmml" xref="S2.SS6.p5.1.m1.1.2">superscript</csymbol><apply id="S2.SS6.p5.1.m1.1.2.2.cmml" xref="S2.SS6.p5.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS6.p5.1.m1.1.2.2.1.cmml" xref="S2.SS6.p5.1.m1.1.2">subscript</csymbol><ci id="S2.SS6.p5.1.m1.1.2.2.2.cmml" xref="S2.SS6.p5.1.m1.1.2.2.2">𝑨</ci><ci id="S2.SS6.p5.1.m1.1.2.2.3.cmml" xref="S2.SS6.p5.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.SS6.p5.1.m1.1.1.1.1.cmml" xref="S2.SS6.p5.1.m1.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p5.1.m1.1c">\bm{A}_{i}^{(j)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p5.1.m1.1d">bold_italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the output of the <math alttext="j" class="ltx_Math" display="inline" id="S2.SS6.p5.2.m2.1"><semantics id="S2.SS6.p5.2.m2.1a"><mi id="S2.SS6.p5.2.m2.1.1" xref="S2.SS6.p5.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p5.2.m2.1b"><ci id="S2.SS6.p5.2.m2.1.1.cmml" xref="S2.SS6.p5.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p5.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p5.2.m2.1d">italic_j</annotation></semantics></math>-th head for the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS6.p5.3.m3.1"><semantics id="S2.SS6.p5.3.m3.1a"><mi id="S2.SS6.p5.3.m3.1.1" xref="S2.SS6.p5.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p5.3.m3.1b"><ci id="S2.SS6.p5.3.m3.1.1.cmml" xref="S2.SS6.p5.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p5.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p5.3.m3.1d">italic_i</annotation></semantics></math>-th input, the combined output <math alttext="\bm{A}_{i}" class="ltx_Math" display="inline" id="S2.SS6.p5.4.m4.1"><semantics id="S2.SS6.p5.4.m4.1a"><msub id="S2.SS6.p5.4.m4.1.1" xref="S2.SS6.p5.4.m4.1.1.cmml"><mi id="S2.SS6.p5.4.m4.1.1.2" xref="S2.SS6.p5.4.m4.1.1.2.cmml">𝑨</mi><mi id="S2.SS6.p5.4.m4.1.1.3" xref="S2.SS6.p5.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS6.p5.4.m4.1b"><apply id="S2.SS6.p5.4.m4.1.1.cmml" xref="S2.SS6.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS6.p5.4.m4.1.1.1.cmml" xref="S2.SS6.p5.4.m4.1.1">subscript</csymbol><ci id="S2.SS6.p5.4.m4.1.1.2.cmml" xref="S2.SS6.p5.4.m4.1.1.2">𝑨</ci><ci id="S2.SS6.p5.4.m4.1.1.3.cmml" xref="S2.SS6.p5.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p5.4.m4.1c">\bm{A}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p5.4.m4.1d">bold_italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\bm{A}_{i}=\bm{W}_{O}\left[\bm{A}_{i}^{(1)}\|\bm{A}_{i}^{(2)}\|\cdots\|\bm{A}_%
{i}^{(h)}\right]" class="ltx_Math" display="block" id="S2.E7.m1.4"><semantics id="S2.E7.m1.4a"><mrow id="S2.E7.m1.4.4" xref="S2.E7.m1.4.4.cmml"><msub id="S2.E7.m1.4.4.3" xref="S2.E7.m1.4.4.3.cmml"><mi id="S2.E7.m1.4.4.3.2" xref="S2.E7.m1.4.4.3.2.cmml">𝑨</mi><mi id="S2.E7.m1.4.4.3.3" xref="S2.E7.m1.4.4.3.3.cmml">i</mi></msub><mo id="S2.E7.m1.4.4.2" xref="S2.E7.m1.4.4.2.cmml">=</mo><mrow id="S2.E7.m1.4.4.1" xref="S2.E7.m1.4.4.1.cmml"><msub id="S2.E7.m1.4.4.1.3" xref="S2.E7.m1.4.4.1.3.cmml"><mi id="S2.E7.m1.4.4.1.3.2" xref="S2.E7.m1.4.4.1.3.2.cmml">𝑾</mi><mi id="S2.E7.m1.4.4.1.3.3" xref="S2.E7.m1.4.4.1.3.3.cmml">O</mi></msub><mo id="S2.E7.m1.4.4.1.2" xref="S2.E7.m1.4.4.1.2.cmml">⁢</mo><mrow id="S2.E7.m1.4.4.1.1.1" xref="S2.E7.m1.4.4.1.1.2.cmml"><mo id="S2.E7.m1.4.4.1.1.1.2" xref="S2.E7.m1.4.4.1.1.2.1.cmml">[</mo><mrow id="S2.E7.m1.4.4.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.cmml"><mrow id="S2.E7.m1.4.4.1.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.1.cmml"><msubsup id="S2.E7.m1.4.4.1.1.1.1.1.3" xref="S2.E7.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S2.E7.m1.4.4.1.1.1.1.1.3.2.2" xref="S2.E7.m1.4.4.1.1.1.1.1.3.2.2.cmml">𝑨</mi><mi id="S2.E7.m1.4.4.1.1.1.1.1.3.2.3" xref="S2.E7.m1.4.4.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="S2.E7.m1.1.1.1.3" xref="S2.E7.m1.4.4.1.1.1.1.1.3.cmml"><mo id="S2.E7.m1.1.1.1.3.1" stretchy="false" xref="S2.E7.m1.4.4.1.1.1.1.1.3.cmml">(</mo><mn id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml">1</mn><mo id="S2.E7.m1.1.1.1.3.2" stretchy="false" xref="S2.E7.m1.4.4.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S2.E7.m1.4.4.1.1.1.1.1.2" xref="S2.E7.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E7.m1.4.4.1.1.1.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m1.4.4.1.1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml">𝑨</mi><mi id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.2.3" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.E7.m1.2.2.1.3" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E7.m1.2.2.1.3.1" stretchy="false" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mn id="S2.E7.m1.2.2.1.1" xref="S2.E7.m1.2.2.1.1.cmml">2</mn><mo id="S2.E7.m1.2.2.1.3.2" stretchy="false" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m1.4.4.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S2.E7.m1.4.4.1.1.1.1.1.2a" xref="S2.E7.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E7.m1.4.4.1.1.1.1.1.4" mathvariant="normal" xref="S2.E7.m1.4.4.1.1.1.1.1.4.cmml">⋯</mi></mrow><mo id="S2.E7.m1.4.4.1.1.1.1.2" xref="S2.E7.m1.4.4.1.1.1.1.2.cmml">∥</mo><msubsup id="S2.E7.m1.4.4.1.1.1.1.3" xref="S2.E7.m1.4.4.1.1.1.1.3.cmml"><mi id="S2.E7.m1.4.4.1.1.1.1.3.2.2" xref="S2.E7.m1.4.4.1.1.1.1.3.2.2.cmml">𝑨</mi><mi id="S2.E7.m1.4.4.1.1.1.1.3.2.3" xref="S2.E7.m1.4.4.1.1.1.1.3.2.3.cmml">i</mi><mrow id="S2.E7.m1.3.3.1.3" xref="S2.E7.m1.4.4.1.1.1.1.3.cmml"><mo id="S2.E7.m1.3.3.1.3.1" stretchy="false" xref="S2.E7.m1.4.4.1.1.1.1.3.cmml">(</mo><mi id="S2.E7.m1.3.3.1.1" xref="S2.E7.m1.3.3.1.1.cmml">h</mi><mo id="S2.E7.m1.3.3.1.3.2" stretchy="false" xref="S2.E7.m1.4.4.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E7.m1.4.4.1.1.1.3" xref="S2.E7.m1.4.4.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.4b"><apply id="S2.E7.m1.4.4.cmml" xref="S2.E7.m1.4.4"><eq id="S2.E7.m1.4.4.2.cmml" xref="S2.E7.m1.4.4.2"></eq><apply id="S2.E7.m1.4.4.3.cmml" xref="S2.E7.m1.4.4.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.3.1.cmml" xref="S2.E7.m1.4.4.3">subscript</csymbol><ci id="S2.E7.m1.4.4.3.2.cmml" xref="S2.E7.m1.4.4.3.2">𝑨</ci><ci id="S2.E7.m1.4.4.3.3.cmml" xref="S2.E7.m1.4.4.3.3">𝑖</ci></apply><apply id="S2.E7.m1.4.4.1.cmml" xref="S2.E7.m1.4.4.1"><times id="S2.E7.m1.4.4.1.2.cmml" xref="S2.E7.m1.4.4.1.2"></times><apply id="S2.E7.m1.4.4.1.3.cmml" xref="S2.E7.m1.4.4.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.3.1.cmml" xref="S2.E7.m1.4.4.1.3">subscript</csymbol><ci id="S2.E7.m1.4.4.1.3.2.cmml" xref="S2.E7.m1.4.4.1.3.2">𝑾</ci><ci id="S2.E7.m1.4.4.1.3.3.cmml" xref="S2.E7.m1.4.4.1.3.3">𝑂</ci></apply><apply id="S2.E7.m1.4.4.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.4.4.1.1.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.2">delimited-[]</csymbol><apply id="S2.E7.m1.4.4.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.4.4.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.2">conditional</csymbol><apply id="S2.E7.m1.4.4.1.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1"><times id="S2.E7.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.2"></times><apply id="S2.E7.m1.4.4.1.1.1.1.1.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E7.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.1.3.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.1.1.3.2.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.3.2.2">𝑨</ci><ci id="S2.E7.m1.4.4.1.1.1.1.1.3.2.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.3.2.3">𝑖</ci></apply><cn id="S2.E7.m1.1.1.1.1.cmml" type="integer" xref="S2.E7.m1.1.1.1.1">1</cn></apply><apply id="S2.E7.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2">𝑨</ci><ci id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="S2.E7.m1.2.2.1.1.cmml" type="integer" xref="S2.E7.m1.2.2.1.1">2</cn></apply></apply><ci id="S2.E7.m1.4.4.1.1.1.1.1.4.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.4">⋯</ci></apply><apply id="S2.E7.m1.4.4.1.1.1.1.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3">superscript</csymbol><apply id="S2.E7.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.2.2">𝑨</ci><ci id="S2.E7.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E7.m1.3.3.1.1.cmml" xref="S2.E7.m1.3.3.1.1">ℎ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.4c">\bm{A}_{i}=\bm{W}_{O}\left[\bm{A}_{i}^{(1)}\|\bm{A}_{i}^{(2)}\|\cdots\|\bm{A}_%
{i}^{(h)}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.4d">bold_italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT [ bold_italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∥ bold_italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ∥ ⋯ ∥ bold_italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_h ) end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS6.p5.5">where <math alttext="\|" class="ltx_Math" display="inline" id="S2.SS6.p5.5.m1.1"><semantics id="S2.SS6.p5.5.m1.1a"><mo id="S2.SS6.p5.5.m1.1.1" xref="S2.SS6.p5.5.m1.1.1.cmml">∥</mo><annotation-xml encoding="MathML-Content" id="S2.SS6.p5.5.m1.1b"><ci id="S2.SS6.p5.5.m1.1.1.cmml" xref="S2.SS6.p5.5.m1.1.1">∥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p5.5.m1.1c">\|</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p5.5.m1.1d">∥</annotation></semantics></math> denotes concatenation.</p>
</div>
<div class="ltx_para" id="S2.SS6.p6">
<p class="ltx_p" id="S2.SS6.p6.1">Thus, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F4" title="Figure 4 ‣ 2.4 Inside the ‘Output Transformation’ Box: Cross-Attention Mechanism ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">4</span></a> can be further developed by substituting the self- and cross-attention blocks with multi-headed (self- and cross-attention) blocks.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.7 </span>Positional embeddings</h3>
<div class="ltx_para" id="S2.SS7.p1">
<p class="ltx_p" id="S2.SS7.p1.1">Parallel processing is a key strength of Transformers, but it also means they don’t inherently understand the concept of order. For example, the attention mechanism can’t differentiate between the sentence "I am a teacher" and its shuffled version "teacher a am I." This limitation reinforces our earlier Fourier analysis analogy. In fact, Fourier analysis breaks down a signal (like a piece of music) into its constituent frequencies (notes) without indicating when those notes are played. This tells you what notes are in the piece but not their order or timing. In signal analysis, this limitation is addressed by wavelets, which effectively add the dimension of time to the frequency analysis, making them more suitable for analyzing signals where timing and order are crucial, like music. Similarly, in Transformers, this is achieved by adding positional embeddings to the input tokens, allowing the model to capture the order of elements in a sequence. There are many different approaches that have been used to explain positional embeddings in a simple way. Here, we follow the approach of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib6" title="">6</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib5" title="">5</a>]</cite>.
<br class="ltx_break"/>A naive approach might be to simply add a positional encoding where each entry is its index number Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F5" title="Figure 5 ‣ 2.7 Positional embeddings ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">5</span></a>a. However, this solution is not ideal because it assigns higher numerical values to tokens at later positions, potentially leading to issues like exploding gradients. Therefore, positional embeddings need to be normalized. Dividing by the largest integer would rescale values in [0,1] Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F5" title="Figure 5 ‣ 2.7 Positional embeddings ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">5</span></a>b, but creates a problem with arbitrary sequence lengths: a value of 0.5 means different things in sequences of varying lengths. To address this, one could convert positions to binary, associating each position with a vector of 0s and 1s Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F5" title="Figure 5 ‣ 2.7 Positional embeddings ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">5</span></a>c. This normalizes the values, but these binary vectors are not "smooth" since they only take values of 0 or 1. Smoothness is crucial for gradient-based optimization because it ensures that small changes in input lead to small changes in output, allowing effective learning during training. To resolve this, we need a continuous version of these binary vectors.

<br class="ltx_break"/></p>
</div>
<figure class="ltx_figure" id="S2.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="233" id="S2.F5.g1" src="extracted/5903850/FIGURES/positions.png" width="150"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S2.F5.3.2" style="font-size:90%;">Ineffective methods for adding positional information to token embeddings. (a) Index-based encoding assigns a simple index to each token (e.g., 0, 1, 2, 3), which can lead to large gradients at higher positions. (b) Normalized index encoding scales positional values between 0 and 1 by dividing each index by the sequence length, but it may cause ambiguity across sequences of different lengths. (c) Binary encoding represents positions using fixed-length binary vectors, but lacks smoothness in positional transitions.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS7.p2">
<p class="ltx_p" id="S2.SS7.p2.2">As an example, let us consider a sequence of length <math alttext="l_{seq}" class="ltx_Math" display="inline" id="S2.SS7.p2.1.m1.1"><semantics id="S2.SS7.p2.1.m1.1a"><msub id="S2.SS7.p2.1.m1.1.1" xref="S2.SS7.p2.1.m1.1.1.cmml"><mi id="S2.SS7.p2.1.m1.1.1.2" xref="S2.SS7.p2.1.m1.1.1.2.cmml">l</mi><mrow id="S2.SS7.p2.1.m1.1.1.3" xref="S2.SS7.p2.1.m1.1.1.3.cmml"><mi id="S2.SS7.p2.1.m1.1.1.3.2" xref="S2.SS7.p2.1.m1.1.1.3.2.cmml">s</mi><mo id="S2.SS7.p2.1.m1.1.1.3.1" xref="S2.SS7.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS7.p2.1.m1.1.1.3.3" xref="S2.SS7.p2.1.m1.1.1.3.3.cmml">e</mi><mo id="S2.SS7.p2.1.m1.1.1.3.1a" xref="S2.SS7.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS7.p2.1.m1.1.1.3.4" xref="S2.SS7.p2.1.m1.1.1.3.4.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS7.p2.1.m1.1b"><apply id="S2.SS7.p2.1.m1.1.1.cmml" xref="S2.SS7.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS7.p2.1.m1.1.1.1.cmml" xref="S2.SS7.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS7.p2.1.m1.1.1.2.cmml" xref="S2.SS7.p2.1.m1.1.1.2">𝑙</ci><apply id="S2.SS7.p2.1.m1.1.1.3.cmml" xref="S2.SS7.p2.1.m1.1.1.3"><times id="S2.SS7.p2.1.m1.1.1.3.1.cmml" xref="S2.SS7.p2.1.m1.1.1.3.1"></times><ci id="S2.SS7.p2.1.m1.1.1.3.2.cmml" xref="S2.SS7.p2.1.m1.1.1.3.2">𝑠</ci><ci id="S2.SS7.p2.1.m1.1.1.3.3.cmml" xref="S2.SS7.p2.1.m1.1.1.3.3">𝑒</ci><ci id="S2.SS7.p2.1.m1.1.1.3.4.cmml" xref="S2.SS7.p2.1.m1.1.1.3.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p2.1.m1.1c">l_{seq}</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p2.1.m1.1d">italic_l start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT</annotation></semantics></math> = 16 tokens. Therefore, each position, denoted as <math alttext="pos" class="ltx_Math" display="inline" id="S2.SS7.p2.2.m2.1"><semantics id="S2.SS7.p2.2.m2.1a"><mrow id="S2.SS7.p2.2.m2.1.1" xref="S2.SS7.p2.2.m2.1.1.cmml"><mi id="S2.SS7.p2.2.m2.1.1.2" xref="S2.SS7.p2.2.m2.1.1.2.cmml">p</mi><mo id="S2.SS7.p2.2.m2.1.1.1" xref="S2.SS7.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS7.p2.2.m2.1.1.3" xref="S2.SS7.p2.2.m2.1.1.3.cmml">o</mi><mo id="S2.SS7.p2.2.m2.1.1.1a" xref="S2.SS7.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS7.p2.2.m2.1.1.4" xref="S2.SS7.p2.2.m2.1.1.4.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p2.2.m2.1b"><apply id="S2.SS7.p2.2.m2.1.1.cmml" xref="S2.SS7.p2.2.m2.1.1"><times id="S2.SS7.p2.2.m2.1.1.1.cmml" xref="S2.SS7.p2.2.m2.1.1.1"></times><ci id="S2.SS7.p2.2.m2.1.1.2.cmml" xref="S2.SS7.p2.2.m2.1.1.2">𝑝</ci><ci id="S2.SS7.p2.2.m2.1.1.3.cmml" xref="S2.SS7.p2.2.m2.1.1.3">𝑜</ci><ci id="S2.SS7.p2.2.m2.1.1.4.cmml" xref="S2.SS7.p2.2.m2.1.1.4">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p2.2.m2.1c">pos</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p2.2.m2.1d">italic_p italic_o italic_s</annotation></semantics></math> corresponds to a binary vector of dimension 4:</p>
<div class="ltx_logical-block" id="S2.SS7.p2.3">
<div class="ltx_para ltx_noindent ltx_align_center" id="S2.SS7.p2.3.p1">
<svg class="ltx_picture" height="285.54" id="S2.SS7.p2.3.p1.pic1" overflow="visible" version="1.1" width="150"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,285.54) matrix(1 0 0 -1 0 0)"><g fill="#CCCCCC" fill-opacity="1.0"><path d="M 0 5.91 L 0 279.64 C 0 282.9 2.64 285.54 5.91 285.54 L 144.09 285.54 C 147.36 285.54 150 282.9 150 279.64 L 150 5.91 C 150 2.64 147.36 0 144.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#E6E6E6" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 279.64 C 1.97 281.81 3.73 283.57 5.91 283.57 L 144.09 283.57 C 146.27 283.57 148.03 281.81 148.03 279.64 L 148.03 5.91 C 148.03 3.73 146.27 1.97 144.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="257.98" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="106.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1" style="width:77.1pt;">
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.1">0 : 0000</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.2">1 : 0001</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.3">2 : 0010</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.4">3 : 0011</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.5">4 : 0100</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.6">5 : 0101</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.7">6 : 0110</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.8">7 : 0111</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.9">8 : 1000</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.10">9 : 1001</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.11">10 : 1010</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.12">11 : 1011</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.13">12 : 1100</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.14">13 : 1101</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.15">14 : 1110</span>
<span class="ltx_p" id="S2.SS7.p2.3.p1.pic1.1.1.1.1.1.16">15 : 1111</span>
</span></foreignobject></g></g></svg>
</div>
</div>
</div>
<div class="ltx_para" id="S2.SS7.p3">
<p class="ltx_p" id="S2.SS7.p3.6">We denote the dimension of these binary vectors as <math alttext="d_{model}" class="ltx_Math" display="inline" id="S2.SS7.p3.1.m1.1"><semantics id="S2.SS7.p3.1.m1.1a"><msub id="S2.SS7.p3.1.m1.1.1" xref="S2.SS7.p3.1.m1.1.1.cmml"><mi id="S2.SS7.p3.1.m1.1.1.2" xref="S2.SS7.p3.1.m1.1.1.2.cmml">d</mi><mrow id="S2.SS7.p3.1.m1.1.1.3" xref="S2.SS7.p3.1.m1.1.1.3.cmml"><mi id="S2.SS7.p3.1.m1.1.1.3.2" xref="S2.SS7.p3.1.m1.1.1.3.2.cmml">m</mi><mo id="S2.SS7.p3.1.m1.1.1.3.1" xref="S2.SS7.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS7.p3.1.m1.1.1.3.3" xref="S2.SS7.p3.1.m1.1.1.3.3.cmml">o</mi><mo id="S2.SS7.p3.1.m1.1.1.3.1a" xref="S2.SS7.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS7.p3.1.m1.1.1.3.4" xref="S2.SS7.p3.1.m1.1.1.3.4.cmml">d</mi><mo id="S2.SS7.p3.1.m1.1.1.3.1b" xref="S2.SS7.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS7.p3.1.m1.1.1.3.5" xref="S2.SS7.p3.1.m1.1.1.3.5.cmml">e</mi><mo id="S2.SS7.p3.1.m1.1.1.3.1c" xref="S2.SS7.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS7.p3.1.m1.1.1.3.6" xref="S2.SS7.p3.1.m1.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.1.m1.1b"><apply id="S2.SS7.p3.1.m1.1.1.cmml" xref="S2.SS7.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS7.p3.1.m1.1.1.1.cmml" xref="S2.SS7.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS7.p3.1.m1.1.1.2.cmml" xref="S2.SS7.p3.1.m1.1.1.2">𝑑</ci><apply id="S2.SS7.p3.1.m1.1.1.3.cmml" xref="S2.SS7.p3.1.m1.1.1.3"><times id="S2.SS7.p3.1.m1.1.1.3.1.cmml" xref="S2.SS7.p3.1.m1.1.1.3.1"></times><ci id="S2.SS7.p3.1.m1.1.1.3.2.cmml" xref="S2.SS7.p3.1.m1.1.1.3.2">𝑚</ci><ci id="S2.SS7.p3.1.m1.1.1.3.3.cmml" xref="S2.SS7.p3.1.m1.1.1.3.3">𝑜</ci><ci id="S2.SS7.p3.1.m1.1.1.3.4.cmml" xref="S2.SS7.p3.1.m1.1.1.3.4">𝑑</ci><ci id="S2.SS7.p3.1.m1.1.1.3.5.cmml" xref="S2.SS7.p3.1.m1.1.1.3.5">𝑒</ci><ci id="S2.SS7.p3.1.m1.1.1.3.6.cmml" xref="S2.SS7.p3.1.m1.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.1.m1.1c">d_{model}</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, and the index within this vector as <math alttext="i" class="ltx_Math" display="inline" id="S2.SS7.p3.2.m2.1"><semantics id="S2.SS7.p3.2.m2.1a"><mi id="S2.SS7.p3.2.m2.1.1" xref="S2.SS7.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.2.m2.1b"><ci id="S2.SS7.p3.2.m2.1.1.cmml" xref="S2.SS7.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.2.m2.1d">italic_i</annotation></semantics></math>.
<br class="ltx_break"/>To develop an intuition for positional encoding, let us observe how the pattern of bits changes across columns: the least significant bit (rightmost) toggles with every increment, corresponding to a frequency of <math alttext="\frac{1}{2}" class="ltx_Math" display="inline" id="S2.SS7.p3.3.m3.1"><semantics id="S2.SS7.p3.3.m3.1a"><mfrac id="S2.SS7.p3.3.m3.1.1" xref="S2.SS7.p3.3.m3.1.1.cmml"><mn id="S2.SS7.p3.3.m3.1.1.2" xref="S2.SS7.p3.3.m3.1.1.2.cmml">1</mn><mn id="S2.SS7.p3.3.m3.1.1.3" xref="S2.SS7.p3.3.m3.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.3.m3.1b"><apply id="S2.SS7.p3.3.m3.1.1.cmml" xref="S2.SS7.p3.3.m3.1.1"><divide id="S2.SS7.p3.3.m3.1.1.1.cmml" xref="S2.SS7.p3.3.m3.1.1"></divide><cn id="S2.SS7.p3.3.m3.1.1.2.cmml" type="integer" xref="S2.SS7.p3.3.m3.1.1.2">1</cn><cn id="S2.SS7.p3.3.m3.1.1.3.cmml" type="integer" xref="S2.SS7.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.3.m3.1c">\frac{1}{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.3.m3.1d">divide start_ARG 1 end_ARG start_ARG 2 end_ARG</annotation></semantics></math>. The second bit toggles every two increments, with a frequency of <math alttext="\frac{1}{4}" class="ltx_Math" display="inline" id="S2.SS7.p3.4.m4.1"><semantics id="S2.SS7.p3.4.m4.1a"><mfrac id="S2.SS7.p3.4.m4.1.1" xref="S2.SS7.p3.4.m4.1.1.cmml"><mn id="S2.SS7.p3.4.m4.1.1.2" xref="S2.SS7.p3.4.m4.1.1.2.cmml">1</mn><mn id="S2.SS7.p3.4.m4.1.1.3" xref="S2.SS7.p3.4.m4.1.1.3.cmml">4</mn></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.4.m4.1b"><apply id="S2.SS7.p3.4.m4.1.1.cmml" xref="S2.SS7.p3.4.m4.1.1"><divide id="S2.SS7.p3.4.m4.1.1.1.cmml" xref="S2.SS7.p3.4.m4.1.1"></divide><cn id="S2.SS7.p3.4.m4.1.1.2.cmml" type="integer" xref="S2.SS7.p3.4.m4.1.1.2">1</cn><cn id="S2.SS7.p3.4.m4.1.1.3.cmml" type="integer" xref="S2.SS7.p3.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.4.m4.1c">\frac{1}{4}</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.4.m4.1d">divide start_ARG 1 end_ARG start_ARG 4 end_ARG</annotation></semantics></math>. The third bit toggles every four increments, reflecting a frequency of <math alttext="\frac{1}{8}" class="ltx_Math" display="inline" id="S2.SS7.p3.5.m5.1"><semantics id="S2.SS7.p3.5.m5.1a"><mfrac id="S2.SS7.p3.5.m5.1.1" xref="S2.SS7.p3.5.m5.1.1.cmml"><mn id="S2.SS7.p3.5.m5.1.1.2" xref="S2.SS7.p3.5.m5.1.1.2.cmml">1</mn><mn id="S2.SS7.p3.5.m5.1.1.3" xref="S2.SS7.p3.5.m5.1.1.3.cmml">8</mn></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.5.m5.1b"><apply id="S2.SS7.p3.5.m5.1.1.cmml" xref="S2.SS7.p3.5.m5.1.1"><divide id="S2.SS7.p3.5.m5.1.1.1.cmml" xref="S2.SS7.p3.5.m5.1.1"></divide><cn id="S2.SS7.p3.5.m5.1.1.2.cmml" type="integer" xref="S2.SS7.p3.5.m5.1.1.2">1</cn><cn id="S2.SS7.p3.5.m5.1.1.3.cmml" type="integer" xref="S2.SS7.p3.5.m5.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.5.m5.1c">\frac{1}{8}</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.5.m5.1d">divide start_ARG 1 end_ARG start_ARG 8 end_ARG</annotation></semantics></math>, and so forth. This pattern of different frequencies is the key to understanding positional encoding. Instead of using discrete bits, we can define positional embedding <math alttext="PE" class="ltx_Math" display="inline" id="S2.SS7.p3.6.m6.1"><semantics id="S2.SS7.p3.6.m6.1a"><mrow id="S2.SS7.p3.6.m6.1.1" xref="S2.SS7.p3.6.m6.1.1.cmml"><mi id="S2.SS7.p3.6.m6.1.1.2" xref="S2.SS7.p3.6.m6.1.1.2.cmml">P</mi><mo id="S2.SS7.p3.6.m6.1.1.1" xref="S2.SS7.p3.6.m6.1.1.1.cmml">⁢</mo><mi id="S2.SS7.p3.6.m6.1.1.3" xref="S2.SS7.p3.6.m6.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.6.m6.1b"><apply id="S2.SS7.p3.6.m6.1.1.cmml" xref="S2.SS7.p3.6.m6.1.1"><times id="S2.SS7.p3.6.m6.1.1.1.cmml" xref="S2.SS7.p3.6.m6.1.1.1"></times><ci id="S2.SS7.p3.6.m6.1.1.2.cmml" xref="S2.SS7.p3.6.m6.1.1.2">𝑃</ci><ci id="S2.SS7.p3.6.m6.1.1.3.cmml" xref="S2.SS7.p3.6.m6.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.6.m6.1c">PE</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.6.m6.1d">italic_P italic_E</annotation></semantics></math> using smoother functions, like sine and cosine functions.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="PE_{(pos,i)}=\begin{cases}\sin\left(\frac{pos}{10000^{i/d_{model}}}\right)&amp;%
\text{if }i\text{ is even}\\
\cos\left(\frac{pos}{10000^{(i-1)/d_{model}}}\right)&amp;\text{if }i\text{ is odd}%
\end{cases}" class="ltx_Math" display="block" id="S2.E8.m1.6"><semantics id="S2.E8.m1.6a"><mrow id="S2.E8.m1.6.7" xref="S2.E8.m1.6.7.cmml"><mrow id="S2.E8.m1.6.7.2" xref="S2.E8.m1.6.7.2.cmml"><mi id="S2.E8.m1.6.7.2.2" xref="S2.E8.m1.6.7.2.2.cmml">P</mi><mo id="S2.E8.m1.6.7.2.1" xref="S2.E8.m1.6.7.2.1.cmml">⁢</mo><msub id="S2.E8.m1.6.7.2.3" xref="S2.E8.m1.6.7.2.3.cmml"><mi id="S2.E8.m1.6.7.2.3.2" xref="S2.E8.m1.6.7.2.3.2.cmml">E</mi><mrow id="S2.E8.m1.6.6.2.2" xref="S2.E8.m1.6.6.2.3.cmml"><mo id="S2.E8.m1.6.6.2.2.2" stretchy="false" xref="S2.E8.m1.6.6.2.3.cmml">(</mo><mrow id="S2.E8.m1.6.6.2.2.1" xref="S2.E8.m1.6.6.2.2.1.cmml"><mi id="S2.E8.m1.6.6.2.2.1.2" xref="S2.E8.m1.6.6.2.2.1.2.cmml">p</mi><mo id="S2.E8.m1.6.6.2.2.1.1" xref="S2.E8.m1.6.6.2.2.1.1.cmml">⁢</mo><mi id="S2.E8.m1.6.6.2.2.1.3" xref="S2.E8.m1.6.6.2.2.1.3.cmml">o</mi><mo id="S2.E8.m1.6.6.2.2.1.1a" xref="S2.E8.m1.6.6.2.2.1.1.cmml">⁢</mo><mi id="S2.E8.m1.6.6.2.2.1.4" xref="S2.E8.m1.6.6.2.2.1.4.cmml">s</mi></mrow><mo id="S2.E8.m1.6.6.2.2.3" xref="S2.E8.m1.6.6.2.3.cmml">,</mo><mi id="S2.E8.m1.5.5.1.1" xref="S2.E8.m1.5.5.1.1.cmml">i</mi><mo id="S2.E8.m1.6.6.2.2.4" stretchy="false" xref="S2.E8.m1.6.6.2.3.cmml">)</mo></mrow></msub></mrow><mo id="S2.E8.m1.6.7.1" xref="S2.E8.m1.6.7.1.cmml">=</mo><mrow id="S2.E8.m1.4.4" xref="S2.E8.m1.6.7.3.1.cmml"><mo id="S2.E8.m1.4.4.5" xref="S2.E8.m1.6.7.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S2.E8.m1.4.4.4" rowspacing="0pt" xref="S2.E8.m1.6.7.3.1.cmml"><mtr id="S2.E8.m1.4.4.4a" xref="S2.E8.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E8.m1.4.4.4b" xref="S2.E8.m1.6.7.3.1.cmml"><mrow id="S2.E8.m1.1.1.1.1.1.1.4" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.cmml">sin</mi><mo id="S2.E8.m1.1.1.1.1.1.1.4a" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.4.1" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml"><mo id="S2.E8.m1.1.1.1.1.1.1.4.1.1" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml">(</mo><mstyle displaystyle="false" id="S2.E8.m1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.2.cmml"><mfrac id="S2.E8.m1.1.1.1.1.1.1.2a" xref="S2.E8.m1.1.1.1.1.1.1.2.cmml"><mrow id="S2.E8.m1.1.1.1.1.1.1.2.2" xref="S2.E8.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.2.2.2" xref="S2.E8.m1.1.1.1.1.1.1.2.2.2.cmml">p</mi><mo id="S2.E8.m1.1.1.1.1.1.1.2.2.1" xref="S2.E8.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S2.E8.m1.1.1.1.1.1.1.2.2.3" xref="S2.E8.m1.1.1.1.1.1.1.2.2.3.cmml">o</mi><mo id="S2.E8.m1.1.1.1.1.1.1.2.2.1a" xref="S2.E8.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S2.E8.m1.1.1.1.1.1.1.2.2.4" xref="S2.E8.m1.1.1.1.1.1.1.2.2.4.cmml">s</mi></mrow><msup id="S2.E8.m1.1.1.1.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.1.1.2.3.cmml"><mn id="S2.E8.m1.1.1.1.1.1.1.2.3.2" xref="S2.E8.m1.1.1.1.1.1.1.2.3.2.cmml">10000</mn><mrow id="S2.E8.m1.1.1.1.1.1.1.2.3.3" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.2.3.3.2" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.2.cmml">i</mi><mo id="S2.E8.m1.1.1.1.1.1.1.2.3.3.1" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.1.cmml">/</mo><msub id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.2" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.2.cmml">d</mi><mrow id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.2" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.2.cmml">m</mi><mo id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.1" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.3" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.3.cmml">o</mi><mo id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.1a" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.4" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.4.cmml">d</mi><mo id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.1b" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.5" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.5.cmml">e</mi><mo id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.1c" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.6" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.6.cmml">l</mi></mrow></msub></mrow></msup></mfrac></mstyle><mo id="S2.E8.m1.1.1.1.1.1.1.4.1.2" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E8.m1.4.4.4c" xref="S2.E8.m1.6.7.3.1.cmml"><mrow id="S2.E8.m1.2.2.2.2.2.1" xref="S2.E8.m1.2.2.2.2.2.1.cmml"><mtext id="S2.E8.m1.2.2.2.2.2.1.2" xref="S2.E8.m1.2.2.2.2.2.1.2a.cmml">if </mtext><mo id="S2.E8.m1.2.2.2.2.2.1.1" xref="S2.E8.m1.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S2.E8.m1.2.2.2.2.2.1.3" xref="S2.E8.m1.2.2.2.2.2.1.3.cmml">i</mi><mo id="S2.E8.m1.2.2.2.2.2.1.1a" xref="S2.E8.m1.2.2.2.2.2.1.1.cmml">⁢</mo><mtext id="S2.E8.m1.2.2.2.2.2.1.4" xref="S2.E8.m1.2.2.2.2.2.1.4a.cmml"> is even</mtext></mrow></mtd></mtr><mtr id="S2.E8.m1.4.4.4d" xref="S2.E8.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E8.m1.4.4.4e" xref="S2.E8.m1.6.7.3.1.cmml"><mrow id="S2.E8.m1.3.3.3.3.1.1.4" xref="S2.E8.m1.3.3.3.3.1.1.3.cmml"><mi id="S2.E8.m1.3.3.3.3.1.1.2" xref="S2.E8.m1.3.3.3.3.1.1.2.cmml">cos</mi><mo id="S2.E8.m1.3.3.3.3.1.1.4a" xref="S2.E8.m1.3.3.3.3.1.1.3.cmml">⁡</mo><mrow id="S2.E8.m1.3.3.3.3.1.1.4.1" xref="S2.E8.m1.3.3.3.3.1.1.3.cmml"><mo id="S2.E8.m1.3.3.3.3.1.1.4.1.1" xref="S2.E8.m1.3.3.3.3.1.1.3.cmml">(</mo><mstyle displaystyle="false" id="S2.E8.m1.3.3.3.3.1.1.1" xref="S2.E8.m1.3.3.3.3.1.1.1.cmml"><mfrac id="S2.E8.m1.3.3.3.3.1.1.1a" xref="S2.E8.m1.3.3.3.3.1.1.1.cmml"><mrow id="S2.E8.m1.3.3.3.3.1.1.1.3" xref="S2.E8.m1.3.3.3.3.1.1.1.3.cmml"><mi id="S2.E8.m1.3.3.3.3.1.1.1.3.2" xref="S2.E8.m1.3.3.3.3.1.1.1.3.2.cmml">p</mi><mo id="S2.E8.m1.3.3.3.3.1.1.1.3.1" xref="S2.E8.m1.3.3.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E8.m1.3.3.3.3.1.1.1.3.3" xref="S2.E8.m1.3.3.3.3.1.1.1.3.3.cmml">o</mi><mo id="S2.E8.m1.3.3.3.3.1.1.1.3.1a" xref="S2.E8.m1.3.3.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E8.m1.3.3.3.3.1.1.1.3.4" xref="S2.E8.m1.3.3.3.3.1.1.1.3.4.cmml">s</mi></mrow><msup id="S2.E8.m1.3.3.3.3.1.1.1.1" xref="S2.E8.m1.3.3.3.3.1.1.1.1.cmml"><mn id="S2.E8.m1.3.3.3.3.1.1.1.1.3" xref="S2.E8.m1.3.3.3.3.1.1.1.1.3.cmml">10000</mn><mrow id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.2" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">/</mo><msub id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.2" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.2" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.2.cmml">m</mi><mo id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.1" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.3" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.3.cmml">o</mi><mo id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.1a" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.4" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.4.cmml">d</mi><mo id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.1b" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.5" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.5.cmml">e</mi><mo id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.1c" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.6" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.6.cmml">l</mi></mrow></msub></mrow></msup></mfrac></mstyle><mo id="S2.E8.m1.3.3.3.3.1.1.4.1.2" xref="S2.E8.m1.3.3.3.3.1.1.3.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E8.m1.4.4.4f" xref="S2.E8.m1.6.7.3.1.cmml"><mrow id="S2.E8.m1.4.4.4.4.2.1" xref="S2.E8.m1.4.4.4.4.2.1.cmml"><mtext id="S2.E8.m1.4.4.4.4.2.1.2" xref="S2.E8.m1.4.4.4.4.2.1.2a.cmml">if </mtext><mo id="S2.E8.m1.4.4.4.4.2.1.1" xref="S2.E8.m1.4.4.4.4.2.1.1.cmml">⁢</mo><mi id="S2.E8.m1.4.4.4.4.2.1.3" xref="S2.E8.m1.4.4.4.4.2.1.3.cmml">i</mi><mo id="S2.E8.m1.4.4.4.4.2.1.1a" xref="S2.E8.m1.4.4.4.4.2.1.1.cmml">⁢</mo><mtext id="S2.E8.m1.4.4.4.4.2.1.4" xref="S2.E8.m1.4.4.4.4.2.1.4a.cmml"> is odd</mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.6b"><apply id="S2.E8.m1.6.7.cmml" xref="S2.E8.m1.6.7"><eq id="S2.E8.m1.6.7.1.cmml" xref="S2.E8.m1.6.7.1"></eq><apply id="S2.E8.m1.6.7.2.cmml" xref="S2.E8.m1.6.7.2"><times id="S2.E8.m1.6.7.2.1.cmml" xref="S2.E8.m1.6.7.2.1"></times><ci id="S2.E8.m1.6.7.2.2.cmml" xref="S2.E8.m1.6.7.2.2">𝑃</ci><apply id="S2.E8.m1.6.7.2.3.cmml" xref="S2.E8.m1.6.7.2.3"><csymbol cd="ambiguous" id="S2.E8.m1.6.7.2.3.1.cmml" xref="S2.E8.m1.6.7.2.3">subscript</csymbol><ci id="S2.E8.m1.6.7.2.3.2.cmml" xref="S2.E8.m1.6.7.2.3.2">𝐸</ci><interval closure="open" id="S2.E8.m1.6.6.2.3.cmml" xref="S2.E8.m1.6.6.2.2"><apply id="S2.E8.m1.6.6.2.2.1.cmml" xref="S2.E8.m1.6.6.2.2.1"><times id="S2.E8.m1.6.6.2.2.1.1.cmml" xref="S2.E8.m1.6.6.2.2.1.1"></times><ci id="S2.E8.m1.6.6.2.2.1.2.cmml" xref="S2.E8.m1.6.6.2.2.1.2">𝑝</ci><ci id="S2.E8.m1.6.6.2.2.1.3.cmml" xref="S2.E8.m1.6.6.2.2.1.3">𝑜</ci><ci id="S2.E8.m1.6.6.2.2.1.4.cmml" xref="S2.E8.m1.6.6.2.2.1.4">𝑠</ci></apply><ci id="S2.E8.m1.5.5.1.1.cmml" xref="S2.E8.m1.5.5.1.1">𝑖</ci></interval></apply></apply><apply id="S2.E8.m1.6.7.3.1.cmml" xref="S2.E8.m1.4.4"><csymbol cd="latexml" id="S2.E8.m1.6.7.3.1.1.cmml" xref="S2.E8.m1.4.4.5">cases</csymbol><apply id="S2.E8.m1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.4"><sin id="S2.E8.m1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1"></sin><apply id="S2.E8.m1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2"><divide id="S2.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2"></divide><apply id="S2.E8.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.2"><times id="S2.E8.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.2.1"></times><ci id="S2.E8.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.2.2">𝑝</ci><ci id="S2.E8.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.2.3">𝑜</ci><ci id="S2.E8.m1.1.1.1.1.1.1.2.2.4.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.2.4">𝑠</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3">superscript</csymbol><cn id="S2.E8.m1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="S2.E8.m1.1.1.1.1.1.1.2.3.2">10000</cn><apply id="S2.E8.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3"><divide id="S2.E8.m1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.1"></divide><ci id="S2.E8.m1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.2">𝑖</ci><apply id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.2">𝑑</ci><apply id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3"><times id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.1"></times><ci id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.2">𝑚</ci><ci id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.3">𝑜</ci><ci id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.4.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.4">𝑑</ci><ci id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.5.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.5">𝑒</ci><ci id="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.6.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3.3.3.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply><apply id="S2.E8.m1.2.2.2.2.2.1.cmml" xref="S2.E8.m1.2.2.2.2.2.1"><times id="S2.E8.m1.2.2.2.2.2.1.1.cmml" xref="S2.E8.m1.2.2.2.2.2.1.1"></times><ci id="S2.E8.m1.2.2.2.2.2.1.2a.cmml" xref="S2.E8.m1.2.2.2.2.2.1.2"><mtext id="S2.E8.m1.2.2.2.2.2.1.2.cmml" xref="S2.E8.m1.2.2.2.2.2.1.2">if </mtext></ci><ci id="S2.E8.m1.2.2.2.2.2.1.3.cmml" xref="S2.E8.m1.2.2.2.2.2.1.3">𝑖</ci><ci id="S2.E8.m1.2.2.2.2.2.1.4a.cmml" xref="S2.E8.m1.2.2.2.2.2.1.4"><mtext id="S2.E8.m1.2.2.2.2.2.1.4.cmml" xref="S2.E8.m1.2.2.2.2.2.1.4"> is even</mtext></ci></apply><apply id="S2.E8.m1.3.3.3.3.1.1.3.cmml" xref="S2.E8.m1.3.3.3.3.1.1.4"><cos id="S2.E8.m1.3.3.3.3.1.1.2.cmml" xref="S2.E8.m1.3.3.3.3.1.1.2"></cos><apply id="S2.E8.m1.3.3.3.3.1.1.1.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1"><divide id="S2.E8.m1.3.3.3.3.1.1.1.2.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1"></divide><apply id="S2.E8.m1.3.3.3.3.1.1.1.3.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.3"><times id="S2.E8.m1.3.3.3.3.1.1.1.3.1.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.3.1"></times><ci id="S2.E8.m1.3.3.3.3.1.1.1.3.2.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.3.2">𝑝</ci><ci id="S2.E8.m1.3.3.3.3.1.1.1.3.3.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.3.3">𝑜</ci><ci id="S2.E8.m1.3.3.3.3.1.1.1.3.4.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.3.4">𝑠</ci></apply><apply id="S2.E8.m1.3.3.3.3.1.1.1.1.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1">superscript</csymbol><cn id="S2.E8.m1.3.3.3.3.1.1.1.1.3.cmml" type="integer" xref="S2.E8.m1.3.3.3.3.1.1.1.1.3">10000</cn><apply id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1"><divide id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.2"></divide><apply id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1"><minus id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.2">𝑖</ci><cn id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.2">𝑑</ci><apply id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3"><times id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.2">𝑚</ci><ci id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.3">𝑜</ci><ci id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.4">𝑑</ci><ci id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.5.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.5">𝑒</ci><ci id="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.6.cmml" xref="S2.E8.m1.3.3.3.3.1.1.1.1.1.1.3.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply><apply id="S2.E8.m1.4.4.4.4.2.1.cmml" xref="S2.E8.m1.4.4.4.4.2.1"><times id="S2.E8.m1.4.4.4.4.2.1.1.cmml" xref="S2.E8.m1.4.4.4.4.2.1.1"></times><ci id="S2.E8.m1.4.4.4.4.2.1.2a.cmml" xref="S2.E8.m1.4.4.4.4.2.1.2"><mtext id="S2.E8.m1.4.4.4.4.2.1.2.cmml" xref="S2.E8.m1.4.4.4.4.2.1.2">if </mtext></ci><ci id="S2.E8.m1.4.4.4.4.2.1.3.cmml" xref="S2.E8.m1.4.4.4.4.2.1.3">𝑖</ci><ci id="S2.E8.m1.4.4.4.4.2.1.4a.cmml" xref="S2.E8.m1.4.4.4.4.2.1.4"><mtext id="S2.E8.m1.4.4.4.4.2.1.4.cmml" xref="S2.E8.m1.4.4.4.4.2.1.4"> is odd</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.6c">PE_{(pos,i)}=\begin{cases}\sin\left(\frac{pos}{10000^{i/d_{model}}}\right)&amp;%
\text{if }i\text{ is even}\\
\cos\left(\frac{pos}{10000^{(i-1)/d_{model}}}\right)&amp;\text{if }i\text{ is odd}%
\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.6d">italic_P italic_E start_POSTSUBSCRIPT ( italic_p italic_o italic_s , italic_i ) end_POSTSUBSCRIPT = { start_ROW start_CELL roman_sin ( divide start_ARG italic_p italic_o italic_s end_ARG start_ARG 10000 start_POSTSUPERSCRIPT italic_i / italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG ) end_CELL start_CELL if italic_i is even end_CELL end_ROW start_ROW start_CELL roman_cos ( divide start_ARG italic_p italic_o italic_s end_ARG start_ARG 10000 start_POSTSUPERSCRIPT ( italic_i - 1 ) / italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG ) end_CELL start_CELL if italic_i is odd end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS7.p3.10">The term <math alttext="10000^{i/d_{model}}" class="ltx_Math" display="inline" id="S2.SS7.p3.7.m1.1"><semantics id="S2.SS7.p3.7.m1.1a"><msup id="S2.SS7.p3.7.m1.1.1" xref="S2.SS7.p3.7.m1.1.1.cmml"><mn id="S2.SS7.p3.7.m1.1.1.2" xref="S2.SS7.p3.7.m1.1.1.2.cmml">10000</mn><mrow id="S2.SS7.p3.7.m1.1.1.3" xref="S2.SS7.p3.7.m1.1.1.3.cmml"><mi id="S2.SS7.p3.7.m1.1.1.3.2" xref="S2.SS7.p3.7.m1.1.1.3.2.cmml">i</mi><mo id="S2.SS7.p3.7.m1.1.1.3.1" xref="S2.SS7.p3.7.m1.1.1.3.1.cmml">/</mo><msub id="S2.SS7.p3.7.m1.1.1.3.3" xref="S2.SS7.p3.7.m1.1.1.3.3.cmml"><mi id="S2.SS7.p3.7.m1.1.1.3.3.2" xref="S2.SS7.p3.7.m1.1.1.3.3.2.cmml">d</mi><mrow id="S2.SS7.p3.7.m1.1.1.3.3.3" xref="S2.SS7.p3.7.m1.1.1.3.3.3.cmml"><mi id="S2.SS7.p3.7.m1.1.1.3.3.3.2" xref="S2.SS7.p3.7.m1.1.1.3.3.3.2.cmml">m</mi><mo id="S2.SS7.p3.7.m1.1.1.3.3.3.1" xref="S2.SS7.p3.7.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.SS7.p3.7.m1.1.1.3.3.3.3" xref="S2.SS7.p3.7.m1.1.1.3.3.3.3.cmml">o</mi><mo id="S2.SS7.p3.7.m1.1.1.3.3.3.1a" xref="S2.SS7.p3.7.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.SS7.p3.7.m1.1.1.3.3.3.4" xref="S2.SS7.p3.7.m1.1.1.3.3.3.4.cmml">d</mi><mo id="S2.SS7.p3.7.m1.1.1.3.3.3.1b" xref="S2.SS7.p3.7.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.SS7.p3.7.m1.1.1.3.3.3.5" xref="S2.SS7.p3.7.m1.1.1.3.3.3.5.cmml">e</mi><mo id="S2.SS7.p3.7.m1.1.1.3.3.3.1c" xref="S2.SS7.p3.7.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.SS7.p3.7.m1.1.1.3.3.3.6" xref="S2.SS7.p3.7.m1.1.1.3.3.3.6.cmml">l</mi></mrow></msub></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.7.m1.1b"><apply id="S2.SS7.p3.7.m1.1.1.cmml" xref="S2.SS7.p3.7.m1.1.1"><csymbol cd="ambiguous" id="S2.SS7.p3.7.m1.1.1.1.cmml" xref="S2.SS7.p3.7.m1.1.1">superscript</csymbol><cn id="S2.SS7.p3.7.m1.1.1.2.cmml" type="integer" xref="S2.SS7.p3.7.m1.1.1.2">10000</cn><apply id="S2.SS7.p3.7.m1.1.1.3.cmml" xref="S2.SS7.p3.7.m1.1.1.3"><divide id="S2.SS7.p3.7.m1.1.1.3.1.cmml" xref="S2.SS7.p3.7.m1.1.1.3.1"></divide><ci id="S2.SS7.p3.7.m1.1.1.3.2.cmml" xref="S2.SS7.p3.7.m1.1.1.3.2">𝑖</ci><apply id="S2.SS7.p3.7.m1.1.1.3.3.cmml" xref="S2.SS7.p3.7.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS7.p3.7.m1.1.1.3.3.1.cmml" xref="S2.SS7.p3.7.m1.1.1.3.3">subscript</csymbol><ci id="S2.SS7.p3.7.m1.1.1.3.3.2.cmml" xref="S2.SS7.p3.7.m1.1.1.3.3.2">𝑑</ci><apply id="S2.SS7.p3.7.m1.1.1.3.3.3.cmml" xref="S2.SS7.p3.7.m1.1.1.3.3.3"><times id="S2.SS7.p3.7.m1.1.1.3.3.3.1.cmml" xref="S2.SS7.p3.7.m1.1.1.3.3.3.1"></times><ci id="S2.SS7.p3.7.m1.1.1.3.3.3.2.cmml" xref="S2.SS7.p3.7.m1.1.1.3.3.3.2">𝑚</ci><ci id="S2.SS7.p3.7.m1.1.1.3.3.3.3.cmml" xref="S2.SS7.p3.7.m1.1.1.3.3.3.3">𝑜</ci><ci id="S2.SS7.p3.7.m1.1.1.3.3.3.4.cmml" xref="S2.SS7.p3.7.m1.1.1.3.3.3.4">𝑑</ci><ci id="S2.SS7.p3.7.m1.1.1.3.3.3.5.cmml" xref="S2.SS7.p3.7.m1.1.1.3.3.3.5">𝑒</ci><ci id="S2.SS7.p3.7.m1.1.1.3.3.3.6.cmml" xref="S2.SS7.p3.7.m1.1.1.3.3.3.6">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.7.m1.1c">10000^{i/d_{model}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.7.m1.1d">10000 start_POSTSUPERSCRIPT italic_i / italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> in the formula serves to decrease the frequency as <math alttext="i" class="ltx_Math" display="inline" id="S2.SS7.p3.8.m2.1"><semantics id="S2.SS7.p3.8.m2.1a"><mi id="S2.SS7.p3.8.m2.1.1" xref="S2.SS7.p3.8.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.8.m2.1b"><ci id="S2.SS7.p3.8.m2.1.1.cmml" xref="S2.SS7.p3.8.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.8.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.8.m2.1d">italic_i</annotation></semantics></math> becomes larger. Smaller <math alttext="i" class="ltx_Math" display="inline" id="S2.SS7.p3.9.m3.1"><semantics id="S2.SS7.p3.9.m3.1a"><mi id="S2.SS7.p3.9.m3.1.1" xref="S2.SS7.p3.9.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.9.m3.1b"><ci id="S2.SS7.p3.9.m3.1.1.cmml" xref="S2.SS7.p3.9.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.9.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.9.m3.1d">italic_i</annotation></semantics></math> values represent the least significant bits of the binary number that change with higher frequency, while larger <math alttext="i" class="ltx_Math" display="inline" id="S2.SS7.p3.10.m4.1"><semantics id="S2.SS7.p3.10.m4.1a"><mi id="S2.SS7.p3.10.m4.1.1" xref="S2.SS7.p3.10.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.10.m4.1b"><ci id="S2.SS7.p3.10.m4.1.1.cmml" xref="S2.SS7.p3.10.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.10.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.10.m4.1d">italic_i</annotation></semantics></math> values correspond to bits that change with lower frequency. Now the first 16 binary number become

<br class="ltx_break"/></p>
<div class="ltx_logical-block" id="S2.SS7.p3.11">
<div class="ltx_para ltx_noindent ltx_align_center" id="S2.SS7.p3.11.p1">
<svg class="ltx_picture" height="426.06" id="S2.SS7.p3.11.p1.pic1" overflow="visible" version="1.1" width="420"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,426.06) matrix(1 0 0 -1 0 0)"><g fill="#CCCCCC" fill-opacity="1.0"><path d="M 0 5.91 L 0 420.16 C 0 423.42 2.64 426.06 5.91 426.06 L 414.09 426.06 C 417.35 426.06 420 423.42 420 420.16 L 420 5.91 C 420 2.64 417.35 0 414.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#E6E6E6" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 420.16 C 1.97 422.33 3.73 424.1 5.91 424.1 L 414.09 424.1 C 416.27 424.1 418.03 422.33 418.03 420.16 L 418.03 5.91 C 418.03 3.73 416.27 1.97 414.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="398.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="376.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64" style="width:272.2pt;">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64">
<span class="ltx_tbody">
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.5.1">0</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="1.000" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">1.000</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">1.000</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">1.000</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">1.000</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2"><math alttext="0.0000" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.cmml">0.0000</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1.1">0.0000</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1c">0.0000</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m1.1d">0.0000</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3"><math alttext="1.0000" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.cmml">1.0000</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1.1">1.0000</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1c">1.0000</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m1.1d">1.0000</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4"><math alttext="0.0000" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1.cmml">0.0000</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1.1">0.0000</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1c">0.0000</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m1.1d">0.0000</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.5.1">1</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1"><math alttext="0.9999" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1.cmml">0.9999</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1.1">0.9999</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1c">0.9999</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.1.m1.1d">0.9999</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.2"><math alttext="0.0099" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.2.m1.1.1.cmml">0.0099</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.2.m1.1.1">0.0099</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.2.m1.1c">0.0099</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.2.m1.1d">0.0099</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.3"><math alttext="0.5403" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.3.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.3.m1.1.1.cmml">0.5403</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.3.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.3.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.3.m1.1.1">0.5403</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.3.m1.1c">0.5403</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.3.m1.1d">0.5403</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.4"><math alttext="0.8415" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.4.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.4.m1.1.1.cmml">0.8415</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.4.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.4.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.4.m1.1.1">0.8415</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.4.m1.1c">0.8415</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.4.m1.1d">0.8415</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.5.1">2</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1"><math alttext="0.9998" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1.m1.1.1.cmml">0.9998</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1.m1.1.1">0.9998</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1.m1.1c">0.9998</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.1.m1.1d">0.9998</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.2"><math alttext="0.0199" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.2.m1.1.1.cmml">0.0199</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.2.m1.1.1">0.0199</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.2.m1.1c">0.0199</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.2.m1.1d">0.0199</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3"><math alttext="-0.4161" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1.2.cmml">0.4161</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1.1.2">0.4161</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1c">-0.4161</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.3.m1.1d">- 0.4161</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.4"><math alttext="0.9093" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.4.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.4.m1.1.1.cmml">0.9093</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.4.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.4.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.4.m1.1.1">0.9093</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.4.m1.1c">0.9093</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.4.m1.1d">0.9093</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.5.1">3</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1"><math alttext="0.9995" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.m1.1.1.cmml">0.9995</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.m1.1.1">0.9995</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.m1.1c">0.9995</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.m1.1d">0.9995</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2"><math alttext="0.0299" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.m1.1.1.cmml">0.0299</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.m1.1.1">0.0299</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.m1.1c">0.0299</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.m1.1d">0.0299</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3"><math alttext="-0.9900" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1.2.cmml">0.9900</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1.1.2">0.9900</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1c">-0.9900</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.m1.1d">- 0.9900</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.4"><math alttext="0.1411" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.4.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.4.m1.1.1.cmml">0.1411</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.4.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.4.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.4.m1.1.1">0.1411</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.4.m1.1c">0.1411</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.16.4.m1.1d">0.1411</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.5.1">4</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.1"><math alttext="0.9992" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.1.m1.1.1.cmml">0.9992</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.1.m1.1.1">0.9992</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.1.m1.1c">0.9992</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.17.1.m1.1d">0.9992</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.2"><math alttext="0.0399" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.2.m1.1.1.cmml">0.0399</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.2.m1.1.1">0.0399</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.2.m1.1c">0.0399</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.18.2.m1.1d">0.0399</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3"><math alttext="-0.6536" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1.2.cmml">0.6536</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1.1.2">0.6536</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1c">-0.6536</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.19.3.m1.1d">- 0.6536</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4"><math alttext="-0.7568" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1.2.cmml">0.7568</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1.1.2">0.7568</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1c">-0.7568</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.20.4.m1.1d">- 0.7568</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.5.1">5</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.1"><math alttext="0.9987" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.1.m1.1.1.cmml">0.9987</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.1.m1.1.1">0.9987</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.1.m1.1c">0.9987</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.21.1.m1.1d">0.9987</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.2"><math alttext="0.0499" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.2.m1.1.1.cmml">0.0499</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.2.m1.1.1">0.0499</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.2.m1.1c">0.0499</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.22.2.m1.1d">0.0499</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.3"><math alttext="0.2837" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.3.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.3.m1.1.1.cmml">0.2837</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.3.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.3.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.3.m1.1.1">0.2837</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.3.m1.1c">0.2837</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.23.3.m1.1d">0.2837</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4"><math alttext="-0.9589" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1.2.cmml">0.9589</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1.1.2">0.9589</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1c">-0.9589</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.24.4.m1.1d">- 0.9589</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.5.1">6</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.1"><math alttext="0.9982" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.1.m1.1.1.cmml">0.9982</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.1.m1.1.1">0.9982</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.1.m1.1c">0.9982</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.25.1.m1.1d">0.9982</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.2"><math alttext="0.0599" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.2.m1.1.1.cmml">0.0599</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.2.m1.1.1">0.0599</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.2.m1.1c">0.0599</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.26.2.m1.1d">0.0599</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.3"><math alttext="0.9602" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.3.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.3.m1.1.1.cmml">0.9602</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.3.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.3.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.3.m1.1.1">0.9602</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.3.m1.1c">0.9602</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.27.3.m1.1d">0.9602</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4"><math alttext="-0.2794" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1.2.cmml">0.2794</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1.1.2">0.2794</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1c">-0.2794</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.28.4.m1.1d">- 0.2794</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.5.1">7</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.1"><math alttext="0.9975" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.1.m1.1.1.cmml">0.9975</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.1.m1.1.1">0.9975</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.1.m1.1c">0.9975</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.29.1.m1.1d">0.9975</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.2"><math alttext="0.0699" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.2.m1.1.1.cmml">0.0699</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.2.m1.1.1">0.0699</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.2.m1.1c">0.0699</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.30.2.m1.1d">0.0699</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.3"><math alttext="0.7539" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.3.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.3.m1.1.1.cmml">0.7539</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.3.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.3.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.3.m1.1.1">0.7539</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.3.m1.1c">0.7539</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.31.3.m1.1d">0.7539</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.4"><math alttext="0.6570" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.4.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.4.m1.1.1.cmml">0.6570</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.4.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.4.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.4.m1.1.1">0.6570</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.4.m1.1c">0.6570</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.32.4.m1.1d">0.6570</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.5.1">8</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.1"><math alttext="0.9968" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.1.m1.1.1.cmml">0.9968</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.1.m1.1.1">0.9968</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.1.m1.1c">0.9968</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.33.1.m1.1d">0.9968</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.2"><math alttext="0.0799" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.2.m1.1.1.cmml">0.0799</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.2.m1.1.1">0.0799</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.2.m1.1c">0.0799</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.34.2.m1.1d">0.0799</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3"><math alttext="-0.1455" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1.2.cmml">0.1455</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1.1.2">0.1455</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1c">-0.1455</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.35.3.m1.1d">- 0.1455</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.4"><math alttext="0.9894" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.4.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.4.m1.1.1.cmml">0.9894</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.4.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.4.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.4.m1.1.1">0.9894</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.4.m1.1c">0.9894</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.36.4.m1.1d">0.9894</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.5.1">9</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.1"><math alttext="0.9959" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.1.m1.1.1.cmml">0.9959</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.1.m1.1.1">0.9959</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.1.m1.1c">0.9959</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.37.1.m1.1d">0.9959</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.2"><math alttext="0.0898" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.2.m1.1.1.cmml">0.0898</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.2.m1.1.1">0.0898</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.2.m1.1c">0.0898</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.38.2.m1.1d">0.0898</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3"><math alttext="-0.9111" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1.2.cmml">0.9111</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1.1.2">0.9111</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1c">-0.9111</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.39.3.m1.1d">- 0.9111</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.4"><math alttext="0.4121" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.4.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.4.m1.1.1.cmml">0.4121</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.4.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.4.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.4.m1.1.1">0.4121</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.4.m1.1c">0.4121</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.40.4.m1.1d">0.4121</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.5.1">10</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.1"><math alttext="0.9950" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.1.m1.1.1.cmml">0.9950</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.1.m1.1.1">0.9950</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.1.m1.1c">0.9950</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.41.1.m1.1d">0.9950</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.2"><math alttext="0.0998" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.2.m1.1.1.cmml">0.0998</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.2.m1.1.1">0.0998</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.2.m1.1c">0.0998</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.42.2.m1.1d">0.0998</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3"><math alttext="-0.8391" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1.2.cmml">0.8391</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1.1.2">0.8391</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1c">-0.8391</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.43.3.m1.1d">- 0.8391</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4"><math alttext="-0.5440" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1.2.cmml">0.5440</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1.1.2">0.5440</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1c">-0.5440</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.44.4.m1.1d">- 0.5440</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.5.1">11</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.1"><math alttext="0.9939" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.1.m1.1.1.cmml">0.9939</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.1.m1.1.1">0.9939</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.1.m1.1c">0.9939</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.45.1.m1.1d">0.9939</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.2"><math alttext="0.1097" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.2.m1.1.1.cmml">0.1097</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.2.m1.1.1">0.1097</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.2.m1.1c">0.1097</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.46.2.m1.1d">0.1097</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.3"><math alttext="0.0044" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.3.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.3.m1.1.1.cmml">0.0044</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.3.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.3.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.3.m1.1.1">0.0044</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.3.m1.1c">0.0044</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.47.3.m1.1d">0.0044</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4"><math alttext="-1.0000" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1.2.cmml">1.0000</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1.1.2">1.0000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1c">-1.0000</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.48.4.m1.1d">- 1.0000</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.5.1">12</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.1"><math alttext="0.9928" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.1.m1.1.1.cmml">0.9928</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.1.m1.1.1">0.9928</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.1.m1.1c">0.9928</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.49.1.m1.1d">0.9928</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.2"><math alttext="0.1197" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.2.m1.1.1.cmml">0.1197</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.2.m1.1.1">0.1197</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.2.m1.1c">0.1197</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.50.2.m1.1d">0.1197</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.3"><math alttext="0.8439" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.3.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.3.m1.1.1.cmml">0.8439</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.3.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.3.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.3.m1.1.1">0.8439</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.3.m1.1c">0.8439</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.51.3.m1.1d">0.8439</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4"><math alttext="-0.5366" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1.2.cmml">0.5366</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1.1.2">0.5366</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1c">-0.5366</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.52.4.m1.1d">- 0.5366</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.5.1">13</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.1"><math alttext="0.9915" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.1.m1.1.1.cmml">0.9915</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.1.m1.1.1">0.9915</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.1.m1.1c">0.9915</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.53.1.m1.1d">0.9915</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.2"><math alttext="0.1296" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.2.m1.1.1.cmml">0.1296</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.2.m1.1.1">0.1296</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.2.m1.1c">0.1296</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.54.2.m1.1d">0.1296</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.3"><math alttext="0.9074" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.3.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.3.m1.1.1.cmml">0.9074</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.3.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.3.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.3.m1.1.1">0.9074</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.3.m1.1c">0.9074</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.55.3.m1.1d">0.9074</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.4"><math alttext="0.4202" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.4.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.4.m1.1.1.cmml">0.4202</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.4.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.4.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.4.m1.1.1">0.4202</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.4.m1.1c">0.4202</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.56.4.m1.1d">0.4202</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.5.1">14</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.1"><math alttext="0.9902" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.1.m1.1.1.cmml">0.9902</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.1.m1.1.1">0.9902</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.1.m1.1c">0.9902</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.57.1.m1.1d">0.9902</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.2"><math alttext="0.1395" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.2.m1.1.1.cmml">0.1395</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.2.m1.1.1">0.1395</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.2.m1.1c">0.1395</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.58.2.m1.1d">0.1395</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.3"><math alttext="0.1367" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.3.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.3.m1.1.1.cmml">0.1367</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.3.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.3.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.3.m1.1.1">0.1367</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.3.m1.1c">0.1367</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.59.3.m1.1d">0.1367</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.4"><math alttext="0.9906" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.4.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.4.m1.1.1.cmml">0.9906</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.4.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.4.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.4.m1.1.1">0.9906</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.4.m1.1c">0.9906</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.60.4.m1.1d">0.9906</annotation></semantics></math></span></span>
<span class="ltx_tr" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64">
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.5"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.5.1">15</span></span>
<span class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.6"><span class="ltx_text" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.6.1">:</span></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.1"><math alttext="0.9887" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.1.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.1.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.1.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.1.m1.1.1.cmml">0.9887</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.1.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.1.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.1.m1.1.1">0.9887</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.1.m1.1c">0.9887</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.61.1.m1.1d">0.9887</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.2"><math alttext="0.1494" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.2.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.2.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.2.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.2.m1.1.1.cmml">0.1494</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.2.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.2.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.2.m1.1.1">0.1494</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.2.m1.1c">0.1494</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.62.2.m1.1d">0.1494</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3"><math alttext="-0.7597" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1a"><mrow id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1.cmml"><mo id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1a" xref="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1.cmml">−</mo><mn id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1.2" xref="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1.2.cmml">0.7597</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1b"><apply id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1"><minus id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1.1.cmml" xref="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1"></minus><cn id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1.2.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1.1.2">0.7597</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1c">-0.7597</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.63.3.m1.1d">- 0.7597</annotation></semantics></math></span>
<span class="ltx_td ltx_align_right" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.4"><math alttext="0.6503" class="ltx_Math" display="inline" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.4.m1.1"><semantics id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.4.m1.1a"><mn id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.4.m1.1.1" xref="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.4.m1.1.1.cmml">0.6503</mn><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.4.m1.1b"><cn id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.4.m1.1.1.cmml" type="float" xref="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.4.m1.1.1">0.6503</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.4.m1.1c">0.6503</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.11.p1.pic1.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.64.4.m1.1d">0.6503</annotation></semantics></math></span></span>
</span>
</span>
</span></foreignobject></g></g></svg>
</div>
</div>
</div>
<div class="ltx_para" id="S2.SS7.p4">
<p class="ltx_p" id="S2.SS7.p4.1">which correspond to the frequencies in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F6" title="Figure 6 ‣ 2.7 Positional embeddings ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">6</span></a>. There are additional properties of Positional Encodings defined in this way, as well as alternative definitions, which are not discussed here. Interested readers can refer to divulgative articles such as
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib5" title="">5</a>]</cite>.

<br class="ltx_break"/></p>
</div>
<figure class="ltx_figure" id="S2.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="159" id="S2.F6.g1" src="extracted/5903850/FIGURES/Frequencies.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F6.2.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S2.F6.3.2" style="font-size:90%;">Frequencies of positional encodings generated using sine and cosine functions. Each dimension of the positional encoding captures a different frequency, with smaller dimensions representing higher frequencies and larger dimensions corresponding to lower frequencies.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.8 </span>The final touches (inference)</h3>
<div class="ltx_para" id="S2.SS8.p1">
<p class="ltx_p" id="S2.SS8.p1.1">Several additional layers complete the Transformer architecture during inference (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F7" title="Figure 7 ‣ 2.8 The final touches (inference) ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">7</span></a>). First, a Linear layer projects the output embeddings from the decoder into a higher-dimensional space corresponding to the vocabulary size. Each element in this vector represents an unnormalized score (logit) for a specific word being the next token in the sequence. Finally, a Softmax layer converts these logits into probabilities, indicating the likelihood of each word being the correct next token.
<br class="ltx_break"/></p>
</div>
<figure class="ltx_figure" id="S2.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="529" id="S2.F7.g1" src="extracted/5903850/FIGURES/Fig_with_positional.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F7.2.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="S2.F7.3.2" style="font-size:90%;">Complete inference process in Transformers. Building on Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F4" title="Figure 4 ‣ 2.4 Inside the ‘Output Transformation’ Box: Cross-Attention Mechanism ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">4</span></a>, positional encodings are added to the input tokens, multi-headed self-attention and cross-attention mechanisms are introduced, and feed-forward neural networks (FFNNs) are applied. The final output is generated through a linear layer followed by a Softmax function.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS9">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.9 </span>Training</h3>
<div class="ltx_para" id="S2.SS9.p1">
<p class="ltx_p" id="S2.SS9.p1.3">So far, we have discussed how the Transformer model operates during inference, where it predicts the next word in a sequence based on a given input from the user. However, for the model to generate coherent and contextually appropriate text during inference, it must first undergo a training process. A Transformer model contains a large number of trainable parameters, including those within the FFNNs and the various weight matrices <math alttext="\bm{W}_{K}" class="ltx_Math" display="inline" id="S2.SS9.p1.1.m1.1"><semantics id="S2.SS9.p1.1.m1.1a"><msub id="S2.SS9.p1.1.m1.1.1" xref="S2.SS9.p1.1.m1.1.1.cmml"><mi id="S2.SS9.p1.1.m1.1.1.2" xref="S2.SS9.p1.1.m1.1.1.2.cmml">𝑾</mi><mi id="S2.SS9.p1.1.m1.1.1.3" xref="S2.SS9.p1.1.m1.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS9.p1.1.m1.1b"><apply id="S2.SS9.p1.1.m1.1.1.cmml" xref="S2.SS9.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS9.p1.1.m1.1.1.1.cmml" xref="S2.SS9.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS9.p1.1.m1.1.1.2.cmml" xref="S2.SS9.p1.1.m1.1.1.2">𝑾</ci><ci id="S2.SS9.p1.1.m1.1.1.3.cmml" xref="S2.SS9.p1.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS9.p1.1.m1.1c">\bm{W}_{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS9.p1.1.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\bm{W}_{Q}" class="ltx_Math" display="inline" id="S2.SS9.p1.2.m2.1"><semantics id="S2.SS9.p1.2.m2.1a"><msub id="S2.SS9.p1.2.m2.1.1" xref="S2.SS9.p1.2.m2.1.1.cmml"><mi id="S2.SS9.p1.2.m2.1.1.2" xref="S2.SS9.p1.2.m2.1.1.2.cmml">𝑾</mi><mi id="S2.SS9.p1.2.m2.1.1.3" xref="S2.SS9.p1.2.m2.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS9.p1.2.m2.1b"><apply id="S2.SS9.p1.2.m2.1.1.cmml" xref="S2.SS9.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS9.p1.2.m2.1.1.1.cmml" xref="S2.SS9.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS9.p1.2.m2.1.1.2.cmml" xref="S2.SS9.p1.2.m2.1.1.2">𝑾</ci><ci id="S2.SS9.p1.2.m2.1.1.3.cmml" xref="S2.SS9.p1.2.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS9.p1.2.m2.1c">\bm{W}_{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS9.p1.2.m2.1d">bold_italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\bm{W}_{V}" class="ltx_Math" display="inline" id="S2.SS9.p1.3.m3.1"><semantics id="S2.SS9.p1.3.m3.1a"><msub id="S2.SS9.p1.3.m3.1.1" xref="S2.SS9.p1.3.m3.1.1.cmml"><mi id="S2.SS9.p1.3.m3.1.1.2" xref="S2.SS9.p1.3.m3.1.1.2.cmml">𝑾</mi><mi id="S2.SS9.p1.3.m3.1.1.3" xref="S2.SS9.p1.3.m3.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS9.p1.3.m3.1b"><apply id="S2.SS9.p1.3.m3.1.1.cmml" xref="S2.SS9.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS9.p1.3.m3.1.1.1.cmml" xref="S2.SS9.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS9.p1.3.m3.1.1.2.cmml" xref="S2.SS9.p1.3.m3.1.1.2">𝑾</ci><ci id="S2.SS9.p1.3.m3.1.1.3.cmml" xref="S2.SS9.p1.3.m3.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS9.p1.3.m3.1c">\bm{W}_{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS9.p1.3.m3.1d">bold_italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> that are used in the self-attention mechanism. These parameters must be trained (i.e., optimized) so the model can effectively predict the next word in a sequence given all the previous words. We assume the reader is familiar with fundamentals of training neural networks such as back-propagation and Stochastic Gradient Descent.
<br class="ltx_break"/>Let’s revisit the sequence from our earlier example: the user’s input was "I am," and the model recursively generated the output &lt;s&gt; a teacher and you are a student &lt;eos&gt;."
In practice, the training process closely mirrors the inference process. For example:</p>
</div>
<div class="ltx_para" id="S2.SS9.p2">
<ul class="ltx_itemize" id="S2.I4">
<li class="ltx_item" id="S2.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I4.i1.p1">
<p class="ltx_p" id="S2.I4.i1.p1.1">Given the user input "I am" and the Transformer input "&lt;s&gt;", the target output for training is "a".</p>
</div>
</li>
<li class="ltx_item" id="S2.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I4.i2.p1">
<p class="ltx_p" id="S2.I4.i2.p1.1">Then, given the user input "I am" and the Transformer input "&lt;s&gt; a", the target output for training is "teacher".</p>
</div>
</li>
<li class="ltx_item" id="S2.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S2.I4.i3.p1">
<p class="ltx_p" id="S2.I4.i3.p1.1">This process continues similarly for each subsequent word in the sequence.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S2.SS9.p3">
<p class="ltx_p" id="S2.SS9.p3.1">However, there is a key difference between the conceptual description above and the actual training process of Transformers, which is designed to take advantage of parallelization. Instead of processing the sequence word by word (which would be sequential and slow), the entire sequence "&lt;s&gt; a teacher and you are a student" is fed into the decoder all at once during training. Simultaneously, the entire sequence "a teacher and you are a student &lt;eos&gt;" is used as the target output (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F8" title="Figure 8 ‣ 2.9 Training ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">8</span></a>). However, despite this, the model still learns to associate the first element of the decoder input, "&lt;s&gt;", with the first element of the target output, "a", the second element "a" with the second target "teacher", and so on.
<br class="ltx_break"/></p>
</div>
<figure class="ltx_figure" id="S2.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="412" id="S2.F8.g1" src="extracted/5903850/FIGURES/almost_complete.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F8.2.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="S2.F8.3.2" style="font-size:90%;">Training the Transformer. This figure illustrates the training process, where the entire input sequence (‘&lt;s&gt; a teacher and you are a student’) is fed into the decoder simultaneously. The target sequence (‘a teacher and you are a student &lt;eos&gt;’) is used to guide learning.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS9.p4">
<p class="ltx_p" id="S2.SS9.p4.1">There is one challenge, however. During the training process, the multi-headed attention mechanism in the decoder would, by default, calculate attention scores across all combinations of the decoder input sequence, "&lt;s&gt; a teacher and you are a student" (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F9" title="Figure 9 ‣ 2.9 Training ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">9</span></a>).</p>
</div>
<div class="ltx_para" id="S2.SS9.p5">
<p class="ltx_p" id="S2.SS9.p5.1">The problem arises when the model tries to learn from the decoder input rather than the target output. For example, when associating "&lt;s&gt;" with "a", the decoder’s self-attention should not allow "a" (or any successive word) to influence this prediction since "a" is the correct answer the model is supposed to learn from the target. Similarly, when the model is learning to associate "a" with "teacher", it should not be influenced by "teacher" or any subsequent words, because it shouldn’t know that "teacher" is the next word.</p>
</div>
<div class="ltx_para" id="S2.SS9.p6">
<p class="ltx_p" id="S2.SS9.p6.1">To prevent the model from "cheating" by using future words from its attention scores, a mask is applied to the self-attention mechanism of the decoder during training. The attention scores in red in (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F9" title="Figure 9 ‣ 2.9 Training ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">9</span></a>) are effectively removed by applying this mask.</p>
</div>
<div class="ltx_para" id="S2.SS9.p7">
<p class="ltx_p" id="S2.SS9.p7.1">The mask is a matrix of the same size as the attention scores, filled with values of 0’s and negative infinities. When this mask is added to the scaled attention scores, it replaces the upper triangular portion (the future positions) with negative infinities. This modification ensures that, when the softmax function is applied to these scores, the negative infinities are zeroed out, meaning the model does not attend to future tokens and thus cannot use them to make its predictions.</p>
</div>
<figure class="ltx_figure" id="S2.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="126" id="S2.F9.g1" src="extracted/5903850/FIGURES/mask.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F9.2.1.1" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text" id="S2.F9.3.2" style="font-size:90%;">Mask applied to the decoder during training. The red cells represent the positions in the attention matrix that are masked, ensuring that the decoder does not see future tokens during training.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS10">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.10 </span>The final touches (training)</h3>
<div class="ltx_para" id="S2.SS10.p1">
<p class="ltx_p" id="S2.SS10.p1.1">Finally, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S2.F10" title="Figure 10 ‣ 2.10 The final touches (training) ‣ 2 A High-Level Introduction to Transformers ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">10</span></a> includes several "Add &amp; Norm" layers, which are used to improve training. The "Add" operation represents a residual connection, where the output of a sub-layer is added to its original input. This helps mitigate the vanishing gradient problem during backpropagation. The "Norm" operation refers to Layer Normalization, which normalizes the output by rescaling it based on the mean and variance of the layer’s activations. This normalization stabilizes the training process by ensuring consistent activation scales.</p>
</div>
<figure class="ltx_figure" id="S2.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="522" id="S2.F10.g1" src="extracted/5903850/FIGURES/complete.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F10.2.1.1" style="font-size:90%;">Figure 10</span>: </span><span class="ltx_text" id="S2.F10.3.2" style="font-size:90%;">After adding the final Add &amp; Norm layers, which combine residual connections and normalization to stabilize training, we achieve the full Transformer architecture in its complete form.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS10.p2">
<p class="ltx_p" id="S2.SS10.p2.1">After this in-depth introduction to Transformers, we can conceptualize the entire process as an advanced exercise in multidimensional fitting, facilitated by two key types of transformations. The first type is explicit function mapping, executed by FFNNs, where each specific set of input values is directly mapped to a corresponding output set. The second type involves global mapping through the attention mechanism, which functions similarly to a (discrete) integral transform. This process integrates a function over the entire sequence with a learned kernel, producing new variables or functions that depend on the sequence as a whole. Unlike fixed transformations, such as the Fourier transform, these fitting functions are dynamically learned from data during training, allowing the model to adapt and refine its understanding.</p>
</div>
<div class="ltx_para" id="S2.SS10.p3">
<p class="ltx_p" id="S2.SS10.p3.1">With this understanding, we can now move to the second part of the paper, where we apply these insights to use Transformers for learning Partial Differential Equations (PDEs). This next section will demonstrate how the principles of multidimensional fitting discussed here can be extended to tackle engineering problems beyond NLP.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methods</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">As we have seen, even when applied in their native NLP domain, Transformers translate sequences of letters and words into numerical representations (embeddings). We will leverage this inherent feature of Transformers to train a model to predict the evolution of temperature in a heat conduction problem.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>The physical problem: basic configuration</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">First, let’s make clear what exactly we’re training the Transformer to predict. We consider a 2D plate with four Dirichlet BCs and an initial temperature distribution Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.F11" title="Figure 11 ‣ 3.1 The physical problem: basic configuration ‣ 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">11</span></a>. We use finite differences to solve the problem multiple times, each with randomly selected BCs, initial state and thermal diffusivity. The resulting finite-difference solutions provide separate training, validation and test sets for the Transformer model. For each case that is solved with finite differences, the normalized temperature on the left, top and right sides of the plate is randomly chosen in the normalized range 0 to 1.0. At the bottom side the normalized temperature is randomly chosen in the range 0 to 0.10 to induce further asymmetry to the problem. Furthermore, the initial internal temperature for each run is also initialized to a value that is randomly chosen in the range 0 to 1, independently from the Dirichlet temperatures. Finally, the heat diffusivity is also randomly chosen within a specified range. Because the heat diffusivity changes, the time step imposed by the stability criteria for the finite differences also potentially differ from one run to the next.</p>
</div>
<figure class="ltx_figure" id="S3.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="169" id="S3.F11.g1" src="extracted/5903850/FIGURES/DOMAIN/Domain.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F11.2.1.1" style="font-size:90%;">Figure 11</span>: </span><span class="ltx_text" id="S3.F11.3.2" style="font-size:90%;">The domain for the basic problem setup with four Dirichlet boundary conditions.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>The physical problem: challenge configuration 1</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We also consider a configuration that is designed to challenge the model by increasing the range of variability that the model must learn to adapt to. We consider two segments of predefined length, one with normalized temperature T=1 and the second with T=0, that are placed at specified locations on the left and right boundaries respectively as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.F12" title="Figure 12 ‣ 3.2 The physical problem: challenge configuration 1 ‣ 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">12</span></a>a. The introduced complication increases the likelihood that during inference the model will encounter conditions that deviate more substantially from those it had encountered during training. The reason is that these boundary features cause regions of localized inhomogeneity in the temperature field during the evolution towards steady state. Furthermore, both the extent of the associated inhomogeneities and how quickly they spread away from the boundary segments depends both on the Dirichlet boundary conditions, the initial internal temperature distribution and the thermal diffusivity, which in the test set will be different than those encountered by the model during training. We also wanted to test the effect of the additional boundary features on the weights of the final projection layer to understand how the model learns to emphasize features.</p>
</div>
<figure class="ltx_figure" id="S3.F12">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F12.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="243" id="S3.F12.sf1.g1" src="extracted/5903850/FIGURES/Domain_challenge1_v2.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F12.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F12.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="242" id="S3.F12.sf2.g1" src="extracted/5903850/FIGURES/Domain_challenge2_v2.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F12.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F12.2.1.1" style="font-size:90%;">Figure 12</span>: </span><span class="ltx_text" id="S3.F12.3.2" style="font-size:90%;">(a) Two examples of the domain configuration for Challenge 1 with four Dirichlet boundary conditions and two fixed boundary segments; (b) Two examples of the domain configuration for Challenge 2 with four Dirichlet boundary conditions and two randomly placed boundary segments.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>The physical problem: challenge configuration 2</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Finally, we consider an even more advanced challenge designed to test the model’s ability to generalize. We again consider two segments of predefined length, one with normalized temperature T=1 and the second with T=0. Now however for each case in the dataset, the two segments are randomly placed on any of the Dirichlet boundaries with the requirement that the segments must occupy different sides of the plate (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.F12" title="Figure 12 ‣ 3.2 The physical problem: challenge configuration 1 ‣ 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">12</span></a>b). The introduced complication increases even further the likelihood that during inference the model will encounter conditions that deviate substantially from those it had encountered during training.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Finite Differences Discretization</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">While the heat diffusivity varies across cases in the dataset, it remains constant during the evolution of the temperature field. Thus, we introduce a non-dimensional thermal diffusivity parameter, <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_β</annotation></semantics></math>, which is the ratio of the physical diffusivity to a reference diffusivity. The non-dimensionalized two-dimensional heat conduction equation is then given by,</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\frac{\partial\theta}{\partial\tau}=\beta\left(\frac{\partial^{2}\theta}{%
\partial\xi^{2}}+\frac{\partial^{2}\theta}{\partial\eta^{2}}\right)" class="ltx_Math" display="block" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mfrac id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml"><mrow id="S3.E9.m1.1.1.3.2" xref="S3.E9.m1.1.1.3.2.cmml"><mo id="S3.E9.m1.1.1.3.2.1" rspace="0em" xref="S3.E9.m1.1.1.3.2.1.cmml">∂</mo><mi id="S3.E9.m1.1.1.3.2.2" xref="S3.E9.m1.1.1.3.2.2.cmml">θ</mi></mrow><mrow id="S3.E9.m1.1.1.3.3" xref="S3.E9.m1.1.1.3.3.cmml"><mo id="S3.E9.m1.1.1.3.3.1" rspace="0em" xref="S3.E9.m1.1.1.3.3.1.cmml">∂</mo><mi id="S3.E9.m1.1.1.3.3.2" xref="S3.E9.m1.1.1.3.3.2.cmml">τ</mi></mrow></mfrac><mo id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.1.1.1.3.cmml">β</mi><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mfrac id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.1.1.2.2.cmml"><msup id="S3.E9.m1.1.1.1.1.1.1.2.2.1" xref="S3.E9.m1.1.1.1.1.1.1.2.2.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.2.2.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.2.1.2.cmml">∂</mo><mn id="S3.E9.m1.1.1.1.1.1.1.2.2.1.3" xref="S3.E9.m1.1.1.1.1.1.1.2.2.1.3.cmml">2</mn></msup><mi id="S3.E9.m1.1.1.1.1.1.1.2.2.2" xref="S3.E9.m1.1.1.1.1.1.1.2.2.2.cmml">θ</mi></mrow><mrow id="S3.E9.m1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.2.3.1" rspace="0em" xref="S3.E9.m1.1.1.1.1.1.1.2.3.1.cmml">∂</mo><msup id="S3.E9.m1.1.1.1.1.1.1.2.3.2" xref="S3.E9.m1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.2.3.2.2" xref="S3.E9.m1.1.1.1.1.1.1.2.3.2.2.cmml">ξ</mi><mn id="S3.E9.m1.1.1.1.1.1.1.2.3.2.3" xref="S3.E9.m1.1.1.1.1.1.1.2.3.2.3.cmml">2</mn></msup></mrow></mfrac><mo id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml">+</mo><mfrac id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.3.2.cmml"><msup id="S3.E9.m1.1.1.1.1.1.1.3.2.1" xref="S3.E9.m1.1.1.1.1.1.1.3.2.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.3.2.1.2" xref="S3.E9.m1.1.1.1.1.1.1.3.2.1.2.cmml">∂</mo><mn id="S3.E9.m1.1.1.1.1.1.1.3.2.1.3" xref="S3.E9.m1.1.1.1.1.1.1.3.2.1.3.cmml">2</mn></msup><mi id="S3.E9.m1.1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.1.1.3.2.2.cmml">θ</mi></mrow><mrow id="S3.E9.m1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.3.3.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="S3.E9.m1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><msup id="S3.E9.m1.1.1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.3.3.2.2" xref="S3.E9.m1.1.1.1.1.1.1.3.3.2.2.cmml">η</mi><mn id="S3.E9.m1.1.1.1.1.1.1.3.3.2.3" xref="S3.E9.m1.1.1.1.1.1.1.3.3.2.3.cmml">2</mn></msup></mrow></mfrac></mrow><mo id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><eq id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2"></eq><apply id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3"><divide id="S3.E9.m1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.3"></divide><apply id="S3.E9.m1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.3.2"><partialdiff id="S3.E9.m1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.3.2.1"></partialdiff><ci id="S3.E9.m1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.3.2.2">𝜃</ci></apply><apply id="S3.E9.m1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.3.3"><partialdiff id="S3.E9.m1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.3.3.1"></partialdiff><ci id="S3.E9.m1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.3.3.2">𝜏</ci></apply></apply><apply id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><times id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.2"></times><ci id="S3.E9.m1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.3">𝛽</ci><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><plus id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2"><divide id="S3.E9.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2"></divide><apply id="S3.E9.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.2"><apply id="S3.E9.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.2.1">superscript</csymbol><partialdiff id="S3.E9.m1.1.1.1.1.1.1.2.2.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.2.1.2"></partialdiff><cn id="S3.E9.m1.1.1.1.1.1.1.2.2.1.3.cmml" type="integer" xref="S3.E9.m1.1.1.1.1.1.1.2.2.1.3">2</cn></apply><ci id="S3.E9.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.2.2">𝜃</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3"><partialdiff id="S3.E9.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3.1"></partialdiff><apply id="S3.E9.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3.2">superscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3.2.2">𝜉</ci><cn id="S3.E9.m1.1.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E9.m1.1.1.1.1.1.1.2.3.2.3">2</cn></apply></apply></apply><apply id="S3.E9.m1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3"><divide id="S3.E9.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3"></divide><apply id="S3.E9.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2"><apply id="S3.E9.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.3.2.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2.1">superscript</csymbol><partialdiff id="S3.E9.m1.1.1.1.1.1.1.3.2.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2.1.2"></partialdiff><cn id="S3.E9.m1.1.1.1.1.1.1.3.2.1.3.cmml" type="integer" xref="S3.E9.m1.1.1.1.1.1.1.3.2.1.3">2</cn></apply><ci id="S3.E9.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2.2">𝜃</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3"><partialdiff id="S3.E9.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3.1"></partialdiff><apply id="S3.E9.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3.2">superscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3.2.2">𝜂</ci><cn id="S3.E9.m1.1.1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="S3.E9.m1.1.1.1.1.1.1.3.3.2.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\frac{\partial\theta}{\partial\tau}=\beta\left(\frac{\partial^{2}\theta}{%
\partial\xi^{2}}+\frac{\partial^{2}\theta}{\partial\eta^{2}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">divide start_ARG ∂ italic_θ end_ARG start_ARG ∂ italic_τ end_ARG = italic_β ( divide start_ARG ∂ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_θ end_ARG start_ARG ∂ italic_ξ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG + divide start_ARG ∂ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_θ end_ARG start_ARG ∂ italic_η start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.6">where <math alttext="\theta=\frac{T-T_{\text{ref}}}{T_{0}}" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><mrow id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.2.cmml">θ</mi><mo id="S3.SS4.p3.1.m1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.cmml">=</mo><mfrac id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3.cmml"><mrow id="S3.SS4.p3.1.m1.1.1.3.2" xref="S3.SS4.p3.1.m1.1.1.3.2.cmml"><mi id="S3.SS4.p3.1.m1.1.1.3.2.2" xref="S3.SS4.p3.1.m1.1.1.3.2.2.cmml">T</mi><mo id="S3.SS4.p3.1.m1.1.1.3.2.1" xref="S3.SS4.p3.1.m1.1.1.3.2.1.cmml">−</mo><msub id="S3.SS4.p3.1.m1.1.1.3.2.3" xref="S3.SS4.p3.1.m1.1.1.3.2.3.cmml"><mi id="S3.SS4.p3.1.m1.1.1.3.2.3.2" xref="S3.SS4.p3.1.m1.1.1.3.2.3.2.cmml">T</mi><mtext id="S3.SS4.p3.1.m1.1.1.3.2.3.3" xref="S3.SS4.p3.1.m1.1.1.3.2.3.3a.cmml">ref</mtext></msub></mrow><msub id="S3.SS4.p3.1.m1.1.1.3.3" xref="S3.SS4.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS4.p3.1.m1.1.1.3.3.2" xref="S3.SS4.p3.1.m1.1.1.3.3.2.cmml">T</mi><mn id="S3.SS4.p3.1.m1.1.1.3.3.3" xref="S3.SS4.p3.1.m1.1.1.3.3.3.cmml">0</mn></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><eq id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1"></eq><ci id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2">𝜃</ci><apply id="S3.SS4.p3.1.m1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3"><divide id="S3.SS4.p3.1.m1.1.1.3.1.cmml" xref="S3.SS4.p3.1.m1.1.1.3"></divide><apply id="S3.SS4.p3.1.m1.1.1.3.2.cmml" xref="S3.SS4.p3.1.m1.1.1.3.2"><minus id="S3.SS4.p3.1.m1.1.1.3.2.1.cmml" xref="S3.SS4.p3.1.m1.1.1.3.2.1"></minus><ci id="S3.SS4.p3.1.m1.1.1.3.2.2.cmml" xref="S3.SS4.p3.1.m1.1.1.3.2.2">𝑇</ci><apply id="S3.SS4.p3.1.m1.1.1.3.2.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.3.2.3.1.cmml" xref="S3.SS4.p3.1.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.3.2.3.2.cmml" xref="S3.SS4.p3.1.m1.1.1.3.2.3.2">𝑇</ci><ci id="S3.SS4.p3.1.m1.1.1.3.2.3.3a.cmml" xref="S3.SS4.p3.1.m1.1.1.3.2.3.3"><mtext id="S3.SS4.p3.1.m1.1.1.3.2.3.3.cmml" mathsize="50%" xref="S3.SS4.p3.1.m1.1.1.3.2.3.3">ref</mtext></ci></apply></apply><apply id="S3.SS4.p3.1.m1.1.1.3.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS4.p3.1.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS4.p3.1.m1.1.1.3.3.2">𝑇</ci><cn id="S3.SS4.p3.1.m1.1.1.3.3.3.cmml" type="integer" xref="S3.SS4.p3.1.m1.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\theta=\frac{T-T_{\text{ref}}}{T_{0}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_θ = divide start_ARG italic_T - italic_T start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT end_ARG start_ARG italic_T start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> is the non-dimensional temperature, <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><mi id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><ci id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">italic_τ</annotation></semantics></math> is the non-dimensional time, and <math alttext="\xi" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.1"><semantics id="S3.SS4.p3.3.m3.1a"><mi id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><ci id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">\xi</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m3.1d">italic_ξ</annotation></semantics></math>, <math alttext="\eta" class="ltx_Math" display="inline" id="S3.SS4.p3.4.m4.1"><semantics id="S3.SS4.p3.4.m4.1a"><mi id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><ci id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.4.m4.1d">italic_η</annotation></semantics></math> are the non-dimensional spatial coordinates corresponding to <math alttext="x" class="ltx_Math" display="inline" id="S3.SS4.p3.5.m5.1"><semantics id="S3.SS4.p3.5.m5.1a"><mi id="S3.SS4.p3.5.m5.1.1" xref="S3.SS4.p3.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.1b"><ci id="S3.SS4.p3.5.m5.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.5.m5.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S3.SS4.p3.6.m6.1"><semantics id="S3.SS4.p3.6.m6.1a"><mi id="S3.SS4.p3.6.m6.1.1" xref="S3.SS4.p3.6.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m6.1b"><ci id="S3.SS4.p3.6.m6.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.6.m6.1d">italic_y</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.6">The spatial domain, a rectangular plate, is discretized into a uniform grid with <math alttext="N_{\xi}" class="ltx_Math" display="inline" id="S3.SS4.p4.1.m1.1"><semantics id="S3.SS4.p4.1.m1.1a"><msub id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">N</mi><mi id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml">ξ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">𝑁</ci><ci id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3">𝜉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">N_{\xi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_ξ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="N_{\eta}" class="ltx_Math" display="inline" id="S3.SS4.p4.2.m2.1"><semantics id="S3.SS4.p4.2.m2.1a"><msub id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml"><mi id="S3.SS4.p4.2.m2.1.1.2" xref="S3.SS4.p4.2.m2.1.1.2.cmml">N</mi><mi id="S3.SS4.p4.2.m2.1.1.3" xref="S3.SS4.p4.2.m2.1.1.3.cmml">η</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><apply id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p4.2.m2.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2">𝑁</ci><ci id="S3.SS4.p4.2.m2.1.1.3.cmml" xref="S3.SS4.p4.2.m2.1.1.3">𝜂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">N_{\eta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_η end_POSTSUBSCRIPT</annotation></semantics></math> nodes along the <math alttext="\xi" class="ltx_Math" display="inline" id="S3.SS4.p4.3.m3.1"><semantics id="S3.SS4.p4.3.m3.1a"><mi id="S3.SS4.p4.3.m3.1.1" xref="S3.SS4.p4.3.m3.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b"><ci id="S3.SS4.p4.3.m3.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">\xi</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.3.m3.1d">italic_ξ</annotation></semantics></math> and <math alttext="\eta" class="ltx_Math" display="inline" id="S3.SS4.p4.4.m4.1"><semantics id="S3.SS4.p4.4.m4.1a"><mi id="S3.SS4.p4.4.m4.1.1" xref="S3.SS4.p4.4.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m4.1b"><ci id="S3.SS4.p4.4.m4.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m4.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.4.m4.1d">italic_η</annotation></semantics></math> directions, respectively. The grid spacing is <math alttext="\Delta\xi=\frac{1}{N_{\xi}-1}" class="ltx_Math" display="inline" id="S3.SS4.p4.5.m5.1"><semantics id="S3.SS4.p4.5.m5.1a"><mrow id="S3.SS4.p4.5.m5.1.1" xref="S3.SS4.p4.5.m5.1.1.cmml"><mrow id="S3.SS4.p4.5.m5.1.1.2" xref="S3.SS4.p4.5.m5.1.1.2.cmml"><mi id="S3.SS4.p4.5.m5.1.1.2.2" mathvariant="normal" xref="S3.SS4.p4.5.m5.1.1.2.2.cmml">Δ</mi><mo id="S3.SS4.p4.5.m5.1.1.2.1" xref="S3.SS4.p4.5.m5.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p4.5.m5.1.1.2.3" xref="S3.SS4.p4.5.m5.1.1.2.3.cmml">ξ</mi></mrow><mo id="S3.SS4.p4.5.m5.1.1.1" xref="S3.SS4.p4.5.m5.1.1.1.cmml">=</mo><mfrac id="S3.SS4.p4.5.m5.1.1.3" xref="S3.SS4.p4.5.m5.1.1.3.cmml"><mn id="S3.SS4.p4.5.m5.1.1.3.2" xref="S3.SS4.p4.5.m5.1.1.3.2.cmml">1</mn><mrow id="S3.SS4.p4.5.m5.1.1.3.3" xref="S3.SS4.p4.5.m5.1.1.3.3.cmml"><msub id="S3.SS4.p4.5.m5.1.1.3.3.2" xref="S3.SS4.p4.5.m5.1.1.3.3.2.cmml"><mi id="S3.SS4.p4.5.m5.1.1.3.3.2.2" xref="S3.SS4.p4.5.m5.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS4.p4.5.m5.1.1.3.3.2.3" xref="S3.SS4.p4.5.m5.1.1.3.3.2.3.cmml">ξ</mi></msub><mo id="S3.SS4.p4.5.m5.1.1.3.3.1" xref="S3.SS4.p4.5.m5.1.1.3.3.1.cmml">−</mo><mn id="S3.SS4.p4.5.m5.1.1.3.3.3" xref="S3.SS4.p4.5.m5.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m5.1b"><apply id="S3.SS4.p4.5.m5.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1"><eq id="S3.SS4.p4.5.m5.1.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1.1"></eq><apply id="S3.SS4.p4.5.m5.1.1.2.cmml" xref="S3.SS4.p4.5.m5.1.1.2"><times id="S3.SS4.p4.5.m5.1.1.2.1.cmml" xref="S3.SS4.p4.5.m5.1.1.2.1"></times><ci id="S3.SS4.p4.5.m5.1.1.2.2.cmml" xref="S3.SS4.p4.5.m5.1.1.2.2">Δ</ci><ci id="S3.SS4.p4.5.m5.1.1.2.3.cmml" xref="S3.SS4.p4.5.m5.1.1.2.3">𝜉</ci></apply><apply id="S3.SS4.p4.5.m5.1.1.3.cmml" xref="S3.SS4.p4.5.m5.1.1.3"><divide id="S3.SS4.p4.5.m5.1.1.3.1.cmml" xref="S3.SS4.p4.5.m5.1.1.3"></divide><cn id="S3.SS4.p4.5.m5.1.1.3.2.cmml" type="integer" xref="S3.SS4.p4.5.m5.1.1.3.2">1</cn><apply id="S3.SS4.p4.5.m5.1.1.3.3.cmml" xref="S3.SS4.p4.5.m5.1.1.3.3"><minus id="S3.SS4.p4.5.m5.1.1.3.3.1.cmml" xref="S3.SS4.p4.5.m5.1.1.3.3.1"></minus><apply id="S3.SS4.p4.5.m5.1.1.3.3.2.cmml" xref="S3.SS4.p4.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m5.1.1.3.3.2.1.cmml" xref="S3.SS4.p4.5.m5.1.1.3.3.2">subscript</csymbol><ci id="S3.SS4.p4.5.m5.1.1.3.3.2.2.cmml" xref="S3.SS4.p4.5.m5.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS4.p4.5.m5.1.1.3.3.2.3.cmml" xref="S3.SS4.p4.5.m5.1.1.3.3.2.3">𝜉</ci></apply><cn id="S3.SS4.p4.5.m5.1.1.3.3.3.cmml" type="integer" xref="S3.SS4.p4.5.m5.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m5.1c">\Delta\xi=\frac{1}{N_{\xi}-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.5.m5.1d">roman_Δ italic_ξ = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_ξ end_POSTSUBSCRIPT - 1 end_ARG</annotation></semantics></math> and <math alttext="\Delta\eta=\frac{1}{N_{\eta}-1}" class="ltx_Math" display="inline" id="S3.SS4.p4.6.m6.1"><semantics id="S3.SS4.p4.6.m6.1a"><mrow id="S3.SS4.p4.6.m6.1.1" xref="S3.SS4.p4.6.m6.1.1.cmml"><mrow id="S3.SS4.p4.6.m6.1.1.2" xref="S3.SS4.p4.6.m6.1.1.2.cmml"><mi id="S3.SS4.p4.6.m6.1.1.2.2" mathvariant="normal" xref="S3.SS4.p4.6.m6.1.1.2.2.cmml">Δ</mi><mo id="S3.SS4.p4.6.m6.1.1.2.1" xref="S3.SS4.p4.6.m6.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p4.6.m6.1.1.2.3" xref="S3.SS4.p4.6.m6.1.1.2.3.cmml">η</mi></mrow><mo id="S3.SS4.p4.6.m6.1.1.1" xref="S3.SS4.p4.6.m6.1.1.1.cmml">=</mo><mfrac id="S3.SS4.p4.6.m6.1.1.3" xref="S3.SS4.p4.6.m6.1.1.3.cmml"><mn id="S3.SS4.p4.6.m6.1.1.3.2" xref="S3.SS4.p4.6.m6.1.1.3.2.cmml">1</mn><mrow id="S3.SS4.p4.6.m6.1.1.3.3" xref="S3.SS4.p4.6.m6.1.1.3.3.cmml"><msub id="S3.SS4.p4.6.m6.1.1.3.3.2" xref="S3.SS4.p4.6.m6.1.1.3.3.2.cmml"><mi id="S3.SS4.p4.6.m6.1.1.3.3.2.2" xref="S3.SS4.p4.6.m6.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS4.p4.6.m6.1.1.3.3.2.3" xref="S3.SS4.p4.6.m6.1.1.3.3.2.3.cmml">η</mi></msub><mo id="S3.SS4.p4.6.m6.1.1.3.3.1" xref="S3.SS4.p4.6.m6.1.1.3.3.1.cmml">−</mo><mn id="S3.SS4.p4.6.m6.1.1.3.3.3" xref="S3.SS4.p4.6.m6.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.6.m6.1b"><apply id="S3.SS4.p4.6.m6.1.1.cmml" xref="S3.SS4.p4.6.m6.1.1"><eq id="S3.SS4.p4.6.m6.1.1.1.cmml" xref="S3.SS4.p4.6.m6.1.1.1"></eq><apply id="S3.SS4.p4.6.m6.1.1.2.cmml" xref="S3.SS4.p4.6.m6.1.1.2"><times id="S3.SS4.p4.6.m6.1.1.2.1.cmml" xref="S3.SS4.p4.6.m6.1.1.2.1"></times><ci id="S3.SS4.p4.6.m6.1.1.2.2.cmml" xref="S3.SS4.p4.6.m6.1.1.2.2">Δ</ci><ci id="S3.SS4.p4.6.m6.1.1.2.3.cmml" xref="S3.SS4.p4.6.m6.1.1.2.3">𝜂</ci></apply><apply id="S3.SS4.p4.6.m6.1.1.3.cmml" xref="S3.SS4.p4.6.m6.1.1.3"><divide id="S3.SS4.p4.6.m6.1.1.3.1.cmml" xref="S3.SS4.p4.6.m6.1.1.3"></divide><cn id="S3.SS4.p4.6.m6.1.1.3.2.cmml" type="integer" xref="S3.SS4.p4.6.m6.1.1.3.2">1</cn><apply id="S3.SS4.p4.6.m6.1.1.3.3.cmml" xref="S3.SS4.p4.6.m6.1.1.3.3"><minus id="S3.SS4.p4.6.m6.1.1.3.3.1.cmml" xref="S3.SS4.p4.6.m6.1.1.3.3.1"></minus><apply id="S3.SS4.p4.6.m6.1.1.3.3.2.cmml" xref="S3.SS4.p4.6.m6.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS4.p4.6.m6.1.1.3.3.2.1.cmml" xref="S3.SS4.p4.6.m6.1.1.3.3.2">subscript</csymbol><ci id="S3.SS4.p4.6.m6.1.1.3.3.2.2.cmml" xref="S3.SS4.p4.6.m6.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS4.p4.6.m6.1.1.3.3.2.3.cmml" xref="S3.SS4.p4.6.m6.1.1.3.3.2.3">𝜂</ci></apply><cn id="S3.SS4.p4.6.m6.1.1.3.3.3.cmml" type="integer" xref="S3.SS4.p4.6.m6.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.6.m6.1c">\Delta\eta=\frac{1}{N_{\eta}-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.6.m6.1d">roman_Δ italic_η = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_η end_POSTSUBSCRIPT - 1 end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS4.p5">
<p class="ltx_p" id="S3.SS4.p5.1">The central finite difference method is used to approximate the spatial derivatives. The second-order derivatives are approximated as follows,</p>
</div>
<div class="ltx_para" id="S3.SS4.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\frac{\partial^{2}\theta}{\partial\xi^{2}}\approx\frac{\theta_{i+1,j}-2\,%
\theta_{i,j}+\theta_{i-1,j}}{(\Delta\xi)^{2}}" class="ltx_Math" display="block" id="S3.E10.m1.7"><semantics id="S3.E10.m1.7a"><mrow id="S3.E10.m1.7.8" xref="S3.E10.m1.7.8.cmml"><mfrac id="S3.E10.m1.7.8.2" xref="S3.E10.m1.7.8.2.cmml"><mrow id="S3.E10.m1.7.8.2.2" xref="S3.E10.m1.7.8.2.2.cmml"><msup id="S3.E10.m1.7.8.2.2.1" xref="S3.E10.m1.7.8.2.2.1.cmml"><mo id="S3.E10.m1.7.8.2.2.1.2" xref="S3.E10.m1.7.8.2.2.1.2.cmml">∂</mo><mn id="S3.E10.m1.7.8.2.2.1.3" xref="S3.E10.m1.7.8.2.2.1.3.cmml">2</mn></msup><mi id="S3.E10.m1.7.8.2.2.2" xref="S3.E10.m1.7.8.2.2.2.cmml">θ</mi></mrow><mrow id="S3.E10.m1.7.8.2.3" xref="S3.E10.m1.7.8.2.3.cmml"><mo id="S3.E10.m1.7.8.2.3.1" rspace="0em" xref="S3.E10.m1.7.8.2.3.1.cmml">∂</mo><msup id="S3.E10.m1.7.8.2.3.2" xref="S3.E10.m1.7.8.2.3.2.cmml"><mi id="S3.E10.m1.7.8.2.3.2.2" xref="S3.E10.m1.7.8.2.3.2.2.cmml">ξ</mi><mn id="S3.E10.m1.7.8.2.3.2.3" xref="S3.E10.m1.7.8.2.3.2.3.cmml">2</mn></msup></mrow></mfrac><mo id="S3.E10.m1.7.8.1" xref="S3.E10.m1.7.8.1.cmml">≈</mo><mfrac id="S3.E10.m1.7.7" xref="S3.E10.m1.7.7.cmml"><mrow id="S3.E10.m1.6.6.6" xref="S3.E10.m1.6.6.6.cmml"><mrow id="S3.E10.m1.6.6.6.8" xref="S3.E10.m1.6.6.6.8.cmml"><msub id="S3.E10.m1.6.6.6.8.2" xref="S3.E10.m1.6.6.6.8.2.cmml"><mi id="S3.E10.m1.6.6.6.8.2.2" xref="S3.E10.m1.6.6.6.8.2.2.cmml">θ</mi><mrow id="S3.E10.m1.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.3.cmml"><mrow id="S3.E10.m1.2.2.2.2.2.2.1" xref="S3.E10.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.1.2" xref="S3.E10.m1.2.2.2.2.2.2.1.2.cmml">i</mi><mo id="S3.E10.m1.2.2.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E10.m1.2.2.2.2.2.2.1.3" xref="S3.E10.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E10.m1.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml">j</mi></mrow></msub><mo id="S3.E10.m1.6.6.6.8.1" xref="S3.E10.m1.6.6.6.8.1.cmml">−</mo><mrow id="S3.E10.m1.6.6.6.8.3" xref="S3.E10.m1.6.6.6.8.3.cmml"><mn id="S3.E10.m1.6.6.6.8.3.2" xref="S3.E10.m1.6.6.6.8.3.2.cmml">2</mn><mo id="S3.E10.m1.6.6.6.8.3.1" lspace="0.170em" xref="S3.E10.m1.6.6.6.8.3.1.cmml">⁢</mo><msub id="S3.E10.m1.6.6.6.8.3.3" xref="S3.E10.m1.6.6.6.8.3.3.cmml"><mi id="S3.E10.m1.6.6.6.8.3.3.2" xref="S3.E10.m1.6.6.6.8.3.3.2.cmml">θ</mi><mrow id="S3.E10.m1.4.4.4.4.2.4" xref="S3.E10.m1.4.4.4.4.2.3.cmml"><mi id="S3.E10.m1.3.3.3.3.1.1" xref="S3.E10.m1.3.3.3.3.1.1.cmml">i</mi><mo id="S3.E10.m1.4.4.4.4.2.4.1" xref="S3.E10.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E10.m1.4.4.4.4.2.2" xref="S3.E10.m1.4.4.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S3.E10.m1.6.6.6.7" xref="S3.E10.m1.6.6.6.7.cmml">+</mo><msub id="S3.E10.m1.6.6.6.9" xref="S3.E10.m1.6.6.6.9.cmml"><mi id="S3.E10.m1.6.6.6.9.2" xref="S3.E10.m1.6.6.6.9.2.cmml">θ</mi><mrow id="S3.E10.m1.6.6.6.6.2.2" xref="S3.E10.m1.6.6.6.6.2.3.cmml"><mrow id="S3.E10.m1.6.6.6.6.2.2.1" xref="S3.E10.m1.6.6.6.6.2.2.1.cmml"><mi id="S3.E10.m1.6.6.6.6.2.2.1.2" xref="S3.E10.m1.6.6.6.6.2.2.1.2.cmml">i</mi><mo id="S3.E10.m1.6.6.6.6.2.2.1.1" xref="S3.E10.m1.6.6.6.6.2.2.1.1.cmml">−</mo><mn id="S3.E10.m1.6.6.6.6.2.2.1.3" xref="S3.E10.m1.6.6.6.6.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E10.m1.6.6.6.6.2.2.2" xref="S3.E10.m1.6.6.6.6.2.3.cmml">,</mo><mi id="S3.E10.m1.5.5.5.5.1.1" xref="S3.E10.m1.5.5.5.5.1.1.cmml">j</mi></mrow></msub></mrow><msup id="S3.E10.m1.7.7.7" xref="S3.E10.m1.7.7.7.cmml"><mrow id="S3.E10.m1.7.7.7.1.1" xref="S3.E10.m1.7.7.7.1.1.1.cmml"><mo id="S3.E10.m1.7.7.7.1.1.2" stretchy="false" xref="S3.E10.m1.7.7.7.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.7.7.7.1.1.1" xref="S3.E10.m1.7.7.7.1.1.1.cmml"><mi id="S3.E10.m1.7.7.7.1.1.1.2" mathvariant="normal" xref="S3.E10.m1.7.7.7.1.1.1.2.cmml">Δ</mi><mo id="S3.E10.m1.7.7.7.1.1.1.1" xref="S3.E10.m1.7.7.7.1.1.1.1.cmml">⁢</mo><mi id="S3.E10.m1.7.7.7.1.1.1.3" xref="S3.E10.m1.7.7.7.1.1.1.3.cmml">ξ</mi></mrow><mo id="S3.E10.m1.7.7.7.1.1.3" stretchy="false" xref="S3.E10.m1.7.7.7.1.1.1.cmml">)</mo></mrow><mn id="S3.E10.m1.7.7.7.3" xref="S3.E10.m1.7.7.7.3.cmml">2</mn></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.7b"><apply id="S3.E10.m1.7.8.cmml" xref="S3.E10.m1.7.8"><approx id="S3.E10.m1.7.8.1.cmml" xref="S3.E10.m1.7.8.1"></approx><apply id="S3.E10.m1.7.8.2.cmml" xref="S3.E10.m1.7.8.2"><divide id="S3.E10.m1.7.8.2.1.cmml" xref="S3.E10.m1.7.8.2"></divide><apply id="S3.E10.m1.7.8.2.2.cmml" xref="S3.E10.m1.7.8.2.2"><apply id="S3.E10.m1.7.8.2.2.1.cmml" xref="S3.E10.m1.7.8.2.2.1"><csymbol cd="ambiguous" id="S3.E10.m1.7.8.2.2.1.1.cmml" xref="S3.E10.m1.7.8.2.2.1">superscript</csymbol><partialdiff id="S3.E10.m1.7.8.2.2.1.2.cmml" xref="S3.E10.m1.7.8.2.2.1.2"></partialdiff><cn id="S3.E10.m1.7.8.2.2.1.3.cmml" type="integer" xref="S3.E10.m1.7.8.2.2.1.3">2</cn></apply><ci id="S3.E10.m1.7.8.2.2.2.cmml" xref="S3.E10.m1.7.8.2.2.2">𝜃</ci></apply><apply id="S3.E10.m1.7.8.2.3.cmml" xref="S3.E10.m1.7.8.2.3"><partialdiff id="S3.E10.m1.7.8.2.3.1.cmml" xref="S3.E10.m1.7.8.2.3.1"></partialdiff><apply id="S3.E10.m1.7.8.2.3.2.cmml" xref="S3.E10.m1.7.8.2.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.7.8.2.3.2.1.cmml" xref="S3.E10.m1.7.8.2.3.2">superscript</csymbol><ci id="S3.E10.m1.7.8.2.3.2.2.cmml" xref="S3.E10.m1.7.8.2.3.2.2">𝜉</ci><cn id="S3.E10.m1.7.8.2.3.2.3.cmml" type="integer" xref="S3.E10.m1.7.8.2.3.2.3">2</cn></apply></apply></apply><apply id="S3.E10.m1.7.7.cmml" xref="S3.E10.m1.7.7"><divide id="S3.E10.m1.7.7.8.cmml" xref="S3.E10.m1.7.7"></divide><apply id="S3.E10.m1.6.6.6.cmml" xref="S3.E10.m1.6.6.6"><plus id="S3.E10.m1.6.6.6.7.cmml" xref="S3.E10.m1.6.6.6.7"></plus><apply id="S3.E10.m1.6.6.6.8.cmml" xref="S3.E10.m1.6.6.6.8"><minus id="S3.E10.m1.6.6.6.8.1.cmml" xref="S3.E10.m1.6.6.6.8.1"></minus><apply id="S3.E10.m1.6.6.6.8.2.cmml" xref="S3.E10.m1.6.6.6.8.2"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.6.8.2.1.cmml" xref="S3.E10.m1.6.6.6.8.2">subscript</csymbol><ci id="S3.E10.m1.6.6.6.8.2.2.cmml" xref="S3.E10.m1.6.6.6.8.2.2">𝜃</ci><list id="S3.E10.m1.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2"><apply id="S3.E10.m1.2.2.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1"><plus id="S3.E10.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1"></plus><ci id="S3.E10.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.2">𝑖</ci><cn id="S3.E10.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E10.m1.2.2.2.2.2.2.1.3">1</cn></apply><ci id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1">𝑗</ci></list></apply><apply id="S3.E10.m1.6.6.6.8.3.cmml" xref="S3.E10.m1.6.6.6.8.3"><times id="S3.E10.m1.6.6.6.8.3.1.cmml" xref="S3.E10.m1.6.6.6.8.3.1"></times><cn id="S3.E10.m1.6.6.6.8.3.2.cmml" type="integer" xref="S3.E10.m1.6.6.6.8.3.2">2</cn><apply id="S3.E10.m1.6.6.6.8.3.3.cmml" xref="S3.E10.m1.6.6.6.8.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.6.8.3.3.1.cmml" xref="S3.E10.m1.6.6.6.8.3.3">subscript</csymbol><ci id="S3.E10.m1.6.6.6.8.3.3.2.cmml" xref="S3.E10.m1.6.6.6.8.3.3.2">𝜃</ci><list id="S3.E10.m1.4.4.4.4.2.3.cmml" xref="S3.E10.m1.4.4.4.4.2.4"><ci id="S3.E10.m1.3.3.3.3.1.1.cmml" xref="S3.E10.m1.3.3.3.3.1.1">𝑖</ci><ci id="S3.E10.m1.4.4.4.4.2.2.cmml" xref="S3.E10.m1.4.4.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.E10.m1.6.6.6.9.cmml" xref="S3.E10.m1.6.6.6.9"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.6.9.1.cmml" xref="S3.E10.m1.6.6.6.9">subscript</csymbol><ci id="S3.E10.m1.6.6.6.9.2.cmml" xref="S3.E10.m1.6.6.6.9.2">𝜃</ci><list id="S3.E10.m1.6.6.6.6.2.3.cmml" xref="S3.E10.m1.6.6.6.6.2.2"><apply id="S3.E10.m1.6.6.6.6.2.2.1.cmml" xref="S3.E10.m1.6.6.6.6.2.2.1"><minus id="S3.E10.m1.6.6.6.6.2.2.1.1.cmml" xref="S3.E10.m1.6.6.6.6.2.2.1.1"></minus><ci id="S3.E10.m1.6.6.6.6.2.2.1.2.cmml" xref="S3.E10.m1.6.6.6.6.2.2.1.2">𝑖</ci><cn id="S3.E10.m1.6.6.6.6.2.2.1.3.cmml" type="integer" xref="S3.E10.m1.6.6.6.6.2.2.1.3">1</cn></apply><ci id="S3.E10.m1.5.5.5.5.1.1.cmml" xref="S3.E10.m1.5.5.5.5.1.1">𝑗</ci></list></apply></apply><apply id="S3.E10.m1.7.7.7.cmml" xref="S3.E10.m1.7.7.7"><csymbol cd="ambiguous" id="S3.E10.m1.7.7.7.2.cmml" xref="S3.E10.m1.7.7.7">superscript</csymbol><apply id="S3.E10.m1.7.7.7.1.1.1.cmml" xref="S3.E10.m1.7.7.7.1.1"><times id="S3.E10.m1.7.7.7.1.1.1.1.cmml" xref="S3.E10.m1.7.7.7.1.1.1.1"></times><ci id="S3.E10.m1.7.7.7.1.1.1.2.cmml" xref="S3.E10.m1.7.7.7.1.1.1.2">Δ</ci><ci id="S3.E10.m1.7.7.7.1.1.1.3.cmml" xref="S3.E10.m1.7.7.7.1.1.1.3">𝜉</ci></apply><cn id="S3.E10.m1.7.7.7.3.cmml" type="integer" xref="S3.E10.m1.7.7.7.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.7c">\frac{\partial^{2}\theta}{\partial\xi^{2}}\approx\frac{\theta_{i+1,j}-2\,%
\theta_{i,j}+\theta_{i-1,j}}{(\Delta\xi)^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.7d">divide start_ARG ∂ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_θ end_ARG start_ARG ∂ italic_ξ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ≈ divide start_ARG italic_θ start_POSTSUBSCRIPT italic_i + 1 , italic_j end_POSTSUBSCRIPT - 2 italic_θ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT + italic_θ start_POSTSUBSCRIPT italic_i - 1 , italic_j end_POSTSUBSCRIPT end_ARG start_ARG ( roman_Δ italic_ξ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\frac{\partial^{2}\theta}{\partial\eta^{2}}\approx\frac{\theta_{i,j+1}-2\,%
\theta_{i,j}+\theta_{i,j-1}}{(\Delta\eta)^{2}}" class="ltx_Math" display="block" id="S3.E11.m1.7"><semantics id="S3.E11.m1.7a"><mrow id="S3.E11.m1.7.8" xref="S3.E11.m1.7.8.cmml"><mfrac id="S3.E11.m1.7.8.2" xref="S3.E11.m1.7.8.2.cmml"><mrow id="S3.E11.m1.7.8.2.2" xref="S3.E11.m1.7.8.2.2.cmml"><msup id="S3.E11.m1.7.8.2.2.1" xref="S3.E11.m1.7.8.2.2.1.cmml"><mo id="S3.E11.m1.7.8.2.2.1.2" xref="S3.E11.m1.7.8.2.2.1.2.cmml">∂</mo><mn id="S3.E11.m1.7.8.2.2.1.3" xref="S3.E11.m1.7.8.2.2.1.3.cmml">2</mn></msup><mi id="S3.E11.m1.7.8.2.2.2" xref="S3.E11.m1.7.8.2.2.2.cmml">θ</mi></mrow><mrow id="S3.E11.m1.7.8.2.3" xref="S3.E11.m1.7.8.2.3.cmml"><mo id="S3.E11.m1.7.8.2.3.1" rspace="0em" xref="S3.E11.m1.7.8.2.3.1.cmml">∂</mo><msup id="S3.E11.m1.7.8.2.3.2" xref="S3.E11.m1.7.8.2.3.2.cmml"><mi id="S3.E11.m1.7.8.2.3.2.2" xref="S3.E11.m1.7.8.2.3.2.2.cmml">η</mi><mn id="S3.E11.m1.7.8.2.3.2.3" xref="S3.E11.m1.7.8.2.3.2.3.cmml">2</mn></msup></mrow></mfrac><mo id="S3.E11.m1.7.8.1" xref="S3.E11.m1.7.8.1.cmml">≈</mo><mfrac id="S3.E11.m1.7.7" xref="S3.E11.m1.7.7.cmml"><mrow id="S3.E11.m1.6.6.6" xref="S3.E11.m1.6.6.6.cmml"><mrow id="S3.E11.m1.6.6.6.8" xref="S3.E11.m1.6.6.6.8.cmml"><msub id="S3.E11.m1.6.6.6.8.2" xref="S3.E11.m1.6.6.6.8.2.cmml"><mi id="S3.E11.m1.6.6.6.8.2.2" xref="S3.E11.m1.6.6.6.8.2.2.cmml">θ</mi><mrow id="S3.E11.m1.2.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E11.m1.2.2.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.3.cmml">,</mo><mrow id="S3.E11.m1.2.2.2.2.2.2.1" xref="S3.E11.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E11.m1.2.2.2.2.2.2.1.2" xref="S3.E11.m1.2.2.2.2.2.2.1.2.cmml">j</mi><mo id="S3.E11.m1.2.2.2.2.2.2.1.1" xref="S3.E11.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E11.m1.2.2.2.2.2.2.1.3" xref="S3.E11.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S3.E11.m1.6.6.6.8.1" xref="S3.E11.m1.6.6.6.8.1.cmml">−</mo><mrow id="S3.E11.m1.6.6.6.8.3" xref="S3.E11.m1.6.6.6.8.3.cmml"><mn id="S3.E11.m1.6.6.6.8.3.2" xref="S3.E11.m1.6.6.6.8.3.2.cmml">2</mn><mo id="S3.E11.m1.6.6.6.8.3.1" lspace="0.170em" xref="S3.E11.m1.6.6.6.8.3.1.cmml">⁢</mo><msub id="S3.E11.m1.6.6.6.8.3.3" xref="S3.E11.m1.6.6.6.8.3.3.cmml"><mi id="S3.E11.m1.6.6.6.8.3.3.2" xref="S3.E11.m1.6.6.6.8.3.3.2.cmml">θ</mi><mrow id="S3.E11.m1.4.4.4.4.2.4" xref="S3.E11.m1.4.4.4.4.2.3.cmml"><mi id="S3.E11.m1.3.3.3.3.1.1" xref="S3.E11.m1.3.3.3.3.1.1.cmml">i</mi><mo id="S3.E11.m1.4.4.4.4.2.4.1" xref="S3.E11.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E11.m1.4.4.4.4.2.2" xref="S3.E11.m1.4.4.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S3.E11.m1.6.6.6.7" xref="S3.E11.m1.6.6.6.7.cmml">+</mo><msub id="S3.E11.m1.6.6.6.9" xref="S3.E11.m1.6.6.6.9.cmml"><mi id="S3.E11.m1.6.6.6.9.2" xref="S3.E11.m1.6.6.6.9.2.cmml">θ</mi><mrow id="S3.E11.m1.6.6.6.6.2.2" xref="S3.E11.m1.6.6.6.6.2.3.cmml"><mi id="S3.E11.m1.5.5.5.5.1.1" xref="S3.E11.m1.5.5.5.5.1.1.cmml">i</mi><mo id="S3.E11.m1.6.6.6.6.2.2.2" xref="S3.E11.m1.6.6.6.6.2.3.cmml">,</mo><mrow id="S3.E11.m1.6.6.6.6.2.2.1" xref="S3.E11.m1.6.6.6.6.2.2.1.cmml"><mi id="S3.E11.m1.6.6.6.6.2.2.1.2" xref="S3.E11.m1.6.6.6.6.2.2.1.2.cmml">j</mi><mo id="S3.E11.m1.6.6.6.6.2.2.1.1" xref="S3.E11.m1.6.6.6.6.2.2.1.1.cmml">−</mo><mn id="S3.E11.m1.6.6.6.6.2.2.1.3" xref="S3.E11.m1.6.6.6.6.2.2.1.3.cmml">1</mn></mrow></mrow></msub></mrow><msup id="S3.E11.m1.7.7.7" xref="S3.E11.m1.7.7.7.cmml"><mrow id="S3.E11.m1.7.7.7.1.1" xref="S3.E11.m1.7.7.7.1.1.1.cmml"><mo id="S3.E11.m1.7.7.7.1.1.2" stretchy="false" xref="S3.E11.m1.7.7.7.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.7.7.7.1.1.1" xref="S3.E11.m1.7.7.7.1.1.1.cmml"><mi id="S3.E11.m1.7.7.7.1.1.1.2" mathvariant="normal" xref="S3.E11.m1.7.7.7.1.1.1.2.cmml">Δ</mi><mo id="S3.E11.m1.7.7.7.1.1.1.1" xref="S3.E11.m1.7.7.7.1.1.1.1.cmml">⁢</mo><mi id="S3.E11.m1.7.7.7.1.1.1.3" xref="S3.E11.m1.7.7.7.1.1.1.3.cmml">η</mi></mrow><mo id="S3.E11.m1.7.7.7.1.1.3" stretchy="false" xref="S3.E11.m1.7.7.7.1.1.1.cmml">)</mo></mrow><mn id="S3.E11.m1.7.7.7.3" xref="S3.E11.m1.7.7.7.3.cmml">2</mn></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.7b"><apply id="S3.E11.m1.7.8.cmml" xref="S3.E11.m1.7.8"><approx id="S3.E11.m1.7.8.1.cmml" xref="S3.E11.m1.7.8.1"></approx><apply id="S3.E11.m1.7.8.2.cmml" xref="S3.E11.m1.7.8.2"><divide id="S3.E11.m1.7.8.2.1.cmml" xref="S3.E11.m1.7.8.2"></divide><apply id="S3.E11.m1.7.8.2.2.cmml" xref="S3.E11.m1.7.8.2.2"><apply id="S3.E11.m1.7.8.2.2.1.cmml" xref="S3.E11.m1.7.8.2.2.1"><csymbol cd="ambiguous" id="S3.E11.m1.7.8.2.2.1.1.cmml" xref="S3.E11.m1.7.8.2.2.1">superscript</csymbol><partialdiff id="S3.E11.m1.7.8.2.2.1.2.cmml" xref="S3.E11.m1.7.8.2.2.1.2"></partialdiff><cn id="S3.E11.m1.7.8.2.2.1.3.cmml" type="integer" xref="S3.E11.m1.7.8.2.2.1.3">2</cn></apply><ci id="S3.E11.m1.7.8.2.2.2.cmml" xref="S3.E11.m1.7.8.2.2.2">𝜃</ci></apply><apply id="S3.E11.m1.7.8.2.3.cmml" xref="S3.E11.m1.7.8.2.3"><partialdiff id="S3.E11.m1.7.8.2.3.1.cmml" xref="S3.E11.m1.7.8.2.3.1"></partialdiff><apply id="S3.E11.m1.7.8.2.3.2.cmml" xref="S3.E11.m1.7.8.2.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.7.8.2.3.2.1.cmml" xref="S3.E11.m1.7.8.2.3.2">superscript</csymbol><ci id="S3.E11.m1.7.8.2.3.2.2.cmml" xref="S3.E11.m1.7.8.2.3.2.2">𝜂</ci><cn id="S3.E11.m1.7.8.2.3.2.3.cmml" type="integer" xref="S3.E11.m1.7.8.2.3.2.3">2</cn></apply></apply></apply><apply id="S3.E11.m1.7.7.cmml" xref="S3.E11.m1.7.7"><divide id="S3.E11.m1.7.7.8.cmml" xref="S3.E11.m1.7.7"></divide><apply id="S3.E11.m1.6.6.6.cmml" xref="S3.E11.m1.6.6.6"><plus id="S3.E11.m1.6.6.6.7.cmml" xref="S3.E11.m1.6.6.6.7"></plus><apply id="S3.E11.m1.6.6.6.8.cmml" xref="S3.E11.m1.6.6.6.8"><minus id="S3.E11.m1.6.6.6.8.1.cmml" xref="S3.E11.m1.6.6.6.8.1"></minus><apply id="S3.E11.m1.6.6.6.8.2.cmml" xref="S3.E11.m1.6.6.6.8.2"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.6.8.2.1.cmml" xref="S3.E11.m1.6.6.6.8.2">subscript</csymbol><ci id="S3.E11.m1.6.6.6.8.2.2.cmml" xref="S3.E11.m1.6.6.6.8.2.2">𝜃</ci><list id="S3.E11.m1.2.2.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2.2.2"><ci id="S3.E11.m1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1">𝑖</ci><apply id="S3.E11.m1.2.2.2.2.2.2.1.cmml" xref="S3.E11.m1.2.2.2.2.2.2.1"><plus id="S3.E11.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E11.m1.2.2.2.2.2.2.1.1"></plus><ci id="S3.E11.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E11.m1.2.2.2.2.2.2.1.2">𝑗</ci><cn id="S3.E11.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E11.m1.2.2.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S3.E11.m1.6.6.6.8.3.cmml" xref="S3.E11.m1.6.6.6.8.3"><times id="S3.E11.m1.6.6.6.8.3.1.cmml" xref="S3.E11.m1.6.6.6.8.3.1"></times><cn id="S3.E11.m1.6.6.6.8.3.2.cmml" type="integer" xref="S3.E11.m1.6.6.6.8.3.2">2</cn><apply id="S3.E11.m1.6.6.6.8.3.3.cmml" xref="S3.E11.m1.6.6.6.8.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.6.8.3.3.1.cmml" xref="S3.E11.m1.6.6.6.8.3.3">subscript</csymbol><ci id="S3.E11.m1.6.6.6.8.3.3.2.cmml" xref="S3.E11.m1.6.6.6.8.3.3.2">𝜃</ci><list id="S3.E11.m1.4.4.4.4.2.3.cmml" xref="S3.E11.m1.4.4.4.4.2.4"><ci id="S3.E11.m1.3.3.3.3.1.1.cmml" xref="S3.E11.m1.3.3.3.3.1.1">𝑖</ci><ci id="S3.E11.m1.4.4.4.4.2.2.cmml" xref="S3.E11.m1.4.4.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.E11.m1.6.6.6.9.cmml" xref="S3.E11.m1.6.6.6.9"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.6.9.1.cmml" xref="S3.E11.m1.6.6.6.9">subscript</csymbol><ci id="S3.E11.m1.6.6.6.9.2.cmml" xref="S3.E11.m1.6.6.6.9.2">𝜃</ci><list id="S3.E11.m1.6.6.6.6.2.3.cmml" xref="S3.E11.m1.6.6.6.6.2.2"><ci id="S3.E11.m1.5.5.5.5.1.1.cmml" xref="S3.E11.m1.5.5.5.5.1.1">𝑖</ci><apply id="S3.E11.m1.6.6.6.6.2.2.1.cmml" xref="S3.E11.m1.6.6.6.6.2.2.1"><minus id="S3.E11.m1.6.6.6.6.2.2.1.1.cmml" xref="S3.E11.m1.6.6.6.6.2.2.1.1"></minus><ci id="S3.E11.m1.6.6.6.6.2.2.1.2.cmml" xref="S3.E11.m1.6.6.6.6.2.2.1.2">𝑗</ci><cn id="S3.E11.m1.6.6.6.6.2.2.1.3.cmml" type="integer" xref="S3.E11.m1.6.6.6.6.2.2.1.3">1</cn></apply></list></apply></apply><apply id="S3.E11.m1.7.7.7.cmml" xref="S3.E11.m1.7.7.7"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.7.2.cmml" xref="S3.E11.m1.7.7.7">superscript</csymbol><apply id="S3.E11.m1.7.7.7.1.1.1.cmml" xref="S3.E11.m1.7.7.7.1.1"><times id="S3.E11.m1.7.7.7.1.1.1.1.cmml" xref="S3.E11.m1.7.7.7.1.1.1.1"></times><ci id="S3.E11.m1.7.7.7.1.1.1.2.cmml" xref="S3.E11.m1.7.7.7.1.1.1.2">Δ</ci><ci id="S3.E11.m1.7.7.7.1.1.1.3.cmml" xref="S3.E11.m1.7.7.7.1.1.1.3">𝜂</ci></apply><cn id="S3.E11.m1.7.7.7.3.cmml" type="integer" xref="S3.E11.m1.7.7.7.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.7c">\frac{\partial^{2}\theta}{\partial\eta^{2}}\approx\frac{\theta_{i,j+1}-2\,%
\theta_{i,j}+\theta_{i,j-1}}{(\Delta\eta)^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.7d">divide start_ARG ∂ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_θ end_ARG start_ARG ∂ italic_η start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ≈ divide start_ARG italic_θ start_POSTSUBSCRIPT italic_i , italic_j + 1 end_POSTSUBSCRIPT - 2 italic_θ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT + italic_θ start_POSTSUBSCRIPT italic_i , italic_j - 1 end_POSTSUBSCRIPT end_ARG start_ARG ( roman_Δ italic_η ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p8">
<p class="ltx_p" id="S3.SS4.p8.1">Combining these, the non-dimensional heat conduction equation in discrete form is,</p>
</div>
<div class="ltx_para" id="S3.SS4.p9">
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\frac{d\theta_{i,j}}{d\tau}=\beta\left(\frac{\theta_{i+1,j}-2\,\theta_{i,j}+%
\theta_{i-1,j}}{(\Delta\xi)^{2}}+\frac{\theta_{i,j+1}-2\,\theta_{i,j}+\theta_{%
i,j-1}}{(\Delta\eta)^{2}}\right)" class="ltx_Math" display="block" id="S3.E12.m1.17"><semantics id="S3.E12.m1.17a"><mrow id="S3.E12.m1.17.17" xref="S3.E12.m1.17.17.cmml"><mfrac id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml"><mrow id="S3.E12.m1.2.2.2" xref="S3.E12.m1.2.2.2.cmml"><mi id="S3.E12.m1.2.2.2.4" xref="S3.E12.m1.2.2.2.4.cmml">d</mi><mo id="S3.E12.m1.2.2.2.3" xref="S3.E12.m1.2.2.2.3.cmml">⁢</mo><msub id="S3.E12.m1.2.2.2.5" xref="S3.E12.m1.2.2.2.5.cmml"><mi id="S3.E12.m1.2.2.2.5.2" xref="S3.E12.m1.2.2.2.5.2.cmml">θ</mi><mrow id="S3.E12.m1.2.2.2.2.2.4" xref="S3.E12.m1.2.2.2.2.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E12.m1.2.2.2.2.2.4.1" xref="S3.E12.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E12.m1.2.2.2.2.2.2" xref="S3.E12.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mrow id="S3.E12.m1.2.2.4" xref="S3.E12.m1.2.2.4.cmml"><mi id="S3.E12.m1.2.2.4.2" xref="S3.E12.m1.2.2.4.2.cmml">d</mi><mo id="S3.E12.m1.2.2.4.1" xref="S3.E12.m1.2.2.4.1.cmml">⁢</mo><mi id="S3.E12.m1.2.2.4.3" xref="S3.E12.m1.2.2.4.3.cmml">τ</mi></mrow></mfrac><mo id="S3.E12.m1.17.17.2" xref="S3.E12.m1.17.17.2.cmml">=</mo><mrow id="S3.E12.m1.17.17.1" xref="S3.E12.m1.17.17.1.cmml"><mi id="S3.E12.m1.17.17.1.3" xref="S3.E12.m1.17.17.1.3.cmml">β</mi><mo id="S3.E12.m1.17.17.1.2" xref="S3.E12.m1.17.17.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.17.17.1.1.1" xref="S3.E12.m1.17.17.1.1.1.1.cmml"><mo id="S3.E12.m1.17.17.1.1.1.2" xref="S3.E12.m1.17.17.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.17.17.1.1.1.1" xref="S3.E12.m1.17.17.1.1.1.1.cmml"><mfrac id="S3.E12.m1.9.9" xref="S3.E12.m1.9.9.cmml"><mrow id="S3.E12.m1.8.8.6" xref="S3.E12.m1.8.8.6.cmml"><mrow id="S3.E12.m1.8.8.6.8" xref="S3.E12.m1.8.8.6.8.cmml"><msub id="S3.E12.m1.8.8.6.8.2" xref="S3.E12.m1.8.8.6.8.2.cmml"><mi id="S3.E12.m1.8.8.6.8.2.2" xref="S3.E12.m1.8.8.6.8.2.2.cmml">θ</mi><mrow id="S3.E12.m1.4.4.2.2.2.2" xref="S3.E12.m1.4.4.2.2.2.3.cmml"><mrow id="S3.E12.m1.4.4.2.2.2.2.1" xref="S3.E12.m1.4.4.2.2.2.2.1.cmml"><mi id="S3.E12.m1.4.4.2.2.2.2.1.2" xref="S3.E12.m1.4.4.2.2.2.2.1.2.cmml">i</mi><mo id="S3.E12.m1.4.4.2.2.2.2.1.1" xref="S3.E12.m1.4.4.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E12.m1.4.4.2.2.2.2.1.3" xref="S3.E12.m1.4.4.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E12.m1.4.4.2.2.2.2.2" xref="S3.E12.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S3.E12.m1.3.3.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.cmml">j</mi></mrow></msub><mo id="S3.E12.m1.8.8.6.8.1" xref="S3.E12.m1.8.8.6.8.1.cmml">−</mo><mrow id="S3.E12.m1.8.8.6.8.3" xref="S3.E12.m1.8.8.6.8.3.cmml"><mn id="S3.E12.m1.8.8.6.8.3.2" xref="S3.E12.m1.8.8.6.8.3.2.cmml">2</mn><mo id="S3.E12.m1.8.8.6.8.3.1" lspace="0.170em" xref="S3.E12.m1.8.8.6.8.3.1.cmml">⁢</mo><msub id="S3.E12.m1.8.8.6.8.3.3" xref="S3.E12.m1.8.8.6.8.3.3.cmml"><mi id="S3.E12.m1.8.8.6.8.3.3.2" xref="S3.E12.m1.8.8.6.8.3.3.2.cmml">θ</mi><mrow id="S3.E12.m1.6.6.4.4.2.4" xref="S3.E12.m1.6.6.4.4.2.3.cmml"><mi id="S3.E12.m1.5.5.3.3.1.1" xref="S3.E12.m1.5.5.3.3.1.1.cmml">i</mi><mo id="S3.E12.m1.6.6.4.4.2.4.1" xref="S3.E12.m1.6.6.4.4.2.3.cmml">,</mo><mi id="S3.E12.m1.6.6.4.4.2.2" xref="S3.E12.m1.6.6.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S3.E12.m1.8.8.6.7" xref="S3.E12.m1.8.8.6.7.cmml">+</mo><msub id="S3.E12.m1.8.8.6.9" xref="S3.E12.m1.8.8.6.9.cmml"><mi id="S3.E12.m1.8.8.6.9.2" xref="S3.E12.m1.8.8.6.9.2.cmml">θ</mi><mrow id="S3.E12.m1.8.8.6.6.2.2" xref="S3.E12.m1.8.8.6.6.2.3.cmml"><mrow id="S3.E12.m1.8.8.6.6.2.2.1" xref="S3.E12.m1.8.8.6.6.2.2.1.cmml"><mi id="S3.E12.m1.8.8.6.6.2.2.1.2" xref="S3.E12.m1.8.8.6.6.2.2.1.2.cmml">i</mi><mo id="S3.E12.m1.8.8.6.6.2.2.1.1" xref="S3.E12.m1.8.8.6.6.2.2.1.1.cmml">−</mo><mn id="S3.E12.m1.8.8.6.6.2.2.1.3" xref="S3.E12.m1.8.8.6.6.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E12.m1.8.8.6.6.2.2.2" xref="S3.E12.m1.8.8.6.6.2.3.cmml">,</mo><mi id="S3.E12.m1.7.7.5.5.1.1" xref="S3.E12.m1.7.7.5.5.1.1.cmml">j</mi></mrow></msub></mrow><msup id="S3.E12.m1.9.9.7" xref="S3.E12.m1.9.9.7.cmml"><mrow id="S3.E12.m1.9.9.7.1.1" xref="S3.E12.m1.9.9.7.1.1.1.cmml"><mo id="S3.E12.m1.9.9.7.1.1.2" stretchy="false" xref="S3.E12.m1.9.9.7.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.9.9.7.1.1.1" xref="S3.E12.m1.9.9.7.1.1.1.cmml"><mi id="S3.E12.m1.9.9.7.1.1.1.2" mathvariant="normal" xref="S3.E12.m1.9.9.7.1.1.1.2.cmml">Δ</mi><mo id="S3.E12.m1.9.9.7.1.1.1.1" xref="S3.E12.m1.9.9.7.1.1.1.1.cmml">⁢</mo><mi id="S3.E12.m1.9.9.7.1.1.1.3" xref="S3.E12.m1.9.9.7.1.1.1.3.cmml">ξ</mi></mrow><mo id="S3.E12.m1.9.9.7.1.1.3" stretchy="false" xref="S3.E12.m1.9.9.7.1.1.1.cmml">)</mo></mrow><mn id="S3.E12.m1.9.9.7.3" xref="S3.E12.m1.9.9.7.3.cmml">2</mn></msup></mfrac><mo id="S3.E12.m1.17.17.1.1.1.1.1" xref="S3.E12.m1.17.17.1.1.1.1.1.cmml">+</mo><mfrac id="S3.E12.m1.16.16" xref="S3.E12.m1.16.16.cmml"><mrow id="S3.E12.m1.15.15.6" xref="S3.E12.m1.15.15.6.cmml"><mrow id="S3.E12.m1.15.15.6.8" xref="S3.E12.m1.15.15.6.8.cmml"><msub id="S3.E12.m1.15.15.6.8.2" xref="S3.E12.m1.15.15.6.8.2.cmml"><mi id="S3.E12.m1.15.15.6.8.2.2" xref="S3.E12.m1.15.15.6.8.2.2.cmml">θ</mi><mrow id="S3.E12.m1.11.11.2.2.2.2" xref="S3.E12.m1.11.11.2.2.2.3.cmml"><mi id="S3.E12.m1.10.10.1.1.1.1" xref="S3.E12.m1.10.10.1.1.1.1.cmml">i</mi><mo id="S3.E12.m1.11.11.2.2.2.2.2" xref="S3.E12.m1.11.11.2.2.2.3.cmml">,</mo><mrow id="S3.E12.m1.11.11.2.2.2.2.1" xref="S3.E12.m1.11.11.2.2.2.2.1.cmml"><mi id="S3.E12.m1.11.11.2.2.2.2.1.2" xref="S3.E12.m1.11.11.2.2.2.2.1.2.cmml">j</mi><mo id="S3.E12.m1.11.11.2.2.2.2.1.1" xref="S3.E12.m1.11.11.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E12.m1.11.11.2.2.2.2.1.3" xref="S3.E12.m1.11.11.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S3.E12.m1.15.15.6.8.1" xref="S3.E12.m1.15.15.6.8.1.cmml">−</mo><mrow id="S3.E12.m1.15.15.6.8.3" xref="S3.E12.m1.15.15.6.8.3.cmml"><mn id="S3.E12.m1.15.15.6.8.3.2" xref="S3.E12.m1.15.15.6.8.3.2.cmml">2</mn><mo id="S3.E12.m1.15.15.6.8.3.1" lspace="0.170em" xref="S3.E12.m1.15.15.6.8.3.1.cmml">⁢</mo><msub id="S3.E12.m1.15.15.6.8.3.3" xref="S3.E12.m1.15.15.6.8.3.3.cmml"><mi id="S3.E12.m1.15.15.6.8.3.3.2" xref="S3.E12.m1.15.15.6.8.3.3.2.cmml">θ</mi><mrow id="S3.E12.m1.13.13.4.4.2.4" xref="S3.E12.m1.13.13.4.4.2.3.cmml"><mi id="S3.E12.m1.12.12.3.3.1.1" xref="S3.E12.m1.12.12.3.3.1.1.cmml">i</mi><mo id="S3.E12.m1.13.13.4.4.2.4.1" xref="S3.E12.m1.13.13.4.4.2.3.cmml">,</mo><mi id="S3.E12.m1.13.13.4.4.2.2" xref="S3.E12.m1.13.13.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S3.E12.m1.15.15.6.7" xref="S3.E12.m1.15.15.6.7.cmml">+</mo><msub id="S3.E12.m1.15.15.6.9" xref="S3.E12.m1.15.15.6.9.cmml"><mi id="S3.E12.m1.15.15.6.9.2" xref="S3.E12.m1.15.15.6.9.2.cmml">θ</mi><mrow id="S3.E12.m1.15.15.6.6.2.2" xref="S3.E12.m1.15.15.6.6.2.3.cmml"><mi id="S3.E12.m1.14.14.5.5.1.1" xref="S3.E12.m1.14.14.5.5.1.1.cmml">i</mi><mo id="S3.E12.m1.15.15.6.6.2.2.2" xref="S3.E12.m1.15.15.6.6.2.3.cmml">,</mo><mrow id="S3.E12.m1.15.15.6.6.2.2.1" xref="S3.E12.m1.15.15.6.6.2.2.1.cmml"><mi id="S3.E12.m1.15.15.6.6.2.2.1.2" xref="S3.E12.m1.15.15.6.6.2.2.1.2.cmml">j</mi><mo id="S3.E12.m1.15.15.6.6.2.2.1.1" xref="S3.E12.m1.15.15.6.6.2.2.1.1.cmml">−</mo><mn id="S3.E12.m1.15.15.6.6.2.2.1.3" xref="S3.E12.m1.15.15.6.6.2.2.1.3.cmml">1</mn></mrow></mrow></msub></mrow><msup id="S3.E12.m1.16.16.7" xref="S3.E12.m1.16.16.7.cmml"><mrow id="S3.E12.m1.16.16.7.1.1" xref="S3.E12.m1.16.16.7.1.1.1.cmml"><mo id="S3.E12.m1.16.16.7.1.1.2" stretchy="false" xref="S3.E12.m1.16.16.7.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.16.16.7.1.1.1" xref="S3.E12.m1.16.16.7.1.1.1.cmml"><mi id="S3.E12.m1.16.16.7.1.1.1.2" mathvariant="normal" xref="S3.E12.m1.16.16.7.1.1.1.2.cmml">Δ</mi><mo id="S3.E12.m1.16.16.7.1.1.1.1" xref="S3.E12.m1.16.16.7.1.1.1.1.cmml">⁢</mo><mi id="S3.E12.m1.16.16.7.1.1.1.3" xref="S3.E12.m1.16.16.7.1.1.1.3.cmml">η</mi></mrow><mo id="S3.E12.m1.16.16.7.1.1.3" stretchy="false" xref="S3.E12.m1.16.16.7.1.1.1.cmml">)</mo></mrow><mn id="S3.E12.m1.16.16.7.3" xref="S3.E12.m1.16.16.7.3.cmml">2</mn></msup></mfrac></mrow><mo id="S3.E12.m1.17.17.1.1.1.3" xref="S3.E12.m1.17.17.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.17b"><apply id="S3.E12.m1.17.17.cmml" xref="S3.E12.m1.17.17"><eq id="S3.E12.m1.17.17.2.cmml" xref="S3.E12.m1.17.17.2"></eq><apply id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.2.2"><divide id="S3.E12.m1.2.2.3.cmml" xref="S3.E12.m1.2.2"></divide><apply id="S3.E12.m1.2.2.2.cmml" xref="S3.E12.m1.2.2.2"><times id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.3"></times><ci id="S3.E12.m1.2.2.2.4.cmml" xref="S3.E12.m1.2.2.2.4">𝑑</ci><apply id="S3.E12.m1.2.2.2.5.cmml" xref="S3.E12.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.5.1.cmml" xref="S3.E12.m1.2.2.2.5">subscript</csymbol><ci id="S3.E12.m1.2.2.2.5.2.cmml" xref="S3.E12.m1.2.2.2.5.2">𝜃</ci><list id="S3.E12.m1.2.2.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.2.2.4"><ci id="S3.E12.m1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E12.m1.2.2.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S3.E12.m1.2.2.4.cmml" xref="S3.E12.m1.2.2.4"><times id="S3.E12.m1.2.2.4.1.cmml" xref="S3.E12.m1.2.2.4.1"></times><ci id="S3.E12.m1.2.2.4.2.cmml" xref="S3.E12.m1.2.2.4.2">𝑑</ci><ci id="S3.E12.m1.2.2.4.3.cmml" xref="S3.E12.m1.2.2.4.3">𝜏</ci></apply></apply><apply id="S3.E12.m1.17.17.1.cmml" xref="S3.E12.m1.17.17.1"><times id="S3.E12.m1.17.17.1.2.cmml" xref="S3.E12.m1.17.17.1.2"></times><ci id="S3.E12.m1.17.17.1.3.cmml" xref="S3.E12.m1.17.17.1.3">𝛽</ci><apply id="S3.E12.m1.17.17.1.1.1.1.cmml" xref="S3.E12.m1.17.17.1.1.1"><plus id="S3.E12.m1.17.17.1.1.1.1.1.cmml" xref="S3.E12.m1.17.17.1.1.1.1.1"></plus><apply id="S3.E12.m1.9.9.cmml" xref="S3.E12.m1.9.9"><divide id="S3.E12.m1.9.9.8.cmml" xref="S3.E12.m1.9.9"></divide><apply id="S3.E12.m1.8.8.6.cmml" xref="S3.E12.m1.8.8.6"><plus id="S3.E12.m1.8.8.6.7.cmml" xref="S3.E12.m1.8.8.6.7"></plus><apply id="S3.E12.m1.8.8.6.8.cmml" xref="S3.E12.m1.8.8.6.8"><minus id="S3.E12.m1.8.8.6.8.1.cmml" xref="S3.E12.m1.8.8.6.8.1"></minus><apply id="S3.E12.m1.8.8.6.8.2.cmml" xref="S3.E12.m1.8.8.6.8.2"><csymbol cd="ambiguous" id="S3.E12.m1.8.8.6.8.2.1.cmml" xref="S3.E12.m1.8.8.6.8.2">subscript</csymbol><ci id="S3.E12.m1.8.8.6.8.2.2.cmml" xref="S3.E12.m1.8.8.6.8.2.2">𝜃</ci><list id="S3.E12.m1.4.4.2.2.2.3.cmml" xref="S3.E12.m1.4.4.2.2.2.2"><apply id="S3.E12.m1.4.4.2.2.2.2.1.cmml" xref="S3.E12.m1.4.4.2.2.2.2.1"><plus id="S3.E12.m1.4.4.2.2.2.2.1.1.cmml" xref="S3.E12.m1.4.4.2.2.2.2.1.1"></plus><ci id="S3.E12.m1.4.4.2.2.2.2.1.2.cmml" xref="S3.E12.m1.4.4.2.2.2.2.1.2">𝑖</ci><cn id="S3.E12.m1.4.4.2.2.2.2.1.3.cmml" type="integer" xref="S3.E12.m1.4.4.2.2.2.2.1.3">1</cn></apply><ci id="S3.E12.m1.3.3.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1">𝑗</ci></list></apply><apply id="S3.E12.m1.8.8.6.8.3.cmml" xref="S3.E12.m1.8.8.6.8.3"><times id="S3.E12.m1.8.8.6.8.3.1.cmml" xref="S3.E12.m1.8.8.6.8.3.1"></times><cn id="S3.E12.m1.8.8.6.8.3.2.cmml" type="integer" xref="S3.E12.m1.8.8.6.8.3.2">2</cn><apply id="S3.E12.m1.8.8.6.8.3.3.cmml" xref="S3.E12.m1.8.8.6.8.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.8.8.6.8.3.3.1.cmml" xref="S3.E12.m1.8.8.6.8.3.3">subscript</csymbol><ci id="S3.E12.m1.8.8.6.8.3.3.2.cmml" xref="S3.E12.m1.8.8.6.8.3.3.2">𝜃</ci><list id="S3.E12.m1.6.6.4.4.2.3.cmml" xref="S3.E12.m1.6.6.4.4.2.4"><ci id="S3.E12.m1.5.5.3.3.1.1.cmml" xref="S3.E12.m1.5.5.3.3.1.1">𝑖</ci><ci id="S3.E12.m1.6.6.4.4.2.2.cmml" xref="S3.E12.m1.6.6.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.E12.m1.8.8.6.9.cmml" xref="S3.E12.m1.8.8.6.9"><csymbol cd="ambiguous" id="S3.E12.m1.8.8.6.9.1.cmml" xref="S3.E12.m1.8.8.6.9">subscript</csymbol><ci id="S3.E12.m1.8.8.6.9.2.cmml" xref="S3.E12.m1.8.8.6.9.2">𝜃</ci><list id="S3.E12.m1.8.8.6.6.2.3.cmml" xref="S3.E12.m1.8.8.6.6.2.2"><apply id="S3.E12.m1.8.8.6.6.2.2.1.cmml" xref="S3.E12.m1.8.8.6.6.2.2.1"><minus id="S3.E12.m1.8.8.6.6.2.2.1.1.cmml" xref="S3.E12.m1.8.8.6.6.2.2.1.1"></minus><ci id="S3.E12.m1.8.8.6.6.2.2.1.2.cmml" xref="S3.E12.m1.8.8.6.6.2.2.1.2">𝑖</ci><cn id="S3.E12.m1.8.8.6.6.2.2.1.3.cmml" type="integer" xref="S3.E12.m1.8.8.6.6.2.2.1.3">1</cn></apply><ci id="S3.E12.m1.7.7.5.5.1.1.cmml" xref="S3.E12.m1.7.7.5.5.1.1">𝑗</ci></list></apply></apply><apply id="S3.E12.m1.9.9.7.cmml" xref="S3.E12.m1.9.9.7"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.7.2.cmml" xref="S3.E12.m1.9.9.7">superscript</csymbol><apply id="S3.E12.m1.9.9.7.1.1.1.cmml" xref="S3.E12.m1.9.9.7.1.1"><times id="S3.E12.m1.9.9.7.1.1.1.1.cmml" xref="S3.E12.m1.9.9.7.1.1.1.1"></times><ci id="S3.E12.m1.9.9.7.1.1.1.2.cmml" xref="S3.E12.m1.9.9.7.1.1.1.2">Δ</ci><ci id="S3.E12.m1.9.9.7.1.1.1.3.cmml" xref="S3.E12.m1.9.9.7.1.1.1.3">𝜉</ci></apply><cn id="S3.E12.m1.9.9.7.3.cmml" type="integer" xref="S3.E12.m1.9.9.7.3">2</cn></apply></apply><apply id="S3.E12.m1.16.16.cmml" xref="S3.E12.m1.16.16"><divide id="S3.E12.m1.16.16.8.cmml" xref="S3.E12.m1.16.16"></divide><apply id="S3.E12.m1.15.15.6.cmml" xref="S3.E12.m1.15.15.6"><plus id="S3.E12.m1.15.15.6.7.cmml" xref="S3.E12.m1.15.15.6.7"></plus><apply id="S3.E12.m1.15.15.6.8.cmml" xref="S3.E12.m1.15.15.6.8"><minus id="S3.E12.m1.15.15.6.8.1.cmml" xref="S3.E12.m1.15.15.6.8.1"></minus><apply id="S3.E12.m1.15.15.6.8.2.cmml" xref="S3.E12.m1.15.15.6.8.2"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.6.8.2.1.cmml" xref="S3.E12.m1.15.15.6.8.2">subscript</csymbol><ci id="S3.E12.m1.15.15.6.8.2.2.cmml" xref="S3.E12.m1.15.15.6.8.2.2">𝜃</ci><list id="S3.E12.m1.11.11.2.2.2.3.cmml" xref="S3.E12.m1.11.11.2.2.2.2"><ci id="S3.E12.m1.10.10.1.1.1.1.cmml" xref="S3.E12.m1.10.10.1.1.1.1">𝑖</ci><apply id="S3.E12.m1.11.11.2.2.2.2.1.cmml" xref="S3.E12.m1.11.11.2.2.2.2.1"><plus id="S3.E12.m1.11.11.2.2.2.2.1.1.cmml" xref="S3.E12.m1.11.11.2.2.2.2.1.1"></plus><ci id="S3.E12.m1.11.11.2.2.2.2.1.2.cmml" xref="S3.E12.m1.11.11.2.2.2.2.1.2">𝑗</ci><cn id="S3.E12.m1.11.11.2.2.2.2.1.3.cmml" type="integer" xref="S3.E12.m1.11.11.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S3.E12.m1.15.15.6.8.3.cmml" xref="S3.E12.m1.15.15.6.8.3"><times id="S3.E12.m1.15.15.6.8.3.1.cmml" xref="S3.E12.m1.15.15.6.8.3.1"></times><cn id="S3.E12.m1.15.15.6.8.3.2.cmml" type="integer" xref="S3.E12.m1.15.15.6.8.3.2">2</cn><apply id="S3.E12.m1.15.15.6.8.3.3.cmml" xref="S3.E12.m1.15.15.6.8.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.6.8.3.3.1.cmml" xref="S3.E12.m1.15.15.6.8.3.3">subscript</csymbol><ci id="S3.E12.m1.15.15.6.8.3.3.2.cmml" xref="S3.E12.m1.15.15.6.8.3.3.2">𝜃</ci><list id="S3.E12.m1.13.13.4.4.2.3.cmml" xref="S3.E12.m1.13.13.4.4.2.4"><ci id="S3.E12.m1.12.12.3.3.1.1.cmml" xref="S3.E12.m1.12.12.3.3.1.1">𝑖</ci><ci id="S3.E12.m1.13.13.4.4.2.2.cmml" xref="S3.E12.m1.13.13.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.E12.m1.15.15.6.9.cmml" xref="S3.E12.m1.15.15.6.9"><csymbol cd="ambiguous" id="S3.E12.m1.15.15.6.9.1.cmml" xref="S3.E12.m1.15.15.6.9">subscript</csymbol><ci id="S3.E12.m1.15.15.6.9.2.cmml" xref="S3.E12.m1.15.15.6.9.2">𝜃</ci><list id="S3.E12.m1.15.15.6.6.2.3.cmml" xref="S3.E12.m1.15.15.6.6.2.2"><ci id="S3.E12.m1.14.14.5.5.1.1.cmml" xref="S3.E12.m1.14.14.5.5.1.1">𝑖</ci><apply id="S3.E12.m1.15.15.6.6.2.2.1.cmml" xref="S3.E12.m1.15.15.6.6.2.2.1"><minus id="S3.E12.m1.15.15.6.6.2.2.1.1.cmml" xref="S3.E12.m1.15.15.6.6.2.2.1.1"></minus><ci id="S3.E12.m1.15.15.6.6.2.2.1.2.cmml" xref="S3.E12.m1.15.15.6.6.2.2.1.2">𝑗</ci><cn id="S3.E12.m1.15.15.6.6.2.2.1.3.cmml" type="integer" xref="S3.E12.m1.15.15.6.6.2.2.1.3">1</cn></apply></list></apply></apply><apply id="S3.E12.m1.16.16.7.cmml" xref="S3.E12.m1.16.16.7"><csymbol cd="ambiguous" id="S3.E12.m1.16.16.7.2.cmml" xref="S3.E12.m1.16.16.7">superscript</csymbol><apply id="S3.E12.m1.16.16.7.1.1.1.cmml" xref="S3.E12.m1.16.16.7.1.1"><times id="S3.E12.m1.16.16.7.1.1.1.1.cmml" xref="S3.E12.m1.16.16.7.1.1.1.1"></times><ci id="S3.E12.m1.16.16.7.1.1.1.2.cmml" xref="S3.E12.m1.16.16.7.1.1.1.2">Δ</ci><ci id="S3.E12.m1.16.16.7.1.1.1.3.cmml" xref="S3.E12.m1.16.16.7.1.1.1.3">𝜂</ci></apply><cn id="S3.E12.m1.16.16.7.3.cmml" type="integer" xref="S3.E12.m1.16.16.7.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.17c">\frac{d\theta_{i,j}}{d\tau}=\beta\left(\frac{\theta_{i+1,j}-2\,\theta_{i,j}+%
\theta_{i-1,j}}{(\Delta\xi)^{2}}+\frac{\theta_{i,j+1}-2\,\theta_{i,j}+\theta_{%
i,j-1}}{(\Delta\eta)^{2}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.17d">divide start_ARG italic_d italic_θ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_ARG start_ARG italic_d italic_τ end_ARG = italic_β ( divide start_ARG italic_θ start_POSTSUBSCRIPT italic_i + 1 , italic_j end_POSTSUBSCRIPT - 2 italic_θ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT + italic_θ start_POSTSUBSCRIPT italic_i - 1 , italic_j end_POSTSUBSCRIPT end_ARG start_ARG ( roman_Δ italic_ξ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG + divide start_ARG italic_θ start_POSTSUBSCRIPT italic_i , italic_j + 1 end_POSTSUBSCRIPT - 2 italic_θ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT + italic_θ start_POSTSUBSCRIPT italic_i , italic_j - 1 end_POSTSUBSCRIPT end_ARG start_ARG ( roman_Δ italic_η ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p10">
<p class="ltx_p" id="S3.SS4.p10.1">For the time integration, the explicit Euler method is used:</p>
</div>
<div class="ltx_para" id="S3.SS4.p11">
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\theta_{i,j}^{n+1}=\theta_{i,j}^{n}+\Delta\tau\cdot\beta\left(\frac{\theta_{i+%
1,j}^{n}-2\,\theta_{i,j}^{n}+\theta_{i-1,j}^{n}}{(\Delta\xi)^{2}}+\frac{\theta%
_{i,j+1}^{n}-2\,\theta_{i,j}^{n}+\theta_{i,j-1}^{n}}{(\Delta\eta)^{2}}\right)" class="ltx_Math" display="block" id="S3.E13.m1.19"><semantics id="S3.E13.m1.19a"><mrow id="S3.E13.m1.19.19" xref="S3.E13.m1.19.19.cmml"><msubsup id="S3.E13.m1.19.19.3" xref="S3.E13.m1.19.19.3.cmml"><mi id="S3.E13.m1.19.19.3.2.2" xref="S3.E13.m1.19.19.3.2.2.cmml">θ</mi><mrow id="S3.E13.m1.2.2.2.4" xref="S3.E13.m1.2.2.2.3.cmml"><mi id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml">i</mi><mo id="S3.E13.m1.2.2.2.4.1" xref="S3.E13.m1.2.2.2.3.cmml">,</mo><mi id="S3.E13.m1.2.2.2.2" xref="S3.E13.m1.2.2.2.2.cmml">j</mi></mrow><mrow id="S3.E13.m1.19.19.3.3" xref="S3.E13.m1.19.19.3.3.cmml"><mi id="S3.E13.m1.19.19.3.3.2" xref="S3.E13.m1.19.19.3.3.2.cmml">n</mi><mo id="S3.E13.m1.19.19.3.3.1" xref="S3.E13.m1.19.19.3.3.1.cmml">+</mo><mn id="S3.E13.m1.19.19.3.3.3" xref="S3.E13.m1.19.19.3.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E13.m1.19.19.2" xref="S3.E13.m1.19.19.2.cmml">=</mo><mrow id="S3.E13.m1.19.19.1" xref="S3.E13.m1.19.19.1.cmml"><msubsup id="S3.E13.m1.19.19.1.3" xref="S3.E13.m1.19.19.1.3.cmml"><mi id="S3.E13.m1.19.19.1.3.2.2" xref="S3.E13.m1.19.19.1.3.2.2.cmml">θ</mi><mrow id="S3.E13.m1.4.4.2.4" xref="S3.E13.m1.4.4.2.3.cmml"><mi id="S3.E13.m1.3.3.1.1" xref="S3.E13.m1.3.3.1.1.cmml">i</mi><mo id="S3.E13.m1.4.4.2.4.1" xref="S3.E13.m1.4.4.2.3.cmml">,</mo><mi id="S3.E13.m1.4.4.2.2" xref="S3.E13.m1.4.4.2.2.cmml">j</mi></mrow><mi id="S3.E13.m1.19.19.1.3.3" xref="S3.E13.m1.19.19.1.3.3.cmml">n</mi></msubsup><mo id="S3.E13.m1.19.19.1.2" xref="S3.E13.m1.19.19.1.2.cmml">+</mo><mrow id="S3.E13.m1.19.19.1.1" xref="S3.E13.m1.19.19.1.1.cmml"><mrow id="S3.E13.m1.19.19.1.1.3" xref="S3.E13.m1.19.19.1.1.3.cmml"><mrow id="S3.E13.m1.19.19.1.1.3.2" xref="S3.E13.m1.19.19.1.1.3.2.cmml"><mi id="S3.E13.m1.19.19.1.1.3.2.2" mathvariant="normal" xref="S3.E13.m1.19.19.1.1.3.2.2.cmml">Δ</mi><mo id="S3.E13.m1.19.19.1.1.3.2.1" xref="S3.E13.m1.19.19.1.1.3.2.1.cmml">⁢</mo><mi id="S3.E13.m1.19.19.1.1.3.2.3" xref="S3.E13.m1.19.19.1.1.3.2.3.cmml">τ</mi></mrow><mo id="S3.E13.m1.19.19.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E13.m1.19.19.1.1.3.1.cmml">⋅</mo><mi id="S3.E13.m1.19.19.1.1.3.3" xref="S3.E13.m1.19.19.1.1.3.3.cmml">β</mi></mrow><mo id="S3.E13.m1.19.19.1.1.2" xref="S3.E13.m1.19.19.1.1.2.cmml">⁢</mo><mrow id="S3.E13.m1.19.19.1.1.1.1" xref="S3.E13.m1.19.19.1.1.1.1.1.cmml"><mo id="S3.E13.m1.19.19.1.1.1.1.2" xref="S3.E13.m1.19.19.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.19.19.1.1.1.1.1" xref="S3.E13.m1.19.19.1.1.1.1.1.cmml"><mfrac id="S3.E13.m1.11.11" xref="S3.E13.m1.11.11.cmml"><mrow id="S3.E13.m1.10.10.6" xref="S3.E13.m1.10.10.6.cmml"><mrow id="S3.E13.m1.10.10.6.8" xref="S3.E13.m1.10.10.6.8.cmml"><msubsup id="S3.E13.m1.10.10.6.8.2" xref="S3.E13.m1.10.10.6.8.2.cmml"><mi id="S3.E13.m1.10.10.6.8.2.2.2" xref="S3.E13.m1.10.10.6.8.2.2.2.cmml">θ</mi><mrow id="S3.E13.m1.6.6.2.2.2.2" xref="S3.E13.m1.6.6.2.2.2.3.cmml"><mrow id="S3.E13.m1.6.6.2.2.2.2.1" xref="S3.E13.m1.6.6.2.2.2.2.1.cmml"><mi id="S3.E13.m1.6.6.2.2.2.2.1.2" xref="S3.E13.m1.6.6.2.2.2.2.1.2.cmml">i</mi><mo id="S3.E13.m1.6.6.2.2.2.2.1.1" xref="S3.E13.m1.6.6.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E13.m1.6.6.2.2.2.2.1.3" xref="S3.E13.m1.6.6.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E13.m1.6.6.2.2.2.2.2" xref="S3.E13.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S3.E13.m1.5.5.1.1.1.1" xref="S3.E13.m1.5.5.1.1.1.1.cmml">j</mi></mrow><mi id="S3.E13.m1.10.10.6.8.2.3" xref="S3.E13.m1.10.10.6.8.2.3.cmml">n</mi></msubsup><mo id="S3.E13.m1.10.10.6.8.1" xref="S3.E13.m1.10.10.6.8.1.cmml">−</mo><mrow id="S3.E13.m1.10.10.6.8.3" xref="S3.E13.m1.10.10.6.8.3.cmml"><mn id="S3.E13.m1.10.10.6.8.3.2" xref="S3.E13.m1.10.10.6.8.3.2.cmml">2</mn><mo id="S3.E13.m1.10.10.6.8.3.1" lspace="0.170em" xref="S3.E13.m1.10.10.6.8.3.1.cmml">⁢</mo><msubsup id="S3.E13.m1.10.10.6.8.3.3" xref="S3.E13.m1.10.10.6.8.3.3.cmml"><mi id="S3.E13.m1.10.10.6.8.3.3.2.2" xref="S3.E13.m1.10.10.6.8.3.3.2.2.cmml">θ</mi><mrow id="S3.E13.m1.8.8.4.4.2.4" xref="S3.E13.m1.8.8.4.4.2.3.cmml"><mi id="S3.E13.m1.7.7.3.3.1.1" xref="S3.E13.m1.7.7.3.3.1.1.cmml">i</mi><mo id="S3.E13.m1.8.8.4.4.2.4.1" xref="S3.E13.m1.8.8.4.4.2.3.cmml">,</mo><mi id="S3.E13.m1.8.8.4.4.2.2" xref="S3.E13.m1.8.8.4.4.2.2.cmml">j</mi></mrow><mi id="S3.E13.m1.10.10.6.8.3.3.3" xref="S3.E13.m1.10.10.6.8.3.3.3.cmml">n</mi></msubsup></mrow></mrow><mo id="S3.E13.m1.10.10.6.7" xref="S3.E13.m1.10.10.6.7.cmml">+</mo><msubsup id="S3.E13.m1.10.10.6.9" xref="S3.E13.m1.10.10.6.9.cmml"><mi id="S3.E13.m1.10.10.6.9.2.2" xref="S3.E13.m1.10.10.6.9.2.2.cmml">θ</mi><mrow id="S3.E13.m1.10.10.6.6.2.2" xref="S3.E13.m1.10.10.6.6.2.3.cmml"><mrow id="S3.E13.m1.10.10.6.6.2.2.1" xref="S3.E13.m1.10.10.6.6.2.2.1.cmml"><mi id="S3.E13.m1.10.10.6.6.2.2.1.2" xref="S3.E13.m1.10.10.6.6.2.2.1.2.cmml">i</mi><mo id="S3.E13.m1.10.10.6.6.2.2.1.1" xref="S3.E13.m1.10.10.6.6.2.2.1.1.cmml">−</mo><mn id="S3.E13.m1.10.10.6.6.2.2.1.3" xref="S3.E13.m1.10.10.6.6.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E13.m1.10.10.6.6.2.2.2" xref="S3.E13.m1.10.10.6.6.2.3.cmml">,</mo><mi id="S3.E13.m1.9.9.5.5.1.1" xref="S3.E13.m1.9.9.5.5.1.1.cmml">j</mi></mrow><mi id="S3.E13.m1.10.10.6.9.3" xref="S3.E13.m1.10.10.6.9.3.cmml">n</mi></msubsup></mrow><msup id="S3.E13.m1.11.11.7" xref="S3.E13.m1.11.11.7.cmml"><mrow id="S3.E13.m1.11.11.7.1.1" xref="S3.E13.m1.11.11.7.1.1.1.cmml"><mo id="S3.E13.m1.11.11.7.1.1.2" stretchy="false" xref="S3.E13.m1.11.11.7.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.11.11.7.1.1.1" xref="S3.E13.m1.11.11.7.1.1.1.cmml"><mi id="S3.E13.m1.11.11.7.1.1.1.2" mathvariant="normal" xref="S3.E13.m1.11.11.7.1.1.1.2.cmml">Δ</mi><mo id="S3.E13.m1.11.11.7.1.1.1.1" xref="S3.E13.m1.11.11.7.1.1.1.1.cmml">⁢</mo><mi id="S3.E13.m1.11.11.7.1.1.1.3" xref="S3.E13.m1.11.11.7.1.1.1.3.cmml">ξ</mi></mrow><mo id="S3.E13.m1.11.11.7.1.1.3" stretchy="false" xref="S3.E13.m1.11.11.7.1.1.1.cmml">)</mo></mrow><mn id="S3.E13.m1.11.11.7.3" xref="S3.E13.m1.11.11.7.3.cmml">2</mn></msup></mfrac><mo id="S3.E13.m1.19.19.1.1.1.1.1.1" xref="S3.E13.m1.19.19.1.1.1.1.1.1.cmml">+</mo><mfrac id="S3.E13.m1.18.18" xref="S3.E13.m1.18.18.cmml"><mrow id="S3.E13.m1.17.17.6" xref="S3.E13.m1.17.17.6.cmml"><mrow id="S3.E13.m1.17.17.6.8" xref="S3.E13.m1.17.17.6.8.cmml"><msubsup id="S3.E13.m1.17.17.6.8.2" xref="S3.E13.m1.17.17.6.8.2.cmml"><mi id="S3.E13.m1.17.17.6.8.2.2.2" xref="S3.E13.m1.17.17.6.8.2.2.2.cmml">θ</mi><mrow id="S3.E13.m1.13.13.2.2.2.2" xref="S3.E13.m1.13.13.2.2.2.3.cmml"><mi id="S3.E13.m1.12.12.1.1.1.1" xref="S3.E13.m1.12.12.1.1.1.1.cmml">i</mi><mo id="S3.E13.m1.13.13.2.2.2.2.2" xref="S3.E13.m1.13.13.2.2.2.3.cmml">,</mo><mrow id="S3.E13.m1.13.13.2.2.2.2.1" xref="S3.E13.m1.13.13.2.2.2.2.1.cmml"><mi id="S3.E13.m1.13.13.2.2.2.2.1.2" xref="S3.E13.m1.13.13.2.2.2.2.1.2.cmml">j</mi><mo id="S3.E13.m1.13.13.2.2.2.2.1.1" xref="S3.E13.m1.13.13.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E13.m1.13.13.2.2.2.2.1.3" xref="S3.E13.m1.13.13.2.2.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="S3.E13.m1.17.17.6.8.2.3" xref="S3.E13.m1.17.17.6.8.2.3.cmml">n</mi></msubsup><mo id="S3.E13.m1.17.17.6.8.1" xref="S3.E13.m1.17.17.6.8.1.cmml">−</mo><mrow id="S3.E13.m1.17.17.6.8.3" xref="S3.E13.m1.17.17.6.8.3.cmml"><mn id="S3.E13.m1.17.17.6.8.3.2" xref="S3.E13.m1.17.17.6.8.3.2.cmml">2</mn><mo id="S3.E13.m1.17.17.6.8.3.1" lspace="0.170em" xref="S3.E13.m1.17.17.6.8.3.1.cmml">⁢</mo><msubsup id="S3.E13.m1.17.17.6.8.3.3" xref="S3.E13.m1.17.17.6.8.3.3.cmml"><mi id="S3.E13.m1.17.17.6.8.3.3.2.2" xref="S3.E13.m1.17.17.6.8.3.3.2.2.cmml">θ</mi><mrow id="S3.E13.m1.15.15.4.4.2.4" xref="S3.E13.m1.15.15.4.4.2.3.cmml"><mi id="S3.E13.m1.14.14.3.3.1.1" xref="S3.E13.m1.14.14.3.3.1.1.cmml">i</mi><mo id="S3.E13.m1.15.15.4.4.2.4.1" xref="S3.E13.m1.15.15.4.4.2.3.cmml">,</mo><mi id="S3.E13.m1.15.15.4.4.2.2" xref="S3.E13.m1.15.15.4.4.2.2.cmml">j</mi></mrow><mi id="S3.E13.m1.17.17.6.8.3.3.3" xref="S3.E13.m1.17.17.6.8.3.3.3.cmml">n</mi></msubsup></mrow></mrow><mo id="S3.E13.m1.17.17.6.7" xref="S3.E13.m1.17.17.6.7.cmml">+</mo><msubsup id="S3.E13.m1.17.17.6.9" xref="S3.E13.m1.17.17.6.9.cmml"><mi id="S3.E13.m1.17.17.6.9.2.2" xref="S3.E13.m1.17.17.6.9.2.2.cmml">θ</mi><mrow id="S3.E13.m1.17.17.6.6.2.2" xref="S3.E13.m1.17.17.6.6.2.3.cmml"><mi id="S3.E13.m1.16.16.5.5.1.1" xref="S3.E13.m1.16.16.5.5.1.1.cmml">i</mi><mo id="S3.E13.m1.17.17.6.6.2.2.2" xref="S3.E13.m1.17.17.6.6.2.3.cmml">,</mo><mrow id="S3.E13.m1.17.17.6.6.2.2.1" xref="S3.E13.m1.17.17.6.6.2.2.1.cmml"><mi id="S3.E13.m1.17.17.6.6.2.2.1.2" xref="S3.E13.m1.17.17.6.6.2.2.1.2.cmml">j</mi><mo id="S3.E13.m1.17.17.6.6.2.2.1.1" xref="S3.E13.m1.17.17.6.6.2.2.1.1.cmml">−</mo><mn id="S3.E13.m1.17.17.6.6.2.2.1.3" xref="S3.E13.m1.17.17.6.6.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="S3.E13.m1.17.17.6.9.3" xref="S3.E13.m1.17.17.6.9.3.cmml">n</mi></msubsup></mrow><msup id="S3.E13.m1.18.18.7" xref="S3.E13.m1.18.18.7.cmml"><mrow id="S3.E13.m1.18.18.7.1.1" xref="S3.E13.m1.18.18.7.1.1.1.cmml"><mo id="S3.E13.m1.18.18.7.1.1.2" stretchy="false" xref="S3.E13.m1.18.18.7.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.18.18.7.1.1.1" xref="S3.E13.m1.18.18.7.1.1.1.cmml"><mi id="S3.E13.m1.18.18.7.1.1.1.2" mathvariant="normal" xref="S3.E13.m1.18.18.7.1.1.1.2.cmml">Δ</mi><mo id="S3.E13.m1.18.18.7.1.1.1.1" xref="S3.E13.m1.18.18.7.1.1.1.1.cmml">⁢</mo><mi id="S3.E13.m1.18.18.7.1.1.1.3" xref="S3.E13.m1.18.18.7.1.1.1.3.cmml">η</mi></mrow><mo id="S3.E13.m1.18.18.7.1.1.3" stretchy="false" xref="S3.E13.m1.18.18.7.1.1.1.cmml">)</mo></mrow><mn id="S3.E13.m1.18.18.7.3" xref="S3.E13.m1.18.18.7.3.cmml">2</mn></msup></mfrac></mrow><mo id="S3.E13.m1.19.19.1.1.1.1.3" xref="S3.E13.m1.19.19.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.19b"><apply id="S3.E13.m1.19.19.cmml" xref="S3.E13.m1.19.19"><eq id="S3.E13.m1.19.19.2.cmml" xref="S3.E13.m1.19.19.2"></eq><apply id="S3.E13.m1.19.19.3.cmml" xref="S3.E13.m1.19.19.3"><csymbol cd="ambiguous" id="S3.E13.m1.19.19.3.1.cmml" xref="S3.E13.m1.19.19.3">superscript</csymbol><apply id="S3.E13.m1.19.19.3.2.cmml" xref="S3.E13.m1.19.19.3"><csymbol cd="ambiguous" id="S3.E13.m1.19.19.3.2.1.cmml" xref="S3.E13.m1.19.19.3">subscript</csymbol><ci id="S3.E13.m1.19.19.3.2.2.cmml" xref="S3.E13.m1.19.19.3.2.2">𝜃</ci><list id="S3.E13.m1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.4"><ci id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1">𝑖</ci><ci id="S3.E13.m1.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E13.m1.19.19.3.3.cmml" xref="S3.E13.m1.19.19.3.3"><plus id="S3.E13.m1.19.19.3.3.1.cmml" xref="S3.E13.m1.19.19.3.3.1"></plus><ci id="S3.E13.m1.19.19.3.3.2.cmml" xref="S3.E13.m1.19.19.3.3.2">𝑛</ci><cn id="S3.E13.m1.19.19.3.3.3.cmml" type="integer" xref="S3.E13.m1.19.19.3.3.3">1</cn></apply></apply><apply id="S3.E13.m1.19.19.1.cmml" xref="S3.E13.m1.19.19.1"><plus id="S3.E13.m1.19.19.1.2.cmml" xref="S3.E13.m1.19.19.1.2"></plus><apply id="S3.E13.m1.19.19.1.3.cmml" xref="S3.E13.m1.19.19.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.19.19.1.3.1.cmml" xref="S3.E13.m1.19.19.1.3">superscript</csymbol><apply id="S3.E13.m1.19.19.1.3.2.cmml" xref="S3.E13.m1.19.19.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.19.19.1.3.2.1.cmml" xref="S3.E13.m1.19.19.1.3">subscript</csymbol><ci id="S3.E13.m1.19.19.1.3.2.2.cmml" xref="S3.E13.m1.19.19.1.3.2.2">𝜃</ci><list id="S3.E13.m1.4.4.2.3.cmml" xref="S3.E13.m1.4.4.2.4"><ci id="S3.E13.m1.3.3.1.1.cmml" xref="S3.E13.m1.3.3.1.1">𝑖</ci><ci id="S3.E13.m1.4.4.2.2.cmml" xref="S3.E13.m1.4.4.2.2">𝑗</ci></list></apply><ci id="S3.E13.m1.19.19.1.3.3.cmml" xref="S3.E13.m1.19.19.1.3.3">𝑛</ci></apply><apply id="S3.E13.m1.19.19.1.1.cmml" xref="S3.E13.m1.19.19.1.1"><times id="S3.E13.m1.19.19.1.1.2.cmml" xref="S3.E13.m1.19.19.1.1.2"></times><apply id="S3.E13.m1.19.19.1.1.3.cmml" xref="S3.E13.m1.19.19.1.1.3"><ci id="S3.E13.m1.19.19.1.1.3.1.cmml" xref="S3.E13.m1.19.19.1.1.3.1">⋅</ci><apply id="S3.E13.m1.19.19.1.1.3.2.cmml" xref="S3.E13.m1.19.19.1.1.3.2"><times id="S3.E13.m1.19.19.1.1.3.2.1.cmml" xref="S3.E13.m1.19.19.1.1.3.2.1"></times><ci id="S3.E13.m1.19.19.1.1.3.2.2.cmml" xref="S3.E13.m1.19.19.1.1.3.2.2">Δ</ci><ci id="S3.E13.m1.19.19.1.1.3.2.3.cmml" xref="S3.E13.m1.19.19.1.1.3.2.3">𝜏</ci></apply><ci id="S3.E13.m1.19.19.1.1.3.3.cmml" xref="S3.E13.m1.19.19.1.1.3.3">𝛽</ci></apply><apply id="S3.E13.m1.19.19.1.1.1.1.1.cmml" xref="S3.E13.m1.19.19.1.1.1.1"><plus id="S3.E13.m1.19.19.1.1.1.1.1.1.cmml" xref="S3.E13.m1.19.19.1.1.1.1.1.1"></plus><apply id="S3.E13.m1.11.11.cmml" xref="S3.E13.m1.11.11"><divide id="S3.E13.m1.11.11.8.cmml" xref="S3.E13.m1.11.11"></divide><apply id="S3.E13.m1.10.10.6.cmml" xref="S3.E13.m1.10.10.6"><plus id="S3.E13.m1.10.10.6.7.cmml" xref="S3.E13.m1.10.10.6.7"></plus><apply id="S3.E13.m1.10.10.6.8.cmml" xref="S3.E13.m1.10.10.6.8"><minus id="S3.E13.m1.10.10.6.8.1.cmml" xref="S3.E13.m1.10.10.6.8.1"></minus><apply id="S3.E13.m1.10.10.6.8.2.cmml" xref="S3.E13.m1.10.10.6.8.2"><csymbol cd="ambiguous" id="S3.E13.m1.10.10.6.8.2.1.cmml" xref="S3.E13.m1.10.10.6.8.2">superscript</csymbol><apply id="S3.E13.m1.10.10.6.8.2.2.cmml" xref="S3.E13.m1.10.10.6.8.2"><csymbol cd="ambiguous" id="S3.E13.m1.10.10.6.8.2.2.1.cmml" xref="S3.E13.m1.10.10.6.8.2">subscript</csymbol><ci id="S3.E13.m1.10.10.6.8.2.2.2.cmml" xref="S3.E13.m1.10.10.6.8.2.2.2">𝜃</ci><list id="S3.E13.m1.6.6.2.2.2.3.cmml" xref="S3.E13.m1.6.6.2.2.2.2"><apply id="S3.E13.m1.6.6.2.2.2.2.1.cmml" xref="S3.E13.m1.6.6.2.2.2.2.1"><plus id="S3.E13.m1.6.6.2.2.2.2.1.1.cmml" xref="S3.E13.m1.6.6.2.2.2.2.1.1"></plus><ci id="S3.E13.m1.6.6.2.2.2.2.1.2.cmml" xref="S3.E13.m1.6.6.2.2.2.2.1.2">𝑖</ci><cn id="S3.E13.m1.6.6.2.2.2.2.1.3.cmml" type="integer" xref="S3.E13.m1.6.6.2.2.2.2.1.3">1</cn></apply><ci id="S3.E13.m1.5.5.1.1.1.1.cmml" xref="S3.E13.m1.5.5.1.1.1.1">𝑗</ci></list></apply><ci id="S3.E13.m1.10.10.6.8.2.3.cmml" xref="S3.E13.m1.10.10.6.8.2.3">𝑛</ci></apply><apply id="S3.E13.m1.10.10.6.8.3.cmml" xref="S3.E13.m1.10.10.6.8.3"><times id="S3.E13.m1.10.10.6.8.3.1.cmml" xref="S3.E13.m1.10.10.6.8.3.1"></times><cn id="S3.E13.m1.10.10.6.8.3.2.cmml" type="integer" xref="S3.E13.m1.10.10.6.8.3.2">2</cn><apply id="S3.E13.m1.10.10.6.8.3.3.cmml" xref="S3.E13.m1.10.10.6.8.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.10.10.6.8.3.3.1.cmml" xref="S3.E13.m1.10.10.6.8.3.3">superscript</csymbol><apply id="S3.E13.m1.10.10.6.8.3.3.2.cmml" xref="S3.E13.m1.10.10.6.8.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.10.10.6.8.3.3.2.1.cmml" xref="S3.E13.m1.10.10.6.8.3.3">subscript</csymbol><ci id="S3.E13.m1.10.10.6.8.3.3.2.2.cmml" xref="S3.E13.m1.10.10.6.8.3.3.2.2">𝜃</ci><list id="S3.E13.m1.8.8.4.4.2.3.cmml" xref="S3.E13.m1.8.8.4.4.2.4"><ci id="S3.E13.m1.7.7.3.3.1.1.cmml" xref="S3.E13.m1.7.7.3.3.1.1">𝑖</ci><ci id="S3.E13.m1.8.8.4.4.2.2.cmml" xref="S3.E13.m1.8.8.4.4.2.2">𝑗</ci></list></apply><ci id="S3.E13.m1.10.10.6.8.3.3.3.cmml" xref="S3.E13.m1.10.10.6.8.3.3.3">𝑛</ci></apply></apply></apply><apply id="S3.E13.m1.10.10.6.9.cmml" xref="S3.E13.m1.10.10.6.9"><csymbol cd="ambiguous" id="S3.E13.m1.10.10.6.9.1.cmml" xref="S3.E13.m1.10.10.6.9">superscript</csymbol><apply id="S3.E13.m1.10.10.6.9.2.cmml" xref="S3.E13.m1.10.10.6.9"><csymbol cd="ambiguous" id="S3.E13.m1.10.10.6.9.2.1.cmml" xref="S3.E13.m1.10.10.6.9">subscript</csymbol><ci id="S3.E13.m1.10.10.6.9.2.2.cmml" xref="S3.E13.m1.10.10.6.9.2.2">𝜃</ci><list id="S3.E13.m1.10.10.6.6.2.3.cmml" xref="S3.E13.m1.10.10.6.6.2.2"><apply id="S3.E13.m1.10.10.6.6.2.2.1.cmml" xref="S3.E13.m1.10.10.6.6.2.2.1"><minus id="S3.E13.m1.10.10.6.6.2.2.1.1.cmml" xref="S3.E13.m1.10.10.6.6.2.2.1.1"></minus><ci id="S3.E13.m1.10.10.6.6.2.2.1.2.cmml" xref="S3.E13.m1.10.10.6.6.2.2.1.2">𝑖</ci><cn id="S3.E13.m1.10.10.6.6.2.2.1.3.cmml" type="integer" xref="S3.E13.m1.10.10.6.6.2.2.1.3">1</cn></apply><ci id="S3.E13.m1.9.9.5.5.1.1.cmml" xref="S3.E13.m1.9.9.5.5.1.1">𝑗</ci></list></apply><ci id="S3.E13.m1.10.10.6.9.3.cmml" xref="S3.E13.m1.10.10.6.9.3">𝑛</ci></apply></apply><apply id="S3.E13.m1.11.11.7.cmml" xref="S3.E13.m1.11.11.7"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.7.2.cmml" xref="S3.E13.m1.11.11.7">superscript</csymbol><apply id="S3.E13.m1.11.11.7.1.1.1.cmml" xref="S3.E13.m1.11.11.7.1.1"><times id="S3.E13.m1.11.11.7.1.1.1.1.cmml" xref="S3.E13.m1.11.11.7.1.1.1.1"></times><ci id="S3.E13.m1.11.11.7.1.1.1.2.cmml" xref="S3.E13.m1.11.11.7.1.1.1.2">Δ</ci><ci id="S3.E13.m1.11.11.7.1.1.1.3.cmml" xref="S3.E13.m1.11.11.7.1.1.1.3">𝜉</ci></apply><cn id="S3.E13.m1.11.11.7.3.cmml" type="integer" xref="S3.E13.m1.11.11.7.3">2</cn></apply></apply><apply id="S3.E13.m1.18.18.cmml" xref="S3.E13.m1.18.18"><divide id="S3.E13.m1.18.18.8.cmml" xref="S3.E13.m1.18.18"></divide><apply id="S3.E13.m1.17.17.6.cmml" xref="S3.E13.m1.17.17.6"><plus id="S3.E13.m1.17.17.6.7.cmml" xref="S3.E13.m1.17.17.6.7"></plus><apply id="S3.E13.m1.17.17.6.8.cmml" xref="S3.E13.m1.17.17.6.8"><minus id="S3.E13.m1.17.17.6.8.1.cmml" xref="S3.E13.m1.17.17.6.8.1"></minus><apply id="S3.E13.m1.17.17.6.8.2.cmml" xref="S3.E13.m1.17.17.6.8.2"><csymbol cd="ambiguous" id="S3.E13.m1.17.17.6.8.2.1.cmml" xref="S3.E13.m1.17.17.6.8.2">superscript</csymbol><apply id="S3.E13.m1.17.17.6.8.2.2.cmml" xref="S3.E13.m1.17.17.6.8.2"><csymbol cd="ambiguous" id="S3.E13.m1.17.17.6.8.2.2.1.cmml" xref="S3.E13.m1.17.17.6.8.2">subscript</csymbol><ci id="S3.E13.m1.17.17.6.8.2.2.2.cmml" xref="S3.E13.m1.17.17.6.8.2.2.2">𝜃</ci><list id="S3.E13.m1.13.13.2.2.2.3.cmml" xref="S3.E13.m1.13.13.2.2.2.2"><ci id="S3.E13.m1.12.12.1.1.1.1.cmml" xref="S3.E13.m1.12.12.1.1.1.1">𝑖</ci><apply id="S3.E13.m1.13.13.2.2.2.2.1.cmml" xref="S3.E13.m1.13.13.2.2.2.2.1"><plus id="S3.E13.m1.13.13.2.2.2.2.1.1.cmml" xref="S3.E13.m1.13.13.2.2.2.2.1.1"></plus><ci id="S3.E13.m1.13.13.2.2.2.2.1.2.cmml" xref="S3.E13.m1.13.13.2.2.2.2.1.2">𝑗</ci><cn id="S3.E13.m1.13.13.2.2.2.2.1.3.cmml" type="integer" xref="S3.E13.m1.13.13.2.2.2.2.1.3">1</cn></apply></list></apply><ci id="S3.E13.m1.17.17.6.8.2.3.cmml" xref="S3.E13.m1.17.17.6.8.2.3">𝑛</ci></apply><apply id="S3.E13.m1.17.17.6.8.3.cmml" xref="S3.E13.m1.17.17.6.8.3"><times id="S3.E13.m1.17.17.6.8.3.1.cmml" xref="S3.E13.m1.17.17.6.8.3.1"></times><cn id="S3.E13.m1.17.17.6.8.3.2.cmml" type="integer" xref="S3.E13.m1.17.17.6.8.3.2">2</cn><apply id="S3.E13.m1.17.17.6.8.3.3.cmml" xref="S3.E13.m1.17.17.6.8.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.17.17.6.8.3.3.1.cmml" xref="S3.E13.m1.17.17.6.8.3.3">superscript</csymbol><apply id="S3.E13.m1.17.17.6.8.3.3.2.cmml" xref="S3.E13.m1.17.17.6.8.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.17.17.6.8.3.3.2.1.cmml" xref="S3.E13.m1.17.17.6.8.3.3">subscript</csymbol><ci id="S3.E13.m1.17.17.6.8.3.3.2.2.cmml" xref="S3.E13.m1.17.17.6.8.3.3.2.2">𝜃</ci><list id="S3.E13.m1.15.15.4.4.2.3.cmml" xref="S3.E13.m1.15.15.4.4.2.4"><ci id="S3.E13.m1.14.14.3.3.1.1.cmml" xref="S3.E13.m1.14.14.3.3.1.1">𝑖</ci><ci id="S3.E13.m1.15.15.4.4.2.2.cmml" xref="S3.E13.m1.15.15.4.4.2.2">𝑗</ci></list></apply><ci id="S3.E13.m1.17.17.6.8.3.3.3.cmml" xref="S3.E13.m1.17.17.6.8.3.3.3">𝑛</ci></apply></apply></apply><apply id="S3.E13.m1.17.17.6.9.cmml" xref="S3.E13.m1.17.17.6.9"><csymbol cd="ambiguous" id="S3.E13.m1.17.17.6.9.1.cmml" xref="S3.E13.m1.17.17.6.9">superscript</csymbol><apply id="S3.E13.m1.17.17.6.9.2.cmml" xref="S3.E13.m1.17.17.6.9"><csymbol cd="ambiguous" id="S3.E13.m1.17.17.6.9.2.1.cmml" xref="S3.E13.m1.17.17.6.9">subscript</csymbol><ci id="S3.E13.m1.17.17.6.9.2.2.cmml" xref="S3.E13.m1.17.17.6.9.2.2">𝜃</ci><list id="S3.E13.m1.17.17.6.6.2.3.cmml" xref="S3.E13.m1.17.17.6.6.2.2"><ci id="S3.E13.m1.16.16.5.5.1.1.cmml" xref="S3.E13.m1.16.16.5.5.1.1">𝑖</ci><apply id="S3.E13.m1.17.17.6.6.2.2.1.cmml" xref="S3.E13.m1.17.17.6.6.2.2.1"><minus id="S3.E13.m1.17.17.6.6.2.2.1.1.cmml" xref="S3.E13.m1.17.17.6.6.2.2.1.1"></minus><ci id="S3.E13.m1.17.17.6.6.2.2.1.2.cmml" xref="S3.E13.m1.17.17.6.6.2.2.1.2">𝑗</ci><cn id="S3.E13.m1.17.17.6.6.2.2.1.3.cmml" type="integer" xref="S3.E13.m1.17.17.6.6.2.2.1.3">1</cn></apply></list></apply><ci id="S3.E13.m1.17.17.6.9.3.cmml" xref="S3.E13.m1.17.17.6.9.3">𝑛</ci></apply></apply><apply id="S3.E13.m1.18.18.7.cmml" xref="S3.E13.m1.18.18.7"><csymbol cd="ambiguous" id="S3.E13.m1.18.18.7.2.cmml" xref="S3.E13.m1.18.18.7">superscript</csymbol><apply id="S3.E13.m1.18.18.7.1.1.1.cmml" xref="S3.E13.m1.18.18.7.1.1"><times id="S3.E13.m1.18.18.7.1.1.1.1.cmml" xref="S3.E13.m1.18.18.7.1.1.1.1"></times><ci id="S3.E13.m1.18.18.7.1.1.1.2.cmml" xref="S3.E13.m1.18.18.7.1.1.1.2">Δ</ci><ci id="S3.E13.m1.18.18.7.1.1.1.3.cmml" xref="S3.E13.m1.18.18.7.1.1.1.3">𝜂</ci></apply><cn id="S3.E13.m1.18.18.7.3.cmml" type="integer" xref="S3.E13.m1.18.18.7.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.19c">\theta_{i,j}^{n+1}=\theta_{i,j}^{n}+\Delta\tau\cdot\beta\left(\frac{\theta_{i+%
1,j}^{n}-2\,\theta_{i,j}^{n}+\theta_{i-1,j}^{n}}{(\Delta\xi)^{2}}+\frac{\theta%
_{i,j+1}^{n}-2\,\theta_{i,j}^{n}+\theta_{i,j-1}^{n}}{(\Delta\eta)^{2}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.19d">italic_θ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n + 1 end_POSTSUPERSCRIPT = italic_θ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT + roman_Δ italic_τ ⋅ italic_β ( divide start_ARG italic_θ start_POSTSUBSCRIPT italic_i + 1 , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT - 2 italic_θ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT + italic_θ start_POSTSUBSCRIPT italic_i - 1 , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT end_ARG start_ARG ( roman_Δ italic_ξ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG + divide start_ARG italic_θ start_POSTSUBSCRIPT italic_i , italic_j + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT - 2 italic_θ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT + italic_θ start_POSTSUBSCRIPT italic_i , italic_j - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT end_ARG start_ARG ( roman_Δ italic_η ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p12">
<p class="ltx_p" id="S3.SS4.p12.2">where <math alttext="\Delta\tau" class="ltx_Math" display="inline" id="S3.SS4.p12.1.m1.1"><semantics id="S3.SS4.p12.1.m1.1a"><mrow id="S3.SS4.p12.1.m1.1.1" xref="S3.SS4.p12.1.m1.1.1.cmml"><mi id="S3.SS4.p12.1.m1.1.1.2" mathvariant="normal" xref="S3.SS4.p12.1.m1.1.1.2.cmml">Δ</mi><mo id="S3.SS4.p12.1.m1.1.1.1" xref="S3.SS4.p12.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p12.1.m1.1.1.3" xref="S3.SS4.p12.1.m1.1.1.3.cmml">τ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p12.1.m1.1b"><apply id="S3.SS4.p12.1.m1.1.1.cmml" xref="S3.SS4.p12.1.m1.1.1"><times id="S3.SS4.p12.1.m1.1.1.1.cmml" xref="S3.SS4.p12.1.m1.1.1.1"></times><ci id="S3.SS4.p12.1.m1.1.1.2.cmml" xref="S3.SS4.p12.1.m1.1.1.2">Δ</ci><ci id="S3.SS4.p12.1.m1.1.1.3.cmml" xref="S3.SS4.p12.1.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p12.1.m1.1c">\Delta\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p12.1.m1.1d">roman_Δ italic_τ</annotation></semantics></math> is the non-dimensional time step size and <math alttext="n" class="ltx_Math" display="inline" id="S3.SS4.p12.2.m2.1"><semantics id="S3.SS4.p12.2.m2.1a"><mi id="S3.SS4.p12.2.m2.1.1" xref="S3.SS4.p12.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p12.2.m2.1b"><ci id="S3.SS4.p12.2.m2.1.1.cmml" xref="S3.SS4.p12.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p12.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p12.2.m2.1d">italic_n</annotation></semantics></math> denotes the time level.</p>
</div>
<div class="ltx_para" id="S3.SS4.p13">
<p class="ltx_p" id="S3.SS4.p13.1">The Dirichlet boundary conditions are applied on all four edges of the plate. The non-dimensional temperature values are specified as follows:</p>
</div>
<div class="ltx_para" id="S3.SS4.p14">
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\theta(0,\eta,\tau)=\theta_{\text{left}},\,\,\,\theta(1,\eta,\tau)=\theta_{%
\text{right}},\,\,\,\theta(\xi,0,\tau)=\theta_{\text{bottom}},\,\,\,\theta(\xi%
,1,\tau)=\theta_{\text{top}}." class="ltx_Math" display="block" id="S3.E14.m1.13"><semantics id="S3.E14.m1.13a"><mrow id="S3.E14.m1.13.13.1"><mrow id="S3.E14.m1.13.13.1.1.2" xref="S3.E14.m1.13.13.1.1.3.cmml"><mrow id="S3.E14.m1.13.13.1.1.1.1" xref="S3.E14.m1.13.13.1.1.1.1.cmml"><mrow id="S3.E14.m1.13.13.1.1.1.1.2" xref="S3.E14.m1.13.13.1.1.1.1.2.cmml"><mi id="S3.E14.m1.13.13.1.1.1.1.2.2" xref="S3.E14.m1.13.13.1.1.1.1.2.2.cmml">θ</mi><mo id="S3.E14.m1.13.13.1.1.1.1.2.1" xref="S3.E14.m1.13.13.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E14.m1.13.13.1.1.1.1.2.3.2" xref="S3.E14.m1.13.13.1.1.1.1.2.3.1.cmml"><mo id="S3.E14.m1.13.13.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E14.m1.13.13.1.1.1.1.2.3.1.cmml">(</mo><mn id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml">0</mn><mo id="S3.E14.m1.13.13.1.1.1.1.2.3.2.2" xref="S3.E14.m1.13.13.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E14.m1.2.2" xref="S3.E14.m1.2.2.cmml">η</mi><mo id="S3.E14.m1.13.13.1.1.1.1.2.3.2.3" xref="S3.E14.m1.13.13.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E14.m1.3.3" xref="S3.E14.m1.3.3.cmml">τ</mi><mo id="S3.E14.m1.13.13.1.1.1.1.2.3.2.4" stretchy="false" xref="S3.E14.m1.13.13.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.13.13.1.1.1.1.1" xref="S3.E14.m1.13.13.1.1.1.1.1.cmml">=</mo><msub id="S3.E14.m1.13.13.1.1.1.1.3" xref="S3.E14.m1.13.13.1.1.1.1.3.cmml"><mi id="S3.E14.m1.13.13.1.1.1.1.3.2" xref="S3.E14.m1.13.13.1.1.1.1.3.2.cmml">θ</mi><mtext id="S3.E14.m1.13.13.1.1.1.1.3.3" xref="S3.E14.m1.13.13.1.1.1.1.3.3a.cmml">left</mtext></msub></mrow><mo id="S3.E14.m1.13.13.1.1.2.3" rspace="0.667em" xref="S3.E14.m1.13.13.1.1.3a.cmml">,</mo><mrow id="S3.E14.m1.13.13.1.1.2.2.2" xref="S3.E14.m1.13.13.1.1.2.2.3.cmml"><mrow id="S3.E14.m1.13.13.1.1.2.2.1.1" xref="S3.E14.m1.13.13.1.1.2.2.1.1.cmml"><mrow id="S3.E14.m1.13.13.1.1.2.2.1.1.2" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.cmml"><mi id="S3.E14.m1.13.13.1.1.2.2.1.1.2.2" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.2.cmml">θ</mi><mo id="S3.E14.m1.13.13.1.1.2.2.1.1.2.1" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.1.cmml">⁢</mo><mrow id="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.2" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.1.cmml"><mo id="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.2.1" stretchy="false" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.1.cmml">(</mo><mn id="S3.E14.m1.4.4" xref="S3.E14.m1.4.4.cmml">1</mn><mo id="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.2.2" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.1.cmml">,</mo><mi id="S3.E14.m1.5.5" xref="S3.E14.m1.5.5.cmml">η</mi><mo id="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.2.3" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.1.cmml">,</mo><mi id="S3.E14.m1.6.6" xref="S3.E14.m1.6.6.cmml">τ</mi><mo id="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.2.4" stretchy="false" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.13.13.1.1.2.2.1.1.1" xref="S3.E14.m1.13.13.1.1.2.2.1.1.1.cmml">=</mo><msub id="S3.E14.m1.13.13.1.1.2.2.1.1.3" xref="S3.E14.m1.13.13.1.1.2.2.1.1.3.cmml"><mi id="S3.E14.m1.13.13.1.1.2.2.1.1.3.2" xref="S3.E14.m1.13.13.1.1.2.2.1.1.3.2.cmml">θ</mi><mtext id="S3.E14.m1.13.13.1.1.2.2.1.1.3.3" xref="S3.E14.m1.13.13.1.1.2.2.1.1.3.3a.cmml">right</mtext></msub></mrow><mo id="S3.E14.m1.13.13.1.1.2.2.2.3" rspace="0.667em" xref="S3.E14.m1.13.13.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E14.m1.13.13.1.1.2.2.2.2.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.3.cmml"><mrow id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.cmml"><mrow id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.cmml"><mi id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.2.cmml">θ</mi><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.1" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.1.cmml">⁢</mo><mrow id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.1.cmml"><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.2.1" stretchy="false" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.1.cmml">(</mo><mi id="S3.E14.m1.7.7" xref="S3.E14.m1.7.7.cmml">ξ</mi><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.2.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.1.cmml">,</mo><mn id="S3.E14.m1.8.8" xref="S3.E14.m1.8.8.cmml">0</mn><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.2.3" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.1.cmml">,</mo><mi id="S3.E14.m1.9.9" xref="S3.E14.m1.9.9.cmml">τ</mi><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.2.4" stretchy="false" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.1" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.1.cmml">=</mo><msub id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.cmml"><mi id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.2.cmml">θ</mi><mtext id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.3" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.3a.cmml">bottom</mtext></msub></mrow><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.2.3" rspace="0.667em" xref="S3.E14.m1.13.13.1.1.2.2.2.2.3a.cmml">,</mo><mrow id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.cmml"><mrow id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.cmml"><mi id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.2.cmml">θ</mi><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.1" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.1.cmml"><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.2.1" stretchy="false" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.1.cmml">(</mo><mi id="S3.E14.m1.10.10" xref="S3.E14.m1.10.10.cmml">ξ</mi><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.2.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.1.cmml">,</mo><mn id="S3.E14.m1.11.11" xref="S3.E14.m1.11.11.cmml">1</mn><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.2.3" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.1.cmml">,</mo><mi id="S3.E14.m1.12.12" xref="S3.E14.m1.12.12.cmml">τ</mi><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.2.4" stretchy="false" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.1" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.1.cmml">=</mo><msub id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.cmml"><mi id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.2" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.2.cmml">θ</mi><mtext id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.3" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.3a.cmml">top</mtext></msub></mrow></mrow></mrow></mrow><mo id="S3.E14.m1.13.13.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.13b"><apply id="S3.E14.m1.13.13.1.1.3.cmml" xref="S3.E14.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.13.13.1.1.3a.cmml" xref="S3.E14.m1.13.13.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E14.m1.13.13.1.1.1.1.cmml" xref="S3.E14.m1.13.13.1.1.1.1"><eq id="S3.E14.m1.13.13.1.1.1.1.1.cmml" xref="S3.E14.m1.13.13.1.1.1.1.1"></eq><apply id="S3.E14.m1.13.13.1.1.1.1.2.cmml" xref="S3.E14.m1.13.13.1.1.1.1.2"><times id="S3.E14.m1.13.13.1.1.1.1.2.1.cmml" xref="S3.E14.m1.13.13.1.1.1.1.2.1"></times><ci id="S3.E14.m1.13.13.1.1.1.1.2.2.cmml" xref="S3.E14.m1.13.13.1.1.1.1.2.2">𝜃</ci><vector id="S3.E14.m1.13.13.1.1.1.1.2.3.1.cmml" xref="S3.E14.m1.13.13.1.1.1.1.2.3.2"><cn id="S3.E14.m1.1.1.cmml" type="integer" xref="S3.E14.m1.1.1">0</cn><ci id="S3.E14.m1.2.2.cmml" xref="S3.E14.m1.2.2">𝜂</ci><ci id="S3.E14.m1.3.3.cmml" xref="S3.E14.m1.3.3">𝜏</ci></vector></apply><apply id="S3.E14.m1.13.13.1.1.1.1.3.cmml" xref="S3.E14.m1.13.13.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.13.13.1.1.1.1.3.1.cmml" xref="S3.E14.m1.13.13.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m1.13.13.1.1.1.1.3.2.cmml" xref="S3.E14.m1.13.13.1.1.1.1.3.2">𝜃</ci><ci id="S3.E14.m1.13.13.1.1.1.1.3.3a.cmml" xref="S3.E14.m1.13.13.1.1.1.1.3.3"><mtext id="S3.E14.m1.13.13.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E14.m1.13.13.1.1.1.1.3.3">left</mtext></ci></apply></apply><apply id="S3.E14.m1.13.13.1.1.2.2.3.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.13.13.1.1.2.2.3a.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E14.m1.13.13.1.1.2.2.1.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.1.1"><eq id="S3.E14.m1.13.13.1.1.2.2.1.1.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.1.1.1"></eq><apply id="S3.E14.m1.13.13.1.1.2.2.1.1.2.cmml" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2"><times id="S3.E14.m1.13.13.1.1.2.2.1.1.2.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.1"></times><ci id="S3.E14.m1.13.13.1.1.2.2.1.1.2.2.cmml" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.2">𝜃</ci><vector id="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.1.1.2.3.2"><cn id="S3.E14.m1.4.4.cmml" type="integer" xref="S3.E14.m1.4.4">1</cn><ci id="S3.E14.m1.5.5.cmml" xref="S3.E14.m1.5.5">𝜂</ci><ci id="S3.E14.m1.6.6.cmml" xref="S3.E14.m1.6.6">𝜏</ci></vector></apply><apply id="S3.E14.m1.13.13.1.1.2.2.1.1.3.cmml" xref="S3.E14.m1.13.13.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.13.13.1.1.2.2.1.1.3.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.1.1.3">subscript</csymbol><ci id="S3.E14.m1.13.13.1.1.2.2.1.1.3.2.cmml" xref="S3.E14.m1.13.13.1.1.2.2.1.1.3.2">𝜃</ci><ci id="S3.E14.m1.13.13.1.1.2.2.1.1.3.3a.cmml" xref="S3.E14.m1.13.13.1.1.2.2.1.1.3.3"><mtext id="S3.E14.m1.13.13.1.1.2.2.1.1.3.3.cmml" mathsize="70%" xref="S3.E14.m1.13.13.1.1.2.2.1.1.3.3">right</mtext></ci></apply></apply><apply id="S3.E14.m1.13.13.1.1.2.2.2.2.3.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.13.13.1.1.2.2.2.2.3a.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1"><eq id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.1"></eq><apply id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2"><times id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.1"></times><ci id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.2.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.2">𝜃</ci><vector id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.2.3.2"><ci id="S3.E14.m1.7.7.cmml" xref="S3.E14.m1.7.7">𝜉</ci><cn id="S3.E14.m1.8.8.cmml" type="integer" xref="S3.E14.m1.8.8">0</cn><ci id="S3.E14.m1.9.9.cmml" xref="S3.E14.m1.9.9">𝜏</ci></vector></apply><apply id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.2.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.2">𝜃</ci><ci id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.3a.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.3"><mtext id="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.3.cmml" mathsize="70%" xref="S3.E14.m1.13.13.1.1.2.2.2.2.1.1.3.3">bottom</mtext></ci></apply></apply><apply id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2"><eq id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.1"></eq><apply id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2"><times id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.1"></times><ci id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.2">𝜃</ci><vector id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.2.3.2"><ci id="S3.E14.m1.10.10.cmml" xref="S3.E14.m1.10.10">𝜉</ci><cn id="S3.E14.m1.11.11.cmml" type="integer" xref="S3.E14.m1.11.11">1</cn><ci id="S3.E14.m1.12.12.cmml" xref="S3.E14.m1.12.12">𝜏</ci></vector></apply><apply id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.1.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.2.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.2">𝜃</ci><ci id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.3a.cmml" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.3"><mtext id="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="S3.E14.m1.13.13.1.1.2.2.2.2.2.2.3.3">top</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.13c">\theta(0,\eta,\tau)=\theta_{\text{left}},\,\,\,\theta(1,\eta,\tau)=\theta_{%
\text{right}},\,\,\,\theta(\xi,0,\tau)=\theta_{\text{bottom}},\,\,\,\theta(\xi%
,1,\tau)=\theta_{\text{top}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.13d">italic_θ ( 0 , italic_η , italic_τ ) = italic_θ start_POSTSUBSCRIPT left end_POSTSUBSCRIPT , italic_θ ( 1 , italic_η , italic_τ ) = italic_θ start_POSTSUBSCRIPT right end_POSTSUBSCRIPT , italic_θ ( italic_ξ , 0 , italic_τ ) = italic_θ start_POSTSUBSCRIPT bottom end_POSTSUBSCRIPT , italic_θ ( italic_ξ , 1 , italic_τ ) = italic_θ start_POSTSUBSCRIPT top end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p15">
<p class="ltx_p" id="S3.SS4.p15.1">These conditions are implemented directly in the finite difference grid by setting the non-dimensional temperature values at the boundary nodes to the specified values at each time step. The initial non-dimensional temperature distribution <math alttext="\theta(\xi,\eta,0)" class="ltx_Math" display="inline" id="S3.SS4.p15.1.m1.3"><semantics id="S3.SS4.p15.1.m1.3a"><mrow id="S3.SS4.p15.1.m1.3.4" xref="S3.SS4.p15.1.m1.3.4.cmml"><mi id="S3.SS4.p15.1.m1.3.4.2" xref="S3.SS4.p15.1.m1.3.4.2.cmml">θ</mi><mo id="S3.SS4.p15.1.m1.3.4.1" xref="S3.SS4.p15.1.m1.3.4.1.cmml">⁢</mo><mrow id="S3.SS4.p15.1.m1.3.4.3.2" xref="S3.SS4.p15.1.m1.3.4.3.1.cmml"><mo id="S3.SS4.p15.1.m1.3.4.3.2.1" stretchy="false" xref="S3.SS4.p15.1.m1.3.4.3.1.cmml">(</mo><mi id="S3.SS4.p15.1.m1.1.1" xref="S3.SS4.p15.1.m1.1.1.cmml">ξ</mi><mo id="S3.SS4.p15.1.m1.3.4.3.2.2" xref="S3.SS4.p15.1.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS4.p15.1.m1.2.2" xref="S3.SS4.p15.1.m1.2.2.cmml">η</mi><mo id="S3.SS4.p15.1.m1.3.4.3.2.3" xref="S3.SS4.p15.1.m1.3.4.3.1.cmml">,</mo><mn id="S3.SS4.p15.1.m1.3.3" xref="S3.SS4.p15.1.m1.3.3.cmml">0</mn><mo id="S3.SS4.p15.1.m1.3.4.3.2.4" stretchy="false" xref="S3.SS4.p15.1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p15.1.m1.3b"><apply id="S3.SS4.p15.1.m1.3.4.cmml" xref="S3.SS4.p15.1.m1.3.4"><times id="S3.SS4.p15.1.m1.3.4.1.cmml" xref="S3.SS4.p15.1.m1.3.4.1"></times><ci id="S3.SS4.p15.1.m1.3.4.2.cmml" xref="S3.SS4.p15.1.m1.3.4.2">𝜃</ci><vector id="S3.SS4.p15.1.m1.3.4.3.1.cmml" xref="S3.SS4.p15.1.m1.3.4.3.2"><ci id="S3.SS4.p15.1.m1.1.1.cmml" xref="S3.SS4.p15.1.m1.1.1">𝜉</ci><ci id="S3.SS4.p15.1.m1.2.2.cmml" xref="S3.SS4.p15.1.m1.2.2">𝜂</ci><cn id="S3.SS4.p15.1.m1.3.3.cmml" type="integer" xref="S3.SS4.p15.1.m1.3.3">0</cn></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p15.1.m1.3c">\theta(\xi,\eta,0)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p15.1.m1.3d">italic_θ ( italic_ξ , italic_η , 0 )</annotation></semantics></math> is specified for all interior nodes.</p>
</div>
<div class="ltx_para" id="S3.SS4.p16">
<p class="ltx_p" id="S3.SS4.p16.1">To ensure numerical stability, the time step <math alttext="\Delta\tau" class="ltx_Math" display="inline" id="S3.SS4.p16.1.m1.1"><semantics id="S3.SS4.p16.1.m1.1a"><mrow id="S3.SS4.p16.1.m1.1.1" xref="S3.SS4.p16.1.m1.1.1.cmml"><mi id="S3.SS4.p16.1.m1.1.1.2" mathvariant="normal" xref="S3.SS4.p16.1.m1.1.1.2.cmml">Δ</mi><mo id="S3.SS4.p16.1.m1.1.1.1" xref="S3.SS4.p16.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p16.1.m1.1.1.3" xref="S3.SS4.p16.1.m1.1.1.3.cmml">τ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p16.1.m1.1b"><apply id="S3.SS4.p16.1.m1.1.1.cmml" xref="S3.SS4.p16.1.m1.1.1"><times id="S3.SS4.p16.1.m1.1.1.1.cmml" xref="S3.SS4.p16.1.m1.1.1.1"></times><ci id="S3.SS4.p16.1.m1.1.1.2.cmml" xref="S3.SS4.p16.1.m1.1.1.2">Δ</ci><ci id="S3.SS4.p16.1.m1.1.1.3.cmml" xref="S3.SS4.p16.1.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p16.1.m1.1c">\Delta\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p16.1.m1.1d">roman_Δ italic_τ</annotation></semantics></math> must satisfy the Courant-Friedrichs-Lewy (CFL) condition for the explicit Euler method,</p>
</div>
<div class="ltx_para" id="S3.SS4.p17">
<table class="ltx_equation ltx_eqn_table" id="S3.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\Delta\tau\leq\frac{1}{2\beta}\left(\frac{1}{(\Delta\xi)^{2}}+\frac{1}{(\Delta%
\eta)^{2}}\right)^{-1}" class="ltx_Math" display="block" id="S3.E15.m1.3"><semantics id="S3.E15.m1.3a"><mrow id="S3.E15.m1.3.3" xref="S3.E15.m1.3.3.cmml"><mrow id="S3.E15.m1.3.3.3" xref="S3.E15.m1.3.3.3.cmml"><mi id="S3.E15.m1.3.3.3.2" mathvariant="normal" xref="S3.E15.m1.3.3.3.2.cmml">Δ</mi><mo id="S3.E15.m1.3.3.3.1" xref="S3.E15.m1.3.3.3.1.cmml">⁢</mo><mi id="S3.E15.m1.3.3.3.3" xref="S3.E15.m1.3.3.3.3.cmml">τ</mi></mrow><mo id="S3.E15.m1.3.3.2" xref="S3.E15.m1.3.3.2.cmml">≤</mo><mrow id="S3.E15.m1.3.3.1" xref="S3.E15.m1.3.3.1.cmml"><mfrac id="S3.E15.m1.3.3.1.3" xref="S3.E15.m1.3.3.1.3.cmml"><mn id="S3.E15.m1.3.3.1.3.2" xref="S3.E15.m1.3.3.1.3.2.cmml">1</mn><mrow id="S3.E15.m1.3.3.1.3.3" xref="S3.E15.m1.3.3.1.3.3.cmml"><mn id="S3.E15.m1.3.3.1.3.3.2" xref="S3.E15.m1.3.3.1.3.3.2.cmml">2</mn><mo id="S3.E15.m1.3.3.1.3.3.1" xref="S3.E15.m1.3.3.1.3.3.1.cmml">⁢</mo><mi id="S3.E15.m1.3.3.1.3.3.3" xref="S3.E15.m1.3.3.1.3.3.3.cmml">β</mi></mrow></mfrac><mo id="S3.E15.m1.3.3.1.2" xref="S3.E15.m1.3.3.1.2.cmml">⁢</mo><msup id="S3.E15.m1.3.3.1.1" xref="S3.E15.m1.3.3.1.1.cmml"><mrow id="S3.E15.m1.3.3.1.1.1.1" xref="S3.E15.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.E15.m1.3.3.1.1.1.1.2" xref="S3.E15.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.3.3.1.1.1.1.1" xref="S3.E15.m1.3.3.1.1.1.1.1.cmml"><mfrac id="S3.E15.m1.1.1" xref="S3.E15.m1.1.1.cmml"><mn id="S3.E15.m1.1.1.3" xref="S3.E15.m1.1.1.3.cmml">1</mn><msup id="S3.E15.m1.1.1.1" xref="S3.E15.m1.1.1.1.cmml"><mrow id="S3.E15.m1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.cmml"><mo id="S3.E15.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.1.1.1.1.1.1.2" mathvariant="normal" xref="S3.E15.m1.1.1.1.1.1.1.2.cmml">Δ</mi><mo id="S3.E15.m1.1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E15.m1.1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.1.3.cmml">ξ</mi></mrow><mo id="S3.E15.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E15.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E15.m1.1.1.1.3" xref="S3.E15.m1.1.1.1.3.cmml">2</mn></msup></mfrac><mo id="S3.E15.m1.3.3.1.1.1.1.1.1" xref="S3.E15.m1.3.3.1.1.1.1.1.1.cmml">+</mo><mfrac id="S3.E15.m1.2.2" xref="S3.E15.m1.2.2.cmml"><mn id="S3.E15.m1.2.2.3" xref="S3.E15.m1.2.2.3.cmml">1</mn><msup id="S3.E15.m1.2.2.1" xref="S3.E15.m1.2.2.1.cmml"><mrow id="S3.E15.m1.2.2.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.cmml"><mo id="S3.E15.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E15.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.2.2.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.2" mathvariant="normal" xref="S3.E15.m1.2.2.1.1.1.1.2.cmml">Δ</mi><mo id="S3.E15.m1.2.2.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E15.m1.2.2.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.3.cmml">η</mi></mrow><mo id="S3.E15.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E15.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E15.m1.2.2.1.3" xref="S3.E15.m1.2.2.1.3.cmml">2</mn></msup></mfrac></mrow><mo id="S3.E15.m1.3.3.1.1.1.1.3" xref="S3.E15.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E15.m1.3.3.1.1.3" xref="S3.E15.m1.3.3.1.1.3.cmml"><mo id="S3.E15.m1.3.3.1.1.3a" xref="S3.E15.m1.3.3.1.1.3.cmml">−</mo><mn id="S3.E15.m1.3.3.1.1.3.2" xref="S3.E15.m1.3.3.1.1.3.2.cmml">1</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.3b"><apply id="S3.E15.m1.3.3.cmml" xref="S3.E15.m1.3.3"><leq id="S3.E15.m1.3.3.2.cmml" xref="S3.E15.m1.3.3.2"></leq><apply id="S3.E15.m1.3.3.3.cmml" xref="S3.E15.m1.3.3.3"><times id="S3.E15.m1.3.3.3.1.cmml" xref="S3.E15.m1.3.3.3.1"></times><ci id="S3.E15.m1.3.3.3.2.cmml" xref="S3.E15.m1.3.3.3.2">Δ</ci><ci id="S3.E15.m1.3.3.3.3.cmml" xref="S3.E15.m1.3.3.3.3">𝜏</ci></apply><apply id="S3.E15.m1.3.3.1.cmml" xref="S3.E15.m1.3.3.1"><times id="S3.E15.m1.3.3.1.2.cmml" xref="S3.E15.m1.3.3.1.2"></times><apply id="S3.E15.m1.3.3.1.3.cmml" xref="S3.E15.m1.3.3.1.3"><divide id="S3.E15.m1.3.3.1.3.1.cmml" xref="S3.E15.m1.3.3.1.3"></divide><cn id="S3.E15.m1.3.3.1.3.2.cmml" type="integer" xref="S3.E15.m1.3.3.1.3.2">1</cn><apply id="S3.E15.m1.3.3.1.3.3.cmml" xref="S3.E15.m1.3.3.1.3.3"><times id="S3.E15.m1.3.3.1.3.3.1.cmml" xref="S3.E15.m1.3.3.1.3.3.1"></times><cn id="S3.E15.m1.3.3.1.3.3.2.cmml" type="integer" xref="S3.E15.m1.3.3.1.3.3.2">2</cn><ci id="S3.E15.m1.3.3.1.3.3.3.cmml" xref="S3.E15.m1.3.3.1.3.3.3">𝛽</ci></apply></apply><apply id="S3.E15.m1.3.3.1.1.cmml" xref="S3.E15.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.2.cmml" xref="S3.E15.m1.3.3.1.1">superscript</csymbol><apply id="S3.E15.m1.3.3.1.1.1.1.1.cmml" xref="S3.E15.m1.3.3.1.1.1.1"><plus id="S3.E15.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1"></plus><apply id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1"><divide id="S3.E15.m1.1.1.2.cmml" xref="S3.E15.m1.1.1"></divide><cn id="S3.E15.m1.1.1.3.cmml" type="integer" xref="S3.E15.m1.1.1.3">1</cn><apply id="S3.E15.m1.1.1.1.cmml" xref="S3.E15.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1">superscript</csymbol><apply id="S3.E15.m1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1"><times id="S3.E15.m1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1"></times><ci id="S3.E15.m1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.2">Δ</ci><ci id="S3.E15.m1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.3">𝜉</ci></apply><cn id="S3.E15.m1.1.1.1.3.cmml" type="integer" xref="S3.E15.m1.1.1.1.3">2</cn></apply></apply><apply id="S3.E15.m1.2.2.cmml" xref="S3.E15.m1.2.2"><divide id="S3.E15.m1.2.2.2.cmml" xref="S3.E15.m1.2.2"></divide><cn id="S3.E15.m1.2.2.3.cmml" type="integer" xref="S3.E15.m1.2.2.3">1</cn><apply id="S3.E15.m1.2.2.1.cmml" xref="S3.E15.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.2.cmml" xref="S3.E15.m1.2.2.1">superscript</csymbol><apply id="S3.E15.m1.2.2.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1"><times id="S3.E15.m1.2.2.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1"></times><ci id="S3.E15.m1.2.2.1.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.2">Δ</ci><ci id="S3.E15.m1.2.2.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.3">𝜂</ci></apply><cn id="S3.E15.m1.2.2.1.3.cmml" type="integer" xref="S3.E15.m1.2.2.1.3">2</cn></apply></apply></apply><apply id="S3.E15.m1.3.3.1.1.3.cmml" xref="S3.E15.m1.3.3.1.1.3"><minus id="S3.E15.m1.3.3.1.1.3.1.cmml" xref="S3.E15.m1.3.3.1.1.3"></minus><cn id="S3.E15.m1.3.3.1.1.3.2.cmml" type="integer" xref="S3.E15.m1.3.3.1.1.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.3c">\Delta\tau\leq\frac{1}{2\beta}\left(\frac{1}{(\Delta\xi)^{2}}+\frac{1}{(\Delta%
\eta)^{2}}\right)^{-1}</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m1.3d">roman_Δ italic_τ ≤ divide start_ARG 1 end_ARG start_ARG 2 italic_β end_ARG ( divide start_ARG 1 end_ARG start_ARG ( roman_Δ italic_ξ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG + divide start_ARG 1 end_ARG start_ARG ( roman_Δ italic_η ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p18">
<p class="ltx_p" id="S3.SS4.p18.1">The convergence of the solution is monitored by evaluating the change in the non-dimensional temperature distribution between successive time steps, continuing the simulation until the system reaches a sufficiently close approximation to a steady state.</p>
</div>
<div class="ltx_para" id="S3.SS4.p19">
<p class="ltx_p" id="S3.SS4.p19.1">Furthermore, in the challenge configurations the specification of the temperature on the boundaries includes additional features. In the Challenge-1 configuration, the left and right boundaries include segments of predefined and fixed length, where the temperature is specified as follows:</p>
</div>
<div class="ltx_para" id="S3.SS4.p20">
<table class="ltx_equation ltx_eqn_table" id="S3.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\theta(\xi,\eta,\tau)=\begin{cases}1&amp;\text{for }\xi=0,\eta\text{ in the %
segment 1 range},\\
0&amp;\text{for }\xi=1,\eta\text{ in the segment 2 range},\\
\text{randomly chosen in }[0,1]&amp;\text{for other boundary points.}\end{cases}" class="ltx_Math" display="block" id="S3.E16.m1.9"><semantics id="S3.E16.m1.9a"><mrow id="S3.E16.m1.9.10" xref="S3.E16.m1.9.10.cmml"><mrow id="S3.E16.m1.9.10.2" xref="S3.E16.m1.9.10.2.cmml"><mi id="S3.E16.m1.9.10.2.2" xref="S3.E16.m1.9.10.2.2.cmml">θ</mi><mo id="S3.E16.m1.9.10.2.1" xref="S3.E16.m1.9.10.2.1.cmml">⁢</mo><mrow id="S3.E16.m1.9.10.2.3.2" xref="S3.E16.m1.9.10.2.3.1.cmml"><mo id="S3.E16.m1.9.10.2.3.2.1" stretchy="false" xref="S3.E16.m1.9.10.2.3.1.cmml">(</mo><mi id="S3.E16.m1.7.7" xref="S3.E16.m1.7.7.cmml">ξ</mi><mo id="S3.E16.m1.9.10.2.3.2.2" xref="S3.E16.m1.9.10.2.3.1.cmml">,</mo><mi id="S3.E16.m1.8.8" xref="S3.E16.m1.8.8.cmml">η</mi><mo id="S3.E16.m1.9.10.2.3.2.3" xref="S3.E16.m1.9.10.2.3.1.cmml">,</mo><mi id="S3.E16.m1.9.9" xref="S3.E16.m1.9.9.cmml">τ</mi><mo id="S3.E16.m1.9.10.2.3.2.4" stretchy="false" xref="S3.E16.m1.9.10.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E16.m1.9.10.1" xref="S3.E16.m1.9.10.1.cmml">=</mo><mrow id="S3.E16.m1.6.6" xref="S3.E16.m1.9.10.3.1.cmml"><mo id="S3.E16.m1.6.6.7" xref="S3.E16.m1.9.10.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E16.m1.6.6.6" rowspacing="0pt" xref="S3.E16.m1.9.10.3.1.cmml"><mtr id="S3.E16.m1.6.6.6a" xref="S3.E16.m1.9.10.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E16.m1.6.6.6b" xref="S3.E16.m1.9.10.3.1.cmml"><mn id="S3.E16.m1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E16.m1.6.6.6c" xref="S3.E16.m1.9.10.3.1.cmml"><mrow id="S3.E16.m1.2.2.2.2.2.1.2" xref="S3.E16.m1.2.2.2.2.2.1.2.1.cmml"><mrow id="S3.E16.m1.2.2.2.2.2.1.2.1" xref="S3.E16.m1.2.2.2.2.2.1.2.1.cmml"><mrow id="S3.E16.m1.2.2.2.2.2.1.2.1.3" xref="S3.E16.m1.2.2.2.2.2.1.2.1.3.cmml"><mtext id="S3.E16.m1.2.2.2.2.2.1.2.1.3.2" xref="S3.E16.m1.2.2.2.2.2.1.2.1.3.2a.cmml">for </mtext><mo id="S3.E16.m1.2.2.2.2.2.1.2.1.3.1" xref="S3.E16.m1.2.2.2.2.2.1.2.1.3.1.cmml">⁢</mo><mi id="S3.E16.m1.2.2.2.2.2.1.2.1.3.3" xref="S3.E16.m1.2.2.2.2.2.1.2.1.3.3.cmml">ξ</mi></mrow><mo id="S3.E16.m1.2.2.2.2.2.1.2.1.2" xref="S3.E16.m1.2.2.2.2.2.1.2.1.2.cmml">=</mo><mrow id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.2.cmml"><mn id="S3.E16.m1.2.2.2.2.2.1.1" xref="S3.E16.m1.2.2.2.2.2.1.1.cmml">0</mn><mo id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.2" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.2.cmml">,</mo><mrow id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.cmml"><mi id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.2" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.2.cmml">η</mi><mo id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.1" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.1.cmml">⁢</mo><mtext id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.3" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.3a.cmml"> in the segment 1 range</mtext></mrow></mrow></mrow><mo id="S3.E16.m1.2.2.2.2.2.1.2.2" xref="S3.E16.m1.2.2.2.2.2.1.2.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E16.m1.6.6.6d" xref="S3.E16.m1.9.10.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E16.m1.6.6.6e" xref="S3.E16.m1.9.10.3.1.cmml"><mn id="S3.E16.m1.3.3.3.3.1.1" xref="S3.E16.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E16.m1.6.6.6f" xref="S3.E16.m1.9.10.3.1.cmml"><mrow id="S3.E16.m1.4.4.4.4.2.1.2" xref="S3.E16.m1.4.4.4.4.2.1.2.1.cmml"><mrow id="S3.E16.m1.4.4.4.4.2.1.2.1" xref="S3.E16.m1.4.4.4.4.2.1.2.1.cmml"><mrow id="S3.E16.m1.4.4.4.4.2.1.2.1.3" xref="S3.E16.m1.4.4.4.4.2.1.2.1.3.cmml"><mtext id="S3.E16.m1.4.4.4.4.2.1.2.1.3.2" xref="S3.E16.m1.4.4.4.4.2.1.2.1.3.2a.cmml">for </mtext><mo id="S3.E16.m1.4.4.4.4.2.1.2.1.3.1" xref="S3.E16.m1.4.4.4.4.2.1.2.1.3.1.cmml">⁢</mo><mi id="S3.E16.m1.4.4.4.4.2.1.2.1.3.3" xref="S3.E16.m1.4.4.4.4.2.1.2.1.3.3.cmml">ξ</mi></mrow><mo id="S3.E16.m1.4.4.4.4.2.1.2.1.2" xref="S3.E16.m1.4.4.4.4.2.1.2.1.2.cmml">=</mo><mrow id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.2.cmml"><mn id="S3.E16.m1.4.4.4.4.2.1.1" xref="S3.E16.m1.4.4.4.4.2.1.1.cmml">1</mn><mo id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.2" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.2.cmml">,</mo><mrow id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.cmml"><mi id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.2" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.2.cmml">η</mi><mo id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.1" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.1.cmml">⁢</mo><mtext id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.3" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.3a.cmml"> in the segment 2 range</mtext></mrow></mrow></mrow><mo id="S3.E16.m1.4.4.4.4.2.1.2.2" xref="S3.E16.m1.4.4.4.4.2.1.2.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E16.m1.6.6.6g" xref="S3.E16.m1.9.10.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E16.m1.6.6.6h" xref="S3.E16.m1.9.10.3.1.cmml"><mrow id="S3.E16.m1.5.5.5.5.1.1" xref="S3.E16.m1.5.5.5.5.1.1.cmml"><mtext id="S3.E16.m1.5.5.5.5.1.1.4" xref="S3.E16.m1.5.5.5.5.1.1.4a.cmml">randomly chosen in </mtext><mo id="S3.E16.m1.5.5.5.5.1.1.3" xref="S3.E16.m1.5.5.5.5.1.1.3.cmml">⁢</mo><mrow id="S3.E16.m1.5.5.5.5.1.1.5.2" xref="S3.E16.m1.5.5.5.5.1.1.5.1.cmml"><mo id="S3.E16.m1.5.5.5.5.1.1.5.2.1" stretchy="false" xref="S3.E16.m1.5.5.5.5.1.1.5.1.cmml">[</mo><mn id="S3.E16.m1.5.5.5.5.1.1.1" xref="S3.E16.m1.5.5.5.5.1.1.1.cmml">0</mn><mo id="S3.E16.m1.5.5.5.5.1.1.5.2.2" xref="S3.E16.m1.5.5.5.5.1.1.5.1.cmml">,</mo><mn id="S3.E16.m1.5.5.5.5.1.1.2" xref="S3.E16.m1.5.5.5.5.1.1.2.cmml">1</mn><mo id="S3.E16.m1.5.5.5.5.1.1.5.2.3" stretchy="false" xref="S3.E16.m1.5.5.5.5.1.1.5.1.cmml">]</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E16.m1.6.6.6i" xref="S3.E16.m1.9.10.3.1.cmml"><mtext id="S3.E16.m1.6.6.6.6.2.1" xref="S3.E16.m1.6.6.6.6.2.1a.cmml">for other boundary points.</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.9b"><apply id="S3.E16.m1.9.10.cmml" xref="S3.E16.m1.9.10"><eq id="S3.E16.m1.9.10.1.cmml" xref="S3.E16.m1.9.10.1"></eq><apply id="S3.E16.m1.9.10.2.cmml" xref="S3.E16.m1.9.10.2"><times id="S3.E16.m1.9.10.2.1.cmml" xref="S3.E16.m1.9.10.2.1"></times><ci id="S3.E16.m1.9.10.2.2.cmml" xref="S3.E16.m1.9.10.2.2">𝜃</ci><vector id="S3.E16.m1.9.10.2.3.1.cmml" xref="S3.E16.m1.9.10.2.3.2"><ci id="S3.E16.m1.7.7.cmml" xref="S3.E16.m1.7.7">𝜉</ci><ci id="S3.E16.m1.8.8.cmml" xref="S3.E16.m1.8.8">𝜂</ci><ci id="S3.E16.m1.9.9.cmml" xref="S3.E16.m1.9.9">𝜏</ci></vector></apply><apply id="S3.E16.m1.9.10.3.1.cmml" xref="S3.E16.m1.6.6"><csymbol cd="latexml" id="S3.E16.m1.9.10.3.1.1.cmml" xref="S3.E16.m1.6.6.7">cases</csymbol><cn id="S3.E16.m1.1.1.1.1.1.1.cmml" type="integer" xref="S3.E16.m1.1.1.1.1.1.1">1</cn><apply id="S3.E16.m1.2.2.2.2.2.1.2.1.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2"><eq id="S3.E16.m1.2.2.2.2.2.1.2.1.2.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.2"></eq><apply id="S3.E16.m1.2.2.2.2.2.1.2.1.3.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.3"><times id="S3.E16.m1.2.2.2.2.2.1.2.1.3.1.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.3.1"></times><ci id="S3.E16.m1.2.2.2.2.2.1.2.1.3.2a.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.3.2"><mtext id="S3.E16.m1.2.2.2.2.2.1.2.1.3.2.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.3.2">for </mtext></ci><ci id="S3.E16.m1.2.2.2.2.2.1.2.1.3.3.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.3.3">𝜉</ci></apply><list id="S3.E16.m1.2.2.2.2.2.1.2.1.1.2.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.1"><cn id="S3.E16.m1.2.2.2.2.2.1.1.cmml" type="integer" xref="S3.E16.m1.2.2.2.2.2.1.1">0</cn><apply id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1"><times id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.1.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.1"></times><ci id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.2.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.2">𝜂</ci><ci id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.3a.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.3"><mtext id="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.3.cmml" xref="S3.E16.m1.2.2.2.2.2.1.2.1.1.1.1.3"> in the segment 1 range</mtext></ci></apply></list></apply><cn id="S3.E16.m1.3.3.3.3.1.1.cmml" type="integer" xref="S3.E16.m1.3.3.3.3.1.1">0</cn><apply id="S3.E16.m1.4.4.4.4.2.1.2.1.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2"><eq id="S3.E16.m1.4.4.4.4.2.1.2.1.2.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.2"></eq><apply id="S3.E16.m1.4.4.4.4.2.1.2.1.3.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.3"><times id="S3.E16.m1.4.4.4.4.2.1.2.1.3.1.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.3.1"></times><ci id="S3.E16.m1.4.4.4.4.2.1.2.1.3.2a.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.3.2"><mtext id="S3.E16.m1.4.4.4.4.2.1.2.1.3.2.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.3.2">for </mtext></ci><ci id="S3.E16.m1.4.4.4.4.2.1.2.1.3.3.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.3.3">𝜉</ci></apply><list id="S3.E16.m1.4.4.4.4.2.1.2.1.1.2.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.1"><cn id="S3.E16.m1.4.4.4.4.2.1.1.cmml" type="integer" xref="S3.E16.m1.4.4.4.4.2.1.1">1</cn><apply id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1"><times id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.1.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.1"></times><ci id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.2.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.2">𝜂</ci><ci id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.3a.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.3"><mtext id="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.3.cmml" xref="S3.E16.m1.4.4.4.4.2.1.2.1.1.1.1.3"> in the segment 2 range</mtext></ci></apply></list></apply><apply id="S3.E16.m1.5.5.5.5.1.1.cmml" xref="S3.E16.m1.5.5.5.5.1.1"><times id="S3.E16.m1.5.5.5.5.1.1.3.cmml" xref="S3.E16.m1.5.5.5.5.1.1.3"></times><ci id="S3.E16.m1.5.5.5.5.1.1.4a.cmml" xref="S3.E16.m1.5.5.5.5.1.1.4"><mtext id="S3.E16.m1.5.5.5.5.1.1.4.cmml" xref="S3.E16.m1.5.5.5.5.1.1.4">randomly chosen in </mtext></ci><interval closure="closed" id="S3.E16.m1.5.5.5.5.1.1.5.1.cmml" xref="S3.E16.m1.5.5.5.5.1.1.5.2"><cn id="S3.E16.m1.5.5.5.5.1.1.1.cmml" type="integer" xref="S3.E16.m1.5.5.5.5.1.1.1">0</cn><cn id="S3.E16.m1.5.5.5.5.1.1.2.cmml" type="integer" xref="S3.E16.m1.5.5.5.5.1.1.2">1</cn></interval></apply><ci id="S3.E16.m1.6.6.6.6.2.1a.cmml" xref="S3.E16.m1.6.6.6.6.2.1"><mtext id="S3.E16.m1.6.6.6.6.2.1.cmml" xref="S3.E16.m1.6.6.6.6.2.1">for other boundary points.</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.9c">\theta(\xi,\eta,\tau)=\begin{cases}1&amp;\text{for }\xi=0,\eta\text{ in the %
segment 1 range},\\
0&amp;\text{for }\xi=1,\eta\text{ in the segment 2 range},\\
\text{randomly chosen in }[0,1]&amp;\text{for other boundary points.}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E16.m1.9d">italic_θ ( italic_ξ , italic_η , italic_τ ) = { start_ROW start_CELL 1 end_CELL start_CELL for italic_ξ = 0 , italic_η in the segment 1 range , end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL for italic_ξ = 1 , italic_η in the segment 2 range , end_CELL end_ROW start_ROW start_CELL randomly chosen in [ 0 , 1 ] end_CELL start_CELL for other boundary points. end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p21">
<p class="ltx_p" id="S3.SS4.p21.6">In the Challenge-2 configuration, the lengths of the boundary segments are again predefined and fixed, but their placement is randomized per simulation. Each segment spans a calculated portion of the grid points along the boundary, depending on the segment’s length relative to the side’s total length. If a segment is placed on the horizontal sides (<math alttext="\xi=0" class="ltx_Math" display="inline" id="S3.SS4.p21.1.m1.1"><semantics id="S3.SS4.p21.1.m1.1a"><mrow id="S3.SS4.p21.1.m1.1.1" xref="S3.SS4.p21.1.m1.1.1.cmml"><mi id="S3.SS4.p21.1.m1.1.1.2" xref="S3.SS4.p21.1.m1.1.1.2.cmml">ξ</mi><mo id="S3.SS4.p21.1.m1.1.1.1" xref="S3.SS4.p21.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS4.p21.1.m1.1.1.3" xref="S3.SS4.p21.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p21.1.m1.1b"><apply id="S3.SS4.p21.1.m1.1.1.cmml" xref="S3.SS4.p21.1.m1.1.1"><eq id="S3.SS4.p21.1.m1.1.1.1.cmml" xref="S3.SS4.p21.1.m1.1.1.1"></eq><ci id="S3.SS4.p21.1.m1.1.1.2.cmml" xref="S3.SS4.p21.1.m1.1.1.2">𝜉</ci><cn id="S3.SS4.p21.1.m1.1.1.3.cmml" type="integer" xref="S3.SS4.p21.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p21.1.m1.1c">\xi=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p21.1.m1.1d">italic_ξ = 0</annotation></semantics></math> or <math alttext="\xi=1" class="ltx_Math" display="inline" id="S3.SS4.p21.2.m2.1"><semantics id="S3.SS4.p21.2.m2.1a"><mrow id="S3.SS4.p21.2.m2.1.1" xref="S3.SS4.p21.2.m2.1.1.cmml"><mi id="S3.SS4.p21.2.m2.1.1.2" xref="S3.SS4.p21.2.m2.1.1.2.cmml">ξ</mi><mo id="S3.SS4.p21.2.m2.1.1.1" xref="S3.SS4.p21.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS4.p21.2.m2.1.1.3" xref="S3.SS4.p21.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p21.2.m2.1b"><apply id="S3.SS4.p21.2.m2.1.1.cmml" xref="S3.SS4.p21.2.m2.1.1"><eq id="S3.SS4.p21.2.m2.1.1.1.cmml" xref="S3.SS4.p21.2.m2.1.1.1"></eq><ci id="S3.SS4.p21.2.m2.1.1.2.cmml" xref="S3.SS4.p21.2.m2.1.1.2">𝜉</ci><cn id="S3.SS4.p21.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.p21.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p21.2.m2.1c">\xi=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p21.2.m2.1d">italic_ξ = 1</annotation></semantics></math>), it spans across the <math alttext="\eta" class="ltx_Math" display="inline" id="S3.SS4.p21.3.m3.1"><semantics id="S3.SS4.p21.3.m3.1a"><mi id="S3.SS4.p21.3.m3.1.1" xref="S3.SS4.p21.3.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p21.3.m3.1b"><ci id="S3.SS4.p21.3.m3.1.1.cmml" xref="S3.SS4.p21.3.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p21.3.m3.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p21.3.m3.1d">italic_η</annotation></semantics></math> dimension within a specified range; similarly, if on the vertical sides (<math alttext="\eta=0" class="ltx_Math" display="inline" id="S3.SS4.p21.4.m4.1"><semantics id="S3.SS4.p21.4.m4.1a"><mrow id="S3.SS4.p21.4.m4.1.1" xref="S3.SS4.p21.4.m4.1.1.cmml"><mi id="S3.SS4.p21.4.m4.1.1.2" xref="S3.SS4.p21.4.m4.1.1.2.cmml">η</mi><mo id="S3.SS4.p21.4.m4.1.1.1" xref="S3.SS4.p21.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS4.p21.4.m4.1.1.3" xref="S3.SS4.p21.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p21.4.m4.1b"><apply id="S3.SS4.p21.4.m4.1.1.cmml" xref="S3.SS4.p21.4.m4.1.1"><eq id="S3.SS4.p21.4.m4.1.1.1.cmml" xref="S3.SS4.p21.4.m4.1.1.1"></eq><ci id="S3.SS4.p21.4.m4.1.1.2.cmml" xref="S3.SS4.p21.4.m4.1.1.2">𝜂</ci><cn id="S3.SS4.p21.4.m4.1.1.3.cmml" type="integer" xref="S3.SS4.p21.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p21.4.m4.1c">\eta=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p21.4.m4.1d">italic_η = 0</annotation></semantics></math> or <math alttext="\eta=1" class="ltx_Math" display="inline" id="S3.SS4.p21.5.m5.1"><semantics id="S3.SS4.p21.5.m5.1a"><mrow id="S3.SS4.p21.5.m5.1.1" xref="S3.SS4.p21.5.m5.1.1.cmml"><mi id="S3.SS4.p21.5.m5.1.1.2" xref="S3.SS4.p21.5.m5.1.1.2.cmml">η</mi><mo id="S3.SS4.p21.5.m5.1.1.1" xref="S3.SS4.p21.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS4.p21.5.m5.1.1.3" xref="S3.SS4.p21.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p21.5.m5.1b"><apply id="S3.SS4.p21.5.m5.1.1.cmml" xref="S3.SS4.p21.5.m5.1.1"><eq id="S3.SS4.p21.5.m5.1.1.1.cmml" xref="S3.SS4.p21.5.m5.1.1.1"></eq><ci id="S3.SS4.p21.5.m5.1.1.2.cmml" xref="S3.SS4.p21.5.m5.1.1.2">𝜂</ci><cn id="S3.SS4.p21.5.m5.1.1.3.cmml" type="integer" xref="S3.SS4.p21.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p21.5.m5.1c">\eta=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p21.5.m5.1d">italic_η = 1</annotation></semantics></math>), it spans across the <math alttext="\xi" class="ltx_Math" display="inline" id="S3.SS4.p21.6.m6.1"><semantics id="S3.SS4.p21.6.m6.1a"><mi id="S3.SS4.p21.6.m6.1.1" xref="S3.SS4.p21.6.m6.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p21.6.m6.1b"><ci id="S3.SS4.p21.6.m6.1.1.cmml" xref="S3.SS4.p21.6.m6.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p21.6.m6.1c">\xi</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p21.6.m6.1d">italic_ξ</annotation></semantics></math> dimension. The non-dimensional temperatures for the grid points within these segments are set to either 1 or 0, while the remainder of the boundary follows a specified pattern or random assignment within the normalized range, ensuring that segments do not overlap and appear on different sides:</p>
</div>
<div class="ltx_para" id="S3.SS4.p22">
<table class="ltx_equation ltx_eqn_table" id="S3.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\theta(\xi,\eta,\tau)=\begin{cases}1&amp;\text{for }\xi,\eta\text{ in the segment %
1 range},\\
0&amp;\text{for }\xi,\eta\text{ in the segment 2 range},\\
\text{randomly chosen in }[0,1]&amp;\text{for other boundary points.}\end{cases}" class="ltx_Math" display="block" id="S3.E17.m1.9"><semantics id="S3.E17.m1.9a"><mrow id="S3.E17.m1.9.10" xref="S3.E17.m1.9.10.cmml"><mrow id="S3.E17.m1.9.10.2" xref="S3.E17.m1.9.10.2.cmml"><mi id="S3.E17.m1.9.10.2.2" xref="S3.E17.m1.9.10.2.2.cmml">θ</mi><mo id="S3.E17.m1.9.10.2.1" xref="S3.E17.m1.9.10.2.1.cmml">⁢</mo><mrow id="S3.E17.m1.9.10.2.3.2" xref="S3.E17.m1.9.10.2.3.1.cmml"><mo id="S3.E17.m1.9.10.2.3.2.1" stretchy="false" xref="S3.E17.m1.9.10.2.3.1.cmml">(</mo><mi id="S3.E17.m1.7.7" xref="S3.E17.m1.7.7.cmml">ξ</mi><mo id="S3.E17.m1.9.10.2.3.2.2" xref="S3.E17.m1.9.10.2.3.1.cmml">,</mo><mi id="S3.E17.m1.8.8" xref="S3.E17.m1.8.8.cmml">η</mi><mo id="S3.E17.m1.9.10.2.3.2.3" xref="S3.E17.m1.9.10.2.3.1.cmml">,</mo><mi id="S3.E17.m1.9.9" xref="S3.E17.m1.9.9.cmml">τ</mi><mo id="S3.E17.m1.9.10.2.3.2.4" stretchy="false" xref="S3.E17.m1.9.10.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E17.m1.9.10.1" xref="S3.E17.m1.9.10.1.cmml">=</mo><mrow id="S3.E17.m1.6.6" xref="S3.E17.m1.9.10.3.1.cmml"><mo id="S3.E17.m1.6.6.7" xref="S3.E17.m1.9.10.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E17.m1.6.6.6" rowspacing="0pt" xref="S3.E17.m1.9.10.3.1.cmml"><mtr id="S3.E17.m1.6.6.6a" xref="S3.E17.m1.9.10.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E17.m1.6.6.6b" xref="S3.E17.m1.9.10.3.1.cmml"><mn id="S3.E17.m1.1.1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E17.m1.6.6.6c" xref="S3.E17.m1.9.10.3.1.cmml"><mrow id="S3.E17.m1.2.2.2.2.2.1.1" xref="S3.E17.m1.9.10.3.1.cmml"><mrow id="S3.E17.m1.2.2.2.2.2.1.1.1.2" xref="S3.E17.m1.2.2.2.2.2.1.1.1.3.cmml"><mrow id="S3.E17.m1.2.2.2.2.2.1.1.1.1.1" xref="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.cmml"><mtext id="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.2" xref="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.2a.cmml">for </mtext><mo id="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.1" xref="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.3" xref="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.3.cmml">ξ</mi></mrow><mo id="S3.E17.m1.2.2.2.2.2.1.1.1.2.3" xref="S3.E17.m1.2.2.2.2.2.1.1.1.3.cmml">,</mo><mrow id="S3.E17.m1.2.2.2.2.2.1.1.1.2.2" xref="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.cmml"><mi id="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.2" xref="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.2.cmml">η</mi><mo id="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.1" xref="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.1.cmml">⁢</mo><mtext id="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.3" xref="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.3a.cmml"> in the segment 1 range</mtext></mrow></mrow><mo id="S3.E17.m1.2.2.2.2.2.1.1.2" xref="S3.E17.m1.9.10.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E17.m1.6.6.6d" xref="S3.E17.m1.9.10.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E17.m1.6.6.6e" xref="S3.E17.m1.9.10.3.1.cmml"><mn id="S3.E17.m1.3.3.3.3.1.1" xref="S3.E17.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E17.m1.6.6.6f" xref="S3.E17.m1.9.10.3.1.cmml"><mrow id="S3.E17.m1.4.4.4.4.2.1.1" xref="S3.E17.m1.9.10.3.1.cmml"><mrow id="S3.E17.m1.4.4.4.4.2.1.1.1.2" xref="S3.E17.m1.4.4.4.4.2.1.1.1.3.cmml"><mrow id="S3.E17.m1.4.4.4.4.2.1.1.1.1.1" xref="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.cmml"><mtext id="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.2" xref="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.2a.cmml">for </mtext><mo id="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.1" xref="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.3" xref="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.3.cmml">ξ</mi></mrow><mo id="S3.E17.m1.4.4.4.4.2.1.1.1.2.3" xref="S3.E17.m1.4.4.4.4.2.1.1.1.3.cmml">,</mo><mrow id="S3.E17.m1.4.4.4.4.2.1.1.1.2.2" xref="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.cmml"><mi id="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.2" xref="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.2.cmml">η</mi><mo id="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.1" xref="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.1.cmml">⁢</mo><mtext id="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.3" xref="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.3a.cmml"> in the segment 2 range</mtext></mrow></mrow><mo id="S3.E17.m1.4.4.4.4.2.1.1.2" xref="S3.E17.m1.9.10.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E17.m1.6.6.6g" xref="S3.E17.m1.9.10.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E17.m1.6.6.6h" xref="S3.E17.m1.9.10.3.1.cmml"><mrow id="S3.E17.m1.5.5.5.5.1.1" xref="S3.E17.m1.5.5.5.5.1.1.cmml"><mtext id="S3.E17.m1.5.5.5.5.1.1.4" xref="S3.E17.m1.5.5.5.5.1.1.4a.cmml">randomly chosen in </mtext><mo id="S3.E17.m1.5.5.5.5.1.1.3" xref="S3.E17.m1.5.5.5.5.1.1.3.cmml">⁢</mo><mrow id="S3.E17.m1.5.5.5.5.1.1.5.2" xref="S3.E17.m1.5.5.5.5.1.1.5.1.cmml"><mo id="S3.E17.m1.5.5.5.5.1.1.5.2.1" stretchy="false" xref="S3.E17.m1.5.5.5.5.1.1.5.1.cmml">[</mo><mn id="S3.E17.m1.5.5.5.5.1.1.1" xref="S3.E17.m1.5.5.5.5.1.1.1.cmml">0</mn><mo id="S3.E17.m1.5.5.5.5.1.1.5.2.2" xref="S3.E17.m1.5.5.5.5.1.1.5.1.cmml">,</mo><mn id="S3.E17.m1.5.5.5.5.1.1.2" xref="S3.E17.m1.5.5.5.5.1.1.2.cmml">1</mn><mo id="S3.E17.m1.5.5.5.5.1.1.5.2.3" stretchy="false" xref="S3.E17.m1.5.5.5.5.1.1.5.1.cmml">]</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E17.m1.6.6.6i" xref="S3.E17.m1.9.10.3.1.cmml"><mtext id="S3.E17.m1.6.6.6.6.2.1" xref="S3.E17.m1.6.6.6.6.2.1a.cmml">for other boundary points.</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.9b"><apply id="S3.E17.m1.9.10.cmml" xref="S3.E17.m1.9.10"><eq id="S3.E17.m1.9.10.1.cmml" xref="S3.E17.m1.9.10.1"></eq><apply id="S3.E17.m1.9.10.2.cmml" xref="S3.E17.m1.9.10.2"><times id="S3.E17.m1.9.10.2.1.cmml" xref="S3.E17.m1.9.10.2.1"></times><ci id="S3.E17.m1.9.10.2.2.cmml" xref="S3.E17.m1.9.10.2.2">𝜃</ci><vector id="S3.E17.m1.9.10.2.3.1.cmml" xref="S3.E17.m1.9.10.2.3.2"><ci id="S3.E17.m1.7.7.cmml" xref="S3.E17.m1.7.7">𝜉</ci><ci id="S3.E17.m1.8.8.cmml" xref="S3.E17.m1.8.8">𝜂</ci><ci id="S3.E17.m1.9.9.cmml" xref="S3.E17.m1.9.9">𝜏</ci></vector></apply><apply id="S3.E17.m1.9.10.3.1.cmml" xref="S3.E17.m1.6.6"><csymbol cd="latexml" id="S3.E17.m1.9.10.3.1.1.cmml" xref="S3.E17.m1.6.6.7">cases</csymbol><cn id="S3.E17.m1.1.1.1.1.1.1.cmml" type="integer" xref="S3.E17.m1.1.1.1.1.1.1">1</cn><list id="S3.E17.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.2"><apply id="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.1.1"><times id="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.1"></times><ci id="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.2a.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.2"><mtext id="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.2">for </mtext></ci><ci id="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.1.1.3">𝜉</ci></apply><apply id="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.2.2"><times id="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.1.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.1"></times><ci id="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.2.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.2">𝜂</ci><ci id="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.3a.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.3"><mtext id="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.3.cmml" xref="S3.E17.m1.2.2.2.2.2.1.1.1.2.2.3"> in the segment 1 range</mtext></ci></apply></list><cn id="S3.E17.m1.3.3.3.3.1.1.cmml" type="integer" xref="S3.E17.m1.3.3.3.3.1.1">0</cn><list id="S3.E17.m1.4.4.4.4.2.1.1.1.3.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.2"><apply id="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.1.1"><times id="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.1.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.1"></times><ci id="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.2a.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.2"><mtext id="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.2.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.2">for </mtext></ci><ci id="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.3.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.1.1.3">𝜉</ci></apply><apply id="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.2.2"><times id="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.1.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.1"></times><ci id="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.2.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.2">𝜂</ci><ci id="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.3a.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.3"><mtext id="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.3.cmml" xref="S3.E17.m1.4.4.4.4.2.1.1.1.2.2.3"> in the segment 2 range</mtext></ci></apply></list><apply id="S3.E17.m1.5.5.5.5.1.1.cmml" xref="S3.E17.m1.5.5.5.5.1.1"><times id="S3.E17.m1.5.5.5.5.1.1.3.cmml" xref="S3.E17.m1.5.5.5.5.1.1.3"></times><ci id="S3.E17.m1.5.5.5.5.1.1.4a.cmml" xref="S3.E17.m1.5.5.5.5.1.1.4"><mtext id="S3.E17.m1.5.5.5.5.1.1.4.cmml" xref="S3.E17.m1.5.5.5.5.1.1.4">randomly chosen in </mtext></ci><interval closure="closed" id="S3.E17.m1.5.5.5.5.1.1.5.1.cmml" xref="S3.E17.m1.5.5.5.5.1.1.5.2"><cn id="S3.E17.m1.5.5.5.5.1.1.1.cmml" type="integer" xref="S3.E17.m1.5.5.5.5.1.1.1">0</cn><cn id="S3.E17.m1.5.5.5.5.1.1.2.cmml" type="integer" xref="S3.E17.m1.5.5.5.5.1.1.2">1</cn></interval></apply><ci id="S3.E17.m1.6.6.6.6.2.1a.cmml" xref="S3.E17.m1.6.6.6.6.2.1"><mtext id="S3.E17.m1.6.6.6.6.2.1.cmml" xref="S3.E17.m1.6.6.6.6.2.1">for other boundary points.</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.9c">\theta(\xi,\eta,\tau)=\begin{cases}1&amp;\text{for }\xi,\eta\text{ in the segment %
1 range},\\
0&amp;\text{for }\xi,\eta\text{ in the segment 2 range},\\
\text{randomly chosen in }[0,1]&amp;\text{for other boundary points.}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E17.m1.9d">italic_θ ( italic_ξ , italic_η , italic_τ ) = { start_ROW start_CELL 1 end_CELL start_CELL for italic_ξ , italic_η in the segment 1 range , end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL for italic_ξ , italic_η in the segment 2 range , end_CELL end_ROW start_ROW start_CELL randomly chosen in [ 0 , 1 ] end_CELL start_CELL for other boundary points. end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p22.1">In the examples considered in this work, the length of the boundary segments was chosen to be four computational nodes, corresponding to <math alttext="{1}/{6}" class="ltx_Math" display="inline" id="S3.SS4.p22.1.m1.1"><semantics id="S3.SS4.p22.1.m1.1a"><mrow id="S3.SS4.p22.1.m1.1.1" xref="S3.SS4.p22.1.m1.1.1.cmml"><mn id="S3.SS4.p22.1.m1.1.1.2" xref="S3.SS4.p22.1.m1.1.1.2.cmml">1</mn><mo id="S3.SS4.p22.1.m1.1.1.1" xref="S3.SS4.p22.1.m1.1.1.1.cmml">/</mo><mn id="S3.SS4.p22.1.m1.1.1.3" xref="S3.SS4.p22.1.m1.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p22.1.m1.1b"><apply id="S3.SS4.p22.1.m1.1.1.cmml" xref="S3.SS4.p22.1.m1.1.1"><divide id="S3.SS4.p22.1.m1.1.1.1.cmml" xref="S3.SS4.p22.1.m1.1.1.1"></divide><cn id="S3.SS4.p22.1.m1.1.1.2.cmml" type="integer" xref="S3.SS4.p22.1.m1.1.1.2">1</cn><cn id="S3.SS4.p22.1.m1.1.1.3.cmml" type="integer" xref="S3.SS4.p22.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p22.1.m1.1c">{1}/{6}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p22.1.m1.1d">1 / 6</annotation></semantics></math> of the interior nodes of the domain.</p>
</div>
<div class="ltx_para" id="S3.SS4.p23">
<p class="ltx_p" id="S3.SS4.p23.1">These configurations introduce an element of complexity and unpredictability in the thermal boundary conditions, challenging the model to adapt and learn from a wider array of scenarios than those it encountered during training. This setup is specifically designed to test the robustness of the model’s generalization capabilities and its ability to discern and react to significant changes in boundary-driven thermal gradients. The impact of these boundary conditions on the learning process, particularly on the adaptation and emphasis of features by the final projection layer, is a focal point of analysis in this study. To illustrate this initialization, an example of two actual initial temperature fields used in the challenge configuration are shown below.</p>
</div>
<figure class="ltx_figure" id="S3.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="244" id="S3.F13.g1" src="extracted/5903850/FIGURES/DOMAIN/example_4_step_0.png" width="269"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="244" id="S3.F13.g2" src="extracted/5903850/FIGURES/DOMAIN/example_5_step_0.png" width="269"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F13.2.1.1" style="font-size:90%;">Figure 13</span>: </span><span class="ltx_text" id="S3.F13.3.2" style="font-size:90%;">Two initial temperature fields generated in the Challenge-2 configuration. The Dirichlet temperatures are chosen randomly in the range [0,1] (left, top and right) and [0,0.10] (bottom) independently of each other. The uniform internal temperature is also randomly initialized in [0, 1]. The two boundary segments are of equal and pre-specified length but their placement on different sides on the plate boundaries is random. </span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>The physics-informed loss</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">An important aspect of the Transformer model implementation is that the standard mean square error (MSE) loss is augmented with physics-informed components that we have found to be important in maintaining the alignment of the predictions with the underlying physics. In particular, the total loss <math alttext="L" class="ltx_Math" display="inline" id="S3.SS5.p1.1.m1.1"><semantics id="S3.SS5.p1.1.m1.1a"><mi id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><ci id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.1d">italic_L</annotation></semantics></math> consists of the sum</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="L=L_{\text{mse}}+\lambda_{\text{PI}}L_{\text{physics}}+\lambda_{\text{BC}}L_{%
\text{boundary}}+\lambda_{\text{IC}}L_{\text{initial}}" class="ltx_Math" display="block" id="S3.E18.m1.1"><semantics id="S3.E18.m1.1a"><mrow id="S3.E18.m1.1.1" xref="S3.E18.m1.1.1.cmml"><mi id="S3.E18.m1.1.1.2" xref="S3.E18.m1.1.1.2.cmml">L</mi><mo id="S3.E18.m1.1.1.1" xref="S3.E18.m1.1.1.1.cmml">=</mo><mrow id="S3.E18.m1.1.1.3" xref="S3.E18.m1.1.1.3.cmml"><msub id="S3.E18.m1.1.1.3.2" xref="S3.E18.m1.1.1.3.2.cmml"><mi id="S3.E18.m1.1.1.3.2.2" xref="S3.E18.m1.1.1.3.2.2.cmml">L</mi><mtext id="S3.E18.m1.1.1.3.2.3" xref="S3.E18.m1.1.1.3.2.3a.cmml">mse</mtext></msub><mo id="S3.E18.m1.1.1.3.1" xref="S3.E18.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E18.m1.1.1.3.3" xref="S3.E18.m1.1.1.3.3.cmml"><msub id="S3.E18.m1.1.1.3.3.2" xref="S3.E18.m1.1.1.3.3.2.cmml"><mi id="S3.E18.m1.1.1.3.3.2.2" xref="S3.E18.m1.1.1.3.3.2.2.cmml">λ</mi><mtext id="S3.E18.m1.1.1.3.3.2.3" xref="S3.E18.m1.1.1.3.3.2.3a.cmml">PI</mtext></msub><mo id="S3.E18.m1.1.1.3.3.1" xref="S3.E18.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E18.m1.1.1.3.3.3" xref="S3.E18.m1.1.1.3.3.3.cmml"><mi id="S3.E18.m1.1.1.3.3.3.2" xref="S3.E18.m1.1.1.3.3.3.2.cmml">L</mi><mtext id="S3.E18.m1.1.1.3.3.3.3" xref="S3.E18.m1.1.1.3.3.3.3a.cmml">physics</mtext></msub></mrow><mo id="S3.E18.m1.1.1.3.1a" xref="S3.E18.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E18.m1.1.1.3.4" xref="S3.E18.m1.1.1.3.4.cmml"><msub id="S3.E18.m1.1.1.3.4.2" xref="S3.E18.m1.1.1.3.4.2.cmml"><mi id="S3.E18.m1.1.1.3.4.2.2" xref="S3.E18.m1.1.1.3.4.2.2.cmml">λ</mi><mtext id="S3.E18.m1.1.1.3.4.2.3" xref="S3.E18.m1.1.1.3.4.2.3a.cmml">BC</mtext></msub><mo id="S3.E18.m1.1.1.3.4.1" xref="S3.E18.m1.1.1.3.4.1.cmml">⁢</mo><msub id="S3.E18.m1.1.1.3.4.3" xref="S3.E18.m1.1.1.3.4.3.cmml"><mi id="S3.E18.m1.1.1.3.4.3.2" xref="S3.E18.m1.1.1.3.4.3.2.cmml">L</mi><mtext id="S3.E18.m1.1.1.3.4.3.3" xref="S3.E18.m1.1.1.3.4.3.3a.cmml">boundary</mtext></msub></mrow><mo id="S3.E18.m1.1.1.3.1b" xref="S3.E18.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E18.m1.1.1.3.5" xref="S3.E18.m1.1.1.3.5.cmml"><msub id="S3.E18.m1.1.1.3.5.2" xref="S3.E18.m1.1.1.3.5.2.cmml"><mi id="S3.E18.m1.1.1.3.5.2.2" xref="S3.E18.m1.1.1.3.5.2.2.cmml">λ</mi><mtext id="S3.E18.m1.1.1.3.5.2.3" xref="S3.E18.m1.1.1.3.5.2.3a.cmml">IC</mtext></msub><mo id="S3.E18.m1.1.1.3.5.1" xref="S3.E18.m1.1.1.3.5.1.cmml">⁢</mo><msub id="S3.E18.m1.1.1.3.5.3" xref="S3.E18.m1.1.1.3.5.3.cmml"><mi id="S3.E18.m1.1.1.3.5.3.2" xref="S3.E18.m1.1.1.3.5.3.2.cmml">L</mi><mtext id="S3.E18.m1.1.1.3.5.3.3" xref="S3.E18.m1.1.1.3.5.3.3a.cmml">initial</mtext></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m1.1b"><apply id="S3.E18.m1.1.1.cmml" xref="S3.E18.m1.1.1"><eq id="S3.E18.m1.1.1.1.cmml" xref="S3.E18.m1.1.1.1"></eq><ci id="S3.E18.m1.1.1.2.cmml" xref="S3.E18.m1.1.1.2">𝐿</ci><apply id="S3.E18.m1.1.1.3.cmml" xref="S3.E18.m1.1.1.3"><plus id="S3.E18.m1.1.1.3.1.cmml" xref="S3.E18.m1.1.1.3.1"></plus><apply id="S3.E18.m1.1.1.3.2.cmml" xref="S3.E18.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.2.1.cmml" xref="S3.E18.m1.1.1.3.2">subscript</csymbol><ci id="S3.E18.m1.1.1.3.2.2.cmml" xref="S3.E18.m1.1.1.3.2.2">𝐿</ci><ci id="S3.E18.m1.1.1.3.2.3a.cmml" xref="S3.E18.m1.1.1.3.2.3"><mtext id="S3.E18.m1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E18.m1.1.1.3.2.3">mse</mtext></ci></apply><apply id="S3.E18.m1.1.1.3.3.cmml" xref="S3.E18.m1.1.1.3.3"><times id="S3.E18.m1.1.1.3.3.1.cmml" xref="S3.E18.m1.1.1.3.3.1"></times><apply id="S3.E18.m1.1.1.3.3.2.cmml" xref="S3.E18.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.3.2.1.cmml" xref="S3.E18.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E18.m1.1.1.3.3.2.2.cmml" xref="S3.E18.m1.1.1.3.3.2.2">𝜆</ci><ci id="S3.E18.m1.1.1.3.3.2.3a.cmml" xref="S3.E18.m1.1.1.3.3.2.3"><mtext id="S3.E18.m1.1.1.3.3.2.3.cmml" mathsize="70%" xref="S3.E18.m1.1.1.3.3.2.3">PI</mtext></ci></apply><apply id="S3.E18.m1.1.1.3.3.3.cmml" xref="S3.E18.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.3.3.1.cmml" xref="S3.E18.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E18.m1.1.1.3.3.3.2.cmml" xref="S3.E18.m1.1.1.3.3.3.2">𝐿</ci><ci id="S3.E18.m1.1.1.3.3.3.3a.cmml" xref="S3.E18.m1.1.1.3.3.3.3"><mtext id="S3.E18.m1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S3.E18.m1.1.1.3.3.3.3">physics</mtext></ci></apply></apply><apply id="S3.E18.m1.1.1.3.4.cmml" xref="S3.E18.m1.1.1.3.4"><times id="S3.E18.m1.1.1.3.4.1.cmml" xref="S3.E18.m1.1.1.3.4.1"></times><apply id="S3.E18.m1.1.1.3.4.2.cmml" xref="S3.E18.m1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.4.2.1.cmml" xref="S3.E18.m1.1.1.3.4.2">subscript</csymbol><ci id="S3.E18.m1.1.1.3.4.2.2.cmml" xref="S3.E18.m1.1.1.3.4.2.2">𝜆</ci><ci id="S3.E18.m1.1.1.3.4.2.3a.cmml" xref="S3.E18.m1.1.1.3.4.2.3"><mtext id="S3.E18.m1.1.1.3.4.2.3.cmml" mathsize="70%" xref="S3.E18.m1.1.1.3.4.2.3">BC</mtext></ci></apply><apply id="S3.E18.m1.1.1.3.4.3.cmml" xref="S3.E18.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.4.3.1.cmml" xref="S3.E18.m1.1.1.3.4.3">subscript</csymbol><ci id="S3.E18.m1.1.1.3.4.3.2.cmml" xref="S3.E18.m1.1.1.3.4.3.2">𝐿</ci><ci id="S3.E18.m1.1.1.3.4.3.3a.cmml" xref="S3.E18.m1.1.1.3.4.3.3"><mtext id="S3.E18.m1.1.1.3.4.3.3.cmml" mathsize="70%" xref="S3.E18.m1.1.1.3.4.3.3">boundary</mtext></ci></apply></apply><apply id="S3.E18.m1.1.1.3.5.cmml" xref="S3.E18.m1.1.1.3.5"><times id="S3.E18.m1.1.1.3.5.1.cmml" xref="S3.E18.m1.1.1.3.5.1"></times><apply id="S3.E18.m1.1.1.3.5.2.cmml" xref="S3.E18.m1.1.1.3.5.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.5.2.1.cmml" xref="S3.E18.m1.1.1.3.5.2">subscript</csymbol><ci id="S3.E18.m1.1.1.3.5.2.2.cmml" xref="S3.E18.m1.1.1.3.5.2.2">𝜆</ci><ci id="S3.E18.m1.1.1.3.5.2.3a.cmml" xref="S3.E18.m1.1.1.3.5.2.3"><mtext id="S3.E18.m1.1.1.3.5.2.3.cmml" mathsize="70%" xref="S3.E18.m1.1.1.3.5.2.3">IC</mtext></ci></apply><apply id="S3.E18.m1.1.1.3.5.3.cmml" xref="S3.E18.m1.1.1.3.5.3"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.3.5.3.1.cmml" xref="S3.E18.m1.1.1.3.5.3">subscript</csymbol><ci id="S3.E18.m1.1.1.3.5.3.2.cmml" xref="S3.E18.m1.1.1.3.5.3.2">𝐿</ci><ci id="S3.E18.m1.1.1.3.5.3.3a.cmml" xref="S3.E18.m1.1.1.3.5.3.3"><mtext id="S3.E18.m1.1.1.3.5.3.3.cmml" mathsize="70%" xref="S3.E18.m1.1.1.3.5.3.3">initial</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.1c">L=L_{\text{mse}}+\lambda_{\text{PI}}L_{\text{physics}}+\lambda_{\text{BC}}L_{%
\text{boundary}}+\lambda_{\text{IC}}L_{\text{initial}}</annotation><annotation encoding="application/x-llamapun" id="S3.E18.m1.1d">italic_L = italic_L start_POSTSUBSCRIPT mse end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT PI end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT physics end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT BC end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT boundary end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT IC end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT initial end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.7">where <math alttext="L_{\text{mse}}" class="ltx_Math" display="inline" id="S3.SS5.p3.1.m1.1"><semantics id="S3.SS5.p3.1.m1.1a"><msub id="S3.SS5.p3.1.m1.1.1" xref="S3.SS5.p3.1.m1.1.1.cmml"><mi id="S3.SS5.p3.1.m1.1.1.2" xref="S3.SS5.p3.1.m1.1.1.2.cmml">L</mi><mtext id="S3.SS5.p3.1.m1.1.1.3" xref="S3.SS5.p3.1.m1.1.1.3a.cmml">mse</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.1.m1.1b"><apply id="S3.SS5.p3.1.m1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.1.m1.1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p3.1.m1.1.1.2.cmml" xref="S3.SS5.p3.1.m1.1.1.2">𝐿</ci><ci id="S3.SS5.p3.1.m1.1.1.3a.cmml" xref="S3.SS5.p3.1.m1.1.1.3"><mtext id="S3.SS5.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p3.1.m1.1.1.3">mse</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.1.m1.1c">L_{\text{mse}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.1.m1.1d">italic_L start_POSTSUBSCRIPT mse end_POSTSUBSCRIPT</annotation></semantics></math> is the standard mean square error loss, <math alttext="L_{\text{physics}}" class="ltx_Math" display="inline" id="S3.SS5.p3.2.m2.1"><semantics id="S3.SS5.p3.2.m2.1a"><msub id="S3.SS5.p3.2.m2.1.1" xref="S3.SS5.p3.2.m2.1.1.cmml"><mi id="S3.SS5.p3.2.m2.1.1.2" xref="S3.SS5.p3.2.m2.1.1.2.cmml">L</mi><mtext id="S3.SS5.p3.2.m2.1.1.3" xref="S3.SS5.p3.2.m2.1.1.3a.cmml">physics</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.2.m2.1b"><apply id="S3.SS5.p3.2.m2.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.1.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.p3.2.m2.1.1.2.cmml" xref="S3.SS5.p3.2.m2.1.1.2">𝐿</ci><ci id="S3.SS5.p3.2.m2.1.1.3a.cmml" xref="S3.SS5.p3.2.m2.1.1.3"><mtext id="S3.SS5.p3.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p3.2.m2.1.1.3">physics</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.2.m2.1c">L_{\text{physics}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.2.m2.1d">italic_L start_POSTSUBSCRIPT physics end_POSTSUBSCRIPT</annotation></semantics></math> is the physics-informed loss, <math alttext="L_{\text{boundary}}" class="ltx_Math" display="inline" id="S3.SS5.p3.3.m3.1"><semantics id="S3.SS5.p3.3.m3.1a"><msub id="S3.SS5.p3.3.m3.1.1" xref="S3.SS5.p3.3.m3.1.1.cmml"><mi id="S3.SS5.p3.3.m3.1.1.2" xref="S3.SS5.p3.3.m3.1.1.2.cmml">L</mi><mtext id="S3.SS5.p3.3.m3.1.1.3" xref="S3.SS5.p3.3.m3.1.1.3a.cmml">boundary</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.3.m3.1b"><apply id="S3.SS5.p3.3.m3.1.1.cmml" xref="S3.SS5.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.3.m3.1.1.1.cmml" xref="S3.SS5.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS5.p3.3.m3.1.1.2.cmml" xref="S3.SS5.p3.3.m3.1.1.2">𝐿</ci><ci id="S3.SS5.p3.3.m3.1.1.3a.cmml" xref="S3.SS5.p3.3.m3.1.1.3"><mtext id="S3.SS5.p3.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p3.3.m3.1.1.3">boundary</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.3.m3.1c">L_{\text{boundary}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.3.m3.1d">italic_L start_POSTSUBSCRIPT boundary end_POSTSUBSCRIPT</annotation></semantics></math> is the boundary condition loss, and <math alttext="L_{\text{initial}}" class="ltx_Math" display="inline" id="S3.SS5.p3.4.m4.1"><semantics id="S3.SS5.p3.4.m4.1a"><msub id="S3.SS5.p3.4.m4.1.1" xref="S3.SS5.p3.4.m4.1.1.cmml"><mi id="S3.SS5.p3.4.m4.1.1.2" xref="S3.SS5.p3.4.m4.1.1.2.cmml">L</mi><mtext id="S3.SS5.p3.4.m4.1.1.3" xref="S3.SS5.p3.4.m4.1.1.3a.cmml">initial</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.4.m4.1b"><apply id="S3.SS5.p3.4.m4.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.4.m4.1.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS5.p3.4.m4.1.1.2.cmml" xref="S3.SS5.p3.4.m4.1.1.2">𝐿</ci><ci id="S3.SS5.p3.4.m4.1.1.3a.cmml" xref="S3.SS5.p3.4.m4.1.1.3"><mtext id="S3.SS5.p3.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p3.4.m4.1.1.3">initial</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.4.m4.1c">L_{\text{initial}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.4.m4.1d">italic_L start_POSTSUBSCRIPT initial end_POSTSUBSCRIPT</annotation></semantics></math> is the initial condition loss. The weights <math alttext="\lambda_{\text{PI}}" class="ltx_Math" display="inline" id="S3.SS5.p3.5.m5.1"><semantics id="S3.SS5.p3.5.m5.1a"><msub id="S3.SS5.p3.5.m5.1.1" xref="S3.SS5.p3.5.m5.1.1.cmml"><mi id="S3.SS5.p3.5.m5.1.1.2" xref="S3.SS5.p3.5.m5.1.1.2.cmml">λ</mi><mtext id="S3.SS5.p3.5.m5.1.1.3" xref="S3.SS5.p3.5.m5.1.1.3a.cmml">PI</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.5.m5.1b"><apply id="S3.SS5.p3.5.m5.1.1.cmml" xref="S3.SS5.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.5.m5.1.1.1.cmml" xref="S3.SS5.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS5.p3.5.m5.1.1.2.cmml" xref="S3.SS5.p3.5.m5.1.1.2">𝜆</ci><ci id="S3.SS5.p3.5.m5.1.1.3a.cmml" xref="S3.SS5.p3.5.m5.1.1.3"><mtext id="S3.SS5.p3.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p3.5.m5.1.1.3">PI</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.5.m5.1c">\lambda_{\text{PI}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.5.m5.1d">italic_λ start_POSTSUBSCRIPT PI end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\lambda_{\text{BC}}" class="ltx_Math" display="inline" id="S3.SS5.p3.6.m6.1"><semantics id="S3.SS5.p3.6.m6.1a"><msub id="S3.SS5.p3.6.m6.1.1" xref="S3.SS5.p3.6.m6.1.1.cmml"><mi id="S3.SS5.p3.6.m6.1.1.2" xref="S3.SS5.p3.6.m6.1.1.2.cmml">λ</mi><mtext id="S3.SS5.p3.6.m6.1.1.3" xref="S3.SS5.p3.6.m6.1.1.3a.cmml">BC</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.6.m6.1b"><apply id="S3.SS5.p3.6.m6.1.1.cmml" xref="S3.SS5.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.6.m6.1.1.1.cmml" xref="S3.SS5.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS5.p3.6.m6.1.1.2.cmml" xref="S3.SS5.p3.6.m6.1.1.2">𝜆</ci><ci id="S3.SS5.p3.6.m6.1.1.3a.cmml" xref="S3.SS5.p3.6.m6.1.1.3"><mtext id="S3.SS5.p3.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p3.6.m6.1.1.3">BC</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.6.m6.1c">\lambda_{\text{BC}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.6.m6.1d">italic_λ start_POSTSUBSCRIPT BC end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\lambda_{\text{IC}}" class="ltx_Math" display="inline" id="S3.SS5.p3.7.m7.1"><semantics id="S3.SS5.p3.7.m7.1a"><msub id="S3.SS5.p3.7.m7.1.1" xref="S3.SS5.p3.7.m7.1.1.cmml"><mi id="S3.SS5.p3.7.m7.1.1.2" xref="S3.SS5.p3.7.m7.1.1.2.cmml">λ</mi><mtext id="S3.SS5.p3.7.m7.1.1.3" xref="S3.SS5.p3.7.m7.1.1.3a.cmml">IC</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.7.m7.1b"><apply id="S3.SS5.p3.7.m7.1.1.cmml" xref="S3.SS5.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.7.m7.1.1.1.cmml" xref="S3.SS5.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS5.p3.7.m7.1.1.2.cmml" xref="S3.SS5.p3.7.m7.1.1.2">𝜆</ci><ci id="S3.SS5.p3.7.m7.1.1.3a.cmml" xref="S3.SS5.p3.7.m7.1.1.3"><mtext id="S3.SS5.p3.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p3.7.m7.1.1.3">IC</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.7.m7.1c">\lambda_{\text{IC}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.7.m7.1d">italic_λ start_POSTSUBSCRIPT IC end_POSTSUBSCRIPT</annotation></semantics></math> balance the contributions of each component.</p>
</div>
<div class="ltx_para" id="S3.SS5.p4">
<p class="ltx_p" id="S3.SS5.p4.1">The physics-informed loss is derived by ensuring the model output aligns with the heat conduction equation. The residual is computed as:</p>
</div>
<div class="ltx_para" id="S3.SS5.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{Residual}=\frac{\partial{\theta_{\text{pred}}}}{\partial\tau}-\beta\left%
(\frac{\partial^{2}{\theta_{\text{pred}}}}{\partial\xi^{2}}+\frac{\partial^{2}%
{\theta_{\text{pred}}}}{\partial\eta^{2}}\right)" class="ltx_Math" display="block" id="S3.E19.m1.1"><semantics id="S3.E19.m1.1a"><mrow id="S3.E19.m1.1.1" xref="S3.E19.m1.1.1.cmml"><mtext id="S3.E19.m1.1.1.3" xref="S3.E19.m1.1.1.3a.cmml">Residual</mtext><mo id="S3.E19.m1.1.1.2" xref="S3.E19.m1.1.1.2.cmml">=</mo><mrow id="S3.E19.m1.1.1.1" xref="S3.E19.m1.1.1.1.cmml"><mfrac id="S3.E19.m1.1.1.1.3" xref="S3.E19.m1.1.1.1.3.cmml"><mrow id="S3.E19.m1.1.1.1.3.2" xref="S3.E19.m1.1.1.1.3.2.cmml"><mo id="S3.E19.m1.1.1.1.3.2.1" rspace="0em" xref="S3.E19.m1.1.1.1.3.2.1.cmml">∂</mo><msub id="S3.E19.m1.1.1.1.3.2.2" xref="S3.E19.m1.1.1.1.3.2.2.cmml"><mi id="S3.E19.m1.1.1.1.3.2.2.2" xref="S3.E19.m1.1.1.1.3.2.2.2.cmml">θ</mi><mtext id="S3.E19.m1.1.1.1.3.2.2.3" xref="S3.E19.m1.1.1.1.3.2.2.3a.cmml">pred</mtext></msub></mrow><mrow id="S3.E19.m1.1.1.1.3.3" xref="S3.E19.m1.1.1.1.3.3.cmml"><mo id="S3.E19.m1.1.1.1.3.3.1" rspace="0em" xref="S3.E19.m1.1.1.1.3.3.1.cmml">∂</mo><mi id="S3.E19.m1.1.1.1.3.3.2" xref="S3.E19.m1.1.1.1.3.3.2.cmml">τ</mi></mrow></mfrac><mo id="S3.E19.m1.1.1.1.2" xref="S3.E19.m1.1.1.1.2.cmml">−</mo><mrow id="S3.E19.m1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.cmml"><mi id="S3.E19.m1.1.1.1.1.3" xref="S3.E19.m1.1.1.1.1.3.cmml">β</mi><mo id="S3.E19.m1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E19.m1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E19.m1.1.1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E19.m1.1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.1.cmml"><mfrac id="S3.E19.m1.1.1.1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E19.m1.1.1.1.1.1.1.1.2.2" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.cmml"><msup id="S3.E19.m1.1.1.1.1.1.1.1.2.2.1" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.cmml"><mo id="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.2" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.2.cmml">∂</mo><mn id="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.3" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.3.cmml">2</mn></msup><msub id="S3.E19.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mtext id="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.3a.cmml">pred</mtext></msub></mrow><mrow id="S3.E19.m1.1.1.1.1.1.1.1.2.3" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E19.m1.1.1.1.1.1.1.1.2.3.1" rspace="0em" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.1.cmml">∂</mo><msup id="S3.E19.m1.1.1.1.1.1.1.1.2.3.2" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.2.cmml">ξ</mi><mn id="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.3.cmml">2</mn></msup></mrow></mfrac><mo id="S3.E19.m1.1.1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.1.1.cmml">+</mo><mfrac id="S3.E19.m1.1.1.1.1.1.1.1.3" xref="S3.E19.m1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E19.m1.1.1.1.1.1.1.1.3.2" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.cmml"><msup id="S3.E19.m1.1.1.1.1.1.1.1.3.2.1" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.cmml"><mo id="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.2" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.2.cmml">∂</mo><mn id="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.3" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.3.cmml">2</mn></msup><msub id="S3.E19.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.2.cmml">θ</mi><mtext id="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.3" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.3a.cmml">pred</mtext></msub></mrow><mrow id="S3.E19.m1.1.1.1.1.1.1.1.3.3" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3.cmml"><mo id="S3.E19.m1.1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><msup id="S3.E19.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.2.cmml">η</mi><mn id="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.3" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.3.cmml">2</mn></msup></mrow></mfrac></mrow><mo id="S3.E19.m1.1.1.1.1.1.1.3" xref="S3.E19.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E19.m1.1b"><apply id="S3.E19.m1.1.1.cmml" xref="S3.E19.m1.1.1"><eq id="S3.E19.m1.1.1.2.cmml" xref="S3.E19.m1.1.1.2"></eq><ci id="S3.E19.m1.1.1.3a.cmml" xref="S3.E19.m1.1.1.3"><mtext id="S3.E19.m1.1.1.3.cmml" xref="S3.E19.m1.1.1.3">Residual</mtext></ci><apply id="S3.E19.m1.1.1.1.cmml" xref="S3.E19.m1.1.1.1"><minus id="S3.E19.m1.1.1.1.2.cmml" xref="S3.E19.m1.1.1.1.2"></minus><apply id="S3.E19.m1.1.1.1.3.cmml" xref="S3.E19.m1.1.1.1.3"><divide id="S3.E19.m1.1.1.1.3.1.cmml" xref="S3.E19.m1.1.1.1.3"></divide><apply id="S3.E19.m1.1.1.1.3.2.cmml" xref="S3.E19.m1.1.1.1.3.2"><partialdiff id="S3.E19.m1.1.1.1.3.2.1.cmml" xref="S3.E19.m1.1.1.1.3.2.1"></partialdiff><apply id="S3.E19.m1.1.1.1.3.2.2.cmml" xref="S3.E19.m1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.3.2.2.1.cmml" xref="S3.E19.m1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E19.m1.1.1.1.3.2.2.2.cmml" xref="S3.E19.m1.1.1.1.3.2.2.2">𝜃</ci><ci id="S3.E19.m1.1.1.1.3.2.2.3a.cmml" xref="S3.E19.m1.1.1.1.3.2.2.3"><mtext id="S3.E19.m1.1.1.1.3.2.2.3.cmml" mathsize="70%" xref="S3.E19.m1.1.1.1.3.2.2.3">pred</mtext></ci></apply></apply><apply id="S3.E19.m1.1.1.1.3.3.cmml" xref="S3.E19.m1.1.1.1.3.3"><partialdiff id="S3.E19.m1.1.1.1.3.3.1.cmml" xref="S3.E19.m1.1.1.1.3.3.1"></partialdiff><ci id="S3.E19.m1.1.1.1.3.3.2.cmml" xref="S3.E19.m1.1.1.1.3.3.2">𝜏</ci></apply></apply><apply id="S3.E19.m1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1"><times id="S3.E19.m1.1.1.1.1.2.cmml" xref="S3.E19.m1.1.1.1.1.2"></times><ci id="S3.E19.m1.1.1.1.1.3.cmml" xref="S3.E19.m1.1.1.1.1.3">𝛽</ci><apply id="S3.E19.m1.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1"><plus id="S3.E19.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E19.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2"><divide id="S3.E19.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2"></divide><apply id="S3.E19.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2"><apply id="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.1">superscript</csymbol><partialdiff id="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.2"></partialdiff><cn id="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.3.cmml" type="integer" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.1.3">2</cn></apply><apply id="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.3a.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.3"><mtext id="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" mathsize="70%" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.2.3">pred</mtext></ci></apply></apply><apply id="S3.E19.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3"><partialdiff id="S3.E19.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.1"></partialdiff><apply id="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.2">superscript</csymbol><ci id="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.2">𝜉</ci><cn id="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.2.3">2</cn></apply></apply></apply><apply id="S3.E19.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3"><divide id="S3.E19.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3"></divide><apply id="S3.E19.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2"><apply id="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.1">superscript</csymbol><partialdiff id="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.2"></partialdiff><cn id="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.3.cmml" type="integer" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.1.3">2</cn></apply><apply id="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.2">𝜃</ci><ci id="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.3a.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.3"><mtext id="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.3.cmml" mathsize="70%" xref="S3.E19.m1.1.1.1.1.1.1.1.3.2.2.3">pred</mtext></ci></apply></apply><apply id="S3.E19.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3"><partialdiff id="S3.E19.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3.1"></partialdiff><apply id="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3.2">superscript</csymbol><ci id="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.2">𝜂</ci><cn id="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="S3.E19.m1.1.1.1.1.1.1.1.3.3.2.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E19.m1.1c">\text{Residual}=\frac{\partial{\theta_{\text{pred}}}}{\partial\tau}-\beta\left%
(\frac{\partial^{2}{\theta_{\text{pred}}}}{\partial\xi^{2}}+\frac{\partial^{2}%
{\theta_{\text{pred}}}}{\partial\eta^{2}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E19.m1.1d">Residual = divide start_ARG ∂ italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_τ end_ARG - italic_β ( divide start_ARG ∂ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_ξ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG + divide start_ARG ∂ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_η start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p6">
<p class="ltx_p" id="S3.SS5.p6.1">The second-order spatial derivatives are approximated using central finite differences:</p>
</div>
<div class="ltx_para" id="S3.SS5.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.E20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\frac{\partial^{2}{\theta_{\text{pred}}}}{\partial\xi^{2}}\approx\frac{{\theta%
_{\text{pred}}}_{i+1,j}-2\,{\theta_{\text{pred}}}_{i,j}+{\theta_{\text{pred}}}%
_{i-1,j}}{(\Delta\xi)^{2}}" class="ltx_Math" display="block" id="S3.E20.m1.7"><semantics id="S3.E20.m1.7a"><mrow id="S3.E20.m1.7.8" xref="S3.E20.m1.7.8.cmml"><mfrac id="S3.E20.m1.7.8.2" xref="S3.E20.m1.7.8.2.cmml"><mrow id="S3.E20.m1.7.8.2.2" xref="S3.E20.m1.7.8.2.2.cmml"><msup id="S3.E20.m1.7.8.2.2.1" xref="S3.E20.m1.7.8.2.2.1.cmml"><mo id="S3.E20.m1.7.8.2.2.1.2" xref="S3.E20.m1.7.8.2.2.1.2.cmml">∂</mo><mn id="S3.E20.m1.7.8.2.2.1.3" xref="S3.E20.m1.7.8.2.2.1.3.cmml">2</mn></msup><msub id="S3.E20.m1.7.8.2.2.2" xref="S3.E20.m1.7.8.2.2.2.cmml"><mi id="S3.E20.m1.7.8.2.2.2.2" xref="S3.E20.m1.7.8.2.2.2.2.cmml">θ</mi><mtext id="S3.E20.m1.7.8.2.2.2.3" xref="S3.E20.m1.7.8.2.2.2.3a.cmml">pred</mtext></msub></mrow><mrow id="S3.E20.m1.7.8.2.3" xref="S3.E20.m1.7.8.2.3.cmml"><mo id="S3.E20.m1.7.8.2.3.1" rspace="0em" xref="S3.E20.m1.7.8.2.3.1.cmml">∂</mo><msup id="S3.E20.m1.7.8.2.3.2" xref="S3.E20.m1.7.8.2.3.2.cmml"><mi id="S3.E20.m1.7.8.2.3.2.2" xref="S3.E20.m1.7.8.2.3.2.2.cmml">ξ</mi><mn id="S3.E20.m1.7.8.2.3.2.3" xref="S3.E20.m1.7.8.2.3.2.3.cmml">2</mn></msup></mrow></mfrac><mo id="S3.E20.m1.7.8.1" xref="S3.E20.m1.7.8.1.cmml">≈</mo><mfrac id="S3.E20.m1.7.7" xref="S3.E20.m1.7.7.cmml"><mrow id="S3.E20.m1.6.6.6" xref="S3.E20.m1.6.6.6.cmml"><mrow id="S3.E20.m1.6.6.6.8" xref="S3.E20.m1.6.6.6.8.cmml"><mmultiscripts id="S3.E20.m1.6.6.6.8.2" xref="S3.E20.m1.6.6.6.8.2.cmml"><mi id="S3.E20.m1.6.6.6.8.2.2.2" xref="S3.E20.m1.6.6.6.8.2.2.2.cmml">θ</mi><mtext id="S3.E20.m1.6.6.6.8.2.2.3" xref="S3.E20.m1.6.6.6.8.2.2.3a.cmml">pred</mtext><mrow id="S3.E20.m1.6.6.6.8.2a" xref="S3.E20.m1.6.6.6.8.2.cmml"></mrow><mrow id="S3.E20.m1.2.2.2.2.2.2" xref="S3.E20.m1.2.2.2.2.2.3.cmml"><mrow id="S3.E20.m1.2.2.2.2.2.2.1" xref="S3.E20.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E20.m1.2.2.2.2.2.2.1.2" xref="S3.E20.m1.2.2.2.2.2.2.1.2.cmml">i</mi><mo id="S3.E20.m1.2.2.2.2.2.2.1.1" xref="S3.E20.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E20.m1.2.2.2.2.2.2.1.3" xref="S3.E20.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E20.m1.2.2.2.2.2.2.2" xref="S3.E20.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E20.m1.1.1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.1.1.cmml">j</mi></mrow><mrow id="S3.E20.m1.6.6.6.8.2b" xref="S3.E20.m1.6.6.6.8.2.cmml"></mrow></mmultiscripts><mo id="S3.E20.m1.6.6.6.8.1" xref="S3.E20.m1.6.6.6.8.1.cmml">−</mo><mrow id="S3.E20.m1.6.6.6.8.3" xref="S3.E20.m1.6.6.6.8.3.cmml"><mn id="S3.E20.m1.6.6.6.8.3.2" xref="S3.E20.m1.6.6.6.8.3.2.cmml">2</mn><mo id="S3.E20.m1.6.6.6.8.3.1" lspace="0.170em" xref="S3.E20.m1.6.6.6.8.3.1.cmml">⁢</mo><mmultiscripts id="S3.E20.m1.6.6.6.8.3.3" xref="S3.E20.m1.6.6.6.8.3.3.cmml"><mi id="S3.E20.m1.6.6.6.8.3.3.2.2" xref="S3.E20.m1.6.6.6.8.3.3.2.2.cmml">θ</mi><mtext id="S3.E20.m1.6.6.6.8.3.3.2.3" xref="S3.E20.m1.6.6.6.8.3.3.2.3a.cmml">pred</mtext><mrow id="S3.E20.m1.6.6.6.8.3.3a" xref="S3.E20.m1.6.6.6.8.3.3.cmml"></mrow><mrow id="S3.E20.m1.4.4.4.4.2.4" xref="S3.E20.m1.4.4.4.4.2.3.cmml"><mi id="S3.E20.m1.3.3.3.3.1.1" xref="S3.E20.m1.3.3.3.3.1.1.cmml">i</mi><mo id="S3.E20.m1.4.4.4.4.2.4.1" xref="S3.E20.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E20.m1.4.4.4.4.2.2" xref="S3.E20.m1.4.4.4.4.2.2.cmml">j</mi></mrow><mrow id="S3.E20.m1.6.6.6.8.3.3b" xref="S3.E20.m1.6.6.6.8.3.3.cmml"></mrow></mmultiscripts></mrow></mrow><mo id="S3.E20.m1.6.6.6.7" xref="S3.E20.m1.6.6.6.7.cmml">+</mo><mmultiscripts id="S3.E20.m1.6.6.6.9" xref="S3.E20.m1.6.6.6.9.cmml"><mi id="S3.E20.m1.6.6.6.9.2.2" xref="S3.E20.m1.6.6.6.9.2.2.cmml">θ</mi><mtext id="S3.E20.m1.6.6.6.9.2.3" xref="S3.E20.m1.6.6.6.9.2.3a.cmml">pred</mtext><mrow id="S3.E20.m1.6.6.6.9a" xref="S3.E20.m1.6.6.6.9.cmml"></mrow><mrow id="S3.E20.m1.6.6.6.6.2.2" xref="S3.E20.m1.6.6.6.6.2.3.cmml"><mrow id="S3.E20.m1.6.6.6.6.2.2.1" xref="S3.E20.m1.6.6.6.6.2.2.1.cmml"><mi id="S3.E20.m1.6.6.6.6.2.2.1.2" xref="S3.E20.m1.6.6.6.6.2.2.1.2.cmml">i</mi><mo id="S3.E20.m1.6.6.6.6.2.2.1.1" xref="S3.E20.m1.6.6.6.6.2.2.1.1.cmml">−</mo><mn id="S3.E20.m1.6.6.6.6.2.2.1.3" xref="S3.E20.m1.6.6.6.6.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E20.m1.6.6.6.6.2.2.2" xref="S3.E20.m1.6.6.6.6.2.3.cmml">,</mo><mi id="S3.E20.m1.5.5.5.5.1.1" xref="S3.E20.m1.5.5.5.5.1.1.cmml">j</mi></mrow><mrow id="S3.E20.m1.6.6.6.9b" xref="S3.E20.m1.6.6.6.9.cmml"></mrow></mmultiscripts></mrow><msup id="S3.E20.m1.7.7.7" xref="S3.E20.m1.7.7.7.cmml"><mrow id="S3.E20.m1.7.7.7.1.1" xref="S3.E20.m1.7.7.7.1.1.1.cmml"><mo id="S3.E20.m1.7.7.7.1.1.2" stretchy="false" xref="S3.E20.m1.7.7.7.1.1.1.cmml">(</mo><mrow id="S3.E20.m1.7.7.7.1.1.1" xref="S3.E20.m1.7.7.7.1.1.1.cmml"><mi id="S3.E20.m1.7.7.7.1.1.1.2" mathvariant="normal" xref="S3.E20.m1.7.7.7.1.1.1.2.cmml">Δ</mi><mo id="S3.E20.m1.7.7.7.1.1.1.1" xref="S3.E20.m1.7.7.7.1.1.1.1.cmml">⁢</mo><mi id="S3.E20.m1.7.7.7.1.1.1.3" xref="S3.E20.m1.7.7.7.1.1.1.3.cmml">ξ</mi></mrow><mo id="S3.E20.m1.7.7.7.1.1.3" stretchy="false" xref="S3.E20.m1.7.7.7.1.1.1.cmml">)</mo></mrow><mn id="S3.E20.m1.7.7.7.3" xref="S3.E20.m1.7.7.7.3.cmml">2</mn></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E20.m1.7b"><apply id="S3.E20.m1.7.8.cmml" xref="S3.E20.m1.7.8"><approx id="S3.E20.m1.7.8.1.cmml" xref="S3.E20.m1.7.8.1"></approx><apply id="S3.E20.m1.7.8.2.cmml" xref="S3.E20.m1.7.8.2"><divide id="S3.E20.m1.7.8.2.1.cmml" xref="S3.E20.m1.7.8.2"></divide><apply id="S3.E20.m1.7.8.2.2.cmml" xref="S3.E20.m1.7.8.2.2"><apply id="S3.E20.m1.7.8.2.2.1.cmml" xref="S3.E20.m1.7.8.2.2.1"><csymbol cd="ambiguous" id="S3.E20.m1.7.8.2.2.1.1.cmml" xref="S3.E20.m1.7.8.2.2.1">superscript</csymbol><partialdiff id="S3.E20.m1.7.8.2.2.1.2.cmml" xref="S3.E20.m1.7.8.2.2.1.2"></partialdiff><cn id="S3.E20.m1.7.8.2.2.1.3.cmml" type="integer" xref="S3.E20.m1.7.8.2.2.1.3">2</cn></apply><apply id="S3.E20.m1.7.8.2.2.2.cmml" xref="S3.E20.m1.7.8.2.2.2"><csymbol cd="ambiguous" id="S3.E20.m1.7.8.2.2.2.1.cmml" xref="S3.E20.m1.7.8.2.2.2">subscript</csymbol><ci id="S3.E20.m1.7.8.2.2.2.2.cmml" xref="S3.E20.m1.7.8.2.2.2.2">𝜃</ci><ci id="S3.E20.m1.7.8.2.2.2.3a.cmml" xref="S3.E20.m1.7.8.2.2.2.3"><mtext id="S3.E20.m1.7.8.2.2.2.3.cmml" mathsize="70%" xref="S3.E20.m1.7.8.2.2.2.3">pred</mtext></ci></apply></apply><apply id="S3.E20.m1.7.8.2.3.cmml" xref="S3.E20.m1.7.8.2.3"><partialdiff id="S3.E20.m1.7.8.2.3.1.cmml" xref="S3.E20.m1.7.8.2.3.1"></partialdiff><apply id="S3.E20.m1.7.8.2.3.2.cmml" xref="S3.E20.m1.7.8.2.3.2"><csymbol cd="ambiguous" id="S3.E20.m1.7.8.2.3.2.1.cmml" xref="S3.E20.m1.7.8.2.3.2">superscript</csymbol><ci id="S3.E20.m1.7.8.2.3.2.2.cmml" xref="S3.E20.m1.7.8.2.3.2.2">𝜉</ci><cn id="S3.E20.m1.7.8.2.3.2.3.cmml" type="integer" xref="S3.E20.m1.7.8.2.3.2.3">2</cn></apply></apply></apply><apply id="S3.E20.m1.7.7.cmml" xref="S3.E20.m1.7.7"><divide id="S3.E20.m1.7.7.8.cmml" xref="S3.E20.m1.7.7"></divide><apply id="S3.E20.m1.6.6.6.cmml" xref="S3.E20.m1.6.6.6"><plus id="S3.E20.m1.6.6.6.7.cmml" xref="S3.E20.m1.6.6.6.7"></plus><apply id="S3.E20.m1.6.6.6.8.cmml" xref="S3.E20.m1.6.6.6.8"><minus id="S3.E20.m1.6.6.6.8.1.cmml" xref="S3.E20.m1.6.6.6.8.1"></minus><apply id="S3.E20.m1.6.6.6.8.2.cmml" xref="S3.E20.m1.6.6.6.8.2"><csymbol cd="ambiguous" id="S3.E20.m1.6.6.6.8.2.1.cmml" xref="S3.E20.m1.6.6.6.8.2">subscript</csymbol><apply id="S3.E20.m1.6.6.6.8.2.2.cmml" xref="S3.E20.m1.6.6.6.8.2"><csymbol cd="ambiguous" id="S3.E20.m1.6.6.6.8.2.2.1.cmml" xref="S3.E20.m1.6.6.6.8.2">subscript</csymbol><ci id="S3.E20.m1.6.6.6.8.2.2.2.cmml" xref="S3.E20.m1.6.6.6.8.2.2.2">𝜃</ci><ci id="S3.E20.m1.6.6.6.8.2.2.3a.cmml" xref="S3.E20.m1.6.6.6.8.2.2.3"><mtext id="S3.E20.m1.6.6.6.8.2.2.3.cmml" mathsize="70%" xref="S3.E20.m1.6.6.6.8.2.2.3">pred</mtext></ci></apply><list id="S3.E20.m1.2.2.2.2.2.3.cmml" xref="S3.E20.m1.2.2.2.2.2.2"><apply id="S3.E20.m1.2.2.2.2.2.2.1.cmml" xref="S3.E20.m1.2.2.2.2.2.2.1"><plus id="S3.E20.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E20.m1.2.2.2.2.2.2.1.1"></plus><ci id="S3.E20.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E20.m1.2.2.2.2.2.2.1.2">𝑖</ci><cn id="S3.E20.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E20.m1.2.2.2.2.2.2.1.3">1</cn></apply><ci id="S3.E20.m1.1.1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1">𝑗</ci></list></apply><apply id="S3.E20.m1.6.6.6.8.3.cmml" xref="S3.E20.m1.6.6.6.8.3"><times id="S3.E20.m1.6.6.6.8.3.1.cmml" xref="S3.E20.m1.6.6.6.8.3.1"></times><cn id="S3.E20.m1.6.6.6.8.3.2.cmml" type="integer" xref="S3.E20.m1.6.6.6.8.3.2">2</cn><apply id="S3.E20.m1.6.6.6.8.3.3.cmml" xref="S3.E20.m1.6.6.6.8.3.3"><csymbol cd="ambiguous" id="S3.E20.m1.6.6.6.8.3.3.1.cmml" xref="S3.E20.m1.6.6.6.8.3.3">subscript</csymbol><apply id="S3.E20.m1.6.6.6.8.3.3.2.cmml" xref="S3.E20.m1.6.6.6.8.3.3"><csymbol cd="ambiguous" id="S3.E20.m1.6.6.6.8.3.3.2.1.cmml" xref="S3.E20.m1.6.6.6.8.3.3">subscript</csymbol><ci id="S3.E20.m1.6.6.6.8.3.3.2.2.cmml" xref="S3.E20.m1.6.6.6.8.3.3.2.2">𝜃</ci><ci id="S3.E20.m1.6.6.6.8.3.3.2.3a.cmml" xref="S3.E20.m1.6.6.6.8.3.3.2.3"><mtext id="S3.E20.m1.6.6.6.8.3.3.2.3.cmml" mathsize="70%" xref="S3.E20.m1.6.6.6.8.3.3.2.3">pred</mtext></ci></apply><list id="S3.E20.m1.4.4.4.4.2.3.cmml" xref="S3.E20.m1.4.4.4.4.2.4"><ci id="S3.E20.m1.3.3.3.3.1.1.cmml" xref="S3.E20.m1.3.3.3.3.1.1">𝑖</ci><ci id="S3.E20.m1.4.4.4.4.2.2.cmml" xref="S3.E20.m1.4.4.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.E20.m1.6.6.6.9.cmml" xref="S3.E20.m1.6.6.6.9"><csymbol cd="ambiguous" id="S3.E20.m1.6.6.6.9.1.cmml" xref="S3.E20.m1.6.6.6.9">subscript</csymbol><apply id="S3.E20.m1.6.6.6.9.2.cmml" xref="S3.E20.m1.6.6.6.9"><csymbol cd="ambiguous" id="S3.E20.m1.6.6.6.9.2.1.cmml" xref="S3.E20.m1.6.6.6.9">subscript</csymbol><ci id="S3.E20.m1.6.6.6.9.2.2.cmml" xref="S3.E20.m1.6.6.6.9.2.2">𝜃</ci><ci id="S3.E20.m1.6.6.6.9.2.3a.cmml" xref="S3.E20.m1.6.6.6.9.2.3"><mtext id="S3.E20.m1.6.6.6.9.2.3.cmml" mathsize="70%" xref="S3.E20.m1.6.6.6.9.2.3">pred</mtext></ci></apply><list id="S3.E20.m1.6.6.6.6.2.3.cmml" xref="S3.E20.m1.6.6.6.6.2.2"><apply id="S3.E20.m1.6.6.6.6.2.2.1.cmml" xref="S3.E20.m1.6.6.6.6.2.2.1"><minus id="S3.E20.m1.6.6.6.6.2.2.1.1.cmml" xref="S3.E20.m1.6.6.6.6.2.2.1.1"></minus><ci id="S3.E20.m1.6.6.6.6.2.2.1.2.cmml" xref="S3.E20.m1.6.6.6.6.2.2.1.2">𝑖</ci><cn id="S3.E20.m1.6.6.6.6.2.2.1.3.cmml" type="integer" xref="S3.E20.m1.6.6.6.6.2.2.1.3">1</cn></apply><ci id="S3.E20.m1.5.5.5.5.1.1.cmml" xref="S3.E20.m1.5.5.5.5.1.1">𝑗</ci></list></apply></apply><apply id="S3.E20.m1.7.7.7.cmml" xref="S3.E20.m1.7.7.7"><csymbol cd="ambiguous" id="S3.E20.m1.7.7.7.2.cmml" xref="S3.E20.m1.7.7.7">superscript</csymbol><apply id="S3.E20.m1.7.7.7.1.1.1.cmml" xref="S3.E20.m1.7.7.7.1.1"><times id="S3.E20.m1.7.7.7.1.1.1.1.cmml" xref="S3.E20.m1.7.7.7.1.1.1.1"></times><ci id="S3.E20.m1.7.7.7.1.1.1.2.cmml" xref="S3.E20.m1.7.7.7.1.1.1.2">Δ</ci><ci id="S3.E20.m1.7.7.7.1.1.1.3.cmml" xref="S3.E20.m1.7.7.7.1.1.1.3">𝜉</ci></apply><cn id="S3.E20.m1.7.7.7.3.cmml" type="integer" xref="S3.E20.m1.7.7.7.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E20.m1.7c">\frac{\partial^{2}{\theta_{\text{pred}}}}{\partial\xi^{2}}\approx\frac{{\theta%
_{\text{pred}}}_{i+1,j}-2\,{\theta_{\text{pred}}}_{i,j}+{\theta_{\text{pred}}}%
_{i-1,j}}{(\Delta\xi)^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.E20.m1.7d">divide start_ARG ∂ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_ξ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ≈ divide start_ARG italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i + 1 , italic_j end_POSTSUBSCRIPT - 2 italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT + italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i - 1 , italic_j end_POSTSUBSCRIPT end_ARG start_ARG ( roman_Δ italic_ξ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p8">
<table class="ltx_equation ltx_eqn_table" id="S3.E21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\frac{\partial^{2}\theta}{\partial\eta^{2}}\approx\frac{{\theta_{\text{pred}}}%
_{i,j+1}-2\,{\theta_{\text{pred}}}_{i,j}+{\theta_{\text{pred}}}_{i,j-1}}{(%
\Delta\eta)^{2}}" class="ltx_Math" display="block" id="S3.E21.m1.7"><semantics id="S3.E21.m1.7a"><mrow id="S3.E21.m1.7.8" xref="S3.E21.m1.7.8.cmml"><mfrac id="S3.E21.m1.7.8.2" xref="S3.E21.m1.7.8.2.cmml"><mrow id="S3.E21.m1.7.8.2.2" xref="S3.E21.m1.7.8.2.2.cmml"><msup id="S3.E21.m1.7.8.2.2.1" xref="S3.E21.m1.7.8.2.2.1.cmml"><mo id="S3.E21.m1.7.8.2.2.1.2" xref="S3.E21.m1.7.8.2.2.1.2.cmml">∂</mo><mn id="S3.E21.m1.7.8.2.2.1.3" xref="S3.E21.m1.7.8.2.2.1.3.cmml">2</mn></msup><mi id="S3.E21.m1.7.8.2.2.2" xref="S3.E21.m1.7.8.2.2.2.cmml">θ</mi></mrow><mrow id="S3.E21.m1.7.8.2.3" xref="S3.E21.m1.7.8.2.3.cmml"><mo id="S3.E21.m1.7.8.2.3.1" rspace="0em" xref="S3.E21.m1.7.8.2.3.1.cmml">∂</mo><msup id="S3.E21.m1.7.8.2.3.2" xref="S3.E21.m1.7.8.2.3.2.cmml"><mi id="S3.E21.m1.7.8.2.3.2.2" xref="S3.E21.m1.7.8.2.3.2.2.cmml">η</mi><mn id="S3.E21.m1.7.8.2.3.2.3" xref="S3.E21.m1.7.8.2.3.2.3.cmml">2</mn></msup></mrow></mfrac><mo id="S3.E21.m1.7.8.1" xref="S3.E21.m1.7.8.1.cmml">≈</mo><mfrac id="S3.E21.m1.7.7" xref="S3.E21.m1.7.7.cmml"><mrow id="S3.E21.m1.6.6.6" xref="S3.E21.m1.6.6.6.cmml"><mrow id="S3.E21.m1.6.6.6.8" xref="S3.E21.m1.6.6.6.8.cmml"><mmultiscripts id="S3.E21.m1.6.6.6.8.2" xref="S3.E21.m1.6.6.6.8.2.cmml"><mi id="S3.E21.m1.6.6.6.8.2.2.2" xref="S3.E21.m1.6.6.6.8.2.2.2.cmml">θ</mi><mtext id="S3.E21.m1.6.6.6.8.2.2.3" xref="S3.E21.m1.6.6.6.8.2.2.3a.cmml">pred</mtext><mrow id="S3.E21.m1.6.6.6.8.2a" xref="S3.E21.m1.6.6.6.8.2.cmml"></mrow><mrow id="S3.E21.m1.2.2.2.2.2.2" xref="S3.E21.m1.2.2.2.2.2.3.cmml"><mi id="S3.E21.m1.1.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E21.m1.2.2.2.2.2.2.2" xref="S3.E21.m1.2.2.2.2.2.3.cmml">,</mo><mrow id="S3.E21.m1.2.2.2.2.2.2.1" xref="S3.E21.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E21.m1.2.2.2.2.2.2.1.2" xref="S3.E21.m1.2.2.2.2.2.2.1.2.cmml">j</mi><mo id="S3.E21.m1.2.2.2.2.2.2.1.1" xref="S3.E21.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E21.m1.2.2.2.2.2.2.1.3" xref="S3.E21.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></mrow><mrow id="S3.E21.m1.6.6.6.8.2b" xref="S3.E21.m1.6.6.6.8.2.cmml"></mrow></mmultiscripts><mo id="S3.E21.m1.6.6.6.8.1" xref="S3.E21.m1.6.6.6.8.1.cmml">−</mo><mrow id="S3.E21.m1.6.6.6.8.3" xref="S3.E21.m1.6.6.6.8.3.cmml"><mn id="S3.E21.m1.6.6.6.8.3.2" xref="S3.E21.m1.6.6.6.8.3.2.cmml">2</mn><mo id="S3.E21.m1.6.6.6.8.3.1" lspace="0.170em" xref="S3.E21.m1.6.6.6.8.3.1.cmml">⁢</mo><mmultiscripts id="S3.E21.m1.6.6.6.8.3.3" xref="S3.E21.m1.6.6.6.8.3.3.cmml"><mi id="S3.E21.m1.6.6.6.8.3.3.2.2" xref="S3.E21.m1.6.6.6.8.3.3.2.2.cmml">θ</mi><mtext id="S3.E21.m1.6.6.6.8.3.3.2.3" xref="S3.E21.m1.6.6.6.8.3.3.2.3a.cmml">pred</mtext><mrow id="S3.E21.m1.6.6.6.8.3.3a" xref="S3.E21.m1.6.6.6.8.3.3.cmml"></mrow><mrow id="S3.E21.m1.4.4.4.4.2.4" xref="S3.E21.m1.4.4.4.4.2.3.cmml"><mi id="S3.E21.m1.3.3.3.3.1.1" xref="S3.E21.m1.3.3.3.3.1.1.cmml">i</mi><mo id="S3.E21.m1.4.4.4.4.2.4.1" xref="S3.E21.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E21.m1.4.4.4.4.2.2" xref="S3.E21.m1.4.4.4.4.2.2.cmml">j</mi></mrow><mrow id="S3.E21.m1.6.6.6.8.3.3b" xref="S3.E21.m1.6.6.6.8.3.3.cmml"></mrow></mmultiscripts></mrow></mrow><mo id="S3.E21.m1.6.6.6.7" xref="S3.E21.m1.6.6.6.7.cmml">+</mo><mmultiscripts id="S3.E21.m1.6.6.6.9" xref="S3.E21.m1.6.6.6.9.cmml"><mi id="S3.E21.m1.6.6.6.9.2.2" xref="S3.E21.m1.6.6.6.9.2.2.cmml">θ</mi><mtext id="S3.E21.m1.6.6.6.9.2.3" xref="S3.E21.m1.6.6.6.9.2.3a.cmml">pred</mtext><mrow id="S3.E21.m1.6.6.6.9a" xref="S3.E21.m1.6.6.6.9.cmml"></mrow><mrow id="S3.E21.m1.6.6.6.6.2.2" xref="S3.E21.m1.6.6.6.6.2.3.cmml"><mi id="S3.E21.m1.5.5.5.5.1.1" xref="S3.E21.m1.5.5.5.5.1.1.cmml">i</mi><mo id="S3.E21.m1.6.6.6.6.2.2.2" xref="S3.E21.m1.6.6.6.6.2.3.cmml">,</mo><mrow id="S3.E21.m1.6.6.6.6.2.2.1" xref="S3.E21.m1.6.6.6.6.2.2.1.cmml"><mi id="S3.E21.m1.6.6.6.6.2.2.1.2" xref="S3.E21.m1.6.6.6.6.2.2.1.2.cmml">j</mi><mo id="S3.E21.m1.6.6.6.6.2.2.1.1" xref="S3.E21.m1.6.6.6.6.2.2.1.1.cmml">−</mo><mn id="S3.E21.m1.6.6.6.6.2.2.1.3" xref="S3.E21.m1.6.6.6.6.2.2.1.3.cmml">1</mn></mrow></mrow><mrow id="S3.E21.m1.6.6.6.9b" xref="S3.E21.m1.6.6.6.9.cmml"></mrow></mmultiscripts></mrow><msup id="S3.E21.m1.7.7.7" xref="S3.E21.m1.7.7.7.cmml"><mrow id="S3.E21.m1.7.7.7.1.1" xref="S3.E21.m1.7.7.7.1.1.1.cmml"><mo id="S3.E21.m1.7.7.7.1.1.2" stretchy="false" xref="S3.E21.m1.7.7.7.1.1.1.cmml">(</mo><mrow id="S3.E21.m1.7.7.7.1.1.1" xref="S3.E21.m1.7.7.7.1.1.1.cmml"><mi id="S3.E21.m1.7.7.7.1.1.1.2" mathvariant="normal" xref="S3.E21.m1.7.7.7.1.1.1.2.cmml">Δ</mi><mo id="S3.E21.m1.7.7.7.1.1.1.1" xref="S3.E21.m1.7.7.7.1.1.1.1.cmml">⁢</mo><mi id="S3.E21.m1.7.7.7.1.1.1.3" xref="S3.E21.m1.7.7.7.1.1.1.3.cmml">η</mi></mrow><mo id="S3.E21.m1.7.7.7.1.1.3" stretchy="false" xref="S3.E21.m1.7.7.7.1.1.1.cmml">)</mo></mrow><mn id="S3.E21.m1.7.7.7.3" xref="S3.E21.m1.7.7.7.3.cmml">2</mn></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E21.m1.7b"><apply id="S3.E21.m1.7.8.cmml" xref="S3.E21.m1.7.8"><approx id="S3.E21.m1.7.8.1.cmml" xref="S3.E21.m1.7.8.1"></approx><apply id="S3.E21.m1.7.8.2.cmml" xref="S3.E21.m1.7.8.2"><divide id="S3.E21.m1.7.8.2.1.cmml" xref="S3.E21.m1.7.8.2"></divide><apply id="S3.E21.m1.7.8.2.2.cmml" xref="S3.E21.m1.7.8.2.2"><apply id="S3.E21.m1.7.8.2.2.1.cmml" xref="S3.E21.m1.7.8.2.2.1"><csymbol cd="ambiguous" id="S3.E21.m1.7.8.2.2.1.1.cmml" xref="S3.E21.m1.7.8.2.2.1">superscript</csymbol><partialdiff id="S3.E21.m1.7.8.2.2.1.2.cmml" xref="S3.E21.m1.7.8.2.2.1.2"></partialdiff><cn id="S3.E21.m1.7.8.2.2.1.3.cmml" type="integer" xref="S3.E21.m1.7.8.2.2.1.3">2</cn></apply><ci id="S3.E21.m1.7.8.2.2.2.cmml" xref="S3.E21.m1.7.8.2.2.2">𝜃</ci></apply><apply id="S3.E21.m1.7.8.2.3.cmml" xref="S3.E21.m1.7.8.2.3"><partialdiff id="S3.E21.m1.7.8.2.3.1.cmml" xref="S3.E21.m1.7.8.2.3.1"></partialdiff><apply id="S3.E21.m1.7.8.2.3.2.cmml" xref="S3.E21.m1.7.8.2.3.2"><csymbol cd="ambiguous" id="S3.E21.m1.7.8.2.3.2.1.cmml" xref="S3.E21.m1.7.8.2.3.2">superscript</csymbol><ci id="S3.E21.m1.7.8.2.3.2.2.cmml" xref="S3.E21.m1.7.8.2.3.2.2">𝜂</ci><cn id="S3.E21.m1.7.8.2.3.2.3.cmml" type="integer" xref="S3.E21.m1.7.8.2.3.2.3">2</cn></apply></apply></apply><apply id="S3.E21.m1.7.7.cmml" xref="S3.E21.m1.7.7"><divide id="S3.E21.m1.7.7.8.cmml" xref="S3.E21.m1.7.7"></divide><apply id="S3.E21.m1.6.6.6.cmml" xref="S3.E21.m1.6.6.6"><plus id="S3.E21.m1.6.6.6.7.cmml" xref="S3.E21.m1.6.6.6.7"></plus><apply id="S3.E21.m1.6.6.6.8.cmml" xref="S3.E21.m1.6.6.6.8"><minus id="S3.E21.m1.6.6.6.8.1.cmml" xref="S3.E21.m1.6.6.6.8.1"></minus><apply id="S3.E21.m1.6.6.6.8.2.cmml" xref="S3.E21.m1.6.6.6.8.2"><csymbol cd="ambiguous" id="S3.E21.m1.6.6.6.8.2.1.cmml" xref="S3.E21.m1.6.6.6.8.2">subscript</csymbol><apply id="S3.E21.m1.6.6.6.8.2.2.cmml" xref="S3.E21.m1.6.6.6.8.2"><csymbol cd="ambiguous" id="S3.E21.m1.6.6.6.8.2.2.1.cmml" xref="S3.E21.m1.6.6.6.8.2">subscript</csymbol><ci id="S3.E21.m1.6.6.6.8.2.2.2.cmml" xref="S3.E21.m1.6.6.6.8.2.2.2">𝜃</ci><ci id="S3.E21.m1.6.6.6.8.2.2.3a.cmml" xref="S3.E21.m1.6.6.6.8.2.2.3"><mtext id="S3.E21.m1.6.6.6.8.2.2.3.cmml" mathsize="70%" xref="S3.E21.m1.6.6.6.8.2.2.3">pred</mtext></ci></apply><list id="S3.E21.m1.2.2.2.2.2.3.cmml" xref="S3.E21.m1.2.2.2.2.2.2"><ci id="S3.E21.m1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1">𝑖</ci><apply id="S3.E21.m1.2.2.2.2.2.2.1.cmml" xref="S3.E21.m1.2.2.2.2.2.2.1"><plus id="S3.E21.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E21.m1.2.2.2.2.2.2.1.1"></plus><ci id="S3.E21.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E21.m1.2.2.2.2.2.2.1.2">𝑗</ci><cn id="S3.E21.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E21.m1.2.2.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S3.E21.m1.6.6.6.8.3.cmml" xref="S3.E21.m1.6.6.6.8.3"><times id="S3.E21.m1.6.6.6.8.3.1.cmml" xref="S3.E21.m1.6.6.6.8.3.1"></times><cn id="S3.E21.m1.6.6.6.8.3.2.cmml" type="integer" xref="S3.E21.m1.6.6.6.8.3.2">2</cn><apply id="S3.E21.m1.6.6.6.8.3.3.cmml" xref="S3.E21.m1.6.6.6.8.3.3"><csymbol cd="ambiguous" id="S3.E21.m1.6.6.6.8.3.3.1.cmml" xref="S3.E21.m1.6.6.6.8.3.3">subscript</csymbol><apply id="S3.E21.m1.6.6.6.8.3.3.2.cmml" xref="S3.E21.m1.6.6.6.8.3.3"><csymbol cd="ambiguous" id="S3.E21.m1.6.6.6.8.3.3.2.1.cmml" xref="S3.E21.m1.6.6.6.8.3.3">subscript</csymbol><ci id="S3.E21.m1.6.6.6.8.3.3.2.2.cmml" xref="S3.E21.m1.6.6.6.8.3.3.2.2">𝜃</ci><ci id="S3.E21.m1.6.6.6.8.3.3.2.3a.cmml" xref="S3.E21.m1.6.6.6.8.3.3.2.3"><mtext id="S3.E21.m1.6.6.6.8.3.3.2.3.cmml" mathsize="70%" xref="S3.E21.m1.6.6.6.8.3.3.2.3">pred</mtext></ci></apply><list id="S3.E21.m1.4.4.4.4.2.3.cmml" xref="S3.E21.m1.4.4.4.4.2.4"><ci id="S3.E21.m1.3.3.3.3.1.1.cmml" xref="S3.E21.m1.3.3.3.3.1.1">𝑖</ci><ci id="S3.E21.m1.4.4.4.4.2.2.cmml" xref="S3.E21.m1.4.4.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.E21.m1.6.6.6.9.cmml" xref="S3.E21.m1.6.6.6.9"><csymbol cd="ambiguous" id="S3.E21.m1.6.6.6.9.1.cmml" xref="S3.E21.m1.6.6.6.9">subscript</csymbol><apply id="S3.E21.m1.6.6.6.9.2.cmml" xref="S3.E21.m1.6.6.6.9"><csymbol cd="ambiguous" id="S3.E21.m1.6.6.6.9.2.1.cmml" xref="S3.E21.m1.6.6.6.9">subscript</csymbol><ci id="S3.E21.m1.6.6.6.9.2.2.cmml" xref="S3.E21.m1.6.6.6.9.2.2">𝜃</ci><ci id="S3.E21.m1.6.6.6.9.2.3a.cmml" xref="S3.E21.m1.6.6.6.9.2.3"><mtext id="S3.E21.m1.6.6.6.9.2.3.cmml" mathsize="70%" xref="S3.E21.m1.6.6.6.9.2.3">pred</mtext></ci></apply><list id="S3.E21.m1.6.6.6.6.2.3.cmml" xref="S3.E21.m1.6.6.6.6.2.2"><ci id="S3.E21.m1.5.5.5.5.1.1.cmml" xref="S3.E21.m1.5.5.5.5.1.1">𝑖</ci><apply id="S3.E21.m1.6.6.6.6.2.2.1.cmml" xref="S3.E21.m1.6.6.6.6.2.2.1"><minus id="S3.E21.m1.6.6.6.6.2.2.1.1.cmml" xref="S3.E21.m1.6.6.6.6.2.2.1.1"></minus><ci id="S3.E21.m1.6.6.6.6.2.2.1.2.cmml" xref="S3.E21.m1.6.6.6.6.2.2.1.2">𝑗</ci><cn id="S3.E21.m1.6.6.6.6.2.2.1.3.cmml" type="integer" xref="S3.E21.m1.6.6.6.6.2.2.1.3">1</cn></apply></list></apply></apply><apply id="S3.E21.m1.7.7.7.cmml" xref="S3.E21.m1.7.7.7"><csymbol cd="ambiguous" id="S3.E21.m1.7.7.7.2.cmml" xref="S3.E21.m1.7.7.7">superscript</csymbol><apply id="S3.E21.m1.7.7.7.1.1.1.cmml" xref="S3.E21.m1.7.7.7.1.1"><times id="S3.E21.m1.7.7.7.1.1.1.1.cmml" xref="S3.E21.m1.7.7.7.1.1.1.1"></times><ci id="S3.E21.m1.7.7.7.1.1.1.2.cmml" xref="S3.E21.m1.7.7.7.1.1.1.2">Δ</ci><ci id="S3.E21.m1.7.7.7.1.1.1.3.cmml" xref="S3.E21.m1.7.7.7.1.1.1.3">𝜂</ci></apply><cn id="S3.E21.m1.7.7.7.3.cmml" type="integer" xref="S3.E21.m1.7.7.7.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E21.m1.7c">\frac{\partial^{2}\theta}{\partial\eta^{2}}\approx\frac{{\theta_{\text{pred}}}%
_{i,j+1}-2\,{\theta_{\text{pred}}}_{i,j}+{\theta_{\text{pred}}}_{i,j-1}}{(%
\Delta\eta)^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.E21.m1.7d">divide start_ARG ∂ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_θ end_ARG start_ARG ∂ italic_η start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ≈ divide start_ARG italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i , italic_j + 1 end_POSTSUBSCRIPT - 2 italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT + italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i , italic_j - 1 end_POSTSUBSCRIPT end_ARG start_ARG ( roman_Δ italic_η ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p9">
<p class="ltx_p" id="S3.SS5.p9.1">The temporal derivative is approximated as:</p>
</div>
<div class="ltx_para" id="S3.SS5.p10">
<table class="ltx_equation ltx_eqn_table" id="S3.E22">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\frac{\partial{\theta_{\text{pred}}}}{\partial\tau}\approx\frac{{\theta_{\text%
{pred}}}_{i,j}^{n+1}-{\theta_{\text{pred}}}_{i,j}^{n}}{\Delta\tau}" class="ltx_Math" display="block" id="S3.E22.m1.4"><semantics id="S3.E22.m1.4a"><mrow id="S3.E22.m1.4.5" xref="S3.E22.m1.4.5.cmml"><mfrac id="S3.E22.m1.4.5.2" xref="S3.E22.m1.4.5.2.cmml"><mrow id="S3.E22.m1.4.5.2.2" xref="S3.E22.m1.4.5.2.2.cmml"><mo id="S3.E22.m1.4.5.2.2.1" rspace="0em" xref="S3.E22.m1.4.5.2.2.1.cmml">∂</mo><msub id="S3.E22.m1.4.5.2.2.2" xref="S3.E22.m1.4.5.2.2.2.cmml"><mi id="S3.E22.m1.4.5.2.2.2.2" xref="S3.E22.m1.4.5.2.2.2.2.cmml">θ</mi><mtext id="S3.E22.m1.4.5.2.2.2.3" xref="S3.E22.m1.4.5.2.2.2.3a.cmml">pred</mtext></msub></mrow><mrow id="S3.E22.m1.4.5.2.3" xref="S3.E22.m1.4.5.2.3.cmml"><mo id="S3.E22.m1.4.5.2.3.1" rspace="0em" xref="S3.E22.m1.4.5.2.3.1.cmml">∂</mo><mi id="S3.E22.m1.4.5.2.3.2" xref="S3.E22.m1.4.5.2.3.2.cmml">τ</mi></mrow></mfrac><mo id="S3.E22.m1.4.5.1" xref="S3.E22.m1.4.5.1.cmml">≈</mo><mfrac id="S3.E22.m1.4.4" xref="S3.E22.m1.4.4.cmml"><mrow id="S3.E22.m1.4.4.4" xref="S3.E22.m1.4.4.4.cmml"><mmultiscripts id="S3.E22.m1.4.4.4.6" xref="S3.E22.m1.4.4.4.6.cmml"><mi id="S3.E22.m1.4.4.4.6.2.2.2" xref="S3.E22.m1.4.4.4.6.2.2.2.cmml">θ</mi><mtext id="S3.E22.m1.4.4.4.6.2.2.3" xref="S3.E22.m1.4.4.4.6.2.2.3a.cmml">pred</mtext><mrow id="S3.E22.m1.4.4.4.6a" xref="S3.E22.m1.4.4.4.6.cmml"></mrow><mrow id="S3.E22.m1.2.2.2.2.2.4" xref="S3.E22.m1.2.2.2.2.2.3.cmml"><mi id="S3.E22.m1.1.1.1.1.1.1" xref="S3.E22.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E22.m1.2.2.2.2.2.4.1" xref="S3.E22.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E22.m1.2.2.2.2.2.2" xref="S3.E22.m1.2.2.2.2.2.2.cmml">j</mi></mrow><mrow id="S3.E22.m1.4.4.4.6.3" xref="S3.E22.m1.4.4.4.6.3.cmml"><mi id="S3.E22.m1.4.4.4.6.3.2" xref="S3.E22.m1.4.4.4.6.3.2.cmml">n</mi><mo id="S3.E22.m1.4.4.4.6.3.1" xref="S3.E22.m1.4.4.4.6.3.1.cmml">+</mo><mn id="S3.E22.m1.4.4.4.6.3.3" xref="S3.E22.m1.4.4.4.6.3.3.cmml">1</mn></mrow></mmultiscripts><mo id="S3.E22.m1.4.4.4.5" xref="S3.E22.m1.4.4.4.5.cmml">−</mo><mmultiscripts id="S3.E22.m1.4.4.4.7" xref="S3.E22.m1.4.4.4.7.cmml"><mi id="S3.E22.m1.4.4.4.7.2.2.2" xref="S3.E22.m1.4.4.4.7.2.2.2.cmml">θ</mi><mtext id="S3.E22.m1.4.4.4.7.2.2.3" xref="S3.E22.m1.4.4.4.7.2.2.3a.cmml">pred</mtext><mrow id="S3.E22.m1.4.4.4.7a" xref="S3.E22.m1.4.4.4.7.cmml"></mrow><mrow id="S3.E22.m1.4.4.4.4.2.4" xref="S3.E22.m1.4.4.4.4.2.3.cmml"><mi id="S3.E22.m1.3.3.3.3.1.1" xref="S3.E22.m1.3.3.3.3.1.1.cmml">i</mi><mo id="S3.E22.m1.4.4.4.4.2.4.1" xref="S3.E22.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E22.m1.4.4.4.4.2.2" xref="S3.E22.m1.4.4.4.4.2.2.cmml">j</mi></mrow><mi id="S3.E22.m1.4.4.4.7.3" xref="S3.E22.m1.4.4.4.7.3.cmml">n</mi></mmultiscripts></mrow><mrow id="S3.E22.m1.4.4.6" xref="S3.E22.m1.4.4.6.cmml"><mi id="S3.E22.m1.4.4.6.2" mathvariant="normal" xref="S3.E22.m1.4.4.6.2.cmml">Δ</mi><mo id="S3.E22.m1.4.4.6.1" xref="S3.E22.m1.4.4.6.1.cmml">⁢</mo><mi id="S3.E22.m1.4.4.6.3" xref="S3.E22.m1.4.4.6.3.cmml">τ</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E22.m1.4b"><apply id="S3.E22.m1.4.5.cmml" xref="S3.E22.m1.4.5"><approx id="S3.E22.m1.4.5.1.cmml" xref="S3.E22.m1.4.5.1"></approx><apply id="S3.E22.m1.4.5.2.cmml" xref="S3.E22.m1.4.5.2"><divide id="S3.E22.m1.4.5.2.1.cmml" xref="S3.E22.m1.4.5.2"></divide><apply id="S3.E22.m1.4.5.2.2.cmml" xref="S3.E22.m1.4.5.2.2"><partialdiff id="S3.E22.m1.4.5.2.2.1.cmml" xref="S3.E22.m1.4.5.2.2.1"></partialdiff><apply id="S3.E22.m1.4.5.2.2.2.cmml" xref="S3.E22.m1.4.5.2.2.2"><csymbol cd="ambiguous" id="S3.E22.m1.4.5.2.2.2.1.cmml" xref="S3.E22.m1.4.5.2.2.2">subscript</csymbol><ci id="S3.E22.m1.4.5.2.2.2.2.cmml" xref="S3.E22.m1.4.5.2.2.2.2">𝜃</ci><ci id="S3.E22.m1.4.5.2.2.2.3a.cmml" xref="S3.E22.m1.4.5.2.2.2.3"><mtext id="S3.E22.m1.4.5.2.2.2.3.cmml" mathsize="70%" xref="S3.E22.m1.4.5.2.2.2.3">pred</mtext></ci></apply></apply><apply id="S3.E22.m1.4.5.2.3.cmml" xref="S3.E22.m1.4.5.2.3"><partialdiff id="S3.E22.m1.4.5.2.3.1.cmml" xref="S3.E22.m1.4.5.2.3.1"></partialdiff><ci id="S3.E22.m1.4.5.2.3.2.cmml" xref="S3.E22.m1.4.5.2.3.2">𝜏</ci></apply></apply><apply id="S3.E22.m1.4.4.cmml" xref="S3.E22.m1.4.4"><divide id="S3.E22.m1.4.4.5.cmml" xref="S3.E22.m1.4.4"></divide><apply id="S3.E22.m1.4.4.4.cmml" xref="S3.E22.m1.4.4.4"><minus id="S3.E22.m1.4.4.4.5.cmml" xref="S3.E22.m1.4.4.4.5"></minus><apply id="S3.E22.m1.4.4.4.6.cmml" xref="S3.E22.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E22.m1.4.4.4.6.1.cmml" xref="S3.E22.m1.4.4.4.6">superscript</csymbol><apply id="S3.E22.m1.4.4.4.6.2.cmml" xref="S3.E22.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E22.m1.4.4.4.6.2.1.cmml" xref="S3.E22.m1.4.4.4.6">subscript</csymbol><apply id="S3.E22.m1.4.4.4.6.2.2.cmml" xref="S3.E22.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E22.m1.4.4.4.6.2.2.1.cmml" xref="S3.E22.m1.4.4.4.6">subscript</csymbol><ci id="S3.E22.m1.4.4.4.6.2.2.2.cmml" xref="S3.E22.m1.4.4.4.6.2.2.2">𝜃</ci><ci id="S3.E22.m1.4.4.4.6.2.2.3a.cmml" xref="S3.E22.m1.4.4.4.6.2.2.3"><mtext id="S3.E22.m1.4.4.4.6.2.2.3.cmml" mathsize="70%" xref="S3.E22.m1.4.4.4.6.2.2.3">pred</mtext></ci></apply><list id="S3.E22.m1.2.2.2.2.2.3.cmml" xref="S3.E22.m1.2.2.2.2.2.4"><ci id="S3.E22.m1.1.1.1.1.1.1.cmml" xref="S3.E22.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E22.m1.2.2.2.2.2.2.cmml" xref="S3.E22.m1.2.2.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E22.m1.4.4.4.6.3.cmml" xref="S3.E22.m1.4.4.4.6.3"><plus id="S3.E22.m1.4.4.4.6.3.1.cmml" xref="S3.E22.m1.4.4.4.6.3.1"></plus><ci id="S3.E22.m1.4.4.4.6.3.2.cmml" xref="S3.E22.m1.4.4.4.6.3.2">𝑛</ci><cn id="S3.E22.m1.4.4.4.6.3.3.cmml" type="integer" xref="S3.E22.m1.4.4.4.6.3.3">1</cn></apply></apply><apply id="S3.E22.m1.4.4.4.7.cmml" xref="S3.E22.m1.4.4.4.7"><csymbol cd="ambiguous" id="S3.E22.m1.4.4.4.7.1.cmml" xref="S3.E22.m1.4.4.4.7">superscript</csymbol><apply id="S3.E22.m1.4.4.4.7.2.cmml" xref="S3.E22.m1.4.4.4.7"><csymbol cd="ambiguous" id="S3.E22.m1.4.4.4.7.2.1.cmml" xref="S3.E22.m1.4.4.4.7">subscript</csymbol><apply id="S3.E22.m1.4.4.4.7.2.2.cmml" xref="S3.E22.m1.4.4.4.7"><csymbol cd="ambiguous" id="S3.E22.m1.4.4.4.7.2.2.1.cmml" xref="S3.E22.m1.4.4.4.7">subscript</csymbol><ci id="S3.E22.m1.4.4.4.7.2.2.2.cmml" xref="S3.E22.m1.4.4.4.7.2.2.2">𝜃</ci><ci id="S3.E22.m1.4.4.4.7.2.2.3a.cmml" xref="S3.E22.m1.4.4.4.7.2.2.3"><mtext id="S3.E22.m1.4.4.4.7.2.2.3.cmml" mathsize="70%" xref="S3.E22.m1.4.4.4.7.2.2.3">pred</mtext></ci></apply><list id="S3.E22.m1.4.4.4.4.2.3.cmml" xref="S3.E22.m1.4.4.4.4.2.4"><ci id="S3.E22.m1.3.3.3.3.1.1.cmml" xref="S3.E22.m1.3.3.3.3.1.1">𝑖</ci><ci id="S3.E22.m1.4.4.4.4.2.2.cmml" xref="S3.E22.m1.4.4.4.4.2.2">𝑗</ci></list></apply><ci id="S3.E22.m1.4.4.4.7.3.cmml" xref="S3.E22.m1.4.4.4.7.3">𝑛</ci></apply></apply><apply id="S3.E22.m1.4.4.6.cmml" xref="S3.E22.m1.4.4.6"><times id="S3.E22.m1.4.4.6.1.cmml" xref="S3.E22.m1.4.4.6.1"></times><ci id="S3.E22.m1.4.4.6.2.cmml" xref="S3.E22.m1.4.4.6.2">Δ</ci><ci id="S3.E22.m1.4.4.6.3.cmml" xref="S3.E22.m1.4.4.6.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E22.m1.4c">\frac{\partial{\theta_{\text{pred}}}}{\partial\tau}\approx\frac{{\theta_{\text%
{pred}}}_{i,j}^{n+1}-{\theta_{\text{pred}}}_{i,j}^{n}}{\Delta\tau}</annotation><annotation encoding="application/x-llamapun" id="S3.E22.m1.4d">divide start_ARG ∂ italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_τ end_ARG ≈ divide start_ARG italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n + 1 end_POSTSUPERSCRIPT - italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT end_ARG start_ARG roman_Δ italic_τ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p11">
<p class="ltx_p" id="S3.SS5.p11.1">The standard deviation of the residual is used to normalize the residuals:</p>
</div>
<div class="ltx_para" id="S3.SS5.p12">
<table class="ltx_equation ltx_eqn_table" id="S3.E23">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{Residual}_{\text{std}}=\sqrt{\text{Var}(\text{Residual})+\epsilon}" class="ltx_Math" display="block" id="S3.E23.m1.1"><semantics id="S3.E23.m1.1a"><mrow id="S3.E23.m1.1.2" xref="S3.E23.m1.1.2.cmml"><msub id="S3.E23.m1.1.2.2" xref="S3.E23.m1.1.2.2.cmml"><mtext id="S3.E23.m1.1.2.2.2" xref="S3.E23.m1.1.2.2.2a.cmml">Residual</mtext><mtext id="S3.E23.m1.1.2.2.3" xref="S3.E23.m1.1.2.2.3a.cmml">std</mtext></msub><mo id="S3.E23.m1.1.2.1" xref="S3.E23.m1.1.2.1.cmml">=</mo><msqrt id="S3.E23.m1.1.1" xref="S3.E23.m1.1.1.cmml"><mrow id="S3.E23.m1.1.1.1" xref="S3.E23.m1.1.1.1.cmml"><mrow id="S3.E23.m1.1.1.1.3" xref="S3.E23.m1.1.1.1.3.cmml"><mtext id="S3.E23.m1.1.1.1.3.2" xref="S3.E23.m1.1.1.1.3.2a.cmml">Var</mtext><mo id="S3.E23.m1.1.1.1.3.1" xref="S3.E23.m1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E23.m1.1.1.1.3.3.2" xref="S3.E23.m1.1.1.1.1a.cmml"><mo id="S3.E23.m1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E23.m1.1.1.1.1a.cmml">(</mo><mtext id="S3.E23.m1.1.1.1.1" xref="S3.E23.m1.1.1.1.1.cmml">Residual</mtext><mo id="S3.E23.m1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E23.m1.1.1.1.1a.cmml">)</mo></mrow></mrow><mo id="S3.E23.m1.1.1.1.2" xref="S3.E23.m1.1.1.1.2.cmml">+</mo><mi id="S3.E23.m1.1.1.1.4" xref="S3.E23.m1.1.1.1.4.cmml">ϵ</mi></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S3.E23.m1.1b"><apply id="S3.E23.m1.1.2.cmml" xref="S3.E23.m1.1.2"><eq id="S3.E23.m1.1.2.1.cmml" xref="S3.E23.m1.1.2.1"></eq><apply id="S3.E23.m1.1.2.2.cmml" xref="S3.E23.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E23.m1.1.2.2.1.cmml" xref="S3.E23.m1.1.2.2">subscript</csymbol><ci id="S3.E23.m1.1.2.2.2a.cmml" xref="S3.E23.m1.1.2.2.2"><mtext id="S3.E23.m1.1.2.2.2.cmml" xref="S3.E23.m1.1.2.2.2">Residual</mtext></ci><ci id="S3.E23.m1.1.2.2.3a.cmml" xref="S3.E23.m1.1.2.2.3"><mtext id="S3.E23.m1.1.2.2.3.cmml" mathsize="70%" xref="S3.E23.m1.1.2.2.3">std</mtext></ci></apply><apply id="S3.E23.m1.1.1.cmml" xref="S3.E23.m1.1.1"><root id="S3.E23.m1.1.1a.cmml" xref="S3.E23.m1.1.1"></root><apply id="S3.E23.m1.1.1.1.cmml" xref="S3.E23.m1.1.1.1"><plus id="S3.E23.m1.1.1.1.2.cmml" xref="S3.E23.m1.1.1.1.2"></plus><apply id="S3.E23.m1.1.1.1.3.cmml" xref="S3.E23.m1.1.1.1.3"><times id="S3.E23.m1.1.1.1.3.1.cmml" xref="S3.E23.m1.1.1.1.3.1"></times><ci id="S3.E23.m1.1.1.1.3.2a.cmml" xref="S3.E23.m1.1.1.1.3.2"><mtext id="S3.E23.m1.1.1.1.3.2.cmml" xref="S3.E23.m1.1.1.1.3.2">Var</mtext></ci><ci id="S3.E23.m1.1.1.1.1a.cmml" xref="S3.E23.m1.1.1.1.3.3.2"><mtext id="S3.E23.m1.1.1.1.1.cmml" xref="S3.E23.m1.1.1.1.1">Residual</mtext></ci></apply><ci id="S3.E23.m1.1.1.1.4.cmml" xref="S3.E23.m1.1.1.1.4">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E23.m1.1c">\text{Residual}_{\text{std}}=\sqrt{\text{Var}(\text{Residual})+\epsilon}</annotation><annotation encoding="application/x-llamapun" id="S3.E23.m1.1d">Residual start_POSTSUBSCRIPT std end_POSTSUBSCRIPT = square-root start_ARG Var ( Residual ) + italic_ϵ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p13">
<table class="ltx_equation ltx_eqn_table" id="S3.E24">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{Normalized Residual}=\frac{\text{Residual}}{\text{Residual}_{\text{std}}}" class="ltx_Math" display="block" id="S3.E24.m1.1"><semantics id="S3.E24.m1.1a"><mrow id="S3.E24.m1.1.1" xref="S3.E24.m1.1.1.cmml"><mtext id="S3.E24.m1.1.1.2" xref="S3.E24.m1.1.1.2a.cmml">Normalized Residual</mtext><mo id="S3.E24.m1.1.1.1" xref="S3.E24.m1.1.1.1.cmml">=</mo><mfrac id="S3.E24.m1.1.1.3" xref="S3.E24.m1.1.1.3.cmml"><mtext id="S3.E24.m1.1.1.3.2" xref="S3.E24.m1.1.1.3.2a.cmml">Residual</mtext><msub id="S3.E24.m1.1.1.3.3" xref="S3.E24.m1.1.1.3.3.cmml"><mtext id="S3.E24.m1.1.1.3.3.2" xref="S3.E24.m1.1.1.3.3.2a.cmml">Residual</mtext><mtext id="S3.E24.m1.1.1.3.3.3" xref="S3.E24.m1.1.1.3.3.3a.cmml">std</mtext></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E24.m1.1b"><apply id="S3.E24.m1.1.1.cmml" xref="S3.E24.m1.1.1"><eq id="S3.E24.m1.1.1.1.cmml" xref="S3.E24.m1.1.1.1"></eq><ci id="S3.E24.m1.1.1.2a.cmml" xref="S3.E24.m1.1.1.2"><mtext id="S3.E24.m1.1.1.2.cmml" xref="S3.E24.m1.1.1.2">Normalized Residual</mtext></ci><apply id="S3.E24.m1.1.1.3.cmml" xref="S3.E24.m1.1.1.3"><divide id="S3.E24.m1.1.1.3.1.cmml" xref="S3.E24.m1.1.1.3"></divide><ci id="S3.E24.m1.1.1.3.2a.cmml" xref="S3.E24.m1.1.1.3.2"><mtext id="S3.E24.m1.1.1.3.2.cmml" xref="S3.E24.m1.1.1.3.2">Residual</mtext></ci><apply id="S3.E24.m1.1.1.3.3.cmml" xref="S3.E24.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E24.m1.1.1.3.3.1.cmml" xref="S3.E24.m1.1.1.3.3">subscript</csymbol><ci id="S3.E24.m1.1.1.3.3.2a.cmml" xref="S3.E24.m1.1.1.3.3.2"><mtext id="S3.E24.m1.1.1.3.3.2.cmml" xref="S3.E24.m1.1.1.3.3.2">Residual</mtext></ci><ci id="S3.E24.m1.1.1.3.3.3a.cmml" xref="S3.E24.m1.1.1.3.3.3"><mtext id="S3.E24.m1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E24.m1.1.1.3.3.3">std</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E24.m1.1c">\text{Normalized Residual}=\frac{\text{Residual}}{\text{Residual}_{\text{std}}}</annotation><annotation encoding="application/x-llamapun" id="S3.E24.m1.1d">Normalized Residual = divide start_ARG Residual end_ARG start_ARG Residual start_POSTSUBSCRIPT std end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p14">
<p class="ltx_p" id="S3.SS5.p14.1">The physics-informed loss (<math alttext="L_{\text{physics}}" class="ltx_Math" display="inline" id="S3.SS5.p14.1.m1.1"><semantics id="S3.SS5.p14.1.m1.1a"><msub id="S3.SS5.p14.1.m1.1.1" xref="S3.SS5.p14.1.m1.1.1.cmml"><mi id="S3.SS5.p14.1.m1.1.1.2" xref="S3.SS5.p14.1.m1.1.1.2.cmml">L</mi><mtext id="S3.SS5.p14.1.m1.1.1.3" xref="S3.SS5.p14.1.m1.1.1.3a.cmml">physics</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p14.1.m1.1b"><apply id="S3.SS5.p14.1.m1.1.1.cmml" xref="S3.SS5.p14.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p14.1.m1.1.1.1.cmml" xref="S3.SS5.p14.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p14.1.m1.1.1.2.cmml" xref="S3.SS5.p14.1.m1.1.1.2">𝐿</ci><ci id="S3.SS5.p14.1.m1.1.1.3a.cmml" xref="S3.SS5.p14.1.m1.1.1.3"><mtext id="S3.SS5.p14.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p14.1.m1.1.1.3">physics</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p14.1.m1.1c">L_{\text{physics}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p14.1.m1.1d">italic_L start_POSTSUBSCRIPT physics end_POSTSUBSCRIPT</annotation></semantics></math>) is then given by:</p>
</div>
<div class="ltx_para" id="S3.SS5.p15">
<table class="ltx_equation ltx_eqn_table" id="S3.E25">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="L_{\text{physics}}=\frac{1}{N}\sum_{i=1}^{N}\left(\text{Normalized Residual}_{%
i}\right)^{2}" class="ltx_Math" display="block" id="S3.E25.m1.1"><semantics id="S3.E25.m1.1a"><mrow id="S3.E25.m1.1.1" xref="S3.E25.m1.1.1.cmml"><msub id="S3.E25.m1.1.1.3" xref="S3.E25.m1.1.1.3.cmml"><mi id="S3.E25.m1.1.1.3.2" xref="S3.E25.m1.1.1.3.2.cmml">L</mi><mtext id="S3.E25.m1.1.1.3.3" xref="S3.E25.m1.1.1.3.3a.cmml">physics</mtext></msub><mo id="S3.E25.m1.1.1.2" xref="S3.E25.m1.1.1.2.cmml">=</mo><mrow id="S3.E25.m1.1.1.1" xref="S3.E25.m1.1.1.1.cmml"><mfrac id="S3.E25.m1.1.1.1.3" xref="S3.E25.m1.1.1.1.3.cmml"><mn id="S3.E25.m1.1.1.1.3.2" xref="S3.E25.m1.1.1.1.3.2.cmml">1</mn><mi id="S3.E25.m1.1.1.1.3.3" xref="S3.E25.m1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S3.E25.m1.1.1.1.2" xref="S3.E25.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E25.m1.1.1.1.1" xref="S3.E25.m1.1.1.1.1.cmml"><munderover id="S3.E25.m1.1.1.1.1.2" xref="S3.E25.m1.1.1.1.1.2.cmml"><mo id="S3.E25.m1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E25.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E25.m1.1.1.1.1.2.2.3" xref="S3.E25.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E25.m1.1.1.1.1.2.2.3.2" xref="S3.E25.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E25.m1.1.1.1.1.2.2.3.1" xref="S3.E25.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E25.m1.1.1.1.1.2.2.3.3" xref="S3.E25.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E25.m1.1.1.1.1.2.3" xref="S3.E25.m1.1.1.1.1.2.3.cmml">N</mi></munderover><msup id="S3.E25.m1.1.1.1.1.1" xref="S3.E25.m1.1.1.1.1.1.cmml"><mrow id="S3.E25.m1.1.1.1.1.1.1.1" xref="S3.E25.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E25.m1.1.1.1.1.1.1.1.2" xref="S3.E25.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E25.m1.1.1.1.1.1.1.1.1" xref="S3.E25.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E25.m1.1.1.1.1.1.1.1.1.2" xref="S3.E25.m1.1.1.1.1.1.1.1.1.2a.cmml">Normalized Residual</mtext><mi id="S3.E25.m1.1.1.1.1.1.1.1.1.3" xref="S3.E25.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E25.m1.1.1.1.1.1.1.1.3" xref="S3.E25.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E25.m1.1.1.1.1.1.3" xref="S3.E25.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E25.m1.1b"><apply id="S3.E25.m1.1.1.cmml" xref="S3.E25.m1.1.1"><eq id="S3.E25.m1.1.1.2.cmml" xref="S3.E25.m1.1.1.2"></eq><apply id="S3.E25.m1.1.1.3.cmml" xref="S3.E25.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E25.m1.1.1.3.1.cmml" xref="S3.E25.m1.1.1.3">subscript</csymbol><ci id="S3.E25.m1.1.1.3.2.cmml" xref="S3.E25.m1.1.1.3.2">𝐿</ci><ci id="S3.E25.m1.1.1.3.3a.cmml" xref="S3.E25.m1.1.1.3.3"><mtext id="S3.E25.m1.1.1.3.3.cmml" mathsize="70%" xref="S3.E25.m1.1.1.3.3">physics</mtext></ci></apply><apply id="S3.E25.m1.1.1.1.cmml" xref="S3.E25.m1.1.1.1"><times id="S3.E25.m1.1.1.1.2.cmml" xref="S3.E25.m1.1.1.1.2"></times><apply id="S3.E25.m1.1.1.1.3.cmml" xref="S3.E25.m1.1.1.1.3"><divide id="S3.E25.m1.1.1.1.3.1.cmml" xref="S3.E25.m1.1.1.1.3"></divide><cn id="S3.E25.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E25.m1.1.1.1.3.2">1</cn><ci id="S3.E25.m1.1.1.1.3.3.cmml" xref="S3.E25.m1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.E25.m1.1.1.1.1.cmml" xref="S3.E25.m1.1.1.1.1"><apply id="S3.E25.m1.1.1.1.1.2.cmml" xref="S3.E25.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E25.m1.1.1.1.1.2.1.cmml" xref="S3.E25.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E25.m1.1.1.1.1.2.2.cmml" xref="S3.E25.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E25.m1.1.1.1.1.2.2.1.cmml" xref="S3.E25.m1.1.1.1.1.2">subscript</csymbol><sum id="S3.E25.m1.1.1.1.1.2.2.2.cmml" xref="S3.E25.m1.1.1.1.1.2.2.2"></sum><apply id="S3.E25.m1.1.1.1.1.2.2.3.cmml" xref="S3.E25.m1.1.1.1.1.2.2.3"><eq id="S3.E25.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E25.m1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E25.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E25.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E25.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E25.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E25.m1.1.1.1.1.2.3.cmml" xref="S3.E25.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E25.m1.1.1.1.1.1.cmml" xref="S3.E25.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E25.m1.1.1.1.1.1.2.cmml" xref="S3.E25.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E25.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E25.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E25.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E25.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E25.m1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E25.m1.1.1.1.1.1.1.1.1.2"><mtext id="S3.E25.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E25.m1.1.1.1.1.1.1.1.1.2">Normalized Residual</mtext></ci><ci id="S3.E25.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E25.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><cn id="S3.E25.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E25.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E25.m1.1c">L_{\text{physics}}=\frac{1}{N}\sum_{i=1}^{N}\left(\text{Normalized Residual}_{%
i}\right)^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E25.m1.1d">italic_L start_POSTSUBSCRIPT physics end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( Normalized Residual start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p15.2">where <math alttext="N" class="ltx_Math" display="inline" id="S3.SS5.p15.1.m1.1"><semantics id="S3.SS5.p15.1.m1.1a"><mi id="S3.SS5.p15.1.m1.1.1" xref="S3.SS5.p15.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p15.1.m1.1b"><ci id="S3.SS5.p15.1.m1.1.1.cmml" xref="S3.SS5.p15.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p15.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p15.1.m1.1d">italic_N</annotation></semantics></math> is the total number of residuals, calculated as the product of the number of samples, the number of grid points in the spatial domain (<math alttext="nx\times ny" class="ltx_Math" display="inline" id="S3.SS5.p15.2.m2.1"><semantics id="S3.SS5.p15.2.m2.1a"><mrow id="S3.SS5.p15.2.m2.1.1" xref="S3.SS5.p15.2.m2.1.1.cmml"><mrow id="S3.SS5.p15.2.m2.1.1.2" xref="S3.SS5.p15.2.m2.1.1.2.cmml"><mrow id="S3.SS5.p15.2.m2.1.1.2.2" xref="S3.SS5.p15.2.m2.1.1.2.2.cmml"><mi id="S3.SS5.p15.2.m2.1.1.2.2.2" xref="S3.SS5.p15.2.m2.1.1.2.2.2.cmml">n</mi><mo id="S3.SS5.p15.2.m2.1.1.2.2.1" xref="S3.SS5.p15.2.m2.1.1.2.2.1.cmml">⁢</mo><mi id="S3.SS5.p15.2.m2.1.1.2.2.3" xref="S3.SS5.p15.2.m2.1.1.2.2.3.cmml">x</mi></mrow><mo id="S3.SS5.p15.2.m2.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS5.p15.2.m2.1.1.2.1.cmml">×</mo><mi id="S3.SS5.p15.2.m2.1.1.2.3" xref="S3.SS5.p15.2.m2.1.1.2.3.cmml">n</mi></mrow><mo id="S3.SS5.p15.2.m2.1.1.1" xref="S3.SS5.p15.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS5.p15.2.m2.1.1.3" xref="S3.SS5.p15.2.m2.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p15.2.m2.1b"><apply id="S3.SS5.p15.2.m2.1.1.cmml" xref="S3.SS5.p15.2.m2.1.1"><times id="S3.SS5.p15.2.m2.1.1.1.cmml" xref="S3.SS5.p15.2.m2.1.1.1"></times><apply id="S3.SS5.p15.2.m2.1.1.2.cmml" xref="S3.SS5.p15.2.m2.1.1.2"><times id="S3.SS5.p15.2.m2.1.1.2.1.cmml" xref="S3.SS5.p15.2.m2.1.1.2.1"></times><apply id="S3.SS5.p15.2.m2.1.1.2.2.cmml" xref="S3.SS5.p15.2.m2.1.1.2.2"><times id="S3.SS5.p15.2.m2.1.1.2.2.1.cmml" xref="S3.SS5.p15.2.m2.1.1.2.2.1"></times><ci id="S3.SS5.p15.2.m2.1.1.2.2.2.cmml" xref="S3.SS5.p15.2.m2.1.1.2.2.2">𝑛</ci><ci id="S3.SS5.p15.2.m2.1.1.2.2.3.cmml" xref="S3.SS5.p15.2.m2.1.1.2.2.3">𝑥</ci></apply><ci id="S3.SS5.p15.2.m2.1.1.2.3.cmml" xref="S3.SS5.p15.2.m2.1.1.2.3">𝑛</ci></apply><ci id="S3.SS5.p15.2.m2.1.1.3.cmml" xref="S3.SS5.p15.2.m2.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p15.2.m2.1c">nx\times ny</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p15.2.m2.1d">italic_n italic_x × italic_n italic_y</annotation></semantics></math>), and the number of time steps in the sequence.</p>
</div>
<div class="ltx_para" id="S3.SS5.p16">
<p class="ltx_p" id="S3.SS5.p16.1">The boundary condition loss (<math alttext="L_{\text{boundary}}" class="ltx_Math" display="inline" id="S3.SS5.p16.1.m1.1"><semantics id="S3.SS5.p16.1.m1.1a"><msub id="S3.SS5.p16.1.m1.1.1" xref="S3.SS5.p16.1.m1.1.1.cmml"><mi id="S3.SS5.p16.1.m1.1.1.2" xref="S3.SS5.p16.1.m1.1.1.2.cmml">L</mi><mtext id="S3.SS5.p16.1.m1.1.1.3" xref="S3.SS5.p16.1.m1.1.1.3a.cmml">boundary</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p16.1.m1.1b"><apply id="S3.SS5.p16.1.m1.1.1.cmml" xref="S3.SS5.p16.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p16.1.m1.1.1.1.cmml" xref="S3.SS5.p16.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p16.1.m1.1.1.2.cmml" xref="S3.SS5.p16.1.m1.1.1.2">𝐿</ci><ci id="S3.SS5.p16.1.m1.1.1.3a.cmml" xref="S3.SS5.p16.1.m1.1.1.3"><mtext id="S3.SS5.p16.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p16.1.m1.1.1.3">boundary</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p16.1.m1.1c">L_{\text{boundary}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p16.1.m1.1d">italic_L start_POSTSUBSCRIPT boundary end_POSTSUBSCRIPT</annotation></semantics></math>) is calculated as the mean square error (MSE) between the predicted and expected Dirichlet values at the boundaries:</p>
</div>
<div class="ltx_para" id="S3.SS5.p17">
<table class="ltx_equation ltx_eqn_table" id="S3.E26">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="L_{\text{boundary}}=\text{MSE}(\theta_{\text{pred}}|_{\text{boundary}},\theta_%
{\text{true}}|_{\text{boundary}})" class="ltx_Math" display="block" id="S3.E26.m1.4"><semantics id="S3.E26.m1.4a"><mrow id="S3.E26.m1.4.4" xref="S3.E26.m1.4.4.cmml"><msub id="S3.E26.m1.4.4.4" xref="S3.E26.m1.4.4.4.cmml"><mi id="S3.E26.m1.4.4.4.2" xref="S3.E26.m1.4.4.4.2.cmml">L</mi><mtext id="S3.E26.m1.4.4.4.3" xref="S3.E26.m1.4.4.4.3a.cmml">boundary</mtext></msub><mo id="S3.E26.m1.4.4.3" xref="S3.E26.m1.4.4.3.cmml">=</mo><mrow id="S3.E26.m1.4.4.2" xref="S3.E26.m1.4.4.2.cmml"><mtext id="S3.E26.m1.4.4.2.4" xref="S3.E26.m1.4.4.2.4a.cmml">MSE</mtext><mo id="S3.E26.m1.4.4.2.3" xref="S3.E26.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.E26.m1.4.4.2.2.2" xref="S3.E26.m1.4.4.2.2.3.cmml"><mo id="S3.E26.m1.4.4.2.2.2.3" stretchy="false" xref="S3.E26.m1.4.4.2.2.3.cmml">(</mo><msub id="S3.E26.m1.3.3.1.1.1.1.1" xref="S3.E26.m1.3.3.1.1.1.1.2.cmml"><mrow id="S3.E26.m1.3.3.1.1.1.1.1.1" xref="S3.E26.m1.3.3.1.1.1.1.2.cmml"><msub id="S3.E26.m1.3.3.1.1.1.1.1.1.1" xref="S3.E26.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E26.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E26.m1.3.3.1.1.1.1.1.1.1.2.cmml">θ</mi><mtext id="S3.E26.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E26.m1.3.3.1.1.1.1.1.1.1.3a.cmml">pred</mtext></msub><mo id="S3.E26.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E26.m1.3.3.1.1.1.1.2.1.cmml">|</mo></mrow><mtext id="S3.E26.m1.1.1.1" xref="S3.E26.m1.1.1.1a.cmml">boundary</mtext></msub><mo id="S3.E26.m1.4.4.2.2.2.4" xref="S3.E26.m1.4.4.2.2.3.cmml">,</mo><msub id="S3.E26.m1.4.4.2.2.2.2.1" xref="S3.E26.m1.4.4.2.2.2.2.2.cmml"><mrow id="S3.E26.m1.4.4.2.2.2.2.1.1" xref="S3.E26.m1.4.4.2.2.2.2.2.cmml"><msub id="S3.E26.m1.4.4.2.2.2.2.1.1.1" xref="S3.E26.m1.4.4.2.2.2.2.1.1.1.cmml"><mi id="S3.E26.m1.4.4.2.2.2.2.1.1.1.2" xref="S3.E26.m1.4.4.2.2.2.2.1.1.1.2.cmml">θ</mi><mtext id="S3.E26.m1.4.4.2.2.2.2.1.1.1.3" xref="S3.E26.m1.4.4.2.2.2.2.1.1.1.3a.cmml">true</mtext></msub><mo id="S3.E26.m1.4.4.2.2.2.2.1.1.2" stretchy="false" xref="S3.E26.m1.4.4.2.2.2.2.2.1.cmml">|</mo></mrow><mtext id="S3.E26.m1.2.2.1" xref="S3.E26.m1.2.2.1a.cmml">boundary</mtext></msub><mo id="S3.E26.m1.4.4.2.2.2.5" stretchy="false" xref="S3.E26.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E26.m1.4b"><apply id="S3.E26.m1.4.4.cmml" xref="S3.E26.m1.4.4"><eq id="S3.E26.m1.4.4.3.cmml" xref="S3.E26.m1.4.4.3"></eq><apply id="S3.E26.m1.4.4.4.cmml" xref="S3.E26.m1.4.4.4"><csymbol cd="ambiguous" id="S3.E26.m1.4.4.4.1.cmml" xref="S3.E26.m1.4.4.4">subscript</csymbol><ci id="S3.E26.m1.4.4.4.2.cmml" xref="S3.E26.m1.4.4.4.2">𝐿</ci><ci id="S3.E26.m1.4.4.4.3a.cmml" xref="S3.E26.m1.4.4.4.3"><mtext id="S3.E26.m1.4.4.4.3.cmml" mathsize="70%" xref="S3.E26.m1.4.4.4.3">boundary</mtext></ci></apply><apply id="S3.E26.m1.4.4.2.cmml" xref="S3.E26.m1.4.4.2"><times id="S3.E26.m1.4.4.2.3.cmml" xref="S3.E26.m1.4.4.2.3"></times><ci id="S3.E26.m1.4.4.2.4a.cmml" xref="S3.E26.m1.4.4.2.4"><mtext id="S3.E26.m1.4.4.2.4.cmml" xref="S3.E26.m1.4.4.2.4">MSE</mtext></ci><interval closure="open" id="S3.E26.m1.4.4.2.2.3.cmml" xref="S3.E26.m1.4.4.2.2.2"><apply id="S3.E26.m1.3.3.1.1.1.1.2.cmml" xref="S3.E26.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E26.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E26.m1.3.3.1.1.1.1.1.1.2">evaluated-at</csymbol><apply id="S3.E26.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E26.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E26.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E26.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E26.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E26.m1.3.3.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E26.m1.3.3.1.1.1.1.1.1.1.3a.cmml" xref="S3.E26.m1.3.3.1.1.1.1.1.1.1.3"><mtext id="S3.E26.m1.3.3.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E26.m1.3.3.1.1.1.1.1.1.1.3">pred</mtext></ci></apply><ci id="S3.E26.m1.1.1.1a.cmml" xref="S3.E26.m1.1.1.1"><mtext id="S3.E26.m1.1.1.1.cmml" mathsize="70%" xref="S3.E26.m1.1.1.1">boundary</mtext></ci></apply><apply id="S3.E26.m1.4.4.2.2.2.2.2.cmml" xref="S3.E26.m1.4.4.2.2.2.2.1"><csymbol cd="latexml" id="S3.E26.m1.4.4.2.2.2.2.2.1.cmml" xref="S3.E26.m1.4.4.2.2.2.2.1.1.2">evaluated-at</csymbol><apply id="S3.E26.m1.4.4.2.2.2.2.1.1.1.cmml" xref="S3.E26.m1.4.4.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E26.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="S3.E26.m1.4.4.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E26.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="S3.E26.m1.4.4.2.2.2.2.1.1.1.2">𝜃</ci><ci id="S3.E26.m1.4.4.2.2.2.2.1.1.1.3a.cmml" xref="S3.E26.m1.4.4.2.2.2.2.1.1.1.3"><mtext id="S3.E26.m1.4.4.2.2.2.2.1.1.1.3.cmml" mathsize="70%" xref="S3.E26.m1.4.4.2.2.2.2.1.1.1.3">true</mtext></ci></apply><ci id="S3.E26.m1.2.2.1a.cmml" xref="S3.E26.m1.2.2.1"><mtext id="S3.E26.m1.2.2.1.cmml" mathsize="70%" xref="S3.E26.m1.2.2.1">boundary</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E26.m1.4c">L_{\text{boundary}}=\text{MSE}(\theta_{\text{pred}}|_{\text{boundary}},\theta_%
{\text{true}}|_{\text{boundary}})</annotation><annotation encoding="application/x-llamapun" id="S3.E26.m1.4d">italic_L start_POSTSUBSCRIPT boundary end_POSTSUBSCRIPT = MSE ( italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT | start_POSTSUBSCRIPT boundary end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT true end_POSTSUBSCRIPT | start_POSTSUBSCRIPT boundary end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p18">
<p class="ltx_p" id="S3.SS5.p18.1">The initial condition loss (<math alttext="L_{\text{initial}}" class="ltx_Math" display="inline" id="S3.SS5.p18.1.m1.1"><semantics id="S3.SS5.p18.1.m1.1a"><msub id="S3.SS5.p18.1.m1.1.1" xref="S3.SS5.p18.1.m1.1.1.cmml"><mi id="S3.SS5.p18.1.m1.1.1.2" xref="S3.SS5.p18.1.m1.1.1.2.cmml">L</mi><mtext id="S3.SS5.p18.1.m1.1.1.3" xref="S3.SS5.p18.1.m1.1.1.3a.cmml">initial</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p18.1.m1.1b"><apply id="S3.SS5.p18.1.m1.1.1.cmml" xref="S3.SS5.p18.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p18.1.m1.1.1.1.cmml" xref="S3.SS5.p18.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p18.1.m1.1.1.2.cmml" xref="S3.SS5.p18.1.m1.1.1.2">𝐿</ci><ci id="S3.SS5.p18.1.m1.1.1.3a.cmml" xref="S3.SS5.p18.1.m1.1.1.3"><mtext id="S3.SS5.p18.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p18.1.m1.1.1.3">initial</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p18.1.m1.1c">L_{\text{initial}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p18.1.m1.1d">italic_L start_POSTSUBSCRIPT initial end_POSTSUBSCRIPT</annotation></semantics></math>) is calculated as the MSE between the predicted and expected values at the initial (unmasked) time steps:</p>
</div>
<div class="ltx_para" id="S3.SS5.p19">
<table class="ltx_equation ltx_eqn_table" id="S3.E27">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="L_{\text{initial}}=\text{MSE}(\theta_{\text{pred}}|_{t=0},\theta_{\text{true}}%
|_{t=0})" class="ltx_Math" display="block" id="S3.E27.m1.4"><semantics id="S3.E27.m1.4a"><mrow id="S3.E27.m1.4.4" xref="S3.E27.m1.4.4.cmml"><msub id="S3.E27.m1.4.4.4" xref="S3.E27.m1.4.4.4.cmml"><mi id="S3.E27.m1.4.4.4.2" xref="S3.E27.m1.4.4.4.2.cmml">L</mi><mtext id="S3.E27.m1.4.4.4.3" xref="S3.E27.m1.4.4.4.3a.cmml">initial</mtext></msub><mo id="S3.E27.m1.4.4.3" xref="S3.E27.m1.4.4.3.cmml">=</mo><mrow id="S3.E27.m1.4.4.2" xref="S3.E27.m1.4.4.2.cmml"><mtext id="S3.E27.m1.4.4.2.4" xref="S3.E27.m1.4.4.2.4a.cmml">MSE</mtext><mo id="S3.E27.m1.4.4.2.3" xref="S3.E27.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.E27.m1.4.4.2.2.2" xref="S3.E27.m1.4.4.2.2.3.cmml"><mo id="S3.E27.m1.4.4.2.2.2.3" stretchy="false" xref="S3.E27.m1.4.4.2.2.3.cmml">(</mo><msub id="S3.E27.m1.3.3.1.1.1.1.1" xref="S3.E27.m1.3.3.1.1.1.1.2.cmml"><mrow id="S3.E27.m1.3.3.1.1.1.1.1.1" xref="S3.E27.m1.3.3.1.1.1.1.2.cmml"><msub id="S3.E27.m1.3.3.1.1.1.1.1.1.1" xref="S3.E27.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E27.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E27.m1.3.3.1.1.1.1.1.1.1.2.cmml">θ</mi><mtext id="S3.E27.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E27.m1.3.3.1.1.1.1.1.1.1.3a.cmml">pred</mtext></msub><mo id="S3.E27.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E27.m1.3.3.1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E27.m1.1.1.1" xref="S3.E27.m1.1.1.1.cmml"><mi id="S3.E27.m1.1.1.1.2" xref="S3.E27.m1.1.1.1.2.cmml">t</mi><mo id="S3.E27.m1.1.1.1.1" xref="S3.E27.m1.1.1.1.1.cmml">=</mo><mn id="S3.E27.m1.1.1.1.3" xref="S3.E27.m1.1.1.1.3.cmml">0</mn></mrow></msub><mo id="S3.E27.m1.4.4.2.2.2.4" xref="S3.E27.m1.4.4.2.2.3.cmml">,</mo><msub id="S3.E27.m1.4.4.2.2.2.2.1" xref="S3.E27.m1.4.4.2.2.2.2.2.cmml"><mrow id="S3.E27.m1.4.4.2.2.2.2.1.1" xref="S3.E27.m1.4.4.2.2.2.2.2.cmml"><msub id="S3.E27.m1.4.4.2.2.2.2.1.1.1" xref="S3.E27.m1.4.4.2.2.2.2.1.1.1.cmml"><mi id="S3.E27.m1.4.4.2.2.2.2.1.1.1.2" xref="S3.E27.m1.4.4.2.2.2.2.1.1.1.2.cmml">θ</mi><mtext id="S3.E27.m1.4.4.2.2.2.2.1.1.1.3" xref="S3.E27.m1.4.4.2.2.2.2.1.1.1.3a.cmml">true</mtext></msub><mo id="S3.E27.m1.4.4.2.2.2.2.1.1.2" stretchy="false" xref="S3.E27.m1.4.4.2.2.2.2.2.1.cmml">|</mo></mrow><mrow id="S3.E27.m1.2.2.1" xref="S3.E27.m1.2.2.1.cmml"><mi id="S3.E27.m1.2.2.1.2" xref="S3.E27.m1.2.2.1.2.cmml">t</mi><mo id="S3.E27.m1.2.2.1.1" xref="S3.E27.m1.2.2.1.1.cmml">=</mo><mn id="S3.E27.m1.2.2.1.3" xref="S3.E27.m1.2.2.1.3.cmml">0</mn></mrow></msub><mo id="S3.E27.m1.4.4.2.2.2.5" stretchy="false" xref="S3.E27.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E27.m1.4b"><apply id="S3.E27.m1.4.4.cmml" xref="S3.E27.m1.4.4"><eq id="S3.E27.m1.4.4.3.cmml" xref="S3.E27.m1.4.4.3"></eq><apply id="S3.E27.m1.4.4.4.cmml" xref="S3.E27.m1.4.4.4"><csymbol cd="ambiguous" id="S3.E27.m1.4.4.4.1.cmml" xref="S3.E27.m1.4.4.4">subscript</csymbol><ci id="S3.E27.m1.4.4.4.2.cmml" xref="S3.E27.m1.4.4.4.2">𝐿</ci><ci id="S3.E27.m1.4.4.4.3a.cmml" xref="S3.E27.m1.4.4.4.3"><mtext id="S3.E27.m1.4.4.4.3.cmml" mathsize="70%" xref="S3.E27.m1.4.4.4.3">initial</mtext></ci></apply><apply id="S3.E27.m1.4.4.2.cmml" xref="S3.E27.m1.4.4.2"><times id="S3.E27.m1.4.4.2.3.cmml" xref="S3.E27.m1.4.4.2.3"></times><ci id="S3.E27.m1.4.4.2.4a.cmml" xref="S3.E27.m1.4.4.2.4"><mtext id="S3.E27.m1.4.4.2.4.cmml" xref="S3.E27.m1.4.4.2.4">MSE</mtext></ci><interval closure="open" id="S3.E27.m1.4.4.2.2.3.cmml" xref="S3.E27.m1.4.4.2.2.2"><apply id="S3.E27.m1.3.3.1.1.1.1.2.cmml" xref="S3.E27.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E27.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E27.m1.3.3.1.1.1.1.1.1.2">evaluated-at</csymbol><apply id="S3.E27.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E27.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E27.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E27.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E27.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E27.m1.3.3.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E27.m1.3.3.1.1.1.1.1.1.1.3a.cmml" xref="S3.E27.m1.3.3.1.1.1.1.1.1.1.3"><mtext id="S3.E27.m1.3.3.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E27.m1.3.3.1.1.1.1.1.1.1.3">pred</mtext></ci></apply><apply id="S3.E27.m1.1.1.1.cmml" xref="S3.E27.m1.1.1.1"><eq id="S3.E27.m1.1.1.1.1.cmml" xref="S3.E27.m1.1.1.1.1"></eq><ci id="S3.E27.m1.1.1.1.2.cmml" xref="S3.E27.m1.1.1.1.2">𝑡</ci><cn id="S3.E27.m1.1.1.1.3.cmml" type="integer" xref="S3.E27.m1.1.1.1.3">0</cn></apply></apply><apply id="S3.E27.m1.4.4.2.2.2.2.2.cmml" xref="S3.E27.m1.4.4.2.2.2.2.1"><csymbol cd="latexml" id="S3.E27.m1.4.4.2.2.2.2.2.1.cmml" xref="S3.E27.m1.4.4.2.2.2.2.1.1.2">evaluated-at</csymbol><apply id="S3.E27.m1.4.4.2.2.2.2.1.1.1.cmml" xref="S3.E27.m1.4.4.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E27.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="S3.E27.m1.4.4.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E27.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="S3.E27.m1.4.4.2.2.2.2.1.1.1.2">𝜃</ci><ci id="S3.E27.m1.4.4.2.2.2.2.1.1.1.3a.cmml" xref="S3.E27.m1.4.4.2.2.2.2.1.1.1.3"><mtext id="S3.E27.m1.4.4.2.2.2.2.1.1.1.3.cmml" mathsize="70%" xref="S3.E27.m1.4.4.2.2.2.2.1.1.1.3">true</mtext></ci></apply><apply id="S3.E27.m1.2.2.1.cmml" xref="S3.E27.m1.2.2.1"><eq id="S3.E27.m1.2.2.1.1.cmml" xref="S3.E27.m1.2.2.1.1"></eq><ci id="S3.E27.m1.2.2.1.2.cmml" xref="S3.E27.m1.2.2.1.2">𝑡</ci><cn id="S3.E27.m1.2.2.1.3.cmml" type="integer" xref="S3.E27.m1.2.2.1.3">0</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E27.m1.4c">L_{\text{initial}}=\text{MSE}(\theta_{\text{pred}}|_{t=0},\theta_{\text{true}}%
|_{t=0})</annotation><annotation encoding="application/x-llamapun" id="S3.E27.m1.4d">italic_L start_POSTSUBSCRIPT initial end_POSTSUBSCRIPT = MSE ( italic_θ start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT | start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT true end_POSTSUBSCRIPT | start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p20">
<p class="ltx_p" id="S3.SS5.p20.1">The use of the physics-informed loss component in the model training scheme enforces alignment with the finite difference stencil for the heat conduction equation. This implicitly captures correlations between successive time steps by minimizing the residuals of the governing equations over the predicted sequence. Unlike in NLP applications, such as Large Language Models (LLMs), where a probability distribution over outcomes is predicted due to inherent uncertainty in language generation, our model predicts a deterministic solution for the temperature field. In probabilistic models, cross-correlation is useful for analyzing relationships between uncertain predictions. However, since our model produces a single outcome, temporal and spatial dependencies are already captured by the physics-based loss, making cross-correlation unnecessary. This approach is particularly relevant in block prediction mode, where outputs are predicted jointly and treated as independent, while in autoregressive mode, each prediction is conditioned on the previous ones, reducing the need to explicitly account for correlations between outputs.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Implementation</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.1">The numerical code is implemented in Python using the MLX framework and occasionally NumPy for array operations and is shared under an MIT license on GitHub<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Repository available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/sck-at-ucy/MLX_BeyondLanguage" title="">https://github.com/sck-at-ucy/MLX_BeyondLanguage</a></span></span></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib16" title="">16</a>]</cite>.
MLX is used for core machine learning operations such as the definition of the model class for the physics-centric Transformer, the definition of loss functions and the training and validation process. Numpy is used for supporting utilities such as the generation of initial and boundary conditions and the creation of the datasets used for training, validation and testing. Conversion between MLX and Numpy arrays is trivial, e.g.</p>
</div>
<figure class="ltx_figure" id="S3.F14">
<div class="ltx_logical-block ltx_align_center" id="S3.F14.1">
<div class="ltx_para ltx_noindent ltx_align_center" id="S3.F14.1.p1">
<svg class="ltx_picture" height="89.11" id="S3.F14.1.p1.pic1" overflow="visible" version="1.1" width="450"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,89.11) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 0 L 0 89.11 L 450 89.11 L 450 0 Z" style="stroke:none"></path></g><g fill="#F9F9F9" fill-opacity="1.0"><path d="M 0.39 0.39 L 0.39 88.72 L 449.61 88.72 L 449.61 0.39 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 35.83 27.95)"><foreignobject color="#000000" height="33.21" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="378.35">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S3.F14.1.p1.pic1.1.1.1.1.1" style="width:273.4pt;">
<span class="ltx_p" id="S3.F14.1.p1.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="S3.F14.1.p1.pic1.1.1.1.1.1.1.1">import mlx.core as mx</span></span>
<span class="ltx_p ltx_align_left" id="S3.F14.1.p1.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="S3.F14.1.p1.pic1.1.1.1.1.1.2.1">import numpy as np</span></span>
<span class="ltx_p ltx_align_left" id="S3.F14.1.p1.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter" id="S3.F14.1.p1.pic1.1.1.1.1.1.3.1">a = mx.arrange(3)</span></span>
<span class="ltx_p ltx_align_left" id="S3.F14.1.p1.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter" id="S3.F14.1.p1.pic1.1.1.1.1.1.4.1">b = np.array(a) </span> # copy of a</span>
<span class="ltx_p ltx_align_left" id="S3.F14.1.p1.pic1.1.1.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="S3.F14.1.p1.pic1.1.1.1.1.1.5.1">c = mx.array(b) </span> # copy of b</span>
</span></foreignobject></g></g></svg>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F14.3.1.1" style="font-size:90%;">Figure 14</span>: </span><span class="ltx_text" id="S3.F14.4.2" style="font-size:90%;">Converting between MLX arrays and NumPy arrays. </span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS6.p2">
<p class="ltx_p" id="S3.SS6.p2.1">The code is structured to manage everything from initializing the geometrical setup and boundary conditions, through generating datasets, training, and evaluating the model, to plotting the results and saving the model for future use. Here’s a breakdown of its main components and functionality:</p>
</div>
<div class="ltx_para" id="S3.SS6.p3">
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Random Seeds and Configuration:</span> The script starts by setting random seeds for reproducibility and defining configurations for model parameters, boundary conditions, and geometry of the 2D plate.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">Geometry and Boundary Conditions:</span> It initializes the geometry and boundary conditions of the plate, deriving dimensions from the configuration and generating boundary conditions (BCs) and thermal diffusivities (alphas) for training, validation, and testing datasets.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.1">Data Generation:</span> Uses a finite difference method to generate datasets for the thermal simulation of the plate. This involves setting up a grid based on the plate dimensions and iterating over time steps to simulate heat distribution according to the given BCs and thermal diffusivities.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i4.p1.1.1">Model Definition:</span> A masked Transformer model is implemented, specifically designed to handle the spatial and temporal aspects of the heat diffusion problem. It includes positional encodings for different dimensions and a Transformer encoder architecture tailored to this application.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="S3.I1.i5.p1">
<p class="ltx_p" id="S3.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i5.p1.1.1">Model Predictions Modes:</span> The model can be trained either in a Block Prediction mode or an Autoregressive Stepwise Prediction mode. The basic structure of the model remains largely unmodified and what enables the two alternative modes is the use of different attention masks.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span>
<div class="ltx_para" id="S3.I1.i6.p1">
<p class="ltx_p" id="S3.I1.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i6.p1.1.1">Training and Validation:</span> The training process involves forward passes to compute losses including a physics-informed loss that integrates knowledge of the heat equation. Normalization of the various loss components is key for achieving best model performance. Updates of the model’s weights are done via the Adam optimizer. Validation occurs concurrently to gauge the model’s performance on unseen data. The code leverages the MLX compile function transformation, which compiles computation graphs. Function compilation results in smaller graphs by merging common work and fusing certain operations and in our case achieves approximately 25% speedup during training.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">7.</span>
<div class="ltx_para" id="S3.I1.i7.p1">
<p class="ltx_p" id="S3.I1.i7.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i7.p1.1.1">Testing the Trained Model:</span> Testing of the trained model takes into account whether the model has been trained to operate as a Block Predictor or an Autoregressive Stepwise Predictor. The testing loss reported in each case reflects this.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">8.</span>
<div class="ltx_para" id="S3.I1.i8.p1">
<p class="ltx_p" id="S3.I1.i8.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i8.p1.1.1">Plotting and Saving:</span> It can plot the model’s predictions against the actual data to visually assess performance. It also provides functionality to save both the model’s parameters and the configuration settings to ensure experiments are easily reproducible.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">9.</span>
<div class="ltx_para" id="S3.I1.i9.p1">
<p class="ltx_p" id="S3.I1.i9.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i9.p1.1.1">Utility Functions:</span> Several utility functions support the main processes, including generating the initial datasets, loading data in batches, calculating derivatives for the physics-informed loss, and more.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS6.p4">
<p class="ltx_p" id="S3.SS6.p4.1">The code is structured for development and experimentation, indicating ongoing adjustments and optimizations, such as tuning the physics-informed loss and expanding the model’s extrapolation capabilities. It’s a comprehensive approach to integrating machine learning with physical simulations, aiming to leverage the strengths of Transformers for spatial-temporal data. In this sense, this article is meant to offer a starting point for anybody wanting to explore the potential of Transformers in engineering physics and the associated code should be understood as work in progress. Even so, we have made an effort to debug and test thoroughly before sharing. The main focus of the discussion that follows is on explaining the structure of the Transformer model.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.7 </span>The Transformer Model Class</h3>
<div class="ltx_para" id="S3.SS7.p1">
<p class="ltx_p" id="S3.SS7.p1.1">We define a custom, physics-centric Transformer model class that is designed specifically to handle the 2D structure of the data. The actual code and associated model parameters are given in <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#A1" title="Appendix A The MLX Transformer Class ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS7.p2">
<p class="ltx_p" id="S3.SS7.p2.1">The Transformer uses spatial sinusoidal positional encodings and temporal sinusoidal positional encoding which are embedded in the latent dimension along with a thermal diffusivity embedding.
Given the specific nature of the heat conduction problem at hand, we opted to omit the decoder component of the Transformer architecture. While the traditional encoder-decoder framework is crucial for sequence-to-sequence tasks, such as those common in NLP, it offers no significant advantage in our case. Here, the goal is to predict the entire temperature evolution of a 2D plate from given boundary and initial conditions — tasks that are sufficiently handled by the self-attention mechanism of the encoder alone. Including the decoder would introduce unnecessary complexity, adding more layers and parameters without yielding meaningful improvements in accuracy or performance. We tested both configurations, and the decoder’s contribution was marginal. Therefore, to maintain an efficient model with a lean architecture suitable for personal machines, we opted for an encoder-only approach, which is fully capable of capturing the long-term spatial and temporal dependencies required to predict temperature distributions accurately. The exact sequence of events in the <span class="ltx_text" id="S3.SS7.p2.1.1" style="color:#A60059;">__call__</span> method is summarized in the diagram of figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.F15" title="Figure 15 ‣ 3.7 The Transformer Model Class ‣ 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">15</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS7.p3">
<p class="ltx_p" id="S3.SS7.p3.1">It is easier to handle the flow of information when the data is flattened in a 1D form. However, it is also easier to generate the spatial positional embeddings before the input data is flattened. Thus, it is worth stopping for a second to take a closer look at the sequence of operations. The spatial positional embeddings are generated and added before flattening the input data. Then the spatially-embedded data is flattened and projected to the latent dimension through a linear layer. Then the temporal positional and heat diffusivity embeddings<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>While the use of spatial and temporal embeddings aligns directly with standard practice in NLP, it is worth explaining the embedding of the heat diffusivity, which varies from case to case but has no spatial or temporal variation. Essentially, this represents a transformation that maps the diffusivity into a new representation space that the model can utilize alongside other embeddings.</span></span></span> are added to the latent dimension of the flattened data. The masked Transformer processes the data and returns its normalized prediction, which is then projected back to the original shape through another linear projection layer.</p>
</div>
<figure class="ltx_figure" id="S3.F15"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="405" id="S3.F15.g1" src="extracted/5903850/FIGURES/TRANSFORMER_DIAGRAM/PhyscisCentricTransformerFlowchart.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F15.2.1.1" style="font-size:90%;">Figure 15</span>: </span><span class="ltx_text" id="S3.F15.3.2" style="font-size:90%;">Custom physics-centric Transformer model (shown in block prediction mode.)</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS7.p4">
<p class="ltx_p" id="S3.SS7.p4.1">Furthermore, the Transformer is masked. This means that even though the model receives the entire ground truth sequence as input, it has access only to selected frames. The inclusion of the attention mask allows to operate in different predictive modes with minimal modifications. The intended predictive mode determines which input frames are visible to the model.
We differentiate between two alternative model uses and their respective trainings strategies, Block Predictions and Autoregressive Stepwise Predictions. In Block Prediction mode, the intention is to train the model to predict entire evolution histories. Given a small number of initial steps in the evolution of the temperature field, the model learns to output the entire history to steady state at once. The Block Prediction mode is a powerful approach for scenarios where you can define clear initial states and expect the model to generate coherent future sequences based on those states. This mode is particularly useful in initial value problems in fields like physics (those where initial conditions can significantly shape system evolution). Other possible uses include finance for predictive simulations based on observed trends, or even creative fields like music and art generation where an initial motif can inspire a complete piece, but those lie beyond our interest here.
In the Autoregressive Stepwise mode, the model is trained to predict the next frame in the evolution or at most a small number of forward frames (steps). In this scenario, the model could potentially be used to march a solution forward by sampling its own previous predictions. This mode aligns more directly with the standard uses of Transformers.
From a coding perspective, the challenge is to define a model class and training strategy that can accommodate both modes. Here, we leverage the Transformer’s attention mask to achieve both predictive modes. Thus in both cases the basic model architecture is largely the same, what differs is the attention mask used. Irrespective of the predictive mode, during training the Transformer receives batches of complete time evolution histories of the entire 2D temperature field. That is, the data passed to the model is contained in a tensor (MLX array) of the shape</p>
</div>
<div class="ltx_para ltx_noindent ltx_align_center" id="S3.SS7.1.p1">
<svg class="ltx_picture" height="69.74" id="S3.SS7.1.p1.pic1" overflow="visible" version="1.1" width="390"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,69.74) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 0 L 0 69.74 L 390 69.74 L 390 0 Z" style="stroke:none"></path></g><g fill="#F9F9F9" fill-opacity="1.0"><path d="M 0.39 0.39 L 0.39 69.35 L 389.6 69.35 L 389.6 0.39 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 35.83 27.95)"><foreignobject color="#000000" height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="318.34">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S3.SS7.1.p1.pic1.1.1.1.1.1" style="width:230.1pt;">
<span class="ltx_p" id="S3.SS7.1.p1.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="S3.SS7.1.p1.pic1.1.1.1.1.1.1.1">src[batch_size, seq_len, nx, ny]</span></span>
</span></foreignobject></g></g></svg>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS7.p5">
<p class="ltx_p" id="S3.SS7.p5.1">where <span class="ltx_text" id="S3.SS7.p5.1.1" style="color:#0000FF;">batch_size</span> is the number of datasets in each batch, <span class="ltx_text" id="S3.SS7.p5.1.2" style="color:#0000FF;">seq_len</span> is the number of time steps in the time evolution history, and (<span class="ltx_text" id="S3.SS7.p5.1.3" style="color:#0000FF;">nx</span>, <span class="ltx_text" id="S3.SS7.p5.1.4" style="color:#0000FF;">ny</span>) is the size of the discretization grid. Its predictions are returned in the same shape. Our Transformer model predicts the full
<math alttext="nx\times ny" class="ltx_Math" display="inline" id="S3.SS7.p5.1.m1.1"><semantics id="S3.SS7.p5.1.m1.1a"><mrow id="S3.SS7.p5.1.m1.1.1" xref="S3.SS7.p5.1.m1.1.1.cmml"><mrow id="S3.SS7.p5.1.m1.1.1.2" xref="S3.SS7.p5.1.m1.1.1.2.cmml"><mrow id="S3.SS7.p5.1.m1.1.1.2.2" xref="S3.SS7.p5.1.m1.1.1.2.2.cmml"><mi id="S3.SS7.p5.1.m1.1.1.2.2.2" xref="S3.SS7.p5.1.m1.1.1.2.2.2.cmml">n</mi><mo id="S3.SS7.p5.1.m1.1.1.2.2.1" xref="S3.SS7.p5.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.SS7.p5.1.m1.1.1.2.2.3" xref="S3.SS7.p5.1.m1.1.1.2.2.3.cmml">x</mi></mrow><mo id="S3.SS7.p5.1.m1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS7.p5.1.m1.1.1.2.1.cmml">×</mo><mi id="S3.SS7.p5.1.m1.1.1.2.3" xref="S3.SS7.p5.1.m1.1.1.2.3.cmml">n</mi></mrow><mo id="S3.SS7.p5.1.m1.1.1.1" xref="S3.SS7.p5.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p5.1.m1.1.1.3" xref="S3.SS7.p5.1.m1.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS7.p5.1.m1.1b"><apply id="S3.SS7.p5.1.m1.1.1.cmml" xref="S3.SS7.p5.1.m1.1.1"><times id="S3.SS7.p5.1.m1.1.1.1.cmml" xref="S3.SS7.p5.1.m1.1.1.1"></times><apply id="S3.SS7.p5.1.m1.1.1.2.cmml" xref="S3.SS7.p5.1.m1.1.1.2"><times id="S3.SS7.p5.1.m1.1.1.2.1.cmml" xref="S3.SS7.p5.1.m1.1.1.2.1"></times><apply id="S3.SS7.p5.1.m1.1.1.2.2.cmml" xref="S3.SS7.p5.1.m1.1.1.2.2"><times id="S3.SS7.p5.1.m1.1.1.2.2.1.cmml" xref="S3.SS7.p5.1.m1.1.1.2.2.1"></times><ci id="S3.SS7.p5.1.m1.1.1.2.2.2.cmml" xref="S3.SS7.p5.1.m1.1.1.2.2.2">𝑛</ci><ci id="S3.SS7.p5.1.m1.1.1.2.2.3.cmml" xref="S3.SS7.p5.1.m1.1.1.2.2.3">𝑥</ci></apply><ci id="S3.SS7.p5.1.m1.1.1.2.3.cmml" xref="S3.SS7.p5.1.m1.1.1.2.3">𝑛</ci></apply><ci id="S3.SS7.p5.1.m1.1.1.3.cmml" xref="S3.SS7.p5.1.m1.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p5.1.m1.1c">nx\times ny</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p5.1.m1.1d">italic_n italic_x × italic_n italic_y</annotation></semantics></math> spatial grid at each time step, with masking applied only along the temporal dimension. The entire spatial frame is predicted simultaneously for each time step, allowing the model to capture both spatial and temporal dependencies. While the temporal sequence is masked to ensure autoregressive or block prediction behavior, the spatial dimensions are processed jointly at each step.</p>
</div>
<div class="ltx_para" id="S3.SS7.p6">
<p class="ltx_p" id="S3.SS7.p6.1">In MLX, as in other machine learning frameworks, elements of the attentions mask that are set to a very large negative value (provided by MLX as <span class="ltx_text" id="S3.SS7.p6.1.1" style="color:#0000FF;">-inf</span>) hide the
corresponding input sequence elements from the Transformer. Where the mask is set to zero, the corresponding input sequence is unmasked.</p>
</div>
<div class="ltx_para" id="S3.SS7.p7">
<p class="ltx_p" id="S3.SS7.p7.2">In the case of the Block Prediction mode, the mask has all the columns set to <span class="ltx_text" id="S3.SS7.p7.2.1" style="color:#0000FF;">-inf</span> except for the first <math alttext="N\_input" class="ltx_Math" display="inline" id="S3.SS7.p7.1.m1.1"><semantics id="S3.SS7.p7.1.m1.1a"><mrow id="S3.SS7.p7.1.m1.1.1" xref="S3.SS7.p7.1.m1.1.1.cmml"><mi id="S3.SS7.p7.1.m1.1.1.2" xref="S3.SS7.p7.1.m1.1.1.2.cmml">N</mi><mo id="S3.SS7.p7.1.m1.1.1.1" xref="S3.SS7.p7.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.1.m1.1.1.3" mathvariant="normal" xref="S3.SS7.p7.1.m1.1.1.3.cmml">_</mi><mo id="S3.SS7.p7.1.m1.1.1.1a" xref="S3.SS7.p7.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.1.m1.1.1.4" xref="S3.SS7.p7.1.m1.1.1.4.cmml">i</mi><mo id="S3.SS7.p7.1.m1.1.1.1b" xref="S3.SS7.p7.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.1.m1.1.1.5" xref="S3.SS7.p7.1.m1.1.1.5.cmml">n</mi><mo id="S3.SS7.p7.1.m1.1.1.1c" xref="S3.SS7.p7.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.1.m1.1.1.6" xref="S3.SS7.p7.1.m1.1.1.6.cmml">p</mi><mo id="S3.SS7.p7.1.m1.1.1.1d" xref="S3.SS7.p7.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.1.m1.1.1.7" xref="S3.SS7.p7.1.m1.1.1.7.cmml">u</mi><mo id="S3.SS7.p7.1.m1.1.1.1e" xref="S3.SS7.p7.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.1.m1.1.1.8" xref="S3.SS7.p7.1.m1.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS7.p7.1.m1.1b"><apply id="S3.SS7.p7.1.m1.1.1.cmml" xref="S3.SS7.p7.1.m1.1.1"><times id="S3.SS7.p7.1.m1.1.1.1.cmml" xref="S3.SS7.p7.1.m1.1.1.1"></times><ci id="S3.SS7.p7.1.m1.1.1.2.cmml" xref="S3.SS7.p7.1.m1.1.1.2">𝑁</ci><ci id="S3.SS7.p7.1.m1.1.1.3.cmml" xref="S3.SS7.p7.1.m1.1.1.3">_</ci><ci id="S3.SS7.p7.1.m1.1.1.4.cmml" xref="S3.SS7.p7.1.m1.1.1.4">𝑖</ci><ci id="S3.SS7.p7.1.m1.1.1.5.cmml" xref="S3.SS7.p7.1.m1.1.1.5">𝑛</ci><ci id="S3.SS7.p7.1.m1.1.1.6.cmml" xref="S3.SS7.p7.1.m1.1.1.6">𝑝</ci><ci id="S3.SS7.p7.1.m1.1.1.7.cmml" xref="S3.SS7.p7.1.m1.1.1.7">𝑢</ci><ci id="S3.SS7.p7.1.m1.1.1.8.cmml" xref="S3.SS7.p7.1.m1.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p7.1.m1.1c">N\_input</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p7.1.m1.1d">italic_N _ italic_i italic_n italic_p italic_u italic_t</annotation></semantics></math> that are set to 0. These columns correspond to the <math alttext="N\_input" class="ltx_Math" display="inline" id="S3.SS7.p7.2.m2.1"><semantics id="S3.SS7.p7.2.m2.1a"><mrow id="S3.SS7.p7.2.m2.1.1" xref="S3.SS7.p7.2.m2.1.1.cmml"><mi id="S3.SS7.p7.2.m2.1.1.2" xref="S3.SS7.p7.2.m2.1.1.2.cmml">N</mi><mo id="S3.SS7.p7.2.m2.1.1.1" xref="S3.SS7.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.2.m2.1.1.3" mathvariant="normal" xref="S3.SS7.p7.2.m2.1.1.3.cmml">_</mi><mo id="S3.SS7.p7.2.m2.1.1.1a" xref="S3.SS7.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.2.m2.1.1.4" xref="S3.SS7.p7.2.m2.1.1.4.cmml">i</mi><mo id="S3.SS7.p7.2.m2.1.1.1b" xref="S3.SS7.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.2.m2.1.1.5" xref="S3.SS7.p7.2.m2.1.1.5.cmml">n</mi><mo id="S3.SS7.p7.2.m2.1.1.1c" xref="S3.SS7.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.2.m2.1.1.6" xref="S3.SS7.p7.2.m2.1.1.6.cmml">p</mi><mo id="S3.SS7.p7.2.m2.1.1.1d" xref="S3.SS7.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.2.m2.1.1.7" xref="S3.SS7.p7.2.m2.1.1.7.cmml">u</mi><mo id="S3.SS7.p7.2.m2.1.1.1e" xref="S3.SS7.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS7.p7.2.m2.1.1.8" xref="S3.SS7.p7.2.m2.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS7.p7.2.m2.1b"><apply id="S3.SS7.p7.2.m2.1.1.cmml" xref="S3.SS7.p7.2.m2.1.1"><times id="S3.SS7.p7.2.m2.1.1.1.cmml" xref="S3.SS7.p7.2.m2.1.1.1"></times><ci id="S3.SS7.p7.2.m2.1.1.2.cmml" xref="S3.SS7.p7.2.m2.1.1.2">𝑁</ci><ci id="S3.SS7.p7.2.m2.1.1.3.cmml" xref="S3.SS7.p7.2.m2.1.1.3">_</ci><ci id="S3.SS7.p7.2.m2.1.1.4.cmml" xref="S3.SS7.p7.2.m2.1.1.4">𝑖</ci><ci id="S3.SS7.p7.2.m2.1.1.5.cmml" xref="S3.SS7.p7.2.m2.1.1.5">𝑛</ci><ci id="S3.SS7.p7.2.m2.1.1.6.cmml" xref="S3.SS7.p7.2.m2.1.1.6">𝑝</ci><ci id="S3.SS7.p7.2.m2.1.1.7.cmml" xref="S3.SS7.p7.2.m2.1.1.7">𝑢</ci><ci id="S3.SS7.p7.2.m2.1.1.8.cmml" xref="S3.SS7.p7.2.m2.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p7.2.m2.1c">N\_input</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p7.2.m2.1d">italic_N _ italic_i italic_n italic_p italic_u italic_t</annotation></semantics></math> initial frames that are accessible to the model and used for the prediction of the entire subsequent sequence block. The code defining the Block attention mask is fairly simple (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.F16.sf1" title="In Figure 16 ‣ 3.7 The Transformer Model Class ‣ 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">16(a)</span></a>). To help visualize the Block attention mask, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.F16.sf2" title="In Figure 16 ‣ 3.7 The Transformer Model Class ‣ 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">16(b)</span></a> shows how it would look for the hypothetical scenario where <span class="ltx_text" id="S3.SS7.p7.2.2" style="color:#0000FF;">seq_len</span> = 10 and 5 unmasked initial frames are provided as input.</p>
</div>
<figure class="ltx_figure" id="S3.F16">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F16.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="285" id="S3.F16.sf1.g1" src="extracted/5903850/FIGURES/TRANSFORMER_DIAGRAM/BlockMaskCode.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F16.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F16.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="216" id="S3.F16.sf2.g1" src="extracted/5903850/FIGURES/TRANSFORMER_DIAGRAM/BlockMaskExample.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F16.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F16.3.1.1" style="font-size:90%;">Figure 16</span>: </span><span class="ltx_text" id="S3.F16.4.2" style="font-size:90%;">(a) MLX code for generating the block mask.; (b) Example of a block mask used in the Block Prediction mode, assuming <span class="ltx_text" id="S3.F16.4.2.1" style="color:#0000FF;">seq_len</span> = 10 and 5 unmasked initial frames.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F17">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F17.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="302" id="S3.F17.sf1.g1" src="extracted/5903850/FIGURES/TRANSFORMER_DIAGRAM/CausalMaskCode.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F17.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F17.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="222" id="S3.F17.sf2.g1" src="extracted/5903850/FIGURES/TRANSFORMER_DIAGRAM/CausalMaskExample.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F17.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F17.3.1.1" style="font-size:90%;">Figure 17</span>: </span><span class="ltx_text" id="S3.F17.4.2" style="font-size:90%;">(a) MLX code for generating the causal mask.; (b) Example of a causal mask used in the Autoregressive mode, assuming <span class="ltx_text" id="S3.F17.4.2.1" style="color:#0000FF;">seq_len</span> = 10 and 5 unmasked initial frames.</span></figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS7.p8">
<p class="ltx_p" id="S3.SS7.p8.1">Contrast this to the Triangular Causal Mask that is used in the case of Autoregressive Stepwise mode (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.F17.sf1" title="In Figure 17 ‣ 3.7 The Transformer Model Class ‣ 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">17(a)</span></a>). In this case, we again allow a few initial frames to be visible but then switch to a triangular causal mask that prevents the model from peeking into the future during training. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.F17.sf2" title="In Figure 17 ‣ 3.7 The Transformer Model Class ‣ 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">17(b)</span></a> depicts how the Causal attention mask for the Autoregressive mode would look like, again assuming the hypothetical scenario of <span class="ltx_text" id="S3.SS7.p8.1.1" style="color:#0000FF;">seq_len</span> = 10 with 5 unmasked initial frames provided as input.</p>
</div>
<div class="ltx_para" id="S3.SS7.p9">
<p class="ltx_p" id="S3.SS7.p9.1">Thus, in predicting any particular frame the model can access the initial five frames plus (if applicable) all frames up to but excluding the frame itself. You might wonder, if the mask’s diagonal should also be zero in the predictive (triangular) region, as that is often the case in the application of Transformers to LLM. However, here we eventually want to use the trained model to march the solution to steady state starting from a few known initial frames in the sequence. Allowing access to the frame being predicted during training would murk the true predictive capacity of the model.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.8 </span>Training, Validation and Testing Strategy</h3>
<div class="ltx_para" id="S3.SS8.p1">
<p class="ltx_p" id="S3.SS8.p1.1">The training and validation datasets are divided into batches. The same batch size is used both for training and validation. During training, for each field in a batch, the entire time history of the 2D temperature distribution is passed to the Transformer. Because the Transformer is masked it is only allowed to "see" (access) the frames specified by either the Block or Autoregressive Causal mask.
The training is done over a user-specified number of epochs. For each epoch, we compute a training and a validation loss. The loss has several components as already discussed in equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S3.E18" title="In 3.5 The physics-informed loss ‣ 3 Methods ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">18</span></a>).</p>
</div>
<div class="ltx_para" id="S3.SS8.p2">
<p class="ltx_p" id="S3.SS8.p2.1">The Transformer predictions and the associated losses are computed for all points and all times at once. Given sufficient memory to accommodate the problem size, the process is highly efficient, especially given the lazy evaluation of the compute graphs that MLX follows.</p>
</div>
<div class="ltx_para" id="S3.SS8.p3">
<p class="ltx_p" id="S3.SS8.p3.1">Assessing the true inference performance of the trained Transformer must be approached differently in the Block and Autoregressive Stepwise modes. In the case of Block predictions, the model learns to predict the entire sequence to steady state all at once. Thus, when the trained Block Prediction model is applied to the test field, the loss is computed as the MSE between the ground truth sequence and the model’s entire output sequence (in our case the MSE loss is augmented with physics-based losses as done during training). On the other hand, the application of the trained Autoregressive Stepwise model to the test field is more involved. The model is fed the entire ground truth sequence but the causal mask ensures strict sequential predictions. Then, we enter an iteration cycle, where the model prediction is repeatedly sampled to replace one more frame at a time in the model input, starting from the first frame after the unmasked initial frames (note: there could be a single or a handful of unmasked initial frames). Each modified input results in a new model prediction and this iteration is repeated till the entire ground truth input sequence is replaced with model predictions. In a sense, the model is used to march the solution forward without being aware of the future ground truth values beyond the frame that is being replaced at each iteration stage. In this case, the loss is computed as the MSE loss between the iteratively (autoregressively) generated sequence and the ground truth and not between the initial model output and the ground truth. This is a more demanding assessment of the model performance since the error can progressively accumulate as the solution is marched forward and more and more frames in the input sequence are replaced by predictions. With a poorly performing model, the solution could in fact diverge significantly from the ground truth.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Results for the Base Case (block prediction mode)</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.3">The model was trained for 100 epochs in batches of 4 with a training set of 8400 sets (70<math alttext="\%" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mo id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><csymbol cd="latexml" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">%</annotation></semantics></math>) and an in-line validation using 2400 sets (20<math alttext="\%" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mo id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><csymbol cd="latexml" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">%</annotation></semantics></math>). The completely hidden test set comprised of 1200 sets (10<math alttext="\%" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mo id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><csymbol cd="latexml" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">%</annotation></semantics></math>). The evolution of the training and validation loss are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F18" title="Figure 18 ‣ 4.1 Results for the Base Case (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">18</span></a>. An MLX learning rate scheduler was implemented and the learning rate transition points are marked by red vertical dashed lines. The schedule can be summarized as follows,</p>
</div>
<figure class="ltx_figure" id="S4.F18"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="374" id="S4.F18.g1" src="extracted/5903850/FIGURES/BASE_CASE_BLOCK/Training_validation_test_loss_base_block.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F18.2.1.1" style="font-size:90%;">Figure 18</span>: </span><span class="ltx_text" id="S4.F18.3.2" style="font-size:90%;">Evolution of the training and validation losses using a learning rate schedule for the block prediction mode. Learning rate transitions are marked with red dashed lines. </span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S4.E28">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="LR=\begin{cases}0,&amp;\text{epoch: }1,\text{ warmup},\\
1\mathrm{e}{-5},&amp;\text{epoch: }2,\text{ initial phase ramp-up},\\
1\mathrm{e}{-4},&amp;\text{epoch: }3,\text{initial phase ramp-up},\\
5\mathrm{e}{-4},&amp;\text{epoch: }4,\text{initial phase ramp-up},\\
1\mathrm{e}{-3},&amp;\text{epochs: }5\text{ to }30,\text{initial phase},\\
5\mathrm{e}{-4},&amp;\text{epochs: }31\text{ to }40,\text{ramp-down for physics-%
informed,}\\
1\mathrm{e}{-4},&amp;\text{epochs: }41\text{ to }100,\text{physics-informed loss %
dominated.}\\
\end{cases}" class="ltx_Math" display="block" id="S4.E28.m1.14"><semantics id="S4.E28.m1.14a"><mrow id="S4.E28.m1.14.15" xref="S4.E28.m1.14.15.cmml"><mrow id="S4.E28.m1.14.15.2" xref="S4.E28.m1.14.15.2.cmml"><mi id="S4.E28.m1.14.15.2.2" xref="S4.E28.m1.14.15.2.2.cmml">L</mi><mo id="S4.E28.m1.14.15.2.1" xref="S4.E28.m1.14.15.2.1.cmml">⁢</mo><mi id="S4.E28.m1.14.15.2.3" xref="S4.E28.m1.14.15.2.3.cmml">R</mi></mrow><mo id="S4.E28.m1.14.15.1" xref="S4.E28.m1.14.15.1.cmml">=</mo><mrow id="S4.E28.m1.14.14" xref="S4.E28.m1.14.15.3.1.cmml"><mo id="S4.E28.m1.14.14.15" xref="S4.E28.m1.14.15.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E28.m1.14.14.14" rowspacing="0pt" xref="S4.E28.m1.14.15.3.1.cmml"><mtr id="S4.E28.m1.14.14.14a" xref="S4.E28.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14b" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.1.1.1.1.1.1.3" xref="S4.E28.m1.14.15.3.1.cmml"><mn id="S4.E28.m1.1.1.1.1.1.1.1" xref="S4.E28.m1.1.1.1.1.1.1.1.cmml">0</mn><mo id="S4.E28.m1.1.1.1.1.1.1.3.1" xref="S4.E28.m1.14.15.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14c" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.2.2.2.2.2.1.2" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.2.2.2.2.2.1.2.1.1" xref="S4.E28.m1.2.2.2.2.2.1.2.1.2.cmml"><mrow id="S4.E28.m1.2.2.2.2.2.1.2.1.1.1" xref="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.cmml"><mtext id="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.2" xref="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.2a.cmml">epoch: </mtext><mo id="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.1" xref="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.1.cmml">⁢</mo><mn id="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.3" xref="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E28.m1.2.2.2.2.2.1.2.1.1.2" xref="S4.E28.m1.2.2.2.2.2.1.2.1.2.cmml">,</mo><mtext id="S4.E28.m1.2.2.2.2.2.1.1" xref="S4.E28.m1.2.2.2.2.2.1.1a.cmml"> warmup</mtext></mrow><mo id="S4.E28.m1.2.2.2.2.2.1.2.2" xref="S4.E28.m1.14.15.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E28.m1.14.14.14d" xref="S4.E28.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14e" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.3.3.3.3.1.1.1" xref="S4.E28.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="S4.E28.m1.3.3.3.3.1.1.1.1" xref="S4.E28.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="S4.E28.m1.3.3.3.3.1.1.1.1.2" xref="S4.E28.m1.3.3.3.3.1.1.1.1.2.cmml"><mn id="S4.E28.m1.3.3.3.3.1.1.1.1.2.2" xref="S4.E28.m1.3.3.3.3.1.1.1.1.2.2.cmml">1</mn><mo id="S4.E28.m1.3.3.3.3.1.1.1.1.2.1" xref="S4.E28.m1.3.3.3.3.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E28.m1.3.3.3.3.1.1.1.1.2.3" mathvariant="normal" xref="S4.E28.m1.3.3.3.3.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E28.m1.3.3.3.3.1.1.1.1.1" xref="S4.E28.m1.3.3.3.3.1.1.1.1.1.cmml">−</mo><mn id="S4.E28.m1.3.3.3.3.1.1.1.1.3" xref="S4.E28.m1.3.3.3.3.1.1.1.1.3.cmml">5</mn></mrow><mo id="S4.E28.m1.3.3.3.3.1.1.1.2" xref="S4.E28.m1.3.3.3.3.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14f" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.4.4.4.4.2.1.2" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.4.4.4.4.2.1.2.1.1" xref="S4.E28.m1.4.4.4.4.2.1.2.1.2.cmml"><mrow id="S4.E28.m1.4.4.4.4.2.1.2.1.1.1" xref="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.cmml"><mtext id="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.2" xref="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.2a.cmml">epoch: </mtext><mo id="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.1" xref="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.1.cmml">⁢</mo><mn id="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.3" xref="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.3.cmml">2</mn></mrow><mo id="S4.E28.m1.4.4.4.4.2.1.2.1.1.2" xref="S4.E28.m1.4.4.4.4.2.1.2.1.2.cmml">,</mo><mtext id="S4.E28.m1.4.4.4.4.2.1.1" xref="S4.E28.m1.4.4.4.4.2.1.1a.cmml"> initial phase ramp-up</mtext></mrow><mo id="S4.E28.m1.4.4.4.4.2.1.2.2" xref="S4.E28.m1.14.15.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E28.m1.14.14.14g" xref="S4.E28.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14h" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.5.5.5.5.1.1.1" xref="S4.E28.m1.5.5.5.5.1.1.1.1.cmml"><mrow id="S4.E28.m1.5.5.5.5.1.1.1.1" xref="S4.E28.m1.5.5.5.5.1.1.1.1.cmml"><mrow id="S4.E28.m1.5.5.5.5.1.1.1.1.2" xref="S4.E28.m1.5.5.5.5.1.1.1.1.2.cmml"><mn id="S4.E28.m1.5.5.5.5.1.1.1.1.2.2" xref="S4.E28.m1.5.5.5.5.1.1.1.1.2.2.cmml">1</mn><mo id="S4.E28.m1.5.5.5.5.1.1.1.1.2.1" xref="S4.E28.m1.5.5.5.5.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E28.m1.5.5.5.5.1.1.1.1.2.3" mathvariant="normal" xref="S4.E28.m1.5.5.5.5.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E28.m1.5.5.5.5.1.1.1.1.1" xref="S4.E28.m1.5.5.5.5.1.1.1.1.1.cmml">−</mo><mn id="S4.E28.m1.5.5.5.5.1.1.1.1.3" xref="S4.E28.m1.5.5.5.5.1.1.1.1.3.cmml">4</mn></mrow><mo id="S4.E28.m1.5.5.5.5.1.1.1.2" xref="S4.E28.m1.5.5.5.5.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14i" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.6.6.6.6.2.1.2" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.6.6.6.6.2.1.2.1.1" xref="S4.E28.m1.6.6.6.6.2.1.2.1.2.cmml"><mrow id="S4.E28.m1.6.6.6.6.2.1.2.1.1.1" xref="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.cmml"><mtext id="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.2" xref="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.2a.cmml">epoch: </mtext><mo id="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.1" xref="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.1.cmml">⁢</mo><mn id="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.3" xref="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.3.cmml">3</mn></mrow><mo id="S4.E28.m1.6.6.6.6.2.1.2.1.1.2" xref="S4.E28.m1.6.6.6.6.2.1.2.1.2.cmml">,</mo><mtext id="S4.E28.m1.6.6.6.6.2.1.1" xref="S4.E28.m1.6.6.6.6.2.1.1a.cmml">initial phase ramp-up</mtext></mrow><mo id="S4.E28.m1.6.6.6.6.2.1.2.2" xref="S4.E28.m1.14.15.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E28.m1.14.14.14j" xref="S4.E28.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14k" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.7.7.7.7.1.1.1" xref="S4.E28.m1.7.7.7.7.1.1.1.1.cmml"><mrow id="S4.E28.m1.7.7.7.7.1.1.1.1" xref="S4.E28.m1.7.7.7.7.1.1.1.1.cmml"><mrow id="S4.E28.m1.7.7.7.7.1.1.1.1.2" xref="S4.E28.m1.7.7.7.7.1.1.1.1.2.cmml"><mn id="S4.E28.m1.7.7.7.7.1.1.1.1.2.2" xref="S4.E28.m1.7.7.7.7.1.1.1.1.2.2.cmml">5</mn><mo id="S4.E28.m1.7.7.7.7.1.1.1.1.2.1" xref="S4.E28.m1.7.7.7.7.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E28.m1.7.7.7.7.1.1.1.1.2.3" mathvariant="normal" xref="S4.E28.m1.7.7.7.7.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E28.m1.7.7.7.7.1.1.1.1.1" xref="S4.E28.m1.7.7.7.7.1.1.1.1.1.cmml">−</mo><mn id="S4.E28.m1.7.7.7.7.1.1.1.1.3" xref="S4.E28.m1.7.7.7.7.1.1.1.1.3.cmml">4</mn></mrow><mo id="S4.E28.m1.7.7.7.7.1.1.1.2" xref="S4.E28.m1.7.7.7.7.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14l" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.8.8.8.8.2.1.2" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.8.8.8.8.2.1.2.1.1" xref="S4.E28.m1.8.8.8.8.2.1.2.1.2.cmml"><mrow id="S4.E28.m1.8.8.8.8.2.1.2.1.1.1" xref="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.cmml"><mtext id="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.2" xref="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.2a.cmml">epoch: </mtext><mo id="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.1" xref="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.1.cmml">⁢</mo><mn id="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.3" xref="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.3.cmml">4</mn></mrow><mo id="S4.E28.m1.8.8.8.8.2.1.2.1.1.2" xref="S4.E28.m1.8.8.8.8.2.1.2.1.2.cmml">,</mo><mtext id="S4.E28.m1.8.8.8.8.2.1.1" xref="S4.E28.m1.8.8.8.8.2.1.1a.cmml">initial phase ramp-up</mtext></mrow><mo id="S4.E28.m1.8.8.8.8.2.1.2.2" xref="S4.E28.m1.14.15.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E28.m1.14.14.14m" xref="S4.E28.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14n" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.9.9.9.9.1.1.1" xref="S4.E28.m1.9.9.9.9.1.1.1.1.cmml"><mrow id="S4.E28.m1.9.9.9.9.1.1.1.1" xref="S4.E28.m1.9.9.9.9.1.1.1.1.cmml"><mrow id="S4.E28.m1.9.9.9.9.1.1.1.1.2" xref="S4.E28.m1.9.9.9.9.1.1.1.1.2.cmml"><mn id="S4.E28.m1.9.9.9.9.1.1.1.1.2.2" xref="S4.E28.m1.9.9.9.9.1.1.1.1.2.2.cmml">1</mn><mo id="S4.E28.m1.9.9.9.9.1.1.1.1.2.1" xref="S4.E28.m1.9.9.9.9.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E28.m1.9.9.9.9.1.1.1.1.2.3" mathvariant="normal" xref="S4.E28.m1.9.9.9.9.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E28.m1.9.9.9.9.1.1.1.1.1" xref="S4.E28.m1.9.9.9.9.1.1.1.1.1.cmml">−</mo><mn id="S4.E28.m1.9.9.9.9.1.1.1.1.3" xref="S4.E28.m1.9.9.9.9.1.1.1.1.3.cmml">3</mn></mrow><mo id="S4.E28.m1.9.9.9.9.1.1.1.2" xref="S4.E28.m1.9.9.9.9.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14o" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.10.10.10.10.2.1.2" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.10.10.10.10.2.1.2.1.1" xref="S4.E28.m1.10.10.10.10.2.1.2.1.2.cmml"><mrow id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.cmml"><mtext id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.2" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.2a.cmml">epochs: </mtext><mo id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.1" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.1.cmml">⁢</mo><mn id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.3" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.3.cmml">5</mn><mo id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.1a" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.1.cmml">⁢</mo><mtext id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.4" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.4a.cmml"> to </mtext><mo id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.1b" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.1.cmml">⁢</mo><mn id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.5" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.5.cmml">30</mn></mrow><mo id="S4.E28.m1.10.10.10.10.2.1.2.1.1.2" xref="S4.E28.m1.10.10.10.10.2.1.2.1.2.cmml">,</mo><mtext id="S4.E28.m1.10.10.10.10.2.1.1" xref="S4.E28.m1.10.10.10.10.2.1.1a.cmml">initial phase</mtext></mrow><mo id="S4.E28.m1.10.10.10.10.2.1.2.2" xref="S4.E28.m1.14.15.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E28.m1.14.14.14p" xref="S4.E28.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14q" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.11.11.11.11.1.1.1" xref="S4.E28.m1.11.11.11.11.1.1.1.1.cmml"><mrow id="S4.E28.m1.11.11.11.11.1.1.1.1" xref="S4.E28.m1.11.11.11.11.1.1.1.1.cmml"><mrow id="S4.E28.m1.11.11.11.11.1.1.1.1.2" xref="S4.E28.m1.11.11.11.11.1.1.1.1.2.cmml"><mn id="S4.E28.m1.11.11.11.11.1.1.1.1.2.2" xref="S4.E28.m1.11.11.11.11.1.1.1.1.2.2.cmml">5</mn><mo id="S4.E28.m1.11.11.11.11.1.1.1.1.2.1" xref="S4.E28.m1.11.11.11.11.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E28.m1.11.11.11.11.1.1.1.1.2.3" mathvariant="normal" xref="S4.E28.m1.11.11.11.11.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E28.m1.11.11.11.11.1.1.1.1.1" xref="S4.E28.m1.11.11.11.11.1.1.1.1.1.cmml">−</mo><mn id="S4.E28.m1.11.11.11.11.1.1.1.1.3" xref="S4.E28.m1.11.11.11.11.1.1.1.1.3.cmml">4</mn></mrow><mo id="S4.E28.m1.11.11.11.11.1.1.1.2" xref="S4.E28.m1.11.11.11.11.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14r" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.12.12.12.12.2.1.2" xref="S4.E28.m1.12.12.12.12.2.1.3.cmml"><mrow id="S4.E28.m1.12.12.12.12.2.1.2.1" xref="S4.E28.m1.12.12.12.12.2.1.2.1.cmml"><mtext id="S4.E28.m1.12.12.12.12.2.1.2.1.2" xref="S4.E28.m1.12.12.12.12.2.1.2.1.2a.cmml">epochs: </mtext><mo id="S4.E28.m1.12.12.12.12.2.1.2.1.1" xref="S4.E28.m1.12.12.12.12.2.1.2.1.1.cmml">⁢</mo><mn id="S4.E28.m1.12.12.12.12.2.1.2.1.3" xref="S4.E28.m1.12.12.12.12.2.1.2.1.3.cmml">31</mn><mo id="S4.E28.m1.12.12.12.12.2.1.2.1.1a" xref="S4.E28.m1.12.12.12.12.2.1.2.1.1.cmml">⁢</mo><mtext id="S4.E28.m1.12.12.12.12.2.1.2.1.4" xref="S4.E28.m1.12.12.12.12.2.1.2.1.4a.cmml"> to </mtext><mo id="S4.E28.m1.12.12.12.12.2.1.2.1.1b" xref="S4.E28.m1.12.12.12.12.2.1.2.1.1.cmml">⁢</mo><mn id="S4.E28.m1.12.12.12.12.2.1.2.1.5" xref="S4.E28.m1.12.12.12.12.2.1.2.1.5.cmml">40</mn></mrow><mo id="S4.E28.m1.12.12.12.12.2.1.2.2" xref="S4.E28.m1.12.12.12.12.2.1.3.cmml">,</mo><mtext id="S4.E28.m1.12.12.12.12.2.1.1" xref="S4.E28.m1.12.12.12.12.2.1.1a.cmml">ramp-down for physics-informed,</mtext></mrow></mtd></mtr><mtr id="S4.E28.m1.14.14.14s" xref="S4.E28.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14t" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.13.13.13.13.1.1.1" xref="S4.E28.m1.13.13.13.13.1.1.1.1.cmml"><mrow id="S4.E28.m1.13.13.13.13.1.1.1.1" xref="S4.E28.m1.13.13.13.13.1.1.1.1.cmml"><mrow id="S4.E28.m1.13.13.13.13.1.1.1.1.2" xref="S4.E28.m1.13.13.13.13.1.1.1.1.2.cmml"><mn id="S4.E28.m1.13.13.13.13.1.1.1.1.2.2" xref="S4.E28.m1.13.13.13.13.1.1.1.1.2.2.cmml">1</mn><mo id="S4.E28.m1.13.13.13.13.1.1.1.1.2.1" xref="S4.E28.m1.13.13.13.13.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E28.m1.13.13.13.13.1.1.1.1.2.3" mathvariant="normal" xref="S4.E28.m1.13.13.13.13.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E28.m1.13.13.13.13.1.1.1.1.1" xref="S4.E28.m1.13.13.13.13.1.1.1.1.1.cmml">−</mo><mn id="S4.E28.m1.13.13.13.13.1.1.1.1.3" xref="S4.E28.m1.13.13.13.13.1.1.1.1.3.cmml">4</mn></mrow><mo id="S4.E28.m1.13.13.13.13.1.1.1.2" xref="S4.E28.m1.13.13.13.13.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.14.14.14u" xref="S4.E28.m1.14.15.3.1.cmml"><mrow id="S4.E28.m1.14.14.14.14.2.1.2" xref="S4.E28.m1.14.14.14.14.2.1.3.cmml"><mrow id="S4.E28.m1.14.14.14.14.2.1.2.1" xref="S4.E28.m1.14.14.14.14.2.1.2.1.cmml"><mtext id="S4.E28.m1.14.14.14.14.2.1.2.1.2" xref="S4.E28.m1.14.14.14.14.2.1.2.1.2a.cmml">epochs: </mtext><mo id="S4.E28.m1.14.14.14.14.2.1.2.1.1" xref="S4.E28.m1.14.14.14.14.2.1.2.1.1.cmml">⁢</mo><mn id="S4.E28.m1.14.14.14.14.2.1.2.1.3" xref="S4.E28.m1.14.14.14.14.2.1.2.1.3.cmml">41</mn><mo id="S4.E28.m1.14.14.14.14.2.1.2.1.1a" xref="S4.E28.m1.14.14.14.14.2.1.2.1.1.cmml">⁢</mo><mtext id="S4.E28.m1.14.14.14.14.2.1.2.1.4" xref="S4.E28.m1.14.14.14.14.2.1.2.1.4a.cmml"> to </mtext><mo id="S4.E28.m1.14.14.14.14.2.1.2.1.1b" xref="S4.E28.m1.14.14.14.14.2.1.2.1.1.cmml">⁢</mo><mn id="S4.E28.m1.14.14.14.14.2.1.2.1.5" xref="S4.E28.m1.14.14.14.14.2.1.2.1.5.cmml">100</mn></mrow><mo id="S4.E28.m1.14.14.14.14.2.1.2.2" xref="S4.E28.m1.14.14.14.14.2.1.3.cmml">,</mo><mtext id="S4.E28.m1.14.14.14.14.2.1.1" xref="S4.E28.m1.14.14.14.14.2.1.1a.cmml">physics-informed loss dominated.</mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E28.m1.14b"><apply id="S4.E28.m1.14.15.cmml" xref="S4.E28.m1.14.15"><eq id="S4.E28.m1.14.15.1.cmml" xref="S4.E28.m1.14.15.1"></eq><apply id="S4.E28.m1.14.15.2.cmml" xref="S4.E28.m1.14.15.2"><times id="S4.E28.m1.14.15.2.1.cmml" xref="S4.E28.m1.14.15.2.1"></times><ci id="S4.E28.m1.14.15.2.2.cmml" xref="S4.E28.m1.14.15.2.2">𝐿</ci><ci id="S4.E28.m1.14.15.2.3.cmml" xref="S4.E28.m1.14.15.2.3">𝑅</ci></apply><apply id="S4.E28.m1.14.15.3.1.cmml" xref="S4.E28.m1.14.14"><csymbol cd="latexml" id="S4.E28.m1.14.15.3.1.1.cmml" xref="S4.E28.m1.14.14.15">cases</csymbol><cn id="S4.E28.m1.1.1.1.1.1.1.1.cmml" type="integer" xref="S4.E28.m1.1.1.1.1.1.1.1">0</cn><list id="S4.E28.m1.2.2.2.2.2.1.2.1.2.cmml" xref="S4.E28.m1.2.2.2.2.2.1.2.1.1"><apply id="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.cmml" xref="S4.E28.m1.2.2.2.2.2.1.2.1.1.1"><times id="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.1.cmml" xref="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.1"></times><ci id="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.2a.cmml" xref="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.2"><mtext id="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.2.cmml" xref="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.2">epoch: </mtext></ci><cn id="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.2.2.2.2.2.1.2.1.1.1.3">1</cn></apply><ci id="S4.E28.m1.2.2.2.2.2.1.1a.cmml" xref="S4.E28.m1.2.2.2.2.2.1.1"><mtext id="S4.E28.m1.2.2.2.2.2.1.1.cmml" xref="S4.E28.m1.2.2.2.2.2.1.1"> warmup</mtext></ci></list><apply id="S4.E28.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E28.m1.3.3.3.3.1.1.1"><minus id="S4.E28.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E28.m1.3.3.3.3.1.1.1.1.1"></minus><apply id="S4.E28.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S4.E28.m1.3.3.3.3.1.1.1.1.2"><times id="S4.E28.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S4.E28.m1.3.3.3.3.1.1.1.1.2.1"></times><cn id="S4.E28.m1.3.3.3.3.1.1.1.1.2.2.cmml" type="integer" xref="S4.E28.m1.3.3.3.3.1.1.1.1.2.2">1</cn><ci id="S4.E28.m1.3.3.3.3.1.1.1.1.2.3.cmml" xref="S4.E28.m1.3.3.3.3.1.1.1.1.2.3">e</ci></apply><cn id="S4.E28.m1.3.3.3.3.1.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.3.3.3.3.1.1.1.1.3">5</cn></apply><list id="S4.E28.m1.4.4.4.4.2.1.2.1.2.cmml" xref="S4.E28.m1.4.4.4.4.2.1.2.1.1"><apply id="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.cmml" xref="S4.E28.m1.4.4.4.4.2.1.2.1.1.1"><times id="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.1.cmml" xref="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.1"></times><ci id="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.2a.cmml" xref="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.2"><mtext id="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.2.cmml" xref="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.2">epoch: </mtext></ci><cn id="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.4.4.4.4.2.1.2.1.1.1.3">2</cn></apply><ci id="S4.E28.m1.4.4.4.4.2.1.1a.cmml" xref="S4.E28.m1.4.4.4.4.2.1.1"><mtext id="S4.E28.m1.4.4.4.4.2.1.1.cmml" xref="S4.E28.m1.4.4.4.4.2.1.1"> initial phase ramp-up</mtext></ci></list><apply id="S4.E28.m1.5.5.5.5.1.1.1.1.cmml" xref="S4.E28.m1.5.5.5.5.1.1.1"><minus id="S4.E28.m1.5.5.5.5.1.1.1.1.1.cmml" xref="S4.E28.m1.5.5.5.5.1.1.1.1.1"></minus><apply id="S4.E28.m1.5.5.5.5.1.1.1.1.2.cmml" xref="S4.E28.m1.5.5.5.5.1.1.1.1.2"><times id="S4.E28.m1.5.5.5.5.1.1.1.1.2.1.cmml" xref="S4.E28.m1.5.5.5.5.1.1.1.1.2.1"></times><cn id="S4.E28.m1.5.5.5.5.1.1.1.1.2.2.cmml" type="integer" xref="S4.E28.m1.5.5.5.5.1.1.1.1.2.2">1</cn><ci id="S4.E28.m1.5.5.5.5.1.1.1.1.2.3.cmml" xref="S4.E28.m1.5.5.5.5.1.1.1.1.2.3">e</ci></apply><cn id="S4.E28.m1.5.5.5.5.1.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.5.5.5.5.1.1.1.1.3">4</cn></apply><list id="S4.E28.m1.6.6.6.6.2.1.2.1.2.cmml" xref="S4.E28.m1.6.6.6.6.2.1.2.1.1"><apply id="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.cmml" xref="S4.E28.m1.6.6.6.6.2.1.2.1.1.1"><times id="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.1.cmml" xref="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.1"></times><ci id="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.2a.cmml" xref="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.2"><mtext id="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.2.cmml" xref="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.2">epoch: </mtext></ci><cn id="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.6.6.6.6.2.1.2.1.1.1.3">3</cn></apply><ci id="S4.E28.m1.6.6.6.6.2.1.1a.cmml" xref="S4.E28.m1.6.6.6.6.2.1.1"><mtext id="S4.E28.m1.6.6.6.6.2.1.1.cmml" xref="S4.E28.m1.6.6.6.6.2.1.1">initial phase ramp-up</mtext></ci></list><apply id="S4.E28.m1.7.7.7.7.1.1.1.1.cmml" xref="S4.E28.m1.7.7.7.7.1.1.1"><minus id="S4.E28.m1.7.7.7.7.1.1.1.1.1.cmml" xref="S4.E28.m1.7.7.7.7.1.1.1.1.1"></minus><apply id="S4.E28.m1.7.7.7.7.1.1.1.1.2.cmml" xref="S4.E28.m1.7.7.7.7.1.1.1.1.2"><times id="S4.E28.m1.7.7.7.7.1.1.1.1.2.1.cmml" xref="S4.E28.m1.7.7.7.7.1.1.1.1.2.1"></times><cn id="S4.E28.m1.7.7.7.7.1.1.1.1.2.2.cmml" type="integer" xref="S4.E28.m1.7.7.7.7.1.1.1.1.2.2">5</cn><ci id="S4.E28.m1.7.7.7.7.1.1.1.1.2.3.cmml" xref="S4.E28.m1.7.7.7.7.1.1.1.1.2.3">e</ci></apply><cn id="S4.E28.m1.7.7.7.7.1.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.7.7.7.7.1.1.1.1.3">4</cn></apply><list id="S4.E28.m1.8.8.8.8.2.1.2.1.2.cmml" xref="S4.E28.m1.8.8.8.8.2.1.2.1.1"><apply id="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.cmml" xref="S4.E28.m1.8.8.8.8.2.1.2.1.1.1"><times id="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.1.cmml" xref="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.1"></times><ci id="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.2a.cmml" xref="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.2"><mtext id="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.2.cmml" xref="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.2">epoch: </mtext></ci><cn id="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.8.8.8.8.2.1.2.1.1.1.3">4</cn></apply><ci id="S4.E28.m1.8.8.8.8.2.1.1a.cmml" xref="S4.E28.m1.8.8.8.8.2.1.1"><mtext id="S4.E28.m1.8.8.8.8.2.1.1.cmml" xref="S4.E28.m1.8.8.8.8.2.1.1">initial phase ramp-up</mtext></ci></list><apply id="S4.E28.m1.9.9.9.9.1.1.1.1.cmml" xref="S4.E28.m1.9.9.9.9.1.1.1"><minus id="S4.E28.m1.9.9.9.9.1.1.1.1.1.cmml" xref="S4.E28.m1.9.9.9.9.1.1.1.1.1"></minus><apply id="S4.E28.m1.9.9.9.9.1.1.1.1.2.cmml" xref="S4.E28.m1.9.9.9.9.1.1.1.1.2"><times id="S4.E28.m1.9.9.9.9.1.1.1.1.2.1.cmml" xref="S4.E28.m1.9.9.9.9.1.1.1.1.2.1"></times><cn id="S4.E28.m1.9.9.9.9.1.1.1.1.2.2.cmml" type="integer" xref="S4.E28.m1.9.9.9.9.1.1.1.1.2.2">1</cn><ci id="S4.E28.m1.9.9.9.9.1.1.1.1.2.3.cmml" xref="S4.E28.m1.9.9.9.9.1.1.1.1.2.3">e</ci></apply><cn id="S4.E28.m1.9.9.9.9.1.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.9.9.9.9.1.1.1.1.3">3</cn></apply><list id="S4.E28.m1.10.10.10.10.2.1.2.1.2.cmml" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1"><apply id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.cmml" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1"><times id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.1.cmml" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.1"></times><ci id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.2a.cmml" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.2"><mtext id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.2.cmml" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.2">epochs: </mtext></ci><cn id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.3">5</cn><ci id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.4a.cmml" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.4"><mtext id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.4.cmml" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.4"> to </mtext></ci><cn id="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.5.cmml" type="integer" xref="S4.E28.m1.10.10.10.10.2.1.2.1.1.1.5">30</cn></apply><ci id="S4.E28.m1.10.10.10.10.2.1.1a.cmml" xref="S4.E28.m1.10.10.10.10.2.1.1"><mtext id="S4.E28.m1.10.10.10.10.2.1.1.cmml" xref="S4.E28.m1.10.10.10.10.2.1.1">initial phase</mtext></ci></list><apply id="S4.E28.m1.11.11.11.11.1.1.1.1.cmml" xref="S4.E28.m1.11.11.11.11.1.1.1"><minus id="S4.E28.m1.11.11.11.11.1.1.1.1.1.cmml" xref="S4.E28.m1.11.11.11.11.1.1.1.1.1"></minus><apply id="S4.E28.m1.11.11.11.11.1.1.1.1.2.cmml" xref="S4.E28.m1.11.11.11.11.1.1.1.1.2"><times id="S4.E28.m1.11.11.11.11.1.1.1.1.2.1.cmml" xref="S4.E28.m1.11.11.11.11.1.1.1.1.2.1"></times><cn id="S4.E28.m1.11.11.11.11.1.1.1.1.2.2.cmml" type="integer" xref="S4.E28.m1.11.11.11.11.1.1.1.1.2.2">5</cn><ci id="S4.E28.m1.11.11.11.11.1.1.1.1.2.3.cmml" xref="S4.E28.m1.11.11.11.11.1.1.1.1.2.3">e</ci></apply><cn id="S4.E28.m1.11.11.11.11.1.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.11.11.11.11.1.1.1.1.3">4</cn></apply><list id="S4.E28.m1.12.12.12.12.2.1.3.cmml" xref="S4.E28.m1.12.12.12.12.2.1.2"><apply id="S4.E28.m1.12.12.12.12.2.1.2.1.cmml" xref="S4.E28.m1.12.12.12.12.2.1.2.1"><times id="S4.E28.m1.12.12.12.12.2.1.2.1.1.cmml" xref="S4.E28.m1.12.12.12.12.2.1.2.1.1"></times><ci id="S4.E28.m1.12.12.12.12.2.1.2.1.2a.cmml" xref="S4.E28.m1.12.12.12.12.2.1.2.1.2"><mtext id="S4.E28.m1.12.12.12.12.2.1.2.1.2.cmml" xref="S4.E28.m1.12.12.12.12.2.1.2.1.2">epochs: </mtext></ci><cn id="S4.E28.m1.12.12.12.12.2.1.2.1.3.cmml" type="integer" xref="S4.E28.m1.12.12.12.12.2.1.2.1.3">31</cn><ci id="S4.E28.m1.12.12.12.12.2.1.2.1.4a.cmml" xref="S4.E28.m1.12.12.12.12.2.1.2.1.4"><mtext id="S4.E28.m1.12.12.12.12.2.1.2.1.4.cmml" xref="S4.E28.m1.12.12.12.12.2.1.2.1.4"> to </mtext></ci><cn id="S4.E28.m1.12.12.12.12.2.1.2.1.5.cmml" type="integer" xref="S4.E28.m1.12.12.12.12.2.1.2.1.5">40</cn></apply><ci id="S4.E28.m1.12.12.12.12.2.1.1a.cmml" xref="S4.E28.m1.12.12.12.12.2.1.1"><mtext id="S4.E28.m1.12.12.12.12.2.1.1.cmml" xref="S4.E28.m1.12.12.12.12.2.1.1">ramp-down for physics-informed,</mtext></ci></list><apply id="S4.E28.m1.13.13.13.13.1.1.1.1.cmml" xref="S4.E28.m1.13.13.13.13.1.1.1"><minus id="S4.E28.m1.13.13.13.13.1.1.1.1.1.cmml" xref="S4.E28.m1.13.13.13.13.1.1.1.1.1"></minus><apply id="S4.E28.m1.13.13.13.13.1.1.1.1.2.cmml" xref="S4.E28.m1.13.13.13.13.1.1.1.1.2"><times id="S4.E28.m1.13.13.13.13.1.1.1.1.2.1.cmml" xref="S4.E28.m1.13.13.13.13.1.1.1.1.2.1"></times><cn id="S4.E28.m1.13.13.13.13.1.1.1.1.2.2.cmml" type="integer" xref="S4.E28.m1.13.13.13.13.1.1.1.1.2.2">1</cn><ci id="S4.E28.m1.13.13.13.13.1.1.1.1.2.3.cmml" xref="S4.E28.m1.13.13.13.13.1.1.1.1.2.3">e</ci></apply><cn id="S4.E28.m1.13.13.13.13.1.1.1.1.3.cmml" type="integer" xref="S4.E28.m1.13.13.13.13.1.1.1.1.3">4</cn></apply><list id="S4.E28.m1.14.14.14.14.2.1.3.cmml" xref="S4.E28.m1.14.14.14.14.2.1.2"><apply id="S4.E28.m1.14.14.14.14.2.1.2.1.cmml" xref="S4.E28.m1.14.14.14.14.2.1.2.1"><times id="S4.E28.m1.14.14.14.14.2.1.2.1.1.cmml" xref="S4.E28.m1.14.14.14.14.2.1.2.1.1"></times><ci id="S4.E28.m1.14.14.14.14.2.1.2.1.2a.cmml" xref="S4.E28.m1.14.14.14.14.2.1.2.1.2"><mtext id="S4.E28.m1.14.14.14.14.2.1.2.1.2.cmml" xref="S4.E28.m1.14.14.14.14.2.1.2.1.2">epochs: </mtext></ci><cn id="S4.E28.m1.14.14.14.14.2.1.2.1.3.cmml" type="integer" xref="S4.E28.m1.14.14.14.14.2.1.2.1.3">41</cn><ci id="S4.E28.m1.14.14.14.14.2.1.2.1.4a.cmml" xref="S4.E28.m1.14.14.14.14.2.1.2.1.4"><mtext id="S4.E28.m1.14.14.14.14.2.1.2.1.4.cmml" xref="S4.E28.m1.14.14.14.14.2.1.2.1.4"> to </mtext></ci><cn id="S4.E28.m1.14.14.14.14.2.1.2.1.5.cmml" type="integer" xref="S4.E28.m1.14.14.14.14.2.1.2.1.5">100</cn></apply><ci id="S4.E28.m1.14.14.14.14.2.1.1a.cmml" xref="S4.E28.m1.14.14.14.14.2.1.1"><mtext id="S4.E28.m1.14.14.14.14.2.1.1.cmml" xref="S4.E28.m1.14.14.14.14.2.1.1">physics-informed loss dominated.</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E28.m1.14c">LR=\begin{cases}0,&amp;\text{epoch: }1,\text{ warmup},\\
1\mathrm{e}{-5},&amp;\text{epoch: }2,\text{ initial phase ramp-up},\\
1\mathrm{e}{-4},&amp;\text{epoch: }3,\text{initial phase ramp-up},\\
5\mathrm{e}{-4},&amp;\text{epoch: }4,\text{initial phase ramp-up},\\
1\mathrm{e}{-3},&amp;\text{epochs: }5\text{ to }30,\text{initial phase},\\
5\mathrm{e}{-4},&amp;\text{epochs: }31\text{ to }40,\text{ramp-down for physics-%
informed,}\\
1\mathrm{e}{-4},&amp;\text{epochs: }41\text{ to }100,\text{physics-informed loss %
dominated.}\\
\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S4.E28.m1.14d">italic_L italic_R = { start_ROW start_CELL 0 , end_CELL start_CELL epoch: 1 , warmup , end_CELL end_ROW start_ROW start_CELL 1 roman_e - 5 , end_CELL start_CELL epoch: 2 , initial phase ramp-up , end_CELL end_ROW start_ROW start_CELL 1 roman_e - 4 , end_CELL start_CELL epoch: 3 , initial phase ramp-up , end_CELL end_ROW start_ROW start_CELL 5 roman_e - 4 , end_CELL start_CELL epoch: 4 , initial phase ramp-up , end_CELL end_ROW start_ROW start_CELL 1 roman_e - 3 , end_CELL start_CELL epochs: 5 to 30 , initial phase , end_CELL end_ROW start_ROW start_CELL 5 roman_e - 4 , end_CELL start_CELL epochs: 31 to 40 , ramp-down for physics-informed, end_CELL end_ROW start_ROW start_CELL 1 roman_e - 4 , end_CELL start_CELL epochs: 41 to 100 , physics-informed loss dominated. end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">The average loss over the 1200 cases of the test set is 1.13e-06. This value represents the average over all sets. The loss for each test case is computed as the average over the entire evolution history from the initial condition to the final steady state frame. A visual impression of the model inference performance is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F19" title="Figure 19 ‣ 4.1 Results for the Base Case (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">19</span></a> for four randomly selected test cases. In each case, a comparison is made between the ground truth (left panel) and the model prediction (right panel), for dimensionless times t=6 (first masked instance), t=200 (mid-way) and t=400 (final steady state). No differences can be identified, confirming the exceedingly low value of test loss.</p>
</div>
<figure class="ltx_figure" id="S4.F19"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="475" id="S4.F19.g1" src="extracted/5903850/FIGURES/BASE_CASE_BLOCK/Frames_BaseCase_Block_f6.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F19.2.1.1" style="font-size:90%;">Figure 19</span>: </span><span class="ltx_text" id="S4.F19.3.2" style="font-size:90%;">Model inference performance in block prediction mode for the base case. Each row corresponds to an unknown test case with unique boundary and initial conditions and unique thermal diffusivity. In each row, the first two frames show the comparison of the ground truth to the model predictions at dimensionless time t=6 (first masked instance), the middle two frames at time t=200 and the right two frames show the state state at time t=400. </span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results for the Base Case (auto-regressive prediction mode)</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The training for the model for autoregressive predictions was again carried out over 100 epochs in batches of 4 using the same learning rate schedule as described in equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.E28" title="In 4.1 Results for the Base Case (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">28</span></a>).</p>
</div>
<figure class="ltx_figure" id="S4.F20"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="396" id="S4.F20.g1" src="extracted/5903850/FIGURES/BASE_CASE_REGRESSIVE/TrainingValidation_RegressiveTest_loss.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F20.2.1.1" style="font-size:90%;">Figure 20</span>: </span><span class="ltx_text" id="S4.F20.3.2" style="font-size:90%;">Evolution of the training and validation losses using a learning rate schedule for the autoregressive mode. Learning rate transitions are marked with red dashed lines. </span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">As can be seen in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F20" title="Figure 20 ‣ 4.2 Results for the Base Case (auto-regressive prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">20</span></a>, the model learns effectively and both the training and validation losses decrease steadily by more than seven orders of magnitude. The average autoregressive test loss of 3.2e-07 was computed over all 1200 hidden test cases. For each individual test case, the loss was the computed as the average over all regressive steps. The fact that the test loss is well-aligned (in fact slightly lower than the training and validation losses) suggests that the model is able to handle successfully previously unseen combinations of parameters (i.e. boundary conditions, initial internal distribution and heat diffusivity).</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">The good model inference performance is also reflected in the visual comparisons of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F21" title="Figure 21 ‣ 4.2 Results for the Base Case (auto-regressive prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">21</span></a>, where frames of the ground-truth and regressive model predictions are shown side-by-side for dimensionless times of t=6, 200 and 400. Each row corresponds to a randomly selected test case.</p>
</div>
<figure class="ltx_figure" id="S4.F21"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="475" id="S4.F21.g1" src="extracted/5903850/FIGURES/BASE_CASE_REGRESSIVE/Frames_BaseRegressive_f6.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F21.2.1.1" style="font-size:90%;">Figure 21</span>: </span><span class="ltx_text" id="S4.F21.3.2" style="font-size:90%;">Model inference performance in autoregressive prediction mode for the base case. Each row corresponds to an unknown test case with unique boundary and initial conditions and unique thermal diffusivity. In each row, the first two frames show the comparison of the ground truth to the model predictions at dimensionless time t=6, the middle two frames at time t=200 and the right two frames show the state state at time t=400. </span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results for Challenge 1 (block prediction mode)</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Challenge-1 introduces additional localized variabilities in the evolution of the temperature field and offers a good example to highlight the importance of using a learning rate schedule. We have found that at later stages of the training, the total loss comes to be dominated by the physics-informed component that enforces awareness of the underlying physical laws. While this itrend is true even in the base case, in Challenge-1 the physics-informed loss becomes more important. During this later stage, a lower learning rate is essential to enable the model to continue learning effectively. To illustrate the importance of using a learning rate schedule, especially for the more complex configurations of Challenge 1 and Challenge 2, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F22" title="Figure 22 ‣ 4.3 Results for Challenge 1 (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">22</span></a> shows the evolution of the total loss with and without a schedule in the case of Challenge 1. As a result of these observations for Challenge-1, we have adopted a learning rate schedule in all cases (Base, Challenge-1, Challenge-2) for consistency.</p>
</div>
<figure class="ltx_figure" id="S4.F22"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="373" id="S4.F22.g1" src="extracted/5903850/FIGURES/CHALLENGE1_BLOCK/LearningRateSchedler_correct_key.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F22.2.1.1" style="font-size:90%;">Figure 22</span>: </span><span class="ltx_text" id="S4.F22.3.2" style="font-size:90%;">The time history of the of the training loss with and without the use of a learning rate scheduler.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.3">Following the same strategy as for the Base case, the model was trained for 100 epochs in batches of 4 with a training set of 8400 sets (70<math alttext="\%" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mo id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><csymbol cd="latexml" id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">%</annotation></semantics></math>)and an in-line validation using 2400 sets (20<math alttext="\%" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mo id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><csymbol cd="latexml" id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">%</annotation></semantics></math>). The completely hidden test set comprised of 1200 sets (10<math alttext="\%" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><mo id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><csymbol cd="latexml" id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">%</annotation></semantics></math>). The evolution of the training and validation loss are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F23" title="Figure 23 ‣ 4.3 Results for Challenge 1 (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">23</span></a>. The learning rate schedule of equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.E28" title="In 4.1 Results for the Base Case (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">28</span></a>) was used and the learning rate transition points are marked by red vertical dashed lines.</p>
</div>
<figure class="ltx_figure" id="S4.F23"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="375" id="S4.F23.g1" src="extracted/5903850/FIGURES/CHALLENGE1_BLOCK/training_validation_test_loss_challange1_block_case.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F23.2.1.1" style="font-size:90%;">Figure 23</span>: </span><span class="ltx_text" id="S4.F23.3.2" style="font-size:90%;"> Evolution of the training and validation losses using a learning rate schedule with transitions indicated by red dashed lines. The average test loss for inference in block prediction mode is indicated by the solid blue line.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">The average loss over the 1200 cases of the test set is 8.43e-07. This value represents the average over all sets. The loss for each test case is computed as the average over the entire evolution history from the initial condition to the final steady state frame. A visual impression of the model performance is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F24" title="Figure 24 ‣ 4.3 Results for Challenge 1 (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">24</span></a>
where model predictions and the ground truth are shown side-by-side for the initial (t=6), midway (t=200) and final frames (t=400) for several randomly chosen cases from the test set.
There are no obvious deviations between the ground truth and the predicted frames. Note, that the model is able to capture the localized temperature gradients associated with the fixed boundary segments, irrespective of changes in other features, i.e. Dirichlet boundary conditions, initial internal temperature distribution and thermal diffusivity. Video animations of the temperature evolution histories for several test cases can be found in the supplemental material posted on GitHub<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib16" title="">16</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S4.F24"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="475" id="S4.F24.g1" src="extracted/5903850/FIGURES/CHALLENGE1_BLOCK/Challenge1_Block_Frames_f6.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F24.2.1.1" style="font-size:90%;">Figure 24</span>: </span><span class="ltx_text" id="S4.F24.3.2" style="font-size:90%;">Same as Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F19" title="Figure 19 ‣ 4.1 Results for the Base Case (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">19</span></a> but for inference in block prediction mode for Challenge-1.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Results for Challenge 1 (auto-regressive prediction mode)</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">For the autoregressive mode of Challenge-1, the model was trained using the same learning rate schedule, batch size and total number of epochs as for the block prediction mode. What is impressive is that the average test loss for autoregressive inference is slightly lower than the final training and validation losses achieved during training. The reason is that during training the loss is computed on the fly over the entire sequence of frames to avoid spending an excessive time in auto-regression over the large training set.</p>
</div>
<figure class="ltx_figure" id="S4.F25"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="374" id="S4.F25.g1" src="extracted/5903850/FIGURES/CHALLENGE1_REGRESSIVE/training_validation_test_loss_challange1_autoregressive_case.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F25.2.1.1" style="font-size:90%;">Figure 25</span>: </span><span class="ltx_text" id="S4.F25.3.2" style="font-size:90%;"> Evolution of the training and validation losses using a learning rate schedule with transitions indicated by red dashed lines. The average test loss for inference in autoregressive mode is indicated by the solid blue line.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">The comparison of the ground truth and model autoregressive prediction at selected times is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F26" title="Figure 26 ‣ 4.4 Results for Challenge 1 (auto-regressive prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">26</span></a> following the same format as for the block prediction case. The model predictions are indistinguishable from the ground truth, which is remarkable given that the model is used to march forward the solution to steady state by repeatedly sampling its own predictions.</p>
</div>
<figure class="ltx_figure" id="S4.F26"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="474" id="S4.F26.g1" src="extracted/5903850/FIGURES/CHALLENGE1_REGRESSIVE/Challenge1_regressive_frames_f6.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F26.2.1.1" style="font-size:90%;">Figure 26</span>: </span><span class="ltx_text" id="S4.F26.3.2" style="font-size:90%;">Same as Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F19" title="Figure 19 ‣ 4.1 Results for the Base Case (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">19</span></a> but for inference in auto-regressive mode for Challenge-1.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Results for Challenge 2 (block prediction mode)</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">We have found that the enhanced range of variability introduced by the random boundary segments in Challenge-2 made necessary some modifications to the model and its training to preserve the same level of model performance. The number of encoder layers in Transformer was increased from 12 to 24 (see <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#A1" title="Appendix A The MLX Transformer Class ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">A</span></a>). The total number of epochs was increased to 300 and the learning schedule was adjusted accordingly as shown in equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.E29" title="In 4.5 Results for Challenge 2 (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">29</span></a>).</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<table class="ltx_equation ltx_eqn_table" id="S4.E29">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="LR=\begin{cases}0,&amp;\text{epoch: }1,\text{ warmup},\\
1\mathrm{e}{-5},&amp;\text{epoch: }2,\text{ initial phase ramp-up},\\
1\mathrm{e}{-4},&amp;\text{epoch: }3,\text{initial phase ramp-up},\\
5\mathrm{e}{-4},&amp;\text{epoch: }4,\text{initial phase},\\
1\mathrm{e}{-4},&amp;\text{epochs: }41\text{ to }100,\text{ramp-down for physics-%
informed,}\\
5\mathrm{e}{-5},&amp;\text{epochs: }101\text{ to }200,\text{physics-informed loss %
dominated,}\\
1\mathrm{e}{-5},&amp;\text{epochs: }201\text{ to }300,\text{physics-informed loss %
dominated}\\
\end{cases}" class="ltx_Math" display="block" id="S4.E29.m1.14"><semantics id="S4.E29.m1.14a"><mrow id="S4.E29.m1.14.15" xref="S4.E29.m1.14.15.cmml"><mrow id="S4.E29.m1.14.15.2" xref="S4.E29.m1.14.15.2.cmml"><mi id="S4.E29.m1.14.15.2.2" xref="S4.E29.m1.14.15.2.2.cmml">L</mi><mo id="S4.E29.m1.14.15.2.1" xref="S4.E29.m1.14.15.2.1.cmml">⁢</mo><mi id="S4.E29.m1.14.15.2.3" xref="S4.E29.m1.14.15.2.3.cmml">R</mi></mrow><mo id="S4.E29.m1.14.15.1" xref="S4.E29.m1.14.15.1.cmml">=</mo><mrow id="S4.E29.m1.14.14" xref="S4.E29.m1.14.15.3.1.cmml"><mo id="S4.E29.m1.14.14.15" xref="S4.E29.m1.14.15.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E29.m1.14.14.14" rowspacing="0pt" xref="S4.E29.m1.14.15.3.1.cmml"><mtr id="S4.E29.m1.14.14.14a" xref="S4.E29.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14b" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.1.1.1.1.1.1.3" xref="S4.E29.m1.14.15.3.1.cmml"><mn id="S4.E29.m1.1.1.1.1.1.1.1" xref="S4.E29.m1.1.1.1.1.1.1.1.cmml">0</mn><mo id="S4.E29.m1.1.1.1.1.1.1.3.1" xref="S4.E29.m1.14.15.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14c" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.2.2.2.2.2.1.2" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.2.2.2.2.2.1.2.1.1" xref="S4.E29.m1.2.2.2.2.2.1.2.1.2.cmml"><mrow id="S4.E29.m1.2.2.2.2.2.1.2.1.1.1" xref="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.cmml"><mtext id="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.2" xref="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.2a.cmml">epoch: </mtext><mo id="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.1" xref="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.1.cmml">⁢</mo><mn id="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.3" xref="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E29.m1.2.2.2.2.2.1.2.1.1.2" xref="S4.E29.m1.2.2.2.2.2.1.2.1.2.cmml">,</mo><mtext id="S4.E29.m1.2.2.2.2.2.1.1" xref="S4.E29.m1.2.2.2.2.2.1.1a.cmml"> warmup</mtext></mrow><mo id="S4.E29.m1.2.2.2.2.2.1.2.2" xref="S4.E29.m1.14.15.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E29.m1.14.14.14d" xref="S4.E29.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14e" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.3.3.3.3.1.1.1" xref="S4.E29.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="S4.E29.m1.3.3.3.3.1.1.1.1" xref="S4.E29.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="S4.E29.m1.3.3.3.3.1.1.1.1.2" xref="S4.E29.m1.3.3.3.3.1.1.1.1.2.cmml"><mn id="S4.E29.m1.3.3.3.3.1.1.1.1.2.2" xref="S4.E29.m1.3.3.3.3.1.1.1.1.2.2.cmml">1</mn><mo id="S4.E29.m1.3.3.3.3.1.1.1.1.2.1" xref="S4.E29.m1.3.3.3.3.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E29.m1.3.3.3.3.1.1.1.1.2.3" mathvariant="normal" xref="S4.E29.m1.3.3.3.3.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E29.m1.3.3.3.3.1.1.1.1.1" xref="S4.E29.m1.3.3.3.3.1.1.1.1.1.cmml">−</mo><mn id="S4.E29.m1.3.3.3.3.1.1.1.1.3" xref="S4.E29.m1.3.3.3.3.1.1.1.1.3.cmml">5</mn></mrow><mo id="S4.E29.m1.3.3.3.3.1.1.1.2" xref="S4.E29.m1.3.3.3.3.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14f" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.4.4.4.4.2.1.2" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.4.4.4.4.2.1.2.1.1" xref="S4.E29.m1.4.4.4.4.2.1.2.1.2.cmml"><mrow id="S4.E29.m1.4.4.4.4.2.1.2.1.1.1" xref="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.cmml"><mtext id="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.2" xref="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.2a.cmml">epoch: </mtext><mo id="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.1" xref="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.1.cmml">⁢</mo><mn id="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.3" xref="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.3.cmml">2</mn></mrow><mo id="S4.E29.m1.4.4.4.4.2.1.2.1.1.2" xref="S4.E29.m1.4.4.4.4.2.1.2.1.2.cmml">,</mo><mtext id="S4.E29.m1.4.4.4.4.2.1.1" xref="S4.E29.m1.4.4.4.4.2.1.1a.cmml"> initial phase ramp-up</mtext></mrow><mo id="S4.E29.m1.4.4.4.4.2.1.2.2" xref="S4.E29.m1.14.15.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E29.m1.14.14.14g" xref="S4.E29.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14h" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.5.5.5.5.1.1.1" xref="S4.E29.m1.5.5.5.5.1.1.1.1.cmml"><mrow id="S4.E29.m1.5.5.5.5.1.1.1.1" xref="S4.E29.m1.5.5.5.5.1.1.1.1.cmml"><mrow id="S4.E29.m1.5.5.5.5.1.1.1.1.2" xref="S4.E29.m1.5.5.5.5.1.1.1.1.2.cmml"><mn id="S4.E29.m1.5.5.5.5.1.1.1.1.2.2" xref="S4.E29.m1.5.5.5.5.1.1.1.1.2.2.cmml">1</mn><mo id="S4.E29.m1.5.5.5.5.1.1.1.1.2.1" xref="S4.E29.m1.5.5.5.5.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E29.m1.5.5.5.5.1.1.1.1.2.3" mathvariant="normal" xref="S4.E29.m1.5.5.5.5.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E29.m1.5.5.5.5.1.1.1.1.1" xref="S4.E29.m1.5.5.5.5.1.1.1.1.1.cmml">−</mo><mn id="S4.E29.m1.5.5.5.5.1.1.1.1.3" xref="S4.E29.m1.5.5.5.5.1.1.1.1.3.cmml">4</mn></mrow><mo id="S4.E29.m1.5.5.5.5.1.1.1.2" xref="S4.E29.m1.5.5.5.5.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14i" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.6.6.6.6.2.1.2" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.6.6.6.6.2.1.2.1.1" xref="S4.E29.m1.6.6.6.6.2.1.2.1.2.cmml"><mrow id="S4.E29.m1.6.6.6.6.2.1.2.1.1.1" xref="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.cmml"><mtext id="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.2" xref="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.2a.cmml">epoch: </mtext><mo id="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.1" xref="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.1.cmml">⁢</mo><mn id="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.3" xref="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.3.cmml">3</mn></mrow><mo id="S4.E29.m1.6.6.6.6.2.1.2.1.1.2" xref="S4.E29.m1.6.6.6.6.2.1.2.1.2.cmml">,</mo><mtext id="S4.E29.m1.6.6.6.6.2.1.1" xref="S4.E29.m1.6.6.6.6.2.1.1a.cmml">initial phase ramp-up</mtext></mrow><mo id="S4.E29.m1.6.6.6.6.2.1.2.2" xref="S4.E29.m1.14.15.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E29.m1.14.14.14j" xref="S4.E29.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14k" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.7.7.7.7.1.1.1" xref="S4.E29.m1.7.7.7.7.1.1.1.1.cmml"><mrow id="S4.E29.m1.7.7.7.7.1.1.1.1" xref="S4.E29.m1.7.7.7.7.1.1.1.1.cmml"><mrow id="S4.E29.m1.7.7.7.7.1.1.1.1.2" xref="S4.E29.m1.7.7.7.7.1.1.1.1.2.cmml"><mn id="S4.E29.m1.7.7.7.7.1.1.1.1.2.2" xref="S4.E29.m1.7.7.7.7.1.1.1.1.2.2.cmml">5</mn><mo id="S4.E29.m1.7.7.7.7.1.1.1.1.2.1" xref="S4.E29.m1.7.7.7.7.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E29.m1.7.7.7.7.1.1.1.1.2.3" mathvariant="normal" xref="S4.E29.m1.7.7.7.7.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E29.m1.7.7.7.7.1.1.1.1.1" xref="S4.E29.m1.7.7.7.7.1.1.1.1.1.cmml">−</mo><mn id="S4.E29.m1.7.7.7.7.1.1.1.1.3" xref="S4.E29.m1.7.7.7.7.1.1.1.1.3.cmml">4</mn></mrow><mo id="S4.E29.m1.7.7.7.7.1.1.1.2" xref="S4.E29.m1.7.7.7.7.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14l" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.8.8.8.8.2.1.2" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.8.8.8.8.2.1.2.1.1" xref="S4.E29.m1.8.8.8.8.2.1.2.1.2.cmml"><mrow id="S4.E29.m1.8.8.8.8.2.1.2.1.1.1" xref="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.cmml"><mtext id="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.2" xref="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.2a.cmml">epoch: </mtext><mo id="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.1" xref="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.1.cmml">⁢</mo><mn id="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.3" xref="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.3.cmml">4</mn></mrow><mo id="S4.E29.m1.8.8.8.8.2.1.2.1.1.2" xref="S4.E29.m1.8.8.8.8.2.1.2.1.2.cmml">,</mo><mtext id="S4.E29.m1.8.8.8.8.2.1.1" xref="S4.E29.m1.8.8.8.8.2.1.1a.cmml">initial phase</mtext></mrow><mo id="S4.E29.m1.8.8.8.8.2.1.2.2" xref="S4.E29.m1.14.15.3.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E29.m1.14.14.14m" xref="S4.E29.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14n" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.9.9.9.9.1.1.1" xref="S4.E29.m1.9.9.9.9.1.1.1.1.cmml"><mrow id="S4.E29.m1.9.9.9.9.1.1.1.1" xref="S4.E29.m1.9.9.9.9.1.1.1.1.cmml"><mrow id="S4.E29.m1.9.9.9.9.1.1.1.1.2" xref="S4.E29.m1.9.9.9.9.1.1.1.1.2.cmml"><mn id="S4.E29.m1.9.9.9.9.1.1.1.1.2.2" xref="S4.E29.m1.9.9.9.9.1.1.1.1.2.2.cmml">1</mn><mo id="S4.E29.m1.9.9.9.9.1.1.1.1.2.1" xref="S4.E29.m1.9.9.9.9.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E29.m1.9.9.9.9.1.1.1.1.2.3" mathvariant="normal" xref="S4.E29.m1.9.9.9.9.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E29.m1.9.9.9.9.1.1.1.1.1" xref="S4.E29.m1.9.9.9.9.1.1.1.1.1.cmml">−</mo><mn id="S4.E29.m1.9.9.9.9.1.1.1.1.3" xref="S4.E29.m1.9.9.9.9.1.1.1.1.3.cmml">4</mn></mrow><mo id="S4.E29.m1.9.9.9.9.1.1.1.2" xref="S4.E29.m1.9.9.9.9.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14o" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.10.10.10.10.2.1.2" xref="S4.E29.m1.10.10.10.10.2.1.3.cmml"><mrow id="S4.E29.m1.10.10.10.10.2.1.2.1" xref="S4.E29.m1.10.10.10.10.2.1.2.1.cmml"><mtext id="S4.E29.m1.10.10.10.10.2.1.2.1.2" xref="S4.E29.m1.10.10.10.10.2.1.2.1.2a.cmml">epochs: </mtext><mo id="S4.E29.m1.10.10.10.10.2.1.2.1.1" xref="S4.E29.m1.10.10.10.10.2.1.2.1.1.cmml">⁢</mo><mn id="S4.E29.m1.10.10.10.10.2.1.2.1.3" xref="S4.E29.m1.10.10.10.10.2.1.2.1.3.cmml">41</mn><mo id="S4.E29.m1.10.10.10.10.2.1.2.1.1a" xref="S4.E29.m1.10.10.10.10.2.1.2.1.1.cmml">⁢</mo><mtext id="S4.E29.m1.10.10.10.10.2.1.2.1.4" xref="S4.E29.m1.10.10.10.10.2.1.2.1.4a.cmml"> to </mtext><mo id="S4.E29.m1.10.10.10.10.2.1.2.1.1b" xref="S4.E29.m1.10.10.10.10.2.1.2.1.1.cmml">⁢</mo><mn id="S4.E29.m1.10.10.10.10.2.1.2.1.5" xref="S4.E29.m1.10.10.10.10.2.1.2.1.5.cmml">100</mn></mrow><mo id="S4.E29.m1.10.10.10.10.2.1.2.2" xref="S4.E29.m1.10.10.10.10.2.1.3.cmml">,</mo><mtext id="S4.E29.m1.10.10.10.10.2.1.1" xref="S4.E29.m1.10.10.10.10.2.1.1a.cmml">ramp-down for physics-informed,</mtext></mrow></mtd></mtr><mtr id="S4.E29.m1.14.14.14p" xref="S4.E29.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14q" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.11.11.11.11.1.1.1" xref="S4.E29.m1.11.11.11.11.1.1.1.1.cmml"><mrow id="S4.E29.m1.11.11.11.11.1.1.1.1" xref="S4.E29.m1.11.11.11.11.1.1.1.1.cmml"><mrow id="S4.E29.m1.11.11.11.11.1.1.1.1.2" xref="S4.E29.m1.11.11.11.11.1.1.1.1.2.cmml"><mn id="S4.E29.m1.11.11.11.11.1.1.1.1.2.2" xref="S4.E29.m1.11.11.11.11.1.1.1.1.2.2.cmml">5</mn><mo id="S4.E29.m1.11.11.11.11.1.1.1.1.2.1" xref="S4.E29.m1.11.11.11.11.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E29.m1.11.11.11.11.1.1.1.1.2.3" mathvariant="normal" xref="S4.E29.m1.11.11.11.11.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E29.m1.11.11.11.11.1.1.1.1.1" xref="S4.E29.m1.11.11.11.11.1.1.1.1.1.cmml">−</mo><mn id="S4.E29.m1.11.11.11.11.1.1.1.1.3" xref="S4.E29.m1.11.11.11.11.1.1.1.1.3.cmml">5</mn></mrow><mo id="S4.E29.m1.11.11.11.11.1.1.1.2" xref="S4.E29.m1.11.11.11.11.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14r" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.12.12.12.12.2.1.2" xref="S4.E29.m1.12.12.12.12.2.1.3.cmml"><mrow id="S4.E29.m1.12.12.12.12.2.1.2.1" xref="S4.E29.m1.12.12.12.12.2.1.2.1.cmml"><mtext id="S4.E29.m1.12.12.12.12.2.1.2.1.2" xref="S4.E29.m1.12.12.12.12.2.1.2.1.2a.cmml">epochs: </mtext><mo id="S4.E29.m1.12.12.12.12.2.1.2.1.1" xref="S4.E29.m1.12.12.12.12.2.1.2.1.1.cmml">⁢</mo><mn id="S4.E29.m1.12.12.12.12.2.1.2.1.3" xref="S4.E29.m1.12.12.12.12.2.1.2.1.3.cmml">101</mn><mo id="S4.E29.m1.12.12.12.12.2.1.2.1.1a" xref="S4.E29.m1.12.12.12.12.2.1.2.1.1.cmml">⁢</mo><mtext id="S4.E29.m1.12.12.12.12.2.1.2.1.4" xref="S4.E29.m1.12.12.12.12.2.1.2.1.4a.cmml"> to </mtext><mo id="S4.E29.m1.12.12.12.12.2.1.2.1.1b" xref="S4.E29.m1.12.12.12.12.2.1.2.1.1.cmml">⁢</mo><mn id="S4.E29.m1.12.12.12.12.2.1.2.1.5" xref="S4.E29.m1.12.12.12.12.2.1.2.1.5.cmml">200</mn></mrow><mo id="S4.E29.m1.12.12.12.12.2.1.2.2" xref="S4.E29.m1.12.12.12.12.2.1.3.cmml">,</mo><mtext id="S4.E29.m1.12.12.12.12.2.1.1" xref="S4.E29.m1.12.12.12.12.2.1.1a.cmml">physics-informed loss dominated,</mtext></mrow></mtd></mtr><mtr id="S4.E29.m1.14.14.14s" xref="S4.E29.m1.14.15.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14t" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.13.13.13.13.1.1.1" xref="S4.E29.m1.13.13.13.13.1.1.1.1.cmml"><mrow id="S4.E29.m1.13.13.13.13.1.1.1.1" xref="S4.E29.m1.13.13.13.13.1.1.1.1.cmml"><mrow id="S4.E29.m1.13.13.13.13.1.1.1.1.2" xref="S4.E29.m1.13.13.13.13.1.1.1.1.2.cmml"><mn id="S4.E29.m1.13.13.13.13.1.1.1.1.2.2" xref="S4.E29.m1.13.13.13.13.1.1.1.1.2.2.cmml">1</mn><mo id="S4.E29.m1.13.13.13.13.1.1.1.1.2.1" xref="S4.E29.m1.13.13.13.13.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E29.m1.13.13.13.13.1.1.1.1.2.3" mathvariant="normal" xref="S4.E29.m1.13.13.13.13.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.E29.m1.13.13.13.13.1.1.1.1.1" xref="S4.E29.m1.13.13.13.13.1.1.1.1.1.cmml">−</mo><mn id="S4.E29.m1.13.13.13.13.1.1.1.1.3" xref="S4.E29.m1.13.13.13.13.1.1.1.1.3.cmml">5</mn></mrow><mo id="S4.E29.m1.13.13.13.13.1.1.1.2" xref="S4.E29.m1.13.13.13.13.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.14.14.14u" xref="S4.E29.m1.14.15.3.1.cmml"><mrow id="S4.E29.m1.14.14.14.14.2.1.2" xref="S4.E29.m1.14.14.14.14.2.1.3.cmml"><mrow id="S4.E29.m1.14.14.14.14.2.1.2.1" xref="S4.E29.m1.14.14.14.14.2.1.2.1.cmml"><mtext id="S4.E29.m1.14.14.14.14.2.1.2.1.2" xref="S4.E29.m1.14.14.14.14.2.1.2.1.2a.cmml">epochs: </mtext><mo id="S4.E29.m1.14.14.14.14.2.1.2.1.1" xref="S4.E29.m1.14.14.14.14.2.1.2.1.1.cmml">⁢</mo><mn id="S4.E29.m1.14.14.14.14.2.1.2.1.3" xref="S4.E29.m1.14.14.14.14.2.1.2.1.3.cmml">201</mn><mo id="S4.E29.m1.14.14.14.14.2.1.2.1.1a" xref="S4.E29.m1.14.14.14.14.2.1.2.1.1.cmml">⁢</mo><mtext id="S4.E29.m1.14.14.14.14.2.1.2.1.4" xref="S4.E29.m1.14.14.14.14.2.1.2.1.4a.cmml"> to </mtext><mo id="S4.E29.m1.14.14.14.14.2.1.2.1.1b" xref="S4.E29.m1.14.14.14.14.2.1.2.1.1.cmml">⁢</mo><mn id="S4.E29.m1.14.14.14.14.2.1.2.1.5" xref="S4.E29.m1.14.14.14.14.2.1.2.1.5.cmml">300</mn></mrow><mo id="S4.E29.m1.14.14.14.14.2.1.2.2" xref="S4.E29.m1.14.14.14.14.2.1.3.cmml">,</mo><mtext id="S4.E29.m1.14.14.14.14.2.1.1" xref="S4.E29.m1.14.14.14.14.2.1.1a.cmml">physics-informed loss dominated</mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E29.m1.14b"><apply id="S4.E29.m1.14.15.cmml" xref="S4.E29.m1.14.15"><eq id="S4.E29.m1.14.15.1.cmml" xref="S4.E29.m1.14.15.1"></eq><apply id="S4.E29.m1.14.15.2.cmml" xref="S4.E29.m1.14.15.2"><times id="S4.E29.m1.14.15.2.1.cmml" xref="S4.E29.m1.14.15.2.1"></times><ci id="S4.E29.m1.14.15.2.2.cmml" xref="S4.E29.m1.14.15.2.2">𝐿</ci><ci id="S4.E29.m1.14.15.2.3.cmml" xref="S4.E29.m1.14.15.2.3">𝑅</ci></apply><apply id="S4.E29.m1.14.15.3.1.cmml" xref="S4.E29.m1.14.14"><csymbol cd="latexml" id="S4.E29.m1.14.15.3.1.1.cmml" xref="S4.E29.m1.14.14.15">cases</csymbol><cn id="S4.E29.m1.1.1.1.1.1.1.1.cmml" type="integer" xref="S4.E29.m1.1.1.1.1.1.1.1">0</cn><list id="S4.E29.m1.2.2.2.2.2.1.2.1.2.cmml" xref="S4.E29.m1.2.2.2.2.2.1.2.1.1"><apply id="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.cmml" xref="S4.E29.m1.2.2.2.2.2.1.2.1.1.1"><times id="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.1.cmml" xref="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.1"></times><ci id="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.2a.cmml" xref="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.2"><mtext id="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.2.cmml" xref="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.2">epoch: </mtext></ci><cn id="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.3.cmml" type="integer" xref="S4.E29.m1.2.2.2.2.2.1.2.1.1.1.3">1</cn></apply><ci id="S4.E29.m1.2.2.2.2.2.1.1a.cmml" xref="S4.E29.m1.2.2.2.2.2.1.1"><mtext id="S4.E29.m1.2.2.2.2.2.1.1.cmml" xref="S4.E29.m1.2.2.2.2.2.1.1"> warmup</mtext></ci></list><apply id="S4.E29.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E29.m1.3.3.3.3.1.1.1"><minus id="S4.E29.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E29.m1.3.3.3.3.1.1.1.1.1"></minus><apply id="S4.E29.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S4.E29.m1.3.3.3.3.1.1.1.1.2"><times id="S4.E29.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S4.E29.m1.3.3.3.3.1.1.1.1.2.1"></times><cn id="S4.E29.m1.3.3.3.3.1.1.1.1.2.2.cmml" type="integer" xref="S4.E29.m1.3.3.3.3.1.1.1.1.2.2">1</cn><ci id="S4.E29.m1.3.3.3.3.1.1.1.1.2.3.cmml" xref="S4.E29.m1.3.3.3.3.1.1.1.1.2.3">e</ci></apply><cn id="S4.E29.m1.3.3.3.3.1.1.1.1.3.cmml" type="integer" xref="S4.E29.m1.3.3.3.3.1.1.1.1.3">5</cn></apply><list id="S4.E29.m1.4.4.4.4.2.1.2.1.2.cmml" xref="S4.E29.m1.4.4.4.4.2.1.2.1.1"><apply id="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.cmml" xref="S4.E29.m1.4.4.4.4.2.1.2.1.1.1"><times id="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.1.cmml" xref="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.1"></times><ci id="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.2a.cmml" xref="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.2"><mtext id="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.2.cmml" xref="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.2">epoch: </mtext></ci><cn id="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.3.cmml" type="integer" xref="S4.E29.m1.4.4.4.4.2.1.2.1.1.1.3">2</cn></apply><ci id="S4.E29.m1.4.4.4.4.2.1.1a.cmml" xref="S4.E29.m1.4.4.4.4.2.1.1"><mtext id="S4.E29.m1.4.4.4.4.2.1.1.cmml" xref="S4.E29.m1.4.4.4.4.2.1.1"> initial phase ramp-up</mtext></ci></list><apply id="S4.E29.m1.5.5.5.5.1.1.1.1.cmml" xref="S4.E29.m1.5.5.5.5.1.1.1"><minus id="S4.E29.m1.5.5.5.5.1.1.1.1.1.cmml" xref="S4.E29.m1.5.5.5.5.1.1.1.1.1"></minus><apply id="S4.E29.m1.5.5.5.5.1.1.1.1.2.cmml" xref="S4.E29.m1.5.5.5.5.1.1.1.1.2"><times id="S4.E29.m1.5.5.5.5.1.1.1.1.2.1.cmml" xref="S4.E29.m1.5.5.5.5.1.1.1.1.2.1"></times><cn id="S4.E29.m1.5.5.5.5.1.1.1.1.2.2.cmml" type="integer" xref="S4.E29.m1.5.5.5.5.1.1.1.1.2.2">1</cn><ci id="S4.E29.m1.5.5.5.5.1.1.1.1.2.3.cmml" xref="S4.E29.m1.5.5.5.5.1.1.1.1.2.3">e</ci></apply><cn id="S4.E29.m1.5.5.5.5.1.1.1.1.3.cmml" type="integer" xref="S4.E29.m1.5.5.5.5.1.1.1.1.3">4</cn></apply><list id="S4.E29.m1.6.6.6.6.2.1.2.1.2.cmml" xref="S4.E29.m1.6.6.6.6.2.1.2.1.1"><apply id="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.cmml" xref="S4.E29.m1.6.6.6.6.2.1.2.1.1.1"><times id="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.1.cmml" xref="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.1"></times><ci id="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.2a.cmml" xref="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.2"><mtext id="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.2.cmml" xref="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.2">epoch: </mtext></ci><cn id="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.3.cmml" type="integer" xref="S4.E29.m1.6.6.6.6.2.1.2.1.1.1.3">3</cn></apply><ci id="S4.E29.m1.6.6.6.6.2.1.1a.cmml" xref="S4.E29.m1.6.6.6.6.2.1.1"><mtext id="S4.E29.m1.6.6.6.6.2.1.1.cmml" xref="S4.E29.m1.6.6.6.6.2.1.1">initial phase ramp-up</mtext></ci></list><apply id="S4.E29.m1.7.7.7.7.1.1.1.1.cmml" xref="S4.E29.m1.7.7.7.7.1.1.1"><minus id="S4.E29.m1.7.7.7.7.1.1.1.1.1.cmml" xref="S4.E29.m1.7.7.7.7.1.1.1.1.1"></minus><apply id="S4.E29.m1.7.7.7.7.1.1.1.1.2.cmml" xref="S4.E29.m1.7.7.7.7.1.1.1.1.2"><times id="S4.E29.m1.7.7.7.7.1.1.1.1.2.1.cmml" xref="S4.E29.m1.7.7.7.7.1.1.1.1.2.1"></times><cn id="S4.E29.m1.7.7.7.7.1.1.1.1.2.2.cmml" type="integer" xref="S4.E29.m1.7.7.7.7.1.1.1.1.2.2">5</cn><ci id="S4.E29.m1.7.7.7.7.1.1.1.1.2.3.cmml" xref="S4.E29.m1.7.7.7.7.1.1.1.1.2.3">e</ci></apply><cn id="S4.E29.m1.7.7.7.7.1.1.1.1.3.cmml" type="integer" xref="S4.E29.m1.7.7.7.7.1.1.1.1.3">4</cn></apply><list id="S4.E29.m1.8.8.8.8.2.1.2.1.2.cmml" xref="S4.E29.m1.8.8.8.8.2.1.2.1.1"><apply id="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.cmml" xref="S4.E29.m1.8.8.8.8.2.1.2.1.1.1"><times id="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.1.cmml" xref="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.1"></times><ci id="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.2a.cmml" xref="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.2"><mtext id="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.2.cmml" xref="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.2">epoch: </mtext></ci><cn id="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.3.cmml" type="integer" xref="S4.E29.m1.8.8.8.8.2.1.2.1.1.1.3">4</cn></apply><ci id="S4.E29.m1.8.8.8.8.2.1.1a.cmml" xref="S4.E29.m1.8.8.8.8.2.1.1"><mtext id="S4.E29.m1.8.8.8.8.2.1.1.cmml" xref="S4.E29.m1.8.8.8.8.2.1.1">initial phase</mtext></ci></list><apply id="S4.E29.m1.9.9.9.9.1.1.1.1.cmml" xref="S4.E29.m1.9.9.9.9.1.1.1"><minus id="S4.E29.m1.9.9.9.9.1.1.1.1.1.cmml" xref="S4.E29.m1.9.9.9.9.1.1.1.1.1"></minus><apply id="S4.E29.m1.9.9.9.9.1.1.1.1.2.cmml" xref="S4.E29.m1.9.9.9.9.1.1.1.1.2"><times id="S4.E29.m1.9.9.9.9.1.1.1.1.2.1.cmml" xref="S4.E29.m1.9.9.9.9.1.1.1.1.2.1"></times><cn id="S4.E29.m1.9.9.9.9.1.1.1.1.2.2.cmml" type="integer" xref="S4.E29.m1.9.9.9.9.1.1.1.1.2.2">1</cn><ci id="S4.E29.m1.9.9.9.9.1.1.1.1.2.3.cmml" xref="S4.E29.m1.9.9.9.9.1.1.1.1.2.3">e</ci></apply><cn id="S4.E29.m1.9.9.9.9.1.1.1.1.3.cmml" type="integer" xref="S4.E29.m1.9.9.9.9.1.1.1.1.3">4</cn></apply><list id="S4.E29.m1.10.10.10.10.2.1.3.cmml" xref="S4.E29.m1.10.10.10.10.2.1.2"><apply id="S4.E29.m1.10.10.10.10.2.1.2.1.cmml" xref="S4.E29.m1.10.10.10.10.2.1.2.1"><times id="S4.E29.m1.10.10.10.10.2.1.2.1.1.cmml" xref="S4.E29.m1.10.10.10.10.2.1.2.1.1"></times><ci id="S4.E29.m1.10.10.10.10.2.1.2.1.2a.cmml" xref="S4.E29.m1.10.10.10.10.2.1.2.1.2"><mtext id="S4.E29.m1.10.10.10.10.2.1.2.1.2.cmml" xref="S4.E29.m1.10.10.10.10.2.1.2.1.2">epochs: </mtext></ci><cn id="S4.E29.m1.10.10.10.10.2.1.2.1.3.cmml" type="integer" xref="S4.E29.m1.10.10.10.10.2.1.2.1.3">41</cn><ci id="S4.E29.m1.10.10.10.10.2.1.2.1.4a.cmml" xref="S4.E29.m1.10.10.10.10.2.1.2.1.4"><mtext id="S4.E29.m1.10.10.10.10.2.1.2.1.4.cmml" xref="S4.E29.m1.10.10.10.10.2.1.2.1.4"> to </mtext></ci><cn id="S4.E29.m1.10.10.10.10.2.1.2.1.5.cmml" type="integer" xref="S4.E29.m1.10.10.10.10.2.1.2.1.5">100</cn></apply><ci id="S4.E29.m1.10.10.10.10.2.1.1a.cmml" xref="S4.E29.m1.10.10.10.10.2.1.1"><mtext id="S4.E29.m1.10.10.10.10.2.1.1.cmml" xref="S4.E29.m1.10.10.10.10.2.1.1">ramp-down for physics-informed,</mtext></ci></list><apply id="S4.E29.m1.11.11.11.11.1.1.1.1.cmml" xref="S4.E29.m1.11.11.11.11.1.1.1"><minus id="S4.E29.m1.11.11.11.11.1.1.1.1.1.cmml" xref="S4.E29.m1.11.11.11.11.1.1.1.1.1"></minus><apply id="S4.E29.m1.11.11.11.11.1.1.1.1.2.cmml" xref="S4.E29.m1.11.11.11.11.1.1.1.1.2"><times id="S4.E29.m1.11.11.11.11.1.1.1.1.2.1.cmml" xref="S4.E29.m1.11.11.11.11.1.1.1.1.2.1"></times><cn id="S4.E29.m1.11.11.11.11.1.1.1.1.2.2.cmml" type="integer" xref="S4.E29.m1.11.11.11.11.1.1.1.1.2.2">5</cn><ci id="S4.E29.m1.11.11.11.11.1.1.1.1.2.3.cmml" xref="S4.E29.m1.11.11.11.11.1.1.1.1.2.3">e</ci></apply><cn id="S4.E29.m1.11.11.11.11.1.1.1.1.3.cmml" type="integer" xref="S4.E29.m1.11.11.11.11.1.1.1.1.3">5</cn></apply><list id="S4.E29.m1.12.12.12.12.2.1.3.cmml" xref="S4.E29.m1.12.12.12.12.2.1.2"><apply id="S4.E29.m1.12.12.12.12.2.1.2.1.cmml" xref="S4.E29.m1.12.12.12.12.2.1.2.1"><times id="S4.E29.m1.12.12.12.12.2.1.2.1.1.cmml" xref="S4.E29.m1.12.12.12.12.2.1.2.1.1"></times><ci id="S4.E29.m1.12.12.12.12.2.1.2.1.2a.cmml" xref="S4.E29.m1.12.12.12.12.2.1.2.1.2"><mtext id="S4.E29.m1.12.12.12.12.2.1.2.1.2.cmml" xref="S4.E29.m1.12.12.12.12.2.1.2.1.2">epochs: </mtext></ci><cn id="S4.E29.m1.12.12.12.12.2.1.2.1.3.cmml" type="integer" xref="S4.E29.m1.12.12.12.12.2.1.2.1.3">101</cn><ci id="S4.E29.m1.12.12.12.12.2.1.2.1.4a.cmml" xref="S4.E29.m1.12.12.12.12.2.1.2.1.4"><mtext id="S4.E29.m1.12.12.12.12.2.1.2.1.4.cmml" xref="S4.E29.m1.12.12.12.12.2.1.2.1.4"> to </mtext></ci><cn id="S4.E29.m1.12.12.12.12.2.1.2.1.5.cmml" type="integer" xref="S4.E29.m1.12.12.12.12.2.1.2.1.5">200</cn></apply><ci id="S4.E29.m1.12.12.12.12.2.1.1a.cmml" xref="S4.E29.m1.12.12.12.12.2.1.1"><mtext id="S4.E29.m1.12.12.12.12.2.1.1.cmml" xref="S4.E29.m1.12.12.12.12.2.1.1">physics-informed loss dominated,</mtext></ci></list><apply id="S4.E29.m1.13.13.13.13.1.1.1.1.cmml" xref="S4.E29.m1.13.13.13.13.1.1.1"><minus id="S4.E29.m1.13.13.13.13.1.1.1.1.1.cmml" xref="S4.E29.m1.13.13.13.13.1.1.1.1.1"></minus><apply id="S4.E29.m1.13.13.13.13.1.1.1.1.2.cmml" xref="S4.E29.m1.13.13.13.13.1.1.1.1.2"><times id="S4.E29.m1.13.13.13.13.1.1.1.1.2.1.cmml" xref="S4.E29.m1.13.13.13.13.1.1.1.1.2.1"></times><cn id="S4.E29.m1.13.13.13.13.1.1.1.1.2.2.cmml" type="integer" xref="S4.E29.m1.13.13.13.13.1.1.1.1.2.2">1</cn><ci id="S4.E29.m1.13.13.13.13.1.1.1.1.2.3.cmml" xref="S4.E29.m1.13.13.13.13.1.1.1.1.2.3">e</ci></apply><cn id="S4.E29.m1.13.13.13.13.1.1.1.1.3.cmml" type="integer" xref="S4.E29.m1.13.13.13.13.1.1.1.1.3">5</cn></apply><list id="S4.E29.m1.14.14.14.14.2.1.3.cmml" xref="S4.E29.m1.14.14.14.14.2.1.2"><apply id="S4.E29.m1.14.14.14.14.2.1.2.1.cmml" xref="S4.E29.m1.14.14.14.14.2.1.2.1"><times id="S4.E29.m1.14.14.14.14.2.1.2.1.1.cmml" xref="S4.E29.m1.14.14.14.14.2.1.2.1.1"></times><ci id="S4.E29.m1.14.14.14.14.2.1.2.1.2a.cmml" xref="S4.E29.m1.14.14.14.14.2.1.2.1.2"><mtext id="S4.E29.m1.14.14.14.14.2.1.2.1.2.cmml" xref="S4.E29.m1.14.14.14.14.2.1.2.1.2">epochs: </mtext></ci><cn id="S4.E29.m1.14.14.14.14.2.1.2.1.3.cmml" type="integer" xref="S4.E29.m1.14.14.14.14.2.1.2.1.3">201</cn><ci id="S4.E29.m1.14.14.14.14.2.1.2.1.4a.cmml" xref="S4.E29.m1.14.14.14.14.2.1.2.1.4"><mtext id="S4.E29.m1.14.14.14.14.2.1.2.1.4.cmml" xref="S4.E29.m1.14.14.14.14.2.1.2.1.4"> to </mtext></ci><cn id="S4.E29.m1.14.14.14.14.2.1.2.1.5.cmml" type="integer" xref="S4.E29.m1.14.14.14.14.2.1.2.1.5">300</cn></apply><ci id="S4.E29.m1.14.14.14.14.2.1.1a.cmml" xref="S4.E29.m1.14.14.14.14.2.1.1"><mtext id="S4.E29.m1.14.14.14.14.2.1.1.cmml" xref="S4.E29.m1.14.14.14.14.2.1.1">physics-informed loss dominated</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E29.m1.14c">LR=\begin{cases}0,&amp;\text{epoch: }1,\text{ warmup},\\
1\mathrm{e}{-5},&amp;\text{epoch: }2,\text{ initial phase ramp-up},\\
1\mathrm{e}{-4},&amp;\text{epoch: }3,\text{initial phase ramp-up},\\
5\mathrm{e}{-4},&amp;\text{epoch: }4,\text{initial phase},\\
1\mathrm{e}{-4},&amp;\text{epochs: }41\text{ to }100,\text{ramp-down for physics-%
informed,}\\
5\mathrm{e}{-5},&amp;\text{epochs: }101\text{ to }200,\text{physics-informed loss %
dominated,}\\
1\mathrm{e}{-5},&amp;\text{epochs: }201\text{ to }300,\text{physics-informed loss %
dominated}\\
\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S4.E29.m1.14d">italic_L italic_R = { start_ROW start_CELL 0 , end_CELL start_CELL epoch: 1 , warmup , end_CELL end_ROW start_ROW start_CELL 1 roman_e - 5 , end_CELL start_CELL epoch: 2 , initial phase ramp-up , end_CELL end_ROW start_ROW start_CELL 1 roman_e - 4 , end_CELL start_CELL epoch: 3 , initial phase ramp-up , end_CELL end_ROW start_ROW start_CELL 5 roman_e - 4 , end_CELL start_CELL epoch: 4 , initial phase , end_CELL end_ROW start_ROW start_CELL 1 roman_e - 4 , end_CELL start_CELL epochs: 41 to 100 , ramp-down for physics-informed, end_CELL end_ROW start_ROW start_CELL 5 roman_e - 5 , end_CELL start_CELL epochs: 101 to 200 , physics-informed loss dominated, end_CELL end_ROW start_ROW start_CELL 1 roman_e - 5 , end_CELL start_CELL epochs: 201 to 300 , physics-informed loss dominated end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(29)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.1">The evolution history of the training and validation losses based on this schedule are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F27" title="Figure 27 ‣ 4.5 Results for Challenge 2 (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">27</span></a>. The average test loss for block prediction inference has a value of is 2.78e-06 as indicated by the solid blue line. The validation loss tracks closely the training loss and the model learns effectively. Nevertheless, the final loss values achieved are moderately higher than in the base and Challenge-1 cases, which is not surprising considering the complexity of Challenge-2. The comparison of the ground truth and model predictions using frames at dimensionless times t=6, 200 and 400 confirm the inference performance of the model when challenged with unknown cases in the test set. The model is able to capture well the regions of localized gradients in the vicinity of the random boundary segments.</p>
</div>
<figure class="ltx_figure" id="S4.F27"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="377" id="S4.F27.g1" src="extracted/5903850/FIGURES/CHALLENGE2_BLOCK/training_validation_test_loss_challange2_block_case.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F27.2.1.1" style="font-size:90%;">Figure 27</span>: </span><span class="ltx_text" id="S4.F27.3.2" style="font-size:90%;"> Evolution of the training and validation losses using the learning rate schedule of equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.E29" title="In 4.5 Results for Challenge 2 (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">29</span></a>) for Challenge-2 with transitions indicated by red dashed lines. The average test loss for inference in block prediction mode is indicated by the solid blue line.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S4.F28"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="476" id="S4.F28.g1" src="extracted/5903850/FIGURES/CHALLENGE2_BLOCK/Challenge2_block_frames_f6.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F28.2.1.1" style="font-size:90%;">Figure 28</span>: </span><span class="ltx_text" id="S4.F28.3.2" style="font-size:90%;">Same as Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F19" title="Figure 19 ‣ 4.1 Results for the Base Case (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">19</span></a> but for inference in block prediction mode in Challenge-2. </span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Results for Challenge 2 (auto-regressive prediction mode)</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F29" title="Figure 29 ‣ 4.6 Results for Challenge 2 (auto-regressive prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">29</span></a>, using the same learning rate schedule of equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.E29" title="In 4.5 Results for Challenge 2 (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">29</span></a>) for training the model in the autoregressive mode yields a similar evolution history for the training and validation losses. The average test loss for inference in the autoregressive mode is indicate by the blue solid line and corresponds to a value of 4.21e-07.</p>
</div>
<figure class="ltx_figure" id="S4.F29"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="377" id="S4.F29.g1" src="extracted/5903850/FIGURES/CHALLENGE2_REGRESSIVE/training_validation_test_loss_challange2_regress_case.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F29.2.1.1" style="font-size:90%;">Figure 29</span>: </span><span class="ltx_text" id="S4.F29.3.2" style="font-size:90%;">Evolution of the training and validation losses using the learning rate schedule of equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.E29" title="In 4.5 Results for Challenge 2 (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">29</span></a>) for Challenge-2 with transitions indicated by red dashed lines. The average test loss for inference in autoregressive prediction mode is indicated by the solid blue line.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS6.p2">
<p class="ltx_p" id="S4.SS6.p2.1">The model performance in the autoregressive inference mode is shown shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F30" title="Figure 30 ‣ 4.6 Results for Challenge 2 (auto-regressive prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">30</span></a> for a set of randomly cases from the hidden test set. The model is able to capture successfully the regions of increased local temperature variability associated with the randomly placed boundary segments.</p>
</div>
<figure class="ltx_figure" id="S4.F30"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="476" id="S4.F30.g1" src="extracted/5903850/FIGURES/CHALLENGE2_REGRESSIVE/Challange2_Regressive_Frames.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F30.2.1.1" style="font-size:90%;">Figure 30</span>: </span><span class="ltx_text" id="S4.F30.3.2" style="font-size:90%;">Same as Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S4.F19" title="Figure 19 ‣ 4.1 Results for the Base Case (block prediction mode) ‣ 4 Results ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">19</span></a> but for inference in autoregressive prediction mode in Challenge-2. </span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion, Limitations and Insights</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Our aim in this work has been to offer a friendly introduction to the application of Transformer models in engineering physics. For this reason, we have discussed the key ingredients of Transformer NNs and drew parallels to equivalent mathematical concepts commonly used in Engineering. For the same reason, we have chosen to specifically focus on the 2D heat conduction problem as an example application because it is governed by a classical partial differential equation whose numerical solution is well understood . However, it is important to recognize that several optimizations and explorations have been intentionally left out of this introductory paper to be addressed in future work. Since the code is shared under an MIT license on GitHub<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib16" title="">16</a>]</cite>, we invite others to explore some these directions as well.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">Some of the limitations to be addressed in future work include:</p>
</div>
<div class="ltx_para" id="S5.p3">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I1.i1.p1.1.1">Speed Optimization:</span> While MLX provides significant speed improvements due to its use of unified memory, further optimizations could be explored, particularly in terms of memory management and parallelization on larger datasets.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I1.i2.p1.1.1">Distributed Parallel Computing:</span> MLX supports distributed computing on several GPUs over MPI (Message Passing Interface). We have shown that the model can be trained and applied using a small cluster of four Mac Studios with M2 Ultra processors. However, we have not yet attempted a thorough performance benchmark because, on one hand, potential gains are tied to the details of the distributed training strategy and on the other, the distributed computing capabilities of MLX are still under development.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I1.i3.p1.1.1">Exploration of Training Strategies:</span> There are various training strategies that could be further investigated, such as experimenting with different optimizers (e.g., AdamW, LAMB) and learning rate schedules. The effect of different batch sizes and gradient accumulation strategies on model performance could also be explored.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I1.i4.p1.1.1">Exploration of Cross-Correlation in Loss</span>: While the present implementation already captures essential temporal correlations via the physics-informed loss, future work could explore enforcing cross-correlation as part of the loss computation to complement the physics-informed loss component in capturing time evolution dynamics. This exploration could be particularly important for applications where the governing partial differential equations include stochasticity.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="S5.I1.i5.p1">
<p class="ltx_p" id="S5.I1.i5.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I1.i5.p1.1.1">Minimal Model Configurations:</span> Although the current model configuration (number of layers, attention heads, etc.) has proven effective, a more systematic exploration of minimal configurations could help reduce model complexity while maintaining performance, particularly for deployment on lower-memory devices.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span>
<div class="ltx_para" id="S5.I1.i6.p1">
<p class="ltx_p" id="S5.I1.i6.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I1.i6.p1.1.1">Comparison to Other Neural Networks:</span> A thorough comparison of Transformers with other neural network architectures commonly used in physics simulations, such as convolutional neural networks (CNNs) or recurrent neural networks (RNNs), could provide deeper insights into the relative strengths and weaknesses of each approach.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">7.</span>
<div class="ltx_para" id="S5.I1.i7.p1">
<p class="ltx_p" id="S5.I1.i7.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I1.i7.p1.1.1">Scalability to Larger Systems:</span> Future work will involve testing the model’s ability to generalize to more complex boundary conditions, higher-dimensional PDEs, and larger grids. This includes assessing the model’s behavior when scaling up both spatial resolution and temporal duration.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S5.p4">
<p class="ltx_p" id="S5.p4.1">Additional insight in the workings of the Transformer model can be gained by looking at the weights of the final projection layer for the Transformer output at the end of training. In all three cases, the maximum absolute weight values (not shown here) occur on the Dirichlet boundaries, which is not surprising given that the Dirichlet boundary conditions constitute the main distinguishing feature of each case. A more interesting view, however, is that of the <em class="ltx_emph ltx_font_italic" id="S5.p4.1.1">average</em> of the absolute weight values which gives us a more holistic sense of where the model places emphasis. The average is computed over the latent dimension to create the 2D heatmap, shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#S5.F31" title="Figure 31 ‣ 5 Discussion, Limitations and Insights ‣ Beyond Language: Applying MLX Transformers to Engineering Physics"><span class="ltx_text ltx_ref_tag">31</span></a>. The leftmost panel corresponds to for the base case, the middle panel to those for the Challenge-1 and the rightmost panel for Challenge-2. All there panels correspond to the model trained for block predictions.</p>
</div>
<div class="ltx_para" id="S5.p5">
<p class="ltx_p" id="S5.p5.1">In the base case, on the average the model appears to place more emphasis on the internal nodes in the vicinity of the four domain corners where the effects of different Dirichlet temperatures merge to create regions with more pronounced gradients and variability. In the case of Challenge-1, the model continues to put emphasis in regions of the four domain corners, but places higher emphasis in the interior nodes adjacent to the boundary segments. This reflects the fact the interaction of the random Dirichlet values, which differ from one case to the next, with the segments create regions of variability that the model must be able to capture adequately. Thus, the model has been able to adapt to the localized variability caused by the introduction of the boundary segments. Finally. in the case of Challenge-2, where the two segments with temperatures T=1 and T=0 were randomly placed on separate sides of the plate, the model adapted by focusing on multiple perimetric rings of nodes adjacent to the edges. This adaptation likely enables the model to capture localized temperature variations induced by the random segments. The fact the placement of the segments can be anywhere on the perimeter of the domain has forced the model to place emphasis in concentric rings with weights that decrease from the periphery of the domain towards the center. These findings highlight the model’s sophisticated understanding of boundary conditions and its ability to generalize and adapt to new scenarios, underscoring the potential of Transformer models in solving complex engineering physics problems.</p>
</div>
<figure class="ltx_figure" id="S5.F31"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="180" id="S5.F31.g1" src="extracted/5903850/FIGURES/INSIGHTS/Comparison_of_weights_block2.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F31.2.1.1" style="font-size:90%;">Figure 31</span>: </span><span class="ltx_text" id="S5.F31.3.2" style="font-size:90%;">The average of the absolute weights for the final projection layer of the Transformer model trained for block predictions. The leftmost panel corresponds to the base case, the middle one to Challenge-1 and the rightmost to Challenge-2.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion and Broader Outlook</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work we aimed to offer a gentle introduction to using Transformers to solve Engineering problems, in particular problems that are governed by partial differential equations. The work is addressed to engineers with working understanding of neural networks in general, but with no or limited exposure to Transformers. We have introduced the key concepts of Transformer models in their native context of Natural Language Processing, but where possible have drawn analogies between these features of Transformers and concepts that engineers are familiar with, such as the analogy of the self-attention mechanism to discrete Fourier transforms and of positional embeddings to wavelets. Since the primary mission in this work was to demystify Transformers and allow others to explore their use in Engineering, we have selected the problem of heat conduction in a 2D plate with Dirichlet boundary conditions, and various additional complications, as the playground where to exemplify the process of training a Transformer to predict the temporal evolution of a field variable (in this case the temperature), while capturing long-term temporal and spatial relations. In all of the considered configurations, we have used a completely hidden test set to show that the model achieved excellent performance both in block and autogressive inference mode.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">With the potential of Transformers established, we next plan to explore the performance of this class of NNs in more challenging applications. In particular, we are working on implementing Transformer-augmented subgrid models for use with Large Eddy Simulations of turbulent fluid flows. The motivation is to leverage the inherent ability of transformers to capture long-term temporal and spatial relations, a trademark feature of turbulent flows. The task is markedly more challenging than the simple problem discussed herein, but the potential impact is significant and drives our efforts. We hope to report on our progress soon.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">We hope this work will be useful to others who want to explore the use of Transformers in the engineering applications and towards this end, we have shared the code on GitHub under an MIT license<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib16" title="">16</a>]</cite>. We will keep updating the code as our own experience with Transformers expands and future updates will be reflected on the GitHub distribution.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, Ł., &amp; Polosukhin, I. (2017). Attention is All You Need. <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Advances in Neural Information Processing Systems</span>, 30.
Available at: <a class="ltx_ref ltx_href" href="https://arxiv.org/abs/1706.03762" title="">https://arxiv.org/abs/1706.03762</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Awni Hannunm Jagrit Digani, Angelos Katharopoulos and Ronan Collobert (2023). MLX: Efficient and flexible machine learning on Apple silicon.
GitHub: <a class="ltx_ref ltx_href" href="https://github.com/ml-explore" title="">https://github.com/ml-explore</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Raimi, Karim (2019). Illustrated: Self-Attention: A step-by-step guide to self-attention with illustrations and code. Towards Data Science.
Website: <a class="ltx_ref ltx_href" href="https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a" title="">https://towardsdatascience.com/illustrated-self-attention-2d627e33b20a</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Srijanie, Dey (2024). Deep Dive into Self-Attention by Hand. Towards Data Science.
Website: <a class="ltx_ref ltx_href" href="https://towardsdatascience.com/deep-dive-into-self-attention-by-hand-%EF%B8%8E-f02876e49857" title="">https://towardsdatascience.com/deep-dive-into-self-attention-by-hand-%EF%B8%8E-f02876e49857</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Nikhil Chowdary, Paleti (2024). Positional Encoding Explained: A Deep Dive into Transformer PE.
Website: <a class="ltx_ref ltx_href" href="https://medium.com/thedeephub/positional-encoding-explained-a-deep-dive-into-transformer-pe-65cfe8cfe10b" title="">https://medium.com/thedeephub/positional-encoding-explained-a-deep-dive-into-transformer-pe-65cfe8cfe10b</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Jonathan Kernes (2021). Master Positional Encoding: Part I.
Website: <a class="ltx_ref ltx_href" href="https://towardsdatascience.com/master-positional-encoding-part-i-63c05d90a0c3" title="">https://towardsdatascience.com/master-positional-encoding-part-i-63c05d90a0c3</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Yousif, M. Z., Zhang, M., Yu, L., Vinuesa, R., &amp; Lim, H. (2023). A transformer-based synthetic-inflow generator for spatially developing turbulent boundary layers. <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">J. Fluid Mech.</span>, 957(A6).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Zhao, Z., Ding, X., &amp; Prakash, B. A. (2023). PINNsFormer: A Transformer-based framework for physics-Informed Neural Networks. Available at: <a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2307.11833" title="">https://arxiv.org/abs/2307.11833</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Alexiadis, A., Ghiassi, B (2024). From text to tech: Shaping the future of physics-based simulations with AI-driven generative models. <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Results in Engineering</span>, 21:101721. <a class="ltx_ref ltx_href" href="https://doi.org/10.1016/j.rineng.2023.101721" title="">https://doi.org/10.1016/j.rineng.2023.101721</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Lorsung, C., Li, Z., &amp; Barati Farimani, A. (2024). Physics Informed Token Transformer for Solving Partial Differential Equations. <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Mach. Learn. Sci. Technol.</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Brown, P. C. (2014). Make it stick: The science of successful learning <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">Harvard University Press.</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Fontanella, L., &amp; Ippoliti, L. (2012). Time Series Analysis: Methods and Applications. <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Handbook of Statistics</span>, 30, 497-520.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Li, Z., Meidani, K., &amp; Barati Farimani, A. (2022). Transformer for partial differential equations’ operator learning. Available at: <a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2205.13671" title="">https://arxiv.org/abs/2205.13671</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Alexiadis, A. (2023). A minimalistic approach to physics-informed machine learning using neighbour lists as physics-optimized convolutions for inverse problems involving particle systems. <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">Journal of Computational Physics</span>, 473:111750 <a class="ltx_ref ltx_href" href="https://doi.org/10.1016/j.jcp.2022.111750" title="">https://doi.org/10.1016/j.jcp.2022.111750</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Alexiadis, A. (2024). Designing a set of criteria for evaluating artificial neural networks trained with physics-based data to replicate molecular dynamics and other particle method trajectories. <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">Frontiers in Nanotechnology</span>, 6. <a class="ltx_ref ltx_href" href="https://doi.org/10.3389/fnano.2024.1373316" title="">https://doi.org/10.3389/fnano.2024.1373316</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Kassinos, S.C. &amp; Alexiadis, A. (2024). MLX_BeyondLanguage: Applications of the MLX Machine Learning Framework to Engineering Physics. Available at
GitHub: <a class="ltx_ref ltx_href" href="https://github.com/sck-at-ucy/MLX_BeyondLanguage" title="">https://github.com/sck-at-ucy/MLX_BeyondLanguage</a>, Version 0.0.1.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>The MLX Transformer Class</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">The entire code used in this work is available under an MIT license on GitHub<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04167v1#bib.bib16" title="">16</a>]</cite>. Here, however, we provide the code defining the MLX Transformer class along with the model parameters used in tabular form.</p>
</div>
<div class="ltx_para" id="A1.p2">
<div class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_framed ltx_framed_rectangle ltx_listing" id="A1.p2.1" style="background-color:#BFBFBF;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,aW1wb3J0IG1seC5ubiBhcyBubgppbXBvcnQgbWx4LmNvcmUgYXMgbXgKaW1wb3J0IG1seC5vcHRpbWl6ZXJzIGFzIG9wdGltCgpjbGFzcyBIZWF0RGlmZnVzaW9uTW9kZWwobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBueSwgbngsIHNlcV9sZW4sIG51bV9oZWFkcywgbnVtX2VuY29kZXJfbGF5ZXJzLAogICAgICAgICAgICAgICAgIG1scF9kaW0sIGVtYmVkX2RpbSwgc3RhcnRfcHJlZGljdGluZ19mcm9tLCBtYXNrX3R5cGUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuc2VxX2xlbiA9IHNlcV9sZW4KICAgICAgICBzZWxmLm91dHB1dF9zZXFfbGVuID0gc2VxX2xlbgogICAgICAgIHNlbGYubnkgPSBueQogICAgICAgIHNlbGYubnggPSBueAogICAgICAgIHNlbGYuaW5wdXRfZGltID0gbnkgKiBueAogICAgICAgIHNlbGYuZW1iZWRfZGltID0gZW1iZWRfZGltCiAgICAgICAgc2VsZi5zcGF0aWFsX2ZlYXR1cmVzID0gZW1iZWRfZGltIC8vIDIKICAgICAgICBzZWxmLl9zdGFydF9wcmVkaWN0aW5nX2Zyb20gPSBzdGFydF9wcmVkaWN0aW5nX2Zyb20KICAgICAgICBzZWxmLl9tYXNrX3R5cGUgPSBtYXNrX3R5cGUKCiAgICAgICAgc2VsZi5wcm9qZWN0aW9uX3NwYXRpYWxfZW5jID0gbm4uTGluZWFyKAogICAgICAgICAgICBueSAqIG54ICogc2VsZi5zcGF0aWFsX2ZlYXR1cmVzLCBzZWxmLmVtYmVkX2RpbSkKCiAgICAgICAgc2VsZi5wb3NpdGlvbmFsX2VuY29kaW5nX3kgPSBubi5TaW51c29pZGFsUG9zaXRpb25hbEVuY29kaW5nKAogICAgICAgICAgICBkaW1zPXNlbGYuc3BhdGlhbF9mZWF0dXJlcywgbWF4X2ZyZXE9MSwgY29zX2ZpcnN0PUZhbHNlLAogICAgICAgICAgICBzY2FsZT0oMS4gLyAobnAuc3FydChzZWxmLnNwYXRpYWxfZmVhdHVyZXMgLy8gMikpKSwgZnVsbF90dXJucz1GYWxzZSkKICAgICAgICBzZWxmLnBvc2l0aW9uYWxfZW5jb2RpbmdfeCA9IG5uLlNpbnVzb2lkYWxQb3NpdGlvbmFsRW5jb2RpbmcoCiAgICAgICAgICAgIGRpbXM9c2VsZi5zcGF0aWFsX2ZlYXR1cmVzLCBtYXhfZnJlcT0xLCBjb3NfZmlyc3Q9RmFsc2UsCiAgICAgICAgICAgIHNjYWxlPSgxLiAvIChucC5zcXJ0KHNlbGYuc3BhdGlhbF9mZWF0dXJlcyAvLyAyKSkpLCBmdWxsX3R1cm5zPUZhbHNlKQogICAgICAgIHNlbGYucG9zaXRpb25hbF9lbmNvZGluZ190ID0gbm4uU2ludXNvaWRhbFBvc2l0aW9uYWxFbmNvZGluZygKICAgICAgICAgICAgZGltcz1zZWxmLmVtYmVkX2RpbSwgbWF4X2ZyZXE9MSwKICAgICAgICAgICAgc2NhbGU9KDEuIC8gKG5wLnNxcnQoc2VsZi5lbWJlZF9kaW0vLyAyKSkpLCBmdWxsX3R1cm5zPUZhbHNlKQoKICAgICAgICBzZWxmLnRyYW5zZm9ybWVyX2VuY29kZXIgPSBubi5UcmFuc2Zvcm1lckVuY29kZXIoCiAgICAgICAgICAgIG51bV9sYXllcnM9bnVtX2VuY29kZXJfbGF5ZXJzLCBkaW1zPWVtYmVkX2RpbSwgbnVtX2hlYWRzPW51bV9oZWFkcywKICAgICAgICAgICAgbWxwX2RpbXM9bWxwX2RpbSwgY2hlY2twb2ludD1GYWxzZSkKCiAgICAgICAgc2VsZi5vdXRwdXRfcHJvamVjdGlvbiA9IG5uLkxpbmVhcihlbWJlZF9kaW0sIG55ICogbngpCgogICAgICAgIHNlbGYuZGlmZnVzaXZpdHlfZW1iZWRkaW5nID0gbm4uTGluZWFyKDEsIGVtYmVkX2RpbSkKCiAgICAgICAgc2VsZi5sYXllcl9ub3JtYWxpemVyID0gbm4uTGF5ZXJOb3JtKGRpbXM9ZW1iZWRfZGltKQoKICAgICAgICBpZiBzZWxmLl9tYXNrX3R5cGUgPT0gJ2NhdXNhbCc6CiAgICAgICAgICAgIHNlbGYubWFzayA9IHNlbGYuY3JlYXRlX3NyY19jYXVzYWxfbWFzayhzZWxmLnNlcV9sZW4pCiAgICAgICAgZWxpZiBzZWxmLl9tYXNrX3R5cGUgPT0gJ2Jsb2NrJzoKICAgICAgICAgICAgc2VsZi5tYXNrID0gc2VsZi5jcmVhdGVfc3JjX2Jsb2NrX21hc2soc2VsZi5zZXFfbGVuKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIlVuc3VwcG9ydGVkIG1hc2sgdHlwZSIpCgogICAgZGVmIGNyZWF0ZV9zcmNfYmxvY2tfbWFzayhzZWxmLCBzZXFfbGVuKToKICAgICAgICBtYXNrID0gbXguZnVsbCgoc2VxX2xlbiwgc2VxX2xlbiksIC1teC5pbmYsIGR0eXBlPW14LmZsb2F0MzIpCiAgICAgICAgbWFza1s6LCA6c2VsZi5fc3RhcnRfcHJlZGljdGluZ19mcm9tXSA9IDAKICAgICAgICByZXR1cm4gbWFzawoKICAgIGRlZiBjcmVhdGVfc3JjX2NhdXNhbF9tYXNrKHNlbGYsIHNlcV9sZW4pOgogICAgICAgIG1hc2sgPSBteC50cml1KC1teC5pbmYgKiBteC5vbmVzKChzZXFfbGVuLCBzZXFfbGVuKSksIGs9MCkKICAgICAgICBtYXNrWzosIDpzZWxmLl9zdGFydF9wcmVkaWN0aW5nX2Zyb21dID0gMAogICAgICAgIHJldHVybiBtYXNrCgogICAgZGVmIGNyZWF0ZV90Z3RfY2F1c2FsX21hc2soc2VsZiwgc2VxX2xlbik6CiAgICAgICAgbWFzayA9IG14LnRyaXUoLW14LmluZiAqIG14Lm9uZXMoKHNlcV9sZW4sIHNlcV9sZW4pKSwgaz0wKQogICAgICAgIG1hc2tbOiwgOnNlbGYuX3N0YXJ0X3ByZWRpY3RpbmdfZnJvbV0gPSAwCiAgICAgICAgcmV0dXJuIG1hc2sKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgc3JjLCBhbHBoYSk6CiAgICAgICAgYmF0Y2hfc2l6ZSwgc2VxX2xlbiwgXywgXyA9IHNyYy5zaGFwZQogICAgICAgIHNyY191bmZsYXR0ZW5lZCA9IHNyY1s6LCA6LCA6XQogICAgICAgIHNyY19leHBhbmRlZCA9IG14LmV4cGFuZF9kaW1zKHNyY191bmZsYXR0ZW5lZCwgLTEpCiAgICAgICAgcG9zX2VuY19ueSwgcG9zX2VuY19ueCA9IHNlbGYuc3BhdGlhbF9wb3NpdGlvbmFsX2VuY29kaW5nKHNlbGYubnksIHNlbGYubngpCiAgICAgICAgc3JjX3Bvc19lbmNfeSA9IHNyY19leHBhbmRlZCArIHBvc19lbmNfbnkKICAgICAgICBzcmNfcG9zX2VuYyA9IHNyY19wb3NfZW5jX3kgKyBwb3NfZW5jX254CiAgICAgICAgc3JjX3Bvc19lbmNfZmxhdHRlbmVkID0gc3JjX3Bvc19lbmNbOiwgOiwgOiwgOl0ucmVzaGFwZSgtMSwgc2VxX2xlbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubnkgKiBzZWxmLm54ICogc2VsZi5zcGF0aWFsX2ZlYXR1cmVzKQogICAgICAgIHNyY19wcm9qZWN0ZWQgPSBzZWxmLnByb2plY3Rpb25fc3BhdGlhbF9lbmMoc3JjX3Bvc19lbmNfZmxhdHRlbmVkKQoKICAgICAgICB0ZW1wb3JhbF9lbmMgPSBzZWxmLnRlbXBvcmFsX3Bvc2l0aW9uYWxfZW5jb2Rpbmcoc2VxX2xlbiwgYmF0Y2hfc2l6ZSkKCiAgICAgICAgc3JjX2VuY29kZWQgPSBzcmNfcHJvamVjdGVkICsgdGVtcG9yYWxfZW5jCgogICAgICAgIGFscGhhX3Jlc2hhcGVkID0gYWxwaGEucmVzaGFwZSgtMSwgMSkKICAgICAgICBhbHBoYV9lbWJlZCA9IHNlbGYuZGlmZnVzaXZpdHlfZW1iZWRkaW5nKGFscGhhX3Jlc2hhcGVkKQoKICAgICAgICBhbHBoYV9lbWJlZF9leHBhbmRlZCA9IG14LmV4cGFuZF9kaW1zKGFscGhhX2VtYmVkLCBheGlzPTEpCiAgICAgICAgYWxwaGFfZW1iZWRfZXhwYW5kZWQgPSBteC5icm9hZGNhc3RfdG8oYWxwaGFfZW1iZWRfZXhwYW5kZWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChiYXRjaF9zaXplLCBzZXFfbGVuLCBzZWxmLmVtYmVkX2RpbSkpCgogICAgICAgIHNyY19lbmNvZGVkICs9IGFscGhhX2VtYmVkX2V4cGFuZGVkCgogICAgICAgIGVuY29kZWQgPSBzZWxmLnRyYW5zZm9ybWVyX2VuY29kZXIoc3JjX2VuY29kZWQsIG1hc2s9c2VsZi5tYXNrKQoKICAgICAgICBub3JtYWxpemVkID0gc2VsZi5sYXllcl9ub3JtYWxpemVyKGVuY29kZWQpCgogICAgICAgIG91dHB1dCA9IHNlbGYub3V0cHV0X3Byb2plY3Rpb24obm9ybWFsaXplZCkKCiAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlc2hhcGUoYmF0Y2hfc2l6ZSwgc2VsZi5vdXRwdXRfc2VxX2xlbiwgc2VsZi5ueSwgc2VsZi5ueCkKCiAgICAgICAgcmV0dXJuIG91dHB1dAoKICAgIGRlZiBzcGF0aWFsX3Bvc2l0aW9uYWxfZW5jb2Rpbmcoc2VsZiwgbnksIG54KToKICAgICAgICBueF9lbmNvZGluZyA9IG14LmV4cGFuZF9kaW1zKG14LmV4cGFuZF9kaW1zKG14LmV4cGFuZF9kaW1zKAogICAgICAgICAgICBzZWxmLnBvc2l0aW9uYWxfZW5jb2RpbmdfeChteC5hcmFuZ2Uoc2VsZi5ueCkpLCAwKSwgMCksIDEpCiAgICAgICAgbnlfZW5jb2RpbmcgPSBteC5leHBhbmRfZGltcyhteC5leHBhbmRfZGltcyhteC5leHBhbmRfZGltcygKICAgICAgICAgICAgc2VsZi5wb3NpdGlvbmFsX2VuY29kaW5nX3kobXguYXJhbmdlKHNlbGYubnkpKSwgMCksIDApLCAzKQogICAgICAgIHJldHVybiBueV9lbmNvZGluZywgbnhfZW5jb2RpbmcKCiAgICBkZWYgdGVtcG9yYWxfcG9zaXRpb25hbF9lbmNvZGluZyhzZWxmLCBzZXFfbGVuLCBiYXRjaF9zaXplKToKICAgICAgICB0ZW1wb3JhbF9lbmNvZGluZyA9IG14LmV4cGFuZF9kaW1zKHNlbGYucG9zaXRpb25hbF9lbmNvZGluZ190KG14LmFyYW5nZShzZWxmLnNlcV9sZW4pKSwgYXhpcz0wKQogICAgICAgIHJldHVybiB0ZW1wb3JhbF9lbmNvZGluZwo=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx1">
<span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx1.1" style="font-size:70%;"><span class="ltx_text" id="lstnumberx1.1.1" style="color:#0000FF;">import</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.2" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.3" style="font-size:70%;color:#000000;">mlx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.4" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.5" style="font-size:70%;color:#000000;">nn</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.6" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.7" style="font-size:70%;color:#000000;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.9" style="font-size:70%;color:#000000;">nn</span>
</div>
<div class="ltx_listingline" id="lstnumberx2">
<span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx2.1" style="font-size:70%;"><span class="ltx_text" id="lstnumberx2.1.1" style="color:#0000FF;">import</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.2" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.3" style="font-size:70%;color:#000000;">mlx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.4" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.5" style="font-size:70%;color:#000000;">core</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.6" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.7" style="font-size:70%;color:#000000;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.9" style="font-size:70%;color:#000000;">mx</span>
</div>
<div class="ltx_listingline" id="lstnumberx3">
<span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx3.1" style="font-size:70%;"><span class="ltx_text" id="lstnumberx3.1.1" style="color:#0000FF;">import</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.2" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.3" style="font-size:70%;color:#000000;">mlx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.4" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.5" style="font-size:70%;color:#000000;">optimizers</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.6" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.7" style="font-size:70%;color:#000000;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.9" style="font-size:70%;color:#000000;">optim</span>
</div>
<div class="ltx_listingline" id="lstnumberx4">
</div>
<div class="ltx_listingline" id="lstnumberx5">
<span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx5.1" style="font-size:70%;"><span class="ltx_text" id="lstnumberx5.1.1" style="color:#0000FF;">class</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.2" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.3" style="font-size:70%;color:#000000;">HeatDiffusionModel</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.4" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.5" style="font-size:70%;color:#000000;">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.6" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.7" style="font-size:70%;color:#000000;">Module</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.8" style="font-size:70%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx6">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx6.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx6.2.1" style="color:#0000FF;">def</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.4" style="font-size:70%;color:#000000;">__init__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.5" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.9" style="font-size:70%;color:#000000;">ny</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.10" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.11" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.12" style="font-size:70%;color:#000000;">nx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.13" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.14" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.15" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.16" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.17" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.18" style="font-size:70%;color:#000000;">num_heads</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.19" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.20" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.21" style="font-size:70%;color:#000000;">num_encoder_layers</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.22" style="font-size:70%;">,</span>
</div>
<div class="ltx_listingline" id="lstnumberx7">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.2" style="font-size:70%;color:#000000;">mlp_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.3" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.4" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.5" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.6" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.8" style="font-size:70%;color:#000000;">start_predicting_from</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.9" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.10" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.11" style="font-size:70%;color:#000000;">mask_type</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.12" style="font-size:70%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx8">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx8.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx8.2.1" style="color:#0000FF;">super</span></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.3" style="font-size:70%;">().</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.4" style="font-size:70%;color:#000000;">__init__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.5" style="font-size:70%;">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx9">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.4" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.8" style="font-size:70%;color:#000000;">seq_len</span>
</div>
<div class="ltx_listingline" id="lstnumberx10">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.4" style="font-size:70%;color:#000000;">output_seq_len</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.8" style="font-size:70%;color:#000000;">seq_len</span>
</div>
<div class="ltx_listingline" id="lstnumberx11">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.4" style="font-size:70%;color:#000000;">ny</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.8" style="font-size:70%;color:#000000;">ny</span>
</div>
<div class="ltx_listingline" id="lstnumberx12">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.4" style="font-size:70%;color:#000000;">nx</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.8" style="font-size:70%;color:#000000;">nx</span>
</div>
<div class="ltx_listingline" id="lstnumberx13">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.4" style="font-size:70%;color:#000000;">input_dim</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.8" style="font-size:70%;color:#000000;">ny</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.9" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.10" style="font-size:70%;">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.11" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.12" style="font-size:70%;color:#000000;">nx</span>
</div>
<div class="ltx_listingline" id="lstnumberx14">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.4" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.8" style="font-size:70%;color:#000000;">embed_dim</span>
</div>
<div class="ltx_listingline" id="lstnumberx15">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.4" style="font-size:70%;color:#000000;">spatial_features</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.8" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.9" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.10" style="font-size:70%;">//</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.11" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.12" style="font-size:70%;">2</span>
</div>
<div class="ltx_listingline" id="lstnumberx16">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.4" style="font-size:70%;color:#000000;">_start_predicting_from</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.8" style="font-size:70%;color:#000000;">start_predicting_from</span>
</div>
<div class="ltx_listingline" id="lstnumberx17">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.4" style="font-size:70%;color:#000000;">_mask_type</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.8" style="font-size:70%;color:#000000;">mask_type</span>
</div>
<div class="ltx_listingline" id="lstnumberx18">
</div>
<div class="ltx_listingline" id="lstnumberx19">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.4" style="font-size:70%;color:#000000;">projection_spatial_enc</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.8" style="font-size:70%;color:#000000;">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.10" style="font-size:70%;color:#000000;">Linear</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.11" style="font-size:70%;">(</span>
</div>
<div class="ltx_listingline" id="lstnumberx20">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.2" style="font-size:70%;color:#000000;">ny</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.4" style="font-size:70%;">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.6" style="font-size:70%;color:#000000;">nx</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.7" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.8" style="font-size:70%;">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.9" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.10" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.11" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.12" style="font-size:70%;color:#000000;">spatial_features</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.13" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.14" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.15" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.16" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.17" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.18" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx21">
</div>
<div class="ltx_listingline" id="lstnumberx22">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.4" style="font-size:70%;color:#000000;">positional_encoding_y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.8" style="font-size:70%;color:#000000;">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.10" style="font-size:70%;color:#000000;">SinusoidalPositionalEncoding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.11" style="font-size:70%;">(</span>
</div>
<div class="ltx_listingline" id="lstnumberx23">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.2" style="font-size:70%;color:#000000;">dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.3" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.4" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.5" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.6" style="font-size:70%;color:#000000;">spatial_features</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.9" style="font-size:70%;color:#000000;">max_freq</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.10" style="font-size:70%;">=1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.11" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.12" style="font-size:70%;color:#000000;">cos_first</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.13" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.14" style="font-size:70%;color:#000000;">False</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.15" style="font-size:70%;">,</span>
</div>
<div class="ltx_listingline" id="lstnumberx24">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.2" style="font-size:70%;color:#000000;">scale</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.3" style="font-size:70%;">=(1.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.4" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.5" style="font-size:70%;">/</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.6" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.7" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.8" style="font-size:70%;color:#000000;">np</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.10" style="font-size:70%;color:#000000;">sqrt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.11" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.12" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.13" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.14" style="font-size:70%;color:#000000;">spatial_features</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.15" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.16" style="font-size:70%;">//</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.17" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.18" style="font-size:70%;">2))),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.19" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.20" style="font-size:70%;color:#000000;">full_turns</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.21" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.22" style="font-size:70%;color:#000000;">False</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.23" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx25">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.4" style="font-size:70%;color:#000000;">positional_encoding_x</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.8" style="font-size:70%;color:#000000;">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.10" style="font-size:70%;color:#000000;">SinusoidalPositionalEncoding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.11" style="font-size:70%;">(</span>
</div>
<div class="ltx_listingline" id="lstnumberx26">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.2" style="font-size:70%;color:#000000;">dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.3" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.4" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.5" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.6" style="font-size:70%;color:#000000;">spatial_features</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.9" style="font-size:70%;color:#000000;">max_freq</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.10" style="font-size:70%;">=1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.11" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.12" style="font-size:70%;color:#000000;">cos_first</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.13" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.14" style="font-size:70%;color:#000000;">False</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.15" style="font-size:70%;">,</span>
</div>
<div class="ltx_listingline" id="lstnumberx27">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.2" style="font-size:70%;color:#000000;">scale</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.3" style="font-size:70%;">=(1.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.4" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.5" style="font-size:70%;">/</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.6" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.7" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.8" style="font-size:70%;color:#000000;">np</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.10" style="font-size:70%;color:#000000;">sqrt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.11" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.12" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.13" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.14" style="font-size:70%;color:#000000;">spatial_features</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.15" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.16" style="font-size:70%;">//</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.17" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.18" style="font-size:70%;">2))),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.19" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.20" style="font-size:70%;color:#000000;">full_turns</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.21" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.22" style="font-size:70%;color:#000000;">False</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.23" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx28">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.4" style="font-size:70%;color:#000000;">positional_encoding_t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.8" style="font-size:70%;color:#000000;">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.10" style="font-size:70%;color:#000000;">SinusoidalPositionalEncoding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.11" style="font-size:70%;">(</span>
</div>
<div class="ltx_listingline" id="lstnumberx29">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.2" style="font-size:70%;color:#000000;">dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.3" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.4" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.5" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.6" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.9" style="font-size:70%;color:#000000;">max_freq</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.10" style="font-size:70%;">=1,</span>
</div>
<div class="ltx_listingline" id="lstnumberx30">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.2" style="font-size:70%;color:#000000;">scale</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.3" style="font-size:70%;">=(1.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.4" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.5" style="font-size:70%;">/</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.6" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.7" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.8" style="font-size:70%;color:#000000;">np</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.10" style="font-size:70%;color:#000000;">sqrt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.11" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.12" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.13" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.14" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.15" style="font-size:70%;">//</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.16" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.17" style="font-size:70%;">2))),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.18" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.19" style="font-size:70%;color:#000000;">full_turns</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.20" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.21" style="font-size:70%;color:#000000;">False</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.22" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx31">
</div>
<div class="ltx_listingline" id="lstnumberx32">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.4" style="font-size:70%;color:#000000;">transformer_encoder</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.8" style="font-size:70%;color:#000000;">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.10" style="font-size:70%;color:#000000;">TransformerEncoder</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.11" style="font-size:70%;">(</span>
</div>
<div class="ltx_listingline" id="lstnumberx33">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.2" style="font-size:70%;color:#000000;">num_layers</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.3" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.4" style="font-size:70%;color:#000000;">num_encoder_layers</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.5" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.6" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.7" style="font-size:70%;color:#000000;">dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.8" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.9" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.10" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.11" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.12" style="font-size:70%;color:#000000;">num_heads</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.13" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.14" style="font-size:70%;color:#000000;">num_heads</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.15" style="font-size:70%;">,</span>
</div>
<div class="ltx_listingline" id="lstnumberx34">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.2" style="font-size:70%;color:#000000;">mlp_dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.3" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.4" style="font-size:70%;color:#000000;">mlp_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.5" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.6" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.7" style="font-size:70%;color:#000000;">checkpoint</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.8" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.9" style="font-size:70%;color:#000000;">False</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.10" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx35">
</div>
<div class="ltx_listingline" id="lstnumberx36">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.4" style="font-size:70%;color:#000000;">output_projection</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.8" style="font-size:70%;color:#000000;">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.10" style="font-size:70%;color:#000000;">Linear</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.11" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.12" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.13" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.14" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.15" style="font-size:70%;color:#000000;">ny</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.16" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.17" style="font-size:70%;">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.18" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.19" style="font-size:70%;color:#000000;">nx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.20" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx37">
</div>
<div class="ltx_listingline" id="lstnumberx38">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.4" style="font-size:70%;color:#000000;">diffusivity_embedding</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.8" style="font-size:70%;color:#000000;">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.10" style="font-size:70%;color:#000000;">Linear</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.11" style="font-size:70%;">(1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.12" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.13" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.14" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx39">
</div>
<div class="ltx_listingline" id="lstnumberx40">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.4" style="font-size:70%;color:#000000;">layer_normalizer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.8" style="font-size:70%;color:#000000;">nn</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.10" style="font-size:70%;color:#000000;">LayerNorm</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.11" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.12" style="font-size:70%;color:#000000;">dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.13" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.14" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.15" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx41">
</div>
<div class="ltx_listingline" id="lstnumberx42">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx42.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx42.2.1" style="color:#0000FF;">if</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.4" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx42.5" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.6" style="font-size:70%;color:#000000;">_mask_type</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.7" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx42.8" style="font-size:70%;">==</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.9" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx42.10" style="font-size:70%;color:#FF0000;">’causal’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx42.11" style="font-size:70%;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx43">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.4" style="font-size:70%;color:#000000;">mask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.8" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.10" style="font-size:70%;color:#000000;">create_src_causal_mask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.11" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.12" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.13" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.14" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.15" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx44">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx44.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx44.2.1" style="color:#0000FF;">elif</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.4" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.5" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.6" style="font-size:70%;color:#000000;">_mask_type</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.7" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.8" style="font-size:70%;">==</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.9" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx44.10" style="font-size:70%;color:#FF0000;">’block’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.11" style="font-size:70%;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx45">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.4" style="font-size:70%;color:#000000;">mask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.6" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.8" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.10" style="font-size:70%;color:#000000;">create_src_block_mask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.11" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.12" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.13" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.14" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.15" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx46">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx46.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx46.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx46.2.1" style="color:#0000FF;">else</span></span><span class="ltx_text ltx_font_typewriter" id="lstnumberx46.3" style="font-size:70%;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx47">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx47.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx47.2.1" style="color:#0000FF;">raise</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx47.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx47.4" style="font-size:70%;color:#000000;">ValueError</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.5" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx47.6" style="font-size:70%;color:#FF0000;">"Unsupported<span class="ltx_text ltx_lst_space" id="lstnumberx47.6.1"> </span>mask<span class="ltx_text ltx_lst_space" id="lstnumberx47.6.2"> </span>type"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx47.7" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx48">
</div>
<div class="ltx_listingline" id="lstnumberx49">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx49.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx49.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx49.2.1" style="color:#0000FF;">def</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx49.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx49.4" style="font-size:70%;color:#000000;">create_src_block_mask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx49.5" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx49.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx49.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx49.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx49.9" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx49.10" style="font-size:70%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx50">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.2" style="font-size:70%;color:#000000;">mask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.8" style="font-size:70%;color:#000000;">full</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.9" style="font-size:70%;">((</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.10" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.11" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.12" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.13" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.14" style="font-size:70%;">),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.15" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.16" style="font-size:70%;">-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.17" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.18" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.19" style="font-size:70%;color:#000000;">inf</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.20" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx50.21" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.22" style="font-size:70%;color:#000000;">dtype</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.23" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.24" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.25" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx50.26" style="font-size:70%;color:#000000;">float32</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx50.27" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx51">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.2" style="font-size:70%;color:#000000;">mask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.3" style="font-size:70%;">[:,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.4" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.5" style="font-size:70%;">:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx51.8" style="font-size:70%;color:#000000;">_start_predicting_from</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.9" style="font-size:70%;">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.10" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.11" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx51.12" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx51.13" style="font-size:70%;">0</span>
</div>
<div class="ltx_listingline" id="lstnumberx52">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx52.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx52.2.1" style="color:#0000FF;">return</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx52.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx52.4" style="font-size:70%;color:#000000;">mask</span>
</div>
<div class="ltx_listingline" id="lstnumberx53">
</div>
<div class="ltx_listingline" id="lstnumberx54">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx54.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx54.2.1" style="color:#0000FF;">def</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx54.4" style="font-size:70%;color:#000000;">create_src_causal_mask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx54.5" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx54.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx54.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx54.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx54.9" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx54.10" style="font-size:70%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx55">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.2" style="font-size:70%;color:#000000;">mask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.8" style="font-size:70%;color:#000000;">triu</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.9" style="font-size:70%;">(-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.10" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.11" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.12" style="font-size:70%;color:#000000;">inf</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.13" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.14" style="font-size:70%;">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.15" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.16" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.17" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.18" style="font-size:70%;color:#000000;">ones</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.19" style="font-size:70%;">((</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.20" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.21" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.22" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.23" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.24" style="font-size:70%;">)),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx55.25" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx55.26" style="font-size:70%;color:#000000;">k</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx55.27" style="font-size:70%;">=0)</span>
</div>
<div class="ltx_listingline" id="lstnumberx56">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.2" style="font-size:70%;color:#000000;">mask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.3" style="font-size:70%;">[:,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.4" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.5" style="font-size:70%;">:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx56.8" style="font-size:70%;color:#000000;">_start_predicting_from</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.9" style="font-size:70%;">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.10" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.11" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx56.12" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx56.13" style="font-size:70%;">0</span>
</div>
<div class="ltx_listingline" id="lstnumberx57">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx57.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx57.2.1" style="color:#0000FF;">return</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx57.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx57.4" style="font-size:70%;color:#000000;">mask</span>
</div>
<div class="ltx_listingline" id="lstnumberx58">
</div>
<div class="ltx_listingline" id="lstnumberx59">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx59.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx59.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx59.2.1" style="color:#0000FF;">def</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx59.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx59.4" style="font-size:70%;color:#000000;">create_tgt_causal_mask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx59.5" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx59.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx59.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx59.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx59.9" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx59.10" style="font-size:70%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx60">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.2" style="font-size:70%;color:#000000;">mask</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.8" style="font-size:70%;color:#000000;">triu</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.9" style="font-size:70%;">(-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.10" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.11" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.12" style="font-size:70%;color:#000000;">inf</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.13" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.14" style="font-size:70%;">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.15" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.16" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.17" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.18" style="font-size:70%;color:#000000;">ones</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.19" style="font-size:70%;">((</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.20" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.21" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.22" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.23" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.24" style="font-size:70%;">)),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx60.25" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx60.26" style="font-size:70%;color:#000000;">k</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx60.27" style="font-size:70%;">=0)</span>
</div>
<div class="ltx_listingline" id="lstnumberx61">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx61.2" style="font-size:70%;color:#000000;">mask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.3" style="font-size:70%;">[:,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.4" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.5" style="font-size:70%;">:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx61.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx61.8" style="font-size:70%;color:#000000;">_start_predicting_from</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.9" style="font-size:70%;">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.10" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.11" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx61.12" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx61.13" style="font-size:70%;">0</span>
</div>
<div class="ltx_listingline" id="lstnumberx62">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx62.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx62.2.1" style="color:#0000FF;">return</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx62.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx62.4" style="font-size:70%;color:#000000;">mask</span>
</div>
<div class="ltx_listingline" id="lstnumberx63">
</div>
<div class="ltx_listingline" id="lstnumberx64">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx64.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx64.2.1" style="color:#0000FF;">def</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.4" style="font-size:70%;color:#000000;">__call__</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.5" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.9" style="font-size:70%;color:#000000;">src</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.10" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx64.11" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx64.12" style="font-size:70%;color:#000000;">alpha</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx64.13" style="font-size:70%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx65">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx65.2" style="font-size:70%;color:#000000;">batch_size</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.3" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.4" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx65.5" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.6" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx65.8" style="font-size:70%;color:#000000;">_</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.9" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.10" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx65.11" style="font-size:70%;color:#000000;">_</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.12" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.13" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx65.14" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx65.15" style="font-size:70%;color:#000000;">src</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx65.16" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx65.17" style="font-size:70%;color:#000000;">shape</span>
</div>
<div class="ltx_listingline" id="lstnumberx66">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.2" style="font-size:70%;color:#000000;">src_unflattened</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx66.6" style="font-size:70%;color:#000000;">src</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.7" style="font-size:70%;">[:,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.8" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.9" style="font-size:70%;">:,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx66.10" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx66.11" style="font-size:70%;">:]</span>
</div>
<div class="ltx_listingline" id="lstnumberx67">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx67.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx67.2" style="font-size:70%;color:#000000;">src_expanded</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx67.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx67.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx67.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx67.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx67.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx67.8" style="font-size:70%;color:#000000;">expand_dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx67.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx67.10" style="font-size:70%;color:#000000;">src_unflattened</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx67.11" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx67.12" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx67.13" style="font-size:70%;">-1)</span>
</div>
<div class="ltx_listingline" id="lstnumberx68">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx68.2" style="font-size:70%;color:#000000;">pos_enc_ny</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.3" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.4" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx68.5" style="font-size:70%;color:#000000;">pos_enc_nx</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.6" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.7" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx68.9" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.10" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx68.11" style="font-size:70%;color:#000000;">spatial_positional_encoding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.12" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx68.13" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.14" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx68.15" style="font-size:70%;color:#000000;">ny</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.16" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx68.17" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx68.18" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.19" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx68.20" style="font-size:70%;color:#000000;">nx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx68.21" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx69">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx69.2" style="font-size:70%;color:#000000;">src_pos_enc_y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx69.6" style="font-size:70%;color:#000000;">src_expanded</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.7" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx69.8" style="font-size:70%;">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx69.9" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx69.10" style="font-size:70%;color:#000000;">pos_enc_ny</span>
</div>
<div class="ltx_listingline" id="lstnumberx70">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx70.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx70.2" style="font-size:70%;color:#000000;">src_pos_enc</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx70.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx70.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx70.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx70.6" style="font-size:70%;color:#000000;">src_pos_enc_y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx70.7" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx70.8" style="font-size:70%;">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx70.9" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx70.10" style="font-size:70%;color:#000000;">pos_enc_nx</span>
</div>
<div class="ltx_listingline" id="lstnumberx71">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx71.2" style="font-size:70%;color:#000000;">src_pos_enc_flattened</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx71.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx71.6" style="font-size:70%;color:#000000;">src_pos_enc</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx71.7" style="font-size:70%;">[:,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.8" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx71.9" style="font-size:70%;">:,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.10" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx71.11" style="font-size:70%;">:,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.12" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx71.13" style="font-size:70%;">:].</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx71.14" style="font-size:70%;color:#000000;">reshape</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx71.15" style="font-size:70%;">(-1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx71.16" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx71.17" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx71.18" style="font-size:70%;">,</span>
</div>
<div class="ltx_listingline" id="lstnumberx72">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.4" style="font-size:70%;color:#000000;">ny</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.6" style="font-size:70%;">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.7" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.8" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.9" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.10" style="font-size:70%;color:#000000;">nx</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.11" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.12" style="font-size:70%;">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx72.13" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.14" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.15" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx72.16" style="font-size:70%;color:#000000;">spatial_features</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx72.17" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx73">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.2" style="font-size:70%;color:#000000;">src_projected</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx73.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.8" style="font-size:70%;color:#000000;">projection_spatial_enc</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx73.10" style="font-size:70%;color:#000000;">src_pos_enc_flattened</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx73.11" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx74">
</div>
<div class="ltx_listingline" id="lstnumberx75">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.2" style="font-size:70%;color:#000000;">temporal_enc</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.8" style="font-size:70%;color:#000000;">temporal_positional_encoding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.10" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.11" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx75.12" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx75.13" style="font-size:70%;color:#000000;">batch_size</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx75.14" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx76">
</div>
<div class="ltx_listingline" id="lstnumberx77">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx77.2" style="font-size:70%;color:#000000;">src_encoded</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx77.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx77.6" style="font-size:70%;color:#000000;">src_projected</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.7" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx77.8" style="font-size:70%;">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx77.9" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx77.10" style="font-size:70%;color:#000000;">temporal_enc</span>
</div>
<div class="ltx_listingline" id="lstnumberx78">
</div>
<div class="ltx_listingline" id="lstnumberx79">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx79.2" style="font-size:70%;color:#000000;">alpha_reshaped</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx79.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx79.6" style="font-size:70%;color:#000000;">alpha</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx79.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx79.8" style="font-size:70%;color:#000000;">reshape</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx79.9" style="font-size:70%;">(-1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx79.10" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx79.11" style="font-size:70%;">1)</span>
</div>
<div class="ltx_listingline" id="lstnumberx80">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.2" style="font-size:70%;color:#000000;">alpha_embed</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx80.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.8" style="font-size:70%;color:#000000;">diffusivity_embedding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx80.10" style="font-size:70%;color:#000000;">alpha_reshaped</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx80.11" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx81">
</div>
<div class="ltx_listingline" id="lstnumberx82">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.2" style="font-size:70%;color:#000000;">alpha_embed_expanded</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx82.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx82.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.8" style="font-size:70%;color:#000000;">expand_dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx82.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.10" style="font-size:70%;color:#000000;">alpha_embed</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx82.11" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx82.12" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx82.13" style="font-size:70%;color:#000000;">axis</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx82.14" style="font-size:70%;">=1)</span>
</div>
<div class="ltx_listingline" id="lstnumberx83">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.2" style="font-size:70%;color:#000000;">alpha_embed_expanded</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx83.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx83.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx83.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.8" style="font-size:70%;color:#000000;">broadcast_to</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx83.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx83.10" style="font-size:70%;color:#000000;">alpha_embed_expanded</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx83.11" style="font-size:70%;">,</span>
</div>
<div class="ltx_listingline" id="lstnumberx84">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx84.1" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx84.2" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx84.3" style="font-size:70%;color:#000000;">batch_size</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx84.4" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx84.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx84.6" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx84.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx84.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx84.9" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx84.10" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx84.11" style="font-size:70%;color:#000000;">embed_dim</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx84.12" style="font-size:70%;">))</span>
</div>
<div class="ltx_listingline" id="lstnumberx85">
</div>
<div class="ltx_listingline" id="lstnumberx86">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.2" style="font-size:70%;color:#000000;">src_encoded</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx86.4" style="font-size:70%;">+=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx86.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx86.6" style="font-size:70%;color:#000000;">alpha_embed_expanded</span>
</div>
<div class="ltx_listingline" id="lstnumberx87">
</div>
<div class="ltx_listingline" id="lstnumberx88">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.2" style="font-size:70%;color:#000000;">encoded</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.8" style="font-size:70%;color:#000000;">transformer_encoder</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.10" style="font-size:70%;color:#000000;">src_encoded</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.11" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx88.12" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.13" style="font-size:70%;color:#000000;">mask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.14" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.15" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.16" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx88.17" style="font-size:70%;color:#000000;">mask</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx88.18" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx89">
</div>
<div class="ltx_listingline" id="lstnumberx90">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx90.2" style="font-size:70%;color:#000000;">normalized</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx90.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx90.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx90.8" style="font-size:70%;color:#000000;">layer_normalizer</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx90.10" style="font-size:70%;color:#000000;">encoded</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx90.11" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx91">
</div>
<div class="ltx_listingline" id="lstnumberx92">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.2" style="font-size:70%;color:#000000;">output</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx92.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.8" style="font-size:70%;color:#000000;">output_projection</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx92.10" style="font-size:70%;color:#000000;">normalized</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx92.11" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx93">
</div>
<div class="ltx_listingline" id="lstnumberx94">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.2" style="font-size:70%;color:#000000;">output</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.6" style="font-size:70%;color:#000000;">output</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.8" style="font-size:70%;color:#000000;">reshape</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.10" style="font-size:70%;color:#000000;">batch_size</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.11" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.12" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.13" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.14" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.15" style="font-size:70%;color:#000000;">output_seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.16" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.17" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.18" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.19" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.20" style="font-size:70%;color:#000000;">ny</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.21" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx94.22" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.23" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.24" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx94.25" style="font-size:70%;color:#000000;">nx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx94.26" style="font-size:70%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx95">
</div>
<div class="ltx_listingline" id="lstnumberx96">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx96.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx96.2.1" style="color:#0000FF;">return</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx96.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx96.4" style="font-size:70%;color:#000000;">output</span>
</div>
<div class="ltx_listingline" id="lstnumberx97">
</div>
<div class="ltx_listingline" id="lstnumberx98">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx98.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx98.2.1" style="color:#0000FF;">def</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.4" style="font-size:70%;color:#000000;">spatial_positional_encoding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.5" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.9" style="font-size:70%;color:#000000;">ny</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.10" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx98.11" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx98.12" style="font-size:70%;color:#000000;">nx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx98.13" style="font-size:70%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx99">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.2" style="font-size:70%;color:#000000;">nx_encoding</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx99.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.8" style="font-size:70%;color:#000000;">expand_dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.10" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.11" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.12" style="font-size:70%;color:#000000;">expand_dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.13" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.14" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.15" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx99.16" style="font-size:70%;color:#000000;">expand_dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx99.17" style="font-size:70%;">(</span>
</div>
<div class="ltx_listingline" id="lstnumberx100">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.4" style="font-size:70%;color:#000000;">positional_encoding_x</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.5" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.8" style="font-size:70%;color:#000000;">arange</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.10" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.11" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx100.12" style="font-size:70%;color:#000000;">nx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.13" style="font-size:70%;">)),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.14" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.15" style="font-size:70%;">0),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.16" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.17" style="font-size:70%;">0),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx100.18" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx100.19" style="font-size:70%;">1)</span>
</div>
<div class="ltx_listingline" id="lstnumberx101">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.2" style="font-size:70%;color:#000000;">ny_encoding</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx101.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.8" style="font-size:70%;color:#000000;">expand_dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.10" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.11" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.12" style="font-size:70%;color:#000000;">expand_dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.13" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.14" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.15" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx101.16" style="font-size:70%;color:#000000;">expand_dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx101.17" style="font-size:70%;">(</span>
</div>
<div class="ltx_listingline" id="lstnumberx102">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.2" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.3" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.4" style="font-size:70%;color:#000000;">positional_encoding_y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.5" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.8" style="font-size:70%;color:#000000;">arange</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.10" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.11" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx102.12" style="font-size:70%;color:#000000;">ny</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.13" style="font-size:70%;">)),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.14" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.15" style="font-size:70%;">0),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.16" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.17" style="font-size:70%;">0),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx102.18" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx102.19" style="font-size:70%;">3)</span>
</div>
<div class="ltx_listingline" id="lstnumberx103">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx103.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx103.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx103.2.1" style="color:#0000FF;">return</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx103.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx103.4" style="font-size:70%;color:#000000;">ny_encoding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx103.5" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx103.6" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx103.7" style="font-size:70%;color:#000000;">nx_encoding</span>
</div>
<div class="ltx_listingline" id="lstnumberx104">
</div>
<div class="ltx_listingline" id="lstnumberx105">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx105.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx105.2.1" style="color:#0000FF;">def</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.4" style="font-size:70%;color:#000000;">temporal_positional_encoding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.5" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.6" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.7" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.8" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.9" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.10" style="font-size:70%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx105.11" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx105.12" style="font-size:70%;color:#000000;">batch_size</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx105.13" style="font-size:70%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx106">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx106.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.2" style="font-size:70%;color:#000000;">temporal_encoding</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx106.3" style="font-size:70%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.4" style="font-size:70%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx106.5" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.6" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.7" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.8" style="font-size:70%;color:#000000;">expand_dims</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.9" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.10" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.11" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.12" style="font-size:70%;color:#000000;">positional_encoding_t</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.13" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.14" style="font-size:70%;color:#000000;">mx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.15" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.16" style="font-size:70%;color:#000000;">arange</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.17" style="font-size:70%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.18" style="font-size:70%;color:#000000;">self</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.19" style="font-size:70%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.20" style="font-size:70%;color:#000000;">seq_len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.21" style="font-size:70%;">)),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx106.22" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx106.23" style="font-size:70%;color:#000000;">axis</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx106.24" style="font-size:70%;">=0)</span>
</div>
<div class="ltx_listingline" id="lstnumberx107">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.1" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx107.2" style="font-size:70%;"><span class="ltx_text" id="lstnumberx107.2.1" style="color:#0000FF;">return</span></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx107.3" style="font-size:70%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx107.4" style="font-size:70%;color:#000000;">temporal_encoding</span>
</div>
</div>
</div>
<figure class="ltx_table" id="A1.T1">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T1.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T1.2.1.1">
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.2.1.1.1" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.1.1.1.1">
<span class="ltx_p" id="A1.T1.2.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.T1.2.1.1.1.1.1.1">Parameter Name</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T1.2.1.1.2" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.1.1.2.1">
<span class="ltx_p" id="A1.T1.2.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="A1.T1.2.1.1.2.1.1.1">Role/Explanation</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T1.2.1.1.3" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.1.1.3.1">
<span class="ltx_p" id="A1.T1.2.1.1.3.1.1"><span class="ltx_text ltx_font_bold" id="A1.T1.2.1.1.3.1.1.1">Base, Ch-1</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T1.2.1.1.4" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.1.1.4.1">
<span class="ltx_p" id="A1.T1.2.1.1.4.1.1"><span class="ltx_text ltx_font_bold" id="A1.T1.2.1.1.4.1.1.1">Ch-2</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T1.2.2.1">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.2.2.1.1" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.2.1.1.1">
<span class="ltx_p" id="A1.T1.2.2.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.T1.2.2.1.1.1.1.1">start_predicting_from</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.2.1.2" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.2.1.2.1">
<span class="ltx_p" id="A1.T1.2.2.1.2.1.1">Defines the time step to start making predictions</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.2.1.3" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.2.1.3.1">
<span class="ltx_p" id="A1.T1.2.2.1.3.1.1">5</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.2.1.4" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.2.1.4.1">
<span class="ltx_p" id="A1.T1.2.2.1.4.1.1">5</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.3.2">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.2.3.2.1" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.3.2.1.1">
<span class="ltx_p" id="A1.T1.2.3.2.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.T1.2.3.2.1.1.1.1">batch_size</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.3.2.2" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.3.2.2.1">
<span class="ltx_p" id="A1.T1.2.3.2.2.1.1">The number of samples processed before model parameter updates</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.3.2.3" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.3.2.3.1">
<span class="ltx_p" id="A1.T1.2.3.2.3.1.1">4</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.3.2.4" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.3.2.4.1">
<span class="ltx_p" id="A1.T1.2.3.2.4.1.1">4</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.4.3">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.2.4.3.1" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.4.3.1.1">
<span class="ltx_p" id="A1.T1.2.4.3.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.T1.2.4.3.1.1.1.1">epochs</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.4.3.2" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.4.3.2.1">
<span class="ltx_p" id="A1.T1.2.4.3.2.1.1">Number of times the model goes through the entire dataset</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.4.3.3" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.4.3.3.1">
<span class="ltx_p" id="A1.T1.2.4.3.3.1.1">100</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.4.3.4" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.4.3.4.1">
<span class="ltx_p" id="A1.T1.2.4.3.4.1.1">300</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.5.4">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.2.5.4.1" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.5.4.1.1">
<span class="ltx_p" id="A1.T1.2.5.4.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.T1.2.5.4.1.1.1.1">seq_len</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.5.4.2" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.5.4.2.1">
<span class="ltx_p" id="A1.T1.2.5.4.2.1.1">Length of the input sequence for each sample</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.5.4.3" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.5.4.3.1">
<span class="ltx_p" id="A1.T1.2.5.4.3.1.1">401</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.5.4.4" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.5.4.4.1">
<span class="ltx_p" id="A1.T1.2.5.4.4.1.1">401</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.6.5">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.2.6.5.1" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.6.5.1.1">
<span class="ltx_p" id="A1.T1.2.6.5.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.T1.2.6.5.1.1.1.1">num_heads</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.6.5.2" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.6.5.2.1">
<span class="ltx_p" id="A1.T1.2.6.5.2.1.1">Number of attention heads in the multi-head attention mechanism</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.6.5.3" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.6.5.3.1">
<span class="ltx_p" id="A1.T1.2.6.5.3.1.1">16</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.6.5.4" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.6.5.4.1">
<span class="ltx_p" id="A1.T1.2.6.5.4.1.1">16</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.7.6">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.2.7.6.1" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.7.6.1.1">
<span class="ltx_p" id="A1.T1.2.7.6.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.T1.2.7.6.1.1.1.1">num_encoder_layers</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.7.6.2" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.7.6.2.1">
<span class="ltx_p" id="A1.T1.2.7.6.2.1.1">Number of encoder layers in the transformer</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.7.6.3" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.7.6.3.1">
<span class="ltx_p" id="A1.T1.2.7.6.3.1.1">12</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.7.6.4" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.7.6.4.1">
<span class="ltx_p" id="A1.T1.2.7.6.4.1.1">24</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.8.7">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.2.8.7.1" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.8.7.1.1">
<span class="ltx_p" id="A1.T1.2.8.7.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.T1.2.8.7.1.1.1.1">mlp_dim</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.8.7.2" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.8.7.2.1">
<span class="ltx_p" id="A1.T1.2.8.7.2.1.1">Size of the hidden layer in the feedforward network of the transformer block</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.8.7.3" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.8.7.3.1">
<span class="ltx_p" id="A1.T1.2.8.7.3.1.1">256</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.8.7.4" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.8.7.4.1">
<span class="ltx_p" id="A1.T1.2.8.7.4.1.1">256</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.9.8">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.2.9.8.1" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.9.8.1.1">
<span class="ltx_p" id="A1.T1.2.9.8.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.T1.2.9.8.1.1.1.1">embed_dim</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.9.8.2" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.9.8.2.1">
<span class="ltx_p" id="A1.T1.2.9.8.2.1.1">Dimensionality of the input and output embeddings</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.9.8.3" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.9.8.3.1">
<span class="ltx_p" id="A1.T1.2.9.8.3.1.1">512</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_r ltx_border_t" id="A1.T1.2.9.8.4" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.9.8.4.1">
<span class="ltx_p" id="A1.T1.2.9.8.4.1.1">512</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.10.9">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T1.2.10.9.1" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.10.9.1.1">
<span class="ltx_p" id="A1.T1.2.10.9.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.T1.2.10.9.1.1.1.1">mask_type</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_b ltx_border_r ltx_border_t" id="A1.T1.2.10.9.2" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.10.9.2.1">
<span class="ltx_p" id="A1.T1.2.10.9.2.1.1">Type of attention masking applied to control which parts of the sequence the model should focus on</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_b ltx_border_r ltx_border_t" id="A1.T1.2.10.9.3" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.10.9.3.1">
<span class="ltx_p" id="A1.T1.2.10.9.3.1.1">block or causal</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_b ltx_border_r ltx_border_t" id="A1.T1.2.10.9.4" style="width:34.1pt;">
<span class="ltx_inline-block ltx_align_top" id="A1.T1.2.10.9.4.1">
<span class="ltx_p" id="A1.T1.2.10.9.4.1.1">block or causal</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T1.3.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="A1.T1.4.2" style="font-size:90%;">Comparison of Parameters for Base, Challenge-1 (Ch-1) and Challenge-2 (Ch-2) Cases.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Oct  5 14:01:28 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
