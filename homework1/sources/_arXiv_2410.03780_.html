<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Reward-RAG: Enhancing RAG with Reward Driven Supervision</title>
<!--Generated on Thu Oct  3 15:27:09 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03780v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S1" title="In Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S2" title="In Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3" title="In Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3.SS1" title="In 3 Methodology â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Dense Retrieval in RAG</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3.SS2" title="In 3 Methodology â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>User Preference Alignment using a Reward Model</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3.SS2.SSS1" title="In 3.2 User Preference Alignment using a Reward Model â€£ 3 Methodology â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Reward Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3.SS2.SSS2" title="In 3.2 User Preference Alignment using a Reward Model â€£ 3 Methodology â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Collecting LLMsâ€™ feedback</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3.SS3" title="In 3 Methodology â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Fine-tuning Retrieval Model</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4" title="In Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.SS1" title="In 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Main Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.SS1.SSS1" title="In 4.1 Main Experiments â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Experiments Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.SS1.SSS2" title="In 4.1 Main Experiments â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.SS2" title="In 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Domain Specific RAG Tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.SS3" title="In 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Studies</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.SS3.SSS1" title="In 4.3 Ablation Studies â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Compare Feedback From Different LLMs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.SS3.SSS2" title="In 4.3 Ablation Studies â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Prompts For Feedback Collection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.SS3.SSS3" title="In 4.3 Ablation Studies â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.3 </span>Case Study</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S5" title="In Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#A1" title="In Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Training Hyperparameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#A2" title="In Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Prompt Formats</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#A2.SS1" title="In Appendix B Prompt Formats â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Feedback Collection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#A2.SS2" title="In Appendix B Prompt Formats â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Question Answering</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Reward-RAG: Enhancing RAG with Reward Driven Supervision</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Thang Nguyen &amp; Peter Chin &amp; Yu-Wing Tai 
<br class="ltx_break"/>Dartmouth College
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">{thangnv.th, peter.chin, yu-wing.tai}@dartmouth.edu</span>
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">In this paper, we introduce Reward-RAG, a novel approach designed to enhance the Retrieval-Augmented Generation (RAG) model through Reward-Driven Supervision. Unlike previous RAG methodologies, which focus on training language models (LMs) to utilize external knowledge retrieved from external sources, our method adapts retrieval information to specific domains by employing CriticGPT to train a dedicated reward model. This reward model generates synthesized datasets for fine-tuning the RAG encoder, aligning its outputs more closely with human preferences. The versatility of our approach allows it to be effectively applied across various domains through domain-specific fine-tuning. We evaluate Reward-RAG on publicly available benchmarks from multiple domains, comparing it to state-of-the-art methods. Our experimental results demonstrate significant improvements in performance, highlighting the effectiveness of Reward-RAG in improving the relevance and quality of generated responses. These findings underscore the potential of integrating reward models with RAG to achieve superior outcomes in natural language generation tasks.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recent advancements in natural language processing have spurred the development of Retrieval-Augmented Generation (RAG) models, aimed at enhancing the quality and relevance of generated text by integrating external knowledge sources <cite class="ltx_cite ltx_citemacro_citep">(Lewis etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib49" title="">2020</a>; Guu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib23" title="">2020</a>; Izacard &amp; Grave, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib32" title="">2021</a>; Lin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib54" title="">2024</a>)</cite>. These models leverage retrieved documents to provide contextually grounded responses, addressing inherent limitations in Large Language Models (LLMs) such as domain specificity <cite class="ltx_cite ltx_citemacro_citep">(Siriwardhana etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib83" title="">2023</a>; Xiong etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib100" title="">2024</a>)</cite>, and knowledge accuracy <cite class="ltx_cite ltx_citemacro_citep">(Zhang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib105" title="">2023</a>; Kasai etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib44" title="">2023</a>)</cite>. In general, a retrieval system <cite class="ltx_cite ltx_citemacro_citep">(Formal etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib17" title="">2022</a>; Izacard etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib33" title="">2022</a>; Wang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib94" title="">2022a</a>)</cite> first retrieves top-<math alttext="k" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><mi id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><ci id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">italic_k</annotation></semantics></math> related documents for a question from an external database, then LLMs read the question and these documents to generate an answer.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The alignment between generated text and human preference remains a significant challenge for RAG approaches, particularly evident in question-answering tasks. Retrieval mechanisms often struggle to retrieve relevant information essential for specific queries <cite class="ltx_cite ltx_citemacro_citep">(Zhang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib106" title="">2024</a>)</cite>. State-of-the-art retrieval models can be categorized into dense retrieval and sparse retrieval <cite class="ltx_cite ltx_citemacro_citep">(Luan etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib58" title="">2021</a>)</cite>. Sparse retrieval uses a sparse vector to represent statistical feature based on a vocabulary <cite class="ltx_cite ltx_citemacro_citep">(Jones, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib40" title="">1972</a>; Robertson &amp; Zaragoza, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib78" title="">2009</a>)</cite> which may fail to capture high level semantics, and suffer from the lexical gap <cite class="ltx_cite ltx_citemacro_citep">(Berger etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib4" title="">2000</a>; Izacard etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib33" title="">2022</a>)</cite>. On the other hand, dense retrieval leverages a pre-trained language model (PLM) to represent the input sequence by a fixed length vector <cite class="ltx_cite ltx_citemacro_citep">(Reimers &amp; Gurevych, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib77" title="">2019</a>; Karpukhin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib43" title="">2020</a>)</cite> which may fail in specialized domains or with outdated data. Moreover, while PLMs excel in managing long-context windows<cite class="ltx_cite ltx_citemacro_citep">(Su etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib85" title="">2024</a>; Zhu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib110" title="">2024</a>; Ding etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib15" title="">2024</a>)</cite>, challenges arise with excessive retrieval context <cite class="ltx_cite ltx_citemacro_citep">(Xu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib102" title="">2024b</a>; Liu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib55" title="">2024a</a>)</cite>. Consequently, conventional retrieval pipelines typically adopt a two-stage process involving initial document retrieval followed by re-ranking <cite class="ltx_cite ltx_citemacro_citep">(Chen etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib8" title="">2020</a>; Glass etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib21" title="">2022</a>; Ma etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib59" title="">2024</a>)</cite>. With these retrieval mechanisms, achieving a high recall rate is crucial for the success of a RAG system, and improving the systemâ€™s ability to understand human preferences would indisputably elevate the relevance and quality of generated responses.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Based on the above discussions, we posit that achieving high recall with a concise list of pertinent context is crucial for developing RAG systems aligned with human preferences. Inspired by the success of Reinforcement Learning from Human Feedback (RLHF) in aligning large language models (LLMs) with human preferences <cite class="ltx_cite ltx_citemacro_citep">(Bai etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib3" title="">2022</a>; Ouyang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib67" title="">2022</a>)</cite>, we investigate its potential to adapt retrieval systems with a new reward model. Our proposed method, Reward-RAG, integrates reinforcement learning to augment RAG capabilities. Reward-RAG initiates by establishing reward models based on feedback indicating document relevance for specific queries. Since collecting human feedback is time-consuming and cost ineffective, we propose to utilize a CriticGPT to measure the relevance of retrieved documents and queries. CriticGPT is instructed to emulate human preferences using a small set of human preference examples. Leveraging these models, we fine-tune existing retrieval models within the RAG framework to retrieve high-quality content from external corpora. This approach aims to bridge the gap between general retrieval capabilities and the specific requirements of user preferences, thereby enhancing the relevance and quality of generated responses.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Our contribution can be summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose Reward-RAG, a novel method that aligning RAG with human preferences by integrating a reward model into conventional RAG framework.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose to utilize a CriticGPT in conjunction with human feedback which significantly reduce the amount of human preference data for training.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conduct experiments in different domains, compare our method with strong baselines in wide range RAG tasks as well as analyzing different aspects of our method to demonstrate the effectiveness including aligning RAG with new domains.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related works</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Large Language Models (LLMs)</span> has spurred significant advancements over the past few years. Beginning with GPT-1 <cite class="ltx_cite ltx_citemacro_citep">(Radford etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib70" title="">2018</a>)</cite> on the Transformer architecture <cite class="ltx_cite ltx_citemacro_citep">(Vaswani etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib92" title="">2017</a>)</cite>, subsequent models like GPT-2 <cite class="ltx_cite ltx_citemacro_citep">(Radford etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib71" title="">2019</a>)</cite>, GPT-3 <cite class="ltx_cite ltx_citemacro_citep">(Brown etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib7" title="">2020</a>)</cite>, and the latest GPT-4 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib66" title="">2024</a>)</cite> have significantly enhance capabilities in text understanding and generation. Beyond the GPT series, models such as Mistral <cite class="ltx_cite ltx_citemacro_citep">(Jiang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib35" title="">2023</a>)</cite>, Gemini <cite class="ltx_cite ltx_citemacro_citep">(GeminiÂ Team, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib20" title="">2023</a>)</cite>, and LLaMA (<cite class="ltx_cite ltx_citemacro_citep">(Touvron etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib88" title="">2023a</a>)</cite>, <cite class="ltx_cite ltx_citemacro_citet">Touvron etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib89" title="">2023b</a>)</cite>) demonstrate robust performance across various tasks like question-answering and entity recognition <cite class="ltx_cite ltx_citemacro_citep">(Zhao etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib107" title="">2023</a>)</cite>. Training LLMs involves unsupervised pre-training, supervised fine-tuning, and alignment with human feedback, yet challenges persist in domain-specific tasks <cite class="ltx_cite ltx_citemacro_citep">(Kandpal etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib42" title="">2023</a>)</cite>. Techniques like PEFT <cite class="ltx_cite ltx_citemacro_citep">(Houlsby etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib27" title="">2019a</a>)</cite> optimize fine-tuning efficiency, with emerging methods such as prompt-based learning <cite class="ltx_cite ltx_citemacro_citep">(Lester etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib48" title="">2021</a>; Li &amp; Liang, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib50" title="">2021</a>)</cite>, adapters <cite class="ltx_cite ltx_citemacro_citep">(Houlsby etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib28" title="">2019b</a>; Fu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib18" title="">2021</a>; Wang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib96" title="">2022c</a>; He etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib25" title="">2022</a>)</cite>, and reparameterization <cite class="ltx_cite ltx_citemacro_citep">(Hu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib29" title="">2022</a>; Edalati etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib16" title="">2022</a>; Dettmers etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib13" title="">2023</a>)</cite> showing promise by focusing on selective parameter adjustment for enhanced performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Retrieval-Augmented Generation (RAG)</span> enhances LLM performance by expanding input with pertinent texts <cite class="ltx_cite ltx_citemacro_citep">(Lewis etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib49" title="">2020</a>; Guu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib23" title="">2020</a>)</cite>. It integrates external database insights but faces key challenges: determining what, when, and how to retrieve documents <cite class="ltx_cite ltx_citemacro_citep">(Gao etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib19" title="">2024</a>)</cite>. <cite class="ltx_cite ltx_citemacro_citet">Khandelwal etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib45" title="">2020</a>); Ram etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib74" title="">2023</a>)</cite> study how to incorporate retrieval information into next token prediction pipeline. <cite class="ltx_cite ltx_citemacro_citet">Guu etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib23" title="">2020</a>); Borgeaud etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib6" title="">2022</a>); Izacard etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib34" title="">2023</a>); Zhang etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib106" title="">2024</a>)</cite> propose an end-to-end training pipeline to fine-tuning existing LLMs to adapt with retrieval information. <cite class="ltx_cite ltx_citemacro_citet">Chen etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib9" title="">2023a</a>); Sarthi etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib79" title="">2024</a>)</cite> analyze different types of knowledge representation in RAG. Methods like <cite class="ltx_cite ltx_citemacro_citet">Dai etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib11" title="">2023</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Zhang etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib105" title="">2023</a>)</cite> adjust retrieval models via contrastive learning and supervised fine-tuning, reliant on extensive datasets, posing scalability issues <cite class="ltx_cite ltx_citemacro_citep">(Shi etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib81" title="">2024</a>)</cite>. <cite class="ltx_cite ltx_citemacro_citet">GutiÃ©rrez etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib22" title="">2024</a>)</cite> introduces HippoRAG, a neurobiologically inspired retrieval system, by using knowledge graph to represent information as well as retrieve related passages. Combining RAG with RLHF is a promising direction, with <cite class="ltx_cite ltx_citemacro_citet">Shinn etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib82" title="">2023</a>)</cite> proposing episodic memory reinforcement, and <cite class="ltx_cite ltx_citemacro_citep">(Kulkarni etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib46" title="">2024</a>)</cite> proposing to train a policy agent to reduce the number of retrieval.
<cite class="ltx_cite ltx_citemacro_citet">Menick etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib60" title="">2022</a>)</cite> leverage RLHF to train LLMs to generate answers with citing evidences from related documents for their claims. <cite class="ltx_cite ltx_citemacro_citet">Asai etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib2" title="">2024</a>)</cite> add special tokens to adaptively retrieve passages as well as generate and reflect on retrieved passages and its own generations, fine-tune their LLMs using an additional critic model. <cite class="ltx_cite ltx_citemacro_citet">Zhou etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib109" title="">2023</a>)</cite> refine models via reinforcement learning, but their reliance on LLMsâ€™ outputs complicates cost-efficiency. Our work focus on employing a reward model to enhance retrieval quality, specifically aiming to improve relevance and align with human preferences.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Reinforcement Learning from Human Feedback (RLHF)</span> aligns LLMs with human values to mitigate biases and inaccuracies like hallucinations <cite class="ltx_cite ltx_citemacro_citep">(Huang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib31" title="">2023</a>; Rauh etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib76" title="">2022</a>)</cite>. The first RLHF approach is RL-based, involving training reward models with preference datasets and fine-tuning policy models via algorithms like proximal policy optimization <cite class="ltx_cite ltx_citemacro_citep">(Ouyang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib67" title="">2022</a>; Biderman etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib5" title="">2023</a>; Schulman etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib80" title="">2017</a>; Stiennon etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib84" title="">2020</a>)</cite>. The second method, Direct Preference Optimization (DPO), optimizes LLMs directly through supervised learning, sharing the RL-based approachâ€™s objective function <cite class="ltx_cite ltx_citemacro_citep">(Rafailov etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib72" title="">2023</a>; Morimura etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib62" title="">2024</a>; Zeng etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib104" title="">2024</a>)</cite>. Reinforcement learning from AI feedback (RLAIF) is an attractive topic where LLMs are used to evaluate and guide the learning of other systems. <cite class="ltx_cite ltx_citemacro_citet">Zheng etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib108" title="">2024</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Thomas etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib86" title="">2024</a>)</cite> evaluate the alignment between AI feedback and human feedback in multiple scenarios. Our work introduces a novel approach using a reward model and CriticGPT to enhance retrieval-augmented generation.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="268" id="S3.F1.1.g1" src="x1.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S3.F1.7.1">Overview of our Reward-RAG</span>. Given a query and its knowledge database, a retrieval model is used to retrieve the top-<math alttext="k" class="ltx_Math" display="inline" id="S3.F1.4.m1.1"><semantics id="S3.F1.4.m1.1b"><mi id="S3.F1.4.m1.1.1" xref="S3.F1.4.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.F1.4.m1.1c"><ci id="S3.F1.4.m1.1.1.cmml" xref="S3.F1.4.m1.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.4.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="S3.F1.4.m1.1e">italic_k</annotation></semantics></math> relevant documents, which then are rated for the relevance by a CriticGPT. These <math alttext="\langle query,\,document\rangle" class="ltx_Math" display="inline" id="S3.F1.5.m2.2"><semantics id="S3.F1.5.m2.2b"><mrow id="S3.F1.5.m2.2.2.2" xref="S3.F1.5.m2.2.2.3.cmml"><mo id="S3.F1.5.m2.2.2.2.3" stretchy="false" xref="S3.F1.5.m2.2.2.3.cmml">âŸ¨</mo><mrow id="S3.F1.5.m2.1.1.1.1" xref="S3.F1.5.m2.1.1.1.1.cmml"><mi id="S3.F1.5.m2.1.1.1.1.2" xref="S3.F1.5.m2.1.1.1.1.2.cmml">q</mi><mo id="S3.F1.5.m2.1.1.1.1.1" xref="S3.F1.5.m2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.F1.5.m2.1.1.1.1.3" xref="S3.F1.5.m2.1.1.1.1.3.cmml">u</mi><mo id="S3.F1.5.m2.1.1.1.1.1b" xref="S3.F1.5.m2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.F1.5.m2.1.1.1.1.4" xref="S3.F1.5.m2.1.1.1.1.4.cmml">e</mi><mo id="S3.F1.5.m2.1.1.1.1.1c" xref="S3.F1.5.m2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.F1.5.m2.1.1.1.1.5" xref="S3.F1.5.m2.1.1.1.1.5.cmml">r</mi><mo id="S3.F1.5.m2.1.1.1.1.1d" xref="S3.F1.5.m2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.F1.5.m2.1.1.1.1.6" xref="S3.F1.5.m2.1.1.1.1.6.cmml">y</mi></mrow><mo id="S3.F1.5.m2.2.2.2.4" rspace="0.337em" xref="S3.F1.5.m2.2.2.3.cmml">,</mo><mrow id="S3.F1.5.m2.2.2.2.2" xref="S3.F1.5.m2.2.2.2.2.cmml"><mi id="S3.F1.5.m2.2.2.2.2.2" xref="S3.F1.5.m2.2.2.2.2.2.cmml">d</mi><mo id="S3.F1.5.m2.2.2.2.2.1" xref="S3.F1.5.m2.2.2.2.2.1.cmml">â¢</mo><mi id="S3.F1.5.m2.2.2.2.2.3" xref="S3.F1.5.m2.2.2.2.2.3.cmml">o</mi><mo id="S3.F1.5.m2.2.2.2.2.1b" xref="S3.F1.5.m2.2.2.2.2.1.cmml">â¢</mo><mi id="S3.F1.5.m2.2.2.2.2.4" xref="S3.F1.5.m2.2.2.2.2.4.cmml">c</mi><mo id="S3.F1.5.m2.2.2.2.2.1c" xref="S3.F1.5.m2.2.2.2.2.1.cmml">â¢</mo><mi id="S3.F1.5.m2.2.2.2.2.5" xref="S3.F1.5.m2.2.2.2.2.5.cmml">u</mi><mo id="S3.F1.5.m2.2.2.2.2.1d" xref="S3.F1.5.m2.2.2.2.2.1.cmml">â¢</mo><mi id="S3.F1.5.m2.2.2.2.2.6" xref="S3.F1.5.m2.2.2.2.2.6.cmml">m</mi><mo id="S3.F1.5.m2.2.2.2.2.1e" xref="S3.F1.5.m2.2.2.2.2.1.cmml">â¢</mo><mi id="S3.F1.5.m2.2.2.2.2.7" xref="S3.F1.5.m2.2.2.2.2.7.cmml">e</mi><mo id="S3.F1.5.m2.2.2.2.2.1f" xref="S3.F1.5.m2.2.2.2.2.1.cmml">â¢</mo><mi id="S3.F1.5.m2.2.2.2.2.8" xref="S3.F1.5.m2.2.2.2.2.8.cmml">n</mi><mo id="S3.F1.5.m2.2.2.2.2.1g" xref="S3.F1.5.m2.2.2.2.2.1.cmml">â¢</mo><mi id="S3.F1.5.m2.2.2.2.2.9" xref="S3.F1.5.m2.2.2.2.2.9.cmml">t</mi></mrow><mo id="S3.F1.5.m2.2.2.2.5" stretchy="false" xref="S3.F1.5.m2.2.2.3.cmml">âŸ©</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.5.m2.2c"><list id="S3.F1.5.m2.2.2.3.cmml" xref="S3.F1.5.m2.2.2.2"><apply id="S3.F1.5.m2.1.1.1.1.cmml" xref="S3.F1.5.m2.1.1.1.1"><times id="S3.F1.5.m2.1.1.1.1.1.cmml" xref="S3.F1.5.m2.1.1.1.1.1"></times><ci id="S3.F1.5.m2.1.1.1.1.2.cmml" xref="S3.F1.5.m2.1.1.1.1.2">ğ‘</ci><ci id="S3.F1.5.m2.1.1.1.1.3.cmml" xref="S3.F1.5.m2.1.1.1.1.3">ğ‘¢</ci><ci id="S3.F1.5.m2.1.1.1.1.4.cmml" xref="S3.F1.5.m2.1.1.1.1.4">ğ‘’</ci><ci id="S3.F1.5.m2.1.1.1.1.5.cmml" xref="S3.F1.5.m2.1.1.1.1.5">ğ‘Ÿ</ci><ci id="S3.F1.5.m2.1.1.1.1.6.cmml" xref="S3.F1.5.m2.1.1.1.1.6">ğ‘¦</ci></apply><apply id="S3.F1.5.m2.2.2.2.2.cmml" xref="S3.F1.5.m2.2.2.2.2"><times id="S3.F1.5.m2.2.2.2.2.1.cmml" xref="S3.F1.5.m2.2.2.2.2.1"></times><ci id="S3.F1.5.m2.2.2.2.2.2.cmml" xref="S3.F1.5.m2.2.2.2.2.2">ğ‘‘</ci><ci id="S3.F1.5.m2.2.2.2.2.3.cmml" xref="S3.F1.5.m2.2.2.2.2.3">ğ‘œ</ci><ci id="S3.F1.5.m2.2.2.2.2.4.cmml" xref="S3.F1.5.m2.2.2.2.2.4">ğ‘</ci><ci id="S3.F1.5.m2.2.2.2.2.5.cmml" xref="S3.F1.5.m2.2.2.2.2.5">ğ‘¢</ci><ci id="S3.F1.5.m2.2.2.2.2.6.cmml" xref="S3.F1.5.m2.2.2.2.2.6">ğ‘š</ci><ci id="S3.F1.5.m2.2.2.2.2.7.cmml" xref="S3.F1.5.m2.2.2.2.2.7">ğ‘’</ci><ci id="S3.F1.5.m2.2.2.2.2.8.cmml" xref="S3.F1.5.m2.2.2.2.2.8">ğ‘›</ci><ci id="S3.F1.5.m2.2.2.2.2.9.cmml" xref="S3.F1.5.m2.2.2.2.2.9">ğ‘¡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.5.m2.2d">\langle query,\,document\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.F1.5.m2.2e">âŸ¨ italic_q italic_u italic_e italic_r italic_y , italic_d italic_o italic_c italic_u italic_m italic_e italic_n italic_t âŸ©</annotation></semantics></math> pairs and their CriticGPTsâ€™ feedback are used to train a reward model, which is used to fine-tune the RAG retrieval to better align with human preferences.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we present our Reward-RAG. We first describe the dense retrieval problem in RAG in section <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3.SS1" title="3.1 Dense Retrieval in RAG â€£ 3 Methodology â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">3.1</span></a>, then present how we apply reinforcement learning to this problem in section <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3.SS2" title="3.2 User Preference Alignment using a Reward Model â€£ 3 Methodology â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">3.2</span></a>. Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3.F2" title="Figure 2 â€£ 3.2.1 Reward Models â€£ 3.2 User Preference Alignment using a Reward Model â€£ 3 Methodology â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates the high-level design for Reward-RAG.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Dense Retrieval in RAG</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.8">Let <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S3.SS1.p1.8.1">Enc</span> denote the retrieval language model. Given a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_q</annotation></semantics></math> and a document <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">ğ‘‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_d</annotation></semantics></math>, each with task-specific instructions <math alttext="I_{q}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">I</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">ğ¼</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">I_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_I start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="I_{d}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">I</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">ğ¼</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">I_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_I start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, respectively, the embedding vectors are computed as follows: <math alttext="e_{q}=\textbf{Enc}(I_{q}\oplus q)" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><msub id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">e</mi><mi id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">q</mi></msub><mo id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.6.m6.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.3a.cmml">Enc</mtext><mo id="S3.SS1.p1.6.m6.1.1.1.2" xref="S3.SS1.p1.6.m6.1.1.1.2.cmml">â¢</mo><mrow id="S3.SS1.p1.6.m6.1.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.6.m6.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.6.m6.1.1.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.6.m6.1.1.1.1.1.1.2" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.2.cmml">I</mi><mi id="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.3.cmml">q</mi></msub><mo id="S3.SS1.p1.6.m6.1.1.1.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.1.cmml">âŠ•</mo><mi id="S3.SS1.p1.6.m6.1.1.1.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.3.cmml">q</mi></mrow><mo id="S3.SS1.p1.6.m6.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><eq id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2"></eq><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">ğ‘’</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">ğ‘</ci></apply><apply id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"><times id="S3.SS1.p1.6.m6.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.2"></times><ci id="S3.SS1.p1.6.m6.1.1.1.3a.cmml" xref="S3.SS1.p1.6.m6.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.6.m6.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.3">Enc</mtext></ci><apply id="S3.SS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.2">ğ¼</ci><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.2.3">ğ‘</ci></apply><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.1.3">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">e_{q}=\textbf{Enc}(I_{q}\oplus q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_e start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = Enc ( italic_I start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT âŠ• italic_q )</annotation></semantics></math> and <math alttext="e_{d}=\textbf{Enc}(I_{d}\oplus d)" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><msub id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">e</mi><mi id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml">d</mi></msub><mo id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.7.m7.1.1.1.3" xref="S3.SS1.p1.7.m7.1.1.1.3a.cmml">Enc</mtext><mo id="S3.SS1.p1.7.m7.1.1.1.2" xref="S3.SS1.p1.7.m7.1.1.1.2.cmml">â¢</mo><mrow id="S3.SS1.p1.7.m7.1.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.7.m7.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.7.m7.1.1.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.2.cmml">I</mi><mi id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.3.cmml">d</mi></msub><mo id="S3.SS1.p1.7.m7.1.1.1.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.1.cmml">âŠ•</mo><mi id="S3.SS1.p1.7.m7.1.1.1.1.1.1.3" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.cmml">d</mi></mrow><mo id="S3.SS1.p1.7.m7.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><eq id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2"></eq><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">ğ‘’</ci><ci id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3">ğ‘‘</ci></apply><apply id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"><times id="S3.SS1.p1.7.m7.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.1.2"></times><ci id="S3.SS1.p1.7.m7.1.1.1.3a.cmml" xref="S3.SS1.p1.7.m7.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.7.m7.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.1.3">Enc</mtext></ci><apply id="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.2">ğ¼</ci><ci id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.3">ğ‘‘</ci></apply><ci id="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.3">ğ‘‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">e_{d}=\textbf{Enc}(I_{d}\oplus d)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_e start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = Enc ( italic_I start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT âŠ• italic_d )</annotation></semantics></math>. The relevance score <math alttext="sim(q,d)" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.2"><semantics id="S3.SS1.p1.8.m8.2a"><mrow id="S3.SS1.p1.8.m8.2.3" xref="S3.SS1.p1.8.m8.2.3.cmml"><mi id="S3.SS1.p1.8.m8.2.3.2" xref="S3.SS1.p1.8.m8.2.3.2.cmml">s</mi><mo id="S3.SS1.p1.8.m8.2.3.1" xref="S3.SS1.p1.8.m8.2.3.1.cmml">â¢</mo><mi id="S3.SS1.p1.8.m8.2.3.3" xref="S3.SS1.p1.8.m8.2.3.3.cmml">i</mi><mo id="S3.SS1.p1.8.m8.2.3.1a" xref="S3.SS1.p1.8.m8.2.3.1.cmml">â¢</mo><mi id="S3.SS1.p1.8.m8.2.3.4" xref="S3.SS1.p1.8.m8.2.3.4.cmml">m</mi><mo id="S3.SS1.p1.8.m8.2.3.1b" xref="S3.SS1.p1.8.m8.2.3.1.cmml">â¢</mo><mrow id="S3.SS1.p1.8.m8.2.3.5.2" xref="S3.SS1.p1.8.m8.2.3.5.1.cmml"><mo id="S3.SS1.p1.8.m8.2.3.5.2.1" stretchy="false" xref="S3.SS1.p1.8.m8.2.3.5.1.cmml">(</mo><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">q</mi><mo id="S3.SS1.p1.8.m8.2.3.5.2.2" xref="S3.SS1.p1.8.m8.2.3.5.1.cmml">,</mo><mi id="S3.SS1.p1.8.m8.2.2" xref="S3.SS1.p1.8.m8.2.2.cmml">d</mi><mo id="S3.SS1.p1.8.m8.2.3.5.2.3" stretchy="false" xref="S3.SS1.p1.8.m8.2.3.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.2b"><apply id="S3.SS1.p1.8.m8.2.3.cmml" xref="S3.SS1.p1.8.m8.2.3"><times id="S3.SS1.p1.8.m8.2.3.1.cmml" xref="S3.SS1.p1.8.m8.2.3.1"></times><ci id="S3.SS1.p1.8.m8.2.3.2.cmml" xref="S3.SS1.p1.8.m8.2.3.2">ğ‘ </ci><ci id="S3.SS1.p1.8.m8.2.3.3.cmml" xref="S3.SS1.p1.8.m8.2.3.3">ğ‘–</ci><ci id="S3.SS1.p1.8.m8.2.3.4.cmml" xref="S3.SS1.p1.8.m8.2.3.4">ğ‘š</ci><interval closure="open" id="S3.SS1.p1.8.m8.2.3.5.1.cmml" xref="S3.SS1.p1.8.m8.2.3.5.2"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">ğ‘</ci><ci id="S3.SS1.p1.8.m8.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2">ğ‘‘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.2c">sim(q,d)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.2d">italic_s italic_i italic_m ( italic_q , italic_d )</annotation></semantics></math> is determined by the cosine similarity between these two embedding vectors.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="sim(q,d)=\frac{e_{q}.e_{d}}{\|e_{q}\|\|e_{d}\|}" class="ltx_Math" display="block" id="S3.E1.m1.6"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.7" xref="S3.E1.m1.6.7.cmml"><mrow id="S3.E1.m1.6.7.2" xref="S3.E1.m1.6.7.2.cmml"><mi id="S3.E1.m1.6.7.2.2" xref="S3.E1.m1.6.7.2.2.cmml">s</mi><mo id="S3.E1.m1.6.7.2.1" xref="S3.E1.m1.6.7.2.1.cmml">â¢</mo><mi id="S3.E1.m1.6.7.2.3" xref="S3.E1.m1.6.7.2.3.cmml">i</mi><mo id="S3.E1.m1.6.7.2.1a" xref="S3.E1.m1.6.7.2.1.cmml">â¢</mo><mi id="S3.E1.m1.6.7.2.4" xref="S3.E1.m1.6.7.2.4.cmml">m</mi><mo id="S3.E1.m1.6.7.2.1b" xref="S3.E1.m1.6.7.2.1.cmml">â¢</mo><mrow id="S3.E1.m1.6.7.2.5.2" xref="S3.E1.m1.6.7.2.5.1.cmml"><mo id="S3.E1.m1.6.7.2.5.2.1" stretchy="false" xref="S3.E1.m1.6.7.2.5.1.cmml">(</mo><mi id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml">q</mi><mo id="S3.E1.m1.6.7.2.5.2.2" xref="S3.E1.m1.6.7.2.5.1.cmml">,</mo><mi id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml">d</mi><mo id="S3.E1.m1.6.7.2.5.2.3" stretchy="false" xref="S3.E1.m1.6.7.2.5.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.7.1" xref="S3.E1.m1.6.7.1.cmml">=</mo><mfrac id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.3.cmml"><msub id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">e</mi><mi id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S3.E1.m1.2.2.2.2.3" lspace="0em" rspace="0.167em" xref="S3.E1.m1.2.2.2.3a.cmml">.</mo><msub id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml">e</mi><mi id="S3.E1.m1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.3.cmml">d</mi></msub></mrow><mrow id="S3.E1.m1.4.4.4" xref="S3.E1.m1.4.4.4.cmml"><mrow id="S3.E1.m1.3.3.3.1.1" xref="S3.E1.m1.3.3.3.1.2.cmml"><mo id="S3.E1.m1.3.3.3.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.3.1.2.1.cmml">â€–</mo><msub id="S3.E1.m1.3.3.3.1.1.1" xref="S3.E1.m1.3.3.3.1.1.1.cmml"><mi id="S3.E1.m1.3.3.3.1.1.1.2" xref="S3.E1.m1.3.3.3.1.1.1.2.cmml">e</mi><mi id="S3.E1.m1.3.3.3.1.1.1.3" xref="S3.E1.m1.3.3.3.1.1.1.3.cmml">q</mi></msub><mo id="S3.E1.m1.3.3.3.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.3.1.2.1.cmml">â€–</mo></mrow><mo id="S3.E1.m1.4.4.4.3" xref="S3.E1.m1.4.4.4.3.cmml">â¢</mo><mrow id="S3.E1.m1.4.4.4.2.1" xref="S3.E1.m1.4.4.4.2.2.cmml"><mo id="S3.E1.m1.4.4.4.2.1.2" stretchy="false" xref="S3.E1.m1.4.4.4.2.2.1.cmml">â€–</mo><msub id="S3.E1.m1.4.4.4.2.1.1" xref="S3.E1.m1.4.4.4.2.1.1.cmml"><mi id="S3.E1.m1.4.4.4.2.1.1.2" xref="S3.E1.m1.4.4.4.2.1.1.2.cmml">e</mi><mi id="S3.E1.m1.4.4.4.2.1.1.3" xref="S3.E1.m1.4.4.4.2.1.1.3.cmml">d</mi></msub><mo id="S3.E1.m1.4.4.4.2.1.3" stretchy="false" xref="S3.E1.m1.4.4.4.2.2.1.cmml">â€–</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.7.cmml" xref="S3.E1.m1.6.7"><eq id="S3.E1.m1.6.7.1.cmml" xref="S3.E1.m1.6.7.1"></eq><apply id="S3.E1.m1.6.7.2.cmml" xref="S3.E1.m1.6.7.2"><times id="S3.E1.m1.6.7.2.1.cmml" xref="S3.E1.m1.6.7.2.1"></times><ci id="S3.E1.m1.6.7.2.2.cmml" xref="S3.E1.m1.6.7.2.2">ğ‘ </ci><ci id="S3.E1.m1.6.7.2.3.cmml" xref="S3.E1.m1.6.7.2.3">ğ‘–</ci><ci id="S3.E1.m1.6.7.2.4.cmml" xref="S3.E1.m1.6.7.2.4">ğ‘š</ci><interval closure="open" id="S3.E1.m1.6.7.2.5.1.cmml" xref="S3.E1.m1.6.7.2.5.2"><ci id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5">ğ‘</ci><ci id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6">ğ‘‘</ci></interval></apply><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><divide id="S3.E1.m1.4.4.5.cmml" xref="S3.E1.m1.4.4"></divide><apply id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.3a.cmml" xref="S3.E1.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">ğ‘’</ci><ci id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">ğ‘</ci></apply><apply id="S3.E1.m1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2">ğ‘’</ci><ci id="S3.E1.m1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.3">ğ‘‘</ci></apply></apply><apply id="S3.E1.m1.4.4.4.cmml" xref="S3.E1.m1.4.4.4"><times id="S3.E1.m1.4.4.4.3.cmml" xref="S3.E1.m1.4.4.4.3"></times><apply id="S3.E1.m1.3.3.3.1.2.cmml" xref="S3.E1.m1.3.3.3.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.3.1.2.1.cmml" xref="S3.E1.m1.3.3.3.1.1.2">norm</csymbol><apply id="S3.E1.m1.3.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.1.1.1.2">ğ‘’</ci><ci id="S3.E1.m1.3.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.1.1.1.3">ğ‘</ci></apply></apply><apply id="S3.E1.m1.4.4.4.2.2.cmml" xref="S3.E1.m1.4.4.4.2.1"><csymbol cd="latexml" id="S3.E1.m1.4.4.4.2.2.1.cmml" xref="S3.E1.m1.4.4.4.2.1.2">norm</csymbol><apply id="S3.E1.m1.4.4.4.2.1.1.cmml" xref="S3.E1.m1.4.4.4.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.1.1.1.cmml" xref="S3.E1.m1.4.4.4.2.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.4.2.1.1.2.cmml" xref="S3.E1.m1.4.4.4.2.1.1.2">ğ‘’</ci><ci id="S3.E1.m1.4.4.4.2.1.1.3.cmml" xref="S3.E1.m1.4.4.4.2.1.1.3">ğ‘‘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">sim(q,d)=\frac{e_{q}.e_{d}}{\|e_{q}\|\|e_{d}\|}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.6d">italic_s italic_i italic_m ( italic_q , italic_d ) = divide start_ARG italic_e start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT . italic_e start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG start_ARG âˆ¥ italic_e start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT âˆ¥ âˆ¥ italic_e start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT âˆ¥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2">In this work, we use both autoregressive and bidirectional language modelsÂ <cite class="ltx_cite ltx_citemacro_citep">(Devlin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib14" title="">2019</a>)</cite> as our retrieval models. We add two special tokens <math alttext="[CLS]" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.2.cmml"><mo id="S3.SS1.p3.1.m1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.1.m1.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p3.1.m1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.1.1.2.cmml">C</mi><mo id="S3.SS1.p3.1.m1.1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.1.m1.1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.1.1.3.cmml">L</mi><mo id="S3.SS1.p3.1.m1.1.1.1.1.1a" xref="S3.SS1.p3.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.1.m1.1.1.1.1.4" xref="S3.SS1.p3.1.m1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S3.SS1.p3.1.m1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.1.m1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1"><times id="S3.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1"></times><ci id="S3.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2">ğ¶</ci><ci id="S3.SS1.p3.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.3">ğ¿</ci><ci id="S3.SS1.p3.1.m1.1.1.1.1.4.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.4">ğ‘†</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">[CLS]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">[ italic_C italic_L italic_S ]</annotation></semantics></math> and <math alttext="[EOS]" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.2.cmml"><mo id="S3.SS1.p3.2.m2.1.1.1.2" stretchy="false" xref="S3.SS1.p3.2.m2.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p3.2.m2.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.2" xref="S3.SS1.p3.2.m2.1.1.1.1.2.cmml">E</mi><mo id="S3.SS1.p3.2.m2.1.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.2.m2.1.1.1.1.3" xref="S3.SS1.p3.2.m2.1.1.1.1.3.cmml">O</mi><mo id="S3.SS1.p3.2.m2.1.1.1.1.1a" xref="S3.SS1.p3.2.m2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.2.m2.1.1.1.1.4" xref="S3.SS1.p3.2.m2.1.1.1.1.4.cmml">S</mi></mrow><mo id="S3.SS1.p3.2.m2.1.1.1.3" stretchy="false" xref="S3.SS1.p3.2.m2.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.2.m2.1.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1"><times id="S3.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1"></times><ci id="S3.SS1.p3.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.2">ğ¸</ci><ci id="S3.SS1.p3.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3">ğ‘‚</ci><ci id="S3.SS1.p3.2.m2.1.1.1.1.4.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.4">ğ‘†</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">[EOS]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">[ italic_E italic_O italic_S ]</annotation></semantics></math> to the list of tokens representing textual input:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[CLS],{t}_{1},{t}_{2},...,{t}_{n},[EOS]" class="ltx_Math" display="block" id="S3.E2.m1.6"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.5" xref="S3.E2.m1.6.6.6.cmml"><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.2.cmml"><mo id="S3.E2.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">C</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.E2.m1.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.3.cmml">L</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1a" xref="S3.E2.m1.2.2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.E2.m1.2.2.1.1.1.1.4" xref="S3.E2.m1.2.2.1.1.1.1.4.cmml">S</mi></mrow><mo id="S3.E2.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.1.1.2.1.cmml">]</mo></mrow><mo id="S3.E2.m1.6.6.5.6" xref="S3.E2.m1.6.6.6.cmml">,</mo><msub id="S3.E2.m1.3.3.2.2" xref="S3.E2.m1.3.3.2.2.cmml"><mi id="S3.E2.m1.3.3.2.2.2" xref="S3.E2.m1.3.3.2.2.2.cmml">t</mi><mn id="S3.E2.m1.3.3.2.2.3" xref="S3.E2.m1.3.3.2.2.3.cmml">1</mn></msub><mo id="S3.E2.m1.6.6.5.7" xref="S3.E2.m1.6.6.6.cmml">,</mo><msub id="S3.E2.m1.4.4.3.3" xref="S3.E2.m1.4.4.3.3.cmml"><mi id="S3.E2.m1.4.4.3.3.2" xref="S3.E2.m1.4.4.3.3.2.cmml">t</mi><mn id="S3.E2.m1.4.4.3.3.3" xref="S3.E2.m1.4.4.3.3.3.cmml">2</mn></msub><mo id="S3.E2.m1.6.6.5.8" xref="S3.E2.m1.6.6.6.cmml">,</mo><mi id="S3.E2.m1.1.1" mathvariant="normal" xref="S3.E2.m1.1.1.cmml">â€¦</mi><mo id="S3.E2.m1.6.6.5.9" xref="S3.E2.m1.6.6.6.cmml">,</mo><msub id="S3.E2.m1.5.5.4.4" xref="S3.E2.m1.5.5.4.4.cmml"><mi id="S3.E2.m1.5.5.4.4.2" xref="S3.E2.m1.5.5.4.4.2.cmml">t</mi><mi id="S3.E2.m1.5.5.4.4.3" xref="S3.E2.m1.5.5.4.4.3.cmml">n</mi></msub><mo id="S3.E2.m1.6.6.5.10" xref="S3.E2.m1.6.6.6.cmml">,</mo><mrow id="S3.E2.m1.6.6.5.5.1" xref="S3.E2.m1.6.6.5.5.2.cmml"><mo id="S3.E2.m1.6.6.5.5.1.2" stretchy="false" xref="S3.E2.m1.6.6.5.5.2.1.cmml">[</mo><mrow id="S3.E2.m1.6.6.5.5.1.1" xref="S3.E2.m1.6.6.5.5.1.1.cmml"><mi id="S3.E2.m1.6.6.5.5.1.1.2" xref="S3.E2.m1.6.6.5.5.1.1.2.cmml">E</mi><mo id="S3.E2.m1.6.6.5.5.1.1.1" xref="S3.E2.m1.6.6.5.5.1.1.1.cmml">â¢</mo><mi id="S3.E2.m1.6.6.5.5.1.1.3" xref="S3.E2.m1.6.6.5.5.1.1.3.cmml">O</mi><mo id="S3.E2.m1.6.6.5.5.1.1.1a" xref="S3.E2.m1.6.6.5.5.1.1.1.cmml">â¢</mo><mi id="S3.E2.m1.6.6.5.5.1.1.4" xref="S3.E2.m1.6.6.5.5.1.1.4.cmml">S</mi></mrow><mo id="S3.E2.m1.6.6.5.5.1.3" stretchy="false" xref="S3.E2.m1.6.6.5.5.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><list id="S3.E2.m1.6.6.6.cmml" xref="S3.E2.m1.6.6.5"><apply id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"></times><ci id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2">ğ¶</ci><ci id="S3.E2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3">ğ¿</ci><ci id="S3.E2.m1.2.2.1.1.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4">ğ‘†</ci></apply></apply><apply id="S3.E2.m1.3.3.2.2.cmml" xref="S3.E2.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.1.cmml" xref="S3.E2.m1.3.3.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.2.2.2.cmml" xref="S3.E2.m1.3.3.2.2.2">ğ‘¡</ci><cn id="S3.E2.m1.3.3.2.2.3.cmml" type="integer" xref="S3.E2.m1.3.3.2.2.3">1</cn></apply><apply id="S3.E2.m1.4.4.3.3.cmml" xref="S3.E2.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.3.3.1.cmml" xref="S3.E2.m1.4.4.3.3">subscript</csymbol><ci id="S3.E2.m1.4.4.3.3.2.cmml" xref="S3.E2.m1.4.4.3.3.2">ğ‘¡</ci><cn id="S3.E2.m1.4.4.3.3.3.cmml" type="integer" xref="S3.E2.m1.4.4.3.3.3">2</cn></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">â€¦</ci><apply id="S3.E2.m1.5.5.4.4.cmml" xref="S3.E2.m1.5.5.4.4"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.4.4.1.cmml" xref="S3.E2.m1.5.5.4.4">subscript</csymbol><ci id="S3.E2.m1.5.5.4.4.2.cmml" xref="S3.E2.m1.5.5.4.4.2">ğ‘¡</ci><ci id="S3.E2.m1.5.5.4.4.3.cmml" xref="S3.E2.m1.5.5.4.4.3">ğ‘›</ci></apply><apply id="S3.E2.m1.6.6.5.5.2.cmml" xref="S3.E2.m1.6.6.5.5.1"><csymbol cd="latexml" id="S3.E2.m1.6.6.5.5.2.1.cmml" xref="S3.E2.m1.6.6.5.5.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.6.6.5.5.1.1.cmml" xref="S3.E2.m1.6.6.5.5.1.1"><times id="S3.E2.m1.6.6.5.5.1.1.1.cmml" xref="S3.E2.m1.6.6.5.5.1.1.1"></times><ci id="S3.E2.m1.6.6.5.5.1.1.2.cmml" xref="S3.E2.m1.6.6.5.5.1.1.2">ğ¸</ci><ci id="S3.E2.m1.6.6.5.5.1.1.3.cmml" xref="S3.E2.m1.6.6.5.5.1.1.3">ğ‘‚</ci><ci id="S3.E2.m1.6.6.5.5.1.1.4.cmml" xref="S3.E2.m1.6.6.5.5.1.1.4">ğ‘†</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">[CLS],{t}_{1},{t}_{2},...,{t}_{n},[EOS]</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.6d">[ italic_C italic_L italic_S ] , italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , â€¦ , italic_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , [ italic_E italic_O italic_S ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.5">where <math alttext="{t}_{1}...{t}_{n}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m1.1"><semantics id="S3.SS1.p3.3.m1.1a"><mrow id="S3.SS1.p3.3.m1.1.1" xref="S3.SS1.p3.3.m1.1.1.cmml"><msub id="S3.SS1.p3.3.m1.1.1.2" xref="S3.SS1.p3.3.m1.1.1.2.cmml"><mi id="S3.SS1.p3.3.m1.1.1.2.2" xref="S3.SS1.p3.3.m1.1.1.2.2.cmml">t</mi><mn id="S3.SS1.p3.3.m1.1.1.2.3" xref="S3.SS1.p3.3.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS1.p3.3.m1.1.1.1" xref="S3.SS1.p3.3.m1.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.3.m1.1.1.3" mathvariant="normal" xref="S3.SS1.p3.3.m1.1.1.3.cmml">â€¦</mi><mo id="S3.SS1.p3.3.m1.1.1.1a" xref="S3.SS1.p3.3.m1.1.1.1.cmml">â¢</mo><msub id="S3.SS1.p3.3.m1.1.1.4" xref="S3.SS1.p3.3.m1.1.1.4.cmml"><mi id="S3.SS1.p3.3.m1.1.1.4.2" xref="S3.SS1.p3.3.m1.1.1.4.2.cmml">t</mi><mi id="S3.SS1.p3.3.m1.1.1.4.3" xref="S3.SS1.p3.3.m1.1.1.4.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m1.1b"><apply id="S3.SS1.p3.3.m1.1.1.cmml" xref="S3.SS1.p3.3.m1.1.1"><times id="S3.SS1.p3.3.m1.1.1.1.cmml" xref="S3.SS1.p3.3.m1.1.1.1"></times><apply id="S3.SS1.p3.3.m1.1.1.2.cmml" xref="S3.SS1.p3.3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m1.1.1.2.1.cmml" xref="S3.SS1.p3.3.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.3.m1.1.1.2.2.cmml" xref="S3.SS1.p3.3.m1.1.1.2.2">ğ‘¡</ci><cn id="S3.SS1.p3.3.m1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p3.3.m1.1.1.2.3">1</cn></apply><ci id="S3.SS1.p3.3.m1.1.1.3.cmml" xref="S3.SS1.p3.3.m1.1.1.3">â€¦</ci><apply id="S3.SS1.p3.3.m1.1.1.4.cmml" xref="S3.SS1.p3.3.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m1.1.1.4.1.cmml" xref="S3.SS1.p3.3.m1.1.1.4">subscript</csymbol><ci id="S3.SS1.p3.3.m1.1.1.4.2.cmml" xref="S3.SS1.p3.3.m1.1.1.4.2">ğ‘¡</ci><ci id="S3.SS1.p3.3.m1.1.1.4.3.cmml" xref="S3.SS1.p3.3.m1.1.1.4.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m1.1c">{t}_{1}...{t}_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m1.1d">italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT â€¦ italic_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> is the token representation of the input sequence. We use the embedding of the <math alttext="[CLS]" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m2.1"><semantics id="S3.SS1.p3.4.m2.1a"><mrow id="S3.SS1.p3.4.m2.1.1.1" xref="S3.SS1.p3.4.m2.1.1.2.cmml"><mo id="S3.SS1.p3.4.m2.1.1.1.2" stretchy="false" xref="S3.SS1.p3.4.m2.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p3.4.m2.1.1.1.1" xref="S3.SS1.p3.4.m2.1.1.1.1.cmml"><mi id="S3.SS1.p3.4.m2.1.1.1.1.2" xref="S3.SS1.p3.4.m2.1.1.1.1.2.cmml">C</mi><mo id="S3.SS1.p3.4.m2.1.1.1.1.1" xref="S3.SS1.p3.4.m2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.4.m2.1.1.1.1.3" xref="S3.SS1.p3.4.m2.1.1.1.1.3.cmml">L</mi><mo id="S3.SS1.p3.4.m2.1.1.1.1.1a" xref="S3.SS1.p3.4.m2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.4.m2.1.1.1.1.4" xref="S3.SS1.p3.4.m2.1.1.1.1.4.cmml">S</mi></mrow><mo id="S3.SS1.p3.4.m2.1.1.1.3" stretchy="false" xref="S3.SS1.p3.4.m2.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m2.1b"><apply id="S3.SS1.p3.4.m2.1.1.2.cmml" xref="S3.SS1.p3.4.m2.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.4.m2.1.1.2.1.cmml" xref="S3.SS1.p3.4.m2.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p3.4.m2.1.1.1.1.cmml" xref="S3.SS1.p3.4.m2.1.1.1.1"><times id="S3.SS1.p3.4.m2.1.1.1.1.1.cmml" xref="S3.SS1.p3.4.m2.1.1.1.1.1"></times><ci id="S3.SS1.p3.4.m2.1.1.1.1.2.cmml" xref="S3.SS1.p3.4.m2.1.1.1.1.2">ğ¶</ci><ci id="S3.SS1.p3.4.m2.1.1.1.1.3.cmml" xref="S3.SS1.p3.4.m2.1.1.1.1.3">ğ¿</ci><ci id="S3.SS1.p3.4.m2.1.1.1.1.4.cmml" xref="S3.SS1.p3.4.m2.1.1.1.1.4">ğ‘†</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m2.1c">[CLS]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m2.1d">[ italic_C italic_L italic_S ]</annotation></semantics></math> token and <math alttext="[EOS]" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m3.1"><semantics id="S3.SS1.p3.5.m3.1a"><mrow id="S3.SS1.p3.5.m3.1.1.1" xref="S3.SS1.p3.5.m3.1.1.2.cmml"><mo id="S3.SS1.p3.5.m3.1.1.1.2" stretchy="false" xref="S3.SS1.p3.5.m3.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p3.5.m3.1.1.1.1" xref="S3.SS1.p3.5.m3.1.1.1.1.cmml"><mi id="S3.SS1.p3.5.m3.1.1.1.1.2" xref="S3.SS1.p3.5.m3.1.1.1.1.2.cmml">E</mi><mo id="S3.SS1.p3.5.m3.1.1.1.1.1" xref="S3.SS1.p3.5.m3.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.5.m3.1.1.1.1.3" xref="S3.SS1.p3.5.m3.1.1.1.1.3.cmml">O</mi><mo id="S3.SS1.p3.5.m3.1.1.1.1.1a" xref="S3.SS1.p3.5.m3.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.5.m3.1.1.1.1.4" xref="S3.SS1.p3.5.m3.1.1.1.1.4.cmml">S</mi></mrow><mo id="S3.SS1.p3.5.m3.1.1.1.3" stretchy="false" xref="S3.SS1.p3.5.m3.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m3.1b"><apply id="S3.SS1.p3.5.m3.1.1.2.cmml" xref="S3.SS1.p3.5.m3.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.5.m3.1.1.2.1.cmml" xref="S3.SS1.p3.5.m3.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p3.5.m3.1.1.1.1.cmml" xref="S3.SS1.p3.5.m3.1.1.1.1"><times id="S3.SS1.p3.5.m3.1.1.1.1.1.cmml" xref="S3.SS1.p3.5.m3.1.1.1.1.1"></times><ci id="S3.SS1.p3.5.m3.1.1.1.1.2.cmml" xref="S3.SS1.p3.5.m3.1.1.1.1.2">ğ¸</ci><ci id="S3.SS1.p3.5.m3.1.1.1.1.3.cmml" xref="S3.SS1.p3.5.m3.1.1.1.1.3">ğ‘‚</ci><ci id="S3.SS1.p3.5.m3.1.1.1.1.4.cmml" xref="S3.SS1.p3.5.m3.1.1.1.1.4">ğ‘†</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m3.1c">[EOS]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m3.1d">[ italic_E italic_O italic_S ]</annotation></semantics></math> token from the last transformer layer as the vector representation of the input for the bidirectional language model and the autoregressive language model, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">A crucial problem in RAG is how to retrieve relevant documents given a query <cite class="ltx_cite ltx_citemacro_citep">(Gao etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib19" title="">2024</a>)</cite>, especially in domain-specific tasks where retrieval models can lack information compared to their training data. We leverage a reward model to adapt the retrieval models for different tasks and user preferences effectively. The details of our approach will be introduced in the following sections.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>User Preference Alignment using a Reward Model</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Inspired by RLHF, we design a mechanism to fine-tune the existing retrieval models to better align user preferences in the retrieved documents. We follow the RL-based design in RLHF, where we first build a reward model to evaluate the relevance between a query and a document, secondly we fine-tune retrieval models using the reward model (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3.F2" title="Figure 2 â€£ 3.2.1 Reward Models â€£ 3.2 User Preference Alignment using a Reward Model â€£ 3 Methodology â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Reward Models</h4>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="126" id="S3.F2.1.g1" src="x2.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S3.F2.3.1">Overview of the reward method</span>. We follow the design in <cite class="ltx_cite ltx_citemacro_citet">Wang etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib93" title="">2024</a>)</cite> to adapt an existing autoregressive model to be a reward model.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">In RLHF, the reward model plays an important role in aligning LLMs, reflecting human values and expectations <cite class="ltx_cite ltx_citemacro_citep">(Stiennon etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib84" title="">2020</a>; Ouyang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib67" title="">2022</a>)</cite>. We leverage GPT-4 as our CriticGPT to label the relevant level of a <math alttext="\langle query,\,document\rangle" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.2"><semantics id="S3.SS2.SSS1.p1.1.m1.2a"><mrow id="S3.SS2.SSS1.p1.1.m1.2.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.3.cmml"><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.3" stretchy="false" xref="S3.SS2.SSS1.p1.1.m1.2.2.3.cmml">âŸ¨</mo><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.2.cmml">q</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.cmml">u</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1a" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.4" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.4.cmml">e</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1b" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.5" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.5.cmml">r</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1c" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.6" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.6.cmml">y</mi></mrow><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.4" rspace="0.337em" xref="S3.SS2.SSS1.p1.1.m1.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS1.p1.1.m1.2.2.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.2.cmml">d</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.3" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.3.cmml">o</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1a" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.4" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.4.cmml">c</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1b" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.5" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.5.cmml">u</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1c" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.6" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.6.cmml">m</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1d" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.7" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.7.cmml">e</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1e" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.8" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.8.cmml">n</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1f" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.9" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.9.cmml">t</mi></mrow><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.5" stretchy="false" xref="S3.SS2.SSS1.p1.1.m1.2.2.3.cmml">âŸ©</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.2b"><list id="S3.SS2.SSS1.p1.1.m1.2.2.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1"><times id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.2">ğ‘</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3">ğ‘¢</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.4">ğ‘’</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.5.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.5">ğ‘Ÿ</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.6.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.6">ğ‘¦</ci></apply><apply id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2"><times id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1"></times><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.2">ğ‘‘</ci><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.3">ğ‘œ</ci><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.4.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.4">ğ‘</ci><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.5.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.5">ğ‘¢</ci><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.6.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.6">ğ‘š</ci><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.7.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.7">ğ‘’</ci><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.8.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.8">ğ‘›</ci><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.9.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.9">ğ‘¡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.2c">\langle query,\,document\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.2d">âŸ¨ italic_q italic_u italic_e italic_r italic_y , italic_d italic_o italic_c italic_u italic_m italic_e italic_n italic_t âŸ©</annotation></semantics></math> pair as GPT-4 is proven to reach human-level accuracy for evaluation tasks <cite class="ltx_cite ltx_citemacro_citep">(Liu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib56" title="">2023</a>; Hackl etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib24" title="">2023</a>)</cite>. The CriticGPT is instructed to mimic human preferences using a small set of human preference examples.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">Our reward model is trained to rate the relevance between a question and a document corresponding to the feedback. This model involves providing the model with both a query and a candidate document as input, then produces a score representing the documentâ€™s relevance to the query <cite class="ltx_cite ltx_citemacro_citep">(Nogueira etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib64" title="">2019</a>)</cite>. Specifically, we construct the input from a query and a document as follow:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Input=[CLS],{t}^{q}_{1},...,{t}^{q}_{n_{q}},[SEP],{t}^{d}_{1},...,{t}^{d}_{n_{%
d}},[EOS]" class="ltx_Math" display="block" id="S3.E3.m1.9"><semantics id="S3.E3.m1.9a"><mrow id="S3.E3.m1.9.9" xref="S3.E3.m1.9.9.cmml"><mrow id="S3.E3.m1.9.9.9" xref="S3.E3.m1.9.9.9.cmml"><mi id="S3.E3.m1.9.9.9.2" xref="S3.E3.m1.9.9.9.2.cmml">I</mi><mo id="S3.E3.m1.9.9.9.1" xref="S3.E3.m1.9.9.9.1.cmml">â¢</mo><mi id="S3.E3.m1.9.9.9.3" xref="S3.E3.m1.9.9.9.3.cmml">n</mi><mo id="S3.E3.m1.9.9.9.1a" xref="S3.E3.m1.9.9.9.1.cmml">â¢</mo><mi id="S3.E3.m1.9.9.9.4" xref="S3.E3.m1.9.9.9.4.cmml">p</mi><mo id="S3.E3.m1.9.9.9.1b" xref="S3.E3.m1.9.9.9.1.cmml">â¢</mo><mi id="S3.E3.m1.9.9.9.5" xref="S3.E3.m1.9.9.9.5.cmml">u</mi><mo id="S3.E3.m1.9.9.9.1c" xref="S3.E3.m1.9.9.9.1.cmml">â¢</mo><mi id="S3.E3.m1.9.9.9.6" xref="S3.E3.m1.9.9.9.6.cmml">t</mi></mrow><mo id="S3.E3.m1.9.9.8" xref="S3.E3.m1.9.9.8.cmml">=</mo><mrow id="S3.E3.m1.9.9.7.7" xref="S3.E3.m1.9.9.7.8.cmml"><mrow id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.2.cmml"><mo id="S3.E3.m1.3.3.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.3.3.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.2.cmml">C</mi><mo id="S3.E3.m1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.3.cmml">L</mi><mo id="S3.E3.m1.3.3.1.1.1.1.1.1a" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.4" xref="S3.E3.m1.3.3.1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S3.E3.m1.3.3.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.3.3.1.1.1.2.1.cmml">]</mo></mrow><mo id="S3.E3.m1.9.9.7.7.8" xref="S3.E3.m1.9.9.7.8.cmml">,</mo><msubsup id="S3.E3.m1.4.4.2.2.2" xref="S3.E3.m1.4.4.2.2.2.cmml"><mi id="S3.E3.m1.4.4.2.2.2.2.2" xref="S3.E3.m1.4.4.2.2.2.2.2.cmml">t</mi><mn id="S3.E3.m1.4.4.2.2.2.3" xref="S3.E3.m1.4.4.2.2.2.3.cmml">1</mn><mi id="S3.E3.m1.4.4.2.2.2.2.3" xref="S3.E3.m1.4.4.2.2.2.2.3.cmml">q</mi></msubsup><mo id="S3.E3.m1.9.9.7.7.9" xref="S3.E3.m1.9.9.7.8.cmml">,</mo><mi id="S3.E3.m1.1.1" mathvariant="normal" xref="S3.E3.m1.1.1.cmml">â€¦</mi><mo id="S3.E3.m1.9.9.7.7.10" xref="S3.E3.m1.9.9.7.8.cmml">,</mo><msubsup id="S3.E3.m1.5.5.3.3.3" xref="S3.E3.m1.5.5.3.3.3.cmml"><mi id="S3.E3.m1.5.5.3.3.3.2.2" xref="S3.E3.m1.5.5.3.3.3.2.2.cmml">t</mi><msub id="S3.E3.m1.5.5.3.3.3.3" xref="S3.E3.m1.5.5.3.3.3.3.cmml"><mi id="S3.E3.m1.5.5.3.3.3.3.2" xref="S3.E3.m1.5.5.3.3.3.3.2.cmml">n</mi><mi id="S3.E3.m1.5.5.3.3.3.3.3" xref="S3.E3.m1.5.5.3.3.3.3.3.cmml">q</mi></msub><mi id="S3.E3.m1.5.5.3.3.3.2.3" xref="S3.E3.m1.5.5.3.3.3.2.3.cmml">q</mi></msubsup><mo id="S3.E3.m1.9.9.7.7.11" xref="S3.E3.m1.9.9.7.8.cmml">,</mo><mrow id="S3.E3.m1.6.6.4.4.4.1" xref="S3.E3.m1.6.6.4.4.4.2.cmml"><mo id="S3.E3.m1.6.6.4.4.4.1.2" stretchy="false" xref="S3.E3.m1.6.6.4.4.4.2.1.cmml">[</mo><mrow id="S3.E3.m1.6.6.4.4.4.1.1" xref="S3.E3.m1.6.6.4.4.4.1.1.cmml"><mi id="S3.E3.m1.6.6.4.4.4.1.1.2" xref="S3.E3.m1.6.6.4.4.4.1.1.2.cmml">S</mi><mo id="S3.E3.m1.6.6.4.4.4.1.1.1" xref="S3.E3.m1.6.6.4.4.4.1.1.1.cmml">â¢</mo><mi id="S3.E3.m1.6.6.4.4.4.1.1.3" xref="S3.E3.m1.6.6.4.4.4.1.1.3.cmml">E</mi><mo id="S3.E3.m1.6.6.4.4.4.1.1.1a" xref="S3.E3.m1.6.6.4.4.4.1.1.1.cmml">â¢</mo><mi id="S3.E3.m1.6.6.4.4.4.1.1.4" xref="S3.E3.m1.6.6.4.4.4.1.1.4.cmml">P</mi></mrow><mo id="S3.E3.m1.6.6.4.4.4.1.3" stretchy="false" xref="S3.E3.m1.6.6.4.4.4.2.1.cmml">]</mo></mrow><mo id="S3.E3.m1.9.9.7.7.12" xref="S3.E3.m1.9.9.7.8.cmml">,</mo><msubsup id="S3.E3.m1.7.7.5.5.5" xref="S3.E3.m1.7.7.5.5.5.cmml"><mi id="S3.E3.m1.7.7.5.5.5.2.2" xref="S3.E3.m1.7.7.5.5.5.2.2.cmml">t</mi><mn id="S3.E3.m1.7.7.5.5.5.3" xref="S3.E3.m1.7.7.5.5.5.3.cmml">1</mn><mi id="S3.E3.m1.7.7.5.5.5.2.3" xref="S3.E3.m1.7.7.5.5.5.2.3.cmml">d</mi></msubsup><mo id="S3.E3.m1.9.9.7.7.13" xref="S3.E3.m1.9.9.7.8.cmml">,</mo><mi id="S3.E3.m1.2.2" mathvariant="normal" xref="S3.E3.m1.2.2.cmml">â€¦</mi><mo id="S3.E3.m1.9.9.7.7.14" xref="S3.E3.m1.9.9.7.8.cmml">,</mo><msubsup id="S3.E3.m1.8.8.6.6.6" xref="S3.E3.m1.8.8.6.6.6.cmml"><mi id="S3.E3.m1.8.8.6.6.6.2.2" xref="S3.E3.m1.8.8.6.6.6.2.2.cmml">t</mi><msub id="S3.E3.m1.8.8.6.6.6.3" xref="S3.E3.m1.8.8.6.6.6.3.cmml"><mi id="S3.E3.m1.8.8.6.6.6.3.2" xref="S3.E3.m1.8.8.6.6.6.3.2.cmml">n</mi><mi id="S3.E3.m1.8.8.6.6.6.3.3" xref="S3.E3.m1.8.8.6.6.6.3.3.cmml">d</mi></msub><mi id="S3.E3.m1.8.8.6.6.6.2.3" xref="S3.E3.m1.8.8.6.6.6.2.3.cmml">d</mi></msubsup><mo id="S3.E3.m1.9.9.7.7.15" xref="S3.E3.m1.9.9.7.8.cmml">,</mo><mrow id="S3.E3.m1.9.9.7.7.7.1" xref="S3.E3.m1.9.9.7.7.7.2.cmml"><mo id="S3.E3.m1.9.9.7.7.7.1.2" stretchy="false" xref="S3.E3.m1.9.9.7.7.7.2.1.cmml">[</mo><mrow id="S3.E3.m1.9.9.7.7.7.1.1" xref="S3.E3.m1.9.9.7.7.7.1.1.cmml"><mi id="S3.E3.m1.9.9.7.7.7.1.1.2" xref="S3.E3.m1.9.9.7.7.7.1.1.2.cmml">E</mi><mo id="S3.E3.m1.9.9.7.7.7.1.1.1" xref="S3.E3.m1.9.9.7.7.7.1.1.1.cmml">â¢</mo><mi id="S3.E3.m1.9.9.7.7.7.1.1.3" xref="S3.E3.m1.9.9.7.7.7.1.1.3.cmml">O</mi><mo id="S3.E3.m1.9.9.7.7.7.1.1.1a" xref="S3.E3.m1.9.9.7.7.7.1.1.1.cmml">â¢</mo><mi id="S3.E3.m1.9.9.7.7.7.1.1.4" xref="S3.E3.m1.9.9.7.7.7.1.1.4.cmml">S</mi></mrow><mo id="S3.E3.m1.9.9.7.7.7.1.3" stretchy="false" xref="S3.E3.m1.9.9.7.7.7.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.9b"><apply id="S3.E3.m1.9.9.cmml" xref="S3.E3.m1.9.9"><eq id="S3.E3.m1.9.9.8.cmml" xref="S3.E3.m1.9.9.8"></eq><apply id="S3.E3.m1.9.9.9.cmml" xref="S3.E3.m1.9.9.9"><times id="S3.E3.m1.9.9.9.1.cmml" xref="S3.E3.m1.9.9.9.1"></times><ci id="S3.E3.m1.9.9.9.2.cmml" xref="S3.E3.m1.9.9.9.2">ğ¼</ci><ci id="S3.E3.m1.9.9.9.3.cmml" xref="S3.E3.m1.9.9.9.3">ğ‘›</ci><ci id="S3.E3.m1.9.9.9.4.cmml" xref="S3.E3.m1.9.9.9.4">ğ‘</ci><ci id="S3.E3.m1.9.9.9.5.cmml" xref="S3.E3.m1.9.9.9.5">ğ‘¢</ci><ci id="S3.E3.m1.9.9.9.6.cmml" xref="S3.E3.m1.9.9.9.6">ğ‘¡</ci></apply><list id="S3.E3.m1.9.9.7.8.cmml" xref="S3.E3.m1.9.9.7.7"><apply id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1"><times id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1"></times><ci id="S3.E3.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.2">ğ¶</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3">ğ¿</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.4.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.4">ğ‘†</ci></apply></apply><apply id="S3.E3.m1.4.4.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.2">subscript</csymbol><apply id="S3.E3.m1.4.4.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.2">superscript</csymbol><ci id="S3.E3.m1.4.4.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2.2.2">ğ‘¡</ci><ci id="S3.E3.m1.4.4.2.2.2.2.3.cmml" xref="S3.E3.m1.4.4.2.2.2.2.3">ğ‘</ci></apply><cn id="S3.E3.m1.4.4.2.2.2.3.cmml" type="integer" xref="S3.E3.m1.4.4.2.2.2.3">1</cn></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">â€¦</ci><apply id="S3.E3.m1.5.5.3.3.3.cmml" xref="S3.E3.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.3.3.3.1.cmml" xref="S3.E3.m1.5.5.3.3.3">subscript</csymbol><apply id="S3.E3.m1.5.5.3.3.3.2.cmml" xref="S3.E3.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.3.3.3.2.1.cmml" xref="S3.E3.m1.5.5.3.3.3">superscript</csymbol><ci id="S3.E3.m1.5.5.3.3.3.2.2.cmml" xref="S3.E3.m1.5.5.3.3.3.2.2">ğ‘¡</ci><ci id="S3.E3.m1.5.5.3.3.3.2.3.cmml" xref="S3.E3.m1.5.5.3.3.3.2.3">ğ‘</ci></apply><apply id="S3.E3.m1.5.5.3.3.3.3.cmml" xref="S3.E3.m1.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.3.3.3.3.1.cmml" xref="S3.E3.m1.5.5.3.3.3.3">subscript</csymbol><ci id="S3.E3.m1.5.5.3.3.3.3.2.cmml" xref="S3.E3.m1.5.5.3.3.3.3.2">ğ‘›</ci><ci id="S3.E3.m1.5.5.3.3.3.3.3.cmml" xref="S3.E3.m1.5.5.3.3.3.3.3">ğ‘</ci></apply></apply><apply id="S3.E3.m1.6.6.4.4.4.2.cmml" xref="S3.E3.m1.6.6.4.4.4.1"><csymbol cd="latexml" id="S3.E3.m1.6.6.4.4.4.2.1.cmml" xref="S3.E3.m1.6.6.4.4.4.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.6.6.4.4.4.1.1.cmml" xref="S3.E3.m1.6.6.4.4.4.1.1"><times id="S3.E3.m1.6.6.4.4.4.1.1.1.cmml" xref="S3.E3.m1.6.6.4.4.4.1.1.1"></times><ci id="S3.E3.m1.6.6.4.4.4.1.1.2.cmml" xref="S3.E3.m1.6.6.4.4.4.1.1.2">ğ‘†</ci><ci id="S3.E3.m1.6.6.4.4.4.1.1.3.cmml" xref="S3.E3.m1.6.6.4.4.4.1.1.3">ğ¸</ci><ci id="S3.E3.m1.6.6.4.4.4.1.1.4.cmml" xref="S3.E3.m1.6.6.4.4.4.1.1.4">ğ‘ƒ</ci></apply></apply><apply id="S3.E3.m1.7.7.5.5.5.cmml" xref="S3.E3.m1.7.7.5.5.5"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.5.5.5.1.cmml" xref="S3.E3.m1.7.7.5.5.5">subscript</csymbol><apply id="S3.E3.m1.7.7.5.5.5.2.cmml" xref="S3.E3.m1.7.7.5.5.5"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.5.5.5.2.1.cmml" xref="S3.E3.m1.7.7.5.5.5">superscript</csymbol><ci id="S3.E3.m1.7.7.5.5.5.2.2.cmml" xref="S3.E3.m1.7.7.5.5.5.2.2">ğ‘¡</ci><ci id="S3.E3.m1.7.7.5.5.5.2.3.cmml" xref="S3.E3.m1.7.7.5.5.5.2.3">ğ‘‘</ci></apply><cn id="S3.E3.m1.7.7.5.5.5.3.cmml" type="integer" xref="S3.E3.m1.7.7.5.5.5.3">1</cn></apply><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">â€¦</ci><apply id="S3.E3.m1.8.8.6.6.6.cmml" xref="S3.E3.m1.8.8.6.6.6"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.6.6.6.1.cmml" xref="S3.E3.m1.8.8.6.6.6">subscript</csymbol><apply id="S3.E3.m1.8.8.6.6.6.2.cmml" xref="S3.E3.m1.8.8.6.6.6"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.6.6.6.2.1.cmml" xref="S3.E3.m1.8.8.6.6.6">superscript</csymbol><ci id="S3.E3.m1.8.8.6.6.6.2.2.cmml" xref="S3.E3.m1.8.8.6.6.6.2.2">ğ‘¡</ci><ci id="S3.E3.m1.8.8.6.6.6.2.3.cmml" xref="S3.E3.m1.8.8.6.6.6.2.3">ğ‘‘</ci></apply><apply id="S3.E3.m1.8.8.6.6.6.3.cmml" xref="S3.E3.m1.8.8.6.6.6.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.6.6.6.3.1.cmml" xref="S3.E3.m1.8.8.6.6.6.3">subscript</csymbol><ci id="S3.E3.m1.8.8.6.6.6.3.2.cmml" xref="S3.E3.m1.8.8.6.6.6.3.2">ğ‘›</ci><ci id="S3.E3.m1.8.8.6.6.6.3.3.cmml" xref="S3.E3.m1.8.8.6.6.6.3.3">ğ‘‘</ci></apply></apply><apply id="S3.E3.m1.9.9.7.7.7.2.cmml" xref="S3.E3.m1.9.9.7.7.7.1"><csymbol cd="latexml" id="S3.E3.m1.9.9.7.7.7.2.1.cmml" xref="S3.E3.m1.9.9.7.7.7.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.9.9.7.7.7.1.1.cmml" xref="S3.E3.m1.9.9.7.7.7.1.1"><times id="S3.E3.m1.9.9.7.7.7.1.1.1.cmml" xref="S3.E3.m1.9.9.7.7.7.1.1.1"></times><ci id="S3.E3.m1.9.9.7.7.7.1.1.2.cmml" xref="S3.E3.m1.9.9.7.7.7.1.1.2">ğ¸</ci><ci id="S3.E3.m1.9.9.7.7.7.1.1.3.cmml" xref="S3.E3.m1.9.9.7.7.7.1.1.3">ğ‘‚</ci><ci id="S3.E3.m1.9.9.7.7.7.1.1.4.cmml" xref="S3.E3.m1.9.9.7.7.7.1.1.4">ğ‘†</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.9c">Input=[CLS],{t}^{q}_{1},...,{t}^{q}_{n_{q}},[SEP],{t}^{d}_{1},...,{t}^{d}_{n_{%
d}},[EOS]</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.9d">italic_I italic_n italic_p italic_u italic_t = [ italic_C italic_L italic_S ] , italic_t start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , italic_t start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT , [ italic_S italic_E italic_P ] , italic_t start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , italic_t start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUBSCRIPT , [ italic_E italic_O italic_S ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p4">
<p class="ltx_p" id="S3.SS2.SSS1.p4.15">where <math alttext="[CLS]" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.1.m1.1"><semantics id="S3.SS2.SSS1.p4.1.m1.1a"><mrow id="S3.SS2.SSS1.p4.1.m1.1.1.1" xref="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml"><mo id="S3.SS2.SSS1.p4.1.m1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p4.1.m1.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.SSS1.p4.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.1.m1.1.1.1.1.2" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1.2.cmml">C</mi><mo id="S3.SS2.SSS1.p4.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.1.m1.1.1.1.1.3" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1.3.cmml">L</mi><mo id="S3.SS2.SSS1.p4.1.m1.1.1.1.1.1a" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.1.m1.1.1.1.1.4" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S3.SS2.SSS1.p4.1.m1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p4.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.1.m1.1b"><apply id="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p4.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS1.p4.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1"><times id="S3.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p4.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1.2">ğ¶</ci><ci id="S3.SS2.SSS1.p4.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1.3">ğ¿</ci><ci id="S3.SS2.SSS1.p4.1.m1.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.1.4">ğ‘†</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.1.m1.1c">[CLS]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.1.m1.1d">[ italic_C italic_L italic_S ]</annotation></semantics></math> and <math alttext="[EOS]" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.2.m2.1"><semantics id="S3.SS2.SSS1.p4.2.m2.1a"><mrow id="S3.SS2.SSS1.p4.2.m2.1.1.1" xref="S3.SS2.SSS1.p4.2.m2.1.1.2.cmml"><mo id="S3.SS2.SSS1.p4.2.m2.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p4.2.m2.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.SSS1.p4.2.m2.1.1.1.1" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.2.m2.1.1.1.1.2" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1.2.cmml">E</mi><mo id="S3.SS2.SSS1.p4.2.m2.1.1.1.1.1" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.2.m2.1.1.1.1.3" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1.3.cmml">O</mi><mo id="S3.SS2.SSS1.p4.2.m2.1.1.1.1.1a" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.2.m2.1.1.1.1.4" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1.4.cmml">S</mi></mrow><mo id="S3.SS2.SSS1.p4.2.m2.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p4.2.m2.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.2.m2.1b"><apply id="S3.SS2.SSS1.p4.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p4.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS1.p4.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1"><times id="S3.SS2.SSS1.p4.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p4.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1.2">ğ¸</ci><ci id="S3.SS2.SSS1.p4.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1.3">ğ‘‚</ci><ci id="S3.SS2.SSS1.p4.2.m2.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1.1.1.4">ğ‘†</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.2.m2.1c">[EOS]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.2.m2.1d">[ italic_E italic_O italic_S ]</annotation></semantics></math> are popular tokens in language processing to indicate the beginning and the ending of the input, <math alttext="[SEP]" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.3.m3.1"><semantics id="S3.SS2.SSS1.p4.3.m3.1a"><mrow id="S3.SS2.SSS1.p4.3.m3.1.1.1" xref="S3.SS2.SSS1.p4.3.m3.1.1.2.cmml"><mo id="S3.SS2.SSS1.p4.3.m3.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p4.3.m3.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.SSS1.p4.3.m3.1.1.1.1" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.1.1.1.1.2" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1.2.cmml">S</mi><mo id="S3.SS2.SSS1.p4.3.m3.1.1.1.1.1" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.3.m3.1.1.1.1.3" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1.3.cmml">E</mi><mo id="S3.SS2.SSS1.p4.3.m3.1.1.1.1.1a" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.3.m3.1.1.1.1.4" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1.4.cmml">P</mi></mrow><mo id="S3.SS2.SSS1.p4.3.m3.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p4.3.m3.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.3.m3.1b"><apply id="S3.SS2.SSS1.p4.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p4.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS1.p4.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1"><times id="S3.SS2.SSS1.p4.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p4.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1.2">ğ‘†</ci><ci id="S3.SS2.SSS1.p4.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1.3">ğ¸</ci><ci id="S3.SS2.SSS1.p4.3.m3.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.1.1.4">ğ‘ƒ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.3.m3.1c">[SEP]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.3.m3.1d">[ italic_S italic_E italic_P ]</annotation></semantics></math> is a special token to separate the query and the document, <math alttext="{t}^{q}_{1},...{t}^{q}_{n_{q}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.4.m4.2"><semantics id="S3.SS2.SSS1.p4.4.m4.2a"><mrow id="S3.SS2.SSS1.p4.4.m4.2.2.2" xref="S3.SS2.SSS1.p4.4.m4.2.2.3.cmml"><msubsup id="S3.SS2.SSS1.p4.4.m4.1.1.1.1" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.4.m4.1.1.1.1.2.2" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1.2.2.cmml">t</mi><mn id="S3.SS2.SSS1.p4.4.m4.1.1.1.1.3" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1.3.cmml">1</mn><mi id="S3.SS2.SSS1.p4.4.m4.1.1.1.1.2.3" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1.2.3.cmml">q</mi></msubsup><mo id="S3.SS2.SSS1.p4.4.m4.2.2.2.3" xref="S3.SS2.SSS1.p4.4.m4.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS1.p4.4.m4.2.2.2.2" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.cmml"><mi id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.2" mathvariant="normal" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.2.cmml">â€¦</mi><mo id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.1" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.1.cmml">â¢</mo><msubsup id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.cmml"><mi id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.2.2" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.2.2.cmml">t</mi><msub id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.cmml"><mi id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.2" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.2.cmml">n</mi><mi id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.3" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.3.cmml">q</mi></msub><mi id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.2.3" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.2.3.cmml">q</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.4.m4.2b"><list id="S3.SS2.SSS1.p4.4.m4.2.2.3.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2"><apply id="S3.SS2.SSS1.p4.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p4.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.4.m4.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p4.4.m4.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1.2.2">ğ‘¡</ci><ci id="S3.SS2.SSS1.p4.4.m4.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1.2.3">ğ‘</ci></apply><cn id="S3.SS2.SSS1.p4.4.m4.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS1.p4.4.m4.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2"><times id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.1"></times><ci id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.2">â€¦</ci><apply id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3">subscript</csymbol><apply id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.2.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3">superscript</csymbol><ci id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.2.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.2.2">ğ‘¡</ci><ci id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.2.3.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.2.3">ğ‘</ci></apply><apply id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.2.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.2">ğ‘›</ci><ci id="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.3.cmml" xref="S3.SS2.SSS1.p4.4.m4.2.2.2.2.3.3.3">ğ‘</ci></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.4.m4.2c">{t}^{q}_{1},...{t}^{q}_{n_{q}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.4.m4.2d">italic_t start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ italic_t start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{t}^{d}_{1},...{t}^{d}_{n_{d}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.5.m5.2"><semantics id="S3.SS2.SSS1.p4.5.m5.2a"><mrow id="S3.SS2.SSS1.p4.5.m5.2.2.2" xref="S3.SS2.SSS1.p4.5.m5.2.2.3.cmml"><msubsup id="S3.SS2.SSS1.p4.5.m5.1.1.1.1" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.5.m5.1.1.1.1.2.2" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1.2.2.cmml">t</mi><mn id="S3.SS2.SSS1.p4.5.m5.1.1.1.1.3" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1.3.cmml">1</mn><mi id="S3.SS2.SSS1.p4.5.m5.1.1.1.1.2.3" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1.2.3.cmml">d</mi></msubsup><mo id="S3.SS2.SSS1.p4.5.m5.2.2.2.3" xref="S3.SS2.SSS1.p4.5.m5.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS1.p4.5.m5.2.2.2.2" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.cmml"><mi id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.2" mathvariant="normal" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.2.cmml">â€¦</mi><mo id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.1" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.1.cmml">â¢</mo><msubsup id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.cmml"><mi id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.2.2" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.2.2.cmml">t</mi><msub id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.cmml"><mi id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.2" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.2.cmml">n</mi><mi id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.3" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.3.cmml">d</mi></msub><mi id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.2.3" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.2.3.cmml">d</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.5.m5.2b"><list id="S3.SS2.SSS1.p4.5.m5.2.2.3.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2"><apply id="S3.SS2.SSS1.p4.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p4.5.m5.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p4.5.m5.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1.2.2">ğ‘¡</ci><ci id="S3.SS2.SSS1.p4.5.m5.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1.2.3">ğ‘‘</ci></apply><cn id="S3.SS2.SSS1.p4.5.m5.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS1.p4.5.m5.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2"><times id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.1"></times><ci id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.2">â€¦</ci><apply id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.1.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3">subscript</csymbol><apply id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.2.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.2.1.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3">superscript</csymbol><ci id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.2.2.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.2.2">ğ‘¡</ci><ci id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.2.3.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.2.3">ğ‘‘</ci></apply><apply id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.1.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.2.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.2">ğ‘›</ci><ci id="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.3.cmml" xref="S3.SS2.SSS1.p4.5.m5.2.2.2.2.3.3.3">ğ‘‘</ci></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.5.m5.2c">{t}^{d}_{1},...{t}^{d}_{n_{d}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.5.m5.2d">italic_t start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ italic_t start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> are token sequences representing the query and the document respectively. We use Llama-3.1-8B-Instruct <cite class="ltx_cite ltx_citemacro_citep">(Meta, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib61" title="">2024</a>)</cite> as our pre-trained language model. We follow the design in <cite class="ltx_cite ltx_citemacro_citet">Wang etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib93" title="">2024</a>)</cite> to build the reward model. In more details, we first use the vector embedding of <math alttext="[SEP]" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.6.m6.1"><semantics id="S3.SS2.SSS1.p4.6.m6.1a"><mrow id="S3.SS2.SSS1.p4.6.m6.1.1.1" xref="S3.SS2.SSS1.p4.6.m6.1.1.2.cmml"><mo id="S3.SS2.SSS1.p4.6.m6.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p4.6.m6.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.SSS1.p4.6.m6.1.1.1.1" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.6.m6.1.1.1.1.2" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1.2.cmml">S</mi><mo id="S3.SS2.SSS1.p4.6.m6.1.1.1.1.1" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.6.m6.1.1.1.1.3" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1.3.cmml">E</mi><mo id="S3.SS2.SSS1.p4.6.m6.1.1.1.1.1a" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.6.m6.1.1.1.1.4" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1.4.cmml">P</mi></mrow><mo id="S3.SS2.SSS1.p4.6.m6.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p4.6.m6.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.6.m6.1b"><apply id="S3.SS2.SSS1.p4.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p4.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS1.p4.6.m6.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1"><times id="S3.SS2.SSS1.p4.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p4.6.m6.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1.2">ğ‘†</ci><ci id="S3.SS2.SSS1.p4.6.m6.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1.3">ğ¸</ci><ci id="S3.SS2.SSS1.p4.6.m6.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.1.1.1.4">ğ‘ƒ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.6.m6.1c">[SEP]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.6.m6.1d">[ italic_S italic_E italic_P ]</annotation></semantics></math> token and <math alttext="[EOS]" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.7.m7.1"><semantics id="S3.SS2.SSS1.p4.7.m7.1a"><mrow id="S3.SS2.SSS1.p4.7.m7.1.1.1" xref="S3.SS2.SSS1.p4.7.m7.1.1.2.cmml"><mo id="S3.SS2.SSS1.p4.7.m7.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p4.7.m7.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.SSS1.p4.7.m7.1.1.1.1" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.7.m7.1.1.1.1.2" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1.2.cmml">E</mi><mo id="S3.SS2.SSS1.p4.7.m7.1.1.1.1.1" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.7.m7.1.1.1.1.3" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1.3.cmml">O</mi><mo id="S3.SS2.SSS1.p4.7.m7.1.1.1.1.1a" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.7.m7.1.1.1.1.4" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1.4.cmml">S</mi></mrow><mo id="S3.SS2.SSS1.p4.7.m7.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p4.7.m7.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.7.m7.1b"><apply id="S3.SS2.SSS1.p4.7.m7.1.1.2.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p4.7.m7.1.1.2.1.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS1.p4.7.m7.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1"><times id="S3.SS2.SSS1.p4.7.m7.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p4.7.m7.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1.2">ğ¸</ci><ci id="S3.SS2.SSS1.p4.7.m7.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1.3">ğ‘‚</ci><ci id="S3.SS2.SSS1.p4.7.m7.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.1.1.1.4">ğ‘†</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.7.m7.1c">[EOS]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.7.m7.1d">[ italic_E italic_O italic_S ]</annotation></semantics></math> token from the final decoder layer as the vector representation for the query (denote as <math alttext="Emb_{q}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.8.m8.1"><semantics id="S3.SS2.SSS1.p4.8.m8.1a"><mrow id="S3.SS2.SSS1.p4.8.m8.1.1" xref="S3.SS2.SSS1.p4.8.m8.1.1.cmml"><mi id="S3.SS2.SSS1.p4.8.m8.1.1.2" xref="S3.SS2.SSS1.p4.8.m8.1.1.2.cmml">E</mi><mo id="S3.SS2.SSS1.p4.8.m8.1.1.1" xref="S3.SS2.SSS1.p4.8.m8.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.8.m8.1.1.3" xref="S3.SS2.SSS1.p4.8.m8.1.1.3.cmml">m</mi><mo id="S3.SS2.SSS1.p4.8.m8.1.1.1a" xref="S3.SS2.SSS1.p4.8.m8.1.1.1.cmml">â¢</mo><msub id="S3.SS2.SSS1.p4.8.m8.1.1.4" xref="S3.SS2.SSS1.p4.8.m8.1.1.4.cmml"><mi id="S3.SS2.SSS1.p4.8.m8.1.1.4.2" xref="S3.SS2.SSS1.p4.8.m8.1.1.4.2.cmml">b</mi><mi id="S3.SS2.SSS1.p4.8.m8.1.1.4.3" xref="S3.SS2.SSS1.p4.8.m8.1.1.4.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.8.m8.1b"><apply id="S3.SS2.SSS1.p4.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.1"><times id="S3.SS2.SSS1.p4.8.m8.1.1.1.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.1.1"></times><ci id="S3.SS2.SSS1.p4.8.m8.1.1.2.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.1.2">ğ¸</ci><ci id="S3.SS2.SSS1.p4.8.m8.1.1.3.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.1.3">ğ‘š</ci><apply id="S3.SS2.SSS1.p4.8.m8.1.1.4.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.8.m8.1.1.4.1.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS1.p4.8.m8.1.1.4.2.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.1.4.2">ğ‘</ci><ci id="S3.SS2.SSS1.p4.8.m8.1.1.4.3.cmml" xref="S3.SS2.SSS1.p4.8.m8.1.1.4.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.8.m8.1c">Emb_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.8.m8.1d">italic_E italic_m italic_b start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>) and the whole prompt input (denote as <math alttext="Emb_{p}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.9.m9.1"><semantics id="S3.SS2.SSS1.p4.9.m9.1a"><mrow id="S3.SS2.SSS1.p4.9.m9.1.1" xref="S3.SS2.SSS1.p4.9.m9.1.1.cmml"><mi id="S3.SS2.SSS1.p4.9.m9.1.1.2" xref="S3.SS2.SSS1.p4.9.m9.1.1.2.cmml">E</mi><mo id="S3.SS2.SSS1.p4.9.m9.1.1.1" xref="S3.SS2.SSS1.p4.9.m9.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.9.m9.1.1.3" xref="S3.SS2.SSS1.p4.9.m9.1.1.3.cmml">m</mi><mo id="S3.SS2.SSS1.p4.9.m9.1.1.1a" xref="S3.SS2.SSS1.p4.9.m9.1.1.1.cmml">â¢</mo><msub id="S3.SS2.SSS1.p4.9.m9.1.1.4" xref="S3.SS2.SSS1.p4.9.m9.1.1.4.cmml"><mi id="S3.SS2.SSS1.p4.9.m9.1.1.4.2" xref="S3.SS2.SSS1.p4.9.m9.1.1.4.2.cmml">b</mi><mi id="S3.SS2.SSS1.p4.9.m9.1.1.4.3" xref="S3.SS2.SSS1.p4.9.m9.1.1.4.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.9.m9.1b"><apply id="S3.SS2.SSS1.p4.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p4.9.m9.1.1"><times id="S3.SS2.SSS1.p4.9.m9.1.1.1.cmml" xref="S3.SS2.SSS1.p4.9.m9.1.1.1"></times><ci id="S3.SS2.SSS1.p4.9.m9.1.1.2.cmml" xref="S3.SS2.SSS1.p4.9.m9.1.1.2">ğ¸</ci><ci id="S3.SS2.SSS1.p4.9.m9.1.1.3.cmml" xref="S3.SS2.SSS1.p4.9.m9.1.1.3">ğ‘š</ci><apply id="S3.SS2.SSS1.p4.9.m9.1.1.4.cmml" xref="S3.SS2.SSS1.p4.9.m9.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.9.m9.1.1.4.1.cmml" xref="S3.SS2.SSS1.p4.9.m9.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS1.p4.9.m9.1.1.4.2.cmml" xref="S3.SS2.SSS1.p4.9.m9.1.1.4.2">ğ‘</ci><ci id="S3.SS2.SSS1.p4.9.m9.1.1.4.3.cmml" xref="S3.SS2.SSS1.p4.9.m9.1.1.4.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.9.m9.1c">Emb_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.9.m9.1d">italic_E italic_m italic_b start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>) respectively. We then feed <math alttext="Emb_{p}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.10.m10.1"><semantics id="S3.SS2.SSS1.p4.10.m10.1a"><mrow id="S3.SS2.SSS1.p4.10.m10.1.1" xref="S3.SS2.SSS1.p4.10.m10.1.1.cmml"><mi id="S3.SS2.SSS1.p4.10.m10.1.1.2" xref="S3.SS2.SSS1.p4.10.m10.1.1.2.cmml">E</mi><mo id="S3.SS2.SSS1.p4.10.m10.1.1.1" xref="S3.SS2.SSS1.p4.10.m10.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.10.m10.1.1.3" xref="S3.SS2.SSS1.p4.10.m10.1.1.3.cmml">m</mi><mo id="S3.SS2.SSS1.p4.10.m10.1.1.1a" xref="S3.SS2.SSS1.p4.10.m10.1.1.1.cmml">â¢</mo><msub id="S3.SS2.SSS1.p4.10.m10.1.1.4" xref="S3.SS2.SSS1.p4.10.m10.1.1.4.cmml"><mi id="S3.SS2.SSS1.p4.10.m10.1.1.4.2" xref="S3.SS2.SSS1.p4.10.m10.1.1.4.2.cmml">b</mi><mi id="S3.SS2.SSS1.p4.10.m10.1.1.4.3" xref="S3.SS2.SSS1.p4.10.m10.1.1.4.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.10.m10.1b"><apply id="S3.SS2.SSS1.p4.10.m10.1.1.cmml" xref="S3.SS2.SSS1.p4.10.m10.1.1"><times id="S3.SS2.SSS1.p4.10.m10.1.1.1.cmml" xref="S3.SS2.SSS1.p4.10.m10.1.1.1"></times><ci id="S3.SS2.SSS1.p4.10.m10.1.1.2.cmml" xref="S3.SS2.SSS1.p4.10.m10.1.1.2">ğ¸</ci><ci id="S3.SS2.SSS1.p4.10.m10.1.1.3.cmml" xref="S3.SS2.SSS1.p4.10.m10.1.1.3">ğ‘š</ci><apply id="S3.SS2.SSS1.p4.10.m10.1.1.4.cmml" xref="S3.SS2.SSS1.p4.10.m10.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.10.m10.1.1.4.1.cmml" xref="S3.SS2.SSS1.p4.10.m10.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS1.p4.10.m10.1.1.4.2.cmml" xref="S3.SS2.SSS1.p4.10.m10.1.1.4.2">ğ‘</ci><ci id="S3.SS2.SSS1.p4.10.m10.1.1.4.3.cmml" xref="S3.SS2.SSS1.p4.10.m10.1.1.4.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.10.m10.1c">Emb_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.10.m10.1d">italic_E italic_m italic_b start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> through a linear layer to obtain a <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.11.m11.1"><semantics id="S3.SS2.SSS1.p4.11.m11.1a"><mi id="S3.SS2.SSS1.p4.11.m11.1.1" xref="S3.SS2.SSS1.p4.11.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.11.m11.1b"><ci id="S3.SS2.SSS1.p4.11.m11.1.1.cmml" xref="S3.SS2.SSS1.p4.11.m11.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.11.m11.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.11.m11.1d">italic_k</annotation></semantics></math>-dimensional vector prediction. To map the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.12.m12.1"><semantics id="S3.SS2.SSS1.p4.12.m12.1a"><mi id="S3.SS2.SSS1.p4.12.m12.1.1" xref="S3.SS2.SSS1.p4.12.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.12.m12.1b"><ci id="S3.SS2.SSS1.p4.12.m12.1.1.cmml" xref="S3.SS2.SSS1.p4.12.m12.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.12.m12.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.12.m12.1d">italic_k</annotation></semantics></math>-dimensional vector to a scalar reward, we calculate a coefficients vector by first using 2-layers MLP take the <math alttext="Emb_{q}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.13.m13.1"><semantics id="S3.SS2.SSS1.p4.13.m13.1a"><mrow id="S3.SS2.SSS1.p4.13.m13.1.1" xref="S3.SS2.SSS1.p4.13.m13.1.1.cmml"><mi id="S3.SS2.SSS1.p4.13.m13.1.1.2" xref="S3.SS2.SSS1.p4.13.m13.1.1.2.cmml">E</mi><mo id="S3.SS2.SSS1.p4.13.m13.1.1.1" xref="S3.SS2.SSS1.p4.13.m13.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.13.m13.1.1.3" xref="S3.SS2.SSS1.p4.13.m13.1.1.3.cmml">m</mi><mo id="S3.SS2.SSS1.p4.13.m13.1.1.1a" xref="S3.SS2.SSS1.p4.13.m13.1.1.1.cmml">â¢</mo><msub id="S3.SS2.SSS1.p4.13.m13.1.1.4" xref="S3.SS2.SSS1.p4.13.m13.1.1.4.cmml"><mi id="S3.SS2.SSS1.p4.13.m13.1.1.4.2" xref="S3.SS2.SSS1.p4.13.m13.1.1.4.2.cmml">b</mi><mi id="S3.SS2.SSS1.p4.13.m13.1.1.4.3" xref="S3.SS2.SSS1.p4.13.m13.1.1.4.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.13.m13.1b"><apply id="S3.SS2.SSS1.p4.13.m13.1.1.cmml" xref="S3.SS2.SSS1.p4.13.m13.1.1"><times id="S3.SS2.SSS1.p4.13.m13.1.1.1.cmml" xref="S3.SS2.SSS1.p4.13.m13.1.1.1"></times><ci id="S3.SS2.SSS1.p4.13.m13.1.1.2.cmml" xref="S3.SS2.SSS1.p4.13.m13.1.1.2">ğ¸</ci><ci id="S3.SS2.SSS1.p4.13.m13.1.1.3.cmml" xref="S3.SS2.SSS1.p4.13.m13.1.1.3">ğ‘š</ci><apply id="S3.SS2.SSS1.p4.13.m13.1.1.4.cmml" xref="S3.SS2.SSS1.p4.13.m13.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.13.m13.1.1.4.1.cmml" xref="S3.SS2.SSS1.p4.13.m13.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS1.p4.13.m13.1.1.4.2.cmml" xref="S3.SS2.SSS1.p4.13.m13.1.1.4.2">ğ‘</ci><ci id="S3.SS2.SSS1.p4.13.m13.1.1.4.3.cmml" xref="S3.SS2.SSS1.p4.13.m13.1.1.4.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.13.m13.1c">Emb_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.13.m13.1d">italic_E italic_m italic_b start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> to output a <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.14.m14.1"><semantics id="S3.SS2.SSS1.p4.14.m14.1a"><mi id="S3.SS2.SSS1.p4.14.m14.1.1" xref="S3.SS2.SSS1.p4.14.m14.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.14.m14.1b"><ci id="S3.SS2.SSS1.p4.14.m14.1.1.cmml" xref="S3.SS2.SSS1.p4.14.m14.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.14.m14.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.14.m14.1d">italic_k</annotation></semantics></math>-dimensional vector, followed by a softmax function, then multiply the coefficients vector to the reward vector prediction from <math alttext="Emb_{p}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.15.m15.1"><semantics id="S3.SS2.SSS1.p4.15.m15.1a"><mrow id="S3.SS2.SSS1.p4.15.m15.1.1" xref="S3.SS2.SSS1.p4.15.m15.1.1.cmml"><mi id="S3.SS2.SSS1.p4.15.m15.1.1.2" xref="S3.SS2.SSS1.p4.15.m15.1.1.2.cmml">E</mi><mo id="S3.SS2.SSS1.p4.15.m15.1.1.1" xref="S3.SS2.SSS1.p4.15.m15.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS1.p4.15.m15.1.1.3" xref="S3.SS2.SSS1.p4.15.m15.1.1.3.cmml">m</mi><mo id="S3.SS2.SSS1.p4.15.m15.1.1.1a" xref="S3.SS2.SSS1.p4.15.m15.1.1.1.cmml">â¢</mo><msub id="S3.SS2.SSS1.p4.15.m15.1.1.4" xref="S3.SS2.SSS1.p4.15.m15.1.1.4.cmml"><mi id="S3.SS2.SSS1.p4.15.m15.1.1.4.2" xref="S3.SS2.SSS1.p4.15.m15.1.1.4.2.cmml">b</mi><mi id="S3.SS2.SSS1.p4.15.m15.1.1.4.3" xref="S3.SS2.SSS1.p4.15.m15.1.1.4.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.15.m15.1b"><apply id="S3.SS2.SSS1.p4.15.m15.1.1.cmml" xref="S3.SS2.SSS1.p4.15.m15.1.1"><times id="S3.SS2.SSS1.p4.15.m15.1.1.1.cmml" xref="S3.SS2.SSS1.p4.15.m15.1.1.1"></times><ci id="S3.SS2.SSS1.p4.15.m15.1.1.2.cmml" xref="S3.SS2.SSS1.p4.15.m15.1.1.2">ğ¸</ci><ci id="S3.SS2.SSS1.p4.15.m15.1.1.3.cmml" xref="S3.SS2.SSS1.p4.15.m15.1.1.3">ğ‘š</ci><apply id="S3.SS2.SSS1.p4.15.m15.1.1.4.cmml" xref="S3.SS2.SSS1.p4.15.m15.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.15.m15.1.1.4.1.cmml" xref="S3.SS2.SSS1.p4.15.m15.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS1.p4.15.m15.1.1.4.2.cmml" xref="S3.SS2.SSS1.p4.15.m15.1.1.4.2">ğ‘</ci><ci id="S3.SS2.SSS1.p4.15.m15.1.1.4.3.cmml" xref="S3.SS2.SSS1.p4.15.m15.1.1.4.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.15.m15.1c">Emb_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.15.m15.1d">italic_E italic_m italic_b start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p5">
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="A2.EGx1">
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle Emb_{q}=Decoder(Input)[-1][SEP]" class="ltx_Math" display="block" id="S3.Ex1.m1.3"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml"><mrow id="S3.Ex1.m1.3.3.5" xref="S3.Ex1.m1.3.3.5.cmml"><mi id="S3.Ex1.m1.3.3.5.2" xref="S3.Ex1.m1.3.3.5.2.cmml">E</mi><mo id="S3.Ex1.m1.3.3.5.1" xref="S3.Ex1.m1.3.3.5.1.cmml">â¢</mo><mi id="S3.Ex1.m1.3.3.5.3" xref="S3.Ex1.m1.3.3.5.3.cmml">m</mi><mo id="S3.Ex1.m1.3.3.5.1a" xref="S3.Ex1.m1.3.3.5.1.cmml">â¢</mo><msub id="S3.Ex1.m1.3.3.5.4" xref="S3.Ex1.m1.3.3.5.4.cmml"><mi id="S3.Ex1.m1.3.3.5.4.2" xref="S3.Ex1.m1.3.3.5.4.2.cmml">b</mi><mi id="S3.Ex1.m1.3.3.5.4.3" xref="S3.Ex1.m1.3.3.5.4.3.cmml">q</mi></msub></mrow><mo id="S3.Ex1.m1.3.3.4" xref="S3.Ex1.m1.3.3.4.cmml">=</mo><mrow id="S3.Ex1.m1.3.3.3" xref="S3.Ex1.m1.3.3.3.cmml"><mi id="S3.Ex1.m1.3.3.3.5" xref="S3.Ex1.m1.3.3.3.5.cmml">D</mi><mo id="S3.Ex1.m1.3.3.3.4" xref="S3.Ex1.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex1.m1.3.3.3.6" xref="S3.Ex1.m1.3.3.3.6.cmml">e</mi><mo id="S3.Ex1.m1.3.3.3.4a" xref="S3.Ex1.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex1.m1.3.3.3.7" xref="S3.Ex1.m1.3.3.3.7.cmml">c</mi><mo id="S3.Ex1.m1.3.3.3.4b" xref="S3.Ex1.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex1.m1.3.3.3.8" xref="S3.Ex1.m1.3.3.3.8.cmml">o</mi><mo id="S3.Ex1.m1.3.3.3.4c" xref="S3.Ex1.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex1.m1.3.3.3.9" xref="S3.Ex1.m1.3.3.3.9.cmml">d</mi><mo id="S3.Ex1.m1.3.3.3.4d" xref="S3.Ex1.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex1.m1.3.3.3.10" xref="S3.Ex1.m1.3.3.3.10.cmml">e</mi><mo id="S3.Ex1.m1.3.3.3.4e" xref="S3.Ex1.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex1.m1.3.3.3.11" xref="S3.Ex1.m1.3.3.3.11.cmml">r</mi><mo id="S3.Ex1.m1.3.3.3.4f" xref="S3.Ex1.m1.3.3.3.4.cmml">â¢</mo><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.cmml">I</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.cmml">n</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1a" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.4" xref="S3.Ex1.m1.1.1.1.1.1.1.4.cmml">p</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1b" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.5" xref="S3.Ex1.m1.1.1.1.1.1.1.5.cmml">u</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1c" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.6" xref="S3.Ex1.m1.1.1.1.1.1.1.6.cmml">t</mi></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex1.m1.3.3.3.4g" xref="S3.Ex1.m1.3.3.3.4.cmml">â¢</mo><mrow id="S3.Ex1.m1.2.2.2.2.1" xref="S3.Ex1.m1.2.2.2.2.2.cmml"><mo id="S3.Ex1.m1.2.2.2.2.1.2" stretchy="false" xref="S3.Ex1.m1.2.2.2.2.2.1.cmml">[</mo><mrow id="S3.Ex1.m1.2.2.2.2.1.1" xref="S3.Ex1.m1.2.2.2.2.1.1.cmml"><mo id="S3.Ex1.m1.2.2.2.2.1.1a" xref="S3.Ex1.m1.2.2.2.2.1.1.cmml">âˆ’</mo><mn id="S3.Ex1.m1.2.2.2.2.1.1.2" xref="S3.Ex1.m1.2.2.2.2.1.1.2.cmml">1</mn></mrow><mo id="S3.Ex1.m1.2.2.2.2.1.3" stretchy="false" xref="S3.Ex1.m1.2.2.2.2.2.1.cmml">]</mo></mrow><mo id="S3.Ex1.m1.3.3.3.4h" xref="S3.Ex1.m1.3.3.3.4.cmml">â¢</mo><mrow id="S3.Ex1.m1.3.3.3.3.1" xref="S3.Ex1.m1.3.3.3.3.2.cmml"><mo id="S3.Ex1.m1.3.3.3.3.1.2" stretchy="false" xref="S3.Ex1.m1.3.3.3.3.2.1.cmml">[</mo><mrow id="S3.Ex1.m1.3.3.3.3.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1.2" xref="S3.Ex1.m1.3.3.3.3.1.1.2.cmml">S</mi><mo id="S3.Ex1.m1.3.3.3.3.1.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.1.cmml">â¢</mo><mi id="S3.Ex1.m1.3.3.3.3.1.1.3" xref="S3.Ex1.m1.3.3.3.3.1.1.3.cmml">E</mi><mo id="S3.Ex1.m1.3.3.3.3.1.1.1a" xref="S3.Ex1.m1.3.3.3.3.1.1.1.cmml">â¢</mo><mi id="S3.Ex1.m1.3.3.3.3.1.1.4" xref="S3.Ex1.m1.3.3.3.3.1.1.4.cmml">P</mi></mrow><mo id="S3.Ex1.m1.3.3.3.3.1.3" stretchy="false" xref="S3.Ex1.m1.3.3.3.3.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3"><eq id="S3.Ex1.m1.3.3.4.cmml" xref="S3.Ex1.m1.3.3.4"></eq><apply id="S3.Ex1.m1.3.3.5.cmml" xref="S3.Ex1.m1.3.3.5"><times id="S3.Ex1.m1.3.3.5.1.cmml" xref="S3.Ex1.m1.3.3.5.1"></times><ci id="S3.Ex1.m1.3.3.5.2.cmml" xref="S3.Ex1.m1.3.3.5.2">ğ¸</ci><ci id="S3.Ex1.m1.3.3.5.3.cmml" xref="S3.Ex1.m1.3.3.5.3">ğ‘š</ci><apply id="S3.Ex1.m1.3.3.5.4.cmml" xref="S3.Ex1.m1.3.3.5.4"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.5.4.1.cmml" xref="S3.Ex1.m1.3.3.5.4">subscript</csymbol><ci id="S3.Ex1.m1.3.3.5.4.2.cmml" xref="S3.Ex1.m1.3.3.5.4.2">ğ‘</ci><ci id="S3.Ex1.m1.3.3.5.4.3.cmml" xref="S3.Ex1.m1.3.3.5.4.3">ğ‘</ci></apply></apply><apply id="S3.Ex1.m1.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3"><times id="S3.Ex1.m1.3.3.3.4.cmml" xref="S3.Ex1.m1.3.3.3.4"></times><ci id="S3.Ex1.m1.3.3.3.5.cmml" xref="S3.Ex1.m1.3.3.3.5">ğ·</ci><ci id="S3.Ex1.m1.3.3.3.6.cmml" xref="S3.Ex1.m1.3.3.3.6">ğ‘’</ci><ci id="S3.Ex1.m1.3.3.3.7.cmml" xref="S3.Ex1.m1.3.3.3.7">ğ‘</ci><ci id="S3.Ex1.m1.3.3.3.8.cmml" xref="S3.Ex1.m1.3.3.3.8">ğ‘œ</ci><ci id="S3.Ex1.m1.3.3.3.9.cmml" xref="S3.Ex1.m1.3.3.3.9">ğ‘‘</ci><ci id="S3.Ex1.m1.3.3.3.10.cmml" xref="S3.Ex1.m1.3.3.3.10">ğ‘’</ci><ci id="S3.Ex1.m1.3.3.3.11.cmml" xref="S3.Ex1.m1.3.3.3.11">ğ‘Ÿ</ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><times id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1"></times><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2">ğ¼</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3">ğ‘›</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.4.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4">ğ‘</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.5.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.5">ğ‘¢</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.6.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.6">ğ‘¡</ci></apply><apply id="S3.Ex1.m1.2.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.Ex1.m1.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m1.2.2.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1"><minus id="S3.Ex1.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1"></minus><cn id="S3.Ex1.m1.2.2.2.2.1.1.2.cmml" type="integer" xref="S3.Ex1.m1.2.2.2.2.1.1.2">1</cn></apply></apply><apply id="S3.Ex1.m1.3.3.3.3.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1"><csymbol cd="latexml" id="S3.Ex1.m1.3.3.3.3.2.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m1.3.3.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1"><times id="S3.Ex1.m1.3.3.3.3.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1"></times><ci id="S3.Ex1.m1.3.3.3.3.1.1.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.2">ğ‘†</ci><ci id="S3.Ex1.m1.3.3.3.3.1.1.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3">ğ¸</ci><ci id="S3.Ex1.m1.3.3.3.3.1.1.4.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.4">ğ‘ƒ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">\displaystyle Emb_{q}=Decoder(Input)[-1][SEP]</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.3d">italic_E italic_m italic_b start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = italic_D italic_e italic_c italic_o italic_d italic_e italic_r ( italic_I italic_n italic_p italic_u italic_t ) [ - 1 ] [ italic_S italic_E italic_P ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle Emb_{p}=Decoder(Input)[-1][EOS]" class="ltx_Math" display="block" id="S3.Ex2.m1.3"><semantics id="S3.Ex2.m1.3a"><mrow id="S3.Ex2.m1.3.3" xref="S3.Ex2.m1.3.3.cmml"><mrow id="S3.Ex2.m1.3.3.5" xref="S3.Ex2.m1.3.3.5.cmml"><mi id="S3.Ex2.m1.3.3.5.2" xref="S3.Ex2.m1.3.3.5.2.cmml">E</mi><mo id="S3.Ex2.m1.3.3.5.1" xref="S3.Ex2.m1.3.3.5.1.cmml">â¢</mo><mi id="S3.Ex2.m1.3.3.5.3" xref="S3.Ex2.m1.3.3.5.3.cmml">m</mi><mo id="S3.Ex2.m1.3.3.5.1a" xref="S3.Ex2.m1.3.3.5.1.cmml">â¢</mo><msub id="S3.Ex2.m1.3.3.5.4" xref="S3.Ex2.m1.3.3.5.4.cmml"><mi id="S3.Ex2.m1.3.3.5.4.2" xref="S3.Ex2.m1.3.3.5.4.2.cmml">b</mi><mi id="S3.Ex2.m1.3.3.5.4.3" xref="S3.Ex2.m1.3.3.5.4.3.cmml">p</mi></msub></mrow><mo id="S3.Ex2.m1.3.3.4" xref="S3.Ex2.m1.3.3.4.cmml">=</mo><mrow id="S3.Ex2.m1.3.3.3" xref="S3.Ex2.m1.3.3.3.cmml"><mi id="S3.Ex2.m1.3.3.3.5" xref="S3.Ex2.m1.3.3.3.5.cmml">D</mi><mo id="S3.Ex2.m1.3.3.3.4" xref="S3.Ex2.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex2.m1.3.3.3.6" xref="S3.Ex2.m1.3.3.3.6.cmml">e</mi><mo id="S3.Ex2.m1.3.3.3.4a" xref="S3.Ex2.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex2.m1.3.3.3.7" xref="S3.Ex2.m1.3.3.3.7.cmml">c</mi><mo id="S3.Ex2.m1.3.3.3.4b" xref="S3.Ex2.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex2.m1.3.3.3.8" xref="S3.Ex2.m1.3.3.3.8.cmml">o</mi><mo id="S3.Ex2.m1.3.3.3.4c" xref="S3.Ex2.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex2.m1.3.3.3.9" xref="S3.Ex2.m1.3.3.3.9.cmml">d</mi><mo id="S3.Ex2.m1.3.3.3.4d" xref="S3.Ex2.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex2.m1.3.3.3.10" xref="S3.Ex2.m1.3.3.3.10.cmml">e</mi><mo id="S3.Ex2.m1.3.3.3.4e" xref="S3.Ex2.m1.3.3.3.4.cmml">â¢</mo><mi id="S3.Ex2.m1.3.3.3.11" xref="S3.Ex2.m1.3.3.3.11.cmml">r</mi><mo id="S3.Ex2.m1.3.3.3.4f" xref="S3.Ex2.m1.3.3.3.4.cmml">â¢</mo><mrow id="S3.Ex2.m1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex2.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.1.2.cmml">I</mi><mo id="S3.Ex2.m1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.1.3.cmml">n</mi><mo id="S3.Ex2.m1.1.1.1.1.1.1.1a" xref="S3.Ex2.m1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.4" xref="S3.Ex2.m1.1.1.1.1.1.1.4.cmml">p</mi><mo id="S3.Ex2.m1.1.1.1.1.1.1.1b" xref="S3.Ex2.m1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.5" xref="S3.Ex2.m1.1.1.1.1.1.1.5.cmml">u</mi><mo id="S3.Ex2.m1.1.1.1.1.1.1.1c" xref="S3.Ex2.m1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.6" xref="S3.Ex2.m1.1.1.1.1.1.1.6.cmml">t</mi></mrow><mo id="S3.Ex2.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex2.m1.3.3.3.4g" xref="S3.Ex2.m1.3.3.3.4.cmml">â¢</mo><mrow id="S3.Ex2.m1.2.2.2.2.1" xref="S3.Ex2.m1.2.2.2.2.2.cmml"><mo id="S3.Ex2.m1.2.2.2.2.1.2" stretchy="false" xref="S3.Ex2.m1.2.2.2.2.2.1.cmml">[</mo><mrow id="S3.Ex2.m1.2.2.2.2.1.1" xref="S3.Ex2.m1.2.2.2.2.1.1.cmml"><mo id="S3.Ex2.m1.2.2.2.2.1.1a" xref="S3.Ex2.m1.2.2.2.2.1.1.cmml">âˆ’</mo><mn id="S3.Ex2.m1.2.2.2.2.1.1.2" xref="S3.Ex2.m1.2.2.2.2.1.1.2.cmml">1</mn></mrow><mo id="S3.Ex2.m1.2.2.2.2.1.3" stretchy="false" xref="S3.Ex2.m1.2.2.2.2.2.1.cmml">]</mo></mrow><mo id="S3.Ex2.m1.3.3.3.4h" xref="S3.Ex2.m1.3.3.3.4.cmml">â¢</mo><mrow id="S3.Ex2.m1.3.3.3.3.1" xref="S3.Ex2.m1.3.3.3.3.2.cmml"><mo id="S3.Ex2.m1.3.3.3.3.1.2" stretchy="false" xref="S3.Ex2.m1.3.3.3.3.2.1.cmml">[</mo><mrow id="S3.Ex2.m1.3.3.3.3.1.1" xref="S3.Ex2.m1.3.3.3.3.1.1.cmml"><mi id="S3.Ex2.m1.3.3.3.3.1.1.2" xref="S3.Ex2.m1.3.3.3.3.1.1.2.cmml">E</mi><mo id="S3.Ex2.m1.3.3.3.3.1.1.1" xref="S3.Ex2.m1.3.3.3.3.1.1.1.cmml">â¢</mo><mi id="S3.Ex2.m1.3.3.3.3.1.1.3" xref="S3.Ex2.m1.3.3.3.3.1.1.3.cmml">O</mi><mo id="S3.Ex2.m1.3.3.3.3.1.1.1a" xref="S3.Ex2.m1.3.3.3.3.1.1.1.cmml">â¢</mo><mi id="S3.Ex2.m1.3.3.3.3.1.1.4" xref="S3.Ex2.m1.3.3.3.3.1.1.4.cmml">S</mi></mrow><mo id="S3.Ex2.m1.3.3.3.3.1.3" stretchy="false" xref="S3.Ex2.m1.3.3.3.3.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.3b"><apply id="S3.Ex2.m1.3.3.cmml" xref="S3.Ex2.m1.3.3"><eq id="S3.Ex2.m1.3.3.4.cmml" xref="S3.Ex2.m1.3.3.4"></eq><apply id="S3.Ex2.m1.3.3.5.cmml" xref="S3.Ex2.m1.3.3.5"><times id="S3.Ex2.m1.3.3.5.1.cmml" xref="S3.Ex2.m1.3.3.5.1"></times><ci id="S3.Ex2.m1.3.3.5.2.cmml" xref="S3.Ex2.m1.3.3.5.2">ğ¸</ci><ci id="S3.Ex2.m1.3.3.5.3.cmml" xref="S3.Ex2.m1.3.3.5.3">ğ‘š</ci><apply id="S3.Ex2.m1.3.3.5.4.cmml" xref="S3.Ex2.m1.3.3.5.4"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.5.4.1.cmml" xref="S3.Ex2.m1.3.3.5.4">subscript</csymbol><ci id="S3.Ex2.m1.3.3.5.4.2.cmml" xref="S3.Ex2.m1.3.3.5.4.2">ğ‘</ci><ci id="S3.Ex2.m1.3.3.5.4.3.cmml" xref="S3.Ex2.m1.3.3.5.4.3">ğ‘</ci></apply></apply><apply id="S3.Ex2.m1.3.3.3.cmml" xref="S3.Ex2.m1.3.3.3"><times id="S3.Ex2.m1.3.3.3.4.cmml" xref="S3.Ex2.m1.3.3.3.4"></times><ci id="S3.Ex2.m1.3.3.3.5.cmml" xref="S3.Ex2.m1.3.3.3.5">ğ·</ci><ci id="S3.Ex2.m1.3.3.3.6.cmml" xref="S3.Ex2.m1.3.3.3.6">ğ‘’</ci><ci id="S3.Ex2.m1.3.3.3.7.cmml" xref="S3.Ex2.m1.3.3.3.7">ğ‘</ci><ci id="S3.Ex2.m1.3.3.3.8.cmml" xref="S3.Ex2.m1.3.3.3.8">ğ‘œ</ci><ci id="S3.Ex2.m1.3.3.3.9.cmml" xref="S3.Ex2.m1.3.3.3.9">ğ‘‘</ci><ci id="S3.Ex2.m1.3.3.3.10.cmml" xref="S3.Ex2.m1.3.3.3.10">ğ‘’</ci><ci id="S3.Ex2.m1.3.3.3.11.cmml" xref="S3.Ex2.m1.3.3.3.11">ğ‘Ÿ</ci><apply id="S3.Ex2.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1"><times id="S3.Ex2.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1"></times><ci id="S3.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.2">ğ¼</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.3">ğ‘›</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.4.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.4">ğ‘</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.5.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.5">ğ‘¢</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.6.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.6">ğ‘¡</ci></apply><apply id="S3.Ex2.m1.2.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.Ex2.m1.2.2.2.2.2.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.Ex2.m1.2.2.2.2.1.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1"><minus id="S3.Ex2.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex2.m1.2.2.2.2.1.1"></minus><cn id="S3.Ex2.m1.2.2.2.2.1.1.2.cmml" type="integer" xref="S3.Ex2.m1.2.2.2.2.1.1.2">1</cn></apply></apply><apply id="S3.Ex2.m1.3.3.3.3.2.cmml" xref="S3.Ex2.m1.3.3.3.3.1"><csymbol cd="latexml" id="S3.Ex2.m1.3.3.3.3.2.1.cmml" xref="S3.Ex2.m1.3.3.3.3.1.2">delimited-[]</csymbol><apply id="S3.Ex2.m1.3.3.3.3.1.1.cmml" xref="S3.Ex2.m1.3.3.3.3.1.1"><times id="S3.Ex2.m1.3.3.3.3.1.1.1.cmml" xref="S3.Ex2.m1.3.3.3.3.1.1.1"></times><ci id="S3.Ex2.m1.3.3.3.3.1.1.2.cmml" xref="S3.Ex2.m1.3.3.3.3.1.1.2">ğ¸</ci><ci id="S3.Ex2.m1.3.3.3.3.1.1.3.cmml" xref="S3.Ex2.m1.3.3.3.3.1.1.3">ğ‘‚</ci><ci id="S3.Ex2.m1.3.3.3.3.1.1.4.cmml" xref="S3.Ex2.m1.3.3.3.3.1.1.4">ğ‘†</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.3c">\displaystyle Emb_{p}=Decoder(Input)[-1][EOS]</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.3d">italic_E italic_m italic_b start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = italic_D italic_e italic_c italic_o italic_d italic_e italic_r ( italic_I italic_n italic_p italic_u italic_t ) [ - 1 ] [ italic_E italic_O italic_S ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle V_{reward}=Linear(Emb_{p})" class="ltx_Math" display="block" id="S3.Ex3.m1.1"><semantics id="S3.Ex3.m1.1a"><mrow id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><msub id="S3.Ex3.m1.1.1.3" xref="S3.Ex3.m1.1.1.3.cmml"><mi id="S3.Ex3.m1.1.1.3.2" xref="S3.Ex3.m1.1.1.3.2.cmml">V</mi><mrow id="S3.Ex3.m1.1.1.3.3" xref="S3.Ex3.m1.1.1.3.3.cmml"><mi id="S3.Ex3.m1.1.1.3.3.2" xref="S3.Ex3.m1.1.1.3.3.2.cmml">r</mi><mo id="S3.Ex3.m1.1.1.3.3.1" xref="S3.Ex3.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.3.3.3" xref="S3.Ex3.m1.1.1.3.3.3.cmml">e</mi><mo id="S3.Ex3.m1.1.1.3.3.1a" xref="S3.Ex3.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.3.3.4" xref="S3.Ex3.m1.1.1.3.3.4.cmml">w</mi><mo id="S3.Ex3.m1.1.1.3.3.1b" xref="S3.Ex3.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.3.3.5" xref="S3.Ex3.m1.1.1.3.3.5.cmml">a</mi><mo id="S3.Ex3.m1.1.1.3.3.1c" xref="S3.Ex3.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.3.3.6" xref="S3.Ex3.m1.1.1.3.3.6.cmml">r</mi><mo id="S3.Ex3.m1.1.1.3.3.1d" xref="S3.Ex3.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.3.3.7" xref="S3.Ex3.m1.1.1.3.3.7.cmml">d</mi></mrow></msub><mo id="S3.Ex3.m1.1.1.2" xref="S3.Ex3.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.3.cmml">L</mi><mo id="S3.Ex3.m1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.2.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.4.cmml">i</mi><mo id="S3.Ex3.m1.1.1.1.2a" xref="S3.Ex3.m1.1.1.1.2.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.1.5" xref="S3.Ex3.m1.1.1.1.5.cmml">n</mi><mo id="S3.Ex3.m1.1.1.1.2b" xref="S3.Ex3.m1.1.1.1.2.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.1.6" xref="S3.Ex3.m1.1.1.1.6.cmml">e</mi><mo id="S3.Ex3.m1.1.1.1.2c" xref="S3.Ex3.m1.1.1.1.2.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.1.7" xref="S3.Ex3.m1.1.1.1.7.cmml">a</mi><mo id="S3.Ex3.m1.1.1.1.2d" xref="S3.Ex3.m1.1.1.1.2.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.1.8" xref="S3.Ex3.m1.1.1.1.8.cmml">r</mi><mo id="S3.Ex3.m1.1.1.1.2e" xref="S3.Ex3.m1.1.1.1.2.cmml">â¢</mo><mrow id="S3.Ex3.m1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex3.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.cmml">E</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.Ex3.m1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.3.cmml">m</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.1a" xref="S3.Ex3.m1.1.1.1.1.1.1.1.cmml">â¢</mo><msub id="S3.Ex3.m1.1.1.1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.4.2" xref="S3.Ex3.m1.1.1.1.1.1.1.4.2.cmml">b</mi><mi id="S3.Ex3.m1.1.1.1.1.1.1.4.3" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3.cmml">p</mi></msub></mrow><mo id="S3.Ex3.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><eq id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.2"></eq><apply id="S3.Ex3.m1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.3.1.cmml" xref="S3.Ex3.m1.1.1.3">subscript</csymbol><ci id="S3.Ex3.m1.1.1.3.2.cmml" xref="S3.Ex3.m1.1.1.3.2">ğ‘‰</ci><apply id="S3.Ex3.m1.1.1.3.3.cmml" xref="S3.Ex3.m1.1.1.3.3"><times id="S3.Ex3.m1.1.1.3.3.1.cmml" xref="S3.Ex3.m1.1.1.3.3.1"></times><ci id="S3.Ex3.m1.1.1.3.3.2.cmml" xref="S3.Ex3.m1.1.1.3.3.2">ğ‘Ÿ</ci><ci id="S3.Ex3.m1.1.1.3.3.3.cmml" xref="S3.Ex3.m1.1.1.3.3.3">ğ‘’</ci><ci id="S3.Ex3.m1.1.1.3.3.4.cmml" xref="S3.Ex3.m1.1.1.3.3.4">ğ‘¤</ci><ci id="S3.Ex3.m1.1.1.3.3.5.cmml" xref="S3.Ex3.m1.1.1.3.3.5">ğ‘</ci><ci id="S3.Ex3.m1.1.1.3.3.6.cmml" xref="S3.Ex3.m1.1.1.3.3.6">ğ‘Ÿ</ci><ci id="S3.Ex3.m1.1.1.3.3.7.cmml" xref="S3.Ex3.m1.1.1.3.3.7">ğ‘‘</ci></apply></apply><apply id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><times id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.2"></times><ci id="S3.Ex3.m1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.3">ğ¿</ci><ci id="S3.Ex3.m1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.4">ğ‘–</ci><ci id="S3.Ex3.m1.1.1.1.5.cmml" xref="S3.Ex3.m1.1.1.1.5">ğ‘›</ci><ci id="S3.Ex3.m1.1.1.1.6.cmml" xref="S3.Ex3.m1.1.1.1.6">ğ‘’</ci><ci id="S3.Ex3.m1.1.1.1.7.cmml" xref="S3.Ex3.m1.1.1.1.7">ğ‘</ci><ci id="S3.Ex3.m1.1.1.1.8.cmml" xref="S3.Ex3.m1.1.1.1.8">ğ‘Ÿ</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1"><times id="S3.Ex3.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1"></times><ci id="S3.Ex3.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2">ğ¸</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3">ğ‘š</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4.2">ğ‘</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3">ğ‘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\displaystyle V_{reward}=Linear(Emb_{p})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.1d">italic_V start_POSTSUBSCRIPT italic_r italic_e italic_w italic_a italic_r italic_d end_POSTSUBSCRIPT = italic_L italic_i italic_n italic_e italic_a italic_r ( italic_E italic_m italic_b start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle Coeff=\mathrm{softmax}(MLP(Emb_{q}))" class="ltx_Math" display="block" id="S3.Ex4.m1.1"><semantics id="S3.Ex4.m1.1a"><mrow id="S3.Ex4.m1.1.1" xref="S3.Ex4.m1.1.1.cmml"><mrow id="S3.Ex4.m1.1.1.3" xref="S3.Ex4.m1.1.1.3.cmml"><mi id="S3.Ex4.m1.1.1.3.2" xref="S3.Ex4.m1.1.1.3.2.cmml">C</mi><mo id="S3.Ex4.m1.1.1.3.1" xref="S3.Ex4.m1.1.1.3.1.cmml">â¢</mo><mi id="S3.Ex4.m1.1.1.3.3" xref="S3.Ex4.m1.1.1.3.3.cmml">o</mi><mo id="S3.Ex4.m1.1.1.3.1a" xref="S3.Ex4.m1.1.1.3.1.cmml">â¢</mo><mi id="S3.Ex4.m1.1.1.3.4" xref="S3.Ex4.m1.1.1.3.4.cmml">e</mi><mo id="S3.Ex4.m1.1.1.3.1b" xref="S3.Ex4.m1.1.1.3.1.cmml">â¢</mo><mi id="S3.Ex4.m1.1.1.3.5" xref="S3.Ex4.m1.1.1.3.5.cmml">f</mi><mo id="S3.Ex4.m1.1.1.3.1c" xref="S3.Ex4.m1.1.1.3.1.cmml">â¢</mo><mi id="S3.Ex4.m1.1.1.3.6" xref="S3.Ex4.m1.1.1.3.6.cmml">f</mi></mrow><mo id="S3.Ex4.m1.1.1.2" xref="S3.Ex4.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex4.m1.1.1.1" xref="S3.Ex4.m1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.3.cmml">softmax</mi><mo id="S3.Ex4.m1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.2.cmml">â¢</mo><mrow id="S3.Ex4.m1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.3.cmml">M</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S3.Ex4.m1.1.1.1.1.1.1.4" xref="S3.Ex4.m1.1.1.1.1.1.1.4.cmml">L</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.2a" xref="S3.Ex4.m1.1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S3.Ex4.m1.1.1.1.1.1.1.5" xref="S3.Ex4.m1.1.1.1.1.1.1.5.cmml">P</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.2b" xref="S3.Ex4.m1.1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml">E</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml">m</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1a" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml">â¢</mo><msub id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2.cmml">b</mi><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.cmml">q</mi></msub></mrow><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex4.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.1b"><apply id="S3.Ex4.m1.1.1.cmml" xref="S3.Ex4.m1.1.1"><eq id="S3.Ex4.m1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.2"></eq><apply id="S3.Ex4.m1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.3"><times id="S3.Ex4.m1.1.1.3.1.cmml" xref="S3.Ex4.m1.1.1.3.1"></times><ci id="S3.Ex4.m1.1.1.3.2.cmml" xref="S3.Ex4.m1.1.1.3.2">ğ¶</ci><ci id="S3.Ex4.m1.1.1.3.3.cmml" xref="S3.Ex4.m1.1.1.3.3">ğ‘œ</ci><ci id="S3.Ex4.m1.1.1.3.4.cmml" xref="S3.Ex4.m1.1.1.3.4">ğ‘’</ci><ci id="S3.Ex4.m1.1.1.3.5.cmml" xref="S3.Ex4.m1.1.1.3.5">ğ‘“</ci><ci id="S3.Ex4.m1.1.1.3.6.cmml" xref="S3.Ex4.m1.1.1.3.6">ğ‘“</ci></apply><apply id="S3.Ex4.m1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1"><times id="S3.Ex4.m1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.2"></times><ci id="S3.Ex4.m1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.3">softmax</ci><apply id="S3.Ex4.m1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1"><times id="S3.Ex4.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2"></times><ci id="S3.Ex4.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.3">ğ‘€</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.4.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.4">ğ¿</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.5.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.5">ğ‘ƒ</ci><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1"><times id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.2">ğ¸</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.3">ğ‘š</ci><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2">ğ‘</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3">ğ‘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.1c">\displaystyle Coeff=\mathrm{softmax}(MLP(Emb_{q}))</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.1d">italic_C italic_o italic_e italic_f italic_f = roman_softmax ( italic_M italic_L italic_P ( italic_E italic_m italic_b start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle r_{\theta}(q,d)=Coeff^{T}*V_{reward}" class="ltx_Math" display="block" id="S3.Ex5.m1.2"><semantics id="S3.Ex5.m1.2a"><mrow id="S3.Ex5.m1.2.3" xref="S3.Ex5.m1.2.3.cmml"><mrow id="S3.Ex5.m1.2.3.2" xref="S3.Ex5.m1.2.3.2.cmml"><msub id="S3.Ex5.m1.2.3.2.2" xref="S3.Ex5.m1.2.3.2.2.cmml"><mi id="S3.Ex5.m1.2.3.2.2.2" xref="S3.Ex5.m1.2.3.2.2.2.cmml">r</mi><mi id="S3.Ex5.m1.2.3.2.2.3" xref="S3.Ex5.m1.2.3.2.2.3.cmml">Î¸</mi></msub><mo id="S3.Ex5.m1.2.3.2.1" xref="S3.Ex5.m1.2.3.2.1.cmml">â¢</mo><mrow id="S3.Ex5.m1.2.3.2.3.2" xref="S3.Ex5.m1.2.3.2.3.1.cmml"><mo id="S3.Ex5.m1.2.3.2.3.2.1" stretchy="false" xref="S3.Ex5.m1.2.3.2.3.1.cmml">(</mo><mi id="S3.Ex5.m1.1.1" xref="S3.Ex5.m1.1.1.cmml">q</mi><mo id="S3.Ex5.m1.2.3.2.3.2.2" xref="S3.Ex5.m1.2.3.2.3.1.cmml">,</mo><mi id="S3.Ex5.m1.2.2" xref="S3.Ex5.m1.2.2.cmml">d</mi><mo id="S3.Ex5.m1.2.3.2.3.2.3" stretchy="false" xref="S3.Ex5.m1.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex5.m1.2.3.1" xref="S3.Ex5.m1.2.3.1.cmml">=</mo><mrow id="S3.Ex5.m1.2.3.3" xref="S3.Ex5.m1.2.3.3.cmml"><mrow id="S3.Ex5.m1.2.3.3.2" xref="S3.Ex5.m1.2.3.3.2.cmml"><mi id="S3.Ex5.m1.2.3.3.2.2" xref="S3.Ex5.m1.2.3.3.2.2.cmml">C</mi><mo id="S3.Ex5.m1.2.3.3.2.1" xref="S3.Ex5.m1.2.3.3.2.1.cmml">â¢</mo><mi id="S3.Ex5.m1.2.3.3.2.3" xref="S3.Ex5.m1.2.3.3.2.3.cmml">o</mi><mo id="S3.Ex5.m1.2.3.3.2.1a" xref="S3.Ex5.m1.2.3.3.2.1.cmml">â¢</mo><mi id="S3.Ex5.m1.2.3.3.2.4" xref="S3.Ex5.m1.2.3.3.2.4.cmml">e</mi><mo id="S3.Ex5.m1.2.3.3.2.1b" xref="S3.Ex5.m1.2.3.3.2.1.cmml">â¢</mo><mi id="S3.Ex5.m1.2.3.3.2.5" xref="S3.Ex5.m1.2.3.3.2.5.cmml">f</mi><mo id="S3.Ex5.m1.2.3.3.2.1c" xref="S3.Ex5.m1.2.3.3.2.1.cmml">â¢</mo><msup id="S3.Ex5.m1.2.3.3.2.6" xref="S3.Ex5.m1.2.3.3.2.6.cmml"><mi id="S3.Ex5.m1.2.3.3.2.6.2" xref="S3.Ex5.m1.2.3.3.2.6.2.cmml">f</mi><mi id="S3.Ex5.m1.2.3.3.2.6.3" xref="S3.Ex5.m1.2.3.3.2.6.3.cmml">T</mi></msup></mrow><mo id="S3.Ex5.m1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex5.m1.2.3.3.1.cmml">âˆ—</mo><msub id="S3.Ex5.m1.2.3.3.3" xref="S3.Ex5.m1.2.3.3.3.cmml"><mi id="S3.Ex5.m1.2.3.3.3.2" xref="S3.Ex5.m1.2.3.3.3.2.cmml">V</mi><mrow id="S3.Ex5.m1.2.3.3.3.3" xref="S3.Ex5.m1.2.3.3.3.3.cmml"><mi id="S3.Ex5.m1.2.3.3.3.3.2" xref="S3.Ex5.m1.2.3.3.3.3.2.cmml">r</mi><mo id="S3.Ex5.m1.2.3.3.3.3.1" xref="S3.Ex5.m1.2.3.3.3.3.1.cmml">â¢</mo><mi id="S3.Ex5.m1.2.3.3.3.3.3" xref="S3.Ex5.m1.2.3.3.3.3.3.cmml">e</mi><mo id="S3.Ex5.m1.2.3.3.3.3.1a" xref="S3.Ex5.m1.2.3.3.3.3.1.cmml">â¢</mo><mi id="S3.Ex5.m1.2.3.3.3.3.4" xref="S3.Ex5.m1.2.3.3.3.3.4.cmml">w</mi><mo id="S3.Ex5.m1.2.3.3.3.3.1b" xref="S3.Ex5.m1.2.3.3.3.3.1.cmml">â¢</mo><mi id="S3.Ex5.m1.2.3.3.3.3.5" xref="S3.Ex5.m1.2.3.3.3.3.5.cmml">a</mi><mo id="S3.Ex5.m1.2.3.3.3.3.1c" xref="S3.Ex5.m1.2.3.3.3.3.1.cmml">â¢</mo><mi id="S3.Ex5.m1.2.3.3.3.3.6" xref="S3.Ex5.m1.2.3.3.3.3.6.cmml">r</mi><mo id="S3.Ex5.m1.2.3.3.3.3.1d" xref="S3.Ex5.m1.2.3.3.3.3.1.cmml">â¢</mo><mi id="S3.Ex5.m1.2.3.3.3.3.7" xref="S3.Ex5.m1.2.3.3.3.3.7.cmml">d</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.2b"><apply id="S3.Ex5.m1.2.3.cmml" xref="S3.Ex5.m1.2.3"><eq id="S3.Ex5.m1.2.3.1.cmml" xref="S3.Ex5.m1.2.3.1"></eq><apply id="S3.Ex5.m1.2.3.2.cmml" xref="S3.Ex5.m1.2.3.2"><times id="S3.Ex5.m1.2.3.2.1.cmml" xref="S3.Ex5.m1.2.3.2.1"></times><apply id="S3.Ex5.m1.2.3.2.2.cmml" xref="S3.Ex5.m1.2.3.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.3.2.2.1.cmml" xref="S3.Ex5.m1.2.3.2.2">subscript</csymbol><ci id="S3.Ex5.m1.2.3.2.2.2.cmml" xref="S3.Ex5.m1.2.3.2.2.2">ğ‘Ÿ</ci><ci id="S3.Ex5.m1.2.3.2.2.3.cmml" xref="S3.Ex5.m1.2.3.2.2.3">ğœƒ</ci></apply><interval closure="open" id="S3.Ex5.m1.2.3.2.3.1.cmml" xref="S3.Ex5.m1.2.3.2.3.2"><ci id="S3.Ex5.m1.1.1.cmml" xref="S3.Ex5.m1.1.1">ğ‘</ci><ci id="S3.Ex5.m1.2.2.cmml" xref="S3.Ex5.m1.2.2">ğ‘‘</ci></interval></apply><apply id="S3.Ex5.m1.2.3.3.cmml" xref="S3.Ex5.m1.2.3.3"><times id="S3.Ex5.m1.2.3.3.1.cmml" xref="S3.Ex5.m1.2.3.3.1"></times><apply id="S3.Ex5.m1.2.3.3.2.cmml" xref="S3.Ex5.m1.2.3.3.2"><times id="S3.Ex5.m1.2.3.3.2.1.cmml" xref="S3.Ex5.m1.2.3.3.2.1"></times><ci id="S3.Ex5.m1.2.3.3.2.2.cmml" xref="S3.Ex5.m1.2.3.3.2.2">ğ¶</ci><ci id="S3.Ex5.m1.2.3.3.2.3.cmml" xref="S3.Ex5.m1.2.3.3.2.3">ğ‘œ</ci><ci id="S3.Ex5.m1.2.3.3.2.4.cmml" xref="S3.Ex5.m1.2.3.3.2.4">ğ‘’</ci><ci id="S3.Ex5.m1.2.3.3.2.5.cmml" xref="S3.Ex5.m1.2.3.3.2.5">ğ‘“</ci><apply id="S3.Ex5.m1.2.3.3.2.6.cmml" xref="S3.Ex5.m1.2.3.3.2.6"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.3.3.2.6.1.cmml" xref="S3.Ex5.m1.2.3.3.2.6">superscript</csymbol><ci id="S3.Ex5.m1.2.3.3.2.6.2.cmml" xref="S3.Ex5.m1.2.3.3.2.6.2">ğ‘“</ci><ci id="S3.Ex5.m1.2.3.3.2.6.3.cmml" xref="S3.Ex5.m1.2.3.3.2.6.3">ğ‘‡</ci></apply></apply><apply id="S3.Ex5.m1.2.3.3.3.cmml" xref="S3.Ex5.m1.2.3.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.3.3.3.1.cmml" xref="S3.Ex5.m1.2.3.3.3">subscript</csymbol><ci id="S3.Ex5.m1.2.3.3.3.2.cmml" xref="S3.Ex5.m1.2.3.3.3.2">ğ‘‰</ci><apply id="S3.Ex5.m1.2.3.3.3.3.cmml" xref="S3.Ex5.m1.2.3.3.3.3"><times id="S3.Ex5.m1.2.3.3.3.3.1.cmml" xref="S3.Ex5.m1.2.3.3.3.3.1"></times><ci id="S3.Ex5.m1.2.3.3.3.3.2.cmml" xref="S3.Ex5.m1.2.3.3.3.3.2">ğ‘Ÿ</ci><ci id="S3.Ex5.m1.2.3.3.3.3.3.cmml" xref="S3.Ex5.m1.2.3.3.3.3.3">ğ‘’</ci><ci id="S3.Ex5.m1.2.3.3.3.3.4.cmml" xref="S3.Ex5.m1.2.3.3.3.3.4">ğ‘¤</ci><ci id="S3.Ex5.m1.2.3.3.3.3.5.cmml" xref="S3.Ex5.m1.2.3.3.3.3.5">ğ‘</ci><ci id="S3.Ex5.m1.2.3.3.3.3.6.cmml" xref="S3.Ex5.m1.2.3.3.3.3.6">ğ‘Ÿ</ci><ci id="S3.Ex5.m1.2.3.3.3.3.7.cmml" xref="S3.Ex5.m1.2.3.3.3.3.7">ğ‘‘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.2c">\displaystyle r_{\theta}(q,d)=Coeff^{T}*V_{reward}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m1.2d">italic_r start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT ( italic_q , italic_d ) = italic_C italic_o italic_e italic_f italic_f start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT âˆ— italic_V start_POSTSUBSCRIPT italic_r italic_e italic_w italic_a italic_r italic_d end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p5.1">We use mean square error as our loss function to train the reward model:
</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="loss(\theta)=E_{(\langle q,\,d\rangle,w)\sim D}[(r_{\theta}(q,d)-w)^{2}]" class="ltx_Math" display="block" id="S3.E4.m1.8"><semantics id="S3.E4.m1.8a"><mrow id="S3.E4.m1.8.8" xref="S3.E4.m1.8.8.cmml"><mrow id="S3.E4.m1.8.8.3" xref="S3.E4.m1.8.8.3.cmml"><mi id="S3.E4.m1.8.8.3.2" xref="S3.E4.m1.8.8.3.2.cmml">l</mi><mo id="S3.E4.m1.8.8.3.1" xref="S3.E4.m1.8.8.3.1.cmml">â¢</mo><mi id="S3.E4.m1.8.8.3.3" xref="S3.E4.m1.8.8.3.3.cmml">o</mi><mo id="S3.E4.m1.8.8.3.1a" xref="S3.E4.m1.8.8.3.1.cmml">â¢</mo><mi id="S3.E4.m1.8.8.3.4" xref="S3.E4.m1.8.8.3.4.cmml">s</mi><mo id="S3.E4.m1.8.8.3.1b" xref="S3.E4.m1.8.8.3.1.cmml">â¢</mo><mi id="S3.E4.m1.8.8.3.5" xref="S3.E4.m1.8.8.3.5.cmml">s</mi><mo id="S3.E4.m1.8.8.3.1c" xref="S3.E4.m1.8.8.3.1.cmml">â¢</mo><mrow id="S3.E4.m1.8.8.3.6.2" xref="S3.E4.m1.8.8.3.cmml"><mo id="S3.E4.m1.8.8.3.6.2.1" stretchy="false" xref="S3.E4.m1.8.8.3.cmml">(</mo><mi id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml">Î¸</mi><mo id="S3.E4.m1.8.8.3.6.2.2" stretchy="false" xref="S3.E4.m1.8.8.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.8.8.2" xref="S3.E4.m1.8.8.2.cmml">=</mo><mrow id="S3.E4.m1.8.8.1" xref="S3.E4.m1.8.8.1.cmml"><msub id="S3.E4.m1.8.8.1.3" xref="S3.E4.m1.8.8.1.3.cmml"><mi id="S3.E4.m1.8.8.1.3.2" xref="S3.E4.m1.8.8.1.3.2.cmml">E</mi><mrow id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><mrow id="S3.E4.m1.4.4.4.4.1" xref="S3.E4.m1.4.4.4.4.2.cmml"><mo id="S3.E4.m1.4.4.4.4.1.2" stretchy="false" xref="S3.E4.m1.4.4.4.4.2.cmml">(</mo><mrow id="S3.E4.m1.4.4.4.4.1.1.2" xref="S3.E4.m1.4.4.4.4.1.1.1.cmml"><mo id="S3.E4.m1.4.4.4.4.1.1.2.1" stretchy="false" xref="S3.E4.m1.4.4.4.4.1.1.1.cmml">âŸ¨</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">q</mi><mo id="S3.E4.m1.4.4.4.4.1.1.2.2" rspace="0.337em" xref="S3.E4.m1.4.4.4.4.1.1.1.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">d</mi><mo id="S3.E4.m1.4.4.4.4.1.1.2.3" stretchy="false" xref="S3.E4.m1.4.4.4.4.1.1.1.cmml">âŸ©</mo></mrow><mo id="S3.E4.m1.4.4.4.4.1.3" xref="S3.E4.m1.4.4.4.4.2.cmml">,</mo><mi id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.3.cmml">w</mi><mo id="S3.E4.m1.4.4.4.4.1.4" stretchy="false" xref="S3.E4.m1.4.4.4.4.2.cmml">)</mo></mrow><mo id="S3.E4.m1.4.4.4.5" xref="S3.E4.m1.4.4.4.5.cmml">âˆ¼</mo><mi id="S3.E4.m1.4.4.4.6" xref="S3.E4.m1.4.4.4.6.cmml">D</mi></mrow></msub><mo id="S3.E4.m1.8.8.1.2" xref="S3.E4.m1.8.8.1.2.cmml">â¢</mo><mrow id="S3.E4.m1.8.8.1.1.1" xref="S3.E4.m1.8.8.1.1.2.cmml"><mo id="S3.E4.m1.8.8.1.1.1.2" stretchy="false" xref="S3.E4.m1.8.8.1.1.2.1.cmml">[</mo><msup id="S3.E4.m1.8.8.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml">r</mi><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.3.cmml">Î¸</mi></msub><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.1.cmml">â¢</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.3.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">q</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml">d</mi><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.cmml">âˆ’</mo><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.3.cmml">w</mi></mrow><mo id="S3.E4.m1.8.8.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E4.m1.8.8.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E4.m1.8.8.1.1.1.3" stretchy="false" xref="S3.E4.m1.8.8.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.8b"><apply id="S3.E4.m1.8.8.cmml" xref="S3.E4.m1.8.8"><eq id="S3.E4.m1.8.8.2.cmml" xref="S3.E4.m1.8.8.2"></eq><apply id="S3.E4.m1.8.8.3.cmml" xref="S3.E4.m1.8.8.3"><times id="S3.E4.m1.8.8.3.1.cmml" xref="S3.E4.m1.8.8.3.1"></times><ci id="S3.E4.m1.8.8.3.2.cmml" xref="S3.E4.m1.8.8.3.2">ğ‘™</ci><ci id="S3.E4.m1.8.8.3.3.cmml" xref="S3.E4.m1.8.8.3.3">ğ‘œ</ci><ci id="S3.E4.m1.8.8.3.4.cmml" xref="S3.E4.m1.8.8.3.4">ğ‘ </ci><ci id="S3.E4.m1.8.8.3.5.cmml" xref="S3.E4.m1.8.8.3.5">ğ‘ </ci><ci id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5">ğœƒ</ci></apply><apply id="S3.E4.m1.8.8.1.cmml" xref="S3.E4.m1.8.8.1"><times id="S3.E4.m1.8.8.1.2.cmml" xref="S3.E4.m1.8.8.1.2"></times><apply id="S3.E4.m1.8.8.1.3.cmml" xref="S3.E4.m1.8.8.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.3.1.cmml" xref="S3.E4.m1.8.8.1.3">subscript</csymbol><ci id="S3.E4.m1.8.8.1.3.2.cmml" xref="S3.E4.m1.8.8.1.3.2">ğ¸</ci><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><csymbol cd="latexml" id="S3.E4.m1.4.4.4.5.cmml" xref="S3.E4.m1.4.4.4.5">similar-to</csymbol><interval closure="open" id="S3.E4.m1.4.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4.4.1"><list id="S3.E4.m1.4.4.4.4.1.1.1.cmml" xref="S3.E4.m1.4.4.4.4.1.1.2"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">ğ‘</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">ğ‘‘</ci></list><ci id="S3.E4.m1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3">ğ‘¤</ci></interval><ci id="S3.E4.m1.4.4.4.6.cmml" xref="S3.E4.m1.4.4.4.6">ğ·</ci></apply></apply><apply id="S3.E4.m1.8.8.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.8.8.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.8.8.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1"><minus id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1"></minus><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2"><times id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.2">ğ‘Ÿ</ci><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.2.3">ğœƒ</ci></apply><interval closure="open" id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.3.2"><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">ğ‘</ci><ci id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7">ğ‘‘</ci></interval></apply><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.3">ğ‘¤</ci></apply><cn id="S3.E4.m1.8.8.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.8.8.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.8c">loss(\theta)=E_{(\langle q,\,d\rangle,w)\sim D}[(r_{\theta}(q,d)-w)^{2}]</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.8d">italic_l italic_o italic_s italic_s ( italic_Î¸ ) = italic_E start_POSTSUBSCRIPT ( âŸ¨ italic_q , italic_d âŸ© , italic_w ) âˆ¼ italic_D end_POSTSUBSCRIPT [ ( italic_r start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT ( italic_q , italic_d ) - italic_w ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p7">
<p class="ltx_p" id="S3.SS2.SSS1.p7.6">where <math alttext="r_{\theta}(q,d)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p7.1.m1.2"><semantics id="S3.SS2.SSS1.p7.1.m1.2a"><mrow id="S3.SS2.SSS1.p7.1.m1.2.3" xref="S3.SS2.SSS1.p7.1.m1.2.3.cmml"><msub id="S3.SS2.SSS1.p7.1.m1.2.3.2" xref="S3.SS2.SSS1.p7.1.m1.2.3.2.cmml"><mi id="S3.SS2.SSS1.p7.1.m1.2.3.2.2" xref="S3.SS2.SSS1.p7.1.m1.2.3.2.2.cmml">r</mi><mi id="S3.SS2.SSS1.p7.1.m1.2.3.2.3" xref="S3.SS2.SSS1.p7.1.m1.2.3.2.3.cmml">Î¸</mi></msub><mo id="S3.SS2.SSS1.p7.1.m1.2.3.1" xref="S3.SS2.SSS1.p7.1.m1.2.3.1.cmml">â¢</mo><mrow id="S3.SS2.SSS1.p7.1.m1.2.3.3.2" xref="S3.SS2.SSS1.p7.1.m1.2.3.3.1.cmml"><mo id="S3.SS2.SSS1.p7.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p7.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS2.SSS1.p7.1.m1.1.1" xref="S3.SS2.SSS1.p7.1.m1.1.1.cmml">q</mi><mo id="S3.SS2.SSS1.p7.1.m1.2.3.3.2.2" xref="S3.SS2.SSS1.p7.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS2.SSS1.p7.1.m1.2.2" xref="S3.SS2.SSS1.p7.1.m1.2.2.cmml">d</mi><mo id="S3.SS2.SSS1.p7.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS2.SSS1.p7.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p7.1.m1.2b"><apply id="S3.SS2.SSS1.p7.1.m1.2.3.cmml" xref="S3.SS2.SSS1.p7.1.m1.2.3"><times id="S3.SS2.SSS1.p7.1.m1.2.3.1.cmml" xref="S3.SS2.SSS1.p7.1.m1.2.3.1"></times><apply id="S3.SS2.SSS1.p7.1.m1.2.3.2.cmml" xref="S3.SS2.SSS1.p7.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p7.1.m1.2.3.2.1.cmml" xref="S3.SS2.SSS1.p7.1.m1.2.3.2">subscript</csymbol><ci id="S3.SS2.SSS1.p7.1.m1.2.3.2.2.cmml" xref="S3.SS2.SSS1.p7.1.m1.2.3.2.2">ğ‘Ÿ</ci><ci id="S3.SS2.SSS1.p7.1.m1.2.3.2.3.cmml" xref="S3.SS2.SSS1.p7.1.m1.2.3.2.3">ğœƒ</ci></apply><interval closure="open" id="S3.SS2.SSS1.p7.1.m1.2.3.3.1.cmml" xref="S3.SS2.SSS1.p7.1.m1.2.3.3.2"><ci id="S3.SS2.SSS1.p7.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p7.1.m1.1.1">ğ‘</ci><ci id="S3.SS2.SSS1.p7.1.m1.2.2.cmml" xref="S3.SS2.SSS1.p7.1.m1.2.2">ğ‘‘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p7.1.m1.2c">r_{\theta}(q,d)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p7.1.m1.2d">italic_r start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT ( italic_q , italic_d )</annotation></semantics></math> is the scalar reward for a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p7.2.m2.1"><semantics id="S3.SS2.SSS1.p7.2.m2.1a"><mi id="S3.SS2.SSS1.p7.2.m2.1.1" xref="S3.SS2.SSS1.p7.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p7.2.m2.1b"><ci id="S3.SS2.SSS1.p7.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p7.2.m2.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p7.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p7.2.m2.1d">italic_q</annotation></semantics></math> and a document <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p7.3.m3.1"><semantics id="S3.SS2.SSS1.p7.3.m3.1a"><mi id="S3.SS2.SSS1.p7.3.m3.1.1" xref="S3.SS2.SSS1.p7.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p7.3.m3.1b"><ci id="S3.SS2.SSS1.p7.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p7.3.m3.1.1">ğ‘‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p7.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p7.3.m3.1d">italic_d</annotation></semantics></math> from the reward model parameterized by <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p7.4.m4.1"><semantics id="S3.SS2.SSS1.p7.4.m4.1a"><mi id="S3.SS2.SSS1.p7.4.m4.1.1" xref="S3.SS2.SSS1.p7.4.m4.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p7.4.m4.1b"><ci id="S3.SS2.SSS1.p7.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p7.4.m4.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p7.4.m4.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p7.4.m4.1d">italic_Î¸</annotation></semantics></math>, <math alttext="w" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p7.5.m5.1"><semantics id="S3.SS2.SSS1.p7.5.m5.1a"><mi id="S3.SS2.SSS1.p7.5.m5.1.1" xref="S3.SS2.SSS1.p7.5.m5.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p7.5.m5.1b"><ci id="S3.SS2.SSS1.p7.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p7.5.m5.1.1">ğ‘¤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p7.5.m5.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p7.5.m5.1d">italic_w</annotation></semantics></math> is the expected reward, and <math alttext="D" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p7.6.m6.1"><semantics id="S3.SS2.SSS1.p7.6.m6.1a"><mi id="S3.SS2.SSS1.p7.6.m6.1.1" xref="S3.SS2.SSS1.p7.6.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p7.6.m6.1b"><ci id="S3.SS2.SSS1.p7.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p7.6.m6.1.1">ğ·</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p7.6.m6.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p7.6.m6.1d">italic_D</annotation></semantics></math> is the feedback dataset.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Collecting LLMsâ€™ feedback</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">Relevance assessments by human annotators are time-consuming, labor-intensive, and costly. In our works, we use LLMs to judge the relevancy between a query and a passage or a document. There are two main problems in this phase:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_italic" id="S3.I1.i1.p1.1.1">Sampling</span>: For a query, how to sample documents from a corpus to evaluate the relevance?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S3.I1.i2.p1.1.1">Prompting</span>: How can we teach the LLMs by prompts to align with human assessments?</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.1"><cite class="ltx_cite ltx_citemacro_citet">deÂ Souza P.Â Moreira etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib12" title="">2024</a>)</cite> studies hard-negative mining methods in fine-tuning retrieval embeddings. Following their works, we first use an existing retrieval encoder from the MTEB leaderboard <cite class="ltx_cite ltx_citemacro_citep">(Muennighoff etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib63" title="">2023</a>)</cite> to retrieve the top-<math alttext="25" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.1.m1.1"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><mn id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><cn id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS2.SSS2.p2.1.m1.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">25</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.1.m1.1d">25</annotation></semantics></math> related documents for each query, we then pick
the top document and sample another 4 documents after ignoring documents have relevance scores higher than a threshold calculated from the highest score.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p3">
<p class="ltx_p" id="S3.SS2.SSS2.p3.2">Writing a good prompt to align LLMsâ€™ output with human preferences is another crucial issue. Following the analysis in <cite class="ltx_cite ltx_citemacro_citep">(Zheng etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib108" title="">2024</a>; Thomas etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib86" title="">2024</a>)</cite>, we instruct LLMs by decomposing the problem into step-by-step tasks. The details of prompts and our analysis of different prompts is in Appendix B. After collecting LLMsâ€™ feedback for selected <math alttext="\langle query,document\rangle" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.1.m1.2"><semantics id="S3.SS2.SSS2.p3.1.m1.2a"><mrow id="S3.SS2.SSS2.p3.1.m1.2.2.2" xref="S3.SS2.SSS2.p3.1.m1.2.2.3.cmml"><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.3" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.2.2.3.cmml">âŸ¨</mo><mrow id="S3.SS2.SSS2.p3.1.m1.1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.2.cmml">q</mi><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.3.cmml">u</mi><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1a" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.4" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.4.cmml">e</mi><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1b" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.5" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.5.cmml">r</mi><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1c" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.6" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.6.cmml">y</mi></mrow><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.4" xref="S3.SS2.SSS2.p3.1.m1.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS2.p3.1.m1.2.2.2.2" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.2" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.2.cmml">d</mi><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.3" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.3.cmml">o</mi><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1a" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.4" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.4.cmml">c</mi><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1b" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.5" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.5.cmml">u</mi><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1c" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.6" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.6.cmml">m</mi><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1d" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.7" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.7.cmml">e</mi><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1e" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.8" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.8.cmml">n</mi><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1f" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.9" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.9.cmml">t</mi></mrow><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.5" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.2.2.3.cmml">âŸ©</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.1.m1.2b"><list id="S3.SS2.SSS2.p3.1.m1.2.2.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2"><apply id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1"><times id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1"></times><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.2">ğ‘</ci><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.3">ğ‘¢</ci><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.4.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.4">ğ‘’</ci><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.5.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.5">ğ‘Ÿ</ci><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.6.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.6">ğ‘¦</ci></apply><apply id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2"><times id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.1"></times><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.2">ğ‘‘</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.3">ğ‘œ</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.4.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.4">ğ‘</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.5.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.5">ğ‘¢</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.6.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.6">ğ‘š</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.7.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.7">ğ‘’</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.8.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.8">ğ‘›</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.9.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.9">ğ‘¡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.1.m1.2c">\langle query,document\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.1.m1.2d">âŸ¨ italic_q italic_u italic_e italic_r italic_y , italic_d italic_o italic_c italic_u italic_m italic_e italic_n italic_t âŸ©</annotation></semantics></math> pairs, we train the reward model and use the reward model to rate the top-<math alttext="25" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.2.m2.1"><semantics id="S3.SS2.SSS2.p3.2.m2.1a"><mn id="S3.SS2.SSS2.p3.2.m2.1.1" xref="S3.SS2.SSS2.p3.2.m2.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.2.m2.1b"><cn id="S3.SS2.SSS2.p3.2.m2.1.1.cmml" type="integer" xref="S3.SS2.SSS2.p3.2.m2.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.2.m2.1c">25</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.2.m2.1d">25</annotation></semantics></math> related documents for a query.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Fine-tuning Retrieval Model</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.3">Given the reward model, we first synthesize <math alttext="\langle query,document,reward\rangle" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.3"><semantics id="S3.SS3.p1.1.m1.3a"><mrow id="S3.SS3.p1.1.m1.3.3.3" xref="S3.SS3.p1.1.m1.3.3.4.cmml"><mo id="S3.SS3.p1.1.m1.3.3.3.4" stretchy="false" xref="S3.SS3.p1.1.m1.3.3.4.cmml">âŸ¨</mo><mrow id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.1.1.2.cmml">q</mi><mo id="S3.SS3.p1.1.m1.1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.1.1.3.cmml">u</mi><mo id="S3.SS3.p1.1.m1.1.1.1.1.1a" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1.4" xref="S3.SS3.p1.1.m1.1.1.1.1.4.cmml">e</mi><mo id="S3.SS3.p1.1.m1.1.1.1.1.1b" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1.5" xref="S3.SS3.p1.1.m1.1.1.1.1.5.cmml">r</mi><mo id="S3.SS3.p1.1.m1.1.1.1.1.1c" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1.6" xref="S3.SS3.p1.1.m1.1.1.1.1.6.cmml">y</mi></mrow><mo id="S3.SS3.p1.1.m1.3.3.3.5" xref="S3.SS3.p1.1.m1.3.3.4.cmml">,</mo><mrow id="S3.SS3.p1.1.m1.2.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.2.cmml"><mi id="S3.SS3.p1.1.m1.2.2.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.2.2.cmml">d</mi><mo id="S3.SS3.p1.1.m1.2.2.2.2.1" xref="S3.SS3.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.2.2.2.2.3" xref="S3.SS3.p1.1.m1.2.2.2.2.3.cmml">o</mi><mo id="S3.SS3.p1.1.m1.2.2.2.2.1a" xref="S3.SS3.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.2.2.2.2.4" xref="S3.SS3.p1.1.m1.2.2.2.2.4.cmml">c</mi><mo id="S3.SS3.p1.1.m1.2.2.2.2.1b" xref="S3.SS3.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.2.2.2.2.5" xref="S3.SS3.p1.1.m1.2.2.2.2.5.cmml">u</mi><mo id="S3.SS3.p1.1.m1.2.2.2.2.1c" xref="S3.SS3.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.2.2.2.2.6" xref="S3.SS3.p1.1.m1.2.2.2.2.6.cmml">m</mi><mo id="S3.SS3.p1.1.m1.2.2.2.2.1d" xref="S3.SS3.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.2.2.2.2.7" xref="S3.SS3.p1.1.m1.2.2.2.2.7.cmml">e</mi><mo id="S3.SS3.p1.1.m1.2.2.2.2.1e" xref="S3.SS3.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.2.2.2.2.8" xref="S3.SS3.p1.1.m1.2.2.2.2.8.cmml">n</mi><mo id="S3.SS3.p1.1.m1.2.2.2.2.1f" xref="S3.SS3.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.2.2.2.2.9" xref="S3.SS3.p1.1.m1.2.2.2.2.9.cmml">t</mi></mrow><mo id="S3.SS3.p1.1.m1.3.3.3.6" xref="S3.SS3.p1.1.m1.3.3.4.cmml">,</mo><mrow id="S3.SS3.p1.1.m1.3.3.3.3" xref="S3.SS3.p1.1.m1.3.3.3.3.cmml"><mi id="S3.SS3.p1.1.m1.3.3.3.3.2" xref="S3.SS3.p1.1.m1.3.3.3.3.2.cmml">r</mi><mo id="S3.SS3.p1.1.m1.3.3.3.3.1" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.3.3.3.3.3" xref="S3.SS3.p1.1.m1.3.3.3.3.3.cmml">e</mi><mo id="S3.SS3.p1.1.m1.3.3.3.3.1a" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.3.3.3.3.4" xref="S3.SS3.p1.1.m1.3.3.3.3.4.cmml">w</mi><mo id="S3.SS3.p1.1.m1.3.3.3.3.1b" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.3.3.3.3.5" xref="S3.SS3.p1.1.m1.3.3.3.3.5.cmml">a</mi><mo id="S3.SS3.p1.1.m1.3.3.3.3.1c" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.3.3.3.3.6" xref="S3.SS3.p1.1.m1.3.3.3.3.6.cmml">r</mi><mo id="S3.SS3.p1.1.m1.3.3.3.3.1d" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">â¢</mo><mi id="S3.SS3.p1.1.m1.3.3.3.3.7" xref="S3.SS3.p1.1.m1.3.3.3.3.7.cmml">d</mi></mrow><mo id="S3.SS3.p1.1.m1.3.3.3.7" stretchy="false" xref="S3.SS3.p1.1.m1.3.3.4.cmml">âŸ©</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.3b"><list id="S3.SS3.p1.1.m1.3.3.4.cmml" xref="S3.SS3.p1.1.m1.3.3.3"><apply id="S3.SS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1"><times id="S3.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1"></times><ci id="S3.SS3.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.2">ğ‘</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.3">ğ‘¢</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.4.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.4">ğ‘’</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.5.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.5">ğ‘Ÿ</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.6.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.6">ğ‘¦</ci></apply><apply id="S3.SS3.p1.1.m1.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2"><times id="S3.SS3.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.1"></times><ci id="S3.SS3.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.2">ğ‘‘</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.3">ğ‘œ</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.4.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.4">ğ‘</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.5.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.5">ğ‘¢</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.6.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.6">ğ‘š</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.7.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.7">ğ‘’</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.8.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.8">ğ‘›</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.9.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.9">ğ‘¡</ci></apply><apply id="S3.SS3.p1.1.m1.3.3.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3"><times id="S3.SS3.p1.1.m1.3.3.3.3.1.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.1"></times><ci id="S3.SS3.p1.1.m1.3.3.3.3.2.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.2">ğ‘Ÿ</ci><ci id="S3.SS3.p1.1.m1.3.3.3.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.3">ğ‘’</ci><ci id="S3.SS3.p1.1.m1.3.3.3.3.4.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.4">ğ‘¤</ci><ci id="S3.SS3.p1.1.m1.3.3.3.3.5.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.5">ğ‘</ci><ci id="S3.SS3.p1.1.m1.3.3.3.3.6.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.6">ğ‘Ÿ</ci><ci id="S3.SS3.p1.1.m1.3.3.3.3.7.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.7">ğ‘‘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.3c">\langle query,document,reward\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.3d">âŸ¨ italic_q italic_u italic_e italic_r italic_y , italic_d italic_o italic_c italic_u italic_m italic_e italic_n italic_t , italic_r italic_e italic_w italic_a italic_r italic_d âŸ©</annotation></semantics></math> data to fine-tune the retrieval model. We perform hard-negative mining by firstly using a retrieval model to retrieve top-<math alttext="50" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mn id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><cn id="S3.SS3.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">50</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">50</annotation></semantics></math> related documents for a query, followed by rating the relevance for each pair using the reward model. We use a threshold to determine which <math alttext="\langle query,document\rangle" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.2"><semantics id="S3.SS3.p1.3.m3.2a"><mrow id="S3.SS3.p1.3.m3.2.2.2" xref="S3.SS3.p1.3.m3.2.2.3.cmml"><mo id="S3.SS3.p1.3.m3.2.2.2.3" stretchy="false" xref="S3.SS3.p1.3.m3.2.2.3.cmml">âŸ¨</mo><mrow id="S3.SS3.p1.3.m3.1.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.1.1.2" xref="S3.SS3.p1.3.m3.1.1.1.1.2.cmml">q</mi><mo id="S3.SS3.p1.3.m3.1.1.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.1.1.1.1.3" xref="S3.SS3.p1.3.m3.1.1.1.1.3.cmml">u</mi><mo id="S3.SS3.p1.3.m3.1.1.1.1.1a" xref="S3.SS3.p1.3.m3.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.1.1.1.1.4" xref="S3.SS3.p1.3.m3.1.1.1.1.4.cmml">e</mi><mo id="S3.SS3.p1.3.m3.1.1.1.1.1b" xref="S3.SS3.p1.3.m3.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.1.1.1.1.5" xref="S3.SS3.p1.3.m3.1.1.1.1.5.cmml">r</mi><mo id="S3.SS3.p1.3.m3.1.1.1.1.1c" xref="S3.SS3.p1.3.m3.1.1.1.1.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.1.1.1.1.6" xref="S3.SS3.p1.3.m3.1.1.1.1.6.cmml">y</mi></mrow><mo id="S3.SS3.p1.3.m3.2.2.2.4" xref="S3.SS3.p1.3.m3.2.2.3.cmml">,</mo><mrow id="S3.SS3.p1.3.m3.2.2.2.2" xref="S3.SS3.p1.3.m3.2.2.2.2.cmml"><mi id="S3.SS3.p1.3.m3.2.2.2.2.2" xref="S3.SS3.p1.3.m3.2.2.2.2.2.cmml">d</mi><mo id="S3.SS3.p1.3.m3.2.2.2.2.1" xref="S3.SS3.p1.3.m3.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.2.2.2.2.3" xref="S3.SS3.p1.3.m3.2.2.2.2.3.cmml">o</mi><mo id="S3.SS3.p1.3.m3.2.2.2.2.1a" xref="S3.SS3.p1.3.m3.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.2.2.2.2.4" xref="S3.SS3.p1.3.m3.2.2.2.2.4.cmml">c</mi><mo id="S3.SS3.p1.3.m3.2.2.2.2.1b" xref="S3.SS3.p1.3.m3.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.2.2.2.2.5" xref="S3.SS3.p1.3.m3.2.2.2.2.5.cmml">u</mi><mo id="S3.SS3.p1.3.m3.2.2.2.2.1c" xref="S3.SS3.p1.3.m3.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.2.2.2.2.6" xref="S3.SS3.p1.3.m3.2.2.2.2.6.cmml">m</mi><mo id="S3.SS3.p1.3.m3.2.2.2.2.1d" xref="S3.SS3.p1.3.m3.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.2.2.2.2.7" xref="S3.SS3.p1.3.m3.2.2.2.2.7.cmml">e</mi><mo id="S3.SS3.p1.3.m3.2.2.2.2.1e" xref="S3.SS3.p1.3.m3.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.2.2.2.2.8" xref="S3.SS3.p1.3.m3.2.2.2.2.8.cmml">n</mi><mo id="S3.SS3.p1.3.m3.2.2.2.2.1f" xref="S3.SS3.p1.3.m3.2.2.2.2.1.cmml">â¢</mo><mi id="S3.SS3.p1.3.m3.2.2.2.2.9" xref="S3.SS3.p1.3.m3.2.2.2.2.9.cmml">t</mi></mrow><mo id="S3.SS3.p1.3.m3.2.2.2.5" stretchy="false" xref="S3.SS3.p1.3.m3.2.2.3.cmml">âŸ©</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.2b"><list id="S3.SS3.p1.3.m3.2.2.3.cmml" xref="S3.SS3.p1.3.m3.2.2.2"><apply id="S3.SS3.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1"><times id="S3.SS3.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1"></times><ci id="S3.SS3.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.2">ğ‘</ci><ci id="S3.SS3.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.3">ğ‘¢</ci><ci id="S3.SS3.p1.3.m3.1.1.1.1.4.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.4">ğ‘’</ci><ci id="S3.SS3.p1.3.m3.1.1.1.1.5.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.5">ğ‘Ÿ</ci><ci id="S3.SS3.p1.3.m3.1.1.1.1.6.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.6">ğ‘¦</ci></apply><apply id="S3.SS3.p1.3.m3.2.2.2.2.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2"><times id="S3.SS3.p1.3.m3.2.2.2.2.1.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.1"></times><ci id="S3.SS3.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.2">ğ‘‘</ci><ci id="S3.SS3.p1.3.m3.2.2.2.2.3.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.3">ğ‘œ</ci><ci id="S3.SS3.p1.3.m3.2.2.2.2.4.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.4">ğ‘</ci><ci id="S3.SS3.p1.3.m3.2.2.2.2.5.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.5">ğ‘¢</ci><ci id="S3.SS3.p1.3.m3.2.2.2.2.6.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.6">ğ‘š</ci><ci id="S3.SS3.p1.3.m3.2.2.2.2.7.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.7">ğ‘’</ci><ci id="S3.SS3.p1.3.m3.2.2.2.2.8.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.8">ğ‘›</ci><ci id="S3.SS3.p1.3.m3.2.2.2.2.9.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.9">ğ‘¡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.2c">\langle query,document\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.2d">âŸ¨ italic_q italic_u italic_e italic_r italic_y , italic_d italic_o italic_c italic_u italic_m italic_e italic_n italic_t âŸ©</annotation></semantics></math> pairs are positive sample and use the rest as hard-negative samples.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.3">We use InfoNCE loss <cite class="ltx_cite ltx_citemacro_citep">(vanÂ den Oord etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib91" title="">2019</a>)</cite> as the objective function to fine-tune retrieval models. Given a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_q</annotation></semantics></math>, a positive document <math alttext="d^{+}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><msup id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">d</mi><mo id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">ğ‘‘</ci><plus id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">d^{+}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_d start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>, and a set of negative documents <math alttext="D^{-}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><msup id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">D</mi><mo id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">âˆ’</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">ğ·</ci><minus id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">D^{-}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_D start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>, the loss function is represented as:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(q,d^{+},D^{-})=-\log\frac{\exp(sim(q,d^{+}))}{\exp(sim(q,d^{+}))+%
\sum\limits_{d^{-}\in D^{-}}\exp(sim(q,d^{-}))}" class="ltx_Math" display="block" id="S3.E5.m1.12"><semantics id="S3.E5.m1.12a"><mrow id="S3.E5.m1.12.12" xref="S3.E5.m1.12.12.cmml"><mrow id="S3.E5.m1.12.12.2" xref="S3.E5.m1.12.12.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.12.12.2.4" xref="S3.E5.m1.12.12.2.4.cmml">â„’</mi><mo id="S3.E5.m1.12.12.2.3" xref="S3.E5.m1.12.12.2.3.cmml">â¢</mo><mrow id="S3.E5.m1.12.12.2.2.2" xref="S3.E5.m1.12.12.2.2.3.cmml"><mo id="S3.E5.m1.12.12.2.2.2.3" stretchy="false" xref="S3.E5.m1.12.12.2.2.3.cmml">(</mo><mi id="S3.E5.m1.10.10" xref="S3.E5.m1.10.10.cmml">q</mi><mo id="S3.E5.m1.12.12.2.2.2.4" xref="S3.E5.m1.12.12.2.2.3.cmml">,</mo><msup id="S3.E5.m1.11.11.1.1.1.1" xref="S3.E5.m1.11.11.1.1.1.1.cmml"><mi id="S3.E5.m1.11.11.1.1.1.1.2" xref="S3.E5.m1.11.11.1.1.1.1.2.cmml">d</mi><mo id="S3.E5.m1.11.11.1.1.1.1.3" xref="S3.E5.m1.11.11.1.1.1.1.3.cmml">+</mo></msup><mo id="S3.E5.m1.12.12.2.2.2.5" xref="S3.E5.m1.12.12.2.2.3.cmml">,</mo><msup id="S3.E5.m1.12.12.2.2.2.2" xref="S3.E5.m1.12.12.2.2.2.2.cmml"><mi id="S3.E5.m1.12.12.2.2.2.2.2" xref="S3.E5.m1.12.12.2.2.2.2.2.cmml">D</mi><mo id="S3.E5.m1.12.12.2.2.2.2.3" xref="S3.E5.m1.12.12.2.2.2.2.3.cmml">âˆ’</mo></msup><mo id="S3.E5.m1.12.12.2.2.2.6" stretchy="false" xref="S3.E5.m1.12.12.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.12.12.3" xref="S3.E5.m1.12.12.3.cmml">=</mo><mrow id="S3.E5.m1.12.12.4" xref="S3.E5.m1.12.12.4.cmml"><mo id="S3.E5.m1.12.12.4a" rspace="0.167em" xref="S3.E5.m1.12.12.4.cmml">âˆ’</mo><mrow id="S3.E5.m1.12.12.4.2" xref="S3.E5.m1.12.12.4.2.cmml"><mi id="S3.E5.m1.12.12.4.2.1" xref="S3.E5.m1.12.12.4.2.1.cmml">log</mi><mo id="S3.E5.m1.12.12.4.2a" lspace="0.167em" xref="S3.E5.m1.12.12.4.2.cmml">â¡</mo><mfrac id="S3.E5.m1.9.9" xref="S3.E5.m1.9.9.cmml"><mrow id="S3.E5.m1.3.3.3.3" xref="S3.E5.m1.3.3.3.4.cmml"><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">exp</mi><mo id="S3.E5.m1.3.3.3.3a" xref="S3.E5.m1.3.3.3.4.cmml">â¡</mo><mrow id="S3.E5.m1.3.3.3.3.1" xref="S3.E5.m1.3.3.3.4.cmml"><mo id="S3.E5.m1.3.3.3.3.1.2" stretchy="false" xref="S3.E5.m1.3.3.3.4.cmml">(</mo><mrow id="S3.E5.m1.3.3.3.3.1.1" xref="S3.E5.m1.3.3.3.3.1.1.cmml"><mi id="S3.E5.m1.3.3.3.3.1.1.3" xref="S3.E5.m1.3.3.3.3.1.1.3.cmml">s</mi><mo id="S3.E5.m1.3.3.3.3.1.1.2" xref="S3.E5.m1.3.3.3.3.1.1.2.cmml">â¢</mo><mi id="S3.E5.m1.3.3.3.3.1.1.4" xref="S3.E5.m1.3.3.3.3.1.1.4.cmml">i</mi><mo id="S3.E5.m1.3.3.3.3.1.1.2a" xref="S3.E5.m1.3.3.3.3.1.1.2.cmml">â¢</mo><mi id="S3.E5.m1.3.3.3.3.1.1.5" xref="S3.E5.m1.3.3.3.3.1.1.5.cmml">m</mi><mo id="S3.E5.m1.3.3.3.3.1.1.2b" xref="S3.E5.m1.3.3.3.3.1.1.2.cmml">â¢</mo><mrow id="S3.E5.m1.3.3.3.3.1.1.1.1" xref="S3.E5.m1.3.3.3.3.1.1.1.2.cmml"><mo id="S3.E5.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.3.3.3.3.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">q</mi><mo id="S3.E5.m1.3.3.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.3.3.1.1.1.2.cmml">,</mo><msup id="S3.E5.m1.3.3.3.3.1.1.1.1.1" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.3.3.1.1.1.1.1.2" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.2.cmml">d</mi><mo id="S3.E5.m1.3.3.3.3.1.1.1.1.1.3" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S3.E5.m1.3.3.3.3.1.1.1.1.4" stretchy="false" xref="S3.E5.m1.3.3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.3.3.1.3" stretchy="false" xref="S3.E5.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E5.m1.9.9.9" xref="S3.E5.m1.9.9.9.cmml"><mrow id="S3.E5.m1.8.8.8.5.1" xref="S3.E5.m1.8.8.8.5.2.cmml"><mi id="S3.E5.m1.5.5.5.2" xref="S3.E5.m1.5.5.5.2.cmml">exp</mi><mo id="S3.E5.m1.8.8.8.5.1a" xref="S3.E5.m1.8.8.8.5.2.cmml">â¡</mo><mrow id="S3.E5.m1.8.8.8.5.1.1" xref="S3.E5.m1.8.8.8.5.2.cmml"><mo id="S3.E5.m1.8.8.8.5.1.1.2" stretchy="false" xref="S3.E5.m1.8.8.8.5.2.cmml">(</mo><mrow id="S3.E5.m1.8.8.8.5.1.1.1" xref="S3.E5.m1.8.8.8.5.1.1.1.cmml"><mi id="S3.E5.m1.8.8.8.5.1.1.1.3" xref="S3.E5.m1.8.8.8.5.1.1.1.3.cmml">s</mi><mo id="S3.E5.m1.8.8.8.5.1.1.1.2" xref="S3.E5.m1.8.8.8.5.1.1.1.2.cmml">â¢</mo><mi id="S3.E5.m1.8.8.8.5.1.1.1.4" xref="S3.E5.m1.8.8.8.5.1.1.1.4.cmml">i</mi><mo id="S3.E5.m1.8.8.8.5.1.1.1.2a" xref="S3.E5.m1.8.8.8.5.1.1.1.2.cmml">â¢</mo><mi id="S3.E5.m1.8.8.8.5.1.1.1.5" xref="S3.E5.m1.8.8.8.5.1.1.1.5.cmml">m</mi><mo id="S3.E5.m1.8.8.8.5.1.1.1.2b" xref="S3.E5.m1.8.8.8.5.1.1.1.2.cmml">â¢</mo><mrow id="S3.E5.m1.8.8.8.5.1.1.1.1.1" xref="S3.E5.m1.8.8.8.5.1.1.1.1.2.cmml"><mo id="S3.E5.m1.8.8.8.5.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.8.8.8.5.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.4.4.4.1" xref="S3.E5.m1.4.4.4.1.cmml">q</mi><mo id="S3.E5.m1.8.8.8.5.1.1.1.1.1.3" xref="S3.E5.m1.8.8.8.5.1.1.1.1.2.cmml">,</mo><msup id="S3.E5.m1.8.8.8.5.1.1.1.1.1.1" xref="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.2" xref="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.2.cmml">d</mi><mo id="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.3" xref="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S3.E5.m1.8.8.8.5.1.1.1.1.1.4" stretchy="false" xref="S3.E5.m1.8.8.8.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.8.8.8.5.1.1.3" stretchy="false" xref="S3.E5.m1.8.8.8.5.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.9.9.9.7" rspace="0.055em" xref="S3.E5.m1.9.9.9.7.cmml">+</mo><mrow id="S3.E5.m1.9.9.9.6" xref="S3.E5.m1.9.9.9.6.cmml"><munder id="S3.E5.m1.9.9.9.6.2" xref="S3.E5.m1.9.9.9.6.2.cmml"><mo id="S3.E5.m1.9.9.9.6.2.2" movablelimits="false" xref="S3.E5.m1.9.9.9.6.2.2.cmml">âˆ‘</mo><mrow id="S3.E5.m1.9.9.9.6.2.3" xref="S3.E5.m1.9.9.9.6.2.3.cmml"><msup id="S3.E5.m1.9.9.9.6.2.3.2" xref="S3.E5.m1.9.9.9.6.2.3.2.cmml"><mi id="S3.E5.m1.9.9.9.6.2.3.2.2" xref="S3.E5.m1.9.9.9.6.2.3.2.2.cmml">d</mi><mo id="S3.E5.m1.9.9.9.6.2.3.2.3" xref="S3.E5.m1.9.9.9.6.2.3.2.3.cmml">âˆ’</mo></msup><mo id="S3.E5.m1.9.9.9.6.2.3.1" xref="S3.E5.m1.9.9.9.6.2.3.1.cmml">âˆˆ</mo><msup id="S3.E5.m1.9.9.9.6.2.3.3" xref="S3.E5.m1.9.9.9.6.2.3.3.cmml"><mi id="S3.E5.m1.9.9.9.6.2.3.3.2" xref="S3.E5.m1.9.9.9.6.2.3.3.2.cmml">D</mi><mo id="S3.E5.m1.9.9.9.6.2.3.3.3" xref="S3.E5.m1.9.9.9.6.2.3.3.3.cmml">âˆ’</mo></msup></mrow></munder><mrow id="S3.E5.m1.9.9.9.6.1.1" xref="S3.E5.m1.9.9.9.6.1.2.cmml"><mi id="S3.E5.m1.7.7.7.4" xref="S3.E5.m1.7.7.7.4.cmml">exp</mi><mo id="S3.E5.m1.9.9.9.6.1.1a" xref="S3.E5.m1.9.9.9.6.1.2.cmml">â¡</mo><mrow id="S3.E5.m1.9.9.9.6.1.1.1" xref="S3.E5.m1.9.9.9.6.1.2.cmml"><mo id="S3.E5.m1.9.9.9.6.1.1.1.2" stretchy="false" xref="S3.E5.m1.9.9.9.6.1.2.cmml">(</mo><mrow id="S3.E5.m1.9.9.9.6.1.1.1.1" xref="S3.E5.m1.9.9.9.6.1.1.1.1.cmml"><mi id="S3.E5.m1.9.9.9.6.1.1.1.1.3" xref="S3.E5.m1.9.9.9.6.1.1.1.1.3.cmml">s</mi><mo id="S3.E5.m1.9.9.9.6.1.1.1.1.2" xref="S3.E5.m1.9.9.9.6.1.1.1.1.2.cmml">â¢</mo><mi id="S3.E5.m1.9.9.9.6.1.1.1.1.4" xref="S3.E5.m1.9.9.9.6.1.1.1.1.4.cmml">i</mi><mo id="S3.E5.m1.9.9.9.6.1.1.1.1.2a" xref="S3.E5.m1.9.9.9.6.1.1.1.1.2.cmml">â¢</mo><mi id="S3.E5.m1.9.9.9.6.1.1.1.1.5" xref="S3.E5.m1.9.9.9.6.1.1.1.1.5.cmml">m</mi><mo id="S3.E5.m1.9.9.9.6.1.1.1.1.2b" xref="S3.E5.m1.9.9.9.6.1.1.1.1.2.cmml">â¢</mo><mrow id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.6.6.6.3" xref="S3.E5.m1.6.6.6.3.cmml">q</mi><mo id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.3" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.2.cmml">,</mo><msup id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.2" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.2.cmml">d</mi><mo id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.3" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.3.cmml">âˆ’</mo></msup><mo id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.4" stretchy="false" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.9.9.9.6.1.1.1.3" stretchy="false" xref="S3.E5.m1.9.9.9.6.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.12b"><apply id="S3.E5.m1.12.12.cmml" xref="S3.E5.m1.12.12"><eq id="S3.E5.m1.12.12.3.cmml" xref="S3.E5.m1.12.12.3"></eq><apply id="S3.E5.m1.12.12.2.cmml" xref="S3.E5.m1.12.12.2"><times id="S3.E5.m1.12.12.2.3.cmml" xref="S3.E5.m1.12.12.2.3"></times><ci id="S3.E5.m1.12.12.2.4.cmml" xref="S3.E5.m1.12.12.2.4">â„’</ci><vector id="S3.E5.m1.12.12.2.2.3.cmml" xref="S3.E5.m1.12.12.2.2.2"><ci id="S3.E5.m1.10.10.cmml" xref="S3.E5.m1.10.10">ğ‘</ci><apply id="S3.E5.m1.11.11.1.1.1.1.cmml" xref="S3.E5.m1.11.11.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.1.1.1.1.1.cmml" xref="S3.E5.m1.11.11.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.11.11.1.1.1.1.2.cmml" xref="S3.E5.m1.11.11.1.1.1.1.2">ğ‘‘</ci><plus id="S3.E5.m1.11.11.1.1.1.1.3.cmml" xref="S3.E5.m1.11.11.1.1.1.1.3"></plus></apply><apply id="S3.E5.m1.12.12.2.2.2.2.cmml" xref="S3.E5.m1.12.12.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.2.2.2.2.1.cmml" xref="S3.E5.m1.12.12.2.2.2.2">superscript</csymbol><ci id="S3.E5.m1.12.12.2.2.2.2.2.cmml" xref="S3.E5.m1.12.12.2.2.2.2.2">ğ·</ci><minus id="S3.E5.m1.12.12.2.2.2.2.3.cmml" xref="S3.E5.m1.12.12.2.2.2.2.3"></minus></apply></vector></apply><apply id="S3.E5.m1.12.12.4.cmml" xref="S3.E5.m1.12.12.4"><minus id="S3.E5.m1.12.12.4.1.cmml" xref="S3.E5.m1.12.12.4"></minus><apply id="S3.E5.m1.12.12.4.2.cmml" xref="S3.E5.m1.12.12.4.2"><log id="S3.E5.m1.12.12.4.2.1.cmml" xref="S3.E5.m1.12.12.4.2.1"></log><apply id="S3.E5.m1.9.9.cmml" xref="S3.E5.m1.9.9"><divide id="S3.E5.m1.9.9.10.cmml" xref="S3.E5.m1.9.9"></divide><apply id="S3.E5.m1.3.3.3.4.cmml" xref="S3.E5.m1.3.3.3.3"><exp id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2"></exp><apply id="S3.E5.m1.3.3.3.3.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1"><times id="S3.E5.m1.3.3.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.3.3.1.1.2"></times><ci id="S3.E5.m1.3.3.3.3.1.1.3.cmml" xref="S3.E5.m1.3.3.3.3.1.1.3">ğ‘ </ci><ci id="S3.E5.m1.3.3.3.3.1.1.4.cmml" xref="S3.E5.m1.3.3.3.3.1.1.4">ğ‘–</ci><ci id="S3.E5.m1.3.3.3.3.1.1.5.cmml" xref="S3.E5.m1.3.3.3.3.1.1.5">ğ‘š</ci><interval closure="open" id="S3.E5.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">ğ‘</ci><apply id="S3.E5.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.2">ğ‘‘</ci><plus id="S3.E5.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.3"></plus></apply></interval></apply></apply><apply id="S3.E5.m1.9.9.9.cmml" xref="S3.E5.m1.9.9.9"><plus id="S3.E5.m1.9.9.9.7.cmml" xref="S3.E5.m1.9.9.9.7"></plus><apply id="S3.E5.m1.8.8.8.5.2.cmml" xref="S3.E5.m1.8.8.8.5.1"><exp id="S3.E5.m1.5.5.5.2.cmml" xref="S3.E5.m1.5.5.5.2"></exp><apply id="S3.E5.m1.8.8.8.5.1.1.1.cmml" xref="S3.E5.m1.8.8.8.5.1.1.1"><times id="S3.E5.m1.8.8.8.5.1.1.1.2.cmml" xref="S3.E5.m1.8.8.8.5.1.1.1.2"></times><ci id="S3.E5.m1.8.8.8.5.1.1.1.3.cmml" xref="S3.E5.m1.8.8.8.5.1.1.1.3">ğ‘ </ci><ci id="S3.E5.m1.8.8.8.5.1.1.1.4.cmml" xref="S3.E5.m1.8.8.8.5.1.1.1.4">ğ‘–</ci><ci id="S3.E5.m1.8.8.8.5.1.1.1.5.cmml" xref="S3.E5.m1.8.8.8.5.1.1.1.5">ğ‘š</ci><interval closure="open" id="S3.E5.m1.8.8.8.5.1.1.1.1.2.cmml" xref="S3.E5.m1.8.8.8.5.1.1.1.1.1"><ci id="S3.E5.m1.4.4.4.1.cmml" xref="S3.E5.m1.4.4.4.1">ğ‘</ci><apply id="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.cmml" xref="S3.E5.m1.8.8.8.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.8.8.8.5.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.2">ğ‘‘</ci><plus id="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.8.8.8.5.1.1.1.1.1.1.3"></plus></apply></interval></apply></apply><apply id="S3.E5.m1.9.9.9.6.cmml" xref="S3.E5.m1.9.9.9.6"><apply id="S3.E5.m1.9.9.9.6.2.cmml" xref="S3.E5.m1.9.9.9.6.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.6.2.1.cmml" xref="S3.E5.m1.9.9.9.6.2">subscript</csymbol><sum id="S3.E5.m1.9.9.9.6.2.2.cmml" xref="S3.E5.m1.9.9.9.6.2.2"></sum><apply id="S3.E5.m1.9.9.9.6.2.3.cmml" xref="S3.E5.m1.9.9.9.6.2.3"><in id="S3.E5.m1.9.9.9.6.2.3.1.cmml" xref="S3.E5.m1.9.9.9.6.2.3.1"></in><apply id="S3.E5.m1.9.9.9.6.2.3.2.cmml" xref="S3.E5.m1.9.9.9.6.2.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.6.2.3.2.1.cmml" xref="S3.E5.m1.9.9.9.6.2.3.2">superscript</csymbol><ci id="S3.E5.m1.9.9.9.6.2.3.2.2.cmml" xref="S3.E5.m1.9.9.9.6.2.3.2.2">ğ‘‘</ci><minus id="S3.E5.m1.9.9.9.6.2.3.2.3.cmml" xref="S3.E5.m1.9.9.9.6.2.3.2.3"></minus></apply><apply id="S3.E5.m1.9.9.9.6.2.3.3.cmml" xref="S3.E5.m1.9.9.9.6.2.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.6.2.3.3.1.cmml" xref="S3.E5.m1.9.9.9.6.2.3.3">superscript</csymbol><ci id="S3.E5.m1.9.9.9.6.2.3.3.2.cmml" xref="S3.E5.m1.9.9.9.6.2.3.3.2">ğ·</ci><minus id="S3.E5.m1.9.9.9.6.2.3.3.3.cmml" xref="S3.E5.m1.9.9.9.6.2.3.3.3"></minus></apply></apply></apply><apply id="S3.E5.m1.9.9.9.6.1.2.cmml" xref="S3.E5.m1.9.9.9.6.1.1"><exp id="S3.E5.m1.7.7.7.4.cmml" xref="S3.E5.m1.7.7.7.4"></exp><apply id="S3.E5.m1.9.9.9.6.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.6.1.1.1.1"><times id="S3.E5.m1.9.9.9.6.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.6.1.1.1.1.2"></times><ci id="S3.E5.m1.9.9.9.6.1.1.1.1.3.cmml" xref="S3.E5.m1.9.9.9.6.1.1.1.1.3">ğ‘ </ci><ci id="S3.E5.m1.9.9.9.6.1.1.1.1.4.cmml" xref="S3.E5.m1.9.9.9.6.1.1.1.1.4">ğ‘–</ci><ci id="S3.E5.m1.9.9.9.6.1.1.1.1.5.cmml" xref="S3.E5.m1.9.9.9.6.1.1.1.1.5">ğ‘š</ci><interval closure="open" id="S3.E5.m1.9.9.9.6.1.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.1"><ci id="S3.E5.m1.6.6.6.3.cmml" xref="S3.E5.m1.6.6.6.3">ğ‘</ci><apply id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.2">ğ‘‘</ci><minus id="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.9.9.9.6.1.1.1.1.1.1.1.3"></minus></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.12c">\mathcal{L}(q,d^{+},D^{-})=-\log\frac{\exp(sim(q,d^{+}))}{\exp(sim(q,d^{+}))+%
\sum\limits_{d^{-}\in D^{-}}\exp(sim(q,d^{-}))}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.12d">caligraphic_L ( italic_q , italic_d start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , italic_D start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) = - roman_log divide start_ARG roman_exp ( italic_s italic_i italic_m ( italic_q , italic_d start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) end_ARG start_ARG roman_exp ( italic_s italic_i italic_m ( italic_q , italic_d start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) + âˆ‘ start_POSTSUBSCRIPT italic_d start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT âˆˆ italic_D start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_exp ( italic_s italic_i italic_m ( italic_q , italic_d start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.5">where <math alttext="sim(q,d)" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.2"><semantics id="S3.SS3.p4.1.m1.2a"><mrow id="S3.SS3.p4.1.m1.2.3" xref="S3.SS3.p4.1.m1.2.3.cmml"><mi id="S3.SS3.p4.1.m1.2.3.2" xref="S3.SS3.p4.1.m1.2.3.2.cmml">s</mi><mo id="S3.SS3.p4.1.m1.2.3.1" xref="S3.SS3.p4.1.m1.2.3.1.cmml">â¢</mo><mi id="S3.SS3.p4.1.m1.2.3.3" xref="S3.SS3.p4.1.m1.2.3.3.cmml">i</mi><mo id="S3.SS3.p4.1.m1.2.3.1a" xref="S3.SS3.p4.1.m1.2.3.1.cmml">â¢</mo><mi id="S3.SS3.p4.1.m1.2.3.4" xref="S3.SS3.p4.1.m1.2.3.4.cmml">m</mi><mo id="S3.SS3.p4.1.m1.2.3.1b" xref="S3.SS3.p4.1.m1.2.3.1.cmml">â¢</mo><mrow id="S3.SS3.p4.1.m1.2.3.5.2" xref="S3.SS3.p4.1.m1.2.3.5.1.cmml"><mo id="S3.SS3.p4.1.m1.2.3.5.2.1" stretchy="false" xref="S3.SS3.p4.1.m1.2.3.5.1.cmml">(</mo><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">q</mi><mo id="S3.SS3.p4.1.m1.2.3.5.2.2" xref="S3.SS3.p4.1.m1.2.3.5.1.cmml">,</mo><mi id="S3.SS3.p4.1.m1.2.2" xref="S3.SS3.p4.1.m1.2.2.cmml">d</mi><mo id="S3.SS3.p4.1.m1.2.3.5.2.3" stretchy="false" xref="S3.SS3.p4.1.m1.2.3.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.2b"><apply id="S3.SS3.p4.1.m1.2.3.cmml" xref="S3.SS3.p4.1.m1.2.3"><times id="S3.SS3.p4.1.m1.2.3.1.cmml" xref="S3.SS3.p4.1.m1.2.3.1"></times><ci id="S3.SS3.p4.1.m1.2.3.2.cmml" xref="S3.SS3.p4.1.m1.2.3.2">ğ‘ </ci><ci id="S3.SS3.p4.1.m1.2.3.3.cmml" xref="S3.SS3.p4.1.m1.2.3.3">ğ‘–</ci><ci id="S3.SS3.p4.1.m1.2.3.4.cmml" xref="S3.SS3.p4.1.m1.2.3.4">ğ‘š</ci><interval closure="open" id="S3.SS3.p4.1.m1.2.3.5.1.cmml" xref="S3.SS3.p4.1.m1.2.3.5.2"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">ğ‘</ci><ci id="S3.SS3.p4.1.m1.2.2.cmml" xref="S3.SS3.p4.1.m1.2.2">ğ‘‘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.2c">sim(q,d)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.2d">italic_s italic_i italic_m ( italic_q , italic_d )</annotation></semantics></math> is the similarity value between a query <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">ğ‘‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.1d">italic_d</annotation></semantics></math> and a document <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m3.1"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">ğ‘‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m3.1d">italic_d</annotation></semantics></math> defined in equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S3.E1" title="In 3.1 Dense Retrieval in RAG â€£ 3 Methodology â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">1</span></a>). For efficient training, the negative set <math alttext="D^{-}" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m4.1"><semantics id="S3.SS3.p4.4.m4.1a"><msup id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><mi id="S3.SS3.p4.4.m4.1.1.2" xref="S3.SS3.p4.4.m4.1.1.2.cmml">D</mi><mo id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml">âˆ’</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2">ğ·</ci><minus id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">D^{-}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m4.1d">italic_D start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> includes both hard-negative and in-batch negatives, which are derived from positive documents and hard negative documents associated with other queries. This training pipeline tends to benefit from a bigger set of negative samples. During the inference phase, we keep the same pipeline as in a typical RAG system. In more details, we first embed the external database using the fine-tuned retrieval model, then perform retrieving with a fast <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m5.1"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m5.1d">italic_k</annotation></semantics></math>-nearest neighbors library such as FAISS <cite class="ltx_cite ltx_citemacro_citep">(Johnson etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib39" title="">2021</a>)</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we present our experiments in a wide range of NLP tasks as well as analyzing our models in different aspects.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Main Experiments</h3>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Experiments Setup</h4>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS1.p1.1.1">Tasks and Datasets.</span> We first conduct experiments on general domains: (1) <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p1.1.2">Open-domain QA</span>, which includes Natural Questions (NQ) <cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib47" title="">2019</a>)</cite>, and TriviaQA <cite class="ltx_cite ltx_citemacro_citep">(Joshi etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib41" title="">2017</a>)</cite>. (2) <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p1.1.3">Fact verification</span> includes FEVER <cite class="ltx_cite ltx_citemacro_citep">(Thorne etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib87" title="">2018</a>)</cite>. We use the split from the KILT benchmark <cite class="ltx_cite ltx_citemacro_citep">(Petroni etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib69" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.p2">
<p class="ltx_p" id="S4.SS1.SSS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS1.p2.1.1">Training data and settings.</span> We use Natural Questions (NQ) <cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib47" title="">2019</a>)</cite>, Trivia-QA (Tri) <cite class="ltx_cite ltx_citemacro_citep">(Joshi etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib41" title="">2017</a>)</cite>, and SQUAD <cite class="ltx_cite ltx_citemacro_citep">(Rajpurkar etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib73" title="">2016</a>)</cite> to build our models for general domain question-answering tasks. We follow the design in DPR <cite class="ltx_cite ltx_citemacro_citep">(Karpukhin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib43" title="">2020</a>)</cite> to use preprocessed 2018 English Wikipedia as our corpus. To train the reward model, we sample 9000 queries from the NQ dataset and 3-5 documents for each query to label the relevance. For fine-tuning the retrieval encoder, we use a total of 100k queries from a blend of NQ and TriviaQA datasets as our train set and use our reward models to mine positive and negative documents as explained above.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.p3">
<p class="ltx_p" id="S4.SS1.SSS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS1.p3.1.1">Baselines.</span> We consider baselines in terms of text retrieval and question-answering tasks. For text retrieval, we consider Promptgator <cite class="ltx_cite ltx_citemacro_citep">(Dai etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib11" title="">2023</a>)</cite>, Dragon <cite class="ltx_cite ltx_citemacro_citep">(Lin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib53" title="">2023</a>)</cite>, Contriever <cite class="ltx_cite ltx_citemacro_citep">(Izacard etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib33" title="">2022</a>)</cite>, SPLADE++ <cite class="ltx_cite ltx_citemacro_citep">(Formal etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib17" title="">2022</a>)</cite>, GTE <cite class="ltx_cite ltx_citemacro_cite">Li etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib52" title="">2023</a>)</cite>. For question-answering, we consider baseline LLMs without RAG (Mixtral-8x22B-Instruct <cite class="ltx_cite ltx_citemacro_citep">(Jiang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib35" title="">2023</a>)</cite>, PaLM2 <cite class="ltx_cite ltx_citemacro_citep">(Anil etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib1" title="">2023</a>)</cite>, GPT-3.5-turbo <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib65" title="">2022</a>)</cite>, GPT-4 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib66" title="">2024</a>)</cite>), baselines with retrieval (Atlas <cite class="ltx_cite ltx_citemacro_citep">(Izacard etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib34" title="">2023</a>)</cite>, Raven <cite class="ltx_cite ltx_citemacro_citep">(Huang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib30" title="">2024</a>)</cite>, Self-RAG <cite class="ltx_cite ltx_citemacro_citep">(Asai etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib2" title="">2024</a>)</cite>, Recomp <cite class="ltx_cite ltx_citemacro_citep">(Xu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib101" title="">2024a</a>)</cite>, Replug <cite class="ltx_cite ltx_citemacro_citep">(Shi etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib81" title="">2024</a>)</cite>, Ra-dit <cite class="ltx_cite ltx_citemacro_citep">(Lin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib54" title="">2024</a>)</cite>, ChatQA-1.5 <cite class="ltx_cite ltx_citemacro_citep">(Liu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib57" title="">2024b</a>)</cite>, RankRAG <cite class="ltx_cite ltx_citemacro_citep">(Yu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib103" title="">2024</a>)</cite>, and RAG pipeline using LLMs)</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.p4">
<p class="ltx_p" id="S4.SS1.SSS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS1.p4.1.1">Evaluation Metrics.</span> For Open-domain QA tasks, we use <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p4.1.2">Exact Match (EM)</span> as the main metric for NQ and TriviaQA. We also report <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p4.1.3">accuracy</span> for TriviaQA. For <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p4.1.4">Fact verification</span> task, we use <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p4.1.5">accuracy</span> as the main metric.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS1.p5">
<p class="ltx_p" id="S4.SS1.SSS1.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS1.p5.1.1">Implementation Details.</span> We use <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p5.1.2">E5-large-unsupervised</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib95" title="">2022b</a>)</cite> as our base retrieval encoder to fine-tune. We use the baseline encoder to retrieve top-25 documents from the Wikipedia corpus for each query in our training set and sample from these documents to rate the relevance of <math alttext="\langle query,\,document\rangle" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p5.1.m1.2"><semantics id="S4.SS1.SSS1.p5.1.m1.2a"><mrow id="S4.SS1.SSS1.p5.1.m1.2.2.2" xref="S4.SS1.SSS1.p5.1.m1.2.2.3.cmml"><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.3" stretchy="false" xref="S4.SS1.SSS1.p5.1.m1.2.2.3.cmml">âŸ¨</mo><mrow id="S4.SS1.SSS1.p5.1.m1.1.1.1.1" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.2" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.2.cmml">q</mi><mo id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.1" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.3" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.3.cmml">u</mi><mo id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.1a" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.4" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.4.cmml">e</mi><mo id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.1b" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.5" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.5.cmml">r</mi><mo id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.1c" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.6" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.6.cmml">y</mi></mrow><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.4" rspace="0.337em" xref="S4.SS1.SSS1.p5.1.m1.2.2.3.cmml">,</mo><mrow id="S4.SS1.SSS1.p5.1.m1.2.2.2.2" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.cmml"><mi id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.2" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.2.cmml">d</mi><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.3" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.3.cmml">o</mi><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1a" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.4" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.4.cmml">c</mi><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1b" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.5" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.5.cmml">u</mi><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1c" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.6" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.6.cmml">m</mi><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1d" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.7" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.7.cmml">e</mi><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1e" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.8" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.8.cmml">n</mi><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1f" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.9" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.9.cmml">t</mi></mrow><mo id="S4.SS1.SSS1.p5.1.m1.2.2.2.5" stretchy="false" xref="S4.SS1.SSS1.p5.1.m1.2.2.3.cmml">âŸ©</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.1.m1.2b"><list id="S4.SS1.SSS1.p5.1.m1.2.2.3.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2"><apply id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1"><times id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.1"></times><ci id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.2">ğ‘</ci><ci id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.3">ğ‘¢</ci><ci id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.4.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.4">ğ‘’</ci><ci id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.5.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.5">ğ‘Ÿ</ci><ci id="S4.SS1.SSS1.p5.1.m1.1.1.1.1.6.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1.1.1.6">ğ‘¦</ci></apply><apply id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2"><times id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.1"></times><ci id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.2">ğ‘‘</ci><ci id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.3">ğ‘œ</ci><ci id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.4.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.4">ğ‘</ci><ci id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.5.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.5">ğ‘¢</ci><ci id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.6.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.6">ğ‘š</ci><ci id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.7.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.7">ğ‘’</ci><ci id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.8.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.8">ğ‘›</ci><ci id="S4.SS1.SSS1.p5.1.m1.2.2.2.2.9.cmml" xref="S4.SS1.SSS1.p5.1.m1.2.2.2.2.9">ğ‘¡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.1.m1.2c">\langle query,\,document\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p5.1.m1.2d">âŸ¨ italic_q italic_u italic_e italic_r italic_y , italic_d italic_o italic_c italic_u italic_m italic_e italic_n italic_t âŸ©</annotation></semantics></math> pairs using GPT-4o. We use Llama-3.1-8B-Instruct <cite class="ltx_cite ltx_citemacro_citep">(Meta, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib61" title="">2024</a>)</cite> as our critic model. We apply LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib29" title="">2022</a>)</cite> and DeepSpeed <cite class="ltx_cite ltx_citemacro_citep">(Rasley etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib75" title="">2020</a>)</cite> to train our models efficiently. The detailed training settings and prompts is in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#A1" title="Appendix A Training Hyperparameters â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Results</h4>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performance of our encoder and comparison with existing state-of-the-art models at the same size. NDCG@10 is used as the metric to benchmark retrieval encoders. These models are benchmark on three datasets from MTEB Benchmark <cite class="ltx_cite ltx_citemacro_citep">(Muennighoff etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib63" title="">2023</a>)</cite>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">Task</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.1.2">NQ</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.1.3">HotPotQA</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.1.4">Fever</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.2.1.1">SPLADE++ <cite class="ltx_cite ltx_citemacro_citep">(Formal etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib17" title="">2022</a>)</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.2">54.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.3">68.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.4">79.6</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.3.2.1">Promptgator <cite class="ltx_cite ltx_citemacro_citep">(Dai etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib11" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.2.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.2.3">60.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.2.4">76.2</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.4.3.1">Contriever <cite class="ltx_cite ltx_citemacro_citep">(Izacard etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib33" title="">2022</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.3.2">49.5</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.3.3">63.8</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.3.4">75.8</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.5.4.1">Dragon <cite class="ltx_cite ltx_citemacro_citep">(Lin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib53" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.4.2">53.7</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.4.3">66.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.4.4">78.1</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.6.5.1">Gte-large-v1.5 <cite class="ltx_cite ltx_citemacro_cite">Li etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib52" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.5.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.6.5.2.1">56.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.5.3">68.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S4.T1.1.6.5.4.1">93.8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.7.6.1">Bge-large-v1.5 <cite class="ltx_cite ltx_citemacro_cite">Xiao etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib99" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.6.2">55.0</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.6.3"><span class="ltx_text ltx_font_bold" id="S4.T1.1.7.6.3.1">74.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.6.4">87.2</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.8.7.1">E5-large-unsupervised <cite class="ltx_cite ltx_citemacro_citep">(Wang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib95" title="">2022b</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.7.2">41.7</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.7.3">52.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.7.4">68.6</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.9.8.1">UAE-large-v1 <cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Li, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib51" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.8.2">55.8</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.8.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.9.8.3.1">73.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.8.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.9.8.4.1">88.2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.10.9.1">E5-large-unsupervised (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.10.9.2"><span class="ltx_text ltx_font_bold" id="S4.T1.1.10.9.2.1">60.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.10.9.3">65.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.10.9.4">76.3</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results of Reward-RAG and baselines in general domains on differernt datasets. We use the split from KILT benchmark for our results. Results unavailable in public reports are marked as â€œâ€“â€</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.1">Task</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.1.1.1.2">NQ</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.1.1.1.3">TriviaQA</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.1.1.1.4">FEVER</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.2.2.1">Metric</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.2.2.2">EM</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.2.2.3">EM / Acc</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.2.2.4">Acc</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.3.3.1">Without Retrieval-Augmented Generation</th>
<td class="ltx_td ltx_border_t" id="S4.T2.1.3.3.2"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.1.3.3.3"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.1.3.3.4"></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.4.4.1">PaLM2 540B <cite class="ltx_cite ltx_citemacro_citep">(Anil etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib1" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.4.4.2">37.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.4.4.3">86.1/-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.4.4.4">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.5.5.1">Mixtral-8x22B-Instruct <cite class="ltx_cite ltx_citemacro_citep">(Jiang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib35" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.5.5.2">40.1</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.5.5.3">82.2/-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.5.5.4">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.6.6.1">GPT-3.5-turbo-1106 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib65" title="">2022</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.6.6.2">38.6</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.6.6.3">82.9/91.7</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.6.6.4">82.7</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.7.7.1">GPT-4-0613 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib66" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.7.7.2">40.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.7.7.3">
<span class="ltx_text ltx_font_bold" id="S4.T2.1.7.7.3.1">84.8</span>/94.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.7.7.4">87.7</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.8.8.1">With Retrieval-Augmented Generation</th>
<td class="ltx_td ltx_border_t" id="S4.T2.1.8.8.2"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.1.8.8.3"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.1.8.8.4"></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.9.9.1">Atlas 11B <cite class="ltx_cite ltx_citemacro_citep">(Izacard etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib34" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.9.9.2">26.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.9.9.3">56.9/-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.9.9.4">77.0</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.10.10.1">Raven 11B <cite class="ltx_cite ltx_citemacro_citep">(Huang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib30" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.10.10.2">29.6</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.10.10.3">65.7/-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.10.10.4">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.11.11.1">Self-RAG 7B <cite class="ltx_cite ltx_citemacro_citep">(Asai etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib2" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.11.11.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.11.11.3">-/66.4</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.11.11.4">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.12.12.1">Self-RAG 13B <cite class="ltx_cite ltx_citemacro_citep">(Asai etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib2" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.12.12.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.12.12.3">-/69.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.12.12.4">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.13.13.1">RECOMP 20B <cite class="ltx_cite ltx_citemacro_citep">(Xu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib101" title="">2024a</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.13.13.2">37.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.13.13.3">59.0/-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.13.13.4">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.14.14.1">RePlug 65B <cite class="ltx_cite ltx_citemacro_citep">(Shi etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib81" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.14.14.2">28.8</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.14.14.3">72.6/-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.14.14.4">73.3</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.15.15.1">RA-DIT 65B <cite class="ltx_cite ltx_citemacro_citep">(Lin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib54" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.15.15.2">35.2</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.15.15.3">75.4/-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.15.15.4">80.7</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.16.16.1">Llama3-ChatQA-1.5 8B <cite class="ltx_cite ltx_citemacro_citep">(Liu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib57" title="">2024b</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.16.16.2">42.4</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.16.16.3">81.0/87.6</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.16.16.4">90.9</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.17.17.1">Llama3-RankRAG 8B <cite class="ltx_cite ltx_citemacro_citep">(Yu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib103" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.17.17.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.17.17.2.1">50.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.17.17.3">82.9/89.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.17.17.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.17.17.4.1">92.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.18.18.1">GPT-3.5-turbo-1106 RAG (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.18.18.2">42.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.18.18.3">75.6/80.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.18.18.4">89.8</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.19.19.1">GPT-4-0613 RAG (ours)</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.19.19.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.19.19.2.1">50.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.19.19.3">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.19.19.3.1">84.4</span>/90.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.19.19.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.19.19.4.1">92.3</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">We first measure our retrieval encoders in the information retrieval task. We use three datasets in the general domain from the MTEB benchmark <cite class="ltx_cite ltx_citemacro_citep">(Muennighoff etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib63" title="">2023</a>)</cite> to test our model. We report the NDCG@10 score of our models and compare them with baselines and state-of-the-art models. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.T1" title="Table 1 â€£ 4.1.2 Results â€£ 4.1 Main Experiments â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">1</span></a> represents the performance of our model and another baseline. As our model has less than 400M parameters, we only select state-of-the-art models that have similar number of parameters from the MTEB leaderboard. Compared to the base model, our models increase performance on both three datasets. On the NQ dataset, our model is the best model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS2.p2">
<p class="ltx_p" id="S4.SS1.SSS2.p2.1">Results for the downstream question-answering tasks are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.T2" title="Table 2 â€£ 4.1.2 Results â€£ 4.1 Main Experiments â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">2</span></a>. On the NQ and FEVER datasets, our model archives the best performance, while on the TriviaQA dataset, our method is the second-best model. It is noteworthy that in other models including RA-DIT, RankRAG, and Self-RAG, their methods fine-tune LLMs to adapt to downstream tasks, which is expensive and limits the generalization of LLMs. In our method, we do not modify the LLMs; instead, we aim to guide them by providing valuable information in a cost-effective way. In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.T5" title="Table 5 â€£ 4.3.3 Case Study â€£ 4.3 Ablation Studies â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">5</span></a>, we show a sample query from the NQ dataset with retrieved documents and the answer from different models. We observe that when the correct answer appears multiple times in the provided contexts, the presence of distractors does not affect the LLMsâ€™ responses.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Domain Specific RAG Tasks</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">Tasks and Datasets.</span> Besides general domain, we study the performance of our method in the medical field. We use Mirage <cite class="ltx_cite ltx_citemacro_citep">(Xiong etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib100" title="">2024</a>)</cite>, a recent RAG benchmark, to test our method. There are 5 dataset in their benchmark: PubMedQA <cite class="ltx_cite ltx_citemacro_citep">(Jin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib38" title="">2019</a>)</cite>, BioASQ <cite class="ltx_cite ltx_citemacro_citep">(Tsatsaronis etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib90" title="">2015</a>)</cite>), MMLU-med <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib26" title="">2021</a>)</cite>, MedMCQA <cite class="ltx_cite ltx_citemacro_citep">(Pal etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib68" title="">2022</a>)</cite>, MedQA <cite class="ltx_cite ltx_citemacro_citep">(Jin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib37" title="">2021</a>)</cite>. Followed <cite class="ltx_cite ltx_citemacro_citep">(Xiong etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib100" title="">2024</a>)</cite>, we use MedCorp<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://huggingface.co/MedRAG</span></span></span> as our corpus.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Results.</span> Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.T3" title="Table 3 â€£ 4.2 Domain Specific RAG Tasks â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">3</span></a> shows the performance of our models and other baselines. We report the accuracy as the format of the downstream task is multiple-choice questions. Our method outperforms other baselines on the PubmedQA dataset, while it is the second-best model on the BioASQ dataset. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.T6" title="Table 6 â€£ 4.3.3 Case Study â€£ 4.3 Ablation Studies â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">6</span></a> shows case studies we pick from different datasets. Since questions in the medical domain require logical thinking and reasoning, we emphasize the importance of providing correct relevant documents.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results of Reward-RAG and baselines in the medical field on Mirage benchmark. For baseline using retrieval-augmented generation, MedCorp is used as corpus and RRF-4 is the retrieval method, most numbers are from public reports <cite class="ltx_cite ltx_citemacro_citep">(Xiong etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib100" title="">2024</a>; Yu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib103" title="">2024</a>)</cite></figcaption>
<p class="ltx_p ltx_align_center" id="S4.T3.1">.

<span class="ltx_tabular ltx_align_middle" id="S4.T3.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="S4.T3.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.1.1">Task</span></span>
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.1.2">MMLU-med</span>
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.1.3">PubmedQA</span>
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.1.4">BioASQ</span>
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.1.5">MedQA</span>
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.1.1.6">MedMCQA</span></span>
<span class="ltx_tr" id="S4.T3.1.1.2.2">
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.2.2.1">Without Retrieval-Augmented Generation</span>
<span class="ltx_td ltx_border_t" id="S4.T3.1.1.2.2.2"></span>
<span class="ltx_td ltx_border_t" id="S4.T3.1.1.2.2.3"></span>
<span class="ltx_td ltx_border_t" id="S4.T3.1.1.2.2.4"></span>
<span class="ltx_td ltx_border_t" id="S4.T3.1.1.2.2.5"></span>
<span class="ltx_td ltx_border_t" id="S4.T3.1.1.2.2.6"></span></span>
<span class="ltx_tr" id="S4.T3.1.1.3.3">
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.3.3.1">GPT-3.5 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib65" title="">2022</a>)</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.2">72.9</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.3">36.0</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.4">74.3</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.5">65.0</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.6">55.2</span></span>
<span class="ltx_tr" id="S4.T3.1.1.4.4">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.4.4.1">GPT-4-0613 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib66" title="">2024</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.4.2.1">89.4</span></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.3">39.6</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.4">84.3</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.4.5.1">83.9</span></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.6"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.4.6.1">69.8</span></span></span>
<span class="ltx_tr" id="S4.T3.1.1.5.5">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.5.5.1">PMC-llama 13B <cite class="ltx_cite ltx_citemacro_citep">(Wu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib98" title="">2024</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.2">52.2</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.3">55.8</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.4">63.1</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.5">44.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.6">46.6</span></span>
<span class="ltx_tr" id="S4.T3.1.1.6.6">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.6.6.1">Llama2 70B <cite class="ltx_cite ltx_citemacro_citep">(Touvron etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib89" title="">2023b</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.2">57.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.3">42.2</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.4">61.2</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.5">47.8</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.6">42.6</span></span>
<span class="ltx_tr" id="S4.T3.1.1.7.7">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.7.7.1">Mixtral 8*7B <cite class="ltx_cite ltx_citemacro_citep">(Jiang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib36" title="">2024</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.2">74.0</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.3">35.2</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.4">77.5</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.5">64.1</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.6">56.2</span></span>
<span class="ltx_tr" id="S4.T3.1.1.8.8">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.8.8.1">Meditron 70B <cite class="ltx_cite ltx_citemacro_citep">(Chen etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib10" title="">2023b</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.2">64.9</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.3">53.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.4">68.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.5">51.6</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.6">46.7</span></span>
<span class="ltx_tr" id="S4.T3.1.1.9.9">
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.9.9.1">With Retrieval-Augmented Generation</span>
<span class="ltx_td ltx_border_t" id="S4.T3.1.1.9.9.2"></span>
<span class="ltx_td ltx_border_t" id="S4.T3.1.1.9.9.3"></span>
<span class="ltx_td ltx_border_t" id="S4.T3.1.1.9.9.4"></span>
<span class="ltx_td ltx_border_t" id="S4.T3.1.1.9.9.5"></span>
<span class="ltx_td ltx_border_t" id="S4.T3.1.1.9.9.6"></span></span>
<span class="ltx_tr" id="S4.T3.1.1.10.10">
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.10.10.1">GPT-3.5 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib65" title="">2022</a>)</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.10.10.2">75.5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.10.10.3">67.4</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.10.10.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.10.10.4.1">90.3</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.10.10.5">66.6</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.10.10.6">58.0</span></span>
<span class="ltx_tr" id="S4.T3.1.1.11.11">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.11.11.1">GPT-4-0613 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib66" title="">2024</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.11.11.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.11.11.2.1">87.2</span></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.11.11.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.11.11.3.1">70.6</span></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.11.11.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.11.11.4.1">92.6</span></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.11.11.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.11.11.5.1">82.8</span></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.11.11.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.11.11.6.1">66.6</span></span></span>
<span class="ltx_tr" id="S4.T3.1.1.12.12">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.12.12.1">PMC-llama 13B <cite class="ltx_cite ltx_citemacro_citep">(Wu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib98" title="">2024</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.2">52.5</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.3">42.6</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.4">48.3</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.5">56.0</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.6">65.2</span></span>
<span class="ltx_tr" id="S4.T3.1.1.13.13">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.13.13.1">Llama2 70B <cite class="ltx_cite ltx_citemacro_citep">(Touvron etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib89" title="">2023b</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.2">54.5</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.3">50.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.4">73.9</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.5">44.9</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.6">43.1</span></span>
<span class="ltx_tr" id="S4.T3.1.1.14.14">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.14.14.1">Mixtral 8*7B <cite class="ltx_cite ltx_citemacro_citep">(Jiang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib36" title="">2024</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.2">75.8</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.3">67.6</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.4">87.5</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.5">60.0</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.6">56.4</span></span>
<span class="ltx_tr" id="S4.T3.1.1.15.15">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.15.15.1">Meditron 70B <cite class="ltx_cite ltx_citemacro_citep">(Chen etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib10" title="">2023b</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.2">65.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.3">56.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.4">76.8</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.5">49.5</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.6">52.6</span></span>
<span class="ltx_tr" id="S4.T3.1.1.16.16">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.16.16.1">Llama3-ChatQA-1.5 8B <cite class="ltx_cite ltx_citemacro_citep">(Liu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib57" title="">2024b</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.2">61.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.3">66.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.4">82.7</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.5">42.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.6">46.9</span></span>
<span class="ltx_tr" id="S4.T3.1.1.17.17">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.17.17.1">Llama3-RankRAG 8B <cite class="ltx_cite ltx_citemacro_citep">(Yu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib103" title="">2024</a>)</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.2">64.5</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.3">65.0</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.4">84.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.5">48.8</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.6">56.9</span></span>
<span class="ltx_tr" id="S4.T3.1.1.18.18">
<span class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.18.18.1">GPT-3.5-turbo-1106 RAG (ours)</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.18.18.2">69.7</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.18.18.3">69.2</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.18.18.4">89.5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.18.18.5">59.2</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.18.18.6">52.4</span></span>
<span class="ltx_tr" id="S4.T3.1.1.19.19">
<span class="ltx_td ltx_align_left" id="S4.T3.1.1.19.19.1">GPT-4-0613 RAG (ours)</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.19.19.2">84.4</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.19.19.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.19.19.3.1">70.8</span></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.19.19.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.19.19.4.1">90.3</span></span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.19.19.5">64.5</span>
<span class="ltx_td ltx_align_center" id="S4.T3.1.1.19.19.6">57.4</span></span>
</span>
</span></p>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Studies</h3>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Compare Feedback From Different LLMs</h4>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="258" id="S4.F3.1.g1" src="x3.png" width="327"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Confusion matrix between GPT-3.5â€™s feedback and GPT-4oâ€™s feedback. Labels <math alttext="0,1," class="ltx_Math" display="inline" id="S4.F3.4.m1.3"><semantics id="S4.F3.4.m1.3b"><mrow id="S4.F3.4.m1.3.3.1"><mrow id="S4.F3.4.m1.3.3.1.1.2" xref="S4.F3.4.m1.3.3.1.1.1.cmml"><mn id="S4.F3.4.m1.1.1" xref="S4.F3.4.m1.1.1.cmml">0</mn><mo id="S4.F3.4.m1.3.3.1.1.2.1" xref="S4.F3.4.m1.3.3.1.1.1.cmml">,</mo><mn id="S4.F3.4.m1.2.2" xref="S4.F3.4.m1.2.2.cmml">1</mn></mrow><mo id="S4.F3.4.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.4.m1.3c"><list id="S4.F3.4.m1.3.3.1.1.1.cmml" xref="S4.F3.4.m1.3.3.1.1.2"><cn id="S4.F3.4.m1.1.1.cmml" type="integer" xref="S4.F3.4.m1.1.1">0</cn><cn id="S4.F3.4.m1.2.2.cmml" type="integer" xref="S4.F3.4.m1.2.2">1</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.4.m1.3d">0,1,</annotation><annotation encoding="application/x-llamapun" id="S4.F3.4.m1.3e">0 , 1 ,</annotation></semantics></math> and <math alttext="2" class="ltx_Math" display="inline" id="S4.F3.5.m2.1"><semantics id="S4.F3.5.m2.1b"><mn id="S4.F3.5.m2.1.1" xref="S4.F3.5.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.F3.5.m2.1c"><cn id="S4.F3.5.m2.1.1.cmml" type="integer" xref="S4.F3.5.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.m2.1d">2</annotation><annotation encoding="application/x-llamapun" id="S4.F3.5.m2.1e">2</annotation></semantics></math> are corresponding to <span class="ltx_text ltx_font_italic" id="S4.F3.9.1">Not Relevant</span>, <span class="ltx_text ltx_font_italic" id="S4.F3.10.2">Moderately Relevant</span>, and <span class="ltx_text ltx_font_italic" id="S4.F3.11.3">Highly Relevant</span> respectively.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">In order to compare the feedback collected from different LLMs, we calculate the confusion matrix between them on a subset of our dataset. We use the same prompt to collect feedback from GPT-3.5 and GPT-4o. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.F3" title="Figure 3 â€£ 4.3.1 Compare Feedback From Different LLMs â€£ 4.3 Ablation Studies â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">3</span></a> shows the confusion matrix of the two modelsâ€™ feedback. In total, the percentage of agreement is <math alttext="61.3\%" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.1.m1.1"><semantics id="S4.SS3.SSS1.p1.1.m1.1a"><mrow id="S4.SS3.SSS1.p1.1.m1.1.1" xref="S4.SS3.SSS1.p1.1.m1.1.1.cmml"><mn id="S4.SS3.SSS1.p1.1.m1.1.1.2" xref="S4.SS3.SSS1.p1.1.m1.1.1.2.cmml">61.3</mn><mo id="S4.SS3.SSS1.p1.1.m1.1.1.1" xref="S4.SS3.SSS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.1.m1.1b"><apply id="S4.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p1.1.m1.1.1.1">percent</csymbol><cn id="S4.SS3.SSS1.p1.1.m1.1.1.2.cmml" type="float" xref="S4.SS3.SSS1.p1.1.m1.1.1.2">61.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.1.m1.1c">61.3\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.1.m1.1d">61.3 %</annotation></semantics></math>, presenting a huge gap between these two models. We sampled 50 queries along with their corresponding documents to evaluate the quality of feedback from these two models. The qualitative results indicate that the feedback from GPT-4o is better and more consistent than that from GPT-3.5. Therefore, we use GPT-4o to label data for our experiments.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Prompts For Feedback Collection</h4>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">As we use black box LLMs to annotate data, prompts are the only way to control their quality. In our work, we try different prompting techniques including in-context learning and the design by <cite class="ltx_cite ltx_citemacro_citet">Thomas etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib86" title="">2024</a>)</cite>. Specifically, for in-context learning, we provide ten <math alttext="\langle query,\,document\rangle" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.1.m1.2"><semantics id="S4.SS3.SSS2.p1.1.m1.2a"><mrow id="S4.SS3.SSS2.p1.1.m1.2.2.2" xref="S4.SS3.SSS2.p1.1.m1.2.2.3.cmml"><mo id="S4.SS3.SSS2.p1.1.m1.2.2.2.3" stretchy="false" xref="S4.SS3.SSS2.p1.1.m1.2.2.3.cmml">âŸ¨</mo><mrow id="S4.SS3.SSS2.p1.1.m1.1.1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.2.cmml">q</mi><mo id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.3.cmml">u</mi><mo id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1a" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.4" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.4.cmml">e</mi><mo id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1b" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.5" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.5.cmml">r</mi><mo id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1c" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.6" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.6.cmml">y</mi></mrow><mo id="S4.SS3.SSS2.p1.1.m1.2.2.2.4" rspace="0.337em" xref="S4.SS3.SSS2.p1.1.m1.2.2.3.cmml">,</mo><mrow id="S4.SS3.SSS2.p1.1.m1.2.2.2.2" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.2" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.2.cmml">d</mi><mo id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.3" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.3.cmml">o</mi><mo id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1a" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.4" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.4.cmml">c</mi><mo id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1b" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.5" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.5.cmml">u</mi><mo id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1c" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.6" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.6.cmml">m</mi><mo id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1d" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.7" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.7.cmml">e</mi><mo id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1e" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.8" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.8.cmml">n</mi><mo id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1f" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1.cmml">â¢</mo><mi id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.9" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.9.cmml">t</mi></mrow><mo id="S4.SS3.SSS2.p1.1.m1.2.2.2.5" stretchy="false" xref="S4.SS3.SSS2.p1.1.m1.2.2.3.cmml">âŸ©</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.1.m1.2b"><list id="S4.SS3.SSS2.p1.1.m1.2.2.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2"><apply id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1"><times id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.1"></times><ci id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.2">ğ‘</ci><ci id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.3">ğ‘¢</ci><ci id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.4.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.4">ğ‘’</ci><ci id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.5.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.5">ğ‘Ÿ</ci><ci id="S4.SS3.SSS2.p1.1.m1.1.1.1.1.6.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.1.6">ğ‘¦</ci></apply><apply id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2"><times id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.1"></times><ci id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.2">ğ‘‘</ci><ci id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.3">ğ‘œ</ci><ci id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.4.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.4">ğ‘</ci><ci id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.5.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.5">ğ‘¢</ci><ci id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.6.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.6">ğ‘š</ci><ci id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.7.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.7">ğ‘’</ci><ci id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.8.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.8">ğ‘›</ci><ci id="S4.SS3.SSS2.p1.1.m1.2.2.2.2.9.cmml" xref="S4.SS3.SSS2.p1.1.m1.2.2.2.2.9">ğ‘¡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.1.m1.2c">\langle query,\,document\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.1.m1.2d">âŸ¨ italic_q italic_u italic_e italic_r italic_y , italic_d italic_o italic_c italic_u italic_m italic_e italic_n italic_t âŸ©</annotation></semantics></math> pairs to teach LLMs how to rate. For the other method, instead of providing examples, we split the task into sub-tasks that can be easier to answer and we ask the model to answer these questions before rating the relevance between a query and a document. Inspired by <cite class="ltx_cite ltx_citemacro_citet">Wei etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib97" title="">2022</a>)</cite>, we call this method <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS2.p1.1.1">â€think step-by-stepâ€</span>. The details of these two prompts are shown in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#A2" title="Appendix B Prompt Formats â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p2">
<p class="ltx_p" id="S4.SS3.SSS2.p2.1">We qualitatively assess the annotations of GPT-4o using different prompts. We sampled 50 queries to evaluate how many responses from GPT-4o were incorrect compared to the ground truth answers. For the in-context learning, the accuracy is 0.7. We found that the most common types of errors are hallucinations and implications, particularly when the passage mentions the ground truth answer but in a context that is different from the query. For the <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS2.p2.1.1">â€think step-by-stepâ€</span> prompt, the accuracy is 0.83. This is because LLMs answer a series of questions before making a final decision, which results in more consistent and robust annotations.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>Case Study</h4>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>A case study on the positive document picked by the reward model compare to human annotations</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T4.1.1.1.1">Query</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.1.2">who said i â€™m late i â€™m late for a very important date</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T4.1.2.1.1">Human labeled</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.1.2.1.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.1.2.1.2.1">
<tr class="ltx_tr" id="S4.T4.1.2.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.2.1.2.1.1.1">White Rabbit The White Rabbit is a fictional character in Lewis Carrollâ€™s book â€â€Aliceâ€™s Adventures in Wonderlandâ€â€.</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.2.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.2.1.2.1.2.1">He appears at the very beginning of the book, in chapter one, wearing a waistcoat, and muttering â€â€Oh dear! Oh dear!</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.2.1.2.1.3">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.2.1.2.1.3.1">I shall be too late!â€â€ Alice follows him down the rabbit hole into Wonderland. Alice encounters him again when he</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.2.1.2.1.4">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.2.1.2.1.4.1">mistakes her for his housemaid Mary Ann and she becomes trapped in his house after growing too large. The Rabbit</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.2.1.2.1.5">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.2.1.2.1.5.1">shows up again in the last few chapters, as a herald-like servant of the King and Queen of Hearts. In his article</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.2.1.2.1.6">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.2.1.2.1.6.1"><span class="ltx_text" id="S4.T4.1.2.1.2.1.6.1.1" style="color:#FF0000;">Note: Incorrect label (the passage does not related to the query)</span></td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" id="S4.T4.1.3.2.1">Reward model</th>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="S4.T4.1.3.2.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.1.3.2.2.1">
<tr class="ltx_tr" id="S4.T4.1.3.2.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.3.2.2.1.1.1">the â€â€monsterâ€â€ (Alice) out of his house, Dodoâ€™s ultimate solution is to burn the house down, to which the White</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.2.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.3.2.2.1.2.1">Rabbit is greatly opposed. At the Mad Tea Party, the Mad Hatter and the March Hare try to â€â€fixâ€â€ his watch, proclaiming</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.2.2.1.3">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.3.2.2.1.3.1">it â€â€exactly two days slowâ€â€. Through various food they put in the watch (butter, tea, jam, and lemon), the two cause</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.2.2.1.4">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.3.2.2.1.4.1">it to go mad, and the Hare smashes it with his mallet. The Rabbit was perhaps most famous for the little ditty he sang</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.2.2.1.5">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.3.2.2.1.5.1">at the beginning, â€â€<span class="ltx_text" id="S4.T4.1.3.2.2.1.5.1.1" style="color:#00FF00;">Iâ€™m late! Iâ€™m late! For a very important date!</span> No</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.2.2.1.6">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T4.1.3.2.2.1.6.1"><span class="ltx_text" id="S4.T4.1.3.2.2.1.6.1.1" style="color:#00FF00;">Note: Correct label</span></td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>A case study on the top-retrieved context and predictions on NQ dataset. We use the example query from RankRAG<cite class="ltx_cite ltx_citemacro_citep">(Yu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#bib.bib103" title="">2024</a>)</cite> to compare their models with ours. <span class="ltx_text" id="S4.T5.3.1" style="color:#FF0000;">Red</span> text denotes distractors, while <span class="ltx_text" id="S4.T5.4.2" style="color:#00FF00;">green</span> stands for evidences. </figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T5.5" style="width:433.6pt;height:336.8pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-121.2pt,94.0pt) scale(0.641396332083255,0.641396332083255) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.5.1.1.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T5.5.1.1.1.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_text ltx_font_bold" id="S4.T5.5.1.1.1.1.1">Q</span>: who hosted and won the inagural world cup? <span class="ltx_text ltx_font_bold" id="S4.T5.5.1.1.1.1.2">A</span>: Uruguay</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.5.1.2.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T5.5.1.2.1.1" rowspan="5" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.2.1.1.1">
<span class="ltx_p" id="S4.T5.5.1.2.1.1.1.1" style="width:51.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.2.1.1.1.1.1">ChatQA-1.5</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T5.5.1.2.1.2" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.2.1.2.1">
<span class="ltx_p" id="S4.T5.5.1.2.1.2.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.2.1.2.1.1.1">Passage 1</span>: FIFA World Cup second round on home soil in 1982. <span class="ltx_text" id="S4.T5.5.1.2.1.2.1.1.2" style="color:#FF0000;">England</span> (1966) won its only title while playing as a host nation. <span class="ltx_text" id="S4.T5.5.1.2.1.2.1.1.3" style="color:#00FF00;">Uruguay (1930)</span>, Italy (1934), Argentina (1978) and France (1998) won their first titles as host nations but have gone on to win again, while <span class="ltx_text" id="S4.T5.5.1.2.1.2.1.1.4" style="color:#FF0000;">Germany (1974) won their second title on home soil</span>â€¦</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.3.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.3.2.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.3.2.1.1">
<span class="ltx_p" id="S4.T5.5.1.3.2.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.3.2.1.1.1.1">Passage 2</span>: FIFA World Cup hosts country is now chosen in a vote by FIFAâ€™s Congress â€¦ Only Mexico, Italy, France, <span class="ltx_text" id="S4.T5.5.1.3.2.1.1.1.2" style="color:#FF0000;">Germany</span> (West Germany) until shortly after the 1990 World Cup) and Brazil have hosted the event on two occasions.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.4.3">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.4.3.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.4.3.1.1">
<span class="ltx_p" id="S4.T5.5.1.4.3.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.4.3.1.1.1.1">Passage 3</span>: CONCACAF hosts, beating the bids of Canada and the United States, and thereby became the first nation to host two World Cups. This second World Cup in <span class="ltx_text" id="S4.T5.5.1.4.3.1.1.1.2" style="color:#FF0000;">Mexico</span> came 16 years after the first one in 1970â€¦</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.5.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.5.4.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.5.4.1.1">
<span class="ltx_p" id="S4.T5.5.1.5.4.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.5.4.1.1.1.1">Passage 4</span>: 1998 FIFA World Cup Africa made their first appearances in the finals. <span class="ltx_text" id="S4.T5.5.1.5.4.1.1.1.2" style="color:#FF0000;">France</span> was awarded the 1998 World Cup on 2 July 1992 by the executive committee of FIFA during a general meeting in ZÃ¼rich, Switzerland. They defeated Morocco by 12 votes to 7.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.6.5">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.6.5.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.6.5.1.1">
<span class="ltx_p" id="S4.T5.5.1.6.5.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.6.5.1.1.1.1">Passage 5</span>: 2026 FIFA World Cup be hosted by one of the remaining four confederations: CONCACAF (North America; last hosted in 1994), CAF (Africa; last hosted in 2010), CONMEBOL (South America; last hosted in 2014), or OFC (Oceania, never hosted before)â€¦  <span class="ltx_text ltx_font_bold" id="S4.T5.5.1.6.5.1.1.1.2" style="background-color:#FFD9D9;">Prediction<span class="ltx_text ltx_font_medium" id="S4.T5.5.1.6.5.1.1.1.2.1">: <em class="ltx_emph ltx_font_italic" id="S4.T5.5.1.6.5.1.1.1.2.1.1">Germany</em> (âœ˜)</span></span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.7.6">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T5.5.1.7.6.1" rowspan="5" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.7.6.1.1">
<span class="ltx_p" id="S4.T5.5.1.7.6.1.1.1" style="width:51.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.7.6.1.1.1.1">RankRAG</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T5.5.1.7.6.2" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.7.6.2.1">
<span class="ltx_p" id="S4.T5.5.1.7.6.2.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.7.6.2.1.1.1">Passage 1</span>: FIFA World Cup second round on home soil in 1982. England (1966) won its only title while playing as a host nation. <span class="ltx_text" id="S4.T5.5.1.7.6.2.1.1.2" style="color:#00FF00;">Uruguay (1930)</span>, Italy (1934), Argentina (1978) and France (1998) won their first titles as host nations but have gone on to win again, while <span class="ltx_text" id="S4.T5.5.1.7.6.2.1.1.3" style="color:#FF0000;">Germany (1974) won their second title on home soil</span>â€¦</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.8.7">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.8.7.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.8.7.1.1">
<span class="ltx_p" id="S4.T5.5.1.8.7.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.8.7.1.1.1.1">Passage 2</span>: Timeline of association football penalty kicks. Thirteen teams enter <span class="ltx_text" id="S4.T5.5.1.8.7.1.1.1.2" style="color:#00FF00;">the first World Cup, held in Uruguay. The hosts beat Argentina 4â€“2 in the final.</span> Contested between the top national teams of continental Europe, Dr. GerÃ¶ Cupâ€™ first edition is won by Italy.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.9.8">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.9.8.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.9.8.1.1">
<span class="ltx_p" id="S4.T5.5.1.9.8.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.9.8.1.1.1.1">Passage 3</span>: The Uruguay national football team represents Uruguay in international association football and is controlled by the Uruguayan Football Association. They have won the Copa AmÃ©rica 15 times, the most successful national team in the tournament, the most recent title being the 2011 edition. <span class="ltx_text" id="S4.T5.5.1.9.8.1.1.1.2" style="color:#00FF00;">The team has won the FIFA World Cup twice, including the first World Cup in 1930 as hosts</span>, defeating Argentina 4â€“2 in the final.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.10.9">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.10.9.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.10.9.1.1">
<span class="ltx_p" id="S4.T5.5.1.10.9.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.10.9.1.1.1.1">Passage 4</span>: FIFA World Cup hosts country is now chosen in a vote by FIFAâ€™s Congress. The decision is currently made roughly seven years in advance of the tournament, though the hosts for the 2022 tournament were chosen at the same time as those for the 2018 tournament.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.11.10">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.11.10.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.11.10.1.1">
<span class="ltx_p" id="S4.T5.5.1.11.10.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.11.10.1.1.1.1">Passage 5</span>: CONCACAF hosts, beating the bids of Canada and the United States, and thereby became the first nation to host two World Cups. This second World Cup in <span class="ltx_text" id="S4.T5.5.1.11.10.1.1.1.2" style="color:#FF0000;">Mexico</span> came 16 years after the first one in 1970â€¦  <span class="ltx_text ltx_font_bold" id="S4.T5.5.1.11.10.1.1.1.3" style="background-color:#D9FFD9;">Prediction<span class="ltx_text ltx_font_medium" id="S4.T5.5.1.11.10.1.1.1.3.1">: <em class="ltx_emph ltx_font_italic" id="S4.T5.5.1.11.10.1.1.1.3.1.1">Uruguay</em> (âœ“)</span></span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.12.11">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T5.5.1.12.11.1" rowspan="13" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.12.11.1.1">
<span class="ltx_p" id="S4.T5.5.1.12.11.1.1.1" style="width:51.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.12.11.1.1.1.1">Reward-RAG</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T5.5.1.12.11.2" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.12.11.2.1">
<span class="ltx_p" id="S4.T5.5.1.12.11.2.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.12.11.2.1.1.1">Passage 1</span>: The first two World Cup matches took place simultaneously on 13 July 1930, and were won by France and the USA, who defeated Mexico 4â€“1 and Belgium 3â€“0 respectively. The first goal in World Cup history was scored by Lucien Laurent of France. <span class="ltx_text" id="S4.T5.5.1.12.11.2.1.1.2" style="color:#00FF00;">In the final, Uruguay defeated Argentina 4â€“2 in front of 93,000 people in Montevideo, and became the first nation to win the World Cup</span>. After the creation of the World Cup,</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.13.12">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.13.12.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.13.12.1.1">
<span class="ltx_p" id="S4.T5.5.1.13.12.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.13.12.1.1.1.1">Passage 2</span>: 1950 FIFA World Cup The 1950 FIFA World Cup, held in Brazil from 24 June to 16 July 1950, was the fourth FIFA World Cup. It was the first World Cup since 1938, the planned 1942 and 1946 competitions having been cancelled due to World War II. It was won by <span class="ltx_text" id="S4.T5.5.1.13.12.1.1.1.2" style="color:#00FF00;">Uruguay, who had won the inaugural competition in 1930</span>â€¦</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.14.13">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.14.13.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.14.13.1.1">
<span class="ltx_p" id="S4.T5.5.1.14.13.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.14.13.1.1.1.1">Passage 3</span>: but the choice of Uruguay as a venue for the competition meant a long and costly trip across the Atlantic Ocean for European sides. No European country pledged to send a team until two months before the start of the competition.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.15.14">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T5.5.1.15.14.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.15.14.1.1">
<span class="ltx_p" id="S4.T5.5.1.15.14.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.15.14.1.1.1.1">Passage 4</span>: The 1978 FIFA World Cup, the 11th staging of the FIFA World Cup, quadrennial international football world championship tournament, was held in Argentina between 1 and 25 June. <span class="ltx_text" id="S4.T5.5.1.15.14.1.1.1.2" style="color:#FF0000;">The Cup was won by the Argentine hosts</span>, who defeated the Netherlands 3â€“1 in the finalâ€¦</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.5.1.16.15">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S4.T5.5.1.16.15.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T5.5.1.16.15.1.1">
<span class="ltx_p" id="S4.T5.5.1.16.15.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.5.1.16.15.1.1.1.1">Passage 5</span>: <span class="ltx_text" id="S4.T5.5.1.16.15.1.1.1.2" style="color:#00FF00;">the first World Cup coincided with the centennial anniversary of the first Constitution of Uruguay</span>. For that reason, the main stadium built in Montevideo for the World Cup was named Estadio Centenario.  <span class="ltx_text ltx_font_bold" id="S4.T5.5.1.16.15.1.1.1.3" style="background-color:#D9FFD9;">Prediction<span class="ltx_text ltx_font_medium" id="S4.T5.5.1.16.15.1.1.1.3.1">: <em class="ltx_emph ltx_font_italic" id="S4.T5.5.1.16.15.1.1.1.3.1.1">Uruguay</em> (âœ“)</span></span></span>
</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>A case study on the medical domain. We select sample questions from different datasets, demonstrate the retrieved documents with LLMâ€™s answer of our method. <span class="ltx_text" id="S4.T6.2.1" style="color:#00FF00;">Green</span> stands for evidences.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T6.3" style="width:433.6pt;height:427.2pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-121.2pt,119.3pt) scale(0.641396332083255,0.641396332083255) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T6.3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.3.1.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="S4.T6.3.1.1.1.1" rowspan="4" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.1.1.1.1">
<span class="ltx_p" id="S4.T6.3.1.1.1.1.1.1" style="width:51.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.1.1.1.1.1.1">MedMCQA</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="S4.T6.3.1.1.1.2" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.1.1.2.1">
<span class="ltx_p" id="S4.T6.3.1.1.1.2.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.1.1.2.1.1.1">Query</span>: The clot formed is not stable unless extensive cross-linking occurs. This extensive cross-linking of blood clot is done by:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.2.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T6.3.1.2.2.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.2.2.1.1">
<span class="ltx_p" id="S4.T6.3.1.2.2.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.2.2.1.1.1.1">Choices</span>: A: â€Plasminâ€, B: â€Thrombinâ€, C: â€HMWKâ€, D: â€Factor XIIIâ€</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.3.3">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T6.3.1.3.3.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.3.3.1.1">
<span class="ltx_p" id="S4.T6.3.1.3.3.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.3.3.1.1.1.1">Documents</span>: <span class="ltx_text" id="S4.T6.3.1.3.3.1.1.1.2" style="color:#00FF00;">Covalent cross-linking of fibrin chains is required for stable blood clot formation, which is catalyzed by coagulation factor XIII (FXIII)</span>, a proenzyme of plasma transglutaminase consisting of catalytic A (FXIII-A) and non-catalytic B subunits (FXIII-B). Herein, we demonstrate that FXIII-B accelerates fibrin cross-linking. Depletion of FXIII-B from normal plasma supplemented with a physiological level of recombinant FXIII-A resulted in delayed fibrin cross-linking, reduced incorporation of FXIII-A into fibrin clots, and impaired activation peptide cleavage by thrombin; the addition of recombinant FXIII-B restored normal fibrin cross-linking, FXIII-A incorporation into fibrin clots, and activation peptide cleavage by thrombin. Immunoprecipitation with an anti-fibrinogen antibody revealed an interaction between the FXIII heterotetramer and fibrinogen mediated by FXIII-B and not FXIII-A.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.4.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T6.3.1.4.4.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.4.4.1.1">
<span class="ltx_p" id="S4.T6.3.1.4.4.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.4.4.1.1.1.1">LLMsâ€™ output</span>: Document 2 mentions that covalent cross-linking of fibrin chains is required for stable blood clot formation and that factor XIII (FXIII) mediates clot stability by covalent cross-linking of fibrin-fibrils and inhibition of fibrinolysis. Therefore, the extensive cross-linking of blood clot is done by Factor XIII (B).  <span class="ltx_text ltx_font_bold" id="S4.T6.3.1.4.4.1.1.1.2" style="background-color:#D9FFD9;">Prediction<span class="ltx_text ltx_font_medium" id="S4.T6.3.1.4.4.1.1.1.2.1">: <em class="ltx_emph ltx_font_italic" id="S4.T6.3.1.4.4.1.1.1.2.1.1">B</em> (âœ“)</span></span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T6.3.1.5.5.1" rowspan="4" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.5.5.1.1">
<span class="ltx_p" id="S4.T6.3.1.5.5.1.1.1" style="width:51.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.5.5.1.1.1.1">BioASQ</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T6.3.1.5.5.2" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.5.5.2.1">
<span class="ltx_p" id="S4.T6.3.1.5.5.2.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.5.5.2.1.1.1">Query</span>: Is Tilavonemab effective for progressive supranuclear palsy?</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.6.6">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T6.3.1.6.6.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.6.6.1.1">
<span class="ltx_p" id="S4.T6.3.1.6.6.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.6.6.1.1.1.1">Choices</span>: A: â€yesâ€, B: â€noâ€</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.7.7">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T6.3.1.7.7.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.7.7.1.1">
<span class="ltx_p" id="S4.T6.3.1.7.7.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.7.7.1.1.1.1">Document</span>: Progressive supranuclear palsy is a neurodegenerative disorder associated with tau protein aggregation. Tilavonemab (ABBV-8E12) is a monoclonal antibody that binds to the N-terminus of human tau. <span class="ltx_text" id="S4.T6.3.1.7.7.1.1.1.2" style="color:#00FF00;">We assessed the safety and efficacy of tilavonemab for the treatment of progressive supranuclear palsy.</span> We did a phase 2, multicentre, randomised, placebo-controlled, double-blind study at 66 hospitals and clinics in Australia, Canada, France, Germany, Italy, Japan, Spain, and the USAâ€¦.Between Dec 12, 2016, and Dec 31, 2018, 466 participants were screened, 378 were randomised. The study was terminated on July 3, 2019, after prespecified futility criteria were met at the second interim analysis. A total of 377 participants received at least one dose of study drug and were included in the efficacy and safety analyses (2000 mg, n=126; 4000 mg, n=125; placebo, n=126)â€¦ A similar safety profile was seen in all treatment groups. <span class="ltx_text" id="S4.T6.3.1.7.7.1.1.1.3" style="color:#00FF00;">No beneficial treatment effects were recorded.</span> Although this study did not provide evidence of efficacy in progressive supranuclear palsy, the findings provide potentially useful information for future investigations of passive immunisation using tau antibodies for progressive supranuclear palsy.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.8.8">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T6.3.1.8.8.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.8.8.1.1">
<span class="ltx_p" id="S4.T6.3.1.8.8.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.8.8.1.1.1.1">LLMsâ€™ output</span>: Based on the provided documents, a phase 2, multicentre, randomised, placebo-controlled, double-blind study was conducted to assess the safety and efficacy of Tilavonemab for the treatment of progressive supranuclear palsy. The study involved participants diagnosed with possible or probable progressive supranuclear palsy who were symptomatic for less than 5 years. The primary endpoint was the change from baseline to week 52 in the Progressive Supranuclear Palsy Rating Scale (PSPRS) total score. The study was terminated after prespecified futility criteria were met at the second interim analysis. The findings showed that Tilavonemab did not provide evidence of efficacy in progressive supranuclear palsy.  <span class="ltx_text ltx_font_bold" id="S4.T6.3.1.8.8.1.1.1.2" style="background-color:#D9FFD9;">Prediction<span class="ltx_text ltx_font_medium" id="S4.T6.3.1.8.8.1.1.1.2.1">: <em class="ltx_emph ltx_font_italic" id="S4.T6.3.1.8.8.1.1.1.2.1.1">B</em> (âœ“)</span></span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.9.9">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S4.T6.3.1.9.9.1" rowspan="13" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.9.9.1.1">
<span class="ltx_p" id="S4.T6.3.1.9.9.1.1.1" style="width:51.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.9.9.1.1.1.1">MMLU</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T6.3.1.9.9.2" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.9.9.2.1">
<span class="ltx_p" id="S4.T6.3.1.9.9.2.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.9.9.2.1.1.1">Query</span>: When an influenza virus enters a cell, it immediately starts to do which of the following?â€</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.10.10">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T6.3.1.10.10.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.10.10.1.1">
<span class="ltx_p" id="S4.T6.3.1.10.10.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.10.10.1.1.1.1">Choices</span>: A: â€Incorporate viral DNA into the host cellâ€™s chromosomeâ€, B: â€Destroy the host cellâ€™s transcriptional machineryâ€, C: â€Replicate its genetic material and synthesize viral proteinsâ€, D: â€Use a viral copy of reverse transcriptase to manufacture viral DNAâ€</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.11.11">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T6.3.1.11.11.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.11.11.1.1">
<span class="ltx_p" id="S4.T6.3.1.11.11.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.11.11.1.1.1.1">Document 1</span>: Inhibitors of glycolysis, oxidative phosphorylation, protein synthesis, membrane Na+-K+ transport and microfilament and microtubule function have been employed to elucidate the mechanism of influenza virus uptake by CAM and CEF cells. Electron microscopy demonstrated uptake of virus by viropexis in the presence of all these inhibitors. <span class="ltx_text" id="S4.T6.3.1.11.11.1.1.1.2" style="color:#00FF00;">Utilizing a pulse labelling technique, virus entering CEF cells in the presence of inhibitors was shown to initiate specific virus polypeptide synthesis after neutralization of remaining extracellular virus and removal of the inhibitors. As a consequence of these findings an energy independent mechanism of viropexis has been proposed.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.12.12">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T6.3.1.12.12.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.12.12.1.1">
<span class="ltx_p" id="S4.T6.3.1.12.12.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.12.12.1.1.1.1">Document 2</span>: As a major pathogen of human and certain animal species, influenza virus causes wide spread and potentially devastating disease. To initiate infection, the virus first binds to cellular receptors comprising either -(2,3 ) or -(2,6) linked sialic acid. Recent advances in our understanding of the influenza virus receptor and viral host species involved have shed light on the molecular mechanism of how influenza virus transmits across species and adapts to a new host. Following receptor binding, influenza viruses are internalized through multiple endocytic pathways, including both clathrin- and non-clathrin-dependent routes, which have recently been visualized at single viral particle level. <span class="ltx_text" id="S4.T6.3.1.12.12.1.1.1.2" style="color:#00FF00;">The viral envelope then fuses with the endosomal membrane in a low pH-dependent manner and the viral genome is released into the cytosol, followed by further transport to the nucleus where genome replication occurs.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.13.13">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S4.T6.3.1.13.13.1" style="padding-top:-0.25pt;padding-bottom:-0.25pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T6.3.1.13.13.1.1">
<span class="ltx_p" id="S4.T6.3.1.13.13.1.1.1" style="width:597.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.13.13.1.1.1.1">LLMsâ€™ output</span>: Based on the provided documents, when an influenza virus enters a cell, it immediately starts to replicate its genetic material and synthesize viral proteins. Document 1 mentions that virus entering cells initiates specific virus polypeptide synthesis after neutralization of remaining extracellular virus and removal of inhibitors. Document 2 also supports this by explaining that following receptor binding, influenza viruses are internalized and the viral genome is released into the cytosol, followed by further transport to the nucleus where genome replication occurs..  <span class="ltx_text ltx_font_bold" id="S4.T6.3.1.13.13.1.1.1.2" style="background-color:#D9FFD9;">Prediction<span class="ltx_text ltx_font_medium" id="S4.T6.3.1.13.13.1.1.1.2.1">: <em class="ltx_emph ltx_font_italic" id="S4.T6.3.1.13.13.1.1.1.2.1.1">C</em> (âœ“)</span></span></span>
</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS3.p1">
<p class="ltx_p" id="S4.SS3.SSS3.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#S4.T4" title="Table 4 â€£ 4.3.3 Case Study â€£ 4.3 Ablation Studies â€£ 4 Experiments â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">4</span></a> we present a case study from the NQ dataset where the human annotation for positive documents is incorrect, while the annotation by our reward model is accurate. For this query, the correct answer (The White Rabbit) is mentioned in both passages but in the document labeled by human, it is not related to the query, on the other hand, the passage labeled by reward model answers the query with a clear evidence. More samples are provided in the appendix.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In conclusion, our study highlights the transformative potential of integrating synthetic data with a dedicated reward model in enhancing the performance of Retrieval-Augmented Generation (RAG) systems. By utilizing CriticGPT to generate tailored datasets, we enable general-domains and specific-domains fine-tuning that aligns model outputs more closely with human preferences. This synergy not only improves the relevance and quality of generated responses but also demonstrates advancements over existing state-of-the-art methods. The promising results from our evaluations across various domains affirm that the combination of synthetic data and reward-driven supervision can elevate the capabilities of RAG, paving the way for more effective natural language generation applications.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anil etÂ al. (2023)</span>
<span class="ltx_bibblock">
Rohan Anil, AndrewÂ M. Dai, Orhan Firat, Melvin Johnson, Dmitry Lepikhin, Alexandre Passos, Siamak Shakeri, Emanuel Taropa, Paige Bailey, and etÂ al. ZhifengÂ Chen.

</span>
<span class="ltx_bibblock">Palm 2 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2305.10403</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Asai etÂ al. (2024)</span>
<span class="ltx_bibblock">
Akari Asai, Zeqiu Wu, Yizhong Wang, Avirup Sil, and Hannaneh Hajishirzi.

</span>
<span class="ltx_bibblock">Self-RAG: Learning to retrieve, generate, and critique through self-reflection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International Conference on Learning Representations (ICLR)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai etÂ al. (2022)</span>
<span class="ltx_bibblock">
Yuntao Bai, Saurav Kadavath, Sandipan Kundu, Amanda Askell, Jackson Kernion, Andy Jones, Anna Chen, Anna Goldie, Azalia Mirhoseini, Cameron McKinnon, Carol Chen, Catherine Olsson, Christopher Olah, Danny Hernandez, Dawn Drain, Deep Ganguli, Dustin Li, Eli Tran-Johnson, Ethan Perez, Jamie Kerr, Jared Mueller, Jeffrey Ladish, Joshua Landau, Kamal Ndousse, Kamile Lukosuite, Liane Lovitt, Michael Sellitto, Nelson Elhage, Nicholas Schiefer, Noemi Mercado, Nova DasSarma, Robert Lasenby, Robin Larson, Sam Ringer, Scott Johnston, Shauna Kravec, SheerÂ El Showk, Stanislav Fort, Tamera Lanham, Timothy Telleen-Lawton, Tom Conerly, Tom Henighan, Tristan Hume, SamuelÂ R. Bowman, Zac Hatfield-Dodds, Ben Mann, Dario Amodei, Nicholas Joseph, Sam McCandlish, Tom Brown, and Jared Kaplan.

</span>
<span class="ltx_bibblock">Constitutional ai: Harmlessness from ai feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2212.08073</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berger etÂ al. (2000)</span>
<span class="ltx_bibblock">
Adam Berger, Rich Caruana, David Cohn, Dayne Freitag, and Vibhu Mittal.

</span>
<span class="ltx_bibblock">Bridging the lexical chasm: statistical approaches to answer-finding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 23rd Annual International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pp.Â  192â€“199, 2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman etÂ al. (2023)</span>
<span class="ltx_bibblock">
Stella Biderman, Hailey Schoelkopf, QuentinÂ Gregory Anthony, Herbie Bradley, Kyle Oâ€™Brien, Eric Hallahan, MohammadÂ Aflah Khan, Shivanshu Purohit, USVSNÂ Sai Prashanth, Edward Raff, etÂ al.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">International Conference on Machine Learning</em>, pp.Â  2397â€“2430, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borgeaud etÂ al. (2022)</span>
<span class="ltx_bibblock">
Sebastian Borgeaud, Arthur Mensch, Jordan Hoffmann, Trevor Cai, Eliza Rutherford, Katie Millican, GeorgeÂ Bm Van DenÂ Driessche, Jean-Baptiste Lespiau, Bogdan Damoc, Aidan Clark, Diego DeÂ LasÂ Casas, Aurelia Guy, Jacob Menick, Roman Ring, Tom Hennigan, Saffron Huang, Loren Maggiore, Chris Jones, Albin Cassirer, Andy Brock, Michela Paganini, Geoffrey Irving, Oriol Vinyals, Simon Osindero, Karen Simonyan, Jack Rae, Erich Elsen, and Laurent Sifre.

</span>
<span class="ltx_bibblock">Improving language models by retrieving from trillions of tokens.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">International Conference on Machine Learning</em>, pp.Â  2206â€“2240, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown etÂ al. (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, JaredÂ D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel Ziegler, Jeffrey Wu, Clemens Winter, Chris Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Advances in Neural Information Processing Systems</em>, volumeÂ 33, pp.Â  1877â€“1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al. (2020)</span>
<span class="ltx_bibblock">
Dongmei Chen, Sheng Zhang, Xin Zhang, and Kaijing Yang.

</span>
<span class="ltx_bibblock">Cross-lingual passage re-ranking with alignment augmented multilingual BERT.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">IEEE Access</em>, 8:213232â€“213243, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al. (2023a)</span>
<span class="ltx_bibblock">
Tong Chen, Hongwei Wang, Sihao Chen, Wenhao Yu, Kaixin Ma, Xinran Zhao, Hongming Zhang, and Dong Yu.

</span>
<span class="ltx_bibblock">Dense x retrieval: What retrieval granularity should we use?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2312.06648</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al. (2023b)</span>
<span class="ltx_bibblock">
Zeming Chen, AlejandroÂ HernÃ¡ndez Cano, Angelika Romanou, Antoine Bonnet, Kyle Matoba, Francesco Salvi, Matteo Pagliardini, Simin Fan, Andreas KÃ¶pf, Amirkeivan Mohtashami, Alexandre Sallinen, Alireza Sakhaeirad, Vinitra Swamy, Igor Krawczuk, Deniz Bayazit, Axel Marmet, Syrielle Montariol, Mary-Anne Hartley, Martin Jaggi, and Antoine Bosselut.

</span>
<span class="ltx_bibblock">Meditron-70b: Scaling medical pretraining for large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2311.16079</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai etÂ al. (2023)</span>
<span class="ltx_bibblock">
Zhuyun Dai, VincentÂ Y. Zhao, JiÂ Ma, YiÂ Luan, Jianmo Ni, Jing Lu, Anton Bakalov, Kelvin Guu, KeithÂ B. Hall, and Ming-Wei Chang.

</span>
<span class="ltx_bibblock">Promptagator: Few-shot dense retrieval from 8 examples.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">International Conference on Learning Representations (ICLR)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">deÂ Souza P.Â Moreira etÂ al. (2024)</span>
<span class="ltx_bibblock">
Gabriel deÂ Souza P.Â Moreira, Radek Osmulski, Mengyao Xu, Ronay Ak, Benedikt Schifferer, and Even Oldridge.

</span>
<span class="ltx_bibblock">Nv-retriever: Improving text embedding models with effective hard-negative mining.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2407.15831</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers etÂ al. (2023)</span>
<span class="ltx_bibblock">
Tim Dettmers, Artidoro Pagnoni, Ari Holtzman, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Qlora: Efficient finetuning of quantized llms.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Advances in Neural Information Processing Systems</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin etÂ al. (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">BERT: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers)</em>, pp.Â  4171â€“4186, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding etÂ al. (2024)</span>
<span class="ltx_bibblock">
Yiran Ding, LiÂ Lyna Zhang, Chengruidong Zhang, Yuanyuan Xu, Ning Shang, Jiahang Xu, Fan Yang, and Mao Yang.

</span>
<span class="ltx_bibblock">Longrope: Extending llm context window beyond 2 million tokens.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2402.13753</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edalati etÂ al. (2022)</span>
<span class="ltx_bibblock">
Ali Edalati, Marzieh Tahaei, Ivan Kobyzev, VahidÂ Partovi Nia, JamesÂ J. Clark, and Mehdi Rezagholizadeh.

</span>
<span class="ltx_bibblock">Krona: Parameter efficient tuning with kronecker adapter.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2212.10650</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Formal etÂ al. (2022)</span>
<span class="ltx_bibblock">
Thibault Formal, Carlos Lassance, Benjamin Piwowarski, and StÃ©phane Clinchant.

</span>
<span class="ltx_bibblock">From distillation to hard negative sampling: Making sparse neural ir models more effective.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pp.Â  2353â€“2359, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu etÂ al. (2021)</span>
<span class="ltx_bibblock">
Cheng Fu, Hanxian Huang, Xinyun Chen, Yuandong Tian, and Jishen Zhao.

</span>
<span class="ltx_bibblock">Learn-to-share: A hardware-friendly transfer learning framework exploiting computation and parameter sharing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 38th International Conference on Machine Learning</em>, volume 139, pp.Â  3469â€“3479, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao etÂ al. (2024)</span>
<span class="ltx_bibblock">
Yunfan Gao, Yun Xiong, Xinyu Gao, Kangxiang Jia, Jinliu Pan, Yuxi Bi, YiÂ Dai, Jiawei Sun, Meng Wang, and Haofen Wang.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for large language models: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2312.10997</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">GeminiÂ Team (2023)</span>
<span class="ltx_bibblock">
Google GeminiÂ Team.

</span>
<span class="ltx_bibblock">Gemini: A family of highly capable multimodal models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2312.11805</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Glass etÂ al. (2022)</span>
<span class="ltx_bibblock">
Michael Glass, Gaetano Rossiello, MdÂ FaisalÂ Mahbub Chowdhury, Ankita Naik, Pengshan Cai, and Alfio Gliozzo.

</span>
<span class="ltx_bibblock">Re2G: Retrieve, rerank, generate.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 2022 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em>, pp.Â  2701â€“2715, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">GutiÃ©rrez etÂ al. (2024)</span>
<span class="ltx_bibblock">
BernalÂ JimÃ©nez GutiÃ©rrez, Yiheng Shu, YuÂ Gu, Michihiro Yasunaga, and YuÂ Su.

</span>
<span class="ltx_bibblock">Hipporag: Neurobiologically inspired long-term memory for large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2405.14831</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guu etÂ al. (2020)</span>
<span class="ltx_bibblock">
Kelvin Guu, Kenton Lee, Zora Tung, Panupong Pasupat, and Ming-Wei Chang.

</span>
<span class="ltx_bibblock">Realm: retrieval-augmented language model pre-training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">International Conference on Machine Learning</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hackl etÂ al. (2023)</span>
<span class="ltx_bibblock">
Veronika Hackl, AlexandraÂ Elena MÃ¼ller, Michael Granitzer, and Maximilian Sailer.

</span>
<span class="ltx_bibblock">Is gpt-4 a reliable rater? evaluating consistency in gpt-4â€™s text ratings.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Frontiers in Education</em>, 8, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He etÂ al. (2022)</span>
<span class="ltx_bibblock">
Junxian He, Chunting Zhou, Xuezhe Ma, Taylor Berg-Kirkpatrick, and Graham Neubig.

</span>
<span class="ltx_bibblock">Towards a unified view of parameter-efficient transfer learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">International Conference on Learning Representations (ICLR)</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks etÂ al. (2021)</span>
<span class="ltx_bibblock">
Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Measuring massive multitask language understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Houlsby etÂ al. (2019a)</span>
<span class="ltx_bibblock">
Neil Houlsby, Andrei Giurgiu, Stanislaw Jastrzebski, Bruna Morrone, Quentin DeÂ Laroussilhe, Andrea Gesmundo, Mona Attariyan, and Sylvain Gelly.

</span>
<span class="ltx_bibblock">Parameter-efficient transfer learning for NLP.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">International Conference on Machine Learning</em>, volumeÂ 97, pp.Â  2790â€“2799, 2019a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Houlsby etÂ al. (2019b)</span>
<span class="ltx_bibblock">
Neil Houlsby, Andrei Giurgiu, Stanislaw Jastrzebski, Bruna Morrone, Quentin DeÂ Laroussilhe, Andrea Gesmundo, Mona Attariyan, and Sylvain Gelly.

</span>
<span class="ltx_bibblock">Parameter-efficient transfer learning for NLP.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">International Conference on Machine Learning</em>, volumeÂ 97, pp.Â  2790â€“2799, 2019b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu etÂ al. (2022)</span>
<span class="ltx_bibblock">
EdwardÂ J Hu, yelong shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, LuÂ Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">LoRA: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">International Conference on Learning Representations (ICLR)</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang etÂ al. (2024)</span>
<span class="ltx_bibblock">
Jie Huang, Wei Ping, Peng Xu, Mohammad Shoeybi, Kevin Chang, and Bryan Catanzaro.

</span>
<span class="ltx_bibblock">RAVEN: In-context learning with retrieval-augmented encoder-decoder language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">First Conference on Language Modeling</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang etÂ al. (2023)</span>
<span class="ltx_bibblock">
Lei Huang, Weijiang Yu, Weitao Ma, Weihong Zhong, Zhangyin Feng, Haotian Wang, Qianglong Chen, Weihua Peng, Xiaocheng Feng, Bing Qin, and Ting Liu.

</span>
<span class="ltx_bibblock">A survey on hallucination in large language models: Principles, taxonomy, challenges, and open questions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2311.05232</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard &amp; Grave (2021)</span>
<span class="ltx_bibblock">
Gautier Izacard and Edouard Grave.

</span>
<span class="ltx_bibblock">Leveraging passage retrieval with generative models for open domain question answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">European Chapter of the Association for Computational Linguistics (EACL)</em>, pp.Â  874â€“880, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard etÂ al. (2022)</span>
<span class="ltx_bibblock">
Gautier Izacard, Mathilde Caron, Lucas Hosseini, Sebastian Riedel, Piotr Bojanowski, Armand Joulin, and Edouard Grave.

</span>
<span class="ltx_bibblock">Unsupervised dense information retrieval with contrastive learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Transactions on Machine Learning Research</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard etÂ al. (2023)</span>
<span class="ltx_bibblock">
Gautier Izacard, Patrick Lewis, Maria Lomeli, Lucas Hosseini, Fabio Petroni, Timo Schick, Jane Dwivedi-Yu, Armand Joulin, Sebastian Riedel, and Edouard Grave.

</span>
<span class="ltx_bibblock">Atlas: Few-shot learning with retrieval augmented language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Journal of Machine Learning Research</em>, pp.Â  1â€“43, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang etÂ al. (2023)</span>
<span class="ltx_bibblock">
AlbertÂ Q. Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, DevendraÂ Singh Chaplot, Diego deÂ las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, LÃ©lioÂ Renard Lavaud, Marie-Anne Lachaux, Pierre Stock, TevenÂ Le Scao, Thibaut Lavril, Thomas Wang, TimothÃ©e Lacroix, and WilliamÂ El Sayed.

</span>
<span class="ltx_bibblock">Mistral 7b.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2310.06825</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang etÂ al. (2024)</span>
<span class="ltx_bibblock">
AlbertÂ Q. Jiang, Alexandre Sablayrolles, Antoine Roux, Arthur Mensch, Blanche Savary, and etÂ al.

</span>
<span class="ltx_bibblock">Mixtral of experts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2401.04088</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin etÂ al. (2021)</span>
<span class="ltx_bibblock">
DiÂ Jin, Eileen Pan, Nassim Oufattole, Wei-Hung Weng, Hanyi Fang, and Peter Szolovits.

</span>
<span class="ltx_bibblock">What disease does this patient have? a large-scale open domain question answering dataset from medical exams.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Applied Sciences</em>, 11(14), 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin etÂ al. (2019)</span>
<span class="ltx_bibblock">
Qiao Jin, Bhuwan Dhingra, Zhengping Liu, William Cohen, and Xinghua Lu.

</span>
<span class="ltx_bibblock">PubMedQA: A dataset for biomedical research question answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pp.Â  2567â€“2577, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson etÂ al. (2021)</span>
<span class="ltx_bibblock">
Jeff Johnson, Matthijs Douze, and HervÃ© JÃ©gou.

</span>
<span class="ltx_bibblock">Billion-scale similarity search with gpus.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">IEEE Transactions on Big Data</em>, 7(3):535â€“547, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jones (1972)</span>
<span class="ltx_bibblock">
KarenÂ SpÃ¤rck Jones.

</span>
<span class="ltx_bibblock">A statistical interpretation of term specificity and its application in retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Journal of documentation</em>, 28(1):11â€“21, 1972.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi etÂ al. (2017)</span>
<span class="ltx_bibblock">
Mandar Joshi, Eunsol Choi, Daniel Weld, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">TriviaQA: A large scale distantly supervised challenge dataset for reading comprehension.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.Â  1601â€“1611, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kandpal etÂ al. (2023)</span>
<span class="ltx_bibblock">
Nikhil Kandpal, Haikang Deng, Adam Roberts, Eric Wallace, and Colin Raffel.

</span>
<span class="ltx_bibblock">Large language models struggle to learn long-tail knowledge.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">International Conference on Machine Learning</em>, volume 202, pp.Â  15696â€“15707, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpukhin etÂ al. (2020)</span>
<span class="ltx_bibblock">
Vladimir Karpukhin, Barlas Oguz, Sewon Min, Patrick Lewis, Ledell Wu, Sergey Edunov, Danqi Chen, and Wen-tau Yih.

</span>
<span class="ltx_bibblock">Dense passage retrieval for open-domain question answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP)</em>, pp.Â  6769â€“6781, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kasai etÂ al. (2023)</span>
<span class="ltx_bibblock">
Jungo Kasai, Keisuke Sakaguchi, yoichi takahashi, RonanÂ Le Bras, Akari Asai, XinyanÂ Velocity Yu, Dragomir Radev, NoahÂ A. Smith, Yejin Choi, and Kentaro Inui.

</span>
<span class="ltx_bibblock">Realtime QA: Whatâ€™s the answer right now?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Neural Information Processing Systems Datasets and Benchmarks Track</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khandelwal etÂ al. (2020)</span>
<span class="ltx_bibblock">
Urvashi Khandelwal, Omer Levy, Dan Jurafsky, Luke Zettlemoyer, and Mike Lewis.

</span>
<span class="ltx_bibblock">Generalization through memorization: Nearest neighbor language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">International Conference on Learning Representations (ICLR)</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kulkarni etÂ al. (2024)</span>
<span class="ltx_bibblock">
Mandar Kulkarni, Praveen Tangarajan, Kyung Kim, and Anusua Trivedi.

</span>
<span class="ltx_bibblock">Reinforcement learning for optimizing rag for domain chatbots.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2401.06800</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski etÂ al. (2019)</span>
<span class="ltx_bibblock">
Tom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, Jacob Devlin, Kenton Lee, Kristina Toutanova, Llion Jones, Matthew Kelcey, Ming-Wei Chang, AndrewÂ M. Dai, Jakob Uszkoreit, Quoc Le, and Slav Petrov.

</span>
<span class="ltx_bibblock">Natural questions: A benchmark for question answering research.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Transactions of the Association for Computational Linguistics</em>, 7:452â€“466, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lester etÂ al. (2021)</span>
<span class="ltx_bibblock">
Brian Lester, Rami Al-Rfou, and Noah Constant.

</span>
<span class="ltx_bibblock">The power of scale for parameter-efficient prompt tuning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing, EMNLP 2021, Virtual Event / Punta Cana, Dominican Republic, 7-11 November, 2021</em>, pp.Â  3045â€“3059, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis etÂ al. (2020)</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich KÃ¼ttler, Mike Lewis, Wen-tau Yih, Tim RocktÃ¤schel, Sebastian Riedel, and Douwe Kiela.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive nlp tasks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Advances in Neural Information Processing Systems</em>, volumeÂ 33, pp.Â  9459â€“9474, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li &amp; Liang (2021)</span>
<span class="ltx_bibblock">
XiangÂ Lisa Li and Percy Liang.

</span>
<span class="ltx_bibblock">Prefix-tuning: Optimizing continuous prompts for generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 1: Long Papers)</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li &amp; Li (2024)</span>
<span class="ltx_bibblock">
Xianming Li and Jing Li.

</span>
<span class="ltx_bibblock">AoE: Angle-optimized embeddings for semantic textual similarity.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proceedings of the 62nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li etÂ al. (2023)</span>
<span class="ltx_bibblock">
Zehan Li, Xin Zhang, Yanzhao Zhang, Dingkun Long, Pengjun Xie, and Meishan Zhang.

</span>
<span class="ltx_bibblock">Towards general text embeddings with multi-stage contrastive learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">arXiv preprint arXiv:2308.03281</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin etÂ al. (2023)</span>
<span class="ltx_bibblock">
Sheng-Chieh Lin, Akari Asai, Minghan Li, Barlas Oguz, Jimmy Lin, Yashar Mehdad, Wen-tau Yih, and Xilun Chen.

</span>
<span class="ltx_bibblock">How to train your dragon: Diverse augmentation towards generalizable dense retrieval.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Findings of the Association for Computational Linguistics: EMNLP 2023</em>, pp.Â  6385â€“6400, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin etÂ al. (2024)</span>
<span class="ltx_bibblock">
XiÂ Victoria Lin, Xilun Chen, Mingda Chen, Weijia Shi, Maria Lomeli, Richard James, Pedro Rodriguez, Jacob Kahn, Gergely Szilvasy, Mike Lewis, Luke Zettlemoyer, and Wen tau Yih.

</span>
<span class="ltx_bibblock">RA-DIT: Retrieval-augmented dual instruction tuning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">International Conference on Learning Representations (ICLR)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu etÂ al. (2024a)</span>
<span class="ltx_bibblock">
NelsonÂ F. Liu, Kevin Lin, John Hewitt, Ashwin Paranjape, Michele Bevilacqua, Fabio Petroni, and Percy Liang.

</span>
<span class="ltx_bibblock">Lost in the middle: How language models use long contexts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">Transactions of the Association for Computational Linguistics</em>, 12:157â€“173, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu etÂ al. (2023)</span>
<span class="ltx_bibblock">
Yang Liu, Dan Iter, Yichong Xu, Shuohang Wang, Ruochen Xu, and Chenguang Zhu.

</span>
<span class="ltx_bibblock">G-eval: NLG evaluation using gpt-4 with better human alignment.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">Conference on Empirical Methods in Natural Language Processing</em>, pp.Â  2511â€“2522, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu etÂ al. (2024b)</span>
<span class="ltx_bibblock">
Zihan Liu, Wei Ping, Rajarshi Roy, Peng Xu, Chankyu Lee, Mohammad Shoeybi, and Bryan Catanzaro.

</span>
<span class="ltx_bibblock">Chatqa: Surpassing gpt-4 on conversational qa and rag.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">arXiv preprint arXiv:2401.10225</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luan etÂ al. (2021)</span>
<span class="ltx_bibblock">
YiÂ Luan, Jacob Eisenstein, Kristina Toutanova, and Michael Collins.

</span>
<span class="ltx_bibblock">Sparse, dense, and attentional representations for text retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Transactions of the Association for Computational Linguistics</em>, pp.Â  329â€“345, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma etÂ al. (2024)</span>
<span class="ltx_bibblock">
Xueguang Ma, Liang Wang, Nan Yang, Furu Wei, and Jimmy Lin.

</span>
<span class="ltx_bibblock">Fine-tuning llama for multi-stage text retrieval.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pp.Â  2421â€“2425, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Menick etÂ al. (2022)</span>
<span class="ltx_bibblock">
Jacob Menick, Maja Trebacz, Vladimir Mikulik, John Aslanides, Francis Song, Martin Chadwick, Mia Glaese, Susannah Young, Lucy Campbell-Gillingham, Geoffrey Irving, and Nat McAleese.

</span>
<span class="ltx_bibblock">Teaching language models to support answers with verified quotes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">arXiv preprint arXiv:2203.11147</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meta (2024)</span>
<span class="ltx_bibblock">
Meta.

</span>
<span class="ltx_bibblock">Introducing meta llama 3: The most capable openly available llm to date.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">Meta AI blog</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://ai.meta.com/blog/meta-llama-3/" title="">https://ai.meta.com/blog/meta-llama-3/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Morimura etÂ al. (2024)</span>
<span class="ltx_bibblock">
Tetsuro Morimura, Mitsuki Sakamoto, Yuu Jinnai, Kenshi Abe, and Kaito Ariu.

</span>
<span class="ltx_bibblock">Filtered direct preference optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">arXiv preprint arXiv:2404.13846</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Muennighoff etÂ al. (2023)</span>
<span class="ltx_bibblock">
Niklas Muennighoff, Nouamane Tazi, Loic Magne, and Nils Reimers.

</span>
<span class="ltx_bibblock">MTEB: Massive text embedding benchmark.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">Proceedings of the 17th Conference of the European Chapter of the Association for Computational Linguistics</em>, pp.Â  2014â€“2037, May 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nogueira etÂ al. (2019)</span>
<span class="ltx_bibblock">
Rodrigo Nogueira, Wei Yang, Kyunghyun Cho, and Jimmy Lin.

</span>
<span class="ltx_bibblock">Multi-stage document ranking with bert.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">arXiv preprint arXiv:1910.14424</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2022)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Introducing chatgpt.

</span>
<span class="ltx_bibblock">2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/index/chatgpt/" title="">https://openai.com/index/chatgpt/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2024)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">arXiv preprint arXiv:2303.08774</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang etÂ al. (2022)</span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, XuÂ Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda Askell, Peter Welinder, PaulÂ F Christiano, Jan Leike, and Ryan Lowe.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">Advances in Neural Information Processing Systems</em>, volumeÂ 35, pp.Â  27730â€“27744, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pal etÂ al. (2022)</span>
<span class="ltx_bibblock">
Ankit Pal, LogeshÂ Kumar Umapathi, and Malaikannan Sankarasubbu.

</span>
<span class="ltx_bibblock">Medmcqa: A large-scale multi-subject multi-choice dataset for medical domain question answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">Proceedings of the Conference on Health, Inference, and Learning</em>, volume 174 of <em class="ltx_emph ltx_font_italic" id="bib.bib68.2.2">Proceedings of Machine Learning Research</em>, pp.Â  248â€“260, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petroni etÂ al. (2021)</span>
<span class="ltx_bibblock">
Fabio Petroni, Aleksandra Piktus, Angela Fan, Patrick Lewis, Majid Yazdani, Nicola DeÂ Cao, James Thorne, Yacine Jernite, Vladimir Karpukhin, Jean Maillard, Vassilis Plachouras, Tim RocktÃ¤schel, and Sebastian Riedel.

</span>
<span class="ltx_bibblock">KILT: a benchmark for knowledge intensive language tasks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib69.1.1">Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em>, pp.Â  2523â€“2544, June 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford etÂ al. (2018)</span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Improving language understanding by generative pre-training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib70.1.1">Advances in Neural Information Processing Systems</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford etÂ al. (2019)</span>
<span class="ltx_bibblock">
Alec Radford, Jeff Wu, Rewon Child, David Luan, Dario Amodei, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock">2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov etÂ al. (2023)</span>
<span class="ltx_bibblock">
Rafael Rafailov, Archit Sharma, Eric Mitchell, ChristopherÂ D Manning, Stefano Ermon, and Chelsea Finn.

</span>
<span class="ltx_bibblock">Direct preference optimization: Your language model is secretly a reward model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib72.1.1">Advances in Neural Information Processing Systems</em>, volumeÂ 36, pp.Â  53728â€“53741, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajpurkar etÂ al. (2016)</span>
<span class="ltx_bibblock">
Pranav Rajpurkar, Jian Zhang, Konstantin Lopyrev, and Percy Liang.

</span>
<span class="ltx_bibblock">SQuAD: 100,000+ questions for machine comprehension of text.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib73.1.1">Proceedings of the 2016 Conference on Empirical Methods in Natural Language Processing</em>, pp.Â  2383â€“2392, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ram etÂ al. (2023)</span>
<span class="ltx_bibblock">
Ori Ram, Yoav Levine, Itay Dalmedigos, Dor Muhlgay, Amnon Shashua, Kevin Leyton-Brown, and Yoav Shoham.

</span>
<span class="ltx_bibblock">In-context retrieval-augmented language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib74.1.1">Transactions of the Association for Computational Linguistics</em>, pp.Â  1316â€“1331, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rasley etÂ al. (2020)</span>
<span class="ltx_bibblock">
Jeff Rasley, Samyam Rajbhandari, Olatunji Ruwase, and Yuxiong He.

</span>
<span class="ltx_bibblock">Deepspeed: System optimizations enable training deep learning models with over 100 billion parameters.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib75.1.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>, pp.Â  3505â€“3506, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rauh etÂ al. (2022)</span>
<span class="ltx_bibblock">
Maribeth Rauh, John Mellor, Jonathan Uesato, Po-Sen Huang, Johannes Welbl, Laura Weidinger, Sumanth Dathathri, Amelia Glaese, Geoffrey Irving, Iason Gabriel, William Isaac, and LisaÂ Anne Hendricks.

</span>
<span class="ltx_bibblock">Characteristics of harmful text: Towards rigorous benchmarking of language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib76.1.1">Advances in Neural Information Processing Systems</em>, volumeÂ 35, pp.Â  24720â€“24739, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reimers &amp; Gurevych (2019)</span>
<span class="ltx_bibblock">
Nils Reimers and Iryna Gurevych.

</span>
<span class="ltx_bibblock">Sentence-BERT: Sentence embeddings using Siamese BERT-networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib77.1.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pp.Â  3982â€“3992, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robertson &amp; Zaragoza (2009)</span>
<span class="ltx_bibblock">
Stephen Robertson and Hugo Zaragoza.

</span>
<span class="ltx_bibblock">The probabilistic relevance framework: Bm25 and beyond.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib78.1.1">Foundations and TrendsÂ® in Information Retrieval</em>, 3(4):333â€“389, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sarthi etÂ al. (2024)</span>
<span class="ltx_bibblock">
Parth Sarthi, Salman Abdullah, Aditi Tuli, Shubh Khanna, Anna Goldie, and ChristopherÂ D Manning.

</span>
<span class="ltx_bibblock">RAPTOR: Recursive abstractive processing for tree-organized retrieval.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib79.1.1">International Conference on Learning Representations (ICLR)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman etÂ al. (2017)</span>
<span class="ltx_bibblock">
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib80.1.1">arXiv preprint arXiv:1707.06347</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi etÂ al. (2024)</span>
<span class="ltx_bibblock">
Weijia Shi, Sewon Min, Michihiro Yasunaga, Minjoon Seo, Richard James, Mike Lewis, Luke Zettlemoyer, and Wen-tau Yih.

</span>
<span class="ltx_bibblock">REPLUG: Retrieval-augmented black-box language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib81.1.1">Proceedings of the 2024 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies (Volume 1: Long Papers)</em>, pp.Â  8364â€“8377, June 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shinn etÂ al. (2023)</span>
<span class="ltx_bibblock">
Noah Shinn, Federico Cassano, Ashwin Gopinath, Karthik Narasimhan, and Shunyu Yao.

</span>
<span class="ltx_bibblock">Reflexion: language agents with verbal reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib82.1.1">Advances in Neural Information Processing Systems</em>, volumeÂ 36, pp.Â  8634â€“8652, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Siriwardhana etÂ al. (2023)</span>
<span class="ltx_bibblock">
Shamane Siriwardhana, Rivindu Weerasekera, Elliott Wen, Tharindu Kaluarachchi, Rajib Rana, and Suranga Nanayakkara.

</span>
<span class="ltx_bibblock">Improving the domain adaptation of retrieval augmented generation (RAG) models for open domain question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib83.1.1">Transactions of the Association for Computational Linguistics</em>, pp.Â  1â€“17, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stiennon etÂ al. (2020)</span>
<span class="ltx_bibblock">
Nisan Stiennon, Long Ouyang, Jeffrey Wu, Daniel Ziegler, Ryan Lowe, Chelsea Voss, Alec Radford, Dario Amodei, and PaulÂ F Christiano.

</span>
<span class="ltx_bibblock">Learning to summarize with human feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib84.1.1">Advances in Neural Information Processing Systems</em>, volumeÂ 33, pp.Â  3008â€“3021, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su etÂ al. (2024)</span>
<span class="ltx_bibblock">
Jianlin Su, Murtadha H.Â M. Ahmed, YuÂ Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu.

</span>
<span class="ltx_bibblock">Roformer: Enhanced transformer with rotary position embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib85.1.1">Neurocomputing</em>, 568:127063, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib86">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thomas etÂ al. (2024)</span>
<span class="ltx_bibblock">
Paul Thomas, Seth Spielman, Nick Craswell, and Bhaskar Mitra.

</span>
<span class="ltx_bibblock">Large language models can accurately predict searcher preferences.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib86.1.1">Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pp.Â  1930â€“1940, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib87">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thorne etÂ al. (2018)</span>
<span class="ltx_bibblock">
James Thorne, Andreas Vlachos, Christos Christodoulopoulos, and Arpit Mittal.

</span>
<span class="ltx_bibblock">FEVER: a large-scale dataset for fact extraction and VERification.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib87.1.1">Proceedings of the 2018 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long Papers)</em>, pp.Â  809â€“819, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib88">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron etÂ al. (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, TimothÃ©e Lacroix, Baptiste RoziÃ¨re, Naman Goyal, Eric Hambro, Faisal Azhar, Aurelien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume Lample.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib88.1.1">arXiv preprint arXiv:2302.13971</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib89">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron etÂ al. (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, CristianÂ Canton Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, and etÂ al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib89.1.1">arXiv preprint arXiv:2307.09288</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib90">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tsatsaronis etÂ al. (2015)</span>
<span class="ltx_bibblock">
George Tsatsaronis, Georgios Balikas, Prodromos Malakasiotis, Ioannis Partalas, Matthias Zschunke, Michael Alvers, Dirk WeiÃŸenborn, Anastasia Krithara, Sergios Petridis, Dimitris Polychronopoulos, Yannis Almirantis, John Pavlopoulos, Nicolas Baskiotis, Patrick Gallinari, Thierry Artieres, Axel-Cyrille NgongaÂ Ngomo, Norman Heino, Eric Gaussier, Liliana Barrio-Alvers, and Georgios Paliouras.

</span>
<span class="ltx_bibblock">An overview of the bioasq large-scale biomedical semantic indexing and question answering competition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib90.1.1">BMC Bioinformatics</em>, 16:138, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib91">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">vanÂ den Oord etÂ al. (2019)</span>
<span class="ltx_bibblock">
Aaron vanÂ den Oord, Yazhe Li, and Oriol Vinyals.

</span>
<span class="ltx_bibblock">Representation learning with contrastive predictive coding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib91.1.1">arXiv preprint arXiv:1807.03748</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib92">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani etÂ al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, AidanÂ N Gomez, ÅÂ ukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib92.1.1">Advances in Neural Information Processing Systems</em>, volumeÂ 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib93">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. (2024)</span>
<span class="ltx_bibblock">
Haoxiang Wang, Wei Xiong, Tengyang Xie, Han Zhao, and Tong Zhang.

</span>
<span class="ltx_bibblock">Interpretable preferences via multi-objective reward modeling and mixture-of-experts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib93.1.1">arXiv preprint arXiv:2406.12845</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib94">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. (2022a)</span>
<span class="ltx_bibblock">
Kexin Wang, Nandan Thakur, Nils Reimers, and Iryna Gurevych.

</span>
<span class="ltx_bibblock">GPL: Generative pseudo labeling for unsupervised domain adaptation of dense retrieval.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib94.1.1">Proceedings of the 2022 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em>, pp.Â  2345â€“2360, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib95">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. (2022b)</span>
<span class="ltx_bibblock">
Liang Wang, Nan Yang, Xiaolong Huang, Binxing Jiao, Linjun Yang, Daxin Jiang, Rangan Majumder, and Furu Wei.

</span>
<span class="ltx_bibblock">Text embeddings by weakly-supervised contrastive pre-training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib95.1.1">arXiv preprint arXiv:2212.03533</em>, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib96">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. (2022c)</span>
<span class="ltx_bibblock">
Yaqing Wang, Sahaj Agarwal, Subhabrata Mukherjee, Xiaodong Liu, Jing Gao, AhmedÂ Hassan Awadallah, and Jianfeng Gao.

</span>
<span class="ltx_bibblock">AdaMix: Mixture-of-adaptations for parameter-efficient model tuning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib96.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pp.Â  5744â€“5760, 2022c.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib97">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei etÂ al. (2022)</span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, brian ichter, Fei Xia, EdÂ Chi, QuocÂ V Le, and Denny Zhou.

</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib97.1.1">Advances in Neural Information Processing Systems</em>, pp.Â  24824â€“24837, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib98">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu etÂ al. (2024)</span>
<span class="ltx_bibblock">
Chaoyi Wu, Weixiong Lin, Xiaoman Zhang, YaÂ Zhang, Weidi Xie, and Yanfeng Wang.

</span>
<span class="ltx_bibblock">PMC-LLaMA: toward building open-source language models for medicine.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib98.1.1">Journal of the American Medical Informatics Association</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib99">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao etÂ al. (2024)</span>
<span class="ltx_bibblock">
Shitao Xiao, Zheng Liu, Peitian Zhang, Niklas Muennighoff, Defu Lian, and Jian-Yun Nie.

</span>
<span class="ltx_bibblock">C-pack: Packed resources for general chinese embeddings.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib99.1.1">Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pp.Â  641â€“649, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib100">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong etÂ al. (2024)</span>
<span class="ltx_bibblock">
Guangzhi Xiong, Qiao Jin, Zhiyong Lu, and Aidong Zhang.

</span>
<span class="ltx_bibblock">Benchmarking retrieval-augmented generation for medicine.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib100.1.1">arXiv preprint arXiv:2402.13178</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib101">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu etÂ al. (2024a)</span>
<span class="ltx_bibblock">
Fangyuan Xu, Weijia Shi, and Eunsol Choi.

</span>
<span class="ltx_bibblock">RECOMP: improving retrieval-augmented lms with context compression and selective augmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib101.1.1">International Conference on Learning Representations (ICLR)</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib102">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu etÂ al. (2024b)</span>
<span class="ltx_bibblock">
Peng Xu, Wei Ping, Xianchao Wu, Lawrence McAfee, Chen Zhu, Zihan Liu, Sandeep Subramanian, Evelina Bakhturina, Mohammad Shoeybi, and Bryan Catanzaro.

</span>
<span class="ltx_bibblock">Retrieval meets long context large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib102.1.1">International Conference on Learning Representations (ICLR)</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib103">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu etÂ al. (2024)</span>
<span class="ltx_bibblock">
Yue Yu, Wei Ping, Zihan Liu, Boxin Wang, Jiaxuan You, Chao Zhang, Mohammad Shoeybi, and Bryan Catanzaro.

</span>
<span class="ltx_bibblock">Rankrag: Unifying context ranking with retrieval-augmented generation in llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib103.1.1">arXiv preprint arXiv:2407.02485</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib104">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeng etÂ al. (2024)</span>
<span class="ltx_bibblock">
Yongcheng Zeng, Guoqing Liu, Weiyu Ma, Ning Yang, Haifeng Zhang, and Jun Wang.

</span>
<span class="ltx_bibblock">Token-level direct preference optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib104.1.1">arXiv preprint arXiv:2404.11999</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib105">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang etÂ al. (2023)</span>
<span class="ltx_bibblock">
Peitian Zhang, Shitao Xiao, Zheng Liu, Zhicheng Dou, and Jian-Yun Nie.

</span>
<span class="ltx_bibblock">Retrieve anything to augment large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib105.1.1">arXiv preprint arXiv:2310.07554</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib106">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang etÂ al. (2024)</span>
<span class="ltx_bibblock">
Tianjun Zhang, ShishirÂ G. Patil, Naman Jain, Sheng Shen, Matei Zaharia, Ion Stoica, and JosephÂ E. Gonzalez.

</span>
<span class="ltx_bibblock">Raft: Adapting language model to domain specific rag.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib106.1.1">arXiv preprint arXiv:2403.10131</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib107">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao etÂ al. (2023)</span>
<span class="ltx_bibblock">
WayneÂ Xin Zhao, Kun Zhou, Junyi Li, Tianyi Tang, Xiaolei Wang, Yupeng Hou, Yingqian Min, Beichen Zhang, Junjie Zhang, Zican Dong, Yifan Du, Chen Yang, Yushuo Chen, Zhipeng Chen, Jinhao Jiang, Ruiyang Ren, Yifan Li, Xinyu Tang, Zikang Liu, Peiyu Liu, Jian-Yun Nie, and Ji-Rong Wen.

</span>
<span class="ltx_bibblock">A survey of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib107.1.1">arXiv preprint arXiv:2303.18223</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib108">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng etÂ al. (2024)</span>
<span class="ltx_bibblock">
Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao Zhuang, ZiÂ Lin, Zhuohan Li, Dacheng Li, EricÂ P. Xing, Hao Zhang, JosephÂ E. Gonzalez, and Ion Stoica.

</span>
<span class="ltx_bibblock">Judging llm-as-a-judge with mt-bench and chatbot arena.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib108.1.1">Proceedings of the 37th International Conference on Neural Information Processing Systems</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib109">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou etÂ al. (2023)</span>
<span class="ltx_bibblock">
Yujia Zhou, Zhicheng Dou, and Ji-Rong Wen.

</span>
<span class="ltx_bibblock">Enhancing generative retrieval with reinforcement learning from relevance feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib109.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pp.Â  12481â€“12490, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib110">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu etÂ al. (2024)</span>
<span class="ltx_bibblock">
Dawei Zhu, Nan Yang, Liang Wang, Yifan Song, Wenhao Wu, Furu Wei, and Sujian Li.

</span>
<span class="ltx_bibblock">PoSE: Efficient context window extension of LLMs via positional skip-wise training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib110.1.1">International Conference on Learning Representations (ICLR)</em>, 2024.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Training Hyperparameters</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">We use 8xRTX A6000 Ada gen 2 for our works. Our implementation is based on the Hugging Face library<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://huggingface.co</span></span></span> includes transformers, accelerate, and PEFT libraries. In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#A1.T7" title="Table 7 â€£ Appendix A Training Hyperparameters â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">7</span></a> we show our configuration used in retrieval encoder fine-tuning. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03780v1#A1.T8" title="Table 8 â€£ Appendix A Training Hyperparameters â€£ Reward-RAG: Enhancing RAG with Reward Driven Supervision"><span class="ltx_text ltx_ref_tag">8</span></a> show the settings to train our reward models.</p>
</div>
<figure class="ltx_table" id="A1.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Hyperparameters for retrieval encoder</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T7.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T7.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.T7.1.1.1.1.1">Hyperparameter</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A1.T7.1.1.1.2.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T7.1.2.2.1">Base model</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.2.2">E5-large-unsupervised</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.3.3.1">Embedding dim</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.3.2">1024</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.4.4.1">Embedding pooling</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.4.4.2">Average at last layer</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.5.5.1">Negative documents</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.5.5.2">Hard-negatives + in-batch</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.6.6.1">Number of hard-negatives</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.6.6.2">5</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.7.7.1">Softmax Temperature</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.7.7.2">0.01</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.8.8.1">Optimizer</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.8.8.2">AdamW</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.9.9.1">Learning rate</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.9.9.2">2e-5</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.10.10.1">Batch-size per GPU</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.10.10.2">16</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.11.11.1">Gradient accumulation steps</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.11.11.2">2</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.12.12.1">LoRA Rank</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.12.12.2">16</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.1.13.13.1">LoRA Alpha</th>
<td class="ltx_td ltx_align_center" id="A1.T7.1.13.13.2">32</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="A1.T7.1.14.14.1">Epochs</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T7.1.14.14.2">10</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A1.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Hyperparameters for critic models</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T8.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T8.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T8.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.T8.1.1.1.1.1">Hyperparameter</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A1.T8.1.1.1.2.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T8.1.2.2.1">Base model</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.1.2.2.2">Llama-3.1-8B-Instruct</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.3.3.1">Optimizer</th>
<td class="ltx_td ltx_align_center" id="A1.T8.1.3.3.2">AdamW</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.4.4.1">Learning rate</th>
<td class="ltx_td ltx_align_center" id="A1.T8.1.4.4.2">1e-5</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.5.5.1">Batch-size per GPU</th>
<td class="ltx_td ltx_align_center" id="A1.T8.1.5.5.2">4</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.6.6.1">Gradient accumulation steps</th>
<td class="ltx_td ltx_align_center" id="A1.T8.1.6.6.2">2</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.7.7.1">LoRA Rank</th>
<td class="ltx_td ltx_align_center" id="A1.T8.1.7.7.2">16</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.8.8.1">LoRA Alpha</th>
<td class="ltx_td ltx_align_center" id="A1.T8.1.8.8.2">32</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T8.1.9.9.1">Deepspeed stage</th>
<td class="ltx_td ltx_align_center" id="A1.T8.1.9.9.2">2</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="A1.T8.1.10.10.1">Epochs</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="A1.T8.1.10.10.2">10</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Prompt Formats</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Feedback Collection</h3>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">System: 
<br class="ltx_break"/>You are a search quality rater evaluating the relevance of web pages.
Given a query, a list of correct answers from experts, and a passage cut randomly from a web page, you must analyze the relevance between the query and web pages.
you must provide a score on an integer scale of 0 to 2 with the following meanings: 
<br class="ltx_break"/>** 2 = highly relevant, provide the correct answer similar to experts with explanations, very helpful for this query. 
<br class="ltx_break"/>** 1 = relevant, provide related information to query but can not find the correct answer 
<br class="ltx_break"/>** 0 = not relevant, should never be shown for this query</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.1">Instructions 
<br class="ltx_break"/>Split this problem into steps 
<br class="ltx_break"/>** Understand the web page 
<br class="ltx_break"/>- List all information can be extracted from the web page. 
<br class="ltx_break"/>- Only consider information which was clearly mentioned. 
<br class="ltx_break"/>- Do not imply or infer based on addition information in your knowledge. 
<br class="ltx_break"/>- Do not manipulate. 
<br class="ltx_break"/>** Understand the query 
<br class="ltx_break"/>- Identify the main subject and intent of the query 
<br class="ltx_break"/>- Focusing on specific details like â€first,â€ â€most,â€ or other qualifiers that define the queryâ€™s focus. 
<br class="ltx_break"/>** Consider different aspects: 
<br class="ltx_break"/>- (match) Does the web page provide information related to the query? (0/1) 
<br class="ltx_break"/>- (gt) Consider the list of correct answer, does the web page mention any correct answer explicitly with evidences? (0/1) 
<br class="ltx_break"/>- (diff) If the web page does not mention explicitly any correct answer with evidences, does it provide another answer? (0/1) 
<br class="ltx_break"/>- Note: a close answer to the correct answer is still wrong. 
<br class="ltx_break"/>- Avoid subject mismatching: for example if the query asks about â€The book thiefâ€ and the passage discusses about â€The thiefâ€, it is different. 
<br class="ltx_break"/>** Consider the aspects above, and decide on a final score. Final score must be an integer value only. 
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p3">
<p class="ltx_p" id="A2.SS1.p3.1">Your tasks 
<br class="ltx_break"/>- Analyze webpage and query by step-by-step mentioned above 
<br class="ltx_break"/>- From your analysis, make a final decision. 
<br class="ltx_break"/>- Output format: a json contains 5 keys: â€analyzeâ€: summary your analysis at most 4 sentences, â€matchâ€: 0/1, â€gtâ€: 0/1, â€diffâ€: 0/1, â€finalscoreâ€: 0/1/2
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p4">
<p class="ltx_p" id="A2.SS1.p4.1">Human message: 
<br class="ltx_break"/>* Passage: {passage} 
<br class="ltx_break"/>* Query: {query} 
<br class="ltx_break"/>* Correct answer: {answer} 
<br class="ltx_break"/></p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Question Answering</h3>
<div class="ltx_para ltx_noindent" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">Prompts for NQ and Trivia QA</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.1">System: This is a chat between a user and an artificial intelligence assistant. 
<br class="ltx_break"/>The assistant gives helpful, detailed, and polite answers to the userâ€™s questions.
<br class="ltx_break"/>The assistant is provided with 5 passages from Wikipedia.
<br class="ltx_break"/>If there isnâ€™t any related information in these passages, answer based on your knowledge.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p3">
<p class="ltx_p" id="A2.SS2.p3.1">Human message: 
<br class="ltx_break"/>* Passage 1: {passage 1} 
<br class="ltx_break"/>* Passage 2: {passage 2} 
<br class="ltx_break"/>* Passage 3: {passage 3} 
<br class="ltx_break"/>* Passage 4: {passage 4} 
<br class="ltx_break"/>* Passage 5: {passage 5} 
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p4">
<p class="ltx_p" id="A2.SS2.p4.1">Query: {query} 
<br class="ltx_break"/>Answer the query directly with the shortest phrase without explanation. 
<br class="ltx_break"/>If there are many correct answers, only output one of them.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p5">
<p class="ltx_p" id="A2.SS2.p5.1">Prompts for FEVER</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p6">
<p class="ltx_p" id="A2.SS2.p6.1">System: This is a chat between a user and an artificial intelligence assistant. 
<br class="ltx_break"/>The assistant gives helpful, detailed, and polite answers to the userâ€™s questions.
<br class="ltx_break"/>The assistant is provided with 5 passages from Wikipedia.
<br class="ltx_break"/>If there isnâ€™t any related information in these passages, answer based on your knowledge.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p7">
<p class="ltx_p" id="A2.SS2.p7.1">Human message: 
<br class="ltx_break"/>* Passage 1: {passage 1} 
<br class="ltx_break"/>* Passage 2: {passage 2} 
<br class="ltx_break"/>* Passage 3: {passage 3} 
<br class="ltx_break"/>* Passage 4: {passage 4} 
<br class="ltx_break"/>* Passage 5: {passage 5} 
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p8">
<p class="ltx_p" id="A2.SS2.p8.1">Query: {query} 
<br class="ltx_break"/>Answer directly the above query with True or False.</p>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct  3 15:27:09 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
