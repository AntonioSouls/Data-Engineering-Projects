<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>FutureFill: Fast Generation from Convolutional Sequence Models</title>
<!--Generated on Wed Oct  2 15:20:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03766v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S1" title="In FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S1.SS1" title="In 1 Introduction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1.1 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S1.SS1.SSS0.Px1" title="In 1.1 Related Work ‣ 1 Introduction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title">State space models and convolutional sequence prediction.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S1.SS1.SSS0.Px2" title="In 1.1 Related Work ‣ 1 Introduction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title">Spectral filtering.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S1.SS1.SSS0.Px3" title="In 1.1 Related Work ‣ 1 Introduction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title">Online learning and regret minimization in sequence prediction.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2" title="In FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Setting</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.SS1" title="In 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Abstracting Convolutional Sequence Prediction</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.SS1.SSS0.Px1" title="In 2.1 Abstracting Convolutional Sequence Prediction ‣ 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title">State Space Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.SS1.SSS0.Px2" title="In 2.1 Abstracting Convolutional Sequence Prediction ‣ 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title">LongConv/SGConv.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.SS1.SSS0.Px3" title="In 2.1 Abstracting Convolutional Sequence Prediction ‣ 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title">Spectral Transform Units.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.SS1.SSS0.Px4" title="In 2.1 Abstracting Convolutional Sequence Prediction ‣ 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title">Hyena.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.SS2" title="In 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Sequence Generation from a Prompt</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.SS2.SSS0.Px1" title="In 2.2 Sequence Generation from a Prompt ‣ 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title">Prefill generation.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.SS3" title="In 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Online sequence prediction</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S3" title="In FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Fast auto-regressive generation using a prefill cache</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S3.SS0.SSS0.Px1" title="In 3 Fast auto-regressive generation using a prefill cache ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title">Running time analysis.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S4" title="In FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Fast Online Convolutional Prediction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S4.SS1" title="In 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Case Study: Fast Online Spectral Filtering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S4.SS2" title="In 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Experiments</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FutureFill: Fast Generation from Convolutional Sequence Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Naman Agarwal 
<br class="ltx_break"/>&amp;Xinyi Chen  
<br class="ltx_break"/>&amp;Evan Dogariu 
<br class="ltx_break"/>&amp;Vlad Feinberg 
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id1.1.id1">\AND</span>Daniel Suo 
<br class="ltx_break"/>&amp;Peter Bartlett 
<br class="ltx_break"/>&amp;Elad Hazan 
<br class="ltx_break"/>
</span><span class="ltx_author_notes">Equal contributionEqual contributionGoogle DeepMind, <span class="ltx_text ltx_font_typewriter" id="id2.2.id1">{namanagarwal,xinyic,dogari,vladf,dsuo,peterbartlett,ehazan}@google.com</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.id1">We address the challenge of efficient auto-regressive generation in sequence prediction models by introducing FutureFill—a method for fast generation that applies to any sequence prediction algorithm based on convolutional operators. Our approach reduces the generation time requirement from linear to square root relative to the context length. Additionally, FutureFill requires a prefill cache sized only by the number of tokens generated, which is smaller than the cache requirements for standard convolutional and attention-based models. We validate our theoretical findings with experimental evidence demonstrating correctness and efficiency gains in a synthetic generation task.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large Transformer models <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib22" title="">2017</a>)</cite> have become the method of choice for sequence prediction tasks such as language modeling and machine translation. Despite their success, they face a key computational limitation: the attention mechanism, their core innovation, incurs a quadratic computational cost during training and inference. This inefficiency has spurred interest in alternative architectures that can handle long sequences more efficiently.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Convolution-based sequence prediction models <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib14" title="">2022</a>); Poli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib18" title="">2023</a>); Agarwal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib1" title="">2023</a>); Fu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib3" title="">2024</a>)</cite>
have emerged as strong contenders, primarily due to their ability to leverage the Fast Fourier Transform (FFT) for near-linear scaling with sequence length during training. These models build upon the advancements in State Space Models (SSMs), which have shown promise in modeling long sequences across diverse modalities <cite class="ltx_cite ltx_citemacro_cite">Gu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib7" title="">2021a</a>); Dao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib2" title="">2022</a>); Gupta et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib9" title="">2022</a>); Orvieto et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib17" title="">2023</a>); Poli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib18" title="">2023</a>); Gu &amp; Dao (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib5" title="">2023</a>)</cite>.
Convolutional models offer a more general framework than SSMs because they can represent any linear dynamical system (LDS) without being constrained by the dimensionality of hidden states <cite class="ltx_cite ltx_citemacro_cite">Agarwal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib1" title="">2023</a>)</cite>. This flexibility has led to recent developments that theoretically and empirically handle longer contexts more effectively. Notable among these are Spectral State Space Models or Spectral Transform Units (STUs) <cite class="ltx_cite ltx_citemacro_cite">Agarwal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib1" title="">2023</a>)</cite>, which use spectral filtering algorithms <cite class="ltx_cite ltx_citemacro_cite">Hazan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib11" title="">2017</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib12" title="">2018</a>)</cite>
to transform inputs into better-conditioned bases for long-term memory. Another approach is Hyena <cite class="ltx_cite ltx_citemacro_cite">Poli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib18" title="">2023</a>)</cite>, which learns implicitly parameterized Markov operators. Both methods exploit the duality between time-domain convolution and frequency-domain multiplication to accelerate prediction via the FFT.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">While SSMs and recurrent models benefit from fast inference times independent of sequence length, making them attractive for large-scale language modeling, convolutional models have been hindered by slower token generation during inference. The best-known result for generating tokens with convolutional models is quadratic in sequence length—comparable to attention-based models (see <cite class="ltx_cite ltx_citemacro_cite">Massaroli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib15" title="">2024</a>)</cite> Lemma 2.1). This limitation has prompted research into distilling state-space models from convolutional models <cite class="ltx_cite ltx_citemacro_cite">Massaroli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib15" title="">2024</a>)</cite>, but such approximations lack comprehensive understanding regarding their approximation gaps due to the broader representational capacity of convolutional models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we address the problem of exact auto-regressive generation from given convolutional models, significantly improving both the generation time and cache size requirements. We present our main results in two settings:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.3"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.3.1">Generation from Scratch:</span> When generating K tokens from scratch, we demonstrate that long convolutional sequence predictors can generate these tokens in time <math alttext="O(K\sqrt{L\log L})" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.m1.1"><semantics id="S1.I1.i1.p1.1.m1.1a"><mrow id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml"><mi id="S1.I1.i1.p1.1.m1.1.1.3" xref="S1.I1.i1.p1.1.m1.1.1.3.cmml">O</mi><mo id="S1.I1.i1.p1.1.m1.1.1.2" xref="S1.I1.i1.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S1.I1.i1.p1.1.m1.1.1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.cmml"><mo id="S1.I1.i1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S1.I1.i1.p1.1.m1.1.1.1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S1.I1.i1.p1.1.m1.1.1.1.1.1.2" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml">K</mi><mo id="S1.I1.i1.p1.1.m1.1.1.1.1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><msqrt id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml"><mrow id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.cmml"><mi id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.2" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.2.cmml">L</mi><mo id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.1" lspace="0.167em" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.cmml"><mi id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.1" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.1.cmml">log</mi><mo id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3a" lspace="0.167em" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.cmml">⁡</mo><mi id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.2" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.2.cmml">L</mi></mrow></mrow></msqrt></mrow><mo id="S1.I1.i1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><apply id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1"><times id="S1.I1.i1.p1.1.m1.1.1.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.2"></times><ci id="S1.I1.i1.p1.1.m1.1.1.3.cmml" xref="S1.I1.i1.p1.1.m1.1.1.3">𝑂</ci><apply id="S1.I1.i1.p1.1.m1.1.1.1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1"><times id="S1.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.1"></times><ci id="S1.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.2">𝐾</ci><apply id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3"><root id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3a.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3"></root><apply id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2"><times id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.1"></times><ci id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.2">𝐿</ci><apply id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3"><log id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.1"></log><ci id="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.2">𝐿</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">O(K\sqrt{L\log L})</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.m1.1d">italic_O ( italic_K square-root start_ARG italic_L roman_log italic_L end_ARG )</annotation></semantics></math>, where <math alttext="L" class="ltx_Math" display="inline" id="S1.I1.i1.p1.2.m2.1"><semantics id="S1.I1.i1.p1.2.m2.1a"><mi id="S1.I1.i1.p1.2.m2.1.1" xref="S1.I1.i1.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.2.m2.1b"><ci id="S1.I1.i1.p1.2.m2.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.2.m2.1d">italic_L</annotation></semantics></math> is the context length of the model. This improves upon previous methods that require
<math alttext="O(KL)" class="ltx_Math" display="inline" id="S1.I1.i1.p1.3.m3.1"><semantics id="S1.I1.i1.p1.3.m3.1a"><mrow id="S1.I1.i1.p1.3.m3.1.1" xref="S1.I1.i1.p1.3.m3.1.1.cmml"><mi id="S1.I1.i1.p1.3.m3.1.1.3" xref="S1.I1.i1.p1.3.m3.1.1.3.cmml">O</mi><mo id="S1.I1.i1.p1.3.m3.1.1.2" xref="S1.I1.i1.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S1.I1.i1.p1.3.m3.1.1.1.1" xref="S1.I1.i1.p1.3.m3.1.1.1.1.1.cmml"><mo id="S1.I1.i1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S1.I1.i1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S1.I1.i1.p1.3.m3.1.1.1.1.1" xref="S1.I1.i1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S1.I1.i1.p1.3.m3.1.1.1.1.1.2" xref="S1.I1.i1.p1.3.m3.1.1.1.1.1.2.cmml">K</mi><mo id="S1.I1.i1.p1.3.m3.1.1.1.1.1.1" xref="S1.I1.i1.p1.3.m3.1.1.1.1.1.1.cmml">⁢</mo><mi id="S1.I1.i1.p1.3.m3.1.1.1.1.1.3" xref="S1.I1.i1.p1.3.m3.1.1.1.1.1.3.cmml">L</mi></mrow><mo id="S1.I1.i1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S1.I1.i1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.3.m3.1b"><apply id="S1.I1.i1.p1.3.m3.1.1.cmml" xref="S1.I1.i1.p1.3.m3.1.1"><times id="S1.I1.i1.p1.3.m3.1.1.2.cmml" xref="S1.I1.i1.p1.3.m3.1.1.2"></times><ci id="S1.I1.i1.p1.3.m3.1.1.3.cmml" xref="S1.I1.i1.p1.3.m3.1.1.3">𝑂</ci><apply id="S1.I1.i1.p1.3.m3.1.1.1.1.1.cmml" xref="S1.I1.i1.p1.3.m3.1.1.1.1"><times id="S1.I1.i1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S1.I1.i1.p1.3.m3.1.1.1.1.1.1"></times><ci id="S1.I1.i1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S1.I1.i1.p1.3.m3.1.1.1.1.1.2">𝐾</ci><ci id="S1.I1.i1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S1.I1.i1.p1.3.m3.1.1.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.3.m3.1c">O(KL)</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.3.m3.1d">italic_O ( italic_K italic_L )</annotation></semantics></math> time for generation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.7"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.7.1">Generation with Prompt:</span> When generating <math alttext="K" class="ltx_Math" display="inline" id="S1.I1.i2.p1.1.m1.1"><semantics id="S1.I1.i2.p1.1.m1.1a"><mi id="S1.I1.i2.p1.1.m1.1.1" xref="S1.I1.i2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.1.m1.1b"><ci id="S1.I1.i2.p1.1.m1.1.1.cmml" xref="S1.I1.i2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.1.m1.1d">italic_K</annotation></semantics></math> tokens starting from a prompt of length <math alttext="L" class="ltx_Math" display="inline" id="S1.I1.i2.p1.2.m2.1"><semantics id="S1.I1.i2.p1.2.m2.1a"><mi id="S1.I1.i2.p1.2.m2.1.1" xref="S1.I1.i2.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.2.m2.1b"><ci id="S1.I1.i2.p1.2.m2.1.1.cmml" xref="S1.I1.i2.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.2.m2.1d">italic_L</annotation></semantics></math> (assuming a context length of <math alttext="L" class="ltx_Math" display="inline" id="S1.I1.i2.p1.3.m3.1"><semantics id="S1.I1.i2.p1.3.m3.1a"><mi id="S1.I1.i2.p1.3.m3.1.1" xref="S1.I1.i2.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.3.m3.1b"><ci id="S1.I1.i2.p1.3.m3.1.1.cmml" xref="S1.I1.i2.p1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.3.m3.1d">italic_L</annotation></semantics></math>), we show that the total generation time is <math alttext="O(L\log L+K^{2})" class="ltx_Math" display="inline" id="S1.I1.i2.p1.4.m4.1"><semantics id="S1.I1.i2.p1.4.m4.1a"><mrow id="S1.I1.i2.p1.4.m4.1.1" xref="S1.I1.i2.p1.4.m4.1.1.cmml"><mi id="S1.I1.i2.p1.4.m4.1.1.3" xref="S1.I1.i2.p1.4.m4.1.1.3.cmml">O</mi><mo id="S1.I1.i2.p1.4.m4.1.1.2" xref="S1.I1.i2.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="S1.I1.i2.p1.4.m4.1.1.1.1" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.cmml"><mo id="S1.I1.i2.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S1.I1.i2.p1.4.m4.1.1.1.1.1" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.cmml"><mrow id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.cmml"><mi id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.2" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.2.cmml">L</mi><mo id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.1" lspace="0.167em" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.cmml"><mi id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.1" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3a" lspace="0.167em" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.cmml">⁡</mo><mi id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.2" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.2.cmml">L</mi></mrow></mrow><mo id="S1.I1.i2.p1.4.m4.1.1.1.1.1.1" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.1.cmml">+</mo><msup id="S1.I1.i2.p1.4.m4.1.1.1.1.1.3" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.cmml"><mi id="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.2" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.2.cmml">K</mi><mn id="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.3" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S1.I1.i2.p1.4.m4.1.1.1.1.3" stretchy="false" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.4.m4.1b"><apply id="S1.I1.i2.p1.4.m4.1.1.cmml" xref="S1.I1.i2.p1.4.m4.1.1"><times id="S1.I1.i2.p1.4.m4.1.1.2.cmml" xref="S1.I1.i2.p1.4.m4.1.1.2"></times><ci id="S1.I1.i2.p1.4.m4.1.1.3.cmml" xref="S1.I1.i2.p1.4.m4.1.1.3">𝑂</ci><apply id="S1.I1.i2.p1.4.m4.1.1.1.1.1.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1"><plus id="S1.I1.i2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.1"></plus><apply id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2"><times id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.1"></times><ci id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.2">𝐿</ci><apply id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3"><log id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.1.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.1"></log><ci id="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.2.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.2.3.2">𝐿</ci></apply></apply><apply id="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.3">superscript</csymbol><ci id="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.2">𝐾</ci><cn id="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.3.cmml" type="integer" xref="S1.I1.i2.p1.4.m4.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.4.m4.1c">O(L\log L+K^{2})</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.4.m4.1d">italic_O ( italic_L roman_log italic_L + italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>
with a cache size requirement of
<math alttext="O(K)" class="ltx_Math" display="inline" id="S1.I1.i2.p1.5.m5.1"><semantics id="S1.I1.i2.p1.5.m5.1a"><mrow id="S1.I1.i2.p1.5.m5.1.2" xref="S1.I1.i2.p1.5.m5.1.2.cmml"><mi id="S1.I1.i2.p1.5.m5.1.2.2" xref="S1.I1.i2.p1.5.m5.1.2.2.cmml">O</mi><mo id="S1.I1.i2.p1.5.m5.1.2.1" xref="S1.I1.i2.p1.5.m5.1.2.1.cmml">⁢</mo><mrow id="S1.I1.i2.p1.5.m5.1.2.3.2" xref="S1.I1.i2.p1.5.m5.1.2.cmml"><mo id="S1.I1.i2.p1.5.m5.1.2.3.2.1" stretchy="false" xref="S1.I1.i2.p1.5.m5.1.2.cmml">(</mo><mi id="S1.I1.i2.p1.5.m5.1.1" xref="S1.I1.i2.p1.5.m5.1.1.cmml">K</mi><mo id="S1.I1.i2.p1.5.m5.1.2.3.2.2" stretchy="false" xref="S1.I1.i2.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.5.m5.1b"><apply id="S1.I1.i2.p1.5.m5.1.2.cmml" xref="S1.I1.i2.p1.5.m5.1.2"><times id="S1.I1.i2.p1.5.m5.1.2.1.cmml" xref="S1.I1.i2.p1.5.m5.1.2.1"></times><ci id="S1.I1.i2.p1.5.m5.1.2.2.cmml" xref="S1.I1.i2.p1.5.m5.1.2.2">𝑂</ci><ci id="S1.I1.i2.p1.5.m5.1.1.cmml" xref="S1.I1.i2.p1.5.m5.1.1">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.5.m5.1c">O(K)</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.5.m5.1d">italic_O ( italic_K )</annotation></semantics></math>. Previously, the best-known requirements for convolutional models were a total generation time bounded by
<math alttext="O(L\log L+LK+K^{2})" class="ltx_Math" display="inline" id="S1.I1.i2.p1.6.m6.1"><semantics id="S1.I1.i2.p1.6.m6.1a"><mrow id="S1.I1.i2.p1.6.m6.1.1" xref="S1.I1.i2.p1.6.m6.1.1.cmml"><mi id="S1.I1.i2.p1.6.m6.1.1.3" xref="S1.I1.i2.p1.6.m6.1.1.3.cmml">O</mi><mo id="S1.I1.i2.p1.6.m6.1.1.2" xref="S1.I1.i2.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S1.I1.i2.p1.6.m6.1.1.1.1" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.cmml"><mo id="S1.I1.i2.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S1.I1.i2.p1.6.m6.1.1.1.1.1" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.cmml"><mrow id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.cmml"><mi id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.2" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.2.cmml">L</mi><mo id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.1" lspace="0.167em" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.cmml"><mi id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.1" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3a" lspace="0.167em" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.cmml">⁡</mo><mi id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.2" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.2.cmml">L</mi></mrow></mrow><mo id="S1.I1.i2.p1.6.m6.1.1.1.1.1.1" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.1.cmml">+</mo><mrow id="S1.I1.i2.p1.6.m6.1.1.1.1.1.3" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.cmml"><mi id="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.2" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.2.cmml">L</mi><mo id="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.1" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.3" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.3.cmml">K</mi></mrow><mo id="S1.I1.i2.p1.6.m6.1.1.1.1.1.1a" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.1.cmml">+</mo><msup id="S1.I1.i2.p1.6.m6.1.1.1.1.1.4" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.cmml"><mi id="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.2" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.2.cmml">K</mi><mn id="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.3" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.3.cmml">2</mn></msup></mrow><mo id="S1.I1.i2.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.6.m6.1b"><apply id="S1.I1.i2.p1.6.m6.1.1.cmml" xref="S1.I1.i2.p1.6.m6.1.1"><times id="S1.I1.i2.p1.6.m6.1.1.2.cmml" xref="S1.I1.i2.p1.6.m6.1.1.2"></times><ci id="S1.I1.i2.p1.6.m6.1.1.3.cmml" xref="S1.I1.i2.p1.6.m6.1.1.3">𝑂</ci><apply id="S1.I1.i2.p1.6.m6.1.1.1.1.1.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1"><plus id="S1.I1.i2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.1"></plus><apply id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2"><times id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.1.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.1"></times><ci id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.2.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.2">𝐿</ci><apply id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3"><log id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.1.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.1"></log><ci id="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.2.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.2.3.2">𝐿</ci></apply></apply><apply id="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.3"><times id="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.1.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.1"></times><ci id="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.2.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.2">𝐿</ci><ci id="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.3.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.3.3">𝐾</ci></apply><apply id="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.1.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.4">superscript</csymbol><ci id="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.2.cmml" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.2">𝐾</ci><cn id="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.3.cmml" type="integer" xref="S1.I1.i2.p1.6.m6.1.1.1.1.1.4.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.6.m6.1c">O(L\log L+LK+K^{2})</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.6.m6.1d">italic_O ( italic_L roman_log italic_L + italic_L italic_K + italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> and a cache size bounded by
<math alttext="O(L)" class="ltx_Math" display="inline" id="S1.I1.i2.p1.7.m7.1"><semantics id="S1.I1.i2.p1.7.m7.1a"><mrow id="S1.I1.i2.p1.7.m7.1.2" xref="S1.I1.i2.p1.7.m7.1.2.cmml"><mi id="S1.I1.i2.p1.7.m7.1.2.2" xref="S1.I1.i2.p1.7.m7.1.2.2.cmml">O</mi><mo id="S1.I1.i2.p1.7.m7.1.2.1" xref="S1.I1.i2.p1.7.m7.1.2.1.cmml">⁢</mo><mrow id="S1.I1.i2.p1.7.m7.1.2.3.2" xref="S1.I1.i2.p1.7.m7.1.2.cmml"><mo id="S1.I1.i2.p1.7.m7.1.2.3.2.1" stretchy="false" xref="S1.I1.i2.p1.7.m7.1.2.cmml">(</mo><mi id="S1.I1.i2.p1.7.m7.1.1" xref="S1.I1.i2.p1.7.m7.1.1.cmml">L</mi><mo id="S1.I1.i2.p1.7.m7.1.2.3.2.2" stretchy="false" xref="S1.I1.i2.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.7.m7.1b"><apply id="S1.I1.i2.p1.7.m7.1.2.cmml" xref="S1.I1.i2.p1.7.m7.1.2"><times id="S1.I1.i2.p1.7.m7.1.2.1.cmml" xref="S1.I1.i2.p1.7.m7.1.2.1"></times><ci id="S1.I1.i2.p1.7.m7.1.2.2.cmml" xref="S1.I1.i2.p1.7.m7.1.2.2">𝑂</ci><ci id="S1.I1.i2.p1.7.m7.1.1.cmml" xref="S1.I1.i2.p1.7.m7.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.7.m7.1c">O(L)</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.7.m7.1d">italic_O ( italic_L )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">Massaroli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib15" title="">2024</a>)</cite>.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The primary distinction between these two settings is that in the latter, we assume K to be smaller than L, which aligns with typical practical scenarios. Importantly, our results pertain to provably exact generation from convolutional models without relying on any approximations. Moreover, our methods are applicable to any convolutional model, regardless of how it was trained.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The following table compares our algorithm with a standard exact implementation of convolution. We also provide a comparison of the time and cache size requirements for exact computation in attention-based models.</p>
</div>
<figure class="ltx_table" id="S1.tab1">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel" id="S1.T1.sf1">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S1.T1.sf1.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S1.T1.sf1.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S1.T1.sf1.3.4.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S1.T1.sf1.3.4.1.2">Runtime</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S1.T1.sf1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S1.T1.sf1.1.1.2">Standard Conv</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T1.sf1.1.1.1"><math alttext="KL" class="ltx_Math" display="inline" id="S1.T1.sf1.1.1.1.m1.1"><semantics id="S1.T1.sf1.1.1.1.m1.1a"><mrow id="S1.T1.sf1.1.1.1.m1.1.1" xref="S1.T1.sf1.1.1.1.m1.1.1.cmml"><mi id="S1.T1.sf1.1.1.1.m1.1.1.2" xref="S1.T1.sf1.1.1.1.m1.1.1.2.cmml">K</mi><mo id="S1.T1.sf1.1.1.1.m1.1.1.1" xref="S1.T1.sf1.1.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.T1.sf1.1.1.1.m1.1.1.3" xref="S1.T1.sf1.1.1.1.m1.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.sf1.1.1.1.m1.1b"><apply id="S1.T1.sf1.1.1.1.m1.1.1.cmml" xref="S1.T1.sf1.1.1.1.m1.1.1"><times id="S1.T1.sf1.1.1.1.m1.1.1.1.cmml" xref="S1.T1.sf1.1.1.1.m1.1.1.1"></times><ci id="S1.T1.sf1.1.1.1.m1.1.1.2.cmml" xref="S1.T1.sf1.1.1.1.m1.1.1.2">𝐾</ci><ci id="S1.T1.sf1.1.1.1.m1.1.1.3.cmml" xref="S1.T1.sf1.1.1.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf1.1.1.1.m1.1c">KL</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf1.1.1.1.m1.1d">italic_K italic_L</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S1.T1.sf1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S1.T1.sf1.2.2.2">Standard Attn.</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T1.sf1.2.2.1"><math alttext="KL" class="ltx_Math" display="inline" id="S1.T1.sf1.2.2.1.m1.1"><semantics id="S1.T1.sf1.2.2.1.m1.1a"><mrow id="S1.T1.sf1.2.2.1.m1.1.1" xref="S1.T1.sf1.2.2.1.m1.1.1.cmml"><mi id="S1.T1.sf1.2.2.1.m1.1.1.2" xref="S1.T1.sf1.2.2.1.m1.1.1.2.cmml">K</mi><mo id="S1.T1.sf1.2.2.1.m1.1.1.1" xref="S1.T1.sf1.2.2.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.T1.sf1.2.2.1.m1.1.1.3" xref="S1.T1.sf1.2.2.1.m1.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.sf1.2.2.1.m1.1b"><apply id="S1.T1.sf1.2.2.1.m1.1.1.cmml" xref="S1.T1.sf1.2.2.1.m1.1.1"><times id="S1.T1.sf1.2.2.1.m1.1.1.1.cmml" xref="S1.T1.sf1.2.2.1.m1.1.1.1"></times><ci id="S1.T1.sf1.2.2.1.m1.1.1.2.cmml" xref="S1.T1.sf1.2.2.1.m1.1.1.2">𝐾</ci><ci id="S1.T1.sf1.2.2.1.m1.1.1.3.cmml" xref="S1.T1.sf1.2.2.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf1.2.2.1.m1.1c">KL</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf1.2.2.1.m1.1d">italic_K italic_L</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S1.T1.sf1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S1.T1.sf1.3.3.2">FutureFill (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S1.T1.sf1.3.3.1"><math alttext="K\sqrt{L}\log L" class="ltx_Math" display="inline" id="S1.T1.sf1.3.3.1.m1.1"><semantics id="S1.T1.sf1.3.3.1.m1.1a"><mrow id="S1.T1.sf1.3.3.1.m1.1.1" xref="S1.T1.sf1.3.3.1.m1.1.1.cmml"><mi id="S1.T1.sf1.3.3.1.m1.1.1.2" xref="S1.T1.sf1.3.3.1.m1.1.1.2.cmml">K</mi><mo id="S1.T1.sf1.3.3.1.m1.1.1.1" xref="S1.T1.sf1.3.3.1.m1.1.1.1.cmml">⁢</mo><msqrt id="S1.T1.sf1.3.3.1.m1.1.1.3" xref="S1.T1.sf1.3.3.1.m1.1.1.3.cmml"><mi id="S1.T1.sf1.3.3.1.m1.1.1.3.2" xref="S1.T1.sf1.3.3.1.m1.1.1.3.2.cmml">L</mi></msqrt><mo id="S1.T1.sf1.3.3.1.m1.1.1.1a" lspace="0.167em" xref="S1.T1.sf1.3.3.1.m1.1.1.1.cmml">⁢</mo><mrow id="S1.T1.sf1.3.3.1.m1.1.1.4" xref="S1.T1.sf1.3.3.1.m1.1.1.4.cmml"><mi id="S1.T1.sf1.3.3.1.m1.1.1.4.1" xref="S1.T1.sf1.3.3.1.m1.1.1.4.1.cmml">log</mi><mo id="S1.T1.sf1.3.3.1.m1.1.1.4a" lspace="0.167em" xref="S1.T1.sf1.3.3.1.m1.1.1.4.cmml">⁡</mo><mi id="S1.T1.sf1.3.3.1.m1.1.1.4.2" xref="S1.T1.sf1.3.3.1.m1.1.1.4.2.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.sf1.3.3.1.m1.1b"><apply id="S1.T1.sf1.3.3.1.m1.1.1.cmml" xref="S1.T1.sf1.3.3.1.m1.1.1"><times id="S1.T1.sf1.3.3.1.m1.1.1.1.cmml" xref="S1.T1.sf1.3.3.1.m1.1.1.1"></times><ci id="S1.T1.sf1.3.3.1.m1.1.1.2.cmml" xref="S1.T1.sf1.3.3.1.m1.1.1.2">𝐾</ci><apply id="S1.T1.sf1.3.3.1.m1.1.1.3.cmml" xref="S1.T1.sf1.3.3.1.m1.1.1.3"><root id="S1.T1.sf1.3.3.1.m1.1.1.3a.cmml" xref="S1.T1.sf1.3.3.1.m1.1.1.3"></root><ci id="S1.T1.sf1.3.3.1.m1.1.1.3.2.cmml" xref="S1.T1.sf1.3.3.1.m1.1.1.3.2">𝐿</ci></apply><apply id="S1.T1.sf1.3.3.1.m1.1.1.4.cmml" xref="S1.T1.sf1.3.3.1.m1.1.1.4"><log id="S1.T1.sf1.3.3.1.m1.1.1.4.1.cmml" xref="S1.T1.sf1.3.3.1.m1.1.1.4.1"></log><ci id="S1.T1.sf1.3.3.1.m1.1.1.4.2.cmml" xref="S1.T1.sf1.3.3.1.m1.1.1.4.2">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf1.3.3.1.m1.1c">K\sqrt{L}\log L</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf1.3.3.1.m1.1d">italic_K square-root start_ARG italic_L end_ARG roman_log italic_L</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(a) </span>Comparison for generating <math alttext="K" class="ltx_Math" display="inline" id="S1.T1.sf1.7.m1.1"><semantics id="S1.T1.sf1.7.m1.1b"><mi id="S1.T1.sf1.7.m1.1.1" xref="S1.T1.sf1.7.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.T1.sf1.7.m1.1c"><ci id="S1.T1.sf1.7.m1.1.1.cmml" xref="S1.T1.sf1.7.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf1.7.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf1.7.m1.1e">italic_K</annotation></semantics></math> tokens from scratch with context length <math alttext="L" class="ltx_Math" display="inline" id="S1.T1.sf1.8.m2.1"><semantics id="S1.T1.sf1.8.m2.1b"><mi id="S1.T1.sf1.8.m2.1.1" xref="S1.T1.sf1.8.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S1.T1.sf1.8.m2.1c"><ci id="S1.T1.sf1.8.m2.1.1.cmml" xref="S1.T1.sf1.8.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf1.8.m2.1d">L</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf1.8.m2.1e">italic_L</annotation></semantics></math>, runtime is in asymptotic notation, i.e. <math alttext="O(\cdot)" class="ltx_Math" display="inline" id="S1.T1.sf1.9.m3.1"><semantics id="S1.T1.sf1.9.m3.1b"><mrow id="S1.T1.sf1.9.m3.1.2" xref="S1.T1.sf1.9.m3.1.2.cmml"><mi id="S1.T1.sf1.9.m3.1.2.2" xref="S1.T1.sf1.9.m3.1.2.2.cmml">O</mi><mo id="S1.T1.sf1.9.m3.1.2.1" xref="S1.T1.sf1.9.m3.1.2.1.cmml">⁢</mo><mrow id="S1.T1.sf1.9.m3.1.2.3.2" xref="S1.T1.sf1.9.m3.1.2.cmml"><mo id="S1.T1.sf1.9.m3.1.2.3.2.1" stretchy="false" xref="S1.T1.sf1.9.m3.1.2.cmml">(</mo><mo id="S1.T1.sf1.9.m3.1.1" lspace="0em" rspace="0em" xref="S1.T1.sf1.9.m3.1.1.cmml">⋅</mo><mo id="S1.T1.sf1.9.m3.1.2.3.2.2" stretchy="false" xref="S1.T1.sf1.9.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.sf1.9.m3.1c"><apply id="S1.T1.sf1.9.m3.1.2.cmml" xref="S1.T1.sf1.9.m3.1.2"><times id="S1.T1.sf1.9.m3.1.2.1.cmml" xref="S1.T1.sf1.9.m3.1.2.1"></times><ci id="S1.T1.sf1.9.m3.1.2.2.cmml" xref="S1.T1.sf1.9.m3.1.2.2">𝑂</ci><ci id="S1.T1.sf1.9.m3.1.1.cmml" xref="S1.T1.sf1.9.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf1.9.m3.1d">O(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf1.9.m3.1e">italic_O ( ⋅ )</annotation></semantics></math> is omitted for brevity. </figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S1.T1.sf2">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S1.T1.sf2.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S1.T1.sf2.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S1.T1.sf2.6.7.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S1.T1.sf2.6.7.1.2">Runtime</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S1.T1.sf2.6.7.1.3">Cache-size</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S1.T1.sf2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S1.T1.sf2.2.2.3">Standard Conv</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T1.sf2.1.1.1"><math alttext="LK+L\log L+K^{2}" class="ltx_Math" display="inline" id="S1.T1.sf2.1.1.1.m1.1"><semantics id="S1.T1.sf2.1.1.1.m1.1a"><mrow id="S1.T1.sf2.1.1.1.m1.1.1" xref="S1.T1.sf2.1.1.1.m1.1.1.cmml"><mrow id="S1.T1.sf2.1.1.1.m1.1.1.2" xref="S1.T1.sf2.1.1.1.m1.1.1.2.cmml"><mi id="S1.T1.sf2.1.1.1.m1.1.1.2.2" xref="S1.T1.sf2.1.1.1.m1.1.1.2.2.cmml">L</mi><mo id="S1.T1.sf2.1.1.1.m1.1.1.2.1" xref="S1.T1.sf2.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S1.T1.sf2.1.1.1.m1.1.1.2.3" xref="S1.T1.sf2.1.1.1.m1.1.1.2.3.cmml">K</mi></mrow><mo id="S1.T1.sf2.1.1.1.m1.1.1.1" xref="S1.T1.sf2.1.1.1.m1.1.1.1.cmml">+</mo><mrow id="S1.T1.sf2.1.1.1.m1.1.1.3" xref="S1.T1.sf2.1.1.1.m1.1.1.3.cmml"><mi id="S1.T1.sf2.1.1.1.m1.1.1.3.2" xref="S1.T1.sf2.1.1.1.m1.1.1.3.2.cmml">L</mi><mo id="S1.T1.sf2.1.1.1.m1.1.1.3.1" lspace="0.167em" xref="S1.T1.sf2.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mrow id="S1.T1.sf2.1.1.1.m1.1.1.3.3" xref="S1.T1.sf2.1.1.1.m1.1.1.3.3.cmml"><mi id="S1.T1.sf2.1.1.1.m1.1.1.3.3.1" xref="S1.T1.sf2.1.1.1.m1.1.1.3.3.1.cmml">log</mi><mo id="S1.T1.sf2.1.1.1.m1.1.1.3.3a" lspace="0.167em" xref="S1.T1.sf2.1.1.1.m1.1.1.3.3.cmml">⁡</mo><mi id="S1.T1.sf2.1.1.1.m1.1.1.3.3.2" xref="S1.T1.sf2.1.1.1.m1.1.1.3.3.2.cmml">L</mi></mrow></mrow><mo id="S1.T1.sf2.1.1.1.m1.1.1.1a" xref="S1.T1.sf2.1.1.1.m1.1.1.1.cmml">+</mo><msup id="S1.T1.sf2.1.1.1.m1.1.1.4" xref="S1.T1.sf2.1.1.1.m1.1.1.4.cmml"><mi id="S1.T1.sf2.1.1.1.m1.1.1.4.2" xref="S1.T1.sf2.1.1.1.m1.1.1.4.2.cmml">K</mi><mn id="S1.T1.sf2.1.1.1.m1.1.1.4.3" xref="S1.T1.sf2.1.1.1.m1.1.1.4.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.sf2.1.1.1.m1.1b"><apply id="S1.T1.sf2.1.1.1.m1.1.1.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1"><plus id="S1.T1.sf2.1.1.1.m1.1.1.1.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.1"></plus><apply id="S1.T1.sf2.1.1.1.m1.1.1.2.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.2"><times id="S1.T1.sf2.1.1.1.m1.1.1.2.1.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.2.1"></times><ci id="S1.T1.sf2.1.1.1.m1.1.1.2.2.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.2.2">𝐿</ci><ci id="S1.T1.sf2.1.1.1.m1.1.1.2.3.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.2.3">𝐾</ci></apply><apply id="S1.T1.sf2.1.1.1.m1.1.1.3.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.3"><times id="S1.T1.sf2.1.1.1.m1.1.1.3.1.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.3.1"></times><ci id="S1.T1.sf2.1.1.1.m1.1.1.3.2.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.3.2">𝐿</ci><apply id="S1.T1.sf2.1.1.1.m1.1.1.3.3.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.3.3"><log id="S1.T1.sf2.1.1.1.m1.1.1.3.3.1.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.3.3.1"></log><ci id="S1.T1.sf2.1.1.1.m1.1.1.3.3.2.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.3.3.2">𝐿</ci></apply></apply><apply id="S1.T1.sf2.1.1.1.m1.1.1.4.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S1.T1.sf2.1.1.1.m1.1.1.4.1.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.4">superscript</csymbol><ci id="S1.T1.sf2.1.1.1.m1.1.1.4.2.cmml" xref="S1.T1.sf2.1.1.1.m1.1.1.4.2">𝐾</ci><cn id="S1.T1.sf2.1.1.1.m1.1.1.4.3.cmml" type="integer" xref="S1.T1.sf2.1.1.1.m1.1.1.4.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf2.1.1.1.m1.1c">LK+L\log L+K^{2}</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf2.1.1.1.m1.1d">italic_L italic_K + italic_L roman_log italic_L + italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T1.sf2.2.2.2"><math alttext="L" class="ltx_Math" display="inline" id="S1.T1.sf2.2.2.2.m1.1"><semantics id="S1.T1.sf2.2.2.2.m1.1a"><mi id="S1.T1.sf2.2.2.2.m1.1.1" xref="S1.T1.sf2.2.2.2.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S1.T1.sf2.2.2.2.m1.1b"><ci id="S1.T1.sf2.2.2.2.m1.1.1.cmml" xref="S1.T1.sf2.2.2.2.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf2.2.2.2.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf2.2.2.2.m1.1d">italic_L</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S1.T1.sf2.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S1.T1.sf2.4.4.3">Standard Attn.</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T1.sf2.3.3.1"><math alttext="L^{2}+KL" class="ltx_Math" display="inline" id="S1.T1.sf2.3.3.1.m1.1"><semantics id="S1.T1.sf2.3.3.1.m1.1a"><mrow id="S1.T1.sf2.3.3.1.m1.1.1" xref="S1.T1.sf2.3.3.1.m1.1.1.cmml"><msup id="S1.T1.sf2.3.3.1.m1.1.1.2" xref="S1.T1.sf2.3.3.1.m1.1.1.2.cmml"><mi id="S1.T1.sf2.3.3.1.m1.1.1.2.2" xref="S1.T1.sf2.3.3.1.m1.1.1.2.2.cmml">L</mi><mn id="S1.T1.sf2.3.3.1.m1.1.1.2.3" xref="S1.T1.sf2.3.3.1.m1.1.1.2.3.cmml">2</mn></msup><mo id="S1.T1.sf2.3.3.1.m1.1.1.1" xref="S1.T1.sf2.3.3.1.m1.1.1.1.cmml">+</mo><mrow id="S1.T1.sf2.3.3.1.m1.1.1.3" xref="S1.T1.sf2.3.3.1.m1.1.1.3.cmml"><mi id="S1.T1.sf2.3.3.1.m1.1.1.3.2" xref="S1.T1.sf2.3.3.1.m1.1.1.3.2.cmml">K</mi><mo id="S1.T1.sf2.3.3.1.m1.1.1.3.1" xref="S1.T1.sf2.3.3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S1.T1.sf2.3.3.1.m1.1.1.3.3" xref="S1.T1.sf2.3.3.1.m1.1.1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.sf2.3.3.1.m1.1b"><apply id="S1.T1.sf2.3.3.1.m1.1.1.cmml" xref="S1.T1.sf2.3.3.1.m1.1.1"><plus id="S1.T1.sf2.3.3.1.m1.1.1.1.cmml" xref="S1.T1.sf2.3.3.1.m1.1.1.1"></plus><apply id="S1.T1.sf2.3.3.1.m1.1.1.2.cmml" xref="S1.T1.sf2.3.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S1.T1.sf2.3.3.1.m1.1.1.2.1.cmml" xref="S1.T1.sf2.3.3.1.m1.1.1.2">superscript</csymbol><ci id="S1.T1.sf2.3.3.1.m1.1.1.2.2.cmml" xref="S1.T1.sf2.3.3.1.m1.1.1.2.2">𝐿</ci><cn id="S1.T1.sf2.3.3.1.m1.1.1.2.3.cmml" type="integer" xref="S1.T1.sf2.3.3.1.m1.1.1.2.3">2</cn></apply><apply id="S1.T1.sf2.3.3.1.m1.1.1.3.cmml" xref="S1.T1.sf2.3.3.1.m1.1.1.3"><times id="S1.T1.sf2.3.3.1.m1.1.1.3.1.cmml" xref="S1.T1.sf2.3.3.1.m1.1.1.3.1"></times><ci id="S1.T1.sf2.3.3.1.m1.1.1.3.2.cmml" xref="S1.T1.sf2.3.3.1.m1.1.1.3.2">𝐾</ci><ci id="S1.T1.sf2.3.3.1.m1.1.1.3.3.cmml" xref="S1.T1.sf2.3.3.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf2.3.3.1.m1.1c">L^{2}+KL</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf2.3.3.1.m1.1d">italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_K italic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T1.sf2.4.4.2"><math alttext="L" class="ltx_Math" display="inline" id="S1.T1.sf2.4.4.2.m1.1"><semantics id="S1.T1.sf2.4.4.2.m1.1a"><mi id="S1.T1.sf2.4.4.2.m1.1.1" xref="S1.T1.sf2.4.4.2.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S1.T1.sf2.4.4.2.m1.1b"><ci id="S1.T1.sf2.4.4.2.m1.1.1.cmml" xref="S1.T1.sf2.4.4.2.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf2.4.4.2.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf2.4.4.2.m1.1d">italic_L</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S1.T1.sf2.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S1.T1.sf2.6.6.3">FutureFill (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S1.T1.sf2.5.5.1"><math alttext="L\log L+K^{2}" class="ltx_Math" display="inline" id="S1.T1.sf2.5.5.1.m1.1"><semantics id="S1.T1.sf2.5.5.1.m1.1a"><mrow id="S1.T1.sf2.5.5.1.m1.1.1" xref="S1.T1.sf2.5.5.1.m1.1.1.cmml"><mrow id="S1.T1.sf2.5.5.1.m1.1.1.2" xref="S1.T1.sf2.5.5.1.m1.1.1.2.cmml"><mi id="S1.T1.sf2.5.5.1.m1.1.1.2.2" xref="S1.T1.sf2.5.5.1.m1.1.1.2.2.cmml">L</mi><mo id="S1.T1.sf2.5.5.1.m1.1.1.2.1" lspace="0.167em" xref="S1.T1.sf2.5.5.1.m1.1.1.2.1.cmml">⁢</mo><mrow id="S1.T1.sf2.5.5.1.m1.1.1.2.3" xref="S1.T1.sf2.5.5.1.m1.1.1.2.3.cmml"><mi id="S1.T1.sf2.5.5.1.m1.1.1.2.3.1" xref="S1.T1.sf2.5.5.1.m1.1.1.2.3.1.cmml">log</mi><mo id="S1.T1.sf2.5.5.1.m1.1.1.2.3a" lspace="0.167em" xref="S1.T1.sf2.5.5.1.m1.1.1.2.3.cmml">⁡</mo><mi id="S1.T1.sf2.5.5.1.m1.1.1.2.3.2" xref="S1.T1.sf2.5.5.1.m1.1.1.2.3.2.cmml">L</mi></mrow></mrow><mo id="S1.T1.sf2.5.5.1.m1.1.1.1" xref="S1.T1.sf2.5.5.1.m1.1.1.1.cmml">+</mo><msup id="S1.T1.sf2.5.5.1.m1.1.1.3" xref="S1.T1.sf2.5.5.1.m1.1.1.3.cmml"><mi id="S1.T1.sf2.5.5.1.m1.1.1.3.2" xref="S1.T1.sf2.5.5.1.m1.1.1.3.2.cmml">K</mi><mn id="S1.T1.sf2.5.5.1.m1.1.1.3.3" xref="S1.T1.sf2.5.5.1.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.sf2.5.5.1.m1.1b"><apply id="S1.T1.sf2.5.5.1.m1.1.1.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1"><plus id="S1.T1.sf2.5.5.1.m1.1.1.1.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1.1"></plus><apply id="S1.T1.sf2.5.5.1.m1.1.1.2.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1.2"><times id="S1.T1.sf2.5.5.1.m1.1.1.2.1.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1.2.1"></times><ci id="S1.T1.sf2.5.5.1.m1.1.1.2.2.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1.2.2">𝐿</ci><apply id="S1.T1.sf2.5.5.1.m1.1.1.2.3.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1.2.3"><log id="S1.T1.sf2.5.5.1.m1.1.1.2.3.1.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1.2.3.1"></log><ci id="S1.T1.sf2.5.5.1.m1.1.1.2.3.2.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1.2.3.2">𝐿</ci></apply></apply><apply id="S1.T1.sf2.5.5.1.m1.1.1.3.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S1.T1.sf2.5.5.1.m1.1.1.3.1.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1.3">superscript</csymbol><ci id="S1.T1.sf2.5.5.1.m1.1.1.3.2.cmml" xref="S1.T1.sf2.5.5.1.m1.1.1.3.2">𝐾</ci><cn id="S1.T1.sf2.5.5.1.m1.1.1.3.3.cmml" type="integer" xref="S1.T1.sf2.5.5.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf2.5.5.1.m1.1c">L\log L+K^{2}</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf2.5.5.1.m1.1d">italic_L roman_log italic_L + italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S1.T1.sf2.6.6.2"><math alttext="K" class="ltx_Math" display="inline" id="S1.T1.sf2.6.6.2.m1.1"><semantics id="S1.T1.sf2.6.6.2.m1.1a"><mi id="S1.T1.sf2.6.6.2.m1.1.1" xref="S1.T1.sf2.6.6.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.T1.sf2.6.6.2.m1.1b"><ci id="S1.T1.sf2.6.6.2.m1.1.1.cmml" xref="S1.T1.sf2.6.6.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf2.6.6.2.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf2.6.6.2.m1.1d">italic_K</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(b) </span>Comparison for generating <math alttext="K" class="ltx_Math" display="inline" id="S1.T1.sf2.10.m1.1"><semantics id="S1.T1.sf2.10.m1.1b"><mi id="S1.T1.sf2.10.m1.1.1" xref="S1.T1.sf2.10.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.T1.sf2.10.m1.1c"><ci id="S1.T1.sf2.10.m1.1.1.cmml" xref="S1.T1.sf2.10.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf2.10.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf2.10.m1.1e">italic_K</annotation></semantics></math> tokens starting from a prompt of length <math alttext="L" class="ltx_Math" display="inline" id="S1.T1.sf2.11.m2.1"><semantics id="S1.T1.sf2.11.m2.1b"><mi id="S1.T1.sf2.11.m2.1.1" xref="S1.T1.sf2.11.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S1.T1.sf2.11.m2.1c"><ci id="S1.T1.sf2.11.m2.1.1.cmml" xref="S1.T1.sf2.11.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf2.11.m2.1d">L</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf2.11.m2.1e">italic_L</annotation></semantics></math>, runtime and cache-size are in asymptotic notation, i.e. <math alttext="O(\cdot)" class="ltx_Math" display="inline" id="S1.T1.sf2.12.m3.1"><semantics id="S1.T1.sf2.12.m3.1b"><mrow id="S1.T1.sf2.12.m3.1.2" xref="S1.T1.sf2.12.m3.1.2.cmml"><mi id="S1.T1.sf2.12.m3.1.2.2" xref="S1.T1.sf2.12.m3.1.2.2.cmml">O</mi><mo id="S1.T1.sf2.12.m3.1.2.1" xref="S1.T1.sf2.12.m3.1.2.1.cmml">⁢</mo><mrow id="S1.T1.sf2.12.m3.1.2.3.2" xref="S1.T1.sf2.12.m3.1.2.cmml"><mo id="S1.T1.sf2.12.m3.1.2.3.2.1" stretchy="false" xref="S1.T1.sf2.12.m3.1.2.cmml">(</mo><mo id="S1.T1.sf2.12.m3.1.1" lspace="0em" rspace="0em" xref="S1.T1.sf2.12.m3.1.1.cmml">⋅</mo><mo id="S1.T1.sf2.12.m3.1.2.3.2.2" stretchy="false" xref="S1.T1.sf2.12.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.sf2.12.m3.1c"><apply id="S1.T1.sf2.12.m3.1.2.cmml" xref="S1.T1.sf2.12.m3.1.2"><times id="S1.T1.sf2.12.m3.1.2.1.cmml" xref="S1.T1.sf2.12.m3.1.2.1"></times><ci id="S1.T1.sf2.12.m3.1.2.2.cmml" xref="S1.T1.sf2.12.m3.1.2.2">𝑂</ci><ci id="S1.T1.sf2.12.m3.1.1.cmml" xref="S1.T1.sf2.12.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.sf2.12.m3.1d">O(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S1.T1.sf2.12.m3.1e">italic_O ( ⋅ )</annotation></semantics></math> is omitted for brevity.</figcaption>
</figure>
</div>
</div>
</figure>
<section class="ltx_subsection" id="S1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Related Work</h3>
<section class="ltx_paragraph" id="S1.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">State space models and convolutional sequence prediction.</h4>
<div class="ltx_para ltx_noindent" id="S1.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S1.SS1.SSS0.Px1.p1.1">Recurrent neural networks have been revisited in the recent deep learning literature for sequential prediction in the form of state space models (SSM), many of whom can be parameterized as convolutional models.
<cite class="ltx_cite ltx_citemacro_cite">Gu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib6" title="">2020</a>)</cite> propose the HiPPO framework for continuous-time memorization, and shows that with a special class of system matrices <math alttext="A" class="ltx_Math" display="inline" id="S1.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S1.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S1.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S1.SS1.SSS0.Px1.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS0.Px1.p1.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS0.Px1.p1.1.m1.1d">italic_A</annotation></semantics></math> (HiPPO matrices), SSMs have the capacity for long-range memory. Later work <cite class="ltx_cite ltx_citemacro_cite">Gu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib8" title="">2021b</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib7" title="">a</a>); Gupta et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib9" title="">2022</a>); Smith et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib21" title="">2023</a>)</cite> focus on removing nonlinearities and devising computationally efficient methods that are also numerically stable. To improve the performance of SSMs on language modeling tasks <cite class="ltx_cite ltx_citemacro_cite">Dao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib2" title="">2022</a>)</cite> propose architectural changes as well as faster FFT algorithms with better hardware utilization, to close the speed gap between SSMs and Transformers.
Further investigation in <cite class="ltx_cite ltx_citemacro_cite">Orvieto et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib17" title="">2023</a>)</cite> shows that training SSM is brittle in terms of various hyperparameters. Various convolutional models have been proposed for sequence modelling, see e.g. <cite class="ltx_cite ltx_citemacro_cite">Fu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib4" title="">2023</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib14" title="">2022</a>); Shi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib19" title="">2023a</a>)</cite>.
These papers parameterize the convolution kernels with specific structures.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S1.SS1.SSS0.Px1.p2.1">The Hyena architecture was proposed in <cite class="ltx_cite ltx_citemacro_cite">Poli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib18" title="">2023</a>)</cite> and distilling it into a SSM was studied in <cite class="ltx_cite ltx_citemacro_cite">Massaroli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib15" title="">2024</a>)</cite>. Other studies in convolutional models include LongConv <cite class="ltx_cite ltx_citemacro_cite">Fu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib4" title="">2023</a>)</cite> and SGConv <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib14" title="">2022</a>)</cite> architectures, as well as multi-resolution convolutional models <cite class="ltx_cite ltx_citemacro_cite">Shi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib20" title="">2023b</a>)</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S1.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Spectral filtering.</h4>
<div class="ltx_para ltx_noindent" id="S1.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S1.SS1.SSS0.Px2.p1.1">A promising technique for learning in linear dynamical systems with long memory is called spectral filtering put forth in <cite class="ltx_cite ltx_citemacro_cite">Hazan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib11" title="">2017</a>)</cite>. This work studies online prediction of the sequence of observations <math alttext="y_{t}" class="ltx_Math" display="inline" id="S1.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S1.SS1.SSS0.Px2.p1.1.m1.1a"><msub id="S1.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S1.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S1.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S1.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">y</mi><mi id="S1.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S1.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S1.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S1.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S1.SS1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S1.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S1.SS1.SSS0.Px2.p1.1.m1.1.1.2">𝑦</ci><ci id="S1.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S1.SS1.SSS0.Px2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS0.Px2.p1.1.m1.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS0.Px2.p1.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and the goal is to predict as well as the best symmetric LDS using past inputs and observations. Directly learning the dynamics is a non-convex optimization problem, and spectral filtering is developed as an improper learning technique with an efficient, polynomial-time algorithm and near-optimal regret guarantees. Different from regression-based methods that aim to identify the system dynamics, spectral filtering’s guarantee does not depend on the stability of the underlying system, and is the first method to obtain condition number-free regret guarantees for the MIMO setting. Extension to asymmetric dynamical systems was further studied in <cite class="ltx_cite ltx_citemacro_cite">Hazan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib12" title="">2018</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.SS1.SSS0.Px2.p2">
<p class="ltx_p" id="S1.SS1.SSS0.Px2.p2.1">Spectral filtering is particularly relevant to this study since it is a convolutional model with fixed filters. Thus, our results immidiately apply to this technique and imply provable regret bounds with guaranteed running time bounds in the online learning model which improve upon state of the art.</p>
</div>
</section>
<section class="ltx_paragraph" id="S1.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Online learning and regret minimization in sequence prediction.</h4>
<div class="ltx_para ltx_noindent" id="S1.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S1.SS1.SSS0.Px3.p1.1">The methodology of online convex optimization, see e.g. <cite class="ltx_cite ltx_citemacro_cite">Hazan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib13" title="">2016</a>)</cite>, applies to sequences prediction naturally. In this setting, a learner iteratively predicts, and suffers a loss according to an adversarially chosen loss function. Since nature is assumed to be adversarial, statistical guarantees are not applicable, and performance is measured in terms of regret, or the difference between the total loss and that of the best algorithm in hindsight from a class of predictors. This is a particulary useful setting for sequential prediction since no assumption about the sequence is made, and it leads to robust methods.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.SS1.SSS0.Px3.p2">
<p class="ltx_p" id="S1.SS1.SSS0.Px3.p2.1">Sequential prediction methods that apply to dynamical systems are more complex as they incorporate the notion of a state. Recently the theory of online convex optimization has been applied to learning in dynamical systems, and in this context, the spectral filtering methodology was devised. See <cite class="ltx_cite ltx_citemacro_cite">Hazan &amp; Singh (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib10" title="">2022</a>)</cite> for an introduction to this area.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Setting</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.9">In <span class="ltx_text ltx_font_bold" id="S2.p1.9.1">sequence prediction</span>, the input is a sequence of tokens denoted <math alttext="u_{1},...,u_{t},..." class="ltx_Math" display="inline" id="S2.p1.1.m1.4"><semantics id="S2.p1.1.m1.4a"><mrow id="S2.p1.1.m1.4.4.2" xref="S2.p1.1.m1.4.4.3.cmml"><msub id="S2.p1.1.m1.3.3.1.1" xref="S2.p1.1.m1.3.3.1.1.cmml"><mi id="S2.p1.1.m1.3.3.1.1.2" xref="S2.p1.1.m1.3.3.1.1.2.cmml">u</mi><mn id="S2.p1.1.m1.3.3.1.1.3" xref="S2.p1.1.m1.3.3.1.1.3.cmml">1</mn></msub><mo id="S2.p1.1.m1.4.4.2.3" xref="S2.p1.1.m1.4.4.3.cmml">,</mo><mi id="S2.p1.1.m1.1.1" mathvariant="normal" xref="S2.p1.1.m1.1.1.cmml">…</mi><mo id="S2.p1.1.m1.4.4.2.4" xref="S2.p1.1.m1.4.4.3.cmml">,</mo><msub id="S2.p1.1.m1.4.4.2.2" xref="S2.p1.1.m1.4.4.2.2.cmml"><mi id="S2.p1.1.m1.4.4.2.2.2" xref="S2.p1.1.m1.4.4.2.2.2.cmml">u</mi><mi id="S2.p1.1.m1.4.4.2.2.3" xref="S2.p1.1.m1.4.4.2.2.3.cmml">t</mi></msub><mo id="S2.p1.1.m1.4.4.2.5" xref="S2.p1.1.m1.4.4.3.cmml">,</mo><mi id="S2.p1.1.m1.2.2" mathvariant="normal" xref="S2.p1.1.m1.2.2.cmml">…</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.4b"><list id="S2.p1.1.m1.4.4.3.cmml" xref="S2.p1.1.m1.4.4.2"><apply id="S2.p1.1.m1.3.3.1.1.cmml" xref="S2.p1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.3.3.1.1.1.cmml" xref="S2.p1.1.m1.3.3.1.1">subscript</csymbol><ci id="S2.p1.1.m1.3.3.1.1.2.cmml" xref="S2.p1.1.m1.3.3.1.1.2">𝑢</ci><cn id="S2.p1.1.m1.3.3.1.1.3.cmml" type="integer" xref="S2.p1.1.m1.3.3.1.1.3">1</cn></apply><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">…</ci><apply id="S2.p1.1.m1.4.4.2.2.cmml" xref="S2.p1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.4.4.2.2.1.cmml" xref="S2.p1.1.m1.4.4.2.2">subscript</csymbol><ci id="S2.p1.1.m1.4.4.2.2.2.cmml" xref="S2.p1.1.m1.4.4.2.2.2">𝑢</ci><ci id="S2.p1.1.m1.4.4.2.2.3.cmml" xref="S2.p1.1.m1.4.4.2.2.3">𝑡</ci></apply><ci id="S2.p1.1.m1.2.2.cmml" xref="S2.p1.1.m1.2.2">…</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.4c">u_{1},...,u_{t},...</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.4d">italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , …</annotation></semantics></math>, where <math alttext="u_{t}\in\mathbb{R}^{d_{in}}" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mrow id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><msub id="S2.p1.2.m2.1.1.2" xref="S2.p1.2.m2.1.1.2.cmml"><mi id="S2.p1.2.m2.1.1.2.2" xref="S2.p1.2.m2.1.1.2.2.cmml">u</mi><mi id="S2.p1.2.m2.1.1.2.3" xref="S2.p1.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S2.p1.2.m2.1.1.1" xref="S2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S2.p1.2.m2.1.1.3" xref="S2.p1.2.m2.1.1.3.cmml"><mi id="S2.p1.2.m2.1.1.3.2" xref="S2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><msub id="S2.p1.2.m2.1.1.3.3" xref="S2.p1.2.m2.1.1.3.3.cmml"><mi id="S2.p1.2.m2.1.1.3.3.2" xref="S2.p1.2.m2.1.1.3.3.2.cmml">d</mi><mrow id="S2.p1.2.m2.1.1.3.3.3" xref="S2.p1.2.m2.1.1.3.3.3.cmml"><mi id="S2.p1.2.m2.1.1.3.3.3.2" xref="S2.p1.2.m2.1.1.3.3.3.2.cmml">i</mi><mo id="S2.p1.2.m2.1.1.3.3.3.1" xref="S2.p1.2.m2.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.p1.2.m2.1.1.3.3.3.3" xref="S2.p1.2.m2.1.1.3.3.3.3.cmml">n</mi></mrow></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><in id="S2.p1.2.m2.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1"></in><apply id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.2.1.cmml" xref="S2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S2.p1.2.m2.1.1.2.2.cmml" xref="S2.p1.2.m2.1.1.2.2">𝑢</ci><ci id="S2.p1.2.m2.1.1.2.3.cmml" xref="S2.p1.2.m2.1.1.2.3">𝑡</ci></apply><apply id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.3.1.cmml" xref="S2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S2.p1.2.m2.1.1.3.2.cmml" xref="S2.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S2.p1.2.m2.1.1.3.3.cmml" xref="S2.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.3.3.1.cmml" xref="S2.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="S2.p1.2.m2.1.1.3.3.2.cmml" xref="S2.p1.2.m2.1.1.3.3.2">𝑑</ci><apply id="S2.p1.2.m2.1.1.3.3.3.cmml" xref="S2.p1.2.m2.1.1.3.3.3"><times id="S2.p1.2.m2.1.1.3.3.3.1.cmml" xref="S2.p1.2.m2.1.1.3.3.3.1"></times><ci id="S2.p1.2.m2.1.1.3.3.3.2.cmml" xref="S2.p1.2.m2.1.1.3.3.3.2">𝑖</ci><ci id="S2.p1.2.m2.1.1.3.3.3.3.cmml" xref="S2.p1.2.m2.1.1.3.3.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">u_{t}\in\mathbb{R}^{d_{in}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. The predictor’s task is to generates a sequence <math alttext="\hat{y}_{1},...,\hat{y}_{t},..." class="ltx_Math" display="inline" id="S2.p1.3.m3.4"><semantics id="S2.p1.3.m3.4a"><mrow id="S2.p1.3.m3.4.4.2" xref="S2.p1.3.m3.4.4.3.cmml"><msub id="S2.p1.3.m3.3.3.1.1" xref="S2.p1.3.m3.3.3.1.1.cmml"><mover accent="true" id="S2.p1.3.m3.3.3.1.1.2" xref="S2.p1.3.m3.3.3.1.1.2.cmml"><mi id="S2.p1.3.m3.3.3.1.1.2.2" xref="S2.p1.3.m3.3.3.1.1.2.2.cmml">y</mi><mo id="S2.p1.3.m3.3.3.1.1.2.1" xref="S2.p1.3.m3.3.3.1.1.2.1.cmml">^</mo></mover><mn id="S2.p1.3.m3.3.3.1.1.3" xref="S2.p1.3.m3.3.3.1.1.3.cmml">1</mn></msub><mo id="S2.p1.3.m3.4.4.2.3" xref="S2.p1.3.m3.4.4.3.cmml">,</mo><mi id="S2.p1.3.m3.1.1" mathvariant="normal" xref="S2.p1.3.m3.1.1.cmml">…</mi><mo id="S2.p1.3.m3.4.4.2.4" xref="S2.p1.3.m3.4.4.3.cmml">,</mo><msub id="S2.p1.3.m3.4.4.2.2" xref="S2.p1.3.m3.4.4.2.2.cmml"><mover accent="true" id="S2.p1.3.m3.4.4.2.2.2" xref="S2.p1.3.m3.4.4.2.2.2.cmml"><mi id="S2.p1.3.m3.4.4.2.2.2.2" xref="S2.p1.3.m3.4.4.2.2.2.2.cmml">y</mi><mo id="S2.p1.3.m3.4.4.2.2.2.1" xref="S2.p1.3.m3.4.4.2.2.2.1.cmml">^</mo></mover><mi id="S2.p1.3.m3.4.4.2.2.3" xref="S2.p1.3.m3.4.4.2.2.3.cmml">t</mi></msub><mo id="S2.p1.3.m3.4.4.2.5" xref="S2.p1.3.m3.4.4.3.cmml">,</mo><mi id="S2.p1.3.m3.2.2" mathvariant="normal" xref="S2.p1.3.m3.2.2.cmml">…</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.4b"><list id="S2.p1.3.m3.4.4.3.cmml" xref="S2.p1.3.m3.4.4.2"><apply id="S2.p1.3.m3.3.3.1.1.cmml" xref="S2.p1.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.3.3.1.1.1.cmml" xref="S2.p1.3.m3.3.3.1.1">subscript</csymbol><apply id="S2.p1.3.m3.3.3.1.1.2.cmml" xref="S2.p1.3.m3.3.3.1.1.2"><ci id="S2.p1.3.m3.3.3.1.1.2.1.cmml" xref="S2.p1.3.m3.3.3.1.1.2.1">^</ci><ci id="S2.p1.3.m3.3.3.1.1.2.2.cmml" xref="S2.p1.3.m3.3.3.1.1.2.2">𝑦</ci></apply><cn id="S2.p1.3.m3.3.3.1.1.3.cmml" type="integer" xref="S2.p1.3.m3.3.3.1.1.3">1</cn></apply><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">…</ci><apply id="S2.p1.3.m3.4.4.2.2.cmml" xref="S2.p1.3.m3.4.4.2.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.4.4.2.2.1.cmml" xref="S2.p1.3.m3.4.4.2.2">subscript</csymbol><apply id="S2.p1.3.m3.4.4.2.2.2.cmml" xref="S2.p1.3.m3.4.4.2.2.2"><ci id="S2.p1.3.m3.4.4.2.2.2.1.cmml" xref="S2.p1.3.m3.4.4.2.2.2.1">^</ci><ci id="S2.p1.3.m3.4.4.2.2.2.2.cmml" xref="S2.p1.3.m3.4.4.2.2.2.2">𝑦</ci></apply><ci id="S2.p1.3.m3.4.4.2.2.3.cmml" xref="S2.p1.3.m3.4.4.2.2.3">𝑡</ci></apply><ci id="S2.p1.3.m3.2.2.cmml" xref="S2.p1.3.m3.2.2">…</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.4c">\hat{y}_{1},...,\hat{y}_{t},...</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.4d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , …</annotation></semantics></math>, where <math alttext="\hat{y}_{t}\in\mathbb{R}^{d_{out}}" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><mrow id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><msub id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml"><mover accent="true" id="S2.p1.4.m4.1.1.2.2" xref="S2.p1.4.m4.1.1.2.2.cmml"><mi id="S2.p1.4.m4.1.1.2.2.2" xref="S2.p1.4.m4.1.1.2.2.2.cmml">y</mi><mo id="S2.p1.4.m4.1.1.2.2.1" xref="S2.p1.4.m4.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.p1.4.m4.1.1.2.3" xref="S2.p1.4.m4.1.1.2.3.cmml">t</mi></msub><mo id="S2.p1.4.m4.1.1.1" xref="S2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml"><mi id="S2.p1.4.m4.1.1.3.2" xref="S2.p1.4.m4.1.1.3.2.cmml">ℝ</mi><msub id="S2.p1.4.m4.1.1.3.3" xref="S2.p1.4.m4.1.1.3.3.cmml"><mi id="S2.p1.4.m4.1.1.3.3.2" xref="S2.p1.4.m4.1.1.3.3.2.cmml">d</mi><mrow id="S2.p1.4.m4.1.1.3.3.3" xref="S2.p1.4.m4.1.1.3.3.3.cmml"><mi id="S2.p1.4.m4.1.1.3.3.3.2" xref="S2.p1.4.m4.1.1.3.3.3.2.cmml">o</mi><mo id="S2.p1.4.m4.1.1.3.3.3.1" xref="S2.p1.4.m4.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.p1.4.m4.1.1.3.3.3.3" xref="S2.p1.4.m4.1.1.3.3.3.3.cmml">u</mi><mo id="S2.p1.4.m4.1.1.3.3.3.1a" xref="S2.p1.4.m4.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.p1.4.m4.1.1.3.3.3.4" xref="S2.p1.4.m4.1.1.3.3.3.4.cmml">t</mi></mrow></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><in id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1"></in><apply id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.2.1.cmml" xref="S2.p1.4.m4.1.1.2">subscript</csymbol><apply id="S2.p1.4.m4.1.1.2.2.cmml" xref="S2.p1.4.m4.1.1.2.2"><ci id="S2.p1.4.m4.1.1.2.2.1.cmml" xref="S2.p1.4.m4.1.1.2.2.1">^</ci><ci id="S2.p1.4.m4.1.1.2.2.2.cmml" xref="S2.p1.4.m4.1.1.2.2.2">𝑦</ci></apply><ci id="S2.p1.4.m4.1.1.2.3.cmml" xref="S2.p1.4.m4.1.1.2.3">𝑡</ci></apply><apply id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.3.1.cmml" xref="S2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S2.p1.4.m4.1.1.3.2.cmml" xref="S2.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S2.p1.4.m4.1.1.3.3.cmml" xref="S2.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.3.3.1.cmml" xref="S2.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="S2.p1.4.m4.1.1.3.3.2.cmml" xref="S2.p1.4.m4.1.1.3.3.2">𝑑</ci><apply id="S2.p1.4.m4.1.1.3.3.3.cmml" xref="S2.p1.4.m4.1.1.3.3.3"><times id="S2.p1.4.m4.1.1.3.3.3.1.cmml" xref="S2.p1.4.m4.1.1.3.3.3.1"></times><ci id="S2.p1.4.m4.1.1.3.3.3.2.cmml" xref="S2.p1.4.m4.1.1.3.3.3.2">𝑜</ci><ci id="S2.p1.4.m4.1.1.3.3.3.3.cmml" xref="S2.p1.4.m4.1.1.3.3.3.3">𝑢</ci><ci id="S2.p1.4.m4.1.1.3.3.3.4.cmml" xref="S2.p1.4.m4.1.1.3.3.3.4">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\hat{y}_{t}\in\mathbb{R}^{d_{out}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_o italic_u italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is generated after observing <math alttext="u_{1},...,u_{t-1}" class="ltx_Math" display="inline" id="S2.p1.5.m5.3"><semantics id="S2.p1.5.m5.3a"><mrow id="S2.p1.5.m5.3.3.2" xref="S2.p1.5.m5.3.3.3.cmml"><msub id="S2.p1.5.m5.2.2.1.1" xref="S2.p1.5.m5.2.2.1.1.cmml"><mi id="S2.p1.5.m5.2.2.1.1.2" xref="S2.p1.5.m5.2.2.1.1.2.cmml">u</mi><mn id="S2.p1.5.m5.2.2.1.1.3" xref="S2.p1.5.m5.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p1.5.m5.3.3.2.3" xref="S2.p1.5.m5.3.3.3.cmml">,</mo><mi id="S2.p1.5.m5.1.1" mathvariant="normal" xref="S2.p1.5.m5.1.1.cmml">…</mi><mo id="S2.p1.5.m5.3.3.2.4" xref="S2.p1.5.m5.3.3.3.cmml">,</mo><msub id="S2.p1.5.m5.3.3.2.2" xref="S2.p1.5.m5.3.3.2.2.cmml"><mi id="S2.p1.5.m5.3.3.2.2.2" xref="S2.p1.5.m5.3.3.2.2.2.cmml">u</mi><mrow id="S2.p1.5.m5.3.3.2.2.3" xref="S2.p1.5.m5.3.3.2.2.3.cmml"><mi id="S2.p1.5.m5.3.3.2.2.3.2" xref="S2.p1.5.m5.3.3.2.2.3.2.cmml">t</mi><mo id="S2.p1.5.m5.3.3.2.2.3.1" xref="S2.p1.5.m5.3.3.2.2.3.1.cmml">−</mo><mn id="S2.p1.5.m5.3.3.2.2.3.3" xref="S2.p1.5.m5.3.3.2.2.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.3b"><list id="S2.p1.5.m5.3.3.3.cmml" xref="S2.p1.5.m5.3.3.2"><apply id="S2.p1.5.m5.2.2.1.1.cmml" xref="S2.p1.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.2.2.1.1.1.cmml" xref="S2.p1.5.m5.2.2.1.1">subscript</csymbol><ci id="S2.p1.5.m5.2.2.1.1.2.cmml" xref="S2.p1.5.m5.2.2.1.1.2">𝑢</ci><cn id="S2.p1.5.m5.2.2.1.1.3.cmml" type="integer" xref="S2.p1.5.m5.2.2.1.1.3">1</cn></apply><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">…</ci><apply id="S2.p1.5.m5.3.3.2.2.cmml" xref="S2.p1.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S2.p1.5.m5.3.3.2.2.1.cmml" xref="S2.p1.5.m5.3.3.2.2">subscript</csymbol><ci id="S2.p1.5.m5.3.3.2.2.2.cmml" xref="S2.p1.5.m5.3.3.2.2.2">𝑢</ci><apply id="S2.p1.5.m5.3.3.2.2.3.cmml" xref="S2.p1.5.m5.3.3.2.2.3"><minus id="S2.p1.5.m5.3.3.2.2.3.1.cmml" xref="S2.p1.5.m5.3.3.2.2.3.1"></minus><ci id="S2.p1.5.m5.3.3.2.2.3.2.cmml" xref="S2.p1.5.m5.3.3.2.2.3.2">𝑡</ci><cn id="S2.p1.5.m5.3.3.2.2.3.3.cmml" type="integer" xref="S2.p1.5.m5.3.3.2.2.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.3c">u_{1},...,u_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.3d">italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>. The output <math alttext="y_{t}" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><msub id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">y</mi><mi id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝑦</ci><ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is observed after the predictor generates <math alttext="\hat{y}_{t}" class="ltx_Math" display="inline" id="S2.p1.7.m7.1"><semantics id="S2.p1.7.m7.1a"><msub id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><mover accent="true" id="S2.p1.7.m7.1.1.2" xref="S2.p1.7.m7.1.1.2.cmml"><mi id="S2.p1.7.m7.1.1.2.2" xref="S2.p1.7.m7.1.1.2.2.cmml">y</mi><mo id="S2.p1.7.m7.1.1.2.1" xref="S2.p1.7.m7.1.1.2.1.cmml">^</mo></mover><mi id="S2.p1.7.m7.1.1.3" xref="S2.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.1.cmml" xref="S2.p1.7.m7.1.1">subscript</csymbol><apply id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1.2"><ci id="S2.p1.7.m7.1.1.2.1.cmml" xref="S2.p1.7.m7.1.1.2.1">^</ci><ci id="S2.p1.7.m7.1.1.2.2.cmml" xref="S2.p1.7.m7.1.1.2.2">𝑦</ci></apply><ci id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">\hat{y}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m7.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The quality of the prediction is measured by the distance between the predicted and observed outputs according to a loss function <math alttext="\ell_{t}(\hat{y}_{t},y_{t})" class="ltx_Math" display="inline" id="S2.p1.8.m8.2"><semantics id="S2.p1.8.m8.2a"><mrow id="S2.p1.8.m8.2.2" xref="S2.p1.8.m8.2.2.cmml"><msub id="S2.p1.8.m8.2.2.4" xref="S2.p1.8.m8.2.2.4.cmml"><mi id="S2.p1.8.m8.2.2.4.2" mathvariant="normal" xref="S2.p1.8.m8.2.2.4.2.cmml">ℓ</mi><mi id="S2.p1.8.m8.2.2.4.3" xref="S2.p1.8.m8.2.2.4.3.cmml">t</mi></msub><mo id="S2.p1.8.m8.2.2.3" xref="S2.p1.8.m8.2.2.3.cmml">⁢</mo><mrow id="S2.p1.8.m8.2.2.2.2" xref="S2.p1.8.m8.2.2.2.3.cmml"><mo id="S2.p1.8.m8.2.2.2.2.3" stretchy="false" xref="S2.p1.8.m8.2.2.2.3.cmml">(</mo><msub id="S2.p1.8.m8.1.1.1.1.1" xref="S2.p1.8.m8.1.1.1.1.1.cmml"><mover accent="true" id="S2.p1.8.m8.1.1.1.1.1.2" xref="S2.p1.8.m8.1.1.1.1.1.2.cmml"><mi id="S2.p1.8.m8.1.1.1.1.1.2.2" xref="S2.p1.8.m8.1.1.1.1.1.2.2.cmml">y</mi><mo id="S2.p1.8.m8.1.1.1.1.1.2.1" xref="S2.p1.8.m8.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.p1.8.m8.1.1.1.1.1.3" xref="S2.p1.8.m8.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.p1.8.m8.2.2.2.2.4" xref="S2.p1.8.m8.2.2.2.3.cmml">,</mo><msub id="S2.p1.8.m8.2.2.2.2.2" xref="S2.p1.8.m8.2.2.2.2.2.cmml"><mi id="S2.p1.8.m8.2.2.2.2.2.2" xref="S2.p1.8.m8.2.2.2.2.2.2.cmml">y</mi><mi id="S2.p1.8.m8.2.2.2.2.2.3" xref="S2.p1.8.m8.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.p1.8.m8.2.2.2.2.5" stretchy="false" xref="S2.p1.8.m8.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.2b"><apply id="S2.p1.8.m8.2.2.cmml" xref="S2.p1.8.m8.2.2"><times id="S2.p1.8.m8.2.2.3.cmml" xref="S2.p1.8.m8.2.2.3"></times><apply id="S2.p1.8.m8.2.2.4.cmml" xref="S2.p1.8.m8.2.2.4"><csymbol cd="ambiguous" id="S2.p1.8.m8.2.2.4.1.cmml" xref="S2.p1.8.m8.2.2.4">subscript</csymbol><ci id="S2.p1.8.m8.2.2.4.2.cmml" xref="S2.p1.8.m8.2.2.4.2">ℓ</ci><ci id="S2.p1.8.m8.2.2.4.3.cmml" xref="S2.p1.8.m8.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S2.p1.8.m8.2.2.2.3.cmml" xref="S2.p1.8.m8.2.2.2.2"><apply id="S2.p1.8.m8.1.1.1.1.1.cmml" xref="S2.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S2.p1.8.m8.1.1.1.1.1">subscript</csymbol><apply id="S2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S2.p1.8.m8.1.1.1.1.1.2"><ci id="S2.p1.8.m8.1.1.1.1.1.2.1.cmml" xref="S2.p1.8.m8.1.1.1.1.1.2.1">^</ci><ci id="S2.p1.8.m8.1.1.1.1.1.2.2.cmml" xref="S2.p1.8.m8.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="S2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S2.p1.8.m8.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.p1.8.m8.2.2.2.2.2.cmml" xref="S2.p1.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.8.m8.2.2.2.2.2.1.cmml" xref="S2.p1.8.m8.2.2.2.2.2">subscript</csymbol><ci id="S2.p1.8.m8.2.2.2.2.2.2.cmml" xref="S2.p1.8.m8.2.2.2.2.2.2">𝑦</ci><ci id="S2.p1.8.m8.2.2.2.2.2.3.cmml" xref="S2.p1.8.m8.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.2c">\ell_{t}(\hat{y}_{t},y_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m8.2d">roman_ℓ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, for example the mean square error <math alttext="\|\hat{y}_{t}-y_{t}\|^{2}" class="ltx_Math" display="inline" id="S2.p1.9.m9.1"><semantics id="S2.p1.9.m9.1a"><msup id="S2.p1.9.m9.1.1" xref="S2.p1.9.m9.1.1.cmml"><mrow id="S2.p1.9.m9.1.1.1.1" xref="S2.p1.9.m9.1.1.1.2.cmml"><mo id="S2.p1.9.m9.1.1.1.1.2" stretchy="false" xref="S2.p1.9.m9.1.1.1.2.1.cmml">‖</mo><mrow id="S2.p1.9.m9.1.1.1.1.1" xref="S2.p1.9.m9.1.1.1.1.1.cmml"><msub id="S2.p1.9.m9.1.1.1.1.1.2" xref="S2.p1.9.m9.1.1.1.1.1.2.cmml"><mover accent="true" id="S2.p1.9.m9.1.1.1.1.1.2.2" xref="S2.p1.9.m9.1.1.1.1.1.2.2.cmml"><mi id="S2.p1.9.m9.1.1.1.1.1.2.2.2" xref="S2.p1.9.m9.1.1.1.1.1.2.2.2.cmml">y</mi><mo id="S2.p1.9.m9.1.1.1.1.1.2.2.1" xref="S2.p1.9.m9.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.p1.9.m9.1.1.1.1.1.2.3" xref="S2.p1.9.m9.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S2.p1.9.m9.1.1.1.1.1.1" xref="S2.p1.9.m9.1.1.1.1.1.1.cmml">−</mo><msub id="S2.p1.9.m9.1.1.1.1.1.3" xref="S2.p1.9.m9.1.1.1.1.1.3.cmml"><mi id="S2.p1.9.m9.1.1.1.1.1.3.2" xref="S2.p1.9.m9.1.1.1.1.1.3.2.cmml">y</mi><mi id="S2.p1.9.m9.1.1.1.1.1.3.3" xref="S2.p1.9.m9.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.p1.9.m9.1.1.1.1.3" stretchy="false" xref="S2.p1.9.m9.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.p1.9.m9.1.1.3" xref="S2.p1.9.m9.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.p1.9.m9.1b"><apply id="S2.p1.9.m9.1.1.cmml" xref="S2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p1.9.m9.1.1.2.cmml" xref="S2.p1.9.m9.1.1">superscript</csymbol><apply id="S2.p1.9.m9.1.1.1.2.cmml" xref="S2.p1.9.m9.1.1.1.1"><csymbol cd="latexml" id="S2.p1.9.m9.1.1.1.2.1.cmml" xref="S2.p1.9.m9.1.1.1.1.2">norm</csymbol><apply id="S2.p1.9.m9.1.1.1.1.1.cmml" xref="S2.p1.9.m9.1.1.1.1.1"><minus id="S2.p1.9.m9.1.1.1.1.1.1.cmml" xref="S2.p1.9.m9.1.1.1.1.1.1"></minus><apply id="S2.p1.9.m9.1.1.1.1.1.2.cmml" xref="S2.p1.9.m9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p1.9.m9.1.1.1.1.1.2.1.cmml" xref="S2.p1.9.m9.1.1.1.1.1.2">subscript</csymbol><apply id="S2.p1.9.m9.1.1.1.1.1.2.2.cmml" xref="S2.p1.9.m9.1.1.1.1.1.2.2"><ci id="S2.p1.9.m9.1.1.1.1.1.2.2.1.cmml" xref="S2.p1.9.m9.1.1.1.1.1.2.2.1">^</ci><ci id="S2.p1.9.m9.1.1.1.1.1.2.2.2.cmml" xref="S2.p1.9.m9.1.1.1.1.1.2.2.2">𝑦</ci></apply><ci id="S2.p1.9.m9.1.1.1.1.1.2.3.cmml" xref="S2.p1.9.m9.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.p1.9.m9.1.1.1.1.1.3.cmml" xref="S2.p1.9.m9.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p1.9.m9.1.1.1.1.1.3.1.cmml" xref="S2.p1.9.m9.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p1.9.m9.1.1.1.1.1.3.2.cmml" xref="S2.p1.9.m9.1.1.1.1.1.3.2">𝑦</ci><ci id="S2.p1.9.m9.1.1.1.1.1.3.3.cmml" xref="S2.p1.9.m9.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn id="S2.p1.9.m9.1.1.3.cmml" type="integer" xref="S2.p1.9.m9.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m9.1c">\|\hat{y}_{t}-y_{t}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.9.m9.1d">∥ over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.15">For an input sequence <math alttext="\{u_{t}\}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.2.cmml"><mo id="S2.p2.1.m1.1.1.1.2" stretchy="false" xref="S2.p2.1.m1.1.1.2.cmml">{</mo><msub id="S2.p2.1.m1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.2.cmml">u</mi><mi id="S2.p2.1.m1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.p2.1.m1.1.1.1.3" stretchy="false" xref="S2.p2.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><set id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1"><apply id="S2.p2.1.m1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1.2">𝑢</ci><ci id="S2.p2.1.m1.1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.1.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\{u_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">{ italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> we denote by <math alttext="u_{1:t}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><msub id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">u</mi><mrow id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml"><mn id="S2.p2.2.m2.1.1.3.2" xref="S2.p2.2.m2.1.1.3.2.cmml">1</mn><mo id="S2.p2.2.m2.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.2.m2.1.1.3.1.cmml">:</mo><mi id="S2.p2.2.m2.1.1.3.3" xref="S2.p2.2.m2.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝑢</ci><apply id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3"><ci id="S2.p2.2.m2.1.1.3.1.cmml" xref="S2.p2.2.m2.1.1.3.1">:</ci><cn id="S2.p2.2.m2.1.1.3.2.cmml" type="integer" xref="S2.p2.2.m2.1.1.3.2">1</cn><ci id="S2.p2.2.m2.1.1.3.3.cmml" xref="S2.p2.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">u_{1:t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_u start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT</annotation></semantics></math> the sequence of inputs <math alttext="u_{1},...,u_{t}" class="ltx_Math" display="inline" id="S2.p2.3.m3.3"><semantics id="S2.p2.3.m3.3a"><mrow id="S2.p2.3.m3.3.3.2" xref="S2.p2.3.m3.3.3.3.cmml"><msub id="S2.p2.3.m3.2.2.1.1" xref="S2.p2.3.m3.2.2.1.1.cmml"><mi id="S2.p2.3.m3.2.2.1.1.2" xref="S2.p2.3.m3.2.2.1.1.2.cmml">u</mi><mn id="S2.p2.3.m3.2.2.1.1.3" xref="S2.p2.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p2.3.m3.3.3.2.3" xref="S2.p2.3.m3.3.3.3.cmml">,</mo><mi id="S2.p2.3.m3.1.1" mathvariant="normal" xref="S2.p2.3.m3.1.1.cmml">…</mi><mo id="S2.p2.3.m3.3.3.2.4" xref="S2.p2.3.m3.3.3.3.cmml">,</mo><msub id="S2.p2.3.m3.3.3.2.2" xref="S2.p2.3.m3.3.3.2.2.cmml"><mi id="S2.p2.3.m3.3.3.2.2.2" xref="S2.p2.3.m3.3.3.2.2.2.cmml">u</mi><mi id="S2.p2.3.m3.3.3.2.2.3" xref="S2.p2.3.m3.3.3.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.3b"><list id="S2.p2.3.m3.3.3.3.cmml" xref="S2.p2.3.m3.3.3.2"><apply id="S2.p2.3.m3.2.2.1.1.cmml" xref="S2.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.p2.3.m3.2.2.1.1.1.cmml" xref="S2.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S2.p2.3.m3.2.2.1.1.2.cmml" xref="S2.p2.3.m3.2.2.1.1.2">𝑢</ci><cn id="S2.p2.3.m3.2.2.1.1.3.cmml" type="integer" xref="S2.p2.3.m3.2.2.1.1.3">1</cn></apply><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">…</ci><apply id="S2.p2.3.m3.3.3.2.2.cmml" xref="S2.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S2.p2.3.m3.3.3.2.2.1.cmml" xref="S2.p2.3.m3.3.3.2.2">subscript</csymbol><ci id="S2.p2.3.m3.3.3.2.2.2.cmml" xref="S2.p2.3.m3.3.3.2.2.2">𝑢</ci><ci id="S2.p2.3.m3.3.3.2.2.3.cmml" xref="S2.p2.3.m3.3.3.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.3c">u_{1},...,u_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.3d">italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. For any <math alttext="i~{}\leq~{}j" class="ltx_Math" display="inline" id="S2.p2.4.m4.1"><semantics id="S2.p2.4.m4.1a"><mrow id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">i</mi><mo id="S2.p2.4.m4.1.1.1" lspace="0.608em" rspace="0.608em" xref="S2.p2.4.m4.1.1.1.cmml">≤</mo><mi id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><leq id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1.1"></leq><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">𝑖</ci><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">i~{}\leq~{}j</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.1d">italic_i ≤ italic_j</annotation></semantics></math> let <math alttext="u_{i:j}" class="ltx_Math" display="inline" id="S2.p2.5.m5.1"><semantics id="S2.p2.5.m5.1a"><msub id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">u</mi><mrow id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml"><mi id="S2.p2.5.m5.1.1.3.2" xref="S2.p2.5.m5.1.1.3.2.cmml">i</mi><mo id="S2.p2.5.m5.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.5.m5.1.1.3.1.cmml">:</mo><mi id="S2.p2.5.m5.1.1.3.3" xref="S2.p2.5.m5.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">𝑢</ci><apply id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3"><ci id="S2.p2.5.m5.1.1.3.1.cmml" xref="S2.p2.5.m5.1.1.3.1">:</ci><ci id="S2.p2.5.m5.1.1.3.2.cmml" xref="S2.p2.5.m5.1.1.3.2">𝑖</ci><ci id="S2.p2.5.m5.1.1.3.3.cmml" xref="S2.p2.5.m5.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">u_{i:j}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m5.1d">italic_u start_POSTSUBSCRIPT italic_i : italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denote the sub-sequence <math alttext="u_{i},u_{i+1},\ldots u_{j}" class="ltx_Math" display="inline" id="S2.p2.6.m6.3"><semantics id="S2.p2.6.m6.3a"><mrow id="S2.p2.6.m6.3.3.3" xref="S2.p2.6.m6.3.3.4.cmml"><msub id="S2.p2.6.m6.1.1.1.1" xref="S2.p2.6.m6.1.1.1.1.cmml"><mi id="S2.p2.6.m6.1.1.1.1.2" xref="S2.p2.6.m6.1.1.1.1.2.cmml">u</mi><mi id="S2.p2.6.m6.1.1.1.1.3" xref="S2.p2.6.m6.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p2.6.m6.3.3.3.4" xref="S2.p2.6.m6.3.3.4.cmml">,</mo><msub id="S2.p2.6.m6.2.2.2.2" xref="S2.p2.6.m6.2.2.2.2.cmml"><mi id="S2.p2.6.m6.2.2.2.2.2" xref="S2.p2.6.m6.2.2.2.2.2.cmml">u</mi><mrow id="S2.p2.6.m6.2.2.2.2.3" xref="S2.p2.6.m6.2.2.2.2.3.cmml"><mi id="S2.p2.6.m6.2.2.2.2.3.2" xref="S2.p2.6.m6.2.2.2.2.3.2.cmml">i</mi><mo id="S2.p2.6.m6.2.2.2.2.3.1" xref="S2.p2.6.m6.2.2.2.2.3.1.cmml">+</mo><mn id="S2.p2.6.m6.2.2.2.2.3.3" xref="S2.p2.6.m6.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.p2.6.m6.3.3.3.5" xref="S2.p2.6.m6.3.3.4.cmml">,</mo><mrow id="S2.p2.6.m6.3.3.3.3" xref="S2.p2.6.m6.3.3.3.3.cmml"><mi id="S2.p2.6.m6.3.3.3.3.2" mathvariant="normal" xref="S2.p2.6.m6.3.3.3.3.2.cmml">…</mi><mo id="S2.p2.6.m6.3.3.3.3.1" xref="S2.p2.6.m6.3.3.3.3.1.cmml">⁢</mo><msub id="S2.p2.6.m6.3.3.3.3.3" xref="S2.p2.6.m6.3.3.3.3.3.cmml"><mi id="S2.p2.6.m6.3.3.3.3.3.2" xref="S2.p2.6.m6.3.3.3.3.3.2.cmml">u</mi><mi id="S2.p2.6.m6.3.3.3.3.3.3" xref="S2.p2.6.m6.3.3.3.3.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.3b"><list id="S2.p2.6.m6.3.3.4.cmml" xref="S2.p2.6.m6.3.3.3"><apply id="S2.p2.6.m6.1.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.6.m6.1.1.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1.1">subscript</csymbol><ci id="S2.p2.6.m6.1.1.1.1.2.cmml" xref="S2.p2.6.m6.1.1.1.1.2">𝑢</ci><ci id="S2.p2.6.m6.1.1.1.1.3.cmml" xref="S2.p2.6.m6.1.1.1.1.3">𝑖</ci></apply><apply id="S2.p2.6.m6.2.2.2.2.cmml" xref="S2.p2.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S2.p2.6.m6.2.2.2.2.1.cmml" xref="S2.p2.6.m6.2.2.2.2">subscript</csymbol><ci id="S2.p2.6.m6.2.2.2.2.2.cmml" xref="S2.p2.6.m6.2.2.2.2.2">𝑢</ci><apply id="S2.p2.6.m6.2.2.2.2.3.cmml" xref="S2.p2.6.m6.2.2.2.2.3"><plus id="S2.p2.6.m6.2.2.2.2.3.1.cmml" xref="S2.p2.6.m6.2.2.2.2.3.1"></plus><ci id="S2.p2.6.m6.2.2.2.2.3.2.cmml" xref="S2.p2.6.m6.2.2.2.2.3.2">𝑖</ci><cn id="S2.p2.6.m6.2.2.2.2.3.3.cmml" type="integer" xref="S2.p2.6.m6.2.2.2.2.3.3">1</cn></apply></apply><apply id="S2.p2.6.m6.3.3.3.3.cmml" xref="S2.p2.6.m6.3.3.3.3"><times id="S2.p2.6.m6.3.3.3.3.1.cmml" xref="S2.p2.6.m6.3.3.3.3.1"></times><ci id="S2.p2.6.m6.3.3.3.3.2.cmml" xref="S2.p2.6.m6.3.3.3.3.2">…</ci><apply id="S2.p2.6.m6.3.3.3.3.3.cmml" xref="S2.p2.6.m6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.p2.6.m6.3.3.3.3.3.1.cmml" xref="S2.p2.6.m6.3.3.3.3.3">subscript</csymbol><ci id="S2.p2.6.m6.3.3.3.3.3.2.cmml" xref="S2.p2.6.m6.3.3.3.3.3.2">𝑢</ci><ci id="S2.p2.6.m6.3.3.3.3.3.3.cmml" xref="S2.p2.6.m6.3.3.3.3.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.3c">u_{i},u_{i+1},\ldots u_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m6.3d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , … italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. When <math alttext="i&gt;j" class="ltx_Math" display="inline" id="S2.p2.7.m7.1"><semantics id="S2.p2.7.m7.1a"><mrow id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml"><mi id="S2.p2.7.m7.1.1.2" xref="S2.p2.7.m7.1.1.2.cmml">i</mi><mo id="S2.p2.7.m7.1.1.1" xref="S2.p2.7.m7.1.1.1.cmml">&gt;</mo><mi id="S2.p2.7.m7.1.1.3" xref="S2.p2.7.m7.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><apply id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1"><gt id="S2.p2.7.m7.1.1.1.cmml" xref="S2.p2.7.m7.1.1.1"></gt><ci id="S2.p2.7.m7.1.1.2.cmml" xref="S2.p2.7.m7.1.1.2">𝑖</ci><ci id="S2.p2.7.m7.1.1.3.cmml" xref="S2.p2.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">i&gt;j</annotation><annotation encoding="application/x-llamapun" id="S2.p2.7.m7.1d">italic_i &gt; italic_j</annotation></semantics></math>, <math alttext="u_{i:j}" class="ltx_Math" display="inline" id="S2.p2.8.m8.1"><semantics id="S2.p2.8.m8.1a"><msub id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml"><mi id="S2.p2.8.m8.1.1.2" xref="S2.p2.8.m8.1.1.2.cmml">u</mi><mrow id="S2.p2.8.m8.1.1.3" xref="S2.p2.8.m8.1.1.3.cmml"><mi id="S2.p2.8.m8.1.1.3.2" xref="S2.p2.8.m8.1.1.3.2.cmml">i</mi><mo id="S2.p2.8.m8.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.8.m8.1.1.3.1.cmml">:</mo><mi id="S2.p2.8.m8.1.1.3.3" xref="S2.p2.8.m8.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b"><apply id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.cmml" xref="S2.p2.8.m8.1.1">subscript</csymbol><ci id="S2.p2.8.m8.1.1.2.cmml" xref="S2.p2.8.m8.1.1.2">𝑢</ci><apply id="S2.p2.8.m8.1.1.3.cmml" xref="S2.p2.8.m8.1.1.3"><ci id="S2.p2.8.m8.1.1.3.1.cmml" xref="S2.p2.8.m8.1.1.3.1">:</ci><ci id="S2.p2.8.m8.1.1.3.2.cmml" xref="S2.p2.8.m8.1.1.3.2">𝑖</ci><ci id="S2.p2.8.m8.1.1.3.3.cmml" xref="S2.p2.8.m8.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">u_{i:j}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.8.m8.1d">italic_u start_POSTSUBSCRIPT italic_i : italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denotes the subsequence <math alttext="u_{j:i}" class="ltx_Math" display="inline" id="S2.p2.9.m9.1"><semantics id="S2.p2.9.m9.1a"><msub id="S2.p2.9.m9.1.1" xref="S2.p2.9.m9.1.1.cmml"><mi id="S2.p2.9.m9.1.1.2" xref="S2.p2.9.m9.1.1.2.cmml">u</mi><mrow id="S2.p2.9.m9.1.1.3" xref="S2.p2.9.m9.1.1.3.cmml"><mi id="S2.p2.9.m9.1.1.3.2" xref="S2.p2.9.m9.1.1.3.2.cmml">j</mi><mo id="S2.p2.9.m9.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.9.m9.1.1.3.1.cmml">:</mo><mi id="S2.p2.9.m9.1.1.3.3" xref="S2.p2.9.m9.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.9.m9.1b"><apply id="S2.p2.9.m9.1.1.cmml" xref="S2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p2.9.m9.1.1.1.cmml" xref="S2.p2.9.m9.1.1">subscript</csymbol><ci id="S2.p2.9.m9.1.1.2.cmml" xref="S2.p2.9.m9.1.1.2">𝑢</ci><apply id="S2.p2.9.m9.1.1.3.cmml" xref="S2.p2.9.m9.1.1.3"><ci id="S2.p2.9.m9.1.1.3.1.cmml" xref="S2.p2.9.m9.1.1.3.1">:</ci><ci id="S2.p2.9.m9.1.1.3.2.cmml" xref="S2.p2.9.m9.1.1.3.2">𝑗</ci><ci id="S2.p2.9.m9.1.1.3.3.cmml" xref="S2.p2.9.m9.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m9.1c">u_{j:i}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.9.m9.1d">italic_u start_POSTSUBSCRIPT italic_j : italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in reverse order. Thus <math alttext="u_{t:1}" class="ltx_Math" display="inline" id="S2.p2.10.m10.1"><semantics id="S2.p2.10.m10.1a"><msub id="S2.p2.10.m10.1.1" xref="S2.p2.10.m10.1.1.cmml"><mi id="S2.p2.10.m10.1.1.2" xref="S2.p2.10.m10.1.1.2.cmml">u</mi><mrow id="S2.p2.10.m10.1.1.3" xref="S2.p2.10.m10.1.1.3.cmml"><mi id="S2.p2.10.m10.1.1.3.2" xref="S2.p2.10.m10.1.1.3.2.cmml">t</mi><mo id="S2.p2.10.m10.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.10.m10.1.1.3.1.cmml">:</mo><mn id="S2.p2.10.m10.1.1.3.3" xref="S2.p2.10.m10.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.10.m10.1b"><apply id="S2.p2.10.m10.1.1.cmml" xref="S2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.p2.10.m10.1.1.1.cmml" xref="S2.p2.10.m10.1.1">subscript</csymbol><ci id="S2.p2.10.m10.1.1.2.cmml" xref="S2.p2.10.m10.1.1.2">𝑢</ci><apply id="S2.p2.10.m10.1.1.3.cmml" xref="S2.p2.10.m10.1.1.3"><ci id="S2.p2.10.m10.1.1.3.1.cmml" xref="S2.p2.10.m10.1.1.3.1">:</ci><ci id="S2.p2.10.m10.1.1.3.2.cmml" xref="S2.p2.10.m10.1.1.3.2">𝑡</ci><cn id="S2.p2.10.m10.1.1.3.3.cmml" type="integer" xref="S2.p2.10.m10.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m10.1c">u_{t:1}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.10.m10.1d">italic_u start_POSTSUBSCRIPT italic_t : 1 end_POSTSUBSCRIPT</annotation></semantics></math> represents the sequence in reverse order.
Given any sequence <math alttext="u_{i:j}" class="ltx_Math" display="inline" id="S2.p2.11.m11.1"><semantics id="S2.p2.11.m11.1a"><msub id="S2.p2.11.m11.1.1" xref="S2.p2.11.m11.1.1.cmml"><mi id="S2.p2.11.m11.1.1.2" xref="S2.p2.11.m11.1.1.2.cmml">u</mi><mrow id="S2.p2.11.m11.1.1.3" xref="S2.p2.11.m11.1.1.3.cmml"><mi id="S2.p2.11.m11.1.1.3.2" xref="S2.p2.11.m11.1.1.3.2.cmml">i</mi><mo id="S2.p2.11.m11.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.11.m11.1.1.3.1.cmml">:</mo><mi id="S2.p2.11.m11.1.1.3.3" xref="S2.p2.11.m11.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.11.m11.1b"><apply id="S2.p2.11.m11.1.1.cmml" xref="S2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.p2.11.m11.1.1.1.cmml" xref="S2.p2.11.m11.1.1">subscript</csymbol><ci id="S2.p2.11.m11.1.1.2.cmml" xref="S2.p2.11.m11.1.1.2">𝑢</ci><apply id="S2.p2.11.m11.1.1.3.cmml" xref="S2.p2.11.m11.1.1.3"><ci id="S2.p2.11.m11.1.1.3.1.cmml" xref="S2.p2.11.m11.1.1.3.1">:</ci><ci id="S2.p2.11.m11.1.1.3.2.cmml" xref="S2.p2.11.m11.1.1.3.2">𝑖</ci><ci id="S2.p2.11.m11.1.1.3.3.cmml" xref="S2.p2.11.m11.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m11.1c">u_{i:j}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.11.m11.1d">italic_u start_POSTSUBSCRIPT italic_i : italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, for any <math alttext="k" class="ltx_Math" display="inline" id="S2.p2.12.m12.1"><semantics id="S2.p2.12.m12.1a"><mi id="S2.p2.12.m12.1.1" xref="S2.p2.12.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p2.12.m12.1b"><ci id="S2.p2.12.m12.1.1.cmml" xref="S2.p2.12.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m12.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.p2.12.m12.1d">italic_k</annotation></semantics></math> let <math alttext="0_{k}u_{i:j}=0\ldots 0u_{i}\ldots u_{j}" class="ltx_Math" display="inline" id="S2.p2.13.m13.1"><semantics id="S2.p2.13.m13.1a"><mrow id="S2.p2.13.m13.1.1" xref="S2.p2.13.m13.1.1.cmml"><mrow id="S2.p2.13.m13.1.1.2" xref="S2.p2.13.m13.1.1.2.cmml"><msub id="S2.p2.13.m13.1.1.2.2" xref="S2.p2.13.m13.1.1.2.2.cmml"><mn id="S2.p2.13.m13.1.1.2.2.2" xref="S2.p2.13.m13.1.1.2.2.2.cmml">0</mn><mi id="S2.p2.13.m13.1.1.2.2.3" xref="S2.p2.13.m13.1.1.2.2.3.cmml">k</mi></msub><mo id="S2.p2.13.m13.1.1.2.1" xref="S2.p2.13.m13.1.1.2.1.cmml">⁢</mo><msub id="S2.p2.13.m13.1.1.2.3" xref="S2.p2.13.m13.1.1.2.3.cmml"><mi id="S2.p2.13.m13.1.1.2.3.2" xref="S2.p2.13.m13.1.1.2.3.2.cmml">u</mi><mrow id="S2.p2.13.m13.1.1.2.3.3" xref="S2.p2.13.m13.1.1.2.3.3.cmml"><mi id="S2.p2.13.m13.1.1.2.3.3.2" xref="S2.p2.13.m13.1.1.2.3.3.2.cmml">i</mi><mo id="S2.p2.13.m13.1.1.2.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.13.m13.1.1.2.3.3.1.cmml">:</mo><mi id="S2.p2.13.m13.1.1.2.3.3.3" xref="S2.p2.13.m13.1.1.2.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S2.p2.13.m13.1.1.1" xref="S2.p2.13.m13.1.1.1.cmml">=</mo><mrow id="S2.p2.13.m13.1.1.3" xref="S2.p2.13.m13.1.1.3.cmml"><mn id="S2.p2.13.m13.1.1.3.2" xref="S2.p2.13.m13.1.1.3.2.cmml">0</mn><mo id="S2.p2.13.m13.1.1.3.1" xref="S2.p2.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S2.p2.13.m13.1.1.3.3" mathvariant="normal" xref="S2.p2.13.m13.1.1.3.3.cmml">…</mi><mo id="S2.p2.13.m13.1.1.3.1a" xref="S2.p2.13.m13.1.1.3.1.cmml">⁢</mo><mn id="S2.p2.13.m13.1.1.3.4" xref="S2.p2.13.m13.1.1.3.4.cmml">0</mn><mo id="S2.p2.13.m13.1.1.3.1b" xref="S2.p2.13.m13.1.1.3.1.cmml">⁢</mo><msub id="S2.p2.13.m13.1.1.3.5" xref="S2.p2.13.m13.1.1.3.5.cmml"><mi id="S2.p2.13.m13.1.1.3.5.2" xref="S2.p2.13.m13.1.1.3.5.2.cmml">u</mi><mi id="S2.p2.13.m13.1.1.3.5.3" xref="S2.p2.13.m13.1.1.3.5.3.cmml">i</mi></msub><mo id="S2.p2.13.m13.1.1.3.1c" xref="S2.p2.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S2.p2.13.m13.1.1.3.6" mathvariant="normal" xref="S2.p2.13.m13.1.1.3.6.cmml">…</mi><mo id="S2.p2.13.m13.1.1.3.1d" xref="S2.p2.13.m13.1.1.3.1.cmml">⁢</mo><msub id="S2.p2.13.m13.1.1.3.7" xref="S2.p2.13.m13.1.1.3.7.cmml"><mi id="S2.p2.13.m13.1.1.3.7.2" xref="S2.p2.13.m13.1.1.3.7.2.cmml">u</mi><mi id="S2.p2.13.m13.1.1.3.7.3" xref="S2.p2.13.m13.1.1.3.7.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.13.m13.1b"><apply id="S2.p2.13.m13.1.1.cmml" xref="S2.p2.13.m13.1.1"><eq id="S2.p2.13.m13.1.1.1.cmml" xref="S2.p2.13.m13.1.1.1"></eq><apply id="S2.p2.13.m13.1.1.2.cmml" xref="S2.p2.13.m13.1.1.2"><times id="S2.p2.13.m13.1.1.2.1.cmml" xref="S2.p2.13.m13.1.1.2.1"></times><apply id="S2.p2.13.m13.1.1.2.2.cmml" xref="S2.p2.13.m13.1.1.2.2"><csymbol cd="ambiguous" id="S2.p2.13.m13.1.1.2.2.1.cmml" xref="S2.p2.13.m13.1.1.2.2">subscript</csymbol><cn id="S2.p2.13.m13.1.1.2.2.2.cmml" type="integer" xref="S2.p2.13.m13.1.1.2.2.2">0</cn><ci id="S2.p2.13.m13.1.1.2.2.3.cmml" xref="S2.p2.13.m13.1.1.2.2.3">𝑘</ci></apply><apply id="S2.p2.13.m13.1.1.2.3.cmml" xref="S2.p2.13.m13.1.1.2.3"><csymbol cd="ambiguous" id="S2.p2.13.m13.1.1.2.3.1.cmml" xref="S2.p2.13.m13.1.1.2.3">subscript</csymbol><ci id="S2.p2.13.m13.1.1.2.3.2.cmml" xref="S2.p2.13.m13.1.1.2.3.2">𝑢</ci><apply id="S2.p2.13.m13.1.1.2.3.3.cmml" xref="S2.p2.13.m13.1.1.2.3.3"><ci id="S2.p2.13.m13.1.1.2.3.3.1.cmml" xref="S2.p2.13.m13.1.1.2.3.3.1">:</ci><ci id="S2.p2.13.m13.1.1.2.3.3.2.cmml" xref="S2.p2.13.m13.1.1.2.3.3.2">𝑖</ci><ci id="S2.p2.13.m13.1.1.2.3.3.3.cmml" xref="S2.p2.13.m13.1.1.2.3.3.3">𝑗</ci></apply></apply></apply><apply id="S2.p2.13.m13.1.1.3.cmml" xref="S2.p2.13.m13.1.1.3"><times id="S2.p2.13.m13.1.1.3.1.cmml" xref="S2.p2.13.m13.1.1.3.1"></times><cn id="S2.p2.13.m13.1.1.3.2.cmml" type="integer" xref="S2.p2.13.m13.1.1.3.2">0</cn><ci id="S2.p2.13.m13.1.1.3.3.cmml" xref="S2.p2.13.m13.1.1.3.3">…</ci><cn id="S2.p2.13.m13.1.1.3.4.cmml" type="integer" xref="S2.p2.13.m13.1.1.3.4">0</cn><apply id="S2.p2.13.m13.1.1.3.5.cmml" xref="S2.p2.13.m13.1.1.3.5"><csymbol cd="ambiguous" id="S2.p2.13.m13.1.1.3.5.1.cmml" xref="S2.p2.13.m13.1.1.3.5">subscript</csymbol><ci id="S2.p2.13.m13.1.1.3.5.2.cmml" xref="S2.p2.13.m13.1.1.3.5.2">𝑢</ci><ci id="S2.p2.13.m13.1.1.3.5.3.cmml" xref="S2.p2.13.m13.1.1.3.5.3">𝑖</ci></apply><ci id="S2.p2.13.m13.1.1.3.6.cmml" xref="S2.p2.13.m13.1.1.3.6">…</ci><apply id="S2.p2.13.m13.1.1.3.7.cmml" xref="S2.p2.13.m13.1.1.3.7"><csymbol cd="ambiguous" id="S2.p2.13.m13.1.1.3.7.1.cmml" xref="S2.p2.13.m13.1.1.3.7">subscript</csymbol><ci id="S2.p2.13.m13.1.1.3.7.2.cmml" xref="S2.p2.13.m13.1.1.3.7.2">𝑢</ci><ci id="S2.p2.13.m13.1.1.3.7.3.cmml" xref="S2.p2.13.m13.1.1.3.7.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.13.m13.1c">0_{k}u_{i:j}=0\ldots 0u_{i}\ldots u_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.13.m13.1d">0 start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_i : italic_j end_POSTSUBSCRIPT = 0 … 0 italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT … italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="u_{i:j}0_{k}=u_{i}\ldots u_{j}0\ldots 0" class="ltx_Math" display="inline" id="S2.p2.14.m14.1"><semantics id="S2.p2.14.m14.1a"><mrow id="S2.p2.14.m14.1.1" xref="S2.p2.14.m14.1.1.cmml"><mrow id="S2.p2.14.m14.1.1.2" xref="S2.p2.14.m14.1.1.2.cmml"><msub id="S2.p2.14.m14.1.1.2.2" xref="S2.p2.14.m14.1.1.2.2.cmml"><mi id="S2.p2.14.m14.1.1.2.2.2" xref="S2.p2.14.m14.1.1.2.2.2.cmml">u</mi><mrow id="S2.p2.14.m14.1.1.2.2.3" xref="S2.p2.14.m14.1.1.2.2.3.cmml"><mi id="S2.p2.14.m14.1.1.2.2.3.2" xref="S2.p2.14.m14.1.1.2.2.3.2.cmml">i</mi><mo id="S2.p2.14.m14.1.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p2.14.m14.1.1.2.2.3.1.cmml">:</mo><mi id="S2.p2.14.m14.1.1.2.2.3.3" xref="S2.p2.14.m14.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.p2.14.m14.1.1.2.1" xref="S2.p2.14.m14.1.1.2.1.cmml">⁢</mo><msub id="S2.p2.14.m14.1.1.2.3" xref="S2.p2.14.m14.1.1.2.3.cmml"><mn id="S2.p2.14.m14.1.1.2.3.2" xref="S2.p2.14.m14.1.1.2.3.2.cmml">0</mn><mi id="S2.p2.14.m14.1.1.2.3.3" xref="S2.p2.14.m14.1.1.2.3.3.cmml">k</mi></msub></mrow><mo id="S2.p2.14.m14.1.1.1" xref="S2.p2.14.m14.1.1.1.cmml">=</mo><mrow id="S2.p2.14.m14.1.1.3" xref="S2.p2.14.m14.1.1.3.cmml"><msub id="S2.p2.14.m14.1.1.3.2" xref="S2.p2.14.m14.1.1.3.2.cmml"><mi id="S2.p2.14.m14.1.1.3.2.2" xref="S2.p2.14.m14.1.1.3.2.2.cmml">u</mi><mi id="S2.p2.14.m14.1.1.3.2.3" xref="S2.p2.14.m14.1.1.3.2.3.cmml">i</mi></msub><mo id="S2.p2.14.m14.1.1.3.1" xref="S2.p2.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S2.p2.14.m14.1.1.3.3" mathvariant="normal" xref="S2.p2.14.m14.1.1.3.3.cmml">…</mi><mo id="S2.p2.14.m14.1.1.3.1a" xref="S2.p2.14.m14.1.1.3.1.cmml">⁢</mo><msub id="S2.p2.14.m14.1.1.3.4" xref="S2.p2.14.m14.1.1.3.4.cmml"><mi id="S2.p2.14.m14.1.1.3.4.2" xref="S2.p2.14.m14.1.1.3.4.2.cmml">u</mi><mi id="S2.p2.14.m14.1.1.3.4.3" xref="S2.p2.14.m14.1.1.3.4.3.cmml">j</mi></msub><mo id="S2.p2.14.m14.1.1.3.1b" xref="S2.p2.14.m14.1.1.3.1.cmml">⁢</mo><mn id="S2.p2.14.m14.1.1.3.5" xref="S2.p2.14.m14.1.1.3.5.cmml">0</mn><mo id="S2.p2.14.m14.1.1.3.1c" xref="S2.p2.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S2.p2.14.m14.1.1.3.6" mathvariant="normal" xref="S2.p2.14.m14.1.1.3.6.cmml">…</mi><mo id="S2.p2.14.m14.1.1.3.1d" xref="S2.p2.14.m14.1.1.3.1.cmml">⁢</mo><mn id="S2.p2.14.m14.1.1.3.7" xref="S2.p2.14.m14.1.1.3.7.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.14.m14.1b"><apply id="S2.p2.14.m14.1.1.cmml" xref="S2.p2.14.m14.1.1"><eq id="S2.p2.14.m14.1.1.1.cmml" xref="S2.p2.14.m14.1.1.1"></eq><apply id="S2.p2.14.m14.1.1.2.cmml" xref="S2.p2.14.m14.1.1.2"><times id="S2.p2.14.m14.1.1.2.1.cmml" xref="S2.p2.14.m14.1.1.2.1"></times><apply id="S2.p2.14.m14.1.1.2.2.cmml" xref="S2.p2.14.m14.1.1.2.2"><csymbol cd="ambiguous" id="S2.p2.14.m14.1.1.2.2.1.cmml" xref="S2.p2.14.m14.1.1.2.2">subscript</csymbol><ci id="S2.p2.14.m14.1.1.2.2.2.cmml" xref="S2.p2.14.m14.1.1.2.2.2">𝑢</ci><apply id="S2.p2.14.m14.1.1.2.2.3.cmml" xref="S2.p2.14.m14.1.1.2.2.3"><ci id="S2.p2.14.m14.1.1.2.2.3.1.cmml" xref="S2.p2.14.m14.1.1.2.2.3.1">:</ci><ci id="S2.p2.14.m14.1.1.2.2.3.2.cmml" xref="S2.p2.14.m14.1.1.2.2.3.2">𝑖</ci><ci id="S2.p2.14.m14.1.1.2.2.3.3.cmml" xref="S2.p2.14.m14.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S2.p2.14.m14.1.1.2.3.cmml" xref="S2.p2.14.m14.1.1.2.3"><csymbol cd="ambiguous" id="S2.p2.14.m14.1.1.2.3.1.cmml" xref="S2.p2.14.m14.1.1.2.3">subscript</csymbol><cn id="S2.p2.14.m14.1.1.2.3.2.cmml" type="integer" xref="S2.p2.14.m14.1.1.2.3.2">0</cn><ci id="S2.p2.14.m14.1.1.2.3.3.cmml" xref="S2.p2.14.m14.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S2.p2.14.m14.1.1.3.cmml" xref="S2.p2.14.m14.1.1.3"><times id="S2.p2.14.m14.1.1.3.1.cmml" xref="S2.p2.14.m14.1.1.3.1"></times><apply id="S2.p2.14.m14.1.1.3.2.cmml" xref="S2.p2.14.m14.1.1.3.2"><csymbol cd="ambiguous" id="S2.p2.14.m14.1.1.3.2.1.cmml" xref="S2.p2.14.m14.1.1.3.2">subscript</csymbol><ci id="S2.p2.14.m14.1.1.3.2.2.cmml" xref="S2.p2.14.m14.1.1.3.2.2">𝑢</ci><ci id="S2.p2.14.m14.1.1.3.2.3.cmml" xref="S2.p2.14.m14.1.1.3.2.3">𝑖</ci></apply><ci id="S2.p2.14.m14.1.1.3.3.cmml" xref="S2.p2.14.m14.1.1.3.3">…</ci><apply id="S2.p2.14.m14.1.1.3.4.cmml" xref="S2.p2.14.m14.1.1.3.4"><csymbol cd="ambiguous" id="S2.p2.14.m14.1.1.3.4.1.cmml" xref="S2.p2.14.m14.1.1.3.4">subscript</csymbol><ci id="S2.p2.14.m14.1.1.3.4.2.cmml" xref="S2.p2.14.m14.1.1.3.4.2">𝑢</ci><ci id="S2.p2.14.m14.1.1.3.4.3.cmml" xref="S2.p2.14.m14.1.1.3.4.3">𝑗</ci></apply><cn id="S2.p2.14.m14.1.1.3.5.cmml" type="integer" xref="S2.p2.14.m14.1.1.3.5">0</cn><ci id="S2.p2.14.m14.1.1.3.6.cmml" xref="S2.p2.14.m14.1.1.3.6">…</ci><cn id="S2.p2.14.m14.1.1.3.7.cmml" type="integer" xref="S2.p2.14.m14.1.1.3.7">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.14.m14.1c">u_{i:j}0_{k}=u_{i}\ldots u_{j}0\ldots 0</annotation><annotation encoding="application/x-llamapun" id="S2.p2.14.m14.1d">italic_u start_POSTSUBSCRIPT italic_i : italic_j end_POSTSUBSCRIPT 0 start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT … italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT 0 … 0</annotation></semantics></math> denote the pre and post concatenation with <math alttext="k" class="ltx_Math" display="inline" id="S2.p2.15.m15.1"><semantics id="S2.p2.15.m15.1a"><mi id="S2.p2.15.m15.1.1" xref="S2.p2.15.m15.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p2.15.m15.1b"><ci id="S2.p2.15.m15.1.1.cmml" xref="S2.p2.15.m15.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.15.m15.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.p2.15.m15.1d">italic_k</annotation></semantics></math> zeros.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.4">The convolution operator between two vectors <math alttext="v\in\mathbb{R}^{t_{1}}" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mrow id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">v</mi><mo id="S2.p3.1.m1.1.1.1" xref="S2.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml"><mi id="S2.p3.1.m1.1.1.3.2" xref="S2.p3.1.m1.1.1.3.2.cmml">ℝ</mi><msub id="S2.p3.1.m1.1.1.3.3" xref="S2.p3.1.m1.1.1.3.3.cmml"><mi id="S2.p3.1.m1.1.1.3.3.2" xref="S2.p3.1.m1.1.1.3.3.2.cmml">t</mi><mn id="S2.p3.1.m1.1.1.3.3.3" xref="S2.p3.1.m1.1.1.3.3.3.cmml">1</mn></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><in id="S2.p3.1.m1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1"></in><ci id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2">𝑣</ci><apply id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.3.1.cmml" xref="S2.p3.1.m1.1.1.3">superscript</csymbol><ci id="S2.p3.1.m1.1.1.3.2.cmml" xref="S2.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S2.p3.1.m1.1.1.3.3.cmml" xref="S2.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.3.3.1.cmml" xref="S2.p3.1.m1.1.1.3.3">subscript</csymbol><ci id="S2.p3.1.m1.1.1.3.3.2.cmml" xref="S2.p3.1.m1.1.1.3.3.2">𝑡</ci><cn id="S2.p3.1.m1.1.1.3.3.3.cmml" type="integer" xref="S2.p3.1.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">v\in\mathbb{R}^{t_{1}}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">italic_v ∈ blackboard_R start_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="w\in\mathbb{R}^{t_{2}}" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mrow id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml"><mi id="S2.p3.2.m2.1.1.2" xref="S2.p3.2.m2.1.1.2.cmml">w</mi><mo id="S2.p3.2.m2.1.1.1" xref="S2.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S2.p3.2.m2.1.1.3" xref="S2.p3.2.m2.1.1.3.cmml"><mi id="S2.p3.2.m2.1.1.3.2" xref="S2.p3.2.m2.1.1.3.2.cmml">ℝ</mi><msub id="S2.p3.2.m2.1.1.3.3" xref="S2.p3.2.m2.1.1.3.3.cmml"><mi id="S2.p3.2.m2.1.1.3.3.2" xref="S2.p3.2.m2.1.1.3.3.2.cmml">t</mi><mn id="S2.p3.2.m2.1.1.3.3.3" xref="S2.p3.2.m2.1.1.3.3.3.cmml">2</mn></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1"><in id="S2.p3.2.m2.1.1.1.cmml" xref="S2.p3.2.m2.1.1.1"></in><ci id="S2.p3.2.m2.1.1.2.cmml" xref="S2.p3.2.m2.1.1.2">𝑤</ci><apply id="S2.p3.2.m2.1.1.3.cmml" xref="S2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.3.1.cmml" xref="S2.p3.2.m2.1.1.3">superscript</csymbol><ci id="S2.p3.2.m2.1.1.3.2.cmml" xref="S2.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S2.p3.2.m2.1.1.3.3.cmml" xref="S2.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.3.3.1.cmml" xref="S2.p3.2.m2.1.1.3.3">subscript</csymbol><ci id="S2.p3.2.m2.1.1.3.3.2.cmml" xref="S2.p3.2.m2.1.1.3.3.2">𝑡</ci><cn id="S2.p3.2.m2.1.1.3.3.3.cmml" type="integer" xref="S2.p3.2.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">w\in\mathbb{R}^{t_{2}}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">italic_w ∈ blackboard_R start_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> outputs a sequence of length <math alttext="t_{1}+t_{2}" class="ltx_Math" display="inline" id="S2.p3.3.m3.1"><semantics id="S2.p3.3.m3.1a"><mrow id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml"><msub id="S2.p3.3.m3.1.1.2" xref="S2.p3.3.m3.1.1.2.cmml"><mi id="S2.p3.3.m3.1.1.2.2" xref="S2.p3.3.m3.1.1.2.2.cmml">t</mi><mn id="S2.p3.3.m3.1.1.2.3" xref="S2.p3.3.m3.1.1.2.3.cmml">1</mn></msub><mo id="S2.p3.3.m3.1.1.1" xref="S2.p3.3.m3.1.1.1.cmml">+</mo><msub id="S2.p3.3.m3.1.1.3" xref="S2.p3.3.m3.1.1.3.cmml"><mi id="S2.p3.3.m3.1.1.3.2" xref="S2.p3.3.m3.1.1.3.2.cmml">t</mi><mn id="S2.p3.3.m3.1.1.3.3" xref="S2.p3.3.m3.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1"><plus id="S2.p3.3.m3.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1"></plus><apply id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.2.1.cmml" xref="S2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S2.p3.3.m3.1.1.2.2.cmml" xref="S2.p3.3.m3.1.1.2.2">𝑡</ci><cn id="S2.p3.3.m3.1.1.2.3.cmml" type="integer" xref="S2.p3.3.m3.1.1.2.3">1</cn></apply><apply id="S2.p3.3.m3.1.1.3.cmml" xref="S2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.3.1.cmml" xref="S2.p3.3.m3.1.1.3">subscript</csymbol><ci id="S2.p3.3.m3.1.1.3.2.cmml" xref="S2.p3.3.m3.1.1.3.2">𝑡</ci><cn id="S2.p3.3.m3.1.1.3.3.cmml" type="integer" xref="S2.p3.3.m3.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">t_{1}+t_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m3.1d">italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> whose element at any position <math alttext="s\in[t_{1}+t_{2}]" class="ltx_Math" display="inline" id="S2.p3.4.m4.1"><semantics id="S2.p3.4.m4.1a"><mrow id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml"><mi id="S2.p3.4.m4.1.1.3" xref="S2.p3.4.m4.1.1.3.cmml">s</mi><mo id="S2.p3.4.m4.1.1.2" xref="S2.p3.4.m4.1.1.2.cmml">∈</mo><mrow id="S2.p3.4.m4.1.1.1.1" xref="S2.p3.4.m4.1.1.1.2.cmml"><mo id="S2.p3.4.m4.1.1.1.1.2" stretchy="false" xref="S2.p3.4.m4.1.1.1.2.1.cmml">[</mo><mrow id="S2.p3.4.m4.1.1.1.1.1" xref="S2.p3.4.m4.1.1.1.1.1.cmml"><msub id="S2.p3.4.m4.1.1.1.1.1.2" xref="S2.p3.4.m4.1.1.1.1.1.2.cmml"><mi id="S2.p3.4.m4.1.1.1.1.1.2.2" xref="S2.p3.4.m4.1.1.1.1.1.2.2.cmml">t</mi><mn id="S2.p3.4.m4.1.1.1.1.1.2.3" xref="S2.p3.4.m4.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.p3.4.m4.1.1.1.1.1.1" xref="S2.p3.4.m4.1.1.1.1.1.1.cmml">+</mo><msub id="S2.p3.4.m4.1.1.1.1.1.3" xref="S2.p3.4.m4.1.1.1.1.1.3.cmml"><mi id="S2.p3.4.m4.1.1.1.1.1.3.2" xref="S2.p3.4.m4.1.1.1.1.1.3.2.cmml">t</mi><mn id="S2.p3.4.m4.1.1.1.1.1.3.3" xref="S2.p3.4.m4.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S2.p3.4.m4.1.1.1.1.3" stretchy="false" xref="S2.p3.4.m4.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><apply id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1"><in id="S2.p3.4.m4.1.1.2.cmml" xref="S2.p3.4.m4.1.1.2"></in><ci id="S2.p3.4.m4.1.1.3.cmml" xref="S2.p3.4.m4.1.1.3">𝑠</ci><apply id="S2.p3.4.m4.1.1.1.2.cmml" xref="S2.p3.4.m4.1.1.1.1"><csymbol cd="latexml" id="S2.p3.4.m4.1.1.1.2.1.cmml" xref="S2.p3.4.m4.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.p3.4.m4.1.1.1.1.1.cmml" xref="S2.p3.4.m4.1.1.1.1.1"><plus id="S2.p3.4.m4.1.1.1.1.1.1.cmml" xref="S2.p3.4.m4.1.1.1.1.1.1"></plus><apply id="S2.p3.4.m4.1.1.1.1.1.2.cmml" xref="S2.p3.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p3.4.m4.1.1.1.1.1.2.1.cmml" xref="S2.p3.4.m4.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p3.4.m4.1.1.1.1.1.2.2.cmml" xref="S2.p3.4.m4.1.1.1.1.1.2.2">𝑡</ci><cn id="S2.p3.4.m4.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.p3.4.m4.1.1.1.1.1.2.3">1</cn></apply><apply id="S2.p3.4.m4.1.1.1.1.1.3.cmml" xref="S2.p3.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.4.m4.1.1.1.1.1.3.1.cmml" xref="S2.p3.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p3.4.m4.1.1.1.1.1.3.2.cmml" xref="S2.p3.4.m4.1.1.1.1.1.3.2">𝑡</ci><cn id="S2.p3.4.m4.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.p3.4.m4.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">s\in[t_{1}+t_{2}]</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m4.1d">italic_s ∈ [ italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ]</annotation></semantics></math> is</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[v*w](s)=\sum_{i=1}^{s}v_{i}w_{s+1-i}=\langle v_{1:s},w_{s:1}\rangle," class="ltx_Math" display="block" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E1.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml">v</mi><mo id="S2.E1.m1.2.2.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml">∗</mo><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml">w</mi></mrow><mo id="S2.E1.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S2.E1.m1.2.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.1.1.1.3.2" xref="S2.E1.m1.2.2.1.1.1.cmml"><mo id="S2.E1.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="S2.E1.m1.2.2.1.1.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">s</mi><mo id="S2.E1.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="S2.E1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.5" rspace="0.111em" xref="S2.E1.m1.2.2.1.1.5.cmml">=</mo><mrow id="S2.E1.m1.2.2.1.1.6" xref="S2.E1.m1.2.2.1.1.6.cmml"><munderover id="S2.E1.m1.2.2.1.1.6.1" xref="S2.E1.m1.2.2.1.1.6.1.cmml"><mo id="S2.E1.m1.2.2.1.1.6.1.2.2" movablelimits="false" xref="S2.E1.m1.2.2.1.1.6.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.2.2.1.1.6.1.2.3" xref="S2.E1.m1.2.2.1.1.6.1.2.3.cmml"><mi id="S2.E1.m1.2.2.1.1.6.1.2.3.2" xref="S2.E1.m1.2.2.1.1.6.1.2.3.2.cmml">i</mi><mo id="S2.E1.m1.2.2.1.1.6.1.2.3.1" xref="S2.E1.m1.2.2.1.1.6.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.2.2.1.1.6.1.2.3.3" xref="S2.E1.m1.2.2.1.1.6.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.2.2.1.1.6.1.3" xref="S2.E1.m1.2.2.1.1.6.1.3.cmml">s</mi></munderover><mrow id="S2.E1.m1.2.2.1.1.6.2" xref="S2.E1.m1.2.2.1.1.6.2.cmml"><msub id="S2.E1.m1.2.2.1.1.6.2.2" xref="S2.E1.m1.2.2.1.1.6.2.2.cmml"><mi id="S2.E1.m1.2.2.1.1.6.2.2.2" xref="S2.E1.m1.2.2.1.1.6.2.2.2.cmml">v</mi><mi id="S2.E1.m1.2.2.1.1.6.2.2.3" xref="S2.E1.m1.2.2.1.1.6.2.2.3.cmml">i</mi></msub><mo id="S2.E1.m1.2.2.1.1.6.2.1" xref="S2.E1.m1.2.2.1.1.6.2.1.cmml">⁢</mo><msub id="S2.E1.m1.2.2.1.1.6.2.3" xref="S2.E1.m1.2.2.1.1.6.2.3.cmml"><mi id="S2.E1.m1.2.2.1.1.6.2.3.2" xref="S2.E1.m1.2.2.1.1.6.2.3.2.cmml">w</mi><mrow id="S2.E1.m1.2.2.1.1.6.2.3.3" xref="S2.E1.m1.2.2.1.1.6.2.3.3.cmml"><mrow id="S2.E1.m1.2.2.1.1.6.2.3.3.2" xref="S2.E1.m1.2.2.1.1.6.2.3.3.2.cmml"><mi id="S2.E1.m1.2.2.1.1.6.2.3.3.2.2" xref="S2.E1.m1.2.2.1.1.6.2.3.3.2.2.cmml">s</mi><mo id="S2.E1.m1.2.2.1.1.6.2.3.3.2.1" xref="S2.E1.m1.2.2.1.1.6.2.3.3.2.1.cmml">+</mo><mn id="S2.E1.m1.2.2.1.1.6.2.3.3.2.3" xref="S2.E1.m1.2.2.1.1.6.2.3.3.2.3.cmml">1</mn></mrow><mo id="S2.E1.m1.2.2.1.1.6.2.3.3.1" xref="S2.E1.m1.2.2.1.1.6.2.3.3.1.cmml">−</mo><mi id="S2.E1.m1.2.2.1.1.6.2.3.3.3" xref="S2.E1.m1.2.2.1.1.6.2.3.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.7" xref="S2.E1.m1.2.2.1.1.7.cmml">=</mo><mrow id="S2.E1.m1.2.2.1.1.3.2" xref="S2.E1.m1.2.2.1.1.3.3.cmml"><mo id="S2.E1.m1.2.2.1.1.3.2.3" stretchy="false" xref="S2.E1.m1.2.2.1.1.3.3.cmml">⟨</mo><msub id="S2.E1.m1.2.2.1.1.2.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.2.cmml">v</mi><mrow id="S2.E1.m1.2.2.1.1.2.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.3.cmml"><mn id="S2.E1.m1.2.2.1.1.2.1.1.3.2" xref="S2.E1.m1.2.2.1.1.2.1.1.3.2.cmml">1</mn><mo id="S2.E1.m1.2.2.1.1.2.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m1.2.2.1.1.2.1.1.3.1.cmml">:</mo><mi id="S2.E1.m1.2.2.1.1.2.1.1.3.3" xref="S2.E1.m1.2.2.1.1.2.1.1.3.3.cmml">s</mi></mrow></msub><mo id="S2.E1.m1.2.2.1.1.3.2.4" xref="S2.E1.m1.2.2.1.1.3.3.cmml">,</mo><msub id="S2.E1.m1.2.2.1.1.3.2.2" xref="S2.E1.m1.2.2.1.1.3.2.2.cmml"><mi id="S2.E1.m1.2.2.1.1.3.2.2.2" xref="S2.E1.m1.2.2.1.1.3.2.2.2.cmml">w</mi><mrow id="S2.E1.m1.2.2.1.1.3.2.2.3" xref="S2.E1.m1.2.2.1.1.3.2.2.3.cmml"><mi id="S2.E1.m1.2.2.1.1.3.2.2.3.2" xref="S2.E1.m1.2.2.1.1.3.2.2.3.2.cmml">s</mi><mo id="S2.E1.m1.2.2.1.1.3.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m1.2.2.1.1.3.2.2.3.1.cmml">:</mo><mn id="S2.E1.m1.2.2.1.1.3.2.2.3.3" xref="S2.E1.m1.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E1.m1.2.2.1.1.3.2.5" stretchy="false" xref="S2.E1.m1.2.2.1.1.3.3.cmml">⟩</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1"><and id="S2.E1.m1.2.2.1.1a.cmml" xref="S2.E1.m1.2.2.1"></and><apply id="S2.E1.m1.2.2.1.1b.cmml" xref="S2.E1.m1.2.2.1"><eq id="S2.E1.m1.2.2.1.1.5.cmml" xref="S2.E1.m1.2.2.1.1.5"></eq><apply id="S2.E1.m1.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1"><times id="S2.E1.m1.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.2"></times><apply id="S2.E1.m1.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1"><times id="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1"></times><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2">𝑣</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3">𝑤</ci></apply></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑠</ci></apply><apply id="S2.E1.m1.2.2.1.1.6.cmml" xref="S2.E1.m1.2.2.1.1.6"><apply id="S2.E1.m1.2.2.1.1.6.1.cmml" xref="S2.E1.m1.2.2.1.1.6.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.6.1.1.cmml" xref="S2.E1.m1.2.2.1.1.6.1">superscript</csymbol><apply id="S2.E1.m1.2.2.1.1.6.1.2.cmml" xref="S2.E1.m1.2.2.1.1.6.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.6.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.6.1">subscript</csymbol><sum id="S2.E1.m1.2.2.1.1.6.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.6.1.2.2"></sum><apply id="S2.E1.m1.2.2.1.1.6.1.2.3.cmml" xref="S2.E1.m1.2.2.1.1.6.1.2.3"><eq id="S2.E1.m1.2.2.1.1.6.1.2.3.1.cmml" xref="S2.E1.m1.2.2.1.1.6.1.2.3.1"></eq><ci id="S2.E1.m1.2.2.1.1.6.1.2.3.2.cmml" xref="S2.E1.m1.2.2.1.1.6.1.2.3.2">𝑖</ci><cn id="S2.E1.m1.2.2.1.1.6.1.2.3.3.cmml" type="integer" xref="S2.E1.m1.2.2.1.1.6.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.2.2.1.1.6.1.3.cmml" xref="S2.E1.m1.2.2.1.1.6.1.3">𝑠</ci></apply><apply id="S2.E1.m1.2.2.1.1.6.2.cmml" xref="S2.E1.m1.2.2.1.1.6.2"><times id="S2.E1.m1.2.2.1.1.6.2.1.cmml" xref="S2.E1.m1.2.2.1.1.6.2.1"></times><apply id="S2.E1.m1.2.2.1.1.6.2.2.cmml" xref="S2.E1.m1.2.2.1.1.6.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.6.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.6.2.2">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.6.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.6.2.2.2">𝑣</ci><ci id="S2.E1.m1.2.2.1.1.6.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.6.2.2.3">𝑖</ci></apply><apply id="S2.E1.m1.2.2.1.1.6.2.3.cmml" xref="S2.E1.m1.2.2.1.1.6.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.6.2.3.1.cmml" xref="S2.E1.m1.2.2.1.1.6.2.3">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.6.2.3.2.cmml" xref="S2.E1.m1.2.2.1.1.6.2.3.2">𝑤</ci><apply id="S2.E1.m1.2.2.1.1.6.2.3.3.cmml" xref="S2.E1.m1.2.2.1.1.6.2.3.3"><minus id="S2.E1.m1.2.2.1.1.6.2.3.3.1.cmml" xref="S2.E1.m1.2.2.1.1.6.2.3.3.1"></minus><apply id="S2.E1.m1.2.2.1.1.6.2.3.3.2.cmml" xref="S2.E1.m1.2.2.1.1.6.2.3.3.2"><plus id="S2.E1.m1.2.2.1.1.6.2.3.3.2.1.cmml" xref="S2.E1.m1.2.2.1.1.6.2.3.3.2.1"></plus><ci id="S2.E1.m1.2.2.1.1.6.2.3.3.2.2.cmml" xref="S2.E1.m1.2.2.1.1.6.2.3.3.2.2">𝑠</ci><cn id="S2.E1.m1.2.2.1.1.6.2.3.3.2.3.cmml" type="integer" xref="S2.E1.m1.2.2.1.1.6.2.3.3.2.3">1</cn></apply><ci id="S2.E1.m1.2.2.1.1.6.2.3.3.3.cmml" xref="S2.E1.m1.2.2.1.1.6.2.3.3.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S2.E1.m1.2.2.1.1c.cmml" xref="S2.E1.m1.2.2.1"><eq id="S2.E1.m1.2.2.1.1.7.cmml" xref="S2.E1.m1.2.2.1.1.7"></eq><share href="https://arxiv.org/html/2410.03766v1#S2.E1.m1.2.2.1.1.6.cmml" id="S2.E1.m1.2.2.1.1d.cmml" xref="S2.E1.m1.2.2.1"></share><list id="S2.E1.m1.2.2.1.1.3.3.cmml" xref="S2.E1.m1.2.2.1.1.3.2"><apply id="S2.E1.m1.2.2.1.1.2.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.2">𝑣</ci><apply id="S2.E1.m1.2.2.1.1.2.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.3"><ci id="S2.E1.m1.2.2.1.1.2.1.1.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.3.1">:</ci><cn id="S2.E1.m1.2.2.1.1.2.1.1.3.2.cmml" type="integer" xref="S2.E1.m1.2.2.1.1.2.1.1.3.2">1</cn><ci id="S2.E1.m1.2.2.1.1.2.1.1.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.E1.m1.2.2.1.1.3.2.2.cmml" xref="S2.E1.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.3.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.3.2.2">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.3.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.3.2.2.2">𝑤</ci><apply id="S2.E1.m1.2.2.1.1.3.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.3.2.2.3"><ci id="S2.E1.m1.2.2.1.1.3.2.2.3.1.cmml" xref="S2.E1.m1.2.2.1.1.3.2.2.3.1">:</ci><ci id="S2.E1.m1.2.2.1.1.3.2.2.3.2.cmml" xref="S2.E1.m1.2.2.1.1.3.2.2.3.2">𝑠</ci><cn id="S2.E1.m1.2.2.1.1.3.2.2.3.3.cmml" type="integer" xref="S2.E1.m1.2.2.1.1.3.2.2.3.3">1</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">[v*w](s)=\sum_{i=1}^{s}v_{i}w_{s+1-i}=\langle v_{1:s},w_{s:1}\rangle,</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">[ italic_v ∗ italic_w ] ( italic_s ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_s + 1 - italic_i end_POSTSUBSCRIPT = ⟨ italic_v start_POSTSUBSCRIPT 1 : italic_s end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT italic_s : 1 end_POSTSUBSCRIPT ⟩ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p3.8">where for brevity of notation we assume <math alttext="v_{j}=0" class="ltx_Math" display="inline" id="S2.p3.5.m1.1"><semantics id="S2.p3.5.m1.1a"><mrow id="S2.p3.5.m1.1.1" xref="S2.p3.5.m1.1.1.cmml"><msub id="S2.p3.5.m1.1.1.2" xref="S2.p3.5.m1.1.1.2.cmml"><mi id="S2.p3.5.m1.1.1.2.2" xref="S2.p3.5.m1.1.1.2.2.cmml">v</mi><mi id="S2.p3.5.m1.1.1.2.3" xref="S2.p3.5.m1.1.1.2.3.cmml">j</mi></msub><mo id="S2.p3.5.m1.1.1.1" xref="S2.p3.5.m1.1.1.1.cmml">=</mo><mn id="S2.p3.5.m1.1.1.3" xref="S2.p3.5.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.5.m1.1b"><apply id="S2.p3.5.m1.1.1.cmml" xref="S2.p3.5.m1.1.1"><eq id="S2.p3.5.m1.1.1.1.cmml" xref="S2.p3.5.m1.1.1.1"></eq><apply id="S2.p3.5.m1.1.1.2.cmml" xref="S2.p3.5.m1.1.1.2"><csymbol cd="ambiguous" id="S2.p3.5.m1.1.1.2.1.cmml" xref="S2.p3.5.m1.1.1.2">subscript</csymbol><ci id="S2.p3.5.m1.1.1.2.2.cmml" xref="S2.p3.5.m1.1.1.2.2">𝑣</ci><ci id="S2.p3.5.m1.1.1.2.3.cmml" xref="S2.p3.5.m1.1.1.2.3">𝑗</ci></apply><cn id="S2.p3.5.m1.1.1.3.cmml" type="integer" xref="S2.p3.5.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m1.1c">v_{j}=0</annotation><annotation encoding="application/x-llamapun" id="S2.p3.5.m1.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 0</annotation></semantics></math>, <math alttext="w_{j}=0" class="ltx_Math" display="inline" id="S2.p3.6.m2.1"><semantics id="S2.p3.6.m2.1a"><mrow id="S2.p3.6.m2.1.1" xref="S2.p3.6.m2.1.1.cmml"><msub id="S2.p3.6.m2.1.1.2" xref="S2.p3.6.m2.1.1.2.cmml"><mi id="S2.p3.6.m2.1.1.2.2" xref="S2.p3.6.m2.1.1.2.2.cmml">w</mi><mi id="S2.p3.6.m2.1.1.2.3" xref="S2.p3.6.m2.1.1.2.3.cmml">j</mi></msub><mo id="S2.p3.6.m2.1.1.1" xref="S2.p3.6.m2.1.1.1.cmml">=</mo><mn id="S2.p3.6.m2.1.1.3" xref="S2.p3.6.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.6.m2.1b"><apply id="S2.p3.6.m2.1.1.cmml" xref="S2.p3.6.m2.1.1"><eq id="S2.p3.6.m2.1.1.1.cmml" xref="S2.p3.6.m2.1.1.1"></eq><apply id="S2.p3.6.m2.1.1.2.cmml" xref="S2.p3.6.m2.1.1.2"><csymbol cd="ambiguous" id="S2.p3.6.m2.1.1.2.1.cmml" xref="S2.p3.6.m2.1.1.2">subscript</csymbol><ci id="S2.p3.6.m2.1.1.2.2.cmml" xref="S2.p3.6.m2.1.1.2.2">𝑤</ci><ci id="S2.p3.6.m2.1.1.2.3.cmml" xref="S2.p3.6.m2.1.1.2.3">𝑗</ci></apply><cn id="S2.p3.6.m2.1.1.3.cmml" type="integer" xref="S2.p3.6.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m2.1c">w_{j}=0</annotation><annotation encoding="application/x-llamapun" id="S2.p3.6.m2.1d">italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 0</annotation></semantics></math> for any <math alttext="j" class="ltx_Math" display="inline" id="S2.p3.7.m3.1"><semantics id="S2.p3.7.m3.1a"><mi id="S2.p3.7.m3.1.1" xref="S2.p3.7.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p3.7.m3.1b"><ci id="S2.p3.7.m3.1.1.cmml" xref="S2.p3.7.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p3.7.m3.1d">italic_j</annotation></semantics></math> greater than <math alttext="t_{1},t_{2}" class="ltx_Math" display="inline" id="S2.p3.8.m4.2"><semantics id="S2.p3.8.m4.2a"><mrow id="S2.p3.8.m4.2.2.2" xref="S2.p3.8.m4.2.2.3.cmml"><msub id="S2.p3.8.m4.1.1.1.1" xref="S2.p3.8.m4.1.1.1.1.cmml"><mi id="S2.p3.8.m4.1.1.1.1.2" xref="S2.p3.8.m4.1.1.1.1.2.cmml">t</mi><mn id="S2.p3.8.m4.1.1.1.1.3" xref="S2.p3.8.m4.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.p3.8.m4.2.2.2.3" xref="S2.p3.8.m4.2.2.3.cmml">,</mo><msub id="S2.p3.8.m4.2.2.2.2" xref="S2.p3.8.m4.2.2.2.2.cmml"><mi id="S2.p3.8.m4.2.2.2.2.2" xref="S2.p3.8.m4.2.2.2.2.2.cmml">t</mi><mn id="S2.p3.8.m4.2.2.2.2.3" xref="S2.p3.8.m4.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.8.m4.2b"><list id="S2.p3.8.m4.2.2.3.cmml" xref="S2.p3.8.m4.2.2.2"><apply id="S2.p3.8.m4.1.1.1.1.cmml" xref="S2.p3.8.m4.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.8.m4.1.1.1.1.1.cmml" xref="S2.p3.8.m4.1.1.1.1">subscript</csymbol><ci id="S2.p3.8.m4.1.1.1.1.2.cmml" xref="S2.p3.8.m4.1.1.1.1.2">𝑡</ci><cn id="S2.p3.8.m4.1.1.1.1.3.cmml" type="integer" xref="S2.p3.8.m4.1.1.1.1.3">1</cn></apply><apply id="S2.p3.8.m4.2.2.2.2.cmml" xref="S2.p3.8.m4.2.2.2.2"><csymbol cd="ambiguous" id="S2.p3.8.m4.2.2.2.2.1.cmml" xref="S2.p3.8.m4.2.2.2.2">subscript</csymbol><ci id="S2.p3.8.m4.2.2.2.2.2.cmml" xref="S2.p3.8.m4.2.2.2.2.2">𝑡</ci><cn id="S2.p3.8.m4.2.2.2.2.3.cmml" type="integer" xref="S2.p3.8.m4.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m4.2c">t_{1},t_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.8.m4.2d">italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.5">We henceforth apply the FFT algorithm for computing convolutions. For two vectors <math alttext="v\in\mathbb{R}^{t_{1}}" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><mrow id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml"><mi id="S2.p4.1.m1.1.1.2" xref="S2.p4.1.m1.1.1.2.cmml">v</mi><mo id="S2.p4.1.m1.1.1.1" xref="S2.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S2.p4.1.m1.1.1.3" xref="S2.p4.1.m1.1.1.3.cmml"><mi id="S2.p4.1.m1.1.1.3.2" xref="S2.p4.1.m1.1.1.3.2.cmml">ℝ</mi><msub id="S2.p4.1.m1.1.1.3.3" xref="S2.p4.1.m1.1.1.3.3.cmml"><mi id="S2.p4.1.m1.1.1.3.3.2" xref="S2.p4.1.m1.1.1.3.3.2.cmml">t</mi><mn id="S2.p4.1.m1.1.1.3.3.3" xref="S2.p4.1.m1.1.1.3.3.3.cmml">1</mn></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"><in id="S2.p4.1.m1.1.1.1.cmml" xref="S2.p4.1.m1.1.1.1"></in><ci id="S2.p4.1.m1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.2">𝑣</ci><apply id="S2.p4.1.m1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.3.1.cmml" xref="S2.p4.1.m1.1.1.3">superscript</csymbol><ci id="S2.p4.1.m1.1.1.3.2.cmml" xref="S2.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S2.p4.1.m1.1.1.3.3.cmml" xref="S2.p4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.3.3.1.cmml" xref="S2.p4.1.m1.1.1.3.3">subscript</csymbol><ci id="S2.p4.1.m1.1.1.3.3.2.cmml" xref="S2.p4.1.m1.1.1.3.3.2">𝑡</ci><cn id="S2.p4.1.m1.1.1.3.3.3.cmml" type="integer" xref="S2.p4.1.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">v\in\mathbb{R}^{t_{1}}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">italic_v ∈ blackboard_R start_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="w\in\mathbb{R}^{t_{2}}" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><mrow id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml"><mi id="S2.p4.2.m2.1.1.2" xref="S2.p4.2.m2.1.1.2.cmml">w</mi><mo id="S2.p4.2.m2.1.1.1" xref="S2.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S2.p4.2.m2.1.1.3" xref="S2.p4.2.m2.1.1.3.cmml"><mi id="S2.p4.2.m2.1.1.3.2" xref="S2.p4.2.m2.1.1.3.2.cmml">ℝ</mi><msub id="S2.p4.2.m2.1.1.3.3" xref="S2.p4.2.m2.1.1.3.3.cmml"><mi id="S2.p4.2.m2.1.1.3.3.2" xref="S2.p4.2.m2.1.1.3.3.2.cmml">t</mi><mn id="S2.p4.2.m2.1.1.3.3.3" xref="S2.p4.2.m2.1.1.3.3.3.cmml">2</mn></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><apply id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1"><in id="S2.p4.2.m2.1.1.1.cmml" xref="S2.p4.2.m2.1.1.1"></in><ci id="S2.p4.2.m2.1.1.2.cmml" xref="S2.p4.2.m2.1.1.2">𝑤</ci><apply id="S2.p4.2.m2.1.1.3.cmml" xref="S2.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.3.1.cmml" xref="S2.p4.2.m2.1.1.3">superscript</csymbol><ci id="S2.p4.2.m2.1.1.3.2.cmml" xref="S2.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S2.p4.2.m2.1.1.3.3.cmml" xref="S2.p4.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.3.3.1.cmml" xref="S2.p4.2.m2.1.1.3.3">subscript</csymbol><ci id="S2.p4.2.m2.1.1.3.3.2.cmml" xref="S2.p4.2.m2.1.1.3.3.2">𝑡</ci><cn id="S2.p4.2.m2.1.1.3.3.3.cmml" type="integer" xref="S2.p4.2.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">w\in\mathbb{R}^{t_{2}}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">italic_w ∈ blackboard_R start_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, their convolution can be computed in time <math alttext="O(t\log t)" class="ltx_Math" display="inline" id="S2.p4.3.m3.1"><semantics id="S2.p4.3.m3.1a"><mrow id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml"><mi id="S2.p4.3.m3.1.1.3" xref="S2.p4.3.m3.1.1.3.cmml">O</mi><mo id="S2.p4.3.m3.1.1.2" xref="S2.p4.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.p4.3.m3.1.1.1.1" xref="S2.p4.3.m3.1.1.1.1.1.cmml"><mo id="S2.p4.3.m3.1.1.1.1.2" stretchy="false" xref="S2.p4.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.p4.3.m3.1.1.1.1.1" xref="S2.p4.3.m3.1.1.1.1.1.cmml"><mi id="S2.p4.3.m3.1.1.1.1.1.2" xref="S2.p4.3.m3.1.1.1.1.1.2.cmml">t</mi><mo id="S2.p4.3.m3.1.1.1.1.1.1" lspace="0.167em" xref="S2.p4.3.m3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.p4.3.m3.1.1.1.1.1.3" xref="S2.p4.3.m3.1.1.1.1.1.3.cmml"><mi id="S2.p4.3.m3.1.1.1.1.1.3.1" xref="S2.p4.3.m3.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.p4.3.m3.1.1.1.1.1.3a" lspace="0.167em" xref="S2.p4.3.m3.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.p4.3.m3.1.1.1.1.1.3.2" xref="S2.p4.3.m3.1.1.1.1.1.3.2.cmml">t</mi></mrow></mrow><mo id="S2.p4.3.m3.1.1.1.1.3" stretchy="false" xref="S2.p4.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.1b"><apply id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1"><times id="S2.p4.3.m3.1.1.2.cmml" xref="S2.p4.3.m3.1.1.2"></times><ci id="S2.p4.3.m3.1.1.3.cmml" xref="S2.p4.3.m3.1.1.3">𝑂</ci><apply id="S2.p4.3.m3.1.1.1.1.1.cmml" xref="S2.p4.3.m3.1.1.1.1"><times id="S2.p4.3.m3.1.1.1.1.1.1.cmml" xref="S2.p4.3.m3.1.1.1.1.1.1"></times><ci id="S2.p4.3.m3.1.1.1.1.1.2.cmml" xref="S2.p4.3.m3.1.1.1.1.1.2">𝑡</ci><apply id="S2.p4.3.m3.1.1.1.1.1.3.cmml" xref="S2.p4.3.m3.1.1.1.1.1.3"><log id="S2.p4.3.m3.1.1.1.1.1.3.1.cmml" xref="S2.p4.3.m3.1.1.1.1.1.3.1"></log><ci id="S2.p4.3.m3.1.1.1.1.1.3.2.cmml" xref="S2.p4.3.m3.1.1.1.1.1.3.2">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.1c">O(t\log t)</annotation><annotation encoding="application/x-llamapun" id="S2.p4.3.m3.1d">italic_O ( italic_t roman_log italic_t )</annotation></semantics></math> where <math alttext="t=t_{1}+t_{2}" class="ltx_Math" display="inline" id="S2.p4.4.m4.1"><semantics id="S2.p4.4.m4.1a"><mrow id="S2.p4.4.m4.1.1" xref="S2.p4.4.m4.1.1.cmml"><mi id="S2.p4.4.m4.1.1.2" xref="S2.p4.4.m4.1.1.2.cmml">t</mi><mo id="S2.p4.4.m4.1.1.1" xref="S2.p4.4.m4.1.1.1.cmml">=</mo><mrow id="S2.p4.4.m4.1.1.3" xref="S2.p4.4.m4.1.1.3.cmml"><msub id="S2.p4.4.m4.1.1.3.2" xref="S2.p4.4.m4.1.1.3.2.cmml"><mi id="S2.p4.4.m4.1.1.3.2.2" xref="S2.p4.4.m4.1.1.3.2.2.cmml">t</mi><mn id="S2.p4.4.m4.1.1.3.2.3" xref="S2.p4.4.m4.1.1.3.2.3.cmml">1</mn></msub><mo id="S2.p4.4.m4.1.1.3.1" xref="S2.p4.4.m4.1.1.3.1.cmml">+</mo><msub id="S2.p4.4.m4.1.1.3.3" xref="S2.p4.4.m4.1.1.3.3.cmml"><mi id="S2.p4.4.m4.1.1.3.3.2" xref="S2.p4.4.m4.1.1.3.3.2.cmml">t</mi><mn id="S2.p4.4.m4.1.1.3.3.3" xref="S2.p4.4.m4.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.4.m4.1b"><apply id="S2.p4.4.m4.1.1.cmml" xref="S2.p4.4.m4.1.1"><eq id="S2.p4.4.m4.1.1.1.cmml" xref="S2.p4.4.m4.1.1.1"></eq><ci id="S2.p4.4.m4.1.1.2.cmml" xref="S2.p4.4.m4.1.1.2">𝑡</ci><apply id="S2.p4.4.m4.1.1.3.cmml" xref="S2.p4.4.m4.1.1.3"><plus id="S2.p4.4.m4.1.1.3.1.cmml" xref="S2.p4.4.m4.1.1.3.1"></plus><apply id="S2.p4.4.m4.1.1.3.2.cmml" xref="S2.p4.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.p4.4.m4.1.1.3.2.1.cmml" xref="S2.p4.4.m4.1.1.3.2">subscript</csymbol><ci id="S2.p4.4.m4.1.1.3.2.2.cmml" xref="S2.p4.4.m4.1.1.3.2.2">𝑡</ci><cn id="S2.p4.4.m4.1.1.3.2.3.cmml" type="integer" xref="S2.p4.4.m4.1.1.3.2.3">1</cn></apply><apply id="S2.p4.4.m4.1.1.3.3.cmml" xref="S2.p4.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.p4.4.m4.1.1.3.3.1.cmml" xref="S2.p4.4.m4.1.1.3.3">subscript</csymbol><ci id="S2.p4.4.m4.1.1.3.3.2.cmml" xref="S2.p4.4.m4.1.1.3.3.2">𝑡</ci><cn id="S2.p4.4.m4.1.1.3.3.3.cmml" type="integer" xref="S2.p4.4.m4.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m4.1c">t=t_{1}+t_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.4.m4.1d">italic_t = italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, yielding, among others, <math alttext="t" class="ltx_Math" display="inline" id="S2.p4.5.m5.1"><semantics id="S2.p4.5.m5.1a"><mi id="S2.p4.5.m5.1.1" xref="S2.p4.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p4.5.m5.1b"><ci id="S2.p4.5.m5.1.1.cmml" xref="S2.p4.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p4.5.m5.1d">italic_t</annotation></semantics></math> inner products of the form</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\langle v_{1:t},w_{t:1}\rangle,\langle v_{1:t-1},w_{t-1:1}\rangle,...\langle v%
_{1:1},w_{1:1}\rangle." class="ltx_Math" display="block" id="S2.Ex1.m1.1"><semantics id="S2.Ex1.m1.1a"><mrow id="S2.Ex1.m1.1.1.1"><mrow id="S2.Ex1.m1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.4.cmml"><mrow id="S2.Ex1.m1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.1.3.cmml"><mo id="S2.Ex1.m1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.1.1.3.cmml">⟨</mo><msub id="S2.Ex1.m1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mrow id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.Ex1.m1.1.1.1.1.1.1.2.4" xref="S2.Ex1.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.Ex1.m1.1.1.1.1.1.1.2.2" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.2.2.2" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.2.cmml">w</mi><mrow id="S2.Ex1.m1.1.1.1.1.1.1.2.2.3" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.2" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.1.cmml">:</mo><mn id="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.3" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.Ex1.m1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="S2.Ex1.m1.1.1.1.1.3.4" xref="S2.Ex1.m1.1.1.1.1.4.cmml">,</mo><mrow id="S2.Ex1.m1.1.1.1.1.2.2.2" xref="S2.Ex1.m1.1.1.1.1.2.2.3.cmml"><mo id="S2.Ex1.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.2.2.3.cmml">⟨</mo><msub id="S2.Ex1.m1.1.1.1.1.2.2.1.1" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2.1.1.2" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.2.cmml">v</mi><mrow id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.cmml"><mn id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.2" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.2.cmml">1</mn><mo id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.1.cmml">:</mo><mrow id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.2" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.2.cmml">t</mi><mo id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.1" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.1.cmml">−</mo><mn id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.3" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.Ex1.m1.1.1.1.1.2.2.2.4" xref="S2.Ex1.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.Ex1.m1.1.1.1.1.2.2.2.2" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2.2.2.2" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.2.cmml">w</mi><mrow id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.cmml"><mrow id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.2" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.2.cmml">t</mi><mo id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.1" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.1.cmml">−</mo><mn id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.3" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.3.cmml">1</mn></mrow><mo id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.1.cmml">:</mo><mn id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.3" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.Ex1.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.2.2.3.cmml">⟩</mo></mrow><mo id="S2.Ex1.m1.1.1.1.1.3.5" xref="S2.Ex1.m1.1.1.1.1.4.cmml">,</mo><mrow id="S2.Ex1.m1.1.1.1.1.3.3" xref="S2.Ex1.m1.1.1.1.1.3.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.3.3.4" mathvariant="normal" xref="S2.Ex1.m1.1.1.1.1.3.3.4.cmml">…</mi><mo id="S2.Ex1.m1.1.1.1.1.3.3.3" xref="S2.Ex1.m1.1.1.1.1.3.3.3.cmml">⁢</mo><mrow id="S2.Ex1.m1.1.1.1.1.3.3.2.2" xref="S2.Ex1.m1.1.1.1.1.3.3.2.3.cmml"><mo id="S2.Ex1.m1.1.1.1.1.3.3.2.2.3" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.3.3.2.3.cmml">⟨</mo><msub id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.cmml"><mi id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.2.cmml">v</mi><mrow id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.cmml"><mn id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.2" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.2.cmml">1</mn><mo id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.1.cmml">:</mo><mn id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.3" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S2.Ex1.m1.1.1.1.1.3.3.2.2.4" xref="S2.Ex1.m1.1.1.1.1.3.3.2.3.cmml">,</mo><msub id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.2" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.2.cmml">w</mi><mrow id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.cmml"><mn id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.2" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.2.cmml">1</mn><mo id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.1.cmml">:</mo><mn id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.3" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.Ex1.m1.1.1.1.1.3.3.2.2.5" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.3.3.2.3.cmml">⟩</mo></mrow></mrow></mrow><mo id="S2.Ex1.m1.1.1.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><list id="S2.Ex1.m1.1.1.1.1.4.cmml" xref="S2.Ex1.m1.1.1.1.1.3"><list id="S2.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2"><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2">𝑣</ci><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3"><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S2.Ex1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.2">𝑤</ci><apply id="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.3"><ci id="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.1">:</ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply></list><list id="S2.Ex1.m1.1.1.1.1.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2"><apply id="S2.Ex1.m1.1.1.1.1.2.2.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.2">𝑣</ci><apply id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3"><ci id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.1">:</ci><cn id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.2.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.2">1</cn><apply id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3"><minus id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.1"></minus><ci id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.2">𝑡</ci><cn id="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.3.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.2.2.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S2.Ex1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.2">𝑤</ci><apply id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3"><ci id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.1">:</ci><apply id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2"><minus id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.1"></minus><ci id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.2">𝑡</ci><cn id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.3.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.2.3">1</cn></apply><cn id="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.2.2.2.2.3.3">1</cn></apply></apply></list><apply id="S2.Ex1.m1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3"><times id="S2.Ex1.m1.1.1.1.1.3.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.3"></times><ci id="S2.Ex1.m1.1.1.1.1.3.3.4.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.4">…</ci><list id="S2.Ex1.m1.1.1.1.1.3.3.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2"><apply id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.2">𝑣</ci><apply id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3"><ci id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.1">:</ci><cn id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.2.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.2">1</cn><cn id="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.3.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.2">𝑤</ci><apply id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3"><ci id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.1">:</ci><cn id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.2.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.2">1</cn><cn id="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.3.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.3.3.2.2.2.3.3">1</cn></apply></apply></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\langle v_{1:t},w_{t:1}\rangle,\langle v_{1:t-1},w_{t-1:1}\rangle,...\langle v%
_{1:1},w_{1:1}\rangle.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.1d">⟨ italic_v start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT italic_t : 1 end_POSTSUBSCRIPT ⟩ , ⟨ italic_v start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT italic_t - 1 : 1 end_POSTSUBSCRIPT ⟩ , … ⟨ italic_v start_POSTSUBSCRIPT 1 : 1 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 1 : 1 end_POSTSUBSCRIPT ⟩ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.p5">
<p class="ltx_p" id="S2.p5.9">Given a multi-dimensional sequence <math alttext="u_{1}\ldots u_{t}" class="ltx_Math" display="inline" id="S2.p5.1.m1.1"><semantics id="S2.p5.1.m1.1a"><mrow id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml"><msub id="S2.p5.1.m1.1.1.2" xref="S2.p5.1.m1.1.1.2.cmml"><mi id="S2.p5.1.m1.1.1.2.2" xref="S2.p5.1.m1.1.1.2.2.cmml">u</mi><mn id="S2.p5.1.m1.1.1.2.3" xref="S2.p5.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S2.p5.1.m1.1.1.1" xref="S2.p5.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.p5.1.m1.1.1.3" mathvariant="normal" xref="S2.p5.1.m1.1.1.3.cmml">…</mi><mo id="S2.p5.1.m1.1.1.1a" xref="S2.p5.1.m1.1.1.1.cmml">⁢</mo><msub id="S2.p5.1.m1.1.1.4" xref="S2.p5.1.m1.1.1.4.cmml"><mi id="S2.p5.1.m1.1.1.4.2" xref="S2.p5.1.m1.1.1.4.2.cmml">u</mi><mi id="S2.p5.1.m1.1.1.4.3" xref="S2.p5.1.m1.1.1.4.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><apply id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1"><times id="S2.p5.1.m1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1"></times><apply id="S2.p5.1.m1.1.1.2.cmml" xref="S2.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.p5.1.m1.1.1.2.1.cmml" xref="S2.p5.1.m1.1.1.2">subscript</csymbol><ci id="S2.p5.1.m1.1.1.2.2.cmml" xref="S2.p5.1.m1.1.1.2.2">𝑢</ci><cn id="S2.p5.1.m1.1.1.2.3.cmml" type="integer" xref="S2.p5.1.m1.1.1.2.3">1</cn></apply><ci id="S2.p5.1.m1.1.1.3.cmml" xref="S2.p5.1.m1.1.1.3">…</ci><apply id="S2.p5.1.m1.1.1.4.cmml" xref="S2.p5.1.m1.1.1.4"><csymbol cd="ambiguous" id="S2.p5.1.m1.1.1.4.1.cmml" xref="S2.p5.1.m1.1.1.4">subscript</csymbol><ci id="S2.p5.1.m1.1.1.4.2.cmml" xref="S2.p5.1.m1.1.1.4.2">𝑢</ci><ci id="S2.p5.1.m1.1.1.4.3.cmml" xref="S2.p5.1.m1.1.1.4.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">u_{1}\ldots u_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.1.m1.1d">italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> where each <math alttext="u_{i}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.p5.2.m2.1"><semantics id="S2.p5.2.m2.1a"><mrow id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml"><msub id="S2.p5.2.m2.1.1.2" xref="S2.p5.2.m2.1.1.2.cmml"><mi id="S2.p5.2.m2.1.1.2.2" xref="S2.p5.2.m2.1.1.2.2.cmml">u</mi><mi id="S2.p5.2.m2.1.1.2.3" xref="S2.p5.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S2.p5.2.m2.1.1.1" xref="S2.p5.2.m2.1.1.1.cmml">∈</mo><msup id="S2.p5.2.m2.1.1.3" xref="S2.p5.2.m2.1.1.3.cmml"><mi id="S2.p5.2.m2.1.1.3.2" xref="S2.p5.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S2.p5.2.m2.1.1.3.3" xref="S2.p5.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.1b"><apply id="S2.p5.2.m2.1.1.cmml" xref="S2.p5.2.m2.1.1"><in id="S2.p5.2.m2.1.1.1.cmml" xref="S2.p5.2.m2.1.1.1"></in><apply id="S2.p5.2.m2.1.1.2.cmml" xref="S2.p5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.p5.2.m2.1.1.2.1.cmml" xref="S2.p5.2.m2.1.1.2">subscript</csymbol><ci id="S2.p5.2.m2.1.1.2.2.cmml" xref="S2.p5.2.m2.1.1.2.2">𝑢</ci><ci id="S2.p5.2.m2.1.1.2.3.cmml" xref="S2.p5.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S2.p5.2.m2.1.1.3.cmml" xref="S2.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.p5.2.m2.1.1.3.1.cmml" xref="S2.p5.2.m2.1.1.3">superscript</csymbol><ci id="S2.p5.2.m2.1.1.3.2.cmml" xref="S2.p5.2.m2.1.1.3.2">ℝ</ci><ci id="S2.p5.2.m2.1.1.3.3.cmml" xref="S2.p5.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.1c">u_{i}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.2.m2.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and given a vector <math alttext="v\in\mathbb{R}^{t}" class="ltx_Math" display="inline" id="S2.p5.3.m3.1"><semantics id="S2.p5.3.m3.1a"><mrow id="S2.p5.3.m3.1.1" xref="S2.p5.3.m3.1.1.cmml"><mi id="S2.p5.3.m3.1.1.2" xref="S2.p5.3.m3.1.1.2.cmml">v</mi><mo id="S2.p5.3.m3.1.1.1" xref="S2.p5.3.m3.1.1.1.cmml">∈</mo><msup id="S2.p5.3.m3.1.1.3" xref="S2.p5.3.m3.1.1.3.cmml"><mi id="S2.p5.3.m3.1.1.3.2" xref="S2.p5.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S2.p5.3.m3.1.1.3.3" xref="S2.p5.3.m3.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.3.m3.1b"><apply id="S2.p5.3.m3.1.1.cmml" xref="S2.p5.3.m3.1.1"><in id="S2.p5.3.m3.1.1.1.cmml" xref="S2.p5.3.m3.1.1.1"></in><ci id="S2.p5.3.m3.1.1.2.cmml" xref="S2.p5.3.m3.1.1.2">𝑣</ci><apply id="S2.p5.3.m3.1.1.3.cmml" xref="S2.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.p5.3.m3.1.1.3.1.cmml" xref="S2.p5.3.m3.1.1.3">superscript</csymbol><ci id="S2.p5.3.m3.1.1.3.2.cmml" xref="S2.p5.3.m3.1.1.3.2">ℝ</ci><ci id="S2.p5.3.m3.1.1.3.3.cmml" xref="S2.p5.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.3.m3.1c">v\in\mathbb{R}^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.3.m3.1d">italic_v ∈ blackboard_R start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, for brevity of notation we overload the definition of inner products by defining <math alttext="y=\langle v,u_{1:t}\rangle" class="ltx_Math" display="inline" id="S2.p5.4.m4.2"><semantics id="S2.p5.4.m4.2a"><mrow id="S2.p5.4.m4.2.2" xref="S2.p5.4.m4.2.2.cmml"><mi id="S2.p5.4.m4.2.2.3" xref="S2.p5.4.m4.2.2.3.cmml">y</mi><mo id="S2.p5.4.m4.2.2.2" xref="S2.p5.4.m4.2.2.2.cmml">=</mo><mrow id="S2.p5.4.m4.2.2.1.1" xref="S2.p5.4.m4.2.2.1.2.cmml"><mo id="S2.p5.4.m4.2.2.1.1.2" stretchy="false" xref="S2.p5.4.m4.2.2.1.2.cmml">⟨</mo><mi id="S2.p5.4.m4.1.1" xref="S2.p5.4.m4.1.1.cmml">v</mi><mo id="S2.p5.4.m4.2.2.1.1.3" xref="S2.p5.4.m4.2.2.1.2.cmml">,</mo><msub id="S2.p5.4.m4.2.2.1.1.1" xref="S2.p5.4.m4.2.2.1.1.1.cmml"><mi id="S2.p5.4.m4.2.2.1.1.1.2" xref="S2.p5.4.m4.2.2.1.1.1.2.cmml">u</mi><mrow id="S2.p5.4.m4.2.2.1.1.1.3" xref="S2.p5.4.m4.2.2.1.1.1.3.cmml"><mn id="S2.p5.4.m4.2.2.1.1.1.3.2" xref="S2.p5.4.m4.2.2.1.1.1.3.2.cmml">1</mn><mo id="S2.p5.4.m4.2.2.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.4.m4.2.2.1.1.1.3.1.cmml">:</mo><mi id="S2.p5.4.m4.2.2.1.1.1.3.3" xref="S2.p5.4.m4.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.p5.4.m4.2.2.1.1.4" stretchy="false" xref="S2.p5.4.m4.2.2.1.2.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.4.m4.2b"><apply id="S2.p5.4.m4.2.2.cmml" xref="S2.p5.4.m4.2.2"><eq id="S2.p5.4.m4.2.2.2.cmml" xref="S2.p5.4.m4.2.2.2"></eq><ci id="S2.p5.4.m4.2.2.3.cmml" xref="S2.p5.4.m4.2.2.3">𝑦</ci><list id="S2.p5.4.m4.2.2.1.2.cmml" xref="S2.p5.4.m4.2.2.1.1"><ci id="S2.p5.4.m4.1.1.cmml" xref="S2.p5.4.m4.1.1">𝑣</ci><apply id="S2.p5.4.m4.2.2.1.1.1.cmml" xref="S2.p5.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p5.4.m4.2.2.1.1.1.1.cmml" xref="S2.p5.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.p5.4.m4.2.2.1.1.1.2.cmml" xref="S2.p5.4.m4.2.2.1.1.1.2">𝑢</ci><apply id="S2.p5.4.m4.2.2.1.1.1.3.cmml" xref="S2.p5.4.m4.2.2.1.1.1.3"><ci id="S2.p5.4.m4.2.2.1.1.1.3.1.cmml" xref="S2.p5.4.m4.2.2.1.1.1.3.1">:</ci><cn id="S2.p5.4.m4.2.2.1.1.1.3.2.cmml" type="integer" xref="S2.p5.4.m4.2.2.1.1.1.3.2">1</cn><ci id="S2.p5.4.m4.2.2.1.1.1.3.3.cmml" xref="S2.p5.4.m4.2.2.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.4.m4.2c">y=\langle v,u_{1:t}\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.p5.4.m4.2d">italic_y = ⟨ italic_v , italic_u start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT ⟩</annotation></semantics></math> with <math alttext="y\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.p5.5.m5.1"><semantics id="S2.p5.5.m5.1a"><mrow id="S2.p5.5.m5.1.1" xref="S2.p5.5.m5.1.1.cmml"><mi id="S2.p5.5.m5.1.1.2" xref="S2.p5.5.m5.1.1.2.cmml">y</mi><mo id="S2.p5.5.m5.1.1.1" xref="S2.p5.5.m5.1.1.1.cmml">∈</mo><msup id="S2.p5.5.m5.1.1.3" xref="S2.p5.5.m5.1.1.3.cmml"><mi id="S2.p5.5.m5.1.1.3.2" xref="S2.p5.5.m5.1.1.3.2.cmml">ℝ</mi><mi id="S2.p5.5.m5.1.1.3.3" xref="S2.p5.5.m5.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.5.m5.1b"><apply id="S2.p5.5.m5.1.1.cmml" xref="S2.p5.5.m5.1.1"><in id="S2.p5.5.m5.1.1.1.cmml" xref="S2.p5.5.m5.1.1.1"></in><ci id="S2.p5.5.m5.1.1.2.cmml" xref="S2.p5.5.m5.1.1.2">𝑦</ci><apply id="S2.p5.5.m5.1.1.3.cmml" xref="S2.p5.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.p5.5.m5.1.1.3.1.cmml" xref="S2.p5.5.m5.1.1.3">superscript</csymbol><ci id="S2.p5.5.m5.1.1.3.2.cmml" xref="S2.p5.5.m5.1.1.3.2">ℝ</ci><ci id="S2.p5.5.m5.1.1.3.3.cmml" xref="S2.p5.5.m5.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.5.m5.1c">y\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.5.m5.1d">italic_y ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> as <math alttext="y_{j}=\sum_{i=1}^{t}v_{i}\cdot[u_{i}]_{j}" class="ltx_Math" display="inline" id="S2.p5.6.m6.1"><semantics id="S2.p5.6.m6.1a"><mrow id="S2.p5.6.m6.1.1" xref="S2.p5.6.m6.1.1.cmml"><msub id="S2.p5.6.m6.1.1.3" xref="S2.p5.6.m6.1.1.3.cmml"><mi id="S2.p5.6.m6.1.1.3.2" xref="S2.p5.6.m6.1.1.3.2.cmml">y</mi><mi id="S2.p5.6.m6.1.1.3.3" xref="S2.p5.6.m6.1.1.3.3.cmml">j</mi></msub><mo id="S2.p5.6.m6.1.1.2" rspace="0.111em" xref="S2.p5.6.m6.1.1.2.cmml">=</mo><mrow id="S2.p5.6.m6.1.1.1" xref="S2.p5.6.m6.1.1.1.cmml"><msubsup id="S2.p5.6.m6.1.1.1.2" xref="S2.p5.6.m6.1.1.1.2.cmml"><mo id="S2.p5.6.m6.1.1.1.2.2.2" xref="S2.p5.6.m6.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.p5.6.m6.1.1.1.2.2.3" xref="S2.p5.6.m6.1.1.1.2.2.3.cmml"><mi id="S2.p5.6.m6.1.1.1.2.2.3.2" xref="S2.p5.6.m6.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.p5.6.m6.1.1.1.2.2.3.1" xref="S2.p5.6.m6.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.p5.6.m6.1.1.1.2.2.3.3" xref="S2.p5.6.m6.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.p5.6.m6.1.1.1.2.3" xref="S2.p5.6.m6.1.1.1.2.3.cmml">t</mi></msubsup><mrow id="S2.p5.6.m6.1.1.1.1" xref="S2.p5.6.m6.1.1.1.1.cmml"><msub id="S2.p5.6.m6.1.1.1.1.3" xref="S2.p5.6.m6.1.1.1.1.3.cmml"><mi id="S2.p5.6.m6.1.1.1.1.3.2" xref="S2.p5.6.m6.1.1.1.1.3.2.cmml">v</mi><mi id="S2.p5.6.m6.1.1.1.1.3.3" xref="S2.p5.6.m6.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S2.p5.6.m6.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.p5.6.m6.1.1.1.1.2.cmml">⋅</mo><msub id="S2.p5.6.m6.1.1.1.1.1" xref="S2.p5.6.m6.1.1.1.1.1.cmml"><mrow id="S2.p5.6.m6.1.1.1.1.1.1.1" xref="S2.p5.6.m6.1.1.1.1.1.1.2.cmml"><mo id="S2.p5.6.m6.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.p5.6.m6.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="S2.p5.6.m6.1.1.1.1.1.1.1.1" xref="S2.p5.6.m6.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p5.6.m6.1.1.1.1.1.1.1.1.2" xref="S2.p5.6.m6.1.1.1.1.1.1.1.1.2.cmml">u</mi><mi id="S2.p5.6.m6.1.1.1.1.1.1.1.1.3" xref="S2.p5.6.m6.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p5.6.m6.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.p5.6.m6.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S2.p5.6.m6.1.1.1.1.1.3" xref="S2.p5.6.m6.1.1.1.1.1.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.6.m6.1b"><apply id="S2.p5.6.m6.1.1.cmml" xref="S2.p5.6.m6.1.1"><eq id="S2.p5.6.m6.1.1.2.cmml" xref="S2.p5.6.m6.1.1.2"></eq><apply id="S2.p5.6.m6.1.1.3.cmml" xref="S2.p5.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.p5.6.m6.1.1.3.1.cmml" xref="S2.p5.6.m6.1.1.3">subscript</csymbol><ci id="S2.p5.6.m6.1.1.3.2.cmml" xref="S2.p5.6.m6.1.1.3.2">𝑦</ci><ci id="S2.p5.6.m6.1.1.3.3.cmml" xref="S2.p5.6.m6.1.1.3.3">𝑗</ci></apply><apply id="S2.p5.6.m6.1.1.1.cmml" xref="S2.p5.6.m6.1.1.1"><apply id="S2.p5.6.m6.1.1.1.2.cmml" xref="S2.p5.6.m6.1.1.1.2"><csymbol cd="ambiguous" id="S2.p5.6.m6.1.1.1.2.1.cmml" xref="S2.p5.6.m6.1.1.1.2">superscript</csymbol><apply id="S2.p5.6.m6.1.1.1.2.2.cmml" xref="S2.p5.6.m6.1.1.1.2"><csymbol cd="ambiguous" id="S2.p5.6.m6.1.1.1.2.2.1.cmml" xref="S2.p5.6.m6.1.1.1.2">subscript</csymbol><sum id="S2.p5.6.m6.1.1.1.2.2.2.cmml" xref="S2.p5.6.m6.1.1.1.2.2.2"></sum><apply id="S2.p5.6.m6.1.1.1.2.2.3.cmml" xref="S2.p5.6.m6.1.1.1.2.2.3"><eq id="S2.p5.6.m6.1.1.1.2.2.3.1.cmml" xref="S2.p5.6.m6.1.1.1.2.2.3.1"></eq><ci id="S2.p5.6.m6.1.1.1.2.2.3.2.cmml" xref="S2.p5.6.m6.1.1.1.2.2.3.2">𝑖</ci><cn id="S2.p5.6.m6.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.p5.6.m6.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.p5.6.m6.1.1.1.2.3.cmml" xref="S2.p5.6.m6.1.1.1.2.3">𝑡</ci></apply><apply id="S2.p5.6.m6.1.1.1.1.cmml" xref="S2.p5.6.m6.1.1.1.1"><ci id="S2.p5.6.m6.1.1.1.1.2.cmml" xref="S2.p5.6.m6.1.1.1.1.2">⋅</ci><apply id="S2.p5.6.m6.1.1.1.1.3.cmml" xref="S2.p5.6.m6.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p5.6.m6.1.1.1.1.3.1.cmml" xref="S2.p5.6.m6.1.1.1.1.3">subscript</csymbol><ci id="S2.p5.6.m6.1.1.1.1.3.2.cmml" xref="S2.p5.6.m6.1.1.1.1.3.2">𝑣</ci><ci id="S2.p5.6.m6.1.1.1.1.3.3.cmml" xref="S2.p5.6.m6.1.1.1.1.3.3">𝑖</ci></apply><apply id="S2.p5.6.m6.1.1.1.1.1.cmml" xref="S2.p5.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p5.6.m6.1.1.1.1.1.2.cmml" xref="S2.p5.6.m6.1.1.1.1.1">subscript</csymbol><apply id="S2.p5.6.m6.1.1.1.1.1.1.2.cmml" xref="S2.p5.6.m6.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p5.6.m6.1.1.1.1.1.1.2.1.cmml" xref="S2.p5.6.m6.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.p5.6.m6.1.1.1.1.1.1.1.1.cmml" xref="S2.p5.6.m6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p5.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p5.6.m6.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p5.6.m6.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p5.6.m6.1.1.1.1.1.1.1.1.2">𝑢</ci><ci id="S2.p5.6.m6.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p5.6.m6.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S2.p5.6.m6.1.1.1.1.1.3.cmml" xref="S2.p5.6.m6.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.6.m6.1c">y_{j}=\sum_{i=1}^{t}v_{i}\cdot[u_{i}]_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.6.m6.1d">italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ [ italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. That is the inner-product along the time dimension is applied on each input dimension separately. Further when we have a sequence of matrices <math alttext="v_{1:t}=\{v_{1}\ldots v_{t}\}" class="ltx_Math" display="inline" id="S2.p5.7.m7.1"><semantics id="S2.p5.7.m7.1a"><mrow id="S2.p5.7.m7.1.1" xref="S2.p5.7.m7.1.1.cmml"><msub id="S2.p5.7.m7.1.1.3" xref="S2.p5.7.m7.1.1.3.cmml"><mi id="S2.p5.7.m7.1.1.3.2" xref="S2.p5.7.m7.1.1.3.2.cmml">v</mi><mrow id="S2.p5.7.m7.1.1.3.3" xref="S2.p5.7.m7.1.1.3.3.cmml"><mn id="S2.p5.7.m7.1.1.3.3.2" xref="S2.p5.7.m7.1.1.3.3.2.cmml">1</mn><mo id="S2.p5.7.m7.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.7.m7.1.1.3.3.1.cmml">:</mo><mi id="S2.p5.7.m7.1.1.3.3.3" xref="S2.p5.7.m7.1.1.3.3.3.cmml">t</mi></mrow></msub><mo id="S2.p5.7.m7.1.1.2" xref="S2.p5.7.m7.1.1.2.cmml">=</mo><mrow id="S2.p5.7.m7.1.1.1.1" xref="S2.p5.7.m7.1.1.1.2.cmml"><mo id="S2.p5.7.m7.1.1.1.1.2" stretchy="false" xref="S2.p5.7.m7.1.1.1.2.cmml">{</mo><mrow id="S2.p5.7.m7.1.1.1.1.1" xref="S2.p5.7.m7.1.1.1.1.1.cmml"><msub id="S2.p5.7.m7.1.1.1.1.1.2" xref="S2.p5.7.m7.1.1.1.1.1.2.cmml"><mi id="S2.p5.7.m7.1.1.1.1.1.2.2" xref="S2.p5.7.m7.1.1.1.1.1.2.2.cmml">v</mi><mn id="S2.p5.7.m7.1.1.1.1.1.2.3" xref="S2.p5.7.m7.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.p5.7.m7.1.1.1.1.1.1" xref="S2.p5.7.m7.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.p5.7.m7.1.1.1.1.1.3" mathvariant="normal" xref="S2.p5.7.m7.1.1.1.1.1.3.cmml">…</mi><mo id="S2.p5.7.m7.1.1.1.1.1.1a" xref="S2.p5.7.m7.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.p5.7.m7.1.1.1.1.1.4" xref="S2.p5.7.m7.1.1.1.1.1.4.cmml"><mi id="S2.p5.7.m7.1.1.1.1.1.4.2" xref="S2.p5.7.m7.1.1.1.1.1.4.2.cmml">v</mi><mi id="S2.p5.7.m7.1.1.1.1.1.4.3" xref="S2.p5.7.m7.1.1.1.1.1.4.3.cmml">t</mi></msub></mrow><mo id="S2.p5.7.m7.1.1.1.1.3" stretchy="false" xref="S2.p5.7.m7.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.7.m7.1b"><apply id="S2.p5.7.m7.1.1.cmml" xref="S2.p5.7.m7.1.1"><eq id="S2.p5.7.m7.1.1.2.cmml" xref="S2.p5.7.m7.1.1.2"></eq><apply id="S2.p5.7.m7.1.1.3.cmml" xref="S2.p5.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.p5.7.m7.1.1.3.1.cmml" xref="S2.p5.7.m7.1.1.3">subscript</csymbol><ci id="S2.p5.7.m7.1.1.3.2.cmml" xref="S2.p5.7.m7.1.1.3.2">𝑣</ci><apply id="S2.p5.7.m7.1.1.3.3.cmml" xref="S2.p5.7.m7.1.1.3.3"><ci id="S2.p5.7.m7.1.1.3.3.1.cmml" xref="S2.p5.7.m7.1.1.3.3.1">:</ci><cn id="S2.p5.7.m7.1.1.3.3.2.cmml" type="integer" xref="S2.p5.7.m7.1.1.3.3.2">1</cn><ci id="S2.p5.7.m7.1.1.3.3.3.cmml" xref="S2.p5.7.m7.1.1.3.3.3">𝑡</ci></apply></apply><set id="S2.p5.7.m7.1.1.1.2.cmml" xref="S2.p5.7.m7.1.1.1.1"><apply id="S2.p5.7.m7.1.1.1.1.1.cmml" xref="S2.p5.7.m7.1.1.1.1.1"><times id="S2.p5.7.m7.1.1.1.1.1.1.cmml" xref="S2.p5.7.m7.1.1.1.1.1.1"></times><apply id="S2.p5.7.m7.1.1.1.1.1.2.cmml" xref="S2.p5.7.m7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p5.7.m7.1.1.1.1.1.2.1.cmml" xref="S2.p5.7.m7.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p5.7.m7.1.1.1.1.1.2.2.cmml" xref="S2.p5.7.m7.1.1.1.1.1.2.2">𝑣</ci><cn id="S2.p5.7.m7.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.p5.7.m7.1.1.1.1.1.2.3">1</cn></apply><ci id="S2.p5.7.m7.1.1.1.1.1.3.cmml" xref="S2.p5.7.m7.1.1.1.1.1.3">…</ci><apply id="S2.p5.7.m7.1.1.1.1.1.4.cmml" xref="S2.p5.7.m7.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.p5.7.m7.1.1.1.1.1.4.1.cmml" xref="S2.p5.7.m7.1.1.1.1.1.4">subscript</csymbol><ci id="S2.p5.7.m7.1.1.1.1.1.4.2.cmml" xref="S2.p5.7.m7.1.1.1.1.1.4.2">𝑣</ci><ci id="S2.p5.7.m7.1.1.1.1.1.4.3.cmml" xref="S2.p5.7.m7.1.1.1.1.1.4.3">𝑡</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.7.m7.1c">v_{1:t}=\{v_{1}\ldots v_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.7.m7.1d">italic_v start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> with each <math alttext="v_{i}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S2.p5.8.m8.1"><semantics id="S2.p5.8.m8.1a"><mrow id="S2.p5.8.m8.1.1" xref="S2.p5.8.m8.1.1.cmml"><msub id="S2.p5.8.m8.1.1.2" xref="S2.p5.8.m8.1.1.2.cmml"><mi id="S2.p5.8.m8.1.1.2.2" xref="S2.p5.8.m8.1.1.2.2.cmml">v</mi><mi id="S2.p5.8.m8.1.1.2.3" xref="S2.p5.8.m8.1.1.2.3.cmml">i</mi></msub><mo id="S2.p5.8.m8.1.1.1" xref="S2.p5.8.m8.1.1.1.cmml">∈</mo><msup id="S2.p5.8.m8.1.1.3" xref="S2.p5.8.m8.1.1.3.cmml"><mi id="S2.p5.8.m8.1.1.3.2" xref="S2.p5.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p5.8.m8.1.1.3.3" xref="S2.p5.8.m8.1.1.3.3.cmml"><mi id="S2.p5.8.m8.1.1.3.3.2" xref="S2.p5.8.m8.1.1.3.3.2.cmml">d</mi><mo id="S2.p5.8.m8.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.p5.8.m8.1.1.3.3.1.cmml">×</mo><mi id="S2.p5.8.m8.1.1.3.3.3" xref="S2.p5.8.m8.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.8.m8.1b"><apply id="S2.p5.8.m8.1.1.cmml" xref="S2.p5.8.m8.1.1"><in id="S2.p5.8.m8.1.1.1.cmml" xref="S2.p5.8.m8.1.1.1"></in><apply id="S2.p5.8.m8.1.1.2.cmml" xref="S2.p5.8.m8.1.1.2"><csymbol cd="ambiguous" id="S2.p5.8.m8.1.1.2.1.cmml" xref="S2.p5.8.m8.1.1.2">subscript</csymbol><ci id="S2.p5.8.m8.1.1.2.2.cmml" xref="S2.p5.8.m8.1.1.2.2">𝑣</ci><ci id="S2.p5.8.m8.1.1.2.3.cmml" xref="S2.p5.8.m8.1.1.2.3">𝑖</ci></apply><apply id="S2.p5.8.m8.1.1.3.cmml" xref="S2.p5.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.p5.8.m8.1.1.3.1.cmml" xref="S2.p5.8.m8.1.1.3">superscript</csymbol><ci id="S2.p5.8.m8.1.1.3.2.cmml" xref="S2.p5.8.m8.1.1.3.2">ℝ</ci><apply id="S2.p5.8.m8.1.1.3.3.cmml" xref="S2.p5.8.m8.1.1.3.3"><times id="S2.p5.8.m8.1.1.3.3.1.cmml" xref="S2.p5.8.m8.1.1.3.3.1"></times><ci id="S2.p5.8.m8.1.1.3.3.2.cmml" xref="S2.p5.8.m8.1.1.3.3.2">𝑑</ci><ci id="S2.p5.8.m8.1.1.3.3.3.cmml" xref="S2.p5.8.m8.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.8.m8.1c">v_{i}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.8.m8.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, we define <math alttext="\langle v_{1:t},u_{1:t}\rangle=\sum_{i=1}^{t}v_{i}u_{i}" class="ltx_Math" display="inline" id="S2.p5.9.m9.2"><semantics id="S2.p5.9.m9.2a"><mrow id="S2.p5.9.m9.2.2" xref="S2.p5.9.m9.2.2.cmml"><mrow id="S2.p5.9.m9.2.2.2.2" xref="S2.p5.9.m9.2.2.2.3.cmml"><mo id="S2.p5.9.m9.2.2.2.2.3" stretchy="false" xref="S2.p5.9.m9.2.2.2.3.cmml">⟨</mo><msub id="S2.p5.9.m9.1.1.1.1.1" xref="S2.p5.9.m9.1.1.1.1.1.cmml"><mi id="S2.p5.9.m9.1.1.1.1.1.2" xref="S2.p5.9.m9.1.1.1.1.1.2.cmml">v</mi><mrow id="S2.p5.9.m9.1.1.1.1.1.3" xref="S2.p5.9.m9.1.1.1.1.1.3.cmml"><mn id="S2.p5.9.m9.1.1.1.1.1.3.2" xref="S2.p5.9.m9.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.p5.9.m9.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.9.m9.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.p5.9.m9.1.1.1.1.1.3.3" xref="S2.p5.9.m9.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.p5.9.m9.2.2.2.2.4" xref="S2.p5.9.m9.2.2.2.3.cmml">,</mo><msub id="S2.p5.9.m9.2.2.2.2.2" xref="S2.p5.9.m9.2.2.2.2.2.cmml"><mi id="S2.p5.9.m9.2.2.2.2.2.2" xref="S2.p5.9.m9.2.2.2.2.2.2.cmml">u</mi><mrow id="S2.p5.9.m9.2.2.2.2.2.3" xref="S2.p5.9.m9.2.2.2.2.2.3.cmml"><mn id="S2.p5.9.m9.2.2.2.2.2.3.2" xref="S2.p5.9.m9.2.2.2.2.2.3.2.cmml">1</mn><mo id="S2.p5.9.m9.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p5.9.m9.2.2.2.2.2.3.1.cmml">:</mo><mi id="S2.p5.9.m9.2.2.2.2.2.3.3" xref="S2.p5.9.m9.2.2.2.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S2.p5.9.m9.2.2.2.2.5" stretchy="false" xref="S2.p5.9.m9.2.2.2.3.cmml">⟩</mo></mrow><mo id="S2.p5.9.m9.2.2.3" rspace="0.111em" xref="S2.p5.9.m9.2.2.3.cmml">=</mo><mrow id="S2.p5.9.m9.2.2.4" xref="S2.p5.9.m9.2.2.4.cmml"><msubsup id="S2.p5.9.m9.2.2.4.1" xref="S2.p5.9.m9.2.2.4.1.cmml"><mo id="S2.p5.9.m9.2.2.4.1.2.2" xref="S2.p5.9.m9.2.2.4.1.2.2.cmml">∑</mo><mrow id="S2.p5.9.m9.2.2.4.1.2.3" xref="S2.p5.9.m9.2.2.4.1.2.3.cmml"><mi id="S2.p5.9.m9.2.2.4.1.2.3.2" xref="S2.p5.9.m9.2.2.4.1.2.3.2.cmml">i</mi><mo id="S2.p5.9.m9.2.2.4.1.2.3.1" xref="S2.p5.9.m9.2.2.4.1.2.3.1.cmml">=</mo><mn id="S2.p5.9.m9.2.2.4.1.2.3.3" xref="S2.p5.9.m9.2.2.4.1.2.3.3.cmml">1</mn></mrow><mi id="S2.p5.9.m9.2.2.4.1.3" xref="S2.p5.9.m9.2.2.4.1.3.cmml">t</mi></msubsup><mrow id="S2.p5.9.m9.2.2.4.2" xref="S2.p5.9.m9.2.2.4.2.cmml"><msub id="S2.p5.9.m9.2.2.4.2.2" xref="S2.p5.9.m9.2.2.4.2.2.cmml"><mi id="S2.p5.9.m9.2.2.4.2.2.2" xref="S2.p5.9.m9.2.2.4.2.2.2.cmml">v</mi><mi id="S2.p5.9.m9.2.2.4.2.2.3" xref="S2.p5.9.m9.2.2.4.2.2.3.cmml">i</mi></msub><mo id="S2.p5.9.m9.2.2.4.2.1" xref="S2.p5.9.m9.2.2.4.2.1.cmml">⁢</mo><msub id="S2.p5.9.m9.2.2.4.2.3" xref="S2.p5.9.m9.2.2.4.2.3.cmml"><mi id="S2.p5.9.m9.2.2.4.2.3.2" xref="S2.p5.9.m9.2.2.4.2.3.2.cmml">u</mi><mi id="S2.p5.9.m9.2.2.4.2.3.3" xref="S2.p5.9.m9.2.2.4.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.9.m9.2b"><apply id="S2.p5.9.m9.2.2.cmml" xref="S2.p5.9.m9.2.2"><eq id="S2.p5.9.m9.2.2.3.cmml" xref="S2.p5.9.m9.2.2.3"></eq><list id="S2.p5.9.m9.2.2.2.3.cmml" xref="S2.p5.9.m9.2.2.2.2"><apply id="S2.p5.9.m9.1.1.1.1.1.cmml" xref="S2.p5.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p5.9.m9.1.1.1.1.1.1.cmml" xref="S2.p5.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S2.p5.9.m9.1.1.1.1.1.2.cmml" xref="S2.p5.9.m9.1.1.1.1.1.2">𝑣</ci><apply id="S2.p5.9.m9.1.1.1.1.1.3.cmml" xref="S2.p5.9.m9.1.1.1.1.1.3"><ci id="S2.p5.9.m9.1.1.1.1.1.3.1.cmml" xref="S2.p5.9.m9.1.1.1.1.1.3.1">:</ci><cn id="S2.p5.9.m9.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.p5.9.m9.1.1.1.1.1.3.2">1</cn><ci id="S2.p5.9.m9.1.1.1.1.1.3.3.cmml" xref="S2.p5.9.m9.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S2.p5.9.m9.2.2.2.2.2.cmml" xref="S2.p5.9.m9.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p5.9.m9.2.2.2.2.2.1.cmml" xref="S2.p5.9.m9.2.2.2.2.2">subscript</csymbol><ci id="S2.p5.9.m9.2.2.2.2.2.2.cmml" xref="S2.p5.9.m9.2.2.2.2.2.2">𝑢</ci><apply id="S2.p5.9.m9.2.2.2.2.2.3.cmml" xref="S2.p5.9.m9.2.2.2.2.2.3"><ci id="S2.p5.9.m9.2.2.2.2.2.3.1.cmml" xref="S2.p5.9.m9.2.2.2.2.2.3.1">:</ci><cn id="S2.p5.9.m9.2.2.2.2.2.3.2.cmml" type="integer" xref="S2.p5.9.m9.2.2.2.2.2.3.2">1</cn><ci id="S2.p5.9.m9.2.2.2.2.2.3.3.cmml" xref="S2.p5.9.m9.2.2.2.2.2.3.3">𝑡</ci></apply></apply></list><apply id="S2.p5.9.m9.2.2.4.cmml" xref="S2.p5.9.m9.2.2.4"><apply id="S2.p5.9.m9.2.2.4.1.cmml" xref="S2.p5.9.m9.2.2.4.1"><csymbol cd="ambiguous" id="S2.p5.9.m9.2.2.4.1.1.cmml" xref="S2.p5.9.m9.2.2.4.1">superscript</csymbol><apply id="S2.p5.9.m9.2.2.4.1.2.cmml" xref="S2.p5.9.m9.2.2.4.1"><csymbol cd="ambiguous" id="S2.p5.9.m9.2.2.4.1.2.1.cmml" xref="S2.p5.9.m9.2.2.4.1">subscript</csymbol><sum id="S2.p5.9.m9.2.2.4.1.2.2.cmml" xref="S2.p5.9.m9.2.2.4.1.2.2"></sum><apply id="S2.p5.9.m9.2.2.4.1.2.3.cmml" xref="S2.p5.9.m9.2.2.4.1.2.3"><eq id="S2.p5.9.m9.2.2.4.1.2.3.1.cmml" xref="S2.p5.9.m9.2.2.4.1.2.3.1"></eq><ci id="S2.p5.9.m9.2.2.4.1.2.3.2.cmml" xref="S2.p5.9.m9.2.2.4.1.2.3.2">𝑖</ci><cn id="S2.p5.9.m9.2.2.4.1.2.3.3.cmml" type="integer" xref="S2.p5.9.m9.2.2.4.1.2.3.3">1</cn></apply></apply><ci id="S2.p5.9.m9.2.2.4.1.3.cmml" xref="S2.p5.9.m9.2.2.4.1.3">𝑡</ci></apply><apply id="S2.p5.9.m9.2.2.4.2.cmml" xref="S2.p5.9.m9.2.2.4.2"><times id="S2.p5.9.m9.2.2.4.2.1.cmml" xref="S2.p5.9.m9.2.2.4.2.1"></times><apply id="S2.p5.9.m9.2.2.4.2.2.cmml" xref="S2.p5.9.m9.2.2.4.2.2"><csymbol cd="ambiguous" id="S2.p5.9.m9.2.2.4.2.2.1.cmml" xref="S2.p5.9.m9.2.2.4.2.2">subscript</csymbol><ci id="S2.p5.9.m9.2.2.4.2.2.2.cmml" xref="S2.p5.9.m9.2.2.4.2.2.2">𝑣</ci><ci id="S2.p5.9.m9.2.2.4.2.2.3.cmml" xref="S2.p5.9.m9.2.2.4.2.2.3">𝑖</ci></apply><apply id="S2.p5.9.m9.2.2.4.2.3.cmml" xref="S2.p5.9.m9.2.2.4.2.3"><csymbol cd="ambiguous" id="S2.p5.9.m9.2.2.4.2.3.1.cmml" xref="S2.p5.9.m9.2.2.4.2.3">subscript</csymbol><ci id="S2.p5.9.m9.2.2.4.2.3.2.cmml" xref="S2.p5.9.m9.2.2.4.2.3.2">𝑢</ci><ci id="S2.p5.9.m9.2.2.4.2.3.3.cmml" xref="S2.p5.9.m9.2.2.4.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.9.m9.2c">\langle v_{1:t},u_{1:t}\rangle=\sum_{i=1}^{t}v_{i}u_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.9.m9.2d">⟨ italic_v start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT ⟩ = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. With these definitions the notion of convolution between such sequences can be defined via the natural extension.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Abstracting Convolutional Sequence Prediction</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.3">We define a convolutional sequence prediction model to be given by a <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.3.1">filter</span>, which is a vector denoted by <math alttext="\phi\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">ϕ</mi><mo id="S2.SS1.p1.1.m1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS1.p1.1.m1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><in id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1"></in><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">italic-ϕ</ci><apply id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S2.SS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\phi\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_ϕ ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> where <math alttext="L" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_L</annotation></semantics></math> is considered the <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.3.2">context length</span> of the model. It takes as an input a sequence <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_u</annotation></semantics></math>, and outputs a prediction sequence. The above definition can be extended to multiple filter <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.3.3">channels</span> and nonlinearities can be added, as we elaborate below with different examples. Formally, a single output in the predicted sequence using a convolutional sequence model is given by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}_{t}=\langle\phi,u_{t:t-L}\rangle." class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><msub id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml"><mover accent="true" id="S2.E2.m1.2.2.1.1.3.2" xref="S2.E2.m1.2.2.1.1.3.2.cmml"><mi id="S2.E2.m1.2.2.1.1.3.2.2" xref="S2.E2.m1.2.2.1.1.3.2.2.cmml">y</mi><mo id="S2.E2.m1.2.2.1.1.3.2.1" xref="S2.E2.m1.2.2.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.E2.m1.2.2.1.1.3.3" xref="S2.E2.m1.2.2.1.1.3.3.cmml">t</mi></msub><mo id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.2.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.2.cmml">⟨</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">ϕ</mi><mo id="S2.E2.m1.2.2.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.2.cmml">,</mo><msub id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.2.cmml">u</mi><mrow id="S2.E2.m1.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.3.2" xref="S2.E2.m1.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E2.m1.2.2.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.3.3" xref="S2.E2.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.3.3.2" xref="S2.E2.m1.2.2.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.3.3.1" xref="S2.E2.m1.2.2.1.1.1.1.1.3.3.1.cmml">−</mo><mi id="S2.E2.m1.2.2.1.1.1.1.1.3.3.3" xref="S2.E2.m1.2.2.1.1.1.1.1.3.3.3.cmml">L</mi></mrow></mrow></msub><mo id="S2.E2.m1.2.2.1.1.1.1.4" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.2.cmml">⟩</mo></mrow></mrow><mo id="S2.E2.m1.2.2.1.2" lspace="0em" xref="S2.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1"><eq id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2"></eq><apply id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.3">subscript</csymbol><apply id="S2.E2.m1.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2"><ci id="S2.E2.m1.2.2.1.1.3.2.1.cmml" xref="S2.E2.m1.2.2.1.1.3.2.1">^</ci><ci id="S2.E2.m1.2.2.1.1.3.2.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2.2">𝑦</ci></apply><ci id="S2.E2.m1.2.2.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.3.3">𝑡</ci></apply><list id="S2.E2.m1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1"><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">italic-ϕ</ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.2">𝑢</ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.3"><ci id="S2.E2.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.3.1">:</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.3.2">𝑡</ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.3.3"><minus id="S2.E2.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.3.3.1"></minus><ci id="S2.E2.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.3.3.2">𝑡</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.3.3.3">𝐿</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\hat{y}_{t}=\langle\phi,u_{t:t-L}\rangle.</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ⟨ italic_ϕ , italic_u start_POSTSUBSCRIPT italic_t : italic_t - italic_L end_POSTSUBSCRIPT ⟩ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.5">This paradigm captures several prominent convolutional sequence models considered in the literature. We highlight some of them below.
The cached convolution technique proposed by us can be used with all the models below in straightforward manner leading to generation time improvement from <math alttext="O(L)" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m1.1"><semantics id="S2.SS1.p1.4.m1.1a"><mrow id="S2.SS1.p1.4.m1.1.2" xref="S2.SS1.p1.4.m1.1.2.cmml"><mi id="S2.SS1.p1.4.m1.1.2.2" xref="S2.SS1.p1.4.m1.1.2.2.cmml">O</mi><mo id="S2.SS1.p1.4.m1.1.2.1" xref="S2.SS1.p1.4.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.4.m1.1.2.3.2" xref="S2.SS1.p1.4.m1.1.2.cmml"><mo id="S2.SS1.p1.4.m1.1.2.3.2.1" stretchy="false" xref="S2.SS1.p1.4.m1.1.2.cmml">(</mo><mi id="S2.SS1.p1.4.m1.1.1" xref="S2.SS1.p1.4.m1.1.1.cmml">L</mi><mo id="S2.SS1.p1.4.m1.1.2.3.2.2" stretchy="false" xref="S2.SS1.p1.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m1.1b"><apply id="S2.SS1.p1.4.m1.1.2.cmml" xref="S2.SS1.p1.4.m1.1.2"><times id="S2.SS1.p1.4.m1.1.2.1.cmml" xref="S2.SS1.p1.4.m1.1.2.1"></times><ci id="S2.SS1.p1.4.m1.1.2.2.cmml" xref="S2.SS1.p1.4.m1.1.2.2">𝑂</ci><ci id="S2.SS1.p1.4.m1.1.1.cmml" xref="S2.SS1.p1.4.m1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m1.1c">O(L)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m1.1d">italic_O ( italic_L )</annotation></semantics></math> to <math alttext="O(\sqrt{L})" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m2.1"><semantics id="S2.SS1.p1.5.m2.1a"><mrow id="S2.SS1.p1.5.m2.1.2" xref="S2.SS1.p1.5.m2.1.2.cmml"><mi id="S2.SS1.p1.5.m2.1.2.2" xref="S2.SS1.p1.5.m2.1.2.2.cmml">O</mi><mo id="S2.SS1.p1.5.m2.1.2.1" xref="S2.SS1.p1.5.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.5.m2.1.2.3.2" xref="S2.SS1.p1.5.m2.1.1.cmml"><mo id="S2.SS1.p1.5.m2.1.2.3.2.1" stretchy="false" xref="S2.SS1.p1.5.m2.1.1.cmml">(</mo><msqrt id="S2.SS1.p1.5.m2.1.1" xref="S2.SS1.p1.5.m2.1.1.cmml"><mi id="S2.SS1.p1.5.m2.1.1.2" xref="S2.SS1.p1.5.m2.1.1.2.cmml">L</mi></msqrt><mo id="S2.SS1.p1.5.m2.1.2.3.2.2" stretchy="false" xref="S2.SS1.p1.5.m2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m2.1b"><apply id="S2.SS1.p1.5.m2.1.2.cmml" xref="S2.SS1.p1.5.m2.1.2"><times id="S2.SS1.p1.5.m2.1.2.1.cmml" xref="S2.SS1.p1.5.m2.1.2.1"></times><ci id="S2.SS1.p1.5.m2.1.2.2.cmml" xref="S2.SS1.p1.5.m2.1.2.2">𝑂</ci><apply id="S2.SS1.p1.5.m2.1.1.cmml" xref="S2.SS1.p1.5.m2.1.2.3.2"><root id="S2.SS1.p1.5.m2.1.1a.cmml" xref="S2.SS1.p1.5.m2.1.2.3.2"></root><ci id="S2.SS1.p1.5.m2.1.1.2.cmml" xref="S2.SS1.p1.5.m2.1.1.2">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m2.1c">O(\sqrt{L})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m2.1d">italic_O ( square-root start_ARG italic_L end_ARG )</annotation></semantics></math>.</p>
</div>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">State Space Models</h4>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p1.7">Discrete state space models such as those considered in <cite class="ltx_cite ltx_citemacro_cite">Gu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib7" title="">2021a</a>)</cite> have shown considerable success/adoption for long range sequence modelling. A typical state space model can be defined via the following definition of a Linear Dynamical System (LDS)</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx1">
<tbody id="S2.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle x_{t}" class="ltx_Math" display="inline" id="S2.Ex2.m1.1"><semantics id="S2.Ex2.m1.1a"><msub id="S2.Ex2.m1.1.1" xref="S2.Ex2.m1.1.1.cmml"><mi id="S2.Ex2.m1.1.1.2" xref="S2.Ex2.m1.1.1.2.cmml">x</mi><mi id="S2.Ex2.m1.1.1.3" xref="S2.Ex2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.1b"><apply id="S2.Ex2.m1.1.1.cmml" xref="S2.Ex2.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.cmml" xref="S2.Ex2.m1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.2">𝑥</ci><ci id="S2.Ex2.m1.1.1.3.cmml" xref="S2.Ex2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.1c">\displaystyle x_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=Ax_{t-1}+Bu_{t}" class="ltx_Math" display="inline" id="S2.Ex2.m2.1"><semantics id="S2.Ex2.m2.1a"><mrow id="S2.Ex2.m2.1.1" xref="S2.Ex2.m2.1.1.cmml"><mi id="S2.Ex2.m2.1.1.2" xref="S2.Ex2.m2.1.1.2.cmml"></mi><mo id="S2.Ex2.m2.1.1.1" xref="S2.Ex2.m2.1.1.1.cmml">=</mo><mrow id="S2.Ex2.m2.1.1.3" xref="S2.Ex2.m2.1.1.3.cmml"><mrow id="S2.Ex2.m2.1.1.3.2" xref="S2.Ex2.m2.1.1.3.2.cmml"><mi id="S2.Ex2.m2.1.1.3.2.2" xref="S2.Ex2.m2.1.1.3.2.2.cmml">A</mi><mo id="S2.Ex2.m2.1.1.3.2.1" xref="S2.Ex2.m2.1.1.3.2.1.cmml">⁢</mo><msub id="S2.Ex2.m2.1.1.3.2.3" xref="S2.Ex2.m2.1.1.3.2.3.cmml"><mi id="S2.Ex2.m2.1.1.3.2.3.2" xref="S2.Ex2.m2.1.1.3.2.3.2.cmml">x</mi><mrow id="S2.Ex2.m2.1.1.3.2.3.3" xref="S2.Ex2.m2.1.1.3.2.3.3.cmml"><mi id="S2.Ex2.m2.1.1.3.2.3.3.2" xref="S2.Ex2.m2.1.1.3.2.3.3.2.cmml">t</mi><mo id="S2.Ex2.m2.1.1.3.2.3.3.1" xref="S2.Ex2.m2.1.1.3.2.3.3.1.cmml">−</mo><mn id="S2.Ex2.m2.1.1.3.2.3.3.3" xref="S2.Ex2.m2.1.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.Ex2.m2.1.1.3.1" xref="S2.Ex2.m2.1.1.3.1.cmml">+</mo><mrow id="S2.Ex2.m2.1.1.3.3" xref="S2.Ex2.m2.1.1.3.3.cmml"><mi id="S2.Ex2.m2.1.1.3.3.2" xref="S2.Ex2.m2.1.1.3.3.2.cmml">B</mi><mo id="S2.Ex2.m2.1.1.3.3.1" xref="S2.Ex2.m2.1.1.3.3.1.cmml">⁢</mo><msub id="S2.Ex2.m2.1.1.3.3.3" xref="S2.Ex2.m2.1.1.3.3.3.cmml"><mi id="S2.Ex2.m2.1.1.3.3.3.2" xref="S2.Ex2.m2.1.1.3.3.3.2.cmml">u</mi><mi id="S2.Ex2.m2.1.1.3.3.3.3" xref="S2.Ex2.m2.1.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m2.1b"><apply id="S2.Ex2.m2.1.1.cmml" xref="S2.Ex2.m2.1.1"><eq id="S2.Ex2.m2.1.1.1.cmml" xref="S2.Ex2.m2.1.1.1"></eq><csymbol cd="latexml" id="S2.Ex2.m2.1.1.2.cmml" xref="S2.Ex2.m2.1.1.2">absent</csymbol><apply id="S2.Ex2.m2.1.1.3.cmml" xref="S2.Ex2.m2.1.1.3"><plus id="S2.Ex2.m2.1.1.3.1.cmml" xref="S2.Ex2.m2.1.1.3.1"></plus><apply id="S2.Ex2.m2.1.1.3.2.cmml" xref="S2.Ex2.m2.1.1.3.2"><times id="S2.Ex2.m2.1.1.3.2.1.cmml" xref="S2.Ex2.m2.1.1.3.2.1"></times><ci id="S2.Ex2.m2.1.1.3.2.2.cmml" xref="S2.Ex2.m2.1.1.3.2.2">𝐴</ci><apply id="S2.Ex2.m2.1.1.3.2.3.cmml" xref="S2.Ex2.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.Ex2.m2.1.1.3.2.3.1.cmml" xref="S2.Ex2.m2.1.1.3.2.3">subscript</csymbol><ci id="S2.Ex2.m2.1.1.3.2.3.2.cmml" xref="S2.Ex2.m2.1.1.3.2.3.2">𝑥</ci><apply id="S2.Ex2.m2.1.1.3.2.3.3.cmml" xref="S2.Ex2.m2.1.1.3.2.3.3"><minus id="S2.Ex2.m2.1.1.3.2.3.3.1.cmml" xref="S2.Ex2.m2.1.1.3.2.3.3.1"></minus><ci id="S2.Ex2.m2.1.1.3.2.3.3.2.cmml" xref="S2.Ex2.m2.1.1.3.2.3.3.2">𝑡</ci><cn id="S2.Ex2.m2.1.1.3.2.3.3.3.cmml" type="integer" xref="S2.Ex2.m2.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S2.Ex2.m2.1.1.3.3.cmml" xref="S2.Ex2.m2.1.1.3.3"><times id="S2.Ex2.m2.1.1.3.3.1.cmml" xref="S2.Ex2.m2.1.1.3.3.1"></times><ci id="S2.Ex2.m2.1.1.3.3.2.cmml" xref="S2.Ex2.m2.1.1.3.3.2">𝐵</ci><apply id="S2.Ex2.m2.1.1.3.3.3.cmml" xref="S2.Ex2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.Ex2.m2.1.1.3.3.3.1.cmml" xref="S2.Ex2.m2.1.1.3.3.3">subscript</csymbol><ci id="S2.Ex2.m2.1.1.3.3.3.2.cmml" xref="S2.Ex2.m2.1.1.3.3.3.2">𝑢</ci><ci id="S2.Ex2.m2.1.1.3.3.3.3.cmml" xref="S2.Ex2.m2.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m2.1c">\displaystyle=Ax_{t-1}+Bu_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m2.1d">= italic_A italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + italic_B italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle y_{t}" class="ltx_Math" display="inline" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><msub id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mi id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml">y</mi><mi id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2">𝑦</ci><ci id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=Cx_{t}+Du_{t}" class="ltx_Math" display="inline" id="S2.E3.m2.1"><semantics id="S2.E3.m2.1a"><mrow id="S2.E3.m2.1.1" xref="S2.E3.m2.1.1.cmml"><mi id="S2.E3.m2.1.1.2" xref="S2.E3.m2.1.1.2.cmml"></mi><mo id="S2.E3.m2.1.1.1" xref="S2.E3.m2.1.1.1.cmml">=</mo><mrow id="S2.E3.m2.1.1.3" xref="S2.E3.m2.1.1.3.cmml"><mrow id="S2.E3.m2.1.1.3.2" xref="S2.E3.m2.1.1.3.2.cmml"><mi id="S2.E3.m2.1.1.3.2.2" xref="S2.E3.m2.1.1.3.2.2.cmml">C</mi><mo id="S2.E3.m2.1.1.3.2.1" xref="S2.E3.m2.1.1.3.2.1.cmml">⁢</mo><msub id="S2.E3.m2.1.1.3.2.3" xref="S2.E3.m2.1.1.3.2.3.cmml"><mi id="S2.E3.m2.1.1.3.2.3.2" xref="S2.E3.m2.1.1.3.2.3.2.cmml">x</mi><mi id="S2.E3.m2.1.1.3.2.3.3" xref="S2.E3.m2.1.1.3.2.3.3.cmml">t</mi></msub></mrow><mo id="S2.E3.m2.1.1.3.1" xref="S2.E3.m2.1.1.3.1.cmml">+</mo><mrow id="S2.E3.m2.1.1.3.3" xref="S2.E3.m2.1.1.3.3.cmml"><mi id="S2.E3.m2.1.1.3.3.2" xref="S2.E3.m2.1.1.3.3.2.cmml">D</mi><mo id="S2.E3.m2.1.1.3.3.1" xref="S2.E3.m2.1.1.3.3.1.cmml">⁢</mo><msub id="S2.E3.m2.1.1.3.3.3" xref="S2.E3.m2.1.1.3.3.3.cmml"><mi id="S2.E3.m2.1.1.3.3.3.2" xref="S2.E3.m2.1.1.3.3.3.2.cmml">u</mi><mi id="S2.E3.m2.1.1.3.3.3.3" xref="S2.E3.m2.1.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.1b"><apply id="S2.E3.m2.1.1.cmml" xref="S2.E3.m2.1.1"><eq id="S2.E3.m2.1.1.1.cmml" xref="S2.E3.m2.1.1.1"></eq><csymbol cd="latexml" id="S2.E3.m2.1.1.2.cmml" xref="S2.E3.m2.1.1.2">absent</csymbol><apply id="S2.E3.m2.1.1.3.cmml" xref="S2.E3.m2.1.1.3"><plus id="S2.E3.m2.1.1.3.1.cmml" xref="S2.E3.m2.1.1.3.1"></plus><apply id="S2.E3.m2.1.1.3.2.cmml" xref="S2.E3.m2.1.1.3.2"><times id="S2.E3.m2.1.1.3.2.1.cmml" xref="S2.E3.m2.1.1.3.2.1"></times><ci id="S2.E3.m2.1.1.3.2.2.cmml" xref="S2.E3.m2.1.1.3.2.2">𝐶</ci><apply id="S2.E3.m2.1.1.3.2.3.cmml" xref="S2.E3.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.3.2.3.1.cmml" xref="S2.E3.m2.1.1.3.2.3">subscript</csymbol><ci id="S2.E3.m2.1.1.3.2.3.2.cmml" xref="S2.E3.m2.1.1.3.2.3.2">𝑥</ci><ci id="S2.E3.m2.1.1.3.2.3.3.cmml" xref="S2.E3.m2.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="S2.E3.m2.1.1.3.3.cmml" xref="S2.E3.m2.1.1.3.3"><times id="S2.E3.m2.1.1.3.3.1.cmml" xref="S2.E3.m2.1.1.3.3.1"></times><ci id="S2.E3.m2.1.1.3.3.2.cmml" xref="S2.E3.m2.1.1.3.3.2">𝐷</ci><apply id="S2.E3.m2.1.1.3.3.3.cmml" xref="S2.E3.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.3.3.3.1.cmml" xref="S2.E3.m2.1.1.3.3.3">subscript</csymbol><ci id="S2.E3.m2.1.1.3.3.3.2.cmml" xref="S2.E3.m2.1.1.3.3.3.2">𝑢</ci><ci id="S2.E3.m2.1.1.3.3.3.3.cmml" xref="S2.E3.m2.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.1c">\displaystyle=Cx_{t}+Du_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m2.1d">= italic_C italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_D italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p1.3">where <math alttext="u,y" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.1.m1.2"><semantics id="S2.SS1.SSS0.Px1.p1.1.m1.2a"><mrow id="S2.SS1.SSS0.Px1.p1.1.m1.2.3.2" xref="S2.SS1.SSS0.Px1.p1.1.m1.2.3.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">u</mi><mo id="S2.SS1.SSS0.Px1.p1.1.m1.2.3.2.1" xref="S2.SS1.SSS0.Px1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S2.SS1.SSS0.Px1.p1.1.m1.2.2" xref="S2.SS1.SSS0.Px1.p1.1.m1.2.2.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.1.m1.2b"><list id="S2.SS1.SSS0.Px1.p1.1.m1.2.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.2.3.2"><ci id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1">𝑢</ci><ci id="S2.SS1.SSS0.Px1.p1.1.m1.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.2.2">𝑦</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.1.m1.2c">u,y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.1.m1.2d">italic_u , italic_y</annotation></semantics></math> are the input and output sequences and <math alttext="A,B,C,D" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.2.m2.4"><semantics id="S2.SS1.SSS0.Px1.p1.2.m2.4a"><mrow id="S2.SS1.SSS0.Px1.p1.2.m2.4.5.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.5.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">A</mi><mo id="S2.SS1.SSS0.Px1.p1.2.m2.4.5.2.1" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.5.1.cmml">,</mo><mi id="S2.SS1.SSS0.Px1.p1.2.m2.2.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2.cmml">B</mi><mo id="S2.SS1.SSS0.Px1.p1.2.m2.4.5.2.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.5.1.cmml">,</mo><mi id="S2.SS1.SSS0.Px1.p1.2.m2.3.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3.cmml">C</mi><mo id="S2.SS1.SSS0.Px1.p1.2.m2.4.5.2.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.5.1.cmml">,</mo><mi id="S2.SS1.SSS0.Px1.p1.2.m2.4.4" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.2.m2.4b"><list id="S2.SS1.SSS0.Px1.p1.2.m2.4.5.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.5.2"><ci id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1">𝐴</ci><ci id="S2.SS1.SSS0.Px1.p1.2.m2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.2.2">𝐵</ci><ci id="S2.SS1.SSS0.Px1.p1.2.m2.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.3.3">𝐶</ci><ci id="S2.SS1.SSS0.Px1.p1.2.m2.4.4.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.4.4">𝐷</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.2.m2.4c">A,B,C,D</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.2.m2.4d">italic_A , italic_B , italic_C , italic_D</annotation></semantics></math> are the learned parameters. Various papers deal with specifications of this model including prescriptions for initialization <cite class="ltx_cite ltx_citemacro_cite">Gu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib6" title="">2020</a>)</cite>, diagonal versions <cite class="ltx_cite ltx_citemacro_cite">Gupta et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib9" title="">2022</a>)</cite>, gating <cite class="ltx_cite ltx_citemacro_cite">Mehta et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib16" title="">2023</a>)</cite> and other effective simplifications <cite class="ltx_cite ltx_citemacro_cite">Smith et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib21" title="">2023</a>)</cite>. All these models can be captured via a convolutional model by noticing that the output sequence <math alttext="y" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS1.SSS0.Px1.p1.3.m3.1a"><mi id="S2.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.3.m3.1b"><ci id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.3.m3.1d">italic_y</annotation></semantics></math> in (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.E3" title="Equation 3 ‣ State Space Models ‣ 2.1 Abstracting Convolutional Sequence Prediction ‣ 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">3</span></a>) can be written as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="y=\phi*u+Du" class="ltx_Math" display="block" id="S2.Ex3.m1.1"><semantics id="S2.Ex3.m1.1a"><mrow id="S2.Ex3.m1.1.1" xref="S2.Ex3.m1.1.1.cmml"><mi id="S2.Ex3.m1.1.1.2" xref="S2.Ex3.m1.1.1.2.cmml">y</mi><mo id="S2.Ex3.m1.1.1.1" xref="S2.Ex3.m1.1.1.1.cmml">=</mo><mrow id="S2.Ex3.m1.1.1.3" xref="S2.Ex3.m1.1.1.3.cmml"><mrow id="S2.Ex3.m1.1.1.3.2" xref="S2.Ex3.m1.1.1.3.2.cmml"><mi id="S2.Ex3.m1.1.1.3.2.2" xref="S2.Ex3.m1.1.1.3.2.2.cmml">ϕ</mi><mo id="S2.Ex3.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.Ex3.m1.1.1.3.2.1.cmml">∗</mo><mi id="S2.Ex3.m1.1.1.3.2.3" xref="S2.Ex3.m1.1.1.3.2.3.cmml">u</mi></mrow><mo id="S2.Ex3.m1.1.1.3.1" xref="S2.Ex3.m1.1.1.3.1.cmml">+</mo><mrow id="S2.Ex3.m1.1.1.3.3" xref="S2.Ex3.m1.1.1.3.3.cmml"><mi id="S2.Ex3.m1.1.1.3.3.2" xref="S2.Ex3.m1.1.1.3.3.2.cmml">D</mi><mo id="S2.Ex3.m1.1.1.3.3.1" xref="S2.Ex3.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.Ex3.m1.1.1.3.3.3" xref="S2.Ex3.m1.1.1.3.3.3.cmml">u</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.1b"><apply id="S2.Ex3.m1.1.1.cmml" xref="S2.Ex3.m1.1.1"><eq id="S2.Ex3.m1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1"></eq><ci id="S2.Ex3.m1.1.1.2.cmml" xref="S2.Ex3.m1.1.1.2">𝑦</ci><apply id="S2.Ex3.m1.1.1.3.cmml" xref="S2.Ex3.m1.1.1.3"><plus id="S2.Ex3.m1.1.1.3.1.cmml" xref="S2.Ex3.m1.1.1.3.1"></plus><apply id="S2.Ex3.m1.1.1.3.2.cmml" xref="S2.Ex3.m1.1.1.3.2"><times id="S2.Ex3.m1.1.1.3.2.1.cmml" xref="S2.Ex3.m1.1.1.3.2.1"></times><ci id="S2.Ex3.m1.1.1.3.2.2.cmml" xref="S2.Ex3.m1.1.1.3.2.2">italic-ϕ</ci><ci id="S2.Ex3.m1.1.1.3.2.3.cmml" xref="S2.Ex3.m1.1.1.3.2.3">𝑢</ci></apply><apply id="S2.Ex3.m1.1.1.3.3.cmml" xref="S2.Ex3.m1.1.1.3.3"><times id="S2.Ex3.m1.1.1.3.3.1.cmml" xref="S2.Ex3.m1.1.1.3.3.1"></times><ci id="S2.Ex3.m1.1.1.3.3.2.cmml" xref="S2.Ex3.m1.1.1.3.3.2">𝐷</ci><ci id="S2.Ex3.m1.1.1.3.3.3.cmml" xref="S2.Ex3.m1.1.1.3.3.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.1c">y=\phi*u+Du</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m1.1d">italic_y = italic_ϕ ∗ italic_u + italic_D italic_u</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p1.6">where the filter <math alttext="\phi" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.4.m1.1"><semantics id="S2.SS1.SSS0.Px1.p1.4.m1.1a"><mi id="S2.SS1.SSS0.Px1.p1.4.m1.1.1" xref="S2.SS1.SSS0.Px1.p1.4.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.4.m1.1b"><ci id="S2.SS1.SSS0.Px1.p1.4.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.4.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.4.m1.1d">italic_ϕ</annotation></semantics></math> takes the form <math alttext="\phi_{i}=CA^{i-1}B" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.5.m2.1"><semantics id="S2.SS1.SSS0.Px1.p1.5.m2.1a"><mrow id="S2.SS1.SSS0.Px1.p1.5.m2.1.1" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.cmml"><msub id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.cmml"><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.2.cmml">ϕ</mi><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.1" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.1.cmml">=</mo><mrow id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.2.cmml">C</mi><mo id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.1" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.cmml">A</mi><mrow id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.2" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.2.cmml">i</mi><mo id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.1" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.1.cmml">−</mo><mn id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.3" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.3.cmml">1</mn></mrow></msup><mo id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.1a" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.4" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.4.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.5.m2.1b"><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1"><eq id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.1"></eq><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.2">italic-ϕ</ci><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.3.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.2.3">𝑖</ci></apply><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3"><times id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.1"></times><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.2">𝐶</ci><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.2">𝐴</ci><apply id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3"><minus id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.1"></minus><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.2">𝑖</ci><cn id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.3.cmml" type="integer" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.3.3.3">1</cn></apply></apply><ci id="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.4.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m2.1.1.3.4">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.5.m2.1c">\phi_{i}=CA^{i-1}B</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.5.m2.1d">italic_ϕ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_C italic_A start_POSTSUPERSCRIPT italic_i - 1 end_POSTSUPERSCRIPT italic_B</annotation></semantics></math>. Thus a convolutional sequential model with learnable filters <math alttext="\phi" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.6.m3.1"><semantics id="S2.SS1.SSS0.Px1.p1.6.m3.1a"><mi id="S2.SS1.SSS0.Px1.p1.6.m3.1.1" xref="S2.SS1.SSS0.Px1.p1.6.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.6.m3.1b"><ci id="S2.SS1.SSS0.Px1.p1.6.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.6.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.6.m3.1d">italic_ϕ</annotation></semantics></math> generalizes these state space models. However, SSM are more efficient for generation and require only constant time for generating a token, where the constant depends on the size of the SSM representation.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">LongConv/SGConv. </h4>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px2.p1.1">The LongConv <cite class="ltx_cite ltx_citemacro_cite">Fu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib4" title="">2023</a>)</cite> and SGConv <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib14" title="">2022</a>)</cite> architectures, exploit the above connection and propose direct regularizations of the kernel to bias them towards kernels representing a state space model.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Spectral Transform Units. </h4>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px3.p1.3">The STU architecture was proposed in <cite class="ltx_cite ltx_citemacro_cite">Agarwal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib1" title="">2023</a>)</cite> based on the technique of spectral filtering for linear dynamical systems <cite class="ltx_cite ltx_citemacro_cite">Hazan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib11" title="">2017</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib12" title="">2018</a>)</cite>. These are basically convolutional sequence models based on carefully constructed filters that are <span class="ltx_text ltx_font_bold" id="S2.SS1.SSS0.Px3.p1.3.1">not data dependent</span>. Rather, let <math alttext="\phi_{1},...,\phi_{k}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px3.p1.1.m1.3"><semantics id="S2.SS1.SSS0.Px3.p1.1.m1.3a"><mrow id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.3.cmml"><msub id="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1" xref="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.cmml"><mi id="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.2" xref="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.2.cmml">ϕ</mi><mn id="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.3" xref="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.3" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.3.cmml">,</mo><mi id="S2.SS1.SSS0.Px3.p1.1.m1.1.1" mathvariant="normal" xref="S2.SS1.SSS0.Px3.p1.1.m1.1.1.cmml">…</mi><mo id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.4" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.3.cmml">,</mo><msub id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.cmml"><mi id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.2" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.2.cmml">ϕ</mi><mi id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.3" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px3.p1.1.m1.3b"><list id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.3.cmml" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2"><apply id="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.cmml" xref="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.2.cmml" xref="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.2">italic-ϕ</ci><cn id="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.3.cmml" type="integer" xref="S2.SS1.SSS0.Px3.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="S2.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px3.p1.1.m1.1.1">…</ci><apply id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.cmml" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.1.cmml" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.2">italic-ϕ</ci><ci id="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.3.cmml" xref="S2.SS1.SSS0.Px3.p1.1.m1.3.3.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px3.p1.1.m1.3c">\phi_{1},...,\phi_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px3.p1.1.m1.3d">italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_ϕ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> be the first <math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px3.p1.2.m2.1"><semantics id="S2.SS1.SSS0.Px3.p1.2.m2.1a"><mi id="S2.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S2.SS1.SSS0.Px3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px3.p1.2.m2.1b"><ci id="S2.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px3.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px3.p1.2.m2.1d">italic_k</annotation></semantics></math> eigenvectors of the Hankel matrix <math alttext="H_{L}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px3.p1.3.m3.1"><semantics id="S2.SS1.SSS0.Px3.p1.3.m3.1a"><msub id="S2.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S2.SS1.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S2.SS1.SSS0.Px3.p1.3.m3.1.1.2" xref="S2.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml">H</mi><mi id="S2.SS1.SSS0.Px3.p1.3.m3.1.1.3" xref="S2.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px3.p1.3.m3.1b"><apply id="S2.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S2.SS1.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S2.SS1.SSS0.Px3.p1.3.m3.1.1.2">𝐻</ci><ci id="S2.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S2.SS1.SSS0.Px3.p1.3.m3.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px3.p1.3.m3.1c">H_{L}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px3.p1.3.m3.1d">italic_H start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT</annotation></semantics></math> given by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="H_{L}=\int_{0}^{1}\mu_{\alpha}\mu_{\alpha}^{\top}d\alpha\ \in\mathbb{R}^{L%
\times L},\ \mu_{\alpha}=(\alpha-1)[1,\alpha,\alpha^{2},..,\alpha^{L-1}]." class="ltx_math_unparsed" display="block" id="S2.Ex4.m1.2"><semantics id="S2.Ex4.m1.2a"><mrow id="S2.Ex4.m1.2b"><msub id="S2.Ex4.m1.2.3"><mi id="S2.Ex4.m1.2.3.2">H</mi><mi id="S2.Ex4.m1.2.3.3">L</mi></msub><mo id="S2.Ex4.m1.2.4" rspace="0.111em">=</mo><msubsup id="S2.Ex4.m1.2.5"><mo id="S2.Ex4.m1.2.5.2.2">∫</mo><mn id="S2.Ex4.m1.2.5.2.3">0</mn><mn id="S2.Ex4.m1.2.5.3">1</mn></msubsup><msub id="S2.Ex4.m1.2.6"><mi id="S2.Ex4.m1.2.6.2">μ</mi><mi id="S2.Ex4.m1.2.6.3">α</mi></msub><msubsup id="S2.Ex4.m1.2.7"><mi id="S2.Ex4.m1.2.7.2.2">μ</mi><mi id="S2.Ex4.m1.2.7.2.3">α</mi><mo id="S2.Ex4.m1.2.7.3">⊤</mo></msubsup><mi id="S2.Ex4.m1.2.8">d</mi><mi id="S2.Ex4.m1.2.9">α</mi><mo id="S2.Ex4.m1.2.10" lspace="0.778em">∈</mo><msup id="S2.Ex4.m1.2.11"><mi id="S2.Ex4.m1.2.11.2">ℝ</mi><mrow id="S2.Ex4.m1.2.11.3"><mi id="S2.Ex4.m1.2.11.3.2">L</mi><mo id="S2.Ex4.m1.2.11.3.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S2.Ex4.m1.2.11.3.3">L</mi></mrow></msup><mo id="S2.Ex4.m1.2.12" rspace="0.667em">,</mo><msub id="S2.Ex4.m1.2.13"><mi id="S2.Ex4.m1.2.13.2">μ</mi><mi id="S2.Ex4.m1.2.13.3">α</mi></msub><mo id="S2.Ex4.m1.2.14">=</mo><mrow id="S2.Ex4.m1.2.15"><mo id="S2.Ex4.m1.2.15.1" stretchy="false">(</mo><mi id="S2.Ex4.m1.2.15.2">α</mi><mo id="S2.Ex4.m1.2.15.3">−</mo><mn id="S2.Ex4.m1.2.15.4">1</mn><mo id="S2.Ex4.m1.2.15.5" stretchy="false">)</mo></mrow><mrow id="S2.Ex4.m1.2.16"><mo id="S2.Ex4.m1.2.16.1" stretchy="false">[</mo><mn id="S2.Ex4.m1.1.1">1</mn><mo id="S2.Ex4.m1.2.16.2">,</mo><mi id="S2.Ex4.m1.2.2">α</mi><mo id="S2.Ex4.m1.2.16.3">,</mo><msup id="S2.Ex4.m1.2.16.4"><mi id="S2.Ex4.m1.2.16.4.2">α</mi><mn id="S2.Ex4.m1.2.16.4.3">2</mn></msup><mo id="S2.Ex4.m1.2.16.5">,</mo><mo id="S2.Ex4.m1.2.16.6" lspace="0em" rspace="0.0835em">.</mo><mo id="S2.Ex4.m1.2.16.7" lspace="0.0835em" rspace="0.167em">.</mo><mo id="S2.Ex4.m1.2.16.8">,</mo><msup id="S2.Ex4.m1.2.16.9"><mi id="S2.Ex4.m1.2.16.9.2">α</mi><mrow id="S2.Ex4.m1.2.16.9.3"><mi id="S2.Ex4.m1.2.16.9.3.2">L</mi><mo id="S2.Ex4.m1.2.16.9.3.1">−</mo><mn id="S2.Ex4.m1.2.16.9.3.3">1</mn></mrow></msup><mo id="S2.Ex4.m1.2.16.10" stretchy="false">]</mo></mrow><mo id="S2.Ex4.m1.2.17" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S2.Ex4.m1.2c">H_{L}=\int_{0}^{1}\mu_{\alpha}\mu_{\alpha}^{\top}d\alpha\ \in\mathbb{R}^{L%
\times L},\ \mu_{\alpha}=(\alpha-1)[1,\alpha,\alpha^{2},..,\alpha^{L-1}].</annotation><annotation encoding="application/x-llamapun" id="S2.Ex4.m1.2d">italic_H start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT = ∫ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT italic_μ start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT italic_μ start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_d italic_α ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_L end_POSTSUPERSCRIPT , italic_μ start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT = ( italic_α - 1 ) [ 1 , italic_α , italic_α start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , . . , italic_α start_POSTSUPERSCRIPT italic_L - 1 end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS0.Px3.p1.6">Then the STU outputs a prediction according to the following rule <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>more precisely, there are additional linear and constant terms depending on the exact filters used, such as <math alttext="\hat{y}_{t}=\hat{y}_{t-2}+\sum_{i=1}^{3}M^{u}_{i}u_{t+1-i}+\sum_{i=1}^{k}M_{i}%
\langle\phi_{i},u_{t:t-L}\rangle" class="ltx_Math" display="inline" id="footnote1.m1.2"><semantics id="footnote1.m1.2b"><mrow id="footnote1.m1.2.2" xref="footnote1.m1.2.2.cmml"><msub id="footnote1.m1.2.2.4" xref="footnote1.m1.2.2.4.cmml"><mover accent="true" id="footnote1.m1.2.2.4.2" xref="footnote1.m1.2.2.4.2.cmml"><mi id="footnote1.m1.2.2.4.2.2" xref="footnote1.m1.2.2.4.2.2.cmml">y</mi><mo id="footnote1.m1.2.2.4.2.1" xref="footnote1.m1.2.2.4.2.1.cmml">^</mo></mover><mi id="footnote1.m1.2.2.4.3" xref="footnote1.m1.2.2.4.3.cmml">t</mi></msub><mo id="footnote1.m1.2.2.3" xref="footnote1.m1.2.2.3.cmml">=</mo><mrow id="footnote1.m1.2.2.2" xref="footnote1.m1.2.2.2.cmml"><msub id="footnote1.m1.2.2.2.4" xref="footnote1.m1.2.2.2.4.cmml"><mover accent="true" id="footnote1.m1.2.2.2.4.2" xref="footnote1.m1.2.2.2.4.2.cmml"><mi id="footnote1.m1.2.2.2.4.2.2" xref="footnote1.m1.2.2.2.4.2.2.cmml">y</mi><mo id="footnote1.m1.2.2.2.4.2.1" xref="footnote1.m1.2.2.2.4.2.1.cmml">^</mo></mover><mrow id="footnote1.m1.2.2.2.4.3" xref="footnote1.m1.2.2.2.4.3.cmml"><mi id="footnote1.m1.2.2.2.4.3.2" xref="footnote1.m1.2.2.2.4.3.2.cmml">t</mi><mo id="footnote1.m1.2.2.2.4.3.1" xref="footnote1.m1.2.2.2.4.3.1.cmml">−</mo><mn id="footnote1.m1.2.2.2.4.3.3" xref="footnote1.m1.2.2.2.4.3.3.cmml">2</mn></mrow></msub><mo id="footnote1.m1.2.2.2.3" rspace="0.055em" xref="footnote1.m1.2.2.2.3.cmml">+</mo><mrow id="footnote1.m1.2.2.2.5" xref="footnote1.m1.2.2.2.5.cmml"><msubsup id="footnote1.m1.2.2.2.5.1" xref="footnote1.m1.2.2.2.5.1.cmml"><mo id="footnote1.m1.2.2.2.5.1.2.2" xref="footnote1.m1.2.2.2.5.1.2.2.cmml">∑</mo><mrow id="footnote1.m1.2.2.2.5.1.2.3" xref="footnote1.m1.2.2.2.5.1.2.3.cmml"><mi id="footnote1.m1.2.2.2.5.1.2.3.2" xref="footnote1.m1.2.2.2.5.1.2.3.2.cmml">i</mi><mo id="footnote1.m1.2.2.2.5.1.2.3.1" xref="footnote1.m1.2.2.2.5.1.2.3.1.cmml">=</mo><mn id="footnote1.m1.2.2.2.5.1.2.3.3" xref="footnote1.m1.2.2.2.5.1.2.3.3.cmml">1</mn></mrow><mn id="footnote1.m1.2.2.2.5.1.3" xref="footnote1.m1.2.2.2.5.1.3.cmml">3</mn></msubsup><mrow id="footnote1.m1.2.2.2.5.2" xref="footnote1.m1.2.2.2.5.2.cmml"><msubsup id="footnote1.m1.2.2.2.5.2.2" xref="footnote1.m1.2.2.2.5.2.2.cmml"><mi id="footnote1.m1.2.2.2.5.2.2.2.2" xref="footnote1.m1.2.2.2.5.2.2.2.2.cmml">M</mi><mi id="footnote1.m1.2.2.2.5.2.2.3" xref="footnote1.m1.2.2.2.5.2.2.3.cmml">i</mi><mi id="footnote1.m1.2.2.2.5.2.2.2.3" xref="footnote1.m1.2.2.2.5.2.2.2.3.cmml">u</mi></msubsup><mo id="footnote1.m1.2.2.2.5.2.1" xref="footnote1.m1.2.2.2.5.2.1.cmml">⁢</mo><msub id="footnote1.m1.2.2.2.5.2.3" xref="footnote1.m1.2.2.2.5.2.3.cmml"><mi id="footnote1.m1.2.2.2.5.2.3.2" xref="footnote1.m1.2.2.2.5.2.3.2.cmml">u</mi><mrow id="footnote1.m1.2.2.2.5.2.3.3" xref="footnote1.m1.2.2.2.5.2.3.3.cmml"><mrow id="footnote1.m1.2.2.2.5.2.3.3.2" xref="footnote1.m1.2.2.2.5.2.3.3.2.cmml"><mi id="footnote1.m1.2.2.2.5.2.3.3.2.2" xref="footnote1.m1.2.2.2.5.2.3.3.2.2.cmml">t</mi><mo id="footnote1.m1.2.2.2.5.2.3.3.2.1" xref="footnote1.m1.2.2.2.5.2.3.3.2.1.cmml">+</mo><mn id="footnote1.m1.2.2.2.5.2.3.3.2.3" xref="footnote1.m1.2.2.2.5.2.3.3.2.3.cmml">1</mn></mrow><mo id="footnote1.m1.2.2.2.5.2.3.3.1" xref="footnote1.m1.2.2.2.5.2.3.3.1.cmml">−</mo><mi id="footnote1.m1.2.2.2.5.2.3.3.3" xref="footnote1.m1.2.2.2.5.2.3.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="footnote1.m1.2.2.2.3b" rspace="0.055em" xref="footnote1.m1.2.2.2.3.cmml">+</mo><mrow id="footnote1.m1.2.2.2.2" xref="footnote1.m1.2.2.2.2.cmml"><msubsup id="footnote1.m1.2.2.2.2.3" xref="footnote1.m1.2.2.2.2.3.cmml"><mo id="footnote1.m1.2.2.2.2.3.2.2" xref="footnote1.m1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="footnote1.m1.2.2.2.2.3.2.3" xref="footnote1.m1.2.2.2.2.3.2.3.cmml"><mi id="footnote1.m1.2.2.2.2.3.2.3.2" xref="footnote1.m1.2.2.2.2.3.2.3.2.cmml">i</mi><mo id="footnote1.m1.2.2.2.2.3.2.3.1" xref="footnote1.m1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="footnote1.m1.2.2.2.2.3.2.3.3" xref="footnote1.m1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="footnote1.m1.2.2.2.2.3.3" xref="footnote1.m1.2.2.2.2.3.3.cmml">k</mi></msubsup><mrow id="footnote1.m1.2.2.2.2.2" xref="footnote1.m1.2.2.2.2.2.cmml"><msub id="footnote1.m1.2.2.2.2.2.4" xref="footnote1.m1.2.2.2.2.2.4.cmml"><mi id="footnote1.m1.2.2.2.2.2.4.2" xref="footnote1.m1.2.2.2.2.2.4.2.cmml">M</mi><mi id="footnote1.m1.2.2.2.2.2.4.3" xref="footnote1.m1.2.2.2.2.2.4.3.cmml">i</mi></msub><mo id="footnote1.m1.2.2.2.2.2.3" xref="footnote1.m1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="footnote1.m1.2.2.2.2.2.2.2" xref="footnote1.m1.2.2.2.2.2.2.3.cmml"><mo id="footnote1.m1.2.2.2.2.2.2.2.3" stretchy="false" xref="footnote1.m1.2.2.2.2.2.2.3.cmml">⟨</mo><msub id="footnote1.m1.1.1.1.1.1.1.1.1" xref="footnote1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="footnote1.m1.1.1.1.1.1.1.1.1.2" xref="footnote1.m1.1.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="footnote1.m1.1.1.1.1.1.1.1.1.3" xref="footnote1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="footnote1.m1.2.2.2.2.2.2.2.4" xref="footnote1.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="footnote1.m1.2.2.2.2.2.2.2.2" xref="footnote1.m1.2.2.2.2.2.2.2.2.cmml"><mi id="footnote1.m1.2.2.2.2.2.2.2.2.2" xref="footnote1.m1.2.2.2.2.2.2.2.2.2.cmml">u</mi><mrow id="footnote1.m1.2.2.2.2.2.2.2.2.3" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.cmml"><mi id="footnote1.m1.2.2.2.2.2.2.2.2.3.2" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="footnote1.m1.2.2.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.1.cmml">:</mo><mrow id="footnote1.m1.2.2.2.2.2.2.2.2.3.3" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.3.cmml"><mi id="footnote1.m1.2.2.2.2.2.2.2.2.3.3.2" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="footnote1.m1.2.2.2.2.2.2.2.2.3.3.1" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.3.1.cmml">−</mo><mi id="footnote1.m1.2.2.2.2.2.2.2.2.3.3.3" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.3.3.cmml">L</mi></mrow></mrow></msub><mo id="footnote1.m1.2.2.2.2.2.2.2.5" stretchy="false" xref="footnote1.m1.2.2.2.2.2.2.3.cmml">⟩</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m1.2c"><apply id="footnote1.m1.2.2.cmml" xref="footnote1.m1.2.2"><eq id="footnote1.m1.2.2.3.cmml" xref="footnote1.m1.2.2.3"></eq><apply id="footnote1.m1.2.2.4.cmml" xref="footnote1.m1.2.2.4"><csymbol cd="ambiguous" id="footnote1.m1.2.2.4.1.cmml" xref="footnote1.m1.2.2.4">subscript</csymbol><apply id="footnote1.m1.2.2.4.2.cmml" xref="footnote1.m1.2.2.4.2"><ci id="footnote1.m1.2.2.4.2.1.cmml" xref="footnote1.m1.2.2.4.2.1">^</ci><ci id="footnote1.m1.2.2.4.2.2.cmml" xref="footnote1.m1.2.2.4.2.2">𝑦</ci></apply><ci id="footnote1.m1.2.2.4.3.cmml" xref="footnote1.m1.2.2.4.3">𝑡</ci></apply><apply id="footnote1.m1.2.2.2.cmml" xref="footnote1.m1.2.2.2"><plus id="footnote1.m1.2.2.2.3.cmml" xref="footnote1.m1.2.2.2.3"></plus><apply id="footnote1.m1.2.2.2.4.cmml" xref="footnote1.m1.2.2.2.4"><csymbol cd="ambiguous" id="footnote1.m1.2.2.2.4.1.cmml" xref="footnote1.m1.2.2.2.4">subscript</csymbol><apply id="footnote1.m1.2.2.2.4.2.cmml" xref="footnote1.m1.2.2.2.4.2"><ci id="footnote1.m1.2.2.2.4.2.1.cmml" xref="footnote1.m1.2.2.2.4.2.1">^</ci><ci id="footnote1.m1.2.2.2.4.2.2.cmml" xref="footnote1.m1.2.2.2.4.2.2">𝑦</ci></apply><apply id="footnote1.m1.2.2.2.4.3.cmml" xref="footnote1.m1.2.2.2.4.3"><minus id="footnote1.m1.2.2.2.4.3.1.cmml" xref="footnote1.m1.2.2.2.4.3.1"></minus><ci id="footnote1.m1.2.2.2.4.3.2.cmml" xref="footnote1.m1.2.2.2.4.3.2">𝑡</ci><cn id="footnote1.m1.2.2.2.4.3.3.cmml" type="integer" xref="footnote1.m1.2.2.2.4.3.3">2</cn></apply></apply><apply id="footnote1.m1.2.2.2.5.cmml" xref="footnote1.m1.2.2.2.5"><apply id="footnote1.m1.2.2.2.5.1.cmml" xref="footnote1.m1.2.2.2.5.1"><csymbol cd="ambiguous" id="footnote1.m1.2.2.2.5.1.1.cmml" xref="footnote1.m1.2.2.2.5.1">superscript</csymbol><apply id="footnote1.m1.2.2.2.5.1.2.cmml" xref="footnote1.m1.2.2.2.5.1"><csymbol cd="ambiguous" id="footnote1.m1.2.2.2.5.1.2.1.cmml" xref="footnote1.m1.2.2.2.5.1">subscript</csymbol><sum id="footnote1.m1.2.2.2.5.1.2.2.cmml" xref="footnote1.m1.2.2.2.5.1.2.2"></sum><apply id="footnote1.m1.2.2.2.5.1.2.3.cmml" xref="footnote1.m1.2.2.2.5.1.2.3"><eq id="footnote1.m1.2.2.2.5.1.2.3.1.cmml" xref="footnote1.m1.2.2.2.5.1.2.3.1"></eq><ci id="footnote1.m1.2.2.2.5.1.2.3.2.cmml" xref="footnote1.m1.2.2.2.5.1.2.3.2">𝑖</ci><cn id="footnote1.m1.2.2.2.5.1.2.3.3.cmml" type="integer" xref="footnote1.m1.2.2.2.5.1.2.3.3">1</cn></apply></apply><cn id="footnote1.m1.2.2.2.5.1.3.cmml" type="integer" xref="footnote1.m1.2.2.2.5.1.3">3</cn></apply><apply id="footnote1.m1.2.2.2.5.2.cmml" xref="footnote1.m1.2.2.2.5.2"><times id="footnote1.m1.2.2.2.5.2.1.cmml" xref="footnote1.m1.2.2.2.5.2.1"></times><apply id="footnote1.m1.2.2.2.5.2.2.cmml" xref="footnote1.m1.2.2.2.5.2.2"><csymbol cd="ambiguous" id="footnote1.m1.2.2.2.5.2.2.1.cmml" xref="footnote1.m1.2.2.2.5.2.2">subscript</csymbol><apply id="footnote1.m1.2.2.2.5.2.2.2.cmml" xref="footnote1.m1.2.2.2.5.2.2"><csymbol cd="ambiguous" id="footnote1.m1.2.2.2.5.2.2.2.1.cmml" xref="footnote1.m1.2.2.2.5.2.2">superscript</csymbol><ci id="footnote1.m1.2.2.2.5.2.2.2.2.cmml" xref="footnote1.m1.2.2.2.5.2.2.2.2">𝑀</ci><ci id="footnote1.m1.2.2.2.5.2.2.2.3.cmml" xref="footnote1.m1.2.2.2.5.2.2.2.3">𝑢</ci></apply><ci id="footnote1.m1.2.2.2.5.2.2.3.cmml" xref="footnote1.m1.2.2.2.5.2.2.3">𝑖</ci></apply><apply id="footnote1.m1.2.2.2.5.2.3.cmml" xref="footnote1.m1.2.2.2.5.2.3"><csymbol cd="ambiguous" id="footnote1.m1.2.2.2.5.2.3.1.cmml" xref="footnote1.m1.2.2.2.5.2.3">subscript</csymbol><ci id="footnote1.m1.2.2.2.5.2.3.2.cmml" xref="footnote1.m1.2.2.2.5.2.3.2">𝑢</ci><apply id="footnote1.m1.2.2.2.5.2.3.3.cmml" xref="footnote1.m1.2.2.2.5.2.3.3"><minus id="footnote1.m1.2.2.2.5.2.3.3.1.cmml" xref="footnote1.m1.2.2.2.5.2.3.3.1"></minus><apply id="footnote1.m1.2.2.2.5.2.3.3.2.cmml" xref="footnote1.m1.2.2.2.5.2.3.3.2"><plus id="footnote1.m1.2.2.2.5.2.3.3.2.1.cmml" xref="footnote1.m1.2.2.2.5.2.3.3.2.1"></plus><ci id="footnote1.m1.2.2.2.5.2.3.3.2.2.cmml" xref="footnote1.m1.2.2.2.5.2.3.3.2.2">𝑡</ci><cn id="footnote1.m1.2.2.2.5.2.3.3.2.3.cmml" type="integer" xref="footnote1.m1.2.2.2.5.2.3.3.2.3">1</cn></apply><ci id="footnote1.m1.2.2.2.5.2.3.3.3.cmml" xref="footnote1.m1.2.2.2.5.2.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="footnote1.m1.2.2.2.2.cmml" xref="footnote1.m1.2.2.2.2"><apply id="footnote1.m1.2.2.2.2.3.cmml" xref="footnote1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="footnote1.m1.2.2.2.2.3.1.cmml" xref="footnote1.m1.2.2.2.2.3">superscript</csymbol><apply id="footnote1.m1.2.2.2.2.3.2.cmml" xref="footnote1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="footnote1.m1.2.2.2.2.3.2.1.cmml" xref="footnote1.m1.2.2.2.2.3">subscript</csymbol><sum id="footnote1.m1.2.2.2.2.3.2.2.cmml" xref="footnote1.m1.2.2.2.2.3.2.2"></sum><apply id="footnote1.m1.2.2.2.2.3.2.3.cmml" xref="footnote1.m1.2.2.2.2.3.2.3"><eq id="footnote1.m1.2.2.2.2.3.2.3.1.cmml" xref="footnote1.m1.2.2.2.2.3.2.3.1"></eq><ci id="footnote1.m1.2.2.2.2.3.2.3.2.cmml" xref="footnote1.m1.2.2.2.2.3.2.3.2">𝑖</ci><cn id="footnote1.m1.2.2.2.2.3.2.3.3.cmml" type="integer" xref="footnote1.m1.2.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="footnote1.m1.2.2.2.2.3.3.cmml" xref="footnote1.m1.2.2.2.2.3.3">𝑘</ci></apply><apply id="footnote1.m1.2.2.2.2.2.cmml" xref="footnote1.m1.2.2.2.2.2"><times id="footnote1.m1.2.2.2.2.2.3.cmml" xref="footnote1.m1.2.2.2.2.2.3"></times><apply id="footnote1.m1.2.2.2.2.2.4.cmml" xref="footnote1.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="footnote1.m1.2.2.2.2.2.4.1.cmml" xref="footnote1.m1.2.2.2.2.2.4">subscript</csymbol><ci id="footnote1.m1.2.2.2.2.2.4.2.cmml" xref="footnote1.m1.2.2.2.2.2.4.2">𝑀</ci><ci id="footnote1.m1.2.2.2.2.2.4.3.cmml" xref="footnote1.m1.2.2.2.2.2.4.3">𝑖</ci></apply><list id="footnote1.m1.2.2.2.2.2.2.3.cmml" xref="footnote1.m1.2.2.2.2.2.2.2"><apply id="footnote1.m1.1.1.1.1.1.1.1.1.cmml" xref="footnote1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="footnote1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="footnote1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="footnote1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="footnote1.m1.1.1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="footnote1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="footnote1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="footnote1.m1.2.2.2.2.2.2.2.2.cmml" xref="footnote1.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="footnote1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="footnote1.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="footnote1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="footnote1.m1.2.2.2.2.2.2.2.2.2">𝑢</ci><apply id="footnote1.m1.2.2.2.2.2.2.2.2.3.cmml" xref="footnote1.m1.2.2.2.2.2.2.2.2.3"><ci id="footnote1.m1.2.2.2.2.2.2.2.2.3.1.cmml" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.1">:</ci><ci id="footnote1.m1.2.2.2.2.2.2.2.2.3.2.cmml" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.2">𝑡</ci><apply id="footnote1.m1.2.2.2.2.2.2.2.2.3.3.cmml" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.3"><minus id="footnote1.m1.2.2.2.2.2.2.2.2.3.3.1.cmml" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.3.1"></minus><ci id="footnote1.m1.2.2.2.2.2.2.2.2.3.3.2.cmml" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.3.2">𝑡</ci><ci id="footnote1.m1.2.2.2.2.2.2.2.2.3.3.3.cmml" xref="footnote1.m1.2.2.2.2.2.2.2.2.3.3.3">𝐿</ci></apply></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.2d">\hat{y}_{t}=\hat{y}_{t-2}+\sum_{i=1}^{3}M^{u}_{i}u_{t+1-i}+\sum_{i=1}^{k}M_{i}%
\langle\phi_{i},u_{t:t-L}\rangle</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.2e">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t - 2 end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT italic_M start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_t + 1 - italic_i end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟨ italic_ϕ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_t : italic_t - italic_L end_POSTSUBSCRIPT ⟩</annotation></semantics></math>, see <cite class="ltx_cite ltx_citemacro_cite">Agarwal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib1" title="">2023</a>)</cite> for more details.</span></span></span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}_{t}=\sum_{i=1}^{k}M_{i}\langle\phi_{i},u_{t:t-L}\rangle," class="ltx_Math" display="block" id="S2.Ex5.m1.1"><semantics id="S2.Ex5.m1.1a"><mrow id="S2.Ex5.m1.1.1.1" xref="S2.Ex5.m1.1.1.1.1.cmml"><mrow id="S2.Ex5.m1.1.1.1.1" xref="S2.Ex5.m1.1.1.1.1.cmml"><msub id="S2.Ex5.m1.1.1.1.1.4" xref="S2.Ex5.m1.1.1.1.1.4.cmml"><mover accent="true" id="S2.Ex5.m1.1.1.1.1.4.2" xref="S2.Ex5.m1.1.1.1.1.4.2.cmml"><mi id="S2.Ex5.m1.1.1.1.1.4.2.2" xref="S2.Ex5.m1.1.1.1.1.4.2.2.cmml">y</mi><mo id="S2.Ex5.m1.1.1.1.1.4.2.1" xref="S2.Ex5.m1.1.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S2.Ex5.m1.1.1.1.1.4.3" xref="S2.Ex5.m1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S2.Ex5.m1.1.1.1.1.3" rspace="0.111em" xref="S2.Ex5.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.Ex5.m1.1.1.1.1.2" xref="S2.Ex5.m1.1.1.1.1.2.cmml"><munderover id="S2.Ex5.m1.1.1.1.1.2.3" xref="S2.Ex5.m1.1.1.1.1.2.3.cmml"><mo id="S2.Ex5.m1.1.1.1.1.2.3.2.2" movablelimits="false" xref="S2.Ex5.m1.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="S2.Ex5.m1.1.1.1.1.2.3.2.3" xref="S2.Ex5.m1.1.1.1.1.2.3.2.3.cmml"><mi id="S2.Ex5.m1.1.1.1.1.2.3.2.3.2" xref="S2.Ex5.m1.1.1.1.1.2.3.2.3.2.cmml">i</mi><mo id="S2.Ex5.m1.1.1.1.1.2.3.2.3.1" xref="S2.Ex5.m1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="S2.Ex5.m1.1.1.1.1.2.3.2.3.3" xref="S2.Ex5.m1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex5.m1.1.1.1.1.2.3.3" xref="S2.Ex5.m1.1.1.1.1.2.3.3.cmml">k</mi></munderover><mrow id="S2.Ex5.m1.1.1.1.1.2.2" xref="S2.Ex5.m1.1.1.1.1.2.2.cmml"><msub id="S2.Ex5.m1.1.1.1.1.2.2.4" xref="S2.Ex5.m1.1.1.1.1.2.2.4.cmml"><mi id="S2.Ex5.m1.1.1.1.1.2.2.4.2" xref="S2.Ex5.m1.1.1.1.1.2.2.4.2.cmml">M</mi><mi id="S2.Ex5.m1.1.1.1.1.2.2.4.3" xref="S2.Ex5.m1.1.1.1.1.2.2.4.3.cmml">i</mi></msub><mo id="S2.Ex5.m1.1.1.1.1.2.2.3" xref="S2.Ex5.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.Ex5.m1.1.1.1.1.2.2.2.2" xref="S2.Ex5.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S2.Ex5.m1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S2.Ex5.m1.1.1.1.1.2.2.2.3.cmml">⟨</mo><msub id="S2.Ex5.m1.1.1.1.1.1.1.1.1.1" xref="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex5.m1.1.1.1.1.2.2.2.2.4" xref="S2.Ex5.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msub id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.2" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.2.cmml">u</mi><mrow id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.2" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">:</mo><mrow id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.cmml"><mi id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.2" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.1" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.1.cmml">−</mo><mi id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.3" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.3.cmml">L</mi></mrow></mrow></msub><mo id="S2.Ex5.m1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S2.Ex5.m1.1.1.1.1.2.2.2.3.cmml">⟩</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex5.m1.1.1.1.2" xref="S2.Ex5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex5.m1.1b"><apply id="S2.Ex5.m1.1.1.1.1.cmml" xref="S2.Ex5.m1.1.1.1"><eq id="S2.Ex5.m1.1.1.1.1.3.cmml" xref="S2.Ex5.m1.1.1.1.1.3"></eq><apply id="S2.Ex5.m1.1.1.1.1.4.cmml" xref="S2.Ex5.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex5.m1.1.1.1.1.4.1.cmml" xref="S2.Ex5.m1.1.1.1.1.4">subscript</csymbol><apply id="S2.Ex5.m1.1.1.1.1.4.2.cmml" xref="S2.Ex5.m1.1.1.1.1.4.2"><ci id="S2.Ex5.m1.1.1.1.1.4.2.1.cmml" xref="S2.Ex5.m1.1.1.1.1.4.2.1">^</ci><ci id="S2.Ex5.m1.1.1.1.1.4.2.2.cmml" xref="S2.Ex5.m1.1.1.1.1.4.2.2">𝑦</ci></apply><ci id="S2.Ex5.m1.1.1.1.1.4.3.cmml" xref="S2.Ex5.m1.1.1.1.1.4.3">𝑡</ci></apply><apply id="S2.Ex5.m1.1.1.1.1.2.cmml" xref="S2.Ex5.m1.1.1.1.1.2"><apply id="S2.Ex5.m1.1.1.1.1.2.3.cmml" xref="S2.Ex5.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex5.m1.1.1.1.1.2.3.1.cmml" xref="S2.Ex5.m1.1.1.1.1.2.3">superscript</csymbol><apply id="S2.Ex5.m1.1.1.1.1.2.3.2.cmml" xref="S2.Ex5.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex5.m1.1.1.1.1.2.3.2.1.cmml" xref="S2.Ex5.m1.1.1.1.1.2.3">subscript</csymbol><sum id="S2.Ex5.m1.1.1.1.1.2.3.2.2.cmml" xref="S2.Ex5.m1.1.1.1.1.2.3.2.2"></sum><apply id="S2.Ex5.m1.1.1.1.1.2.3.2.3.cmml" xref="S2.Ex5.m1.1.1.1.1.2.3.2.3"><eq id="S2.Ex5.m1.1.1.1.1.2.3.2.3.1.cmml" xref="S2.Ex5.m1.1.1.1.1.2.3.2.3.1"></eq><ci id="S2.Ex5.m1.1.1.1.1.2.3.2.3.2.cmml" xref="S2.Ex5.m1.1.1.1.1.2.3.2.3.2">𝑖</ci><cn id="S2.Ex5.m1.1.1.1.1.2.3.2.3.3.cmml" type="integer" xref="S2.Ex5.m1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S2.Ex5.m1.1.1.1.1.2.3.3.cmml" xref="S2.Ex5.m1.1.1.1.1.2.3.3">𝑘</ci></apply><apply id="S2.Ex5.m1.1.1.1.1.2.2.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2"><times id="S2.Ex5.m1.1.1.1.1.2.2.3.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.3"></times><apply id="S2.Ex5.m1.1.1.1.1.2.2.4.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S2.Ex5.m1.1.1.1.1.2.2.4.1.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.4">subscript</csymbol><ci id="S2.Ex5.m1.1.1.1.1.2.2.4.2.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.4.2">𝑀</ci><ci id="S2.Ex5.m1.1.1.1.1.2.2.4.3.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.4.3">𝑖</ci></apply><list id="S2.Ex5.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2"><apply id="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex5.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.2">𝑢</ci><apply id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3"><ci id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.1">:</ci><ci id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.2">𝑡</ci><apply id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3"><minus id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.1.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.1"></minus><ci id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.2.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.2">𝑡</ci><ci id="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.3.cmml" xref="S2.Ex5.m1.1.1.1.1.2.2.2.2.2.3.3.3">𝐿</ci></apply></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex5.m1.1c">\hat{y}_{t}=\sum_{i=1}^{k}M_{i}\langle\phi_{i},u_{t:t-L}\rangle,</annotation><annotation encoding="application/x-llamapun" id="S2.Ex5.m1.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟨ italic_ϕ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_t : italic_t - italic_L end_POSTSUBSCRIPT ⟩ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS0.Px3.p1.5">where <math alttext="\phi_{i}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px3.p1.4.m1.1"><semantics id="S2.SS1.SSS0.Px3.p1.4.m1.1a"><msub id="S2.SS1.SSS0.Px3.p1.4.m1.1.1" xref="S2.SS1.SSS0.Px3.p1.4.m1.1.1.cmml"><mi id="S2.SS1.SSS0.Px3.p1.4.m1.1.1.2" xref="S2.SS1.SSS0.Px3.p1.4.m1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.SSS0.Px3.p1.4.m1.1.1.3" xref="S2.SS1.SSS0.Px3.p1.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px3.p1.4.m1.1b"><apply id="S2.SS1.SSS0.Px3.p1.4.m1.1.1.cmml" xref="S2.SS1.SSS0.Px3.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px3.p1.4.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px3.p1.4.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px3.p1.4.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px3.p1.4.m1.1.1.2">italic-ϕ</ci><ci id="S2.SS1.SSS0.Px3.p1.4.m1.1.1.3.cmml" xref="S2.SS1.SSS0.Px3.p1.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px3.p1.4.m1.1c">\phi_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px3.p1.4.m1.1d">italic_ϕ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are the eigenvectors as above and <math alttext="M_{1:k}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px3.p1.5.m2.1"><semantics id="S2.SS1.SSS0.Px3.p1.5.m2.1a"><msub id="S2.SS1.SSS0.Px3.p1.5.m2.1.1" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.cmml"><mi id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.2" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.2.cmml">M</mi><mrow id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.cmml"><mn id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.2" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.2.cmml">1</mn><mo id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.1.cmml">:</mo><mi id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.3" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px3.p1.5.m2.1b"><apply id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.cmml" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.2">𝑀</ci><apply id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.cmml" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3"><ci id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.1">:</ci><cn id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.2.cmml" type="integer" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.2">1</cn><ci id="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px3.p1.5.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px3.p1.5.m2.1c">M_{1:k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px3.p1.5.m2.1d">italic_M start_POSTSUBSCRIPT 1 : italic_k end_POSTSUBSCRIPT</annotation></semantics></math> are learned projection matrices.
The STU architecture is particularly appealing for learning in dynamical systems with long context, as it has theoretical guarantees for this setting, as spelled out in <cite class="ltx_cite ltx_citemacro_cite">Agarwal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib1" title="">2023</a>)</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Hyena.</h4>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px4.p1.5">The Hyena architecture proposed in <cite class="ltx_cite ltx_citemacro_cite">Poli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib18" title="">2023</a>)</cite>, sequentially applies convolutions and element-wise products alternately. Formally, the given an input <math alttext="u_{1:T}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px4.p1.1.m1.1"><semantics id="S2.SS1.SSS0.Px4.p1.1.m1.1a"><msub id="S2.SS1.SSS0.Px4.p1.1.m1.1.1" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.cmml"><mi id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.2" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.2.cmml">u</mi><mrow id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.cmml"><mn id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.2" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.2.cmml">1</mn><mo id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.3" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.3.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px4.p1.1.m1.1b"><apply id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.2">𝑢</ci><apply id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.cmml" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3"><ci id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.1">:</ci><cn id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.2">1</cn><ci id="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px4.p1.1.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px4.p1.1.m1.1c">u_{1:T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px4.p1.1.m1.1d">italic_u start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="N+1" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px4.p1.2.m2.1"><semantics id="S2.SS1.SSS0.Px4.p1.2.m2.1a"><mrow id="S2.SS1.SSS0.Px4.p1.2.m2.1.1" xref="S2.SS1.SSS0.Px4.p1.2.m2.1.1.cmml"><mi id="S2.SS1.SSS0.Px4.p1.2.m2.1.1.2" xref="S2.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml">N</mi><mo id="S2.SS1.SSS0.Px4.p1.2.m2.1.1.1" xref="S2.SS1.SSS0.Px4.p1.2.m2.1.1.1.cmml">+</mo><mn id="S2.SS1.SSS0.Px4.p1.2.m2.1.1.3" xref="S2.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px4.p1.2.m2.1b"><apply id="S2.SS1.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px4.p1.2.m2.1.1"><plus id="S2.SS1.SSS0.Px4.p1.2.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px4.p1.2.m2.1.1.1"></plus><ci id="S2.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px4.p1.2.m2.1.1.2">𝑁</ci><cn id="S2.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS1.SSS0.Px4.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px4.p1.2.m2.1c">N+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px4.p1.2.m2.1d">italic_N + 1</annotation></semantics></math> linear projections <math alttext="v,x_{1},\ldots x_{N}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px4.p1.3.m3.3"><semantics id="S2.SS1.SSS0.Px4.p1.3.m3.3a"><mrow id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.3.cmml"><mi id="S2.SS1.SSS0.Px4.p1.3.m3.1.1" xref="S2.SS1.SSS0.Px4.p1.3.m3.1.1.cmml">v</mi><mo id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.3" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.3.cmml">,</mo><msub id="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1" xref="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.cmml"><mi id="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.2" xref="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.2.cmml">x</mi><mn id="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.3" xref="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.4" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.3.cmml">,</mo><mrow id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.cmml"><mi id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.2" mathvariant="normal" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.2.cmml">…</mi><mo id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.1" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.1.cmml">⁢</mo><msub id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.cmml"><mi id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.2" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.2.cmml">x</mi><mi id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.3" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.3.cmml">N</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px4.p1.3.m3.3b"><list id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.3.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2"><ci id="S2.SS1.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.1.1">𝑣</ci><apply id="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.1.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.2.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.2">𝑥</ci><cn id="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.3.cmml" type="integer" xref="S2.SS1.SSS0.Px4.p1.3.m3.2.2.1.1.3">1</cn></apply><apply id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2"><times id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.1.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.1"></times><ci id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.2.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.2">…</ci><apply id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.1.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3">subscript</csymbol><ci id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.2.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.2">𝑥</ci><ci id="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.3.cmml" xref="S2.SS1.SSS0.Px4.p1.3.m3.3.3.2.2.3.3">𝑁</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px4.p1.3.m3.3c">v,x_{1},\ldots x_{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px4.p1.3.m3.3d">italic_v , italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … italic_x start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math> of the input are constructed (similar to the <math alttext="q,k,v" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px4.p1.4.m4.3"><semantics id="S2.SS1.SSS0.Px4.p1.4.m4.3a"><mrow id="S2.SS1.SSS0.Px4.p1.4.m4.3.4.2" xref="S2.SS1.SSS0.Px4.p1.4.m4.3.4.1.cmml"><mi id="S2.SS1.SSS0.Px4.p1.4.m4.1.1" xref="S2.SS1.SSS0.Px4.p1.4.m4.1.1.cmml">q</mi><mo id="S2.SS1.SSS0.Px4.p1.4.m4.3.4.2.1" xref="S2.SS1.SSS0.Px4.p1.4.m4.3.4.1.cmml">,</mo><mi id="S2.SS1.SSS0.Px4.p1.4.m4.2.2" xref="S2.SS1.SSS0.Px4.p1.4.m4.2.2.cmml">k</mi><mo id="S2.SS1.SSS0.Px4.p1.4.m4.3.4.2.2" xref="S2.SS1.SSS0.Px4.p1.4.m4.3.4.1.cmml">,</mo><mi id="S2.SS1.SSS0.Px4.p1.4.m4.3.3" xref="S2.SS1.SSS0.Px4.p1.4.m4.3.3.cmml">v</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px4.p1.4.m4.3b"><list id="S2.SS1.SSS0.Px4.p1.4.m4.3.4.1.cmml" xref="S2.SS1.SSS0.Px4.p1.4.m4.3.4.2"><ci id="S2.SS1.SSS0.Px4.p1.4.m4.1.1.cmml" xref="S2.SS1.SSS0.Px4.p1.4.m4.1.1">𝑞</ci><ci id="S2.SS1.SSS0.Px4.p1.4.m4.2.2.cmml" xref="S2.SS1.SSS0.Px4.p1.4.m4.2.2">𝑘</ci><ci id="S2.SS1.SSS0.Px4.p1.4.m4.3.3.cmml" xref="S2.SS1.SSS0.Px4.p1.4.m4.3.3">𝑣</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px4.p1.4.m4.3c">q,k,v</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px4.p1.4.m4.3d">italic_q , italic_k , italic_v</annotation></semantics></math> sequence in self-attention). The hyena operator as a sequence of convolution with learnable filters <math alttext="h_{1}\ldots h_{N}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px4.p1.5.m5.1"><semantics id="S2.SS1.SSS0.Px4.p1.5.m5.1a"><mrow id="S2.SS1.SSS0.Px4.p1.5.m5.1.1" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.cmml"><msub id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.cmml"><mi id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.2" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.2.cmml">h</mi><mn id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.3" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.1" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.3" mathvariant="normal" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.3.cmml">…</mi><mo id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.1a" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.cmml"><mi id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.2" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.2.cmml">h</mi><mi id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.3" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px4.p1.5.m5.1b"><apply id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.cmml" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1"><times id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.1.cmml" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.1"></times><apply id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.cmml" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.1.cmml" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.2.cmml" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.2">ℎ</ci><cn id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.3.cmml" type="integer" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.2.3">1</cn></apply><ci id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.3.cmml" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.3">…</ci><apply id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.cmml" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.1.cmml" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.2.cmml" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.2">ℎ</ci><ci id="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.3.cmml" xref="S2.SS1.SSS0.Px4.p1.5.m5.1.1.4.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px4.p1.5.m5.1c">h_{1}\ldots h_{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px4.p1.5.m5.1d">italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math> is then given by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="y=x^{N}\cdot\left(h^{N}*\left(x^{N-1}\cdot\left(h^{N-1}*(\ldots)\right)\right)%
\right)." class="ltx_Math" display="block" id="S2.Ex6.m1.2"><semantics id="S2.Ex6.m1.2a"><mrow id="S2.Ex6.m1.2.2.1" xref="S2.Ex6.m1.2.2.1.1.cmml"><mrow id="S2.Ex6.m1.2.2.1.1" xref="S2.Ex6.m1.2.2.1.1.cmml"><mi id="S2.Ex6.m1.2.2.1.1.3" xref="S2.Ex6.m1.2.2.1.1.3.cmml">y</mi><mo id="S2.Ex6.m1.2.2.1.1.2" xref="S2.Ex6.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.Ex6.m1.2.2.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.cmml"><msup id="S2.Ex6.m1.2.2.1.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.3.cmml"><mi id="S2.Ex6.m1.2.2.1.1.1.3.2" xref="S2.Ex6.m1.2.2.1.1.1.3.2.cmml">x</mi><mi id="S2.Ex6.m1.2.2.1.1.1.3.3" xref="S2.Ex6.m1.2.2.1.1.1.3.3.cmml">N</mi></msup><mo id="S2.Ex6.m1.2.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.Ex6.m1.2.2.1.1.1.2.cmml">⋅</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.cmml"><msup id="S2.Ex6.m1.2.2.1.1.1.1.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.3.cmml">N</mi></msup><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.2.cmml">∗</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml">N</mi><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msup><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">N</mi><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∗</mo><mrow id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.Ex6.m1.1.1" mathvariant="normal" xref="S2.Ex6.m1.1.1.cmml">…</mi><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.2.2.1.1.1.1.1.3" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex6.m1.2.2.1.2" lspace="0em" xref="S2.Ex6.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex6.m1.2b"><apply id="S2.Ex6.m1.2.2.1.1.cmml" xref="S2.Ex6.m1.2.2.1"><eq id="S2.Ex6.m1.2.2.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.2"></eq><ci id="S2.Ex6.m1.2.2.1.1.3.cmml" xref="S2.Ex6.m1.2.2.1.1.3">𝑦</ci><apply id="S2.Ex6.m1.2.2.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1"><ci id="S2.Ex6.m1.2.2.1.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.2">⋅</ci><apply id="S2.Ex6.m1.2.2.1.1.1.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex6.m1.2.2.1.1.1.3.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.3">superscript</csymbol><ci id="S2.Ex6.m1.2.2.1.1.1.3.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.3.2">𝑥</ci><ci id="S2.Ex6.m1.2.2.1.1.1.3.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.3.3">𝑁</ci></apply><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1"><times id="S2.Ex6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.2">ℎ</ci><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1"><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.2">⋅</ci><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3"><minus id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2">𝑁</ci><cn id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><minus id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑁</ci><cn id="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.Ex6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S2.Ex6.m1.1.1.cmml" xref="S2.Ex6.m1.1.1">…</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex6.m1.2c">y=x^{N}\cdot\left(h^{N}*\left(x^{N-1}\cdot\left(h^{N-1}*(\ldots)\right)\right)%
\right).</annotation><annotation encoding="application/x-llamapun" id="S2.Ex6.m1.2d">italic_y = italic_x start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ⋅ ( italic_h start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∗ ( italic_x start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT ⋅ ( italic_h start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT ∗ ( … ) ) ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Sequence Generation from a Prompt</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">We consider two modes of generation using sequence models. The first is that of prefill generation, where the sequence model has to generate a specified number of tokens given a certain context. This is depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.F1" title="Figure 1 ‣ Prefill generation. ‣ 2.2 Sequence Generation from a Prompt ‣ 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">1</span></a>. The second is online generation, where the length of the generative output is not predetermined, and we are not given a context.</p>
</div>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Prefill generation.</h4>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px1.p1.1">The prefill generation setting consists of two stages, the prefill stage and the decode stage. During the prefill stage, the model ingests the context vector and generates a cache that stores information required in the decode stage. We denote the context length during the prefill stage as <math alttext="L" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S2.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p1.1.m1.1d">italic_L</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S2.SS2.SSS0.Px1.p2.1">In the decode stage, the model takes the cache and the most recent token as input and generates the next output token. Then the cache updated with the most recent input token. We denote the generation length at the decode stage as <math alttext="K" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S2.SS2.SSS0.Px1.p2.1.m1.1a"><mi id="S2.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S2.SS2.SSS0.Px1.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p2.1.m1.1b"><ci id="S2.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p2.1.m1.1d">italic_K</annotation></semantics></math>. In contrast to pre-training, where the model takes in a training sequence and predicts the next token, in the prefill generation setting the model only has access to the cache and the most recent token when making a prediction.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="187" id="S2.F1.g1" src="x1.png" width="332"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Generation from a prompt in precache.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Online sequence prediction</h3>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.4">In the <span class="ltx_text ltx_font_bold" id="S2.SS3.p1.4.1">online sequence prediction</span> setting, an online learner iteratively sees an input <math alttext="u_{t}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><msub id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">u</mi><mi id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝑢</ci><ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">u_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and has to predict output <math alttext="\hat{y}_{t}" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1"><semantics id="S2.SS3.p1.2.m2.1a"><msub id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mover accent="true" id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml"><mi id="S2.SS3.p1.2.m2.1.1.2.2" xref="S2.SS3.p1.2.m2.1.1.2.2.cmml">y</mi><mo id="S2.SS3.p1.2.m2.1.1.2.1" xref="S2.SS3.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">subscript</csymbol><apply id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2"><ci id="S2.SS3.p1.2.m2.1.1.2.1.cmml" xref="S2.SS3.p1.2.m2.1.1.2.1">^</ci><ci id="S2.SS3.p1.2.m2.1.1.2.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2.2">𝑦</ci></apply><ci id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">\hat{y}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, after which the true output <math alttext="y_{t}" class="ltx_Math" display="inline" id="S2.SS3.p1.3.m3.1"><semantics id="S2.SS3.p1.3.m3.1a"><msub id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml"><mi id="S2.SS3.p1.3.m3.1.1.2" xref="S2.SS3.p1.3.m3.1.1.2.cmml">y</mi><mi id="S2.SS3.p1.3.m3.1.1.3" xref="S2.SS3.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><apply id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p1.3.m3.1.1.2.cmml" xref="S2.SS3.p1.3.m3.1.1.2">𝑦</ci><ci id="S2.SS3.p1.3.m3.1.1.3.cmml" xref="S2.SS3.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is revealed. The goal is to minimize error according to a given Lipschitz loss function <math alttext="\ell_{t}(y_{t},\hat{y}_{t})" class="ltx_Math" display="inline" id="S2.SS3.p1.4.m4.2"><semantics id="S2.SS3.p1.4.m4.2a"><mrow id="S2.SS3.p1.4.m4.2.2" xref="S2.SS3.p1.4.m4.2.2.cmml"><msub id="S2.SS3.p1.4.m4.2.2.4" xref="S2.SS3.p1.4.m4.2.2.4.cmml"><mi id="S2.SS3.p1.4.m4.2.2.4.2" mathvariant="normal" xref="S2.SS3.p1.4.m4.2.2.4.2.cmml">ℓ</mi><mi id="S2.SS3.p1.4.m4.2.2.4.3" xref="S2.SS3.p1.4.m4.2.2.4.3.cmml">t</mi></msub><mo id="S2.SS3.p1.4.m4.2.2.3" xref="S2.SS3.p1.4.m4.2.2.3.cmml">⁢</mo><mrow id="S2.SS3.p1.4.m4.2.2.2.2" xref="S2.SS3.p1.4.m4.2.2.2.3.cmml"><mo id="S2.SS3.p1.4.m4.2.2.2.2.3" stretchy="false" xref="S2.SS3.p1.4.m4.2.2.2.3.cmml">(</mo><msub id="S2.SS3.p1.4.m4.1.1.1.1.1" xref="S2.SS3.p1.4.m4.1.1.1.1.1.cmml"><mi id="S2.SS3.p1.4.m4.1.1.1.1.1.2" xref="S2.SS3.p1.4.m4.1.1.1.1.1.2.cmml">y</mi><mi id="S2.SS3.p1.4.m4.1.1.1.1.1.3" xref="S2.SS3.p1.4.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS3.p1.4.m4.2.2.2.2.4" xref="S2.SS3.p1.4.m4.2.2.2.3.cmml">,</mo><msub id="S2.SS3.p1.4.m4.2.2.2.2.2" xref="S2.SS3.p1.4.m4.2.2.2.2.2.cmml"><mover accent="true" id="S2.SS3.p1.4.m4.2.2.2.2.2.2" xref="S2.SS3.p1.4.m4.2.2.2.2.2.2.cmml"><mi id="S2.SS3.p1.4.m4.2.2.2.2.2.2.2" xref="S2.SS3.p1.4.m4.2.2.2.2.2.2.2.cmml">y</mi><mo id="S2.SS3.p1.4.m4.2.2.2.2.2.2.1" xref="S2.SS3.p1.4.m4.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.SS3.p1.4.m4.2.2.2.2.2.3" xref="S2.SS3.p1.4.m4.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS3.p1.4.m4.2.2.2.2.5" stretchy="false" xref="S2.SS3.p1.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.2b"><apply id="S2.SS3.p1.4.m4.2.2.cmml" xref="S2.SS3.p1.4.m4.2.2"><times id="S2.SS3.p1.4.m4.2.2.3.cmml" xref="S2.SS3.p1.4.m4.2.2.3"></times><apply id="S2.SS3.p1.4.m4.2.2.4.cmml" xref="S2.SS3.p1.4.m4.2.2.4"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.2.2.4.1.cmml" xref="S2.SS3.p1.4.m4.2.2.4">subscript</csymbol><ci id="S2.SS3.p1.4.m4.2.2.4.2.cmml" xref="S2.SS3.p1.4.m4.2.2.4.2">ℓ</ci><ci id="S2.SS3.p1.4.m4.2.2.4.3.cmml" xref="S2.SS3.p1.4.m4.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S2.SS3.p1.4.m4.2.2.2.3.cmml" xref="S2.SS3.p1.4.m4.2.2.2.2"><apply id="S2.SS3.p1.4.m4.1.1.1.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p1.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.4.m4.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS3.p1.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS3.p1.4.m4.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS3.p1.4.m4.2.2.2.2.2.cmml" xref="S2.SS3.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.2.2.2.2.2.1.cmml" xref="S2.SS3.p1.4.m4.2.2.2.2.2">subscript</csymbol><apply id="S2.SS3.p1.4.m4.2.2.2.2.2.2.cmml" xref="S2.SS3.p1.4.m4.2.2.2.2.2.2"><ci id="S2.SS3.p1.4.m4.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p1.4.m4.2.2.2.2.2.2.1">^</ci><ci id="S2.SS3.p1.4.m4.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p1.4.m4.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="S2.SS3.p1.4.m4.2.2.2.2.2.3.cmml" xref="S2.SS3.p1.4.m4.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.2c">\ell_{t}(y_{t},\hat{y}_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.4.m4.2d">roman_ℓ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.
In online learning it is uncommon to assume that the true sequence was generated by the same family of models as those learned by the learner. For this reason the metric of performance is taken to be regret.
Given a class of possible predictors, the goal is to minimize regret w.r.t. these predictors. For example, a linear predictor predicts according to the rule</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi_{M_{1:k},N_{1:l}}(u_{1:t},y_{1:t-1})=\sum_{i=1}^{k}M_{i}u_{t-i}+\sum_{j=1}%
^{l}N_{j}y_{t-j}." class="ltx_Math" display="block" id="S2.Ex7.m1.3"><semantics id="S2.Ex7.m1.3a"><mrow id="S2.Ex7.m1.3.3.1" xref="S2.Ex7.m1.3.3.1.1.cmml"><mrow id="S2.Ex7.m1.3.3.1.1" xref="S2.Ex7.m1.3.3.1.1.cmml"><mrow id="S2.Ex7.m1.3.3.1.1.2" xref="S2.Ex7.m1.3.3.1.1.2.cmml"><msub id="S2.Ex7.m1.3.3.1.1.2.4" xref="S2.Ex7.m1.3.3.1.1.2.4.cmml"><mi id="S2.Ex7.m1.3.3.1.1.2.4.2" xref="S2.Ex7.m1.3.3.1.1.2.4.2.cmml">π</mi><mrow id="S2.Ex7.m1.2.2.2.2" xref="S2.Ex7.m1.2.2.2.3.cmml"><msub id="S2.Ex7.m1.1.1.1.1.1" xref="S2.Ex7.m1.1.1.1.1.1.cmml"><mi id="S2.Ex7.m1.1.1.1.1.1.2" xref="S2.Ex7.m1.1.1.1.1.1.2.cmml">M</mi><mrow id="S2.Ex7.m1.1.1.1.1.1.3" xref="S2.Ex7.m1.1.1.1.1.1.3.cmml"><mn id="S2.Ex7.m1.1.1.1.1.1.3.2" xref="S2.Ex7.m1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.Ex7.m1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex7.m1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.Ex7.m1.1.1.1.1.1.3.3" xref="S2.Ex7.m1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S2.Ex7.m1.2.2.2.2.3" xref="S2.Ex7.m1.2.2.2.3.cmml">,</mo><msub id="S2.Ex7.m1.2.2.2.2.2" xref="S2.Ex7.m1.2.2.2.2.2.cmml"><mi id="S2.Ex7.m1.2.2.2.2.2.2" xref="S2.Ex7.m1.2.2.2.2.2.2.cmml">N</mi><mrow id="S2.Ex7.m1.2.2.2.2.2.3" xref="S2.Ex7.m1.2.2.2.2.2.3.cmml"><mn id="S2.Ex7.m1.2.2.2.2.2.3.2" xref="S2.Ex7.m1.2.2.2.2.2.3.2.cmml">1</mn><mo id="S2.Ex7.m1.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex7.m1.2.2.2.2.2.3.1.cmml">:</mo><mi id="S2.Ex7.m1.2.2.2.2.2.3.3" xref="S2.Ex7.m1.2.2.2.2.2.3.3.cmml">l</mi></mrow></msub></mrow></msub><mo id="S2.Ex7.m1.3.3.1.1.2.3" xref="S2.Ex7.m1.3.3.1.1.2.3.cmml">⁢</mo><mrow id="S2.Ex7.m1.3.3.1.1.2.2.2" xref="S2.Ex7.m1.3.3.1.1.2.2.3.cmml"><mo id="S2.Ex7.m1.3.3.1.1.2.2.2.3" stretchy="false" xref="S2.Ex7.m1.3.3.1.1.2.2.3.cmml">(</mo><msub id="S2.Ex7.m1.3.3.1.1.1.1.1.1" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.Ex7.m1.3.3.1.1.1.1.1.1.2" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.2.cmml">u</mi><mrow id="S2.Ex7.m1.3.3.1.1.1.1.1.1.3" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.cmml"><mn id="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.3" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.Ex7.m1.3.3.1.1.2.2.2.4" xref="S2.Ex7.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S2.Ex7.m1.3.3.1.1.2.2.2.2" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S2.Ex7.m1.3.3.1.1.2.2.2.2.2" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.2.cmml">y</mi><mrow id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.cmml"><mn id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.2" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.2.cmml">1</mn><mo id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.1.cmml">:</mo><mrow id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.cmml"><mi id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.2" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.2.cmml">t</mi><mo id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.1" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.1.cmml">−</mo><mn id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.3" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.Ex7.m1.3.3.1.1.2.2.2.5" stretchy="false" xref="S2.Ex7.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex7.m1.3.3.1.1.3" rspace="0.111em" xref="S2.Ex7.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.Ex7.m1.3.3.1.1.4" xref="S2.Ex7.m1.3.3.1.1.4.cmml"><mrow id="S2.Ex7.m1.3.3.1.1.4.2" xref="S2.Ex7.m1.3.3.1.1.4.2.cmml"><munderover id="S2.Ex7.m1.3.3.1.1.4.2.1" xref="S2.Ex7.m1.3.3.1.1.4.2.1.cmml"><mo id="S2.Ex7.m1.3.3.1.1.4.2.1.2.2" movablelimits="false" xref="S2.Ex7.m1.3.3.1.1.4.2.1.2.2.cmml">∑</mo><mrow id="S2.Ex7.m1.3.3.1.1.4.2.1.2.3" xref="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.cmml"><mi id="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.2" xref="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.2.cmml">i</mi><mo id="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.1" xref="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.1.cmml">=</mo><mn id="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.3" xref="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex7.m1.3.3.1.1.4.2.1.3" xref="S2.Ex7.m1.3.3.1.1.4.2.1.3.cmml">k</mi></munderover><mrow id="S2.Ex7.m1.3.3.1.1.4.2.2" xref="S2.Ex7.m1.3.3.1.1.4.2.2.cmml"><msub id="S2.Ex7.m1.3.3.1.1.4.2.2.2" xref="S2.Ex7.m1.3.3.1.1.4.2.2.2.cmml"><mi id="S2.Ex7.m1.3.3.1.1.4.2.2.2.2" xref="S2.Ex7.m1.3.3.1.1.4.2.2.2.2.cmml">M</mi><mi id="S2.Ex7.m1.3.3.1.1.4.2.2.2.3" xref="S2.Ex7.m1.3.3.1.1.4.2.2.2.3.cmml">i</mi></msub><mo id="S2.Ex7.m1.3.3.1.1.4.2.2.1" xref="S2.Ex7.m1.3.3.1.1.4.2.2.1.cmml">⁢</mo><msub id="S2.Ex7.m1.3.3.1.1.4.2.2.3" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.cmml"><mi id="S2.Ex7.m1.3.3.1.1.4.2.2.3.2" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.2.cmml">u</mi><mrow id="S2.Ex7.m1.3.3.1.1.4.2.2.3.3" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.cmml"><mi id="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.2" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.2.cmml">t</mi><mo id="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.1" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.1.cmml">−</mo><mi id="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.3" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S2.Ex7.m1.3.3.1.1.4.1" rspace="0.055em" xref="S2.Ex7.m1.3.3.1.1.4.1.cmml">+</mo><mrow id="S2.Ex7.m1.3.3.1.1.4.3" xref="S2.Ex7.m1.3.3.1.1.4.3.cmml"><munderover id="S2.Ex7.m1.3.3.1.1.4.3.1" xref="S2.Ex7.m1.3.3.1.1.4.3.1.cmml"><mo id="S2.Ex7.m1.3.3.1.1.4.3.1.2.2" movablelimits="false" xref="S2.Ex7.m1.3.3.1.1.4.3.1.2.2.cmml">∑</mo><mrow id="S2.Ex7.m1.3.3.1.1.4.3.1.2.3" xref="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.cmml"><mi id="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.2" xref="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.2.cmml">j</mi><mo id="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.1" xref="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.1.cmml">=</mo><mn id="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.3" xref="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex7.m1.3.3.1.1.4.3.1.3" xref="S2.Ex7.m1.3.3.1.1.4.3.1.3.cmml">l</mi></munderover><mrow id="S2.Ex7.m1.3.3.1.1.4.3.2" xref="S2.Ex7.m1.3.3.1.1.4.3.2.cmml"><msub id="S2.Ex7.m1.3.3.1.1.4.3.2.2" xref="S2.Ex7.m1.3.3.1.1.4.3.2.2.cmml"><mi id="S2.Ex7.m1.3.3.1.1.4.3.2.2.2" xref="S2.Ex7.m1.3.3.1.1.4.3.2.2.2.cmml">N</mi><mi id="S2.Ex7.m1.3.3.1.1.4.3.2.2.3" xref="S2.Ex7.m1.3.3.1.1.4.3.2.2.3.cmml">j</mi></msub><mo id="S2.Ex7.m1.3.3.1.1.4.3.2.1" xref="S2.Ex7.m1.3.3.1.1.4.3.2.1.cmml">⁢</mo><msub id="S2.Ex7.m1.3.3.1.1.4.3.2.3" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.cmml"><mi id="S2.Ex7.m1.3.3.1.1.4.3.2.3.2" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.2.cmml">y</mi><mrow id="S2.Ex7.m1.3.3.1.1.4.3.2.3.3" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.cmml"><mi id="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.2" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.2.cmml">t</mi><mo id="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.1" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.1.cmml">−</mo><mi id="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.3" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow></mrow><mo id="S2.Ex7.m1.3.3.1.2" lspace="0em" xref="S2.Ex7.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex7.m1.3b"><apply id="S2.Ex7.m1.3.3.1.1.cmml" xref="S2.Ex7.m1.3.3.1"><eq id="S2.Ex7.m1.3.3.1.1.3.cmml" xref="S2.Ex7.m1.3.3.1.1.3"></eq><apply id="S2.Ex7.m1.3.3.1.1.2.cmml" xref="S2.Ex7.m1.3.3.1.1.2"><times id="S2.Ex7.m1.3.3.1.1.2.3.cmml" xref="S2.Ex7.m1.3.3.1.1.2.3"></times><apply id="S2.Ex7.m1.3.3.1.1.2.4.cmml" xref="S2.Ex7.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.2.4.1.cmml" xref="S2.Ex7.m1.3.3.1.1.2.4">subscript</csymbol><ci id="S2.Ex7.m1.3.3.1.1.2.4.2.cmml" xref="S2.Ex7.m1.3.3.1.1.2.4.2">𝜋</ci><list id="S2.Ex7.m1.2.2.2.3.cmml" xref="S2.Ex7.m1.2.2.2.2"><apply id="S2.Ex7.m1.1.1.1.1.1.cmml" xref="S2.Ex7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex7.m1.1.1.1.1.1.1.cmml" xref="S2.Ex7.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex7.m1.1.1.1.1.1.2.cmml" xref="S2.Ex7.m1.1.1.1.1.1.2">𝑀</ci><apply id="S2.Ex7.m1.1.1.1.1.1.3.cmml" xref="S2.Ex7.m1.1.1.1.1.1.3"><ci id="S2.Ex7.m1.1.1.1.1.1.3.1.cmml" xref="S2.Ex7.m1.1.1.1.1.1.3.1">:</ci><cn id="S2.Ex7.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.Ex7.m1.1.1.1.1.1.3.2">1</cn><ci id="S2.Ex7.m1.1.1.1.1.1.3.3.cmml" xref="S2.Ex7.m1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S2.Ex7.m1.2.2.2.2.2.cmml" xref="S2.Ex7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex7.m1.2.2.2.2.2.1.cmml" xref="S2.Ex7.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.Ex7.m1.2.2.2.2.2.2.cmml" xref="S2.Ex7.m1.2.2.2.2.2.2">𝑁</ci><apply id="S2.Ex7.m1.2.2.2.2.2.3.cmml" xref="S2.Ex7.m1.2.2.2.2.2.3"><ci id="S2.Ex7.m1.2.2.2.2.2.3.1.cmml" xref="S2.Ex7.m1.2.2.2.2.2.3.1">:</ci><cn id="S2.Ex7.m1.2.2.2.2.2.3.2.cmml" type="integer" xref="S2.Ex7.m1.2.2.2.2.2.3.2">1</cn><ci id="S2.Ex7.m1.2.2.2.2.2.3.3.cmml" xref="S2.Ex7.m1.2.2.2.2.2.3.3">𝑙</ci></apply></apply></list></apply><interval closure="open" id="S2.Ex7.m1.3.3.1.1.2.2.3.cmml" xref="S2.Ex7.m1.3.3.1.1.2.2.2"><apply id="S2.Ex7.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex7.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.2">𝑢</ci><apply id="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.3"><ci id="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.1">:</ci><cn id="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.2">1</cn><ci id="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex7.m1.3.3.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S2.Ex7.m1.3.3.1.1.2.2.2.2.cmml" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Ex7.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.2">𝑦</ci><apply id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3"><ci id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.1">:</ci><cn id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.2.cmml" type="integer" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.2">1</cn><apply id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.cmml" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3"><minus id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.1.cmml" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.1"></minus><ci id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.2.cmml" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.2">𝑡</ci><cn id="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.3.cmml" type="integer" xref="S2.Ex7.m1.3.3.1.1.2.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></apply><apply id="S2.Ex7.m1.3.3.1.1.4.cmml" xref="S2.Ex7.m1.3.3.1.1.4"><plus id="S2.Ex7.m1.3.3.1.1.4.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.1"></plus><apply id="S2.Ex7.m1.3.3.1.1.4.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2"><apply id="S2.Ex7.m1.3.3.1.1.4.2.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.1"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.4.2.1.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.1">superscript</csymbol><apply id="S2.Ex7.m1.3.3.1.1.4.2.1.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.1"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.4.2.1.2.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.1">subscript</csymbol><sum id="S2.Ex7.m1.3.3.1.1.4.2.1.2.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.1.2.2"></sum><apply id="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.1.2.3"><eq id="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.1"></eq><ci id="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.2">𝑖</ci><cn id="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.3.cmml" type="integer" xref="S2.Ex7.m1.3.3.1.1.4.2.1.2.3.3">1</cn></apply></apply><ci id="S2.Ex7.m1.3.3.1.1.4.2.1.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.1.3">𝑘</ci></apply><apply id="S2.Ex7.m1.3.3.1.1.4.2.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2"><times id="S2.Ex7.m1.3.3.1.1.4.2.2.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.1"></times><apply id="S2.Ex7.m1.3.3.1.1.4.2.2.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.4.2.2.2.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.2">subscript</csymbol><ci id="S2.Ex7.m1.3.3.1.1.4.2.2.2.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.2.2">𝑀</ci><ci id="S2.Ex7.m1.3.3.1.1.4.2.2.2.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.2.3">𝑖</ci></apply><apply id="S2.Ex7.m1.3.3.1.1.4.2.2.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.4.2.2.3.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3">subscript</csymbol><ci id="S2.Ex7.m1.3.3.1.1.4.2.2.3.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.2">𝑢</ci><apply id="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.3"><minus id="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.1"></minus><ci id="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.2">𝑡</ci><ci id="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.2.2.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.Ex7.m1.3.3.1.1.4.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3"><apply id="S2.Ex7.m1.3.3.1.1.4.3.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.1"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.4.3.1.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.1">superscript</csymbol><apply id="S2.Ex7.m1.3.3.1.1.4.3.1.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.1"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.4.3.1.2.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.1">subscript</csymbol><sum id="S2.Ex7.m1.3.3.1.1.4.3.1.2.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.1.2.2"></sum><apply id="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.1.2.3"><eq id="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.1"></eq><ci id="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.2">𝑗</ci><cn id="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.3.cmml" type="integer" xref="S2.Ex7.m1.3.3.1.1.4.3.1.2.3.3">1</cn></apply></apply><ci id="S2.Ex7.m1.3.3.1.1.4.3.1.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.1.3">𝑙</ci></apply><apply id="S2.Ex7.m1.3.3.1.1.4.3.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2"><times id="S2.Ex7.m1.3.3.1.1.4.3.2.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.1"></times><apply id="S2.Ex7.m1.3.3.1.1.4.3.2.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.2"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.4.3.2.2.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.2">subscript</csymbol><ci id="S2.Ex7.m1.3.3.1.1.4.3.2.2.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.2.2">𝑁</ci><ci id="S2.Ex7.m1.3.3.1.1.4.3.2.2.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.2.3">𝑗</ci></apply><apply id="S2.Ex7.m1.3.3.1.1.4.3.2.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3"><csymbol cd="ambiguous" id="S2.Ex7.m1.3.3.1.1.4.3.2.3.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3">subscript</csymbol><ci id="S2.Ex7.m1.3.3.1.1.4.3.2.3.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.2">𝑦</ci><apply id="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.3"><minus id="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.1.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.1"></minus><ci id="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.2.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.2">𝑡</ci><ci id="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.3.cmml" xref="S2.Ex7.m1.3.3.1.1.4.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex7.m1.3c">\pi_{M_{1:k},N_{1:l}}(u_{1:t},y_{1:t-1})=\sum_{i=1}^{k}M_{i}u_{t-i}+\sum_{j=1}%
^{l}N_{j}y_{t-j}.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex7.m1.3d">italic_π start_POSTSUBSCRIPT italic_M start_POSTSUBSCRIPT 1 : italic_k end_POSTSUBSCRIPT , italic_N start_POSTSUBSCRIPT 1 : italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_t - italic_i end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_t - italic_j end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p1.6">The performance of a prediction algorithm <math alttext="{\mathcal{A}}" class="ltx_Math" display="inline" id="S2.SS3.p1.5.m1.1"><semantics id="S2.SS3.p1.5.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.5.m1.1.1" xref="S2.SS3.p1.5.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m1.1b"><ci id="S2.SS3.p1.5.m1.1.1.cmml" xref="S2.SS3.p1.5.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m1.1c">{\mathcal{A}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.5.m1.1d">caligraphic_A</annotation></semantics></math> is measured by regret, or difference in total loss, vs. a class of predictors <math alttext="\prod" class="ltx_Math" display="inline" id="S2.SS3.p1.6.m2.1"><semantics id="S2.SS3.p1.6.m2.1a"><mo id="S2.SS3.p1.6.m2.1.1" xref="S2.SS3.p1.6.m2.1.1.cmml">∏</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m2.1b"><csymbol cd="latexml" id="S2.SS3.p1.6.m2.1.1.cmml" xref="S2.SS3.p1.6.m2.1.1">product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m2.1c">\prod</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.6.m2.1d">∏</annotation></semantics></math>, such as that of linear predictors, e.g.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mbox{{Regret}}_{T}({\mathcal{A}})=\sum_{t=1}^{T}\ell_{t}(y_{t},\hat{y}_{t}^{%
\mathcal{A}})-\min_{\pi\in\prod}\sum_{t=1}^{T}\ell_{t}(y_{t},\hat{y}_{t}^{\pi})." class="ltx_Math" display="block" id="S2.Ex8.m1.2"><semantics id="S2.Ex8.m1.2a"><mrow id="S2.Ex8.m1.2.2.1" xref="S2.Ex8.m1.2.2.1.1.cmml"><mrow id="S2.Ex8.m1.2.2.1.1" xref="S2.Ex8.m1.2.2.1.1.cmml"><mrow id="S2.Ex8.m1.2.2.1.1.6" xref="S2.Ex8.m1.2.2.1.1.6.cmml"><msub id="S2.Ex8.m1.2.2.1.1.6.2" xref="S2.Ex8.m1.2.2.1.1.6.2.cmml"><mtext id="S2.Ex8.m1.2.2.1.1.6.2.2" xref="S2.Ex8.m1.2.2.1.1.6.2.2a.cmml">Regret</mtext><mi id="S2.Ex8.m1.2.2.1.1.6.2.3" xref="S2.Ex8.m1.2.2.1.1.6.2.3.cmml">T</mi></msub><mo id="S2.Ex8.m1.2.2.1.1.6.1" xref="S2.Ex8.m1.2.2.1.1.6.1.cmml">⁢</mo><mrow id="S2.Ex8.m1.2.2.1.1.6.3.2" xref="S2.Ex8.m1.2.2.1.1.6.cmml"><mo id="S2.Ex8.m1.2.2.1.1.6.3.2.1" stretchy="false" xref="S2.Ex8.m1.2.2.1.1.6.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex8.m1.1.1" xref="S2.Ex8.m1.1.1.cmml">𝒜</mi><mo id="S2.Ex8.m1.2.2.1.1.6.3.2.2" stretchy="false" xref="S2.Ex8.m1.2.2.1.1.6.cmml">)</mo></mrow></mrow><mo id="S2.Ex8.m1.2.2.1.1.5" rspace="0.111em" xref="S2.Ex8.m1.2.2.1.1.5.cmml">=</mo><mrow id="S2.Ex8.m1.2.2.1.1.4" xref="S2.Ex8.m1.2.2.1.1.4.cmml"><mrow id="S2.Ex8.m1.2.2.1.1.2.2" xref="S2.Ex8.m1.2.2.1.1.2.2.cmml"><munderover id="S2.Ex8.m1.2.2.1.1.2.2.3" xref="S2.Ex8.m1.2.2.1.1.2.2.3.cmml"><mo id="S2.Ex8.m1.2.2.1.1.2.2.3.2.2" movablelimits="false" xref="S2.Ex8.m1.2.2.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S2.Ex8.m1.2.2.1.1.2.2.3.2.3" xref="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.cmml"><mi id="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.2" xref="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.2.cmml">t</mi><mo id="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.1" xref="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.3" xref="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex8.m1.2.2.1.1.2.2.3.3" xref="S2.Ex8.m1.2.2.1.1.2.2.3.3.cmml">T</mi></munderover><mrow id="S2.Ex8.m1.2.2.1.1.2.2.2" xref="S2.Ex8.m1.2.2.1.1.2.2.2.cmml"><msub id="S2.Ex8.m1.2.2.1.1.2.2.2.4" xref="S2.Ex8.m1.2.2.1.1.2.2.2.4.cmml"><mi id="S2.Ex8.m1.2.2.1.1.2.2.2.4.2" mathvariant="normal" xref="S2.Ex8.m1.2.2.1.1.2.2.2.4.2.cmml">ℓ</mi><mi id="S2.Ex8.m1.2.2.1.1.2.2.2.4.3" xref="S2.Ex8.m1.2.2.1.1.2.2.2.4.3.cmml">t</mi></msub><mo id="S2.Ex8.m1.2.2.1.1.2.2.2.3" xref="S2.Ex8.m1.2.2.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.3.cmml"><mo id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.3" stretchy="false" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.3.cmml">(</mo><msub id="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.4" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.3.cmml">,</mo><msubsup id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.cmml"><mover accent="true" id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2.cmml"><mi id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2.2" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.cmml">y</mi><mo id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2.1" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.3" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml">t</mi><mi class="ltx_font_mathcaligraphic" id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.3" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">𝒜</mi></msubsup><mo id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.5" stretchy="false" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex8.m1.2.2.1.1.4.5" xref="S2.Ex8.m1.2.2.1.1.4.5.cmml">−</mo><mrow id="S2.Ex8.m1.2.2.1.1.4.4" xref="S2.Ex8.m1.2.2.1.1.4.4.cmml"><munder id="S2.Ex8.m1.2.2.1.1.4.4.4" xref="S2.Ex8.m1.2.2.1.1.4.4.4.cmml"><mi id="S2.Ex8.m1.2.2.1.1.4.4.4.2" xref="S2.Ex8.m1.2.2.1.1.4.4.4.2.cmml">min</mi><mrow id="S2.Ex8.m1.2.2.1.1.4.4.4.3" xref="S2.Ex8.m1.2.2.1.1.4.4.4.3.cmml"><mi id="S2.Ex8.m1.2.2.1.1.4.4.4.3.2" xref="S2.Ex8.m1.2.2.1.1.4.4.4.3.2.cmml">π</mi><mo id="S2.Ex8.m1.2.2.1.1.4.4.4.3.1" xref="S2.Ex8.m1.2.2.1.1.4.4.4.3.1.cmml">∈</mo><mstyle id="S2.Ex8.m1.2.2.1.1.4.4.4.3.3" scriptlevel="-1" xref="S2.Ex8.m1.2.2.1.1.4.4.4.3.3.cmml"><mo id="S2.Ex8.m1.2.2.1.1.4.4.4.3.3a" xref="S2.Ex8.m1.2.2.1.1.4.4.4.3.3.cmml">∏</mo></mstyle></mrow></munder><mo id="S2.Ex8.m1.2.2.1.1.4.4.3" xref="S2.Ex8.m1.2.2.1.1.4.4.3.cmml">⁢</mo><mrow id="S2.Ex8.m1.2.2.1.1.4.4.2" xref="S2.Ex8.m1.2.2.1.1.4.4.2.cmml"><munderover id="S2.Ex8.m1.2.2.1.1.4.4.2.3" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.cmml"><mo id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.2" movablelimits="false" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.2.cmml">∑</mo><mrow id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.cmml"><mi id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.2" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.2.cmml">t</mi><mo id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.1" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.1.cmml">=</mo><mn id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.3" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex8.m1.2.2.1.1.4.4.2.3.3" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.3.cmml">T</mi></munderover><mrow id="S2.Ex8.m1.2.2.1.1.4.4.2.2" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.cmml"><msub id="S2.Ex8.m1.2.2.1.1.4.4.2.2.4" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.cmml"><mi id="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.2" mathvariant="normal" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.2.cmml">ℓ</mi><mi id="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.3" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.3.cmml">t</mi></msub><mo id="S2.Ex8.m1.2.2.1.1.4.4.2.2.3" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.3.cmml">⁢</mo><mrow id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.3.cmml"><mo id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.3" stretchy="false" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.3.cmml">(</mo><msub id="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1" xref="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.cmml"><mi id="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.2" xref="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.2.cmml">y</mi><mi id="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.3" xref="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.4" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.3.cmml">,</mo><msubsup id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.cmml"><mover accent="true" id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2.cmml"><mi id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2.2" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2.2.cmml">y</mi><mo id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2.1" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.3" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.3.cmml">t</mi><mi id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.3" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.3.cmml">π</mi></msubsup><mo id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.5" stretchy="false" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S2.Ex8.m1.2.2.1.2" lspace="0em" xref="S2.Ex8.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex8.m1.2b"><apply id="S2.Ex8.m1.2.2.1.1.cmml" xref="S2.Ex8.m1.2.2.1"><eq id="S2.Ex8.m1.2.2.1.1.5.cmml" xref="S2.Ex8.m1.2.2.1.1.5"></eq><apply id="S2.Ex8.m1.2.2.1.1.6.cmml" xref="S2.Ex8.m1.2.2.1.1.6"><times id="S2.Ex8.m1.2.2.1.1.6.1.cmml" xref="S2.Ex8.m1.2.2.1.1.6.1"></times><apply id="S2.Ex8.m1.2.2.1.1.6.2.cmml" xref="S2.Ex8.m1.2.2.1.1.6.2"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.6.2.1.cmml" xref="S2.Ex8.m1.2.2.1.1.6.2">subscript</csymbol><ci id="S2.Ex8.m1.2.2.1.1.6.2.2a.cmml" xref="S2.Ex8.m1.2.2.1.1.6.2.2"><mtext id="S2.Ex8.m1.2.2.1.1.6.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.6.2.2">Regret</mtext></ci><ci id="S2.Ex8.m1.2.2.1.1.6.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.6.2.3">𝑇</ci></apply><ci id="S2.Ex8.m1.1.1.cmml" xref="S2.Ex8.m1.1.1">𝒜</ci></apply><apply id="S2.Ex8.m1.2.2.1.1.4.cmml" xref="S2.Ex8.m1.2.2.1.1.4"><minus id="S2.Ex8.m1.2.2.1.1.4.5.cmml" xref="S2.Ex8.m1.2.2.1.1.4.5"></minus><apply id="S2.Ex8.m1.2.2.1.1.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2"><apply id="S2.Ex8.m1.2.2.1.1.2.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.2.2.3.1.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.3">superscript</csymbol><apply id="S2.Ex8.m1.2.2.1.1.2.2.3.2.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.2.2.3.2.1.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.3">subscript</csymbol><sum id="S2.Ex8.m1.2.2.1.1.2.2.3.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.3.2.2"></sum><apply id="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.3.2.3"><eq id="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.1.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.1"></eq><ci id="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.2.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.2">𝑡</ci><cn id="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S2.Ex8.m1.2.2.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.Ex8.m1.2.2.1.1.2.2.3.3.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.3.3">𝑇</ci></apply><apply id="S2.Ex8.m1.2.2.1.1.2.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2"><times id="S2.Ex8.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.3"></times><apply id="S2.Ex8.m1.2.2.1.1.2.2.2.4.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.2.2.2.4.1.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.4">subscript</csymbol><ci id="S2.Ex8.m1.2.2.1.1.2.2.2.4.2.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.4.2">ℓ</ci><ci id="S2.Ex8.m1.2.2.1.1.2.2.2.4.3.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S2.Ex8.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2"><apply id="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2">superscript</csymbol><apply id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2">subscript</csymbol><apply id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2"><ci id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2.1">^</ci><ci id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.2.2.2.2.2.2.3">𝒜</ci></apply></interval></apply></apply><apply id="S2.Ex8.m1.2.2.1.1.4.4.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4"><times id="S2.Ex8.m1.2.2.1.1.4.4.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.3"></times><apply id="S2.Ex8.m1.2.2.1.1.4.4.4.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.4"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.4.4.4.1.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.4">subscript</csymbol><min id="S2.Ex8.m1.2.2.1.1.4.4.4.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.4.2"></min><apply id="S2.Ex8.m1.2.2.1.1.4.4.4.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.4.3"><in id="S2.Ex8.m1.2.2.1.1.4.4.4.3.1.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.4.3.1"></in><ci id="S2.Ex8.m1.2.2.1.1.4.4.4.3.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.4.3.2">𝜋</ci><csymbol cd="latexml" id="S2.Ex8.m1.2.2.1.1.4.4.4.3.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.4.3.3">product</csymbol></apply></apply><apply id="S2.Ex8.m1.2.2.1.1.4.4.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2"><apply id="S2.Ex8.m1.2.2.1.1.4.4.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.4.4.2.3.1.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3">superscript</csymbol><apply id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.1.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3">subscript</csymbol><sum id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.2"></sum><apply id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3"><eq id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.1.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.1"></eq><ci id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.2">𝑡</ci><cn id="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.3.cmml" type="integer" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.2.3.3">1</cn></apply></apply><ci id="S2.Ex8.m1.2.2.1.1.4.4.2.3.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.3.3">𝑇</ci></apply><apply id="S2.Ex8.m1.2.2.1.1.4.4.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2"><times id="S2.Ex8.m1.2.2.1.1.4.4.2.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.3"></times><apply id="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.4"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.1.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.4">subscript</csymbol><ci id="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.2">ℓ</ci><ci id="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2"><apply id="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.cmml" xref="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.1.cmml" xref="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.2.cmml" xref="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.2">𝑦</ci><ci id="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.3.cmml" xref="S2.Ex8.m1.2.2.1.1.3.3.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.1.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2">superscript</csymbol><apply id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.1.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2">subscript</csymbol><apply id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2"><ci id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2.1.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2.1">^</ci><ci id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2.2.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.3.cmml" xref="S2.Ex8.m1.2.2.1.1.4.4.2.2.2.2.2.3">𝜋</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex8.m1.2c">\mbox{{Regret}}_{T}({\mathcal{A}})=\sum_{t=1}^{T}\ell_{t}(y_{t},\hat{y}_{t}^{%
\mathcal{A}})-\min_{\pi\in\prod}\sum_{t=1}^{T}\ell_{t}(y_{t},\hat{y}_{t}^{\pi}).</annotation><annotation encoding="application/x-llamapun" id="S2.Ex8.m1.2d">Regret start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ( caligraphic_A ) = ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_ℓ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT ) - roman_min start_POSTSUBSCRIPT italic_π ∈ ∏ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_ℓ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.7">This formulation is valid for online sequence prediction of any signal.
We are particularly interested in signal that are generated by dynamical systems.
A time-invariant linear dynamical system is given by the dynamics equations</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="x_{t+1}=Ax_{t}+Bu_{t}+w_{t}\ \ ,\ \ y_{t}=Cx_{t}+Du_{t}+\zeta_{t}," class="ltx_math_unparsed" display="block" id="S2.Ex9.m1.1"><semantics id="S2.Ex9.m1.1a"><mrow id="S2.Ex9.m1.1b"><msub id="S2.Ex9.m1.1.1"><mi id="S2.Ex9.m1.1.1.2">x</mi><mrow id="S2.Ex9.m1.1.1.3"><mi id="S2.Ex9.m1.1.1.3.2">t</mi><mo id="S2.Ex9.m1.1.1.3.1">+</mo><mn id="S2.Ex9.m1.1.1.3.3">1</mn></mrow></msub><mo id="S2.Ex9.m1.1.2">=</mo><mi id="S2.Ex9.m1.1.3">A</mi><msub id="S2.Ex9.m1.1.4"><mi id="S2.Ex9.m1.1.4.2">x</mi><mi id="S2.Ex9.m1.1.4.3">t</mi></msub><mo id="S2.Ex9.m1.1.5">+</mo><mi id="S2.Ex9.m1.1.6">B</mi><msub id="S2.Ex9.m1.1.7"><mi id="S2.Ex9.m1.1.7.2">u</mi><mi id="S2.Ex9.m1.1.7.3">t</mi></msub><mo id="S2.Ex9.m1.1.8">+</mo><msub id="S2.Ex9.m1.1.9"><mi id="S2.Ex9.m1.1.9.2">w</mi><mi id="S2.Ex9.m1.1.9.3">t</mi></msub><mspace id="S2.Ex9.m1.1.10" width="1em"></mspace><mo id="S2.Ex9.m1.1.11" rspace="1.167em">,</mo><msub id="S2.Ex9.m1.1.12"><mi id="S2.Ex9.m1.1.12.2">y</mi><mi id="S2.Ex9.m1.1.12.3">t</mi></msub><mo id="S2.Ex9.m1.1.13">=</mo><mi id="S2.Ex9.m1.1.14">C</mi><msub id="S2.Ex9.m1.1.15"><mi id="S2.Ex9.m1.1.15.2">x</mi><mi id="S2.Ex9.m1.1.15.3">t</mi></msub><mo id="S2.Ex9.m1.1.16">+</mo><mi id="S2.Ex9.m1.1.17">D</mi><msub id="S2.Ex9.m1.1.18"><mi id="S2.Ex9.m1.1.18.2">u</mi><mi id="S2.Ex9.m1.1.18.3">t</mi></msub><mo id="S2.Ex9.m1.1.19">+</mo><msub id="S2.Ex9.m1.1.20"><mi id="S2.Ex9.m1.1.20.2">ζ</mi><mi id="S2.Ex9.m1.1.20.3">t</mi></msub><mo id="S2.Ex9.m1.1.21">,</mo></mrow><annotation encoding="application/x-tex" id="S2.Ex9.m1.1c">x_{t+1}=Ax_{t}+Bu_{t}+w_{t}\ \ ,\ \ y_{t}=Cx_{t}+Du_{t}+\zeta_{t},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex9.m1.1d">italic_x start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = italic_A italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_B italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_C italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_D italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_ζ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p2.6">where <math alttext="x_{t}" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><msub id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">x</mi><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">𝑥</ci><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the (hidden) state, <math alttext="u_{t}" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><msub id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mi id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2.cmml">u</mi><mi id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2">𝑢</ci><ci id="S2.SS3.p2.2.m2.1.1.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">u_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the input or control to the system, and <math alttext="y_{t}" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.1"><semantics id="S2.SS3.p2.3.m3.1a"><msub id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml">y</mi><mi id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2">𝑦</ci><ci id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the observation. The terms <math alttext="w_{t},\zeta_{t}" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m4.2"><semantics id="S2.SS3.p2.4.m4.2a"><mrow id="S2.SS3.p2.4.m4.2.2.2" xref="S2.SS3.p2.4.m4.2.2.3.cmml"><msub id="S2.SS3.p2.4.m4.1.1.1.1" xref="S2.SS3.p2.4.m4.1.1.1.1.cmml"><mi id="S2.SS3.p2.4.m4.1.1.1.1.2" xref="S2.SS3.p2.4.m4.1.1.1.1.2.cmml">w</mi><mi id="S2.SS3.p2.4.m4.1.1.1.1.3" xref="S2.SS3.p2.4.m4.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS3.p2.4.m4.2.2.2.3" xref="S2.SS3.p2.4.m4.2.2.3.cmml">,</mo><msub id="S2.SS3.p2.4.m4.2.2.2.2" xref="S2.SS3.p2.4.m4.2.2.2.2.cmml"><mi id="S2.SS3.p2.4.m4.2.2.2.2.2" xref="S2.SS3.p2.4.m4.2.2.2.2.2.cmml">ζ</mi><mi id="S2.SS3.p2.4.m4.2.2.2.2.3" xref="S2.SS3.p2.4.m4.2.2.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.2b"><list id="S2.SS3.p2.4.m4.2.2.3.cmml" xref="S2.SS3.p2.4.m4.2.2.2"><apply id="S2.SS3.p2.4.m4.1.1.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.1.1.1.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.4.m4.1.1.1.1.2.cmml" xref="S2.SS3.p2.4.m4.1.1.1.1.2">𝑤</ci><ci id="S2.SS3.p2.4.m4.1.1.1.1.3.cmml" xref="S2.SS3.p2.4.m4.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS3.p2.4.m4.2.2.2.2.cmml" xref="S2.SS3.p2.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.2.2.2.2.1.cmml" xref="S2.SS3.p2.4.m4.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p2.4.m4.2.2.2.2.2.cmml" xref="S2.SS3.p2.4.m4.2.2.2.2.2">𝜁</ci><ci id="S2.SS3.p2.4.m4.2.2.2.2.3.cmml" xref="S2.SS3.p2.4.m4.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.2c">w_{t},\zeta_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m4.2d">italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_ζ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are noise terms, and the matrices <math alttext="A,B,C,D" class="ltx_Math" display="inline" id="S2.SS3.p2.5.m5.4"><semantics id="S2.SS3.p2.5.m5.4a"><mrow id="S2.SS3.p2.5.m5.4.5.2" xref="S2.SS3.p2.5.m5.4.5.1.cmml"><mi id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml">A</mi><mo id="S2.SS3.p2.5.m5.4.5.2.1" xref="S2.SS3.p2.5.m5.4.5.1.cmml">,</mo><mi id="S2.SS3.p2.5.m5.2.2" xref="S2.SS3.p2.5.m5.2.2.cmml">B</mi><mo id="S2.SS3.p2.5.m5.4.5.2.2" xref="S2.SS3.p2.5.m5.4.5.1.cmml">,</mo><mi id="S2.SS3.p2.5.m5.3.3" xref="S2.SS3.p2.5.m5.3.3.cmml">C</mi><mo id="S2.SS3.p2.5.m5.4.5.2.3" xref="S2.SS3.p2.5.m5.4.5.1.cmml">,</mo><mi id="S2.SS3.p2.5.m5.4.4" xref="S2.SS3.p2.5.m5.4.4.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.4b"><list id="S2.SS3.p2.5.m5.4.5.1.cmml" xref="S2.SS3.p2.5.m5.4.5.2"><ci id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">𝐴</ci><ci id="S2.SS3.p2.5.m5.2.2.cmml" xref="S2.SS3.p2.5.m5.2.2">𝐵</ci><ci id="S2.SS3.p2.5.m5.3.3.cmml" xref="S2.SS3.p2.5.m5.3.3">𝐶</ci><ci id="S2.SS3.p2.5.m5.4.4.cmml" xref="S2.SS3.p2.5.m5.4.4">𝐷</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.4c">A,B,C,D</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.5.m5.4d">italic_A , italic_B , italic_C , italic_D</annotation></semantics></math> are called the system matrices.
A linear dynamical predictor with parameters <math alttext="A,B,C,D" class="ltx_Math" display="inline" id="S2.SS3.p2.6.m6.4"><semantics id="S2.SS3.p2.6.m6.4a"><mrow id="S2.SS3.p2.6.m6.4.5.2" xref="S2.SS3.p2.6.m6.4.5.1.cmml"><mi id="S2.SS3.p2.6.m6.1.1" xref="S2.SS3.p2.6.m6.1.1.cmml">A</mi><mo id="S2.SS3.p2.6.m6.4.5.2.1" xref="S2.SS3.p2.6.m6.4.5.1.cmml">,</mo><mi id="S2.SS3.p2.6.m6.2.2" xref="S2.SS3.p2.6.m6.2.2.cmml">B</mi><mo id="S2.SS3.p2.6.m6.4.5.2.2" xref="S2.SS3.p2.6.m6.4.5.1.cmml">,</mo><mi id="S2.SS3.p2.6.m6.3.3" xref="S2.SS3.p2.6.m6.3.3.cmml">C</mi><mo id="S2.SS3.p2.6.m6.4.5.2.3" xref="S2.SS3.p2.6.m6.4.5.1.cmml">,</mo><mi id="S2.SS3.p2.6.m6.4.4" xref="S2.SS3.p2.6.m6.4.4.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.4b"><list id="S2.SS3.p2.6.m6.4.5.1.cmml" xref="S2.SS3.p2.6.m6.4.5.2"><ci id="S2.SS3.p2.6.m6.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1">𝐴</ci><ci id="S2.SS3.p2.6.m6.2.2.cmml" xref="S2.SS3.p2.6.m6.2.2">𝐵</ci><ci id="S2.SS3.p2.6.m6.3.3.cmml" xref="S2.SS3.p2.6.m6.3.3">𝐶</ci><ci id="S2.SS3.p2.6.m6.4.4.cmml" xref="S2.SS3.p2.6.m6.4.4">𝐷</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.4c">A,B,C,D</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.6.m6.4d">italic_A , italic_B , italic_C , italic_D</annotation></semantics></math> predicts according to</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi_{ABCD}(u_{1:t},y_{1:t-1})=\sum_{i=1}^{t-1}CA^{i-1}Bu_{t-i}+Du_{t}." class="ltx_Math" display="block" id="S2.Ex10.m1.1"><semantics id="S2.Ex10.m1.1a"><mrow id="S2.Ex10.m1.1.1.1" xref="S2.Ex10.m1.1.1.1.1.cmml"><mrow id="S2.Ex10.m1.1.1.1.1" xref="S2.Ex10.m1.1.1.1.1.cmml"><mrow id="S2.Ex10.m1.1.1.1.1.2" xref="S2.Ex10.m1.1.1.1.1.2.cmml"><msub id="S2.Ex10.m1.1.1.1.1.2.4" xref="S2.Ex10.m1.1.1.1.1.2.4.cmml"><mi id="S2.Ex10.m1.1.1.1.1.2.4.2" xref="S2.Ex10.m1.1.1.1.1.2.4.2.cmml">π</mi><mrow id="S2.Ex10.m1.1.1.1.1.2.4.3" xref="S2.Ex10.m1.1.1.1.1.2.4.3.cmml"><mi id="S2.Ex10.m1.1.1.1.1.2.4.3.2" xref="S2.Ex10.m1.1.1.1.1.2.4.3.2.cmml">A</mi><mo id="S2.Ex10.m1.1.1.1.1.2.4.3.1" xref="S2.Ex10.m1.1.1.1.1.2.4.3.1.cmml">⁢</mo><mi id="S2.Ex10.m1.1.1.1.1.2.4.3.3" xref="S2.Ex10.m1.1.1.1.1.2.4.3.3.cmml">B</mi><mo id="S2.Ex10.m1.1.1.1.1.2.4.3.1a" xref="S2.Ex10.m1.1.1.1.1.2.4.3.1.cmml">⁢</mo><mi id="S2.Ex10.m1.1.1.1.1.2.4.3.4" xref="S2.Ex10.m1.1.1.1.1.2.4.3.4.cmml">C</mi><mo id="S2.Ex10.m1.1.1.1.1.2.4.3.1b" xref="S2.Ex10.m1.1.1.1.1.2.4.3.1.cmml">⁢</mo><mi id="S2.Ex10.m1.1.1.1.1.2.4.3.5" xref="S2.Ex10.m1.1.1.1.1.2.4.3.5.cmml">D</mi></mrow></msub><mo id="S2.Ex10.m1.1.1.1.1.2.3" xref="S2.Ex10.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.Ex10.m1.1.1.1.1.2.2.2" xref="S2.Ex10.m1.1.1.1.1.2.2.3.cmml"><mo id="S2.Ex10.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.Ex10.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.Ex10.m1.1.1.1.1.1.1.1.1" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex10.m1.1.1.1.1.1.1.1.1.2" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.2.cmml">u</mi><mrow id="S2.Ex10.m1.1.1.1.1.1.1.1.1.3" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.Ex10.m1.1.1.1.1.2.2.2.4" xref="S2.Ex10.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.Ex10.m1.1.1.1.1.2.2.2.2" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.Ex10.m1.1.1.1.1.2.2.2.2.2" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mrow id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.cmml"><mn id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.2" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.2.cmml">1</mn><mo id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.1.cmml">:</mo><mrow id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.2" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.2.cmml">t</mi><mo id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.1" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.1.cmml">−</mo><mn id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.3" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.Ex10.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.Ex10.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex10.m1.1.1.1.1.3" rspace="0.111em" xref="S2.Ex10.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.Ex10.m1.1.1.1.1.4" xref="S2.Ex10.m1.1.1.1.1.4.cmml"><mrow id="S2.Ex10.m1.1.1.1.1.4.2" xref="S2.Ex10.m1.1.1.1.1.4.2.cmml"><munderover id="S2.Ex10.m1.1.1.1.1.4.2.1" xref="S2.Ex10.m1.1.1.1.1.4.2.1.cmml"><mo id="S2.Ex10.m1.1.1.1.1.4.2.1.2.2" movablelimits="false" xref="S2.Ex10.m1.1.1.1.1.4.2.1.2.2.cmml">∑</mo><mrow id="S2.Ex10.m1.1.1.1.1.4.2.1.2.3" xref="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.cmml"><mi id="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.2" xref="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.2.cmml">i</mi><mo id="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.1" xref="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.1.cmml">=</mo><mn id="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.3" xref="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S2.Ex10.m1.1.1.1.1.4.2.1.3" xref="S2.Ex10.m1.1.1.1.1.4.2.1.3.cmml"><mi id="S2.Ex10.m1.1.1.1.1.4.2.1.3.2" xref="S2.Ex10.m1.1.1.1.1.4.2.1.3.2.cmml">t</mi><mo id="S2.Ex10.m1.1.1.1.1.4.2.1.3.1" xref="S2.Ex10.m1.1.1.1.1.4.2.1.3.1.cmml">−</mo><mn id="S2.Ex10.m1.1.1.1.1.4.2.1.3.3" xref="S2.Ex10.m1.1.1.1.1.4.2.1.3.3.cmml">1</mn></mrow></munderover><mrow id="S2.Ex10.m1.1.1.1.1.4.2.2" xref="S2.Ex10.m1.1.1.1.1.4.2.2.cmml"><mi id="S2.Ex10.m1.1.1.1.1.4.2.2.2" xref="S2.Ex10.m1.1.1.1.1.4.2.2.2.cmml">C</mi><mo id="S2.Ex10.m1.1.1.1.1.4.2.2.1" xref="S2.Ex10.m1.1.1.1.1.4.2.2.1.cmml">⁢</mo><msup id="S2.Ex10.m1.1.1.1.1.4.2.2.3" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.cmml"><mi id="S2.Ex10.m1.1.1.1.1.4.2.2.3.2" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.2.cmml">A</mi><mrow id="S2.Ex10.m1.1.1.1.1.4.2.2.3.3" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.cmml"><mi id="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.2" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.2.cmml">i</mi><mo id="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.1" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.1.cmml">−</mo><mn id="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.3" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.3.cmml">1</mn></mrow></msup><mo id="S2.Ex10.m1.1.1.1.1.4.2.2.1a" xref="S2.Ex10.m1.1.1.1.1.4.2.2.1.cmml">⁢</mo><mi id="S2.Ex10.m1.1.1.1.1.4.2.2.4" xref="S2.Ex10.m1.1.1.1.1.4.2.2.4.cmml">B</mi><mo id="S2.Ex10.m1.1.1.1.1.4.2.2.1b" xref="S2.Ex10.m1.1.1.1.1.4.2.2.1.cmml">⁢</mo><msub id="S2.Ex10.m1.1.1.1.1.4.2.2.5" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.cmml"><mi id="S2.Ex10.m1.1.1.1.1.4.2.2.5.2" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.2.cmml">u</mi><mrow id="S2.Ex10.m1.1.1.1.1.4.2.2.5.3" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.cmml"><mi id="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.2" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.2.cmml">t</mi><mo id="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.1" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.1.cmml">−</mo><mi id="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.3" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S2.Ex10.m1.1.1.1.1.4.1" xref="S2.Ex10.m1.1.1.1.1.4.1.cmml">+</mo><mrow id="S2.Ex10.m1.1.1.1.1.4.3" xref="S2.Ex10.m1.1.1.1.1.4.3.cmml"><mi id="S2.Ex10.m1.1.1.1.1.4.3.2" xref="S2.Ex10.m1.1.1.1.1.4.3.2.cmml">D</mi><mo id="S2.Ex10.m1.1.1.1.1.4.3.1" xref="S2.Ex10.m1.1.1.1.1.4.3.1.cmml">⁢</mo><msub id="S2.Ex10.m1.1.1.1.1.4.3.3" xref="S2.Ex10.m1.1.1.1.1.4.3.3.cmml"><mi id="S2.Ex10.m1.1.1.1.1.4.3.3.2" xref="S2.Ex10.m1.1.1.1.1.4.3.3.2.cmml">u</mi><mi id="S2.Ex10.m1.1.1.1.1.4.3.3.3" xref="S2.Ex10.m1.1.1.1.1.4.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><mo id="S2.Ex10.m1.1.1.1.2" lspace="0em" xref="S2.Ex10.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex10.m1.1b"><apply id="S2.Ex10.m1.1.1.1.1.cmml" xref="S2.Ex10.m1.1.1.1"><eq id="S2.Ex10.m1.1.1.1.1.3.cmml" xref="S2.Ex10.m1.1.1.1.1.3"></eq><apply id="S2.Ex10.m1.1.1.1.1.2.cmml" xref="S2.Ex10.m1.1.1.1.1.2"><times id="S2.Ex10.m1.1.1.1.1.2.3.cmml" xref="S2.Ex10.m1.1.1.1.1.2.3"></times><apply id="S2.Ex10.m1.1.1.1.1.2.4.cmml" xref="S2.Ex10.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.Ex10.m1.1.1.1.1.2.4.1.cmml" xref="S2.Ex10.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.Ex10.m1.1.1.1.1.2.4.2.cmml" xref="S2.Ex10.m1.1.1.1.1.2.4.2">𝜋</ci><apply id="S2.Ex10.m1.1.1.1.1.2.4.3.cmml" xref="S2.Ex10.m1.1.1.1.1.2.4.3"><times id="S2.Ex10.m1.1.1.1.1.2.4.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.2.4.3.1"></times><ci id="S2.Ex10.m1.1.1.1.1.2.4.3.2.cmml" xref="S2.Ex10.m1.1.1.1.1.2.4.3.2">𝐴</ci><ci id="S2.Ex10.m1.1.1.1.1.2.4.3.3.cmml" xref="S2.Ex10.m1.1.1.1.1.2.4.3.3">𝐵</ci><ci id="S2.Ex10.m1.1.1.1.1.2.4.3.4.cmml" xref="S2.Ex10.m1.1.1.1.1.2.4.3.4">𝐶</ci><ci id="S2.Ex10.m1.1.1.1.1.2.4.3.5.cmml" xref="S2.Ex10.m1.1.1.1.1.2.4.3.5">𝐷</ci></apply></apply><interval closure="open" id="S2.Ex10.m1.1.1.1.1.2.2.3.cmml" xref="S2.Ex10.m1.1.1.1.1.2.2.2"><apply id="S2.Ex10.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.2">𝑢</ci><apply id="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.3"><ci id="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S2.Ex10.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex10.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Ex10.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.2">𝑦</ci><apply id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3"><ci id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.1">:</ci><cn id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.2.cmml" type="integer" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.2">1</cn><apply id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3"><minus id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.1"></minus><ci id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.2">𝑡</ci><cn id="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.3.cmml" type="integer" xref="S2.Ex10.m1.1.1.1.1.2.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></apply><apply id="S2.Ex10.m1.1.1.1.1.4.cmml" xref="S2.Ex10.m1.1.1.1.1.4"><plus id="S2.Ex10.m1.1.1.1.1.4.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.1"></plus><apply id="S2.Ex10.m1.1.1.1.1.4.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2"><apply id="S2.Ex10.m1.1.1.1.1.4.2.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1"><csymbol cd="ambiguous" id="S2.Ex10.m1.1.1.1.1.4.2.1.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1">superscript</csymbol><apply id="S2.Ex10.m1.1.1.1.1.4.2.1.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1"><csymbol cd="ambiguous" id="S2.Ex10.m1.1.1.1.1.4.2.1.2.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1">subscript</csymbol><sum id="S2.Ex10.m1.1.1.1.1.4.2.1.2.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1.2.2"></sum><apply id="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1.2.3"><eq id="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.1"></eq><ci id="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.2">𝑖</ci><cn id="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.3.cmml" type="integer" xref="S2.Ex10.m1.1.1.1.1.4.2.1.2.3.3">1</cn></apply></apply><apply id="S2.Ex10.m1.1.1.1.1.4.2.1.3.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1.3"><minus id="S2.Ex10.m1.1.1.1.1.4.2.1.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1.3.1"></minus><ci id="S2.Ex10.m1.1.1.1.1.4.2.1.3.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.1.3.2">𝑡</ci><cn id="S2.Ex10.m1.1.1.1.1.4.2.1.3.3.cmml" type="integer" xref="S2.Ex10.m1.1.1.1.1.4.2.1.3.3">1</cn></apply></apply><apply id="S2.Ex10.m1.1.1.1.1.4.2.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2"><times id="S2.Ex10.m1.1.1.1.1.4.2.2.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.1"></times><ci id="S2.Ex10.m1.1.1.1.1.4.2.2.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.2">𝐶</ci><apply id="S2.Ex10.m1.1.1.1.1.4.2.2.3.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.1.1.1.1.4.2.2.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3">superscript</csymbol><ci id="S2.Ex10.m1.1.1.1.1.4.2.2.3.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.2">𝐴</ci><apply id="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.3"><minus id="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.1"></minus><ci id="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.2">𝑖</ci><cn id="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.3.cmml" type="integer" xref="S2.Ex10.m1.1.1.1.1.4.2.2.3.3.3">1</cn></apply></apply><ci id="S2.Ex10.m1.1.1.1.1.4.2.2.4.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.4">𝐵</ci><apply id="S2.Ex10.m1.1.1.1.1.4.2.2.5.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5"><csymbol cd="ambiguous" id="S2.Ex10.m1.1.1.1.1.4.2.2.5.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5">subscript</csymbol><ci id="S2.Ex10.m1.1.1.1.1.4.2.2.5.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.2">𝑢</ci><apply id="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.3"><minus id="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.1"></minus><ci id="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.2">𝑡</ci><ci id="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.3.cmml" xref="S2.Ex10.m1.1.1.1.1.4.2.2.5.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.Ex10.m1.1.1.1.1.4.3.cmml" xref="S2.Ex10.m1.1.1.1.1.4.3"><times id="S2.Ex10.m1.1.1.1.1.4.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.3.1"></times><ci id="S2.Ex10.m1.1.1.1.1.4.3.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.3.2">𝐷</ci><apply id="S2.Ex10.m1.1.1.1.1.4.3.3.cmml" xref="S2.Ex10.m1.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.1.1.1.1.4.3.3.1.cmml" xref="S2.Ex10.m1.1.1.1.1.4.3.3">subscript</csymbol><ci id="S2.Ex10.m1.1.1.1.1.4.3.3.2.cmml" xref="S2.Ex10.m1.1.1.1.1.4.3.3.2">𝑢</ci><ci id="S2.Ex10.m1.1.1.1.1.4.3.3.3.cmml" xref="S2.Ex10.m1.1.1.1.1.4.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex10.m1.1c">\pi_{ABCD}(u_{1:t},y_{1:t-1})=\sum_{i=1}^{t-1}CA^{i-1}Bu_{t-i}+Du_{t}.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex10.m1.1d">italic_π start_POSTSUBSCRIPT italic_A italic_B italic_C italic_D end_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT italic_C italic_A start_POSTSUPERSCRIPT italic_i - 1 end_POSTSUPERSCRIPT italic_B italic_u start_POSTSUBSCRIPT italic_t - italic_i end_POSTSUBSCRIPT + italic_D italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p2.8">The best such predictor for a given sequence is also called the optimal open loop predictor, and it is accurate if the signal is generated by a LDS without noise.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Fast auto-regressive generation using a prefill cache</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.4">A simple variant of our method for batch prediction is described in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg1" title="Algorithm 1 ‣ 3 Fast auto-regressive generation using a prefill cache ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">1</span></a>. The algorithm uses the FFT in order to compute convolutions between the filters of a convolutional model and the inputs. These convolutions, unlike previous methods, <span class="ltx_text ltx_font_italic" id="S3.p1.4.1">pre-compute</span> a large part of the computation that shall be required during the generation of a particular token during generation phase. Thus the algorithm generates and stores a total of <math alttext="K" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_K</annotation></semantics></math> cache elements if the target is to generate <math alttext="K" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_K</annotation></semantics></math> tokens. For any generated token this cache element captures the entire dependence of that token on the prefill context. We call this technique <span class="ltx_text ltx_font_italic" id="S3.p1.4.2">FutureFill</span>. During the generation phase, the algorithm then complements this cached information for each prediction with the necessary additional information from the inputs that are newly observed (or generated in case of auto-regressive prediction). We note that such a summarization of the prefill context is not possible for attention models, as the exact dependence of an output token during generation on the prefill context cannot be determined till we are generating that token. In the algorithm below for the prefill generation setting, we take <math alttext="u_{t}=\hat{y}_{t-1}" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mrow id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><msub id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml"><mi id="S3.p1.3.m3.1.1.2.2" xref="S3.p1.3.m3.1.1.2.2.cmml">u</mi><mi id="S3.p1.3.m3.1.1.2.3" xref="S3.p1.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="S3.p1.3.m3.1.1.1" xref="S3.p1.3.m3.1.1.1.cmml">=</mo><msub id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml"><mover accent="true" id="S3.p1.3.m3.1.1.3.2" xref="S3.p1.3.m3.1.1.3.2.cmml"><mi id="S3.p1.3.m3.1.1.3.2.2" xref="S3.p1.3.m3.1.1.3.2.2.cmml">y</mi><mo id="S3.p1.3.m3.1.1.3.2.1" xref="S3.p1.3.m3.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.p1.3.m3.1.1.3.3" xref="S3.p1.3.m3.1.1.3.3.cmml"><mi id="S3.p1.3.m3.1.1.3.3.2" xref="S3.p1.3.m3.1.1.3.3.2.cmml">t</mi><mo id="S3.p1.3.m3.1.1.3.3.1" xref="S3.p1.3.m3.1.1.3.3.1.cmml">−</mo><mn id="S3.p1.3.m3.1.1.3.3.3" xref="S3.p1.3.m3.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><eq id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1"></eq><apply id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.2.1.cmml" xref="S3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.p1.3.m3.1.1.2.2.cmml" xref="S3.p1.3.m3.1.1.2.2">𝑢</ci><ci id="S3.p1.3.m3.1.1.2.3.cmml" xref="S3.p1.3.m3.1.1.2.3">𝑡</ci></apply><apply id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.3.1.cmml" xref="S3.p1.3.m3.1.1.3">subscript</csymbol><apply id="S3.p1.3.m3.1.1.3.2.cmml" xref="S3.p1.3.m3.1.1.3.2"><ci id="S3.p1.3.m3.1.1.3.2.1.cmml" xref="S3.p1.3.m3.1.1.3.2.1">^</ci><ci id="S3.p1.3.m3.1.1.3.2.2.cmml" xref="S3.p1.3.m3.1.1.3.2.2">𝑦</ci></apply><apply id="S3.p1.3.m3.1.1.3.3.cmml" xref="S3.p1.3.m3.1.1.3.3"><minus id="S3.p1.3.m3.1.1.3.3.1.cmml" xref="S3.p1.3.m3.1.1.3.3.1"></minus><ci id="S3.p1.3.m3.1.1.3.3.2.cmml" xref="S3.p1.3.m3.1.1.3.3.2">𝑡</ci><cn id="S3.p1.3.m3.1.1.3.3.3.cmml" type="integer" xref="S3.p1.3.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">u_{t}=\hat{y}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="t\in[L+1,L+K]" class="ltx_Math" display="inline" id="S3.p1.4.m4.2"><semantics id="S3.p1.4.m4.2a"><mrow id="S3.p1.4.m4.2.2" xref="S3.p1.4.m4.2.2.cmml"><mi id="S3.p1.4.m4.2.2.4" xref="S3.p1.4.m4.2.2.4.cmml">t</mi><mo id="S3.p1.4.m4.2.2.3" xref="S3.p1.4.m4.2.2.3.cmml">∈</mo><mrow id="S3.p1.4.m4.2.2.2.2" xref="S3.p1.4.m4.2.2.2.3.cmml"><mo id="S3.p1.4.m4.2.2.2.2.3" stretchy="false" xref="S3.p1.4.m4.2.2.2.3.cmml">[</mo><mrow id="S3.p1.4.m4.1.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.p1.4.m4.1.1.1.1.1.2" xref="S3.p1.4.m4.1.1.1.1.1.2.cmml">L</mi><mo id="S3.p1.4.m4.1.1.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.1.1.cmml">+</mo><mn id="S3.p1.4.m4.1.1.1.1.1.3" xref="S3.p1.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p1.4.m4.2.2.2.2.4" xref="S3.p1.4.m4.2.2.2.3.cmml">,</mo><mrow id="S3.p1.4.m4.2.2.2.2.2" xref="S3.p1.4.m4.2.2.2.2.2.cmml"><mi id="S3.p1.4.m4.2.2.2.2.2.2" xref="S3.p1.4.m4.2.2.2.2.2.2.cmml">L</mi><mo id="S3.p1.4.m4.2.2.2.2.2.1" xref="S3.p1.4.m4.2.2.2.2.2.1.cmml">+</mo><mi id="S3.p1.4.m4.2.2.2.2.2.3" xref="S3.p1.4.m4.2.2.2.2.2.3.cmml">K</mi></mrow><mo id="S3.p1.4.m4.2.2.2.2.5" stretchy="false" xref="S3.p1.4.m4.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.2b"><apply id="S3.p1.4.m4.2.2.cmml" xref="S3.p1.4.m4.2.2"><in id="S3.p1.4.m4.2.2.3.cmml" xref="S3.p1.4.m4.2.2.3"></in><ci id="S3.p1.4.m4.2.2.4.cmml" xref="S3.p1.4.m4.2.2.4">𝑡</ci><interval closure="closed" id="S3.p1.4.m4.2.2.2.3.cmml" xref="S3.p1.4.m4.2.2.2.2"><apply id="S3.p1.4.m4.1.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1"><plus id="S3.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1"></plus><ci id="S3.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.p1.4.m4.1.1.1.1.1.2">𝐿</ci><cn id="S3.p1.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S3.p1.4.m4.1.1.1.1.1.3">1</cn></apply><apply id="S3.p1.4.m4.2.2.2.2.2.cmml" xref="S3.p1.4.m4.2.2.2.2.2"><plus id="S3.p1.4.m4.2.2.2.2.2.1.cmml" xref="S3.p1.4.m4.2.2.2.2.2.1"></plus><ci id="S3.p1.4.m4.2.2.2.2.2.2.cmml" xref="S3.p1.4.m4.2.2.2.2.2.2">𝐿</ci><ci id="S3.p1.4.m4.2.2.2.2.2.3.cmml" xref="S3.p1.4.m4.2.2.2.2.2.3">𝐾</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.2c">t\in[L+1,L+K]</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.2d">italic_t ∈ [ italic_L + 1 , italic_L + italic_K ]</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="151" id="S3.F2.g1" src="extracted/5896352/figures/precache-alg.png" width="359"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Illustration of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg1" title="Algorithm 1 ‣ 3 Fast auto-regressive generation using a prefill cache ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">1</span></a></figcaption>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Efficient convolutional pre-caching </figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l1.1">Input:</span> <math alttext="K&gt;0,L&gt;0" class="ltx_Math" display="inline" id="alg1.l1.m1.2"><semantics id="alg1.l1.m1.2a"><mrow id="alg1.l1.m1.2.2.2" xref="alg1.l1.m1.2.2.3.cmml"><mrow id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.2.cmml">K</mi><mo id="alg1.l1.m1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.cmml">&gt;</mo><mn id="alg1.l1.m1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="alg1.l1.m1.2.2.2.3" xref="alg1.l1.m1.2.2.3a.cmml">,</mo><mrow id="alg1.l1.m1.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.cmml"><mi id="alg1.l1.m1.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.cmml">L</mi><mo id="alg1.l1.m1.2.2.2.2.1" xref="alg1.l1.m1.2.2.2.2.1.cmml">&gt;</mo><mn id="alg1.l1.m1.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.3.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><apply id="alg1.l1.m1.2.2.3.cmml" xref="alg1.l1.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.3a.cmml" xref="alg1.l1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l1.m1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1"><gt id="alg1.l1.m1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1"></gt><ci id="alg1.l1.m1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.2">𝐾</ci><cn id="alg1.l1.m1.1.1.1.1.3.cmml" type="integer" xref="alg1.l1.m1.1.1.1.1.3">0</cn></apply><apply id="alg1.l1.m1.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2"><gt id="alg1.l1.m1.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.1"></gt><ci id="alg1.l1.m1.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2">𝐿</ci><cn id="alg1.l1.m1.2.2.2.2.3.cmml" type="integer" xref="alg1.l1.m1.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">K&gt;0,L&gt;0</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.2d">italic_K &gt; 0 , italic_L &gt; 0</annotation></semantics></math>, prompt <math alttext="u_{1:L}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">u</mi><mrow id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml"><mn id="alg1.l1.m2.1.1.3.2" xref="alg1.l1.m2.1.1.3.2.cmml">1</mn><mo id="alg1.l1.m2.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l1.m2.1.1.3.1.cmml">:</mo><mi id="alg1.l1.m2.1.1.3.3" xref="alg1.l1.m2.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑢</ci><apply id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3"><ci id="alg1.l1.m2.1.1.3.1.cmml" xref="alg1.l1.m2.1.1.3.1">:</ci><cn id="alg1.l1.m2.1.1.3.2.cmml" type="integer" xref="alg1.l1.m2.1.1.3.2">1</cn><ci id="alg1.l1.m2.1.1.3.3.cmml" xref="alg1.l1.m2.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">u_{1:L}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_u start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT</annotation></semantics></math>, convolutional filter <math alttext="\phi\in\mathbb{R}^{L+K}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">ϕ</mi><mo id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">∈</mo><msup id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml"><mi id="alg1.l1.m3.1.1.3.2" xref="alg1.l1.m3.1.1.3.2.cmml">ℝ</mi><mrow id="alg1.l1.m3.1.1.3.3" xref="alg1.l1.m3.1.1.3.3.cmml"><mi id="alg1.l1.m3.1.1.3.3.2" xref="alg1.l1.m3.1.1.3.3.2.cmml">L</mi><mo id="alg1.l1.m3.1.1.3.3.1" xref="alg1.l1.m3.1.1.3.3.1.cmml">+</mo><mi id="alg1.l1.m3.1.1.3.3.3" xref="alg1.l1.m3.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><in id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></in><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">italic-ϕ</ci><apply id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.3.1.cmml" xref="alg1.l1.m3.1.1.3">superscript</csymbol><ci id="alg1.l1.m3.1.1.3.2.cmml" xref="alg1.l1.m3.1.1.3.2">ℝ</ci><apply id="alg1.l1.m3.1.1.3.3.cmml" xref="alg1.l1.m3.1.1.3.3"><plus id="alg1.l1.m3.1.1.3.3.1.cmml" xref="alg1.l1.m3.1.1.3.3.1"></plus><ci id="alg1.l1.m3.1.1.3.3.2.cmml" xref="alg1.l1.m3.1.1.3.3.2">𝐿</ci><ci id="alg1.l1.m3.1.1.3.3.3.cmml" xref="alg1.l1.m3.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\phi\in\mathbb{R}^{L+K}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_ϕ ∈ blackboard_R start_POSTSUPERSCRIPT italic_L + italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>   Compute via FFT, <math alttext="K" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_K</annotation></semantics></math> inner products and store them in a cache <math alttext="\{C_{1}\ldots C_{k}\},C_{i}\in\mathbb{R}" class="ltx_Math" display="inline" id="alg1.l2.m2.2"><semantics id="alg1.l2.m2.2a"><mrow id="alg1.l2.m2.2.2" xref="alg1.l2.m2.2.2.cmml"><mrow id="alg1.l2.m2.2.2.2.2" xref="alg1.l2.m2.2.2.2.3.cmml"><mrow id="alg1.l2.m2.1.1.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.1.2.cmml"><mo id="alg1.l2.m2.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l2.m2.1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l2.m2.1.1.1.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.1.1.1.cmml"><msub id="alg1.l2.m2.1.1.1.1.1.1.1.2" xref="alg1.l2.m2.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l2.m2.1.1.1.1.1.1.1.2.2" xref="alg1.l2.m2.1.1.1.1.1.1.1.2.2.cmml">C</mi><mn id="alg1.l2.m2.1.1.1.1.1.1.1.2.3" xref="alg1.l2.m2.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="alg1.l2.m2.1.1.1.1.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m2.1.1.1.1.1.1.1.3" mathvariant="normal" xref="alg1.l2.m2.1.1.1.1.1.1.1.3.cmml">…</mi><mo id="alg1.l2.m2.1.1.1.1.1.1.1.1a" xref="alg1.l2.m2.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg1.l2.m2.1.1.1.1.1.1.1.4" xref="alg1.l2.m2.1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l2.m2.1.1.1.1.1.1.1.4.2" xref="alg1.l2.m2.1.1.1.1.1.1.1.4.2.cmml">C</mi><mi id="alg1.l2.m2.1.1.1.1.1.1.1.4.3" xref="alg1.l2.m2.1.1.1.1.1.1.1.4.3.cmml">k</mi></msub></mrow><mo id="alg1.l2.m2.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="alg1.l2.m2.2.2.2.2.3" xref="alg1.l2.m2.2.2.2.3.cmml">,</mo><msub id="alg1.l2.m2.2.2.2.2.2" xref="alg1.l2.m2.2.2.2.2.2.cmml"><mi id="alg1.l2.m2.2.2.2.2.2.2" xref="alg1.l2.m2.2.2.2.2.2.2.cmml">C</mi><mi id="alg1.l2.m2.2.2.2.2.2.3" xref="alg1.l2.m2.2.2.2.2.2.3.cmml">i</mi></msub></mrow><mo id="alg1.l2.m2.2.2.3" xref="alg1.l2.m2.2.2.3.cmml">∈</mo><mi id="alg1.l2.m2.2.2.4" xref="alg1.l2.m2.2.2.4.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.2b"><apply id="alg1.l2.m2.2.2.cmml" xref="alg1.l2.m2.2.2"><in id="alg1.l2.m2.2.2.3.cmml" xref="alg1.l2.m2.2.2.3"></in><list id="alg1.l2.m2.2.2.2.3.cmml" xref="alg1.l2.m2.2.2.2.2"><set id="alg1.l2.m2.1.1.1.1.1.2.cmml" xref="alg1.l2.m2.1.1.1.1.1.1"><apply id="alg1.l2.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1.1.1.1"><times id="alg1.l2.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1.1.1.1.1"></times><apply id="alg1.l2.m2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l2.m2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l2.m2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l2.m2.1.1.1.1.1.1.1.2.2">𝐶</ci><cn id="alg1.l2.m2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="alg1.l2.m2.1.1.1.1.1.1.1.2.3">1</cn></apply><ci id="alg1.l2.m2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l2.m2.1.1.1.1.1.1.1.3">…</ci><apply id="alg1.l2.m2.1.1.1.1.1.1.1.4.cmml" xref="alg1.l2.m2.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l2.m2.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l2.m2.1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l2.m2.1.1.1.1.1.1.1.4.2">𝐶</ci><ci id="alg1.l2.m2.1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l2.m2.1.1.1.1.1.1.1.4.3">𝑘</ci></apply></apply></set><apply id="alg1.l2.m2.2.2.2.2.2.cmml" xref="alg1.l2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m2.2.2.2.2.2.1.cmml" xref="alg1.l2.m2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l2.m2.2.2.2.2.2.2.cmml" xref="alg1.l2.m2.2.2.2.2.2.2">𝐶</ci><ci id="alg1.l2.m2.2.2.2.2.2.3.cmml" xref="alg1.l2.m2.2.2.2.2.2.3">𝑖</ci></apply></list><ci id="alg1.l2.m2.2.2.4.cmml" xref="alg1.l2.m2.2.2.4">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.2c">\{C_{1}\ldots C_{k}\},C_{i}\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.2d">{ italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } , italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R</annotation></semantics></math>,

<table class="ltx_equation ltx_eqn_table" id="S3.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\forall\tau\in\{1,...,K\}\ \ ,\ \ C_{\tau}\leftarrow\langle\phi_{1:L+\tau},0_{%
\tau}u_{L:1}\rangle=\langle\phi_{\tau+1:\tau+L},u_{L:1}\rangle" class="ltx_math_unparsed" display="block" id="S3.Ex11.m1.3"><semantics id="S3.Ex11.m1.3a"><mrow id="S3.Ex11.m1.3b"><mo id="S3.Ex11.m1.3.4" rspace="0.167em">∀</mo><mi id="S3.Ex11.m1.3.5">τ</mi><mo id="S3.Ex11.m1.3.6">∈</mo><mrow id="S3.Ex11.m1.3.7"><mo id="S3.Ex11.m1.3.7.1" stretchy="false">{</mo><mn id="S3.Ex11.m1.1.1">1</mn><mo id="S3.Ex11.m1.3.7.2">,</mo><mi id="S3.Ex11.m1.2.2" mathvariant="normal">…</mi><mo id="S3.Ex11.m1.3.7.3">,</mo><mi id="S3.Ex11.m1.3.3">K</mi><mo id="S3.Ex11.m1.3.7.4" stretchy="false">}</mo></mrow><mspace id="S3.Ex11.m1.3.8" width="1em"></mspace><mo id="S3.Ex11.m1.3.9" rspace="1.167em">,</mo><msub id="S3.Ex11.m1.3.10"><mi id="S3.Ex11.m1.3.10.2">C</mi><mi id="S3.Ex11.m1.3.10.3">τ</mi></msub><mo id="S3.Ex11.m1.3.11" stretchy="false">←</mo><mrow id="S3.Ex11.m1.3.12"><mo id="S3.Ex11.m1.3.12.1" stretchy="false">⟨</mo><msub id="S3.Ex11.m1.3.12.2"><mi id="S3.Ex11.m1.3.12.2.2">ϕ</mi><mrow id="S3.Ex11.m1.3.12.2.3"><mn id="S3.Ex11.m1.3.12.2.3.2">1</mn><mo id="S3.Ex11.m1.3.12.2.3.1" lspace="0.278em" rspace="0.278em">:</mo><mrow id="S3.Ex11.m1.3.12.2.3.3"><mi id="S3.Ex11.m1.3.12.2.3.3.2">L</mi><mo id="S3.Ex11.m1.3.12.2.3.3.1">+</mo><mi id="S3.Ex11.m1.3.12.2.3.3.3">τ</mi></mrow></mrow></msub><mo id="S3.Ex11.m1.3.12.3">,</mo><msub id="S3.Ex11.m1.3.12.4"><mn id="S3.Ex11.m1.3.12.4.2">0</mn><mi id="S3.Ex11.m1.3.12.4.3">τ</mi></msub><msub id="S3.Ex11.m1.3.12.5"><mi id="S3.Ex11.m1.3.12.5.2">u</mi><mrow id="S3.Ex11.m1.3.12.5.3"><mi id="S3.Ex11.m1.3.12.5.3.2">L</mi><mo id="S3.Ex11.m1.3.12.5.3.1" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.Ex11.m1.3.12.5.3.3">1</mn></mrow></msub><mo id="S3.Ex11.m1.3.12.6" stretchy="false">⟩</mo></mrow><mo id="S3.Ex11.m1.3.13">=</mo><mrow id="S3.Ex11.m1.3.14"><mo id="S3.Ex11.m1.3.14.1" stretchy="false">⟨</mo><msub id="S3.Ex11.m1.3.14.2"><mi id="S3.Ex11.m1.3.14.2.2">ϕ</mi><mrow id="S3.Ex11.m1.3.14.2.3"><mrow id="S3.Ex11.m1.3.14.2.3.2"><mi id="S3.Ex11.m1.3.14.2.3.2.2">τ</mi><mo id="S3.Ex11.m1.3.14.2.3.2.1">+</mo><mn id="S3.Ex11.m1.3.14.2.3.2.3">1</mn></mrow><mo id="S3.Ex11.m1.3.14.2.3.1" lspace="0.278em" rspace="0.278em">:</mo><mrow id="S3.Ex11.m1.3.14.2.3.3"><mi id="S3.Ex11.m1.3.14.2.3.3.2">τ</mi><mo id="S3.Ex11.m1.3.14.2.3.3.1">+</mo><mi id="S3.Ex11.m1.3.14.2.3.3.3">L</mi></mrow></mrow></msub><mo id="S3.Ex11.m1.3.14.3">,</mo><msub id="S3.Ex11.m1.3.14.4"><mi id="S3.Ex11.m1.3.14.4.2">u</mi><mrow id="S3.Ex11.m1.3.14.4.3"><mi id="S3.Ex11.m1.3.14.4.3.2">L</mi><mo id="S3.Ex11.m1.3.14.4.3.1" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.Ex11.m1.3.14.4.3.3">1</mn></mrow></msub><mo id="S3.Ex11.m1.3.14.5" stretchy="false">⟩</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex11.m1.3c">\forall\tau\in\{1,...,K\}\ \ ,\ \ C_{\tau}\leftarrow\langle\phi_{1:L+\tau},0_{%
\tau}u_{L:1}\rangle=\langle\phi_{\tau+1:\tau+L},u_{L:1}\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.Ex11.m1.3d">∀ italic_τ ∈ { 1 , … , italic_K } , italic_C start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT ← ⟨ italic_ϕ start_POSTSUBSCRIPT 1 : italic_L + italic_τ end_POSTSUBSCRIPT , 0 start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_L : 1 end_POSTSUBSCRIPT ⟩ = ⟨ italic_ϕ start_POSTSUBSCRIPT italic_τ + 1 : italic_τ + italic_L end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_L : 1 end_POSTSUBSCRIPT ⟩</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l3.1">for</span>  <math alttext="\tau=1,...,K" class="ltx_Math" display="inline" id="alg1.l3.m1.3"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.4" xref="alg1.l3.m1.3.4.cmml"><mi id="alg1.l3.m1.3.4.2" xref="alg1.l3.m1.3.4.2.cmml">τ</mi><mo id="alg1.l3.m1.3.4.1" xref="alg1.l3.m1.3.4.1.cmml">=</mo><mrow id="alg1.l3.m1.3.4.3.2" xref="alg1.l3.m1.3.4.3.1.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.3.4.3.2.1" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l3.m1.2.2" mathvariant="normal" xref="alg1.l3.m1.2.2.cmml">…</mi><mo id="alg1.l3.m1.3.4.3.2.2" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.4.cmml" xref="alg1.l3.m1.3.4"><eq id="alg1.l3.m1.3.4.1.cmml" xref="alg1.l3.m1.3.4.1"></eq><ci id="alg1.l3.m1.3.4.2.cmml" xref="alg1.l3.m1.3.4.2">𝜏</ci><list id="alg1.l3.m1.3.4.3.1.cmml" xref="alg1.l3.m1.3.4.3.2"><cn id="alg1.l3.m1.1.1.cmml" type="integer" xref="alg1.l3.m1.1.1">1</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">…</ci><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">\tau=1,...,K</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.3d">italic_τ = 1 , … , italic_K</annotation></semantics></math>, let <math alttext="t=L+\tau" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mrow id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml">t</mi><mo id="alg1.l3.m2.1.1.1" xref="alg1.l3.m2.1.1.1.cmml">=</mo><mrow id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml"><mi id="alg1.l3.m2.1.1.3.2" xref="alg1.l3.m2.1.1.3.2.cmml">L</mi><mo id="alg1.l3.m2.1.1.3.1" xref="alg1.l3.m2.1.1.3.1.cmml">+</mo><mi id="alg1.l3.m2.1.1.3.3" xref="alg1.l3.m2.1.1.3.3.cmml">τ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><eq id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1.1"></eq><ci id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2">𝑡</ci><apply id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3"><plus id="alg1.l3.m2.1.1.3.1.cmml" xref="alg1.l3.m2.1.1.3.1"></plus><ci id="alg1.l3.m2.1.1.3.2.cmml" xref="alg1.l3.m2.1.1.3.2">𝐿</ci><ci id="alg1.l3.m2.1.1.3.3.cmml" xref="alg1.l3.m2.1.1.3.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">t=L+\tau</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_t = italic_L + italic_τ</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l3.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>      Compute and predict

<table class="ltx_equation ltx_eqn_table" id="S3.Ex12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}_{t}=\sum_{j=1}^{t}\phi_{j}u_{t-j+1}=\sum_{j=1}^{\tau}\phi_{j}u_{t-j+1}%
+\underbrace{\langle\phi_{\tau+1:t},u_{L:1}\rangle}_{=C_{\tau}}" class="ltx_Math" display="block" id="S3.Ex12.m1.2"><semantics id="S3.Ex12.m1.2a"><mrow id="S3.Ex12.m1.2.3" xref="S3.Ex12.m1.2.3.cmml"><msub id="S3.Ex12.m1.2.3.2" xref="S3.Ex12.m1.2.3.2.cmml"><mover accent="true" id="S3.Ex12.m1.2.3.2.2" xref="S3.Ex12.m1.2.3.2.2.cmml"><mi id="S3.Ex12.m1.2.3.2.2.2" xref="S3.Ex12.m1.2.3.2.2.2.cmml">y</mi><mo id="S3.Ex12.m1.2.3.2.2.1" xref="S3.Ex12.m1.2.3.2.2.1.cmml">^</mo></mover><mi id="S3.Ex12.m1.2.3.2.3" xref="S3.Ex12.m1.2.3.2.3.cmml">t</mi></msub><mo id="S3.Ex12.m1.2.3.3" rspace="0.111em" xref="S3.Ex12.m1.2.3.3.cmml">=</mo><mrow id="S3.Ex12.m1.2.3.4" xref="S3.Ex12.m1.2.3.4.cmml"><munderover id="S3.Ex12.m1.2.3.4.1" xref="S3.Ex12.m1.2.3.4.1.cmml"><mo id="S3.Ex12.m1.2.3.4.1.2.2" movablelimits="false" xref="S3.Ex12.m1.2.3.4.1.2.2.cmml">∑</mo><mrow id="S3.Ex12.m1.2.3.4.1.2.3" xref="S3.Ex12.m1.2.3.4.1.2.3.cmml"><mi id="S3.Ex12.m1.2.3.4.1.2.3.2" xref="S3.Ex12.m1.2.3.4.1.2.3.2.cmml">j</mi><mo id="S3.Ex12.m1.2.3.4.1.2.3.1" xref="S3.Ex12.m1.2.3.4.1.2.3.1.cmml">=</mo><mn id="S3.Ex12.m1.2.3.4.1.2.3.3" xref="S3.Ex12.m1.2.3.4.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex12.m1.2.3.4.1.3" xref="S3.Ex12.m1.2.3.4.1.3.cmml">t</mi></munderover><mrow id="S3.Ex12.m1.2.3.4.2" xref="S3.Ex12.m1.2.3.4.2.cmml"><msub id="S3.Ex12.m1.2.3.4.2.2" xref="S3.Ex12.m1.2.3.4.2.2.cmml"><mi id="S3.Ex12.m1.2.3.4.2.2.2" xref="S3.Ex12.m1.2.3.4.2.2.2.cmml">ϕ</mi><mi id="S3.Ex12.m1.2.3.4.2.2.3" xref="S3.Ex12.m1.2.3.4.2.2.3.cmml">j</mi></msub><mo id="S3.Ex12.m1.2.3.4.2.1" xref="S3.Ex12.m1.2.3.4.2.1.cmml">⁢</mo><msub id="S3.Ex12.m1.2.3.4.2.3" xref="S3.Ex12.m1.2.3.4.2.3.cmml"><mi id="S3.Ex12.m1.2.3.4.2.3.2" xref="S3.Ex12.m1.2.3.4.2.3.2.cmml">u</mi><mrow id="S3.Ex12.m1.2.3.4.2.3.3" xref="S3.Ex12.m1.2.3.4.2.3.3.cmml"><mrow id="S3.Ex12.m1.2.3.4.2.3.3.2" xref="S3.Ex12.m1.2.3.4.2.3.3.2.cmml"><mi id="S3.Ex12.m1.2.3.4.2.3.3.2.2" xref="S3.Ex12.m1.2.3.4.2.3.3.2.2.cmml">t</mi><mo id="S3.Ex12.m1.2.3.4.2.3.3.2.1" xref="S3.Ex12.m1.2.3.4.2.3.3.2.1.cmml">−</mo><mi id="S3.Ex12.m1.2.3.4.2.3.3.2.3" xref="S3.Ex12.m1.2.3.4.2.3.3.2.3.cmml">j</mi></mrow><mo id="S3.Ex12.m1.2.3.4.2.3.3.1" xref="S3.Ex12.m1.2.3.4.2.3.3.1.cmml">+</mo><mn id="S3.Ex12.m1.2.3.4.2.3.3.3" xref="S3.Ex12.m1.2.3.4.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S3.Ex12.m1.2.3.5" rspace="0.111em" xref="S3.Ex12.m1.2.3.5.cmml">=</mo><mrow id="S3.Ex12.m1.2.3.6" xref="S3.Ex12.m1.2.3.6.cmml"><mrow id="S3.Ex12.m1.2.3.6.2" xref="S3.Ex12.m1.2.3.6.2.cmml"><munderover id="S3.Ex12.m1.2.3.6.2.1" xref="S3.Ex12.m1.2.3.6.2.1.cmml"><mo id="S3.Ex12.m1.2.3.6.2.1.2.2" movablelimits="false" xref="S3.Ex12.m1.2.3.6.2.1.2.2.cmml">∑</mo><mrow id="S3.Ex12.m1.2.3.6.2.1.2.3" xref="S3.Ex12.m1.2.3.6.2.1.2.3.cmml"><mi id="S3.Ex12.m1.2.3.6.2.1.2.3.2" xref="S3.Ex12.m1.2.3.6.2.1.2.3.2.cmml">j</mi><mo id="S3.Ex12.m1.2.3.6.2.1.2.3.1" xref="S3.Ex12.m1.2.3.6.2.1.2.3.1.cmml">=</mo><mn id="S3.Ex12.m1.2.3.6.2.1.2.3.3" xref="S3.Ex12.m1.2.3.6.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex12.m1.2.3.6.2.1.3" xref="S3.Ex12.m1.2.3.6.2.1.3.cmml">τ</mi></munderover><mrow id="S3.Ex12.m1.2.3.6.2.2" xref="S3.Ex12.m1.2.3.6.2.2.cmml"><msub id="S3.Ex12.m1.2.3.6.2.2.2" xref="S3.Ex12.m1.2.3.6.2.2.2.cmml"><mi id="S3.Ex12.m1.2.3.6.2.2.2.2" xref="S3.Ex12.m1.2.3.6.2.2.2.2.cmml">ϕ</mi><mi id="S3.Ex12.m1.2.3.6.2.2.2.3" xref="S3.Ex12.m1.2.3.6.2.2.2.3.cmml">j</mi></msub><mo id="S3.Ex12.m1.2.3.6.2.2.1" xref="S3.Ex12.m1.2.3.6.2.2.1.cmml">⁢</mo><msub id="S3.Ex12.m1.2.3.6.2.2.3" xref="S3.Ex12.m1.2.3.6.2.2.3.cmml"><mi id="S3.Ex12.m1.2.3.6.2.2.3.2" xref="S3.Ex12.m1.2.3.6.2.2.3.2.cmml">u</mi><mrow id="S3.Ex12.m1.2.3.6.2.2.3.3" xref="S3.Ex12.m1.2.3.6.2.2.3.3.cmml"><mrow id="S3.Ex12.m1.2.3.6.2.2.3.3.2" xref="S3.Ex12.m1.2.3.6.2.2.3.3.2.cmml"><mi id="S3.Ex12.m1.2.3.6.2.2.3.3.2.2" xref="S3.Ex12.m1.2.3.6.2.2.3.3.2.2.cmml">t</mi><mo id="S3.Ex12.m1.2.3.6.2.2.3.3.2.1" xref="S3.Ex12.m1.2.3.6.2.2.3.3.2.1.cmml">−</mo><mi id="S3.Ex12.m1.2.3.6.2.2.3.3.2.3" xref="S3.Ex12.m1.2.3.6.2.2.3.3.2.3.cmml">j</mi></mrow><mo id="S3.Ex12.m1.2.3.6.2.2.3.3.1" xref="S3.Ex12.m1.2.3.6.2.2.3.3.1.cmml">+</mo><mn id="S3.Ex12.m1.2.3.6.2.2.3.3.3" xref="S3.Ex12.m1.2.3.6.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S3.Ex12.m1.2.3.6.1" xref="S3.Ex12.m1.2.3.6.1.cmml">+</mo><munder id="S3.Ex12.m1.2.3.6.3" xref="S3.Ex12.m1.2.3.6.3.cmml"><munder accentunder="true" id="S3.Ex12.m1.2.2" xref="S3.Ex12.m1.2.2.cmml"><mrow id="S3.Ex12.m1.2.2.2.2" xref="S3.Ex12.m1.2.2.2.3.cmml"><mo id="S3.Ex12.m1.2.2.2.2.3" stretchy="false" xref="S3.Ex12.m1.2.2.2.3.cmml">⟨</mo><msub id="S3.Ex12.m1.1.1.1.1.1" xref="S3.Ex12.m1.1.1.1.1.1.cmml"><mi id="S3.Ex12.m1.1.1.1.1.1.2" xref="S3.Ex12.m1.1.1.1.1.1.2.cmml">ϕ</mi><mrow id="S3.Ex12.m1.1.1.1.1.1.3" xref="S3.Ex12.m1.1.1.1.1.1.3.cmml"><mrow id="S3.Ex12.m1.1.1.1.1.1.3.2" xref="S3.Ex12.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex12.m1.1.1.1.1.1.3.2.2" xref="S3.Ex12.m1.1.1.1.1.1.3.2.2.cmml">τ</mi><mo id="S3.Ex12.m1.1.1.1.1.1.3.2.1" xref="S3.Ex12.m1.1.1.1.1.1.3.2.1.cmml">+</mo><mn id="S3.Ex12.m1.1.1.1.1.1.3.2.3" xref="S3.Ex12.m1.1.1.1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.Ex12.m1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.Ex12.m1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.Ex12.m1.1.1.1.1.1.3.3" xref="S3.Ex12.m1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S3.Ex12.m1.2.2.2.2.4" xref="S3.Ex12.m1.2.2.2.3.cmml">,</mo><msub id="S3.Ex12.m1.2.2.2.2.2" xref="S3.Ex12.m1.2.2.2.2.2.cmml"><mi id="S3.Ex12.m1.2.2.2.2.2.2" xref="S3.Ex12.m1.2.2.2.2.2.2.cmml">u</mi><mrow id="S3.Ex12.m1.2.2.2.2.2.3" xref="S3.Ex12.m1.2.2.2.2.2.3.cmml"><mi id="S3.Ex12.m1.2.2.2.2.2.3.2" xref="S3.Ex12.m1.2.2.2.2.2.3.2.cmml">L</mi><mo id="S3.Ex12.m1.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.Ex12.m1.2.2.2.2.2.3.1.cmml">:</mo><mn id="S3.Ex12.m1.2.2.2.2.2.3.3" xref="S3.Ex12.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.Ex12.m1.2.2.2.2.5" stretchy="false" xref="S3.Ex12.m1.2.2.2.3.cmml">⟩</mo></mrow><mo id="S3.Ex12.m1.2.2.3" xref="S3.Ex12.m1.2.2.3.cmml">⏟</mo></munder><mrow id="S3.Ex12.m1.2.3.6.3.2" xref="S3.Ex12.m1.2.3.6.3.2.cmml"><mi id="S3.Ex12.m1.2.3.6.3.2.2" xref="S3.Ex12.m1.2.3.6.3.2.2.cmml"></mi><mo id="S3.Ex12.m1.2.3.6.3.2.1" xref="S3.Ex12.m1.2.3.6.3.2.1.cmml">=</mo><msub id="S3.Ex12.m1.2.3.6.3.2.3" xref="S3.Ex12.m1.2.3.6.3.2.3.cmml"><mi id="S3.Ex12.m1.2.3.6.3.2.3.2" xref="S3.Ex12.m1.2.3.6.3.2.3.2.cmml">C</mi><mi id="S3.Ex12.m1.2.3.6.3.2.3.3" xref="S3.Ex12.m1.2.3.6.3.2.3.3.cmml">τ</mi></msub></mrow></munder></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex12.m1.2b"><apply id="S3.Ex12.m1.2.3.cmml" xref="S3.Ex12.m1.2.3"><and id="S3.Ex12.m1.2.3a.cmml" xref="S3.Ex12.m1.2.3"></and><apply id="S3.Ex12.m1.2.3b.cmml" xref="S3.Ex12.m1.2.3"><eq id="S3.Ex12.m1.2.3.3.cmml" xref="S3.Ex12.m1.2.3.3"></eq><apply id="S3.Ex12.m1.2.3.2.cmml" xref="S3.Ex12.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.2.1.cmml" xref="S3.Ex12.m1.2.3.2">subscript</csymbol><apply id="S3.Ex12.m1.2.3.2.2.cmml" xref="S3.Ex12.m1.2.3.2.2"><ci id="S3.Ex12.m1.2.3.2.2.1.cmml" xref="S3.Ex12.m1.2.3.2.2.1">^</ci><ci id="S3.Ex12.m1.2.3.2.2.2.cmml" xref="S3.Ex12.m1.2.3.2.2.2">𝑦</ci></apply><ci id="S3.Ex12.m1.2.3.2.3.cmml" xref="S3.Ex12.m1.2.3.2.3">𝑡</ci></apply><apply id="S3.Ex12.m1.2.3.4.cmml" xref="S3.Ex12.m1.2.3.4"><apply id="S3.Ex12.m1.2.3.4.1.cmml" xref="S3.Ex12.m1.2.3.4.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.4.1.1.cmml" xref="S3.Ex12.m1.2.3.4.1">superscript</csymbol><apply id="S3.Ex12.m1.2.3.4.1.2.cmml" xref="S3.Ex12.m1.2.3.4.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.4.1.2.1.cmml" xref="S3.Ex12.m1.2.3.4.1">subscript</csymbol><sum id="S3.Ex12.m1.2.3.4.1.2.2.cmml" xref="S3.Ex12.m1.2.3.4.1.2.2"></sum><apply id="S3.Ex12.m1.2.3.4.1.2.3.cmml" xref="S3.Ex12.m1.2.3.4.1.2.3"><eq id="S3.Ex12.m1.2.3.4.1.2.3.1.cmml" xref="S3.Ex12.m1.2.3.4.1.2.3.1"></eq><ci id="S3.Ex12.m1.2.3.4.1.2.3.2.cmml" xref="S3.Ex12.m1.2.3.4.1.2.3.2">𝑗</ci><cn id="S3.Ex12.m1.2.3.4.1.2.3.3.cmml" type="integer" xref="S3.Ex12.m1.2.3.4.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex12.m1.2.3.4.1.3.cmml" xref="S3.Ex12.m1.2.3.4.1.3">𝑡</ci></apply><apply id="S3.Ex12.m1.2.3.4.2.cmml" xref="S3.Ex12.m1.2.3.4.2"><times id="S3.Ex12.m1.2.3.4.2.1.cmml" xref="S3.Ex12.m1.2.3.4.2.1"></times><apply id="S3.Ex12.m1.2.3.4.2.2.cmml" xref="S3.Ex12.m1.2.3.4.2.2"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.4.2.2.1.cmml" xref="S3.Ex12.m1.2.3.4.2.2">subscript</csymbol><ci id="S3.Ex12.m1.2.3.4.2.2.2.cmml" xref="S3.Ex12.m1.2.3.4.2.2.2">italic-ϕ</ci><ci id="S3.Ex12.m1.2.3.4.2.2.3.cmml" xref="S3.Ex12.m1.2.3.4.2.2.3">𝑗</ci></apply><apply id="S3.Ex12.m1.2.3.4.2.3.cmml" xref="S3.Ex12.m1.2.3.4.2.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.4.2.3.1.cmml" xref="S3.Ex12.m1.2.3.4.2.3">subscript</csymbol><ci id="S3.Ex12.m1.2.3.4.2.3.2.cmml" xref="S3.Ex12.m1.2.3.4.2.3.2">𝑢</ci><apply id="S3.Ex12.m1.2.3.4.2.3.3.cmml" xref="S3.Ex12.m1.2.3.4.2.3.3"><plus id="S3.Ex12.m1.2.3.4.2.3.3.1.cmml" xref="S3.Ex12.m1.2.3.4.2.3.3.1"></plus><apply id="S3.Ex12.m1.2.3.4.2.3.3.2.cmml" xref="S3.Ex12.m1.2.3.4.2.3.3.2"><minus id="S3.Ex12.m1.2.3.4.2.3.3.2.1.cmml" xref="S3.Ex12.m1.2.3.4.2.3.3.2.1"></minus><ci id="S3.Ex12.m1.2.3.4.2.3.3.2.2.cmml" xref="S3.Ex12.m1.2.3.4.2.3.3.2.2">𝑡</ci><ci id="S3.Ex12.m1.2.3.4.2.3.3.2.3.cmml" xref="S3.Ex12.m1.2.3.4.2.3.3.2.3">𝑗</ci></apply><cn id="S3.Ex12.m1.2.3.4.2.3.3.3.cmml" type="integer" xref="S3.Ex12.m1.2.3.4.2.3.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S3.Ex12.m1.2.3c.cmml" xref="S3.Ex12.m1.2.3"><eq id="S3.Ex12.m1.2.3.5.cmml" xref="S3.Ex12.m1.2.3.5"></eq><share href="https://arxiv.org/html/2410.03766v1#S3.Ex12.m1.2.3.4.cmml" id="S3.Ex12.m1.2.3d.cmml" xref="S3.Ex12.m1.2.3"></share><apply id="S3.Ex12.m1.2.3.6.cmml" xref="S3.Ex12.m1.2.3.6"><plus id="S3.Ex12.m1.2.3.6.1.cmml" xref="S3.Ex12.m1.2.3.6.1"></plus><apply id="S3.Ex12.m1.2.3.6.2.cmml" xref="S3.Ex12.m1.2.3.6.2"><apply id="S3.Ex12.m1.2.3.6.2.1.cmml" xref="S3.Ex12.m1.2.3.6.2.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.6.2.1.1.cmml" xref="S3.Ex12.m1.2.3.6.2.1">superscript</csymbol><apply id="S3.Ex12.m1.2.3.6.2.1.2.cmml" xref="S3.Ex12.m1.2.3.6.2.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.6.2.1.2.1.cmml" xref="S3.Ex12.m1.2.3.6.2.1">subscript</csymbol><sum id="S3.Ex12.m1.2.3.6.2.1.2.2.cmml" xref="S3.Ex12.m1.2.3.6.2.1.2.2"></sum><apply id="S3.Ex12.m1.2.3.6.2.1.2.3.cmml" xref="S3.Ex12.m1.2.3.6.2.1.2.3"><eq id="S3.Ex12.m1.2.3.6.2.1.2.3.1.cmml" xref="S3.Ex12.m1.2.3.6.2.1.2.3.1"></eq><ci id="S3.Ex12.m1.2.3.6.2.1.2.3.2.cmml" xref="S3.Ex12.m1.2.3.6.2.1.2.3.2">𝑗</ci><cn id="S3.Ex12.m1.2.3.6.2.1.2.3.3.cmml" type="integer" xref="S3.Ex12.m1.2.3.6.2.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex12.m1.2.3.6.2.1.3.cmml" xref="S3.Ex12.m1.2.3.6.2.1.3">𝜏</ci></apply><apply id="S3.Ex12.m1.2.3.6.2.2.cmml" xref="S3.Ex12.m1.2.3.6.2.2"><times id="S3.Ex12.m1.2.3.6.2.2.1.cmml" xref="S3.Ex12.m1.2.3.6.2.2.1"></times><apply id="S3.Ex12.m1.2.3.6.2.2.2.cmml" xref="S3.Ex12.m1.2.3.6.2.2.2"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.6.2.2.2.1.cmml" xref="S3.Ex12.m1.2.3.6.2.2.2">subscript</csymbol><ci id="S3.Ex12.m1.2.3.6.2.2.2.2.cmml" xref="S3.Ex12.m1.2.3.6.2.2.2.2">italic-ϕ</ci><ci id="S3.Ex12.m1.2.3.6.2.2.2.3.cmml" xref="S3.Ex12.m1.2.3.6.2.2.2.3">𝑗</ci></apply><apply id="S3.Ex12.m1.2.3.6.2.2.3.cmml" xref="S3.Ex12.m1.2.3.6.2.2.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.6.2.2.3.1.cmml" xref="S3.Ex12.m1.2.3.6.2.2.3">subscript</csymbol><ci id="S3.Ex12.m1.2.3.6.2.2.3.2.cmml" xref="S3.Ex12.m1.2.3.6.2.2.3.2">𝑢</ci><apply id="S3.Ex12.m1.2.3.6.2.2.3.3.cmml" xref="S3.Ex12.m1.2.3.6.2.2.3.3"><plus id="S3.Ex12.m1.2.3.6.2.2.3.3.1.cmml" xref="S3.Ex12.m1.2.3.6.2.2.3.3.1"></plus><apply id="S3.Ex12.m1.2.3.6.2.2.3.3.2.cmml" xref="S3.Ex12.m1.2.3.6.2.2.3.3.2"><minus id="S3.Ex12.m1.2.3.6.2.2.3.3.2.1.cmml" xref="S3.Ex12.m1.2.3.6.2.2.3.3.2.1"></minus><ci id="S3.Ex12.m1.2.3.6.2.2.3.3.2.2.cmml" xref="S3.Ex12.m1.2.3.6.2.2.3.3.2.2">𝑡</ci><ci id="S3.Ex12.m1.2.3.6.2.2.3.3.2.3.cmml" xref="S3.Ex12.m1.2.3.6.2.2.3.3.2.3">𝑗</ci></apply><cn id="S3.Ex12.m1.2.3.6.2.2.3.3.3.cmml" type="integer" xref="S3.Ex12.m1.2.3.6.2.2.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.Ex12.m1.2.3.6.3.cmml" xref="S3.Ex12.m1.2.3.6.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.6.3.1.cmml" xref="S3.Ex12.m1.2.3.6.3">subscript</csymbol><apply id="S3.Ex12.m1.2.2.cmml" xref="S3.Ex12.m1.2.2"><ci id="S3.Ex12.m1.2.2.3.cmml" xref="S3.Ex12.m1.2.2.3">⏟</ci><list id="S3.Ex12.m1.2.2.2.3.cmml" xref="S3.Ex12.m1.2.2.2.2"><apply id="S3.Ex12.m1.1.1.1.1.1.cmml" xref="S3.Ex12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex12.m1.1.1.1.1.1.1.cmml" xref="S3.Ex12.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex12.m1.1.1.1.1.1.2.cmml" xref="S3.Ex12.m1.1.1.1.1.1.2">italic-ϕ</ci><apply id="S3.Ex12.m1.1.1.1.1.1.3.cmml" xref="S3.Ex12.m1.1.1.1.1.1.3"><ci id="S3.Ex12.m1.1.1.1.1.1.3.1.cmml" xref="S3.Ex12.m1.1.1.1.1.1.3.1">:</ci><apply id="S3.Ex12.m1.1.1.1.1.1.3.2.cmml" xref="S3.Ex12.m1.1.1.1.1.1.3.2"><plus id="S3.Ex12.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex12.m1.1.1.1.1.1.3.2.1"></plus><ci id="S3.Ex12.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex12.m1.1.1.1.1.1.3.2.2">𝜏</ci><cn id="S3.Ex12.m1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.Ex12.m1.1.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.Ex12.m1.1.1.1.1.1.3.3.cmml" xref="S3.Ex12.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.Ex12.m1.2.2.2.2.2.cmml" xref="S3.Ex12.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.2.2.2.2.1.cmml" xref="S3.Ex12.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex12.m1.2.2.2.2.2.2.cmml" xref="S3.Ex12.m1.2.2.2.2.2.2">𝑢</ci><apply id="S3.Ex12.m1.2.2.2.2.2.3.cmml" xref="S3.Ex12.m1.2.2.2.2.2.3"><ci id="S3.Ex12.m1.2.2.2.2.2.3.1.cmml" xref="S3.Ex12.m1.2.2.2.2.2.3.1">:</ci><ci id="S3.Ex12.m1.2.2.2.2.2.3.2.cmml" xref="S3.Ex12.m1.2.2.2.2.2.3.2">𝐿</ci><cn id="S3.Ex12.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.Ex12.m1.2.2.2.2.2.3.3">1</cn></apply></apply></list></apply><apply id="S3.Ex12.m1.2.3.6.3.2.cmml" xref="S3.Ex12.m1.2.3.6.3.2"><eq id="S3.Ex12.m1.2.3.6.3.2.1.cmml" xref="S3.Ex12.m1.2.3.6.3.2.1"></eq><csymbol cd="latexml" id="S3.Ex12.m1.2.3.6.3.2.2.cmml" xref="S3.Ex12.m1.2.3.6.3.2.2">absent</csymbol><apply id="S3.Ex12.m1.2.3.6.3.2.3.cmml" xref="S3.Ex12.m1.2.3.6.3.2.3"><csymbol cd="ambiguous" id="S3.Ex12.m1.2.3.6.3.2.3.1.cmml" xref="S3.Ex12.m1.2.3.6.3.2.3">subscript</csymbol><ci id="S3.Ex12.m1.2.3.6.3.2.3.2.cmml" xref="S3.Ex12.m1.2.3.6.3.2.3.2">𝐶</ci><ci id="S3.Ex12.m1.2.3.6.3.2.3.3.cmml" xref="S3.Ex12.m1.2.3.6.3.2.3.3">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex12.m1.2c">\hat{y}_{t}=\sum_{j=1}^{t}\phi_{j}u_{t-j+1}=\sum_{j=1}^{\tau}\phi_{j}u_{t-j+1}%
+\underbrace{\langle\phi_{\tau+1:t},u_{L:1}\rangle}_{=C_{\tau}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex12.m1.2d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_t - italic_j + 1 end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_t - italic_j + 1 end_POSTSUBSCRIPT + under⏟ start_ARG ⟨ italic_ϕ start_POSTSUBSCRIPT italic_τ + 1 : italic_t end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_L : 1 end_POSTSUBSCRIPT ⟩ end_ARG start_POSTSUBSCRIPT = italic_C start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l5.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l5.2">for</span>
</div>
</div>
</figure>
<section class="ltx_paragraph" id="S3.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Running time analysis.</h4>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p1.1">Our main claim regarding the performance of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg1" title="Algorithm 1 ‣ 3 Fast auto-regressive generation using a prefill cache ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">1</span></a> is as follows.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem1.1.1.1">Lemma 1</span></span><span class="ltx_text ltx_font_bold" id="Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem1.p1">
<p class="ltx_p" id="Thmtheorem1.p1.5"><span class="ltx_text ltx_font_italic" id="Thmtheorem1.p1.5.5">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg1" title="Algorithm 1 ‣ 3 Fast auto-regressive generation using a prefill cache ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">1</span></a> when supplied with a prompt of sequence length <math alttext="L" class="ltx_Math" display="inline" id="Thmtheorem1.p1.1.1.m1.1"><semantics id="Thmtheorem1.p1.1.1.m1.1a"><mi id="Thmtheorem1.p1.1.1.m1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.1.1.m1.1b"><ci id="Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.1.1.m1.1d">italic_L</annotation></semantics></math>, generates <math alttext="K" class="ltx_Math" display="inline" id="Thmtheorem1.p1.2.2.m2.1"><semantics id="Thmtheorem1.p1.2.2.m2.1a"><mi id="Thmtheorem1.p1.2.2.m2.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.2.2.m2.1b"><ci id="Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.2.2.m2.1d">italic_K</annotation></semantics></math> tokens in total time <math alttext="O(L\log L+K^{2})" class="ltx_Math" display="inline" id="Thmtheorem1.p1.3.3.m3.1"><semantics id="Thmtheorem1.p1.3.3.m3.1a"><mrow id="Thmtheorem1.p1.3.3.m3.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.cmml"><mi id="Thmtheorem1.p1.3.3.m3.1.1.3" xref="Thmtheorem1.p1.3.3.m3.1.1.3.cmml">O</mi><mo id="Thmtheorem1.p1.3.3.m3.1.1.2" xref="Thmtheorem1.p1.3.3.m3.1.1.2.cmml">⁢</mo><mrow id="Thmtheorem1.p1.3.3.m3.1.1.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml"><mo id="Thmtheorem1.p1.3.3.m3.1.1.1.1.2" stretchy="false" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml"><mrow id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.cmml"><mi id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.2" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.2.cmml">L</mi><mo id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.1" lspace="0.167em" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.cmml"><mi id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.1" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3a" lspace="0.167em" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.cmml">⁡</mo><mi id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.2" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.2.cmml">L</mi></mrow></mrow><mo id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.cmml">+</mo><msup id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.cmml"><mi id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.2" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.2.cmml">K</mi><mn id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.3" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="Thmtheorem1.p1.3.3.m3.1.1.1.1.3" stretchy="false" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.3.3.m3.1b"><apply id="Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1"><times id="Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.2"></times><ci id="Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.3">𝑂</ci><apply id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1"><plus id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1"></plus><apply id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2"><times id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.1"></times><ci id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.2.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.2">𝐿</ci><apply id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3"><log id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.1"></log><ci id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.2.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.3.2">𝐿</ci></apply></apply><apply id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3">superscript</csymbol><ci id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.2.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.2">𝐾</ci><cn id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.3.cmml" type="integer" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.3.3.m3.1c">O(L\log L+K^{2})</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.3.3.m3.1d">italic_O ( italic_L roman_log italic_L + italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> using a total prefill-cache of size <math alttext="O(K)" class="ltx_Math" display="inline" id="Thmtheorem1.p1.4.4.m4.1"><semantics id="Thmtheorem1.p1.4.4.m4.1a"><mrow id="Thmtheorem1.p1.4.4.m4.1.2" xref="Thmtheorem1.p1.4.4.m4.1.2.cmml"><mi id="Thmtheorem1.p1.4.4.m4.1.2.2" xref="Thmtheorem1.p1.4.4.m4.1.2.2.cmml">O</mi><mo id="Thmtheorem1.p1.4.4.m4.1.2.1" xref="Thmtheorem1.p1.4.4.m4.1.2.1.cmml">⁢</mo><mrow id="Thmtheorem1.p1.4.4.m4.1.2.3.2" xref="Thmtheorem1.p1.4.4.m4.1.2.cmml"><mo id="Thmtheorem1.p1.4.4.m4.1.2.3.2.1" stretchy="false" xref="Thmtheorem1.p1.4.4.m4.1.2.cmml">(</mo><mi id="Thmtheorem1.p1.4.4.m4.1.1" xref="Thmtheorem1.p1.4.4.m4.1.1.cmml">K</mi><mo id="Thmtheorem1.p1.4.4.m4.1.2.3.2.2" stretchy="false" xref="Thmtheorem1.p1.4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.4.4.m4.1b"><apply id="Thmtheorem1.p1.4.4.m4.1.2.cmml" xref="Thmtheorem1.p1.4.4.m4.1.2"><times id="Thmtheorem1.p1.4.4.m4.1.2.1.cmml" xref="Thmtheorem1.p1.4.4.m4.1.2.1"></times><ci id="Thmtheorem1.p1.4.4.m4.1.2.2.cmml" xref="Thmtheorem1.p1.4.4.m4.1.2.2">𝑂</ci><ci id="Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="Thmtheorem1.p1.4.4.m4.1.1">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.4.4.m4.1c">O(K)</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.4.4.m4.1d">italic_O ( italic_K )</annotation></semantics></math>. Hence, the algorithm runs in amortized time <math alttext="O\left(\frac{L\log L}{K}+K\right)" class="ltx_Math" display="inline" id="Thmtheorem1.p1.5.5.m5.1"><semantics id="Thmtheorem1.p1.5.5.m5.1a"><mrow id="Thmtheorem1.p1.5.5.m5.1.1" xref="Thmtheorem1.p1.5.5.m5.1.1.cmml"><mi id="Thmtheorem1.p1.5.5.m5.1.1.3" xref="Thmtheorem1.p1.5.5.m5.1.1.3.cmml">O</mi><mo id="Thmtheorem1.p1.5.5.m5.1.1.2" xref="Thmtheorem1.p1.5.5.m5.1.1.2.cmml">⁢</mo><mrow id="Thmtheorem1.p1.5.5.m5.1.1.1.1" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.cmml"><mo id="Thmtheorem1.p1.5.5.m5.1.1.1.1.2" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.cmml"><mfrac id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.cmml"><mrow id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.cmml"><mi id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.2" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.2.cmml">L</mi><mo id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.1" lspace="0.167em" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.1.cmml">⁢</mo><mrow id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.cmml"><mi id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.1" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.1.cmml">log</mi><mo id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3a" lspace="0.167em" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.cmml">⁡</mo><mi id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.2" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.2.cmml">L</mi></mrow></mrow><mi id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.3" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.3.cmml">K</mi></mfrac><mo id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.1" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.1.cmml">+</mo><mi id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.3" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.3.cmml">K</mi></mrow><mo id="Thmtheorem1.p1.5.5.m5.1.1.1.1.3" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.5.5.m5.1b"><apply id="Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1"><times id="Thmtheorem1.p1.5.5.m5.1.1.2.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.2"></times><ci id="Thmtheorem1.p1.5.5.m5.1.1.3.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.3">𝑂</ci><apply id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1"><plus id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.1"></plus><apply id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2"><divide id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.1.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2"></divide><apply id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2"><times id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.1.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.1"></times><ci id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.2.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.2">𝐿</ci><apply id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3"><log id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.1.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.1"></log><ci id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.2.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.2.3.2">𝐿</ci></apply></apply><ci id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.3.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.2.3">𝐾</ci></apply><ci id="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.3.cmml" xref="Thmtheorem1.p1.5.5.m5.1.1.1.1.1.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.5.5.m5.1c">O\left(\frac{L\log L}{K}+K\right)</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.5.5.m5.1d">italic_O ( divide start_ARG italic_L roman_log italic_L end_ARG start_ARG italic_K end_ARG + italic_K )</annotation></semantics></math> per token.</span></p>
</div>
</div>
<div class="ltx_proof" id="S3.SS0.SSS0.Px1.3">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px1.1.p1">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.1.p1.1">The total runtime of the algorithm is composed of two components as follows</p>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.5"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.5.1">Computation of the Cache (Line <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg1.l2" title="In Algorithm 1 ‣ 3 Fast auto-regressive generation using a prefill cache ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">2</span></a>):</span> The computation of the cache in line 2 can be computed via a convolution between the prompt and the filter. Let <math alttext="\bar{u}=u_{1:L}0_{K}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.1"><semantics id="S3.I1.i1.p1.1.m1.1a"><mrow id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.I1.i1.p1.1.m1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.2.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.2.2" xref="S3.I1.i1.p1.1.m1.1.1.2.2.cmml">u</mi><mo id="S3.I1.i1.p1.1.m1.1.1.2.1" xref="S3.I1.i1.p1.1.m1.1.1.2.1.cmml">¯</mo></mover><mo id="S3.I1.i1.p1.1.m1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.I1.i1.p1.1.m1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.3.cmml"><msub id="S3.I1.i1.p1.1.m1.1.1.3.2" xref="S3.I1.i1.p1.1.m1.1.1.3.2.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.3.2.2" xref="S3.I1.i1.p1.1.m1.1.1.3.2.2.cmml">u</mi><mrow id="S3.I1.i1.p1.1.m1.1.1.3.2.3" xref="S3.I1.i1.p1.1.m1.1.1.3.2.3.cmml"><mn id="S3.I1.i1.p1.1.m1.1.1.3.2.3.2" xref="S3.I1.i1.p1.1.m1.1.1.3.2.3.2.cmml">1</mn><mo id="S3.I1.i1.p1.1.m1.1.1.3.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.I1.i1.p1.1.m1.1.1.3.2.3.1.cmml">:</mo><mi id="S3.I1.i1.p1.1.m1.1.1.3.2.3.3" xref="S3.I1.i1.p1.1.m1.1.1.3.2.3.3.cmml">L</mi></mrow></msub><mo id="S3.I1.i1.p1.1.m1.1.1.3.1" xref="S3.I1.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S3.I1.i1.p1.1.m1.1.1.3.3" xref="S3.I1.i1.p1.1.m1.1.1.3.3.cmml"><mn id="S3.I1.i1.p1.1.m1.1.1.3.3.2" xref="S3.I1.i1.p1.1.m1.1.1.3.3.2.cmml">0</mn><mi id="S3.I1.i1.p1.1.m1.1.1.3.3.3" xref="S3.I1.i1.p1.1.m1.1.1.3.3.3.cmml">K</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><apply id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><eq id="S3.I1.i1.p1.1.m1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1"></eq><apply id="S3.I1.i1.p1.1.m1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2"><ci id="S3.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.1">¯</ci><ci id="S3.I1.i1.p1.1.m1.1.1.2.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2.2">𝑢</ci></apply><apply id="S3.I1.i1.p1.1.m1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3"><times id="S3.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.1"></times><apply id="S3.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.1.1.3.2.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.1.1.3.2.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.2.2">𝑢</ci><apply id="S3.I1.i1.p1.1.m1.1.1.3.2.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.2.3"><ci id="S3.I1.i1.p1.1.m1.1.1.3.2.3.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.2.3.1">:</ci><cn id="S3.I1.i1.p1.1.m1.1.1.3.2.3.2.cmml" type="integer" xref="S3.I1.i1.p1.1.m1.1.1.3.2.3.2">1</cn><ci id="S3.I1.i1.p1.1.m1.1.1.3.2.3.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.2.3.3">𝐿</ci></apply></apply><apply id="S3.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.3">subscript</csymbol><cn id="S3.I1.i1.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.I1.i1.p1.1.m1.1.1.3.3.2">0</cn><ci id="S3.I1.i1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">\bar{u}=u_{1:L}0_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.1d">over¯ start_ARG italic_u end_ARG = italic_u start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT 0 start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, note that <math alttext="C_{j}=[\bar{u}*\phi]_{L+j}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.1"><semantics id="S3.I1.i1.p1.2.m2.1a"><mrow id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml"><msub id="S3.I1.i1.p1.2.m2.1.1.3" xref="S3.I1.i1.p1.2.m2.1.1.3.cmml"><mi id="S3.I1.i1.p1.2.m2.1.1.3.2" xref="S3.I1.i1.p1.2.m2.1.1.3.2.cmml">C</mi><mi id="S3.I1.i1.p1.2.m2.1.1.3.3" xref="S3.I1.i1.p1.2.m2.1.1.3.3.cmml">j</mi></msub><mo id="S3.I1.i1.p1.2.m2.1.1.2" xref="S3.I1.i1.p1.2.m2.1.1.2.cmml">=</mo><msub id="S3.I1.i1.p1.2.m2.1.1.1" xref="S3.I1.i1.p1.2.m2.1.1.1.cmml"><mrow id="S3.I1.i1.p1.2.m2.1.1.1.1.1" xref="S3.I1.i1.p1.2.m2.1.1.1.1.2.cmml"><mo id="S3.I1.i1.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.I1.i1.p1.2.m2.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2.cmml"><mi id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2.2" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2.2.cmml">u</mi><mo id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2.1" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><mo id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.1.cmml">∗</mo><mi id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.3" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.3.cmml">ϕ</mi></mrow><mo id="S3.I1.i1.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.I1.i1.p1.2.m2.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.I1.i1.p1.2.m2.1.1.1.3" xref="S3.I1.i1.p1.2.m2.1.1.1.3.cmml"><mi id="S3.I1.i1.p1.2.m2.1.1.1.3.2" xref="S3.I1.i1.p1.2.m2.1.1.1.3.2.cmml">L</mi><mo id="S3.I1.i1.p1.2.m2.1.1.1.3.1" xref="S3.I1.i1.p1.2.m2.1.1.1.3.1.cmml">+</mo><mi id="S3.I1.i1.p1.2.m2.1.1.1.3.3" xref="S3.I1.i1.p1.2.m2.1.1.1.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><apply id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1"><eq id="S3.I1.i1.p1.2.m2.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.2"></eq><apply id="S3.I1.i1.p1.2.m2.1.1.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.2.m2.1.1.3.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.I1.i1.p1.2.m2.1.1.3.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3.2">𝐶</ci><ci id="S3.I1.i1.p1.2.m2.1.1.3.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3.3">𝑗</ci></apply><apply id="S3.I1.i1.p1.2.m2.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.2.m2.1.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1">subscript</csymbol><apply id="S3.I1.i1.p1.2.m2.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.I1.i1.p1.2.m2.1.1.1.1.2.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1"><times id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.1"></times><apply id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2"><ci id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2.1">¯</ci><ci id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.2.2">𝑢</ci></apply><ci id="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1.1.1.3">italic-ϕ</ci></apply></apply><apply id="S3.I1.i1.p1.2.m2.1.1.1.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.3"><plus id="S3.I1.i1.p1.2.m2.1.1.1.3.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.3.1"></plus><ci id="S3.I1.i1.p1.2.m2.1.1.1.3.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.3.2">𝐿</ci><ci id="S3.I1.i1.p1.2.m2.1.1.1.3.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">C_{j}=[\bar{u}*\phi]_{L+j}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.2.m2.1d">italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = [ over¯ start_ARG italic_u end_ARG ∗ italic_ϕ ] start_POSTSUBSCRIPT italic_L + italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. We can thus compute all <math alttext="K" class="ltx_Math" display="inline" id="S3.I1.i1.p1.3.m3.1"><semantics id="S3.I1.i1.p1.3.m3.1a"><mi id="S3.I1.i1.p1.3.m3.1.1" xref="S3.I1.i1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.1b"><ci id="S3.I1.i1.p1.3.m3.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.3.m3.1d">italic_K</annotation></semantics></math> values <math alttext="C_{1}\ldots C_{K}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.4.m4.1"><semantics id="S3.I1.i1.p1.4.m4.1a"><mrow id="S3.I1.i1.p1.4.m4.1.1" xref="S3.I1.i1.p1.4.m4.1.1.cmml"><msub id="S3.I1.i1.p1.4.m4.1.1.2" xref="S3.I1.i1.p1.4.m4.1.1.2.cmml"><mi id="S3.I1.i1.p1.4.m4.1.1.2.2" xref="S3.I1.i1.p1.4.m4.1.1.2.2.cmml">C</mi><mn id="S3.I1.i1.p1.4.m4.1.1.2.3" xref="S3.I1.i1.p1.4.m4.1.1.2.3.cmml">1</mn></msub><mo id="S3.I1.i1.p1.4.m4.1.1.1" xref="S3.I1.i1.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S3.I1.i1.p1.4.m4.1.1.3" mathvariant="normal" xref="S3.I1.i1.p1.4.m4.1.1.3.cmml">…</mi><mo id="S3.I1.i1.p1.4.m4.1.1.1a" xref="S3.I1.i1.p1.4.m4.1.1.1.cmml">⁢</mo><msub id="S3.I1.i1.p1.4.m4.1.1.4" xref="S3.I1.i1.p1.4.m4.1.1.4.cmml"><mi id="S3.I1.i1.p1.4.m4.1.1.4.2" xref="S3.I1.i1.p1.4.m4.1.1.4.2.cmml">C</mi><mi id="S3.I1.i1.p1.4.m4.1.1.4.3" xref="S3.I1.i1.p1.4.m4.1.1.4.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.4.m4.1b"><apply id="S3.I1.i1.p1.4.m4.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1"><times id="S3.I1.i1.p1.4.m4.1.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1.1"></times><apply id="S3.I1.i1.p1.4.m4.1.1.2.cmml" xref="S3.I1.i1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.4.m4.1.1.2.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.I1.i1.p1.4.m4.1.1.2.2.cmml" xref="S3.I1.i1.p1.4.m4.1.1.2.2">𝐶</ci><cn id="S3.I1.i1.p1.4.m4.1.1.2.3.cmml" type="integer" xref="S3.I1.i1.p1.4.m4.1.1.2.3">1</cn></apply><ci id="S3.I1.i1.p1.4.m4.1.1.3.cmml" xref="S3.I1.i1.p1.4.m4.1.1.3">…</ci><apply id="S3.I1.i1.p1.4.m4.1.1.4.cmml" xref="S3.I1.i1.p1.4.m4.1.1.4"><csymbol cd="ambiguous" id="S3.I1.i1.p1.4.m4.1.1.4.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1.4">subscript</csymbol><ci id="S3.I1.i1.p1.4.m4.1.1.4.2.cmml" xref="S3.I1.i1.p1.4.m4.1.1.4.2">𝐶</ci><ci id="S3.I1.i1.p1.4.m4.1.1.4.3.cmml" xref="S3.I1.i1.p1.4.m4.1.1.4.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.4.m4.1c">C_{1}\ldots C_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.4.m4.1d">italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_C start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> via one application of FFT which in total takes time <math alttext="O((L+K)\log(L+K))" class="ltx_Math" display="inline" id="S3.I1.i1.p1.5.m5.2"><semantics id="S3.I1.i1.p1.5.m5.2a"><mrow id="S3.I1.i1.p1.5.m5.2.2" xref="S3.I1.i1.p1.5.m5.2.2.cmml"><mi id="S3.I1.i1.p1.5.m5.2.2.3" xref="S3.I1.i1.p1.5.m5.2.2.3.cmml">O</mi><mo id="S3.I1.i1.p1.5.m5.2.2.2" xref="S3.I1.i1.p1.5.m5.2.2.2.cmml">⁢</mo><mrow id="S3.I1.i1.p1.5.m5.2.2.1.1" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.cmml"><mo id="S3.I1.i1.p1.5.m5.2.2.1.1.2" stretchy="false" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.cmml">(</mo><mrow id="S3.I1.i1.p1.5.m5.2.2.1.1.1" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.cmml"><mrow id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.cmml"><mo id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.cmml"><mi id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.2" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.2.cmml">L</mi><mo id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.1" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.3" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.3.cmml">K</mi></mrow><mo id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.I1.i1.p1.5.m5.2.2.1.1.1.3" lspace="0.167em" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.3.cmml">⁢</mo><mrow id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.2.cmml"><mi id="S3.I1.i1.p1.5.m5.1.1" xref="S3.I1.i1.p1.5.m5.1.1.cmml">log</mi><mo id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1a" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.2.cmml">⁡</mo><mrow id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.2.cmml"><mo id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.2" stretchy="false" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.2.cmml">(</mo><mrow id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.cmml"><mi id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.2" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.2.cmml">L</mi><mo id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.1" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.1.cmml">+</mo><mi id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.3" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.3.cmml">K</mi></mrow><mo id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.3" stretchy="false" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.I1.i1.p1.5.m5.2.2.1.1.3" stretchy="false" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.5.m5.2b"><apply id="S3.I1.i1.p1.5.m5.2.2.cmml" xref="S3.I1.i1.p1.5.m5.2.2"><times id="S3.I1.i1.p1.5.m5.2.2.2.cmml" xref="S3.I1.i1.p1.5.m5.2.2.2"></times><ci id="S3.I1.i1.p1.5.m5.2.2.3.cmml" xref="S3.I1.i1.p1.5.m5.2.2.3">𝑂</ci><apply id="S3.I1.i1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1"><times id="S3.I1.i1.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.3"></times><apply id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1"><plus id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.1"></plus><ci id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.2">𝐿</ci><ci id="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.3.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.1.1.1.3">𝐾</ci></apply><apply id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.2.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1"><log id="S3.I1.i1.p1.5.m5.1.1.cmml" xref="S3.I1.i1.p1.5.m5.1.1"></log><apply id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1"><plus id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.1.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.1"></plus><ci id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.2.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.2">𝐿</ci><ci id="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.3.cmml" xref="S3.I1.i1.p1.5.m5.2.2.1.1.1.2.1.1.1.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.5.m5.2c">O((L+K)\log(L+K))</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.5.m5.2d">italic_O ( ( italic_L + italic_K ) roman_log ( italic_L + italic_K ) )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.4">The computation in Line <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg1.l4" title="In Algorithm 1 ‣ 3 Fast auto-regressive generation using a prefill cache ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">4</span></a> splits into two parts, where one term we have already computed and stored as <math alttext="C_{j}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><msub id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml">C</mi><mi id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">𝐶</ci><ci id="S3.I1.i2.p1.1.m1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">C_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> earlier and the other term is a sum of <math alttext="\tau" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.1"><semantics id="S3.I1.i2.p1.2.m2.1a"><mi id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><ci id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.2.m2.1d">italic_τ</annotation></semantics></math> products, and thus a total compute of <math alttext="\tau" class="ltx_Math" display="inline" id="S3.I1.i2.p1.3.m3.1"><semantics id="S3.I1.i2.p1.3.m3.1a"><mi id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.1b"><ci id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.3.m3.1d">italic_τ</annotation></semantics></math>. The overall complexity of this phase is obtained by summing over <math alttext="K" class="ltx_Math" display="inline" id="S3.I1.i2.p1.4.m4.1"><semantics id="S3.I1.i2.p1.4.m4.1a"><mi id="S3.I1.i2.p1.4.m4.1.1" xref="S3.I1.i2.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.4.m4.1b"><ci id="S3.I1.i2.p1.4.m4.1.1.cmml" xref="S3.I1.i2.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.4.m4.1d">italic_K</annotation></semantics></math> consecutive iterations which gives</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{\tau=1}^{K}\tau=O(K^{2})." class="ltx_Math" display="block" id="S3.Ex13.m1.1"><semantics id="S3.Ex13.m1.1a"><mrow id="S3.Ex13.m1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.cmml"><mrow id="S3.Ex13.m1.1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.cmml"><mrow id="S3.Ex13.m1.1.1.1.1.3" xref="S3.Ex13.m1.1.1.1.1.3.cmml"><munderover id="S3.Ex13.m1.1.1.1.1.3.1" xref="S3.Ex13.m1.1.1.1.1.3.1.cmml"><mo id="S3.Ex13.m1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.Ex13.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.Ex13.m1.1.1.1.1.3.1.2.3" xref="S3.Ex13.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.Ex13.m1.1.1.1.1.3.1.2.3.2" xref="S3.Ex13.m1.1.1.1.1.3.1.2.3.2.cmml">τ</mi><mo id="S3.Ex13.m1.1.1.1.1.3.1.2.3.1" xref="S3.Ex13.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.Ex13.m1.1.1.1.1.3.1.2.3.3" xref="S3.Ex13.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex13.m1.1.1.1.1.3.1.3" xref="S3.Ex13.m1.1.1.1.1.3.1.3.cmml">K</mi></munderover><mi id="S3.Ex13.m1.1.1.1.1.3.2" xref="S3.Ex13.m1.1.1.1.1.3.2.cmml">τ</mi></mrow><mo id="S3.Ex13.m1.1.1.1.1.2" xref="S3.Ex13.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex13.m1.1.1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.1.cmml"><mi id="S3.Ex13.m1.1.1.1.1.1.3" xref="S3.Ex13.m1.1.1.1.1.1.3.cmml">O</mi><mo id="S3.Ex13.m1.1.1.1.1.1.2" xref="S3.Ex13.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex13.m1.1.1.1.1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex13.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex13.m1.1.1.1.1.1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex13.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.2.cmml">K</mi><mn id="S3.Ex13.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.Ex13.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex13.m1.1.1.1.2" lspace="0em" xref="S3.Ex13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex13.m1.1b"><apply id="S3.Ex13.m1.1.1.1.1.cmml" xref="S3.Ex13.m1.1.1.1"><eq id="S3.Ex13.m1.1.1.1.1.2.cmml" xref="S3.Ex13.m1.1.1.1.1.2"></eq><apply id="S3.Ex13.m1.1.1.1.1.3.cmml" xref="S3.Ex13.m1.1.1.1.1.3"><apply id="S3.Ex13.m1.1.1.1.1.3.1.cmml" xref="S3.Ex13.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex13.m1.1.1.1.1.3.1.1.cmml" xref="S3.Ex13.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.Ex13.m1.1.1.1.1.3.1.2.cmml" xref="S3.Ex13.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex13.m1.1.1.1.1.3.1.2.1.cmml" xref="S3.Ex13.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.Ex13.m1.1.1.1.1.3.1.2.2.cmml" xref="S3.Ex13.m1.1.1.1.1.3.1.2.2"></sum><apply id="S3.Ex13.m1.1.1.1.1.3.1.2.3.cmml" xref="S3.Ex13.m1.1.1.1.1.3.1.2.3"><eq id="S3.Ex13.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.Ex13.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.Ex13.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.Ex13.m1.1.1.1.1.3.1.2.3.2">𝜏</ci><cn id="S3.Ex13.m1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.Ex13.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex13.m1.1.1.1.1.3.1.3.cmml" xref="S3.Ex13.m1.1.1.1.1.3.1.3">𝐾</ci></apply><ci id="S3.Ex13.m1.1.1.1.1.3.2.cmml" xref="S3.Ex13.m1.1.1.1.1.3.2">𝜏</ci></apply><apply id="S3.Ex13.m1.1.1.1.1.1.cmml" xref="S3.Ex13.m1.1.1.1.1.1"><times id="S3.Ex13.m1.1.1.1.1.1.2.cmml" xref="S3.Ex13.m1.1.1.1.1.1.2"></times><ci id="S3.Ex13.m1.1.1.1.1.1.3.cmml" xref="S3.Ex13.m1.1.1.1.1.1.3">𝑂</ci><apply id="S3.Ex13.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex13.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex13.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.2">𝐾</ci><cn id="S3.Ex13.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex13.m1.1c">\sum_{\tau=1}^{K}\tau=O(K^{2}).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex13.m1.1d">∑ start_POSTSUBSCRIPT italic_τ = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_τ = italic_O ( italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
</ol>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS0.SSS0.Px1.2.p2">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.2.p2.1">The overall complexity of the algorithm is the sum of the above parts and thus <math alttext="O(L\log(L)+K^{2})." class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.2.p2.1.m1.3"><semantics id="S3.SS0.SSS0.Px1.2.p2.1.m1.3a"><mrow id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.cmml"><mrow id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.3" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.3.cmml">O</mi><mo id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.2" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.2" stretchy="false" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.2" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.2.cmml">L</mi><mo id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.1" lspace="0.167em" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.2" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.1.cmml"><mi id="S3.SS0.SSS0.Px1.2.p2.1.m1.1.1" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.1.1.cmml">log</mi><mo id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.2a" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.1.cmml">⁡</mo><mrow id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.2.1" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.1.cmml"><mo id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.2.1.1" stretchy="false" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px1.2.p2.1.m1.2.2" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.2.2.cmml">L</mi><mo id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.2.1.2" stretchy="false" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.1.cmml">+</mo><msup id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.2.cmml">K</mi><mn id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.3" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.3" stretchy="false" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.2" lspace="0em" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.2.p2.1.m1.3b"><apply id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1"><times id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.2"></times><ci id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.3">𝑂</ci><apply id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1"><plus id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.1"></plus><apply id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2"><times id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.1"></times><ci id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.2">𝐿</ci><apply id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.1.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.2.3.2"><log id="S3.SS0.SSS0.Px1.2.p2.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.1.1"></log><ci id="S3.SS0.SSS0.Px1.2.p2.1.m1.2.2.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.2.2">𝐿</ci></apply></apply><apply id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.2">𝐾</ci><cn id="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS0.SSS0.Px1.2.p2.1.m1.3.3.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.2.p2.1.m1.3c">O(L\log(L)+K^{2}).</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.2.p2.1.m1.3d">italic_O ( italic_L roman_log ( italic_L ) + italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) .</annotation></semantics></math></p>
</div>
<div class="ltx_para" id="S3.SS0.SSS0.Px1.3.p3">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.3.p3.1">∎</p>
</div>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Fast Online Convolutional Prediction</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">The technique of the previous section can naturally be applied to online prediction using a convolutional model in full generality: we describe a setting of online generation without any given prompts. We give the algorithm in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg2" title="Algorithm 2 ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">2</span></a>, then describe how it can be used for a particular convolutional model of interest, the Spectral Transform Unit from <cite class="ltx_cite ltx_citemacro_cite">Agarwal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib1" title="">2023</a>)</cite>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Efficient Online Convolutional Prediction</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l1.1">Input:</span> Convolutional filter <math alttext="\phi" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">italic_ϕ</annotation></semantics></math> w. context length <math alttext="L&gt;0" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mrow id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><mi id="alg2.l1.m2.1.1.2" xref="alg2.l1.m2.1.1.2.cmml">L</mi><mo id="alg2.l1.m2.1.1.1" xref="alg2.l1.m2.1.1.1.cmml">&gt;</mo><mn id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><gt id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1.1"></gt><ci id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1.2">𝐿</ci><cn id="alg2.l1.m2.1.1.3.cmml" type="integer" xref="alg2.l1.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">L&gt;0</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_L &gt; 0</annotation></semantics></math>. Set <math alttext="\tau=1" class="ltx_Math" display="inline" id="alg2.l1.m3.1"><semantics id="alg2.l1.m3.1a"><mrow id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml"><mi id="alg2.l1.m3.1.1.2" xref="alg2.l1.m3.1.1.2.cmml">τ</mi><mo id="alg2.l1.m3.1.1.1" xref="alg2.l1.m3.1.1.1.cmml">=</mo><mn id="alg2.l1.m3.1.1.3" xref="alg2.l1.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><apply id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1"><eq id="alg2.l1.m3.1.1.1.cmml" xref="alg2.l1.m3.1.1.1"></eq><ci id="alg2.l1.m3.1.1.2.cmml" xref="alg2.l1.m3.1.1.2">𝜏</ci><cn id="alg2.l1.m3.1.1.3.cmml" type="integer" xref="alg2.l1.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">\tau=1</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m3.1d">italic_τ = 1</annotation></semantics></math> and <math alttext="K=\sqrt{L\log L}" class="ltx_Math" display="inline" id="alg2.l1.m4.1"><semantics id="alg2.l1.m4.1a"><mrow id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml"><mi id="alg2.l1.m4.1.1.2" xref="alg2.l1.m4.1.1.2.cmml">K</mi><mo id="alg2.l1.m4.1.1.1" xref="alg2.l1.m4.1.1.1.cmml">=</mo><msqrt id="alg2.l1.m4.1.1.3" xref="alg2.l1.m4.1.1.3.cmml"><mrow id="alg2.l1.m4.1.1.3.2" xref="alg2.l1.m4.1.1.3.2.cmml"><mi id="alg2.l1.m4.1.1.3.2.2" xref="alg2.l1.m4.1.1.3.2.2.cmml">L</mi><mo id="alg2.l1.m4.1.1.3.2.1" lspace="0.167em" xref="alg2.l1.m4.1.1.3.2.1.cmml">⁢</mo><mrow id="alg2.l1.m4.1.1.3.2.3" xref="alg2.l1.m4.1.1.3.2.3.cmml"><mi id="alg2.l1.m4.1.1.3.2.3.1" xref="alg2.l1.m4.1.1.3.2.3.1.cmml">log</mi><mo id="alg2.l1.m4.1.1.3.2.3a" lspace="0.167em" xref="alg2.l1.m4.1.1.3.2.3.cmml">⁡</mo><mi id="alg2.l1.m4.1.1.3.2.3.2" xref="alg2.l1.m4.1.1.3.2.3.2.cmml">L</mi></mrow></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><apply id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1"><eq id="alg2.l1.m4.1.1.1.cmml" xref="alg2.l1.m4.1.1.1"></eq><ci id="alg2.l1.m4.1.1.2.cmml" xref="alg2.l1.m4.1.1.2">𝐾</ci><apply id="alg2.l1.m4.1.1.3.cmml" xref="alg2.l1.m4.1.1.3"><root id="alg2.l1.m4.1.1.3a.cmml" xref="alg2.l1.m4.1.1.3"></root><apply id="alg2.l1.m4.1.1.3.2.cmml" xref="alg2.l1.m4.1.1.3.2"><times id="alg2.l1.m4.1.1.3.2.1.cmml" xref="alg2.l1.m4.1.1.3.2.1"></times><ci id="alg2.l1.m4.1.1.3.2.2.cmml" xref="alg2.l1.m4.1.1.3.2.2">𝐿</ci><apply id="alg2.l1.m4.1.1.3.2.3.cmml" xref="alg2.l1.m4.1.1.3.2.3"><log id="alg2.l1.m4.1.1.3.2.3.1.cmml" xref="alg2.l1.m4.1.1.3.2.3.1"></log><ci id="alg2.l1.m4.1.1.3.2.3.2.cmml" xref="alg2.l1.m4.1.1.3.2.3.2">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">K=\sqrt{L\log L}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m4.1d">italic_K = square-root start_ARG italic_L roman_log italic_L end_ARG</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l2.1">for</span> <math alttext="t=1,2,...,L" class="ltx_Math" display="inline" id="alg2.l2.m1.4"><semantics id="alg2.l2.m1.4a"><mrow id="alg2.l2.m1.4.5" xref="alg2.l2.m1.4.5.cmml"><mi id="alg2.l2.m1.4.5.2" xref="alg2.l2.m1.4.5.2.cmml">t</mi><mo id="alg2.l2.m1.4.5.1" xref="alg2.l2.m1.4.5.1.cmml">=</mo><mrow id="alg2.l2.m1.4.5.3.2" xref="alg2.l2.m1.4.5.3.1.cmml"><mn id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">1</mn><mo id="alg2.l2.m1.4.5.3.2.1" xref="alg2.l2.m1.4.5.3.1.cmml">,</mo><mn id="alg2.l2.m1.2.2" xref="alg2.l2.m1.2.2.cmml">2</mn><mo id="alg2.l2.m1.4.5.3.2.2" xref="alg2.l2.m1.4.5.3.1.cmml">,</mo><mi id="alg2.l2.m1.3.3" mathvariant="normal" xref="alg2.l2.m1.3.3.cmml">…</mi><mo id="alg2.l2.m1.4.5.3.2.3" xref="alg2.l2.m1.4.5.3.1.cmml">,</mo><mi id="alg2.l2.m1.4.4" xref="alg2.l2.m1.4.4.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.4b"><apply id="alg2.l2.m1.4.5.cmml" xref="alg2.l2.m1.4.5"><eq id="alg2.l2.m1.4.5.1.cmml" xref="alg2.l2.m1.4.5.1"></eq><ci id="alg2.l2.m1.4.5.2.cmml" xref="alg2.l2.m1.4.5.2">𝑡</ci><list id="alg2.l2.m1.4.5.3.1.cmml" xref="alg2.l2.m1.4.5.3.2"><cn id="alg2.l2.m1.1.1.cmml" type="integer" xref="alg2.l2.m1.1.1">1</cn><cn id="alg2.l2.m1.2.2.cmml" type="integer" xref="alg2.l2.m1.2.2">2</cn><ci id="alg2.l2.m1.3.3.cmml" xref="alg2.l2.m1.3.3">…</ci><ci id="alg2.l2.m1.4.4.cmml" xref="alg2.l2.m1.4.4">𝐿</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.4c">t=1,2,...,L</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.4d">italic_t = 1 , 2 , … , italic_L</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l2.2">do</span>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <span class="ltx_text ltx_font_bold" id="alg2.l3.1">if</span>  <math alttext="\tau&gt;K" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">τ</mi><mo id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">&gt;</mo><mi id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><gt id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></gt><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝜏</ci><ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">\tau&gt;K</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">italic_τ &gt; italic_K</annotation></semantics></math>  <span class="ltx_text ltx_font_bold" id="alg2.l3.2">then</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>        Compute via FFT convolution the following <math alttext="K" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mi id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">italic_K</annotation></semantics></math> inner products and store them in a cache <math alttext="\{C_{1}\ldots C_{K}\},C_{i}\in\mathbb{R}^{d_{u}}" class="ltx_Math" display="inline" id="alg2.l4.m2.2"><semantics id="alg2.l4.m2.2a"><mrow id="alg2.l4.m2.2.2" xref="alg2.l4.m2.2.2.cmml"><mrow id="alg2.l4.m2.2.2.2.2" xref="alg2.l4.m2.2.2.2.3.cmml"><mrow id="alg2.l4.m2.1.1.1.1.1.1" xref="alg2.l4.m2.1.1.1.1.1.2.cmml"><mo id="alg2.l4.m2.1.1.1.1.1.1.2" stretchy="false" xref="alg2.l4.m2.1.1.1.1.1.2.cmml">{</mo><mrow id="alg2.l4.m2.1.1.1.1.1.1.1" xref="alg2.l4.m2.1.1.1.1.1.1.1.cmml"><msub id="alg2.l4.m2.1.1.1.1.1.1.1.2" xref="alg2.l4.m2.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l4.m2.1.1.1.1.1.1.1.2.2" xref="alg2.l4.m2.1.1.1.1.1.1.1.2.2.cmml">C</mi><mn id="alg2.l4.m2.1.1.1.1.1.1.1.2.3" xref="alg2.l4.m2.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="alg2.l4.m2.1.1.1.1.1.1.1.1" xref="alg2.l4.m2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.1.1.1.1.1.3" mathvariant="normal" xref="alg2.l4.m2.1.1.1.1.1.1.1.3.cmml">…</mi><mo id="alg2.l4.m2.1.1.1.1.1.1.1.1a" xref="alg2.l4.m2.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg2.l4.m2.1.1.1.1.1.1.1.4" xref="alg2.l4.m2.1.1.1.1.1.1.1.4.cmml"><mi id="alg2.l4.m2.1.1.1.1.1.1.1.4.2" xref="alg2.l4.m2.1.1.1.1.1.1.1.4.2.cmml">C</mi><mi id="alg2.l4.m2.1.1.1.1.1.1.1.4.3" xref="alg2.l4.m2.1.1.1.1.1.1.1.4.3.cmml">K</mi></msub></mrow><mo id="alg2.l4.m2.1.1.1.1.1.1.3" stretchy="false" xref="alg2.l4.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="alg2.l4.m2.2.2.2.2.3" xref="alg2.l4.m2.2.2.2.3.cmml">,</mo><msub id="alg2.l4.m2.2.2.2.2.2" xref="alg2.l4.m2.2.2.2.2.2.cmml"><mi id="alg2.l4.m2.2.2.2.2.2.2" xref="alg2.l4.m2.2.2.2.2.2.2.cmml">C</mi><mi id="alg2.l4.m2.2.2.2.2.2.3" xref="alg2.l4.m2.2.2.2.2.2.3.cmml">i</mi></msub></mrow><mo id="alg2.l4.m2.2.2.3" xref="alg2.l4.m2.2.2.3.cmml">∈</mo><msup id="alg2.l4.m2.2.2.4" xref="alg2.l4.m2.2.2.4.cmml"><mi id="alg2.l4.m2.2.2.4.2" xref="alg2.l4.m2.2.2.4.2.cmml">ℝ</mi><msub id="alg2.l4.m2.2.2.4.3" xref="alg2.l4.m2.2.2.4.3.cmml"><mi id="alg2.l4.m2.2.2.4.3.2" xref="alg2.l4.m2.2.2.4.3.2.cmml">d</mi><mi id="alg2.l4.m2.2.2.4.3.3" xref="alg2.l4.m2.2.2.4.3.3.cmml">u</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.2b"><apply id="alg2.l4.m2.2.2.cmml" xref="alg2.l4.m2.2.2"><in id="alg2.l4.m2.2.2.3.cmml" xref="alg2.l4.m2.2.2.3"></in><list id="alg2.l4.m2.2.2.2.3.cmml" xref="alg2.l4.m2.2.2.2.2"><set id="alg2.l4.m2.1.1.1.1.1.2.cmml" xref="alg2.l4.m2.1.1.1.1.1.1"><apply id="alg2.l4.m2.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m2.1.1.1.1.1.1.1"><times id="alg2.l4.m2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m2.1.1.1.1.1.1.1.1"></times><apply id="alg2.l4.m2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l4.m2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l4.m2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l4.m2.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l4.m2.1.1.1.1.1.1.1.2.2">𝐶</ci><cn id="alg2.l4.m2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="alg2.l4.m2.1.1.1.1.1.1.1.2.3">1</cn></apply><ci id="alg2.l4.m2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l4.m2.1.1.1.1.1.1.1.3">…</ci><apply id="alg2.l4.m2.1.1.1.1.1.1.1.4.cmml" xref="alg2.l4.m2.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.1.1.1.1.1.4.1.cmml" xref="alg2.l4.m2.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg2.l4.m2.1.1.1.1.1.1.1.4.2.cmml" xref="alg2.l4.m2.1.1.1.1.1.1.1.4.2">𝐶</ci><ci id="alg2.l4.m2.1.1.1.1.1.1.1.4.3.cmml" xref="alg2.l4.m2.1.1.1.1.1.1.1.4.3">𝐾</ci></apply></apply></set><apply id="alg2.l4.m2.2.2.2.2.2.cmml" xref="alg2.l4.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l4.m2.2.2.2.2.2.1.cmml" xref="alg2.l4.m2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l4.m2.2.2.2.2.2.2.cmml" xref="alg2.l4.m2.2.2.2.2.2.2">𝐶</ci><ci id="alg2.l4.m2.2.2.2.2.2.3.cmml" xref="alg2.l4.m2.2.2.2.2.2.3">𝑖</ci></apply></list><apply id="alg2.l4.m2.2.2.4.cmml" xref="alg2.l4.m2.2.2.4"><csymbol cd="ambiguous" id="alg2.l4.m2.2.2.4.1.cmml" xref="alg2.l4.m2.2.2.4">superscript</csymbol><ci id="alg2.l4.m2.2.2.4.2.cmml" xref="alg2.l4.m2.2.2.4.2">ℝ</ci><apply id="alg2.l4.m2.2.2.4.3.cmml" xref="alg2.l4.m2.2.2.4.3"><csymbol cd="ambiguous" id="alg2.l4.m2.2.2.4.3.1.cmml" xref="alg2.l4.m2.2.2.4.3">subscript</csymbol><ci id="alg2.l4.m2.2.2.4.3.2.cmml" xref="alg2.l4.m2.2.2.4.3.2">𝑑</ci><ci id="alg2.l4.m2.2.2.4.3.3.cmml" xref="alg2.l4.m2.2.2.4.3.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.2c">\{C_{1}\ldots C_{K}\},C_{i}\in\mathbb{R}^{d_{u}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m2.2d">{ italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT … italic_C start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT } , italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\forall j\in\{1,...,K\}\ \ ,\ \ C_{j}\leftarrow\langle\phi_{1:t+j},0_{j}u_{t:1%
}\rangle=\langle\phi_{j+1:t+j},u_{t:1}\rangle" class="ltx_math_unparsed" display="block" id="S4.Ex14.m1.3"><semantics id="S4.Ex14.m1.3a"><mrow id="S4.Ex14.m1.3b"><mo id="S4.Ex14.m1.3.4" rspace="0.167em">∀</mo><mi id="S4.Ex14.m1.3.5">j</mi><mo id="S4.Ex14.m1.3.6">∈</mo><mrow id="S4.Ex14.m1.3.7"><mo id="S4.Ex14.m1.3.7.1" stretchy="false">{</mo><mn id="S4.Ex14.m1.1.1">1</mn><mo id="S4.Ex14.m1.3.7.2">,</mo><mi id="S4.Ex14.m1.2.2" mathvariant="normal">…</mi><mo id="S4.Ex14.m1.3.7.3">,</mo><mi id="S4.Ex14.m1.3.3">K</mi><mo id="S4.Ex14.m1.3.7.4" stretchy="false">}</mo></mrow><mspace id="S4.Ex14.m1.3.8" width="1em"></mspace><mo id="S4.Ex14.m1.3.9" rspace="1.167em">,</mo><msub id="S4.Ex14.m1.3.10"><mi id="S4.Ex14.m1.3.10.2">C</mi><mi id="S4.Ex14.m1.3.10.3">j</mi></msub><mo id="S4.Ex14.m1.3.11" stretchy="false">←</mo><mrow id="S4.Ex14.m1.3.12"><mo id="S4.Ex14.m1.3.12.1" stretchy="false">⟨</mo><msub id="S4.Ex14.m1.3.12.2"><mi id="S4.Ex14.m1.3.12.2.2">ϕ</mi><mrow id="S4.Ex14.m1.3.12.2.3"><mn id="S4.Ex14.m1.3.12.2.3.2">1</mn><mo id="S4.Ex14.m1.3.12.2.3.1" lspace="0.278em" rspace="0.278em">:</mo><mrow id="S4.Ex14.m1.3.12.2.3.3"><mi id="S4.Ex14.m1.3.12.2.3.3.2">t</mi><mo id="S4.Ex14.m1.3.12.2.3.3.1">+</mo><mi id="S4.Ex14.m1.3.12.2.3.3.3">j</mi></mrow></mrow></msub><mo id="S4.Ex14.m1.3.12.3">,</mo><msub id="S4.Ex14.m1.3.12.4"><mn id="S4.Ex14.m1.3.12.4.2">0</mn><mi id="S4.Ex14.m1.3.12.4.3">j</mi></msub><msub id="S4.Ex14.m1.3.12.5"><mi id="S4.Ex14.m1.3.12.5.2">u</mi><mrow id="S4.Ex14.m1.3.12.5.3"><mi id="S4.Ex14.m1.3.12.5.3.2">t</mi><mo id="S4.Ex14.m1.3.12.5.3.1" lspace="0.278em" rspace="0.278em">:</mo><mn id="S4.Ex14.m1.3.12.5.3.3">1</mn></mrow></msub><mo id="S4.Ex14.m1.3.12.6" stretchy="false">⟩</mo></mrow><mo id="S4.Ex14.m1.3.13">=</mo><mrow id="S4.Ex14.m1.3.14"><mo id="S4.Ex14.m1.3.14.1" stretchy="false">⟨</mo><msub id="S4.Ex14.m1.3.14.2"><mi id="S4.Ex14.m1.3.14.2.2">ϕ</mi><mrow id="S4.Ex14.m1.3.14.2.3"><mrow id="S4.Ex14.m1.3.14.2.3.2"><mi id="S4.Ex14.m1.3.14.2.3.2.2">j</mi><mo id="S4.Ex14.m1.3.14.2.3.2.1">+</mo><mn id="S4.Ex14.m1.3.14.2.3.2.3">1</mn></mrow><mo id="S4.Ex14.m1.3.14.2.3.1" lspace="0.278em" rspace="0.278em">:</mo><mrow id="S4.Ex14.m1.3.14.2.3.3"><mi id="S4.Ex14.m1.3.14.2.3.3.2">t</mi><mo id="S4.Ex14.m1.3.14.2.3.3.1">+</mo><mi id="S4.Ex14.m1.3.14.2.3.3.3">j</mi></mrow></mrow></msub><mo id="S4.Ex14.m1.3.14.3">,</mo><msub id="S4.Ex14.m1.3.14.4"><mi id="S4.Ex14.m1.3.14.4.2">u</mi><mrow id="S4.Ex14.m1.3.14.4.3"><mi id="S4.Ex14.m1.3.14.4.3.2">t</mi><mo id="S4.Ex14.m1.3.14.4.3.1" lspace="0.278em" rspace="0.278em">:</mo><mn id="S4.Ex14.m1.3.14.4.3.3">1</mn></mrow></msub><mo id="S4.Ex14.m1.3.14.5" stretchy="false">⟩</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.Ex14.m1.3c">\forall j\in\{1,...,K\}\ \ ,\ \ C_{j}\leftarrow\langle\phi_{1:t+j},0_{j}u_{t:1%
}\rangle=\langle\phi_{j+1:t+j},u_{t:1}\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.Ex14.m1.3d">∀ italic_j ∈ { 1 , … , italic_K } , italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ← ⟨ italic_ϕ start_POSTSUBSCRIPT 1 : italic_t + italic_j end_POSTSUBSCRIPT , 0 start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_t : 1 end_POSTSUBSCRIPT ⟩ = ⟨ italic_ϕ start_POSTSUBSCRIPT italic_j + 1 : italic_t + italic_j end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_t : 1 end_POSTSUBSCRIPT ⟩</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>        Set <math alttext="\tau\leftarrow 1" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mi id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">τ</mi><mo id="alg2.l5.m1.1.1.1" stretchy="false" xref="alg2.l5.m1.1.1.1.cmml">←</mo><mn id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><ci id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1">←</ci><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">𝜏</ci><cn id="alg2.l5.m1.1.1.3.cmml" type="integer" xref="alg2.l5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\tau\leftarrow 1</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">italic_τ ← 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <span class="ltx_text ltx_font_bold" id="alg2.l6.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l6.2">if</span>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>      Compute and predict

<table class="ltx_equation ltx_eqn_table" id="S4.Ex15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}_{t}=\sum_{j=1}^{\tau}\phi_{j}u_{t+1-j}+\langle\phi_{\tau+1:t},u_{t-%
\tau:1}\rangle=\sum_{j=1}^{\tau}\phi_{j}u_{t+1-j}+C_{\tau}" class="ltx_Math" display="block" id="S4.Ex15.m1.2"><semantics id="S4.Ex15.m1.2a"><mrow id="S4.Ex15.m1.2.2" xref="S4.Ex15.m1.2.2.cmml"><msub id="S4.Ex15.m1.2.2.4" xref="S4.Ex15.m1.2.2.4.cmml"><mover accent="true" id="S4.Ex15.m1.2.2.4.2" xref="S4.Ex15.m1.2.2.4.2.cmml"><mi id="S4.Ex15.m1.2.2.4.2.2" xref="S4.Ex15.m1.2.2.4.2.2.cmml">y</mi><mo id="S4.Ex15.m1.2.2.4.2.1" xref="S4.Ex15.m1.2.2.4.2.1.cmml">^</mo></mover><mi id="S4.Ex15.m1.2.2.4.3" xref="S4.Ex15.m1.2.2.4.3.cmml">t</mi></msub><mo id="S4.Ex15.m1.2.2.5" rspace="0.111em" xref="S4.Ex15.m1.2.2.5.cmml">=</mo><mrow id="S4.Ex15.m1.2.2.2" xref="S4.Ex15.m1.2.2.2.cmml"><mrow id="S4.Ex15.m1.2.2.2.4" xref="S4.Ex15.m1.2.2.2.4.cmml"><munderover id="S4.Ex15.m1.2.2.2.4.1" xref="S4.Ex15.m1.2.2.2.4.1.cmml"><mo id="S4.Ex15.m1.2.2.2.4.1.2.2" movablelimits="false" xref="S4.Ex15.m1.2.2.2.4.1.2.2.cmml">∑</mo><mrow id="S4.Ex15.m1.2.2.2.4.1.2.3" xref="S4.Ex15.m1.2.2.2.4.1.2.3.cmml"><mi id="S4.Ex15.m1.2.2.2.4.1.2.3.2" xref="S4.Ex15.m1.2.2.2.4.1.2.3.2.cmml">j</mi><mo id="S4.Ex15.m1.2.2.2.4.1.2.3.1" xref="S4.Ex15.m1.2.2.2.4.1.2.3.1.cmml">=</mo><mn id="S4.Ex15.m1.2.2.2.4.1.2.3.3" xref="S4.Ex15.m1.2.2.2.4.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex15.m1.2.2.2.4.1.3" xref="S4.Ex15.m1.2.2.2.4.1.3.cmml">τ</mi></munderover><mrow id="S4.Ex15.m1.2.2.2.4.2" xref="S4.Ex15.m1.2.2.2.4.2.cmml"><msub id="S4.Ex15.m1.2.2.2.4.2.2" xref="S4.Ex15.m1.2.2.2.4.2.2.cmml"><mi id="S4.Ex15.m1.2.2.2.4.2.2.2" xref="S4.Ex15.m1.2.2.2.4.2.2.2.cmml">ϕ</mi><mi id="S4.Ex15.m1.2.2.2.4.2.2.3" xref="S4.Ex15.m1.2.2.2.4.2.2.3.cmml">j</mi></msub><mo id="S4.Ex15.m1.2.2.2.4.2.1" xref="S4.Ex15.m1.2.2.2.4.2.1.cmml">⁢</mo><msub id="S4.Ex15.m1.2.2.2.4.2.3" xref="S4.Ex15.m1.2.2.2.4.2.3.cmml"><mi id="S4.Ex15.m1.2.2.2.4.2.3.2" xref="S4.Ex15.m1.2.2.2.4.2.3.2.cmml">u</mi><mrow id="S4.Ex15.m1.2.2.2.4.2.3.3" xref="S4.Ex15.m1.2.2.2.4.2.3.3.cmml"><mrow id="S4.Ex15.m1.2.2.2.4.2.3.3.2" xref="S4.Ex15.m1.2.2.2.4.2.3.3.2.cmml"><mi id="S4.Ex15.m1.2.2.2.4.2.3.3.2.2" xref="S4.Ex15.m1.2.2.2.4.2.3.3.2.2.cmml">t</mi><mo id="S4.Ex15.m1.2.2.2.4.2.3.3.2.1" xref="S4.Ex15.m1.2.2.2.4.2.3.3.2.1.cmml">+</mo><mn id="S4.Ex15.m1.2.2.2.4.2.3.3.2.3" xref="S4.Ex15.m1.2.2.2.4.2.3.3.2.3.cmml">1</mn></mrow><mo id="S4.Ex15.m1.2.2.2.4.2.3.3.1" xref="S4.Ex15.m1.2.2.2.4.2.3.3.1.cmml">−</mo><mi id="S4.Ex15.m1.2.2.2.4.2.3.3.3" xref="S4.Ex15.m1.2.2.2.4.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S4.Ex15.m1.2.2.2.3" xref="S4.Ex15.m1.2.2.2.3.cmml">+</mo><mrow id="S4.Ex15.m1.2.2.2.2.2" xref="S4.Ex15.m1.2.2.2.2.3.cmml"><mo id="S4.Ex15.m1.2.2.2.2.2.3" stretchy="false" xref="S4.Ex15.m1.2.2.2.2.3.cmml">⟨</mo><msub id="S4.Ex15.m1.1.1.1.1.1.1" xref="S4.Ex15.m1.1.1.1.1.1.1.cmml"><mi id="S4.Ex15.m1.1.1.1.1.1.1.2" xref="S4.Ex15.m1.1.1.1.1.1.1.2.cmml">ϕ</mi><mrow id="S4.Ex15.m1.1.1.1.1.1.1.3" xref="S4.Ex15.m1.1.1.1.1.1.1.3.cmml"><mrow id="S4.Ex15.m1.1.1.1.1.1.1.3.2" xref="S4.Ex15.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex15.m1.1.1.1.1.1.1.3.2.2" xref="S4.Ex15.m1.1.1.1.1.1.1.3.2.2.cmml">τ</mi><mo id="S4.Ex15.m1.1.1.1.1.1.1.3.2.1" xref="S4.Ex15.m1.1.1.1.1.1.1.3.2.1.cmml">+</mo><mn id="S4.Ex15.m1.1.1.1.1.1.1.3.2.3" xref="S4.Ex15.m1.1.1.1.1.1.1.3.2.3.cmml">1</mn></mrow><mo id="S4.Ex15.m1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.Ex15.m1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S4.Ex15.m1.1.1.1.1.1.1.3.3" xref="S4.Ex15.m1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S4.Ex15.m1.2.2.2.2.2.4" xref="S4.Ex15.m1.2.2.2.2.3.cmml">,</mo><msub id="S4.Ex15.m1.2.2.2.2.2.2" xref="S4.Ex15.m1.2.2.2.2.2.2.cmml"><mi id="S4.Ex15.m1.2.2.2.2.2.2.2" xref="S4.Ex15.m1.2.2.2.2.2.2.2.cmml">u</mi><mrow id="S4.Ex15.m1.2.2.2.2.2.2.3" xref="S4.Ex15.m1.2.2.2.2.2.2.3.cmml"><mrow id="S4.Ex15.m1.2.2.2.2.2.2.3.2" xref="S4.Ex15.m1.2.2.2.2.2.2.3.2.cmml"><mi id="S4.Ex15.m1.2.2.2.2.2.2.3.2.2" xref="S4.Ex15.m1.2.2.2.2.2.2.3.2.2.cmml">t</mi><mo id="S4.Ex15.m1.2.2.2.2.2.2.3.2.1" xref="S4.Ex15.m1.2.2.2.2.2.2.3.2.1.cmml">−</mo><mi id="S4.Ex15.m1.2.2.2.2.2.2.3.2.3" xref="S4.Ex15.m1.2.2.2.2.2.2.3.2.3.cmml">τ</mi></mrow><mo id="S4.Ex15.m1.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.Ex15.m1.2.2.2.2.2.2.3.1.cmml">:</mo><mn id="S4.Ex15.m1.2.2.2.2.2.2.3.3" xref="S4.Ex15.m1.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.Ex15.m1.2.2.2.2.2.5" stretchy="false" xref="S4.Ex15.m1.2.2.2.2.3.cmml">⟩</mo></mrow></mrow><mo id="S4.Ex15.m1.2.2.6" rspace="0.111em" xref="S4.Ex15.m1.2.2.6.cmml">=</mo><mrow id="S4.Ex15.m1.2.2.7" xref="S4.Ex15.m1.2.2.7.cmml"><mrow id="S4.Ex15.m1.2.2.7.2" xref="S4.Ex15.m1.2.2.7.2.cmml"><munderover id="S4.Ex15.m1.2.2.7.2.1" xref="S4.Ex15.m1.2.2.7.2.1.cmml"><mo id="S4.Ex15.m1.2.2.7.2.1.2.2" movablelimits="false" xref="S4.Ex15.m1.2.2.7.2.1.2.2.cmml">∑</mo><mrow id="S4.Ex15.m1.2.2.7.2.1.2.3" xref="S4.Ex15.m1.2.2.7.2.1.2.3.cmml"><mi id="S4.Ex15.m1.2.2.7.2.1.2.3.2" xref="S4.Ex15.m1.2.2.7.2.1.2.3.2.cmml">j</mi><mo id="S4.Ex15.m1.2.2.7.2.1.2.3.1" xref="S4.Ex15.m1.2.2.7.2.1.2.3.1.cmml">=</mo><mn id="S4.Ex15.m1.2.2.7.2.1.2.3.3" xref="S4.Ex15.m1.2.2.7.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex15.m1.2.2.7.2.1.3" xref="S4.Ex15.m1.2.2.7.2.1.3.cmml">τ</mi></munderover><mrow id="S4.Ex15.m1.2.2.7.2.2" xref="S4.Ex15.m1.2.2.7.2.2.cmml"><msub id="S4.Ex15.m1.2.2.7.2.2.2" xref="S4.Ex15.m1.2.2.7.2.2.2.cmml"><mi id="S4.Ex15.m1.2.2.7.2.2.2.2" xref="S4.Ex15.m1.2.2.7.2.2.2.2.cmml">ϕ</mi><mi id="S4.Ex15.m1.2.2.7.2.2.2.3" xref="S4.Ex15.m1.2.2.7.2.2.2.3.cmml">j</mi></msub><mo id="S4.Ex15.m1.2.2.7.2.2.1" xref="S4.Ex15.m1.2.2.7.2.2.1.cmml">⁢</mo><msub id="S4.Ex15.m1.2.2.7.2.2.3" xref="S4.Ex15.m1.2.2.7.2.2.3.cmml"><mi id="S4.Ex15.m1.2.2.7.2.2.3.2" xref="S4.Ex15.m1.2.2.7.2.2.3.2.cmml">u</mi><mrow id="S4.Ex15.m1.2.2.7.2.2.3.3" xref="S4.Ex15.m1.2.2.7.2.2.3.3.cmml"><mrow id="S4.Ex15.m1.2.2.7.2.2.3.3.2" xref="S4.Ex15.m1.2.2.7.2.2.3.3.2.cmml"><mi id="S4.Ex15.m1.2.2.7.2.2.3.3.2.2" xref="S4.Ex15.m1.2.2.7.2.2.3.3.2.2.cmml">t</mi><mo id="S4.Ex15.m1.2.2.7.2.2.3.3.2.1" xref="S4.Ex15.m1.2.2.7.2.2.3.3.2.1.cmml">+</mo><mn id="S4.Ex15.m1.2.2.7.2.2.3.3.2.3" xref="S4.Ex15.m1.2.2.7.2.2.3.3.2.3.cmml">1</mn></mrow><mo id="S4.Ex15.m1.2.2.7.2.2.3.3.1" xref="S4.Ex15.m1.2.2.7.2.2.3.3.1.cmml">−</mo><mi id="S4.Ex15.m1.2.2.7.2.2.3.3.3" xref="S4.Ex15.m1.2.2.7.2.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S4.Ex15.m1.2.2.7.1" xref="S4.Ex15.m1.2.2.7.1.cmml">+</mo><msub id="S4.Ex15.m1.2.2.7.3" xref="S4.Ex15.m1.2.2.7.3.cmml"><mi id="S4.Ex15.m1.2.2.7.3.2" xref="S4.Ex15.m1.2.2.7.3.2.cmml">C</mi><mi id="S4.Ex15.m1.2.2.7.3.3" xref="S4.Ex15.m1.2.2.7.3.3.cmml">τ</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex15.m1.2b"><apply id="S4.Ex15.m1.2.2.cmml" xref="S4.Ex15.m1.2.2"><and id="S4.Ex15.m1.2.2a.cmml" xref="S4.Ex15.m1.2.2"></and><apply id="S4.Ex15.m1.2.2b.cmml" xref="S4.Ex15.m1.2.2"><eq id="S4.Ex15.m1.2.2.5.cmml" xref="S4.Ex15.m1.2.2.5"></eq><apply id="S4.Ex15.m1.2.2.4.cmml" xref="S4.Ex15.m1.2.2.4"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.4.1.cmml" xref="S4.Ex15.m1.2.2.4">subscript</csymbol><apply id="S4.Ex15.m1.2.2.4.2.cmml" xref="S4.Ex15.m1.2.2.4.2"><ci id="S4.Ex15.m1.2.2.4.2.1.cmml" xref="S4.Ex15.m1.2.2.4.2.1">^</ci><ci id="S4.Ex15.m1.2.2.4.2.2.cmml" xref="S4.Ex15.m1.2.2.4.2.2">𝑦</ci></apply><ci id="S4.Ex15.m1.2.2.4.3.cmml" xref="S4.Ex15.m1.2.2.4.3">𝑡</ci></apply><apply id="S4.Ex15.m1.2.2.2.cmml" xref="S4.Ex15.m1.2.2.2"><plus id="S4.Ex15.m1.2.2.2.3.cmml" xref="S4.Ex15.m1.2.2.2.3"></plus><apply id="S4.Ex15.m1.2.2.2.4.cmml" xref="S4.Ex15.m1.2.2.2.4"><apply id="S4.Ex15.m1.2.2.2.4.1.cmml" xref="S4.Ex15.m1.2.2.2.4.1"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.2.4.1.1.cmml" xref="S4.Ex15.m1.2.2.2.4.1">superscript</csymbol><apply id="S4.Ex15.m1.2.2.2.4.1.2.cmml" xref="S4.Ex15.m1.2.2.2.4.1"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.2.4.1.2.1.cmml" xref="S4.Ex15.m1.2.2.2.4.1">subscript</csymbol><sum id="S4.Ex15.m1.2.2.2.4.1.2.2.cmml" xref="S4.Ex15.m1.2.2.2.4.1.2.2"></sum><apply id="S4.Ex15.m1.2.2.2.4.1.2.3.cmml" xref="S4.Ex15.m1.2.2.2.4.1.2.3"><eq id="S4.Ex15.m1.2.2.2.4.1.2.3.1.cmml" xref="S4.Ex15.m1.2.2.2.4.1.2.3.1"></eq><ci id="S4.Ex15.m1.2.2.2.4.1.2.3.2.cmml" xref="S4.Ex15.m1.2.2.2.4.1.2.3.2">𝑗</ci><cn id="S4.Ex15.m1.2.2.2.4.1.2.3.3.cmml" type="integer" xref="S4.Ex15.m1.2.2.2.4.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex15.m1.2.2.2.4.1.3.cmml" xref="S4.Ex15.m1.2.2.2.4.1.3">𝜏</ci></apply><apply id="S4.Ex15.m1.2.2.2.4.2.cmml" xref="S4.Ex15.m1.2.2.2.4.2"><times id="S4.Ex15.m1.2.2.2.4.2.1.cmml" xref="S4.Ex15.m1.2.2.2.4.2.1"></times><apply id="S4.Ex15.m1.2.2.2.4.2.2.cmml" xref="S4.Ex15.m1.2.2.2.4.2.2"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.2.4.2.2.1.cmml" xref="S4.Ex15.m1.2.2.2.4.2.2">subscript</csymbol><ci id="S4.Ex15.m1.2.2.2.4.2.2.2.cmml" xref="S4.Ex15.m1.2.2.2.4.2.2.2">italic-ϕ</ci><ci id="S4.Ex15.m1.2.2.2.4.2.2.3.cmml" xref="S4.Ex15.m1.2.2.2.4.2.2.3">𝑗</ci></apply><apply id="S4.Ex15.m1.2.2.2.4.2.3.cmml" xref="S4.Ex15.m1.2.2.2.4.2.3"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.2.4.2.3.1.cmml" xref="S4.Ex15.m1.2.2.2.4.2.3">subscript</csymbol><ci id="S4.Ex15.m1.2.2.2.4.2.3.2.cmml" xref="S4.Ex15.m1.2.2.2.4.2.3.2">𝑢</ci><apply id="S4.Ex15.m1.2.2.2.4.2.3.3.cmml" xref="S4.Ex15.m1.2.2.2.4.2.3.3"><minus id="S4.Ex15.m1.2.2.2.4.2.3.3.1.cmml" xref="S4.Ex15.m1.2.2.2.4.2.3.3.1"></minus><apply id="S4.Ex15.m1.2.2.2.4.2.3.3.2.cmml" xref="S4.Ex15.m1.2.2.2.4.2.3.3.2"><plus id="S4.Ex15.m1.2.2.2.4.2.3.3.2.1.cmml" xref="S4.Ex15.m1.2.2.2.4.2.3.3.2.1"></plus><ci id="S4.Ex15.m1.2.2.2.4.2.3.3.2.2.cmml" xref="S4.Ex15.m1.2.2.2.4.2.3.3.2.2">𝑡</ci><cn id="S4.Ex15.m1.2.2.2.4.2.3.3.2.3.cmml" type="integer" xref="S4.Ex15.m1.2.2.2.4.2.3.3.2.3">1</cn></apply><ci id="S4.Ex15.m1.2.2.2.4.2.3.3.3.cmml" xref="S4.Ex15.m1.2.2.2.4.2.3.3.3">𝑗</ci></apply></apply></apply></apply><list id="S4.Ex15.m1.2.2.2.2.3.cmml" xref="S4.Ex15.m1.2.2.2.2.2"><apply id="S4.Ex15.m1.1.1.1.1.1.1.cmml" xref="S4.Ex15.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex15.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex15.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex15.m1.1.1.1.1.1.1.2.cmml" xref="S4.Ex15.m1.1.1.1.1.1.1.2">italic-ϕ</ci><apply id="S4.Ex15.m1.1.1.1.1.1.1.3.cmml" xref="S4.Ex15.m1.1.1.1.1.1.1.3"><ci id="S4.Ex15.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex15.m1.1.1.1.1.1.1.3.1">:</ci><apply id="S4.Ex15.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex15.m1.1.1.1.1.1.1.3.2"><plus id="S4.Ex15.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex15.m1.1.1.1.1.1.1.3.2.1"></plus><ci id="S4.Ex15.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex15.m1.1.1.1.1.1.1.3.2.2">𝜏</ci><cn id="S4.Ex15.m1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S4.Ex15.m1.1.1.1.1.1.1.3.2.3">1</cn></apply><ci id="S4.Ex15.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex15.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S4.Ex15.m1.2.2.2.2.2.2.cmml" xref="S4.Ex15.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.2.2.2.2.1.cmml" xref="S4.Ex15.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.Ex15.m1.2.2.2.2.2.2.2.cmml" xref="S4.Ex15.m1.2.2.2.2.2.2.2">𝑢</ci><apply id="S4.Ex15.m1.2.2.2.2.2.2.3.cmml" xref="S4.Ex15.m1.2.2.2.2.2.2.3"><ci id="S4.Ex15.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.Ex15.m1.2.2.2.2.2.2.3.1">:</ci><apply id="S4.Ex15.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.Ex15.m1.2.2.2.2.2.2.3.2"><minus id="S4.Ex15.m1.2.2.2.2.2.2.3.2.1.cmml" xref="S4.Ex15.m1.2.2.2.2.2.2.3.2.1"></minus><ci id="S4.Ex15.m1.2.2.2.2.2.2.3.2.2.cmml" xref="S4.Ex15.m1.2.2.2.2.2.2.3.2.2">𝑡</ci><ci id="S4.Ex15.m1.2.2.2.2.2.2.3.2.3.cmml" xref="S4.Ex15.m1.2.2.2.2.2.2.3.2.3">𝜏</ci></apply><cn id="S4.Ex15.m1.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S4.Ex15.m1.2.2.2.2.2.2.3.3">1</cn></apply></apply></list></apply></apply><apply id="S4.Ex15.m1.2.2c.cmml" xref="S4.Ex15.m1.2.2"><eq id="S4.Ex15.m1.2.2.6.cmml" xref="S4.Ex15.m1.2.2.6"></eq><share href="https://arxiv.org/html/2410.03766v1#S4.Ex15.m1.2.2.2.cmml" id="S4.Ex15.m1.2.2d.cmml" xref="S4.Ex15.m1.2.2"></share><apply id="S4.Ex15.m1.2.2.7.cmml" xref="S4.Ex15.m1.2.2.7"><plus id="S4.Ex15.m1.2.2.7.1.cmml" xref="S4.Ex15.m1.2.2.7.1"></plus><apply id="S4.Ex15.m1.2.2.7.2.cmml" xref="S4.Ex15.m1.2.2.7.2"><apply id="S4.Ex15.m1.2.2.7.2.1.cmml" xref="S4.Ex15.m1.2.2.7.2.1"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.7.2.1.1.cmml" xref="S4.Ex15.m1.2.2.7.2.1">superscript</csymbol><apply id="S4.Ex15.m1.2.2.7.2.1.2.cmml" xref="S4.Ex15.m1.2.2.7.2.1"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.7.2.1.2.1.cmml" xref="S4.Ex15.m1.2.2.7.2.1">subscript</csymbol><sum id="S4.Ex15.m1.2.2.7.2.1.2.2.cmml" xref="S4.Ex15.m1.2.2.7.2.1.2.2"></sum><apply id="S4.Ex15.m1.2.2.7.2.1.2.3.cmml" xref="S4.Ex15.m1.2.2.7.2.1.2.3"><eq id="S4.Ex15.m1.2.2.7.2.1.2.3.1.cmml" xref="S4.Ex15.m1.2.2.7.2.1.2.3.1"></eq><ci id="S4.Ex15.m1.2.2.7.2.1.2.3.2.cmml" xref="S4.Ex15.m1.2.2.7.2.1.2.3.2">𝑗</ci><cn id="S4.Ex15.m1.2.2.7.2.1.2.3.3.cmml" type="integer" xref="S4.Ex15.m1.2.2.7.2.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex15.m1.2.2.7.2.1.3.cmml" xref="S4.Ex15.m1.2.2.7.2.1.3">𝜏</ci></apply><apply id="S4.Ex15.m1.2.2.7.2.2.cmml" xref="S4.Ex15.m1.2.2.7.2.2"><times id="S4.Ex15.m1.2.2.7.2.2.1.cmml" xref="S4.Ex15.m1.2.2.7.2.2.1"></times><apply id="S4.Ex15.m1.2.2.7.2.2.2.cmml" xref="S4.Ex15.m1.2.2.7.2.2.2"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.7.2.2.2.1.cmml" xref="S4.Ex15.m1.2.2.7.2.2.2">subscript</csymbol><ci id="S4.Ex15.m1.2.2.7.2.2.2.2.cmml" xref="S4.Ex15.m1.2.2.7.2.2.2.2">italic-ϕ</ci><ci id="S4.Ex15.m1.2.2.7.2.2.2.3.cmml" xref="S4.Ex15.m1.2.2.7.2.2.2.3">𝑗</ci></apply><apply id="S4.Ex15.m1.2.2.7.2.2.3.cmml" xref="S4.Ex15.m1.2.2.7.2.2.3"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.7.2.2.3.1.cmml" xref="S4.Ex15.m1.2.2.7.2.2.3">subscript</csymbol><ci id="S4.Ex15.m1.2.2.7.2.2.3.2.cmml" xref="S4.Ex15.m1.2.2.7.2.2.3.2">𝑢</ci><apply id="S4.Ex15.m1.2.2.7.2.2.3.3.cmml" xref="S4.Ex15.m1.2.2.7.2.2.3.3"><minus id="S4.Ex15.m1.2.2.7.2.2.3.3.1.cmml" xref="S4.Ex15.m1.2.2.7.2.2.3.3.1"></minus><apply id="S4.Ex15.m1.2.2.7.2.2.3.3.2.cmml" xref="S4.Ex15.m1.2.2.7.2.2.3.3.2"><plus id="S4.Ex15.m1.2.2.7.2.2.3.3.2.1.cmml" xref="S4.Ex15.m1.2.2.7.2.2.3.3.2.1"></plus><ci id="S4.Ex15.m1.2.2.7.2.2.3.3.2.2.cmml" xref="S4.Ex15.m1.2.2.7.2.2.3.3.2.2">𝑡</ci><cn id="S4.Ex15.m1.2.2.7.2.2.3.3.2.3.cmml" type="integer" xref="S4.Ex15.m1.2.2.7.2.2.3.3.2.3">1</cn></apply><ci id="S4.Ex15.m1.2.2.7.2.2.3.3.3.cmml" xref="S4.Ex15.m1.2.2.7.2.2.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.Ex15.m1.2.2.7.3.cmml" xref="S4.Ex15.m1.2.2.7.3"><csymbol cd="ambiguous" id="S4.Ex15.m1.2.2.7.3.1.cmml" xref="S4.Ex15.m1.2.2.7.3">subscript</csymbol><ci id="S4.Ex15.m1.2.2.7.3.2.cmml" xref="S4.Ex15.m1.2.2.7.3.2">𝐶</ci><ci id="S4.Ex15.m1.2.2.7.3.3.cmml" xref="S4.Ex15.m1.2.2.7.3.3">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex15.m1.2c">\hat{y}_{t}=\sum_{j=1}^{\tau}\phi_{j}u_{t+1-j}+\langle\phi_{\tau+1:t},u_{t-%
\tau:1}\rangle=\sum_{j=1}^{\tau}\phi_{j}u_{t+1-j}+C_{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex15.m1.2d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_t + 1 - italic_j end_POSTSUBSCRIPT + ⟨ italic_ϕ start_POSTSUBSCRIPT italic_τ + 1 : italic_t end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_t - italic_τ : 1 end_POSTSUBSCRIPT ⟩ = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_t + 1 - italic_j end_POSTSUBSCRIPT + italic_C start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math alttext="\tau\leftarrow\tau+1" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">τ</mi><mo id="alg2.l8.m1.1.1.1" stretchy="false" xref="alg2.l8.m1.1.1.1.cmml">←</mo><mrow id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml"><mi id="alg2.l8.m1.1.1.3.2" xref="alg2.l8.m1.1.1.3.2.cmml">τ</mi><mo id="alg2.l8.m1.1.1.3.1" xref="alg2.l8.m1.1.1.3.1.cmml">+</mo><mn id="alg2.l8.m1.1.1.3.3" xref="alg2.l8.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><ci id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1">←</ci><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝜏</ci><apply id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"><plus id="alg2.l8.m1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.3.1"></plus><ci id="alg2.l8.m1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.3.2">𝜏</ci><cn id="alg2.l8.m1.1.1.3.3.cmml" type="integer" xref="alg2.l8.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\tau\leftarrow\tau+1</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">italic_τ ← italic_τ + 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     Observe <math alttext="y_{t}" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><msub id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml">y</mi><mi id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1">subscript</csymbol><ci id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2">𝑦</ci><ci id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, suffer loss <math alttext="\ell_{t}(y_{t},\hat{y}_{t})" class="ltx_Math" display="inline" id="alg2.l9.m2.2"><semantics id="alg2.l9.m2.2a"><mrow id="alg2.l9.m2.2.2" xref="alg2.l9.m2.2.2.cmml"><msub id="alg2.l9.m2.2.2.4" xref="alg2.l9.m2.2.2.4.cmml"><mi id="alg2.l9.m2.2.2.4.2" mathvariant="normal" xref="alg2.l9.m2.2.2.4.2.cmml">ℓ</mi><mi id="alg2.l9.m2.2.2.4.3" xref="alg2.l9.m2.2.2.4.3.cmml">t</mi></msub><mo id="alg2.l9.m2.2.2.3" xref="alg2.l9.m2.2.2.3.cmml">⁢</mo><mrow id="alg2.l9.m2.2.2.2.2" xref="alg2.l9.m2.2.2.2.3.cmml"><mo id="alg2.l9.m2.2.2.2.2.3" stretchy="false" xref="alg2.l9.m2.2.2.2.3.cmml">(</mo><msub id="alg2.l9.m2.1.1.1.1.1" xref="alg2.l9.m2.1.1.1.1.1.cmml"><mi id="alg2.l9.m2.1.1.1.1.1.2" xref="alg2.l9.m2.1.1.1.1.1.2.cmml">y</mi><mi id="alg2.l9.m2.1.1.1.1.1.3" xref="alg2.l9.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l9.m2.2.2.2.2.4" xref="alg2.l9.m2.2.2.2.3.cmml">,</mo><msub id="alg2.l9.m2.2.2.2.2.2" xref="alg2.l9.m2.2.2.2.2.2.cmml"><mover accent="true" id="alg2.l9.m2.2.2.2.2.2.2" xref="alg2.l9.m2.2.2.2.2.2.2.cmml"><mi id="alg2.l9.m2.2.2.2.2.2.2.2" xref="alg2.l9.m2.2.2.2.2.2.2.2.cmml">y</mi><mo id="alg2.l9.m2.2.2.2.2.2.2.1" xref="alg2.l9.m2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg2.l9.m2.2.2.2.2.2.3" xref="alg2.l9.m2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg2.l9.m2.2.2.2.2.5" stretchy="false" xref="alg2.l9.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.2b"><apply id="alg2.l9.m2.2.2.cmml" xref="alg2.l9.m2.2.2"><times id="alg2.l9.m2.2.2.3.cmml" xref="alg2.l9.m2.2.2.3"></times><apply id="alg2.l9.m2.2.2.4.cmml" xref="alg2.l9.m2.2.2.4"><csymbol cd="ambiguous" id="alg2.l9.m2.2.2.4.1.cmml" xref="alg2.l9.m2.2.2.4">subscript</csymbol><ci id="alg2.l9.m2.2.2.4.2.cmml" xref="alg2.l9.m2.2.2.4.2">ℓ</ci><ci id="alg2.l9.m2.2.2.4.3.cmml" xref="alg2.l9.m2.2.2.4.3">𝑡</ci></apply><interval closure="open" id="alg2.l9.m2.2.2.2.3.cmml" xref="alg2.l9.m2.2.2.2.2"><apply id="alg2.l9.m2.1.1.1.1.1.cmml" xref="alg2.l9.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m2.1.1.1.1.1.1.cmml" xref="alg2.l9.m2.1.1.1.1.1">subscript</csymbol><ci id="alg2.l9.m2.1.1.1.1.1.2.cmml" xref="alg2.l9.m2.1.1.1.1.1.2">𝑦</ci><ci id="alg2.l9.m2.1.1.1.1.1.3.cmml" xref="alg2.l9.m2.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.l9.m2.2.2.2.2.2.cmml" xref="alg2.l9.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l9.m2.2.2.2.2.2.1.cmml" xref="alg2.l9.m2.2.2.2.2.2">subscript</csymbol><apply id="alg2.l9.m2.2.2.2.2.2.2.cmml" xref="alg2.l9.m2.2.2.2.2.2.2"><ci id="alg2.l9.m2.2.2.2.2.2.2.1.cmml" xref="alg2.l9.m2.2.2.2.2.2.2.1">^</ci><ci id="alg2.l9.m2.2.2.2.2.2.2.2.cmml" xref="alg2.l9.m2.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="alg2.l9.m2.2.2.2.2.2.3.cmml" xref="alg2.l9.m2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.2c">\ell_{t}(y_{t},\hat{y}_{t})</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m2.2d">roman_ℓ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l10.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l10.2">for</span>
</div>
</div>
</figure>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem2.1.1.1">Lemma 2</span></span><span class="ltx_text ltx_font_bold" id="Thmtheorem2.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem2.p1">
<p class="ltx_p" id="Thmtheorem2.p1.2"><span class="ltx_text ltx_font_italic" id="Thmtheorem2.p1.2.2">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg2" title="Algorithm 2 ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">2</span></a> with sequence length <math alttext="L" class="ltx_Math" display="inline" id="Thmtheorem2.p1.1.1.m1.1"><semantics id="Thmtheorem2.p1.1.1.m1.1a"><mi id="Thmtheorem2.p1.1.1.m1.1.1" xref="Thmtheorem2.p1.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.1.1.m1.1b"><ci id="Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.1.1.m1.1d">italic_L</annotation></semantics></math> runs in amortized time <math alttext="O\left(\sqrt{L\log L}\right)" class="ltx_Math" display="inline" id="Thmtheorem2.p1.2.2.m2.1"><semantics id="Thmtheorem2.p1.2.2.m2.1a"><mrow id="Thmtheorem2.p1.2.2.m2.1.2" xref="Thmtheorem2.p1.2.2.m2.1.2.cmml"><mi id="Thmtheorem2.p1.2.2.m2.1.2.2" xref="Thmtheorem2.p1.2.2.m2.1.2.2.cmml">O</mi><mo id="Thmtheorem2.p1.2.2.m2.1.2.1" xref="Thmtheorem2.p1.2.2.m2.1.2.1.cmml">⁢</mo><mrow id="Thmtheorem2.p1.2.2.m2.1.2.3.2" xref="Thmtheorem2.p1.2.2.m2.1.1.cmml"><mo id="Thmtheorem2.p1.2.2.m2.1.2.3.2.1" xref="Thmtheorem2.p1.2.2.m2.1.1.cmml">(</mo><msqrt id="Thmtheorem2.p1.2.2.m2.1.1" xref="Thmtheorem2.p1.2.2.m2.1.1.cmml"><mrow id="Thmtheorem2.p1.2.2.m2.1.1.2" xref="Thmtheorem2.p1.2.2.m2.1.1.2.cmml"><mi id="Thmtheorem2.p1.2.2.m2.1.1.2.2" xref="Thmtheorem2.p1.2.2.m2.1.1.2.2.cmml">L</mi><mo id="Thmtheorem2.p1.2.2.m2.1.1.2.1" lspace="0.167em" xref="Thmtheorem2.p1.2.2.m2.1.1.2.1.cmml">⁢</mo><mrow id="Thmtheorem2.p1.2.2.m2.1.1.2.3" xref="Thmtheorem2.p1.2.2.m2.1.1.2.3.cmml"><mi id="Thmtheorem2.p1.2.2.m2.1.1.2.3.1" xref="Thmtheorem2.p1.2.2.m2.1.1.2.3.1.cmml">log</mi><mo id="Thmtheorem2.p1.2.2.m2.1.1.2.3a" lspace="0.167em" xref="Thmtheorem2.p1.2.2.m2.1.1.2.3.cmml">⁡</mo><mi id="Thmtheorem2.p1.2.2.m2.1.1.2.3.2" xref="Thmtheorem2.p1.2.2.m2.1.1.2.3.2.cmml">L</mi></mrow></mrow></msqrt><mo id="Thmtheorem2.p1.2.2.m2.1.2.3.2.2" xref="Thmtheorem2.p1.2.2.m2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.2.2.m2.1b"><apply id="Thmtheorem2.p1.2.2.m2.1.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.2"><times id="Thmtheorem2.p1.2.2.m2.1.2.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.2.1"></times><ci id="Thmtheorem2.p1.2.2.m2.1.2.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.2.2">𝑂</ci><apply id="Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.2.3.2"><root id="Thmtheorem2.p1.2.2.m2.1.1a.cmml" xref="Thmtheorem2.p1.2.2.m2.1.2.3.2"></root><apply id="Thmtheorem2.p1.2.2.m2.1.1.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.2"><times id="Thmtheorem2.p1.2.2.m2.1.1.2.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.2.1"></times><ci id="Thmtheorem2.p1.2.2.m2.1.1.2.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.2.2">𝐿</ci><apply id="Thmtheorem2.p1.2.2.m2.1.1.2.3.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.2.3"><log id="Thmtheorem2.p1.2.2.m2.1.1.2.3.1.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.2.3.1"></log><ci id="Thmtheorem2.p1.2.2.m2.1.1.2.3.2.cmml" xref="Thmtheorem2.p1.2.2.m2.1.1.2.3.2">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.2.2.m2.1c">O\left(\sqrt{L\log L}\right)</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.2.2.m2.1d">italic_O ( square-root start_ARG italic_L roman_log italic_L end_ARG )</annotation></semantics></math> per iteration.</span></p>
</div>
</div>
<div class="ltx_proof" id="S4.2">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para ltx_noindent" id="S4.1.p1">
<p class="ltx_p" id="S4.1.p1.1">The running time consists of two components as follows:</p>
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.4">Every iteration, line <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg2.l7" title="In Algorithm 2 ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">7</span></a> is executed. One term, <math alttext="C_{\tau}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><msub id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">C</mi><mi id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">𝐶</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">C_{\tau}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">italic_C start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT</annotation></semantics></math>, has already been computed and saved in line <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg2.l4" title="In Algorithm 2 ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">4</span></a>. We can retrieve it in time <math alttext="O(1)" class="ltx_Math" display="inline" id="S4.I1.i1.p1.2.m2.1"><semantics id="S4.I1.i1.p1.2.m2.1a"><mrow id="S4.I1.i1.p1.2.m2.1.2" xref="S4.I1.i1.p1.2.m2.1.2.cmml"><mi id="S4.I1.i1.p1.2.m2.1.2.2" xref="S4.I1.i1.p1.2.m2.1.2.2.cmml">O</mi><mo id="S4.I1.i1.p1.2.m2.1.2.1" xref="S4.I1.i1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.I1.i1.p1.2.m2.1.2.3.2" xref="S4.I1.i1.p1.2.m2.1.2.cmml"><mo id="S4.I1.i1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S4.I1.i1.p1.2.m2.1.2.cmml">(</mo><mn id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">1</mn><mo id="S4.I1.i1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S4.I1.i1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><apply id="S4.I1.i1.p1.2.m2.1.2.cmml" xref="S4.I1.i1.p1.2.m2.1.2"><times id="S4.I1.i1.p1.2.m2.1.2.1.cmml" xref="S4.I1.i1.p1.2.m2.1.2.1"></times><ci id="S4.I1.i1.p1.2.m2.1.2.2.cmml" xref="S4.I1.i1.p1.2.m2.1.2.2">𝑂</ci><cn id="S4.I1.i1.p1.2.m2.1.1.cmml" type="integer" xref="S4.I1.i1.p1.2.m2.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">O(1)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">italic_O ( 1 )</annotation></semantics></math>. The other term is a sum of <math alttext="\tau" class="ltx_Math" display="inline" id="S4.I1.i1.p1.3.m3.1"><semantics id="S4.I1.i1.p1.3.m3.1a"><mi id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><ci id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.3.m3.1d">italic_τ</annotation></semantics></math> products, which can be computed in time <math alttext="\tau" class="ltx_Math" display="inline" id="S4.I1.i1.p1.4.m4.1"><semantics id="S4.I1.i1.p1.4.m4.1a"><mi id="S4.I1.i1.p1.4.m4.1.1" xref="S4.I1.i1.p1.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.1b"><ci id="S4.I1.i1.p1.4.m4.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.4.m4.1d">italic_τ</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.5">Every <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><mi id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><ci id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">italic_K</annotation></semantics></math> iterations, we execute line <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg2.l4" title="In Algorithm 2 ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">4</span></a> and update the terms in the cache. Let <math alttext="\bar{u}=u_{1:t}0_{\sqrt{L}}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.1"><semantics id="S4.I1.i2.p1.2.m2.1a"><mrow id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml"><mover accent="true" id="S4.I1.i2.p1.2.m2.1.1.2" xref="S4.I1.i2.p1.2.m2.1.1.2.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.2.2" xref="S4.I1.i2.p1.2.m2.1.1.2.2.cmml">u</mi><mo id="S4.I1.i2.p1.2.m2.1.1.2.1" xref="S4.I1.i2.p1.2.m2.1.1.2.1.cmml">¯</mo></mover><mo id="S4.I1.i2.p1.2.m2.1.1.1" xref="S4.I1.i2.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S4.I1.i2.p1.2.m2.1.1.3" xref="S4.I1.i2.p1.2.m2.1.1.3.cmml"><msub id="S4.I1.i2.p1.2.m2.1.1.3.2" xref="S4.I1.i2.p1.2.m2.1.1.3.2.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.3.2.2" xref="S4.I1.i2.p1.2.m2.1.1.3.2.2.cmml">u</mi><mrow id="S4.I1.i2.p1.2.m2.1.1.3.2.3" xref="S4.I1.i2.p1.2.m2.1.1.3.2.3.cmml"><mn id="S4.I1.i2.p1.2.m2.1.1.3.2.3.2" xref="S4.I1.i2.p1.2.m2.1.1.3.2.3.2.cmml">1</mn><mo id="S4.I1.i2.p1.2.m2.1.1.3.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.I1.i2.p1.2.m2.1.1.3.2.3.1.cmml">:</mo><mi id="S4.I1.i2.p1.2.m2.1.1.3.2.3.3" xref="S4.I1.i2.p1.2.m2.1.1.3.2.3.3.cmml">t</mi></mrow></msub><mo id="S4.I1.i2.p1.2.m2.1.1.3.1" xref="S4.I1.i2.p1.2.m2.1.1.3.1.cmml">⁢</mo><msub id="S4.I1.i2.p1.2.m2.1.1.3.3" xref="S4.I1.i2.p1.2.m2.1.1.3.3.cmml"><mn id="S4.I1.i2.p1.2.m2.1.1.3.3.2" xref="S4.I1.i2.p1.2.m2.1.1.3.3.2.cmml">0</mn><msqrt id="S4.I1.i2.p1.2.m2.1.1.3.3.3" xref="S4.I1.i2.p1.2.m2.1.1.3.3.3.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.3.3.3.2" xref="S4.I1.i2.p1.2.m2.1.1.3.3.3.2.cmml">L</mi></msqrt></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1"><eq id="S4.I1.i2.p1.2.m2.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.1"></eq><apply id="S4.I1.i2.p1.2.m2.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2"><ci id="S4.I1.i2.p1.2.m2.1.1.2.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2.1">¯</ci><ci id="S4.I1.i2.p1.2.m2.1.1.2.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2.2">𝑢</ci></apply><apply id="S4.I1.i2.p1.2.m2.1.1.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3"><times id="S4.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.1"></times><apply id="S4.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.1.1.3.2.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.2">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.1.1.3.2.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.2.2">𝑢</ci><apply id="S4.I1.i2.p1.2.m2.1.1.3.2.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.2.3"><ci id="S4.I1.i2.p1.2.m2.1.1.3.2.3.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.2.3.1">:</ci><cn id="S4.I1.i2.p1.2.m2.1.1.3.2.3.2.cmml" type="integer" xref="S4.I1.i2.p1.2.m2.1.1.3.2.3.2">1</cn><ci id="S4.I1.i2.p1.2.m2.1.1.3.2.3.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="S4.I1.i2.p1.2.m2.1.1.3.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.1.1.3.3.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.3">subscript</csymbol><cn id="S4.I1.i2.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S4.I1.i2.p1.2.m2.1.1.3.3.2">0</cn><apply id="S4.I1.i2.p1.2.m2.1.1.3.3.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.3.3"><root id="S4.I1.i2.p1.2.m2.1.1.3.3.3a.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.3.3"></root><ci id="S4.I1.i2.p1.2.m2.1.1.3.3.3.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.3.3.2">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">\bar{u}=u_{1:t}0_{\sqrt{L}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.1d">over¯ start_ARG italic_u end_ARG = italic_u start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT 0 start_POSTSUBSCRIPT square-root start_ARG italic_L end_ARG end_POSTSUBSCRIPT</annotation></semantics></math>, note that <math alttext="C_{j}=[\phi*\bar{u}]_{t+j}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.1"><semantics id="S4.I1.i2.p1.3.m3.1a"><mrow id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml"><msub id="S4.I1.i2.p1.3.m3.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.3.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.3.2" xref="S4.I1.i2.p1.3.m3.1.1.3.2.cmml">C</mi><mi id="S4.I1.i2.p1.3.m3.1.1.3.3" xref="S4.I1.i2.p1.3.m3.1.1.3.3.cmml">j</mi></msub><mo id="S4.I1.i2.p1.3.m3.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.2.cmml">=</mo><msub id="S4.I1.i2.p1.3.m3.1.1.1" xref="S4.I1.i2.p1.3.m3.1.1.1.cmml"><mrow id="S4.I1.i2.p1.3.m3.1.1.1.1.1" xref="S4.I1.i2.p1.3.m3.1.1.1.1.2.cmml"><mo id="S4.I1.i2.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.3.m3.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.1.cmml">∗</mo><mover accent="true" id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3.2" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3.2.cmml">u</mi><mo id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3.1" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="S4.I1.i2.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S4.I1.i2.p1.3.m3.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S4.I1.i2.p1.3.m3.1.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.1.3.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.1.3.2" xref="S4.I1.i2.p1.3.m3.1.1.1.3.2.cmml">t</mi><mo id="S4.I1.i2.p1.3.m3.1.1.1.3.1" xref="S4.I1.i2.p1.3.m3.1.1.1.3.1.cmml">+</mo><mi id="S4.I1.i2.p1.3.m3.1.1.1.3.3" xref="S4.I1.i2.p1.3.m3.1.1.1.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><apply id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1"><eq id="S4.I1.i2.p1.3.m3.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2"></eq><apply id="S4.I1.i2.p1.3.m3.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.3.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.3.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.2">𝐶</ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.3">𝑗</ci></apply><apply id="S4.I1.i2.p1.3.m3.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1">subscript</csymbol><apply id="S4.I1.i2.p1.3.m3.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S4.I1.i2.p1.3.m3.1.1.1.1.2.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1"><times id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.1"></times><ci id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.2">italic-ϕ</ci><apply id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3"><ci id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3.1">¯</ci><ci id="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.1.1.1.3.2">𝑢</ci></apply></apply></apply><apply id="S4.I1.i2.p1.3.m3.1.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.3"><plus id="S4.I1.i2.p1.3.m3.1.1.1.3.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.3.1"></plus><ci id="S4.I1.i2.p1.3.m3.1.1.1.3.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.3.2">𝑡</ci><ci id="S4.I1.i2.p1.3.m3.1.1.1.3.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">C_{j}=[\phi*\bar{u}]_{t+j}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m3.1d">italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = [ italic_ϕ ∗ over¯ start_ARG italic_u end_ARG ] start_POSTSUBSCRIPT italic_t + italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\{C_{1},\ldots,C_{K}\}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.4.m4.3"><semantics id="S4.I1.i2.p1.4.m4.3a"><mrow id="S4.I1.i2.p1.4.m4.3.3.2" xref="S4.I1.i2.p1.4.m4.3.3.3.cmml"><mo id="S4.I1.i2.p1.4.m4.3.3.2.3" stretchy="false" xref="S4.I1.i2.p1.4.m4.3.3.3.cmml">{</mo><msub id="S4.I1.i2.p1.4.m4.2.2.1.1" xref="S4.I1.i2.p1.4.m4.2.2.1.1.cmml"><mi id="S4.I1.i2.p1.4.m4.2.2.1.1.2" xref="S4.I1.i2.p1.4.m4.2.2.1.1.2.cmml">C</mi><mn id="S4.I1.i2.p1.4.m4.2.2.1.1.3" xref="S4.I1.i2.p1.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.I1.i2.p1.4.m4.3.3.2.4" xref="S4.I1.i2.p1.4.m4.3.3.3.cmml">,</mo><mi id="S4.I1.i2.p1.4.m4.1.1" mathvariant="normal" xref="S4.I1.i2.p1.4.m4.1.1.cmml">…</mi><mo id="S4.I1.i2.p1.4.m4.3.3.2.5" xref="S4.I1.i2.p1.4.m4.3.3.3.cmml">,</mo><msub id="S4.I1.i2.p1.4.m4.3.3.2.2" xref="S4.I1.i2.p1.4.m4.3.3.2.2.cmml"><mi id="S4.I1.i2.p1.4.m4.3.3.2.2.2" xref="S4.I1.i2.p1.4.m4.3.3.2.2.2.cmml">C</mi><mi id="S4.I1.i2.p1.4.m4.3.3.2.2.3" xref="S4.I1.i2.p1.4.m4.3.3.2.2.3.cmml">K</mi></msub><mo id="S4.I1.i2.p1.4.m4.3.3.2.6" stretchy="false" xref="S4.I1.i2.p1.4.m4.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.3b"><set id="S4.I1.i2.p1.4.m4.3.3.3.cmml" xref="S4.I1.i2.p1.4.m4.3.3.2"><apply id="S4.I1.i2.p1.4.m4.2.2.1.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.2.2.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.4.m4.2.2.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.1.1.2">𝐶</ci><cn id="S4.I1.i2.p1.4.m4.2.2.1.1.3.cmml" type="integer" xref="S4.I1.i2.p1.4.m4.2.2.1.1.3">1</cn></apply><ci id="S4.I1.i2.p1.4.m4.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1">…</ci><apply id="S4.I1.i2.p1.4.m4.3.3.2.2.cmml" xref="S4.I1.i2.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.3.3.2.2.1.cmml" xref="S4.I1.i2.p1.4.m4.3.3.2.2">subscript</csymbol><ci id="S4.I1.i2.p1.4.m4.3.3.2.2.2.cmml" xref="S4.I1.i2.p1.4.m4.3.3.2.2.2">𝐶</ci><ci id="S4.I1.i2.p1.4.m4.3.3.2.2.3.cmml" xref="S4.I1.i2.p1.4.m4.3.3.2.2.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.3c">\{C_{1},\ldots,C_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.4.m4.3d">{ italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_C start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> can be computed using one convolution. Using the FFT, this takes at most <math alttext="O(L\log L)" class="ltx_Math" display="inline" id="S4.I1.i2.p1.5.m5.1"><semantics id="S4.I1.i2.p1.5.m5.1a"><mrow id="S4.I1.i2.p1.5.m5.1.1" xref="S4.I1.i2.p1.5.m5.1.1.cmml"><mi id="S4.I1.i2.p1.5.m5.1.1.3" xref="S4.I1.i2.p1.5.m5.1.1.3.cmml">O</mi><mo id="S4.I1.i2.p1.5.m5.1.1.2" xref="S4.I1.i2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S4.I1.i2.p1.5.m5.1.1.1.1" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.cmml"><mo id="S4.I1.i2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S4.I1.i2.p1.5.m5.1.1.1.1.1" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.5.m5.1.1.1.1.1.2" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.2.cmml">L</mi><mo id="S4.I1.i2.p1.5.m5.1.1.1.1.1.1" lspace="0.167em" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.5.m5.1.1.1.1.1.3" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.cmml"><mi id="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.1" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.I1.i2.p1.5.m5.1.1.1.1.1.3a" lspace="0.167em" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.2" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.2.cmml">L</mi></mrow></mrow><mo id="S4.I1.i2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><apply id="S4.I1.i2.p1.5.m5.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1"><times id="S4.I1.i2.p1.5.m5.1.1.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.2"></times><ci id="S4.I1.i2.p1.5.m5.1.1.3.cmml" xref="S4.I1.i2.p1.5.m5.1.1.3">𝑂</ci><apply id="S4.I1.i2.p1.5.m5.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1"><times id="S4.I1.i2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.1"></times><ci id="S4.I1.i2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.2">𝐿</ci><apply id="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.3"><log id="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.1"></log><ci id="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.3.2">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">O(L\log L)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.5.m5.1d">italic_O ( italic_L roman_log italic_L )</annotation></semantics></math> time.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S4.2.p2">
<p class="ltx_p" id="S4.2.p2.2">The overall amortized running time is computed by summing over the <math alttext="L" class="ltx_Math" display="inline" id="S4.2.p2.1.m1.1"><semantics id="S4.2.p2.1.m1.1a"><mi id="S4.2.p2.1.m1.1.1" xref="S4.2.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.2.p2.1.m1.1b"><ci id="S4.2.p2.1.m1.1.1.cmml" xref="S4.2.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.2.p2.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.2.p2.1.m1.1d">italic_L</annotation></semantics></math> iterations and taking an average. In each block of <math alttext="K" class="ltx_Math" display="inline" id="S4.2.p2.2.m2.1"><semantics id="S4.2.p2.2.m2.1a"><mi id="S4.2.p2.2.m2.1.1" xref="S4.2.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.2.p2.2.m2.1b"><ci id="S4.2.p2.2.m2.1.1.cmml" xref="S4.2.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.2.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.2.p2.2.m2.1d">italic_K</annotation></semantics></math> iterations, we apply FFT exactly once, and hence the total computational complexity is</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A0.EGx2">
<tbody id="S4.Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{L}{K}\left(L\log L+\sum_{\tau=1}^{K}\tau\right)=O\left(%
\frac{L^{2}\log L}{K}+KL\right)=O\left(L\sqrt{L\log L}\right)," class="ltx_Math" display="inline" id="S4.Ex16.m1.1"><semantics id="S4.Ex16.m1.1a"><mrow id="S4.Ex16.m1.1.1.1" xref="S4.Ex16.m1.1.1.1.1.cmml"><mrow id="S4.Ex16.m1.1.1.1.1" xref="S4.Ex16.m1.1.1.1.1.cmml"><mrow id="S4.Ex16.m1.1.1.1.1.1" xref="S4.Ex16.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.Ex16.m1.1.1.1.1.1.3" xref="S4.Ex16.m1.1.1.1.1.1.3.cmml"><mfrac id="S4.Ex16.m1.1.1.1.1.1.3a" xref="S4.Ex16.m1.1.1.1.1.1.3.cmml"><mi id="S4.Ex16.m1.1.1.1.1.1.3.2" xref="S4.Ex16.m1.1.1.1.1.1.3.2.cmml">L</mi><mi id="S4.Ex16.m1.1.1.1.1.1.3.3" xref="S4.Ex16.m1.1.1.1.1.1.3.3.cmml">K</mi></mfrac></mstyle><mo id="S4.Ex16.m1.1.1.1.1.1.2" xref="S4.Ex16.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex16.m1.1.1.1.1.1.1.1" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex16.m1.1.1.1.1.1.1.1.2" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex16.m1.1.1.1.1.1.1.1.1" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.2.cmml">L</mi><mo id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.1" lspace="0.167em" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><mi id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">L</mi></mrow></mrow><mo id="S4.Ex16.m1.1.1.1.1.1.1.1.1.1" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.cmml"><munderover id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1a" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.2" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.2.cmml">τ</mi><mo id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.1" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.3" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.3" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.3.cmml">K</mi></munderover></mstyle><mi id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.2.cmml">τ</mi></mrow></mrow><mo id="S4.Ex16.m1.1.1.1.1.1.1.1.3" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex16.m1.1.1.1.1.5" xref="S4.Ex16.m1.1.1.1.1.5.cmml">=</mo><mrow id="S4.Ex16.m1.1.1.1.1.2" xref="S4.Ex16.m1.1.1.1.1.2.cmml"><mi id="S4.Ex16.m1.1.1.1.1.2.3" xref="S4.Ex16.m1.1.1.1.1.2.3.cmml">O</mi><mo id="S4.Ex16.m1.1.1.1.1.2.2" xref="S4.Ex16.m1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.Ex16.m1.1.1.1.1.2.1.1" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.Ex16.m1.1.1.1.1.2.1.1.2" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.Ex16.m1.1.1.1.1.2.1.1.1" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.cmml"><mstyle displaystyle="true" id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.cmml"><mfrac id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2a" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.cmml"><mrow id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.cmml"><msup id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.cmml"><mi id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.2" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.2.cmml">L</mi><mn id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.3" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.3.cmml">2</mn></msup><mo id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.1" lspace="0.167em" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.1.cmml">⁢</mo><mrow id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.cmml"><mi id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.1" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.1.cmml">log</mi><mo id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3a" lspace="0.167em" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.cmml">⁡</mo><mi id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.2" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.2.cmml">L</mi></mrow></mrow><mi id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.3" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.3.cmml">K</mi></mfrac></mstyle><mo id="S4.Ex16.m1.1.1.1.1.2.1.1.1.1" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.1.cmml">+</mo><mrow id="S4.Ex16.m1.1.1.1.1.2.1.1.1.3" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.2" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.2.cmml">K</mi><mo id="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.1" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.1.cmml">⁢</mo><mi id="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.3" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.3.cmml">L</mi></mrow></mrow><mo id="S4.Ex16.m1.1.1.1.1.2.1.1.3" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex16.m1.1.1.1.1.6" xref="S4.Ex16.m1.1.1.1.1.6.cmml">=</mo><mrow id="S4.Ex16.m1.1.1.1.1.3" xref="S4.Ex16.m1.1.1.1.1.3.cmml"><mi id="S4.Ex16.m1.1.1.1.1.3.3" xref="S4.Ex16.m1.1.1.1.1.3.3.cmml">O</mi><mo id="S4.Ex16.m1.1.1.1.1.3.2" xref="S4.Ex16.m1.1.1.1.1.3.2.cmml">⁢</mo><mrow id="S4.Ex16.m1.1.1.1.1.3.1.1" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.cmml"><mo id="S4.Ex16.m1.1.1.1.1.3.1.1.2" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.cmml">(</mo><mrow id="S4.Ex16.m1.1.1.1.1.3.1.1.1" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.cmml"><mi id="S4.Ex16.m1.1.1.1.1.3.1.1.1.2" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.2.cmml">L</mi><mo id="S4.Ex16.m1.1.1.1.1.3.1.1.1.1" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.1.cmml">⁢</mo><msqrt id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.cmml"><mrow id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.cmml"><mi id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.2" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.2.cmml">L</mi><mo id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.1" lspace="0.167em" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.cmml"><mi id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.1" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.1.cmml">log</mi><mo id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3a" lspace="0.167em" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.cmml">⁡</mo><mi id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.2" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.2.cmml">L</mi></mrow></mrow></msqrt></mrow><mo id="S4.Ex16.m1.1.1.1.1.3.1.1.3" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex16.m1.1.1.1.2" xref="S4.Ex16.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex16.m1.1b"><apply id="S4.Ex16.m1.1.1.1.1.cmml" xref="S4.Ex16.m1.1.1.1"><and id="S4.Ex16.m1.1.1.1.1a.cmml" xref="S4.Ex16.m1.1.1.1"></and><apply id="S4.Ex16.m1.1.1.1.1b.cmml" xref="S4.Ex16.m1.1.1.1"><eq id="S4.Ex16.m1.1.1.1.1.5.cmml" xref="S4.Ex16.m1.1.1.1.1.5"></eq><apply id="S4.Ex16.m1.1.1.1.1.1.cmml" xref="S4.Ex16.m1.1.1.1.1.1"><times id="S4.Ex16.m1.1.1.1.1.1.2.cmml" xref="S4.Ex16.m1.1.1.1.1.1.2"></times><apply id="S4.Ex16.m1.1.1.1.1.1.3.cmml" xref="S4.Ex16.m1.1.1.1.1.1.3"><divide id="S4.Ex16.m1.1.1.1.1.1.3.1.cmml" xref="S4.Ex16.m1.1.1.1.1.1.3"></divide><ci id="S4.Ex16.m1.1.1.1.1.1.3.2.cmml" xref="S4.Ex16.m1.1.1.1.1.1.3.2">𝐿</ci><ci id="S4.Ex16.m1.1.1.1.1.1.3.3.cmml" xref="S4.Ex16.m1.1.1.1.1.1.3.3">𝐾</ci></apply><apply id="S4.Ex16.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1"><plus id="S4.Ex16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2"><times id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.1"></times><ci id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.2">𝐿</ci><apply id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3"><log id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.1"></log><ci id="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.2.3.2">𝐿</ci></apply></apply><apply id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3"><apply id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3"><eq id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.2">𝜏</ci><cn id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.1.3">𝐾</ci></apply><ci id="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex16.m1.1.1.1.1.1.1.1.1.3.2">𝜏</ci></apply></apply></apply><apply id="S4.Ex16.m1.1.1.1.1.2.cmml" xref="S4.Ex16.m1.1.1.1.1.2"><times id="S4.Ex16.m1.1.1.1.1.2.2.cmml" xref="S4.Ex16.m1.1.1.1.1.2.2"></times><ci id="S4.Ex16.m1.1.1.1.1.2.3.cmml" xref="S4.Ex16.m1.1.1.1.1.2.3">𝑂</ci><apply id="S4.Ex16.m1.1.1.1.1.2.1.1.1.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1"><plus id="S4.Ex16.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.1"></plus><apply id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2"><divide id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2"></divide><apply id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2"><times id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.1.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.1"></times><apply id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.1.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2">superscript</csymbol><ci id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.2.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.2">𝐿</ci><cn id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.3.cmml" type="integer" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.2.3">2</cn></apply><apply id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3"><log id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.1.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.1"></log><ci id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.2.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.2.3.2">𝐿</ci></apply></apply><ci id="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.2.3">𝐾</ci></apply><apply id="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.3"><times id="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.1"></times><ci id="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.2">𝐾</ci><ci id="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S4.Ex16.m1.1.1.1.1.2.1.1.1.3.3">𝐿</ci></apply></apply></apply></apply><apply id="S4.Ex16.m1.1.1.1.1c.cmml" xref="S4.Ex16.m1.1.1.1"><eq id="S4.Ex16.m1.1.1.1.1.6.cmml" xref="S4.Ex16.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2410.03766v1#S4.Ex16.m1.1.1.1.1.2.cmml" id="S4.Ex16.m1.1.1.1.1d.cmml" xref="S4.Ex16.m1.1.1.1"></share><apply id="S4.Ex16.m1.1.1.1.1.3.cmml" xref="S4.Ex16.m1.1.1.1.1.3"><times id="S4.Ex16.m1.1.1.1.1.3.2.cmml" xref="S4.Ex16.m1.1.1.1.1.3.2"></times><ci id="S4.Ex16.m1.1.1.1.1.3.3.cmml" xref="S4.Ex16.m1.1.1.1.1.3.3">𝑂</ci><apply id="S4.Ex16.m1.1.1.1.1.3.1.1.1.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1"><times id="S4.Ex16.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.1"></times><ci id="S4.Ex16.m1.1.1.1.1.3.1.1.1.2.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.2">𝐿</ci><apply id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3"><root id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3a.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3"></root><apply id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2"><times id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.1.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.1"></times><ci id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.2.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.2">𝐿</ci><apply id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3"><log id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.1.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.1"></log><ci id="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.2.cmml" xref="S4.Ex16.m1.1.1.1.1.3.1.1.1.3.2.3.2">𝐿</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex16.m1.1c">\displaystyle\frac{L}{K}\left(L\log L+\sum_{\tau=1}^{K}\tau\right)=O\left(%
\frac{L^{2}\log L}{K}+KL\right)=O\left(L\sqrt{L\log L}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.Ex16.m1.1d">divide start_ARG italic_L end_ARG start_ARG italic_K end_ARG ( italic_L roman_log italic_L + ∑ start_POSTSUBSCRIPT italic_τ = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_τ ) = italic_O ( divide start_ARG italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_L end_ARG start_ARG italic_K end_ARG + italic_K italic_L ) = italic_O ( italic_L square-root start_ARG italic_L roman_log italic_L end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.2.p2.4">where the cache size <math alttext="K" class="ltx_Math" display="inline" id="S4.2.p2.3.m1.1"><semantics id="S4.2.p2.3.m1.1a"><mi id="S4.2.p2.3.m1.1.1" xref="S4.2.p2.3.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.2.p2.3.m1.1b"><ci id="S4.2.p2.3.m1.1.1.cmml" xref="S4.2.p2.3.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.2.p2.3.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.2.p2.3.m1.1d">italic_K</annotation></semantics></math> is chosen to minimize the sum.
Taking an average, we conclude that the algorithm runs in <math alttext="O\left(\sqrt{L\log L}\right)" class="ltx_Math" display="inline" id="S4.2.p2.4.m2.1"><semantics id="S4.2.p2.4.m2.1a"><mrow id="S4.2.p2.4.m2.1.2" xref="S4.2.p2.4.m2.1.2.cmml"><mi id="S4.2.p2.4.m2.1.2.2" xref="S4.2.p2.4.m2.1.2.2.cmml">O</mi><mo id="S4.2.p2.4.m2.1.2.1" xref="S4.2.p2.4.m2.1.2.1.cmml">⁢</mo><mrow id="S4.2.p2.4.m2.1.2.3.2" xref="S4.2.p2.4.m2.1.1.cmml"><mo id="S4.2.p2.4.m2.1.2.3.2.1" xref="S4.2.p2.4.m2.1.1.cmml">(</mo><msqrt id="S4.2.p2.4.m2.1.1" xref="S4.2.p2.4.m2.1.1.cmml"><mrow id="S4.2.p2.4.m2.1.1.2" xref="S4.2.p2.4.m2.1.1.2.cmml"><mi id="S4.2.p2.4.m2.1.1.2.2" xref="S4.2.p2.4.m2.1.1.2.2.cmml">L</mi><mo id="S4.2.p2.4.m2.1.1.2.1" lspace="0.167em" xref="S4.2.p2.4.m2.1.1.2.1.cmml">⁢</mo><mrow id="S4.2.p2.4.m2.1.1.2.3" xref="S4.2.p2.4.m2.1.1.2.3.cmml"><mi id="S4.2.p2.4.m2.1.1.2.3.1" xref="S4.2.p2.4.m2.1.1.2.3.1.cmml">log</mi><mo id="S4.2.p2.4.m2.1.1.2.3a" lspace="0.167em" xref="S4.2.p2.4.m2.1.1.2.3.cmml">⁡</mo><mi id="S4.2.p2.4.m2.1.1.2.3.2" xref="S4.2.p2.4.m2.1.1.2.3.2.cmml">L</mi></mrow></mrow></msqrt><mo id="S4.2.p2.4.m2.1.2.3.2.2" xref="S4.2.p2.4.m2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.2.p2.4.m2.1b"><apply id="S4.2.p2.4.m2.1.2.cmml" xref="S4.2.p2.4.m2.1.2"><times id="S4.2.p2.4.m2.1.2.1.cmml" xref="S4.2.p2.4.m2.1.2.1"></times><ci id="S4.2.p2.4.m2.1.2.2.cmml" xref="S4.2.p2.4.m2.1.2.2">𝑂</ci><apply id="S4.2.p2.4.m2.1.1.cmml" xref="S4.2.p2.4.m2.1.2.3.2"><root id="S4.2.p2.4.m2.1.1a.cmml" xref="S4.2.p2.4.m2.1.2.3.2"></root><apply id="S4.2.p2.4.m2.1.1.2.cmml" xref="S4.2.p2.4.m2.1.1.2"><times id="S4.2.p2.4.m2.1.1.2.1.cmml" xref="S4.2.p2.4.m2.1.1.2.1"></times><ci id="S4.2.p2.4.m2.1.1.2.2.cmml" xref="S4.2.p2.4.m2.1.1.2.2">𝐿</ci><apply id="S4.2.p2.4.m2.1.1.2.3.cmml" xref="S4.2.p2.4.m2.1.1.2.3"><log id="S4.2.p2.4.m2.1.1.2.3.1.cmml" xref="S4.2.p2.4.m2.1.1.2.3.1"></log><ci id="S4.2.p2.4.m2.1.1.2.3.2.cmml" xref="S4.2.p2.4.m2.1.1.2.3.2">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.2.p2.4.m2.1c">O\left(\sqrt{L\log L}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.2.p2.4.m2.1d">italic_O ( square-root start_ARG italic_L roman_log italic_L end_ARG )</annotation></semantics></math> per iteration.
∎</p>
</div>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Case Study: Fast Online Spectral Filtering</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">We illustrate in more detail how the method works for the STU model in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg3" title="Algorithm 3 ‣ 4.1 Case Study: Fast Online Spectral Filtering ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">3</span></a>. It improves the amortized running time per iteration from <math alttext="O(L)" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><mi id="S4.SS1.p1.1.m1.1.2.2" xref="S4.SS1.p1.1.m1.1.2.2.cmml">O</mi><mo id="S4.SS1.p1.1.m1.1.2.1" xref="S4.SS1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.1.m1.1.2.3.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><mo id="S4.SS1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS1.p1.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">L</mi><mo id="S4.SS1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.2"><times id="S4.SS1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.1"></times><ci id="S4.SS1.p1.1.m1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2">𝑂</ci><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">O(L)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_O ( italic_L )</annotation></semantics></math> of the original spectral filtering algorithm from <cite class="ltx_cite ltx_citemacro_cite">Hazan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#bib.bib11" title="">2017</a>)</cite> to <math alttext="O(\sqrt{L})" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.2" xref="S4.SS1.p1.2.m2.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.2.2" xref="S4.SS1.p1.2.m2.1.2.2.cmml">O</mi><mo id="S4.SS1.p1.2.m2.1.2.1" xref="S4.SS1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.2.m2.1.2.3.2" xref="S4.SS1.p1.2.m2.1.1.cmml"><mo id="S4.SS1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS1.p1.2.m2.1.1.cmml">(</mo><msqrt id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">L</mi></msqrt><mo id="S4.SS1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS1.p1.2.m2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.2.cmml" xref="S4.SS1.p1.2.m2.1.2"><times id="S4.SS1.p1.2.m2.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2.1"></times><ci id="S4.SS1.p1.2.m2.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.2.2">𝑂</ci><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.2.3.2"><root id="S4.SS1.p1.2.m2.1.1a.cmml" xref="S4.SS1.p1.2.m2.1.2.3.2"></root><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">O(\sqrt{L})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_O ( square-root start_ARG italic_L end_ARG )</annotation></semantics></math>, albeit maintaining the same regret bound.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg3.2.1.1">Algorithm 3</span> </span> Efficient Spectral Filtering by FutureFill </figcaption>
<div class="ltx_listing ltx_listing" id="alg3.3">
<div class="ltx_listingline" id="alg3.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span class="ltx_text ltx_font_bold" id="alg3.l1.1">Input:</span> <math alttext="k&gt;0,L&gt;0" class="ltx_Math" display="inline" id="alg3.l1.m1.2"><semantics id="alg3.l1.m1.2a"><mrow id="alg3.l1.m1.2.2.2" xref="alg3.l1.m1.2.2.3.cmml"><mrow id="alg3.l1.m1.1.1.1.1" xref="alg3.l1.m1.1.1.1.1.cmml"><mi id="alg3.l1.m1.1.1.1.1.2" xref="alg3.l1.m1.1.1.1.1.2.cmml">k</mi><mo id="alg3.l1.m1.1.1.1.1.1" xref="alg3.l1.m1.1.1.1.1.1.cmml">&gt;</mo><mn id="alg3.l1.m1.1.1.1.1.3" xref="alg3.l1.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="alg3.l1.m1.2.2.2.3" xref="alg3.l1.m1.2.2.3a.cmml">,</mo><mrow id="alg3.l1.m1.2.2.2.2" xref="alg3.l1.m1.2.2.2.2.cmml"><mi id="alg3.l1.m1.2.2.2.2.2" xref="alg3.l1.m1.2.2.2.2.2.cmml">L</mi><mo id="alg3.l1.m1.2.2.2.2.1" xref="alg3.l1.m1.2.2.2.2.1.cmml">&gt;</mo><mn id="alg3.l1.m1.2.2.2.2.3" xref="alg3.l1.m1.2.2.2.2.3.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.2b"><apply id="alg3.l1.m1.2.2.3.cmml" xref="alg3.l1.m1.2.2.2"><csymbol cd="ambiguous" id="alg3.l1.m1.2.2.3a.cmml" xref="alg3.l1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg3.l1.m1.1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1.1"><gt id="alg3.l1.m1.1.1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1.1.1"></gt><ci id="alg3.l1.m1.1.1.1.1.2.cmml" xref="alg3.l1.m1.1.1.1.1.2">𝑘</ci><cn id="alg3.l1.m1.1.1.1.1.3.cmml" type="integer" xref="alg3.l1.m1.1.1.1.1.3">0</cn></apply><apply id="alg3.l1.m1.2.2.2.2.cmml" xref="alg3.l1.m1.2.2.2.2"><gt id="alg3.l1.m1.2.2.2.2.1.cmml" xref="alg3.l1.m1.2.2.2.2.1"></gt><ci id="alg3.l1.m1.2.2.2.2.2.cmml" xref="alg3.l1.m1.2.2.2.2.2">𝐿</ci><cn id="alg3.l1.m1.2.2.2.2.3.cmml" type="integer" xref="alg3.l1.m1.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.2c">k&gt;0,L&gt;0</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m1.2d">italic_k &gt; 0 , italic_L &gt; 0</annotation></semantics></math>. Set <math alttext="M_{1:k}^{1}\leftarrow 0" class="ltx_Math" display="inline" id="alg3.l1.m2.1"><semantics id="alg3.l1.m2.1a"><mrow id="alg3.l1.m2.1.1" xref="alg3.l1.m2.1.1.cmml"><msubsup id="alg3.l1.m2.1.1.2" xref="alg3.l1.m2.1.1.2.cmml"><mi id="alg3.l1.m2.1.1.2.2.2" xref="alg3.l1.m2.1.1.2.2.2.cmml">M</mi><mrow id="alg3.l1.m2.1.1.2.2.3" xref="alg3.l1.m2.1.1.2.2.3.cmml"><mn id="alg3.l1.m2.1.1.2.2.3.2" xref="alg3.l1.m2.1.1.2.2.3.2.cmml">1</mn><mo id="alg3.l1.m2.1.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg3.l1.m2.1.1.2.2.3.1.cmml">:</mo><mi id="alg3.l1.m2.1.1.2.2.3.3" xref="alg3.l1.m2.1.1.2.2.3.3.cmml">k</mi></mrow><mn id="alg3.l1.m2.1.1.2.3" xref="alg3.l1.m2.1.1.2.3.cmml">1</mn></msubsup><mo id="alg3.l1.m2.1.1.1" stretchy="false" xref="alg3.l1.m2.1.1.1.cmml">←</mo><mn id="alg3.l1.m2.1.1.3" xref="alg3.l1.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m2.1b"><apply id="alg3.l1.m2.1.1.cmml" xref="alg3.l1.m2.1.1"><ci id="alg3.l1.m2.1.1.1.cmml" xref="alg3.l1.m2.1.1.1">←</ci><apply id="alg3.l1.m2.1.1.2.cmml" xref="alg3.l1.m2.1.1.2"><csymbol cd="ambiguous" id="alg3.l1.m2.1.1.2.1.cmml" xref="alg3.l1.m2.1.1.2">superscript</csymbol><apply id="alg3.l1.m2.1.1.2.2.cmml" xref="alg3.l1.m2.1.1.2"><csymbol cd="ambiguous" id="alg3.l1.m2.1.1.2.2.1.cmml" xref="alg3.l1.m2.1.1.2">subscript</csymbol><ci id="alg3.l1.m2.1.1.2.2.2.cmml" xref="alg3.l1.m2.1.1.2.2.2">𝑀</ci><apply id="alg3.l1.m2.1.1.2.2.3.cmml" xref="alg3.l1.m2.1.1.2.2.3"><ci id="alg3.l1.m2.1.1.2.2.3.1.cmml" xref="alg3.l1.m2.1.1.2.2.3.1">:</ci><cn id="alg3.l1.m2.1.1.2.2.3.2.cmml" type="integer" xref="alg3.l1.m2.1.1.2.2.3.2">1</cn><ci id="alg3.l1.m2.1.1.2.2.3.3.cmml" xref="alg3.l1.m2.1.1.2.2.3.3">𝑘</ci></apply></apply><cn id="alg3.l1.m2.1.1.2.3.cmml" type="integer" xref="alg3.l1.m2.1.1.2.3">1</cn></apply><cn id="alg3.l1.m2.1.1.3.cmml" type="integer" xref="alg3.l1.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m2.1c">M_{1:k}^{1}\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m2.1d">italic_M start_POSTSUBSCRIPT 1 : italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ← 0</annotation></semantics></math>, <math alttext="\phi^{1:k}" class="ltx_Math" display="inline" id="alg3.l1.m3.1"><semantics id="alg3.l1.m3.1a"><msup id="alg3.l1.m3.1.1" xref="alg3.l1.m3.1.1.cmml"><mi id="alg3.l1.m3.1.1.2" xref="alg3.l1.m3.1.1.2.cmml">ϕ</mi><mrow id="alg3.l1.m3.1.1.3" xref="alg3.l1.m3.1.1.3.cmml"><mn id="alg3.l1.m3.1.1.3.2" xref="alg3.l1.m3.1.1.3.2.cmml">1</mn><mo id="alg3.l1.m3.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg3.l1.m3.1.1.3.1.cmml">:</mo><mi id="alg3.l1.m3.1.1.3.3" xref="alg3.l1.m3.1.1.3.3.cmml">k</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg3.l1.m3.1b"><apply id="alg3.l1.m3.1.1.cmml" xref="alg3.l1.m3.1.1"><csymbol cd="ambiguous" id="alg3.l1.m3.1.1.1.cmml" xref="alg3.l1.m3.1.1">superscript</csymbol><ci id="alg3.l1.m3.1.1.2.cmml" xref="alg3.l1.m3.1.1.2">italic-ϕ</ci><apply id="alg3.l1.m3.1.1.3.cmml" xref="alg3.l1.m3.1.1.3"><ci id="alg3.l1.m3.1.1.3.1.cmml" xref="alg3.l1.m3.1.1.3.1">:</ci><cn id="alg3.l1.m3.1.1.3.2.cmml" type="integer" xref="alg3.l1.m3.1.1.3.2">1</cn><ci id="alg3.l1.m3.1.1.3.3.cmml" xref="alg3.l1.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m3.1c">\phi^{1:k}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m3.1d">italic_ϕ start_POSTSUPERSCRIPT 1 : italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> are the largest eigenvectors of <math alttext="H_{L}" class="ltx_Math" display="inline" id="alg3.l1.m4.1"><semantics id="alg3.l1.m4.1a"><msub id="alg3.l1.m4.1.1" xref="alg3.l1.m4.1.1.cmml"><mi id="alg3.l1.m4.1.1.2" xref="alg3.l1.m4.1.1.2.cmml">H</mi><mi id="alg3.l1.m4.1.1.3" xref="alg3.l1.m4.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m4.1b"><apply id="alg3.l1.m4.1.1.cmml" xref="alg3.l1.m4.1.1"><csymbol cd="ambiguous" id="alg3.l1.m4.1.1.1.cmml" xref="alg3.l1.m4.1.1">subscript</csymbol><ci id="alg3.l1.m4.1.1.2.cmml" xref="alg3.l1.m4.1.1.2">𝐻</ci><ci id="alg3.l1.m4.1.1.3.cmml" xref="alg3.l1.m4.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m4.1c">H_{L}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m4.1d">italic_H start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg3.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  Set <math alttext="\tau=0" class="ltx_Math" display="inline" id="alg3.l2.m1.1"><semantics id="alg3.l2.m1.1a"><mrow id="alg3.l2.m1.1.1" xref="alg3.l2.m1.1.1.cmml"><mi id="alg3.l2.m1.1.1.2" xref="alg3.l2.m1.1.1.2.cmml">τ</mi><mo id="alg3.l2.m1.1.1.1" xref="alg3.l2.m1.1.1.1.cmml">=</mo><mn id="alg3.l2.m1.1.1.3" xref="alg3.l2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.1b"><apply id="alg3.l2.m1.1.1.cmml" xref="alg3.l2.m1.1.1"><eq id="alg3.l2.m1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1"></eq><ci id="alg3.l2.m1.1.1.2.cmml" xref="alg3.l2.m1.1.1.2">𝜏</ci><cn id="alg3.l2.m1.1.1.3.cmml" type="integer" xref="alg3.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.1c">\tau=0</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m1.1d">italic_τ = 0</annotation></semantics></math>, initialize cache <math alttext="\{C_{1}^{i},\ldots,C_{\sqrt{L}}^{i}\}" class="ltx_Math" display="inline" id="alg3.l2.m2.3"><semantics id="alg3.l2.m2.3a"><mrow id="alg3.l2.m2.3.3.2" xref="alg3.l2.m2.3.3.3.cmml"><mo id="alg3.l2.m2.3.3.2.3" stretchy="false" xref="alg3.l2.m2.3.3.3.cmml">{</mo><msubsup id="alg3.l2.m2.2.2.1.1" xref="alg3.l2.m2.2.2.1.1.cmml"><mi id="alg3.l2.m2.2.2.1.1.2.2" xref="alg3.l2.m2.2.2.1.1.2.2.cmml">C</mi><mn id="alg3.l2.m2.2.2.1.1.2.3" xref="alg3.l2.m2.2.2.1.1.2.3.cmml">1</mn><mi id="alg3.l2.m2.2.2.1.1.3" xref="alg3.l2.m2.2.2.1.1.3.cmml">i</mi></msubsup><mo id="alg3.l2.m2.3.3.2.4" xref="alg3.l2.m2.3.3.3.cmml">,</mo><mi id="alg3.l2.m2.1.1" mathvariant="normal" xref="alg3.l2.m2.1.1.cmml">…</mi><mo id="alg3.l2.m2.3.3.2.5" xref="alg3.l2.m2.3.3.3.cmml">,</mo><msubsup id="alg3.l2.m2.3.3.2.2" xref="alg3.l2.m2.3.3.2.2.cmml"><mi id="alg3.l2.m2.3.3.2.2.2.2" xref="alg3.l2.m2.3.3.2.2.2.2.cmml">C</mi><msqrt id="alg3.l2.m2.3.3.2.2.2.3" xref="alg3.l2.m2.3.3.2.2.2.3.cmml"><mi id="alg3.l2.m2.3.3.2.2.2.3.2" xref="alg3.l2.m2.3.3.2.2.2.3.2.cmml">L</mi></msqrt><mi id="alg3.l2.m2.3.3.2.2.3" xref="alg3.l2.m2.3.3.2.2.3.cmml">i</mi></msubsup><mo id="alg3.l2.m2.3.3.2.6" stretchy="false" xref="alg3.l2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m2.3b"><set id="alg3.l2.m2.3.3.3.cmml" xref="alg3.l2.m2.3.3.2"><apply id="alg3.l2.m2.2.2.1.1.cmml" xref="alg3.l2.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg3.l2.m2.2.2.1.1.1.cmml" xref="alg3.l2.m2.2.2.1.1">superscript</csymbol><apply id="alg3.l2.m2.2.2.1.1.2.cmml" xref="alg3.l2.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg3.l2.m2.2.2.1.1.2.1.cmml" xref="alg3.l2.m2.2.2.1.1">subscript</csymbol><ci id="alg3.l2.m2.2.2.1.1.2.2.cmml" xref="alg3.l2.m2.2.2.1.1.2.2">𝐶</ci><cn id="alg3.l2.m2.2.2.1.1.2.3.cmml" type="integer" xref="alg3.l2.m2.2.2.1.1.2.3">1</cn></apply><ci id="alg3.l2.m2.2.2.1.1.3.cmml" xref="alg3.l2.m2.2.2.1.1.3">𝑖</ci></apply><ci id="alg3.l2.m2.1.1.cmml" xref="alg3.l2.m2.1.1">…</ci><apply id="alg3.l2.m2.3.3.2.2.cmml" xref="alg3.l2.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg3.l2.m2.3.3.2.2.1.cmml" xref="alg3.l2.m2.3.3.2.2">superscript</csymbol><apply id="alg3.l2.m2.3.3.2.2.2.cmml" xref="alg3.l2.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg3.l2.m2.3.3.2.2.2.1.cmml" xref="alg3.l2.m2.3.3.2.2">subscript</csymbol><ci id="alg3.l2.m2.3.3.2.2.2.2.cmml" xref="alg3.l2.m2.3.3.2.2.2.2">𝐶</ci><apply id="alg3.l2.m2.3.3.2.2.2.3.cmml" xref="alg3.l2.m2.3.3.2.2.2.3"><root id="alg3.l2.m2.3.3.2.2.2.3a.cmml" xref="alg3.l2.m2.3.3.2.2.2.3"></root><ci id="alg3.l2.m2.3.3.2.2.2.3.2.cmml" xref="alg3.l2.m2.3.3.2.2.2.3.2">𝐿</ci></apply></apply><ci id="alg3.l2.m2.3.3.2.2.3.cmml" xref="alg3.l2.m2.3.3.2.2.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m2.3c">\{C_{1}^{i},\ldots,C_{\sqrt{L}}^{i}\}</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m2.3d">{ italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , … , italic_C start_POSTSUBSCRIPT square-root start_ARG italic_L end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT }</annotation></semantics></math> for <math alttext="i\in[k]" class="ltx_Math" display="inline" id="alg3.l2.m3.1"><semantics id="alg3.l2.m3.1a"><mrow id="alg3.l2.m3.1.2" xref="alg3.l2.m3.1.2.cmml"><mi id="alg3.l2.m3.1.2.2" xref="alg3.l2.m3.1.2.2.cmml">i</mi><mo id="alg3.l2.m3.1.2.1" xref="alg3.l2.m3.1.2.1.cmml">∈</mo><mrow id="alg3.l2.m3.1.2.3.2" xref="alg3.l2.m3.1.2.3.1.cmml"><mo id="alg3.l2.m3.1.2.3.2.1" stretchy="false" xref="alg3.l2.m3.1.2.3.1.1.cmml">[</mo><mi id="alg3.l2.m3.1.1" xref="alg3.l2.m3.1.1.cmml">k</mi><mo id="alg3.l2.m3.1.2.3.2.2" stretchy="false" xref="alg3.l2.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m3.1b"><apply id="alg3.l2.m3.1.2.cmml" xref="alg3.l2.m3.1.2"><in id="alg3.l2.m3.1.2.1.cmml" xref="alg3.l2.m3.1.2.1"></in><ci id="alg3.l2.m3.1.2.2.cmml" xref="alg3.l2.m3.1.2.2">𝑖</ci><apply id="alg3.l2.m3.1.2.3.1.cmml" xref="alg3.l2.m3.1.2.3.2"><csymbol cd="latexml" id="alg3.l2.m3.1.2.3.1.1.cmml" xref="alg3.l2.m3.1.2.3.2.1">delimited-[]</csymbol><ci id="alg3.l2.m3.1.1.cmml" xref="alg3.l2.m3.1.1">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m3.1c">i\in[k]</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m3.1d">italic_i ∈ [ italic_k ]</annotation></semantics></math>, with <math alttext="C_{1}^{i}=\cdots=C_{\sqrt{L}}^{i}=0\in\mathbb{R}^{d_{u}}" class="ltx_Math" display="inline" id="alg3.l2.m4.1"><semantics id="alg3.l2.m4.1a"><mrow id="alg3.l2.m4.1.1" xref="alg3.l2.m4.1.1.cmml"><msubsup id="alg3.l2.m4.1.1.2" xref="alg3.l2.m4.1.1.2.cmml"><mi id="alg3.l2.m4.1.1.2.2.2" xref="alg3.l2.m4.1.1.2.2.2.cmml">C</mi><mn id="alg3.l2.m4.1.1.2.2.3" xref="alg3.l2.m4.1.1.2.2.3.cmml">1</mn><mi id="alg3.l2.m4.1.1.2.3" xref="alg3.l2.m4.1.1.2.3.cmml">i</mi></msubsup><mo id="alg3.l2.m4.1.1.3" xref="alg3.l2.m4.1.1.3.cmml">=</mo><mi id="alg3.l2.m4.1.1.4" mathvariant="normal" xref="alg3.l2.m4.1.1.4.cmml">⋯</mi><mo id="alg3.l2.m4.1.1.5" xref="alg3.l2.m4.1.1.5.cmml">=</mo><msubsup id="alg3.l2.m4.1.1.6" xref="alg3.l2.m4.1.1.6.cmml"><mi id="alg3.l2.m4.1.1.6.2.2" xref="alg3.l2.m4.1.1.6.2.2.cmml">C</mi><msqrt id="alg3.l2.m4.1.1.6.2.3" xref="alg3.l2.m4.1.1.6.2.3.cmml"><mi id="alg3.l2.m4.1.1.6.2.3.2" xref="alg3.l2.m4.1.1.6.2.3.2.cmml">L</mi></msqrt><mi id="alg3.l2.m4.1.1.6.3" xref="alg3.l2.m4.1.1.6.3.cmml">i</mi></msubsup><mo id="alg3.l2.m4.1.1.7" xref="alg3.l2.m4.1.1.7.cmml">=</mo><mn id="alg3.l2.m4.1.1.8" xref="alg3.l2.m4.1.1.8.cmml">0</mn><mo id="alg3.l2.m4.1.1.9" xref="alg3.l2.m4.1.1.9.cmml">∈</mo><msup id="alg3.l2.m4.1.1.10" xref="alg3.l2.m4.1.1.10.cmml"><mi id="alg3.l2.m4.1.1.10.2" xref="alg3.l2.m4.1.1.10.2.cmml">ℝ</mi><msub id="alg3.l2.m4.1.1.10.3" xref="alg3.l2.m4.1.1.10.3.cmml"><mi id="alg3.l2.m4.1.1.10.3.2" xref="alg3.l2.m4.1.1.10.3.2.cmml">d</mi><mi id="alg3.l2.m4.1.1.10.3.3" xref="alg3.l2.m4.1.1.10.3.3.cmml">u</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m4.1b"><apply id="alg3.l2.m4.1.1.cmml" xref="alg3.l2.m4.1.1"><and id="alg3.l2.m4.1.1a.cmml" xref="alg3.l2.m4.1.1"></and><apply id="alg3.l2.m4.1.1b.cmml" xref="alg3.l2.m4.1.1"><eq id="alg3.l2.m4.1.1.3.cmml" xref="alg3.l2.m4.1.1.3"></eq><apply id="alg3.l2.m4.1.1.2.cmml" xref="alg3.l2.m4.1.1.2"><csymbol cd="ambiguous" id="alg3.l2.m4.1.1.2.1.cmml" xref="alg3.l2.m4.1.1.2">superscript</csymbol><apply id="alg3.l2.m4.1.1.2.2.cmml" xref="alg3.l2.m4.1.1.2"><csymbol cd="ambiguous" id="alg3.l2.m4.1.1.2.2.1.cmml" xref="alg3.l2.m4.1.1.2">subscript</csymbol><ci id="alg3.l2.m4.1.1.2.2.2.cmml" xref="alg3.l2.m4.1.1.2.2.2">𝐶</ci><cn id="alg3.l2.m4.1.1.2.2.3.cmml" type="integer" xref="alg3.l2.m4.1.1.2.2.3">1</cn></apply><ci id="alg3.l2.m4.1.1.2.3.cmml" xref="alg3.l2.m4.1.1.2.3">𝑖</ci></apply><ci id="alg3.l2.m4.1.1.4.cmml" xref="alg3.l2.m4.1.1.4">⋯</ci></apply><apply id="alg3.l2.m4.1.1c.cmml" xref="alg3.l2.m4.1.1"><eq id="alg3.l2.m4.1.1.5.cmml" xref="alg3.l2.m4.1.1.5"></eq><share href="https://arxiv.org/html/2410.03766v1#alg3.l2.m4.1.1.4.cmml" id="alg3.l2.m4.1.1d.cmml" xref="alg3.l2.m4.1.1"></share><apply id="alg3.l2.m4.1.1.6.cmml" xref="alg3.l2.m4.1.1.6"><csymbol cd="ambiguous" id="alg3.l2.m4.1.1.6.1.cmml" xref="alg3.l2.m4.1.1.6">superscript</csymbol><apply id="alg3.l2.m4.1.1.6.2.cmml" xref="alg3.l2.m4.1.1.6"><csymbol cd="ambiguous" id="alg3.l2.m4.1.1.6.2.1.cmml" xref="alg3.l2.m4.1.1.6">subscript</csymbol><ci id="alg3.l2.m4.1.1.6.2.2.cmml" xref="alg3.l2.m4.1.1.6.2.2">𝐶</ci><apply id="alg3.l2.m4.1.1.6.2.3.cmml" xref="alg3.l2.m4.1.1.6.2.3"><root id="alg3.l2.m4.1.1.6.2.3a.cmml" xref="alg3.l2.m4.1.1.6.2.3"></root><ci id="alg3.l2.m4.1.1.6.2.3.2.cmml" xref="alg3.l2.m4.1.1.6.2.3.2">𝐿</ci></apply></apply><ci id="alg3.l2.m4.1.1.6.3.cmml" xref="alg3.l2.m4.1.1.6.3">𝑖</ci></apply></apply><apply id="alg3.l2.m4.1.1e.cmml" xref="alg3.l2.m4.1.1"><eq id="alg3.l2.m4.1.1.7.cmml" xref="alg3.l2.m4.1.1.7"></eq><share href="https://arxiv.org/html/2410.03766v1#alg3.l2.m4.1.1.6.cmml" id="alg3.l2.m4.1.1f.cmml" xref="alg3.l2.m4.1.1"></share><cn id="alg3.l2.m4.1.1.8.cmml" type="integer" xref="alg3.l2.m4.1.1.8">0</cn></apply><apply id="alg3.l2.m4.1.1g.cmml" xref="alg3.l2.m4.1.1"><in id="alg3.l2.m4.1.1.9.cmml" xref="alg3.l2.m4.1.1.9"></in><share href="https://arxiv.org/html/2410.03766v1#alg3.l2.m4.1.1.8.cmml" id="alg3.l2.m4.1.1h.cmml" xref="alg3.l2.m4.1.1"></share><apply id="alg3.l2.m4.1.1.10.cmml" xref="alg3.l2.m4.1.1.10"><csymbol cd="ambiguous" id="alg3.l2.m4.1.1.10.1.cmml" xref="alg3.l2.m4.1.1.10">superscript</csymbol><ci id="alg3.l2.m4.1.1.10.2.cmml" xref="alg3.l2.m4.1.1.10.2">ℝ</ci><apply id="alg3.l2.m4.1.1.10.3.cmml" xref="alg3.l2.m4.1.1.10.3"><csymbol cd="ambiguous" id="alg3.l2.m4.1.1.10.3.1.cmml" xref="alg3.l2.m4.1.1.10.3">subscript</csymbol><ci id="alg3.l2.m4.1.1.10.3.2.cmml" xref="alg3.l2.m4.1.1.10.3.2">𝑑</ci><ci id="alg3.l2.m4.1.1.10.3.3.cmml" xref="alg3.l2.m4.1.1.10.3.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m4.1c">C_{1}^{i}=\cdots=C_{\sqrt{L}}^{i}=0\in\mathbb{R}^{d_{u}}</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m4.1d">italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = ⋯ = italic_C start_POSTSUBSCRIPT square-root start_ARG italic_L end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = 0 ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg3.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <span class="ltx_text ltx_font_bold" id="alg3.l3.1">for</span> <math alttext="t=1,2,...,L" class="ltx_Math" display="inline" id="alg3.l3.m1.4"><semantics id="alg3.l3.m1.4a"><mrow id="alg3.l3.m1.4.5" xref="alg3.l3.m1.4.5.cmml"><mi id="alg3.l3.m1.4.5.2" xref="alg3.l3.m1.4.5.2.cmml">t</mi><mo id="alg3.l3.m1.4.5.1" xref="alg3.l3.m1.4.5.1.cmml">=</mo><mrow id="alg3.l3.m1.4.5.3.2" xref="alg3.l3.m1.4.5.3.1.cmml"><mn id="alg3.l3.m1.1.1" xref="alg3.l3.m1.1.1.cmml">1</mn><mo id="alg3.l3.m1.4.5.3.2.1" xref="alg3.l3.m1.4.5.3.1.cmml">,</mo><mn id="alg3.l3.m1.2.2" xref="alg3.l3.m1.2.2.cmml">2</mn><mo id="alg3.l3.m1.4.5.3.2.2" xref="alg3.l3.m1.4.5.3.1.cmml">,</mo><mi id="alg3.l3.m1.3.3" mathvariant="normal" xref="alg3.l3.m1.3.3.cmml">…</mi><mo id="alg3.l3.m1.4.5.3.2.3" xref="alg3.l3.m1.4.5.3.1.cmml">,</mo><mi id="alg3.l3.m1.4.4" xref="alg3.l3.m1.4.4.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.4b"><apply id="alg3.l3.m1.4.5.cmml" xref="alg3.l3.m1.4.5"><eq id="alg3.l3.m1.4.5.1.cmml" xref="alg3.l3.m1.4.5.1"></eq><ci id="alg3.l3.m1.4.5.2.cmml" xref="alg3.l3.m1.4.5.2">𝑡</ci><list id="alg3.l3.m1.4.5.3.1.cmml" xref="alg3.l3.m1.4.5.3.2"><cn id="alg3.l3.m1.1.1.cmml" type="integer" xref="alg3.l3.m1.1.1">1</cn><cn id="alg3.l3.m1.2.2.cmml" type="integer" xref="alg3.l3.m1.2.2">2</cn><ci id="alg3.l3.m1.3.3.cmml" xref="alg3.l3.m1.3.3">…</ci><ci id="alg3.l3.m1.4.4.cmml" xref="alg3.l3.m1.4.4">𝐿</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.4c">t=1,2,...,L</annotation><annotation encoding="application/x-llamapun" id="alg3.l3.m1.4d">italic_t = 1 , 2 , … , italic_L</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.l3.2">do</span>
</div>
<div class="ltx_listingline" id="alg3.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l4.1">if</span>  <math alttext="\tau&gt;\sqrt{L}" class="ltx_Math" display="inline" id="alg3.l4.m1.1"><semantics id="alg3.l4.m1.1a"><mrow id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml"><mi id="alg3.l4.m1.1.1.2" xref="alg3.l4.m1.1.1.2.cmml">τ</mi><mo id="alg3.l4.m1.1.1.1" xref="alg3.l4.m1.1.1.1.cmml">&gt;</mo><msqrt id="alg3.l4.m1.1.1.3" xref="alg3.l4.m1.1.1.3.cmml"><mi id="alg3.l4.m1.1.1.3.2" xref="alg3.l4.m1.1.1.3.2.cmml">L</mi></msqrt></mrow><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><apply id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1"><gt id="alg3.l4.m1.1.1.1.cmml" xref="alg3.l4.m1.1.1.1"></gt><ci id="alg3.l4.m1.1.1.2.cmml" xref="alg3.l4.m1.1.1.2">𝜏</ci><apply id="alg3.l4.m1.1.1.3.cmml" xref="alg3.l4.m1.1.1.3"><root id="alg3.l4.m1.1.1.3a.cmml" xref="alg3.l4.m1.1.1.3"></root><ci id="alg3.l4.m1.1.1.3.2.cmml" xref="alg3.l4.m1.1.1.3.2">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">\tau&gt;\sqrt{L}</annotation><annotation encoding="application/x-llamapun" id="alg3.l4.m1.1d">italic_τ &gt; square-root start_ARG italic_L end_ARG</annotation></semantics></math>  <span class="ltx_text ltx_font_bold" id="alg3.l4.2">then</span>
</div>
<div class="ltx_listingline" id="alg3.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>        Compute via FFT convolution the following <math alttext="K\sqrt{L}" class="ltx_Math" display="inline" id="alg3.l5.m1.1"><semantics id="alg3.l5.m1.1a"><mrow id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml"><mi id="alg3.l5.m1.1.1.2" xref="alg3.l5.m1.1.1.2.cmml">K</mi><mo id="alg3.l5.m1.1.1.1" xref="alg3.l5.m1.1.1.1.cmml">⁢</mo><msqrt id="alg3.l5.m1.1.1.3" xref="alg3.l5.m1.1.1.3.cmml"><mi id="alg3.l5.m1.1.1.3.2" xref="alg3.l5.m1.1.1.3.2.cmml">L</mi></msqrt></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.1b"><apply id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1"><times id="alg3.l5.m1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1"></times><ci id="alg3.l5.m1.1.1.2.cmml" xref="alg3.l5.m1.1.1.2">𝐾</ci><apply id="alg3.l5.m1.1.1.3.cmml" xref="alg3.l5.m1.1.1.3"><root id="alg3.l5.m1.1.1.3a.cmml" xref="alg3.l5.m1.1.1.3"></root><ci id="alg3.l5.m1.1.1.3.2.cmml" xref="alg3.l5.m1.1.1.3.2">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.1c">K\sqrt{L}</annotation><annotation encoding="application/x-llamapun" id="alg3.l5.m1.1d">italic_K square-root start_ARG italic_L end_ARG</annotation></semantics></math> inner products and update the cache:

<table class="ltx_equation ltx_eqn_table" id="S4.Ex17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\forall j\in\{1,...,\sqrt{L}\},\ \ \forall i\in[k]\ \ ,\ \ C_{j}^{i}\leftarrow%
\langle\phi_{1:t+j}^{i},0_{j}u_{t:1}\rangle=\langle\phi_{j+1:t+j}^{i},u_{t:1}\rangle" class="ltx_math_unparsed" display="block" id="S4.Ex17.m1.4"><semantics id="S4.Ex17.m1.4a"><mrow id="S4.Ex17.m1.4b"><mo id="S4.Ex17.m1.4.5" rspace="0.167em">∀</mo><mi id="S4.Ex17.m1.4.6">j</mi><mo id="S4.Ex17.m1.4.7">∈</mo><mrow id="S4.Ex17.m1.4.8"><mo id="S4.Ex17.m1.4.8.1" stretchy="false">{</mo><mn id="S4.Ex17.m1.1.1">1</mn><mo id="S4.Ex17.m1.4.8.2">,</mo><mi id="S4.Ex17.m1.2.2" mathvariant="normal">…</mi><mo id="S4.Ex17.m1.4.8.3">,</mo><msqrt id="S4.Ex17.m1.3.3"><mi id="S4.Ex17.m1.3.3.2">L</mi></msqrt><mo id="S4.Ex17.m1.4.8.4" stretchy="false">}</mo></mrow><mo id="S4.Ex17.m1.4.9" rspace="1.167em">,</mo><mo id="S4.Ex17.m1.4.10" rspace="0.167em">∀</mo><mi id="S4.Ex17.m1.4.11">i</mi><mo id="S4.Ex17.m1.4.12">∈</mo><mrow id="S4.Ex17.m1.4.13"><mo id="S4.Ex17.m1.4.13.1" stretchy="false">[</mo><mi id="S4.Ex17.m1.4.4">k</mi><mo id="S4.Ex17.m1.4.13.2" stretchy="false">]</mo></mrow><mspace id="S4.Ex17.m1.4.14" width="1em"></mspace><mo id="S4.Ex17.m1.4.15" rspace="1.167em">,</mo><msubsup id="S4.Ex17.m1.4.16"><mi id="S4.Ex17.m1.4.16.2.2">C</mi><mi id="S4.Ex17.m1.4.16.2.3">j</mi><mi id="S4.Ex17.m1.4.16.3">i</mi></msubsup><mo id="S4.Ex17.m1.4.17" stretchy="false">←</mo><mrow id="S4.Ex17.m1.4.18"><mo id="S4.Ex17.m1.4.18.1" stretchy="false">⟨</mo><msubsup id="S4.Ex17.m1.4.18.2"><mi id="S4.Ex17.m1.4.18.2.2.2">ϕ</mi><mrow id="S4.Ex17.m1.4.18.2.2.3"><mn id="S4.Ex17.m1.4.18.2.2.3.2">1</mn><mo id="S4.Ex17.m1.4.18.2.2.3.1" lspace="0.278em" rspace="0.278em">:</mo><mrow id="S4.Ex17.m1.4.18.2.2.3.3"><mi id="S4.Ex17.m1.4.18.2.2.3.3.2">t</mi><mo id="S4.Ex17.m1.4.18.2.2.3.3.1">+</mo><mi id="S4.Ex17.m1.4.18.2.2.3.3.3">j</mi></mrow></mrow><mi id="S4.Ex17.m1.4.18.2.3">i</mi></msubsup><mo id="S4.Ex17.m1.4.18.3">,</mo><msub id="S4.Ex17.m1.4.18.4"><mn id="S4.Ex17.m1.4.18.4.2">0</mn><mi id="S4.Ex17.m1.4.18.4.3">j</mi></msub><msub id="S4.Ex17.m1.4.18.5"><mi id="S4.Ex17.m1.4.18.5.2">u</mi><mrow id="S4.Ex17.m1.4.18.5.3"><mi id="S4.Ex17.m1.4.18.5.3.2">t</mi><mo id="S4.Ex17.m1.4.18.5.3.1" lspace="0.278em" rspace="0.278em">:</mo><mn id="S4.Ex17.m1.4.18.5.3.3">1</mn></mrow></msub><mo id="S4.Ex17.m1.4.18.6" stretchy="false">⟩</mo></mrow><mo id="S4.Ex17.m1.4.19">=</mo><mrow id="S4.Ex17.m1.4.20"><mo id="S4.Ex17.m1.4.20.1" stretchy="false">⟨</mo><msubsup id="S4.Ex17.m1.4.20.2"><mi id="S4.Ex17.m1.4.20.2.2.2">ϕ</mi><mrow id="S4.Ex17.m1.4.20.2.2.3"><mrow id="S4.Ex17.m1.4.20.2.2.3.2"><mi id="S4.Ex17.m1.4.20.2.2.3.2.2">j</mi><mo id="S4.Ex17.m1.4.20.2.2.3.2.1">+</mo><mn id="S4.Ex17.m1.4.20.2.2.3.2.3">1</mn></mrow><mo id="S4.Ex17.m1.4.20.2.2.3.1" lspace="0.278em" rspace="0.278em">:</mo><mrow id="S4.Ex17.m1.4.20.2.2.3.3"><mi id="S4.Ex17.m1.4.20.2.2.3.3.2">t</mi><mo id="S4.Ex17.m1.4.20.2.2.3.3.1">+</mo><mi id="S4.Ex17.m1.4.20.2.2.3.3.3">j</mi></mrow></mrow><mi id="S4.Ex17.m1.4.20.2.3">i</mi></msubsup><mo id="S4.Ex17.m1.4.20.3">,</mo><msub id="S4.Ex17.m1.4.20.4"><mi id="S4.Ex17.m1.4.20.4.2">u</mi><mrow id="S4.Ex17.m1.4.20.4.3"><mi id="S4.Ex17.m1.4.20.4.3.2">t</mi><mo id="S4.Ex17.m1.4.20.4.3.1" lspace="0.278em" rspace="0.278em">:</mo><mn id="S4.Ex17.m1.4.20.4.3.3">1</mn></mrow></msub><mo id="S4.Ex17.m1.4.20.5" stretchy="false">⟩</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.Ex17.m1.4c">\forall j\in\{1,...,\sqrt{L}\},\ \ \forall i\in[k]\ \ ,\ \ C_{j}^{i}\leftarrow%
\langle\phi_{1:t+j}^{i},0_{j}u_{t:1}\rangle=\langle\phi_{j+1:t+j}^{i},u_{t:1}\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.Ex17.m1.4d">∀ italic_j ∈ { 1 , … , square-root start_ARG italic_L end_ARG } , ∀ italic_i ∈ [ italic_k ] , italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← ⟨ italic_ϕ start_POSTSUBSCRIPT 1 : italic_t + italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , 0 start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_t : 1 end_POSTSUBSCRIPT ⟩ = ⟨ italic_ϕ start_POSTSUBSCRIPT italic_j + 1 : italic_t + italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_u start_POSTSUBSCRIPT italic_t : 1 end_POSTSUBSCRIPT ⟩</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>        Set <math alttext="\tau\leftarrow 1" class="ltx_Math" display="inline" id="alg3.l6.m1.1"><semantics id="alg3.l6.m1.1a"><mrow id="alg3.l6.m1.1.1" xref="alg3.l6.m1.1.1.cmml"><mi id="alg3.l6.m1.1.1.2" xref="alg3.l6.m1.1.1.2.cmml">τ</mi><mo id="alg3.l6.m1.1.1.1" stretchy="false" xref="alg3.l6.m1.1.1.1.cmml">←</mo><mn id="alg3.l6.m1.1.1.3" xref="alg3.l6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.1b"><apply id="alg3.l6.m1.1.1.cmml" xref="alg3.l6.m1.1.1"><ci id="alg3.l6.m1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1">←</ci><ci id="alg3.l6.m1.1.1.2.cmml" xref="alg3.l6.m1.1.1.2">𝜏</ci><cn id="alg3.l6.m1.1.1.3.cmml" type="integer" xref="alg3.l6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.1c">\tau\leftarrow 1</annotation><annotation encoding="application/x-llamapun" id="alg3.l6.m1.1d">italic_τ ← 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l7.1">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l7.2">if</span>
</div>
<div class="ltx_listingline" id="alg3.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>      Compute and predict

<table class="ltx_equation ltx_eqn_table" id="S4.Ex18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}_{t}=\sum_{i=1}^{k}M_{i}^{t}\left(\sum_{j=1}^{\tau}\phi_{j}^{i}u_{t+1-j%
}+C_{\tau}^{i}\right)." class="ltx_Math" display="block" id="S4.Ex18.m1.1"><semantics id="S4.Ex18.m1.1a"><mrow id="S4.Ex18.m1.1.1.1" xref="S4.Ex18.m1.1.1.1.1.cmml"><mrow id="S4.Ex18.m1.1.1.1.1" xref="S4.Ex18.m1.1.1.1.1.cmml"><msub id="S4.Ex18.m1.1.1.1.1.3" xref="S4.Ex18.m1.1.1.1.1.3.cmml"><mover accent="true" id="S4.Ex18.m1.1.1.1.1.3.2" xref="S4.Ex18.m1.1.1.1.1.3.2.cmml"><mi id="S4.Ex18.m1.1.1.1.1.3.2.2" xref="S4.Ex18.m1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S4.Ex18.m1.1.1.1.1.3.2.1" xref="S4.Ex18.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.Ex18.m1.1.1.1.1.3.3" xref="S4.Ex18.m1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S4.Ex18.m1.1.1.1.1.2" rspace="0.111em" xref="S4.Ex18.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.Ex18.m1.1.1.1.1.1" xref="S4.Ex18.m1.1.1.1.1.1.cmml"><munderover id="S4.Ex18.m1.1.1.1.1.1.2" xref="S4.Ex18.m1.1.1.1.1.1.2.cmml"><mo id="S4.Ex18.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.Ex18.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.Ex18.m1.1.1.1.1.1.2.2.3" xref="S4.Ex18.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.Ex18.m1.1.1.1.1.1.2.2.3.2" xref="S4.Ex18.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.Ex18.m1.1.1.1.1.1.2.2.3.1" xref="S4.Ex18.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.Ex18.m1.1.1.1.1.1.2.2.3.3" xref="S4.Ex18.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex18.m1.1.1.1.1.1.2.3" xref="S4.Ex18.m1.1.1.1.1.1.2.3.cmml">k</mi></munderover><mrow id="S4.Ex18.m1.1.1.1.1.1.1" xref="S4.Ex18.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.Ex18.m1.1.1.1.1.1.1.3" xref="S4.Ex18.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex18.m1.1.1.1.1.1.1.3.2.2" xref="S4.Ex18.m1.1.1.1.1.1.1.3.2.2.cmml">M</mi><mi id="S4.Ex18.m1.1.1.1.1.1.1.3.2.3" xref="S4.Ex18.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.Ex18.m1.1.1.1.1.1.1.3.3" xref="S4.Ex18.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msubsup><mo id="S4.Ex18.m1.1.1.1.1.1.1.2" xref="S4.Ex18.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex18.m1.1.1.1.1.1.1.1.1" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex18.m1.1.1.1.1.1.1.1.1.2" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.cmml"><munderover id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.cmml"><mo id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.2" lspace="0em" movablelimits="false" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.cmml"><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.2" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.2.cmml">j</mi><mo id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.1" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.3.cmml">τ</mi></munderover><mrow id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><msubsup id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">ϕ</mi><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">j</mi><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><msub id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">u</mi><mrow id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml"><mrow id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.cmml"><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.2" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.2.cmml">t</mi><mo id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.1" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.1.cmml">+</mo><mn id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.3.cmml">1</mn></mrow><mo id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.1" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.1.cmml">−</mo><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">C</mi><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">τ</mi><mi id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msubsup></mrow><mo id="S4.Ex18.m1.1.1.1.1.1.1.1.1.3" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.Ex18.m1.1.1.1.2" lspace="0em" xref="S4.Ex18.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex18.m1.1b"><apply id="S4.Ex18.m1.1.1.1.1.cmml" xref="S4.Ex18.m1.1.1.1"><eq id="S4.Ex18.m1.1.1.1.1.2.cmml" xref="S4.Ex18.m1.1.1.1.1.2"></eq><apply id="S4.Ex18.m1.1.1.1.1.3.cmml" xref="S4.Ex18.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.3.1.cmml" xref="S4.Ex18.m1.1.1.1.1.3">subscript</csymbol><apply id="S4.Ex18.m1.1.1.1.1.3.2.cmml" xref="S4.Ex18.m1.1.1.1.1.3.2"><ci id="S4.Ex18.m1.1.1.1.1.3.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.3.2.1">^</ci><ci id="S4.Ex18.m1.1.1.1.1.3.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="S4.Ex18.m1.1.1.1.1.3.3.cmml" xref="S4.Ex18.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S4.Ex18.m1.1.1.1.1.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1"><apply id="S4.Ex18.m1.1.1.1.1.1.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.Ex18.m1.1.1.1.1.1.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.Ex18.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.2.2.2"></sum><apply id="S4.Ex18.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.2.2.3"><eq id="S4.Ex18.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.Ex18.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.Ex18.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.Ex18.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex18.m1.1.1.1.1.1.2.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.Ex18.m1.1.1.1.1.1.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1"><times id="S4.Ex18.m1.1.1.1.1.1.1.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.2"></times><apply id="S4.Ex18.m1.1.1.1.1.1.1.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.Ex18.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex18.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.3.2.2">𝑀</ci><ci id="S4.Ex18.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.Ex18.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1"><plus id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2"><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.2"></sum><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3"><eq id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.1"></eq><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.2">𝑗</ci><cn id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.3.cmml" type="integer" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.1.3">𝜏</ci></apply><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2"><times id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.1"></times><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">italic-ϕ</ci><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑗</ci></apply><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑢</ci><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3"><minus id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.1"></minus><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2"><plus id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.1"></plus><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.2">𝑡</ci><cn id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.3.cmml" type="integer" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.3">1</cn></apply><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝐶</ci><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝜏</ci></apply><ci id="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex18.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex18.m1.1c">\hat{y}_{t}=\sum_{i=1}^{k}M_{i}^{t}\left(\sum_{j=1}^{\tau}\phi_{j}^{i}u_{t+1-j%
}+C_{\tau}^{i}\right).</annotation><annotation encoding="application/x-llamapun" id="S4.Ex18.m1.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT italic_ϕ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_t + 1 - italic_j end_POSTSUBSCRIPT + italic_C start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math alttext="\tau\leftarrow\tau+1" class="ltx_Math" display="inline" id="alg3.l9.m1.1"><semantics id="alg3.l9.m1.1a"><mrow id="alg3.l9.m1.1.1" xref="alg3.l9.m1.1.1.cmml"><mi id="alg3.l9.m1.1.1.2" xref="alg3.l9.m1.1.1.2.cmml">τ</mi><mo id="alg3.l9.m1.1.1.1" stretchy="false" xref="alg3.l9.m1.1.1.1.cmml">←</mo><mrow id="alg3.l9.m1.1.1.3" xref="alg3.l9.m1.1.1.3.cmml"><mi id="alg3.l9.m1.1.1.3.2" xref="alg3.l9.m1.1.1.3.2.cmml">τ</mi><mo id="alg3.l9.m1.1.1.3.1" xref="alg3.l9.m1.1.1.3.1.cmml">+</mo><mn id="alg3.l9.m1.1.1.3.3" xref="alg3.l9.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.m1.1b"><apply id="alg3.l9.m1.1.1.cmml" xref="alg3.l9.m1.1.1"><ci id="alg3.l9.m1.1.1.1.cmml" xref="alg3.l9.m1.1.1.1">←</ci><ci id="alg3.l9.m1.1.1.2.cmml" xref="alg3.l9.m1.1.1.2">𝜏</ci><apply id="alg3.l9.m1.1.1.3.cmml" xref="alg3.l9.m1.1.1.3"><plus id="alg3.l9.m1.1.1.3.1.cmml" xref="alg3.l9.m1.1.1.3.1"></plus><ci id="alg3.l9.m1.1.1.3.2.cmml" xref="alg3.l9.m1.1.1.3.2">𝜏</ci><cn id="alg3.l9.m1.1.1.3.3.cmml" type="integer" xref="alg3.l9.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.m1.1c">\tau\leftarrow\tau+1</annotation><annotation encoding="application/x-llamapun" id="alg3.l9.m1.1d">italic_τ ← italic_τ + 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     Observe <math alttext="y_{t}" class="ltx_Math" display="inline" id="alg3.l10.m1.1"><semantics id="alg3.l10.m1.1a"><msub id="alg3.l10.m1.1.1" xref="alg3.l10.m1.1.1.cmml"><mi id="alg3.l10.m1.1.1.2" xref="alg3.l10.m1.1.1.2.cmml">y</mi><mi id="alg3.l10.m1.1.1.3" xref="alg3.l10.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l10.m1.1b"><apply id="alg3.l10.m1.1.1.cmml" xref="alg3.l10.m1.1.1"><csymbol cd="ambiguous" id="alg3.l10.m1.1.1.1.cmml" xref="alg3.l10.m1.1.1">subscript</csymbol><ci id="alg3.l10.m1.1.1.2.cmml" xref="alg3.l10.m1.1.1.2">𝑦</ci><ci id="alg3.l10.m1.1.1.3.cmml" xref="alg3.l10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.m1.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="alg3.l10.m1.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, suffer loss <math alttext="\ell_{t}(M_{1:k}^{t})=\|y_{t}-\hat{y}_{t}\|^{2}" class="ltx_Math" display="inline" id="alg3.l10.m2.2"><semantics id="alg3.l10.m2.2a"><mrow id="alg3.l10.m2.2.2" xref="alg3.l10.m2.2.2.cmml"><mrow id="alg3.l10.m2.1.1.1" xref="alg3.l10.m2.1.1.1.cmml"><msub id="alg3.l10.m2.1.1.1.3" xref="alg3.l10.m2.1.1.1.3.cmml"><mi id="alg3.l10.m2.1.1.1.3.2" mathvariant="normal" xref="alg3.l10.m2.1.1.1.3.2.cmml">ℓ</mi><mi id="alg3.l10.m2.1.1.1.3.3" xref="alg3.l10.m2.1.1.1.3.3.cmml">t</mi></msub><mo id="alg3.l10.m2.1.1.1.2" xref="alg3.l10.m2.1.1.1.2.cmml">⁢</mo><mrow id="alg3.l10.m2.1.1.1.1.1" xref="alg3.l10.m2.1.1.1.1.1.1.cmml"><mo id="alg3.l10.m2.1.1.1.1.1.2" stretchy="false" xref="alg3.l10.m2.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg3.l10.m2.1.1.1.1.1.1" xref="alg3.l10.m2.1.1.1.1.1.1.cmml"><mi id="alg3.l10.m2.1.1.1.1.1.1.2.2" xref="alg3.l10.m2.1.1.1.1.1.1.2.2.cmml">M</mi><mrow id="alg3.l10.m2.1.1.1.1.1.1.2.3" xref="alg3.l10.m2.1.1.1.1.1.1.2.3.cmml"><mn id="alg3.l10.m2.1.1.1.1.1.1.2.3.2" xref="alg3.l10.m2.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="alg3.l10.m2.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg3.l10.m2.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="alg3.l10.m2.1.1.1.1.1.1.2.3.3" xref="alg3.l10.m2.1.1.1.1.1.1.2.3.3.cmml">k</mi></mrow><mi id="alg3.l10.m2.1.1.1.1.1.1.3" xref="alg3.l10.m2.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="alg3.l10.m2.1.1.1.1.1.3" stretchy="false" xref="alg3.l10.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg3.l10.m2.2.2.3" xref="alg3.l10.m2.2.2.3.cmml">=</mo><msup id="alg3.l10.m2.2.2.2" xref="alg3.l10.m2.2.2.2.cmml"><mrow id="alg3.l10.m2.2.2.2.1.1" xref="alg3.l10.m2.2.2.2.1.2.cmml"><mo id="alg3.l10.m2.2.2.2.1.1.2" stretchy="false" xref="alg3.l10.m2.2.2.2.1.2.1.cmml">‖</mo><mrow id="alg3.l10.m2.2.2.2.1.1.1" xref="alg3.l10.m2.2.2.2.1.1.1.cmml"><msub id="alg3.l10.m2.2.2.2.1.1.1.2" xref="alg3.l10.m2.2.2.2.1.1.1.2.cmml"><mi id="alg3.l10.m2.2.2.2.1.1.1.2.2" xref="alg3.l10.m2.2.2.2.1.1.1.2.2.cmml">y</mi><mi id="alg3.l10.m2.2.2.2.1.1.1.2.3" xref="alg3.l10.m2.2.2.2.1.1.1.2.3.cmml">t</mi></msub><mo id="alg3.l10.m2.2.2.2.1.1.1.1" xref="alg3.l10.m2.2.2.2.1.1.1.1.cmml">−</mo><msub id="alg3.l10.m2.2.2.2.1.1.1.3" xref="alg3.l10.m2.2.2.2.1.1.1.3.cmml"><mover accent="true" id="alg3.l10.m2.2.2.2.1.1.1.3.2" xref="alg3.l10.m2.2.2.2.1.1.1.3.2.cmml"><mi id="alg3.l10.m2.2.2.2.1.1.1.3.2.2" xref="alg3.l10.m2.2.2.2.1.1.1.3.2.2.cmml">y</mi><mo id="alg3.l10.m2.2.2.2.1.1.1.3.2.1" xref="alg3.l10.m2.2.2.2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="alg3.l10.m2.2.2.2.1.1.1.3.3" xref="alg3.l10.m2.2.2.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="alg3.l10.m2.2.2.2.1.1.3" stretchy="false" xref="alg3.l10.m2.2.2.2.1.2.1.cmml">‖</mo></mrow><mn id="alg3.l10.m2.2.2.2.3" xref="alg3.l10.m2.2.2.2.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l10.m2.2b"><apply id="alg3.l10.m2.2.2.cmml" xref="alg3.l10.m2.2.2"><eq id="alg3.l10.m2.2.2.3.cmml" xref="alg3.l10.m2.2.2.3"></eq><apply id="alg3.l10.m2.1.1.1.cmml" xref="alg3.l10.m2.1.1.1"><times id="alg3.l10.m2.1.1.1.2.cmml" xref="alg3.l10.m2.1.1.1.2"></times><apply id="alg3.l10.m2.1.1.1.3.cmml" xref="alg3.l10.m2.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l10.m2.1.1.1.3.1.cmml" xref="alg3.l10.m2.1.1.1.3">subscript</csymbol><ci id="alg3.l10.m2.1.1.1.3.2.cmml" xref="alg3.l10.m2.1.1.1.3.2">ℓ</ci><ci id="alg3.l10.m2.1.1.1.3.3.cmml" xref="alg3.l10.m2.1.1.1.3.3">𝑡</ci></apply><apply id="alg3.l10.m2.1.1.1.1.1.1.cmml" xref="alg3.l10.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l10.m2.1.1.1.1.1.1.1.cmml" xref="alg3.l10.m2.1.1.1.1.1">superscript</csymbol><apply id="alg3.l10.m2.1.1.1.1.1.1.2.cmml" xref="alg3.l10.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l10.m2.1.1.1.1.1.1.2.1.cmml" xref="alg3.l10.m2.1.1.1.1.1">subscript</csymbol><ci id="alg3.l10.m2.1.1.1.1.1.1.2.2.cmml" xref="alg3.l10.m2.1.1.1.1.1.1.2.2">𝑀</ci><apply id="alg3.l10.m2.1.1.1.1.1.1.2.3.cmml" xref="alg3.l10.m2.1.1.1.1.1.1.2.3"><ci id="alg3.l10.m2.1.1.1.1.1.1.2.3.1.cmml" xref="alg3.l10.m2.1.1.1.1.1.1.2.3.1">:</ci><cn id="alg3.l10.m2.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="alg3.l10.m2.1.1.1.1.1.1.2.3.2">1</cn><ci id="alg3.l10.m2.1.1.1.1.1.1.2.3.3.cmml" xref="alg3.l10.m2.1.1.1.1.1.1.2.3.3">𝑘</ci></apply></apply><ci id="alg3.l10.m2.1.1.1.1.1.1.3.cmml" xref="alg3.l10.m2.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="alg3.l10.m2.2.2.2.cmml" xref="alg3.l10.m2.2.2.2"><csymbol cd="ambiguous" id="alg3.l10.m2.2.2.2.2.cmml" xref="alg3.l10.m2.2.2.2">superscript</csymbol><apply id="alg3.l10.m2.2.2.2.1.2.cmml" xref="alg3.l10.m2.2.2.2.1.1"><csymbol cd="latexml" id="alg3.l10.m2.2.2.2.1.2.1.cmml" xref="alg3.l10.m2.2.2.2.1.1.2">norm</csymbol><apply id="alg3.l10.m2.2.2.2.1.1.1.cmml" xref="alg3.l10.m2.2.2.2.1.1.1"><minus id="alg3.l10.m2.2.2.2.1.1.1.1.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.1"></minus><apply id="alg3.l10.m2.2.2.2.1.1.1.2.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l10.m2.2.2.2.1.1.1.2.1.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.2">subscript</csymbol><ci id="alg3.l10.m2.2.2.2.1.1.1.2.2.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.2.2">𝑦</ci><ci id="alg3.l10.m2.2.2.2.1.1.1.2.3.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.2.3">𝑡</ci></apply><apply id="alg3.l10.m2.2.2.2.1.1.1.3.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l10.m2.2.2.2.1.1.1.3.1.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.3">subscript</csymbol><apply id="alg3.l10.m2.2.2.2.1.1.1.3.2.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.3.2"><ci id="alg3.l10.m2.2.2.2.1.1.1.3.2.1.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.3.2.1">^</ci><ci id="alg3.l10.m2.2.2.2.1.1.1.3.2.2.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.3.2.2">𝑦</ci></apply><ci id="alg3.l10.m2.2.2.2.1.1.1.3.3.cmml" xref="alg3.l10.m2.2.2.2.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn id="alg3.l10.m2.2.2.2.3.cmml" type="integer" xref="alg3.l10.m2.2.2.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.m2.2c">\ell_{t}(M_{1:k}^{t})=\|y_{t}-\hat{y}_{t}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="alg3.l10.m2.2d">roman_ℓ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_M start_POSTSUBSCRIPT 1 : italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) = ∥ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, and update

<table class="ltx_equation ltx_eqn_table" id="S4.Ex19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M^{t+1}_{1:k}\leftarrow\nabla\mkern-2.5mu\ell_{t}(M^{t}_{1:k})." class="ltx_Math" display="block" id="S4.Ex19.m1.1"><semantics id="S4.Ex19.m1.1a"><mrow id="S4.Ex19.m1.1.1.1" xref="S4.Ex19.m1.1.1.1.1.cmml"><mrow id="S4.Ex19.m1.1.1.1.1" xref="S4.Ex19.m1.1.1.1.1.cmml"><msubsup id="S4.Ex19.m1.1.1.1.1.3" xref="S4.Ex19.m1.1.1.1.1.3.cmml"><mi id="S4.Ex19.m1.1.1.1.1.3.2.2" xref="S4.Ex19.m1.1.1.1.1.3.2.2.cmml">M</mi><mrow id="S4.Ex19.m1.1.1.1.1.3.3" xref="S4.Ex19.m1.1.1.1.1.3.3.cmml"><mn id="S4.Ex19.m1.1.1.1.1.3.3.2" xref="S4.Ex19.m1.1.1.1.1.3.3.2.cmml">1</mn><mo id="S4.Ex19.m1.1.1.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S4.Ex19.m1.1.1.1.1.3.3.1.cmml">:</mo><mi id="S4.Ex19.m1.1.1.1.1.3.3.3" xref="S4.Ex19.m1.1.1.1.1.3.3.3.cmml">k</mi></mrow><mrow id="S4.Ex19.m1.1.1.1.1.3.2.3" xref="S4.Ex19.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.Ex19.m1.1.1.1.1.3.2.3.2" xref="S4.Ex19.m1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S4.Ex19.m1.1.1.1.1.3.2.3.1" xref="S4.Ex19.m1.1.1.1.1.3.2.3.1.cmml">+</mo><mn id="S4.Ex19.m1.1.1.1.1.3.2.3.3" xref="S4.Ex19.m1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.Ex19.m1.1.1.1.1.2" stretchy="false" xref="S4.Ex19.m1.1.1.1.1.2.cmml">←</mo><mrow id="S4.Ex19.m1.1.1.1.1.1" xref="S4.Ex19.m1.1.1.1.1.1.cmml"><mrow id="S4.Ex19.m1.1.1.1.1.1.3" xref="S4.Ex19.m1.1.1.1.1.1.3.cmml"><mo id="S4.Ex19.m1.1.1.1.1.1.3.1" rspace="0.027em" xref="S4.Ex19.m1.1.1.1.1.1.3.1.cmml">∇</mo><msub id="S4.Ex19.m1.1.1.1.1.1.3.2" xref="S4.Ex19.m1.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex19.m1.1.1.1.1.1.3.2.2" mathvariant="normal" xref="S4.Ex19.m1.1.1.1.1.1.3.2.2.cmml">ℓ</mi><mi id="S4.Ex19.m1.1.1.1.1.1.3.2.3" xref="S4.Ex19.m1.1.1.1.1.1.3.2.3.cmml">t</mi></msub></mrow><mo id="S4.Ex19.m1.1.1.1.1.1.2" xref="S4.Ex19.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex19.m1.1.1.1.1.1.1.1" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex19.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.Ex19.m1.1.1.1.1.1.1.1.1" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex19.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.2.2.cmml">M</mi><mrow id="S4.Ex19.m1.1.1.1.1.1.1.1.1.3" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></mrow><mi id="S4.Ex19.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S4.Ex19.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex19.m1.1.1.1.2" lspace="0em" xref="S4.Ex19.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex19.m1.1b"><apply id="S4.Ex19.m1.1.1.1.1.cmml" xref="S4.Ex19.m1.1.1.1"><ci id="S4.Ex19.m1.1.1.1.1.2.cmml" xref="S4.Ex19.m1.1.1.1.1.2">←</ci><apply id="S4.Ex19.m1.1.1.1.1.3.cmml" xref="S4.Ex19.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex19.m1.1.1.1.1.3.1.cmml" xref="S4.Ex19.m1.1.1.1.1.3">subscript</csymbol><apply id="S4.Ex19.m1.1.1.1.1.3.2.cmml" xref="S4.Ex19.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex19.m1.1.1.1.1.3.2.1.cmml" xref="S4.Ex19.m1.1.1.1.1.3">superscript</csymbol><ci id="S4.Ex19.m1.1.1.1.1.3.2.2.cmml" xref="S4.Ex19.m1.1.1.1.1.3.2.2">𝑀</ci><apply id="S4.Ex19.m1.1.1.1.1.3.2.3.cmml" xref="S4.Ex19.m1.1.1.1.1.3.2.3"><plus id="S4.Ex19.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.Ex19.m1.1.1.1.1.3.2.3.1"></plus><ci id="S4.Ex19.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.Ex19.m1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="S4.Ex19.m1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S4.Ex19.m1.1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S4.Ex19.m1.1.1.1.1.3.3.cmml" xref="S4.Ex19.m1.1.1.1.1.3.3"><ci id="S4.Ex19.m1.1.1.1.1.3.3.1.cmml" xref="S4.Ex19.m1.1.1.1.1.3.3.1">:</ci><cn id="S4.Ex19.m1.1.1.1.1.3.3.2.cmml" type="integer" xref="S4.Ex19.m1.1.1.1.1.3.3.2">1</cn><ci id="S4.Ex19.m1.1.1.1.1.3.3.3.cmml" xref="S4.Ex19.m1.1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S4.Ex19.m1.1.1.1.1.1.cmml" xref="S4.Ex19.m1.1.1.1.1.1"><times id="S4.Ex19.m1.1.1.1.1.1.2.cmml" xref="S4.Ex19.m1.1.1.1.1.1.2"></times><apply id="S4.Ex19.m1.1.1.1.1.1.3.cmml" xref="S4.Ex19.m1.1.1.1.1.1.3"><ci id="S4.Ex19.m1.1.1.1.1.1.3.1.cmml" xref="S4.Ex19.m1.1.1.1.1.1.3.1">∇</ci><apply id="S4.Ex19.m1.1.1.1.1.1.3.2.cmml" xref="S4.Ex19.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex19.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex19.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.Ex19.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex19.m1.1.1.1.1.1.3.2.2">ℓ</ci><ci id="S4.Ex19.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex19.m1.1.1.1.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S4.Ex19.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex19.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex19.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex19.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.Ex19.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex19.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex19.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex19.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.Ex19.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.2.2">𝑀</ci><ci id="S4.Ex19.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.3"><ci id="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex19.m1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex19.m1.1c">M^{t+1}_{1:k}\leftarrow\nabla\mkern-2.5mu\ell_{t}(M^{t}_{1:k}).</annotation><annotation encoding="application/x-llamapun" id="S4.Ex19.m1.1d">italic_M start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_k end_POSTSUBSCRIPT ← ∇ roman_ℓ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_k end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg3.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>  <span class="ltx_text ltx_font_bold" id="alg3.l11.1">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l11.2">for</span>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">The main claim regarding its performance follows directly from Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#Thmtheorem2" title="Lemma 2. ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">2</span></a> is as follows.</p>
</div>
<div class="ltx_theorem ltx_theorem_corollary" id="Thmtheorem3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem3.1.1.1">Corollary 3</span></span><span class="ltx_text ltx_font_bold" id="Thmtheorem3.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem3.p1">
<p class="ltx_p" id="Thmtheorem3.p1.3"><span class="ltx_text ltx_font_italic" id="Thmtheorem3.p1.3.3">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg3" title="Algorithm 3 ‣ 4.1 Case Study: Fast Online Spectral Filtering ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">3</span></a> with sequence length <math alttext="L" class="ltx_Math" display="inline" id="Thmtheorem3.p1.1.1.m1.1"><semantics id="Thmtheorem3.p1.1.1.m1.1a"><mi id="Thmtheorem3.p1.1.1.m1.1.1" xref="Thmtheorem3.p1.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.1.1.m1.1b"><ci id="Thmtheorem3.p1.1.1.m1.1.1.cmml" xref="Thmtheorem3.p1.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.1.1.m1.1d">italic_L</annotation></semantics></math> runs in amortized time <math alttext="O({\sqrt{L\log L}})" class="ltx_Math" display="inline" id="Thmtheorem3.p1.2.2.m2.1"><semantics id="Thmtheorem3.p1.2.2.m2.1a"><mrow id="Thmtheorem3.p1.2.2.m2.1.2" xref="Thmtheorem3.p1.2.2.m2.1.2.cmml"><mi id="Thmtheorem3.p1.2.2.m2.1.2.2" xref="Thmtheorem3.p1.2.2.m2.1.2.2.cmml">O</mi><mo id="Thmtheorem3.p1.2.2.m2.1.2.1" xref="Thmtheorem3.p1.2.2.m2.1.2.1.cmml">⁢</mo><mrow id="Thmtheorem3.p1.2.2.m2.1.2.3.2" xref="Thmtheorem3.p1.2.2.m2.1.1.cmml"><mo id="Thmtheorem3.p1.2.2.m2.1.2.3.2.1" stretchy="false" xref="Thmtheorem3.p1.2.2.m2.1.1.cmml">(</mo><msqrt id="Thmtheorem3.p1.2.2.m2.1.1" xref="Thmtheorem3.p1.2.2.m2.1.1.cmml"><mrow id="Thmtheorem3.p1.2.2.m2.1.1.2" xref="Thmtheorem3.p1.2.2.m2.1.1.2.cmml"><mi id="Thmtheorem3.p1.2.2.m2.1.1.2.2" xref="Thmtheorem3.p1.2.2.m2.1.1.2.2.cmml">L</mi><mo id="Thmtheorem3.p1.2.2.m2.1.1.2.1" lspace="0.167em" xref="Thmtheorem3.p1.2.2.m2.1.1.2.1.cmml">⁢</mo><mrow id="Thmtheorem3.p1.2.2.m2.1.1.2.3" xref="Thmtheorem3.p1.2.2.m2.1.1.2.3.cmml"><mi id="Thmtheorem3.p1.2.2.m2.1.1.2.3.1" xref="Thmtheorem3.p1.2.2.m2.1.1.2.3.1.cmml">log</mi><mo id="Thmtheorem3.p1.2.2.m2.1.1.2.3a" lspace="0.167em" xref="Thmtheorem3.p1.2.2.m2.1.1.2.3.cmml">⁡</mo><mi id="Thmtheorem3.p1.2.2.m2.1.1.2.3.2" xref="Thmtheorem3.p1.2.2.m2.1.1.2.3.2.cmml">L</mi></mrow></mrow></msqrt><mo id="Thmtheorem3.p1.2.2.m2.1.2.3.2.2" stretchy="false" xref="Thmtheorem3.p1.2.2.m2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.2.2.m2.1b"><apply id="Thmtheorem3.p1.2.2.m2.1.2.cmml" xref="Thmtheorem3.p1.2.2.m2.1.2"><times id="Thmtheorem3.p1.2.2.m2.1.2.1.cmml" xref="Thmtheorem3.p1.2.2.m2.1.2.1"></times><ci id="Thmtheorem3.p1.2.2.m2.1.2.2.cmml" xref="Thmtheorem3.p1.2.2.m2.1.2.2">𝑂</ci><apply id="Thmtheorem3.p1.2.2.m2.1.1.cmml" xref="Thmtheorem3.p1.2.2.m2.1.2.3.2"><root id="Thmtheorem3.p1.2.2.m2.1.1a.cmml" xref="Thmtheorem3.p1.2.2.m2.1.2.3.2"></root><apply id="Thmtheorem3.p1.2.2.m2.1.1.2.cmml" xref="Thmtheorem3.p1.2.2.m2.1.1.2"><times id="Thmtheorem3.p1.2.2.m2.1.1.2.1.cmml" xref="Thmtheorem3.p1.2.2.m2.1.1.2.1"></times><ci id="Thmtheorem3.p1.2.2.m2.1.1.2.2.cmml" xref="Thmtheorem3.p1.2.2.m2.1.1.2.2">𝐿</ci><apply id="Thmtheorem3.p1.2.2.m2.1.1.2.3.cmml" xref="Thmtheorem3.p1.2.2.m2.1.1.2.3"><log id="Thmtheorem3.p1.2.2.m2.1.1.2.3.1.cmml" xref="Thmtheorem3.p1.2.2.m2.1.1.2.3.1"></log><ci id="Thmtheorem3.p1.2.2.m2.1.1.2.3.2.cmml" xref="Thmtheorem3.p1.2.2.m2.1.1.2.3.2">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.2.2.m2.1c">O({\sqrt{L\log L}})</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.2.2.m2.1d">italic_O ( square-root start_ARG italic_L roman_log italic_L end_ARG )</annotation></semantics></math> per iteration. In addition it guarantees the same regret bound vs. spectral filtering with context length <math alttext="L" class="ltx_Math" display="inline" id="Thmtheorem3.p1.3.3.m3.1"><semantics id="Thmtheorem3.p1.3.3.m3.1a"><mi id="Thmtheorem3.p1.3.3.m3.1.1" xref="Thmtheorem3.p1.3.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.3.3.m3.1b"><ci id="Thmtheorem3.p1.3.3.m3.1.1.cmml" xref="Thmtheorem3.p1.3.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.3.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.3.3.m3.1d">italic_L</annotation></semantics></math>.</span></p>
</div>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiments</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.3">A naive decoding method would explicitly compute Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S2.E2" title="Equation 2 ‣ 2.1 Abstracting Convolutional Sequence Prediction ‣ 2 Setting ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">2</span></a> for each token generated, resulting in <math alttext="O(T)" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.2.2" xref="S4.SS2.p1.1.m1.1.2.2.cmml">O</mi><mo id="S4.SS2.p1.1.m1.1.2.1" xref="S4.SS2.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p1.1.m1.1.2.3.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><mo id="S4.SS2.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS2.p1.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">T</mi><mo id="S4.SS2.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.2"><times id="S4.SS2.p1.1.m1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.2.1"></times><ci id="S4.SS2.p1.1.m1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.2.2">𝑂</ci><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">O(T)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_O ( italic_T )</annotation></semantics></math> time spent on each step on average when generating <math alttext="T" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_T</annotation></semantics></math> tokens.
By contrast, Lemma <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#Thmtheorem2" title="Lemma 2. ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">2</span></a> has shown that Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg2" title="Algorithm 2 ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">2</span></a> runs in a faster amortized <math alttext="O\left(\sqrt{T\log T}\right)" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.2" xref="S4.SS2.p1.3.m3.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.2.2" xref="S4.SS2.p1.3.m3.1.2.2.cmml">O</mi><mo id="S4.SS2.p1.3.m3.1.2.1" xref="S4.SS2.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p1.3.m3.1.2.3.2" xref="S4.SS2.p1.3.m3.1.1.cmml"><mo id="S4.SS2.p1.3.m3.1.2.3.2.1" xref="S4.SS2.p1.3.m3.1.1.cmml">(</mo><msqrt id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mrow id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2.2" xref="S4.SS2.p1.3.m3.1.1.2.2.cmml">T</mi><mo id="S4.SS2.p1.3.m3.1.1.2.1" lspace="0.167em" xref="S4.SS2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p1.3.m3.1.1.2.3" xref="S4.SS2.p1.3.m3.1.1.2.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2.3.1" xref="S4.SS2.p1.3.m3.1.1.2.3.1.cmml">log</mi><mo id="S4.SS2.p1.3.m3.1.1.2.3a" lspace="0.167em" xref="S4.SS2.p1.3.m3.1.1.2.3.cmml">⁡</mo><mi id="S4.SS2.p1.3.m3.1.1.2.3.2" xref="S4.SS2.p1.3.m3.1.1.2.3.2.cmml">T</mi></mrow></mrow></msqrt><mo id="S4.SS2.p1.3.m3.1.2.3.2.2" xref="S4.SS2.p1.3.m3.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.2.cmml" xref="S4.SS2.p1.3.m3.1.2"><times id="S4.SS2.p1.3.m3.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.2.1"></times><ci id="S4.SS2.p1.3.m3.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.2.2">𝑂</ci><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.2.3.2"><root id="S4.SS2.p1.3.m3.1.1a.cmml" xref="S4.SS2.p1.3.m3.1.2.3.2"></root><apply id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"><times id="S4.SS2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2.1"></times><ci id="S4.SS2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.2">𝑇</ci><apply id="S4.SS2.p1.3.m3.1.1.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3"><log id="S4.SS2.p1.3.m3.1.1.2.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3.1"></log><ci id="S4.SS2.p1.3.m3.1.1.2.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3.2">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">O\left(\sqrt{T\log T}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_O ( square-root start_ARG italic_T roman_log italic_T end_ARG )</annotation></semantics></math> per iteration. To experimentally verify this speedup, we use a convolutional model to generate tokens in an online fashion (i.e. with full context length at every step) and compare the naive decoding strategy to Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#alg2" title="Algorithm 2 ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.7">For increasing values of <math alttext="T" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_T</annotation></semantics></math>, we measure the time <math alttext="S(T)" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.2" xref="S4.SS2.p2.2.m2.1.2.cmml"><mi id="S4.SS2.p2.2.m2.1.2.2" xref="S4.SS2.p2.2.m2.1.2.2.cmml">S</mi><mo id="S4.SS2.p2.2.m2.1.2.1" xref="S4.SS2.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.2.m2.1.2.3.2" xref="S4.SS2.p2.2.m2.1.2.cmml"><mo id="S4.SS2.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.2.m2.1.2.cmml">(</mo><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">T</mi><mo id="S4.SS2.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.2.cmml" xref="S4.SS2.p2.2.m2.1.2"><times id="S4.SS2.p2.2.m2.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.2.1"></times><ci id="S4.SS2.p2.2.m2.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.2.2">𝑆</ci><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">S(T)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_S ( italic_T )</annotation></semantics></math> it takes for a single layer
to generate <math alttext="T" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_T</annotation></semantics></math> tokens. In Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S4.F4" title="Figure 4 ‣ 4.2 Experiments ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03766v1#S4.F4" title="Figure 4 ‣ 4.2 Experiments ‣ 4 Fast Online Convolutional Prediction ‣ FutureFill: Fast Generation from Convolutional Sequence Models"><span class="ltx_text ltx_ref_tag">4</span></a> we plot the amortized step time <math alttext="S(T)/T" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.2" xref="S4.SS2.p2.4.m4.1.2.cmml"><mrow id="S4.SS2.p2.4.m4.1.2.2" xref="S4.SS2.p2.4.m4.1.2.2.cmml"><mi id="S4.SS2.p2.4.m4.1.2.2.2" xref="S4.SS2.p2.4.m4.1.2.2.2.cmml">S</mi><mo id="S4.SS2.p2.4.m4.1.2.2.1" xref="S4.SS2.p2.4.m4.1.2.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.4.m4.1.2.2.3.2" xref="S4.SS2.p2.4.m4.1.2.2.cmml"><mo id="S4.SS2.p2.4.m4.1.2.2.3.2.1" stretchy="false" xref="S4.SS2.p2.4.m4.1.2.2.cmml">(</mo><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">T</mi><mo id="S4.SS2.p2.4.m4.1.2.2.3.2.2" stretchy="false" xref="S4.SS2.p2.4.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.4.m4.1.2.1" xref="S4.SS2.p2.4.m4.1.2.1.cmml">/</mo><mi id="S4.SS2.p2.4.m4.1.2.3" xref="S4.SS2.p2.4.m4.1.2.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.2.cmml" xref="S4.SS2.p2.4.m4.1.2"><divide id="S4.SS2.p2.4.m4.1.2.1.cmml" xref="S4.SS2.p2.4.m4.1.2.1"></divide><apply id="S4.SS2.p2.4.m4.1.2.2.cmml" xref="S4.SS2.p2.4.m4.1.2.2"><times id="S4.SS2.p2.4.m4.1.2.2.1.cmml" xref="S4.SS2.p2.4.m4.1.2.2.1"></times><ci id="S4.SS2.p2.4.m4.1.2.2.2.cmml" xref="S4.SS2.p2.4.m4.1.2.2.2">𝑆</ci><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝑇</ci></apply><ci id="S4.SS2.p2.4.m4.1.2.3.cmml" xref="S4.SS2.p2.4.m4.1.2.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">S(T)/T</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">italic_S ( italic_T ) / italic_T</annotation></semantics></math> and total generation time <math alttext="S(T)" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.1"><semantics id="S4.SS2.p2.5.m5.1a"><mrow id="S4.SS2.p2.5.m5.1.2" xref="S4.SS2.p2.5.m5.1.2.cmml"><mi id="S4.SS2.p2.5.m5.1.2.2" xref="S4.SS2.p2.5.m5.1.2.2.cmml">S</mi><mo id="S4.SS2.p2.5.m5.1.2.1" xref="S4.SS2.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.5.m5.1.2.3.2" xref="S4.SS2.p2.5.m5.1.2.cmml"><mo id="S4.SS2.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.5.m5.1.2.cmml">(</mo><mi id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">T</mi><mo id="S4.SS2.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.2.cmml" xref="S4.SS2.p2.5.m5.1.2"><times id="S4.SS2.p2.5.m5.1.2.1.cmml" xref="S4.SS2.p2.5.m5.1.2.1"></times><ci id="S4.SS2.p2.5.m5.1.2.2.cmml" xref="S4.SS2.p2.5.m5.1.2.2">𝑆</ci><ci id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">S(T)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.1d">italic_S ( italic_T )</annotation></semantics></math>, respectively, as functions of <math alttext="T" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><mi id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">italic_T</annotation></semantics></math>. We see the behavior that is expected: the naive decoder runs in amortized <math alttext="O(T)" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m7.1"><semantics id="S4.SS2.p2.7.m7.1a"><mrow id="S4.SS2.p2.7.m7.1.2" xref="S4.SS2.p2.7.m7.1.2.cmml"><mi id="S4.SS2.p2.7.m7.1.2.2" xref="S4.SS2.p2.7.m7.1.2.2.cmml">O</mi><mo id="S4.SS2.p2.7.m7.1.2.1" xref="S4.SS2.p2.7.m7.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.7.m7.1.2.3.2" xref="S4.SS2.p2.7.m7.1.2.cmml"><mo id="S4.SS2.p2.7.m7.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.7.m7.1.2.cmml">(</mo><mi id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">T</mi><mo id="S4.SS2.p2.7.m7.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.2.cmml" xref="S4.SS2.p2.7.m7.1.2"><times id="S4.SS2.p2.7.m7.1.2.1.cmml" xref="S4.SS2.p2.7.m7.1.2.1"></times><ci id="S4.SS2.p2.7.m7.1.2.2.cmml" xref="S4.SS2.p2.7.m7.1.2.2">𝑂</ci><ci id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">O(T)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m7.1d">italic_O ( italic_T )</annotation></semantics></math> per step, while our method achieves sublinear decoding complexity. Curves of best fit for the corresponding theoretical runtimes are overlaid for clarity.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.F4.5" style="width:195.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="397" id="S4.F4.1.g1" src="extracted/5896352/figures/amortized.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Average number of seconds per step when generating <math alttext="T" class="ltx_Math" display="inline" id="S4.F4.4.3.m1.1"><semantics id="S4.F4.4.3.m1.1b"><mi id="S4.F4.4.3.m1.1.1" xref="S4.F4.4.3.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.F4.4.3.m1.1c"><ci id="S4.F4.4.3.m1.1.1.cmml" xref="S4.F4.4.3.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.3.m1.1d">T</annotation><annotation encoding="application/x-llamapun" id="S4.F4.4.3.m1.1e">italic_T</annotation></semantics></math> tokens, as a function of <math alttext="T" class="ltx_Math" display="inline" id="S4.F4.5.4.m2.1"><semantics id="S4.F4.5.4.m2.1b"><mi id="S4.F4.5.4.m2.1.1" xref="S4.F4.5.4.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.F4.5.4.m2.1c"><ci id="S4.F4.5.4.m2.1.1.cmml" xref="S4.F4.5.4.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.5.4.m2.1d">T</annotation><annotation encoding="application/x-llamapun" id="S4.F4.5.4.m2.1e">italic_T</annotation></semantics></math>.
</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.F4.10" style="width:178.9pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="364" id="S4.F4.6.g1" src="extracted/5896352/figures/total.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Total number of seconds to generate <math alttext="T" class="ltx_Math" display="inline" id="S4.F4.9.3.m1.1"><semantics id="S4.F4.9.3.m1.1b"><mi id="S4.F4.9.3.m1.1.1" xref="S4.F4.9.3.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.F4.9.3.m1.1c"><ci id="S4.F4.9.3.m1.1.1.cmml" xref="S4.F4.9.3.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.9.3.m1.1d">T</annotation><annotation encoding="application/x-llamapun" id="S4.F4.9.3.m1.1e">italic_T</annotation></semantics></math> tokens, as a function of <math alttext="T" class="ltx_Math" display="inline" id="S4.F4.10.4.m2.1"><semantics id="S4.F4.10.4.m2.1b"><mi id="S4.F4.10.4.m2.1.1" xref="S4.F4.10.4.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.F4.10.4.m2.1c"><ci id="S4.F4.10.4.m2.1.1.cmml" xref="S4.F4.10.4.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.10.4.m2.1d">T</annotation><annotation encoding="application/x-llamapun" id="S4.F4.10.4.m2.1e">italic_T</annotation></semantics></math>. </figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">Due to differences in hardware acceleration, inference pipeline implementation, and other engineering details, it would be difficult to present timing results with a properly-optimized setup. On large decoding platforms involving prefill caching, these variations only become more complicated. We opted to time things for one layer on CPU in a simple online decoding loop with a large number of tokens to make the asymptotic gains clear. In practice, we have seen that inference gains do materialize for large models with standard inputs on accelerated hardware (with or without just-in-time compilation).</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agarwal et al. (2023)</span>
<span class="ltx_bibblock">
Naman Agarwal, Daniel Suo, Xinyi Chen, and Elad Hazan.

</span>
<span class="ltx_bibblock">Spectral state space models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2312.06837</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et al. (2022)</span>
<span class="ltx_bibblock">
Tri Dao, Daniel Y Fu, Khaled K Saab, Armin W Thomas, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Hungry hungry hippos: Towards language modeling with state space models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2212.14052</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. (2024)</span>
<span class="ltx_bibblock">
Dan Fu, Simran Arora, Jessica Grogan, Isys Johnson, Evan Sabri Eyuboglu, Armin Thomas, Benjamin Spector, Michael Poli, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Monarch mixer: A simple sub-quadratic gemm-based architecture.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. (2023)</span>
<span class="ltx_bibblock">
Daniel Y Fu, Elliot L Epstein, Eric Nguyen, Armin W Thomas, Michael Zhang, Tri Dao, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Simple hardware-efficient long convolutions for sequence modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2302.06646</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu &amp; Dao (2023)</span>
<span class="ltx_bibblock">
Albert Gu and Tri Dao.

</span>
<span class="ltx_bibblock">Mamba: Linear-time sequence modeling with selective state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2312.00752</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2020)</span>
<span class="ltx_bibblock">
Albert Gu, Tri Dao, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Hippo: Recurrent memory with optimal polynomial projections.

</span>
<span class="ltx_bibblock">In H. Larochelle, M. Ranzato, R. Hadsell, M.F. Balcan, and H. Lin (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems</em>, volume 33, pp.  1474–1487. Curran Associates, Inc., 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2021a)</span>
<span class="ltx_bibblock">
Albert Gu, Karan Goel, and Christopher Ré.

</span>
<span class="ltx_bibblock">Efficiently modeling long sequences with structured state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2111.00396</em>, 2021a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2021b)</span>
<span class="ltx_bibblock">
Albert Gu, Isys Johnson, Karan Goel, Khaled Saab, Tri Dao, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Combining recurrent, convolutional, and continuous-time models with linear state space layers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Advances in neural information processing systems</em>, 34:572–585, 2021b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al. (2022)</span>
<span class="ltx_bibblock">
Ankit Gupta, Albert Gu, and Jonathan Berant.

</span>
<span class="ltx_bibblock">Diagonal state spaces are as effective as structured state spaces.

</span>
<span class="ltx_bibblock">In Alice H. Oh, Alekh Agarwal, Danielle Belgrave, and Kyunghyun Cho (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Advances in Neural Information Processing Systems</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=RjS0j6tsSrf" title="">https://openreview.net/forum?id=RjS0j6tsSrf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hazan &amp; Singh (2022)</span>
<span class="ltx_bibblock">
Elad Hazan and Karan Singh.

</span>
<span class="ltx_bibblock">Introduction to online nonstochastic control.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2211.09619</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hazan et al. (2017)</span>
<span class="ltx_bibblock">
Elad Hazan, Karan Singh, and Cyril Zhang.

</span>
<span class="ltx_bibblock">Learning linear dynamical systems via spectral filtering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Advances in Neural Information Processing Systems</em>, pp.  6702–6712, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hazan et al. (2018)</span>
<span class="ltx_bibblock">
Elad Hazan, Holden Lee, Karan Singh, Cyril Zhang, and Yi Zhang.

</span>
<span class="ltx_bibblock">Spectral filtering for general linear dynamical systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Advances in Neural Information Processing Systems</em>, pp.  4634–4643, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hazan et al. (2016)</span>
<span class="ltx_bibblock">
Elad Hazan et al.

</span>
<span class="ltx_bibblock">Introduction to online convex optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Foundations and Trends® in Optimization</em>, 2(3-4):157–325, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Yuhong Li, Tianle Cai, Yi Zhang, Deming Chen, and Debadeepta Dey.

</span>
<span class="ltx_bibblock">What makes convolutional models great on long sequence modeling?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2210.09298</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Massaroli et al. (2024)</span>
<span class="ltx_bibblock">
Stefano Massaroli, Michael Poli, Dan Fu, Hermann Kumbong, Rom Parnichkun, David Romero, Aman Timalsina, Quinn McIntyre, Beidi Chen, Atri Rudra, et al.

</span>
<span class="ltx_bibblock">Laughing hyena distillery: Extracting compact recurrences from convolutions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mehta et al. (2023)</span>
<span class="ltx_bibblock">
Harsh Mehta, Ankit Gupta, Ashok Cutkosky, and Behnam Neyshabur.

</span>
<span class="ltx_bibblock">Long range language modeling via gated state spaces.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Orvieto et al. (2023)</span>
<span class="ltx_bibblock">
Antonio Orvieto, Samuel L Smith, Albert Gu, Anushan Fernando, Caglar Gulcehre, Razvan Pascanu, and Soham De.

</span>
<span class="ltx_bibblock">Resurrecting recurrent neural networks for long sequences.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2303.06349</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Poli et al. (2023)</span>
<span class="ltx_bibblock">
Michael Poli, Stefano Massaroli, Eric Nguyen, Daniel Y Fu, Tri Dao, Stephen Baccus, Yoshua Bengio, Stefano Ermon, and Christopher Ré.

</span>
<span class="ltx_bibblock">Hyena hierarchy: Towards larger convolutional language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">International Conference on Machine Learning</em>, pp.  28043–28078. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. (2023a)</span>
<span class="ltx_bibblock">
Jiaxin Shi, Ke Alexander Wang, and Emily Fox.

</span>
<span class="ltx_bibblock">Sequence modeling with multiresolution convolutional memory.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">International Conference on Machine Learning</em>, pp.  31312–31327. PMLR, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. (2023b)</span>
<span class="ltx_bibblock">
Jiaxin Shi, Ke Alexander Wang, and Emily B. Fox.

</span>
<span class="ltx_bibblock">Sequence modeling with multiresolution convolutional memory, 2023b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2305.01638" title="">https://arxiv.org/abs/2305.01638</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al. (2023)</span>
<span class="ltx_bibblock">
Jimmy T.H. Smith, Andrew Warrington, and Scott Linderman.

</span>
<span class="ltx_bibblock">Simplified state space layers for sequence modeling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  2 15:20:13 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
