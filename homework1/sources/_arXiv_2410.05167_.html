<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Presto! Distilling Steps and Layers for Accelerating Music Generation</title>
<!--Generated on Mon Oct  7 16:16:06 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.05167v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S1" title="In Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S2" title="In Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background &amp; Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S2.SS1" title="In 2 Background &amp; Related Work ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Music Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S2.SS2" title="In 2 Background &amp; Related Work ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Score-Based Diffusion Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S2.SS3" title="In 2 Background &amp; Related Work ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Diffusion Distillation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3" title="In Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span><span class="ltx_text ltx_font_bold ltx_font_italic">Presto!</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS1" title="In 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>EDM-Style Distribution Matching Distillation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS2" title="In 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Presto-S: Score-based Distribution Matching Distillation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS2.SSS1" title="In 3.2 Presto-S: Score-based Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Continuous-Time Generator Inputs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS2.SSS2" title="In 3.2 Presto-S: Score-based Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Perceptual Loss Weighting with Variable Noise Distributions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS2.SSS3" title="In 3.2 Presto-S: Score-based Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Audio-Aligned Discriminator Design</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS3" title="In 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Presto-L: Variance and Budget-Aware Layer Dropping</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS4" title="In 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Presto-LS: Layer-Step Distillation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4" title="In Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.SS1" title="In 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.SS2" title="In 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Exploring the Design Space of <span class="ltx_text ltx_font_bold">Presto-S</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.SS3" title="In 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span><span class="ltx_text ltx_font_bold">Presto-L</span> Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.SS4" title="In 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Full Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.SS5" title="In 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Listening Test</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.SS6" title="In 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Presto-LS Qualitative Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.SS7" title="In 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7 </span>Extensions</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S5" title="In Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1" title="In Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS1" title="In Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Model Design Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS2" title="In Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Baseline Description</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS3" title="In Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span><span class="ltx_text ltx_font_bold">Presto-S</span> Algorithm</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS4" title="In Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Analyzing Failure Modes of Combined Layer and Step Distillation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS5" title="In Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Inference-time noise schedule Sensitivity analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS6" title="In Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.6 </span>RTF Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS7" title="In Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.7 </span>Presto-L Design Ablation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS8" title="In Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.8 </span>Discrete-Time Failure Modes</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS9" title="In Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.9 </span>Listening Test Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS10" title="In Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.10 </span>Rejection Sampling Results</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_bold ltx_font_italic" id="id1.id1">Presto!</span> Distilling Steps and Layers 
<br class="ltx_break"/>for Accelerating Music Generation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zachary Novack 
<br class="ltx_break"/>UC – San Diego
<br class="ltx_break"/>&amp;Ge Zhu &amp; Jonah Casebeer
<br class="ltx_break"/>Adobe Research 
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id2.1.id1">\AND</span>Julian McAuley &amp; Taylor Berg-Kirkpatrick 
<br class="ltx_break"/>UC – San Diego
<br class="ltx_break"/>&amp;Nicholas J. Bryan 
<br class="ltx_break"/>Adobe Research 
<br class="ltx_break"/>
</span><span class="ltx_author_notes"> Work done while an intern at Adobe. Correspondnce to <span class="ltx_text ltx_font_typewriter" id="id3.2.id1">znovack@ucsd.edu</span> and <span class="ltx_text ltx_font_typewriter" id="id4.3.id2">njb@ieee.org</span>. </span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id5.id1">Despite advances in diffusion-based text-to-music (TTM) methods, efficient, high-quality generation remains a challenge.
We introduce <span class="ltx_text ltx_font_bold ltx_font_italic" id="id5.id1.1">Presto!</span>, an approach to inference acceleration for score-based diffusion transformers via reducing both sampling steps and cost per step.
To reduce steps, we develop a new score-based distribution matching distillation (DMD) method for the EDM-family of diffus ion models, the first GAN-based distillation method for TTM.
To reduce the cost per step, we develop a simple, but powerful improvement to a recent layer distillation method
that improves learning
via better preserving hidden state variance.
Finally, we combine our step and layer distillation methods together for a dual-faceted approach.
We evaluate our step and layer distillation methods independently and show each yield best-in-class performance.
Our combined distillation method can generate high-quality outputs with improved diversity, accelerating our base model by 10-18x (230/435ms latency for 32 second mono/stereo 44.1kHz, 15x faster than comparable SOTA)
— the fastest high-quality TTM to our knowledge.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">We have seen a renaissance of audio-domain generative media <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib5" title="">2024</a>; Agostinelli et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib1" title="">2023</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib32" title="">2023</a>; Copet et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib7" title="">2023</a>)</cite>, with increasing capabilities for both Text-to-Audio (TTA) and Text-to-Music (TTM) generation.
This work has been driven in-part by audio-domain <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">diffusion models</em> <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib55" title="">2020</a>; Ho et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib18" title="">2020</a>; Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib56" title="">2021</a>)</cite>, enabling considerably better audio modeling than generative adversarial network (GAN) or variational autoencoder (VAE) methods <cite class="ltx_cite ltx_citemacro_citep">(Dhariwal &amp; Nichol, <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib9" title="">2021</a>)</cite>.
Diffusion models, however, suffer from long inference times due to their iterative denoising process, requiring a substantial number of function evaluations (NFE)
during inference (i.e. sampling) and resulting in <math alttext="\approx" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><mo id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><approx id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">\approx</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">≈</annotation></semantics></math>5-20 seconds at best for non-batched latency.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Accelerating diffusion inference typically focuses on <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">step distillation</em>,
i.e. the process of reducing the <em class="ltx_emph ltx_font_italic" id="S1.p2.1.2">number</em> of sampling steps by distilling the diffusion model into a few-step generator. Methods include consistency-based  <cite class="ltx_cite ltx_citemacro_citep">(Salimans &amp; Ho, <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib48" title="">2022</a>; Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib57" title="">2023</a>; Kim et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib27" title="">2023</a>)</cite> and adversarial <cite class="ltx_cite ltx_citemacro_citep">(Sauer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib49" title="">2023</a>; Yin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib63" title="">2023</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib64" title="">2024</a>; Kang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib22" title="">2024</a>)</cite> approaches.
Others have also investigated <em class="ltx_emph ltx_font_italic" id="S1.p2.1.3">layer-distillation</em> <cite class="ltx_cite ltx_citemacro_citep">(Ma et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib35" title="">2024</a>; Wimbauer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib61" title="">2024</a>; Moon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib38" title="">2024</a>)</cite>, which draws from transformer early exiting <cite class="ltx_cite ltx_citemacro_citep">(Hou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib19" title="">2020</a>; Schuster et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib52" title="">2021</a>)</cite> by dropping interior layers to reduce the <em class="ltx_emph ltx_font_italic" id="S1.p2.1.4">cost</em> per sampling step for image generation.
For TTA/TTM models, however, distillation techniques have only been applied to shorter or lower-quality audio <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib3" title="">2024</a>; Novack et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib41" title="">2024a</a>)</cite>,
necessitate
<math alttext="\approx" class="ltx_Math" display="inline" id="S1.p2.1.m1.1"><semantics id="S1.p2.1.m1.1a"><mo id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><approx id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\approx</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.1d">≈</annotation></semantics></math>10 steps (vs. 1-4 step image methods)
to match base quality <cite class="ltx_cite ltx_citemacro_citep">(Saito et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib47" title="">2024</a>)</cite>, and have not successfully used layer or GAN-based distillation methods.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="310" id="S1.F1.g1" src="x1.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S1.F1.27.1">Presto-S</span>. Our goal is to distill the initial “real” score model (grey) <math alttext="\mu_{\bm{\theta}}" class="ltx_Math" display="inline" id="S1.F1.12.m1.1"><semantics id="S1.F1.12.m1.1b"><msub id="S1.F1.12.m1.1.1" xref="S1.F1.12.m1.1.1.cmml"><mi id="S1.F1.12.m1.1.1.2" xref="S1.F1.12.m1.1.1.2.cmml">μ</mi><mi id="S1.F1.12.m1.1.1.3" xref="S1.F1.12.m1.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.12.m1.1c"><apply id="S1.F1.12.m1.1.1.cmml" xref="S1.F1.12.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.12.m1.1.1.1.cmml" xref="S1.F1.12.m1.1.1">subscript</csymbol><ci id="S1.F1.12.m1.1.1.2.cmml" xref="S1.F1.12.m1.1.1.2">𝜇</ci><ci id="S1.F1.12.m1.1.1.3.cmml" xref="S1.F1.12.m1.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.12.m1.1d">\mu_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.12.m1.1e">italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> into a few-step generator (light blue) <math alttext="G_{\bm{\phi}}" class="ltx_Math" display="inline" id="S1.F1.13.m2.1"><semantics id="S1.F1.13.m2.1b"><msub id="S1.F1.13.m2.1.1" xref="S1.F1.13.m2.1.1.cmml"><mi id="S1.F1.13.m2.1.1.2" xref="S1.F1.13.m2.1.1.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="S1.F1.13.m2.1.1.3" mathvariant="bold-italic" xref="S1.F1.13.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.13.m2.1c"><apply id="S1.F1.13.m2.1.1.cmml" xref="S1.F1.13.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.13.m2.1.1.1.cmml" xref="S1.F1.13.m2.1.1">subscript</csymbol><ci id="S1.F1.13.m2.1.1.2.cmml" xref="S1.F1.13.m2.1.1.2">𝐺</ci><ci id="S1.F1.13.m2.1.1.3.cmml" xref="S1.F1.13.m2.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.13.m2.1d">G_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.13.m2.1e">italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> to minimize the KL divergence between the distribution of <math alttext="G_{\bm{\phi}}" class="ltx_Math" display="inline" id="S1.F1.14.m3.1"><semantics id="S1.F1.14.m3.1b"><msub id="S1.F1.14.m3.1.1" xref="S1.F1.14.m3.1.1.cmml"><mi id="S1.F1.14.m3.1.1.2" xref="S1.F1.14.m3.1.1.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="S1.F1.14.m3.1.1.3" mathvariant="bold-italic" xref="S1.F1.14.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.14.m3.1c"><apply id="S1.F1.14.m3.1.1.cmml" xref="S1.F1.14.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.14.m3.1.1.1.cmml" xref="S1.F1.14.m3.1.1">subscript</csymbol><ci id="S1.F1.14.m3.1.1.2.cmml" xref="S1.F1.14.m3.1.1.2">𝐺</ci><ci id="S1.F1.14.m3.1.1.3.cmml" xref="S1.F1.14.m3.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.14.m3.1d">G_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.14.m3.1e">italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>’s outputs and the real distribution. This requires that we train an auxillary “fake” score model <math alttext="\mu_{\bm{\psi}}" class="ltx_Math" display="inline" id="S1.F1.15.m4.1"><semantics id="S1.F1.15.m4.1b"><msub id="S1.F1.15.m4.1.1" xref="S1.F1.15.m4.1.1.cmml"><mi id="S1.F1.15.m4.1.1.2" xref="S1.F1.15.m4.1.1.2.cmml">μ</mi><mi id="S1.F1.15.m4.1.1.3" xref="S1.F1.15.m4.1.1.3.cmml">𝝍</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.15.m4.1c"><apply id="S1.F1.15.m4.1.1.cmml" xref="S1.F1.15.m4.1.1"><csymbol cd="ambiguous" id="S1.F1.15.m4.1.1.1.cmml" xref="S1.F1.15.m4.1.1">subscript</csymbol><ci id="S1.F1.15.m4.1.1.2.cmml" xref="S1.F1.15.m4.1.1.2">𝜇</ci><ci id="S1.F1.15.m4.1.1.3.cmml" xref="S1.F1.15.m4.1.1.3">𝝍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.15.m4.1d">\mu_{\bm{\psi}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.15.m4.1e">italic_μ start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> (dark blue) that estimates the score of the <em class="ltx_emph ltx_font_italic" id="S1.F1.28.2">generator’s</em> distribution at each gradient step. Formally: (1) real audio is corrupted with Gaussian noise sampled from the generator noise distribution <math alttext="p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}(\sigma^{\text{inf}})" class="ltx_Math" display="inline" id="S1.F1.16.m5.1"><semantics id="S1.F1.16.m5.1b"><mrow id="S1.F1.16.m5.1.1" xref="S1.F1.16.m5.1.1.cmml"><msub id="S1.F1.16.m5.1.1.3" xref="S1.F1.16.m5.1.1.3.cmml"><mi id="S1.F1.16.m5.1.1.3.2" xref="S1.F1.16.m5.1.1.3.2.cmml">p</mi><mtext id="S1.F1.16.m5.1.1.3.3" mathcolor="#C00000" xref="S1.F1.16.m5.1.1.3.3a.cmml">gen</mtext></msub><mo id="S1.F1.16.m5.1.1.2" xref="S1.F1.16.m5.1.1.2.cmml">⁢</mo><mrow id="S1.F1.16.m5.1.1.1.1" xref="S1.F1.16.m5.1.1.1.1.1.cmml"><mo id="S1.F1.16.m5.1.1.1.1.2" stretchy="false" xref="S1.F1.16.m5.1.1.1.1.1.cmml">(</mo><msup id="S1.F1.16.m5.1.1.1.1.1" xref="S1.F1.16.m5.1.1.1.1.1.cmml"><mi id="S1.F1.16.m5.1.1.1.1.1.2" xref="S1.F1.16.m5.1.1.1.1.1.2.cmml">σ</mi><mtext id="S1.F1.16.m5.1.1.1.1.1.3" xref="S1.F1.16.m5.1.1.1.1.1.3a.cmml">inf</mtext></msup><mo id="S1.F1.16.m5.1.1.1.1.3" stretchy="false" xref="S1.F1.16.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.16.m5.1c"><apply id="S1.F1.16.m5.1.1.cmml" xref="S1.F1.16.m5.1.1"><times id="S1.F1.16.m5.1.1.2.cmml" xref="S1.F1.16.m5.1.1.2"></times><apply id="S1.F1.16.m5.1.1.3.cmml" xref="S1.F1.16.m5.1.1.3"><csymbol cd="ambiguous" id="S1.F1.16.m5.1.1.3.1.cmml" xref="S1.F1.16.m5.1.1.3">subscript</csymbol><ci id="S1.F1.16.m5.1.1.3.2.cmml" xref="S1.F1.16.m5.1.1.3.2">𝑝</ci><ci id="S1.F1.16.m5.1.1.3.3a.cmml" xref="S1.F1.16.m5.1.1.3.3"><mtext id="S1.F1.16.m5.1.1.3.3.cmml" mathcolor="#C00000" mathsize="70%" xref="S1.F1.16.m5.1.1.3.3">gen</mtext></ci></apply><apply id="S1.F1.16.m5.1.1.1.1.1.cmml" xref="S1.F1.16.m5.1.1.1.1"><csymbol cd="ambiguous" id="S1.F1.16.m5.1.1.1.1.1.1.cmml" xref="S1.F1.16.m5.1.1.1.1">superscript</csymbol><ci id="S1.F1.16.m5.1.1.1.1.1.2.cmml" xref="S1.F1.16.m5.1.1.1.1.1.2">𝜎</ci><ci id="S1.F1.16.m5.1.1.1.1.1.3a.cmml" xref="S1.F1.16.m5.1.1.1.1.1.3"><mtext id="S1.F1.16.m5.1.1.1.1.1.3.cmml" mathsize="70%" xref="S1.F1.16.m5.1.1.1.1.1.3">inf</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.16.m5.1d">p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}(\sigma^{\text{inf}})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.16.m5.1e">italic_p start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT )</annotation></semantics></math> which is then (2) passed into the generator to get its output. Noise is then added to this generation according to three <em class="ltx_emph ltx_font_italic" id="S1.F1.29.3">different</em> noise distributions: (3) <math alttext="p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="S1.F1.17.m6.1"><semantics id="S1.F1.17.m6.1b"><mrow id="S1.F1.17.m6.1.1" xref="S1.F1.17.m6.1.1.cmml"><msub id="S1.F1.17.m6.1.1.3" xref="S1.F1.17.m6.1.1.3.cmml"><mi id="S1.F1.17.m6.1.1.3.2" xref="S1.F1.17.m6.1.1.3.2.cmml">p</mi><mtext id="S1.F1.17.m6.1.1.3.3" mathcolor="#FBBD00" xref="S1.F1.17.m6.1.1.3.3a.cmml">DMD</mtext></msub><mo id="S1.F1.17.m6.1.1.2" xref="S1.F1.17.m6.1.1.2.cmml">⁢</mo><mrow id="S1.F1.17.m6.1.1.1.1" xref="S1.F1.17.m6.1.1.1.1.1.cmml"><mo id="S1.F1.17.m6.1.1.1.1.2" stretchy="false" xref="S1.F1.17.m6.1.1.1.1.1.cmml">(</mo><msup id="S1.F1.17.m6.1.1.1.1.1" xref="S1.F1.17.m6.1.1.1.1.1.cmml"><mi id="S1.F1.17.m6.1.1.1.1.1.2" xref="S1.F1.17.m6.1.1.1.1.1.2.cmml">σ</mi><mtext id="S1.F1.17.m6.1.1.1.1.1.3" xref="S1.F1.17.m6.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S1.F1.17.m6.1.1.1.1.3" stretchy="false" xref="S1.F1.17.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.17.m6.1c"><apply id="S1.F1.17.m6.1.1.cmml" xref="S1.F1.17.m6.1.1"><times id="S1.F1.17.m6.1.1.2.cmml" xref="S1.F1.17.m6.1.1.2"></times><apply id="S1.F1.17.m6.1.1.3.cmml" xref="S1.F1.17.m6.1.1.3"><csymbol cd="ambiguous" id="S1.F1.17.m6.1.1.3.1.cmml" xref="S1.F1.17.m6.1.1.3">subscript</csymbol><ci id="S1.F1.17.m6.1.1.3.2.cmml" xref="S1.F1.17.m6.1.1.3.2">𝑝</ci><ci id="S1.F1.17.m6.1.1.3.3a.cmml" xref="S1.F1.17.m6.1.1.3.3"><mtext id="S1.F1.17.m6.1.1.3.3.cmml" mathcolor="#FBBD00" mathsize="70%" xref="S1.F1.17.m6.1.1.3.3">DMD</mtext></ci></apply><apply id="S1.F1.17.m6.1.1.1.1.1.cmml" xref="S1.F1.17.m6.1.1.1.1"><csymbol cd="ambiguous" id="S1.F1.17.m6.1.1.1.1.1.1.cmml" xref="S1.F1.17.m6.1.1.1.1">superscript</csymbol><ci id="S1.F1.17.m6.1.1.1.1.1.2.cmml" xref="S1.F1.17.m6.1.1.1.1.1.2">𝜎</ci><ci id="S1.F1.17.m6.1.1.1.1.1.3a.cmml" xref="S1.F1.17.m6.1.1.1.1.1.3"><mtext id="S1.F1.17.m6.1.1.1.1.1.3.cmml" mathsize="70%" xref="S1.F1.17.m6.1.1.1.1.1.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.17.m6.1d">p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.17.m6.1e">italic_p start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>, which is (4) passed into both the real and fake score models to calculate the distribution matching gradient <math alttext="\nabla_{\phi}\mathcal{L}_{\text{DMD}}" class="ltx_Math" display="inline" id="S1.F1.18.m7.1"><semantics id="S1.F1.18.m7.1b"><mrow id="S1.F1.18.m7.1.1" xref="S1.F1.18.m7.1.1.cmml"><msub id="S1.F1.18.m7.1.1.1" xref="S1.F1.18.m7.1.1.1.cmml"><mo id="S1.F1.18.m7.1.1.1.2" xref="S1.F1.18.m7.1.1.1.2.cmml">∇</mo><mi id="S1.F1.18.m7.1.1.1.3" xref="S1.F1.18.m7.1.1.1.3.cmml">ϕ</mi></msub><msub id="S1.F1.18.m7.1.1.2" xref="S1.F1.18.m7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.18.m7.1.1.2.2" xref="S1.F1.18.m7.1.1.2.2.cmml">ℒ</mi><mtext id="S1.F1.18.m7.1.1.2.3" xref="S1.F1.18.m7.1.1.2.3a.cmml">DMD</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.18.m7.1c"><apply id="S1.F1.18.m7.1.1.cmml" xref="S1.F1.18.m7.1.1"><apply id="S1.F1.18.m7.1.1.1.cmml" xref="S1.F1.18.m7.1.1.1"><csymbol cd="ambiguous" id="S1.F1.18.m7.1.1.1.1.cmml" xref="S1.F1.18.m7.1.1.1">subscript</csymbol><ci id="S1.F1.18.m7.1.1.1.2.cmml" xref="S1.F1.18.m7.1.1.1.2">∇</ci><ci id="S1.F1.18.m7.1.1.1.3.cmml" xref="S1.F1.18.m7.1.1.1.3">italic-ϕ</ci></apply><apply id="S1.F1.18.m7.1.1.2.cmml" xref="S1.F1.18.m7.1.1.2"><csymbol cd="ambiguous" id="S1.F1.18.m7.1.1.2.1.cmml" xref="S1.F1.18.m7.1.1.2">subscript</csymbol><ci id="S1.F1.18.m7.1.1.2.2.cmml" xref="S1.F1.18.m7.1.1.2.2">ℒ</ci><ci id="S1.F1.18.m7.1.1.2.3a.cmml" xref="S1.F1.18.m7.1.1.2.3"><mtext id="S1.F1.18.m7.1.1.2.3.cmml" mathsize="70%" xref="S1.F1.18.m7.1.1.2.3">DMD</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.18.m7.1d">\nabla_{\phi}\mathcal{L}_{\text{DMD}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.18.m7.1e">∇ start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT</annotation></semantics></math>; (5) <math alttext="p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{%
train/inf}})" class="ltx_Math" display="inline" id="S1.F1.19.m8.1"><semantics id="S1.F1.19.m8.1b"><mrow id="S1.F1.19.m8.1.1" xref="S1.F1.19.m8.1.1.cmml"><msub id="S1.F1.19.m8.1.1.3" xref="S1.F1.19.m8.1.1.3.cmml"><mi id="S1.F1.19.m8.1.1.3.2" xref="S1.F1.19.m8.1.1.3.2.cmml">p</mi><mtext id="S1.F1.19.m8.1.1.3.3" mathcolor="#2E5F7F" xref="S1.F1.19.m8.1.1.3.3a.cmml">DSM</mtext></msub><mo id="S1.F1.19.m8.1.1.2" xref="S1.F1.19.m8.1.1.2.cmml">⁢</mo><mrow id="S1.F1.19.m8.1.1.1.1" xref="S1.F1.19.m8.1.1.1.1.1.cmml"><mo id="S1.F1.19.m8.1.1.1.1.2" stretchy="false" xref="S1.F1.19.m8.1.1.1.1.1.cmml">(</mo><msup id="S1.F1.19.m8.1.1.1.1.1" xref="S1.F1.19.m8.1.1.1.1.1.cmml"><mi id="S1.F1.19.m8.1.1.1.1.1.2" xref="S1.F1.19.m8.1.1.1.1.1.2.cmml">σ</mi><mtext id="S1.F1.19.m8.1.1.1.1.1.3" xref="S1.F1.19.m8.1.1.1.1.1.3a.cmml">train/inf</mtext></msup><mo id="S1.F1.19.m8.1.1.1.1.3" stretchy="false" xref="S1.F1.19.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.19.m8.1c"><apply id="S1.F1.19.m8.1.1.cmml" xref="S1.F1.19.m8.1.1"><times id="S1.F1.19.m8.1.1.2.cmml" xref="S1.F1.19.m8.1.1.2"></times><apply id="S1.F1.19.m8.1.1.3.cmml" xref="S1.F1.19.m8.1.1.3"><csymbol cd="ambiguous" id="S1.F1.19.m8.1.1.3.1.cmml" xref="S1.F1.19.m8.1.1.3">subscript</csymbol><ci id="S1.F1.19.m8.1.1.3.2.cmml" xref="S1.F1.19.m8.1.1.3.2">𝑝</ci><ci id="S1.F1.19.m8.1.1.3.3a.cmml" xref="S1.F1.19.m8.1.1.3.3"><mtext id="S1.F1.19.m8.1.1.3.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="S1.F1.19.m8.1.1.3.3">DSM</mtext></ci></apply><apply id="S1.F1.19.m8.1.1.1.1.1.cmml" xref="S1.F1.19.m8.1.1.1.1"><csymbol cd="ambiguous" id="S1.F1.19.m8.1.1.1.1.1.1.cmml" xref="S1.F1.19.m8.1.1.1.1">superscript</csymbol><ci id="S1.F1.19.m8.1.1.1.1.1.2.cmml" xref="S1.F1.19.m8.1.1.1.1.1.2">𝜎</ci><ci id="S1.F1.19.m8.1.1.1.1.1.3a.cmml" xref="S1.F1.19.m8.1.1.1.1.1.3"><mtext id="S1.F1.19.m8.1.1.1.1.1.3.cmml" mathsize="70%" xref="S1.F1.19.m8.1.1.1.1.1.3">train/inf</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.19.m8.1d">p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{%
train/inf}})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.19.m8.1e">italic_p start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train/inf end_POSTSUPERSCRIPT )</annotation></semantics></math>, which is used to (6) train the fake score model on the <em class="ltx_emph ltx_font_italic" id="S1.F1.30.4">generator’s</em> distribution with <math alttext="\mathcal{L}_{\text{fake-DSM}}" class="ltx_Math" display="inline" id="S1.F1.20.m9.1"><semantics id="S1.F1.20.m9.1b"><msub id="S1.F1.20.m9.1.1" xref="S1.F1.20.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.20.m9.1.1.2" xref="S1.F1.20.m9.1.1.2.cmml">ℒ</mi><mtext id="S1.F1.20.m9.1.1.3" xref="S1.F1.20.m9.1.1.3a.cmml">fake-DSM</mtext></msub><annotation-xml encoding="MathML-Content" id="S1.F1.20.m9.1c"><apply id="S1.F1.20.m9.1.1.cmml" xref="S1.F1.20.m9.1.1"><csymbol cd="ambiguous" id="S1.F1.20.m9.1.1.1.cmml" xref="S1.F1.20.m9.1.1">subscript</csymbol><ci id="S1.F1.20.m9.1.1.2.cmml" xref="S1.F1.20.m9.1.1.2">ℒ</ci><ci id="S1.F1.20.m9.1.1.3a.cmml" xref="S1.F1.20.m9.1.1.3"><mtext id="S1.F1.20.m9.1.1.3.cmml" mathsize="70%" xref="S1.F1.20.m9.1.1.3">fake-DSM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.20.m9.1d">\mathcal{L}_{\text{fake-DSM}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.20.m9.1e">caligraphic_L start_POSTSUBSCRIPT fake-DSM end_POSTSUBSCRIPT</annotation></semantics></math>; and (7) an adversarial distribution <math alttext="p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="S1.F1.21.m10.1"><semantics id="S1.F1.21.m10.1b"><mrow id="S1.F1.21.m10.1.1" xref="S1.F1.21.m10.1.1.cmml"><msub id="S1.F1.21.m10.1.1.3" xref="S1.F1.21.m10.1.1.3.cmml"><mi id="S1.F1.21.m10.1.1.3.2" xref="S1.F1.21.m10.1.1.3.2.cmml">p</mi><mtext id="S1.F1.21.m10.1.1.3.3" mathcolor="#92D050" xref="S1.F1.21.m10.1.1.3.3a.cmml">GAN</mtext></msub><mo id="S1.F1.21.m10.1.1.2" xref="S1.F1.21.m10.1.1.2.cmml">⁢</mo><mrow id="S1.F1.21.m10.1.1.1.1" xref="S1.F1.21.m10.1.1.1.1.1.cmml"><mo id="S1.F1.21.m10.1.1.1.1.2" stretchy="false" xref="S1.F1.21.m10.1.1.1.1.1.cmml">(</mo><msup id="S1.F1.21.m10.1.1.1.1.1" xref="S1.F1.21.m10.1.1.1.1.1.cmml"><mi id="S1.F1.21.m10.1.1.1.1.1.2" xref="S1.F1.21.m10.1.1.1.1.1.2.cmml">σ</mi><mtext id="S1.F1.21.m10.1.1.1.1.1.3" xref="S1.F1.21.m10.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S1.F1.21.m10.1.1.1.1.3" stretchy="false" xref="S1.F1.21.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.21.m10.1c"><apply id="S1.F1.21.m10.1.1.cmml" xref="S1.F1.21.m10.1.1"><times id="S1.F1.21.m10.1.1.2.cmml" xref="S1.F1.21.m10.1.1.2"></times><apply id="S1.F1.21.m10.1.1.3.cmml" xref="S1.F1.21.m10.1.1.3"><csymbol cd="ambiguous" id="S1.F1.21.m10.1.1.3.1.cmml" xref="S1.F1.21.m10.1.1.3">subscript</csymbol><ci id="S1.F1.21.m10.1.1.3.2.cmml" xref="S1.F1.21.m10.1.1.3.2">𝑝</ci><ci id="S1.F1.21.m10.1.1.3.3a.cmml" xref="S1.F1.21.m10.1.1.3.3"><mtext id="S1.F1.21.m10.1.1.3.3.cmml" mathcolor="#92D050" mathsize="70%" xref="S1.F1.21.m10.1.1.3.3">GAN</mtext></ci></apply><apply id="S1.F1.21.m10.1.1.1.1.1.cmml" xref="S1.F1.21.m10.1.1.1.1"><csymbol cd="ambiguous" id="S1.F1.21.m10.1.1.1.1.1.1.cmml" xref="S1.F1.21.m10.1.1.1.1">superscript</csymbol><ci id="S1.F1.21.m10.1.1.1.1.1.2.cmml" xref="S1.F1.21.m10.1.1.1.1.1.2">𝜎</ci><ci id="S1.F1.21.m10.1.1.1.1.1.3a.cmml" xref="S1.F1.21.m10.1.1.1.1.1.3"><mtext id="S1.F1.21.m10.1.1.1.1.1.3.cmml" mathsize="70%" xref="S1.F1.21.m10.1.1.1.1.1.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.21.m10.1d">p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="S1.F1.21.m10.1e">italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>, which along with the real audio is (8) passed into a least-squares discriminator built on the fake score model’s intermediate activations to calculate <math alttext="\mathcal{L}_{\text{GAN}}" class="ltx_Math" display="inline" id="S1.F1.22.m11.1"><semantics id="S1.F1.22.m11.1b"><msub id="S1.F1.22.m11.1.1" xref="S1.F1.22.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.22.m11.1.1.2" xref="S1.F1.22.m11.1.1.2.cmml">ℒ</mi><mtext id="S1.F1.22.m11.1.1.3" xref="S1.F1.22.m11.1.1.3a.cmml">GAN</mtext></msub><annotation-xml encoding="MathML-Content" id="S1.F1.22.m11.1c"><apply id="S1.F1.22.m11.1.1.cmml" xref="S1.F1.22.m11.1.1"><csymbol cd="ambiguous" id="S1.F1.22.m11.1.1.1.cmml" xref="S1.F1.22.m11.1.1">subscript</csymbol><ci id="S1.F1.22.m11.1.1.2.cmml" xref="S1.F1.22.m11.1.1.2">ℒ</ci><ci id="S1.F1.22.m11.1.1.3a.cmml" xref="S1.F1.22.m11.1.1.3"><mtext id="S1.F1.22.m11.1.1.3.cmml" mathsize="70%" xref="S1.F1.22.m11.1.1.3">GAN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.22.m11.1d">\mathcal{L}_{\text{GAN}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.22.m11.1e">caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math>.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">We present <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">Presto<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote1.1.1.1">1</span></span><em class="ltx_emph ltx_font_medium ltx_font_italic" id="footnote1.5">Presto</em><span class="ltx_text ltx_font_medium" id="footnote1.6"> is the common musical term denoting fast music from 168-200 beats per minute.</span></span></span></span></span>, a dual-faceted distillation approach to inference acceleration for score-based diffusion transformers via reducing the number of sampling steps and the cost per step.
<span class="ltx_text ltx_font_bold" id="S1.p3.1.2">Presto</span> includes three distillation methods:
(1) <span class="ltx_text ltx_font_bold" id="S1.p3.1.3">Presto-S</span>, a new distribution matching distillation algorithm for <em class="ltx_emph ltx_font_italic" id="S1.p3.1.4">score-based</em>, EDM-style diffusion models
(see  Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">1</span></a>) leveraging GAN-based step distillation with the flexibility of <em class="ltx_emph ltx_font_italic" id="S1.p3.1.5">continuous-time</em> models,
(2) <span class="ltx_text ltx_font_bold" id="S1.p3.1.6">Presto-L</span>, a conditional layer distillation method designed to better preserve hidden state variance during distillation, and
(3) <span class="ltx_text ltx_font_bold" id="S1.p3.1.7">Presto-LS</span>, a combined layer-step distillation method that critically uses layer distillation and <em class="ltx_emph ltx_font_italic" id="S1.p3.1.8">then</em> step distillation while disentangling layer distillation from real and fake score-based gradient estimation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To evaluate our approach, we ablate the design space for both distillation processes. First, we show our step distillation method achieves best-in-class acceleration and quality via careful choice of loss noise distributions, GAN design, and continuous-valued inputs, the first such method to match base TTM diffusion sampling quality with 4-step inference.
Second, we show our layer distillation method offers a consistent improvement in both speed <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">and</em> performance over SOTA layer dropping methods and base diffusion sampling.
Finally, we show that layer-step distillation accelerates our base model by 10-18x (230/435ms latency for 32 second mono/stereo 44.1kHz, 15x faster than the comparable SOTA model) while notably improving diversity over step-only distillation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Overall, our core contributions include the development of a holistic approach to accelerating score-based diffusion transformers including:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">The development of distribution matching distillation for continuous-time score-based diffusion (i.e. EDM), the first GAN-based distillation method for TTA/TTM.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">The development of an improved layer distillation method that consistently improves upon both past layer distillation method and our base diffusion model.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">The development of the first combined layer and step distillation method.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">Evaluation showing our step, layer, and layer-step distillation methods are all best-in-class and, when combined, can accelerate our base model by 10-18x (230/435ms latency for 32 second mono/stereo 44.1kHz, 15x faster than Stable Audio Open <cite class="ltx_cite ltx_citemacro_citep">(Evans et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib14" title="">2024c</a>)</cite>), the fastest TTM model to our knowledge. For sound examples, see <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://presto-music.github.io/web/" title="">https://presto-music.github.io/web/</a>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background &amp; Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Music Generation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Audio-domain music generation methods commonly use autoregressive (AR) techniques <cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib65" title="">2021</a>; Agostinelli et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib1" title="">2023</a>; Copet et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib7" title="">2023</a>)</cite> or diffusion <cite class="ltx_cite ltx_citemacro_citep">(Forsgren &amp; Martiros, <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib15" title="">2022</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib32" title="">2023</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib33" title="">2024b</a>; Schneider et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib51" title="">2023</a>)</cite>. Diffusion-based TTA/TTM <cite class="ltx_cite ltx_citemacro_citep">(Forsgren &amp; Martiros, <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib15" title="">2022</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib32" title="">2023</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib33" title="">2024b</a>; Schneider et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib51" title="">2023</a>; Evans et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib12" title="">2024a</a>)</cite> has shown the promise of full-text control <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib20" title="">2023</a>)</cite>, precise musical attribute control <cite class="ltx_cite ltx_citemacro_citep">(Novack et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib42" title="">2024b</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib41" title="">a</a>; Tal et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib58" title="">2024</a>)</cite>, structured long-form generation <cite class="ltx_cite ltx_citemacro_citep">(Evans et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib13" title="">2024b</a>)</cite>, and higher overall quality over AR methods <cite class="ltx_cite ltx_citemacro_citep">(Evans et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib12" title="">2024a</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib13" title="">b</a>; Novack et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib42" title="">2024b</a>; Evans et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib14" title="">2024c</a>)</cite>. The main downside of diffusion, however, is that it is slow and thus not amenable to interactive-rate control.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Score-Based Diffusion Models</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Continuous-time diffusion models have shown great promise over discrete-time models both for their improved performance on images <cite class="ltx_cite ltx_citemacro_citep">(Balaji et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib4" title="">2022</a>; Karras et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib24" title="">2023</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib31" title="">2024a</a>)</cite> <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.1.1">and</em> audio <cite class="ltx_cite ltx_citemacro_citep">(Nistal et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib40" title="">2024</a>; Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib67" title="">2023</a>; Saito et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib47" title="">2024</a>)</cite>, as well as their relationship to the general class of flow-based models <cite class="ltx_cite ltx_citemacro_citep">(Sauer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib50" title="">2024</a>; Tal et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib58" title="">2024</a>)</cite>.
Such models involve a forward noising process that gradually adds Gaussian noise to real audio signals <math alttext="\bm{x}_{\text{real}}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">𝒙</mi><mtext id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3a.cmml">real</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝒙</ci><ci id="S2.SS2.p1.1.m1.1.1.3a.cmml" xref="S2.SS2.p1.1.m1.1.1.3"><mtext id="S2.SS2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS2.p1.1.m1.1.1.3">real</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\bm{x}_{\text{real}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT</annotation></semantics></math> and
a reverse process that transforms pure Gaussian noise back into data <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib56" title="">2021</a>; Sohl-Dickstein et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib54" title="">2015</a>)</cite>. The reverse process is defined by a stochastic differential equation (SDE) with an equivalent ordinary differential equation (ODE) form called the <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.1.2">probability flow</em> (PF) ODE <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib56" title="">2021</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{d}\bm{x}=-\sigma\nabla_{\bm{x}}\log p(\bm{x}\mid\sigma)\mathrm{d}\sigma," class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2" mathvariant="normal" xref="S2.E1.m1.1.1.1.1.3.2.cmml">d</mi><mo id="S2.E1.m1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.3.3.cmml">𝒙</mi></mrow><mo id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1a" xref="S2.E1.m1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S2.E1.m1.1.1.1.1.1.1.2" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.4" xref="S2.E1.m1.1.1.1.1.1.1.4.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.4.1" xref="S2.E1.m1.1.1.1.1.1.1.4.1.cmml"><msub id="S2.E1.m1.1.1.1.1.1.1.4.1.1" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2" rspace="0.167em" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.cmml">∇</mo><mi id="S2.E1.m1.1.1.1.1.1.1.4.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.cmml">𝒙</mi></msub><mi id="S2.E1.m1.1.1.1.1.1.1.4.1.2" xref="S2.E1.m1.1.1.1.1.1.1.4.1.2.cmml">log</mi></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.4a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.1.1.4.cmml">⁡</mo><mi id="S2.E1.m1.1.1.1.1.1.1.4.2" xref="S2.E1.m1.1.1.1.1.1.1.4.2.cmml">p</mi></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.2a" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">σ</mi></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.2b" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.1.1.5" mathvariant="normal" xref="S2.E1.m1.1.1.1.1.1.1.5.cmml">d</mi><mo id="S2.E1.m1.1.1.1.1.1.1.2c" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.1.1.6" xref="S2.E1.m1.1.1.1.1.1.1.6.cmml">σ</mi></mrow></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"></eq><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><times id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.1"></times><ci id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2">d</ci><ci id="S2.E1.m1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.3">𝒙</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><minus id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1"></minus><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2"></times><ci id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3">𝜎</ci><apply id="S2.E1.m1.1.1.1.1.1.1.4.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4"><apply id="S2.E1.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1"><apply id="S2.E1.m1.1.1.1.1.1.1.4.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.4.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2">∇</ci><ci id="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.3">𝒙</ci></apply><log id="S2.E1.m1.1.1.1.1.1.1.4.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.2"></log></apply><ci id="S2.E1.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.2">𝑝</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3">𝜎</ci></apply><ci id="S2.E1.m1.1.1.1.1.1.1.5.cmml" xref="S2.E1.m1.1.1.1.1.1.1.5">d</ci><ci id="S2.E1.m1.1.1.1.1.1.1.6.cmml" xref="S2.E1.m1.1.1.1.1.1.1.6">𝜎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\mathrm{d}\bm{x}=-\sigma\nabla_{\bm{x}}\log p(\bm{x}\mid\sigma)\mathrm{d}\sigma,</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">roman_d bold_italic_x = - italic_σ ∇ start_POSTSUBSCRIPT bold_italic_x end_POSTSUBSCRIPT roman_log italic_p ( bold_italic_x ∣ italic_σ ) roman_d italic_σ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.6">where <math alttext="\nabla_{\bm{x}}\log p(\bm{x}\mid\sigma)" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m1.1"><semantics id="S2.SS2.p1.2.m1.1a"><mrow id="S2.SS2.p1.2.m1.1.1" xref="S2.SS2.p1.2.m1.1.1.cmml"><mrow id="S2.SS2.p1.2.m1.1.1.3" xref="S2.SS2.p1.2.m1.1.1.3.cmml"><mrow id="S2.SS2.p1.2.m1.1.1.3.1" xref="S2.SS2.p1.2.m1.1.1.3.1.cmml"><msub id="S2.SS2.p1.2.m1.1.1.3.1.1" xref="S2.SS2.p1.2.m1.1.1.3.1.1.cmml"><mo id="S2.SS2.p1.2.m1.1.1.3.1.1.2" xref="S2.SS2.p1.2.m1.1.1.3.1.1.2.cmml">∇</mo><mi id="S2.SS2.p1.2.m1.1.1.3.1.1.3" xref="S2.SS2.p1.2.m1.1.1.3.1.1.3.cmml">𝒙</mi></msub><mi id="S2.SS2.p1.2.m1.1.1.3.1.2" xref="S2.SS2.p1.2.m1.1.1.3.1.2.cmml">log</mi></mrow><mo id="S2.SS2.p1.2.m1.1.1.3a" lspace="0.167em" xref="S2.SS2.p1.2.m1.1.1.3.cmml">⁡</mo><mi id="S2.SS2.p1.2.m1.1.1.3.2" xref="S2.SS2.p1.2.m1.1.1.3.2.cmml">p</mi></mrow><mo id="S2.SS2.p1.2.m1.1.1.2" xref="S2.SS2.p1.2.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.2.m1.1.1.1.1" xref="S2.SS2.p1.2.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.2.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.2.m1.1.1.1.1.1" xref="S2.SS2.p1.2.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.2.m1.1.1.1.1.1.2" xref="S2.SS2.p1.2.m1.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S2.SS2.p1.2.m1.1.1.1.1.1.1" xref="S2.SS2.p1.2.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.SS2.p1.2.m1.1.1.1.1.1.3" xref="S2.SS2.p1.2.m1.1.1.1.1.1.3.cmml">σ</mi></mrow><mo id="S2.SS2.p1.2.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m1.1b"><apply id="S2.SS2.p1.2.m1.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1"><times id="S2.SS2.p1.2.m1.1.1.2.cmml" xref="S2.SS2.p1.2.m1.1.1.2"></times><apply id="S2.SS2.p1.2.m1.1.1.3.cmml" xref="S2.SS2.p1.2.m1.1.1.3"><apply id="S2.SS2.p1.2.m1.1.1.3.1.cmml" xref="S2.SS2.p1.2.m1.1.1.3.1"><apply id="S2.SS2.p1.2.m1.1.1.3.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m1.1.1.3.1.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1.3.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m1.1.1.3.1.1.2.cmml" xref="S2.SS2.p1.2.m1.1.1.3.1.1.2">∇</ci><ci id="S2.SS2.p1.2.m1.1.1.3.1.1.3.cmml" xref="S2.SS2.p1.2.m1.1.1.3.1.1.3">𝒙</ci></apply><log id="S2.SS2.p1.2.m1.1.1.3.1.2.cmml" xref="S2.SS2.p1.2.m1.1.1.3.1.2"></log></apply><ci id="S2.SS2.p1.2.m1.1.1.3.2.cmml" xref="S2.SS2.p1.2.m1.1.1.3.2">𝑝</ci></apply><apply id="S2.SS2.p1.2.m1.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.2.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p1.2.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.2.m1.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS2.p1.2.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.2.m1.1.1.1.1.1.3">𝜎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m1.1c">\nabla_{\bm{x}}\log p(\bm{x}\mid\sigma)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m1.1d">∇ start_POSTSUBSCRIPT bold_italic_x end_POSTSUBSCRIPT roman_log italic_p ( bold_italic_x ∣ italic_σ )</annotation></semantics></math> is the score function of the marginal density of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m2.1"><semantics id="S2.SS2.p1.3.m2.1a"><mi id="S2.SS2.p1.3.m2.1.1" xref="S2.SS2.p1.3.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m2.1b"><ci id="S2.SS2.p1.3.m2.1.1.cmml" xref="S2.SS2.p1.3.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m2.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m2.1d">bold_italic_x</annotation></semantics></math> (i.e. the noisy data) at noise level <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m3.1"><semantics id="S2.SS2.p1.4.m3.1a"><mi id="S2.SS2.p1.4.m3.1.1" xref="S2.SS2.p1.4.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m3.1b"><ci id="S2.SS2.p1.4.m3.1.1.cmml" xref="S2.SS2.p1.4.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m3.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m3.1d">italic_σ</annotation></semantics></math> according to the forward diffusion process.
Thus, the goal of score-based diffusion models is to learn a <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.6.1">denoiser</em> network <math alttext="\mu_{\bm{\theta}}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m4.1"><semantics id="S2.SS2.p1.5.m4.1a"><msub id="S2.SS2.p1.5.m4.1.1" xref="S2.SS2.p1.5.m4.1.1.cmml"><mi id="S2.SS2.p1.5.m4.1.1.2" xref="S2.SS2.p1.5.m4.1.1.2.cmml">μ</mi><mi id="S2.SS2.p1.5.m4.1.1.3" xref="S2.SS2.p1.5.m4.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m4.1b"><apply id="S2.SS2.p1.5.m4.1.1.cmml" xref="S2.SS2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m4.1.1.1.cmml" xref="S2.SS2.p1.5.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m4.1.1.2.cmml" xref="S2.SS2.p1.5.m4.1.1.2">𝜇</ci><ci id="S2.SS2.p1.5.m4.1.1.3.cmml" xref="S2.SS2.p1.5.m4.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m4.1c">\mu_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m4.1d">italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="\mu_{\bm{\theta}}(\bm{x},\sigma)=\mathbb{E}[\bm{x}_{\text{real}}\mid\bm{x},\sigma]" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m5.5"><semantics id="S2.SS2.p1.6.m5.5a"><mrow id="S2.SS2.p1.6.m5.5.5" xref="S2.SS2.p1.6.m5.5.5.cmml"><mrow id="S2.SS2.p1.6.m5.5.5.3" xref="S2.SS2.p1.6.m5.5.5.3.cmml"><msub id="S2.SS2.p1.6.m5.5.5.3.2" xref="S2.SS2.p1.6.m5.5.5.3.2.cmml"><mi id="S2.SS2.p1.6.m5.5.5.3.2.2" xref="S2.SS2.p1.6.m5.5.5.3.2.2.cmml">μ</mi><mi id="S2.SS2.p1.6.m5.5.5.3.2.3" xref="S2.SS2.p1.6.m5.5.5.3.2.3.cmml">𝜽</mi></msub><mo id="S2.SS2.p1.6.m5.5.5.3.1" xref="S2.SS2.p1.6.m5.5.5.3.1.cmml">⁢</mo><mrow id="S2.SS2.p1.6.m5.5.5.3.3.2" xref="S2.SS2.p1.6.m5.5.5.3.3.1.cmml"><mo id="S2.SS2.p1.6.m5.5.5.3.3.2.1" stretchy="false" xref="S2.SS2.p1.6.m5.5.5.3.3.1.cmml">(</mo><mi id="S2.SS2.p1.6.m5.1.1" xref="S2.SS2.p1.6.m5.1.1.cmml">𝒙</mi><mo id="S2.SS2.p1.6.m5.5.5.3.3.2.2" xref="S2.SS2.p1.6.m5.5.5.3.3.1.cmml">,</mo><mi id="S2.SS2.p1.6.m5.2.2" xref="S2.SS2.p1.6.m5.2.2.cmml">σ</mi><mo id="S2.SS2.p1.6.m5.5.5.3.3.2.3" stretchy="false" xref="S2.SS2.p1.6.m5.5.5.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.6.m5.5.5.2" xref="S2.SS2.p1.6.m5.5.5.2.cmml">=</mo><mrow id="S2.SS2.p1.6.m5.5.5.1" xref="S2.SS2.p1.6.m5.5.5.1.cmml"><mi id="S2.SS2.p1.6.m5.5.5.1.3" xref="S2.SS2.p1.6.m5.5.5.1.3.cmml">𝔼</mi><mo id="S2.SS2.p1.6.m5.5.5.1.2" xref="S2.SS2.p1.6.m5.5.5.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.6.m5.5.5.1.1.1" xref="S2.SS2.p1.6.m5.5.5.1.1.2.cmml"><mo id="S2.SS2.p1.6.m5.5.5.1.1.1.2" stretchy="false" xref="S2.SS2.p1.6.m5.5.5.1.1.2.1.cmml">[</mo><mrow id="S2.SS2.p1.6.m5.5.5.1.1.1.1" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.cmml"><msub id="S2.SS2.p1.6.m5.5.5.1.1.1.1.2" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.cmml"><mi id="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.2" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.2.cmml">𝒙</mi><mtext id="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.3" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.3a.cmml">real</mtext></msub><mo id="S2.SS2.p1.6.m5.5.5.1.1.1.1.1" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.1.cmml">∣</mo><mrow id="S2.SS2.p1.6.m5.5.5.1.1.1.1.3.2" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.3.1.cmml"><mi id="S2.SS2.p1.6.m5.3.3" xref="S2.SS2.p1.6.m5.3.3.cmml">𝒙</mi><mo id="S2.SS2.p1.6.m5.5.5.1.1.1.1.3.2.1" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.3.1.cmml">,</mo><mi id="S2.SS2.p1.6.m5.4.4" xref="S2.SS2.p1.6.m5.4.4.cmml">σ</mi></mrow></mrow><mo id="S2.SS2.p1.6.m5.5.5.1.1.1.3" stretchy="false" xref="S2.SS2.p1.6.m5.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m5.5b"><apply id="S2.SS2.p1.6.m5.5.5.cmml" xref="S2.SS2.p1.6.m5.5.5"><eq id="S2.SS2.p1.6.m5.5.5.2.cmml" xref="S2.SS2.p1.6.m5.5.5.2"></eq><apply id="S2.SS2.p1.6.m5.5.5.3.cmml" xref="S2.SS2.p1.6.m5.5.5.3"><times id="S2.SS2.p1.6.m5.5.5.3.1.cmml" xref="S2.SS2.p1.6.m5.5.5.3.1"></times><apply id="S2.SS2.p1.6.m5.5.5.3.2.cmml" xref="S2.SS2.p1.6.m5.5.5.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m5.5.5.3.2.1.cmml" xref="S2.SS2.p1.6.m5.5.5.3.2">subscript</csymbol><ci id="S2.SS2.p1.6.m5.5.5.3.2.2.cmml" xref="S2.SS2.p1.6.m5.5.5.3.2.2">𝜇</ci><ci id="S2.SS2.p1.6.m5.5.5.3.2.3.cmml" xref="S2.SS2.p1.6.m5.5.5.3.2.3">𝜽</ci></apply><interval closure="open" id="S2.SS2.p1.6.m5.5.5.3.3.1.cmml" xref="S2.SS2.p1.6.m5.5.5.3.3.2"><ci id="S2.SS2.p1.6.m5.1.1.cmml" xref="S2.SS2.p1.6.m5.1.1">𝒙</ci><ci id="S2.SS2.p1.6.m5.2.2.cmml" xref="S2.SS2.p1.6.m5.2.2">𝜎</ci></interval></apply><apply id="S2.SS2.p1.6.m5.5.5.1.cmml" xref="S2.SS2.p1.6.m5.5.5.1"><times id="S2.SS2.p1.6.m5.5.5.1.2.cmml" xref="S2.SS2.p1.6.m5.5.5.1.2"></times><ci id="S2.SS2.p1.6.m5.5.5.1.3.cmml" xref="S2.SS2.p1.6.m5.5.5.1.3">𝔼</ci><apply id="S2.SS2.p1.6.m5.5.5.1.1.2.cmml" xref="S2.SS2.p1.6.m5.5.5.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.6.m5.5.5.1.1.2.1.cmml" xref="S2.SS2.p1.6.m5.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p1.6.m5.5.5.1.1.1.1.cmml" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.6.m5.5.5.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.1">conditional</csymbol><apply id="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.cmml" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.2.cmml" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.2">𝒙</ci><ci id="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.3a.cmml" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.3"><mtext id="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.2.3">real</mtext></ci></apply><list id="S2.SS2.p1.6.m5.5.5.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.6.m5.5.5.1.1.1.1.3.2"><ci id="S2.SS2.p1.6.m5.3.3.cmml" xref="S2.SS2.p1.6.m5.3.3">𝒙</ci><ci id="S2.SS2.p1.6.m5.4.4.cmml" xref="S2.SS2.p1.6.m5.4.4">𝜎</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m5.5c">\mu_{\bm{\theta}}(\bm{x},\sigma)=\mathbb{E}[\bm{x}_{\text{real}}\mid\bm{x},\sigma]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m5.5d">italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x , italic_σ ) = blackboard_E [ bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT ∣ bold_italic_x , italic_σ ]</annotation></semantics></math>. The score function is:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\bm{x}}\log p(\bm{x}\mid\sigma)\approx\frac{\bm{x}-\mu_{\bm{\theta}}(%
\bm{x},\sigma)}{\sigma}." class="ltx_Math" display="block" id="S2.E2.m1.3"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.3.cmml"><mrow id="S2.E2.m1.3.3.1.1.1.3.1" xref="S2.E2.m1.3.3.1.1.1.3.1.cmml"><msub id="S2.E2.m1.3.3.1.1.1.3.1.1" xref="S2.E2.m1.3.3.1.1.1.3.1.1.cmml"><mo id="S2.E2.m1.3.3.1.1.1.3.1.1.2" xref="S2.E2.m1.3.3.1.1.1.3.1.1.2.cmml">∇</mo><mi id="S2.E2.m1.3.3.1.1.1.3.1.1.3" xref="S2.E2.m1.3.3.1.1.1.3.1.1.3.cmml">𝒙</mi></msub><mi id="S2.E2.m1.3.3.1.1.1.3.1.2" xref="S2.E2.m1.3.3.1.1.1.3.1.2.cmml">log</mi></mrow><mo id="S2.E2.m1.3.3.1.1.1.3a" lspace="0.167em" xref="S2.E2.m1.3.3.1.1.1.3.cmml">⁡</mo><mi id="S2.E2.m1.3.3.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.3.2.cmml">p</mi></mrow><mo id="S2.E2.m1.3.3.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml">σ</mi></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.3.3.1.1.2" xref="S2.E2.m1.3.3.1.1.2.cmml">≈</mo><mfrac id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><mrow id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><mi id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.4.cmml">𝒙</mi><mo id="S2.E2.m1.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">−</mo><mrow id="S2.E2.m1.2.2.2.5" xref="S2.E2.m1.2.2.2.5.cmml"><msub id="S2.E2.m1.2.2.2.5.2" xref="S2.E2.m1.2.2.2.5.2.cmml"><mi id="S2.E2.m1.2.2.2.5.2.2" xref="S2.E2.m1.2.2.2.5.2.2.cmml">μ</mi><mi id="S2.E2.m1.2.2.2.5.2.3" xref="S2.E2.m1.2.2.2.5.2.3.cmml">𝜽</mi></msub><mo id="S2.E2.m1.2.2.2.5.1" xref="S2.E2.m1.2.2.2.5.1.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.2.5.3.2" xref="S2.E2.m1.2.2.2.5.3.1.cmml"><mo id="S2.E2.m1.2.2.2.5.3.2.1" stretchy="false" xref="S2.E2.m1.2.2.2.5.3.1.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">𝒙</mi><mo id="S2.E2.m1.2.2.2.5.3.2.2" xref="S2.E2.m1.2.2.2.5.3.1.cmml">,</mo><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">σ</mi><mo id="S2.E2.m1.2.2.2.5.3.2.3" stretchy="false" xref="S2.E2.m1.2.2.2.5.3.1.cmml">)</mo></mrow></mrow></mrow><mi id="S2.E2.m1.2.2.4" xref="S2.E2.m1.2.2.4.cmml">σ</mi></mfrac></mrow><mo id="S2.E2.m1.3.3.1.2" lspace="0em" xref="S2.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><approx id="S2.E2.m1.3.3.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2"></approx><apply id="S2.E2.m1.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.2"></times><apply id="S2.E2.m1.3.3.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3"><apply id="S2.E2.m1.3.3.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.3.1"><apply id="S2.E2.m1.3.3.1.1.1.3.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.3.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.3.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.3.1.1.2">∇</ci><ci id="S2.E2.m1.3.3.1.1.1.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3.1.1.3">𝒙</ci></apply><log id="S2.E2.m1.3.3.1.1.1.3.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.3.1.2"></log></apply><ci id="S2.E2.m1.3.3.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3">𝜎</ci></apply></apply><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2"><divide id="S2.E2.m1.2.2.3.cmml" xref="S2.E2.m1.2.2"></divide><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><minus id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.3"></minus><ci id="S2.E2.m1.2.2.2.4.cmml" xref="S2.E2.m1.2.2.2.4">𝒙</ci><apply id="S2.E2.m1.2.2.2.5.cmml" xref="S2.E2.m1.2.2.2.5"><times id="S2.E2.m1.2.2.2.5.1.cmml" xref="S2.E2.m1.2.2.2.5.1"></times><apply id="S2.E2.m1.2.2.2.5.2.cmml" xref="S2.E2.m1.2.2.2.5.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.5.2.1.cmml" xref="S2.E2.m1.2.2.2.5.2">subscript</csymbol><ci id="S2.E2.m1.2.2.2.5.2.2.cmml" xref="S2.E2.m1.2.2.2.5.2.2">𝜇</ci><ci id="S2.E2.m1.2.2.2.5.2.3.cmml" xref="S2.E2.m1.2.2.2.5.2.3">𝜽</ci></apply><interval closure="open" id="S2.E2.m1.2.2.2.5.3.1.cmml" xref="S2.E2.m1.2.2.2.5.3.2"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝒙</ci><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">𝜎</ci></interval></apply></apply><ci id="S2.E2.m1.2.2.4.cmml" xref="S2.E2.m1.2.2.4">𝜎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\nabla_{\bm{x}}\log p(\bm{x}\mid\sigma)\approx\frac{\bm{x}-\mu_{\bm{\theta}}(%
\bm{x},\sigma)}{\sigma}.</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.3d">∇ start_POSTSUBSCRIPT bold_italic_x end_POSTSUBSCRIPT roman_log italic_p ( bold_italic_x ∣ italic_σ ) ≈ divide start_ARG bold_italic_x - italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x , italic_σ ) end_ARG start_ARG italic_σ end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.8">Given a trained score model, we can generate samples at inference time by setting a decreasing <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.8.1">noise schedule</em> of <math alttext="N" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m1.1"><semantics id="S2.SS2.p1.7.m1.1a"><mi id="S2.SS2.p1.7.m1.1.1" xref="S2.SS2.p1.7.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m1.1b"><ci id="S2.SS2.p1.7.m1.1.1.cmml" xref="S2.SS2.p1.7.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m1.1d">italic_N</annotation></semantics></math> levels <math alttext="\sigma_{\text{max}}=\sigma_{N}&gt;\sigma_{N-1}&gt;\dots&gt;\sigma_{0}=\sigma_{\text{min}}" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m2.1"><semantics id="S2.SS2.p1.8.m2.1a"><mrow id="S2.SS2.p1.8.m2.1.1" xref="S2.SS2.p1.8.m2.1.1.cmml"><msub id="S2.SS2.p1.8.m2.1.1.2" xref="S2.SS2.p1.8.m2.1.1.2.cmml"><mi id="S2.SS2.p1.8.m2.1.1.2.2" xref="S2.SS2.p1.8.m2.1.1.2.2.cmml">σ</mi><mtext id="S2.SS2.p1.8.m2.1.1.2.3" xref="S2.SS2.p1.8.m2.1.1.2.3a.cmml">max</mtext></msub><mo id="S2.SS2.p1.8.m2.1.1.3" xref="S2.SS2.p1.8.m2.1.1.3.cmml">=</mo><msub id="S2.SS2.p1.8.m2.1.1.4" xref="S2.SS2.p1.8.m2.1.1.4.cmml"><mi id="S2.SS2.p1.8.m2.1.1.4.2" xref="S2.SS2.p1.8.m2.1.1.4.2.cmml">σ</mi><mi id="S2.SS2.p1.8.m2.1.1.4.3" xref="S2.SS2.p1.8.m2.1.1.4.3.cmml">N</mi></msub><mo id="S2.SS2.p1.8.m2.1.1.5" xref="S2.SS2.p1.8.m2.1.1.5.cmml">&gt;</mo><msub id="S2.SS2.p1.8.m2.1.1.6" xref="S2.SS2.p1.8.m2.1.1.6.cmml"><mi id="S2.SS2.p1.8.m2.1.1.6.2" xref="S2.SS2.p1.8.m2.1.1.6.2.cmml">σ</mi><mrow id="S2.SS2.p1.8.m2.1.1.6.3" xref="S2.SS2.p1.8.m2.1.1.6.3.cmml"><mi id="S2.SS2.p1.8.m2.1.1.6.3.2" xref="S2.SS2.p1.8.m2.1.1.6.3.2.cmml">N</mi><mo id="S2.SS2.p1.8.m2.1.1.6.3.1" xref="S2.SS2.p1.8.m2.1.1.6.3.1.cmml">−</mo><mn id="S2.SS2.p1.8.m2.1.1.6.3.3" xref="S2.SS2.p1.8.m2.1.1.6.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS2.p1.8.m2.1.1.7" xref="S2.SS2.p1.8.m2.1.1.7.cmml">&gt;</mo><mi id="S2.SS2.p1.8.m2.1.1.8" mathvariant="normal" xref="S2.SS2.p1.8.m2.1.1.8.cmml">⋯</mi><mo id="S2.SS2.p1.8.m2.1.1.9" xref="S2.SS2.p1.8.m2.1.1.9.cmml">&gt;</mo><msub id="S2.SS2.p1.8.m2.1.1.10" xref="S2.SS2.p1.8.m2.1.1.10.cmml"><mi id="S2.SS2.p1.8.m2.1.1.10.2" xref="S2.SS2.p1.8.m2.1.1.10.2.cmml">σ</mi><mn id="S2.SS2.p1.8.m2.1.1.10.3" xref="S2.SS2.p1.8.m2.1.1.10.3.cmml">0</mn></msub><mo id="S2.SS2.p1.8.m2.1.1.11" xref="S2.SS2.p1.8.m2.1.1.11.cmml">=</mo><msub id="S2.SS2.p1.8.m2.1.1.12" xref="S2.SS2.p1.8.m2.1.1.12.cmml"><mi id="S2.SS2.p1.8.m2.1.1.12.2" xref="S2.SS2.p1.8.m2.1.1.12.2.cmml">σ</mi><mtext id="S2.SS2.p1.8.m2.1.1.12.3" xref="S2.SS2.p1.8.m2.1.1.12.3a.cmml">min</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m2.1b"><apply id="S2.SS2.p1.8.m2.1.1.cmml" xref="S2.SS2.p1.8.m2.1.1"><and id="S2.SS2.p1.8.m2.1.1a.cmml" xref="S2.SS2.p1.8.m2.1.1"></and><apply id="S2.SS2.p1.8.m2.1.1b.cmml" xref="S2.SS2.p1.8.m2.1.1"><eq id="S2.SS2.p1.8.m2.1.1.3.cmml" xref="S2.SS2.p1.8.m2.1.1.3"></eq><apply id="S2.SS2.p1.8.m2.1.1.2.cmml" xref="S2.SS2.p1.8.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m2.1.1.2.1.cmml" xref="S2.SS2.p1.8.m2.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.8.m2.1.1.2.2.cmml" xref="S2.SS2.p1.8.m2.1.1.2.2">𝜎</ci><ci id="S2.SS2.p1.8.m2.1.1.2.3a.cmml" xref="S2.SS2.p1.8.m2.1.1.2.3"><mtext id="S2.SS2.p1.8.m2.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.p1.8.m2.1.1.2.3">max</mtext></ci></apply><apply id="S2.SS2.p1.8.m2.1.1.4.cmml" xref="S2.SS2.p1.8.m2.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m2.1.1.4.1.cmml" xref="S2.SS2.p1.8.m2.1.1.4">subscript</csymbol><ci id="S2.SS2.p1.8.m2.1.1.4.2.cmml" xref="S2.SS2.p1.8.m2.1.1.4.2">𝜎</ci><ci id="S2.SS2.p1.8.m2.1.1.4.3.cmml" xref="S2.SS2.p1.8.m2.1.1.4.3">𝑁</ci></apply></apply><apply id="S2.SS2.p1.8.m2.1.1c.cmml" xref="S2.SS2.p1.8.m2.1.1"><gt id="S2.SS2.p1.8.m2.1.1.5.cmml" xref="S2.SS2.p1.8.m2.1.1.5"></gt><share href="https://arxiv.org/html/2410.05167v1#S2.SS2.p1.8.m2.1.1.4.cmml" id="S2.SS2.p1.8.m2.1.1d.cmml" xref="S2.SS2.p1.8.m2.1.1"></share><apply id="S2.SS2.p1.8.m2.1.1.6.cmml" xref="S2.SS2.p1.8.m2.1.1.6"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m2.1.1.6.1.cmml" xref="S2.SS2.p1.8.m2.1.1.6">subscript</csymbol><ci id="S2.SS2.p1.8.m2.1.1.6.2.cmml" xref="S2.SS2.p1.8.m2.1.1.6.2">𝜎</ci><apply id="S2.SS2.p1.8.m2.1.1.6.3.cmml" xref="S2.SS2.p1.8.m2.1.1.6.3"><minus id="S2.SS2.p1.8.m2.1.1.6.3.1.cmml" xref="S2.SS2.p1.8.m2.1.1.6.3.1"></minus><ci id="S2.SS2.p1.8.m2.1.1.6.3.2.cmml" xref="S2.SS2.p1.8.m2.1.1.6.3.2">𝑁</ci><cn id="S2.SS2.p1.8.m2.1.1.6.3.3.cmml" type="integer" xref="S2.SS2.p1.8.m2.1.1.6.3.3">1</cn></apply></apply></apply><apply id="S2.SS2.p1.8.m2.1.1e.cmml" xref="S2.SS2.p1.8.m2.1.1"><gt id="S2.SS2.p1.8.m2.1.1.7.cmml" xref="S2.SS2.p1.8.m2.1.1.7"></gt><share href="https://arxiv.org/html/2410.05167v1#S2.SS2.p1.8.m2.1.1.6.cmml" id="S2.SS2.p1.8.m2.1.1f.cmml" xref="S2.SS2.p1.8.m2.1.1"></share><ci id="S2.SS2.p1.8.m2.1.1.8.cmml" xref="S2.SS2.p1.8.m2.1.1.8">⋯</ci></apply><apply id="S2.SS2.p1.8.m2.1.1g.cmml" xref="S2.SS2.p1.8.m2.1.1"><gt id="S2.SS2.p1.8.m2.1.1.9.cmml" xref="S2.SS2.p1.8.m2.1.1.9"></gt><share href="https://arxiv.org/html/2410.05167v1#S2.SS2.p1.8.m2.1.1.8.cmml" id="S2.SS2.p1.8.m2.1.1h.cmml" xref="S2.SS2.p1.8.m2.1.1"></share><apply id="S2.SS2.p1.8.m2.1.1.10.cmml" xref="S2.SS2.p1.8.m2.1.1.10"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m2.1.1.10.1.cmml" xref="S2.SS2.p1.8.m2.1.1.10">subscript</csymbol><ci id="S2.SS2.p1.8.m2.1.1.10.2.cmml" xref="S2.SS2.p1.8.m2.1.1.10.2">𝜎</ci><cn id="S2.SS2.p1.8.m2.1.1.10.3.cmml" type="integer" xref="S2.SS2.p1.8.m2.1.1.10.3">0</cn></apply></apply><apply id="S2.SS2.p1.8.m2.1.1i.cmml" xref="S2.SS2.p1.8.m2.1.1"><eq id="S2.SS2.p1.8.m2.1.1.11.cmml" xref="S2.SS2.p1.8.m2.1.1.11"></eq><share href="https://arxiv.org/html/2410.05167v1#S2.SS2.p1.8.m2.1.1.10.cmml" id="S2.SS2.p1.8.m2.1.1j.cmml" xref="S2.SS2.p1.8.m2.1.1"></share><apply id="S2.SS2.p1.8.m2.1.1.12.cmml" xref="S2.SS2.p1.8.m2.1.1.12"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m2.1.1.12.1.cmml" xref="S2.SS2.p1.8.m2.1.1.12">subscript</csymbol><ci id="S2.SS2.p1.8.m2.1.1.12.2.cmml" xref="S2.SS2.p1.8.m2.1.1.12.2">𝜎</ci><ci id="S2.SS2.p1.8.m2.1.1.12.3a.cmml" xref="S2.SS2.p1.8.m2.1.1.12.3"><mtext id="S2.SS2.p1.8.m2.1.1.12.3.cmml" mathsize="70%" xref="S2.SS2.p1.8.m2.1.1.12.3">min</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m2.1c">\sigma_{\text{max}}=\sigma_{N}&gt;\sigma_{N-1}&gt;\dots&gt;\sigma_{0}=\sigma_{\text{min}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m2.1d">italic_σ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT = italic_σ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT &gt; italic_σ start_POSTSUBSCRIPT italic_N - 1 end_POSTSUBSCRIPT &gt; ⋯ &gt; italic_σ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_σ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT</annotation></semantics></math> and iteratively solving the ODE at these levels using our model and any off-the-shelf ODE solver (e.g. Euler, Heun).</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.11">The EDM-family <cite class="ltx_cite ltx_citemacro_citep">(Karras et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib23" title="">2022</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib24" title="">2023</a>)</cite> of score-based diffusion models is of particular interest and unifies several continuous-time model variants within a common framework and improves model parameterization and training process.
The EDM score model is trained by minimizing a reweighted denoising score matching (DSM) loss <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib56" title="">2021</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{DSM}}=\mathbb{E}_{\bm{x}_{\text{real}}\sim\mathcal{D},%
\sigma\sim p(\sigma^{\text{train}}),\epsilon\sim\mathcal{N}(0,\bm{I})}\left[%
\lambda(\sigma)\|\bm{x}_{\text{real}}-\mu_{\bm{\theta}}(\bm{x}_{\text{real}}+%
\epsilon\sigma,\sigma)\|_{2}^{2}\right]," class="ltx_Math" display="block" id="S2.E3.m1.7"><semantics id="S2.E3.m1.7a"><mrow id="S2.E3.m1.7.7.1" xref="S2.E3.m1.7.7.1.1.cmml"><mrow id="S2.E3.m1.7.7.1.1" xref="S2.E3.m1.7.7.1.1.cmml"><msub id="S2.E3.m1.7.7.1.1.3" xref="S2.E3.m1.7.7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.7.7.1.1.3.2" xref="S2.E3.m1.7.7.1.1.3.2.cmml">ℒ</mi><mtext id="S2.E3.m1.7.7.1.1.3.3" xref="S2.E3.m1.7.7.1.1.3.3a.cmml">DSM</mtext></msub><mo id="S2.E3.m1.7.7.1.1.2" xref="S2.E3.m1.7.7.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.7.7.1.1.1" xref="S2.E3.m1.7.7.1.1.1.cmml"><msub id="S2.E3.m1.7.7.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.3.2" xref="S2.E3.m1.7.7.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E3.m1.4.4.4.4" xref="S2.E3.m1.4.4.4.5.cmml"><mrow id="S2.E3.m1.3.3.3.3.1" xref="S2.E3.m1.3.3.3.3.1.cmml"><msub id="S2.E3.m1.3.3.3.3.1.2" xref="S2.E3.m1.3.3.3.3.1.2.cmml"><mi id="S2.E3.m1.3.3.3.3.1.2.2" xref="S2.E3.m1.3.3.3.3.1.2.2.cmml">𝒙</mi><mtext id="S2.E3.m1.3.3.3.3.1.2.3" xref="S2.E3.m1.3.3.3.3.1.2.3a.cmml">real</mtext></msub><mo id="S2.E3.m1.3.3.3.3.1.1" xref="S2.E3.m1.3.3.3.3.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.3.3.3.3.1.3" xref="S2.E3.m1.3.3.3.3.1.3.cmml">𝒟</mi></mrow><mo id="S2.E3.m1.4.4.4.4.3" xref="S2.E3.m1.4.4.4.5a.cmml">,</mo><mrow id="S2.E3.m1.4.4.4.4.2.2" xref="S2.E3.m1.4.4.4.4.2.3.cmml"><mrow id="S2.E3.m1.4.4.4.4.2.1.1" xref="S2.E3.m1.4.4.4.4.2.1.1.cmml"><mi id="S2.E3.m1.4.4.4.4.2.1.1.3" xref="S2.E3.m1.4.4.4.4.2.1.1.3.cmml">σ</mi><mo id="S2.E3.m1.4.4.4.4.2.1.1.2" xref="S2.E3.m1.4.4.4.4.2.1.1.2.cmml">∼</mo><mrow id="S2.E3.m1.4.4.4.4.2.1.1.1" xref="S2.E3.m1.4.4.4.4.2.1.1.1.cmml"><mi id="S2.E3.m1.4.4.4.4.2.1.1.1.3" xref="S2.E3.m1.4.4.4.4.2.1.1.1.3.cmml">p</mi><mo id="S2.E3.m1.4.4.4.4.2.1.1.1.2" xref="S2.E3.m1.4.4.4.4.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.2" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.2.cmml">σ</mi><mtext id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.3" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.4.4.4.4.2.2.3" xref="S2.E3.m1.4.4.4.4.2.3a.cmml">,</mo><mrow id="S2.E3.m1.4.4.4.4.2.2.2" xref="S2.E3.m1.4.4.4.4.2.2.2.cmml"><mi id="S2.E3.m1.4.4.4.4.2.2.2.2" xref="S2.E3.m1.4.4.4.4.2.2.2.2.cmml">ϵ</mi><mo id="S2.E3.m1.4.4.4.4.2.2.2.1" xref="S2.E3.m1.4.4.4.4.2.2.2.1.cmml">∼</mo><mrow id="S2.E3.m1.4.4.4.4.2.2.2.3" xref="S2.E3.m1.4.4.4.4.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.4.4.4.4.2.2.2.3.2" xref="S2.E3.m1.4.4.4.4.2.2.2.3.2.cmml">𝒩</mi><mo id="S2.E3.m1.4.4.4.4.2.2.2.3.1" xref="S2.E3.m1.4.4.4.4.2.2.2.3.1.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.4.4.2.2.2.3.3.2" xref="S2.E3.m1.4.4.4.4.2.2.2.3.3.1.cmml"><mo id="S2.E3.m1.4.4.4.4.2.2.2.3.3.2.1" stretchy="false" xref="S2.E3.m1.4.4.4.4.2.2.2.3.3.1.cmml">(</mo><mn id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">0</mn><mo id="S2.E3.m1.4.4.4.4.2.2.2.3.3.2.2" xref="S2.E3.m1.4.4.4.4.2.2.2.3.3.1.cmml">,</mo><mi id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">𝑰</mi><mo id="S2.E3.m1.4.4.4.4.2.2.2.3.3.2.3" stretchy="false" xref="S2.E3.m1.4.4.4.4.2.2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></msub><mo id="S2.E3.m1.7.7.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.2.cmml"><mo id="S2.E3.m1.7.7.1.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.3.cmml">λ</mi><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1.4.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.4.2.1" stretchy="false" xref="S2.E3.m1.7.7.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E3.m1.5.5" xref="S2.E3.m1.5.5.cmml">σ</mi><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.4.2.2" stretchy="false" xref="S2.E3.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.2a" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="S2.E3.m1.7.7.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒙</mi><mtext id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml">real</mtext></msub><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mtext id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml">real</mtext></msub><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">σ</mi></mrow></mrow><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml">σ</mi><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S2.E3.m1.7.7.1.1.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow><mo id="S2.E3.m1.7.7.1.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E3.m1.7.7.1.2" xref="S2.E3.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.7b"><apply id="S2.E3.m1.7.7.1.1.cmml" xref="S2.E3.m1.7.7.1"><eq id="S2.E3.m1.7.7.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.2"></eq><apply id="S2.E3.m1.7.7.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.3">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.3.2.cmml" xref="S2.E3.m1.7.7.1.1.3.2">ℒ</ci><ci id="S2.E3.m1.7.7.1.1.3.3a.cmml" xref="S2.E3.m1.7.7.1.1.3.3"><mtext id="S2.E3.m1.7.7.1.1.3.3.cmml" mathsize="70%" xref="S2.E3.m1.7.7.1.1.3.3">DSM</mtext></ci></apply><apply id="S2.E3.m1.7.7.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1"><times id="S2.E3.m1.7.7.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.2"></times><apply id="S2.E3.m1.7.7.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.3.2">𝔼</ci><apply id="S2.E3.m1.4.4.4.5.cmml" xref="S2.E3.m1.4.4.4.4"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.5a.cmml" xref="S2.E3.m1.4.4.4.4.3">formulae-sequence</csymbol><apply id="S2.E3.m1.3.3.3.3.1.cmml" xref="S2.E3.m1.3.3.3.3.1"><csymbol cd="latexml" id="S2.E3.m1.3.3.3.3.1.1.cmml" xref="S2.E3.m1.3.3.3.3.1.1">similar-to</csymbol><apply id="S2.E3.m1.3.3.3.3.1.2.cmml" xref="S2.E3.m1.3.3.3.3.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.3.3.1.2.1.cmml" xref="S2.E3.m1.3.3.3.3.1.2">subscript</csymbol><ci id="S2.E3.m1.3.3.3.3.1.2.2.cmml" xref="S2.E3.m1.3.3.3.3.1.2.2">𝒙</ci><ci id="S2.E3.m1.3.3.3.3.1.2.3a.cmml" xref="S2.E3.m1.3.3.3.3.1.2.3"><mtext id="S2.E3.m1.3.3.3.3.1.2.3.cmml" mathsize="50%" xref="S2.E3.m1.3.3.3.3.1.2.3">real</mtext></ci></apply><ci id="S2.E3.m1.3.3.3.3.1.3.cmml" xref="S2.E3.m1.3.3.3.3.1.3">𝒟</ci></apply><apply id="S2.E3.m1.4.4.4.4.2.3.cmml" xref="S2.E3.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.4.2.3a.cmml" xref="S2.E3.m1.4.4.4.4.2.2.3">formulae-sequence</csymbol><apply id="S2.E3.m1.4.4.4.4.2.1.1.cmml" xref="S2.E3.m1.4.4.4.4.2.1.1"><csymbol cd="latexml" id="S2.E3.m1.4.4.4.4.2.1.1.2.cmml" xref="S2.E3.m1.4.4.4.4.2.1.1.2">similar-to</csymbol><ci id="S2.E3.m1.4.4.4.4.2.1.1.3.cmml" xref="S2.E3.m1.4.4.4.4.2.1.1.3">𝜎</ci><apply id="S2.E3.m1.4.4.4.4.2.1.1.1.cmml" xref="S2.E3.m1.4.4.4.4.2.1.1.1"><times id="S2.E3.m1.4.4.4.4.2.1.1.1.2.cmml" xref="S2.E3.m1.4.4.4.4.2.1.1.1.2"></times><ci id="S2.E3.m1.4.4.4.4.2.1.1.1.3.cmml" xref="S2.E3.m1.4.4.4.4.2.1.1.1.3">𝑝</ci><apply id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1">superscript</csymbol><ci id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.2">𝜎</ci><ci id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.3a.cmml" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.3"><mtext id="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.3.cmml" mathsize="50%" xref="S2.E3.m1.4.4.4.4.2.1.1.1.1.1.1.3">train</mtext></ci></apply></apply></apply><apply id="S2.E3.m1.4.4.4.4.2.2.2.cmml" xref="S2.E3.m1.4.4.4.4.2.2.2"><csymbol cd="latexml" id="S2.E3.m1.4.4.4.4.2.2.2.1.cmml" xref="S2.E3.m1.4.4.4.4.2.2.2.1">similar-to</csymbol><ci id="S2.E3.m1.4.4.4.4.2.2.2.2.cmml" xref="S2.E3.m1.4.4.4.4.2.2.2.2">italic-ϵ</ci><apply id="S2.E3.m1.4.4.4.4.2.2.2.3.cmml" xref="S2.E3.m1.4.4.4.4.2.2.2.3"><times id="S2.E3.m1.4.4.4.4.2.2.2.3.1.cmml" xref="S2.E3.m1.4.4.4.4.2.2.2.3.1"></times><ci id="S2.E3.m1.4.4.4.4.2.2.2.3.2.cmml" xref="S2.E3.m1.4.4.4.4.2.2.2.3.2">𝒩</ci><interval closure="open" id="S2.E3.m1.4.4.4.4.2.2.2.3.3.1.cmml" xref="S2.E3.m1.4.4.4.4.2.2.2.3.3.2"><cn id="S2.E3.m1.1.1.1.1.cmml" type="integer" xref="S2.E3.m1.1.1.1.1">0</cn><ci id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2">𝑰</ci></interval></apply></apply></apply></apply></apply><apply id="S2.E3.m1.7.7.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.7.7.1.1.1.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1"><times id="S2.E3.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.2"></times><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.3">𝜆</ci><ci id="S2.E3.m1.5.5.cmml" xref="S2.E3.m1.5.5">𝜎</ci><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><minus id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2">𝒙</ci><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3"><mtext id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3">real</mtext></ci></apply><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝜇</ci><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝜽</ci></apply><interval closure="open" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><mtext id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">real</mtext></ci></apply><apply id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝜎</ci></apply></apply><ci id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6">𝜎</ci></interval></apply></apply></apply><cn id="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S2.E3.m1.7.7.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E3.m1.7.7.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.7c">\mathcal{L}_{\text{DSM}}=\mathbb{E}_{\bm{x}_{\text{real}}\sim\mathcal{D},%
\sigma\sim p(\sigma^{\text{train}}),\epsilon\sim\mathcal{N}(0,\bm{I})}\left[%
\lambda(\sigma)\|\bm{x}_{\text{real}}-\mu_{\bm{\theta}}(\bm{x}_{\text{real}}+%
\epsilon\sigma,\sigma)\|_{2}^{2}\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.7d">caligraphic_L start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT ∼ caligraphic_D , italic_σ ∼ italic_p ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT ) , italic_ϵ ∼ caligraphic_N ( 0 , bold_italic_I ) end_POSTSUBSCRIPT [ italic_λ ( italic_σ ) ∥ bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT + italic_ϵ italic_σ , italic_σ ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p2.5">where <math alttext="p(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">p</mi><mo id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.1.m1.1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p2.1.m1.1.1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2.cmml">σ</mi><mtext id="S2.SS2.p2.1.m1.1.1.1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S2.SS2.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><times id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2"></times><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">𝑝</ci><apply id="S2.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2">𝜎</ci><ci id="S2.SS2.p2.1.m1.1.1.1.1.1.3a.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3"><mtext id="S2.SS2.p2.1.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">p(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_p ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math> denotes the <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.5.1">noise distribution</em> during training, and <math alttext="\lambda(\sigma)" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.2" xref="S2.SS2.p2.2.m2.1.2.cmml"><mi id="S2.SS2.p2.2.m2.1.2.2" xref="S2.SS2.p2.2.m2.1.2.2.cmml">λ</mi><mo id="S2.SS2.p2.2.m2.1.2.1" xref="S2.SS2.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p2.2.m2.1.2.3.2" xref="S2.SS2.p2.2.m2.1.2.cmml"><mo id="S2.SS2.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS2.p2.2.m2.1.2.cmml">(</mo><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">σ</mi><mo id="S2.SS2.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.2.cmml" xref="S2.SS2.p2.2.m2.1.2"><times id="S2.SS2.p2.2.m2.1.2.1.cmml" xref="S2.SS2.p2.2.m2.1.2.1"></times><ci id="S2.SS2.p2.2.m2.1.2.2.cmml" xref="S2.SS2.p2.2.m2.1.2.2">𝜆</ci><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\lambda(\sigma)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_λ ( italic_σ )</annotation></semantics></math> is a noise-level weighting function. Notably, EDM defines a <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.5.2">different</em> noise distribution to discretize for inference <math alttext="p(\sigma^{\text{inf}})" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><mrow id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">p</mi><mo id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.3.m3.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p2.3.m3.1.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.cmml">σ</mi><mtext id="S2.SS2.p2.3.m3.1.1.1.1.1.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3a.cmml">inf</mtext></msup><mo id="S2.SS2.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><times id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2"></times><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝑝</ci><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2">𝜎</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3a.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3"><mtext id="S2.SS2.p2.3.m3.1.1.1.1.1.3.cmml" mathsize="70%" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3">inf</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">p(\sigma^{\text{inf}})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_p ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT )</annotation></semantics></math> that is distinct from <math alttext="p(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">p</mi><mo id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.4.m4.1.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.4.m4.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p2.4.m4.1.1.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.1.1.1.2" xref="S2.SS2.p2.4.m4.1.1.1.1.1.2.cmml">σ</mi><mtext id="S2.SS2.p2.4.m4.1.1.1.1.1.3" xref="S2.SS2.p2.4.m4.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S2.SS2.p2.4.m4.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><times id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2"></times><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">𝑝</ci><apply id="S2.SS2.p2.4.m4.1.1.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.1.1.1.2">𝜎</ci><ci id="S2.SS2.p2.4.m4.1.1.1.1.1.3a.cmml" xref="S2.SS2.p2.4.m4.1.1.1.1.1.3"><mtext id="S2.SS2.p2.4.m4.1.1.1.1.1.3.cmml" mathsize="70%" xref="S2.SS2.p2.4.m4.1.1.1.1.1.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">p(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">italic_p ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math> (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.F2" title="Figure 2 ‣ 3.2.2 Perceptual Loss Weighting with Variable Noise Distributions ‣ 3.2 Presto-S: Score-based Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">2</span></a>), as opposed to a noise schedule shared between training and inference.
Additionally, EDMs represent the denoising network using extra noise-dependent preconditioning parameters, training a network <math alttext="f_{\bm{\theta}}" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.1"><semantics id="S2.SS2.p2.5.m5.1a"><msub id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">f</mi><mi id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">𝑓</ci><ci id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">f_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.1d">italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> with the parameterization:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mu_{\bm{\theta}}(\bm{x},\sigma)=c_{\text{skip}}(\sigma)\bm{x}+c_{\text{out}}(%
\sigma)f_{\bm{\theta}}(c_{\text{in}}(\sigma)\bm{x},c_{\text{noise}}(\sigma))." class="ltx_Math" display="block" id="S2.E4.m1.7"><semantics id="S2.E4.m1.7a"><mrow id="S2.E4.m1.7.7.1" xref="S2.E4.m1.7.7.1.1.cmml"><mrow id="S2.E4.m1.7.7.1.1" xref="S2.E4.m1.7.7.1.1.cmml"><mrow id="S2.E4.m1.7.7.1.1.4" xref="S2.E4.m1.7.7.1.1.4.cmml"><msub id="S2.E4.m1.7.7.1.1.4.2" xref="S2.E4.m1.7.7.1.1.4.2.cmml"><mi id="S2.E4.m1.7.7.1.1.4.2.2" xref="S2.E4.m1.7.7.1.1.4.2.2.cmml">μ</mi><mi id="S2.E4.m1.7.7.1.1.4.2.3" xref="S2.E4.m1.7.7.1.1.4.2.3.cmml">𝜽</mi></msub><mo id="S2.E4.m1.7.7.1.1.4.1" xref="S2.E4.m1.7.7.1.1.4.1.cmml">⁢</mo><mrow id="S2.E4.m1.7.7.1.1.4.3.2" xref="S2.E4.m1.7.7.1.1.4.3.1.cmml"><mo id="S2.E4.m1.7.7.1.1.4.3.2.1" stretchy="false" xref="S2.E4.m1.7.7.1.1.4.3.1.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">𝒙</mi><mo id="S2.E4.m1.7.7.1.1.4.3.2.2" xref="S2.E4.m1.7.7.1.1.4.3.1.cmml">,</mo><mi id="S2.E4.m1.2.2" xref="S2.E4.m1.2.2.cmml">σ</mi><mo id="S2.E4.m1.7.7.1.1.4.3.2.3" stretchy="false" xref="S2.E4.m1.7.7.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.7.7.1.1.3" xref="S2.E4.m1.7.7.1.1.3.cmml">=</mo><mrow id="S2.E4.m1.7.7.1.1.2" xref="S2.E4.m1.7.7.1.1.2.cmml"><mrow id="S2.E4.m1.7.7.1.1.2.4" xref="S2.E4.m1.7.7.1.1.2.4.cmml"><msub id="S2.E4.m1.7.7.1.1.2.4.2" xref="S2.E4.m1.7.7.1.1.2.4.2.cmml"><mi id="S2.E4.m1.7.7.1.1.2.4.2.2" xref="S2.E4.m1.7.7.1.1.2.4.2.2.cmml">c</mi><mtext id="S2.E4.m1.7.7.1.1.2.4.2.3" xref="S2.E4.m1.7.7.1.1.2.4.2.3a.cmml">skip</mtext></msub><mo id="S2.E4.m1.7.7.1.1.2.4.1" xref="S2.E4.m1.7.7.1.1.2.4.1.cmml">⁢</mo><mrow id="S2.E4.m1.7.7.1.1.2.4.3.2" xref="S2.E4.m1.7.7.1.1.2.4.cmml"><mo id="S2.E4.m1.7.7.1.1.2.4.3.2.1" stretchy="false" xref="S2.E4.m1.7.7.1.1.2.4.cmml">(</mo><mi id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml">σ</mi><mo id="S2.E4.m1.7.7.1.1.2.4.3.2.2" stretchy="false" xref="S2.E4.m1.7.7.1.1.2.4.cmml">)</mo></mrow><mo id="S2.E4.m1.7.7.1.1.2.4.1a" xref="S2.E4.m1.7.7.1.1.2.4.1.cmml">⁢</mo><mi id="S2.E4.m1.7.7.1.1.2.4.4" xref="S2.E4.m1.7.7.1.1.2.4.4.cmml">𝒙</mi></mrow><mo id="S2.E4.m1.7.7.1.1.2.3" xref="S2.E4.m1.7.7.1.1.2.3.cmml">+</mo><mrow id="S2.E4.m1.7.7.1.1.2.2" xref="S2.E4.m1.7.7.1.1.2.2.cmml"><msub id="S2.E4.m1.7.7.1.1.2.2.4" xref="S2.E4.m1.7.7.1.1.2.2.4.cmml"><mi id="S2.E4.m1.7.7.1.1.2.2.4.2" xref="S2.E4.m1.7.7.1.1.2.2.4.2.cmml">c</mi><mtext id="S2.E4.m1.7.7.1.1.2.2.4.3" xref="S2.E4.m1.7.7.1.1.2.2.4.3a.cmml">out</mtext></msub><mo id="S2.E4.m1.7.7.1.1.2.2.3" xref="S2.E4.m1.7.7.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.7.7.1.1.2.2.5.2" xref="S2.E4.m1.7.7.1.1.2.2.cmml"><mo id="S2.E4.m1.7.7.1.1.2.2.5.2.1" stretchy="false" xref="S2.E4.m1.7.7.1.1.2.2.cmml">(</mo><mi id="S2.E4.m1.4.4" xref="S2.E4.m1.4.4.cmml">σ</mi><mo id="S2.E4.m1.7.7.1.1.2.2.5.2.2" stretchy="false" xref="S2.E4.m1.7.7.1.1.2.2.cmml">)</mo></mrow><mo id="S2.E4.m1.7.7.1.1.2.2.3a" xref="S2.E4.m1.7.7.1.1.2.2.3.cmml">⁢</mo><msub id="S2.E4.m1.7.7.1.1.2.2.6" xref="S2.E4.m1.7.7.1.1.2.2.6.cmml"><mi id="S2.E4.m1.7.7.1.1.2.2.6.2" xref="S2.E4.m1.7.7.1.1.2.2.6.2.cmml">f</mi><mi id="S2.E4.m1.7.7.1.1.2.2.6.3" xref="S2.E4.m1.7.7.1.1.2.2.6.3.cmml">𝜽</mi></msub><mo id="S2.E4.m1.7.7.1.1.2.2.3b" xref="S2.E4.m1.7.7.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.7.7.1.1.2.2.2.2" xref="S2.E4.m1.7.7.1.1.2.2.2.3.cmml"><mo id="S2.E4.m1.7.7.1.1.2.2.2.2.3" stretchy="false" xref="S2.E4.m1.7.7.1.1.2.2.2.3.cmml">(</mo><mrow id="S2.E4.m1.7.7.1.1.1.1.1.1.1" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.cmml"><msub id="S2.E4.m1.7.7.1.1.1.1.1.1.1.2" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.2" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.2.cmml">c</mi><mtext id="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.3" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.3a.cmml">in</mtext></msub><mo id="S2.E4.m1.7.7.1.1.1.1.1.1.1.1" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.7.7.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E4.m1.5.5" xref="S2.E4.m1.5.5.cmml">σ</mi><mo id="S2.E4.m1.7.7.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E4.m1.7.7.1.1.1.1.1.1.1.1a" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E4.m1.7.7.1.1.1.1.1.1.1.4" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.4.cmml">𝒙</mi></mrow><mo id="S2.E4.m1.7.7.1.1.2.2.2.2.4" xref="S2.E4.m1.7.7.1.1.2.2.2.3.cmml">,</mo><mrow id="S2.E4.m1.7.7.1.1.2.2.2.2.2" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.cmml"><msub id="S2.E4.m1.7.7.1.1.2.2.2.2.2.2" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.cmml"><mi id="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.2" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.2.cmml">c</mi><mtext id="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.3" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.3a.cmml">noise</mtext></msub><mo id="S2.E4.m1.7.7.1.1.2.2.2.2.2.1" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S2.E4.m1.7.7.1.1.2.2.2.2.2.3.2" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.cmml"><mo id="S2.E4.m1.7.7.1.1.2.2.2.2.2.3.2.1" stretchy="false" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.cmml">(</mo><mi id="S2.E4.m1.6.6" xref="S2.E4.m1.6.6.cmml">σ</mi><mo id="S2.E4.m1.7.7.1.1.2.2.2.2.2.3.2.2" stretchy="false" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.7.7.1.1.2.2.2.2.5" stretchy="false" xref="S2.E4.m1.7.7.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E4.m1.7.7.1.2" lspace="0em" xref="S2.E4.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.7b"><apply id="S2.E4.m1.7.7.1.1.cmml" xref="S2.E4.m1.7.7.1"><eq id="S2.E4.m1.7.7.1.1.3.cmml" xref="S2.E4.m1.7.7.1.1.3"></eq><apply id="S2.E4.m1.7.7.1.1.4.cmml" xref="S2.E4.m1.7.7.1.1.4"><times id="S2.E4.m1.7.7.1.1.4.1.cmml" xref="S2.E4.m1.7.7.1.1.4.1"></times><apply id="S2.E4.m1.7.7.1.1.4.2.cmml" xref="S2.E4.m1.7.7.1.1.4.2"><csymbol cd="ambiguous" id="S2.E4.m1.7.7.1.1.4.2.1.cmml" xref="S2.E4.m1.7.7.1.1.4.2">subscript</csymbol><ci id="S2.E4.m1.7.7.1.1.4.2.2.cmml" xref="S2.E4.m1.7.7.1.1.4.2.2">𝜇</ci><ci id="S2.E4.m1.7.7.1.1.4.2.3.cmml" xref="S2.E4.m1.7.7.1.1.4.2.3">𝜽</ci></apply><interval closure="open" id="S2.E4.m1.7.7.1.1.4.3.1.cmml" xref="S2.E4.m1.7.7.1.1.4.3.2"><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝒙</ci><ci id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2">𝜎</ci></interval></apply><apply id="S2.E4.m1.7.7.1.1.2.cmml" xref="S2.E4.m1.7.7.1.1.2"><plus id="S2.E4.m1.7.7.1.1.2.3.cmml" xref="S2.E4.m1.7.7.1.1.2.3"></plus><apply id="S2.E4.m1.7.7.1.1.2.4.cmml" xref="S2.E4.m1.7.7.1.1.2.4"><times id="S2.E4.m1.7.7.1.1.2.4.1.cmml" xref="S2.E4.m1.7.7.1.1.2.4.1"></times><apply id="S2.E4.m1.7.7.1.1.2.4.2.cmml" xref="S2.E4.m1.7.7.1.1.2.4.2"><csymbol cd="ambiguous" id="S2.E4.m1.7.7.1.1.2.4.2.1.cmml" xref="S2.E4.m1.7.7.1.1.2.4.2">subscript</csymbol><ci id="S2.E4.m1.7.7.1.1.2.4.2.2.cmml" xref="S2.E4.m1.7.7.1.1.2.4.2.2">𝑐</ci><ci id="S2.E4.m1.7.7.1.1.2.4.2.3a.cmml" xref="S2.E4.m1.7.7.1.1.2.4.2.3"><mtext id="S2.E4.m1.7.7.1.1.2.4.2.3.cmml" mathsize="70%" xref="S2.E4.m1.7.7.1.1.2.4.2.3">skip</mtext></ci></apply><ci id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3">𝜎</ci><ci id="S2.E4.m1.7.7.1.1.2.4.4.cmml" xref="S2.E4.m1.7.7.1.1.2.4.4">𝒙</ci></apply><apply id="S2.E4.m1.7.7.1.1.2.2.cmml" xref="S2.E4.m1.7.7.1.1.2.2"><times id="S2.E4.m1.7.7.1.1.2.2.3.cmml" xref="S2.E4.m1.7.7.1.1.2.2.3"></times><apply id="S2.E4.m1.7.7.1.1.2.2.4.cmml" xref="S2.E4.m1.7.7.1.1.2.2.4"><csymbol cd="ambiguous" id="S2.E4.m1.7.7.1.1.2.2.4.1.cmml" xref="S2.E4.m1.7.7.1.1.2.2.4">subscript</csymbol><ci id="S2.E4.m1.7.7.1.1.2.2.4.2.cmml" xref="S2.E4.m1.7.7.1.1.2.2.4.2">𝑐</ci><ci id="S2.E4.m1.7.7.1.1.2.2.4.3a.cmml" xref="S2.E4.m1.7.7.1.1.2.2.4.3"><mtext id="S2.E4.m1.7.7.1.1.2.2.4.3.cmml" mathsize="70%" xref="S2.E4.m1.7.7.1.1.2.2.4.3">out</mtext></ci></apply><ci id="S2.E4.m1.4.4.cmml" xref="S2.E4.m1.4.4">𝜎</ci><apply id="S2.E4.m1.7.7.1.1.2.2.6.cmml" xref="S2.E4.m1.7.7.1.1.2.2.6"><csymbol cd="ambiguous" id="S2.E4.m1.7.7.1.1.2.2.6.1.cmml" xref="S2.E4.m1.7.7.1.1.2.2.6">subscript</csymbol><ci id="S2.E4.m1.7.7.1.1.2.2.6.2.cmml" xref="S2.E4.m1.7.7.1.1.2.2.6.2">𝑓</ci><ci id="S2.E4.m1.7.7.1.1.2.2.6.3.cmml" xref="S2.E4.m1.7.7.1.1.2.2.6.3">𝜽</ci></apply><interval closure="open" id="S2.E4.m1.7.7.1.1.2.2.2.3.cmml" xref="S2.E4.m1.7.7.1.1.2.2.2.2"><apply id="S2.E4.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1"><times id="S2.E4.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.1"></times><apply id="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.3a.cmml" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.3"><mtext id="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.2.3">in</mtext></ci></apply><ci id="S2.E4.m1.5.5.cmml" xref="S2.E4.m1.5.5">𝜎</ci><ci id="S2.E4.m1.7.7.1.1.1.1.1.1.1.4.cmml" xref="S2.E4.m1.7.7.1.1.1.1.1.1.1.4">𝒙</ci></apply><apply id="S2.E4.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2"><times id="S2.E4.m1.7.7.1.1.2.2.2.2.2.1.cmml" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.1"></times><apply id="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.cmml" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.2">𝑐</ci><ci id="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.3a.cmml" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.3"><mtext id="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="S2.E4.m1.7.7.1.1.2.2.2.2.2.2.3">noise</mtext></ci></apply><ci id="S2.E4.m1.6.6.cmml" xref="S2.E4.m1.6.6">𝜎</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.7c">\mu_{\bm{\theta}}(\bm{x},\sigma)=c_{\text{skip}}(\sigma)\bm{x}+c_{\text{out}}(%
\sigma)f_{\bm{\theta}}(c_{\text{in}}(\sigma)\bm{x},c_{\text{noise}}(\sigma)).</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.7d">italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x , italic_σ ) = italic_c start_POSTSUBSCRIPT skip end_POSTSUBSCRIPT ( italic_σ ) bold_italic_x + italic_c start_POSTSUBSCRIPT out end_POSTSUBSCRIPT ( italic_σ ) italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( italic_c start_POSTSUBSCRIPT in end_POSTSUBSCRIPT ( italic_σ ) bold_italic_x , italic_c start_POSTSUBSCRIPT noise end_POSTSUBSCRIPT ( italic_σ ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p2.10">For TTM models, <math alttext="\mu_{\bm{\theta}}" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m1.1"><semantics id="S2.SS2.p2.6.m1.1a"><msub id="S2.SS2.p2.6.m1.1.1" xref="S2.SS2.p2.6.m1.1.1.cmml"><mi id="S2.SS2.p2.6.m1.1.1.2" xref="S2.SS2.p2.6.m1.1.1.2.cmml">μ</mi><mi id="S2.SS2.p2.6.m1.1.1.3" xref="S2.SS2.p2.6.m1.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m1.1b"><apply id="S2.SS2.p2.6.m1.1.1.cmml" xref="S2.SS2.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m1.1.1.1.cmml" xref="S2.SS2.p2.6.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.6.m1.1.1.2.cmml" xref="S2.SS2.p2.6.m1.1.1.2">𝜇</ci><ci id="S2.SS2.p2.6.m1.1.1.3.cmml" xref="S2.SS2.p2.6.m1.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m1.1c">\mu_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m1.1d">italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is equipped with various condition embeddings (e.g. text) <math alttext="\mu_{\bm{\theta}}(\bm{x},\sigma,\bm{e})" class="ltx_Math" display="inline" id="S2.SS2.p2.7.m2.3"><semantics id="S2.SS2.p2.7.m2.3a"><mrow id="S2.SS2.p2.7.m2.3.4" xref="S2.SS2.p2.7.m2.3.4.cmml"><msub id="S2.SS2.p2.7.m2.3.4.2" xref="S2.SS2.p2.7.m2.3.4.2.cmml"><mi id="S2.SS2.p2.7.m2.3.4.2.2" xref="S2.SS2.p2.7.m2.3.4.2.2.cmml">μ</mi><mi id="S2.SS2.p2.7.m2.3.4.2.3" xref="S2.SS2.p2.7.m2.3.4.2.3.cmml">𝜽</mi></msub><mo id="S2.SS2.p2.7.m2.3.4.1" xref="S2.SS2.p2.7.m2.3.4.1.cmml">⁢</mo><mrow id="S2.SS2.p2.7.m2.3.4.3.2" xref="S2.SS2.p2.7.m2.3.4.3.1.cmml"><mo id="S2.SS2.p2.7.m2.3.4.3.2.1" stretchy="false" xref="S2.SS2.p2.7.m2.3.4.3.1.cmml">(</mo><mi id="S2.SS2.p2.7.m2.1.1" xref="S2.SS2.p2.7.m2.1.1.cmml">𝒙</mi><mo id="S2.SS2.p2.7.m2.3.4.3.2.2" xref="S2.SS2.p2.7.m2.3.4.3.1.cmml">,</mo><mi id="S2.SS2.p2.7.m2.2.2" xref="S2.SS2.p2.7.m2.2.2.cmml">σ</mi><mo id="S2.SS2.p2.7.m2.3.4.3.2.3" xref="S2.SS2.p2.7.m2.3.4.3.1.cmml">,</mo><mi id="S2.SS2.p2.7.m2.3.3" xref="S2.SS2.p2.7.m2.3.3.cmml">𝒆</mi><mo id="S2.SS2.p2.7.m2.3.4.3.2.4" stretchy="false" xref="S2.SS2.p2.7.m2.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m2.3b"><apply id="S2.SS2.p2.7.m2.3.4.cmml" xref="S2.SS2.p2.7.m2.3.4"><times id="S2.SS2.p2.7.m2.3.4.1.cmml" xref="S2.SS2.p2.7.m2.3.4.1"></times><apply id="S2.SS2.p2.7.m2.3.4.2.cmml" xref="S2.SS2.p2.7.m2.3.4.2"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m2.3.4.2.1.cmml" xref="S2.SS2.p2.7.m2.3.4.2">subscript</csymbol><ci id="S2.SS2.p2.7.m2.3.4.2.2.cmml" xref="S2.SS2.p2.7.m2.3.4.2.2">𝜇</ci><ci id="S2.SS2.p2.7.m2.3.4.2.3.cmml" xref="S2.SS2.p2.7.m2.3.4.2.3">𝜽</ci></apply><vector id="S2.SS2.p2.7.m2.3.4.3.1.cmml" xref="S2.SS2.p2.7.m2.3.4.3.2"><ci id="S2.SS2.p2.7.m2.1.1.cmml" xref="S2.SS2.p2.7.m2.1.1">𝒙</ci><ci id="S2.SS2.p2.7.m2.2.2.cmml" xref="S2.SS2.p2.7.m2.2.2">𝜎</ci><ci id="S2.SS2.p2.7.m2.3.3.cmml" xref="S2.SS2.p2.7.m2.3.3">𝒆</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m2.3c">\mu_{\bm{\theta}}(\bm{x},\sigma,\bm{e})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m2.3d">italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x , italic_σ , bold_italic_e )</annotation></semantics></math>. To increase text relevance and quality at the cost of diversity, we employ <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.10.1">classifier free guidance</em> (CFG) <cite class="ltx_cite ltx_citemacro_citep">(Ho &amp; Salimans, <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib17" title="">2021</a>)</cite>, converting the denoised output to: <math alttext="\tilde{\mu}^{w}_{\bm{\theta}}(\bm{x},\sigma,\bm{e})=\mu_{\bm{\theta}}(\bm{x},%
\sigma,\bm{\emptyset})+w(\mu_{\bm{\theta}}(\bm{x},\sigma,\bm{e})-\mu_{\bm{%
\theta}}(\bm{x},\sigma,\bm{\emptyset}))" class="ltx_Math" display="inline" id="S2.SS2.p2.8.m3.13"><semantics id="S2.SS2.p2.8.m3.13a"><mrow id="S2.SS2.p2.8.m3.13.13" xref="S2.SS2.p2.8.m3.13.13.cmml"><mrow id="S2.SS2.p2.8.m3.13.13.3" xref="S2.SS2.p2.8.m3.13.13.3.cmml"><msubsup id="S2.SS2.p2.8.m3.13.13.3.2" xref="S2.SS2.p2.8.m3.13.13.3.2.cmml"><mover accent="true" id="S2.SS2.p2.8.m3.13.13.3.2.2.2" xref="S2.SS2.p2.8.m3.13.13.3.2.2.2.cmml"><mi id="S2.SS2.p2.8.m3.13.13.3.2.2.2.2" xref="S2.SS2.p2.8.m3.13.13.3.2.2.2.2.cmml">μ</mi><mo id="S2.SS2.p2.8.m3.13.13.3.2.2.2.1" xref="S2.SS2.p2.8.m3.13.13.3.2.2.2.1.cmml">~</mo></mover><mi id="S2.SS2.p2.8.m3.13.13.3.2.3" xref="S2.SS2.p2.8.m3.13.13.3.2.3.cmml">𝜽</mi><mi id="S2.SS2.p2.8.m3.13.13.3.2.2.3" xref="S2.SS2.p2.8.m3.13.13.3.2.2.3.cmml">w</mi></msubsup><mo id="S2.SS2.p2.8.m3.13.13.3.1" xref="S2.SS2.p2.8.m3.13.13.3.1.cmml">⁢</mo><mrow id="S2.SS2.p2.8.m3.13.13.3.3.2" xref="S2.SS2.p2.8.m3.13.13.3.3.1.cmml"><mo id="S2.SS2.p2.8.m3.13.13.3.3.2.1" stretchy="false" xref="S2.SS2.p2.8.m3.13.13.3.3.1.cmml">(</mo><mi id="S2.SS2.p2.8.m3.1.1" xref="S2.SS2.p2.8.m3.1.1.cmml">𝒙</mi><mo id="S2.SS2.p2.8.m3.13.13.3.3.2.2" xref="S2.SS2.p2.8.m3.13.13.3.3.1.cmml">,</mo><mi id="S2.SS2.p2.8.m3.2.2" xref="S2.SS2.p2.8.m3.2.2.cmml">σ</mi><mo id="S2.SS2.p2.8.m3.13.13.3.3.2.3" xref="S2.SS2.p2.8.m3.13.13.3.3.1.cmml">,</mo><mi id="S2.SS2.p2.8.m3.3.3" xref="S2.SS2.p2.8.m3.3.3.cmml">𝒆</mi><mo id="S2.SS2.p2.8.m3.13.13.3.3.2.4" stretchy="false" xref="S2.SS2.p2.8.m3.13.13.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.8.m3.13.13.2" xref="S2.SS2.p2.8.m3.13.13.2.cmml">=</mo><mrow id="S2.SS2.p2.8.m3.13.13.1" xref="S2.SS2.p2.8.m3.13.13.1.cmml"><mrow id="S2.SS2.p2.8.m3.13.13.1.3" xref="S2.SS2.p2.8.m3.13.13.1.3.cmml"><msub id="S2.SS2.p2.8.m3.13.13.1.3.2" xref="S2.SS2.p2.8.m3.13.13.1.3.2.cmml"><mi id="S2.SS2.p2.8.m3.13.13.1.3.2.2" xref="S2.SS2.p2.8.m3.13.13.1.3.2.2.cmml">μ</mi><mi id="S2.SS2.p2.8.m3.13.13.1.3.2.3" xref="S2.SS2.p2.8.m3.13.13.1.3.2.3.cmml">𝜽</mi></msub><mo id="S2.SS2.p2.8.m3.13.13.1.3.1" xref="S2.SS2.p2.8.m3.13.13.1.3.1.cmml">⁢</mo><mrow id="S2.SS2.p2.8.m3.13.13.1.3.3.2" xref="S2.SS2.p2.8.m3.13.13.1.3.3.1.cmml"><mo id="S2.SS2.p2.8.m3.13.13.1.3.3.2.1" stretchy="false" xref="S2.SS2.p2.8.m3.13.13.1.3.3.1.cmml">(</mo><mi id="S2.SS2.p2.8.m3.4.4" xref="S2.SS2.p2.8.m3.4.4.cmml">𝒙</mi><mo id="S2.SS2.p2.8.m3.13.13.1.3.3.2.2" xref="S2.SS2.p2.8.m3.13.13.1.3.3.1.cmml">,</mo><mi id="S2.SS2.p2.8.m3.5.5" xref="S2.SS2.p2.8.m3.5.5.cmml">σ</mi><mo id="S2.SS2.p2.8.m3.13.13.1.3.3.2.3" xref="S2.SS2.p2.8.m3.13.13.1.3.3.1.cmml">,</mo><mi class="ltx_mathvariant_bold" id="S2.SS2.p2.8.m3.6.6" mathvariant="bold" xref="S2.SS2.p2.8.m3.6.6.cmml">∅</mi><mo id="S2.SS2.p2.8.m3.13.13.1.3.3.2.4" stretchy="false" xref="S2.SS2.p2.8.m3.13.13.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.8.m3.13.13.1.2" xref="S2.SS2.p2.8.m3.13.13.1.2.cmml">+</mo><mrow id="S2.SS2.p2.8.m3.13.13.1.1" xref="S2.SS2.p2.8.m3.13.13.1.1.cmml"><mi id="S2.SS2.p2.8.m3.13.13.1.1.3" xref="S2.SS2.p2.8.m3.13.13.1.1.3.cmml">w</mi><mo id="S2.SS2.p2.8.m3.13.13.1.1.2" xref="S2.SS2.p2.8.m3.13.13.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.8.m3.13.13.1.1.1.1" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.cmml"><mrow id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.cmml"><msub id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.cmml"><mi id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.2" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.2.cmml">μ</mi><mi id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.3" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.3.cmml">𝜽</mi></msub><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.1" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.2" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.1.cmml"><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S2.SS2.p2.8.m3.7.7" xref="S2.SS2.p2.8.m3.7.7.cmml">𝒙</mi><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.2.2" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.SS2.p2.8.m3.8.8" xref="S2.SS2.p2.8.m3.8.8.cmml">σ</mi><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.2.3" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.SS2.p2.8.m3.9.9" xref="S2.SS2.p2.8.m3.9.9.cmml">𝒆</mi><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.2.4" stretchy="false" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.1" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.cmml"><msub id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.cmml"><mi id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.2" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.2.cmml">μ</mi><mi id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.3" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.3.cmml">𝜽</mi></msub><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.1" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.2" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.1.cmml"><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S2.SS2.p2.8.m3.10.10" xref="S2.SS2.p2.8.m3.10.10.cmml">𝒙</mi><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.2.2" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S2.SS2.p2.8.m3.11.11" xref="S2.SS2.p2.8.m3.11.11.cmml">σ</mi><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.2.3" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.1.cmml">,</mo><mi class="ltx_mathvariant_bold" id="S2.SS2.p2.8.m3.12.12" mathvariant="bold" xref="S2.SS2.p2.8.m3.12.12.cmml">∅</mi><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.2.4" stretchy="false" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS2.p2.8.m3.13.13.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m3.13b"><apply id="S2.SS2.p2.8.m3.13.13.cmml" xref="S2.SS2.p2.8.m3.13.13"><eq id="S2.SS2.p2.8.m3.13.13.2.cmml" xref="S2.SS2.p2.8.m3.13.13.2"></eq><apply id="S2.SS2.p2.8.m3.13.13.3.cmml" xref="S2.SS2.p2.8.m3.13.13.3"><times id="S2.SS2.p2.8.m3.13.13.3.1.cmml" xref="S2.SS2.p2.8.m3.13.13.3.1"></times><apply id="S2.SS2.p2.8.m3.13.13.3.2.cmml" xref="S2.SS2.p2.8.m3.13.13.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m3.13.13.3.2.1.cmml" xref="S2.SS2.p2.8.m3.13.13.3.2">subscript</csymbol><apply id="S2.SS2.p2.8.m3.13.13.3.2.2.cmml" xref="S2.SS2.p2.8.m3.13.13.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m3.13.13.3.2.2.1.cmml" xref="S2.SS2.p2.8.m3.13.13.3.2">superscript</csymbol><apply id="S2.SS2.p2.8.m3.13.13.3.2.2.2.cmml" xref="S2.SS2.p2.8.m3.13.13.3.2.2.2"><ci id="S2.SS2.p2.8.m3.13.13.3.2.2.2.1.cmml" xref="S2.SS2.p2.8.m3.13.13.3.2.2.2.1">~</ci><ci id="S2.SS2.p2.8.m3.13.13.3.2.2.2.2.cmml" xref="S2.SS2.p2.8.m3.13.13.3.2.2.2.2">𝜇</ci></apply><ci id="S2.SS2.p2.8.m3.13.13.3.2.2.3.cmml" xref="S2.SS2.p2.8.m3.13.13.3.2.2.3">𝑤</ci></apply><ci id="S2.SS2.p2.8.m3.13.13.3.2.3.cmml" xref="S2.SS2.p2.8.m3.13.13.3.2.3">𝜽</ci></apply><vector id="S2.SS2.p2.8.m3.13.13.3.3.1.cmml" xref="S2.SS2.p2.8.m3.13.13.3.3.2"><ci id="S2.SS2.p2.8.m3.1.1.cmml" xref="S2.SS2.p2.8.m3.1.1">𝒙</ci><ci id="S2.SS2.p2.8.m3.2.2.cmml" xref="S2.SS2.p2.8.m3.2.2">𝜎</ci><ci id="S2.SS2.p2.8.m3.3.3.cmml" xref="S2.SS2.p2.8.m3.3.3">𝒆</ci></vector></apply><apply id="S2.SS2.p2.8.m3.13.13.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1"><plus id="S2.SS2.p2.8.m3.13.13.1.2.cmml" xref="S2.SS2.p2.8.m3.13.13.1.2"></plus><apply id="S2.SS2.p2.8.m3.13.13.1.3.cmml" xref="S2.SS2.p2.8.m3.13.13.1.3"><times id="S2.SS2.p2.8.m3.13.13.1.3.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.3.1"></times><apply id="S2.SS2.p2.8.m3.13.13.1.3.2.cmml" xref="S2.SS2.p2.8.m3.13.13.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m3.13.13.1.3.2.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.3.2">subscript</csymbol><ci id="S2.SS2.p2.8.m3.13.13.1.3.2.2.cmml" xref="S2.SS2.p2.8.m3.13.13.1.3.2.2">𝜇</ci><ci id="S2.SS2.p2.8.m3.13.13.1.3.2.3.cmml" xref="S2.SS2.p2.8.m3.13.13.1.3.2.3">𝜽</ci></apply><vector id="S2.SS2.p2.8.m3.13.13.1.3.3.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.3.3.2"><ci id="S2.SS2.p2.8.m3.4.4.cmml" xref="S2.SS2.p2.8.m3.4.4">𝒙</ci><ci id="S2.SS2.p2.8.m3.5.5.cmml" xref="S2.SS2.p2.8.m3.5.5">𝜎</ci><emptyset id="S2.SS2.p2.8.m3.6.6.cmml" xref="S2.SS2.p2.8.m3.6.6"></emptyset></vector></apply><apply id="S2.SS2.p2.8.m3.13.13.1.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1"><times id="S2.SS2.p2.8.m3.13.13.1.1.2.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.2"></times><ci id="S2.SS2.p2.8.m3.13.13.1.1.3.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.3">𝑤</ci><apply id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1"><minus id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.1"></minus><apply id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2"><times id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.1"></times><apply id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.2">𝜇</ci><ci id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.3.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.2.3">𝜽</ci></apply><vector id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.2.3.2"><ci id="S2.SS2.p2.8.m3.7.7.cmml" xref="S2.SS2.p2.8.m3.7.7">𝒙</ci><ci id="S2.SS2.p2.8.m3.8.8.cmml" xref="S2.SS2.p2.8.m3.8.8">𝜎</ci><ci id="S2.SS2.p2.8.m3.9.9.cmml" xref="S2.SS2.p2.8.m3.9.9">𝒆</ci></vector></apply><apply id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3"><times id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.1"></times><apply id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.2.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.2">𝜇</ci><ci id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.3.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.2.3">𝜽</ci></apply><vector id="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p2.8.m3.13.13.1.1.1.1.1.3.3.2"><ci id="S2.SS2.p2.8.m3.10.10.cmml" xref="S2.SS2.p2.8.m3.10.10">𝒙</ci><ci id="S2.SS2.p2.8.m3.11.11.cmml" xref="S2.SS2.p2.8.m3.11.11">𝜎</ci><emptyset id="S2.SS2.p2.8.m3.12.12.cmml" xref="S2.SS2.p2.8.m3.12.12"></emptyset></vector></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m3.13c">\tilde{\mu}^{w}_{\bm{\theta}}(\bm{x},\sigma,\bm{e})=\mu_{\bm{\theta}}(\bm{x},%
\sigma,\bm{\emptyset})+w(\mu_{\bm{\theta}}(\bm{x},\sigma,\bm{e})-\mu_{\bm{%
\theta}}(\bm{x},\sigma,\bm{\emptyset}))</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.8.m3.13d">over~ start_ARG italic_μ end_ARG start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x , italic_σ , bold_italic_e ) = italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x , italic_σ , bold_∅ ) + italic_w ( italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x , italic_σ , bold_italic_e ) - italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x , italic_σ , bold_∅ ) )</annotation></semantics></math>, where <math alttext="w" class="ltx_Math" display="inline" id="S2.SS2.p2.9.m4.1"><semantics id="S2.SS2.p2.9.m4.1a"><mi id="S2.SS2.p2.9.m4.1.1" xref="S2.SS2.p2.9.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m4.1b"><ci id="S2.SS2.p2.9.m4.1.1.cmml" xref="S2.SS2.p2.9.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m4.1c">w</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.9.m4.1d">italic_w</annotation></semantics></math> is the guidance weight and <math alttext="\bm{\emptyset}" class="ltx_Math" display="inline" id="S2.SS2.p2.10.m5.1"><semantics id="S2.SS2.p2.10.m5.1a"><mi class="ltx_mathvariant_bold" id="S2.SS2.p2.10.m5.1.1" mathvariant="bold" xref="S2.SS2.p2.10.m5.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m5.1b"><emptyset id="S2.SS2.p2.10.m5.1.1.cmml" xref="S2.SS2.p2.10.m5.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m5.1c">\bm{\emptyset}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.10.m5.1d">bold_∅</annotation></semantics></math> is a “null” conditioning.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Diffusion Distillation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Step distillation is the process of reducing diffusion sampling steps by distilling a base model into a few-step generator. Such methods can be organized into two broad categories.
Online consistency approaches such as consistency models <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib57" title="">2023</a>)</cite>, consistency trajectory models <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib27" title="">2023</a>)</cite>, and variants <cite class="ltx_cite ltx_citemacro_citep">(Ren et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib44" title="">2024</a>; Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib59" title="">2024a</a>)</cite> distill directly by enforcing consistency across the diffusion trajectory and optionally include an adversarial loss <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib27" title="">2023</a>)</cite>.
While such approaches have strong 1-step generation for images, attempts for audio have been less successful and only capable of generating short segment (i.e. <math alttext="&lt;10" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><mrow id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml"></mi><mo id="S2.SS3.p1.1.m1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.cmml">&lt;</mo><mn id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><lt id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1"></lt><csymbol cd="latexml" id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">absent</csymbol><cn id="S2.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS3.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">&lt;10</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">&lt; 10</annotation></semantics></math> seconds), applied to lower-quality base models limiting upper-bound performance, needing up to 16 sampling steps to match baseline quality (still slow),
and/or did not successfully leverage adversarial losses which have been found to increase realism for other domains <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib3" title="">2024</a>; Saito et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib47" title="">2024</a>; Novack et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib41" title="">2024a</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">In contrast, offline adversarial distillation methods include Diffusion2GAN <cite class="ltx_cite ltx_citemacro_citep">(Kang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib22" title="">2024</a>)</cite>, LADD <cite class="ltx_cite ltx_citemacro_citep">(Sauer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib50" title="">2024</a>)</cite>, and DMD <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib63" title="">2023</a>)</cite>.
Such methods work by generating large amounts of offline noise–sample pairs from the base model, and finetuning the model into a conditional GAN for few-step synthesis.
These methods can surpass their adversarial-free counterparts, yet require expensive offline data generation and massive compute infrastructure to be efficient.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.4">Alternatively, improved DMD (DMD2) <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib64" title="">2024</a>)</cite> introduces an online adversarial diffusion distillation method for images.
DMD2 (1) removes the need for expensive offline data generation (2) adds a GAN loss and (3) outperforms consistency-based methods and improves overall quality.
DMD2 primarily works by distilling a one- or few-step generator <math alttext="G_{\bm{\phi}}" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.1"><semantics id="S2.SS3.p3.1.m1.1a"><msub id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml"><mi id="S2.SS3.p3.1.m1.1.1.2" xref="S2.SS3.p3.1.m1.1.1.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="S2.SS3.p3.1.m1.1.1.3" mathvariant="bold-italic" xref="S2.SS3.p3.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><apply id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p3.1.m1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2">𝐺</ci><ci id="S2.SS3.p3.1.m1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">G_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.1d">italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> from a base diffusion model <math alttext="\mu_{\text{real}}" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.1"><semantics id="S2.SS3.p3.2.m2.1a"><msub id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml"><mi id="S2.SS3.p3.2.m2.1.1.2" xref="S2.SS3.p3.2.m2.1.1.2.cmml">μ</mi><mtext id="S2.SS3.p3.2.m2.1.1.3" xref="S2.SS3.p3.2.m2.1.1.3a.cmml">real</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p3.2.m2.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1.2">𝜇</ci><ci id="S2.SS3.p3.2.m2.1.1.3a.cmml" xref="S2.SS3.p3.2.m2.1.1.3"><mtext id="S2.SS3.p3.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p3.2.m2.1.1.3">real</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">\mu_{\text{real}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.1d">italic_μ start_POSTSUBSCRIPT real end_POSTSUBSCRIPT</annotation></semantics></math>, while simultaneously learning a score model of the generator’s distribution online <math alttext="\mu_{\text{fake}}" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m3.1"><semantics id="S2.SS3.p3.3.m3.1a"><msub id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml"><mi id="S2.SS3.p3.3.m3.1.1.2" xref="S2.SS3.p3.3.m3.1.1.2.cmml">μ</mi><mtext id="S2.SS3.p3.3.m3.1.1.3" xref="S2.SS3.p3.3.m3.1.1.3a.cmml">fake</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><apply id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.1.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p3.3.m3.1.1.2.cmml" xref="S2.SS3.p3.3.m3.1.1.2">𝜇</ci><ci id="S2.SS3.p3.3.m3.1.1.3a.cmml" xref="S2.SS3.p3.3.m3.1.1.3"><mtext id="S2.SS3.p3.3.m3.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p3.3.m3.1.1.3">fake</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">\mu_{\text{fake}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.1d">italic_μ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT</annotation></semantics></math> in order to approximate a target KL objective (with <math alttext="\mu_{\text{real}}" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m4.1"><semantics id="S2.SS3.p3.4.m4.1a"><msub id="S2.SS3.p3.4.m4.1.1" xref="S2.SS3.p3.4.m4.1.1.cmml"><mi id="S2.SS3.p3.4.m4.1.1.2" xref="S2.SS3.p3.4.m4.1.1.2.cmml">μ</mi><mtext id="S2.SS3.p3.4.m4.1.1.3" xref="S2.SS3.p3.4.m4.1.1.3a.cmml">real</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><apply id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m4.1.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.p3.4.m4.1.1.2.cmml" xref="S2.SS3.p3.4.m4.1.1.2">𝜇</ci><ci id="S2.SS3.p3.4.m4.1.1.3a.cmml" xref="S2.SS3.p3.4.m4.1.1.3"><mtext id="S2.SS3.p3.4.m4.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p3.4.m4.1.1.3">real</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">\mu_{\text{real}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m4.1d">italic_μ start_POSTSUBSCRIPT real end_POSTSUBSCRIPT</annotation></semantics></math>) used to train the generator.
To our knowledge, there are no adversarial diffusion distillation methods for TTM or TTA.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p4">
<p class="ltx_p" id="S2.SS3.p4.1">Beyond step distillation, layer distillation, or the process of dropping interior layers to reduce the cost per sampling step, has been recently studied <cite class="ltx_cite ltx_citemacro_citep">(Moon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib38" title="">2024</a>; Wimbauer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib61" title="">2024</a>)</cite>. Layer distillation draws inspiration from transformer early exiting and layer caching <cite class="ltx_cite ltx_citemacro_citep">(Hou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib19" title="">2020</a>; Schuster et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib52" title="">2021</a>)</cite> and has found success for image diffusion, but has not been compared or combined with step distillation methods and has not been developed for TTA/TTM. In our work, we seek to understand how step and layer distillation interact for accelerating music generation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.1.1">Presto!</span>
</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We propose a dual-faceted distillation approach for inference acceleration of continuous-time diffusion models.
Continuous-time models have been shown to outperform discrete-time DDPM models <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib55" title="">2020</a>; Karras et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib23" title="">2022</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib25" title="">2024</a>)</cite>, but past DMD/DMD2 work focuses on the latter.
Thus, we redefine DMD2 (a step distillation method) in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS1" title="3.1 EDM-Style Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">3.1</span></a> for continuous-time score models, then present
an improved formulation and study its design space in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS2" title="3.2 Presto-S: Score-based Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">3.2</span></a>.
Second, we design a simple, but powerful improvement to the SOTA layer distillation method to understand the impact of reducing inference cost per step in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS3" title="3.3 Presto-L: Variance and Budget-Aware Layer Dropping ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">3.3</span></a>.
Finally, we investigate how to combine step and layer distillation methods together in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS4" title="3.4 Presto-LS: Layer-Step Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">3.4</span></a>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>EDM-Style Distribution Matching Distillation</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.9">We first redefine DMD2 in the language of continuous-time, score-based diffusion models (i.e. EDM-style).
Our goal is to
distill
our score model <math alttext="\mu_{\bm{\theta}}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">μ</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝜇</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mu_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_μ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> (which we equivalently denote as <math alttext="\mu_{\text{real}}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">μ</mi><mtext id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3a.cmml">real</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝜇</ci><ci id="S3.SS1.p1.2.m2.1.1.3a.cmml" xref="S3.SS1.p1.2.m2.1.1.3"><mtext id="S3.SS1.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.2.m2.1.1.3">real</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mu_{\text{real}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_μ start_POSTSUBSCRIPT real end_POSTSUBSCRIPT</annotation></semantics></math>, as it is trained to model the score of real data) into an accelerated
generator <math alttext="G_{\bm{\phi}}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="S3.SS1.p1.3.m3.1.1.3" mathvariant="bold-italic" xref="S3.SS1.p1.3.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝐺</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">G_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>
that can sample in 1-4 steps.
Formally, we wish to minimize the KL Divergence between the real distribution <math alttext="p_{\text{real}}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">p</mi><mtext id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3a.cmml">real</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑝</ci><ci id="S3.SS1.p1.4.m4.1.1.3a.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><mtext id="S3.SS1.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.4.m4.1.1.3">real</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">p_{\text{real}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_p start_POSTSUBSCRIPT real end_POSTSUBSCRIPT</annotation></semantics></math> and the generator <math alttext="G_{\bm{\phi}}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="S3.SS1.p1.5.m5.1.1.3" mathvariant="bold-italic" xref="S3.SS1.p1.5.m5.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐺</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">G_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>’s distribution <math alttext="p_{\text{fake}}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">p</mi><mtext id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3a.cmml">fake</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑝</ci><ci id="S3.SS1.p1.6.m6.1.1.3a.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><mtext id="S3.SS1.p1.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.6.m6.1.1.3">fake</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">p_{\text{fake}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_p start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT</annotation></semantics></math>: <math alttext="\mathcal{L}_{\text{DMD}}=D(p_{\text{real}}\|p_{\text{fake}})" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><msub id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">ℒ</mi><mtext id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3a.cmml">DMD</mtext></msub><mo id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.1.3" xref="S3.SS1.p1.7.m7.1.1.1.3.cmml">D</mi><mo id="S3.SS1.p1.7.m7.1.1.1.2" xref="S3.SS1.p1.7.m7.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.7.m7.1.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.7.m7.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.7.m7.1.1.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.2.cmml">p</mi><mtext id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.3a.cmml">real</mtext></msub><mo id="S3.SS1.p1.7.m7.1.1.1.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S3.SS1.p1.7.m7.1.1.1.1.1.1.3" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.2.cmml">p</mi><mtext id="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.3a.cmml">fake</mtext></msub></mrow><mo id="S3.SS1.p1.7.m7.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><eq id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2"></eq><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">ℒ</ci><ci id="S3.SS1.p1.7.m7.1.1.3.3a.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3"><mtext id="S3.SS1.p1.7.m7.1.1.3.3.cmml" mathsize="70%" xref="S3.SS1.p1.7.m7.1.1.3.3">DMD</mtext></ci></apply><apply id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"><times id="S3.SS1.p1.7.m7.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.1.2"></times><ci id="S3.SS1.p1.7.m7.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.1.3">𝐷</ci><apply id="S3.SS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.3a.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.3"><mtext id="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.2.3">real</mtext></ci></apply><apply id="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.3a.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.3"><mtext id="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.SS1.p1.7.m7.1.1.1.1.1.1.3.3">fake</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathcal{L}_{\text{DMD}}=D(p_{\text{real}}\|p_{\text{fake}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">caligraphic_L start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT = italic_D ( italic_p start_POSTSUBSCRIPT real end_POSTSUBSCRIPT ∥ italic_p start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT )</annotation></semantics></math>.
The KL term cannot be calculated explicitly, but we can calculate its <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.9.1">gradient</em> with respect to the generator if we can access the score of the generator’s distribution.
Thus, we also train a “fake” score model <math alttext="\mu_{\bm{\psi}}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">μ</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">𝝍</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝜇</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝝍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mu_{\bm{\psi}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_μ start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> (or equivalently, <math alttext="\mu_{\text{fake}}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><msub id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">μ</mi><mtext id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3a.cmml">fake</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝜇</ci><ci id="S3.SS1.p1.9.m9.1.1.3a.cmml" xref="S3.SS1.p1.9.m9.1.1.3"><mtext id="S3.SS1.p1.9.m9.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.9.m9.1.1.3">fake</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mu_{\text{fake}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_μ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT</annotation></semantics></math>) to approximate the generator distribution’s <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.9.2">score function</em> at each gradient step during training.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.5">First, given some real data <math alttext="\bm{x}_{\text{real}}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">𝒙</mi><mtext id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3a.cmml">real</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝒙</ci><ci id="S3.SS1.p2.1.m1.1.1.3a.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><mtext id="S3.SS1.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.1.m1.1.1.3">real</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\bm{x}_{\text{real}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT</annotation></semantics></math>, we sample a noise level from a set of predefined levels <math alttext="\sigma\sim\{\sigma_{i}\}_{\text{gen}}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">σ</mi><mo id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">∼</mo><msub id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml"><mrow id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.2.cmml"><mo id="S3.SS1.p2.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.2.m2.1.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.2.cmml">σ</mi><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mtext id="S3.SS1.p2.2.m2.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.3a.cmml">gen</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="latexml" id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">similar-to</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝜎</ci><apply id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1">subscript</csymbol><set id="S3.SS1.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1"><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.2">𝜎</ci><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="S3.SS1.p2.2.m2.1.1.1.3a.cmml" xref="S3.SS1.p2.2.m2.1.1.1.3"><mtext id="S3.SS1.p2.2.m2.1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.2.m2.1.1.1.3">gen</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\sigma\sim\{\sigma_{i}\}_{\text{gen}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_σ ∼ { italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT</annotation></semantics></math>,
and then pass the corrupted real data through the generator to get the generated output <math alttext="\hat{\bm{x}}_{\text{gen}}=G_{\bm{\phi}}(\bm{x}_{\text{real}}+\sigma\epsilon,\sigma)" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.2"><semantics id="S3.SS1.p2.3.m3.2a"><mrow id="S3.SS1.p2.3.m3.2.2" xref="S3.SS1.p2.3.m3.2.2.cmml"><msub id="S3.SS1.p2.3.m3.2.2.3" xref="S3.SS1.p2.3.m3.2.2.3.cmml"><mover accent="true" id="S3.SS1.p2.3.m3.2.2.3.2" xref="S3.SS1.p2.3.m3.2.2.3.2.cmml"><mi id="S3.SS1.p2.3.m3.2.2.3.2.2" xref="S3.SS1.p2.3.m3.2.2.3.2.2.cmml">𝒙</mi><mo id="S3.SS1.p2.3.m3.2.2.3.2.1" xref="S3.SS1.p2.3.m3.2.2.3.2.1.cmml">^</mo></mover><mtext id="S3.SS1.p2.3.m3.2.2.3.3" xref="S3.SS1.p2.3.m3.2.2.3.3a.cmml">gen</mtext></msub><mo id="S3.SS1.p2.3.m3.2.2.2" xref="S3.SS1.p2.3.m3.2.2.2.cmml">=</mo><mrow id="S3.SS1.p2.3.m3.2.2.1" xref="S3.SS1.p2.3.m3.2.2.1.cmml"><msub id="S3.SS1.p2.3.m3.2.2.1.3" xref="S3.SS1.p2.3.m3.2.2.1.3.cmml"><mi id="S3.SS1.p2.3.m3.2.2.1.3.2" xref="S3.SS1.p2.3.m3.2.2.1.3.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="S3.SS1.p2.3.m3.2.2.1.3.3" mathvariant="bold-italic" xref="S3.SS1.p2.3.m3.2.2.1.3.3.cmml">ϕ</mi></msub><mo id="S3.SS1.p2.3.m3.2.2.1.2" xref="S3.SS1.p2.3.m3.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.3.m3.2.2.1.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.2.cmml"><mo id="S3.SS1.p2.3.m3.2.2.1.1.1.2" stretchy="false" xref="S3.SS1.p2.3.m3.2.2.1.1.2.cmml">(</mo><mrow id="S3.SS1.p2.3.m3.2.2.1.1.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml"><msub id="S3.SS1.p2.3.m3.2.2.1.1.1.1.2" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.2" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.2.cmml">𝒙</mi><mtext id="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.3" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.3a.cmml">real</mtext></msub><mo id="S3.SS1.p2.3.m3.2.2.1.1.1.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS1.p2.3.m3.2.2.1.1.1.1.3" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.2" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.2.cmml">σ</mi><mo id="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.1" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.3" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S3.SS1.p2.3.m3.2.2.1.1.1.3" xref="S3.SS1.p2.3.m3.2.2.1.1.2.cmml">,</mo><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">σ</mi><mo id="S3.SS1.p2.3.m3.2.2.1.1.1.4" stretchy="false" xref="S3.SS1.p2.3.m3.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.2b"><apply id="S3.SS1.p2.3.m3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2"><eq id="S3.SS1.p2.3.m3.2.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2.2"></eq><apply id="S3.SS1.p2.3.m3.2.2.3.cmml" xref="S3.SS1.p2.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.3.1.cmml" xref="S3.SS1.p2.3.m3.2.2.3">subscript</csymbol><apply id="S3.SS1.p2.3.m3.2.2.3.2.cmml" xref="S3.SS1.p2.3.m3.2.2.3.2"><ci id="S3.SS1.p2.3.m3.2.2.3.2.1.cmml" xref="S3.SS1.p2.3.m3.2.2.3.2.1">^</ci><ci id="S3.SS1.p2.3.m3.2.2.3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2.3.2.2">𝒙</ci></apply><ci id="S3.SS1.p2.3.m3.2.2.3.3a.cmml" xref="S3.SS1.p2.3.m3.2.2.3.3"><mtext id="S3.SS1.p2.3.m3.2.2.3.3.cmml" mathsize="70%" xref="S3.SS1.p2.3.m3.2.2.3.3">gen</mtext></ci></apply><apply id="S3.SS1.p2.3.m3.2.2.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1"><times id="S3.SS1.p2.3.m3.2.2.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.2"></times><apply id="S3.SS1.p2.3.m3.2.2.1.3.cmml" xref="S3.SS1.p2.3.m3.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.1.3.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.1.3.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.3.2">𝐺</ci><ci id="S3.SS1.p2.3.m3.2.2.1.3.3.cmml" xref="S3.SS1.p2.3.m3.2.2.1.3.3">bold-italic-ϕ</ci></apply><interval closure="open" id="S3.SS1.p2.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1"><apply id="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1"><plus id="S3.SS1.p2.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.1"></plus><apply id="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.2">𝒙</ci><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.3a.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.3"><mtext id="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.2.3">real</mtext></ci></apply><apply id="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.3"><times id="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.1"></times><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.2">𝜎</ci><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.1.3.3">italic-ϵ</ci></apply></apply><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝜎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.2c">\hat{\bm{x}}_{\text{gen}}=G_{\bm{\phi}}(\bm{x}_{\text{real}}+\sigma\epsilon,\sigma)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.2d">over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT = italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT + italic_σ italic_ϵ , italic_σ )</annotation></semantics></math>, where <math alttext="\epsilon\sim\mathcal{N}(0,\bm{I})" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.2"><semantics id="S3.SS1.p2.4.m4.2a"><mrow id="S3.SS1.p2.4.m4.2.3" xref="S3.SS1.p2.4.m4.2.3.cmml"><mi id="S3.SS1.p2.4.m4.2.3.2" xref="S3.SS1.p2.4.m4.2.3.2.cmml">ϵ</mi><mo id="S3.SS1.p2.4.m4.2.3.1" xref="S3.SS1.p2.4.m4.2.3.1.cmml">∼</mo><mrow id="S3.SS1.p2.4.m4.2.3.3" xref="S3.SS1.p2.4.m4.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.2.3.3.2" xref="S3.SS1.p2.4.m4.2.3.3.2.cmml">𝒩</mi><mo id="S3.SS1.p2.4.m4.2.3.3.1" xref="S3.SS1.p2.4.m4.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.p2.4.m4.2.3.3.3.2" xref="S3.SS1.p2.4.m4.2.3.3.3.1.cmml"><mo id="S3.SS1.p2.4.m4.2.3.3.3.2.1" stretchy="false" xref="S3.SS1.p2.4.m4.2.3.3.3.1.cmml">(</mo><mn id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">0</mn><mo id="S3.SS1.p2.4.m4.2.3.3.3.2.2" xref="S3.SS1.p2.4.m4.2.3.3.3.1.cmml">,</mo><mi id="S3.SS1.p2.4.m4.2.2" xref="S3.SS1.p2.4.m4.2.2.cmml">𝑰</mi><mo id="S3.SS1.p2.4.m4.2.3.3.3.2.3" stretchy="false" xref="S3.SS1.p2.4.m4.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.2b"><apply id="S3.SS1.p2.4.m4.2.3.cmml" xref="S3.SS1.p2.4.m4.2.3"><csymbol cd="latexml" id="S3.SS1.p2.4.m4.2.3.1.cmml" xref="S3.SS1.p2.4.m4.2.3.1">similar-to</csymbol><ci id="S3.SS1.p2.4.m4.2.3.2.cmml" xref="S3.SS1.p2.4.m4.2.3.2">italic-ϵ</ci><apply id="S3.SS1.p2.4.m4.2.3.3.cmml" xref="S3.SS1.p2.4.m4.2.3.3"><times id="S3.SS1.p2.4.m4.2.3.3.1.cmml" xref="S3.SS1.p2.4.m4.2.3.3.1"></times><ci id="S3.SS1.p2.4.m4.2.3.3.2.cmml" xref="S3.SS1.p2.4.m4.2.3.3.2">𝒩</ci><interval closure="open" id="S3.SS1.p2.4.m4.2.3.3.3.1.cmml" xref="S3.SS1.p2.4.m4.2.3.3.3.2"><cn id="S3.SS1.p2.4.m4.1.1.cmml" type="integer" xref="S3.SS1.p2.4.m4.1.1">0</cn><ci id="S3.SS1.p2.4.m4.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.2c">\epsilon\sim\mathcal{N}(0,\bm{I})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.2d">italic_ϵ ∼ caligraphic_N ( 0 , bold_italic_I )</annotation></semantics></math> (we omit the conditioning <math alttext="\bm{e}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">bold_italic_e</annotation></semantics></math> for brevity).
The gradient of the KL divergence between the real and the generator’s distribution can then be calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\bm{\phi}}\mathcal{L}_{\text{DMD}}=\mathbb{E}_{\begin{subarray}{c}%
\sigma\sim\{\sigma_{i}\},\epsilon\sim\mathcal{N}(0,\bm{I})\end{subarray}}\left%
[\left((\mu_{\text{fake}}(\hat{\bm{x}}_{\text{gen}}+\sigma\epsilon,\sigma)-%
\tilde{\mu}_{\text{real}}^{w}(\hat{\bm{x}}_{\text{gen}}+\sigma\epsilon,\sigma)%
\right)\nabla_{\bm{\phi}}\hat{\bm{x}}_{\text{gen}}\right]," class="ltx_math_unparsed" display="block" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3b"><msub id="S3.E5.m1.3.4"><mo id="S3.E5.m1.3.4.2">∇</mo><mi class="ltx_mathvariant_bold-italic" id="S3.E5.m1.3.4.3" mathvariant="bold-italic">ϕ</mi></msub><msub id="S3.E5.m1.3.5"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.5.2">ℒ</mi><mtext id="S3.E5.m1.3.5.3">DMD</mtext></msub><mo id="S3.E5.m1.3.6">=</mo><msub id="S3.E5.m1.3.7"><mi id="S3.E5.m1.3.7.2">𝔼</mi><mtable id="S3.E5.m1.1.1.1.1.1.1"><mtr id="S3.E5.m1.1.1.1.1.1.1a"><mtd id="S3.E5.m1.1.1.1.1.1.1b"><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4"><mrow id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1"><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.3">σ</mi><mo id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.2">∼</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.1"><mo id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.1.2" stretchy="false">{</mo><msub id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.1.1"><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.1.1.2">σ</mi><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.1.1.3">i</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.3.3.3.3.3.1.1.1.3" stretchy="false">}</mo></mrow></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.3">,</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2"><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.2">ϵ</mi><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.1">∼</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.3"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.3.2">𝒩</mi><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.3.1">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.3.3.2"><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.3.3.2.1" stretchy="false">(</mo><mn id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1">0</mn><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.3.3.2.2">,</mo><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.2.2.2">𝑰</mi><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.4.4.4.2.3.3.2.3" stretchy="false">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable></msub><mrow id="S3.E5.m1.3.8"><mo id="S3.E5.m1.3.8.1">[</mo><mrow id="S3.E5.m1.3.8.2"><mo id="S3.E5.m1.3.8.2.1">(</mo><mrow id="S3.E5.m1.3.8.2.2"><mo id="S3.E5.m1.3.8.2.2.1" stretchy="false">(</mo><msub id="S3.E5.m1.3.8.2.2.2"><mi id="S3.E5.m1.3.8.2.2.2.2">μ</mi><mtext id="S3.E5.m1.3.8.2.2.2.3">fake</mtext></msub><mrow id="S3.E5.m1.3.8.2.2.3"><mo id="S3.E5.m1.3.8.2.2.3.1" stretchy="false">(</mo><msub id="S3.E5.m1.3.8.2.2.3.2"><mover accent="true" id="S3.E5.m1.3.8.2.2.3.2.2"><mi id="S3.E5.m1.3.8.2.2.3.2.2.2">𝒙</mi><mo id="S3.E5.m1.3.8.2.2.3.2.2.1">^</mo></mover><mtext id="S3.E5.m1.3.8.2.2.3.2.3">gen</mtext></msub><mo id="S3.E5.m1.3.8.2.2.3.3">+</mo><mi id="S3.E5.m1.3.8.2.2.3.4">σ</mi><mi id="S3.E5.m1.3.8.2.2.3.5">ϵ</mi><mo id="S3.E5.m1.3.8.2.2.3.6">,</mo><mi id="S3.E5.m1.2.2">σ</mi><mo id="S3.E5.m1.3.8.2.2.3.7" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.3.8.2.2.4">−</mo><msubsup id="S3.E5.m1.3.8.2.2.5"><mover accent="true" id="S3.E5.m1.3.8.2.2.5.2.2"><mi id="S3.E5.m1.3.8.2.2.5.2.2.2">μ</mi><mo id="S3.E5.m1.3.8.2.2.5.2.2.1">~</mo></mover><mtext id="S3.E5.m1.3.8.2.2.5.2.3">real</mtext><mi id="S3.E5.m1.3.8.2.2.5.3">w</mi></msubsup><mrow id="S3.E5.m1.3.8.2.2.6"><mo id="S3.E5.m1.3.8.2.2.6.1" stretchy="false">(</mo><msub id="S3.E5.m1.3.8.2.2.6.2"><mover accent="true" id="S3.E5.m1.3.8.2.2.6.2.2"><mi id="S3.E5.m1.3.8.2.2.6.2.2.2">𝒙</mi><mo id="S3.E5.m1.3.8.2.2.6.2.2.1">^</mo></mover><mtext id="S3.E5.m1.3.8.2.2.6.2.3">gen</mtext></msub><mo id="S3.E5.m1.3.8.2.2.6.3">+</mo><mi id="S3.E5.m1.3.8.2.2.6.4">σ</mi><mi id="S3.E5.m1.3.8.2.2.6.5">ϵ</mi><mo id="S3.E5.m1.3.8.2.2.6.6">,</mo><mi id="S3.E5.m1.3.3">σ</mi><mo id="S3.E5.m1.3.8.2.2.6.7" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.3.8.2.2.7" rspace="0.167em">)</mo></mrow><msub id="S3.E5.m1.3.8.2.3"><mo id="S3.E5.m1.3.8.2.3.2" rspace="0.167em">∇</mo><mi class="ltx_mathvariant_bold-italic" id="S3.E5.m1.3.8.2.3.3" mathvariant="bold-italic">ϕ</mi></msub><msub id="S3.E5.m1.3.8.2.4"><mover accent="true" id="S3.E5.m1.3.8.2.4.2"><mi id="S3.E5.m1.3.8.2.4.2.2">𝒙</mi><mo id="S3.E5.m1.3.8.2.4.2.1">^</mo></mover><mtext id="S3.E5.m1.3.8.2.4.3">gen</mtext></msub><mo id="S3.E5.m1.3.8.2.5">]</mo></mrow><mo id="S3.E5.m1.3.8.3">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\nabla_{\bm{\phi}}\mathcal{L}_{\text{DMD}}=\mathbb{E}_{\begin{subarray}{c}%
\sigma\sim\{\sigma_{i}\},\epsilon\sim\mathcal{N}(0,\bm{I})\end{subarray}}\left%
[\left((\mu_{\text{fake}}(\hat{\bm{x}}_{\text{gen}}+\sigma\epsilon,\sigma)-%
\tilde{\mu}_{\text{real}}^{w}(\hat{\bm{x}}_{\text{gen}}+\sigma\epsilon,\sigma)%
\right)\nabla_{\bm{\phi}}\hat{\bm{x}}_{\text{gen}}\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">∇ start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT start_ARG start_ROW start_CELL italic_σ ∼ { italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } , italic_ϵ ∼ caligraphic_N ( 0 , bold_italic_I ) end_CELL end_ROW end_ARG end_POSTSUBSCRIPT [ ( ( italic_μ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT + italic_σ italic_ϵ , italic_σ ) - over~ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT real end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT + italic_σ italic_ϵ , italic_σ ) ) ∇ start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.8">where <math alttext="\{\sigma_{i}\}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m1.1"><semantics id="S3.SS1.p2.6.m1.1a"><mrow id="S3.SS1.p2.6.m1.1.1.1" xref="S3.SS1.p2.6.m1.1.1.2.cmml"><mo id="S3.SS1.p2.6.m1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.6.m1.1.1.2.cmml">{</mo><msub id="S3.SS1.p2.6.m1.1.1.1.1" xref="S3.SS1.p2.6.m1.1.1.1.1.cmml"><mi id="S3.SS1.p2.6.m1.1.1.1.1.2" xref="S3.SS1.p2.6.m1.1.1.1.1.2.cmml">σ</mi><mi id="S3.SS1.p2.6.m1.1.1.1.1.3" xref="S3.SS1.p2.6.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p2.6.m1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.6.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m1.1b"><set id="S3.SS1.p2.6.m1.1.1.2.cmml" xref="S3.SS1.p2.6.m1.1.1.1"><apply id="S3.SS1.p2.6.m1.1.1.1.1.cmml" xref="S3.SS1.p2.6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.6.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m1.1.1.1.1.2.cmml" xref="S3.SS1.p2.6.m1.1.1.1.1.2">𝜎</ci><ci id="S3.SS1.p2.6.m1.1.1.1.1.3.cmml" xref="S3.SS1.p2.6.m1.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m1.1c">\{\sigma_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m1.1d">{ italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> are the predefined noise levels for all loss calculations, and <math alttext="\tilde{\mu}_{\text{real}}^{w}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m2.1"><semantics id="S3.SS1.p2.7.m2.1a"><msubsup id="S3.SS1.p2.7.m2.1.1" xref="S3.SS1.p2.7.m2.1.1.cmml"><mover accent="true" id="S3.SS1.p2.7.m2.1.1.2.2" xref="S3.SS1.p2.7.m2.1.1.2.2.cmml"><mi id="S3.SS1.p2.7.m2.1.1.2.2.2" xref="S3.SS1.p2.7.m2.1.1.2.2.2.cmml">μ</mi><mo id="S3.SS1.p2.7.m2.1.1.2.2.1" xref="S3.SS1.p2.7.m2.1.1.2.2.1.cmml">~</mo></mover><mtext id="S3.SS1.p2.7.m2.1.1.2.3" xref="S3.SS1.p2.7.m2.1.1.2.3a.cmml">real</mtext><mi id="S3.SS1.p2.7.m2.1.1.3" xref="S3.SS1.p2.7.m2.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m2.1b"><apply id="S3.SS1.p2.7.m2.1.1.cmml" xref="S3.SS1.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m2.1.1.1.cmml" xref="S3.SS1.p2.7.m2.1.1">superscript</csymbol><apply id="S3.SS1.p2.7.m2.1.1.2.cmml" xref="S3.SS1.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m2.1.1.2.1.cmml" xref="S3.SS1.p2.7.m2.1.1">subscript</csymbol><apply id="S3.SS1.p2.7.m2.1.1.2.2.cmml" xref="S3.SS1.p2.7.m2.1.1.2.2"><ci id="S3.SS1.p2.7.m2.1.1.2.2.1.cmml" xref="S3.SS1.p2.7.m2.1.1.2.2.1">~</ci><ci id="S3.SS1.p2.7.m2.1.1.2.2.2.cmml" xref="S3.SS1.p2.7.m2.1.1.2.2.2">𝜇</ci></apply><ci id="S3.SS1.p2.7.m2.1.1.2.3a.cmml" xref="S3.SS1.p2.7.m2.1.1.2.3"><mtext id="S3.SS1.p2.7.m2.1.1.2.3.cmml" mathsize="70%" xref="S3.SS1.p2.7.m2.1.1.2.3">real</mtext></ci></apply><ci id="S3.SS1.p2.7.m2.1.1.3.cmml" xref="S3.SS1.p2.7.m2.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m2.1c">\tilde{\mu}_{\text{real}}^{w}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m2.1d">over~ start_ARG italic_μ end_ARG start_POSTSUBSCRIPT real end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> is the <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.8.1">CFG-augmented</em> real score model. To ensure that <math alttext="\mu_{\text{fake}}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m3.1"><semantics id="S3.SS1.p2.8.m3.1a"><msub id="S3.SS1.p2.8.m3.1.1" xref="S3.SS1.p2.8.m3.1.1.cmml"><mi id="S3.SS1.p2.8.m3.1.1.2" xref="S3.SS1.p2.8.m3.1.1.2.cmml">μ</mi><mtext id="S3.SS1.p2.8.m3.1.1.3" xref="S3.SS1.p2.8.m3.1.1.3a.cmml">fake</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m3.1b"><apply id="S3.SS1.p2.8.m3.1.1.cmml" xref="S3.SS1.p2.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m3.1.1.1.cmml" xref="S3.SS1.p2.8.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m3.1.1.2.cmml" xref="S3.SS1.p2.8.m3.1.1.2">𝜇</ci><ci id="S3.SS1.p2.8.m3.1.1.3a.cmml" xref="S3.SS1.p2.8.m3.1.1.3"><mtext id="S3.SS1.p2.8.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.8.m3.1.1.3">fake</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m3.1c">\mu_{\text{fake}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m3.1d">italic_μ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT</annotation></semantics></math> accurately models the score of the generator’s distribution at each gradient update, we train the fake score model with the weighted-DSM loss (i.e. standard diffusion training), but on <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.8.2">the generator outputs</em>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\arg\min_{\bm{\psi}}\mathcal{L}_{\text{fake-DSM}}=\mathbb{E}_{\sigma\sim\{%
\sigma_{i}\},\epsilon\sim\mathcal{N}(0,\bm{I})}\left[\lambda(\sigma)\|\hat{\bm%
{x}}_{\text{gen}}-\mu_{\text{fake}}(\hat{\bm{x}}_{\text{gen}}+\sigma\epsilon,%
\sigma)\|_{2}^{2}\right]" class="ltx_Math" display="block" id="S3.E6.m1.7"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.7" xref="S3.E6.m1.7.7.cmml"><mrow id="S3.E6.m1.7.7.3" xref="S3.E6.m1.7.7.3.cmml"><mi id="S3.E6.m1.7.7.3.1" xref="S3.E6.m1.7.7.3.1.cmml">arg</mi><mo id="S3.E6.m1.7.7.3a" lspace="0.167em" xref="S3.E6.m1.7.7.3.cmml">⁡</mo><mrow id="S3.E6.m1.7.7.3.2" xref="S3.E6.m1.7.7.3.2.cmml"><munder id="S3.E6.m1.7.7.3.2.1" xref="S3.E6.m1.7.7.3.2.1.cmml"><mi id="S3.E6.m1.7.7.3.2.1.2" xref="S3.E6.m1.7.7.3.2.1.2.cmml">min</mi><mi id="S3.E6.m1.7.7.3.2.1.3" xref="S3.E6.m1.7.7.3.2.1.3.cmml">𝝍</mi></munder><mo id="S3.E6.m1.7.7.3.2a" lspace="0.167em" xref="S3.E6.m1.7.7.3.2.cmml">⁡</mo><msub id="S3.E6.m1.7.7.3.2.2" xref="S3.E6.m1.7.7.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.7.7.3.2.2.2" xref="S3.E6.m1.7.7.3.2.2.2.cmml">ℒ</mi><mtext id="S3.E6.m1.7.7.3.2.2.3" xref="S3.E6.m1.7.7.3.2.2.3a.cmml">fake-DSM</mtext></msub></mrow></mrow><mo id="S3.E6.m1.7.7.2" xref="S3.E6.m1.7.7.2.cmml">=</mo><mrow id="S3.E6.m1.7.7.1" xref="S3.E6.m1.7.7.1.cmml"><msub id="S3.E6.m1.7.7.1.3" xref="S3.E6.m1.7.7.1.3.cmml"><mi id="S3.E6.m1.7.7.1.3.2" xref="S3.E6.m1.7.7.1.3.2.cmml">𝔼</mi><mrow id="S3.E6.m1.4.4.4.4" xref="S3.E6.m1.4.4.4.5.cmml"><mrow id="S3.E6.m1.3.3.3.3.1" xref="S3.E6.m1.3.3.3.3.1.cmml"><mi id="S3.E6.m1.3.3.3.3.1.3" xref="S3.E6.m1.3.3.3.3.1.3.cmml">σ</mi><mo id="S3.E6.m1.3.3.3.3.1.2" xref="S3.E6.m1.3.3.3.3.1.2.cmml">∼</mo><mrow id="S3.E6.m1.3.3.3.3.1.1.1" xref="S3.E6.m1.3.3.3.3.1.1.2.cmml"><mo id="S3.E6.m1.3.3.3.3.1.1.1.2" stretchy="false" xref="S3.E6.m1.3.3.3.3.1.1.2.cmml">{</mo><msub id="S3.E6.m1.3.3.3.3.1.1.1.1" xref="S3.E6.m1.3.3.3.3.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.3.3.1.1.1.1.2" xref="S3.E6.m1.3.3.3.3.1.1.1.1.2.cmml">σ</mi><mi id="S3.E6.m1.3.3.3.3.1.1.1.1.3" xref="S3.E6.m1.3.3.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.3.3.3.3.1.1.1.3" stretchy="false" xref="S3.E6.m1.3.3.3.3.1.1.2.cmml">}</mo></mrow></mrow><mo id="S3.E6.m1.4.4.4.4.3" xref="S3.E6.m1.4.4.4.5a.cmml">,</mo><mrow id="S3.E6.m1.4.4.4.4.2" xref="S3.E6.m1.4.4.4.4.2.cmml"><mi id="S3.E6.m1.4.4.4.4.2.2" xref="S3.E6.m1.4.4.4.4.2.2.cmml">ϵ</mi><mo id="S3.E6.m1.4.4.4.4.2.1" xref="S3.E6.m1.4.4.4.4.2.1.cmml">∼</mo><mrow id="S3.E6.m1.4.4.4.4.2.3" xref="S3.E6.m1.4.4.4.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.4.4.4.4.2.3.2" xref="S3.E6.m1.4.4.4.4.2.3.2.cmml">𝒩</mi><mo id="S3.E6.m1.4.4.4.4.2.3.1" xref="S3.E6.m1.4.4.4.4.2.3.1.cmml">⁢</mo><mrow id="S3.E6.m1.4.4.4.4.2.3.3.2" xref="S3.E6.m1.4.4.4.4.2.3.3.1.cmml"><mo id="S3.E6.m1.4.4.4.4.2.3.3.2.1" stretchy="false" xref="S3.E6.m1.4.4.4.4.2.3.3.1.cmml">(</mo><mn id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">0</mn><mo id="S3.E6.m1.4.4.4.4.2.3.3.2.2" xref="S3.E6.m1.4.4.4.4.2.3.3.1.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">𝑰</mi><mo id="S3.E6.m1.4.4.4.4.2.3.3.2.3" stretchy="false" xref="S3.E6.m1.4.4.4.4.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></msub><mo id="S3.E6.m1.7.7.1.2" xref="S3.E6.m1.7.7.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.1.1.1" xref="S3.E6.m1.7.7.1.1.2.cmml"><mo id="S3.E6.m1.7.7.1.1.1.2" xref="S3.E6.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="S3.E6.m1.7.7.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.3.cmml">λ</mi><mo id="S3.E6.m1.7.7.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.4.2" xref="S3.E6.m1.7.7.1.1.1.1.cmml"><mo id="S3.E6.m1.7.7.1.1.1.1.4.2.1" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.1.cmml">(</mo><mi id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml">σ</mi><mo id="S3.E6.m1.7.7.1.1.1.1.4.2.2" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E6.m1.7.7.1.1.1.1.2a" xref="S3.E6.m1.7.7.1.1.1.1.2.cmml">⁢</mo><msubsup id="S3.E6.m1.7.7.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒙</mi><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mtext id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.3a.cmml">gen</mtext></msub><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml">μ</mi><mtext id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3a.cmml">fake</mtext></msub><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒙</mi><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mtext id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml">gen</mtext></msub><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">σ</mi><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E6.m1.6.6" xref="S3.E6.m1.6.6.cmml">σ</mi><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E6.m1.7.7.1.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E6.m1.7.7.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow><mo id="S3.E6.m1.7.7.1.1.1.3" xref="S3.E6.m1.7.7.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.7.cmml" xref="S3.E6.m1.7.7"><eq id="S3.E6.m1.7.7.2.cmml" xref="S3.E6.m1.7.7.2"></eq><apply id="S3.E6.m1.7.7.3.cmml" xref="S3.E6.m1.7.7.3"><arg id="S3.E6.m1.7.7.3.1.cmml" xref="S3.E6.m1.7.7.3.1"></arg><apply id="S3.E6.m1.7.7.3.2.cmml" xref="S3.E6.m1.7.7.3.2"><apply id="S3.E6.m1.7.7.3.2.1.cmml" xref="S3.E6.m1.7.7.3.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.3.2.1.1.cmml" xref="S3.E6.m1.7.7.3.2.1">subscript</csymbol><min id="S3.E6.m1.7.7.3.2.1.2.cmml" xref="S3.E6.m1.7.7.3.2.1.2"></min><ci id="S3.E6.m1.7.7.3.2.1.3.cmml" xref="S3.E6.m1.7.7.3.2.1.3">𝝍</ci></apply><apply id="S3.E6.m1.7.7.3.2.2.cmml" xref="S3.E6.m1.7.7.3.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.3.2.2.1.cmml" xref="S3.E6.m1.7.7.3.2.2">subscript</csymbol><ci id="S3.E6.m1.7.7.3.2.2.2.cmml" xref="S3.E6.m1.7.7.3.2.2.2">ℒ</ci><ci id="S3.E6.m1.7.7.3.2.2.3a.cmml" xref="S3.E6.m1.7.7.3.2.2.3"><mtext id="S3.E6.m1.7.7.3.2.2.3.cmml" mathsize="70%" xref="S3.E6.m1.7.7.3.2.2.3">fake-DSM</mtext></ci></apply></apply></apply><apply id="S3.E6.m1.7.7.1.cmml" xref="S3.E6.m1.7.7.1"><times id="S3.E6.m1.7.7.1.2.cmml" xref="S3.E6.m1.7.7.1.2"></times><apply id="S3.E6.m1.7.7.1.3.cmml" xref="S3.E6.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.3.1.cmml" xref="S3.E6.m1.7.7.1.3">subscript</csymbol><ci id="S3.E6.m1.7.7.1.3.2.cmml" xref="S3.E6.m1.7.7.1.3.2">𝔼</ci><apply id="S3.E6.m1.4.4.4.5.cmml" xref="S3.E6.m1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.5a.cmml" xref="S3.E6.m1.4.4.4.4.3">formulae-sequence</csymbol><apply id="S3.E6.m1.3.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.3.1"><csymbol cd="latexml" id="S3.E6.m1.3.3.3.3.1.2.cmml" xref="S3.E6.m1.3.3.3.3.1.2">similar-to</csymbol><ci id="S3.E6.m1.3.3.3.3.1.3.cmml" xref="S3.E6.m1.3.3.3.3.1.3">𝜎</ci><set id="S3.E6.m1.3.3.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.3.3.1.1.1"><apply id="S3.E6.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.3.3.1.1.1.1.2">𝜎</ci><ci id="S3.E6.m1.3.3.3.3.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.3.3.1.1.1.1.3">𝑖</ci></apply></set></apply><apply id="S3.E6.m1.4.4.4.4.2.cmml" xref="S3.E6.m1.4.4.4.4.2"><csymbol cd="latexml" id="S3.E6.m1.4.4.4.4.2.1.cmml" xref="S3.E6.m1.4.4.4.4.2.1">similar-to</csymbol><ci id="S3.E6.m1.4.4.4.4.2.2.cmml" xref="S3.E6.m1.4.4.4.4.2.2">italic-ϵ</ci><apply id="S3.E6.m1.4.4.4.4.2.3.cmml" xref="S3.E6.m1.4.4.4.4.2.3"><times id="S3.E6.m1.4.4.4.4.2.3.1.cmml" xref="S3.E6.m1.4.4.4.4.2.3.1"></times><ci id="S3.E6.m1.4.4.4.4.2.3.2.cmml" xref="S3.E6.m1.4.4.4.4.2.3.2">𝒩</ci><interval closure="open" id="S3.E6.m1.4.4.4.4.2.3.3.1.cmml" xref="S3.E6.m1.4.4.4.4.2.3.3.2"><cn id="S3.E6.m1.1.1.1.1.cmml" type="integer" xref="S3.E6.m1.1.1.1.1">0</cn><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑰</ci></interval></apply></apply></apply></apply><apply id="S3.E6.m1.7.7.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.7.7.1.1.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1"><times id="S3.E6.m1.7.7.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.2"></times><ci id="S3.E6.m1.7.7.1.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.3">𝜆</ci><ci id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5">𝜎</ci><apply id="S3.E6.m1.7.7.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1"><minus id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.2">𝒙</ci></apply><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.3"><mtext id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.3">gen</mtext></ci></apply><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2">𝜇</ci><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3"><mtext id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3">fake</mtext></ci></apply><interval closure="open" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒙</ci></apply><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><mtext id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">gen</mtext></ci></apply><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝜎</ci><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">italic-ϵ</ci></apply></apply><ci id="S3.E6.m1.6.6.cmml" xref="S3.E6.m1.6.6">𝜎</ci></interval></apply></apply></apply><cn id="S3.E6.m1.7.7.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3">2</cn></apply><cn id="S3.E6.m1.7.7.1.1.1.1.1.3.cmml" type="integer" xref="S3.E6.m1.7.7.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">\arg\min_{\bm{\psi}}\mathcal{L}_{\text{fake-DSM}}=\mathbb{E}_{\sigma\sim\{%
\sigma_{i}\},\epsilon\sim\mathcal{N}(0,\bm{I})}\left[\lambda(\sigma)\|\hat{\bm%
{x}}_{\text{gen}}-\mu_{\text{fake}}(\hat{\bm{x}}_{\text{gen}}+\sigma\epsilon,%
\sigma)\|_{2}^{2}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.7d">roman_arg roman_min start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT fake-DSM end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_σ ∼ { italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } , italic_ϵ ∼ caligraphic_N ( 0 , bold_italic_I ) end_POSTSUBSCRIPT [ italic_λ ( italic_σ ) ∥ over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT + italic_σ italic_ϵ , italic_σ ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.10">To avoid using offline data <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib63" title="">2023</a>)</cite>, the fake score model is updated <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.10.1">5 times as often</em> as the generator to stabilize the estimation of the generator’s distribution.
DMD2 additionally includes an explicit adversarial loss in order to improve quality. Specifically, a discriminator head <math alttext="D_{\bm{\psi}}" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m1.1"><semantics id="S3.SS1.p2.9.m1.1a"><msub id="S3.SS1.p2.9.m1.1.1" xref="S3.SS1.p2.9.m1.1.1.cmml"><mi id="S3.SS1.p2.9.m1.1.1.2" xref="S3.SS1.p2.9.m1.1.1.2.cmml">D</mi><mi id="S3.SS1.p2.9.m1.1.1.3" xref="S3.SS1.p2.9.m1.1.1.3.cmml">𝝍</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m1.1b"><apply id="S3.SS1.p2.9.m1.1.1.cmml" xref="S3.SS1.p2.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m1.1.1.1.cmml" xref="S3.SS1.p2.9.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m1.1.1.2.cmml" xref="S3.SS1.p2.9.m1.1.1.2">𝐷</ci><ci id="S3.SS1.p2.9.m1.1.1.3.cmml" xref="S3.SS1.p2.9.m1.1.1.3">𝝍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m1.1c">D_{\bm{\psi}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m1.1d">italic_D start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> is attached to the intermediate feature activations
of the fake score network <math alttext="\mu_{\text{fake}}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m2.1"><semantics id="S3.SS1.p2.10.m2.1a"><msub id="S3.SS1.p2.10.m2.1.1" xref="S3.SS1.p2.10.m2.1.1.cmml"><mi id="S3.SS1.p2.10.m2.1.1.2" xref="S3.SS1.p2.10.m2.1.1.2.cmml">μ</mi><mtext id="S3.SS1.p2.10.m2.1.1.3" xref="S3.SS1.p2.10.m2.1.1.3a.cmml">fake</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m2.1b"><apply id="S3.SS1.p2.10.m2.1.1.cmml" xref="S3.SS1.p2.10.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m2.1.1.1.cmml" xref="S3.SS1.p2.10.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.10.m2.1.1.2.cmml" xref="S3.SS1.p2.10.m2.1.1.2">𝜇</ci><ci id="S3.SS1.p2.10.m2.1.1.3a.cmml" xref="S3.SS1.p2.10.m2.1.1.3"><mtext id="S3.SS1.p2.10.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.10.m2.1.1.3">fake</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m2.1c">\mu_{\text{fake}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m2.1d">italic_μ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT</annotation></semantics></math>, and thus is trained with the nonsaturating GAN loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\arg\min_{\bm{\phi}}\max_{\bm{\psi}}\mathbb{E}_{\begin{subarray}{c}\sigma\sim%
\{\sigma_{i}\},\\
\epsilon\sim\mathcal{N}(0,\bm{I})\end{subarray}}[\log D_{\bm{\psi}}(\bm{x}_{%
\text{real}}+\sigma\epsilon,\sigma)]+\mathbb{E}_{\begin{subarray}{c}\sigma\sim%
\{\sigma_{i}\},\\
\epsilon\sim\mathcal{N}(0,\bm{I})\end{subarray}}[-\log D_{\bm{\psi}}(\hat{\bm{%
x}}_{\text{gen}}+\sigma\epsilon,\sigma)]," class="ltx_Math" display="block" id="S3.E7.m1.5"><semantics id="S3.E7.m1.5a"><mrow id="S3.E7.m1.5.5.1" xref="S3.E7.m1.5.5.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1" xref="S3.E7.m1.5.5.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1.1" xref="S3.E7.m1.5.5.1.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.3.cmml"><mi id="S3.E7.m1.5.5.1.1.1.3.1" xref="S3.E7.m1.5.5.1.1.1.3.1.cmml">arg</mi><mo id="S3.E7.m1.5.5.1.1.1.3a" lspace="0.167em" xref="S3.E7.m1.5.5.1.1.1.3.cmml">⁡</mo><mrow id="S3.E7.m1.5.5.1.1.1.3.2" xref="S3.E7.m1.5.5.1.1.1.3.2.cmml"><munder id="S3.E7.m1.5.5.1.1.1.3.2.1" xref="S3.E7.m1.5.5.1.1.1.3.2.1.cmml"><mi id="S3.E7.m1.5.5.1.1.1.3.2.1.2" xref="S3.E7.m1.5.5.1.1.1.3.2.1.2.cmml">min</mi><mi class="ltx_mathvariant_bold-italic" id="S3.E7.m1.5.5.1.1.1.3.2.1.3" mathvariant="bold-italic" xref="S3.E7.m1.5.5.1.1.1.3.2.1.3.cmml">ϕ</mi></munder><mo id="S3.E7.m1.5.5.1.1.1.3.2a" lspace="0.167em" xref="S3.E7.m1.5.5.1.1.1.3.2.cmml">⁡</mo><mrow id="S3.E7.m1.5.5.1.1.1.3.2.2" xref="S3.E7.m1.5.5.1.1.1.3.2.2.cmml"><munder id="S3.E7.m1.5.5.1.1.1.3.2.2.1" xref="S3.E7.m1.5.5.1.1.1.3.2.2.1.cmml"><mi id="S3.E7.m1.5.5.1.1.1.3.2.2.1.2" xref="S3.E7.m1.5.5.1.1.1.3.2.2.1.2.cmml">max</mi><mi id="S3.E7.m1.5.5.1.1.1.3.2.2.1.3" xref="S3.E7.m1.5.5.1.1.1.3.2.2.1.3.cmml">𝝍</mi></munder><mo id="S3.E7.m1.5.5.1.1.1.3.2.2a" lspace="0.167em" xref="S3.E7.m1.5.5.1.1.1.3.2.2.cmml">⁡</mo><msub id="S3.E7.m1.5.5.1.1.1.3.2.2.2" xref="S3.E7.m1.5.5.1.1.1.3.2.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.1.3.2.2.2.2" xref="S3.E7.m1.5.5.1.1.1.3.2.2.2.2.cmml">𝔼</mi><mtable id="S3.E7.m1.1.1.1.1.1.1" rowspacing="0pt" xref="S3.E7.m1.1.1.1.2.cmml"><mtr id="S3.E7.m1.1.1.1.1.1.1a" xref="S3.E7.m1.1.1.1.2.cmml"><mtd id="S3.E7.m1.1.1.1.1.1.1b" xref="S3.E7.m1.1.1.1.2.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">∼</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">σ</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E7.m1.1.1.1.1.1.1c" xref="S3.E7.m1.1.1.1.2.cmml"><mtd id="S3.E7.m1.1.1.1.1.1.1d" xref="S3.E7.m1.1.1.1.2.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.4" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.4.cmml">ϵ</mi><mo id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.3" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.3.cmml">∼</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.2" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.2.cmml">𝒩</mi><mo id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.1" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.1.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.3.2" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.3.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.3.2.1" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.3.1.cmml">(</mo><mn id="S3.E7.m1.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.2.2.1.1.1.cmml">0</mn><mo id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.3.2.2" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.3.1.cmml">,</mo><mi id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.2" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.2.cmml">𝑰</mi><mo id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.3.2.3" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.3.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable></msub></mrow></mrow></mrow><mo id="S3.E7.m1.5.5.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E7.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.3.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E7.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">D</mi><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.3.cmml">𝝍</mi></msub></mrow><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mtext id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.3a.cmml">real</mtext></msub><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml">σ</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">σ</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E7.m1.5.5.1.1.3" xref="S3.E7.m1.5.5.1.1.3.cmml">+</mo><mrow id="S3.E7.m1.5.5.1.1.2" xref="S3.E7.m1.5.5.1.1.2.cmml"><msub id="S3.E7.m1.5.5.1.1.2.3" xref="S3.E7.m1.5.5.1.1.2.3.cmml"><mi id="S3.E7.m1.5.5.1.1.2.3.2" xref="S3.E7.m1.5.5.1.1.2.3.2.cmml">𝔼</mi><mtable id="S3.E7.m1.2.2.1.1.1.1" rowspacing="0pt" xref="S3.E7.m1.2.2.1.2.cmml"><mtr id="S3.E7.m1.2.2.1.1.1.1a" xref="S3.E7.m1.2.2.1.2.cmml"><mtd id="S3.E7.m1.2.2.1.1.1.1b" xref="S3.E7.m1.2.2.1.2.cmml"><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">∼</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">σ</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E7.m1.2.2.1.1.1.1c" xref="S3.E7.m1.2.2.1.2.cmml"><mtd id="S3.E7.m1.2.2.1.1.1.1d" xref="S3.E7.m1.2.2.1.2.cmml"><mrow id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.4" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.4.cmml">ϵ</mi><mo id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.3" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.3.cmml">∼</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.2" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.2.cmml">𝒩</mi><mo id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.1" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.1.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.3.2" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.3.1.cmml"><mo id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.3.2.1" stretchy="false" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.3.1.cmml">(</mo><mn id="S3.E7.m1.2.2.1.1.1.1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.2.2.1.1.1.cmml">0</mn><mo id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.3.2.2" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.3.1.cmml">,</mo><mi id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.2" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.2.cmml">𝑰</mi><mo id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.3.2.3" stretchy="false" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.3.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable></msub><mo id="S3.E7.m1.5.5.1.1.2.2" xref="S3.E7.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.2.1.1" xref="S3.E7.m1.5.5.1.1.2.1.2.cmml"><mo id="S3.E7.m1.5.5.1.1.2.1.1.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.2.1.2.1.cmml">[</mo><mrow id="S3.E7.m1.5.5.1.1.2.1.1.1" xref="S3.E7.m1.5.5.1.1.2.1.1.1.cmml"><mo id="S3.E7.m1.5.5.1.1.2.1.1.1a" rspace="0.167em" xref="S3.E7.m1.5.5.1.1.2.1.1.1.cmml">−</mo><mrow id="S3.E7.m1.5.5.1.1.2.1.1.1.1" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.1" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3a" lspace="0.167em" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.2" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.2.cmml">D</mi><mi id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.3" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.3.cmml">𝝍</mi></msub></mrow><mo id="S3.E7.m1.5.5.1.1.2.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.2.cmml">𝒙</mi><mo id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.1" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mtext id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3a.cmml">gen</mtext></msub><mo id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2.cmml">σ</mi><mo id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.1" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml">σ</mi><mo id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.4" stretchy="false" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.5.5.1.1.2.1.1.3" stretchy="false" xref="S3.E7.m1.5.5.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E7.m1.5.5.1.2" xref="S3.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.5b"><apply id="S3.E7.m1.5.5.1.1.cmml" xref="S3.E7.m1.5.5.1"><plus id="S3.E7.m1.5.5.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.3"></plus><apply id="S3.E7.m1.5.5.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1"><times id="S3.E7.m1.5.5.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.2"></times><apply id="S3.E7.m1.5.5.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.3"><arg id="S3.E7.m1.5.5.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.1.1.1.3.1"></arg><apply id="S3.E7.m1.5.5.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2"><apply id="S3.E7.m1.5.5.1.1.1.3.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.3.2.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.1">subscript</csymbol><min id="S3.E7.m1.5.5.1.1.1.3.2.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.1.2"></min><ci id="S3.E7.m1.5.5.1.1.1.3.2.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.1.3">bold-italic-ϕ</ci></apply><apply id="S3.E7.m1.5.5.1.1.1.3.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.2"><apply id="S3.E7.m1.5.5.1.1.1.3.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.3.2.2.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.2.1">subscript</csymbol><max id="S3.E7.m1.5.5.1.1.1.3.2.2.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.2.1.2"></max><ci id="S3.E7.m1.5.5.1.1.1.3.2.2.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.2.1.3">𝝍</ci></apply><apply id="S3.E7.m1.5.5.1.1.1.3.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.3.2.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.3.2.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.3.2.2.2.2">𝔼</ci><list id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><matrix id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><matrixrow id="S3.E7.m1.1.1.1.1.1.1a.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">similar-to</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜎</ci><set id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝜎</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set></apply></matrixrow><matrixrow id="S3.E7.m1.1.1.1.1.1.1b.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><apply id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.3">similar-to</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.4">italic-ϵ</ci><apply id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5"><times id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.1"></times><ci id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.2">𝒩</ci><interval closure="open" id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.5.3.2"><cn id="S3.E7.m1.1.1.1.1.1.1.2.2.1.1.1.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.1.1.2.2.1.1.1">0</cn><ci id="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3.2.2.2">𝑰</ci></interval></apply></apply></matrixrow></matrix></list></apply></apply></apply></apply><apply id="S3.E7.m1.5.5.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1"><times id="S3.E7.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3"><log id="S3.E7.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.1"></log><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.2">𝐷</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.2.3">𝝍</ci></apply></apply><interval closure="open" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1"><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1"><plus id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.3"><mtext id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.3">real</mtext></ci></apply><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3"><times id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.2">𝜎</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.3.3">italic-ϵ</ci></apply></apply><ci id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">𝜎</ci></interval></apply></apply></apply><apply id="S3.E7.m1.5.5.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2"><times id="S3.E7.m1.5.5.1.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2"></times><apply id="S3.E7.m1.5.5.1.1.2.3.cmml" xref="S3.E7.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.2.3.1.cmml" xref="S3.E7.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.2.3.2.cmml" xref="S3.E7.m1.5.5.1.1.2.3.2">𝔼</ci><list id="S3.E7.m1.2.2.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1"><matrix id="S3.E7.m1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1"><matrixrow id="S3.E7.m1.2.2.1.1.1.1a.cmml" xref="S3.E7.m1.2.2.1.1.1.1"><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">similar-to</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝜎</ci><set id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝜎</ci><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set></apply></matrixrow><matrixrow id="S3.E7.m1.2.2.1.1.1.1b.cmml" xref="S3.E7.m1.2.2.1.1.1.1"><apply id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2"><csymbol cd="latexml" id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.3">similar-to</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.4.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.4">italic-ϵ</ci><apply id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5"><times id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.1"></times><ci id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.2">𝒩</ci><interval closure="open" id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.5.3.2"><cn id="S3.E7.m1.2.2.1.1.1.1.2.2.1.1.1.cmml" type="integer" xref="S3.E7.m1.2.2.1.1.1.1.2.2.1.1.1">0</cn><ci id="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3.2.2.2">𝑰</ci></interval></apply></apply></matrixrow></matrix></list></apply><apply id="S3.E7.m1.5.5.1.1.2.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1"><csymbol cd="latexml" id="S3.E7.m1.5.5.1.1.2.1.2.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1"><minus id="S3.E7.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1"></minus><apply id="S3.E7.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1"><times id="S3.E7.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.2"></times><apply id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3"><log id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.1"></log><apply id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.2">𝐷</ci><ci id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.2.3">𝝍</ci></apply></apply><interval closure="open" id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1"><apply id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1"><plus id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.1"></plus><apply id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2"><ci id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.2">𝒙</ci></apply><ci id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3"><mtext id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3">gen</mtext></ci></apply><apply id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3"><times id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2">𝜎</ci><ci id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.3">italic-ϵ</ci></apply></apply><ci id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4">𝜎</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.5c">\arg\min_{\bm{\phi}}\max_{\bm{\psi}}\mathbb{E}_{\begin{subarray}{c}\sigma\sim%
\{\sigma_{i}\},\\
\epsilon\sim\mathcal{N}(0,\bm{I})\end{subarray}}[\log D_{\bm{\psi}}(\bm{x}_{%
\text{real}}+\sigma\epsilon,\sigma)]+\mathbb{E}_{\begin{subarray}{c}\sigma\sim%
\{\sigma_{i}\},\\
\epsilon\sim\mathcal{N}(0,\bm{I})\end{subarray}}[-\log D_{\bm{\psi}}(\hat{\bm{%
x}}_{\text{gen}}+\sigma\epsilon,\sigma)],</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.5d">roman_arg roman_min start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT roman_max start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT start_ARG start_ROW start_CELL italic_σ ∼ { italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } , end_CELL end_ROW start_ROW start_CELL italic_ϵ ∼ caligraphic_N ( 0 , bold_italic_I ) end_CELL end_ROW end_ARG end_POSTSUBSCRIPT [ roman_log italic_D start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT + italic_σ italic_ϵ , italic_σ ) ] + blackboard_E start_POSTSUBSCRIPT start_ARG start_ROW start_CELL italic_σ ∼ { italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } , end_CELL end_ROW start_ROW start_CELL italic_ϵ ∼ caligraphic_N ( 0 , bold_italic_I ) end_CELL end_ROW end_ARG end_POSTSUBSCRIPT [ - roman_log italic_D start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT + italic_σ italic_ϵ , italic_σ ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.16">which follows past work on using diffusion model backbones as discriminators <cite class="ltx_cite ltx_citemacro_citep">(Sauer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib50" title="">2024</a>)</cite>. In all, the generator <math alttext="G_{\bm{\phi}}" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m1.1"><semantics id="S3.SS1.p2.11.m1.1a"><msub id="S3.SS1.p2.11.m1.1.1" xref="S3.SS1.p2.11.m1.1.1.cmml"><mi id="S3.SS1.p2.11.m1.1.1.2" xref="S3.SS1.p2.11.m1.1.1.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="S3.SS1.p2.11.m1.1.1.3" mathvariant="bold-italic" xref="S3.SS1.p2.11.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m1.1b"><apply id="S3.SS1.p2.11.m1.1.1.cmml" xref="S3.SS1.p2.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m1.1.1.1.cmml" xref="S3.SS1.p2.11.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m1.1.1.2.cmml" xref="S3.SS1.p2.11.m1.1.1.2">𝐺</ci><ci id="S3.SS1.p2.11.m1.1.1.3.cmml" xref="S3.SS1.p2.11.m1.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m1.1c">G_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m1.1d">italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> is thus trained with a combination of the distribution matching loss <math alttext="\mathcal{L}_{\text{DMD}}" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m2.1"><semantics id="S3.SS1.p2.12.m2.1a"><msub id="S3.SS1.p2.12.m2.1.1" xref="S3.SS1.p2.12.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.12.m2.1.1.2" xref="S3.SS1.p2.12.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p2.12.m2.1.1.3" xref="S3.SS1.p2.12.m2.1.1.3a.cmml">DMD</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m2.1b"><apply id="S3.SS1.p2.12.m2.1.1.cmml" xref="S3.SS1.p2.12.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m2.1.1.1.cmml" xref="S3.SS1.p2.12.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.12.m2.1.1.2.cmml" xref="S3.SS1.p2.12.m2.1.1.2">ℒ</ci><ci id="S3.SS1.p2.12.m2.1.1.3a.cmml" xref="S3.SS1.p2.12.m2.1.1.3"><mtext id="S3.SS1.p2.12.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.12.m2.1.1.3">DMD</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m2.1c">\mathcal{L}_{\text{DMD}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m2.1d">caligraphic_L start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT</annotation></semantics></math> and the adversarial loss <math alttext="\mathcal{L}_{\text{GAN}}" class="ltx_Math" display="inline" id="S3.SS1.p2.13.m3.1"><semantics id="S3.SS1.p2.13.m3.1a"><msub id="S3.SS1.p2.13.m3.1.1" xref="S3.SS1.p2.13.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.13.m3.1.1.2" xref="S3.SS1.p2.13.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p2.13.m3.1.1.3" xref="S3.SS1.p2.13.m3.1.1.3a.cmml">GAN</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m3.1b"><apply id="S3.SS1.p2.13.m3.1.1.cmml" xref="S3.SS1.p2.13.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m3.1.1.1.cmml" xref="S3.SS1.p2.13.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.13.m3.1.1.2.cmml" xref="S3.SS1.p2.13.m3.1.1.2">ℒ</ci><ci id="S3.SS1.p2.13.m3.1.1.3a.cmml" xref="S3.SS1.p2.13.m3.1.1.3"><mtext id="S3.SS1.p2.13.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.13.m3.1.1.3">GAN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m3.1c">\mathcal{L}_{\text{GAN}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.13.m3.1d">caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math>, while the fake score model (and its discriminator head) is trained with the fake DSM loss <math alttext="\mathcal{L}_{\text{fake-DSM}}" class="ltx_Math" display="inline" id="S3.SS1.p2.14.m4.1"><semantics id="S3.SS1.p2.14.m4.1a"><msub id="S3.SS1.p2.14.m4.1.1" xref="S3.SS1.p2.14.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.14.m4.1.1.2" xref="S3.SS1.p2.14.m4.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p2.14.m4.1.1.3" xref="S3.SS1.p2.14.m4.1.1.3a.cmml">fake-DSM</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m4.1b"><apply id="S3.SS1.p2.14.m4.1.1.cmml" xref="S3.SS1.p2.14.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m4.1.1.1.cmml" xref="S3.SS1.p2.14.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.14.m4.1.1.2.cmml" xref="S3.SS1.p2.14.m4.1.1.2">ℒ</ci><ci id="S3.SS1.p2.14.m4.1.1.3a.cmml" xref="S3.SS1.p2.14.m4.1.1.3"><mtext id="S3.SS1.p2.14.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.14.m4.1.1.3">fake-DSM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m4.1c">\mathcal{L}_{\text{fake-DSM}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.14.m4.1d">caligraphic_L start_POSTSUBSCRIPT fake-DSM end_POSTSUBSCRIPT</annotation></semantics></math> and the adversarial loss <math alttext="\mathcal{L}_{\text{GAN}}" class="ltx_Math" display="inline" id="S3.SS1.p2.15.m5.1"><semantics id="S3.SS1.p2.15.m5.1a"><msub id="S3.SS1.p2.15.m5.1.1" xref="S3.SS1.p2.15.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.15.m5.1.1.2" xref="S3.SS1.p2.15.m5.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p2.15.m5.1.1.3" xref="S3.SS1.p2.15.m5.1.1.3a.cmml">GAN</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m5.1b"><apply id="S3.SS1.p2.15.m5.1.1.cmml" xref="S3.SS1.p2.15.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m5.1.1.1.cmml" xref="S3.SS1.p2.15.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.15.m5.1.1.2.cmml" xref="S3.SS1.p2.15.m5.1.1.2">ℒ</ci><ci id="S3.SS1.p2.15.m5.1.1.3a.cmml" xref="S3.SS1.p2.15.m5.1.1.3"><mtext id="S3.SS1.p2.15.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.15.m5.1.1.3">GAN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m5.1c">\mathcal{L}_{\text{GAN}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.15.m5.1d">caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math>. To sample from the distilled generator, DMD2 uses consistency model-style “ping-pong sampling” <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib57" title="">2023</a>)</cite>, where the model iteratively denoises (starting at pure noise <math alttext="\sigma_{\text{max}}" class="ltx_Math" display="inline" id="S3.SS1.p2.16.m6.1"><semantics id="S3.SS1.p2.16.m6.1a"><msub id="S3.SS1.p2.16.m6.1.1" xref="S3.SS1.p2.16.m6.1.1.cmml"><mi id="S3.SS1.p2.16.m6.1.1.2" xref="S3.SS1.p2.16.m6.1.1.2.cmml">σ</mi><mtext id="S3.SS1.p2.16.m6.1.1.3" xref="S3.SS1.p2.16.m6.1.1.3a.cmml">max</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m6.1b"><apply id="S3.SS1.p2.16.m6.1.1.cmml" xref="S3.SS1.p2.16.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m6.1.1.1.cmml" xref="S3.SS1.p2.16.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.16.m6.1.1.2.cmml" xref="S3.SS1.p2.16.m6.1.1.2">𝜎</ci><ci id="S3.SS1.p2.16.m6.1.1.3a.cmml" xref="S3.SS1.p2.16.m6.1.1.3"><mtext id="S3.SS1.p2.16.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.16.m6.1.1.3">max</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m6.1c">\sigma_{\text{max}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.16.m6.1d">italic_σ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT</annotation></semantics></math>) and <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.16.1">renoises</em> to progressively smaller noise levels.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2">Regarding past work, we note <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib64" title="">2024</a>)</cite> <em class="ltx_emph ltx_font_italic" id="S3.SS1.p3.2.1">did</em> present a small-scale EDM-style experiment,
but treated EDM models as if they were functions of discrete noise timesteps.
This re-discretization runs counterintuitive to using score-based models for distribution matching, since the fake and real score models are meant to be run and trained in continuous-time and can adapt to variable points along the noise process.
Furthermore, this disregards the ability of continuous-time models to capture the <em class="ltx_emph ltx_font_italic" id="S3.SS1.p3.2.2">entire</em> noise process from noise to data and enable <em class="ltx_emph ltx_font_italic" id="S3.SS1.p3.2.3">exact</em> likelihoods rather than ELBOs <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib56" title="">2021</a>)</cite>.
Additionally, since DMD2 implicitly aims to learn an integrator of the PF ODE
<math alttext="G_{\bm{\phi}}(\bm{x},\sigma)\approx\bm{x}+\int_{\sigma}^{\sigma_{\text{min}}}-%
\delta\nabla\log p(\bm{x}\mid\delta)\textrm{d}\delta" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.3"><semantics id="S3.SS1.p3.1.m1.3a"><mrow id="S3.SS1.p3.1.m1.3.3" xref="S3.SS1.p3.1.m1.3.3.cmml"><mrow id="S3.SS1.p3.1.m1.3.3.3" xref="S3.SS1.p3.1.m1.3.3.3.cmml"><msub id="S3.SS1.p3.1.m1.3.3.3.2" xref="S3.SS1.p3.1.m1.3.3.3.2.cmml"><mi id="S3.SS1.p3.1.m1.3.3.3.2.2" xref="S3.SS1.p3.1.m1.3.3.3.2.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="S3.SS1.p3.1.m1.3.3.3.2.3" mathvariant="bold-italic" xref="S3.SS1.p3.1.m1.3.3.3.2.3.cmml">ϕ</mi></msub><mo id="S3.SS1.p3.1.m1.3.3.3.1" xref="S3.SS1.p3.1.m1.3.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.p3.1.m1.3.3.3.3.2" xref="S3.SS1.p3.1.m1.3.3.3.3.1.cmml"><mo id="S3.SS1.p3.1.m1.3.3.3.3.2.1" stretchy="false" xref="S3.SS1.p3.1.m1.3.3.3.3.1.cmml">(</mo><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">𝒙</mi><mo id="S3.SS1.p3.1.m1.3.3.3.3.2.2" xref="S3.SS1.p3.1.m1.3.3.3.3.1.cmml">,</mo><mi id="S3.SS1.p3.1.m1.2.2" xref="S3.SS1.p3.1.m1.2.2.cmml">σ</mi><mo id="S3.SS1.p3.1.m1.3.3.3.3.2.3" stretchy="false" xref="S3.SS1.p3.1.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.1.m1.3.3.2" xref="S3.SS1.p3.1.m1.3.3.2.cmml">≈</mo><mrow id="S3.SS1.p3.1.m1.3.3.1" xref="S3.SS1.p3.1.m1.3.3.1.cmml"><mrow id="S3.SS1.p3.1.m1.3.3.1.3" xref="S3.SS1.p3.1.m1.3.3.1.3.cmml"><mi id="S3.SS1.p3.1.m1.3.3.1.3.2" xref="S3.SS1.p3.1.m1.3.3.1.3.2.cmml">𝒙</mi><mo id="S3.SS1.p3.1.m1.3.3.1.3.1" rspace="0.055em" xref="S3.SS1.p3.1.m1.3.3.1.3.1.cmml">+</mo><msubsup id="S3.SS1.p3.1.m1.3.3.1.3.3" xref="S3.SS1.p3.1.m1.3.3.1.3.3.cmml"><mo id="S3.SS1.p3.1.m1.3.3.1.3.3.2.2" rspace="0em" xref="S3.SS1.p3.1.m1.3.3.1.3.3.2.2.cmml">∫</mo><mi id="S3.SS1.p3.1.m1.3.3.1.3.3.2.3" xref="S3.SS1.p3.1.m1.3.3.1.3.3.2.3.cmml">σ</mi><msub id="S3.SS1.p3.1.m1.3.3.1.3.3.3" xref="S3.SS1.p3.1.m1.3.3.1.3.3.3.cmml"><mi id="S3.SS1.p3.1.m1.3.3.1.3.3.3.2" xref="S3.SS1.p3.1.m1.3.3.1.3.3.3.2.cmml">σ</mi><mtext id="S3.SS1.p3.1.m1.3.3.1.3.3.3.3" xref="S3.SS1.p3.1.m1.3.3.1.3.3.3.3a.cmml">min</mtext></msub></msubsup></mrow><mo id="S3.SS1.p3.1.m1.3.3.1.2" lspace="0em" xref="S3.SS1.p3.1.m1.3.3.1.2.cmml">−</mo><mrow id="S3.SS1.p3.1.m1.3.3.1.1" xref="S3.SS1.p3.1.m1.3.3.1.1.cmml"><mi id="S3.SS1.p3.1.m1.3.3.1.1.3" xref="S3.SS1.p3.1.m1.3.3.1.1.3.cmml">δ</mi><mo id="S3.SS1.p3.1.m1.3.3.1.1.2" lspace="0.167em" xref="S3.SS1.p3.1.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p3.1.m1.3.3.1.1.4" xref="S3.SS1.p3.1.m1.3.3.1.1.4.cmml"><mrow id="S3.SS1.p3.1.m1.3.3.1.1.4.1" xref="S3.SS1.p3.1.m1.3.3.1.1.4.1.cmml"><mo id="S3.SS1.p3.1.m1.3.3.1.1.4.1.1" rspace="0.167em" xref="S3.SS1.p3.1.m1.3.3.1.1.4.1.1.cmml">∇</mo><mi id="S3.SS1.p3.1.m1.3.3.1.1.4.1.2" xref="S3.SS1.p3.1.m1.3.3.1.1.4.1.2.cmml">log</mi></mrow><mo id="S3.SS1.p3.1.m1.3.3.1.1.4a" lspace="0.167em" xref="S3.SS1.p3.1.m1.3.3.1.1.4.cmml">⁡</mo><mi id="S3.SS1.p3.1.m1.3.3.1.1.4.2" xref="S3.SS1.p3.1.m1.3.3.1.1.4.2.cmml">p</mi></mrow><mo id="S3.SS1.p3.1.m1.3.3.1.1.2a" xref="S3.SS1.p3.1.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p3.1.m1.3.3.1.1.1.1" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.1.m1.3.3.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.1.m1.3.3.1.1.1.1.1" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.2" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.1" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.3" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.3.cmml">δ</mi></mrow><mo id="S3.SS1.p3.1.m1.3.3.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.1.m1.3.3.1.1.2b" xref="S3.SS1.p3.1.m1.3.3.1.1.2.cmml">⁢</mo><mtext id="S3.SS1.p3.1.m1.3.3.1.1.5" xref="S3.SS1.p3.1.m1.3.3.1.1.5a.cmml">d</mtext><mo id="S3.SS1.p3.1.m1.3.3.1.1.2c" xref="S3.SS1.p3.1.m1.3.3.1.1.2.cmml">⁢</mo><mi id="S3.SS1.p3.1.m1.3.3.1.1.6" xref="S3.SS1.p3.1.m1.3.3.1.1.6.cmml">δ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.3b"><apply id="S3.SS1.p3.1.m1.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3"><approx id="S3.SS1.p3.1.m1.3.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.2"></approx><apply id="S3.SS1.p3.1.m1.3.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3.3"><times id="S3.SS1.p3.1.m1.3.3.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.3.1"></times><apply id="S3.SS1.p3.1.m1.3.3.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.3.2.1.cmml" xref="S3.SS1.p3.1.m1.3.3.3.2">subscript</csymbol><ci id="S3.SS1.p3.1.m1.3.3.3.2.2.cmml" xref="S3.SS1.p3.1.m1.3.3.3.2.2">𝐺</ci><ci id="S3.SS1.p3.1.m1.3.3.3.2.3.cmml" xref="S3.SS1.p3.1.m1.3.3.3.2.3">bold-italic-ϕ</ci></apply><interval closure="open" id="S3.SS1.p3.1.m1.3.3.3.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.2"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝒙</ci><ci id="S3.SS1.p3.1.m1.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2">𝜎</ci></interval></apply><apply id="S3.SS1.p3.1.m1.3.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1"><minus id="S3.SS1.p3.1.m1.3.3.1.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.2"></minus><apply id="S3.SS1.p3.1.m1.3.3.1.3.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3"><plus id="S3.SS1.p3.1.m1.3.3.1.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.1"></plus><ci id="S3.SS1.p3.1.m1.3.3.1.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.2">𝒙</ci><apply id="S3.SS1.p3.1.m1.3.3.1.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.1.3.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.3">superscript</csymbol><apply id="S3.SS1.p3.1.m1.3.3.1.3.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.1.3.3.2.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.3">subscript</csymbol><int id="S3.SS1.p3.1.m1.3.3.1.3.3.2.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.3.2.2"></int><ci id="S3.SS1.p3.1.m1.3.3.1.3.3.2.3.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.3.2.3">𝜎</ci></apply><apply id="S3.SS1.p3.1.m1.3.3.1.3.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.1.3.3.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p3.1.m1.3.3.1.3.3.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.3.3.2">𝜎</ci><ci id="S3.SS1.p3.1.m1.3.3.1.3.3.3.3a.cmml" xref="S3.SS1.p3.1.m1.3.3.1.3.3.3.3"><mtext id="S3.SS1.p3.1.m1.3.3.1.3.3.3.3.cmml" mathsize="50%" xref="S3.SS1.p3.1.m1.3.3.1.3.3.3.3">min</mtext></ci></apply></apply></apply><apply id="S3.SS1.p3.1.m1.3.3.1.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1"><times id="S3.SS1.p3.1.m1.3.3.1.1.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.2"></times><ci id="S3.SS1.p3.1.m1.3.3.1.1.3.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.3">𝛿</ci><apply id="S3.SS1.p3.1.m1.3.3.1.1.4.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.4"><apply id="S3.SS1.p3.1.m1.3.3.1.1.4.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.4.1"><ci id="S3.SS1.p3.1.m1.3.3.1.1.4.1.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.4.1.1">∇</ci><log id="S3.SS1.p3.1.m1.3.3.1.1.4.1.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.4.1.2"></log></apply><ci id="S3.SS1.p3.1.m1.3.3.1.1.4.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.4.2">𝑝</ci></apply><apply id="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.2">𝒙</ci><ci id="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.1.3">𝛿</ci></apply><ci id="S3.SS1.p3.1.m1.3.3.1.1.5a.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.5"><mtext id="S3.SS1.p3.1.m1.3.3.1.1.5.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.5">d</mtext></ci><ci id="S3.SS1.p3.1.m1.3.3.1.1.6.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.6">𝛿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.3c">G_{\bm{\phi}}(\bm{x},\sigma)\approx\bm{x}+\int_{\sigma}^{\sigma_{\text{min}}}-%
\delta\nabla\log p(\bm{x}\mid\delta)\textrm{d}\delta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.3d">italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_x , italic_σ ) ≈ bold_italic_x + ∫ start_POSTSUBSCRIPT italic_σ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_σ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT end_POSTSUPERSCRIPT - italic_δ ∇ roman_log italic_p ( bold_italic_x ∣ italic_δ ) d italic_δ</annotation></semantics></math> (like other data-prediction distillation methods <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib57" title="">2023</a>)</cite>), learning this integral for any small set <math alttext="\{\sigma_{i}\}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.2.cmml"><mo id="S3.SS1.p3.2.m2.1.1.1.2" stretchy="false" xref="S3.SS1.p3.2.m2.1.1.2.cmml">{</mo><msub id="S3.SS1.p3.2.m2.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.2" xref="S3.SS1.p3.2.m2.1.1.1.1.2.cmml">σ</mi><mi id="S3.SS1.p3.2.m2.1.1.1.1.3" xref="S3.SS1.p3.2.m2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p3.2.m2.1.1.1.3" stretchy="false" xref="S3.SS1.p3.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><set id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1"><apply id="S3.SS1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.2">𝜎</ci><ci id="S3.SS1.p3.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\{\sigma_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">{ italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> restricts the generator’s modeling capacity.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Presto-S: Score-based Distribution Matching Distillation</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Given the new notation, we proceed to develop our <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.1.1">score-based</em> distribution matching step distillation, <span class="ltx_text ltx_font_bold" id="S3.SS2.p1.1.2">Presto-S</span>. Our algorithm is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">1</span></a>, in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#alg1" title="Algorithm 1 ‣ A.3 Presto-S Algorithm ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">1</span></a>, and discussed below.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Continuous-Time Generator Inputs</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.4">In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS1" title="3.1 EDM-Style Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">3.1</span></a>, the noise level and/or timestep is sampled from a <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS1.p1.4.1">discrete</em>, hand-chosen set <math alttext="\{\sigma_{i}\}_{\text{gen}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><msub id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2.cmml">σ</mi><mi id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.2.cmml">}</mo></mrow><mtext id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3a.cmml">gen</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><set id="S3.SS2.SSS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3a.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3"><mtext id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS1.p1.1.m1.1.1.3">gen</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">\{\sigma_{i}\}_{\text{gen}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">{ italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT</annotation></semantics></math>.
Discretizing inputs, however, forces the model to 1) be a function of a specific <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS1.p1.4.2">number</em> of steps, requiring users to retrain separate models for each desired step budget <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib64" title="">2024</a>; Kohler et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib28" title="">2024</a>)</cite> and 2) be a function of <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS1.p1.4.3">specific</em> noise levels, which may not be optimally aligned with where different structural, semantic, and perceptual features arise in the diffusion process <cite class="ltx_cite ltx_citemacro_citep">(Si et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib53" title="">2024</a>; Kynkäänniemi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib30" title="">2024</a>; Balaji et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib4" title="">2022</a>; Sabour et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib46" title="">2024</a>)</cite>.
When extending to continuous-time models, we train the distilled generator <math alttext="G_{\bm{\phi}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><msub id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="S3.SS2.SSS1.p1.2.m2.1.1.3" mathvariant="bold-italic" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><apply id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2">𝐺</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">G_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> as a function of the continuous noise level sampled from the <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS1.p1.4.4">distribution</em> <math alttext="\sigma\sim p(\sigma)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mrow id="S3.SS2.SSS1.p1.3.m3.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.2.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.2.2" xref="S3.SS2.SSS1.p1.3.m3.1.2.2.cmml">σ</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.2.1" xref="S3.SS2.SSS1.p1.3.m3.1.2.1.cmml">∼</mo><mrow id="S3.SS2.SSS1.p1.3.m3.1.2.3" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.2.3.2" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.2.cmml">p</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.2.3.1" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.3.m3.1.2.3.3.2" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.cmml"><mo id="S3.SS2.SSS1.p1.3.m3.1.2.3.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.cmml">(</mo><mi id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml">σ</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.2.3.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2"><csymbol cd="latexml" id="S3.SS2.SSS1.p1.3.m3.1.2.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.1">similar-to</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.2.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.2">𝜎</ci><apply id="S3.SS2.SSS1.p1.3.m3.1.2.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.3"><times id="S3.SS2.SSS1.p1.3.m3.1.2.3.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.1"></times><ci id="S3.SS2.SSS1.p1.3.m3.1.2.3.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.2">𝑝</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">𝜎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">\sigma\sim p(\sigma)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">italic_σ ∼ italic_p ( italic_σ )</annotation></semantics></math>.
This allows our generator to both adapt better to variable budgets and to variable noise levels, as the generator can be trained with all noise levels sampled from <math alttext="p(\sigma)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m4.1"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><mrow id="S3.SS2.SSS1.p1.4.m4.1.2" xref="S3.SS2.SSS1.p1.4.m4.1.2.cmml"><mi id="S3.SS2.SSS1.p1.4.m4.1.2.2" xref="S3.SS2.SSS1.p1.4.m4.1.2.2.cmml">p</mi><mo id="S3.SS2.SSS1.p1.4.m4.1.2.1" xref="S3.SS2.SSS1.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.4.m4.1.2.3.2" xref="S3.SS2.SSS1.p1.4.m4.1.2.cmml"><mo id="S3.SS2.SSS1.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p1.4.m4.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml">σ</mi><mo id="S3.SS2.SSS1.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><apply id="S3.SS2.SSS1.p1.4.m4.1.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.2"><times id="S3.SS2.SSS1.p1.4.m4.1.2.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.2.1"></times><ci id="S3.SS2.SSS1.p1.4.m4.1.2.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.2.2">𝑝</ci><ci id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">p(\sigma)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">italic_p ( italic_σ )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Perceptual Loss Weighting with Variable Noise Distributions</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.5">A key difference between discrete-time and continuous-time diffusion models is the need for <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.p1.5.1">discretization</em> of the noise process during inference.
In discrete models, a single noise schedule defines a particular mapping between timestep <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mi id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><ci id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_t</annotation></semantics></math> and its noise level <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">italic_σ</annotation></semantics></math>, and is fixed throughout training and inference.
In continuous-time EDM models, however, we use a noise <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.p1.5.2">distribution</em> <math alttext="p(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.1"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><mrow id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml">p</mi><mo id="S3.SS2.SSS2.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.3.m3.1.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2.cmml">σ</mi><mtext id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1"><times id="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.2"></times><ci id="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.3">𝑝</ci><apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3"><mtext id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">p(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.1d">italic_p ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math> to sample during training, and a separate noise distribution for inference <math alttext="p(\sigma^{\text{inf}})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.4.m4.1"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><mrow id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p1.4.m4.1.1.3" xref="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml">p</mi><mo id="S3.SS2.SSS2.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.4.m4.1.1.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.2.cmml">σ</mi><mtext id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3a.cmml">inf</mtext></msup><mo id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><apply id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1"><times id="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.2"></times><ci id="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.3">𝑝</ci><apply id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3"><mtext id="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.4.m4.1.1.1.1.1.3">inf</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">p(\sigma^{\text{inf}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m4.1d">italic_p ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT )</annotation></semantics></math> that is discretized to define the sampling schedule.
In particular, when viewed in terms of the <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.p1.5.3">signal-to-noise ratio</em> <math alttext="1/\sigma^{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.5.m5.1"><semantics id="S3.SS2.SSS2.p1.5.m5.1a"><mrow id="S3.SS2.SSS2.p1.5.m5.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.cmml"><mn id="S3.SS2.SSS2.p1.5.m5.1.1.2" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml">1</mn><mo id="S3.SS2.SSS2.p1.5.m5.1.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.1.cmml">/</mo><msup id="S3.SS2.SSS2.p1.5.m5.1.1.3" xref="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.5.m5.1.1.3.2" xref="S3.SS2.SSS2.p1.5.m5.1.1.3.2.cmml">σ</mi><mn id="S3.SS2.SSS2.p1.5.m5.1.1.3.3" xref="S3.SS2.SSS2.p1.5.m5.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.5.m5.1b"><apply id="S3.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1"><divide id="S3.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.1"></divide><cn id="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml" type="integer" xref="S3.SS2.SSS2.p1.5.m5.1.1.2">1</cn><apply id="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.3.2">𝜎</ci><cn id="S3.SS2.SSS2.p1.5.m5.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.5.m5.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.5.m5.1c">1/\sigma^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.5.m5.1d">1 / italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> or SNR as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.F2" title="Figure 2 ‣ 3.2.2 Perceptual Loss Weighting with Variable Noise Distributions ‣ 3.2 Presto-S: Score-based Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">2</span></a>, the <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.p1.5.4">training</em> noise distribution puts the majority of its mass in the mid-to-high SNR range of the diffusion process. This design choice focuses on semantic and perceptual features, while the <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.p1.5.5">inference</em> noise distribution is more evenly distributed but with a bias towards the low-SNR region, giving a bias to low-frequency features.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="549" id="S3.F2.g1" src="x2.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Training/Inference distributions for EDM models, in decibel SNR space.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.4">However, recall that <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.p2.4.1">every</em> loss term including (<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.E5" title="In 3.1 EDM-Style Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">5</span></a>), (<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.E6" title="In 3.1 EDM-Style Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">6</span></a>), and (<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.E7" title="In 3.1 EDM-Style Distribution Matching Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">7</span></a>) requires an additional re-corruption process that must follow a noise distribution, significantly expanding the design space for score-based models.
Thus, we disentangle these forward diffusion processes and replace the shared discrete noise set with four <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.p2.4.2">separate noise distributions</em> <math alttext="p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.1.m1.1"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><msub id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p2.1.m1.1.1.3" mathcolor="#C00000" xref="S3.SS2.SSS2.p2.1.m1.1.1.3a.cmml">gen</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><apply id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2">𝑝</ci><ci id="S3.SS2.SSS2.p2.1.m1.1.1.3a.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3"><mtext id="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml" mathcolor="#C00000" mathsize="70%" xref="S3.SS2.SSS2.p2.1.m1.1.1.3">gen</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.1.m1.1d">italic_p start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.2.m2.1"><semantics id="S3.SS2.SSS2.p2.2.m2.1a"><msub id="S3.SS2.SSS2.p2.2.m2.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p2.2.m2.1.1.2" xref="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p2.2.m2.1.1.3" mathcolor="#FBBD00" xref="S3.SS2.SSS2.p2.2.m2.1.1.3a.cmml">DMD</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m2.1b"><apply id="S3.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.2">𝑝</ci><ci id="S3.SS2.SSS2.p2.2.m2.1.1.3a.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.3"><mtext id="S3.SS2.SSS2.p2.2.m2.1.1.3.cmml" mathcolor="#FBBD00" mathsize="70%" xref="S3.SS2.SSS2.p2.2.m2.1.1.3">DMD</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m2.1c">p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.2.m2.1d">italic_p start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.3.m3.1"><semantics id="S3.SS2.SSS2.p2.3.m3.1a"><msub id="S3.SS2.SSS2.p2.3.m3.1.1" xref="S3.SS2.SSS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p2.3.m3.1.1.2" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p2.3.m3.1.1.3" mathcolor="#2E5F7F" xref="S3.SS2.SSS2.p2.3.m3.1.1.3a.cmml">DSM</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.3.m3.1b"><apply id="S3.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.2">𝑝</ci><ci id="S3.SS2.SSS2.p2.3.m3.1.1.3a.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.3"><mtext id="S3.SS2.SSS2.p2.3.m3.1.1.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="S3.SS2.SSS2.p2.3.m3.1.1.3">DSM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.3.m3.1c">p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.3.m3.1d">italic_p start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.4.m4.1"><semantics id="S3.SS2.SSS2.p2.4.m4.1a"><msub id="S3.SS2.SSS2.p2.4.m4.1.1" xref="S3.SS2.SSS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p2.4.m4.1.1.2" xref="S3.SS2.SSS2.p2.4.m4.1.1.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p2.4.m4.1.1.3" mathcolor="#92D050" xref="S3.SS2.SSS2.p2.4.m4.1.1.3a.cmml">GAN</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.4.m4.1b"><apply id="S3.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.2">𝑝</ci><ci id="S3.SS2.SSS2.p2.4.m4.1.1.3a.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.3"><mtext id="S3.SS2.SSS2.p2.4.m4.1.1.3.cmml" mathcolor="#92D050" mathsize="70%" xref="S3.SS2.SSS2.p2.4.m4.1.1.3">GAN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.4.m4.1c">p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.4.m4.1d">italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math>, corresponding to the inputs to the generator and each loss term respectively, with no restrictions on how each weights each noise level
(rather than forcing a particular noise weighting for all computation).</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p3">
<p class="ltx_p" id="S3.SS2.SSS2.p3.2">Then, if we apply the original DMD2 method naively to the EDM-style of score-models, we get <math alttext="p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}(\sigma^{\text{inf}})=p_{\text{{\color[rgb]{%
0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}DMD}}}(\sigma^{\text{inf}})=p_{\text{{\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{inf}})=p_{\text{{\color[%
rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{inf}})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.1.m1.4"><semantics id="S3.SS2.SSS2.p3.1.m1.4a"><mrow id="S3.SS2.SSS2.p3.1.m1.4.4" xref="S3.SS2.SSS2.p3.1.m1.4.4.cmml"><mrow id="S3.SS2.SSS2.p3.1.m1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.cmml"><msub id="S3.SS2.SSS2.p3.1.m1.1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.3" mathcolor="#C00000" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.3a.cmml">gen</mtext></msub><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.2.cmml">σ</mi><mtext id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.3a.cmml">inf</mtext></msup><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p3.1.m1.4.4.6" xref="S3.SS2.SSS2.p3.1.m1.4.4.6.cmml">=</mo><mrow id="S3.SS2.SSS2.p3.1.m1.2.2.2" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.cmml"><msub id="S3.SS2.SSS2.p3.1.m1.2.2.2.3" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.2.2.2.3.2" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.3.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p3.1.m1.2.2.2.3.3" mathcolor="#FBBD00" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.3.3a.cmml">DMD</mtext></msub><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.2" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.cmml"><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.2.cmml">σ</mi><mtext id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.3a.cmml">inf</mtext></msup><mo id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p3.1.m1.4.4.7" xref="S3.SS2.SSS2.p3.1.m1.4.4.7.cmml">=</mo><mrow id="S3.SS2.SSS2.p3.1.m1.3.3.3" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.cmml"><msub id="S3.SS2.SSS2.p3.1.m1.3.3.3.3" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.3.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.3.3.3.3.2" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.3.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p3.1.m1.3.3.3.3.3" mathcolor="#2E5F7F" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.3.3a.cmml">DSM</mtext></msub><mo id="S3.SS2.SSS2.p3.1.m1.3.3.3.2" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.cmml"><mo id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.2.cmml">σ</mi><mtext id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.3a.cmml">inf</mtext></msup><mo id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p3.1.m1.4.4.8" xref="S3.SS2.SSS2.p3.1.m1.4.4.8.cmml">=</mo><mrow id="S3.SS2.SSS2.p3.1.m1.4.4.4" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.cmml"><msub id="S3.SS2.SSS2.p3.1.m1.4.4.4.3" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.3.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.4.4.4.3.2" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.3.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p3.1.m1.4.4.4.3.3" mathcolor="#92D050" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.3.3a.cmml">GAN</mtext></msub><mo id="S3.SS2.SSS2.p3.1.m1.4.4.4.2" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.cmml"><mo id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.2.cmml">σ</mi><mtext id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.3a.cmml">inf</mtext></msup><mo id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.1.m1.4b"><apply id="S3.SS2.SSS2.p3.1.m1.4.4.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4"><and id="S3.SS2.SSS2.p3.1.m1.4.4a.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4"></and><apply id="S3.SS2.SSS2.p3.1.m1.4.4b.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4"><eq id="S3.SS2.SSS2.p3.1.m1.4.4.6.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.6"></eq><apply id="S3.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1"><times id="S3.SS2.SSS2.p3.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.2"></times><apply id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.3a.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.3"><mtext id="S3.SS2.SSS2.p3.1.m1.1.1.1.3.3.cmml" mathcolor="#C00000" mathsize="70%" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.3.3">gen</mtext></ci></apply><apply id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.3"><mtext id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.3">inf</mtext></ci></apply></apply><apply id="S3.SS2.SSS2.p3.1.m1.2.2.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2"><times id="S3.SS2.SSS2.p3.1.m1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.2"></times><apply id="S3.SS2.SSS2.p3.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.2.2.2.3.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.3.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.3.3a.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.3.3"><mtext id="S3.SS2.SSS2.p3.1.m1.2.2.2.3.3.cmml" mathcolor="#FBBD00" mathsize="70%" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.3.3">DMD</mtext></ci></apply><apply id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.3"><mtext id="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p3.1.m1.2.2.2.1.1.1.3">inf</mtext></ci></apply></apply></apply><apply id="S3.SS2.SSS2.p3.1.m1.4.4c.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4"><eq id="S3.SS2.SSS2.p3.1.m1.4.4.7.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.7"></eq><share href="https://arxiv.org/html/2410.05167v1#S3.SS2.SSS2.p3.1.m1.2.2.2.cmml" id="S3.SS2.SSS2.p3.1.m1.4.4d.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4"></share><apply id="S3.SS2.SSS2.p3.1.m1.3.3.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.3.3.3"><times id="S3.SS2.SSS2.p3.1.m1.3.3.3.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.2"></times><apply id="S3.SS2.SSS2.p3.1.m1.3.3.3.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.3.3.3.3.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.3.3.3.3.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p3.1.m1.3.3.3.3.3a.cmml" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.3.3"><mtext id="S3.SS2.SSS2.p3.1.m1.3.3.3.3.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.3.3">DSM</mtext></ci></apply><apply id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.3"><mtext id="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p3.1.m1.3.3.3.1.1.1.3">inf</mtext></ci></apply></apply></apply><apply id="S3.SS2.SSS2.p3.1.m1.4.4e.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4"><eq id="S3.SS2.SSS2.p3.1.m1.4.4.8.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.8"></eq><share href="https://arxiv.org/html/2410.05167v1#S3.SS2.SSS2.p3.1.m1.3.3.3.cmml" id="S3.SS2.SSS2.p3.1.m1.4.4f.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4"></share><apply id="S3.SS2.SSS2.p3.1.m1.4.4.4.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.4"><times id="S3.SS2.SSS2.p3.1.m1.4.4.4.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.2"></times><apply id="S3.SS2.SSS2.p3.1.m1.4.4.4.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.4.4.4.3.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.4.4.4.3.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p3.1.m1.4.4.4.3.3a.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.3.3"><mtext id="S3.SS2.SSS2.p3.1.m1.4.4.4.3.3.cmml" mathcolor="#92D050" mathsize="70%" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.3.3">GAN</mtext></ci></apply><apply id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.3"><mtext id="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p3.1.m1.4.4.4.1.1.1.3">inf</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.1.m1.4c">p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}(\sigma^{\text{inf}})=p_{\text{{\color[rgb]{%
0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}DMD}}}(\sigma^{\text{inf}})=p_{\text{{\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{inf}})=p_{\text{{\color[%
rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{inf}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.1.m1.4d">italic_p start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT ) = italic_p start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT ) = italic_p start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT ) = italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT )</annotation></semantics></math>.
This choice of <math alttext="p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}(\sigma^{\text{inf}})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.2.m2.1"><semantics id="S3.SS2.SSS2.p3.2.m2.1a"><mrow id="S3.SS2.SSS2.p3.2.m2.1.1" xref="S3.SS2.SSS2.p3.2.m2.1.1.cmml"><msub id="S3.SS2.SSS2.p3.2.m2.1.1.3" xref="S3.SS2.SSS2.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS2.p3.2.m2.1.1.3.2" xref="S3.SS2.SSS2.p3.2.m2.1.1.3.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p3.2.m2.1.1.3.3" mathcolor="#C00000" xref="S3.SS2.SSS2.p3.2.m2.1.1.3.3a.cmml">gen</mtext></msub><mo id="S3.SS2.SSS2.p3.2.m2.1.1.2" xref="S3.SS2.SSS2.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p3.2.m2.1.1.1.1" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.2.cmml">σ</mi><mtext id="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.3a.cmml">inf</mtext></msup><mo id="S3.SS2.SSS2.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.2.m2.1b"><apply id="S3.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1"><times id="S3.SS2.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.2"></times><apply id="S3.SS2.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p3.2.m2.1.1.3.3a.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.3.3"><mtext id="S3.SS2.SSS2.p3.2.m2.1.1.3.3.cmml" mathcolor="#C00000" mathsize="70%" xref="S3.SS2.SSS2.p3.2.m2.1.1.3.3">gen</mtext></ci></apply><apply id="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.3"><mtext id="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p3.2.m2.1.1.1.1.1.3">inf</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.2.m2.1c">p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}(\sigma^{\text{inf}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.2.m2.1d">italic_p start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT )</annotation></semantics></math> reasonably aligns the generator inputs during distillation to the inference process itself, but each loss noise distribution is somewhat misaligned from its role in the distillation process.
In particular:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><math alttext="p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.1"><semantics id="S3.I1.i1.p1.1.m1.1a"><msub id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml"><mi id="S3.I1.i1.p1.1.m1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.2.cmml">p</mi><mtext id="S3.I1.i1.p1.1.m1.1.1.3" mathcolor="#FBBD00" xref="S3.I1.i1.p1.1.m1.1.1.3a.cmml">DMD</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><apply id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2">𝑝</ci><ci id="S3.I1.i1.p1.1.m1.1.1.3a.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3"><mtext id="S3.I1.i1.p1.1.m1.1.1.3.cmml" mathcolor="#FBBD00" mathsize="70%" xref="S3.I1.i1.p1.1.m1.1.1.3">DMD</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.1d">italic_p start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT</annotation></semantics></math>: The distribution matching gradient is the only point that the generator gets a signal from the <em class="ltx_emph ltx_font_italic" id="S3.I1.i1.p1.1.1">CFG-augmented</em> outputs of the teacher. CFG is critical for text following, but <em class="ltx_emph ltx_font_italic" id="S3.I1.i1.p1.1.2">primarily</em> within the mid-to-high SNR region of the noise <cite class="ltx_cite ltx_citemacro_citep">(Kynkäänniemi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib30" title="">2024</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><math alttext="p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><msub id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml">p</mi><mtext id="S3.I1.i2.p1.1.m1.1.1.3" mathcolor="#92D050" xref="S3.I1.i2.p1.1.m1.1.1.3a.cmml">GAN</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">𝑝</ci><ci id="S3.I1.i2.p1.1.m1.1.1.3a.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3"><mtext id="S3.I1.i2.p1.1.m1.1.1.3.cmml" mathcolor="#92D050" mathsize="70%" xref="S3.I1.i2.p1.1.m1.1.1.3">GAN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math>: As in most adversarial distillation methods <cite class="ltx_cite ltx_citemacro_citep">(Sauer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib49" title="">2023</a>; Yin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib63" title="">2023</a>)</cite>, the adversarial loss’s main strength is to increase the perceptual <em class="ltx_emph ltx_font_italic" id="S3.I1.i2.p1.1.1">realism/quality</em> of the outputs, which arise in the mid-to-high SNR regions, rather than structural elements.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><math alttext="p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.1.m1.1"><semantics id="S3.I1.i3.p1.1.m1.1a"><msub id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.2.cmml">p</mi><mtext id="S3.I1.i3.p1.1.m1.1.1.3" mathcolor="#2E5F7F" xref="S3.I1.i3.p1.1.m1.1.1.3a.cmml">DSM</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><apply id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2">𝑝</ci><ci id="S3.I1.i3.p1.1.m1.1.1.3a.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3"><mtext id="S3.I1.i3.p1.1.m1.1.1.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="S3.I1.i3.p1.1.m1.1.1.3">DSM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.1.m1.1d">italic_p start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT</annotation></semantics></math>: The score model training should in theory mimic standard diffusion training, and may benefit from the training distribution’s provably faster convergence <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib60" title="">2024b</a>)</cite> (as the fake score model is updated <em class="ltx_emph ltx_font_italic" id="S3.I1.i3.p1.1.1">online</em> to track the generator’s distribution).</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S3.SS2.SSS2.p3.4">Thus, we shift all of the above terms to use the training distribution <math alttext="p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}(\sigma^{\text{train}}),p_{\text{{\color[rgb]%
{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.3.m1.2"><semantics id="S3.SS2.SSS2.p3.3.m1.2a"><mrow id="S3.SS2.SSS2.p3.3.m1.2.2.2" xref="S3.SS2.SSS2.p3.3.m1.2.2.3.cmml"><mrow id="S3.SS2.SSS2.p3.3.m1.1.1.1.1" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.cmml"><msub id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.2" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.3" mathcolor="#FBBD00" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.3a.cmml">DMD</mtext></msub><mo id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.2.cmml">σ</mi><mtext id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p3.3.m1.2.2.2.3" xref="S3.SS2.SSS2.p3.3.m1.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS2.p3.3.m1.2.2.2.2" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.cmml"><msub id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.2" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.3" mathcolor="#2E5F7F" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.3a.cmml">DSM</mtext></msub><mo id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.2" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.2" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.2.cmml">σ</mi><mtext id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.3" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.3a.cmml">train</mtext></msup><mo id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.3.m1.2b"><list id="S3.SS2.SSS2.p3.3.m1.2.2.3.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2"><apply id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1"><times id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.2"></times><apply id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.3a.cmml" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.3"><mtext id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.3.cmml" mathcolor="#FBBD00" mathsize="70%" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.3.3">DMD</mtext></ci></apply><apply id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.3"><mtext id="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p3.3.m1.1.1.1.1.1.1.1.3">train</mtext></ci></apply></apply><apply id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2"><times id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.2"></times><apply id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.1.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.2.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.3a.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.3"><mtext id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.3.3">DSM</mtext></ci></apply><apply id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.3"><mtext id="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p3.3.m1.2.2.2.2.1.1.1.3">train</mtext></ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.3.m1.2c">p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}(\sigma^{\text{train}}),p_{\text{{\color[rgb]%
{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.3.m1.2d">italic_p start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT ) , italic_p start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math> and <math alttext="p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.4.m2.1"><semantics id="S3.SS2.SSS2.p3.4.m2.1a"><mrow id="S3.SS2.SSS2.p3.4.m2.1.1" xref="S3.SS2.SSS2.p3.4.m2.1.1.cmml"><msub id="S3.SS2.SSS2.p3.4.m2.1.1.3" xref="S3.SS2.SSS2.p3.4.m2.1.1.3.cmml"><mi id="S3.SS2.SSS2.p3.4.m2.1.1.3.2" xref="S3.SS2.SSS2.p3.4.m2.1.1.3.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p3.4.m2.1.1.3.3" mathcolor="#92D050" xref="S3.SS2.SSS2.p3.4.m2.1.1.3.3a.cmml">GAN</mtext></msub><mo id="S3.SS2.SSS2.p3.4.m2.1.1.2" xref="S3.SS2.SSS2.p3.4.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p3.4.m2.1.1.1.1" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p3.4.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.cmml">(</mo><msup id="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.2.cmml">σ</mi><mtext id="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S3.SS2.SSS2.p3.4.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.4.m2.1b"><apply id="S3.SS2.SSS2.p3.4.m2.1.1.cmml" xref="S3.SS2.SSS2.p3.4.m2.1.1"><times id="S3.SS2.SSS2.p3.4.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p3.4.m2.1.1.2"></times><apply id="S3.SS2.SSS2.p3.4.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p3.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.4.m2.1.1.3.1.cmml" xref="S3.SS2.SSS2.p3.4.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.4.m2.1.1.3.2.cmml" xref="S3.SS2.SSS2.p3.4.m2.1.1.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p3.4.m2.1.1.3.3a.cmml" xref="S3.SS2.SSS2.p3.4.m2.1.1.3.3"><mtext id="S3.SS2.SSS2.p3.4.m2.1.1.3.3.cmml" mathcolor="#92D050" mathsize="70%" xref="S3.SS2.SSS2.p3.4.m2.1.1.3.3">GAN</mtext></ci></apply><apply id="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.3"><mtext id="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p3.4.m2.1.1.1.1.1.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.4.m2.1c">p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.4.m2.1d">italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>
to force the distillation process to focus on perceptually relevant noise regions.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Audio-Aligned Discriminator Design</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.2">The original DMD2 uses a classic non-saturating GAN loss. The discriminator is a series of convolutional blocks downsampling the intermediate features into a <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS3.p1.2.1">single</em> probability for real vs. fake. While this approach is standard in image-domain applications, many recent adversarial waveform synthesis works <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib29" title="">2023</a>; Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib68" title="">2024</a>)</cite> use a <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS3.p1.2.2">Least-Squares</em> GAN loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\arg\min_{\bm{\phi}}\max_{\bm{\psi}}\mathbb{E}_{\begin{subarray}{c}\sigma\sim p%
_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}}%
),\\
\epsilon\sim\mathcal{N}(0,\bm{I})\end{subarray}}[\|D_{\bm{\psi}}(\bm{x}_{\text%
{real}}+\sigma\epsilon,\sigma)\|_{2}^{2}]+\mathbb{E}_{\begin{subarray}{c}%
\sigma\sim p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[%
named]{pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{%
train}}),\\
\epsilon\sim\mathcal{N}(0,\bm{I})\end{subarray}}[\|1-D_{\bm{\psi}}(\hat{\bm{x}%
}_{\text{gen}}+\sigma\epsilon,\sigma)\|_{2}^{2}]," class="ltx_Math" display="block" id="S3.E8.m1.5"><semantics id="S3.E8.m1.5a"><mrow id="S3.E8.m1.5.5.1" xref="S3.E8.m1.5.5.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1" xref="S3.E8.m1.5.5.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1.1" xref="S3.E8.m1.5.5.1.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.1.3.1" xref="S3.E8.m1.5.5.1.1.1.3.1.cmml">arg</mi><mo id="S3.E8.m1.5.5.1.1.1.3a" lspace="0.167em" xref="S3.E8.m1.5.5.1.1.1.3.cmml">⁡</mo><mrow id="S3.E8.m1.5.5.1.1.1.3.2" xref="S3.E8.m1.5.5.1.1.1.3.2.cmml"><munder id="S3.E8.m1.5.5.1.1.1.3.2.1" xref="S3.E8.m1.5.5.1.1.1.3.2.1.cmml"><mi id="S3.E8.m1.5.5.1.1.1.3.2.1.2" xref="S3.E8.m1.5.5.1.1.1.3.2.1.2.cmml">min</mi><mi class="ltx_mathvariant_bold-italic" id="S3.E8.m1.5.5.1.1.1.3.2.1.3" mathvariant="bold-italic" xref="S3.E8.m1.5.5.1.1.1.3.2.1.3.cmml">ϕ</mi></munder><mo id="S3.E8.m1.5.5.1.1.1.3.2a" lspace="0.167em" xref="S3.E8.m1.5.5.1.1.1.3.2.cmml">⁡</mo><mrow id="S3.E8.m1.5.5.1.1.1.3.2.2" xref="S3.E8.m1.5.5.1.1.1.3.2.2.cmml"><munder id="S3.E8.m1.5.5.1.1.1.3.2.2.1" xref="S3.E8.m1.5.5.1.1.1.3.2.2.1.cmml"><mi id="S3.E8.m1.5.5.1.1.1.3.2.2.1.2" xref="S3.E8.m1.5.5.1.1.1.3.2.2.1.2.cmml">max</mi><mi id="S3.E8.m1.5.5.1.1.1.3.2.2.1.3" xref="S3.E8.m1.5.5.1.1.1.3.2.2.1.3.cmml">𝝍</mi></munder><mo id="S3.E8.m1.5.5.1.1.1.3.2.2a" lspace="0.167em" xref="S3.E8.m1.5.5.1.1.1.3.2.2.cmml">⁡</mo><msub id="S3.E8.m1.5.5.1.1.1.3.2.2.2" xref="S3.E8.m1.5.5.1.1.1.3.2.2.2.cmml"><mi id="S3.E8.m1.5.5.1.1.1.3.2.2.2.2" xref="S3.E8.m1.5.5.1.1.1.3.2.2.2.2.cmml">𝔼</mi><mtable id="S3.E8.m1.1.1.1.1.1.1" rowspacing="0pt" xref="S3.E8.m1.1.1.1.2.cmml"><mtr id="S3.E8.m1.1.1.1.1.1.1a" xref="S3.E8.m1.1.1.1.2.cmml"><mtd id="S3.E8.m1.1.1.1.1.1.1b" xref="S3.E8.m1.1.1.1.2.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">∼</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mtext id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" mathcolor="#92D050" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml">GAN</mtext></msub><mo id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">σ</mi><mtext id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E8.m1.1.1.1.1.1.1c" xref="S3.E8.m1.1.1.1.2.cmml"><mtd id="S3.E8.m1.1.1.1.1.1.1d" xref="S3.E8.m1.1.1.1.2.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.4" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.4.cmml">ϵ</mi><mo id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.3.cmml">∼</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.2" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.2.cmml">𝒩</mi><mo id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.1" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.1.cmml">⁢</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.3.1.cmml"><mo id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.3.2.1" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.3.1.cmml">(</mo><mn id="S3.E8.m1.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.2.2.1.1.1.cmml">0</mn><mo id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.3.2.2" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.3.1.cmml">,</mo><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.2" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.2.cmml">𝑰</mi><mo id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.3.2.3" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.3.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable></msub></mrow></mrow></mrow><mo id="S3.E8.m1.5.5.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E8.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.5.5.1.1.1.1.2.1.cmml">[</mo><msubsup id="S3.E8.m1.5.5.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml">D</mi><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝝍</mi></msub><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mtext id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml">real</mtext></msub><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">σ</mi><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml">σ</mi><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E8.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E8.m1.5.5.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S3.E8.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E8.m1.5.5.1.1.3" xref="S3.E8.m1.5.5.1.1.3.cmml">+</mo><mrow id="S3.E8.m1.5.5.1.1.2" xref="S3.E8.m1.5.5.1.1.2.cmml"><msub id="S3.E8.m1.5.5.1.1.2.3" xref="S3.E8.m1.5.5.1.1.2.3.cmml"><mi id="S3.E8.m1.5.5.1.1.2.3.2" xref="S3.E8.m1.5.5.1.1.2.3.2.cmml">𝔼</mi><mtable id="S3.E8.m1.2.2.1.1.1.1" rowspacing="0pt" xref="S3.E8.m1.2.2.1.2.cmml"><mtr id="S3.E8.m1.2.2.1.1.1.1a" xref="S3.E8.m1.2.2.1.2.cmml"><mtd id="S3.E8.m1.2.2.1.1.1.1b" xref="S3.E8.m1.2.2.1.2.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">∼</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mtext id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" mathcolor="#92D050" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml">GAN</mtext></msub><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">σ</mi><mtext id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E8.m1.2.2.1.1.1.1c" xref="S3.E8.m1.2.2.1.2.cmml"><mtd id="S3.E8.m1.2.2.1.1.1.1d" xref="S3.E8.m1.2.2.1.2.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.4" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.4.cmml">ϵ</mi><mo id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.3" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.3.cmml">∼</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.2" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.2.cmml">𝒩</mi><mo id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.1" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.1.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.3.2" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.3.1.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.3.2.1" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.3.1.cmml">(</mo><mn id="S3.E8.m1.2.2.1.1.1.1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.2.2.1.1.1.cmml">0</mn><mo id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.3.2.2" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.3.1.cmml">,</mo><mi id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.2" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.2.cmml">𝑰</mi><mo id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.3.2.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.3.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable></msub><mo id="S3.E8.m1.5.5.1.1.2.2" xref="S3.E8.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S3.E8.m1.5.5.1.1.2.1.1" xref="S3.E8.m1.5.5.1.1.2.1.2.cmml"><mo id="S3.E8.m1.5.5.1.1.2.1.1.2" stretchy="false" xref="S3.E8.m1.5.5.1.1.2.1.2.1.cmml">[</mo><msubsup id="S3.E8.m1.5.5.1.1.2.1.1.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml"><mn id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.cmml">1</mn><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml">D</mi><mi id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml">𝝍</mi></msub><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒙</mi><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mtext id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml">gen</mtext></msub><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">σ</mi><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml">σ</mi><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E8.m1.5.5.1.1.2.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.3.cmml">2</mn><mn id="S3.E8.m1.5.5.1.1.2.1.1.1.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.3.cmml">2</mn></msubsup><mo id="S3.E8.m1.5.5.1.1.2.1.1.3" stretchy="false" xref="S3.E8.m1.5.5.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E8.m1.5.5.1.2" xref="S3.E8.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.5b"><apply id="S3.E8.m1.5.5.1.1.cmml" xref="S3.E8.m1.5.5.1"><plus id="S3.E8.m1.5.5.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.3"></plus><apply id="S3.E8.m1.5.5.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1"><times id="S3.E8.m1.5.5.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.2"></times><apply id="S3.E8.m1.5.5.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.3"><arg id="S3.E8.m1.5.5.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.1.3.1"></arg><apply id="S3.E8.m1.5.5.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2"><apply id="S3.E8.m1.5.5.1.1.1.3.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.3.2.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.1">subscript</csymbol><min id="S3.E8.m1.5.5.1.1.1.3.2.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.1.2"></min><ci id="S3.E8.m1.5.5.1.1.1.3.2.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.1.3">bold-italic-ϕ</ci></apply><apply id="S3.E8.m1.5.5.1.1.1.3.2.2.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.2"><apply id="S3.E8.m1.5.5.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.3.2.2.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.2.1">subscript</csymbol><max id="S3.E8.m1.5.5.1.1.1.3.2.2.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.2.1.2"></max><ci id="S3.E8.m1.5.5.1.1.1.3.2.2.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.2.1.3">𝝍</ci></apply><apply id="S3.E8.m1.5.5.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.3.2.2.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.1.3.2.2.2.2.cmml" xref="S3.E8.m1.5.5.1.1.1.3.2.2.2.2">𝔼</ci><list id="S3.E8.m1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><matrix id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><matrixrow id="S3.E8.m1.1.1.1.1.1.1a.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">similar-to</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><mtext id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" mathcolor="#92D050" mathsize="50%" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">GAN</mtext></ci></apply><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝜎</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="50%" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">train</mtext></ci></apply></apply></apply></matrixrow><matrixrow id="S3.E8.m1.1.1.1.1.1.1b.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><apply id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2"><csymbol cd="latexml" id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.3">similar-to</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.4.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.4">italic-ϵ</ci><apply id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5"><times id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.1"></times><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.2">𝒩</ci><interval closure="open" id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.5.3.2"><cn id="S3.E8.m1.1.1.1.1.1.1.2.2.1.1.1.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.1.1.2.2.1.1.1">0</cn><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.2.2">𝑰</ci></interval></apply></apply></matrixrow></matrix></list></apply></apply></apply></apply><apply id="S3.E8.m1.5.5.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1"><times id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2">𝐷</ci><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3">𝝍</ci></apply><interval closure="open" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><mtext id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">real</mtext></ci></apply><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝜎</ci><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">italic-ϵ</ci></apply></apply><ci id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3">𝜎</ci></interval></apply></apply><cn id="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S3.E8.m1.5.5.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="S3.E8.m1.5.5.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2"><times id="S3.E8.m1.5.5.1.1.2.2.cmml" xref="S3.E8.m1.5.5.1.1.2.2"></times><apply id="S3.E8.m1.5.5.1.1.2.3.cmml" xref="S3.E8.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.2.3.1.cmml" xref="S3.E8.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.2.3.2.cmml" xref="S3.E8.m1.5.5.1.1.2.3.2">𝔼</ci><list id="S3.E8.m1.2.2.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1"><matrix id="S3.E8.m1.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1"><matrixrow id="S3.E8.m1.2.2.1.1.1.1a.cmml" xref="S3.E8.m1.2.2.1.1.1.1"><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">similar-to</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3"><mtext id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" mathcolor="#92D050" mathsize="50%" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">GAN</mtext></ci></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝜎</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="50%" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">train</mtext></ci></apply></apply></apply></matrixrow><matrixrow id="S3.E8.m1.2.2.1.1.1.1b.cmml" xref="S3.E8.m1.2.2.1.1.1.1"><apply id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.3">similar-to</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.4.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.4">italic-ϵ</ci><apply id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5"><times id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.1"></times><ci id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.2">𝒩</ci><interval closure="open" id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.5.3.2"><cn id="S3.E8.m1.2.2.1.1.1.1.2.2.1.1.1.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.2.2.1.1.1">0</cn><ci id="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2.2.2">𝑰</ci></interval></apply></apply></matrixrow></matrix></list></apply><apply id="S3.E8.m1.5.5.1.1.2.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1"><csymbol cd="latexml" id="S3.E8.m1.5.5.1.1.2.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1">superscript</csymbol><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1">subscript</csymbol><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1"><minus id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.2"></minus><cn id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.3">1</cn><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1"><times id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.2">𝐷</ci><ci id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.3">𝝍</ci></apply><interval closure="open" id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1"><plus id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒙</ci></apply><ci id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3"><mtext id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3">gen</mtext></ci></apply><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝜎</ci><ci id="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.3">italic-ϵ</ci></apply></apply><ci id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4">𝜎</ci></interval></apply></apply></apply><cn id="S3.E8.m1.5.5.1.1.2.1.1.1.1.3.cmml" type="integer" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.3">2</cn></apply><cn id="S3.E8.m1.5.5.1.1.2.1.1.1.3.cmml" type="integer" xref="S3.E8.m1.5.5.1.1.2.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.5c">\arg\min_{\bm{\phi}}\max_{\bm{\psi}}\mathbb{E}_{\begin{subarray}{c}\sigma\sim p%
_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}}%
),\\
\epsilon\sim\mathcal{N}(0,\bm{I})\end{subarray}}[\|D_{\bm{\psi}}(\bm{x}_{\text%
{real}}+\sigma\epsilon,\sigma)\|_{2}^{2}]+\mathbb{E}_{\begin{subarray}{c}%
\sigma\sim p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[%
named]{pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{%
train}}),\\
\epsilon\sim\mathcal{N}(0,\bm{I})\end{subarray}}[\|1-D_{\bm{\psi}}(\hat{\bm{x}%
}_{\text{gen}}+\sigma\epsilon,\sigma)\|_{2}^{2}],</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.5d">roman_arg roman_min start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT roman_max start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT start_ARG start_ROW start_CELL italic_σ ∼ italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT ) , end_CELL end_ROW start_ROW start_CELL italic_ϵ ∼ caligraphic_N ( 0 , bold_italic_I ) end_CELL end_ROW end_ARG end_POSTSUBSCRIPT [ ∥ italic_D start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT + italic_σ italic_ϵ , italic_σ ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] + blackboard_E start_POSTSUBSCRIPT start_ARG start_ROW start_CELL italic_σ ∼ italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT ) , end_CELL end_ROW start_ROW start_CELL italic_ϵ ∼ caligraphic_N ( 0 , bold_italic_I ) end_CELL end_ROW end_ARG end_POSTSUBSCRIPT [ ∥ 1 - italic_D start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT + italic_σ italic_ϵ , italic_σ ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS3.p1.1">where the outputs of the discriminator <math alttext="D_{\bm{\psi}}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.1.m1.1"><semantics id="S3.SS2.SSS3.p1.1.m1.1a"><msub id="S3.SS2.SSS3.p1.1.m1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.1.1.2" xref="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml">D</mi><mi id="S3.SS2.SSS3.p1.1.m1.1.1.3" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml">𝝍</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.1b"><apply id="S3.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.2">𝐷</ci><ci id="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3">𝝍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.1c">D_{\bm{\psi}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.1.m1.1d">italic_D start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> are only <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS3.p1.1.1">partially</em> downsampled into a lower-resolution version of the input data (in this case, a latent 1-D tensor). This forces the discriminator to attend to more fine-grained, temporally-aligned features for determining realness, as the loss is averaged across the partially downsampled discriminator outputs. Hence, we use this style of discriminator for <span class="ltx_text ltx_font_bold" id="S3.SS2.SSS3.p1.1.2">Presto-S</span> to both improve and stabilize <cite class="ltx_cite ltx_citemacro_citep">(Mao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib37" title="">2017</a>)</cite> the GAN gradient into our generator.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Presto-L: Variance and Budget-Aware Layer Dropping</h3>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="165" id="S3.F3.1.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Baseline layer dropping (left) vs. <span class="ltx_text ltx_font_bold" id="S3.F3.6.1">Presto-L</span> (right). Standard layer dropping uses the noise level <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.F3.3.m1.1"><semantics id="S3.F3.3.m1.1b"><mi id="S3.F3.3.m1.1.1" xref="S3.F3.3.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.F3.3.m1.1c"><ci id="S3.F3.3.m1.1.1.cmml" xref="S3.F3.3.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.3.m1.1d">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.F3.3.m1.1e">italic_σ</annotation></semantics></math> to set the budget of layers to drop, starting from the back of the DiT blocks. <span class="ltx_text ltx_font_bold" id="S3.F3.7.2">Presto-L</span> shifts this dropping by one to the second-to-last block and adds explicit budget conditioning.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Given our step distillation approach above, we now seek methods to reduce the cost of individual <em class="ltx_emph ltx_font_italic" id="S3.SS3.p1.1.1">steps</em> themselves here through layer distillation, and then combine both step and layer distillation in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS4" title="3.4 Presto-LS: Layer-Step Distillation ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">3.4</span></a>.
We begin with the current SOTA method: ASE <cite class="ltx_cite ltx_citemacro_citep">(Moon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib38" title="">2024</a>)</cite>. ASE employs a fixed dropping schedule that monotonically maps noise levels to compute budgets, allocating more layers to lower noise levels. We enhance this method in three key ways: (1) ensuring consistent variance in layer distilled outputs, (2) implementing explicit budget conditioning, and (3) aligning layer-dropped outputs through direct distillation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.1">Variance Preservation</span>:
First, we inspect the within-layer activation variance of our base model in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.F4" title="Figure 4 ‣ 3.3 Presto-L: Variance and Budget-Aware Layer Dropping ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">4</span></a>. We find that while the variance predictably
increases over depth, it notably spikes <em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.1.2">on the last layer</em> up to an order of magnitude higher, indicating that the last layer behaves much differently as it is the direct input to the linear de-embedding layer.
ASE, however, always drops layers starting from the <em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.1.3">last</em> layer and working backwards, thus always removing this behavior.
Hence, we remedy this fact and <em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.1.4">shift</em> the layer dropping schedule by 1 to drop starting at the <em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.1.5">second</em> to last layer, always rerouting back into the final layer to preserve the final layer’s behavior.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="330" id="S3.F4.g1" src="x4.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Hidden activation variance vs. layer depth. Each line is a unique noise level.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p3.1.1">Budget Conditioning</span>:
We include <em class="ltx_emph ltx_font_italic" id="S3.SS3.p3.1.2">explicit</em> budget conditioning into the model itself so that the model can directly adapt computation to the budget level.
This conditioning comes in two places: (1) a global budget embedding added to the noise level embedding, thus contributing to the internal Adaptive Layer Norm (AdaLN) conditioning inside the DiT blocks, and (2) an additional AdaLN layer on the outset of the DiT blocks conditional only on the budget, in order to effectively rescale the outputs to account for the change in variance. Following <cite class="ltx_cite ltx_citemacro_citep">(Peebles &amp; Xie, <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib43" title="">2023</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib66" title="">2023</a>)</cite>, we zero-initialize both budget conditioning modules to improve finetuning stability.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.4"><span class="ltx_text ltx_font_bold" id="S3.SS3.p4.4.1">Knowledge Distillation</span>: To encourage distillation without holding the base model in memory, we employ a
<em class="ltx_emph ltx_font_italic" id="S3.SS3.p4.4.2">self-teacher</em> loss.
Formally, if <math alttext="h_{\bm{L}}(\bm{x},\bm{\theta})" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.2"><semantics id="S3.SS3.p4.1.m1.2a"><mrow id="S3.SS3.p4.1.m1.2.3" xref="S3.SS3.p4.1.m1.2.3.cmml"><msub id="S3.SS3.p4.1.m1.2.3.2" xref="S3.SS3.p4.1.m1.2.3.2.cmml"><mi id="S3.SS3.p4.1.m1.2.3.2.2" xref="S3.SS3.p4.1.m1.2.3.2.2.cmml">h</mi><mi id="S3.SS3.p4.1.m1.2.3.2.3" xref="S3.SS3.p4.1.m1.2.3.2.3.cmml">𝑳</mi></msub><mo id="S3.SS3.p4.1.m1.2.3.1" xref="S3.SS3.p4.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p4.1.m1.2.3.3.2" xref="S3.SS3.p4.1.m1.2.3.3.1.cmml"><mo id="S3.SS3.p4.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p4.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">𝒙</mi><mo id="S3.SS3.p4.1.m1.2.3.3.2.2" xref="S3.SS3.p4.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p4.1.m1.2.2" xref="S3.SS3.p4.1.m1.2.2.cmml">𝜽</mi><mo id="S3.SS3.p4.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS3.p4.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.2b"><apply id="S3.SS3.p4.1.m1.2.3.cmml" xref="S3.SS3.p4.1.m1.2.3"><times id="S3.SS3.p4.1.m1.2.3.1.cmml" xref="S3.SS3.p4.1.m1.2.3.1"></times><apply id="S3.SS3.p4.1.m1.2.3.2.cmml" xref="S3.SS3.p4.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.2.3.2.1.cmml" xref="S3.SS3.p4.1.m1.2.3.2">subscript</csymbol><ci id="S3.SS3.p4.1.m1.2.3.2.2.cmml" xref="S3.SS3.p4.1.m1.2.3.2.2">ℎ</ci><ci id="S3.SS3.p4.1.m1.2.3.2.3.cmml" xref="S3.SS3.p4.1.m1.2.3.2.3">𝑳</ci></apply><interval closure="open" id="S3.SS3.p4.1.m1.2.3.3.1.cmml" xref="S3.SS3.p4.1.m1.2.3.3.2"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝒙</ci><ci id="S3.SS3.p4.1.m1.2.2.cmml" xref="S3.SS3.p4.1.m1.2.2">𝜽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.2c">h_{\bm{L}}(\bm{x},\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.2d">italic_h start_POSTSUBSCRIPT bold_italic_L end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_θ )</annotation></semantics></math> and <math alttext="h_{\text{full}}(\bm{x},\bm{\theta})" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.2"><semantics id="S3.SS3.p4.2.m2.2a"><mrow id="S3.SS3.p4.2.m2.2.3" xref="S3.SS3.p4.2.m2.2.3.cmml"><msub id="S3.SS3.p4.2.m2.2.3.2" xref="S3.SS3.p4.2.m2.2.3.2.cmml"><mi id="S3.SS3.p4.2.m2.2.3.2.2" xref="S3.SS3.p4.2.m2.2.3.2.2.cmml">h</mi><mtext id="S3.SS3.p4.2.m2.2.3.2.3" xref="S3.SS3.p4.2.m2.2.3.2.3a.cmml">full</mtext></msub><mo id="S3.SS3.p4.2.m2.2.3.1" xref="S3.SS3.p4.2.m2.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p4.2.m2.2.3.3.2" xref="S3.SS3.p4.2.m2.2.3.3.1.cmml"><mo id="S3.SS3.p4.2.m2.2.3.3.2.1" stretchy="false" xref="S3.SS3.p4.2.m2.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">𝒙</mi><mo id="S3.SS3.p4.2.m2.2.3.3.2.2" xref="S3.SS3.p4.2.m2.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p4.2.m2.2.2" xref="S3.SS3.p4.2.m2.2.2.cmml">𝜽</mi><mo id="S3.SS3.p4.2.m2.2.3.3.2.3" stretchy="false" xref="S3.SS3.p4.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.2b"><apply id="S3.SS3.p4.2.m2.2.3.cmml" xref="S3.SS3.p4.2.m2.2.3"><times id="S3.SS3.p4.2.m2.2.3.1.cmml" xref="S3.SS3.p4.2.m2.2.3.1"></times><apply id="S3.SS3.p4.2.m2.2.3.2.cmml" xref="S3.SS3.p4.2.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.2.3.2.1.cmml" xref="S3.SS3.p4.2.m2.2.3.2">subscript</csymbol><ci id="S3.SS3.p4.2.m2.2.3.2.2.cmml" xref="S3.SS3.p4.2.m2.2.3.2.2">ℎ</ci><ci id="S3.SS3.p4.2.m2.2.3.2.3a.cmml" xref="S3.SS3.p4.2.m2.2.3.2.3"><mtext id="S3.SS3.p4.2.m2.2.3.2.3.cmml" mathsize="70%" xref="S3.SS3.p4.2.m2.2.3.2.3">full</mtext></ci></apply><interval closure="open" id="S3.SS3.p4.2.m2.2.3.3.1.cmml" xref="S3.SS3.p4.2.m2.2.3.3.2"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝒙</ci><ci id="S3.SS3.p4.2.m2.2.2.cmml" xref="S3.SS3.p4.2.m2.2.2">𝜽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.2c">h_{\text{full}}(\bm{x},\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.2d">italic_h start_POSTSUBSCRIPT full end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_θ )</annotation></semantics></math> are the normalized outputs of the final DiT layer with and without layer dropping respectively,
the self-teacher loss is <math alttext="\mathcal{L}_{\text{st}}=\|h_{\bm{L}}(\bm{x},\bm{\theta})-\texttt{sg}(h_{\text{%
full}}(\bm{x},\bm{\theta}))\|_{2}^{2}," class="ltx_Math" display="inline" id="S3.SS3.p4.3.m3.5"><semantics id="S3.SS3.p4.3.m3.5a"><mrow id="S3.SS3.p4.3.m3.5.5.1" xref="S3.SS3.p4.3.m3.5.5.1.1.cmml"><mrow id="S3.SS3.p4.3.m3.5.5.1.1" xref="S3.SS3.p4.3.m3.5.5.1.1.cmml"><msub id="S3.SS3.p4.3.m3.5.5.1.1.3" xref="S3.SS3.p4.3.m3.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.3.m3.5.5.1.1.3.2" xref="S3.SS3.p4.3.m3.5.5.1.1.3.2.cmml">ℒ</mi><mtext id="S3.SS3.p4.3.m3.5.5.1.1.3.3" xref="S3.SS3.p4.3.m3.5.5.1.1.3.3a.cmml">st</mtext></msub><mo id="S3.SS3.p4.3.m3.5.5.1.1.2" xref="S3.SS3.p4.3.m3.5.5.1.1.2.cmml">=</mo><msubsup id="S3.SS3.p4.3.m3.5.5.1.1.1" xref="S3.SS3.p4.3.m3.5.5.1.1.1.cmml"><mrow id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.2.cmml"><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.cmml"><msub id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.2" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.2.cmml">h</mi><mi id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.3" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.3.cmml">𝑳</mi></msub><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.1" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.3.2" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">𝒙</mi><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.3.2.2" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.SS3.p4.3.m3.2.2" xref="S3.SS3.p4.3.m3.2.2.cmml">𝜽</mi><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.2" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.3a.cmml">sg</mtext><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mtext id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml">full</mtext></msub><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.SS3.p4.3.m3.3.3" xref="S3.SS3.p4.3.m3.3.3.cmml">𝒙</mi><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p4.3.m3.4.4" xref="S3.SS3.p4.3.m3.4.4.cmml">𝜽</mi><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS3.p4.3.m3.5.5.1.1.1.1.3" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.3.cmml">2</mn><mn id="S3.SS3.p4.3.m3.5.5.1.1.1.3" xref="S3.SS3.p4.3.m3.5.5.1.1.1.3.cmml">2</mn></msubsup></mrow><mo id="S3.SS3.p4.3.m3.5.5.1.2" xref="S3.SS3.p4.3.m3.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.5b"><apply id="S3.SS3.p4.3.m3.5.5.1.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1"><eq id="S3.SS3.p4.3.m3.5.5.1.1.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.2"></eq><apply id="S3.SS3.p4.3.m3.5.5.1.1.3.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.5.5.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.3.m3.5.5.1.1.3.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.3.2">ℒ</ci><ci id="S3.SS3.p4.3.m3.5.5.1.1.3.3a.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.3.3"><mtext id="S3.SS3.p4.3.m3.5.5.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.p4.3.m3.5.5.1.1.3.3">st</mtext></ci></apply><apply id="S3.SS3.p4.3.m3.5.5.1.1.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.5.5.1.1.1.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1">superscript</csymbol><apply id="S3.SS3.p4.3.m3.5.5.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.5.5.1.1.1.1.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1">subscript</csymbol><apply id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1"><minus id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.2"></minus><apply id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3"><times id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.1"></times><apply id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.2">ℎ</ci><ci id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.2.3">𝑳</ci></apply><interval closure="open" id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.3.3.2"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝒙</ci><ci id="S3.SS3.p4.3.m3.2.2.cmml" xref="S3.SS3.p4.3.m3.2.2">𝜽</ci></interval></apply><apply id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1"><times id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.2"></times><ci id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.3">sg</mtext></ci><apply id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1"><times id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.3"><mtext id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.2.3">full</mtext></ci></apply><interval closure="open" id="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.SS3.p4.3.m3.3.3.cmml" xref="S3.SS3.p4.3.m3.3.3">𝒙</ci><ci id="S3.SS3.p4.3.m3.4.4.cmml" xref="S3.SS3.p4.3.m3.4.4">𝜽</ci></interval></apply></apply></apply></apply><cn id="S3.SS3.p4.3.m3.5.5.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.p4.3.m3.5.5.1.1.1.1.3">2</cn></apply><cn id="S3.SS3.p4.3.m3.5.5.1.1.1.3.cmml" type="integer" xref="S3.SS3.p4.3.m3.5.5.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.5c">\mathcal{L}_{\text{st}}=\|h_{\bm{L}}(\bm{x},\bm{\theta})-\texttt{sg}(h_{\text{%
full}}(\bm{x},\bm{\theta}))\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m3.5d">caligraphic_L start_POSTSUBSCRIPT st end_POSTSUBSCRIPT = ∥ italic_h start_POSTSUBSCRIPT bold_italic_L end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_θ ) - sg ( italic_h start_POSTSUBSCRIPT full end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_θ ) ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math>
where <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS3.p4.4.3">sg</span> denotes a stop-gradient. This gives additional supervision during the early phases of finetuning so the layer-dropped outputs can match full model performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1">We show the differences between our <span class="ltx_text ltx_font_bold" id="S3.SS3.p5.1.1">Presto-L</span> and the baseline approach in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.F3" title="Figure 3 ‣ 3.3 Presto-L: Variance and Budget-Aware Layer Dropping ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">3</span></a>. By conditioning directly on the budget, and shifting the dropping schedule to account for the final DiT block behavior, we able to more adapt computation for reduced budgets while preserving performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Presto-LS: Layer-Step Distillation</h3>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">As the act of layer distillation is, in principle, unrelated to the step distillation, there is no reason <em class="ltx_emph ltx_font_italic" id="S3.SS4.p1.1.1">a priori</em> that these methods could not work together.
However, we found combining such methods to be surprisingly non-trivial.
In particular, we empirically find that attempting both performing <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.2">Presto-L</span> finetuning and <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.3">Presto-S</span> at the same time OR performing <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.4">Presto-L</span> finetuning from an initial <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.5">Presto-S</span> checkpoint results in large instability and model degradation, as the discriminator dominates the optimization process and achieves near-perfect accuracy on real data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">We instead find three key factors in making combined step and layer distillation work:
(1) <em class="ltx_emph ltx_font_italic" id="S3.SS4.p2.1.1">Layer-Step Distillation</em> – we first perform layer distillation then step distillation, which is more stable as the already-finetuned layer dropping prevents generator collapse;
(2) <em class="ltx_emph ltx_font_italic" id="S3.SS4.p2.1.2">Full Capacity Score Estimation</em> – we keep the real and fake score models initialized from the <em class="ltx_emph ltx_font_italic" id="S3.SS4.p2.1.3">original</em> score model rather than the layer-distilled model, as this stabilizes the distribution matching gradient and provides regularization to the discriminator since the fake score model and the generator are initialized with different weights; and
(3) <em class="ltx_emph ltx_font_italic" id="S3.SS4.p2.1.4">Reduced Dropping Budget</em> – we keep more layers during the layer distillation. We discuss more in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.SS6" title="4.6 Presto-LS Qualitative Analysis ‣ 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">4.6</span></a> and how alternatives fail in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS4" title="A.4 Analyzing Failure Modes of Combined Layer and Step Distillation ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">A.4</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We show the efficacy of <span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Presto</span> via a number of experiments. We first ablate the design choices afforded by <span class="ltx_text ltx_font_bold" id="S4.p1.1.2">Presto-S</span>, and separately show how <span class="ltx_text ltx_font_bold" id="S4.p1.1.3">Presto-L</span> flatly improves standard diffusion sampling. We then show how <span class="ltx_text ltx_font_bold" id="S4.p1.1.4">Presto-L</span> and <span class="ltx_text ltx_font_bold" id="S4.p1.1.5">Presto-S</span> stack up against SOTA baselines, and how we can combine such approaches for further acceleration, with both quantitative and subjective metrics. We finish by describing a number of extensions enabled by our accelerated, continuous-time framework.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Setup</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Model:</span> We use latent diffusion <cite class="ltx_cite ltx_citemacro_citep">(Rombach et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib45" title="">2022</a>)</cite> with a fully convolutional VAE <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib29" title="">2023</a>)</cite> to generate mono 44.1kHz audio and convert to stereo using MusicHiFi <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib68" title="">2024</a>)</cite>.
Our latent diffusion model builds upon DiT-XL <cite class="ltx_cite ltx_citemacro_citep">(Peebles &amp; Xie, <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib43" title="">2023</a>)</cite> and takes in three conditioning signals: the noise level, text prompts, and beat per minute (BPM) for each song. We use FlashAttention-2 <cite class="ltx_cite ltx_citemacro_citep">(Dao, <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib8" title="">2023</a>)</cite> for the DiT and <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.2">torch.compile</span> for the VAE decoder and MusicHiFi.
For more details, see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS1" title="A.1 Model Design Details ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Data:</span> We use a 3.6K hour dataset of mono 44.1 kHz licensed instrumental music, augmented with pitch-shifting and time-stretching. Data includes musical meta-data and synthetic captions.
For evaluation, we use Song Describer (no vocals) <cite class="ltx_cite ltx_citemacro_citep">(Manco et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib36" title="">2023</a>)</cite> split into 32 second chunks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Baselines:</span> We compare against a number of acceleration algorithms and external models, including Consistency Models (CM) <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib57" title="">2023</a>)</cite>, SoundCTM <cite class="ltx_cite ltx_citemacro_citep">(Saito et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib47" title="">2024</a>)</cite>, DITTO-CTM <cite class="ltx_cite ltx_citemacro_citep">(Novack et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib41" title="">2024a</a>)</cite>,
DMD-GAN <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib64" title="">2024</a>)</cite>,
ASE <cite class="ltx_cite ltx_citemacro_citep">(Moon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib38" title="">2024</a>)</cite>,
MusicGen <cite class="ltx_cite ltx_citemacro_citep">(Copet et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib7" title="">2023</a>)</cite>,
and Stable Audio Open <cite class="ltx_cite ltx_citemacro_citep">(Evans et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib14" title="">2024c</a>)</cite>. See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS2" title="A.2 Baseline Description ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">A.2</span></a> for more details.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">Metrics:</span> We use Frechet Audio Distance (FAD) <cite class="ltx_cite ltx_citemacro_citep">(Kilgour et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib26" title="">2018</a>)</cite>, Maximum Mean Discrepancy (MMD) <cite class="ltx_cite ltx_citemacro_citep">(Jayasumana et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib21" title="">2024</a>)</cite>, and Contrastive Language-Audio Pretraining (CLAP) score <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib62" title="">2023</a>)</cite>, all with the CLAP-LAION music backbone <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib62" title="">2023</a>)</cite> given its high correlation with human perception <cite class="ltx_cite ltx_citemacro_citep">(Gui et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib16" title="">2024</a>)</cite>. FAD and MMD measure audio quality/realness with respect to Song Describer (lower better), and CLAP score measures prompt adherence (higher better).
When comparing to other models, we
also include density (measuring quality), recall and coverage (measuring diversity) <cite class="ltx_cite ltx_citemacro_citep">(Naeem et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib39" title="">2020</a>)</cite>, and real-time factor (RTF) for both mono (M) and stereo (S, using MusicHiFi), which measures the total seconds of audio generated divided by the generation time, where higher is better for all.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Exploring the Design Space of <span class="ltx_text ltx_font_bold" id="S4.SS2.1.1">Presto-S</span>
</h3>
<figure class="ltx_table ltx_align_floatright" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T1.1.1.1"><math alttext="p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><msub id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mi id="S4.T1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.2.cmml">p</mi><mtext id="S4.T1.1.1.1.m1.1.1.3" mathcolor="#C00000" xref="S4.T1.1.1.1.m1.1.1.3a.cmml">gen</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.2">𝑝</ci><ci id="S4.T1.1.1.1.m1.1.1.3a.cmml" xref="S4.T1.1.1.1.m1.1.1.3"><mtext id="S4.T1.1.1.1.m1.1.1.3.cmml" mathcolor="#C00000" mathsize="70%" xref="S4.T1.1.1.1.m1.1.1.3">gen</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">italic_p start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.2.2.2"><math alttext="p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}" class="ltx_Math" display="inline" id="S4.T1.2.2.2.m1.1"><semantics id="S4.T1.2.2.2.m1.1a"><msub id="S4.T1.2.2.2.m1.1.1" xref="S4.T1.2.2.2.m1.1.1.cmml"><mi id="S4.T1.2.2.2.m1.1.1.2" xref="S4.T1.2.2.2.m1.1.1.2.cmml">p</mi><mtext id="S4.T1.2.2.2.m1.1.1.3" mathcolor="#FBBD00" xref="S4.T1.2.2.2.m1.1.1.3a.cmml">DMD</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.m1.1b"><apply id="S4.T1.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.2.2.2.m1.1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1">subscript</csymbol><ci id="S4.T1.2.2.2.m1.1.1.2.cmml" xref="S4.T1.2.2.2.m1.1.1.2">𝑝</ci><ci id="S4.T1.2.2.2.m1.1.1.3a.cmml" xref="S4.T1.2.2.2.m1.1.1.3"><mtext id="S4.T1.2.2.2.m1.1.1.3.cmml" mathcolor="#FBBD00" mathsize="70%" xref="S4.T1.2.2.2.m1.1.1.3">DMD</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.m1.1c">p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.m1.1d">italic_p start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.3.3.3"><math alttext="p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}" class="ltx_Math" display="inline" id="S4.T1.3.3.3.m1.1"><semantics id="S4.T1.3.3.3.m1.1a"><msub id="S4.T1.3.3.3.m1.1.1" xref="S4.T1.3.3.3.m1.1.1.cmml"><mi id="S4.T1.3.3.3.m1.1.1.2" xref="S4.T1.3.3.3.m1.1.1.2.cmml">p</mi><mtext id="S4.T1.3.3.3.m1.1.1.3" mathcolor="#2E5F7F" xref="S4.T1.3.3.3.m1.1.1.3a.cmml">DSM</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.m1.1b"><apply id="S4.T1.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.3.3.3.m1.1.1.1.cmml" xref="S4.T1.3.3.3.m1.1.1">subscript</csymbol><ci id="S4.T1.3.3.3.m1.1.1.2.cmml" xref="S4.T1.3.3.3.m1.1.1.2">𝑝</ci><ci id="S4.T1.3.3.3.m1.1.1.3a.cmml" xref="S4.T1.3.3.3.m1.1.1.3"><mtext id="S4.T1.3.3.3.m1.1.1.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="S4.T1.3.3.3.m1.1.1.3">DSM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.m1.1c">p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.m1.1d">italic_p start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.4.4.4"><math alttext="p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}" class="ltx_Math" display="inline" id="S4.T1.4.4.4.m1.1"><semantics id="S4.T1.4.4.4.m1.1a"><msub id="S4.T1.4.4.4.m1.1.1" xref="S4.T1.4.4.4.m1.1.1.cmml"><mi id="S4.T1.4.4.4.m1.1.1.2" xref="S4.T1.4.4.4.m1.1.1.2.cmml">p</mi><mtext id="S4.T1.4.4.4.m1.1.1.3" mathcolor="#92D050" xref="S4.T1.4.4.4.m1.1.1.3a.cmml">GAN</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.m1.1b"><apply id="S4.T1.4.4.4.m1.1.1.cmml" xref="S4.T1.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.4.4.4.m1.1.1.1.cmml" xref="S4.T1.4.4.4.m1.1.1">subscript</csymbol><ci id="S4.T1.4.4.4.m1.1.1.2.cmml" xref="S4.T1.4.4.4.m1.1.1.2">𝑝</ci><ci id="S4.T1.4.4.4.m1.1.1.3a.cmml" xref="S4.T1.4.4.4.m1.1.1.3"><mtext id="S4.T1.4.4.4.m1.1.1.3.cmml" mathcolor="#92D050" mathsize="70%" xref="S4.T1.4.4.4.m1.1.1.3">GAN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.m1.1c">p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.m1.1d">italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.4.4.5">FAD</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.4.4.6">MMD</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.4.4.7">CLAP</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.5.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T1.4.5.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.4.5.1.1.1">Least-Squares GAN</span></th>
</tr>
<tr class="ltx_tr" id="S4.T1.4.6.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T1.4.6.2.1">Inf.</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.6.2.2">Inf.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.6.2.3">Inf.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.6.2.4">Inf.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.6.2.5">0.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.6.2.6">1.73</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.6.2.7">27.45</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.7.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.7.3.1">Inf.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.7.3.2">Inf.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.7.3.3">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.7.3.4">Inf.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.7.3.5">0.37</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.7.3.6">1.58</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.7.3.7">26.45</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.8.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.8.4.1">Inf.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.8.4.2">Inf.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.8.4.3">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.8.4.4">Tr.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.8.4.5">0.37</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.8.4.6">1.51</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.8.4.7">24.90</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.9.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.9.5.1">Inf.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.9.5.2">Tr.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.9.5.3">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.9.5.4">Inf.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.9.5.5">0.27</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.9.5.6">1.27</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.9.5.7">33.12</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.10.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.10.6.1">Inf.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.10.6.2">Tr.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.10.6.3">Inf.</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.10.6.4">Tr.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.10.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.10.6.5.1">0.23</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.10.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.10.6.6.1">0.86</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.10.6.7"><span class="ltx_text ltx_font_bold" id="S4.T1.4.10.6.7.1">33.29</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.11.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.11.7.1">Inf.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.11.7.2">Tr.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.11.7.3">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.11.7.4">Tr.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.11.7.5"><span class="ltx_text ltx_font_bold" id="S4.T1.4.11.7.5.1">0.22</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.11.7.6"><span class="ltx_text ltx_font_bold" id="S4.T1.4.11.7.6.1">0.83</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.11.7.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.11.7.7.1">33.13</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.12.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.12.8.1">Tr.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.12.8.2">Tr.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.12.8.3">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.12.8.4">Tr.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.12.8.5">0.24</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.12.8.6">0.99</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.12.8.7">30.89</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.13.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T1.4.13.9.1"><span class="ltx_text ltx_font_bold" id="S4.T1.4.13.9.1.1">Non-Saturating GAN</span></th>
</tr>
<tr class="ltx_tr" id="S4.T1.4.14.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T1.4.14.10.1">Inf.</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.14.10.2">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.14.10.3">Inf.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.14.10.4">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.14.10.5">0.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.14.10.6">0.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.14.10.7">31.48</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.15.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.15.11.1">Inf.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.15.11.2">Tr.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.15.11.3">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.15.11.4">Tr.</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.15.11.5">0.25</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.15.11.6">0.96</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.15.11.7">31.78</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.16.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T1.4.16.12.1">Tr.</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.16.12.2">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.16.12.3">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.4.16.12.4">Tr.</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.16.12.5">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.16.12.6">1.04</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.16.12.7">29.46</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>(Top) Comparing different choices of noise distribution for the <span class="ltx_text ltx_font_bold" id="S4.T1.6.1">Presto-S</span> process. (Bottom) for best performing noise distributions, performance for standard GAN design vs. proposed least-squares GAN.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.5"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.5.1">Loss Distribution Choice:</span> In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.T1" title="Table 1 ‣ 4.2 Exploring the Design Space of Presto-S ‣ 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">1</span></a> (Top), we show the FAD, MMD, and CLAP score for many <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.5.2">Presto-S</span> distilled models with different noise distribution choices.
We find that the original DMD2 <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib64" title="">2024</a>)</cite> setup (first row) underperforms compared to adapting the loss distributions.
The largest change is in switching <math alttext="p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">p</mi><mtext id="S4.SS2.p1.1.m1.1.1.3" mathcolor="#FBBD00" xref="S4.SS2.p1.1.m1.1.1.3a.cmml">DMD</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑝</ci><ci id="S4.SS2.p1.1.m1.1.1.3a.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><mtext id="S4.SS2.p1.1.m1.1.1.3.cmml" mathcolor="#FBBD00" mathsize="70%" xref="S4.SS2.p1.1.m1.1.1.3">DMD</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_p start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT</annotation></semantics></math> to the training distribution, which improves all metrics.
This confirms our hypothesis that by focusing on the region most important for text guidance <cite class="ltx_cite ltx_citemacro_citep">(Kynkäänniemi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib30" title="">2024</a>)</cite>, we improve both audio quality and text adherence.
Switching <math alttext="p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">p</mi><mtext id="S4.SS2.p1.2.m2.1.1.3" mathcolor="#92D050" xref="S4.SS2.p1.2.m2.1.1.3a.cmml">GAN</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝑝</ci><ci id="S4.SS2.p1.2.m2.1.1.3a.cmml" xref="S4.SS2.p1.2.m2.1.1.3"><mtext id="S4.SS2.p1.2.m2.1.1.3.cmml" mathcolor="#92D050" mathsize="70%" xref="S4.SS2.p1.2.m2.1.1.3">GAN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math> to the training distribution also helps; in this case, the discriminator is made to focus on higher-frequency features <cite class="ltx_cite ltx_citemacro_citep">(Si et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib53" title="">2024</a>)</cite>, benefiting quality.
We also find only a small improvement when using the training distribution for <math alttext="p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><msub id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">p</mi><mtext id="S4.SS2.p1.3.m3.1.1.3" mathcolor="#2E5F7F" xref="S4.SS2.p1.3.m3.1.1.3a.cmml">DSM</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝑝</ci><ci id="S4.SS2.p1.3.m3.1.1.3a.cmml" xref="S4.SS2.p1.3.m3.1.1.3"><mtext id="S4.SS2.p1.3.m3.1.1.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="S4.SS2.p1.3.m3.1.1.3">DSM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_p start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT</annotation></semantics></math>.
This suggests that while the training distribution should lead to more stable learning of the online generator’s score <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib60" title="">2024b</a>)</cite>, this may not be crucial.
For all remaining experiments, we use <math alttext="p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}(\sigma^{\text{train}})=p_{\text{{\color[rgb]%
{0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})=p_{\text{{\color[%
rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.3"><semantics id="S4.SS2.p1.4.m4.3a"><mrow id="S4.SS2.p1.4.m4.3.3" xref="S4.SS2.p1.4.m4.3.3.cmml"><mrow id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml"><msub id="S4.SS2.p1.4.m4.1.1.1.3" xref="S4.SS2.p1.4.m4.1.1.1.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.1.3.2" xref="S4.SS2.p1.4.m4.1.1.1.3.2.cmml">p</mi><mtext id="S4.SS2.p1.4.m4.1.1.1.3.3" mathcolor="#FBBD00" xref="S4.SS2.p1.4.m4.1.1.1.3.3a.cmml">DMD</mtext></msub><mo id="S4.SS2.p1.4.m4.1.1.1.2" xref="S4.SS2.p1.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p1.4.m4.1.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS2.p1.4.m4.1.1.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml">σ</mi><mtext id="S4.SS2.p1.4.m4.1.1.1.1.1.1.3" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="S4.SS2.p1.4.m4.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.4.m4.3.3.5" xref="S4.SS2.p1.4.m4.3.3.5.cmml">=</mo><mrow id="S4.SS2.p1.4.m4.2.2.2" xref="S4.SS2.p1.4.m4.2.2.2.cmml"><msub id="S4.SS2.p1.4.m4.2.2.2.3" xref="S4.SS2.p1.4.m4.2.2.2.3.cmml"><mi id="S4.SS2.p1.4.m4.2.2.2.3.2" xref="S4.SS2.p1.4.m4.2.2.2.3.2.cmml">p</mi><mtext id="S4.SS2.p1.4.m4.2.2.2.3.3" mathcolor="#92D050" xref="S4.SS2.p1.4.m4.2.2.2.3.3a.cmml">GAN</mtext></msub><mo id="S4.SS2.p1.4.m4.2.2.2.2" xref="S4.SS2.p1.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS2.p1.4.m4.2.2.2.1.1" xref="S4.SS2.p1.4.m4.2.2.2.1.1.1.cmml"><mo id="S4.SS2.p1.4.m4.2.2.2.1.1.2" stretchy="false" xref="S4.SS2.p1.4.m4.2.2.2.1.1.1.cmml">(</mo><msup id="S4.SS2.p1.4.m4.2.2.2.1.1.1" xref="S4.SS2.p1.4.m4.2.2.2.1.1.1.cmml"><mi id="S4.SS2.p1.4.m4.2.2.2.1.1.1.2" xref="S4.SS2.p1.4.m4.2.2.2.1.1.1.2.cmml">σ</mi><mtext id="S4.SS2.p1.4.m4.2.2.2.1.1.1.3" xref="S4.SS2.p1.4.m4.2.2.2.1.1.1.3a.cmml">train</mtext></msup><mo id="S4.SS2.p1.4.m4.2.2.2.1.1.3" stretchy="false" xref="S4.SS2.p1.4.m4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.4.m4.3.3.6" xref="S4.SS2.p1.4.m4.3.3.6.cmml">=</mo><mrow id="S4.SS2.p1.4.m4.3.3.3" xref="S4.SS2.p1.4.m4.3.3.3.cmml"><msub id="S4.SS2.p1.4.m4.3.3.3.3" xref="S4.SS2.p1.4.m4.3.3.3.3.cmml"><mi id="S4.SS2.p1.4.m4.3.3.3.3.2" xref="S4.SS2.p1.4.m4.3.3.3.3.2.cmml">p</mi><mtext id="S4.SS2.p1.4.m4.3.3.3.3.3" mathcolor="#2E5F7F" xref="S4.SS2.p1.4.m4.3.3.3.3.3a.cmml">DSM</mtext></msub><mo id="S4.SS2.p1.4.m4.3.3.3.2" xref="S4.SS2.p1.4.m4.3.3.3.2.cmml">⁢</mo><mrow id="S4.SS2.p1.4.m4.3.3.3.1.1" xref="S4.SS2.p1.4.m4.3.3.3.1.1.1.cmml"><mo id="S4.SS2.p1.4.m4.3.3.3.1.1.2" stretchy="false" xref="S4.SS2.p1.4.m4.3.3.3.1.1.1.cmml">(</mo><msup id="S4.SS2.p1.4.m4.3.3.3.1.1.1" xref="S4.SS2.p1.4.m4.3.3.3.1.1.1.cmml"><mi id="S4.SS2.p1.4.m4.3.3.3.1.1.1.2" xref="S4.SS2.p1.4.m4.3.3.3.1.1.1.2.cmml">σ</mi><mtext id="S4.SS2.p1.4.m4.3.3.3.1.1.1.3" xref="S4.SS2.p1.4.m4.3.3.3.1.1.1.3a.cmml">train</mtext></msup><mo id="S4.SS2.p1.4.m4.3.3.3.1.1.3" stretchy="false" xref="S4.SS2.p1.4.m4.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.3b"><apply id="S4.SS2.p1.4.m4.3.3.cmml" xref="S4.SS2.p1.4.m4.3.3"><and id="S4.SS2.p1.4.m4.3.3a.cmml" xref="S4.SS2.p1.4.m4.3.3"></and><apply id="S4.SS2.p1.4.m4.3.3b.cmml" xref="S4.SS2.p1.4.m4.3.3"><eq id="S4.SS2.p1.4.m4.3.3.5.cmml" xref="S4.SS2.p1.4.m4.3.3.5"></eq><apply id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"><times id="S4.SS2.p1.4.m4.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.2"></times><apply id="S4.SS2.p1.4.m4.1.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.1.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.3.2">𝑝</ci><ci id="S4.SS2.p1.4.m4.1.1.1.3.3a.cmml" xref="S4.SS2.p1.4.m4.1.1.1.3.3"><mtext id="S4.SS2.p1.4.m4.1.1.1.3.3.cmml" mathcolor="#FBBD00" mathsize="70%" xref="S4.SS2.p1.4.m4.1.1.1.3.3">DMD</mtext></ci></apply><apply id="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2">𝜎</ci><ci id="S4.SS2.p1.4.m4.1.1.1.1.1.1.3a.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.3"><mtext id="S4.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.3">train</mtext></ci></apply></apply><apply id="S4.SS2.p1.4.m4.2.2.2.cmml" xref="S4.SS2.p1.4.m4.2.2.2"><times id="S4.SS2.p1.4.m4.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.2.2.2.2"></times><apply id="S4.SS2.p1.4.m4.2.2.2.3.cmml" xref="S4.SS2.p1.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.2.2.2.3.1.cmml" xref="S4.SS2.p1.4.m4.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.2.2.2.3.2.cmml" xref="S4.SS2.p1.4.m4.2.2.2.3.2">𝑝</ci><ci id="S4.SS2.p1.4.m4.2.2.2.3.3a.cmml" xref="S4.SS2.p1.4.m4.2.2.2.3.3"><mtext id="S4.SS2.p1.4.m4.2.2.2.3.3.cmml" mathcolor="#92D050" mathsize="70%" xref="S4.SS2.p1.4.m4.2.2.2.3.3">GAN</mtext></ci></apply><apply id="S4.SS2.p1.4.m4.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.4.m4.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.2.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.2.2.2.1.1">superscript</csymbol><ci id="S4.SS2.p1.4.m4.2.2.2.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.2.2.2.1.1.1.2">𝜎</ci><ci id="S4.SS2.p1.4.m4.2.2.2.1.1.1.3a.cmml" xref="S4.SS2.p1.4.m4.2.2.2.1.1.1.3"><mtext id="S4.SS2.p1.4.m4.2.2.2.1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.4.m4.2.2.2.1.1.1.3">train</mtext></ci></apply></apply></apply><apply id="S4.SS2.p1.4.m4.3.3c.cmml" xref="S4.SS2.p1.4.m4.3.3"><eq id="S4.SS2.p1.4.m4.3.3.6.cmml" xref="S4.SS2.p1.4.m4.3.3.6"></eq><share href="https://arxiv.org/html/2410.05167v1#S4.SS2.p1.4.m4.2.2.2.cmml" id="S4.SS2.p1.4.m4.3.3d.cmml" xref="S4.SS2.p1.4.m4.3.3"></share><apply id="S4.SS2.p1.4.m4.3.3.3.cmml" xref="S4.SS2.p1.4.m4.3.3.3"><times id="S4.SS2.p1.4.m4.3.3.3.2.cmml" xref="S4.SS2.p1.4.m4.3.3.3.2"></times><apply id="S4.SS2.p1.4.m4.3.3.3.3.cmml" xref="S4.SS2.p1.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.3.3.3.3.1.cmml" xref="S4.SS2.p1.4.m4.3.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.3.3.3.3.2.cmml" xref="S4.SS2.p1.4.m4.3.3.3.3.2">𝑝</ci><ci id="S4.SS2.p1.4.m4.3.3.3.3.3a.cmml" xref="S4.SS2.p1.4.m4.3.3.3.3.3"><mtext id="S4.SS2.p1.4.m4.3.3.3.3.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="S4.SS2.p1.4.m4.3.3.3.3.3">DSM</mtext></ci></apply><apply id="S4.SS2.p1.4.m4.3.3.3.1.1.1.cmml" xref="S4.SS2.p1.4.m4.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.3.3.3.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.3.3.3.1.1">superscript</csymbol><ci id="S4.SS2.p1.4.m4.3.3.3.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.3.3.3.1.1.1.2">𝜎</ci><ci id="S4.SS2.p1.4.m4.3.3.3.1.1.1.3a.cmml" xref="S4.SS2.p1.4.m4.3.3.3.1.1.1.3"><mtext id="S4.SS2.p1.4.m4.3.3.3.1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.4.m4.3.3.3.1.1.1.3">train</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.3c">p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}(\sigma^{\text{train}})=p_{\text{{\color[rgb]%
{0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})=p_{\text{{\color[%
rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.3d">italic_p start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT ) = italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT ) = italic_p start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>
and <math alttext="p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}(\sigma^{\text{inf}})" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><msub id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.2" xref="S4.SS2.p1.5.m5.1.1.3.2.cmml">p</mi><mtext id="S4.SS2.p1.5.m5.1.1.3.3" mathcolor="#C00000" xref="S4.SS2.p1.5.m5.1.1.3.3a.cmml">gen</mtext></msub><mo id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p1.5.m5.1.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.1.1.cmml"><mo id="S4.SS2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S4.SS2.p1.5.m5.1.1.1.1.1.cmml">(</mo><msup id="S4.SS2.p1.5.m5.1.1.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.1.1.1.2" xref="S4.SS2.p1.5.m5.1.1.1.1.1.2.cmml">σ</mi><mtext id="S4.SS2.p1.5.m5.1.1.1.1.1.3" xref="S4.SS2.p1.5.m5.1.1.1.1.1.3a.cmml">inf</mtext></msup><mo id="S4.SS2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S4.SS2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><times id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2"></times><apply id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2">𝑝</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3a.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3"><mtext id="S4.SS2.p1.5.m5.1.1.3.3.cmml" mathcolor="#C00000" mathsize="70%" xref="S4.SS2.p1.5.m5.1.1.3.3">gen</mtext></ci></apply><apply id="S4.SS2.p1.5.m5.1.1.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.1.1.1.2">𝜎</ci><ci id="S4.SS2.p1.5.m5.1.1.1.1.1.3a.cmml" xref="S4.SS2.p1.5.m5.1.1.1.1.1.3"><mtext id="S4.SS2.p1.5.m5.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.5.m5.1.1.1.1.1.3">inf</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}(\sigma^{\text{inf}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">italic_p start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Discriminator Design:</span> We ablate the effect of switching from the chosen least-squares discriminator to the original softplus non-saturating discriminator, which notable treats the discriminator as a binary classifier and predicts the probability of real/generated. In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.T1" title="Table 1 ‣ 4.2 Exploring the Design Space of Presto-S ‣ 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">1</span></a> (Bottom), we find that using the least-squares discriminator leads to consistent improvements in audio quality (FAD/MMD) and in particular text relevance (CLAP), owing to the increased stability from the least-squares GAN.</p>
</div>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="187" id="S4.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Continuous generator inputs vs. discrete inputs. Continuous inputs shows more consistent scaling with compute, while generally performing better in both quality and text relevance.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">Continuous vs. Discrete Generator Inputs:</span>
We test how <em class="ltx_emph ltx_font_italic" id="S4.SS2.p3.1.2">continuous-time</em> conditioning compares against a discrete and find the former is preferred as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.F5" title="Figure 5 ‣ 4.2 Exploring the Design Space of Presto-S ‣ 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">5</span></a>.
Continuous noise levels maintain a correlation where more steps improve quality, while discrete time models are more inconsistent.
Additionally, the continuous-time conditioning performs best in text relevance.
While the 1 and 2-step discrete models show slightly better FAD metrics than continuous on 1 and 2-step sampling, these models have a failure mode as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.F11" title="Figure 11 ‣ A.8 Discrete-Time Failure Modes ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">11</span></a>:
2-step discrete models drop high-frequency information and render transients (i.e. drum hits) poorly for genres like R&amp;B or hip-hop.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span class="ltx_text ltx_font_bold" id="S4.SS3.1.1">Presto-L</span> Results</h3>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="181" id="S4.F6.g1" src="x6.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="S4.F6.4.1">Presto-L</span> results. <span class="ltx_text ltx_font_bold" id="S4.F6.5.2">Presto-L</span> improves both the latency <em class="ltx_emph ltx_font_italic" id="S4.F6.6.3">and</em> the overall performance across all metrics, against both the leading layer dropping baseline and the base model.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.2">We compare <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.2.1">Presto-L</span> with both our baseline diffusion model and ASE <cite class="ltx_cite ltx_citemacro_citep">(Moon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib38" title="">2024</a>)</cite> using the 2nd order DPM++ sampler <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib34" title="">2022</a>)</cite> with CFG++ <cite class="ltx_cite ltx_citemacro_citep">(Chung et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib6" title="">2024</a>)</cite>.
For ASE and <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.2.2">Presto-L</span>, we use the optimal “D3” configuration from <cite class="ltx_cite ltx_citemacro_citet">Moon et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib38" title="">2024</a>)</cite>, which corresponds to a dropping schedule, in terms of decreasing noise level (in quintiles), of <math alttext="[14,12,8,4,0]" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.5"><semantics id="S4.SS3.p1.1.m1.5a"><mrow id="S4.SS3.p1.1.m1.5.6.2" xref="S4.SS3.p1.1.m1.5.6.1.cmml"><mo id="S4.SS3.p1.1.m1.5.6.2.1" stretchy="false" xref="S4.SS3.p1.1.m1.5.6.1.cmml">[</mo><mn id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">14</mn><mo id="S4.SS3.p1.1.m1.5.6.2.2" xref="S4.SS3.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS3.p1.1.m1.2.2" xref="S4.SS3.p1.1.m1.2.2.cmml">12</mn><mo id="S4.SS3.p1.1.m1.5.6.2.3" xref="S4.SS3.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS3.p1.1.m1.3.3" xref="S4.SS3.p1.1.m1.3.3.cmml">8</mn><mo id="S4.SS3.p1.1.m1.5.6.2.4" xref="S4.SS3.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS3.p1.1.m1.4.4" xref="S4.SS3.p1.1.m1.4.4.cmml">4</mn><mo id="S4.SS3.p1.1.m1.5.6.2.5" xref="S4.SS3.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS3.p1.1.m1.5.5" xref="S4.SS3.p1.1.m1.5.5.cmml">0</mn><mo id="S4.SS3.p1.1.m1.5.6.2.6" stretchy="false" xref="S4.SS3.p1.1.m1.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.5b"><list id="S4.SS3.p1.1.m1.5.6.1.cmml" xref="S4.SS3.p1.1.m1.5.6.2"><cn id="S4.SS3.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1">14</cn><cn id="S4.SS3.p1.1.m1.2.2.cmml" type="integer" xref="S4.SS3.p1.1.m1.2.2">12</cn><cn id="S4.SS3.p1.1.m1.3.3.cmml" type="integer" xref="S4.SS3.p1.1.m1.3.3">8</cn><cn id="S4.SS3.p1.1.m1.4.4.cmml" type="integer" xref="S4.SS3.p1.1.m1.4.4">4</cn><cn id="S4.SS3.p1.1.m1.5.5.cmml" type="integer" xref="S4.SS3.p1.1.m1.5.5">0</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.5c">[14,12,8,4,0]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.5d">[ 14 , 12 , 8 , 4 , 0 ]</annotation></semantics></math> (i.e. we drop 14 layers for noise levels in the top quintile, 12 for the next highest quintile, and so on).
Layer distillation results at various sampling budgets are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.F6" title="Figure 6 ‣ 4.3 Presto-L Results ‣ 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">6</span></a>.
<span class="ltx_text ltx_font_bold" id="S4.SS3.p1.2.3">Presto-L</span> yields an improvement over the base model on all metrics, speeding up by <math alttext="\approx" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mo id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><approx id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\approx</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">≈</annotation></semantics></math>27% <em class="ltx_emph ltx_font_italic" id="S4.SS3.p1.2.4">and</em> improving quality and text relevance.
ASE provides similar acceleration but degrades performance at high sampling steps and scales inconsistently.
The behavior of dropping layers <em class="ltx_emph ltx_font_italic" id="S4.SS3.p1.2.5">improving</em> performance can be viewed via the lens of multi-task learning, where (1) denoising each noise level is a different task (2) later layers only activating for lower noise levels enables specialization for higher frequencies. See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS7" title="A.7 Presto-L Design Ablation ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">A.7</span></a> for further ablations.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.7">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T2.7.7.8">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T2.7.7.9">NFE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.1.1.1">RTF-M/S (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.m1.1.1" stretchy="false" xref="S4.T2.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">↑</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.2">FAD (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.m1.1a"><mo id="S4.T2.2.2.2.m1.1.1" stretchy="false" xref="S4.T2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.m1.1d">↓</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.3.3.3">MMD (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.3.3.3.m1.1"><semantics id="S4.T2.3.3.3.m1.1a"><mo id="S4.T2.3.3.3.m1.1.1" stretchy="false" xref="S4.T2.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.m1.1b"><ci id="S4.T2.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.m1.1d">↓</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.4.4">CLAP Score (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.4.4.4.m1.1"><semantics id="S4.T2.4.4.4.m1.1a"><mo id="S4.T2.4.4.4.m1.1.1" stretchy="false" xref="S4.T2.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.m1.1b"><ci id="S4.T2.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.4.m1.1d">↑</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.5.5.5">Density (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.5.5.5.m1.1"><semantics id="S4.T2.5.5.5.m1.1a"><mo id="S4.T2.5.5.5.m1.1.1" stretchy="false" xref="S4.T2.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.m1.1b"><ci id="S4.T2.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.5.m1.1d">↑</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.6.6.6">Recall (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.6.6.6.m1.1"><semantics id="S4.T2.6.6.6.m1.1a"><mo id="S4.T2.6.6.6.m1.1.1" stretchy="false" xref="S4.T2.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.m1.1b"><ci id="S4.T2.6.6.6.m1.1.1.cmml" xref="S4.T2.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.6.m1.1d">↑</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.7.7.7">Coverage(<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.7.7.7.m1.1"><semantics id="S4.T2.7.7.7.m1.1a"><mo id="S4.T2.7.7.7.m1.1.1" stretchy="false" xref="S4.T2.7.7.7.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.m1.1b"><ci id="S4.T2.7.7.7.m1.1.1.cmml" xref="S4.T2.7.7.7.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.7.7.m1.1d">↑</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.8.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="5" id="S4.T2.7.8.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.8.1.1.1">External Baselines*</span></th>
<td class="ltx_td ltx_border_t" id="S4.T2.7.8.1.2"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.8.1.3"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.8.1.4"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.8.1.5"></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.9.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.9.2.1">MusicGen-Small</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.9.2.2">1.6K</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.9.2.3">0.77</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.9.2.4">0.31</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.9.2.5">1.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.9.2.6">30.61</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.9.2.7">0.36</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.9.2.8">0.16</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.9.2.9">0.43</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.10.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.10.3.1">MusicGen-Medium</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.10.3.2">1.6K</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.10.3.3">0.39</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.10.3.4">0.27</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.10.3.5">1.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.10.3.6">31.85</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.10.3.7">0.43</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.10.3.8">0.19</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.10.3.9">0.54</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.11.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.11.4.1">MusicGen-Large</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.11.4.2">1.6K</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.11.4.3">0.37</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.11.4.4">0.25</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.11.4.5">1.21</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.11.4.6">32.83</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.11.4.7">0.44</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.11.4.8">0.15</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.11.4.9">0.54</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.12.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.12.5.1">Stable Audio Open</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.12.5.2">100</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.12.5.3">4.54</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.12.5.4">0.23</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.12.5.5">1.07</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.12.5.6">35.05</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.12.5.7">0.29</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.12.5.8">0.37</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.12.5.9">0.49</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.13.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="5" id="S4.T2.7.13.6.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.13.6.1.1">Base Model, Diffusion Sampling</span></th>
<td class="ltx_td ltx_border_t" id="S4.T2.7.13.6.2"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.13.6.3"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.13.6.4"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.13.6.5"></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.14.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.14.7.1">DPM-2S</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.14.7.2">80</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.14.7.3">7.72 / 7.34</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.14.7.4">0.24</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.14.7.5">0.82</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.14.7.6">31.56</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.14.7.7">0.31</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.14.7.8">0.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.14.7.9">0.41</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.15.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.15.8.1">DPM-2S+ASE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.15.8.2">80</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.15.8.3">9.80 / 9.22</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.15.8.4">0.25</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.15.8.5">1.12</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.15.8.6">30.03</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.15.8.7">0.27</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.15.8.8">0.16</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.15.8.9">0.41</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.16.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.16.9.1">DPM-2S+<span class="ltx_text ltx_font_bold" id="S4.T2.7.16.9.1.1">Presto-L</span> (ours)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.16.9.2">80</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.16.9.3">9.80 / 9.22</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.16.9.4">0.18</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.16.9.5">0.61</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.16.9.6">32.28</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.16.9.7">0.38</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.16.9.8">0.29</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.16.9.9">0.51</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.17.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="5" id="S4.T2.7.17.10.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.17.10.1.1">Consistency-Based Distillation</span></th>
<td class="ltx_td ltx_border_t" id="S4.T2.7.17.10.2"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.17.10.3"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.17.10.4"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.17.10.5"></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.18.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.18.11.1">CM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.18.11.2">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.18.11.3">118.77 / 67.41</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.18.11.4">0.47</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.18.11.5">2.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.18.11.6">26.33</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.18.11.7">0.17</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.18.11.8">0.01</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.18.11.9">0.16</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.19.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.19.12.1">SoundCTM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.19.12.2">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.19.12.3">105.78 / 63.01</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.19.12.4">0.35</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.19.12.5">1.72</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.19.12.6">29.61</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.19.12.7">0.17</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.19.12.8">0.17</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.19.12.9">0.26</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.20.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.20.13.1">DITTO-CTM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.20.13.2">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.20.13.3">118.77 / 67.41</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.20.13.4">0.36</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.20.13.5">1.62</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.20.13.6">28.31</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.20.13.7">0.22</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.20.13.8">0.04</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.20.13.9">0.32</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.21.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="5" id="S4.T2.7.21.14.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.21.14.1.1">Adversarial Distillation</span></th>
<td class="ltx_td ltx_border_t" id="S4.T2.7.21.14.2"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.21.14.3"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.21.14.4"></td>
<td class="ltx_td ltx_border_t" id="S4.T2.7.21.14.5"></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.22.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.22.15.1">DMD-GAN</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.22.15.2">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.22.15.3">118.77 / 67.41</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.22.15.4">0.29</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.22.15.5">1.16</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.22.15.6">27.56</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.22.15.7">0.57</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.22.15.8">0.07</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.22.15.9">0.41</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.23.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.7.23.16.1">
<span class="ltx_text ltx_font_bold" id="S4.T2.7.23.16.1.1">Presto-S</span> (ours)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.7.23.16.2">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.23.16.3">118.77 / 67.41</th>
<td class="ltx_td ltx_align_center" id="S4.T2.7.23.16.4">0.22</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.23.16.5">0.83</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.23.16.6">33.13</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.23.16.7">0.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.23.16.8">0.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.7.23.16.9">0.50</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.24.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T2.7.24.17.1">
<span class="ltx_text ltx_font_bold" id="S4.T2.7.24.17.1.1">Presto-LS</span> (ours)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T2.7.24.17.2">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T2.7.24.17.3">138.84 / 73.43</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.7.24.17.4">0.23</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.7.24.17.5">0.73</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.7.24.17.6">32.21</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.7.24.17.7">0.49</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.7.24.17.8">0.14</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.7.24.17.9">0.48</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Full Results on Song Describer (No vocals).<sup class="ltx_sup" id="S4.T2.11.1">∗</sup>External baseline RTFs are all natively stereo.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Full Comparison</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.T2" title="Table 2 ‣ 4.3 Presto-L Results ‣ 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">2</span></a>, we compare against multiple baselines and external models.
For step distillation, <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.1">Presto-S</span> is best-in-class and the only distillation method to close to base model quality, while achieving an over 15x speedup in RTF from the base model.
Additionally, <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.2">Presto-LS</span> improves performance for MMD, beating the base model with further speedups (230/435ms latency for 32 second mono/stereo 44.1kHz on an A100 40 GB). We also find <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.3">Presto-LS</span> improves <em class="ltx_emph ltx_font_italic" id="S4.SS4.p1.1.4">diversity</em> with higher recall. Overall, <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.5">Presto-LS</span> is 15x faster than SAO. We investigate latency more in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS6" title="A.6 RTF Analysis ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">A.6</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Listening Test</h3>
<div class="ltx_para ltx_noindent" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.2">We also conducted a subjective listening test to compare <span class="ltx_text ltx_font_bold" id="S4.SS5.p1.2.1">Presto-LS</span> with our base model, the best non-adversarial distillation technique SoundCTM <cite class="ltx_cite ltx_citemacro_citep">(Saito et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib47" title="">2024</a>)</cite> distilled from our base model, and Stable Audio Open <cite class="ltx_cite ltx_citemacro_citep">(Evans et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib14" title="">2024c</a>)</cite>. Users (<math alttext="n=16" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><mrow id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml"><mi id="S4.SS5.p1.1.m1.1.1.2" xref="S4.SS5.p1.1.m1.1.1.2.cmml">n</mi><mo id="S4.SS5.p1.1.m1.1.1.1" xref="S4.SS5.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS5.p1.1.m1.1.1.3" xref="S4.SS5.p1.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><apply id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1"><eq id="S4.SS5.p1.1.m1.1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1.1"></eq><ci id="S4.SS5.p1.1.m1.1.1.2.cmml" xref="S4.SS5.p1.1.m1.1.1.2">𝑛</ci><cn id="S4.SS5.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS5.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">n=16</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">italic_n = 16</annotation></semantics></math>) were given 20 sets of examples generated from each model
(randomly cut to 10s for brevity) using random prompts from Song Describer and asked to rate the musical quality, taking into account both fidelity and semantic text match between 0-100. We run multiple paired t-tests with Bonferroni correction and find <span class="ltx_text ltx_font_bold" id="S4.SS5.p1.2.2">Presto-LS</span> rates highest against all baselines (<math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="S4.SS5.p1.2.m2.1"><semantics id="S4.SS5.p1.2.m2.1a"><mrow id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml"><mi id="S4.SS5.p1.2.m2.1.1.2" xref="S4.SS5.p1.2.m2.1.1.2.cmml">p</mi><mo id="S4.SS5.p1.2.m2.1.1.1" xref="S4.SS5.p1.2.m2.1.1.1.cmml">&lt;</mo><mn id="S4.SS5.p1.2.m2.1.1.3" xref="S4.SS5.p1.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><apply id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1"><lt id="S4.SS5.p1.2.m2.1.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1.1"></lt><ci id="S4.SS5.p1.2.m2.1.1.2.cmml" xref="S4.SS5.p1.2.m2.1.1.2">𝑝</ci><cn id="S4.SS5.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS5.p1.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">p&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.2.m2.1d">italic_p &lt; 0.05</annotation></semantics></math>). We show additional plots in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.F12" title="Figure 12 ‣ A.9 Listening Test Results ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">12</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Presto-LS Qualitative Analysis</h3>
<figure class="ltx_figure ltx_align_floatright" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="330" id="S4.F7.g1" src="x7.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="S4.F7.2.1">Presto-S</span> hidden activation var.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">While <span class="ltx_text ltx_font_bold" id="S4.SS6.p1.1.1">Presto-LS</span> improves speed and quality/diversity over step-only distillation, the increases are modest,
as the dropping schedule for <span class="ltx_text ltx_font_bold" id="S4.SS6.p1.1.2">Presto-L</span>
was reduced (<math alttext="[12,8,8,0,0]" class="ltx_Math" display="inline" id="S4.SS6.p1.1.m1.5"><semantics id="S4.SS6.p1.1.m1.5a"><mrow id="S4.SS6.p1.1.m1.5.6.2" xref="S4.SS6.p1.1.m1.5.6.1.cmml"><mo id="S4.SS6.p1.1.m1.5.6.2.1" stretchy="false" xref="S4.SS6.p1.1.m1.5.6.1.cmml">[</mo><mn id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml">12</mn><mo id="S4.SS6.p1.1.m1.5.6.2.2" xref="S4.SS6.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS6.p1.1.m1.2.2" xref="S4.SS6.p1.1.m1.2.2.cmml">8</mn><mo id="S4.SS6.p1.1.m1.5.6.2.3" xref="S4.SS6.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS6.p1.1.m1.3.3" xref="S4.SS6.p1.1.m1.3.3.cmml">8</mn><mo id="S4.SS6.p1.1.m1.5.6.2.4" xref="S4.SS6.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS6.p1.1.m1.4.4" xref="S4.SS6.p1.1.m1.4.4.cmml">0</mn><mo id="S4.SS6.p1.1.m1.5.6.2.5" xref="S4.SS6.p1.1.m1.5.6.1.cmml">,</mo><mn id="S4.SS6.p1.1.m1.5.5" xref="S4.SS6.p1.1.m1.5.5.cmml">0</mn><mo id="S4.SS6.p1.1.m1.5.6.2.6" stretchy="false" xref="S4.SS6.p1.1.m1.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.5b"><list id="S4.SS6.p1.1.m1.5.6.1.cmml" xref="S4.SS6.p1.1.m1.5.6.2"><cn id="S4.SS6.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS6.p1.1.m1.1.1">12</cn><cn id="S4.SS6.p1.1.m1.2.2.cmml" type="integer" xref="S4.SS6.p1.1.m1.2.2">8</cn><cn id="S4.SS6.p1.1.m1.3.3.cmml" type="integer" xref="S4.SS6.p1.1.m1.3.3">8</cn><cn id="S4.SS6.p1.1.m1.4.4.cmml" type="integer" xref="S4.SS6.p1.1.m1.4.4">0</cn><cn id="S4.SS6.p1.1.m1.5.5.cmml" type="integer" xref="S4.SS6.p1.1.m1.5.5">0</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.5c">[12,8,8,0,0]</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.1.m1.5d">[ 12 , 8 , 8 , 0 , 0 ]</annotation></semantics></math>) for step distillation stability.
To investigate more, we analyze the hidden state activation variance of our step-distilled model in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.F7" title="Figure 7 ‣ 4.6 Presto-LS Qualitative Analysis ‣ 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">7</span></a>.
The behavior is quite different than the base model,
as the “spike” in the final layer is more amortized across the last 10 layers and never reaches the base model’s magnitude.
We hypothesize step-distilled models have more unique computation <em class="ltx_emph ltx_font_italic" id="S4.SS6.p1.1.3">throughout</em> each DiT block, making layer dropping difficult.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Extensions</h3>
<div class="ltx_para ltx_noindent" id="S4.SS7.p1">
<p class="ltx_p" id="S4.SS7.p1.4"><span class="ltx_text ltx_font_bold" id="S4.SS7.p1.4.1">Adaptive Step Schedule:</span> A benefit of our continuous-time distillation is that besides setting how many steps (e.g., 1-4), we can set <em class="ltx_emph ltx_font_italic" id="S4.SS7.p1.4.2">where</em> those steps occur along the diffusion process by tuning the <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS7.p1.1.m1.1"><semantics id="S4.SS7.p1.1.m1.1a"><mi id="S4.SS7.p1.1.m1.1.1" xref="S4.SS7.p1.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.1.m1.1b"><ci id="S4.SS7.p1.1.m1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.1.m1.1d">italic_ρ</annotation></semantics></math> parameter in the EDM inference schedule, which is normally set to <math alttext="\rho=7" class="ltx_Math" display="inline" id="S4.SS7.p1.2.m2.1"><semantics id="S4.SS7.p1.2.m2.1a"><mrow id="S4.SS7.p1.2.m2.1.1" xref="S4.SS7.p1.2.m2.1.1.cmml"><mi id="S4.SS7.p1.2.m2.1.1.2" xref="S4.SS7.p1.2.m2.1.1.2.cmml">ρ</mi><mo id="S4.SS7.p1.2.m2.1.1.1" xref="S4.SS7.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS7.p1.2.m2.1.1.3" xref="S4.SS7.p1.2.m2.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.2.m2.1b"><apply id="S4.SS7.p1.2.m2.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1"><eq id="S4.SS7.p1.2.m2.1.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1.1"></eq><ci id="S4.SS7.p1.2.m2.1.1.2.cmml" xref="S4.SS7.p1.2.m2.1.1.2">𝜌</ci><cn id="S4.SS7.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS7.p1.2.m2.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.2.m2.1c">\rho=7</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.2.m2.1d">italic_ρ = 7</annotation></semantics></math>.
In particular, decreasing <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS7.p1.3.m3.1"><semantics id="S4.SS7.p1.3.m3.1a"><mi id="S4.SS7.p1.3.m3.1.1" xref="S4.SS7.p1.3.m3.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.3.m3.1b"><ci id="S4.SS7.p1.3.m3.1.1.cmml" xref="S4.SS7.p1.3.m3.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.3.m3.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.3.m3.1d">italic_ρ</annotation></semantics></math> (lower bounded by 1) puts more weight on low-SNR features and increasing <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS7.p1.4.m4.1"><semantics id="S4.SS7.p1.4.m4.1a"><mi id="S4.SS7.p1.4.m4.1.1" xref="S4.SS7.p1.4.m4.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.4.m4.1b"><ci id="S4.SS7.p1.4.m4.1.1.cmml" xref="S4.SS7.p1.4.m4.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.4.m4.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.4.m4.1d">italic_ρ</annotation></semantics></math> on higher-SNR features <cite class="ltx_cite ltx_citemacro_citep">(Karras et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib23" title="">2022</a>)</cite>.
Qualitatively, we find that this process enables increased diversity of outputs, even from the same latent code (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.SS5" title="A.5 Inference-time noise schedule Sensitivity analysis ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">A.5</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS7.p2">
<p class="ltx_p" id="S4.SS7.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS7.p2.1.1">CPU Runtime:</span>
We benchmark <span class="ltx_text ltx_font_bold" id="S4.SS7.p2.1.2">Presto-LS</span>’s speed performance for CPU inference.
On an Intel Xeon Platinum 8275CL CPU, we achieve a mono RTF of 0.74, generating 32 seconds of audio in 43.34 seconds. We hope to explore further CPU acceleration in future work.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS7.p3">
<p class="ltx_p" id="S4.SS7.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS7.p3.1.1">Fast Inference-Time Rejection Sampling:</span> Given <span class="ltx_text ltx_font_bold" id="S4.SS7.p3.1.2">Presto-LS</span>’s speed,
we investigated using <em class="ltx_emph ltx_font_italic" id="S4.SS7.p3.1.3">inference-time</em> compute to improve performance.
Formally, we test the idea of <em class="ltx_emph ltx_font_italic" id="S4.SS7.p3.1.4">rejection sampling</em>, inspired by <cite class="ltx_cite ltx_citemacro_citet">Kim et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib27" title="">2023</a>)</cite>, where we generate a batch of samples and reject <math alttext="r" class="ltx_Math" display="inline" id="S4.SS7.p3.1.m1.1"><semantics id="S4.SS7.p3.1.m1.1a"><mi id="S4.SS7.p3.1.m1.1.1" xref="S4.SS7.p3.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS7.p3.1.m1.1b"><ci id="S4.SS7.p3.1.m1.1.1.cmml" xref="S4.SS7.p3.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p3.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p3.1.m1.1d">italic_r</annotation></semantics></math> fraction of them according to some ranking function. We use
the CLAP score to discard samples that have poor text relevance. Over a number of rejection ratios (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.F13" title="Figure 13 ‣ A.10 Rejection Sampling Results ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">13</span></a>), we find that CLAP rejection sampling strongly improves text relevance while maintaining or <em class="ltx_emph ltx_font_italic" id="S4.SS7.p3.1.5">improving</em> quality at the cost of diversity.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We proposed <span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Presto</span>, a dual-faceted approach to accelerating latent diffusion transformers by reducing sampling steps and cost per step via distillation. Our core contributions include the development of score-based distribution matching distillation (the first GAN-based distillation for TTM), a new layer distillation method, the first combined layer-step distillation, and evaluation showing each method are independently best-in-class and, when combined, can accelerate our base model by 10-18x (230/435ms latency for 32 second mono/stereo 44.1kHz, 15x faster than the comparable SOTA model), resulting in the fastest TTM model to our knowledge. We hope our work will motivate continued work on (1) fusing step and layer distillation and (2) new distillation of methods for continuous-time score models across media modalities such as image and video.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>
<div class="ltx_para ltx_noindent" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We would like to thank Juan-Pablo Caceres, Hanieh Deilamsalehy, and
Chinmay Talegaonkar.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agostinelli et al. (2023)</span>
<span class="ltx_bibblock">
Andrea Agostinelli, Timo I Denk, Zalán Borsos, Jesse Engel, Mauro Verzetti, Antoine Caillon, Qingqing Huang, Aren Jansen, Adam Roberts, Marco Tagliasacchi, et al.

</span>
<span class="ltx_bibblock">MusicLM: Generating music from text.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv:2301.11325</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ansel et al. (2024)</span>
<span class="ltx_bibblock">
Jason Ansel, Edward Yang, Horace He, Natalia Gimelshein, Animesh Jain, Michael Voznesensky, Bin Bao, Peter Bell, David Berard, Evgeni Burovski, Geeta Chauhan, Anjali Chourdia, Will Constable, Alban Desmaison, Zachary DeVito, Elias Ellison, Will Feng, Jiong Gong, Michael Gschwind, Brian Hirsh, Sherlock Huang, Kshiteej Kalambarkar, Laurent Kirsch, Michael Lazos, Mario Lezcano, Yanbo Liang, Jason Liang, Yinghai Lu, C. K. Luk, Bert Maher, Yunjie Pan, Christian Puhrsch, Matthias Reso, Mark Saroufim, Marcos Yukio Siraichi, Helen Suk, Shunting Zhang, Michael Suo, Phil Tillet, Xu Zhao, Eikan Wang, Keren Zhou, Richard Zou, Xiaodong Wang, Ajit Mathews, William Wen, Gregory Chanan, Peng Wu, and Soumith Chintala.

</span>
<span class="ltx_bibblock">Pytorch 2: Faster machine learning through dynamic python bytecode transformation and graph compilation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">ACM International Conference on Architectural Support for Programming Languages and Operating Systems</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2024)</span>
<span class="ltx_bibblock">
Yatong Bai, Trung Dang, Dung Tran, Kazuhito Koishida, and Somayeh Sojoudi.

</span>
<span class="ltx_bibblock">Accelerating diffusion-based text-to-audio generation with consistency distillation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Interspeech</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Balaji et al. (2022)</span>
<span class="ltx_bibblock">
Yogesh Balaji, Seungjun Nah, Xun Huang, Arash Vahdat, Jiaming Song, Karsten Kreis, Miika Aittala, Timo Aila, Samuli Laine, Bryan Catanzaro, et al.

</span>
<span class="ltx_bibblock">eDiff-I: Text-to-image diffusion models with an ensemble of expert denoisers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv:2211.01324</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2024)</span>
<span class="ltx_bibblock">
Ke Chen, Yusong Wu, Haohe Liu, Marianna Nezhurina, Taylor Berg-Kirkpatrick, and Shlomo Dubnov.

</span>
<span class="ltx_bibblock">MusicLDM: Enhancing novelty in text-to-music generation using beat-synchronous mixup strategies.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">IEEE International Conference on Audio, Speech and Signal Processing (ICASSP)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et al. (2024)</span>
<span class="ltx_bibblock">
Hyungjin Chung, Jeongsol Kim, Geon Yeong Park, Hyelin Nam, and Jong Chul Ye.

</span>
<span class="ltx_bibblock">CFG++: Manifold-constrained classifier free guidance for diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv:2406.08070</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Copet et al. (2023)</span>
<span class="ltx_bibblock">
Jade Copet, Felix Kreuk, Itai Gat, Tal Remez, David Kant, Gabriel Synnaeve, Yossi Adi, and Alexandre Défossez.

</span>
<span class="ltx_bibblock">Simple and controllable music generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Neural Information Processing Systems (NeurIPS)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao (2023)</span>
<span class="ltx_bibblock">
Tri Dao.

</span>
<span class="ltx_bibblock">Flashattention-2: Faster attention with better parallelism and work partitioning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv:2307.08691</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dhariwal &amp; Nichol (2021)</span>
<span class="ltx_bibblock">
Prafulla Dhariwal and Alexander Nichol.

</span>
<span class="ltx_bibblock">Diffusion models beat GANs on image synthesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Neural Information Processing Systems (NeurIPS)</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et al. (2024)</span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, et al.

</span>
<span class="ltx_bibblock">The llama 3 herd of models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv:2407.21783</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Défossez et al. (2022)</span>
<span class="ltx_bibblock">
Alexandre Défossez, Jade Copet, Gabriel Synnaeve, and Yossi Adi.

</span>
<span class="ltx_bibblock">High fidelity neural audio compression.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv:2210.13438</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Evans et al. (2024a)</span>
<span class="ltx_bibblock">
Zach Evans, CJ Carr, Josiah Taylor, Scott H. Hawley, and Jordi Pons.

</span>
<span class="ltx_bibblock">Fast timing-conditioned latent audio diffusion.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">International Conference on Machine Learning (ICML)</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Evans et al. (2024b)</span>
<span class="ltx_bibblock">
Zach Evans, Julian Parker, CJ Carr, Zack Zukowski, Josiah Taylor, and Jordi Pons.

</span>
<span class="ltx_bibblock">Long-form music generation with latent diffusion.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv:2404.10301</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Evans et al. (2024c)</span>
<span class="ltx_bibblock">
Zach Evans, Julian D Parker, CJ Carr, Zack Zukowski, Josiah Taylor, and Jordi Pons.

</span>
<span class="ltx_bibblock">Stable audio open.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv:2407.14358</em>, 2024c.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Forsgren &amp; Martiros (2022)</span>
<span class="ltx_bibblock">
Seth Forsgren and Hayk Martiros.

</span>
<span class="ltx_bibblock">Riffusion: Stable diffusion for real-time music generation, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://riffusion.com/about" title="">https://riffusion.com/about</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gui et al. (2024)</span>
<span class="ltx_bibblock">
Azalea Gui, Hannes Gamper, Sebastian Braun, and Dimitra Emmanouilidou.

</span>
<span class="ltx_bibblock">Adapting Frechet Audio Distance for generative music evaluation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">IEEE International Conference on Audio, Speech and Signal Processing (ICASSP)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho &amp; Salimans (2021)</span>
<span class="ltx_bibblock">
Jonathan Ho and Tim Salimans.

</span>
<span class="ltx_bibblock">Classifier-free diffusion guidance.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">NeurIPS Workshop on Deep Gen. Models and Downstream Applications</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al. (2020)</span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Denoising diffusion probabilistic models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Neural Information Processing Systems (NeurIPS)</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. (2020)</span>
<span class="ltx_bibblock">
Lu Hou, Zhiqi Huang, Lifeng Shang, Xin Jiang, Xiao Chen, and Qun Liu.

</span>
<span class="ltx_bibblock">Dynabert: Dynamic bert with adaptive width and depth.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Neural Information Processing Systems (NeurIPS)</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2023)</span>
<span class="ltx_bibblock">
Qingqing Huang, Daniel S Park, Tao Wang, Timo I Denk, Andy Ly, Nanxin Chen, Zhengdong Zhang, Zhishuai Zhang, Jiahui Yu, Christian Frank, et al.

</span>
<span class="ltx_bibblock">Noise2Music: Text-conditioned music generation with diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv:2302.03917</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jayasumana et al. (2024)</span>
<span class="ltx_bibblock">
Sadeep Jayasumana, Srikumar Ramalingam, Andreas Veit, Daniel Glasner, Ayan Chakrabarti, and Sanjiv Kumar.

</span>
<span class="ltx_bibblock">Rethinking fid: Towards a better evaluation metric for image generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang et al. (2024)</span>
<span class="ltx_bibblock">
Minguk Kang, Richard Zhang, Connelly Barnes, Sylvain Paris, Suha Kwak, Jaesik Park, Eli Shechtman, Jun-Yan Zhu, and Taesung Park.

</span>
<span class="ltx_bibblock">Distilling diffusion models into conditional gans.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv:2405.05967</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karras et al. (2022)</span>
<span class="ltx_bibblock">
Tero Karras, Miika Aittala, Timo Aila, and Samuli Laine.

</span>
<span class="ltx_bibblock">Elucidating the design space of diffusion-based generative models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">NeurIPS</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karras et al. (2023)</span>
<span class="ltx_bibblock">
Tero Karras, Miika Aittala, Jaakko Lehtinen, Janne Hellsten, Timo Aila, and Samuli Laine.

</span>
<span class="ltx_bibblock">Analyzing and improving the training dynamics of diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv:2312.02696</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karras et al. (2024)</span>
<span class="ltx_bibblock">
Tero Karras, Miika Aittala, Jaakko Lehtinen, Janne Hellsten, Timo Aila, and Samuli Laine.

</span>
<span class="ltx_bibblock">Analyzing and improving the training dynamics of diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kilgour et al. (2018)</span>
<span class="ltx_bibblock">
Kevin Kilgour, Mauricio Zuluaga, Dominik Roblek, and Matthew Sharifi.

</span>
<span class="ltx_bibblock">Frechet audio distance: A metric for evaluating music enhancement algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv:1812.08466</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2023)</span>
<span class="ltx_bibblock">
Dongjun Kim, Chieh-Hsin Lai, Wei-Hsiang Liao, Naoki Murata, Yuhta Takida, Toshimitsu Uesaka, Yutong He, Yuki Mitsufuji, and Stefano Ermon.

</span>
<span class="ltx_bibblock">Consistency trajectory models: Learning probability flow ODE trajectory of diffusion.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">International Conference on Learning Representations (ICLR)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kohler et al. (2024)</span>
<span class="ltx_bibblock">
Jonas Kohler, Albert Pumarola, Edgar Schönfeld, Artsiom Sanakoyeu, Roshan Sumbaly, Peter Vajda, and Ali K. Thabet.

</span>
<span class="ltx_bibblock">Imagine Flash: Accelerating Emu Diffusion Models with Backward Distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv:2405.05224</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. (2023)</span>
<span class="ltx_bibblock">
Rithesh Kumar, Prem Seetharaman, Alejandro Luebs, Ishaan Kumar, and Kundan Kumar.

</span>
<span class="ltx_bibblock">High-fidelity audio compression with improved RVQGAN.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Neural Information Processing Systems (NeurIPS)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kynkäänniemi et al. (2024)</span>
<span class="ltx_bibblock">
Tuomas Kynkäänniemi, Miika Aittala, Tero Karras, Samuli Laine, Timo Aila, and Jaakko Lehtinen.

</span>
<span class="ltx_bibblock">Applying guidance in a limited interval improves sample and distribution quality in diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv:2404.07724</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024a)</span>
<span class="ltx_bibblock">
Bingchen Liu, Ehsan Akhgari, Alexander Visheratin, Aleks Kamko, Linmiao Xu, Shivam Shrirao, Joao Souza, Suhail Doshi, and Daiqing Li.

</span>
<span class="ltx_bibblock">Playground v3: Improving text-to-image alignment with deep-fusion large language models, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Haohe Liu, Zehua Chen, Yi Yuan, Xinhao Mei, Xubo Liu, Danilo Mandic, Wenwu Wang, and Mark D Plumbley.

</span>
<span class="ltx_bibblock">AudioLDM: Text-to-audio generation with latent diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">International Conference on Machine Learning (ICML)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024b)</span>
<span class="ltx_bibblock">
Haohe Liu, Yi Yuan, Xubo Liu, Xinhao Mei, Qiuqiang Kong, Qiao Tian, Yuping Wang, Wenwu Wang, Yuxuan Wang, and Mark D. Plumbley.

</span>
<span class="ltx_bibblock">Audioldm 2: Learning holistic audio generation with self-supervised pretraining.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">IEEE/ACM Transactions on Audio, Speech, and Language Processing</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2022)</span>
<span class="ltx_bibblock">
Cheng Lu, Yuhao Zhou, Fan Bao, Jianfei Chen, Chongxuan Li, and Jun Zhu.

</span>
<span class="ltx_bibblock">DPM-Solver++: Fast solver for guided sampling of diffusion probabilistic models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv:2211.01095</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2024)</span>
<span class="ltx_bibblock">
Xinyin Ma, Gongfan Fang, Michael Bi Mi, and Xinchao Wang.

</span>
<span class="ltx_bibblock">Learning-to-cache: Accelerating diffusion transformer via layer caching.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv:2406.01733</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Manco et al. (2023)</span>
<span class="ltx_bibblock">
Ilaria Manco, Benno Weck, Seungheon Doh, Minz Won, Yixiao Zhang, Dmitry Bodganov, Yusong Wu, Ke Chen, Philip Tovstogan, Emmanouil Benetos, et al.

</span>
<span class="ltx_bibblock">The song describer dataset: a corpus of audio captions for music-and-language evaluation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv:2311.10057</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao et al. (2017)</span>
<span class="ltx_bibblock">
Xudong Mao, Qing Li, Haoran Xie, Raymond YK Lau, Zhen Wang, and Stephen Paul Smolley.

</span>
<span class="ltx_bibblock">Least squares generative adversarial networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moon et al. (2024)</span>
<span class="ltx_bibblock">
Taehong Moon, Moonseok Choi, Eunggu Yun, Jongmin Yoon, Gayoung Lee, Jaewoong Cho, and Juho Lee.

</span>
<span class="ltx_bibblock">A simple early exiting framework for accelerated sampling in diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">International Conference on Machine Learning (ICML)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Naeem et al. (2020)</span>
<span class="ltx_bibblock">
Muhammad Ferjad Naeem, Seong Joon Oh, Youngjung Uh, Yunjey Choi, and Jaejun Yoo.

</span>
<span class="ltx_bibblock">Reliable fidelity and diversity metrics for generative models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">International Conference on Machine Learning</em>. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nistal et al. (2024)</span>
<span class="ltx_bibblock">
Javier Nistal, Marco Pasini, Cyran Aouameur, Maarten Grachten, and Stefan Lattner.

</span>
<span class="ltx_bibblock">Diff-a-riff: Musical accompaniment co-creation via latent diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv:2406.08384</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Novack et al. (2024a)</span>
<span class="ltx_bibblock">
Zachary Novack, Julian McAuley, Taylor Berg-Kirkpatrick, and Nicholas J. Bryan.

</span>
<span class="ltx_bibblock">DITTO-2: Distilled diffusion inference-time t-optimization for music generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">International Society for Music Information Retrieval (ISMIR)</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Novack et al. (2024b)</span>
<span class="ltx_bibblock">
Zachary Novack, Julian McAuley, Taylor Berg-Kirkpatrick, and Nicholas J. Bryan.

</span>
<span class="ltx_bibblock">DITTO: Diffusion inference-time T-optimization for music generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">International Conference on Machine Learning (ICML)</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peebles &amp; Xie (2023)</span>
<span class="ltx_bibblock">
William Peebles and Saining Xie.

</span>
<span class="ltx_bibblock">Scalable diffusion models with transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">IEEE/CVF International Conference on Computer Visio (ICCV)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2024)</span>
<span class="ltx_bibblock">
Yuxi Ren, Xin Xia, Yanzuo Lu, Jiacheng Zhang, Jie Wu, Pan Xie, Xing Wang, and Xuefeng Xiao.

</span>
<span class="ltx_bibblock">Hyper-SD: Trajectory segmented consistency model for efficient image synthesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv:2404.13686</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rombach et al. (2022)</span>
<span class="ltx_bibblock">
Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn Ommer.

</span>
<span class="ltx_bibblock">High-resolution image synthesis with latent diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sabour et al. (2024)</span>
<span class="ltx_bibblock">
Amirmojtaba Sabour, Sanja Fidler, and Karsten Kreis.

</span>
<span class="ltx_bibblock">Align your steps: Optimizing sampling schedules in diffusion models, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saito et al. (2024)</span>
<span class="ltx_bibblock">
Koichi Saito, Dongjun Kim, Takashi Shibuya, Chieh-Hsin Lai, Zhi-Wei Zhong, Yuhta Takida, and Yuki Mitsufuji.

</span>
<span class="ltx_bibblock">Soundctm: Uniting score-based and consistency models for text-to-sound generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv:2405.18503</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Salimans &amp; Ho (2022)</span>
<span class="ltx_bibblock">
Tim Salimans and Jonathan Ho.

</span>
<span class="ltx_bibblock">Progressive distillation for fast sampling of diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv:2202.00512</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sauer et al. (2023)</span>
<span class="ltx_bibblock">
Axel Sauer, Dominik Lorenz, A. Blattmann, and Robin Rombach.

</span>
<span class="ltx_bibblock">Adversarial diffusion distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">arXiv:2311.17042</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sauer et al. (2024)</span>
<span class="ltx_bibblock">
Axel Sauer, Frederic Boesel, Tim Dockhorn, A. Blattmann, Patrick Esser, and Robin Rombach.

</span>
<span class="ltx_bibblock">Fast high-resolution image synthesis with latent adversarial diffusion distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv:2403.12015</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schneider et al. (2023)</span>
<span class="ltx_bibblock">
Flavio Schneider, Zhijing Jin, and Bernhard Schölkopf.

</span>
<span class="ltx_bibblock">Mo<math alttext="\backslash" class="ltx_Math" display="inline" id="bib.bib51.1.m1.1"><semantics id="bib.bib51.1.m1.1a"><mo id="bib.bib51.1.m1.1.1" xref="bib.bib51.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="bib.bib51.1.m1.1b"><ci id="bib.bib51.1.m1.1.1.cmml" xref="bib.bib51.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib51.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="bib.bib51.1.m1.1d">\</annotation></semantics></math>^ usai: Text-to-music generation with long-context latent diffusion.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.2.1">arXiv:2301.11757</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schuster et al. (2021)</span>
<span class="ltx_bibblock">
Tal Schuster, Adam Fisch, Tommi Jaakkola, and Regina Barzilay.

</span>
<span class="ltx_bibblock">Consistent accelerated inference via confident adaptive transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">arXiv:2104.08803</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Si et al. (2024)</span>
<span class="ltx_bibblock">
Chenyang Si, Ziqi Huang, Yuming Jiang, and Ziwei Liu.

</span>
<span class="ltx_bibblock">FreeU: Free lunch in diffusion U-Net.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sohl-Dickstein et al. (2015)</span>
<span class="ltx_bibblock">
Jascha Sohl-Dickstein, Eric Weiss, Niru Maheswaranathan, and Surya Ganguli.

</span>
<span class="ltx_bibblock">Deep unsupervised learning using nonequilibrium thermodynamics.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">International Conference on Machine Learning (ICML)</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2020)</span>
<span class="ltx_bibblock">
Jiaming Song, Chenlin Meng, and Stefano Ermon.

</span>
<span class="ltx_bibblock">Denoising diffusion implicit models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">International Conference on Learning Representations (ICLR)</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2021)</span>
<span class="ltx_bibblock">
Yang Song, Jascha Sohl-Dickstein, Diederik P Kingma, Abhishek Kumar, Stefano Ermon, and Ben Poole.

</span>
<span class="ltx_bibblock">Score-based generative modeling through stochastic differential equations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2023)</span>
<span class="ltx_bibblock">
Yang Song, Prafulla Dhariwal, Mark Chen, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Consistency models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">International Conference on Machine Learning (ICML)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tal et al. (2024)</span>
<span class="ltx_bibblock">
Or Tal, Alon Ziv, Itai Gat, Felix Kreuk, and Yossi Adi.

</span>
<span class="ltx_bibblock">Joint audio and symbolic conditioning for temporally controlled text-to-music generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">arXiv:2406.10970</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024a)</span>
<span class="ltx_bibblock">
Fu-Yun Wang, Zhaoyang Huang, Alexander William Bergman, Dazhong Shen, Peng Gao, Michael Lingelbach, Keqiang Sun, Weikang Bian, Guanglu Song, Yu Liu, Hongsheng Li, and Xiaogang Wang.

</span>
<span class="ltx_bibblock">Phased consistency model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">arXiv:2405.18407</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024b)</span>
<span class="ltx_bibblock">
Yuqing Wang, Ye He, and Molei Tao.

</span>
<span class="ltx_bibblock">Evaluating the design space of diffusion-based generative models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">arXiv:2406.12839</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wimbauer et al. (2024)</span>
<span class="ltx_bibblock">
Felix Wimbauer, Bichen Wu, Edgar Schoenfeld, Xiaoliang Dai, Ji Hou, Zijian He, Artsiom Sanakoyeu, Peizhao Zhang, Sam Tsai, Jonas Kohler, et al.

</span>
<span class="ltx_bibblock">Cache me if you can: Accelerating diffusion models through block caching.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2023)</span>
<span class="ltx_bibblock">
Yusong Wu, Ke Chen, Tianyu Zhang, Yuchen Hui, Taylor Berg-Kirkpatrick, and Shlomo Dubnov.

</span>
<span class="ltx_bibblock">Large-scale contrastive language-audio pretraining with feature fusion and keyword-to-caption augmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">IEEE International Conference on Audio, Speech and Signal Processing (ICASSP)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2023)</span>
<span class="ltx_bibblock">
Tianwei Yin, Michaël Gharbi, Richard Zhang, Eli Shechtman, Fredo Durand, William T Freeman, and Taesung Park.

</span>
<span class="ltx_bibblock">One-step diffusion with distribution matching distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">arXiv:2311.18828</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2024)</span>
<span class="ltx_bibblock">
Tianwei Yin, Michaël Gharbi, Taesung Park, Richard Zhang, Eli Shechtman, Fredo Durand, and William T Freeman.

</span>
<span class="ltx_bibblock">Improved distribution matching distillation for fast image synthesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">arXiv:2405.14867</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeghidour et al. (2021)</span>
<span class="ltx_bibblock">
Neil Zeghidour, Alejandro Luebs, Ahmed Omran, Jan Skoglund, and Marco Tagliasacchi.

</span>
<span class="ltx_bibblock">SoundStream: An end-to-end neural audio codec.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">IEEE/ACM Transactions on Audio, Speech, and Language Processing (TASLP)</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023)</span>
<span class="ltx_bibblock">
Lvmin Zhang, Anyi Rao, and Maneesh Agrawala.

</span>
<span class="ltx_bibblock">Adding conditional control to text-to-image diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2023)</span>
<span class="ltx_bibblock">
Ge Zhu, Yutong Wen, Marc-André Carbonneau, and Zhiyao Duan.

</span>
<span class="ltx_bibblock">Edmsound: Spectrogram based diffusion models for efficient and high-quality audio synthesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">arXiv:2311.08667</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2024)</span>
<span class="ltx_bibblock">
Ge Zhu, Juan-Pablo Caceres, Zhiyao Duan, and Nicholas J. Bryan.

</span>
<span class="ltx_bibblock">MusicHiFi: Fast high-fidelity stereo vocoding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">IEEE Signal Processing Letters (SPL)</em>, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Model Design Details</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">As we perform latent diffusion, we first train a variational autoencoder. We build on the Improved RVQGAN <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib29" title="">2023</a>)</cite> architecture and training scheme by using a KL-bottleneck with a dimension of 32 and an effective hop of 960 samples, resulting in an approximately 45 Hz VAE. We train to convergence using the recommended mel-reconstruction loss and the least-squares GAN formulation with L1 feature matching on multi-period and multi-band discriminators.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">Our proposed base score model backbone builds upon DiT-XL <cite class="ltx_cite ltx_citemacro_citep">(Peebles &amp; Xie, <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib43" title="">2023</a>)</cite>, with modifications aimed at optimizing computational efficiency.
Specifically, we use a streamlined transformer block design, consisting of a single attention layer followed by a single feed-forward layer, similar to Llama <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib10" title="">2024</a>)</cite>.
Our model utilizes three types of conditions including noise levels (timesteps) for score estimation, beat per minute (BPM) values of the song, and text descriptions.
Following EDM, we apply a logarithmic transformation to the noise levels, followed by sinusoidal embeddings.
Similarly, BPM values are input as scalars then go through sinusoidal embeddings to generate BPM embeddings.
These processed noise-level embeddings and BPM embeddings are then combined and integrated into the DiT block through an adaptive layer normalization block.
For text conditioning, we compute text embedding tokens with T5-based encoders and concatenate with audio tokens at each attention layer.
As a result, the audio token query attends to a concatenated sequence of audio and text keys, enabling the model to jointly extract relevant information from both modalities. To provide baseline architectural speedups, we use FlashAttention-2 <cite class="ltx_cite ltx_citemacro_citep">(Dao, <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib8" title="">2023</a>)</cite> for the DiT and Pytorch 2.0’s built in graph compilation <cite class="ltx_cite ltx_citemacro_citep">(Ansel et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib2" title="">2024</a>)</cite> for the VAE decoder and MusicHifi mono-to-stereo.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.7">For the diffusion model hyparameter design, we follow <cite class="ltx_cite ltx_citemacro_citet">Karras et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib25" title="">2024</a>)</cite>. Specifically, we set <math alttext="\sigma_{\text{data}}=0.5" class="ltx_Math" display="inline" id="A1.SS1.p3.1.m1.1"><semantics id="A1.SS1.p3.1.m1.1a"><mrow id="A1.SS1.p3.1.m1.1.1" xref="A1.SS1.p3.1.m1.1.1.cmml"><msub id="A1.SS1.p3.1.m1.1.1.2" xref="A1.SS1.p3.1.m1.1.1.2.cmml"><mi id="A1.SS1.p3.1.m1.1.1.2.2" xref="A1.SS1.p3.1.m1.1.1.2.2.cmml">σ</mi><mtext id="A1.SS1.p3.1.m1.1.1.2.3" xref="A1.SS1.p3.1.m1.1.1.2.3a.cmml">data</mtext></msub><mo id="A1.SS1.p3.1.m1.1.1.1" xref="A1.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS1.p3.1.m1.1.1.3" xref="A1.SS1.p3.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.1.m1.1b"><apply id="A1.SS1.p3.1.m1.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1"><eq id="A1.SS1.p3.1.m1.1.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1.1"></eq><apply id="A1.SS1.p3.1.m1.1.1.2.cmml" xref="A1.SS1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p3.1.m1.1.1.2.1.cmml" xref="A1.SS1.p3.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS1.p3.1.m1.1.1.2.2.cmml" xref="A1.SS1.p3.1.m1.1.1.2.2">𝜎</ci><ci id="A1.SS1.p3.1.m1.1.1.2.3a.cmml" xref="A1.SS1.p3.1.m1.1.1.2.3"><mtext id="A1.SS1.p3.1.m1.1.1.2.3.cmml" mathsize="70%" xref="A1.SS1.p3.1.m1.1.1.2.3">data</mtext></ci></apply><cn id="A1.SS1.p3.1.m1.1.1.3.cmml" type="float" xref="A1.SS1.p3.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.1.m1.1c">\sigma_{\text{data}}=0.5</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.1.m1.1d">italic_σ start_POSTSUBSCRIPT data end_POSTSUBSCRIPT = 0.5</annotation></semantics></math>, <math alttext="P_{\text{mean}}=-0.4" class="ltx_Math" display="inline" id="A1.SS1.p3.2.m2.1"><semantics id="A1.SS1.p3.2.m2.1a"><mrow id="A1.SS1.p3.2.m2.1.1" xref="A1.SS1.p3.2.m2.1.1.cmml"><msub id="A1.SS1.p3.2.m2.1.1.2" xref="A1.SS1.p3.2.m2.1.1.2.cmml"><mi id="A1.SS1.p3.2.m2.1.1.2.2" xref="A1.SS1.p3.2.m2.1.1.2.2.cmml">P</mi><mtext id="A1.SS1.p3.2.m2.1.1.2.3" xref="A1.SS1.p3.2.m2.1.1.2.3a.cmml">mean</mtext></msub><mo id="A1.SS1.p3.2.m2.1.1.1" xref="A1.SS1.p3.2.m2.1.1.1.cmml">=</mo><mrow id="A1.SS1.p3.2.m2.1.1.3" xref="A1.SS1.p3.2.m2.1.1.3.cmml"><mo id="A1.SS1.p3.2.m2.1.1.3a" xref="A1.SS1.p3.2.m2.1.1.3.cmml">−</mo><mn id="A1.SS1.p3.2.m2.1.1.3.2" xref="A1.SS1.p3.2.m2.1.1.3.2.cmml">0.4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.2.m2.1b"><apply id="A1.SS1.p3.2.m2.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1"><eq id="A1.SS1.p3.2.m2.1.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1.1"></eq><apply id="A1.SS1.p3.2.m2.1.1.2.cmml" xref="A1.SS1.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p3.2.m2.1.1.2.1.cmml" xref="A1.SS1.p3.2.m2.1.1.2">subscript</csymbol><ci id="A1.SS1.p3.2.m2.1.1.2.2.cmml" xref="A1.SS1.p3.2.m2.1.1.2.2">𝑃</ci><ci id="A1.SS1.p3.2.m2.1.1.2.3a.cmml" xref="A1.SS1.p3.2.m2.1.1.2.3"><mtext id="A1.SS1.p3.2.m2.1.1.2.3.cmml" mathsize="70%" xref="A1.SS1.p3.2.m2.1.1.2.3">mean</mtext></ci></apply><apply id="A1.SS1.p3.2.m2.1.1.3.cmml" xref="A1.SS1.p3.2.m2.1.1.3"><minus id="A1.SS1.p3.2.m2.1.1.3.1.cmml" xref="A1.SS1.p3.2.m2.1.1.3"></minus><cn id="A1.SS1.p3.2.m2.1.1.3.2.cmml" type="float" xref="A1.SS1.p3.2.m2.1.1.3.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.2.m2.1c">P_{\text{mean}}=-0.4</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.2.m2.1d">italic_P start_POSTSUBSCRIPT mean end_POSTSUBSCRIPT = - 0.4</annotation></semantics></math>, <math alttext="P_{\text{std}}=1.0" class="ltx_Math" display="inline" id="A1.SS1.p3.3.m3.1"><semantics id="A1.SS1.p3.3.m3.1a"><mrow id="A1.SS1.p3.3.m3.1.1" xref="A1.SS1.p3.3.m3.1.1.cmml"><msub id="A1.SS1.p3.3.m3.1.1.2" xref="A1.SS1.p3.3.m3.1.1.2.cmml"><mi id="A1.SS1.p3.3.m3.1.1.2.2" xref="A1.SS1.p3.3.m3.1.1.2.2.cmml">P</mi><mtext id="A1.SS1.p3.3.m3.1.1.2.3" xref="A1.SS1.p3.3.m3.1.1.2.3a.cmml">std</mtext></msub><mo id="A1.SS1.p3.3.m3.1.1.1" xref="A1.SS1.p3.3.m3.1.1.1.cmml">=</mo><mn id="A1.SS1.p3.3.m3.1.1.3" xref="A1.SS1.p3.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.3.m3.1b"><apply id="A1.SS1.p3.3.m3.1.1.cmml" xref="A1.SS1.p3.3.m3.1.1"><eq id="A1.SS1.p3.3.m3.1.1.1.cmml" xref="A1.SS1.p3.3.m3.1.1.1"></eq><apply id="A1.SS1.p3.3.m3.1.1.2.cmml" xref="A1.SS1.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p3.3.m3.1.1.2.1.cmml" xref="A1.SS1.p3.3.m3.1.1.2">subscript</csymbol><ci id="A1.SS1.p3.3.m3.1.1.2.2.cmml" xref="A1.SS1.p3.3.m3.1.1.2.2">𝑃</ci><ci id="A1.SS1.p3.3.m3.1.1.2.3a.cmml" xref="A1.SS1.p3.3.m3.1.1.2.3"><mtext id="A1.SS1.p3.3.m3.1.1.2.3.cmml" mathsize="70%" xref="A1.SS1.p3.3.m3.1.1.2.3">std</mtext></ci></apply><cn id="A1.SS1.p3.3.m3.1.1.3.cmml" type="float" xref="A1.SS1.p3.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.3.m3.1c">P_{\text{std}}=1.0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.3.m3.1d">italic_P start_POSTSUBSCRIPT std end_POSTSUBSCRIPT = 1.0</annotation></semantics></math>, <math alttext="\sigma_{\text{max}}=80" class="ltx_Math" display="inline" id="A1.SS1.p3.4.m4.1"><semantics id="A1.SS1.p3.4.m4.1a"><mrow id="A1.SS1.p3.4.m4.1.1" xref="A1.SS1.p3.4.m4.1.1.cmml"><msub id="A1.SS1.p3.4.m4.1.1.2" xref="A1.SS1.p3.4.m4.1.1.2.cmml"><mi id="A1.SS1.p3.4.m4.1.1.2.2" xref="A1.SS1.p3.4.m4.1.1.2.2.cmml">σ</mi><mtext id="A1.SS1.p3.4.m4.1.1.2.3" xref="A1.SS1.p3.4.m4.1.1.2.3a.cmml">max</mtext></msub><mo id="A1.SS1.p3.4.m4.1.1.1" xref="A1.SS1.p3.4.m4.1.1.1.cmml">=</mo><mn id="A1.SS1.p3.4.m4.1.1.3" xref="A1.SS1.p3.4.m4.1.1.3.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.4.m4.1b"><apply id="A1.SS1.p3.4.m4.1.1.cmml" xref="A1.SS1.p3.4.m4.1.1"><eq id="A1.SS1.p3.4.m4.1.1.1.cmml" xref="A1.SS1.p3.4.m4.1.1.1"></eq><apply id="A1.SS1.p3.4.m4.1.1.2.cmml" xref="A1.SS1.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p3.4.m4.1.1.2.1.cmml" xref="A1.SS1.p3.4.m4.1.1.2">subscript</csymbol><ci id="A1.SS1.p3.4.m4.1.1.2.2.cmml" xref="A1.SS1.p3.4.m4.1.1.2.2">𝜎</ci><ci id="A1.SS1.p3.4.m4.1.1.2.3a.cmml" xref="A1.SS1.p3.4.m4.1.1.2.3"><mtext id="A1.SS1.p3.4.m4.1.1.2.3.cmml" mathsize="70%" xref="A1.SS1.p3.4.m4.1.1.2.3">max</mtext></ci></apply><cn id="A1.SS1.p3.4.m4.1.1.3.cmml" type="integer" xref="A1.SS1.p3.4.m4.1.1.3">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.4.m4.1c">\sigma_{\text{max}}=80</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.4.m4.1d">italic_σ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT = 80</annotation></semantics></math>, <math alttext="\sigma_{\text{min}}=0.002" class="ltx_Math" display="inline" id="A1.SS1.p3.5.m5.1"><semantics id="A1.SS1.p3.5.m5.1a"><mrow id="A1.SS1.p3.5.m5.1.1" xref="A1.SS1.p3.5.m5.1.1.cmml"><msub id="A1.SS1.p3.5.m5.1.1.2" xref="A1.SS1.p3.5.m5.1.1.2.cmml"><mi id="A1.SS1.p3.5.m5.1.1.2.2" xref="A1.SS1.p3.5.m5.1.1.2.2.cmml">σ</mi><mtext id="A1.SS1.p3.5.m5.1.1.2.3" xref="A1.SS1.p3.5.m5.1.1.2.3a.cmml">min</mtext></msub><mo id="A1.SS1.p3.5.m5.1.1.1" xref="A1.SS1.p3.5.m5.1.1.1.cmml">=</mo><mn id="A1.SS1.p3.5.m5.1.1.3" xref="A1.SS1.p3.5.m5.1.1.3.cmml">0.002</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.5.m5.1b"><apply id="A1.SS1.p3.5.m5.1.1.cmml" xref="A1.SS1.p3.5.m5.1.1"><eq id="A1.SS1.p3.5.m5.1.1.1.cmml" xref="A1.SS1.p3.5.m5.1.1.1"></eq><apply id="A1.SS1.p3.5.m5.1.1.2.cmml" xref="A1.SS1.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p3.5.m5.1.1.2.1.cmml" xref="A1.SS1.p3.5.m5.1.1.2">subscript</csymbol><ci id="A1.SS1.p3.5.m5.1.1.2.2.cmml" xref="A1.SS1.p3.5.m5.1.1.2.2">𝜎</ci><ci id="A1.SS1.p3.5.m5.1.1.2.3a.cmml" xref="A1.SS1.p3.5.m5.1.1.2.3"><mtext id="A1.SS1.p3.5.m5.1.1.2.3.cmml" mathsize="70%" xref="A1.SS1.p3.5.m5.1.1.2.3">min</mtext></ci></apply><cn id="A1.SS1.p3.5.m5.1.1.3.cmml" type="float" xref="A1.SS1.p3.5.m5.1.1.3">0.002</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.5.m5.1c">\sigma_{\text{min}}=0.002</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.5.m5.1d">italic_σ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT = 0.002</annotation></semantics></math>. We train the base model with <math alttext="10\%" class="ltx_Math" display="inline" id="A1.SS1.p3.6.m6.1"><semantics id="A1.SS1.p3.6.m6.1a"><mrow id="A1.SS1.p3.6.m6.1.1" xref="A1.SS1.p3.6.m6.1.1.cmml"><mn id="A1.SS1.p3.6.m6.1.1.2" xref="A1.SS1.p3.6.m6.1.1.2.cmml">10</mn><mo id="A1.SS1.p3.6.m6.1.1.1" xref="A1.SS1.p3.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.6.m6.1b"><apply id="A1.SS1.p3.6.m6.1.1.cmml" xref="A1.SS1.p3.6.m6.1.1"><csymbol cd="latexml" id="A1.SS1.p3.6.m6.1.1.1.cmml" xref="A1.SS1.p3.6.m6.1.1.1">percent</csymbol><cn id="A1.SS1.p3.6.m6.1.1.2.cmml" type="integer" xref="A1.SS1.p3.6.m6.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.6.m6.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.6.m6.1d">10 %</annotation></semantics></math> condition dropout to enable CFG. The base model was trained for 5 days across 32 A100 GPUs with a batch size of 14 and learning rate of 1e-4 with Adam. For all score model experiments, we use CFG++ <cite class="ltx_cite ltx_citemacro_citep">(Chung et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib6" title="">2024</a>)</cite> with <math alttext="w=0.8" class="ltx_Math" display="inline" id="A1.SS1.p3.7.m7.1"><semantics id="A1.SS1.p3.7.m7.1a"><mrow id="A1.SS1.p3.7.m7.1.1" xref="A1.SS1.p3.7.m7.1.1.cmml"><mi id="A1.SS1.p3.7.m7.1.1.2" xref="A1.SS1.p3.7.m7.1.1.2.cmml">w</mi><mo id="A1.SS1.p3.7.m7.1.1.1" xref="A1.SS1.p3.7.m7.1.1.1.cmml">=</mo><mn id="A1.SS1.p3.7.m7.1.1.3" xref="A1.SS1.p3.7.m7.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.7.m7.1b"><apply id="A1.SS1.p3.7.m7.1.1.cmml" xref="A1.SS1.p3.7.m7.1.1"><eq id="A1.SS1.p3.7.m7.1.1.1.cmml" xref="A1.SS1.p3.7.m7.1.1.1"></eq><ci id="A1.SS1.p3.7.m7.1.1.2.cmml" xref="A1.SS1.p3.7.m7.1.1.2">𝑤</ci><cn id="A1.SS1.p3.7.m7.1.1.3.cmml" type="float" xref="A1.SS1.p3.7.m7.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.7.m7.1c">w=0.8</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.7.m7.1d">italic_w = 0.8</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p4">
<p class="ltx_p" id="A1.SS1.p4.1">For <span class="ltx_text ltx_font_bold" id="A1.SS1.p4.1.1">Presto-S</span>, following <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib64" title="">2024</a>)</cite> we use a fixed guidance scale of <math alttext="w=4.5" class="ltx_Math" display="inline" id="A1.SS1.p4.1.m1.1"><semantics id="A1.SS1.p4.1.m1.1a"><mrow id="A1.SS1.p4.1.m1.1.1" xref="A1.SS1.p4.1.m1.1.1.cmml"><mi id="A1.SS1.p4.1.m1.1.1.2" xref="A1.SS1.p4.1.m1.1.1.2.cmml">w</mi><mo id="A1.SS1.p4.1.m1.1.1.1" xref="A1.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS1.p4.1.m1.1.1.3" xref="A1.SS1.p4.1.m1.1.1.3.cmml">4.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.1.m1.1b"><apply id="A1.SS1.p4.1.m1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1"><eq id="A1.SS1.p4.1.m1.1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1.1"></eq><ci id="A1.SS1.p4.1.m1.1.1.2.cmml" xref="A1.SS1.p4.1.m1.1.1.2">𝑤</ci><cn id="A1.SS1.p4.1.m1.1.1.3.cmml" type="float" xref="A1.SS1.p4.1.m1.1.1.3">4.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.1.m1.1c">w=4.5</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.1.m1.1d">italic_w = 4.5</annotation></semantics></math> throughout distillation for the teacher model as CFG++ is not applicable for the distribution matching gradient. Additionally, we use a learning rate of 5e-7 with Adam. For all step distillation methods, we distill each model with a batch size of 80 across 16 Nvidia A100 GPUs for 32K iterations. We train all layer distillation methods for 60K iterations with a batch size of 12 across 16 A100 GPUs.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Baseline Description</h3>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">We benchmark against multiple diffusion acceleration algorithms and open-source models:</p>
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.2">Consistency Models (CM) <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib57" title="">2023</a>; Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib3" title="">2024</a>)</cite>:
This distillation technique learns a mapping from anywhere on the diffusion process to the data distribution (i.e. <math alttext="\bm{x}_{t}\rightarrow\bm{x}_{0}" class="ltx_Math" display="inline" id="A1.I1.i1.p1.1.m1.1"><semantics id="A1.I1.i1.p1.1.m1.1a"><mrow id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml"><msub id="A1.I1.i1.p1.1.m1.1.1.2" xref="A1.I1.i1.p1.1.m1.1.1.2.cmml"><mi id="A1.I1.i1.p1.1.m1.1.1.2.2" xref="A1.I1.i1.p1.1.m1.1.1.2.2.cmml">𝒙</mi><mi id="A1.I1.i1.p1.1.m1.1.1.2.3" xref="A1.I1.i1.p1.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="A1.I1.i1.p1.1.m1.1.1.1" stretchy="false" xref="A1.I1.i1.p1.1.m1.1.1.1.cmml">→</mo><msub id="A1.I1.i1.p1.1.m1.1.1.3" xref="A1.I1.i1.p1.1.m1.1.1.3.cmml"><mi id="A1.I1.i1.p1.1.m1.1.1.3.2" xref="A1.I1.i1.p1.1.m1.1.1.3.2.cmml">𝒙</mi><mn id="A1.I1.i1.p1.1.m1.1.1.3.3" xref="A1.I1.i1.p1.1.m1.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b"><apply id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1"><ci id="A1.I1.i1.p1.1.m1.1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1.1">→</ci><apply id="A1.I1.i1.p1.1.m1.1.1.2.cmml" xref="A1.I1.i1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1.2">subscript</csymbol><ci id="A1.I1.i1.p1.1.m1.1.1.2.2.cmml" xref="A1.I1.i1.p1.1.m1.1.1.2.2">𝒙</ci><ci id="A1.I1.i1.p1.1.m1.1.1.2.3.cmml" xref="A1.I1.i1.p1.1.m1.1.1.2.3">𝑡</ci></apply><apply id="A1.I1.i1.p1.1.m1.1.1.3.cmml" xref="A1.I1.i1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1.3">subscript</csymbol><ci id="A1.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="A1.I1.i1.p1.1.m1.1.1.3.2">𝒙</ci><cn id="A1.I1.i1.p1.1.m1.1.1.3.3.cmml" type="integer" xref="A1.I1.i1.p1.1.m1.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">\bm{x}_{t}\rightarrow\bm{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT → bold_italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>) by enforcing the self-consistency property that <math alttext="G_{\bm{\phi}}(\bm{x}_{t},t)=G_{\bm{\phi}}(\bm{x}_{t^{\prime}},t^{\prime})\quad%
\forall t,t^{\prime}" class="ltx_Math" display="inline" id="A1.I1.i1.p1.2.m2.5"><semantics id="A1.I1.i1.p1.2.m2.5a"><mrow id="A1.I1.i1.p1.2.m2.5.5" xref="A1.I1.i1.p1.2.m2.5.5.cmml"><mrow id="A1.I1.i1.p1.2.m2.2.2.1" xref="A1.I1.i1.p1.2.m2.2.2.1.cmml"><msub id="A1.I1.i1.p1.2.m2.2.2.1.3" xref="A1.I1.i1.p1.2.m2.2.2.1.3.cmml"><mi id="A1.I1.i1.p1.2.m2.2.2.1.3.2" xref="A1.I1.i1.p1.2.m2.2.2.1.3.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="A1.I1.i1.p1.2.m2.2.2.1.3.3" mathvariant="bold-italic" xref="A1.I1.i1.p1.2.m2.2.2.1.3.3.cmml">ϕ</mi></msub><mo id="A1.I1.i1.p1.2.m2.2.2.1.2" xref="A1.I1.i1.p1.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="A1.I1.i1.p1.2.m2.2.2.1.1.1" xref="A1.I1.i1.p1.2.m2.2.2.1.1.2.cmml"><mo id="A1.I1.i1.p1.2.m2.2.2.1.1.1.2" stretchy="false" xref="A1.I1.i1.p1.2.m2.2.2.1.1.2.cmml">(</mo><msub id="A1.I1.i1.p1.2.m2.2.2.1.1.1.1" xref="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.2" xref="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.2.cmml">𝒙</mi><mi id="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.3" xref="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.I1.i1.p1.2.m2.2.2.1.1.1.3" xref="A1.I1.i1.p1.2.m2.2.2.1.1.2.cmml">,</mo><mi id="A1.I1.i1.p1.2.m2.1.1" xref="A1.I1.i1.p1.2.m2.1.1.cmml">t</mi><mo id="A1.I1.i1.p1.2.m2.2.2.1.1.1.4" stretchy="false" xref="A1.I1.i1.p1.2.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.I1.i1.p1.2.m2.5.5.5" xref="A1.I1.i1.p1.2.m2.5.5.5.cmml">=</mo><mrow id="A1.I1.i1.p1.2.m2.5.5.4.3" xref="A1.I1.i1.p1.2.m2.5.5.4.4.cmml"><mrow id="A1.I1.i1.p1.2.m2.3.3.2.1.1" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.cmml"><msub id="A1.I1.i1.p1.2.m2.3.3.2.1.1.4" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.cmml"><mi id="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.2" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.3" mathvariant="bold-italic" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.3.cmml">ϕ</mi></msub><mo id="A1.I1.i1.p1.2.m2.3.3.2.1.1.3" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.3.cmml">⁢</mo><mrow id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.3.cmml"><mo id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.3" stretchy="false" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.3.cmml">(</mo><msub id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.cmml"><mi id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.2" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.2.cmml">𝒙</mi><msup id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.cmml"><mi id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.2" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.3" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.3.cmml">′</mo></msup></msub><mo id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.4" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.3.cmml">,</mo><msup id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.cmml"><mi id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.2" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.2.cmml">t</mi><mo id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.3" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.3.cmml">′</mo></msup><mo id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.5" stretchy="false" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.3.cmml">)</mo></mrow></mrow><mspace id="A1.I1.i1.p1.2.m2.5.5.4.3.4" width="1.167em" xref="A1.I1.i1.p1.2.m2.5.5.4.4.cmml"></mspace><mrow id="A1.I1.i1.p1.2.m2.4.4.3.2.2" xref="A1.I1.i1.p1.2.m2.4.4.3.2.2.cmml"><mo id="A1.I1.i1.p1.2.m2.4.4.3.2.2.1" rspace="0.167em" xref="A1.I1.i1.p1.2.m2.4.4.3.2.2.1.cmml">∀</mo><mi id="A1.I1.i1.p1.2.m2.4.4.3.2.2.2" xref="A1.I1.i1.p1.2.m2.4.4.3.2.2.2.cmml">t</mi></mrow><mo id="A1.I1.i1.p1.2.m2.5.5.4.3.5" xref="A1.I1.i1.p1.2.m2.5.5.4.4.cmml">,</mo><msup id="A1.I1.i1.p1.2.m2.5.5.4.3.3" xref="A1.I1.i1.p1.2.m2.5.5.4.3.3.cmml"><mi id="A1.I1.i1.p1.2.m2.5.5.4.3.3.2" xref="A1.I1.i1.p1.2.m2.5.5.4.3.3.2.cmml">t</mi><mo id="A1.I1.i1.p1.2.m2.5.5.4.3.3.3" xref="A1.I1.i1.p1.2.m2.5.5.4.3.3.3.cmml">′</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.2.m2.5b"><apply id="A1.I1.i1.p1.2.m2.5.5.cmml" xref="A1.I1.i1.p1.2.m2.5.5"><eq id="A1.I1.i1.p1.2.m2.5.5.5.cmml" xref="A1.I1.i1.p1.2.m2.5.5.5"></eq><apply id="A1.I1.i1.p1.2.m2.2.2.1.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1"><times id="A1.I1.i1.p1.2.m2.2.2.1.2.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1.2"></times><apply id="A1.I1.i1.p1.2.m2.2.2.1.3.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="A1.I1.i1.p1.2.m2.2.2.1.3.1.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1.3">subscript</csymbol><ci id="A1.I1.i1.p1.2.m2.2.2.1.3.2.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1.3.2">𝐺</ci><ci id="A1.I1.i1.p1.2.m2.2.2.1.3.3.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1.3.3">bold-italic-ϕ</ci></apply><interval closure="open" id="A1.I1.i1.p1.2.m2.2.2.1.1.2.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1.1.1"><apply id="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.2">𝒙</ci><ci id="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="A1.I1.i1.p1.2.m2.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="A1.I1.i1.p1.2.m2.1.1.cmml" xref="A1.I1.i1.p1.2.m2.1.1">𝑡</ci></interval></apply><list id="A1.I1.i1.p1.2.m2.5.5.4.4.cmml" xref="A1.I1.i1.p1.2.m2.5.5.4.3"><apply id="A1.I1.i1.p1.2.m2.3.3.2.1.1.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1"><times id="A1.I1.i1.p1.2.m2.3.3.2.1.1.3.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.3"></times><apply id="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.4"><csymbol cd="ambiguous" id="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.1.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.4">subscript</csymbol><ci id="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.2.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.2">𝐺</ci><ci id="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.3.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.4.3">bold-italic-ϕ</ci></apply><interval closure="open" id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.3.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2"><apply id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.1.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1">subscript</csymbol><ci id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.2.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.2">𝒙</ci><apply id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.1.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3">superscript</csymbol><ci id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.2.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.2">𝑡</ci><ci id="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.3.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.1.1.1.3.3">′</ci></apply></apply><apply id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.1.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2">superscript</csymbol><ci id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.2.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.2">𝑡</ci><ci id="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.3.cmml" xref="A1.I1.i1.p1.2.m2.3.3.2.1.1.2.2.2.3">′</ci></apply></interval></apply><apply id="A1.I1.i1.p1.2.m2.4.4.3.2.2.cmml" xref="A1.I1.i1.p1.2.m2.4.4.3.2.2"><csymbol cd="latexml" id="A1.I1.i1.p1.2.m2.4.4.3.2.2.1.cmml" xref="A1.I1.i1.p1.2.m2.4.4.3.2.2.1">for-all</csymbol><ci id="A1.I1.i1.p1.2.m2.4.4.3.2.2.2.cmml" xref="A1.I1.i1.p1.2.m2.4.4.3.2.2.2">𝑡</ci></apply><apply id="A1.I1.i1.p1.2.m2.5.5.4.3.3.cmml" xref="A1.I1.i1.p1.2.m2.5.5.4.3.3"><csymbol cd="ambiguous" id="A1.I1.i1.p1.2.m2.5.5.4.3.3.1.cmml" xref="A1.I1.i1.p1.2.m2.5.5.4.3.3">superscript</csymbol><ci id="A1.I1.i1.p1.2.m2.5.5.4.3.3.2.cmml" xref="A1.I1.i1.p1.2.m2.5.5.4.3.3.2">𝑡</ci><ci id="A1.I1.i1.p1.2.m2.5.5.4.3.3.3.cmml" xref="A1.I1.i1.p1.2.m2.5.5.4.3.3.3">′</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.2.m2.5c">G_{\bm{\phi}}(\bm{x}_{t},t)=G_{\bm{\phi}}(\bm{x}_{t^{\prime}},t^{\prime})\quad%
\forall t,t^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.2.m2.5d">italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) = italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ∀ italic_t , italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. We follow the parameterization used in past audio works <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib3" title="">2024</a>; Novack et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib41" title="">2024a</a>)</cite> that additionally distills the CFG parameter into the model directly.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.1">SoundCTM <cite class="ltx_cite ltx_citemacro_citep">(Saito et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib47" title="">2024</a>)</cite>:
This approach distills a model into a consistency <em class="ltx_emph ltx_font_italic" id="A1.I1.i2.p1.1.1">trajectory</em> model <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib27" title="">2023</a>)</cite> that enforces the self-consistency property for the entire diffusion process, learning an anywhere-to-anwhere mapping. SoundCTM forgoes the original CTM adversarial loss and calculates the consistency loss using intermediate features of the base model.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.1">DITTO-CTM <cite class="ltx_cite ltx_citemacro_citep">(Novack et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib41" title="">2024a</a>)</cite>,
This audio approach is also based off of <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib27" title="">2023</a>)</cite>, yet brings the consistency loss back into the raw outputs and instead replaces CTM’s multi-step teacher distillation with single-step teacher (like CMs) and removes the learned target timestep embedding, thus more efficient (though less complete) than SoundCTM.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I1.i4.p1">
<p class="ltx_p" id="A1.I1.i4.p1.1">DMD-GAN <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib64" title="">2024</a>)</cite>:
This approach removes the distribution matching loss from DMD2, making it a fully GAN-based finetuning method, which is in line with past adversarial distillation methods <cite class="ltx_cite ltx_citemacro_citep">(Sauer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib49" title="">2023</a>)</cite>).</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I1.i5.p1">
<p class="ltx_p" id="A1.I1.i5.p1.1">ASE <cite class="ltx_cite ltx_citemacro_citep">(Moon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib38" title="">2024</a>)</cite>,
This funetuning approach for diffusion models, as discussed in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S3.SS3" title="3.3 Presto-L: Variance and Budget-Aware Layer Dropping ‣ 3 Presto! ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">3.3</span></a>, finetunes the base model with the standard DSM loss, but for each noise level drops a fixed number of layers, starting at the back of the diffusion model’s DiT blocks.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I1.i6.p1">
<p class="ltx_p" id="A1.I1.i6.p1.1">MusicGen <cite class="ltx_cite ltx_citemacro_citep">(Copet et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib7" title="">2023</a>)</cite>: MusicGen is a non-diffusion based music generation model that uses an autoregressive model to predict discrete audio tokens <cite class="ltx_cite ltx_citemacro_citep">(Défossez et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib11" title="">2022</a>)</cite> at each timestep in sequence, and comes in small, medium, and large variants (all stereo).</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I1.i7.p1">
<p class="ltx_p" id="A1.I1.i7.p1.1">Stable Audio Open <cite class="ltx_cite ltx_citemacro_citep">(Evans et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib14" title="">2024c</a>)</cite>: Stable Audio Open is a SOTA open-source audio diffusion model, which can generate variable lengths up to 45s in duration. Stable Audio Open follows a similar design to our base model, yet uses cross-attention for conditioning rather than AdaLN which we use, which increases runtime.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span><span class="ltx_text ltx_font_bold" id="A1.SS3.1.1">Presto-S</span> Algorithm</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">Our complete <span class="ltx_text ltx_font_bold" id="A1.SS3.p1.1.1">Presto-S</span> algorithm is outlined below. For a visual representation, please see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.3.1.1">Algorithm 1</span> </span> <span class="ltx_text ltx_font_bold" id="alg1.4.2">Presto-S</span></figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline">0:</span>  : generator <math alttext="G_{\bm{\phi}}" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><msub id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml"><mi id="alg1.l0.m1.1.1.2" xref="alg1.l0.m1.1.1.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="alg1.l0.m1.1.1.3" mathvariant="bold-italic" xref="alg1.l0.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><apply id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m1.1.1.1.cmml" xref="alg1.l0.m1.1.1">subscript</csymbol><ci id="alg1.l0.m1.1.1.2.cmml" xref="alg1.l0.m1.1.1.2">𝐺</ci><ci id="alg1.l0.m1.1.1.3.cmml" xref="alg1.l0.m1.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">G_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>, real score model <math alttext="\mu_{\text{real}}" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><msub id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml"><mi id="alg1.l0.m2.1.1.2" xref="alg1.l0.m2.1.1.2.cmml">μ</mi><mtext id="alg1.l0.m2.1.1.3" xref="alg1.l0.m2.1.1.3a.cmml">real</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><apply id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.cmml" xref="alg1.l0.m2.1.1">subscript</csymbol><ci id="alg1.l0.m2.1.1.2.cmml" xref="alg1.l0.m2.1.1.2">𝜇</ci><ci id="alg1.l0.m2.1.1.3a.cmml" xref="alg1.l0.m2.1.1.3"><mtext id="alg1.l0.m2.1.1.3.cmml" mathsize="70%" xref="alg1.l0.m2.1.1.3">real</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">\mu_{\text{real}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">italic_μ start_POSTSUBSCRIPT real end_POSTSUBSCRIPT</annotation></semantics></math>, fake score model <math alttext="\mu_{\bm{\psi}}" class="ltx_Math" display="inline" id="alg1.l0.m3.1"><semantics id="alg1.l0.m3.1a"><msub id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml"><mi id="alg1.l0.m3.1.1.2" xref="alg1.l0.m3.1.1.2.cmml">μ</mi><mi id="alg1.l0.m3.1.1.3" xref="alg1.l0.m3.1.1.3.cmml">𝝍</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><apply id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1"><csymbol cd="ambiguous" id="alg1.l0.m3.1.1.1.cmml" xref="alg1.l0.m3.1.1">subscript</csymbol><ci id="alg1.l0.m3.1.1.2.cmml" xref="alg1.l0.m3.1.1.2">𝜇</ci><ci id="alg1.l0.m3.1.1.3.cmml" xref="alg1.l0.m3.1.1.3">𝝍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">\mu_{\bm{\psi}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.1d">italic_μ start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math>, discriminator <math alttext="D_{\bm{\psi}}" class="ltx_Math" display="inline" id="alg1.l0.m4.1"><semantics id="alg1.l0.m4.1a"><msub id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml"><mi id="alg1.l0.m4.1.1.2" xref="alg1.l0.m4.1.1.2.cmml">D</mi><mi id="alg1.l0.m4.1.1.3" xref="alg1.l0.m4.1.1.3.cmml">𝝍</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><apply id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1"><csymbol cd="ambiguous" id="alg1.l0.m4.1.1.1.cmml" xref="alg1.l0.m4.1.1">subscript</csymbol><ci id="alg1.l0.m4.1.1.2.cmml" xref="alg1.l0.m4.1.1.2">𝐷</ci><ci id="alg1.l0.m4.1.1.3.cmml" xref="alg1.l0.m4.1.1.3">𝝍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">D_{\bm{\psi}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m4.1d">italic_D start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> , CFG weight <math alttext="w" class="ltx_Math" display="inline" id="alg1.l0.m5.1"><semantics id="alg1.l0.m5.1a"><mi id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">w</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m5.1d">italic_w</annotation></semantics></math>, <math alttext="p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}(\sigma^{\text{inf}})" class="ltx_Math" display="inline" id="alg1.l0.m6.1"><semantics id="alg1.l0.m6.1a"><mrow id="alg1.l0.m6.1.1" xref="alg1.l0.m6.1.1.cmml"><msub id="alg1.l0.m6.1.1.3" xref="alg1.l0.m6.1.1.3.cmml"><mi id="alg1.l0.m6.1.1.3.2" xref="alg1.l0.m6.1.1.3.2.cmml">p</mi><mtext id="alg1.l0.m6.1.1.3.3" mathcolor="#C00000" xref="alg1.l0.m6.1.1.3.3a.cmml">gen</mtext></msub><mo id="alg1.l0.m6.1.1.2" xref="alg1.l0.m6.1.1.2.cmml">⁢</mo><mrow id="alg1.l0.m6.1.1.1.1" xref="alg1.l0.m6.1.1.1.1.1.cmml"><mo id="alg1.l0.m6.1.1.1.1.2" stretchy="false" xref="alg1.l0.m6.1.1.1.1.1.cmml">(</mo><msup id="alg1.l0.m6.1.1.1.1.1" xref="alg1.l0.m6.1.1.1.1.1.cmml"><mi id="alg1.l0.m6.1.1.1.1.1.2" xref="alg1.l0.m6.1.1.1.1.1.2.cmml">σ</mi><mtext id="alg1.l0.m6.1.1.1.1.1.3" xref="alg1.l0.m6.1.1.1.1.1.3a.cmml">inf</mtext></msup><mo id="alg1.l0.m6.1.1.1.1.3" stretchy="false" xref="alg1.l0.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m6.1b"><apply id="alg1.l0.m6.1.1.cmml" xref="alg1.l0.m6.1.1"><times id="alg1.l0.m6.1.1.2.cmml" xref="alg1.l0.m6.1.1.2"></times><apply id="alg1.l0.m6.1.1.3.cmml" xref="alg1.l0.m6.1.1.3"><csymbol cd="ambiguous" id="alg1.l0.m6.1.1.3.1.cmml" xref="alg1.l0.m6.1.1.3">subscript</csymbol><ci id="alg1.l0.m6.1.1.3.2.cmml" xref="alg1.l0.m6.1.1.3.2">𝑝</ci><ci id="alg1.l0.m6.1.1.3.3a.cmml" xref="alg1.l0.m6.1.1.3.3"><mtext id="alg1.l0.m6.1.1.3.3.cmml" mathcolor="#C00000" mathsize="70%" xref="alg1.l0.m6.1.1.3.3">gen</mtext></ci></apply><apply id="alg1.l0.m6.1.1.1.1.1.cmml" xref="alg1.l0.m6.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m6.1.1.1.1.1.1.cmml" xref="alg1.l0.m6.1.1.1.1">superscript</csymbol><ci id="alg1.l0.m6.1.1.1.1.1.2.cmml" xref="alg1.l0.m6.1.1.1.1.1.2">𝜎</ci><ci id="alg1.l0.m6.1.1.1.1.1.3a.cmml" xref="alg1.l0.m6.1.1.1.1.1.3"><mtext id="alg1.l0.m6.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l0.m6.1.1.1.1.1.3">inf</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m6.1c">p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}gen}}}(\sigma^{\text{inf}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m6.1d">italic_p start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT )</annotation></semantics></math>, <math alttext="p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="alg1.l0.m7.1"><semantics id="alg1.l0.m7.1a"><mrow id="alg1.l0.m7.1.1" xref="alg1.l0.m7.1.1.cmml"><msub id="alg1.l0.m7.1.1.3" xref="alg1.l0.m7.1.1.3.cmml"><mi id="alg1.l0.m7.1.1.3.2" xref="alg1.l0.m7.1.1.3.2.cmml">p</mi><mtext id="alg1.l0.m7.1.1.3.3" mathcolor="#FBBD00" xref="alg1.l0.m7.1.1.3.3a.cmml">DMD</mtext></msub><mo id="alg1.l0.m7.1.1.2" xref="alg1.l0.m7.1.1.2.cmml">⁢</mo><mrow id="alg1.l0.m7.1.1.1.1" xref="alg1.l0.m7.1.1.1.1.1.cmml"><mo id="alg1.l0.m7.1.1.1.1.2" stretchy="false" xref="alg1.l0.m7.1.1.1.1.1.cmml">(</mo><msup id="alg1.l0.m7.1.1.1.1.1" xref="alg1.l0.m7.1.1.1.1.1.cmml"><mi id="alg1.l0.m7.1.1.1.1.1.2" xref="alg1.l0.m7.1.1.1.1.1.2.cmml">σ</mi><mtext id="alg1.l0.m7.1.1.1.1.1.3" xref="alg1.l0.m7.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="alg1.l0.m7.1.1.1.1.3" stretchy="false" xref="alg1.l0.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m7.1b"><apply id="alg1.l0.m7.1.1.cmml" xref="alg1.l0.m7.1.1"><times id="alg1.l0.m7.1.1.2.cmml" xref="alg1.l0.m7.1.1.2"></times><apply id="alg1.l0.m7.1.1.3.cmml" xref="alg1.l0.m7.1.1.3"><csymbol cd="ambiguous" id="alg1.l0.m7.1.1.3.1.cmml" xref="alg1.l0.m7.1.1.3">subscript</csymbol><ci id="alg1.l0.m7.1.1.3.2.cmml" xref="alg1.l0.m7.1.1.3.2">𝑝</ci><ci id="alg1.l0.m7.1.1.3.3a.cmml" xref="alg1.l0.m7.1.1.3.3"><mtext id="alg1.l0.m7.1.1.3.3.cmml" mathcolor="#FBBD00" mathsize="70%" xref="alg1.l0.m7.1.1.3.3">DMD</mtext></ci></apply><apply id="alg1.l0.m7.1.1.1.1.1.cmml" xref="alg1.l0.m7.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m7.1.1.1.1.1.1.cmml" xref="alg1.l0.m7.1.1.1.1">superscript</csymbol><ci id="alg1.l0.m7.1.1.1.1.1.2.cmml" xref="alg1.l0.m7.1.1.1.1.1.2">𝜎</ci><ci id="alg1.l0.m7.1.1.1.1.1.3a.cmml" xref="alg1.l0.m7.1.1.1.1.1.3"><mtext id="alg1.l0.m7.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l0.m7.1.1.1.1.1.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m7.1c">p_{\text{{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}%
{rgb}{0.984375,0.7421875,0}DMD}}}(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m7.1d">italic_p start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>, <math alttext="p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{%
train}})" class="ltx_Math" display="inline" id="alg1.l0.m8.1"><semantics id="alg1.l0.m8.1a"><mrow id="alg1.l0.m8.1.1" xref="alg1.l0.m8.1.1.cmml"><msub id="alg1.l0.m8.1.1.3" xref="alg1.l0.m8.1.1.3.cmml"><mi id="alg1.l0.m8.1.1.3.2" xref="alg1.l0.m8.1.1.3.2.cmml">p</mi><mtext id="alg1.l0.m8.1.1.3.3" mathcolor="#2E5F7F" xref="alg1.l0.m8.1.1.3.3a.cmml">DSM</mtext></msub><mo id="alg1.l0.m8.1.1.2" xref="alg1.l0.m8.1.1.2.cmml">⁢</mo><mrow id="alg1.l0.m8.1.1.1.1" xref="alg1.l0.m8.1.1.1.1.1.cmml"><mo id="alg1.l0.m8.1.1.1.1.2" stretchy="false" xref="alg1.l0.m8.1.1.1.1.1.cmml">(</mo><msup id="alg1.l0.m8.1.1.1.1.1" xref="alg1.l0.m8.1.1.1.1.1.cmml"><mi id="alg1.l0.m8.1.1.1.1.1.2" xref="alg1.l0.m8.1.1.1.1.1.2.cmml">σ</mi><mtext id="alg1.l0.m8.1.1.1.1.1.3" xref="alg1.l0.m8.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="alg1.l0.m8.1.1.1.1.3" stretchy="false" xref="alg1.l0.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m8.1b"><apply id="alg1.l0.m8.1.1.cmml" xref="alg1.l0.m8.1.1"><times id="alg1.l0.m8.1.1.2.cmml" xref="alg1.l0.m8.1.1.2"></times><apply id="alg1.l0.m8.1.1.3.cmml" xref="alg1.l0.m8.1.1.3"><csymbol cd="ambiguous" id="alg1.l0.m8.1.1.3.1.cmml" xref="alg1.l0.m8.1.1.3">subscript</csymbol><ci id="alg1.l0.m8.1.1.3.2.cmml" xref="alg1.l0.m8.1.1.3.2">𝑝</ci><ci id="alg1.l0.m8.1.1.3.3a.cmml" xref="alg1.l0.m8.1.1.3.3"><mtext id="alg1.l0.m8.1.1.3.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="alg1.l0.m8.1.1.3.3">DSM</mtext></ci></apply><apply id="alg1.l0.m8.1.1.1.1.1.cmml" xref="alg1.l0.m8.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m8.1.1.1.1.1.1.cmml" xref="alg1.l0.m8.1.1.1.1">superscript</csymbol><ci id="alg1.l0.m8.1.1.1.1.1.2.cmml" xref="alg1.l0.m8.1.1.1.1.1.2">𝜎</ci><ci id="alg1.l0.m8.1.1.1.1.1.3a.cmml" xref="alg1.l0.m8.1.1.1.1.1.3"><mtext id="alg1.l0.m8.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l0.m8.1.1.1.1.1.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m8.1c">p_{\text{{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{%
train}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m8.1d">italic_p start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>, <math alttext="p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="alg1.l0.m9.1"><semantics id="alg1.l0.m9.1a"><mrow id="alg1.l0.m9.1.1" xref="alg1.l0.m9.1.1.cmml"><msub id="alg1.l0.m9.1.1.3" xref="alg1.l0.m9.1.1.3.cmml"><mi id="alg1.l0.m9.1.1.3.2" xref="alg1.l0.m9.1.1.3.2.cmml">p</mi><mtext id="alg1.l0.m9.1.1.3.3" mathcolor="#92D050" xref="alg1.l0.m9.1.1.3.3a.cmml">GAN</mtext></msub><mo id="alg1.l0.m9.1.1.2" xref="alg1.l0.m9.1.1.2.cmml">⁢</mo><mrow id="alg1.l0.m9.1.1.1.1" xref="alg1.l0.m9.1.1.1.1.1.cmml"><mo id="alg1.l0.m9.1.1.1.1.2" stretchy="false" xref="alg1.l0.m9.1.1.1.1.1.cmml">(</mo><msup id="alg1.l0.m9.1.1.1.1.1" xref="alg1.l0.m9.1.1.1.1.1.cmml"><mi id="alg1.l0.m9.1.1.1.1.1.2" xref="alg1.l0.m9.1.1.1.1.1.2.cmml">σ</mi><mtext id="alg1.l0.m9.1.1.1.1.1.3" xref="alg1.l0.m9.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="alg1.l0.m9.1.1.1.1.3" stretchy="false" xref="alg1.l0.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m9.1b"><apply id="alg1.l0.m9.1.1.cmml" xref="alg1.l0.m9.1.1"><times id="alg1.l0.m9.1.1.2.cmml" xref="alg1.l0.m9.1.1.2"></times><apply id="alg1.l0.m9.1.1.3.cmml" xref="alg1.l0.m9.1.1.3"><csymbol cd="ambiguous" id="alg1.l0.m9.1.1.3.1.cmml" xref="alg1.l0.m9.1.1.3">subscript</csymbol><ci id="alg1.l0.m9.1.1.3.2.cmml" xref="alg1.l0.m9.1.1.3.2">𝑝</ci><ci id="alg1.l0.m9.1.1.3.3a.cmml" xref="alg1.l0.m9.1.1.3.3"><mtext id="alg1.l0.m9.1.1.3.3.cmml" mathcolor="#92D050" mathsize="70%" xref="alg1.l0.m9.1.1.3.3">GAN</mtext></ci></apply><apply id="alg1.l0.m9.1.1.1.1.1.cmml" xref="alg1.l0.m9.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m9.1.1.1.1.1.1.cmml" xref="alg1.l0.m9.1.1.1.1">superscript</csymbol><ci id="alg1.l0.m9.1.1.1.1.1.2.cmml" xref="alg1.l0.m9.1.1.1.1.1.2">𝜎</ci><ci id="alg1.l0.m9.1.1.1.1.1.3a.cmml" xref="alg1.l0.m9.1.1.1.1.1.3"><mtext id="alg1.l0.m9.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l0.m9.1.1.1.1.1.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m9.1c">p_{\text{{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m9.1d">italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>, real sample <math alttext="\bm{x}_{\text{real}}" class="ltx_Math" display="inline" id="alg1.l0.m10.1"><semantics id="alg1.l0.m10.1a"><msub id="alg1.l0.m10.1.1" xref="alg1.l0.m10.1.1.cmml"><mi id="alg1.l0.m10.1.1.2" xref="alg1.l0.m10.1.1.2.cmml">𝒙</mi><mtext id="alg1.l0.m10.1.1.3" xref="alg1.l0.m10.1.1.3a.cmml">real</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m10.1b"><apply id="alg1.l0.m10.1.1.cmml" xref="alg1.l0.m10.1.1"><csymbol cd="ambiguous" id="alg1.l0.m10.1.1.1.cmml" xref="alg1.l0.m10.1.1">subscript</csymbol><ci id="alg1.l0.m10.1.1.2.cmml" xref="alg1.l0.m10.1.1.2">𝒙</ci><ci id="alg1.l0.m10.1.1.3a.cmml" xref="alg1.l0.m10.1.1.3"><mtext id="alg1.l0.m10.1.1.3.cmml" mathsize="70%" xref="alg1.l0.m10.1.1.3">real</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m10.1c">\bm{x}_{\text{real}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m10.1d">bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT</annotation></semantics></math>, GAN weights <math alttext="\nu_{1},\nu_{2}" class="ltx_Math" display="inline" id="alg1.l0.m11.2"><semantics id="alg1.l0.m11.2a"><mrow id="alg1.l0.m11.2.2.2" xref="alg1.l0.m11.2.2.3.cmml"><msub id="alg1.l0.m11.1.1.1.1" xref="alg1.l0.m11.1.1.1.1.cmml"><mi id="alg1.l0.m11.1.1.1.1.2" xref="alg1.l0.m11.1.1.1.1.2.cmml">ν</mi><mn id="alg1.l0.m11.1.1.1.1.3" xref="alg1.l0.m11.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l0.m11.2.2.2.3" xref="alg1.l0.m11.2.2.3.cmml">,</mo><msub id="alg1.l0.m11.2.2.2.2" xref="alg1.l0.m11.2.2.2.2.cmml"><mi id="alg1.l0.m11.2.2.2.2.2" xref="alg1.l0.m11.2.2.2.2.2.cmml">ν</mi><mn id="alg1.l0.m11.2.2.2.2.3" xref="alg1.l0.m11.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m11.2b"><list id="alg1.l0.m11.2.2.3.cmml" xref="alg1.l0.m11.2.2.2"><apply id="alg1.l0.m11.1.1.1.1.cmml" xref="alg1.l0.m11.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m11.1.1.1.1.1.cmml" xref="alg1.l0.m11.1.1.1.1">subscript</csymbol><ci id="alg1.l0.m11.1.1.1.1.2.cmml" xref="alg1.l0.m11.1.1.1.1.2">𝜈</ci><cn id="alg1.l0.m11.1.1.1.1.3.cmml" type="integer" xref="alg1.l0.m11.1.1.1.1.3">1</cn></apply><apply id="alg1.l0.m11.2.2.2.2.cmml" xref="alg1.l0.m11.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l0.m11.2.2.2.2.1.cmml" xref="alg1.l0.m11.2.2.2.2">subscript</csymbol><ci id="alg1.l0.m11.2.2.2.2.2.cmml" xref="alg1.l0.m11.2.2.2.2.2">𝜈</ci><cn id="alg1.l0.m11.2.2.2.2.3.cmml" type="integer" xref="alg1.l0.m11.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m11.2c">\nu_{1},\nu_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m11.2d">italic_ν start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_ν start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, optimizers <math alttext="g_{1},g_{2}" class="ltx_Math" display="inline" id="alg1.l0.m12.2"><semantics id="alg1.l0.m12.2a"><mrow id="alg1.l0.m12.2.2.2" xref="alg1.l0.m12.2.2.3.cmml"><msub id="alg1.l0.m12.1.1.1.1" xref="alg1.l0.m12.1.1.1.1.cmml"><mi id="alg1.l0.m12.1.1.1.1.2" xref="alg1.l0.m12.1.1.1.1.2.cmml">g</mi><mn id="alg1.l0.m12.1.1.1.1.3" xref="alg1.l0.m12.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l0.m12.2.2.2.3" xref="alg1.l0.m12.2.2.3.cmml">,</mo><msub id="alg1.l0.m12.2.2.2.2" xref="alg1.l0.m12.2.2.2.2.cmml"><mi id="alg1.l0.m12.2.2.2.2.2" xref="alg1.l0.m12.2.2.2.2.2.cmml">g</mi><mn id="alg1.l0.m12.2.2.2.2.3" xref="alg1.l0.m12.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m12.2b"><list id="alg1.l0.m12.2.2.3.cmml" xref="alg1.l0.m12.2.2.2"><apply id="alg1.l0.m12.1.1.1.1.cmml" xref="alg1.l0.m12.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m12.1.1.1.1.1.cmml" xref="alg1.l0.m12.1.1.1.1">subscript</csymbol><ci id="alg1.l0.m12.1.1.1.1.2.cmml" xref="alg1.l0.m12.1.1.1.1.2">𝑔</ci><cn id="alg1.l0.m12.1.1.1.1.3.cmml" type="integer" xref="alg1.l0.m12.1.1.1.1.3">1</cn></apply><apply id="alg1.l0.m12.2.2.2.2.cmml" xref="alg1.l0.m12.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l0.m12.2.2.2.2.1.cmml" xref="alg1.l0.m12.2.2.2.2">subscript</csymbol><ci id="alg1.l0.m12.2.2.2.2.2.cmml" xref="alg1.l0.m12.2.2.2.2.2">𝑔</ci><cn id="alg1.l0.m12.2.2.2.2.3.cmml" type="integer" xref="alg1.l0.m12.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m12.2c">g_{1},g_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m12.2d">italic_g start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, weighting function <math alttext="\lambda" class="ltx_Math" display="inline" id="alg1.l0.m13.1"><semantics id="alg1.l0.m13.1a"><mi id="alg1.l0.m13.1.1" xref="alg1.l0.m13.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m13.1b"><ci id="alg1.l0.m13.1.1.cmml" xref="alg1.l0.m13.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m13.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m13.1d">italic_λ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math alttext="{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}\sigma}\sim p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[%
named]{pgfstrokecolor}{rgb}{0.75390625,0,0}gen}}}(\sigma^{\text{inf}})" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.3" mathcolor="#C00000" xref="alg1.l1.m1.1.1.3.cmml">σ</mi><mo id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml"><msub id="alg1.l1.m1.1.1.1.3" xref="alg1.l1.m1.1.1.1.3.cmml"><mi id="alg1.l1.m1.1.1.1.3.2" xref="alg1.l1.m1.1.1.1.3.2.cmml">p</mi><mtext id="alg1.l1.m1.1.1.1.3.3" mathcolor="#C00000" xref="alg1.l1.m1.1.1.1.3.3a.cmml">gen</mtext></msub><mo id="alg1.l1.m1.1.1.1.2" xref="alg1.l1.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l1.m1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l1.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l1.m1.1.1.1.1.1.1.cmml">(</mo><msup id="alg1.l1.m1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.1.2.cmml">σ</mi><mtext id="alg1.l1.m1.1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.1.3a.cmml">inf</mtext></msup><mo id="alg1.l1.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="latexml" id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">similar-to</csymbol><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝜎</ci><apply id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"><times id="alg1.l1.m1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.2"></times><apply id="alg1.l1.m1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.1.3.2">𝑝</ci><ci id="alg1.l1.m1.1.1.1.3.3a.cmml" xref="alg1.l1.m1.1.1.1.3.3"><mtext id="alg1.l1.m1.1.1.1.3.3.cmml" mathcolor="#C00000" mathsize="70%" xref="alg1.l1.m1.1.1.1.3.3">gen</mtext></ci></apply><apply id="alg1.l1.m1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.2">𝜎</ci><ci id="alg1.l1.m1.1.1.1.1.1.1.3a.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.3"><mtext id="alg1.l1.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l1.m1.1.1.1.1.1.1.3">inf</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">{\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}\sigma}\sim p_{\text{{\color[rgb]{0.75390625,0,0}\definecolor[%
named]{pgfstrokecolor}{rgb}{0.75390625,0,0}gen}}}(\sigma^{\text{inf}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_σ ∼ italic_p start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT inf end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <math alttext="\epsilon_{\text{gen}}\sim\mathcal{N}(0,\bm{I})" class="ltx_Math" display="inline" id="alg1.l2.m1.2"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.3" xref="alg1.l2.m1.2.3.cmml"><msub id="alg1.l2.m1.2.3.2" xref="alg1.l2.m1.2.3.2.cmml"><mi id="alg1.l2.m1.2.3.2.2" xref="alg1.l2.m1.2.3.2.2.cmml">ϵ</mi><mtext id="alg1.l2.m1.2.3.2.3" xref="alg1.l2.m1.2.3.2.3a.cmml">gen</mtext></msub><mo id="alg1.l2.m1.2.3.1" xref="alg1.l2.m1.2.3.1.cmml">∼</mo><mrow id="alg1.l2.m1.2.3.3" xref="alg1.l2.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.2.3.3.2" xref="alg1.l2.m1.2.3.3.2.cmml">𝒩</mi><mo id="alg1.l2.m1.2.3.3.1" xref="alg1.l2.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l2.m1.2.3.3.3.2" xref="alg1.l2.m1.2.3.3.3.1.cmml"><mo id="alg1.l2.m1.2.3.3.3.2.1" stretchy="false" xref="alg1.l2.m1.2.3.3.3.1.cmml">(</mo><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">0</mn><mo id="alg1.l2.m1.2.3.3.3.2.2" xref="alg1.l2.m1.2.3.3.3.1.cmml">,</mo><mi id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">𝑰</mi><mo id="alg1.l2.m1.2.3.3.3.2.3" stretchy="false" xref="alg1.l2.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><apply id="alg1.l2.m1.2.3.cmml" xref="alg1.l2.m1.2.3"><csymbol cd="latexml" id="alg1.l2.m1.2.3.1.cmml" xref="alg1.l2.m1.2.3.1">similar-to</csymbol><apply id="alg1.l2.m1.2.3.2.cmml" xref="alg1.l2.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l2.m1.2.3.2.1.cmml" xref="alg1.l2.m1.2.3.2">subscript</csymbol><ci id="alg1.l2.m1.2.3.2.2.cmml" xref="alg1.l2.m1.2.3.2.2">italic-ϵ</ci><ci id="alg1.l2.m1.2.3.2.3a.cmml" xref="alg1.l2.m1.2.3.2.3"><mtext id="alg1.l2.m1.2.3.2.3.cmml" mathsize="70%" xref="alg1.l2.m1.2.3.2.3">gen</mtext></ci></apply><apply id="alg1.l2.m1.2.3.3.cmml" xref="alg1.l2.m1.2.3.3"><times id="alg1.l2.m1.2.3.3.1.cmml" xref="alg1.l2.m1.2.3.3.1"></times><ci id="alg1.l2.m1.2.3.3.2.cmml" xref="alg1.l2.m1.2.3.3.2">𝒩</ci><interval closure="open" id="alg1.l2.m1.2.3.3.3.1.cmml" xref="alg1.l2.m1.2.3.3.3.2"><cn id="alg1.l2.m1.1.1.cmml" type="integer" xref="alg1.l2.m1.1.1">0</cn><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">\epsilon_{\text{gen}}\sim\mathcal{N}(0,\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.2d">italic_ϵ start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <math alttext="{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}%
}=G_{\bm{\phi}}(\bm{x}_{\text{real}}+{\color[rgb]{0.75390625,0,0}\definecolor[%
named]{pgfstrokecolor}{rgb}{0.75390625,0,0}\sigma}\epsilon_{\text{gen}},{%
\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}\sigma})" class="ltx_Math" display="inline" id="alg1.l3.m1.2"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml"><msub id="alg1.l3.m1.2.2.3" xref="alg1.l3.m1.2.2.3.cmml"><mover accent="true" id="alg1.l3.m1.2.2.3.2" xref="alg1.l3.m1.2.2.3.2.cmml"><mi id="alg1.l3.m1.2.2.3.2.2" mathcolor="#2E5F7F" xref="alg1.l3.m1.2.2.3.2.2.cmml">𝒙</mi><mo id="alg1.l3.m1.2.2.3.2.1" mathcolor="#2E5F7F" xref="alg1.l3.m1.2.2.3.2.1.cmml">^</mo></mover><mtext id="alg1.l3.m1.2.2.3.3" mathcolor="#2E5F7F" xref="alg1.l3.m1.2.2.3.3a.cmml">gen</mtext></msub><mo id="alg1.l3.m1.2.2.2" xref="alg1.l3.m1.2.2.2.cmml">=</mo><mrow id="alg1.l3.m1.2.2.1" xref="alg1.l3.m1.2.2.1.cmml"><msub id="alg1.l3.m1.2.2.1.3" xref="alg1.l3.m1.2.2.1.3.cmml"><mi id="alg1.l3.m1.2.2.1.3.2" xref="alg1.l3.m1.2.2.1.3.2.cmml">G</mi><mi class="ltx_mathvariant_bold-italic" id="alg1.l3.m1.2.2.1.3.3" mathvariant="bold-italic" xref="alg1.l3.m1.2.2.1.3.3.cmml">ϕ</mi></msub><mo id="alg1.l3.m1.2.2.1.2" xref="alg1.l3.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l3.m1.2.2.1.1.1" xref="alg1.l3.m1.2.2.1.1.2.cmml"><mo id="alg1.l3.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l3.m1.2.2.1.1.2.cmml">(</mo><mrow id="alg1.l3.m1.2.2.1.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.1.cmml"><msub id="alg1.l3.m1.2.2.1.1.1.1.2" xref="alg1.l3.m1.2.2.1.1.1.1.2.cmml"><mi id="alg1.l3.m1.2.2.1.1.1.1.2.2" xref="alg1.l3.m1.2.2.1.1.1.1.2.2.cmml">𝒙</mi><mtext id="alg1.l3.m1.2.2.1.1.1.1.2.3" xref="alg1.l3.m1.2.2.1.1.1.1.2.3a.cmml">real</mtext></msub><mo id="alg1.l3.m1.2.2.1.1.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l3.m1.2.2.1.1.1.1.3" xref="alg1.l3.m1.2.2.1.1.1.1.3.cmml"><mi id="alg1.l3.m1.2.2.1.1.1.1.3.2" mathcolor="#C00000" xref="alg1.l3.m1.2.2.1.1.1.1.3.2.cmml">σ</mi><mo id="alg1.l3.m1.2.2.1.1.1.1.3.1" xref="alg1.l3.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l3.m1.2.2.1.1.1.1.3.3" xref="alg1.l3.m1.2.2.1.1.1.1.3.3.cmml"><mi id="alg1.l3.m1.2.2.1.1.1.1.3.3.2" xref="alg1.l3.m1.2.2.1.1.1.1.3.3.2.cmml">ϵ</mi><mtext id="alg1.l3.m1.2.2.1.1.1.1.3.3.3" xref="alg1.l3.m1.2.2.1.1.1.1.3.3.3a.cmml">gen</mtext></msub></mrow></mrow><mo id="alg1.l3.m1.2.2.1.1.1.3" xref="alg1.l3.m1.2.2.1.1.2.cmml">,</mo><mi id="alg1.l3.m1.1.1" mathcolor="#C00000" xref="alg1.l3.m1.1.1.cmml">σ</mi><mo id="alg1.l3.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l3.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2"><eq id="alg1.l3.m1.2.2.2.cmml" xref="alg1.l3.m1.2.2.2"></eq><apply id="alg1.l3.m1.2.2.3.cmml" xref="alg1.l3.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.3.1.cmml" xref="alg1.l3.m1.2.2.3">subscript</csymbol><apply id="alg1.l3.m1.2.2.3.2.cmml" xref="alg1.l3.m1.2.2.3.2"><ci id="alg1.l3.m1.2.2.3.2.1.cmml" xref="alg1.l3.m1.2.2.3.2.1">^</ci><ci id="alg1.l3.m1.2.2.3.2.2.cmml" xref="alg1.l3.m1.2.2.3.2.2">𝒙</ci></apply><ci id="alg1.l3.m1.2.2.3.3a.cmml" xref="alg1.l3.m1.2.2.3.3"><mtext id="alg1.l3.m1.2.2.3.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="alg1.l3.m1.2.2.3.3">gen</mtext></ci></apply><apply id="alg1.l3.m1.2.2.1.cmml" xref="alg1.l3.m1.2.2.1"><times id="alg1.l3.m1.2.2.1.2.cmml" xref="alg1.l3.m1.2.2.1.2"></times><apply id="alg1.l3.m1.2.2.1.3.cmml" xref="alg1.l3.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.3.1.cmml" xref="alg1.l3.m1.2.2.1.3">subscript</csymbol><ci id="alg1.l3.m1.2.2.1.3.2.cmml" xref="alg1.l3.m1.2.2.1.3.2">𝐺</ci><ci id="alg1.l3.m1.2.2.1.3.3.cmml" xref="alg1.l3.m1.2.2.1.3.3">bold-italic-ϕ</ci></apply><interval closure="open" id="alg1.l3.m1.2.2.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1.1"><apply id="alg1.l3.m1.2.2.1.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1"><plus id="alg1.l3.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1"></plus><apply id="alg1.l3.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.1.1.1.1.2.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.2.2">𝒙</ci><ci id="alg1.l3.m1.2.2.1.1.1.1.2.3a.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.2.3"><mtext id="alg1.l3.m1.2.2.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l3.m1.2.2.1.1.1.1.2.3">real</mtext></ci></apply><apply id="alg1.l3.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.3"><times id="alg1.l3.m1.2.2.1.1.1.1.3.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.3.1"></times><ci id="alg1.l3.m1.2.2.1.1.1.1.3.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.3.2">𝜎</ci><apply id="alg1.l3.m1.2.2.1.1.1.1.3.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.3.3.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l3.m1.2.2.1.1.1.1.3.3.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.3.3.2">italic-ϵ</ci><ci id="alg1.l3.m1.2.2.1.1.1.1.3.3.3a.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.3.3.3"><mtext id="alg1.l3.m1.2.2.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="alg1.l3.m1.2.2.1.1.1.1.3.3.3">gen</mtext></ci></apply></apply></apply><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝜎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}%
}=G_{\bm{\phi}}(\bm{x}_{\text{real}}+{\color[rgb]{0.75390625,0,0}\definecolor[%
named]{pgfstrokecolor}{rgb}{0.75390625,0,0}\sigma}\epsilon_{\text{gen}},{%
\color[rgb]{0.75390625,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.75390625,0,0}\sigma})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.2d">over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT = italic_G start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT + italic_σ italic_ϵ start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT , italic_σ )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l4.1">if</span> generator turn <span class="ltx_text ltx_font_bold" id="alg1.l4.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math alttext="{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}\sigma}\sim p_{\text{{\color[rgb]{0.984375,0.7421875,0}%
\definecolor[named]{pgfstrokecolor}{rgb}{0.984375,0.7421875,0}DMD}}}(\sigma^{%
\text{train}})" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.3" mathcolor="#FBBD00" xref="alg1.l5.m1.1.1.3.cmml">σ</mi><mo id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><msub id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.1.3.2" xref="alg1.l5.m1.1.1.1.3.2.cmml">p</mi><mtext id="alg1.l5.m1.1.1.1.3.3" mathcolor="#FBBD00" xref="alg1.l5.m1.1.1.1.3.3a.cmml">DMD</mtext></msub><mo id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l5.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">(</mo><msup id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.cmml">σ</mi><mtext id="alg1.l5.m1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="alg1.l5.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="latexml" id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">similar-to</csymbol><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝜎</ci><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><apply id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.1.3.2">𝑝</ci><ci id="alg1.l5.m1.1.1.1.3.3a.cmml" xref="alg1.l5.m1.1.1.1.3.3"><mtext id="alg1.l5.m1.1.1.1.3.3.cmml" mathcolor="#FBBD00" mathsize="70%" xref="alg1.l5.m1.1.1.1.3.3">DMD</mtext></ci></apply><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2">𝜎</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.3a.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3"><mtext id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l5.m1.1.1.1.1.1.1.3">train</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">{\color[rgb]{0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}\sigma}\sim p_{\text{{\color[rgb]{0.984375,0.7421875,0}%
\definecolor[named]{pgfstrokecolor}{rgb}{0.984375,0.7421875,0}DMD}}}(\sigma^{%
\text{train}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_σ ∼ italic_p start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math alttext="\epsilon_{\text{dmd}}\sim\mathcal{N}(0,\bm{I})" class="ltx_Math" display="inline" id="alg1.l6.m1.2"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.3" xref="alg1.l6.m1.2.3.cmml"><msub id="alg1.l6.m1.2.3.2" xref="alg1.l6.m1.2.3.2.cmml"><mi id="alg1.l6.m1.2.3.2.2" xref="alg1.l6.m1.2.3.2.2.cmml">ϵ</mi><mtext id="alg1.l6.m1.2.3.2.3" xref="alg1.l6.m1.2.3.2.3a.cmml">dmd</mtext></msub><mo id="alg1.l6.m1.2.3.1" xref="alg1.l6.m1.2.3.1.cmml">∼</mo><mrow id="alg1.l6.m1.2.3.3" xref="alg1.l6.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.2.3.3.2" xref="alg1.l6.m1.2.3.3.2.cmml">𝒩</mi><mo id="alg1.l6.m1.2.3.3.1" xref="alg1.l6.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l6.m1.2.3.3.3.2" xref="alg1.l6.m1.2.3.3.3.1.cmml"><mo id="alg1.l6.m1.2.3.3.3.2.1" stretchy="false" xref="alg1.l6.m1.2.3.3.3.1.cmml">(</mo><mn id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">0</mn><mo id="alg1.l6.m1.2.3.3.3.2.2" xref="alg1.l6.m1.2.3.3.3.1.cmml">,</mo><mi id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">𝑰</mi><mo id="alg1.l6.m1.2.3.3.3.2.3" stretchy="false" xref="alg1.l6.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.3.cmml" xref="alg1.l6.m1.2.3"><csymbol cd="latexml" id="alg1.l6.m1.2.3.1.cmml" xref="alg1.l6.m1.2.3.1">similar-to</csymbol><apply id="alg1.l6.m1.2.3.2.cmml" xref="alg1.l6.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.3.2.1.cmml" xref="alg1.l6.m1.2.3.2">subscript</csymbol><ci id="alg1.l6.m1.2.3.2.2.cmml" xref="alg1.l6.m1.2.3.2.2">italic-ϵ</ci><ci id="alg1.l6.m1.2.3.2.3a.cmml" xref="alg1.l6.m1.2.3.2.3"><mtext id="alg1.l6.m1.2.3.2.3.cmml" mathsize="70%" xref="alg1.l6.m1.2.3.2.3">dmd</mtext></ci></apply><apply id="alg1.l6.m1.2.3.3.cmml" xref="alg1.l6.m1.2.3.3"><times id="alg1.l6.m1.2.3.3.1.cmml" xref="alg1.l6.m1.2.3.3.1"></times><ci id="alg1.l6.m1.2.3.3.2.cmml" xref="alg1.l6.m1.2.3.3.2">𝒩</ci><interval closure="open" id="alg1.l6.m1.2.3.3.3.1.cmml" xref="alg1.l6.m1.2.3.3.3.2"><cn id="alg1.l6.m1.1.1.cmml" type="integer" xref="alg1.l6.m1.1.1">0</cn><ci id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\epsilon_{\text{dmd}}\sim\mathcal{N}(0,\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.2d">italic_ϵ start_POSTSUBSCRIPT dmd end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math alttext="\nabla_{\bm{\phi}}\mathcal{L}_{\text{DMD}}=\left((\mu_{\bm{\psi}}({\color[rgb]%
{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}+{\color[rgb]{%
0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}\sigma}\epsilon_{\text{dmd}},{\color[rgb]{%
0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}\sigma})-\tilde{\mu}^{w}_{\text{real}}({\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}+{\color[rgb]{%
0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}\sigma}\epsilon_{\text{dmd}},{\color[rgb]{%
0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}\sigma})\right)\cdot\nabla_{\bm{\phi}}{\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}{\color[rgb]{0.1796875,0.37109375,0.49609375}%
\definecolor[named]{pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}\hat{%
\bm{x}}_{\text{gen}}}}" class="ltx_math_unparsed" display="inline" id="alg1.l7.m1.2"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2b"><msub id="alg1.l7.m1.2.3"><mo id="alg1.l7.m1.2.3.2">∇</mo><mi class="ltx_mathvariant_bold-italic" id="alg1.l7.m1.2.3.3" mathvariant="bold-italic">ϕ</mi></msub><msub id="alg1.l7.m1.2.4"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.2.4.2">ℒ</mi><mtext id="alg1.l7.m1.2.4.3">DMD</mtext></msub><mo id="alg1.l7.m1.2.5">=</mo><mrow id="alg1.l7.m1.2.6"><mo id="alg1.l7.m1.2.6.1">(</mo><mrow id="alg1.l7.m1.2.6.2"><mo id="alg1.l7.m1.2.6.2.1" stretchy="false">(</mo><msub id="alg1.l7.m1.2.6.2.2"><mi id="alg1.l7.m1.2.6.2.2.2">μ</mi><mi id="alg1.l7.m1.2.6.2.2.3">𝝍</mi></msub><mrow id="alg1.l7.m1.2.6.2.3"><mo id="alg1.l7.m1.2.6.2.3.1" stretchy="false">(</mo><msub id="alg1.l7.m1.2.6.2.3.2"><mover accent="true" id="alg1.l7.m1.2.6.2.3.2.2"><mi id="alg1.l7.m1.2.6.2.3.2.2.2" mathcolor="#2E5F7F">𝒙</mi><mo id="alg1.l7.m1.2.6.2.3.2.2.1" mathcolor="#2E5F7F">^</mo></mover><mtext id="alg1.l7.m1.2.6.2.3.2.3" mathcolor="#2E5F7F">gen</mtext></msub><mo id="alg1.l7.m1.2.6.2.3.3">+</mo><mi id="alg1.l7.m1.2.6.2.3.4" mathcolor="#FBBD00">σ</mi><msub id="alg1.l7.m1.2.6.2.3.5"><mi id="alg1.l7.m1.2.6.2.3.5.2">ϵ</mi><mtext id="alg1.l7.m1.2.6.2.3.5.3">dmd</mtext></msub><mo id="alg1.l7.m1.2.6.2.3.6">,</mo><mi id="alg1.l7.m1.1.1" mathcolor="#FBBD00">σ</mi><mo id="alg1.l7.m1.2.6.2.3.7" stretchy="false">)</mo></mrow><mo id="alg1.l7.m1.2.6.2.4">−</mo><msubsup id="alg1.l7.m1.2.6.2.5"><mover accent="true" id="alg1.l7.m1.2.6.2.5.2.2"><mi id="alg1.l7.m1.2.6.2.5.2.2.2">μ</mi><mo id="alg1.l7.m1.2.6.2.5.2.2.1">~</mo></mover><mtext id="alg1.l7.m1.2.6.2.5.3">real</mtext><mi id="alg1.l7.m1.2.6.2.5.2.3">w</mi></msubsup><mrow id="alg1.l7.m1.2.6.2.6"><mo id="alg1.l7.m1.2.6.2.6.1" stretchy="false">(</mo><msub id="alg1.l7.m1.2.6.2.6.2"><mover accent="true" id="alg1.l7.m1.2.6.2.6.2.2"><mi id="alg1.l7.m1.2.6.2.6.2.2.2" mathcolor="#2E5F7F">𝒙</mi><mo id="alg1.l7.m1.2.6.2.6.2.2.1" mathcolor="#2E5F7F">^</mo></mover><mtext id="alg1.l7.m1.2.6.2.6.2.3" mathcolor="#2E5F7F">gen</mtext></msub><mo id="alg1.l7.m1.2.6.2.6.3">+</mo><mi id="alg1.l7.m1.2.6.2.6.4" mathcolor="#FBBD00">σ</mi><msub id="alg1.l7.m1.2.6.2.6.5"><mi id="alg1.l7.m1.2.6.2.6.5.2">ϵ</mi><mtext id="alg1.l7.m1.2.6.2.6.5.3">dmd</mtext></msub><mo id="alg1.l7.m1.2.6.2.6.6">,</mo><mi id="alg1.l7.m1.2.2" mathcolor="#FBBD00">σ</mi><mo id="alg1.l7.m1.2.6.2.6.7" stretchy="false">)</mo></mrow><mo id="alg1.l7.m1.2.6.2.7" rspace="0.055em">)</mo></mrow><mo id="alg1.l7.m1.2.6.3" rspace="0.222em">⋅</mo><msub id="alg1.l7.m1.2.6.4"><mo id="alg1.l7.m1.2.6.4.2" rspace="0.167em">∇</mo><mi class="ltx_mathvariant_bold-italic" id="alg1.l7.m1.2.6.4.3" mathvariant="bold-italic">ϕ</mi></msub><msub id="alg1.l7.m1.2.6.5"><mover accent="true" id="alg1.l7.m1.2.6.5.2"><mi id="alg1.l7.m1.2.6.5.2.2" mathcolor="#2E5F7F">𝒙</mi><mo id="alg1.l7.m1.2.6.5.2.1" mathcolor="#2E5F7F">^</mo></mover><mtext id="alg1.l7.m1.2.6.5.3" mathcolor="#2E5F7F">gen</mtext></msub></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">\nabla_{\bm{\phi}}\mathcal{L}_{\text{DMD}}=\left((\mu_{\bm{\psi}}({\color[rgb]%
{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}+{\color[rgb]{%
0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}\sigma}\epsilon_{\text{dmd}},{\color[rgb]{%
0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}\sigma})-\tilde{\mu}^{w}_{\text{real}}({\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}+{\color[rgb]{%
0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}\sigma}\epsilon_{\text{dmd}},{\color[rgb]{%
0.984375,0.7421875,0}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.984375,0.7421875,0}\sigma})\right)\cdot\nabla_{\bm{\phi}}{\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}{\color[rgb]{0.1796875,0.37109375,0.49609375}%
\definecolor[named]{pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}\hat{%
\bm{x}}_{\text{gen}}}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.2d">∇ start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT = ( ( italic_μ start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT + italic_σ italic_ϵ start_POSTSUBSCRIPT dmd end_POSTSUBSCRIPT , italic_σ ) - over~ start_ARG italic_μ end_ARG start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT start_POSTSUBSCRIPT real end_POSTSUBSCRIPT ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT + italic_σ italic_ϵ start_POSTSUBSCRIPT dmd end_POSTSUBSCRIPT , italic_σ ) ) ⋅ ∇ start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math alttext="{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{%
rgb}{0.57421875,0.81640625,0.3125}\sigma}\sim p_{\text{{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.3" mathcolor="#92D050" xref="alg1.l8.m1.1.1.3.cmml">σ</mi><mo id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml"><msub id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.3.2.cmml">p</mi><mtext id="alg1.l8.m1.1.1.1.3.3" mathcolor="#92D050" xref="alg1.l8.m1.1.1.1.3.3a.cmml">GAN</mtext></msub><mo id="alg1.l8.m1.1.1.1.2" xref="alg1.l8.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l8.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">(</mo><msup id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.cmml">σ</mi><mtext id="alg1.l8.m1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="alg1.l8.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="latexml" id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">similar-to</csymbol><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝜎</ci><apply id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"><times id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.2"></times><apply id="alg1.l8.m1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.3.2">𝑝</ci><ci id="alg1.l8.m1.1.1.1.3.3a.cmml" xref="alg1.l8.m1.1.1.1.3.3"><mtext id="alg1.l8.m1.1.1.1.3.3.cmml" mathcolor="#92D050" mathsize="70%" xref="alg1.l8.m1.1.1.1.3.3">GAN</mtext></ci></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2">𝜎</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.3a.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3"><mtext id="alg1.l8.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l8.m1.1.1.1.1.1.1.3">train</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{%
rgb}{0.57421875,0.81640625,0.3125}\sigma}\sim p_{\text{{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_σ ∼ italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math alttext="\epsilon_{\text{fake}}\sim\mathcal{N}(0,\bm{I})" class="ltx_Math" display="inline" id="alg1.l9.m1.2"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.3" xref="alg1.l9.m1.2.3.cmml"><msub id="alg1.l9.m1.2.3.2" xref="alg1.l9.m1.2.3.2.cmml"><mi id="alg1.l9.m1.2.3.2.2" xref="alg1.l9.m1.2.3.2.2.cmml">ϵ</mi><mtext id="alg1.l9.m1.2.3.2.3" xref="alg1.l9.m1.2.3.2.3a.cmml">fake</mtext></msub><mo id="alg1.l9.m1.2.3.1" xref="alg1.l9.m1.2.3.1.cmml">∼</mo><mrow id="alg1.l9.m1.2.3.3" xref="alg1.l9.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.2.3.3.2" xref="alg1.l9.m1.2.3.3.2.cmml">𝒩</mi><mo id="alg1.l9.m1.2.3.3.1" xref="alg1.l9.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l9.m1.2.3.3.3.2" xref="alg1.l9.m1.2.3.3.3.1.cmml"><mo id="alg1.l9.m1.2.3.3.3.2.1" stretchy="false" xref="alg1.l9.m1.2.3.3.3.1.cmml">(</mo><mn id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">0</mn><mo id="alg1.l9.m1.2.3.3.3.2.2" xref="alg1.l9.m1.2.3.3.3.1.cmml">,</mo><mi id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml">𝑰</mi><mo id="alg1.l9.m1.2.3.3.3.2.3" stretchy="false" xref="alg1.l9.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.3.cmml" xref="alg1.l9.m1.2.3"><csymbol cd="latexml" id="alg1.l9.m1.2.3.1.cmml" xref="alg1.l9.m1.2.3.1">similar-to</csymbol><apply id="alg1.l9.m1.2.3.2.cmml" xref="alg1.l9.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.2.1.cmml" xref="alg1.l9.m1.2.3.2">subscript</csymbol><ci id="alg1.l9.m1.2.3.2.2.cmml" xref="alg1.l9.m1.2.3.2.2">italic-ϵ</ci><ci id="alg1.l9.m1.2.3.2.3a.cmml" xref="alg1.l9.m1.2.3.2.3"><mtext id="alg1.l9.m1.2.3.2.3.cmml" mathsize="70%" xref="alg1.l9.m1.2.3.2.3">fake</mtext></ci></apply><apply id="alg1.l9.m1.2.3.3.cmml" xref="alg1.l9.m1.2.3.3"><times id="alg1.l9.m1.2.3.3.1.cmml" xref="alg1.l9.m1.2.3.3.1"></times><ci id="alg1.l9.m1.2.3.3.2.cmml" xref="alg1.l9.m1.2.3.3.2">𝒩</ci><interval closure="open" id="alg1.l9.m1.2.3.3.3.1.cmml" xref="alg1.l9.m1.2.3.3.3.2"><cn id="alg1.l9.m1.1.1.cmml" type="integer" xref="alg1.l9.m1.1.1">0</cn><ci id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">\epsilon_{\text{fake}}\sim\mathcal{N}(0,\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.2d">italic_ϵ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <math alttext="\mathcal{L}_{\text{GAN}}=\|1-D_{\bm{\psi}}({\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}+{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}\sigma}\epsilon_{\text{fake}},{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}\sigma})\|_{2}^{2}" class="ltx_Math" display="inline" id="alg1.l10.m1.2"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml"><msub id="alg1.l10.m1.2.2.3" xref="alg1.l10.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.2.2.3.2" xref="alg1.l10.m1.2.2.3.2.cmml">ℒ</mi><mtext id="alg1.l10.m1.2.2.3.3" xref="alg1.l10.m1.2.2.3.3a.cmml">GAN</mtext></msub><mo id="alg1.l10.m1.2.2.2" xref="alg1.l10.m1.2.2.2.cmml">=</mo><msubsup id="alg1.l10.m1.2.2.1" xref="alg1.l10.m1.2.2.1.cmml"><mrow id="alg1.l10.m1.2.2.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.2.cmml"><mo id="alg1.l10.m1.2.2.1.1.1.1.2" stretchy="false" xref="alg1.l10.m1.2.2.1.1.1.2.1.cmml">‖</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.cmml"><mn id="alg1.l10.m1.2.2.1.1.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.3.cmml">1</mn><mo id="alg1.l10.m1.2.2.1.1.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.2.cmml">−</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.cmml"><msub id="alg1.l10.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.3.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.3.2.cmml">D</mi><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.3.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.3.3.cmml">𝝍</mi></msub><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" mathcolor="#2E5F7F" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒙</mi><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1" mathcolor="#2E5F7F" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mtext id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" mathcolor="#2E5F7F" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.3a.cmml">gen</mtext></msub><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" mathcolor="#92D050" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">σ</mi><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml">ϵ</mi><mtext id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3a.cmml">fake</mtext></msub></mrow></mrow><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="alg1.l10.m1.1.1" mathcolor="#92D050" xref="alg1.l10.m1.1.1.cmml">σ</mi><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.4" stretchy="false" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l10.m1.2.2.1.1.1.1.3" stretchy="false" xref="alg1.l10.m1.2.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg1.l10.m1.2.2.1.1.3" xref="alg1.l10.m1.2.2.1.1.3.cmml">2</mn><mn id="alg1.l10.m1.2.2.1.3" xref="alg1.l10.m1.2.2.1.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2"><eq id="alg1.l10.m1.2.2.2.cmml" xref="alg1.l10.m1.2.2.2"></eq><apply id="alg1.l10.m1.2.2.3.cmml" xref="alg1.l10.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.3.1.cmml" xref="alg1.l10.m1.2.2.3">subscript</csymbol><ci id="alg1.l10.m1.2.2.3.2.cmml" xref="alg1.l10.m1.2.2.3.2">ℒ</ci><ci id="alg1.l10.m1.2.2.3.3a.cmml" xref="alg1.l10.m1.2.2.3.3"><mtext id="alg1.l10.m1.2.2.3.3.cmml" mathsize="70%" xref="alg1.l10.m1.2.2.3.3">GAN</mtext></ci></apply><apply id="alg1.l10.m1.2.2.1.cmml" xref="alg1.l10.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.1.2.cmml" xref="alg1.l10.m1.2.2.1">superscript</csymbol><apply id="alg1.l10.m1.2.2.1.1.cmml" xref="alg1.l10.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.1.1.2.cmml" xref="alg1.l10.m1.2.2.1">subscript</csymbol><apply id="alg1.l10.m1.2.2.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="alg1.l10.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.2">norm</csymbol><apply id="alg1.l10.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1"><minus id="alg1.l10.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.2"></minus><cn id="alg1.l10.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l10.m1.2.2.1.1.1.1.1.3">1</cn><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1"><times id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2"></times><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.3.2">𝐷</ci><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.3.3">𝝍</ci></apply><interval closure="open" id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1"><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1"><plus id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1"></plus><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">𝒙</ci></apply><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.3"><mtext id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">gen</mtext></ci></apply><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3"><times id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝜎</ci><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2">italic-ϵ</ci><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3a.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3"><mtext id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3">fake</mtext></ci></apply></apply></apply><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝜎</ci></interval></apply></apply></apply><cn id="alg1.l10.m1.2.2.1.1.3.cmml" type="integer" xref="alg1.l10.m1.2.2.1.1.3">2</cn></apply><cn id="alg1.l10.m1.2.2.1.3.cmml" type="integer" xref="alg1.l10.m1.2.2.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">\mathcal{L}_{\text{GAN}}=\|1-D_{\bm{\psi}}({\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}+{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}\sigma}\epsilon_{\text{fake}},{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}\sigma})\|_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.2d">caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT = ∥ 1 - italic_D start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT + italic_σ italic_ϵ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT , italic_σ ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <math alttext="\bm{\phi}\leftarrow\bm{\phi}-g_{1}(\nabla_{\bm{\phi}}\mathcal{L}_{\text{DMD}}+%
\nu_{1}\nabla_{\bm{\phi}}\mathcal{L}_{\text{GAN}})" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg1.l11.m1.1.1.3" mathvariant="bold-italic" xref="alg1.l11.m1.1.1.3.cmml">ϕ</mi><mo id="alg1.l11.m1.1.1.2" stretchy="false" xref="alg1.l11.m1.1.1.2.cmml">←</mo><mrow id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg1.l11.m1.1.1.1.3" mathvariant="bold-italic" xref="alg1.l11.m1.1.1.1.3.cmml">ϕ</mi><mo id="alg1.l11.m1.1.1.1.2" xref="alg1.l11.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l11.m1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.cmml"><msub id="alg1.l11.m1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.1.1.3.2" xref="alg1.l11.m1.1.1.1.1.3.2.cmml">g</mi><mn id="alg1.l11.m1.1.1.1.1.3.3" xref="alg1.l11.m1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="alg1.l11.m1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l11.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml"><mrow id="alg1.l11.m1.1.1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml"><msub id="alg1.l11.m1.1.1.1.1.1.1.1.2.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.1.cmml"><mo id="alg1.l11.m1.1.1.1.1.1.1.1.2.1.2" rspace="0.167em" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.1.2.cmml">∇</mo><mi class="ltx_mathvariant_bold-italic" id="alg1.l11.m1.1.1.1.1.1.1.1.2.1.3" mathvariant="bold-italic" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.1.3.cmml">ϕ</mi></msub><msub id="alg1.l11.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2.2.cmml">ℒ</mi><mtext id="alg1.l11.m1.1.1.1.1.1.1.1.2.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2.3a.cmml">DMD</mtext></msub></mrow><mo id="alg1.l11.m1.1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.cmml"><msub id="alg1.l11.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.2.2.cmml">ν</mi><mn id="alg1.l11.m1.1.1.1.1.1.1.1.3.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="alg1.l11.m1.1.1.1.1.1.1.1.3.1" lspace="0.167em" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.cmml"><msub id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.2" rspace="0.167em" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.2.cmml">∇</mo><mi class="ltx_mathvariant_bold-italic" id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.3" mathvariant="bold-italic" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.3.cmml">ϕ</mi></msub><msub id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.2.cmml">ℒ</mi><mtext id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.3a.cmml">GAN</mtext></msub></mrow></mrow></mrow><mo id="alg1.l11.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">←</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">bold-italic-ϕ</ci><apply id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"><minus id="alg1.l11.m1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.2"></minus><ci id="alg1.l11.m1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.3">bold-italic-ϕ</ci><apply id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1"><times id="alg1.l11.m1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.2"></times><apply id="alg1.l11.m1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.1.1.3.2">𝑔</ci><cn id="alg1.l11.m1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l11.m1.1.1.1.1.3.3">1</cn></apply><apply id="alg1.l11.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1"><plus id="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1"></plus><apply id="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2"><apply id="alg1.l11.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.2.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.1.2.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.1.2">∇</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.2.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.1.3">bold-italic-ϕ</ci></apply><apply id="alg1.l11.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2.2">ℒ</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.2.2.3a.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2.3"><mtext id="alg1.l11.m1.1.1.1.1.1.1.1.2.2.3.cmml" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2.3">DMD</mtext></ci></apply></apply><apply id="alg1.l11.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3"><times id="alg1.l11.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.1"></times><apply id="alg1.l11.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.2.2">𝜈</ci><cn id="alg1.l11.m1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3"><apply id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.2">∇</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.1.3">bold-italic-ϕ</ci></apply><apply id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.2">ℒ</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.3a.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.3"><mtext id="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.3.cmml" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.3.2.3">GAN</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\bm{\phi}\leftarrow\bm{\phi}-g_{1}(\nabla_{\bm{\phi}}\mathcal{L}_{\text{DMD}}+%
\nu_{1}\nabla_{\bm{\phi}}\mathcal{L}_{\text{GAN}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">bold_italic_ϕ ← bold_italic_ϕ - italic_g start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( ∇ start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DMD end_POSTSUBSCRIPT + italic_ν start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l12.1">else</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <math alttext="{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}\sigma}\sim p_{\text{{%
\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor%
}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.3" mathcolor="#2E5F7F" xref="alg1.l13.m1.1.1.3.cmml">σ</mi><mo id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml"><msub id="alg1.l13.m1.1.1.1.3" xref="alg1.l13.m1.1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.1.3.2" xref="alg1.l13.m1.1.1.1.3.2.cmml">p</mi><mtext id="alg1.l13.m1.1.1.1.3.3" mathcolor="#2E5F7F" xref="alg1.l13.m1.1.1.1.3.3a.cmml">DSM</mtext></msub><mo id="alg1.l13.m1.1.1.1.2" xref="alg1.l13.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l13.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">(</mo><msup id="alg1.l13.m1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.1.2.cmml">σ</mi><mtext id="alg1.l13.m1.1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.1.3a.cmml">train</mtext></msup><mo id="alg1.l13.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="latexml" id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">similar-to</csymbol><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝜎</ci><apply id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"><times id="alg1.l13.m1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.2"></times><apply id="alg1.l13.m1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.3.2">𝑝</ci><ci id="alg1.l13.m1.1.1.1.3.3a.cmml" xref="alg1.l13.m1.1.1.1.3.3"><mtext id="alg1.l13.m1.1.1.1.3.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="alg1.l13.m1.1.1.1.3.3">DSM</mtext></ci></apply><apply id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.2">𝜎</ci><ci id="alg1.l13.m1.1.1.1.1.1.1.3a.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3"><mtext id="alg1.l13.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l13.m1.1.1.1.1.1.1.3">train</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">{\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{%
pgfstrokecolor}{rgb}{0.1796875,0.37109375,0.49609375}\sigma}\sim p_{\text{{%
\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor%
}{rgb}{0.1796875,0.37109375,0.49609375}DSM}}}(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_σ ∼ italic_p start_POSTSUBSCRIPT DSM end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>     <math alttext="\epsilon_{\text{dsm}}\sim\mathcal{N}(0,\bm{I})" class="ltx_Math" display="inline" id="alg1.l14.m1.2"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.3" xref="alg1.l14.m1.2.3.cmml"><msub id="alg1.l14.m1.2.3.2" xref="alg1.l14.m1.2.3.2.cmml"><mi id="alg1.l14.m1.2.3.2.2" xref="alg1.l14.m1.2.3.2.2.cmml">ϵ</mi><mtext id="alg1.l14.m1.2.3.2.3" xref="alg1.l14.m1.2.3.2.3a.cmml">dsm</mtext></msub><mo id="alg1.l14.m1.2.3.1" xref="alg1.l14.m1.2.3.1.cmml">∼</mo><mrow id="alg1.l14.m1.2.3.3" xref="alg1.l14.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m1.2.3.3.2" xref="alg1.l14.m1.2.3.3.2.cmml">𝒩</mi><mo id="alg1.l14.m1.2.3.3.1" xref="alg1.l14.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l14.m1.2.3.3.3.2" xref="alg1.l14.m1.2.3.3.3.1.cmml"><mo id="alg1.l14.m1.2.3.3.3.2.1" stretchy="false" xref="alg1.l14.m1.2.3.3.3.1.cmml">(</mo><mn id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">0</mn><mo id="alg1.l14.m1.2.3.3.3.2.2" xref="alg1.l14.m1.2.3.3.3.1.cmml">,</mo><mi id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml">𝑰</mi><mo id="alg1.l14.m1.2.3.3.3.2.3" stretchy="false" xref="alg1.l14.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><apply id="alg1.l14.m1.2.3.cmml" xref="alg1.l14.m1.2.3"><csymbol cd="latexml" id="alg1.l14.m1.2.3.1.cmml" xref="alg1.l14.m1.2.3.1">similar-to</csymbol><apply id="alg1.l14.m1.2.3.2.cmml" xref="alg1.l14.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.2.1.cmml" xref="alg1.l14.m1.2.3.2">subscript</csymbol><ci id="alg1.l14.m1.2.3.2.2.cmml" xref="alg1.l14.m1.2.3.2.2">italic-ϵ</ci><ci id="alg1.l14.m1.2.3.2.3a.cmml" xref="alg1.l14.m1.2.3.2.3"><mtext id="alg1.l14.m1.2.3.2.3.cmml" mathsize="70%" xref="alg1.l14.m1.2.3.2.3">dsm</mtext></ci></apply><apply id="alg1.l14.m1.2.3.3.cmml" xref="alg1.l14.m1.2.3.3"><times id="alg1.l14.m1.2.3.3.1.cmml" xref="alg1.l14.m1.2.3.3.1"></times><ci id="alg1.l14.m1.2.3.3.2.cmml" xref="alg1.l14.m1.2.3.3.2">𝒩</ci><interval closure="open" id="alg1.l14.m1.2.3.3.3.1.cmml" xref="alg1.l14.m1.2.3.3.3.2"><cn id="alg1.l14.m1.1.1.cmml" type="integer" xref="alg1.l14.m1.1.1">0</cn><ci id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">\epsilon_{\text{dsm}}\sim\mathcal{N}(0,\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.2d">italic_ϵ start_POSTSUBSCRIPT dsm end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>     <math alttext="\mathcal{L}_{\text{fake-DSM}}=\lambda({\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\sigma})\|{\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}-\mu_{\bm{\psi}}({%
\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor%
}{rgb}{0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}+{\color[rgb]%
{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\sigma}\epsilon_{\text{dsm}},{\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\sigma})\|_{2}^{2}" class="ltx_Math" display="inline" id="alg1.l15.m1.3"><semantics id="alg1.l15.m1.3a"><mrow id="alg1.l15.m1.3.3" xref="alg1.l15.m1.3.3.cmml"><msub id="alg1.l15.m1.3.3.3" xref="alg1.l15.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.3.3.3.2" xref="alg1.l15.m1.3.3.3.2.cmml">ℒ</mi><mtext id="alg1.l15.m1.3.3.3.3" xref="alg1.l15.m1.3.3.3.3a.cmml">fake-DSM</mtext></msub><mo id="alg1.l15.m1.3.3.2" xref="alg1.l15.m1.3.3.2.cmml">=</mo><mrow id="alg1.l15.m1.3.3.1" xref="alg1.l15.m1.3.3.1.cmml"><mi id="alg1.l15.m1.3.3.1.3" xref="alg1.l15.m1.3.3.1.3.cmml">λ</mi><mo id="alg1.l15.m1.3.3.1.2" xref="alg1.l15.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l15.m1.3.3.1.4.2" xref="alg1.l15.m1.3.3.1.cmml"><mo id="alg1.l15.m1.3.3.1.4.2.1" stretchy="false" xref="alg1.l15.m1.3.3.1.cmml">(</mo><mi id="alg1.l15.m1.1.1" mathcolor="#2E5F7F" xref="alg1.l15.m1.1.1.cmml">σ</mi><mo id="alg1.l15.m1.3.3.1.4.2.2" stretchy="false" xref="alg1.l15.m1.3.3.1.cmml">)</mo></mrow><mo id="alg1.l15.m1.3.3.1.2a" xref="alg1.l15.m1.3.3.1.2.cmml">⁢</mo><msubsup id="alg1.l15.m1.3.3.1.1" xref="alg1.l15.m1.3.3.1.1.cmml"><mrow id="alg1.l15.m1.3.3.1.1.1.1.1" xref="alg1.l15.m1.3.3.1.1.1.1.2.cmml"><mo id="alg1.l15.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="alg1.l15.m1.3.3.1.1.1.1.2.1.cmml">‖</mo><mrow id="alg1.l15.m1.3.3.1.1.1.1.1.1" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.cmml"><msub id="alg1.l15.m1.3.3.1.1.1.1.1.1.3" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2.2" mathcolor="#2E5F7F" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">𝒙</mi><mo id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2.1" mathcolor="#2E5F7F" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mtext id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.3" mathcolor="#2E5F7F" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3.3a.cmml">gen</mtext></msub><mo id="alg1.l15.m1.3.3.1.1.1.1.1.1.2" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.2.cmml">−</mo><mrow id="alg1.l15.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.2" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.3" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">𝝍</mi></msub><mo id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2" mathcolor="#2E5F7F" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒙</mi><mo id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.1" mathcolor="#2E5F7F" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mtext id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3" mathcolor="#2E5F7F" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3a.cmml">gen</mtext></msub><mo id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" mathcolor="#2E5F7F" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">σ</mi><mo id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">ϵ</mi><mtext id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.3a.cmml">dsm</mtext></msub></mrow></mrow><mo id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="alg1.l15.m1.2.2" mathcolor="#2E5F7F" xref="alg1.l15.m1.2.2.cmml">σ</mi><mo id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l15.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="alg1.l15.m1.3.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg1.l15.m1.3.3.1.1.1.3" xref="alg1.l15.m1.3.3.1.1.1.3.cmml">2</mn><mn id="alg1.l15.m1.3.3.1.1.3" xref="alg1.l15.m1.3.3.1.1.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.3b"><apply id="alg1.l15.m1.3.3.cmml" xref="alg1.l15.m1.3.3"><eq id="alg1.l15.m1.3.3.2.cmml" xref="alg1.l15.m1.3.3.2"></eq><apply id="alg1.l15.m1.3.3.3.cmml" xref="alg1.l15.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.3.1.cmml" xref="alg1.l15.m1.3.3.3">subscript</csymbol><ci id="alg1.l15.m1.3.3.3.2.cmml" xref="alg1.l15.m1.3.3.3.2">ℒ</ci><ci id="alg1.l15.m1.3.3.3.3a.cmml" xref="alg1.l15.m1.3.3.3.3"><mtext id="alg1.l15.m1.3.3.3.3.cmml" mathsize="70%" xref="alg1.l15.m1.3.3.3.3">fake-DSM</mtext></ci></apply><apply id="alg1.l15.m1.3.3.1.cmml" xref="alg1.l15.m1.3.3.1"><times id="alg1.l15.m1.3.3.1.2.cmml" xref="alg1.l15.m1.3.3.1.2"></times><ci id="alg1.l15.m1.3.3.1.3.cmml" xref="alg1.l15.m1.3.3.1.3">𝜆</ci><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝜎</ci><apply id="alg1.l15.m1.3.3.1.1.cmml" xref="alg1.l15.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.1.1.2.cmml" xref="alg1.l15.m1.3.3.1.1">superscript</csymbol><apply id="alg1.l15.m1.3.3.1.1.1.cmml" xref="alg1.l15.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.1.1.1.2.cmml" xref="alg1.l15.m1.3.3.1.1">subscript</csymbol><apply id="alg1.l15.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l15.m1.3.3.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.2">norm</csymbol><apply id="alg1.l15.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1"><minus id="alg1.l15.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.2"></minus><apply id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><apply id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2"><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2.1">^</ci><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3.2.2">𝒙</ci></apply><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.3a.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3.3"><mtext id="alg1.l15.m1.3.3.1.1.1.1.1.1.3.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.3.3">gen</mtext></ci></apply><apply id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1"><times id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.2"></times><apply id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.2">𝜇</ci><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.3.3">𝝍</ci></apply><interval closure="open" id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1"><apply id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1"><plus id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒙</ci></apply><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3"><mtext id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3">gen</mtext></ci></apply><apply id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><times id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">𝜎</ci><apply id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2">italic-ϵ</ci><ci id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.3a.cmml" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.3"><mtext id="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="alg1.l15.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.3">dsm</mtext></ci></apply></apply></apply><ci id="alg1.l15.m1.2.2.cmml" xref="alg1.l15.m1.2.2">𝜎</ci></interval></apply></apply></apply><cn id="alg1.l15.m1.3.3.1.1.1.3.cmml" type="integer" xref="alg1.l15.m1.3.3.1.1.1.3">2</cn></apply><cn id="alg1.l15.m1.3.3.1.1.3.cmml" type="integer" xref="alg1.l15.m1.3.3.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.3c">\mathcal{L}_{\text{fake-DSM}}=\lambda({\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\sigma})\|{\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}-\mu_{\bm{\psi}}({%
\color[rgb]{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor%
}{rgb}{0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}+{\color[rgb]%
{0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\sigma}\epsilon_{\text{dsm}},{\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\sigma})\|_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.3d">caligraphic_L start_POSTSUBSCRIPT fake-DSM end_POSTSUBSCRIPT = italic_λ ( italic_σ ) ∥ over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT + italic_σ italic_ϵ start_POSTSUBSCRIPT dsm end_POSTSUBSCRIPT , italic_σ ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>     <math alttext="{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{%
rgb}{0.57421875,0.81640625,0.3125}\sigma}_{\text{real}},{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}\sigma}_{\text{fake}}\sim p_{\text{{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})" class="ltx_Math" display="inline" id="alg1.l16.m1.3"><semantics id="alg1.l16.m1.3a"><mrow id="alg1.l16.m1.3.3" xref="alg1.l16.m1.3.3.cmml"><mrow id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.3.cmml"><msub id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.2" mathcolor="#92D050" xref="alg1.l16.m1.1.1.1.1.1.2.cmml">σ</mi><mtext id="alg1.l16.m1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.3a.cmml">real</mtext></msub><mo id="alg1.l16.m1.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l16.m1.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.cmml"><mi id="alg1.l16.m1.2.2.2.2.2.2" mathcolor="#92D050" xref="alg1.l16.m1.2.2.2.2.2.2.cmml">σ</mi><mtext id="alg1.l16.m1.2.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.2.2.3a.cmml">fake</mtext></msub></mrow><mo id="alg1.l16.m1.3.3.4" xref="alg1.l16.m1.3.3.4.cmml">∼</mo><mrow id="alg1.l16.m1.3.3.3" xref="alg1.l16.m1.3.3.3.cmml"><msub id="alg1.l16.m1.3.3.3.3" xref="alg1.l16.m1.3.3.3.3.cmml"><mi id="alg1.l16.m1.3.3.3.3.2" xref="alg1.l16.m1.3.3.3.3.2.cmml">p</mi><mtext id="alg1.l16.m1.3.3.3.3.3" mathcolor="#92D050" xref="alg1.l16.m1.3.3.3.3.3a.cmml">GAN</mtext></msub><mo id="alg1.l16.m1.3.3.3.2" xref="alg1.l16.m1.3.3.3.2.cmml">⁢</mo><mrow id="alg1.l16.m1.3.3.3.1.1" xref="alg1.l16.m1.3.3.3.1.1.1.cmml"><mo id="alg1.l16.m1.3.3.3.1.1.2" stretchy="false" xref="alg1.l16.m1.3.3.3.1.1.1.cmml">(</mo><msup id="alg1.l16.m1.3.3.3.1.1.1" xref="alg1.l16.m1.3.3.3.1.1.1.cmml"><mi id="alg1.l16.m1.3.3.3.1.1.1.2" xref="alg1.l16.m1.3.3.3.1.1.1.2.cmml">σ</mi><mtext id="alg1.l16.m1.3.3.3.1.1.1.3" xref="alg1.l16.m1.3.3.3.1.1.1.3a.cmml">train</mtext></msup><mo id="alg1.l16.m1.3.3.3.1.1.3" stretchy="false" xref="alg1.l16.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.3b"><apply id="alg1.l16.m1.3.3.cmml" xref="alg1.l16.m1.3.3"><csymbol cd="latexml" id="alg1.l16.m1.3.3.4.cmml" xref="alg1.l16.m1.3.3.4">similar-to</csymbol><list id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2"><apply id="alg1.l16.m1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.2">𝜎</ci><ci id="alg1.l16.m1.1.1.1.1.1.3a.cmml" xref="alg1.l16.m1.1.1.1.1.1.3"><mtext id="alg1.l16.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l16.m1.1.1.1.1.1.3">real</mtext></ci></apply><apply id="alg1.l16.m1.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2.2">𝜎</ci><ci id="alg1.l16.m1.2.2.2.2.2.3a.cmml" xref="alg1.l16.m1.2.2.2.2.2.3"><mtext id="alg1.l16.m1.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg1.l16.m1.2.2.2.2.2.3">fake</mtext></ci></apply></list><apply id="alg1.l16.m1.3.3.3.cmml" xref="alg1.l16.m1.3.3.3"><times id="alg1.l16.m1.3.3.3.2.cmml" xref="alg1.l16.m1.3.3.3.2"></times><apply id="alg1.l16.m1.3.3.3.3.cmml" xref="alg1.l16.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.3.3.1.cmml" xref="alg1.l16.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l16.m1.3.3.3.3.2.cmml" xref="alg1.l16.m1.3.3.3.3.2">𝑝</ci><ci id="alg1.l16.m1.3.3.3.3.3a.cmml" xref="alg1.l16.m1.3.3.3.3.3"><mtext id="alg1.l16.m1.3.3.3.3.3.cmml" mathcolor="#92D050" mathsize="70%" xref="alg1.l16.m1.3.3.3.3.3">GAN</mtext></ci></apply><apply id="alg1.l16.m1.3.3.3.1.1.1.cmml" xref="alg1.l16.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l16.m1.3.3.3.1.1">superscript</csymbol><ci id="alg1.l16.m1.3.3.3.1.1.1.2.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.2">𝜎</ci><ci id="alg1.l16.m1.3.3.3.1.1.1.3a.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.3"><mtext id="alg1.l16.m1.3.3.3.1.1.1.3.cmml" mathsize="70%" xref="alg1.l16.m1.3.3.3.1.1.1.3">train</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.3c">{\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{%
rgb}{0.57421875,0.81640625,0.3125}\sigma}_{\text{real}},{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}\sigma}_{\text{fake}}\sim p_{\text{{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}GAN}}}(\sigma^{\text{train}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.3d">italic_σ start_POSTSUBSCRIPT real end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT ∼ italic_p start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ( italic_σ start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>     <math alttext="\epsilon_{\text{real}},\epsilon_{\text{fake}}\sim\mathcal{N}(0,\bm{I})" class="ltx_Math" display="inline" id="alg1.l17.m1.4"><semantics id="alg1.l17.m1.4a"><mrow id="alg1.l17.m1.4.4" xref="alg1.l17.m1.4.4.cmml"><mrow id="alg1.l17.m1.4.4.2.2" xref="alg1.l17.m1.4.4.2.3.cmml"><msub id="alg1.l17.m1.3.3.1.1.1" xref="alg1.l17.m1.3.3.1.1.1.cmml"><mi id="alg1.l17.m1.3.3.1.1.1.2" xref="alg1.l17.m1.3.3.1.1.1.2.cmml">ϵ</mi><mtext id="alg1.l17.m1.3.3.1.1.1.3" xref="alg1.l17.m1.3.3.1.1.1.3a.cmml">real</mtext></msub><mo id="alg1.l17.m1.4.4.2.2.3" xref="alg1.l17.m1.4.4.2.3.cmml">,</mo><msub id="alg1.l17.m1.4.4.2.2.2" xref="alg1.l17.m1.4.4.2.2.2.cmml"><mi id="alg1.l17.m1.4.4.2.2.2.2" xref="alg1.l17.m1.4.4.2.2.2.2.cmml">ϵ</mi><mtext id="alg1.l17.m1.4.4.2.2.2.3" xref="alg1.l17.m1.4.4.2.2.2.3a.cmml">fake</mtext></msub></mrow><mo id="alg1.l17.m1.4.4.3" xref="alg1.l17.m1.4.4.3.cmml">∼</mo><mrow id="alg1.l17.m1.4.4.4" xref="alg1.l17.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.4.4.4.2" xref="alg1.l17.m1.4.4.4.2.cmml">𝒩</mi><mo id="alg1.l17.m1.4.4.4.1" xref="alg1.l17.m1.4.4.4.1.cmml">⁢</mo><mrow id="alg1.l17.m1.4.4.4.3.2" xref="alg1.l17.m1.4.4.4.3.1.cmml"><mo id="alg1.l17.m1.4.4.4.3.2.1" stretchy="false" xref="alg1.l17.m1.4.4.4.3.1.cmml">(</mo><mn id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml">0</mn><mo id="alg1.l17.m1.4.4.4.3.2.2" xref="alg1.l17.m1.4.4.4.3.1.cmml">,</mo><mi id="alg1.l17.m1.2.2" xref="alg1.l17.m1.2.2.cmml">𝑰</mi><mo id="alg1.l17.m1.4.4.4.3.2.3" stretchy="false" xref="alg1.l17.m1.4.4.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.4b"><apply id="alg1.l17.m1.4.4.cmml" xref="alg1.l17.m1.4.4"><csymbol cd="latexml" id="alg1.l17.m1.4.4.3.cmml" xref="alg1.l17.m1.4.4.3">similar-to</csymbol><list id="alg1.l17.m1.4.4.2.3.cmml" xref="alg1.l17.m1.4.4.2.2"><apply id="alg1.l17.m1.3.3.1.1.1.cmml" xref="alg1.l17.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.3.3.1.1.1.1.cmml" xref="alg1.l17.m1.3.3.1.1.1">subscript</csymbol><ci id="alg1.l17.m1.3.3.1.1.1.2.cmml" xref="alg1.l17.m1.3.3.1.1.1.2">italic-ϵ</ci><ci id="alg1.l17.m1.3.3.1.1.1.3a.cmml" xref="alg1.l17.m1.3.3.1.1.1.3"><mtext id="alg1.l17.m1.3.3.1.1.1.3.cmml" mathsize="70%" xref="alg1.l17.m1.3.3.1.1.1.3">real</mtext></ci></apply><apply id="alg1.l17.m1.4.4.2.2.2.cmml" xref="alg1.l17.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.2.2.2.1.cmml" xref="alg1.l17.m1.4.4.2.2.2">subscript</csymbol><ci id="alg1.l17.m1.4.4.2.2.2.2.cmml" xref="alg1.l17.m1.4.4.2.2.2.2">italic-ϵ</ci><ci id="alg1.l17.m1.4.4.2.2.2.3a.cmml" xref="alg1.l17.m1.4.4.2.2.2.3"><mtext id="alg1.l17.m1.4.4.2.2.2.3.cmml" mathsize="70%" xref="alg1.l17.m1.4.4.2.2.2.3">fake</mtext></ci></apply></list><apply id="alg1.l17.m1.4.4.4.cmml" xref="alg1.l17.m1.4.4.4"><times id="alg1.l17.m1.4.4.4.1.cmml" xref="alg1.l17.m1.4.4.4.1"></times><ci id="alg1.l17.m1.4.4.4.2.cmml" xref="alg1.l17.m1.4.4.4.2">𝒩</ci><interval closure="open" id="alg1.l17.m1.4.4.4.3.1.cmml" xref="alg1.l17.m1.4.4.4.3.2"><cn id="alg1.l17.m1.1.1.cmml" type="integer" xref="alg1.l17.m1.1.1">0</cn><ci id="alg1.l17.m1.2.2.cmml" xref="alg1.l17.m1.2.2">𝑰</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.4c">\epsilon_{\text{real}},\epsilon_{\text{fake}}\sim\mathcal{N}(0,\bm{I})</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.4d">italic_ϵ start_POSTSUBSCRIPT real end_POSTSUBSCRIPT , italic_ϵ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , bold_italic_I )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>     <math alttext="\mathcal{L}_{\text{GAN}}=\|D_{\bm{\psi}}({\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}+{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}\sigma}_{\text{fake}}\epsilon_{\text{fake}},{%
\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{%
rgb}{0.57421875,0.81640625,0.3125}\sigma}_{\text{fake}})\|_{2}^{2}+\|1-D_{\bm{%
\psi}}(\bm{x}_{\text{real}}+{\color[rgb]{0.57421875,0.81640625,0.3125}%
\definecolor[named]{pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}\sigma}_%
{\text{real}}\epsilon_{\text{real}},{\color[rgb]{0.57421875,0.81640625,0.3125}%
\definecolor[named]{pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}\sigma}_%
{\text{real}})\|_{2}^{2}" class="ltx_Math" display="inline" id="alg1.l18.m1.2"><semantics id="alg1.l18.m1.2a"><mrow id="alg1.l18.m1.2.2" xref="alg1.l18.m1.2.2.cmml"><msub id="alg1.l18.m1.2.2.4" xref="alg1.l18.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l18.m1.2.2.4.2" xref="alg1.l18.m1.2.2.4.2.cmml">ℒ</mi><mtext id="alg1.l18.m1.2.2.4.3" xref="alg1.l18.m1.2.2.4.3a.cmml">GAN</mtext></msub><mo id="alg1.l18.m1.2.2.3" xref="alg1.l18.m1.2.2.3.cmml">=</mo><mrow id="alg1.l18.m1.2.2.2" xref="alg1.l18.m1.2.2.2.cmml"><msubsup id="alg1.l18.m1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.cmml"><mrow id="alg1.l18.m1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.2.cmml"><mo id="alg1.l18.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l18.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l18.m1.1.1.1.1.1.1.1.1.4" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.1.4.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.4.2.cmml">D</mi><mi id="alg1.l18.m1.1.1.1.1.1.1.1.1.4.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.4.3.cmml">𝝍</mi></msub><mo id="alg1.l18.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" mathcolor="#2E5F7F" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒙</mi><mo id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1" mathcolor="#2E5F7F" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mtext id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" mathcolor="#2E5F7F" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml">gen</mtext></msub><mo id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" mathcolor="#92D050" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">σ</mi><mtext id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml">fake</mtext></msub><mo id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">ϵ</mi><mtext id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3a.cmml">fake</mtext></msub></mrow></mrow><mo id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.4" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.2" mathcolor="#92D050" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">σ</mi><mtext id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.3a.cmml">fake</mtext></msub><mo id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l18.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l18.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg1.l18.m1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.3.cmml">2</mn><mn id="alg1.l18.m1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="alg1.l18.m1.2.2.2.3" xref="alg1.l18.m1.2.2.2.3.cmml">+</mo><msubsup id="alg1.l18.m1.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.cmml"><mrow id="alg1.l18.m1.2.2.2.2.1.1.1" xref="alg1.l18.m1.2.2.2.2.1.1.2.cmml"><mo id="alg1.l18.m1.2.2.2.2.1.1.1.2" stretchy="false" xref="alg1.l18.m1.2.2.2.2.1.1.2.1.cmml">‖</mo><mrow id="alg1.l18.m1.2.2.2.2.1.1.1.1" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.cmml"><mn id="alg1.l18.m1.2.2.2.2.1.1.1.1.4" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.4.cmml">1</mn><mo id="alg1.l18.m1.2.2.2.2.1.1.1.1.3" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.3.cmml">−</mo><mrow id="alg1.l18.m1.2.2.2.2.1.1.1.1.2" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.cmml"><msub id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.cmml"><mi id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.2" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.2.cmml">D</mi><mi id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.3" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.3.cmml">𝝍</mi></msub><mo id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.3" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.3.cmml">⁢</mo><mrow id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.3.cmml"><mo id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.3" stretchy="false" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.3.cmml">(</mo><mrow id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mtext id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3a.cmml">real</mtext></msub><mo id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.1" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml"><msub id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.2" mathcolor="#92D050" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml">σ</mi><mtext id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.3" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.3a.cmml">real</mtext></msub><mo id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.1" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">ϵ</mi><mtext id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.3a.cmml">real</mtext></msub></mrow></mrow><mo id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.4" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.3.cmml">,</mo><msub id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.cmml"><mi id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.2" mathcolor="#92D050" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mtext id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.3a.cmml">real</mtext></msub><mo id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.5" stretchy="false" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l18.m1.2.2.2.2.1.1.1.3" stretchy="false" xref="alg1.l18.m1.2.2.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="alg1.l18.m1.2.2.2.2.1.3" xref="alg1.l18.m1.2.2.2.2.1.3.cmml">2</mn><mn id="alg1.l18.m1.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.2.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.2b"><apply id="alg1.l18.m1.2.2.cmml" xref="alg1.l18.m1.2.2"><eq id="alg1.l18.m1.2.2.3.cmml" xref="alg1.l18.m1.2.2.3"></eq><apply id="alg1.l18.m1.2.2.4.cmml" xref="alg1.l18.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.4.1.cmml" xref="alg1.l18.m1.2.2.4">subscript</csymbol><ci id="alg1.l18.m1.2.2.4.2.cmml" xref="alg1.l18.m1.2.2.4.2">ℒ</ci><ci id="alg1.l18.m1.2.2.4.3a.cmml" xref="alg1.l18.m1.2.2.4.3"><mtext id="alg1.l18.m1.2.2.4.3.cmml" mathsize="70%" xref="alg1.l18.m1.2.2.4.3">GAN</mtext></ci></apply><apply id="alg1.l18.m1.2.2.2.cmml" xref="alg1.l18.m1.2.2.2"><plus id="alg1.l18.m1.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.3"></plus><apply id="alg1.l18.m1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l18.m1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l18.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l18.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1"><times id="alg1.l18.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.3"></times><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.4.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.4.2">𝐷</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.4.3">𝝍</ci></apply><interval closure="open" id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2"><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1"><plus id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒙</ci></apply><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.3"><mtext id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" mathcolor="#2E5F7F" mathsize="70%" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">gen</mtext></ci></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝜎</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3"><mtext id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">fake</mtext></ci></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">italic-ϵ</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3a.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3"><mtext id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">fake</mtext></ci></apply></apply></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝜎</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.3a.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.3"><mtext id="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" mathsize="70%" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.2.2.2.3">fake</mtext></ci></apply></interval></apply></apply><cn id="alg1.l18.m1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l18.m1.1.1.1.1.1.3">2</cn></apply><cn id="alg1.l18.m1.1.1.1.1.3.cmml" type="integer" xref="alg1.l18.m1.1.1.1.1.3">2</cn></apply><apply id="alg1.l18.m1.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l18.m1.2.2.2.2.1.cmml" xref="alg1.l18.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.1.2.cmml" xref="alg1.l18.m1.2.2.2.2">subscript</csymbol><apply id="alg1.l18.m1.2.2.2.2.1.1.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1"><csymbol cd="latexml" id="alg1.l18.m1.2.2.2.2.1.1.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.2">norm</csymbol><apply id="alg1.l18.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1"><minus id="alg1.l18.m1.2.2.2.2.1.1.1.1.3.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.3"></minus><cn id="alg1.l18.m1.2.2.2.2.1.1.1.1.4.cmml" type="integer" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.4">1</cn><apply id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2"><times id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.3"></times><apply id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.2">𝐷</ci><ci id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.3.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.4.3">𝝍</ci></apply><interval closure="open" id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2"><apply id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1"><plus id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.1"></plus><apply id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3"><mtext id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3">real</mtext></ci></apply><apply id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3"><times id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.1"></times><apply id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.2">𝜎</ci><ci id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.3"><mtext id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.3">real</mtext></ci></apply><apply id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.2">italic-ϵ</ci><ci id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.3a.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.3"><mtext id="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.3">real</mtext></ci></apply></apply></apply><apply id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.2">𝜎</ci><ci id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.3a.cmml" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.3"><mtext id="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.3.cmml" mathsize="70%" xref="alg1.l18.m1.2.2.2.2.1.1.1.1.2.2.2.2.3">real</mtext></ci></apply></interval></apply></apply></apply><cn id="alg1.l18.m1.2.2.2.2.1.3.cmml" type="integer" xref="alg1.l18.m1.2.2.2.2.1.3">2</cn></apply><cn id="alg1.l18.m1.2.2.2.2.3.cmml" type="integer" xref="alg1.l18.m1.2.2.2.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.2c">\mathcal{L}_{\text{GAN}}=\|D_{\bm{\psi}}({\color[rgb]{%
0.1796875,0.37109375,0.49609375}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.1796875,0.37109375,0.49609375}\hat{\bm{x}}_{\text{gen}}}+{\color[rgb]{%
0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.57421875,0.81640625,0.3125}\sigma}_{\text{fake}}\epsilon_{\text{fake}},{%
\color[rgb]{0.57421875,0.81640625,0.3125}\definecolor[named]{pgfstrokecolor}{%
rgb}{0.57421875,0.81640625,0.3125}\sigma}_{\text{fake}})\|_{2}^{2}+\|1-D_{\bm{%
\psi}}(\bm{x}_{\text{real}}+{\color[rgb]{0.57421875,0.81640625,0.3125}%
\definecolor[named]{pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}\sigma}_%
{\text{real}}\epsilon_{\text{real}},{\color[rgb]{0.57421875,0.81640625,0.3125}%
\definecolor[named]{pgfstrokecolor}{rgb}{0.57421875,0.81640625,0.3125}\sigma}_%
{\text{real}})\|_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.2d">caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT = ∥ italic_D start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT + italic_σ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT italic_ϵ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT fake end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∥ 1 - italic_D start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT real end_POSTSUBSCRIPT + italic_σ start_POSTSUBSCRIPT real end_POSTSUBSCRIPT italic_ϵ start_POSTSUBSCRIPT real end_POSTSUBSCRIPT , italic_σ start_POSTSUBSCRIPT real end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span>     <math alttext="\bm{\psi}\leftarrow\bm{\psi}-g_{2}(\nabla_{\bm{\psi}}\mathcal{L}_{\text{fake-%
DSM}}+\nu_{2}\nabla_{\bm{\psi}}\mathcal{L}_{\text{GAN}})" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mi id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml">𝝍</mi><mo id="alg1.l19.m1.1.1.2" stretchy="false" xref="alg1.l19.m1.1.1.2.cmml">←</mo><mrow id="alg1.l19.m1.1.1.1" xref="alg1.l19.m1.1.1.1.cmml"><mi id="alg1.l19.m1.1.1.1.3" xref="alg1.l19.m1.1.1.1.3.cmml">𝝍</mi><mo id="alg1.l19.m1.1.1.1.2" xref="alg1.l19.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l19.m1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.cmml"><msub id="alg1.l19.m1.1.1.1.1.3" xref="alg1.l19.m1.1.1.1.1.3.cmml"><mi id="alg1.l19.m1.1.1.1.1.3.2" xref="alg1.l19.m1.1.1.1.1.3.2.cmml">g</mi><mn id="alg1.l19.m1.1.1.1.1.3.3" xref="alg1.l19.m1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="alg1.l19.m1.1.1.1.1.2" xref="alg1.l19.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l19.m1.1.1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l19.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l19.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l19.m1.1.1.1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.1.1.1.cmml"><mrow id="alg1.l19.m1.1.1.1.1.1.1.1.2" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.cmml"><msub id="alg1.l19.m1.1.1.1.1.1.1.1.2.1" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.1.cmml"><mo id="alg1.l19.m1.1.1.1.1.1.1.1.2.1.2" rspace="0.167em" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.1.2.cmml">∇</mo><mi id="alg1.l19.m1.1.1.1.1.1.1.1.2.1.3" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.1.3.cmml">𝝍</mi></msub><msub id="alg1.l19.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l19.m1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.2.2.cmml">ℒ</mi><mtext id="alg1.l19.m1.1.1.1.1.1.1.1.2.2.3" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.2.3a.cmml">fake-DSM</mtext></msub></mrow><mo id="alg1.l19.m1.1.1.1.1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l19.m1.1.1.1.1.1.1.1.3" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.cmml"><msub id="alg1.l19.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l19.m1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.2.2.cmml">ν</mi><mn id="alg1.l19.m1.1.1.1.1.1.1.1.3.2.3" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo id="alg1.l19.m1.1.1.1.1.1.1.1.3.1" lspace="0.167em" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="alg1.l19.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.cmml"><msub id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.2" rspace="0.167em" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.2.cmml">∇</mo><mi id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.3" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.3.cmml">𝝍</mi></msub><msub id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.2" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.2.cmml">ℒ</mi><mtext id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.3" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.3a.cmml">GAN</mtext></msub></mrow></mrow></mrow><mo id="alg1.l19.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l19.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><ci id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">←</ci><ci id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3">𝝍</ci><apply id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1"><minus id="alg1.l19.m1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.2"></minus><ci id="alg1.l19.m1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.3">𝝍</ci><apply id="alg1.l19.m1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1"><times id="alg1.l19.m1.1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.2"></times><apply id="alg1.l19.m1.1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.1.1.3.2">𝑔</ci><cn id="alg1.l19.m1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l19.m1.1.1.1.1.3.3">2</cn></apply><apply id="alg1.l19.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1"><plus id="alg1.l19.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.1"></plus><apply id="alg1.l19.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.2"><apply id="alg1.l19.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.1.2.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.1.1.1.2.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.1.2">∇</ci><ci id="alg1.l19.m1.1.1.1.1.1.1.1.2.1.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.1.3">𝝍</ci></apply><apply id="alg1.l19.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.2.2">ℒ</ci><ci id="alg1.l19.m1.1.1.1.1.1.1.1.2.2.3a.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.2.3"><mtext id="alg1.l19.m1.1.1.1.1.1.1.1.2.2.3.cmml" mathsize="70%" xref="alg1.l19.m1.1.1.1.1.1.1.1.2.2.3">fake-DSM</mtext></ci></apply></apply><apply id="alg1.l19.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3"><times id="alg1.l19.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.1"></times><apply id="alg1.l19.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.2.2">𝜈</ci><cn id="alg1.l19.m1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.2.3">2</cn></apply><apply id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3"><apply id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.2">∇</ci><ci id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.1.3">𝝍</ci></apply><apply id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.2">ℒ</ci><ci id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.3a.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.3"><mtext id="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.3.cmml" mathsize="70%" xref="alg1.l19.m1.1.1.1.1.1.1.1.3.3.2.3">GAN</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\bm{\psi}\leftarrow\bm{\psi}-g_{2}(\nabla_{\bm{\psi}}\mathcal{L}_{\text{fake-%
DSM}}+\nu_{2}\nabla_{\bm{\psi}}\mathcal{L}_{\text{GAN}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">bold_italic_ψ ← bold_italic_ψ - italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( ∇ start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT fake-DSM end_POSTSUBSCRIPT + italic_ν start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∇ start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l20.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l20.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l20a">
<span class="ltx_tag ltx_tag_listingline">20:</span>  : <math alttext="\bm{\phi},\bm{\psi}" class="ltx_Math" display="inline" id="alg1.l20a.m1.2"><semantics id="alg1.l20a.m1.2a"><mrow id="alg1.l20a.m1.2.3.2" xref="alg1.l20a.m1.2.3.1.cmml"><mi class="ltx_mathvariant_bold-italic" id="alg1.l20a.m1.1.1" mathvariant="bold-italic" xref="alg1.l20a.m1.1.1.cmml">ϕ</mi><mo id="alg1.l20a.m1.2.3.2.1" xref="alg1.l20a.m1.2.3.1.cmml">,</mo><mi id="alg1.l20a.m1.2.2" xref="alg1.l20a.m1.2.2.cmml">𝝍</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20a.m1.2b"><list id="alg1.l20a.m1.2.3.1.cmml" xref="alg1.l20a.m1.2.3.2"><ci id="alg1.l20a.m1.1.1.cmml" xref="alg1.l20a.m1.1.1">bold-italic-ϕ</ci><ci id="alg1.l20a.m1.2.2.cmml" xref="alg1.l20a.m1.2.2">𝝍</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20a.m1.2c">\bm{\phi},\bm{\psi}</annotation><annotation encoding="application/x-llamapun" id="alg1.l20a.m1.2d">bold_italic_ϕ , bold_italic_ψ</annotation></semantics></math>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Analyzing Failure Modes of Combined Layer and Step Distillation</h3>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">We empirically discovered a number of failure modes when trying to combine step and layer distillation. As noted in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.SS6" title="4.6 Presto-LS Qualitative Analysis ‣ 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">4.6</span></a>, the heavier per-layer requirements of distilled few-step generation made all standard dropping schedules <cite class="ltx_cite ltx_citemacro_citep">(Moon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib38" title="">2024</a>)</cite> intractable and prone to quick generator collapse, necessitating a more conservative dropping schedule. In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.F8" title="Figure 8 ‣ A.4 Analyzing Failure Modes of Combined Layer and Step Distillation ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">8</span></a>, we show the generator loss, discriminator loss, distribution matching gradient, and the discriminator’s accuracy for the <em class="ltx_emph ltx_font_italic" id="A1.SS4.p1.1.1">real</em> inputs over distillation, for a number of different setups:</p>
</div>
<figure class="ltx_figure" id="A1.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="489" id="A1.F8.g1" src="x8.png" width="647"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Step distillation losses for early distillation for multiple combination methods. <span class="ltx_text ltx_font_bold" id="A1.F8.2.1">Presto-LS</span> is the only setup that avoids generator degradation and high variance distribution matching gradients.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A1.SS4.p2">
<ul class="ltx_itemize" id="A1.I2">
<li class="ltx_item" id="A1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i1.p1">
<p class="ltx_p" id="A1.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.i1.p1.1.1">Presto-S</span>, pure step distillation mechanism (blue).</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i2.p1">
<p class="ltx_p" id="A1.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A1.I2.i2.p1.1.1">Presto-LS</span>, optimal combined setup where we pretrain the model with <span class="ltx_text ltx_font_bold" id="A1.I2.i2.p1.1.2">Presto-L</span> and then perform <span class="ltx_text ltx_font_bold" id="A1.I2.i2.p1.1.3">Presto-S</span>, but with keeping the real and fake score models initialized from the original score model (orange).</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i3.p1">
<p class="ltx_p" id="A1.I2.i3.p1.1">LS with L-Fake/Real, which mimics <span class="ltx_text ltx_font_bold" id="A1.I2.i3.p1.1.1">Presto-LS</span> but uses the <span class="ltx_text ltx_font_bold" id="A1.I2.i3.p1.1.2">Presto-L</span> model for the fake and real score models as well (green).</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i4.p1">
<p class="ltx_p" id="A1.I2.i4.p1.1">Step then Layer, where we first perform <span class="ltx_text ltx_font_bold" id="A1.I2.i4.p1.1.1">Presto-S</span> distillation and then continue distillation with <span class="ltx_text ltx_font_bold" id="A1.I2.i4.p1.1.2">Presto-L</span> layer dropping on the generator (red).</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I2.i5.p1">
<p class="ltx_p" id="A1.I2.i5.p1.1">Step and Layer jointly, where we perform <span class="ltx_text ltx_font_bold" id="A1.I2.i5.p1.1.1">Presto-S</span> and <span class="ltx_text ltx_font_bold" id="A1.I2.i5.p1.1.2">Presto-L</span> at the same time initialized from the original score model (purple),</p>
</div>
</li>
</ul>
<p class="ltx_p" id="A1.SS4.p2.1">We see that the runs which do not initialize with pretrained <span class="ltx_text ltx_font_bold" id="A1.SS4.p2.1.1">Presto-L</span> (Step then Layer, Step and Layer) show clear signs of generator degradation, with increased generator loss, decreased discriminator loss, and notably near perfect accuracy on real samples, as attempting to learn to drop layers from scratch during step distillation gives strong signal to the discriminator. Additionally, LS with L-Fake/Real inherits similar collapse issues but has a higher variance distribution matching gradient as the layer-distilled real and fake score models are poor estimators of the gradient.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Inference-time noise schedule Sensitivity analysis</h3>
<div class="ltx_para ltx_noindent" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.1">Given our final <span class="ltx_text ltx_font_bold" id="A1.SS5.p1.1.1">Presto-LS</span> distilled 4-step generator, we show how changing the inference-time noise schedule can noticeably alter the outputs, motivating our idea of a continuous-time conditioning.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.p2">
<p class="ltx_p" id="A1.SS5.p2.3">The EDM inference schedule follows the form of:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sigma_{i&lt;N}=\left(\sigma_{\text{max}}^{1/\rho}+\frac{i}{N-1}(\sigma_{\text{%
min}}^{1/\rho}-\sigma_{\text{max}}^{1/\rho})\right)^{\rho}," class="ltx_Math" display="block" id="A1.E9.m1.1"><semantics id="A1.E9.m1.1a"><mrow id="A1.E9.m1.1.1.1" xref="A1.E9.m1.1.1.1.1.cmml"><mrow id="A1.E9.m1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.cmml"><msub id="A1.E9.m1.1.1.1.1.3" xref="A1.E9.m1.1.1.1.1.3.cmml"><mi id="A1.E9.m1.1.1.1.1.3.2" xref="A1.E9.m1.1.1.1.1.3.2.cmml">σ</mi><mrow id="A1.E9.m1.1.1.1.1.3.3" xref="A1.E9.m1.1.1.1.1.3.3.cmml"><mi id="A1.E9.m1.1.1.1.1.3.3.2" xref="A1.E9.m1.1.1.1.1.3.3.2.cmml">i</mi><mo id="A1.E9.m1.1.1.1.1.3.3.1" xref="A1.E9.m1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="A1.E9.m1.1.1.1.1.3.3.3" xref="A1.E9.m1.1.1.1.1.3.3.3.cmml">N</mi></mrow></msub><mo id="A1.E9.m1.1.1.1.1.2" xref="A1.E9.m1.1.1.1.1.2.cmml">=</mo><msup id="A1.E9.m1.1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.cmml"><mrow id="A1.E9.m1.1.1.1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E9.m1.1.1.1.1.1.1.1.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A1.E9.m1.1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">σ</mi><mtext id="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.3a.cmml">max</mtext><mrow id="A1.E9.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo id="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.1" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">/</mo><mi id="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">ρ</mi></mrow></msubsup><mo id="A1.E9.m1.1.1.1.1.1.1.1.1.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="A1.E9.m1.1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mfrac id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mrow id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">N</mi><mo id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac><mo id="A1.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">σ</mi><mtext id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3a.cmml">min</mtext><mrow id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mn id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">/</mo><mi id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">ρ</mi></mrow></msubsup><mo id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">σ</mi><mtext id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml">max</mtext><mrow id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">/</mo><mi id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">ρ</mi></mrow></msubsup></mrow><mo id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E9.m1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E9.m1.1.1.1.1.1.3" xref="A1.E9.m1.1.1.1.1.1.3.cmml">ρ</mi></msup></mrow><mo id="A1.E9.m1.1.1.1.2" xref="A1.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.1b"><apply id="A1.E9.m1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1"><eq id="A1.E9.m1.1.1.1.1.2.cmml" xref="A1.E9.m1.1.1.1.1.2"></eq><apply id="A1.E9.m1.1.1.1.1.3.cmml" xref="A1.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.1.1.1.1.3.1.cmml" xref="A1.E9.m1.1.1.1.1.3">subscript</csymbol><ci id="A1.E9.m1.1.1.1.1.3.2.cmml" xref="A1.E9.m1.1.1.1.1.3.2">𝜎</ci><apply id="A1.E9.m1.1.1.1.1.3.3.cmml" xref="A1.E9.m1.1.1.1.1.3.3"><lt id="A1.E9.m1.1.1.1.1.3.3.1.cmml" xref="A1.E9.m1.1.1.1.1.3.3.1"></lt><ci id="A1.E9.m1.1.1.1.1.3.3.2.cmml" xref="A1.E9.m1.1.1.1.1.3.3.2">𝑖</ci><ci id="A1.E9.m1.1.1.1.1.3.3.3.cmml" xref="A1.E9.m1.1.1.1.1.3.3.3">𝑁</ci></apply></apply><apply id="A1.E9.m1.1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.1.1.1.1.1">superscript</csymbol><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1"><plus id="A1.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.2"></plus><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.2">𝜎</ci><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.3"><mtext id="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.2.3">max</mtext></ci></apply><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.3"><divide id="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.1"></divide><cn id="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.3.3.3">𝜌</ci></apply></apply><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1"><times id="A1.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3"><divide id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3"></divide><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3"><minus id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑁</ci><cn id="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝜎</ci><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3a.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3"><mtext id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" mathsize="70%" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">min</mtext></ci></apply><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><divide id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></divide><cn id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝜌</ci></apply></apply><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝜎</ci><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3"><mtext id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">max</mtext></ci></apply><apply id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><divide id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></divide><cn id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝜌</ci></apply></apply></apply></apply></apply><ci id="A1.E9.m1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.1.1.1.1.1.3">𝜌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.1c">\sigma_{i&lt;N}=\left(\sigma_{\text{max}}^{1/\rho}+\frac{i}{N-1}(\sigma_{\text{%
min}}^{1/\rho}-\sigma_{\text{max}}^{1/\rho})\right)^{\rho},</annotation><annotation encoding="application/x-llamapun" id="A1.E9.m1.1d">italic_σ start_POSTSUBSCRIPT italic_i &lt; italic_N end_POSTSUBSCRIPT = ( italic_σ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 / italic_ρ end_POSTSUPERSCRIPT + divide start_ARG italic_i end_ARG start_ARG italic_N - 1 end_ARG ( italic_σ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 / italic_ρ end_POSTSUPERSCRIPT - italic_σ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 / italic_ρ end_POSTSUPERSCRIPT ) ) start_POSTSUPERSCRIPT italic_ρ end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS5.p2.2">where increasing the <math alttext="\rho" class="ltx_Math" display="inline" id="A1.SS5.p2.1.m1.1"><semantics id="A1.SS5.p2.1.m1.1a"><mi id="A1.SS5.p2.1.m1.1.1" xref="A1.SS5.p2.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.1.m1.1b"><ci id="A1.SS5.p2.1.m1.1.1.cmml" xref="A1.SS5.p2.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.1.m1.1d">italic_ρ</annotation></semantics></math> parameter puts more weight on the low-noise, high-SNR regions of the diffusion process. In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.F9" title="Figure 9 ‣ A.5 Inference-time noise schedule Sensitivity analysis ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">9</span></a>, we show a number of samples generated from <span class="ltx_text ltx_font_bold" id="A1.SS5.p2.2.1">Presto-LS</span> with identical conditions and latent codes (i.e. starting noise and all other added gaussian noise during sampling), only changing <math alttext="\rho" class="ltx_Math" display="inline" id="A1.SS5.p2.2.m2.1"><semantics id="A1.SS5.p2.2.m2.1a"><mi id="A1.SS5.p2.2.m2.1.1" xref="A1.SS5.p2.2.m2.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.2.m2.1b"><ci id="A1.SS5.p2.2.m2.1.1.cmml" xref="A1.SS5.p2.2.m2.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.2.m2.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.2.m2.1d">italic_ρ</annotation></semantics></math>, from the standard of 7 to 1000 (high weight in low-noise region). We expect further inference-time tuning of the noise schedule to be beneficial.</p>
</div>
<figure class="ltx_figure" id="A1.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="862" id="A1.F9.g1" src="x9.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Generations from <span class="ltx_text ltx_font_bold" id="A1.F9.5.1">Presto-LS</span> from the <em class="ltx_emph ltx_font_italic" id="A1.F9.6.2">same</em> text prompt and latent code (i.e. starting noise and added noise during sampling), only varying the <math alttext="\rho" class="ltx_Math" display="inline" id="A1.F9.2.m1.1"><semantics id="A1.F9.2.m1.1b"><mi id="A1.F9.2.m1.1.1" xref="A1.F9.2.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="A1.F9.2.m1.1c"><ci id="A1.F9.2.m1.1.1.cmml" xref="A1.F9.2.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.2.m1.1d">\rho</annotation><annotation encoding="application/x-llamapun" id="A1.F9.2.m1.1e">italic_ρ</annotation></semantics></math> parameter between (7 and 1000). Purely shifting the noise schedule for 4-step sampling allows for perceptually distinct outputs.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>RTF Analysis</h3>
<div class="ltx_para ltx_noindent" id="A1.SS6.p1">
<p class="ltx_p" id="A1.SS6.p1.6">We define the RTF for a model <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="A1.SS6.p1.1.m1.1"><semantics id="A1.SS6.p1.1.m1.1a"><mi id="A1.SS6.p1.1.m1.1.1" xref="A1.SS6.p1.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.1.m1.1b"><ci id="A1.SS6.p1.1.m1.1.1.cmml" xref="A1.SS6.p1.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.1.m1.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.1.m1.1d">bold_italic_θ</annotation></semantics></math> as:
<math alttext="\text{RTF}_{b}(\bm{\theta})=\frac{bT_{\bm{\theta}}}{\text{latency}_{\bm{\theta%
}}(b)}" class="ltx_Math" display="inline" id="A1.SS6.p1.2.m2.2"><semantics id="A1.SS6.p1.2.m2.2a"><mrow id="A1.SS6.p1.2.m2.2.3" xref="A1.SS6.p1.2.m2.2.3.cmml"><mrow id="A1.SS6.p1.2.m2.2.3.2" xref="A1.SS6.p1.2.m2.2.3.2.cmml"><msub id="A1.SS6.p1.2.m2.2.3.2.2" xref="A1.SS6.p1.2.m2.2.3.2.2.cmml"><mtext id="A1.SS6.p1.2.m2.2.3.2.2.2" xref="A1.SS6.p1.2.m2.2.3.2.2.2a.cmml">RTF</mtext><mi id="A1.SS6.p1.2.m2.2.3.2.2.3" xref="A1.SS6.p1.2.m2.2.3.2.2.3.cmml">b</mi></msub><mo id="A1.SS6.p1.2.m2.2.3.2.1" xref="A1.SS6.p1.2.m2.2.3.2.1.cmml">⁢</mo><mrow id="A1.SS6.p1.2.m2.2.3.2.3.2" xref="A1.SS6.p1.2.m2.2.3.2.cmml"><mo id="A1.SS6.p1.2.m2.2.3.2.3.2.1" stretchy="false" xref="A1.SS6.p1.2.m2.2.3.2.cmml">(</mo><mi id="A1.SS6.p1.2.m2.2.2" xref="A1.SS6.p1.2.m2.2.2.cmml">𝜽</mi><mo id="A1.SS6.p1.2.m2.2.3.2.3.2.2" stretchy="false" xref="A1.SS6.p1.2.m2.2.3.2.cmml">)</mo></mrow></mrow><mo id="A1.SS6.p1.2.m2.2.3.1" xref="A1.SS6.p1.2.m2.2.3.1.cmml">=</mo><mfrac id="A1.SS6.p1.2.m2.1.1" xref="A1.SS6.p1.2.m2.1.1.cmml"><mrow id="A1.SS6.p1.2.m2.1.1.3" xref="A1.SS6.p1.2.m2.1.1.3.cmml"><mi id="A1.SS6.p1.2.m2.1.1.3.2" xref="A1.SS6.p1.2.m2.1.1.3.2.cmml">b</mi><mo id="A1.SS6.p1.2.m2.1.1.3.1" xref="A1.SS6.p1.2.m2.1.1.3.1.cmml">⁢</mo><msub id="A1.SS6.p1.2.m2.1.1.3.3" xref="A1.SS6.p1.2.m2.1.1.3.3.cmml"><mi id="A1.SS6.p1.2.m2.1.1.3.3.2" xref="A1.SS6.p1.2.m2.1.1.3.3.2.cmml">T</mi><mi id="A1.SS6.p1.2.m2.1.1.3.3.3" xref="A1.SS6.p1.2.m2.1.1.3.3.3.cmml">𝜽</mi></msub></mrow><mrow id="A1.SS6.p1.2.m2.1.1.1" xref="A1.SS6.p1.2.m2.1.1.1.cmml"><msub id="A1.SS6.p1.2.m2.1.1.1.3" xref="A1.SS6.p1.2.m2.1.1.1.3.cmml"><mtext id="A1.SS6.p1.2.m2.1.1.1.3.2" xref="A1.SS6.p1.2.m2.1.1.1.3.2a.cmml">latency</mtext><mi id="A1.SS6.p1.2.m2.1.1.1.3.3" xref="A1.SS6.p1.2.m2.1.1.1.3.3.cmml">𝜽</mi></msub><mo id="A1.SS6.p1.2.m2.1.1.1.2" xref="A1.SS6.p1.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS6.p1.2.m2.1.1.1.4.2" xref="A1.SS6.p1.2.m2.1.1.1.cmml"><mo id="A1.SS6.p1.2.m2.1.1.1.4.2.1" stretchy="false" xref="A1.SS6.p1.2.m2.1.1.1.cmml">(</mo><mi id="A1.SS6.p1.2.m2.1.1.1.1" xref="A1.SS6.p1.2.m2.1.1.1.1.cmml">b</mi><mo id="A1.SS6.p1.2.m2.1.1.1.4.2.2" stretchy="false" xref="A1.SS6.p1.2.m2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.2.m2.2b"><apply id="A1.SS6.p1.2.m2.2.3.cmml" xref="A1.SS6.p1.2.m2.2.3"><eq id="A1.SS6.p1.2.m2.2.3.1.cmml" xref="A1.SS6.p1.2.m2.2.3.1"></eq><apply id="A1.SS6.p1.2.m2.2.3.2.cmml" xref="A1.SS6.p1.2.m2.2.3.2"><times id="A1.SS6.p1.2.m2.2.3.2.1.cmml" xref="A1.SS6.p1.2.m2.2.3.2.1"></times><apply id="A1.SS6.p1.2.m2.2.3.2.2.cmml" xref="A1.SS6.p1.2.m2.2.3.2.2"><csymbol cd="ambiguous" id="A1.SS6.p1.2.m2.2.3.2.2.1.cmml" xref="A1.SS6.p1.2.m2.2.3.2.2">subscript</csymbol><ci id="A1.SS6.p1.2.m2.2.3.2.2.2a.cmml" xref="A1.SS6.p1.2.m2.2.3.2.2.2"><mtext id="A1.SS6.p1.2.m2.2.3.2.2.2.cmml" xref="A1.SS6.p1.2.m2.2.3.2.2.2">RTF</mtext></ci><ci id="A1.SS6.p1.2.m2.2.3.2.2.3.cmml" xref="A1.SS6.p1.2.m2.2.3.2.2.3">𝑏</ci></apply><ci id="A1.SS6.p1.2.m2.2.2.cmml" xref="A1.SS6.p1.2.m2.2.2">𝜽</ci></apply><apply id="A1.SS6.p1.2.m2.1.1.cmml" xref="A1.SS6.p1.2.m2.1.1"><divide id="A1.SS6.p1.2.m2.1.1.2.cmml" xref="A1.SS6.p1.2.m2.1.1"></divide><apply id="A1.SS6.p1.2.m2.1.1.3.cmml" xref="A1.SS6.p1.2.m2.1.1.3"><times id="A1.SS6.p1.2.m2.1.1.3.1.cmml" xref="A1.SS6.p1.2.m2.1.1.3.1"></times><ci id="A1.SS6.p1.2.m2.1.1.3.2.cmml" xref="A1.SS6.p1.2.m2.1.1.3.2">𝑏</ci><apply id="A1.SS6.p1.2.m2.1.1.3.3.cmml" xref="A1.SS6.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS6.p1.2.m2.1.1.3.3.1.cmml" xref="A1.SS6.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="A1.SS6.p1.2.m2.1.1.3.3.2.cmml" xref="A1.SS6.p1.2.m2.1.1.3.3.2">𝑇</ci><ci id="A1.SS6.p1.2.m2.1.1.3.3.3.cmml" xref="A1.SS6.p1.2.m2.1.1.3.3.3">𝜽</ci></apply></apply><apply id="A1.SS6.p1.2.m2.1.1.1.cmml" xref="A1.SS6.p1.2.m2.1.1.1"><times id="A1.SS6.p1.2.m2.1.1.1.2.cmml" xref="A1.SS6.p1.2.m2.1.1.1.2"></times><apply id="A1.SS6.p1.2.m2.1.1.1.3.cmml" xref="A1.SS6.p1.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS6.p1.2.m2.1.1.1.3.1.cmml" xref="A1.SS6.p1.2.m2.1.1.1.3">subscript</csymbol><ci id="A1.SS6.p1.2.m2.1.1.1.3.2a.cmml" xref="A1.SS6.p1.2.m2.1.1.1.3.2"><mtext id="A1.SS6.p1.2.m2.1.1.1.3.2.cmml" mathsize="70%" xref="A1.SS6.p1.2.m2.1.1.1.3.2">latency</mtext></ci><ci id="A1.SS6.p1.2.m2.1.1.1.3.3.cmml" xref="A1.SS6.p1.2.m2.1.1.1.3.3">𝜽</ci></apply><ci id="A1.SS6.p1.2.m2.1.1.1.1.cmml" xref="A1.SS6.p1.2.m2.1.1.1.1">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.2.m2.2c">\text{RTF}_{b}(\bm{\theta})=\frac{bT_{\bm{\theta}}}{\text{latency}_{\bm{\theta%
}}(b)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.2.m2.2d">RTF start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( bold_italic_θ ) = divide start_ARG italic_b italic_T start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT end_ARG start_ARG latency start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( italic_b ) end_ARG</annotation></semantics></math>, where <math alttext="T_{\bm{\theta}}" class="ltx_Math" display="inline" id="A1.SS6.p1.3.m3.1"><semantics id="A1.SS6.p1.3.m3.1a"><msub id="A1.SS6.p1.3.m3.1.1" xref="A1.SS6.p1.3.m3.1.1.cmml"><mi id="A1.SS6.p1.3.m3.1.1.2" xref="A1.SS6.p1.3.m3.1.1.2.cmml">T</mi><mi id="A1.SS6.p1.3.m3.1.1.3" xref="A1.SS6.p1.3.m3.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.3.m3.1b"><apply id="A1.SS6.p1.3.m3.1.1.cmml" xref="A1.SS6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.3.m3.1.1.1.cmml" xref="A1.SS6.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS6.p1.3.m3.1.1.2.cmml" xref="A1.SS6.p1.3.m3.1.1.2">𝑇</ci><ci id="A1.SS6.p1.3.m3.1.1.3.cmml" xref="A1.SS6.p1.3.m3.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.3.m3.1c">T_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.3.m3.1d">italic_T start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is the generation duration or how much <em class="ltx_emph ltx_font_italic" id="A1.SS6.p1.6.1">contiguous</em> audio the model can generate at once
and <math alttext="\text{latency}_{\bm{\theta}}(b)" class="ltx_Math" display="inline" id="A1.SS6.p1.4.m4.1"><semantics id="A1.SS6.p1.4.m4.1a"><mrow id="A1.SS6.p1.4.m4.1.2" xref="A1.SS6.p1.4.m4.1.2.cmml"><msub id="A1.SS6.p1.4.m4.1.2.2" xref="A1.SS6.p1.4.m4.1.2.2.cmml"><mtext id="A1.SS6.p1.4.m4.1.2.2.2" xref="A1.SS6.p1.4.m4.1.2.2.2a.cmml">latency</mtext><mi id="A1.SS6.p1.4.m4.1.2.2.3" xref="A1.SS6.p1.4.m4.1.2.2.3.cmml">𝜽</mi></msub><mo id="A1.SS6.p1.4.m4.1.2.1" xref="A1.SS6.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="A1.SS6.p1.4.m4.1.2.3.2" xref="A1.SS6.p1.4.m4.1.2.cmml"><mo id="A1.SS6.p1.4.m4.1.2.3.2.1" stretchy="false" xref="A1.SS6.p1.4.m4.1.2.cmml">(</mo><mi id="A1.SS6.p1.4.m4.1.1" xref="A1.SS6.p1.4.m4.1.1.cmml">b</mi><mo id="A1.SS6.p1.4.m4.1.2.3.2.2" stretchy="false" xref="A1.SS6.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.4.m4.1b"><apply id="A1.SS6.p1.4.m4.1.2.cmml" xref="A1.SS6.p1.4.m4.1.2"><times id="A1.SS6.p1.4.m4.1.2.1.cmml" xref="A1.SS6.p1.4.m4.1.2.1"></times><apply id="A1.SS6.p1.4.m4.1.2.2.cmml" xref="A1.SS6.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="A1.SS6.p1.4.m4.1.2.2.1.cmml" xref="A1.SS6.p1.4.m4.1.2.2">subscript</csymbol><ci id="A1.SS6.p1.4.m4.1.2.2.2a.cmml" xref="A1.SS6.p1.4.m4.1.2.2.2"><mtext id="A1.SS6.p1.4.m4.1.2.2.2.cmml" xref="A1.SS6.p1.4.m4.1.2.2.2">latency</mtext></ci><ci id="A1.SS6.p1.4.m4.1.2.2.3.cmml" xref="A1.SS6.p1.4.m4.1.2.2.3">𝜽</ci></apply><ci id="A1.SS6.p1.4.m4.1.1.cmml" xref="A1.SS6.p1.4.m4.1.1">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.4.m4.1c">\text{latency}_{\bm{\theta}}(b)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.4.m4.1d">latency start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( italic_b )</annotation></semantics></math> is the time it takes for generating a batch of <math alttext="b" class="ltx_Math" display="inline" id="A1.SS6.p1.5.m5.1"><semantics id="A1.SS6.p1.5.m5.1a"><mi id="A1.SS6.p1.5.m5.1.1" xref="A1.SS6.p1.5.m5.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.5.m5.1b"><ci id="A1.SS6.p1.5.m5.1.1.cmml" xref="A1.SS6.p1.5.m5.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.5.m5.1c">b</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.5.m5.1d">italic_b</annotation></semantics></math> samples, following <cite class="ltx_cite ltx_citemacro_citep">(Evans et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib13" title="">2024b</a>; Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib68" title="">2024</a>)</cite>.
This is different from the fixed-duration batched RTF used in <cite class="ltx_cite ltx_citemacro_citet">Nistal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib40" title="">2024</a>)</cite>.
We test <math alttext="b=1" class="ltx_Math" display="inline" id="A1.SS6.p1.6.m6.1"><semantics id="A1.SS6.p1.6.m6.1a"><mrow id="A1.SS6.p1.6.m6.1.1" xref="A1.SS6.p1.6.m6.1.1.cmml"><mi id="A1.SS6.p1.6.m6.1.1.2" xref="A1.SS6.p1.6.m6.1.1.2.cmml">b</mi><mo id="A1.SS6.p1.6.m6.1.1.1" xref="A1.SS6.p1.6.m6.1.1.1.cmml">=</mo><mn id="A1.SS6.p1.6.m6.1.1.3" xref="A1.SS6.p1.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.6.m6.1b"><apply id="A1.SS6.p1.6.m6.1.1.cmml" xref="A1.SS6.p1.6.m6.1.1"><eq id="A1.SS6.p1.6.m6.1.1.1.cmml" xref="A1.SS6.p1.6.m6.1.1.1"></eq><ci id="A1.SS6.p1.6.m6.1.1.2.cmml" xref="A1.SS6.p1.6.m6.1.1.2">𝑏</ci><cn id="A1.SS6.p1.6.m6.1.1.3.cmml" type="integer" xref="A1.SS6.p1.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.6.m6.1c">b=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.6.m6.1d">italic_b = 1</annotation></semantics></math> as well as the <em class="ltx_emph ltx_font_italic" id="A1.SS6.p1.6.2">maximum</em> batch size we could attain for each model on a single A100 40GB to get a sense of maximum throughput.
We show results in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.T3" title="Table 3 ‣ A.6 RTF Analysis ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">3</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.T4" title="Table 4 ‣ A.6 RTF Analysis ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">4</span></a> for all components of our generative process, including latency metrics for generation (i.e. the diffusion model or distilled generator), decoding (i.e. VAE decoder from latents to audio) and the optional mono-to-stereo (M2S), as well as overall RTF/latency for mono and stereo inference.
We omit the MusicGen models and the other step-distillation methods which share the same RTF as <span class="ltx_text ltx_font_bold" id="A1.SS6.p1.6.3">Presto-S</span>.
For the fastest model <span class="ltx_text ltx_font_bold" id="A1.SS6.p1.6.4">Presto-LS</span>, the biggest latency bottleneck is the mono-to-stereo model <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#bib.bib68" title="">2024</a>)</cite> and VAE decoder.
In future work, we hope to optimize the VAE and mono-to-stereo modules for faster inference.</p>
</div>
<figure class="ltx_table" id="A1.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A1.T3.1.1.1.1" rowspan="2"><span class="ltx_text" id="A1.T3.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T3.1.1.1.2">Generation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T3.1.1.1.3">Decoding</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T3.1.1.1.4">Mono</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T3.1.1.1.5">Mono</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T3.1.1.1.6">M2S</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T3.1.1.1.7">Stereo</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T3.1.1.1.8">Stereo</th>
</tr>
<tr class="ltx_tr" id="A1.T3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T3.1.2.2.1">Latency</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T3.1.2.2.2">Latency</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T3.1.2.2.3">RTF</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="A1.T3.1.2.2.4">Latency</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T3.1.2.2.5">Latency</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T3.1.2.2.6">RTF</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T3.1.2.2.7">Latency</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T3.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T3.1.3.1.1">Stable Audio Open</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.1.3.1.2">6159.01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.1.3.1.3">887.99</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.1.3.1.4">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T3.1.3.1.5">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.1.3.1.6">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.1.3.1.7">4.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T3.1.3.1.8">7047</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T3.1.4.2.1">Base DM</th>
<td class="ltx_td ltx_align_center" id="A1.T3.1.4.2.2">4079.81</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.4.2.3">64.45</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.4.2.4">7.72</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T3.1.4.2.5">4144.27</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.4.2.6">205.31</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.4.2.7">7.36</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.4.2.8">4349.58</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T3.1.5.3.1">ASE</th>
<td class="ltx_td ltx_align_center" id="A1.T3.1.5.3.2">3200.73</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.5.3.3">64.45</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.5.3.4">9.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T3.1.5.3.5">3265.19</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.5.3.6">205.31</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.5.3.7">9.22</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.5.3.8">3470.50</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T3.1.6.4.1">Presto-L</th>
<td class="ltx_td ltx_align_center" id="A1.T3.1.6.4.2">3201.19</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.6.4.3">64.45</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.6.4.4">9.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T3.1.6.4.5">3265.64</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.6.4.6">205.31</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.6.4.7">9.22</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.6.4.8">3470.95</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T3.1.7.5.1">SoundCTM</th>
<td class="ltx_td ltx_align_center" id="A1.T3.1.7.5.2">238.06</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.7.5.3">64.45</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.7.5.4">105.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T3.1.7.5.5">302.51</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.7.5.6">205.31</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.7.5.7">63.01</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.7.5.8">507.83</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T3.1.8.6.1">Presto-S</th>
<td class="ltx_td ltx_align_center" id="A1.T3.1.8.6.2">204.98</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.8.6.3">64.45</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.8.6.4">118.77</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T3.1.8.6.5">269.43</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.8.6.6">205.31</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.8.6.7">67.41</td>
<td class="ltx_td ltx_align_center" id="A1.T3.1.8.6.8">474.74</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A1.T3.1.9.7.1">Presto-LS</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.1.9.7.2">166.04</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.1.9.7.3">64.45</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.1.9.7.4">138.84</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A1.T3.1.9.7.5">230.49</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.1.9.7.6">205.31</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.1.9.7.7">73.43</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T3.1.9.7.8">435.8</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Latency (ms) and real-time factor for a batch size of one on an A100 40GB GPU.</figcaption>
</figure>
<figure class="ltx_table" id="A1.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A1.T4.1.1.1.1" rowspan="2"><span class="ltx_text" id="A1.T4.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.1.1.1.2">Generation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.1.1.1.3">Decoding</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.1.1.1.4">Mono</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A1.T4.1.1.1.5">Mono</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.1.1.1.6">M2S</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.1.1.1.7">Stereo</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.1.1.1.8">Stereo</th>
</tr>
<tr class="ltx_tr" id="A1.T4.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T4.1.2.2.1">Latency</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T4.1.2.2.2">Latency</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T4.1.2.2.3">RTF</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="A1.T4.1.2.2.4">Latency</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T4.1.2.2.5">Latency</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T4.1.2.2.6">RTF</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T4.1.2.2.7">Latency</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T4.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T4.1.3.1.1">Stable Audio Open</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.3.1.2">34602.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.3.1.3">4227.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.3.1.4">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T4.1.3.1.5">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.3.1.6">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.3.1.7">7.42</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.3.1.8">38830.4</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T4.1.4.2.1">Base</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.4.2.2">18935.26</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.4.2.3">1198.21</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.4.2.4">14.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.1.4.2.5">20133.46</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.4.2.6">1775.73</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.4.2.7">96.38</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.4.2.8">21909.19</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T4.1.5.3.1">ASE</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.5.3.2">14584.85</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.5.3.3">1198.21</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.5.3.4">18.25</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.1.5.3.5">15783.05</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.5.3.6">1775.73</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.5.3.7">96.25</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.5.3.8">17558.78</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T4.1.6.4.1">Presto-L</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.6.4.2">14655.02</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.6.4.3">1198.21</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.6.4.4">18.17</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.1.6.4.5">15853.23</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.6.4.6">1775.73</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.6.4.7">96.25</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.6.4.8">17628.96</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T4.1.7.5.1">SoundCTM</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.7.5.2">1135.65</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.7.5.3">1198.21</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.7.5.4">123.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.1.7.5.5">2333.86</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.7.5.6">1775.73</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.7.5.7">92.98</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.7.5.8">4109.58</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T4.1.8.6.1">Presto-S</th>
<td class="ltx_td ltx_align_center" id="A1.T4.1.8.6.2">715.41</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.8.6.3">1198.21</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.8.6.4">150.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.1.8.6.5">1913.62</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.8.6.6">1775.73</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.8.6.7">92.18</td>
<td class="ltx_td ltx_align_center" id="A1.T4.1.8.6.8">3689.34</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A1.T4.1.9.7.1">Presto-LS</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.1.9.7.2">695.19</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.1.9.7.3">1198.21</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.1.9.7.4">152.11</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A1.T4.1.9.7.5">1893.4</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.1.9.7.6">1775.73</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.1.9.7.7">92.13</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.1.9.7.8">3669.13</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Latency (ms) and real-time factor for max batch size on an A100 40GB GPU.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.7 </span>Presto-L Design Ablation</h3>
<figure class="ltx_figure" id="A1.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="348" id="A1.F10.g1" src="x10.png" width="685"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span class="ltx_text ltx_font_bold" id="A1.F10.2.1">Presto-L</span> ablation. Each individual change of our layer distillation vs ASE is beneficial.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A1.SS7.p1">
<p class="ltx_p" id="A1.SS7.p1.1">To investigate how each facet of our <span class="ltx_text ltx_font_bold" id="A1.SS7.p1.1.1">Presto-L</span> method contributes to its strong performance vs. ASE, we ran an additional ablation combining ASE with each component (i.e. the shifted dropping schedule, explicit budget conditioning, and the self-teacher loss).
In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.F10" title="Figure 10 ‣ A.7 Presto-L Design Ablation ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">10</span></a>, we see that the core of <span class="ltx_text ltx_font_bold" id="A1.SS7.p1.1.2">Presto-L</span>’s improvements come from the shifted dropping schedule (which preserves final layer behavior), as the ASE+shift performs similarly to <span class="ltx_text ltx_font_bold" id="A1.SS7.p1.1.3">Presto-L</span> on high-step FAD and MMD. Additionally, we find that the budget conditioning and self-teacher loss help text relevance more so than the shifted schedule does. All together, the combination of <span class="ltx_text ltx_font_bold" id="A1.SS7.p1.1.4">Presto-L</span>’s design decisions leads to SOTA audio quality (FAD/MMD/Density) and text relevance compared to any one facet combined with ASE.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.8 </span>Discrete-Time Failure Modes</h3>
<div class="ltx_para ltx_noindent" id="A1.SS8.p1">
<p class="ltx_p" id="A1.SS8.p1.1">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#A1.F11" title="Figure 11 ‣ A.8 Discrete-Time Failure Modes ‣ Appendix A Appendix ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">11</span></a>, we visualize the poor performance of distilled models that use 1-2 step discrete-time conditioning signals. Notice that for the same random seed, the high-frequency performance is visually worse for discrete-time vs. continuous-time conditioning, motivating our proposed methods.</p>
</div>
<figure class="ltx_figure" id="A1.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="248" id="A1.F11.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Failure mode of 1-2 step discrete models vs. continuous models (each row is same random seed and text prompt), with 2-step generation. Hip-Hop adjacent generations noticeably drop high frequency information, and render percussive transients (hi-hats, snare drums) poorly.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS9">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.9 </span>Listening Test Results</h3>
<div class="ltx_para ltx_noindent" id="A1.SS9.p1">
<p class="ltx_p" id="A1.SS9.p1.1">We visualize our listening test results from Section <a class="ltx_ref" href="https://arxiv.org/html/2410.05167v1#S4.SS5" title="4.5 Listening Test ‣ 4 Experiments ‣ Presto! Distilling Steps and Layers for Accelerating Music Generation"><span class="ltx_text ltx_ref_tag">4.5</span></a> using a violin plot.</p>
</div>
<figure class="ltx_figure" id="A1.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="215" id="A1.F12.g1" src="x12.png" width="342"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Violin plot from our listening test. Presto-LS is preferred over other baselines (<math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="A1.F12.2.m1.1"><semantics id="A1.F12.2.m1.1b"><mrow id="A1.F12.2.m1.1.1" xref="A1.F12.2.m1.1.1.cmml"><mi id="A1.F12.2.m1.1.1.2" xref="A1.F12.2.m1.1.1.2.cmml">p</mi><mo id="A1.F12.2.m1.1.1.1" xref="A1.F12.2.m1.1.1.1.cmml">&lt;</mo><mn id="A1.F12.2.m1.1.1.3" xref="A1.F12.2.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F12.2.m1.1c"><apply id="A1.F12.2.m1.1.1.cmml" xref="A1.F12.2.m1.1.1"><lt id="A1.F12.2.m1.1.1.1.cmml" xref="A1.F12.2.m1.1.1.1"></lt><ci id="A1.F12.2.m1.1.1.2.cmml" xref="A1.F12.2.m1.1.1.2">𝑝</ci><cn id="A1.F12.2.m1.1.1.3.cmml" type="float" xref="A1.F12.2.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F12.2.m1.1d">p&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="A1.F12.2.m1.1e">italic_p &lt; 0.05</annotation></semantics></math>).</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS10">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.10 </span>Rejection Sampling Results</h3>
<div class="ltx_para" id="A1.SS10.p1">
<p class="ltx_p" id="A1.SS10.p1.1">We show rejection sampling results where we generate a batch during inference and then use CLAP to reject the <math alttext="r" class="ltx_Math" display="inline" id="A1.SS10.p1.1.m1.1"><semantics id="A1.SS10.p1.1.m1.1a"><mi id="A1.SS10.p1.1.m1.1.1" xref="A1.SS10.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A1.SS10.p1.1.m1.1b"><ci id="A1.SS10.p1.1.m1.1.1.cmml" xref="A1.SS10.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS10.p1.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="A1.SS10.p1.1.m1.1d">italic_r</annotation></semantics></math> least similar generations to the input text prompt. CLAP rejection sampling noticeably improves CLAP Score and maintains (and sometimes <em class="ltx_emph ltx_font_italic" id="A1.SS10.p1.1.1">improves</em>) FAD and MMD, but reduces diversity as expected.</p>
</div>
<figure class="ltx_figure" id="A1.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="170" id="A1.F13.g1" src="x13.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Rejection sampling eval metrics vs. rejection ratio. Base <span class="ltx_text ltx_font_bold" id="A1.F13.2.1">Presto-LS</span> in red. CLAP rejection sampling improves both CLAP score and overall quality, while reducing diversity.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Oct  7 16:16:06 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
