<!DOCTYPE html><html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Item Cluster-aware Prompt Learning for Session-based Recommendation</title>
<!--Generated on Mon Oct  7 05:12:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<meta content="Recommendation System,  Session-based Recommendation,  Community Detection,  Prompt Learning" lang="en" name="keywords">
<base href="https://arxiv.org/html/2410.04756v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.04756v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.04756v1/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.04756v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.04756v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S1" title="In Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S2" title="In Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S2.SS1" title="In 2. Related Works ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Session-based Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S2.SS2" title="In 2. Related Works ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Prompt Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3" title="In Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Proposed Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3.SS1" title="In 3. Proposed Method ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3.SS2" title="In 3. Proposed Method ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Item Relationship Mining</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3.SS2.SSS1" title="In 3.2. Item Relationship Mining ‣ 3. Proposed Method ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Graph Construction</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3.SS2.SSS1.Px1" title="In 3.2.1. Graph Construction ‣ 3.2. Item Relationship Mining ‣ 3. Proposed Method ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title">Session Graph Construction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3.SS2.SSS1.Px2" title="In 3.2.1. Graph Construction ‣ 3.2. Item Relationship Mining ‣ 3. Proposed Method ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title">Global Graph Construction</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3.SS2.SSS2" title="In 3.2. Item Relationship Mining ‣ 3. Proposed Method ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Item Cluster Detection</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3.SS3" title="In 3. Proposed Method ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Item Cluster-aware Prompt Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4" title="In Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS1" title="In 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS1.SSS1" title="In 4.1. Experimental Setup ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS1.SSS2" title="In 4.1. Experimental Setup ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS1.SSS3" title="In 4.1. Experimental Setup ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.3 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS1.SSS4" title="In 4.1. Experimental Setup ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.4 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS2" title="In 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS2.SSS1" title="In 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Overall Performance (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS2.SSS2" title="In 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Impact of <span class="ltx_text ltx_font_italic">Item Relationship Mining</span> (RQ2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS2.SSS3" title="In 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.3 </span>Impact of <span class="ltx_text ltx_font_italic">Item Cluster-aware Prompt Learning</span> (RQ3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS2.SSS4" title="In 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.4 </span>Impact of hyperparameter</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S5" title="In Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: arXiv.org perpetual non-exclusive license</a><div id="watermark-tr">arXiv:2410.04756v1 [cs.IR] 07 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Item Cluster-aware Prompt Learning for Session-based Recommendation</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wooseong Yang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">University of Illinois Chicago</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Chicago</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wyang73@uic.edu">wyang73@uic.edu</a>
</span></span></span>
<span class="ltx_author_before">,&nbsp;</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chen Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">University of Illinois Chicago</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Chicago</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:cwang266@uic.edu">cwang266@uic.edu</a>
</span></span></span>
<span class="ltx_author_before">,&nbsp;</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zihe Song
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">University of Illinois Chicago</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Chicago</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zsong29@uic.edu">zsong29@uic.edu</a>
</span></span></span>
<span class="ltx_author_before">,&nbsp;</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Weizhi Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">University of Illinois Chicago</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Chicago</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wzhan42@uic.edu">wzhan42@uic.edu</a>
</span></span></span>
<span class="ltx_author_before">&nbsp;and&nbsp;</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Philip S. Yu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">University of Illinois Chicago</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Chicago</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:psyu@uic.edu">psyu@uic.edu</a>
</span></span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_dates">(2018; 20 February 2007; 12 March 2009; 5 June 2009)</div>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id16.id1">Session-based recommendation (SBR) aims to capture dynamic user preferences by analyzing item sequences within individual sessions. However, most existing approaches focus mainly on intra-session item relationships, neglecting the connections between items across different sessions (inter-session relationships), which limits their ability to fully capture complex item interactions. While some methods incorporate inter-session information, they often suffer from high computational costs, leading to longer training times and reduced efficiency. To address these challenges, we propose the CLIP-SBR (Cluster-aware Item Prompt learning for Session-Based Recommendation) framework. CLIP-SBR is composed of two modules: 1) an item relationship mining module that builds a global graph to effectively model both intra- and inter-session relationships, and 2) an item cluster-aware prompt learning module that uses soft prompts to integrate these relationships into SBR models efficiently. We evaluate CLIP-SBR across eight SBR models and three benchmark datasets, consistently demonstrating improved recommendation performance and establishing CLIP-SBR as a robust solution for session-based recommendation tasks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_keywords">Recommendation System, Session-based Recommendation, Community Detection, Prompt Learning
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems&nbsp;Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Session-based recommendation (SBR) has gained increasing attention due to their effectiveness in various online services&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib30" title="">2021</a>)</cite>, such as e-commerce, social media, and music platforms. Unlike traditional recommendation systems that model long-term static user preferences, SBRs focus on short-term dynamic user preferences embedded within sessions, providing more timely and accurate recommendations. Deep learning-based approaches have recently driven significant advances in SBRs by utilizing their exceptional feature representation capabilities to improve the modeling of complex user preferences embedded in sessions. Specifically, recurrent neural networks (RNNs) have been used to capture sequential dependencies within sessions by processing item sequences in order <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib9" title="">2016</a>; Hidasi and Karatzoglou, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib8" title="">2018</a>)</cite>. Several studies employ attention mechanisms to enhance SBRs by selectively focusing on the most relevant items within a session, thereby capturing key patterns in user behavior <cite class="ltx_cite ltx_citemacro_citep">(Li et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib15" title="">2017</a>; Hou et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib10" title="">2022</a>)</cite>. Graph neural networks (GNNs) extend these capabilities by representing sessions as graphs, allowing the models to capture intricate relationships between items through graph structures <cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib33" title="">2019</a>; Yu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib36" title="">2020</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite the progress, most existing SBR approaches primarily focus on the sequential relations between items within a single session (<span class="ltx_text ltx_font_italic" id="S1.p2.1.1">intra-session</span> item relationship), often neglecting the valuable information available across multiple sessions (<span class="ltx_text ltx_font_italic" id="S1.p2.1.2">inter-session</span> item relationship). This significant <span class="ltx_text ltx_font_bold" id="S1.p2.1.3">limitation in inter-session modeling</span> has been identified and proven in multiple studies <cite class="ltx_cite ltx_citemacro_citep">(Ruocco et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib25" title="">2017</a>; Qiu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib23" title="">2020</a>; Wang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib31" title="">2023</a>; Li et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib17" title="">2023</a>)</cite> as a critical issue in SBRs, hindering the accurate learning of user preferences and potentially affecting recommendation performance. To illustrate, consider three sessions for different users: session one {AirPods Pro, AirPods, AirPods Max}, session two {AirPods, Galaxy Buds, Beats Fit Pro}, and session three {Nike Dri-FIT Running Shirt, Adidas Ultraboost, Beats Fit Pro}. When focusing solely on intra-session information, we can observe that the sessions contain Apple earphones, earbuds, and running gears in each session, respectively.
While the intra-session perspective provides immediate sequential insights, it struggles to capture more complex item relationships. For instance, the user of session three might also be interested in Airpods Pro instead of Beats Fit Pro, but it’s challenging for the model to identify this solely from intra-session data, as there are no common items between session one and session three. In contrast, inter-session information can discover the deeper connections by linking Beats Fit Pro across session two and three, and AirPods across session one and two, bridging the gap between session one and three.
This highlights the importance of inter-session information, as it enhances the understanding of user preferences beyond what intra-session information alone can achieve.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Although several SBRs attempt to incorporate inter-session item relationships and some have shown effectiveness, most still face <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">limitation in computational efficiency</span>. Specifically, GCSAN <cite class="ltx_cite ltx_citemacro_citep">(Xu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib35" title="">2019</a>)</cite> strives to utilize inter-session information but fails to fully model complex relationships between items, which limits its overall recommendation performance. In contrast, models like GCEGNN <cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib32" title="">2020</a>)</cite> and LESSR <cite class="ltx_cite ltx_citemacro_citep">(Chen and Wong, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib4" title="">2020</a>)</cite> demonstrate effectiveness in capturing inter-session item relationships. However, they are constrained by high computational complexity, leading to prolonged training times. These limitations underscore the need for a robust framework that can fully exploit complex item relationships across sessions while balancing both effectiveness and efficiency in SBRs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address the aforementioned challenges, we propose <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">CL</span>uster-aware <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">I</span>tem <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">P</span>rompt learning framework for <span class="ltx_text ltx_font_bold" id="S1.p4.1.4">S</span>ession-<span class="ltx_text ltx_font_bold" id="S1.p4.1.5">B</span>ased <span class="ltx_text ltx_font_bold" id="S1.p4.1.6">R</span>ecomm
<br class="ltx_break">endation (<span class="ltx_text ltx_font_bold" id="S1.p4.1.7">CLIP-SBR</span>) that captures complex item relationships and efficiently embeds the information into the SBR models. To overcome the <span class="ltx_text ltx_font_bold" id="S1.p4.1.8">limitation in inter-session modeling</span>, the first module, <span class="ltx_text ltx_font_italic" id="S1.p4.1.9">item relationship mining</span>, constructs a global graph from session data. This graph models both intra- and inter-session item relationships in a single structure. Prior studies <cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib33" title="">2019</a>; Xu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib35" title="">2019</a>; Yu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib36" title="">2020</a>; Wang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib32" title="">2020</a>; Chen and Wong, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib4" title="">2020</a>)</cite> have demonstrated the effectiveness of graph in capturing item relationships. Inspired by the approaches, the global graph represents items as nodes and item transitions as edges, allowing simultaneous modeling of relationships within and across sessions in one structure. Following graph construction, a community detection method <cite class="ltx_cite ltx_citemacro_citep">(Traag et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib29" title="">2019</a>)</cite> is used to identify item clusters that share similar user preferences. These clusters offer valuable insights, as items within the same cluster exhibit close relationships and similar user preferences.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To tackle the <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">limitation in computational efficiency</span>, which is the inefficiency of incorporating complex item relationships, we introduce the second module, <span class="ltx_text ltx_font_italic" id="S1.p5.1.2">item cluster-aware prompt learning</span>. they suffer from high computational complexity. This module enhances the learning capabilities of SBR models efficiently by integrating learnable soft prompts for each identified item cluster. Prompt learning <cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib18" title="">2023b</a>)</cite>, originally introduced in natural language processing, began as a way to provide large language models with task-related information through natural language instructions, known as prompts. The concept evolved into learnable prompts, with discrete natural language prompts termed <span class="ltx_text ltx_font_italic" id="S1.p5.1.3">hard prompt</span> and continuous, trainable prompts termed <span class="ltx_text ltx_font_italic" id="S1.p5.1.4">soft prompts</span>. Soft prompts have demonstrated significant success due to their ability to provide task-related cues to pre-trained models during the tuning phase <cite class="ltx_cite ltx_citemacro_citep">(Li and Liang, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib16" title="">2021</a>; Shin et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib26" title="">2020</a>; Lester et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib14" title="">2021</a>)</cite>. This approach has expanded to fields such as computer vision <cite class="ltx_cite ltx_citemacro_citep">(Jia et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib11" title="">2022</a>; Zhou et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib37" title="">2022</a>; Ge et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib6" title="">2023</a>)</cite> and graph representation learning <cite class="ltx_cite ltx_citemacro_citep">(Sun et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib27" title="">2022</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib28" title="">2023</a>; Liu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib20" title="">2023a</a>; Fang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib5" title="">2024</a>)</cite>, where soft prompts are used to deliver task-specific and data-related information during training. Notably, GPF <cite class="ltx_cite ltx_citemacro_citep">(Fang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib5" title="">2024</a>)</cite> and SUPT <cite class="ltx_cite ltx_citemacro_citep">(Lee et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib13" title="">2024</a>)</cite> have proven the ability of soft prompt to deliver data-related information during tuning process. Inspired by the previous studies, we adopt soft prompts to integrate mined item relationship information into SBR models during training. By tailoring learnable soft prompts to specific item cluster, SBR models can effectively and efficiently learn user preferences embedded in session data, capturing both intra- and inter-session relationships. This comprehensive approach not only enhances recommendation performance in an efficient way but also ensures adaptability, making the CLIP-SBR framework universal across various SBR models. We examine CLIP-SBR on eight SBR baselines and three benchmark.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">To summarize, the main contributions lie in:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a graph-based method with community detection to design and extract complex item relationships from session data.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a novel approach to enhance SBRs by incorporating item cluster-aware prompt into the model training phase.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">To the best of our knowledge, CLIP-SBR is the first attempt to adopt a soft prompt to the SBR. Also, it is the pioneer work to introduce a soft prompt directly in the model training.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We conduct extensive experiments on five representative SBRs and three benchmark datasets to demonstrate the superiority of the proposed CLIP-SBR framework.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Works</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Session-based Recommendation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Session-based Recommendation (SBR) predicts the next user interaction based on recent behavior sequences, effectively capturing short-term user preferences. Recent advancements in deep learning have significantly enhanced SBRs by enabling more sophisticated modeling of item transitions within sessions. GRU4Rec <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib9" title="">2016</a>)</cite> introduced Gated Recurrent Units (GRUs) for sequential dependency modeling, while models like NARM <cite class="ltx_cite ltx_citemacro_citep">(Li et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib15" title="">2017</a>)</cite> and STAMP <cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib19" title="">2018</a>)</cite> leverage attention mechanisms to capture user intent and preference. CORE <cite class="ltx_cite ltx_citemacro_citep">(Hou et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib10" title="">2022</a>)</cite> addresses prediction inconsistencies by unifying session and item embeddings, reducing representation gaps. Graph neural networks (GNNs) have further improved SBRs by representing session sequences as graphs, as seen in SRGNN <cite class="ltx_cite ltx_citemacro_citep">(Xu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib35" title="">2019</a>)</cite>, which aggregates item information through gated GNNs, TAGNN <cite class="ltx_cite ltx_citemacro_citep">(Yu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib36" title="">2020</a>)</cite> which employs target-aware attention to incorporate user interests. While these methods effectively model intra-session relationships, they often overlook the valuable inter-session information, limiting their ability to fully understand complex user behaviors. To address this, several inter-session SBRs have been proposed. GCSAN <cite class="ltx_cite ltx_citemacro_citep">(Xu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib35" title="">2019</a>)</cite> uses self-attention on session graphs to capture intricate item relationships, while GCEGNN <cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib32" title="">2020</a>)</cite> combines item-level and session-level information using graph convolution and self-attention mechanisms. LESSR <cite class="ltx_cite ltx_citemacro_citep">(Chen and Wong, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib4" title="">2020</a>)</cite> introduces an edge-order preserving aggregation scheme and a shortcut graph attention layer to effectively capture global item relationships. Despite their effectiveness, they either inadequately capture inter-session information (GCSAN) or are computationally intensive (GCEGNN, LESSR). Our work proposes incorporating both intra- and inter-session item relationships using efficient cluster-aware prompts to enhance SBR performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Prompt Learning</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Prompt learning is initially introduced in natural language processing (NLP) as a novel method to guide pre-trained language models in performing specific tasks by providing task-related information <cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib18" title="">2023b</a>)</cite>. It originated with the use of discrete hard prompts: text-based instructions designed to provide task related information to pre-trained models <cite class="ltx_cite ltx_citemacro_citep">(Brown, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib3" title="">2020</a>)</cite>. However, due to the limitations of hard prompts that requires human intervention and limited adaptability, the concept has evolved to include continuous soft prompts. Soft prompts are learnable vectors that do not directly correspond to natural language but are optimized during training to enhance model performance on a given task <cite class="ltx_cite ltx_citemacro_citep">(Li and Liang, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib16" title="">2021</a>; Shin et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib26" title="">2020</a>; Lester et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib14" title="">2021</a>)</cite>. In recent years, the effectiveness of soft prompts has been demonstrated beyond NLP, extending to domains such as computer vision (CV) and graph representation learning. In the CV field, visual soft prompts have been well-studied and shown great potential in cross-task generalization, domain adaptation, and visual-language models <cite class="ltx_cite ltx_citemacro_citep">(Ge et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib6" title="">2023</a>; Zhou et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib37" title="">2022</a>; Jia et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib11" title="">2022</a>)</cite>. Similarly, in the graph field, pioneering works <cite class="ltx_cite ltx_citemacro_citep">(Sun et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib27" title="">2022</a>; Liu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib20" title="">2023a</a>)</cite> align task-specific soft prompts and downstream tasks, such as link prediction. GPF <cite class="ltx_cite ltx_citemacro_citep">(Fang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib5" title="">2024</a>)</cite> and SUPT <cite class="ltx_cite ltx_citemacro_citep">(Lee et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib13" title="">2024</a>)</cite> further enhance by introducing soft prompts to every node, therby providing graph data-related information in tuning phase, enabling better model adaptation to complex graph structures and tasks. As a result, prompt learning has emerged as a versatile tool that can efficiently improve task performance by providing task- or data-related information across various fields.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S2.F1">
<br class="ltx_break">
<p class="ltx_p ltx_align_center ltx_align_center" id="S2.F1.1.1"><span class="ltx_text" id="S2.F1.1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="439" id="S2.F1.1.1.1.g1" src="https://arxiv.org/html/2410.04756v1/x1.png" width="830"></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>The proposed CLIP-SBR framework consists of two main modules. The <span class="ltx_text ltx_font_italic" id="S2.F1.4.1">Item Relationship Mining</span> module constructs session graphs and combines them into a global graph to capture intra- and inter-session item relationships, followed by community detection to identify item clusters. The <span class="ltx_text ltx_font_italic" id="S2.F1.5.2">Item Cluster-aware Prompt Learning</span> module enhances SBR models by integrating learnable soft prompts tailored to these clusters, embedding cluster-specific information to improve recommendation accuracy and efficiency.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Proposed Method</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The CLIP-SBR aims to exploit both intra- and inter-session item relationships to effectively model the user preferences embedded in sessions and enhance existing SBRs with the information. Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S2.F1" title="Figure 1 ‣ 2.2. Prompt Learning ‣ 2. Related Works ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> presents the overall flow of CLIP-SBR, which comprises two main components: 1) <span class="ltx_text ltx_font_italic" id="S3.p1.1.1">Item Relationship Mining</span>. This component constructs a graph structure from session data to model item relationships with sufficient depth. It then identifies item clusters based on sequential dpendencies by employing existing community detection method. 2) <span class="ltx_text ltx_font_italic" id="S3.p1.1.2">Item Cluster-aware Prompt Learning</span>. This component integrates learnable prompt vectors into item embeddings before they are fed into SBR models. The prompt vectors provide SBR models with information about item clusters during training. In this chapter, we first present the problem statement and then introduce the components of CLIP-SBR in detail.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Problem Statement</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.16">Session-based recommendation aims to predict the next item a user will interact with, based on the current session. Let <math alttext="\mathcal{V}=\{v_{1},v_{2}\cdots,v_{\mid\mathcal{V}\mid}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.4"><semantics id="S3.SS1.p1.1.m1.4a"><mrow id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.4.4.5" xref="S3.SS1.p1.1.m1.4.4.5.cmml">𝒱</mi><mo id="S3.SS1.p1.1.m1.4.4.4" xref="S3.SS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.4.4.3.3" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml"><mo id="S3.SS1.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml">v</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.5" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mrow id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml"><msub id="S3.SS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.cmml">v</mi><mn id="S3.SS1.p1.1.m1.3.3.2.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.1.m1.3.3.2.2.2.1" xref="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.3" mathvariant="normal" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">⋯</mi></mrow><mo id="S3.SS1.p1.1.m1.4.4.3.3.6" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.4.4.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.2" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml">v</mi><mrow id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.2.cmml"><mo fence="true" id="S3.SS1.p1.1.m1.1.1.1.3.1" rspace="0em" xref="S3.SS1.p1.1.m1.1.1.1.2.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml">𝒱</mi><mo fence="true" id="S3.SS1.p1.1.m1.1.1.1.3.2" lspace="0em" xref="S3.SS1.p1.1.m1.1.1.1.2.1.cmml">∣</mo></mrow></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.7" stretchy="false" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.4b"><apply id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4"><eq id="S3.SS1.p1.1.m1.4.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4.4"></eq><ci id="S3.SS1.p1.1.m1.4.4.5.cmml" xref="S3.SS1.p1.1.m1.4.4.5">𝒱</ci><set id="S3.SS1.p1.1.m1.4.4.3.4.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2">𝑣</ci><cn id="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><times id="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.1"></times><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2">𝑣</ci><cn id="S3.SS1.p1.1.m1.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3">⋯</ci></apply><apply id="S3.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2">𝑣</ci><apply id="S3.SS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3.1">delimited-∣∣</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">𝒱</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.4c">\mathcal{V}=\{v_{1},v_{2}\cdots,v_{\mid\mathcal{V}\mid}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.4d">caligraphic_V = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⋯ , italic_v start_POSTSUBSCRIPT ∣ caligraphic_V ∣ end_POSTSUBSCRIPT }</annotation></semantics></math> represent the set of all unique items across sessions, where <math alttext="v_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">v</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑣</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">v_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> represents the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_k</annotation></semantics></math>-th item (<math alttext="1\leq k\leq\mid\mathcal{V}\mid" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.2" xref="S3.SS1.p1.4.m4.1.2.cmml"><mn id="S3.SS1.p1.4.m4.1.2.2" xref="S3.SS1.p1.4.m4.1.2.2.cmml">1</mn><mo id="S3.SS1.p1.4.m4.1.2.3" xref="S3.SS1.p1.4.m4.1.2.3.cmml">≤</mo><mi id="S3.SS1.p1.4.m4.1.2.4" xref="S3.SS1.p1.4.m4.1.2.4.cmml">k</mi><mo id="S3.SS1.p1.4.m4.1.2.5" rspace="0.1389em" xref="S3.SS1.p1.4.m4.1.2.5.cmml">≤</mo><mrow id="S3.SS1.p1.4.m4.1.2.6.2" xref="S3.SS1.p1.4.m4.1.2.6.1.cmml"><mo fence="true" id="S3.SS1.p1.4.m4.1.2.6.2.1" lspace="0.1389em" rspace="0em" xref="S3.SS1.p1.4.m4.1.2.6.1.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">𝒱</mi><mo fence="true" id="S3.SS1.p1.4.m4.1.2.6.2.2" lspace="0em" xref="S3.SS1.p1.4.m4.1.2.6.1.1.cmml">∣</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.2.cmml" xref="S3.SS1.p1.4.m4.1.2"><and id="S3.SS1.p1.4.m4.1.2a.cmml" xref="S3.SS1.p1.4.m4.1.2"></and><apply id="S3.SS1.p1.4.m4.1.2b.cmml" xref="S3.SS1.p1.4.m4.1.2"><leq id="S3.SS1.p1.4.m4.1.2.3.cmml" xref="S3.SS1.p1.4.m4.1.2.3"></leq><cn id="S3.SS1.p1.4.m4.1.2.2.cmml" type="integer" xref="S3.SS1.p1.4.m4.1.2.2">1</cn><ci id="S3.SS1.p1.4.m4.1.2.4.cmml" xref="S3.SS1.p1.4.m4.1.2.4">𝑘</ci></apply><apply id="S3.SS1.p1.4.m4.1.2c.cmml" xref="S3.SS1.p1.4.m4.1.2"><leq id="S3.SS1.p1.4.m4.1.2.5.cmml" xref="S3.SS1.p1.4.m4.1.2.5"></leq><share href="https://arxiv.org/html/2410.04756v1#S3.SS1.p1.4.m4.1.2.4.cmml" id="S3.SS1.p1.4.m4.1.2d.cmml" xref="S3.SS1.p1.4.m4.1.2"></share><apply id="S3.SS1.p1.4.m4.1.2.6.1.cmml" xref="S3.SS1.p1.4.m4.1.2.6.2"><csymbol cd="latexml" id="S3.SS1.p1.4.m4.1.2.6.1.1.cmml" xref="S3.SS1.p1.4.m4.1.2.6.2.1">delimited-∣∣</csymbol><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝒱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">1\leq k\leq\mid\mathcal{V}\mid</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">1 ≤ italic_k ≤ ∣ caligraphic_V ∣</annotation></semantics></math>) in the sequence. We define a session set <math alttext="\mathcal{S}=\{\mathcal{S}_{1},\mathcal{S}_{2},\cdots,\mathcal{S}_{\mid\mathcal%
{S}\mid}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.5"><semantics id="S3.SS1.p1.5.m5.5a"><mrow id="S3.SS1.p1.5.m5.5.5" xref="S3.SS1.p1.5.m5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.5.5.5" xref="S3.SS1.p1.5.m5.5.5.5.cmml">𝒮</mi><mo id="S3.SS1.p1.5.m5.5.5.4" xref="S3.SS1.p1.5.m5.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.5.m5.5.5.3.3" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml"><mo id="S3.SS1.p1.5.m5.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">{</mo><msub id="S3.SS1.p1.5.m5.3.3.1.1.1" xref="S3.SS1.p1.5.m5.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.3.3.1.1.1.2" xref="S3.SS1.p1.5.m5.3.3.1.1.1.2.cmml">𝒮</mi><mn id="S3.SS1.p1.5.m5.3.3.1.1.1.3" xref="S3.SS1.p1.5.m5.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.5.m5.5.5.3.3.5" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.5.m5.4.4.2.2.2" xref="S3.SS1.p1.5.m5.4.4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.4.4.2.2.2.2" xref="S3.SS1.p1.5.m5.4.4.2.2.2.2.cmml">𝒮</mi><mn id="S3.SS1.p1.5.m5.4.4.2.2.2.3" xref="S3.SS1.p1.5.m5.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.5.m5.5.5.3.3.6" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.5.m5.2.2" mathvariant="normal" xref="S3.SS1.p1.5.m5.2.2.cmml">⋯</mi><mo id="S3.SS1.p1.5.m5.5.5.3.3.7" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.5.m5.5.5.3.3.3" xref="S3.SS1.p1.5.m5.5.5.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.5.5.3.3.3.2" xref="S3.SS1.p1.5.m5.5.5.3.3.3.2.cmml">𝒮</mi><mrow id="S3.SS1.p1.5.m5.1.1.1.3" xref="S3.SS1.p1.5.m5.1.1.1.2.cmml"><mo fence="true" id="S3.SS1.p1.5.m5.1.1.1.3.1" rspace="0em" xref="S3.SS1.p1.5.m5.1.1.1.2.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.1.cmml">𝒮</mi><mo fence="true" id="S3.SS1.p1.5.m5.1.1.1.3.2" lspace="0em" xref="S3.SS1.p1.5.m5.1.1.1.2.1.cmml">∣</mo></mrow></msub><mo id="S3.SS1.p1.5.m5.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.5b"><apply id="S3.SS1.p1.5.m5.5.5.cmml" xref="S3.SS1.p1.5.m5.5.5"><eq id="S3.SS1.p1.5.m5.5.5.4.cmml" xref="S3.SS1.p1.5.m5.5.5.4"></eq><ci id="S3.SS1.p1.5.m5.5.5.5.cmml" xref="S3.SS1.p1.5.m5.5.5.5">𝒮</ci><set id="S3.SS1.p1.5.m5.5.5.3.4.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3"><apply id="S3.SS1.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1.2">𝒮</ci><cn id="S3.SS1.p1.5.m5.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.5.m5.4.4.2.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2.2">𝒮</ci><cn id="S3.SS1.p1.5.m5.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.5.m5.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2">⋯</ci><apply id="S3.SS1.p1.5.m5.5.5.3.3.3.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3.2">𝒮</ci><apply id="S3.SS1.p1.5.m5.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p1.5.m5.1.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.3.1">delimited-∣∣</csymbol><ci id="S3.SS1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1">𝒮</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.5c">\mathcal{S}=\{\mathcal{S}_{1},\mathcal{S}_{2},\cdots,\mathcal{S}_{\mid\mathcal%
{S}\mid}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.5d">caligraphic_S = { caligraphic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_S start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , caligraphic_S start_POSTSUBSCRIPT ∣ caligraphic_S ∣ end_POSTSUBSCRIPT }</annotation></semantics></math> and we denote the <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_t</annotation></semantics></math>-th session (<math alttext="1\leq t\leq\mid\mathcal{S}\mid" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.2" xref="S3.SS1.p1.7.m7.1.2.cmml"><mn id="S3.SS1.p1.7.m7.1.2.2" xref="S3.SS1.p1.7.m7.1.2.2.cmml">1</mn><mo id="S3.SS1.p1.7.m7.1.2.3" xref="S3.SS1.p1.7.m7.1.2.3.cmml">≤</mo><mi id="S3.SS1.p1.7.m7.1.2.4" xref="S3.SS1.p1.7.m7.1.2.4.cmml">t</mi><mo id="S3.SS1.p1.7.m7.1.2.5" rspace="0.1389em" xref="S3.SS1.p1.7.m7.1.2.5.cmml">≤</mo><mrow id="S3.SS1.p1.7.m7.1.2.6.2" xref="S3.SS1.p1.7.m7.1.2.6.1.cmml"><mo fence="true" id="S3.SS1.p1.7.m7.1.2.6.2.1" lspace="0.1389em" rspace="0em" xref="S3.SS1.p1.7.m7.1.2.6.1.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">𝒮</mi><mo fence="true" id="S3.SS1.p1.7.m7.1.2.6.2.2" lspace="0em" xref="S3.SS1.p1.7.m7.1.2.6.1.1.cmml">∣</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.2.cmml" xref="S3.SS1.p1.7.m7.1.2"><and id="S3.SS1.p1.7.m7.1.2a.cmml" xref="S3.SS1.p1.7.m7.1.2"></and><apply id="S3.SS1.p1.7.m7.1.2b.cmml" xref="S3.SS1.p1.7.m7.1.2"><leq id="S3.SS1.p1.7.m7.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.2.3"></leq><cn id="S3.SS1.p1.7.m7.1.2.2.cmml" type="integer" xref="S3.SS1.p1.7.m7.1.2.2">1</cn><ci id="S3.SS1.p1.7.m7.1.2.4.cmml" xref="S3.SS1.p1.7.m7.1.2.4">𝑡</ci></apply><apply id="S3.SS1.p1.7.m7.1.2c.cmml" xref="S3.SS1.p1.7.m7.1.2"><leq id="S3.SS1.p1.7.m7.1.2.5.cmml" xref="S3.SS1.p1.7.m7.1.2.5"></leq><share href="https://arxiv.org/html/2410.04756v1#S3.SS1.p1.7.m7.1.2.4.cmml" id="S3.SS1.p1.7.m7.1.2d.cmml" xref="S3.SS1.p1.7.m7.1.2"></share><apply id="S3.SS1.p1.7.m7.1.2.6.1.cmml" xref="S3.SS1.p1.7.m7.1.2.6.2"><csymbol cd="latexml" id="S3.SS1.p1.7.m7.1.2.6.1.1.cmml" xref="S3.SS1.p1.7.m7.1.2.6.2.1">delimited-∣∣</csymbol><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝒮</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">1\leq t\leq\mid\mathcal{S}\mid</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">1 ≤ italic_t ≤ ∣ caligraphic_S ∣</annotation></semantics></math>) as <math alttext="\mathcal{S}_{t}=\{v^{t}_{1},v^{t}_{2},\cdots,v^{t}_{\mid\mathcal{S}_{t}\mid}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.5"><semantics id="S3.SS1.p1.8.m8.5a"><mrow id="S3.SS1.p1.8.m8.5.5" xref="S3.SS1.p1.8.m8.5.5.cmml"><msub id="S3.SS1.p1.8.m8.5.5.5" xref="S3.SS1.p1.8.m8.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.5.5.5.2" xref="S3.SS1.p1.8.m8.5.5.5.2.cmml">𝒮</mi><mi id="S3.SS1.p1.8.m8.5.5.5.3" xref="S3.SS1.p1.8.m8.5.5.5.3.cmml">t</mi></msub><mo id="S3.SS1.p1.8.m8.5.5.4" xref="S3.SS1.p1.8.m8.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.8.m8.5.5.3.3" xref="S3.SS1.p1.8.m8.5.5.3.4.cmml"><mo id="S3.SS1.p1.8.m8.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.8.m8.5.5.3.4.cmml">{</mo><msubsup id="S3.SS1.p1.8.m8.3.3.1.1.1" xref="S3.SS1.p1.8.m8.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.8.m8.3.3.1.1.1.2.2" xref="S3.SS1.p1.8.m8.3.3.1.1.1.2.2.cmml">v</mi><mn id="S3.SS1.p1.8.m8.3.3.1.1.1.3" xref="S3.SS1.p1.8.m8.3.3.1.1.1.3.cmml">1</mn><mi id="S3.SS1.p1.8.m8.3.3.1.1.1.2.3" xref="S3.SS1.p1.8.m8.3.3.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.SS1.p1.8.m8.5.5.3.3.5" xref="S3.SS1.p1.8.m8.5.5.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.8.m8.4.4.2.2.2" xref="S3.SS1.p1.8.m8.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml">v</mi><mn id="S3.SS1.p1.8.m8.4.4.2.2.2.3" xref="S3.SS1.p1.8.m8.4.4.2.2.2.3.cmml">2</mn><mi id="S3.SS1.p1.8.m8.4.4.2.2.2.2.3" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS1.p1.8.m8.5.5.3.3.6" xref="S3.SS1.p1.8.m8.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.8.m8.2.2" mathvariant="normal" xref="S3.SS1.p1.8.m8.2.2.cmml">⋯</mi><mo id="S3.SS1.p1.8.m8.5.5.3.3.7" xref="S3.SS1.p1.8.m8.5.5.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.8.m8.5.5.3.3.3" xref="S3.SS1.p1.8.m8.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.8.m8.5.5.3.3.3.2.2" xref="S3.SS1.p1.8.m8.5.5.3.3.3.2.2.cmml">v</mi><mrow id="S3.SS1.p1.8.m8.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.2.cmml"><mo fence="true" id="S3.SS1.p1.8.m8.1.1.1.1.2" rspace="0em" xref="S3.SS1.p1.8.m8.1.1.1.2.1.cmml">∣</mo><msub id="S3.SS1.p1.8.m8.1.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.1.1.1.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml">t</mi></msub><mo fence="true" id="S3.SS1.p1.8.m8.1.1.1.1.3" lspace="0em" xref="S3.SS1.p1.8.m8.1.1.1.2.1.cmml">∣</mo></mrow><mi id="S3.SS1.p1.8.m8.5.5.3.3.3.2.3" xref="S3.SS1.p1.8.m8.5.5.3.3.3.2.3.cmml">t</mi></msubsup><mo id="S3.SS1.p1.8.m8.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.8.m8.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.5b"><apply id="S3.SS1.p1.8.m8.5.5.cmml" xref="S3.SS1.p1.8.m8.5.5"><eq id="S3.SS1.p1.8.m8.5.5.4.cmml" xref="S3.SS1.p1.8.m8.5.5.4"></eq><apply id="S3.SS1.p1.8.m8.5.5.5.cmml" xref="S3.SS1.p1.8.m8.5.5.5"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.5.5.5.1.cmml" xref="S3.SS1.p1.8.m8.5.5.5">subscript</csymbol><ci id="S3.SS1.p1.8.m8.5.5.5.2.cmml" xref="S3.SS1.p1.8.m8.5.5.5.2">𝒮</ci><ci id="S3.SS1.p1.8.m8.5.5.5.3.cmml" xref="S3.SS1.p1.8.m8.5.5.5.3">𝑡</ci></apply><set id="S3.SS1.p1.8.m8.5.5.3.4.cmml" xref="S3.SS1.p1.8.m8.5.5.3.3"><apply id="S3.SS1.p1.8.m8.3.3.1.1.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1">subscript</csymbol><apply id="S3.SS1.p1.8.m8.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.3.3.1.1.1.2.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.8.m8.3.3.1.1.1.2.2.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.2.2">𝑣</ci><ci id="S3.SS1.p1.8.m8.3.3.1.1.1.2.3.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.2.3">𝑡</ci></apply><cn id="S3.SS1.p1.8.m8.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.8.m8.4.4.2.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2">subscript</csymbol><apply id="S3.SS1.p1.8.m8.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2">𝑣</ci><ci id="S3.SS1.p1.8.m8.4.4.2.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.3">𝑡</ci></apply><cn id="S3.SS1.p1.8.m8.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.8.m8.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2">⋯</ci><apply id="S3.SS1.p1.8.m8.5.5.3.3.3.cmml" xref="S3.SS1.p1.8.m8.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.8.m8.5.5.3.3.3">subscript</csymbol><apply id="S3.SS1.p1.8.m8.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.8.m8.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.5.5.3.3.3.2.1.cmml" xref="S3.SS1.p1.8.m8.5.5.3.3.3">superscript</csymbol><ci id="S3.SS1.p1.8.m8.5.5.3.3.3.2.2.cmml" xref="S3.SS1.p1.8.m8.5.5.3.3.3.2.2">𝑣</ci><ci id="S3.SS1.p1.8.m8.5.5.3.3.3.2.3.cmml" xref="S3.SS1.p1.8.m8.5.5.3.3.3.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.8.m8.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.8.m8.1.1.1.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.2">delimited-∣∣</csymbol><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2">𝒮</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.5c">\mathcal{S}_{t}=\{v^{t}_{1},v^{t}_{2},\cdots,v^{t}_{\mid\mathcal{S}_{t}\mid}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.5d">caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = { italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∣ caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="v^{t}_{l}\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><msubsup id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2.2.2" xref="S3.SS1.p1.9.m9.1.1.2.2.2.cmml">v</mi><mi id="S3.SS1.p1.9.m9.1.1.2.3" xref="S3.SS1.p1.9.m9.1.1.2.3.cmml">l</mi><mi id="S3.SS1.p1.9.m9.1.1.2.2.3" xref="S3.SS1.p1.9.m9.1.1.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS1.p1.9.m9.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><in id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1"></in><apply id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.2">subscript</csymbol><apply id="S3.SS1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.2.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2.2.2">𝑣</ci><ci id="S3.SS1.p1.9.m9.1.1.2.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.2.3">𝑙</ci></apply><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">v^{t}_{l}\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ caligraphic_V</annotation></semantics></math> is the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_l</annotation></semantics></math>-th interacted item (<math alttext="1\leq l\leq\mid\mathcal{S}_{t}\mid" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><mrow id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mn id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">1</mn><mo id="S3.SS1.p1.11.m11.1.1.4" xref="S3.SS1.p1.11.m11.1.1.4.cmml">≤</mo><mi id="S3.SS1.p1.11.m11.1.1.5" xref="S3.SS1.p1.11.m11.1.1.5.cmml">l</mi><mo id="S3.SS1.p1.11.m11.1.1.6" rspace="0.1389em" xref="S3.SS1.p1.11.m11.1.1.6.cmml">≤</mo><mrow id="S3.SS1.p1.11.m11.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.2.cmml"><mo fence="true" id="S3.SS1.p1.11.m11.1.1.1.1.2" lspace="0.1389em" rspace="0em" xref="S3.SS1.p1.11.m11.1.1.1.2.1.cmml">∣</mo><msub id="S3.SS1.p1.11.m11.1.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.11.m11.1.1.1.1.1.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.SS1.p1.11.m11.1.1.1.1.1.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.3.cmml">t</mi></msub><mo fence="true" id="S3.SS1.p1.11.m11.1.1.1.1.3" lspace="0em" xref="S3.SS1.p1.11.m11.1.1.1.2.1.cmml">∣</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><and id="S3.SS1.p1.11.m11.1.1a.cmml" xref="S3.SS1.p1.11.m11.1.1"></and><apply id="S3.SS1.p1.11.m11.1.1b.cmml" xref="S3.SS1.p1.11.m11.1.1"><leq id="S3.SS1.p1.11.m11.1.1.4.cmml" xref="S3.SS1.p1.11.m11.1.1.4"></leq><cn id="S3.SS1.p1.11.m11.1.1.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.1.1.3">1</cn><ci id="S3.SS1.p1.11.m11.1.1.5.cmml" xref="S3.SS1.p1.11.m11.1.1.5">𝑙</ci></apply><apply id="S3.SS1.p1.11.m11.1.1c.cmml" xref="S3.SS1.p1.11.m11.1.1"><leq id="S3.SS1.p1.11.m11.1.1.6.cmml" xref="S3.SS1.p1.11.m11.1.1.6"></leq><share href="https://arxiv.org/html/2410.04756v1#S3.SS1.p1.11.m11.1.1.5.cmml" id="S3.SS1.p1.11.m11.1.1d.cmml" xref="S3.SS1.p1.11.m11.1.1"></share><apply id="S3.SS1.p1.11.m11.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.11.m11.1.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.2">delimited-∣∣</csymbol><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.2">𝒮</ci><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">1\leq l\leq\mid\mathcal{S}_{t}\mid</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">1 ≤ italic_l ≤ ∣ caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣</annotation></semantics></math>) in <math alttext="\mathcal{S}_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><msub id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">𝒮</mi><mi id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">𝒮</ci><ci id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\mathcal{S}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The objective of session-based recommendation is to predict the top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><mi id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><ci id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_K</annotation></semantics></math> items (<math alttext="1\leq K\leq|V|" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><mrow id="S3.SS1.p1.14.m14.1.2" xref="S3.SS1.p1.14.m14.1.2.cmml"><mn id="S3.SS1.p1.14.m14.1.2.2" xref="S3.SS1.p1.14.m14.1.2.2.cmml">1</mn><mo id="S3.SS1.p1.14.m14.1.2.3" xref="S3.SS1.p1.14.m14.1.2.3.cmml">≤</mo><mi id="S3.SS1.p1.14.m14.1.2.4" xref="S3.SS1.p1.14.m14.1.2.4.cmml">K</mi><mo id="S3.SS1.p1.14.m14.1.2.5" xref="S3.SS1.p1.14.m14.1.2.5.cmml">≤</mo><mrow id="S3.SS1.p1.14.m14.1.2.6.2" xref="S3.SS1.p1.14.m14.1.2.6.1.cmml"><mo id="S3.SS1.p1.14.m14.1.2.6.2.1" stretchy="false" xref="S3.SS1.p1.14.m14.1.2.6.1.1.cmml">|</mo><mi id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml">V</mi><mo id="S3.SS1.p1.14.m14.1.2.6.2.2" stretchy="false" xref="S3.SS1.p1.14.m14.1.2.6.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.2.cmml" xref="S3.SS1.p1.14.m14.1.2"><and id="S3.SS1.p1.14.m14.1.2a.cmml" xref="S3.SS1.p1.14.m14.1.2"></and><apply id="S3.SS1.p1.14.m14.1.2b.cmml" xref="S3.SS1.p1.14.m14.1.2"><leq id="S3.SS1.p1.14.m14.1.2.3.cmml" xref="S3.SS1.p1.14.m14.1.2.3"></leq><cn id="S3.SS1.p1.14.m14.1.2.2.cmml" type="integer" xref="S3.SS1.p1.14.m14.1.2.2">1</cn><ci id="S3.SS1.p1.14.m14.1.2.4.cmml" xref="S3.SS1.p1.14.m14.1.2.4">𝐾</ci></apply><apply id="S3.SS1.p1.14.m14.1.2c.cmml" xref="S3.SS1.p1.14.m14.1.2"><leq id="S3.SS1.p1.14.m14.1.2.5.cmml" xref="S3.SS1.p1.14.m14.1.2.5"></leq><share href="https://arxiv.org/html/2410.04756v1#S3.SS1.p1.14.m14.1.2.4.cmml" id="S3.SS1.p1.14.m14.1.2d.cmml" xref="S3.SS1.p1.14.m14.1.2"></share><apply id="S3.SS1.p1.14.m14.1.2.6.1.cmml" xref="S3.SS1.p1.14.m14.1.2.6.2"><abs id="S3.SS1.p1.14.m14.1.2.6.1.1.cmml" xref="S3.SS1.p1.14.m14.1.2.6.2.1"></abs><ci id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">1\leq K\leq|V|</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">1 ≤ italic_K ≤ | italic_V |</annotation></semantics></math>) that the user is most likely to interact with next. This translates into forcasting the <math alttext="({\mid\mathcal{S}_{t}\mid}+1)" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><mrow id="S3.SS1.p1.15.m15.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.cmml"><mo id="S3.SS1.p1.15.m15.1.1.1.2" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.15.m15.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.cmml"><mrow id="S3.SS1.p1.15.m15.1.1.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.cmml"><mo fence="true" id="S3.SS1.p1.15.m15.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.1.cmml">∣</mo><msub id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo fence="true" id="S3.SS1.p1.15.m15.1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="S3.SS1.p1.15.m15.1.1.1.1.1.2.1.cmml">∣</mo></mrow><mo id="S3.SS1.p1.15.m15.1.1.1.1.2" xref="S3.SS1.p1.15.m15.1.1.1.1.2.cmml">+</mo><mn id="S3.SS1.p1.15.m15.1.1.1.1.3" xref="S3.SS1.p1.15.m15.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.15.m15.1.1.1.3" stretchy="false" xref="S3.SS1.p1.15.m15.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1"><plus id="S3.SS1.p1.15.m15.1.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.2"></plus><apply id="S3.SS1.p1.15.m15.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.15.m15.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.2">delimited-∣∣</csymbol><apply id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.2">𝒮</ci><ci id="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><cn id="S3.SS1.p1.15.m15.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.15.m15.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">({\mid\mathcal{S}_{t}\mid}+1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">( ∣ caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ + 1 )</annotation></semantics></math>-th item based on the first <math alttext="{\mid\mathcal{S}_{t}\mid}" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m16.1"><semantics id="S3.SS1.p1.16.m16.1a"><mrow id="S3.SS1.p1.16.m16.1.1.1" xref="S3.SS1.p1.16.m16.1.1.2.cmml"><mo fence="true" id="S3.SS1.p1.16.m16.1.1.1.2" rspace="0em" xref="S3.SS1.p1.16.m16.1.1.2.1.cmml">∣</mo><msub id="S3.SS1.p1.16.m16.1.1.1.1" xref="S3.SS1.p1.16.m16.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.16.m16.1.1.1.1.2" xref="S3.SS1.p1.16.m16.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.SS1.p1.16.m16.1.1.1.1.3" xref="S3.SS1.p1.16.m16.1.1.1.1.3.cmml">t</mi></msub><mo fence="true" id="S3.SS1.p1.16.m16.1.1.1.3" lspace="0em" xref="S3.SS1.p1.16.m16.1.1.2.1.cmml">∣</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><apply id="S3.SS1.p1.16.m16.1.1.2.cmml" xref="S3.SS1.p1.16.m16.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.16.m16.1.1.2.1.cmml" xref="S3.SS1.p1.16.m16.1.1.1.2">delimited-∣∣</csymbol><apply id="S3.SS1.p1.16.m16.1.1.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.1.1.1.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.16.m16.1.1.1.1.2.cmml" xref="S3.SS1.p1.16.m16.1.1.1.1.2">𝒮</ci><ci id="S3.SS1.p1.16.m16.1.1.1.1.3.cmml" xref="S3.SS1.p1.16.m16.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">{\mid\mathcal{S}_{t}\mid}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m16.1d">∣ caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣</annotation></semantics></math> items in the session.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Item Relationship Mining</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">As the first module of the CLIP-SBR framework, <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.1.1">Item Relationship Mining</span> captures complex relationships between items in sessions using a graph-based approach that models both intra- and inter-session item relationships, inspired by prior SBR studies <cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib33" title="">2019</a>; Xu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib35" title="">2019</a>; Yu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib36" title="">2020</a>; Wang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib32" title="">2020</a>; Chen and Wong, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib4" title="">2020</a>)</cite>. We first construct session graphs to capture sequential dependencies within individual sessions. To incorporate inter-session relationships, we create a global graph by connecting item nodes if they are linked in any session graph, enabling a unified view of both intra- and inter-session dynamics. By applying a community detection algorithm to this global graph, we identify item clusters—groups of items with strong interconnections and shared user preferences. This clustering step is crucial for uncovering latent patterns and user behaviors, ultimately enhancing the accuracy and efficiency of the SBR training process.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1. </span>Graph Construction</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">The graph construction process is a foundational step in our framework, designed to model the complex relationships between items in SBRs. We begin by constructing session graphs to capture intra-session item relationships. These session graphs serve as the basis for building a global graph, which captures inter-session item relationships, thereby providing a comprehensive representation of item dependencies across sessions.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS1.Px1">
<h5 class="ltx_title ltx_title_paragraph">Session Graph Construction</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.SSS1.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.Px1.p1.7">In this step, we transform each session sequence into a session graph, denoted as <math alttext="\mathcal{G}_{t}=(\mathcal{V}_{t},\mathcal{E}_{t})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px1.p1.1.m1.2"><semantics id="S3.SS2.SSS1.Px1.p1.1.m1.2a"><mrow id="S3.SS2.SSS1.Px1.p1.1.m1.2.2" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.cmml"><msub id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.2" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.2.cmml">𝒢</mi><mi id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.3" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.3" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.3.cmml"><mo id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.4" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.2" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.2.cmml">ℰ</mi><mi id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.3" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px1.p1.1.m1.2b"><apply id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2"><eq id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.3"></eq><apply id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.1.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.2.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.2">𝒢</ci><ci id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.3.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2"><apply id="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.2">𝒱</ci><ci id="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.2">ℰ</ci><ci id="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.1.m1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px1.p1.1.m1.2c">\mathcal{G}_{t}=(\mathcal{V}_{t},\mathcal{E}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px1.p1.1.m1.2d">caligraphic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( caligraphic_V start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_E start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>. Here, <math alttext="\mathcal{V}_{t}\subseteq\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.Px1.p1.2.m2.1a"><mrow id="S3.SS2.SSS1.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.cmml"><msub id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.2" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.3" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.1" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.3" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1"><subset id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.1"></subset><apply id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.2">𝒱</ci><ci id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS1.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.Px1.p1.2.m2.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px1.p1.2.m2.1c">\mathcal{V}_{t}\subseteq\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px1.p1.2.m2.1d">caligraphic_V start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊆ caligraphic_V</annotation></semantics></math> represents the set of items that a user interacts with within session <math alttext="\mathcal{S}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.Px1.p1.3.m3.1a"><msub id="S3.SS2.SSS1.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS1.Px1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px1.p1.3.m3.1.1.2" xref="S3.SS2.SSS1.Px1.p1.3.m3.1.1.2.cmml">𝒮</mi><mi id="S3.SS2.SSS1.Px1.p1.3.m3.1.1.3" xref="S3.SS2.SSS1.Px1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.Px1.p1.3.m3.1.1.2">𝒮</ci><ci id="S3.SS2.SSS1.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.Px1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px1.p1.3.m3.1c">\mathcal{S}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px1.p1.3.m3.1d">caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The edge set <math alttext="\mathcal{E}_{t}=\{(v^{t}_{i},v^{t}_{j})\mid v^{t}_{i},v^{t}_{j}\in\mathcal{V}_%
{t}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px1.p1.4.m4.2"><semantics id="S3.SS2.SSS1.Px1.p1.4.m4.2a"><mrow id="S3.SS2.SSS1.Px1.p1.4.m4.2.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.cmml"><msub id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.2.cmml">ℰ</mi><mi id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.3.cmml">=</mo><mrow id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.3.cmml"><mo id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.3.1.cmml">{</mo><mrow id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.3.cmml"><mo id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.3" stretchy="false" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.4" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.2.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.3.cmml">j</mi><mi id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.2.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.5" stretchy="false" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.3.cmml">)</mo></mrow><mo fence="true" id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.4" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.3.1.cmml">∣</mo><mrow id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.cmml"><mrow id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.3.cmml"><msubsup id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.2.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.3.cmml">i</mi><mi id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.2.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.2.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.3.cmml">j</mi><mi id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.2.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.2.3.cmml">t</mi></msubsup></mrow><mo id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.3.cmml">∈</mo><msub id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.2" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.3" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.3.cmml">t</mi></msub></mrow><mo id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px1.p1.4.m4.2b"><apply id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2"><eq id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.3"></eq><apply id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.2">ℰ</ci><ci id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.4.3">𝑡</ci></apply><apply id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2"><csymbol cd="latexml" id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.3.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2"><apply id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval><apply id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2"><in id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.3"></in><list id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2"><apply id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.1.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.2.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.2">𝒱</ci><ci id="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.3.cmml" xref="S3.SS2.SSS1.Px1.p1.4.m4.2.2.2.2.2.4.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px1.p1.4.m4.2c">\mathcal{E}_{t}=\{(v^{t}_{i},v^{t}_{j})\mid v^{t}_{i},v^{t}_{j}\in\mathcal{V}_%
{t}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px1.p1.4.m4.2d">caligraphic_E start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = { ( italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∣ italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ caligraphic_V start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> captures the relationships between these items. Each edge <math alttext="e^{t}_{ij}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px1.p1.5.m5.1"><semantics id="S3.SS2.SSS1.Px1.p1.5.m5.1a"><msubsup id="S3.SS2.SSS1.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.2.2" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.2.2.cmml">e</mi><mrow id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.2" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.1" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.3" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.2.3" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px1.p1.5.m5.1b"><apply id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.2.2">𝑒</ci><ci id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3"><times id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS1.Px1.p1.5.m5.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px1.p1.5.m5.1c">e^{t}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px1.p1.5.m5.1d">italic_e start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is undirected and unweighted, capturing the sequential dependencies between adjacent items <math alttext="v^{t}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px1.p1.6.m6.1"><semantics id="S3.SS2.SSS1.Px1.p1.6.m6.1a"><msubsup id="S3.SS2.SSS1.Px1.p1.6.m6.1.1" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS1.Px1.p1.6.m6.1.1.2.2" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px1.p1.6.m6.1.1.3" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1.3.cmml">i</mi><mi id="S3.SS2.SSS1.Px1.p1.6.m6.1.1.2.3" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px1.p1.6.m6.1b"><apply id="S3.SS2.SSS1.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS1.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.Px1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px1.p1.6.m6.1c">v^{t}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px1.p1.6.m6.1d">italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v^{t}_{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px1.p1.7.m7.1"><semantics id="S3.SS2.SSS1.Px1.p1.7.m7.1a"><msubsup id="S3.SS2.SSS1.Px1.p1.7.m7.1.1" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS1.Px1.p1.7.m7.1.1.2.2" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px1.p1.7.m7.1.1.3" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1.3.cmml">j</mi><mi id="S3.SS2.SSS1.Px1.p1.7.m7.1.1.2.3" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px1.p1.7.m7.1b"><apply id="S3.SS2.SSS1.Px1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px1.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px1.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px1.p1.7.m7.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS1.Px1.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS1.Px1.p1.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px1.p1.7.m7.1c">v^{t}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px1.p1.7.m7.1d">italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> within the session. This session graph effectively models intra-session item relationships by highlighting the item transitions within each session as edges.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS1.Px2">
<h5 class="ltx_title ltx_title_paragraph">Global Graph Construction</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.SSS1.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS1.Px2.p1.7">To capture inter-session item relationships, we construct a global graph by aggregating session graphs with inter-session connections. This global graph, denoted as <math alttext="\mathcal{G}_{g}=(\mathcal{V}_{g},\mathcal{E}_{g})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px2.p1.1.m1.2"><semantics id="S3.SS2.SSS1.Px2.p1.1.m1.2a"><mrow id="S3.SS2.SSS1.Px2.p1.1.m1.2.2" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.cmml"><msub id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.2" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.2.cmml">𝒢</mi><mi id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.3" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.3.cmml">g</mi></msub><mo id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.3" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.3.cmml"><mo id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.4" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.2" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.cmml">ℰ</mi><mi id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.3" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.3.cmml">g</mi></msub><mo id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px2.p1.1.m1.2b"><apply id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2"><eq id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.3"></eq><apply id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.1.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.2.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.2">𝒢</ci><ci id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.3.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.4.3">𝑔</ci></apply><interval closure="open" id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2"><apply id="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.2">𝒱</ci><ci id="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.1.1.1.1.1.3">𝑔</ci></apply><apply id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.2">ℰ</ci><ci id="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.1.m1.2.2.2.2.2.3">𝑔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px2.p1.1.m1.2c">\mathcal{G}_{g}=(\mathcal{V}_{g},\mathcal{E}_{g})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px2.p1.1.m1.2d">caligraphic_G start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT = ( caligraphic_V start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT , caligraphic_E start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math>, includes a node for each unique item in the dataset, where <math alttext="\mathcal{V}_{g}=\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS1.Px2.p1.2.m2.1a"><mrow id="S3.SS2.SSS1.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.2" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.3" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.3.cmml">g</mi></msub><mo id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.1" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.3" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px2.p1.2.m2.1b"><apply id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1"><eq id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.1"></eq><apply id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.2">𝒱</ci><ci id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.2.3">𝑔</ci></apply><ci id="S3.SS2.SSS1.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.Px2.p1.2.m2.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px2.p1.2.m2.1c">\mathcal{V}_{g}=\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px2.p1.2.m2.1d">caligraphic_V start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT = caligraphic_V</annotation></semantics></math>. In this graph, edges are undirected and weighted, with the weight of an edge representing the frequency of item co-occurrences across different sessions. The graph aggregates connections from multiple session graphs, assigning the count of co-occurrences as the weight for each edge. Formally, the edge set is defined as <math alttext="\mathcal{E}_{g}=\{(v^{g}_{i},v^{g}_{j})\mid v^{g}_{i},v^{g}_{j}\in\mathcal{V}_%
{g}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px2.p1.3.m3.2"><semantics id="S3.SS2.SSS1.Px2.p1.3.m3.2a"><mrow id="S3.SS2.SSS1.Px2.p1.3.m3.2.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.cmml"><msub id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.2.cmml">ℰ</mi><mi id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.3.cmml">g</mi></msub><mo id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.3.cmml"><mo id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.3.1.cmml">{</mo><mrow id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.3.cmml"><mo id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.3" stretchy="false" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.2.3.cmml">g</mi></msubsup><mo id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.4" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.2.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.3.cmml">j</mi><mi id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.2.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.2.3.cmml">g</mi></msubsup><mo id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.5" stretchy="false" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.3.cmml">)</mo></mrow><mo fence="true" id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.4" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.3.1.cmml">∣</mo><mrow id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.cmml"><mrow id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.3.cmml"><msubsup id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.2.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.3.cmml">i</mi><mi id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.2.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.2.3.cmml">g</mi></msubsup><mo id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.2.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.3.cmml">j</mi><mi id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.2.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.2.3.cmml">g</mi></msubsup></mrow><mo id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.3.cmml">∈</mo><msub id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.2" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.2.cmml">𝒱</mi><mi id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.3" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.3.cmml">g</mi></msub></mrow><mo id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px2.p1.3.m3.2b"><apply id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2"><eq id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.3"></eq><apply id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.2">ℰ</ci><ci id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.4.3">𝑔</ci></apply><apply id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2"><csymbol cd="latexml" id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.3.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2"><apply id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.2.3">𝑔</ci></apply><ci id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.2.3">𝑔</ci></apply><ci id="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval><apply id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2"><in id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.3"></in><list id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2"><apply id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.2.3">𝑔</ci></apply><ci id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.2.3">𝑔</ci></apply><ci id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.1.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.2.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.2">𝒱</ci><ci id="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.3.cmml" xref="S3.SS2.SSS1.Px2.p1.3.m3.2.2.2.2.2.4.3">𝑔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px2.p1.3.m3.2c">\mathcal{E}_{g}=\{(v^{g}_{i},v^{g}_{j})\mid v^{g}_{i},v^{g}_{j}\in\mathcal{V}_%
{g}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px2.p1.3.m3.2d">caligraphic_E start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT = { ( italic_v start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∣ italic_v start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ caligraphic_V start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT }</annotation></semantics></math>, where each edge <math alttext="e^{g}_{ij}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px2.p1.4.m4.1"><semantics id="S3.SS2.SSS1.Px2.p1.4.m4.1a"><msubsup id="S3.SS2.SSS1.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.2.2" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.2.2.cmml">e</mi><mrow id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.2" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.1" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.3" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.2.3" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.2.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px2.p1.4.m4.1b"><apply id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.2.2">𝑒</ci><ci id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.2.3">𝑔</ci></apply><apply id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3"><times id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.1"></times><ci id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS1.Px2.p1.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px2.p1.4.m4.1c">e^{g}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px2.p1.4.m4.1d">italic_e start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is associated with a weight <math alttext="w^{g}_{ij}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px2.p1.5.m5.1"><semantics id="S3.SS2.SSS1.Px2.p1.5.m5.1a"><msubsup id="S3.SS2.SSS1.Px2.p1.5.m5.1.1" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.2.2" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.2.2.cmml">w</mi><mrow id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.2" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.1" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.3" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.3.cmml">j</mi></mrow><mi id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.2.3" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.2.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px2.p1.5.m5.1b"><apply id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.2.2">𝑤</ci><ci id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.2.3">𝑔</ci></apply><apply id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3"><times id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.1"></times><ci id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS1.Px2.p1.5.m5.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px2.p1.5.m5.1c">w^{g}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px2.p1.5.m5.1d">italic_w start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, which quantifies the strength of the relationship between items <math alttext="v^{g}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px2.p1.6.m6.1"><semantics id="S3.SS2.SSS1.Px2.p1.6.m6.1a"><msubsup id="S3.SS2.SSS1.Px2.p1.6.m6.1.1" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS1.Px2.p1.6.m6.1.1.2.2" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px2.p1.6.m6.1.1.3" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1.3.cmml">i</mi><mi id="S3.SS2.SSS1.Px2.p1.6.m6.1.1.2.3" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1.2.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px2.p1.6.m6.1b"><apply id="S3.SS2.SSS1.Px2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px2.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1.2.3">𝑔</ci></apply><ci id="S3.SS2.SSS1.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.Px2.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px2.p1.6.m6.1c">v^{g}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px2.p1.6.m6.1d">italic_v start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v^{g}_{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.Px2.p1.7.m7.1"><semantics id="S3.SS2.SSS1.Px2.p1.7.m7.1a"><msubsup id="S3.SS2.SSS1.Px2.p1.7.m7.1.1" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS1.Px2.p1.7.m7.1.1.2.2" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.Px2.p1.7.m7.1.1.3" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1.3.cmml">j</mi><mi id="S3.SS2.SSS1.Px2.p1.7.m7.1.1.2.3" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1.2.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.Px2.p1.7.m7.1b"><apply id="S3.SS2.SSS1.Px2.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.Px2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.Px2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.Px2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1.2.2">𝑣</ci><ci id="S3.SS2.SSS1.Px2.p1.7.m7.1.1.2.3.cmml" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1.2.3">𝑔</ci></apply><ci id="S3.SS2.SSS1.Px2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS1.Px2.p1.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.Px2.p1.7.m7.1c">v^{g}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.Px2.p1.7.m7.1d">italic_v start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> based on their co-occurrence frequency. The constructed global graph plays a crucial role in our framework by modeling both intra-session and inter-session item relationships in a single structure. We utilize this graph representation to detect clusters of items that are closely related.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2. </span>Item Cluster Detection</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">The process of detecting item clusters within the global graph <math alttext="\mathcal{G}_{g}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><msub id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">𝒢</mi><mi id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2">𝒢</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">\mathcal{G}_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">caligraphic_G start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> plays a crucial role in capturing the complex relationships between items. In this study, a <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.p1.1.1">cluster</span> refers to a subset of nodes within the graph that are more densely connected to each other than to nodes outside the subset. This high internal connectivity helps uncover latent item dependencies and user behavior patterns, which are essential for modeling complex item relationships embedded in session data. The goal of this step is to identify item clusters that exhibit strong relationships, which are critical for capturing nuanced user preferences in session-based recommendation. To achieve this, we employ the Leiden algorithm <cite class="ltx_cite ltx_citemacro_citep">(Traag et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib29" title="">2019</a>)</cite>, a community detection method known for its superior performance in handling large-scale and complex graphs. The algorithm enhances the Louvain algorithm <cite class="ltx_cite ltx_citemacro_citep">(Blondel et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib2" title="">2008</a>)</cite>, by improving detection quality, accelerating convergence speed, and increasing robustness against noise and resolution limits. Furthermore, it effectively handles unconnected and large-scale graphs, both of which are common in recommendation settings, making the Leiden algorithm particularly suitable for our task of item cluster detection.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.1">We apply the Leiden algorithm to the global graph <math alttext="\mathcal{G}_{g}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.1.m1.1"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><msub id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p2.1.m1.1.1.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml">𝒢</mi><mi id="S3.SS2.SSS2.p2.1.m1.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><apply id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2">𝒢</ci><ci id="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">\mathcal{G}_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.1.m1.1d">caligraphic_G start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> to partition items into clusters:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textit{Partition}=\textit{Leiden}(\mathcal{G}_{g})=\{(v^{g}_{i}:c_{m})\mid v^%
{g}_{i}\in\mathcal{V}_{g},c_{m}\in\mathcal{C}\}." class="ltx_math_unparsed" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1b"><mtext class="ltx_mathvariant_italic" id="S3.E1.m1.1.1">Partition</mtext><mo id="S3.E1.m1.1.2">=</mo><mtext class="ltx_mathvariant_italic" id="S3.E1.m1.1.3">Leiden</mtext><mrow id="S3.E1.m1.1.4"><mo id="S3.E1.m1.1.4.1" stretchy="false">(</mo><msub id="S3.E1.m1.1.4.2"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.4.2.2">𝒢</mi><mi id="S3.E1.m1.1.4.2.3">g</mi></msub><mo id="S3.E1.m1.1.4.3" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.1.5">=</mo><mrow id="S3.E1.m1.1.6"><mo id="S3.E1.m1.1.6.1" stretchy="false">{</mo><mrow id="S3.E1.m1.1.6.2"><mo id="S3.E1.m1.1.6.2.1" stretchy="false">(</mo><msubsup id="S3.E1.m1.1.6.2.2"><mi id="S3.E1.m1.1.6.2.2.2.2">v</mi><mi id="S3.E1.m1.1.6.2.2.3">i</mi><mi id="S3.E1.m1.1.6.2.2.2.3">g</mi></msubsup><mo id="S3.E1.m1.1.6.2.3" lspace="0.278em" rspace="0.278em">:</mo><msub id="S3.E1.m1.1.6.2.4"><mi id="S3.E1.m1.1.6.2.4.2">c</mi><mi id="S3.E1.m1.1.6.2.4.3">m</mi></msub><mo id="S3.E1.m1.1.6.2.5" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.1.6.3" lspace="0em" rspace="0.167em">∣</mo><msubsup id="S3.E1.m1.1.6.4"><mi id="S3.E1.m1.1.6.4.2.2">v</mi><mi id="S3.E1.m1.1.6.4.3">i</mi><mi id="S3.E1.m1.1.6.4.2.3">g</mi></msubsup><mo id="S3.E1.m1.1.6.5">∈</mo><msub id="S3.E1.m1.1.6.6"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.6.6.2">𝒱</mi><mi id="S3.E1.m1.1.6.6.3">g</mi></msub><mo id="S3.E1.m1.1.6.7">,</mo><msub id="S3.E1.m1.1.6.8"><mi id="S3.E1.m1.1.6.8.2">c</mi><mi id="S3.E1.m1.1.6.8.3">m</mi></msub><mo id="S3.E1.m1.1.6.9">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.6.10">𝒞</mi><mo id="S3.E1.m1.1.6.11" stretchy="false">}</mo></mrow><mo id="S3.E1.m1.1.7" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\textit{Partition}=\textit{Leiden}(\mathcal{G}_{g})=\{(v^{g}_{i}:c_{m})\mid v^%
{g}_{i}\in\mathcal{V}_{g},c_{m}\in\mathcal{C}\}.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">Partition = Leiden ( caligraphic_G start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) = { ( italic_v start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT : italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) ∣ italic_v start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_V start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∈ caligraphic_C } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p3">
<p class="ltx_p" id="S3.SS2.SSS2.p3.7">Here, <math alttext="\textit{Leiden}(\mathcal{G}_{g})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.1.m1.1"><semantics id="S3.SS2.SSS2.p3.1.m1.1a"><mrow id="S3.SS2.SSS2.p3.1.m1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS2.p3.1.m1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.3a.cmml">Leiden</mtext><mo id="S3.SS2.SSS2.p3.1.m1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p3.1.m1.1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.cmml">𝒢</mi><mi id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.1.m1.1b"><apply id="S3.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1"><times id="S3.SS2.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.2"></times><ci id="S3.SS2.SSS2.p3.1.m1.1.1.3a.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.3">Leiden</mtext></ci><apply id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.2">𝒢</ci><ci id="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.1.1.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.1.m1.1c">\textit{Leiden}(\mathcal{G}_{g})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.1.m1.1d">Leiden ( caligraphic_G start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math> represents the execution of the Leiden algorithm on the global graph <math alttext="\mathcal{G}_{g}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.2.m2.1"><semantics id="S3.SS2.SSS2.p3.2.m2.1a"><msub id="S3.SS2.SSS2.p3.2.m2.1.1" xref="S3.SS2.SSS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.2.m2.1.1.2" xref="S3.SS2.SSS2.p3.2.m2.1.1.2.cmml">𝒢</mi><mi id="S3.SS2.SSS2.p3.2.m2.1.1.3" xref="S3.SS2.SSS2.p3.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.2.m2.1b"><apply id="S3.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.2">𝒢</ci><ci id="S3.SS2.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p3.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.2.m2.1c">\mathcal{G}_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.2.m2.1d">caligraphic_G start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, yielding a dictionary-like structure <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.p3.7.1">Partition</span>, in which each item <math alttext="v^{g}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.3.m3.1"><semantics id="S3.SS2.SSS2.p3.3.m3.1a"><msubsup id="S3.SS2.SSS2.p3.3.m3.1.1" xref="S3.SS2.SSS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p3.3.m3.1.1.2.2" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.2.cmml">v</mi><mi id="S3.SS2.SSS2.p3.3.m3.1.1.3" xref="S3.SS2.SSS2.p3.3.m3.1.1.3.cmml">i</mi><mi id="S3.SS2.SSS2.p3.3.m3.1.1.2.3" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.3.m3.1b"><apply id="S3.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1">subscript</csymbol><apply id="S3.SS2.SSS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.2">𝑣</ci><ci id="S3.SS2.SSS2.p3.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.2.3">𝑔</ci></apply><ci id="S3.SS2.SSS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.3.m3.1c">v^{g}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.3.m3.1d">italic_v start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is assigned to a specific cluster <math alttext="c_{m}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.4.m4.1"><semantics id="S3.SS2.SSS2.p3.4.m4.1a"><msub id="S3.SS2.SSS2.p3.4.m4.1.1" xref="S3.SS2.SSS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p3.4.m4.1.1.2" xref="S3.SS2.SSS2.p3.4.m4.1.1.2.cmml">c</mi><mi id="S3.SS2.SSS2.p3.4.m4.1.1.3" xref="S3.SS2.SSS2.p3.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.4.m4.1b"><apply id="S3.SS2.SSS2.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1.2">𝑐</ci><ci id="S3.SS2.SSS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p3.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.4.m4.1c">c_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.4.m4.1d">italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>. The set of detected clusters is denoted as <math alttext="\mathcal{C}=\{c_{1},c_{2},\dots,c_{\mid\mathcal{C}\mid}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.5.m5.5"><semantics id="S3.SS2.SSS2.p3.5.m5.5a"><mrow id="S3.SS2.SSS2.p3.5.m5.5.5" xref="S3.SS2.SSS2.p3.5.m5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.5.m5.5.5.5" xref="S3.SS2.SSS2.p3.5.m5.5.5.5.cmml">𝒞</mi><mo id="S3.SS2.SSS2.p3.5.m5.5.5.4" xref="S3.SS2.SSS2.p3.5.m5.5.5.4.cmml">=</mo><mrow id="S3.SS2.SSS2.p3.5.m5.5.5.3.3" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.4.cmml"><mo id="S3.SS2.SSS2.p3.5.m5.5.5.3.3.4" stretchy="false" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.4.cmml">{</mo><msub id="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1" xref="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.2" xref="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.2.cmml">c</mi><mn id="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.3" xref="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p3.5.m5.5.5.3.3.5" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2" xref="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.cmml"><mi id="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.2" xref="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.2.cmml">c</mi><mn id="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.3" xref="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS2.p3.5.m5.5.5.3.3.6" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.4.cmml">,</mo><mi id="S3.SS2.SSS2.p3.5.m5.2.2" mathvariant="normal" xref="S3.SS2.SSS2.p3.5.m5.2.2.cmml">…</mi><mo id="S3.SS2.SSS2.p3.5.m5.5.5.3.3.7" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.p3.5.m5.5.5.3.3.3" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.3.3.cmml"><mi id="S3.SS2.SSS2.p3.5.m5.5.5.3.3.3.2" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.3.3.2.cmml">c</mi><mrow id="S3.SS2.SSS2.p3.5.m5.1.1.1.3" xref="S3.SS2.SSS2.p3.5.m5.1.1.1.2.cmml"><mo fence="true" id="S3.SS2.SSS2.p3.5.m5.1.1.1.3.1" rspace="0em" xref="S3.SS2.SSS2.p3.5.m5.1.1.1.2.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.5.m5.1.1.1.1" xref="S3.SS2.SSS2.p3.5.m5.1.1.1.1.cmml">𝒞</mi><mo fence="true" id="S3.SS2.SSS2.p3.5.m5.1.1.1.3.2" lspace="0em" xref="S3.SS2.SSS2.p3.5.m5.1.1.1.2.1.cmml">∣</mo></mrow></msub><mo id="S3.SS2.SSS2.p3.5.m5.5.5.3.3.8" stretchy="false" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.5.m5.5b"><apply id="S3.SS2.SSS2.p3.5.m5.5.5.cmml" xref="S3.SS2.SSS2.p3.5.m5.5.5"><eq id="S3.SS2.SSS2.p3.5.m5.5.5.4.cmml" xref="S3.SS2.SSS2.p3.5.m5.5.5.4"></eq><ci id="S3.SS2.SSS2.p3.5.m5.5.5.5.cmml" xref="S3.SS2.SSS2.p3.5.m5.5.5.5">𝒞</ci><set id="S3.SS2.SSS2.p3.5.m5.5.5.3.4.cmml" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.3"><apply id="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.cmml" xref="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.2">𝑐</ci><cn id="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p3.5.m5.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.cmml" xref="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.1.cmml" xref="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.2">𝑐</ci><cn id="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p3.5.m5.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.p3.5.m5.2.2.cmml" xref="S3.SS2.SSS2.p3.5.m5.2.2">…</ci><apply id="S3.SS2.SSS2.p3.5.m5.5.5.3.3.3.cmml" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.5.m5.5.5.3.3.3.1.cmml" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.5.m5.5.5.3.3.3.2.cmml" xref="S3.SS2.SSS2.p3.5.m5.5.5.3.3.3.2">𝑐</ci><apply id="S3.SS2.SSS2.p3.5.m5.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.5.m5.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS2.p3.5.m5.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.5.m5.1.1.1.3.1">delimited-∣∣</csymbol><ci id="S3.SS2.SSS2.p3.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.5.m5.1.1.1.1">𝒞</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.5.m5.5c">\mathcal{C}=\{c_{1},c_{2},\dots,c_{\mid\mathcal{C}\mid}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.5.m5.5d">caligraphic_C = { italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT ∣ caligraphic_C ∣ end_POSTSUBSCRIPT }</annotation></semantics></math>, where each <math alttext="c_{m}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.6.m6.1"><semantics id="S3.SS2.SSS2.p3.6.m6.1a"><msub id="S3.SS2.SSS2.p3.6.m6.1.1" xref="S3.SS2.SSS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.SSS2.p3.6.m6.1.1.2" xref="S3.SS2.SSS2.p3.6.m6.1.1.2.cmml">c</mi><mi id="S3.SS2.SSS2.p3.6.m6.1.1.3" xref="S3.SS2.SSS2.p3.6.m6.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.6.m6.1b"><apply id="S3.SS2.SSS2.p3.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.SSS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.SSS2.p3.6.m6.1.1.2">𝑐</ci><ci id="S3.SS2.SSS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.SSS2.p3.6.m6.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.6.m6.1c">c_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.6.m6.1d">italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> represents a distinct cluster, and <math alttext="\mid\mathcal{C}\mid" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p3.7.m7.1"><semantics id="S3.SS2.SSS2.p3.7.m7.1a"><mrow id="S3.SS2.SSS2.p3.7.m7.1.2.2" xref="S3.SS2.SSS2.p3.7.m7.1.2.1.cmml"><mo fence="true" id="S3.SS2.SSS2.p3.7.m7.1.2.2.1" rspace="0em" xref="S3.SS2.SSS2.p3.7.m7.1.2.1.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p3.7.m7.1.1" xref="S3.SS2.SSS2.p3.7.m7.1.1.cmml">𝒞</mi><mo fence="true" id="S3.SS2.SSS2.p3.7.m7.1.2.2.2" lspace="0em" xref="S3.SS2.SSS2.p3.7.m7.1.2.1.1.cmml">∣</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.7.m7.1b"><apply id="S3.SS2.SSS2.p3.7.m7.1.2.1.cmml" xref="S3.SS2.SSS2.p3.7.m7.1.2.2"><csymbol cd="latexml" id="S3.SS2.SSS2.p3.7.m7.1.2.1.1.cmml" xref="S3.SS2.SSS2.p3.7.m7.1.2.2.1">delimited-∣∣</csymbol><ci id="S3.SS2.SSS2.p3.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p3.7.m7.1.1">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.7.m7.1c">\mid\mathcal{C}\mid</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p3.7.m7.1d">∣ caligraphic_C ∣</annotation></semantics></math> is the total number of clusters. Identifying item clusters enables us to capture intricate item relationships that are overlooked in many previous SBR studies <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib9" title="">2016</a>; Li et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib15" title="">2017</a>; Hou et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib10" title="">2022</a>; Wu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib33" title="">2019</a>; Yu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib36" title="">2020</a>)</cite>. By leveraging these clusters, we can better tailor the SBR process to reflect underlying user preferences and interactions across sessions. The identified item clusters are subsequently used in the second module of our framework, where they play a crucial role in integrating item cluster-aware prompt learning into session-based recommendation models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Item Cluster-aware Prompt Learning</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In this section, we introduce a method to integrate the mined information about item relationships into SBR models during training. By leveraging learnable prompts, which have proven effective in providing data-related information to models, we enhance the capability of SBRs to capture both intra- and inter-session item relationships.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.10">First, session data is fed into the embedding layer of the existing SBR to obtain the initial item embeddings. Formally, we represent the initial item embeddings as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{V}^{(0)}=\text{EmbeddingLayer}(\mathcal{V})," class="ltx_Math" display="block" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><msup id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2" xref="S3.E2.m1.3.3.1.1.2.2.cmml">𝐕</mi><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.3.1" stretchy="false" xref="S3.E2.m1.3.3.1.1.2.cmml">(</mo><mn id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">0</mn><mo id="S3.E2.m1.1.1.1.3.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mtext id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2a.cmml">EmbeddingLayer</mtext><mo id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.cmml"><mo id="S3.E2.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">𝒱</mi><mo id="S3.E2.m1.3.3.1.1.3.3.2.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"></eq><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2">𝐕</ci><cn id="S3.E2.m1.1.1.1.1.cmml" type="integer" xref="S3.E2.m1.1.1.1.1">0</cn></apply><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"></times><ci id="S3.E2.m1.3.3.1.1.3.2a.cmml" xref="S3.E2.m1.3.3.1.1.3.2"><mtext id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2">EmbeddingLayer</mtext></ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝒱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\mathbf{V}^{(0)}=\text{EmbeddingLayer}(\mathcal{V}),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">bold_V start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT = EmbeddingLayer ( caligraphic_V ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.6">where <math alttext="\mathbf{V}^{(0)}=\{\mathbf{v}^{(0)}_{1},\mathbf{v}^{(0)}_{2},\cdots,\mathbf{v}%
^{(0)}_{\mid\mathcal{V}\mid}\}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.9"><semantics id="S3.SS3.p2.1.m1.9a"><mrow id="S3.SS3.p2.1.m1.9.9" xref="S3.SS3.p2.1.m1.9.9.cmml"><msup id="S3.SS3.p2.1.m1.9.9.5" xref="S3.SS3.p2.1.m1.9.9.5.cmml"><mi id="S3.SS3.p2.1.m1.9.9.5.2" xref="S3.SS3.p2.1.m1.9.9.5.2.cmml">𝐕</mi><mrow id="S3.SS3.p2.1.m1.1.1.1.3" xref="S3.SS3.p2.1.m1.9.9.5.cmml"><mo id="S3.SS3.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p2.1.m1.9.9.5.cmml">(</mo><mn id="S3.SS3.p2.1.m1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.cmml">0</mn><mo id="S3.SS3.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p2.1.m1.9.9.5.cmml">)</mo></mrow></msup><mo id="S3.SS3.p2.1.m1.9.9.4" xref="S3.SS3.p2.1.m1.9.9.4.cmml">=</mo><mrow id="S3.SS3.p2.1.m1.9.9.3.3" xref="S3.SS3.p2.1.m1.9.9.3.4.cmml"><mo id="S3.SS3.p2.1.m1.9.9.3.3.4" stretchy="false" xref="S3.SS3.p2.1.m1.9.9.3.4.cmml">{</mo><msubsup id="S3.SS3.p2.1.m1.7.7.1.1.1" xref="S3.SS3.p2.1.m1.7.7.1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.7.7.1.1.1.2.2" xref="S3.SS3.p2.1.m1.7.7.1.1.1.2.2.cmml">𝐯</mi><mn id="S3.SS3.p2.1.m1.7.7.1.1.1.3" xref="S3.SS3.p2.1.m1.7.7.1.1.1.3.cmml">1</mn><mrow id="S3.SS3.p2.1.m1.2.2.1.3" xref="S3.SS3.p2.1.m1.7.7.1.1.1.cmml"><mo id="S3.SS3.p2.1.m1.2.2.1.3.1" stretchy="false" xref="S3.SS3.p2.1.m1.7.7.1.1.1.cmml">(</mo><mn id="S3.SS3.p2.1.m1.2.2.1.1" xref="S3.SS3.p2.1.m1.2.2.1.1.cmml">0</mn><mo id="S3.SS3.p2.1.m1.2.2.1.3.2" stretchy="false" xref="S3.SS3.p2.1.m1.7.7.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.1.m1.9.9.3.3.5" xref="S3.SS3.p2.1.m1.9.9.3.4.cmml">,</mo><msubsup id="S3.SS3.p2.1.m1.8.8.2.2.2" xref="S3.SS3.p2.1.m1.8.8.2.2.2.cmml"><mi id="S3.SS3.p2.1.m1.8.8.2.2.2.2.2" xref="S3.SS3.p2.1.m1.8.8.2.2.2.2.2.cmml">𝐯</mi><mn id="S3.SS3.p2.1.m1.8.8.2.2.2.3" xref="S3.SS3.p2.1.m1.8.8.2.2.2.3.cmml">2</mn><mrow id="S3.SS3.p2.1.m1.3.3.1.3" xref="S3.SS3.p2.1.m1.8.8.2.2.2.cmml"><mo id="S3.SS3.p2.1.m1.3.3.1.3.1" stretchy="false" xref="S3.SS3.p2.1.m1.8.8.2.2.2.cmml">(</mo><mn id="S3.SS3.p2.1.m1.3.3.1.1" xref="S3.SS3.p2.1.m1.3.3.1.1.cmml">0</mn><mo id="S3.SS3.p2.1.m1.3.3.1.3.2" stretchy="false" xref="S3.SS3.p2.1.m1.8.8.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.1.m1.9.9.3.3.6" xref="S3.SS3.p2.1.m1.9.9.3.4.cmml">,</mo><mi id="S3.SS3.p2.1.m1.6.6" mathvariant="normal" xref="S3.SS3.p2.1.m1.6.6.cmml">⋯</mi><mo id="S3.SS3.p2.1.m1.9.9.3.3.7" xref="S3.SS3.p2.1.m1.9.9.3.4.cmml">,</mo><msubsup id="S3.SS3.p2.1.m1.9.9.3.3.3" xref="S3.SS3.p2.1.m1.9.9.3.3.3.cmml"><mi id="S3.SS3.p2.1.m1.9.9.3.3.3.2.2" xref="S3.SS3.p2.1.m1.9.9.3.3.3.2.2.cmml">𝐯</mi><mrow id="S3.SS3.p2.1.m1.5.5.1.3" xref="S3.SS3.p2.1.m1.5.5.1.2.cmml"><mo fence="true" id="S3.SS3.p2.1.m1.5.5.1.3.1" rspace="0em" xref="S3.SS3.p2.1.m1.5.5.1.2.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.5.5.1.1" xref="S3.SS3.p2.1.m1.5.5.1.1.cmml">𝒱</mi><mo fence="true" id="S3.SS3.p2.1.m1.5.5.1.3.2" lspace="0em" xref="S3.SS3.p2.1.m1.5.5.1.2.1.cmml">∣</mo></mrow><mrow id="S3.SS3.p2.1.m1.4.4.1.3" xref="S3.SS3.p2.1.m1.9.9.3.3.3.cmml"><mo id="S3.SS3.p2.1.m1.4.4.1.3.1" stretchy="false" xref="S3.SS3.p2.1.m1.9.9.3.3.3.cmml">(</mo><mn id="S3.SS3.p2.1.m1.4.4.1.1" xref="S3.SS3.p2.1.m1.4.4.1.1.cmml">0</mn><mo id="S3.SS3.p2.1.m1.4.4.1.3.2" stretchy="false" xref="S3.SS3.p2.1.m1.9.9.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.1.m1.9.9.3.3.8" stretchy="false" xref="S3.SS3.p2.1.m1.9.9.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.9b"><apply id="S3.SS3.p2.1.m1.9.9.cmml" xref="S3.SS3.p2.1.m1.9.9"><eq id="S3.SS3.p2.1.m1.9.9.4.cmml" xref="S3.SS3.p2.1.m1.9.9.4"></eq><apply id="S3.SS3.p2.1.m1.9.9.5.cmml" xref="S3.SS3.p2.1.m1.9.9.5"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.9.9.5.1.cmml" xref="S3.SS3.p2.1.m1.9.9.5">superscript</csymbol><ci id="S3.SS3.p2.1.m1.9.9.5.2.cmml" xref="S3.SS3.p2.1.m1.9.9.5.2">𝐕</ci><cn id="S3.SS3.p2.1.m1.1.1.1.1.cmml" type="integer" xref="S3.SS3.p2.1.m1.1.1.1.1">0</cn></apply><set id="S3.SS3.p2.1.m1.9.9.3.4.cmml" xref="S3.SS3.p2.1.m1.9.9.3.3"><apply id="S3.SS3.p2.1.m1.7.7.1.1.1.cmml" xref="S3.SS3.p2.1.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.7.7.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.7.7.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.1.m1.7.7.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.7.7.1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.7.7.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.1.m1.7.7.1.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.7.7.1.1.1.2.2">𝐯</ci><cn id="S3.SS3.p2.1.m1.2.2.1.1.cmml" type="integer" xref="S3.SS3.p2.1.m1.2.2.1.1">0</cn></apply><cn id="S3.SS3.p2.1.m1.7.7.1.1.1.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.7.7.1.1.1.3">1</cn></apply><apply id="S3.SS3.p2.1.m1.8.8.2.2.2.cmml" xref="S3.SS3.p2.1.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.8.8.2.2.2.1.cmml" xref="S3.SS3.p2.1.m1.8.8.2.2.2">subscript</csymbol><apply id="S3.SS3.p2.1.m1.8.8.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.8.8.2.2.2.2.1.cmml" xref="S3.SS3.p2.1.m1.8.8.2.2.2">superscript</csymbol><ci id="S3.SS3.p2.1.m1.8.8.2.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.8.8.2.2.2.2.2">𝐯</ci><cn id="S3.SS3.p2.1.m1.3.3.1.1.cmml" type="integer" xref="S3.SS3.p2.1.m1.3.3.1.1">0</cn></apply><cn id="S3.SS3.p2.1.m1.8.8.2.2.2.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.8.8.2.2.2.3">2</cn></apply><ci id="S3.SS3.p2.1.m1.6.6.cmml" xref="S3.SS3.p2.1.m1.6.6">⋯</ci><apply id="S3.SS3.p2.1.m1.9.9.3.3.3.cmml" xref="S3.SS3.p2.1.m1.9.9.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.9.9.3.3.3.1.cmml" xref="S3.SS3.p2.1.m1.9.9.3.3.3">subscript</csymbol><apply id="S3.SS3.p2.1.m1.9.9.3.3.3.2.cmml" xref="S3.SS3.p2.1.m1.9.9.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.9.9.3.3.3.2.1.cmml" xref="S3.SS3.p2.1.m1.9.9.3.3.3">superscript</csymbol><ci id="S3.SS3.p2.1.m1.9.9.3.3.3.2.2.cmml" xref="S3.SS3.p2.1.m1.9.9.3.3.3.2.2">𝐯</ci><cn id="S3.SS3.p2.1.m1.4.4.1.1.cmml" type="integer" xref="S3.SS3.p2.1.m1.4.4.1.1">0</cn></apply><apply id="S3.SS3.p2.1.m1.5.5.1.2.cmml" xref="S3.SS3.p2.1.m1.5.5.1.3"><csymbol cd="latexml" id="S3.SS3.p2.1.m1.5.5.1.2.1.cmml" xref="S3.SS3.p2.1.m1.5.5.1.3.1">delimited-∣∣</csymbol><ci id="S3.SS3.p2.1.m1.5.5.1.1.cmml" xref="S3.SS3.p2.1.m1.5.5.1.1">𝒱</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.9c">\mathbf{V}^{(0)}=\{\mathbf{v}^{(0)}_{1},\mathbf{v}^{(0)}_{2},\cdots,\mathbf{v}%
^{(0)}_{\mid\mathcal{V}\mid}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.9d">bold_V start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT = { bold_v start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_v start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , bold_v start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∣ caligraphic_V ∣ end_POSTSUBSCRIPT }</annotation></semantics></math> represents the set of initial item embeddings for the items in <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">caligraphic_V</annotation></semantics></math>. Here, we assign an unique and randomly initialized learnable vector (soft prompt), called <span class="ltx_text ltx_font_italic" id="S3.SS3.p2.6.1">cluster prompt</span>, to each detected item cluster. The cluster prompt for a cluster <math alttext="c_{m}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">c</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑐</ci><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">c_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> is denoted as <math alttext="\mathbf{c}_{m}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">𝐜</mi><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝐜</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\mathbf{c}_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">bold_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>. For each item <math alttext="v_{k}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑣</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">v_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">caligraphic_V</annotation></semantics></math>, we retrieve its corresponding cluster prompt using the partition from the Leiden algorithm:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="c_{m}=\textit{Partition}(v_{k})," class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.3.2.cmml">c</mi><mi id="S3.E3.m1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.3.3.cmml">m</mi></msub><mo id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3a.cmml">Partition</mtext><mo id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"></eq><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3.2">𝑐</ci><ci id="S3.E3.m1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3">𝑚</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">Partition</mtext></ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">c_{m}=\textit{Partition}(v_{k}),</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = Partition ( italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.9">where <math alttext="c_{m}" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m1.1"><semantics id="S3.SS3.p2.7.m1.1a"><msub id="S3.SS3.p2.7.m1.1.1" xref="S3.SS3.p2.7.m1.1.1.cmml"><mi id="S3.SS3.p2.7.m1.1.1.2" xref="S3.SS3.p2.7.m1.1.1.2.cmml">c</mi><mi id="S3.SS3.p2.7.m1.1.1.3" xref="S3.SS3.p2.7.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m1.1b"><apply id="S3.SS3.p2.7.m1.1.1.cmml" xref="S3.SS3.p2.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m1.1.1.1.cmml" xref="S3.SS3.p2.7.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.7.m1.1.1.2.cmml" xref="S3.SS3.p2.7.m1.1.1.2">𝑐</ci><ci id="S3.SS3.p2.7.m1.1.1.3.cmml" xref="S3.SS3.p2.7.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m1.1c">c_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m1.1d">italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> represents the cluster to which item <math alttext="v_{k}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m2.1"><semantics id="S3.SS3.p2.8.m2.1a"><msub id="S3.SS3.p2.8.m2.1.1" xref="S3.SS3.p2.8.m2.1.1.cmml"><mi id="S3.SS3.p2.8.m2.1.1.2" xref="S3.SS3.p2.8.m2.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.8.m2.1.1.3" xref="S3.SS3.p2.8.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m2.1b"><apply id="S3.SS3.p2.8.m2.1.1.cmml" xref="S3.SS3.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m2.1.1.1.cmml" xref="S3.SS3.p2.8.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m2.1.1.2.cmml" xref="S3.SS3.p2.8.m2.1.1.2">𝑣</ci><ci id="S3.SS3.p2.8.m2.1.1.3.cmml" xref="S3.SS3.p2.8.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m2.1c">v_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m2.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> belongs. The set of all cluster prompts is defined as <math alttext="\mathbf{C}=\{\mathbf{c}_{1},\dots,\mathbf{c}_{\mid\mathcal{C}\mid}\}" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m3.4"><semantics id="S3.SS3.p2.9.m3.4a"><mrow id="S3.SS3.p2.9.m3.4.4" xref="S3.SS3.p2.9.m3.4.4.cmml"><mi id="S3.SS3.p2.9.m3.4.4.4" xref="S3.SS3.p2.9.m3.4.4.4.cmml">𝐂</mi><mo id="S3.SS3.p2.9.m3.4.4.3" xref="S3.SS3.p2.9.m3.4.4.3.cmml">=</mo><mrow id="S3.SS3.p2.9.m3.4.4.2.2" xref="S3.SS3.p2.9.m3.4.4.2.3.cmml"><mo id="S3.SS3.p2.9.m3.4.4.2.2.3" stretchy="false" xref="S3.SS3.p2.9.m3.4.4.2.3.cmml">{</mo><msub id="S3.SS3.p2.9.m3.3.3.1.1.1" xref="S3.SS3.p2.9.m3.3.3.1.1.1.cmml"><mi id="S3.SS3.p2.9.m3.3.3.1.1.1.2" xref="S3.SS3.p2.9.m3.3.3.1.1.1.2.cmml">𝐜</mi><mn id="S3.SS3.p2.9.m3.3.3.1.1.1.3" xref="S3.SS3.p2.9.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p2.9.m3.4.4.2.2.4" xref="S3.SS3.p2.9.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS3.p2.9.m3.2.2" mathvariant="normal" xref="S3.SS3.p2.9.m3.2.2.cmml">…</mi><mo id="S3.SS3.p2.9.m3.4.4.2.2.5" xref="S3.SS3.p2.9.m3.4.4.2.3.cmml">,</mo><msub id="S3.SS3.p2.9.m3.4.4.2.2.2" xref="S3.SS3.p2.9.m3.4.4.2.2.2.cmml"><mi id="S3.SS3.p2.9.m3.4.4.2.2.2.2" xref="S3.SS3.p2.9.m3.4.4.2.2.2.2.cmml">𝐜</mi><mrow id="S3.SS3.p2.9.m3.1.1.1.3" xref="S3.SS3.p2.9.m3.1.1.1.2.cmml"><mo fence="true" id="S3.SS3.p2.9.m3.1.1.1.3.1" rspace="0em" xref="S3.SS3.p2.9.m3.1.1.1.2.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.9.m3.1.1.1.1" xref="S3.SS3.p2.9.m3.1.1.1.1.cmml">𝒞</mi><mo fence="true" id="S3.SS3.p2.9.m3.1.1.1.3.2" lspace="0em" xref="S3.SS3.p2.9.m3.1.1.1.2.1.cmml">∣</mo></mrow></msub><mo id="S3.SS3.p2.9.m3.4.4.2.2.6" stretchy="false" xref="S3.SS3.p2.9.m3.4.4.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m3.4b"><apply id="S3.SS3.p2.9.m3.4.4.cmml" xref="S3.SS3.p2.9.m3.4.4"><eq id="S3.SS3.p2.9.m3.4.4.3.cmml" xref="S3.SS3.p2.9.m3.4.4.3"></eq><ci id="S3.SS3.p2.9.m3.4.4.4.cmml" xref="S3.SS3.p2.9.m3.4.4.4">𝐂</ci><set id="S3.SS3.p2.9.m3.4.4.2.3.cmml" xref="S3.SS3.p2.9.m3.4.4.2.2"><apply id="S3.SS3.p2.9.m3.3.3.1.1.1.cmml" xref="S3.SS3.p2.9.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m3.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.9.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m3.3.3.1.1.1.2.cmml" xref="S3.SS3.p2.9.m3.3.3.1.1.1.2">𝐜</ci><cn id="S3.SS3.p2.9.m3.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS3.p2.9.m3.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS3.p2.9.m3.2.2.cmml" xref="S3.SS3.p2.9.m3.2.2">…</ci><apply id="S3.SS3.p2.9.m3.4.4.2.2.2.cmml" xref="S3.SS3.p2.9.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m3.4.4.2.2.2.1.cmml" xref="S3.SS3.p2.9.m3.4.4.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.9.m3.4.4.2.2.2.2.cmml" xref="S3.SS3.p2.9.m3.4.4.2.2.2.2">𝐜</ci><apply id="S3.SS3.p2.9.m3.1.1.1.2.cmml" xref="S3.SS3.p2.9.m3.1.1.1.3"><csymbol cd="latexml" id="S3.SS3.p2.9.m3.1.1.1.2.1.cmml" xref="S3.SS3.p2.9.m3.1.1.1.3.1">delimited-∣∣</csymbol><ci id="S3.SS3.p2.9.m3.1.1.1.1.cmml" xref="S3.SS3.p2.9.m3.1.1.1.1">𝒞</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m3.4c">\mathbf{C}=\{\mathbf{c}_{1},\dots,\mathbf{c}_{\mid\mathcal{C}\mid}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m3.4d">bold_C = { bold_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_c start_POSTSUBSCRIPT ∣ caligraphic_C ∣ end_POSTSUBSCRIPT }</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.4">Next, we first normalize the initial item embedding <math alttext="\mathbf{v}^{(0)}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msubsup id="S3.SS3.p3.1.m1.1.2" xref="S3.SS3.p3.1.m1.1.2.cmml"><mi id="S3.SS3.p3.1.m1.1.2.2.2" xref="S3.SS3.p3.1.m1.1.2.2.2.cmml">𝐯</mi><mi id="S3.SS3.p3.1.m1.1.2.3" xref="S3.SS3.p3.1.m1.1.2.3.cmml">k</mi><mrow id="S3.SS3.p3.1.m1.1.1.1.3" xref="S3.SS3.p3.1.m1.1.2.cmml"><mo id="S3.SS3.p3.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.1.m1.1.2.cmml">(</mo><mn id="S3.SS3.p3.1.m1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.cmml">0</mn><mo id="S3.SS3.p3.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.2">subscript</csymbol><apply id="S3.SS3.p3.1.m1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.2.2.1.cmml" xref="S3.SS3.p3.1.m1.1.2">superscript</csymbol><ci id="S3.SS3.p3.1.m1.1.2.2.2.cmml" xref="S3.SS3.p3.1.m1.1.2.2.2">𝐯</ci><cn id="S3.SS3.p3.1.m1.1.1.1.1.cmml" type="integer" xref="S3.SS3.p3.1.m1.1.1.1.1">0</cn></apply><ci id="S3.SS3.p3.1.m1.1.2.3.cmml" xref="S3.SS3.p3.1.m1.1.2.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\mathbf{v}^{(0)}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">bold_v start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and the cluster prompt <math alttext="\mathbf{c}_{m}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">𝐜</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝐜</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\mathbf{c}_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">bold_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> to ensure balanced contributions. This step prevents the cluster prompt from overwhelming the item embedding and enables the model to learn balanced information. The normalized item embedding <math alttext="\mathbf{\hat{v}}^{(0)}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><msubsup id="S3.SS3.p3.3.m3.1.2" xref="S3.SS3.p3.3.m3.1.2.cmml"><mover accent="true" id="S3.SS3.p3.3.m3.1.2.2.2" xref="S3.SS3.p3.3.m3.1.2.2.2.cmml"><mi id="S3.SS3.p3.3.m3.1.2.2.2.2" xref="S3.SS3.p3.3.m3.1.2.2.2.2.cmml">𝐯</mi><mo id="S3.SS3.p3.3.m3.1.2.2.2.1" xref="S3.SS3.p3.3.m3.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.3.m3.1.2.3" xref="S3.SS3.p3.3.m3.1.2.3.cmml">k</mi><mrow id="S3.SS3.p3.3.m3.1.1.1.3" xref="S3.SS3.p3.3.m3.1.2.cmml"><mo id="S3.SS3.p3.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.3.m3.1.2.cmml">(</mo><mn id="S3.SS3.p3.3.m3.1.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.1.cmml">0</mn><mo id="S3.SS3.p3.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.2.cmml" xref="S3.SS3.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.2">subscript</csymbol><apply id="S3.SS3.p3.3.m3.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.2.2.1.cmml" xref="S3.SS3.p3.3.m3.1.2">superscript</csymbol><apply id="S3.SS3.p3.3.m3.1.2.2.2.cmml" xref="S3.SS3.p3.3.m3.1.2.2.2"><ci id="S3.SS3.p3.3.m3.1.2.2.2.1.cmml" xref="S3.SS3.p3.3.m3.1.2.2.2.1">^</ci><ci id="S3.SS3.p3.3.m3.1.2.2.2.2.cmml" xref="S3.SS3.p3.3.m3.1.2.2.2.2">𝐯</ci></apply><cn id="S3.SS3.p3.3.m3.1.1.1.1.cmml" type="integer" xref="S3.SS3.p3.3.m3.1.1.1.1">0</cn></apply><ci id="S3.SS3.p3.3.m3.1.2.3.cmml" xref="S3.SS3.p3.3.m3.1.2.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\mathbf{\hat{v}}^{(0)}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">over^ start_ARG bold_v end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and normalized cluster prompt <math alttext="\mathbf{\hat{c}}_{m}" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.1"><semantics id="S3.SS3.p3.4.m4.1a"><msub id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mover accent="true" id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2.2" xref="S3.SS3.p3.4.m4.1.1.2.2.cmml">𝐜</mi><mo id="S3.SS3.p3.4.m4.1.1.2.1" xref="S3.SS3.p3.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">subscript</csymbol><apply id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2"><ci id="S3.SS3.p3.4.m4.1.1.2.1.cmml" xref="S3.SS3.p3.4.m4.1.1.2.1">^</ci><ci id="S3.SS3.p3.4.m4.1.1.2.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2.2">𝐜</ci></apply><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\mathbf{\hat{c}}_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.1d">over^ start_ARG bold_c end_ARG start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> are then combined using a self-gating mechanism:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\psi(\mathbf{\hat{v}}^{(0)}_{k})=g_{k}\cdot\mathbf{\hat{v}}^{(0)}_{k}+(1-g_{k}%
)\cdot\mathbf{\hat{c}}_{m}," class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.3.cmml">ψ</mi><mo id="S3.E4.m1.3.3.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E4.m1.3.3.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E4.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.2.cmml">𝐯</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.cmml">k</mi><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mn id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">0</mn><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml"><mrow id="S3.E4.m1.3.3.1.1.2.3" xref="S3.E4.m1.3.3.1.1.2.3.cmml"><msub id="S3.E4.m1.3.3.1.1.2.3.2" xref="S3.E4.m1.3.3.1.1.2.3.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.3.2.2" xref="S3.E4.m1.3.3.1.1.2.3.2.2.cmml">g</mi><mi id="S3.E4.m1.3.3.1.1.2.3.2.3" xref="S3.E4.m1.3.3.1.1.2.3.2.3.cmml">k</mi></msub><mo id="S3.E4.m1.3.3.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.3.3.1.1.2.3.1.cmml">⋅</mo><msubsup id="S3.E4.m1.3.3.1.1.2.3.3" xref="S3.E4.m1.3.3.1.1.2.3.3.cmml"><mover accent="true" id="S3.E4.m1.3.3.1.1.2.3.3.2.2" xref="S3.E4.m1.3.3.1.1.2.3.3.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.3.3.2.2.2" xref="S3.E4.m1.3.3.1.1.2.3.3.2.2.2.cmml">𝐯</mi><mo id="S3.E4.m1.3.3.1.1.2.3.3.2.2.1" xref="S3.E4.m1.3.3.1.1.2.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.3.3.1.1.2.3.3.3" xref="S3.E4.m1.3.3.1.1.2.3.3.3.cmml">k</mi><mrow id="S3.E4.m1.2.2.1.3" xref="S3.E4.m1.3.3.1.1.2.3.3.cmml"><mo id="S3.E4.m1.2.2.1.3.1" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.3.3.cmml">(</mo><mn id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">0</mn><mo id="S3.E4.m1.2.2.1.3.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.3.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E4.m1.3.3.1.1.2.2" xref="S3.E4.m1.3.3.1.1.2.2.cmml">+</mo><mrow id="S3.E4.m1.3.3.1.1.2.1" xref="S3.E4.m1.3.3.1.1.2.1.cmml"><mrow id="S3.E4.m1.3.3.1.1.2.1.1.1" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.2.1.1.1.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.2.1.1.1.1" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.cmml"><mn id="S3.E4.m1.3.3.1.1.2.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.3.3.1.1.2.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.2.cmml">g</mi><mi id="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E4.m1.3.3.1.1.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E4.m1.3.3.1.1.2.1.2" rspace="0.222em" xref="S3.E4.m1.3.3.1.1.2.1.2.cmml">⋅</mo><msub id="S3.E4.m1.3.3.1.1.2.1.3" xref="S3.E4.m1.3.3.1.1.2.1.3.cmml"><mover accent="true" id="S3.E4.m1.3.3.1.1.2.1.3.2" xref="S3.E4.m1.3.3.1.1.2.1.3.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.1.3.2.2" xref="S3.E4.m1.3.3.1.1.2.1.3.2.2.cmml">𝐜</mi><mo id="S3.E4.m1.3.3.1.1.2.1.3.2.1" xref="S3.E4.m1.3.3.1.1.2.1.3.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.3.3.1.1.2.1.3.3" xref="S3.E4.m1.3.3.1.1.2.1.3.3.cmml">m</mi></msub></mrow></mrow></mrow><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"></eq><apply id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><times id="S3.E4.m1.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.2"></times><ci id="S3.E4.m1.3.3.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3">𝜓</ci><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.2"><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.2.2">𝐯</ci></apply><cn id="S3.E4.m1.1.1.1.1.cmml" type="integer" xref="S3.E4.m1.1.1.1.1">0</cn></apply><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"><plus id="S3.E4.m1.3.3.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2"></plus><apply id="S3.E4.m1.3.3.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.3"><ci id="S3.E4.m1.3.3.1.1.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.3.1">⋅</ci><apply id="S3.E4.m1.3.3.1.1.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.3.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.2.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.3.2.2">𝑔</ci><ci id="S3.E4.m1.3.3.1.1.2.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.3.2.3">𝑘</ci></apply><apply id="S3.E4.m1.3.3.1.1.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.3.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.3.3">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.2.3.3.2.cmml" xref="S3.E4.m1.3.3.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.3.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.3.3">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.2.3.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.3.3.2.2"><ci id="S3.E4.m1.3.3.1.1.2.3.3.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.3.3.2.2.1">^</ci><ci id="S3.E4.m1.3.3.1.1.2.3.3.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.3.3.2.2.2">𝐯</ci></apply><cn id="S3.E4.m1.2.2.1.1.cmml" type="integer" xref="S3.E4.m1.2.2.1.1">0</cn></apply><ci id="S3.E4.m1.3.3.1.1.2.3.3.3.cmml" xref="S3.E4.m1.3.3.1.1.2.3.3.3">𝑘</ci></apply></apply><apply id="S3.E4.m1.3.3.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1"><ci id="S3.E4.m1.3.3.1.1.2.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2.1.2">⋅</ci><apply id="S3.E4.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1"><minus id="S3.E4.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.1"></minus><cn id="S3.E4.m1.3.3.1.1.2.1.1.1.1.2.cmml" type="integer" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.2">1</cn><apply id="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.2">𝑔</ci><ci id="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.2.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E4.m1.3.3.1.1.2.1.3.cmml" xref="S3.E4.m1.3.3.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1.3">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.2.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.2.1.3.2"><ci id="S3.E4.m1.3.3.1.1.2.1.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1.3.2.1">^</ci><ci id="S3.E4.m1.3.3.1.1.2.1.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.1.3.2.2">𝐜</ci></apply><ci id="S3.E4.m1.3.3.1.1.2.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.2.1.3.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\psi(\mathbf{\hat{v}}^{(0)}_{k})=g_{k}\cdot\mathbf{\hat{v}}^{(0)}_{k}+(1-g_{k}%
)\cdot\mathbf{\hat{c}}_{m},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">italic_ψ ( over^ start_ARG bold_v end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) = italic_g start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⋅ over^ start_ARG bold_v end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + ( 1 - italic_g start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ⋅ over^ start_ARG bold_c end_ARG start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.8">where <math alttext="\hat{v}^{(0)}_{k}=\frac{v^{(0)}_{k}}{\|v^{(0)}_{k}\|}" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m1.4"><semantics id="S3.SS3.p3.5.m1.4a"><mrow id="S3.SS3.p3.5.m1.4.5" xref="S3.SS3.p3.5.m1.4.5.cmml"><msubsup id="S3.SS3.p3.5.m1.4.5.2" xref="S3.SS3.p3.5.m1.4.5.2.cmml"><mover accent="true" id="S3.SS3.p3.5.m1.4.5.2.2.2" xref="S3.SS3.p3.5.m1.4.5.2.2.2.cmml"><mi id="S3.SS3.p3.5.m1.4.5.2.2.2.2" xref="S3.SS3.p3.5.m1.4.5.2.2.2.2.cmml">v</mi><mo id="S3.SS3.p3.5.m1.4.5.2.2.2.1" xref="S3.SS3.p3.5.m1.4.5.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.5.m1.4.5.2.3" xref="S3.SS3.p3.5.m1.4.5.2.3.cmml">k</mi><mrow id="S3.SS3.p3.5.m1.1.1.1.3" xref="S3.SS3.p3.5.m1.4.5.2.cmml"><mo id="S3.SS3.p3.5.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.5.m1.4.5.2.cmml">(</mo><mn id="S3.SS3.p3.5.m1.1.1.1.1" xref="S3.SS3.p3.5.m1.1.1.1.1.cmml">0</mn><mo id="S3.SS3.p3.5.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.5.m1.4.5.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p3.5.m1.4.5.1" xref="S3.SS3.p3.5.m1.4.5.1.cmml">=</mo><mfrac id="S3.SS3.p3.5.m1.4.4" xref="S3.SS3.p3.5.m1.4.4.cmml"><msubsup id="S3.SS3.p3.5.m1.2.2.1" xref="S3.SS3.p3.5.m1.2.2.1.cmml"><mi id="S3.SS3.p3.5.m1.2.2.1.3.2" xref="S3.SS3.p3.5.m1.2.2.1.3.2.cmml">v</mi><mi id="S3.SS3.p3.5.m1.2.2.1.4" xref="S3.SS3.p3.5.m1.2.2.1.4.cmml">k</mi><mrow id="S3.SS3.p3.5.m1.2.2.1.1.1.3" xref="S3.SS3.p3.5.m1.2.2.1.cmml"><mo id="S3.SS3.p3.5.m1.2.2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.5.m1.2.2.1.cmml">(</mo><mn id="S3.SS3.p3.5.m1.2.2.1.1.1.1" xref="S3.SS3.p3.5.m1.2.2.1.1.1.1.cmml">0</mn><mo id="S3.SS3.p3.5.m1.2.2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.5.m1.2.2.1.cmml">)</mo></mrow></msubsup><mrow id="S3.SS3.p3.5.m1.4.4.3.2" xref="S3.SS3.p3.5.m1.4.4.3.3.cmml"><mo id="S3.SS3.p3.5.m1.4.4.3.2.2" stretchy="false" xref="S3.SS3.p3.5.m1.4.4.3.3.1.cmml">‖</mo><msubsup id="S3.SS3.p3.5.m1.4.4.3.2.1" xref="S3.SS3.p3.5.m1.4.4.3.2.1.cmml"><mi id="S3.SS3.p3.5.m1.4.4.3.2.1.2.2" xref="S3.SS3.p3.5.m1.4.4.3.2.1.2.2.cmml">v</mi><mi id="S3.SS3.p3.5.m1.4.4.3.2.1.3" xref="S3.SS3.p3.5.m1.4.4.3.2.1.3.cmml">k</mi><mrow id="S3.SS3.p3.5.m1.3.3.2.1.1.3" xref="S3.SS3.p3.5.m1.4.4.3.2.1.cmml"><mo id="S3.SS3.p3.5.m1.3.3.2.1.1.3.1" stretchy="false" xref="S3.SS3.p3.5.m1.4.4.3.2.1.cmml">(</mo><mn id="S3.SS3.p3.5.m1.3.3.2.1.1.1" xref="S3.SS3.p3.5.m1.3.3.2.1.1.1.cmml">0</mn><mo id="S3.SS3.p3.5.m1.3.3.2.1.1.3.2" stretchy="false" xref="S3.SS3.p3.5.m1.4.4.3.2.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p3.5.m1.4.4.3.2.3" stretchy="false" xref="S3.SS3.p3.5.m1.4.4.3.3.1.cmml">‖</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m1.4b"><apply id="S3.SS3.p3.5.m1.4.5.cmml" xref="S3.SS3.p3.5.m1.4.5"><eq id="S3.SS3.p3.5.m1.4.5.1.cmml" xref="S3.SS3.p3.5.m1.4.5.1"></eq><apply id="S3.SS3.p3.5.m1.4.5.2.cmml" xref="S3.SS3.p3.5.m1.4.5.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m1.4.5.2.1.cmml" xref="S3.SS3.p3.5.m1.4.5.2">subscript</csymbol><apply id="S3.SS3.p3.5.m1.4.5.2.2.cmml" xref="S3.SS3.p3.5.m1.4.5.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m1.4.5.2.2.1.cmml" xref="S3.SS3.p3.5.m1.4.5.2">superscript</csymbol><apply id="S3.SS3.p3.5.m1.4.5.2.2.2.cmml" xref="S3.SS3.p3.5.m1.4.5.2.2.2"><ci id="S3.SS3.p3.5.m1.4.5.2.2.2.1.cmml" xref="S3.SS3.p3.5.m1.4.5.2.2.2.1">^</ci><ci id="S3.SS3.p3.5.m1.4.5.2.2.2.2.cmml" xref="S3.SS3.p3.5.m1.4.5.2.2.2.2">𝑣</ci></apply><cn id="S3.SS3.p3.5.m1.1.1.1.1.cmml" type="integer" xref="S3.SS3.p3.5.m1.1.1.1.1">0</cn></apply><ci id="S3.SS3.p3.5.m1.4.5.2.3.cmml" xref="S3.SS3.p3.5.m1.4.5.2.3">𝑘</ci></apply><apply id="S3.SS3.p3.5.m1.4.4.cmml" xref="S3.SS3.p3.5.m1.4.4"><divide id="S3.SS3.p3.5.m1.4.4.4.cmml" xref="S3.SS3.p3.5.m1.4.4"></divide><apply id="S3.SS3.p3.5.m1.2.2.1.cmml" xref="S3.SS3.p3.5.m1.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m1.2.2.1.2.cmml" xref="S3.SS3.p3.5.m1.2.2.1">subscript</csymbol><apply id="S3.SS3.p3.5.m1.2.2.1.3.cmml" xref="S3.SS3.p3.5.m1.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m1.2.2.1.3.1.cmml" xref="S3.SS3.p3.5.m1.2.2.1">superscript</csymbol><ci id="S3.SS3.p3.5.m1.2.2.1.3.2.cmml" xref="S3.SS3.p3.5.m1.2.2.1.3.2">𝑣</ci><cn id="S3.SS3.p3.5.m1.2.2.1.1.1.1.cmml" type="integer" xref="S3.SS3.p3.5.m1.2.2.1.1.1.1">0</cn></apply><ci id="S3.SS3.p3.5.m1.2.2.1.4.cmml" xref="S3.SS3.p3.5.m1.2.2.1.4">𝑘</ci></apply><apply id="S3.SS3.p3.5.m1.4.4.3.3.cmml" xref="S3.SS3.p3.5.m1.4.4.3.2"><csymbol cd="latexml" id="S3.SS3.p3.5.m1.4.4.3.3.1.cmml" xref="S3.SS3.p3.5.m1.4.4.3.2.2">norm</csymbol><apply id="S3.SS3.p3.5.m1.4.4.3.2.1.cmml" xref="S3.SS3.p3.5.m1.4.4.3.2.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m1.4.4.3.2.1.1.cmml" xref="S3.SS3.p3.5.m1.4.4.3.2.1">subscript</csymbol><apply id="S3.SS3.p3.5.m1.4.4.3.2.1.2.cmml" xref="S3.SS3.p3.5.m1.4.4.3.2.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m1.4.4.3.2.1.2.1.cmml" xref="S3.SS3.p3.5.m1.4.4.3.2.1">superscript</csymbol><ci id="S3.SS3.p3.5.m1.4.4.3.2.1.2.2.cmml" xref="S3.SS3.p3.5.m1.4.4.3.2.1.2.2">𝑣</ci><cn id="S3.SS3.p3.5.m1.3.3.2.1.1.1.cmml" type="integer" xref="S3.SS3.p3.5.m1.3.3.2.1.1.1">0</cn></apply><ci id="S3.SS3.p3.5.m1.4.4.3.2.1.3.cmml" xref="S3.SS3.p3.5.m1.4.4.3.2.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m1.4c">\hat{v}^{(0)}_{k}=\frac{v^{(0)}_{k}}{\|v^{(0)}_{k}\|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m1.4d">over^ start_ARG italic_v end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = divide start_ARG italic_v start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG start_ARG ∥ italic_v start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ end_ARG</annotation></semantics></math> and <math alttext="\hat{c}_{m}=\frac{c_{m}}{\|c_{m}\|}" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m2.1"><semantics id="S3.SS3.p3.6.m2.1a"><mrow id="S3.SS3.p3.6.m2.1.2" xref="S3.SS3.p3.6.m2.1.2.cmml"><msub id="S3.SS3.p3.6.m2.1.2.2" xref="S3.SS3.p3.6.m2.1.2.2.cmml"><mover accent="true" id="S3.SS3.p3.6.m2.1.2.2.2" xref="S3.SS3.p3.6.m2.1.2.2.2.cmml"><mi id="S3.SS3.p3.6.m2.1.2.2.2.2" xref="S3.SS3.p3.6.m2.1.2.2.2.2.cmml">c</mi><mo id="S3.SS3.p3.6.m2.1.2.2.2.1" xref="S3.SS3.p3.6.m2.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.6.m2.1.2.2.3" xref="S3.SS3.p3.6.m2.1.2.2.3.cmml">m</mi></msub><mo id="S3.SS3.p3.6.m2.1.2.1" xref="S3.SS3.p3.6.m2.1.2.1.cmml">=</mo><mfrac id="S3.SS3.p3.6.m2.1.1" xref="S3.SS3.p3.6.m2.1.1.cmml"><msub id="S3.SS3.p3.6.m2.1.1.3" xref="S3.SS3.p3.6.m2.1.1.3.cmml"><mi id="S3.SS3.p3.6.m2.1.1.3.2" xref="S3.SS3.p3.6.m2.1.1.3.2.cmml">c</mi><mi id="S3.SS3.p3.6.m2.1.1.3.3" xref="S3.SS3.p3.6.m2.1.1.3.3.cmml">m</mi></msub><mrow id="S3.SS3.p3.6.m2.1.1.1.1" xref="S3.SS3.p3.6.m2.1.1.1.2.cmml"><mo id="S3.SS3.p3.6.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.6.m2.1.1.1.2.1.cmml">‖</mo><msub id="S3.SS3.p3.6.m2.1.1.1.1.1" xref="S3.SS3.p3.6.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.6.m2.1.1.1.1.1.2" xref="S3.SS3.p3.6.m2.1.1.1.1.1.2.cmml">c</mi><mi id="S3.SS3.p3.6.m2.1.1.1.1.1.3" xref="S3.SS3.p3.6.m2.1.1.1.1.1.3.cmml">m</mi></msub><mo id="S3.SS3.p3.6.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.6.m2.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m2.1b"><apply id="S3.SS3.p3.6.m2.1.2.cmml" xref="S3.SS3.p3.6.m2.1.2"><eq id="S3.SS3.p3.6.m2.1.2.1.cmml" xref="S3.SS3.p3.6.m2.1.2.1"></eq><apply id="S3.SS3.p3.6.m2.1.2.2.cmml" xref="S3.SS3.p3.6.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m2.1.2.2.1.cmml" xref="S3.SS3.p3.6.m2.1.2.2">subscript</csymbol><apply id="S3.SS3.p3.6.m2.1.2.2.2.cmml" xref="S3.SS3.p3.6.m2.1.2.2.2"><ci id="S3.SS3.p3.6.m2.1.2.2.2.1.cmml" xref="S3.SS3.p3.6.m2.1.2.2.2.1">^</ci><ci id="S3.SS3.p3.6.m2.1.2.2.2.2.cmml" xref="S3.SS3.p3.6.m2.1.2.2.2.2">𝑐</ci></apply><ci id="S3.SS3.p3.6.m2.1.2.2.3.cmml" xref="S3.SS3.p3.6.m2.1.2.2.3">𝑚</ci></apply><apply id="S3.SS3.p3.6.m2.1.1.cmml" xref="S3.SS3.p3.6.m2.1.1"><divide id="S3.SS3.p3.6.m2.1.1.2.cmml" xref="S3.SS3.p3.6.m2.1.1"></divide><apply id="S3.SS3.p3.6.m2.1.1.3.cmml" xref="S3.SS3.p3.6.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m2.1.1.3.1.cmml" xref="S3.SS3.p3.6.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.6.m2.1.1.3.2.cmml" xref="S3.SS3.p3.6.m2.1.1.3.2">𝑐</ci><ci id="S3.SS3.p3.6.m2.1.1.3.3.cmml" xref="S3.SS3.p3.6.m2.1.1.3.3">𝑚</ci></apply><apply id="S3.SS3.p3.6.m2.1.1.1.2.cmml" xref="S3.SS3.p3.6.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p3.6.m2.1.1.1.2.1.cmml" xref="S3.SS3.p3.6.m2.1.1.1.1.2">norm</csymbol><apply id="S3.SS3.p3.6.m2.1.1.1.1.1.cmml" xref="S3.SS3.p3.6.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.6.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.6.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.6.m2.1.1.1.1.1.2">𝑐</ci><ci id="S3.SS3.p3.6.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.6.m2.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m2.1c">\hat{c}_{m}=\frac{c_{m}}{\|c_{m}\|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m2.1d">over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = divide start_ARG italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_ARG start_ARG ∥ italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∥ end_ARG</annotation></semantics></math> represent the normalized versions of the initial item embedding and cluster prompt, respectively, and <math alttext="\psi" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m3.1"><semantics id="S3.SS3.p3.7.m3.1a"><mi id="S3.SS3.p3.7.m3.1.1" xref="S3.SS3.p3.7.m3.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m3.1b"><ci id="S3.SS3.p3.7.m3.1.1.cmml" xref="S3.SS3.p3.7.m3.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m3.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m3.1d">italic_ψ</annotation></semantics></math> denotes the prompting function. The scalar <math alttext="g_{k}" class="ltx_Math" display="inline" id="S3.SS3.p3.8.m4.1"><semantics id="S3.SS3.p3.8.m4.1a"><msub id="S3.SS3.p3.8.m4.1.1" xref="S3.SS3.p3.8.m4.1.1.cmml"><mi id="S3.SS3.p3.8.m4.1.1.2" xref="S3.SS3.p3.8.m4.1.1.2.cmml">g</mi><mi id="S3.SS3.p3.8.m4.1.1.3" xref="S3.SS3.p3.8.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m4.1b"><apply id="S3.SS3.p3.8.m4.1.1.cmml" xref="S3.SS3.p3.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m4.1.1.1.cmml" xref="S3.SS3.p3.8.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.8.m4.1.1.2.cmml" xref="S3.SS3.p3.8.m4.1.1.2">𝑔</ci><ci id="S3.SS3.p3.8.m4.1.1.3.cmml" xref="S3.SS3.p3.8.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m4.1c">g_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.8.m4.1d">italic_g start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a gating variable that controls the contribution of the item embedding and the cluster prompt. This self-gating mechanism dynamically balances the influence of both components based on their relevance, ensuring that the cluster prompt does not dominate and allowing the model to learn effectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">The set of prompted item embeddings for <math alttext="\tilde{\mathbf{V}}^{(0)}" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><msup id="S3.SS3.p4.1.m1.1.2" xref="S3.SS3.p4.1.m1.1.2.cmml"><mover accent="true" id="S3.SS3.p4.1.m1.1.2.2" xref="S3.SS3.p4.1.m1.1.2.2.cmml"><mi id="S3.SS3.p4.1.m1.1.2.2.2" xref="S3.SS3.p4.1.m1.1.2.2.2.cmml">𝐕</mi><mo id="S3.SS3.p4.1.m1.1.2.2.1" xref="S3.SS3.p4.1.m1.1.2.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.1.m1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.2.cmml"><mo id="S3.SS3.p4.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p4.1.m1.1.2.cmml">(</mo><mn id="S3.SS3.p4.1.m1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.cmml">0</mn><mo id="S3.SS3.p4.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p4.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2">superscript</csymbol><apply id="S3.SS3.p4.1.m1.1.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2"><ci id="S3.SS3.p4.1.m1.1.2.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2.2.1">~</ci><ci id="S3.SS3.p4.1.m1.1.2.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2.2">𝐕</ci></apply><cn id="S3.SS3.p4.1.m1.1.1.1.1.cmml" type="integer" xref="S3.SS3.p4.1.m1.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\tilde{\mathbf{V}}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">over~ start_ARG bold_V end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math> is defined as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\mathbf{V}}^{(0)}=\{\psi(\mathbf{\hat{v}}^{(0)}_{1}),\psi(\mathbf{\hat{%
v}}^{(0)}_{2}),\ldots,\psi(\mathbf{\hat{v}}^{(0)}_{\mid\mathcal{V}\mid})\}." class="ltx_Math" display="block" id="S3.E5.m1.7"><semantics id="S3.E5.m1.7a"><mrow id="S3.E5.m1.7.7.1" xref="S3.E5.m1.7.7.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1" xref="S3.E5.m1.7.7.1.1.cmml"><msup id="S3.E5.m1.7.7.1.1.5" xref="S3.E5.m1.7.7.1.1.5.cmml"><mover accent="true" id="S3.E5.m1.7.7.1.1.5.2" xref="S3.E5.m1.7.7.1.1.5.2.cmml"><mi id="S3.E5.m1.7.7.1.1.5.2.2" xref="S3.E5.m1.7.7.1.1.5.2.2.cmml">𝐕</mi><mo id="S3.E5.m1.7.7.1.1.5.2.1" xref="S3.E5.m1.7.7.1.1.5.2.1.cmml">~</mo></mover><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.5.cmml"><mo id="S3.E5.m1.1.1.1.3.1" stretchy="false" xref="S3.E5.m1.7.7.1.1.5.cmml">(</mo><mn id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">0</mn><mo id="S3.E5.m1.1.1.1.3.2" stretchy="false" xref="S3.E5.m1.7.7.1.1.5.cmml">)</mo></mrow></msup><mo id="S3.E5.m1.7.7.1.1.4" xref="S3.E5.m1.7.7.1.1.4.cmml">=</mo><mrow id="S3.E5.m1.7.7.1.1.3.3" xref="S3.E5.m1.7.7.1.1.3.4.cmml"><mo id="S3.E5.m1.7.7.1.1.3.3.4" stretchy="false" xref="S3.E5.m1.7.7.1.1.3.4.cmml">{</mo><mrow id="S3.E5.m1.7.7.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.1.3.cmml">ψ</mi><mo id="S3.E5.m1.7.7.1.1.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.7.7.1.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐯</mi><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">1</mn><mrow id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.2.2.1.3.1" stretchy="false" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mn id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml">0</mn><mo id="S3.E5.m1.2.2.1.3.2" stretchy="false" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.7.7.1.1.3.3.5" xref="S3.E5.m1.7.7.1.1.3.4.cmml">,</mo><mrow id="S3.E5.m1.7.7.1.1.2.2.2" xref="S3.E5.m1.7.7.1.1.2.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.2.2.2.3" xref="S3.E5.m1.7.7.1.1.2.2.2.3.cmml">ψ</mi><mo id="S3.E5.m1.7.7.1.1.2.2.2.2" xref="S3.E5.m1.7.7.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S3.E5.m1.7.7.1.1.2.2.2.1.1" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml"><mo id="S3.E5.m1.7.7.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2.2" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2.2.cmml">𝐯</mi><mo id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2.1" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.3" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.3.cmml">2</mn><mrow id="S3.E5.m1.3.3.1.3" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml"><mo id="S3.E5.m1.3.3.1.3.1" stretchy="false" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml">(</mo><mn id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml">0</mn><mo id="S3.E5.m1.3.3.1.3.2" stretchy="false" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.7.7.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.7.7.1.1.3.3.6" xref="S3.E5.m1.7.7.1.1.3.4.cmml">,</mo><mi id="S3.E5.m1.6.6" mathvariant="normal" xref="S3.E5.m1.6.6.cmml">…</mi><mo id="S3.E5.m1.7.7.1.1.3.3.7" xref="S3.E5.m1.7.7.1.1.3.4.cmml">,</mo><mrow id="S3.E5.m1.7.7.1.1.3.3.3" xref="S3.E5.m1.7.7.1.1.3.3.3.cmml"><mi id="S3.E5.m1.7.7.1.1.3.3.3.3" xref="S3.E5.m1.7.7.1.1.3.3.3.3.cmml">ψ</mi><mo id="S3.E5.m1.7.7.1.1.3.3.3.2" xref="S3.E5.m1.7.7.1.1.3.3.3.2.cmml">⁢</mo><mrow id="S3.E5.m1.7.7.1.1.3.3.3.1.1" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.cmml"><mo id="S3.E5.m1.7.7.1.1.3.3.3.1.1.2" stretchy="false" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2.2" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2.2.cmml">𝐯</mi><mo id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2.1" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.E5.m1.5.5.1.3" xref="S3.E5.m1.5.5.1.2.cmml"><mo fence="true" id="S3.E5.m1.5.5.1.3.1" rspace="0em" xref="S3.E5.m1.5.5.1.2.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml">𝒱</mi><mo fence="true" id="S3.E5.m1.5.5.1.3.2" lspace="0em" xref="S3.E5.m1.5.5.1.2.1.cmml">∣</mo></mrow><mrow id="S3.E5.m1.4.4.1.3" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.cmml"><mo id="S3.E5.m1.4.4.1.3.1" stretchy="false" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.cmml">(</mo><mn id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.cmml">0</mn><mo id="S3.E5.m1.4.4.1.3.2" stretchy="false" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.7.7.1.1.3.3.3.1.1.3" stretchy="false" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.7.7.1.1.3.3.8" stretchy="false" xref="S3.E5.m1.7.7.1.1.3.4.cmml">}</mo></mrow></mrow><mo id="S3.E5.m1.7.7.1.2" lspace="0em" xref="S3.E5.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.7b"><apply id="S3.E5.m1.7.7.1.1.cmml" xref="S3.E5.m1.7.7.1"><eq id="S3.E5.m1.7.7.1.1.4.cmml" xref="S3.E5.m1.7.7.1.1.4"></eq><apply id="S3.E5.m1.7.7.1.1.5.cmml" xref="S3.E5.m1.7.7.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.5.1.cmml" xref="S3.E5.m1.7.7.1.1.5">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.5.2.cmml" xref="S3.E5.m1.7.7.1.1.5.2"><ci id="S3.E5.m1.7.7.1.1.5.2.1.cmml" xref="S3.E5.m1.7.7.1.1.5.2.1">~</ci><ci id="S3.E5.m1.7.7.1.1.5.2.2.cmml" xref="S3.E5.m1.7.7.1.1.5.2.2">𝐕</ci></apply><cn id="S3.E5.m1.1.1.1.1.cmml" type="integer" xref="S3.E5.m1.1.1.1.1">0</cn></apply><set id="S3.E5.m1.7.7.1.1.3.4.cmml" xref="S3.E5.m1.7.7.1.1.3.3"><apply id="S3.E5.m1.7.7.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1"><times id="S3.E5.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.2"></times><ci id="S3.E5.m1.7.7.1.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.3">𝜓</ci><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.2.2">𝐯</ci></apply><cn id="S3.E5.m1.2.2.1.1.cmml" type="integer" xref="S3.E5.m1.2.2.1.1">0</cn></apply><cn id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E5.m1.7.7.1.1.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2"><times id="S3.E5.m1.7.7.1.1.2.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.2"></times><ci id="S3.E5.m1.7.7.1.1.2.2.2.3.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.3">𝜓</ci><apply id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1">subscript</csymbol><apply id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2"><ci id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2.1">^</ci><ci id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.2.2.2">𝐯</ci></apply><cn id="S3.E5.m1.3.3.1.1.cmml" type="integer" xref="S3.E5.m1.3.3.1.1">0</cn></apply><cn id="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.7.7.1.1.2.2.2.1.1.1.3">2</cn></apply></apply><ci id="S3.E5.m1.6.6.cmml" xref="S3.E5.m1.6.6">…</ci><apply id="S3.E5.m1.7.7.1.1.3.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3"><times id="S3.E5.m1.7.7.1.1.3.3.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.2"></times><ci id="S3.E5.m1.7.7.1.1.3.3.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.3">𝜓</ci><apply id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1">subscript</csymbol><apply id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2"><ci id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2.1">^</ci><ci id="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.1.1.1.2.2.2">𝐯</ci></apply><cn id="S3.E5.m1.4.4.1.1.cmml" type="integer" xref="S3.E5.m1.4.4.1.1">0</cn></apply><apply id="S3.E5.m1.5.5.1.2.cmml" xref="S3.E5.m1.5.5.1.3"><csymbol cd="latexml" id="S3.E5.m1.5.5.1.2.1.cmml" xref="S3.E5.m1.5.5.1.3.1">delimited-∣∣</csymbol><ci id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1.1">𝒱</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.7c">\tilde{\mathbf{V}}^{(0)}=\{\psi(\mathbf{\hat{v}}^{(0)}_{1}),\psi(\mathbf{\hat{%
v}}^{(0)}_{2}),\ldots,\psi(\mathbf{\hat{v}}^{(0)}_{\mid\mathcal{V}\mid})\}.</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.7d">over~ start_ARG bold_V end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT = { italic_ψ ( over^ start_ARG bold_v end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , italic_ψ ( over^ start_ARG bold_v end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , … , italic_ψ ( over^ start_ARG bold_v end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∣ caligraphic_V ∣ end_POSTSUBSCRIPT ) } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1">During the test phase, sessions in test dataset may contain unseen items. If a session includes both unseen items and items that are present in the global graph, new edges are added to the global graph to integrate the unseen items. If all items in a session are unseen, we assign the most frequent cluster to these items.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.3">Prompted item embeddings are passed through the existing SBR model during training, providing information about item relationships. Formally, given sessions <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS3.p6.1.m1.1"><semantics id="S3.SS3.p6.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><ci id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.1.m1.1d">caligraphic_S</annotation></semantics></math> and prompted item embeddings <math alttext="\tilde{\mathbf{V}}^{(0)}" class="ltx_Math" display="inline" id="S3.SS3.p6.2.m2.1"><semantics id="S3.SS3.p6.2.m2.1a"><msup id="S3.SS3.p6.2.m2.1.2" xref="S3.SS3.p6.2.m2.1.2.cmml"><mover accent="true" id="S3.SS3.p6.2.m2.1.2.2" xref="S3.SS3.p6.2.m2.1.2.2.cmml"><mi id="S3.SS3.p6.2.m2.1.2.2.2" xref="S3.SS3.p6.2.m2.1.2.2.2.cmml">𝐕</mi><mo id="S3.SS3.p6.2.m2.1.2.2.1" xref="S3.SS3.p6.2.m2.1.2.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p6.2.m2.1.1.1.3" xref="S3.SS3.p6.2.m2.1.2.cmml"><mo id="S3.SS3.p6.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p6.2.m2.1.2.cmml">(</mo><mn id="S3.SS3.p6.2.m2.1.1.1.1" xref="S3.SS3.p6.2.m2.1.1.1.1.cmml">0</mn><mo id="S3.SS3.p6.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p6.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.1b"><apply id="S3.SS3.p6.2.m2.1.2.cmml" xref="S3.SS3.p6.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p6.2.m2.1.2.1.cmml" xref="S3.SS3.p6.2.m2.1.2">superscript</csymbol><apply id="S3.SS3.p6.2.m2.1.2.2.cmml" xref="S3.SS3.p6.2.m2.1.2.2"><ci id="S3.SS3.p6.2.m2.1.2.2.1.cmml" xref="S3.SS3.p6.2.m2.1.2.2.1">~</ci><ci id="S3.SS3.p6.2.m2.1.2.2.2.cmml" xref="S3.SS3.p6.2.m2.1.2.2.2">𝐕</ci></apply><cn id="S3.SS3.p6.2.m2.1.1.1.1.cmml" type="integer" xref="S3.SS3.p6.2.m2.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.1c">\tilde{\mathbf{V}}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.2.m2.1d">over~ start_ARG bold_V end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math>, we apply the SBR model <math alttext="f" class="ltx_Math" display="inline" id="S3.SS3.p6.3.m3.1"><semantics id="S3.SS3.p6.3.m3.1a"><mi id="S3.SS3.p6.3.m3.1.1" xref="S3.SS3.p6.3.m3.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.3.m3.1b"><ci id="S3.SS3.p6.3.m3.1.1.cmml" xref="S3.SS3.p6.3.m3.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.3.m3.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.3.m3.1d">italic_f</annotation></semantics></math> to obtain session embeddings:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{S},\mathbf{V}=f(\mathcal{S},\tilde{\mathbf{V}}^{(0)})," class="ltx_Math" display="block" id="S3.E6.m1.5"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1.3.2" xref="S3.E6.m1.5.5.1.1.3.1.cmml"><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">𝐒</mi><mo id="S3.E6.m1.5.5.1.1.3.2.1" xref="S3.E6.m1.5.5.1.1.3.1.cmml">,</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">𝐕</mi></mrow><mo id="S3.E6.m1.5.5.1.1.2" xref="S3.E6.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.5.5.1.1.1" xref="S3.E6.m1.5.5.1.1.1.cmml"><mi id="S3.E6.m1.5.5.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.3.cmml">f</mi><mo id="S3.E6.m1.5.5.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E6.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">𝒮</mi><mo id="S3.E6.m1.5.5.1.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.2.cmml">,</mo><msup id="S3.E6.m1.5.5.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E6.m1.5.5.1.1.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.cmml">𝐕</mi><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.2.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.3.1" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mn id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">0</mn><mo id="S3.E6.m1.1.1.1.3.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E6.m1.5.5.1.1.1.1.1.4" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.5.5.1.2" xref="S3.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1"><eq id="S3.E6.m1.5.5.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.2"></eq><list id="S3.E6.m1.5.5.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3.2"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝐒</ci><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝐕</ci></list><apply id="S3.E6.m1.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1"><times id="S3.E6.m1.5.5.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.2"></times><ci id="S3.E6.m1.5.5.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.3">𝑓</ci><interval closure="open" id="S3.E6.m1.5.5.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1"><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝒮</ci><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2"><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.2">𝐕</ci></apply><cn id="S3.E6.m1.1.1.1.1.cmml" type="integer" xref="S3.E6.m1.1.1.1.1">0</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">\mathbf{S},\mathbf{V}=f(\mathcal{S},\tilde{\mathbf{V}}^{(0)}),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.5d">bold_S , bold_V = italic_f ( caligraphic_S , over~ start_ARG bold_V end_ARG start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p6.9">where <math alttext="\mathbf{S}=\{\mathbf{s}_{1},\mathbf{s}_{2},\cdots,\mathbf{s}_{\mid\mathcal{S}%
\mid}\}" class="ltx_Math" display="inline" id="S3.SS3.p6.4.m1.5"><semantics id="S3.SS3.p6.4.m1.5a"><mrow id="S3.SS3.p6.4.m1.5.5" xref="S3.SS3.p6.4.m1.5.5.cmml"><mi id="S3.SS3.p6.4.m1.5.5.5" xref="S3.SS3.p6.4.m1.5.5.5.cmml">𝐒</mi><mo id="S3.SS3.p6.4.m1.5.5.4" xref="S3.SS3.p6.4.m1.5.5.4.cmml">=</mo><mrow id="S3.SS3.p6.4.m1.5.5.3.3" xref="S3.SS3.p6.4.m1.5.5.3.4.cmml"><mo id="S3.SS3.p6.4.m1.5.5.3.3.4" stretchy="false" xref="S3.SS3.p6.4.m1.5.5.3.4.cmml">{</mo><msub id="S3.SS3.p6.4.m1.3.3.1.1.1" xref="S3.SS3.p6.4.m1.3.3.1.1.1.cmml"><mi id="S3.SS3.p6.4.m1.3.3.1.1.1.2" xref="S3.SS3.p6.4.m1.3.3.1.1.1.2.cmml">𝐬</mi><mn id="S3.SS3.p6.4.m1.3.3.1.1.1.3" xref="S3.SS3.p6.4.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p6.4.m1.5.5.3.3.5" xref="S3.SS3.p6.4.m1.5.5.3.4.cmml">,</mo><msub id="S3.SS3.p6.4.m1.4.4.2.2.2" xref="S3.SS3.p6.4.m1.4.4.2.2.2.cmml"><mi id="S3.SS3.p6.4.m1.4.4.2.2.2.2" xref="S3.SS3.p6.4.m1.4.4.2.2.2.2.cmml">𝐬</mi><mn id="S3.SS3.p6.4.m1.4.4.2.2.2.3" xref="S3.SS3.p6.4.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p6.4.m1.5.5.3.3.6" xref="S3.SS3.p6.4.m1.5.5.3.4.cmml">,</mo><mi id="S3.SS3.p6.4.m1.2.2" mathvariant="normal" xref="S3.SS3.p6.4.m1.2.2.cmml">⋯</mi><mo id="S3.SS3.p6.4.m1.5.5.3.3.7" xref="S3.SS3.p6.4.m1.5.5.3.4.cmml">,</mo><msub id="S3.SS3.p6.4.m1.5.5.3.3.3" xref="S3.SS3.p6.4.m1.5.5.3.3.3.cmml"><mi id="S3.SS3.p6.4.m1.5.5.3.3.3.2" xref="S3.SS3.p6.4.m1.5.5.3.3.3.2.cmml">𝐬</mi><mrow id="S3.SS3.p6.4.m1.1.1.1.3" xref="S3.SS3.p6.4.m1.1.1.1.2.cmml"><mo fence="true" id="S3.SS3.p6.4.m1.1.1.1.3.1" rspace="0em" xref="S3.SS3.p6.4.m1.1.1.1.2.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p6.4.m1.1.1.1.1" xref="S3.SS3.p6.4.m1.1.1.1.1.cmml">𝒮</mi><mo fence="true" id="S3.SS3.p6.4.m1.1.1.1.3.2" lspace="0em" xref="S3.SS3.p6.4.m1.1.1.1.2.1.cmml">∣</mo></mrow></msub><mo id="S3.SS3.p6.4.m1.5.5.3.3.8" stretchy="false" xref="S3.SS3.p6.4.m1.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.4.m1.5b"><apply id="S3.SS3.p6.4.m1.5.5.cmml" xref="S3.SS3.p6.4.m1.5.5"><eq id="S3.SS3.p6.4.m1.5.5.4.cmml" xref="S3.SS3.p6.4.m1.5.5.4"></eq><ci id="S3.SS3.p6.4.m1.5.5.5.cmml" xref="S3.SS3.p6.4.m1.5.5.5">𝐒</ci><set id="S3.SS3.p6.4.m1.5.5.3.4.cmml" xref="S3.SS3.p6.4.m1.5.5.3.3"><apply id="S3.SS3.p6.4.m1.3.3.1.1.1.cmml" xref="S3.SS3.p6.4.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.4.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.p6.4.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.SS3.p6.4.m1.3.3.1.1.1.2.cmml" xref="S3.SS3.p6.4.m1.3.3.1.1.1.2">𝐬</ci><cn id="S3.SS3.p6.4.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS3.p6.4.m1.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS3.p6.4.m1.4.4.2.2.2.cmml" xref="S3.SS3.p6.4.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p6.4.m1.4.4.2.2.2.1.cmml" xref="S3.SS3.p6.4.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.SS3.p6.4.m1.4.4.2.2.2.2.cmml" xref="S3.SS3.p6.4.m1.4.4.2.2.2.2">𝐬</ci><cn id="S3.SS3.p6.4.m1.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS3.p6.4.m1.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS3.p6.4.m1.2.2.cmml" xref="S3.SS3.p6.4.m1.2.2">⋯</ci><apply id="S3.SS3.p6.4.m1.5.5.3.3.3.cmml" xref="S3.SS3.p6.4.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p6.4.m1.5.5.3.3.3.1.cmml" xref="S3.SS3.p6.4.m1.5.5.3.3.3">subscript</csymbol><ci id="S3.SS3.p6.4.m1.5.5.3.3.3.2.cmml" xref="S3.SS3.p6.4.m1.5.5.3.3.3.2">𝐬</ci><apply id="S3.SS3.p6.4.m1.1.1.1.2.cmml" xref="S3.SS3.p6.4.m1.1.1.1.3"><csymbol cd="latexml" id="S3.SS3.p6.4.m1.1.1.1.2.1.cmml" xref="S3.SS3.p6.4.m1.1.1.1.3.1">delimited-∣∣</csymbol><ci id="S3.SS3.p6.4.m1.1.1.1.1.cmml" xref="S3.SS3.p6.4.m1.1.1.1.1">𝒮</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.4.m1.5c">\mathbf{S}=\{\mathbf{s}_{1},\mathbf{s}_{2},\cdots,\mathbf{s}_{\mid\mathcal{S}%
\mid}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.4.m1.5d">bold_S = { bold_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , bold_s start_POSTSUBSCRIPT ∣ caligraphic_S ∣ end_POSTSUBSCRIPT }</annotation></semantics></math> is a set of session embeddings with
<math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p6.5.m2.1"><semantics id="S3.SS3.p6.5.m2.1a"><mi id="S3.SS3.p6.5.m2.1.1" xref="S3.SS3.p6.5.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.5.m2.1b"><ci id="S3.SS3.p6.5.m2.1.1.cmml" xref="S3.SS3.p6.5.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.5.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.5.m2.1d">italic_t</annotation></semantics></math>-th element <math alttext="\mathbf{s}_{t}" class="ltx_Math" display="inline" id="S3.SS3.p6.6.m3.1"><semantics id="S3.SS3.p6.6.m3.1a"><msub id="S3.SS3.p6.6.m3.1.1" xref="S3.SS3.p6.6.m3.1.1.cmml"><mi id="S3.SS3.p6.6.m3.1.1.2" xref="S3.SS3.p6.6.m3.1.1.2.cmml">𝐬</mi><mi id="S3.SS3.p6.6.m3.1.1.3" xref="S3.SS3.p6.6.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.6.m3.1b"><apply id="S3.SS3.p6.6.m3.1.1.cmml" xref="S3.SS3.p6.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.6.m3.1.1.1.cmml" xref="S3.SS3.p6.6.m3.1.1">subscript</csymbol><ci id="S3.SS3.p6.6.m3.1.1.2.cmml" xref="S3.SS3.p6.6.m3.1.1.2">𝐬</ci><ci id="S3.SS3.p6.6.m3.1.1.3.cmml" xref="S3.SS3.p6.6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.6.m3.1c">\mathbf{s}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.6.m3.1d">bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{V}=\{\mathbf{v}_{1},\mathbf{v}_{2},\cdots,\mathbf{v}_{\mid\mathcal{V}%
\mid}\}" class="ltx_Math" display="inline" id="S3.SS3.p6.7.m4.5"><semantics id="S3.SS3.p6.7.m4.5a"><mrow id="S3.SS3.p6.7.m4.5.5" xref="S3.SS3.p6.7.m4.5.5.cmml"><mi id="S3.SS3.p6.7.m4.5.5.5" xref="S3.SS3.p6.7.m4.5.5.5.cmml">𝐕</mi><mo id="S3.SS3.p6.7.m4.5.5.4" xref="S3.SS3.p6.7.m4.5.5.4.cmml">=</mo><mrow id="S3.SS3.p6.7.m4.5.5.3.3" xref="S3.SS3.p6.7.m4.5.5.3.4.cmml"><mo id="S3.SS3.p6.7.m4.5.5.3.3.4" stretchy="false" xref="S3.SS3.p6.7.m4.5.5.3.4.cmml">{</mo><msub id="S3.SS3.p6.7.m4.3.3.1.1.1" xref="S3.SS3.p6.7.m4.3.3.1.1.1.cmml"><mi id="S3.SS3.p6.7.m4.3.3.1.1.1.2" xref="S3.SS3.p6.7.m4.3.3.1.1.1.2.cmml">𝐯</mi><mn id="S3.SS3.p6.7.m4.3.3.1.1.1.3" xref="S3.SS3.p6.7.m4.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p6.7.m4.5.5.3.3.5" xref="S3.SS3.p6.7.m4.5.5.3.4.cmml">,</mo><msub id="S3.SS3.p6.7.m4.4.4.2.2.2" xref="S3.SS3.p6.7.m4.4.4.2.2.2.cmml"><mi id="S3.SS3.p6.7.m4.4.4.2.2.2.2" xref="S3.SS3.p6.7.m4.4.4.2.2.2.2.cmml">𝐯</mi><mn id="S3.SS3.p6.7.m4.4.4.2.2.2.3" xref="S3.SS3.p6.7.m4.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p6.7.m4.5.5.3.3.6" xref="S3.SS3.p6.7.m4.5.5.3.4.cmml">,</mo><mi id="S3.SS3.p6.7.m4.2.2" mathvariant="normal" xref="S3.SS3.p6.7.m4.2.2.cmml">⋯</mi><mo id="S3.SS3.p6.7.m4.5.5.3.3.7" xref="S3.SS3.p6.7.m4.5.5.3.4.cmml">,</mo><msub id="S3.SS3.p6.7.m4.5.5.3.3.3" xref="S3.SS3.p6.7.m4.5.5.3.3.3.cmml"><mi id="S3.SS3.p6.7.m4.5.5.3.3.3.2" xref="S3.SS3.p6.7.m4.5.5.3.3.3.2.cmml">𝐯</mi><mrow id="S3.SS3.p6.7.m4.1.1.1.3" xref="S3.SS3.p6.7.m4.1.1.1.2.cmml"><mo fence="true" id="S3.SS3.p6.7.m4.1.1.1.3.1" rspace="0em" xref="S3.SS3.p6.7.m4.1.1.1.2.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p6.7.m4.1.1.1.1" xref="S3.SS3.p6.7.m4.1.1.1.1.cmml">𝒱</mi><mo fence="true" id="S3.SS3.p6.7.m4.1.1.1.3.2" lspace="0em" xref="S3.SS3.p6.7.m4.1.1.1.2.1.cmml">∣</mo></mrow></msub><mo id="S3.SS3.p6.7.m4.5.5.3.3.8" stretchy="false" xref="S3.SS3.p6.7.m4.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.7.m4.5b"><apply id="S3.SS3.p6.7.m4.5.5.cmml" xref="S3.SS3.p6.7.m4.5.5"><eq id="S3.SS3.p6.7.m4.5.5.4.cmml" xref="S3.SS3.p6.7.m4.5.5.4"></eq><ci id="S3.SS3.p6.7.m4.5.5.5.cmml" xref="S3.SS3.p6.7.m4.5.5.5">𝐕</ci><set id="S3.SS3.p6.7.m4.5.5.3.4.cmml" xref="S3.SS3.p6.7.m4.5.5.3.3"><apply id="S3.SS3.p6.7.m4.3.3.1.1.1.cmml" xref="S3.SS3.p6.7.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.7.m4.3.3.1.1.1.1.cmml" xref="S3.SS3.p6.7.m4.3.3.1.1.1">subscript</csymbol><ci id="S3.SS3.p6.7.m4.3.3.1.1.1.2.cmml" xref="S3.SS3.p6.7.m4.3.3.1.1.1.2">𝐯</ci><cn id="S3.SS3.p6.7.m4.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS3.p6.7.m4.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS3.p6.7.m4.4.4.2.2.2.cmml" xref="S3.SS3.p6.7.m4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p6.7.m4.4.4.2.2.2.1.cmml" xref="S3.SS3.p6.7.m4.4.4.2.2.2">subscript</csymbol><ci id="S3.SS3.p6.7.m4.4.4.2.2.2.2.cmml" xref="S3.SS3.p6.7.m4.4.4.2.2.2.2">𝐯</ci><cn id="S3.SS3.p6.7.m4.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS3.p6.7.m4.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS3.p6.7.m4.2.2.cmml" xref="S3.SS3.p6.7.m4.2.2">⋯</ci><apply id="S3.SS3.p6.7.m4.5.5.3.3.3.cmml" xref="S3.SS3.p6.7.m4.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p6.7.m4.5.5.3.3.3.1.cmml" xref="S3.SS3.p6.7.m4.5.5.3.3.3">subscript</csymbol><ci id="S3.SS3.p6.7.m4.5.5.3.3.3.2.cmml" xref="S3.SS3.p6.7.m4.5.5.3.3.3.2">𝐯</ci><apply id="S3.SS3.p6.7.m4.1.1.1.2.cmml" xref="S3.SS3.p6.7.m4.1.1.1.3"><csymbol cd="latexml" id="S3.SS3.p6.7.m4.1.1.1.2.1.cmml" xref="S3.SS3.p6.7.m4.1.1.1.3.1">delimited-∣∣</csymbol><ci id="S3.SS3.p6.7.m4.1.1.1.1.cmml" xref="S3.SS3.p6.7.m4.1.1.1.1">𝒱</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.7.m4.5c">\mathbf{V}=\{\mathbf{v}_{1},\mathbf{v}_{2},\cdots,\mathbf{v}_{\mid\mathcal{V}%
\mid}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.7.m4.5d">bold_V = { bold_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , bold_v start_POSTSUBSCRIPT ∣ caligraphic_V ∣ end_POSTSUBSCRIPT }</annotation></semantics></math> is a set of updated item embeddings with <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p6.8.m5.1"><semantics id="S3.SS3.p6.8.m5.1a"><mi id="S3.SS3.p6.8.m5.1.1" xref="S3.SS3.p6.8.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.8.m5.1b"><ci id="S3.SS3.p6.8.m5.1.1.cmml" xref="S3.SS3.p6.8.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.8.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.8.m5.1d">italic_k</annotation></semantics></math>-th element <math alttext="\mathbf{v}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p6.9.m6.1"><semantics id="S3.SS3.p6.9.m6.1a"><msub id="S3.SS3.p6.9.m6.1.1" xref="S3.SS3.p6.9.m6.1.1.cmml"><mi id="S3.SS3.p6.9.m6.1.1.2" xref="S3.SS3.p6.9.m6.1.1.2.cmml">𝐯</mi><mi id="S3.SS3.p6.9.m6.1.1.3" xref="S3.SS3.p6.9.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.9.m6.1b"><apply id="S3.SS3.p6.9.m6.1.1.cmml" xref="S3.SS3.p6.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.9.m6.1.1.1.cmml" xref="S3.SS3.p6.9.m6.1.1">subscript</csymbol><ci id="S3.SS3.p6.9.m6.1.1.2.cmml" xref="S3.SS3.p6.9.m6.1.1.2">𝐯</ci><ci id="S3.SS3.p6.9.m6.1.1.3.cmml" xref="S3.SS3.p6.9.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.9.m6.1c">\mathbf{v}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.9.m6.1d">bold_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.6">Next, we move to the prediction layer. In this layer, all items in <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS3.p7.1.m1.1"><semantics id="S3.SS3.p7.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p7.1.m1.1.1" xref="S3.SS3.p7.1.m1.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.1.m1.1b"><ci id="S3.SS3.p7.1.m1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.1.m1.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.1.m1.1d">caligraphic_V</annotation></semantics></math> are considered candidate items for recommendation. Let <math alttext="\mathbf{Z}" class="ltx_Math" display="inline" id="S3.SS3.p7.2.m2.1"><semantics id="S3.SS3.p7.2.m2.1a"><mi id="S3.SS3.p7.2.m2.1.1" xref="S3.SS3.p7.2.m2.1.1.cmml">𝐙</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.2.m2.1b"><ci id="S3.SS3.p7.2.m2.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1">𝐙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.2.m2.1c">\mathbf{Z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.2.m2.1d">bold_Z</annotation></semantics></math> represent the set of recommendation scores, where each element <math alttext="\mathbf{z}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p7.3.m3.1"><semantics id="S3.SS3.p7.3.m3.1a"><msub id="S3.SS3.p7.3.m3.1.1" xref="S3.SS3.p7.3.m3.1.1.cmml"><mi id="S3.SS3.p7.3.m3.1.1.2" xref="S3.SS3.p7.3.m3.1.1.2.cmml">𝐳</mi><mi id="S3.SS3.p7.3.m3.1.1.3" xref="S3.SS3.p7.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.3.m3.1b"><apply id="S3.SS3.p7.3.m3.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.3.m3.1.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p7.3.m3.1.1.2.cmml" xref="S3.SS3.p7.3.m3.1.1.2">𝐳</ci><ci id="S3.SS3.p7.3.m3.1.1.3.cmml" xref="S3.SS3.p7.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.3.m3.1c">\mathbf{z}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.3.m3.1d">bold_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> corresponds to the score for the target item <math alttext="v_{k}\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS3.p7.4.m4.1"><semantics id="S3.SS3.p7.4.m4.1a"><mrow id="S3.SS3.p7.4.m4.1.1" xref="S3.SS3.p7.4.m4.1.1.cmml"><msub id="S3.SS3.p7.4.m4.1.1.2" xref="S3.SS3.p7.4.m4.1.1.2.cmml"><mi id="S3.SS3.p7.4.m4.1.1.2.2" xref="S3.SS3.p7.4.m4.1.1.2.2.cmml">v</mi><mi id="S3.SS3.p7.4.m4.1.1.2.3" xref="S3.SS3.p7.4.m4.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS3.p7.4.m4.1.1.1" xref="S3.SS3.p7.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p7.4.m4.1.1.3" xref="S3.SS3.p7.4.m4.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.4.m4.1b"><apply id="S3.SS3.p7.4.m4.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1"><in id="S3.SS3.p7.4.m4.1.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1.1"></in><apply id="S3.SS3.p7.4.m4.1.1.2.cmml" xref="S3.SS3.p7.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p7.4.m4.1.1.2.1.cmml" xref="S3.SS3.p7.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p7.4.m4.1.1.2.2.cmml" xref="S3.SS3.p7.4.m4.1.1.2.2">𝑣</ci><ci id="S3.SS3.p7.4.m4.1.1.2.3.cmml" xref="S3.SS3.p7.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p7.4.m4.1.1.3.cmml" xref="S3.SS3.p7.4.m4.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.4.m4.1c">v_{k}\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ caligraphic_V</annotation></semantics></math>. Given session <math alttext="\mathcal{S}_{t}" class="ltx_Math" display="inline" id="S3.SS3.p7.5.m5.1"><semantics id="S3.SS3.p7.5.m5.1a"><msub id="S3.SS3.p7.5.m5.1.1" xref="S3.SS3.p7.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p7.5.m5.1.1.2" xref="S3.SS3.p7.5.m5.1.1.2.cmml">𝒮</mi><mi id="S3.SS3.p7.5.m5.1.1.3" xref="S3.SS3.p7.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.5.m5.1b"><apply id="S3.SS3.p7.5.m5.1.1.cmml" xref="S3.SS3.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.5.m5.1.1.1.cmml" xref="S3.SS3.p7.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p7.5.m5.1.1.2.cmml" xref="S3.SS3.p7.5.m5.1.1.2">𝒮</ci><ci id="S3.SS3.p7.5.m5.1.1.3.cmml" xref="S3.SS3.p7.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.5.m5.1c">\mathcal{S}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.5.m5.1d">caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the score <math alttext="\mathbf{z}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p7.6.m6.1"><semantics id="S3.SS3.p7.6.m6.1a"><msub id="S3.SS3.p7.6.m6.1.1" xref="S3.SS3.p7.6.m6.1.1.cmml"><mi id="S3.SS3.p7.6.m6.1.1.2" xref="S3.SS3.p7.6.m6.1.1.2.cmml">𝐳</mi><mi id="S3.SS3.p7.6.m6.1.1.3" xref="S3.SS3.p7.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.6.m6.1b"><apply id="S3.SS3.p7.6.m6.1.1.cmml" xref="S3.SS3.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.6.m6.1.1.1.cmml" xref="S3.SS3.p7.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p7.6.m6.1.1.2.cmml" xref="S3.SS3.p7.6.m6.1.1.2">𝐳</ci><ci id="S3.SS3.p7.6.m6.1.1.3.cmml" xref="S3.SS3.p7.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.6.m6.1c">\mathbf{z}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.6.m6.1d">bold_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is computed by taking the inner product between the session embedding and the item embedding:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}_{k}=\mathbf{s}_{t}^{\top}\mathbf{v}_{k}," class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S3.E7.m1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><msubsup id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.2.cmml">𝐬</mi><mi id="S3.E7.m1.1.1.1.1.3.2.2.3" xref="S3.E7.m1.1.1.1.1.3.2.2.3.cmml">t</mi><mo id="S3.E7.m1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.cmml">⊤</mo></msubsup><mo id="S3.E7.m1.1.1.1.1.3.1" xref="S3.E7.m1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.3.2" xref="S3.E7.m1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="S3.E7.m1.1.1.1.1.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"></eq><apply id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2">𝐳</ci><ci id="S3.E7.m1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><times id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1"></times><apply id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2.2">𝐬</ci><ci id="S3.E7.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3">top</csymbol></apply><apply id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2">𝐯</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\mathbf{z}_{k}=\mathbf{s}_{t}^{\top}\mathbf{v}_{k},</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">bold_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p7.9">where <math alttext="\mathbf{v}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p7.7.m1.1"><semantics id="S3.SS3.p7.7.m1.1a"><msub id="S3.SS3.p7.7.m1.1.1" xref="S3.SS3.p7.7.m1.1.1.cmml"><mi id="S3.SS3.p7.7.m1.1.1.2" xref="S3.SS3.p7.7.m1.1.1.2.cmml">𝐯</mi><mi id="S3.SS3.p7.7.m1.1.1.3" xref="S3.SS3.p7.7.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.7.m1.1b"><apply id="S3.SS3.p7.7.m1.1.1.cmml" xref="S3.SS3.p7.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.7.m1.1.1.1.cmml" xref="S3.SS3.p7.7.m1.1.1">subscript</csymbol><ci id="S3.SS3.p7.7.m1.1.1.2.cmml" xref="S3.SS3.p7.7.m1.1.1.2">𝐯</ci><ci id="S3.SS3.p7.7.m1.1.1.3.cmml" xref="S3.SS3.p7.7.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.7.m1.1c">\mathbf{v}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.7.m1.1d">bold_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the updated item embedding for item <math alttext="v_{k}" class="ltx_Math" display="inline" id="S3.SS3.p7.8.m2.1"><semantics id="S3.SS3.p7.8.m2.1a"><msub id="S3.SS3.p7.8.m2.1.1" xref="S3.SS3.p7.8.m2.1.1.cmml"><mi id="S3.SS3.p7.8.m2.1.1.2" xref="S3.SS3.p7.8.m2.1.1.2.cmml">v</mi><mi id="S3.SS3.p7.8.m2.1.1.3" xref="S3.SS3.p7.8.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.8.m2.1b"><apply id="S3.SS3.p7.8.m2.1.1.cmml" xref="S3.SS3.p7.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.8.m2.1.1.1.cmml" xref="S3.SS3.p7.8.m2.1.1">subscript</csymbol><ci id="S3.SS3.p7.8.m2.1.1.2.cmml" xref="S3.SS3.p7.8.m2.1.1.2">𝑣</ci><ci id="S3.SS3.p7.8.m2.1.1.3.cmml" xref="S3.SS3.p7.8.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.8.m2.1c">v_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.8.m2.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. The softmax function is then applied to the unnormalized scores <math alttext="\mathbf{z}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p7.9.m3.1"><semantics id="S3.SS3.p7.9.m3.1a"><msub id="S3.SS3.p7.9.m3.1.1" xref="S3.SS3.p7.9.m3.1.1.cmml"><mi id="S3.SS3.p7.9.m3.1.1.2" xref="S3.SS3.p7.9.m3.1.1.2.cmml">𝐳</mi><mi id="S3.SS3.p7.9.m3.1.1.3" xref="S3.SS3.p7.9.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.9.m3.1b"><apply id="S3.SS3.p7.9.m3.1.1.cmml" xref="S3.SS3.p7.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.9.m3.1.1.1.cmml" xref="S3.SS3.p7.9.m3.1.1">subscript</csymbol><ci id="S3.SS3.p7.9.m3.1.1.2.cmml" xref="S3.SS3.p7.9.m3.1.1.2">𝐳</ci><ci id="S3.SS3.p7.9.m3.1.1.3.cmml" xref="S3.SS3.p7.9.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.9.m3.1c">\mathbf{z}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.9.m3.1d">bold_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> to obtain the final output probabilities:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}_{k}=\text{Softmax}(\mathbf{z}_{k})," class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S3.E8.m1.1.1.1.1.3.2.1" xref="S3.E8.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mtext id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3a.cmml">Softmax</mtext><mo id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E8.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"></eq><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><ci id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1">^</ci><ci id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2"></times><ci id="S3.E8.m1.1.1.1.1.1.3a.cmml" xref="S3.E8.m1.1.1.1.1.1.3"><mtext id="S3.E8.m1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3">Softmax</mtext></ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\hat{y}_{k}=\text{Softmax}(\mathbf{z}_{k}),</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = Softmax ( bold_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p7.13">where <math alttext="\hat{y}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p7.10.m1.1"><semantics id="S3.SS3.p7.10.m1.1a"><msub id="S3.SS3.p7.10.m1.1.1" xref="S3.SS3.p7.10.m1.1.1.cmml"><mover accent="true" id="S3.SS3.p7.10.m1.1.1.2" xref="S3.SS3.p7.10.m1.1.1.2.cmml"><mi id="S3.SS3.p7.10.m1.1.1.2.2" xref="S3.SS3.p7.10.m1.1.1.2.2.cmml">y</mi><mo id="S3.SS3.p7.10.m1.1.1.2.1" xref="S3.SS3.p7.10.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p7.10.m1.1.1.3" xref="S3.SS3.p7.10.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.10.m1.1b"><apply id="S3.SS3.p7.10.m1.1.1.cmml" xref="S3.SS3.p7.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.10.m1.1.1.1.cmml" xref="S3.SS3.p7.10.m1.1.1">subscript</csymbol><apply id="S3.SS3.p7.10.m1.1.1.2.cmml" xref="S3.SS3.p7.10.m1.1.1.2"><ci id="S3.SS3.p7.10.m1.1.1.2.1.cmml" xref="S3.SS3.p7.10.m1.1.1.2.1">^</ci><ci id="S3.SS3.p7.10.m1.1.1.2.2.cmml" xref="S3.SS3.p7.10.m1.1.1.2.2">𝑦</ci></apply><ci id="S3.SS3.p7.10.m1.1.1.3.cmml" xref="S3.SS3.p7.10.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.10.m1.1c">\hat{y}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.10.m1.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> denotes the probability of item <math alttext="v_{k}" class="ltx_Math" display="inline" id="S3.SS3.p7.11.m2.1"><semantics id="S3.SS3.p7.11.m2.1a"><msub id="S3.SS3.p7.11.m2.1.1" xref="S3.SS3.p7.11.m2.1.1.cmml"><mi id="S3.SS3.p7.11.m2.1.1.2" xref="S3.SS3.p7.11.m2.1.1.2.cmml">v</mi><mi id="S3.SS3.p7.11.m2.1.1.3" xref="S3.SS3.p7.11.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.11.m2.1b"><apply id="S3.SS3.p7.11.m2.1.1.cmml" xref="S3.SS3.p7.11.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.11.m2.1.1.1.cmml" xref="S3.SS3.p7.11.m2.1.1">subscript</csymbol><ci id="S3.SS3.p7.11.m2.1.1.2.cmml" xref="S3.SS3.p7.11.m2.1.1.2">𝑣</ci><ci id="S3.SS3.p7.11.m2.1.1.3.cmml" xref="S3.SS3.p7.11.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.11.m2.1c">v_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.11.m2.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> being the next click in the current session. The loss function used for training is defined as the cross-entropy loss between the predicted probabilities <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S3.SS3.p7.12.m3.1"><semantics id="S3.SS3.p7.12.m3.1a"><mover accent="true" id="S3.SS3.p7.12.m3.1.1" xref="S3.SS3.p7.12.m3.1.1.cmml"><mi id="S3.SS3.p7.12.m3.1.1.2" xref="S3.SS3.p7.12.m3.1.1.2.cmml">y</mi><mo id="S3.SS3.p7.12.m3.1.1.1" xref="S3.SS3.p7.12.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.12.m3.1b"><apply id="S3.SS3.p7.12.m3.1.1.cmml" xref="S3.SS3.p7.12.m3.1.1"><ci id="S3.SS3.p7.12.m3.1.1.1.cmml" xref="S3.SS3.p7.12.m3.1.1.1">^</ci><ci id="S3.SS3.p7.12.m3.1.1.2.cmml" xref="S3.SS3.p7.12.m3.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.12.m3.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.12.m3.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math> and the one-hot encoded ground truth labels <math alttext="y" class="ltx_Math" display="inline" id="S3.SS3.p7.13.m4.1"><semantics id="S3.SS3.p7.13.m4.1a"><mi id="S3.SS3.p7.13.m4.1.1" xref="S3.SS3.p7.13.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.13.m4.1b"><ci id="S3.SS3.p7.13.m4.1.1.cmml" xref="S3.SS3.p7.13.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.13.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.13.m4.1d">italic_y</annotation></semantics></math>. The cross-entropy loss measures the difference between the true distribution (given by the one-hot encoding) and the predicted distribution (given by the model’s output). Formally, the loss is defined as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p8">
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(y,\hat{y})=-\sum_{k=1}^{\mid\mathcal{V}\mid}y_{k}\log(\hat{y}_{k})," class="ltx_Math" display="block" id="S3.E9.m1.5"><semantics id="S3.E9.m1.5a"><mrow id="S3.E9.m1.5.5.1" xref="S3.E9.m1.5.5.1.1.cmml"><mrow id="S3.E9.m1.5.5.1.1" xref="S3.E9.m1.5.5.1.1.cmml"><mrow id="S3.E9.m1.5.5.1.1.3" xref="S3.E9.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.5.5.1.1.3.2" xref="S3.E9.m1.5.5.1.1.3.2.cmml">ℒ</mi><mo id="S3.E9.m1.5.5.1.1.3.1" xref="S3.E9.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S3.E9.m1.5.5.1.1.3.3.2" xref="S3.E9.m1.5.5.1.1.3.3.1.cmml"><mo id="S3.E9.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S3.E9.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml">y</mi><mo id="S3.E9.m1.5.5.1.1.3.3.2.2" xref="S3.E9.m1.5.5.1.1.3.3.1.cmml">,</mo><mover accent="true" id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml"><mi id="S3.E9.m1.3.3.2" xref="S3.E9.m1.3.3.2.cmml">y</mi><mo id="S3.E9.m1.3.3.1" xref="S3.E9.m1.3.3.1.cmml">^</mo></mover><mo id="S3.E9.m1.5.5.1.1.3.3.2.3" stretchy="false" xref="S3.E9.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.5.5.1.1.2" xref="S3.E9.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.5.5.1.1.1" xref="S3.E9.m1.5.5.1.1.1.cmml"><mo id="S3.E9.m1.5.5.1.1.1a" xref="S3.E9.m1.5.5.1.1.1.cmml">−</mo><mrow id="S3.E9.m1.5.5.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.cmml"><munderover id="S3.E9.m1.5.5.1.1.1.1.2" xref="S3.E9.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E9.m1.5.5.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E9.m1.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E9.m1.5.5.1.1.1.1.2.2.3" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.2.2.3.2" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E9.m1.5.5.1.1.1.1.2.2.3.1" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.5.5.1.1.1.1.2.2.3.3" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.1.1.1.2.cmml"><mo fence="true" id="S3.E9.m1.1.1.1.3.1" rspace="0em" xref="S3.E9.m1.1.1.1.2.1.cmml">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">𝒱</mi><mo fence="true" id="S3.E9.m1.1.1.1.3.2" lspace="0em" xref="S3.E9.m1.1.1.1.2.1.cmml">∣</mo></mrow></munderover><mrow id="S3.E9.m1.5.5.1.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.1.cmml"><msub id="S3.E9.m1.5.5.1.1.1.1.1.3" xref="S3.E9.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.1.3.2" xref="S3.E9.m1.5.5.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E9.m1.5.5.1.1.1.1.1.3.3" xref="S3.E9.m1.5.5.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E9.m1.5.5.1.1.1.1.1.2" lspace="0.167em" xref="S3.E9.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.5.5.1.1.1.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.4.4" xref="S3.E9.m1.4.4.cmml">log</mi><mo id="S3.E9.m1.5.5.1.1.1.1.1.1.1a" xref="S3.E9.m1.5.5.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.1.1.2.cmml"><mo id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.5.5.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.5.5.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.5.5.1.2" xref="S3.E9.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.5b"><apply id="S3.E9.m1.5.5.1.1.cmml" xref="S3.E9.m1.5.5.1"><eq id="S3.E9.m1.5.5.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.2"></eq><apply id="S3.E9.m1.5.5.1.1.3.cmml" xref="S3.E9.m1.5.5.1.1.3"><times id="S3.E9.m1.5.5.1.1.3.1.cmml" xref="S3.E9.m1.5.5.1.1.3.1"></times><ci id="S3.E9.m1.5.5.1.1.3.2.cmml" xref="S3.E9.m1.5.5.1.1.3.2">ℒ</ci><interval closure="open" id="S3.E9.m1.5.5.1.1.3.3.1.cmml" xref="S3.E9.m1.5.5.1.1.3.3.2"><ci id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">𝑦</ci><apply id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3"><ci id="S3.E9.m1.3.3.1.cmml" xref="S3.E9.m1.3.3.1">^</ci><ci id="S3.E9.m1.3.3.2.cmml" xref="S3.E9.m1.3.3.2">𝑦</ci></apply></interval></apply><apply id="S3.E9.m1.5.5.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1"><minus id="S3.E9.m1.5.5.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1"></minus><apply id="S3.E9.m1.5.5.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1"><apply id="S3.E9.m1.5.5.1.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S3.E9.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2.2"></sum><apply id="S3.E9.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3"><eq id="S3.E9.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.1"></eq><ci id="S3.E9.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.2">𝑘</ci><cn id="S3.E9.m1.5.5.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.3"><csymbol cd="latexml" id="S3.E9.m1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.3.1">delimited-∣∣</csymbol><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝒱</ci></apply></apply><apply id="S3.E9.m1.5.5.1.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1"><times id="S3.E9.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.2"></times><apply id="S3.E9.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E9.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E9.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1"><log id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4"></log><apply id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.5c">\mathcal{L}(y,\hat{y})=-\sum_{k=1}^{\mid\mathcal{V}\mid}y_{k}\log(\hat{y}_{k}),</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.5d">caligraphic_L ( italic_y , over^ start_ARG italic_y end_ARG ) = - ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∣ caligraphic_V ∣ end_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT roman_log ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p8.6">where <math alttext="y_{k}" class="ltx_Math" display="inline" id="S3.SS3.p8.1.m1.1"><semantics id="S3.SS3.p8.1.m1.1a"><msub id="S3.SS3.p8.1.m1.1.1" xref="S3.SS3.p8.1.m1.1.1.cmml"><mi id="S3.SS3.p8.1.m1.1.1.2" xref="S3.SS3.p8.1.m1.1.1.2.cmml">y</mi><mi id="S3.SS3.p8.1.m1.1.1.3" xref="S3.SS3.p8.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.1.m1.1b"><apply id="S3.SS3.p8.1.m1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.1.m1.1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p8.1.m1.1.1.2.cmml" xref="S3.SS3.p8.1.m1.1.1.2">𝑦</ci><ci id="S3.SS3.p8.1.m1.1.1.3.cmml" xref="S3.SS3.p8.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.1.m1.1c">y_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the one-hot encoded ground truth for item <math alttext="v_{k}" class="ltx_Math" display="inline" id="S3.SS3.p8.2.m2.1"><semantics id="S3.SS3.p8.2.m2.1a"><msub id="S3.SS3.p8.2.m2.1.1" xref="S3.SS3.p8.2.m2.1.1.cmml"><mi id="S3.SS3.p8.2.m2.1.1.2" xref="S3.SS3.p8.2.m2.1.1.2.cmml">v</mi><mi id="S3.SS3.p8.2.m2.1.1.3" xref="S3.SS3.p8.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.2.m2.1b"><apply id="S3.SS3.p8.2.m2.1.1.cmml" xref="S3.SS3.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.2.m2.1.1.1.cmml" xref="S3.SS3.p8.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p8.2.m2.1.1.2.cmml" xref="S3.SS3.p8.2.m2.1.1.2">𝑣</ci><ci id="S3.SS3.p8.2.m2.1.1.3.cmml" xref="S3.SS3.p8.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.2.m2.1c">v_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> (with <math alttext="y_{k}=1" class="ltx_Math" display="inline" id="S3.SS3.p8.3.m3.1"><semantics id="S3.SS3.p8.3.m3.1a"><mrow id="S3.SS3.p8.3.m3.1.1" xref="S3.SS3.p8.3.m3.1.1.cmml"><msub id="S3.SS3.p8.3.m3.1.1.2" xref="S3.SS3.p8.3.m3.1.1.2.cmml"><mi id="S3.SS3.p8.3.m3.1.1.2.2" xref="S3.SS3.p8.3.m3.1.1.2.2.cmml">y</mi><mi id="S3.SS3.p8.3.m3.1.1.2.3" xref="S3.SS3.p8.3.m3.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS3.p8.3.m3.1.1.1" xref="S3.SS3.p8.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS3.p8.3.m3.1.1.3" xref="S3.SS3.p8.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.3.m3.1b"><apply id="S3.SS3.p8.3.m3.1.1.cmml" xref="S3.SS3.p8.3.m3.1.1"><eq id="S3.SS3.p8.3.m3.1.1.1.cmml" xref="S3.SS3.p8.3.m3.1.1.1"></eq><apply id="S3.SS3.p8.3.m3.1.1.2.cmml" xref="S3.SS3.p8.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p8.3.m3.1.1.2.1.cmml" xref="S3.SS3.p8.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p8.3.m3.1.1.2.2.cmml" xref="S3.SS3.p8.3.m3.1.1.2.2">𝑦</ci><ci id="S3.SS3.p8.3.m3.1.1.2.3.cmml" xref="S3.SS3.p8.3.m3.1.1.2.3">𝑘</ci></apply><cn id="S3.SS3.p8.3.m3.1.1.3.cmml" type="integer" xref="S3.SS3.p8.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.3.m3.1c">y_{k}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = 1</annotation></semantics></math> for the correct item and <math alttext="0" class="ltx_Math" display="inline" id="S3.SS3.p8.4.m4.1"><semantics id="S3.SS3.p8.4.m4.1a"><mn id="S3.SS3.p8.4.m4.1.1" xref="S3.SS3.p8.4.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.4.m4.1b"><cn id="S3.SS3.p8.4.m4.1.1.cmml" type="integer" xref="S3.SS3.p8.4.m4.1.1">0</cn></annotation-xml></semantics></math> for all others), and <math alttext="\hat{y}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p8.5.m5.1"><semantics id="S3.SS3.p8.5.m5.1a"><msub id="S3.SS3.p8.5.m5.1.1" xref="S3.SS3.p8.5.m5.1.1.cmml"><mover accent="true" id="S3.SS3.p8.5.m5.1.1.2" xref="S3.SS3.p8.5.m5.1.1.2.cmml"><mi id="S3.SS3.p8.5.m5.1.1.2.2" xref="S3.SS3.p8.5.m5.1.1.2.2.cmml">y</mi><mo id="S3.SS3.p8.5.m5.1.1.2.1" xref="S3.SS3.p8.5.m5.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p8.5.m5.1.1.3" xref="S3.SS3.p8.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.5.m5.1b"><apply id="S3.SS3.p8.5.m5.1.1.cmml" xref="S3.SS3.p8.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.5.m5.1.1.1.cmml" xref="S3.SS3.p8.5.m5.1.1">subscript</csymbol><apply id="S3.SS3.p8.5.m5.1.1.2.cmml" xref="S3.SS3.p8.5.m5.1.1.2"><ci id="S3.SS3.p8.5.m5.1.1.2.1.cmml" xref="S3.SS3.p8.5.m5.1.1.2.1">^</ci><ci id="S3.SS3.p8.5.m5.1.1.2.2.cmml" xref="S3.SS3.p8.5.m5.1.1.2.2">𝑦</ci></apply><ci id="S3.SS3.p8.5.m5.1.1.3.cmml" xref="S3.SS3.p8.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.5.m5.1c">\hat{y}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.5.m5.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the predicted probability that item <math alttext="v_{k}" class="ltx_Math" display="inline" id="S3.SS3.p8.6.m6.1"><semantics id="S3.SS3.p8.6.m6.1a"><msub id="S3.SS3.p8.6.m6.1.1" xref="S3.SS3.p8.6.m6.1.1.cmml"><mi id="S3.SS3.p8.6.m6.1.1.2" xref="S3.SS3.p8.6.m6.1.1.2.cmml">v</mi><mi id="S3.SS3.p8.6.m6.1.1.3" xref="S3.SS3.p8.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.6.m6.1b"><apply id="S3.SS3.p8.6.m6.1.1.cmml" xref="S3.SS3.p8.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.6.m6.1.1.1.cmml" xref="S3.SS3.p8.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p8.6.m6.1.1.2.cmml" xref="S3.SS3.p8.6.m6.1.1.2">𝑣</ci><ci id="S3.SS3.p8.6.m6.1.1.3.cmml" xref="S3.SS3.p8.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.6.m6.1c">v_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the correct next item.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p9">
<p class="ltx_p" id="S3.SS3.p9.1">By incorporating learnable cluster prompts into item embeddings, our approach enhances the SBR model’s ability to capture complex item dependencies, resulting in more accurate and effective recommendations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics of datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T1.1.1.1.1">Statistic</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T1.1.1.1.2">Last.fm</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T1.1.1.1.3">Xing</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T1.1.1.1.4">Reddit</th>
<td class="ltx_td ltx_border_t" id="S3.T1.1.1.1.5"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T1.1.2.2.1">No. of users</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T1.1.2.2.2">966</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T1.1.2.2.3">11,399</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T1.1.2.2.4">13,850</td>
<td class="ltx_td ltx_border_t" id="S3.T1.1.2.2.5"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.3">
<td class="ltx_td ltx_align_left" id="S3.T1.1.3.3.1">No. of items</td>
<td class="ltx_td ltx_align_left" id="S3.T1.1.3.3.2">38,784</td>
<td class="ltx_td ltx_align_left" id="S3.T1.1.3.3.3">59,039</td>
<td class="ltx_td ltx_align_left" id="S3.T1.1.3.3.4">21,790</td>
<td class="ltx_td" id="S3.T1.1.3.3.5"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.4">
<td class="ltx_td ltx_align_left" id="S3.T1.1.4.4.1">No. of sessions</td>
<td class="ltx_td ltx_align_left" id="S3.T1.1.4.4.2">294,402</td>
<td class="ltx_td ltx_align_left" id="S3.T1.1.4.4.3">90,286</td>
<td class="ltx_td ltx_align_left" id="S3.T1.1.4.4.4">458,292</td>
<td class="ltx_td" id="S3.T1.1.4.4.5"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5.5">
<td class="ltx_td ltx_align_left" id="S3.T1.1.5.5.1">Avg. of session length</td>
<td class="ltx_td ltx_align_left" id="S3.T1.1.5.5.2">12.86</td>
<td class="ltx_td ltx_align_left" id="S3.T1.1.5.5.3">5.82</td>
<td class="ltx_td ltx_align_left" id="S3.T1.1.5.5.4">4.49</td>
<td class="ltx_td" id="S3.T1.1.5.5.5"></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T1.1.6.6.1">Session per user</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T1.1.6.6.2">304.76</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T1.1.6.6.3">7.92</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T1.1.6.6.4">33.09</td>
<td class="ltx_td ltx_border_b" id="S3.T1.1.6.6.5"></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Comparison of MRR@5, Recall@5 and average improvement (%) on the three datasets. Our proposed models are highlighted in gray. The best results are highlighted in boldface, and the best results among <span class="ltx_text ltx_font_italic" id="S3.T2.2.1">intra-session</span> models are underlined.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T2.3.1.1.1" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.1.1.1">Category</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T2.3.1.1.2" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.1.2.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S3.T2.3.1.1.3" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.1.3.1">Last.fm</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S3.T2.3.1.1.4" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.1.4.1">Xing</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S3.T2.3.1.1.5" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.1.5.1">Reddit</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.3.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.3.2.2.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_th_row" id="S3.T2.3.2.2.2" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.2.2.3" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.2.2.3.1">MRR@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.2.2.4" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.2.2.4.1">Recall@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.2.2.5" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.2.2.5.1">Imp.(%)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.2.2.6" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.2.2.6.1">MRR@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.2.2.7" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.2.2.7.1">Recall@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.2.2.8" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.2.2.8.1">Imp.(%)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.2.2.9" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.2.2.9.1">MRR@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.2.2.10" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.2.2.10.1">Recall@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.2.2.11" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.2.2.11.1">Imp. (%)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.3.3.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S3.T2.3.3.1.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.3.3.1.2" style="padding:-1.25pt 3.0pt;">GRU4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.3.1.3" style="padding:-1.25pt 3.0pt;">7.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.3.1.4" style="padding:-1.25pt 3.0pt;">13.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.3.1.5" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.3.1.6" style="padding:-1.25pt 3.0pt;">10.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.3.1.7" style="padding:-1.25pt 3.0pt;">15.71</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.3.1.8" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.3.1.9" style="padding:-1.25pt 3.0pt;">35.45</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.3.1.10" style="padding:-1.25pt 3.0pt;">46.40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.3.1.11" style="padding:-1.25pt 3.0pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.4.2">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.3.4.2.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.3.4.2.2" style="background-color:#E6E6E6;padding:-1.25pt 3.0pt;"><span class="ltx_text" id="S3.T2.3.4.2.2.1" style="background-color:#E6E6E6;">CLIP-GRU4Rec</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.3.4.2.3" style="padding:-1.25pt 3.0pt;">10.07</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.4.2.4" style="padding:-1.25pt 3.0pt;">17.24</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.4.2.5" style="padding:-1.25pt 3.0pt;">+29.77</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.4.2.6" style="padding:-1.25pt 3.0pt;">11.12</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.4.2.7" style="padding:-1.25pt 3.0pt;">16.90</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.4.2.8" style="padding:-1.25pt 3.0pt;">+7.61</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.4.2.9" style="padding:-1.25pt 3.0pt;">40.21</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.4.2.10" style="padding:-1.25pt 3.0pt;">50.47</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.4.2.11" style="padding:-1.25pt 3.0pt;">+11.10</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.5.3">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.3.5.3.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.3.5.3.2" style="padding:-1.25pt 3.0pt;">NARM</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.5.3.3" style="padding:-1.25pt 3.0pt;">5.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.5.3.4" style="padding:-1.25pt 3.0pt;">9.74</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.5.3.5" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.5.3.6" style="padding:-1.25pt 3.0pt;">9.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.5.3.7" style="padding:-1.25pt 3.0pt;">15.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.5.3.8" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.5.3.9" style="padding:-1.25pt 3.0pt;">33.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.5.3.10" style="padding:-1.25pt 3.0pt;">44.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.5.3.11" style="padding:-1.25pt 3.0pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.6.4">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.3.6.4.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.3.6.4.2" style="background-color:#E6E6E6;padding:-1.25pt 3.0pt;"><span class="ltx_text" id="S3.T2.3.6.4.2.1" style="background-color:#E6E6E6;">CLIP-NARM</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.3.6.4.3" style="padding:-1.25pt 3.0pt;">8.10</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.6.4.4" style="padding:-1.25pt 3.0pt;">13.96</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.6.4.5" style="padding:-1.25pt 3.0pt;">+45.30</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.6.4.6" style="padding:-1.25pt 3.0pt;">12.04</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.6.4.7" style="padding:-1.25pt 3.0pt;">17.81</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.6.4.8" style="padding:-1.25pt 3.0pt;">+20.11</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.6.4.9" style="padding:-1.25pt 3.0pt;">38.50</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.6.4.10" style="padding:-1.25pt 3.0pt;">48.79</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.6.4.11" style="padding:-1.25pt 3.0pt;">+13.04</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.3.7.5.1" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.7.5.1.1">intra-</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.3.7.5.2" style="padding:-1.25pt 3.0pt;">CORE</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.7.5.3" style="padding:-1.25pt 3.0pt;">10.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.7.5.4" style="padding:-1.25pt 3.0pt;">17.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.7.5.5" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.7.5.6" style="padding:-1.25pt 3.0pt;">10.27</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.7.5.7" style="padding:-1.25pt 3.0pt;">17.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.7.5.8" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.7.5.9" style="padding:-1.25pt 3.0pt;">29.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.7.5.10" style="padding:-1.25pt 3.0pt;">46.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.7.5.11" style="padding:-1.25pt 3.0pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.8.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.3.8.6.1" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.8.6.1.1">session</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.3.8.6.2" style="background-color:#E6E6E6;padding:-1.25pt 3.0pt;"><span class="ltx_text" id="S3.T2.3.8.6.2.1" style="background-color:#E6E6E6;">CLIP-CORE</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.3.8.6.3" style="padding:-1.25pt 3.0pt;">10.67</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.8.6.4" style="padding:-1.25pt 3.0pt;">18.11</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.8.6.5" style="padding:-1.25pt 3.0pt;">+1.92</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.8.6.6" style="padding:-1.25pt 3.0pt;">12.65</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.8.6.7" style="padding:-1.25pt 3.0pt;">19.59</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.8.6.8" style="padding:-1.25pt 3.0pt;">+16.65</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.8.6.9" style="padding:-1.25pt 3.0pt;">31.33</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.8.6.10" style="padding:-1.25pt 3.0pt;">47.56</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.8.6.11" style="padding:-1.25pt 3.0pt;">+4.51</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.9.7">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.3.9.7.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.3.9.7.2" style="padding:-1.25pt 3.0pt;">SRGNN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.9.7.3" style="padding:-1.25pt 3.0pt;">9.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.9.7.4" style="padding:-1.25pt 3.0pt;">14.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.9.7.5" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.9.7.6" style="padding:-1.25pt 3.0pt;">14.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.9.7.7" style="padding:-1.25pt 3.0pt;">19.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.9.7.8" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.9.7.9" style="padding:-1.25pt 3.0pt;">38.04</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.9.7.10" style="padding:-1.25pt 3.0pt;">47.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.9.7.11" style="padding:-1.25pt 3.0pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.10.8">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.3.10.8.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.3.10.8.2" style="background-color:#E6E6E6;padding:-1.25pt 3.0pt;"><span class="ltx_text" id="S3.T2.3.10.8.2.1" style="background-color:#E6E6E6;">CLIP-SRGNN</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.3.10.8.3" style="padding:-1.25pt 3.0pt;">12.12</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.10.8.4" style="padding:-1.25pt 3.0pt;">18.87</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.10.8.5" style="padding:-1.25pt 3.0pt;">+31.54</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.10.8.6" style="padding:-1.25pt 3.0pt;">14.18</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.10.8.7" style="padding:-1.25pt 3.0pt;">19.72</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.10.8.8" style="padding:-1.25pt 3.0pt;">+1.44</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.10.8.9" style="padding:-1.25pt 3.0pt;">39.70</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.10.8.10" style="padding:-1.25pt 3.0pt;">49.73</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.10.8.11" style="padding:-1.25pt 3.0pt;">+4.26</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.11.9">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.3.11.9.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.3.11.9.2" style="padding:-1.25pt 3.0pt;">TAGNN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.11.9.3" style="padding:-1.25pt 3.0pt;">9.25</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.11.9.4" style="padding:-1.25pt 3.0pt;">15.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.11.9.5" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.11.9.6" style="padding:-1.25pt 3.0pt;">12.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.11.9.7" style="padding:-1.25pt 3.0pt;">18.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.11.9.8" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.11.9.9" style="padding:-1.25pt 3.0pt;">40.07</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.11.9.10" style="padding:-1.25pt 3.0pt;">51.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.11.9.11" style="padding:-1.25pt 3.0pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.12.10">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.3.12.10.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.3.12.10.2" style="background-color:#E6E6E6;padding:-1.25pt 3.0pt;"><span class="ltx_text" id="S3.T2.3.12.10.2.1" style="background-color:#E6E6E6;">CLIP-TAGNN</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.3.12.10.3" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S3.T2.3.12.10.3.1">12.82</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.12.10.4" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S3.T2.3.12.10.4.1">19.77</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.12.10.5" style="padding:-1.25pt 3.0pt;">+33.91</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.12.10.6" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.3.12.10.6.1">14.70</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.12.10.7" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.3.12.10.7.1">21.07</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.12.10.8" style="padding:-1.25pt 3.0pt;">+15.31</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.12.10.9" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S3.T2.3.12.10.9.1">41.22</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.12.10.10" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S3.T2.3.12.10.10.1">52.01</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.12.10.11" style="padding:-1.25pt 3.0pt;">+2.33</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.13.11">
<th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S3.T2.3.13.11.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.3.13.11.2" style="padding:-1.25pt 3.0pt;">GCSAN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.13.11.3" style="padding:-1.25pt 3.0pt;">4.47</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.13.11.4" style="padding:-1.25pt 3.0pt;">8.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.13.11.5" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.13.11.6" style="padding:-1.25pt 3.0pt;">13.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.13.11.7" style="padding:-1.25pt 3.0pt;">16.82</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.13.11.8" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.13.11.9" style="padding:-1.25pt 3.0pt;">36.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.13.11.10" style="padding:-1.25pt 3.0pt;">44.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.13.11.11" style="padding:-1.25pt 3.0pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.14.12">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.3.14.12.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.3.14.12.2" style="background-color:#E6E6E6;padding:-1.25pt 3.0pt;"><span class="ltx_text" id="S3.T2.3.14.12.2.1" style="background-color:#E6E6E6;">CLIP-GCSAN</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.3.14.12.3" style="padding:-1.25pt 3.0pt;">7.05</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.14.12.4" style="padding:-1.25pt 3.0pt;">11.59</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.14.12.5" style="padding:-1.25pt 3.0pt;">+45.54</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.14.12.6" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.14.12.6.1">15.65</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.14.12.7" style="padding:-1.25pt 3.0pt;">20.34</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.14.12.8" style="padding:-1.25pt 3.0pt;">+20.56</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.14.12.9" style="padding:-1.25pt 3.0pt;">39.07</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.14.12.10" style="padding:-1.25pt 3.0pt;">48.21</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.14.12.11" style="padding:-1.25pt 3.0pt;">+8.84</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.15.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.3.15.13.1" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.15.13.1.1">inter-</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.3.15.13.2" style="padding:-1.25pt 3.0pt;">GCEGNN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.15.13.3" style="padding:-1.25pt 3.0pt;">10.81</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.15.13.4" style="padding:-1.25pt 3.0pt;">17.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.15.13.5" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.15.13.6" style="padding:-1.25pt 3.0pt;">12.83</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.15.13.7" style="padding:-1.25pt 3.0pt;">19.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.15.13.8" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.15.13.9" style="padding:-1.25pt 3.0pt;">38.17</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.15.13.10" style="padding:-1.25pt 3.0pt;">48.38</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.15.13.11" style="padding:-1.25pt 3.0pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.16.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.3.16.14.1" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.16.14.1.1">session</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.3.16.14.2" style="background-color:#E6E6E6;padding:-1.25pt 3.0pt;"><span class="ltx_text" id="S3.T2.3.16.14.2.1" style="background-color:#E6E6E6;">CLIP-GCEGNN</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.3.16.14.3" style="padding:-1.25pt 3.0pt;">11.05</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.16.14.4" style="padding:-1.25pt 3.0pt;">17.60</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.16.14.5" style="padding:-1.25pt 3.0pt;">+1.92</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.16.14.6" style="padding:-1.25pt 3.0pt;">14.36</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.16.14.7" style="padding:-1.25pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.16.14.7.1">21.58</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.16.14.8" style="padding:-1.25pt 3.0pt;">+11.55</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.16.14.9" style="padding:-1.25pt 3.0pt;">37.93</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.16.14.10" style="padding:-1.25pt 3.0pt;">48.19</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.16.14.11" style="padding:-1.25pt 3.0pt;">-0.51</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.17.15">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T2.3.17.15.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.3.17.15.2" style="padding:-1.25pt 3.0pt;">LESSR</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.17.15.3" style="padding:-1.25pt 3.0pt;">7.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.17.15.4" style="padding:-1.25pt 3.0pt;">11.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.17.15.5" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.17.15.6" style="padding:-1.25pt 3.0pt;">14.67</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.17.15.7" style="padding:-1.25pt 3.0pt;">18.96</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.17.15.8" style="padding:-1.25pt 3.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.17.15.9" style="padding:-1.25pt 3.0pt;">39.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.17.15.10" style="padding:-1.25pt 3.0pt;">47.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.17.15.11" style="padding:-1.25pt 3.0pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.18.16">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb" id="S3.T2.3.18.16.1" style="padding:-1.25pt 3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T2.3.18.16.2" style="background-color:#E6E6E6;padding:-1.25pt 3.0pt;"><span class="ltx_text" id="S3.T2.3.18.16.2.1" style="background-color:#E6E6E6;">CLIP-LESSR</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.18.16.3" style="padding:-1.25pt 3.0pt;">6.85</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.18.16.4" style="padding:-1.25pt 3.0pt;">10.96</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.18.16.5" style="padding:-1.25pt 3.0pt;">-1.89</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.18.16.6" style="padding:-1.25pt 3.0pt;">14.94</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.18.16.7" style="padding:-1.25pt 3.0pt;">19.07</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.18.16.8" style="padding:-1.25pt 3.0pt;">+1.21</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.18.16.9" style="padding:-1.25pt 3.0pt;">39.07</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.18.16.10" style="padding:-1.25pt 3.0pt;">48.21</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.18.16.11" style="padding:-1.25pt 3.0pt;">+0.35</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We have conducted extensive experiments to evaluate the proposed CLIP-SBR by answering the following four key research questions:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">RQ1:</span> Does CLIP-SBR improve the recommendation performance of SBR baseline models?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">RQ2:</span> Does the <span class="ltx_text ltx_font_italic" id="S4.I1.i2.p1.1.2">Item Relationship Mining</span> module effectively capture and utilize complex item relationships?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">RQ3:</span> Does the <span class="ltx_text ltx_font_italic" id="S4.I1.i3.p1.1.2">Item Cluster-aware Prompt Learning</span> module effectively and efficiently integrate item relationships into the recommendation process effectively and efficiently?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1">RQ4:</span> How do different hyper-parameter settings impact the effectiveness of the CLIP-SBR framework?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Setup</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1. </span>Datasets</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">We employ three benchmark datasets that are widely used in the session-based recommendation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_italic" id="S4.I2.i1.p1.1.1">Last.fm<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_upright" id="footnote1.1.1.1">1</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_upright" href="http://ocelma.net/MusicRecommendationDataset/lastfm-1K.html" title="">http://ocelma.net/MusicRecommendationDataset/lastfm-1K.html</a></span></span></span></span> contains the complete listening behavior of approximately 1,000 users collected from Last.fm. In this paper, we focus on the music artist recommendation. We consider the top 40,000 most popular artists and group interaction records within an 8-hour window from the same user as a session, following former studies <cite class="ltx_cite ltx_citemacro_citep">(Chen and Wong, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib4" title="">2020</a>; Guo et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib7" title="">2019</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S4.I2.i2.p1.1.1">Xing<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_upright" id="footnote2.1.1.1">2</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_upright" href="http://2016.recsyschallenge.com/" title="">http://2016.recsyschallenge.com/</a></span></span></span></span> gathers job postings from a social networking platform, including interactions with the postings by 770,000 users. We split user’s records into sessions following <cite class="ltx_cite ltx_citemacro_citep">(Quadrana et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib24" title="">2017</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_italic" id="S4.I2.i3.p1.1.1">Reddit<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_upright" id="footnote3.1.1.1">3</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_upright" href="https://www.kaggle.com/colemaclean/subreddit-interactions" title="">https://www.kaggle.com/colemaclean/subreddit-interactions</a></span></span></span></span> is a dataset collected from social media that includes tuples consisting of a user name, a subreddit where the user commented on a thread, and a timestamp of the interaction. The interaction data was segmented into sessions using a 60-minute time threshold, as outlined in <cite class="ltx_cite ltx_citemacro_citep">(Ludewig et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib21" title="">2019</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p2">
<p class="ltx_p" id="S4.SS1.SSS1.p2.2">Using the preprocessed data provided in <cite class="ltx_cite ltx_citemacro_citep">(Pang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib22" title="">2022</a>)</cite> as a basis, we further process by following the previous studies <cite class="ltx_cite ltx_citemacro_citep">(Chen and Wong, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib4" title="">2020</a>; Quadrana et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib24" title="">2017</a>; Wang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib32" title="">2020</a>)</cite>, removing sessions with fewer than three interactions to exclude less informative data. Additionally, we retain only users with five or more sessions to ensure sufficient historical data. We allocated 10% of the sessions as the test set and the penultimate 10% as the validation set, with the remaining sessions used for training. Furthermore, for a session <math alttext="\mathcal{S}_{t}=\{v^{t}_{1},v^{t}_{2},\cdots,v^{t}_{\mid\mathcal{S}_{t}\mid}\}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p2.1.m1.5"><semantics id="S4.SS1.SSS1.p2.1.m1.5a"><mrow id="S4.SS1.SSS1.p2.1.m1.5.5" xref="S4.SS1.SSS1.p2.1.m1.5.5.cmml"><msub id="S4.SS1.SSS1.p2.1.m1.5.5.5" xref="S4.SS1.SSS1.p2.1.m1.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p2.1.m1.5.5.5.2" xref="S4.SS1.SSS1.p2.1.m1.5.5.5.2.cmml">𝒮</mi><mi id="S4.SS1.SSS1.p2.1.m1.5.5.5.3" xref="S4.SS1.SSS1.p2.1.m1.5.5.5.3.cmml">t</mi></msub><mo id="S4.SS1.SSS1.p2.1.m1.5.5.4" xref="S4.SS1.SSS1.p2.1.m1.5.5.4.cmml">=</mo><mrow id="S4.SS1.SSS1.p2.1.m1.5.5.3.3" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.4.cmml"><mo id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.4" stretchy="false" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.4.cmml">{</mo><msubsup id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.2.2" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.2.2.cmml">v</mi><mn id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.3" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.3.cmml">1</mn><mi id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.2.3" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.5" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.4.cmml">,</mo><msubsup id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.cmml"><mi id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.2.2" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.2.2.cmml">v</mi><mn id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.3" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.3.cmml">2</mn><mi id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.2.3" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.6" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.4.cmml">,</mo><mi id="S4.SS1.SSS1.p2.1.m1.2.2" mathvariant="normal" xref="S4.SS1.SSS1.p2.1.m1.2.2.cmml">⋯</mi><mo id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.7" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.4.cmml">,</mo><msubsup id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.cmml"><mi id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.2.2" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.2.2.cmml">v</mi><mrow id="S4.SS1.SSS1.p2.1.m1.1.1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.2.cmml"><mo fence="true" id="S4.SS1.SSS1.p2.1.m1.1.1.1.1.2" rspace="0em" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.2.1.cmml">∣</mo><msub id="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo fence="true" id="S4.SS1.SSS1.p2.1.m1.1.1.1.1.3" lspace="0em" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.2.1.cmml">∣</mo></mrow><mi id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.2.3" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.8" stretchy="false" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.1.m1.5b"><apply id="S4.SS1.SSS1.p2.1.m1.5.5.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5"><eq id="S4.SS1.SSS1.p2.1.m1.5.5.4.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.4"></eq><apply id="S4.SS1.SSS1.p2.1.m1.5.5.5.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.5"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.5.5.5.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.5">subscript</csymbol><ci id="S4.SS1.SSS1.p2.1.m1.5.5.5.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.5.2">𝒮</ci><ci id="S4.SS1.SSS1.p2.1.m1.5.5.5.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.5.3">𝑡</ci></apply><set id="S4.SS1.SSS1.p2.1.m1.5.5.3.4.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.3"><apply id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1">subscript</csymbol><apply id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.2.3">𝑡</ci></apply><cn id="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS1.p2.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2">superscript</csymbol><ci id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.2.3">𝑡</ci></apply><cn id="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="S4.SS1.SSS1.p2.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S4.SS1.SSS1.p2.1.m1.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.2">⋯</ci><apply id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3">subscript</csymbol><apply id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.2.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3">superscript</csymbol><ci id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.2.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.5.5.3.3.3.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p2.1.m1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p2.1.m1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1.2">delimited-∣∣</csymbol><apply id="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.2">𝒮</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.1.m1.5c">\mathcal{S}_{t}=\{v^{t}_{1},v^{t}_{2},\cdots,v^{t}_{\mid\mathcal{S}_{t}\mid}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.1.m1.5d">caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = { italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∣ caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ end_POSTSUBSCRIPT }</annotation></semantics></math>, we generate sequences and corresponding labels by a sequence splitting preprocessing, i.e.,<math alttext="(\{v^{t}_{1}\},v^{t}_{2}),(\{v^{t}_{1},v^{t}_{2}\},v^{t}_{3}),\cdots,(\{v^{t}_%
{1},v^{t}_{2},\cdots,v^{t}_{\mid\mathcal{S}_{t}\mid-1}\},v^{t}_{\mid\mathcal{S%
}_{t}\mid})" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p2.2.m2.7"><semantics id="S4.SS1.SSS1.p2.2.m2.7a"><mrow id="S4.SS1.SSS1.p2.2.m2.7.7.3" xref="S4.SS1.SSS1.p2.2.m2.7.7.4.cmml"><mrow id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.3.cmml"><mo id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.3" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.3.cmml">(</mo><mrow id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.2.cmml"><mo id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.2.cmml">{</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.2.2" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.2.2.cmml">v</mi><mn id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.3.cmml">1</mn><mi id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.2.3" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.2.cmml">}</mo></mrow><mo id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.4" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.3.cmml">,</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.2.2" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.2.2.cmml">v</mi><mn id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.3.cmml">2</mn><mi id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.5" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.3.cmml">)</mo></mrow><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.4" xref="S4.SS1.SSS1.p2.2.m2.7.7.4.cmml">,</mo><mrow id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.3.cmml"><mo id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.3" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.3.cmml">(</mo><mrow id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.3.cmml"><mo id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.3" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.3.cmml">{</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.2.2" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.2.2.cmml">v</mi><mn id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.3" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.3.cmml">1</mn><mi id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.2.3" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.4" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.3.cmml">,</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.2.2" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.2.2.cmml">v</mi><mn id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.3.cmml">2</mn><mi id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.5" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.3.cmml">}</mo></mrow><mo id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.4" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.3.cmml">,</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.2.2" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.2.2.cmml">v</mi><mn id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.3.cmml">3</mn><mi id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.5" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.3.cmml">)</mo></mrow><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.5" xref="S4.SS1.SSS1.p2.2.m2.7.7.4.cmml">,</mo><mi id="S4.SS1.SSS1.p2.2.m2.4.4" mathvariant="normal" xref="S4.SS1.SSS1.p2.2.m2.4.4.cmml">⋯</mi><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.6" xref="S4.SS1.SSS1.p2.2.m2.7.7.4.cmml">,</mo><mrow id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.3.cmml"><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.3" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.3.cmml">(</mo><mrow id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.4.cmml"><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.4" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.4.cmml">{</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.2.2" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.2.2.cmml">v</mi><mn id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.3" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.3.cmml">1</mn><mi id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.2.3" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.5" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.4.cmml">,</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.2.2" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.2.2.cmml">v</mi><mn id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.3.cmml">2</mn><mi id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.6" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.4.cmml">,</mo><mi id="S4.SS1.SSS1.p2.2.m2.3.3" mathvariant="normal" xref="S4.SS1.SSS1.p2.2.m2.3.3.cmml">⋯</mi><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.7" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.4.cmml">,</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.2.2" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.2.2.cmml">v</mi><mrow id="S4.SS1.SSS1.p2.2.m2.1.1.1" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.cmml"><mrow id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.2.cmml"><mo fence="true" id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.2" rspace="0em" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.2.1.cmml">∣</mo><msub id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo fence="true" id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.2.1.cmml">∣</mo></mrow><mo id="S4.SS1.SSS1.p2.2.m2.1.1.1.2" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.2.cmml">−</mo><mn id="S4.SS1.SSS1.p2.2.m2.1.1.1.3" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.3.cmml">1</mn></mrow><mi id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.2.3" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.8" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.4.cmml">}</mo></mrow><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.4" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.3.cmml">,</mo><msubsup id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.2.2" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.2.2.cmml">v</mi><mrow id="S4.SS1.SSS1.p2.2.m2.2.2.1.1" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.2.cmml"><mo fence="true" id="S4.SS1.SSS1.p2.2.m2.2.2.1.1.2" rspace="0em" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.2.1.cmml">∣</mo><msub id="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.2" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.2.cmml">𝒮</mi><mi id="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.3" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.3.cmml">t</mi></msub><mo fence="true" id="S4.SS1.SSS1.p2.2.m2.2.2.1.1.3" lspace="0em" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.2.1.cmml">∣</mo></mrow><mi id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.2.3" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.2.3.cmml">t</mi></msubsup><mo id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.5" stretchy="false" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.2.m2.7b"><list id="S4.SS1.SSS1.p2.2.m2.7.7.4.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3"><interval closure="open" id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2"><set id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1"><apply id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1">subscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.2.3">𝑡</ci></apply><cn id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.1.1.1.1.3">1</cn></apply></set><apply id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.2.3">𝑡</ci></apply><cn id="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.3.cmml" type="integer" xref="S4.SS1.SSS1.p2.2.m2.5.5.1.1.2.2.3">2</cn></apply></interval><interval closure="open" id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2"><set id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2"><apply id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1">subscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.2.3">𝑡</ci></apply><cn id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.1.1.3">1</cn></apply><apply id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.2.3">𝑡</ci></apply><cn id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.3.cmml" type="integer" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.1.1.2.2.3">2</cn></apply></set><apply id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.2.3">𝑡</ci></apply><cn id="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.SSS1.p2.2.m2.6.6.2.2.2.2.3">3</cn></apply></interval><ci id="S4.SS1.SSS1.p2.2.m2.4.4.cmml" xref="S4.SS1.SSS1.p2.2.m2.4.4">⋯</ci><interval closure="open" id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2"><set id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.4.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3"><apply id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1">subscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.2.3">𝑡</ci></apply><cn id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.1.1.3">1</cn></apply><apply id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.2.3">𝑡</ci></apply><cn id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.3.cmml" type="integer" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.2.2.3">2</cn></apply><ci id="S4.SS1.SSS1.p2.2.m2.3.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.3.3">⋯</ci><apply id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3">subscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.1.1.3.3.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.1"><minus id="S4.SS1.SSS1.p2.2.m2.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.2"></minus><apply id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.2">delimited-∣∣</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.2">𝒮</ci><ci id="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.3">𝑡</ci></apply></apply><cn id="S4.SS1.SSS1.p2.2.m2.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS1.p2.2.m2.1.1.1.3">1</cn></apply></apply></set><apply id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.2.2">𝑣</ci><ci id="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.7.7.3.3.2.2.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p2.2.m2.2.2.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p2.2.m2.2.2.1.2.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.1.2">delimited-∣∣</csymbol><apply id="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.2">𝒮</ci><ci id="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.2.2.1.1.1.3">𝑡</ci></apply></apply></apply></interval></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.2.m2.7c">(\{v^{t}_{1}\},v^{t}_{2}),(\{v^{t}_{1},v^{t}_{2}\},v^{t}_{3}),\cdots,(\{v^{t}_%
{1},v^{t}_{2},\cdots,v^{t}_{\mid\mathcal{S}_{t}\mid-1}\},v^{t}_{\mid\mathcal{S%
}_{t}\mid})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.2.m2.7d">( { italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT } , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , ( { italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT } , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ) , ⋯ , ( { italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∣ caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ - 1 end_POSTSUBSCRIPT } , italic_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∣ caligraphic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ end_POSTSUBSCRIPT )</annotation></semantics></math> for tra
<br class="ltx_break">ining, valid and test across all the three datasets. The statistics of datasets, after preprocessing, are summarized in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3.T1" title="Table 1 ‣ 3.3. Item Cluster-aware Prompt Learning ‣ 3. Proposed Method ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p3">
<p class="ltx_p" id="S4.SS1.SSS1.p3.1">Many prior studies use sampled metrics by ranking relevant items alongside a smaller subset of randomly selected items to accelerate calculations. However, this sampling technique can lead to discrepancies compared to the full, unsampled counterparts <cite class="ltx_cite ltx_citemacro_citep">(Krichene and Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib12" title="">2020</a>)</cite>. Therefore, in line with previous works <cite class="ltx_cite ltx_citemacro_citep">(Xie et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib34" title="">2022</a>)</cite>, we assess each method on the entire item set without sampling, ranking all items that the user has not interacted with based on their similarity scores.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2. </span>Baselines</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">To evaluate the effectiveness of our approach, we compare its performance against a diverse set of well-established methods. The first five baselines focus soley on <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS2.p1.1.1">intra-session</span> information, while the last three incorporate both <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS2.p1.1.2">intra-session</span> and <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS2.p1.1.3">inter-session</span> information. We assess our method across various model architectures, including those based on RNNs, GNNs, and attention mechanisms, to demonstrate the applicability and effectiveness of our method across different model architectures.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.SSS2.p2">
<ul class="ltx_itemize" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i1.p1.1.1">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib9" title="">2016</a>)</cite> is a RNN-based model that employs the Gated Recurrent Unit (GRU) to model interaction sequences.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i2.p1.1.1">NARM</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib15" title="">2017</a>)</cite> is a RNN-based model that improves over GRU4Rec by applying an attention mechanism alongside GRU.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i3.p1">
<p class="ltx_p" id="S4.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i3.p1.1.1">CORE</span> <cite class="ltx_cite ltx_citemacro_citep">(Hou et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib10" title="">2022</a>)</cite> unifies the representation space for both encoding and decoding processes by using a representation-consistent encoder ensuring that session embeddings and item embeddings are in the same space.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i4.p1">
<p class="ltx_p" id="S4.I3.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i4.p1.1.1">SRGNN</span> <cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib33" title="">2019</a>)</cite> transforms session sequences into directed unweighted graphs and applies a gated graph convolutional layer to identify item transition patterns.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i5.p1">
<p class="ltx_p" id="S4.I3.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i5.p1.1.1">TAGNN</span> <cite class="ltx_cite ltx_citemacro_citep">(Yu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib36" title="">2020</a>)</cite> is a variant of SRGNN that utilizes target-aware attention network to generate session embeddings by incorporating the features of the candidate item during prediction.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I3.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i6.p1">
<p class="ltx_p" id="S4.I3.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i6.p1.1.1">GCSAN</span> <cite class="ltx_cite ltx_citemacro_citep">(Xu et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib35" title="">2019</a>)</cite> extracts local context information using a GGNN and then employs a self-attention mechanism to capture explicit dependencies.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I3.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i7.p1">
<p class="ltx_p" id="S4.I3.i7.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i7.p1.1.1">GCEGNN</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib32" title="">2020</a>)</cite> integrates both global context and item sequences from the current session to produce session embeddings through multi-level graph neural networks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I3.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i8.p1">
<p class="ltx_p" id="S4.I3.i8.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i8.p1.1.1">LESSR</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen and Wong, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib4" title="">2020</a>)</cite> introduces shortcut connections between items within a session and incorporates sequence information into graph convolution with the help of GRU.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3. </span>Evaluation Metrics</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS3.p1">
<p class="ltx_p" id="S4.SS1.SSS3.p1.1">To evaluate the performance of the recommendation, we use two metrics widely adopted in SBR evaluation: Mean Reciprocal Rank (MRR@<span class="ltx_text ltx_font_italic" id="S4.SS1.SSS3.p1.1.1">k</span>) and Recall (Recall@<span class="ltx_text ltx_font_italic" id="S4.SS1.SSS3.p1.1.2">k</span>) following <cite class="ltx_cite ltx_citemacro_citep">(Ruocco et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib25" title="">2017</a>; Li et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib15" title="">2017</a>; Quadrana et&nbsp;al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#bib.bib24" title="">2017</a>)</cite>, where <math alttext="k=5" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.1.m1.1"><semantics id="S4.SS1.SSS3.p1.1.m1.1a"><mrow id="S4.SS1.SSS3.p1.1.m1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml">k</mi><mo id="S4.SS1.SSS3.p1.1.m1.1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.1.m1.1.1.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.1.m1.1b"><apply id="S4.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1"><eq id="S4.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1"></eq><ci id="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.2">𝑘</ci><cn id="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.1.m1.1c">k=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.1.m1.1d">italic_k = 5</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.4. </span>Implementation Details</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS4.p1">
<p class="ltx_p" id="S4.SS1.SSS4.p1.1">We implement CLIP-SBR using a popular open-source recommender systems library <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS4.p1.1.1">RecBole<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_upright" id="footnote4.1.1.1">4</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_upright" href="https://recbole.io/" title="">https://recbole.io</a></span></span></span></span>. All methods are optimized with the Adam optimizer, and we employ early stopping with a patience of 50 epochs to prevent overfitting, using MRR@5 as the indicator. The batch size is tuned from {64, 128, 256, 512, 1024} and learning rate from {0.001, 0.005, 0.01, 0.05}. For the Leiden algorithm used in item cluster detection, the resolution value is set to 1, with its impact discussed in detail in Section&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS2.SSS4" title="4.2.4. Impact of hyperparameter ‣ 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">4.2.4</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Results</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1. </span>Overall Performance (RQ1)</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.1">Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3.T2" title="Table 2 ‣ 3.3. Item Cluster-aware Prompt Learning ‣ 3. Proposed Method ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> presents the experimental results of the eight baselines and their corresponding implementations using the CLIP-SBR framework on three real-world datasets. The best result in each column is highlighted in bold, and the top result within the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p1.1.1">intra-session</span> category is underlined. We applied the CLIP-SBR framework to both <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p1.1.2">intra-session</span> and <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p1.1.3">inter-session</span> baselines to assess its impact. The results show that the CLIP-SBR leads to performance improvements across most of the baselines.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p2">
<p class="ltx_p" id="S4.SS2.SSS1.p2.1">In the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p2.1.1">intra-session</span> baselines, we observed substantial improvements across the board, with the most significant performance gains in the NARM model. For the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p2.1.2">inter-session</span> baselines, CLIP-SBR demonstrated notable improvements in GCSAN, while having a smaller impact on GCEGNN and no improvement on LESSR. Further analysis of the impact of applying CLIP-SBR to inter-session baselines is provided in Section&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS2.SSS3" title="4.2.3. Impact of Item Cluster-aware Prompt Learning (RQ3) ‣ 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">4.2.3</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p3">
<p class="ltx_p" id="S4.SS2.SSS1.p3.1">Moreover, the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p3.1.1">inter-session</span> baselines (GCSAN, GCEGNN, LESSR) demonstrate comparable or even better performance than the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p3.1.2">intra-session</span> baselines. Notably, GCEGNN outperforms all <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p3.1.3">intra-session</span> models on the Last.fm dataset, and LESSR achieves the highest metrics on the Xing dataset. These results highlight the potential of incorporating inter-session information to improve recommendation accuracy, emphasizing the importance of considering both intra-session and inter-session item relationships when developing robust session-based recommendation models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p4">
<p class="ltx_p" id="S4.SS2.SSS1.p4.1">The application of the CLIP-SBR framework to the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p4.1.1">intra-session</span> baselines resulted in performance improvements in all but one case. Specifically, NARM saw a substantial improvement of 45.30% on Last.fm, 20.11% on Xing, and 13.04% on Reddit, marking it as one of the most improved models. TAGNN also demonstrated significant gains, particularly on Last.fm with a 33.91% increase, 15.31% on Xing, and 2.33% on Reddit. Similarly, GRU4Rec achieved notable enhancements of 29.77% on Last.fm, 7.61% on Xing, and 11.10% on Reddit. CORE exhibited improvements of 1.92%, 16.65%, and 4.51% across the respective datasets, while SRGNN showed increases of 31.54%, 1.44%, and 4.26% on the three datasets. When comparing intra-session CLIP-SBR models with inter-session models, the CLIP-SBR models generally outperformed in many instances. Notably, CLIP-TAGNN consistently surpassed all inter-session models across. CLIP-SRGNN also outperformed inter-session models on Last.fm and Reddit dataset, and outperformed GCSAN in MRR@5 and Recall@5, and GCEGNN in MRR@5. This indicates that the CLIP-SBR framework is highly effective in leveraging and designing inter-session information, leading to better overall performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p5">
<p class="ltx_p" id="S4.SS2.SSS1.p5.1">We also applied CLIP-SBR to the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p5.1.1">inter-session</span> models to assess its effectiveness. The impact varied across the three models: it had a substantial effect on GCSAN, a slight effect on GCEGNN, and almost no effect on LESSR. This suggests that the CLIP-SBR is less beneficial for GCEGNN that already capture inter-session information effectively, while providing significant improvements for GCSAN that do not sufficiently address it. For LESSR, the lack of improvement indicates that the model may not effectively utilize the additional information provided by CLIP-SBR. The impact of CLIP-SBR on <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p5.1.2">inter-session</span> models is further discussed in Section&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.SS2.SSS3" title="4.2.3. Impact of Item Cluster-aware Prompt Learning (RQ3) ‣ 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">4.2.3</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2. </span>Impact of <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS2.1.1">Item Relationship Mining</span> (RQ2)</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.1">We evaluated the impact of the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS2.p1.1.1">Item Relationship Mining</span> module in CLIP-SBR by assessing performance across seven different scenarios.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p2">
<ul class="ltx_itemize" id="S4.I4">
<li class="ltx_item" id="S4.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i1.p1">
<p class="ltx_p" id="S4.I4.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i1.p1.1.1">C</span>: The original CLIP-SBR applies distinct learnable prompts for each item’s cluster, embedding them into the item representations. This allows the model to capture group-level item relationships and patterns across sessions.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i2.p1">
<p class="ltx_p" id="S4.I4.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i2.p1.1.1">U</span>: User-specific prompts are added to item embeddings, maintaining a consistent prompt for a given user across all sessions. This helps the model capture user preferences and long-term behavioral patterns across sessions.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i3.p1">
<p class="ltx_p" id="S4.I4.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i3.p1.1.1">S</span>: Session-specific prompts are applied to all items within a session, helping the model learn session-level patterns that reflect user intent or context within a specific session.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i4.p1">
<p class="ltx_p" id="S4.I4.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i4.p1.1.1">CU</span>: Combines both cluster and user-specific prompts. Cluster prompts capture relational structure among items, while user prompts represent long-term user preferences, enabling a deeper understanding of user behavior and item relations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I4.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i5.p1">
<p class="ltx_p" id="S4.I4.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i5.p1.1.1">CS</span>: Combines cluster and session-specific prompts, adding both to item embeddings. This captures the dynamic context of the session (via session prompts) while preserving item relationships within clusters (via cluster prompts).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I4.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i6.p1">
<p class="ltx_p" id="S4.I4.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i6.p1.1.1">US</span>: Combines user and session-specific prompts to balance short-term session intent with long-term user preferences. This enables the model to capture how user behavior shifts across sessions while keeping user-specific patterns maintained.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I4.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i7.p1">
<p class="ltx_p" id="S4.I4.i7.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i7.p1.1.1">CUS</span>: Combines cluster, user, and session-specific prompts, creating a comprehensive embedding. This setup captures group-level item relationships, user preferences across sessions, and dynamic session behavior simultaneously.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS2.SSS2.p2.1">We trained these seven types of models for each baselines on each dataset and evaluated their performance improvement using MRR@5 and Recall@5 metrics. The results, as shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.F2" title="Figure 2 ‣ 4.2.2. Impact of Item Relationship Mining (RQ2) ‣ 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, reveal that in almost all cases, the original CLIP-SBR models with cluster prompts (<span class="ltx_text ltx_font_bold" id="S4.SS2.SSS2.p2.1.1">C</span>) exhibited the most significant improvement compared to the baseline models. Notably, models using user-specific prompts (<span class="ltx_text ltx_font_bold" id="S4.SS2.SSS2.p2.1.2">U</span>) showed the second highest improvement, indicating that incorporating user-specific prompts effectively provided personalizing information during the training phase, thereby enhancing the performance of the SBR models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="196" id="S4.F2.g1" src="https://arxiv.org/html/2410.04756v1/extracted/5906175/figures/Result1_lastfm.png" width="598"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="196" id="S4.F2.g2" src="https://arxiv.org/html/2410.04756v1/extracted/5906175/figures/Result1_xing.png" width="598"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="196" id="S4.F2.g3" src="https://arxiv.org/html/2410.04756v1/extracted/5906175/figures/Result1_reddit.png" width="598"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>
Improvement (%) comparison of CLIP-SBR variants on the three datasets. The blue bar represents the original CLIP-SBR, while the other colors indicate various CLIP-SBR variants. ”Avg. Improv.” refers to the average of improvement percentage calculated from MRR@5 and Recall@5.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS2.p3">
<p class="ltx_p" id="S4.SS2.SSS2.p3.1">In contrast, other scenarios, especially those involving combinations of prompts, did not yield similar improvements and often resulted in performance decreases. This decline can be attributed to the added prompts acting as noise, disrupting the training of the SBR models. For instance, models with combined prompts showed inconsistent or negative performance, as observed in the CORE on the Last.fm dataset and most models on the Xing dataset. This effect is even more pronounced on the Reddit dataset, where most models with combined prompts experienced a decline in performance.
In summary, among all prompt-based approaches, cluster prompts (<span class="ltx_text ltx_font_bold" id="S4.SS2.SSS2.p3.1.1">C</span>) proved to be the most effective. This outcome suggests that the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS2.p3.1.2">Item Relationship Mining</span> module successfully identifies item communities that share similar user preferences by effectively considering both intra- and inter-session item relationships. These findings highlight the superiority of the module in mining item communities within sessions and underscore its critical role in the CLIP-SBR framework, confirming its effectiveness in enhancing session-based recommendation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3. </span>Comparison of MRR@5 and average training time (in seconds) for the proposed methods and inter-session baselines on the three datasets. Our proposed models are highlighted in gray.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.1.1.1.1" style="padding:-0.45pt 2.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.1" style="font-size:90%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T3.1.1.1.2" style="padding:-0.45pt 2.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.2.1" style="font-size:90%;">Last.fm</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T3.1.1.1.3" style="padding:-0.45pt 2.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.3.1" style="font-size:90%;">Xing</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T3.1.1.1.4" style="padding:-0.45pt 2.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.4.1" style="font-size:90%;">Reddit</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.2.1">
<th class="ltx_td ltx_th ltx_th_row" id="S4.T3.1.2.1.1" style="padding:-0.45pt 2.5pt;"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.2" style="padding:-0.45pt 2.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.2.1.2.1" style="font-size:90%;">MRR@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.3" style="padding:-0.45pt 2.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.2.1.3.1" style="font-size:90%;">Time</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.4" style="padding:-0.45pt 2.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.2.1.4.1" style="font-size:90%;">MRR@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.5" style="padding:-0.45pt 2.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.2.1.5.1" style="font-size:90%;">Time</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.6" style="padding:-0.45pt 2.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.2.1.6.1" style="font-size:90%;">MRR@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.7" style="padding:-0.45pt 2.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.2.1.7.1" style="font-size:90%;">Time</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.3.2.1" style="background-color:#E6E6E6;padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.3.2.1.1" style="font-size:90%;background-color:#E6E6E6;">CLIP-GRU4Rec</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.2.2" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.3.2.2.1" style="font-size:90%;">10.07</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.2.3" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.3.2.3.1" style="font-size:90%;">745.11</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.2.4" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.3.2.4.1" style="font-size:90%;">11.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.2.5" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.3.2.5.1" style="font-size:90%;">6.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.2.6" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.3.2.6.1" style="font-size:90%;">40.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.2.7" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.3.2.7.1" style="font-size:90%;">30.66</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.4.3.1" style="background-color:#E6E6E6;padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.4.3.1.1" style="font-size:90%;background-color:#E6E6E6;">CLIP-NARM</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.4.3.2" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.4.3.2.1" style="font-size:90%;">8.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.4.3.3" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.4.3.3.1" style="font-size:90%;">791.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.4.3.4" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.4.3.4.1" style="font-size:90%;">12.04</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.4.3.5" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.4.3.5.1" style="font-size:90%;">6.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.4.3.6" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.4.3.6.1" style="font-size:90%;">38.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.4.3.7" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.4.3.7.1" style="font-size:90%;">34.26</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.5.4.1" style="background-color:#E6E6E6;padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.5.4.1.1" style="font-size:90%;background-color:#E6E6E6;">CLIP-CORE</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.4.2" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.5.4.2.1" style="font-size:90%;">10.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.4.3" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.5.4.3.1" style="font-size:90%;">660.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.4.4" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.5.4.4.1" style="font-size:90%;">12.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.4.5" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.5.4.5.1" style="font-size:90%;">14.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.4.6" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.5.4.6.1" style="font-size:90%;">31.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.5.4.7" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.5.4.7.1" style="font-size:90%;">82.55</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.6.5.1" style="background-color:#E6E6E6;padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.6.5.1.1" style="font-size:90%;background-color:#E6E6E6;">CLIP-SRGNN</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.6.5.2" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.6.5.2.1" style="font-size:90%;">12.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.6.5.3" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.6.5.3.1" style="font-size:90%;">619.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.6.5.4" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.6.5.4.1" style="font-size:90%;">14.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.6.5.5" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.6.5.5.1" style="font-size:90%;">56.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.6.5.6" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.6.5.6.1" style="font-size:90%;">39.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.6.5.7" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.6.5.7.1" style="font-size:90%;">196.71</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.7.6.1" style="background-color:#E6E6E6;padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.7.6.1.1" style="font-size:90%;background-color:#E6E6E6;">CLIP-TAGNN</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.6.2" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.7.6.2.1" style="font-size:90%;">12.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.6.3" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.7.6.3.1" style="font-size:90%;">1416.41</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.6.4" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.7.6.4.1" style="font-size:90%;">14.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.6.5" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.7.6.5.1" style="font-size:90%;">197.62</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.6.6" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.7.6.6.1" style="font-size:90%;">41.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.6.7" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.7.6.7.1" style="font-size:90%;">290.83</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.8.7.1" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.8.7.1.1" style="font-size:90%;">GCSAN</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.8.7.2" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.8.7.2.1" style="font-size:90%;">4.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.8.7.3" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.8.7.3.1" style="font-size:90%;">1032.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.8.7.4" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.8.7.4.1" style="font-size:90%;">13.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.8.7.5" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.8.7.5.1" style="font-size:90%;">92.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.8.7.6" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.8.7.6.1" style="font-size:90%;">36.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.8.7.7" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.8.7.7.1" style="font-size:90%;">435.70</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.9.8.1" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.9.8.1.1" style="font-size:90%;">GCEGNN</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.8.2" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.9.8.2.1" style="font-size:90%;">10.81</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.8.3" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.9.8.3.1" style="font-size:90%;">625.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.8.4" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.9.8.4.1" style="font-size:90%;">12.83</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.8.5" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.9.8.5.1" style="font-size:90%;">60.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.8.6" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.9.8.6.1" style="font-size:90%;">38.17</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.9.8.7" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.9.8.7.1" style="font-size:90%;">260.64</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T3.1.10.9.1" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.10.9.1.1" style="font-size:90%;">LESSR</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.1.10.9.2" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.10.9.2.1" style="font-size:90%;">7.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.1.10.9.3" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.10.9.3.1" style="font-size:90%;">758.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.1.10.9.4" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.10.9.4.1" style="font-size:90%;">14.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.1.10.9.5" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.10.9.5.1" style="font-size:90%;">57.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.1.10.9.6" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.10.9.6.1" style="font-size:90%;">39.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.1.10.9.7" style="padding:-0.45pt 2.5pt;"><span class="ltx_text" id="S4.T3.1.10.9.7.1" style="font-size:90%;">382.98</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.3. </span>Impact of <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS3.1.1">Item Cluster-aware Prompt Learning</span> (RQ3)</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS3.p1">
<p class="ltx_p" id="S4.SS2.SSS3.p1.1">To evaluate the impact of the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS3.p1.1.1">Item Cluster-aware Prompt Learning</span> module, we assessed its effectiveness on <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS3.p1.1.2">intra-session</span> and <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS3.p1.1.3">inter-session</span> SBR models. As shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S3.T2" title="Table 2 ‣ 3.3. Item Cluster-aware Prompt Learning ‣ 3. Proposed Method ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> and Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.F2" title="Figure 2 ‣ 4.2.2. Impact of Item Relationship Mining (RQ2) ‣ 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, our approach demonstrates substantial performance improvements, highlighting both the effectiveness and efficiency of the module. In terms of effectiveness, applying the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS3.p1.1.4">Item Cluster-aware Prompt Learning</span> module led to significant performance improvements in <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS3.p1.1.5">inter-session</span> baselines. Specifically, CLIP-GCSAN showed notable gains, effectively compensating for GCSAN’s limitations in capturing inter-session information, particularly on the Last.fm dataset. For GCEGNN, the module provided moderate improvements, suggesting that while GCEGNN already captures inter-session information effectively, the prompts still offer additional value. Conversely, CLIP-LESSR showed no improvement over the original LESSR, indicating that LESSR’s inherent handling of inter-session information leaves little room for further enhancement from the prompts. Regarding efficiency, the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS3.p1.1.6">Item Cluster-aware Prompt Learning</span> module demonstrated significant advantages in terms of training time. As shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.T3" title="Table 3 ‣ 4.2.2. Impact of Item Relationship Mining (RQ2) ‣ 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, several CLIP models achieved better or comparable performance (MRR@5) with significantly less training time compared to the inter-session baselines (GCSAN, GCEGNN, LESSR).
Among the CLIP models, CLIP-SRGNN shows a good balance between effectiveness and efficiency. It outperformed the inter-session baselines on Last.fm and Reddit, achieving higher MRR@5 with reduced training times—619.79 seconds on Last.fm and 196.71 seconds on Reddit, compared to GCSAN’s 1032.88 seconds, GCEGNN’s 625.71 seconds, and LESSR’s 758.59 seconds on Last.fm, as well as the significantly longer times of the inter-session baselines on Reddit. For the Xing dataset, CLIP-SRGNN achieved comparable performance to the inter-session models while still requiring considerably less time—56.33 seconds versus 92.70 seconds for GCSAN and 60.60 seconds for GCEGNN. The CLIP-TAGNN achieves the best performance on MRR@5 at the expense of longer training time.
This highlights the efficiency of the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS3.p1.1.7">Item Cluster-aware Prompt Learning</span> module, which achieves comparable or superior performance with reduced training time.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="296" id="S4.F3.g1" src="https://arxiv.org/html/2410.04756v1/extracted/5906175/figures/Result2.png" width="598">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>
Performance comparison of CLIP-GRU4Rec with different resolution parameters on the three datasets. The MRR@5 scale for Last.fm and Xing is shown on the left y-axis, while the scale for Reddit is on the right y-axis.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.4. </span>Impact of hyperparameter</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS4.p1">
<p class="ltx_p" id="S4.SS2.SSS4.p1.1">The <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS4.p1.1.1">Item Relationship Mining</span> module in CLIP-SBR uses the Leiden algorithm for item cluster detection, with the resolution parameter controlling the granularity of community detection. We evaluated CLIP-GRU4Rec using various resolution values <math alttext="{0.1,0.5,1,1.5,2,3,5}" class="ltx_Math" display="inline" id="S4.SS2.SSS4.p1.1.m1.7"><semantics id="S4.SS2.SSS4.p1.1.m1.7a"><mrow id="S4.SS2.SSS4.p1.1.m1.7.8.2" xref="S4.SS2.SSS4.p1.1.m1.7.8.1.cmml"><mn id="S4.SS2.SSS4.p1.1.m1.1.1" xref="S4.SS2.SSS4.p1.1.m1.1.1.cmml">0.1</mn><mo id="S4.SS2.SSS4.p1.1.m1.7.8.2.1" xref="S4.SS2.SSS4.p1.1.m1.7.8.1.cmml">,</mo><mn id="S4.SS2.SSS4.p1.1.m1.2.2" xref="S4.SS2.SSS4.p1.1.m1.2.2.cmml">0.5</mn><mo id="S4.SS2.SSS4.p1.1.m1.7.8.2.2" xref="S4.SS2.SSS4.p1.1.m1.7.8.1.cmml">,</mo><mn id="S4.SS2.SSS4.p1.1.m1.3.3" xref="S4.SS2.SSS4.p1.1.m1.3.3.cmml">1</mn><mo id="S4.SS2.SSS4.p1.1.m1.7.8.2.3" xref="S4.SS2.SSS4.p1.1.m1.7.8.1.cmml">,</mo><mn id="S4.SS2.SSS4.p1.1.m1.4.4" xref="S4.SS2.SSS4.p1.1.m1.4.4.cmml">1.5</mn><mo id="S4.SS2.SSS4.p1.1.m1.7.8.2.4" xref="S4.SS2.SSS4.p1.1.m1.7.8.1.cmml">,</mo><mn id="S4.SS2.SSS4.p1.1.m1.5.5" xref="S4.SS2.SSS4.p1.1.m1.5.5.cmml">2</mn><mo id="S4.SS2.SSS4.p1.1.m1.7.8.2.5" xref="S4.SS2.SSS4.p1.1.m1.7.8.1.cmml">,</mo><mn id="S4.SS2.SSS4.p1.1.m1.6.6" xref="S4.SS2.SSS4.p1.1.m1.6.6.cmml">3</mn><mo id="S4.SS2.SSS4.p1.1.m1.7.8.2.6" xref="S4.SS2.SSS4.p1.1.m1.7.8.1.cmml">,</mo><mn id="S4.SS2.SSS4.p1.1.m1.7.7" xref="S4.SS2.SSS4.p1.1.m1.7.7.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS4.p1.1.m1.7b"><list id="S4.SS2.SSS4.p1.1.m1.7.8.1.cmml" xref="S4.SS2.SSS4.p1.1.m1.7.8.2"><cn id="S4.SS2.SSS4.p1.1.m1.1.1.cmml" type="float" xref="S4.SS2.SSS4.p1.1.m1.1.1">0.1</cn><cn id="S4.SS2.SSS4.p1.1.m1.2.2.cmml" type="float" xref="S4.SS2.SSS4.p1.1.m1.2.2">0.5</cn><cn id="S4.SS2.SSS4.p1.1.m1.3.3.cmml" type="integer" xref="S4.SS2.SSS4.p1.1.m1.3.3">1</cn><cn id="S4.SS2.SSS4.p1.1.m1.4.4.cmml" type="float" xref="S4.SS2.SSS4.p1.1.m1.4.4">1.5</cn><cn id="S4.SS2.SSS4.p1.1.m1.5.5.cmml" type="integer" xref="S4.SS2.SSS4.p1.1.m1.5.5">2</cn><cn id="S4.SS2.SSS4.p1.1.m1.6.6.cmml" type="integer" xref="S4.SS2.SSS4.p1.1.m1.6.6">3</cn><cn id="S4.SS2.SSS4.p1.1.m1.7.7.cmml" type="integer" xref="S4.SS2.SSS4.p1.1.m1.7.7">5</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS4.p1.1.m1.7c">{0.1,0.5,1,1.5,2,3,5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS4.p1.1.m1.7d">0.1 , 0.5 , 1 , 1.5 , 2 , 3 , 5</annotation></semantics></math>, with the MRR@5 results shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04756v1#S4.F3" title="Figure 3 ‣ 4.2.3. Impact of Item Cluster-aware Prompt Learning (RQ3) ‣ 4.2. Results ‣ 4. Experiments ‣ Item Cluster-aware Prompt Learning for Session-based Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. Although no clear pattern emerged regarding how resolution changes affected performance, the model consistently performed best with a resolution of 1 across all datasets. Based on these findings, we use a resolution value of 1 in our implementation, as it effectively balances fine-grained and broader item relationships.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we introduced the CLuster-aware Item Prompt learning framework for
Session-Based Recommendation (CLIP-SBR), aimed at overcoming the limitations of existing SBR methods by effectively capturing both intra- and inter-session item relationships. The framework comprises two key modules: the first module identifies item clusters from session data, while the second module incorporates cluster-specific prompts to enhance the learning capabilities of SBR models. Extensive experiments demonstrated that CLIP-SBR consistently outperforms baseline models, highlighting its effectiveness.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blondel et&nbsp;al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2008)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Vincent&nbsp;D Blondel, Jean-Loup Guillaume, Renaud Lambiotte, and Etienne Lefebvre. 2008.

</span>
<span class="ltx_bibblock">Fast unfolding of communities in large networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Journal of statistical mechanics: theory and experiment</em> 2008, 10 (2008), P10008.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom&nbsp;B Brown. 2020.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2005.14165</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen and Wong (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tianwen Chen and Raymond Chi-Wing Wong. 2020.

</span>
<span class="ltx_bibblock">Handling information loss of graph neural networks for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 26th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1172–1180.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et&nbsp;al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Taoran Fang, Yunchao Zhang, Yang Yang, Chunping Wang, and Lei Chen. 2024.

</span>
<span class="ltx_bibblock">Universal prompt tuning for graph neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Advances in Neural Information Processing Systems</em> 36 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge et&nbsp;al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chunjiang Ge, Rui Huang, Mixue Xie, Zihang Lai, Shiji Song, Shuang Li, and Gao Huang. 2023.

</span>
<span class="ltx_bibblock">Domain adaptation via prompt learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">IEEE Transactions on Neural Networks and Learning Systems</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Lei Guo, Hongzhi Yin, Qinyong Wang, Tong Chen, Alexander Zhou, and Nguyen Quoc Viet&nbsp;Hung. 2019.

</span>
<span class="ltx_bibblock">Streaming session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1569–1577.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi and Karatzoglou (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Balázs Hidasi and Alexandros Karatzoglou. 2018.

</span>
<span class="ltx_bibblock">Recurrent Neural Networks with Top-k Gains for Session-based Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 27th ACM International Conference on Information and Knowledge Management</em> (Torino, Italy) <em class="ltx_emph ltx_font_italic" id="bib.bib8.2.2">(CIKM ’18)</em>. Association for Computing Machinery, New York, NY, USA, 843–852.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3269206.3271761" title="">https://doi.org/10.1145/3269206.3271761</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et&nbsp;al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk. 2016.

</span>
<span class="ltx_bibblock">Session-based Recommendations with Recurrent Neural Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">4th International Conference on Learning Representations, ICLR 2016, San Juan, Puerto Rico, May 2-4, 2016, Conference Track Proceedings</em>, Yoshua Bengio and Yann LeCun (Eds.).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1511.06939" title="">http://arxiv.org/abs/1511.06939</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et&nbsp;al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yupeng Hou, Binbin Hu, Zhiqiang Zhang, and Wayne&nbsp;Xin Zhao. 2022.

</span>
<span class="ltx_bibblock">Core: simple and effective session-based recommendation within consistent representation space. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 45th international ACM SIGIR conference on research and development in information retrieval</em>. 1796–1801.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jia et&nbsp;al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Menglin Jia, Luming Tang, Bor-Chun Chen, Claire Cardie, Serge Belongie, Bharath Hariharan, and Ser-Nam Lim. 2022.

</span>
<span class="ltx_bibblock">Visual prompt tuning. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">European Conference on Computer Vision</em>. Springer, 709–727.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krichene and Rendle (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Walid Krichene and Steffen Rendle. 2020.

</span>
<span class="ltx_bibblock">On sampled metrics for item recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 26th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1748–1757.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et&nbsp;al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Junhyun Lee, Wooseong Yang, and Jaewoo Kang. 2024.

</span>
<span class="ltx_bibblock">Subgraph-level Universal Prompt Tuning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">arXiv preprint arXiv:2402.10380</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lester et&nbsp;al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Brian Lester, Rami Al-Rfou, and Noah Constant. 2021.

</span>
<span class="ltx_bibblock">The Power of Scale for Parameter-Efficient Prompt Tuning. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>. 3045–3059.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jing Li, Pengjie Ren, Zhumin Chen, Zhaochun Ren, Tao Lian, and Jun Ma. 2017.

</span>
<span class="ltx_bibblock">Neural attentive session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Proceedings of the 2017 ACM on Conference on Information and Knowledge Management</em>. 1419–1428.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Liang (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiang&nbsp;Lisa Li and Percy Liang. 2021.

</span>
<span class="ltx_bibblock">Prefix-Tuning: Optimizing Continuous Prompts for Generation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 1: Long Papers)</em>. 4582–4597.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zihao Li, Xianzhi Wang, Chao Yang, Lina Yao, Julian McAuley, and Guandong Xu. 2023.

</span>
<span class="ltx_bibblock">Exploiting explicit and implicit item relationships for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the Sixteenth ACM International Conference on Web Search and Data Mining</em>. 553–561.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pengfei Liu, Weizhe Yuan, Jinlan Fu, Zhengbao Jiang, Hiroaki Hayashi, and Graham Neubig. 2023b.

</span>
<span class="ltx_bibblock">Pre-train, prompt, and predict: A systematic survey of prompting methods in natural language processing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Comput. Surveys</em> 55, 9 (2023), 1–35.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qiao Liu, Yifu Zeng, Refuoe Mokhosi, and Haibin Zhang. 2018.

</span>
<span class="ltx_bibblock">STAMP: short-term attention/memory priority model for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1831–1839.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zemin Liu, Xingtong Yu, Yuan Fang, and Xinming Zhang. 2023a.

</span>
<span class="ltx_bibblock">Graphprompt: Unifying pre-training and downstream tasks for graph neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the ACM Web Conference 2023</em>. 417–428.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ludewig et&nbsp;al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Malte Ludewig, Noemi Mauro, Sara Latifi, and Dietmar Jannach. 2019.

</span>
<span class="ltx_bibblock">Performance comparison of neural and non-neural approaches to session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the 13th ACM conference on recommender systems</em>. 462–466.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang et&nbsp;al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yitong Pang, Lingfei Wu, Qi Shen, Yiming Zhang, Zhihua Wei, Fangli Xu, Ethan Chang, Bo Long, and Jian Pei. 2022.

</span>
<span class="ltx_bibblock">Heterogeneous global graph neural networks for personalized session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Proceedings of the fifteenth ACM international conference on web search and data mining</em>. 775–783.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et&nbsp;al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ruihong Qiu, Zi Huang, Jingjing Li, and Hongzhi Yin. 2020.

</span>
<span class="ltx_bibblock">Exploiting cross-session information for session-based recommendation with graph neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">ACM Transactions on Information Systems (TOIS)</em> 38, 3 (2020), 1–23.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quadrana et&nbsp;al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Massimo Quadrana, Alexandros Karatzoglou, Balázs Hidasi, and Paolo Cremonesi. 2017.

</span>
<span class="ltx_bibblock">Personalizing session-based recommendations with hierarchical recurrent neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">proceedings of the Eleventh ACM Conference on Recommender Systems</em>. 130–137.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ruocco et&nbsp;al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Massimiliano Ruocco, Ole Steinar&nbsp;Lillestøl Skrede, and Helge Langseth. 2017.

</span>
<span class="ltx_bibblock">Inter-session modeling for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 2nd Workshop on Deep Learning for Recommender Systems</em>. 24–31.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shin et&nbsp;al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Taylor Shin, Yasaman Razeghi, Robert&nbsp;L Logan&nbsp;IV, Eric Wallace, and Sameer Singh. 2020.

</span>
<span class="ltx_bibblock">AutoPrompt: Eliciting Knowledge from Language Models with Automatically Generated Prompts. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP)</em>. 4222–4235.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et&nbsp;al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mingchen Sun, Kaixiong Zhou, Xin He, Ying Wang, and Xin Wang. 2022.

</span>
<span class="ltx_bibblock">Gppt: Graph pre-training and prompt tuning to generalize graph neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 1717–1727.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et&nbsp;al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiangguo Sun, Hong Cheng, Jia Li, Bo Liu, and Jihong Guan. 2023.

</span>
<span class="ltx_bibblock">All in one: Multi-task prompting for graph neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 2120–2131.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Traag et&nbsp;al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Vincent&nbsp;A Traag, Ludo Waltman, and Nees&nbsp;Jan Van&nbsp;Eck. 2019.

</span>
<span class="ltx_bibblock">From Louvain to Leiden: guaranteeing well-connected communities.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Scientific reports</em> 9, 1 (2019), 5233.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shoujin Wang, Longbing Cao, Yan Wang, Quan&nbsp;Z Sheng, Mehmet&nbsp;A Orgun, and Defu Lian. 2021.

</span>
<span class="ltx_bibblock">A survey on session-based recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">ACM Computing Surveys (CSUR)</em> 54, 7 (2021), 1–38.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ting-Yun Wang, Chiao-Ting Chen, Ju-Chun Huang, and Szu-Hao Huang. 2023.

</span>
<span class="ltx_bibblock">Modeling cross-session information with multi-interest graph neural networks for the next-item recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">ACM Transactions on Knowledge Discovery from Data</em> 17, 1 (2023), 1–28.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ziyang Wang, Wei Wei, Gao Cong, Xiao-Li Li, Xian-Ling Mao, and Minghui Qiu. 2020.

</span>
<span class="ltx_bibblock">Global context enhanced graph neural networks for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Proceedings of the 43rd international ACM SIGIR conference on research and development in information retrieval</em>. 169–178.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et&nbsp;al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shu Wu, Yuyuan Tang, Yanqiao Zhu, Liang Wang, Xing Xie, and Tieniu Tan. 2019.

</span>
<span class="ltx_bibblock">Session-based recommendation with graph neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the AAAI conference on artificial intelligence</em>, Vol.&nbsp;33. 346–353.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et&nbsp;al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xu Xie, Fei Sun, Zhaoyang Liu, Shiwen Wu, Jinyang Gao, Jiandong Zhang, Bolin Ding, and Bin Cui. 2022.

</span>
<span class="ltx_bibblock">Contrastive learning for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">2022 IEEE 38th international conference on data engineering (ICDE)</em>. IEEE, 1259–1273.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chengfeng Xu, Pengpeng Zhao, Yanchi Liu, Victor&nbsp;S Sheng, Jiajie Xu, Fuzhen Zhuang, Junhua Fang, and Xiaofang Zhou. 2019.

</span>
<span class="ltx_bibblock">Graph contextualized self-attention network for session-based recommendation.. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">IJCAI</em>, Vol.&nbsp;19. 3940–3946.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et&nbsp;al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Feng Yu, Yanqiao Zhu, Qiang Liu, Shu Wu, Liang Wang, and Tieniu Tan. 2020.

</span>
<span class="ltx_bibblock">TAGNN: Target attentive graph neural networks for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the 43rd international ACM SIGIR conference on research and development in information retrieval</em>. 1921–1924.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kaiyang Zhou, Jingkang Yang, Chen&nbsp;Change Loy, and Ziwei Liu. 2022.

</span>
<span class="ltx_bibblock">Learning to prompt for vision-language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">International Journal of Computer Vision</em> 130, 9 (2022), 2337–2348.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>