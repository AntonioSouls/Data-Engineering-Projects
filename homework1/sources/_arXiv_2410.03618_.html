<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Open-World Reinforcement Learning over Long Short-Term Imagination</title>
<!--Generated on Fri Oct  4 17:09:11 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03618v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S1" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S2" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS1" title="In 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Overview of LS-Imagine</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS2" title="In 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Affordance Map and Intrinsic Reward</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS2.SSS1" title="In 3.2 Affordance Map and Intrinsic Reward ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Affordance Map Computation via Virtual Exploration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS2.SSS2" title="In 3.2 Affordance Map and Intrinsic Reward ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Multimodal U-Net for Rapid Affordance Map Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS2.SSS3" title="In 3.2 Affordance Map and Intrinsic Reward ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Affordance-Driven Intrinsic Reward</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS3" title="In 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Long Short-Term World Model</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS3.SSS1" title="In 3.3 Long Short-Term World Model ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Learning Jumping Flags</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS3.SSS2" title="In 3.3 Long Short-Term World Model ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Learning Jumpy State Transitions</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS4" title="In 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Behavior Learning over Mixed Long Short-Term Imaginations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.SS1" title="In 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setups</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.SS1.SSS0.Px1" title="In 4.1 Experimental Setups ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title">Benchmark.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.SS1.SSS0.Px2" title="In 4.1 Experimental Setups ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title">Compared methods.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.SS1.SSS0.Px3" title="In 4.1 Experimental Setups ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title">Implementation details.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.SS2" title="In 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Main Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.SS3" title="In 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Model Analyses</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.SS3.SSS0.Px1" title="In 4.3 Model Analyses ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title">Alternative pathways of mixed imaginations.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.SS3.SSS0.Px2" title="In 4.3 Model Analyses ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title">Ablation studies.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.SS3.SSS0.Px3" title="In 4.3 Model Analyses ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title">Hyperparameter sensitivity.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S5" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S5.SS0.SSS0.Px1" title="In 5 Related Work ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title">Visual MBRL.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S5.SS0.SSS0.Px2" title="In 5 Related Work ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title">Affordance maps for robot learning.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S6" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusions and Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A1" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Environment Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A2" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Model Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A2.SS1" title="In Appendix B Model Details ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Environment Interaction and Data Collection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A2.SS2" title="In Appendix B Model Details ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Framework of Multimodal U-Net</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A3" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Additional Visualizations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A4" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Algorithm</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A5" title="In Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Hyperparameters</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Open-World Reinforcement Learning over
<br class="ltx_break"/>Long Short-Term Imagination</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jiajian Li<sup class="ltx_sup" id="id11.11.id1"><span class="ltx_text ltx_font_italic" id="id11.11.id1.1">1</span></sup>
 Qi Wang<sup class="ltx_sup" id="id12.12.id2"><span class="ltx_text ltx_font_italic" id="id12.12.id2.1">1,2∗</span></sup>
 Yunbo Wang<sup class="ltx_sup" id="id13.13.id3"><span class="ltx_text ltx_font_italic" id="id13.13.id3.1">1</span></sup>
 Xin Jin<sup class="ltx_sup" id="id14.14.id4"><span class="ltx_text ltx_font_italic" id="id14.14.id4.1">2</span></sup>
 Yang Li<sup class="ltx_sup" id="id15.15.id5"><span class="ltx_text ltx_font_italic" id="id15.15.id5.1">3</span></sup>
 Wenjun Zeng<sup class="ltx_sup" id="id16.16.id6"><span class="ltx_text ltx_font_italic" id="id16.16.id6.1">2</span></sup>
 Xiaokang Yang<sup class="ltx_sup" id="id17.17.id7"><span class="ltx_text ltx_font_italic" id="id17.17.id7.1">1</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id18.18.id8">1</sup> MoE Key Lab of Artificial Intelligence, AI Institute, Shanghai Jiao Tong University, Shanghai, China
<br class="ltx_break"/><sup class="ltx_sup" id="id19.19.id9">2</sup> Ningbo Institute of Digital Twin, Eastern Institute of Technology, Ningbo, China
<br class="ltx_break"/><sup class="ltx_sup" id="id20.20.id10">3</sup> School of Computer Science and Technology, East China Normal University, Shanghai, China
<br class="ltx_break"/><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://qiwang067.github.io/ls-imagine" style="color:#FF00FF;" title="">https://qiwang067.github.io/ls-imagine</a>
</span><span class="ltx_author_notes">Equal contribution.Corresponding author: Yunbo Wang &lt;yunbow@sjtu.edu.cn&gt;.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id21.id1">Training visual reinforcement learning agents in a high-dimensional open world presents significant challenges. While various model-based methods have improved sample efficiency by learning interactive world models, these agents tend to be “short-sighted”, as they are typically trained on short snippets of imagined experiences. We argue that the primary obstacle in open-world decision-making is improving the efficiency of off-policy exploration across an extensive state space. In this paper, we present LS-Imagine, which extends the imagination horizon within a limited number of state transition steps, enabling the agent to explore behaviors that potentially lead to promising long-term feedback. The foundation of our approach is to build a <span class="ltx_text ltx_font_italic" id="id21.id1.1">long short-term world model</span>. To achieve this, we simulate goal-conditioned jumpy state transitions and compute corresponding affordance maps by zooming in on specific areas within single images. This facilitates the integration of direct long-term values into behavior learning. Our method demonstrates significant improvements over state-of-the-art techniques in MineDojo.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Open-world decision-making in the context of reinforcement learning (RL) involves the following characteristics:
1) The agent operates within an interactive environment that features a vast state space;
2) The learned policy presents a high degree of flexibility, allowing interaction with various objects in the environment;
3) The agent lacks full visibility of the internal states and physical dynamics of the external world, meaning that its perception of the environment (<span class="ltx_text ltx_font_italic" id="S1.p1.1.1">e.g.</span>, raw images) carries substantial uncertainty.
For example, Minecraft serves as a typical open-world game.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Building upon recent progress in visual control, open-world decision-making aims to train agents to approach human-level intelligence based solely on high-dimensional visual observations. However, this presents significant challenges.
For example, in Minecraft tasks, existing methods like Voyager <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib36" title="">2024a</a>)</cite> employ specific Minecraft APIs as the high-level controller, which is incompatible with standard visual control settings.
While approaches such as PPO-with-MineCLIP <cite class="ltx_cite ltx_citemacro_citep">(Fan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib5" title="">2022</a>)</cite> and DECKARD <cite class="ltx_cite ltx_citemacro_citep">(Nottingham et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib28" title="">2023</a>)</cite> perform low-level visual control, these model-free RL methods struggle to grasp the underlying mechanics of the environment. This may result in high trial-and-error costs, leading to inefficiencies in both exploration and sample usage.
Although DreamerV3 <cite class="ltx_cite ltx_citemacro_citep">(Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib13" title="">2023</a>)</cite> employs a model-based RL (MBRL) approach to improve sample efficiency, it is often “short-sighted” since the policy is optimized using short-term experiences—typically <math alttext="15" class="ltx_Math" display="inline" id="S1.p2.1.m1.1"><semantics id="S1.p2.1.m1.1a"><mn id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><cn id="S1.p2.1.m1.1.1.cmml" type="integer" xref="S1.p2.1.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">15</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.1d">15</annotation></semantics></math> time steps—generated by the world model. The absence of long-term guidance significantly hampers an effective exploration of the vast solution space of the open world.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To improve the behavior learning efficiency of MBRL, in this paper, we introduce a novel method named Long Short-Term Imagination (LS-Imagine).
Our key approach involves <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">enabling the world model to efficiently simulate the long-term effects of specific behaviors without the need for repeatedly rolling out one-step predictions</em>.
As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">1</span></a>, once trained, the world model provides both instant and jumpy state transitions along with corresponding (intrinsic) rewards, facilitating policy optimization in a joint space of short- and long-term imaginations. This encourages the agent to explore behaviors that lead to promising long-term outcomes.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The foundation of LS-Imagine is to train a <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">long short-term world model</span>, which requires integrating task-specific guidance into the representation learning phase based on off-policy experience replay.
However, this creates a classic “chicken-and-egg” dilemma: <em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">without true data showing the agent has reached the goal, how can we effectively train the model to simulate jumpy transitions from current states to pivotal future states that suggest a high likelihood of achieving that goal?</em>
To address this issue, we first continuously zoom in on individual images to simulate the consecutive video frames as the agent approaches the goal.
We then generate affordance maps by evaluating the relevance of the pseudo video to task-specific goals presented in textual instructions, using the established MineCLIP reward model <cite class="ltx_cite ltx_citemacro_citep">(Fan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib5" title="">2022</a>)</cite>.
Subsequently, we train specific branches of the world model to capture both instant and jumpy state transitions, using pairs of image observations from adjacent time steps as well as those across longer intervals.
Finally, we optimize the agent’s policy based on a finite sequence of imagined latent states generated by the world model, integrating a more direct estimate of long-term values into decision-making.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Let’s use the example in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">1</span></a> to further elaborate the novel aspects of the behavior learning process:
After receiving the instruction “cut a tree”, the agent simulates near-future states based on the current real observation.
It initially performs several single-step rollouts until it identifies a point in time for a long-distance state jump that allows it to approach the tree. The agent then executes this jump and optimizes its policy network to maximize the long-sight value function.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">We evaluate our approach in the challenging open-world tasks from MineDojo <cite class="ltx_cite ltx_citemacro_citep">(Fan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib5" title="">2022</a>)</cite>.
LS-Imagine demonstrates superior performance compared to existing visual RL methods.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">The contributions of this work are summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We present a novel model-based RL method that captures both instant and jumpy state transitions and leverages them in behavior learning to improve exploration efficiency in the open world.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Our approach presents four concrete contributions: (i) a long short-term world model architecture, (ii) a method for generating affordance maps through image zoom-in, (iii) a novel form of intrinsic rewards based on the affordance map, and (iv) an improved behavior learning method that integrates long-term values and operates on a mixed long short-term imagination pathway.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="203" id="S1.F1.g1" src="x1.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
The general framework of LS-Imagine, an MBRL agent that operates solely on raw pixels. The fundamental idea is to extend the imagination horizon within a limited number of state transition steps, enabling the agent to explore behaviors that potentially lead to promising long-term feedback.
</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Problem Formulation</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.3">We solve visual reinforcement learning as a partially observable Markov decision process (POMDP), using MineDojo as the test bench.
Specifically, our method manipulates low-dimensional control signals <math alttext="a_{t}" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><msub id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><mi id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml">a</mi><mi id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2">𝑎</ci><ci id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> while receiving only sequential high-dimensional visual observations <math alttext="o_{&lt;t}" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><msub id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><mi id="S2.p1.2.m2.1.1.2" xref="S2.p1.2.m2.1.1.2.cmml">o</mi><mrow id="S2.p1.2.m2.1.1.3" xref="S2.p1.2.m2.1.1.3.cmml"><mi id="S2.p1.2.m2.1.1.3.2" xref="S2.p1.2.m2.1.1.3.2.cmml"></mi><mo id="S2.p1.2.m2.1.1.3.1" xref="S2.p1.2.m2.1.1.3.1.cmml">&lt;</mo><mi id="S2.p1.2.m2.1.1.3.3" xref="S2.p1.2.m2.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.1.cmml" xref="S2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1.2">𝑜</ci><apply id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3"><lt id="S2.p1.2.m2.1.1.3.1.cmml" xref="S2.p1.2.m2.1.1.3.1"></lt><csymbol cd="latexml" id="S2.p1.2.m2.1.1.3.2.cmml" xref="S2.p1.2.m2.1.1.3.2">absent</csymbol><ci id="S2.p1.2.m2.1.1.3.3.cmml" xref="S2.p1.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">o_{&lt;t}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_o start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and episodic sparse rewards <math alttext="r^{e}" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><msup id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">r</mi><mi id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">e</mi></msup><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1">superscript</csymbol><ci id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2">𝑟</ci><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">r^{e}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_r start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT</annotation></semantics></math>, without access to the internal APIs of the open-world games.
In comparison, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S2.T1" title="Table 1 ‣ 2 Problem Formulation ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">1</span></a>, existing Minecraft agents present notable distinctions in learning paradigms (<span class="ltx_text ltx_font_italic" id="S2.p1.3.1">i.e.</span>, controller), observation data, and the use of expert demonstrations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.10">In our formulation, the world model is learned on the replayed data consisting of so-called <span class="ltx_text ltx_font_italic" id="S2.p2.10.1">short-term</span> tuples <math alttext="\{\mathcal{D}_{t}=(o_{t},a_{t},r_{t},c_{t},\mathcal{M}_{t},j_{t},\Delta_{t},G_%
{t})\}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.2.cmml"><mo id="S2.p2.1.m1.1.1.1.2" stretchy="false" xref="S2.p2.1.m1.1.1.2.cmml">{</mo><mrow id="S2.p2.1.m1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.cmml"><msub id="S2.p2.1.m1.1.1.1.1.10" xref="S2.p2.1.m1.1.1.1.1.10.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.1.1.10.2" xref="S2.p2.1.m1.1.1.1.1.10.2.cmml">𝒟</mi><mi id="S2.p2.1.m1.1.1.1.1.10.3" xref="S2.p2.1.m1.1.1.1.1.10.3.cmml">t</mi></msub><mo id="S2.p2.1.m1.1.1.1.1.9" xref="S2.p2.1.m1.1.1.1.1.9.cmml">=</mo><mrow id="S2.p2.1.m1.1.1.1.1.8.8" xref="S2.p2.1.m1.1.1.1.1.8.9.cmml"><mo id="S2.p2.1.m1.1.1.1.1.8.8.9" stretchy="false" xref="S2.p2.1.m1.1.1.1.1.8.9.cmml">(</mo><msub id="S2.p2.1.m1.1.1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S2.p2.1.m1.1.1.1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.p2.1.m1.1.1.1.1.8.8.10" xref="S2.p2.1.m1.1.1.1.1.8.9.cmml">,</mo><msub id="S2.p2.1.m1.1.1.1.1.2.2.2" xref="S2.p2.1.m1.1.1.1.1.2.2.2.cmml"><mi id="S2.p2.1.m1.1.1.1.1.2.2.2.2" xref="S2.p2.1.m1.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S2.p2.1.m1.1.1.1.1.2.2.2.3" xref="S2.p2.1.m1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S2.p2.1.m1.1.1.1.1.8.8.11" xref="S2.p2.1.m1.1.1.1.1.8.9.cmml">,</mo><msub id="S2.p2.1.m1.1.1.1.1.3.3.3" xref="S2.p2.1.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.p2.1.m1.1.1.1.1.3.3.3.2" xref="S2.p2.1.m1.1.1.1.1.3.3.3.2.cmml">r</mi><mi id="S2.p2.1.m1.1.1.1.1.3.3.3.3" xref="S2.p2.1.m1.1.1.1.1.3.3.3.3.cmml">t</mi></msub><mo id="S2.p2.1.m1.1.1.1.1.8.8.12" xref="S2.p2.1.m1.1.1.1.1.8.9.cmml">,</mo><msub id="S2.p2.1.m1.1.1.1.1.4.4.4" xref="S2.p2.1.m1.1.1.1.1.4.4.4.cmml"><mi id="S2.p2.1.m1.1.1.1.1.4.4.4.2" xref="S2.p2.1.m1.1.1.1.1.4.4.4.2.cmml">c</mi><mi id="S2.p2.1.m1.1.1.1.1.4.4.4.3" xref="S2.p2.1.m1.1.1.1.1.4.4.4.3.cmml">t</mi></msub><mo id="S2.p2.1.m1.1.1.1.1.8.8.13" xref="S2.p2.1.m1.1.1.1.1.8.9.cmml">,</mo><msub id="S2.p2.1.m1.1.1.1.1.5.5.5" xref="S2.p2.1.m1.1.1.1.1.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.1.1.5.5.5.2" xref="S2.p2.1.m1.1.1.1.1.5.5.5.2.cmml">ℳ</mi><mi id="S2.p2.1.m1.1.1.1.1.5.5.5.3" xref="S2.p2.1.m1.1.1.1.1.5.5.5.3.cmml">t</mi></msub><mo id="S2.p2.1.m1.1.1.1.1.8.8.14" xref="S2.p2.1.m1.1.1.1.1.8.9.cmml">,</mo><msub id="S2.p2.1.m1.1.1.1.1.6.6.6" xref="S2.p2.1.m1.1.1.1.1.6.6.6.cmml"><mi id="S2.p2.1.m1.1.1.1.1.6.6.6.2" xref="S2.p2.1.m1.1.1.1.1.6.6.6.2.cmml">j</mi><mi id="S2.p2.1.m1.1.1.1.1.6.6.6.3" xref="S2.p2.1.m1.1.1.1.1.6.6.6.3.cmml">t</mi></msub><mo id="S2.p2.1.m1.1.1.1.1.8.8.15" xref="S2.p2.1.m1.1.1.1.1.8.9.cmml">,</mo><msub id="S2.p2.1.m1.1.1.1.1.7.7.7" xref="S2.p2.1.m1.1.1.1.1.7.7.7.cmml"><mi id="S2.p2.1.m1.1.1.1.1.7.7.7.2" mathvariant="normal" xref="S2.p2.1.m1.1.1.1.1.7.7.7.2.cmml">Δ</mi><mi id="S2.p2.1.m1.1.1.1.1.7.7.7.3" xref="S2.p2.1.m1.1.1.1.1.7.7.7.3.cmml">t</mi></msub><mo id="S2.p2.1.m1.1.1.1.1.8.8.16" xref="S2.p2.1.m1.1.1.1.1.8.9.cmml">,</mo><msub id="S2.p2.1.m1.1.1.1.1.8.8.8" xref="S2.p2.1.m1.1.1.1.1.8.8.8.cmml"><mi id="S2.p2.1.m1.1.1.1.1.8.8.8.2" xref="S2.p2.1.m1.1.1.1.1.8.8.8.2.cmml">G</mi><mi id="S2.p2.1.m1.1.1.1.1.8.8.8.3" xref="S2.p2.1.m1.1.1.1.1.8.8.8.3.cmml">t</mi></msub><mo id="S2.p2.1.m1.1.1.1.1.8.8.17" stretchy="false" xref="S2.p2.1.m1.1.1.1.1.8.9.cmml">)</mo></mrow></mrow><mo id="S2.p2.1.m1.1.1.1.3" stretchy="false" xref="S2.p2.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><set id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1"><apply id="S2.p2.1.m1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1"><eq id="S2.p2.1.m1.1.1.1.1.9.cmml" xref="S2.p2.1.m1.1.1.1.1.9"></eq><apply id="S2.p2.1.m1.1.1.1.1.10.cmml" xref="S2.p2.1.m1.1.1.1.1.10"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.10.1.cmml" xref="S2.p2.1.m1.1.1.1.1.10">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.10.2.cmml" xref="S2.p2.1.m1.1.1.1.1.10.2">𝒟</ci><ci id="S2.p2.1.m1.1.1.1.1.10.3.cmml" xref="S2.p2.1.m1.1.1.1.1.10.3">𝑡</ci></apply><vector id="S2.p2.1.m1.1.1.1.1.8.9.cmml" xref="S2.p2.1.m1.1.1.1.1.8.8"><apply id="S2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.2">𝑜</ci><ci id="S2.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.p2.1.m1.1.1.1.1.2.2.2.cmml" xref="S2.p2.1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.p2.1.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.p2.1.m1.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S2.p2.1.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.p2.1.m1.1.1.1.1.2.2.2.3">𝑡</ci></apply><apply id="S2.p2.1.m1.1.1.1.1.3.3.3.cmml" xref="S2.p2.1.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.p2.1.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.p2.1.m1.1.1.1.1.3.3.3.2">𝑟</ci><ci id="S2.p2.1.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.p2.1.m1.1.1.1.1.3.3.3.3">𝑡</ci></apply><apply id="S2.p2.1.m1.1.1.1.1.4.4.4.cmml" xref="S2.p2.1.m1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.4.4.4.1.cmml" xref="S2.p2.1.m1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.4.4.4.2.cmml" xref="S2.p2.1.m1.1.1.1.1.4.4.4.2">𝑐</ci><ci id="S2.p2.1.m1.1.1.1.1.4.4.4.3.cmml" xref="S2.p2.1.m1.1.1.1.1.4.4.4.3">𝑡</ci></apply><apply id="S2.p2.1.m1.1.1.1.1.5.5.5.cmml" xref="S2.p2.1.m1.1.1.1.1.5.5.5"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.5.5.5.1.cmml" xref="S2.p2.1.m1.1.1.1.1.5.5.5">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.5.5.5.2.cmml" xref="S2.p2.1.m1.1.1.1.1.5.5.5.2">ℳ</ci><ci id="S2.p2.1.m1.1.1.1.1.5.5.5.3.cmml" xref="S2.p2.1.m1.1.1.1.1.5.5.5.3">𝑡</ci></apply><apply id="S2.p2.1.m1.1.1.1.1.6.6.6.cmml" xref="S2.p2.1.m1.1.1.1.1.6.6.6"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.6.6.6.1.cmml" xref="S2.p2.1.m1.1.1.1.1.6.6.6">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.6.6.6.2.cmml" xref="S2.p2.1.m1.1.1.1.1.6.6.6.2">𝑗</ci><ci id="S2.p2.1.m1.1.1.1.1.6.6.6.3.cmml" xref="S2.p2.1.m1.1.1.1.1.6.6.6.3">𝑡</ci></apply><apply id="S2.p2.1.m1.1.1.1.1.7.7.7.cmml" xref="S2.p2.1.m1.1.1.1.1.7.7.7"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.7.7.7.1.cmml" xref="S2.p2.1.m1.1.1.1.1.7.7.7">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.7.7.7.2.cmml" xref="S2.p2.1.m1.1.1.1.1.7.7.7.2">Δ</ci><ci id="S2.p2.1.m1.1.1.1.1.7.7.7.3.cmml" xref="S2.p2.1.m1.1.1.1.1.7.7.7.3">𝑡</ci></apply><apply id="S2.p2.1.m1.1.1.1.1.8.8.8.cmml" xref="S2.p2.1.m1.1.1.1.1.8.8.8"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.8.8.8.1.cmml" xref="S2.p2.1.m1.1.1.1.1.8.8.8">subscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.8.8.8.2.cmml" xref="S2.p2.1.m1.1.1.1.1.8.8.8.2">𝐺</ci><ci id="S2.p2.1.m1.1.1.1.1.8.8.8.3.cmml" xref="S2.p2.1.m1.1.1.1.1.8.8.8.3">𝑡</ci></apply></vector></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\{\mathcal{D}_{t}=(o_{t},a_{t},r_{t},c_{t},\mathcal{M}_{t},j_{t},\Delta_{t},G_%
{t})\}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">{ caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) }</annotation></semantics></math> and <span class="ltx_text ltx_font_italic" id="S2.p2.10.2">long-term</span> tuples <math alttext="\{\mathcal{D}^{\prime}_{t}=(o_{t}^{\prime},a_{t}^{\prime},{r}_{t}^{\prime},%
\mathcal{M}^{\prime}_{t},c_{t}^{\prime},j_{t}^{\prime},\Delta_{t}^{\prime},G_{%
t}^{\prime})\}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.1.1" xref="S2.p2.2.m2.1.1.2.cmml"><mo id="S2.p2.2.m2.1.1.1.2" stretchy="false" xref="S2.p2.2.m2.1.1.2.cmml">{</mo><mrow id="S2.p2.2.m2.1.1.1.1" xref="S2.p2.2.m2.1.1.1.1.cmml"><msubsup id="S2.p2.2.m2.1.1.1.1.10" xref="S2.p2.2.m2.1.1.1.1.10.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.2.m2.1.1.1.1.10.2.2" xref="S2.p2.2.m2.1.1.1.1.10.2.2.cmml">𝒟</mi><mi id="S2.p2.2.m2.1.1.1.1.10.3" xref="S2.p2.2.m2.1.1.1.1.10.3.cmml">t</mi><mo id="S2.p2.2.m2.1.1.1.1.10.2.3" xref="S2.p2.2.m2.1.1.1.1.10.2.3.cmml">′</mo></msubsup><mo id="S2.p2.2.m2.1.1.1.1.9" xref="S2.p2.2.m2.1.1.1.1.9.cmml">=</mo><mrow id="S2.p2.2.m2.1.1.1.1.8.8" xref="S2.p2.2.m2.1.1.1.1.8.9.cmml"><mo id="S2.p2.2.m2.1.1.1.1.8.8.9" stretchy="false" xref="S2.p2.2.m2.1.1.1.1.8.9.cmml">(</mo><msubsup id="S2.p2.2.m2.1.1.1.1.1.1.1" xref="S2.p2.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.p2.2.m2.1.1.1.1.1.1.1.2.2" xref="S2.p2.2.m2.1.1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S2.p2.2.m2.1.1.1.1.1.1.1.2.3" xref="S2.p2.2.m2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mo id="S2.p2.2.m2.1.1.1.1.1.1.1.3" xref="S2.p2.2.m2.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S2.p2.2.m2.1.1.1.1.8.8.10" xref="S2.p2.2.m2.1.1.1.1.8.9.cmml">,</mo><msubsup id="S2.p2.2.m2.1.1.1.1.2.2.2" xref="S2.p2.2.m2.1.1.1.1.2.2.2.cmml"><mi id="S2.p2.2.m2.1.1.1.1.2.2.2.2.2" xref="S2.p2.2.m2.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S2.p2.2.m2.1.1.1.1.2.2.2.2.3" xref="S2.p2.2.m2.1.1.1.1.2.2.2.2.3.cmml">t</mi><mo id="S2.p2.2.m2.1.1.1.1.2.2.2.3" xref="S2.p2.2.m2.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup><mo id="S2.p2.2.m2.1.1.1.1.8.8.11" xref="S2.p2.2.m2.1.1.1.1.8.9.cmml">,</mo><msubsup id="S2.p2.2.m2.1.1.1.1.3.3.3" xref="S2.p2.2.m2.1.1.1.1.3.3.3.cmml"><mi id="S2.p2.2.m2.1.1.1.1.3.3.3.2.2" xref="S2.p2.2.m2.1.1.1.1.3.3.3.2.2.cmml">r</mi><mi id="S2.p2.2.m2.1.1.1.1.3.3.3.2.3" xref="S2.p2.2.m2.1.1.1.1.3.3.3.2.3.cmml">t</mi><mo id="S2.p2.2.m2.1.1.1.1.3.3.3.3" xref="S2.p2.2.m2.1.1.1.1.3.3.3.3.cmml">′</mo></msubsup><mo id="S2.p2.2.m2.1.1.1.1.8.8.12" xref="S2.p2.2.m2.1.1.1.1.8.9.cmml">,</mo><msubsup id="S2.p2.2.m2.1.1.1.1.4.4.4" xref="S2.p2.2.m2.1.1.1.1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.2.m2.1.1.1.1.4.4.4.2.2" xref="S2.p2.2.m2.1.1.1.1.4.4.4.2.2.cmml">ℳ</mi><mi id="S2.p2.2.m2.1.1.1.1.4.4.4.3" xref="S2.p2.2.m2.1.1.1.1.4.4.4.3.cmml">t</mi><mo id="S2.p2.2.m2.1.1.1.1.4.4.4.2.3" xref="S2.p2.2.m2.1.1.1.1.4.4.4.2.3.cmml">′</mo></msubsup><mo id="S2.p2.2.m2.1.1.1.1.8.8.13" xref="S2.p2.2.m2.1.1.1.1.8.9.cmml">,</mo><msubsup id="S2.p2.2.m2.1.1.1.1.5.5.5" xref="S2.p2.2.m2.1.1.1.1.5.5.5.cmml"><mi id="S2.p2.2.m2.1.1.1.1.5.5.5.2.2" xref="S2.p2.2.m2.1.1.1.1.5.5.5.2.2.cmml">c</mi><mi id="S2.p2.2.m2.1.1.1.1.5.5.5.2.3" xref="S2.p2.2.m2.1.1.1.1.5.5.5.2.3.cmml">t</mi><mo id="S2.p2.2.m2.1.1.1.1.5.5.5.3" xref="S2.p2.2.m2.1.1.1.1.5.5.5.3.cmml">′</mo></msubsup><mo id="S2.p2.2.m2.1.1.1.1.8.8.14" xref="S2.p2.2.m2.1.1.1.1.8.9.cmml">,</mo><msubsup id="S2.p2.2.m2.1.1.1.1.6.6.6" xref="S2.p2.2.m2.1.1.1.1.6.6.6.cmml"><mi id="S2.p2.2.m2.1.1.1.1.6.6.6.2.2" xref="S2.p2.2.m2.1.1.1.1.6.6.6.2.2.cmml">j</mi><mi id="S2.p2.2.m2.1.1.1.1.6.6.6.2.3" xref="S2.p2.2.m2.1.1.1.1.6.6.6.2.3.cmml">t</mi><mo id="S2.p2.2.m2.1.1.1.1.6.6.6.3" xref="S2.p2.2.m2.1.1.1.1.6.6.6.3.cmml">′</mo></msubsup><mo id="S2.p2.2.m2.1.1.1.1.8.8.15" xref="S2.p2.2.m2.1.1.1.1.8.9.cmml">,</mo><msubsup id="S2.p2.2.m2.1.1.1.1.7.7.7" xref="S2.p2.2.m2.1.1.1.1.7.7.7.cmml"><mi id="S2.p2.2.m2.1.1.1.1.7.7.7.2.2" mathvariant="normal" xref="S2.p2.2.m2.1.1.1.1.7.7.7.2.2.cmml">Δ</mi><mi id="S2.p2.2.m2.1.1.1.1.7.7.7.2.3" xref="S2.p2.2.m2.1.1.1.1.7.7.7.2.3.cmml">t</mi><mo id="S2.p2.2.m2.1.1.1.1.7.7.7.3" xref="S2.p2.2.m2.1.1.1.1.7.7.7.3.cmml">′</mo></msubsup><mo id="S2.p2.2.m2.1.1.1.1.8.8.16" xref="S2.p2.2.m2.1.1.1.1.8.9.cmml">,</mo><msubsup id="S2.p2.2.m2.1.1.1.1.8.8.8" xref="S2.p2.2.m2.1.1.1.1.8.8.8.cmml"><mi id="S2.p2.2.m2.1.1.1.1.8.8.8.2.2" xref="S2.p2.2.m2.1.1.1.1.8.8.8.2.2.cmml">G</mi><mi id="S2.p2.2.m2.1.1.1.1.8.8.8.2.3" xref="S2.p2.2.m2.1.1.1.1.8.8.8.2.3.cmml">t</mi><mo id="S2.p2.2.m2.1.1.1.1.8.8.8.3" xref="S2.p2.2.m2.1.1.1.1.8.8.8.3.cmml">′</mo></msubsup><mo id="S2.p2.2.m2.1.1.1.1.8.8.17" stretchy="false" xref="S2.p2.2.m2.1.1.1.1.8.9.cmml">)</mo></mrow></mrow><mo id="S2.p2.2.m2.1.1.1.3" stretchy="false" xref="S2.p2.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><set id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.1"><apply id="S2.p2.2.m2.1.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1.1"><eq id="S2.p2.2.m2.1.1.1.1.9.cmml" xref="S2.p2.2.m2.1.1.1.1.9"></eq><apply id="S2.p2.2.m2.1.1.1.1.10.cmml" xref="S2.p2.2.m2.1.1.1.1.10"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.10.1.cmml" xref="S2.p2.2.m2.1.1.1.1.10">subscript</csymbol><apply id="S2.p2.2.m2.1.1.1.1.10.2.cmml" xref="S2.p2.2.m2.1.1.1.1.10"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.10.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.10">superscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.10.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.10.2.2">𝒟</ci><ci id="S2.p2.2.m2.1.1.1.1.10.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.10.2.3">′</ci></apply><ci id="S2.p2.2.m2.1.1.1.1.10.3.cmml" xref="S2.p2.2.m2.1.1.1.1.10.3">𝑡</ci></apply><vector id="S2.p2.2.m2.1.1.1.1.8.9.cmml" xref="S2.p2.2.m2.1.1.1.1.8.8"><apply id="S2.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.p2.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1.2.2">𝑜</ci><ci id="S2.p2.2.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.p2.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.2.m2.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S2.p2.2.m2.1.1.1.1.2.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.2.2.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.p2.2.m2.1.1.1.1.2.2.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.2.2.2.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.2.2.2.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S2.p2.2.m2.1.1.1.1.2.2.2.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="S2.p2.2.m2.1.1.1.1.2.2.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.2.2.2.3">′</ci></apply><apply id="S2.p2.2.m2.1.1.1.1.3.3.3.cmml" xref="S2.p2.2.m2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.3.3.3.1.cmml" xref="S2.p2.2.m2.1.1.1.1.3.3.3">superscript</csymbol><apply id="S2.p2.2.m2.1.1.1.1.3.3.3.2.cmml" xref="S2.p2.2.m2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.3.3.3.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.3.3.3.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.3.3.3.2.2">𝑟</ci><ci id="S2.p2.2.m2.1.1.1.1.3.3.3.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.3.3.3.2.3">𝑡</ci></apply><ci id="S2.p2.2.m2.1.1.1.1.3.3.3.3.cmml" xref="S2.p2.2.m2.1.1.1.1.3.3.3.3">′</ci></apply><apply id="S2.p2.2.m2.1.1.1.1.4.4.4.cmml" xref="S2.p2.2.m2.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.4.4.4.1.cmml" xref="S2.p2.2.m2.1.1.1.1.4.4.4">subscript</csymbol><apply id="S2.p2.2.m2.1.1.1.1.4.4.4.2.cmml" xref="S2.p2.2.m2.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.4.4.4.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.4.4.4">superscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.4.4.4.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.4.4.4.2.2">ℳ</ci><ci id="S2.p2.2.m2.1.1.1.1.4.4.4.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.4.4.4.2.3">′</ci></apply><ci id="S2.p2.2.m2.1.1.1.1.4.4.4.3.cmml" xref="S2.p2.2.m2.1.1.1.1.4.4.4.3">𝑡</ci></apply><apply id="S2.p2.2.m2.1.1.1.1.5.5.5.cmml" xref="S2.p2.2.m2.1.1.1.1.5.5.5"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.5.5.5.1.cmml" xref="S2.p2.2.m2.1.1.1.1.5.5.5">superscript</csymbol><apply id="S2.p2.2.m2.1.1.1.1.5.5.5.2.cmml" xref="S2.p2.2.m2.1.1.1.1.5.5.5"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.5.5.5.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.5.5.5">subscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.5.5.5.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.5.5.5.2.2">𝑐</ci><ci id="S2.p2.2.m2.1.1.1.1.5.5.5.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.5.5.5.2.3">𝑡</ci></apply><ci id="S2.p2.2.m2.1.1.1.1.5.5.5.3.cmml" xref="S2.p2.2.m2.1.1.1.1.5.5.5.3">′</ci></apply><apply id="S2.p2.2.m2.1.1.1.1.6.6.6.cmml" xref="S2.p2.2.m2.1.1.1.1.6.6.6"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.6.6.6.1.cmml" xref="S2.p2.2.m2.1.1.1.1.6.6.6">superscript</csymbol><apply id="S2.p2.2.m2.1.1.1.1.6.6.6.2.cmml" xref="S2.p2.2.m2.1.1.1.1.6.6.6"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.6.6.6.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.6.6.6">subscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.6.6.6.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.6.6.6.2.2">𝑗</ci><ci id="S2.p2.2.m2.1.1.1.1.6.6.6.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.6.6.6.2.3">𝑡</ci></apply><ci id="S2.p2.2.m2.1.1.1.1.6.6.6.3.cmml" xref="S2.p2.2.m2.1.1.1.1.6.6.6.3">′</ci></apply><apply id="S2.p2.2.m2.1.1.1.1.7.7.7.cmml" xref="S2.p2.2.m2.1.1.1.1.7.7.7"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.7.7.7.1.cmml" xref="S2.p2.2.m2.1.1.1.1.7.7.7">superscript</csymbol><apply id="S2.p2.2.m2.1.1.1.1.7.7.7.2.cmml" xref="S2.p2.2.m2.1.1.1.1.7.7.7"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.7.7.7.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.7.7.7">subscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.7.7.7.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.7.7.7.2.2">Δ</ci><ci id="S2.p2.2.m2.1.1.1.1.7.7.7.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.7.7.7.2.3">𝑡</ci></apply><ci id="S2.p2.2.m2.1.1.1.1.7.7.7.3.cmml" xref="S2.p2.2.m2.1.1.1.1.7.7.7.3">′</ci></apply><apply id="S2.p2.2.m2.1.1.1.1.8.8.8.cmml" xref="S2.p2.2.m2.1.1.1.1.8.8.8"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.8.8.8.1.cmml" xref="S2.p2.2.m2.1.1.1.1.8.8.8">superscript</csymbol><apply id="S2.p2.2.m2.1.1.1.1.8.8.8.2.cmml" xref="S2.p2.2.m2.1.1.1.1.8.8.8"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.1.8.8.8.2.1.cmml" xref="S2.p2.2.m2.1.1.1.1.8.8.8">subscript</csymbol><ci id="S2.p2.2.m2.1.1.1.1.8.8.8.2.2.cmml" xref="S2.p2.2.m2.1.1.1.1.8.8.8.2.2">𝐺</ci><ci id="S2.p2.2.m2.1.1.1.1.8.8.8.2.3.cmml" xref="S2.p2.2.m2.1.1.1.1.8.8.8.2.3">𝑡</ci></apply><ci id="S2.p2.2.m2.1.1.1.1.8.8.8.3.cmml" xref="S2.p2.2.m2.1.1.1.1.8.8.8.3">′</ci></apply></vector></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\{\mathcal{D}^{\prime}_{t}=(o_{t}^{\prime},a_{t}^{\prime},{r}_{t}^{\prime},%
\mathcal{M}^{\prime}_{t},c_{t}^{\prime},j_{t}^{\prime},\Delta_{t}^{\prime},G_{%
t}^{\prime})\}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">{ caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) }</annotation></semantics></math>, where
<math alttext="c_{t}" class="ltx_Math" display="inline" id="S2.p2.3.m3.1"><semantics id="S2.p2.3.m3.1a"><msub id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">c</mi><mi id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">𝑐</ci><ci id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">c_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the episode continuation flag, <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="S2.p2.4.m4.1"><semantics id="S2.p2.4.m4.1a"><msub id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">ℳ</mi><mi id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">ℳ</ci><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the affordance map, <math alttext="j_{t}" class="ltx_Math" display="inline" id="S2.p2.5.m5.1"><semantics id="S2.p2.5.m5.1a"><msub id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">j</mi><mi id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">𝑗</ci><ci id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">j_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m5.1d">italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the jumping flag, <math alttext="\Delta_{t}" class="ltx_Math" display="inline" id="S2.p2.6.m6.1"><semantics id="S2.p2.6.m6.1a"><msub id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml"><mi id="S2.p2.6.m6.1.1.2" mathvariant="normal" xref="S2.p2.6.m6.1.1.2.cmml">Δ</mi><mi id="S2.p2.6.m6.1.1.3" xref="S2.p2.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><apply id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p2.6.m6.1.1.1.cmml" xref="S2.p2.6.m6.1.1">subscript</csymbol><ci id="S2.p2.6.m6.1.1.2.cmml" xref="S2.p2.6.m6.1.1.2">Δ</ci><ci id="S2.p2.6.m6.1.1.3.cmml" xref="S2.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">\Delta_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m6.1d">roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the number of environment steps between state transitions, and <math alttext="G_{t}" class="ltx_Math" display="inline" id="S2.p2.7.m7.1"><semantics id="S2.p2.7.m7.1a"><msub id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml"><mi id="S2.p2.7.m7.1.1.2" xref="S2.p2.7.m7.1.1.2.cmml">G</mi><mi id="S2.p2.7.m7.1.1.3" xref="S2.p2.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><apply id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p2.7.m7.1.1.1.cmml" xref="S2.p2.7.m7.1.1">subscript</csymbol><ci id="S2.p2.7.m7.1.1.2.cmml" xref="S2.p2.7.m7.1.1.2">𝐺</ci><ci id="S2.p2.7.m7.1.1.3.cmml" xref="S2.p2.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">G_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.7.m7.1d">italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the cumulative discounted reward over this period.
The policy is learned on trajectories of long short-term imaginations <math alttext="\{(h_{t},\hat{z}_{t},a_{t},\hat{r}_{t},\hat{c}_{t},\hat{j}_{t},\hat{\Delta}_{t%
},\hat{G}_{t})\}" class="ltx_Math" display="inline" id="S2.p2.8.m8.1"><semantics id="S2.p2.8.m8.1a"><mrow id="S2.p2.8.m8.1.1.1" xref="S2.p2.8.m8.1.1.2.cmml"><mo id="S2.p2.8.m8.1.1.1.2" stretchy="false" xref="S2.p2.8.m8.1.1.2.cmml">{</mo><mrow id="S2.p2.8.m8.1.1.1.1.8" xref="S2.p2.8.m8.1.1.1.1.9.cmml"><mo id="S2.p2.8.m8.1.1.1.1.8.9" stretchy="false" xref="S2.p2.8.m8.1.1.1.1.9.cmml">(</mo><msub id="S2.p2.8.m8.1.1.1.1.1.1" xref="S2.p2.8.m8.1.1.1.1.1.1.cmml"><mi id="S2.p2.8.m8.1.1.1.1.1.1.2" xref="S2.p2.8.m8.1.1.1.1.1.1.2.cmml">h</mi><mi id="S2.p2.8.m8.1.1.1.1.1.1.3" xref="S2.p2.8.m8.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.p2.8.m8.1.1.1.1.8.10" xref="S2.p2.8.m8.1.1.1.1.9.cmml">,</mo><msub id="S2.p2.8.m8.1.1.1.1.2.2" xref="S2.p2.8.m8.1.1.1.1.2.2.cmml"><mover accent="true" id="S2.p2.8.m8.1.1.1.1.2.2.2" xref="S2.p2.8.m8.1.1.1.1.2.2.2.cmml"><mi id="S2.p2.8.m8.1.1.1.1.2.2.2.2" xref="S2.p2.8.m8.1.1.1.1.2.2.2.2.cmml">z</mi><mo id="S2.p2.8.m8.1.1.1.1.2.2.2.1" xref="S2.p2.8.m8.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.p2.8.m8.1.1.1.1.2.2.3" xref="S2.p2.8.m8.1.1.1.1.2.2.3.cmml">t</mi></msub><mo id="S2.p2.8.m8.1.1.1.1.8.11" xref="S2.p2.8.m8.1.1.1.1.9.cmml">,</mo><msub id="S2.p2.8.m8.1.1.1.1.3.3" xref="S2.p2.8.m8.1.1.1.1.3.3.cmml"><mi id="S2.p2.8.m8.1.1.1.1.3.3.2" xref="S2.p2.8.m8.1.1.1.1.3.3.2.cmml">a</mi><mi id="S2.p2.8.m8.1.1.1.1.3.3.3" xref="S2.p2.8.m8.1.1.1.1.3.3.3.cmml">t</mi></msub><mo id="S2.p2.8.m8.1.1.1.1.8.12" xref="S2.p2.8.m8.1.1.1.1.9.cmml">,</mo><msub id="S2.p2.8.m8.1.1.1.1.4.4" xref="S2.p2.8.m8.1.1.1.1.4.4.cmml"><mover accent="true" id="S2.p2.8.m8.1.1.1.1.4.4.2" xref="S2.p2.8.m8.1.1.1.1.4.4.2.cmml"><mi id="S2.p2.8.m8.1.1.1.1.4.4.2.2" xref="S2.p2.8.m8.1.1.1.1.4.4.2.2.cmml">r</mi><mo id="S2.p2.8.m8.1.1.1.1.4.4.2.1" xref="S2.p2.8.m8.1.1.1.1.4.4.2.1.cmml">^</mo></mover><mi id="S2.p2.8.m8.1.1.1.1.4.4.3" xref="S2.p2.8.m8.1.1.1.1.4.4.3.cmml">t</mi></msub><mo id="S2.p2.8.m8.1.1.1.1.8.13" xref="S2.p2.8.m8.1.1.1.1.9.cmml">,</mo><msub id="S2.p2.8.m8.1.1.1.1.5.5" xref="S2.p2.8.m8.1.1.1.1.5.5.cmml"><mover accent="true" id="S2.p2.8.m8.1.1.1.1.5.5.2" xref="S2.p2.8.m8.1.1.1.1.5.5.2.cmml"><mi id="S2.p2.8.m8.1.1.1.1.5.5.2.2" xref="S2.p2.8.m8.1.1.1.1.5.5.2.2.cmml">c</mi><mo id="S2.p2.8.m8.1.1.1.1.5.5.2.1" xref="S2.p2.8.m8.1.1.1.1.5.5.2.1.cmml">^</mo></mover><mi id="S2.p2.8.m8.1.1.1.1.5.5.3" xref="S2.p2.8.m8.1.1.1.1.5.5.3.cmml">t</mi></msub><mo id="S2.p2.8.m8.1.1.1.1.8.14" xref="S2.p2.8.m8.1.1.1.1.9.cmml">,</mo><msub id="S2.p2.8.m8.1.1.1.1.6.6" xref="S2.p2.8.m8.1.1.1.1.6.6.cmml"><mover accent="true" id="S2.p2.8.m8.1.1.1.1.6.6.2" xref="S2.p2.8.m8.1.1.1.1.6.6.2.cmml"><mi id="S2.p2.8.m8.1.1.1.1.6.6.2.2" xref="S2.p2.8.m8.1.1.1.1.6.6.2.2.cmml">j</mi><mo id="S2.p2.8.m8.1.1.1.1.6.6.2.1" xref="S2.p2.8.m8.1.1.1.1.6.6.2.1.cmml">^</mo></mover><mi id="S2.p2.8.m8.1.1.1.1.6.6.3" xref="S2.p2.8.m8.1.1.1.1.6.6.3.cmml">t</mi></msub><mo id="S2.p2.8.m8.1.1.1.1.8.15" xref="S2.p2.8.m8.1.1.1.1.9.cmml">,</mo><msub id="S2.p2.8.m8.1.1.1.1.7.7" xref="S2.p2.8.m8.1.1.1.1.7.7.cmml"><mover accent="true" id="S2.p2.8.m8.1.1.1.1.7.7.2" xref="S2.p2.8.m8.1.1.1.1.7.7.2.cmml"><mi id="S2.p2.8.m8.1.1.1.1.7.7.2.2" mathvariant="normal" xref="S2.p2.8.m8.1.1.1.1.7.7.2.2.cmml">Δ</mi><mo id="S2.p2.8.m8.1.1.1.1.7.7.2.1" xref="S2.p2.8.m8.1.1.1.1.7.7.2.1.cmml">^</mo></mover><mi id="S2.p2.8.m8.1.1.1.1.7.7.3" xref="S2.p2.8.m8.1.1.1.1.7.7.3.cmml">t</mi></msub><mo id="S2.p2.8.m8.1.1.1.1.8.16" xref="S2.p2.8.m8.1.1.1.1.9.cmml">,</mo><msub id="S2.p2.8.m8.1.1.1.1.8.8" xref="S2.p2.8.m8.1.1.1.1.8.8.cmml"><mover accent="true" id="S2.p2.8.m8.1.1.1.1.8.8.2" xref="S2.p2.8.m8.1.1.1.1.8.8.2.cmml"><mi id="S2.p2.8.m8.1.1.1.1.8.8.2.2" xref="S2.p2.8.m8.1.1.1.1.8.8.2.2.cmml">G</mi><mo id="S2.p2.8.m8.1.1.1.1.8.8.2.1" xref="S2.p2.8.m8.1.1.1.1.8.8.2.1.cmml">^</mo></mover><mi id="S2.p2.8.m8.1.1.1.1.8.8.3" xref="S2.p2.8.m8.1.1.1.1.8.8.3.cmml">t</mi></msub><mo id="S2.p2.8.m8.1.1.1.1.8.17" stretchy="false" xref="S2.p2.8.m8.1.1.1.1.9.cmml">)</mo></mrow><mo id="S2.p2.8.m8.1.1.1.3" stretchy="false" xref="S2.p2.8.m8.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b"><set id="S2.p2.8.m8.1.1.2.cmml" xref="S2.p2.8.m8.1.1.1"><vector id="S2.p2.8.m8.1.1.1.1.9.cmml" xref="S2.p2.8.m8.1.1.1.1.8"><apply id="S2.p2.8.m8.1.1.1.1.1.1.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.1.1.1.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.8.m8.1.1.1.1.1.1.2.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.2">ℎ</ci><ci id="S2.p2.8.m8.1.1.1.1.1.1.3.cmml" xref="S2.p2.8.m8.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.p2.8.m8.1.1.1.1.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.2.2.1.cmml" xref="S2.p2.8.m8.1.1.1.1.2.2">subscript</csymbol><apply id="S2.p2.8.m8.1.1.1.1.2.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.2.2.2"><ci id="S2.p2.8.m8.1.1.1.1.2.2.2.1.cmml" xref="S2.p2.8.m8.1.1.1.1.2.2.2.1">^</ci><ci id="S2.p2.8.m8.1.1.1.1.2.2.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.2.2.2.2">𝑧</ci></apply><ci id="S2.p2.8.m8.1.1.1.1.2.2.3.cmml" xref="S2.p2.8.m8.1.1.1.1.2.2.3">𝑡</ci></apply><apply id="S2.p2.8.m8.1.1.1.1.3.3.cmml" xref="S2.p2.8.m8.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.3.3.1.cmml" xref="S2.p2.8.m8.1.1.1.1.3.3">subscript</csymbol><ci id="S2.p2.8.m8.1.1.1.1.3.3.2.cmml" xref="S2.p2.8.m8.1.1.1.1.3.3.2">𝑎</ci><ci id="S2.p2.8.m8.1.1.1.1.3.3.3.cmml" xref="S2.p2.8.m8.1.1.1.1.3.3.3">𝑡</ci></apply><apply id="S2.p2.8.m8.1.1.1.1.4.4.cmml" xref="S2.p2.8.m8.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.4.4.1.cmml" xref="S2.p2.8.m8.1.1.1.1.4.4">subscript</csymbol><apply id="S2.p2.8.m8.1.1.1.1.4.4.2.cmml" xref="S2.p2.8.m8.1.1.1.1.4.4.2"><ci id="S2.p2.8.m8.1.1.1.1.4.4.2.1.cmml" xref="S2.p2.8.m8.1.1.1.1.4.4.2.1">^</ci><ci id="S2.p2.8.m8.1.1.1.1.4.4.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.4.4.2.2">𝑟</ci></apply><ci id="S2.p2.8.m8.1.1.1.1.4.4.3.cmml" xref="S2.p2.8.m8.1.1.1.1.4.4.3">𝑡</ci></apply><apply id="S2.p2.8.m8.1.1.1.1.5.5.cmml" xref="S2.p2.8.m8.1.1.1.1.5.5"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.5.5.1.cmml" xref="S2.p2.8.m8.1.1.1.1.5.5">subscript</csymbol><apply id="S2.p2.8.m8.1.1.1.1.5.5.2.cmml" xref="S2.p2.8.m8.1.1.1.1.5.5.2"><ci id="S2.p2.8.m8.1.1.1.1.5.5.2.1.cmml" xref="S2.p2.8.m8.1.1.1.1.5.5.2.1">^</ci><ci id="S2.p2.8.m8.1.1.1.1.5.5.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.5.5.2.2">𝑐</ci></apply><ci id="S2.p2.8.m8.1.1.1.1.5.5.3.cmml" xref="S2.p2.8.m8.1.1.1.1.5.5.3">𝑡</ci></apply><apply id="S2.p2.8.m8.1.1.1.1.6.6.cmml" xref="S2.p2.8.m8.1.1.1.1.6.6"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.6.6.1.cmml" xref="S2.p2.8.m8.1.1.1.1.6.6">subscript</csymbol><apply id="S2.p2.8.m8.1.1.1.1.6.6.2.cmml" xref="S2.p2.8.m8.1.1.1.1.6.6.2"><ci id="S2.p2.8.m8.1.1.1.1.6.6.2.1.cmml" xref="S2.p2.8.m8.1.1.1.1.6.6.2.1">^</ci><ci id="S2.p2.8.m8.1.1.1.1.6.6.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.6.6.2.2">𝑗</ci></apply><ci id="S2.p2.8.m8.1.1.1.1.6.6.3.cmml" xref="S2.p2.8.m8.1.1.1.1.6.6.3">𝑡</ci></apply><apply id="S2.p2.8.m8.1.1.1.1.7.7.cmml" xref="S2.p2.8.m8.1.1.1.1.7.7"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.7.7.1.cmml" xref="S2.p2.8.m8.1.1.1.1.7.7">subscript</csymbol><apply id="S2.p2.8.m8.1.1.1.1.7.7.2.cmml" xref="S2.p2.8.m8.1.1.1.1.7.7.2"><ci id="S2.p2.8.m8.1.1.1.1.7.7.2.1.cmml" xref="S2.p2.8.m8.1.1.1.1.7.7.2.1">^</ci><ci id="S2.p2.8.m8.1.1.1.1.7.7.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.7.7.2.2">Δ</ci></apply><ci id="S2.p2.8.m8.1.1.1.1.7.7.3.cmml" xref="S2.p2.8.m8.1.1.1.1.7.7.3">𝑡</ci></apply><apply id="S2.p2.8.m8.1.1.1.1.8.8.cmml" xref="S2.p2.8.m8.1.1.1.1.8.8"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.1.8.8.1.cmml" xref="S2.p2.8.m8.1.1.1.1.8.8">subscript</csymbol><apply id="S2.p2.8.m8.1.1.1.1.8.8.2.cmml" xref="S2.p2.8.m8.1.1.1.1.8.8.2"><ci id="S2.p2.8.m8.1.1.1.1.8.8.2.1.cmml" xref="S2.p2.8.m8.1.1.1.1.8.8.2.1">^</ci><ci id="S2.p2.8.m8.1.1.1.1.8.8.2.2.cmml" xref="S2.p2.8.m8.1.1.1.1.8.8.2.2">𝐺</ci></apply><ci id="S2.p2.8.m8.1.1.1.1.8.8.3.cmml" xref="S2.p2.8.m8.1.1.1.1.8.8.3">𝑡</ci></apply></vector></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">\{(h_{t},\hat{z}_{t},a_{t},\hat{r}_{t},\hat{c}_{t},\hat{j}_{t},\hat{\Delta}_{t%
},\hat{G}_{t})\}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.8.m8.1d">{ ( italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG roman_Δ end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_G end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) }</annotation></semantics></math>, where <math alttext="h_{t}" class="ltx_Math" display="inline" id="S2.p2.9.m9.1"><semantics id="S2.p2.9.m9.1a"><msub id="S2.p2.9.m9.1.1" xref="S2.p2.9.m9.1.1.cmml"><mi id="S2.p2.9.m9.1.1.2" xref="S2.p2.9.m9.1.1.2.cmml">h</mi><mi id="S2.p2.9.m9.1.1.3" xref="S2.p2.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.9.m9.1b"><apply id="S2.p2.9.m9.1.1.cmml" xref="S2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p2.9.m9.1.1.1.cmml" xref="S2.p2.9.m9.1.1">subscript</csymbol><ci id="S2.p2.9.m9.1.1.2.cmml" xref="S2.p2.9.m9.1.1.2">ℎ</ci><ci id="S2.p2.9.m9.1.1.3.cmml" xref="S2.p2.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m9.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.9.m9.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the deterministic recurrent state and <math alttext="z_{t}" class="ltx_Math" display="inline" id="S2.p2.10.m10.1"><semantics id="S2.p2.10.m10.1a"><msub id="S2.p2.10.m10.1.1" xref="S2.p2.10.m10.1.1.cmml"><mi id="S2.p2.10.m10.1.1.2" xref="S2.p2.10.m10.1.1.2.cmml">z</mi><mi id="S2.p2.10.m10.1.1.3" xref="S2.p2.10.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.10.m10.1b"><apply id="S2.p2.10.m10.1.1.cmml" xref="S2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.p2.10.m10.1.1.1.cmml" xref="S2.p2.10.m10.1.1">subscript</csymbol><ci id="S2.p2.10.m10.1.1.2.cmml" xref="S2.p2.10.m10.1.1.2">𝑧</ci><ci id="S2.p2.10.m10.1.1.3.cmml" xref="S2.p2.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m10.1c">z_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.10.m10.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the stochastic state.</p>
</div>
<figure class="ltx_table" id="S2.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Experimental setups of the Minecraft AI agents. <span class="ltx_text ltx_font_italic" id="S2.T1.2.1">IL</span> is short for imitation learning.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S2.T1.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S2.T1.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S2.T1.3.1.1.1" style="padding-left:4.2pt;padding-right:4.2pt;">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T1.3.1.1.2" style="padding-left:4.2pt;padding-right:4.2pt;">Controller</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T1.3.1.1.3" style="padding-left:4.2pt;padding-right:4.2pt;">Observation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T1.3.1.1.4" style="padding-left:4.2pt;padding-right:4.2pt;">Video Demos</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.3.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S2.T1.3.2.1.1" style="padding-left:4.2pt;padding-right:4.2pt;">DECKARD <cite class="ltx_cite ltx_citemacro_citeyearpar">(<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib28" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.3.2.1.2" style="padding-left:4.2pt;padding-right:4.2pt;">RL</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.3.2.1.3" style="padding-left:4.2pt;padding-right:4.2pt;">Pixels &amp; Inventory</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.3.2.1.4" style="padding-left:4.2pt;padding-right:4.2pt;"><span class="ltx_text" id="S2.T1.3.2.1.4.1" style="color:#059905;">✓</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.3.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S2.T1.3.3.2.1" style="padding-left:4.2pt;padding-right:4.2pt;">Auto MC-Reward <cite class="ltx_cite ltx_citemacro_citeyearpar">(<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib20" title="">2024a</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S2.T1.3.3.2.2" style="padding-left:4.2pt;padding-right:4.2pt;">IL + RL</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.3.2.3" style="padding-left:4.2pt;padding-right:4.2pt;">Pixels &amp; GPS</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.3.2.4" style="padding-left:4.2pt;padding-right:4.2pt;"><span class="ltx_text" id="S2.T1.3.3.2.4.1" style="color:#CC0505;">✗</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.3.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S2.T1.3.4.3.1" style="padding-left:4.2pt;padding-right:4.2pt;">Voyager <cite class="ltx_cite ltx_citemacro_citeyearpar">(<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib36" title="">2024a</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S2.T1.3.4.3.2" style="padding-left:4.2pt;padding-right:4.2pt;">GPT-4</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.4.3.3" style="padding-left:4.2pt;padding-right:4.2pt;">Minecraft simulation &amp; Error trace</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.4.3.4" style="padding-left:4.2pt;padding-right:4.2pt;"><span class="ltx_text" id="S2.T1.3.4.3.4.1" style="color:#CC0505;">✗</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.3.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S2.T1.3.5.4.1" style="padding-left:4.2pt;padding-right:4.2pt;">DEPS <cite class="ltx_cite ltx_citemacro_citeyearpar">(<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib39" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S2.T1.3.5.4.2" style="padding-left:4.2pt;padding-right:4.2pt;">IL</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.5.4.3" style="padding-left:4.2pt;padding-right:4.2pt;">Pixels &amp; Yaw/pitch angle &amp; GPS &amp; Voxel</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.5.4.4" style="padding-left:4.2pt;padding-right:4.2pt;"><span class="ltx_text" id="S2.T1.3.5.4.4.1" style="color:#CC0505;">✗</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.3.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S2.T1.3.6.5.1" style="padding-left:4.2pt;padding-right:4.2pt;">STEVE-1 <cite class="ltx_cite ltx_citemacro_citeyearpar">(<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib22" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S2.T1.3.6.5.2" style="padding-left:4.2pt;padding-right:4.2pt;">Generative model</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.6.5.3" style="padding-left:4.2pt;padding-right:4.2pt;">Pixels</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.6.5.4" style="padding-left:4.2pt;padding-right:4.2pt;"><span class="ltx_text" id="S2.T1.3.6.5.4.1" style="color:#CC0505;">✗</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.3.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S2.T1.3.7.6.1" style="padding-left:4.2pt;padding-right:4.2pt;">VPT <cite class="ltx_cite ltx_citemacro_citeyearpar">(<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib2" title="">2022</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S2.T1.3.7.6.2" style="padding-left:4.2pt;padding-right:4.2pt;">IL + RL</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.7.6.3" style="padding-left:4.2pt;padding-right:4.2pt;">Pixels</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.7.6.4" style="padding-left:4.2pt;padding-right:4.2pt;"><span class="ltx_text" id="S2.T1.3.7.6.4.1" style="color:#059905;">✓</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.3.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S2.T1.3.8.7.1" style="padding-left:4.2pt;padding-right:4.2pt;">DreamerV3 <cite class="ltx_cite ltx_citemacro_citeyearpar">(<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib13" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S2.T1.3.8.7.2" style="padding-left:4.2pt;padding-right:4.2pt;">RL</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.8.7.3" style="padding-left:4.2pt;padding-right:4.2pt;">Pixels</td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.8.7.4" style="padding-left:4.2pt;padding-right:4.2pt;"><span class="ltx_text" id="S2.T1.3.8.7.4.1" style="color:#CC0505;">✗</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.3.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S2.T1.3.9.8.1" style="padding-left:4.2pt;padding-right:4.2pt;">LS-Imagine</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.3.9.8.2" style="padding-left:4.2pt;padding-right:4.2pt;">RL</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.3.9.8.3" style="padding-left:4.2pt;padding-right:4.2pt;">Pixels</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.3.9.8.4" style="padding-left:4.2pt;padding-right:4.2pt;"><span class="ltx_text" id="S2.T1.3.9.8.4.1" style="color:#CC0505;">✗</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overview of LS-Imagine</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">In this section, we present the details of LS-Imagine, which involves the following algorithm steps, including world model learning, behavior learning, and environment interaction:</p>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_italic" id="S3.I1.i1.p1.1.1">Affordance map computation</span> (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS2.SSS1" title="3.2.1 Affordance Map Computation via Virtual Exploration ‣ 3.2 Affordance Map and Intrinsic Reward ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>): We employ a sliding bounding box to scan individual images and execute continuous zoom-ins inside the bounding box, simulating consecutive video frames that correspond to long-distance state transitions. We then create affordance maps by assessing the relevance of the fake video clips to task-specific goals expressed in text using the established MineCLIP reward model <cite class="ltx_cite ltx_citemacro_citep">(Fan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib5" title="">2022</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S3.I1.i2.p1.1.1">Rapid affordance map generation</span> (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS2.SSS2" title="3.2.2 Multimodal U-Net for Rapid Affordance Map Generation ‣ 3.2 Affordance Map and Intrinsic Reward ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">3.2.2</span></a>): Given that affordance maps will be frequently used in subsequent Step 5 to evaluate the necessities for jumpy state transitions, we train a U-Net module to approximate the affordance maps annotated in Step 1 for the sake of efficiency.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_font_italic" id="S3.I1.i3.p1.1.1">World model training</span> (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS3" title="3.3 Long Short-Term World Model ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">3.3</span></a>): We train the world model to capture short- and long-term state transitions, using replay data with high responses from the affordance map. Each trajectory from the buffer includes pairs of samples from both adjacent time steps and long-distance intervals.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1"><span class="ltx_text ltx_font_italic" id="S3.I1.i4.p1.1.1">Behavior learning</span> (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS4" title="3.4 Behavior Learning over Mixed Long Short-Term Imaginations ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">3.4</span></a>): We perform an actor-critic algorithm to optimize the agent’s policy based on a finite sequence of long short-term imaginations generated by the world model.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="S3.I1.i5.p1">
<p class="ltx_p" id="S3.I1.i5.p1.1"><span class="ltx_text ltx_font_italic" id="S3.I1.i5.p1.1.1">Data update</span>: We apply the agent to interact with the environment and gather new data. Next, we leverage the generated affordance map to efficiently filter sample pairs suitable for long-term modeling, incorporating both short- and long-term sample pairs to update the replay buffer.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i6.p1">
<p class="ltx_p" id="S3.I1.i6.p1.1">Iterate Steps 3–5.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S3.SS1.p1.2">Below, we discuss the specific operations for each training step. For a complete description of the full training algorithm, please refer to Alg. <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#alg1" title="Algorithm 1 ‣ Appendix D Algorithm ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">1</span></a> in the <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS1.p1.2.1">Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A4" title="Appendix D Algorithm ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">D</span></a></span>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Affordance Map and Intrinsic Reward</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.4">We generate affordance maps using visual observations and textual task definitions to improve the sample efficiency of model-based reinforcement learning in open-world tasks. The core idea is to direct the agent’s attention to task-relevant areas of the visual observation, leading to higher exploration efficiency.
Let <math alttext="\mathcal{M}_{o_{t},I}(w,h)" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.4"><semantics id="S3.SS2.p1.1.m1.4a"><mrow id="S3.SS2.p1.1.m1.4.5" xref="S3.SS2.p1.1.m1.4.5.cmml"><msub id="S3.SS2.p1.1.m1.4.5.2" xref="S3.SS2.p1.1.m1.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.4.5.2.2" xref="S3.SS2.p1.1.m1.4.5.2.2.cmml">ℳ</mi><mrow id="S3.SS2.p1.1.m1.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml"><msub id="S3.SS2.p1.1.m1.2.2.2.2.1" xref="S3.SS2.p1.1.m1.2.2.2.2.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.2.2.1.2" xref="S3.SS2.p1.1.m1.2.2.2.2.1.2.cmml">o</mi><mi id="S3.SS2.p1.1.m1.2.2.2.2.1.3" xref="S3.SS2.p1.1.m1.2.2.2.2.1.3.cmml">t</mi></msub><mo id="S3.SS2.p1.1.m1.2.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">I</mi></mrow></msub><mo id="S3.SS2.p1.1.m1.4.5.1" xref="S3.SS2.p1.1.m1.4.5.1.cmml">⁢</mo><mrow id="S3.SS2.p1.1.m1.4.5.3.2" xref="S3.SS2.p1.1.m1.4.5.3.1.cmml"><mo id="S3.SS2.p1.1.m1.4.5.3.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.4.5.3.1.cmml">(</mo><mi id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml">w</mi><mo id="S3.SS2.p1.1.m1.4.5.3.2.2" xref="S3.SS2.p1.1.m1.4.5.3.1.cmml">,</mo><mi id="S3.SS2.p1.1.m1.4.4" xref="S3.SS2.p1.1.m1.4.4.cmml">h</mi><mo id="S3.SS2.p1.1.m1.4.5.3.2.3" stretchy="false" xref="S3.SS2.p1.1.m1.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.4b"><apply id="S3.SS2.p1.1.m1.4.5.cmml" xref="S3.SS2.p1.1.m1.4.5"><times id="S3.SS2.p1.1.m1.4.5.1.cmml" xref="S3.SS2.p1.1.m1.4.5.1"></times><apply id="S3.SS2.p1.1.m1.4.5.2.cmml" xref="S3.SS2.p1.1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.5.2.1.cmml" xref="S3.SS2.p1.1.m1.4.5.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.5.2.2.cmml" xref="S3.SS2.p1.1.m1.4.5.2.2">ℳ</ci><list id="S3.SS2.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2"><apply id="S3.SS2.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1.2">𝑜</ci><ci id="S3.SS2.p1.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1.3">𝑡</ci></apply><ci id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1">𝐼</ci></list></apply><interval closure="open" id="S3.SS2.p1.1.m1.4.5.3.1.cmml" xref="S3.SS2.p1.1.m1.4.5.3.2"><ci id="S3.SS2.p1.1.m1.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3">𝑤</ci><ci id="S3.SS2.p1.1.m1.4.4.cmml" xref="S3.SS2.p1.1.m1.4.4">ℎ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.4c">\mathcal{M}_{o_{t},I}(w,h)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.4d">caligraphic_M start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I end_POSTSUBSCRIPT ( italic_w , italic_h )</annotation></semantics></math> be the affordance map that represents the potential exploration value at pixel position <math alttext="(w,h)" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.2"><semantics id="S3.SS2.p1.2.m2.2a"><mrow id="S3.SS2.p1.2.m2.2.3.2" xref="S3.SS2.p1.2.m2.2.3.1.cmml"><mo id="S3.SS2.p1.2.m2.2.3.2.1" stretchy="false" xref="S3.SS2.p1.2.m2.2.3.1.cmml">(</mo><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">w</mi><mo id="S3.SS2.p1.2.m2.2.3.2.2" xref="S3.SS2.p1.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.2.m2.2.2" xref="S3.SS2.p1.2.m2.2.2.cmml">h</mi><mo id="S3.SS2.p1.2.m2.2.3.2.3" stretchy="false" xref="S3.SS2.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.2b"><interval closure="open" id="S3.SS2.p1.2.m2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.3.2"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑤</ci><ci id="S3.SS2.p1.2.m2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2">ℎ</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.2c">(w,h)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.2d">( italic_w , italic_h )</annotation></semantics></math> on the image observation <math alttext="o_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">o</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑜</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, given textual instruction <math alttext="I" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_I</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S3.SS2.p1.4.1">e.g.</span>, “cut a tree”).
The affordance map highlights the relevance between regions of the observation and the task description, serving as a spatial prior that effectively directs the agent’s exploration toward areas of interest.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Affordance Map Computation via Virtual Exploration</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.13">To create the affordance map, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.F2.sf1" title="In Figure 2 ‣ 3.2.1 Affordance Map Computation via Virtual Exploration ‣ 3.2 Affordance Map and Intrinsic Reward ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">2(a)</span></a>, we simulate and evaluate the agent’s exploration without relying on real successful trajectories.
Concretely, we first adopt a random agent to interact with task-specific environments for data collection.
Starting with the agent’s observation <math alttext="o_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><msub id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">o</mi><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">𝑜</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><mi id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><ci id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">italic_t</annotation></semantics></math>, we use a sliding bounding box with dimensions scaled to <math alttext="15\%" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mrow id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml"><mn id="S3.SS2.SSS1.p1.3.m3.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml">15</mn><mo id="S3.SS2.SSS1.p1.3.m3.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1">percent</csymbol><cn id="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml" type="integer" xref="S3.SS2.SSS1.p1.3.m3.1.1.2">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">15\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">15 %</annotation></semantics></math> of the observation’s width and height to traverse the entire observation from left to right and top to bottom.
The sliding bounding box moves horizontally and vertically in <math alttext="9" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m4.1"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><mn id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><cn id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" type="integer" xref="S3.SS2.SSS1.p1.4.m4.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">9</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">9</annotation></semantics></math> steps, respectively, covering every potential region in both dimensions.
For each position on the sliding bounding box of the observation <math alttext="o_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.5.m5.1"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><msub id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.1.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml">o</mi><mi id="S3.SS2.SSS1.p1.5.m5.1.1.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><apply id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2">𝑜</ci><ci id="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m5.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we crop <math alttext="16" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.6.m6.1"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><mn id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><cn id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" type="integer" xref="S3.SS2.SSS1.p1.6.m6.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">16</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.6.m6.1d">16</annotation></semantics></math> images from <math alttext="o_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.7.m7.1"><semantics id="S3.SS2.SSS1.p1.7.m7.1a"><msub id="S3.SS2.SSS1.p1.7.m7.1.1" xref="S3.SS2.SSS1.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.1.1.2" xref="S3.SS2.SSS1.p1.7.m7.1.1.2.cmml">o</mi><mi id="S3.SS2.SSS1.p1.7.m7.1.1.3" xref="S3.SS2.SSS1.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.7.m7.1b"><apply id="S3.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.2">𝑜</ci><ci id="S3.SS2.SSS1.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.7.m7.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.7.m7.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
These cropped images narrow the field of view to focus on the region and are resized back to the original image dimensions.
These resized images are denoted as <math alttext="x_{t}^{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.8.m8.1"><semantics id="S3.SS2.SSS1.p1.8.m8.1a"><msubsup id="S3.SS2.SSS1.p1.8.m8.1.1" xref="S3.SS2.SSS1.p1.8.m8.1.1.cmml"><mi id="S3.SS2.SSS1.p1.8.m8.1.1.2.2" xref="S3.SS2.SSS1.p1.8.m8.1.1.2.2.cmml">x</mi><mi id="S3.SS2.SSS1.p1.8.m8.1.1.2.3" xref="S3.SS2.SSS1.p1.8.m8.1.1.2.3.cmml">t</mi><mi id="S3.SS2.SSS1.p1.8.m8.1.1.3" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.8.m8.1b"><apply id="S3.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.2.2">𝑥</ci><ci id="S3.SS2.SSS1.p1.8.m8.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS1.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.8.m8.1c">x_{t}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.8.m8.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> (where <math alttext="0\leq k&lt;16" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.9.m9.1"><semantics id="S3.SS2.SSS1.p1.9.m9.1a"><mrow id="S3.SS2.SSS1.p1.9.m9.1.1" xref="S3.SS2.SSS1.p1.9.m9.1.1.cmml"><mn id="S3.SS2.SSS1.p1.9.m9.1.1.2" xref="S3.SS2.SSS1.p1.9.m9.1.1.2.cmml">0</mn><mo id="S3.SS2.SSS1.p1.9.m9.1.1.3" xref="S3.SS2.SSS1.p1.9.m9.1.1.3.cmml">≤</mo><mi id="S3.SS2.SSS1.p1.9.m9.1.1.4" xref="S3.SS2.SSS1.p1.9.m9.1.1.4.cmml">k</mi><mo id="S3.SS2.SSS1.p1.9.m9.1.1.5" xref="S3.SS2.SSS1.p1.9.m9.1.1.5.cmml">&lt;</mo><mn id="S3.SS2.SSS1.p1.9.m9.1.1.6" xref="S3.SS2.SSS1.p1.9.m9.1.1.6.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.9.m9.1b"><apply id="S3.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1"><and id="S3.SS2.SSS1.p1.9.m9.1.1a.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1"></and><apply id="S3.SS2.SSS1.p1.9.m9.1.1b.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1"><leq id="S3.SS2.SSS1.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.3"></leq><cn id="S3.SS2.SSS1.p1.9.m9.1.1.2.cmml" type="integer" xref="S3.SS2.SSS1.p1.9.m9.1.1.2">0</cn><ci id="S3.SS2.SSS1.p1.9.m9.1.1.4.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.4">𝑘</ci></apply><apply id="S3.SS2.SSS1.p1.9.m9.1.1c.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1"><lt id="S3.SS2.SSS1.p1.9.m9.1.1.5.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.5"></lt><share href="https://arxiv.org/html/2410.03618v1#S3.SS2.SSS1.p1.9.m9.1.1.4.cmml" id="S3.SS2.SSS1.p1.9.m9.1.1d.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1"></share><cn id="S3.SS2.SSS1.p1.9.m9.1.1.6.cmml" type="integer" xref="S3.SS2.SSS1.p1.9.m9.1.1.6">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.9.m9.1c">0\leq k&lt;16</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.9.m9.1d">0 ≤ italic_k &lt; 16</annotation></semantics></math>). The ordered set <math alttext="\mathcal{X}_{t}=[x_{t}^{k}\mid k=0,1,\ldots,15]" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.10.m10.5"><semantics id="S3.SS2.SSS1.p1.10.m10.5a"><mrow id="S3.SS2.SSS1.p1.10.m10.5.5" xref="S3.SS2.SSS1.p1.10.m10.5.5.cmml"><msub id="S3.SS2.SSS1.p1.10.m10.5.5.3" xref="S3.SS2.SSS1.p1.10.m10.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.10.m10.5.5.3.2" xref="S3.SS2.SSS1.p1.10.m10.5.5.3.2.cmml">𝒳</mi><mi id="S3.SS2.SSS1.p1.10.m10.5.5.3.3" xref="S3.SS2.SSS1.p1.10.m10.5.5.3.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.p1.10.m10.5.5.2" xref="S3.SS2.SSS1.p1.10.m10.5.5.2.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.10.m10.5.5.1.1" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.2.cmml"><mo id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.2.1.cmml">[</mo><mrow id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.cmml"><mrow id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.cmml"><msubsup id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.2.2" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.2.2.cmml">x</mi><mi id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.2.3" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.2.3.cmml">t</mi><mi id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.3" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.1" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.1.cmml">∣</mo><mi id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.3" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.3.cmml">k</mi></mrow><mo id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.1" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.3.2" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.3.1.cmml"><mn id="S3.SS2.SSS1.p1.10.m10.1.1" xref="S3.SS2.SSS1.p1.10.m10.1.1.cmml">0</mn><mo id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.3.2.1" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.3.1.cmml">,</mo><mn id="S3.SS2.SSS1.p1.10.m10.2.2" xref="S3.SS2.SSS1.p1.10.m10.2.2.cmml">1</mn><mo id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.3.2.2" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.SSS1.p1.10.m10.3.3" mathvariant="normal" xref="S3.SS2.SSS1.p1.10.m10.3.3.cmml">…</mi><mo id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.3.2.3" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.3.1.cmml">,</mo><mn id="S3.SS2.SSS1.p1.10.m10.4.4" xref="S3.SS2.SSS1.p1.10.m10.4.4.cmml">15</mn></mrow></mrow><mo id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.10.m10.5b"><apply id="S3.SS2.SSS1.p1.10.m10.5.5.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5"><eq id="S3.SS2.SSS1.p1.10.m10.5.5.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.2"></eq><apply id="S3.SS2.SSS1.p1.10.m10.5.5.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m10.5.5.3.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.10.m10.5.5.3.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.3.2">𝒳</ci><ci id="S3.SS2.SSS1.p1.10.m10.5.5.3.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.3.3">𝑡</ci></apply><apply id="S3.SS2.SSS1.p1.10.m10.5.5.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p1.10.m10.5.5.1.2.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1"><eq id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.1"></eq><apply id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2"><csymbol cd="latexml" id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.1">conditional</csymbol><apply id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2">superscript</csymbol><apply id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.2.2">𝑥</ci><ci id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.2.3">𝑡</ci></apply><ci id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.2.3">𝑘</ci></apply><list id="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.5.5.1.1.1.3.2"><cn id="S3.SS2.SSS1.p1.10.m10.1.1.cmml" type="integer" xref="S3.SS2.SSS1.p1.10.m10.1.1">0</cn><cn id="S3.SS2.SSS1.p1.10.m10.2.2.cmml" type="integer" xref="S3.SS2.SSS1.p1.10.m10.2.2">1</cn><ci id="S3.SS2.SSS1.p1.10.m10.3.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.3.3">…</ci><cn id="S3.SS2.SSS1.p1.10.m10.4.4.cmml" type="integer" xref="S3.SS2.SSS1.p1.10.m10.4.4">15</cn></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.10.m10.5c">\mathcal{X}_{t}=[x_{t}^{k}\mid k=0,1,\ldots,15]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.10.m10.5d">caligraphic_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ∣ italic_k = 0 , 1 , … , 15 ]</annotation></semantics></math> represents a sequence of <math alttext="16" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.11.m11.1"><semantics id="S3.SS2.SSS1.p1.11.m11.1a"><mn id="S3.SS2.SSS1.p1.11.m11.1.1" xref="S3.SS2.SSS1.p1.11.m11.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.11.m11.1b"><cn id="S3.SS2.SSS1.p1.11.m11.1.1.cmml" type="integer" xref="S3.SS2.SSS1.p1.11.m11.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.11.m11.1c">16</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.11.m11.1d">16</annotation></semantics></math> frames simulating the visual transition as the agent moves towards the position specified by the current sliding bounding box.
Subsequently, we employ the MineCLIP model to calculate the correlation between the <math alttext="\mathcal{X}_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.12.m12.1"><semantics id="S3.SS2.SSS1.p1.12.m12.1a"><msub id="S3.SS2.SSS1.p1.12.m12.1.1" xref="S3.SS2.SSS1.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.12.m12.1.1.2" xref="S3.SS2.SSS1.p1.12.m12.1.1.2.cmml">𝒳</mi><mi id="S3.SS2.SSS1.p1.12.m12.1.1.3" xref="S3.SS2.SSS1.p1.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.12.m12.1b"><apply id="S3.SS2.SSS1.p1.12.m12.1.1.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.12.m12.1.1.1.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.12.m12.1.1.2.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1.2">𝒳</ci><ci id="S3.SS2.SSS1.p1.12.m12.1.1.3.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.12.m12.1c">\mathcal{X}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.12.m12.1d">caligraphic_X start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> of images, simulating the virtual exploration process, and the task description <math alttext="I" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.13.m13.1"><semantics id="S3.SS2.SSS1.p1.13.m13.1a"><mi id="S3.SS2.SSS1.p1.13.m13.1.1" xref="S3.SS2.SSS1.p1.13.m13.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.13.m13.1b"><ci id="S3.SS2.SSS1.p1.13.m13.1.1.cmml" xref="S3.SS2.SSS1.p1.13.m13.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.13.m13.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.13.m13.1d">italic_I</annotation></semantics></math>.
In this way, we quantify the affordance value of the sliding bounding box, indicating the potential exploration interest of the area.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">After calculating the correlation score for each sliding bounding box, we fuse these values to obtain a smooth affordance map <math alttext="\mathcal{M}_{o_{t},I}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.1.m1.2"><semantics id="S3.SS2.SSS1.p2.1.m1.2a"><msub id="S3.SS2.SSS1.p2.1.m1.2.3" xref="S3.SS2.SSS1.p2.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.1.m1.2.3.2" xref="S3.SS2.SSS1.p2.1.m1.2.3.2.cmml">ℳ</mi><mrow id="S3.SS2.SSS1.p2.1.m1.2.2.2.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.2.3.cmml"><msub id="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1" xref="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.2.cmml">o</mi><mi id="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.3" xref="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.p2.1.m1.2.2.2.2.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS1.p2.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.cmml">I</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.2b"><apply id="S3.SS2.SSS1.p2.1.m1.2.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.2.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.2.3.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.3.2">ℳ</ci><list id="S3.SS2.SSS1.p2.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.2.2"><apply id="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.2">𝑜</ci><ci id="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.2.2.1.3">𝑡</ci></apply><ci id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1">𝐼</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.2c">\mathcal{M}_{o_{t},I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.1.m1.2d">caligraphic_M start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I end_POSTSUBSCRIPT</annotation></semantics></math>. For pixels that are covered by multiple sliding bounding boxes due to overlapping regions, the integrated affordance value is obtained by averaging the values from all the overlapping windows.</p>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="274" id="S3.F2.sf1.g1" src="x2.png" width="387"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Affordance map calculation</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="289" id="S3.F2.sf2.g1" src="x3.png" width="343"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Rapid affordance map generation</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The two steps for on-the-fly affordance map estimation: (a) Simulate exploration via image zoom-in and calculate the task-correlation scores of the virtual explorations using MineCLIP. (b) Learn to generate affordance maps more efficiently using a multimodal U-Net.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Multimodal U-Net for Rapid Affordance Map Generation</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">The annotation of affordance maps, as previously described, involves extensive window traversal and computations for each window position using a pre-trained video-text alignment model.
This method is computationally demanding and time-consuming, making real-time applications challenging.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.1">To address this issue, we first use a random agent to interact with the environment for data collection.
Next, we annotate the affordance maps for the collected images using the aforementioned method based on virtual exploration.
We gather a dataset of tuples (<math alttext="o_{t},I,\mathcal{M}_{o_{t},I}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.1.m1.5"><semantics id="S3.SS2.SSS2.p2.1.m1.5a"><mrow id="S3.SS2.SSS2.p2.1.m1.5.5.2" xref="S3.SS2.SSS2.p2.1.m1.5.5.3.cmml"><msub id="S3.SS2.SSS2.p2.1.m1.4.4.1.1" xref="S3.SS2.SSS2.p2.1.m1.4.4.1.1.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.4.4.1.1.2" xref="S3.SS2.SSS2.p2.1.m1.4.4.1.1.2.cmml">o</mi><mi id="S3.SS2.SSS2.p2.1.m1.4.4.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.4.4.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS2.p2.1.m1.5.5.2.3" xref="S3.SS2.SSS2.p2.1.m1.5.5.3.cmml">,</mo><mi id="S3.SS2.SSS2.p2.1.m1.3.3" xref="S3.SS2.SSS2.p2.1.m1.3.3.cmml">I</mi><mo id="S3.SS2.SSS2.p2.1.m1.5.5.2.4" xref="S3.SS2.SSS2.p2.1.m1.5.5.3.cmml">,</mo><msub id="S3.SS2.SSS2.p2.1.m1.5.5.2.2" xref="S3.SS2.SSS2.p2.1.m1.5.5.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p2.1.m1.5.5.2.2.2" xref="S3.SS2.SSS2.p2.1.m1.5.5.2.2.2.cmml">ℳ</mi><mrow id="S3.SS2.SSS2.p2.1.m1.2.2.2.2" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.3.cmml"><msub id="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.2" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.2.cmml">o</mi><mi id="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.3" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS2.p2.1.m1.2.2.2.2.2" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS2.p2.1.m1.1.1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1.cmml">I</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.5b"><list id="S3.SS2.SSS2.p2.1.m1.5.5.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.5.5.2"><apply id="S3.SS2.SSS2.p2.1.m1.4.4.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.4.4.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.4.4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.4.4.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.4.4.1.1.2">𝑜</ci><ci id="S3.SS2.SSS2.p2.1.m1.4.4.1.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.4.4.1.1.3">𝑡</ci></apply><ci id="S3.SS2.SSS2.p2.1.m1.3.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.3">𝐼</ci><apply id="S3.SS2.SSS2.p2.1.m1.5.5.2.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.5.5.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.5.5.2.2.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.5.5.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.5.5.2.2.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.5.5.2.2.2">ℳ</ci><list id="S3.SS2.SSS2.p2.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.2"><apply id="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.2">𝑜</ci><ci id="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.2.2.1.3">𝑡</ci></apply><ci id="S3.SS2.SSS2.p2.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.1">𝐼</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.5c">o_{t},I,\mathcal{M}_{o_{t},I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.1.m1.5d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I , caligraphic_M start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I end_POSTSUBSCRIPT</annotation></semantics></math>) and use it to train a multimodal U-Net, building upon the Swin-Unet architecture <cite class="ltx_cite ltx_citemacro_citep">(Cao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib3" title="">2022</a>)</cite>.
To handle multimodal inputs effectively, we extract text features from the language instructions and image features from the downsampling process of Swin-Unet, and then fuse them with multi-head attention.
For architecture details of the proposed model, please refer to Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A2.F9" title="Figure 9 ‣ B.2 Framework of Multimodal U-Net ‣ Appendix B Model Details ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">9</span></a> in the Appendix.
In this way, with the pretrained multimodal U-Net, we can efficiently generate affordance maps at each time step using visual observations and language instructions.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Affordance-Driven Intrinsic Reward</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.5">To leverage the task-relevant prior knowledge presented by the affordance map for efficient exploration in the open world, we introduce the following intrinsic reward function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r^{i}_{t}=\frac{1}{WH}\sum_{w=1}^{W}\sum_{h=1}^{H}\mathcal{M}_{o_{t},I}(w,h)%
\cdot\mathcal{G}(w,h)," class="ltx_Math" display="block" id="S3.E1.m1.7"><semantics id="S3.E1.m1.7a"><mrow id="S3.E1.m1.7.7.1" xref="S3.E1.m1.7.7.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1" xref="S3.E1.m1.7.7.1.1.cmml"><msubsup id="S3.E1.m1.7.7.1.1.2" xref="S3.E1.m1.7.7.1.1.2.cmml"><mi id="S3.E1.m1.7.7.1.1.2.2.2" xref="S3.E1.m1.7.7.1.1.2.2.2.cmml">r</mi><mi id="S3.E1.m1.7.7.1.1.2.3" xref="S3.E1.m1.7.7.1.1.2.3.cmml">t</mi><mi id="S3.E1.m1.7.7.1.1.2.2.3" xref="S3.E1.m1.7.7.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S3.E1.m1.7.7.1.1.1" xref="S3.E1.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.7.7.1.1.3" xref="S3.E1.m1.7.7.1.1.3.cmml"><mfrac id="S3.E1.m1.7.7.1.1.3.2" xref="S3.E1.m1.7.7.1.1.3.2.cmml"><mn id="S3.E1.m1.7.7.1.1.3.2.2" xref="S3.E1.m1.7.7.1.1.3.2.2.cmml">1</mn><mrow id="S3.E1.m1.7.7.1.1.3.2.3" xref="S3.E1.m1.7.7.1.1.3.2.3.cmml"><mi id="S3.E1.m1.7.7.1.1.3.2.3.2" xref="S3.E1.m1.7.7.1.1.3.2.3.2.cmml">W</mi><mo id="S3.E1.m1.7.7.1.1.3.2.3.1" xref="S3.E1.m1.7.7.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.7.7.1.1.3.2.3.3" xref="S3.E1.m1.7.7.1.1.3.2.3.3.cmml">H</mi></mrow></mfrac><mo id="S3.E1.m1.7.7.1.1.3.1" xref="S3.E1.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.7.7.1.1.3.3" xref="S3.E1.m1.7.7.1.1.3.3.cmml"><munderover id="S3.E1.m1.7.7.1.1.3.3.1" xref="S3.E1.m1.7.7.1.1.3.3.1.cmml"><mo id="S3.E1.m1.7.7.1.1.3.3.1.2.2" movablelimits="false" rspace="0em" xref="S3.E1.m1.7.7.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.7.7.1.1.3.3.1.2.3" xref="S3.E1.m1.7.7.1.1.3.3.1.2.3.cmml"><mi id="S3.E1.m1.7.7.1.1.3.3.1.2.3.2" xref="S3.E1.m1.7.7.1.1.3.3.1.2.3.2.cmml">w</mi><mo id="S3.E1.m1.7.7.1.1.3.3.1.2.3.1" xref="S3.E1.m1.7.7.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.7.7.1.1.3.3.1.2.3.3" xref="S3.E1.m1.7.7.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.7.7.1.1.3.3.1.3" xref="S3.E1.m1.7.7.1.1.3.3.1.3.cmml">W</mi></munderover><mrow id="S3.E1.m1.7.7.1.1.3.3.2" xref="S3.E1.m1.7.7.1.1.3.3.2.cmml"><munderover id="S3.E1.m1.7.7.1.1.3.3.2.1" xref="S3.E1.m1.7.7.1.1.3.3.2.1.cmml"><mo id="S3.E1.m1.7.7.1.1.3.3.2.1.2.2" movablelimits="false" xref="S3.E1.m1.7.7.1.1.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.7.7.1.1.3.3.2.1.2.3" xref="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.cmml"><mi id="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.2" xref="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.2.cmml">h</mi><mo id="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.1" xref="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.3" xref="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.7.7.1.1.3.3.2.1.3" xref="S3.E1.m1.7.7.1.1.3.3.2.1.3.cmml">H</mi></munderover><mrow id="S3.E1.m1.7.7.1.1.3.3.2.2" xref="S3.E1.m1.7.7.1.1.3.3.2.2.cmml"><mrow id="S3.E1.m1.7.7.1.1.3.3.2.2.2" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.cmml"><mrow id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.cmml"><msub id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.2" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.2.2" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.2.2.cmml">ℳ</mi><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.3.cmml"><msub id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.1.cmml"><mi id="S3.E1.m1.2.2.2.2.1.2" xref="S3.E1.m1.2.2.2.2.1.2.cmml">o</mi><mi id="S3.E1.m1.2.2.2.2.1.3" xref="S3.E1.m1.2.2.2.2.1.3.cmml">t</mi></msub><mo id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">I</mi></mrow></msub><mo id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.1" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.3.2" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.3.1.cmml"><mo id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.3.2.1" stretchy="false" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.3.1.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">w</mi><mo id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.3.2.2" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.3.1.cmml">,</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">h</mi><mo id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.3.2.3" rspace="0.055em" stretchy="false" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.7.7.1.1.3.3.2.2.2.1" rspace="0.222em" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.1.cmml">⋅</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.1.1.3.3.2.2.2.3" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.3.cmml">𝒢</mi></mrow><mo id="S3.E1.m1.7.7.1.1.3.3.2.2.1" xref="S3.E1.m1.7.7.1.1.3.3.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.7.7.1.1.3.3.2.2.3.2" xref="S3.E1.m1.7.7.1.1.3.3.2.2.3.1.cmml"><mo id="S3.E1.m1.7.7.1.1.3.3.2.2.3.2.1" stretchy="false" xref="S3.E1.m1.7.7.1.1.3.3.2.2.3.1.cmml">(</mo><mi id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml">w</mi><mo id="S3.E1.m1.7.7.1.1.3.3.2.2.3.2.2" xref="S3.E1.m1.7.7.1.1.3.3.2.2.3.1.cmml">,</mo><mi id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml">h</mi><mo id="S3.E1.m1.7.7.1.1.3.3.2.2.3.2.3" stretchy="false" xref="S3.E1.m1.7.7.1.1.3.3.2.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.7.7.1.2" xref="S3.E1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.7b"><apply id="S3.E1.m1.7.7.1.1.cmml" xref="S3.E1.m1.7.7.1"><eq id="S3.E1.m1.7.7.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1"></eq><apply id="S3.E1.m1.7.7.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.2">subscript</csymbol><apply id="S3.E1.m1.7.7.1.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.2.2.1.cmml" xref="S3.E1.m1.7.7.1.1.2">superscript</csymbol><ci id="S3.E1.m1.7.7.1.1.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2">𝑟</ci><ci id="S3.E1.m1.7.7.1.1.2.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.7.7.1.1.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.3">𝑡</ci></apply><apply id="S3.E1.m1.7.7.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.3"><times id="S3.E1.m1.7.7.1.1.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3.1"></times><apply id="S3.E1.m1.7.7.1.1.3.2.cmml" xref="S3.E1.m1.7.7.1.1.3.2"><divide id="S3.E1.m1.7.7.1.1.3.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.2"></divide><cn id="S3.E1.m1.7.7.1.1.3.2.2.cmml" type="integer" xref="S3.E1.m1.7.7.1.1.3.2.2">1</cn><apply id="S3.E1.m1.7.7.1.1.3.2.3.cmml" xref="S3.E1.m1.7.7.1.1.3.2.3"><times id="S3.E1.m1.7.7.1.1.3.2.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3.2.3.1"></times><ci id="S3.E1.m1.7.7.1.1.3.2.3.2.cmml" xref="S3.E1.m1.7.7.1.1.3.2.3.2">𝑊</ci><ci id="S3.E1.m1.7.7.1.1.3.2.3.3.cmml" xref="S3.E1.m1.7.7.1.1.3.2.3.3">𝐻</ci></apply></apply><apply id="S3.E1.m1.7.7.1.1.3.3.cmml" xref="S3.E1.m1.7.7.1.1.3.3"><apply id="S3.E1.m1.7.7.1.1.3.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.3.1.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.1">superscript</csymbol><apply id="S3.E1.m1.7.7.1.1.3.3.1.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.3.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.1">subscript</csymbol><sum id="S3.E1.m1.7.7.1.1.3.3.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.1.2.2"></sum><apply id="S3.E1.m1.7.7.1.1.3.3.1.2.3.cmml" xref="S3.E1.m1.7.7.1.1.3.3.1.2.3"><eq id="S3.E1.m1.7.7.1.1.3.3.1.2.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.1.2.3.1"></eq><ci id="S3.E1.m1.7.7.1.1.3.3.1.2.3.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.1.2.3.2">𝑤</ci><cn id="S3.E1.m1.7.7.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.7.7.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.7.7.1.1.3.3.1.3.cmml" xref="S3.E1.m1.7.7.1.1.3.3.1.3">𝑊</ci></apply><apply id="S3.E1.m1.7.7.1.1.3.3.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2"><apply id="S3.E1.m1.7.7.1.1.3.3.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.3.2.1.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.1">superscript</csymbol><apply id="S3.E1.m1.7.7.1.1.3.3.2.1.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.3.2.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.1">subscript</csymbol><sum id="S3.E1.m1.7.7.1.1.3.3.2.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.1.2.2"></sum><apply id="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.1.2.3"><eq id="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.1"></eq><ci id="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.2">ℎ</ci><cn id="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.7.7.1.1.3.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.7.7.1.1.3.3.2.1.3.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.1.3">𝐻</ci></apply><apply id="S3.E1.m1.7.7.1.1.3.3.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2"><times id="S3.E1.m1.7.7.1.1.3.3.2.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.1"></times><apply id="S3.E1.m1.7.7.1.1.3.3.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2"><ci id="S3.E1.m1.7.7.1.1.3.3.2.2.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.1">⋅</ci><apply id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2"><times id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.1"></times><apply id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.2.2">ℳ</ci><list id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2"><apply id="S3.E1.m1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.2">𝑜</ci><ci id="S3.E1.m1.2.2.2.2.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.3">𝑡</ci></apply><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝐼</ci></list></apply><interval closure="open" id="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.2.3.2"><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑤</ci><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">ℎ</ci></interval></apply><ci id="S3.E1.m1.7.7.1.1.3.3.2.2.2.3.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.2.3">𝒢</ci></apply><interval closure="open" id="S3.E1.m1.7.7.1.1.3.3.2.2.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2.2.3.2"><ci id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5">𝑤</ci><ci id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6">ℎ</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.7c">r^{i}_{t}=\frac{1}{WH}\sum_{w=1}^{W}\sum_{h=1}^{H}\mathcal{M}_{o_{t},I}(w,h)%
\cdot\mathcal{G}(w,h),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.7d">italic_r start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_W italic_H end_ARG ∑ start_POSTSUBSCRIPT italic_w = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_W end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_h = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT caligraphic_M start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I end_POSTSUBSCRIPT ( italic_w , italic_h ) ⋅ caligraphic_G ( italic_w , italic_h ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS3.p1.3">where <math alttext="W" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.1.m1.1"><semantics id="S3.SS2.SSS3.p1.1.m1.1a"><mi id="S3.SS2.SSS3.p1.1.m1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.1b"><ci id="S3.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.1.m1.1d">italic_W</annotation></semantics></math> and <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.2.m2.1"><semantics id="S3.SS2.SSS3.p1.2.m2.1a"><mi id="S3.SS2.SSS3.p1.2.m2.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.2.m2.1b"><ci id="S3.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.2.m2.1d">italic_H</annotation></semantics></math> denote the width and height of the visual observation, respectively. <math alttext="\mathcal{G}(w,h)" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.3.m3.2"><semantics id="S3.SS2.SSS3.p1.3.m3.2a"><mrow id="S3.SS2.SSS3.p1.3.m3.2.3" xref="S3.SS2.SSS3.p1.3.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.p1.3.m3.2.3.2" xref="S3.SS2.SSS3.p1.3.m3.2.3.2.cmml">𝒢</mi><mo id="S3.SS2.SSS3.p1.3.m3.2.3.1" xref="S3.SS2.SSS3.p1.3.m3.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.3.m3.2.3.3.2" xref="S3.SS2.SSS3.p1.3.m3.2.3.3.1.cmml"><mo id="S3.SS2.SSS3.p1.3.m3.2.3.3.2.1" stretchy="false" xref="S3.SS2.SSS3.p1.3.m3.2.3.3.1.cmml">(</mo><mi id="S3.SS2.SSS3.p1.3.m3.1.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.cmml">w</mi><mo id="S3.SS2.SSS3.p1.3.m3.2.3.3.2.2" xref="S3.SS2.SSS3.p1.3.m3.2.3.3.1.cmml">,</mo><mi id="S3.SS2.SSS3.p1.3.m3.2.2" xref="S3.SS2.SSS3.p1.3.m3.2.2.cmml">h</mi><mo id="S3.SS2.SSS3.p1.3.m3.2.3.3.2.3" stretchy="false" xref="S3.SS2.SSS3.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.3.m3.2b"><apply id="S3.SS2.SSS3.p1.3.m3.2.3.cmml" xref="S3.SS2.SSS3.p1.3.m3.2.3"><times id="S3.SS2.SSS3.p1.3.m3.2.3.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.2.3.1"></times><ci id="S3.SS2.SSS3.p1.3.m3.2.3.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.2.3.2">𝒢</ci><interval closure="open" id="S3.SS2.SSS3.p1.3.m3.2.3.3.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.2.3.3.2"><ci id="S3.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1">𝑤</ci><ci id="S3.SS2.SSS3.p1.3.m3.2.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.2.2">ℎ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.3.m3.2c">\mathcal{G}(w,h)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.3.m3.2d">caligraphic_G ( italic_w , italic_h )</annotation></semantics></math> represents a Gaussian matrix with the same dimensions as the affordance map.
Consequently, the agent receives a composite reward consisting of the episodic sparse reward from the environment, the reward from MineCLIP <cite class="ltx_cite ltx_citemacro_citep">(Fan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib5" title="">2022</a>)</cite>, and the intrinsic reward from the affordance map:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{t}=r^{e}+r_{t}^{\text{MineCLIP}}+\alpha r_{t}^{i}," class="ltx_Math" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.2.2.cmml">r</mi><mi id="S3.E2.m1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><msup id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.3.2.2.cmml">r</mi><mi id="S3.E2.m1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.3.2.3.cmml">e</mi></msup><mo id="S3.E2.m1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.2.2" xref="S3.E2.m1.1.1.1.1.3.3.2.2.cmml">r</mi><mi id="S3.E2.m1.1.1.1.1.3.3.2.3" xref="S3.E2.m1.1.1.1.1.3.3.2.3.cmml">t</mi><mtext id="S3.E2.m1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3a.cmml">MineCLIP</mtext></msubsup><mo id="S3.E2.m1.1.1.1.1.3.1a" xref="S3.E2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1.3.4" xref="S3.E2.m1.1.1.1.1.3.4.cmml"><mi id="S3.E2.m1.1.1.1.1.3.4.2" xref="S3.E2.m1.1.1.1.1.3.4.2.cmml">α</mi><mo id="S3.E2.m1.1.1.1.1.3.4.1" xref="S3.E2.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msubsup id="S3.E2.m1.1.1.1.1.3.4.3" xref="S3.E2.m1.1.1.1.1.3.4.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.4.3.2.2" xref="S3.E2.m1.1.1.1.1.3.4.3.2.2.cmml">r</mi><mi id="S3.E2.m1.1.1.1.1.3.4.3.2.3" xref="S3.E2.m1.1.1.1.1.3.4.3.2.3.cmml">t</mi><mi id="S3.E2.m1.1.1.1.1.3.4.3.3" xref="S3.E2.m1.1.1.1.1.3.4.3.3.cmml">i</mi></msubsup></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"></eq><apply id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2">𝑟</ci><ci id="S3.E2.m1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><plus id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.1"></plus><apply id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2">𝑟</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3">𝑒</ci></apply><apply id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.2">𝑟</ci><ci id="S3.E2.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="S3.E2.m1.1.1.1.1.3.3.3a.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3"><mtext id="S3.E2.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E2.m1.1.1.1.1.3.3.3">MineCLIP</mtext></ci></apply><apply id="S3.E2.m1.1.1.1.1.3.4.cmml" xref="S3.E2.m1.1.1.1.1.3.4"><times id="S3.E2.m1.1.1.1.1.3.4.1.cmml" xref="S3.E2.m1.1.1.1.1.3.4.1"></times><ci id="S3.E2.m1.1.1.1.1.3.4.2.cmml" xref="S3.E2.m1.1.1.1.1.3.4.2">𝛼</ci><apply id="S3.E2.m1.1.1.1.1.3.4.3.cmml" xref="S3.E2.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.4.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.4.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.4.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.4.3.2.2">𝑟</ci><ci id="S3.E2.m1.1.1.1.1.3.4.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.4.3.2.3">𝑡</ci></apply><ci id="S3.E2.m1.1.1.1.1.3.4.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.4.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">r_{t}=r^{e}+r_{t}^{\text{MineCLIP}}+\alpha r_{t}^{i},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_r start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT + italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT MineCLIP end_POSTSUPERSCRIPT + italic_α italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS3.p1.4">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.4.m1.1"><semantics id="S3.SS2.SSS3.p1.4.m1.1a"><mi id="S3.SS2.SSS3.p1.4.m1.1.1" xref="S3.SS2.SSS3.p1.4.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.4.m1.1b"><ci id="S3.SS2.SSS3.p1.4.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.4.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.4.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.4.m1.1d">italic_α</annotation></semantics></math> is a hyperparameter.
In contrast to the MineCLIP reward, which relies on the agent’s past performance, our affordance-driven intrinsic reward emphasizes long-term values derived from future virtual exploration.
It encourages the agent to adjust the policy to pursue task-related targets when they appear in its view, ensuring these targets are centrally positioned in future visual observations to maximize this reward function.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Long Short-Term World Model</h3>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Learning Jumping Flags</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.4">In LS-Imagine, the world model is customized for long-term and short-term state transitions. It decides which type of transition to adopt based on the current state and predicts the next state with the selected transition branch.
To facilitate the switch between long-term and short-term state transitions, we introduce a jumping flag <math alttext="j_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><msub id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml">j</mi><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2">𝑗</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">j_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which indicates whether a jumpy transition or long-term state transition, should be adopted at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">italic_t</annotation></semantics></math>.
When a distant task-related target appears in the agent’s observation, which can be reflected by a higher kurtosis in the affordance map, a jumpy transition allows the agent to imagine the future state of approaching the target.
To this end, we define relative kurtosis <math alttext="K_{r}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.3.m3.1"><semantics id="S3.SS3.SSS1.p1.3.m3.1a"><msub id="S3.SS3.SSS1.p1.3.m3.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.1.1.2" xref="S3.SS3.SSS1.p1.3.m3.1.1.2.cmml">K</mi><mi id="S3.SS3.SSS1.p1.3.m3.1.1.3" xref="S3.SS3.SSS1.p1.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.1b"><apply id="S3.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.2">𝐾</ci><ci id="S3.SS3.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.1c">K_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.3.m3.1d">italic_K start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> which measures whether there are significantly higher target areas than the surrounding areas in the affordance map, and absolute kurtosis <math alttext="K_{a}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.4.m4.1"><semantics id="S3.SS3.SSS1.p1.4.m4.1a"><msub id="S3.SS3.SSS1.p1.4.m4.1.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p1.4.m4.1.1.2" xref="S3.SS3.SSS1.p1.4.m4.1.1.2.cmml">K</mi><mi id="S3.SS3.SSS1.p1.4.m4.1.1.3" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m4.1b"><apply id="S3.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.2">𝐾</ci><ci id="S3.SS3.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m4.1c">K_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.4.m4.1d">italic_K start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> represents the confidence level of target presence in that area.
Formally,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle K_{r}" class="ltx_Math" display="inline" id="S3.E3X.2.1.1.m1.1"><semantics id="S3.E3X.2.1.1.m1.1a"><msub id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.2.cmml">K</mi><mi id="S3.E3X.2.1.1.m1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.1b"><apply id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.2">𝐾</ci><ci id="S3.E3X.2.1.1.m1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.1c">\displaystyle K_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.E3X.2.1.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{WH}\sum_{w=1}^{W}\sum_{h=1}^{H}\left[\left(\frac{%
\mathcal{M}_{o,I}(w,h)-\text{mean}(\mathcal{M}_{o,I})}{\text{std}(\mathcal{M}_%
{o,I})}\right)^{4}\right]," class="ltx_Math" display="inline" id="S3.E3X.3.2.2.m1.11"><semantics id="S3.E3X.3.2.2.m1.11a"><mrow id="S3.E3X.3.2.2.m1.11.11.1" xref="S3.E3X.3.2.2.m1.11.11.1.1.cmml"><mrow id="S3.E3X.3.2.2.m1.11.11.1.1" xref="S3.E3X.3.2.2.m1.11.11.1.1.cmml"><mi id="S3.E3X.3.2.2.m1.11.11.1.1.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.3.cmml"></mi><mo id="S3.E3X.3.2.2.m1.11.11.1.1.2" xref="S3.E3X.3.2.2.m1.11.11.1.1.2.cmml">=</mo><mrow id="S3.E3X.3.2.2.m1.11.11.1.1.1" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E3X.3.2.2.m1.11.11.1.1.1.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.cmml"><mfrac id="S3.E3X.3.2.2.m1.11.11.1.1.1.3a" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.cmml"><mn id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.2" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.2.cmml">1</mn><mrow id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.cmml"><mi id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.2" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.2.cmml">W</mi><mo id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.1" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.3.cmml">H</mi></mrow></mfrac></mstyle><mo id="S3.E3X.3.2.2.m1.11.11.1.1.1.2" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3X.3.2.2.m1.11.11.1.1.1.1" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.cmml"><munderover id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2a" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.cmml"><mo id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.2" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.2.cmml">w</mi><mo id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.1" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.3.cmml">W</mi></munderover></mstyle><mrow id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.cmml"><munderover id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2a" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.cmml"><mo id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.2" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.2.cmml">h</mi><mo id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.1" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.3.cmml">H</mi></munderover></mstyle><mrow id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.2.cmml"><mo id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.2.1.cmml">[</mo><msup id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.2.2" xref="S3.E3X.3.2.2.m1.10.10.cmml"><mo id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E3X.3.2.2.m1.10.10.cmml">(</mo><mstyle displaystyle="true" id="S3.E3X.3.2.2.m1.10.10" xref="S3.E3X.3.2.2.m1.10.10.cmml"><mfrac id="S3.E3X.3.2.2.m1.10.10a" xref="S3.E3X.3.2.2.m1.10.10.cmml"><mrow id="S3.E3X.3.2.2.m1.7.7.7" xref="S3.E3X.3.2.2.m1.7.7.7.cmml"><mrow id="S3.E3X.3.2.2.m1.7.7.7.9" xref="S3.E3X.3.2.2.m1.7.7.7.9.cmml"><msub id="S3.E3X.3.2.2.m1.7.7.7.9.2" xref="S3.E3X.3.2.2.m1.7.7.7.9.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3X.3.2.2.m1.7.7.7.9.2.2" xref="S3.E3X.3.2.2.m1.7.7.7.9.2.2.cmml">ℳ</mi><mrow id="S3.E3X.3.2.2.m1.2.2.2.2.2.4" xref="S3.E3X.3.2.2.m1.2.2.2.2.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.1.1.1.1.1.1.cmml">o</mi><mo id="S3.E3X.3.2.2.m1.2.2.2.2.2.4.1" xref="S3.E3X.3.2.2.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E3X.3.2.2.m1.2.2.2.2.2.2" xref="S3.E3X.3.2.2.m1.2.2.2.2.2.2.cmml">I</mi></mrow></msub><mo id="S3.E3X.3.2.2.m1.7.7.7.9.1" xref="S3.E3X.3.2.2.m1.7.7.7.9.1.cmml">⁢</mo><mrow id="S3.E3X.3.2.2.m1.7.7.7.9.3.2" xref="S3.E3X.3.2.2.m1.7.7.7.9.3.1.cmml"><mo id="S3.E3X.3.2.2.m1.7.7.7.9.3.2.1" stretchy="false" xref="S3.E3X.3.2.2.m1.7.7.7.9.3.1.cmml">(</mo><mi id="S3.E3X.3.2.2.m1.5.5.5.5" xref="S3.E3X.3.2.2.m1.5.5.5.5.cmml">w</mi><mo id="S3.E3X.3.2.2.m1.7.7.7.9.3.2.2" xref="S3.E3X.3.2.2.m1.7.7.7.9.3.1.cmml">,</mo><mi id="S3.E3X.3.2.2.m1.6.6.6.6" xref="S3.E3X.3.2.2.m1.6.6.6.6.cmml">h</mi><mo id="S3.E3X.3.2.2.m1.7.7.7.9.3.2.3" stretchy="false" xref="S3.E3X.3.2.2.m1.7.7.7.9.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3X.3.2.2.m1.7.7.7.8" xref="S3.E3X.3.2.2.m1.7.7.7.8.cmml">−</mo><mrow id="S3.E3X.3.2.2.m1.7.7.7.7" xref="S3.E3X.3.2.2.m1.7.7.7.7.cmml"><mtext id="S3.E3X.3.2.2.m1.7.7.7.7.3" xref="S3.E3X.3.2.2.m1.7.7.7.7.3a.cmml">mean</mtext><mo id="S3.E3X.3.2.2.m1.7.7.7.7.2" xref="S3.E3X.3.2.2.m1.7.7.7.7.2.cmml">⁢</mo><mrow id="S3.E3X.3.2.2.m1.7.7.7.7.1.1" xref="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1.cmml"><mo id="S3.E3X.3.2.2.m1.7.7.7.7.1.1.2" stretchy="false" xref="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1.cmml">(</mo><msub id="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1" xref="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1.2" xref="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1.2.cmml">ℳ</mi><mrow id="S3.E3X.3.2.2.m1.4.4.4.4.2.4" xref="S3.E3X.3.2.2.m1.4.4.4.4.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.3.3.3.3.1.1" xref="S3.E3X.3.2.2.m1.3.3.3.3.1.1.cmml">o</mi><mo id="S3.E3X.3.2.2.m1.4.4.4.4.2.4.1" xref="S3.E3X.3.2.2.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E3X.3.2.2.m1.4.4.4.4.2.2" xref="S3.E3X.3.2.2.m1.4.4.4.4.2.2.cmml">I</mi></mrow></msub><mo id="S3.E3X.3.2.2.m1.7.7.7.7.1.1.3" stretchy="false" xref="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E3X.3.2.2.m1.10.10.10" xref="S3.E3X.3.2.2.m1.10.10.10.cmml"><mtext id="S3.E3X.3.2.2.m1.10.10.10.5" xref="S3.E3X.3.2.2.m1.10.10.10.5a.cmml">std</mtext><mo id="S3.E3X.3.2.2.m1.10.10.10.4" xref="S3.E3X.3.2.2.m1.10.10.10.4.cmml">⁢</mo><mrow id="S3.E3X.3.2.2.m1.10.10.10.3.1" xref="S3.E3X.3.2.2.m1.10.10.10.3.1.1.cmml"><mo id="S3.E3X.3.2.2.m1.10.10.10.3.1.2" stretchy="false" xref="S3.E3X.3.2.2.m1.10.10.10.3.1.1.cmml">(</mo><msub id="S3.E3X.3.2.2.m1.10.10.10.3.1.1" xref="S3.E3X.3.2.2.m1.10.10.10.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3X.3.2.2.m1.10.10.10.3.1.1.2" xref="S3.E3X.3.2.2.m1.10.10.10.3.1.1.2.cmml">ℳ</mi><mrow id="S3.E3X.3.2.2.m1.9.9.9.2.2.4" xref="S3.E3X.3.2.2.m1.9.9.9.2.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.8.8.8.1.1.1" xref="S3.E3X.3.2.2.m1.8.8.8.1.1.1.cmml">o</mi><mo id="S3.E3X.3.2.2.m1.9.9.9.2.2.4.1" xref="S3.E3X.3.2.2.m1.9.9.9.2.2.3.cmml">,</mo><mi id="S3.E3X.3.2.2.m1.9.9.9.2.2.2" xref="S3.E3X.3.2.2.m1.9.9.9.2.2.2.cmml">I</mi></mrow></msub><mo id="S3.E3X.3.2.2.m1.10.10.10.3.1.3" stretchy="false" xref="S3.E3X.3.2.2.m1.10.10.10.3.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E3X.3.2.2.m1.10.10.cmml">)</mo></mrow><mn id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.3.cmml">4</mn></msup><mo id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3X.3.2.2.m1.11.11.1.2" xref="S3.E3X.3.2.2.m1.11.11.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.3.2.2.m1.11b"><apply id="S3.E3X.3.2.2.m1.11.11.1.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1"><eq id="S3.E3X.3.2.2.m1.11.11.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.2"></eq><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.11.11.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.3">absent</csymbol><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1"><times id="S3.E3X.3.2.2.m1.11.11.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.2"></times><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3"><divide id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3"></divide><cn id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.2.cmml" type="integer" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.2">1</cn><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3"><times id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.1"></times><ci id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.2">𝑊</ci><ci id="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.3.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.3.3.3">𝐻</ci></apply></apply><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1"><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2">superscript</csymbol><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2">subscript</csymbol><sum id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.2"></sum><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3"><eq id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.1"></eq><ci id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.2">𝑤</ci><cn id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.2.3">𝑊</ci></apply><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1"><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.2"></sum><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3"><eq id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.2">ℎ</ci><cn id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.2.3">𝐻</ci></apply><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3X.3.2.2.m1.10.10.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.2.2"><divide id="S3.E3X.3.2.2.m1.10.10.11.cmml" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.2.2"></divide><apply id="S3.E3X.3.2.2.m1.7.7.7.cmml" xref="S3.E3X.3.2.2.m1.7.7.7"><minus id="S3.E3X.3.2.2.m1.7.7.7.8.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.8"></minus><apply id="S3.E3X.3.2.2.m1.7.7.7.9.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.9"><times id="S3.E3X.3.2.2.m1.7.7.7.9.1.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.9.1"></times><apply id="S3.E3X.3.2.2.m1.7.7.7.9.2.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.9.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.7.7.7.9.2.1.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.9.2">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.7.7.7.9.2.2.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.9.2.2">ℳ</ci><list id="S3.E3X.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.2.4"><ci id="S3.E3X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1.1.1">𝑜</ci><ci id="S3.E3X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.2.2">𝐼</ci></list></apply><interval closure="open" id="S3.E3X.3.2.2.m1.7.7.7.9.3.1.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.9.3.2"><ci id="S3.E3X.3.2.2.m1.5.5.5.5.cmml" xref="S3.E3X.3.2.2.m1.5.5.5.5">𝑤</ci><ci id="S3.E3X.3.2.2.m1.6.6.6.6.cmml" xref="S3.E3X.3.2.2.m1.6.6.6.6">ℎ</ci></interval></apply><apply id="S3.E3X.3.2.2.m1.7.7.7.7.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.7"><times id="S3.E3X.3.2.2.m1.7.7.7.7.2.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.7.2"></times><ci id="S3.E3X.3.2.2.m1.7.7.7.7.3a.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.7.3"><mtext id="S3.E3X.3.2.2.m1.7.7.7.7.3.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.7.3">mean</mtext></ci><apply id="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.7.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.7.1.1">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.7.7.7.7.1.1.1.2">ℳ</ci><list id="S3.E3X.3.2.2.m1.4.4.4.4.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.4.2.4"><ci id="S3.E3X.3.2.2.m1.3.3.3.3.1.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.3.3.1.1">𝑜</ci><ci id="S3.E3X.3.2.2.m1.4.4.4.4.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.4.2.2">𝐼</ci></list></apply></apply></apply><apply id="S3.E3X.3.2.2.m1.10.10.10.cmml" xref="S3.E3X.3.2.2.m1.10.10.10"><times id="S3.E3X.3.2.2.m1.10.10.10.4.cmml" xref="S3.E3X.3.2.2.m1.10.10.10.4"></times><ci id="S3.E3X.3.2.2.m1.10.10.10.5a.cmml" xref="S3.E3X.3.2.2.m1.10.10.10.5"><mtext id="S3.E3X.3.2.2.m1.10.10.10.5.cmml" xref="S3.E3X.3.2.2.m1.10.10.10.5">std</mtext></ci><apply id="S3.E3X.3.2.2.m1.10.10.10.3.1.1.cmml" xref="S3.E3X.3.2.2.m1.10.10.10.3.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.10.10.10.3.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.10.10.10.3.1">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.10.10.10.3.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.10.10.10.3.1.1.2">ℳ</ci><list id="S3.E3X.3.2.2.m1.9.9.9.2.2.3.cmml" xref="S3.E3X.3.2.2.m1.9.9.9.2.2.4"><ci id="S3.E3X.3.2.2.m1.8.8.8.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.8.8.8.1.1.1">𝑜</ci><ci id="S3.E3X.3.2.2.m1.9.9.9.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.9.9.9.2.2.2">𝐼</ci></list></apply></apply></apply><cn id="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3X.3.2.2.m1.11.11.1.1.1.1.1.1.1.1.3">4</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.3.2.2.m1.11c">\displaystyle=\frac{1}{WH}\sum_{w=1}^{W}\sum_{h=1}^{H}\left[\left(\frac{%
\mathcal{M}_{o,I}(w,h)-\text{mean}(\mathcal{M}_{o,I})}{\text{std}(\mathcal{M}_%
{o,I})}\right)^{4}\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E3X.3.2.2.m1.11d">= divide start_ARG 1 end_ARG start_ARG italic_W italic_H end_ARG ∑ start_POSTSUBSCRIPT italic_w = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_W end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_h = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT [ ( divide start_ARG caligraphic_M start_POSTSUBSCRIPT italic_o , italic_I end_POSTSUBSCRIPT ( italic_w , italic_h ) - mean ( caligraphic_M start_POSTSUBSCRIPT italic_o , italic_I end_POSTSUBSCRIPT ) end_ARG start_ARG std ( caligraphic_M start_POSTSUBSCRIPT italic_o , italic_I end_POSTSUBSCRIPT ) end_ARG ) start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle K_{a}" class="ltx_Math" display="inline" id="S3.E3Xa.2.1.1.m1.1"><semantics id="S3.E3Xa.2.1.1.m1.1a"><msub id="S3.E3Xa.2.1.1.m1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.2" xref="S3.E3Xa.2.1.1.m1.1.1.2.cmml">K</mi><mi id="S3.E3Xa.2.1.1.m1.1.1.3" xref="S3.E3Xa.2.1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.1b"><apply id="S3.E3Xa.2.1.1.m1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.2">𝐾</ci><ci id="S3.E3Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.1c">\displaystyle K_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.E3Xa.2.1.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{max}(\mathcal{M}_{o,I})-\text{mean}(\mathcal{M}_{o,I})." class="ltx_Math" display="inline" id="S3.E3Xa.3.2.2.m1.5"><semantics id="S3.E3Xa.3.2.2.m1.5a"><mrow id="S3.E3Xa.3.2.2.m1.5.5.1" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.cmml"><mrow id="S3.E3Xa.3.2.2.m1.5.5.1.1" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.cmml"><mi id="S3.E3Xa.3.2.2.m1.5.5.1.1.4" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.4.cmml"></mi><mo id="S3.E3Xa.3.2.2.m1.5.5.1.1.3" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E3Xa.3.2.2.m1.5.5.1.1.2" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.cmml"><mrow id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.cmml"><mtext id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.3" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.3a.cmml">max</mtext><mo id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.2" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.cmml">ℳ</mi><mrow id="S3.E3Xa.3.2.2.m1.2.2.2.4" xref="S3.E3Xa.3.2.2.m1.2.2.2.3.cmml"><mi id="S3.E3Xa.3.2.2.m1.1.1.1.1" xref="S3.E3Xa.3.2.2.m1.1.1.1.1.cmml">o</mi><mo id="S3.E3Xa.3.2.2.m1.2.2.2.4.1" xref="S3.E3Xa.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3Xa.3.2.2.m1.2.2.2.2" xref="S3.E3Xa.3.2.2.m1.2.2.2.2.cmml">I</mi></mrow></msub><mo id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.3" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.3.cmml">−</mo><mrow id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.cmml"><mtext id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.3" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.3a.cmml">mean</mtext><mo id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.2" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.2.cmml">⁢</mo><mrow id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1.cmml"><mo id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.2" stretchy="false" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1.cmml">(</mo><msub id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1.2" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1.2.cmml">ℳ</mi><mrow id="S3.E3Xa.3.2.2.m1.4.4.2.4" xref="S3.E3Xa.3.2.2.m1.4.4.2.3.cmml"><mi id="S3.E3Xa.3.2.2.m1.3.3.1.1" xref="S3.E3Xa.3.2.2.m1.3.3.1.1.cmml">o</mi><mo id="S3.E3Xa.3.2.2.m1.4.4.2.4.1" xref="S3.E3Xa.3.2.2.m1.4.4.2.3.cmml">,</mo><mi id="S3.E3Xa.3.2.2.m1.4.4.2.2" xref="S3.E3Xa.3.2.2.m1.4.4.2.2.cmml">I</mi></mrow></msub><mo id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.3" stretchy="false" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3Xa.3.2.2.m1.5.5.1.2" lspace="0em" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.3.2.2.m1.5b"><apply id="S3.E3Xa.3.2.2.m1.5.5.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1"><eq id="S3.E3Xa.3.2.2.m1.5.5.1.1.3.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.3"></eq><csymbol cd="latexml" id="S3.E3Xa.3.2.2.m1.5.5.1.1.4.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.4">absent</csymbol><apply id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2"><minus id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.3.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.3"></minus><apply id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1"><times id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.2"></times><ci id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.3a.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.3"><mtext id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.3.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.3">max</mtext></ci><apply id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.1.1.1.1.1.2">ℳ</ci><list id="S3.E3Xa.3.2.2.m1.2.2.2.3.cmml" xref="S3.E3Xa.3.2.2.m1.2.2.2.4"><ci id="S3.E3Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.1.1.1.1">𝑜</ci><ci id="S3.E3Xa.3.2.2.m1.2.2.2.2.cmml" xref="S3.E3Xa.3.2.2.m1.2.2.2.2">𝐼</ci></list></apply></apply><apply id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2"><times id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.2.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.2"></times><ci id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.3a.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.3"><mtext id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.3.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.3">mean</mtext></ci><apply id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1">subscript</csymbol><ci id="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1.2.cmml" xref="S3.E3Xa.3.2.2.m1.5.5.1.1.2.2.1.1.1.2">ℳ</ci><list id="S3.E3Xa.3.2.2.m1.4.4.2.3.cmml" xref="S3.E3Xa.3.2.2.m1.4.4.2.4"><ci id="S3.E3Xa.3.2.2.m1.3.3.1.1.cmml" xref="S3.E3Xa.3.2.2.m1.3.3.1.1">𝑜</ci><ci id="S3.E3Xa.3.2.2.m1.4.4.2.2.cmml" xref="S3.E3Xa.3.2.2.m1.4.4.2.2">𝐼</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.3.2.2.m1.5c">\displaystyle=\text{max}(\mathcal{M}_{o,I})-\text{mean}(\mathcal{M}_{o,I}).</annotation><annotation encoding="application/x-llamapun" id="S3.E3Xa.3.2.2.m1.5d">= max ( caligraphic_M start_POSTSUBSCRIPT italic_o , italic_I end_POSTSUBSCRIPT ) - mean ( caligraphic_M start_POSTSUBSCRIPT italic_o , italic_I end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS1.p1.7">To normalize the relative kurtosis, we apply the sigmoid function to it,
and then multiply it by the absolute kurtosis to calculate the jumping probability:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{\text{jump}}=\text{sigmoid}(K_{r})\times K_{a}." class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">P</mi><mtext id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3a.cmml">jump</mtext></msub><mo id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mtext id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3a.cmml">sigmoid</mtext><mo id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml">K</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.1.2" rspace="0.222em" xref="S3.E4.m1.1.1.1.1.1.2.cmml">×</mo><msub id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.3.2.cmml">K</mi><mi id="S3.E4.m1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.3.3.cmml">a</mi></msub></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" lspace="0em" xref="S3.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"></eq><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">𝑃</ci><ci id="S3.E4.m1.1.1.1.1.3.3a.cmml" xref="S3.E4.m1.1.1.1.1.3.3"><mtext id="S3.E4.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.3.3">jump</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.1.1.1.3a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3"><mtext id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">sigmoid</mtext></ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2">𝐾</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.3.2">𝐾</ci><ci id="S3.E4.m1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">P_{\text{jump}}=\text{sigmoid}(K_{r})\times K_{a}.</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">italic_P start_POSTSUBSCRIPT jump end_POSTSUBSCRIPT = sigmoid ( italic_K start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) × italic_K start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS1.p1.6">The jumping probability measures the confidence in the presence of task-relevant targets far from the agent in the visual observation.
To determine whether to employ long-term state transition, we use a dynamic threshold, which is the mean of the collected jumping probabilities at each time step, plus one standard deviation.
If <math alttext="P_{\text{jump}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.5.m1.1"><semantics id="S3.SS3.SSS1.p1.5.m1.1a"><msub id="S3.SS3.SSS1.p1.5.m1.1.1" xref="S3.SS3.SSS1.p1.5.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.5.m1.1.1.2" xref="S3.SS3.SSS1.p1.5.m1.1.1.2.cmml">P</mi><mtext id="S3.SS3.SSS1.p1.5.m1.1.1.3" xref="S3.SS3.SSS1.p1.5.m1.1.1.3a.cmml">jump</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.5.m1.1b"><apply id="S3.SS3.SSS1.p1.5.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.5.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.5.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.2">𝑃</ci><ci id="S3.SS3.SSS1.p1.5.m1.1.1.3a.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.3"><mtext id="S3.SS3.SSS1.p1.5.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.p1.5.m1.1.1.3">jump</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.5.m1.1c">P_{\text{jump}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.5.m1.1d">italic_P start_POSTSUBSCRIPT jump end_POSTSUBSCRIPT</annotation></semantics></math> exceeds this threshold, the jump flag <math alttext="j_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.6.m2.1"><semantics id="S3.SS3.SSS1.p1.6.m2.1a"><msub id="S3.SS3.SSS1.p1.6.m2.1.1" xref="S3.SS3.SSS1.p1.6.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p1.6.m2.1.1.2" xref="S3.SS3.SSS1.p1.6.m2.1.1.2.cmml">j</mi><mi id="S3.SS3.SSS1.p1.6.m2.1.1.3" xref="S3.SS3.SSS1.p1.6.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.6.m2.1b"><apply id="S3.SS3.SSS1.p1.6.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.6.m2.1.1.2">𝑗</ci><ci id="S3.SS3.SSS1.p1.6.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p1.6.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.6.m2.1c">j_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.6.m2.1d">italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is <span class="ltx_text ltx_font_typewriter" id="S3.SS3.SSS1.p1.6.1">True</span> and the agent switches to jumpy state transitions in the imagination phase.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Learning Jumpy State Transitions</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.F3" title="Figure 3 ‣ 3.3.2 Learning Jumpy State Transitions ‣ 3.3 Long Short-Term World Model ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">3</span></a> (a), the jumpy world model follows DreamerV3 <cite class="ltx_cite ltx_citemacro_citep">(Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib13" title="">2023</a>)</cite>, and the complete components of the jumpy world model can be written as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{aligned} &amp;\text{Short-term transition model:}&amp;\quad h_{t}&amp;=f_{\phi}(h_{%
t-1},z_{t-1},a_{t-1})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Long-term transition model:}&amp;\quad{h}_{t}^{\prime}&amp;=f_{\phi}(h_{t-1},z_%
{t-1})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Encoder:}&amp;\quad z_{t}&amp;\sim q_{\phi}(z_{t}\mid h_{t},o_{t},\mathcal{M}_{%
t})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Dynamics predictor:}&amp;\quad\hat{z}_{t}&amp;\sim p_{\phi}(\hat{z}_{t}\mid h_{%
t})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Reward predictor:}&amp;\quad\hat{r}_{t},\hat{c}_{t}&amp;\sim p_{\phi}(\hat{r}_{%
t},\hat{c}_{t}\mid h_{t},z_{t})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Decoder:}&amp;\quad\hat{o}_{t},\hat{\mathcal{M}}_{t}&amp;\sim p_{\phi}(\hat{o}_%
{t},\hat{\mathcal{M}}_{t}\mid h_{t},z_{t})\vphantom{\hat{\Delta}_{t}^{\prime}}%
\\
&amp;\text{Jump predictor:}&amp;\quad\hat{j}_{t}&amp;\sim p_{\phi}(\hat{j}_{t}\mid h_{t},z%
_{t})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Interval predictor:}&amp;\quad{\hat{\Delta}_{t}}^{\prime},{\hat{G}_{t}}^{%
\prime}&amp;\sim p_{\phi}({\hat{\Delta}_{t}}^{\prime},{\hat{G}_{t}}^{\prime}\mid h%
_{t-1},z_{t-1},{h}^{\prime}_{t},{z}^{\prime}_{t})\end{aligned}." class="ltx_Math" display="block" id="S3.E5.m1.20"><semantics id="S3.E5.m1.20a"><mrow id="S3.E5.m1.20.21.2" xref="S3.E5.m1.20.20.cmml"><mtable columnspacing="0pt" displaystyle="true" id="S3.E5.m1.20.20" rowspacing="0pt" xref="S3.E5.m1.20.20.cmml"><mtr id="S3.E5.m1.20.20a" xref="S3.E5.m1.20.20.cmml"><mtd id="S3.E5.m1.20.20b" xref="S3.E5.m1.20.20c.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20c" xref="S3.E5.m1.20.20.cmml"><mtext id="S3.E5.m1.3.3.3.5.1" xref="S3.E5.m1.3.3.3.5.1a.cmml">Short-term transition model:</mtext></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.20.20d" xref="S3.E5.m1.20.20.cmml"><msub id="S3.E5.m1.3.3.3.6.1" xref="S3.E5.m1.3.3.3.6.1.cmml"><mi id="S3.E5.m1.3.3.3.6.1.2" xref="S3.E5.m1.3.3.3.6.1.2.cmml">h</mi><mi id="S3.E5.m1.3.3.3.6.1.3" xref="S3.E5.m1.3.3.3.6.1.3.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20e" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.cmml"><mi id="S3.E5.m1.3.3.3.3.3.5" xref="S3.E5.m1.3.3.3.3.3.5.cmml"></mi><mo id="S3.E5.m1.3.3.3.3.3.4" xref="S3.E5.m1.3.3.3.3.3.4.cmml">=</mo><mrow id="S3.E5.m1.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.cmml"><msub id="S3.E5.m1.3.3.3.3.3.3.5" xref="S3.E5.m1.3.3.3.3.3.3.5.cmml"><mi id="S3.E5.m1.3.3.3.3.3.3.5.2" xref="S3.E5.m1.3.3.3.3.3.3.5.2.cmml">f</mi><mi id="S3.E5.m1.3.3.3.3.3.3.5.3" xref="S3.E5.m1.3.3.3.3.3.3.5.3.cmml">ϕ</mi></msub><mo id="S3.E5.m1.3.3.3.3.3.3.4" xref="S3.E5.m1.3.3.3.3.3.3.4.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.3.4.cmml"><mo id="S3.E5.m1.3.3.3.3.3.3.3.3.4" stretchy="false" xref="S3.E5.m1.3.3.3.3.3.3.3.4.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.3.3.3.3.3.3.3.3.5" xref="S3.E5.m1.3.3.3.3.3.3.3.4.cmml">,</mo><msub id="S3.E5.m1.2.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.2.cmml">z</mi><mrow id="S3.E5.m1.2.2.2.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.2" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.1" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.3" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.3.3.3.3.3.3.3.3.6" xref="S3.E5.m1.3.3.3.3.3.3.3.4.cmml">,</mo><msub id="S3.E5.m1.3.3.3.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.cmml"><mi id="S3.E5.m1.3.3.3.3.3.3.3.3.3.2" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.2.cmml">a</mi><mrow id="S3.E5.m1.3.3.3.3.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.cmml"><mi id="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.2" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.2.cmml">t</mi><mo id="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.1" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.1.cmml">−</mo><mn id="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.3.3.3.3.3.3.3.3.7" stretchy="false" xref="S3.E5.m1.3.3.3.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.20.20f" xref="S3.E5.m1.20.20.cmml"><mtd id="S3.E5.m1.20.20g" xref="S3.E5.m1.20.20c.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20h" xref="S3.E5.m1.20.20.cmml"><mtext id="S3.E5.m1.5.5.5.4.1" xref="S3.E5.m1.5.5.5.4.1a.cmml">Long-term transition model:</mtext></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.20.20i" xref="S3.E5.m1.20.20.cmml"><msubsup id="S3.E5.m1.5.5.5.5.1" xref="S3.E5.m1.5.5.5.5.1.cmml"><mi id="S3.E5.m1.5.5.5.5.1.2.2" xref="S3.E5.m1.5.5.5.5.1.2.2.cmml">h</mi><mi id="S3.E5.m1.5.5.5.5.1.2.3" xref="S3.E5.m1.5.5.5.5.1.2.3.cmml">t</mi><mo id="S3.E5.m1.5.5.5.5.1.3" xref="S3.E5.m1.5.5.5.5.1.3.cmml">′</mo></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20j" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.5.5.5.2.2" xref="S3.E5.m1.5.5.5.2.2.cmml"><mi id="S3.E5.m1.5.5.5.2.2.4" xref="S3.E5.m1.5.5.5.2.2.4.cmml"></mi><mo id="S3.E5.m1.5.5.5.2.2.3" xref="S3.E5.m1.5.5.5.2.2.3.cmml">=</mo><mrow id="S3.E5.m1.5.5.5.2.2.2" xref="S3.E5.m1.5.5.5.2.2.2.cmml"><msub id="S3.E5.m1.5.5.5.2.2.2.4" xref="S3.E5.m1.5.5.5.2.2.2.4.cmml"><mi id="S3.E5.m1.5.5.5.2.2.2.4.2" xref="S3.E5.m1.5.5.5.2.2.2.4.2.cmml">f</mi><mi id="S3.E5.m1.5.5.5.2.2.2.4.3" xref="S3.E5.m1.5.5.5.2.2.2.4.3.cmml">ϕ</mi></msub><mo id="S3.E5.m1.5.5.5.2.2.2.3" xref="S3.E5.m1.5.5.5.2.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.5.2.2.2.2.2" xref="S3.E5.m1.5.5.5.2.2.2.2.3.cmml"><mo id="S3.E5.m1.5.5.5.2.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.5.5.5.2.2.2.2.3.cmml">(</mo><msub id="S3.E5.m1.4.4.4.1.1.1.1.1.1" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.4.4.4.1.1.1.1.1.1.2" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.2.cmml">h</mi><mrow id="S3.E5.m1.4.4.4.1.1.1.1.1.1.3" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.2" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.1" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.3" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.5.5.5.2.2.2.2.2.4" xref="S3.E5.m1.5.5.5.2.2.2.2.3.cmml">,</mo><msub id="S3.E5.m1.5.5.5.2.2.2.2.2.2" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.cmml"><mi id="S3.E5.m1.5.5.5.2.2.2.2.2.2.2" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.2.cmml">z</mi><mrow id="S3.E5.m1.5.5.5.2.2.2.2.2.2.3" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.2" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.1" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.3" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.5.5.5.2.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.5.5.5.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.20.20k" xref="S3.E5.m1.20.20.cmml"><mtd id="S3.E5.m1.20.20l" xref="S3.E5.m1.20.20c.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20m" xref="S3.E5.m1.20.20.cmml"><mtext id="S3.E5.m1.6.6.6.3.1" xref="S3.E5.m1.6.6.6.3.1a.cmml">Encoder:</mtext></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.20.20n" xref="S3.E5.m1.20.20.cmml"><msub id="S3.E5.m1.6.6.6.4.1" xref="S3.E5.m1.6.6.6.4.1.cmml"><mi id="S3.E5.m1.6.6.6.4.1.2" xref="S3.E5.m1.6.6.6.4.1.2.cmml">z</mi><mi id="S3.E5.m1.6.6.6.4.1.3" xref="S3.E5.m1.6.6.6.4.1.3.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20o" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.6.6.6.1.1" xref="S3.E5.m1.6.6.6.1.1.cmml"><mi id="S3.E5.m1.6.6.6.1.1.3" xref="S3.E5.m1.6.6.6.1.1.3.cmml"></mi><mo id="S3.E5.m1.6.6.6.1.1.2" xref="S3.E5.m1.6.6.6.1.1.2.cmml">∼</mo><mrow id="S3.E5.m1.6.6.6.1.1.1" xref="S3.E5.m1.6.6.6.1.1.1.cmml"><msub id="S3.E5.m1.6.6.6.1.1.1.3" xref="S3.E5.m1.6.6.6.1.1.1.3.cmml"><mi id="S3.E5.m1.6.6.6.1.1.1.3.2" xref="S3.E5.m1.6.6.6.1.1.1.3.2.cmml">q</mi><mi id="S3.E5.m1.6.6.6.1.1.1.3.3" xref="S3.E5.m1.6.6.6.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.E5.m1.6.6.6.1.1.1.2" xref="S3.E5.m1.6.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.6.6.6.1.1.1.1.1" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.6.6.6.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.6.6.6.1.1.1.1.1.1" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.6.6.6.1.1.1.1.1.1.5" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.cmml"><mi id="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.2" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.2.cmml">z</mi><mi id="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.3" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.3.cmml">t</mi></msub><mo id="S3.E5.m1.6.6.6.1.1.1.1.1.1.4" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.4.cmml">∣</mo><mrow id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.4.cmml"><msub id="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.4" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.2" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.2.cmml">o</mi><mi id="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.3" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.5" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.2" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.2.cmml">ℳ</mi><mi id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E5.m1.6.6.6.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.20.20p" xref="S3.E5.m1.20.20.cmml"><mtd id="S3.E5.m1.20.20q" xref="S3.E5.m1.20.20c.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20r" xref="S3.E5.m1.20.20.cmml"><mtext id="S3.E5.m1.7.7.7.3.1" xref="S3.E5.m1.7.7.7.3.1a.cmml">Dynamics predictor:</mtext></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.20.20s" xref="S3.E5.m1.20.20.cmml"><msub id="S3.E5.m1.7.7.7.4.1" xref="S3.E5.m1.7.7.7.4.1.cmml"><mover accent="true" id="S3.E5.m1.7.7.7.4.1.2" xref="S3.E5.m1.7.7.7.4.1.2.cmml"><mi id="S3.E5.m1.7.7.7.4.1.2.2" xref="S3.E5.m1.7.7.7.4.1.2.2.cmml">z</mi><mo id="S3.E5.m1.7.7.7.4.1.2.1" xref="S3.E5.m1.7.7.7.4.1.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.7.7.7.4.1.3" xref="S3.E5.m1.7.7.7.4.1.3.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20t" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.7.7.7.1.1" xref="S3.E5.m1.7.7.7.1.1.cmml"><mi id="S3.E5.m1.7.7.7.1.1.3" xref="S3.E5.m1.7.7.7.1.1.3.cmml"></mi><mo id="S3.E5.m1.7.7.7.1.1.2" xref="S3.E5.m1.7.7.7.1.1.2.cmml">∼</mo><mrow id="S3.E5.m1.7.7.7.1.1.1" xref="S3.E5.m1.7.7.7.1.1.1.cmml"><msub id="S3.E5.m1.7.7.7.1.1.1.3" xref="S3.E5.m1.7.7.7.1.1.1.3.cmml"><mi id="S3.E5.m1.7.7.7.1.1.1.3.2" xref="S3.E5.m1.7.7.7.1.1.1.3.2.cmml">p</mi><mi id="S3.E5.m1.7.7.7.1.1.1.3.3" xref="S3.E5.m1.7.7.7.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.E5.m1.7.7.7.1.1.1.2" xref="S3.E5.m1.7.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.7.7.7.1.1.1.1.1" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.7.7.7.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.7.7.7.1.1.1.1.1.1" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2.2.cmml">z</mi><mo id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2.1" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.3" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E5.m1.7.7.7.1.1.1.1.1.1.1" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S3.E5.m1.7.7.7.1.1.1.1.1.1.3" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.2" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.3" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E5.m1.7.7.7.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.20.20u" xref="S3.E5.m1.20.20.cmml"><mtd id="S3.E5.m1.20.20v" xref="S3.E5.m1.20.20c.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20w" xref="S3.E5.m1.20.20.cmml"><mtext id="S3.E5.m1.11.11.11.6.1" xref="S3.E5.m1.11.11.11.6.1a.cmml">Reward predictor:</mtext></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.20.20x" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.9.9.9.2.2.2" xref="S3.E5.m1.9.9.9.2.2.3.cmml"><msub id="S3.E5.m1.8.8.8.1.1.1.1" xref="S3.E5.m1.8.8.8.1.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.8.8.8.1.1.1.1.2" xref="S3.E5.m1.8.8.8.1.1.1.1.2.cmml"><mi id="S3.E5.m1.8.8.8.1.1.1.1.2.2" xref="S3.E5.m1.8.8.8.1.1.1.1.2.2.cmml">r</mi><mo id="S3.E5.m1.8.8.8.1.1.1.1.2.1" xref="S3.E5.m1.8.8.8.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.8.8.8.1.1.1.1.3" xref="S3.E5.m1.8.8.8.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.9.9.9.2.2.2.3" xref="S3.E5.m1.9.9.9.2.2.3.cmml">,</mo><msub id="S3.E5.m1.9.9.9.2.2.2.2" xref="S3.E5.m1.9.9.9.2.2.2.2.cmml"><mover accent="true" id="S3.E5.m1.9.9.9.2.2.2.2.2" xref="S3.E5.m1.9.9.9.2.2.2.2.2.cmml"><mi id="S3.E5.m1.9.9.9.2.2.2.2.2.2" xref="S3.E5.m1.9.9.9.2.2.2.2.2.2.cmml">c</mi><mo id="S3.E5.m1.9.9.9.2.2.2.2.2.1" xref="S3.E5.m1.9.9.9.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.9.9.9.2.2.2.2.3" xref="S3.E5.m1.9.9.9.2.2.2.2.3.cmml">t</mi></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20y" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.11.11.11.4.2" xref="S3.E5.m1.11.11.11.4.2.cmml"><mi id="S3.E5.m1.11.11.11.4.2.4" xref="S3.E5.m1.11.11.11.4.2.4.cmml"></mi><mo id="S3.E5.m1.11.11.11.4.2.3" xref="S3.E5.m1.11.11.11.4.2.3.cmml">∼</mo><mrow id="S3.E5.m1.11.11.11.4.2.2" xref="S3.E5.m1.11.11.11.4.2.2.cmml"><msub id="S3.E5.m1.11.11.11.4.2.2.4" xref="S3.E5.m1.11.11.11.4.2.2.4.cmml"><mi id="S3.E5.m1.11.11.11.4.2.2.4.2" xref="S3.E5.m1.11.11.11.4.2.2.4.2.cmml">p</mi><mi id="S3.E5.m1.11.11.11.4.2.2.4.3" xref="S3.E5.m1.11.11.11.4.2.2.4.3.cmml">ϕ</mi></msub><mo id="S3.E5.m1.11.11.11.4.2.2.3" xref="S3.E5.m1.11.11.11.4.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.11.11.11.4.2.2.2.2" xref="S3.E5.m1.11.11.11.4.2.2.2.3.cmml"><mo id="S3.E5.m1.11.11.11.4.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.11.11.11.4.2.2.2.3.cmml">(</mo><msub id="S3.E5.m1.10.10.10.3.1.1.1.1.1" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.10.10.10.3.1.1.1.1.1.2" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.10.10.10.3.1.1.1.1.1.2.2" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1.2.2.cmml">r</mi><mo id="S3.E5.m1.10.10.10.3.1.1.1.1.1.2.1" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.10.10.10.3.1.1.1.1.1.3" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.11.11.11.4.2.2.2.2.4" xref="S3.E5.m1.11.11.11.4.2.2.2.3.cmml">,</mo><mrow id="S3.E5.m1.11.11.11.4.2.2.2.2.2" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.cmml"><msub id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.cmml"><mover accent="true" id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2.cmml"><mi id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2.2" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2.2.cmml">c</mi><mo id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2.1" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.3" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.3.cmml">t</mi></msub><mo id="S3.E5.m1.11.11.11.4.2.2.2.2.2.3" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.3.cmml">∣</mo><mrow id="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.3.cmml"><msub id="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.2" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.2.cmml">h</mi><mi id="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.3" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.3" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.2" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.3" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E5.m1.11.11.11.4.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.11.11.11.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.20.20z" xref="S3.E5.m1.20.20.cmml"><mtd id="S3.E5.m1.20.20aa" xref="S3.E5.m1.20.20c.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20ab" xref="S3.E5.m1.20.20.cmml"><mtext id="S3.E5.m1.15.15.15.6.1" xref="S3.E5.m1.15.15.15.6.1a.cmml">Decoder:</mtext></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.20.20ac" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.13.13.13.2.2.2" xref="S3.E5.m1.13.13.13.2.2.3.cmml"><msub id="S3.E5.m1.12.12.12.1.1.1.1" xref="S3.E5.m1.12.12.12.1.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.12.12.12.1.1.1.1.2" xref="S3.E5.m1.12.12.12.1.1.1.1.2.cmml"><mi id="S3.E5.m1.12.12.12.1.1.1.1.2.2" xref="S3.E5.m1.12.12.12.1.1.1.1.2.2.cmml">o</mi><mo id="S3.E5.m1.12.12.12.1.1.1.1.2.1" xref="S3.E5.m1.12.12.12.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.12.12.12.1.1.1.1.3" xref="S3.E5.m1.12.12.12.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.13.13.13.2.2.2.3" xref="S3.E5.m1.13.13.13.2.2.3.cmml">,</mo><msub id="S3.E5.m1.13.13.13.2.2.2.2" xref="S3.E5.m1.13.13.13.2.2.2.2.cmml"><mover accent="true" id="S3.E5.m1.13.13.13.2.2.2.2.2" xref="S3.E5.m1.13.13.13.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.13.13.13.2.2.2.2.2.2" xref="S3.E5.m1.13.13.13.2.2.2.2.2.2.cmml">ℳ</mi><mo id="S3.E5.m1.13.13.13.2.2.2.2.2.1" xref="S3.E5.m1.13.13.13.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.13.13.13.2.2.2.2.3" xref="S3.E5.m1.13.13.13.2.2.2.2.3.cmml">t</mi></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20ad" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.15.15.15.4.2" xref="S3.E5.m1.15.15.15.4.2.cmml"><mi id="S3.E5.m1.15.15.15.4.2.4" xref="S3.E5.m1.15.15.15.4.2.4.cmml"></mi><mo id="S3.E5.m1.15.15.15.4.2.3" xref="S3.E5.m1.15.15.15.4.2.3.cmml">∼</mo><mrow id="S3.E5.m1.15.15.15.4.2.2" xref="S3.E5.m1.15.15.15.4.2.2.cmml"><msub id="S3.E5.m1.15.15.15.4.2.2.4" xref="S3.E5.m1.15.15.15.4.2.2.4.cmml"><mi id="S3.E5.m1.15.15.15.4.2.2.4.2" xref="S3.E5.m1.15.15.15.4.2.2.4.2.cmml">p</mi><mi id="S3.E5.m1.15.15.15.4.2.2.4.3" xref="S3.E5.m1.15.15.15.4.2.2.4.3.cmml">ϕ</mi></msub><mo id="S3.E5.m1.15.15.15.4.2.2.3" xref="S3.E5.m1.15.15.15.4.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.15.15.15.4.2.2.2.2" xref="S3.E5.m1.15.15.15.4.2.2.2.3.cmml"><mo id="S3.E5.m1.15.15.15.4.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.15.15.15.4.2.2.2.3.cmml">(</mo><msub id="S3.E5.m1.14.14.14.3.1.1.1.1.1" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.14.14.14.3.1.1.1.1.1.2" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.14.14.14.3.1.1.1.1.1.2.2" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1.2.2.cmml">o</mi><mo id="S3.E5.m1.14.14.14.3.1.1.1.1.1.2.1" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.14.14.14.3.1.1.1.1.1.3" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.15.15.15.4.2.2.2.2.4" xref="S3.E5.m1.15.15.15.4.2.2.2.3.cmml">,</mo><mrow id="S3.E5.m1.15.15.15.4.2.2.2.2.2" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.cmml"><msub id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.cmml"><mover accent="true" id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2.2" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2.2.cmml">ℳ</mi><mo id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2.1" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.3" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.3.cmml">t</mi></msub><mo id="S3.E5.m1.15.15.15.4.2.2.2.2.2.3" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.3.cmml">∣</mo><mrow id="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.3.cmml"><msub id="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.2" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.2.cmml">h</mi><mi id="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.3" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.3" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.2" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.3" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E5.m1.15.15.15.4.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.15.15.15.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.20.20ae" xref="S3.E5.m1.20.20.cmml"><mtd id="S3.E5.m1.20.20af" xref="S3.E5.m1.20.20c.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20ag" xref="S3.E5.m1.20.20.cmml"><mtext id="S3.E5.m1.16.16.16.3.1" xref="S3.E5.m1.16.16.16.3.1a.cmml">Jump predictor:</mtext></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.20.20ah" xref="S3.E5.m1.20.20.cmml"><msub id="S3.E5.m1.16.16.16.4.1" xref="S3.E5.m1.16.16.16.4.1.cmml"><mover accent="true" id="S3.E5.m1.16.16.16.4.1.2" xref="S3.E5.m1.16.16.16.4.1.2.cmml"><mi id="S3.E5.m1.16.16.16.4.1.2.2" xref="S3.E5.m1.16.16.16.4.1.2.2.cmml">j</mi><mo id="S3.E5.m1.16.16.16.4.1.2.1" xref="S3.E5.m1.16.16.16.4.1.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.16.16.16.4.1.3" xref="S3.E5.m1.16.16.16.4.1.3.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20ai" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.16.16.16.1.1" xref="S3.E5.m1.16.16.16.1.1.cmml"><mi id="S3.E5.m1.16.16.16.1.1.3" xref="S3.E5.m1.16.16.16.1.1.3.cmml"></mi><mo id="S3.E5.m1.16.16.16.1.1.2" xref="S3.E5.m1.16.16.16.1.1.2.cmml">∼</mo><mrow id="S3.E5.m1.16.16.16.1.1.1" xref="S3.E5.m1.16.16.16.1.1.1.cmml"><msub id="S3.E5.m1.16.16.16.1.1.1.3" xref="S3.E5.m1.16.16.16.1.1.1.3.cmml"><mi id="S3.E5.m1.16.16.16.1.1.1.3.2" xref="S3.E5.m1.16.16.16.1.1.1.3.2.cmml">p</mi><mi id="S3.E5.m1.16.16.16.1.1.1.3.3" xref="S3.E5.m1.16.16.16.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.E5.m1.16.16.16.1.1.1.2" xref="S3.E5.m1.16.16.16.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.16.16.16.1.1.1.1.1" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.16.16.16.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.16.16.16.1.1.1.1.1.1" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2.2" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2.2.cmml">j</mi><mo id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2.1" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.3" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.E5.m1.16.16.16.1.1.1.1.1.1.3" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.2" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.2.cmml">z</mi><mi id="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.3" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E5.m1.16.16.16.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.20.20aj" xref="S3.E5.m1.20.20.cmml"><mtd id="S3.E5.m1.20.20ak" xref="S3.E5.m1.20.20c.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20al" xref="S3.E5.m1.20.20.cmml"><mtext id="S3.E5.m1.20.20.20.6.1" xref="S3.E5.m1.20.20.20.6.1a.cmml">Interval predictor:</mtext></mtd><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.20.20am" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.18.18.18.2.2.2" xref="S3.E5.m1.18.18.18.2.2.3.cmml"><mmultiscripts id="S3.E5.m1.17.17.17.1.1.1.1" xref="S3.E5.m1.17.17.17.1.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.17.17.17.1.1.1.1.2.2" xref="S3.E5.m1.17.17.17.1.1.1.1.2.2.cmml"><mi id="S3.E5.m1.17.17.17.1.1.1.1.2.2.2" mathvariant="normal" xref="S3.E5.m1.17.17.17.1.1.1.1.2.2.2.cmml">Δ</mi><mo id="S3.E5.m1.17.17.17.1.1.1.1.2.2.1" xref="S3.E5.m1.17.17.17.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.17.17.17.1.1.1.1.2.3" xref="S3.E5.m1.17.17.17.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.E5.m1.17.17.17.1.1.1.1a" xref="S3.E5.m1.17.17.17.1.1.1.1.cmml"></mrow><mrow id="S3.E5.m1.17.17.17.1.1.1.1b" xref="S3.E5.m1.17.17.17.1.1.1.1.cmml"></mrow><mo id="S3.E5.m1.17.17.17.1.1.1.1.3" xref="S3.E5.m1.17.17.17.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo id="S3.E5.m1.18.18.18.2.2.2.3" xref="S3.E5.m1.18.18.18.2.2.3.cmml">,</mo><mmultiscripts id="S3.E5.m1.18.18.18.2.2.2.2" xref="S3.E5.m1.18.18.18.2.2.2.2.cmml"><mover accent="true" id="S3.E5.m1.18.18.18.2.2.2.2.2.2" xref="S3.E5.m1.18.18.18.2.2.2.2.2.2.cmml"><mi id="S3.E5.m1.18.18.18.2.2.2.2.2.2.2" xref="S3.E5.m1.18.18.18.2.2.2.2.2.2.2.cmml">G</mi><mo id="S3.E5.m1.18.18.18.2.2.2.2.2.2.1" xref="S3.E5.m1.18.18.18.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.18.18.18.2.2.2.2.2.3" xref="S3.E5.m1.18.18.18.2.2.2.2.2.3.cmml">t</mi><mrow id="S3.E5.m1.18.18.18.2.2.2.2a" xref="S3.E5.m1.18.18.18.2.2.2.2.cmml"></mrow><mrow id="S3.E5.m1.18.18.18.2.2.2.2b" xref="S3.E5.m1.18.18.18.2.2.2.2.cmml"></mrow><mo id="S3.E5.m1.18.18.18.2.2.2.2.3" xref="S3.E5.m1.18.18.18.2.2.2.2.3.cmml">′</mo></mmultiscripts></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.20.20an" xref="S3.E5.m1.20.20.cmml"><mrow id="S3.E5.m1.20.20.20.4.2" xref="S3.E5.m1.20.20.20.4.2.cmml"><mi id="S3.E5.m1.20.20.20.4.2.4" xref="S3.E5.m1.20.20.20.4.2.4.cmml"></mi><mo id="S3.E5.m1.20.20.20.4.2.3" xref="S3.E5.m1.20.20.20.4.2.3.cmml">∼</mo><mrow id="S3.E5.m1.20.20.20.4.2.2" xref="S3.E5.m1.20.20.20.4.2.2.cmml"><msub id="S3.E5.m1.20.20.20.4.2.2.4" xref="S3.E5.m1.20.20.20.4.2.2.4.cmml"><mi id="S3.E5.m1.20.20.20.4.2.2.4.2" xref="S3.E5.m1.20.20.20.4.2.2.4.2.cmml">p</mi><mi id="S3.E5.m1.20.20.20.4.2.2.4.3" xref="S3.E5.m1.20.20.20.4.2.2.4.3.cmml">ϕ</mi></msub><mo id="S3.E5.m1.20.20.20.4.2.2.3" xref="S3.E5.m1.20.20.20.4.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.20.20.20.4.2.2.2.2" xref="S3.E5.m1.20.20.20.4.2.2.2.3.cmml"><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.20.20.20.4.2.2.2.3.cmml">(</mo><mmultiscripts id="S3.E5.m1.19.19.19.3.1.1.1.1.1" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2.cmml"><mi id="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2.2" mathvariant="normal" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2.2.cmml">Δ</mi><mo id="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2.1" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.3" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.E5.m1.19.19.19.3.1.1.1.1.1a" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.cmml"></mrow><mrow id="S3.E5.m1.19.19.19.3.1.1.1.1.1b" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.cmml"></mrow><mo id="S3.E5.m1.19.19.19.3.1.1.1.1.1.3" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.4" xref="S3.E5.m1.20.20.20.4.2.2.2.3.cmml">,</mo><mrow id="S3.E5.m1.20.20.20.4.2.2.2.2.2" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.cmml"><mmultiscripts id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.cmml"><mover accent="true" id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2.cmml"><mi id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2.2" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2.2.cmml">G</mi><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2.1" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.3.cmml">t</mi><mrow id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6a" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.cmml"></mrow><mrow id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6b" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.cmml"></mrow><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.3.cmml">′</mo></mmultiscripts><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.2.5" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.5.cmml">∣</mo><mrow id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.5.cmml"><msub id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.2" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.2.cmml">h</mi><mrow id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.2" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.2.cmml">t</mi><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.1" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.1.cmml">−</mo><mn id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.5" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.5.cmml">,</mo><msub id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.2" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.2.cmml">z</mi><mrow id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.2" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.1" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.6" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.5.cmml">,</mo><msubsup id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.cmml"><mi id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.2.2" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.2.2.cmml">h</mi><mi id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.3.cmml">t</mi><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.2.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.2.3.cmml">′</mo></msubsup><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.7" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.5.cmml">,</mo><msubsup id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.cmml"><mi id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.2.2" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.2.2.cmml">z</mi><mi id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.3.cmml">t</mi><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.2.3" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.2.3.cmml">′</mo></msubsup></mrow></mrow><mo id="S3.E5.m1.20.20.20.4.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.20.20.20.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><mo id="S3.E5.m1.20.21.2.1" lspace="0em" xref="S3.E5.m1.20.20.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.20b"><matrix id="S3.E5.m1.20.20.cmml" xref="S3.E5.m1.20.21.2"><matrixrow id="S3.E5.m1.20.20a.cmml" xref="S3.E5.m1.20.21.2"><cerror id="S3.E5.m1.20.20b.cmml" xref="S3.E5.m1.20.21.2"><csymbol cd="ambiguous" id="S3.E5.m1.20.20c.cmml" xref="S3.E5.m1.20.20b">missing-subexpression</csymbol></cerror><ci id="S3.E5.m1.3.3.3.5.1a.cmml" xref="S3.E5.m1.3.3.3.5.1"><mtext id="S3.E5.m1.3.3.3.5.1.cmml" xref="S3.E5.m1.3.3.3.5.1">Short-term transition model:</mtext></ci><apply id="S3.E5.m1.3.3.3.6.1.cmml" xref="S3.E5.m1.3.3.3.6.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.6.1.1.cmml" xref="S3.E5.m1.3.3.3.6.1">subscript</csymbol><ci id="S3.E5.m1.3.3.3.6.1.2.cmml" xref="S3.E5.m1.3.3.3.6.1.2">ℎ</ci><ci id="S3.E5.m1.3.3.3.6.1.3.cmml" xref="S3.E5.m1.3.3.3.6.1.3">𝑡</ci></apply><apply id="S3.E5.m1.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3"><eq id="S3.E5.m1.3.3.3.3.3.4.cmml" xref="S3.E5.m1.3.3.3.3.3.4"></eq><csymbol cd="latexml" id="S3.E5.m1.3.3.3.3.3.5.cmml" xref="S3.E5.m1.3.3.3.3.3.5">absent</csymbol><apply id="S3.E5.m1.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3"><times id="S3.E5.m1.3.3.3.3.3.3.4.cmml" xref="S3.E5.m1.3.3.3.3.3.3.4"></times><apply id="S3.E5.m1.3.3.3.3.3.3.5.cmml" xref="S3.E5.m1.3.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.3.3.5.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.5">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.5.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.5.2">𝑓</ci><ci id="S3.E5.m1.3.3.3.3.3.3.5.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3.5.3">italic-ϕ</ci></apply><vector id="S3.E5.m1.3.3.3.3.3.3.3.4.cmml" xref="S3.E5.m1.3.3.3.3.3.3.3.3"><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E5.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.2">𝑧</ci><apply id="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.3"><minus id="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.1"></minus><ci id="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.2">𝑡</ci><cn id="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.3.3.3.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.3.3.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.3.3.3.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.2">𝑎</ci><apply id="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.3"><minus id="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.1"></minus><ci id="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.2">𝑡</ci><cn id="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.3.cmml" type="integer" xref="S3.E5.m1.3.3.3.3.3.3.3.3.3.3.3">1</cn></apply></apply></vector></apply></apply></matrixrow><matrixrow id="S3.E5.m1.20.20d.cmml" xref="S3.E5.m1.20.21.2"><cerror id="S3.E5.m1.20.20e.cmml" xref="S3.E5.m1.20.21.2"><csymbol cd="ambiguous" id="S3.E5.m1.20.20f.cmml" xref="S3.E5.m1.20.20b">missing-subexpression</csymbol></cerror><ci id="S3.E5.m1.5.5.5.4.1a.cmml" xref="S3.E5.m1.5.5.5.4.1"><mtext id="S3.E5.m1.5.5.5.4.1.cmml" xref="S3.E5.m1.5.5.5.4.1">Long-term transition model:</mtext></ci><apply id="S3.E5.m1.5.5.5.5.1.cmml" xref="S3.E5.m1.5.5.5.5.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.5.5.1.1.cmml" xref="S3.E5.m1.5.5.5.5.1">superscript</csymbol><apply id="S3.E5.m1.5.5.5.5.1.2.cmml" xref="S3.E5.m1.5.5.5.5.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.5.5.1.2.1.cmml" xref="S3.E5.m1.5.5.5.5.1">subscript</csymbol><ci id="S3.E5.m1.5.5.5.5.1.2.2.cmml" xref="S3.E5.m1.5.5.5.5.1.2.2">ℎ</ci><ci id="S3.E5.m1.5.5.5.5.1.2.3.cmml" xref="S3.E5.m1.5.5.5.5.1.2.3">𝑡</ci></apply><ci id="S3.E5.m1.5.5.5.5.1.3.cmml" xref="S3.E5.m1.5.5.5.5.1.3">′</ci></apply><apply id="S3.E5.m1.5.5.5.2.2.cmml" xref="S3.E5.m1.5.5.5.2.2"><eq id="S3.E5.m1.5.5.5.2.2.3.cmml" xref="S3.E5.m1.5.5.5.2.2.3"></eq><csymbol cd="latexml" id="S3.E5.m1.5.5.5.2.2.4.cmml" xref="S3.E5.m1.5.5.5.2.2.4">absent</csymbol><apply id="S3.E5.m1.5.5.5.2.2.2.cmml" xref="S3.E5.m1.5.5.5.2.2.2"><times id="S3.E5.m1.5.5.5.2.2.2.3.cmml" xref="S3.E5.m1.5.5.5.2.2.2.3"></times><apply id="S3.E5.m1.5.5.5.2.2.2.4.cmml" xref="S3.E5.m1.5.5.5.2.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.5.2.2.2.4.1.cmml" xref="S3.E5.m1.5.5.5.2.2.2.4">subscript</csymbol><ci id="S3.E5.m1.5.5.5.2.2.2.4.2.cmml" xref="S3.E5.m1.5.5.5.2.2.2.4.2">𝑓</ci><ci id="S3.E5.m1.5.5.5.2.2.2.4.3.cmml" xref="S3.E5.m1.5.5.5.2.2.2.4.3">italic-ϕ</ci></apply><interval closure="open" id="S3.E5.m1.5.5.5.2.2.2.2.3.cmml" xref="S3.E5.m1.5.5.5.2.2.2.2.2"><apply id="S3.E5.m1.4.4.4.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.4.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.2">ℎ</ci><apply id="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.3"><minus id="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.1"></minus><ci id="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E5.m1.4.4.4.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E5.m1.5.5.5.2.2.2.2.2.2.cmml" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.5.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.5.5.5.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.2">𝑧</ci><apply id="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.3"><minus id="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.1"></minus><ci id="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.2">𝑡</ci><cn id="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.5.5.5.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></matrixrow><matrixrow id="S3.E5.m1.20.20g.cmml" xref="S3.E5.m1.20.21.2"><cerror id="S3.E5.m1.20.20h.cmml" xref="S3.E5.m1.20.21.2"><csymbol cd="ambiguous" id="S3.E5.m1.20.20i.cmml" xref="S3.E5.m1.20.20b">missing-subexpression</csymbol></cerror><ci id="S3.E5.m1.6.6.6.3.1a.cmml" xref="S3.E5.m1.6.6.6.3.1"><mtext id="S3.E5.m1.6.6.6.3.1.cmml" xref="S3.E5.m1.6.6.6.3.1">Encoder:</mtext></ci><apply id="S3.E5.m1.6.6.6.4.1.cmml" xref="S3.E5.m1.6.6.6.4.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.4.1.1.cmml" xref="S3.E5.m1.6.6.6.4.1">subscript</csymbol><ci id="S3.E5.m1.6.6.6.4.1.2.cmml" xref="S3.E5.m1.6.6.6.4.1.2">𝑧</ci><ci id="S3.E5.m1.6.6.6.4.1.3.cmml" xref="S3.E5.m1.6.6.6.4.1.3">𝑡</ci></apply><apply id="S3.E5.m1.6.6.6.1.1.cmml" xref="S3.E5.m1.6.6.6.1.1"><csymbol cd="latexml" id="S3.E5.m1.6.6.6.1.1.2.cmml" xref="S3.E5.m1.6.6.6.1.1.2">similar-to</csymbol><csymbol cd="latexml" id="S3.E5.m1.6.6.6.1.1.3.cmml" xref="S3.E5.m1.6.6.6.1.1.3">absent</csymbol><apply id="S3.E5.m1.6.6.6.1.1.1.cmml" xref="S3.E5.m1.6.6.6.1.1.1"><times id="S3.E5.m1.6.6.6.1.1.1.2.cmml" xref="S3.E5.m1.6.6.6.1.1.1.2"></times><apply id="S3.E5.m1.6.6.6.1.1.1.3.cmml" xref="S3.E5.m1.6.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.1.1.1.3.1.cmml" xref="S3.E5.m1.6.6.6.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.6.6.6.1.1.1.3.2.cmml" xref="S3.E5.m1.6.6.6.1.1.1.3.2">𝑞</ci><ci id="S3.E5.m1.6.6.6.1.1.1.3.3.cmml" xref="S3.E5.m1.6.6.6.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.E5.m1.6.6.6.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.6.6.6.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.4">conditional</csymbol><apply id="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.1.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.2.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.2">𝑧</ci><ci id="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.3.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.5.3">𝑡</ci></apply><list id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.4.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3"><apply id="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.2">𝑜</ci><ci id="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><apply id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.2">ℳ</ci><ci id="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.6.6.6.1.1.1.1.1.1.3.3.3.3">𝑡</ci></apply></list></apply></apply></apply></matrixrow><matrixrow id="S3.E5.m1.20.20j.cmml" xref="S3.E5.m1.20.21.2"><cerror id="S3.E5.m1.20.20k.cmml" xref="S3.E5.m1.20.21.2"><csymbol cd="ambiguous" id="S3.E5.m1.20.20l.cmml" xref="S3.E5.m1.20.20b">missing-subexpression</csymbol></cerror><ci id="S3.E5.m1.7.7.7.3.1a.cmml" xref="S3.E5.m1.7.7.7.3.1"><mtext id="S3.E5.m1.7.7.7.3.1.cmml" xref="S3.E5.m1.7.7.7.3.1">Dynamics predictor:</mtext></ci><apply id="S3.E5.m1.7.7.7.4.1.cmml" xref="S3.E5.m1.7.7.7.4.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.7.4.1.1.cmml" xref="S3.E5.m1.7.7.7.4.1">subscript</csymbol><apply id="S3.E5.m1.7.7.7.4.1.2.cmml" xref="S3.E5.m1.7.7.7.4.1.2"><ci id="S3.E5.m1.7.7.7.4.1.2.1.cmml" xref="S3.E5.m1.7.7.7.4.1.2.1">^</ci><ci id="S3.E5.m1.7.7.7.4.1.2.2.cmml" xref="S3.E5.m1.7.7.7.4.1.2.2">𝑧</ci></apply><ci id="S3.E5.m1.7.7.7.4.1.3.cmml" xref="S3.E5.m1.7.7.7.4.1.3">𝑡</ci></apply><apply id="S3.E5.m1.7.7.7.1.1.cmml" xref="S3.E5.m1.7.7.7.1.1"><csymbol cd="latexml" id="S3.E5.m1.7.7.7.1.1.2.cmml" xref="S3.E5.m1.7.7.7.1.1.2">similar-to</csymbol><csymbol cd="latexml" id="S3.E5.m1.7.7.7.1.1.3.cmml" xref="S3.E5.m1.7.7.7.1.1.3">absent</csymbol><apply id="S3.E5.m1.7.7.7.1.1.1.cmml" xref="S3.E5.m1.7.7.7.1.1.1"><times id="S3.E5.m1.7.7.7.1.1.1.2.cmml" xref="S3.E5.m1.7.7.7.1.1.1.2"></times><apply id="S3.E5.m1.7.7.7.1.1.1.3.cmml" xref="S3.E5.m1.7.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.7.1.1.1.3.1.cmml" xref="S3.E5.m1.7.7.7.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.7.7.7.1.1.1.3.2.cmml" xref="S3.E5.m1.7.7.7.1.1.1.3.2">𝑝</ci><ci id="S3.E5.m1.7.7.7.1.1.1.3.3.cmml" xref="S3.E5.m1.7.7.7.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.E5.m1.7.7.7.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.7.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2"><ci id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.2.2">𝑧</ci></apply><ci id="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.2">ℎ</ci><ci id="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.7.7.7.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></matrixrow><matrixrow id="S3.E5.m1.20.20m.cmml" xref="S3.E5.m1.20.21.2"><cerror id="S3.E5.m1.20.20n.cmml" xref="S3.E5.m1.20.21.2"><csymbol cd="ambiguous" id="S3.E5.m1.20.20o.cmml" xref="S3.E5.m1.20.20b">missing-subexpression</csymbol></cerror><ci id="S3.E5.m1.11.11.11.6.1a.cmml" xref="S3.E5.m1.11.11.11.6.1"><mtext id="S3.E5.m1.11.11.11.6.1.cmml" xref="S3.E5.m1.11.11.11.6.1">Reward predictor:</mtext></ci><list id="S3.E5.m1.9.9.9.2.2.3.cmml" xref="S3.E5.m1.9.9.9.2.2.2"><apply id="S3.E5.m1.8.8.8.1.1.1.1.cmml" xref="S3.E5.m1.8.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.1.1.1.1.1.cmml" xref="S3.E5.m1.8.8.8.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.8.8.8.1.1.1.1.2.cmml" xref="S3.E5.m1.8.8.8.1.1.1.1.2"><ci id="S3.E5.m1.8.8.8.1.1.1.1.2.1.cmml" xref="S3.E5.m1.8.8.8.1.1.1.1.2.1">^</ci><ci id="S3.E5.m1.8.8.8.1.1.1.1.2.2.cmml" xref="S3.E5.m1.8.8.8.1.1.1.1.2.2">𝑟</ci></apply><ci id="S3.E5.m1.8.8.8.1.1.1.1.3.cmml" xref="S3.E5.m1.8.8.8.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E5.m1.9.9.9.2.2.2.2.cmml" xref="S3.E5.m1.9.9.9.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.2.2.2.2.1.cmml" xref="S3.E5.m1.9.9.9.2.2.2.2">subscript</csymbol><apply id="S3.E5.m1.9.9.9.2.2.2.2.2.cmml" xref="S3.E5.m1.9.9.9.2.2.2.2.2"><ci id="S3.E5.m1.9.9.9.2.2.2.2.2.1.cmml" xref="S3.E5.m1.9.9.9.2.2.2.2.2.1">^</ci><ci id="S3.E5.m1.9.9.9.2.2.2.2.2.2.cmml" xref="S3.E5.m1.9.9.9.2.2.2.2.2.2">𝑐</ci></apply><ci id="S3.E5.m1.9.9.9.2.2.2.2.3.cmml" xref="S3.E5.m1.9.9.9.2.2.2.2.3">𝑡</ci></apply></list><apply id="S3.E5.m1.11.11.11.4.2.cmml" xref="S3.E5.m1.11.11.11.4.2"><csymbol cd="latexml" id="S3.E5.m1.11.11.11.4.2.3.cmml" xref="S3.E5.m1.11.11.11.4.2.3">similar-to</csymbol><csymbol cd="latexml" id="S3.E5.m1.11.11.11.4.2.4.cmml" xref="S3.E5.m1.11.11.11.4.2.4">absent</csymbol><apply id="S3.E5.m1.11.11.11.4.2.2.cmml" xref="S3.E5.m1.11.11.11.4.2.2"><times id="S3.E5.m1.11.11.11.4.2.2.3.cmml" xref="S3.E5.m1.11.11.11.4.2.2.3"></times><apply id="S3.E5.m1.11.11.11.4.2.2.4.cmml" xref="S3.E5.m1.11.11.11.4.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.11.4.2.2.4.1.cmml" xref="S3.E5.m1.11.11.11.4.2.2.4">subscript</csymbol><ci id="S3.E5.m1.11.11.11.4.2.2.4.2.cmml" xref="S3.E5.m1.11.11.11.4.2.2.4.2">𝑝</ci><ci id="S3.E5.m1.11.11.11.4.2.2.4.3.cmml" xref="S3.E5.m1.11.11.11.4.2.2.4.3">italic-ϕ</ci></apply><interval closure="open" id="S3.E5.m1.11.11.11.4.2.2.2.3.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2"><apply id="S3.E5.m1.10.10.10.3.1.1.1.1.1.cmml" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.10.10.10.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.10.10.10.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1.2"><ci id="S3.E5.m1.10.10.10.3.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1.2.1">^</ci><ci id="S3.E5.m1.10.10.10.3.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1.2.2">𝑟</ci></apply><ci id="S3.E5.m1.10.10.10.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.10.10.10.3.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E5.m1.11.11.11.4.2.2.2.2.2.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.11.11.11.4.2.2.2.2.2.3.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.3">conditional</csymbol><apply id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.1.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4">subscript</csymbol><apply id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2"><ci id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2.1.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2.1">^</ci><ci id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2.2.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.2.2">𝑐</ci></apply><ci id="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.3.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.4.3">𝑡</ci></apply><list id="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2"><apply id="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.2">ℎ</ci><ci id="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.2">𝑧</ci><ci id="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.11.11.11.4.2.2.2.2.2.2.2.2.3">𝑡</ci></apply></list></apply></interval></apply></apply></matrixrow><matrixrow id="S3.E5.m1.20.20p.cmml" xref="S3.E5.m1.20.21.2"><cerror id="S3.E5.m1.20.20q.cmml" xref="S3.E5.m1.20.21.2"><csymbol cd="ambiguous" id="S3.E5.m1.20.20r.cmml" xref="S3.E5.m1.20.20b">missing-subexpression</csymbol></cerror><ci id="S3.E5.m1.15.15.15.6.1a.cmml" xref="S3.E5.m1.15.15.15.6.1"><mtext id="S3.E5.m1.15.15.15.6.1.cmml" xref="S3.E5.m1.15.15.15.6.1">Decoder:</mtext></ci><list id="S3.E5.m1.13.13.13.2.2.3.cmml" xref="S3.E5.m1.13.13.13.2.2.2"><apply id="S3.E5.m1.12.12.12.1.1.1.1.cmml" xref="S3.E5.m1.12.12.12.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.12.1.1.1.1.1.cmml" xref="S3.E5.m1.12.12.12.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.12.12.12.1.1.1.1.2.cmml" xref="S3.E5.m1.12.12.12.1.1.1.1.2"><ci id="S3.E5.m1.12.12.12.1.1.1.1.2.1.cmml" xref="S3.E5.m1.12.12.12.1.1.1.1.2.1">^</ci><ci id="S3.E5.m1.12.12.12.1.1.1.1.2.2.cmml" xref="S3.E5.m1.12.12.12.1.1.1.1.2.2">𝑜</ci></apply><ci id="S3.E5.m1.12.12.12.1.1.1.1.3.cmml" xref="S3.E5.m1.12.12.12.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E5.m1.13.13.13.2.2.2.2.cmml" xref="S3.E5.m1.13.13.13.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.13.2.2.2.2.1.cmml" xref="S3.E5.m1.13.13.13.2.2.2.2">subscript</csymbol><apply id="S3.E5.m1.13.13.13.2.2.2.2.2.cmml" xref="S3.E5.m1.13.13.13.2.2.2.2.2"><ci id="S3.E5.m1.13.13.13.2.2.2.2.2.1.cmml" xref="S3.E5.m1.13.13.13.2.2.2.2.2.1">^</ci><ci id="S3.E5.m1.13.13.13.2.2.2.2.2.2.cmml" xref="S3.E5.m1.13.13.13.2.2.2.2.2.2">ℳ</ci></apply><ci id="S3.E5.m1.13.13.13.2.2.2.2.3.cmml" xref="S3.E5.m1.13.13.13.2.2.2.2.3">𝑡</ci></apply></list><apply id="S3.E5.m1.15.15.15.4.2.cmml" xref="S3.E5.m1.15.15.15.4.2"><csymbol cd="latexml" id="S3.E5.m1.15.15.15.4.2.3.cmml" xref="S3.E5.m1.15.15.15.4.2.3">similar-to</csymbol><csymbol cd="latexml" id="S3.E5.m1.15.15.15.4.2.4.cmml" xref="S3.E5.m1.15.15.15.4.2.4">absent</csymbol><apply id="S3.E5.m1.15.15.15.4.2.2.cmml" xref="S3.E5.m1.15.15.15.4.2.2"><times id="S3.E5.m1.15.15.15.4.2.2.3.cmml" xref="S3.E5.m1.15.15.15.4.2.2.3"></times><apply id="S3.E5.m1.15.15.15.4.2.2.4.cmml" xref="S3.E5.m1.15.15.15.4.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.15.15.15.4.2.2.4.1.cmml" xref="S3.E5.m1.15.15.15.4.2.2.4">subscript</csymbol><ci id="S3.E5.m1.15.15.15.4.2.2.4.2.cmml" xref="S3.E5.m1.15.15.15.4.2.2.4.2">𝑝</ci><ci id="S3.E5.m1.15.15.15.4.2.2.4.3.cmml" xref="S3.E5.m1.15.15.15.4.2.2.4.3">italic-ϕ</ci></apply><interval closure="open" id="S3.E5.m1.15.15.15.4.2.2.2.3.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2"><apply id="S3.E5.m1.14.14.14.3.1.1.1.1.1.cmml" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.14.14.14.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.14.14.14.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1.2"><ci id="S3.E5.m1.14.14.14.3.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1.2.1">^</ci><ci id="S3.E5.m1.14.14.14.3.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1.2.2">𝑜</ci></apply><ci id="S3.E5.m1.14.14.14.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.14.14.14.3.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E5.m1.15.15.15.4.2.2.2.2.2.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.15.15.15.4.2.2.2.2.2.3.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.3">conditional</csymbol><apply id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.1.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4">subscript</csymbol><apply id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2"><ci id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2.1.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2.1">^</ci><ci id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2.2.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.2.2">ℳ</ci></apply><ci id="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.3.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.4.3">𝑡</ci></apply><list id="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2"><apply id="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.2">ℎ</ci><ci id="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.2">𝑧</ci><ci id="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.15.15.15.4.2.2.2.2.2.2.2.2.3">𝑡</ci></apply></list></apply></interval></apply></apply></matrixrow><matrixrow id="S3.E5.m1.20.20s.cmml" xref="S3.E5.m1.20.21.2"><cerror id="S3.E5.m1.20.20t.cmml" xref="S3.E5.m1.20.21.2"><csymbol cd="ambiguous" id="S3.E5.m1.20.20u.cmml" xref="S3.E5.m1.20.20b">missing-subexpression</csymbol></cerror><ci id="S3.E5.m1.16.16.16.3.1a.cmml" xref="S3.E5.m1.16.16.16.3.1"><mtext id="S3.E5.m1.16.16.16.3.1.cmml" xref="S3.E5.m1.16.16.16.3.1">Jump predictor:</mtext></ci><apply id="S3.E5.m1.16.16.16.4.1.cmml" xref="S3.E5.m1.16.16.16.4.1"><csymbol cd="ambiguous" id="S3.E5.m1.16.16.16.4.1.1.cmml" xref="S3.E5.m1.16.16.16.4.1">subscript</csymbol><apply id="S3.E5.m1.16.16.16.4.1.2.cmml" xref="S3.E5.m1.16.16.16.4.1.2"><ci id="S3.E5.m1.16.16.16.4.1.2.1.cmml" xref="S3.E5.m1.16.16.16.4.1.2.1">^</ci><ci id="S3.E5.m1.16.16.16.4.1.2.2.cmml" xref="S3.E5.m1.16.16.16.4.1.2.2">𝑗</ci></apply><ci id="S3.E5.m1.16.16.16.4.1.3.cmml" xref="S3.E5.m1.16.16.16.4.1.3">𝑡</ci></apply><apply id="S3.E5.m1.16.16.16.1.1.cmml" xref="S3.E5.m1.16.16.16.1.1"><csymbol cd="latexml" id="S3.E5.m1.16.16.16.1.1.2.cmml" xref="S3.E5.m1.16.16.16.1.1.2">similar-to</csymbol><csymbol cd="latexml" id="S3.E5.m1.16.16.16.1.1.3.cmml" xref="S3.E5.m1.16.16.16.1.1.3">absent</csymbol><apply id="S3.E5.m1.16.16.16.1.1.1.cmml" xref="S3.E5.m1.16.16.16.1.1.1"><times id="S3.E5.m1.16.16.16.1.1.1.2.cmml" xref="S3.E5.m1.16.16.16.1.1.1.2"></times><apply id="S3.E5.m1.16.16.16.1.1.1.3.cmml" xref="S3.E5.m1.16.16.16.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.16.16.16.1.1.1.3.1.cmml" xref="S3.E5.m1.16.16.16.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.16.16.16.1.1.1.3.2.cmml" xref="S3.E5.m1.16.16.16.1.1.1.3.2">𝑝</ci><ci id="S3.E5.m1.16.16.16.1.1.1.3.3.cmml" xref="S3.E5.m1.16.16.16.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.E5.m1.16.16.16.1.1.1.1.1.1.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.16.16.16.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2"><ci id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2.1">^</ci><ci id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.2.2">𝑗</ci></apply><ci id="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2"><apply id="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.2">𝑧</ci><ci id="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.16.16.16.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply></matrixrow><matrixrow id="S3.E5.m1.20.20v.cmml" xref="S3.E5.m1.20.21.2"><cerror id="S3.E5.m1.20.20w.cmml" xref="S3.E5.m1.20.21.2"><csymbol cd="ambiguous" id="S3.E5.m1.20.20x.cmml" xref="S3.E5.m1.20.20b">missing-subexpression</csymbol></cerror><ci id="S3.E5.m1.20.20.20.6.1a.cmml" xref="S3.E5.m1.20.20.20.6.1"><mtext id="S3.E5.m1.20.20.20.6.1.cmml" xref="S3.E5.m1.20.20.20.6.1">Interval predictor:</mtext></ci><list id="S3.E5.m1.18.18.18.2.2.3.cmml" xref="S3.E5.m1.18.18.18.2.2.2"><apply id="S3.E5.m1.17.17.17.1.1.1.1.cmml" xref="S3.E5.m1.17.17.17.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.17.17.17.1.1.1.1.1.cmml" xref="S3.E5.m1.17.17.17.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.17.17.17.1.1.1.1.2.cmml" xref="S3.E5.m1.17.17.17.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.17.17.17.1.1.1.1.2.1.cmml" xref="S3.E5.m1.17.17.17.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.17.17.17.1.1.1.1.2.2.cmml" xref="S3.E5.m1.17.17.17.1.1.1.1.2.2"><ci id="S3.E5.m1.17.17.17.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.17.17.17.1.1.1.1.2.2.1">^</ci><ci id="S3.E5.m1.17.17.17.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.17.17.17.1.1.1.1.2.2.2">Δ</ci></apply><ci id="S3.E5.m1.17.17.17.1.1.1.1.2.3.cmml" xref="S3.E5.m1.17.17.17.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E5.m1.17.17.17.1.1.1.1.3.cmml" xref="S3.E5.m1.17.17.17.1.1.1.1.3">′</ci></apply><apply id="S3.E5.m1.18.18.18.2.2.2.2.cmml" xref="S3.E5.m1.18.18.18.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.18.18.18.2.2.2.2.1.cmml" xref="S3.E5.m1.18.18.18.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.18.18.18.2.2.2.2.2.cmml" xref="S3.E5.m1.18.18.18.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.18.18.18.2.2.2.2.2.1.cmml" xref="S3.E5.m1.18.18.18.2.2.2.2">subscript</csymbol><apply id="S3.E5.m1.18.18.18.2.2.2.2.2.2.cmml" xref="S3.E5.m1.18.18.18.2.2.2.2.2.2"><ci id="S3.E5.m1.18.18.18.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.18.18.18.2.2.2.2.2.2.1">^</ci><ci id="S3.E5.m1.18.18.18.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.18.18.18.2.2.2.2.2.2.2">𝐺</ci></apply><ci id="S3.E5.m1.18.18.18.2.2.2.2.2.3.cmml" xref="S3.E5.m1.18.18.18.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E5.m1.18.18.18.2.2.2.2.3.cmml" xref="S3.E5.m1.18.18.18.2.2.2.2.3">′</ci></apply></list><apply id="S3.E5.m1.20.20.20.4.2.cmml" xref="S3.E5.m1.20.20.20.4.2"><csymbol cd="latexml" id="S3.E5.m1.20.20.20.4.2.3.cmml" xref="S3.E5.m1.20.20.20.4.2.3">similar-to</csymbol><csymbol cd="latexml" id="S3.E5.m1.20.20.20.4.2.4.cmml" xref="S3.E5.m1.20.20.20.4.2.4">absent</csymbol><apply id="S3.E5.m1.20.20.20.4.2.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2"><times id="S3.E5.m1.20.20.20.4.2.2.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.3"></times><apply id="S3.E5.m1.20.20.20.4.2.2.4.cmml" xref="S3.E5.m1.20.20.20.4.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.20.20.20.4.2.2.4.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.4">subscript</csymbol><ci id="S3.E5.m1.20.20.20.4.2.2.4.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.4.2">𝑝</ci><ci id="S3.E5.m1.20.20.20.4.2.2.4.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.4.3">italic-ϕ</ci></apply><interval closure="open" id="S3.E5.m1.20.20.20.4.2.2.2.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2"><apply id="S3.E5.m1.19.19.19.3.1.1.1.1.1.cmml" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.19.19.19.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2"><ci id="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.2.2">Δ</ci></apply><ci id="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E5.m1.19.19.19.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.19.19.19.3.1.1.1.1.1.3">′</ci></apply><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.20.20.20.4.2.2.2.2.2.5.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.5">conditional</csymbol><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6">superscript</csymbol><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6">subscript</csymbol><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2"><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2.1">^</ci><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.2.2">𝐺</ci></apply><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.2.3">𝑡</ci></apply><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.6.3">′</ci></apply><list id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.5.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4"><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.2">ℎ</ci><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3"><minus id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.1"></minus><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.2">𝑡</ci><cn id="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.3.cmml" type="integer" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.2">𝑧</ci><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3"><minus id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.1"></minus><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.2">𝑡</ci><cn id="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3">subscript</csymbol><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.2.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3">superscript</csymbol><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.2.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.2.2">ℎ</ci><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.2.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.2.3">′</ci></apply><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.3.3.3.3">𝑡</ci></apply><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4">subscript</csymbol><apply id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.2.1.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4">superscript</csymbol><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.2.2.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.2.2">𝑧</ci><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.2.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.2.3">′</ci></apply><ci id="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.3.cmml" xref="S3.E5.m1.20.20.20.4.2.2.2.2.2.4.4.4.3">𝑡</ci></apply></list></apply></interval></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.20c">\begin{aligned} &amp;\text{Short-term transition model:}&amp;\quad h_{t}&amp;=f_{\phi}(h_{%
t-1},z_{t-1},a_{t-1})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Long-term transition model:}&amp;\quad{h}_{t}^{\prime}&amp;=f_{\phi}(h_{t-1},z_%
{t-1})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Encoder:}&amp;\quad z_{t}&amp;\sim q_{\phi}(z_{t}\mid h_{t},o_{t},\mathcal{M}_{%
t})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Dynamics predictor:}&amp;\quad\hat{z}_{t}&amp;\sim p_{\phi}(\hat{z}_{t}\mid h_{%
t})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Reward predictor:}&amp;\quad\hat{r}_{t},\hat{c}_{t}&amp;\sim p_{\phi}(\hat{r}_{%
t},\hat{c}_{t}\mid h_{t},z_{t})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Decoder:}&amp;\quad\hat{o}_{t},\hat{\mathcal{M}}_{t}&amp;\sim p_{\phi}(\hat{o}_%
{t},\hat{\mathcal{M}}_{t}\mid h_{t},z_{t})\vphantom{\hat{\Delta}_{t}^{\prime}}%
\\
&amp;\text{Jump predictor:}&amp;\quad\hat{j}_{t}&amp;\sim p_{\phi}(\hat{j}_{t}\mid h_{t},z%
_{t})\vphantom{\hat{\Delta}_{t}^{\prime}}\\
&amp;\text{Interval predictor:}&amp;\quad{\hat{\Delta}_{t}}^{\prime},{\hat{G}_{t}}^{%
\prime}&amp;\sim p_{\phi}({\hat{\Delta}_{t}}^{\prime},{\hat{G}_{t}}^{\prime}\mid h%
_{t-1},z_{t-1},{h}^{\prime}_{t},{z}^{\prime}_{t})\end{aligned}.</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.20d">start_ROW start_CELL end_CELL start_CELL Short-term transition model: end_CELL start_CELL italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_CELL start_CELL = italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL Long-term transition model: end_CELL start_CELL italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_CELL start_CELL = italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL Encoder: end_CELL start_CELL italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_CELL start_CELL ∼ italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL Dynamics predictor: end_CELL start_CELL over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_CELL start_CELL ∼ italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL Reward predictor: end_CELL start_CELL over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_CELL start_CELL ∼ italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL Decoder: end_CELL start_CELL over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG caligraphic_M end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_CELL start_CELL ∼ italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG caligraphic_M end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL Jump predictor: end_CELL start_CELL over^ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_CELL start_CELL ∼ italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL Interval predictor: end_CELL start_CELL over^ start_ARG roman_Δ end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , over^ start_ARG italic_G end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_CELL start_CELL ∼ italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG roman_Δ end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , over^ start_ARG italic_G end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="381" id="S3.F3.g1" src="x4.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
The overall architecture of the world model and the behavior learning process.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p2">
<p class="ltx_p" id="S3.SS3.SSS2.p2.19">In LS-Imagine, the state transition model includes both short-term and long-term branches. The short-term transition model integrates the previous deterministic recurrent state <math alttext="h_{t-1}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.1.m1.1"><semantics id="S3.SS3.SSS2.p2.1.m1.1a"><msub id="S3.SS3.SSS2.p2.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.cmml">h</mi><mrow id="S3.SS3.SSS2.p2.1.m1.1.1.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.3.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p2.1.m1.1.1.3.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p2.1.m1.1.1.3.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b"><apply id="S3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.2">ℎ</ci><apply id="S3.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3"><minus id="S3.SS3.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.1"></minus><ci id="S3.SS3.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.2">𝑡</ci><cn id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">h_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, stochastic state <math alttext="z_{t-1}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.2.m2.1"><semantics id="S3.SS3.SSS2.p2.2.m2.1a"><msub id="S3.SS3.SSS2.p2.2.m2.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.1.1.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml">z</mi><mrow id="S3.SS3.SSS2.p2.2.m2.1.1.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.1.1.3.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p2.2.m2.1.1.3.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p2.2.m2.1.1.3.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.1b"><apply id="S3.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.2">𝑧</ci><apply id="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3"><minus id="S3.SS3.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.1"></minus><ci id="S3.SS3.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.2">𝑡</ci><cn id="S3.SS3.SSS2.p2.2.m2.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.1c">z_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, and action <math alttext="a_{t-1}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.3.m3.1"><semantics id="S3.SS3.SSS2.p2.3.m3.1a"><msub id="S3.SS3.SSS2.p2.3.m3.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.1.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.cmml">a</mi><mrow id="S3.SS3.SSS2.p2.3.m3.1.1.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.1.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p2.3.m3.1.1.3.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p2.3.m3.1.1.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m3.1b"><apply id="S3.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2">𝑎</ci><apply id="S3.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3"><minus id="S3.SS3.SSS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.1"></minus><ci id="S3.SS3.SSS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.2">𝑡</ci><cn id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m3.1c">a_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> to adopt the single-step transition.
In contrast, the long-term transition model simulates multiple-step transitions toward the target.
At time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.4.m4.1"><semantics id="S3.SS3.SSS2.p2.4.m4.1a"><mi id="S3.SS3.SSS2.p2.4.m4.1.1" xref="S3.SS3.SSS2.p2.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m4.1b"><ci id="S3.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.4.m4.1d">italic_t</annotation></semantics></math>, we feed the recurrent state <math alttext="h_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.5.m5.1"><semantics id="S3.SS3.SSS2.p2.5.m5.1a"><msub id="S3.SS3.SSS2.p2.5.m5.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p2.5.m5.1.1.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.2.cmml">h</mi><mi id="S3.SS3.SSS2.p2.5.m5.1.1.3" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m5.1b"><apply id="S3.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.2">ℎ</ci><ci id="S3.SS3.SSS2.p2.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m5.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.5.m5.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the observation <math alttext="o_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.6.m6.1"><semantics id="S3.SS3.SSS2.p2.6.m6.1a"><msub id="S3.SS3.SSS2.p2.6.m6.1.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml">o</mi><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m6.1b"><apply id="S3.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.2">𝑜</ci><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m6.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.6.m6.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and the affordance map <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.7.m7.1"><semantics id="S3.SS3.SSS2.p2.7.m7.1a"><msub id="S3.SS3.SSS2.p2.7.m7.1.1" xref="S3.SS3.SSS2.p2.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p2.7.m7.1.1.2" xref="S3.SS3.SSS2.p2.7.m7.1.1.2.cmml">ℳ</mi><mi id="S3.SS3.SSS2.p2.7.m7.1.1.3" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.7.m7.1b"><apply id="S3.SS3.SSS2.p2.7.m7.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m7.1.1.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.2">ℳ</ci><ci id="S3.SS3.SSS2.p2.7.m7.1.1.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.7.m7.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.7.m7.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> into the encoder to obtain posterior state <math alttext="z_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.8.m8.1"><semantics id="S3.SS3.SSS2.p2.8.m8.1a"><msub id="S3.SS3.SSS2.p2.8.m8.1.1" xref="S3.SS3.SSS2.p2.8.m8.1.1.cmml"><mi id="S3.SS3.SSS2.p2.8.m8.1.1.2" xref="S3.SS3.SSS2.p2.8.m8.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS2.p2.8.m8.1.1.3" xref="S3.SS3.SSS2.p2.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.8.m8.1b"><apply id="S3.SS3.SSS2.p2.8.m8.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.8.m8.1.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.8.m8.1.1.2.cmml" xref="S3.SS3.SSS2.p2.8.m8.1.1.2">𝑧</ci><ci id="S3.SS3.SSS2.p2.8.m8.1.1.3.cmml" xref="S3.SS3.SSS2.p2.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.8.m8.1c">z_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.8.m8.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Notably, we also use the affordance map as an input of the encoder, which serves as the goal-conditioned prior guidance to the agent.
Meanwhile, the prediction of prior state <math alttext="\hat{z}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.9.m9.1"><semantics id="S3.SS3.SSS2.p2.9.m9.1a"><msub id="S3.SS3.SSS2.p2.9.m9.1.1" xref="S3.SS3.SSS2.p2.9.m9.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.9.m9.1.1.2" xref="S3.SS3.SSS2.p2.9.m9.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.9.m9.1.1.2.2" xref="S3.SS3.SSS2.p2.9.m9.1.1.2.2.cmml">z</mi><mo id="S3.SS3.SSS2.p2.9.m9.1.1.2.1" xref="S3.SS3.SSS2.p2.9.m9.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p2.9.m9.1.1.3" xref="S3.SS3.SSS2.p2.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.9.m9.1b"><apply id="S3.SS3.SSS2.p2.9.m9.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m9.1.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.9.m9.1.1.2.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1.2"><ci id="S3.SS3.SSS2.p2.9.m9.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1.2.1">^</ci><ci id="S3.SS3.SSS2.p2.9.m9.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1.2.2">𝑧</ci></apply><ci id="S3.SS3.SSS2.p2.9.m9.1.1.3.cmml" xref="S3.SS3.SSS2.p2.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.9.m9.1c">\hat{z}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.9.m9.1d">over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> does not involve the current observation or affordance map, relying only on information from history.
We use <math alttext="(h_{t},z_{t})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.10.m10.2"><semantics id="S3.SS3.SSS2.p2.10.m10.2a"><mrow id="S3.SS3.SSS2.p2.10.m10.2.2.2" xref="S3.SS3.SSS2.p2.10.m10.2.2.3.cmml"><mo id="S3.SS3.SSS2.p2.10.m10.2.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p2.10.m10.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS2.p2.10.m10.1.1.1.1" xref="S3.SS3.SSS2.p2.10.m10.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.10.m10.1.1.1.1.2" xref="S3.SS3.SSS2.p2.10.m10.1.1.1.1.2.cmml">h</mi><mi id="S3.SS3.SSS2.p2.10.m10.1.1.1.1.3" xref="S3.SS3.SSS2.p2.10.m10.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p2.10.m10.2.2.2.4" xref="S3.SS3.SSS2.p2.10.m10.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p2.10.m10.2.2.2.2" xref="S3.SS3.SSS2.p2.10.m10.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p2.10.m10.2.2.2.2.2" xref="S3.SS3.SSS2.p2.10.m10.2.2.2.2.2.cmml">z</mi><mi id="S3.SS3.SSS2.p2.10.m10.2.2.2.2.3" xref="S3.SS3.SSS2.p2.10.m10.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p2.10.m10.2.2.2.5" stretchy="false" xref="S3.SS3.SSS2.p2.10.m10.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.10.m10.2b"><interval closure="open" id="S3.SS3.SSS2.p2.10.m10.2.2.3.cmml" xref="S3.SS3.SSS2.p2.10.m10.2.2.2"><apply id="S3.SS3.SSS2.p2.10.m10.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m10.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.10.m10.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.1.1.1.2">ℎ</ci><ci id="S3.SS3.SSS2.p2.10.m10.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.10.m10.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p2.10.m10.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.10.m10.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.10.m10.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.10.m10.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.10.m10.2.2.2.2.2">𝑧</ci><ci id="S3.SS3.SSS2.p2.10.m10.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.10.m10.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.10.m10.2c">(h_{t},z_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.10.m10.2d">( italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> to reconstruct the visual observation <math alttext="\hat{o}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.11.m11.1"><semantics id="S3.SS3.SSS2.p2.11.m11.1a"><msub id="S3.SS3.SSS2.p2.11.m11.1.1" xref="S3.SS3.SSS2.p2.11.m11.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.11.m11.1.1.2" xref="S3.SS3.SSS2.p2.11.m11.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.11.m11.1.1.2.2" xref="S3.SS3.SSS2.p2.11.m11.1.1.2.2.cmml">o</mi><mo id="S3.SS3.SSS2.p2.11.m11.1.1.2.1" xref="S3.SS3.SSS2.p2.11.m11.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p2.11.m11.1.1.3" xref="S3.SS3.SSS2.p2.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.11.m11.1b"><apply id="S3.SS3.SSS2.p2.11.m11.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.11.m11.1.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m11.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.11.m11.1.1.2.cmml" xref="S3.SS3.SSS2.p2.11.m11.1.1.2"><ci id="S3.SS3.SSS2.p2.11.m11.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.11.m11.1.1.2.1">^</ci><ci id="S3.SS3.SSS2.p2.11.m11.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.11.m11.1.1.2.2">𝑜</ci></apply><ci id="S3.SS3.SSS2.p2.11.m11.1.1.3.cmml" xref="S3.SS3.SSS2.p2.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.11.m11.1c">\hat{o}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.11.m11.1d">over^ start_ARG italic_o end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and the affordance map <math alttext="\hat{\mathcal{M}}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.12.m12.1"><semantics id="S3.SS3.SSS2.p2.12.m12.1a"><msub id="S3.SS3.SSS2.p2.12.m12.1.1" xref="S3.SS3.SSS2.p2.12.m12.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.12.m12.1.1.2" xref="S3.SS3.SSS2.p2.12.m12.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p2.12.m12.1.1.2.2" xref="S3.SS3.SSS2.p2.12.m12.1.1.2.2.cmml">ℳ</mi><mo id="S3.SS3.SSS2.p2.12.m12.1.1.2.1" xref="S3.SS3.SSS2.p2.12.m12.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p2.12.m12.1.1.3" xref="S3.SS3.SSS2.p2.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.12.m12.1b"><apply id="S3.SS3.SSS2.p2.12.m12.1.1.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.12.m12.1.1.1.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.12.m12.1.1.2.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1.2"><ci id="S3.SS3.SSS2.p2.12.m12.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1.2.1">^</ci><ci id="S3.SS3.SSS2.p2.12.m12.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1.2.2">ℳ</ci></apply><ci id="S3.SS3.SSS2.p2.12.m12.1.1.3.cmml" xref="S3.SS3.SSS2.p2.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.12.m12.1c">\hat{\mathcal{M}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.12.m12.1d">over^ start_ARG caligraphic_M end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and predict the reward <math alttext="\hat{r}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.13.m13.1"><semantics id="S3.SS3.SSS2.p2.13.m13.1a"><msub id="S3.SS3.SSS2.p2.13.m13.1.1" xref="S3.SS3.SSS2.p2.13.m13.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.13.m13.1.1.2" xref="S3.SS3.SSS2.p2.13.m13.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.13.m13.1.1.2.2" xref="S3.SS3.SSS2.p2.13.m13.1.1.2.2.cmml">r</mi><mo id="S3.SS3.SSS2.p2.13.m13.1.1.2.1" xref="S3.SS3.SSS2.p2.13.m13.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p2.13.m13.1.1.3" xref="S3.SS3.SSS2.p2.13.m13.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.13.m13.1b"><apply id="S3.SS3.SSS2.p2.13.m13.1.1.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.13.m13.1.1.1.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.13.m13.1.1.2.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.1.2"><ci id="S3.SS3.SSS2.p2.13.m13.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.1.2.1">^</ci><ci id="S3.SS3.SSS2.p2.13.m13.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.1.2.2">𝑟</ci></apply><ci id="S3.SS3.SSS2.p2.13.m13.1.1.3.cmml" xref="S3.SS3.SSS2.p2.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.13.m13.1c">\hat{r}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.13.m13.1d">over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, episode continuation flag <math alttext="\hat{c}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.14.m14.1"><semantics id="S3.SS3.SSS2.p2.14.m14.1a"><msub id="S3.SS3.SSS2.p2.14.m14.1.1" xref="S3.SS3.SSS2.p2.14.m14.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.14.m14.1.1.2" xref="S3.SS3.SSS2.p2.14.m14.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.14.m14.1.1.2.2" xref="S3.SS3.SSS2.p2.14.m14.1.1.2.2.cmml">c</mi><mo id="S3.SS3.SSS2.p2.14.m14.1.1.2.1" xref="S3.SS3.SSS2.p2.14.m14.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p2.14.m14.1.1.3" xref="S3.SS3.SSS2.p2.14.m14.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.14.m14.1b"><apply id="S3.SS3.SSS2.p2.14.m14.1.1.cmml" xref="S3.SS3.SSS2.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.14.m14.1.1.1.cmml" xref="S3.SS3.SSS2.p2.14.m14.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.14.m14.1.1.2.cmml" xref="S3.SS3.SSS2.p2.14.m14.1.1.2"><ci id="S3.SS3.SSS2.p2.14.m14.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.14.m14.1.1.2.1">^</ci><ci id="S3.SS3.SSS2.p2.14.m14.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.14.m14.1.1.2.2">𝑐</ci></apply><ci id="S3.SS3.SSS2.p2.14.m14.1.1.3.cmml" xref="S3.SS3.SSS2.p2.14.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.14.m14.1c">\hat{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.14.m14.1d">over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and jumping flag <math alttext="\hat{j}_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.15.m15.1"><semantics id="S3.SS3.SSS2.p2.15.m15.1a"><msub id="S3.SS3.SSS2.p2.15.m15.1.1" xref="S3.SS3.SSS2.p2.15.m15.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.15.m15.1.1.2" xref="S3.SS3.SSS2.p2.15.m15.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.15.m15.1.1.2.2" xref="S3.SS3.SSS2.p2.15.m15.1.1.2.2.cmml">j</mi><mo id="S3.SS3.SSS2.p2.15.m15.1.1.2.1" xref="S3.SS3.SSS2.p2.15.m15.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p2.15.m15.1.1.3" xref="S3.SS3.SSS2.p2.15.m15.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.15.m15.1b"><apply id="S3.SS3.SSS2.p2.15.m15.1.1.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.15.m15.1.1.1.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.15.m15.1.1.2.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.2"><ci id="S3.SS3.SSS2.p2.15.m15.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.2.1">^</ci><ci id="S3.SS3.SSS2.p2.15.m15.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.2.2">𝑗</ci></apply><ci id="S3.SS3.SSS2.p2.15.m15.1.1.3.cmml" xref="S3.SS3.SSS2.p2.15.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.15.m15.1c">\hat{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.15.m15.1d">over^ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
For states that have adopted a long-term state transition, we employ an interval predictor to estimate the expected number of steps <math alttext="\hat{\Delta}_{t}^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.16.m16.1"><semantics id="S3.SS3.SSS2.p2.16.m16.1a"><msubsup id="S3.SS3.SSS2.p2.16.m16.1.1" xref="S3.SS3.SSS2.p2.16.m16.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.16.m16.1.1.2.2" xref="S3.SS3.SSS2.p2.16.m16.1.1.2.2.cmml"><mi id="S3.SS3.SSS2.p2.16.m16.1.1.2.2.2" mathvariant="normal" xref="S3.SS3.SSS2.p2.16.m16.1.1.2.2.2.cmml">Δ</mi><mo id="S3.SS3.SSS2.p2.16.m16.1.1.2.2.1" xref="S3.SS3.SSS2.p2.16.m16.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p2.16.m16.1.1.2.3" xref="S3.SS3.SSS2.p2.16.m16.1.1.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p2.16.m16.1.1.3" xref="S3.SS3.SSS2.p2.16.m16.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.16.m16.1b"><apply id="S3.SS3.SSS2.p2.16.m16.1.1.cmml" xref="S3.SS3.SSS2.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.16.m16.1.1.1.cmml" xref="S3.SS3.SSS2.p2.16.m16.1.1">superscript</csymbol><apply id="S3.SS3.SSS2.p2.16.m16.1.1.2.cmml" xref="S3.SS3.SSS2.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.16.m16.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.16.m16.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.16.m16.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.16.m16.1.1.2.2"><ci id="S3.SS3.SSS2.p2.16.m16.1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.16.m16.1.1.2.2.1">^</ci><ci id="S3.SS3.SSS2.p2.16.m16.1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.16.m16.1.1.2.2.2">Δ</ci></apply><ci id="S3.SS3.SSS2.p2.16.m16.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.16.m16.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS2.p2.16.m16.1.1.3.cmml" xref="S3.SS3.SSS2.p2.16.m16.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.16.m16.1c">\hat{\Delta}_{t}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.16.m16.1d">over^ start_ARG roman_Δ end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> required to transition from the pre-transition state <math alttext="(h_{t-1},z_{t-1})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.17.m17.2"><semantics id="S3.SS3.SSS2.p2.17.m17.2a"><mrow id="S3.SS3.SSS2.p2.17.m17.2.2.2" xref="S3.SS3.SSS2.p2.17.m17.2.2.3.cmml"><mo id="S3.SS3.SSS2.p2.17.m17.2.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p2.17.m17.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS2.p2.17.m17.1.1.1.1" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.2" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.2.cmml">h</mi><mrow id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.2" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.1" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.3" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.SSS2.p2.17.m17.2.2.2.4" xref="S3.SS3.SSS2.p2.17.m17.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p2.17.m17.2.2.2.2" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.2" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.2.cmml">z</mi><mrow id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.2" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.1" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.3" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.SSS2.p2.17.m17.2.2.2.5" stretchy="false" xref="S3.SS3.SSS2.p2.17.m17.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.17.m17.2b"><interval closure="open" id="S3.SS3.SSS2.p2.17.m17.2.2.3.cmml" xref="S3.SS3.SSS2.p2.17.m17.2.2.2"><apply id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.2">ℎ</ci><apply id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3"><minus id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.1"></minus><ci id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.2">𝑡</ci><cn id="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.17.m17.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.2">𝑧</ci><apply id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3"><minus id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.1"></minus><ci id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.2">𝑡</ci><cn id="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.17.m17.2.2.2.2.3.3">1</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.17.m17.2c">(h_{t-1},z_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.17.m17.2d">( italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> to the post-transition state <math alttext="({h}^{\prime}_{t},{z}^{\prime}_{t})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.18.m18.2"><semantics id="S3.SS3.SSS2.p2.18.m18.2a"><mrow id="S3.SS3.SSS2.p2.18.m18.2.2.2" xref="S3.SS3.SSS2.p2.18.m18.2.2.3.cmml"><mo id="S3.SS3.SSS2.p2.18.m18.2.2.2.3" stretchy="false" xref="S3.SS3.SSS2.p2.18.m18.2.2.3.cmml">(</mo><msubsup id="S3.SS3.SSS2.p2.18.m18.1.1.1.1" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.18.m18.1.1.1.1.2.2" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1.2.2.cmml">h</mi><mi id="S3.SS3.SSS2.p2.18.m18.1.1.1.1.3" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1.3.cmml">t</mi><mo id="S3.SS3.SSS2.p2.18.m18.1.1.1.1.2.3" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p2.18.m18.2.2.2.4" xref="S3.SS3.SSS2.p2.18.m18.2.2.3.cmml">,</mo><msubsup id="S3.SS3.SSS2.p2.18.m18.2.2.2.2" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p2.18.m18.2.2.2.2.2.2" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2.2.2.cmml">z</mi><mi id="S3.SS3.SSS2.p2.18.m18.2.2.2.2.3" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p2.18.m18.2.2.2.2.2.3" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p2.18.m18.2.2.2.5" stretchy="false" xref="S3.SS3.SSS2.p2.18.m18.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.18.m18.2b"><interval closure="open" id="S3.SS3.SSS2.p2.18.m18.2.2.3.cmml" xref="S3.SS3.SSS2.p2.18.m18.2.2.2"><apply id="S3.SS3.SSS2.p2.18.m18.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.18.m18.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.18.m18.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.18.m18.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p2.18.m18.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1.2.2">ℎ</ci><ci id="S3.SS3.SSS2.p2.18.m18.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1.2.3">′</ci></apply><ci id="S3.SS3.SSS2.p2.18.m18.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.18.m18.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p2.18.m18.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.18.m18.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2">subscript</csymbol><apply id="S3.SS3.SSS2.p2.18.m18.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.18.m18.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS2.p2.18.m18.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2.2.2">𝑧</ci><ci id="S3.SS3.SSS2.p2.18.m18.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2.2.3">′</ci></apply><ci id="S3.SS3.SSS2.p2.18.m18.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p2.18.m18.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.18.m18.2c">({h}^{\prime}_{t},{z}^{\prime}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.18.m18.2d">( italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, as well as the expected cumulative reward <math alttext="\hat{G}_{t}^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.19.m19.1"><semantics id="S3.SS3.SSS2.p2.19.m19.1a"><msubsup id="S3.SS3.SSS2.p2.19.m19.1.1" xref="S3.SS3.SSS2.p2.19.m19.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.19.m19.1.1.2.2" xref="S3.SS3.SSS2.p2.19.m19.1.1.2.2.cmml"><mi id="S3.SS3.SSS2.p2.19.m19.1.1.2.2.2" xref="S3.SS3.SSS2.p2.19.m19.1.1.2.2.2.cmml">G</mi><mo id="S3.SS3.SSS2.p2.19.m19.1.1.2.2.1" xref="S3.SS3.SSS2.p2.19.m19.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS2.p2.19.m19.1.1.2.3" xref="S3.SS3.SSS2.p2.19.m19.1.1.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p2.19.m19.1.1.3" xref="S3.SS3.SSS2.p2.19.m19.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.19.m19.1b"><apply id="S3.SS3.SSS2.p2.19.m19.1.1.cmml" xref="S3.SS3.SSS2.p2.19.m19.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.19.m19.1.1.1.cmml" xref="S3.SS3.SSS2.p2.19.m19.1.1">superscript</csymbol><apply id="S3.SS3.SSS2.p2.19.m19.1.1.2.cmml" xref="S3.SS3.SSS2.p2.19.m19.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.19.m19.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.19.m19.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.19.m19.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.19.m19.1.1.2.2"><ci id="S3.SS3.SSS2.p2.19.m19.1.1.2.2.1.cmml" xref="S3.SS3.SSS2.p2.19.m19.1.1.2.2.1">^</ci><ci id="S3.SS3.SSS2.p2.19.m19.1.1.2.2.2.cmml" xref="S3.SS3.SSS2.p2.19.m19.1.1.2.2.2">𝐺</ci></apply><ci id="S3.SS3.SSS2.p2.19.m19.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.19.m19.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS2.p2.19.m19.1.1.3.cmml" xref="S3.SS3.SSS2.p2.19.m19.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.19.m19.1c">\hat{G}_{t}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.19.m19.1d">over^ start_ARG italic_G end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> the agent might receive during this interval.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p3">
<p class="ltx_p" id="S3.SS3.SSS2.p3.6">To train the world model, we interact with the environment to collect short-term tuples <math alttext="\mathcal{D}_{t}=(o_{t},a_{t},r_{t},c_{t},\mathcal{M}_{t},j_{t},\Delta_{t},G_{t})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.1.m1.8"><semantics id="S3.SS3.SSS2.p3.1.m1.8a"><mrow id="S3.SS3.SSS2.p3.1.m1.8.8" xref="S3.SS3.SSS2.p3.1.m1.8.8.cmml"><msub id="S3.SS3.SSS2.p3.1.m1.8.8.10" xref="S3.SS3.SSS2.p3.1.m1.8.8.10.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.1.m1.8.8.10.2" xref="S3.SS3.SSS2.p3.1.m1.8.8.10.2.cmml">𝒟</mi><mi id="S3.SS3.SSS2.p3.1.m1.8.8.10.3" xref="S3.SS3.SSS2.p3.1.m1.8.8.10.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p3.1.m1.8.8.9" xref="S3.SS3.SSS2.p3.1.m1.8.8.9.cmml">=</mo><mrow id="S3.SS3.SSS2.p3.1.m1.8.8.8.8" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml"><mo id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.9" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml">(</mo><msub id="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.2.cmml">o</mi><mi id="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.10" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml">,</mo><msub id="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2" xref="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.2" xref="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.2.cmml">a</mi><mi id="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.3" xref="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.11" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml">,</mo><msub id="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3" xref="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.2" xref="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.2.cmml">r</mi><mi id="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.3" xref="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.12" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml">,</mo><msub id="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4" xref="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.2" xref="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.2.cmml">c</mi><mi id="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.3" xref="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.13" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml">,</mo><msub id="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5" xref="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.2" xref="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.2.cmml">ℳ</mi><mi id="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.3" xref="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.14" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml">,</mo><msub id="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6" xref="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.2" xref="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.2.cmml">j</mi><mi id="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.3" xref="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.15" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml">,</mo><msub id="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7" xref="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.2" mathvariant="normal" xref="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.2.cmml">Δ</mi><mi id="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.3" xref="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.16" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml">,</mo><msub id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.2" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.2.cmml">G</mi><mi id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.3" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.17" stretchy="false" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.1.m1.8b"><apply id="S3.SS3.SSS2.p3.1.m1.8.8.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8"><eq id="S3.SS3.SSS2.p3.1.m1.8.8.9.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.9"></eq><apply id="S3.SS3.SSS2.p3.1.m1.8.8.10.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.10"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.8.8.10.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.10">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.8.8.10.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.10.2">𝒟</ci><ci id="S3.SS3.SSS2.p3.1.m1.8.8.10.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.10.3">𝑡</ci></apply><vector id="S3.SS3.SSS2.p3.1.m1.8.8.8.9.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.8"><apply id="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.2">𝑜</ci><ci id="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.2">𝑎</ci><ci id="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.2">𝑟</ci><ci id="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.3.3.3.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.2">𝑐</ci><ci id="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.4.4.4.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.cmml" xref="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.2">ℳ</ci><ci id="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.5.5.5.5.5.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.cmml" xref="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.2">𝑗</ci><ci id="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.6.6.6.6.6.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.cmml" xref="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.2">Δ</ci><ci id="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.7.7.7.7.7.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.2">𝐺</ci><ci id="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.8.8.8.8.8.3">𝑡</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.1.m1.8c">\mathcal{D}_{t}=(o_{t},a_{t},r_{t},c_{t},\mathcal{M}_{t},j_{t},\Delta_{t},G_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.1.m1.8d">caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> and long-term tuples <math alttext="\mathcal{D}^{\prime}_{t}=(o_{t}^{\prime},a_{t}^{\prime},{r}_{t}^{\prime},%
\mathcal{M}^{\prime}_{t},c_{t}^{\prime},j_{t}^{\prime},\Delta_{t}^{\prime},G_{%
t}^{\prime})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.2.m2.8"><semantics id="S3.SS3.SSS2.p3.2.m2.8a"><mrow id="S3.SS3.SSS2.p3.2.m2.8.8" xref="S3.SS3.SSS2.p3.2.m2.8.8.cmml"><msubsup id="S3.SS3.SSS2.p3.2.m2.8.8.10" xref="S3.SS3.SSS2.p3.2.m2.8.8.10.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.2.m2.8.8.10.2.2" xref="S3.SS3.SSS2.p3.2.m2.8.8.10.2.2.cmml">𝒟</mi><mi id="S3.SS3.SSS2.p3.2.m2.8.8.10.3" xref="S3.SS3.SSS2.p3.2.m2.8.8.10.3.cmml">t</mi><mo id="S3.SS3.SSS2.p3.2.m2.8.8.10.2.3" xref="S3.SS3.SSS2.p3.2.m2.8.8.10.2.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p3.2.m2.8.8.9" xref="S3.SS3.SSS2.p3.2.m2.8.8.9.cmml">=</mo><mrow id="S3.SS3.SSS2.p3.2.m2.8.8.8.8" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml"><mo id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.9" stretchy="false" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml">(</mo><msubsup id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.2.2" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.2.2.cmml">o</mi><mi id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.2.3" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.3" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.10" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml">,</mo><msubsup id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.2.2.cmml">a</mi><mi id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.11" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml">,</mo><msubsup id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.2.2" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.2.2.cmml">r</mi><mi id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.2.3" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.3" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.12" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml">,</mo><msubsup id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.2.2" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.2.2.cmml">ℳ</mi><mi id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.3" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.3.cmml">t</mi><mo id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.2.3" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.2.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.13" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml">,</mo><msubsup id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.2.2" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.2.2.cmml">c</mi><mi id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.2.3" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.3" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.14" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml">,</mo><msubsup id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.2.2" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.2.2.cmml">j</mi><mi id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.2.3" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.3" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.15" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml">,</mo><msubsup id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.2.2" mathvariant="normal" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.2.2.cmml">Δ</mi><mi id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.2.3" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.3" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.16" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml">,</mo><msubsup id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.2.2" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.2.2.cmml">G</mi><mi id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.2.3" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.3" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.17" stretchy="false" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.2.m2.8b"><apply id="S3.SS3.SSS2.p3.2.m2.8.8.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8"><eq id="S3.SS3.SSS2.p3.2.m2.8.8.9.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.9"></eq><apply id="S3.SS3.SSS2.p3.2.m2.8.8.10.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.10"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.8.8.10.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.10">subscript</csymbol><apply id="S3.SS3.SSS2.p3.2.m2.8.8.10.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.10"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.8.8.10.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.10">superscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.8.8.10.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.10.2.2">𝒟</ci><ci id="S3.SS3.SSS2.p3.2.m2.8.8.10.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.10.2.3">′</ci></apply><ci id="S3.SS3.SSS2.p3.2.m2.8.8.10.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.10.3">𝑡</ci></apply><vector id="S3.SS3.SSS2.p3.2.m2.8.8.8.9.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8"><apply id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.2.2">𝑜</ci><ci id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.1.1.1.3">′</ci></apply><apply id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2">superscript</csymbol><apply id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.2.2">𝑎</ci><ci id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.2.2.2.2.2.3">′</ci></apply><apply id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3">superscript</csymbol><apply id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.2.2">𝑟</ci><ci id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.3.3.3.3.3.3">′</ci></apply><apply id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.cmml" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4">subscript</csymbol><apply id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4">superscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.2.2">ℳ</ci><ci id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.2.3">′</ci></apply><ci id="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.4.4.4.4.4.3">𝑡</ci></apply><apply id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.cmml" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5">superscript</csymbol><apply id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5">subscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.2.2">𝑐</ci><ci id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.5.5.5.5.5.3">′</ci></apply><apply id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.cmml" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6">superscript</csymbol><apply id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6">subscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.2.2">𝑗</ci><ci id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.6.6.6.6.6.3">′</ci></apply><apply id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.cmml" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7">superscript</csymbol><apply id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7">subscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.2.2">Δ</ci><ci id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.7.7.7.7.7.3">′</ci></apply><apply id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8">superscript</csymbol><apply id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8">subscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.2.2">𝐺</ci><ci id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.8.8.8.8.8.3">′</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.2.m2.8c">\mathcal{D}^{\prime}_{t}=(o_{t}^{\prime},a_{t}^{\prime},{r}_{t}^{\prime},%
\mathcal{M}^{\prime}_{t},c_{t}^{\prime},j_{t}^{\prime},\Delta_{t}^{\prime},G_{%
t}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.2.m2.8d">caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> using the current policy.
More details for environment interaction and data collection can be found in <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.SS3.SSS2.p3.6.1">Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A2.SS1" title="B.1 Environment Interaction and Data Collection ‣ Appendix B Model Details ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">B.1</span></a></span>.
During representation learning, we sample short-term tuples <math alttext="\{\mathcal{D}_{t}\}_{t=1}^{T}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.3.m3.1"><semantics id="S3.SS3.SSS2.p3.3.m3.1a"><msubsup id="S3.SS3.SSS2.p3.3.m3.1.1" xref="S3.SS3.SSS2.p3.3.m3.1.1.cmml"><mrow id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.2.cmml"><mo id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.2.cmml">{</mo><msub id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS2.p3.3.m3.1.1.1.3" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p3.3.m3.1.1.1.3.2" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p3.3.m3.1.1.1.3.1" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.3.1.cmml">=</mo><mn id="S3.SS3.SSS2.p3.3.m3.1.1.1.3.3" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.SSS2.p3.3.m3.1.1.3" xref="S3.SS3.SSS2.p3.3.m3.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.3.m3.1b"><apply id="S3.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.SSS2.p3.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.3.m3.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1">subscript</csymbol><set id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1"><apply id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S3.SS3.SSS2.p3.3.m3.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.3"><eq id="S3.SS3.SSS2.p3.3.m3.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.3.1"></eq><ci id="S3.SS3.SSS2.p3.3.m3.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.3.2">𝑡</ci><cn id="S3.SS3.SSS2.p3.3.m3.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p3.3.m3.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.SSS2.p3.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.3.m3.1c">\{\mathcal{D}_{t}\}_{t=1}^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.3.m3.1d">{ caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> and the long-term tuples following jumpy transitions <math alttext="\{\mathcal{D}_{t}^{\prime}\}_{t\in\mathcal{T}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.4.m4.1"><semantics id="S3.SS3.SSS2.p3.4.m4.1a"><msub id="S3.SS3.SSS2.p3.4.m4.1.1" xref="S3.SS3.SSS2.p3.4.m4.1.1.cmml"><mrow id="S3.SS3.SSS2.p3.4.m4.1.1.1.1" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.2.cmml"><mo id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.2.cmml">{</mo><msubsup id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.2" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.3" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.3.cmml">t</mi><mo id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.3" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS2.p3.4.m4.1.1.3" xref="S3.SS3.SSS2.p3.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS2.p3.4.m4.1.1.3.2" xref="S3.SS3.SSS2.p3.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSS2.p3.4.m4.1.1.3.1" xref="S3.SS3.SSS2.p3.4.m4.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.4.m4.1.1.3.3" xref="S3.SS3.SSS2.p3.4.m4.1.1.3.3.cmml">𝒯</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.4.m4.1b"><apply id="S3.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.4.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1">subscript</csymbol><set id="S3.SS3.SSS2.p3.4.m4.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1"><apply id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.2">𝒟</ci><ci id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.1.1.1.3">′</ci></apply></set><apply id="S3.SS3.SSS2.p3.4.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.3"><in id="S3.SS3.SSS2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.3.1"></in><ci id="S3.SS3.SSS2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.3.2">𝑡</ci><ci id="S3.SS3.SSS2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1.3.3">𝒯</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.4.m4.1c">\{\mathcal{D}_{t}^{\prime}\}_{t\in\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.4.m4.1d">{ caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_t ∈ caligraphic_T end_POSTSUBSCRIPT</annotation></semantics></math> from the replay buffer <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.5.m5.1"><semantics id="S3.SS3.SSS2.p3.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.5.m5.1.1" xref="S3.SS3.SSS2.p3.5.m5.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.5.m5.1b"><ci id="S3.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.5.m5.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.5.m5.1d">caligraphic_B</annotation></semantics></math>, where <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.6.m6.1"><semantics id="S3.SS3.SSS2.p3.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.6.m6.1.1" xref="S3.SS3.SSS2.p3.6.m6.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.6.m6.1b"><ci id="S3.SS3.SSS2.p3.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p3.6.m6.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.6.m6.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.6.m6.1d">caligraphic_T</annotation></semantics></math> denotes the set of time steps at which long-term state transitions are required. The loss functions for each component of the short-term and long-term world model branch are as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{aligned} &amp;\text{Short-term branch:}\quad\left\{\begin{aligned} \mathcal%
{L}_{\text{dyn}}&amp;\doteq\max\left(1,\operatorname{KL}\left[\operatorname{sg}%
\left(q_{\phi}\left(z_{t}\mid h_{t},o_{t},\mathcal{M}_{t}\right)\right)%
\parallel p_{\phi}\left(z_{t}\mid h_{t}\right)\right]\right)\\
\mathcal{L}_{\text{enc}}&amp;\doteq\max\left(1,\operatorname{KL}\left[q_{\phi}%
\left(z_{t}\mid h_{t},o_{t},\mathcal{M}_{t}\right)\parallel\operatorname{sg}%
\left(p_{\phi}\left(z_{t}\mid h_{t}\right)\right)\right]\right)\\
\mathcal{L}_{\text{dec}}&amp;\doteq-\operatorname{ln}p_{\phi}\left(o_{t},\mathcal{%
M}_{t}\mid h_{t},z_{t}\right)\\
\mathcal{L}_{\text{pred}}&amp;\doteq-\operatorname{ln}p_{\phi}\left({r}_{t},{c}_{t%
}\mid h_{t},z_{t}\right)-\operatorname{ln}p_{\phi}\left({j}_{t}\mid h_{t},z_{t%
}\right)\end{aligned}\right.\\
&amp;\text{Long-term branch:}\quad\left\{\begin{aligned} \mathcal{L}^{\prime}_{%
\text{dyn}}&amp;\doteq\max\left(1,\operatorname{KL}\left[\operatorname{sg}\left(q_%
{\phi}\left({z}^{\prime}_{t}\mid{h}^{\prime}_{t},o^{\prime}_{t},{\mathcal{M}}^%
{\prime}_{t}\right)\right)\parallel p_{\phi}\left({z}^{\prime}_{t}\mid{h}^{%
\prime}_{t}\right)\right]\right)\\
\mathcal{L}^{\prime}_{\text{enc}}&amp;\doteq\max\left(1,\operatorname{KL}\left[q_{%
\phi}\left({z}^{\prime}_{t}\mid{h}^{\prime}_{t},o^{\prime}_{t},{\mathcal{M}}^{%
\prime}_{t}\right)\parallel\operatorname{sg}\left(p_{\phi}\left({z}^{\prime}_{%
t}\mid{h}^{\prime}_{t}\right)\right)\right]\right)\\
\mathcal{L}^{\prime}_{\text{dec}}&amp;\doteq-\operatorname{ln}p_{\phi}\left(o^{%
\prime}_{t},{\mathcal{M}}^{\prime}_{t}\mid{h}^{\prime}_{t},{z}^{\prime}_{t}%
\right)\\
\mathcal{L}^{\prime}_{\text{pred}}&amp;\doteq-\operatorname{ln}p_{\phi}({r}^{%
\prime}_{t},{c}^{\prime}_{t}\mid{h}^{\prime}_{t},{z}^{\prime}_{t})-%
\operatorname{ln}p_{\phi}({{j}}^{\prime}_{t}\mid{h}^{\prime}_{t},{z}^{\prime}_%
{t})\\
\mathcal{L}^{\prime}_{\text{int}}&amp;\doteq-\operatorname{ln}p_{\phi}\left({%
\Delta}^{\prime}_{t},G_{t}^{\prime}\mid h_{t-1},z_{t-1},{h}^{\prime}_{t},{z}^{%
\prime}_{t}\right)\end{aligned}\right.\end{aligned}." class="ltx_math_unparsed" display="block" id="S3.E6.m1.22"><semantics id="S3.E6.m1.22a"><mrow id="S3.E6.m1.22.23.2"><mtable columnspacing="0pt" displaystyle="true" id="S3.E6.m1.22.22" rowspacing="0pt"><mtr id="S3.E6.m1.22.22a"><mtd id="S3.E6.m1.22.22b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.22.22c"><mrow id="S3.E6.m1.10.10.10.10.10"><mtext id="S3.E6.m1.10.10.10.10.10.11">Short-term branch:</mtext><mspace id="S3.E6.m1.10.10.10.10.10.12" width="1em"></mspace><mrow id="S3.E6.m1.10.10.10.10.10.13"><mo id="S3.E6.m1.10.10.10.10.10.13.1">{</mo><mtable columnspacing="0pt" displaystyle="true" id="S3.E6.m1.10.10.10.10.10.10" rowspacing="0pt"><mtr id="S3.E6.m1.10.10.10.10.10.10a"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.10.10.10.10.10.10b"><msub id="S3.E6.m1.3.3.3.3.3.3.3.4.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.3.3.3.3.3.3.3.4.1.2">ℒ</mi><mtext id="S3.E6.m1.3.3.3.3.3.3.3.4.1.3">dyn</mtext></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.10.10.10.10.10.10c"><mrow id="S3.E6.m1.3.3.3.3.3.3.3.3.3"><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.4">≐</mo><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.5">max</mi><mrow id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6"><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.1">(</mo><mn id="S3.E6.m1.2.2.2.2.2.2.2.2.2.2">1</mn><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.2">,</mo><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.3">KL</mi><mrow id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3"><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.1">[</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1">sg</mi><mrow id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2"><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.1">(</mo><msub id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.2"><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.2.2">q</mi><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.2.3">ϕ</mi></msub><mrow id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3"><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.1">(</mo><msub id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.2"><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.2.2">z</mi><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.2.3">t</mi></msub><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.3" lspace="0em" rspace="0.167em">∣</mo><msub id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.4"><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.4.2">h</mi><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.4.3">t</mi></msub><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.5">,</mo><msub id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.6"><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.6.2">o</mi><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.6.3">t</mi></msub><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.7">,</mo><msub id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.8"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.8.2">ℳ</mi><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.8.3">t</mi></msub><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.3.9">)</mo></mrow><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.2.4">)</mo></mrow><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.3" lspace="0em" rspace="0.167em">∥</mo><msub id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.4"><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.4.2">p</mi><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.4.3">ϕ</mi></msub><mrow id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.5"><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.5.1">(</mo><msub id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.5.2"><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.5.2.2">z</mi><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.5.2.3">t</mi></msub><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.5.3" lspace="0em" rspace="0.167em">∣</mo><msub id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.5.4"><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.5.4.2">h</mi><mi id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.5.4.3">t</mi></msub><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.5.5">)</mo></mrow><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.3.6">]</mo></mrow><mo id="S3.E6.m1.3.3.3.3.3.3.3.3.3.6.4">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.10.10.10.10.10.10d"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.10.10.10.10.10.10e"><msub id="S3.E6.m1.5.5.5.5.5.5.5.3.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.5.5.5.5.5.5.5.3.1.2">ℒ</mi><mtext id="S3.E6.m1.5.5.5.5.5.5.5.3.1.3">enc</mtext></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.10.10.10.10.10.10f"><mrow id="S3.E6.m1.5.5.5.5.5.5.5.2.2"><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.3">≐</mo><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.4">max</mi><mrow id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5"><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.1">(</mo><mn id="S3.E6.m1.4.4.4.4.4.4.4.1.1.1">1</mn><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.2">,</mo><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.2">KL</mi><mrow id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3"><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.1">[</mo><msub id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.2"><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.2.2">q</mi><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.2.3">ϕ</mi></msub><mrow id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3"><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.1">(</mo><msub id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.2"><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.2.2">z</mi><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.2.3">t</mi></msub><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.3" lspace="0em" rspace="0.167em">∣</mo><msub id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.4"><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.4.2">h</mi><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.4.3">t</mi></msub><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.5">,</mo><msub id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.6"><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.6.2">o</mi><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.6.3">t</mi></msub><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.7">,</mo><msub id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.8"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.8.2">ℳ</mi><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.8.3">t</mi></msub><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.3.9">)</mo></mrow><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.4" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.5">sg</mi><mrow id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6"><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.1">(</mo><msub id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.2"><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.2.2">p</mi><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.2.3">ϕ</mi></msub><mrow id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.3"><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.3.1">(</mo><msub id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.3.2"><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.3.2.2">z</mi><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.3.2.3">t</mi></msub><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.3.3" lspace="0em" rspace="0.167em">∣</mo><msub id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.3.4"><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.3.4.2">h</mi><mi id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.3.4.3">t</mi></msub><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.3.5">)</mo></mrow><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.6.4">)</mo></mrow><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.3.7">]</mo></mrow><mo id="S3.E6.m1.5.5.5.5.5.5.5.2.2.5.4">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.10.10.10.10.10.10g"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.10.10.10.10.10.10h"><msub id="S3.E6.m1.7.7.7.7.7.7.7.3.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.7.7.7.7.7.7.7.3.1.2">ℒ</mi><mtext id="S3.E6.m1.7.7.7.7.7.7.7.3.1.3">dec</mtext></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.10.10.10.10.10.10i"><mrow id="S3.E6.m1.7.7.7.7.7.7.7.2.2"><mi id="S3.E6.m1.7.7.7.7.7.7.7.2.2.4"></mi><mo id="S3.E6.m1.7.7.7.7.7.7.7.2.2.3">≐</mo><mrow id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2"><mo id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2a" rspace="0.167em">−</mo><mrow id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2"><mrow id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.4"><mi id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.4.1">ln</mi><mo id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.4a" lspace="0.167em">⁡</mo><msub id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.4.2"><mi id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.4.2.2">p</mi><mi id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.4.2.3">ϕ</mi></msub></mrow><mo id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.3">⁢</mo><mrow id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2"><mo id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.3">(</mo><msub id="S3.E6.m1.6.6.6.6.6.6.6.1.1.1.1.1.1.1"><mi id="S3.E6.m1.6.6.6.6.6.6.6.1.1.1.1.1.1.1.2">o</mi><mi id="S3.E6.m1.6.6.6.6.6.6.6.1.1.1.1.1.1.1.3">t</mi></msub><mo id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.4">,</mo><mrow id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2"><msub id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.4"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.4.2">ℳ</mi><mi id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.4.3">t</mi></msub><mo id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.3">∣</mo><mrow id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.2.2"><msub id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.1.1.1"><mi id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.1.1.1.2">h</mi><mi id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.1.1.1.3">t</mi></msub><mo id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.2.2.3">,</mo><msub id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.2.2.2"><mi id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.2.2.2.2">z</mi><mi id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.2.2.2.2.3">t</mi></msub></mrow></mrow><mo id="S3.E6.m1.7.7.7.7.7.7.7.2.2.2.2.2.2.5">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.10.10.10.10.10.10j"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.10.10.10.10.10.10k"><msub id="S3.E6.m1.10.10.10.10.10.10.10.4.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.10.10.10.10.10.10.10.4.1.2">ℒ</mi><mtext id="S3.E6.m1.10.10.10.10.10.10.10.4.1.3">pred</mtext></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.10.10.10.10.10.10l"><mrow id="S3.E6.m1.10.10.10.10.10.10.10.3.3"><mi id="S3.E6.m1.10.10.10.10.10.10.10.3.3.5"></mi><mo id="S3.E6.m1.10.10.10.10.10.10.10.3.3.4">≐</mo><mrow id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3"><mrow id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2"><mo id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2a" rspace="0.167em">−</mo><mrow id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2"><mrow id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.4"><mi id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.4.1">ln</mi><mo id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.4a" lspace="0.167em">⁡</mo><msub id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.4.2"><mi id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.4.2.2">p</mi><mi id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.4.2.3">ϕ</mi></msub></mrow><mo id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.3">⁢</mo><mrow id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2"><mo id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.3">(</mo><msub id="S3.E6.m1.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1"><mi id="S3.E6.m1.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.2">r</mi><mi id="S3.E6.m1.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.3">t</mi></msub><mo id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.4">,</mo><mrow id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2"><msub id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.4"><mi id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.4.2">c</mi><mi id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.4.3">t</mi></msub><mo id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.3">∣</mo><mrow id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.2.2"><msub id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.1.1.1"><mi id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.1.1.1.2">h</mi><mi id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.1.1.1.3">t</mi></msub><mo id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.2.2.3">,</mo><msub id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.2.2.2"><mi id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.2.2.2.2">z</mi><mi id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.2.2.2.2.3">t</mi></msub></mrow></mrow><mo id="S3.E6.m1.9.9.9.9.9.9.9.2.2.2.2.2.2.2.5">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.4">−</mo><mrow id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3"><mrow id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.3"><mi id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.3.1">ln</mi><mo id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.3a" lspace="0.167em">⁡</mo><msub id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.3.2"><mi id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.3.2.2">p</mi><mi id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.3.2.3">ϕ</mi></msub></mrow><mo id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.2">⁢</mo><mrow id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1"><mo id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.2">(</mo><mrow id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1"><msub id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.4"><mi id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.4.2">j</mi><mi id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.4.3">t</mi></msub><mo id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.3">∣</mo><mrow id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.2.2"><msub id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.1.1.1"><mi id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.1.1.1.2">h</mi><mi id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.1.1.1.3">t</mi></msub><mo id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.2.2.3">,</mo><msub id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.2.2.2"><mi id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.2.2.2.2">z</mi><mi id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.1.2.2.2.3">t</mi></msub></mrow></mrow><mo id="S3.E6.m1.10.10.10.10.10.10.10.3.3.3.3.1.1.3">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.22.22d"><mtd id="S3.E6.m1.22.22e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.22.22f"><mrow id="S3.E6.m1.22.22.22.12.12"><mtext id="S3.E6.m1.22.22.22.12.12.13">Long-term branch:</mtext><mspace id="S3.E6.m1.22.22.22.12.12.14" width="1em"></mspace><mrow id="S3.E6.m1.22.22.22.12.12.15"><mo id="S3.E6.m1.22.22.22.12.12.15.1">{</mo><mtable columnspacing="0pt" displaystyle="true" id="S3.E6.m1.22.22.22.12.12.12" rowspacing="0pt"><mtr id="S3.E6.m1.22.22.22.12.12.12a"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.22.22.22.12.12.12b"><msubsup id="S3.E6.m1.13.13.13.3.3.3.3.4.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.13.13.13.3.3.3.3.4.1.2.2">ℒ</mi><mtext id="S3.E6.m1.13.13.13.3.3.3.3.4.1.3">dyn</mtext><mo id="S3.E6.m1.13.13.13.3.3.3.3.4.1.2.3">′</mo></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.22.22.22.12.12.12c"><mrow id="S3.E6.m1.13.13.13.3.3.3.3.3.3"><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.4">≐</mo><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.5">max</mi><mrow id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6"><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.1">(</mo><mn id="S3.E6.m1.12.12.12.2.2.2.2.2.2.2">1</mn><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.2">,</mo><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.3">KL</mi><mrow id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3"><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.1">[</mo><mi id="S3.E6.m1.11.11.11.1.1.1.1.1.1.1">sg</mi><mrow id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2"><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.1">(</mo><msub id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.2"><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.2.2">q</mi><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.2.3">ϕ</mi></msub><mrow id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3"><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.1">(</mo><msubsup id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.2"><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.2.2.2">z</mi><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.2.3">t</mi><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.2.2.3">′</mo></msubsup><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.3" lspace="0em" rspace="0.167em">∣</mo><msubsup id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.4"><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.4.2.2">h</mi><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.4.3">t</mi><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.4.2.3">′</mo></msubsup><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.5">,</mo><msubsup id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.6"><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.6.2.2">o</mi><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.6.3">t</mi><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.6.2.3">′</mo></msubsup><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.7">,</mo><msubsup id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.8"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.8.2.2">ℳ</mi><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.8.3">t</mi><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.8.2.3">′</mo></msubsup><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.3.9">)</mo></mrow><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.2.4">)</mo></mrow><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.3" lspace="0em" rspace="0.167em">∥</mo><msub id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.4"><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.4.2">p</mi><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.4.3">ϕ</mi></msub><mrow id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5"><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.1">(</mo><msubsup id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.2"><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.2.2.2">z</mi><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.2.3">t</mi><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.2.2.3">′</mo></msubsup><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.3" lspace="0em" rspace="0.167em">∣</mo><msubsup id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.4"><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.4.2.2">h</mi><mi id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.4.3">t</mi><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.4.2.3">′</mo></msubsup><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.5.5">)</mo></mrow><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.3.6">]</mo></mrow><mo id="S3.E6.m1.13.13.13.3.3.3.3.3.3.6.4">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.22.22.22.12.12.12d"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.22.22.22.12.12.12e"><msubsup id="S3.E6.m1.15.15.15.5.5.5.5.3.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.15.15.15.5.5.5.5.3.1.2.2">ℒ</mi><mtext id="S3.E6.m1.15.15.15.5.5.5.5.3.1.3">enc</mtext><mo id="S3.E6.m1.15.15.15.5.5.5.5.3.1.2.3">′</mo></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.22.22.22.12.12.12f"><mrow id="S3.E6.m1.15.15.15.5.5.5.5.2.2"><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.3">≐</mo><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.4">max</mi><mrow id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5"><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.1">(</mo><mn id="S3.E6.m1.14.14.14.4.4.4.4.1.1.1">1</mn><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.2">,</mo><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.2">KL</mi><mrow id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3"><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.1">[</mo><msub id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.2"><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.2.2">q</mi><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.2.3">ϕ</mi></msub><mrow id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3"><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.1">(</mo><msubsup id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.2"><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.2.2.2">z</mi><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.2.3">t</mi><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.2.2.3">′</mo></msubsup><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.3" lspace="0em" rspace="0.167em">∣</mo><msubsup id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.4"><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.4.2.2">h</mi><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.4.3">t</mi><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.4.2.3">′</mo></msubsup><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.5">,</mo><msubsup id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.6"><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.6.2.2">o</mi><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.6.3">t</mi><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.6.2.3">′</mo></msubsup><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.7">,</mo><msubsup id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.8"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.8.2.2">ℳ</mi><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.8.3">t</mi><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.8.2.3">′</mo></msubsup><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.3.9">)</mo></mrow><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.4" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.5">sg</mi><mrow id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6"><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.1">(</mo><msub id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.2"><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.2.2">p</mi><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.2.3">ϕ</mi></msub><mrow id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3"><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.1">(</mo><msubsup id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.2"><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.2.2.2">z</mi><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.2.3">t</mi><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.2.2.3">′</mo></msubsup><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.3" lspace="0em" rspace="0.167em">∣</mo><msubsup id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.4"><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.4.2.2">h</mi><mi id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.4.3">t</mi><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.4.2.3">′</mo></msubsup><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.3.5">)</mo></mrow><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.6.4">)</mo></mrow><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.3.7">]</mo></mrow><mo id="S3.E6.m1.15.15.15.5.5.5.5.2.2.5.4">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.22.22.22.12.12.12g"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.22.22.22.12.12.12h"><msubsup id="S3.E6.m1.17.17.17.7.7.7.7.3.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.17.17.17.7.7.7.7.3.1.2.2">ℒ</mi><mtext id="S3.E6.m1.17.17.17.7.7.7.7.3.1.3">dec</mtext><mo id="S3.E6.m1.17.17.17.7.7.7.7.3.1.2.3">′</mo></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.22.22.22.12.12.12i"><mrow id="S3.E6.m1.17.17.17.7.7.7.7.2.2"><mi id="S3.E6.m1.17.17.17.7.7.7.7.2.2.4"></mi><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.3">≐</mo><mrow id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2"><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2a" rspace="0.167em">−</mo><mrow id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2"><mrow id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.4"><mi id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.4.1">ln</mi><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.4a" lspace="0.167em">⁡</mo><msub id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.4.2"><mi id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.4.2.2">p</mi><mi id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.4.2.3">ϕ</mi></msub></mrow><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.3">⁢</mo><mrow id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2"><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.3">(</mo><msubsup id="S3.E6.m1.16.16.16.6.6.6.6.1.1.1.1.1.1.1"><mi id="S3.E6.m1.16.16.16.6.6.6.6.1.1.1.1.1.1.1.2.2">o</mi><mi id="S3.E6.m1.16.16.16.6.6.6.6.1.1.1.1.1.1.1.3">t</mi><mo id="S3.E6.m1.16.16.16.6.6.6.6.1.1.1.1.1.1.1.2.3">′</mo></msubsup><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.4">,</mo><mrow id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2"><msubsup id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.4"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.4.2.2">ℳ</mi><mi id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.4.3">t</mi><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.4.2.3">′</mo></msubsup><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.3">∣</mo><mrow id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.2.2"><msubsup id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.1.1.1"><mi id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.1.1.1.2.2">h</mi><mi id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.1.1.1.3">t</mi><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.1.1.1.2.3">′</mo></msubsup><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.2.2.3">,</mo><msubsup id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.2.2.2"><mi id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.2.2.2.2.2">z</mi><mi id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.2.2.2.3">t</mi><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.2.2.2.2.2.3">′</mo></msubsup></mrow></mrow><mo id="S3.E6.m1.17.17.17.7.7.7.7.2.2.2.2.2.2.5">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.22.22.22.12.12.12j"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.22.22.22.12.12.12k"><msubsup id="S3.E6.m1.20.20.20.10.10.10.10.4.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.20.20.20.10.10.10.10.4.1.2.2">ℒ</mi><mtext id="S3.E6.m1.20.20.20.10.10.10.10.4.1.3">pred</mtext><mo id="S3.E6.m1.20.20.20.10.10.10.10.4.1.2.3">′</mo></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.22.22.22.12.12.12l"><mrow id="S3.E6.m1.20.20.20.10.10.10.10.3.3"><mi id="S3.E6.m1.20.20.20.10.10.10.10.3.3.5"></mi><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.4">≐</mo><mrow id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3"><mrow id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2"><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2a" rspace="0.167em">−</mo><mrow id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2"><mrow id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.4"><mi id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.4.1">ln</mi><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.4a" lspace="0.167em">⁡</mo><msub id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.4.2"><mi id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.4.2.2">p</mi><mi id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.4.2.3">ϕ</mi></msub></mrow><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.3">⁢</mo><mrow id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2"><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.3" stretchy="false">(</mo><msubsup id="S3.E6.m1.18.18.18.8.8.8.8.1.1.1.1.1.1.1.1"><mi id="S3.E6.m1.18.18.18.8.8.8.8.1.1.1.1.1.1.1.1.2.2">r</mi><mi id="S3.E6.m1.18.18.18.8.8.8.8.1.1.1.1.1.1.1.1.3">t</mi><mo id="S3.E6.m1.18.18.18.8.8.8.8.1.1.1.1.1.1.1.1.2.3">′</mo></msubsup><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.4">,</mo><mrow id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2"><msubsup id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.4"><mi id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.4.2.2">c</mi><mi id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.4.3">t</mi><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.4.2.3">′</mo></msubsup><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.3">∣</mo><mrow id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.2.2"><msubsup id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.1.1.1"><mi id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.1.1.1.2.2">h</mi><mi id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.1.1.1.3">t</mi><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.1.1.1.2.3">′</mo></msubsup><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.2.2.3">,</mo><msubsup id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.2.2.2"><mi id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.2.2.2.2.2">z</mi><mi id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.2.2.2.3">t</mi><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.2.2.2.2.2.3">′</mo></msubsup></mrow></mrow><mo id="S3.E6.m1.19.19.19.9.9.9.9.2.2.2.2.2.2.2.5" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.4">−</mo><mrow id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3"><mrow id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.3"><mi id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.3.1">ln</mi><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.3a" lspace="0.167em">⁡</mo><msub id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.3.2"><mi id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.3.2.2">p</mi><mi id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.3.2.3">ϕ</mi></msub></mrow><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.2">⁢</mo><mrow id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1"><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.2" stretchy="false">(</mo><mrow id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1"><msubsup id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.4"><mi id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.4.2.2">j</mi><mi id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.4.3">t</mi><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.4.2.3">′</mo></msubsup><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.3">∣</mo><mrow id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.2.2"><msubsup id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.1.1.1"><mi id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.1.1.1.2.2">h</mi><mi id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.1.1.1.3">t</mi><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.1.1.1.2.3">′</mo></msubsup><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.2.2.3">,</mo><msubsup id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.2.2.2"><mi id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.2.2.2.2.2">z</mi><mi id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.2.2.2.3">t</mi><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.1.2.2.2.2.3">′</mo></msubsup></mrow></mrow><mo id="S3.E6.m1.20.20.20.10.10.10.10.3.3.3.3.1.1.3" stretchy="false">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.22.22.22.12.12.12m"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.22.22.22.12.12.12n"><msubsup id="S3.E6.m1.22.22.22.12.12.12.12.3.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.22.22.22.12.12.12.12.3.1.2.2">ℒ</mi><mtext id="S3.E6.m1.22.22.22.12.12.12.12.3.1.3">int</mtext><mo id="S3.E6.m1.22.22.22.12.12.12.12.3.1.2.3">′</mo></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.22.22.22.12.12.12o"><mrow id="S3.E6.m1.22.22.22.12.12.12.12.2.2"><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.4"></mi><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.3">≐</mo><mrow id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2"><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2a" rspace="0.167em">−</mo><mrow id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2"><mrow id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.4"><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.4.1">ln</mi><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.4a" lspace="0.167em">⁡</mo><msub id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.4.2"><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.4.2.2">p</mi><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.4.2.3">ϕ</mi></msub></mrow><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.3">⁢</mo><mrow id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2"><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.3">(</mo><msubsup id="S3.E6.m1.21.21.21.11.11.11.11.1.1.1.1.1.1.1"><mi id="S3.E6.m1.21.21.21.11.11.11.11.1.1.1.1.1.1.1.2.2" mathvariant="normal">Δ</mi><mi id="S3.E6.m1.21.21.21.11.11.11.11.1.1.1.1.1.1.1.3">t</mi><mo id="S3.E6.m1.21.21.21.11.11.11.11.1.1.1.1.1.1.1.2.3">′</mo></msubsup><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.4">,</mo><mrow id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2"><msubsup id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.6"><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.6.2.2">G</mi><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.6.2.3">t</mi><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.6.3">′</mo></msubsup><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.5">∣</mo><mrow id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.4.4"><msub id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.1.1.1"><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.1.1.1.2">h</mi><mrow id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.1.1.1.3"><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.1.1.1.3.2">t</mi><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.1.1.1.3.1">−</mo><mn id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.1.1.1.3.3">1</mn></mrow></msub><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.4.4.5">,</mo><msub id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.2.2.2"><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.2.2.2.2">z</mi><mrow id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.2.2.2.3"><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.2.2.2.3.2">t</mi><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.2.2.2.3.1">−</mo><mn id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.2.2.2.3.3">1</mn></mrow></msub><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.4.4.6">,</mo><msubsup id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.3.3.3"><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.3.3.3.2.2">h</mi><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.3.3.3.3">t</mi><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.3.3.3.2.3">′</mo></msubsup><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.4.4.7">,</mo><msubsup id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.4.4.4"><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.4.4.4.2.2">z</mi><mi id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.4.4.4.3">t</mi><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.2.4.4.4.2.3">′</mo></msubsup></mrow></mrow><mo id="S3.E6.m1.22.22.22.12.12.12.12.2.2.2.2.2.2.5">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable></mrow></mrow></mtd></mtr></mtable><mo id="S3.E6.m1.22.23.2.1" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E6.m1.22b">\begin{aligned} &amp;\text{Short-term branch:}\quad\left\{\begin{aligned} \mathcal%
{L}_{\text{dyn}}&amp;\doteq\max\left(1,\operatorname{KL}\left[\operatorname{sg}%
\left(q_{\phi}\left(z_{t}\mid h_{t},o_{t},\mathcal{M}_{t}\right)\right)%
\parallel p_{\phi}\left(z_{t}\mid h_{t}\right)\right]\right)\\
\mathcal{L}_{\text{enc}}&amp;\doteq\max\left(1,\operatorname{KL}\left[q_{\phi}%
\left(z_{t}\mid h_{t},o_{t},\mathcal{M}_{t}\right)\parallel\operatorname{sg}%
\left(p_{\phi}\left(z_{t}\mid h_{t}\right)\right)\right]\right)\\
\mathcal{L}_{\text{dec}}&amp;\doteq-\operatorname{ln}p_{\phi}\left(o_{t},\mathcal{%
M}_{t}\mid h_{t},z_{t}\right)\\
\mathcal{L}_{\text{pred}}&amp;\doteq-\operatorname{ln}p_{\phi}\left({r}_{t},{c}_{t%
}\mid h_{t},z_{t}\right)-\operatorname{ln}p_{\phi}\left({j}_{t}\mid h_{t},z_{t%
}\right)\end{aligned}\right.\\
&amp;\text{Long-term branch:}\quad\left\{\begin{aligned} \mathcal{L}^{\prime}_{%
\text{dyn}}&amp;\doteq\max\left(1,\operatorname{KL}\left[\operatorname{sg}\left(q_%
{\phi}\left({z}^{\prime}_{t}\mid{h}^{\prime}_{t},o^{\prime}_{t},{\mathcal{M}}^%
{\prime}_{t}\right)\right)\parallel p_{\phi}\left({z}^{\prime}_{t}\mid{h}^{%
\prime}_{t}\right)\right]\right)\\
\mathcal{L}^{\prime}_{\text{enc}}&amp;\doteq\max\left(1,\operatorname{KL}\left[q_{%
\phi}\left({z}^{\prime}_{t}\mid{h}^{\prime}_{t},o^{\prime}_{t},{\mathcal{M}}^{%
\prime}_{t}\right)\parallel\operatorname{sg}\left(p_{\phi}\left({z}^{\prime}_{%
t}\mid{h}^{\prime}_{t}\right)\right)\right]\right)\\
\mathcal{L}^{\prime}_{\text{dec}}&amp;\doteq-\operatorname{ln}p_{\phi}\left(o^{%
\prime}_{t},{\mathcal{M}}^{\prime}_{t}\mid{h}^{\prime}_{t},{z}^{\prime}_{t}%
\right)\\
\mathcal{L}^{\prime}_{\text{pred}}&amp;\doteq-\operatorname{ln}p_{\phi}({r}^{%
\prime}_{t},{c}^{\prime}_{t}\mid{h}^{\prime}_{t},{z}^{\prime}_{t})-%
\operatorname{ln}p_{\phi}({{j}}^{\prime}_{t}\mid{h}^{\prime}_{t},{z}^{\prime}_%
{t})\\
\mathcal{L}^{\prime}_{\text{int}}&amp;\doteq-\operatorname{ln}p_{\phi}\left({%
\Delta}^{\prime}_{t},G_{t}^{\prime}\mid h_{t-1},z_{t-1},{h}^{\prime}_{t},{z}^{%
\prime}_{t}\right)\end{aligned}\right.\end{aligned}.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.22c">start_ROW start_CELL end_CELL start_CELL Short-term branch: { start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT dyn end_POSTSUBSCRIPT end_CELL start_CELL ≐ roman_max ( 1 , roman_KL [ roman_sg ( italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ∥ italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ] ) end_CELL end_ROW start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT enc end_POSTSUBSCRIPT end_CELL start_CELL ≐ roman_max ( 1 , roman_KL [ italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ∥ roman_sg ( italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ] ) end_CELL end_ROW start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT dec end_POSTSUBSCRIPT end_CELL start_CELL ≐ - roman_ln italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT end_CELL start_CELL ≐ - roman_ln italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - roman_ln italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL Long-term branch: { start_ROW start_CELL caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT dyn end_POSTSUBSCRIPT end_CELL start_CELL ≐ roman_max ( 1 , roman_KL [ roman_sg ( italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ∥ italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ] ) end_CELL end_ROW start_ROW start_CELL caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT enc end_POSTSUBSCRIPT end_CELL start_CELL ≐ roman_max ( 1 , roman_KL [ italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ∥ roman_sg ( italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ] ) end_CELL end_ROW start_ROW start_CELL caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT dec end_POSTSUBSCRIPT end_CELL start_CELL ≐ - roman_ln italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT end_CELL start_CELL ≐ - roman_ln italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - roman_ln italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_j start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT int end_POSTSUBSCRIPT end_CELL start_CELL ≐ - roman_ln italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( roman_Δ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW end_CELL end_ROW .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p4">
<p class="ltx_p" id="S3.SS3.SSS2.p4.2">We can optimize the world model <math alttext="\mathcal{W}_{\phi}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.1.m1.1"><semantics id="S3.SS3.SSS2.p4.1.m1.1a"><msub id="S3.SS3.SSS2.p4.1.m1.1.1" xref="S3.SS3.SSS2.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p4.1.m1.1.1.2" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.cmml">𝒲</mi><mi id="S3.SS3.SSS2.p4.1.m1.1.1.3" xref="S3.SS3.SSS2.p4.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.1.m1.1b"><apply id="S3.SS3.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.2">𝒲</ci><ci id="S3.SS3.SSS2.p4.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.1.m1.1c">\mathcal{W}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.1.m1.1d">caligraphic_W start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> by minimizing over replay buffer <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.2.m2.1"><semantics id="S3.SS3.SSS2.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p4.2.m2.1.1" xref="S3.SS3.SSS2.p4.2.m2.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.2.m2.1b"><ci id="S3.SS3.SSS2.p4.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.2.m2.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.2.m2.1d">caligraphic_B</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E7">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E7X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}\doteq\mathbb{E}\Big{[}" class="ltx_math_unparsed" display="inline" id="S3.E7X.2.1.1.m1.1"><semantics id="S3.E7X.2.1.1.m1.1a"><mrow id="S3.E7X.2.1.1.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.2.1.1.m1.1.1">ℒ</mi><mo id="S3.E7X.2.1.1.m1.1.2">≐</mo><mi id="S3.E7X.2.1.1.m1.1.3">𝔼</mi><mo id="S3.E7X.2.1.1.m1.1.4" maxsize="160%" minsize="160%">[</mo></mrow><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.1c">\displaystyle\mathcal{L}\doteq\mathbb{E}\Big{[}</annotation><annotation encoding="application/x-llamapun" id="S3.E7X.2.1.1.m1.1d">caligraphic_L ≐ blackboard_E [</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle{\textstyle\sum_{\{\mathcal{D}_{t}\}_{t=1}^{T}}}\left(\beta_{%
\text{dyn}}\mathcal{L}_{\text{dyn}}+\beta_{\text{enc}}\mathcal{L}_{\text{enc}}%
+\beta_{\text{pred}}\left(\mathcal{L}_{\text{dec}}+\mathcal{L}_{\text{pred}}%
\right)\right)+" class="ltx_Math" display="inline" id="S3.E7X.3.2.2.m1.2"><semantics id="S3.E7X.3.2.2.m1.2a"><mrow id="S3.E7X.3.2.2.m1.2.2" xref="S3.E7X.3.2.2.m1.2.2.cmml"><mrow id="S3.E7X.3.2.2.m1.2.2.1" xref="S3.E7X.3.2.2.m1.2.2.1.cmml"><msub id="S3.E7X.3.2.2.m1.2.2.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.2.cmml"><mo id="S3.E7X.3.2.2.m1.2.2.1.2.2" xref="S3.E7X.3.2.2.m1.2.2.1.2.2.cmml">∑</mo><msubsup id="S3.E7X.3.2.2.m1.1.1.1" xref="S3.E7X.3.2.2.m1.1.1.1.cmml"><mrow id="S3.E7X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.2.cmml"><mo id="S3.E7X.3.2.2.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E7X.3.2.2.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E7X.3.2.2.m1.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.1.1.1.1.3.cmml"><mi id="S3.E7X.3.2.2.m1.1.1.1.1.3.2" xref="S3.E7X.3.2.2.m1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E7X.3.2.2.m1.1.1.1.1.3.1" xref="S3.E7X.3.2.2.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.E7X.3.2.2.m1.1.1.1.1.3.3" xref="S3.E7X.3.2.2.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E7X.3.2.2.m1.1.1.1.3" xref="S3.E7X.3.2.2.m1.1.1.1.3.cmml">T</mi></msubsup></msub><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.cmml"><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.2" lspace="0em" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.cmml"><msub id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.2.cmml">β</mi><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.3a.cmml">dyn</mtext></msub><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.2.cmml">ℒ</mi><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.3a.cmml">dyn</mtext></msub></mrow><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2.cmml">+</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.cmml"><msub id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.2.cmml">β</mi><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.3a.cmml">enc</mtext></msub><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.1.cmml">⁢</mo><msub id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.2.cmml">ℒ</mi><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.3a.cmml">enc</mtext></msub></mrow><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2a" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2.cmml">+</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.2.cmml">β</mi><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3a.cmml">pred</mtext></msub><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3a.cmml">dec</mtext></msub><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3a.cmml">pred</mtext></msub></mrow><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7X.3.2.2.m1.2.2.3" xref="S3.E7X.3.2.2.m1.2.2.3.cmml">+</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.3.2.2.m1.2b"><apply id="S3.E7X.3.2.2.m1.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2"><csymbol cd="latexml" id="S3.E7X.3.2.2.m1.2.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2">limit-from</csymbol><apply id="S3.E7X.3.2.2.m1.2.2.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1"><apply id="S3.E7X.3.2.2.m1.2.2.1.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.2.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.2">subscript</csymbol><sum id="S3.E7X.3.2.2.m1.2.2.1.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.2.2"></sum><apply id="S3.E7X.3.2.2.m1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.1.1.1">superscript</csymbol><apply id="S3.E7X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.1.1.1">subscript</csymbol><set id="S3.E7X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.1"><apply id="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S3.E7X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.3"><eq id="S3.E7X.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.3.1"></eq><ci id="S3.E7X.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E7X.3.2.2.m1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E7X.3.2.2.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E7X.3.2.2.m1.1.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.3">𝑇</ci></apply></apply><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1"><plus id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2"></plus><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3"><times id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.1"></times><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.2">𝛽</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.3a.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.3"><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.3">dyn</mtext></ci></apply><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.2">ℒ</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.3a.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.3"><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.3">dyn</mtext></ci></apply></apply><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4"><times id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.1"></times><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.2">𝛽</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.3a.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.3"><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.3.cmml" mathsize="70%" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.2.3">enc</mtext></ci></apply><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.2">ℒ</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.3a.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.3"><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.3.cmml" mathsize="70%" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.4.3.3">enc</mtext></ci></apply></apply><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1"><times id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.2"></times><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.2">𝛽</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3a.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3"><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.3.3">pred</mtext></ci></apply><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1"><plus id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">ℒ</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3"><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3">dec</mtext></ci></apply><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3"><mtext id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3">pred</mtext></ci></apply></apply></apply></apply></apply><plus id="S3.E7X.3.2.2.m1.2.2.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.3.2.2.m1.2c">\displaystyle{\textstyle\sum_{\{\mathcal{D}_{t}\}_{t=1}^{T}}}\left(\beta_{%
\text{dyn}}\mathcal{L}_{\text{dyn}}+\beta_{\text{enc}}\mathcal{L}_{\text{enc}}%
+\beta_{\text{pred}}\left(\mathcal{L}_{\text{dec}}+\mathcal{L}_{\text{pred}}%
\right)\right)+</annotation><annotation encoding="application/x-llamapun" id="S3.E7X.3.2.2.m1.2d">∑ start_POSTSUBSCRIPT { caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_β start_POSTSUBSCRIPT dyn end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT dyn end_POSTSUBSCRIPT + italic_β start_POSTSUBSCRIPT enc end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT enc end_POSTSUBSCRIPT + italic_β start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT ( caligraphic_L start_POSTSUBSCRIPT dec end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT ) ) +</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E7Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\beta_{\text{long}}" class="ltx_Math" display="inline" id="S3.E7Xa.2.1.1.m1.1"><semantics id="S3.E7Xa.2.1.1.m1.1a"><msub id="S3.E7Xa.2.1.1.m1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.2.cmml">β</mi><mtext id="S3.E7Xa.2.1.1.m1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.3a.cmml">long</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.E7Xa.2.1.1.m1.1b"><apply id="S3.E7Xa.2.1.1.m1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.2">𝛽</ci><ci id="S3.E7Xa.2.1.1.m1.1.1.3a.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.3"><mtext id="S3.E7Xa.2.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.E7Xa.2.1.1.m1.1.1.3">long</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.2.1.1.m1.1c">\displaystyle\beta_{\text{long}}</annotation><annotation encoding="application/x-llamapun" id="S3.E7Xa.2.1.1.m1.1d">italic_β start_POSTSUBSCRIPT long end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle{\textstyle\sum_{{\{\mathcal{D}}^{\prime}_{t}\}_{t\in\mathcal{T}}%
}}\left(\beta_{\text{dyn}}\mathcal{L}^{\prime}_{\text{dyn}}+\beta_{\text{enc}}%
\mathcal{L}^{\prime}_{\text{enc}}+\beta_{\text{pred}}\left(\mathcal{L}^{\prime%
}_{\text{dec}}+\mathcal{L}^{\prime}_{\text{pred}}+\mathcal{L}^{\prime}_{\text{%
int}}\right)\right)\Big{]}." class="ltx_math_unparsed" display="inline" id="S3.E7Xa.3.2.2.m1.1"><semantics id="S3.E7Xa.3.2.2.m1.1a"><mrow id="S3.E7Xa.3.2.2.m1.1b"><msub id="S3.E7Xa.3.2.2.m1.1.2"><mo id="S3.E7Xa.3.2.2.m1.1.2.2">∑</mo><msub id="S3.E7Xa.3.2.2.m1.1.1.1"><mrow id="S3.E7Xa.3.2.2.m1.1.1.1.1.1"><mo id="S3.E7Xa.3.2.2.m1.1.1.1.1.1.2" stretchy="false">{</mo><msubsup id="S3.E7Xa.3.2.2.m1.1.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2">𝒟</mi><mi id="S3.E7Xa.3.2.2.m1.1.1.1.1.1.1.3">t</mi><mo id="S3.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.3">′</mo></msubsup><mo id="S3.E7Xa.3.2.2.m1.1.1.1.1.1.3" stretchy="false">}</mo></mrow><mrow id="S3.E7Xa.3.2.2.m1.1.1.1.3"><mi id="S3.E7Xa.3.2.2.m1.1.1.1.3.2">t</mi><mo id="S3.E7Xa.3.2.2.m1.1.1.1.3.1">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.3.2.2.m1.1.1.1.3.3">𝒯</mi></mrow></msub></msub><mrow id="S3.E7Xa.3.2.2.m1.1.3"><mo id="S3.E7Xa.3.2.2.m1.1.3.1" lspace="0em">(</mo><msub id="S3.E7Xa.3.2.2.m1.1.3.2"><mi id="S3.E7Xa.3.2.2.m1.1.3.2.2">β</mi><mtext id="S3.E7Xa.3.2.2.m1.1.3.2.3">dyn</mtext></msub><msubsup id="S3.E7Xa.3.2.2.m1.1.3.3"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.3.2.2.m1.1.3.3.2.2">ℒ</mi><mtext id="S3.E7Xa.3.2.2.m1.1.3.3.3">dyn</mtext><mo id="S3.E7Xa.3.2.2.m1.1.3.3.2.3">′</mo></msubsup><mo id="S3.E7Xa.3.2.2.m1.1.3.4">+</mo><msub id="S3.E7Xa.3.2.2.m1.1.3.5"><mi id="S3.E7Xa.3.2.2.m1.1.3.5.2">β</mi><mtext id="S3.E7Xa.3.2.2.m1.1.3.5.3">enc</mtext></msub><msubsup id="S3.E7Xa.3.2.2.m1.1.3.6"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.3.2.2.m1.1.3.6.2.2">ℒ</mi><mtext id="S3.E7Xa.3.2.2.m1.1.3.6.3">enc</mtext><mo id="S3.E7Xa.3.2.2.m1.1.3.6.2.3">′</mo></msubsup><mo id="S3.E7Xa.3.2.2.m1.1.3.7">+</mo><msub id="S3.E7Xa.3.2.2.m1.1.3.8"><mi id="S3.E7Xa.3.2.2.m1.1.3.8.2">β</mi><mtext id="S3.E7Xa.3.2.2.m1.1.3.8.3">pred</mtext></msub><mrow id="S3.E7Xa.3.2.2.m1.1.3.9"><mo id="S3.E7Xa.3.2.2.m1.1.3.9.1">(</mo><msubsup id="S3.E7Xa.3.2.2.m1.1.3.9.2"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.3.2.2.m1.1.3.9.2.2.2">ℒ</mi><mtext id="S3.E7Xa.3.2.2.m1.1.3.9.2.3">dec</mtext><mo id="S3.E7Xa.3.2.2.m1.1.3.9.2.2.3">′</mo></msubsup><mo id="S3.E7Xa.3.2.2.m1.1.3.9.3">+</mo><msubsup id="S3.E7Xa.3.2.2.m1.1.3.9.4"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.3.2.2.m1.1.3.9.4.2.2">ℒ</mi><mtext id="S3.E7Xa.3.2.2.m1.1.3.9.4.3">pred</mtext><mo id="S3.E7Xa.3.2.2.m1.1.3.9.4.2.3">′</mo></msubsup><mo id="S3.E7Xa.3.2.2.m1.1.3.9.5">+</mo><msubsup id="S3.E7Xa.3.2.2.m1.1.3.9.6"><mi class="ltx_font_mathcaligraphic" id="S3.E7Xa.3.2.2.m1.1.3.9.6.2.2">ℒ</mi><mtext id="S3.E7Xa.3.2.2.m1.1.3.9.6.3">int</mtext><mo id="S3.E7Xa.3.2.2.m1.1.3.9.6.2.3">′</mo></msubsup><mo id="S3.E7Xa.3.2.2.m1.1.3.9.7">)</mo></mrow><mo id="S3.E7Xa.3.2.2.m1.1.3.10">)</mo></mrow><mo id="S3.E7Xa.3.2.2.m1.1.4" maxsize="160%" minsize="160%">]</mo><mo id="S3.E7Xa.3.2.2.m1.1.5" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E7Xa.3.2.2.m1.1c">\displaystyle{\textstyle\sum_{{\{\mathcal{D}}^{\prime}_{t}\}_{t\in\mathcal{T}}%
}}\left(\beta_{\text{dyn}}\mathcal{L}^{\prime}_{\text{dyn}}+\beta_{\text{enc}}%
\mathcal{L}^{\prime}_{\text{enc}}+\beta_{\text{pred}}\left(\mathcal{L}^{\prime%
}_{\text{dec}}+\mathcal{L}^{\prime}_{\text{pred}}+\mathcal{L}^{\prime}_{\text{%
int}}\right)\right)\Big{]}.</annotation><annotation encoding="application/x-llamapun" id="S3.E7Xa.3.2.2.m1.1d">∑ start_POSTSUBSCRIPT { caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t ∈ caligraphic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_β start_POSTSUBSCRIPT dyn end_POSTSUBSCRIPT caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT dyn end_POSTSUBSCRIPT + italic_β start_POSTSUBSCRIPT enc end_POSTSUBSCRIPT caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT enc end_POSTSUBSCRIPT + italic_β start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT ( caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT dec end_POSTSUBSCRIPT + caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT + caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT int end_POSTSUBSCRIPT ) ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Behavior Learning over Mixed Long Short-Term Imaginations</h3>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.F3" title="Figure 3 ‣ 3.3.2 Learning Jumpy State Transitions ‣ 3.3 Long Short-Term World Model ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">3</span></a> (b), LS-Imagine employs the actor-critic algorithm to learn behavior on the latent state sequences predicted by the world model.
The goal of the actor is to optimize the policy to maximize the discounted cumulative reward <math alttext="R_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">R</mi><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝑅</ci><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">R_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, while the role of the critic is to estimate the discounted cumulative rewards using the current policy for each state:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Actor:}\quad a_{t}\sim\pi_{\theta}\left(a_{t}\mid h_{t},\hat{z}_{t}%
\right),\quad\text{Critic:}\quad v_{\psi}\left(R_{t}\mid h_{t},\hat{z}_{t}%
\right)." class="ltx_Math" display="block" id="S3.E8.m1.3"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.3.1"><mrow id="S3.E8.m1.3.3.1.1.2" xref="S3.E8.m1.3.3.1.1.3.cmml"><mrow id="S3.E8.m1.3.3.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.2.cmml"><mtext id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1a.cmml">Actor:</mtext><mspace id="S3.E8.m1.3.3.1.1.1.1.1.1.2" width="1em" xref="S3.E8.m1.3.3.1.1.1.1.1.2.cmml"></mspace><msub id="S3.E8.m1.3.3.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml">a</mi><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E8.m1.3.3.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.3.cmml">∼</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml"><msub id="S3.E8.m1.3.3.1.1.1.1.2.3" xref="S3.E8.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.2.3.2" xref="S3.E8.m1.3.3.1.1.1.1.2.3.2.cmml">π</mi><mi id="S3.E8.m1.3.3.1.1.1.1.2.3.3" xref="S3.E8.m1.3.3.1.1.1.1.2.3.3.cmml">θ</mi></msub><mo id="S3.E8.m1.3.3.1.1.1.1.2.2" xref="S3.E8.m1.3.3.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.2.1.1" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E8.m1.3.3.1.1.1.1.2.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.cmml"><msub id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.2" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.2.cmml">a</mi><mi id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.3" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.3.cmml">∣</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.3.cmml"><msub id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.3" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.3.cmml">,</mo><msub id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2.2" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2.2.cmml">z</mi><mo id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2.1" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.3" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E8.m1.3.3.1.1.1.1.2.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.3.3.1.1.2.3" rspace="1.167em" xref="S3.E8.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E8.m1.3.3.1.1.2.2.1" xref="S3.E8.m1.3.3.1.1.2.2.2.cmml"><mtext id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2a.cmml">Critic:</mtext><mspace id="S3.E8.m1.3.3.1.1.2.2.1.2" width="1em" xref="S3.E8.m1.3.3.1.1.2.2.2.cmml"></mspace><mrow id="S3.E8.m1.3.3.1.1.2.2.1.1" xref="S3.E8.m1.3.3.1.1.2.2.1.1.cmml"><msub id="S3.E8.m1.3.3.1.1.2.2.1.1.3" xref="S3.E8.m1.3.3.1.1.2.2.1.1.3.cmml"><mi id="S3.E8.m1.3.3.1.1.2.2.1.1.3.2" xref="S3.E8.m1.3.3.1.1.2.2.1.1.3.2.cmml">v</mi><mi id="S3.E8.m1.3.3.1.1.2.2.1.1.3.3" xref="S3.E8.m1.3.3.1.1.2.2.1.1.3.3.cmml">ψ</mi></msub><mo id="S3.E8.m1.3.3.1.1.2.2.1.1.2" xref="S3.E8.m1.3.3.1.1.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.cmml"><mo id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.cmml"><msub id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.cmml"><mi id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.2" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.2.cmml">R</mi><mi id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.3" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.3.cmml"><msub id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.3" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2.2" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2.2.cmml">z</mi><mo id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2.1" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.3" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.3.3.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.3a.cmml" xref="S3.E8.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.3.3.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.3.3.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3">similar-to</csymbol><list id="S3.E8.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1"><ci id="S3.E8.m1.1.1a.cmml" xref="S3.E8.m1.1.1"><mtext id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">Actor:</mtext></ci><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3">𝑡</ci></apply></list><apply id="S3.E8.m1.3.3.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2"><times id="S3.E8.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.2"></times><apply id="S3.E8.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.3.2">𝜋</ci><ci id="S3.E8.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.3.3">𝜃</ci></apply><apply id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.3">conditional</csymbol><apply id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.2">𝑎</ci><ci id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.4.3">𝑡</ci></apply><list id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2"><apply id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2"><ci id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2.1">^</ci><ci id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.2.2">𝑧</ci></apply><ci id="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply><list id="S3.E8.m1.3.3.1.1.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1"><ci id="S3.E8.m1.2.2a.cmml" xref="S3.E8.m1.2.2"><mtext id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">Critic:</mtext></ci><apply id="S3.E8.m1.3.3.1.1.2.2.1.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1"><times id="S3.E8.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.2"></times><apply id="S3.E8.m1.3.3.1.1.2.2.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.3">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.2.2.1.1.3.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.3.2">𝑣</ci><ci id="S3.E8.m1.3.3.1.1.2.2.1.1.3.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.3.3">𝜓</ci></apply><apply id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.2">𝑅</ci><ci id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2"><apply id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2"><ci id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.2.2">𝑧</ci></apply><ci id="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E8.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">\text{Actor:}\quad a_{t}\sim\pi_{\theta}\left(a_{t}\mid h_{t},\hat{z}_{t}%
\right),\quad\text{Critic:}\quad v_{\psi}\left(R_{t}\mid h_{t},\hat{z}_{t}%
\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.3d">Actor: italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , Critic: italic_v start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.6">Starting from the initial state encoded from the sampled observation and the affordance map, we dynamically select either the long-term transition model or the short-term transition model to predict subsequent states based on the jumping flag <math alttext="\hat{j}_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m1.1"><semantics id="S3.SS4.p1.2.m1.1a"><msub id="S3.SS4.p1.2.m1.1.1" xref="S3.SS4.p1.2.m1.1.1.cmml"><mover accent="true" id="S3.SS4.p1.2.m1.1.1.2" xref="S3.SS4.p1.2.m1.1.1.2.cmml"><mi id="S3.SS4.p1.2.m1.1.1.2.2" xref="S3.SS4.p1.2.m1.1.1.2.2.cmml">j</mi><mo id="S3.SS4.p1.2.m1.1.1.2.1" xref="S3.SS4.p1.2.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.2.m1.1.1.3" xref="S3.SS4.p1.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m1.1b"><apply id="S3.SS4.p1.2.m1.1.1.cmml" xref="S3.SS4.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m1.1.1.1.cmml" xref="S3.SS4.p1.2.m1.1.1">subscript</csymbol><apply id="S3.SS4.p1.2.m1.1.1.2.cmml" xref="S3.SS4.p1.2.m1.1.1.2"><ci id="S3.SS4.p1.2.m1.1.1.2.1.cmml" xref="S3.SS4.p1.2.m1.1.1.2.1">^</ci><ci id="S3.SS4.p1.2.m1.1.1.2.2.cmml" xref="S3.SS4.p1.2.m1.1.1.2.2">𝑗</ci></apply><ci id="S3.SS4.p1.2.m1.1.1.3.cmml" xref="S3.SS4.p1.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m1.1c">\hat{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m1.1d">over^ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
For the long short-term imagination sequence <math alttext="\{(h_{t},\hat{z}_{t},a_{t})\}_{t=1}^{L}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m2.1"><semantics id="S3.SS4.p1.3.m2.1a"><msubsup id="S3.SS4.p1.3.m2.1.1" xref="S3.SS4.p1.3.m2.1.1.cmml"><mrow id="S3.SS4.p1.3.m2.1.1.1.1.1" xref="S3.SS4.p1.3.m2.1.1.1.1.2.cmml"><mo id="S3.SS4.p1.3.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p1.3.m2.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.4.cmml"><mo id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.4" stretchy="false" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.4.cmml">(</mo><msub id="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.5" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2.2" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2.2.cmml">z</mi><mo id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2.1" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.3" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.3.cmml">t</mi></msub><mo id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.6" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.2" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.2.cmml">a</mi><mi id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.3" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.3.cmml">t</mi></msub><mo id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.7" stretchy="false" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="S3.SS4.p1.3.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p1.3.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS4.p1.3.m2.1.1.1.3" xref="S3.SS4.p1.3.m2.1.1.1.3.cmml"><mi id="S3.SS4.p1.3.m2.1.1.1.3.2" xref="S3.SS4.p1.3.m2.1.1.1.3.2.cmml">t</mi><mo id="S3.SS4.p1.3.m2.1.1.1.3.1" xref="S3.SS4.p1.3.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.SS4.p1.3.m2.1.1.1.3.3" xref="S3.SS4.p1.3.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS4.p1.3.m2.1.1.3" xref="S3.SS4.p1.3.m2.1.1.3.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m2.1b"><apply id="S3.SS4.p1.3.m2.1.1.cmml" xref="S3.SS4.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m2.1.1.2.cmml" xref="S3.SS4.p1.3.m2.1.1">superscript</csymbol><apply id="S3.SS4.p1.3.m2.1.1.1.cmml" xref="S3.SS4.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m2.1.1.1.2.cmml" xref="S3.SS4.p1.3.m2.1.1">subscript</csymbol><set id="S3.SS4.p1.3.m2.1.1.1.1.2.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1"><vector id="S3.SS4.p1.3.m2.1.1.1.1.1.1.4.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.3"><apply id="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2"><ci id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.2.2">𝑧</ci></apply><ci id="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><apply id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.2">𝑎</ci><ci id="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS4.p1.3.m2.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></vector></set><apply id="S3.SS4.p1.3.m2.1.1.1.3.cmml" xref="S3.SS4.p1.3.m2.1.1.1.3"><eq id="S3.SS4.p1.3.m2.1.1.1.3.1.cmml" xref="S3.SS4.p1.3.m2.1.1.1.3.1"></eq><ci id="S3.SS4.p1.3.m2.1.1.1.3.2.cmml" xref="S3.SS4.p1.3.m2.1.1.1.3.2">𝑡</ci><cn id="S3.SS4.p1.3.m2.1.1.1.3.3.cmml" type="integer" xref="S3.SS4.p1.3.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS4.p1.3.m2.1.1.3.cmml" xref="S3.SS4.p1.3.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m2.1c">\{(h_{t},\hat{z}_{t},a_{t})\}_{t=1}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m2.1d">{ ( italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> with an imagination horizon of <math alttext="L" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m3.1"><semantics id="S3.SS4.p1.4.m3.1a"><mi id="S3.SS4.p1.4.m3.1.1" xref="S3.SS4.p1.4.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m3.1b"><ci id="S3.SS4.p1.4.m3.1.1.cmml" xref="S3.SS4.p1.4.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m3.1d">italic_L</annotation></semantics></math>, we predict reward sequence <math alttext="\hat{r}_{1:L}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m4.1"><semantics id="S3.SS4.p1.5.m4.1a"><msub id="S3.SS4.p1.5.m4.1.1" xref="S3.SS4.p1.5.m4.1.1.cmml"><mover accent="true" id="S3.SS4.p1.5.m4.1.1.2" xref="S3.SS4.p1.5.m4.1.1.2.cmml"><mi id="S3.SS4.p1.5.m4.1.1.2.2" xref="S3.SS4.p1.5.m4.1.1.2.2.cmml">r</mi><mo id="S3.SS4.p1.5.m4.1.1.2.1" xref="S3.SS4.p1.5.m4.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p1.5.m4.1.1.3" xref="S3.SS4.p1.5.m4.1.1.3.cmml"><mn id="S3.SS4.p1.5.m4.1.1.3.2" xref="S3.SS4.p1.5.m4.1.1.3.2.cmml">1</mn><mo id="S3.SS4.p1.5.m4.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS4.p1.5.m4.1.1.3.1.cmml">:</mo><mi id="S3.SS4.p1.5.m4.1.1.3.3" xref="S3.SS4.p1.5.m4.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m4.1b"><apply id="S3.SS4.p1.5.m4.1.1.cmml" xref="S3.SS4.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m4.1.1.1.cmml" xref="S3.SS4.p1.5.m4.1.1">subscript</csymbol><apply id="S3.SS4.p1.5.m4.1.1.2.cmml" xref="S3.SS4.p1.5.m4.1.1.2"><ci id="S3.SS4.p1.5.m4.1.1.2.1.cmml" xref="S3.SS4.p1.5.m4.1.1.2.1">^</ci><ci id="S3.SS4.p1.5.m4.1.1.2.2.cmml" xref="S3.SS4.p1.5.m4.1.1.2.2">𝑟</ci></apply><apply id="S3.SS4.p1.5.m4.1.1.3.cmml" xref="S3.SS4.p1.5.m4.1.1.3"><ci id="S3.SS4.p1.5.m4.1.1.3.1.cmml" xref="S3.SS4.p1.5.m4.1.1.3.1">:</ci><cn id="S3.SS4.p1.5.m4.1.1.3.2.cmml" type="integer" xref="S3.SS4.p1.5.m4.1.1.3.2">1</cn><ci id="S3.SS4.p1.5.m4.1.1.3.3.cmml" xref="S3.SS4.p1.5.m4.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m4.1c">\hat{r}_{1:L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m4.1d">over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT</annotation></semantics></math> and the continuation flag sequence <math alttext="\hat{c}_{1:L}" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m5.1"><semantics id="S3.SS4.p1.6.m5.1a"><msub id="S3.SS4.p1.6.m5.1.1" xref="S3.SS4.p1.6.m5.1.1.cmml"><mover accent="true" id="S3.SS4.p1.6.m5.1.1.2" xref="S3.SS4.p1.6.m5.1.1.2.cmml"><mi id="S3.SS4.p1.6.m5.1.1.2.2" xref="S3.SS4.p1.6.m5.1.1.2.2.cmml">c</mi><mo id="S3.SS4.p1.6.m5.1.1.2.1" xref="S3.SS4.p1.6.m5.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS4.p1.6.m5.1.1.3" xref="S3.SS4.p1.6.m5.1.1.3.cmml"><mn id="S3.SS4.p1.6.m5.1.1.3.2" xref="S3.SS4.p1.6.m5.1.1.3.2.cmml">1</mn><mo id="S3.SS4.p1.6.m5.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS4.p1.6.m5.1.1.3.1.cmml">:</mo><mi id="S3.SS4.p1.6.m5.1.1.3.3" xref="S3.SS4.p1.6.m5.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m5.1b"><apply id="S3.SS4.p1.6.m5.1.1.cmml" xref="S3.SS4.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m5.1.1.1.cmml" xref="S3.SS4.p1.6.m5.1.1">subscript</csymbol><apply id="S3.SS4.p1.6.m5.1.1.2.cmml" xref="S3.SS4.p1.6.m5.1.1.2"><ci id="S3.SS4.p1.6.m5.1.1.2.1.cmml" xref="S3.SS4.p1.6.m5.1.1.2.1">^</ci><ci id="S3.SS4.p1.6.m5.1.1.2.2.cmml" xref="S3.SS4.p1.6.m5.1.1.2.2">𝑐</ci></apply><apply id="S3.SS4.p1.6.m5.1.1.3.cmml" xref="S3.SS4.p1.6.m5.1.1.3"><ci id="S3.SS4.p1.6.m5.1.1.3.1.cmml" xref="S3.SS4.p1.6.m5.1.1.3.1">:</ci><cn id="S3.SS4.p1.6.m5.1.1.3.2.cmml" type="integer" xref="S3.SS4.p1.6.m5.1.1.3.2">1</cn><ci id="S3.SS4.p1.6.m5.1.1.3.3.cmml" xref="S3.SS4.p1.6.m5.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m5.1c">\hat{c}_{1:L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m5.1d">over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT 1 : italic_L end_POSTSUBSCRIPT</annotation></semantics></math> through the reward predictor.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.5">For jumpy states predicted by long-term imagination, the interval predictor estimates the number of steps <math alttext="\hat{\Delta}_{t}" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><msub id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mover accent="true" id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2.2" mathvariant="normal" xref="S3.SS4.p2.1.m1.1.1.2.2.cmml">Δ</mi><mo id="S3.SS4.p2.1.m1.1.1.2.1" xref="S3.SS4.p2.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">subscript</csymbol><apply id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2"><ci id="S3.SS4.p2.1.m1.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1.2.1">^</ci><ci id="S3.SS4.p2.1.m1.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2.2">Δ</ci></apply><ci id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\hat{\Delta}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">over^ start_ARG roman_Δ end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> between it and the previous state, as well as the potential discounted cumulative reward <math alttext="\hat{G}_{t}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1"><semantics id="S3.SS4.p2.2.m2.1a"><msub id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mover accent="true" id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml"><mi id="S3.SS4.p2.2.m2.1.1.2.2" xref="S3.SS4.p2.2.m2.1.1.2.2.cmml">G</mi><mo id="S3.SS4.p2.2.m2.1.1.2.1" xref="S3.SS4.p2.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2"><ci id="S3.SS4.p2.2.m2.1.1.2.1.cmml" xref="S3.SS4.p2.2.m2.1.1.2.1">^</ci><ci id="S3.SS4.p2.2.m2.1.1.2.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2.2">𝐺</ci></apply><ci id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">\hat{G}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.1d">over^ start_ARG italic_G end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> during this period.
Specifically, for instant states from short-term imagination, we set <math alttext="\hat{\Delta}_{t}=1" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.1"><semantics id="S3.SS4.p2.3.m3.1a"><mrow id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><msub id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml"><mover accent="true" id="S3.SS4.p2.3.m3.1.1.2.2" xref="S3.SS4.p2.3.m3.1.1.2.2.cmml"><mi id="S3.SS4.p2.3.m3.1.1.2.2.2" mathvariant="normal" xref="S3.SS4.p2.3.m3.1.1.2.2.2.cmml">Δ</mi><mo id="S3.SS4.p2.3.m3.1.1.2.2.1" xref="S3.SS4.p2.3.m3.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS4.p2.3.m3.1.1.2.3" xref="S3.SS4.p2.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS4.p2.3.m3.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><eq id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1"></eq><apply id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.2.1.cmml" xref="S3.SS4.p2.3.m3.1.1.2">subscript</csymbol><apply id="S3.SS4.p2.3.m3.1.1.2.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2.2"><ci id="S3.SS4.p2.3.m3.1.1.2.2.1.cmml" xref="S3.SS4.p2.3.m3.1.1.2.2.1">^</ci><ci id="S3.SS4.p2.3.m3.1.1.2.2.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2.2.2">Δ</ci></apply><ci id="S3.SS4.p2.3.m3.1.1.2.3.cmml" xref="S3.SS4.p2.3.m3.1.1.2.3">𝑡</ci></apply><cn id="S3.SS4.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS4.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">\hat{\Delta}_{t}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m3.1d">over^ start_ARG roman_Δ end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = 1</annotation></semantics></math> and <math alttext="\hat{G}_{t}=\hat{r}_{t}" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m4.1"><semantics id="S3.SS4.p2.4.m4.1a"><mrow id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml"><msub id="S3.SS4.p2.4.m4.1.1.2" xref="S3.SS4.p2.4.m4.1.1.2.cmml"><mover accent="true" id="S3.SS4.p2.4.m4.1.1.2.2" xref="S3.SS4.p2.4.m4.1.1.2.2.cmml"><mi id="S3.SS4.p2.4.m4.1.1.2.2.2" xref="S3.SS4.p2.4.m4.1.1.2.2.2.cmml">G</mi><mo id="S3.SS4.p2.4.m4.1.1.2.2.1" xref="S3.SS4.p2.4.m4.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS4.p2.4.m4.1.1.2.3" xref="S3.SS4.p2.4.m4.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS4.p2.4.m4.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.cmml">=</mo><msub id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3.cmml"><mover accent="true" id="S3.SS4.p2.4.m4.1.1.3.2" xref="S3.SS4.p2.4.m4.1.1.3.2.cmml"><mi id="S3.SS4.p2.4.m4.1.1.3.2.2" xref="S3.SS4.p2.4.m4.1.1.3.2.2.cmml">r</mi><mo id="S3.SS4.p2.4.m4.1.1.3.2.1" xref="S3.SS4.p2.4.m4.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS4.p2.4.m4.1.1.3.3" xref="S3.SS4.p2.4.m4.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1"><eq id="S3.SS4.p2.4.m4.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1"></eq><apply id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.2.1.cmml" xref="S3.SS4.p2.4.m4.1.1.2">subscript</csymbol><apply id="S3.SS4.p2.4.m4.1.1.2.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2.2"><ci id="S3.SS4.p2.4.m4.1.1.2.2.1.cmml" xref="S3.SS4.p2.4.m4.1.1.2.2.1">^</ci><ci id="S3.SS4.p2.4.m4.1.1.2.2.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2.2.2">𝐺</ci></apply><ci id="S3.SS4.p2.4.m4.1.1.2.3.cmml" xref="S3.SS4.p2.4.m4.1.1.2.3">𝑡</ci></apply><apply id="S3.SS4.p2.4.m4.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.3.1.cmml" xref="S3.SS4.p2.4.m4.1.1.3">subscript</csymbol><apply id="S3.SS4.p2.4.m4.1.1.3.2.cmml" xref="S3.SS4.p2.4.m4.1.1.3.2"><ci id="S3.SS4.p2.4.m4.1.1.3.2.1.cmml" xref="S3.SS4.p2.4.m4.1.1.3.2.1">^</ci><ci id="S3.SS4.p2.4.m4.1.1.3.2.2.cmml" xref="S3.SS4.p2.4.m4.1.1.3.2.2">𝑟</ci></apply><ci id="S3.SS4.p2.4.m4.1.1.3.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">\hat{G}_{t}=\hat{r}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.4.m4.1d">over^ start_ARG italic_G end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
We employ a modified bootstrapped <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS4.p2.5.m5.1"><semantics id="S3.SS4.p2.5.m5.1a"><mi id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><ci id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.5.m5.1d">italic_λ</annotation></semantics></math>-returns that considers both long-term and short-term imaginations to calculate the discounted cumulative rewards for each state:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{t}^{\lambda}\doteq\left\{\begin{array}[]{ll}\hat{c}_{t}\{\hat{G}_{t+1}+%
\gamma^{\hat{\Delta}_{t+1}}\left[(1-\lambda)v_{\psi}(h_{t+1},\hat{z}_{t+1})+%
\lambda R_{t+1}^{\lambda}\right]\}&amp;\text{if }t&lt;L\\
v_{\psi}(h_{L},\hat{z}_{L})&amp;\text{if }t=L\end{array}\right.." class="ltx_Math" display="block" id="S3.E9.m1.4"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.4.1" xref="S3.E9.m1.4.4.1.1.cmml"><mrow id="S3.E9.m1.4.4.1.1" xref="S3.E9.m1.4.4.1.1.cmml"><msubsup id="S3.E9.m1.4.4.1.1.2" xref="S3.E9.m1.4.4.1.1.2.cmml"><mi id="S3.E9.m1.4.4.1.1.2.2.2" xref="S3.E9.m1.4.4.1.1.2.2.2.cmml">R</mi><mi id="S3.E9.m1.4.4.1.1.2.2.3" xref="S3.E9.m1.4.4.1.1.2.2.3.cmml">t</mi><mi id="S3.E9.m1.4.4.1.1.2.3" xref="S3.E9.m1.4.4.1.1.2.3.cmml">λ</mi></msubsup><mo id="S3.E9.m1.4.4.1.1.1" xref="S3.E9.m1.4.4.1.1.1.cmml">≐</mo><mrow id="S3.E9.m1.4.4.1.1.3.2" xref="S3.E9.m1.4.4.1.1.3.1.cmml"><mo id="S3.E9.m1.4.4.1.1.3.2.1" xref="S3.E9.m1.4.4.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E9.m1.3.3" rowspacing="0pt" xref="S3.E9.m1.3.3.cmml"><mtr id="S3.E9.m1.3.3a" xref="S3.E9.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.3.3b" xref="S3.E9.m1.3.3.cmml"><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.1.3.2.2.cmml">c</mi><mo id="S3.E9.m1.1.1.1.1.1.3.2.1" xref="S3.E9.m1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">G</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">γ</mi><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.2" mathvariant="normal" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">Δ</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml">^</mo></mover><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mn id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></msup><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">⁢</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2.cmml">v</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.3.cmml">ψ</mi></msub><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4a" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">⁢</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">(</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml">h</mi><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2.cmml">t</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1.cmml">+</mo><mn id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">,</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2.2.cmml">z</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.2.cmml">t</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.1.cmml">+</mo><mn id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.5" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml">λ</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml">⁢</mo><msubsup id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.2.cmml">R</mi><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.2.cmml">t</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.1.cmml">+</mo><mn id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.3.cmml">λ</mi></msubsup></mrow></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.3.3c" xref="S3.E9.m1.3.3.cmml"><mrow id="S3.E9.m1.1.1.1.2.1" xref="S3.E9.m1.1.1.1.2.1.cmml"><mrow id="S3.E9.m1.1.1.1.2.1.2" xref="S3.E9.m1.1.1.1.2.1.2.cmml"><mtext id="S3.E9.m1.1.1.1.2.1.2.2" xref="S3.E9.m1.1.1.1.2.1.2.2a.cmml">if </mtext><mo id="S3.E9.m1.1.1.1.2.1.2.1" xref="S3.E9.m1.1.1.1.2.1.2.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.1.2.1.2.3" xref="S3.E9.m1.1.1.1.2.1.2.3.cmml">t</mi></mrow><mo id="S3.E9.m1.1.1.1.2.1.1" xref="S3.E9.m1.1.1.1.2.1.1.cmml">&lt;</mo><mi id="S3.E9.m1.1.1.1.2.1.3" xref="S3.E9.m1.1.1.1.2.1.3.cmml">L</mi></mrow></mtd></mtr><mtr id="S3.E9.m1.3.3d" xref="S3.E9.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.3.3e" xref="S3.E9.m1.3.3.cmml"><mrow id="S3.E9.m1.3.3.3.2.2" xref="S3.E9.m1.3.3.3.2.2.cmml"><msub id="S3.E9.m1.3.3.3.2.2.4" xref="S3.E9.m1.3.3.3.2.2.4.cmml"><mi id="S3.E9.m1.3.3.3.2.2.4.2" xref="S3.E9.m1.3.3.3.2.2.4.2.cmml">v</mi><mi id="S3.E9.m1.3.3.3.2.2.4.3" xref="S3.E9.m1.3.3.3.2.2.4.3.cmml">ψ</mi></msub><mo id="S3.E9.m1.3.3.3.2.2.3" xref="S3.E9.m1.3.3.3.2.2.3.cmml">⁢</mo><mrow id="S3.E9.m1.3.3.3.2.2.2.2" xref="S3.E9.m1.3.3.3.2.2.2.3.cmml"><mo id="S3.E9.m1.3.3.3.2.2.2.2.3" stretchy="false" xref="S3.E9.m1.3.3.3.2.2.2.3.cmml">(</mo><msub id="S3.E9.m1.2.2.2.1.1.1.1.1" xref="S3.E9.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E9.m1.2.2.2.1.1.1.1.1.2" xref="S3.E9.m1.2.2.2.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E9.m1.2.2.2.1.1.1.1.1.3" xref="S3.E9.m1.2.2.2.1.1.1.1.1.3.cmml">L</mi></msub><mo id="S3.E9.m1.3.3.3.2.2.2.2.4" xref="S3.E9.m1.3.3.3.2.2.2.3.cmml">,</mo><msub id="S3.E9.m1.3.3.3.2.2.2.2.2" xref="S3.E9.m1.3.3.3.2.2.2.2.2.cmml"><mover accent="true" id="S3.E9.m1.3.3.3.2.2.2.2.2.2" xref="S3.E9.m1.3.3.3.2.2.2.2.2.2.cmml"><mi id="S3.E9.m1.3.3.3.2.2.2.2.2.2.2" xref="S3.E9.m1.3.3.3.2.2.2.2.2.2.2.cmml">z</mi><mo id="S3.E9.m1.3.3.3.2.2.2.2.2.2.1" xref="S3.E9.m1.3.3.3.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.3.3.3.2.2.2.2.2.3" xref="S3.E9.m1.3.3.3.2.2.2.2.2.3.cmml">L</mi></msub><mo id="S3.E9.m1.3.3.3.2.2.2.2.5" stretchy="false" xref="S3.E9.m1.3.3.3.2.2.2.3.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.3.3f" xref="S3.E9.m1.3.3.cmml"><mrow id="S3.E9.m1.3.3.3.3.1" xref="S3.E9.m1.3.3.3.3.1.cmml"><mrow id="S3.E9.m1.3.3.3.3.1.2" xref="S3.E9.m1.3.3.3.3.1.2.cmml"><mtext id="S3.E9.m1.3.3.3.3.1.2.2" xref="S3.E9.m1.3.3.3.3.1.2.2a.cmml">if </mtext><mo id="S3.E9.m1.3.3.3.3.1.2.1" xref="S3.E9.m1.3.3.3.3.1.2.1.cmml">⁢</mo><mi id="S3.E9.m1.3.3.3.3.1.2.3" xref="S3.E9.m1.3.3.3.3.1.2.3.cmml">t</mi></mrow><mo id="S3.E9.m1.3.3.3.3.1.1" xref="S3.E9.m1.3.3.3.3.1.1.cmml">=</mo><mi id="S3.E9.m1.3.3.3.3.1.3" xref="S3.E9.m1.3.3.3.3.1.3.cmml">L</mi></mrow></mtd></mtr></mtable><mi id="S3.E9.m1.4.4.1.1.3.2.2" xref="S3.E9.m1.4.4.1.1.3.1.1.cmml"></mi></mrow></mrow><mo id="S3.E9.m1.4.4.1.2" lspace="0em" xref="S3.E9.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.4.1.1.cmml" xref="S3.E9.m1.4.4.1"><csymbol cd="latexml" id="S3.E9.m1.4.4.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1">approaches-limit</csymbol><apply id="S3.E9.m1.4.4.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.2.1.cmml" xref="S3.E9.m1.4.4.1.1.2">superscript</csymbol><apply id="S3.E9.m1.4.4.1.1.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.2.2.1.cmml" xref="S3.E9.m1.4.4.1.1.2">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.2.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2">𝑅</ci><ci id="S3.E9.m1.4.4.1.1.2.2.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.3">𝑡</ci></apply><ci id="S3.E9.m1.4.4.1.1.2.3.cmml" xref="S3.E9.m1.4.4.1.1.2.3">𝜆</ci></apply><apply id="S3.E9.m1.4.4.1.1.3.1.cmml" xref="S3.E9.m1.4.4.1.1.3.2"><csymbol cd="latexml" id="S3.E9.m1.4.4.1.1.3.1.1.cmml" xref="S3.E9.m1.4.4.1.1.3.2.1">cases</csymbol><matrix id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3"><matrixrow id="S3.E9.m1.3.3a.cmml" xref="S3.E9.m1.3.3"><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2"></times><apply id="S3.E9.m1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2"><ci id="S3.E9.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E9.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2.2">𝑐</ci></apply><ci id="S3.E9.m1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3.3">𝑡</ci></apply><set id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1"><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1"><plus id="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2"></plus><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.2">𝐺</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3"><plus id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.2">𝛾</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2"><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.1">^</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.2">Δ</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3"><plus id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.4"></plus><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.4"></times><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜆</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.2">𝑣</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.5.3">𝜓</ci></apply><interval closure="open" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2"><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.2">ℎ</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3"><plus id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1"></plus><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2">𝑡</ci><cn id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3.cmml" type="integer" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">subscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2"><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2.1">^</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.2.2">𝑧</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3"><plus id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.1"></plus><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.2">𝑡</ci><cn id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.3.cmml" type="integer" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.3.3">1</cn></apply></apply></interval></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5"><times id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.1"></times><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2">𝜆</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.2">𝑅</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3"><plus id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.1"></plus><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.2">𝑡</ci><cn id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.3.cmml" type="integer" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.3">𝜆</ci></apply></apply></apply></apply></apply></apply></set></apply><apply id="S3.E9.m1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.2.1"><lt id="S3.E9.m1.1.1.1.2.1.1.cmml" xref="S3.E9.m1.1.1.1.2.1.1"></lt><apply id="S3.E9.m1.1.1.1.2.1.2.cmml" xref="S3.E9.m1.1.1.1.2.1.2"><times id="S3.E9.m1.1.1.1.2.1.2.1.cmml" xref="S3.E9.m1.1.1.1.2.1.2.1"></times><ci id="S3.E9.m1.1.1.1.2.1.2.2a.cmml" xref="S3.E9.m1.1.1.1.2.1.2.2"><mtext id="S3.E9.m1.1.1.1.2.1.2.2.cmml" xref="S3.E9.m1.1.1.1.2.1.2.2">if </mtext></ci><ci id="S3.E9.m1.1.1.1.2.1.2.3.cmml" xref="S3.E9.m1.1.1.1.2.1.2.3">𝑡</ci></apply><ci id="S3.E9.m1.1.1.1.2.1.3.cmml" xref="S3.E9.m1.1.1.1.2.1.3">𝐿</ci></apply></matrixrow><matrixrow id="S3.E9.m1.3.3b.cmml" xref="S3.E9.m1.3.3"><apply id="S3.E9.m1.3.3.3.2.2.cmml" xref="S3.E9.m1.3.3.3.2.2"><times id="S3.E9.m1.3.3.3.2.2.3.cmml" xref="S3.E9.m1.3.3.3.2.2.3"></times><apply id="S3.E9.m1.3.3.3.2.2.4.cmml" xref="S3.E9.m1.3.3.3.2.2.4"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.3.2.2.4.1.cmml" xref="S3.E9.m1.3.3.3.2.2.4">subscript</csymbol><ci id="S3.E9.m1.3.3.3.2.2.4.2.cmml" xref="S3.E9.m1.3.3.3.2.2.4.2">𝑣</ci><ci id="S3.E9.m1.3.3.3.2.2.4.3.cmml" xref="S3.E9.m1.3.3.3.2.2.4.3">𝜓</ci></apply><interval closure="open" id="S3.E9.m1.3.3.3.2.2.2.3.cmml" xref="S3.E9.m1.3.3.3.2.2.2.2"><apply id="S3.E9.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.2.1.1.1.1.1.2">ℎ</ci><ci id="S3.E9.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.2.1.1.1.1.1.3">𝐿</ci></apply><apply id="S3.E9.m1.3.3.3.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.3.2.2.2.2.2.1.cmml" xref="S3.E9.m1.3.3.3.2.2.2.2.2">subscript</csymbol><apply id="S3.E9.m1.3.3.3.2.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.3.2.2.2.2.2.2"><ci id="S3.E9.m1.3.3.3.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.3.3.3.2.2.2.2.2.2.1">^</ci><ci id="S3.E9.m1.3.3.3.2.2.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.3.2.2.2.2.2.2.2">𝑧</ci></apply><ci id="S3.E9.m1.3.3.3.2.2.2.2.2.3.cmml" xref="S3.E9.m1.3.3.3.2.2.2.2.2.3">𝐿</ci></apply></interval></apply><apply id="S3.E9.m1.3.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3.3.1"><eq id="S3.E9.m1.3.3.3.3.1.1.cmml" xref="S3.E9.m1.3.3.3.3.1.1"></eq><apply id="S3.E9.m1.3.3.3.3.1.2.cmml" xref="S3.E9.m1.3.3.3.3.1.2"><times id="S3.E9.m1.3.3.3.3.1.2.1.cmml" xref="S3.E9.m1.3.3.3.3.1.2.1"></times><ci id="S3.E9.m1.3.3.3.3.1.2.2a.cmml" xref="S3.E9.m1.3.3.3.3.1.2.2"><mtext id="S3.E9.m1.3.3.3.3.1.2.2.cmml" xref="S3.E9.m1.3.3.3.3.1.2.2">if </mtext></ci><ci id="S3.E9.m1.3.3.3.3.1.2.3.cmml" xref="S3.E9.m1.3.3.3.3.1.2.3">𝑡</ci></apply><ci id="S3.E9.m1.3.3.3.3.1.3.cmml" xref="S3.E9.m1.3.3.3.3.1.3">𝐿</ci></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">R_{t}^{\lambda}\doteq\left\{\begin{array}[]{ll}\hat{c}_{t}\{\hat{G}_{t+1}+%
\gamma^{\hat{\Delta}_{t+1}}\left[(1-\lambda)v_{\psi}(h_{t+1},\hat{z}_{t+1})+%
\lambda R_{t+1}^{\lambda}\right]\}&amp;\text{if }t&lt;L\\
v_{\psi}(h_{L},\hat{z}_{L})&amp;\text{if }t=L\end{array}\right..</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.4d">italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_λ end_POSTSUPERSCRIPT ≐ { start_ARRAY start_ROW start_CELL over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT { over^ start_ARG italic_G end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT + italic_γ start_POSTSUPERSCRIPT over^ start_ARG roman_Δ end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT [ ( 1 - italic_λ ) italic_v start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_h start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) + italic_λ italic_R start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_λ end_POSTSUPERSCRIPT ] } end_CELL start_CELL if italic_t &lt; italic_L end_CELL end_ROW start_ROW start_CELL italic_v start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_h start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) end_CELL start_CELL if italic_t = italic_L end_CELL end_ROW end_ARRAY .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p3.1">The critic uses the maximum likelihood loss to predict the distribution of the return estimates <math alttext="R_{t}^{\lambda}" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><msubsup id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2.2" xref="S3.SS4.p3.1.m1.1.1.2.2.cmml">R</mi><mi id="S3.SS4.p3.1.m1.1.1.2.3" xref="S3.SS4.p3.1.m1.1.1.2.3.cmml">t</mi><mi id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3.cmml">λ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">superscript</csymbol><apply id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.2.1.cmml" xref="S3.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.2.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2.2">𝑅</ci><ci id="S3.SS4.p3.1.m1.1.1.2.3.cmml" xref="S3.SS4.p3.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS4.p3.1.m1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">R_{t}^{\lambda}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_λ end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(\psi)\doteq-\sum_{t=1}^{L}\ln p_{\psi}\left(R_{t}^{\lambda}\mid h_%
{t},\hat{z}_{t}\right)." class="ltx_Math" display="block" id="S3.E10.m1.2"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1.3" xref="S3.E10.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.2.2.1.1.3.2" xref="S3.E10.m1.2.2.1.1.3.2.cmml">ℒ</mi><mo id="S3.E10.m1.2.2.1.1.3.1" xref="S3.E10.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E10.m1.2.2.1.1.3.3.2" xref="S3.E10.m1.2.2.1.1.3.cmml"><mo id="S3.E10.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E10.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">ψ</mi><mo id="S3.E10.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E10.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.2.2.1.1.2" xref="S3.E10.m1.2.2.1.1.2.cmml">≐</mo><mrow id="S3.E10.m1.2.2.1.1.1" xref="S3.E10.m1.2.2.1.1.1.cmml"><mo id="S3.E10.m1.2.2.1.1.1a" xref="S3.E10.m1.2.2.1.1.1.cmml">−</mo><mrow id="S3.E10.m1.2.2.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.cmml"><munderover id="S3.E10.m1.2.2.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E10.m1.2.2.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E10.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.2.2.3" xref="S3.E10.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.2.2.3.2" xref="S3.E10.m1.2.2.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S3.E10.m1.2.2.1.1.1.1.2.2.3.1" xref="S3.E10.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E10.m1.2.2.1.1.1.1.2.2.3.3" xref="S3.E10.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E10.m1.2.2.1.1.1.1.2.3" xref="S3.E10.m1.2.2.1.1.1.1.2.3.cmml">L</mi></munderover><mrow id="S3.E10.m1.2.2.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.3.1" xref="S3.E10.m1.2.2.1.1.1.1.1.3.1.cmml">ln</mi><mo id="S3.E10.m1.2.2.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E10.m1.2.2.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E10.m1.2.2.1.1.1.1.1.3.2" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.3.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S3.E10.m1.2.2.1.1.1.1.1.3.2.3" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.3.cmml">ψ</mi></msub></mrow><mo id="S3.E10.m1.2.2.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.2.2.cmml">R</mi><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.2.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.2.3.cmml">t</mi><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.3.cmml">λ</mi></msubsup><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">z</mi><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E10.m1.2.2.1.2" lspace="0em" xref="S3.E10.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.1.1.cmml" xref="S3.E10.m1.2.2.1"><csymbol cd="latexml" id="S3.E10.m1.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2">approaches-limit</csymbol><apply id="S3.E10.m1.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.3"><times id="S3.E10.m1.2.2.1.1.3.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1"></times><ci id="S3.E10.m1.2.2.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.3.2">ℒ</ci><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝜓</ci></apply><apply id="S3.E10.m1.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1"><minus id="S3.E10.m1.2.2.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1"></minus><apply id="S3.E10.m1.2.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1"><apply id="S3.E10.m1.2.2.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.E10.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S3.E10.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2.2.3"><eq id="S3.E10.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S3.E10.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S3.E10.m1.2.2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E10.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E10.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2.3">𝐿</ci></apply><apply id="S3.E10.m1.2.2.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1"><times id="S3.E10.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.2"></times><apply id="S3.E10.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3"><ln id="S3.E10.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.1"></ln><apply id="S3.E10.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.3">𝜓</ci></apply></apply><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.2.2">𝑅</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.2.3">𝑡</ci></apply><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.4.3">𝜆</ci></apply><list id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2"><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑧</ci></apply><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\mathcal{L}(\psi)\doteq-\sum_{t=1}^{L}\ln p_{\psi}\left(R_{t}^{\lambda}\mid h_%
{t},\hat{z}_{t}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.2d">caligraphic_L ( italic_ψ ) ≐ - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT roman_ln italic_p start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_λ end_POSTSUPERSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p3.3">Following DreamerV3 <cite class="ltx_cite ltx_citemacro_citep">(Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib13" title="">2023</a>)</cite>, we train the actor to maximize the return estimates <math alttext="R_{t}^{\lambda}" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m1.1"><semantics id="S3.SS4.p3.2.m1.1a"><msubsup id="S3.SS4.p3.2.m1.1.1" xref="S3.SS4.p3.2.m1.1.1.cmml"><mi id="S3.SS4.p3.2.m1.1.1.2.2" xref="S3.SS4.p3.2.m1.1.1.2.2.cmml">R</mi><mi id="S3.SS4.p3.2.m1.1.1.2.3" xref="S3.SS4.p3.2.m1.1.1.2.3.cmml">t</mi><mi id="S3.SS4.p3.2.m1.1.1.3" xref="S3.SS4.p3.2.m1.1.1.3.cmml">λ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m1.1b"><apply id="S3.SS4.p3.2.m1.1.1.cmml" xref="S3.SS4.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m1.1.1.1.cmml" xref="S3.SS4.p3.2.m1.1.1">superscript</csymbol><apply id="S3.SS4.p3.2.m1.1.1.2.cmml" xref="S3.SS4.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m1.1.1.2.1.cmml" xref="S3.SS4.p3.2.m1.1.1">subscript</csymbol><ci id="S3.SS4.p3.2.m1.1.1.2.2.cmml" xref="S3.SS4.p3.2.m1.1.1.2.2">𝑅</ci><ci id="S3.SS4.p3.2.m1.1.1.2.3.cmml" xref="S3.SS4.p3.2.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS4.p3.2.m1.1.1.3.cmml" xref="S3.SS4.p3.2.m1.1.1.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m1.1c">R_{t}^{\lambda}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m1.1d">italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_λ end_POSTSUPERSCRIPT</annotation></semantics></math>.
Notably, due to long-term imagination does <span class="ltx_text ltx_font_italic" id="S3.SS4.p3.3.1">not</span> involve action, we do not optimize <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m2.1"><semantics id="S3.SS4.p3.3.m2.1a"><msub id="S3.SS4.p3.3.m2.1.1" xref="S3.SS4.p3.3.m2.1.1.cmml"><mi id="S3.SS4.p3.3.m2.1.1.2" xref="S3.SS4.p3.3.m2.1.1.2.cmml">a</mi><mi id="S3.SS4.p3.3.m2.1.1.3" xref="S3.SS4.p3.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m2.1b"><apply id="S3.SS4.p3.3.m2.1.1.cmml" xref="S3.SS4.p3.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m2.1.1.1.cmml" xref="S3.SS4.p3.3.m2.1.1">subscript</csymbol><ci id="S3.SS4.p3.3.m2.1.1.2.cmml" xref="S3.SS4.p3.3.m2.1.1.2">𝑎</ci><ci id="S3.SS4.p3.3.m2.1.1.3.cmml" xref="S3.SS4.p3.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m2.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m2.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> when long-term imagination is adopted. The loss of actor is formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(\theta)\doteq-\sum_{t=1}^{L}\text{sg}\left[\left(1-\hat{j}_{t}%
\right)\frac{R_{t}^{\lambda}-v_{\psi}(h_{t},\hat{z}_{t})}{\max(1,S)}\right]%
\log\pi_{\theta}(a_{t}\mid h_{t},\hat{z}_{t})+\eta\,\text{H}\left[\pi_{\theta}%
(a_{t}\mid h_{t},\hat{z}_{t})\right]." class="ltx_Math" display="block" id="S3.E11.m1.7"><semantics id="S3.E11.m1.7a"><mrow id="S3.E11.m1.7.7.1" xref="S3.E11.m1.7.7.1.1.cmml"><mrow id="S3.E11.m1.7.7.1.1" xref="S3.E11.m1.7.7.1.1.cmml"><mrow id="S3.E11.m1.7.7.1.1.5" xref="S3.E11.m1.7.7.1.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.7.7.1.1.5.2" xref="S3.E11.m1.7.7.1.1.5.2.cmml">ℒ</mi><mo id="S3.E11.m1.7.7.1.1.5.1" xref="S3.E11.m1.7.7.1.1.5.1.cmml">⁢</mo><mrow id="S3.E11.m1.7.7.1.1.5.3.2" xref="S3.E11.m1.7.7.1.1.5.cmml"><mo id="S3.E11.m1.7.7.1.1.5.3.2.1" stretchy="false" xref="S3.E11.m1.7.7.1.1.5.cmml">(</mo><mi id="S3.E11.m1.6.6" xref="S3.E11.m1.6.6.cmml">θ</mi><mo id="S3.E11.m1.7.7.1.1.5.3.2.2" stretchy="false" xref="S3.E11.m1.7.7.1.1.5.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.7.7.1.1.4" xref="S3.E11.m1.7.7.1.1.4.cmml">≐</mo><mrow id="S3.E11.m1.7.7.1.1.3" xref="S3.E11.m1.7.7.1.1.3.cmml"><mrow id="S3.E11.m1.7.7.1.1.2.2" xref="S3.E11.m1.7.7.1.1.2.2.cmml"><mo id="S3.E11.m1.7.7.1.1.2.2a" xref="S3.E11.m1.7.7.1.1.2.2.cmml">−</mo><mrow id="S3.E11.m1.7.7.1.1.2.2.2" xref="S3.E11.m1.7.7.1.1.2.2.2.cmml"><munderover id="S3.E11.m1.7.7.1.1.2.2.2.3" xref="S3.E11.m1.7.7.1.1.2.2.2.3.cmml"><mo id="S3.E11.m1.7.7.1.1.2.2.2.3.2.2" movablelimits="false" xref="S3.E11.m1.7.7.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E11.m1.7.7.1.1.2.2.2.3.2.3" xref="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.cmml"><mi id="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.2" xref="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.2.cmml">t</mi><mo id="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.1" xref="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.3" xref="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E11.m1.7.7.1.1.2.2.2.3.3" xref="S3.E11.m1.7.7.1.1.2.2.2.3.3.cmml">L</mi></munderover><mrow id="S3.E11.m1.7.7.1.1.2.2.2.2" xref="S3.E11.m1.7.7.1.1.2.2.2.2.cmml"><mtext id="S3.E11.m1.7.7.1.1.2.2.2.2.4" xref="S3.E11.m1.7.7.1.1.2.2.2.2.4a.cmml">sg</mtext><mo id="S3.E11.m1.7.7.1.1.2.2.2.2.3" xref="S3.E11.m1.7.7.1.1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">j</mi><mo id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mfrac id="S3.E11.m1.5.5" xref="S3.E11.m1.5.5.cmml"><mrow id="S3.E11.m1.2.2.2" xref="S3.E11.m1.2.2.2.cmml"><msubsup id="S3.E11.m1.2.2.2.4" xref="S3.E11.m1.2.2.2.4.cmml"><mi id="S3.E11.m1.2.2.2.4.2.2" xref="S3.E11.m1.2.2.2.4.2.2.cmml">R</mi><mi id="S3.E11.m1.2.2.2.4.2.3" xref="S3.E11.m1.2.2.2.4.2.3.cmml">t</mi><mi id="S3.E11.m1.2.2.2.4.3" xref="S3.E11.m1.2.2.2.4.3.cmml">λ</mi></msubsup><mo id="S3.E11.m1.2.2.2.3" xref="S3.E11.m1.2.2.2.3.cmml">−</mo><mrow id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.2.cmml"><msub id="S3.E11.m1.2.2.2.2.4" xref="S3.E11.m1.2.2.2.2.4.cmml"><mi id="S3.E11.m1.2.2.2.2.4.2" xref="S3.E11.m1.2.2.2.2.4.2.cmml">v</mi><mi id="S3.E11.m1.2.2.2.2.4.3" xref="S3.E11.m1.2.2.2.2.4.3.cmml">ψ</mi></msub><mo id="S3.E11.m1.2.2.2.2.3" xref="S3.E11.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E11.m1.2.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.3.cmml"><mo id="S3.E11.m1.2.2.2.2.2.2.3" stretchy="false" xref="S3.E11.m1.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E11.m1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E11.m1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E11.m1.2.2.2.2.2.2.4" xref="S3.E11.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E11.m1.2.2.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.2.2.cmml"><mover accent="true" id="S3.E11.m1.2.2.2.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E11.m1.2.2.2.2.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.2.2.2.2.cmml">z</mi><mo id="S3.E11.m1.2.2.2.2.2.2.2.2.1" xref="S3.E11.m1.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E11.m1.2.2.2.2.2.2.2.3" xref="S3.E11.m1.2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E11.m1.2.2.2.2.2.2.5" stretchy="false" xref="S3.E11.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E11.m1.5.5.5.5" xref="S3.E11.m1.5.5.5.4.cmml"><mi id="S3.E11.m1.3.3.3.1" xref="S3.E11.m1.3.3.3.1.cmml">max</mi><mo id="S3.E11.m1.5.5.5.5a" xref="S3.E11.m1.5.5.5.4.cmml">⁡</mo><mrow id="S3.E11.m1.5.5.5.5.1" xref="S3.E11.m1.5.5.5.4.cmml"><mo id="S3.E11.m1.5.5.5.5.1.1" stretchy="false" xref="S3.E11.m1.5.5.5.4.cmml">(</mo><mn id="S3.E11.m1.4.4.4.2" xref="S3.E11.m1.4.4.4.2.cmml">1</mn><mo id="S3.E11.m1.5.5.5.5.1.2" xref="S3.E11.m1.5.5.5.4.cmml">,</mo><mi id="S3.E11.m1.5.5.5.3" xref="S3.E11.m1.5.5.5.3.cmml">S</mi><mo id="S3.E11.m1.5.5.5.5.1.3" stretchy="false" xref="S3.E11.m1.5.5.5.4.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S3.E11.m1.7.7.1.1.2.2.2.2.3a" lspace="0.167em" xref="S3.E11.m1.7.7.1.1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E11.m1.7.7.1.1.2.2.2.2.5" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.cmml"><mi id="S3.E11.m1.7.7.1.1.2.2.2.2.5.1" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.1.cmml">log</mi><mo id="S3.E11.m1.7.7.1.1.2.2.2.2.5a" lspace="0.167em" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.cmml">⁡</mo><msub id="S3.E11.m1.7.7.1.1.2.2.2.2.5.2" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.cmml"><mi id="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.2" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.2.cmml">π</mi><mi id="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.3" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.3.cmml">θ</mi></msub></mrow><mo id="S3.E11.m1.7.7.1.1.2.2.2.2.3b" xref="S3.E11.m1.7.7.1.1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.cmml"><mo id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.2" stretchy="false" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.cmml"><msub id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.cmml"><mi id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.2" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.2.cmml">a</mi><mi id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.3" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.3.cmml">t</mi></msub><mo id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.3" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.3.cmml">∣</mo><mrow id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.3.cmml"><msub id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.2" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.3" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.3" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.3.cmml">,</mo><msub id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.cmml"><mover accent="true" id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2.2" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2.2.cmml">z</mi><mo id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2.1" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.3" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.3" stretchy="false" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E11.m1.7.7.1.1.3.4" xref="S3.E11.m1.7.7.1.1.3.4.cmml">+</mo><mrow id="S3.E11.m1.7.7.1.1.3.3" xref="S3.E11.m1.7.7.1.1.3.3.cmml"><mi id="S3.E11.m1.7.7.1.1.3.3.3" xref="S3.E11.m1.7.7.1.1.3.3.3.cmml">η</mi><mo id="S3.E11.m1.7.7.1.1.3.3.2" lspace="0.170em" xref="S3.E11.m1.7.7.1.1.3.3.2.cmml">⁢</mo><mtext id="S3.E11.m1.7.7.1.1.3.3.4" xref="S3.E11.m1.7.7.1.1.3.3.4a.cmml">H</mtext><mo id="S3.E11.m1.7.7.1.1.3.3.2a" xref="S3.E11.m1.7.7.1.1.3.3.2.cmml">⁢</mo><mrow id="S3.E11.m1.7.7.1.1.3.3.1.1" xref="S3.E11.m1.7.7.1.1.3.3.1.2.cmml"><mo id="S3.E11.m1.7.7.1.1.3.3.1.1.2" xref="S3.E11.m1.7.7.1.1.3.3.1.2.1.cmml">[</mo><mrow id="S3.E11.m1.7.7.1.1.3.3.1.1.1" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.cmml"><msub id="S3.E11.m1.7.7.1.1.3.3.1.1.1.3" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.cmml"><mi id="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.2" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.2.cmml">π</mi><mi id="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.3" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E11.m1.7.7.1.1.3.3.1.1.1.2" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.cmml"><mi id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.2" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.2.cmml">a</mi><mi id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.3" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.3" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.3" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2.2.cmml">z</mi><mo id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2.1" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.3" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.7.7.1.1.3.3.1.1.3" xref="S3.E11.m1.7.7.1.1.3.3.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E11.m1.7.7.1.2" lspace="0em" xref="S3.E11.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.7b"><apply id="S3.E11.m1.7.7.1.1.cmml" xref="S3.E11.m1.7.7.1"><csymbol cd="latexml" id="S3.E11.m1.7.7.1.1.4.cmml" xref="S3.E11.m1.7.7.1.1.4">approaches-limit</csymbol><apply id="S3.E11.m1.7.7.1.1.5.cmml" xref="S3.E11.m1.7.7.1.1.5"><times id="S3.E11.m1.7.7.1.1.5.1.cmml" xref="S3.E11.m1.7.7.1.1.5.1"></times><ci id="S3.E11.m1.7.7.1.1.5.2.cmml" xref="S3.E11.m1.7.7.1.1.5.2">ℒ</ci><ci id="S3.E11.m1.6.6.cmml" xref="S3.E11.m1.6.6">𝜃</ci></apply><apply id="S3.E11.m1.7.7.1.1.3.cmml" xref="S3.E11.m1.7.7.1.1.3"><plus id="S3.E11.m1.7.7.1.1.3.4.cmml" xref="S3.E11.m1.7.7.1.1.3.4"></plus><apply id="S3.E11.m1.7.7.1.1.2.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2"><minus id="S3.E11.m1.7.7.1.1.2.2.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2"></minus><apply id="S3.E11.m1.7.7.1.1.2.2.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2"><apply id="S3.E11.m1.7.7.1.1.2.2.2.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.2.2.2.3.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.3">superscript</csymbol><apply id="S3.E11.m1.7.7.1.1.2.2.2.3.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.2.2.2.3.2.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.3">subscript</csymbol><sum id="S3.E11.m1.7.7.1.1.2.2.2.3.2.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.3.2.2"></sum><apply id="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.3.2.3"><eq id="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.1"></eq><ci id="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.2">𝑡</ci><cn id="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.3.cmml" type="integer" xref="S3.E11.m1.7.7.1.1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E11.m1.7.7.1.1.2.2.2.3.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.3.3">𝐿</ci></apply><apply id="S3.E11.m1.7.7.1.1.2.2.2.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2"><times id="S3.E11.m1.7.7.1.1.2.2.2.2.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.3"></times><ci id="S3.E11.m1.7.7.1.1.2.2.2.2.4a.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.4"><mtext id="S3.E11.m1.7.7.1.1.2.2.2.2.4.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.4">sg</mtext></ci><apply id="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1"><times id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑗</ci></apply><ci id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.E11.m1.5.5.cmml" xref="S3.E11.m1.5.5"><divide id="S3.E11.m1.5.5.6.cmml" xref="S3.E11.m1.5.5"></divide><apply id="S3.E11.m1.2.2.2.cmml" xref="S3.E11.m1.2.2.2"><minus id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.3"></minus><apply id="S3.E11.m1.2.2.2.4.cmml" xref="S3.E11.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.4.1.cmml" xref="S3.E11.m1.2.2.2.4">superscript</csymbol><apply id="S3.E11.m1.2.2.2.4.2.cmml" xref="S3.E11.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.4.2.1.cmml" xref="S3.E11.m1.2.2.2.4">subscript</csymbol><ci id="S3.E11.m1.2.2.2.4.2.2.cmml" xref="S3.E11.m1.2.2.2.4.2.2">𝑅</ci><ci id="S3.E11.m1.2.2.2.4.2.3.cmml" xref="S3.E11.m1.2.2.2.4.2.3">𝑡</ci></apply><ci id="S3.E11.m1.2.2.2.4.3.cmml" xref="S3.E11.m1.2.2.2.4.3">𝜆</ci></apply><apply id="S3.E11.m1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2"><times id="S3.E11.m1.2.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2.3"></times><apply id="S3.E11.m1.2.2.2.2.4.cmml" xref="S3.E11.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.2.4.1.cmml" xref="S3.E11.m1.2.2.2.2.4">subscript</csymbol><ci id="S3.E11.m1.2.2.2.2.4.2.cmml" xref="S3.E11.m1.2.2.2.2.4.2">𝑣</ci><ci id="S3.E11.m1.2.2.2.2.4.3.cmml" xref="S3.E11.m1.2.2.2.2.4.3">𝜓</ci></apply><interval closure="open" id="S3.E11.m1.2.2.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2.2.2"><apply id="S3.E11.m1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E11.m1.2.2.2.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E11.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2.2"><ci id="S3.E11.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2.2.1">^</ci><ci id="S3.E11.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2.2.2">𝑧</ci></apply><ci id="S3.E11.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply><apply id="S3.E11.m1.5.5.5.4.cmml" xref="S3.E11.m1.5.5.5.5"><max id="S3.E11.m1.3.3.3.1.cmml" xref="S3.E11.m1.3.3.3.1"></max><cn id="S3.E11.m1.4.4.4.2.cmml" type="integer" xref="S3.E11.m1.4.4.4.2">1</cn><ci id="S3.E11.m1.5.5.5.3.cmml" xref="S3.E11.m1.5.5.5.3">𝑆</ci></apply></apply></apply></apply><apply id="S3.E11.m1.7.7.1.1.2.2.2.2.5.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5"><log id="S3.E11.m1.7.7.1.1.2.2.2.2.5.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.1"></log><apply id="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.2"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.2">subscript</csymbol><ci id="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.2">𝜋</ci><ci id="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.5.2.3">𝜃</ci></apply></apply><apply id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.3">conditional</csymbol><apply id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4">subscript</csymbol><ci id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.2">𝑎</ci><ci id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.4.3">𝑡</ci></apply><list id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2"><apply id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.2">ℎ</ci><ci id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2">subscript</csymbol><apply id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2"><ci id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2.1">^</ci><ci id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.2.2">𝑧</ci></apply><ci id="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.3.cmml" xref="S3.E11.m1.7.7.1.1.2.2.2.2.2.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply></apply><apply id="S3.E11.m1.7.7.1.1.3.3.cmml" xref="S3.E11.m1.7.7.1.1.3.3"><times id="S3.E11.m1.7.7.1.1.3.3.2.cmml" xref="S3.E11.m1.7.7.1.1.3.3.2"></times><ci id="S3.E11.m1.7.7.1.1.3.3.3.cmml" xref="S3.E11.m1.7.7.1.1.3.3.3">𝜂</ci><ci id="S3.E11.m1.7.7.1.1.3.3.4a.cmml" xref="S3.E11.m1.7.7.1.1.3.3.4"><mtext id="S3.E11.m1.7.7.1.1.3.3.4.cmml" xref="S3.E11.m1.7.7.1.1.3.3.4">H</mtext></ci><apply id="S3.E11.m1.7.7.1.1.3.3.1.2.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1"><csymbol cd="latexml" id="S3.E11.m1.7.7.1.1.3.3.1.2.1.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.2">delimited-[]</csymbol><apply id="S3.E11.m1.7.7.1.1.3.3.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1"><times id="S3.E11.m1.7.7.1.1.3.3.1.1.1.2.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.2"></times><apply id="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.1.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.2.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.2">𝜋</ci><ci id="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.3.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.1.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.2.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.2">𝑎</ci><ci id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.3.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2"><apply id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2"><ci id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.2.2">𝑧</ci></apply><ci id="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E11.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.7c">\mathcal{L}(\theta)\doteq-\sum_{t=1}^{L}\text{sg}\left[\left(1-\hat{j}_{t}%
\right)\frac{R_{t}^{\lambda}-v_{\psi}(h_{t},\hat{z}_{t})}{\max(1,S)}\right]%
\log\pi_{\theta}(a_{t}\mid h_{t},\hat{z}_{t})+\eta\,\text{H}\left[\pi_{\theta}%
(a_{t}\mid h_{t},\hat{z}_{t})\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.7d">caligraphic_L ( italic_θ ) ≐ - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT sg [ ( 1 - over^ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) divide start_ARG italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_λ end_POSTSUPERSCRIPT - italic_v start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG roman_max ( 1 , italic_S ) end_ARG ] roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + italic_η H [ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setups</h3>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Benchmark.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">We explore LS-Imagine on challenging MineDojo <cite class="ltx_cite ltx_citemacro_citep">(Fan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib5" title="">2022</a>)</cite> benchmark on top of the popular Minecraft game, which is a comprehensive simulation platform with various open-ended tasks.
We use <math alttext="5" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mn id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><cn id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.1d">5</annotation></semantics></math> challenging tasks, <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.1">i.e., harvest log in plains</span>, <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.2">harvest water with bucket</span>, <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.3">harvest sand</span>, <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.4">shear sheep</span>, and <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.5">mine iron ore</span>.
These tasks demand numerous steps to complete and present significant challenges for agent learning.
Additionally, we adopt a binary reward that indicates whether the task was completed, along with the MineCLIP reward proposed in <cite class="ltx_cite ltx_citemacro_cite">Fan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib5" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p2.1">Further details of the environmental setups are provided in <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS1.SSS0.Px1.p2.1.1">Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A1" title="Appendix A Environment Details ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">A</span></a></span>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Compared methods.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">We compare LS-Imagine with strong MineCraft agents, including</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px2.p2">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_italic" id="S4.I1.i1.p1.1.1">DreamerV3</span> <cite class="ltx_cite ltx_citemacro_citep">(Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib13" title="">2023</a>)</cite>:
An MBRL approach that learns directly from the step-by-step imaginations of future latent states generated by the world model.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S4.I1.i2.p1.1.1">VPT</span> <cite class="ltx_cite ltx_citemacro_citep">(Baker et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib2" title="">2022</a>)</cite>: A foundation model designed for Minecraft trained through behavior cloning, on a dataset consisting of <math alttext="70{,}000" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.2"><semantics id="S4.I1.i2.p1.1.m1.2a"><mrow id="S4.I1.i2.p1.1.m1.2.3.2" xref="S4.I1.i2.p1.1.m1.2.3.1.cmml"><mn id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">70</mn><mo id="S4.I1.i2.p1.1.m1.2.3.2.1" xref="S4.I1.i2.p1.1.m1.2.3.1.cmml">,</mo><mn id="S4.I1.i2.p1.1.m1.2.2" xref="S4.I1.i2.p1.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.2b"><list id="S4.I1.i2.p1.1.m1.2.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3.2"><cn id="S4.I1.i2.p1.1.m1.1.1.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.1.1">70</cn><cn id="S4.I1.i2.p1.1.m1.2.2.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.2c">70{,}000</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.2d">70 , 000</annotation></semantics></math> hours of game playing collected from the Internet.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_italic" id="S4.I1.i3.p1.1.1">STEVE-1</span> <cite class="ltx_cite ltx_citemacro_citep">(Lifshitz et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib22" title="">2023</a>)</cite>: An instruction-following agent developed for Minecraft. The development process begins by training a goal-conditioned policy using the contractor dataset. This policy serves as the low-level controller. Subsequently, Steve-1 employs a language-labeled dataset to translate language instructions into specific goals. To evaluate its effectiveness, we assess Steve-1’s zero-shot performance on our tasks by supplying it with task instructions.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="456" id="S4.F4.g1" src="x5.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance comparison of LS-Imagine against existing approaches in MineDojo.
</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="175" id="S4.F5.g1" src="x6.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Number of steps per episode required to achieve success in MineDojo.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Implementation details.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.5">We conduct our experiments on the MineDojo environment, where both visual observation and corresponding affordance maps are resized to <math alttext="64\times 64" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><mrow id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><mn id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml">64</mn><mo id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1"><times id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1"></times><cn id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2">64</cn><cn id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.1.m1.1d">64 × 64</annotation></semantics></math> pixels to serve as inputs to the model.
To generate affordance maps accurately, we collect <math alttext="2{,}000" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.2.m2.2"><semantics id="S4.SS1.SSS0.Px3.p1.2.m2.2a"><mrow id="S4.SS1.SSS0.Px3.p1.2.m2.2.3.2" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.3.1.cmml"><mn id="S4.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml">2</mn><mo id="S4.SS1.SSS0.Px3.p1.2.m2.2.3.2.1" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px3.p1.2.m2.2.2" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.2.m2.2b"><list id="S4.SS1.SSS0.Px3.p1.2.m2.2.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.3.2"><cn id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1">2</cn><cn id="S4.SS1.SSS0.Px3.p1.2.m2.2.2.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p1.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.2.m2.2c">2{,}000</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.2.m2.2d">2 , 000</annotation></semantics></math> images from the environment using a random agent under the current task instruction and generate a discrete set of (<math alttext="o_{t},I,\mathcal{M}_{o_{t},I}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.3.m3.5"><semantics id="S4.SS1.SSS0.Px3.p1.3.m3.5a"><mrow id="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.5.5.3.cmml"><msub id="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.3" xref="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.3" xref="S4.SS1.SSS0.Px3.p1.3.m3.5.5.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px3.p1.3.m3.3.3" xref="S4.SS1.SSS0.Px3.p1.3.m3.3.3.cmml">I</mi><mo id="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.4" xref="S4.SS1.SSS0.Px3.p1.3.m3.5.5.3.cmml">,</mo><msub id="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.2.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.2.2.cmml">ℳ</mi><mrow id="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.3.cmml"><msub id="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.1.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.1.1.cmml">I</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.3.m3.5b"><list id="S4.SS1.SSS0.Px3.p1.3.m3.5.5.3.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2"><apply id="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.4.4.1.1.3">𝑡</ci></apply><ci id="S4.SS1.SSS0.Px3.p1.3.m3.3.3.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.3.3">𝐼</ci><apply id="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.2.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.2.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.2.2.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.5.5.2.2.2">ℳ</ci><list id="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2"><apply id="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.2.2.2.2.1.3">𝑡</ci></apply><ci id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.1.1">𝐼</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.3.m3.5c">o_{t},I,\mathcal{M}_{o_{t},I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.3.m3.5d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I , caligraphic_M start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_I end_POSTSUBSCRIPT</annotation></semantics></math>), which are then used to finetune the multimodal U-Net for <math alttext="200" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px3.p1.4.m4.1a"><mn id="S4.SS1.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.4.m4.1b"><cn id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.4.m4.1c">200</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.4.m4.1d">200</annotation></semantics></math> epochs.
For tasks in the MineDojo benchmark, we train the agent for <math alttext="1\times 10^{6}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px3.p1.5.m5.1a"><mrow id="S4.SS1.SSS0.Px3.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.cmml"><mn id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.2" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.2.cmml">1</mn><mo id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.1.cmml">×</mo><msup id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.cmml"><mn id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.2" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.2.cmml">10</mn><mn id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.3" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.3.cmml">6</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.5.m5.1b"><apply id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1"><times id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.1"></times><cn id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.2.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.2">1</cn><apply id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3">superscript</csymbol><cn id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.2.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.2">10</cn><cn id="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px3.p1.5.m5.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.5.m5.1c">1\times 10^{6}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.5.m5.1d">1 × 10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT</annotation></semantics></math> environment steps.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Main Comparison</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We evaluate all the Minecraft agents in terms of success rate shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.F4" title="Figure 4 ‣ Compared methods. ‣ 4.1 Experimental Setups ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">4</span></a> and per-episode steps shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.F5" title="Figure 5 ‣ Compared methods. ‣ 4.1 Experimental Setups ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">5</span></a>.
We find that LS-Imagine significantly outperforms the compared models, particularly in scenarios where sparse targets are distributed in the task.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.F4" title="Figure 4 ‣ Compared methods. ‣ 4.1 Experimental Setups ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">4</span></a> (f), we showcase the MineCLIP values achieved by LS-Imagine and DreamerV3.
Specifically, a sliding window of length <math alttext="16" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><cn id="S4.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">16</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">16</annotation></semantics></math> is used to compute the local MineCLIP values for each segment. The mean value is then calculated from all sliding windows.
We can see that agents trained using our method achieve higher MineCLIP values within a single episode compared to DreamerV3. This suggests that LS-Imagine facilitates quicker detection of task-relevant visual targets in open-world environments.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Additionally, we present qualitative results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.F6.sf1" title="In Figure 6 ‣ 4.2 Main Comparison ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">6(a)</span></a>.
In the top row, we decode the latent states before and after the jumpy state transitions back to the pixel space.
To better understand how affordance maps facilitate the jumpy state transitions and whether they can provide effective goal-conditioned guidance, the bottom rows visualize the affordance maps reconstructed from the latent states.
These visualizations demonstrate that the proposed world model can adaptively determine when to utilize long-term imagination based on the current visual observation. Furthermore, the generated affordance maps align effectively with areas that are highly relevant to the final goal, thereby enabling the agent to perform more efficient policy exploration.</p>
</div>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="198" id="S4.F6.sf1.g1" src="x7.png" width="477"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Visualization of long short-term imaginations</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="198" id="S4.F6.sf2.g1" src="x8.png" width="255"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Series vs. parallel connections</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>(a) Visualization of long short-term imaginations and (b) a further discussion on possible architecture designs of Series and Parallel connections of these two imagination pathways.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Model Analyses</h3>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Alternative pathways of mixed imaginations.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.1">It is worth highlighting that the long short-term imagination is implemented sequentially. Alternatively, we could structure long- and short-term imagination pathways in parallel.
Specifically, we first apply short-term imagination in a single sequence. Then, for all states predicted by this short-term imagination, if the jumping flag is <span class="ltx_text ltx_font_typewriter" id="S4.SS3.SSS0.Px1.p1.1.1">True</span>, we use the post-jumping state as the initial state to generate another sequence using short-term imagination.
To evaluate the advantages of using sequential long short-term imagination, we conduct an experimental comparison between LS-Imagine (<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px1.p1.1.2">series</span>) and LS-Imagine (<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px1.p1.1.3">parallel</span>).
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.F6.sf2" title="In Figure 6 ‣ 4.2 Main Comparison ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">6(b)</span></a> shows that the LS-Imagine (series) outperforms LS-Imagine (parallel) by large margins.
This implies that the parallel imagination sequences are independent of one another, meaning that the sequence starting with a post-jumping state does not guide the prior-jumping transitions.</p>
</div>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="201" id="S4.F7.g1" src="x9.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>
Results of ablation studies (Left) and hyperparameter analyses (Middle/Right).
</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Ablation studies.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.1">We conduct the ablation studies to validate the effect of the affordance-driven intrinsic reward and long short-term imagination.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.F7" title="Figure 7 ‣ Alternative pathways of mixed imaginations. ‣ 4.3 Model Analyses ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">7</span></a> (Left) presents corresponding results in the challenging MineDojo tasks.
As shown by the blue curve, removing the long-term imagination of LS-Imagine leads to a performance decline, which indicates the necessity of introducing long-term imagination and switching between it and short-term imagination adaptively.
For the model represented by the green curve, we do not employ affordance-driven intrinsic reward. It shows that the affordance-driven intrinsic reward also plays an important role during the early training state of agents.
Additionally, unlike the MineCLIP reward being calculated based on a series of states, the affordance-driven intrinsic reward relies solely on a single independent state. This approach enables a more accurate estimation of the reward for the post-jumpy-transition state.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Hyperparameter sensitivity.</h5>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px3.p1.4">We conduct sensitivity analyses on two hyperparameters: the long-term branch loss scale <math alttext="\beta_{\text{long}}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px3.p1.1.m1.1a"><msub id="S4.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.cmml">β</mi><mtext id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3a.cmml">long</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.2">𝛽</ci><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3a.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3"><mtext id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.3">long</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.1.m1.1c">\beta_{\text{long}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.1.m1.1d">italic_β start_POSTSUBSCRIPT long end_POSTSUBSCRIPT</annotation></semantics></math> and the intrinsic reward weight <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px3.p1.2.m2.1a"><mi id="S4.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.2.m2.1b"><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.2.m2.1d">italic_α</annotation></semantics></math>.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.F7" title="Figure 7 ‣ Alternative pathways of mixed imaginations. ‣ 4.3 Model Analyses ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">7</span></a> (Middle), we observe that when <math alttext="\beta_{\text{long}}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.3.m3.1"><semantics id="S4.SS3.SSS0.Px3.p1.3.m3.1a"><msub id="S4.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml">β</mi><mtext id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3a.cmml">long</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2">𝛽</ci><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3a.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3"><mtext id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3">long</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.3.m3.1c">\beta_{\text{long}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.3.m3.1d">italic_β start_POSTSUBSCRIPT long end_POSTSUBSCRIPT</annotation></semantics></math> for the long-term branch is too small or too large, it impedes the learning of long-term imagination, leading to a decline in performance.
Moreover, as we can see from Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S4.F7" title="Figure 7 ‣ Alternative pathways of mixed imaginations. ‣ 4.3 Model Analyses ‣ 4 Experiments ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">7</span></a> (Right), if the hyperparameter <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px3.p1.4.m4.1"><semantics id="S4.SS3.SSS0.Px3.p1.4.m4.1a"><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.4.m4.1b"><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.4.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px3.p1.4.m4.1d">italic_α</annotation></semantics></math> for intrinsic reward is excessively small, it may result in insufficient guidance and inaccurate reward estimation for the post-jumpy-transition state.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related Work</h2>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Visual MBRL.</h5>
<div class="ltx_para ltx_noindent" id="S5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">Recently, learning control policies from images, <span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px1.p1.1.1">i.e., </span>visual RL has been used widely, whereas previous RL algorithms learn policies from low-dimensional states. Existing approaches can be grouped by the use of model-free <cite class="ltx_cite ltx_citemacro_citep">(Laskin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib17" title="">2020</a>; Schwarzer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib32" title="">2021</a>; Stooke et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib35" title="">2021</a>; Xiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib41" title="">2022</a>; Parisi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib30" title="">2022</a>; Yarats et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib45" title="">2022</a>; Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib49" title="">2023</a>)</cite> or model-based <cite class="ltx_cite ltx_citemacro_citep">(Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib9" title="">2019</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib10" title="">2020</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib11" title="">2021</a>; Seo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib33" title="">2022</a>; Pan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib29" title="">2022</a>; Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib12" title="">2022</a>; Mazzaglia et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib23" title="">2023</a>; Micheli et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib24" title="">2023</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib47" title="">2023</a>; Ying et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib46" title="">2023</a>; Hansen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib14" title="">2024</a>; Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib37" title="">2024b</a>)</cite> RL algorithms.
<cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib19" title="">2024b</a>)</cite> proposed predicting a temporally smoothed reward instead of the exact reward at a given timestep, particularly for long-horizon sparse-reward tasks. This approach helps alleviate the challenges associated with reward prediction.
R2I <cite class="ltx_cite ltx_citemacro_citep">(Samsami et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib31" title="">2024</a>)</cite> introduced state space models (SSMs) within the world models of MBRL to improve both long-term memory and long-horizon credit assignment.
<cite class="ltx_cite ltx_citemacro_cite">Gumbsch et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib7" title="">2024</a>)</cite> presented a fully self-supervised algorithm for constructing hierarchical world models, which learns a hierarchy of world models featuring discrete latent dynamics.
MV-MWM <cite class="ltx_cite ltx_citemacro_citep">(Seo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib34" title="">2023</a>)</cite> employs a multi-view masked autoencoder for representation learning and subsequently trains a world model based on the representations generated by the autoencoder.
Unlike the aforementioned approaches, our work presents a long short-term world model architecture specifically designed for visual control in open-world environments.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Affordance maps for robot learning.</h5>
<div class="ltx_para ltx_noindent" id="S5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.1">Our work is also related to the affordance map for robot learning, which is known as to utilize the affordance to facilitate robot learning <cite class="ltx_cite ltx_citemacro_citep">(Mo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib25" title="">2021</a>; Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib16" title="">2021</a>; Yarats et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib44" title="">2021</a>; Mo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib26" title="">2022</a>; Geng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib6" title="">2022</a>; Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib42" title="">2022a</a>; Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib38" title="">2022</a>; Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib40" title="">2022</a>; Ha &amp; Song, <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib8" title="">2022</a>; Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib43" title="">2022b</a>; Cheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib4" title="">2024</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib18" title="">2024a</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib21" title="">2024b</a>)</cite>.
Where2Explore <cite class="ltx_cite ltx_citemacro_citep">(Ning et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib27" title="">2023</a>)</cite> introduces a cross-category few-shot affordance learning framework that leverages the similarities in geometries across different categories.
DualAfford <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib48" title="">2023</a>)</cite> learns collaborative actionable affordance for dual-gripper manipulation tasks over various 3D shapes.
VoxPoser <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib15" title="">2023</a>)</cite> unleashes the power of large language models and vision-language models for extracting affordances and constraints of real-world manipulation tasks, which are grounded in 3D perceptual space.
VRB <cite class="ltx_cite ltx_citemacro_citep">(Bahl et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib1" title="">2023</a>)</cite> train a visual affordance model with videos of human interactions and deploy the model in real-world robotic tasks directly.
However, our approach distinguishes itself by employing visual observation to generate affordance maps as guidance to mitigate the low exploration efficiency in open-world environments.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions and Limitations</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we presented a novel approach to overcoming the challenges of training visual reinforcement learning agents in high-dimensional open worlds. By extending the imagination horizon and leveraging a long short-term world model, our method facilitates efficient off-policy exploration across expansive state spaces. The incorporation of goal-conditioned jumpy state transitions and affordance maps allows agents to better grasp long-term value, enhancing their decision-making abilities. Our results demonstrate substantial improvements over existing state-of-the-art techniques in MineDojo, highlighting the potential of our approach for open-world reinforcement learning and inspiring future research in this domain.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">Although our approach demonstrates significant potential and effectiveness, it also introduces complexity in model training, and its generalizability across diverse tasks remains to be fully explored.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para ltx_noindent" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work was supported by the National Natural Science Foundation of China (Grant No. 62250062, 62106144, 62302246), the Shanghai Municipal Science and Technology Major Project (Grant No. 2021SHZDZX0102), the Fundamental Research Funds for the Central Universities, the CCF-Tencent Rhino-Bird Open Research Fund, the Natural Science Foundation of Zhejiang Province, China (Grant No. LQ23F010008), and supported by High Performance Computing Center at Eastern Institute of Technology, Ningbo, and Ningbo Institute of Digital Twin.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahl et al. (2023)</span>
<span class="ltx_bibblock">
Shikhar Bahl, Russell Mendonca, Lili Chen, Unnat Jain, and Deepak Pathak.

</span>
<span class="ltx_bibblock">Affordances from human videos as a versatile representation for robotics.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">CVPR</em>, pp.  13778–13790, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Baker et al. (2022)</span>
<span class="ltx_bibblock">
Bowen Baker, Ilge Akkaya, Peter Zhokov, Joost Huizinga, Jie Tang, Adrien Ecoffet, Brandon Houghton, Raul Sampedro, and Jeff Clune.

</span>
<span class="ltx_bibblock">Video pretraining (vpt): Learning to act by watching unlabeled online videos.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">NeurIPS</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2022)</span>
<span class="ltx_bibblock">
Hu Cao, Yueyue Wang, Joy Chen, Dongsheng Jiang, Xiaopeng Zhang, Qi Tian, and Manning Wang.

</span>
<span class="ltx_bibblock">Swin-unet: Unet-like pure transformer for medical image segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">ECCVW</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al. (2024)</span>
<span class="ltx_bibblock">
Guangran Cheng, Chuheng Zhang, Wenzhe Cai, Li Zhao, Changyin Sun, and Jiang Bian.

</span>
<span class="ltx_bibblock">Empowering large language models on robotic manipulation with affordance prompting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2404.11027</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al. (2022)</span>
<span class="ltx_bibblock">
Linxi Fan, Guanzhi Wang, Yunfan Jiang, Ajay Mandlekar, Yuncong Yang, Haoyi Zhu, Andrew Tang, De-An Huang, Yuke Zhu, and Anima Anandkumar.

</span>
<span class="ltx_bibblock">Minedojo: Building open-ended embodied agents with internet-scale knowledge.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">NeurIPS</em>, volume 35, pp.  18343–18362, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al. (2022)</span>
<span class="ltx_bibblock">
Yiran Geng, Boshi An, Haoran Geng, Yuanpei Chen, Yaodong Yang, and Hao Dong.

</span>
<span class="ltx_bibblock">End-to-end affordance learning for robotic manipulation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2209.12941</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gumbsch et al. (2024)</span>
<span class="ltx_bibblock">
Christian Gumbsch, Noor Sajid, Georg Martius, and Martin V. Butz.

</span>
<span class="ltx_bibblock">Learning hierarchical world models with adaptive temporal abstractions from discrete latent dynamics.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">ICLR</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ha &amp; Song (2022)</span>
<span class="ltx_bibblock">
Huy Ha and Shuran Song.

</span>
<span class="ltx_bibblock">Flingbot: The unreasonable effectiveness of dynamic manipulation for cloth unfolding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">CoRL</em>, pp.  24–33, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hafner et al. (2019)</span>
<span class="ltx_bibblock">
Danijar Hafner, Timothy Lillicrap, Ian Fischer, Ruben Villegas, David Ha, Honglak Lee, and James Davidson.

</span>
<span class="ltx_bibblock">Learning latent dynamics for planning from pixels.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">ICML</em>, pp.  2555–2565, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hafner et al. (2020)</span>
<span class="ltx_bibblock">
Danijar Hafner, Timothy Lillicrap, Jimmy Ba, and Mohammad Norouzi.

</span>
<span class="ltx_bibblock">Dream to control: Learning behaviors by latent imagination.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">ICLR</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hafner et al. (2021)</span>
<span class="ltx_bibblock">
Danijar Hafner, Timothy Lillicrap, Mohammad Norouzi, and Jimmy Ba.

</span>
<span class="ltx_bibblock">Mastering atari with discrete world models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">ICLR</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hafner et al. (2022)</span>
<span class="ltx_bibblock">
Danijar Hafner, Kuang-Huei Lee, Ian Fischer, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Deep hierarchical planning from pixels.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2206.04114</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hafner et al. (2023)</span>
<span class="ltx_bibblock">
Danijar Hafner, Jurgis Pasukonis, Jimmy Ba, and Timothy Lillicrap.

</span>
<span class="ltx_bibblock">Mastering diverse domains through world models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2301.04104</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hansen et al. (2024)</span>
<span class="ltx_bibblock">
Nicklas Hansen, Hao Su, and Xiaolong Wang.

</span>
<span class="ltx_bibblock">Td-mpc2: Scalable, robust world models for continuous control.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">ICLR</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2023)</span>
<span class="ltx_bibblock">
Wenlong Huang, Chen Wang, Ruohan Zhang, Yunzhu Li, Jiajun Wu, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Voxposer: Composable 3d value maps for robotic manipulation with language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">CoRL</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2021)</span>
<span class="ltx_bibblock">
Zhenyu Jiang, Yifeng Zhu, Maxwell Svetlik, Kuan Fang, and Yuke Zhu.

</span>
<span class="ltx_bibblock">Synergies between affordance and geometry: 6-dof grasp detection via implicit representations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Robotics: science and systems</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Laskin et al. (2020)</span>
<span class="ltx_bibblock">
Michael Laskin, Aravind Srinivas, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Curl: Contrastive unsupervised representations for reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">ICML</em>, pp.  5639–5650, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2024a)</span>
<span class="ltx_bibblock">
Olivia Y Lee, Annie Xie, Kuan Fang, Karl Pertsch, and Chelsea Finn.

</span>
<span class="ltx_bibblock">Affordance-guided reinforcement learning via visual prompting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2407.10341</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2024b)</span>
<span class="ltx_bibblock">
Vint Lee, Pieter Abbeel, and Youngwoon Lee.

</span>
<span class="ltx_bibblock">Dreamsmooth: Improving model-based reinforcement learning via reward smoothing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">ICLR</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024a)</span>
<span class="ltx_bibblock">
Hao Li, Xue Yang, Zhaokai Wang, Xizhou Zhu, Jie Zhou, Yu Qiao, Xiaogang Wang, Hongsheng Li, Lewei Lu, and Jifeng Dai.

</span>
<span class="ltx_bibblock">Auto mc-reward: Automated dense reward design with large language models for minecraft.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">CVPR</em>, pp.  16426–16435, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024b)</span>
<span class="ltx_bibblock">
Xiaoqi Li, Mingxu Zhang, Yiran Geng, Haoran Geng, Yuxing Long, Yan Shen, Renrui Zhang, Jiaming Liu, and Hao Dong.

</span>
<span class="ltx_bibblock">Manipllm: Embodied multimodal large language model for object-centric robotic manipulation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">CVPR</em>, pp.  18061–18070, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lifshitz et al. (2023)</span>
<span class="ltx_bibblock">
Shalev Lifshitz, Keiran Paster, Harris Chan, Jimmy Ba, and Sheila McIlraith.

</span>
<span class="ltx_bibblock">Steve-1: A generative model for text-to-behavior in minecraft.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">NeurIPS</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mazzaglia et al. (2023)</span>
<span class="ltx_bibblock">
Pietro Mazzaglia, Tim Verbelen, Bart Dhoedt, Alexandre Lacoste, and Sai Rajeswar.

</span>
<span class="ltx_bibblock">Choreographer: Learning and adapting skills in imagination.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">ICLR</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Micheli et al. (2023)</span>
<span class="ltx_bibblock">
Vincent Micheli, Eloi Alonso, and François Fleuret.

</span>
<span class="ltx_bibblock">Transformers are sample efficient world models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">ICLR</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mo et al. (2021)</span>
<span class="ltx_bibblock">
Kaichun Mo, Leonidas J Guibas, Mustafa Mukadam, Abhinav Gupta, and Shubham Tulsiani.

</span>
<span class="ltx_bibblock">Where2act: From pixels to actions for articulated 3d objects.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">ICCV</em>, pp.  6813–6823, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mo et al. (2022)</span>
<span class="ltx_bibblock">
Kaichun Mo, Yuzhe Qin, Fanbo Xiang, Hao Su, and Leonidas Guibas.

</span>
<span class="ltx_bibblock">O2o-afford: Annotation-free large-scale object-object affordance learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">CoRL</em>, pp.  1666–1677, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ning et al. (2023)</span>
<span class="ltx_bibblock">
Chuanruo Ning, Ruihai Wu, Haoran Lu, Kaichun Mo, and Hao Dong.

</span>
<span class="ltx_bibblock">Where2explore: Few-shot affordance learning for unseen novel categories of articulated objects.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">NeurIPS</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nottingham et al. (2023)</span>
<span class="ltx_bibblock">
Kolby Nottingham, Prithviraj Ammanabrolu, Alane Suhr, Yejin Choi, Hannaneh Hajishirzi, Sameer Singh, and Roy Fox.

</span>
<span class="ltx_bibblock">Do embodied agents dream of pixelated sheep: Embodied decision making using language guided world modelling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">ICML</em>, pp.  26311–26325, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al. (2022)</span>
<span class="ltx_bibblock">
Minting Pan, Xiangming Zhu, Yunbo Wang, and Xiaokang Yang.

</span>
<span class="ltx_bibblock">Iso-dream: Isolating and leveraging noncontrollable visual dynamics in world models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">NeurIPS</em>, volume 35, pp.  23178–23191, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Parisi et al. (2022)</span>
<span class="ltx_bibblock">
Simone Parisi, Aravind Rajeswaran, Senthil Purushwalkam, and Abhinav Gupta.

</span>
<span class="ltx_bibblock">The unsurprising effectiveness of pre-trained vision models for control.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">ICML</em>, pp.  17359–17371, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Samsami et al. (2024)</span>
<span class="ltx_bibblock">
Mohammad Reza Samsami, Artem Zholus, Janarthanan Rajendran, and Sarath Chandar.

</span>
<span class="ltx_bibblock">Mastering memory tasks with world models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">ICLR</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schwarzer et al. (2021)</span>
<span class="ltx_bibblock">
Max Schwarzer, Nitarshan Rajkumar, Michael Noukhovitch, Ankesh Anand, Laurent Charlin, R Devon Hjelm, Philip Bachman, and Aaron C Courville.

</span>
<span class="ltx_bibblock">Pretraining representations for data-efficient reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">NeurIPS</em>, volume 34, pp.  12686–12699, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seo et al. (2022)</span>
<span class="ltx_bibblock">
Younggyo Seo, Kimin Lee, Stephen L James, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Reinforcement learning with action-free pre-training from videos.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">ICML</em>, pp.  19561–19579, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seo et al. (2023)</span>
<span class="ltx_bibblock">
Younggyo Seo, Junsu Kim, Stephen James, Kimin Lee, Jinwoo Shin, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Multi-view masked world models for visual robotic manipulation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">ICML</em>, pp.  30613–30632, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stooke et al. (2021)</span>
<span class="ltx_bibblock">
Adam Stooke, Kimin Lee, Pieter Abbeel, and Michael Laskin.

</span>
<span class="ltx_bibblock">Decoupling representation learning from reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">ICML</em>, pp.  9870–9879, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024a)</span>
<span class="ltx_bibblock">
Guanzhi Wang, Yuqi Xie, Yunfan Jiang, Ajay Mandlekar, Chaowei Xiao, Yuke Zhu, Linxi Fan, and Anima Anandkumar.

</span>
<span class="ltx_bibblock">Voyager: An open-ended embodied agent with large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">TMLR</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024b)</span>
<span class="ltx_bibblock">
Qi Wang, Junming Yang, Yunbo Wang, Xin Jin, Wenjun Zeng, and Xiaokang Yang.

</span>
<span class="ltx_bibblock">Making offline rl online: Collaborative world models for offline visual reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">NeurIPS</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2022)</span>
<span class="ltx_bibblock">
Yian Wang, Ruihai Wu, Kaichun Mo, Jiaqi Ke, Qingnan Fan, Leonidas J Guibas, and Hao Dong.

</span>
<span class="ltx_bibblock">Adaafford: Learning to adapt manipulation affordance for 3d articulated objects via few-shot interactions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">ECCV</em>, pp.  90–107, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Zihao Wang, Shaofei Cai, Guanzhou Chen, Anji Liu, Xiaojian Ma, and Yitao Liang.

</span>
<span class="ltx_bibblock">Describe, explain, plan and select: Interactive planning with large language models enables open-world multi-task agents.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">NeurIPS</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2022)</span>
<span class="ltx_bibblock">
Ruihai Wu, Yan Zhao, Kaichun Mo, Zizheng Guo, Yian Wang, Tianhao Wu, Qingnan Fan, Xuelin Chen, Leonidas Guibas, and Hao Dong.

</span>
<span class="ltx_bibblock">Vat-mart: Learning visual action trajectory proposals for manipulating 3d articulated objects.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">ICLR</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2022)</span>
<span class="ltx_bibblock">
Tete Xiao, Ilija Radosavovic, Trevor Darrell, and Jitendra Malik.

</span>
<span class="ltx_bibblock">Masked visual pre-training for motor control.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2203.06173</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2022a)</span>
<span class="ltx_bibblock">
Chao Xu, Yixin Chen, He Wang, Song-Chun Zhu, Yixin Zhu, and Siyuan Huang.

</span>
<span class="ltx_bibblock">Partafford: Part-level affordance discovery from 3d objects.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint arXiv:2202.13519</em>, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2022b)</span>
<span class="ltx_bibblock">
Zhenjia Xu, Zhanpeng He, and Shuran Song.

</span>
<span class="ltx_bibblock">Universal manipulation policy network for articulated objects.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">IEEE robotics and automation letters</em>, 7(2):2447–2454, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yarats et al. (2021)</span>
<span class="ltx_bibblock">
Denis Yarats, Ilya Kostrikov, and Rob Fergus.

</span>
<span class="ltx_bibblock">Image augmentation is all you need: Regularizing deep reinforcement learning from pixels.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">ICLR</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yarats et al. (2022)</span>
<span class="ltx_bibblock">
Denis Yarats, Rob Fergus, Alessandro Lazaric, and Lerrel Pinto.

</span>
<span class="ltx_bibblock">Mastering visual continuous control: Improved data-augmented reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">ICLR</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ying et al. (2023)</span>
<span class="ltx_bibblock">
Chengyang Ying, Zhongkai Hao, Xinning Zhou, Hang Su, Songming Liu, Jialian Li, Dong Yan, and Jun Zhu.

</span>
<span class="ltx_bibblock">Reward informed dreamer for task generalization in reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2303.05092</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023)</span>
<span class="ltx_bibblock">
Wendong Zhang, Geng Chen, Xiangming Zhu, Siyu Gao, Yunbo Wang, and Xiaokang Yang.

</span>
<span class="ltx_bibblock">Predictive experience replay for continual visual control and forecasting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2303.06572</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2023)</span>
<span class="ltx_bibblock">
Yan Zhao, Ruihai Wu, Zhehuan Chen, Yourong Zhang, Qingnan Fan, Kaichun Mo, and Hao Dong.

</span>
<span class="ltx_bibblock">Dualafford: Learning collaborative visual affordance for dual-gripper manipulation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">ICLR</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2023)</span>
<span class="ltx_bibblock">
Ruijie Zheng, Xiyao Wang, Yanchao Sun, Shuang Ma, Jieyu Zhao, Huazhe Xu, Hal Daumé III, and Furong Huang.

</span>
<span class="ltx_bibblock">Taco: Temporal latent action-driven contrastive loss for visual reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">NeurIPS</em>, volume 36, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Environment Details</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">As illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A1.T2" title="Table 2 ‣ Appendix A Environment Details ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">2</span></a>, <span class="ltx_text ltx_font_italic" id="A1.p1.1.1">language description</span> is employed for calculating the MineCLIP reward <cite class="ltx_cite ltx_citemacro_citep">(Fan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib5" title="">2022</a>)</cite>. <span class="ltx_text ltx_font_italic" id="A1.p1.1.2">Initial tools</span> are the items provided in the inventory at the beginning of each episode.
<span class="ltx_text ltx_font_italic" id="A1.p1.1.3">Initial mobs and distance</span> specifies the types of mobs present at the start of each episode and their initial distance from the agent.
<span class="ltx_text ltx_font_italic" id="A1.p1.1.4">Max steps</span> refers to the maximum allowed steps per episode.</p>
</div>
<figure class="ltx_table" id="A1.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Details of four tasks in MineDojo.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T2.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">Task</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T2.1.1.1.2" style="padding-left:2.0pt;padding-right:2.0pt;">Language description</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T2.1.1.1.3" style="padding-left:2.0pt;padding-right:2.0pt;">Initial tools</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T2.1.1.1.4" style="padding-left:2.0pt;padding-right:2.0pt;">Initial mobs and distance</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T2.1.1.1.5" style="padding-left:2.0pt;padding-right:2.0pt;">Max steps</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T2.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T2.1.2.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">Harvest log in plains</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.1.2.1.2" style="padding-left:2.0pt;padding-right:2.0pt;">“Cut a tree.”</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.1.2.1.3" style="padding-left:2.0pt;padding-right:2.0pt;">–</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.1.2.1.4" style="padding-left:2.0pt;padding-right:2.0pt;">–</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.1.2.1.5" style="padding-left:2.0pt;padding-right:2.0pt;">1000</td>
</tr>
<tr class="ltx_tr" id="A1.T2.1.3.2">
<td class="ltx_td ltx_align_left" id="A1.T2.1.3.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Harvest water with bucket</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.3.2.2" style="padding-left:2.0pt;padding-right:2.0pt;">“Obtain water.”</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.3.2.3" style="padding-left:2.0pt;padding-right:2.0pt;">bucket</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.3.2.4" style="padding-left:2.0pt;padding-right:2.0pt;">–</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.3.2.5" style="padding-left:2.0pt;padding-right:2.0pt;">1000</td>
</tr>
<tr class="ltx_tr" id="A1.T2.1.4.3">
<td class="ltx_td ltx_align_left" id="A1.T2.1.4.3.1" style="padding-left:2.0pt;padding-right:2.0pt;">Harvest sand</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.4.3.2" style="padding-left:2.0pt;padding-right:2.0pt;">“Obtain sand.”</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.4.3.3" style="padding-left:2.0pt;padding-right:2.0pt;">–</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.4.3.4" style="padding-left:2.0pt;padding-right:2.0pt;">–</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.4.3.5" style="padding-left:2.0pt;padding-right:2.0pt;">1000</td>
</tr>
<tr class="ltx_tr" id="A1.T2.1.5.4">
<td class="ltx_td ltx_align_left" id="A1.T2.1.5.4.1" style="padding-left:2.0pt;padding-right:2.0pt;">Shear sheep</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.5.4.2" style="padding-left:2.0pt;padding-right:2.0pt;">“Obtain wool.”</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.5.4.3" style="padding-left:2.0pt;padding-right:2.0pt;">shear</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.5.4.4" style="padding-left:2.0pt;padding-right:2.0pt;">sheep, 15</td>
<td class="ltx_td ltx_align_center" id="A1.T2.1.5.4.5" style="padding-left:2.0pt;padding-right:2.0pt;">1000</td>
</tr>
<tr class="ltx_tr" id="A1.T2.1.6.5">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T2.1.6.5.1" style="padding-left:2.0pt;padding-right:2.0pt;">Mine iron ore</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T2.1.6.5.2" style="padding-left:2.0pt;padding-right:2.0pt;">“Mine iron ore.”</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T2.1.6.5.3" style="padding-left:2.0pt;padding-right:2.0pt;">stone pickaxe</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T2.1.6.5.4" style="padding-left:2.0pt;padding-right:2.0pt;">–</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T2.1.6.5.5" style="padding-left:2.0pt;padding-right:2.0pt;">2000</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Model Details</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Environment Interaction and Data Collection</h3>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.4">To train the world model in our LS-Imagine, we need to collect both short-term and long-term transition data through interactions with the environment. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A2.F8" title="Figure 8 ‣ B.1 Environment Interaction and Data Collection ‣ Appendix B Model Details ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">8</span></a>, at each time step <math alttext="t" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.1"><semantics id="A2.SS1.p1.1.m1.1a"><mi id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><ci id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.1d">italic_t</annotation></semantics></math>, we interact with the environment following the current policy, corresponding to a short-term transition. The data sequence collected at each time step is denoted as <math alttext="\mathcal{D}_{t}" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.1"><semantics id="A2.SS1.p1.2.m2.1a"><msub id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml">𝒟</mi><mi id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A2.SS1.p1.2.m2.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2">𝒟</ci><ci id="A2.SS1.p1.2.m2.1.1.3.cmml" xref="A2.SS1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">\mathcal{D}_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which includes: <math alttext="\{o_{t},a_{t},r_{t},c_{t},\mathcal{M}_{t},j_{t},\Delta_{t},G_{t}\}" class="ltx_Math" display="inline" id="A2.SS1.p1.3.m3.8"><semantics id="A2.SS1.p1.3.m3.8a"><mrow id="A2.SS1.p1.3.m3.8.8.8" xref="A2.SS1.p1.3.m3.8.8.9.cmml"><mo id="A2.SS1.p1.3.m3.8.8.8.9" stretchy="false" xref="A2.SS1.p1.3.m3.8.8.9.cmml">{</mo><msub id="A2.SS1.p1.3.m3.1.1.1.1" xref="A2.SS1.p1.3.m3.1.1.1.1.cmml"><mi id="A2.SS1.p1.3.m3.1.1.1.1.2" xref="A2.SS1.p1.3.m3.1.1.1.1.2.cmml">o</mi><mi id="A2.SS1.p1.3.m3.1.1.1.1.3" xref="A2.SS1.p1.3.m3.1.1.1.1.3.cmml">t</mi></msub><mo id="A2.SS1.p1.3.m3.8.8.8.10" xref="A2.SS1.p1.3.m3.8.8.9.cmml">,</mo><msub id="A2.SS1.p1.3.m3.2.2.2.2" xref="A2.SS1.p1.3.m3.2.2.2.2.cmml"><mi id="A2.SS1.p1.3.m3.2.2.2.2.2" xref="A2.SS1.p1.3.m3.2.2.2.2.2.cmml">a</mi><mi id="A2.SS1.p1.3.m3.2.2.2.2.3" xref="A2.SS1.p1.3.m3.2.2.2.2.3.cmml">t</mi></msub><mo id="A2.SS1.p1.3.m3.8.8.8.11" xref="A2.SS1.p1.3.m3.8.8.9.cmml">,</mo><msub id="A2.SS1.p1.3.m3.3.3.3.3" xref="A2.SS1.p1.3.m3.3.3.3.3.cmml"><mi id="A2.SS1.p1.3.m3.3.3.3.3.2" xref="A2.SS1.p1.3.m3.3.3.3.3.2.cmml">r</mi><mi id="A2.SS1.p1.3.m3.3.3.3.3.3" xref="A2.SS1.p1.3.m3.3.3.3.3.3.cmml">t</mi></msub><mo id="A2.SS1.p1.3.m3.8.8.8.12" xref="A2.SS1.p1.3.m3.8.8.9.cmml">,</mo><msub id="A2.SS1.p1.3.m3.4.4.4.4" xref="A2.SS1.p1.3.m3.4.4.4.4.cmml"><mi id="A2.SS1.p1.3.m3.4.4.4.4.2" xref="A2.SS1.p1.3.m3.4.4.4.4.2.cmml">c</mi><mi id="A2.SS1.p1.3.m3.4.4.4.4.3" xref="A2.SS1.p1.3.m3.4.4.4.4.3.cmml">t</mi></msub><mo id="A2.SS1.p1.3.m3.8.8.8.13" xref="A2.SS1.p1.3.m3.8.8.9.cmml">,</mo><msub id="A2.SS1.p1.3.m3.5.5.5.5" xref="A2.SS1.p1.3.m3.5.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.3.m3.5.5.5.5.2" xref="A2.SS1.p1.3.m3.5.5.5.5.2.cmml">ℳ</mi><mi id="A2.SS1.p1.3.m3.5.5.5.5.3" xref="A2.SS1.p1.3.m3.5.5.5.5.3.cmml">t</mi></msub><mo id="A2.SS1.p1.3.m3.8.8.8.14" xref="A2.SS1.p1.3.m3.8.8.9.cmml">,</mo><msub id="A2.SS1.p1.3.m3.6.6.6.6" xref="A2.SS1.p1.3.m3.6.6.6.6.cmml"><mi id="A2.SS1.p1.3.m3.6.6.6.6.2" xref="A2.SS1.p1.3.m3.6.6.6.6.2.cmml">j</mi><mi id="A2.SS1.p1.3.m3.6.6.6.6.3" xref="A2.SS1.p1.3.m3.6.6.6.6.3.cmml">t</mi></msub><mo id="A2.SS1.p1.3.m3.8.8.8.15" xref="A2.SS1.p1.3.m3.8.8.9.cmml">,</mo><msub id="A2.SS1.p1.3.m3.7.7.7.7" xref="A2.SS1.p1.3.m3.7.7.7.7.cmml"><mi id="A2.SS1.p1.3.m3.7.7.7.7.2" mathvariant="normal" xref="A2.SS1.p1.3.m3.7.7.7.7.2.cmml">Δ</mi><mi id="A2.SS1.p1.3.m3.7.7.7.7.3" xref="A2.SS1.p1.3.m3.7.7.7.7.3.cmml">t</mi></msub><mo id="A2.SS1.p1.3.m3.8.8.8.16" xref="A2.SS1.p1.3.m3.8.8.9.cmml">,</mo><msub id="A2.SS1.p1.3.m3.8.8.8.8" xref="A2.SS1.p1.3.m3.8.8.8.8.cmml"><mi id="A2.SS1.p1.3.m3.8.8.8.8.2" xref="A2.SS1.p1.3.m3.8.8.8.8.2.cmml">G</mi><mi id="A2.SS1.p1.3.m3.8.8.8.8.3" xref="A2.SS1.p1.3.m3.8.8.8.8.3.cmml">t</mi></msub><mo id="A2.SS1.p1.3.m3.8.8.8.17" stretchy="false" xref="A2.SS1.p1.3.m3.8.8.9.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.8b"><set id="A2.SS1.p1.3.m3.8.8.9.cmml" xref="A2.SS1.p1.3.m3.8.8.8"><apply id="A2.SS1.p1.3.m3.1.1.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="A2.SS1.p1.3.m3.1.1.1.1.2.cmml" xref="A2.SS1.p1.3.m3.1.1.1.1.2">𝑜</ci><ci id="A2.SS1.p1.3.m3.1.1.1.1.3.cmml" xref="A2.SS1.p1.3.m3.1.1.1.1.3">𝑡</ci></apply><apply id="A2.SS1.p1.3.m3.2.2.2.2.cmml" xref="A2.SS1.p1.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.2.2.2.2.1.cmml" xref="A2.SS1.p1.3.m3.2.2.2.2">subscript</csymbol><ci id="A2.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="A2.SS1.p1.3.m3.2.2.2.2.2">𝑎</ci><ci id="A2.SS1.p1.3.m3.2.2.2.2.3.cmml" xref="A2.SS1.p1.3.m3.2.2.2.2.3">𝑡</ci></apply><apply id="A2.SS1.p1.3.m3.3.3.3.3.cmml" xref="A2.SS1.p1.3.m3.3.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.3.3.3.3.1.cmml" xref="A2.SS1.p1.3.m3.3.3.3.3">subscript</csymbol><ci id="A2.SS1.p1.3.m3.3.3.3.3.2.cmml" xref="A2.SS1.p1.3.m3.3.3.3.3.2">𝑟</ci><ci id="A2.SS1.p1.3.m3.3.3.3.3.3.cmml" xref="A2.SS1.p1.3.m3.3.3.3.3.3">𝑡</ci></apply><apply id="A2.SS1.p1.3.m3.4.4.4.4.cmml" xref="A2.SS1.p1.3.m3.4.4.4.4"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.4.4.4.4.1.cmml" xref="A2.SS1.p1.3.m3.4.4.4.4">subscript</csymbol><ci id="A2.SS1.p1.3.m3.4.4.4.4.2.cmml" xref="A2.SS1.p1.3.m3.4.4.4.4.2">𝑐</ci><ci id="A2.SS1.p1.3.m3.4.4.4.4.3.cmml" xref="A2.SS1.p1.3.m3.4.4.4.4.3">𝑡</ci></apply><apply id="A2.SS1.p1.3.m3.5.5.5.5.cmml" xref="A2.SS1.p1.3.m3.5.5.5.5"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.5.5.5.5.1.cmml" xref="A2.SS1.p1.3.m3.5.5.5.5">subscript</csymbol><ci id="A2.SS1.p1.3.m3.5.5.5.5.2.cmml" xref="A2.SS1.p1.3.m3.5.5.5.5.2">ℳ</ci><ci id="A2.SS1.p1.3.m3.5.5.5.5.3.cmml" xref="A2.SS1.p1.3.m3.5.5.5.5.3">𝑡</ci></apply><apply id="A2.SS1.p1.3.m3.6.6.6.6.cmml" xref="A2.SS1.p1.3.m3.6.6.6.6"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.6.6.6.6.1.cmml" xref="A2.SS1.p1.3.m3.6.6.6.6">subscript</csymbol><ci id="A2.SS1.p1.3.m3.6.6.6.6.2.cmml" xref="A2.SS1.p1.3.m3.6.6.6.6.2">𝑗</ci><ci id="A2.SS1.p1.3.m3.6.6.6.6.3.cmml" xref="A2.SS1.p1.3.m3.6.6.6.6.3">𝑡</ci></apply><apply id="A2.SS1.p1.3.m3.7.7.7.7.cmml" xref="A2.SS1.p1.3.m3.7.7.7.7"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.7.7.7.7.1.cmml" xref="A2.SS1.p1.3.m3.7.7.7.7">subscript</csymbol><ci id="A2.SS1.p1.3.m3.7.7.7.7.2.cmml" xref="A2.SS1.p1.3.m3.7.7.7.7.2">Δ</ci><ci id="A2.SS1.p1.3.m3.7.7.7.7.3.cmml" xref="A2.SS1.p1.3.m3.7.7.7.7.3">𝑡</ci></apply><apply id="A2.SS1.p1.3.m3.8.8.8.8.cmml" xref="A2.SS1.p1.3.m3.8.8.8.8"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.8.8.8.8.1.cmml" xref="A2.SS1.p1.3.m3.8.8.8.8">subscript</csymbol><ci id="A2.SS1.p1.3.m3.8.8.8.8.2.cmml" xref="A2.SS1.p1.3.m3.8.8.8.8.2">𝐺</ci><ci id="A2.SS1.p1.3.m3.8.8.8.8.3.cmml" xref="A2.SS1.p1.3.m3.8.8.8.8.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.8c">\{o_{t},a_{t},r_{t},c_{t},\mathcal{M}_{t},j_{t},\Delta_{t},G_{t}\}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.3.m3.8d">{ italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>. For simplicity, we denote the data collected at a specific time step with the subscript <math alttext="t" class="ltx_Math" display="inline" id="A2.SS1.p1.4.m4.1"><semantics id="A2.SS1.p1.4.m4.1a"><mi id="A2.SS1.p1.4.m4.1.1" xref="A2.SS1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.1b"><ci id="A2.SS1.p1.4.m4.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.4.m4.1d">italic_t</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.14">In this sequence, <math alttext="a_{t}" class="ltx_Math" display="inline" id="A2.SS1.p2.1.m1.1"><semantics id="A2.SS1.p2.1.m1.1a"><msub id="A2.SS1.p2.1.m1.1.1" xref="A2.SS1.p2.1.m1.1.1.cmml"><mi id="A2.SS1.p2.1.m1.1.1.2" xref="A2.SS1.p2.1.m1.1.1.2.cmml">a</mi><mi id="A2.SS1.p2.1.m1.1.1.3" xref="A2.SS1.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.1.m1.1b"><apply id="A2.SS1.p2.1.m1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.1.m1.1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p2.1.m1.1.1.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2">𝑎</ci><ci id="A2.SS1.p2.1.m1.1.1.3.cmml" xref="A2.SS1.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.1.m1.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="o_{t}" class="ltx_Math" display="inline" id="A2.SS1.p2.2.m2.1"><semantics id="A2.SS1.p2.2.m2.1a"><msub id="A2.SS1.p2.2.m2.1.1" xref="A2.SS1.p2.2.m2.1.1.cmml"><mi id="A2.SS1.p2.2.m2.1.1.2" xref="A2.SS1.p2.2.m2.1.1.2.cmml">o</mi><mi id="A2.SS1.p2.2.m2.1.1.3" xref="A2.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.2.m2.1b"><apply id="A2.SS1.p2.2.m2.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.1.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="A2.SS1.p2.2.m2.1.1.2.cmml" xref="A2.SS1.p2.2.m2.1.1.2">𝑜</ci><ci id="A2.SS1.p2.2.m2.1.1.3.cmml" xref="A2.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.2.m2.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.2.m2.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represent the action taken during the interaction and the observation image returned by the environment, respectively. The continuation flag <math alttext="c_{t}" class="ltx_Math" display="inline" id="A2.SS1.p2.3.m3.1"><semantics id="A2.SS1.p2.3.m3.1a"><msub id="A2.SS1.p2.3.m3.1.1" xref="A2.SS1.p2.3.m3.1.1.cmml"><mi id="A2.SS1.p2.3.m3.1.1.2" xref="A2.SS1.p2.3.m3.1.1.2.cmml">c</mi><mi id="A2.SS1.p2.3.m3.1.1.3" xref="A2.SS1.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.3.m3.1b"><apply id="A2.SS1.p2.3.m3.1.1.cmml" xref="A2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.3.m3.1.1.1.cmml" xref="A2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="A2.SS1.p2.3.m3.1.1.2.cmml" xref="A2.SS1.p2.3.m3.1.1.2">𝑐</ci><ci id="A2.SS1.p2.3.m3.1.1.3.cmml" xref="A2.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.3.m3.1c">c_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.3.m3.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> indicates whether further interaction is required after this step. We generate the affordance map <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="A2.SS1.p2.4.m4.1"><semantics id="A2.SS1.p2.4.m4.1a"><msub id="A2.SS1.p2.4.m4.1.1" xref="A2.SS1.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p2.4.m4.1.1.2" xref="A2.SS1.p2.4.m4.1.1.2.cmml">ℳ</mi><mi id="A2.SS1.p2.4.m4.1.1.3" xref="A2.SS1.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.4.m4.1b"><apply id="A2.SS1.p2.4.m4.1.1.cmml" xref="A2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.4.m4.1.1.1.cmml" xref="A2.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="A2.SS1.p2.4.m4.1.1.2.cmml" xref="A2.SS1.p2.4.m4.1.1.2">ℳ</ci><ci id="A2.SS1.p2.4.m4.1.1.3.cmml" xref="A2.SS1.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.4.m4.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.4.m4.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> by feeding the observation image <math alttext="o_{t}" class="ltx_Math" display="inline" id="A2.SS1.p2.5.m5.1"><semantics id="A2.SS1.p2.5.m5.1a"><msub id="A2.SS1.p2.5.m5.1.1" xref="A2.SS1.p2.5.m5.1.1.cmml"><mi id="A2.SS1.p2.5.m5.1.1.2" xref="A2.SS1.p2.5.m5.1.1.2.cmml">o</mi><mi id="A2.SS1.p2.5.m5.1.1.3" xref="A2.SS1.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.5.m5.1b"><apply id="A2.SS1.p2.5.m5.1.1.cmml" xref="A2.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.5.m5.1.1.1.cmml" xref="A2.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="A2.SS1.p2.5.m5.1.1.2.cmml" xref="A2.SS1.p2.5.m5.1.1.2">𝑜</ci><ci id="A2.SS1.p2.5.m5.1.1.3.cmml" xref="A2.SS1.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.5.m5.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.5.m5.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and the current task instruction <math alttext="I" class="ltx_Math" display="inline" id="A2.SS1.p2.6.m6.1"><semantics id="A2.SS1.p2.6.m6.1a"><mi id="A2.SS1.p2.6.m6.1.1" xref="A2.SS1.p2.6.m6.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.6.m6.1b"><ci id="A2.SS1.p2.6.m6.1.1.cmml" xref="A2.SS1.p2.6.m6.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.6.m6.1c">I</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.6.m6.1d">italic_I</annotation></semantics></math> into the multimodal U-Net. Based on the visual observation and the affordance map, we calculate the MineCLIP reward and the affordance-driven intrinsic reward <math alttext="r_{t}^{i}" class="ltx_Math" display="inline" id="A2.SS1.p2.7.m7.1"><semantics id="A2.SS1.p2.7.m7.1a"><msubsup id="A2.SS1.p2.7.m7.1.1" xref="A2.SS1.p2.7.m7.1.1.cmml"><mi id="A2.SS1.p2.7.m7.1.1.2.2" xref="A2.SS1.p2.7.m7.1.1.2.2.cmml">r</mi><mi id="A2.SS1.p2.7.m7.1.1.2.3" xref="A2.SS1.p2.7.m7.1.1.2.3.cmml">t</mi><mi id="A2.SS1.p2.7.m7.1.1.3" xref="A2.SS1.p2.7.m7.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.7.m7.1b"><apply id="A2.SS1.p2.7.m7.1.1.cmml" xref="A2.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.7.m7.1.1.1.cmml" xref="A2.SS1.p2.7.m7.1.1">superscript</csymbol><apply id="A2.SS1.p2.7.m7.1.1.2.cmml" xref="A2.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.7.m7.1.1.2.1.cmml" xref="A2.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="A2.SS1.p2.7.m7.1.1.2.2.cmml" xref="A2.SS1.p2.7.m7.1.1.2.2">𝑟</ci><ci id="A2.SS1.p2.7.m7.1.1.2.3.cmml" xref="A2.SS1.p2.7.m7.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p2.7.m7.1.1.3.cmml" xref="A2.SS1.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.7.m7.1c">r_{t}^{i}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.7.m7.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> using Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.E1" title="In 3.2.3 Affordance-Driven Intrinsic Reward ‣ 3.2 Affordance Map and Intrinsic Reward ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">1</span></a>). The total reward is computed as a weighted sum of the environmental reward <math alttext="r_{t}^{e}" class="ltx_Math" display="inline" id="A2.SS1.p2.8.m8.1"><semantics id="A2.SS1.p2.8.m8.1a"><msubsup id="A2.SS1.p2.8.m8.1.1" xref="A2.SS1.p2.8.m8.1.1.cmml"><mi id="A2.SS1.p2.8.m8.1.1.2.2" xref="A2.SS1.p2.8.m8.1.1.2.2.cmml">r</mi><mi id="A2.SS1.p2.8.m8.1.1.2.3" xref="A2.SS1.p2.8.m8.1.1.2.3.cmml">t</mi><mi id="A2.SS1.p2.8.m8.1.1.3" xref="A2.SS1.p2.8.m8.1.1.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.8.m8.1b"><apply id="A2.SS1.p2.8.m8.1.1.cmml" xref="A2.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.8.m8.1.1.1.cmml" xref="A2.SS1.p2.8.m8.1.1">superscript</csymbol><apply id="A2.SS1.p2.8.m8.1.1.2.cmml" xref="A2.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.8.m8.1.1.2.1.cmml" xref="A2.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="A2.SS1.p2.8.m8.1.1.2.2.cmml" xref="A2.SS1.p2.8.m8.1.1.2.2">𝑟</ci><ci id="A2.SS1.p2.8.m8.1.1.2.3.cmml" xref="A2.SS1.p2.8.m8.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p2.8.m8.1.1.3.cmml" xref="A2.SS1.p2.8.m8.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.8.m8.1c">r_{t}^{e}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.8.m8.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT</annotation></semantics></math>, the MineCLIP reward, and the intrinsic reward, <math alttext="r_{t}=r^{e}_{t}+r_{t}^{\text{MineCLIP}}+\alpha r^{i}_{t}" class="ltx_Math" display="inline" id="A2.SS1.p2.9.m9.1"><semantics id="A2.SS1.p2.9.m9.1a"><mrow id="A2.SS1.p2.9.m9.1.1" xref="A2.SS1.p2.9.m9.1.1.cmml"><msub id="A2.SS1.p2.9.m9.1.1.2" xref="A2.SS1.p2.9.m9.1.1.2.cmml"><mi id="A2.SS1.p2.9.m9.1.1.2.2" xref="A2.SS1.p2.9.m9.1.1.2.2.cmml">r</mi><mi id="A2.SS1.p2.9.m9.1.1.2.3" xref="A2.SS1.p2.9.m9.1.1.2.3.cmml">t</mi></msub><mo id="A2.SS1.p2.9.m9.1.1.1" xref="A2.SS1.p2.9.m9.1.1.1.cmml">=</mo><mrow id="A2.SS1.p2.9.m9.1.1.3" xref="A2.SS1.p2.9.m9.1.1.3.cmml"><msubsup id="A2.SS1.p2.9.m9.1.1.3.2" xref="A2.SS1.p2.9.m9.1.1.3.2.cmml"><mi id="A2.SS1.p2.9.m9.1.1.3.2.2.2" xref="A2.SS1.p2.9.m9.1.1.3.2.2.2.cmml">r</mi><mi id="A2.SS1.p2.9.m9.1.1.3.2.3" xref="A2.SS1.p2.9.m9.1.1.3.2.3.cmml">t</mi><mi id="A2.SS1.p2.9.m9.1.1.3.2.2.3" xref="A2.SS1.p2.9.m9.1.1.3.2.2.3.cmml">e</mi></msubsup><mo id="A2.SS1.p2.9.m9.1.1.3.1" xref="A2.SS1.p2.9.m9.1.1.3.1.cmml">+</mo><msubsup id="A2.SS1.p2.9.m9.1.1.3.3" xref="A2.SS1.p2.9.m9.1.1.3.3.cmml"><mi id="A2.SS1.p2.9.m9.1.1.3.3.2.2" xref="A2.SS1.p2.9.m9.1.1.3.3.2.2.cmml">r</mi><mi id="A2.SS1.p2.9.m9.1.1.3.3.2.3" xref="A2.SS1.p2.9.m9.1.1.3.3.2.3.cmml">t</mi><mtext id="A2.SS1.p2.9.m9.1.1.3.3.3" xref="A2.SS1.p2.9.m9.1.1.3.3.3a.cmml">MineCLIP</mtext></msubsup><mo id="A2.SS1.p2.9.m9.1.1.3.1a" xref="A2.SS1.p2.9.m9.1.1.3.1.cmml">+</mo><mrow id="A2.SS1.p2.9.m9.1.1.3.4" xref="A2.SS1.p2.9.m9.1.1.3.4.cmml"><mi id="A2.SS1.p2.9.m9.1.1.3.4.2" xref="A2.SS1.p2.9.m9.1.1.3.4.2.cmml">α</mi><mo id="A2.SS1.p2.9.m9.1.1.3.4.1" xref="A2.SS1.p2.9.m9.1.1.3.4.1.cmml">⁢</mo><msubsup id="A2.SS1.p2.9.m9.1.1.3.4.3" xref="A2.SS1.p2.9.m9.1.1.3.4.3.cmml"><mi id="A2.SS1.p2.9.m9.1.1.3.4.3.2.2" xref="A2.SS1.p2.9.m9.1.1.3.4.3.2.2.cmml">r</mi><mi id="A2.SS1.p2.9.m9.1.1.3.4.3.3" xref="A2.SS1.p2.9.m9.1.1.3.4.3.3.cmml">t</mi><mi id="A2.SS1.p2.9.m9.1.1.3.4.3.2.3" xref="A2.SS1.p2.9.m9.1.1.3.4.3.2.3.cmml">i</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.9.m9.1b"><apply id="A2.SS1.p2.9.m9.1.1.cmml" xref="A2.SS1.p2.9.m9.1.1"><eq id="A2.SS1.p2.9.m9.1.1.1.cmml" xref="A2.SS1.p2.9.m9.1.1.1"></eq><apply id="A2.SS1.p2.9.m9.1.1.2.cmml" xref="A2.SS1.p2.9.m9.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.1.1.2.1.cmml" xref="A2.SS1.p2.9.m9.1.1.2">subscript</csymbol><ci id="A2.SS1.p2.9.m9.1.1.2.2.cmml" xref="A2.SS1.p2.9.m9.1.1.2.2">𝑟</ci><ci id="A2.SS1.p2.9.m9.1.1.2.3.cmml" xref="A2.SS1.p2.9.m9.1.1.2.3">𝑡</ci></apply><apply id="A2.SS1.p2.9.m9.1.1.3.cmml" xref="A2.SS1.p2.9.m9.1.1.3"><plus id="A2.SS1.p2.9.m9.1.1.3.1.cmml" xref="A2.SS1.p2.9.m9.1.1.3.1"></plus><apply id="A2.SS1.p2.9.m9.1.1.3.2.cmml" xref="A2.SS1.p2.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.1.1.3.2.1.cmml" xref="A2.SS1.p2.9.m9.1.1.3.2">subscript</csymbol><apply id="A2.SS1.p2.9.m9.1.1.3.2.2.cmml" xref="A2.SS1.p2.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.1.1.3.2.2.1.cmml" xref="A2.SS1.p2.9.m9.1.1.3.2">superscript</csymbol><ci id="A2.SS1.p2.9.m9.1.1.3.2.2.2.cmml" xref="A2.SS1.p2.9.m9.1.1.3.2.2.2">𝑟</ci><ci id="A2.SS1.p2.9.m9.1.1.3.2.2.3.cmml" xref="A2.SS1.p2.9.m9.1.1.3.2.2.3">𝑒</ci></apply><ci id="A2.SS1.p2.9.m9.1.1.3.2.3.cmml" xref="A2.SS1.p2.9.m9.1.1.3.2.3">𝑡</ci></apply><apply id="A2.SS1.p2.9.m9.1.1.3.3.cmml" xref="A2.SS1.p2.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.1.1.3.3.1.cmml" xref="A2.SS1.p2.9.m9.1.1.3.3">superscript</csymbol><apply id="A2.SS1.p2.9.m9.1.1.3.3.2.cmml" xref="A2.SS1.p2.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.1.1.3.3.2.1.cmml" xref="A2.SS1.p2.9.m9.1.1.3.3">subscript</csymbol><ci id="A2.SS1.p2.9.m9.1.1.3.3.2.2.cmml" xref="A2.SS1.p2.9.m9.1.1.3.3.2.2">𝑟</ci><ci id="A2.SS1.p2.9.m9.1.1.3.3.2.3.cmml" xref="A2.SS1.p2.9.m9.1.1.3.3.2.3">𝑡</ci></apply><ci id="A2.SS1.p2.9.m9.1.1.3.3.3a.cmml" xref="A2.SS1.p2.9.m9.1.1.3.3.3"><mtext id="A2.SS1.p2.9.m9.1.1.3.3.3.cmml" mathsize="70%" xref="A2.SS1.p2.9.m9.1.1.3.3.3">MineCLIP</mtext></ci></apply><apply id="A2.SS1.p2.9.m9.1.1.3.4.cmml" xref="A2.SS1.p2.9.m9.1.1.3.4"><times id="A2.SS1.p2.9.m9.1.1.3.4.1.cmml" xref="A2.SS1.p2.9.m9.1.1.3.4.1"></times><ci id="A2.SS1.p2.9.m9.1.1.3.4.2.cmml" xref="A2.SS1.p2.9.m9.1.1.3.4.2">𝛼</ci><apply id="A2.SS1.p2.9.m9.1.1.3.4.3.cmml" xref="A2.SS1.p2.9.m9.1.1.3.4.3"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.1.1.3.4.3.1.cmml" xref="A2.SS1.p2.9.m9.1.1.3.4.3">subscript</csymbol><apply id="A2.SS1.p2.9.m9.1.1.3.4.3.2.cmml" xref="A2.SS1.p2.9.m9.1.1.3.4.3"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.1.1.3.4.3.2.1.cmml" xref="A2.SS1.p2.9.m9.1.1.3.4.3">superscript</csymbol><ci id="A2.SS1.p2.9.m9.1.1.3.4.3.2.2.cmml" xref="A2.SS1.p2.9.m9.1.1.3.4.3.2.2">𝑟</ci><ci id="A2.SS1.p2.9.m9.1.1.3.4.3.2.3.cmml" xref="A2.SS1.p2.9.m9.1.1.3.4.3.2.3">𝑖</ci></apply><ci id="A2.SS1.p2.9.m9.1.1.3.4.3.3.cmml" xref="A2.SS1.p2.9.m9.1.1.3.4.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.9.m9.1c">r_{t}=r^{e}_{t}+r_{t}^{\text{MineCLIP}}+\alpha r^{i}_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.9.m9.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_r start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT MineCLIP end_POSTSUPERSCRIPT + italic_α italic_r start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\alpha" class="ltx_Math" display="inline" id="A2.SS1.p2.10.m10.1"><semantics id="A2.SS1.p2.10.m10.1a"><mi id="A2.SS1.p2.10.m10.1.1" xref="A2.SS1.p2.10.m10.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.10.m10.1b"><ci id="A2.SS1.p2.10.m10.1.1.cmml" xref="A2.SS1.p2.10.m10.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.10.m10.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.10.m10.1d">italic_α</annotation></semantics></math> is a hyperparameter. We also compute the jump probability <math alttext="P_{\text{jump}}" class="ltx_Math" display="inline" id="A2.SS1.p2.11.m11.1"><semantics id="A2.SS1.p2.11.m11.1a"><msub id="A2.SS1.p2.11.m11.1.1" xref="A2.SS1.p2.11.m11.1.1.cmml"><mi id="A2.SS1.p2.11.m11.1.1.2" xref="A2.SS1.p2.11.m11.1.1.2.cmml">P</mi><mtext id="A2.SS1.p2.11.m11.1.1.3" xref="A2.SS1.p2.11.m11.1.1.3a.cmml">jump</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.11.m11.1b"><apply id="A2.SS1.p2.11.m11.1.1.cmml" xref="A2.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.11.m11.1.1.1.cmml" xref="A2.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="A2.SS1.p2.11.m11.1.1.2.cmml" xref="A2.SS1.p2.11.m11.1.1.2">𝑃</ci><ci id="A2.SS1.p2.11.m11.1.1.3a.cmml" xref="A2.SS1.p2.11.m11.1.1.3"><mtext id="A2.SS1.p2.11.m11.1.1.3.cmml" mathsize="70%" xref="A2.SS1.p2.11.m11.1.1.3">jump</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.11.m11.1c">P_{\text{jump}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.11.m11.1d">italic_P start_POSTSUBSCRIPT jump end_POSTSUBSCRIPT</annotation></semantics></math> using Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.E4" title="In 3.3.1 Learning Jumping Flags ‣ 3.3 Long Short-Term World Model ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">4</span></a>) based on the affordance map to determine whether a distant target is present in the observation, indicating the need for a jumpy transition. The jump flag <math alttext="j_{t}" class="ltx_Math" display="inline" id="A2.SS1.p2.12.m12.1"><semantics id="A2.SS1.p2.12.m12.1a"><msub id="A2.SS1.p2.12.m12.1.1" xref="A2.SS1.p2.12.m12.1.1.cmml"><mi id="A2.SS1.p2.12.m12.1.1.2" xref="A2.SS1.p2.12.m12.1.1.2.cmml">j</mi><mi id="A2.SS1.p2.12.m12.1.1.3" xref="A2.SS1.p2.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.12.m12.1b"><apply id="A2.SS1.p2.12.m12.1.1.cmml" xref="A2.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.12.m12.1.1.1.cmml" xref="A2.SS1.p2.12.m12.1.1">subscript</csymbol><ci id="A2.SS1.p2.12.m12.1.1.2.cmml" xref="A2.SS1.p2.12.m12.1.1.2">𝑗</ci><ci id="A2.SS1.p2.12.m12.1.1.3.cmml" xref="A2.SS1.p2.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.12.m12.1c">j_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.12.m12.1d">italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is determined by setting a threshold, which is the average of all previous jump probabilities plus the standard deviation. If <math alttext="P_{\text{jump}}" class="ltx_Math" display="inline" id="A2.SS1.p2.13.m13.1"><semantics id="A2.SS1.p2.13.m13.1a"><msub id="A2.SS1.p2.13.m13.1.1" xref="A2.SS1.p2.13.m13.1.1.cmml"><mi id="A2.SS1.p2.13.m13.1.1.2" xref="A2.SS1.p2.13.m13.1.1.2.cmml">P</mi><mtext id="A2.SS1.p2.13.m13.1.1.3" xref="A2.SS1.p2.13.m13.1.1.3a.cmml">jump</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.13.m13.1b"><apply id="A2.SS1.p2.13.m13.1.1.cmml" xref="A2.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.13.m13.1.1.1.cmml" xref="A2.SS1.p2.13.m13.1.1">subscript</csymbol><ci id="A2.SS1.p2.13.m13.1.1.2.cmml" xref="A2.SS1.p2.13.m13.1.1.2">𝑃</ci><ci id="A2.SS1.p2.13.m13.1.1.3a.cmml" xref="A2.SS1.p2.13.m13.1.1.3"><mtext id="A2.SS1.p2.13.m13.1.1.3.cmml" mathsize="70%" xref="A2.SS1.p2.13.m13.1.1.3">jump</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.13.m13.1c">P_{\text{jump}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.13.m13.1d">italic_P start_POSTSUBSCRIPT jump end_POSTSUBSCRIPT</annotation></semantics></math> exceeds this threshold, the jump flag <math alttext="j_{t}" class="ltx_Math" display="inline" id="A2.SS1.p2.14.m14.1"><semantics id="A2.SS1.p2.14.m14.1a"><msub id="A2.SS1.p2.14.m14.1.1" xref="A2.SS1.p2.14.m14.1.1.cmml"><mi id="A2.SS1.p2.14.m14.1.1.2" xref="A2.SS1.p2.14.m14.1.1.2.cmml">j</mi><mi id="A2.SS1.p2.14.m14.1.1.3" xref="A2.SS1.p2.14.m14.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.14.m14.1b"><apply id="A2.SS1.p2.14.m14.1.1.cmml" xref="A2.SS1.p2.14.m14.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.14.m14.1.1.1.cmml" xref="A2.SS1.p2.14.m14.1.1">subscript</csymbol><ci id="A2.SS1.p2.14.m14.1.1.2.cmml" xref="A2.SS1.p2.14.m14.1.1.2">𝑗</ci><ci id="A2.SS1.p2.14.m14.1.1.3.cmml" xref="A2.SS1.p2.14.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.14.m14.1c">j_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.14.m14.1d">italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is True.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p3">
<p class="ltx_p" id="A2.SS1.p3.4"><math alttext="\Delta_{t}" class="ltx_Math" display="inline" id="A2.SS1.p3.1.m1.1"><semantics id="A2.SS1.p3.1.m1.1a"><msub id="A2.SS1.p3.1.m1.1.1" xref="A2.SS1.p3.1.m1.1.1.cmml"><mi id="A2.SS1.p3.1.m1.1.1.2" mathvariant="normal" xref="A2.SS1.p3.1.m1.1.1.2.cmml">Δ</mi><mi id="A2.SS1.p3.1.m1.1.1.3" xref="A2.SS1.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.1.m1.1b"><apply id="A2.SS1.p3.1.m1.1.1.cmml" xref="A2.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p3.1.m1.1.1.1.cmml" xref="A2.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p3.1.m1.1.1.2.cmml" xref="A2.SS1.p3.1.m1.1.1.2">Δ</ci><ci id="A2.SS1.p3.1.m1.1.1.3.cmml" xref="A2.SS1.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.1.m1.1c">\Delta_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="G_{t}" class="ltx_Math" display="inline" id="A2.SS1.p3.2.m2.1"><semantics id="A2.SS1.p3.2.m2.1a"><msub id="A2.SS1.p3.2.m2.1.1" xref="A2.SS1.p3.2.m2.1.1.cmml"><mi id="A2.SS1.p3.2.m2.1.1.2" xref="A2.SS1.p3.2.m2.1.1.2.cmml">G</mi><mi id="A2.SS1.p3.2.m2.1.1.3" xref="A2.SS1.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.2.m2.1b"><apply id="A2.SS1.p3.2.m2.1.1.cmml" xref="A2.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS1.p3.2.m2.1.1.1.cmml" xref="A2.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="A2.SS1.p3.2.m2.1.1.2.cmml" xref="A2.SS1.p3.2.m2.1.1.2">𝐺</ci><ci id="A2.SS1.p3.2.m2.1.1.3.cmml" xref="A2.SS1.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.2.m2.1c">G_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.2.m2.1d">italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represent the number of steps between transitions and the cumulative discounted reward obtained during this period, respectively. For short-term transitions, where only one environmental step occurs, we set <math alttext="\Delta_{t}=1" class="ltx_Math" display="inline" id="A2.SS1.p3.3.m3.1"><semantics id="A2.SS1.p3.3.m3.1a"><mrow id="A2.SS1.p3.3.m3.1.1" xref="A2.SS1.p3.3.m3.1.1.cmml"><msub id="A2.SS1.p3.3.m3.1.1.2" xref="A2.SS1.p3.3.m3.1.1.2.cmml"><mi id="A2.SS1.p3.3.m3.1.1.2.2" mathvariant="normal" xref="A2.SS1.p3.3.m3.1.1.2.2.cmml">Δ</mi><mi id="A2.SS1.p3.3.m3.1.1.2.3" xref="A2.SS1.p3.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="A2.SS1.p3.3.m3.1.1.1" xref="A2.SS1.p3.3.m3.1.1.1.cmml">=</mo><mn id="A2.SS1.p3.3.m3.1.1.3" xref="A2.SS1.p3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.3.m3.1b"><apply id="A2.SS1.p3.3.m3.1.1.cmml" xref="A2.SS1.p3.3.m3.1.1"><eq id="A2.SS1.p3.3.m3.1.1.1.cmml" xref="A2.SS1.p3.3.m3.1.1.1"></eq><apply id="A2.SS1.p3.3.m3.1.1.2.cmml" xref="A2.SS1.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p3.3.m3.1.1.2.1.cmml" xref="A2.SS1.p3.3.m3.1.1.2">subscript</csymbol><ci id="A2.SS1.p3.3.m3.1.1.2.2.cmml" xref="A2.SS1.p3.3.m3.1.1.2.2">Δ</ci><ci id="A2.SS1.p3.3.m3.1.1.2.3.cmml" xref="A2.SS1.p3.3.m3.1.1.2.3">𝑡</ci></apply><cn id="A2.SS1.p3.3.m3.1.1.3.cmml" type="integer" xref="A2.SS1.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.3.m3.1c">\Delta_{t}=1</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.3.m3.1d">roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = 1</annotation></semantics></math> and <math alttext="G_{t}=r_{t}" class="ltx_Math" display="inline" id="A2.SS1.p3.4.m4.1"><semantics id="A2.SS1.p3.4.m4.1a"><mrow id="A2.SS1.p3.4.m4.1.1" xref="A2.SS1.p3.4.m4.1.1.cmml"><msub id="A2.SS1.p3.4.m4.1.1.2" xref="A2.SS1.p3.4.m4.1.1.2.cmml"><mi id="A2.SS1.p3.4.m4.1.1.2.2" xref="A2.SS1.p3.4.m4.1.1.2.2.cmml">G</mi><mi id="A2.SS1.p3.4.m4.1.1.2.3" xref="A2.SS1.p3.4.m4.1.1.2.3.cmml">t</mi></msub><mo id="A2.SS1.p3.4.m4.1.1.1" xref="A2.SS1.p3.4.m4.1.1.1.cmml">=</mo><msub id="A2.SS1.p3.4.m4.1.1.3" xref="A2.SS1.p3.4.m4.1.1.3.cmml"><mi id="A2.SS1.p3.4.m4.1.1.3.2" xref="A2.SS1.p3.4.m4.1.1.3.2.cmml">r</mi><mi id="A2.SS1.p3.4.m4.1.1.3.3" xref="A2.SS1.p3.4.m4.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.4.m4.1b"><apply id="A2.SS1.p3.4.m4.1.1.cmml" xref="A2.SS1.p3.4.m4.1.1"><eq id="A2.SS1.p3.4.m4.1.1.1.cmml" xref="A2.SS1.p3.4.m4.1.1.1"></eq><apply id="A2.SS1.p3.4.m4.1.1.2.cmml" xref="A2.SS1.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p3.4.m4.1.1.2.1.cmml" xref="A2.SS1.p3.4.m4.1.1.2">subscript</csymbol><ci id="A2.SS1.p3.4.m4.1.1.2.2.cmml" xref="A2.SS1.p3.4.m4.1.1.2.2">𝐺</ci><ci id="A2.SS1.p3.4.m4.1.1.2.3.cmml" xref="A2.SS1.p3.4.m4.1.1.2.3">𝑡</ci></apply><apply id="A2.SS1.p3.4.m4.1.1.3.cmml" xref="A2.SS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p3.4.m4.1.1.3.1.cmml" xref="A2.SS1.p3.4.m4.1.1.3">subscript</csymbol><ci id="A2.SS1.p3.4.m4.1.1.3.2.cmml" xref="A2.SS1.p3.4.m4.1.1.3.2">𝑟</ci><ci id="A2.SS1.p3.4.m4.1.1.3.3.cmml" xref="A2.SS1.p3.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.4.m4.1c">G_{t}=r_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.4.m4.1d">italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p4">
<p class="ltx_p" id="A2.SS1.p4.2">If the jump flag is True, this indicates that the agent has observed a distant target, and a jumpy transition (i.e., a long-term transition) can be performed to transition to a state closer to the target. In this case, we need to collect the long-term transition data sequence <math alttext="\mathcal{D}_{t}^{\prime}" class="ltx_Math" display="inline" id="A2.SS1.p4.1.m1.1"><semantics id="A2.SS1.p4.1.m1.1a"><msubsup id="A2.SS1.p4.1.m1.1.1" xref="A2.SS1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p4.1.m1.1.1.2.2" xref="A2.SS1.p4.1.m1.1.1.2.2.cmml">𝒟</mi><mi id="A2.SS1.p4.1.m1.1.1.2.3" xref="A2.SS1.p4.1.m1.1.1.2.3.cmml">t</mi><mo id="A2.SS1.p4.1.m1.1.1.3" xref="A2.SS1.p4.1.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.1.m1.1b"><apply id="A2.SS1.p4.1.m1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p4.1.m1.1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1">superscript</csymbol><apply id="A2.SS1.p4.1.m1.1.1.2.cmml" xref="A2.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p4.1.m1.1.1.2.1.cmml" xref="A2.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p4.1.m1.1.1.2.2.cmml" xref="A2.SS1.p4.1.m1.1.1.2.2">𝒟</ci><ci id="A2.SS1.p4.1.m1.1.1.2.3.cmml" xref="A2.SS1.p4.1.m1.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p4.1.m1.1.1.3.cmml" xref="A2.SS1.p4.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.1.m1.1c">\mathcal{D}_{t}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, which includes: <math alttext="\{o_{t}^{\prime},a_{t}^{\prime},r_{t}^{\prime},c_{t}^{\prime},\mathcal{M}_{t}^%
{\prime},j_{t}^{\prime},\Delta_{t}^{\prime},G_{t}^{\prime}\}" class="ltx_Math" display="inline" id="A2.SS1.p4.2.m2.8"><semantics id="A2.SS1.p4.2.m2.8a"><mrow id="A2.SS1.p4.2.m2.8.8.8" xref="A2.SS1.p4.2.m2.8.8.9.cmml"><mo id="A2.SS1.p4.2.m2.8.8.8.9" stretchy="false" xref="A2.SS1.p4.2.m2.8.8.9.cmml">{</mo><msubsup id="A2.SS1.p4.2.m2.1.1.1.1" xref="A2.SS1.p4.2.m2.1.1.1.1.cmml"><mi id="A2.SS1.p4.2.m2.1.1.1.1.2.2" xref="A2.SS1.p4.2.m2.1.1.1.1.2.2.cmml">o</mi><mi id="A2.SS1.p4.2.m2.1.1.1.1.2.3" xref="A2.SS1.p4.2.m2.1.1.1.1.2.3.cmml">t</mi><mo id="A2.SS1.p4.2.m2.1.1.1.1.3" xref="A2.SS1.p4.2.m2.1.1.1.1.3.cmml">′</mo></msubsup><mo id="A2.SS1.p4.2.m2.8.8.8.10" xref="A2.SS1.p4.2.m2.8.8.9.cmml">,</mo><msubsup id="A2.SS1.p4.2.m2.2.2.2.2" xref="A2.SS1.p4.2.m2.2.2.2.2.cmml"><mi id="A2.SS1.p4.2.m2.2.2.2.2.2.2" xref="A2.SS1.p4.2.m2.2.2.2.2.2.2.cmml">a</mi><mi id="A2.SS1.p4.2.m2.2.2.2.2.2.3" xref="A2.SS1.p4.2.m2.2.2.2.2.2.3.cmml">t</mi><mo id="A2.SS1.p4.2.m2.2.2.2.2.3" xref="A2.SS1.p4.2.m2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="A2.SS1.p4.2.m2.8.8.8.11" xref="A2.SS1.p4.2.m2.8.8.9.cmml">,</mo><msubsup id="A2.SS1.p4.2.m2.3.3.3.3" xref="A2.SS1.p4.2.m2.3.3.3.3.cmml"><mi id="A2.SS1.p4.2.m2.3.3.3.3.2.2" xref="A2.SS1.p4.2.m2.3.3.3.3.2.2.cmml">r</mi><mi id="A2.SS1.p4.2.m2.3.3.3.3.2.3" xref="A2.SS1.p4.2.m2.3.3.3.3.2.3.cmml">t</mi><mo id="A2.SS1.p4.2.m2.3.3.3.3.3" xref="A2.SS1.p4.2.m2.3.3.3.3.3.cmml">′</mo></msubsup><mo id="A2.SS1.p4.2.m2.8.8.8.12" xref="A2.SS1.p4.2.m2.8.8.9.cmml">,</mo><msubsup id="A2.SS1.p4.2.m2.4.4.4.4" xref="A2.SS1.p4.2.m2.4.4.4.4.cmml"><mi id="A2.SS1.p4.2.m2.4.4.4.4.2.2" xref="A2.SS1.p4.2.m2.4.4.4.4.2.2.cmml">c</mi><mi id="A2.SS1.p4.2.m2.4.4.4.4.2.3" xref="A2.SS1.p4.2.m2.4.4.4.4.2.3.cmml">t</mi><mo id="A2.SS1.p4.2.m2.4.4.4.4.3" xref="A2.SS1.p4.2.m2.4.4.4.4.3.cmml">′</mo></msubsup><mo id="A2.SS1.p4.2.m2.8.8.8.13" xref="A2.SS1.p4.2.m2.8.8.9.cmml">,</mo><msubsup id="A2.SS1.p4.2.m2.5.5.5.5" xref="A2.SS1.p4.2.m2.5.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p4.2.m2.5.5.5.5.2.2" xref="A2.SS1.p4.2.m2.5.5.5.5.2.2.cmml">ℳ</mi><mi id="A2.SS1.p4.2.m2.5.5.5.5.2.3" xref="A2.SS1.p4.2.m2.5.5.5.5.2.3.cmml">t</mi><mo id="A2.SS1.p4.2.m2.5.5.5.5.3" xref="A2.SS1.p4.2.m2.5.5.5.5.3.cmml">′</mo></msubsup><mo id="A2.SS1.p4.2.m2.8.8.8.14" xref="A2.SS1.p4.2.m2.8.8.9.cmml">,</mo><msubsup id="A2.SS1.p4.2.m2.6.6.6.6" xref="A2.SS1.p4.2.m2.6.6.6.6.cmml"><mi id="A2.SS1.p4.2.m2.6.6.6.6.2.2" xref="A2.SS1.p4.2.m2.6.6.6.6.2.2.cmml">j</mi><mi id="A2.SS1.p4.2.m2.6.6.6.6.2.3" xref="A2.SS1.p4.2.m2.6.6.6.6.2.3.cmml">t</mi><mo id="A2.SS1.p4.2.m2.6.6.6.6.3" xref="A2.SS1.p4.2.m2.6.6.6.6.3.cmml">′</mo></msubsup><mo id="A2.SS1.p4.2.m2.8.8.8.15" xref="A2.SS1.p4.2.m2.8.8.9.cmml">,</mo><msubsup id="A2.SS1.p4.2.m2.7.7.7.7" xref="A2.SS1.p4.2.m2.7.7.7.7.cmml"><mi id="A2.SS1.p4.2.m2.7.7.7.7.2.2" mathvariant="normal" xref="A2.SS1.p4.2.m2.7.7.7.7.2.2.cmml">Δ</mi><mi id="A2.SS1.p4.2.m2.7.7.7.7.2.3" xref="A2.SS1.p4.2.m2.7.7.7.7.2.3.cmml">t</mi><mo id="A2.SS1.p4.2.m2.7.7.7.7.3" xref="A2.SS1.p4.2.m2.7.7.7.7.3.cmml">′</mo></msubsup><mo id="A2.SS1.p4.2.m2.8.8.8.16" xref="A2.SS1.p4.2.m2.8.8.9.cmml">,</mo><msubsup id="A2.SS1.p4.2.m2.8.8.8.8" xref="A2.SS1.p4.2.m2.8.8.8.8.cmml"><mi id="A2.SS1.p4.2.m2.8.8.8.8.2.2" xref="A2.SS1.p4.2.m2.8.8.8.8.2.2.cmml">G</mi><mi id="A2.SS1.p4.2.m2.8.8.8.8.2.3" xref="A2.SS1.p4.2.m2.8.8.8.8.2.3.cmml">t</mi><mo id="A2.SS1.p4.2.m2.8.8.8.8.3" xref="A2.SS1.p4.2.m2.8.8.8.8.3.cmml">′</mo></msubsup><mo id="A2.SS1.p4.2.m2.8.8.8.17" stretchy="false" xref="A2.SS1.p4.2.m2.8.8.9.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.2.m2.8b"><set id="A2.SS1.p4.2.m2.8.8.9.cmml" xref="A2.SS1.p4.2.m2.8.8.8"><apply id="A2.SS1.p4.2.m2.1.1.1.1.cmml" xref="A2.SS1.p4.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.1.1.1.1.1.cmml" xref="A2.SS1.p4.2.m2.1.1.1.1">superscript</csymbol><apply id="A2.SS1.p4.2.m2.1.1.1.1.2.cmml" xref="A2.SS1.p4.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.1.1.1.1.2.1.cmml" xref="A2.SS1.p4.2.m2.1.1.1.1">subscript</csymbol><ci id="A2.SS1.p4.2.m2.1.1.1.1.2.2.cmml" xref="A2.SS1.p4.2.m2.1.1.1.1.2.2">𝑜</ci><ci id="A2.SS1.p4.2.m2.1.1.1.1.2.3.cmml" xref="A2.SS1.p4.2.m2.1.1.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p4.2.m2.1.1.1.1.3.cmml" xref="A2.SS1.p4.2.m2.1.1.1.1.3">′</ci></apply><apply id="A2.SS1.p4.2.m2.2.2.2.2.cmml" xref="A2.SS1.p4.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.2.2.2.2.1.cmml" xref="A2.SS1.p4.2.m2.2.2.2.2">superscript</csymbol><apply id="A2.SS1.p4.2.m2.2.2.2.2.2.cmml" xref="A2.SS1.p4.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.2.2.2.2.2.1.cmml" xref="A2.SS1.p4.2.m2.2.2.2.2">subscript</csymbol><ci id="A2.SS1.p4.2.m2.2.2.2.2.2.2.cmml" xref="A2.SS1.p4.2.m2.2.2.2.2.2.2">𝑎</ci><ci id="A2.SS1.p4.2.m2.2.2.2.2.2.3.cmml" xref="A2.SS1.p4.2.m2.2.2.2.2.2.3">𝑡</ci></apply><ci id="A2.SS1.p4.2.m2.2.2.2.2.3.cmml" xref="A2.SS1.p4.2.m2.2.2.2.2.3">′</ci></apply><apply id="A2.SS1.p4.2.m2.3.3.3.3.cmml" xref="A2.SS1.p4.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.3.3.3.3.1.cmml" xref="A2.SS1.p4.2.m2.3.3.3.3">superscript</csymbol><apply id="A2.SS1.p4.2.m2.3.3.3.3.2.cmml" xref="A2.SS1.p4.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.3.3.3.3.2.1.cmml" xref="A2.SS1.p4.2.m2.3.3.3.3">subscript</csymbol><ci id="A2.SS1.p4.2.m2.3.3.3.3.2.2.cmml" xref="A2.SS1.p4.2.m2.3.3.3.3.2.2">𝑟</ci><ci id="A2.SS1.p4.2.m2.3.3.3.3.2.3.cmml" xref="A2.SS1.p4.2.m2.3.3.3.3.2.3">𝑡</ci></apply><ci id="A2.SS1.p4.2.m2.3.3.3.3.3.cmml" xref="A2.SS1.p4.2.m2.3.3.3.3.3">′</ci></apply><apply id="A2.SS1.p4.2.m2.4.4.4.4.cmml" xref="A2.SS1.p4.2.m2.4.4.4.4"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.4.4.4.4.1.cmml" xref="A2.SS1.p4.2.m2.4.4.4.4">superscript</csymbol><apply id="A2.SS1.p4.2.m2.4.4.4.4.2.cmml" xref="A2.SS1.p4.2.m2.4.4.4.4"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.4.4.4.4.2.1.cmml" xref="A2.SS1.p4.2.m2.4.4.4.4">subscript</csymbol><ci id="A2.SS1.p4.2.m2.4.4.4.4.2.2.cmml" xref="A2.SS1.p4.2.m2.4.4.4.4.2.2">𝑐</ci><ci id="A2.SS1.p4.2.m2.4.4.4.4.2.3.cmml" xref="A2.SS1.p4.2.m2.4.4.4.4.2.3">𝑡</ci></apply><ci id="A2.SS1.p4.2.m2.4.4.4.4.3.cmml" xref="A2.SS1.p4.2.m2.4.4.4.4.3">′</ci></apply><apply id="A2.SS1.p4.2.m2.5.5.5.5.cmml" xref="A2.SS1.p4.2.m2.5.5.5.5"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.5.5.5.5.1.cmml" xref="A2.SS1.p4.2.m2.5.5.5.5">superscript</csymbol><apply id="A2.SS1.p4.2.m2.5.5.5.5.2.cmml" xref="A2.SS1.p4.2.m2.5.5.5.5"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.5.5.5.5.2.1.cmml" xref="A2.SS1.p4.2.m2.5.5.5.5">subscript</csymbol><ci id="A2.SS1.p4.2.m2.5.5.5.5.2.2.cmml" xref="A2.SS1.p4.2.m2.5.5.5.5.2.2">ℳ</ci><ci id="A2.SS1.p4.2.m2.5.5.5.5.2.3.cmml" xref="A2.SS1.p4.2.m2.5.5.5.5.2.3">𝑡</ci></apply><ci id="A2.SS1.p4.2.m2.5.5.5.5.3.cmml" xref="A2.SS1.p4.2.m2.5.5.5.5.3">′</ci></apply><apply id="A2.SS1.p4.2.m2.6.6.6.6.cmml" xref="A2.SS1.p4.2.m2.6.6.6.6"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.6.6.6.6.1.cmml" xref="A2.SS1.p4.2.m2.6.6.6.6">superscript</csymbol><apply id="A2.SS1.p4.2.m2.6.6.6.6.2.cmml" xref="A2.SS1.p4.2.m2.6.6.6.6"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.6.6.6.6.2.1.cmml" xref="A2.SS1.p4.2.m2.6.6.6.6">subscript</csymbol><ci id="A2.SS1.p4.2.m2.6.6.6.6.2.2.cmml" xref="A2.SS1.p4.2.m2.6.6.6.6.2.2">𝑗</ci><ci id="A2.SS1.p4.2.m2.6.6.6.6.2.3.cmml" xref="A2.SS1.p4.2.m2.6.6.6.6.2.3">𝑡</ci></apply><ci id="A2.SS1.p4.2.m2.6.6.6.6.3.cmml" xref="A2.SS1.p4.2.m2.6.6.6.6.3">′</ci></apply><apply id="A2.SS1.p4.2.m2.7.7.7.7.cmml" xref="A2.SS1.p4.2.m2.7.7.7.7"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.7.7.7.7.1.cmml" xref="A2.SS1.p4.2.m2.7.7.7.7">superscript</csymbol><apply id="A2.SS1.p4.2.m2.7.7.7.7.2.cmml" xref="A2.SS1.p4.2.m2.7.7.7.7"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.7.7.7.7.2.1.cmml" xref="A2.SS1.p4.2.m2.7.7.7.7">subscript</csymbol><ci id="A2.SS1.p4.2.m2.7.7.7.7.2.2.cmml" xref="A2.SS1.p4.2.m2.7.7.7.7.2.2">Δ</ci><ci id="A2.SS1.p4.2.m2.7.7.7.7.2.3.cmml" xref="A2.SS1.p4.2.m2.7.7.7.7.2.3">𝑡</ci></apply><ci id="A2.SS1.p4.2.m2.7.7.7.7.3.cmml" xref="A2.SS1.p4.2.m2.7.7.7.7.3">′</ci></apply><apply id="A2.SS1.p4.2.m2.8.8.8.8.cmml" xref="A2.SS1.p4.2.m2.8.8.8.8"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.8.8.8.8.1.cmml" xref="A2.SS1.p4.2.m2.8.8.8.8">superscript</csymbol><apply id="A2.SS1.p4.2.m2.8.8.8.8.2.cmml" xref="A2.SS1.p4.2.m2.8.8.8.8"><csymbol cd="ambiguous" id="A2.SS1.p4.2.m2.8.8.8.8.2.1.cmml" xref="A2.SS1.p4.2.m2.8.8.8.8">subscript</csymbol><ci id="A2.SS1.p4.2.m2.8.8.8.8.2.2.cmml" xref="A2.SS1.p4.2.m2.8.8.8.8.2.2">𝐺</ci><ci id="A2.SS1.p4.2.m2.8.8.8.8.2.3.cmml" xref="A2.SS1.p4.2.m2.8.8.8.8.2.3">𝑡</ci></apply><ci id="A2.SS1.p4.2.m2.8.8.8.8.3.cmml" xref="A2.SS1.p4.2.m2.8.8.8.8.3">′</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.2.m2.8c">\{o_{t}^{\prime},a_{t}^{\prime},r_{t}^{\prime},c_{t}^{\prime},\mathcal{M}_{t}^%
{\prime},j_{t}^{\prime},\Delta_{t}^{\prime},G_{t}^{\prime}\}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.2.m2.8d">{ italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT }</annotation></semantics></math>. Long-term transitions simulate the agent’s state at a future time after a sequence of exploration steps.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p5">
<p class="ltx_p" id="A2.SS1.p5.12">For the observation <math alttext="o_{t}^{\prime}" class="ltx_Math" display="inline" id="A2.SS1.p5.1.m1.1"><semantics id="A2.SS1.p5.1.m1.1a"><msubsup id="A2.SS1.p5.1.m1.1.1" xref="A2.SS1.p5.1.m1.1.1.cmml"><mi id="A2.SS1.p5.1.m1.1.1.2.2" xref="A2.SS1.p5.1.m1.1.1.2.2.cmml">o</mi><mi id="A2.SS1.p5.1.m1.1.1.2.3" xref="A2.SS1.p5.1.m1.1.1.2.3.cmml">t</mi><mo id="A2.SS1.p5.1.m1.1.1.3" xref="A2.SS1.p5.1.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.1.m1.1b"><apply id="A2.SS1.p5.1.m1.1.1.cmml" xref="A2.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.1.m1.1.1.1.cmml" xref="A2.SS1.p5.1.m1.1.1">superscript</csymbol><apply id="A2.SS1.p5.1.m1.1.1.2.cmml" xref="A2.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.1.m1.1.1.2.1.cmml" xref="A2.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p5.1.m1.1.1.2.2.cmml" xref="A2.SS1.p5.1.m1.1.1.2.2">𝑜</ci><ci id="A2.SS1.p5.1.m1.1.1.2.3.cmml" xref="A2.SS1.p5.1.m1.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p5.1.m1.1.1.3.cmml" xref="A2.SS1.p5.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.1.m1.1c">o_{t}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.1.m1.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, we crop the high-value regions from the original observation <math alttext="o_{t-1}" class="ltx_Math" display="inline" id="A2.SS1.p5.2.m2.1"><semantics id="A2.SS1.p5.2.m2.1a"><msub id="A2.SS1.p5.2.m2.1.1" xref="A2.SS1.p5.2.m2.1.1.cmml"><mi id="A2.SS1.p5.2.m2.1.1.2" xref="A2.SS1.p5.2.m2.1.1.2.cmml">o</mi><mrow id="A2.SS1.p5.2.m2.1.1.3" xref="A2.SS1.p5.2.m2.1.1.3.cmml"><mi id="A2.SS1.p5.2.m2.1.1.3.2" xref="A2.SS1.p5.2.m2.1.1.3.2.cmml">t</mi><mo id="A2.SS1.p5.2.m2.1.1.3.1" xref="A2.SS1.p5.2.m2.1.1.3.1.cmml">−</mo><mn id="A2.SS1.p5.2.m2.1.1.3.3" xref="A2.SS1.p5.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.2.m2.1b"><apply id="A2.SS1.p5.2.m2.1.1.cmml" xref="A2.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.2.m2.1.1.1.cmml" xref="A2.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="A2.SS1.p5.2.m2.1.1.2.cmml" xref="A2.SS1.p5.2.m2.1.1.2">𝑜</ci><apply id="A2.SS1.p5.2.m2.1.1.3.cmml" xref="A2.SS1.p5.2.m2.1.1.3"><minus id="A2.SS1.p5.2.m2.1.1.3.1.cmml" xref="A2.SS1.p5.2.m2.1.1.3.1"></minus><ci id="A2.SS1.p5.2.m2.1.1.3.2.cmml" xref="A2.SS1.p5.2.m2.1.1.3.2">𝑡</ci><cn id="A2.SS1.p5.2.m2.1.1.3.3.cmml" type="integer" xref="A2.SS1.p5.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.2.m2.1c">o_{t-1}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.2.m2.1d">italic_o start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> based on the affordance map <math alttext="\mathcal{M}_{t-1}" class="ltx_Math" display="inline" id="A2.SS1.p5.3.m3.1"><semantics id="A2.SS1.p5.3.m3.1a"><msub id="A2.SS1.p5.3.m3.1.1" xref="A2.SS1.p5.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p5.3.m3.1.1.2" xref="A2.SS1.p5.3.m3.1.1.2.cmml">ℳ</mi><mrow id="A2.SS1.p5.3.m3.1.1.3" xref="A2.SS1.p5.3.m3.1.1.3.cmml"><mi id="A2.SS1.p5.3.m3.1.1.3.2" xref="A2.SS1.p5.3.m3.1.1.3.2.cmml">t</mi><mo id="A2.SS1.p5.3.m3.1.1.3.1" xref="A2.SS1.p5.3.m3.1.1.3.1.cmml">−</mo><mn id="A2.SS1.p5.3.m3.1.1.3.3" xref="A2.SS1.p5.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.3.m3.1b"><apply id="A2.SS1.p5.3.m3.1.1.cmml" xref="A2.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.3.m3.1.1.1.cmml" xref="A2.SS1.p5.3.m3.1.1">subscript</csymbol><ci id="A2.SS1.p5.3.m3.1.1.2.cmml" xref="A2.SS1.p5.3.m3.1.1.2">ℳ</ci><apply id="A2.SS1.p5.3.m3.1.1.3.cmml" xref="A2.SS1.p5.3.m3.1.1.3"><minus id="A2.SS1.p5.3.m3.1.1.3.1.cmml" xref="A2.SS1.p5.3.m3.1.1.3.1"></minus><ci id="A2.SS1.p5.3.m3.1.1.3.2.cmml" xref="A2.SS1.p5.3.m3.1.1.3.2">𝑡</ci><cn id="A2.SS1.p5.3.m3.1.1.3.3.cmml" type="integer" xref="A2.SS1.p5.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.3.m3.1c">\mathcal{M}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.3.m3.1d">caligraphic_M start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> to simulate the image that the agent would observe after approaching the target. Similarly, we generate the affordance map <math alttext="\mathcal{M}_{t}^{\prime}" class="ltx_Math" display="inline" id="A2.SS1.p5.4.m4.1"><semantics id="A2.SS1.p5.4.m4.1a"><msubsup id="A2.SS1.p5.4.m4.1.1" xref="A2.SS1.p5.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p5.4.m4.1.1.2.2" xref="A2.SS1.p5.4.m4.1.1.2.2.cmml">ℳ</mi><mi id="A2.SS1.p5.4.m4.1.1.2.3" xref="A2.SS1.p5.4.m4.1.1.2.3.cmml">t</mi><mo id="A2.SS1.p5.4.m4.1.1.3" xref="A2.SS1.p5.4.m4.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.4.m4.1b"><apply id="A2.SS1.p5.4.m4.1.1.cmml" xref="A2.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.4.m4.1.1.1.cmml" xref="A2.SS1.p5.4.m4.1.1">superscript</csymbol><apply id="A2.SS1.p5.4.m4.1.1.2.cmml" xref="A2.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.4.m4.1.1.2.1.cmml" xref="A2.SS1.p5.4.m4.1.1">subscript</csymbol><ci id="A2.SS1.p5.4.m4.1.1.2.2.cmml" xref="A2.SS1.p5.4.m4.1.1.2.2">ℳ</ci><ci id="A2.SS1.p5.4.m4.1.1.2.3.cmml" xref="A2.SS1.p5.4.m4.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p5.4.m4.1.1.3.cmml" xref="A2.SS1.p5.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.4.m4.1c">\mathcal{M}_{t}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.4.m4.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> by feeding the observation <math alttext="o_{t}^{\prime}" class="ltx_Math" display="inline" id="A2.SS1.p5.5.m5.1"><semantics id="A2.SS1.p5.5.m5.1a"><msubsup id="A2.SS1.p5.5.m5.1.1" xref="A2.SS1.p5.5.m5.1.1.cmml"><mi id="A2.SS1.p5.5.m5.1.1.2.2" xref="A2.SS1.p5.5.m5.1.1.2.2.cmml">o</mi><mi id="A2.SS1.p5.5.m5.1.1.2.3" xref="A2.SS1.p5.5.m5.1.1.2.3.cmml">t</mi><mo id="A2.SS1.p5.5.m5.1.1.3" xref="A2.SS1.p5.5.m5.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.5.m5.1b"><apply id="A2.SS1.p5.5.m5.1.1.cmml" xref="A2.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.5.m5.1.1.1.cmml" xref="A2.SS1.p5.5.m5.1.1">superscript</csymbol><apply id="A2.SS1.p5.5.m5.1.1.2.cmml" xref="A2.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.5.m5.1.1.2.1.cmml" xref="A2.SS1.p5.5.m5.1.1">subscript</csymbol><ci id="A2.SS1.p5.5.m5.1.1.2.2.cmml" xref="A2.SS1.p5.5.m5.1.1.2.2">𝑜</ci><ci id="A2.SS1.p5.5.m5.1.1.2.3.cmml" xref="A2.SS1.p5.5.m5.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p5.5.m5.1.1.3.cmml" xref="A2.SS1.p5.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.5.m5.1c">o_{t}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.5.m5.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and the task instruction <math alttext="I" class="ltx_Math" display="inline" id="A2.SS1.p5.6.m6.1"><semantics id="A2.SS1.p5.6.m6.1a"><mi id="A2.SS1.p5.6.m6.1.1" xref="A2.SS1.p5.6.m6.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.6.m6.1b"><ci id="A2.SS1.p5.6.m6.1.1.cmml" xref="A2.SS1.p5.6.m6.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.6.m6.1c">I</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.6.m6.1d">italic_I</annotation></semantics></math> into the multimodal U-Net. Based on the image and the affordance map, other data such as the rewards and flags are computed. Specifically, <math alttext="\Delta_{t}^{\prime}" class="ltx_Math" display="inline" id="A2.SS1.p5.7.m7.1"><semantics id="A2.SS1.p5.7.m7.1a"><msubsup id="A2.SS1.p5.7.m7.1.1" xref="A2.SS1.p5.7.m7.1.1.cmml"><mi id="A2.SS1.p5.7.m7.1.1.2.2" mathvariant="normal" xref="A2.SS1.p5.7.m7.1.1.2.2.cmml">Δ</mi><mi id="A2.SS1.p5.7.m7.1.1.2.3" xref="A2.SS1.p5.7.m7.1.1.2.3.cmml">t</mi><mo id="A2.SS1.p5.7.m7.1.1.3" xref="A2.SS1.p5.7.m7.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.7.m7.1b"><apply id="A2.SS1.p5.7.m7.1.1.cmml" xref="A2.SS1.p5.7.m7.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.7.m7.1.1.1.cmml" xref="A2.SS1.p5.7.m7.1.1">superscript</csymbol><apply id="A2.SS1.p5.7.m7.1.1.2.cmml" xref="A2.SS1.p5.7.m7.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.7.m7.1.1.2.1.cmml" xref="A2.SS1.p5.7.m7.1.1">subscript</csymbol><ci id="A2.SS1.p5.7.m7.1.1.2.2.cmml" xref="A2.SS1.p5.7.m7.1.1.2.2">Δ</ci><ci id="A2.SS1.p5.7.m7.1.1.2.3.cmml" xref="A2.SS1.p5.7.m7.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p5.7.m7.1.1.3.cmml" xref="A2.SS1.p5.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.7.m7.1c">\Delta_{t}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.7.m7.1d">roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="G_{t}^{\prime}" class="ltx_Math" display="inline" id="A2.SS1.p5.8.m8.1"><semantics id="A2.SS1.p5.8.m8.1a"><msubsup id="A2.SS1.p5.8.m8.1.1" xref="A2.SS1.p5.8.m8.1.1.cmml"><mi id="A2.SS1.p5.8.m8.1.1.2.2" xref="A2.SS1.p5.8.m8.1.1.2.2.cmml">G</mi><mi id="A2.SS1.p5.8.m8.1.1.2.3" xref="A2.SS1.p5.8.m8.1.1.2.3.cmml">t</mi><mo id="A2.SS1.p5.8.m8.1.1.3" xref="A2.SS1.p5.8.m8.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.8.m8.1b"><apply id="A2.SS1.p5.8.m8.1.1.cmml" xref="A2.SS1.p5.8.m8.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.8.m8.1.1.1.cmml" xref="A2.SS1.p5.8.m8.1.1">superscript</csymbol><apply id="A2.SS1.p5.8.m8.1.1.2.cmml" xref="A2.SS1.p5.8.m8.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.8.m8.1.1.2.1.cmml" xref="A2.SS1.p5.8.m8.1.1">subscript</csymbol><ci id="A2.SS1.p5.8.m8.1.1.2.2.cmml" xref="A2.SS1.p5.8.m8.1.1.2.2">𝐺</ci><ci id="A2.SS1.p5.8.m8.1.1.2.3.cmml" xref="A2.SS1.p5.8.m8.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p5.8.m8.1.1.3.cmml" xref="A2.SS1.p5.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.8.m8.1c">G_{t}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.8.m8.1d">italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> are used to record the number of steps between transitions and the cumulative discounted reward obtained during the long-term transition. They are estimated as follows: starting from time <math alttext="t" class="ltx_Math" display="inline" id="A2.SS1.p5.9.m9.1"><semantics id="A2.SS1.p5.9.m9.1a"><mi id="A2.SS1.p5.9.m9.1.1" xref="A2.SS1.p5.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.9.m9.1b"><ci id="A2.SS1.p5.9.m9.1.1.cmml" xref="A2.SS1.p5.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.9.m9.1c">t</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.9.m9.1d">italic_t</annotation></semantics></math>, when the agent interacts with the environment and reaches a state where the level of exploration matches that of the post-jumpy-transition state (measured by the reward of the state), the number of steps since time <math alttext="t" class="ltx_Math" display="inline" id="A2.SS1.p5.10.m10.1"><semantics id="A2.SS1.p5.10.m10.1a"><mi id="A2.SS1.p5.10.m10.1.1" xref="A2.SS1.p5.10.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.10.m10.1b"><ci id="A2.SS1.p5.10.m10.1.1.cmml" xref="A2.SS1.p5.10.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.10.m10.1c">t</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.10.m10.1d">italic_t</annotation></semantics></math> is recorded as <math alttext="\Delta_{t}^{\prime}" class="ltx_Math" display="inline" id="A2.SS1.p5.11.m11.1"><semantics id="A2.SS1.p5.11.m11.1a"><msubsup id="A2.SS1.p5.11.m11.1.1" xref="A2.SS1.p5.11.m11.1.1.cmml"><mi id="A2.SS1.p5.11.m11.1.1.2.2" mathvariant="normal" xref="A2.SS1.p5.11.m11.1.1.2.2.cmml">Δ</mi><mi id="A2.SS1.p5.11.m11.1.1.2.3" xref="A2.SS1.p5.11.m11.1.1.2.3.cmml">t</mi><mo id="A2.SS1.p5.11.m11.1.1.3" xref="A2.SS1.p5.11.m11.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.11.m11.1b"><apply id="A2.SS1.p5.11.m11.1.1.cmml" xref="A2.SS1.p5.11.m11.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.11.m11.1.1.1.cmml" xref="A2.SS1.p5.11.m11.1.1">superscript</csymbol><apply id="A2.SS1.p5.11.m11.1.1.2.cmml" xref="A2.SS1.p5.11.m11.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.11.m11.1.1.2.1.cmml" xref="A2.SS1.p5.11.m11.1.1">subscript</csymbol><ci id="A2.SS1.p5.11.m11.1.1.2.2.cmml" xref="A2.SS1.p5.11.m11.1.1.2.2">Δ</ci><ci id="A2.SS1.p5.11.m11.1.1.2.3.cmml" xref="A2.SS1.p5.11.m11.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p5.11.m11.1.1.3.cmml" xref="A2.SS1.p5.11.m11.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.11.m11.1c">\Delta_{t}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.11.m11.1d">roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, and the cumulative reward during this period is recorded as <math alttext="G_{t}^{\prime}" class="ltx_Math" display="inline" id="A2.SS1.p5.12.m12.1"><semantics id="A2.SS1.p5.12.m12.1a"><msubsup id="A2.SS1.p5.12.m12.1.1" xref="A2.SS1.p5.12.m12.1.1.cmml"><mi id="A2.SS1.p5.12.m12.1.1.2.2" xref="A2.SS1.p5.12.m12.1.1.2.2.cmml">G</mi><mi id="A2.SS1.p5.12.m12.1.1.2.3" xref="A2.SS1.p5.12.m12.1.1.2.3.cmml">t</mi><mo id="A2.SS1.p5.12.m12.1.1.3" xref="A2.SS1.p5.12.m12.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.12.m12.1b"><apply id="A2.SS1.p5.12.m12.1.1.cmml" xref="A2.SS1.p5.12.m12.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.12.m12.1.1.1.cmml" xref="A2.SS1.p5.12.m12.1.1">superscript</csymbol><apply id="A2.SS1.p5.12.m12.1.1.2.cmml" xref="A2.SS1.p5.12.m12.1.1"><csymbol cd="ambiguous" id="A2.SS1.p5.12.m12.1.1.2.1.cmml" xref="A2.SS1.p5.12.m12.1.1">subscript</csymbol><ci id="A2.SS1.p5.12.m12.1.1.2.2.cmml" xref="A2.SS1.p5.12.m12.1.1.2.2">𝐺</ci><ci id="A2.SS1.p5.12.m12.1.1.2.3.cmml" xref="A2.SS1.p5.12.m12.1.1.2.3">𝑡</ci></apply><ci id="A2.SS1.p5.12.m12.1.1.3.cmml" xref="A2.SS1.p5.12.m12.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.12.m12.1c">G_{t}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.12.m12.1d">italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="A2.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="465" id="A2.F8.g1" src="x10.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>
Environment interaction and data collection.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Framework of Multimodal U-Net</h3>
<div class="ltx_para ltx_noindent" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.3">As described in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.SS2.SSS2" title="3.2.2 Multimodal U-Net for Rapid Affordance Map Generation ‣ 3.2 Affordance Map and Intrinsic Reward ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">3.2.2</span></a>, we train a multimodal U-Net to rapidly generate affordance maps based on observation images and task instructions. Our enhanced multimodal U-Net architecture, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A2.F9" title="Figure 9 ‣ B.2 Framework of Multimodal U-Net ‣ Appendix B Model Details ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">9</span></a>, is based on Swin-Unet <cite class="ltx_cite ltx_citemacro_citep">(Cao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib3" title="">2022</a>)</cite>, a U-shaped encoder-decoder architecture built on Swin Transformer blocks. The enhanced multimodal U-Net consists of an encoder, a decoder, a bridge layer, and a text processing module. In the Swin-Unet-inspired structure, the basic unit is the Swin Transformer block. For the encoder, the input image is divided into non-overlapping patches of size <math alttext="4\times 4" class="ltx_Math" display="inline" id="A2.SS2.p1.1.m1.1"><semantics id="A2.SS2.p1.1.m1.1a"><mrow id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml"><mn id="A2.SS2.p1.1.m1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.2.cmml">4</mn><mo id="A2.SS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="A2.SS2.p1.1.m1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><apply id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1"><times id="A2.SS2.p1.1.m1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1"></times><cn id="A2.SS2.p1.1.m1.1.1.2.cmml" type="integer" xref="A2.SS2.p1.1.m1.1.1.2">4</cn><cn id="A2.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="A2.SS2.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">4\times 4</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.1.m1.1d">4 × 4</annotation></semantics></math> to convert the input into a sequence of patch embeddings.
Through this method, each patch has a feature dimension of <math alttext="4\times 4\times 3=48" class="ltx_Math" display="inline" id="A2.SS2.p1.2.m2.1"><semantics id="A2.SS2.p1.2.m2.1a"><mrow id="A2.SS2.p1.2.m2.1.1" xref="A2.SS2.p1.2.m2.1.1.cmml"><mrow id="A2.SS2.p1.2.m2.1.1.2" xref="A2.SS2.p1.2.m2.1.1.2.cmml"><mn id="A2.SS2.p1.2.m2.1.1.2.2" xref="A2.SS2.p1.2.m2.1.1.2.2.cmml">4</mn><mo id="A2.SS2.p1.2.m2.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A2.SS2.p1.2.m2.1.1.2.1.cmml">×</mo><mn id="A2.SS2.p1.2.m2.1.1.2.3" xref="A2.SS2.p1.2.m2.1.1.2.3.cmml">4</mn><mo id="A2.SS2.p1.2.m2.1.1.2.1a" lspace="0.222em" rspace="0.222em" xref="A2.SS2.p1.2.m2.1.1.2.1.cmml">×</mo><mn id="A2.SS2.p1.2.m2.1.1.2.4" xref="A2.SS2.p1.2.m2.1.1.2.4.cmml">3</mn></mrow><mo id="A2.SS2.p1.2.m2.1.1.1" xref="A2.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="A2.SS2.p1.2.m2.1.1.3" xref="A2.SS2.p1.2.m2.1.1.3.cmml">48</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.2.m2.1b"><apply id="A2.SS2.p1.2.m2.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1"><eq id="A2.SS2.p1.2.m2.1.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1.1"></eq><apply id="A2.SS2.p1.2.m2.1.1.2.cmml" xref="A2.SS2.p1.2.m2.1.1.2"><times id="A2.SS2.p1.2.m2.1.1.2.1.cmml" xref="A2.SS2.p1.2.m2.1.1.2.1"></times><cn id="A2.SS2.p1.2.m2.1.1.2.2.cmml" type="integer" xref="A2.SS2.p1.2.m2.1.1.2.2">4</cn><cn id="A2.SS2.p1.2.m2.1.1.2.3.cmml" type="integer" xref="A2.SS2.p1.2.m2.1.1.2.3">4</cn><cn id="A2.SS2.p1.2.m2.1.1.2.4.cmml" type="integer" xref="A2.SS2.p1.2.m2.1.1.2.4">3</cn></apply><cn id="A2.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="A2.SS2.p1.2.m2.1.1.3">48</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.2.m2.1c">4\times 4\times 3=48</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.2.m2.1d">4 × 4 × 3 = 48</annotation></semantics></math>.
The patch embeddings are then projected through a linear embedding layer (denoted as <math alttext="C" class="ltx_Math" display="inline" id="A2.SS2.p1.3.m3.1"><semantics id="A2.SS2.p1.3.m3.1a"><mi id="A2.SS2.p1.3.m3.1.1" xref="A2.SS2.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.3.m3.1b"><ci id="A2.SS2.p1.3.m3.1.1.cmml" xref="A2.SS2.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.3.m3.1d">italic_C</annotation></semantics></math>), and the transformed patch tokens are passed through several Swin Transformer blocks and patch merging layers to produce hierarchical feature representations. The patch merging layers are responsible for downsampling and increasing the dimensionality, while the Swin Transformer blocks handle feature representation learning.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.1">For the task instruction, the text description is processed through the text encoder of MineCLIP <cite class="ltx_cite ltx_citemacro_citep">(Cao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#bib.bib3" title="">2022</a>)</cite> to obtain text embeddings, which are integrated with the image features extracted at each layer of the encoder via the Text-Image Attention (TIA) module. The TIA module employs a multi-head attention mechanism to fuse image features (as keys and values) with text features (as queries) in a multi-scale attention-based fusion. The resulting fused text-image features are passed through the bridge layer and are subsequently combined with the corresponding features during the upsampling process in the decoder.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p3">
<p class="ltx_p" id="A2.SS2.p3.3">The decoder comprises Swin Transformer blocks and patch expanding layers. The extracted context features are combined through the bridge layer with the multi-scale text-image features from the encoder to compensate for the spatial information lost during downsampling and to integrate the text information. Unlike the patch merging layers, the patch expanding layers are specifically designed for upsampling. They reshape the adjacent feature maps by performing a <math alttext="2\times" class="ltx_math_unparsed" display="inline" id="A2.SS2.p3.1.m1.1"><semantics id="A2.SS2.p3.1.m1.1a"><mrow id="A2.SS2.p3.1.m1.1b"><mn id="A2.SS2.p3.1.m1.1.1">2</mn><mo id="A2.SS2.p3.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A2.SS2.p3.1.m1.1c">2\times</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p3.1.m1.1d">2 ×</annotation></semantics></math> upsampling of the resolution, expanding the feature maps into larger ones. Finally, a final patch expanding layer performs a <math alttext="4\times" class="ltx_math_unparsed" display="inline" id="A2.SS2.p3.2.m2.1"><semantics id="A2.SS2.p3.2.m2.1a"><mrow id="A2.SS2.p3.2.m2.1b"><mn id="A2.SS2.p3.2.m2.1.1">4</mn><mo id="A2.SS2.p3.2.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A2.SS2.p3.2.m2.1c">4\times</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p3.2.m2.1d">4 ×</annotation></semantics></math> upsampling to restore the resolution of the feature map to the input resolution <math alttext="W\times H" class="ltx_Math" display="inline" id="A2.SS2.p3.3.m3.1"><semantics id="A2.SS2.p3.3.m3.1a"><mrow id="A2.SS2.p3.3.m3.1.1" xref="A2.SS2.p3.3.m3.1.1.cmml"><mi id="A2.SS2.p3.3.m3.1.1.2" xref="A2.SS2.p3.3.m3.1.1.2.cmml">W</mi><mo id="A2.SS2.p3.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS2.p3.3.m3.1.1.1.cmml">×</mo><mi id="A2.SS2.p3.3.m3.1.1.3" xref="A2.SS2.p3.3.m3.1.1.3.cmml">H</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.3.m3.1b"><apply id="A2.SS2.p3.3.m3.1.1.cmml" xref="A2.SS2.p3.3.m3.1.1"><times id="A2.SS2.p3.3.m3.1.1.1.cmml" xref="A2.SS2.p3.3.m3.1.1.1"></times><ci id="A2.SS2.p3.3.m3.1.1.2.cmml" xref="A2.SS2.p3.3.m3.1.1.2">𝑊</ci><ci id="A2.SS2.p3.3.m3.1.1.3.cmml" xref="A2.SS2.p3.3.m3.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.3.m3.1c">W\times H</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p3.3.m3.1d">italic_W × italic_H</annotation></semantics></math> ), followed by a linear projection layer applied on the upsampled features to produce pixel-level affordance maps.</p>
</div>
<figure class="ltx_figure" id="A2.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="599" id="A2.F9.g1" src="x11.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>The architecture of multimodal U-Net.</figcaption>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Visualizations</h2>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A3.F10" title="Figure 10 ‣ Appendix C Additional Visualizations ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">10</span></a>, we visualize the complete long short-term imagination sequences for the agent across various tasks. This visualization further demonstrates how the affordance map accurately identifies regions of high exploration potential in the image, and how the long short-term imagination approach provides reasonable and applicable guidance for the agent’s task execution. These qualitative results reinforce the effectiveness of our method in guiding the agent toward its goal with greater precision and efficiency.</p>
</div>
<figure class="ltx_figure" id="A3.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="234" id="A3.F10.g1" src="x12.png" width="761"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="185" id="A3.F10.g2" src="x13.png" width="761"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="185" id="A3.F10.g3" src="x14.png" width="761"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="185" id="A3.F10.g4" src="x15.png" width="761"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="185" id="A3.F10.g5" src="x16.png" width="761"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>The visualization of the complete long short-term imagination sequences.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Algorithm</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">The algorithm of LS-Imagine is illustrated in Alg. <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#alg1" title="Algorithm 1 ‣ Appendix D Algorithm ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> LS-Imagine.</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg1.l1.1">Initialize</span> parameters <math alttext="\phi,\theta,\psi" class="ltx_Math" display="inline" id="alg1.l1.m1.3"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.4.2" xref="alg1.l1.m1.3.4.1.cmml"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">ϕ</mi><mo id="alg1.l1.m1.3.4.2.1" xref="alg1.l1.m1.3.4.1.cmml">,</mo><mi id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">θ</mi><mo id="alg1.l1.m1.3.4.2.2" xref="alg1.l1.m1.3.4.1.cmml">,</mo><mi id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">ψ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><list id="alg1.l1.m1.3.4.1.cmml" xref="alg1.l1.m1.3.4.2"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">italic-ϕ</ci><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">𝜃</ci><ci id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">𝜓</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">\phi,\theta,\psi</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.3d">italic_ϕ , italic_θ , italic_ψ</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>Compute affordance map with MineCLIP. <span class="ltx_text" id="alg1.l2.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l2.1.m1.1"><semantics id="alg1.l2.1.m1.1a"><mo id="alg1.l2.1.m1.1.1" xref="alg1.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l2.1.m1.1b"><ci id="alg1.l2.1.m1.1.1.cmml" xref="alg1.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.1.m1.1d">▷</annotation></semantics></math> Affordance map generation
</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>Train multimodal U-Net with annotated data.
<span class="ltx_text" id="alg1.l3.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l3.1.m1.1"><semantics id="alg1.l3.1.m1.1a"><mo id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.1.m1.1d">▷</annotation></semantics></math> To enable real-time interaction with the affordance maps
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>Train the random agent and collect a replay buffer <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">caligraphic_B</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span><span class="ltx_text ltx_font_bold" id="alg1.l5.1">while</span> not converged <span class="ltx_text ltx_font_bold" id="alg1.l5.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     Sample long short-term transitions from <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">caligraphic_B</annotation></semantics></math>.<span class="ltx_text" id="alg1.l6.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> Representation learning
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     Update the world model <math alttext="\phi" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_ϕ</annotation></semantics></math> using Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.E7" title="In 3.3.2 Learning Jumpy State Transitions ‣ 3.3 Long Short-Term World Model ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">7</span></a>).

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     Generate <math alttext="(h_{t},{z}_{t},a_{t},j_{t})" class="ltx_Math" display="inline" id="alg1.l8.m1.4"><semantics id="alg1.l8.m1.4a"><mrow id="alg1.l8.m1.4.4.4" xref="alg1.l8.m1.4.4.5.cmml"><mo id="alg1.l8.m1.4.4.4.5" stretchy="false" xref="alg1.l8.m1.4.4.5.cmml">(</mo><msub id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.2.cmml">h</mi><mi id="alg1.l8.m1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l8.m1.4.4.4.6" xref="alg1.l8.m1.4.4.5.cmml">,</mo><msub id="alg1.l8.m1.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.cmml">z</mi><mi id="alg1.l8.m1.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l8.m1.4.4.4.7" xref="alg1.l8.m1.4.4.5.cmml">,</mo><msub id="alg1.l8.m1.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.cmml"><mi id="alg1.l8.m1.3.3.3.3.2" xref="alg1.l8.m1.3.3.3.3.2.cmml">a</mi><mi id="alg1.l8.m1.3.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.3.cmml">t</mi></msub><mo id="alg1.l8.m1.4.4.4.8" xref="alg1.l8.m1.4.4.5.cmml">,</mo><msub id="alg1.l8.m1.4.4.4.4" xref="alg1.l8.m1.4.4.4.4.cmml"><mi id="alg1.l8.m1.4.4.4.4.2" xref="alg1.l8.m1.4.4.4.4.2.cmml">j</mi><mi id="alg1.l8.m1.4.4.4.4.3" xref="alg1.l8.m1.4.4.4.4.3.cmml">t</mi></msub><mo id="alg1.l8.m1.4.4.4.9" stretchy="false" xref="alg1.l8.m1.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.4b"><vector id="alg1.l8.m1.4.4.5.cmml" xref="alg1.l8.m1.4.4.4"><apply id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.2">ℎ</ci><ci id="alg1.l8.m1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l8.m1.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2">𝑧</ci><ci id="alg1.l8.m1.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l8.m1.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.3.3.1.cmml" xref="alg1.l8.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l8.m1.3.3.3.3.2.cmml" xref="alg1.l8.m1.3.3.3.3.2">𝑎</ci><ci id="alg1.l8.m1.3.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3.3">𝑡</ci></apply><apply id="alg1.l8.m1.4.4.4.4.cmml" xref="alg1.l8.m1.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.4.4.1.cmml" xref="alg1.l8.m1.4.4.4.4">subscript</csymbol><ci id="alg1.l8.m1.4.4.4.4.2.cmml" xref="alg1.l8.m1.4.4.4.4.2">𝑗</ci><ci id="alg1.l8.m1.4.4.4.4.3.cmml" xref="alg1.l8.m1.4.4.4.4.3">𝑡</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.4c">(h_{t},{z}_{t},a_{t},j_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.4d">( italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> using <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><msub id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">π</mi><mi id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1">subscript</csymbol><ci id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2">𝜋</ci><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{W}_{\phi}" class="ltx_Math" display="inline" id="alg1.l8.m3.1"><semantics id="alg1.l8.m3.1a"><msub id="alg1.l8.m3.1.1" xref="alg1.l8.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m3.1.1.2" xref="alg1.l8.m3.1.1.2.cmml">𝒲</mi><mi id="alg1.l8.m3.1.1.3" xref="alg1.l8.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m3.1b"><apply id="alg1.l8.m3.1.1.cmml" xref="alg1.l8.m3.1.1"><csymbol cd="ambiguous" id="alg1.l8.m3.1.1.1.cmml" xref="alg1.l8.m3.1.1">subscript</csymbol><ci id="alg1.l8.m3.1.1.2.cmml" xref="alg1.l8.m3.1.1.2">𝒲</ci><ci id="alg1.l8.m3.1.1.3.cmml" xref="alg1.l8.m3.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m3.1c">\mathcal{W}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m3.1d">caligraphic_W start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>.<span class="ltx_text" id="alg1.l8.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l8.1.m1.1"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.1.m1.1d">▷</annotation></semantics></math> Behavior learning
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l9.1">for</span> time step <math alttext="i=t\cdots t+L" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">i</mi><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">=</mo><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mrow id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml"><mi id="alg1.l9.m1.1.1.3.2.2" xref="alg1.l9.m1.1.1.3.2.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.3.2.1" xref="alg1.l9.m1.1.1.3.2.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3.2.3" mathvariant="normal" xref="alg1.l9.m1.1.1.3.2.3.cmml">⋯</mi><mo id="alg1.l9.m1.1.1.3.2.1a" xref="alg1.l9.m1.1.1.3.2.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3.2.4" xref="alg1.l9.m1.1.1.3.2.4.cmml">t</mi></mrow><mo id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml">+</mo><mi id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></eq><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑖</ci><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><plus id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1"></plus><apply id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2"><times id="alg1.l9.m1.1.1.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2.1"></times><ci id="alg1.l9.m1.1.1.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2">𝑡</ci><ci id="alg1.l9.m1.1.1.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3">⋯</ci><ci id="alg1.l9.m1.1.1.3.2.4.cmml" xref="alg1.l9.m1.1.1.3.2.4">𝑡</ci></apply><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">i=t\cdots t+L</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_i = italic_t ⋯ italic_t + italic_L</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l9.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>         <span class="ltx_text ltx_font_bold" id="alg1.l10.1">if</span> jump flag <math alttext="j_{i}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">j</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑗</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">j_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_j start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l10.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>              Generate <math alttext="(h^{\prime},z^{\prime},a^{\prime},c^{\prime},j^{\prime},\Delta^{\prime},G^{%
\prime})" class="ltx_Math" display="inline" id="alg1.l11.m1.7"><semantics id="alg1.l11.m1.7a"><mrow id="alg1.l11.m1.7.7.7" xref="alg1.l11.m1.7.7.8.cmml"><mo id="alg1.l11.m1.7.7.7.8" stretchy="false" xref="alg1.l11.m1.7.7.8.cmml">(</mo><msup id="alg1.l11.m1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.2.cmml">h</mi><mo id="alg1.l11.m1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l11.m1.7.7.7.9" xref="alg1.l11.m1.7.7.8.cmml">,</mo><msup id="alg1.l11.m1.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.cmml"><mi id="alg1.l11.m1.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.cmml">z</mi><mo id="alg1.l11.m1.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.3.cmml">′</mo></msup><mo id="alg1.l11.m1.7.7.7.10" xref="alg1.l11.m1.7.7.8.cmml">,</mo><msup id="alg1.l11.m1.3.3.3.3" xref="alg1.l11.m1.3.3.3.3.cmml"><mi id="alg1.l11.m1.3.3.3.3.2" xref="alg1.l11.m1.3.3.3.3.2.cmml">a</mi><mo id="alg1.l11.m1.3.3.3.3.3" xref="alg1.l11.m1.3.3.3.3.3.cmml">′</mo></msup><mo id="alg1.l11.m1.7.7.7.11" xref="alg1.l11.m1.7.7.8.cmml">,</mo><msup id="alg1.l11.m1.4.4.4.4" xref="alg1.l11.m1.4.4.4.4.cmml"><mi id="alg1.l11.m1.4.4.4.4.2" xref="alg1.l11.m1.4.4.4.4.2.cmml">c</mi><mo id="alg1.l11.m1.4.4.4.4.3" xref="alg1.l11.m1.4.4.4.4.3.cmml">′</mo></msup><mo id="alg1.l11.m1.7.7.7.12" xref="alg1.l11.m1.7.7.8.cmml">,</mo><msup id="alg1.l11.m1.5.5.5.5" xref="alg1.l11.m1.5.5.5.5.cmml"><mi id="alg1.l11.m1.5.5.5.5.2" xref="alg1.l11.m1.5.5.5.5.2.cmml">j</mi><mo id="alg1.l11.m1.5.5.5.5.3" xref="alg1.l11.m1.5.5.5.5.3.cmml">′</mo></msup><mo id="alg1.l11.m1.7.7.7.13" xref="alg1.l11.m1.7.7.8.cmml">,</mo><msup id="alg1.l11.m1.6.6.6.6" xref="alg1.l11.m1.6.6.6.6.cmml"><mi id="alg1.l11.m1.6.6.6.6.2" mathvariant="normal" xref="alg1.l11.m1.6.6.6.6.2.cmml">Δ</mi><mo id="alg1.l11.m1.6.6.6.6.3" xref="alg1.l11.m1.6.6.6.6.3.cmml">′</mo></msup><mo id="alg1.l11.m1.7.7.7.14" xref="alg1.l11.m1.7.7.8.cmml">,</mo><msup id="alg1.l11.m1.7.7.7.7" xref="alg1.l11.m1.7.7.7.7.cmml"><mi id="alg1.l11.m1.7.7.7.7.2" xref="alg1.l11.m1.7.7.7.7.2.cmml">G</mi><mo id="alg1.l11.m1.7.7.7.7.3" xref="alg1.l11.m1.7.7.7.7.3.cmml">′</mo></msup><mo id="alg1.l11.m1.7.7.7.15" stretchy="false" xref="alg1.l11.m1.7.7.8.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.7b"><vector id="alg1.l11.m1.7.7.8.cmml" xref="alg1.l11.m1.7.7.7"><apply id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.2">ℎ</ci><ci id="alg1.l11.m1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.3">′</ci></apply><apply id="alg1.l11.m1.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.1.cmml" xref="alg1.l11.m1.2.2.2.2">superscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2">𝑧</ci><ci id="alg1.l11.m1.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.3">′</ci></apply><apply id="alg1.l11.m1.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.3.3.1.cmml" xref="alg1.l11.m1.3.3.3.3">superscript</csymbol><ci id="alg1.l11.m1.3.3.3.3.2.cmml" xref="alg1.l11.m1.3.3.3.3.2">𝑎</ci><ci id="alg1.l11.m1.3.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3.3">′</ci></apply><apply id="alg1.l11.m1.4.4.4.4.cmml" xref="alg1.l11.m1.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l11.m1.4.4.4.4.1.cmml" xref="alg1.l11.m1.4.4.4.4">superscript</csymbol><ci id="alg1.l11.m1.4.4.4.4.2.cmml" xref="alg1.l11.m1.4.4.4.4.2">𝑐</ci><ci id="alg1.l11.m1.4.4.4.4.3.cmml" xref="alg1.l11.m1.4.4.4.4.3">′</ci></apply><apply id="alg1.l11.m1.5.5.5.5.cmml" xref="alg1.l11.m1.5.5.5.5"><csymbol cd="ambiguous" id="alg1.l11.m1.5.5.5.5.1.cmml" xref="alg1.l11.m1.5.5.5.5">superscript</csymbol><ci id="alg1.l11.m1.5.5.5.5.2.cmml" xref="alg1.l11.m1.5.5.5.5.2">𝑗</ci><ci id="alg1.l11.m1.5.5.5.5.3.cmml" xref="alg1.l11.m1.5.5.5.5.3">′</ci></apply><apply id="alg1.l11.m1.6.6.6.6.cmml" xref="alg1.l11.m1.6.6.6.6"><csymbol cd="ambiguous" id="alg1.l11.m1.6.6.6.6.1.cmml" xref="alg1.l11.m1.6.6.6.6">superscript</csymbol><ci id="alg1.l11.m1.6.6.6.6.2.cmml" xref="alg1.l11.m1.6.6.6.6.2">Δ</ci><ci id="alg1.l11.m1.6.6.6.6.3.cmml" xref="alg1.l11.m1.6.6.6.6.3">′</ci></apply><apply id="alg1.l11.m1.7.7.7.7.cmml" xref="alg1.l11.m1.7.7.7.7"><csymbol cd="ambiguous" id="alg1.l11.m1.7.7.7.7.1.cmml" xref="alg1.l11.m1.7.7.7.7">superscript</csymbol><ci id="alg1.l11.m1.7.7.7.7.2.cmml" xref="alg1.l11.m1.7.7.7.7.2">𝐺</ci><ci id="alg1.l11.m1.7.7.7.7.3.cmml" xref="alg1.l11.m1.7.7.7.7.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.7c">(h^{\prime},z^{\prime},a^{\prime},c^{\prime},j^{\prime},\Delta^{\prime},G^{%
\prime})</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.7d">( italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_j start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , roman_Δ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> using <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.l11.m2.1"><semantics id="alg1.l11.m2.1a"><msub id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">π</mi><mi id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1">subscript</csymbol><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝜋</ci><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and long-term imagination of <math alttext="\mathcal{W}_{\phi}" class="ltx_Math" display="inline" id="alg1.l11.m3.1"><semantics id="alg1.l11.m3.1a"><msub id="alg1.l11.m3.1.1" xref="alg1.l11.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m3.1.1.2" xref="alg1.l11.m3.1.1.2.cmml">𝒲</mi><mi id="alg1.l11.m3.1.1.3" xref="alg1.l11.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m3.1b"><apply id="alg1.l11.m3.1.1.cmml" xref="alg1.l11.m3.1.1"><csymbol cd="ambiguous" id="alg1.l11.m3.1.1.1.cmml" xref="alg1.l11.m3.1.1">subscript</csymbol><ci id="alg1.l11.m3.1.1.2.cmml" xref="alg1.l11.m3.1.1.2">𝒲</ci><ci id="alg1.l11.m3.1.1.3.cmml" xref="alg1.l11.m3.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m3.1c">\mathcal{W}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m3.1d">caligraphic_W start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>              Update <math alttext="(h_{i+1},\hat{z}_{i+1},a_{i+1},\hat{c}_{i+1},\hat{j}_{i+1},\hat{\Delta}_{i+1},%
\hat{G}_{i+1})\leftarrow(h^{\prime},z^{\prime},a^{\prime},c^{\prime},j^{\prime%
},\Delta^{\prime},G^{\prime})" class="ltx_Math" display="inline" id="alg1.l12.m1.14"><semantics id="alg1.l12.m1.14a"><mrow id="alg1.l12.m1.14.14" xref="alg1.l12.m1.14.14.cmml"><mrow id="alg1.l12.m1.7.7.7.7" xref="alg1.l12.m1.7.7.7.8.cmml"><mo id="alg1.l12.m1.7.7.7.7.8" stretchy="false" xref="alg1.l12.m1.7.7.7.8.cmml">(</mo><msub id="alg1.l12.m1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.2" xref="alg1.l12.m1.1.1.1.1.1.2.cmml">h</mi><mrow id="alg1.l12.m1.1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.3.2" xref="alg1.l12.m1.1.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l12.m1.1.1.1.1.1.3.1" xref="alg1.l12.m1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l12.m1.1.1.1.1.1.3.3" xref="alg1.l12.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l12.m1.7.7.7.7.9" xref="alg1.l12.m1.7.7.7.8.cmml">,</mo><msub id="alg1.l12.m1.2.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.2.cmml"><mover accent="true" id="alg1.l12.m1.2.2.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l12.m1.2.2.2.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.2.2.2.cmml">z</mi><mo id="alg1.l12.m1.2.2.2.2.2.2.1" xref="alg1.l12.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l12.m1.2.2.2.2.2.3" xref="alg1.l12.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l12.m1.2.2.2.2.2.3.2" xref="alg1.l12.m1.2.2.2.2.2.3.2.cmml">i</mi><mo id="alg1.l12.m1.2.2.2.2.2.3.1" xref="alg1.l12.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l12.m1.2.2.2.2.2.3.3" xref="alg1.l12.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l12.m1.7.7.7.7.10" xref="alg1.l12.m1.7.7.7.8.cmml">,</mo><msub id="alg1.l12.m1.3.3.3.3.3" xref="alg1.l12.m1.3.3.3.3.3.cmml"><mi id="alg1.l12.m1.3.3.3.3.3.2" xref="alg1.l12.m1.3.3.3.3.3.2.cmml">a</mi><mrow id="alg1.l12.m1.3.3.3.3.3.3" xref="alg1.l12.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l12.m1.3.3.3.3.3.3.2" xref="alg1.l12.m1.3.3.3.3.3.3.2.cmml">i</mi><mo id="alg1.l12.m1.3.3.3.3.3.3.1" xref="alg1.l12.m1.3.3.3.3.3.3.1.cmml">+</mo><mn id="alg1.l12.m1.3.3.3.3.3.3.3" xref="alg1.l12.m1.3.3.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l12.m1.7.7.7.7.11" xref="alg1.l12.m1.7.7.7.8.cmml">,</mo><msub id="alg1.l12.m1.4.4.4.4.4" xref="alg1.l12.m1.4.4.4.4.4.cmml"><mover accent="true" id="alg1.l12.m1.4.4.4.4.4.2" xref="alg1.l12.m1.4.4.4.4.4.2.cmml"><mi id="alg1.l12.m1.4.4.4.4.4.2.2" xref="alg1.l12.m1.4.4.4.4.4.2.2.cmml">c</mi><mo id="alg1.l12.m1.4.4.4.4.4.2.1" xref="alg1.l12.m1.4.4.4.4.4.2.1.cmml">^</mo></mover><mrow id="alg1.l12.m1.4.4.4.4.4.3" xref="alg1.l12.m1.4.4.4.4.4.3.cmml"><mi id="alg1.l12.m1.4.4.4.4.4.3.2" xref="alg1.l12.m1.4.4.4.4.4.3.2.cmml">i</mi><mo id="alg1.l12.m1.4.4.4.4.4.3.1" xref="alg1.l12.m1.4.4.4.4.4.3.1.cmml">+</mo><mn id="alg1.l12.m1.4.4.4.4.4.3.3" xref="alg1.l12.m1.4.4.4.4.4.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l12.m1.7.7.7.7.12" xref="alg1.l12.m1.7.7.7.8.cmml">,</mo><msub id="alg1.l12.m1.5.5.5.5.5" xref="alg1.l12.m1.5.5.5.5.5.cmml"><mover accent="true" id="alg1.l12.m1.5.5.5.5.5.2" xref="alg1.l12.m1.5.5.5.5.5.2.cmml"><mi id="alg1.l12.m1.5.5.5.5.5.2.2" xref="alg1.l12.m1.5.5.5.5.5.2.2.cmml">j</mi><mo id="alg1.l12.m1.5.5.5.5.5.2.1" xref="alg1.l12.m1.5.5.5.5.5.2.1.cmml">^</mo></mover><mrow id="alg1.l12.m1.5.5.5.5.5.3" xref="alg1.l12.m1.5.5.5.5.5.3.cmml"><mi id="alg1.l12.m1.5.5.5.5.5.3.2" xref="alg1.l12.m1.5.5.5.5.5.3.2.cmml">i</mi><mo id="alg1.l12.m1.5.5.5.5.5.3.1" xref="alg1.l12.m1.5.5.5.5.5.3.1.cmml">+</mo><mn id="alg1.l12.m1.5.5.5.5.5.3.3" xref="alg1.l12.m1.5.5.5.5.5.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l12.m1.7.7.7.7.13" xref="alg1.l12.m1.7.7.7.8.cmml">,</mo><msub id="alg1.l12.m1.6.6.6.6.6" xref="alg1.l12.m1.6.6.6.6.6.cmml"><mover accent="true" id="alg1.l12.m1.6.6.6.6.6.2" xref="alg1.l12.m1.6.6.6.6.6.2.cmml"><mi id="alg1.l12.m1.6.6.6.6.6.2.2" mathvariant="normal" xref="alg1.l12.m1.6.6.6.6.6.2.2.cmml">Δ</mi><mo id="alg1.l12.m1.6.6.6.6.6.2.1" xref="alg1.l12.m1.6.6.6.6.6.2.1.cmml">^</mo></mover><mrow id="alg1.l12.m1.6.6.6.6.6.3" xref="alg1.l12.m1.6.6.6.6.6.3.cmml"><mi id="alg1.l12.m1.6.6.6.6.6.3.2" xref="alg1.l12.m1.6.6.6.6.6.3.2.cmml">i</mi><mo id="alg1.l12.m1.6.6.6.6.6.3.1" xref="alg1.l12.m1.6.6.6.6.6.3.1.cmml">+</mo><mn id="alg1.l12.m1.6.6.6.6.6.3.3" xref="alg1.l12.m1.6.6.6.6.6.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l12.m1.7.7.7.7.14" xref="alg1.l12.m1.7.7.7.8.cmml">,</mo><msub id="alg1.l12.m1.7.7.7.7.7" xref="alg1.l12.m1.7.7.7.7.7.cmml"><mover accent="true" id="alg1.l12.m1.7.7.7.7.7.2" xref="alg1.l12.m1.7.7.7.7.7.2.cmml"><mi id="alg1.l12.m1.7.7.7.7.7.2.2" xref="alg1.l12.m1.7.7.7.7.7.2.2.cmml">G</mi><mo id="alg1.l12.m1.7.7.7.7.7.2.1" xref="alg1.l12.m1.7.7.7.7.7.2.1.cmml">^</mo></mover><mrow id="alg1.l12.m1.7.7.7.7.7.3" xref="alg1.l12.m1.7.7.7.7.7.3.cmml"><mi id="alg1.l12.m1.7.7.7.7.7.3.2" xref="alg1.l12.m1.7.7.7.7.7.3.2.cmml">i</mi><mo id="alg1.l12.m1.7.7.7.7.7.3.1" xref="alg1.l12.m1.7.7.7.7.7.3.1.cmml">+</mo><mn id="alg1.l12.m1.7.7.7.7.7.3.3" xref="alg1.l12.m1.7.7.7.7.7.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l12.m1.7.7.7.7.15" stretchy="false" xref="alg1.l12.m1.7.7.7.8.cmml">)</mo></mrow><mo id="alg1.l12.m1.14.14.15" stretchy="false" xref="alg1.l12.m1.14.14.15.cmml">←</mo><mrow id="alg1.l12.m1.14.14.14.7" xref="alg1.l12.m1.14.14.14.8.cmml"><mo id="alg1.l12.m1.14.14.14.7.8" stretchy="false" xref="alg1.l12.m1.14.14.14.8.cmml">(</mo><msup id="alg1.l12.m1.8.8.8.1.1" xref="alg1.l12.m1.8.8.8.1.1.cmml"><mi id="alg1.l12.m1.8.8.8.1.1.2" xref="alg1.l12.m1.8.8.8.1.1.2.cmml">h</mi><mo id="alg1.l12.m1.8.8.8.1.1.3" xref="alg1.l12.m1.8.8.8.1.1.3.cmml">′</mo></msup><mo id="alg1.l12.m1.14.14.14.7.9" xref="alg1.l12.m1.14.14.14.8.cmml">,</mo><msup id="alg1.l12.m1.9.9.9.2.2" xref="alg1.l12.m1.9.9.9.2.2.cmml"><mi id="alg1.l12.m1.9.9.9.2.2.2" xref="alg1.l12.m1.9.9.9.2.2.2.cmml">z</mi><mo id="alg1.l12.m1.9.9.9.2.2.3" xref="alg1.l12.m1.9.9.9.2.2.3.cmml">′</mo></msup><mo id="alg1.l12.m1.14.14.14.7.10" xref="alg1.l12.m1.14.14.14.8.cmml">,</mo><msup id="alg1.l12.m1.10.10.10.3.3" xref="alg1.l12.m1.10.10.10.3.3.cmml"><mi id="alg1.l12.m1.10.10.10.3.3.2" xref="alg1.l12.m1.10.10.10.3.3.2.cmml">a</mi><mo id="alg1.l12.m1.10.10.10.3.3.3" xref="alg1.l12.m1.10.10.10.3.3.3.cmml">′</mo></msup><mo id="alg1.l12.m1.14.14.14.7.11" xref="alg1.l12.m1.14.14.14.8.cmml">,</mo><msup id="alg1.l12.m1.11.11.11.4.4" xref="alg1.l12.m1.11.11.11.4.4.cmml"><mi id="alg1.l12.m1.11.11.11.4.4.2" xref="alg1.l12.m1.11.11.11.4.4.2.cmml">c</mi><mo id="alg1.l12.m1.11.11.11.4.4.3" xref="alg1.l12.m1.11.11.11.4.4.3.cmml">′</mo></msup><mo id="alg1.l12.m1.14.14.14.7.12" xref="alg1.l12.m1.14.14.14.8.cmml">,</mo><msup id="alg1.l12.m1.12.12.12.5.5" xref="alg1.l12.m1.12.12.12.5.5.cmml"><mi id="alg1.l12.m1.12.12.12.5.5.2" xref="alg1.l12.m1.12.12.12.5.5.2.cmml">j</mi><mo id="alg1.l12.m1.12.12.12.5.5.3" xref="alg1.l12.m1.12.12.12.5.5.3.cmml">′</mo></msup><mo id="alg1.l12.m1.14.14.14.7.13" xref="alg1.l12.m1.14.14.14.8.cmml">,</mo><msup id="alg1.l12.m1.13.13.13.6.6" xref="alg1.l12.m1.13.13.13.6.6.cmml"><mi id="alg1.l12.m1.13.13.13.6.6.2" mathvariant="normal" xref="alg1.l12.m1.13.13.13.6.6.2.cmml">Δ</mi><mo id="alg1.l12.m1.13.13.13.6.6.3" xref="alg1.l12.m1.13.13.13.6.6.3.cmml">′</mo></msup><mo id="alg1.l12.m1.14.14.14.7.14" xref="alg1.l12.m1.14.14.14.8.cmml">,</mo><msup id="alg1.l12.m1.14.14.14.7.7" xref="alg1.l12.m1.14.14.14.7.7.cmml"><mi id="alg1.l12.m1.14.14.14.7.7.2" xref="alg1.l12.m1.14.14.14.7.7.2.cmml">G</mi><mo id="alg1.l12.m1.14.14.14.7.7.3" xref="alg1.l12.m1.14.14.14.7.7.3.cmml">′</mo></msup><mo id="alg1.l12.m1.14.14.14.7.15" stretchy="false" xref="alg1.l12.m1.14.14.14.8.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.14b"><apply id="alg1.l12.m1.14.14.cmml" xref="alg1.l12.m1.14.14"><ci id="alg1.l12.m1.14.14.15.cmml" xref="alg1.l12.m1.14.14.15">←</ci><vector id="alg1.l12.m1.7.7.7.8.cmml" xref="alg1.l12.m1.7.7.7.7"><apply id="alg1.l12.m1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.2">ℎ</ci><apply id="alg1.l12.m1.1.1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.3"><plus id="alg1.l12.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.3.1"></plus><ci id="alg1.l12.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.3.2">𝑖</ci><cn id="alg1.l12.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l12.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.2.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.2.2.2.1.cmml" xref="alg1.l12.m1.2.2.2.2.2">subscript</csymbol><apply id="alg1.l12.m1.2.2.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2.2.2"><ci id="alg1.l12.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l12.m1.2.2.2.2.2.2.1">^</ci><ci id="alg1.l12.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2.2.2.2">𝑧</ci></apply><apply id="alg1.l12.m1.2.2.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.2.2.3"><plus id="alg1.l12.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l12.m1.2.2.2.2.2.3.1"></plus><ci id="alg1.l12.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l12.m1.2.2.2.2.2.3.2">𝑖</ci><cn id="alg1.l12.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="alg1.l12.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.3.3.3.3.3.cmml" xref="alg1.l12.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.3.3.3.1.cmml" xref="alg1.l12.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l12.m1.3.3.3.3.3.2.cmml" xref="alg1.l12.m1.3.3.3.3.3.2">𝑎</ci><apply id="alg1.l12.m1.3.3.3.3.3.3.cmml" xref="alg1.l12.m1.3.3.3.3.3.3"><plus id="alg1.l12.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l12.m1.3.3.3.3.3.3.1"></plus><ci id="alg1.l12.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l12.m1.3.3.3.3.3.3.2">𝑖</ci><cn id="alg1.l12.m1.3.3.3.3.3.3.3.cmml" type="integer" xref="alg1.l12.m1.3.3.3.3.3.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.4.4.4.4.4.cmml" xref="alg1.l12.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.4.4.4.1.cmml" xref="alg1.l12.m1.4.4.4.4.4">subscript</csymbol><apply id="alg1.l12.m1.4.4.4.4.4.2.cmml" xref="alg1.l12.m1.4.4.4.4.4.2"><ci id="alg1.l12.m1.4.4.4.4.4.2.1.cmml" xref="alg1.l12.m1.4.4.4.4.4.2.1">^</ci><ci id="alg1.l12.m1.4.4.4.4.4.2.2.cmml" xref="alg1.l12.m1.4.4.4.4.4.2.2">𝑐</ci></apply><apply id="alg1.l12.m1.4.4.4.4.4.3.cmml" xref="alg1.l12.m1.4.4.4.4.4.3"><plus id="alg1.l12.m1.4.4.4.4.4.3.1.cmml" xref="alg1.l12.m1.4.4.4.4.4.3.1"></plus><ci id="alg1.l12.m1.4.4.4.4.4.3.2.cmml" xref="alg1.l12.m1.4.4.4.4.4.3.2">𝑖</ci><cn id="alg1.l12.m1.4.4.4.4.4.3.3.cmml" type="integer" xref="alg1.l12.m1.4.4.4.4.4.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.5.5.5.5.5.cmml" xref="alg1.l12.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.5.5.5.1.cmml" xref="alg1.l12.m1.5.5.5.5.5">subscript</csymbol><apply id="alg1.l12.m1.5.5.5.5.5.2.cmml" xref="alg1.l12.m1.5.5.5.5.5.2"><ci id="alg1.l12.m1.5.5.5.5.5.2.1.cmml" xref="alg1.l12.m1.5.5.5.5.5.2.1">^</ci><ci id="alg1.l12.m1.5.5.5.5.5.2.2.cmml" xref="alg1.l12.m1.5.5.5.5.5.2.2">𝑗</ci></apply><apply id="alg1.l12.m1.5.5.5.5.5.3.cmml" xref="alg1.l12.m1.5.5.5.5.5.3"><plus id="alg1.l12.m1.5.5.5.5.5.3.1.cmml" xref="alg1.l12.m1.5.5.5.5.5.3.1"></plus><ci id="alg1.l12.m1.5.5.5.5.5.3.2.cmml" xref="alg1.l12.m1.5.5.5.5.5.3.2">𝑖</ci><cn id="alg1.l12.m1.5.5.5.5.5.3.3.cmml" type="integer" xref="alg1.l12.m1.5.5.5.5.5.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.6.6.6.6.6.cmml" xref="alg1.l12.m1.6.6.6.6.6"><csymbol cd="ambiguous" id="alg1.l12.m1.6.6.6.6.6.1.cmml" xref="alg1.l12.m1.6.6.6.6.6">subscript</csymbol><apply id="alg1.l12.m1.6.6.6.6.6.2.cmml" xref="alg1.l12.m1.6.6.6.6.6.2"><ci id="alg1.l12.m1.6.6.6.6.6.2.1.cmml" xref="alg1.l12.m1.6.6.6.6.6.2.1">^</ci><ci id="alg1.l12.m1.6.6.6.6.6.2.2.cmml" xref="alg1.l12.m1.6.6.6.6.6.2.2">Δ</ci></apply><apply id="alg1.l12.m1.6.6.6.6.6.3.cmml" xref="alg1.l12.m1.6.6.6.6.6.3"><plus id="alg1.l12.m1.6.6.6.6.6.3.1.cmml" xref="alg1.l12.m1.6.6.6.6.6.3.1"></plus><ci id="alg1.l12.m1.6.6.6.6.6.3.2.cmml" xref="alg1.l12.m1.6.6.6.6.6.3.2">𝑖</ci><cn id="alg1.l12.m1.6.6.6.6.6.3.3.cmml" type="integer" xref="alg1.l12.m1.6.6.6.6.6.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.7.7.7.7.7.cmml" xref="alg1.l12.m1.7.7.7.7.7"><csymbol cd="ambiguous" id="alg1.l12.m1.7.7.7.7.7.1.cmml" xref="alg1.l12.m1.7.7.7.7.7">subscript</csymbol><apply id="alg1.l12.m1.7.7.7.7.7.2.cmml" xref="alg1.l12.m1.7.7.7.7.7.2"><ci id="alg1.l12.m1.7.7.7.7.7.2.1.cmml" xref="alg1.l12.m1.7.7.7.7.7.2.1">^</ci><ci id="alg1.l12.m1.7.7.7.7.7.2.2.cmml" xref="alg1.l12.m1.7.7.7.7.7.2.2">𝐺</ci></apply><apply id="alg1.l12.m1.7.7.7.7.7.3.cmml" xref="alg1.l12.m1.7.7.7.7.7.3"><plus id="alg1.l12.m1.7.7.7.7.7.3.1.cmml" xref="alg1.l12.m1.7.7.7.7.7.3.1"></plus><ci id="alg1.l12.m1.7.7.7.7.7.3.2.cmml" xref="alg1.l12.m1.7.7.7.7.7.3.2">𝑖</ci><cn id="alg1.l12.m1.7.7.7.7.7.3.3.cmml" type="integer" xref="alg1.l12.m1.7.7.7.7.7.3.3">1</cn></apply></apply></vector><vector id="alg1.l12.m1.14.14.14.8.cmml" xref="alg1.l12.m1.14.14.14.7"><apply id="alg1.l12.m1.8.8.8.1.1.cmml" xref="alg1.l12.m1.8.8.8.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.8.8.8.1.1.1.cmml" xref="alg1.l12.m1.8.8.8.1.1">superscript</csymbol><ci id="alg1.l12.m1.8.8.8.1.1.2.cmml" xref="alg1.l12.m1.8.8.8.1.1.2">ℎ</ci><ci id="alg1.l12.m1.8.8.8.1.1.3.cmml" xref="alg1.l12.m1.8.8.8.1.1.3">′</ci></apply><apply id="alg1.l12.m1.9.9.9.2.2.cmml" xref="alg1.l12.m1.9.9.9.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.9.9.9.2.2.1.cmml" xref="alg1.l12.m1.9.9.9.2.2">superscript</csymbol><ci id="alg1.l12.m1.9.9.9.2.2.2.cmml" xref="alg1.l12.m1.9.9.9.2.2.2">𝑧</ci><ci id="alg1.l12.m1.9.9.9.2.2.3.cmml" xref="alg1.l12.m1.9.9.9.2.2.3">′</ci></apply><apply id="alg1.l12.m1.10.10.10.3.3.cmml" xref="alg1.l12.m1.10.10.10.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.10.10.10.3.3.1.cmml" xref="alg1.l12.m1.10.10.10.3.3">superscript</csymbol><ci id="alg1.l12.m1.10.10.10.3.3.2.cmml" xref="alg1.l12.m1.10.10.10.3.3.2">𝑎</ci><ci id="alg1.l12.m1.10.10.10.3.3.3.cmml" xref="alg1.l12.m1.10.10.10.3.3.3">′</ci></apply><apply id="alg1.l12.m1.11.11.11.4.4.cmml" xref="alg1.l12.m1.11.11.11.4.4"><csymbol cd="ambiguous" id="alg1.l12.m1.11.11.11.4.4.1.cmml" xref="alg1.l12.m1.11.11.11.4.4">superscript</csymbol><ci id="alg1.l12.m1.11.11.11.4.4.2.cmml" xref="alg1.l12.m1.11.11.11.4.4.2">𝑐</ci><ci id="alg1.l12.m1.11.11.11.4.4.3.cmml" xref="alg1.l12.m1.11.11.11.4.4.3">′</ci></apply><apply id="alg1.l12.m1.12.12.12.5.5.cmml" xref="alg1.l12.m1.12.12.12.5.5"><csymbol cd="ambiguous" id="alg1.l12.m1.12.12.12.5.5.1.cmml" xref="alg1.l12.m1.12.12.12.5.5">superscript</csymbol><ci id="alg1.l12.m1.12.12.12.5.5.2.cmml" xref="alg1.l12.m1.12.12.12.5.5.2">𝑗</ci><ci id="alg1.l12.m1.12.12.12.5.5.3.cmml" xref="alg1.l12.m1.12.12.12.5.5.3">′</ci></apply><apply id="alg1.l12.m1.13.13.13.6.6.cmml" xref="alg1.l12.m1.13.13.13.6.6"><csymbol cd="ambiguous" id="alg1.l12.m1.13.13.13.6.6.1.cmml" xref="alg1.l12.m1.13.13.13.6.6">superscript</csymbol><ci id="alg1.l12.m1.13.13.13.6.6.2.cmml" xref="alg1.l12.m1.13.13.13.6.6.2">Δ</ci><ci id="alg1.l12.m1.13.13.13.6.6.3.cmml" xref="alg1.l12.m1.13.13.13.6.6.3">′</ci></apply><apply id="alg1.l12.m1.14.14.14.7.7.cmml" xref="alg1.l12.m1.14.14.14.7.7"><csymbol cd="ambiguous" id="alg1.l12.m1.14.14.14.7.7.1.cmml" xref="alg1.l12.m1.14.14.14.7.7">superscript</csymbol><ci id="alg1.l12.m1.14.14.14.7.7.2.cmml" xref="alg1.l12.m1.14.14.14.7.7.2">𝐺</ci><ci id="alg1.l12.m1.14.14.14.7.7.3.cmml" xref="alg1.l12.m1.14.14.14.7.7.3">′</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.14c">(h_{i+1},\hat{z}_{i+1},a_{i+1},\hat{c}_{i+1},\hat{j}_{i+1},\hat{\Delta}_{i+1},%
\hat{G}_{i+1})\leftarrow(h^{\prime},z^{\prime},a^{\prime},c^{\prime},j^{\prime%
},\Delta^{\prime},G^{\prime})</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.14d">( italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG roman_Δ end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_G end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ) ← ( italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_j start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , roman_Δ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>         <span class="ltx_text ltx_font_bold" id="alg1.l13.1">else</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>              Generate <math alttext="(\tilde{h}_{i+1},\tilde{z}_{i+1},\tilde{a}_{i+1},\tilde{r}_{i+1},\tilde{c}_{i+%
1},\tilde{j}_{i+1})" class="ltx_Math" display="inline" id="alg1.l14.m1.6"><semantics id="alg1.l14.m1.6a"><mrow id="alg1.l14.m1.6.6.6" xref="alg1.l14.m1.6.6.7.cmml"><mo id="alg1.l14.m1.6.6.6.7" stretchy="false" xref="alg1.l14.m1.6.6.7.cmml">(</mo><msub id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.cmml"><mover accent="true" id="alg1.l14.m1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.1.1.2.2" xref="alg1.l14.m1.1.1.1.1.2.2.cmml">h</mi><mo id="alg1.l14.m1.1.1.1.1.2.1" xref="alg1.l14.m1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="alg1.l14.m1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.1.1.3.2" xref="alg1.l14.m1.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l14.m1.1.1.1.1.3.1" xref="alg1.l14.m1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l14.m1.1.1.1.1.3.3" xref="alg1.l14.m1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l14.m1.6.6.6.8" xref="alg1.l14.m1.6.6.7.cmml">,</mo><msub id="alg1.l14.m1.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.cmml"><mover accent="true" id="alg1.l14.m1.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.cmml"><mi id="alg1.l14.m1.2.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.2.cmml">z</mi><mo id="alg1.l14.m1.2.2.2.2.2.1" xref="alg1.l14.m1.2.2.2.2.2.1.cmml">~</mo></mover><mrow id="alg1.l14.m1.2.2.2.2.3" xref="alg1.l14.m1.2.2.2.2.3.cmml"><mi id="alg1.l14.m1.2.2.2.2.3.2" xref="alg1.l14.m1.2.2.2.2.3.2.cmml">i</mi><mo id="alg1.l14.m1.2.2.2.2.3.1" xref="alg1.l14.m1.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l14.m1.2.2.2.2.3.3" xref="alg1.l14.m1.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l14.m1.6.6.6.9" xref="alg1.l14.m1.6.6.7.cmml">,</mo><msub id="alg1.l14.m1.3.3.3.3" xref="alg1.l14.m1.3.3.3.3.cmml"><mover accent="true" id="alg1.l14.m1.3.3.3.3.2" xref="alg1.l14.m1.3.3.3.3.2.cmml"><mi id="alg1.l14.m1.3.3.3.3.2.2" xref="alg1.l14.m1.3.3.3.3.2.2.cmml">a</mi><mo id="alg1.l14.m1.3.3.3.3.2.1" xref="alg1.l14.m1.3.3.3.3.2.1.cmml">~</mo></mover><mrow id="alg1.l14.m1.3.3.3.3.3" xref="alg1.l14.m1.3.3.3.3.3.cmml"><mi id="alg1.l14.m1.3.3.3.3.3.2" xref="alg1.l14.m1.3.3.3.3.3.2.cmml">i</mi><mo id="alg1.l14.m1.3.3.3.3.3.1" xref="alg1.l14.m1.3.3.3.3.3.1.cmml">+</mo><mn id="alg1.l14.m1.3.3.3.3.3.3" xref="alg1.l14.m1.3.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l14.m1.6.6.6.10" xref="alg1.l14.m1.6.6.7.cmml">,</mo><msub id="alg1.l14.m1.4.4.4.4" xref="alg1.l14.m1.4.4.4.4.cmml"><mover accent="true" id="alg1.l14.m1.4.4.4.4.2" xref="alg1.l14.m1.4.4.4.4.2.cmml"><mi id="alg1.l14.m1.4.4.4.4.2.2" xref="alg1.l14.m1.4.4.4.4.2.2.cmml">r</mi><mo id="alg1.l14.m1.4.4.4.4.2.1" xref="alg1.l14.m1.4.4.4.4.2.1.cmml">~</mo></mover><mrow id="alg1.l14.m1.4.4.4.4.3" xref="alg1.l14.m1.4.4.4.4.3.cmml"><mi id="alg1.l14.m1.4.4.4.4.3.2" xref="alg1.l14.m1.4.4.4.4.3.2.cmml">i</mi><mo id="alg1.l14.m1.4.4.4.4.3.1" xref="alg1.l14.m1.4.4.4.4.3.1.cmml">+</mo><mn id="alg1.l14.m1.4.4.4.4.3.3" xref="alg1.l14.m1.4.4.4.4.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l14.m1.6.6.6.11" xref="alg1.l14.m1.6.6.7.cmml">,</mo><msub id="alg1.l14.m1.5.5.5.5" xref="alg1.l14.m1.5.5.5.5.cmml"><mover accent="true" id="alg1.l14.m1.5.5.5.5.2" xref="alg1.l14.m1.5.5.5.5.2.cmml"><mi id="alg1.l14.m1.5.5.5.5.2.2" xref="alg1.l14.m1.5.5.5.5.2.2.cmml">c</mi><mo id="alg1.l14.m1.5.5.5.5.2.1" xref="alg1.l14.m1.5.5.5.5.2.1.cmml">~</mo></mover><mrow id="alg1.l14.m1.5.5.5.5.3" xref="alg1.l14.m1.5.5.5.5.3.cmml"><mi id="alg1.l14.m1.5.5.5.5.3.2" xref="alg1.l14.m1.5.5.5.5.3.2.cmml">i</mi><mo id="alg1.l14.m1.5.5.5.5.3.1" xref="alg1.l14.m1.5.5.5.5.3.1.cmml">+</mo><mn id="alg1.l14.m1.5.5.5.5.3.3" xref="alg1.l14.m1.5.5.5.5.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l14.m1.6.6.6.12" xref="alg1.l14.m1.6.6.7.cmml">,</mo><msub id="alg1.l14.m1.6.6.6.6" xref="alg1.l14.m1.6.6.6.6.cmml"><mover accent="true" id="alg1.l14.m1.6.6.6.6.2" xref="alg1.l14.m1.6.6.6.6.2.cmml"><mi id="alg1.l14.m1.6.6.6.6.2.2" xref="alg1.l14.m1.6.6.6.6.2.2.cmml">j</mi><mo id="alg1.l14.m1.6.6.6.6.2.1" xref="alg1.l14.m1.6.6.6.6.2.1.cmml">~</mo></mover><mrow id="alg1.l14.m1.6.6.6.6.3" xref="alg1.l14.m1.6.6.6.6.3.cmml"><mi id="alg1.l14.m1.6.6.6.6.3.2" xref="alg1.l14.m1.6.6.6.6.3.2.cmml">i</mi><mo id="alg1.l14.m1.6.6.6.6.3.1" xref="alg1.l14.m1.6.6.6.6.3.1.cmml">+</mo><mn id="alg1.l14.m1.6.6.6.6.3.3" xref="alg1.l14.m1.6.6.6.6.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l14.m1.6.6.6.13" stretchy="false" xref="alg1.l14.m1.6.6.7.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.6b"><vector id="alg1.l14.m1.6.6.7.cmml" xref="alg1.l14.m1.6.6.6"><apply id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l14.m1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.2"><ci id="alg1.l14.m1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.2.1">~</ci><ci id="alg1.l14.m1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.2.2">ℎ</ci></apply><apply id="alg1.l14.m1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.3"><plus id="alg1.l14.m1.1.1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.1.3.1"></plus><ci id="alg1.l14.m1.1.1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.1.3.2">𝑖</ci><cn id="alg1.l14.m1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l14.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l14.m1.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2">subscript</csymbol><apply id="alg1.l14.m1.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2"><ci id="alg1.l14.m1.2.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.2.1">~</ci><ci id="alg1.l14.m1.2.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2">𝑧</ci></apply><apply id="alg1.l14.m1.2.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.3"><plus id="alg1.l14.m1.2.2.2.2.3.1.cmml" xref="alg1.l14.m1.2.2.2.2.3.1"></plus><ci id="alg1.l14.m1.2.2.2.2.3.2.cmml" xref="alg1.l14.m1.2.2.2.2.3.2">𝑖</ci><cn id="alg1.l14.m1.2.2.2.2.3.3.cmml" type="integer" xref="alg1.l14.m1.2.2.2.2.3.3">1</cn></apply></apply><apply id="alg1.l14.m1.3.3.3.3.cmml" xref="alg1.l14.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.3.3.3.3.1.cmml" xref="alg1.l14.m1.3.3.3.3">subscript</csymbol><apply id="alg1.l14.m1.3.3.3.3.2.cmml" xref="alg1.l14.m1.3.3.3.3.2"><ci id="alg1.l14.m1.3.3.3.3.2.1.cmml" xref="alg1.l14.m1.3.3.3.3.2.1">~</ci><ci id="alg1.l14.m1.3.3.3.3.2.2.cmml" xref="alg1.l14.m1.3.3.3.3.2.2">𝑎</ci></apply><apply id="alg1.l14.m1.3.3.3.3.3.cmml" xref="alg1.l14.m1.3.3.3.3.3"><plus id="alg1.l14.m1.3.3.3.3.3.1.cmml" xref="alg1.l14.m1.3.3.3.3.3.1"></plus><ci id="alg1.l14.m1.3.3.3.3.3.2.cmml" xref="alg1.l14.m1.3.3.3.3.3.2">𝑖</ci><cn id="alg1.l14.m1.3.3.3.3.3.3.cmml" type="integer" xref="alg1.l14.m1.3.3.3.3.3.3">1</cn></apply></apply><apply id="alg1.l14.m1.4.4.4.4.cmml" xref="alg1.l14.m1.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l14.m1.4.4.4.4.1.cmml" xref="alg1.l14.m1.4.4.4.4">subscript</csymbol><apply id="alg1.l14.m1.4.4.4.4.2.cmml" xref="alg1.l14.m1.4.4.4.4.2"><ci id="alg1.l14.m1.4.4.4.4.2.1.cmml" xref="alg1.l14.m1.4.4.4.4.2.1">~</ci><ci id="alg1.l14.m1.4.4.4.4.2.2.cmml" xref="alg1.l14.m1.4.4.4.4.2.2">𝑟</ci></apply><apply id="alg1.l14.m1.4.4.4.4.3.cmml" xref="alg1.l14.m1.4.4.4.4.3"><plus id="alg1.l14.m1.4.4.4.4.3.1.cmml" xref="alg1.l14.m1.4.4.4.4.3.1"></plus><ci id="alg1.l14.m1.4.4.4.4.3.2.cmml" xref="alg1.l14.m1.4.4.4.4.3.2">𝑖</ci><cn id="alg1.l14.m1.4.4.4.4.3.3.cmml" type="integer" xref="alg1.l14.m1.4.4.4.4.3.3">1</cn></apply></apply><apply id="alg1.l14.m1.5.5.5.5.cmml" xref="alg1.l14.m1.5.5.5.5"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.5.5.1.cmml" xref="alg1.l14.m1.5.5.5.5">subscript</csymbol><apply id="alg1.l14.m1.5.5.5.5.2.cmml" xref="alg1.l14.m1.5.5.5.5.2"><ci id="alg1.l14.m1.5.5.5.5.2.1.cmml" xref="alg1.l14.m1.5.5.5.5.2.1">~</ci><ci id="alg1.l14.m1.5.5.5.5.2.2.cmml" xref="alg1.l14.m1.5.5.5.5.2.2">𝑐</ci></apply><apply id="alg1.l14.m1.5.5.5.5.3.cmml" xref="alg1.l14.m1.5.5.5.5.3"><plus id="alg1.l14.m1.5.5.5.5.3.1.cmml" xref="alg1.l14.m1.5.5.5.5.3.1"></plus><ci id="alg1.l14.m1.5.5.5.5.3.2.cmml" xref="alg1.l14.m1.5.5.5.5.3.2">𝑖</ci><cn id="alg1.l14.m1.5.5.5.5.3.3.cmml" type="integer" xref="alg1.l14.m1.5.5.5.5.3.3">1</cn></apply></apply><apply id="alg1.l14.m1.6.6.6.6.cmml" xref="alg1.l14.m1.6.6.6.6"><csymbol cd="ambiguous" id="alg1.l14.m1.6.6.6.6.1.cmml" xref="alg1.l14.m1.6.6.6.6">subscript</csymbol><apply id="alg1.l14.m1.6.6.6.6.2.cmml" xref="alg1.l14.m1.6.6.6.6.2"><ci id="alg1.l14.m1.6.6.6.6.2.1.cmml" xref="alg1.l14.m1.6.6.6.6.2.1">~</ci><ci id="alg1.l14.m1.6.6.6.6.2.2.cmml" xref="alg1.l14.m1.6.6.6.6.2.2">𝑗</ci></apply><apply id="alg1.l14.m1.6.6.6.6.3.cmml" xref="alg1.l14.m1.6.6.6.6.3"><plus id="alg1.l14.m1.6.6.6.6.3.1.cmml" xref="alg1.l14.m1.6.6.6.6.3.1"></plus><ci id="alg1.l14.m1.6.6.6.6.3.2.cmml" xref="alg1.l14.m1.6.6.6.6.3.2">𝑖</ci><cn id="alg1.l14.m1.6.6.6.6.3.3.cmml" type="integer" xref="alg1.l14.m1.6.6.6.6.3.3">1</cn></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.6c">(\tilde{h}_{i+1},\tilde{z}_{i+1},\tilde{a}_{i+1},\tilde{r}_{i+1},\tilde{c}_{i+%
1},\tilde{j}_{i+1})</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.6d">( over~ start_ARG italic_h end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> using <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.l14.m2.1"><semantics id="alg1.l14.m2.1a"><msub id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml"><mi id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2.cmml">π</mi><mi id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.1.cmml" xref="alg1.l14.m2.1.1">subscript</csymbol><ci id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2">𝜋</ci><ci id="alg1.l14.m2.1.1.3.cmml" xref="alg1.l14.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and short-term imagination of <math alttext="\mathcal{W}_{\phi}" class="ltx_Math" display="inline" id="alg1.l14.m3.1"><semantics id="alg1.l14.m3.1a"><msub id="alg1.l14.m3.1.1" xref="alg1.l14.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m3.1.1.2" xref="alg1.l14.m3.1.1.2.cmml">𝒲</mi><mi id="alg1.l14.m3.1.1.3" xref="alg1.l14.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.m3.1b"><apply id="alg1.l14.m3.1.1.cmml" xref="alg1.l14.m3.1.1"><csymbol cd="ambiguous" id="alg1.l14.m3.1.1.1.cmml" xref="alg1.l14.m3.1.1">subscript</csymbol><ci id="alg1.l14.m3.1.1.2.cmml" xref="alg1.l14.m3.1.1.2">𝒲</ci><ci id="alg1.l14.m3.1.1.3.cmml" xref="alg1.l14.m3.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m3.1c">\mathcal{W}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m3.1d">caligraphic_W start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>              Update <math alttext="(h_{i+1},\hat{z}_{i+1},a_{i+1},\hat{r}_{i+1},\hat{c}_{i+1},\hat{j}_{i+1})%
\leftarrow(\tilde{h}_{i+1},\tilde{z}_{i+1},\tilde{a}_{i+1},\tilde{r}_{i+1},%
\tilde{c}_{i+1},\tilde{j}_{i+1})" class="ltx_Math" display="inline" id="alg1.l15.m1.12"><semantics id="alg1.l15.m1.12a"><mrow id="alg1.l15.m1.12.12" xref="alg1.l15.m1.12.12.cmml"><mrow id="alg1.l15.m1.6.6.6.6" xref="alg1.l15.m1.6.6.6.7.cmml"><mo id="alg1.l15.m1.6.6.6.6.7" stretchy="false" xref="alg1.l15.m1.6.6.6.7.cmml">(</mo><msub id="alg1.l15.m1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.2.cmml">h</mi><mrow id="alg1.l15.m1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l15.m1.1.1.1.1.1.3.1" xref="alg1.l15.m1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l15.m1.1.1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.6.6.6.6.8" xref="alg1.l15.m1.6.6.6.7.cmml">,</mo><msub id="alg1.l15.m1.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.cmml"><mover accent="true" id="alg1.l15.m1.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l15.m1.2.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.2.2.cmml">z</mi><mo id="alg1.l15.m1.2.2.2.2.2.2.1" xref="alg1.l15.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l15.m1.2.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l15.m1.2.2.2.2.2.3.2" xref="alg1.l15.m1.2.2.2.2.2.3.2.cmml">i</mi><mo id="alg1.l15.m1.2.2.2.2.2.3.1" xref="alg1.l15.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l15.m1.2.2.2.2.2.3.3" xref="alg1.l15.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.6.6.6.6.9" xref="alg1.l15.m1.6.6.6.7.cmml">,</mo><msub id="alg1.l15.m1.3.3.3.3.3" xref="alg1.l15.m1.3.3.3.3.3.cmml"><mi id="alg1.l15.m1.3.3.3.3.3.2" xref="alg1.l15.m1.3.3.3.3.3.2.cmml">a</mi><mrow id="alg1.l15.m1.3.3.3.3.3.3" xref="alg1.l15.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l15.m1.3.3.3.3.3.3.2" xref="alg1.l15.m1.3.3.3.3.3.3.2.cmml">i</mi><mo id="alg1.l15.m1.3.3.3.3.3.3.1" xref="alg1.l15.m1.3.3.3.3.3.3.1.cmml">+</mo><mn id="alg1.l15.m1.3.3.3.3.3.3.3" xref="alg1.l15.m1.3.3.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.6.6.6.6.10" xref="alg1.l15.m1.6.6.6.7.cmml">,</mo><msub id="alg1.l15.m1.4.4.4.4.4" xref="alg1.l15.m1.4.4.4.4.4.cmml"><mover accent="true" id="alg1.l15.m1.4.4.4.4.4.2" xref="alg1.l15.m1.4.4.4.4.4.2.cmml"><mi id="alg1.l15.m1.4.4.4.4.4.2.2" xref="alg1.l15.m1.4.4.4.4.4.2.2.cmml">r</mi><mo id="alg1.l15.m1.4.4.4.4.4.2.1" xref="alg1.l15.m1.4.4.4.4.4.2.1.cmml">^</mo></mover><mrow id="alg1.l15.m1.4.4.4.4.4.3" xref="alg1.l15.m1.4.4.4.4.4.3.cmml"><mi id="alg1.l15.m1.4.4.4.4.4.3.2" xref="alg1.l15.m1.4.4.4.4.4.3.2.cmml">i</mi><mo id="alg1.l15.m1.4.4.4.4.4.3.1" xref="alg1.l15.m1.4.4.4.4.4.3.1.cmml">+</mo><mn id="alg1.l15.m1.4.4.4.4.4.3.3" xref="alg1.l15.m1.4.4.4.4.4.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.6.6.6.6.11" xref="alg1.l15.m1.6.6.6.7.cmml">,</mo><msub id="alg1.l15.m1.5.5.5.5.5" xref="alg1.l15.m1.5.5.5.5.5.cmml"><mover accent="true" id="alg1.l15.m1.5.5.5.5.5.2" xref="alg1.l15.m1.5.5.5.5.5.2.cmml"><mi id="alg1.l15.m1.5.5.5.5.5.2.2" xref="alg1.l15.m1.5.5.5.5.5.2.2.cmml">c</mi><mo id="alg1.l15.m1.5.5.5.5.5.2.1" xref="alg1.l15.m1.5.5.5.5.5.2.1.cmml">^</mo></mover><mrow id="alg1.l15.m1.5.5.5.5.5.3" xref="alg1.l15.m1.5.5.5.5.5.3.cmml"><mi id="alg1.l15.m1.5.5.5.5.5.3.2" xref="alg1.l15.m1.5.5.5.5.5.3.2.cmml">i</mi><mo id="alg1.l15.m1.5.5.5.5.5.3.1" xref="alg1.l15.m1.5.5.5.5.5.3.1.cmml">+</mo><mn id="alg1.l15.m1.5.5.5.5.5.3.3" xref="alg1.l15.m1.5.5.5.5.5.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.6.6.6.6.12" xref="alg1.l15.m1.6.6.6.7.cmml">,</mo><msub id="alg1.l15.m1.6.6.6.6.6" xref="alg1.l15.m1.6.6.6.6.6.cmml"><mover accent="true" id="alg1.l15.m1.6.6.6.6.6.2" xref="alg1.l15.m1.6.6.6.6.6.2.cmml"><mi id="alg1.l15.m1.6.6.6.6.6.2.2" xref="alg1.l15.m1.6.6.6.6.6.2.2.cmml">j</mi><mo id="alg1.l15.m1.6.6.6.6.6.2.1" xref="alg1.l15.m1.6.6.6.6.6.2.1.cmml">^</mo></mover><mrow id="alg1.l15.m1.6.6.6.6.6.3" xref="alg1.l15.m1.6.6.6.6.6.3.cmml"><mi id="alg1.l15.m1.6.6.6.6.6.3.2" xref="alg1.l15.m1.6.6.6.6.6.3.2.cmml">i</mi><mo id="alg1.l15.m1.6.6.6.6.6.3.1" xref="alg1.l15.m1.6.6.6.6.6.3.1.cmml">+</mo><mn id="alg1.l15.m1.6.6.6.6.6.3.3" xref="alg1.l15.m1.6.6.6.6.6.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.6.6.6.6.13" stretchy="false" xref="alg1.l15.m1.6.6.6.7.cmml">)</mo></mrow><mo id="alg1.l15.m1.12.12.13" stretchy="false" xref="alg1.l15.m1.12.12.13.cmml">←</mo><mrow id="alg1.l15.m1.12.12.12.6" xref="alg1.l15.m1.12.12.12.7.cmml"><mo id="alg1.l15.m1.12.12.12.6.7" stretchy="false" xref="alg1.l15.m1.12.12.12.7.cmml">(</mo><msub id="alg1.l15.m1.7.7.7.1.1" xref="alg1.l15.m1.7.7.7.1.1.cmml"><mover accent="true" id="alg1.l15.m1.7.7.7.1.1.2" xref="alg1.l15.m1.7.7.7.1.1.2.cmml"><mi id="alg1.l15.m1.7.7.7.1.1.2.2" xref="alg1.l15.m1.7.7.7.1.1.2.2.cmml">h</mi><mo id="alg1.l15.m1.7.7.7.1.1.2.1" xref="alg1.l15.m1.7.7.7.1.1.2.1.cmml">~</mo></mover><mrow id="alg1.l15.m1.7.7.7.1.1.3" xref="alg1.l15.m1.7.7.7.1.1.3.cmml"><mi id="alg1.l15.m1.7.7.7.1.1.3.2" xref="alg1.l15.m1.7.7.7.1.1.3.2.cmml">i</mi><mo id="alg1.l15.m1.7.7.7.1.1.3.1" xref="alg1.l15.m1.7.7.7.1.1.3.1.cmml">+</mo><mn id="alg1.l15.m1.7.7.7.1.1.3.3" xref="alg1.l15.m1.7.7.7.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.12.12.12.6.8" xref="alg1.l15.m1.12.12.12.7.cmml">,</mo><msub id="alg1.l15.m1.8.8.8.2.2" xref="alg1.l15.m1.8.8.8.2.2.cmml"><mover accent="true" id="alg1.l15.m1.8.8.8.2.2.2" xref="alg1.l15.m1.8.8.8.2.2.2.cmml"><mi id="alg1.l15.m1.8.8.8.2.2.2.2" xref="alg1.l15.m1.8.8.8.2.2.2.2.cmml">z</mi><mo id="alg1.l15.m1.8.8.8.2.2.2.1" xref="alg1.l15.m1.8.8.8.2.2.2.1.cmml">~</mo></mover><mrow id="alg1.l15.m1.8.8.8.2.2.3" xref="alg1.l15.m1.8.8.8.2.2.3.cmml"><mi id="alg1.l15.m1.8.8.8.2.2.3.2" xref="alg1.l15.m1.8.8.8.2.2.3.2.cmml">i</mi><mo id="alg1.l15.m1.8.8.8.2.2.3.1" xref="alg1.l15.m1.8.8.8.2.2.3.1.cmml">+</mo><mn id="alg1.l15.m1.8.8.8.2.2.3.3" xref="alg1.l15.m1.8.8.8.2.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.12.12.12.6.9" xref="alg1.l15.m1.12.12.12.7.cmml">,</mo><msub id="alg1.l15.m1.9.9.9.3.3" xref="alg1.l15.m1.9.9.9.3.3.cmml"><mover accent="true" id="alg1.l15.m1.9.9.9.3.3.2" xref="alg1.l15.m1.9.9.9.3.3.2.cmml"><mi id="alg1.l15.m1.9.9.9.3.3.2.2" xref="alg1.l15.m1.9.9.9.3.3.2.2.cmml">a</mi><mo id="alg1.l15.m1.9.9.9.3.3.2.1" xref="alg1.l15.m1.9.9.9.3.3.2.1.cmml">~</mo></mover><mrow id="alg1.l15.m1.9.9.9.3.3.3" xref="alg1.l15.m1.9.9.9.3.3.3.cmml"><mi id="alg1.l15.m1.9.9.9.3.3.3.2" xref="alg1.l15.m1.9.9.9.3.3.3.2.cmml">i</mi><mo id="alg1.l15.m1.9.9.9.3.3.3.1" xref="alg1.l15.m1.9.9.9.3.3.3.1.cmml">+</mo><mn id="alg1.l15.m1.9.9.9.3.3.3.3" xref="alg1.l15.m1.9.9.9.3.3.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.12.12.12.6.10" xref="alg1.l15.m1.12.12.12.7.cmml">,</mo><msub id="alg1.l15.m1.10.10.10.4.4" xref="alg1.l15.m1.10.10.10.4.4.cmml"><mover accent="true" id="alg1.l15.m1.10.10.10.4.4.2" xref="alg1.l15.m1.10.10.10.4.4.2.cmml"><mi id="alg1.l15.m1.10.10.10.4.4.2.2" xref="alg1.l15.m1.10.10.10.4.4.2.2.cmml">r</mi><mo id="alg1.l15.m1.10.10.10.4.4.2.1" xref="alg1.l15.m1.10.10.10.4.4.2.1.cmml">~</mo></mover><mrow id="alg1.l15.m1.10.10.10.4.4.3" xref="alg1.l15.m1.10.10.10.4.4.3.cmml"><mi id="alg1.l15.m1.10.10.10.4.4.3.2" xref="alg1.l15.m1.10.10.10.4.4.3.2.cmml">i</mi><mo id="alg1.l15.m1.10.10.10.4.4.3.1" xref="alg1.l15.m1.10.10.10.4.4.3.1.cmml">+</mo><mn id="alg1.l15.m1.10.10.10.4.4.3.3" xref="alg1.l15.m1.10.10.10.4.4.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.12.12.12.6.11" xref="alg1.l15.m1.12.12.12.7.cmml">,</mo><msub id="alg1.l15.m1.11.11.11.5.5" xref="alg1.l15.m1.11.11.11.5.5.cmml"><mover accent="true" id="alg1.l15.m1.11.11.11.5.5.2" xref="alg1.l15.m1.11.11.11.5.5.2.cmml"><mi id="alg1.l15.m1.11.11.11.5.5.2.2" xref="alg1.l15.m1.11.11.11.5.5.2.2.cmml">c</mi><mo id="alg1.l15.m1.11.11.11.5.5.2.1" xref="alg1.l15.m1.11.11.11.5.5.2.1.cmml">~</mo></mover><mrow id="alg1.l15.m1.11.11.11.5.5.3" xref="alg1.l15.m1.11.11.11.5.5.3.cmml"><mi id="alg1.l15.m1.11.11.11.5.5.3.2" xref="alg1.l15.m1.11.11.11.5.5.3.2.cmml">i</mi><mo id="alg1.l15.m1.11.11.11.5.5.3.1" xref="alg1.l15.m1.11.11.11.5.5.3.1.cmml">+</mo><mn id="alg1.l15.m1.11.11.11.5.5.3.3" xref="alg1.l15.m1.11.11.11.5.5.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.12.12.12.6.12" xref="alg1.l15.m1.12.12.12.7.cmml">,</mo><msub id="alg1.l15.m1.12.12.12.6.6" xref="alg1.l15.m1.12.12.12.6.6.cmml"><mover accent="true" id="alg1.l15.m1.12.12.12.6.6.2" xref="alg1.l15.m1.12.12.12.6.6.2.cmml"><mi id="alg1.l15.m1.12.12.12.6.6.2.2" xref="alg1.l15.m1.12.12.12.6.6.2.2.cmml">j</mi><mo id="alg1.l15.m1.12.12.12.6.6.2.1" xref="alg1.l15.m1.12.12.12.6.6.2.1.cmml">~</mo></mover><mrow id="alg1.l15.m1.12.12.12.6.6.3" xref="alg1.l15.m1.12.12.12.6.6.3.cmml"><mi id="alg1.l15.m1.12.12.12.6.6.3.2" xref="alg1.l15.m1.12.12.12.6.6.3.2.cmml">i</mi><mo id="alg1.l15.m1.12.12.12.6.6.3.1" xref="alg1.l15.m1.12.12.12.6.6.3.1.cmml">+</mo><mn id="alg1.l15.m1.12.12.12.6.6.3.3" xref="alg1.l15.m1.12.12.12.6.6.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l15.m1.12.12.12.6.13" stretchy="false" xref="alg1.l15.m1.12.12.12.7.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.12b"><apply id="alg1.l15.m1.12.12.cmml" xref="alg1.l15.m1.12.12"><ci id="alg1.l15.m1.12.12.13.cmml" xref="alg1.l15.m1.12.12.13">←</ci><vector id="alg1.l15.m1.6.6.6.7.cmml" xref="alg1.l15.m1.6.6.6.6"><apply id="alg1.l15.m1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.2">ℎ</ci><apply id="alg1.l15.m1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.3"><plus id="alg1.l15.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.3.1"></plus><ci id="alg1.l15.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.3.2">𝑖</ci><cn id="alg1.l15.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l15.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.2.1.cmml" xref="alg1.l15.m1.2.2.2.2.2">subscript</csymbol><apply id="alg1.l15.m1.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2"><ci id="alg1.l15.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.1">^</ci><ci id="alg1.l15.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.2">𝑧</ci></apply><apply id="alg1.l15.m1.2.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.3"><plus id="alg1.l15.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l15.m1.2.2.2.2.2.3.1"></plus><ci id="alg1.l15.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.3.2">𝑖</ci><cn id="alg1.l15.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="alg1.l15.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.3.3.3.3.3.cmml" xref="alg1.l15.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.3.3.3.1.cmml" xref="alg1.l15.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l15.m1.3.3.3.3.3.2.cmml" xref="alg1.l15.m1.3.3.3.3.3.2">𝑎</ci><apply id="alg1.l15.m1.3.3.3.3.3.3.cmml" xref="alg1.l15.m1.3.3.3.3.3.3"><plus id="alg1.l15.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l15.m1.3.3.3.3.3.3.1"></plus><ci id="alg1.l15.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l15.m1.3.3.3.3.3.3.2">𝑖</ci><cn id="alg1.l15.m1.3.3.3.3.3.3.3.cmml" type="integer" xref="alg1.l15.m1.3.3.3.3.3.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.4.4.4.4.4.cmml" xref="alg1.l15.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.4.4.4.1.cmml" xref="alg1.l15.m1.4.4.4.4.4">subscript</csymbol><apply id="alg1.l15.m1.4.4.4.4.4.2.cmml" xref="alg1.l15.m1.4.4.4.4.4.2"><ci id="alg1.l15.m1.4.4.4.4.4.2.1.cmml" xref="alg1.l15.m1.4.4.4.4.4.2.1">^</ci><ci id="alg1.l15.m1.4.4.4.4.4.2.2.cmml" xref="alg1.l15.m1.4.4.4.4.4.2.2">𝑟</ci></apply><apply id="alg1.l15.m1.4.4.4.4.4.3.cmml" xref="alg1.l15.m1.4.4.4.4.4.3"><plus id="alg1.l15.m1.4.4.4.4.4.3.1.cmml" xref="alg1.l15.m1.4.4.4.4.4.3.1"></plus><ci id="alg1.l15.m1.4.4.4.4.4.3.2.cmml" xref="alg1.l15.m1.4.4.4.4.4.3.2">𝑖</ci><cn id="alg1.l15.m1.4.4.4.4.4.3.3.cmml" type="integer" xref="alg1.l15.m1.4.4.4.4.4.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.5.5.5.5.5.cmml" xref="alg1.l15.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.5.5.5.1.cmml" xref="alg1.l15.m1.5.5.5.5.5">subscript</csymbol><apply id="alg1.l15.m1.5.5.5.5.5.2.cmml" xref="alg1.l15.m1.5.5.5.5.5.2"><ci id="alg1.l15.m1.5.5.5.5.5.2.1.cmml" xref="alg1.l15.m1.5.5.5.5.5.2.1">^</ci><ci id="alg1.l15.m1.5.5.5.5.5.2.2.cmml" xref="alg1.l15.m1.5.5.5.5.5.2.2">𝑐</ci></apply><apply id="alg1.l15.m1.5.5.5.5.5.3.cmml" xref="alg1.l15.m1.5.5.5.5.5.3"><plus id="alg1.l15.m1.5.5.5.5.5.3.1.cmml" xref="alg1.l15.m1.5.5.5.5.5.3.1"></plus><ci id="alg1.l15.m1.5.5.5.5.5.3.2.cmml" xref="alg1.l15.m1.5.5.5.5.5.3.2">𝑖</ci><cn id="alg1.l15.m1.5.5.5.5.5.3.3.cmml" type="integer" xref="alg1.l15.m1.5.5.5.5.5.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.6.6.6.6.6.cmml" xref="alg1.l15.m1.6.6.6.6.6"><csymbol cd="ambiguous" id="alg1.l15.m1.6.6.6.6.6.1.cmml" xref="alg1.l15.m1.6.6.6.6.6">subscript</csymbol><apply id="alg1.l15.m1.6.6.6.6.6.2.cmml" xref="alg1.l15.m1.6.6.6.6.6.2"><ci id="alg1.l15.m1.6.6.6.6.6.2.1.cmml" xref="alg1.l15.m1.6.6.6.6.6.2.1">^</ci><ci id="alg1.l15.m1.6.6.6.6.6.2.2.cmml" xref="alg1.l15.m1.6.6.6.6.6.2.2">𝑗</ci></apply><apply id="alg1.l15.m1.6.6.6.6.6.3.cmml" xref="alg1.l15.m1.6.6.6.6.6.3"><plus id="alg1.l15.m1.6.6.6.6.6.3.1.cmml" xref="alg1.l15.m1.6.6.6.6.6.3.1"></plus><ci id="alg1.l15.m1.6.6.6.6.6.3.2.cmml" xref="alg1.l15.m1.6.6.6.6.6.3.2">𝑖</ci><cn id="alg1.l15.m1.6.6.6.6.6.3.3.cmml" type="integer" xref="alg1.l15.m1.6.6.6.6.6.3.3">1</cn></apply></apply></vector><vector id="alg1.l15.m1.12.12.12.7.cmml" xref="alg1.l15.m1.12.12.12.6"><apply id="alg1.l15.m1.7.7.7.1.1.cmml" xref="alg1.l15.m1.7.7.7.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.7.7.7.1.1.1.cmml" xref="alg1.l15.m1.7.7.7.1.1">subscript</csymbol><apply id="alg1.l15.m1.7.7.7.1.1.2.cmml" xref="alg1.l15.m1.7.7.7.1.1.2"><ci id="alg1.l15.m1.7.7.7.1.1.2.1.cmml" xref="alg1.l15.m1.7.7.7.1.1.2.1">~</ci><ci id="alg1.l15.m1.7.7.7.1.1.2.2.cmml" xref="alg1.l15.m1.7.7.7.1.1.2.2">ℎ</ci></apply><apply id="alg1.l15.m1.7.7.7.1.1.3.cmml" xref="alg1.l15.m1.7.7.7.1.1.3"><plus id="alg1.l15.m1.7.7.7.1.1.3.1.cmml" xref="alg1.l15.m1.7.7.7.1.1.3.1"></plus><ci id="alg1.l15.m1.7.7.7.1.1.3.2.cmml" xref="alg1.l15.m1.7.7.7.1.1.3.2">𝑖</ci><cn id="alg1.l15.m1.7.7.7.1.1.3.3.cmml" type="integer" xref="alg1.l15.m1.7.7.7.1.1.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.8.8.8.2.2.cmml" xref="alg1.l15.m1.8.8.8.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.8.8.8.2.2.1.cmml" xref="alg1.l15.m1.8.8.8.2.2">subscript</csymbol><apply id="alg1.l15.m1.8.8.8.2.2.2.cmml" xref="alg1.l15.m1.8.8.8.2.2.2"><ci id="alg1.l15.m1.8.8.8.2.2.2.1.cmml" xref="alg1.l15.m1.8.8.8.2.2.2.1">~</ci><ci id="alg1.l15.m1.8.8.8.2.2.2.2.cmml" xref="alg1.l15.m1.8.8.8.2.2.2.2">𝑧</ci></apply><apply id="alg1.l15.m1.8.8.8.2.2.3.cmml" xref="alg1.l15.m1.8.8.8.2.2.3"><plus id="alg1.l15.m1.8.8.8.2.2.3.1.cmml" xref="alg1.l15.m1.8.8.8.2.2.3.1"></plus><ci id="alg1.l15.m1.8.8.8.2.2.3.2.cmml" xref="alg1.l15.m1.8.8.8.2.2.3.2">𝑖</ci><cn id="alg1.l15.m1.8.8.8.2.2.3.3.cmml" type="integer" xref="alg1.l15.m1.8.8.8.2.2.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.9.9.9.3.3.cmml" xref="alg1.l15.m1.9.9.9.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.9.9.9.3.3.1.cmml" xref="alg1.l15.m1.9.9.9.3.3">subscript</csymbol><apply id="alg1.l15.m1.9.9.9.3.3.2.cmml" xref="alg1.l15.m1.9.9.9.3.3.2"><ci id="alg1.l15.m1.9.9.9.3.3.2.1.cmml" xref="alg1.l15.m1.9.9.9.3.3.2.1">~</ci><ci id="alg1.l15.m1.9.9.9.3.3.2.2.cmml" xref="alg1.l15.m1.9.9.9.3.3.2.2">𝑎</ci></apply><apply id="alg1.l15.m1.9.9.9.3.3.3.cmml" xref="alg1.l15.m1.9.9.9.3.3.3"><plus id="alg1.l15.m1.9.9.9.3.3.3.1.cmml" xref="alg1.l15.m1.9.9.9.3.3.3.1"></plus><ci id="alg1.l15.m1.9.9.9.3.3.3.2.cmml" xref="alg1.l15.m1.9.9.9.3.3.3.2">𝑖</ci><cn id="alg1.l15.m1.9.9.9.3.3.3.3.cmml" type="integer" xref="alg1.l15.m1.9.9.9.3.3.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.10.10.10.4.4.cmml" xref="alg1.l15.m1.10.10.10.4.4"><csymbol cd="ambiguous" id="alg1.l15.m1.10.10.10.4.4.1.cmml" xref="alg1.l15.m1.10.10.10.4.4">subscript</csymbol><apply id="alg1.l15.m1.10.10.10.4.4.2.cmml" xref="alg1.l15.m1.10.10.10.4.4.2"><ci id="alg1.l15.m1.10.10.10.4.4.2.1.cmml" xref="alg1.l15.m1.10.10.10.4.4.2.1">~</ci><ci id="alg1.l15.m1.10.10.10.4.4.2.2.cmml" xref="alg1.l15.m1.10.10.10.4.4.2.2">𝑟</ci></apply><apply id="alg1.l15.m1.10.10.10.4.4.3.cmml" xref="alg1.l15.m1.10.10.10.4.4.3"><plus id="alg1.l15.m1.10.10.10.4.4.3.1.cmml" xref="alg1.l15.m1.10.10.10.4.4.3.1"></plus><ci id="alg1.l15.m1.10.10.10.4.4.3.2.cmml" xref="alg1.l15.m1.10.10.10.4.4.3.2">𝑖</ci><cn id="alg1.l15.m1.10.10.10.4.4.3.3.cmml" type="integer" xref="alg1.l15.m1.10.10.10.4.4.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.11.11.11.5.5.cmml" xref="alg1.l15.m1.11.11.11.5.5"><csymbol cd="ambiguous" id="alg1.l15.m1.11.11.11.5.5.1.cmml" xref="alg1.l15.m1.11.11.11.5.5">subscript</csymbol><apply id="alg1.l15.m1.11.11.11.5.5.2.cmml" xref="alg1.l15.m1.11.11.11.5.5.2"><ci id="alg1.l15.m1.11.11.11.5.5.2.1.cmml" xref="alg1.l15.m1.11.11.11.5.5.2.1">~</ci><ci id="alg1.l15.m1.11.11.11.5.5.2.2.cmml" xref="alg1.l15.m1.11.11.11.5.5.2.2">𝑐</ci></apply><apply id="alg1.l15.m1.11.11.11.5.5.3.cmml" xref="alg1.l15.m1.11.11.11.5.5.3"><plus id="alg1.l15.m1.11.11.11.5.5.3.1.cmml" xref="alg1.l15.m1.11.11.11.5.5.3.1"></plus><ci id="alg1.l15.m1.11.11.11.5.5.3.2.cmml" xref="alg1.l15.m1.11.11.11.5.5.3.2">𝑖</ci><cn id="alg1.l15.m1.11.11.11.5.5.3.3.cmml" type="integer" xref="alg1.l15.m1.11.11.11.5.5.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.12.12.12.6.6.cmml" xref="alg1.l15.m1.12.12.12.6.6"><csymbol cd="ambiguous" id="alg1.l15.m1.12.12.12.6.6.1.cmml" xref="alg1.l15.m1.12.12.12.6.6">subscript</csymbol><apply id="alg1.l15.m1.12.12.12.6.6.2.cmml" xref="alg1.l15.m1.12.12.12.6.6.2"><ci id="alg1.l15.m1.12.12.12.6.6.2.1.cmml" xref="alg1.l15.m1.12.12.12.6.6.2.1">~</ci><ci id="alg1.l15.m1.12.12.12.6.6.2.2.cmml" xref="alg1.l15.m1.12.12.12.6.6.2.2">𝑗</ci></apply><apply id="alg1.l15.m1.12.12.12.6.6.3.cmml" xref="alg1.l15.m1.12.12.12.6.6.3"><plus id="alg1.l15.m1.12.12.12.6.6.3.1.cmml" xref="alg1.l15.m1.12.12.12.6.6.3.1"></plus><ci id="alg1.l15.m1.12.12.12.6.6.3.2.cmml" xref="alg1.l15.m1.12.12.12.6.6.3.2">𝑖</ci><cn id="alg1.l15.m1.12.12.12.6.6.3.3.cmml" type="integer" xref="alg1.l15.m1.12.12.12.6.6.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.12c">(h_{i+1},\hat{z}_{i+1},a_{i+1},\hat{r}_{i+1},\hat{c}_{i+1},\hat{j}_{i+1})%
\leftarrow(\tilde{h}_{i+1},\tilde{z}_{i+1},\tilde{a}_{i+1},\tilde{r}_{i+1},%
\tilde{c}_{i+1},\tilde{j}_{i+1})</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.12d">( italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ) ← ( over~ start_ARG italic_h end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>         <span class="ltx_text ltx_font_bold" id="alg1.l16.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l16.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l17.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l17.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>     Calculate value estimate using Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.E9" title="In 3.4 Behavior Learning over Mixed Long Short-Term Imaginations ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">9</span></a>).

</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span>     Optimize actor <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><msub id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mi id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml">π</mi><mi id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1">subscript</csymbol><ci id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">𝜋</ci><ci id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> using Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.E11" title="In 3.4 Behavior Learning over Mixed Long Short-Term Imaginations ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">11</span></a>) over <math alttext="\{(h_{i+1},\hat{z}_{i+1},a_{i+1},\hat{r}_{i+1},\hat{c}_{i+1},\hat{j}_{i+1},%
\hat{\Delta}_{i+1},\hat{G}_{i+1})\}_{i=t}^{t+L}" class="ltx_Math" display="inline" id="alg1.l19.m2.1"><semantics id="alg1.l19.m2.1a"><msubsup id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml"><mrow id="alg1.l19.m2.1.1.1.1.1" xref="alg1.l19.m2.1.1.1.1.2.cmml"><mo id="alg1.l19.m2.1.1.1.1.1.2" stretchy="false" xref="alg1.l19.m2.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l19.m2.1.1.1.1.1.1.8" xref="alg1.l19.m2.1.1.1.1.1.1.9.cmml"><mo id="alg1.l19.m2.1.1.1.1.1.1.8.9" stretchy="false" xref="alg1.l19.m2.1.1.1.1.1.1.9.cmml">(</mo><msub id="alg1.l19.m2.1.1.1.1.1.1.1.1" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.1.1.2" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.2.cmml">h</mi><mrow id="alg1.l19.m2.1.1.1.1.1.1.1.1.3" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.1.1.3.2" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.1.1.3.1" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l19.m2.1.1.1.1.1.1.1.1.3.3" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l19.m2.1.1.1.1.1.1.8.10" xref="alg1.l19.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l19.m2.1.1.1.1.1.1.2.2" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="alg1.l19.m2.1.1.1.1.1.1.2.2.2" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.2.2.2.2" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.2.2.cmml">z</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.2.2.2.1" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l19.m2.1.1.1.1.1.1.2.2.3" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.2.2.3.2" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.2.2.3.1" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.3.1.cmml">+</mo><mn id="alg1.l19.m2.1.1.1.1.1.1.2.2.3.3" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l19.m2.1.1.1.1.1.1.8.11" xref="alg1.l19.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l19.m2.1.1.1.1.1.1.3.3" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.3.3.2" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.2.cmml">a</mi><mrow id="alg1.l19.m2.1.1.1.1.1.1.3.3.3" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.3.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.3.3.3.2" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.3.3.3.1" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mn id="alg1.l19.m2.1.1.1.1.1.1.3.3.3.3" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l19.m2.1.1.1.1.1.1.8.12" xref="alg1.l19.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l19.m2.1.1.1.1.1.1.4.4" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.cmml"><mover accent="true" id="alg1.l19.m2.1.1.1.1.1.1.4.4.2" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.2.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.4.4.2.2" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.2.2.cmml">r</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.4.4.2.1" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.2.1.cmml">^</mo></mover><mrow id="alg1.l19.m2.1.1.1.1.1.1.4.4.3" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.3.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.4.4.3.2" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.3.2.cmml">i</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.4.4.3.1" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.3.1.cmml">+</mo><mn id="alg1.l19.m2.1.1.1.1.1.1.4.4.3.3" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l19.m2.1.1.1.1.1.1.8.13" xref="alg1.l19.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l19.m2.1.1.1.1.1.1.5.5" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.cmml"><mover accent="true" id="alg1.l19.m2.1.1.1.1.1.1.5.5.2" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.2.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.5.5.2.2" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.2.2.cmml">c</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.5.5.2.1" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.2.1.cmml">^</mo></mover><mrow id="alg1.l19.m2.1.1.1.1.1.1.5.5.3" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.3.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.5.5.3.2" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.3.2.cmml">i</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.5.5.3.1" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.3.1.cmml">+</mo><mn id="alg1.l19.m2.1.1.1.1.1.1.5.5.3.3" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l19.m2.1.1.1.1.1.1.8.14" xref="alg1.l19.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l19.m2.1.1.1.1.1.1.6.6" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.cmml"><mover accent="true" id="alg1.l19.m2.1.1.1.1.1.1.6.6.2" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.2.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.6.6.2.2" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.2.2.cmml">j</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.6.6.2.1" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.2.1.cmml">^</mo></mover><mrow id="alg1.l19.m2.1.1.1.1.1.1.6.6.3" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.3.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.6.6.3.2" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.3.2.cmml">i</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.6.6.3.1" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.3.1.cmml">+</mo><mn id="alg1.l19.m2.1.1.1.1.1.1.6.6.3.3" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l19.m2.1.1.1.1.1.1.8.15" xref="alg1.l19.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l19.m2.1.1.1.1.1.1.7.7" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.cmml"><mover accent="true" id="alg1.l19.m2.1.1.1.1.1.1.7.7.2" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.2.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.7.7.2.2" mathvariant="normal" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.2.2.cmml">Δ</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.7.7.2.1" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.2.1.cmml">^</mo></mover><mrow id="alg1.l19.m2.1.1.1.1.1.1.7.7.3" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.3.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.7.7.3.2" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.3.2.cmml">i</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.7.7.3.1" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.3.1.cmml">+</mo><mn id="alg1.l19.m2.1.1.1.1.1.1.7.7.3.3" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l19.m2.1.1.1.1.1.1.8.16" xref="alg1.l19.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l19.m2.1.1.1.1.1.1.8.8" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.cmml"><mover accent="true" id="alg1.l19.m2.1.1.1.1.1.1.8.8.2" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.2.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.8.8.2.2" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.2.2.cmml">G</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.8.8.2.1" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.2.1.cmml">^</mo></mover><mrow id="alg1.l19.m2.1.1.1.1.1.1.8.8.3" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.3.cmml"><mi id="alg1.l19.m2.1.1.1.1.1.1.8.8.3.2" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.3.2.cmml">i</mi><mo id="alg1.l19.m2.1.1.1.1.1.1.8.8.3.1" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.3.1.cmml">+</mo><mn id="alg1.l19.m2.1.1.1.1.1.1.8.8.3.3" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l19.m2.1.1.1.1.1.1.8.17" stretchy="false" xref="alg1.l19.m2.1.1.1.1.1.1.9.cmml">)</mo></mrow><mo id="alg1.l19.m2.1.1.1.1.1.3" stretchy="false" xref="alg1.l19.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l19.m2.1.1.1.3" xref="alg1.l19.m2.1.1.1.3.cmml"><mi id="alg1.l19.m2.1.1.1.3.2" xref="alg1.l19.m2.1.1.1.3.2.cmml">i</mi><mo id="alg1.l19.m2.1.1.1.3.1" xref="alg1.l19.m2.1.1.1.3.1.cmml">=</mo><mi id="alg1.l19.m2.1.1.1.3.3" xref="alg1.l19.m2.1.1.1.3.3.cmml">t</mi></mrow><mrow id="alg1.l19.m2.1.1.3" xref="alg1.l19.m2.1.1.3.cmml"><mi id="alg1.l19.m2.1.1.3.2" xref="alg1.l19.m2.1.1.3.2.cmml">t</mi><mo id="alg1.l19.m2.1.1.3.1" xref="alg1.l19.m2.1.1.3.1.cmml">+</mo><mi id="alg1.l19.m2.1.1.3.3" xref="alg1.l19.m2.1.1.3.3.cmml">L</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><apply id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.2.cmml" xref="alg1.l19.m2.1.1">superscript</csymbol><apply id="alg1.l19.m2.1.1.1.cmml" xref="alg1.l19.m2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.2.cmml" xref="alg1.l19.m2.1.1">subscript</csymbol><set id="alg1.l19.m2.1.1.1.1.2.cmml" xref="alg1.l19.m2.1.1.1.1.1"><vector id="alg1.l19.m2.1.1.1.1.1.1.9.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.8"><apply id="alg1.l19.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l19.m2.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.2">ℎ</ci><apply id="alg1.l19.m2.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.3"><plus id="alg1.l19.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.3.1"></plus><ci id="alg1.l19.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="alg1.l19.m2.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l19.m2.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.2.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="alg1.l19.m2.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.2"><ci id="alg1.l19.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="alg1.l19.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.2.2">𝑧</ci></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.3"><plus id="alg1.l19.m2.1.1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.3.1"></plus><ci id="alg1.l19.m2.1.1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="alg1.l19.m2.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="alg1.l19.m2.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.3.3.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l19.m2.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.2">𝑎</ci><apply id="alg1.l19.m2.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.3"><plus id="alg1.l19.m2.1.1.1.1.1.1.3.3.3.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.3.1"></plus><ci id="alg1.l19.m2.1.1.1.1.1.1.3.3.3.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.3.2">𝑖</ci><cn id="alg1.l19.m2.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="alg1.l19.m2.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.4.4.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.1.1.1.4.4.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.4.4">subscript</csymbol><apply id="alg1.l19.m2.1.1.1.1.1.1.4.4.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.2"><ci id="alg1.l19.m2.1.1.1.1.1.1.4.4.2.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.2.1">^</ci><ci id="alg1.l19.m2.1.1.1.1.1.1.4.4.2.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.2.2">𝑟</ci></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.4.4.3.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.3"><plus id="alg1.l19.m2.1.1.1.1.1.1.4.4.3.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.3.1"></plus><ci id="alg1.l19.m2.1.1.1.1.1.1.4.4.3.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.3.2">𝑖</ci><cn id="alg1.l19.m2.1.1.1.1.1.1.4.4.3.3.cmml" type="integer" xref="alg1.l19.m2.1.1.1.1.1.1.4.4.3.3">1</cn></apply></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.5.5.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.5.5"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.1.1.1.5.5.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.5.5">subscript</csymbol><apply id="alg1.l19.m2.1.1.1.1.1.1.5.5.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.2"><ci id="alg1.l19.m2.1.1.1.1.1.1.5.5.2.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.2.1">^</ci><ci id="alg1.l19.m2.1.1.1.1.1.1.5.5.2.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.2.2">𝑐</ci></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.5.5.3.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.3"><plus id="alg1.l19.m2.1.1.1.1.1.1.5.5.3.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.3.1"></plus><ci id="alg1.l19.m2.1.1.1.1.1.1.5.5.3.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.3.2">𝑖</ci><cn id="alg1.l19.m2.1.1.1.1.1.1.5.5.3.3.cmml" type="integer" xref="alg1.l19.m2.1.1.1.1.1.1.5.5.3.3">1</cn></apply></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.6.6.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.6.6"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.1.1.1.6.6.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.6.6">subscript</csymbol><apply id="alg1.l19.m2.1.1.1.1.1.1.6.6.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.2"><ci id="alg1.l19.m2.1.1.1.1.1.1.6.6.2.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.2.1">^</ci><ci id="alg1.l19.m2.1.1.1.1.1.1.6.6.2.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.2.2">𝑗</ci></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.6.6.3.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.3"><plus id="alg1.l19.m2.1.1.1.1.1.1.6.6.3.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.3.1"></plus><ci id="alg1.l19.m2.1.1.1.1.1.1.6.6.3.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.3.2">𝑖</ci><cn id="alg1.l19.m2.1.1.1.1.1.1.6.6.3.3.cmml" type="integer" xref="alg1.l19.m2.1.1.1.1.1.1.6.6.3.3">1</cn></apply></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.7.7.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.7.7"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.1.1.1.7.7.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.7.7">subscript</csymbol><apply id="alg1.l19.m2.1.1.1.1.1.1.7.7.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.2"><ci id="alg1.l19.m2.1.1.1.1.1.1.7.7.2.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.2.1">^</ci><ci id="alg1.l19.m2.1.1.1.1.1.1.7.7.2.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.2.2">Δ</ci></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.7.7.3.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.3"><plus id="alg1.l19.m2.1.1.1.1.1.1.7.7.3.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.3.1"></plus><ci id="alg1.l19.m2.1.1.1.1.1.1.7.7.3.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.3.2">𝑖</ci><cn id="alg1.l19.m2.1.1.1.1.1.1.7.7.3.3.cmml" type="integer" xref="alg1.l19.m2.1.1.1.1.1.1.7.7.3.3">1</cn></apply></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.8.8.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.8.8"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.1.1.1.8.8.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.8.8">subscript</csymbol><apply id="alg1.l19.m2.1.1.1.1.1.1.8.8.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.2"><ci id="alg1.l19.m2.1.1.1.1.1.1.8.8.2.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.2.1">^</ci><ci id="alg1.l19.m2.1.1.1.1.1.1.8.8.2.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.2.2">𝐺</ci></apply><apply id="alg1.l19.m2.1.1.1.1.1.1.8.8.3.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.3"><plus id="alg1.l19.m2.1.1.1.1.1.1.8.8.3.1.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.3.1"></plus><ci id="alg1.l19.m2.1.1.1.1.1.1.8.8.3.2.cmml" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.3.2">𝑖</ci><cn id="alg1.l19.m2.1.1.1.1.1.1.8.8.3.3.cmml" type="integer" xref="alg1.l19.m2.1.1.1.1.1.1.8.8.3.3">1</cn></apply></apply></vector></set><apply id="alg1.l19.m2.1.1.1.3.cmml" xref="alg1.l19.m2.1.1.1.3"><eq id="alg1.l19.m2.1.1.1.3.1.cmml" xref="alg1.l19.m2.1.1.1.3.1"></eq><ci id="alg1.l19.m2.1.1.1.3.2.cmml" xref="alg1.l19.m2.1.1.1.3.2">𝑖</ci><ci id="alg1.l19.m2.1.1.1.3.3.cmml" xref="alg1.l19.m2.1.1.1.3.3">𝑡</ci></apply></apply><apply id="alg1.l19.m2.1.1.3.cmml" xref="alg1.l19.m2.1.1.3"><plus id="alg1.l19.m2.1.1.3.1.cmml" xref="alg1.l19.m2.1.1.3.1"></plus><ci id="alg1.l19.m2.1.1.3.2.cmml" xref="alg1.l19.m2.1.1.3.2">𝑡</ci><ci id="alg1.l19.m2.1.1.3.3.cmml" xref="alg1.l19.m2.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">\{(h_{i+1},\hat{z}_{i+1},a_{i+1},\hat{r}_{i+1},\hat{c}_{i+1},\hat{j}_{i+1},%
\hat{\Delta}_{i+1},\hat{G}_{i+1})\}_{i=t}^{t+L}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m2.1d">{ ( italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG roman_Δ end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_G end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t + italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span>     Optimize critic <math alttext="v_{\psi}" class="ltx_Math" display="inline" id="alg1.l20.m1.1"><semantics id="alg1.l20.m1.1a"><msub id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><mi id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml">v</mi><mi id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1">subscript</csymbol><ci id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2">𝑣</ci><ci id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">v_{\psi}</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.1d">italic_v start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> using Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#S3.E10" title="In 3.4 Behavior Learning over Mixed Long Short-Term Imaginations ‣ 3 Method ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">10</span></a>) over <math alttext="\{(h_{i+1},\hat{z}_{i+1},a_{i+1},\hat{r}_{i+1},\hat{c}_{i+1},\hat{j}_{i+1},%
\hat{\Delta}_{i+1},\hat{G}_{i+1})\}_{i=t}^{t+L}" class="ltx_Math" display="inline" id="alg1.l20.m2.1"><semantics id="alg1.l20.m2.1a"><msubsup id="alg1.l20.m2.1.1" xref="alg1.l20.m2.1.1.cmml"><mrow id="alg1.l20.m2.1.1.1.1.1" xref="alg1.l20.m2.1.1.1.1.2.cmml"><mo id="alg1.l20.m2.1.1.1.1.1.2" stretchy="false" xref="alg1.l20.m2.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l20.m2.1.1.1.1.1.1.8" xref="alg1.l20.m2.1.1.1.1.1.1.9.cmml"><mo id="alg1.l20.m2.1.1.1.1.1.1.8.9" stretchy="false" xref="alg1.l20.m2.1.1.1.1.1.1.9.cmml">(</mo><msub id="alg1.l20.m2.1.1.1.1.1.1.1.1" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.1.1.2" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.2.cmml">h</mi><mrow id="alg1.l20.m2.1.1.1.1.1.1.1.1.3" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.1.1.3.2" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.1.1.3.1" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l20.m2.1.1.1.1.1.1.1.1.3.3" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l20.m2.1.1.1.1.1.1.8.10" xref="alg1.l20.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l20.m2.1.1.1.1.1.1.2.2" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="alg1.l20.m2.1.1.1.1.1.1.2.2.2" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.2.2.2.2" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.2.2.cmml">z</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.2.2.2.1" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l20.m2.1.1.1.1.1.1.2.2.3" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.2.2.3.2" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.2.2.3.1" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.3.1.cmml">+</mo><mn id="alg1.l20.m2.1.1.1.1.1.1.2.2.3.3" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l20.m2.1.1.1.1.1.1.8.11" xref="alg1.l20.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l20.m2.1.1.1.1.1.1.3.3" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.3.3.2" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.2.cmml">a</mi><mrow id="alg1.l20.m2.1.1.1.1.1.1.3.3.3" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.3.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.3.3.3.2" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.3.2.cmml">i</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.3.3.3.1" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mn id="alg1.l20.m2.1.1.1.1.1.1.3.3.3.3" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l20.m2.1.1.1.1.1.1.8.12" xref="alg1.l20.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l20.m2.1.1.1.1.1.1.4.4" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.cmml"><mover accent="true" id="alg1.l20.m2.1.1.1.1.1.1.4.4.2" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.2.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.4.4.2.2" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.2.2.cmml">r</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.4.4.2.1" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.2.1.cmml">^</mo></mover><mrow id="alg1.l20.m2.1.1.1.1.1.1.4.4.3" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.3.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.4.4.3.2" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.3.2.cmml">i</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.4.4.3.1" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.3.1.cmml">+</mo><mn id="alg1.l20.m2.1.1.1.1.1.1.4.4.3.3" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l20.m2.1.1.1.1.1.1.8.13" xref="alg1.l20.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l20.m2.1.1.1.1.1.1.5.5" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.cmml"><mover accent="true" id="alg1.l20.m2.1.1.1.1.1.1.5.5.2" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.2.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.5.5.2.2" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.2.2.cmml">c</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.5.5.2.1" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.2.1.cmml">^</mo></mover><mrow id="alg1.l20.m2.1.1.1.1.1.1.5.5.3" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.3.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.5.5.3.2" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.3.2.cmml">i</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.5.5.3.1" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.3.1.cmml">+</mo><mn id="alg1.l20.m2.1.1.1.1.1.1.5.5.3.3" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l20.m2.1.1.1.1.1.1.8.14" xref="alg1.l20.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l20.m2.1.1.1.1.1.1.6.6" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.cmml"><mover accent="true" id="alg1.l20.m2.1.1.1.1.1.1.6.6.2" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.2.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.6.6.2.2" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.2.2.cmml">j</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.6.6.2.1" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.2.1.cmml">^</mo></mover><mrow id="alg1.l20.m2.1.1.1.1.1.1.6.6.3" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.3.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.6.6.3.2" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.3.2.cmml">i</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.6.6.3.1" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.3.1.cmml">+</mo><mn id="alg1.l20.m2.1.1.1.1.1.1.6.6.3.3" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l20.m2.1.1.1.1.1.1.8.15" xref="alg1.l20.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l20.m2.1.1.1.1.1.1.7.7" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.cmml"><mover accent="true" id="alg1.l20.m2.1.1.1.1.1.1.7.7.2" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.2.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.7.7.2.2" mathvariant="normal" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.2.2.cmml">Δ</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.7.7.2.1" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.2.1.cmml">^</mo></mover><mrow id="alg1.l20.m2.1.1.1.1.1.1.7.7.3" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.3.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.7.7.3.2" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.3.2.cmml">i</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.7.7.3.1" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.3.1.cmml">+</mo><mn id="alg1.l20.m2.1.1.1.1.1.1.7.7.3.3" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l20.m2.1.1.1.1.1.1.8.16" xref="alg1.l20.m2.1.1.1.1.1.1.9.cmml">,</mo><msub id="alg1.l20.m2.1.1.1.1.1.1.8.8" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.cmml"><mover accent="true" id="alg1.l20.m2.1.1.1.1.1.1.8.8.2" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.2.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.8.8.2.2" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.2.2.cmml">G</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.8.8.2.1" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.2.1.cmml">^</mo></mover><mrow id="alg1.l20.m2.1.1.1.1.1.1.8.8.3" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.3.cmml"><mi id="alg1.l20.m2.1.1.1.1.1.1.8.8.3.2" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.3.2.cmml">i</mi><mo id="alg1.l20.m2.1.1.1.1.1.1.8.8.3.1" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.3.1.cmml">+</mo><mn id="alg1.l20.m2.1.1.1.1.1.1.8.8.3.3" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l20.m2.1.1.1.1.1.1.8.17" stretchy="false" xref="alg1.l20.m2.1.1.1.1.1.1.9.cmml">)</mo></mrow><mo id="alg1.l20.m2.1.1.1.1.1.3" stretchy="false" xref="alg1.l20.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l20.m2.1.1.1.3" xref="alg1.l20.m2.1.1.1.3.cmml"><mi id="alg1.l20.m2.1.1.1.3.2" xref="alg1.l20.m2.1.1.1.3.2.cmml">i</mi><mo id="alg1.l20.m2.1.1.1.3.1" xref="alg1.l20.m2.1.1.1.3.1.cmml">=</mo><mi id="alg1.l20.m2.1.1.1.3.3" xref="alg1.l20.m2.1.1.1.3.3.cmml">t</mi></mrow><mrow id="alg1.l20.m2.1.1.3" xref="alg1.l20.m2.1.1.3.cmml"><mi id="alg1.l20.m2.1.1.3.2" xref="alg1.l20.m2.1.1.3.2.cmml">t</mi><mo id="alg1.l20.m2.1.1.3.1" xref="alg1.l20.m2.1.1.3.1.cmml">+</mo><mi id="alg1.l20.m2.1.1.3.3" xref="alg1.l20.m2.1.1.3.3.cmml">L</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l20.m2.1b"><apply id="alg1.l20.m2.1.1.cmml" xref="alg1.l20.m2.1.1"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.2.cmml" xref="alg1.l20.m2.1.1">superscript</csymbol><apply id="alg1.l20.m2.1.1.1.cmml" xref="alg1.l20.m2.1.1"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.2.cmml" xref="alg1.l20.m2.1.1">subscript</csymbol><set id="alg1.l20.m2.1.1.1.1.2.cmml" xref="alg1.l20.m2.1.1.1.1.1"><vector id="alg1.l20.m2.1.1.1.1.1.1.9.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.8"><apply id="alg1.l20.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l20.m2.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.2">ℎ</ci><apply id="alg1.l20.m2.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.3"><plus id="alg1.l20.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.3.1"></plus><ci id="alg1.l20.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="alg1.l20.m2.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l20.m2.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.2.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="alg1.l20.m2.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.2"><ci id="alg1.l20.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="alg1.l20.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.2.2">𝑧</ci></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.3"><plus id="alg1.l20.m2.1.1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.3.1"></plus><ci id="alg1.l20.m2.1.1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="alg1.l20.m2.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="alg1.l20.m2.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.3.3.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l20.m2.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.2">𝑎</ci><apply id="alg1.l20.m2.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.3"><plus id="alg1.l20.m2.1.1.1.1.1.1.3.3.3.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.3.1"></plus><ci id="alg1.l20.m2.1.1.1.1.1.1.3.3.3.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.3.2">𝑖</ci><cn id="alg1.l20.m2.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="alg1.l20.m2.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.4.4.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.1.1.1.4.4.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.4.4">subscript</csymbol><apply id="alg1.l20.m2.1.1.1.1.1.1.4.4.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.2"><ci id="alg1.l20.m2.1.1.1.1.1.1.4.4.2.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.2.1">^</ci><ci id="alg1.l20.m2.1.1.1.1.1.1.4.4.2.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.2.2">𝑟</ci></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.4.4.3.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.3"><plus id="alg1.l20.m2.1.1.1.1.1.1.4.4.3.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.3.1"></plus><ci id="alg1.l20.m2.1.1.1.1.1.1.4.4.3.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.3.2">𝑖</ci><cn id="alg1.l20.m2.1.1.1.1.1.1.4.4.3.3.cmml" type="integer" xref="alg1.l20.m2.1.1.1.1.1.1.4.4.3.3">1</cn></apply></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.5.5.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.5.5"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.1.1.1.5.5.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.5.5">subscript</csymbol><apply id="alg1.l20.m2.1.1.1.1.1.1.5.5.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.2"><ci id="alg1.l20.m2.1.1.1.1.1.1.5.5.2.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.2.1">^</ci><ci id="alg1.l20.m2.1.1.1.1.1.1.5.5.2.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.2.2">𝑐</ci></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.5.5.3.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.3"><plus id="alg1.l20.m2.1.1.1.1.1.1.5.5.3.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.3.1"></plus><ci id="alg1.l20.m2.1.1.1.1.1.1.5.5.3.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.3.2">𝑖</ci><cn id="alg1.l20.m2.1.1.1.1.1.1.5.5.3.3.cmml" type="integer" xref="alg1.l20.m2.1.1.1.1.1.1.5.5.3.3">1</cn></apply></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.6.6.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.6.6"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.1.1.1.6.6.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.6.6">subscript</csymbol><apply id="alg1.l20.m2.1.1.1.1.1.1.6.6.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.2"><ci id="alg1.l20.m2.1.1.1.1.1.1.6.6.2.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.2.1">^</ci><ci id="alg1.l20.m2.1.1.1.1.1.1.6.6.2.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.2.2">𝑗</ci></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.6.6.3.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.3"><plus id="alg1.l20.m2.1.1.1.1.1.1.6.6.3.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.3.1"></plus><ci id="alg1.l20.m2.1.1.1.1.1.1.6.6.3.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.3.2">𝑖</ci><cn id="alg1.l20.m2.1.1.1.1.1.1.6.6.3.3.cmml" type="integer" xref="alg1.l20.m2.1.1.1.1.1.1.6.6.3.3">1</cn></apply></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.7.7.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.7.7"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.1.1.1.7.7.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.7.7">subscript</csymbol><apply id="alg1.l20.m2.1.1.1.1.1.1.7.7.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.2"><ci id="alg1.l20.m2.1.1.1.1.1.1.7.7.2.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.2.1">^</ci><ci id="alg1.l20.m2.1.1.1.1.1.1.7.7.2.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.2.2">Δ</ci></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.7.7.3.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.3"><plus id="alg1.l20.m2.1.1.1.1.1.1.7.7.3.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.3.1"></plus><ci id="alg1.l20.m2.1.1.1.1.1.1.7.7.3.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.3.2">𝑖</ci><cn id="alg1.l20.m2.1.1.1.1.1.1.7.7.3.3.cmml" type="integer" xref="alg1.l20.m2.1.1.1.1.1.1.7.7.3.3">1</cn></apply></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.8.8.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.8.8"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.1.1.1.8.8.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.8.8">subscript</csymbol><apply id="alg1.l20.m2.1.1.1.1.1.1.8.8.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.2"><ci id="alg1.l20.m2.1.1.1.1.1.1.8.8.2.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.2.1">^</ci><ci id="alg1.l20.m2.1.1.1.1.1.1.8.8.2.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.2.2">𝐺</ci></apply><apply id="alg1.l20.m2.1.1.1.1.1.1.8.8.3.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.3"><plus id="alg1.l20.m2.1.1.1.1.1.1.8.8.3.1.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.3.1"></plus><ci id="alg1.l20.m2.1.1.1.1.1.1.8.8.3.2.cmml" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.3.2">𝑖</ci><cn id="alg1.l20.m2.1.1.1.1.1.1.8.8.3.3.cmml" type="integer" xref="alg1.l20.m2.1.1.1.1.1.1.8.8.3.3">1</cn></apply></apply></vector></set><apply id="alg1.l20.m2.1.1.1.3.cmml" xref="alg1.l20.m2.1.1.1.3"><eq id="alg1.l20.m2.1.1.1.3.1.cmml" xref="alg1.l20.m2.1.1.1.3.1"></eq><ci id="alg1.l20.m2.1.1.1.3.2.cmml" xref="alg1.l20.m2.1.1.1.3.2">𝑖</ci><ci id="alg1.l20.m2.1.1.1.3.3.cmml" xref="alg1.l20.m2.1.1.1.3.3">𝑡</ci></apply></apply><apply id="alg1.l20.m2.1.1.3.cmml" xref="alg1.l20.m2.1.1.3"><plus id="alg1.l20.m2.1.1.3.1.cmml" xref="alg1.l20.m2.1.1.3.1"></plus><ci id="alg1.l20.m2.1.1.3.2.cmml" xref="alg1.l20.m2.1.1.3.2">𝑡</ci><ci id="alg1.l20.m2.1.1.3.3.cmml" xref="alg1.l20.m2.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m2.1c">\{(h_{i+1},\hat{z}_{i+1},a_{i+1},\hat{r}_{i+1},\hat{c}_{i+1},\hat{j}_{i+1},%
\hat{\Delta}_{i+1},\hat{G}_{i+1})\}_{i=t}^{t+L}</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m2.1d">{ ( italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_j end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG roman_Δ end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over^ start_ARG italic_G end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t + italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline">21:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l21.2">for</span> time step <math alttext="t=1\cdots T" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">t</mi><mo id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">=</mo><mrow id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"><mn id="alg1.l21.m1.1.1.3.2" xref="alg1.l21.m1.1.1.3.2.cmml">1</mn><mo id="alg1.l21.m1.1.1.3.1" xref="alg1.l21.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.1.3.3" mathvariant="normal" xref="alg1.l21.m1.1.1.3.3.cmml">⋯</mi><mo id="alg1.l21.m1.1.1.3.1a" xref="alg1.l21.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.1.3.4" xref="alg1.l21.m1.1.1.3.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><eq id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1"></eq><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">𝑡</ci><apply id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3"><times id="alg1.l21.m1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.3.1"></times><cn id="alg1.l21.m1.1.1.3.2.cmml" type="integer" xref="alg1.l21.m1.1.1.3.2">1</cn><ci id="alg1.l21.m1.1.1.3.3.cmml" xref="alg1.l21.m1.1.1.3.3">⋯</ci><ci id="alg1.l21.m1.1.1.3.4.cmml" xref="alg1.l21.m1.1.1.3.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">t=1\cdots T</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">italic_t = 1 ⋯ italic_T</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l21.3">do</span> <span class="ltx_text" id="alg1.l21.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l21.1.m1.1"><semantics id="alg1.l21.1.m1.1a"><mo id="alg1.l21.1.m1.1.1" xref="alg1.l21.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l21.1.m1.1b"><ci id="alg1.l21.1.m1.1.1.cmml" xref="alg1.l21.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.1.m1.1d">▷</annotation></semantics></math> Environment interaction
</span>
</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline">22:</span>         Sample <math alttext="a_{t}\sim v_{\psi}\left(R_{t}\mid h_{t},\hat{z}_{t}\right)" class="ltx_Math" display="inline" id="alg1.l22.m1.1"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><msub id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml"><mi id="alg1.l22.m1.1.1.3.2" xref="alg1.l22.m1.1.1.3.2.cmml">a</mi><mi id="alg1.l22.m1.1.1.3.3" xref="alg1.l22.m1.1.1.3.3.cmml">t</mi></msub><mo id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l22.m1.1.1.1" xref="alg1.l22.m1.1.1.1.cmml"><msub id="alg1.l22.m1.1.1.1.3" xref="alg1.l22.m1.1.1.1.3.cmml"><mi id="alg1.l22.m1.1.1.1.3.2" xref="alg1.l22.m1.1.1.1.3.2.cmml">v</mi><mi id="alg1.l22.m1.1.1.1.3.3" xref="alg1.l22.m1.1.1.1.3.3.cmml">ψ</mi></msub><mo id="alg1.l22.m1.1.1.1.2" xref="alg1.l22.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l22.m1.1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l22.m1.1.1.1.1.1.2" xref="alg1.l22.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l22.m1.1.1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l22.m1.1.1.1.1.1.1.4" xref="alg1.l22.m1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l22.m1.1.1.1.1.1.1.4.2" xref="alg1.l22.m1.1.1.1.1.1.1.4.2.cmml">R</mi><mi id="alg1.l22.m1.1.1.1.1.1.1.4.3" xref="alg1.l22.m1.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="alg1.l22.m1.1.1.1.1.1.1.3" xref="alg1.l22.m1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="alg1.l22.m1.1.1.1.1.1.1.2.2" xref="alg1.l22.m1.1.1.1.1.1.1.2.3.cmml"><msub id="alg1.l22.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l22.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l22.m1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="alg1.l22.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l22.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l22.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l22.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l22.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2.2" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">z</mi><mo id="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2.1" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l22.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="alg1.l22.m1.1.1.1.1.1.3" xref="alg1.l22.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><csymbol cd="latexml" id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2">similar-to</csymbol><apply id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.3.1.cmml" xref="alg1.l22.m1.1.1.3">subscript</csymbol><ci id="alg1.l22.m1.1.1.3.2.cmml" xref="alg1.l22.m1.1.1.3.2">𝑎</ci><ci id="alg1.l22.m1.1.1.3.3.cmml" xref="alg1.l22.m1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1"><times id="alg1.l22.m1.1.1.1.2.cmml" xref="alg1.l22.m1.1.1.1.2"></times><apply id="alg1.l22.m1.1.1.1.3.cmml" xref="alg1.l22.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.3.1.cmml" xref="alg1.l22.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l22.m1.1.1.1.3.2.cmml" xref="alg1.l22.m1.1.1.1.3.2">𝑣</ci><ci id="alg1.l22.m1.1.1.1.3.3.cmml" xref="alg1.l22.m1.1.1.1.3.3">𝜓</ci></apply><apply id="alg1.l22.m1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l22.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="alg1.l22.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l22.m1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.4.2">𝑅</ci><ci id="alg1.l22.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="alg1.l22.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.2.2"><apply id="alg1.l22.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l22.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="alg1.l22.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l22.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2"><ci id="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2.2.2">𝑧</ci></apply><ci id="alg1.l22.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l22.m1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">a_{t}\sim v_{\psi}\left(R_{t}\mid h_{t},\hat{z}_{t}\right)</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_v start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline">23:</span>         <math alttext="r^{e}_{t},o_{t+1},c_{t}\leftarrow" class="ltx_Math" display="inline" id="alg1.l23.m1.3"><semantics id="alg1.l23.m1.3a"><mrow id="alg1.l23.m1.3.3" xref="alg1.l23.m1.3.3.cmml"><mrow id="alg1.l23.m1.3.3.3.3" xref="alg1.l23.m1.3.3.3.4.cmml"><msubsup id="alg1.l23.m1.1.1.1.1.1" xref="alg1.l23.m1.1.1.1.1.1.cmml"><mi id="alg1.l23.m1.1.1.1.1.1.2.2" xref="alg1.l23.m1.1.1.1.1.1.2.2.cmml">r</mi><mi id="alg1.l23.m1.1.1.1.1.1.3" xref="alg1.l23.m1.1.1.1.1.1.3.cmml">t</mi><mi id="alg1.l23.m1.1.1.1.1.1.2.3" xref="alg1.l23.m1.1.1.1.1.1.2.3.cmml">e</mi></msubsup><mo id="alg1.l23.m1.3.3.3.3.4" xref="alg1.l23.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l23.m1.2.2.2.2.2" xref="alg1.l23.m1.2.2.2.2.2.cmml"><mi id="alg1.l23.m1.2.2.2.2.2.2" xref="alg1.l23.m1.2.2.2.2.2.2.cmml">o</mi><mrow id="alg1.l23.m1.2.2.2.2.2.3" xref="alg1.l23.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l23.m1.2.2.2.2.2.3.2" xref="alg1.l23.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l23.m1.2.2.2.2.2.3.1" xref="alg1.l23.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l23.m1.2.2.2.2.2.3.3" xref="alg1.l23.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l23.m1.3.3.3.3.5" xref="alg1.l23.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l23.m1.3.3.3.3.3" xref="alg1.l23.m1.3.3.3.3.3.cmml"><mi id="alg1.l23.m1.3.3.3.3.3.2" xref="alg1.l23.m1.3.3.3.3.3.2.cmml">c</mi><mi id="alg1.l23.m1.3.3.3.3.3.3" xref="alg1.l23.m1.3.3.3.3.3.3.cmml">t</mi></msub></mrow><mo id="alg1.l23.m1.3.3.4" stretchy="false" xref="alg1.l23.m1.3.3.4.cmml">←</mo><mi id="alg1.l23.m1.3.3.5" xref="alg1.l23.m1.3.3.5.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.3b"><apply id="alg1.l23.m1.3.3.cmml" xref="alg1.l23.m1.3.3"><ci id="alg1.l23.m1.3.3.4.cmml" xref="alg1.l23.m1.3.3.4">←</ci><list id="alg1.l23.m1.3.3.3.4.cmml" xref="alg1.l23.m1.3.3.3.3"><apply id="alg1.l23.m1.1.1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l23.m1.1.1.1.1.1.2.cmml" xref="alg1.l23.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l23.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l23.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l23.m1.1.1.1.1.1.2.2">𝑟</ci><ci id="alg1.l23.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l23.m1.1.1.1.1.1.2.3">𝑒</ci></apply><ci id="alg1.l23.m1.1.1.1.1.1.3.cmml" xref="alg1.l23.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l23.m1.2.2.2.2.2.cmml" xref="alg1.l23.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.2.2.2.2.2.1.cmml" xref="alg1.l23.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l23.m1.2.2.2.2.2.2.cmml" xref="alg1.l23.m1.2.2.2.2.2.2">𝑜</ci><apply id="alg1.l23.m1.2.2.2.2.2.3.cmml" xref="alg1.l23.m1.2.2.2.2.2.3"><plus id="alg1.l23.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l23.m1.2.2.2.2.2.3.1"></plus><ci id="alg1.l23.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l23.m1.2.2.2.2.2.3.2">𝑡</ci><cn id="alg1.l23.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="alg1.l23.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="alg1.l23.m1.3.3.3.3.3.cmml" xref="alg1.l23.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l23.m1.3.3.3.3.3.1.cmml" xref="alg1.l23.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l23.m1.3.3.3.3.3.2.cmml" xref="alg1.l23.m1.3.3.3.3.3.2">𝑐</ci><ci id="alg1.l23.m1.3.3.3.3.3.3.cmml" xref="alg1.l23.m1.3.3.3.3.3.3">𝑡</ci></apply></list><csymbol cd="latexml" id="alg1.l23.m1.3.3.5.cmml" xref="alg1.l23.m1.3.3.5">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.3c">r^{e}_{t},o_{t+1},c_{t}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m1.3d">italic_r start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ←</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="alg1.l23.1">env.step</span>(<math alttext="a_{t}" class="ltx_Math" display="inline" id="alg1.l23.m2.1"><semantics id="alg1.l23.m2.1a"><msub id="alg1.l23.m2.1.1" xref="alg1.l23.m2.1.1.cmml"><mi id="alg1.l23.m2.1.1.2" xref="alg1.l23.m2.1.1.2.cmml">a</mi><mi id="alg1.l23.m2.1.1.3" xref="alg1.l23.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l23.m2.1b"><apply id="alg1.l23.m2.1.1.cmml" xref="alg1.l23.m2.1.1"><csymbol cd="ambiguous" id="alg1.l23.m2.1.1.1.cmml" xref="alg1.l23.m2.1.1">subscript</csymbol><ci id="alg1.l23.m2.1.1.2.cmml" xref="alg1.l23.m2.1.1.2">𝑎</ci><ci id="alg1.l23.m2.1.1.3.cmml" xref="alg1.l23.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m2.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m2.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline">24:</span>         Generate affordance map <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="alg1.l24.m1.1"><semantics id="alg1.l24.m1.1a"><msub id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l24.m1.1.1.2" xref="alg1.l24.m1.1.1.2.cmml">ℳ</mi><mi id="alg1.l24.m1.1.1.3" xref="alg1.l24.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><apply id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.1.cmml" xref="alg1.l24.m1.1.1">subscript</csymbol><ci id="alg1.l24.m1.1.1.2.cmml" xref="alg1.l24.m1.1.1.2">ℳ</ci><ci id="alg1.l24.m1.1.1.3.cmml" xref="alg1.l24.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> with multimodal U-Net for each <math alttext="o_{t}" class="ltx_Math" display="inline" id="alg1.l24.m2.1"><semantics id="alg1.l24.m2.1a"><msub id="alg1.l24.m2.1.1" xref="alg1.l24.m2.1.1.cmml"><mi id="alg1.l24.m2.1.1.2" xref="alg1.l24.m2.1.1.2.cmml">o</mi><mi id="alg1.l24.m2.1.1.3" xref="alg1.l24.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l24.m2.1b"><apply id="alg1.l24.m2.1.1.cmml" xref="alg1.l24.m2.1.1"><csymbol cd="ambiguous" id="alg1.l24.m2.1.1.1.cmml" xref="alg1.l24.m2.1.1">subscript</csymbol><ci id="alg1.l24.m2.1.1.2.cmml" xref="alg1.l24.m2.1.1.2">𝑜</ci><ci id="alg1.l24.m2.1.1.3.cmml" xref="alg1.l24.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m2.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m2.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline">25:</span>         Calculate intrinsic reward <math alttext="r^{i}_{t}" class="ltx_Math" display="inline" id="alg1.l25.m1.1"><semantics id="alg1.l25.m1.1a"><msubsup id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml"><mi id="alg1.l25.m1.1.1.2.2" xref="alg1.l25.m1.1.1.2.2.cmml">r</mi><mi id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3.cmml">t</mi><mi id="alg1.l25.m1.1.1.2.3" xref="alg1.l25.m1.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1">subscript</csymbol><apply id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.2.1.cmml" xref="alg1.l25.m1.1.1">superscript</csymbol><ci id="alg1.l25.m1.1.1.2.2.cmml" xref="alg1.l25.m1.1.1.2.2">𝑟</ci><ci id="alg1.l25.m1.1.1.2.3.cmml" xref="alg1.l25.m1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">r^{i}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.1d">italic_r start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and jump flag <math alttext="j_{t}" class="ltx_Math" display="inline" id="alg1.l25.m2.1"><semantics id="alg1.l25.m2.1a"><msub id="alg1.l25.m2.1.1" xref="alg1.l25.m2.1.1.cmml"><mi id="alg1.l25.m2.1.1.2" xref="alg1.l25.m2.1.1.2.cmml">j</mi><mi id="alg1.l25.m2.1.1.3" xref="alg1.l25.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l25.m2.1b"><apply id="alg1.l25.m2.1.1.cmml" xref="alg1.l25.m2.1.1"><csymbol cd="ambiguous" id="alg1.l25.m2.1.1.1.cmml" xref="alg1.l25.m2.1.1">subscript</csymbol><ci id="alg1.l25.m2.1.1.2.cmml" xref="alg1.l25.m2.1.1.2">𝑗</ci><ci id="alg1.l25.m2.1.1.3.cmml" xref="alg1.l25.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m2.1c">j_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m2.1d">italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> based on the affordance map.

</div>
<div class="ltx_listingline" id="alg1.l26">
<span class="ltx_tag ltx_tag_listingline">26:</span>         Collect short-term data <math alttext="(o_{t},a_{t},r_{t},c_{t},\mathcal{M}_{t},j_{t},\Delta_{t},G_{t})" class="ltx_Math" display="inline" id="alg1.l26.m1.8"><semantics id="alg1.l26.m1.8a"><mrow id="alg1.l26.m1.8.8.8" xref="alg1.l26.m1.8.8.9.cmml"><mo id="alg1.l26.m1.8.8.8.9" stretchy="false" xref="alg1.l26.m1.8.8.9.cmml">(</mo><msub id="alg1.l26.m1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.cmml"><mi id="alg1.l26.m1.1.1.1.1.2" xref="alg1.l26.m1.1.1.1.1.2.cmml">o</mi><mi id="alg1.l26.m1.1.1.1.1.3" xref="alg1.l26.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l26.m1.8.8.8.10" xref="alg1.l26.m1.8.8.9.cmml">,</mo><msub id="alg1.l26.m1.2.2.2.2" xref="alg1.l26.m1.2.2.2.2.cmml"><mi id="alg1.l26.m1.2.2.2.2.2" xref="alg1.l26.m1.2.2.2.2.2.cmml">a</mi><mi id="alg1.l26.m1.2.2.2.2.3" xref="alg1.l26.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l26.m1.8.8.8.11" xref="alg1.l26.m1.8.8.9.cmml">,</mo><msub id="alg1.l26.m1.3.3.3.3" xref="alg1.l26.m1.3.3.3.3.cmml"><mi id="alg1.l26.m1.3.3.3.3.2" xref="alg1.l26.m1.3.3.3.3.2.cmml">r</mi><mi id="alg1.l26.m1.3.3.3.3.3" xref="alg1.l26.m1.3.3.3.3.3.cmml">t</mi></msub><mo id="alg1.l26.m1.8.8.8.12" xref="alg1.l26.m1.8.8.9.cmml">,</mo><msub id="alg1.l26.m1.4.4.4.4" xref="alg1.l26.m1.4.4.4.4.cmml"><mi id="alg1.l26.m1.4.4.4.4.2" xref="alg1.l26.m1.4.4.4.4.2.cmml">c</mi><mi id="alg1.l26.m1.4.4.4.4.3" xref="alg1.l26.m1.4.4.4.4.3.cmml">t</mi></msub><mo id="alg1.l26.m1.8.8.8.13" xref="alg1.l26.m1.8.8.9.cmml">,</mo><msub id="alg1.l26.m1.5.5.5.5" xref="alg1.l26.m1.5.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l26.m1.5.5.5.5.2" xref="alg1.l26.m1.5.5.5.5.2.cmml">ℳ</mi><mi id="alg1.l26.m1.5.5.5.5.3" xref="alg1.l26.m1.5.5.5.5.3.cmml">t</mi></msub><mo id="alg1.l26.m1.8.8.8.14" xref="alg1.l26.m1.8.8.9.cmml">,</mo><msub id="alg1.l26.m1.6.6.6.6" xref="alg1.l26.m1.6.6.6.6.cmml"><mi id="alg1.l26.m1.6.6.6.6.2" xref="alg1.l26.m1.6.6.6.6.2.cmml">j</mi><mi id="alg1.l26.m1.6.6.6.6.3" xref="alg1.l26.m1.6.6.6.6.3.cmml">t</mi></msub><mo id="alg1.l26.m1.8.8.8.15" xref="alg1.l26.m1.8.8.9.cmml">,</mo><msub id="alg1.l26.m1.7.7.7.7" xref="alg1.l26.m1.7.7.7.7.cmml"><mi id="alg1.l26.m1.7.7.7.7.2" mathvariant="normal" xref="alg1.l26.m1.7.7.7.7.2.cmml">Δ</mi><mi id="alg1.l26.m1.7.7.7.7.3" xref="alg1.l26.m1.7.7.7.7.3.cmml">t</mi></msub><mo id="alg1.l26.m1.8.8.8.16" xref="alg1.l26.m1.8.8.9.cmml">,</mo><msub id="alg1.l26.m1.8.8.8.8" xref="alg1.l26.m1.8.8.8.8.cmml"><mi id="alg1.l26.m1.8.8.8.8.2" xref="alg1.l26.m1.8.8.8.8.2.cmml">G</mi><mi id="alg1.l26.m1.8.8.8.8.3" xref="alg1.l26.m1.8.8.8.8.3.cmml">t</mi></msub><mo id="alg1.l26.m1.8.8.8.17" stretchy="false" xref="alg1.l26.m1.8.8.9.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.8b"><vector id="alg1.l26.m1.8.8.9.cmml" xref="alg1.l26.m1.8.8.8"><apply id="alg1.l26.m1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l26.m1.1.1.1.1.2.cmml" xref="alg1.l26.m1.1.1.1.1.2">𝑜</ci><ci id="alg1.l26.m1.1.1.1.1.3.cmml" xref="alg1.l26.m1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l26.m1.2.2.2.2.cmml" xref="alg1.l26.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l26.m1.2.2.2.2.1.cmml" xref="alg1.l26.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l26.m1.2.2.2.2.2.cmml" xref="alg1.l26.m1.2.2.2.2.2">𝑎</ci><ci id="alg1.l26.m1.2.2.2.2.3.cmml" xref="alg1.l26.m1.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l26.m1.3.3.3.3.cmml" xref="alg1.l26.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l26.m1.3.3.3.3.1.cmml" xref="alg1.l26.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l26.m1.3.3.3.3.2.cmml" xref="alg1.l26.m1.3.3.3.3.2">𝑟</ci><ci id="alg1.l26.m1.3.3.3.3.3.cmml" xref="alg1.l26.m1.3.3.3.3.3">𝑡</ci></apply><apply id="alg1.l26.m1.4.4.4.4.cmml" xref="alg1.l26.m1.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l26.m1.4.4.4.4.1.cmml" xref="alg1.l26.m1.4.4.4.4">subscript</csymbol><ci id="alg1.l26.m1.4.4.4.4.2.cmml" xref="alg1.l26.m1.4.4.4.4.2">𝑐</ci><ci id="alg1.l26.m1.4.4.4.4.3.cmml" xref="alg1.l26.m1.4.4.4.4.3">𝑡</ci></apply><apply id="alg1.l26.m1.5.5.5.5.cmml" xref="alg1.l26.m1.5.5.5.5"><csymbol cd="ambiguous" id="alg1.l26.m1.5.5.5.5.1.cmml" xref="alg1.l26.m1.5.5.5.5">subscript</csymbol><ci id="alg1.l26.m1.5.5.5.5.2.cmml" xref="alg1.l26.m1.5.5.5.5.2">ℳ</ci><ci id="alg1.l26.m1.5.5.5.5.3.cmml" xref="alg1.l26.m1.5.5.5.5.3">𝑡</ci></apply><apply id="alg1.l26.m1.6.6.6.6.cmml" xref="alg1.l26.m1.6.6.6.6"><csymbol cd="ambiguous" id="alg1.l26.m1.6.6.6.6.1.cmml" xref="alg1.l26.m1.6.6.6.6">subscript</csymbol><ci id="alg1.l26.m1.6.6.6.6.2.cmml" xref="alg1.l26.m1.6.6.6.6.2">𝑗</ci><ci id="alg1.l26.m1.6.6.6.6.3.cmml" xref="alg1.l26.m1.6.6.6.6.3">𝑡</ci></apply><apply id="alg1.l26.m1.7.7.7.7.cmml" xref="alg1.l26.m1.7.7.7.7"><csymbol cd="ambiguous" id="alg1.l26.m1.7.7.7.7.1.cmml" xref="alg1.l26.m1.7.7.7.7">subscript</csymbol><ci id="alg1.l26.m1.7.7.7.7.2.cmml" xref="alg1.l26.m1.7.7.7.7.2">Δ</ci><ci id="alg1.l26.m1.7.7.7.7.3.cmml" xref="alg1.l26.m1.7.7.7.7.3">𝑡</ci></apply><apply id="alg1.l26.m1.8.8.8.8.cmml" xref="alg1.l26.m1.8.8.8.8"><csymbol cd="ambiguous" id="alg1.l26.m1.8.8.8.8.1.cmml" xref="alg1.l26.m1.8.8.8.8">subscript</csymbol><ci id="alg1.l26.m1.8.8.8.8.2.cmml" xref="alg1.l26.m1.8.8.8.8.2">𝐺</ci><ci id="alg1.l26.m1.8.8.8.8.3.cmml" xref="alg1.l26.m1.8.8.8.8.3">𝑡</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.8c">(o_{t},a_{t},r_{t},c_{t},\mathcal{M}_{t},j_{t},\Delta_{t},G_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.m1.8d">( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l27">
<span class="ltx_tag ltx_tag_listingline">27:</span>         <span class="ltx_text ltx_font_bold" id="alg1.l27.1">if</span> jumpy flag <math alttext="j_{t}" class="ltx_Math" display="inline" id="alg1.l27.m1.1"><semantics id="alg1.l27.m1.1a"><msub id="alg1.l27.m1.1.1" xref="alg1.l27.m1.1.1.cmml"><mi id="alg1.l27.m1.1.1.2" xref="alg1.l27.m1.1.1.2.cmml">j</mi><mi id="alg1.l27.m1.1.1.3" xref="alg1.l27.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l27.m1.1b"><apply id="alg1.l27.m1.1.1.cmml" xref="alg1.l27.m1.1.1"><csymbol cd="ambiguous" id="alg1.l27.m1.1.1.1.cmml" xref="alg1.l27.m1.1.1">subscript</csymbol><ci id="alg1.l27.m1.1.1.2.cmml" xref="alg1.l27.m1.1.1.2">𝑗</ci><ci id="alg1.l27.m1.1.1.3.cmml" xref="alg1.l27.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m1.1c">j_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l27.m1.1d">italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l27.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l28">
<span class="ltx_tag ltx_tag_listingline">28:</span>              Collect long-term data <math alttext="(o_{t}^{\prime},a_{t}^{\prime},{{r}_{t}}^{\prime},c_{t}^{\prime},\mathcal{M}^{%
\prime}_{t},j_{t}^{\prime},\Delta_{t}^{\prime},G_{t}^{\prime})" class="ltx_Math" display="inline" id="alg1.l28.m1.8"><semantics id="alg1.l28.m1.8a"><mrow id="alg1.l28.m1.8.8.8" xref="alg1.l28.m1.8.8.9.cmml"><mo id="alg1.l28.m1.8.8.8.9" stretchy="false" xref="alg1.l28.m1.8.8.9.cmml">(</mo><msubsup id="alg1.l28.m1.1.1.1.1" xref="alg1.l28.m1.1.1.1.1.cmml"><mi id="alg1.l28.m1.1.1.1.1.2.2" xref="alg1.l28.m1.1.1.1.1.2.2.cmml">o</mi><mi id="alg1.l28.m1.1.1.1.1.2.3" xref="alg1.l28.m1.1.1.1.1.2.3.cmml">t</mi><mo id="alg1.l28.m1.1.1.1.1.3" xref="alg1.l28.m1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="alg1.l28.m1.8.8.8.10" xref="alg1.l28.m1.8.8.9.cmml">,</mo><msubsup id="alg1.l28.m1.2.2.2.2" xref="alg1.l28.m1.2.2.2.2.cmml"><mi id="alg1.l28.m1.2.2.2.2.2.2" xref="alg1.l28.m1.2.2.2.2.2.2.cmml">a</mi><mi id="alg1.l28.m1.2.2.2.2.2.3" xref="alg1.l28.m1.2.2.2.2.2.3.cmml">t</mi><mo id="alg1.l28.m1.2.2.2.2.3" xref="alg1.l28.m1.2.2.2.2.3.cmml">′</mo></msubsup><mo id="alg1.l28.m1.8.8.8.11" xref="alg1.l28.m1.8.8.9.cmml">,</mo><mmultiscripts id="alg1.l28.m1.3.3.3.3" xref="alg1.l28.m1.3.3.3.3.cmml"><mi id="alg1.l28.m1.3.3.3.3.2.2" xref="alg1.l28.m1.3.3.3.3.2.2.cmml">r</mi><mi id="alg1.l28.m1.3.3.3.3.2.3" xref="alg1.l28.m1.3.3.3.3.2.3.cmml">t</mi><mrow id="alg1.l28.m1.3.3.3.3a" xref="alg1.l28.m1.3.3.3.3.cmml"></mrow><mrow id="alg1.l28.m1.3.3.3.3b" xref="alg1.l28.m1.3.3.3.3.cmml"></mrow><mo id="alg1.l28.m1.3.3.3.3.3" xref="alg1.l28.m1.3.3.3.3.3.cmml">′</mo></mmultiscripts><mo id="alg1.l28.m1.8.8.8.12" xref="alg1.l28.m1.8.8.9.cmml">,</mo><msubsup id="alg1.l28.m1.4.4.4.4" xref="alg1.l28.m1.4.4.4.4.cmml"><mi id="alg1.l28.m1.4.4.4.4.2.2" xref="alg1.l28.m1.4.4.4.4.2.2.cmml">c</mi><mi id="alg1.l28.m1.4.4.4.4.2.3" xref="alg1.l28.m1.4.4.4.4.2.3.cmml">t</mi><mo id="alg1.l28.m1.4.4.4.4.3" xref="alg1.l28.m1.4.4.4.4.3.cmml">′</mo></msubsup><mo id="alg1.l28.m1.8.8.8.13" xref="alg1.l28.m1.8.8.9.cmml">,</mo><msubsup id="alg1.l28.m1.5.5.5.5" xref="alg1.l28.m1.5.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l28.m1.5.5.5.5.2.2" xref="alg1.l28.m1.5.5.5.5.2.2.cmml">ℳ</mi><mi id="alg1.l28.m1.5.5.5.5.3" xref="alg1.l28.m1.5.5.5.5.3.cmml">t</mi><mo id="alg1.l28.m1.5.5.5.5.2.3" xref="alg1.l28.m1.5.5.5.5.2.3.cmml">′</mo></msubsup><mo id="alg1.l28.m1.8.8.8.14" xref="alg1.l28.m1.8.8.9.cmml">,</mo><msubsup id="alg1.l28.m1.6.6.6.6" xref="alg1.l28.m1.6.6.6.6.cmml"><mi id="alg1.l28.m1.6.6.6.6.2.2" xref="alg1.l28.m1.6.6.6.6.2.2.cmml">j</mi><mi id="alg1.l28.m1.6.6.6.6.2.3" xref="alg1.l28.m1.6.6.6.6.2.3.cmml">t</mi><mo id="alg1.l28.m1.6.6.6.6.3" xref="alg1.l28.m1.6.6.6.6.3.cmml">′</mo></msubsup><mo id="alg1.l28.m1.8.8.8.15" xref="alg1.l28.m1.8.8.9.cmml">,</mo><msubsup id="alg1.l28.m1.7.7.7.7" xref="alg1.l28.m1.7.7.7.7.cmml"><mi id="alg1.l28.m1.7.7.7.7.2.2" mathvariant="normal" xref="alg1.l28.m1.7.7.7.7.2.2.cmml">Δ</mi><mi id="alg1.l28.m1.7.7.7.7.2.3" xref="alg1.l28.m1.7.7.7.7.2.3.cmml">t</mi><mo id="alg1.l28.m1.7.7.7.7.3" xref="alg1.l28.m1.7.7.7.7.3.cmml">′</mo></msubsup><mo id="alg1.l28.m1.8.8.8.16" xref="alg1.l28.m1.8.8.9.cmml">,</mo><msubsup id="alg1.l28.m1.8.8.8.8" xref="alg1.l28.m1.8.8.8.8.cmml"><mi id="alg1.l28.m1.8.8.8.8.2.2" xref="alg1.l28.m1.8.8.8.8.2.2.cmml">G</mi><mi id="alg1.l28.m1.8.8.8.8.2.3" xref="alg1.l28.m1.8.8.8.8.2.3.cmml">t</mi><mo id="alg1.l28.m1.8.8.8.8.3" xref="alg1.l28.m1.8.8.8.8.3.cmml">′</mo></msubsup><mo id="alg1.l28.m1.8.8.8.17" stretchy="false" xref="alg1.l28.m1.8.8.9.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.8b"><vector id="alg1.l28.m1.8.8.9.cmml" xref="alg1.l28.m1.8.8.8"><apply id="alg1.l28.m1.1.1.1.1.cmml" xref="alg1.l28.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l28.m1.1.1.1.1.1.cmml" xref="alg1.l28.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l28.m1.1.1.1.1.2.cmml" xref="alg1.l28.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l28.m1.1.1.1.1.2.1.cmml" xref="alg1.l28.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l28.m1.1.1.1.1.2.2.cmml" xref="alg1.l28.m1.1.1.1.1.2.2">𝑜</ci><ci id="alg1.l28.m1.1.1.1.1.2.3.cmml" xref="alg1.l28.m1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l28.m1.1.1.1.1.3.cmml" xref="alg1.l28.m1.1.1.1.1.3">′</ci></apply><apply id="alg1.l28.m1.2.2.2.2.cmml" xref="alg1.l28.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l28.m1.2.2.2.2.1.cmml" xref="alg1.l28.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l28.m1.2.2.2.2.2.cmml" xref="alg1.l28.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l28.m1.2.2.2.2.2.1.cmml" xref="alg1.l28.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l28.m1.2.2.2.2.2.2.cmml" xref="alg1.l28.m1.2.2.2.2.2.2">𝑎</ci><ci id="alg1.l28.m1.2.2.2.2.2.3.cmml" xref="alg1.l28.m1.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l28.m1.2.2.2.2.3.cmml" xref="alg1.l28.m1.2.2.2.2.3">′</ci></apply><apply id="alg1.l28.m1.3.3.3.3.cmml" xref="alg1.l28.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l28.m1.3.3.3.3.1.cmml" xref="alg1.l28.m1.3.3.3.3">superscript</csymbol><apply id="alg1.l28.m1.3.3.3.3.2.cmml" xref="alg1.l28.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l28.m1.3.3.3.3.2.1.cmml" xref="alg1.l28.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l28.m1.3.3.3.3.2.2.cmml" xref="alg1.l28.m1.3.3.3.3.2.2">𝑟</ci><ci id="alg1.l28.m1.3.3.3.3.2.3.cmml" xref="alg1.l28.m1.3.3.3.3.2.3">𝑡</ci></apply><ci id="alg1.l28.m1.3.3.3.3.3.cmml" xref="alg1.l28.m1.3.3.3.3.3">′</ci></apply><apply id="alg1.l28.m1.4.4.4.4.cmml" xref="alg1.l28.m1.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l28.m1.4.4.4.4.1.cmml" xref="alg1.l28.m1.4.4.4.4">superscript</csymbol><apply id="alg1.l28.m1.4.4.4.4.2.cmml" xref="alg1.l28.m1.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l28.m1.4.4.4.4.2.1.cmml" xref="alg1.l28.m1.4.4.4.4">subscript</csymbol><ci id="alg1.l28.m1.4.4.4.4.2.2.cmml" xref="alg1.l28.m1.4.4.4.4.2.2">𝑐</ci><ci id="alg1.l28.m1.4.4.4.4.2.3.cmml" xref="alg1.l28.m1.4.4.4.4.2.3">𝑡</ci></apply><ci id="alg1.l28.m1.4.4.4.4.3.cmml" xref="alg1.l28.m1.4.4.4.4.3">′</ci></apply><apply id="alg1.l28.m1.5.5.5.5.cmml" xref="alg1.l28.m1.5.5.5.5"><csymbol cd="ambiguous" id="alg1.l28.m1.5.5.5.5.1.cmml" xref="alg1.l28.m1.5.5.5.5">subscript</csymbol><apply id="alg1.l28.m1.5.5.5.5.2.cmml" xref="alg1.l28.m1.5.5.5.5"><csymbol cd="ambiguous" id="alg1.l28.m1.5.5.5.5.2.1.cmml" xref="alg1.l28.m1.5.5.5.5">superscript</csymbol><ci id="alg1.l28.m1.5.5.5.5.2.2.cmml" xref="alg1.l28.m1.5.5.5.5.2.2">ℳ</ci><ci id="alg1.l28.m1.5.5.5.5.2.3.cmml" xref="alg1.l28.m1.5.5.5.5.2.3">′</ci></apply><ci id="alg1.l28.m1.5.5.5.5.3.cmml" xref="alg1.l28.m1.5.5.5.5.3">𝑡</ci></apply><apply id="alg1.l28.m1.6.6.6.6.cmml" xref="alg1.l28.m1.6.6.6.6"><csymbol cd="ambiguous" id="alg1.l28.m1.6.6.6.6.1.cmml" xref="alg1.l28.m1.6.6.6.6">superscript</csymbol><apply id="alg1.l28.m1.6.6.6.6.2.cmml" xref="alg1.l28.m1.6.6.6.6"><csymbol cd="ambiguous" id="alg1.l28.m1.6.6.6.6.2.1.cmml" xref="alg1.l28.m1.6.6.6.6">subscript</csymbol><ci id="alg1.l28.m1.6.6.6.6.2.2.cmml" xref="alg1.l28.m1.6.6.6.6.2.2">𝑗</ci><ci id="alg1.l28.m1.6.6.6.6.2.3.cmml" xref="alg1.l28.m1.6.6.6.6.2.3">𝑡</ci></apply><ci id="alg1.l28.m1.6.6.6.6.3.cmml" xref="alg1.l28.m1.6.6.6.6.3">′</ci></apply><apply id="alg1.l28.m1.7.7.7.7.cmml" xref="alg1.l28.m1.7.7.7.7"><csymbol cd="ambiguous" id="alg1.l28.m1.7.7.7.7.1.cmml" xref="alg1.l28.m1.7.7.7.7">superscript</csymbol><apply id="alg1.l28.m1.7.7.7.7.2.cmml" xref="alg1.l28.m1.7.7.7.7"><csymbol cd="ambiguous" id="alg1.l28.m1.7.7.7.7.2.1.cmml" xref="alg1.l28.m1.7.7.7.7">subscript</csymbol><ci id="alg1.l28.m1.7.7.7.7.2.2.cmml" xref="alg1.l28.m1.7.7.7.7.2.2">Δ</ci><ci id="alg1.l28.m1.7.7.7.7.2.3.cmml" xref="alg1.l28.m1.7.7.7.7.2.3">𝑡</ci></apply><ci id="alg1.l28.m1.7.7.7.7.3.cmml" xref="alg1.l28.m1.7.7.7.7.3">′</ci></apply><apply id="alg1.l28.m1.8.8.8.8.cmml" xref="alg1.l28.m1.8.8.8.8"><csymbol cd="ambiguous" id="alg1.l28.m1.8.8.8.8.1.cmml" xref="alg1.l28.m1.8.8.8.8">superscript</csymbol><apply id="alg1.l28.m1.8.8.8.8.2.cmml" xref="alg1.l28.m1.8.8.8.8"><csymbol cd="ambiguous" id="alg1.l28.m1.8.8.8.8.2.1.cmml" xref="alg1.l28.m1.8.8.8.8">subscript</csymbol><ci id="alg1.l28.m1.8.8.8.8.2.2.cmml" xref="alg1.l28.m1.8.8.8.8.2.2">𝐺</ci><ci id="alg1.l28.m1.8.8.8.8.2.3.cmml" xref="alg1.l28.m1.8.8.8.8.2.3">𝑡</ci></apply><ci id="alg1.l28.m1.8.8.8.8.3.cmml" xref="alg1.l28.m1.8.8.8.8.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.8c">(o_{t}^{\prime},a_{t}^{\prime},{{r}_{t}}^{\prime},c_{t}^{\prime},\mathcal{M}^{%
\prime}_{t},j_{t}^{\prime},\Delta_{t}^{\prime},G_{t}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="alg1.l28.m1.8d">( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , caligraphic_M start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_G start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> based on affordance map.

</div>
<div class="ltx_listingline" id="alg1.l29">
<span class="ltx_tag ltx_tag_listingline">29:</span>         <span class="ltx_text ltx_font_bold" id="alg1.l29.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l29.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l30">
<span class="ltx_tag ltx_tag_listingline">30:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l30.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l30.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l31">
<span class="ltx_tag ltx_tag_listingline">31:</span>     Append long short-term transitions to <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l31.m1.1"><semantics id="alg1.l31.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l31.m1.1.1" xref="alg1.l31.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="alg1.l31.m1.1b"><ci id="alg1.l31.m1.1.1.cmml" xref="alg1.l31.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m1.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l31.m1.1d">caligraphic_B</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l32">
<span class="ltx_tag ltx_tag_listingline">32:</span><span class="ltx_text ltx_font_bold" id="alg1.l32.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l32.2">while</span>
</div>
</div>
</figure>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Hyperparameters</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">The hyperparameters of LS-Imagine are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03618v1#A5.T3" title="Table 3 ‣ Appendix E Hyperparameters ‣ Open-World Reinforcement Learning over Long Short-Term Imagination"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_table" id="A5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Hyperparameters of LS-Imagine.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A5.T3.28">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A5.T3.28.29.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A5.T3.28.29.1.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A5.T3.28.29.1.1.1">Name</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T3.28.29.1.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A5.T3.28.29.1.2.1">Notation</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T3.28.29.1.3" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A5.T3.28.29.1.3.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="A5.T3.28.30.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T3.28.30.2.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_typewriter" id="A5.T3.28.30.2.1.1">Affordance map generation</span></td>
<td class="ltx_td ltx_border_t" id="A5.T3.28.30.2.2" style="padding-left:11.4pt;padding-right:11.4pt;"></td>
<td class="ltx_td ltx_border_t" id="A5.T3.28.30.2.3" style="padding-left:11.4pt;padding-right:11.4pt;"></td>
</tr>
<tr class="ltx_tr" id="A5.T3.1.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T3.1.1.2" style="padding-left:11.4pt;padding-right:11.4pt;">Sliding window size</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T3.1.1.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T3.1.1.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="0.15\times 0.15" class="ltx_Math" display="inline" id="A5.T3.1.1.1.m1.1"><semantics id="A5.T3.1.1.1.m1.1a"><mrow id="A5.T3.1.1.1.m1.1.1" xref="A5.T3.1.1.1.m1.1.1.cmml"><mn id="A5.T3.1.1.1.m1.1.1.2" xref="A5.T3.1.1.1.m1.1.1.2.cmml">0.15</mn><mo id="A5.T3.1.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A5.T3.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A5.T3.1.1.1.m1.1.1.3" xref="A5.T3.1.1.1.m1.1.1.3.cmml">0.15</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.T3.1.1.1.m1.1b"><apply id="A5.T3.1.1.1.m1.1.1.cmml" xref="A5.T3.1.1.1.m1.1.1"><times id="A5.T3.1.1.1.m1.1.1.1.cmml" xref="A5.T3.1.1.1.m1.1.1.1"></times><cn id="A5.T3.1.1.1.m1.1.1.2.cmml" type="float" xref="A5.T3.1.1.1.m1.1.1.2">0.15</cn><cn id="A5.T3.1.1.1.m1.1.1.3.cmml" type="float" xref="A5.T3.1.1.1.m1.1.1.3">0.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.1.1.1.m1.1c">0.15\times 0.15</annotation><annotation encoding="application/x-llamapun" id="A5.T3.1.1.1.m1.1d">0.15 × 0.15</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.2.2">
<td class="ltx_td ltx_align_left" id="A5.T3.2.2.2" style="padding-left:11.4pt;padding-right:11.4pt;">Sliding steps</td>
<td class="ltx_td ltx_align_center" id="A5.T3.2.2.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.2.2.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="9\times 9" class="ltx_Math" display="inline" id="A5.T3.2.2.1.m1.1"><semantics id="A5.T3.2.2.1.m1.1a"><mrow id="A5.T3.2.2.1.m1.1.1" xref="A5.T3.2.2.1.m1.1.1.cmml"><mn id="A5.T3.2.2.1.m1.1.1.2" xref="A5.T3.2.2.1.m1.1.1.2.cmml">9</mn><mo id="A5.T3.2.2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A5.T3.2.2.1.m1.1.1.1.cmml">×</mo><mn id="A5.T3.2.2.1.m1.1.1.3" xref="A5.T3.2.2.1.m1.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.T3.2.2.1.m1.1b"><apply id="A5.T3.2.2.1.m1.1.1.cmml" xref="A5.T3.2.2.1.m1.1.1"><times id="A5.T3.2.2.1.m1.1.1.1.cmml" xref="A5.T3.2.2.1.m1.1.1.1"></times><cn id="A5.T3.2.2.1.m1.1.1.2.cmml" type="integer" xref="A5.T3.2.2.1.m1.1.1.2">9</cn><cn id="A5.T3.2.2.1.m1.1.1.3.cmml" type="integer" xref="A5.T3.2.2.1.m1.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.2.2.1.m1.1c">9\times 9</annotation><annotation encoding="application/x-llamapun" id="A5.T3.2.2.1.m1.1d">9 × 9</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.3.3">
<td class="ltx_td ltx_align_left" id="A5.T3.3.3.2" style="padding-left:11.4pt;padding-right:11.4pt;">U-Net train epochs</td>
<td class="ltx_td ltx_align_center" id="A5.T3.3.3.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.3.3.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="500" class="ltx_Math" display="inline" id="A5.T3.3.3.1.m1.1"><semantics id="A5.T3.3.3.1.m1.1a"><mn id="A5.T3.3.3.1.m1.1.1" xref="A5.T3.3.3.1.m1.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="A5.T3.3.3.1.m1.1b"><cn id="A5.T3.3.3.1.m1.1.1.cmml" type="integer" xref="A5.T3.3.3.1.m1.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.3.3.1.m1.1c">500</annotation><annotation encoding="application/x-llamapun" id="A5.T3.3.3.1.m1.1d">500</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.4.4">
<td class="ltx_td ltx_align_left" id="A5.T3.4.4.2" style="padding-left:11.4pt;padding-right:11.4pt;">U-Net initial learning rate</td>
<td class="ltx_td ltx_align_center" id="A5.T3.4.4.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.4.4.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="5\times 10^{-4}" class="ltx_Math" display="inline" id="A5.T3.4.4.1.m1.1"><semantics id="A5.T3.4.4.1.m1.1a"><mrow id="A5.T3.4.4.1.m1.1.1" xref="A5.T3.4.4.1.m1.1.1.cmml"><mn id="A5.T3.4.4.1.m1.1.1.2" xref="A5.T3.4.4.1.m1.1.1.2.cmml">5</mn><mo id="A5.T3.4.4.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A5.T3.4.4.1.m1.1.1.1.cmml">×</mo><msup id="A5.T3.4.4.1.m1.1.1.3" xref="A5.T3.4.4.1.m1.1.1.3.cmml"><mn id="A5.T3.4.4.1.m1.1.1.3.2" xref="A5.T3.4.4.1.m1.1.1.3.2.cmml">10</mn><mrow id="A5.T3.4.4.1.m1.1.1.3.3" xref="A5.T3.4.4.1.m1.1.1.3.3.cmml"><mo id="A5.T3.4.4.1.m1.1.1.3.3a" xref="A5.T3.4.4.1.m1.1.1.3.3.cmml">−</mo><mn id="A5.T3.4.4.1.m1.1.1.3.3.2" xref="A5.T3.4.4.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.T3.4.4.1.m1.1b"><apply id="A5.T3.4.4.1.m1.1.1.cmml" xref="A5.T3.4.4.1.m1.1.1"><times id="A5.T3.4.4.1.m1.1.1.1.cmml" xref="A5.T3.4.4.1.m1.1.1.1"></times><cn id="A5.T3.4.4.1.m1.1.1.2.cmml" type="integer" xref="A5.T3.4.4.1.m1.1.1.2">5</cn><apply id="A5.T3.4.4.1.m1.1.1.3.cmml" xref="A5.T3.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A5.T3.4.4.1.m1.1.1.3.1.cmml" xref="A5.T3.4.4.1.m1.1.1.3">superscript</csymbol><cn id="A5.T3.4.4.1.m1.1.1.3.2.cmml" type="integer" xref="A5.T3.4.4.1.m1.1.1.3.2">10</cn><apply id="A5.T3.4.4.1.m1.1.1.3.3.cmml" xref="A5.T3.4.4.1.m1.1.1.3.3"><minus id="A5.T3.4.4.1.m1.1.1.3.3.1.cmml" xref="A5.T3.4.4.1.m1.1.1.3.3"></minus><cn id="A5.T3.4.4.1.m1.1.1.3.3.2.cmml" type="integer" xref="A5.T3.4.4.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.4.4.1.m1.1c">5\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.4.4.1.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.5.5">
<td class="ltx_td ltx_align_left" id="A5.T3.5.5.2" style="padding-left:11.4pt;padding-right:11.4pt;">U-Net learning rate decay epochs</td>
<td class="ltx_td ltx_align_center" id="A5.T3.5.5.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.5.5.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="50" class="ltx_Math" display="inline" id="A5.T3.5.5.1.m1.1"><semantics id="A5.T3.5.5.1.m1.1a"><mn id="A5.T3.5.5.1.m1.1.1" xref="A5.T3.5.5.1.m1.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="A5.T3.5.5.1.m1.1b"><cn id="A5.T3.5.5.1.m1.1.1.cmml" type="integer" xref="A5.T3.5.5.1.m1.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.5.5.1.m1.1c">50</annotation><annotation encoding="application/x-llamapun" id="A5.T3.5.5.1.m1.1d">50</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.6.6">
<td class="ltx_td ltx_align_left" id="A5.T3.6.6.2" style="padding-left:11.4pt;padding-right:11.4pt;">U-Net learning rate decay rate</td>
<td class="ltx_td ltx_align_center" id="A5.T3.6.6.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.6.6.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="0.10" class="ltx_Math" display="inline" id="A5.T3.6.6.1.m1.1"><semantics id="A5.T3.6.6.1.m1.1a"><mn id="A5.T3.6.6.1.m1.1.1" xref="A5.T3.6.6.1.m1.1.1.cmml">0.10</mn><annotation-xml encoding="MathML-Content" id="A5.T3.6.6.1.m1.1b"><cn id="A5.T3.6.6.1.m1.1.1.cmml" type="float" xref="A5.T3.6.6.1.m1.1.1">0.10</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.6.6.1.m1.1c">0.10</annotation><annotation encoding="application/x-llamapun" id="A5.T3.6.6.1.m1.1d">0.10</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.7.7">
<td class="ltx_td ltx_align_left" id="A5.T3.7.7.2" style="padding-left:11.4pt;padding-right:11.4pt;">Text feature dimensions</td>
<td class="ltx_td ltx_align_center" id="A5.T3.7.7.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.7.7.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="512" class="ltx_Math" display="inline" id="A5.T3.7.7.1.m1.1"><semantics id="A5.T3.7.7.1.m1.1a"><mn id="A5.T3.7.7.1.m1.1.1" xref="A5.T3.7.7.1.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A5.T3.7.7.1.m1.1b"><cn id="A5.T3.7.7.1.m1.1.1.cmml" type="integer" xref="A5.T3.7.7.1.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.7.7.1.m1.1c">512</annotation><annotation encoding="application/x-llamapun" id="A5.T3.7.7.1.m1.1d">512</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.28.31.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T3.28.31.3.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_typewriter" id="A5.T3.28.31.3.1.1">General</span></td>
<td class="ltx_td ltx_border_t" id="A5.T3.28.31.3.2" style="padding-left:11.4pt;padding-right:11.4pt;"></td>
<td class="ltx_td ltx_border_t" id="A5.T3.28.31.3.3" style="padding-left:11.4pt;padding-right:11.4pt;"></td>
</tr>
<tr class="ltx_tr" id="A5.T3.8.8">
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T3.8.8.2" style="padding-left:11.4pt;padding-right:11.4pt;">Replay capacity</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T3.8.8.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T3.8.8.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="1\times 10^{6}" class="ltx_Math" display="inline" id="A5.T3.8.8.1.m1.1"><semantics id="A5.T3.8.8.1.m1.1a"><mrow id="A5.T3.8.8.1.m1.1.1" xref="A5.T3.8.8.1.m1.1.1.cmml"><mn id="A5.T3.8.8.1.m1.1.1.2" xref="A5.T3.8.8.1.m1.1.1.2.cmml">1</mn><mo id="A5.T3.8.8.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A5.T3.8.8.1.m1.1.1.1.cmml">×</mo><msup id="A5.T3.8.8.1.m1.1.1.3" xref="A5.T3.8.8.1.m1.1.1.3.cmml"><mn id="A5.T3.8.8.1.m1.1.1.3.2" xref="A5.T3.8.8.1.m1.1.1.3.2.cmml">10</mn><mn id="A5.T3.8.8.1.m1.1.1.3.3" xref="A5.T3.8.8.1.m1.1.1.3.3.cmml">6</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.T3.8.8.1.m1.1b"><apply id="A5.T3.8.8.1.m1.1.1.cmml" xref="A5.T3.8.8.1.m1.1.1"><times id="A5.T3.8.8.1.m1.1.1.1.cmml" xref="A5.T3.8.8.1.m1.1.1.1"></times><cn id="A5.T3.8.8.1.m1.1.1.2.cmml" type="integer" xref="A5.T3.8.8.1.m1.1.1.2">1</cn><apply id="A5.T3.8.8.1.m1.1.1.3.cmml" xref="A5.T3.8.8.1.m1.1.1.3"><csymbol cd="ambiguous" id="A5.T3.8.8.1.m1.1.1.3.1.cmml" xref="A5.T3.8.8.1.m1.1.1.3">superscript</csymbol><cn id="A5.T3.8.8.1.m1.1.1.3.2.cmml" type="integer" xref="A5.T3.8.8.1.m1.1.1.3.2">10</cn><cn id="A5.T3.8.8.1.m1.1.1.3.3.cmml" type="integer" xref="A5.T3.8.8.1.m1.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.8.8.1.m1.1c">1\times 10^{6}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.8.8.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.10.10">
<td class="ltx_td ltx_align_left" id="A5.T3.10.10.3" style="padding-left:11.4pt;padding-right:11.4pt;">Batch size</td>
<td class="ltx_td ltx_align_center" id="A5.T3.9.9.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="B" class="ltx_Math" display="inline" id="A5.T3.9.9.1.m1.1"><semantics id="A5.T3.9.9.1.m1.1a"><mi id="A5.T3.9.9.1.m1.1.1" xref="A5.T3.9.9.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A5.T3.9.9.1.m1.1b"><ci id="A5.T3.9.9.1.m1.1.1.cmml" xref="A5.T3.9.9.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.9.9.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="A5.T3.9.9.1.m1.1d">italic_B</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A5.T3.10.10.2" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="16" class="ltx_Math" display="inline" id="A5.T3.10.10.2.m1.1"><semantics id="A5.T3.10.10.2.m1.1a"><mn id="A5.T3.10.10.2.m1.1.1" xref="A5.T3.10.10.2.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A5.T3.10.10.2.m1.1b"><cn id="A5.T3.10.10.2.m1.1.1.cmml" type="integer" xref="A5.T3.10.10.2.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.10.10.2.m1.1c">16</annotation><annotation encoding="application/x-llamapun" id="A5.T3.10.10.2.m1.1d">16</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.12.12">
<td class="ltx_td ltx_align_left" id="A5.T3.12.12.3" style="padding-left:11.4pt;padding-right:11.4pt;">Batch length</td>
<td class="ltx_td ltx_align_center" id="A5.T3.11.11.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="T" class="ltx_Math" display="inline" id="A5.T3.11.11.1.m1.1"><semantics id="A5.T3.11.11.1.m1.1a"><mi id="A5.T3.11.11.1.m1.1.1" xref="A5.T3.11.11.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A5.T3.11.11.1.m1.1b"><ci id="A5.T3.11.11.1.m1.1.1.cmml" xref="A5.T3.11.11.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.11.11.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="A5.T3.11.11.1.m1.1d">italic_T</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A5.T3.12.12.2" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="32" class="ltx_Math" display="inline" id="A5.T3.12.12.2.m1.1"><semantics id="A5.T3.12.12.2.m1.1a"><mn id="A5.T3.12.12.2.m1.1.1" xref="A5.T3.12.12.2.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A5.T3.12.12.2.m1.1b"><cn id="A5.T3.12.12.2.m1.1.1.cmml" type="integer" xref="A5.T3.12.12.2.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.12.12.2.m1.1c">32</annotation><annotation encoding="application/x-llamapun" id="A5.T3.12.12.2.m1.1d">32</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.13.13">
<td class="ltx_td ltx_align_left" id="A5.T3.13.13.2" style="padding-left:11.4pt;padding-right:11.4pt;">Train ratio</td>
<td class="ltx_td ltx_align_center" id="A5.T3.13.13.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.13.13.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="16" class="ltx_Math" display="inline" id="A5.T3.13.13.1.m1.1"><semantics id="A5.T3.13.13.1.m1.1a"><mn id="A5.T3.13.13.1.m1.1.1" xref="A5.T3.13.13.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A5.T3.13.13.1.m1.1b"><cn id="A5.T3.13.13.1.m1.1.1.cmml" type="integer" xref="A5.T3.13.13.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.13.13.1.m1.1c">16</annotation><annotation encoding="application/x-llamapun" id="A5.T3.13.13.1.m1.1d">16</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.28.32.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T3.28.32.4.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_typewriter" id="A5.T3.28.32.4.1.1">World Model</span></td>
<td class="ltx_td ltx_border_t" id="A5.T3.28.32.4.2" style="padding-left:11.4pt;padding-right:11.4pt;"></td>
<td class="ltx_td ltx_border_t" id="A5.T3.28.32.4.3" style="padding-left:11.4pt;padding-right:11.4pt;"></td>
</tr>
<tr class="ltx_tr" id="A5.T3.14.14">
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T3.14.14.2" style="padding-left:11.4pt;padding-right:11.4pt;">Intrinsic reward weight</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T3.14.14.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="\alpha" class="ltx_Math" display="inline" id="A5.T3.14.14.1.m1.1"><semantics id="A5.T3.14.14.1.m1.1a"><mi id="A5.T3.14.14.1.m1.1.1" xref="A5.T3.14.14.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.T3.14.14.1.m1.1b"><ci id="A5.T3.14.14.1.m1.1.1.cmml" xref="A5.T3.14.14.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.14.14.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A5.T3.14.14.1.m1.1d">italic_α</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T3.14.14.3" style="padding-left:11.4pt;padding-right:11.4pt;">1</td>
</tr>
<tr class="ltx_tr" id="A5.T3.28.33.5">
<td class="ltx_td ltx_align_left" id="A5.T3.28.33.5.1" style="padding-left:11.4pt;padding-right:11.4pt;">Deterministic latent dimensions</td>
<td class="ltx_td ltx_align_center" id="A5.T3.28.33.5.2" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.28.33.5.3" style="padding-left:11.4pt;padding-right:11.4pt;">4096</td>
</tr>
<tr class="ltx_tr" id="A5.T3.28.34.6">
<td class="ltx_td ltx_align_left" id="A5.T3.28.34.6.1" style="padding-left:11.4pt;padding-right:11.4pt;">Stochastic latent dimensions</td>
<td class="ltx_td ltx_align_center" id="A5.T3.28.34.6.2" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.28.34.6.3" style="padding-left:11.4pt;padding-right:11.4pt;">32</td>
</tr>
<tr class="ltx_tr" id="A5.T3.28.35.7">
<td class="ltx_td ltx_align_left" id="A5.T3.28.35.7.1" style="padding-left:11.4pt;padding-right:11.4pt;">Discrete latent classes</td>
<td class="ltx_td ltx_align_center" id="A5.T3.28.35.7.2" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.28.35.7.3" style="padding-left:11.4pt;padding-right:11.4pt;">32</td>
</tr>
<tr class="ltx_tr" id="A5.T3.28.36.8">
<td class="ltx_td ltx_align_left" id="A5.T3.28.36.8.1" style="padding-left:11.4pt;padding-right:11.4pt;">RSSM number of units</td>
<td class="ltx_td ltx_align_center" id="A5.T3.28.36.8.2" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.28.36.8.3" style="padding-left:11.4pt;padding-right:11.4pt;">1024</td>
</tr>
<tr class="ltx_tr" id="A5.T3.15.15">
<td class="ltx_td ltx_align_left" id="A5.T3.15.15.2" style="padding-left:11.4pt;padding-right:11.4pt;">World model learning rate</td>
<td class="ltx_td ltx_align_center" id="A5.T3.15.15.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.15.15.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="1\times 10^{-4}" class="ltx_Math" display="inline" id="A5.T3.15.15.1.m1.1"><semantics id="A5.T3.15.15.1.m1.1a"><mrow id="A5.T3.15.15.1.m1.1.1" xref="A5.T3.15.15.1.m1.1.1.cmml"><mn id="A5.T3.15.15.1.m1.1.1.2" xref="A5.T3.15.15.1.m1.1.1.2.cmml">1</mn><mo id="A5.T3.15.15.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A5.T3.15.15.1.m1.1.1.1.cmml">×</mo><msup id="A5.T3.15.15.1.m1.1.1.3" xref="A5.T3.15.15.1.m1.1.1.3.cmml"><mn id="A5.T3.15.15.1.m1.1.1.3.2" xref="A5.T3.15.15.1.m1.1.1.3.2.cmml">10</mn><mrow id="A5.T3.15.15.1.m1.1.1.3.3" xref="A5.T3.15.15.1.m1.1.1.3.3.cmml"><mo id="A5.T3.15.15.1.m1.1.1.3.3a" xref="A5.T3.15.15.1.m1.1.1.3.3.cmml">−</mo><mn id="A5.T3.15.15.1.m1.1.1.3.3.2" xref="A5.T3.15.15.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.T3.15.15.1.m1.1b"><apply id="A5.T3.15.15.1.m1.1.1.cmml" xref="A5.T3.15.15.1.m1.1.1"><times id="A5.T3.15.15.1.m1.1.1.1.cmml" xref="A5.T3.15.15.1.m1.1.1.1"></times><cn id="A5.T3.15.15.1.m1.1.1.2.cmml" type="integer" xref="A5.T3.15.15.1.m1.1.1.2">1</cn><apply id="A5.T3.15.15.1.m1.1.1.3.cmml" xref="A5.T3.15.15.1.m1.1.1.3"><csymbol cd="ambiguous" id="A5.T3.15.15.1.m1.1.1.3.1.cmml" xref="A5.T3.15.15.1.m1.1.1.3">superscript</csymbol><cn id="A5.T3.15.15.1.m1.1.1.3.2.cmml" type="integer" xref="A5.T3.15.15.1.m1.1.1.3.2">10</cn><apply id="A5.T3.15.15.1.m1.1.1.3.3.cmml" xref="A5.T3.15.15.1.m1.1.1.3.3"><minus id="A5.T3.15.15.1.m1.1.1.3.3.1.cmml" xref="A5.T3.15.15.1.m1.1.1.3.3"></minus><cn id="A5.T3.15.15.1.m1.1.1.3.3.2.cmml" type="integer" xref="A5.T3.15.15.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.15.15.1.m1.1c">1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.15.15.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.16.16">
<td class="ltx_td ltx_align_left" id="A5.T3.16.16.2" style="padding-left:11.4pt;padding-right:11.4pt;">Long-term branch loss scale</td>
<td class="ltx_td ltx_align_center" id="A5.T3.16.16.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="\beta_{\text{long}}" class="ltx_Math" display="inline" id="A5.T3.16.16.1.m1.1"><semantics id="A5.T3.16.16.1.m1.1a"><msub id="A5.T3.16.16.1.m1.1.1" xref="A5.T3.16.16.1.m1.1.1.cmml"><mi id="A5.T3.16.16.1.m1.1.1.2" xref="A5.T3.16.16.1.m1.1.1.2.cmml">β</mi><mtext id="A5.T3.16.16.1.m1.1.1.3" xref="A5.T3.16.16.1.m1.1.1.3a.cmml">long</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.T3.16.16.1.m1.1b"><apply id="A5.T3.16.16.1.m1.1.1.cmml" xref="A5.T3.16.16.1.m1.1.1"><csymbol cd="ambiguous" id="A5.T3.16.16.1.m1.1.1.1.cmml" xref="A5.T3.16.16.1.m1.1.1">subscript</csymbol><ci id="A5.T3.16.16.1.m1.1.1.2.cmml" xref="A5.T3.16.16.1.m1.1.1.2">𝛽</ci><ci id="A5.T3.16.16.1.m1.1.1.3a.cmml" xref="A5.T3.16.16.1.m1.1.1.3"><mtext id="A5.T3.16.16.1.m1.1.1.3.cmml" mathsize="70%" xref="A5.T3.16.16.1.m1.1.1.3">long</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.16.16.1.m1.1c">\beta_{\text{long}}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.16.16.1.m1.1d">italic_β start_POSTSUBSCRIPT long end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A5.T3.16.16.3" style="padding-left:11.4pt;padding-right:11.4pt;">1</td>
</tr>
<tr class="ltx_tr" id="A5.T3.18.18">
<td class="ltx_td ltx_align_left" id="A5.T3.18.18.3" style="padding-left:11.4pt;padding-right:11.4pt;">Reconstruction loss scale</td>
<td class="ltx_td ltx_align_center" id="A5.T3.17.17.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="\beta_{\text{pred}}" class="ltx_Math" display="inline" id="A5.T3.17.17.1.m1.1"><semantics id="A5.T3.17.17.1.m1.1a"><msub id="A5.T3.17.17.1.m1.1.1" xref="A5.T3.17.17.1.m1.1.1.cmml"><mi id="A5.T3.17.17.1.m1.1.1.2" xref="A5.T3.17.17.1.m1.1.1.2.cmml">β</mi><mtext id="A5.T3.17.17.1.m1.1.1.3" xref="A5.T3.17.17.1.m1.1.1.3a.cmml">pred</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.T3.17.17.1.m1.1b"><apply id="A5.T3.17.17.1.m1.1.1.cmml" xref="A5.T3.17.17.1.m1.1.1"><csymbol cd="ambiguous" id="A5.T3.17.17.1.m1.1.1.1.cmml" xref="A5.T3.17.17.1.m1.1.1">subscript</csymbol><ci id="A5.T3.17.17.1.m1.1.1.2.cmml" xref="A5.T3.17.17.1.m1.1.1.2">𝛽</ci><ci id="A5.T3.17.17.1.m1.1.1.3a.cmml" xref="A5.T3.17.17.1.m1.1.1.3"><mtext id="A5.T3.17.17.1.m1.1.1.3.cmml" mathsize="70%" xref="A5.T3.17.17.1.m1.1.1.3">pred</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.17.17.1.m1.1c">\beta_{\text{pred}}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.17.17.1.m1.1d">italic_β start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A5.T3.18.18.2" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="1" class="ltx_Math" display="inline" id="A5.T3.18.18.2.m1.1"><semantics id="A5.T3.18.18.2.m1.1a"><mn id="A5.T3.18.18.2.m1.1.1" xref="A5.T3.18.18.2.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A5.T3.18.18.2.m1.1b"><cn id="A5.T3.18.18.2.m1.1.1.cmml" type="integer" xref="A5.T3.18.18.2.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.18.18.2.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="A5.T3.18.18.2.m1.1d">1</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.20.20">
<td class="ltx_td ltx_align_left" id="A5.T3.20.20.3" style="padding-left:11.4pt;padding-right:11.4pt;">Dynamics loss scale</td>
<td class="ltx_td ltx_align_center" id="A5.T3.19.19.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="\beta_{\text{dyn}}" class="ltx_Math" display="inline" id="A5.T3.19.19.1.m1.1"><semantics id="A5.T3.19.19.1.m1.1a"><msub id="A5.T3.19.19.1.m1.1.1" xref="A5.T3.19.19.1.m1.1.1.cmml"><mi id="A5.T3.19.19.1.m1.1.1.2" xref="A5.T3.19.19.1.m1.1.1.2.cmml">β</mi><mtext id="A5.T3.19.19.1.m1.1.1.3" xref="A5.T3.19.19.1.m1.1.1.3a.cmml">dyn</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.T3.19.19.1.m1.1b"><apply id="A5.T3.19.19.1.m1.1.1.cmml" xref="A5.T3.19.19.1.m1.1.1"><csymbol cd="ambiguous" id="A5.T3.19.19.1.m1.1.1.1.cmml" xref="A5.T3.19.19.1.m1.1.1">subscript</csymbol><ci id="A5.T3.19.19.1.m1.1.1.2.cmml" xref="A5.T3.19.19.1.m1.1.1.2">𝛽</ci><ci id="A5.T3.19.19.1.m1.1.1.3a.cmml" xref="A5.T3.19.19.1.m1.1.1.3"><mtext id="A5.T3.19.19.1.m1.1.1.3.cmml" mathsize="70%" xref="A5.T3.19.19.1.m1.1.1.3">dyn</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.19.19.1.m1.1c">\beta_{\text{dyn}}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.19.19.1.m1.1d">italic_β start_POSTSUBSCRIPT dyn end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A5.T3.20.20.2" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="1" class="ltx_Math" display="inline" id="A5.T3.20.20.2.m1.1"><semantics id="A5.T3.20.20.2.m1.1a"><mn id="A5.T3.20.20.2.m1.1.1" xref="A5.T3.20.20.2.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A5.T3.20.20.2.m1.1b"><cn id="A5.T3.20.20.2.m1.1.1.cmml" type="integer" xref="A5.T3.20.20.2.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.20.20.2.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="A5.T3.20.20.2.m1.1d">1</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.22.22">
<td class="ltx_td ltx_align_left" id="A5.T3.22.22.3" style="padding-left:11.4pt;padding-right:11.4pt;">Representation loss scale</td>
<td class="ltx_td ltx_align_center" id="A5.T3.21.21.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="\beta_{\text{rep}}" class="ltx_Math" display="inline" id="A5.T3.21.21.1.m1.1"><semantics id="A5.T3.21.21.1.m1.1a"><msub id="A5.T3.21.21.1.m1.1.1" xref="A5.T3.21.21.1.m1.1.1.cmml"><mi id="A5.T3.21.21.1.m1.1.1.2" xref="A5.T3.21.21.1.m1.1.1.2.cmml">β</mi><mtext id="A5.T3.21.21.1.m1.1.1.3" xref="A5.T3.21.21.1.m1.1.1.3a.cmml">rep</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.T3.21.21.1.m1.1b"><apply id="A5.T3.21.21.1.m1.1.1.cmml" xref="A5.T3.21.21.1.m1.1.1"><csymbol cd="ambiguous" id="A5.T3.21.21.1.m1.1.1.1.cmml" xref="A5.T3.21.21.1.m1.1.1">subscript</csymbol><ci id="A5.T3.21.21.1.m1.1.1.2.cmml" xref="A5.T3.21.21.1.m1.1.1.2">𝛽</ci><ci id="A5.T3.21.21.1.m1.1.1.3a.cmml" xref="A5.T3.21.21.1.m1.1.1.3"><mtext id="A5.T3.21.21.1.m1.1.1.3.cmml" mathsize="70%" xref="A5.T3.21.21.1.m1.1.1.3">rep</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.21.21.1.m1.1c">\beta_{\text{rep}}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.21.21.1.m1.1d">italic_β start_POSTSUBSCRIPT rep end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A5.T3.22.22.2" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="0.1" class="ltx_Math" display="inline" id="A5.T3.22.22.2.m1.1"><semantics id="A5.T3.22.22.2.m1.1a"><mn id="A5.T3.22.22.2.m1.1.1" xref="A5.T3.22.22.2.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A5.T3.22.22.2.m1.1b"><cn id="A5.T3.22.22.2.m1.1.1.cmml" type="float" xref="A5.T3.22.22.2.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.22.22.2.m1.1c">0.1</annotation><annotation encoding="application/x-llamapun" id="A5.T3.22.22.2.m1.1d">0.1</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.28.37.9">
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T3.28.37.9.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_typewriter" id="A5.T3.28.37.9.1.1">Behavior Learning</span></td>
<td class="ltx_td ltx_border_t" id="A5.T3.28.37.9.2" style="padding-left:11.4pt;padding-right:11.4pt;"></td>
<td class="ltx_td ltx_border_t" id="A5.T3.28.37.9.3" style="padding-left:11.4pt;padding-right:11.4pt;"></td>
</tr>
<tr class="ltx_tr" id="A5.T3.23.23">
<td class="ltx_td ltx_align_left ltx_border_t" id="A5.T3.23.23.2" style="padding-left:11.4pt;padding-right:11.4pt;">Imagination horizon</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T3.23.23.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="L" class="ltx_Math" display="inline" id="A5.T3.23.23.1.m1.1"><semantics id="A5.T3.23.23.1.m1.1a"><mi id="A5.T3.23.23.1.m1.1.1" xref="A5.T3.23.23.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A5.T3.23.23.1.m1.1b"><ci id="A5.T3.23.23.1.m1.1.1.cmml" xref="A5.T3.23.23.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.23.23.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="A5.T3.23.23.1.m1.1d">italic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T3.23.23.3" style="padding-left:11.4pt;padding-right:11.4pt;">15</td>
</tr>
<tr class="ltx_tr" id="A5.T3.24.24">
<td class="ltx_td ltx_align_left" id="A5.T3.24.24.2" style="padding-left:11.4pt;padding-right:11.4pt;">Discount</td>
<td class="ltx_td ltx_align_center" id="A5.T3.24.24.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="\gamma" class="ltx_Math" display="inline" id="A5.T3.24.24.1.m1.1"><semantics id="A5.T3.24.24.1.m1.1a"><mi id="A5.T3.24.24.1.m1.1.1" xref="A5.T3.24.24.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A5.T3.24.24.1.m1.1b"><ci id="A5.T3.24.24.1.m1.1.1.cmml" xref="A5.T3.24.24.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.24.24.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A5.T3.24.24.1.m1.1d">italic_γ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A5.T3.24.24.3" style="padding-left:11.4pt;padding-right:11.4pt;">0.997</td>
</tr>
<tr class="ltx_tr" id="A5.T3.26.26">
<td class="ltx_td ltx_align_left" id="A5.T3.25.25.1" style="padding-left:11.4pt;padding-right:11.4pt;">
<math alttext="\lambda" class="ltx_Math" display="inline" id="A5.T3.25.25.1.m1.1"><semantics id="A5.T3.25.25.1.m1.1a"><mi id="A5.T3.25.25.1.m1.1.1" xref="A5.T3.25.25.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A5.T3.25.25.1.m1.1b"><ci id="A5.T3.25.25.1.m1.1.1.cmml" xref="A5.T3.25.25.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.25.25.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A5.T3.25.25.1.m1.1d">italic_λ</annotation></semantics></math>-target</td>
<td class="ltx_td ltx_align_center" id="A5.T3.26.26.2" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="\lambda" class="ltx_Math" display="inline" id="A5.T3.26.26.2.m1.1"><semantics id="A5.T3.26.26.2.m1.1a"><mi id="A5.T3.26.26.2.m1.1.1" xref="A5.T3.26.26.2.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A5.T3.26.26.2.m1.1b"><ci id="A5.T3.26.26.2.m1.1.1.cmml" xref="A5.T3.26.26.2.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.26.26.2.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A5.T3.26.26.2.m1.1d">italic_λ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A5.T3.26.26.3" style="padding-left:11.4pt;padding-right:11.4pt;">0.95</td>
</tr>
<tr class="ltx_tr" id="A5.T3.27.27">
<td class="ltx_td ltx_align_left" id="A5.T3.27.27.2" style="padding-left:11.4pt;padding-right:11.4pt;">Actor learning rate</td>
<td class="ltx_td ltx_align_center" id="A5.T3.27.27.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center" id="A5.T3.27.27.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="3\cdot 10^{-5}" class="ltx_Math" display="inline" id="A5.T3.27.27.1.m1.1"><semantics id="A5.T3.27.27.1.m1.1a"><mrow id="A5.T3.27.27.1.m1.1.1" xref="A5.T3.27.27.1.m1.1.1.cmml"><mn id="A5.T3.27.27.1.m1.1.1.2" xref="A5.T3.27.27.1.m1.1.1.2.cmml">3</mn><mo id="A5.T3.27.27.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A5.T3.27.27.1.m1.1.1.1.cmml">⋅</mo><msup id="A5.T3.27.27.1.m1.1.1.3" xref="A5.T3.27.27.1.m1.1.1.3.cmml"><mn id="A5.T3.27.27.1.m1.1.1.3.2" xref="A5.T3.27.27.1.m1.1.1.3.2.cmml">10</mn><mrow id="A5.T3.27.27.1.m1.1.1.3.3" xref="A5.T3.27.27.1.m1.1.1.3.3.cmml"><mo id="A5.T3.27.27.1.m1.1.1.3.3a" xref="A5.T3.27.27.1.m1.1.1.3.3.cmml">−</mo><mn id="A5.T3.27.27.1.m1.1.1.3.3.2" xref="A5.T3.27.27.1.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.T3.27.27.1.m1.1b"><apply id="A5.T3.27.27.1.m1.1.1.cmml" xref="A5.T3.27.27.1.m1.1.1"><ci id="A5.T3.27.27.1.m1.1.1.1.cmml" xref="A5.T3.27.27.1.m1.1.1.1">⋅</ci><cn id="A5.T3.27.27.1.m1.1.1.2.cmml" type="integer" xref="A5.T3.27.27.1.m1.1.1.2">3</cn><apply id="A5.T3.27.27.1.m1.1.1.3.cmml" xref="A5.T3.27.27.1.m1.1.1.3"><csymbol cd="ambiguous" id="A5.T3.27.27.1.m1.1.1.3.1.cmml" xref="A5.T3.27.27.1.m1.1.1.3">superscript</csymbol><cn id="A5.T3.27.27.1.m1.1.1.3.2.cmml" type="integer" xref="A5.T3.27.27.1.m1.1.1.3.2">10</cn><apply id="A5.T3.27.27.1.m1.1.1.3.3.cmml" xref="A5.T3.27.27.1.m1.1.1.3.3"><minus id="A5.T3.27.27.1.m1.1.1.3.3.1.cmml" xref="A5.T3.27.27.1.m1.1.1.3.3"></minus><cn id="A5.T3.27.27.1.m1.1.1.3.3.2.cmml" type="integer" xref="A5.T3.27.27.1.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.27.27.1.m1.1c">3\cdot 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.27.27.1.m1.1d">3 ⋅ 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A5.T3.28.28">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A5.T3.28.28.2" style="padding-left:11.4pt;padding-right:11.4pt;">Critic learning rate</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T3.28.28.3" style="padding-left:11.4pt;padding-right:11.4pt;">—</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T3.28.28.1" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="3\cdot 10^{-5}" class="ltx_Math" display="inline" id="A5.T3.28.28.1.m1.1"><semantics id="A5.T3.28.28.1.m1.1a"><mrow id="A5.T3.28.28.1.m1.1.1" xref="A5.T3.28.28.1.m1.1.1.cmml"><mn id="A5.T3.28.28.1.m1.1.1.2" xref="A5.T3.28.28.1.m1.1.1.2.cmml">3</mn><mo id="A5.T3.28.28.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A5.T3.28.28.1.m1.1.1.1.cmml">⋅</mo><msup id="A5.T3.28.28.1.m1.1.1.3" xref="A5.T3.28.28.1.m1.1.1.3.cmml"><mn id="A5.T3.28.28.1.m1.1.1.3.2" xref="A5.T3.28.28.1.m1.1.1.3.2.cmml">10</mn><mrow id="A5.T3.28.28.1.m1.1.1.3.3" xref="A5.T3.28.28.1.m1.1.1.3.3.cmml"><mo id="A5.T3.28.28.1.m1.1.1.3.3a" xref="A5.T3.28.28.1.m1.1.1.3.3.cmml">−</mo><mn id="A5.T3.28.28.1.m1.1.1.3.3.2" xref="A5.T3.28.28.1.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.T3.28.28.1.m1.1b"><apply id="A5.T3.28.28.1.m1.1.1.cmml" xref="A5.T3.28.28.1.m1.1.1"><ci id="A5.T3.28.28.1.m1.1.1.1.cmml" xref="A5.T3.28.28.1.m1.1.1.1">⋅</ci><cn id="A5.T3.28.28.1.m1.1.1.2.cmml" type="integer" xref="A5.T3.28.28.1.m1.1.1.2">3</cn><apply id="A5.T3.28.28.1.m1.1.1.3.cmml" xref="A5.T3.28.28.1.m1.1.1.3"><csymbol cd="ambiguous" id="A5.T3.28.28.1.m1.1.1.3.1.cmml" xref="A5.T3.28.28.1.m1.1.1.3">superscript</csymbol><cn id="A5.T3.28.28.1.m1.1.1.3.2.cmml" type="integer" xref="A5.T3.28.28.1.m1.1.1.3.2">10</cn><apply id="A5.T3.28.28.1.m1.1.1.3.3.cmml" xref="A5.T3.28.28.1.m1.1.1.3.3"><minus id="A5.T3.28.28.1.m1.1.1.3.3.1.cmml" xref="A5.T3.28.28.1.m1.1.1.3.3"></minus><cn id="A5.T3.28.28.1.m1.1.1.3.3.2.cmml" type="integer" xref="A5.T3.28.28.1.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.28.28.1.m1.1c">3\cdot 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A5.T3.28.28.1.m1.1d">3 ⋅ 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 17:09:11 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
