<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>\method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search</title>
<!--Generated on Fri Oct  4 18:54:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03864v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S1" title="In \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2" title="In \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span><span class="ltx_ERROR undefined">\method</span>: Learning to Reason Dynamically</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.SS1" title="In 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Overview</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.SS1.SSS0.Px1" title="In 2.1 Overview ‣ 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">External Planner Tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.SS1.SSS0.Px2" title="In 2.1 Overview ‣ 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Internalized Planner Tuning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.SS2" title="In 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Defining Atomic Reasoning Actions Modules</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.SS2.SSS0.Px1" title="In 2.2 Defining Atomic Reasoning Actions Modules ‣ 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Analysis Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.SS2.SSS0.Px2" title="In 2.2 Defining Atomic Reasoning Actions Modules ‣ 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Solution Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.SS2.SSS0.Px3" title="In 2.2 Defining Atomic Reasoning Actions Modules ‣ 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Verification Layer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.SS3" title="In 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Searching for Optimal Reasoning Action Trajectories</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.SS4" title="In 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Learning to Plan for Optimal Reasoning Trajectories</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3" title="In \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS1" title="In 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS1.SSS0.Px1" title="In 3.1 Experimental Setup ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS1.SSS0.Px2" title="In 3.1 Experimental Setup ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Training Setup</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS2" title="In 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS3" title="In 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>External Planner Tuning Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS3.SSS0.Px1" title="In 3.3 External Planner Tuning Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">External planner tuning outperforms other methods on the in-domain task</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS3.SSS0.Px2" title="In 3.3 External Planner Tuning Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">The external planner can learn the appropriate action trajectory with only a few training examples.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS4" title="In 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Internalized Planner Tuning Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS4.SSS0.Px1" title="In 3.4 Internalized Planner Tuning Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Internalized planner tuning demonstrates superior performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS4.SSS0.Px2" title="In 3.4 Internalized Planner Tuning Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Searching for the optimal reasoning action trajectory helps enhance the utilization of training data</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS5" title="In 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Out-of-Distribution Experimental Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS5.SSS0.Px1" title="In 3.5 Out-of-Distribution Experimental Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Our method consistently generalizes well across diverse OOD challenges</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS6" title="In 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS7" title="In 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.7 </span>Optimal Trajectory Analysis for Different Tasks</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS7.SSS0.Px1" title="In 3.7 Optimal Trajectory Analysis for Different Tasks ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_ERROR undefined">\method</span>adapts to the characteristics of specific questions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS7.SSS0.Px2" title="In 3.7 Optimal Trajectory Analysis for Different Tasks ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_ERROR undefined">\method</span>adapts to the capability of specific task-solving LLMs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS8" title="In 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.8 </span>Additional Analyses</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS8.SSS0.Px1" title="In 3.8 Additional Analyses ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Few-shot In-context Learning Setting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS8.SSS0.Px2" title="In 3.8 Additional Analyses ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">How efficient is <span class="ltx_ERROR undefined">\method</span>?</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.SS8.SSS0.Px3" title="In 3.8 Additional Analyses ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Do we need more reasoning steps for difficult questions?</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S4" title="In \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S4.SS0.SSS0.Px1" title="In 4 Related Work ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Prompt engineering for LLM reasoning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S4.SS0.SSS0.Px2" title="In 4 Related Work ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title">Searching for boosting LLM reasoning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S5" title="In \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#A1" title="In \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Training Implementation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#A2" title="In \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Case Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#A3" title="In \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Sub-Task Performance of BBH</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#A4" title="In \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Prompts Used in Experiments</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_ERROR undefined" id="id9.id1">\method</span>: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Murong Yue<sup class="ltx_sup" id="id10.9.id1"><span class="ltx_text ltx_font_italic" id="id10.9.id1.1">α</span></sup>    Wenlin Yao<sup class="ltx_sup" id="id11.10.id2"><span class="ltx_text ltx_font_italic" id="id11.10.id2.1">β</span></sup>     Haitao Mi<sup class="ltx_sup" id="id12.11.id3"><span class="ltx_text ltx_font_italic" id="id12.11.id3.1">β</span></sup>     Dian Yu<sup class="ltx_sup" id="id13.12.id4"><span class="ltx_text ltx_font_italic" id="id13.12.id4.1">β</span></sup>     Ziyu Yao<sup class="ltx_sup" id="id14.13.id5"><span class="ltx_text ltx_font_italic" id="id14.13.id5.1">α</span></sup>     Dong Yu<sup class="ltx_sup" id="id15.14.id6"><span class="ltx_text ltx_font_italic" id="id15.14.id6.1">β</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id16.15.id7"><span class="ltx_text ltx_font_italic" id="id16.15.id7.1">α</span></sup>George Mason University
<br class="ltx_break"/><sup class="ltx_sup" id="id17.16.id8"><span class="ltx_text ltx_font_italic" id="id17.16.id8.1">β</span></sup>Tencent AI Lab, Bellevue
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id18.17.id9">{myue,ziyuyao}@gmu.edu
<br class="ltx_break"/>{wenlinyao,haitaomi,yudian,dyu}@global.tencent.com</span>
</span><span class="ltx_author_notes">Work done during Murong Yue’s internship at Tencent AI Lab.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id19.id1">Enhancing the capability of large language models (LLMs) in reasoning has gained significant attention in recent years. Previous studies have demonstrated the effectiveness of various prompting strategies in aiding LLMs in reasoning (called “reasoning actions”), such as step-by-step thinking, reflecting before answering, solving with programs, and their combinations. However, these approaches often applied static, predefined reasoning actions uniformly to all questions, without considering the specific characteristics of each question or the capability of the task-solving LLM. In this paper, we propose
<span class="ltx_ERROR undefined" id="id19.id1.1">\method</span>, an approach enabling LLMs to reason <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.2">D</span>ynamically via <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.3">O</span>ptimal reasoning <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.4">T</span>rajectories <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.5">S</span>earch,
tailored to the specific characteristics of each question and the inherent capability of the task-solving LLM.
Our approach involves three key steps: i) defining atomic reasoning action modules that can be composed into various reasoning action trajectories; ii) searching for the optimal action trajectory for each training question through iterative exploration and evaluation for the specific task-solving LLM; and iii) using the collected optimal trajectories to train an LLM to plan for the reasoning trajectories of unseen questions. In particular, we propose two learning paradigms, i.e., fine-tuning an external LLM as a planner to guide the task-solving LLM, or directly fine-tuning the task-solving LLM with an internalized capability for reasoning actions planning.
Our experiments across eight reasoning tasks show that our method consistently outperforms static reasoning techniques and the vanilla instruction tuning approach. Further analysis reveals that our method enables LLMs to adjust their computation based on problem complexity, allocating deeper thinking and reasoning to harder problems. Our code is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/MurongYue/DOTS" title="">https://github.com/MurongYue/DOTS</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large Language Models (LLMs) have demonstrated remarkable performance in solving complex reasoning tasks <cite class="ltx_cite ltx_citemacro_citep">(Rae et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib27" title="">2021</a>; Lewkowycz et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib18" title="">2022</a>; Zhong et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib43" title="">2023</a>)</cite>, such as math reasoning <cite class="ltx_cite ltx_citemacro_citep">(Imani et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib15" title="">2023</a>; Ahn et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib1" title="">2024</a>)</cite>, symbolic reasoning <cite class="ltx_cite ltx_citemacro_citep">(Kojima et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib16" title="">2022</a>)</cite>, and common-sense reasoning <cite class="ltx_cite ltx_citemacro_citep">(Krause &amp; Stolzenburg, <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib17" title="">2023</a>; Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib42" title="">2024</a>)</cite>.
The dominant approaches to eliciting reasoning capability in LLMs mainly fall into two categories, i.e., instruction tuning and prompt engineering.
Instruction tuning <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib33" title="">2022</a>)</cite> collects question-answer pairs about the reasoning task and employs supervised fine-tuning to optimize an LLM for better reasoning performance <cite class="ltx_cite ltx_citemacro_citep">(Yue et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib40" title="">2024</a>; Tang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib31" title="">2024</a>)</cite>, with recent effort focusing on improving the scale and the quality of the fine-tuning data <cite class="ltx_cite ltx_citemacro_citep">(Luo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib19" title="">2023</a>; Peng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib24" title="">2023</a>; Yue et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib39" title="">2023</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib40" title="">2024</a>; Chan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib5" title="">2024</a>)</cite>.
Prompt engineering instead aims to design better prompts to elicit the reasoning capability of an LLM without updating its parameters.
The Chain-of-Thought (CoT) approach <cite class="ltx_cite ltx_citemacro_citep">(Wei et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib35" title="">2022</a>; Kojima et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib16" title="">2022</a>)</cite> prompts an LLM to answer the reasoning question step by step in natural language, and program-aided approaches <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib6" title="">2022</a>; Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib11" title="">2023</a>)</cite> prompt the LLM to write executable code and leverage an interpreter to execute code for obtaining the final result. Besides, prompting the LLM to decompose the question before answering it <cite class="ltx_cite ltx_citemacro_citep">(Radhakrishnan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib26" title="">2023</a>; Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib44" title="">2023</a>)</cite>, or to verify the solution before returning it as the final answer <cite class="ltx_cite ltx_citemacro_citep">(Madaan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib22" title="">2024</a>)</cite>, has also been proven effective in specific reasoning tasks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, both types of approaches suffer from a critical limitation, i.e., being unable to <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">dynamically decide the best reasoning strategies</em>. For instruction-tuning-based approaches, the fine-tuned LLMs are constrained to follow the same reasoning format of the training data (e.g., CoT <cite class="ltx_cite ltx_citemacro_citep">(Luo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib19" title="">2023</a>)</cite>) and lack the flexibility to adopt other reasoning strategies.
An example revealing a similar weakness of GPT-4o is shown in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#A2" title="Appendix B Case Study ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">B</span></a>.
On the other hand, current prompt engineering approaches assume predefined prompting strategies and uniformly apply the same to every question. However, different types of questions are better suited to different reasoning strategies <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib41" title="">2023</a>)</cite>, and the effectiveness of a prompting approach also depends on the inherent capability of the task-solving LLM (e.g., LLMs pre-trained on code data are better at programming-aided reasoning). Consequently, the same prompt may not be equally effective for every question and every LLM.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="389" id="S1.F1.g1" src="x1.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>A comparison of different paradigms of LLM reasoning.
Unlike prior approaches with predefined, static reasoning actions, <span class="ltx_ERROR undefined" id="S1.F1.13.1">\method</span>dynamically plans for the optimal reasoning trajectory per each question and the specific task-solving LLM (<math alttext="LLM_{s}" class="ltx_Math" display="inline" id="S1.F1.6.m1.1"><semantics id="S1.F1.6.m1.1b"><mrow id="S1.F1.6.m1.1.1" xref="S1.F1.6.m1.1.1.cmml"><mi id="S1.F1.6.m1.1.1.2" xref="S1.F1.6.m1.1.1.2.cmml">L</mi><mo id="S1.F1.6.m1.1.1.1" xref="S1.F1.6.m1.1.1.1.cmml">⁢</mo><mi id="S1.F1.6.m1.1.1.3" xref="S1.F1.6.m1.1.1.3.cmml">L</mi><mo id="S1.F1.6.m1.1.1.1b" xref="S1.F1.6.m1.1.1.1.cmml">⁢</mo><msub id="S1.F1.6.m1.1.1.4" xref="S1.F1.6.m1.1.1.4.cmml"><mi id="S1.F1.6.m1.1.1.4.2" xref="S1.F1.6.m1.1.1.4.2.cmml">M</mi><mi id="S1.F1.6.m1.1.1.4.3" xref="S1.F1.6.m1.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.6.m1.1c"><apply id="S1.F1.6.m1.1.1.cmml" xref="S1.F1.6.m1.1.1"><times id="S1.F1.6.m1.1.1.1.cmml" xref="S1.F1.6.m1.1.1.1"></times><ci id="S1.F1.6.m1.1.1.2.cmml" xref="S1.F1.6.m1.1.1.2">𝐿</ci><ci id="S1.F1.6.m1.1.1.3.cmml" xref="S1.F1.6.m1.1.1.3">𝐿</ci><apply id="S1.F1.6.m1.1.1.4.cmml" xref="S1.F1.6.m1.1.1.4"><csymbol cd="ambiguous" id="S1.F1.6.m1.1.1.4.1.cmml" xref="S1.F1.6.m1.1.1.4">subscript</csymbol><ci id="S1.F1.6.m1.1.1.4.2.cmml" xref="S1.F1.6.m1.1.1.4.2">𝑀</ci><ci id="S1.F1.6.m1.1.1.4.3.cmml" xref="S1.F1.6.m1.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m1.1d">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.6.m1.1e">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>). In particular, <span class="ltx_ERROR undefined" id="S1.F1.14.2">\method</span>encompasses two inference setups, i.e., external planner tuning (c) and internalized planner tuning (d), depending on whether to introduce an external LLM as a planner (<math alttext="LLM_{p}" class="ltx_Math" display="inline" id="S1.F1.7.m2.1"><semantics id="S1.F1.7.m2.1b"><mrow id="S1.F1.7.m2.1.1" xref="S1.F1.7.m2.1.1.cmml"><mi id="S1.F1.7.m2.1.1.2" xref="S1.F1.7.m2.1.1.2.cmml">L</mi><mo id="S1.F1.7.m2.1.1.1" xref="S1.F1.7.m2.1.1.1.cmml">⁢</mo><mi id="S1.F1.7.m2.1.1.3" xref="S1.F1.7.m2.1.1.3.cmml">L</mi><mo id="S1.F1.7.m2.1.1.1b" xref="S1.F1.7.m2.1.1.1.cmml">⁢</mo><msub id="S1.F1.7.m2.1.1.4" xref="S1.F1.7.m2.1.1.4.cmml"><mi id="S1.F1.7.m2.1.1.4.2" xref="S1.F1.7.m2.1.1.4.2.cmml">M</mi><mi id="S1.F1.7.m2.1.1.4.3" xref="S1.F1.7.m2.1.1.4.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.7.m2.1c"><apply id="S1.F1.7.m2.1.1.cmml" xref="S1.F1.7.m2.1.1"><times id="S1.F1.7.m2.1.1.1.cmml" xref="S1.F1.7.m2.1.1.1"></times><ci id="S1.F1.7.m2.1.1.2.cmml" xref="S1.F1.7.m2.1.1.2">𝐿</ci><ci id="S1.F1.7.m2.1.1.3.cmml" xref="S1.F1.7.m2.1.1.3">𝐿</ci><apply id="S1.F1.7.m2.1.1.4.cmml" xref="S1.F1.7.m2.1.1.4"><csymbol cd="ambiguous" id="S1.F1.7.m2.1.1.4.1.cmml" xref="S1.F1.7.m2.1.1.4">subscript</csymbol><ci id="S1.F1.7.m2.1.1.4.2.cmml" xref="S1.F1.7.m2.1.1.4.2">𝑀</ci><ci id="S1.F1.7.m2.1.1.4.3.cmml" xref="S1.F1.7.m2.1.1.4.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.7.m2.1d">LLM_{p}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.7.m2.1e">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>) or to internalize the trajectory planning capability into the same solver LLM (<math alttext="LLM_{s}" class="ltx_Math" display="inline" id="S1.F1.8.m3.1"><semantics id="S1.F1.8.m3.1b"><mrow id="S1.F1.8.m3.1.1" xref="S1.F1.8.m3.1.1.cmml"><mi id="S1.F1.8.m3.1.1.2" xref="S1.F1.8.m3.1.1.2.cmml">L</mi><mo id="S1.F1.8.m3.1.1.1" xref="S1.F1.8.m3.1.1.1.cmml">⁢</mo><mi id="S1.F1.8.m3.1.1.3" xref="S1.F1.8.m3.1.1.3.cmml">L</mi><mo id="S1.F1.8.m3.1.1.1b" xref="S1.F1.8.m3.1.1.1.cmml">⁢</mo><msub id="S1.F1.8.m3.1.1.4" xref="S1.F1.8.m3.1.1.4.cmml"><mi id="S1.F1.8.m3.1.1.4.2" xref="S1.F1.8.m3.1.1.4.2.cmml">M</mi><mi id="S1.F1.8.m3.1.1.4.3" xref="S1.F1.8.m3.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.8.m3.1c"><apply id="S1.F1.8.m3.1.1.cmml" xref="S1.F1.8.m3.1.1"><times id="S1.F1.8.m3.1.1.1.cmml" xref="S1.F1.8.m3.1.1.1"></times><ci id="S1.F1.8.m3.1.1.2.cmml" xref="S1.F1.8.m3.1.1.2">𝐿</ci><ci id="S1.F1.8.m3.1.1.3.cmml" xref="S1.F1.8.m3.1.1.3">𝐿</ci><apply id="S1.F1.8.m3.1.1.4.cmml" xref="S1.F1.8.m3.1.1.4"><csymbol cd="ambiguous" id="S1.F1.8.m3.1.1.4.1.cmml" xref="S1.F1.8.m3.1.1.4">subscript</csymbol><ci id="S1.F1.8.m3.1.1.4.2.cmml" xref="S1.F1.8.m3.1.1.4.2">𝑀</ci><ci id="S1.F1.8.m3.1.1.4.3.cmml" xref="S1.F1.8.m3.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.8.m3.1d">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.8.m3.1e">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>). (<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="11" id="S1.F1.9.g1" src="extracted/5902671/figures/red-llm.png" width="11"/>: tunable; <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="11" id="S1.F1.10.g2" src="extracted/5902671/figures/blue-llm.png" width="11"/>: frozen)</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this paper, we present <span class="ltx_ERROR undefined" id="S1.p3.1.1">\method</span>, an approach empowering LLMs to actively select optimal reasoning actions for given questions and the task-solving LLM (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">1</span></a>).
We begin by constructing atomic reasoning action modules, which are composed to generate multiple potential reasoning action trajectories. Then we collect the training data by searching for an optimal (in terms of both its success rate and the number of reasoning actions needed) action trajectory through numerous explorations and evaluations. This optimal trajectory is tailored to the specific task-solving LLM.
Subsequently, we employ supervised fine-tuning to train an LLM in determining the optimal reasoning action trajectory. We implement this approach in two distinct setups: (1) For closed-source or computationally costly task-solving LLMs, we fine-tune a smaller LLM as an external planner to predict optimal reasoning actions for the task-solving LLM; (2) For open-source and small-size LLMs, we fine-tune the task-solving LLM itself to plan on the reasoning actions to take before solving the reasoning task, internalizing the autonomous planning capability directly into the LLM. This dual approach allows for flexible application across different LLM accessibility constraints.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Our experimental results demonstrate the efficacy of our proposed method in enhancing the reasoning capabilities of LLMs. We conducted extensive evaluations across multiple LLMs (GPT-4o-mini, Llama3-70B-Instruct, and Llama3-8B-instruct <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib10" title="">2024</a>)</cite>) and a diverse set of reasoning tasks, encompassing in-distribution, few-shot, and out-of-distribution scenarios. The results reveal that <span class="ltx_ERROR undefined" id="S1.p4.1.1">\method</span>consistently outperforms static prompt engineering techniques and vanilla instruction tuning methods across various reasoning challenges. Through a comprehensive ablation study, we validate the significance of each component in our methodology.
Moreover, our analysis of reasoning action distributions highlights that our method can adapt to the specific characteristics of reasoning questions and the inherent capability of task-solving LLMs.
We further confirm that our method incurs minimal additional financial costs. Lastly, we showcase that LLMs can naturally develop the capacity to allocate more computational resources to complex problems through a process of exploration and learning, without explicit guidance.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span class="ltx_ERROR undefined" id="S2.1.1">\method</span>: Learning to Reason Dynamically</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Overview</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.6">Our goal is to enable LLMs to select the most effective reasoning actions autonomously.
Denote <math alttext="LLM_{s}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">L</mi><mo id="S2.SS1.p1.1.m1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">L</mi><mo id="S2.SS1.p1.1.m1.1.1.1a" xref="S2.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><msub id="S2.SS1.p1.1.m1.1.1.4" xref="S2.SS1.p1.1.m1.1.1.4.cmml"><mi id="S2.SS1.p1.1.m1.1.1.4.2" xref="S2.SS1.p1.1.m1.1.1.4.2.cmml">M</mi><mi id="S2.SS1.p1.1.m1.1.1.4.3" xref="S2.SS1.p1.1.m1.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><times id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1"></times><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝐿</ci><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝐿</ci><apply id="S2.SS1.p1.1.m1.1.1.4.cmml" xref="S2.SS1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.4.1.cmml" xref="S2.SS1.p1.1.m1.1.1.4">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.4.2.cmml" xref="S2.SS1.p1.1.m1.1.1.4.2">𝑀</ci><ci id="S2.SS1.p1.1.m1.1.1.4.3.cmml" xref="S2.SS1.p1.1.m1.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> as the task-solving LLM, <math alttext="Q" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_Q</annotation></semantics></math> as the input query, <math alttext="p" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_p</annotation></semantics></math> as the reasoning action trajectory path, <math alttext="E" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">E</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_E</annotation></semantics></math> as the explanation for a trajectory, and <math alttext="R" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">R</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_R</annotation></semantics></math> as the reasoning process leading to the final answer <math alttext="y" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_y</annotation></semantics></math>. Our approach encompasses two setups during the inference stage (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">1</span></a>):</p>
</div>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">External Planner Tuning</h4>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p1.2">This setup is designed for scenarios where the solver (<math alttext="LLM_{s}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="S2.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">L</mi><mo id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.1" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml">L</mi><mo id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.1a" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.cmml"><mi id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.2" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.2.cmml">M</mi><mi id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.3" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1"><times id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.1"></times><ci id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.2">𝐿</ci><ci id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.3">𝐿</ci><apply id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.1.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.2.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.2">𝑀</ci><ci id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.3.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.1.m1.1c">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.1.m1.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>) is a closed-source LLM or is computationally costly to train. As depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">1</span></a> (c), we train an external planner, denoted as <math alttext="LLM_{p}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="S2.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">L</mi><mo id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.1" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">L</mi><mo id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.1a" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.cmml"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.2" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.2.cmml">M</mi><mi id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.3" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1"><times id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.1"></times><ci id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.2">𝐿</ci><ci id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.3">𝐿</ci><apply id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.2.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.2">𝑀</ci><ci id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.3.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.4.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.2.m2.1c">LLM_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.2.m2.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, to determine the optimal reasoning actions:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="(E,p)=\text{$LLM_{p}$}(Q;\theta_{p})" class="ltx_Math" display="block" id="S2.E1.m1.5"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml"><mrow id="S2.E1.m1.5.5.3.2" xref="S2.E1.m1.5.5.3.1.cmml"><mo id="S2.E1.m1.5.5.3.2.1" stretchy="false" xref="S2.E1.m1.5.5.3.1.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">E</mi><mo id="S2.E1.m1.5.5.3.2.2" xref="S2.E1.m1.5.5.3.1.cmml">,</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">p</mi><mo id="S2.E1.m1.5.5.3.2.3" stretchy="false" xref="S2.E1.m1.5.5.3.1.cmml">)</mo></mrow><mo id="S2.E1.m1.5.5.2" xref="S2.E1.m1.5.5.2.cmml">=</mo><mrow id="S2.E1.m1.5.5.1" xref="S2.E1.m1.5.5.1.cmml"><mi id="S2.E1.m1.5.5.1.3" xref="S2.E1.m1.5.5.1.3.cmml">L</mi><mo id="S2.E1.m1.5.5.1.2" xref="S2.E1.m1.5.5.1.2.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.4" xref="S2.E1.m1.5.5.1.4.cmml">L</mi><mo id="S2.E1.m1.5.5.1.2a" xref="S2.E1.m1.5.5.1.2.cmml">⁢</mo><msub id="S2.E1.m1.5.5.1.5" xref="S2.E1.m1.5.5.1.5.cmml"><mi id="S2.E1.m1.5.5.1.5.2" xref="S2.E1.m1.5.5.1.5.2.cmml">M</mi><mi id="S2.E1.m1.5.5.1.5.3" xref="S2.E1.m1.5.5.1.5.3.cmml">p</mi></msub><mo id="S2.E1.m1.5.5.1.2b" xref="S2.E1.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.5.5.1.1.1" xref="S2.E1.m1.5.5.1.1.2.cmml"><mo id="S2.E1.m1.5.5.1.1.1.2" stretchy="false" xref="S2.E1.m1.5.5.1.1.2.cmml">(</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">Q</mi><mo id="S2.E1.m1.5.5.1.1.1.3" xref="S2.E1.m1.5.5.1.1.2.cmml">;</mo><msub id="S2.E1.m1.5.5.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.2.cmml">θ</mi><mi id="S2.E1.m1.5.5.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.3.cmml">p</mi></msub><mo id="S2.E1.m1.5.5.1.1.1.4" stretchy="false" xref="S2.E1.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5"><eq id="S2.E1.m1.5.5.2.cmml" xref="S2.E1.m1.5.5.2"></eq><interval closure="open" id="S2.E1.m1.5.5.3.1.cmml" xref="S2.E1.m1.5.5.3.2"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝐸</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑝</ci></interval><apply id="S2.E1.m1.5.5.1.cmml" xref="S2.E1.m1.5.5.1"><times id="S2.E1.m1.5.5.1.2.cmml" xref="S2.E1.m1.5.5.1.2"></times><ci id="S2.E1.m1.5.5.1.3.cmml" xref="S2.E1.m1.5.5.1.3">𝐿</ci><ci id="S2.E1.m1.5.5.1.4.cmml" xref="S2.E1.m1.5.5.1.4">𝐿</ci><apply id="S2.E1.m1.5.5.1.5.cmml" xref="S2.E1.m1.5.5.1.5"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.5.1.cmml" xref="S2.E1.m1.5.5.1.5">subscript</csymbol><ci id="S2.E1.m1.5.5.1.5.2.cmml" xref="S2.E1.m1.5.5.1.5.2">𝑀</ci><ci id="S2.E1.m1.5.5.1.5.3.cmml" xref="S2.E1.m1.5.5.1.5.3">𝑝</ci></apply><list id="S2.E1.m1.5.5.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1"><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑄</ci><apply id="S2.E1.m1.5.5.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2">𝜃</ci><ci id="S2.E1.m1.5.5.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3">𝑝</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">(E,p)=\text{$LLM_{p}$}(Q;\theta_{p})</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.5d">( italic_E , italic_p ) = italic_L italic_L italic_M start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_Q ; italic_θ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p1.9">where <math alttext="\theta_{p}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.3.m1.1"><semantics id="S2.SS1.SSS0.Px1.p1.3.m1.1a"><msub id="S2.SS1.SSS0.Px1.p1.3.m1.1.1" xref="S2.SS1.SSS0.Px1.p1.3.m1.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.3.m1.1.1.2" xref="S2.SS1.SSS0.Px1.p1.3.m1.1.1.2.cmml">θ</mi><mi id="S2.SS1.SSS0.Px1.p1.3.m1.1.1.3" xref="S2.SS1.SSS0.Px1.p1.3.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.3.m1.1b"><apply id="S2.SS1.SSS0.Px1.p1.3.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.3.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.3.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m1.1.1.2">𝜃</ci><ci id="S2.SS1.SSS0.Px1.p1.3.m1.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.3.m1.1c">\theta_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.3.m1.1d">italic_θ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> is the parameters of <math alttext="LLM_{p}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.4.m2.1"><semantics id="S2.SS1.SSS0.Px1.p1.4.m2.1a"><mrow id="S2.SS1.SSS0.Px1.p1.4.m2.1.1" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.2" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.2.cmml">L</mi><mo id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.1" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.3" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.3.cmml">L</mi><mo id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.1a" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.cmml"><mi id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.2" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.2.cmml">M</mi><mi id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.3" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.4.m2.1b"><apply id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1"><times id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.1"></times><ci id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.2">𝐿</ci><ci id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.3">𝐿</ci><apply id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.1.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.2.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.2">𝑀</ci><ci id="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.3.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m2.1.1.4.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.4.m2.1c">LLM_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.4.m2.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>. We empirically found that training the planner to explain its trajectory selection (<math alttext="E" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.5.m3.1"><semantics id="S2.SS1.SSS0.Px1.p1.5.m3.1a"><mi id="S2.SS1.SSS0.Px1.p1.5.m3.1.1" xref="S2.SS1.SSS0.Px1.p1.5.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.5.m3.1b"><ci id="S2.SS1.SSS0.Px1.p1.5.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.5.m3.1c">E</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.5.m3.1d">italic_E</annotation></semantics></math>) helps its learning.
Upon obtaining reasoning actions, the solver <math alttext="LLM_{s}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.6.m4.1"><semantics id="S2.SS1.SSS0.Px1.p1.6.m4.1a"><mrow id="S2.SS1.SSS0.Px1.p1.6.m4.1.1" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.2" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.2.cmml">L</mi><mo id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.1" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.3" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.3.cmml">L</mi><mo id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.1a" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.cmml"><mi id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.2" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.2.cmml">M</mi><mi id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.3" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.6.m4.1b"><apply id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1"><times id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.1"></times><ci id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.2">𝐿</ci><ci id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.3">𝐿</ci><apply id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.2.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.2">𝑀</ci><ci id="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.3.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m4.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.6.m4.1c">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.6.m4.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> parameterized by <math alttext="\theta_{s}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.7.m5.1"><semantics id="S2.SS1.SSS0.Px1.p1.7.m5.1a"><msub id="S2.SS1.SSS0.Px1.p1.7.m5.1.1" xref="S2.SS1.SSS0.Px1.p1.7.m5.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.7.m5.1.1.2" xref="S2.SS1.SSS0.Px1.p1.7.m5.1.1.2.cmml">θ</mi><mi id="S2.SS1.SSS0.Px1.p1.7.m5.1.1.3" xref="S2.SS1.SSS0.Px1.p1.7.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.7.m5.1b"><apply id="S2.SS1.SSS0.Px1.p1.7.m5.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.7.m5.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m5.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.7.m5.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m5.1.1.2">𝜃</ci><ci id="S2.SS1.SSS0.Px1.p1.7.m5.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.7.m5.1c">\theta_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.7.m5.1d">italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> then proceeds to generate the reasoning process <math alttext="R" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.8.m6.1"><semantics id="S2.SS1.SSS0.Px1.p1.8.m6.1a"><mi id="S2.SS1.SSS0.Px1.p1.8.m6.1.1" xref="S2.SS1.SSS0.Px1.p1.8.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.8.m6.1b"><ci id="S2.SS1.SSS0.Px1.p1.8.m6.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.8.m6.1c">R</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.8.m6.1d">italic_R</annotation></semantics></math> and the final answer <math alttext="y" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.9.m7.1"><semantics id="S2.SS1.SSS0.Px1.p1.9.m7.1a"><mi id="S2.SS1.SSS0.Px1.p1.9.m7.1.1" xref="S2.SS1.SSS0.Px1.p1.9.m7.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.9.m7.1b"><ci id="S2.SS1.SSS0.Px1.p1.9.m7.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.9.m7.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.9.m7.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.9.m7.1d">italic_y</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="(R,y)=\text{$LLM_{s}$}(Q,T;\theta_{s})" class="ltx_Math" display="block" id="S2.E2.m1.6"><semantics id="S2.E2.m1.6a"><mrow id="S2.E2.m1.6.6" xref="S2.E2.m1.6.6.cmml"><mrow id="S2.E2.m1.6.6.3.2" xref="S2.E2.m1.6.6.3.1.cmml"><mo id="S2.E2.m1.6.6.3.2.1" stretchy="false" xref="S2.E2.m1.6.6.3.1.cmml">(</mo><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">R</mi><mo id="S2.E2.m1.6.6.3.2.2" xref="S2.E2.m1.6.6.3.1.cmml">,</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">y</mi><mo id="S2.E2.m1.6.6.3.2.3" stretchy="false" xref="S2.E2.m1.6.6.3.1.cmml">)</mo></mrow><mo id="S2.E2.m1.6.6.2" xref="S2.E2.m1.6.6.2.cmml">=</mo><mrow id="S2.E2.m1.6.6.1" xref="S2.E2.m1.6.6.1.cmml"><mi id="S2.E2.m1.6.6.1.3" xref="S2.E2.m1.6.6.1.3.cmml">L</mi><mo id="S2.E2.m1.6.6.1.2" xref="S2.E2.m1.6.6.1.2.cmml">⁢</mo><mi id="S2.E2.m1.6.6.1.4" xref="S2.E2.m1.6.6.1.4.cmml">L</mi><mo id="S2.E2.m1.6.6.1.2a" xref="S2.E2.m1.6.6.1.2.cmml">⁢</mo><msub id="S2.E2.m1.6.6.1.5" xref="S2.E2.m1.6.6.1.5.cmml"><mi id="S2.E2.m1.6.6.1.5.2" xref="S2.E2.m1.6.6.1.5.2.cmml">M</mi><mi id="S2.E2.m1.6.6.1.5.3" xref="S2.E2.m1.6.6.1.5.3.cmml">s</mi></msub><mo id="S2.E2.m1.6.6.1.2b" xref="S2.E2.m1.6.6.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.1.1" xref="S2.E2.m1.6.6.1.1.2.cmml"><mo id="S2.E2.m1.6.6.1.1.1.2" stretchy="false" xref="S2.E2.m1.6.6.1.1.2.cmml">(</mo><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">Q</mi><mo id="S2.E2.m1.6.6.1.1.1.3" xref="S2.E2.m1.6.6.1.1.2.cmml">,</mo><mi id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml">T</mi><mo id="S2.E2.m1.6.6.1.1.1.4" xref="S2.E2.m1.6.6.1.1.2.cmml">;</mo><msub id="S2.E2.m1.6.6.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.2.cmml">θ</mi><mi id="S2.E2.m1.6.6.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.E2.m1.6.6.1.1.1.5" stretchy="false" xref="S2.E2.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.6b"><apply id="S2.E2.m1.6.6.cmml" xref="S2.E2.m1.6.6"><eq id="S2.E2.m1.6.6.2.cmml" xref="S2.E2.m1.6.6.2"></eq><interval closure="open" id="S2.E2.m1.6.6.3.1.cmml" xref="S2.E2.m1.6.6.3.2"><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝑅</ci><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝑦</ci></interval><apply id="S2.E2.m1.6.6.1.cmml" xref="S2.E2.m1.6.6.1"><times id="S2.E2.m1.6.6.1.2.cmml" xref="S2.E2.m1.6.6.1.2"></times><ci id="S2.E2.m1.6.6.1.3.cmml" xref="S2.E2.m1.6.6.1.3">𝐿</ci><ci id="S2.E2.m1.6.6.1.4.cmml" xref="S2.E2.m1.6.6.1.4">𝐿</ci><apply id="S2.E2.m1.6.6.1.5.cmml" xref="S2.E2.m1.6.6.1.5"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.5.1.cmml" xref="S2.E2.m1.6.6.1.5">subscript</csymbol><ci id="S2.E2.m1.6.6.1.5.2.cmml" xref="S2.E2.m1.6.6.1.5.2">𝑀</ci><ci id="S2.E2.m1.6.6.1.5.3.cmml" xref="S2.E2.m1.6.6.1.5.3">𝑠</ci></apply><vector id="S2.E2.m1.6.6.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1"><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">𝑄</ci><ci id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5">𝑇</ci><apply id="S2.E2.m1.6.6.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.2">𝜃</ci><ci id="S2.E2.m1.6.6.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.3">𝑠</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.6c">(R,y)=\text{$LLM_{s}$}(Q,T;\theta_{s})</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.6d">( italic_R , italic_y ) = italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( italic_Q , italic_T ; italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Internalized Planner Tuning</h4>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px2.p1.2">This setup is designed for task-solving LLMs (<math alttext="LLM_{s}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S2.SS1.SSS0.Px2.p1.1.m1.1a"><mrow id="S2.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">L</mi><mo id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.1" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">L</mi><mo id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.1a" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.cmml"><mi id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.2" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.2.cmml">M</mi><mi id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.3" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1"><times id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.1"></times><ci id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.2">𝐿</ci><ci id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.3">𝐿</ci><apply id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.cmml" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.1.cmml" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.2.cmml" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.2">𝑀</ci><ci id="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.3.cmml" xref="S2.SS1.SSS0.Px2.p1.1.m1.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p1.1.m1.1c">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p1.1.m1.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>) that are open-source and small-size. In this case, we propose to <em class="ltx_emph ltx_font_italic" id="S2.SS1.SSS0.Px2.p1.2.1">internalize</em> the trajectory planning capability into the task-solving LLM by training it to simultaneously learn to plan and learn to perform the reasoning task.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">1</span></a> (d), the final answer <math alttext="y" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px2.p1.2.m2.1"><semantics id="S2.SS1.SSS0.Px2.p1.2.m2.1a"><mi id="S2.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S2.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px2.p1.2.m2.1b"><ci id="S2.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px2.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px2.p1.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px2.p1.2.m2.1d">italic_y</annotation></semantics></math> is obtained by:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="(E,p,R,y)=\text{$LLM_{s}$}(Q;\theta_{s})" class="ltx_Math" display="block" id="S2.E3.m1.7"><semantics id="S2.E3.m1.7a"><mrow id="S2.E3.m1.7.7" xref="S2.E3.m1.7.7.cmml"><mrow id="S2.E3.m1.7.7.3.2" xref="S2.E3.m1.7.7.3.1.cmml"><mo id="S2.E3.m1.7.7.3.2.1" stretchy="false" xref="S2.E3.m1.7.7.3.1.cmml">(</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">E</mi><mo id="S2.E3.m1.7.7.3.2.2" xref="S2.E3.m1.7.7.3.1.cmml">,</mo><mi id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">p</mi><mo id="S2.E3.m1.7.7.3.2.3" xref="S2.E3.m1.7.7.3.1.cmml">,</mo><mi id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml">R</mi><mo id="S2.E3.m1.7.7.3.2.4" xref="S2.E3.m1.7.7.3.1.cmml">,</mo><mi id="S2.E3.m1.5.5" xref="S2.E3.m1.5.5.cmml">y</mi><mo id="S2.E3.m1.7.7.3.2.5" stretchy="false" xref="S2.E3.m1.7.7.3.1.cmml">)</mo></mrow><mo id="S2.E3.m1.7.7.2" xref="S2.E3.m1.7.7.2.cmml">=</mo><mrow id="S2.E3.m1.7.7.1" xref="S2.E3.m1.7.7.1.cmml"><mi id="S2.E3.m1.7.7.1.3" xref="S2.E3.m1.7.7.1.3.cmml">L</mi><mo id="S2.E3.m1.7.7.1.2" xref="S2.E3.m1.7.7.1.2.cmml">⁢</mo><mi id="S2.E3.m1.7.7.1.4" xref="S2.E3.m1.7.7.1.4.cmml">L</mi><mo id="S2.E3.m1.7.7.1.2a" xref="S2.E3.m1.7.7.1.2.cmml">⁢</mo><msub id="S2.E3.m1.7.7.1.5" xref="S2.E3.m1.7.7.1.5.cmml"><mi id="S2.E3.m1.7.7.1.5.2" xref="S2.E3.m1.7.7.1.5.2.cmml">M</mi><mi id="S2.E3.m1.7.7.1.5.3" xref="S2.E3.m1.7.7.1.5.3.cmml">s</mi></msub><mo id="S2.E3.m1.7.7.1.2b" xref="S2.E3.m1.7.7.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.7.7.1.1.1" xref="S2.E3.m1.7.7.1.1.2.cmml"><mo id="S2.E3.m1.7.7.1.1.1.2" stretchy="false" xref="S2.E3.m1.7.7.1.1.2.cmml">(</mo><mi id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml">Q</mi><mo id="S2.E3.m1.7.7.1.1.1.3" xref="S2.E3.m1.7.7.1.1.2.cmml">;</mo><msub id="S2.E3.m1.7.7.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.cmml"><mi id="S2.E3.m1.7.7.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.2.cmml">θ</mi><mi id="S2.E3.m1.7.7.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.E3.m1.7.7.1.1.1.4" stretchy="false" xref="S2.E3.m1.7.7.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.7b"><apply id="S2.E3.m1.7.7.cmml" xref="S2.E3.m1.7.7"><eq id="S2.E3.m1.7.7.2.cmml" xref="S2.E3.m1.7.7.2"></eq><vector id="S2.E3.m1.7.7.3.1.cmml" xref="S2.E3.m1.7.7.3.2"><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝐸</ci><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">𝑝</ci><ci id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4">𝑅</ci><ci id="S2.E3.m1.5.5.cmml" xref="S2.E3.m1.5.5">𝑦</ci></vector><apply id="S2.E3.m1.7.7.1.cmml" xref="S2.E3.m1.7.7.1"><times id="S2.E3.m1.7.7.1.2.cmml" xref="S2.E3.m1.7.7.1.2"></times><ci id="S2.E3.m1.7.7.1.3.cmml" xref="S2.E3.m1.7.7.1.3">𝐿</ci><ci id="S2.E3.m1.7.7.1.4.cmml" xref="S2.E3.m1.7.7.1.4">𝐿</ci><apply id="S2.E3.m1.7.7.1.5.cmml" xref="S2.E3.m1.7.7.1.5"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.5.1.cmml" xref="S2.E3.m1.7.7.1.5">subscript</csymbol><ci id="S2.E3.m1.7.7.1.5.2.cmml" xref="S2.E3.m1.7.7.1.5.2">𝑀</ci><ci id="S2.E3.m1.7.7.1.5.3.cmml" xref="S2.E3.m1.7.7.1.5.3">𝑠</ci></apply><list id="S2.E3.m1.7.7.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1"><ci id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6">𝑄</ci><apply id="S2.E3.m1.7.7.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2">𝜃</ci><ci id="S2.E3.m1.7.7.1.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3">𝑠</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.7c">(E,p,R,y)=\text{$LLM_{s}$}(Q;\theta_{s})</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.7d">( italic_E , italic_p , italic_R , italic_y ) = italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( italic_Q ; italic_θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS0.Px2.p1.3">An overview of <span class="ltx_ERROR undefined" id="S2.SS1.SSS0.Px2.p1.3.1">\method</span>’s learning process is presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.F2" title="Figure 2 ‣ Internalized Planner Tuning ‣ 2.1 Overview ‣ 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">2</span></a>, consisting of three key steps: (i) <span class="ltx_text ltx_font_bold" id="S2.SS1.SSS0.Px2.p1.3.2">Defining atomic reasoning modules:</span> We define several atomic reasoning modules, each representing a distinct reasoning action, (ii) <span class="ltx_text ltx_font_bold" id="S2.SS1.SSS0.Px2.p1.3.3">Searching for optimal action trajectories:</span> We conduct explorations and evaluation of various reasoning paths to identify optimal reasoning actions for questions in the training data, and (iii) <span class="ltx_text ltx_font_bold" id="S2.SS1.SSS0.Px2.p1.3.4">Fine-tuning LLMs to plan for optimal reasoning trajectories:</span>
We fine-tune LLMs to autonomously plan the reasoning action trajectory under the two aforementioned setups.
In what follows, we elaborate on each step.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="501" id="S2.F2.g1" src="x2.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The training process of <span class="ltx_ERROR undefined" id="S2.F2.2.1">\method</span>, including searching for the optimal reasoning trajectories for questions in the training set and fine-tuning the internalized/external planner LLM.
</figcaption>
</figure>
<figure class="ltx_table" id="S2.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Prompt engineering methods with different reasoning actions. Our method could dynamically select reasoning actions among all of them.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S2.T1.1" style="width:357.7pt;height:105.3pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-128.8pt,37.7pt) scale(0.581420963128628,0.581420963128628) ;">
<table class="ltx_tabular ltx_align_middle" id="S2.T1.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S2.T1.1.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S2.T1.1.1.1.1.1.1">Prompting Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S2.T1.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S2.T1.1.1.1.1.2.1">Analysis Layer</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S2.T1.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S2.T1.1.1.1.1.3.1">Solution Layer</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S2.T1.1.1.1.1.4.1">Verification Layer</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.2.2">
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.2.2.1">Rewriting</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.2.2.2">Decomposition</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.2.2.3">NL</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.2.2.4">Program</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.2.2.5">Verification</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S2.T1.1.1.3.3.1">CoT <cite class="ltx_cite ltx_citemacro_citep">(Wei et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib35" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.3.3.2">✗</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.1.1.3.3.3">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.3.3.4"><span class="ltx_text" id="S2.T1.1.1.3.3.4.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.1.1.3.3.5">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.1.1.3.3.6">✗</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.1.4.4.1">PoT <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib6" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.4.4.2">✗</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.4.4.3">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.4.4.4">✗</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.4.4.5"><span class="ltx_text" id="S2.T1.1.1.4.4.5.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.4.4.6">✗</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.1.5.5.1">LTM <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib44" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.5.5.2"><span class="ltx_text" id="S2.T1.1.1.5.5.2.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.5.5.3">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.5.5.4"><span class="ltx_text" id="S2.T1.1.1.5.5.4.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.5.5.5">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.5.5.6">✗</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.1.6.6.1">R&amp;R <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib8" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.6.6.2">✗</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.6.6.3"><span class="ltx_text" id="S2.T1.1.1.6.6.3.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.6.6.4"><span class="ltx_text" id="S2.T1.1.1.6.6.4.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.6.6.5">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.6.6.6">✗</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.7.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.1.7.7.1">Self-Refine <cite class="ltx_cite ltx_citemacro_citep">(Madaan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib22" title="">2024</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.7.7.2">✗</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.7.7.3">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.7.7.4"><span class="ltx_text" id="S2.T1.1.1.7.7.4.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.7.7.5"><span class="ltx_text" id="S2.T1.1.1.7.7.5.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.7.7.6"><span class="ltx_text" id="S2.T1.1.1.7.7.6.1" style="color:#00C400;">✓</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.8.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.1.8.8.1">Self-Verification <cite class="ltx_cite ltx_citemacro_citep">(Weng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib36" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.8.8.2">✗</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.8.8.3">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.8.8.4"><span class="ltx_text" id="S2.T1.1.1.8.8.4.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.8.8.5">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.8.8.6"><span class="ltx_text" id="S2.T1.1.1.8.8.6.1" style="color:#00C400;">✓</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S2.T1.1.1.9.9.1">PromptAgent <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib32" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.9.9.2"><span class="ltx_text" id="S2.T1.1.1.9.9.2.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.9.9.3"><span class="ltx_text" id="S2.T1.1.1.9.9.3.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.9.9.4"><span class="ltx_text" id="S2.T1.1.1.9.9.4.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T1.1.1.9.9.5">✗</td>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.9.9.6">✗</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.1.10.10">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S2.T1.1.1.10.10.1">
<span class="ltx_ERROR undefined" id="S2.T1.1.1.10.10.1.1">\method</span>(<span class="ltx_text ltx_font_bold" id="S2.T1.1.1.10.10.1.2">ours)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.1.1.10.10.2"><span class="ltx_text" id="S2.T1.1.1.10.10.2.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S2.T1.1.1.10.10.3"><span class="ltx_text" id="S2.T1.1.1.10.10.3.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.1.1.10.10.4"><span class="ltx_text" id="S2.T1.1.1.10.10.4.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S2.T1.1.1.10.10.5"><span class="ltx_text" id="S2.T1.1.1.10.10.5.1" style="color:#00C400;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.1.1.10.10.6"><span class="ltx_text" id="S2.T1.1.1.10.10.6.1" style="color:#00C400;">✓</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Defining Atomic Reasoning Actions Modules</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Prior studies have validated the effectiveness of various reasoning strategies (Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.T1" title="Table 1 ‣ Internalized Planner Tuning ‣ 2.1 Overview ‣ 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">1</span></a>). We build on top of them and categorize the existing strategies as reasoning actions across three layers:</p>
</div>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Analysis Layer</h4>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px1.p1.1">Actions in this layer enable the LLM to analyze the input query before attempting to solve it, including
(1) <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS0.Px1.p1.1.1">Query rewriting</span>: reformulating the query to enhance comprehension, and (2) <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS0.Px1.p1.1.2">Query decomposition</span>: breaking down the initial question into multiple, more manageable sub-questions. We denote the action taken in this layer as <math alttext="A_{a}" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS2.SSS0.Px1.p1.1.m1.1a"><msub id="S2.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">A</mi><mi id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝐴</ci><ci id="S2.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS0.Px1.p1.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px1.p1.1.m1.1c">A_{a}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px1.p1.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Solution Layer</h4>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px2.p1.1">Actions in this layer consider variants in the reasoning format. Prior works showed that different queries are better solved following different reasoning processes <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib41" title="">2023</a>)</cite>. In our work, we consider the most commonly adopted formats, i.e.,
(1) <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS0.Px2.p1.1.1">CoT</span>: solving the question step-by-step in natural language, and (2) <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS0.Px2.p1.1.2">PoT</span>: addressing the question through code generation. We denote the action chosen in this layer as <math alttext="A_{t}" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S2.SS2.SSS0.Px2.p1.1.m1.1a"><msub id="S2.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S2.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">A</mi><mi id="S2.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S2.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S2.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝐴</ci><ci id="S2.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS0.Px2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px2.p1.1.m1.1c">A_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px2.p1.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Verification Layer</h4>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px3.p1.1">Finally, the verification layer is responsible for checking the correctness of the proposed solution.
It is particularly useful for problems where verification is significantly easier than solving the problem itself, e.g., the Game of 24 <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib38" title="">2024</a>)</cite>.
Therefore, we set a <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS0.Px3.p1.1.1">Self-Verification</span> action module in this layer.
If this module determines that the reasoning process from the solution layer is incorrect, the LLM will revert to the solution layer to reattempt to solve the problem.
During this reattempt, the LLM is provided with both the initial answer and the feedback from the verifier explaining why the initial answer was incorrect.
The process continues until the verifier confirms that the answer is correct or the pre-defined maximum number of iterations for self-verification is reached.
We denote the action taken in this layer as <math alttext="A_{v}" class="ltx_Math" display="inline" id="S2.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="S2.SS2.SSS0.Px3.p1.1.m1.1a"><msub id="S2.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.2" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml">A</mi><mi id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.3" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px3.p1.1.m1.1b"><apply id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1.2">𝐴</ci><ci id="S2.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS0.Px3.p1.1.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px3.p1.1.m1.1c">A_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS0.Px3.p1.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS0.Px3.p2">
<p class="ltx_p" id="S2.SS2.SSS0.Px3.p2.1">We observe that introducing excessive reasoning actions can lead to increased latency, and even sometimes result in incorrect answers. To mitigate this issue, we introduce an <span class="ltx_text ltx_font_typewriter" id="S2.SS2.SSS0.Px3.p2.1.1">Empty</span> action in both the analysis and the verification layers, allowing the LLM to bypass these two layers when dealing with simple questions. Detailed prompts for each module are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#A4" title="Appendix D Prompts Used in Experiments ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Searching for Optimal Reasoning Action Trajectories</h3>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">To teach the external/internalized planner to plan for the optimal reasoning trajectory, we start by constructing training data containing questions and their optimal action trajectories for the specific task-solving LLM. We obtain this by iteratively searching all possible reasoning trajectories for each question, including exploring the current paths and pruning paths that are unlikely to be optimal. The task-solving LLM is used during this search process to generate answers to make the reasoning trajectory align with their intrinsic ability to perform different reasoning actions effectively.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Searching for the Optimal Reasoning Action Trajectory</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>Input query <math alttext="Q" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_Q</annotation></semantics></math> and ground true answer <math alttext="y^{*}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><msup id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">y</mi><mo id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">superscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑦</ci><times id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">y^{*}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_y start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, solver <math alttext="LLM_{s}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">L</mi><mo id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">L</mi><mo id="alg1.l1.m3.1.1.1a" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><msub id="alg1.l1.m3.1.1.4" xref="alg1.l1.m3.1.1.4.cmml"><mi id="alg1.l1.m3.1.1.4.2" xref="alg1.l1.m3.1.1.4.2.cmml">M</mi><mi id="alg1.l1.m3.1.1.4.3" xref="alg1.l1.m3.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><times id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></times><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝐿</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝐿</ci><apply id="alg1.l1.m3.1.1.4.cmml" xref="alg1.l1.m3.1.1.4"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.4.1.cmml" xref="alg1.l1.m3.1.1.4">subscript</csymbol><ci id="alg1.l1.m3.1.1.4.2.cmml" xref="alg1.l1.m3.1.1.4.2">𝑀</ci><ci id="alg1.l1.m3.1.1.4.3.cmml" xref="alg1.l1.m3.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, max iteration <math alttext="K" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_K</annotation></semantics></math>, number of evaluations <math alttext="N_{eval}" class="ltx_Math" display="inline" id="alg1.l1.m5.1"><semantics id="alg1.l1.m5.1a"><msub id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">N</mi><mrow id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml"><mi id="alg1.l1.m5.1.1.3.2" xref="alg1.l1.m5.1.1.3.2.cmml">e</mi><mo id="alg1.l1.m5.1.1.3.1" xref="alg1.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m5.1.1.3.3" xref="alg1.l1.m5.1.1.3.3.cmml">v</mi><mo id="alg1.l1.m5.1.1.3.1a" xref="alg1.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m5.1.1.3.4" xref="alg1.l1.m5.1.1.3.4.cmml">a</mi><mo id="alg1.l1.m5.1.1.3.1b" xref="alg1.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m5.1.1.3.5" xref="alg1.l1.m5.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">subscript</csymbol><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">𝑁</ci><apply id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3"><times id="alg1.l1.m5.1.1.3.1.cmml" xref="alg1.l1.m5.1.1.3.1"></times><ci id="alg1.l1.m5.1.1.3.2.cmml" xref="alg1.l1.m5.1.1.3.2">𝑒</ci><ci id="alg1.l1.m5.1.1.3.3.cmml" xref="alg1.l1.m5.1.1.3.3">𝑣</ci><ci id="alg1.l1.m5.1.1.3.4.cmml" xref="alg1.l1.m5.1.1.3.4">𝑎</ci><ci id="alg1.l1.m5.1.1.3.5.cmml" xref="alg1.l1.m5.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">N_{eval}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m5.1d">italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, and number of candidate trajectories to retain in each iteration <math alttext="N_{1},N_{2},\cdots,N_{K}" class="ltx_Math" display="inline" id="alg1.l1.m6.4"><semantics id="alg1.l1.m6.4a"><mrow id="alg1.l1.m6.4.4.3" xref="alg1.l1.m6.4.4.4.cmml"><msub id="alg1.l1.m6.2.2.1.1" xref="alg1.l1.m6.2.2.1.1.cmml"><mi id="alg1.l1.m6.2.2.1.1.2" xref="alg1.l1.m6.2.2.1.1.2.cmml">N</mi><mn id="alg1.l1.m6.2.2.1.1.3" xref="alg1.l1.m6.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.l1.m6.4.4.3.4" xref="alg1.l1.m6.4.4.4.cmml">,</mo><msub id="alg1.l1.m6.3.3.2.2" xref="alg1.l1.m6.3.3.2.2.cmml"><mi id="alg1.l1.m6.3.3.2.2.2" xref="alg1.l1.m6.3.3.2.2.2.cmml">N</mi><mn id="alg1.l1.m6.3.3.2.2.3" xref="alg1.l1.m6.3.3.2.2.3.cmml">2</mn></msub><mo id="alg1.l1.m6.4.4.3.5" xref="alg1.l1.m6.4.4.4.cmml">,</mo><mi id="alg1.l1.m6.1.1" mathvariant="normal" xref="alg1.l1.m6.1.1.cmml">⋯</mi><mo id="alg1.l1.m6.4.4.3.6" xref="alg1.l1.m6.4.4.4.cmml">,</mo><msub id="alg1.l1.m6.4.4.3.3" xref="alg1.l1.m6.4.4.3.3.cmml"><mi id="alg1.l1.m6.4.4.3.3.2" xref="alg1.l1.m6.4.4.3.3.2.cmml">N</mi><mi id="alg1.l1.m6.4.4.3.3.3" xref="alg1.l1.m6.4.4.3.3.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.4b"><list id="alg1.l1.m6.4.4.4.cmml" xref="alg1.l1.m6.4.4.3"><apply id="alg1.l1.m6.2.2.1.1.cmml" xref="alg1.l1.m6.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m6.2.2.1.1.1.cmml" xref="alg1.l1.m6.2.2.1.1">subscript</csymbol><ci id="alg1.l1.m6.2.2.1.1.2.cmml" xref="alg1.l1.m6.2.2.1.1.2">𝑁</ci><cn id="alg1.l1.m6.2.2.1.1.3.cmml" type="integer" xref="alg1.l1.m6.2.2.1.1.3">1</cn></apply><apply id="alg1.l1.m6.3.3.2.2.cmml" xref="alg1.l1.m6.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l1.m6.3.3.2.2.1.cmml" xref="alg1.l1.m6.3.3.2.2">subscript</csymbol><ci id="alg1.l1.m6.3.3.2.2.2.cmml" xref="alg1.l1.m6.3.3.2.2.2">𝑁</ci><cn id="alg1.l1.m6.3.3.2.2.3.cmml" type="integer" xref="alg1.l1.m6.3.3.2.2.3">2</cn></apply><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">⋯</ci><apply id="alg1.l1.m6.4.4.3.3.cmml" xref="alg1.l1.m6.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l1.m6.4.4.3.3.1.cmml" xref="alg1.l1.m6.4.4.3.3">subscript</csymbol><ci id="alg1.l1.m6.4.4.3.3.2.cmml" xref="alg1.l1.m6.4.4.3.3.2">𝑁</ci><ci id="alg1.l1.m6.4.4.3.3.3.cmml" xref="alg1.l1.m6.4.4.3.3.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.4c">N_{1},N_{2},\cdots,N_{K}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m6.4d">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_N start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>Optimal action trajectory path <math alttext="p^{*}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">p</mi><mo id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑝</ci><times id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">p^{*}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_p start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> for query <math alttext="Q" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_Q</annotation></semantics></math> and solver <math alttext="LLM_{s}" class="ltx_Math" display="inline" id="alg1.l2.m3.1"><semantics id="alg1.l2.m3.1a"><mrow id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mi id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml">L</mi><mo id="alg1.l2.m3.1.1.1" xref="alg1.l2.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml">L</mi><mo id="alg1.l2.m3.1.1.1a" xref="alg1.l2.m3.1.1.1.cmml">⁢</mo><msub id="alg1.l2.m3.1.1.4" xref="alg1.l2.m3.1.1.4.cmml"><mi id="alg1.l2.m3.1.1.4.2" xref="alg1.l2.m3.1.1.4.2.cmml">M</mi><mi id="alg1.l2.m3.1.1.4.3" xref="alg1.l2.m3.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><times id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1.1"></times><ci id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2">𝐿</ci><ci id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3">𝐿</ci><apply id="alg1.l2.m3.1.1.4.cmml" xref="alg1.l2.m3.1.1.4"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.4.1.cmml" xref="alg1.l2.m3.1.1.4">subscript</csymbol><ci id="alg1.l2.m3.1.1.4.2.cmml" xref="alg1.l2.m3.1.1.4.2">𝑀</ci><ci id="alg1.l2.m3.1.1.4.3.cmml" xref="alg1.l2.m3.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>Initialized candidate trajectory set <math alttext="\mathcal{P}\leftarrow\{(A_{a}=\text{Empty},A_{t}=\text{CoT},A_{v}=\text{Empty}%
),\cdots\}" class="ltx_Math" display="inline" id="alg1.l3.m1.2"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.2.2.3" xref="alg1.l3.m1.2.2.3.cmml">𝒫</mi><mo id="alg1.l3.m1.2.2.2" stretchy="false" xref="alg1.l3.m1.2.2.2.cmml">←</mo><mrow id="alg1.l3.m1.2.2.1.1" xref="alg1.l3.m1.2.2.1.2.cmml"><mo id="alg1.l3.m1.2.2.1.1.2" stretchy="false" xref="alg1.l3.m1.2.2.1.2.cmml">{</mo><mrow id="alg1.l3.m1.2.2.1.1.1.1" xref="alg1.l3.m1.2.2.1.2.cmml"><mo id="alg1.l3.m1.2.2.1.1.1.1.2" stretchy="false" xref="alg1.l3.m1.2.2.1.2.cmml">(</mo><mrow id="alg1.l3.m1.2.2.1.1.1.1.1.2" xref="alg1.l3.m1.2.2.1.1.1.1.1.3.cmml"><mrow id="alg1.l3.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.2" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">A</mi><mi id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.3" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">a</mi></msub><mo id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.1.cmml">=</mo><mtext id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.3a.cmml">Empty</mtext></mrow><mo id="alg1.l3.m1.2.2.1.1.1.1.1.2.3" xref="alg1.l3.m1.2.2.1.1.1.1.1.3a.cmml">,</mo><mrow id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.3.cmml"><mrow id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.cmml"><msub id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.cmml"><mi id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.2" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.2.cmml">A</mi><mi id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.3" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.3.cmml">t</mi></msub><mo id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.1.cmml">=</mo><mtext id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.3" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.3a.cmml">CoT</mtext></mrow><mo id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.3" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.cmml"><msub id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.2" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.2.cmml">A</mi><mi id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.3" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.3.cmml">v</mi></msub><mo id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.1" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.1.cmml">=</mo><mtext id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.3" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.3a.cmml">Empty</mtext></mrow></mrow></mrow><mo id="alg1.l3.m1.2.2.1.1.1.1.3" stretchy="false" xref="alg1.l3.m1.2.2.1.2.cmml">)</mo></mrow><mo id="alg1.l3.m1.2.2.1.1.3" xref="alg1.l3.m1.2.2.1.2.cmml">,</mo><mi id="alg1.l3.m1.1.1" mathvariant="normal" xref="alg1.l3.m1.1.1.cmml">⋯</mi><mo id="alg1.l3.m1.2.2.1.1.4" stretchy="false" xref="alg1.l3.m1.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2"><ci id="alg1.l3.m1.2.2.2.cmml" xref="alg1.l3.m1.2.2.2">←</ci><ci id="alg1.l3.m1.2.2.3.cmml" xref="alg1.l3.m1.2.2.3">𝒫</ci><set id="alg1.l3.m1.2.2.1.2.cmml" xref="alg1.l3.m1.2.2.1.1"><apply id="alg1.l3.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.1.3a.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1"><eq id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.1"></eq><apply id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.2">𝐴</ci><ci id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.3">𝑎</ci></apply><ci id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.3a.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.3"><mtext id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.3">Empty</mtext></ci></apply><apply id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.3a.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1"><eq id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.1"></eq><apply id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.2">𝐴</ci><ci id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.2.3">𝑡</ci></apply><ci id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.3a.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.3"><mtext id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.1.1.3">CoT</mtext></ci></apply><apply id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2"><eq id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.1"></eq><apply id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.2">𝐴</ci><ci id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.2.3">𝑣</ci></apply><ci id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.3a.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.3"><mtext id="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.2.2.2.2.3">Empty</mtext></ci></apply></apply></apply><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">⋯</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">\mathcal{P}\leftarrow\{(A_{a}=\text{Empty},A_{t}=\text{CoT},A_{v}=\text{Empty}%
),\cdots\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.2d">caligraphic_P ← { ( italic_A start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT = Empty , italic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = CoT , italic_A start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = Empty ) , ⋯ }</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>Initialize the record of the accumulated success rate of each candidate trajectory: <math alttext="\mathcal{R}\leftarrow\{p:0\mid p\in\mathcal{P}\}" class="ltx_Math" display="inline" id="alg1.l4.m1.2"><semantics id="alg1.l4.m1.2a"><mrow id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.2.2.3" xref="alg1.l4.m1.2.2.3.cmml">ℛ</mi><mo id="alg1.l4.m1.2.2.2" stretchy="false" xref="alg1.l4.m1.2.2.2.cmml">←</mo><mrow id="alg1.l4.m1.2.2.1.1" xref="alg1.l4.m1.2.2.1.2.cmml"><mo id="alg1.l4.m1.2.2.1.1.2" stretchy="false" xref="alg1.l4.m1.2.2.1.2.1.cmml">{</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">p</mi><mo id="alg1.l4.m1.2.2.1.1.3" lspace="0.278em" rspace="0.278em" xref="alg1.l4.m1.2.2.1.2.1.cmml">:</mo><mrow id="alg1.l4.m1.2.2.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.cmml"><mrow id="alg1.l4.m1.2.2.1.1.1.2" xref="alg1.l4.m1.2.2.1.1.1.2.cmml"><mn id="alg1.l4.m1.2.2.1.1.1.2.2" xref="alg1.l4.m1.2.2.1.1.1.2.2.cmml">0</mn><mo id="alg1.l4.m1.2.2.1.1.1.2.1" xref="alg1.l4.m1.2.2.1.1.1.2.1.cmml">∣</mo><mi id="alg1.l4.m1.2.2.1.1.1.2.3" xref="alg1.l4.m1.2.2.1.1.1.2.3.cmml">p</mi></mrow><mo id="alg1.l4.m1.2.2.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.2.2.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.3.cmml">𝒫</mi></mrow><mo id="alg1.l4.m1.2.2.1.1.4" stretchy="false" xref="alg1.l4.m1.2.2.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b"><apply id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2"><ci id="alg1.l4.m1.2.2.2.cmml" xref="alg1.l4.m1.2.2.2">←</ci><ci id="alg1.l4.m1.2.2.3.cmml" xref="alg1.l4.m1.2.2.3">ℛ</ci><apply id="alg1.l4.m1.2.2.1.2.cmml" xref="alg1.l4.m1.2.2.1.1"><csymbol cd="latexml" id="alg1.l4.m1.2.2.1.2.1.cmml" xref="alg1.l4.m1.2.2.1.1.2">conditional-set</csymbol><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑝</ci><apply id="alg1.l4.m1.2.2.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1"><in id="alg1.l4.m1.2.2.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1"></in><apply id="alg1.l4.m1.2.2.1.1.1.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.2"><csymbol cd="latexml" id="alg1.l4.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.2.1">conditional</csymbol><cn id="alg1.l4.m1.2.2.1.1.1.2.2.cmml" type="integer" xref="alg1.l4.m1.2.2.1.1.1.2.2">0</cn><ci id="alg1.l4.m1.2.2.1.1.1.2.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.2.3">𝑝</ci></apply><ci id="alg1.l4.m1.2.2.1.1.1.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.3">𝒫</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.2c">\mathcal{R}\leftarrow\{p:0\mid p\in\mathcal{P}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.2d">caligraphic_R ← { italic_p : 0 ∣ italic_p ∈ caligraphic_P }</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span><span class="ltx_text ltx_font_bold" id="alg1.l5.1">for</span> iteration <math alttext="k=1" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">k</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">=</mo><mn id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><eq id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></eq><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑘</ci><cn id="alg1.l5.m1.1.1.3.cmml" type="integer" xref="alg1.l5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">k=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_k = 1</annotation></semantics></math> to <math alttext="K" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">italic_K</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l5.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l6.1">for all</span> <math alttext="p\in\mathcal{P}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">p</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><in id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></in><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑝</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">p\in\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_p ∈ caligraphic_P</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l6.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>         Execute the trajectory <math alttext="p" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_p</annotation></semantics></math> against <math alttext="Q" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">italic_Q</annotation></semantics></math> and <math alttext="LLM_{s}" class="ltx_Math" display="inline" id="alg1.l7.m3.1"><semantics id="alg1.l7.m3.1a"><mrow id="alg1.l7.m3.1.1" xref="alg1.l7.m3.1.1.cmml"><mi id="alg1.l7.m3.1.1.2" xref="alg1.l7.m3.1.1.2.cmml">L</mi><mo id="alg1.l7.m3.1.1.1" xref="alg1.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l7.m3.1.1.3" xref="alg1.l7.m3.1.1.3.cmml">L</mi><mo id="alg1.l7.m3.1.1.1a" xref="alg1.l7.m3.1.1.1.cmml">⁢</mo><msub id="alg1.l7.m3.1.1.4" xref="alg1.l7.m3.1.1.4.cmml"><mi id="alg1.l7.m3.1.1.4.2" xref="alg1.l7.m3.1.1.4.2.cmml">M</mi><mi id="alg1.l7.m3.1.1.4.3" xref="alg1.l7.m3.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.1b"><apply id="alg1.l7.m3.1.1.cmml" xref="alg1.l7.m3.1.1"><times id="alg1.l7.m3.1.1.1.cmml" xref="alg1.l7.m3.1.1.1"></times><ci id="alg1.l7.m3.1.1.2.cmml" xref="alg1.l7.m3.1.1.2">𝐿</ci><ci id="alg1.l7.m3.1.1.3.cmml" xref="alg1.l7.m3.1.1.3">𝐿</ci><apply id="alg1.l7.m3.1.1.4.cmml" xref="alg1.l7.m3.1.1.4"><csymbol cd="ambiguous" id="alg1.l7.m3.1.1.4.1.cmml" xref="alg1.l7.m3.1.1.4">subscript</csymbol><ci id="alg1.l7.m3.1.1.4.2.cmml" xref="alg1.l7.m3.1.1.4.2">𝑀</ci><ci id="alg1.l7.m3.1.1.4.3.cmml" xref="alg1.l7.m3.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.1c">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m3.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="N_{eval}" class="ltx_Math" display="inline" id="alg1.l7.m4.1"><semantics id="alg1.l7.m4.1a"><msub id="alg1.l7.m4.1.1" xref="alg1.l7.m4.1.1.cmml"><mi id="alg1.l7.m4.1.1.2" xref="alg1.l7.m4.1.1.2.cmml">N</mi><mrow id="alg1.l7.m4.1.1.3" xref="alg1.l7.m4.1.1.3.cmml"><mi id="alg1.l7.m4.1.1.3.2" xref="alg1.l7.m4.1.1.3.2.cmml">e</mi><mo id="alg1.l7.m4.1.1.3.1" xref="alg1.l7.m4.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m4.1.1.3.3" xref="alg1.l7.m4.1.1.3.3.cmml">v</mi><mo id="alg1.l7.m4.1.1.3.1a" xref="alg1.l7.m4.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m4.1.1.3.4" xref="alg1.l7.m4.1.1.3.4.cmml">a</mi><mo id="alg1.l7.m4.1.1.3.1b" xref="alg1.l7.m4.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m4.1.1.3.5" xref="alg1.l7.m4.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m4.1b"><apply id="alg1.l7.m4.1.1.cmml" xref="alg1.l7.m4.1.1"><csymbol cd="ambiguous" id="alg1.l7.m4.1.1.1.cmml" xref="alg1.l7.m4.1.1">subscript</csymbol><ci id="alg1.l7.m4.1.1.2.cmml" xref="alg1.l7.m4.1.1.2">𝑁</ci><apply id="alg1.l7.m4.1.1.3.cmml" xref="alg1.l7.m4.1.1.3"><times id="alg1.l7.m4.1.1.3.1.cmml" xref="alg1.l7.m4.1.1.3.1"></times><ci id="alg1.l7.m4.1.1.3.2.cmml" xref="alg1.l7.m4.1.1.3.2">𝑒</ci><ci id="alg1.l7.m4.1.1.3.3.cmml" xref="alg1.l7.m4.1.1.3.3">𝑣</ci><ci id="alg1.l7.m4.1.1.3.4.cmml" xref="alg1.l7.m4.1.1.3.4">𝑎</ci><ci id="alg1.l7.m4.1.1.3.5.cmml" xref="alg1.l7.m4.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m4.1c">N_{eval}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m4.1d">italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math> times with non-zero temperature and obtain an average success rate <math alttext="r_{p}" class="ltx_Math" display="inline" id="alg1.l7.m5.1"><semantics id="alg1.l7.m5.1a"><msub id="alg1.l7.m5.1.1" xref="alg1.l7.m5.1.1.cmml"><mi id="alg1.l7.m5.1.1.2" xref="alg1.l7.m5.1.1.2.cmml">r</mi><mi id="alg1.l7.m5.1.1.3" xref="alg1.l7.m5.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m5.1b"><apply id="alg1.l7.m5.1.1.cmml" xref="alg1.l7.m5.1.1"><csymbol cd="ambiguous" id="alg1.l7.m5.1.1.1.cmml" xref="alg1.l7.m5.1.1">subscript</csymbol><ci id="alg1.l7.m5.1.1.2.cmml" xref="alg1.l7.m5.1.1.2">𝑟</ci><ci id="alg1.l7.m5.1.1.3.cmml" xref="alg1.l7.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m5.1c">r_{p}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m5.1d">italic_r start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> (compared to the true answer <math alttext="y^{*}" class="ltx_Math" display="inline" id="alg1.l7.m6.1"><semantics id="alg1.l7.m6.1a"><msup id="alg1.l7.m6.1.1" xref="alg1.l7.m6.1.1.cmml"><mi id="alg1.l7.m6.1.1.2" xref="alg1.l7.m6.1.1.2.cmml">y</mi><mo id="alg1.l7.m6.1.1.3" xref="alg1.l7.m6.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l7.m6.1b"><apply id="alg1.l7.m6.1.1.cmml" xref="alg1.l7.m6.1.1"><csymbol cd="ambiguous" id="alg1.l7.m6.1.1.1.cmml" xref="alg1.l7.m6.1.1">superscript</csymbol><ci id="alg1.l7.m6.1.1.2.cmml" xref="alg1.l7.m6.1.1.2">𝑦</ci><times id="alg1.l7.m6.1.1.3.cmml" xref="alg1.l7.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m6.1c">y^{*}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m6.1d">italic_y start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>);

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>         Update the accumulated success rate of <math alttext="p" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_p</annotation></semantics></math>: <math alttext="\mathcal{R}[p]\leftarrow\frac{\mathcal{R}[p]\cdot(k-1)\cdot N_{eval}+r_{p}%
\cdot N_{eval}}{N_{eval}\cdot k}" class="ltx_Math" display="inline" id="alg1.l8.m2.3"><semantics id="alg1.l8.m2.3a"><mrow id="alg1.l8.m2.3.4" xref="alg1.l8.m2.3.4.cmml"><mrow id="alg1.l8.m2.3.4.2" xref="alg1.l8.m2.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m2.3.4.2.2" xref="alg1.l8.m2.3.4.2.2.cmml">ℛ</mi><mo id="alg1.l8.m2.3.4.2.1" xref="alg1.l8.m2.3.4.2.1.cmml">⁢</mo><mrow id="alg1.l8.m2.3.4.2.3.2" xref="alg1.l8.m2.3.4.2.3.1.cmml"><mo id="alg1.l8.m2.3.4.2.3.2.1" stretchy="false" xref="alg1.l8.m2.3.4.2.3.1.1.cmml">[</mo><mi id="alg1.l8.m2.3.3" xref="alg1.l8.m2.3.3.cmml">p</mi><mo id="alg1.l8.m2.3.4.2.3.2.2" stretchy="false" xref="alg1.l8.m2.3.4.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l8.m2.3.4.1" stretchy="false" xref="alg1.l8.m2.3.4.1.cmml">←</mo><mfrac id="alg1.l8.m2.2.2" xref="alg1.l8.m2.2.2.cmml"><mrow id="alg1.l8.m2.2.2.2" xref="alg1.l8.m2.2.2.2.cmml"><mrow id="alg1.l8.m2.2.2.2.2" xref="alg1.l8.m2.2.2.2.2.cmml"><mrow id="alg1.l8.m2.2.2.2.2.3" xref="alg1.l8.m2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m2.2.2.2.2.3.2" xref="alg1.l8.m2.2.2.2.2.3.2.cmml">ℛ</mi><mo id="alg1.l8.m2.2.2.2.2.3.1" xref="alg1.l8.m2.2.2.2.2.3.1.cmml">⁢</mo><mrow id="alg1.l8.m2.2.2.2.2.3.3.2" xref="alg1.l8.m2.2.2.2.2.3.3.1.cmml"><mo id="alg1.l8.m2.2.2.2.2.3.3.2.1" stretchy="false" xref="alg1.l8.m2.2.2.2.2.3.3.1.1.cmml">[</mo><mi id="alg1.l8.m2.1.1.1.1" xref="alg1.l8.m2.1.1.1.1.cmml">p</mi><mo id="alg1.l8.m2.2.2.2.2.3.3.2.2" rspace="0.055em" stretchy="false" xref="alg1.l8.m2.2.2.2.2.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l8.m2.2.2.2.2.2" rspace="0.222em" xref="alg1.l8.m2.2.2.2.2.2.cmml">⋅</mo><mrow id="alg1.l8.m2.2.2.2.2.1.1" xref="alg1.l8.m2.2.2.2.2.1.1.1.cmml"><mo id="alg1.l8.m2.2.2.2.2.1.1.2" stretchy="false" xref="alg1.l8.m2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l8.m2.2.2.2.2.1.1.1" xref="alg1.l8.m2.2.2.2.2.1.1.1.cmml"><mi id="alg1.l8.m2.2.2.2.2.1.1.1.2" xref="alg1.l8.m2.2.2.2.2.1.1.1.2.cmml">k</mi><mo id="alg1.l8.m2.2.2.2.2.1.1.1.1" xref="alg1.l8.m2.2.2.2.2.1.1.1.1.cmml">−</mo><mn id="alg1.l8.m2.2.2.2.2.1.1.1.3" xref="alg1.l8.m2.2.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l8.m2.2.2.2.2.1.1.3" rspace="0.055em" stretchy="false" xref="alg1.l8.m2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="alg1.l8.m2.2.2.2.2.2a" rspace="0.222em" xref="alg1.l8.m2.2.2.2.2.2.cmml">⋅</mo><msub id="alg1.l8.m2.2.2.2.2.4" xref="alg1.l8.m2.2.2.2.2.4.cmml"><mi id="alg1.l8.m2.2.2.2.2.4.2" xref="alg1.l8.m2.2.2.2.2.4.2.cmml">N</mi><mrow id="alg1.l8.m2.2.2.2.2.4.3" xref="alg1.l8.m2.2.2.2.2.4.3.cmml"><mi id="alg1.l8.m2.2.2.2.2.4.3.2" xref="alg1.l8.m2.2.2.2.2.4.3.2.cmml">e</mi><mo id="alg1.l8.m2.2.2.2.2.4.3.1" xref="alg1.l8.m2.2.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.2.2.2.2.4.3.3" xref="alg1.l8.m2.2.2.2.2.4.3.3.cmml">v</mi><mo id="alg1.l8.m2.2.2.2.2.4.3.1a" xref="alg1.l8.m2.2.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.2.2.2.2.4.3.4" xref="alg1.l8.m2.2.2.2.2.4.3.4.cmml">a</mi><mo id="alg1.l8.m2.2.2.2.2.4.3.1b" xref="alg1.l8.m2.2.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.2.2.2.2.4.3.5" xref="alg1.l8.m2.2.2.2.2.4.3.5.cmml">l</mi></mrow></msub></mrow><mo id="alg1.l8.m2.2.2.2.3" xref="alg1.l8.m2.2.2.2.3.cmml">+</mo><mrow id="alg1.l8.m2.2.2.2.4" xref="alg1.l8.m2.2.2.2.4.cmml"><msub id="alg1.l8.m2.2.2.2.4.2" xref="alg1.l8.m2.2.2.2.4.2.cmml"><mi id="alg1.l8.m2.2.2.2.4.2.2" xref="alg1.l8.m2.2.2.2.4.2.2.cmml">r</mi><mi id="alg1.l8.m2.2.2.2.4.2.3" xref="alg1.l8.m2.2.2.2.4.2.3.cmml">p</mi></msub><mo id="alg1.l8.m2.2.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="alg1.l8.m2.2.2.2.4.1.cmml">⋅</mo><msub id="alg1.l8.m2.2.2.2.4.3" xref="alg1.l8.m2.2.2.2.4.3.cmml"><mi id="alg1.l8.m2.2.2.2.4.3.2" xref="alg1.l8.m2.2.2.2.4.3.2.cmml">N</mi><mrow id="alg1.l8.m2.2.2.2.4.3.3" xref="alg1.l8.m2.2.2.2.4.3.3.cmml"><mi id="alg1.l8.m2.2.2.2.4.3.3.2" xref="alg1.l8.m2.2.2.2.4.3.3.2.cmml">e</mi><mo id="alg1.l8.m2.2.2.2.4.3.3.1" xref="alg1.l8.m2.2.2.2.4.3.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.2.2.2.4.3.3.3" xref="alg1.l8.m2.2.2.2.4.3.3.3.cmml">v</mi><mo id="alg1.l8.m2.2.2.2.4.3.3.1a" xref="alg1.l8.m2.2.2.2.4.3.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.2.2.2.4.3.3.4" xref="alg1.l8.m2.2.2.2.4.3.3.4.cmml">a</mi><mo id="alg1.l8.m2.2.2.2.4.3.3.1b" xref="alg1.l8.m2.2.2.2.4.3.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.2.2.2.4.3.3.5" xref="alg1.l8.m2.2.2.2.4.3.3.5.cmml">l</mi></mrow></msub></mrow></mrow><mrow id="alg1.l8.m2.2.2.4" xref="alg1.l8.m2.2.2.4.cmml"><msub id="alg1.l8.m2.2.2.4.2" xref="alg1.l8.m2.2.2.4.2.cmml"><mi id="alg1.l8.m2.2.2.4.2.2" xref="alg1.l8.m2.2.2.4.2.2.cmml">N</mi><mrow id="alg1.l8.m2.2.2.4.2.3" xref="alg1.l8.m2.2.2.4.2.3.cmml"><mi id="alg1.l8.m2.2.2.4.2.3.2" xref="alg1.l8.m2.2.2.4.2.3.2.cmml">e</mi><mo id="alg1.l8.m2.2.2.4.2.3.1" xref="alg1.l8.m2.2.2.4.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.2.2.4.2.3.3" xref="alg1.l8.m2.2.2.4.2.3.3.cmml">v</mi><mo id="alg1.l8.m2.2.2.4.2.3.1a" xref="alg1.l8.m2.2.2.4.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.2.2.4.2.3.4" xref="alg1.l8.m2.2.2.4.2.3.4.cmml">a</mi><mo id="alg1.l8.m2.2.2.4.2.3.1b" xref="alg1.l8.m2.2.2.4.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.2.2.4.2.3.5" xref="alg1.l8.m2.2.2.4.2.3.5.cmml">l</mi></mrow></msub><mo id="alg1.l8.m2.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="alg1.l8.m2.2.2.4.1.cmml">⋅</mo><mi id="alg1.l8.m2.2.2.4.3" xref="alg1.l8.m2.2.2.4.3.cmml">k</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.3b"><apply id="alg1.l8.m2.3.4.cmml" xref="alg1.l8.m2.3.4"><ci id="alg1.l8.m2.3.4.1.cmml" xref="alg1.l8.m2.3.4.1">←</ci><apply id="alg1.l8.m2.3.4.2.cmml" xref="alg1.l8.m2.3.4.2"><times id="alg1.l8.m2.3.4.2.1.cmml" xref="alg1.l8.m2.3.4.2.1"></times><ci id="alg1.l8.m2.3.4.2.2.cmml" xref="alg1.l8.m2.3.4.2.2">ℛ</ci><apply id="alg1.l8.m2.3.4.2.3.1.cmml" xref="alg1.l8.m2.3.4.2.3.2"><csymbol cd="latexml" id="alg1.l8.m2.3.4.2.3.1.1.cmml" xref="alg1.l8.m2.3.4.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l8.m2.3.3.cmml" xref="alg1.l8.m2.3.3">𝑝</ci></apply></apply><apply id="alg1.l8.m2.2.2.cmml" xref="alg1.l8.m2.2.2"><divide id="alg1.l8.m2.2.2.3.cmml" xref="alg1.l8.m2.2.2"></divide><apply id="alg1.l8.m2.2.2.2.cmml" xref="alg1.l8.m2.2.2.2"><plus id="alg1.l8.m2.2.2.2.3.cmml" xref="alg1.l8.m2.2.2.2.3"></plus><apply id="alg1.l8.m2.2.2.2.2.cmml" xref="alg1.l8.m2.2.2.2.2"><ci id="alg1.l8.m2.2.2.2.2.2.cmml" xref="alg1.l8.m2.2.2.2.2.2">⋅</ci><apply id="alg1.l8.m2.2.2.2.2.3.cmml" xref="alg1.l8.m2.2.2.2.2.3"><times id="alg1.l8.m2.2.2.2.2.3.1.cmml" xref="alg1.l8.m2.2.2.2.2.3.1"></times><ci id="alg1.l8.m2.2.2.2.2.3.2.cmml" xref="alg1.l8.m2.2.2.2.2.3.2">ℛ</ci><apply id="alg1.l8.m2.2.2.2.2.3.3.1.cmml" xref="alg1.l8.m2.2.2.2.2.3.3.2"><csymbol cd="latexml" id="alg1.l8.m2.2.2.2.2.3.3.1.1.cmml" xref="alg1.l8.m2.2.2.2.2.3.3.2.1">delimited-[]</csymbol><ci id="alg1.l8.m2.1.1.1.1.cmml" xref="alg1.l8.m2.1.1.1.1">𝑝</ci></apply></apply><apply id="alg1.l8.m2.2.2.2.2.1.1.1.cmml" xref="alg1.l8.m2.2.2.2.2.1.1"><minus id="alg1.l8.m2.2.2.2.2.1.1.1.1.cmml" xref="alg1.l8.m2.2.2.2.2.1.1.1.1"></minus><ci id="alg1.l8.m2.2.2.2.2.1.1.1.2.cmml" xref="alg1.l8.m2.2.2.2.2.1.1.1.2">𝑘</ci><cn id="alg1.l8.m2.2.2.2.2.1.1.1.3.cmml" type="integer" xref="alg1.l8.m2.2.2.2.2.1.1.1.3">1</cn></apply><apply id="alg1.l8.m2.2.2.2.2.4.cmml" xref="alg1.l8.m2.2.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.2.2.4.1.cmml" xref="alg1.l8.m2.2.2.2.2.4">subscript</csymbol><ci id="alg1.l8.m2.2.2.2.2.4.2.cmml" xref="alg1.l8.m2.2.2.2.2.4.2">𝑁</ci><apply id="alg1.l8.m2.2.2.2.2.4.3.cmml" xref="alg1.l8.m2.2.2.2.2.4.3"><times id="alg1.l8.m2.2.2.2.2.4.3.1.cmml" xref="alg1.l8.m2.2.2.2.2.4.3.1"></times><ci id="alg1.l8.m2.2.2.2.2.4.3.2.cmml" xref="alg1.l8.m2.2.2.2.2.4.3.2">𝑒</ci><ci id="alg1.l8.m2.2.2.2.2.4.3.3.cmml" xref="alg1.l8.m2.2.2.2.2.4.3.3">𝑣</ci><ci id="alg1.l8.m2.2.2.2.2.4.3.4.cmml" xref="alg1.l8.m2.2.2.2.2.4.3.4">𝑎</ci><ci id="alg1.l8.m2.2.2.2.2.4.3.5.cmml" xref="alg1.l8.m2.2.2.2.2.4.3.5">𝑙</ci></apply></apply></apply><apply id="alg1.l8.m2.2.2.2.4.cmml" xref="alg1.l8.m2.2.2.2.4"><ci id="alg1.l8.m2.2.2.2.4.1.cmml" xref="alg1.l8.m2.2.2.2.4.1">⋅</ci><apply id="alg1.l8.m2.2.2.2.4.2.cmml" xref="alg1.l8.m2.2.2.2.4.2"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.2.4.2.1.cmml" xref="alg1.l8.m2.2.2.2.4.2">subscript</csymbol><ci id="alg1.l8.m2.2.2.2.4.2.2.cmml" xref="alg1.l8.m2.2.2.2.4.2.2">𝑟</ci><ci id="alg1.l8.m2.2.2.2.4.2.3.cmml" xref="alg1.l8.m2.2.2.2.4.2.3">𝑝</ci></apply><apply id="alg1.l8.m2.2.2.2.4.3.cmml" xref="alg1.l8.m2.2.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.2.4.3.1.cmml" xref="alg1.l8.m2.2.2.2.4.3">subscript</csymbol><ci id="alg1.l8.m2.2.2.2.4.3.2.cmml" xref="alg1.l8.m2.2.2.2.4.3.2">𝑁</ci><apply id="alg1.l8.m2.2.2.2.4.3.3.cmml" xref="alg1.l8.m2.2.2.2.4.3.3"><times id="alg1.l8.m2.2.2.2.4.3.3.1.cmml" xref="alg1.l8.m2.2.2.2.4.3.3.1"></times><ci id="alg1.l8.m2.2.2.2.4.3.3.2.cmml" xref="alg1.l8.m2.2.2.2.4.3.3.2">𝑒</ci><ci id="alg1.l8.m2.2.2.2.4.3.3.3.cmml" xref="alg1.l8.m2.2.2.2.4.3.3.3">𝑣</ci><ci id="alg1.l8.m2.2.2.2.4.3.3.4.cmml" xref="alg1.l8.m2.2.2.2.4.3.3.4">𝑎</ci><ci id="alg1.l8.m2.2.2.2.4.3.3.5.cmml" xref="alg1.l8.m2.2.2.2.4.3.3.5">𝑙</ci></apply></apply></apply></apply><apply id="alg1.l8.m2.2.2.4.cmml" xref="alg1.l8.m2.2.2.4"><ci id="alg1.l8.m2.2.2.4.1.cmml" xref="alg1.l8.m2.2.2.4.1">⋅</ci><apply id="alg1.l8.m2.2.2.4.2.cmml" xref="alg1.l8.m2.2.2.4.2"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.4.2.1.cmml" xref="alg1.l8.m2.2.2.4.2">subscript</csymbol><ci id="alg1.l8.m2.2.2.4.2.2.cmml" xref="alg1.l8.m2.2.2.4.2.2">𝑁</ci><apply id="alg1.l8.m2.2.2.4.2.3.cmml" xref="alg1.l8.m2.2.2.4.2.3"><times id="alg1.l8.m2.2.2.4.2.3.1.cmml" xref="alg1.l8.m2.2.2.4.2.3.1"></times><ci id="alg1.l8.m2.2.2.4.2.3.2.cmml" xref="alg1.l8.m2.2.2.4.2.3.2">𝑒</ci><ci id="alg1.l8.m2.2.2.4.2.3.3.cmml" xref="alg1.l8.m2.2.2.4.2.3.3">𝑣</ci><ci id="alg1.l8.m2.2.2.4.2.3.4.cmml" xref="alg1.l8.m2.2.2.4.2.3.4">𝑎</ci><ci id="alg1.l8.m2.2.2.4.2.3.5.cmml" xref="alg1.l8.m2.2.2.4.2.3.5">𝑙</ci></apply></apply><ci id="alg1.l8.m2.2.2.4.3.cmml" xref="alg1.l8.m2.2.2.4.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.3c">\mathcal{R}[p]\leftarrow\frac{\mathcal{R}[p]\cdot(k-1)\cdot N_{eval}+r_{p}%
\cdot N_{eval}}{N_{eval}\cdot k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.3d">caligraphic_R [ italic_p ] ← divide start_ARG caligraphic_R [ italic_p ] ⋅ ( italic_k - 1 ) ⋅ italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT + italic_r start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ⋅ italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT ⋅ italic_k end_ARG</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l9.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l9.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     Sort <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">caligraphic_P</annotation></semantics></math> first by the accumulated success rate <math alttext="\mathcal{R}[p]" class="ltx_Math" display="inline" id="alg1.l10.m2.1"><semantics id="alg1.l10.m2.1a"><mrow id="alg1.l10.m2.1.2" xref="alg1.l10.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m2.1.2.2" xref="alg1.l10.m2.1.2.2.cmml">ℛ</mi><mo id="alg1.l10.m2.1.2.1" xref="alg1.l10.m2.1.2.1.cmml">⁢</mo><mrow id="alg1.l10.m2.1.2.3.2" xref="alg1.l10.m2.1.2.3.1.cmml"><mo id="alg1.l10.m2.1.2.3.2.1" stretchy="false" xref="alg1.l10.m2.1.2.3.1.1.cmml">[</mo><mi id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">p</mi><mo id="alg1.l10.m2.1.2.3.2.2" stretchy="false" xref="alg1.l10.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.2.cmml" xref="alg1.l10.m2.1.2"><times id="alg1.l10.m2.1.2.1.cmml" xref="alg1.l10.m2.1.2.1"></times><ci id="alg1.l10.m2.1.2.2.cmml" xref="alg1.l10.m2.1.2.2">ℛ</ci><apply id="alg1.l10.m2.1.2.3.1.cmml" xref="alg1.l10.m2.1.2.3.2"><csymbol cd="latexml" id="alg1.l10.m2.1.2.3.1.1.cmml" xref="alg1.l10.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\mathcal{R}[p]</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.1d">caligraphic_R [ italic_p ]</annotation></semantics></math> and then the trajectory length <math alttext="|p|" class="ltx_Math" display="inline" id="alg1.l10.m3.1"><semantics id="alg1.l10.m3.1a"><mrow id="alg1.l10.m3.1.2.2" xref="alg1.l10.m3.1.2.1.cmml"><mo id="alg1.l10.m3.1.2.2.1" stretchy="false" xref="alg1.l10.m3.1.2.1.1.cmml">|</mo><mi id="alg1.l10.m3.1.1" xref="alg1.l10.m3.1.1.cmml">p</mi><mo id="alg1.l10.m3.1.2.2.2" stretchy="false" xref="alg1.l10.m3.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m3.1b"><apply id="alg1.l10.m3.1.2.1.cmml" xref="alg1.l10.m3.1.2.2"><abs id="alg1.l10.m3.1.2.1.1.cmml" xref="alg1.l10.m3.1.2.2.1"></abs><ci id="alg1.l10.m3.1.1.cmml" xref="alg1.l10.m3.1.1">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m3.1c">|p|</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m3.1d">| italic_p |</annotation></semantics></math> in ascending order;

</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     Reset <math alttext="\mathcal{P}\leftarrow" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">𝒫</mi><mo id="alg1.l11.m1.1.1.1" stretchy="false" xref="alg1.l11.m1.1.1.1.cmml">←</mo><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝒫</ci><csymbol cd="latexml" id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\mathcal{P}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">caligraphic_P ←</annotation></semantics></math> top <math alttext="N_{k}" class="ltx_Math" display="inline" id="alg1.l11.m2.1"><semantics id="alg1.l11.m2.1a"><msub id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">N</mi><mi id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1">subscript</csymbol><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝑁</ci><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">N_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">italic_N start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> trajectories in <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="alg1.l11.m3.1"><semantics id="alg1.l11.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m3.1.1" xref="alg1.l11.m3.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m3.1b"><ci id="alg1.l11.m3.1.1.cmml" xref="alg1.l11.m3.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m3.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m3.1d">caligraphic_P</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span><span class="ltx_text ltx_font_bold" id="alg1.l12.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l12.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span><span class="ltx_text ltx_font_bold" id="alg1.l13.1">Return</span> <math alttext="p^{*}\leftarrow\operatorname*{arg\,max}_{p\in\mathcal{P}}\mathcal{R}[p]" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.2" xref="alg1.l13.m1.1.2.cmml"><msup id="alg1.l13.m1.1.2.2" xref="alg1.l13.m1.1.2.2.cmml"><mi id="alg1.l13.m1.1.2.2.2" xref="alg1.l13.m1.1.2.2.2.cmml">p</mi><mo id="alg1.l13.m1.1.2.2.3" xref="alg1.l13.m1.1.2.2.3.cmml">∗</mo></msup><mo id="alg1.l13.m1.1.2.1" stretchy="false" xref="alg1.l13.m1.1.2.1.cmml">←</mo><mrow id="alg1.l13.m1.1.2.3" xref="alg1.l13.m1.1.2.3.cmml"><mrow id="alg1.l13.m1.1.2.3.2" xref="alg1.l13.m1.1.2.3.2.cmml"><msub id="alg1.l13.m1.1.2.3.2.1" xref="alg1.l13.m1.1.2.3.2.1.cmml"><mrow id="alg1.l13.m1.1.2.3.2.1.2" xref="alg1.l13.m1.1.2.3.2.1.2.cmml"><mi id="alg1.l13.m1.1.2.3.2.1.2.2" xref="alg1.l13.m1.1.2.3.2.1.2.2.cmml">arg</mi><mo id="alg1.l13.m1.1.2.3.2.1.2.1" lspace="0.170em" xref="alg1.l13.m1.1.2.3.2.1.2.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.2.3.2.1.2.3" xref="alg1.l13.m1.1.2.3.2.1.2.3.cmml">max</mi></mrow><mrow id="alg1.l13.m1.1.2.3.2.1.3" xref="alg1.l13.m1.1.2.3.2.1.3.cmml"><mi id="alg1.l13.m1.1.2.3.2.1.3.2" xref="alg1.l13.m1.1.2.3.2.1.3.2.cmml">p</mi><mo id="alg1.l13.m1.1.2.3.2.1.3.1" xref="alg1.l13.m1.1.2.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.2.3.2.1.3.3" xref="alg1.l13.m1.1.2.3.2.1.3.3.cmml">𝒫</mi></mrow></msub><mo id="alg1.l13.m1.1.2.3.2a" xref="alg1.l13.m1.1.2.3.2.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.2.3.2.2" xref="alg1.l13.m1.1.2.3.2.2.cmml">ℛ</mi></mrow><mo id="alg1.l13.m1.1.2.3.1" xref="alg1.l13.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l13.m1.1.2.3.3.2" xref="alg1.l13.m1.1.2.3.3.1.cmml"><mo id="alg1.l13.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l13.m1.1.2.3.3.1.1.cmml">[</mo><mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">p</mi><mo id="alg1.l13.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l13.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.2.cmml" xref="alg1.l13.m1.1.2"><ci id="alg1.l13.m1.1.2.1.cmml" xref="alg1.l13.m1.1.2.1">←</ci><apply id="alg1.l13.m1.1.2.2.cmml" xref="alg1.l13.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.2.2.1.cmml" xref="alg1.l13.m1.1.2.2">superscript</csymbol><ci id="alg1.l13.m1.1.2.2.2.cmml" xref="alg1.l13.m1.1.2.2.2">𝑝</ci><times id="alg1.l13.m1.1.2.2.3.cmml" xref="alg1.l13.m1.1.2.2.3"></times></apply><apply id="alg1.l13.m1.1.2.3.cmml" xref="alg1.l13.m1.1.2.3"><times id="alg1.l13.m1.1.2.3.1.cmml" xref="alg1.l13.m1.1.2.3.1"></times><apply id="alg1.l13.m1.1.2.3.2.cmml" xref="alg1.l13.m1.1.2.3.2"><apply id="alg1.l13.m1.1.2.3.2.1.cmml" xref="alg1.l13.m1.1.2.3.2.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.2.3.2.1.1.cmml" xref="alg1.l13.m1.1.2.3.2.1">subscript</csymbol><apply id="alg1.l13.m1.1.2.3.2.1.2.cmml" xref="alg1.l13.m1.1.2.3.2.1.2"><times id="alg1.l13.m1.1.2.3.2.1.2.1.cmml" xref="alg1.l13.m1.1.2.3.2.1.2.1"></times><ci id="alg1.l13.m1.1.2.3.2.1.2.2.cmml" xref="alg1.l13.m1.1.2.3.2.1.2.2">arg</ci><ci id="alg1.l13.m1.1.2.3.2.1.2.3.cmml" xref="alg1.l13.m1.1.2.3.2.1.2.3">max</ci></apply><apply id="alg1.l13.m1.1.2.3.2.1.3.cmml" xref="alg1.l13.m1.1.2.3.2.1.3"><in id="alg1.l13.m1.1.2.3.2.1.3.1.cmml" xref="alg1.l13.m1.1.2.3.2.1.3.1"></in><ci id="alg1.l13.m1.1.2.3.2.1.3.2.cmml" xref="alg1.l13.m1.1.2.3.2.1.3.2">𝑝</ci><ci id="alg1.l13.m1.1.2.3.2.1.3.3.cmml" xref="alg1.l13.m1.1.2.3.2.1.3.3">𝒫</ci></apply></apply><ci id="alg1.l13.m1.1.2.3.2.2.cmml" xref="alg1.l13.m1.1.2.3.2.2">ℛ</ci></apply><apply id="alg1.l13.m1.1.2.3.3.1.cmml" xref="alg1.l13.m1.1.2.3.3.2"><csymbol cd="latexml" id="alg1.l13.m1.1.2.3.3.1.1.cmml" xref="alg1.l13.m1.1.2.3.3.2.1">delimited-[]</csymbol><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">p^{*}\leftarrow\operatorname*{arg\,max}_{p\in\mathcal{P}}\mathcal{R}[p]</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_p start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ← start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_p ∈ caligraphic_P end_POSTSUBSCRIPT caligraphic_R [ italic_p ]</annotation></semantics></math>.

</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.11">This searching process is shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#alg1" title="Algorithm 1 ‣ 2.3 Searching for Optimal Reasoning Action Trajectories ‣ 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">1</span></a>. Given the query and ground-truth answer sourced from the training data, the process runs iteratively. In each iteration, the algorithm considers either the full set of candidate trajectories (for iteration <math alttext="k=1" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><mrow id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">k</mi><mo id="S2.SS3.p2.1.m1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.cmml">=</mo><mn id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><eq id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1"></eq><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">𝑘</ci><cn id="S2.SS3.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.SS3.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">k=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_k = 1</annotation></semantics></math>) or the current best subset (for iteration <math alttext="k&gt;1" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><mrow id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mi id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2.cmml">k</mi><mo id="S2.SS3.p2.2.m2.1.1.1" xref="S2.SS3.p2.2.m2.1.1.1.cmml">&gt;</mo><mn id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><gt id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1.1"></gt><ci id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2">𝑘</ci><cn id="S2.SS3.p2.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">k&gt;1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_k &gt; 1</annotation></semantics></math>). Each candidate trajectory is executed for <math alttext="N_{eval}" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.1"><semantics id="S2.SS3.p2.3.m3.1a"><msub id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml">N</mi><mrow id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml"><mi id="S2.SS3.p2.3.m3.1.1.3.2" xref="S2.SS3.p2.3.m3.1.1.3.2.cmml">e</mi><mo id="S2.SS3.p2.3.m3.1.1.3.1" xref="S2.SS3.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.3.m3.1.1.3.3" xref="S2.SS3.p2.3.m3.1.1.3.3.cmml">v</mi><mo id="S2.SS3.p2.3.m3.1.1.3.1a" xref="S2.SS3.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.3.m3.1.1.3.4" xref="S2.SS3.p2.3.m3.1.1.3.4.cmml">a</mi><mo id="S2.SS3.p2.3.m3.1.1.3.1b" xref="S2.SS3.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.3.m3.1.1.3.5" xref="S2.SS3.p2.3.m3.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2">𝑁</ci><apply id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3"><times id="S2.SS3.p2.3.m3.1.1.3.1.cmml" xref="S2.SS3.p2.3.m3.1.1.3.1"></times><ci id="S2.SS3.p2.3.m3.1.1.3.2.cmml" xref="S2.SS3.p2.3.m3.1.1.3.2">𝑒</ci><ci id="S2.SS3.p2.3.m3.1.1.3.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3.3">𝑣</ci><ci id="S2.SS3.p2.3.m3.1.1.3.4.cmml" xref="S2.SS3.p2.3.m3.1.1.3.4">𝑎</ci><ci id="S2.SS3.p2.3.m3.1.1.3.5.cmml" xref="S2.SS3.p2.3.m3.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">N_{eval}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math> times with a non-zero temperature to obtain a more reliable evaluation of its success rate. We then sort the current subset of trajectories by its success rate accumulated from the past <math alttext="k" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m4.1"><semantics id="S2.SS3.p2.4.m4.1a"><mi id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><ci id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m4.1d">italic_k</annotation></semantics></math> iterations and then the trajectory length to encourage a shorter trajectory (which is thus computationally more efficient).
Only the top <math alttext="N_{k}" class="ltx_Math" display="inline" id="S2.SS3.p2.5.m5.1"><semantics id="S2.SS3.p2.5.m5.1a"><msub id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml"><mi id="S2.SS3.p2.5.m5.1.1.2" xref="S2.SS3.p2.5.m5.1.1.2.cmml">N</mi><mi id="S2.SS3.p2.5.m5.1.1.3" xref="S2.SS3.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><apply id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.1.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.p2.5.m5.1.1.2.cmml" xref="S2.SS3.p2.5.m5.1.1.2">𝑁</ci><ci id="S2.SS3.p2.5.m5.1.1.3.cmml" xref="S2.SS3.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">N_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> candidates will be retained and rolled over to the next iteration of the assessment. In practice, we opt for a smaller <math alttext="N_{eval}" class="ltx_Math" display="inline" id="S2.SS3.p2.6.m6.1"><semantics id="S2.SS3.p2.6.m6.1a"><msub id="S2.SS3.p2.6.m6.1.1" xref="S2.SS3.p2.6.m6.1.1.cmml"><mi id="S2.SS3.p2.6.m6.1.1.2" xref="S2.SS3.p2.6.m6.1.1.2.cmml">N</mi><mrow id="S2.SS3.p2.6.m6.1.1.3" xref="S2.SS3.p2.6.m6.1.1.3.cmml"><mi id="S2.SS3.p2.6.m6.1.1.3.2" xref="S2.SS3.p2.6.m6.1.1.3.2.cmml">e</mi><mo id="S2.SS3.p2.6.m6.1.1.3.1" xref="S2.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.6.m6.1.1.3.3" xref="S2.SS3.p2.6.m6.1.1.3.3.cmml">v</mi><mo id="S2.SS3.p2.6.m6.1.1.3.1a" xref="S2.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.6.m6.1.1.3.4" xref="S2.SS3.p2.6.m6.1.1.3.4.cmml">a</mi><mo id="S2.SS3.p2.6.m6.1.1.3.1b" xref="S2.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.6.m6.1.1.3.5" xref="S2.SS3.p2.6.m6.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.1b"><apply id="S2.SS3.p2.6.m6.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.p2.6.m6.1.1.2.cmml" xref="S2.SS3.p2.6.m6.1.1.2">𝑁</ci><apply id="S2.SS3.p2.6.m6.1.1.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3"><times id="S2.SS3.p2.6.m6.1.1.3.1.cmml" xref="S2.SS3.p2.6.m6.1.1.3.1"></times><ci id="S2.SS3.p2.6.m6.1.1.3.2.cmml" xref="S2.SS3.p2.6.m6.1.1.3.2">𝑒</ci><ci id="S2.SS3.p2.6.m6.1.1.3.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3.3">𝑣</ci><ci id="S2.SS3.p2.6.m6.1.1.3.4.cmml" xref="S2.SS3.p2.6.m6.1.1.3.4">𝑎</ci><ci id="S2.SS3.p2.6.m6.1.1.3.5.cmml" xref="S2.SS3.p2.6.m6.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.1c">N_{eval}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.6.m6.1d">italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math> and run the search for multiple iterations, as opposed to finishing the search with a larger <math alttext="N_{eval}" class="ltx_Math" display="inline" id="S2.SS3.p2.7.m7.1"><semantics id="S2.SS3.p2.7.m7.1a"><msub id="S2.SS3.p2.7.m7.1.1" xref="S2.SS3.p2.7.m7.1.1.cmml"><mi id="S2.SS3.p2.7.m7.1.1.2" xref="S2.SS3.p2.7.m7.1.1.2.cmml">N</mi><mrow id="S2.SS3.p2.7.m7.1.1.3" xref="S2.SS3.p2.7.m7.1.1.3.cmml"><mi id="S2.SS3.p2.7.m7.1.1.3.2" xref="S2.SS3.p2.7.m7.1.1.3.2.cmml">e</mi><mo id="S2.SS3.p2.7.m7.1.1.3.1" xref="S2.SS3.p2.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.7.m7.1.1.3.3" xref="S2.SS3.p2.7.m7.1.1.3.3.cmml">v</mi><mo id="S2.SS3.p2.7.m7.1.1.3.1a" xref="S2.SS3.p2.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.7.m7.1.1.3.4" xref="S2.SS3.p2.7.m7.1.1.3.4.cmml">a</mi><mo id="S2.SS3.p2.7.m7.1.1.3.1b" xref="S2.SS3.p2.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.7.m7.1.1.3.5" xref="S2.SS3.p2.7.m7.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m7.1b"><apply id="S2.SS3.p2.7.m7.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.1.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S2.SS3.p2.7.m7.1.1.2.cmml" xref="S2.SS3.p2.7.m7.1.1.2">𝑁</ci><apply id="S2.SS3.p2.7.m7.1.1.3.cmml" xref="S2.SS3.p2.7.m7.1.1.3"><times id="S2.SS3.p2.7.m7.1.1.3.1.cmml" xref="S2.SS3.p2.7.m7.1.1.3.1"></times><ci id="S2.SS3.p2.7.m7.1.1.3.2.cmml" xref="S2.SS3.p2.7.m7.1.1.3.2">𝑒</ci><ci id="S2.SS3.p2.7.m7.1.1.3.3.cmml" xref="S2.SS3.p2.7.m7.1.1.3.3">𝑣</ci><ci id="S2.SS3.p2.7.m7.1.1.3.4.cmml" xref="S2.SS3.p2.7.m7.1.1.3.4">𝑎</ci><ci id="S2.SS3.p2.7.m7.1.1.3.5.cmml" xref="S2.SS3.p2.7.m7.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m7.1c">N_{eval}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.7.m7.1d">italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math> in one iteration, as the latter incurs a much larger cost (<math alttext="N_{eval}\times|\mathcal{P}_{0}|" class="ltx_Math" display="inline" id="S2.SS3.p2.8.m8.1"><semantics id="S2.SS3.p2.8.m8.1a"><mrow id="S2.SS3.p2.8.m8.1.1" xref="S2.SS3.p2.8.m8.1.1.cmml"><msub id="S2.SS3.p2.8.m8.1.1.3" xref="S2.SS3.p2.8.m8.1.1.3.cmml"><mi id="S2.SS3.p2.8.m8.1.1.3.2" xref="S2.SS3.p2.8.m8.1.1.3.2.cmml">N</mi><mrow id="S2.SS3.p2.8.m8.1.1.3.3" xref="S2.SS3.p2.8.m8.1.1.3.3.cmml"><mi id="S2.SS3.p2.8.m8.1.1.3.3.2" xref="S2.SS3.p2.8.m8.1.1.3.3.2.cmml">e</mi><mo id="S2.SS3.p2.8.m8.1.1.3.3.1" xref="S2.SS3.p2.8.m8.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.8.m8.1.1.3.3.3" xref="S2.SS3.p2.8.m8.1.1.3.3.3.cmml">v</mi><mo id="S2.SS3.p2.8.m8.1.1.3.3.1a" xref="S2.SS3.p2.8.m8.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.8.m8.1.1.3.3.4" xref="S2.SS3.p2.8.m8.1.1.3.3.4.cmml">a</mi><mo id="S2.SS3.p2.8.m8.1.1.3.3.1b" xref="S2.SS3.p2.8.m8.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.8.m8.1.1.3.3.5" xref="S2.SS3.p2.8.m8.1.1.3.3.5.cmml">l</mi></mrow></msub><mo id="S2.SS3.p2.8.m8.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p2.8.m8.1.1.2.cmml">×</mo><mrow id="S2.SS3.p2.8.m8.1.1.1.1" xref="S2.SS3.p2.8.m8.1.1.1.2.cmml"><mo id="S2.SS3.p2.8.m8.1.1.1.1.2" stretchy="false" xref="S2.SS3.p2.8.m8.1.1.1.2.1.cmml">|</mo><msub id="S2.SS3.p2.8.m8.1.1.1.1.1" xref="S2.SS3.p2.8.m8.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.8.m8.1.1.1.1.1.2" xref="S2.SS3.p2.8.m8.1.1.1.1.1.2.cmml">𝒫</mi><mn id="S2.SS3.p2.8.m8.1.1.1.1.1.3" xref="S2.SS3.p2.8.m8.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS3.p2.8.m8.1.1.1.1.3" stretchy="false" xref="S2.SS3.p2.8.m8.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.8.m8.1b"><apply id="S2.SS3.p2.8.m8.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1"><times id="S2.SS3.p2.8.m8.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1.2"></times><apply id="S2.SS3.p2.8.m8.1.1.3.cmml" xref="S2.SS3.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.8.m8.1.1.3.1.cmml" xref="S2.SS3.p2.8.m8.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.8.m8.1.1.3.2.cmml" xref="S2.SS3.p2.8.m8.1.1.3.2">𝑁</ci><apply id="S2.SS3.p2.8.m8.1.1.3.3.cmml" xref="S2.SS3.p2.8.m8.1.1.3.3"><times id="S2.SS3.p2.8.m8.1.1.3.3.1.cmml" xref="S2.SS3.p2.8.m8.1.1.3.3.1"></times><ci id="S2.SS3.p2.8.m8.1.1.3.3.2.cmml" xref="S2.SS3.p2.8.m8.1.1.3.3.2">𝑒</ci><ci id="S2.SS3.p2.8.m8.1.1.3.3.3.cmml" xref="S2.SS3.p2.8.m8.1.1.3.3.3">𝑣</ci><ci id="S2.SS3.p2.8.m8.1.1.3.3.4.cmml" xref="S2.SS3.p2.8.m8.1.1.3.3.4">𝑎</ci><ci id="S2.SS3.p2.8.m8.1.1.3.3.5.cmml" xref="S2.SS3.p2.8.m8.1.1.3.3.5">𝑙</ci></apply></apply><apply id="S2.SS3.p2.8.m8.1.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1"><abs id="S2.SS3.p2.8.m8.1.1.1.2.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.2"></abs><apply id="S2.SS3.p2.8.m8.1.1.1.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1.1.1.1.2">𝒫</ci><cn id="S2.SS3.p2.8.m8.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.p2.8.m8.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.8.m8.1c">N_{eval}\times|\mathcal{P}_{0}|</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.8.m8.1d">italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT × | caligraphic_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT |</annotation></semantics></math> with a large <math alttext="N_{eval}" class="ltx_Math" display="inline" id="S2.SS3.p2.9.m9.1"><semantics id="S2.SS3.p2.9.m9.1a"><msub id="S2.SS3.p2.9.m9.1.1" xref="S2.SS3.p2.9.m9.1.1.cmml"><mi id="S2.SS3.p2.9.m9.1.1.2" xref="S2.SS3.p2.9.m9.1.1.2.cmml">N</mi><mrow id="S2.SS3.p2.9.m9.1.1.3" xref="S2.SS3.p2.9.m9.1.1.3.cmml"><mi id="S2.SS3.p2.9.m9.1.1.3.2" xref="S2.SS3.p2.9.m9.1.1.3.2.cmml">e</mi><mo id="S2.SS3.p2.9.m9.1.1.3.1" xref="S2.SS3.p2.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.9.m9.1.1.3.3" xref="S2.SS3.p2.9.m9.1.1.3.3.cmml">v</mi><mo id="S2.SS3.p2.9.m9.1.1.3.1a" xref="S2.SS3.p2.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.9.m9.1.1.3.4" xref="S2.SS3.p2.9.m9.1.1.3.4.cmml">a</mi><mo id="S2.SS3.p2.9.m9.1.1.3.1b" xref="S2.SS3.p2.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.9.m9.1.1.3.5" xref="S2.SS3.p2.9.m9.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.9.m9.1b"><apply id="S2.SS3.p2.9.m9.1.1.cmml" xref="S2.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.9.m9.1.1.1.cmml" xref="S2.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S2.SS3.p2.9.m9.1.1.2.cmml" xref="S2.SS3.p2.9.m9.1.1.2">𝑁</ci><apply id="S2.SS3.p2.9.m9.1.1.3.cmml" xref="S2.SS3.p2.9.m9.1.1.3"><times id="S2.SS3.p2.9.m9.1.1.3.1.cmml" xref="S2.SS3.p2.9.m9.1.1.3.1"></times><ci id="S2.SS3.p2.9.m9.1.1.3.2.cmml" xref="S2.SS3.p2.9.m9.1.1.3.2">𝑒</ci><ci id="S2.SS3.p2.9.m9.1.1.3.3.cmml" xref="S2.SS3.p2.9.m9.1.1.3.3">𝑣</ci><ci id="S2.SS3.p2.9.m9.1.1.3.4.cmml" xref="S2.SS3.p2.9.m9.1.1.3.4">𝑎</ci><ci id="S2.SS3.p2.9.m9.1.1.3.5.cmml" xref="S2.SS3.p2.9.m9.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.9.m9.1c">N_{eval}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.9.m9.1d">italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math> vs. <math alttext="N_{eval}\times(|\mathcal{P}_{0}|+N_{1}+\cdots+N_{K-1})" class="ltx_Math" display="inline" id="S2.SS3.p2.10.m10.1"><semantics id="S2.SS3.p2.10.m10.1a"><mrow id="S2.SS3.p2.10.m10.1.1" xref="S2.SS3.p2.10.m10.1.1.cmml"><msub id="S2.SS3.p2.10.m10.1.1.3" xref="S2.SS3.p2.10.m10.1.1.3.cmml"><mi id="S2.SS3.p2.10.m10.1.1.3.2" xref="S2.SS3.p2.10.m10.1.1.3.2.cmml">N</mi><mrow id="S2.SS3.p2.10.m10.1.1.3.3" xref="S2.SS3.p2.10.m10.1.1.3.3.cmml"><mi id="S2.SS3.p2.10.m10.1.1.3.3.2" xref="S2.SS3.p2.10.m10.1.1.3.3.2.cmml">e</mi><mo id="S2.SS3.p2.10.m10.1.1.3.3.1" xref="S2.SS3.p2.10.m10.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.10.m10.1.1.3.3.3" xref="S2.SS3.p2.10.m10.1.1.3.3.3.cmml">v</mi><mo id="S2.SS3.p2.10.m10.1.1.3.3.1a" xref="S2.SS3.p2.10.m10.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.10.m10.1.1.3.3.4" xref="S2.SS3.p2.10.m10.1.1.3.3.4.cmml">a</mi><mo id="S2.SS3.p2.10.m10.1.1.3.3.1b" xref="S2.SS3.p2.10.m10.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.10.m10.1.1.3.3.5" xref="S2.SS3.p2.10.m10.1.1.3.3.5.cmml">l</mi></mrow></msub><mo id="S2.SS3.p2.10.m10.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p2.10.m10.1.1.2.cmml">×</mo><mrow id="S2.SS3.p2.10.m10.1.1.1.1" xref="S2.SS3.p2.10.m10.1.1.1.1.1.cmml"><mo id="S2.SS3.p2.10.m10.1.1.1.1.2" stretchy="false" xref="S2.SS3.p2.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p2.10.m10.1.1.1.1.1" xref="S2.SS3.p2.10.m10.1.1.1.1.1.cmml"><mrow id="S2.SS3.p2.10.m10.1.1.1.1.1.1.1" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.2.cmml"><mo id="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.2" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.2.cmml">𝒫</mi><mn id="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.3" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.SS3.p2.10.m10.1.1.1.1.1.2" xref="S2.SS3.p2.10.m10.1.1.1.1.1.2.cmml">+</mo><msub id="S2.SS3.p2.10.m10.1.1.1.1.1.3" xref="S2.SS3.p2.10.m10.1.1.1.1.1.3.cmml"><mi id="S2.SS3.p2.10.m10.1.1.1.1.1.3.2" xref="S2.SS3.p2.10.m10.1.1.1.1.1.3.2.cmml">N</mi><mn id="S2.SS3.p2.10.m10.1.1.1.1.1.3.3" xref="S2.SS3.p2.10.m10.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S2.SS3.p2.10.m10.1.1.1.1.1.2a" xref="S2.SS3.p2.10.m10.1.1.1.1.1.2.cmml">+</mo><mi id="S2.SS3.p2.10.m10.1.1.1.1.1.4" mathvariant="normal" xref="S2.SS3.p2.10.m10.1.1.1.1.1.4.cmml">⋯</mi><mo id="S2.SS3.p2.10.m10.1.1.1.1.1.2b" xref="S2.SS3.p2.10.m10.1.1.1.1.1.2.cmml">+</mo><msub id="S2.SS3.p2.10.m10.1.1.1.1.1.5" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.cmml"><mi id="S2.SS3.p2.10.m10.1.1.1.1.1.5.2" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.2.cmml">N</mi><mrow id="S2.SS3.p2.10.m10.1.1.1.1.1.5.3" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.cmml"><mi id="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.2" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.2.cmml">K</mi><mo id="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.1" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.1.cmml">−</mo><mn id="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.3" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.SS3.p2.10.m10.1.1.1.1.3" stretchy="false" xref="S2.SS3.p2.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.10.m10.1b"><apply id="S2.SS3.p2.10.m10.1.1.cmml" xref="S2.SS3.p2.10.m10.1.1"><times id="S2.SS3.p2.10.m10.1.1.2.cmml" xref="S2.SS3.p2.10.m10.1.1.2"></times><apply id="S2.SS3.p2.10.m10.1.1.3.cmml" xref="S2.SS3.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.10.m10.1.1.3.1.cmml" xref="S2.SS3.p2.10.m10.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.10.m10.1.1.3.2.cmml" xref="S2.SS3.p2.10.m10.1.1.3.2">𝑁</ci><apply id="S2.SS3.p2.10.m10.1.1.3.3.cmml" xref="S2.SS3.p2.10.m10.1.1.3.3"><times id="S2.SS3.p2.10.m10.1.1.3.3.1.cmml" xref="S2.SS3.p2.10.m10.1.1.3.3.1"></times><ci id="S2.SS3.p2.10.m10.1.1.3.3.2.cmml" xref="S2.SS3.p2.10.m10.1.1.3.3.2">𝑒</ci><ci id="S2.SS3.p2.10.m10.1.1.3.3.3.cmml" xref="S2.SS3.p2.10.m10.1.1.3.3.3">𝑣</ci><ci id="S2.SS3.p2.10.m10.1.1.3.3.4.cmml" xref="S2.SS3.p2.10.m10.1.1.3.3.4">𝑎</ci><ci id="S2.SS3.p2.10.m10.1.1.3.3.5.cmml" xref="S2.SS3.p2.10.m10.1.1.3.3.5">𝑙</ci></apply></apply><apply id="S2.SS3.p2.10.m10.1.1.1.1.1.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1"><plus id="S2.SS3.p2.10.m10.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.2"></plus><apply id="S2.SS3.p2.10.m10.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.1"><abs id="S2.SS3.p2.10.m10.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.2"></abs><apply id="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.2">𝒫</ci><cn id="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.p2.10.m10.1.1.1.1.1.1.1.1.3">0</cn></apply></apply><apply id="S2.SS3.p2.10.m10.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.10.m10.1.1.1.1.1.3.1.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.10.m10.1.1.1.1.1.3.2.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.3.2">𝑁</ci><cn id="S2.SS3.p2.10.m10.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS3.p2.10.m10.1.1.1.1.1.3.3">1</cn></apply><ci id="S2.SS3.p2.10.m10.1.1.1.1.1.4.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.4">⋯</ci><apply id="S2.SS3.p2.10.m10.1.1.1.1.1.5.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.SS3.p2.10.m10.1.1.1.1.1.5.1.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5">subscript</csymbol><ci id="S2.SS3.p2.10.m10.1.1.1.1.1.5.2.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.2">𝑁</ci><apply id="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.3"><minus id="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.1.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.1"></minus><ci id="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.2.cmml" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.2">𝐾</ci><cn id="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.3.cmml" type="integer" xref="S2.SS3.p2.10.m10.1.1.1.1.1.5.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.10.m10.1c">N_{eval}\times(|\mathcal{P}_{0}|+N_{1}+\cdots+N_{K-1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.10.m10.1d">italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT × ( | caligraphic_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | + italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + ⋯ + italic_N start_POSTSUBSCRIPT italic_K - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> with a small <math alttext="N_{eval}" class="ltx_Math" display="inline" id="S2.SS3.p2.11.m11.1"><semantics id="S2.SS3.p2.11.m11.1a"><msub id="S2.SS3.p2.11.m11.1.1" xref="S2.SS3.p2.11.m11.1.1.cmml"><mi id="S2.SS3.p2.11.m11.1.1.2" xref="S2.SS3.p2.11.m11.1.1.2.cmml">N</mi><mrow id="S2.SS3.p2.11.m11.1.1.3" xref="S2.SS3.p2.11.m11.1.1.3.cmml"><mi id="S2.SS3.p2.11.m11.1.1.3.2" xref="S2.SS3.p2.11.m11.1.1.3.2.cmml">e</mi><mo id="S2.SS3.p2.11.m11.1.1.3.1" xref="S2.SS3.p2.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.11.m11.1.1.3.3" xref="S2.SS3.p2.11.m11.1.1.3.3.cmml">v</mi><mo id="S2.SS3.p2.11.m11.1.1.3.1a" xref="S2.SS3.p2.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.11.m11.1.1.3.4" xref="S2.SS3.p2.11.m11.1.1.3.4.cmml">a</mi><mo id="S2.SS3.p2.11.m11.1.1.3.1b" xref="S2.SS3.p2.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.11.m11.1.1.3.5" xref="S2.SS3.p2.11.m11.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.11.m11.1b"><apply id="S2.SS3.p2.11.m11.1.1.cmml" xref="S2.SS3.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.11.m11.1.1.1.cmml" xref="S2.SS3.p2.11.m11.1.1">subscript</csymbol><ci id="S2.SS3.p2.11.m11.1.1.2.cmml" xref="S2.SS3.p2.11.m11.1.1.2">𝑁</ci><apply id="S2.SS3.p2.11.m11.1.1.3.cmml" xref="S2.SS3.p2.11.m11.1.1.3"><times id="S2.SS3.p2.11.m11.1.1.3.1.cmml" xref="S2.SS3.p2.11.m11.1.1.3.1"></times><ci id="S2.SS3.p2.11.m11.1.1.3.2.cmml" xref="S2.SS3.p2.11.m11.1.1.3.2">𝑒</ci><ci id="S2.SS3.p2.11.m11.1.1.3.3.cmml" xref="S2.SS3.p2.11.m11.1.1.3.3">𝑣</ci><ci id="S2.SS3.p2.11.m11.1.1.3.4.cmml" xref="S2.SS3.p2.11.m11.1.1.3.4">𝑎</ci><ci id="S2.SS3.p2.11.m11.1.1.3.5.cmml" xref="S2.SS3.p2.11.m11.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.11.m11.1c">N_{eval}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.11.m11.1d">italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math> in our algorithm).</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.7">In the process of validating various trajectories for each question, we exclude instances where <em class="ltx_emph ltx_font_italic" id="S2.SS3.p3.7.1">any</em> trajectory solves the query or <em class="ltx_emph ltx_font_italic" id="S2.SS3.p3.7.2">all</em> fail to do so, as they do not contribute to the planner LLM’s trajectory planning learning.
After identifying the best reasoning trajectory, we leverage GPT-4o to verbally explain why the trajectory is optimal.
Our prompt is shown in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#A4" title="Appendix D Prompts Used in Experiments ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">D</span></a>.
This process is applied to all instances in the training data, giving us tuples of query <math alttext="Q" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.1"><semantics id="S2.SS3.p3.1.m1.1a"><mi id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><ci id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.1d">italic_Q</annotation></semantics></math>, ground true answer <math alttext="y^{*}" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.1"><semantics id="S2.SS3.p3.2.m2.1a"><msup id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml"><mi id="S2.SS3.p3.2.m2.1.1.2" xref="S2.SS3.p3.2.m2.1.1.2.cmml">y</mi><mo id="S2.SS3.p3.2.m2.1.1.3" xref="S2.SS3.p3.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.p3.2.m2.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1.2">𝑦</ci><times id="S2.SS3.p3.2.m2.1.1.3.cmml" xref="S2.SS3.p3.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">y^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.1d">italic_y start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, optimal trajectory <math alttext="p^{*}" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m3.1"><semantics id="S2.SS3.p3.3.m3.1a"><msup id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml"><mi id="S2.SS3.p3.3.m3.1.1.2" xref="S2.SS3.p3.3.m3.1.1.2.cmml">p</mi><mo id="S2.SS3.p3.3.m3.1.1.3" xref="S2.SS3.p3.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><apply id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.1.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.p3.3.m3.1.1.2.cmml" xref="S2.SS3.p3.3.m3.1.1.2">𝑝</ci><times id="S2.SS3.p3.3.m3.1.1.3.cmml" xref="S2.SS3.p3.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">p^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.1d">italic_p start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, and its explanation <math alttext="E" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m4.1"><semantics id="S2.SS3.p3.4.m4.1a"><mi id="S2.SS3.p3.4.m4.1.1" xref="S2.SS3.p3.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><ci id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">E</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m4.1d">italic_E</annotation></semantics></math>.
For internalized planner tuning, we collect the reasoning process <math alttext="R" class="ltx_Math" display="inline" id="S2.SS3.p3.5.m5.1"><semantics id="S2.SS3.p3.5.m5.1a"><mi id="S2.SS3.p3.5.m5.1.1" xref="S2.SS3.p3.5.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m5.1b"><ci id="S2.SS3.p3.5.m5.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m5.1c">R</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.5.m5.1d">italic_R</annotation></semantics></math> when running the solver <math alttext="LLM_{s}" class="ltx_Math" display="inline" id="S2.SS3.p3.6.m6.1"><semantics id="S2.SS3.p3.6.m6.1a"><mrow id="S2.SS3.p3.6.m6.1.1" xref="S2.SS3.p3.6.m6.1.1.cmml"><mi id="S2.SS3.p3.6.m6.1.1.2" xref="S2.SS3.p3.6.m6.1.1.2.cmml">L</mi><mo id="S2.SS3.p3.6.m6.1.1.1" xref="S2.SS3.p3.6.m6.1.1.1.cmml">⁢</mo><mi id="S2.SS3.p3.6.m6.1.1.3" xref="S2.SS3.p3.6.m6.1.1.3.cmml">L</mi><mo id="S2.SS3.p3.6.m6.1.1.1a" xref="S2.SS3.p3.6.m6.1.1.1.cmml">⁢</mo><msub id="S2.SS3.p3.6.m6.1.1.4" xref="S2.SS3.p3.6.m6.1.1.4.cmml"><mi id="S2.SS3.p3.6.m6.1.1.4.2" xref="S2.SS3.p3.6.m6.1.1.4.2.cmml">M</mi><mi id="S2.SS3.p3.6.m6.1.1.4.3" xref="S2.SS3.p3.6.m6.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m6.1b"><apply id="S2.SS3.p3.6.m6.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1"><times id="S2.SS3.p3.6.m6.1.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1.1"></times><ci id="S2.SS3.p3.6.m6.1.1.2.cmml" xref="S2.SS3.p3.6.m6.1.1.2">𝐿</ci><ci id="S2.SS3.p3.6.m6.1.1.3.cmml" xref="S2.SS3.p3.6.m6.1.1.3">𝐿</ci><apply id="S2.SS3.p3.6.m6.1.1.4.cmml" xref="S2.SS3.p3.6.m6.1.1.4"><csymbol cd="ambiguous" id="S2.SS3.p3.6.m6.1.1.4.1.cmml" xref="S2.SS3.p3.6.m6.1.1.4">subscript</csymbol><ci id="S2.SS3.p3.6.m6.1.1.4.2.cmml" xref="S2.SS3.p3.6.m6.1.1.4.2">𝑀</ci><ci id="S2.SS3.p3.6.m6.1.1.4.3.cmml" xref="S2.SS3.p3.6.m6.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m6.1c">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.6.m6.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> following the optimal trajectory <math alttext="p^{*}" class="ltx_Math" display="inline" id="S2.SS3.p3.7.m7.1"><semantics id="S2.SS3.p3.7.m7.1a"><msup id="S2.SS3.p3.7.m7.1.1" xref="S2.SS3.p3.7.m7.1.1.cmml"><mi id="S2.SS3.p3.7.m7.1.1.2" xref="S2.SS3.p3.7.m7.1.1.2.cmml">p</mi><mo id="S2.SS3.p3.7.m7.1.1.3" xref="S2.SS3.p3.7.m7.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.7.m7.1b"><apply id="S2.SS3.p3.7.m7.1.1.cmml" xref="S2.SS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.7.m7.1.1.1.cmml" xref="S2.SS3.p3.7.m7.1.1">superscript</csymbol><ci id="S2.SS3.p3.7.m7.1.1.2.cmml" xref="S2.SS3.p3.7.m7.1.1.2">𝑝</ci><times id="S2.SS3.p3.7.m7.1.1.3.cmml" xref="S2.SS3.p3.7.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.7.m7.1c">p^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.7.m7.1d">italic_p start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Learning to Plan for Optimal Reasoning Trajectories</h3>
<div class="ltx_para ltx_noindent" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.4">Having obtained the optimal trajectories, we then use supervised fine-tuning with cross-entropy loss to train the planner LLM to predict optimal trajectories for input questions and the specific solver LLM.
For external planner tuning, a lightweight <math alttext="LLM_{p}" class="ltx_Math" display="inline" id="S2.SS4.p1.1.m1.1"><semantics id="S2.SS4.p1.1.m1.1a"><mrow id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml"><mi id="S2.SS4.p1.1.m1.1.1.2" xref="S2.SS4.p1.1.m1.1.1.2.cmml">L</mi><mo id="S2.SS4.p1.1.m1.1.1.1" xref="S2.SS4.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.SS4.p1.1.m1.1.1.3" xref="S2.SS4.p1.1.m1.1.1.3.cmml">L</mi><mo id="S2.SS4.p1.1.m1.1.1.1a" xref="S2.SS4.p1.1.m1.1.1.1.cmml">⁢</mo><msub id="S2.SS4.p1.1.m1.1.1.4" xref="S2.SS4.p1.1.m1.1.1.4.cmml"><mi id="S2.SS4.p1.1.m1.1.1.4.2" xref="S2.SS4.p1.1.m1.1.1.4.2.cmml">M</mi><mi id="S2.SS4.p1.1.m1.1.1.4.3" xref="S2.SS4.p1.1.m1.1.1.4.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><apply id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1"><times id="S2.SS4.p1.1.m1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1.1"></times><ci id="S2.SS4.p1.1.m1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.1.2">𝐿</ci><ci id="S2.SS4.p1.1.m1.1.1.3.cmml" xref="S2.SS4.p1.1.m1.1.1.3">𝐿</ci><apply id="S2.SS4.p1.1.m1.1.1.4.cmml" xref="S2.SS4.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.1.4.1.cmml" xref="S2.SS4.p1.1.m1.1.1.4">subscript</csymbol><ci id="S2.SS4.p1.1.m1.1.1.4.2.cmml" xref="S2.SS4.p1.1.m1.1.1.4.2">𝑀</ci><ci id="S2.SS4.p1.1.m1.1.1.4.3.cmml" xref="S2.SS4.p1.1.m1.1.1.4.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">LLM_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> is trained to predict a concatenation of the explanation and the optimal trajectory (Eq <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.E1" title="In External Planner Tuning ‣ 2.1 Overview ‣ 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">1</span></a>); for internalized planner tuning, the solver <math alttext="LLM_{s}" class="ltx_Math" display="inline" id="S2.SS4.p1.2.m2.1"><semantics id="S2.SS4.p1.2.m2.1a"><mrow id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml"><mi id="S2.SS4.p1.2.m2.1.1.2" xref="S2.SS4.p1.2.m2.1.1.2.cmml">L</mi><mo id="S2.SS4.p1.2.m2.1.1.1" xref="S2.SS4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS4.p1.2.m2.1.1.3" xref="S2.SS4.p1.2.m2.1.1.3.cmml">L</mi><mo id="S2.SS4.p1.2.m2.1.1.1a" xref="S2.SS4.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S2.SS4.p1.2.m2.1.1.4" xref="S2.SS4.p1.2.m2.1.1.4.cmml"><mi id="S2.SS4.p1.2.m2.1.1.4.2" xref="S2.SS4.p1.2.m2.1.1.4.2.cmml">M</mi><mi id="S2.SS4.p1.2.m2.1.1.4.3" xref="S2.SS4.p1.2.m2.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><apply id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1"><times id="S2.SS4.p1.2.m2.1.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1.1"></times><ci id="S2.SS4.p1.2.m2.1.1.2.cmml" xref="S2.SS4.p1.2.m2.1.1.2">𝐿</ci><ci id="S2.SS4.p1.2.m2.1.1.3.cmml" xref="S2.SS4.p1.2.m2.1.1.3">𝐿</ci><apply id="S2.SS4.p1.2.m2.1.1.4.cmml" xref="S2.SS4.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S2.SS4.p1.2.m2.1.1.4.1.cmml" xref="S2.SS4.p1.2.m2.1.1.4">subscript</csymbol><ci id="S2.SS4.p1.2.m2.1.1.4.2.cmml" xref="S2.SS4.p1.2.m2.1.1.4.2">𝑀</ci><ci id="S2.SS4.p1.2.m2.1.1.4.3.cmml" xref="S2.SS4.p1.2.m2.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is trained to predict the explanation, the optimal trajectory, the reasoning process collected from <math alttext="LLM_{s}" class="ltx_Math" display="inline" id="S2.SS4.p1.3.m3.1"><semantics id="S2.SS4.p1.3.m3.1a"><mrow id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml"><mi id="S2.SS4.p1.3.m3.1.1.2" xref="S2.SS4.p1.3.m3.1.1.2.cmml">L</mi><mo id="S2.SS4.p1.3.m3.1.1.1" xref="S2.SS4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S2.SS4.p1.3.m3.1.1.3" xref="S2.SS4.p1.3.m3.1.1.3.cmml">L</mi><mo id="S2.SS4.p1.3.m3.1.1.1a" xref="S2.SS4.p1.3.m3.1.1.1.cmml">⁢</mo><msub id="S2.SS4.p1.3.m3.1.1.4" xref="S2.SS4.p1.3.m3.1.1.4.cmml"><mi id="S2.SS4.p1.3.m3.1.1.4.2" xref="S2.SS4.p1.3.m3.1.1.4.2.cmml">M</mi><mi id="S2.SS4.p1.3.m3.1.1.4.3" xref="S2.SS4.p1.3.m3.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><apply id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1"><times id="S2.SS4.p1.3.m3.1.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1.1"></times><ci id="S2.SS4.p1.3.m3.1.1.2.cmml" xref="S2.SS4.p1.3.m3.1.1.2">𝐿</ci><ci id="S2.SS4.p1.3.m3.1.1.3.cmml" xref="S2.SS4.p1.3.m3.1.1.3">𝐿</ci><apply id="S2.SS4.p1.3.m3.1.1.4.cmml" xref="S2.SS4.p1.3.m3.1.1.4"><csymbol cd="ambiguous" id="S2.SS4.p1.3.m3.1.1.4.1.cmml" xref="S2.SS4.p1.3.m3.1.1.4">subscript</csymbol><ci id="S2.SS4.p1.3.m3.1.1.4.2.cmml" xref="S2.SS4.p1.3.m3.1.1.4.2">𝑀</ci><ci id="S2.SS4.p1.3.m3.1.1.4.3.cmml" xref="S2.SS4.p1.3.m3.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">LLM_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.3.m3.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> itself, and the true answer <math alttext="y^{*}" class="ltx_Math" display="inline" id="S2.SS4.p1.4.m4.1"><semantics id="S2.SS4.p1.4.m4.1a"><msup id="S2.SS4.p1.4.m4.1.1" xref="S2.SS4.p1.4.m4.1.1.cmml"><mi id="S2.SS4.p1.4.m4.1.1.2" xref="S2.SS4.p1.4.m4.1.1.2.cmml">y</mi><mo id="S2.SS4.p1.4.m4.1.1.3" xref="S2.SS4.p1.4.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.4.m4.1b"><apply id="S2.SS4.p1.4.m4.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.4.m4.1.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS4.p1.4.m4.1.1.2.cmml" xref="S2.SS4.p1.4.m4.1.1.2">𝑦</ci><times id="S2.SS4.p1.4.m4.1.1.3.cmml" xref="S2.SS4.p1.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.4.m4.1c">y^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.4.m4.1d">italic_y start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> (Eq <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S2.E3" title="In Internalized Planner Tuning ‣ 2.1 Overview ‣ 2 \method: Learning to Reason Dynamically ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiment</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Experimental Setup</h3>
<figure class="ltx_table ltx_align_floatright" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Overview of our evaluation datasets.
</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T2.1" style="width:178.9pt;height:119pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.3pt,21.5pt) scale(0.734649266978875,0.734649266978875) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T2.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.1.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.1.1.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.2.1">Distribution</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.1.1.1.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.3.1">Task Type</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.1.1.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">MATH</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">In Distribution</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.1.2.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">math</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.1.1.3.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">BBH</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.3.3.2" rowspan="3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.1.3.3.2.1">Few-shot</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.1.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">mixture</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.1.4.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">Game of 24</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.1.4.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">numerical</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.1.5.5.1" style="padding-left:3.0pt;padding-right:3.0pt;">TheoremQA</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.1.5.5.2" style="padding-left:3.0pt;padding-right:3.0pt;">scientific</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.1.1.6.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">Deepmind Math</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T2.1.1.6.6.2" rowspan="4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.1.6.6.2.1">Out-of-Distribution</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.1.6.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">math</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.7.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.1.7.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">MMLU-pro</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.1.7.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">scientific</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.8.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.1.8.8.1" style="padding-left:3.0pt;padding-right:3.0pt;">StrategyQA</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.1.8.8.2" style="padding-left:3.0pt;padding-right:3.0pt;">common sense</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S3.T2.1.1.9.9.1" style="padding-left:3.0pt;padding-right:3.0pt;">DROP</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T2.1.1.9.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">multi-hop</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Datasets</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.1">We evaluate the effectiveness of our method across multiple datasets and various reasoning tasks.
Based on the distribution of the training and testing data, we divide the evaluation into three settings as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T2" title="Table 2 ‣ 3.1 Experimental Setup ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">2</span></a>:
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS1.SSS0.Px1.p1.1.1">In-distribution setting</span> evaluates the model that resembles what it has seen during training.
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS1.SSS0.Px1.p1.1.2">Few-shot setting</span> aims to evaluate whether our proposed method can effectively learn from a small amount of labeled data. In the real world, it is often difficult to obtain large amounts of in-domain training data across different tasks, but a small number of cases can be annotated.
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS1.SSS0.Px1.p1.1.3">Out-of-distribution (OOD) setting</span> further evaluates whether the model can handle scenarios it was not explicitly trained for, testing its ability to generalize beyond the training set.
For the training data, we use the MATH <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib14" title="">2021</a>)</cite> training set. For the few-shot learning, we select 4 examples from each category of BBH <cite class="ltx_cite ltx_citemacro_citep">(Suzgun et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib30" title="">2022</a>)</cite> as it is composed of 27 diverse tasks,<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/datasets/lukaemon/bbh" title="">https://huggingface.co/datasets/lukaemon/bbh</a></span></span></span> resulting in 108 examples in total, 4 examples from Game of 24 <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib38" title="">2024</a>)</cite>, and 4 examples from TheoremQA <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib7" title="">2023</a>)</cite> datasets.
For the test data, we evaluate the model on the test set of the MATH dataset for the in-distribution setting and on the test sets or hold-out sets of BBH, Game of 24, and TheoremQA for the few-shot learning setting. For the OOD evaluation, we test each approach’s generalization ability on Deepmind Math <cite class="ltx_cite ltx_citemacro_citep">(Saxton et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib28" title="">2019</a>)</cite>, MMLU-pro <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib34" title="">2024</a>)</cite>, strategyQA <cite class="ltx_cite ltx_citemacro_citep">(Geva et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib12" title="">2021</a>)</cite>, and DROP <cite class="ltx_cite ltx_citemacro_citep">(Dua et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib9" title="">2019</a>)</cite>.
All evaluations (unless specified) were conducted when prompting the solver LLMs in zero shot.
For answer evaluation, we use the simple-eval<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/openai/simple-evals" title="">https://github.com/openai/simple-evals</a>.</span></span></span> for MATH, a standard evaluation for Game of 24 <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib38" title="">2024</a>)</cite>, and exact string matching for the others.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Training Setup</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.1">For external planner tuning, we utilize Llama-3-8B-Instruct as our planner and GPT-4o-mini and Llama-70B-Instruct as task-solving LLMs.
Experiments of internalized planner tuning were conducted with Llama-3-8B-Instruct. For more details, refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#A1" title="Appendix A Training Implementation ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Baselines</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We include the following highly related baselines in our experiments.
(1) CoT <cite class="ltx_cite ltx_citemacro_citep">(Wei et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib35" title="">2022</a>)</cite> prompts an LLM to answer step-by-step; (2) PoT <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib6" title="">2022</a>)</cite> prompts an LLM to generate Python code and execute the code to get the final answer; (3) Least-to-most (LTM) <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib44" title="">2023</a>)</cite> prompts an LLM to first decompose the question into multiple sub-questions before solving it;
(4) Self-refine <cite class="ltx_cite ltx_citemacro_citep">(Madaan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib22" title="">2024</a>)</cite> prompts an LLM to generate the answer and verify and refine the answer by the LLM itself. <cite class="ltx_cite ltx_citemacro_cite">Madaan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib22" title="">2024</a>)</cite> used PoT in solving math questions, therefore we follow their setting to use PoT in generating the initial answer;
(5) PromptAgent (PA) <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib32" title="">2023</a>)</cite> searches for a better prompt for the specific task based on its training data;
this baseline is implemented with the default hyperparameter setting;
and (6) Vanilla Supervised Fine-Tuning
(Vanilla SFT) uses GPT-4o to generate the CoT reasoning process for questions in the training datasets and then fine-tune the solver LLM to predict the generated reasoning process and the ground-truth answer; this baseline is fine-tuned using the same hyperparameter setting as our internalized planner tuning.
The training data for PA, Vanilla SFT, and <span class="ltx_ERROR undefined" id="S3.SS2.p1.1.1">\method</span>are from the same source.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>External Planner Tuning Results</h3>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Accuracy (%) of the external planner tuning on in-distribution and few-shot datasets. The reasoning format <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.3.m1.1"><semantics id="S3.T3.3.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S3.T3.3.m1.1.1" xref="S3.T3.3.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.3.m1.1c"><ci id="S3.T3.3.m1.1.1.cmml" xref="S3.T3.3.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.3.m1.1d">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.3.m1.1e">caligraphic_L</annotation></semantics></math> represents language, and <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.T3.4.m2.1"><semantics id="S3.T3.4.m2.1b"><mi class="ltx_font_mathcaligraphic" id="S3.T3.4.m2.1.1" xref="S3.T3.4.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T3.4.m2.1c"><ci id="S3.T3.4.m2.1.1.cmml" xref="S3.T3.4.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.4.m2.1d">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.4.m2.1e">caligraphic_P</annotation></semantics></math> means program.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T3.20">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.20.17.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.20.17.1.1" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T3.20.17.1.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.20.17.1.2" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T3.20.17.1.2.1">Tuning</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.20.17.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Reasoning</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.20.17.1.4" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T3.20.17.1.4.1">MATH</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.20.17.1.5" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T3.20.17.1.5.1">BBH</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.20.17.1.6" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T3.20.17.1.6.1">Game of 24</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T3.20.17.1.7" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T3.20.17.1.7.1">TheoremQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.20.17.1.8" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T3.20.17.1.8.1">Average</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.20.18.2">
<td class="ltx_td ltx_align_center" id="S3.T3.20.18.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">Format</td>
</tr>
<tr class="ltx_tr" id="S3.T3.20.19.3">
<td class="ltx_td ltx_align_left ltx_border_tt" colspan="8" id="S3.T3.20.19.3.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.20.19.3.1.1">External Planner: Llama-3-8B-Instruct; Solver: Llama-3-70B-Instruct</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.5.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.5.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">CoT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.5.1.1.m1.1"><semantics id="S3.T3.5.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.5.1.1.m1.1.1" xref="S3.T3.5.1.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.5.1.1.m1.1b"><ci id="S3.T3.5.1.1.m1.1.1.cmml" xref="S3.T3.5.1.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.5.1.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.5.1.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">50.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">72.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.1.6" style="padding-left:3.0pt;padding-right:3.0pt;">27.5</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T3.5.1.7" style="padding-left:3.0pt;padding-right:3.0pt;">27.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.1.8" style="padding-left:3.0pt;padding-right:3.0pt;">44.5</td>
</tr>
<tr class="ltx_tr" id="S3.T3.6.2">
<td class="ltx_td ltx_align_left" id="S3.T3.6.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">LTM</td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.6.2.1.m1.1"><semantics id="S3.T3.6.2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.6.2.1.m1.1.1" xref="S3.T3.6.2.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.6.2.1.m1.1b"><ci id="S3.T3.6.2.1.m1.1.1.cmml" xref="S3.T3.6.2.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.6.2.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.6.2.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">50.1</td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">73.8</td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">24.9</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T3.6.2.7" style="padding-left:3.0pt;padding-right:3.0pt;">28.8</td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.2.8" style="padding-left:3.0pt;padding-right:3.0pt;">44.4</td>
</tr>
<tr class="ltx_tr" id="S3.T3.7.3">
<td class="ltx_td ltx_align_left" id="S3.T3.7.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">PA</td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.3.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.7.3.1.m1.1"><semantics id="S3.T3.7.3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.7.3.1.m1.1.1" xref="S3.T3.7.3.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.7.3.1.m1.1b"><ci id="S3.T3.7.3.1.m1.1.1.cmml" xref="S3.T3.7.3.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.7.3.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.7.3.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">52.5</td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">72.9</td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">26.8</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T3.7.3.7" style="padding-left:3.0pt;padding-right:3.0pt;">28.8</td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.3.8" style="padding-left:3.0pt;padding-right:3.0pt;">45.3</td>
</tr>
<tr class="ltx_tr" id="S3.T3.8.4">
<td class="ltx_td ltx_align_left" id="S3.T3.8.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">PoT</td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.4.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.T3.8.4.1.m1.1"><semantics id="S3.T3.8.4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.8.4.1.m1.1.1" xref="S3.T3.8.4.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T3.8.4.1.m1.1b"><ci id="S3.T3.8.4.1.m1.1.1.cmml" xref="S3.T3.8.4.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.8.4.1.m1.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.8.4.1.m1.1d">caligraphic_P</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">54.7</td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">65.8</td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">63.9</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T3.8.4.7" style="padding-left:3.0pt;padding-right:3.0pt;">31.1</td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.4.8" style="padding-left:3.0pt;padding-right:3.0pt;">53.9</td>
</tr>
<tr class="ltx_tr" id="S3.T3.10.6">
<td class="ltx_td ltx_align_left" id="S3.T3.10.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">Self-refine</td>
<td class="ltx_td ltx_align_center" id="S3.T3.10.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T3.10.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.9.5.1.m1.1"><semantics id="S3.T3.9.5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.9.5.1.m1.1.1" xref="S3.T3.9.5.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.9.5.1.m1.1b"><ci id="S3.T3.9.5.1.m1.1.1.cmml" xref="S3.T3.9.5.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.9.5.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.9.5.1.m1.1d">caligraphic_L</annotation></semantics></math>, <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.T3.10.6.2.m2.1"><semantics id="S3.T3.10.6.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.10.6.2.m2.1.1" xref="S3.T3.10.6.2.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T3.10.6.2.m2.1b"><ci id="S3.T3.10.6.2.m2.1.1.cmml" xref="S3.T3.10.6.2.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.10.6.2.m2.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.10.6.2.m2.1d">caligraphic_P</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.10.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">55.9</td>
<td class="ltx_td ltx_align_center" id="S3.T3.10.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">71.4</td>
<td class="ltx_td ltx_align_center" id="S3.T3.10.6.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.10.6.7.1">68.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T3.10.6.8" style="padding-left:3.0pt;padding-right:3.0pt;">30.8</td>
<td class="ltx_td ltx_align_center" id="S3.T3.10.6.9" style="padding-left:3.0pt;padding-right:3.0pt;">56.6</td>
</tr>
<tr class="ltx_tr" id="S3.T3.12.8">
<td class="ltx_td ltx_align_left" id="S3.T3.12.8.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T3.12.8.3.1">\method</span><span class="ltx_text ltx_font_bold" id="S3.T3.12.8.3.2">: External</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.12.8.4" style="padding-left:3.0pt;padding-right:3.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T3.12.8.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.11.7.1.m1.1"><semantics id="S3.T3.11.7.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.11.7.1.m1.1.1" xref="S3.T3.11.7.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.11.7.1.m1.1b"><ci id="S3.T3.11.7.1.m1.1.1.cmml" xref="S3.T3.11.7.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.11.7.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.11.7.1.m1.1d">caligraphic_L</annotation></semantics></math>, <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.T3.12.8.2.m2.1"><semantics id="S3.T3.12.8.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.12.8.2.m2.1.1" xref="S3.T3.12.8.2.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T3.12.8.2.m2.1b"><ci id="S3.T3.12.8.2.m2.1.1.cmml" xref="S3.T3.12.8.2.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.12.8.2.m2.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.12.8.2.m2.1d">caligraphic_P</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.12.8.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.12.8.5.1">57.7</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.12.8.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.12.8.6.1">77.3</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.12.8.7" style="padding-left:3.0pt;padding-right:3.0pt;">67.7</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T3.12.8.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.12.8.8.1">31.2</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.12.8.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.12.8.9.1">58.5</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.20.20.4">
<td class="ltx_td ltx_align_left ltx_border_tt" colspan="8" id="S3.T3.20.20.4.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.20.20.4.1.1">External Planner: Llama-3-8B-Instruct; Solver: GPT4o-mini</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.13.9">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.13.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">CoT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.13.9.3" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.13.9.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.13.9.1.m1.1"><semantics id="S3.T3.13.9.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.13.9.1.m1.1.1" xref="S3.T3.13.9.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.13.9.1.m1.1b"><ci id="S3.T3.13.9.1.m1.1.1.cmml" xref="S3.T3.13.9.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.13.9.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.13.9.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.13.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">70.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.13.9.5" style="padding-left:3.0pt;padding-right:3.0pt;">80.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.13.9.6" style="padding-left:3.0pt;padding-right:3.0pt;">27.7</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T3.13.9.7" style="padding-left:3.0pt;padding-right:3.0pt;">38.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.13.9.8" style="padding-left:3.0pt;padding-right:3.0pt;">54.2</td>
</tr>
<tr class="ltx_tr" id="S3.T3.14.10">
<td class="ltx_td ltx_align_left" id="S3.T3.14.10.2" style="padding-left:3.0pt;padding-right:3.0pt;">LTM</td>
<td class="ltx_td ltx_align_center" id="S3.T3.14.10.3" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T3.14.10.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.14.10.1.m1.1"><semantics id="S3.T3.14.10.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.14.10.1.m1.1.1" xref="S3.T3.14.10.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.14.10.1.m1.1b"><ci id="S3.T3.14.10.1.m1.1.1.cmml" xref="S3.T3.14.10.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.14.10.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.14.10.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.14.10.4" style="padding-left:3.0pt;padding-right:3.0pt;">72.2</td>
<td class="ltx_td ltx_align_center" id="S3.T3.14.10.5" style="padding-left:3.0pt;padding-right:3.0pt;">79.4</td>
<td class="ltx_td ltx_align_center" id="S3.T3.14.10.6" style="padding-left:3.0pt;padding-right:3.0pt;">25.5</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T3.14.10.7" style="padding-left:3.0pt;padding-right:3.0pt;">36.4</td>
<td class="ltx_td ltx_align_center" id="S3.T3.14.10.8" style="padding-left:3.0pt;padding-right:3.0pt;">53.3</td>
</tr>
<tr class="ltx_tr" id="S3.T3.15.11">
<td class="ltx_td ltx_align_left" id="S3.T3.15.11.2" style="padding-left:3.0pt;padding-right:3.0pt;">PA</td>
<td class="ltx_td ltx_align_center" id="S3.T3.15.11.3" style="padding-left:3.0pt;padding-right:3.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T3.15.11.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.15.11.1.m1.1"><semantics id="S3.T3.15.11.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.15.11.1.m1.1.1" xref="S3.T3.15.11.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.15.11.1.m1.1b"><ci id="S3.T3.15.11.1.m1.1.1.cmml" xref="S3.T3.15.11.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.15.11.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.15.11.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.15.11.4" style="padding-left:3.0pt;padding-right:3.0pt;">73.5</td>
<td class="ltx_td ltx_align_center" id="S3.T3.15.11.5" style="padding-left:3.0pt;padding-right:3.0pt;">81.1</td>
<td class="ltx_td ltx_align_center" id="S3.T3.15.11.6" style="padding-left:3.0pt;padding-right:3.0pt;">26.7</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T3.15.11.7" style="padding-left:3.0pt;padding-right:3.0pt;">38.9</td>
<td class="ltx_td ltx_align_center" id="S3.T3.15.11.8" style="padding-left:3.0pt;padding-right:3.0pt;">55.1</td>
</tr>
<tr class="ltx_tr" id="S3.T3.16.12">
<td class="ltx_td ltx_align_left" id="S3.T3.16.12.2" style="padding-left:3.0pt;padding-right:3.0pt;">PoT</td>
<td class="ltx_td ltx_align_center" id="S3.T3.16.12.3" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T3.16.12.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.T3.16.12.1.m1.1"><semantics id="S3.T3.16.12.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.16.12.1.m1.1.1" xref="S3.T3.16.12.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T3.16.12.1.m1.1b"><ci id="S3.T3.16.12.1.m1.1.1.cmml" xref="S3.T3.16.12.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.16.12.1.m1.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.16.12.1.m1.1d">caligraphic_P</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.16.12.4" style="padding-left:3.0pt;padding-right:3.0pt;">67.2</td>
<td class="ltx_td ltx_align_center" id="S3.T3.16.12.5" style="padding-left:3.0pt;padding-right:3.0pt;">73.9</td>
<td class="ltx_td ltx_align_center" id="S3.T3.16.12.6" style="padding-left:3.0pt;padding-right:3.0pt;">61.4</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T3.16.12.7" style="padding-left:3.0pt;padding-right:3.0pt;">35.8</td>
<td class="ltx_td ltx_align_center" id="S3.T3.16.12.8" style="padding-left:3.0pt;padding-right:3.0pt;">59.6</td>
</tr>
<tr class="ltx_tr" id="S3.T3.18.14">
<td class="ltx_td ltx_align_left" id="S3.T3.18.14.3" style="padding-left:3.0pt;padding-right:3.0pt;">Self-refine</td>
<td class="ltx_td ltx_align_center" id="S3.T3.18.14.4" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T3.18.14.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.17.13.1.m1.1"><semantics id="S3.T3.17.13.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.17.13.1.m1.1.1" xref="S3.T3.17.13.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.17.13.1.m1.1b"><ci id="S3.T3.17.13.1.m1.1.1.cmml" xref="S3.T3.17.13.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.17.13.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.17.13.1.m1.1d">caligraphic_L</annotation></semantics></math>, <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.T3.18.14.2.m2.1"><semantics id="S3.T3.18.14.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.18.14.2.m2.1.1" xref="S3.T3.18.14.2.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T3.18.14.2.m2.1b"><ci id="S3.T3.18.14.2.m2.1.1.cmml" xref="S3.T3.18.14.2.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.18.14.2.m2.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.18.14.2.m2.1d">caligraphic_P</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.18.14.5" style="padding-left:3.0pt;padding-right:3.0pt;">73.7</td>
<td class="ltx_td ltx_align_center" id="S3.T3.18.14.6" style="padding-left:3.0pt;padding-right:3.0pt;">74.8</td>
<td class="ltx_td ltx_align_center" id="S3.T3.18.14.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.18.14.7.1">68.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T3.18.14.8" style="padding-left:3.0pt;padding-right:3.0pt;">34.6</td>
<td class="ltx_td ltx_align_center" id="S3.T3.18.14.9" style="padding-left:3.0pt;padding-right:3.0pt;">63.0</td>
</tr>
<tr class="ltx_tr" id="S3.T3.20.16">
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T3.20.16.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T3.20.16.3.1">\method</span><span class="ltx_text ltx_font_bold" id="S3.T3.20.16.3.2">: External</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.20.16.4" style="padding-left:3.0pt;padding-right:3.0pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.20.16.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T3.19.15.1.m1.1"><semantics id="S3.T3.19.15.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.19.15.1.m1.1.1" xref="S3.T3.19.15.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T3.19.15.1.m1.1b"><ci id="S3.T3.19.15.1.m1.1.1.cmml" xref="S3.T3.19.15.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.19.15.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.19.15.1.m1.1d">caligraphic_L</annotation></semantics></math>, <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.T3.20.16.2.m2.1"><semantics id="S3.T3.20.16.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T3.20.16.2.m2.1.1" xref="S3.T3.20.16.2.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T3.20.16.2.m2.1b"><ci id="S3.T3.20.16.2.m2.1.1.cmml" xref="S3.T3.20.16.2.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.20.16.2.m2.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.20.16.2.m2.1d">caligraphic_P</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.20.16.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.20.16.5.1">75.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.20.16.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.20.16.6.1">84.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.20.16.7" style="padding-left:3.0pt;padding-right:3.0pt;">65.2</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_rr" id="S3.T3.20.16.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.20.16.8.1">41.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.20.16.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.20.16.9.1">66.5</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T3" title="Table 3 ‣ 3.3 External Planner Tuning Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">3</span></a> presents the results of using the external planner, which suggest that:</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">External planner tuning outperforms other methods on the in-domain task</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.1">Our method achieves 57.7% accuracy with Llama-3-70b-Instruct and 75.4% accuracy with GPT-4o-mini on MATH, achieving significant improvement than baselines.
This suggests that <span class="ltx_ERROR undefined" id="S3.SS3.SSS0.Px1.p1.1.1">\method</span>is robust across different LLMs and it can significantly enhance the LLM’s zero-shot reasoning ability.
The improvement from <span class="ltx_ERROR undefined" id="S3.SS3.SSS0.Px1.p1.1.2">\method</span>remains consistent as the solver LLM’s capabilities increase, indicating <span class="ltx_ERROR undefined" id="S3.SS3.SSS0.Px1.p1.1.3">\method</span>has a long-term value even as LLMs continue to improve rapidly.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">The external planner can learn the appropriate action trajectory with only a few training examples.</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.1">On the BBH, <span class="ltx_ERROR undefined" id="S3.SS3.SSS0.Px2.p1.1.1">\method</span>achieves improvements of 3.5% and 3.1% over the best static methods when using Llama-3-70B-Instruct and GPT-4o-mini, respectively. In the Game of 24 and TheoremQA, <span class="ltx_ERROR undefined" id="S3.SS3.SSS0.Px2.p1.1.2">\method</span>also shows slight improvements or performs similarly to the best static method.
This indicates that even a small number of cases can help the LLM learn the optimal strategy for the given task.
Besides, <span class="ltx_ERROR undefined" id="S3.SS3.SSS0.Px2.p1.1.3">\method</span>demonstrates greater stability across various datasets.
Our flexible action trajectory selection demonstrates its advantages on datasets requiring diverse reasoning actions, such as BBH as shown in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#A3" title="Appendix C Sub-Task Performance of BBH ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">C</span></a>.
Conversely, the Game of 24 features a uniform question type, where the predefined static method self-refine is sufficient.
While the self-refine excels on Game of 24, it significantly lags behind on other datasets.
This reflects the external planner’s ability to effectively select the appropriate action trajectory, leading to more robust performance even across tasks with varying reasoning demands.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Internalized Planner Tuning Results</h3>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T4" title="Table 4 ‣ Searching for the optimal reasoning action trajectory helps enhance the utilization of training data ‣ 3.4 Internalized Planner Tuning Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">4</span></a> presents the results of our internalized planner tuning, where we observed:</p>
</div>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Internalized planner tuning demonstrates superior performance</h4>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px1.p1">
<span class="ltx_ERROR undefined" id="S3.SS4.SSS0.Px1.p1.2">\method</span>
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p1.1">outperforms existing methods on average, including prompt engineering methods and vanilla SFT.
Notably, our approach surpasses self-refine in the Game of 24, a different observation than the experiments with an external planner (Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T3" title="Table 3 ‣ 3.3 External Planner Tuning Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">3</span></a>).
We attribute this performance boost to our joint optimization of the trajectory planning and problem-solving processes. Unlike external planner tuning which only updates the external planner (<math alttext="LLM_{p}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS4.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS4.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.2.cmml">L</mi><mo id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.3.cmml">L</mi><mo id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1a" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.cmml">⁢</mo><msub id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.2.cmml">M</mi><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1"><times id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1"></times><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.2">𝐿</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.3">𝐿</ci><apply id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.2">𝑀</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.4.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.1.m1.1c">LLM_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.1.m1.1d">italic_L italic_L italic_M start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>), internalized planner tuning enables the task-solving LLM to simultaneously learn trajectory planning and accurate reasoning process generation.
This highlights that the internalized planner tuning effectively further enhances performance.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Searching for the optimal reasoning action trajectory helps enhance the utilization of training data</h4>
<div class="ltx_para" id="S3.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p1.1">Compared to vanilla SFT, our method consistently shows performance improvements across all datasets, notably achieving an 8.7% increase on BBH. This suggests that, instead of training with a question and step-by-step reasoning process pair, our approach of searching for an optimal action trajectory and generating the corresponding reasoning process to construct training data is superior.
This finding indicates that our search methodology could effectively enhance the utilization of training data for reasoning tasks without the need for additional human annotations.</p>
</div>
<figure class="ltx_table" id="S3.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Internal planner tuning performance on in-distribution and few-shot datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T4.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.9.10.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.9.10.1.1" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T4.9.10.1.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.9.10.1.2" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T4.9.10.1.2.1">Tuning</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.9.10.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Reasoning</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.9.10.1.4" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T4.9.10.1.4.1">MATH</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.9.10.1.5" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T4.9.10.1.5.1">BBH</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.9.10.1.6" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T4.9.10.1.6.1">Game of 24</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T4.9.10.1.7" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T4.9.10.1.7.1">TheoremQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.9.10.1.8" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T4.9.10.1.8.1">Average</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.9.11.2">
<td class="ltx_td ltx_align_center" id="S3.T4.9.11.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">format</td>
</tr>
<tr class="ltx_tr" id="S3.T4.9.12.3">
<td class="ltx_td ltx_align_left ltx_border_tt" colspan="8" id="S3.T4.9.12.3.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.9.12.3.1.1">Solver: Llama-3-8B-Instruct</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.1.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">CoT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T4.1.1.1.m1.1"><semantics id="S3.T4.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T4.1.1.1.m1.1.1" xref="S3.T4.1.1.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T4.1.1.1.m1.1b"><ci id="S3.T4.1.1.1.m1.1.1.cmml" xref="S3.T4.1.1.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.1.1.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.1.1.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">29.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">48.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.6" style="padding-left:3.0pt;padding-right:3.0pt;">12.7</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T4.1.1.7" style="padding-left:3.0pt;padding-right:3.0pt;">14.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.8" style="padding-left:3.0pt;padding-right:3.0pt;">26.5</td>
</tr>
<tr class="ltx_tr" id="S3.T4.2.2">
<td class="ltx_td ltx_align_left" id="S3.T4.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">LTM</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T4.2.2.1.m1.1"><semantics id="S3.T4.2.2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T4.2.2.1.m1.1.1" xref="S3.T4.2.2.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T4.2.2.1.m1.1b"><ci id="S3.T4.2.2.1.m1.1.1.cmml" xref="S3.T4.2.2.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.2.2.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.2.2.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">29.5</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">50.3</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">14.4</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T4.2.2.7" style="padding-left:3.0pt;padding-right:3.0pt;">15.2</td>
<td class="ltx_td ltx_align_center" id="S3.T4.2.2.8" style="padding-left:3.0pt;padding-right:3.0pt;">27.4</td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.3">
<td class="ltx_td ltx_align_left" id="S3.T4.3.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">PA</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.3.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T4.3.3.1.m1.1"><semantics id="S3.T4.3.3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T4.3.3.1.m1.1.1" xref="S3.T4.3.3.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T4.3.3.1.m1.1b"><ci id="S3.T4.3.3.1.m1.1.1.cmml" xref="S3.T4.3.3.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.3.3.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.3.3.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">31.0</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">47.2</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">11.8</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T4.3.3.7" style="padding-left:3.0pt;padding-right:3.0pt;">15.1</td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.3.8" style="padding-left:3.0pt;padding-right:3.0pt;">26.3</td>
</tr>
<tr class="ltx_tr" id="S3.T4.4.4">
<td class="ltx_td ltx_align_left" id="S3.T4.4.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">PoT</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.T4.4.4.1.m1.1"><semantics id="S3.T4.4.4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T4.4.4.1.m1.1.1" xref="S3.T4.4.4.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T4.4.4.1.m1.1b"><ci id="S3.T4.4.4.1.m1.1.1.cmml" xref="S3.T4.4.4.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.4.4.1.m1.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.4.4.1.m1.1d">caligraphic_P</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">25.3</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">44.6</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">16.8</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T4.4.4.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.4.4.7.1">16.7</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.8" style="padding-left:3.0pt;padding-right:3.0pt;">25.9</td>
</tr>
<tr class="ltx_tr" id="S3.T4.6.6">
<td class="ltx_td ltx_align_left" id="S3.T4.6.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">Self-refine</td>
<td class="ltx_td ltx_align_center" id="S3.T4.6.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S3.T4.6.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T4.5.5.1.m1.1"><semantics id="S3.T4.5.5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T4.5.5.1.m1.1.1" xref="S3.T4.5.5.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T4.5.5.1.m1.1b"><ci id="S3.T4.5.5.1.m1.1.1.cmml" xref="S3.T4.5.5.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.5.5.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.5.5.1.m1.1d">caligraphic_L</annotation></semantics></math>, <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.T4.6.6.2.m2.1"><semantics id="S3.T4.6.6.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T4.6.6.2.m2.1.1" xref="S3.T4.6.6.2.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T4.6.6.2.m2.1b"><ci id="S3.T4.6.6.2.m2.1.1.cmml" xref="S3.T4.6.6.2.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.6.6.2.m2.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.6.6.2.m2.1d">caligraphic_P</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.6.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">28.7</td>
<td class="ltx_td ltx_align_center" id="S3.T4.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">46.6</td>
<td class="ltx_td ltx_align_center" id="S3.T4.6.6.7" style="padding-left:3.0pt;padding-right:3.0pt;">17.0</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T4.6.6.8" style="padding-left:3.0pt;padding-right:3.0pt;">15.3</td>
<td class="ltx_td ltx_align_center" id="S3.T4.6.6.9" style="padding-left:3.0pt;padding-right:3.0pt;">30.1</td>
</tr>
<tr class="ltx_tr" id="S3.T4.7.7">
<td class="ltx_td ltx_align_left" id="S3.T4.7.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">Vanilla SFT</td>
<td class="ltx_td ltx_align_center" id="S3.T4.7.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S3.T4.7.7.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T4.7.7.1.m1.1"><semantics id="S3.T4.7.7.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T4.7.7.1.m1.1.1" xref="S3.T4.7.7.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T4.7.7.1.m1.1b"><ci id="S3.T4.7.7.1.m1.1.1.cmml" xref="S3.T4.7.7.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.7.7.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.7.7.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T4.7.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">33.9</td>
<td class="ltx_td ltx_align_center" id="S3.T4.7.7.5" style="padding-left:3.0pt;padding-right:3.0pt;">61.0</td>
<td class="ltx_td ltx_align_center" id="S3.T4.7.7.6" style="padding-left:3.0pt;padding-right:3.0pt;">18.5</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T4.7.7.7" style="padding-left:3.0pt;padding-right:3.0pt;">14.8</td>
<td class="ltx_td ltx_align_center" id="S3.T4.7.7.8" style="padding-left:3.0pt;padding-right:3.0pt;">33.6</td>
</tr>
<tr class="ltx_tr" id="S3.T4.9.9">
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T4.9.9.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T4.9.9.3.1">\method</span><span class="ltx_text ltx_font_bold" id="S3.T4.9.9.3.2">: Internalized</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.9.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.9.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.T4.8.8.1.m1.1"><semantics id="S3.T4.8.8.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T4.8.8.1.m1.1.1" xref="S3.T4.8.8.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T4.8.8.1.m1.1b"><ci id="S3.T4.8.8.1.m1.1.1.cmml" xref="S3.T4.8.8.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.8.8.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.8.8.1.m1.1d">caligraphic_L</annotation></semantics></math>, <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.T4.9.9.2.m2.1"><semantics id="S3.T4.9.9.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T4.9.9.2.m2.1.1" xref="S3.T4.9.9.2.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.T4.9.9.2.m2.1b"><ci id="S3.T4.9.9.2.m2.1.1.cmml" xref="S3.T4.9.9.2.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.9.9.2.m2.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.9.9.2.m2.1d">caligraphic_P</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.9.9.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.9.9.5.1">34.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.9.9.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.9.9.6.1">69.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.9.9.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.9.9.7.1">21.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_rr" id="S3.T4.9.9.8" style="padding-left:3.0pt;padding-right:3.0pt;">16.1</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.9.9.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.9.9.9.1">35.5</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Out-of-Distribution Experimental Results</h3>
<figure class="ltx_table" id="S3.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>
Accuracy (%)
on out-of-distribution (OOD) tasks.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T5.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Method</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">DeepMind-Math</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">MMLU-pro</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">StrategyQA</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T5.1.1.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">DROP</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.1.6" style="padding-left:3.0pt;padding-right:3.0pt;">Average</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_tt" colspan="6" id="S3.T5.1.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.2.2.1.1">External Planner: Finetuned Llama-3-8B-Instruct; Solver: Llama-3-70B-Instruct</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T5.1.3.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">CoT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.3.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">54.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">60.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.3.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">81.3</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T5.1.3.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">66.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.3.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">65.6</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.4.4">
<td class="ltx_td ltx_align_left" id="S3.T5.1.4.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">LTM</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">55.6</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.4.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.4.4.3.1">60.9</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.4.4.4.1">81.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.4.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">64.3</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">65.6</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.5.5">
<td class="ltx_td ltx_align_left" id="S3.T5.1.5.5.1" style="padding-left:3.0pt;padding-right:3.0pt;">PA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.5.2" style="padding-left:3.0pt;padding-right:3.0pt;">58.1</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.5.3" style="padding-left:3.0pt;padding-right:3.0pt;">54.2</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.5.4" style="padding-left:3.0pt;padding-right:3.0pt;">80.3</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">58.7</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.5.6" style="padding-left:3.0pt;padding-right:3.0pt;">62.8</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.6.6">
<td class="ltx_td ltx_align_left" id="S3.T5.1.6.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">PoT</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.6.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">73.0</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.6.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">57.3</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.6.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">74.8</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.6.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">62.8</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">66.9</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.7.7">
<td class="ltx_td ltx_align_left" id="S3.T5.1.7.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">Self-refine</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.7.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">73.9</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.7.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">59.5</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.7.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">77.8</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.7.7.5" style="padding-left:3.0pt;padding-right:3.0pt;">64.8</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.7.7.6" style="padding-left:3.0pt;padding-right:3.0pt;">69.0</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.8.8">
<td class="ltx_td ltx_align_left" id="S3.T5.1.8.8.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T5.1.8.8.1.1">\method</span><span class="ltx_text ltx_font_bold" id="S3.T5.1.8.8.1.2">: External</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.8.8.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.8.8.2.1">74.1</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.8.8.3" style="padding-left:3.0pt;padding-right:3.0pt;">59.4</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.8.8.4" style="padding-left:3.0pt;padding-right:3.0pt;">80.3</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.8.8.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.8.8.5.1">66.3</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.8.8.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.8.8.6.1">70.0</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_tt" colspan="6" id="S3.T5.1.9.9.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.9.9.1.1">External Planner: Finetuned Llama-3-8B-Instruct; Solver: GPT4o-mini</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.10.10">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T5.1.10.10.1" style="padding-left:3.0pt;padding-right:3.0pt;">CoT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.10.10.2" style="padding-left:3.0pt;padding-right:3.0pt;">80.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.10.10.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.10.10.3.1">61.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.10.10.4" style="padding-left:3.0pt;padding-right:3.0pt;">78.8</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T5.1.10.10.5" style="padding-left:3.0pt;padding-right:3.0pt;">65.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.10.10.6" style="padding-left:3.0pt;padding-right:3.0pt;">71.6</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.11.11">
<td class="ltx_td ltx_align_left" id="S3.T5.1.11.11.1" style="padding-left:3.0pt;padding-right:3.0pt;">LTM</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.11.11.2" style="padding-left:3.0pt;padding-right:3.0pt;">80.6</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.11.11.3" style="padding-left:3.0pt;padding-right:3.0pt;">61.4</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.11.11.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.11.11.4.1">80.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.11.11.5" style="padding-left:3.0pt;padding-right:3.0pt;">64.5</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.11.11.6" style="padding-left:3.0pt;padding-right:3.0pt;">71.8</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.12.12">
<td class="ltx_td ltx_align_left" id="S3.T5.1.12.12.1" style="padding-left:3.0pt;padding-right:3.0pt;">PA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.12.12.2" style="padding-left:3.0pt;padding-right:3.0pt;">82.2</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.12.12.3" style="padding-left:3.0pt;padding-right:3.0pt;">48.1</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.12.12.4" style="padding-left:3.0pt;padding-right:3.0pt;">78.3</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.12.12.5" style="padding-left:3.0pt;padding-right:3.0pt;">67.0</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.12.12.6" style="padding-left:3.0pt;padding-right:3.0pt;">68.9</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.13.13">
<td class="ltx_td ltx_align_left" id="S3.T5.1.13.13.1" style="padding-left:3.0pt;padding-right:3.0pt;">PoT</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.13.13.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.13.13.2.1">87.7</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.13.13.3" style="padding-left:3.0pt;padding-right:3.0pt;">57.1</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.13.13.4" style="padding-left:3.0pt;padding-right:3.0pt;">77.9</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.13.13.5" style="padding-left:3.0pt;padding-right:3.0pt;">72.4</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.13.13.6" style="padding-left:3.0pt;padding-right:3.0pt;">73.7</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.14.14">
<td class="ltx_td ltx_align_left" id="S3.T5.1.14.14.1" style="padding-left:3.0pt;padding-right:3.0pt;">Self-refine</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.14.14.2" style="padding-left:3.0pt;padding-right:3.0pt;">85.9</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.14.14.3" style="padding-left:3.0pt;padding-right:3.0pt;">58.3</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.14.14.4" style="padding-left:3.0pt;padding-right:3.0pt;">77.2</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.14.14.5" style="padding-left:3.0pt;padding-right:3.0pt;">72.3</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.14.14.6" style="padding-left:3.0pt;padding-right:3.0pt;">73.4</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.15.15">
<td class="ltx_td ltx_align_left" id="S3.T5.1.15.15.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T5.1.15.15.1.1">\method</span><span class="ltx_text ltx_font_bold" id="S3.T5.1.15.15.1.2">: External</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.15.15.2" style="padding-left:3.0pt;padding-right:3.0pt;">87.6</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.15.15.3" style="padding-left:3.0pt;padding-right:3.0pt;">61.5</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.15.15.4" style="padding-left:3.0pt;padding-right:3.0pt;">78.8</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.15.15.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.15.15.5.1">73.8</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.15.15.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.15.15.6.1">75.4</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.16.16">
<td class="ltx_td ltx_align_left ltx_border_tt" colspan="6" id="S3.T5.1.16.16.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.16.16.1.1">Solver: Finetuned Llama-3-8B-Instruct</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.17.17">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T5.1.17.17.1" style="padding-left:3.0pt;padding-right:3.0pt;">CoT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.17.17.2" style="padding-left:3.0pt;padding-right:3.0pt;">28.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.17.17.3" style="padding-left:3.0pt;padding-right:3.0pt;">37.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.17.17.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.17.17.4.1">72.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T5.1.17.17.5" style="padding-left:3.0pt;padding-right:3.0pt;">52.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.17.17.6" style="padding-left:3.0pt;padding-right:3.0pt;">47.8</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.18.18">
<td class="ltx_td ltx_align_left" id="S3.T5.1.18.18.1" style="padding-left:3.0pt;padding-right:3.0pt;">LTM</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.18.18.2" style="padding-left:3.0pt;padding-right:3.0pt;">30.9</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.18.18.3" style="padding-left:3.0pt;padding-right:3.0pt;">38.6</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.18.18.4" style="padding-left:3.0pt;padding-right:3.0pt;">70.7</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.18.18.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.18.18.5.1">55.2</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.18.18.6" style="padding-left:3.0pt;padding-right:3.0pt;">48.9</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.19.19">
<td class="ltx_td ltx_align_left" id="S3.T5.1.19.19.1" style="padding-left:3.0pt;padding-right:3.0pt;">PA</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.19.19.2" style="padding-left:3.0pt;padding-right:3.0pt;">29.3</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.19.19.3" style="padding-left:3.0pt;padding-right:3.0pt;">34.5</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.19.19.4" style="padding-left:3.0pt;padding-right:3.0pt;">69.7</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.19.19.5" style="padding-left:3.0pt;padding-right:3.0pt;">51.6</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.19.19.6" style="padding-left:3.0pt;padding-right:3.0pt;">46.3</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.20.20">
<td class="ltx_td ltx_align_left" id="S3.T5.1.20.20.1" style="padding-left:3.0pt;padding-right:3.0pt;">PoT</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.20.20.2" style="padding-left:3.0pt;padding-right:3.0pt;">48.1</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.20.20.3" style="padding-left:3.0pt;padding-right:3.0pt;">37.3</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.20.20.4" style="padding-left:3.0pt;padding-right:3.0pt;">63.9</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.20.20.5" style="padding-left:3.0pt;padding-right:3.0pt;">44.6</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.20.20.6" style="padding-left:3.0pt;padding-right:3.0pt;">48.5</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.21.21">
<td class="ltx_td ltx_align_left" id="S3.T5.1.21.21.1" style="padding-left:3.0pt;padding-right:3.0pt;">Self-refine</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.21.21.2" style="padding-left:3.0pt;padding-right:3.0pt;">44.9</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.21.21.3" style="padding-left:3.0pt;padding-right:3.0pt;">33.1</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.21.21.4" style="padding-left:3.0pt;padding-right:3.0pt;">65.3</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.21.21.5" style="padding-left:3.0pt;padding-right:3.0pt;">47.1</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.21.21.6" style="padding-left:3.0pt;padding-right:3.0pt;">47.6</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.22.22">
<td class="ltx_td ltx_align_left" id="S3.T5.1.22.22.1" style="padding-left:3.0pt;padding-right:3.0pt;">Vanilla SFT</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.22.22.2" style="padding-left:3.0pt;padding-right:3.0pt;">39.6</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.22.22.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.22.22.3.1">40.3</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.22.22.4" style="padding-left:3.0pt;padding-right:3.0pt;">71.8</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T5.1.22.22.5" style="padding-left:3.0pt;padding-right:3.0pt;">49.0</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.22.22.6" style="padding-left:3.0pt;padding-right:3.0pt;">50.2</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.23.23">
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T5.1.23.23.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T5.1.23.23.1.1">\method</span><span class="ltx_text ltx_font_bold" id="S3.T5.1.23.23.1.2">: Internalized</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T5.1.23.23.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.23.23.2.1">55.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T5.1.23.23.3" style="padding-left:3.0pt;padding-right:3.0pt;">39.7</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T5.1.23.23.4" style="padding-left:3.0pt;padding-right:3.0pt;">68.2</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_rr" id="S3.T5.1.23.23.5" style="padding-left:3.0pt;padding-right:3.0pt;">48.8</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T5.1.23.23.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.23.23.6.1">53.0</span></td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_paragraph" id="S3.SS5.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Our method consistently generalizes well across diverse OOD challenges</h4>
<div class="ltx_para ltx_noindent" id="S3.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS5.SSS0.Px1.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T5" title="Table 5 ‣ 3.5 Out-of-Distribution Experimental Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">5</span></a>, <span class="ltx_ERROR undefined" id="S3.SS5.SSS0.Px1.p1.1.1">\method</span>maintains high accuracy across different datasets and models. In contrast, static methods often fluctuate significantly in performance. For instance, despite static methods like CoT showing a slight advantage on MMLU-Pro and StrategyQA over <span class="ltx_ERROR undefined" id="S3.SS5.SSS0.Px1.p1.1.2">\method</span>using the Llama-3-70B-Instruct model, they experience a sharp decline on DeepMind Math.
This pattern of fluctuations can be observed in other methods as well, where some excel on individual tasks but fail to maintain strong performance.
In contrast, <span class="ltx_ERROR undefined" id="S3.SS5.SSS0.Px1.p1.1.3">\method</span>continues to deliver consistently high accuracy across various models and datasets. The stability of our method is attributed to its ability to dynamically select appropriate reasoning trajectories. The results indicate that <span class="ltx_ERROR undefined" id="S3.SS5.SSS0.Px1.p1.1.4">\method</span>is better suited to meet the demands of diverse tasks, demonstrating stronger robustness and generalization, making it a more reliable and adaptable approach for handling a wide variety of OOD challenges.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Ablation Study</h3>
<figure class="ltx_table" id="S3.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Ablation Study</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T6.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T6.1.1.1">
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.1.1.2">MATH</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.1.1.3">BBH</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.1.1.4">Game24</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T6.1.1.1.5">TheoremQA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.1.1.6">Average</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" colspan="6" id="S3.T6.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T6.1.2.2.1.1">External Planner: Llama-3-8B-Instruct; Solver: GPT-4o-mini</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T6.1.3.3.1">
<span class="ltx_ERROR undefined" id="S3.T6.1.3.3.1.1">\method</span>: External</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.3.3.2">75.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.3.3.3">84.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.3.3.4">65.2</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T6.1.3.3.5">42.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.3.3.6">66.8</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.4.4">
<td class="ltx_td ltx_align_left" id="S3.T6.1.4.4.1">-w/o Searching</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.4.4.2">69.2</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.4.4.3">78.6</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.4.4.4">28.9</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T6.1.4.4.5">40.2</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.4.4.6">54.2</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.5.5">
<td class="ltx_td ltx_align_left" id="S3.T6.1.5.5.1">-w/o Explanation</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.5.2">68.2</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.5.3">81.3</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.5.4">57.4</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T6.1.5.5.5">36.4</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.5.6">60.8</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_t" colspan="6" id="S3.T6.1.6.6.1"><span class="ltx_text ltx_font_bold" id="S3.T6.1.6.6.1.1">Internalized Planner &amp; Solver: Llama-3-8B-Instruct</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.7.7">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T6.1.7.7.1">
<span class="ltx_ERROR undefined" id="S3.T6.1.7.7.1.1">\method</span>: Internalized</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.7.7.2">34.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.7.7.3">69.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.7.7.4">21.9</td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S3.T6.1.7.7.5">16.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.7.7.6">35.5</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.8.8">
<td class="ltx_td ltx_align_left" id="S3.T6.1.8.8.1">-w/o Searching</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.8.8.2">31.4</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.8.8.3">55.8</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.8.8.4">19.6</td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S3.T6.1.8.8.5">15.1</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.8.8.6">30.5</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T6.1.9.9.1">-w/o Explanation</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T6.1.9.9.2">33.8</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T6.1.9.9.3">65.8</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T6.1.9.9.4">18.6</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_rr" id="S3.T6.1.9.9.5">15.7</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T6.1.9.9.6">33.4</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.1">In this section, we perform the ablation study and assess the effectiveness of each component of our method: (1) <span class="ltx_text ltx_font_bold" id="S3.SS6.p1.1.1">Without Searching:</span> To demonstrate the effectiveness of searching for the optimal action trajectory, we test the performance of the LLM tuned with a randomly selected action trajectory; (2) <span class="ltx_text ltx_font_bold" id="S3.SS6.p1.1.2">Without Explanation:</span> To understand if training the planner to generate an explanation for the optimal reasoning trajectory is helpful, we test <span class="ltx_ERROR undefined" id="S3.SS6.p1.1.3">\method</span>’s performance when the planner is trained to predict the trajectory without explanation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p2">
<p class="ltx_p" id="S3.SS6.p2.1">The results in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T6" title="Table 6 ‣ 3.6 Ablation Study ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">6</span></a> indicate that both optimal trajectory searching and explanation generation are crucial in <span class="ltx_ERROR undefined" id="S3.SS6.p2.1.1">\method</span>.
For example, in the Game of 24, the planner trained without searching for the optimal trajectory did not consistently select the PoT action (which was considered the most effective for this task) in its trajectory.
Additionally, we observe that without explanations, the planner’s ability to predict optimal trajectories becomes less reliable. Incorporating explanations effectively guides the planner to learn to predict suitable action trajectories for the given questions.

</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.7 </span>Optimal Trajectory Analysis for Different Tasks</h3>
<div class="ltx_para ltx_noindent" id="S3.SS7.p1">
<p class="ltx_p" id="S3.SS7.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T7" title="Table 7 ‣ \methodadapts to the capability of specific task-solving LLMs ‣ 3.7 Optimal Trajectory Analysis for Different Tasks ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">7</span></a> shows the distribution of actions selected in the optimal trajectories by our planner on the MATH test set. The distribution suggests two key findings:</p>
</div>
<section class="ltx_paragraph" id="S3.SS7.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">
<span class="ltx_ERROR undefined" id="S3.SS7.SSS0.Px1.1.1">\method</span>adapts to the characteristics of specific questions</h4>
<div class="ltx_para ltx_noindent" id="S3.SS7.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS7.SSS0.Px1.p1.1">In mathematics, number theory problems are more suitable to be solved with programs, so the proportion of PoT is higher, while geometry problems are not easily represented and solved with naive Python code; as a result, our planner mainly uses CoT for such problems. This indicates that <span class="ltx_ERROR undefined" id="S3.SS7.SSS0.Px1.p1.1.1">\method</span>tailors its action selection based on the unique characteristics of each problem type.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS7.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">
<span class="ltx_ERROR undefined" id="S3.SS7.SSS0.Px2.1.1">\method</span>adapts to the capability of specific task-solving LLMs</h4>
<div class="ltx_para ltx_noindent" id="S3.SS7.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS7.SSS0.Px2.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T3" title="Table 3 ‣ 3.3 External Planner Tuning Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">3</span></a>, on the MATH dataset, GPT-4o-mini performs better using CoT for problem-solving, whereas Llama3-70B-instruct performs better using PoT.
When GPT-4o-mini is the task-solving LLM, our fine-tuned planner selects a higher proportion of CoT actions; when Llama3-70B-Instruct is used, PoT actions dominate. This suggests that our planner is not only aware of the problem type but also adapts the reasoning action trajectory prediction based on the capabilities of the task-solving LLM.</p>
</div>
<div class="ltx_para" id="S3.SS7.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS7.SSS0.Px2.p2.1">Furthermore, we observe that question rewriting and decomposition were selected with a low frequency.
This is likely because the MATH dataset consists of precise problems that do not benefit from rewriting.
Additionally, given the strong reasoning abilities of Llama3-70B-Instruct and GPT-4o-mini, their CoT process inherently includes task decomposition, reducing the need for further planning interventions.</p>
</div>
<figure class="ltx_table" id="S3.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Planning action distributions of <span class="ltx_ERROR undefined" id="S3.T7.2.1">\method</span>over three different layers on the MATH test set.
</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T7.3" style="width:318.0pt;height:257.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-41.4pt,33.5pt) scale(0.793428834827605,0.793428834827605) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T7.3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T7.3.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T7.3.1.1.1.1" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T7.3.1.1.1.1.1">Sub-tasks on MATH</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.1.1.2" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T7.3.1.1.1.2.1">Accuracy (%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S3.T7.3.1.1.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Analysis Layer</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S3.T7.3.1.1.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">Solution</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.T7.3.1.1.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">Verification</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">Rewr.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">Deco.</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.2.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">Empty</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.2.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">CoT</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.2.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">PoT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.2.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">Veri.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.2.2.7" style="padding-left:3.0pt;padding-right:3.0pt;">Empty</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_tt" colspan="9" id="S3.T7.3.1.3.3.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.3.3.1.1">External Planner: Llama-3-8B-Instruct; Solver: GPT-4o-mini</span></td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.4.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T7.3.1.4.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">Algebra</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.4.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">92.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.4.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.05</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.4.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.92</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.4.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.90</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.4.4.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.4.4.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.29</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.4.4.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.71</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.5.5.1" style="padding-left:3.0pt;padding-right:3.0pt;">Prealgebra</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.5.5.2" style="padding-left:3.0pt;padding-right:3.0pt;">88.6</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.5.5.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.03</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.5.5.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.01</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.96</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.5.5.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.79</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.5.5.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.31</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.5.5.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.21</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.5.5.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.79</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.6.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">Number Theory</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.6.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">81.8</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.6.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.01</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.6.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.01</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.6.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.98</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.43</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.6.6.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.57</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.6.6.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.15</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.6.6.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.85</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.7.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.7.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">Counting and Probability</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.7.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">76.8</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.7.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.08</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.7.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.06</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.7.7.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.84</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.7.7.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.7.7.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.32</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.7.7.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.30</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.7.7.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.70</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.8.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.8.8.1" style="padding-left:3.0pt;padding-right:3.0pt;">Geometry</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.8.8.2" style="padding-left:3.0pt;padding-right:3.0pt;">61.8</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.8.8.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.03</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.8.8.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.01</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.8.8.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.96</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.8.8.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.95</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.8.8.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.05</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.8.8.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.06</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.8.8.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.94</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.9.9.1" style="padding-left:3.0pt;padding-right:3.0pt;">Intermediate Algebra</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.9.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">57.1</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.9.9.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.05</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.9.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.02</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.9.9.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.93</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.9.9.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.85</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.9.9.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.15</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.9.9.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.44</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.9.9.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.56</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.10.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.10.10.1" style="padding-left:3.0pt;padding-right:3.0pt;">Precalculus</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.10.10.2" style="padding-left:3.0pt;padding-right:3.0pt;">52.6</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.10.10.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.06</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.10.10.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.02</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.10.10.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.92</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.10.10.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.95</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.10.10.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.05</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.10.10.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.46</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.10.10.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.54</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.11.11">
<td class="ltx_td ltx_align_left ltx_border_tt" colspan="9" id="S3.T7.3.1.11.11.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.11.11.1.1">External Planner: Llama-3-8B-Instruct; Solver: Llama-3-70B-Instruct</span></td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.12.12">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T7.3.1.12.12.1" style="padding-left:3.0pt;padding-right:3.0pt;">Algebra</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.12.12.2" style="padding-left:3.0pt;padding-right:3.0pt;">74.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.12.12.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.12.12.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.04</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.12.12.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.12.12.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.77</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.12.12.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.23</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.12.12.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.12.12.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.88</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.13.13">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.13.13.1" style="padding-left:3.0pt;padding-right:3.0pt;">Prealgebra</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.13.13.2" style="padding-left:3.0pt;padding-right:3.0pt;">74.5</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.13.13.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.02</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.13.13.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.13.13.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.95</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.13.13.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.57</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.13.13.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.43</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.13.13.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.10</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.13.13.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.90</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.14.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.14.14.1" style="padding-left:3.0pt;padding-right:3.0pt;">Number Theory</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.14.14.2" style="padding-left:3.0pt;padding-right:3.0pt;">69.9</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.14.14.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.01</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.14.14.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.01</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.14.14.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.98</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.14.14.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.14.14.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.68</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.14.14.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.13</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.14.14.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.87</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.15.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.15.15.1" style="padding-left:3.0pt;padding-right:3.0pt;">Counting and Probability</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.15.15.2" style="padding-left:3.0pt;padding-right:3.0pt;">55.4</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.15.15.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.04</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.15.15.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.02</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.15.15.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.94</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.15.15.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.59</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.15.15.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.41</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.15.15.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.11</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.15.15.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.89</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.16.16">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.16.16.1" style="padding-left:3.0pt;padding-right:3.0pt;">Geometry</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.16.16.2" style="padding-left:3.0pt;padding-right:3.0pt;">39.6</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.16.16.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.05</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.16.16.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.01</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.16.16.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.94</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.16.16.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.76</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.16.16.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.24</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.16.16.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.18</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.16.16.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.82</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.17.17">
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.3.1.17.17.1" style="padding-left:3.0pt;padding-right:3.0pt;">Precalculus</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.17.17.2" style="padding-left:3.0pt;padding-right:3.0pt;">36.9</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.17.17.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.07</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.17.17.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.17.17.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.90</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.17.17.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.17.17.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.22</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.17.17.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.28</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.17.17.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.76</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.18.18">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S3.T7.3.1.18.18.1" style="padding-left:3.0pt;padding-right:3.0pt;">Intermediate Algebra</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T7.3.1.18.18.2" style="padding-left:3.0pt;padding-right:3.0pt;">34.6</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T7.3.1.18.18.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T7.3.1.18.18.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.01</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T7.3.1.18.18.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.96</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T7.3.1.18.18.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.72</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T7.3.1.18.18.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.28</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T7.3.1.18.18.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.20</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T7.3.1.18.18.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.80</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.8 </span>Additional Analyses</h3>
<section class="ltx_paragraph" id="S3.SS8.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Few-shot In-context Learning Setting</h4>
<figure class="ltx_table ltx_align_floatright" id="S3.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>External planner tuning under the few-shot setting with GPT-4o-mini as the solver.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T8.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T8.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T8.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T8.1.1.1.2">MATH</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T8.1.1.1.3">BBH</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T8.1.1.1.4">TheoremQA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T8.1.1.1.5">Average</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T8.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T8.1.2.1.1">CoT</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T8.1.2.1.2">72.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T8.1.2.1.3">84.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T8.1.2.1.4">38.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T8.1.2.1.5">64.9</td>
</tr>
<tr class="ltx_tr" id="S3.T8.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T8.1.3.2.1">LTM</th>
<td class="ltx_td ltx_align_center" id="S3.T8.1.3.2.2">72.7</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.3.2.3">83.4</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.3.2.4">37.3</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.3.2.5">64.5</td>
</tr>
<tr class="ltx_tr" id="S3.T8.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T8.1.4.3.1">PA</th>
<td class="ltx_td ltx_align_center" id="S3.T8.1.4.3.2">71.3</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.4.3.3">83.3</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.4.3.4">38.7</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.4.3.5">64.4</td>
</tr>
<tr class="ltx_tr" id="S3.T8.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T8.1.5.4.1">PoT</th>
<td class="ltx_td ltx_align_center" id="S3.T8.1.5.4.2">69.8</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.5.4.3">82.1</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.5.4.4">36.4</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.5.4.5">62.8</td>
</tr>
<tr class="ltx_tr" id="S3.T8.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T8.1.6.5.1">Self-refine</th>
<td class="ltx_td ltx_align_center" id="S3.T8.1.6.5.2">73.2</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.6.5.3">83.1</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.6.5.4">35.4</td>
<td class="ltx_td ltx_align_center" id="S3.T8.1.6.5.5">63.9</td>
</tr>
<tr class="ltx_tr" id="S3.T8.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="S3.T8.1.7.6.1"><span class="ltx_ERROR undefined" id="S3.T8.1.7.6.1.1">\method</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T8.1.7.6.2"><span class="ltx_text ltx_font_bold" id="S3.T8.1.7.6.2.1">75.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T8.1.7.6.3"><span class="ltx_text ltx_font_bold" id="S3.T8.1.7.6.3.1">86.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T8.1.7.6.4"><span class="ltx_text ltx_font_bold" id="S3.T8.1.7.6.4.1">39.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T8.1.7.6.5"><span class="ltx_text ltx_font_bold" id="S3.T8.1.7.6.5.1">67.1</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS8.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS8.SSS0.Px1.p1.1">Our main results report the performance with zero-shot evaluation. In cases where reasoning tasks are known in advance, a common approach to leveraging training data and improving the performance of closed-source LLMs is few-shot in-context learning (ICL), where training examples are incorporated directly into the context.
Our external planner tuning can also be utilized in this scenario seamlessly.
Specifically, we can first construct few-shot ICL prompts for each potential reasoning action trajectory. Once the external planner selects the appropriate reasoning actions, the corresponding few-shot prompt will be chosen and applied.
We evaluate the external planner tuning setup of <span class="ltx_ERROR undefined" id="S3.SS8.SSS0.Px1.p1.1.1">\method</span>, with Llama-3-8B-Instruct being the external planner and GPT-4o-mini being the solver LLM, in this setting.
We compare our approach with the same baselines similarly implemented in the few-shot ICL setting, where we randomly selected
8 examples from MATH, 4 examples from each category of BBH, and 4 examples from TheoremQA to form the prompt.<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We excluded the “Game of 24” task because knowing the task in advance enables it to be solved with a straightforward program.</span></span></span> All few-shot demonstrations were generated by GPT-4o and manually verified for quality.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS8.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS8.SSS0.Px1.p2.1">As shown in the Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T8" title="Table 8 ‣ Few-shot In-context Learning Setting ‣ 3.8 Additional Analyses ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">8</span></a>, <span class="ltx_ERROR undefined" id="S3.SS8.SSS0.Px1.p2.1.1">\method</span>continues to outperform baseline models. Interestingly, compared to Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T3" title="Table 3 ‣ 3.3 External Planner Tuning Results ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">3</span></a>, which presents the zero-shot results, adding few-shot demonstrations to static prompting methods does not lead to consistent improvement, except on the BBH dataset. This indicates that simply expanding the context with additional demonstrations does not always serve as an effective way to leverage available training data.
In contrast, our method demonstrates its superior ability to effectively utilize the training data.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_paragraph" id="S3.SS8.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">How efficient is <span class="ltx_ERROR undefined" id="S3.SS8.SSS0.Px2.1.1">\method</span>?</h4>
<figure class="ltx_table ltx_align_floatright" id="S3.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span>Avg. number of output tokens for each method (solver: Llama-3-8B-Instruct).</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T9.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T9.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T9.1.1.1.1" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T9.1.1.1.1.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T9.1.1.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Avg. # of</td>
</tr>
<tr class="ltx_tr" id="S3.T9.1.2.2">
<td class="ltx_td ltx_align_center" id="S3.T9.1.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">Output Tokens</td>
</tr>
<tr class="ltx_tr" id="S3.T9.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T9.1.3.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">CoT <cite class="ltx_cite ltx_citemacro_citep">(Wei et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib35" title="">2022</a>)</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T9.1.3.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">263.6</td>
</tr>
<tr class="ltx_tr" id="S3.T9.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T9.1.4.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">LTM <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib44" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T9.1.4.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">436.4</td>
</tr>
<tr class="ltx_tr" id="S3.T9.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T9.1.5.5.1" style="padding-left:3.0pt;padding-right:3.0pt;">Self-refine <cite class="ltx_cite ltx_citemacro_citep">(Madaan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib22" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T9.1.5.5.2" style="padding-left:3.0pt;padding-right:3.0pt;">527.6</td>
</tr>
<tr class="ltx_tr" id="S3.T9.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S3.T9.1.6.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_ERROR undefined" id="S3.T9.1.6.6.1.1">\method</span><span class="ltx_text ltx_font_bold" id="S3.T9.1.6.6.1.2">: Internalized</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T9.1.6.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">409.1</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS8.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS8.SSS0.Px2.p1.1">We compare the cost efficiency, measured by the average output token count, of each method (based on Llama-3-8B-Instruct) in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.T9" title="Table 9 ‣ How efficient is \method? ‣ 3.8 Additional Analyses ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">9</span></a>.
The result shows that <span class="ltx_ERROR undefined" id="S3.SS8.SSS0.Px2.p1.1.1">\method</span>consumes fewer tokens on average than other advanced approaches and only more than CoT.
Advanced prompt engineering methods often introduce supplementary text to facilitate reasoning. However, not all questions require this additional context to the same extent. By constructing training data via searching, our goal is to optimize the balance between minimizing extraneous steps and maintaining a high success rate, thereby reducing unnecessary output tokens. Our method avoids redundant reasoning actions, resulting in a more efficient system.
</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS8.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Do we need more reasoning steps for difficult questions?</h4>
<figure class="ltx_figure" id="S3.F3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Average reasoning trajectory length per difficulty level on MATH for <span class="ltx_ERROR undefined" id="S3.F3.4.1">\method</span>(solver: GPT-4o-mini; External planner: Llama3-8B-Instruct).

<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="200" id="S3.F3.2.g1" src="x4.png" width="266"/>
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS8.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS8.SSS0.Px3.p1.2">Recent research suggests that LLMs can better solve difficult questions by increasing the thinking time in the inference stage <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib4" title="">2024</a>; OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib23" title="">2024</a>)</cite>.
In our study, we explore the relationship between question difficulty and the average reasoning action trajectory length.
The trajectory length is determined by assigning a value of <math alttext="0" class="ltx_Math" display="inline" id="S3.SS8.SSS0.Px3.p1.1.m1.1"><semantics id="S3.SS8.SSS0.Px3.p1.1.m1.1a"><mn id="S3.SS8.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS8.SSS0.Px3.p1.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS8.SSS0.Px3.p1.1.m1.1b"><cn id="S3.SS8.SSS0.Px3.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS8.SSS0.Px3.p1.1.m1.1.1">0</cn></annotation-xml></semantics></math> to the <span class="ltx_text ltx_font_typewriter" id="S3.SS8.SSS0.Px3.p1.2.1">EMPTY</span> module and <math alttext="1" class="ltx_Math" display="inline" id="S3.SS8.SSS0.Px3.p1.2.m2.1"><semantics id="S3.SS8.SSS0.Px3.p1.2.m2.1a"><mn id="S3.SS8.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS8.SSS0.Px3.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS8.SSS0.Px3.p1.2.m2.1b"><cn id="S3.SS8.SSS0.Px3.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS8.SSS0.Px3.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.SSS0.Px3.p1.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.SSS0.Px3.p1.2.m2.1d">1</annotation></semantics></math> to all other actions, while the question difficulty is derived from annotated levels on the MATH dataset.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#S3.F3" title="Figure 3 ‣ Do we need more reasoning steps for difficult questions? ‣ 3.8 Additional Analyses ‣ 3 Experiment ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">3</span></a> presents that harder problems demand more computational steps, resulting in longer reasoning trajectories. Case analyses further reveal that our planner increases the proportion of verification steps as problem difficulty rises. This highlights an exciting fact — LLMs can learn to employ more reasoning steps for challenging problems through exploration, without requiring explicit expert guidance.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Prompt engineering for LLM reasoning</h4>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p1.1">LLMs have demonstrated remarkable proficiency in solving complex reasoning tasks <cite class="ltx_cite ltx_citemacro_citep">(Rae et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib27" title="">2021</a>; Lewkowycz et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib18" title="">2022</a>; Zhong et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib43" title="">2023</a>)</cite>. The Chain-of-Thought (CoT) approach, introduced by <cite class="ltx_cite ltx_citemacro_citet">Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib35" title="">2022</a>)</cite>, significantly improves performance on reasoning problems by prompting LLMs to think step-by-step, thereby activating their inherent reasoning capabilities <cite class="ltx_cite ltx_citemacro_citep">(Madaan &amp; Yazdanbakhsh, <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib21" title="">2022</a>)</cite>. To further enhance LLMs’ capabilities in mathematical and symbolic reasoning, <cite class="ltx_cite ltx_citemacro_citet">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib6" title="">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Gao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib11" title="">2023</a>)</cite> proposed the Program-of-Thought prompting method, where code is used as an intermediate reasoning step.
Advanced prompt engineering methods, such as question decomposition <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib44" title="">2023</a>)</cite> and self-verification <cite class="ltx_cite ltx_citemacro_citep">(Madaan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib22" title="">2024</a>)</cite>, have also proven effective in improving reasoning performance. Additionally, recent approaches have incorporated automatic prompt optimization based on training data. For instance, <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib32" title="">2023</a>)</cite> refines prompts by analyzing error cases, and self-discovery <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib45" title="">2024</a>)</cite> utilizes modular reasoning components to construct the task-adaptive prompt.
However, these automated prompt optimization techniques still produce static prompts for all instances.
Recently, <cite class="ltx_cite ltx_citemacro_citet">Srivastava et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib29" title="">2024</a>)</cite> proposed the instance-level prompt optimization via LLM self-refining while it is still a passive expert-designed workflow and lacks the explorations and evaluations to guide the LLM to better actively adapt to the question and LLM capability.
In our method, we internalize the reasoning action selection capability into the LLM itself without an expert-designed workflow, allowing it to autonomously fit both the characteristics of questions and the inherent capability of task-solving LLM.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Searching for boosting LLM reasoning</h4>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p1.1">Recent research suggests that incorporating searching mechanisms can significantly enhance LLM reasoning. In the inference process, Tree-of-Thought (ToT) <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib38" title="">2024</a>)</cite> and Graph-of-Thought (GoT) <cite class="ltx_cite ltx_citemacro_citep">(Besta et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib3" title="">2024</a>)</cite> have been proposed to search and investigate different reasoning paths, either by leveraging the LLM itself <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib38" title="">2024</a>)</cite> or designing heuristic functions <cite class="ltx_cite ltx_citemacro_citep">(Hao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib13" title="">2023</a>)</cite> as the signal to evaluate each step. More recently, Monte Carlo Tree Search (MCTS) has been introduced to assist the LLM in learning how to evaluate each step <cite class="ltx_cite ltx_citemacro_citep">(Qi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib25" title="">2024</a>; Xie et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib37" title="">2024</a>)</cite>. The searching mechanism can also be used in training to collect training instances for improving LLM reasoning <cite class="ltx_cite ltx_citemacro_citep">(Luo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib20" title="">2024</a>)</cite>. However, all these searching methods treat each “CoT reasoning step” as the atomic component or step in searching, while we choose each reasoning action as the atomic component in our case.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we introduce <span class="ltx_ERROR undefined" id="S5.p1.1.1">\method</span>, a method that enables LLMs to autonomously think about appropriate reasoning actions before answering questions. By defining atomic reasoning action modules, searching for optimal action trajectories, and training LLMs to plan for reasoning questions, we enable LLMs to dynamically adapt to specific questions and their inherent capability. The flexibility of our two learning paradigms, i.e., external and internalized planner tuning, further highlights the adaptability of our method to different LLMs. Our experimental results show the effectiveness of <span class="ltx_ERROR undefined" id="S5.p1.1.2">\method</span>, revealing the promise of harnessing explorations and evaluations to turn LLMs into planners for better reasoning.

</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ahn et al. (2024)</span>
<span class="ltx_bibblock">
Janice Ahn, Rishu Verma, Renze Lou, Di Liu, Rui Zhang, and Wenpeng Yin.

</span>
<span class="ltx_bibblock">Large language models for mathematical reasoning: Progresses and challenges.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2402.00157</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">AI (2023)</span>
<span class="ltx_bibblock">
Lightning AI.

</span>
<span class="ltx_bibblock">Litgpt.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Lightning-AI/litgpt" title="">https://github.com/Lightning-AI/litgpt</a>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Besta et al. (2024)</span>
<span class="ltx_bibblock">
Maciej Besta, Nils Blach, Ales Kubicek, Robert Gerstenberger, Michal Podstawski, Lukas Gianinazzi, Joanna Gajda, Tomasz Lehmann, Hubert Niewiadomski, Piotr Nyczyk, et al.

</span>
<span class="ltx_bibblock">Graph of thoughts: Solving elaborate problems with large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 38, pp.  17682–17690, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2024)</span>
<span class="ltx_bibblock">
Bradley Brown, Jordan Juravsky, Ryan Ehrlich, Ronald Clark, Quoc V Le, Christopher Ré, and Azalia Mirhoseini.

</span>
<span class="ltx_bibblock">Large language monkeys: Scaling inference compute with repeated sampling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2407.21787</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chan et al. (2024)</span>
<span class="ltx_bibblock">
Xin Chan, Xiaoyang Wang, Dian Yu, Haitao Mi, and Dong Yu.

</span>
<span class="ltx_bibblock">Scaling synthetic data creation with 1,000,000,000 personas.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2406.20094</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2022)</span>
<span class="ltx_bibblock">
Wenhu Chen, Xueguang Ma, Xinyi Wang, and William W Cohen.

</span>
<span class="ltx_bibblock">Program of thoughts prompting: Disentangling computation from reasoning for numerical reasoning tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2211.12588</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023)</span>
<span class="ltx_bibblock">
Wenhu Chen, Ming Yin, Max Ku, Pan Lu, Yixin Wan, Xueguang Ma, Jianyu Xu, Xinyi Wang, and Tony Xia.

</span>
<span class="ltx_bibblock">Theoremqa: A theorem-driven question answering dataset.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">The 2023 Conference on Empirical Methods in Natural Language Processing</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2023)</span>
<span class="ltx_bibblock">
Yihe Deng, Weitong Zhang, Zixiang Chen, and Quanquan Gu.

</span>
<span class="ltx_bibblock">Rephrase and respond: Let large language models ask better questions for themselves.

</span>
<span class="ltx_bibblock">2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dua et al. (2019)</span>
<span class="ltx_bibblock">
Dheeru Dua, Yizhong Wang, Pradeep Dasigi, Gabriel Stanovsky, Sameer Singh, and Matt Gardner.

</span>
<span class="ltx_bibblock">Drop: A reading comprehension benchmark requiring discrete reasoning over paragraphs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:1903.00161</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et al. (2024)</span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, et al.

</span>
<span class="ltx_bibblock">The llama 3 herd of models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2407.21783</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2023)</span>
<span class="ltx_bibblock">
Luyu Gao, Aman Madaan, Shuyan Zhou, Uri Alon, Pengfei Liu, Yiming Yang, Jamie Callan, and Graham Neubig.

</span>
<span class="ltx_bibblock">Pal: Program-aided language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">International Conference on Machine Learning</em>, pp.  10764–10799. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et al. (2021)</span>
<span class="ltx_bibblock">
Mor Geva, Daniel Khashabi, Elad Segal, Tushar Khot, Dan Roth, and Jonathan Berant.

</span>
<span class="ltx_bibblock">Did aristotle use a laptop? a question answering benchmark with implicit reasoning strategies.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Transactions of the Association for Computational Linguistics</em>, 9:346–361, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hao et al. (2023)</span>
<span class="ltx_bibblock">
Shibo Hao, Yi Gu, Haodi Ma, Joshua Hong, Zhen Wang, Daisy Wang, and Zhiting Hu.

</span>
<span class="ltx_bibblock">Reasoning with language model is planning with world model.

</span>
<span class="ltx_bibblock">In Houda Bouamor, Juan Pino, and Kalika Bali (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pp.  8154–8173, Singapore, December 2023. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2023.emnlp-main.507</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.emnlp-main.507" title="">https://aclanthology.org/2023.emnlp-main.507</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et al. (2021)</span>
<span class="ltx_bibblock">
Dan Hendrycks, Collin Burns, Saurav Kadavath, Akul Arora, Steven Basart, Eric Tang, Dawn Song, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Measuring mathematical problem solving with the math dataset.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2103.03874</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Imani et al. (2023)</span>
<span class="ltx_bibblock">
Shima Imani, Liang Du, and Harsh Shrivastava.

</span>
<span class="ltx_bibblock">Mathprompter: Mathematical reasoning using large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2303.05398</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kojima et al. (2022)</span>
<span class="ltx_bibblock">
Takeshi Kojima, Shixiang Shane Gu, Machel Reid, Yutaka Matsuo, and Yusuke Iwasawa.

</span>
<span class="ltx_bibblock">Large language models are zero-shot reasoners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Advances in neural information processing systems</em>, 35:22199–22213, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krause &amp; Stolzenburg (2023)</span>
<span class="ltx_bibblock">
Stefanie Krause and Frieder Stolzenburg.

</span>
<span class="ltx_bibblock">Commonsense reasoning and explainable artificial intelligence using large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">European Conference on Artificial Intelligence</em>, pp.  302–319. Springer, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewkowycz et al. (2022)</span>
<span class="ltx_bibblock">
Aitor Lewkowycz, Anders Andreassen, David Dohan, Ethan Dyer, Henryk Michalewski, Vinay Ramasesh, Ambrose Slone, Cem Anil, Imanol Schlag, Theo Gutman-Solo, et al.

</span>
<span class="ltx_bibblock">Solving quantitative reasoning problems with language models, 2022.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">URL https://arxiv. org/abs/2206.14858</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2023)</span>
<span class="ltx_bibblock">
Haipeng Luo, Qingfeng Sun, Can Xu, Pu Zhao, Jianguang Lou, Chongyang Tao, Xiubo Geng, Qingwei Lin, Shifeng Chen, and Dongmei Zhang.

</span>
<span class="ltx_bibblock">Wizardmath: Empowering mathematical reasoning for large language models via reinforced evol-instruct.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2308.09583</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2024)</span>
<span class="ltx_bibblock">
Liangchen Luo, Yinxiao Liu, Rosanne Liu, Samrat Phatale, Harsh Lara, Yunxuan Li, Lei Shu, Yun Zhu, Lei Meng, Jiao Sun, et al.

</span>
<span class="ltx_bibblock">Improve mathematical reasoning in language models by automated process supervision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2406.06592</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Madaan &amp; Yazdanbakhsh (2022)</span>
<span class="ltx_bibblock">
Aman Madaan and Amir Yazdanbakhsh.

</span>
<span class="ltx_bibblock">Text and patterns: For effective chain of thought, it takes two to tango.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2209.07686</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Madaan et al. (2024)</span>
<span class="ltx_bibblock">
Aman Madaan, Niket Tandon, Prakhar Gupta, Skyler Hallinan, Luyu Gao, Sarah Wiegreffe, Uri Alon, Nouha Dziri, Shrimai Prabhumoye, Yiming Yang, et al.

</span>
<span class="ltx_bibblock">Self-refine: Iterative refinement with self-feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2024)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Learning to reason with llms, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/index/learning-to-reason-with-llms/" title="">https://openai.com/index/learning-to-reason-with-llms/</a>.

</span>
<span class="ltx_bibblock">Accessed: 2024-10-01.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2023)</span>
<span class="ltx_bibblock">
Baolin Peng, Chunyuan Li, Pengcheng He, Michel Galley, and Jianfeng Gao.

</span>
<span class="ltx_bibblock">Instruction tuning with gpt-4.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2304.03277</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al. (2024)</span>
<span class="ltx_bibblock">
Zhenting Qi, Mingyuan Ma, Jiahang Xu, Li Lyna Zhang, Fan Yang, and Mao Yang.

</span>
<span class="ltx_bibblock">Mutual reasoning makes smaller llms stronger problem-solvers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2408.06195</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radhakrishnan et al. (2023)</span>
<span class="ltx_bibblock">
Ansh Radhakrishnan, Karina Nguyen, Anna Chen, Carol Chen, Carson Denison, Danny Hernandez, Esin Durmus, Evan Hubinger, Jackson Kernion, Kamilė Lukošiūtė, et al.

</span>
<span class="ltx_bibblock">Question decomposition improves the faithfulness of model-generated reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2307.11768</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rae et al. (2021)</span>
<span class="ltx_bibblock">
Jack W Rae, Sebastian Borgeaud, Trevor Cai, Katie Millican, Jordan Hoffmann, Francis Song, John Aslanides, Sarah Henderson, Roman Ring, Susannah Young, et al.

</span>
<span class="ltx_bibblock">Scaling language models: Methods, analysis &amp; insights from training gopher.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2112.11446</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saxton et al. (2019)</span>
<span class="ltx_bibblock">
David Saxton, Edward Grefenstette, Felix Hill, and Pushmeet Kohli.

</span>
<span class="ltx_bibblock">Analysing mathematical reasoning abilities of neural models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">International Conference on Learning Representations</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=H1gR5iR5FX" title="">https://openreview.net/forum?id=H1gR5iR5FX</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et al. (2024)</span>
<span class="ltx_bibblock">
Saurabh Srivastava, Chengyue Huang, Weiguo Fan, and Ziyu Yao.

</span>
<span class="ltx_bibblock">Instances need more care: Rewriting prompts for instances with LLMs in the loop yields better zero-shot performance.

</span>
<span class="ltx_bibblock">In Lun-Wei Ku, Andre Martins, and Vivek Srikumar (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Findings of the Association for Computational Linguistics ACL 2024</em>, pp.  6211–6232, Bangkok, Thailand and virtual meeting, August 2024. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2024.findings-acl.371</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2024.findings-acl.371" title="">https://aclanthology.org/2024.findings-acl.371</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suzgun et al. (2022)</span>
<span class="ltx_bibblock">
Mirac Suzgun, Nathan Scales, Nathanael Schärli, Sebastian Gehrmann, Yi Tay, Hyung Won Chung, Aakanksha Chowdhery, Quoc V Le, Ed H Chi, Denny Zhou, , and Jason Wei.

</span>
<span class="ltx_bibblock">Challenging big-bench tasks and whether chain-of-thought can solve them.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2210.09261</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al. (2024)</span>
<span class="ltx_bibblock">
Zhengyang Tang, Xingxing Zhang, Benyou Wan, and Furu Wei.

</span>
<span class="ltx_bibblock">Mathscale: Scaling instruction tuning for mathematical reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2403.02884</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Xinyuan Wang, Chenxi Li, Zhen Wang, Fan Bai, Haotian Luo, Jiayou Zhang, Nebojsa Jojic, Eric P Xing, and Zhiting Hu.

</span>
<span class="ltx_bibblock">Promptagent: Strategic planning with language models enables expert-level prompt optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2310.16427</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2022)</span>
<span class="ltx_bibblock">
Yizhong Wang, Swaroop Mishra, Pegah Alipoormolabashi, Yeganeh Kordi, Amirreza Mirzaei, Anjana Arunkumar, Arjun Ashok, Arut Selvan Dhanasekaran, Atharva Naik, David Stap, et al.

</span>
<span class="ltx_bibblock">Benchmarking generalization via in-context instructions on 1,600+ language tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2204.07705</em>, 2, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
<span class="ltx_bibblock">
Yubo Wang, Xueguang Ma, Ge Zhang, Yuansheng Ni, Abhranil Chandra, Shiguang Guo, Weiming Ren, Aaran Arulraj, Xuan He, Ziyan Jiang, Tianle Li, Max Ku, Kai Wang, Alex Zhuang, Rongqi Fan, Xiang Yue, and Wenhu Chen.

</span>
<span class="ltx_bibblock">Mmlu-pro: A more robust and challenging multi-task language understanding benchmark.

</span>
<span class="ltx_bibblock">2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2022)</span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Fei Xia, Ed Chi, Quoc V Le, Denny Zhou, et al.

</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Advances in neural information processing systems</em>, 35:24824–24837, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weng et al. (2022)</span>
<span class="ltx_bibblock">
Yixuan Weng, Minjun Zhu, Fei Xia, Bin Li, Shizhu He, Shengping Liu, Bin Sun, Kang Liu, and Jun Zhao.

</span>
<span class="ltx_bibblock">Large language models are better reasoners with self-verification.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2212.09561</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2024)</span>
<span class="ltx_bibblock">
Yuxi Xie, Anirudh Goyal, Wenyue Zheng, Min-Yen Kan, Timothy P Lillicrap, Kenji Kawaguchi, and Michael Shieh.

</span>
<span class="ltx_bibblock">Monte carlo tree search boosts reasoning via iterative preference learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2405.00451</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2024)</span>
<span class="ltx_bibblock">
Shunyu Yao, Dian Yu, Jeffrey Zhao, Izhak Shafran, Tom Griffiths, Yuan Cao, and Karthik Narasimhan.

</span>
<span class="ltx_bibblock">Tree of thoughts: Deliberate problem solving with large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al. (2023)</span>
<span class="ltx_bibblock">
Xiang Yue, Xingwei Qu, Ge Zhang, Yao Fu, Wenhao Huang, Huan Sun, Yu Su, and Wenhu Chen.

</span>
<span class="ltx_bibblock">Mammoth: Building math generalist models through hybrid instruction tuning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2309.05653</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al. (2024)</span>
<span class="ltx_bibblock">
Xiang Yue, Tuney Zheng, Ge Zhang, and Wenhu Chen.

</span>
<span class="ltx_bibblock">Mammoth2: Scaling instructions from the web.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2405.03548</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2023)</span>
<span class="ltx_bibblock">
James Xu Zhao, Yuxi Xie, Kenji Kawaguchi, Junxian He, and Michael Qizhe Xie.

</span>
<span class="ltx_bibblock">Automatic model selection with large language models for reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2305.14333</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2024)</span>
<span class="ltx_bibblock">
Zirui Zhao, Wee Sun Lee, and David Hsu.

</span>
<span class="ltx_bibblock">Large language models as commonsense knowledge for large-scale task planning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. (2023)</span>
<span class="ltx_bibblock">
Wanjun Zhong, Ruixiang Cui, Yiduo Guo, Yaobo Liang, Shuai Lu, Yanlin Wang, Amin Saied, Weizhu Chen, and Nan Duan.

</span>
<span class="ltx_bibblock">Agieval: A human-centric benchmark for evaluating foundation models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2304.06364</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2023)</span>
<span class="ltx_bibblock">
Denny Zhou, Nathanael Schärli, Le Hou, Jason Wei, Nathan Scales, Xuezhi Wang, Dale Schuurmans, Claire Cui, Olivier Bousquet, Quoc V Le, and Ed H. Chi.

</span>
<span class="ltx_bibblock">Least-to-most prompting enables complex reasoning in large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=WZH7099tgfM" title="">https://openreview.net/forum?id=WZH7099tgfM</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2024)</span>
<span class="ltx_bibblock">
Pei Zhou, Jay Pujara, Xiang Ren, Xinyun Chen, Heng-Tze Cheng, Quoc V Le, Ed H Chi, Denny Zhou, Swaroop Mishra, and Huaixiu Steven Zheng.

</span>
<span class="ltx_bibblock">Self-discover: Large language models self-compose reasoning structures.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2402.03620</em>, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Training Implementation</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.4">In our optimal trajectory search, we set the number of iterations (<math alttext="K" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">italic_K</annotation></semantics></math>) to 2 and the number of evaluation times (<math alttext="N_{eval}" class="ltx_Math" display="inline" id="A1.p1.2.m2.1"><semantics id="A1.p1.2.m2.1a"><msub id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml"><mi id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml">N</mi><mrow id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml"><mi id="A1.p1.2.m2.1.1.3.2" xref="A1.p1.2.m2.1.1.3.2.cmml">e</mi><mo id="A1.p1.2.m2.1.1.3.1" xref="A1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.p1.2.m2.1.1.3.3" xref="A1.p1.2.m2.1.1.3.3.cmml">v</mi><mo id="A1.p1.2.m2.1.1.3.1a" xref="A1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.p1.2.m2.1.1.3.4" xref="A1.p1.2.m2.1.1.3.4.cmml">a</mi><mo id="A1.p1.2.m2.1.1.3.1b" xref="A1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.p1.2.m2.1.1.3.5" xref="A1.p1.2.m2.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2">𝑁</ci><apply id="A1.p1.2.m2.1.1.3.cmml" xref="A1.p1.2.m2.1.1.3"><times id="A1.p1.2.m2.1.1.3.1.cmml" xref="A1.p1.2.m2.1.1.3.1"></times><ci id="A1.p1.2.m2.1.1.3.2.cmml" xref="A1.p1.2.m2.1.1.3.2">𝑒</ci><ci id="A1.p1.2.m2.1.1.3.3.cmml" xref="A1.p1.2.m2.1.1.3.3">𝑣</ci><ci id="A1.p1.2.m2.1.1.3.4.cmml" xref="A1.p1.2.m2.1.1.3.4">𝑎</ci><ci id="A1.p1.2.m2.1.1.3.5.cmml" xref="A1.p1.2.m2.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">N_{eval}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math>) to 4. The number of paths retained <math alttext="N_{1}" class="ltx_Math" display="inline" id="A1.p1.3.m3.1"><semantics id="A1.p1.3.m3.1a"><msub id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml"><mi id="A1.p1.3.m3.1.1.2" xref="A1.p1.3.m3.1.1.2.cmml">N</mi><mn id="A1.p1.3.m3.1.1.3" xref="A1.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><apply id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p1.3.m3.1.1.1.cmml" xref="A1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.p1.3.m3.1.1.2.cmml" xref="A1.p1.3.m3.1.1.2">𝑁</ci><cn id="A1.p1.3.m3.1.1.3.cmml" type="integer" xref="A1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">N_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.3.m3.1d">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is set to 8 and <math alttext="N_{2}" class="ltx_Math" display="inline" id="A1.p1.4.m4.1"><semantics id="A1.p1.4.m4.1a"><msub id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml"><mi id="A1.p1.4.m4.1.1.2" xref="A1.p1.4.m4.1.1.2.cmml">N</mi><mn id="A1.p1.4.m4.1.1.3" xref="A1.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><apply id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.p1.4.m4.1.1.1.cmml" xref="A1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.p1.4.m4.1.1.2.cmml" xref="A1.p1.4.m4.1.1.2">𝑁</ci><cn id="A1.p1.4.m4.1.1.3.cmml" type="integer" xref="A1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">N_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.4.m4.1d">italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> to 3. Throughout the search, we maintain a sampling temperature of 0.4.
Searching on the training datasets eventually yields 1722 for GPT-4o-mini, 1624 for Llama-3-70B-Instruct, and 2140 for Llama-3-8B-Instruct training examples for planner tuning, respectively.
We up-sample few-shot examples by a factor of 8 and fine-tune the planner LLM using the LitGPT library <cite class="ltx_cite ltx_citemacro_citep">(AI, <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#bib.bib2" title="">2023</a>)</cite>, applying a learning rate of 2e-5, a global batch size of 64, a maximum sequence length of 4096, and training epoch of 4.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Case Study</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.2">In this section, <math alttext="Q_{I}" class="ltx_Math" display="inline" id="A2.p1.1.m1.1"><semantics id="A2.p1.1.m1.1a"><msub id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml"><mi id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml">Q</mi><mi id="A2.p1.1.m1.1.1.3" xref="A2.p1.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1">subscript</csymbol><ci id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2">𝑄</ci><ci id="A2.p1.1.m1.1.1.3.cmml" xref="A2.p1.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">Q_{I}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.1.m1.1d">italic_Q start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> is a numerical reasoning problem that can be solved with Python code easily, so our tuned LLM selected PoT to solve it. <math alttext="Q_{II}" class="ltx_Math" display="inline" id="A2.p1.2.m2.1"><semantics id="A2.p1.2.m2.1a"><msub id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml"><mi id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml">Q</mi><mrow id="A2.p1.2.m2.1.1.3" xref="A2.p1.2.m2.1.1.3.cmml"><mi id="A2.p1.2.m2.1.1.3.2" xref="A2.p1.2.m2.1.1.3.2.cmml">I</mi><mo id="A2.p1.2.m2.1.1.3.1" xref="A2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A2.p1.2.m2.1.1.3.3" xref="A2.p1.2.m2.1.1.3.3.cmml">I</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1">subscript</csymbol><ci id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2">𝑄</ci><apply id="A2.p1.2.m2.1.1.3.cmml" xref="A2.p1.2.m2.1.1.3"><times id="A2.p1.2.m2.1.1.3.1.cmml" xref="A2.p1.2.m2.1.1.3.1"></times><ci id="A2.p1.2.m2.1.1.3.2.cmml" xref="A2.p1.2.m2.1.1.3.2">𝐼</ci><ci id="A2.p1.2.m2.1.1.3.3.cmml" xref="A2.p1.2.m2.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">Q_{II}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.2.m2.1d">italic_Q start_POSTSUBSCRIPT italic_I italic_I end_POSTSUBSCRIPT</annotation></semantics></math> is a question widely tested in the community where GPT-4o even tends to make mistakes, but after tuning with searched trajectory data, the LLM actively chose to use code to solve the problem.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para ltx_noindent" id="A2.p2">
<svg class="ltx_picture" height="1785.32" id="A2.p2.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,1785.32) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 1779.42 C 0 1782.68 2.64 1785.32 5.91 1785.32 L 594.09 1785.32 C 597.36 1785.32 600 1782.68 600 1779.42 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 1761.21 L 598.03 1761.21 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 1767.12)"><foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.p2.pic1.8.8.8.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A2.p2.pic1.8.8.8.1.1.1">Question 1 Case Study</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="1735.62" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7" style="width:402.3pt;">
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.8"><span class="ltx_text ltx_font_bold" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.8.1">Question I:</span></span>
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.9">A book with 50 pages numbered 1 through 50 has its pages renumbered in reverse, from 50 to 1. For how many pages do both sets of page numbers share the same digit?</span>
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.10"><span class="ltx_text ltx_font_bold" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.10.1">Answer from GPT-4o-2024-08-06 (Incorrect):</span></span>
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.11">To solve this problem, we need to determine how many pages have the same ones digit in both the original numbering (1 to 50) and the reversed numbering (50 to 1).</span>
<span class="ltx_p" id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5">First, let’s understand the problem:
- The original numbering of the pages is from 1 to 50.
- The reversed numbering is from 50 to 1, meaning page 1 becomes 50, page 2 becomes 49, and so on, until page 50 becomes 1.
We need to find pages where the ones digit of the original page number is the same as the ones digit of the reversed page number.
Let’s denote the original page number as <math alttext="n" class="ltx_Math" display="inline" id="A2.p2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="A2.p2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="A2.p2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="A2.p2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A2.p2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="A2.p2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A2.p2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="A2.p2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_n</annotation></semantics></math> and the reversed page number as <math alttext="51-n" class="ltx_Math" display="inline" id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1"><semantics id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1a"><mrow id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1" xref="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml"><mn id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2" xref="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2.cmml">51</mn><mo id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.1" xref="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.1.cmml">−</mo><mi id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3" xref="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1b"><apply id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1"><minus id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.1.cmml" xref="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.1"></minus><cn id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2.cmml" type="integer" xref="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2">51</cn><ci id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3.cmml" xref="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1c">51-n</annotation><annotation encoding="application/x-llamapun" id="A2.p2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1d">51 - italic_n</annotation></semantics></math>. We are looking for <math alttext="n" class="ltx_Math" display="inline" id="A2.p2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1"><semantics id="A2.p2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1a"><mi id="A2.p2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1" xref="A2.p2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A2.p2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1b"><ci id="A2.p2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1.cmml" xref="A2.p2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="A2.p2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1d">italic_n</annotation></semantics></math> such that the ones digit of <math alttext="n" class="ltx_Math" display="inline" id="A2.p2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m4.1"><semantics id="A2.p2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m4.1a"><mi id="A2.p2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m4.1.1" xref="A2.p2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A2.p2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m4.1b"><ci id="A2.p2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m4.1.1.cmml" xref="A2.p2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="A2.p2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.m4.1d">italic_n</annotation></semantics></math> is equal to the ones digit of <math alttext="51-n" class="ltx_Math" display="inline" id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1"><semantics id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1a"><mrow id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1" xref="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.cmml"><mn id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.2" xref="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.2.cmml">51</mn><mo id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.1" xref="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.1.cmml">−</mo><mi id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.3" xref="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1b"><apply id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.cmml" xref="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1"><minus id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.1.cmml" xref="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.1"></minus><cn id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.2.cmml" type="integer" xref="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.2">51</cn><ci id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.3.cmml" xref="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1c">51-n</annotation><annotation encoding="application/x-llamapun" id="A2.p2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.m5.1d">51 - italic_n</annotation></semantics></math>.</span>
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.12">The ones digit of a number is the remainder when the number is divided by 10. Therefore, we need:</span>
<span class="ltx_equation ltx_eqn_table" id="A2.Ex1">
<span><span class="ltx_equation ltx_eqn_row ltx_align_baseline">
<span class="ltx_eqn_cell ltx_eqn_center_padleft"></span>
<span class="ltx_eqn_cell ltx_align_center"><math alttext="n\equiv 51-n\pmod{10}" class="ltx_Math" display="block" id="A2.Ex1.m1.2"><semantics id="A2.Ex1.m1.2a"><mrow id="A2.Ex1.m1.2.3" xref="A2.Ex1.m1.2.3.cmml"><mi id="A2.Ex1.m1.2.3.2" xref="A2.Ex1.m1.2.3.2.cmml">n</mi><mo id="A2.Ex1.m1.2.3.1" xref="A2.Ex1.m1.2.3.1.cmml">≡</mo><mrow id="A2.Ex1.m1.2.3.3" xref="A2.Ex1.m1.2.3.3.cmml"><mrow id="A2.Ex1.m1.2.3.3.2" xref="A2.Ex1.m1.2.3.3.2.cmml"><mn id="A2.Ex1.m1.2.3.3.2.2" xref="A2.Ex1.m1.2.3.3.2.2.cmml">51</mn><mo id="A2.Ex1.m1.2.3.3.2.1" xref="A2.Ex1.m1.2.3.3.2.1.cmml">−</mo><mi id="A2.Ex1.m1.2.3.3.2.3" xref="A2.Ex1.m1.2.3.3.2.3.cmml">n</mi></mrow><mspace id="A2.Ex1.m1.2.3.3a" width="0.949em" xref="A2.Ex1.m1.2.3.3.cmml"></mspace><mrow id="A2.Ex1.m1.2.2.2.2" xref="A2.Ex1.m1.2.2.3.cmml"><mo id="A2.Ex1.m1.2.2.2.2.2" stretchy="false" xref="A2.Ex1.m1.2.2.3.1.cmml">(</mo><mrow id="A2.Ex1.m1.2.2.2.2.1" xref="A2.Ex1.m1.2.2.3.cmml"><mo id="A2.Ex1.m1.2.2.2.2.1.1" lspace="0em" movablelimits="false" rspace="0.167em" xref="A2.Ex1.m1.2.2.3.1.cmml">mod</mo><mn id="A2.Ex1.m1.1.1.1.1" xref="A2.Ex1.m1.1.1.1.1.cmml">10</mn></mrow><mo id="A2.Ex1.m1.2.2.2.2.3" stretchy="false" xref="A2.Ex1.m1.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex1.m1.2b"><apply id="A2.Ex1.m1.2.3.cmml" xref="A2.Ex1.m1.2.3"><equivalent id="A2.Ex1.m1.2.3.1.cmml" xref="A2.Ex1.m1.2.3.1"></equivalent><ci id="A2.Ex1.m1.2.3.2.cmml" xref="A2.Ex1.m1.2.3.2">𝑛</ci><apply id="A2.Ex1.m1.2.3.3.cmml" xref="A2.Ex1.m1.2.3.3"><csymbol cd="latexml" id="A2.Ex1.m1.2.3.3.1.cmml" xref="A2.Ex1.m1.2.3.3">annotated</csymbol><apply id="A2.Ex1.m1.2.3.3.2.cmml" xref="A2.Ex1.m1.2.3.3.2"><minus id="A2.Ex1.m1.2.3.3.2.1.cmml" xref="A2.Ex1.m1.2.3.3.2.1"></minus><cn id="A2.Ex1.m1.2.3.3.2.2.cmml" type="integer" xref="A2.Ex1.m1.2.3.3.2.2">51</cn><ci id="A2.Ex1.m1.2.3.3.2.3.cmml" xref="A2.Ex1.m1.2.3.3.2.3">𝑛</ci></apply><apply id="A2.Ex1.m1.2.2.3.cmml" xref="A2.Ex1.m1.2.2.2.2"><ci id="A2.Ex1.m1.2.2.3.1.cmml" xref="A2.Ex1.m1.2.2.2.2.2">pmod</ci><cn id="A2.Ex1.m1.1.1.1.1.cmml" type="integer" xref="A2.Ex1.m1.1.1.1.1">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex1.m1.2c">n\equiv 51-n\pmod{10}</annotation><annotation encoding="application/x-llamapun" id="A2.Ex1.m1.2d">italic_n ≡ 51 - italic_n start_MODIFIER ( roman_mod start_ARG 10 end_ARG ) end_MODIFIER</annotation></semantics></math></span>
<span class="ltx_eqn_cell ltx_eqn_center_padright"></span></span></span>
</span>
<span class="ltx_p" id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6">Since <math alttext="51\equiv 1\pmod{10}" class="ltx_Math" display="inline" id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2"><semantics id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2a"><mrow id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.cmml"><mn id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.2" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.2.cmml">51</mn><mo id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.1" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.1.cmml">≡</mo><mrow id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3.cmml"><mn id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3.2" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3.2.cmml">1</mn><mspace id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3a" width="0.949em" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3.cmml"></mspace><mrow id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.2.2" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.3.cmml"><mo id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.2.2.2" stretchy="false" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.3.1.cmml">(</mo><mrow id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.2.2.1" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.3.cmml"><mo id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.2.2.1.1" lspace="0em" rspace="0.167em" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.3.1.cmml">mod</mo><mn id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1.1.1" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1.1.1.cmml">10</mn></mrow><mo id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.2.2.3" stretchy="false" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2b"><apply id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.cmml" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3"><equivalent id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.1.cmml" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.1"></equivalent><cn id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.2.cmml" type="integer" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.2">51</cn><apply id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3.cmml" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3"><csymbol cd="latexml" id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3.1.cmml" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3">annotated</csymbol><cn id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3.2.cmml" type="integer" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.3.3.2">1</cn><apply id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.3.cmml" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.2.2"><ci id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.3.1.cmml" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2.2.2.2.2">pmod</ci><cn id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1.1.1.cmml" type="integer" xref="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.1.1.1.1">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2c">51\equiv 1\pmod{10}</annotation><annotation encoding="application/x-llamapun" id="A2.p2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.m1.2d">51 ≡ 1 start_MODIFIER ( roman_mod start_ARG 10 end_ARG ) end_MODIFIER</annotation></semantics></math>, we have:</span>
<span class="ltx_equation ltx_eqn_table" id="A2.Ex2">
<span><span class="ltx_equation ltx_eqn_row ltx_align_baseline">
<span class="ltx_eqn_cell ltx_eqn_center_padleft"></span>
<span class="ltx_eqn_cell ltx_align_center"><math alttext="2n\equiv 1\pmod{10}" class="ltx_Math" display="block" id="A2.Ex2.m1.2"><semantics id="A2.Ex2.m1.2a"><mrow id="A2.Ex2.m1.2.3" xref="A2.Ex2.m1.2.3.cmml"><mrow id="A2.Ex2.m1.2.3.2" xref="A2.Ex2.m1.2.3.2.cmml"><mn id="A2.Ex2.m1.2.3.2.2" xref="A2.Ex2.m1.2.3.2.2.cmml">2</mn><mo id="A2.Ex2.m1.2.3.2.1" xref="A2.Ex2.m1.2.3.2.1.cmml">⁢</mo><mi id="A2.Ex2.m1.2.3.2.3" xref="A2.Ex2.m1.2.3.2.3.cmml">n</mi></mrow><mo id="A2.Ex2.m1.2.3.1" xref="A2.Ex2.m1.2.3.1.cmml">≡</mo><mrow id="A2.Ex2.m1.2.3.3" xref="A2.Ex2.m1.2.3.3.cmml"><mn id="A2.Ex2.m1.2.3.3.2" xref="A2.Ex2.m1.2.3.3.2.cmml">1</mn><mspace id="A2.Ex2.m1.2.3.3a" width="0.949em" xref="A2.Ex2.m1.2.3.3.cmml"></mspace><mrow id="A2.Ex2.m1.2.2.2.2" xref="A2.Ex2.m1.2.2.3.cmml"><mo id="A2.Ex2.m1.2.2.2.2.2" stretchy="false" xref="A2.Ex2.m1.2.2.3.1.cmml">(</mo><mrow id="A2.Ex2.m1.2.2.2.2.1" xref="A2.Ex2.m1.2.2.3.cmml"><mo id="A2.Ex2.m1.2.2.2.2.1.1" lspace="0em" movablelimits="false" rspace="0.167em" xref="A2.Ex2.m1.2.2.3.1.cmml">mod</mo><mn id="A2.Ex2.m1.1.1.1.1" xref="A2.Ex2.m1.1.1.1.1.cmml">10</mn></mrow><mo id="A2.Ex2.m1.2.2.2.2.3" stretchy="false" xref="A2.Ex2.m1.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex2.m1.2b"><apply id="A2.Ex2.m1.2.3.cmml" xref="A2.Ex2.m1.2.3"><equivalent id="A2.Ex2.m1.2.3.1.cmml" xref="A2.Ex2.m1.2.3.1"></equivalent><apply id="A2.Ex2.m1.2.3.2.cmml" xref="A2.Ex2.m1.2.3.2"><times id="A2.Ex2.m1.2.3.2.1.cmml" xref="A2.Ex2.m1.2.3.2.1"></times><cn id="A2.Ex2.m1.2.3.2.2.cmml" type="integer" xref="A2.Ex2.m1.2.3.2.2">2</cn><ci id="A2.Ex2.m1.2.3.2.3.cmml" xref="A2.Ex2.m1.2.3.2.3">𝑛</ci></apply><apply id="A2.Ex2.m1.2.3.3.cmml" xref="A2.Ex2.m1.2.3.3"><csymbol cd="latexml" id="A2.Ex2.m1.2.3.3.1.cmml" xref="A2.Ex2.m1.2.3.3">annotated</csymbol><cn id="A2.Ex2.m1.2.3.3.2.cmml" type="integer" xref="A2.Ex2.m1.2.3.3.2">1</cn><apply id="A2.Ex2.m1.2.2.3.cmml" xref="A2.Ex2.m1.2.2.2.2"><ci id="A2.Ex2.m1.2.2.3.1.cmml" xref="A2.Ex2.m1.2.2.2.2.2">pmod</ci><cn id="A2.Ex2.m1.1.1.1.1.cmml" type="integer" xref="A2.Ex2.m1.1.1.1.1">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex2.m1.2c">2n\equiv 1\pmod{10}</annotation><annotation encoding="application/x-llamapun" id="A2.Ex2.m1.2d">2 italic_n ≡ 1 start_MODIFIER ( roman_mod start_ARG 10 end_ARG ) end_MODIFIER</annotation></semantics></math></span>
<span class="ltx_eqn_cell ltx_eqn_center_padright"></span></span></span>
</span>
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.13">Thus, multiplying both sides of the congruence by 5 gives:</span>
<span class="ltx_equation ltx_eqn_table" id="A2.Ex3">
<span><span class="ltx_equation ltx_eqn_row ltx_align_baseline">
<span class="ltx_eqn_cell ltx_eqn_center_padleft"></span>
<span class="ltx_eqn_cell ltx_align_center"><math alttext="n\equiv 5\times 1\equiv 5\pmod{10}" class="ltx_Math" display="block" id="A2.Ex3.m1.2"><semantics id="A2.Ex3.m1.2a"><mrow id="A2.Ex3.m1.2.3" xref="A2.Ex3.m1.2.3.cmml"><mi id="A2.Ex3.m1.2.3.2" xref="A2.Ex3.m1.2.3.2.cmml">n</mi><mo id="A2.Ex3.m1.2.3.3" xref="A2.Ex3.m1.2.3.3.cmml">≡</mo><mrow id="A2.Ex3.m1.2.3.4" xref="A2.Ex3.m1.2.3.4.cmml"><mn id="A2.Ex3.m1.2.3.4.2" xref="A2.Ex3.m1.2.3.4.2.cmml">5</mn><mo id="A2.Ex3.m1.2.3.4.1" lspace="0.222em" rspace="0.222em" xref="A2.Ex3.m1.2.3.4.1.cmml">×</mo><mn id="A2.Ex3.m1.2.3.4.3" xref="A2.Ex3.m1.2.3.4.3.cmml">1</mn></mrow><mo id="A2.Ex3.m1.2.3.5" xref="A2.Ex3.m1.2.3.5.cmml">≡</mo><mrow id="A2.Ex3.m1.2.3.6" xref="A2.Ex3.m1.2.3.6.cmml"><mn id="A2.Ex3.m1.2.3.6.2" xref="A2.Ex3.m1.2.3.6.2.cmml">5</mn><mspace id="A2.Ex3.m1.2.3.6a" width="0.949em" xref="A2.Ex3.m1.2.3.6.cmml"></mspace><mrow id="A2.Ex3.m1.2.2.2.2" xref="A2.Ex3.m1.2.2.3.cmml"><mo id="A2.Ex3.m1.2.2.2.2.2" stretchy="false" xref="A2.Ex3.m1.2.2.3.1.cmml">(</mo><mrow id="A2.Ex3.m1.2.2.2.2.1" xref="A2.Ex3.m1.2.2.3.cmml"><mo id="A2.Ex3.m1.2.2.2.2.1.1" lspace="0em" movablelimits="false" rspace="0.167em" xref="A2.Ex3.m1.2.2.3.1.cmml">mod</mo><mn id="A2.Ex3.m1.1.1.1.1" xref="A2.Ex3.m1.1.1.1.1.cmml">10</mn></mrow><mo id="A2.Ex3.m1.2.2.2.2.3" stretchy="false" xref="A2.Ex3.m1.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex3.m1.2b"><apply id="A2.Ex3.m1.2.3.cmml" xref="A2.Ex3.m1.2.3"><and id="A2.Ex3.m1.2.3a.cmml" xref="A2.Ex3.m1.2.3"></and><apply id="A2.Ex3.m1.2.3b.cmml" xref="A2.Ex3.m1.2.3"><equivalent id="A2.Ex3.m1.2.3.3.cmml" xref="A2.Ex3.m1.2.3.3"></equivalent><ci id="A2.Ex3.m1.2.3.2.cmml" xref="A2.Ex3.m1.2.3.2">𝑛</ci><apply id="A2.Ex3.m1.2.3.4.cmml" xref="A2.Ex3.m1.2.3.4"><times id="A2.Ex3.m1.2.3.4.1.cmml" xref="A2.Ex3.m1.2.3.4.1"></times><cn id="A2.Ex3.m1.2.3.4.2.cmml" type="integer" xref="A2.Ex3.m1.2.3.4.2">5</cn><cn id="A2.Ex3.m1.2.3.4.3.cmml" type="integer" xref="A2.Ex3.m1.2.3.4.3">1</cn></apply></apply><apply id="A2.Ex3.m1.2.3c.cmml" xref="A2.Ex3.m1.2.3"><equivalent id="A2.Ex3.m1.2.3.5.cmml" xref="A2.Ex3.m1.2.3.5"></equivalent><share href="https://arxiv.org/html/2410.03864v1#A2.Ex3.m1.2.3.4.cmml" id="A2.Ex3.m1.2.3d.cmml" xref="A2.Ex3.m1.2.3"></share><apply id="A2.Ex3.m1.2.3.6.cmml" xref="A2.Ex3.m1.2.3.6"><csymbol cd="latexml" id="A2.Ex3.m1.2.3.6.1.cmml" xref="A2.Ex3.m1.2.3.6">annotated</csymbol><cn id="A2.Ex3.m1.2.3.6.2.cmml" type="integer" xref="A2.Ex3.m1.2.3.6.2">5</cn><apply id="A2.Ex3.m1.2.2.3.cmml" xref="A2.Ex3.m1.2.2.2.2"><ci id="A2.Ex3.m1.2.2.3.1.cmml" xref="A2.Ex3.m1.2.2.2.2.2">pmod</ci><cn id="A2.Ex3.m1.1.1.1.1.cmml" type="integer" xref="A2.Ex3.m1.1.1.1.1">10</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex3.m1.2c">n\equiv 5\times 1\equiv 5\pmod{10}</annotation><annotation encoding="application/x-llamapun" id="A2.Ex3.m1.2d">italic_n ≡ 5 × 1 ≡ 5 start_MODIFIER ( roman_mod start_ARG 10 end_ARG ) end_MODIFIER</annotation></semantics></math></span>
<span class="ltx_eqn_cell ltx_eqn_center_padright"></span></span></span>
</span>
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7">This means <math alttext="n" class="ltx_Math" display="inline" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m1.1"><semantics id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m1.1a"><mi id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m1.1.1" xref="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m1.1b"><ci id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m1.1.1.cmml" xref="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.m1.1d">italic_n</annotation></semantics></math> must have a ones digit of 5. The pages with a ones digit of 5 in the original numbering are 5, 15, 25, 35, and 45.</span>
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.14">Thus, the number of pages that share the same one’s digit in both numbering systems is: 5</span>
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.15"><span class="ltx_text ltx_font_bold" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.15.1">Answer from our internal planner tuned Llama3-8b-Instruct:</span></span>
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.16">It can efficiently iterate through the range of page numbers to count occurrences of the same ones digit. Programming solver provides a quick and reliable method to handle the counting of digits across a defined range. 
<br class="ltx_break"/>Required Action: programming</span>
<span class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.17"><span class="ltx_listing_data"><a download="" href="data:text/plain;base64,Y291bnQgPSAwCmZvciBvcmlnaW5hbF9wYWdlIGluIHJhbmdlKDEsIDUxKToKICAgIHJlbnVtYmVyZWRfcGFnZSA9IDUxLW9yaWdpbmFsX3BhZ2UKICAgICMgQ2hlY2sgaWYgdGhlIG9uZXMgZGlnaXQgaXMgdGhlIHNhbWUKICAgIGlmIG9yaWdpbmFsX3BhZ2UgJSAxMCA9PSByZW51bWJlcmVkX3BhZ2UgJSAxMDoKICAgICAgICBjb3VudCArPSAxCnByaW50KGNvdW50KQ==">⬇</a></span>
<span class="ltx_listingline" id="lstnumberx1"><span class="ltx_text ltx_lst_identifier" id="lstnumberx1.1">count</span><span class="ltx_text ltx_lst_space" id="lstnumberx1.2"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx1.3"> </span>0
</span>
<span class="ltx_listingline" id="lstnumberx2"><span class="ltx_text ltx_lst_keyword ltx_font_bold" id="lstnumberx2.1">for</span><span class="ltx_text ltx_lst_space" id="lstnumberx2.2"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx2.3">original_page</span><span class="ltx_text ltx_lst_space" id="lstnumberx2.4"> </span><span class="ltx_text ltx_lst_keyword ltx_font_bold" id="lstnumberx2.5">in</span><span class="ltx_text ltx_lst_space" id="lstnumberx2.6"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_bold" id="lstnumberx2.7">range</span>(1,<span class="ltx_text ltx_lst_space" id="lstnumberx2.8"> </span>51):
</span>
<span class="ltx_listingline" id="lstnumberx3"><span class="ltx_text ltx_lst_space" id="lstnumberx3.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx3.2">renumbered_page</span><span class="ltx_text ltx_lst_space" id="lstnumberx3.3"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx3.4"> </span>51-<span class="ltx_text ltx_lst_identifier" id="lstnumberx3.5">original_page</span>
</span>
<span class="ltx_listingline" id="lstnumberx4"><span class="ltx_text ltx_lst_space" id="lstnumberx4.1"> </span><span class="ltx_text ltx_lst_comment ltx_font_italic" id="lstnumberx4.2">#<span class="ltx_text ltx_lst_space" id="lstnumberx4.2.1"> </span>Check<span class="ltx_text ltx_lst_space" id="lstnumberx4.2.2"> </span>if<span class="ltx_text ltx_lst_space" id="lstnumberx4.2.3"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx4.2.4"> </span>ones<span class="ltx_text ltx_lst_space" id="lstnumberx4.2.5"> </span>digit<span class="ltx_text ltx_lst_space" id="lstnumberx4.2.6"> </span>is<span class="ltx_text ltx_lst_space" id="lstnumberx4.2.7"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx4.2.8"> </span>same</span>
</span>
<span class="ltx_listingline" id="lstnumberx5"><span class="ltx_text ltx_lst_space" id="lstnumberx5.1"> </span><span class="ltx_text ltx_lst_keyword ltx_font_bold" id="lstnumberx5.2">if</span><span class="ltx_text ltx_lst_space" id="lstnumberx5.3"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx5.4">original_page</span><span class="ltx_text ltx_lst_space" id="lstnumberx5.5"> </span>%<span class="ltx_text ltx_lst_space" id="lstnumberx5.6"> </span>10<span class="ltx_text ltx_lst_space" id="lstnumberx5.7"> </span>==<span class="ltx_text ltx_lst_space" id="lstnumberx5.8"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx5.9">renumbered_page</span><span class="ltx_text ltx_lst_space" id="lstnumberx5.10"> </span>%<span class="ltx_text ltx_lst_space" id="lstnumberx5.11"> </span>10:
</span>
<span class="ltx_listingline" id="lstnumberx6"><span class="ltx_text ltx_lst_space" id="lstnumberx6.1"> </span><span class="ltx_text ltx_lst_identifier" id="lstnumberx6.2">count</span><span class="ltx_text ltx_lst_space" id="lstnumberx6.3"> </span>+=<span class="ltx_text ltx_lst_space" id="lstnumberx6.4"> </span>1
</span>
<span class="ltx_listingline" id="lstnumberx7"><span class="ltx_text ltx_lst_keyword ltx_font_bold" id="lstnumberx7.1">print</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx7.2">count</span>)
</span>
</span>
<span class="ltx_p" id="A2.p2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.18">After execution, we get: 0

<br class="ltx_break"/>Answer: 0</span>
</span></foreignobject></g></g></svg>
</div>
<div class="ltx_para ltx_noindent" id="A2.p3">
<svg class="ltx_picture" height="559.36" id="A2.p3.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,559.36) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 553.46 C 0 556.72 2.64 559.36 5.91 559.36 L 594.09 559.36 C 597.36 559.36 600 556.72 600 553.46 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 535.25 L 598.03 535.25 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 541.16)"><foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.p3.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A2.p3.pic1.1.1.1.1.1.1">Question 2 Case Study</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="509.66" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.p3.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A2.p3.pic1.2.2.2.1.1.1"><span class="ltx_text ltx_font_bold" id="A2.p3.pic1.2.2.2.1.1.1.1">Question II:</span></span>
<span class="ltx_p" id="A2.p3.pic1.2.2.2.1.1.2">How many r in word ‘strawberry’?</span>
<span class="ltx_p" id="A2.p3.pic1.2.2.2.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.p3.pic1.2.2.2.1.1.3.1">Answer from GPT-4o-2024-08-06 (Incorrect):</span></span>
<span class="ltx_p" id="A2.p3.pic1.2.2.2.1.1.4">The word “strawberry” contains 2 letter “r”s.</span>
<span class="ltx_p" id="A2.p3.pic1.2.2.2.1.1.5"><span class="ltx_text ltx_font_bold" id="A2.p3.pic1.2.2.2.1.1.5.1">Answer from our internal planner tuned Llama-8b-Instruct:</span></span>
<span class="ltx_p" id="A2.p3.pic1.2.2.2.1.1.6">It can efficiently count the occurrences of a specific character (in this case, ‘r’) in a word. Programming_solver provides a quick and reliable method for counting characters in text, ensuring accuracy in the result. 
<br class="ltx_break"/>Required Action: programming</span>
<span class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing" id="A2.p3.pic1.2.2.2.1.1.7"><span class="ltx_listing_data"><a download="" href="data:text/plain;base64,d29yZCA9IGBzdHJhd2JlcnJ5Jwpjb3VudD13b3JkLmxvd2VyKCkuY291bnQoYHInKQpwcmludChjb3VudCk=">⬇</a></span>
<span class="ltx_listingline" id="lstnumberx8"><span class="ltx_text ltx_lst_identifier" id="lstnumberx8.1">word</span><span class="ltx_text ltx_lst_space" id="lstnumberx8.2"> </span>=<span class="ltx_text ltx_lst_space" id="lstnumberx8.3"> </span>‘<span class="ltx_text ltx_lst_identifier" id="lstnumberx8.4">strawberry</span><span class="ltx_text ltx_lst_string" id="lstnumberx8.5">’</span>
</span>
<span class="ltx_listingline" id="lstnumberx9">count=word.lower().count(‘r’)
</span>
<span class="ltx_listingline" id="lstnumberx10"><span class="ltx_text ltx_lst_keyword ltx_font_bold" id="lstnumberx10.1">print</span>(<span class="ltx_text ltx_lst_identifier" id="lstnumberx10.2">count</span>)
</span>
</span>
<span class="ltx_p" id="A2.p3.pic1.2.2.2.1.1.8">After execution, we get: 3

<br class="ltx_break"/>Answer: 3</span>
</span></foreignobject></g></g></svg>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Sub-Task Performance of BBH</h2>
<figure class="ltx_table" id="A3.T10">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T10.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T10.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A3.T10.1.1.1.1">Sub Task</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A3.T10.1.1.1.2">CoT</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A3.T10.1.1.1.3">PoT</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A3.T10.1.1.1.4"><span class="ltx_ERROR undefined" id="A3.T10.1.1.1.4.1">\method</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T10.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.1.2.1.1">object counting</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.1.2.1.2">94.4</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.1.2.1.3">98.0</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.1.2.1.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.2.1.4.1">98.0</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.3.2">
<td class="ltx_td ltx_align_left" id="A3.T10.1.3.2.1">temporal sequences</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.3.2.2">96.8</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.3.2.3">83.6</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.3.2.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.3.2.4.1">97.2</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.4.3">
<td class="ltx_td ltx_align_left" id="A3.T10.1.4.3.1">tracking shuffled objects five objects</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.4.3.2">95.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.4.3.3">78.8</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.4.3.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.4.3.4.1">96.4</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.5.4">
<td class="ltx_td ltx_align_left" id="A3.T10.1.5.4.1">word sorting</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.5.4.2">50.8</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.5.4.3">98.0</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.5.4.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.5.4.4.1">98.0</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.6.5">
<td class="ltx_td ltx_align_left" id="A3.T10.1.6.5.1">salient translation error detection</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.6.5.2">61.6</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.6.5.3">59.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.6.5.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.6.5.4.1">62.6</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.7.6">
<td class="ltx_td ltx_align_left" id="A3.T10.1.7.6.1">penguins in a table</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.7.6.2">71.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.7.6.3">54.8</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.7.6.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.7.6.4.1">73.3</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.8.7">
<td class="ltx_td ltx_align_left" id="A3.T10.1.8.7.1">snarks</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.8.7.2">83.1</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.8.7.3">69.1</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.8.7.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.8.7.4.1">83.3</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.9.8">
<td class="ltx_td ltx_align_left" id="A3.T10.1.9.8.1">ruin names</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.9.8.2">81.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.9.8.3">80.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.9.8.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.9.8.4.1">81.2</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.10.9">
<td class="ltx_td ltx_align_left" id="A3.T10.1.10.9.1">web of lies</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.10.9.2">91.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.10.9.3">59.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.10.9.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.10.9.4.1">92.0</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.11.10">
<td class="ltx_td ltx_align_left" id="A3.T10.1.11.10.1">navigate</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.11.10.2">96.4</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.11.10.3">90.4</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.11.10.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.11.10.4.1">96.8</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.12.11">
<td class="ltx_td ltx_align_left" id="A3.T10.1.12.11.1">date understanding</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.12.11.2"><span class="ltx_text ltx_font_bold" id="A3.T10.1.12.11.2.1">80.8</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.12.11.3">52.8</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.12.11.4">76.4</td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.13.12">
<td class="ltx_td ltx_align_left" id="A3.T10.1.13.12.1">hyperbaton</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.13.12.2"><span class="ltx_text ltx_font_bold" id="A3.T10.1.13.12.2.1">92.0</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.13.12.3">67.6</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.13.12.4">91.0</td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.14.13">
<td class="ltx_td ltx_align_left" id="A3.T10.1.14.13.1">dyck languages</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.14.13.2">38.0</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.14.13.3">42.4</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.14.13.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.14.13.4.1">54.4</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.15.14">
<td class="ltx_td ltx_align_left" id="A3.T10.1.15.14.1">tracking shuffled objects three objects</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.15.14.2">99.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.15.14.3">89.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.15.14.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.15.14.4.1">99.2</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.16.15">
<td class="ltx_td ltx_align_left" id="A3.T10.1.16.15.1">formal fallacies</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.16.15.2">82.0</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.16.15.3">74.4</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.16.15.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.16.15.4.1">82.0</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.17.16">
<td class="ltx_td ltx_align_left" id="A3.T10.1.17.16.1">tracking shuffled objects seven objects</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.17.16.2">91.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.17.16.3">73.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.17.16.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.17.16.4.1">92.8</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.18.17">
<td class="ltx_td ltx_align_left" id="A3.T10.1.18.17.1">causal judgement</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.18.17.2"><span class="ltx_text ltx_font_bold" id="A3.T10.1.18.17.2.1">62.6</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.18.17.3">62.6</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.18.17.4">62.0</td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.19.18">
<td class="ltx_td ltx_align_left" id="A3.T10.1.19.18.1">sports understanding</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.19.18.2">85.6</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.19.18.3">74.8</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.19.18.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.19.18.4.1">87.6</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.20.19">
<td class="ltx_td ltx_align_left" id="A3.T10.1.20.19.1">logical deduction five objects</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.20.19.2">85.6</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.20.19.3">80.4</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.20.19.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.20.19.4.1">88.8</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.21.20">
<td class="ltx_td ltx_align_left" id="A3.T10.1.21.20.1">movie recommendation</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.21.20.2">62.0</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.21.20.3">56.0</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.21.20.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.21.20.4.1">62.8</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.22.21">
<td class="ltx_td ltx_align_left" id="A3.T10.1.22.21.1">logical deduction three objects</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.22.21.2">99.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.22.21.3">96.4</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.22.21.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.22.21.4.1">99.2</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.23.22">
<td class="ltx_td ltx_align_left" id="A3.T10.1.23.22.1">multistep arithmetic two</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.23.22.2">98.0</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.23.22.3">100.0</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.23.22.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.23.22.4.1">100.0</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.24.23">
<td class="ltx_td ltx_align_left" id="A3.T10.1.24.23.1">boolean expressions</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.24.23.2">99.2</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.24.23.3">96.8</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.24.23.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.24.23.4.1">99.2</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.25.24">
<td class="ltx_td ltx_align_left" id="A3.T10.1.25.24.1">geometric shapes</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.25.24.2">56.4</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.25.24.3">65.6</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.25.24.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.25.24.4.1">78.8</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.26.25">
<td class="ltx_td ltx_align_left" id="A3.T10.1.26.25.1">disambiguation qa</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.26.25.2">42.8</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.26.25.3">40.8</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.26.25.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.26.25.4.1">45.6</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.27.26">
<td class="ltx_td ltx_align_left" id="A3.T10.1.27.26.1">logical deduction seven objects</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.27.26.2">76.8</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.27.26.3">71.6</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.27.26.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.27.26.4.1">82.0</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.28.27">
<td class="ltx_td ltx_align_left" id="A3.T10.1.28.27.1">reasoning about colored objects</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.28.27.2">87.6</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.28.27.3">66.0</td>
<td class="ltx_td ltx_align_left" id="A3.T10.1.28.27.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.28.27.4.1">87.6</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.29.28">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T10.1.29.28.1"><span class="ltx_text ltx_font_bold" id="A3.T10.1.29.28.1.1">Average</span></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T10.1.29.28.2">80.3</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T10.1.29.28.3">73.9</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T10.1.29.28.4"><span class="ltx_text ltx_font_bold" id="A3.T10.1.29.28.4.1">84.2</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>Results of BBH sub-tasks.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03864v1#A3.T10" title="Table 10 ‣ Appendix C Sub-Task Performance of BBH ‣ \method: Learning to Reason Dynamically in LLMs via Optimal Reasoning Trajectories Search"><span class="ltx_text ltx_ref_tag">10</span></a> shows the results of BBH sub-tasks of GPT-4o-mini as task-solving LLM and our tuned Llama-3-8B-instruct as the planner. From the table, we can see that our planner has learned to select appropriate actions based on the task. For instance, in the word sorting task, our model consistently uses code to solve the problem. Additionally, for the Dyck languages task, our method outperforms both CoT and PoT. This is because the task is easy to verify, and our model proactively requests GPT-4o-mini to verify the answer, thereby improving performance. The only exception is the date understanding task. Upon analysis, we found that while code could solve this type of problem using Python’s “datetime” library, it often fails to follow the required output format. This leads to lower accuracy in our method’s prediction when choosing writing a program as the reasoning action.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Prompts Used in Experiments</h2>
<div class="ltx_para ltx_noindent" id="A4.p1">
<svg class="ltx_picture" height="95.21" id="A4.p1.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,95.21) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 89.3 C 0 92.57 2.64 95.21 5.91 95.21 L 594.09 95.21 C 597.36 95.21 600 92.57 600 89.3 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 71.1 L 598.03 71.1 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 77)"><foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p1.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p1.pic1.1.1.1.1.1.1">Prompt for query rewrite module</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="45.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p1.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p1.pic1.2.2.2.1.1.1">In this step, you need to reveal the Core Question with only a simple sentence and useful information. The output follows the format:</span>
<span class="ltx_p" id="A4.p1.pic1.2.2.2.1.1.2">core question:…</span>
<span class="ltx_p" id="A4.p1.pic1.2.2.2.1.1.3">Note: Please extract the question-solving information related to the problem, and list them one by one.</span>
<span class="ltx_p" id="A4.p1.pic1.2.2.2.1.1.4">useful information:…</span>
</span></foreignobject></g></g></svg>
</div>
<div class="ltx_para ltx_noindent" id="A4.p2">
<svg class="ltx_picture" height="95.21" id="A4.p2.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,95.21) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 89.3 C 0 92.57 2.64 95.21 5.91 95.21 L 594.09 95.21 C 597.36 95.21 600 92.57 600 89.3 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 71.1 L 598.03 71.1 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 77)"><foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p2.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p2.pic1.1.1.1.1.1.1">Prompt for query decomposition module</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="45.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p2.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p2.pic1.2.2.2.1.1.1">In this step, you need to reflect on the problem, and describe it in your own words. Analyze how you can decompose the problem into smaller, more manageable sub-tasks. Pay attention to small details, nuances, notes and examples in the problem description.</span>
</span></foreignobject></g></g></svg>
</div>
<div class="ltx_para ltx_noindent" id="A4.p3">
<svg class="ltx_picture" height="72.26" id="A4.p3.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,72.26) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 66.36 C 0 69.62 2.64 72.26 5.91 72.26 L 594.09 72.26 C 597.36 72.26 600 69.62 600 66.36 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 48.15 L 598.03 48.15 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 54.06)"><foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p3.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p3.pic1.1.1.1.1.1.1">Prompt for CoT module</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="22.56" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p3.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p3.pic1.2.2.2.1.1.1">In this step, you need to think step by step with words, solve the problem and get the answer.</span>
</span></foreignobject></g></g></svg>
</div>
<div class="ltx_para ltx_noindent" id="A4.p4">
<svg class="ltx_picture" height="179.77" id="A4.p4.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,179.77) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 173.86 C 0 177.12 2.64 179.77 5.91 179.77 L 594.09 179.77 C 597.36 179.77 600 177.12 600 173.86 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 155.66 L 598.03 155.66 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 161.56)"><foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p4.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p4.pic1.1.1.1.1.1.1">Prompt for PoT module</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="130.07" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p4.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p4.pic1.2.2.2.1.1.1">In this step, you need to write Python codes to solve the query. Use the simplest and most straightforward programming methods to solve the problem. For instance, if a query can be efficiently solved using a brute force method, prefer it over heuristic or more complex methods. Utilize any available and commonly-used libraries that can simplify the task or improve code maintainability. All the calculations must leverage codes. Print out the results with the print() function. Before executing the program, you have no idea of the final answer. Don’t show it in your comment or code. And don’t use the plot function.</span>
<span class="ltx_p" id="A4.p4.pic1.2.2.2.1.1.2">In this step, start with “# Now write Python codes to answer this question and use <span class="ltx_text" id="A4.p4.pic1.2.2.2.1.1.2.1">print()</span> to print out the result”</span>
</span></foreignobject></g></g></svg>
</div>
<div class="ltx_para ltx_noindent" id="A4.p5">
<svg class="ltx_picture" height="125.73" id="A4.p5.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,125.73) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 119.82 C 0 123.08 2.64 125.73 5.91 125.73 L 594.09 125.73 C 597.36 125.73 600 123.08 600 119.82 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 101.62 L 598.03 101.62 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 107.52)"><foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p5.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p5.pic1.1.1.1.1.1.1">Prompt for self-verification module</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="76.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p5.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p5.pic1.2.2.2.1.1.1">In this step, you need to carefully verify the correctness of the previous thoughts with natural language. You need to formulate a verification question (not the same question as before) based on the final answer and then verify the final answer you have. If the results are incorrect, the last line should end up with “The answer is: incorrect”. Otherwise, the last line should end with “The answer is: correct”</span>
</span></foreignobject></g></g></svg>
</div>
<div class="ltx_para ltx_noindent" id="A4.p6">
<svg class="ltx_picture" height="277.86" id="A4.p6.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,277.86) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 271.95 C 0 275.21 2.64 277.86 5.91 277.86 L 594.09 277.86 C 597.36 277.86 600 275.21 600 271.95 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 253.75 L 598.03 253.75 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 259.65)"><foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p6.pic1.4.4.4.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A4.p6.pic1.4.4.4.1.1.1">Prompt for explanation generation</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="228.16" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3" style="width:402.3pt;">
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.4"><span class="ltx_text ltx_font_bold" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.4.1">Action Categories</span>:</span>
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.5">1. Understanding process:
query rewriting: Rewrite the question and answer it.
Decomposition: Decompose the questions into multiple subtasks to solve the sub-question.
2. Solving process:
chain of thought: For step-by-step reasoning with language.
programming: For programming solver.
3. Verification process:
self-verification: To check the correctness of the solution.</span>
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.6"><span class="ltx_text ltx_font_bold" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.6.1">Task Instruction</span>: For the given question, explain why the above Required actions are necessary.</span>
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.7"><span class="ltx_text ltx_font_bold" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.7.1">Example 1:</span></span>
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3">Query: 
Find <math alttext="2\cdot 5^{{-1}}+8\cdot 11^{{-1}}\pmod{{56}}" class="ltx_Math" display="inline" id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2"><semantics id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2a"><mrow id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.cmml"><mrow id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.cmml"><mrow id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.cmml"><mn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.2" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.2.cmml">2</mn><mo id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.1.cmml">⋅</mo><msup id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.cmml"><mn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.2" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.2.cmml">5</mn><mrow id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3.cmml"><mo id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3a" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3.cmml">−</mo><mn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3.2" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3.2.cmml">1</mn></mrow></msup></mrow><mo id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.1" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.1.cmml">+</mo><mrow id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.cmml"><mn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.2" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.2.cmml">8</mn><mo id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.1.cmml">⋅</mo><msup id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.cmml"><mn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.2" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.2.cmml">11</mn><mrow id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3.cmml"><mo id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3a" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3.cmml">−</mo><mn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3.2" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3.2.cmml">1</mn></mrow></msup></mrow></mrow><mspace id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3a" width="0.949em" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.cmml"></mspace><mrow id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.3.cmml"><mo id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2.2" stretchy="false" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.3.1.cmml">(</mo><mrow id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2.1" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.3.cmml"><mo id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2.1.1" lspace="0em" rspace="0.167em" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.3.1.cmml">mod</mo><mn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml">56</mn></mrow><mo id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2.3" stretchy="false" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2b"><apply id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3"><csymbol cd="latexml" id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.1.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3">annotated</csymbol><apply id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2"><plus id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.1.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.1"></plus><apply id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2"><ci id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.1.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.1">⋅</ci><cn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.2.cmml" type="integer" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.2">2</cn><apply id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3"><csymbol cd="ambiguous" id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.1.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3">superscript</csymbol><cn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.2.cmml" type="integer" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.2">5</cn><apply id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3"><minus id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3.1.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3"></minus><cn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3.2.cmml" type="integer" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.2.3.3.2">1</cn></apply></apply></apply><apply id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3"><ci id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.1.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.1">⋅</ci><cn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.2.cmml" type="integer" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.2">8</cn><apply id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3"><csymbol cd="ambiguous" id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.1.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3">superscript</csymbol><cn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.2.cmml" type="integer" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.2">11</cn><apply id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3"><minus id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3.1.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3"></minus><cn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3.2.cmml" type="integer" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.3.2.3.3.3.2">1</cn></apply></apply></apply></apply><apply id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.3.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2"><ci id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.3.1.cmml" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.2.2.2">pmod</ci><cn id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" type="integer" xref="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1">56</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2c">2\cdot 5^{{-1}}+8\cdot 11^{{-1}}\pmod{{56}}</annotation><annotation encoding="application/x-llamapun" id="A4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2d">2 ⋅ 5 start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT + 8 ⋅ 11 start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT start_MODIFIER ( roman_mod start_ARG 56 end_ARG ) end_MODIFIER</annotation></semantics></math>. Express your answer as an integer from <math alttext="0" class="ltx_Math" display="inline" id="A4.p6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1"><semantics id="A4.p6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1a"><mn id="A4.p6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1" xref="A4.p6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A4.p6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1b"><cn id="A4.p6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml" type="integer" xref="A4.p6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.m2.1.1">0</cn></annotation-xml></semantics></math> to <math alttext="55" class="ltx_Math" display="inline" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1"><semantics id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1a"><mn id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1" xref="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1.cmml">55</mn><annotation-xml encoding="MathML-Content" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1b"><cn id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1.cmml" type="integer" xref="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1.1">55</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1c">55</annotation><annotation encoding="application/x-llamapun" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.m3.1d">55</annotation></semantics></math>, inclusive.</span>
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.8">Required Action: programming, self-verification</span>
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.9">Explanation:
This is a Modular arithmetic problem.
The problem can be solved using straightforward python code with sympy library, particularly modular arithmetic. Besides, this type of problem is relatively easy to verify. After computing the result, one can check the calculations step by step to ensure correctness and verify that the final answer is within the given range (0 to 55 inclusive). Programming solver is more efficient and accurate for this type of calculation and the verifier ensures the correctness of the result and adherence to the given constraints.</span>
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.10">…
<span class="ltx_text ltx_font_bold" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.10.1">(multiple examples)</span></span>
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.11">Query: Given Query</span>
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.12">Required Action: Actions After Searching</span>
<span class="ltx_p" id="A4.p6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.13">Explanation:</span>
</span></foreignobject></g></g></svg>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 18:54:59 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
