<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2306.04834] A Semi-supervised Object Detection Algorithm for Underwater Imagery</title><meta property="og:description" content="Detection of artificial objects from underwater imagery gathered by Autonomous Underwater Vehicles (AUVs) is a key requirement for many subsea applications. Real-world AUV image datasets tend to be very large and unlab…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A Semi-supervised Object Detection Algorithm for Underwater Imagery">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="A Semi-supervised Object Detection Algorithm for Underwater Imagery">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2306.04834">

<!--Generated on Mon Feb 26 22:49:01 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">A Semi-supervised Object Detection Algorithm for Underwater Imagery
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Suraj Bijjahalli<sup id="id6.6.id1" class="ltx_sup"><span id="id6.6.id1.1" class="ltx_text ltx_font_italic">1</span></sup>,Oscar Pizarro<sup id="id7.7.id2" class="ltx_sup"><span id="id7.7.id2.1" class="ltx_text ltx_font_italic">1,2</span></sup>, and Stefan B. Williams<sup id="id8.8.id3" class="ltx_sup"><span id="id8.8.id3.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes"><sup id="id9.9.id1" class="ltx_sup"><span id="id9.9.id1.1" class="ltx_text ltx_font_italic">1</span></sup>The authors are with the Australian Centre for Field Robotics, University of Sydney, NSW Australia
<span id="id10.10.id2" class="ltx_text ltx_font_typewriter" style="font-size:90%;">(s.bijjahalli, o.pizarro, stefanw)@acfr.usyd.edu.au</span><sup id="id11.11.id1" class="ltx_sup"><span id="id11.11.id1.1" class="ltx_text ltx_font_italic">2</span></sup>O. Pizarro is also with the Marine Technology Department, Norwegian University of Science and Technology, Trondheim, Norway*The research for this paper received funding from the Australian Government through Trusted Autonomous Systems, a Defence Cooperative Research Centre funded through the Next Generation Technologies Fund.The authors also thank Thales Australia for supporting this work.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id12.id1" class="ltx_p">Detection of artificial objects from underwater imagery gathered by Autonomous Underwater Vehicles (AUVs) is a key requirement for many subsea applications. Real-world AUV image datasets tend to be very large and unlabelled. Furthermore, such datasets are typically imbalanced, containing few instances of objects of interest, particularly when searching for unusual objects in a scene. It is therefore, difficult to fit models capable of reliably detecting these objects. Given these factors, we propose to treat artificial objects as anomalies and detect them through a semi-supervised framework based on Variational Autoencoders (VAEs). We develop a method which clusters image data in a learned low-dimensional latent space and extracts images that are likely to contain anomalous features. We also devise an anomaly score based on extracting poorly reconstructed regions of an image. We demonstrate that by applying both methods on large image datasets, human operators can be shown candidate anomalous samples with a low false positive rate to identify objects of interest. We apply our approach to real seafloor imagery gathered by an AUV and evaluate its sensitivity to the dimensionality of the latent representation used by the VAE. We evaluate the precision-recall tradeoff and demonstrate that by choosing an appropriate latent dimensionality and threshold, we are able to achieve an average precision of 0.64 on unlabelled datasets.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">INTRODUCTION</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Detection and localization of artificial underwater objects in optical imagery captured by Autonomous Underwater Vehicles (AUVs) is a key requirement for many industrial, scientific and defence applications. Missions conducted by AUVs generate a large volume of imagery, which makes it impractical for human operators to visually inspect and isolate a sparse set of artificial objects during the post-mission phase.
There is therefore a need for a robust and efficient automated vision-based method for detecting artificial objects in a variety of benthic habitats. Most underwater object detection algorithms are largely derived from traditional pattern recognition methods. In most of these methods, the properties of the object are known beforehand, and it is assumed that datasets with ground-truth labels can be sourced to train a classifier. With the advent of deep learning, features can be learned rather than crafted by hand. However, most deep learning algorithms rely on the availability of large, well-balanced and labelled datasets. This type of supervised pipeline presents the following problems: (1) hand-labelling of large-scale image datasets is time-consuming, cumbersome and prone to error; (2) Underwater datasets with artificial objects tend to be highly imbalanced i.e., a small fraction of images contain artificial objects, with the bulk of the images corresponding to naturally occurring features. If the primary aim is not to explicitly predict a single, specific class out of several possible classes, but more broadly to separate artificial objects from naturally occurring features, the characteristics of this problem are better suited to an unsupervised or semi-supervised anomaly detection framework. In this paper, we focus on using autoencoders to detect a minority class (anomalous images containing artificial objects) from a large unlabelled database comprising mostly the majority class (natural images). Autoencoders are essentially unsupervised generative models. Once trained, the encoder component of an autoencoder can be used as an unsupervised feature extractor for seafloor imagery <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx12" title="" class="ltx_ref">12</a>, <a href="#bib.bibx6" title="" class="ltx_ref">6</a>]</cite>, which can outperform handcrafted features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx18" title="" class="ltx_ref">18</a>]</cite>. Autoencoders have previously been used for underwater anomaly detection as well <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx21" title="" class="ltx_ref">21</a>]</cite>. However, most approaches focus on the use of the L2 loss (reconstruction error) as a detection metric - The underlying assumption is that anomalous data which is sparsely observed or completely absent from the training dataset cannot be reconstructed accurately when observed in the field.
In our proposed approach, we choose to avoid relying solely on reconstruction loss. We additionally make use of the latent space of the autoencoder in which anomalous images are separable through a clustering-based method. We base our approach on Variational Autoencoders (VAE), a probabilistic extension of autoencoders with greater flexibility and control over the distribution of the latent space.
We make the following primary contributions:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Development of a VAE model that can reconstruct seafloor imagery;</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Investigation of a clustering method to reduce large datasets to a smaller subspace for aiding anomaly detection;</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Investigation of L2 loss as an anomaly detection metric, and the development of a novel Region Of Interest (ROI) detection metric;</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Analysis of detection/false alarm rate sensitivity to latent vector dimensionality;</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2306.04834/assets/anomaly_system_overview.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="419" height="255" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">System overview - Images captured by an AUV are passed as inputs to a trained VAE. Low density regions of the latent space are extracted and further queried using an anomaly map obtained from the VAE reconstruction error.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">The remainder of this paper is structured as follows: Section <a href="#S2" title="II Related work ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> summarizes related work and highlights some of the key research gaps in this domain; Section <a href="#S3" title="III Method ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> presents an overview of our proposed method, followed by a brief description of the foundation of VAEs in Section <a href="#S4" title="IV Variational Autoencoder ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>. We briefly describe the datasets we use and our training pipelines in Section <a href="#S5" title="V Datasets ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>. In Section <a href="#S6" title="VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>, we show the shortcomings behind using L2 reconstruction loss as an anomaly detection metric before presenting our proposed metrics.
We demonstrate the performance of our proposed method in Section <a href="#S7" title="VII RESULTS ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>, along with a sensitivity analysis of performance against model capacity.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">A broad survey of deep learning-based underwater object detection algorithms can be found in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx16" title="" class="ltx_ref">16</a>]</cite>. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx19" title="" class="ltx_ref">19</a>]</cite>, a transfer learning approach is employed, where a pre-trained object detection model is repurposed by means of a synthetically generated dataset. Outside the underwater domain, anomaly detection in images using autoencoders is well-researched, and several approaches can be adopted to our application. Each image is essentially assigned an anomaly score, which is thresholded to flag anomalies. Most anomaly scores are typically based on reconstruction error <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx5" title="" class="ltx_ref">5</a>, <a href="#bib.bibx2" title="" class="ltx_ref">2</a>]</cite>. More specifically, the L2 loss between the input image and the model reconstruction is used as an anomaly score. The underlying assumption is that the L2 loss is small for in-distribution images and large for out-of-distribution images. As we show in <a href="#S6" title="VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>, this assumption rarely holds true for images gathered in the field in practice. Depending on the choice of model architecture and capacity, it is possible for the model to reconstruct the anomaly even though it has only been trained on in-distribution samples <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx7" title="" class="ltx_ref">7</a>]</cite>. To address this problem, in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx8" title="" class="ltx_ref">8</a>]</cite>, a transformation is first applied to the image, and then the model is trained to reconstruct the untransformed image. This forces the model to learn the high-level visual semantic features of in-distribution images. Apart from reconstruction error, anomaly scores can be obtained based on restoration error <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx3" title="" class="ltx_ref">3</a>]</cite> or latent space distances <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx20" title="" class="ltx_ref">20</a>, <a href="#bib.bibx11" title="" class="ltx_ref">11</a>, <a href="#bib.bibx1" title="" class="ltx_ref">1</a>]</cite>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Method</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.6" class="ltx_p">We design our methodology to flag and extract anomalous samples from AUV-gathered imagery datasets in a semi-supervised fashion. To make our terminology consistent within this paper, we use the terms outlier and anomalous images interchangeably to refer to images of the seafloor with artificial objects in them.
Our method makes the following assumptions: (1) An existing database of inlier images is available to train a VAE. This assumption is well justified, since most imagery from AUV missions contains a large number of inlier images with few (if any) anomalies; (2) The size of the anomalous object to be detected is approximately (upper and lower size bounds) known;(3) The intrinsic and extrinsic parameters of the camera are known. This is so that we can estimate the angular Field of View(FOV) of the camera and translate the object size bounds (in squared metres) to pixel area bounds on the images;(4) We also assume that anomalous samples are likely to gather in the low density regions of the VAE latent space. We justify this assumption in sections <a href="#S6.SS3" title="VI-C Latent space clustering ‣ VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-C</span></span></a> and <a href="#S7" title="VII RESULTS ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>, where we demonstrate this experimentally. The high-level architecture of our system is illustrated in Fig. <a href="#S1.F1" title="Figure 1 ‣ I INTRODUCTION ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Our proposed method is centred on the use of a VAE trained entirely on inlier images i.e., images that do not contain an anomaly. We forward-propagate each image gathered from the AUV mission through our trained VAE. The encoder extracts features from the image and downsamples it through a series of convolutions which compress the input image to a low-dimensional latent vector <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">z</annotation></semantics></math>. The decoder is a generative model that attempts to reconstruct the input image from <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">z</annotation></semantics></math>, which in turn is the output of a sampling process. The encoder essentially learns a distribution (assumed to be Gaussian in our case). The feature maps in the final layer of the encoder are flattened into two vectors (<math id="S3.p1.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">d</annotation></semantics></math>x1 dimensions) corresponding to a mean (<math id="S3.p1.4.m4.1" class="ltx_Math" alttext="\mu_{z}" display="inline"><semantics id="S3.p1.4.m4.1a"><msub id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">μ</mi><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝜇</ci><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\mu_{z}</annotation></semantics></math>) and standard deviation (<math id="S3.p1.5.m5.1" class="ltx_Math" alttext="\sigma_{z}" display="inline"><semantics id="S3.p1.5.m5.1a"><msub id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">σ</mi><mi id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝜎</ci><ci id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\sigma_{z}</annotation></semantics></math>). The latent vector is then sampled from this multi-dimensional Gaussian, and serves as a <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">d</annotation></semantics></math>-dimensional representation of the input image. The decoder receives as input the latent embedding of the input image and then reconstructs it through a series of transpose convolutional operations. The pixel-wise difference between the reconstructed image and the input image is computed to generate an anomaly heatmap. We extract regions of interest (ROI) from the anomaly heatmap. Given estimates of the camera FOV and the altitude from the seafloor, we then extract only the ROIs that conform to the expected size bounds of the anomaly. Moments of the extracted ROIs are then used as an additional feature to separate inlier images from anomalous ones. In parallel, we apply Kernel Density Esimation (KDE) to estimate the density of the latent space (see Sec. <a href="#S6.SS3" title="VI-C Latent space clustering ‣ VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-C</span></span></a>). KDE performance is known to worsen exponentially with high dimensional data sets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx14" title="" class="ltx_ref">14</a>]</cite>. To overcome this problem, we further reduce the dimensionality of the latent vectors. The low-density subspace of this reduced feature set is then extracted. As we demonstrate in sections <a href="#S6.SS3" title="VI-C Latent space clustering ‣ VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-C</span></span></a> and <a href="#S7" title="VII RESULTS ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>, this subspace has a high probability of containing the anomalous images within the dataset. To reduce the number of false-positives within this extracted subspace, we further apply a threshold to the statistical moments of the ROIs obtained from the anomaly heatmaps in the previous step. We show in Sec. <a href="#S7" title="VII RESULTS ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a> that this dual approach involving density estimation and reconstruction error greatly reduces the number of false positives.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Variational Autoencoder</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.8" class="ltx_p">VAEs are essentially generative models based on a probabilistic formulation of conventional autoencoders. We present a high-level overview of the mathematical foundation of VAEs, which were originally introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx9" title="" class="ltx_ref">9</a>]</cite>. A VAE defines a model of the form:</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.4" class="ltx_Math" alttext="p_{\boldsymbol{\theta}}(\boldsymbol{z},\boldsymbol{x})=p_{\boldsymbol{\theta}}(\boldsymbol{z})p_{\boldsymbol{\theta}}(\boldsymbol{x}\mid\boldsymbol{z})" display="block"><semantics id="S4.E1.m1.4a"><mrow id="S4.E1.m1.4.4" xref="S4.E1.m1.4.4.cmml"><mrow id="S4.E1.m1.4.4.3" xref="S4.E1.m1.4.4.3.cmml"><msub id="S4.E1.m1.4.4.3.2" xref="S4.E1.m1.4.4.3.2.cmml"><mi id="S4.E1.m1.4.4.3.2.2" xref="S4.E1.m1.4.4.3.2.2.cmml">p</mi><mi id="S4.E1.m1.4.4.3.2.3" xref="S4.E1.m1.4.4.3.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.3.1" xref="S4.E1.m1.4.4.3.1.cmml">​</mo><mrow id="S4.E1.m1.4.4.3.3.2" xref="S4.E1.m1.4.4.3.3.1.cmml"><mo stretchy="false" id="S4.E1.m1.4.4.3.3.2.1" xref="S4.E1.m1.4.4.3.3.1.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">𝒛</mi><mo id="S4.E1.m1.4.4.3.3.2.2" xref="S4.E1.m1.4.4.3.3.1.cmml">,</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">𝒙</mi><mo stretchy="false" id="S4.E1.m1.4.4.3.3.2.3" xref="S4.E1.m1.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.4.4.2" xref="S4.E1.m1.4.4.2.cmml">=</mo><mrow id="S4.E1.m1.4.4.1" xref="S4.E1.m1.4.4.1.cmml"><msub id="S4.E1.m1.4.4.1.3" xref="S4.E1.m1.4.4.1.3.cmml"><mi id="S4.E1.m1.4.4.1.3.2" xref="S4.E1.m1.4.4.1.3.2.cmml">p</mi><mi id="S4.E1.m1.4.4.1.3.3" xref="S4.E1.m1.4.4.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.1.2" xref="S4.E1.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E1.m1.4.4.1.4.2" xref="S4.E1.m1.4.4.1.cmml"><mo stretchy="false" id="S4.E1.m1.4.4.1.4.2.1" xref="S4.E1.m1.4.4.1.cmml">(</mo><mi id="S4.E1.m1.3.3" xref="S4.E1.m1.3.3.cmml">𝒛</mi><mo stretchy="false" id="S4.E1.m1.4.4.1.4.2.2" xref="S4.E1.m1.4.4.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.1.2a" xref="S4.E1.m1.4.4.1.2.cmml">​</mo><msub id="S4.E1.m1.4.4.1.5" xref="S4.E1.m1.4.4.1.5.cmml"><mi id="S4.E1.m1.4.4.1.5.2" xref="S4.E1.m1.4.4.1.5.2.cmml">p</mi><mi id="S4.E1.m1.4.4.1.5.3" xref="S4.E1.m1.4.4.1.5.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.1.2b" xref="S4.E1.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E1.m1.4.4.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.4.4.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.4.4.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.cmml"><mi id="S4.E1.m1.4.4.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.2.cmml">𝒙</mi><mo id="S4.E1.m1.4.4.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.cmml">∣</mo><mi id="S4.E1.m1.4.4.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.3.cmml">𝒛</mi></mrow><mo stretchy="false" id="S4.E1.m1.4.4.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.4b"><apply id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4"><eq id="S4.E1.m1.4.4.2.cmml" xref="S4.E1.m1.4.4.2"></eq><apply id="S4.E1.m1.4.4.3.cmml" xref="S4.E1.m1.4.4.3"><times id="S4.E1.m1.4.4.3.1.cmml" xref="S4.E1.m1.4.4.3.1"></times><apply id="S4.E1.m1.4.4.3.2.cmml" xref="S4.E1.m1.4.4.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.3.2.1.cmml" xref="S4.E1.m1.4.4.3.2">subscript</csymbol><ci id="S4.E1.m1.4.4.3.2.2.cmml" xref="S4.E1.m1.4.4.3.2.2">𝑝</ci><ci id="S4.E1.m1.4.4.3.2.3.cmml" xref="S4.E1.m1.4.4.3.2.3">𝜽</ci></apply><interval closure="open" id="S4.E1.m1.4.4.3.3.1.cmml" xref="S4.E1.m1.4.4.3.3.2"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝒛</ci><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝒙</ci></interval></apply><apply id="S4.E1.m1.4.4.1.cmml" xref="S4.E1.m1.4.4.1"><times id="S4.E1.m1.4.4.1.2.cmml" xref="S4.E1.m1.4.4.1.2"></times><apply id="S4.E1.m1.4.4.1.3.cmml" xref="S4.E1.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.3.1.cmml" xref="S4.E1.m1.4.4.1.3">subscript</csymbol><ci id="S4.E1.m1.4.4.1.3.2.cmml" xref="S4.E1.m1.4.4.1.3.2">𝑝</ci><ci id="S4.E1.m1.4.4.1.3.3.cmml" xref="S4.E1.m1.4.4.1.3.3">𝜽</ci></apply><ci id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">𝒛</ci><apply id="S4.E1.m1.4.4.1.5.cmml" xref="S4.E1.m1.4.4.1.5"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.5.1.cmml" xref="S4.E1.m1.4.4.1.5">subscript</csymbol><ci id="S4.E1.m1.4.4.1.5.2.cmml" xref="S4.E1.m1.4.4.1.5.2">𝑝</ci><ci id="S4.E1.m1.4.4.1.5.3.cmml" xref="S4.E1.m1.4.4.1.5.3">𝜽</ci></apply><apply id="S4.E1.m1.4.4.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.4.4.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1">conditional</csymbol><ci id="S4.E1.m1.4.4.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.2">𝒙</ci><ci id="S4.E1.m1.4.4.1.1.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3">𝒛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.4c">p_{\boldsymbol{\theta}}(\boldsymbol{z},\boldsymbol{x})=p_{\boldsymbol{\theta}}(\boldsymbol{z})p_{\boldsymbol{\theta}}(\boldsymbol{x}\mid\boldsymbol{z})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.p1.6" class="ltx_p">where <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{z}" display="inline"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\boldsymbol{z}</annotation></semantics></math> is a latent representation of the input images <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="\boldsymbol{x}" display="inline"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">\boldsymbol{x}</annotation></semantics></math>. <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="p_{\boldsymbol{\theta}}(\boldsymbol{z})" display="inline"><semantics id="S4.p1.3.m3.1a"><mrow id="S4.p1.3.m3.1.2" xref="S4.p1.3.m3.1.2.cmml"><msub id="S4.p1.3.m3.1.2.2" xref="S4.p1.3.m3.1.2.2.cmml"><mi id="S4.p1.3.m3.1.2.2.2" xref="S4.p1.3.m3.1.2.2.2.cmml">p</mi><mi id="S4.p1.3.m3.1.2.2.3" xref="S4.p1.3.m3.1.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.p1.3.m3.1.2.1" xref="S4.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S4.p1.3.m3.1.2.3.2" xref="S4.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S4.p1.3.m3.1.2.3.2.1" xref="S4.p1.3.m3.1.2.cmml">(</mo><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">𝒛</mi><mo stretchy="false" id="S4.p1.3.m3.1.2.3.2.2" xref="S4.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.2.cmml" xref="S4.p1.3.m3.1.2"><times id="S4.p1.3.m3.1.2.1.cmml" xref="S4.p1.3.m3.1.2.1"></times><apply id="S4.p1.3.m3.1.2.2.cmml" xref="S4.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.2.2.1.cmml" xref="S4.p1.3.m3.1.2.2">subscript</csymbol><ci id="S4.p1.3.m3.1.2.2.2.cmml" xref="S4.p1.3.m3.1.2.2.2">𝑝</ci><ci id="S4.p1.3.m3.1.2.2.3.cmml" xref="S4.p1.3.m3.1.2.2.3">𝜽</ci></apply><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">p_{\boldsymbol{\theta}}(\boldsymbol{z})</annotation></semantics></math> is the prior over <math id="S4.p1.4.m4.1" class="ltx_Math" alttext="\boldsymbol{z}" display="inline"><semantics id="S4.p1.4.m4.1a"><mi id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><ci id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">\boldsymbol{z}</annotation></semantics></math>, chosen to be Gaussian.
<math id="S4.p1.5.m5.1" class="ltx_Math" alttext="p_{\boldsymbol{\theta}}(\boldsymbol{x}\mid\boldsymbol{z})" display="inline"><semantics id="S4.p1.5.m5.1a"><mrow id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml"><msub id="S4.p1.5.m5.1.1.3" xref="S4.p1.5.m5.1.1.3.cmml"><mi id="S4.p1.5.m5.1.1.3.2" xref="S4.p1.5.m5.1.1.3.2.cmml">p</mi><mi id="S4.p1.5.m5.1.1.3.3" xref="S4.p1.5.m5.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.p1.5.m5.1.1.2" xref="S4.p1.5.m5.1.1.2.cmml">​</mo><mrow id="S4.p1.5.m5.1.1.1.1" xref="S4.p1.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p1.5.m5.1.1.1.1.2" xref="S4.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S4.p1.5.m5.1.1.1.1.1" xref="S4.p1.5.m5.1.1.1.1.1.cmml"><mi id="S4.p1.5.m5.1.1.1.1.1.2" xref="S4.p1.5.m5.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S4.p1.5.m5.1.1.1.1.1.1" xref="S4.p1.5.m5.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.p1.5.m5.1.1.1.1.1.3" xref="S4.p1.5.m5.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo stretchy="false" id="S4.p1.5.m5.1.1.1.1.3" xref="S4.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><apply id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1"><times id="S4.p1.5.m5.1.1.2.cmml" xref="S4.p1.5.m5.1.1.2"></times><apply id="S4.p1.5.m5.1.1.3.cmml" xref="S4.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.3.1.cmml" xref="S4.p1.5.m5.1.1.3">subscript</csymbol><ci id="S4.p1.5.m5.1.1.3.2.cmml" xref="S4.p1.5.m5.1.1.3.2">𝑝</ci><ci id="S4.p1.5.m5.1.1.3.3.cmml" xref="S4.p1.5.m5.1.1.3.3">𝜽</ci></apply><apply id="S4.p1.5.m5.1.1.1.1.1.cmml" xref="S4.p1.5.m5.1.1.1.1"><csymbol cd="latexml" id="S4.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.p1.5.m5.1.1.1.1.1.1">conditional</csymbol><ci id="S4.p1.5.m5.1.1.1.1.1.2.cmml" xref="S4.p1.5.m5.1.1.1.1.1.2">𝒙</ci><ci id="S4.p1.5.m5.1.1.1.1.1.3.cmml" xref="S4.p1.5.m5.1.1.1.1.1.3">𝒛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">p_{\boldsymbol{\theta}}(\boldsymbol{x}\mid\boldsymbol{z})</annotation></semantics></math> is a product of exponential family distributions (again chosen to be Gaussian) with parameters computed by a neural network decoder with parameters <math id="S4.p1.6.m6.1" class="ltx_Math" alttext="\boldsymbol{\theta}" display="inline"><semantics id="S4.p1.6.m6.1a"><mi id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.1b"><ci id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.1c">\boldsymbol{\theta}</annotation></semantics></math>.
When training the model, the goal is to maximize the marginal likelihood of the data:</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.3" class="ltx_Math" alttext="p_{\boldsymbol{\theta}}(\boldsymbol{x})=\int p_{\boldsymbol{\theta}}(\boldsymbol{x}\mid\boldsymbol{z})p_{\boldsymbol{\theta}}(\boldsymbol{z})d\boldsymbol{z}" display="block"><semantics id="S4.E2.m1.3a"><mrow id="S4.E2.m1.3.3" xref="S4.E2.m1.3.3.cmml"><mrow id="S4.E2.m1.3.3.3" xref="S4.E2.m1.3.3.3.cmml"><msub id="S4.E2.m1.3.3.3.2" xref="S4.E2.m1.3.3.3.2.cmml"><mi id="S4.E2.m1.3.3.3.2.2" xref="S4.E2.m1.3.3.3.2.2.cmml">p</mi><mi id="S4.E2.m1.3.3.3.2.3" xref="S4.E2.m1.3.3.3.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.3.1" xref="S4.E2.m1.3.3.3.1.cmml">​</mo><mrow id="S4.E2.m1.3.3.3.3.2" xref="S4.E2.m1.3.3.3.cmml"><mo stretchy="false" id="S4.E2.m1.3.3.3.3.2.1" xref="S4.E2.m1.3.3.3.cmml">(</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S4.E2.m1.3.3.3.3.2.2" xref="S4.E2.m1.3.3.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S4.E2.m1.3.3.2" xref="S4.E2.m1.3.3.2.cmml">=</mo><mrow id="S4.E2.m1.3.3.1" xref="S4.E2.m1.3.3.1.cmml"><mo id="S4.E2.m1.3.3.1.2" xref="S4.E2.m1.3.3.1.2.cmml">∫</mo><mrow id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.1.cmml"><msub id="S4.E2.m1.3.3.1.1.3" xref="S4.E2.m1.3.3.1.1.3.cmml"><mi id="S4.E2.m1.3.3.1.1.3.2" xref="S4.E2.m1.3.3.1.1.3.2.cmml">p</mi><mi id="S4.E2.m1.3.3.1.1.3.3" xref="S4.E2.m1.3.3.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.1.1.2" xref="S4.E2.m1.3.3.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.3.3.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.3.3.1.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.3.3.1.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E2.m1.3.3.1.1.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S4.E2.m1.3.3.1.1.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.E2.m1.3.3.1.1.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo stretchy="false" id="S4.E2.m1.3.3.1.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.1.1.2a" xref="S4.E2.m1.3.3.1.1.2.cmml">​</mo><msub id="S4.E2.m1.3.3.1.1.4" xref="S4.E2.m1.3.3.1.1.4.cmml"><mi id="S4.E2.m1.3.3.1.1.4.2" xref="S4.E2.m1.3.3.1.1.4.2.cmml">p</mi><mi id="S4.E2.m1.3.3.1.1.4.3" xref="S4.E2.m1.3.3.1.1.4.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.1.1.2b" xref="S4.E2.m1.3.3.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.3.3.1.1.5.2" xref="S4.E2.m1.3.3.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.3.3.1.1.5.2.1" xref="S4.E2.m1.3.3.1.1.cmml">(</mo><mi id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml">𝒛</mi><mo stretchy="false" id="S4.E2.m1.3.3.1.1.5.2.2" xref="S4.E2.m1.3.3.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.1.1.2c" xref="S4.E2.m1.3.3.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.3.3.1.1.6" xref="S4.E2.m1.3.3.1.1.6.cmml"><mo rspace="0em" id="S4.E2.m1.3.3.1.1.6.1" xref="S4.E2.m1.3.3.1.1.6.1.cmml">𝑑</mo><mi id="S4.E2.m1.3.3.1.1.6.2" xref="S4.E2.m1.3.3.1.1.6.2.cmml">𝒛</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.3b"><apply id="S4.E2.m1.3.3.cmml" xref="S4.E2.m1.3.3"><eq id="S4.E2.m1.3.3.2.cmml" xref="S4.E2.m1.3.3.2"></eq><apply id="S4.E2.m1.3.3.3.cmml" xref="S4.E2.m1.3.3.3"><times id="S4.E2.m1.3.3.3.1.cmml" xref="S4.E2.m1.3.3.3.1"></times><apply id="S4.E2.m1.3.3.3.2.cmml" xref="S4.E2.m1.3.3.3.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.3.2.1.cmml" xref="S4.E2.m1.3.3.3.2">subscript</csymbol><ci id="S4.E2.m1.3.3.3.2.2.cmml" xref="S4.E2.m1.3.3.3.2.2">𝑝</ci><ci id="S4.E2.m1.3.3.3.2.3.cmml" xref="S4.E2.m1.3.3.3.2.3">𝜽</ci></apply><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝒙</ci></apply><apply id="S4.E2.m1.3.3.1.cmml" xref="S4.E2.m1.3.3.1"><int id="S4.E2.m1.3.3.1.2.cmml" xref="S4.E2.m1.3.3.1.2"></int><apply id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1.1"><times id="S4.E2.m1.3.3.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.2"></times><apply id="S4.E2.m1.3.3.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.3.1.cmml" xref="S4.E2.m1.3.3.1.1.3">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.3.2.cmml" xref="S4.E2.m1.3.3.1.1.3.2">𝑝</ci><ci id="S4.E2.m1.3.3.1.1.3.3.cmml" xref="S4.E2.m1.3.3.1.1.3.3">𝜽</ci></apply><apply id="S4.E2.m1.3.3.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E2.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.2">𝒙</ci><ci id="S4.E2.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.3">𝒛</ci></apply><apply id="S4.E2.m1.3.3.1.1.4.cmml" xref="S4.E2.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.4.1.cmml" xref="S4.E2.m1.3.3.1.1.4">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.4.2.cmml" xref="S4.E2.m1.3.3.1.1.4.2">𝑝</ci><ci id="S4.E2.m1.3.3.1.1.4.3.cmml" xref="S4.E2.m1.3.3.1.1.4.3">𝜽</ci></apply><ci id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2">𝒛</ci><apply id="S4.E2.m1.3.3.1.1.6.cmml" xref="S4.E2.m1.3.3.1.1.6"><csymbol cd="latexml" id="S4.E2.m1.3.3.1.1.6.1.cmml" xref="S4.E2.m1.3.3.1.1.6.1">differential-d</csymbol><ci id="S4.E2.m1.3.3.1.1.6.2.cmml" xref="S4.E2.m1.3.3.1.1.6.2">𝒛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.3c">p_{\boldsymbol{\theta}}(\boldsymbol{x})=\int p_{\boldsymbol{\theta}}(\boldsymbol{x}\mid\boldsymbol{z})p_{\boldsymbol{\theta}}(\boldsymbol{z})d\boldsymbol{z}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.p1.9" class="ltx_p">This computation is intractable, and hence the computation of the posterior is intractable as well:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.4" class="ltx_Math" alttext="p_{\boldsymbol{\theta}}(\boldsymbol{z}\mid\boldsymbol{x})=\frac{p_{\boldsymbol{\theta}}(\boldsymbol{z},\boldsymbol{x})}{p_{\boldsymbol{\theta}}(\boldsymbol{x})}" display="block"><semantics id="S4.E3.m1.4a"><mrow id="S4.E3.m1.4.4" xref="S4.E3.m1.4.4.cmml"><mrow id="S4.E3.m1.4.4.1" xref="S4.E3.m1.4.4.1.cmml"><msub id="S4.E3.m1.4.4.1.3" xref="S4.E3.m1.4.4.1.3.cmml"><mi id="S4.E3.m1.4.4.1.3.2" xref="S4.E3.m1.4.4.1.3.2.cmml">p</mi><mi id="S4.E3.m1.4.4.1.3.3" xref="S4.E3.m1.4.4.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.4.4.1.2" xref="S4.E3.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E3.m1.4.4.1.1.1" xref="S4.E3.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.4.4.1.1.1.2" xref="S4.E3.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.4.4.1.1.1.1" xref="S4.E3.m1.4.4.1.1.1.1.cmml"><mi id="S4.E3.m1.4.4.1.1.1.1.2" xref="S4.E3.m1.4.4.1.1.1.1.2.cmml">𝒛</mi><mo id="S4.E3.m1.4.4.1.1.1.1.1" xref="S4.E3.m1.4.4.1.1.1.1.1.cmml">∣</mo><mi id="S4.E3.m1.4.4.1.1.1.1.3" xref="S4.E3.m1.4.4.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S4.E3.m1.4.4.1.1.1.3" xref="S4.E3.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.4.4.2" xref="S4.E3.m1.4.4.2.cmml">=</mo><mfrac id="S4.E3.m1.3.3" xref="S4.E3.m1.3.3.cmml"><mrow id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.2.cmml"><msub id="S4.E3.m1.2.2.2.4" xref="S4.E3.m1.2.2.2.4.cmml"><mi id="S4.E3.m1.2.2.2.4.2" xref="S4.E3.m1.2.2.2.4.2.cmml">p</mi><mi id="S4.E3.m1.2.2.2.4.3" xref="S4.E3.m1.2.2.2.4.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.3" xref="S4.E3.m1.2.2.2.3.cmml">​</mo><mrow id="S4.E3.m1.2.2.2.5.2" xref="S4.E3.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.2.5.2.1" xref="S4.E3.m1.2.2.2.5.1.cmml">(</mo><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">𝒛</mi><mo id="S4.E3.m1.2.2.2.5.2.2" xref="S4.E3.m1.2.2.2.5.1.cmml">,</mo><mi id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2.cmml">𝒙</mi><mo stretchy="false" id="S4.E3.m1.2.2.2.5.2.3" xref="S4.E3.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow><mrow id="S4.E3.m1.3.3.3" xref="S4.E3.m1.3.3.3.cmml"><msub id="S4.E3.m1.3.3.3.3" xref="S4.E3.m1.3.3.3.3.cmml"><mi id="S4.E3.m1.3.3.3.3.2" xref="S4.E3.m1.3.3.3.3.2.cmml">p</mi><mi id="S4.E3.m1.3.3.3.3.3" xref="S4.E3.m1.3.3.3.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.3.3.3.2" xref="S4.E3.m1.3.3.3.2.cmml">​</mo><mrow id="S4.E3.m1.3.3.3.4.2" xref="S4.E3.m1.3.3.3.cmml"><mo stretchy="false" id="S4.E3.m1.3.3.3.4.2.1" xref="S4.E3.m1.3.3.3.cmml">(</mo><mi id="S4.E3.m1.3.3.3.1" xref="S4.E3.m1.3.3.3.1.cmml">𝒙</mi><mo stretchy="false" id="S4.E3.m1.3.3.3.4.2.2" xref="S4.E3.m1.3.3.3.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.4b"><apply id="S4.E3.m1.4.4.cmml" xref="S4.E3.m1.4.4"><eq id="S4.E3.m1.4.4.2.cmml" xref="S4.E3.m1.4.4.2"></eq><apply id="S4.E3.m1.4.4.1.cmml" xref="S4.E3.m1.4.4.1"><times id="S4.E3.m1.4.4.1.2.cmml" xref="S4.E3.m1.4.4.1.2"></times><apply id="S4.E3.m1.4.4.1.3.cmml" xref="S4.E3.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.1.3.1.cmml" xref="S4.E3.m1.4.4.1.3">subscript</csymbol><ci id="S4.E3.m1.4.4.1.3.2.cmml" xref="S4.E3.m1.4.4.1.3.2">𝑝</ci><ci id="S4.E3.m1.4.4.1.3.3.cmml" xref="S4.E3.m1.4.4.1.3.3">𝜽</ci></apply><apply id="S4.E3.m1.4.4.1.1.1.1.cmml" xref="S4.E3.m1.4.4.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.4.4.1.1.1.1.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1">conditional</csymbol><ci id="S4.E3.m1.4.4.1.1.1.1.2.cmml" xref="S4.E3.m1.4.4.1.1.1.1.2">𝒛</ci><ci id="S4.E3.m1.4.4.1.1.1.1.3.cmml" xref="S4.E3.m1.4.4.1.1.1.1.3">𝒙</ci></apply></apply><apply id="S4.E3.m1.3.3.cmml" xref="S4.E3.m1.3.3"><divide id="S4.E3.m1.3.3.4.cmml" xref="S4.E3.m1.3.3"></divide><apply id="S4.E3.m1.2.2.2.cmml" xref="S4.E3.m1.2.2.2"><times id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.3"></times><apply id="S4.E3.m1.2.2.2.4.cmml" xref="S4.E3.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.4.1.cmml" xref="S4.E3.m1.2.2.2.4">subscript</csymbol><ci id="S4.E3.m1.2.2.2.4.2.cmml" xref="S4.E3.m1.2.2.2.4.2">𝑝</ci><ci id="S4.E3.m1.2.2.2.4.3.cmml" xref="S4.E3.m1.2.2.2.4.3">𝜽</ci></apply><interval closure="open" id="S4.E3.m1.2.2.2.5.1.cmml" xref="S4.E3.m1.2.2.2.5.2"><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝒛</ci><ci id="S4.E3.m1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2">𝒙</ci></interval></apply><apply id="S4.E3.m1.3.3.3.cmml" xref="S4.E3.m1.3.3.3"><times id="S4.E3.m1.3.3.3.2.cmml" xref="S4.E3.m1.3.3.3.2"></times><apply id="S4.E3.m1.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.3.1.cmml" xref="S4.E3.m1.3.3.3.3">subscript</csymbol><ci id="S4.E3.m1.3.3.3.3.2.cmml" xref="S4.E3.m1.3.3.3.3.2">𝑝</ci><ci id="S4.E3.m1.3.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3.3">𝜽</ci></apply><ci id="S4.E3.m1.3.3.3.1.cmml" xref="S4.E3.m1.3.3.3.1">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.4c">p_{\boldsymbol{\theta}}(\boldsymbol{z}\mid\boldsymbol{x})=\frac{p_{\boldsymbol{\theta}}(\boldsymbol{z},\boldsymbol{x})}{p_{\boldsymbol{\theta}}(\boldsymbol{x})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.p1.7" class="ltx_p">The solution is to compute an approximate posterior using a inference network i.e. the encoder with parameters <math id="S4.p1.7.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S4.p1.7.m1.1a"><mi id="S4.p1.7.m1.1.1" xref="S4.p1.7.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.p1.7.m1.1b"><ci id="S4.p1.7.m1.1.1.cmml" xref="S4.p1.7.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.7.m1.1c">\phi</annotation></semantics></math>. The conventional approach is to maximize the so-called Evidence Lower Bound (ELBO), given by:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.7" class="ltx_Math" alttext="\mathrm{L}_{\boldsymbol{\theta},\boldsymbol{\phi}}(\boldsymbol{x})=\mathbb{E}_{q_{\boldsymbol{\phi}}(\boldsymbol{z}\mid\boldsymbol{x})}\left[\log p_{\boldsymbol{\theta}}(\boldsymbol{x}\mid\boldsymbol{z})\right]-D_{\mathbb{K}\mathbb{L}}\left(q_{\boldsymbol{\phi}}(\boldsymbol{z}\mid\boldsymbol{x})\|p_{\boldsymbol{\theta}}(\boldsymbol{z})\right)" display="block"><semantics id="S4.E4.m1.7a"><mrow id="S4.E4.m1.7.7" xref="S4.E4.m1.7.7.cmml"><mrow id="S4.E4.m1.7.7.4" xref="S4.E4.m1.7.7.4.cmml"><msub id="S4.E4.m1.7.7.4.2" xref="S4.E4.m1.7.7.4.2.cmml"><mi mathvariant="normal" id="S4.E4.m1.7.7.4.2.2" xref="S4.E4.m1.7.7.4.2.2.cmml">L</mi><mrow id="S4.E4.m1.2.2.2.4" xref="S4.E4.m1.2.2.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">𝜽</mi><mo id="S4.E4.m1.2.2.2.4.1" xref="S4.E4.m1.2.2.2.3.cmml">,</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.2.cmml">ϕ</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.7.7.4.1" xref="S4.E4.m1.7.7.4.1.cmml">​</mo><mrow id="S4.E4.m1.7.7.4.3.2" xref="S4.E4.m1.7.7.4.cmml"><mo stretchy="false" id="S4.E4.m1.7.7.4.3.2.1" xref="S4.E4.m1.7.7.4.cmml">(</mo><mi id="S4.E4.m1.4.4" xref="S4.E4.m1.4.4.cmml">𝒙</mi><mo stretchy="false" id="S4.E4.m1.7.7.4.3.2.2" xref="S4.E4.m1.7.7.4.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.7.7.3" xref="S4.E4.m1.7.7.3.cmml">=</mo><mrow id="S4.E4.m1.7.7.2" xref="S4.E4.m1.7.7.2.cmml"><mrow id="S4.E4.m1.6.6.1.1" xref="S4.E4.m1.6.6.1.1.cmml"><msub id="S4.E4.m1.6.6.1.1.3" xref="S4.E4.m1.6.6.1.1.3.cmml"><mi id="S4.E4.m1.6.6.1.1.3.2" xref="S4.E4.m1.6.6.1.1.3.2.cmml">𝔼</mi><mrow id="S4.E4.m1.3.3.1" xref="S4.E4.m1.3.3.1.cmml"><msub id="S4.E4.m1.3.3.1.3" xref="S4.E4.m1.3.3.1.3.cmml"><mi id="S4.E4.m1.3.3.1.3.2" xref="S4.E4.m1.3.3.1.3.2.cmml">q</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E4.m1.3.3.1.3.3" xref="S4.E4.m1.3.3.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.3.3.1.2" xref="S4.E4.m1.3.3.1.2.cmml">​</mo><mrow id="S4.E4.m1.3.3.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.3.3.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.3.3.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.cmml"><mi id="S4.E4.m1.3.3.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.2.cmml">𝒛</mi><mo id="S4.E4.m1.3.3.1.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.1.cmml">∣</mo><mi id="S4.E4.m1.3.3.1.1.1.1.3" xref="S4.E4.m1.3.3.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S4.E4.m1.3.3.1.1.1.3" xref="S4.E4.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.6.6.1.1.2" xref="S4.E4.m1.6.6.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.6.6.1.1.1.1" xref="S4.E4.m1.6.6.1.1.1.2.cmml"><mo id="S4.E4.m1.6.6.1.1.1.1.2" xref="S4.E4.m1.6.6.1.1.1.2.1.cmml">[</mo><mrow id="S4.E4.m1.6.6.1.1.1.1.1" xref="S4.E4.m1.6.6.1.1.1.1.1.cmml"><mrow id="S4.E4.m1.6.6.1.1.1.1.1.3" xref="S4.E4.m1.6.6.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.6.6.1.1.1.1.1.3.1" xref="S4.E4.m1.6.6.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E4.m1.6.6.1.1.1.1.1.3a" xref="S4.E4.m1.6.6.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E4.m1.6.6.1.1.1.1.1.3.2" xref="S4.E4.m1.6.6.1.1.1.1.1.3.2.cmml"><mi id="S4.E4.m1.6.6.1.1.1.1.1.3.2.2" xref="S4.E4.m1.6.6.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S4.E4.m1.6.6.1.1.1.1.1.3.2.3" xref="S4.E4.m1.6.6.1.1.1.1.1.3.2.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E4.m1.6.6.1.1.1.1.1.2" xref="S4.E4.m1.6.6.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.6.6.1.1.1.1.1.1.1" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.6.6.1.1.1.1.1.1.1.2" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.6.6.1.1.1.1.1.1.1.1" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo stretchy="false" id="S4.E4.m1.6.6.1.1.1.1.1.1.1.3" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.6.6.1.1.1.1.3" xref="S4.E4.m1.6.6.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E4.m1.7.7.2.3" xref="S4.E4.m1.7.7.2.3.cmml">−</mo><mrow id="S4.E4.m1.7.7.2.2" xref="S4.E4.m1.7.7.2.2.cmml"><msub id="S4.E4.m1.7.7.2.2.3" xref="S4.E4.m1.7.7.2.2.3.cmml"><mi id="S4.E4.m1.7.7.2.2.3.2" xref="S4.E4.m1.7.7.2.2.3.2.cmml">D</mi><mrow id="S4.E4.m1.7.7.2.2.3.3" xref="S4.E4.m1.7.7.2.2.3.3.cmml"><mi id="S4.E4.m1.7.7.2.2.3.3.2" xref="S4.E4.m1.7.7.2.2.3.3.2.cmml">𝕂</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.7.7.2.2.3.3.1" xref="S4.E4.m1.7.7.2.2.3.3.1.cmml">​</mo><mi id="S4.E4.m1.7.7.2.2.3.3.3" xref="S4.E4.m1.7.7.2.2.3.3.3.cmml">𝕃</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.7.7.2.2.2" xref="S4.E4.m1.7.7.2.2.2.cmml">​</mo><mrow id="S4.E4.m1.7.7.2.2.1.1" xref="S4.E4.m1.7.7.2.2.1.1.1.cmml"><mo id="S4.E4.m1.7.7.2.2.1.1.2" xref="S4.E4.m1.7.7.2.2.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.7.7.2.2.1.1.1" xref="S4.E4.m1.7.7.2.2.1.1.1.cmml"><mrow id="S4.E4.m1.7.7.2.2.1.1.1.1" xref="S4.E4.m1.7.7.2.2.1.1.1.1.cmml"><msub id="S4.E4.m1.7.7.2.2.1.1.1.1.3" xref="S4.E4.m1.7.7.2.2.1.1.1.1.3.cmml"><mi id="S4.E4.m1.7.7.2.2.1.1.1.1.3.2" xref="S4.E4.m1.7.7.2.2.1.1.1.1.3.2.cmml">q</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E4.m1.7.7.2.2.1.1.1.1.3.3" xref="S4.E4.m1.7.7.2.2.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.7.7.2.2.1.1.1.1.2" xref="S4.E4.m1.7.7.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.2" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.2" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mo id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.1" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.3" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.3" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.7.7.2.2.1.1.1.2" xref="S4.E4.m1.7.7.2.2.1.1.1.2.cmml">∥</mo><mrow id="S4.E4.m1.7.7.2.2.1.1.1.3" xref="S4.E4.m1.7.7.2.2.1.1.1.3.cmml"><msub id="S4.E4.m1.7.7.2.2.1.1.1.3.2" xref="S4.E4.m1.7.7.2.2.1.1.1.3.2.cmml"><mi id="S4.E4.m1.7.7.2.2.1.1.1.3.2.2" xref="S4.E4.m1.7.7.2.2.1.1.1.3.2.2.cmml">p</mi><mi id="S4.E4.m1.7.7.2.2.1.1.1.3.2.3" xref="S4.E4.m1.7.7.2.2.1.1.1.3.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.7.7.2.2.1.1.1.3.1" xref="S4.E4.m1.7.7.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S4.E4.m1.7.7.2.2.1.1.1.3.3.2" xref="S4.E4.m1.7.7.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S4.E4.m1.7.7.2.2.1.1.1.3.3.2.1" xref="S4.E4.m1.7.7.2.2.1.1.1.3.cmml">(</mo><mi id="S4.E4.m1.5.5" xref="S4.E4.m1.5.5.cmml">𝒛</mi><mo stretchy="false" id="S4.E4.m1.7.7.2.2.1.1.1.3.3.2.2" xref="S4.E4.m1.7.7.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.7.7.2.2.1.1.3" xref="S4.E4.m1.7.7.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.7b"><apply id="S4.E4.m1.7.7.cmml" xref="S4.E4.m1.7.7"><eq id="S4.E4.m1.7.7.3.cmml" xref="S4.E4.m1.7.7.3"></eq><apply id="S4.E4.m1.7.7.4.cmml" xref="S4.E4.m1.7.7.4"><times id="S4.E4.m1.7.7.4.1.cmml" xref="S4.E4.m1.7.7.4.1"></times><apply id="S4.E4.m1.7.7.4.2.cmml" xref="S4.E4.m1.7.7.4.2"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.4.2.1.cmml" xref="S4.E4.m1.7.7.4.2">subscript</csymbol><ci id="S4.E4.m1.7.7.4.2.2.cmml" xref="S4.E4.m1.7.7.4.2.2">L</ci><list id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.4"><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝜽</ci><ci id="S4.E4.m1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2">bold-italic-ϕ</ci></list></apply><ci id="S4.E4.m1.4.4.cmml" xref="S4.E4.m1.4.4">𝒙</ci></apply><apply id="S4.E4.m1.7.7.2.cmml" xref="S4.E4.m1.7.7.2"><minus id="S4.E4.m1.7.7.2.3.cmml" xref="S4.E4.m1.7.7.2.3"></minus><apply id="S4.E4.m1.6.6.1.1.cmml" xref="S4.E4.m1.6.6.1.1"><times id="S4.E4.m1.6.6.1.1.2.cmml" xref="S4.E4.m1.6.6.1.1.2"></times><apply id="S4.E4.m1.6.6.1.1.3.cmml" xref="S4.E4.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.1.1.3.1.cmml" xref="S4.E4.m1.6.6.1.1.3">subscript</csymbol><ci id="S4.E4.m1.6.6.1.1.3.2.cmml" xref="S4.E4.m1.6.6.1.1.3.2">𝔼</ci><apply id="S4.E4.m1.3.3.1.cmml" xref="S4.E4.m1.3.3.1"><times id="S4.E4.m1.3.3.1.2.cmml" xref="S4.E4.m1.3.3.1.2"></times><apply id="S4.E4.m1.3.3.1.3.cmml" xref="S4.E4.m1.3.3.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.3.1.cmml" xref="S4.E4.m1.3.3.1.3">subscript</csymbol><ci id="S4.E4.m1.3.3.1.3.2.cmml" xref="S4.E4.m1.3.3.1.3.2">𝑞</ci><ci id="S4.E4.m1.3.3.1.3.3.cmml" xref="S4.E4.m1.3.3.1.3.3">bold-italic-ϕ</ci></apply><apply id="S4.E4.m1.3.3.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.3.3.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1">conditional</csymbol><ci id="S4.E4.m1.3.3.1.1.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.2">𝒛</ci><ci id="S4.E4.m1.3.3.1.1.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.3">𝒙</ci></apply></apply></apply><apply id="S4.E4.m1.6.6.1.1.1.2.cmml" xref="S4.E4.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.6.6.1.1.1.2.1.cmml" xref="S4.E4.m1.6.6.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E4.m1.6.6.1.1.1.1.1.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1"><times id="S4.E4.m1.6.6.1.1.1.1.1.2.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.2"></times><apply id="S4.E4.m1.6.6.1.1.1.1.1.3.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.3"><log id="S4.E4.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.3.1"></log><apply id="S4.E4.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.6.6.1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E4.m1.6.6.1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S4.E4.m1.6.6.1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.3.2.3">𝜽</ci></apply></apply><apply id="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.6.6.1.1.1.1.1.1.1.1.3">𝒛</ci></apply></apply></apply></apply><apply id="S4.E4.m1.7.7.2.2.cmml" xref="S4.E4.m1.7.7.2.2"><times id="S4.E4.m1.7.7.2.2.2.cmml" xref="S4.E4.m1.7.7.2.2.2"></times><apply id="S4.E4.m1.7.7.2.2.3.cmml" xref="S4.E4.m1.7.7.2.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.2.2.3.1.cmml" xref="S4.E4.m1.7.7.2.2.3">subscript</csymbol><ci id="S4.E4.m1.7.7.2.2.3.2.cmml" xref="S4.E4.m1.7.7.2.2.3.2">𝐷</ci><apply id="S4.E4.m1.7.7.2.2.3.3.cmml" xref="S4.E4.m1.7.7.2.2.3.3"><times id="S4.E4.m1.7.7.2.2.3.3.1.cmml" xref="S4.E4.m1.7.7.2.2.3.3.1"></times><ci id="S4.E4.m1.7.7.2.2.3.3.2.cmml" xref="S4.E4.m1.7.7.2.2.3.3.2">𝕂</ci><ci id="S4.E4.m1.7.7.2.2.3.3.3.cmml" xref="S4.E4.m1.7.7.2.2.3.3.3">𝕃</ci></apply></apply><apply id="S4.E4.m1.7.7.2.2.1.1.1.cmml" xref="S4.E4.m1.7.7.2.2.1.1"><csymbol cd="latexml" id="S4.E4.m1.7.7.2.2.1.1.1.2.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.2">conditional</csymbol><apply id="S4.E4.m1.7.7.2.2.1.1.1.1.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.1"><times id="S4.E4.m1.7.7.2.2.1.1.1.1.2.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.1.2"></times><apply id="S4.E4.m1.7.7.2.2.1.1.1.1.3.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.2.2.1.1.1.1.3.1.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.7.7.2.2.1.1.1.1.3.2.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.1.3.2">𝑞</ci><ci id="S4.E4.m1.7.7.2.2.1.1.1.1.3.3.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.1.3.3">bold-italic-ϕ</ci></apply><apply id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.2">𝒛</ci><ci id="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.1.1.1.1.3">𝒙</ci></apply></apply><apply id="S4.E4.m1.7.7.2.2.1.1.1.3.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.3"><times id="S4.E4.m1.7.7.2.2.1.1.1.3.1.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.3.1"></times><apply id="S4.E4.m1.7.7.2.2.1.1.1.3.2.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.2.2.1.1.1.3.2.1.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.3.2">subscript</csymbol><ci id="S4.E4.m1.7.7.2.2.1.1.1.3.2.2.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.3.2.2">𝑝</ci><ci id="S4.E4.m1.7.7.2.2.1.1.1.3.2.3.cmml" xref="S4.E4.m1.7.7.2.2.1.1.1.3.2.3">𝜽</ci></apply><ci id="S4.E4.m1.5.5.cmml" xref="S4.E4.m1.5.5">𝒛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.7c">\mathrm{L}_{\boldsymbol{\theta},\boldsymbol{\phi}}(\boldsymbol{x})=\mathbb{E}_{q_{\boldsymbol{\phi}}(\boldsymbol{z}\mid\boldsymbol{x})}\left[\log p_{\boldsymbol{\theta}}(\boldsymbol{x}\mid\boldsymbol{z})\right]-D_{\mathbb{K}\mathbb{L}}\left(q_{\boldsymbol{\phi}}(\boldsymbol{z}\mid\boldsymbol{x})\|p_{\boldsymbol{\theta}}(\boldsymbol{z})\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">This objective function is the expected log likelihood (first term on the RHS) and a regularization term (second term on the RHS) which is essentially the Kulback-Leibler (KL) divergence. The regularization term ensures the per-sample posterior does not deviate too far from the prior in terms of KL
divergence.
We make the following assumptions:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.4" class="ltx_Math" alttext="p(\boldsymbol{z})=\mathcal{N}(\boldsymbol{z}\mid\mathbf{0},\mathbf{I})" display="block"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4" xref="S4.E5.m1.4.4.cmml"><mrow id="S4.E5.m1.4.4.3" xref="S4.E5.m1.4.4.3.cmml"><mi id="S4.E5.m1.4.4.3.2" xref="S4.E5.m1.4.4.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.3.1" xref="S4.E5.m1.4.4.3.1.cmml">​</mo><mrow id="S4.E5.m1.4.4.3.3.2" xref="S4.E5.m1.4.4.3.cmml"><mo stretchy="false" id="S4.E5.m1.4.4.3.3.2.1" xref="S4.E5.m1.4.4.3.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">𝒛</mi><mo stretchy="false" id="S4.E5.m1.4.4.3.3.2.2" xref="S4.E5.m1.4.4.3.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.4.4.2" xref="S4.E5.m1.4.4.2.cmml">=</mo><mrow id="S4.E5.m1.4.4.1" xref="S4.E5.m1.4.4.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.4.4.1.3" xref="S4.E5.m1.4.4.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.2" xref="S4.E5.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E5.m1.4.4.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.4.4.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.2.cmml">𝒛</mi><mo id="S4.E5.m1.4.4.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.cmml">∣</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.3.2" xref="S4.E5.m1.4.4.1.1.1.1.3.1.cmml"><mn id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">𝟎</mn><mo id="S4.E5.m1.4.4.1.1.1.1.3.2.1" xref="S4.E5.m1.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml">𝐈</mi></mrow></mrow><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.cmml" xref="S4.E5.m1.4.4"><eq id="S4.E5.m1.4.4.2.cmml" xref="S4.E5.m1.4.4.2"></eq><apply id="S4.E5.m1.4.4.3.cmml" xref="S4.E5.m1.4.4.3"><times id="S4.E5.m1.4.4.3.1.cmml" xref="S4.E5.m1.4.4.3.1"></times><ci id="S4.E5.m1.4.4.3.2.cmml" xref="S4.E5.m1.4.4.3.2">𝑝</ci><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝒛</ci></apply><apply id="S4.E5.m1.4.4.1.cmml" xref="S4.E5.m1.4.4.1"><times id="S4.E5.m1.4.4.1.2.cmml" xref="S4.E5.m1.4.4.1.2"></times><ci id="S4.E5.m1.4.4.1.3.cmml" xref="S4.E5.m1.4.4.1.3">𝒩</ci><apply id="S4.E5.m1.4.4.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.4.4.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1">conditional</csymbol><ci id="S4.E5.m1.4.4.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.2">𝒛</ci><list id="S4.E5.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2"><cn type="integer" id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">0</cn><ci id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">𝐈</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">p(\boldsymbol{z})=\mathcal{N}(\boldsymbol{z}\mid\mathbf{0},\mathbf{I})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p3" class="ltx_para">
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.5" class="ltx_Math" alttext="q(\boldsymbol{z}\mid\boldsymbol{x})=\mathcal{N}(\boldsymbol{z}\mid\boldsymbol{\mu},\operatorname{diag}(\boldsymbol{\sigma}))" display="block"><semantics id="S4.E6.m1.5a"><mrow id="S4.E6.m1.5.5" xref="S4.E6.m1.5.5.cmml"><mrow id="S4.E6.m1.4.4.1" xref="S4.E6.m1.4.4.1.cmml"><mi id="S4.E6.m1.4.4.1.3" xref="S4.E6.m1.4.4.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.4.4.1.2" xref="S4.E6.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E6.m1.4.4.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.4.4.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.4.4.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.cmml"><mi id="S4.E6.m1.4.4.1.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.1.2.cmml">𝒛</mi><mo id="S4.E6.m1.4.4.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.1.cmml">∣</mo><mi id="S4.E6.m1.4.4.1.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S4.E6.m1.4.4.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.5.5.3" xref="S4.E6.m1.5.5.3.cmml">=</mo><mrow id="S4.E6.m1.5.5.2" xref="S4.E6.m1.5.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.5.5.2.3" xref="S4.E6.m1.5.5.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.2.2" xref="S4.E6.m1.5.5.2.2.cmml">​</mo><mrow id="S4.E6.m1.5.5.2.1.1" xref="S4.E6.m1.5.5.2.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.2.1.1.2" xref="S4.E6.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.5.5.2.1.1.1" xref="S4.E6.m1.5.5.2.1.1.1.cmml"><mi id="S4.E6.m1.5.5.2.1.1.1.3" xref="S4.E6.m1.5.5.2.1.1.1.3.cmml">𝒛</mi><mo id="S4.E6.m1.5.5.2.1.1.1.2" xref="S4.E6.m1.5.5.2.1.1.1.2.cmml">∣</mo><mrow id="S4.E6.m1.5.5.2.1.1.1.1.1" xref="S4.E6.m1.5.5.2.1.1.1.1.2.cmml"><mi id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml">𝝁</mi><mo id="S4.E6.m1.5.5.2.1.1.1.1.1.2" xref="S4.E6.m1.5.5.2.1.1.1.1.2.cmml">,</mo><mrow id="S4.E6.m1.5.5.2.1.1.1.1.1.1.2" xref="S4.E6.m1.5.5.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">diag</mi><mo id="S4.E6.m1.5.5.2.1.1.1.1.1.1.2a" xref="S4.E6.m1.5.5.2.1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S4.E6.m1.5.5.2.1.1.1.1.1.1.2.1" xref="S4.E6.m1.5.5.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.2.1.1.1.1.1.1.2.1.1" xref="S4.E6.m1.5.5.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">𝝈</mi><mo stretchy="false" id="S4.E6.m1.5.5.2.1.1.1.1.1.1.2.1.2" xref="S4.E6.m1.5.5.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S4.E6.m1.5.5.2.1.1.3" xref="S4.E6.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.5b"><apply id="S4.E6.m1.5.5.cmml" xref="S4.E6.m1.5.5"><eq id="S4.E6.m1.5.5.3.cmml" xref="S4.E6.m1.5.5.3"></eq><apply id="S4.E6.m1.4.4.1.cmml" xref="S4.E6.m1.4.4.1"><times id="S4.E6.m1.4.4.1.2.cmml" xref="S4.E6.m1.4.4.1.2"></times><ci id="S4.E6.m1.4.4.1.3.cmml" xref="S4.E6.m1.4.4.1.3">𝑞</ci><apply id="S4.E6.m1.4.4.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.4.4.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1">conditional</csymbol><ci id="S4.E6.m1.4.4.1.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.2">𝒛</ci><ci id="S4.E6.m1.4.4.1.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3">𝒙</ci></apply></apply><apply id="S4.E6.m1.5.5.2.cmml" xref="S4.E6.m1.5.5.2"><times id="S4.E6.m1.5.5.2.2.cmml" xref="S4.E6.m1.5.5.2.2"></times><ci id="S4.E6.m1.5.5.2.3.cmml" xref="S4.E6.m1.5.5.2.3">𝒩</ci><apply id="S4.E6.m1.5.5.2.1.1.1.cmml" xref="S4.E6.m1.5.5.2.1.1"><csymbol cd="latexml" id="S4.E6.m1.5.5.2.1.1.1.2.cmml" xref="S4.E6.m1.5.5.2.1.1.1.2">conditional</csymbol><ci id="S4.E6.m1.5.5.2.1.1.1.3.cmml" xref="S4.E6.m1.5.5.2.1.1.1.3">𝒛</ci><list id="S4.E6.m1.5.5.2.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.2.1.1.1.1.1"><ci id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3">𝝁</ci><apply id="S4.E6.m1.5.5.2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.2.1.1.1.1.1.1.2"><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">diag</ci><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">𝝈</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.5c">q(\boldsymbol{z}\mid\boldsymbol{x})=\mathcal{N}(\boldsymbol{z}\mid\boldsymbol{\mu},\operatorname{diag}(\boldsymbol{\sigma}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">This allows the KL to be computed in closed form:</p>
</div>
<div id="S4.p5" class="ltx_para">
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.2" class="ltx_Math" alttext="D_{\mathbb{K}\mathbb{L}}(q\|p)=-\frac{1}{2}\sum_{k=1}^{K}\left[\log\sigma_{k}^{2}-\sigma_{k}^{2}-\mu_{k}^{2}+1\right]" display="block"><semantics id="S4.E7.m1.2a"><mrow id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml"><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.cmml"><msub id="S4.E7.m1.1.1.1.3" xref="S4.E7.m1.1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.3.2.cmml">D</mi><mrow id="S4.E7.m1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.3.3.cmml"><mi id="S4.E7.m1.1.1.1.3.3.2" xref="S4.E7.m1.1.1.1.3.3.2.cmml">𝕂</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.1.1.1.3.3.1" xref="S4.E7.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E7.m1.1.1.1.3.3.3" xref="S4.E7.m1.1.1.1.3.3.3.cmml">𝕃</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.1.1.1.2" xref="S4.E7.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.2.cmml">q</mi><mo id="S4.E7.m1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml">∥</mo><mi id="S4.E7.m1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.3.cmml">p</mi></mrow><mo stretchy="false" id="S4.E7.m1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.2.2.3" xref="S4.E7.m1.2.2.3.cmml">=</mo><mrow id="S4.E7.m1.2.2.2" xref="S4.E7.m1.2.2.2.cmml"><mo id="S4.E7.m1.2.2.2a" xref="S4.E7.m1.2.2.2.cmml">−</mo><mrow id="S4.E7.m1.2.2.2.1" xref="S4.E7.m1.2.2.2.1.cmml"><mfrac id="S4.E7.m1.2.2.2.1.3" xref="S4.E7.m1.2.2.2.1.3.cmml"><mn id="S4.E7.m1.2.2.2.1.3.2" xref="S4.E7.m1.2.2.2.1.3.2.cmml">1</mn><mn id="S4.E7.m1.2.2.2.1.3.3" xref="S4.E7.m1.2.2.2.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S4.E7.m1.2.2.2.1.2" xref="S4.E7.m1.2.2.2.1.2.cmml">​</mo><mrow id="S4.E7.m1.2.2.2.1.1" xref="S4.E7.m1.2.2.2.1.1.cmml"><munderover id="S4.E7.m1.2.2.2.1.1.2" xref="S4.E7.m1.2.2.2.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E7.m1.2.2.2.1.1.2.2.2" xref="S4.E7.m1.2.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E7.m1.2.2.2.1.1.2.2.3" xref="S4.E7.m1.2.2.2.1.1.2.2.3.cmml"><mi id="S4.E7.m1.2.2.2.1.1.2.2.3.2" xref="S4.E7.m1.2.2.2.1.1.2.2.3.2.cmml">k</mi><mo id="S4.E7.m1.2.2.2.1.1.2.2.3.1" xref="S4.E7.m1.2.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E7.m1.2.2.2.1.1.2.2.3.3" xref="S4.E7.m1.2.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.2.2.2.1.1.2.3" xref="S4.E7.m1.2.2.2.1.1.2.3.cmml">K</mi></munderover><mrow id="S4.E7.m1.2.2.2.1.1.1.1" xref="S4.E7.m1.2.2.2.1.1.1.2.cmml"><mo id="S4.E7.m1.2.2.2.1.1.1.1.2" xref="S4.E7.m1.2.2.2.1.1.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.2.2.2.1.1.1.1.1" xref="S4.E7.m1.2.2.2.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.2.2.2.1.1.1.1.1.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.cmml"><mrow id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.cmml"><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.1" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.1.cmml">log</mi><mo lspace="0.167em" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2a" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.cmml">⁡</mo><msubsup id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.2.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.2.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.2.3.cmml">k</mi><mn id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.3.cmml">2</mn></msubsup></mrow><mo id="S4.E7.m1.2.2.2.1.1.1.1.1.2.1" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.1.cmml">−</mo><msubsup id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.cmml"><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.2.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.2.2.cmml">σ</mi><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.2.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.2.3.cmml">k</mi><mn id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.3.cmml">2</mn></msubsup><mo id="S4.E7.m1.2.2.2.1.1.1.1.1.2.1a" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.1.cmml">−</mo><msubsup id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.cmml"><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.2.2" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.2.2.cmml">μ</mi><mi id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.2.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.2.3.cmml">k</mi><mn id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.3.cmml">2</mn></msubsup></mrow><mo id="S4.E7.m1.2.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1.cmml">+</mo><mn id="S4.E7.m1.2.2.2.1.1.1.1.1.3" xref="S4.E7.m1.2.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E7.m1.2.2.2.1.1.1.1.3" xref="S4.E7.m1.2.2.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.2b"><apply id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2"><eq id="S4.E7.m1.2.2.3.cmml" xref="S4.E7.m1.2.2.3"></eq><apply id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><times id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.2"></times><apply id="S4.E7.m1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.3.2">𝐷</ci><apply id="S4.E7.m1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.3.3"><times id="S4.E7.m1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.1.1.1.3.3.1"></times><ci id="S4.E7.m1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.1.1.1.3.3.2">𝕂</ci><ci id="S4.E7.m1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.1.1.1.3.3.3">𝕃</ci></apply></apply><apply id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.2">𝑞</ci><ci id="S4.E7.m1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S4.E7.m1.2.2.2.cmml" xref="S4.E7.m1.2.2.2"><minus id="S4.E7.m1.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2"></minus><apply id="S4.E7.m1.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.1"><times id="S4.E7.m1.2.2.2.1.2.cmml" xref="S4.E7.m1.2.2.2.1.2"></times><apply id="S4.E7.m1.2.2.2.1.3.cmml" xref="S4.E7.m1.2.2.2.1.3"><divide id="S4.E7.m1.2.2.2.1.3.1.cmml" xref="S4.E7.m1.2.2.2.1.3"></divide><cn type="integer" id="S4.E7.m1.2.2.2.1.3.2.cmml" xref="S4.E7.m1.2.2.2.1.3.2">1</cn><cn type="integer" id="S4.E7.m1.2.2.2.1.3.3.cmml" xref="S4.E7.m1.2.2.2.1.3.3">2</cn></apply><apply id="S4.E7.m1.2.2.2.1.1.cmml" xref="S4.E7.m1.2.2.2.1.1"><apply id="S4.E7.m1.2.2.2.1.1.2.cmml" xref="S4.E7.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.2">superscript</csymbol><apply id="S4.E7.m1.2.2.2.1.1.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.2.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.2">subscript</csymbol><sum id="S4.E7.m1.2.2.2.1.1.2.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.2.2.2"></sum><apply id="S4.E7.m1.2.2.2.1.1.2.2.3.cmml" xref="S4.E7.m1.2.2.2.1.1.2.2.3"><eq id="S4.E7.m1.2.2.2.1.1.2.2.3.1.cmml" xref="S4.E7.m1.2.2.2.1.1.2.2.3.1"></eq><ci id="S4.E7.m1.2.2.2.1.1.2.2.3.2.cmml" xref="S4.E7.m1.2.2.2.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S4.E7.m1.2.2.2.1.1.2.2.3.3.cmml" xref="S4.E7.m1.2.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.2.2.2.1.1.2.3.cmml" xref="S4.E7.m1.2.2.2.1.1.2.3">𝐾</ci></apply><apply id="S4.E7.m1.2.2.2.1.1.1.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.2.2.2.1.1.1.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1"><plus id="S4.E7.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.1"></plus><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2"><minus id="S4.E7.m1.2.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.1"></minus><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2"><log id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.1"></log><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.2.2">𝜎</ci><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply><cn type="integer" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.2.2.3">2</cn></apply></apply><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3">superscript</csymbol><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.2.2">𝜎</ci><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.2.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.2.3">𝑘</ci></apply><cn type="integer" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.3.3">2</cn></apply><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4">superscript</csymbol><apply id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.2.1.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.2.2.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.2.2">𝜇</ci><ci id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.2.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.2.3">𝑘</ci></apply><cn type="integer" id="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.2.4.3">2</cn></apply></apply><cn type="integer" id="S4.E7.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.2.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.2c">D_{\mathbb{K}\mathbb{L}}(q\|p)=-\frac{1}{2}\sum_{k=1}^{K}\left[\log\sigma_{k}^{2}-\sigma_{k}^{2}-\mu_{k}^{2}+1\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.p5.1" class="ltx_p">The log-likelihood term can be approximated by sampling:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\boldsymbol{z}^{s}\sim q_{\phi}(\boldsymbol{z}\mid\boldsymbol{x})" display="block"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><msup id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.3.2" xref="S4.E8.m1.1.1.3.2.cmml">𝒛</mi><mi id="S4.E8.m1.1.1.3.3" xref="S4.E8.m1.1.1.3.3.cmml">s</mi></msup><mo id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2.cmml">∼</mo><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml"><msub id="S4.E8.m1.1.1.1.3" xref="S4.E8.m1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.3.2.cmml">q</mi><mi id="S4.E8.m1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">𝒛</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.E8.m1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><csymbol cd="latexml" id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2">similar-to</csymbol><apply id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.3">superscript</csymbol><ci id="S4.E8.m1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.3.2">𝒛</ci><ci id="S4.E8.m1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.3.3">𝑠</ci></apply><apply id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><times id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.2"></times><apply id="S4.E8.m1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.3.2">𝑞</ci><ci id="S4.E8.m1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2">𝒛</ci><ci id="S4.E8.m1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\boldsymbol{z}^{s}\sim q_{\phi}(\boldsymbol{z}\mid\boldsymbol{x})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.6" class="ltx_Math" alttext="\mathrm{L}_{\boldsymbol{\theta},\boldsymbol{\phi}}(\boldsymbol{x})=\log p_{\boldsymbol{\theta}}\left(\boldsymbol{x}\mid\boldsymbol{z}^{s}\right)-D_{\mathrm{KL}}\left(q_{\boldsymbol{\phi}}(\boldsymbol{z}\mid\boldsymbol{x})\|p_{\boldsymbol{\theta}}(\boldsymbol{z})\right)" display="block"><semantics id="S4.E9.m1.6a"><mrow id="S4.E9.m1.6.6" xref="S4.E9.m1.6.6.cmml"><mrow id="S4.E9.m1.6.6.4" xref="S4.E9.m1.6.6.4.cmml"><msub id="S4.E9.m1.6.6.4.2" xref="S4.E9.m1.6.6.4.2.cmml"><mi mathvariant="normal" id="S4.E9.m1.6.6.4.2.2" xref="S4.E9.m1.6.6.4.2.2.cmml">L</mi><mrow id="S4.E9.m1.2.2.2.4" xref="S4.E9.m1.2.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">𝜽</mi><mo id="S4.E9.m1.2.2.2.4.1" xref="S4.E9.m1.2.2.2.3.cmml">,</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.cmml">ϕ</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.6.6.4.1" xref="S4.E9.m1.6.6.4.1.cmml">​</mo><mrow id="S4.E9.m1.6.6.4.3.2" xref="S4.E9.m1.6.6.4.cmml"><mo stretchy="false" id="S4.E9.m1.6.6.4.3.2.1" xref="S4.E9.m1.6.6.4.cmml">(</mo><mi id="S4.E9.m1.3.3" xref="S4.E9.m1.3.3.cmml">𝒙</mi><mo stretchy="false" id="S4.E9.m1.6.6.4.3.2.2" xref="S4.E9.m1.6.6.4.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.6.6.3" xref="S4.E9.m1.6.6.3.cmml">=</mo><mrow id="S4.E9.m1.6.6.2" xref="S4.E9.m1.6.6.2.cmml"><mrow id="S4.E9.m1.5.5.1.1" xref="S4.E9.m1.5.5.1.1.cmml"><mrow id="S4.E9.m1.5.5.1.1.3" xref="S4.E9.m1.5.5.1.1.3.cmml"><mi id="S4.E9.m1.5.5.1.1.3.1" xref="S4.E9.m1.5.5.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E9.m1.5.5.1.1.3a" xref="S4.E9.m1.5.5.1.1.3.cmml">⁡</mo><msub id="S4.E9.m1.5.5.1.1.3.2" xref="S4.E9.m1.5.5.1.1.3.2.cmml"><mi id="S4.E9.m1.5.5.1.1.3.2.2" xref="S4.E9.m1.5.5.1.1.3.2.2.cmml">p</mi><mi id="S4.E9.m1.5.5.1.1.3.2.3" xref="S4.E9.m1.5.5.1.1.3.2.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.5.5.1.1.2" xref="S4.E9.m1.5.5.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.5.5.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.1.cmml"><mo id="S4.E9.m1.5.5.1.1.1.1.2" xref="S4.E9.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.5.5.1.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.1.cmml"><mi id="S4.E9.m1.5.5.1.1.1.1.1.2" xref="S4.E9.m1.5.5.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S4.E9.m1.5.5.1.1.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.1.1.cmml">∣</mo><msup id="S4.E9.m1.5.5.1.1.1.1.1.3" xref="S4.E9.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.5.5.1.1.1.1.1.3.2" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S4.E9.m1.5.5.1.1.1.1.1.3.3" xref="S4.E9.m1.5.5.1.1.1.1.1.3.3.cmml">s</mi></msup></mrow><mo id="S4.E9.m1.5.5.1.1.1.1.3" xref="S4.E9.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.6.6.2.3" xref="S4.E9.m1.6.6.2.3.cmml">−</mo><mrow id="S4.E9.m1.6.6.2.2" xref="S4.E9.m1.6.6.2.2.cmml"><msub id="S4.E9.m1.6.6.2.2.3" xref="S4.E9.m1.6.6.2.2.3.cmml"><mi id="S4.E9.m1.6.6.2.2.3.2" xref="S4.E9.m1.6.6.2.2.3.2.cmml">D</mi><mi id="S4.E9.m1.6.6.2.2.3.3" xref="S4.E9.m1.6.6.2.2.3.3.cmml">KL</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.6.6.2.2.2" xref="S4.E9.m1.6.6.2.2.2.cmml">​</mo><mrow id="S4.E9.m1.6.6.2.2.1.1" xref="S4.E9.m1.6.6.2.2.1.1.1.cmml"><mo id="S4.E9.m1.6.6.2.2.1.1.2" xref="S4.E9.m1.6.6.2.2.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.6.6.2.2.1.1.1" xref="S4.E9.m1.6.6.2.2.1.1.1.cmml"><mrow id="S4.E9.m1.6.6.2.2.1.1.1.1" xref="S4.E9.m1.6.6.2.2.1.1.1.1.cmml"><msub id="S4.E9.m1.6.6.2.2.1.1.1.1.3" xref="S4.E9.m1.6.6.2.2.1.1.1.1.3.cmml"><mi id="S4.E9.m1.6.6.2.2.1.1.1.1.3.2" xref="S4.E9.m1.6.6.2.2.1.1.1.1.3.2.cmml">q</mi><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E9.m1.6.6.2.2.1.1.1.1.3.3" xref="S4.E9.m1.6.6.2.2.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.6.6.2.2.1.1.1.1.2" xref="S4.E9.m1.6.6.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.2" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.2" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mo id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.1" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.3" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.3" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.6.6.2.2.1.1.1.2" xref="S4.E9.m1.6.6.2.2.1.1.1.2.cmml">∥</mo><mrow id="S4.E9.m1.6.6.2.2.1.1.1.3" xref="S4.E9.m1.6.6.2.2.1.1.1.3.cmml"><msub id="S4.E9.m1.6.6.2.2.1.1.1.3.2" xref="S4.E9.m1.6.6.2.2.1.1.1.3.2.cmml"><mi id="S4.E9.m1.6.6.2.2.1.1.1.3.2.2" xref="S4.E9.m1.6.6.2.2.1.1.1.3.2.2.cmml">p</mi><mi id="S4.E9.m1.6.6.2.2.1.1.1.3.2.3" xref="S4.E9.m1.6.6.2.2.1.1.1.3.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.6.6.2.2.1.1.1.3.1" xref="S4.E9.m1.6.6.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S4.E9.m1.6.6.2.2.1.1.1.3.3.2" xref="S4.E9.m1.6.6.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S4.E9.m1.6.6.2.2.1.1.1.3.3.2.1" xref="S4.E9.m1.6.6.2.2.1.1.1.3.cmml">(</mo><mi id="S4.E9.m1.4.4" xref="S4.E9.m1.4.4.cmml">𝒛</mi><mo stretchy="false" id="S4.E9.m1.6.6.2.2.1.1.1.3.3.2.2" xref="S4.E9.m1.6.6.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9.m1.6.6.2.2.1.1.3" xref="S4.E9.m1.6.6.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.6b"><apply id="S4.E9.m1.6.6.cmml" xref="S4.E9.m1.6.6"><eq id="S4.E9.m1.6.6.3.cmml" xref="S4.E9.m1.6.6.3"></eq><apply id="S4.E9.m1.6.6.4.cmml" xref="S4.E9.m1.6.6.4"><times id="S4.E9.m1.6.6.4.1.cmml" xref="S4.E9.m1.6.6.4.1"></times><apply id="S4.E9.m1.6.6.4.2.cmml" xref="S4.E9.m1.6.6.4.2"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.4.2.1.cmml" xref="S4.E9.m1.6.6.4.2">subscript</csymbol><ci id="S4.E9.m1.6.6.4.2.2.cmml" xref="S4.E9.m1.6.6.4.2.2">L</ci><list id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.4"><ci id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">𝜽</ci><ci id="S4.E9.m1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2">bold-italic-ϕ</ci></list></apply><ci id="S4.E9.m1.3.3.cmml" xref="S4.E9.m1.3.3">𝒙</ci></apply><apply id="S4.E9.m1.6.6.2.cmml" xref="S4.E9.m1.6.6.2"><minus id="S4.E9.m1.6.6.2.3.cmml" xref="S4.E9.m1.6.6.2.3"></minus><apply id="S4.E9.m1.5.5.1.1.cmml" xref="S4.E9.m1.5.5.1.1"><times id="S4.E9.m1.5.5.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1.2"></times><apply id="S4.E9.m1.5.5.1.1.3.cmml" xref="S4.E9.m1.5.5.1.1.3"><log id="S4.E9.m1.5.5.1.1.3.1.cmml" xref="S4.E9.m1.5.5.1.1.3.1"></log><apply id="S4.E9.m1.5.5.1.1.3.2.cmml" xref="S4.E9.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.3.2.1.cmml" xref="S4.E9.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.5.5.1.1.3.2.2.cmml" xref="S4.E9.m1.5.5.1.1.3.2.2">𝑝</ci><ci id="S4.E9.m1.5.5.1.1.3.2.3.cmml" xref="S4.E9.m1.5.5.1.1.3.2.3">𝜽</ci></apply></apply><apply id="S4.E9.m1.5.5.1.1.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E9.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.2">𝒙</ci><apply id="S4.E9.m1.5.5.1.1.1.1.1.3.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E9.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2">𝒛</ci><ci id="S4.E9.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply><apply id="S4.E9.m1.6.6.2.2.cmml" xref="S4.E9.m1.6.6.2.2"><times id="S4.E9.m1.6.6.2.2.2.cmml" xref="S4.E9.m1.6.6.2.2.2"></times><apply id="S4.E9.m1.6.6.2.2.3.cmml" xref="S4.E9.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.2.2.3.1.cmml" xref="S4.E9.m1.6.6.2.2.3">subscript</csymbol><ci id="S4.E9.m1.6.6.2.2.3.2.cmml" xref="S4.E9.m1.6.6.2.2.3.2">𝐷</ci><ci id="S4.E9.m1.6.6.2.2.3.3.cmml" xref="S4.E9.m1.6.6.2.2.3.3">KL</ci></apply><apply id="S4.E9.m1.6.6.2.2.1.1.1.cmml" xref="S4.E9.m1.6.6.2.2.1.1"><csymbol cd="latexml" id="S4.E9.m1.6.6.2.2.1.1.1.2.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.2">conditional</csymbol><apply id="S4.E9.m1.6.6.2.2.1.1.1.1.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.1"><times id="S4.E9.m1.6.6.2.2.1.1.1.1.2.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.1.2"></times><apply id="S4.E9.m1.6.6.2.2.1.1.1.1.3.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.2.2.1.1.1.1.3.1.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.6.6.2.2.1.1.1.1.3.2.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.1.3.2">𝑞</ci><ci id="S4.E9.m1.6.6.2.2.1.1.1.1.3.3.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.1.3.3">bold-italic-ϕ</ci></apply><apply id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.2">𝒛</ci><ci id="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.1.1.1.1.3">𝒙</ci></apply></apply><apply id="S4.E9.m1.6.6.2.2.1.1.1.3.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.3"><times id="S4.E9.m1.6.6.2.2.1.1.1.3.1.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.3.1"></times><apply id="S4.E9.m1.6.6.2.2.1.1.1.3.2.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.2.2.1.1.1.3.2.1.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.6.6.2.2.1.1.1.3.2.2.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.3.2.2">𝑝</ci><ci id="S4.E9.m1.6.6.2.2.1.1.1.3.2.3.cmml" xref="S4.E9.m1.6.6.2.2.1.1.1.3.2.3">𝜽</ci></apply><ci id="S4.E9.m1.4.4.cmml" xref="S4.E9.m1.4.4">𝒛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.6c">\mathrm{L}_{\boldsymbol{\theta},\boldsymbol{\phi}}(\boldsymbol{x})=\log p_{\boldsymbol{\theta}}\left(\boldsymbol{x}\mid\boldsymbol{z}^{s}\right)-D_{\mathrm{KL}}\left(q_{\boldsymbol{\phi}}(\boldsymbol{z}\mid\boldsymbol{x})\|p_{\boldsymbol{\theta}}(\boldsymbol{z})\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p6" class="ltx_para">
<p id="S4.p6.1" class="ltx_p">The ELBO for the entire dataset is the ELBO for a single datapoint scaled by the number of samples <math id="S4.p6.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.p6.1.m1.1a"><mi id="S4.p6.1.m1.1.1" xref="S4.p6.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p6.1.m1.1b"><ci id="S4.p6.1.m1.1.1.cmml" xref="S4.p6.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">N</annotation></semantics></math>:</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.6" class="ltx_Math" alttext="\mathrm{L}_{\boldsymbol{\theta},\phi}(\mathcal{D})=\frac{1}{N}\sum_{\boldsymbol{x}\in\mathcal{D}}\mathrm{L}_{\boldsymbol{\theta},\boldsymbol{\phi}}(\boldsymbol{x})" display="block"><semantics id="S4.E10.m1.6a"><mrow id="S4.E10.m1.6.7" xref="S4.E10.m1.6.7.cmml"><mrow id="S4.E10.m1.6.7.2" xref="S4.E10.m1.6.7.2.cmml"><msub id="S4.E10.m1.6.7.2.2" xref="S4.E10.m1.6.7.2.2.cmml"><mi mathvariant="normal" id="S4.E10.m1.6.7.2.2.2" xref="S4.E10.m1.6.7.2.2.2.cmml">L</mi><mrow id="S4.E10.m1.2.2.2.4" xref="S4.E10.m1.2.2.2.3.cmml"><mi id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml">𝜽</mi><mo id="S4.E10.m1.2.2.2.4.1" xref="S4.E10.m1.2.2.2.3.cmml">,</mo><mi id="S4.E10.m1.2.2.2.2" xref="S4.E10.m1.2.2.2.2.cmml">ϕ</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.6.7.2.1" xref="S4.E10.m1.6.7.2.1.cmml">​</mo><mrow id="S4.E10.m1.6.7.2.3.2" xref="S4.E10.m1.6.7.2.cmml"><mo stretchy="false" id="S4.E10.m1.6.7.2.3.2.1" xref="S4.E10.m1.6.7.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.5.5" xref="S4.E10.m1.5.5.cmml">𝒟</mi><mo stretchy="false" id="S4.E10.m1.6.7.2.3.2.2" xref="S4.E10.m1.6.7.2.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.6.7.1" xref="S4.E10.m1.6.7.1.cmml">=</mo><mrow id="S4.E10.m1.6.7.3" xref="S4.E10.m1.6.7.3.cmml"><mfrac id="S4.E10.m1.6.7.3.2" xref="S4.E10.m1.6.7.3.2.cmml"><mn id="S4.E10.m1.6.7.3.2.2" xref="S4.E10.m1.6.7.3.2.2.cmml">1</mn><mi id="S4.E10.m1.6.7.3.2.3" xref="S4.E10.m1.6.7.3.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E10.m1.6.7.3.1" xref="S4.E10.m1.6.7.3.1.cmml">​</mo><mrow id="S4.E10.m1.6.7.3.3" xref="S4.E10.m1.6.7.3.3.cmml"><munder id="S4.E10.m1.6.7.3.3.1" xref="S4.E10.m1.6.7.3.3.1.cmml"><mo movablelimits="false" id="S4.E10.m1.6.7.3.3.1.2" xref="S4.E10.m1.6.7.3.3.1.2.cmml">∑</mo><mrow id="S4.E10.m1.6.7.3.3.1.3" xref="S4.E10.m1.6.7.3.3.1.3.cmml"><mi id="S4.E10.m1.6.7.3.3.1.3.2" xref="S4.E10.m1.6.7.3.3.1.3.2.cmml">𝒙</mi><mo id="S4.E10.m1.6.7.3.3.1.3.1" xref="S4.E10.m1.6.7.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.6.7.3.3.1.3.3" xref="S4.E10.m1.6.7.3.3.1.3.3.cmml">𝒟</mi></mrow></munder><mrow id="S4.E10.m1.6.7.3.3.2" xref="S4.E10.m1.6.7.3.3.2.cmml"><msub id="S4.E10.m1.6.7.3.3.2.2" xref="S4.E10.m1.6.7.3.3.2.2.cmml"><mi mathvariant="normal" id="S4.E10.m1.6.7.3.3.2.2.2" xref="S4.E10.m1.6.7.3.3.2.2.2.cmml">L</mi><mrow id="S4.E10.m1.4.4.2.4" xref="S4.E10.m1.4.4.2.3.cmml"><mi id="S4.E10.m1.3.3.1.1" xref="S4.E10.m1.3.3.1.1.cmml">𝜽</mi><mo id="S4.E10.m1.4.4.2.4.1" xref="S4.E10.m1.4.4.2.3.cmml">,</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E10.m1.4.4.2.2" xref="S4.E10.m1.4.4.2.2.cmml">ϕ</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.6.7.3.3.2.1" xref="S4.E10.m1.6.7.3.3.2.1.cmml">​</mo><mrow id="S4.E10.m1.6.7.3.3.2.3.2" xref="S4.E10.m1.6.7.3.3.2.cmml"><mo stretchy="false" id="S4.E10.m1.6.7.3.3.2.3.2.1" xref="S4.E10.m1.6.7.3.3.2.cmml">(</mo><mi id="S4.E10.m1.6.6" xref="S4.E10.m1.6.6.cmml">𝒙</mi><mo stretchy="false" id="S4.E10.m1.6.7.3.3.2.3.2.2" xref="S4.E10.m1.6.7.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.6b"><apply id="S4.E10.m1.6.7.cmml" xref="S4.E10.m1.6.7"><eq id="S4.E10.m1.6.7.1.cmml" xref="S4.E10.m1.6.7.1"></eq><apply id="S4.E10.m1.6.7.2.cmml" xref="S4.E10.m1.6.7.2"><times id="S4.E10.m1.6.7.2.1.cmml" xref="S4.E10.m1.6.7.2.1"></times><apply id="S4.E10.m1.6.7.2.2.cmml" xref="S4.E10.m1.6.7.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.6.7.2.2.1.cmml" xref="S4.E10.m1.6.7.2.2">subscript</csymbol><ci id="S4.E10.m1.6.7.2.2.2.cmml" xref="S4.E10.m1.6.7.2.2.2">L</ci><list id="S4.E10.m1.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.4"><ci id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">𝜽</ci><ci id="S4.E10.m1.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2">italic-ϕ</ci></list></apply><ci id="S4.E10.m1.5.5.cmml" xref="S4.E10.m1.5.5">𝒟</ci></apply><apply id="S4.E10.m1.6.7.3.cmml" xref="S4.E10.m1.6.7.3"><times id="S4.E10.m1.6.7.3.1.cmml" xref="S4.E10.m1.6.7.3.1"></times><apply id="S4.E10.m1.6.7.3.2.cmml" xref="S4.E10.m1.6.7.3.2"><divide id="S4.E10.m1.6.7.3.2.1.cmml" xref="S4.E10.m1.6.7.3.2"></divide><cn type="integer" id="S4.E10.m1.6.7.3.2.2.cmml" xref="S4.E10.m1.6.7.3.2.2">1</cn><ci id="S4.E10.m1.6.7.3.2.3.cmml" xref="S4.E10.m1.6.7.3.2.3">𝑁</ci></apply><apply id="S4.E10.m1.6.7.3.3.cmml" xref="S4.E10.m1.6.7.3.3"><apply id="S4.E10.m1.6.7.3.3.1.cmml" xref="S4.E10.m1.6.7.3.3.1"><csymbol cd="ambiguous" id="S4.E10.m1.6.7.3.3.1.1.cmml" xref="S4.E10.m1.6.7.3.3.1">subscript</csymbol><sum id="S4.E10.m1.6.7.3.3.1.2.cmml" xref="S4.E10.m1.6.7.3.3.1.2"></sum><apply id="S4.E10.m1.6.7.3.3.1.3.cmml" xref="S4.E10.m1.6.7.3.3.1.3"><in id="S4.E10.m1.6.7.3.3.1.3.1.cmml" xref="S4.E10.m1.6.7.3.3.1.3.1"></in><ci id="S4.E10.m1.6.7.3.3.1.3.2.cmml" xref="S4.E10.m1.6.7.3.3.1.3.2">𝒙</ci><ci id="S4.E10.m1.6.7.3.3.1.3.3.cmml" xref="S4.E10.m1.6.7.3.3.1.3.3">𝒟</ci></apply></apply><apply id="S4.E10.m1.6.7.3.3.2.cmml" xref="S4.E10.m1.6.7.3.3.2"><times id="S4.E10.m1.6.7.3.3.2.1.cmml" xref="S4.E10.m1.6.7.3.3.2.1"></times><apply id="S4.E10.m1.6.7.3.3.2.2.cmml" xref="S4.E10.m1.6.7.3.3.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.6.7.3.3.2.2.1.cmml" xref="S4.E10.m1.6.7.3.3.2.2">subscript</csymbol><ci id="S4.E10.m1.6.7.3.3.2.2.2.cmml" xref="S4.E10.m1.6.7.3.3.2.2.2">L</ci><list id="S4.E10.m1.4.4.2.3.cmml" xref="S4.E10.m1.4.4.2.4"><ci id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1.1">𝜽</ci><ci id="S4.E10.m1.4.4.2.2.cmml" xref="S4.E10.m1.4.4.2.2">bold-italic-ϕ</ci></list></apply><ci id="S4.E10.m1.6.6.cmml" xref="S4.E10.m1.6.6">𝒙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.6c">\mathrm{L}_{\boldsymbol{\theta},\phi}(\mathcal{D})=\frac{1}{N}\sum_{\boldsymbol{x}\in\mathcal{D}}\mathrm{L}_{\boldsymbol{\theta},\boldsymbol{\phi}}(\boldsymbol{x})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.p6.3" class="ltx_p">Owing to the stochastic process inherent in the VAE (the latent vector is sampled and is not deterministic), a so-called reparameterization trick is employed to backpropagate gradients during training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx9" title="" class="ltx_ref">9</a>]</cite>. To assign the hyperparameters for the encoder and decoder, we make use of the findings in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx18" title="" class="ltx_ref">18</a>]</cite>, and loosely follow the AlexNet architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx10" title="" class="ltx_ref">10</a>]</cite>. Our proposed model architecture is as follows: The encoder applies a series of five convolutions and batch normalizations, before applying a leaky ReLU activation at each layer. The outputs of the encoder are flattened into two vectors, representing the mean and standard deviation of a Gaussian distribution, from which the latent vector is sampled. The latent space dimension <math id="S4.p6.2.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.p6.2.m1.1a"><mi id="S4.p6.2.m1.1.1" xref="S4.p6.2.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.p6.2.m1.1b"><ci id="S4.p6.2.m1.1.1.cmml" xref="S4.p6.2.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.2.m1.1c">d</annotation></semantics></math> is a hyperparameter that must be carefully tuned to adjust the model capacity, and ultimately the model reconstructions. We do not assign a value for <math id="S4.p6.3.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.p6.3.m2.1a"><mi id="S4.p6.3.m2.1.1" xref="S4.p6.3.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.p6.3.m2.1b"><ci id="S4.p6.3.m2.1.1.cmml" xref="S4.p6.3.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.3.m2.1c">d</annotation></semantics></math> upfront. Instead, we evaluate several models while varying this parameter. Qualitatively, we find that model reconstructions tend to be more blurry when reducing the latent dimensionality. The decoder is an inverse mapping of the encoder, with five transpose convolutional layers used to upsample the latent space to the original dimensions of the input image.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Datasets</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">To train the VAE, we make use of images gathered by <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">Nimbus</span> (see <a href="#S5.F2.sf1" title="In Figure 2 ‣ V Datasets ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a>), a hover-capable AUV developed by the University of Sydney’s Australian Centre for Field Robotics (ACFR).</p>
</div>
<figure id="S5.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/nimbus_pic.png" id="S5.F2.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="396" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/raw_images.png" id="S5.F2.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="249" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S5.F2.4.2" class="ltx_text" style="font-size:90%;"> (a) <span id="S5.F2.4.2.1" class="ltx_text ltx_font_italic">Nimbus</span> AUV being deployed at Jervis Bay, Australia; (b) Samples of inlier images with only natural features (top row) and outlier images which contain an artificial object (bottom row). </span></figcaption>
</figure>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">We focus on imagery acquired by the AUV at Jervis Bay, Australia in April 2021. The AUV was tasked with conducting a tight lawnmower survey pattern comprised of 1m spaced track lines. At a 2m altitude, this spacing allows for full coverage of the seafloor using the vehicle’s high-resolution stereo camera (2x5Mpx) with cross-track overlap of around 25%. The nominal 2m altitude acquires images of sufficient resolution for inspection and monitoring purposes. Following a preliminary survey of the site, an artificial anomalous ‘target’ was introduced into the environment. This comprised a 30cm x 30cm panel with a Ultra-Short Baseline (USBL) acoustic transponder mounted on it. The survey was then repeated. The raw 16-bit imagery is colour-corrected, debayered and down-sampled to 8-bit. Only 14 images are available with the artificial target captured within the frame. These are designated as outliers, and the remaining images are designated inliers. Samples of inlier and outlier images are shown in Fig. <a href="#S5.F2.sf2" title="In Figure 2 ‣ V Datasets ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a>. From the preliminary dive, 14616 inlier images were acquired. We split this dataset into 70%-30% subsets for training and validation respectively. From a separate dive on the same campaign, we use a dataset of 614 inlier images as a test set. We then append the outlier images to the test dataset, resulting in an outlier proportion of 2.2%.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.5.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.6.2" class="ltx_text ltx_font_italic">Model training</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">To fit the model to the inlier data, we iteratively adjust the model parameters by minimizing the ELBO formulated in Equation <a href="#S4.E10" title="In IV Variational Autoencoder ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>. The images are scaled down to a 64x80 resolution, and random horizontal and vertical flip transforms are applied to augment the data. We employ an early stopping routine in which training is halted if we observe more than three epochs without a decrease in validation loss. The model is trained at a learning rate of 1e-3 on the Adam optimizer.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Anomaly detection metrics</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Once a model is trained, we use it to generate anomaly detection metrics. As mentioned in section <a href="#S2" title="II Related work ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, a commonly employed method is to evaluate the reconstruction loss. The underlying assumption is that the model will be unable to reconstruct the anomalous image well, resulting in a high reconstruction error relative to inlier images that are well represented in the training dataset. The actual anomaly score is an L2 loss to which an empirical threshold is applied. In this section, we evaluate the suitability of the L2 loss as an anomaly detection metric. We also determine whether the performance of this metric is a function of latent dimensionality. To achieve this, we train nine models by varying the latent dimension size from 8-2048 and we evaluate each model on inlier and anomalous image samples.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS1.5.1.1" class="ltx_text">VI-A</span> </span><span id="S6.SS1.6.2" class="ltx_text ltx_font_italic">L2 Reconstruction error</span>
</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">After training the VAE, for each image in our test dataset, we compute the L2 loss between the input image and the model reconstruction. Fig. <a href="#S6.F3.sf1" title="In Figure 3 ‣ VI-A L2 Reconstruction error ‣ VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(a)</span></a> shows the histogram of L2 loss for a model of latent size 256. For an input image of 64x80, this represents a compression ratio of 20:1. The distributions for the inlier and anomalous image samples are shown. It is evident that the two distributions overlap to a large degree, and that any threshold we apply would result in a large number of missed-detections or false-alarms. We find that detection performance does not significantly improve as a function of latent dimensionality. Fig. <a href="#S6.F3.sf2" title="In Figure 3 ‣ VI-A L2 Reconstruction error ‣ VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(b)</span></a> shows the mean of the anomaly scores obtained by varying the size of the bottleneck. We observe that there is no appreciable increase in separation between the L2 loss for inliers and outliers regardless of the latent dimensionality.</p>
</div>
<figure id="S6.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S6.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/MSE_score_histogram.png" id="S6.F3.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="401" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S6.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/mse_plot.png" id="S6.F3.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="449" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F3.4.2.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S6.F3.2.1" class="ltx_text" style="font-size:90%;">L2 anomaly scores (a) Histogram of L2 loss for model with <math id="S6.F3.2.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S6.F3.2.1.m1.1b"><mi id="S6.F3.2.1.m1.1.1" xref="S6.F3.2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S6.F3.2.1.m1.1c"><ci id="S6.F3.2.1.m1.1.1.cmml" xref="S6.F3.2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.2.1.m1.1d">d</annotation></semantics></math>=256;(b) Mean L2 loss values for inlier and outlier images from our test dataset as a function of latent dimensionality</span></figcaption>
</figure>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.1" class="ltx_p">From this, we conclude that the approach of using an L2 loss as an anomaly score yields poor results for complex seafloor datasets in which there is a highly diverse set of habitats i.e. sand, kelp, and rocks. We find that when the object to be detected (the anomaly) occupies a small portion of the image, the reconstruction loss of the surrounding patch tends to blunt the anomaly score of the overall image.
On the other hand, if we visually inspect the squared-difference between the images and their reconstructions, the outlier images are readily distinguishable from the inliers.</p>
</div>
<figure id="S6.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S6.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/anomaly_score_no_object.png" id="S6.F4.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="274" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S6.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/contoured_anomaly_maps.png" id="S6.F4.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="385" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S6.F4.3.2" class="ltx_text" style="font-size:90%;">(a) Inlier images and their corresponding anomaly maps; (b) Outlier images(top row), anomaly maps(middle row),ROIs extracted from anomaly maps(bottom row)</span></figcaption>
</figure>
<div id="S6.SS1.p3" class="ltx_para">
<p id="S6.SS1.p3.1" class="ltx_p">Fig. <a href="#S6.F4" title="Figure 4 ‣ VI-A L2 Reconstruction error ‣ VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the anomaly heatmaps of inlier images and outlier images. To automate the search for outliers, we therefore adopt an approach based on segmenting regions of each anomaly heatmap corresponding to high reconstruction error.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS2.5.1.1" class="ltx_text">VI-B</span> </span><span id="S6.SS2.6.2" class="ltx_text ltx_font_italic">ROI extraction</span>
</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p">To generate the anomaly heatmap for each image, we compute the squared pixel-wise differences between the image and the corresponding reconstruction from the model. We extract a Region of Interest (ROI) for the anomaly heatmap in the following manner: A median blurring filter is applied to the heatmap before thresholding it to obtain a binary image. Erosion and dilation filters are to fill in small pits and other artefacts. This results in a binary image in which regions with high reconstruction error are prominently highlighted. Contours are extracted from the binary image and the area of each contour is computed. To exclude anomalous regions that are either too small or large relative to the object we are interested in detecting, lower and upper threshold values on the contour areas are applied. We apply these thresholds based on the expected size of the object to be detected. Given a known camera calibration and estimated vehicle altitude, the upper and lower size bounds of the object can be expressed in pixels. This additional contour-area criteria provides an additional means of discarding false-alarms. We use the term ’ROI anomaly score’ to refer to the anomaly score for this method. For images in which the contour area criteria is not met, we assign an anomaly score of zero. When the criteria is met, we designate the mean value of reconstruction error within the contour boundary as the anomaly score.</p>
</div>
<figure id="S6.F5" class="ltx_figure"><img src="/html/2306.04834/assets/ROI_score_histogram.png" id="S6.F5.g1" class="ltx_graphics ltx_img_landscape" width="509" height="334" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S6.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S6.F5.3.2" class="ltx_text" style="font-size:90%;">Distributions of ROI anomaly scores for the inlier and anomalous image classes</span></figcaption>
</figure>
<div id="S6.SS2.p2" class="ltx_para">
<p id="S6.SS2.p2.1" class="ltx_p">The distribution of ROI-based anomaly scores is shown in Fig. <a href="#S6.F5" title="Figure 5 ‣ VI-B ROI extraction ‣ VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. By applying this method to the test dataset, we are able to achieve a much larger degree of separation (relative to the previously shown L2 score) between the inliers and anomalous outliers.</p>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS3.5.1.1" class="ltx_text">VI-C</span> </span><span id="S6.SS3.6.2" class="ltx_text ltx_font_italic">Latent space clustering</span>
</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.3" class="ltx_p">We analyze the latent spaces of the test set on our trained models. As we stated previously in <a href="#S6" title="VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>, we have nine models, obtained by increasing the latent space dimensionality <math id="S6.SS3.p1.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S6.SS3.p1.1.m1.1a"><mi id="S6.SS3.p1.1.m1.1.1" xref="S6.SS3.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.1.m1.1b"><ci id="S6.SS3.p1.1.m1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.1.m1.1c">d</annotation></semantics></math> in 2x increments between <math id="S6.SS3.p1.2.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S6.SS3.p1.2.m2.1a"><mi id="S6.SS3.p1.2.m2.1.1" xref="S6.SS3.p1.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.2.m2.1b"><ci id="S6.SS3.p1.2.m2.1.1.cmml" xref="S6.SS3.p1.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.2.m2.1c">d</annotation></semantics></math>=8 and <math id="S6.SS3.p1.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S6.SS3.p1.3.m3.1a"><mi id="S6.SS3.p1.3.m3.1.1" xref="S6.SS3.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.3.m3.1b"><ci id="S6.SS3.p1.3.m3.1.1.cmml" xref="S6.SS3.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.3.m3.1c">d</annotation></semantics></math>=2048.</p>
</div>
<figure id="S6.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S6.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/latent_space_plot_cluster.png" id="S6.F6.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="399" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F6.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S6.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/kde_plot_testdata.png" id="S6.F6.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="397" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F6.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S6.F6.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/kde_score_histogram.png" id="S6.F6.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="390" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F6.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S6.F6.3.2" class="ltx_text" style="font-size:90%;">Latent space density estimation and clustering(a) Clustering using DBSCAN. The plot shows the obtained clusters and noise points(black). The anomalies are highlighted with a bold red outline; (b) A KDE fitted on the data. The anomalies are in red; (c) Histogram of densities from the fitted model. The chosen 80th-percentile threshold value is shown;</span></figcaption>
</figure>
<div id="S6.SS3.p2" class="ltx_para">
<p id="S6.SS3.p2.14" class="ltx_p">To reduce computational overhead due to the curse of dimensionality, and to simplify visualization, we reduce the dimensions to <math id="S6.SS3.p2.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S6.SS3.p2.1.m1.1a"><mi id="S6.SS3.p2.1.m1.1.1" xref="S6.SS3.p2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.1.m1.1b"><ci id="S6.SS3.p2.1.m1.1.1.cmml" xref="S6.SS3.p2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.1.m1.1c">d</annotation></semantics></math> = 2. We choose t-Stochastic Neighbour Embedding (t-SNE) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx17" title="" class="ltx_ref">17</a>]</cite> to arrive at a mapping from high-dimensional latent space to a 2D representation. Our anomaly detection method is based on the key observation that the anomalous outlier images tend to gather in the low-density regions of the embedding. This lends itself well to density-based clustering algorithms.
We evaluated the suitability of two algorithms to isolate the low density regions of the embedding. First, we apply Density-based spatial clustering of applications with noise (DBSCAN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx4" title="" class="ltx_ref">4</a>]</cite> to the test data.
DBSCAN requires two parameters to be supplied by the user: Epsilon (<math id="S6.SS3.p2.2.m2.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S6.SS3.p2.2.m2.1a"><mi id="S6.SS3.p2.2.m2.1.1" xref="S6.SS3.p2.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.2.m2.1b"><ci id="S6.SS3.p2.2.m2.1.1.cmml" xref="S6.SS3.p2.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.2.m2.1c">\epsilon</annotation></semantics></math>), the value of the radius that defines the neighborhood around each data point, and the minimum number of data points required in a neighborhood (<math id="S6.SS3.p2.3.m3.1" class="ltx_Math" alttext="n_{n}" display="inline"><semantics id="S6.SS3.p2.3.m3.1a"><msub id="S6.SS3.p2.3.m3.1.1" xref="S6.SS3.p2.3.m3.1.1.cmml"><mi id="S6.SS3.p2.3.m3.1.1.2" xref="S6.SS3.p2.3.m3.1.1.2.cmml">n</mi><mi id="S6.SS3.p2.3.m3.1.1.3" xref="S6.SS3.p2.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.3.m3.1b"><apply id="S6.SS3.p2.3.m3.1.1.cmml" xref="S6.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.3.m3.1.1.1.cmml" xref="S6.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S6.SS3.p2.3.m3.1.1.2.cmml" xref="S6.SS3.p2.3.m3.1.1.2">𝑛</ci><ci id="S6.SS3.p2.3.m3.1.1.3.cmml" xref="S6.SS3.p2.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.3.m3.1c">n_{n}</annotation></semantics></math>). DBSCAN classifies data points into three categories: Core points, border points and noise points. Core points have at least <math id="S6.SS3.p2.4.m4.1" class="ltx_Math" alttext="n_{n}" display="inline"><semantics id="S6.SS3.p2.4.m4.1a"><msub id="S6.SS3.p2.4.m4.1.1" xref="S6.SS3.p2.4.m4.1.1.cmml"><mi id="S6.SS3.p2.4.m4.1.1.2" xref="S6.SS3.p2.4.m4.1.1.2.cmml">n</mi><mi id="S6.SS3.p2.4.m4.1.1.3" xref="S6.SS3.p2.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.4.m4.1b"><apply id="S6.SS3.p2.4.m4.1.1.cmml" xref="S6.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.4.m4.1.1.1.cmml" xref="S6.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S6.SS3.p2.4.m4.1.1.2.cmml" xref="S6.SS3.p2.4.m4.1.1.2">𝑛</ci><ci id="S6.SS3.p2.4.m4.1.1.3.cmml" xref="S6.SS3.p2.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.4.m4.1c">n_{n}</annotation></semantics></math> data points within a neighborhood of radius <math id="S6.SS3.p2.5.m5.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S6.SS3.p2.5.m5.1a"><mi id="S6.SS3.p2.5.m5.1.1" xref="S6.SS3.p2.5.m5.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.5.m5.1b"><ci id="S6.SS3.p2.5.m5.1.1.cmml" xref="S6.SS3.p2.5.m5.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.5.m5.1c">\epsilon</annotation></semantics></math>; Border points have less than <math id="S6.SS3.p2.6.m6.1" class="ltx_Math" alttext="n_{n}" display="inline"><semantics id="S6.SS3.p2.6.m6.1a"><msub id="S6.SS3.p2.6.m6.1.1" xref="S6.SS3.p2.6.m6.1.1.cmml"><mi id="S6.SS3.p2.6.m6.1.1.2" xref="S6.SS3.p2.6.m6.1.1.2.cmml">n</mi><mi id="S6.SS3.p2.6.m6.1.1.3" xref="S6.SS3.p2.6.m6.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.6.m6.1b"><apply id="S6.SS3.p2.6.m6.1.1.cmml" xref="S6.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.6.m6.1.1.1.cmml" xref="S6.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S6.SS3.p2.6.m6.1.1.2.cmml" xref="S6.SS3.p2.6.m6.1.1.2">𝑛</ci><ci id="S6.SS3.p2.6.m6.1.1.3.cmml" xref="S6.SS3.p2.6.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.6.m6.1c">n_{n}</annotation></semantics></math> neighbours, but at least one core point in its neighborhood; Noise points are neither core nor border points. We use the following two well-established rules-of-thumb to assign values for <math id="S6.SS3.p2.7.m7.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S6.SS3.p2.7.m7.1a"><mi id="S6.SS3.p2.7.m7.1.1" xref="S6.SS3.p2.7.m7.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.7.m7.1b"><ci id="S6.SS3.p2.7.m7.1.1.cmml" xref="S6.SS3.p2.7.m7.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.7.m7.1c">\epsilon</annotation></semantics></math> and <math id="S6.SS3.p2.8.m8.1" class="ltx_Math" alttext="n_{n}" display="inline"><semantics id="S6.SS3.p2.8.m8.1a"><msub id="S6.SS3.p2.8.m8.1.1" xref="S6.SS3.p2.8.m8.1.1.cmml"><mi id="S6.SS3.p2.8.m8.1.1.2" xref="S6.SS3.p2.8.m8.1.1.2.cmml">n</mi><mi id="S6.SS3.p2.8.m8.1.1.3" xref="S6.SS3.p2.8.m8.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.8.m8.1b"><apply id="S6.SS3.p2.8.m8.1.1.cmml" xref="S6.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.8.m8.1.1.1.cmml" xref="S6.SS3.p2.8.m8.1.1">subscript</csymbol><ci id="S6.SS3.p2.8.m8.1.1.2.cmml" xref="S6.SS3.p2.8.m8.1.1.2">𝑛</ci><ci id="S6.SS3.p2.8.m8.1.1.3.cmml" xref="S6.SS3.p2.8.m8.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.8.m8.1c">n_{n}</annotation></semantics></math>: We assign <math id="S6.SS3.p2.9.m9.1" class="ltx_Math" alttext="n_{n}" display="inline"><semantics id="S6.SS3.p2.9.m9.1a"><msub id="S6.SS3.p2.9.m9.1.1" xref="S6.SS3.p2.9.m9.1.1.cmml"><mi id="S6.SS3.p2.9.m9.1.1.2" xref="S6.SS3.p2.9.m9.1.1.2.cmml">n</mi><mi id="S6.SS3.p2.9.m9.1.1.3" xref="S6.SS3.p2.9.m9.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.9.m9.1b"><apply id="S6.SS3.p2.9.m9.1.1.cmml" xref="S6.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.9.m9.1.1.1.cmml" xref="S6.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S6.SS3.p2.9.m9.1.1.2.cmml" xref="S6.SS3.p2.9.m9.1.1.2">𝑛</ci><ci id="S6.SS3.p2.9.m9.1.1.3.cmml" xref="S6.SS3.p2.9.m9.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.9.m9.1c">n_{n}</annotation></semantics></math> as 2x<math id="S6.SS3.p2.10.m10.1" class="ltx_Math" alttext="d_{r}" display="inline"><semantics id="S6.SS3.p2.10.m10.1a"><msub id="S6.SS3.p2.10.m10.1.1" xref="S6.SS3.p2.10.m10.1.1.cmml"><mi id="S6.SS3.p2.10.m10.1.1.2" xref="S6.SS3.p2.10.m10.1.1.2.cmml">d</mi><mi id="S6.SS3.p2.10.m10.1.1.3" xref="S6.SS3.p2.10.m10.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.10.m10.1b"><apply id="S6.SS3.p2.10.m10.1.1.cmml" xref="S6.SS3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.10.m10.1.1.1.cmml" xref="S6.SS3.p2.10.m10.1.1">subscript</csymbol><ci id="S6.SS3.p2.10.m10.1.1.2.cmml" xref="S6.SS3.p2.10.m10.1.1.2">𝑑</ci><ci id="S6.SS3.p2.10.m10.1.1.3.cmml" xref="S6.SS3.p2.10.m10.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.10.m10.1c">d_{r}</annotation></semantics></math>, where <math id="S6.SS3.p2.11.m11.1" class="ltx_Math" alttext="d_{r}" display="inline"><semantics id="S6.SS3.p2.11.m11.1a"><msub id="S6.SS3.p2.11.m11.1.1" xref="S6.SS3.p2.11.m11.1.1.cmml"><mi id="S6.SS3.p2.11.m11.1.1.2" xref="S6.SS3.p2.11.m11.1.1.2.cmml">d</mi><mi id="S6.SS3.p2.11.m11.1.1.3" xref="S6.SS3.p2.11.m11.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.11.m11.1b"><apply id="S6.SS3.p2.11.m11.1.1.cmml" xref="S6.SS3.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.11.m11.1.1.1.cmml" xref="S6.SS3.p2.11.m11.1.1">subscript</csymbol><ci id="S6.SS3.p2.11.m11.1.1.2.cmml" xref="S6.SS3.p2.11.m11.1.1.2">𝑑</ci><ci id="S6.SS3.p2.11.m11.1.1.3.cmml" xref="S6.SS3.p2.11.m11.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.11.m11.1c">d_{r}</annotation></semantics></math> is the reduced number of dimensions of our dataset. To determine an optimal value of <math id="S6.SS3.p2.12.m12.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S6.SS3.p2.12.m12.1a"><mi id="S6.SS3.p2.12.m12.1.1" xref="S6.SS3.p2.12.m12.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.12.m12.1b"><ci id="S6.SS3.p2.12.m12.1.1.cmml" xref="S6.SS3.p2.12.m12.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.12.m12.1c">\epsilon</annotation></semantics></math>, we find the so-called elbow of a k-distance plot as described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx13" title="" class="ltx_ref">13</a>]</cite>.
Fig. <a href="#S6.F6.sf1" title="In Figure 6 ‣ VI-C Latent space clustering ‣ VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6(a)</span></a> shows the resulting clusters on the test data when we use a model with <math id="S6.SS3.p2.13.m13.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S6.SS3.p2.13.m13.1a"><mi id="S6.SS3.p2.13.m13.1.1" xref="S6.SS3.p2.13.m13.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.13.m13.1b"><ci id="S6.SS3.p2.13.m13.1.1.cmml" xref="S6.SS3.p2.13.m13.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.13.m13.1c">d</annotation></semantics></math>=256. The algorithm assigns 425 datapoints to one of 8 clusters. The remaining 203 datapoints that are not members of any cluster are designated as noise points. As intended, we are able to significantly reduce the search-space of images for an operator to visually inspect. The outlier images tend to gather in the low density regions and can be isolated from the dense inlier regions. Although this approach yields positive results, we note a few shortcomings. We are required to tune two parameters, neither of which have any physically meaningful interpretation to the operator. Furthermore, points can be assigned to only two binary categories. We would instead prefer to obtain a probabilistic score in which the operator can assign a meaningful threshold. This would readily allow an outlier to be flagged based on statistical hypothesis tests. We therefore choose to apply Kernel Density Estimation (KDE) to fit a distribution to our dimensionally-reduced data.
For real values of our data <math id="S6.SS3.p2.14.m14.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S6.SS3.p2.14.m14.1a"><mi id="S6.SS3.p2.14.m14.1.1" xref="S6.SS3.p2.14.m14.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.14.m14.1b"><ci id="S6.SS3.p2.14.m14.1.1.cmml" xref="S6.SS3.p2.14.m14.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.14.m14.1c">x</annotation></semantics></math>, the kernel density estimator is defined as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx15" title="" class="ltx_ref">15</a>]</cite>:</p>
<table id="S6.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S6.E11.m1.2" class="ltx_Math" alttext="\widehat{f}_{h}(x)=\frac{1}{Nh}\sum_{i=1}^{N}K\left(\frac{x-x_{i}}{h}\right)" display="block"><semantics id="S6.E11.m1.2a"><mrow id="S6.E11.m1.2.3" xref="S6.E11.m1.2.3.cmml"><mrow id="S6.E11.m1.2.3.2" xref="S6.E11.m1.2.3.2.cmml"><msub id="S6.E11.m1.2.3.2.2" xref="S6.E11.m1.2.3.2.2.cmml"><mover accent="true" id="S6.E11.m1.2.3.2.2.2" xref="S6.E11.m1.2.3.2.2.2.cmml"><mi id="S6.E11.m1.2.3.2.2.2.2" xref="S6.E11.m1.2.3.2.2.2.2.cmml">f</mi><mo id="S6.E11.m1.2.3.2.2.2.1" xref="S6.E11.m1.2.3.2.2.2.1.cmml">^</mo></mover><mi id="S6.E11.m1.2.3.2.2.3" xref="S6.E11.m1.2.3.2.2.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="S6.E11.m1.2.3.2.1" xref="S6.E11.m1.2.3.2.1.cmml">​</mo><mrow id="S6.E11.m1.2.3.2.3.2" xref="S6.E11.m1.2.3.2.cmml"><mo stretchy="false" id="S6.E11.m1.2.3.2.3.2.1" xref="S6.E11.m1.2.3.2.cmml">(</mo><mi id="S6.E11.m1.1.1" xref="S6.E11.m1.1.1.cmml">x</mi><mo stretchy="false" id="S6.E11.m1.2.3.2.3.2.2" xref="S6.E11.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="S6.E11.m1.2.3.1" xref="S6.E11.m1.2.3.1.cmml">=</mo><mrow id="S6.E11.m1.2.3.3" xref="S6.E11.m1.2.3.3.cmml"><mfrac id="S6.E11.m1.2.3.3.2" xref="S6.E11.m1.2.3.3.2.cmml"><mn id="S6.E11.m1.2.3.3.2.2" xref="S6.E11.m1.2.3.3.2.2.cmml">1</mn><mrow id="S6.E11.m1.2.3.3.2.3" xref="S6.E11.m1.2.3.3.2.3.cmml"><mi id="S6.E11.m1.2.3.3.2.3.2" xref="S6.E11.m1.2.3.3.2.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S6.E11.m1.2.3.3.2.3.1" xref="S6.E11.m1.2.3.3.2.3.1.cmml">​</mo><mi id="S6.E11.m1.2.3.3.2.3.3" xref="S6.E11.m1.2.3.3.2.3.3.cmml">h</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="S6.E11.m1.2.3.3.1" xref="S6.E11.m1.2.3.3.1.cmml">​</mo><mrow id="S6.E11.m1.2.3.3.3" xref="S6.E11.m1.2.3.3.3.cmml"><munderover id="S6.E11.m1.2.3.3.3.1" xref="S6.E11.m1.2.3.3.3.1.cmml"><mo movablelimits="false" id="S6.E11.m1.2.3.3.3.1.2.2" xref="S6.E11.m1.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S6.E11.m1.2.3.3.3.1.2.3" xref="S6.E11.m1.2.3.3.3.1.2.3.cmml"><mi id="S6.E11.m1.2.3.3.3.1.2.3.2" xref="S6.E11.m1.2.3.3.3.1.2.3.2.cmml">i</mi><mo id="S6.E11.m1.2.3.3.3.1.2.3.1" xref="S6.E11.m1.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S6.E11.m1.2.3.3.3.1.2.3.3" xref="S6.E11.m1.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S6.E11.m1.2.3.3.3.1.3" xref="S6.E11.m1.2.3.3.3.1.3.cmml">N</mi></munderover><mrow id="S6.E11.m1.2.3.3.3.2" xref="S6.E11.m1.2.3.3.3.2.cmml"><mi id="S6.E11.m1.2.3.3.3.2.2" xref="S6.E11.m1.2.3.3.3.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S6.E11.m1.2.3.3.3.2.1" xref="S6.E11.m1.2.3.3.3.2.1.cmml">​</mo><mrow id="S6.E11.m1.2.3.3.3.2.3.2" xref="S6.E11.m1.2.2.cmml"><mo id="S6.E11.m1.2.3.3.3.2.3.2.1" xref="S6.E11.m1.2.2.cmml">(</mo><mfrac id="S6.E11.m1.2.2" xref="S6.E11.m1.2.2.cmml"><mrow id="S6.E11.m1.2.2.2" xref="S6.E11.m1.2.2.2.cmml"><mi id="S6.E11.m1.2.2.2.2" xref="S6.E11.m1.2.2.2.2.cmml">x</mi><mo id="S6.E11.m1.2.2.2.1" xref="S6.E11.m1.2.2.2.1.cmml">−</mo><msub id="S6.E11.m1.2.2.2.3" xref="S6.E11.m1.2.2.2.3.cmml"><mi id="S6.E11.m1.2.2.2.3.2" xref="S6.E11.m1.2.2.2.3.2.cmml">x</mi><mi id="S6.E11.m1.2.2.2.3.3" xref="S6.E11.m1.2.2.2.3.3.cmml">i</mi></msub></mrow><mi id="S6.E11.m1.2.2.3" xref="S6.E11.m1.2.2.3.cmml">h</mi></mfrac><mo id="S6.E11.m1.2.3.3.3.2.3.2.2" xref="S6.E11.m1.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E11.m1.2b"><apply id="S6.E11.m1.2.3.cmml" xref="S6.E11.m1.2.3"><eq id="S6.E11.m1.2.3.1.cmml" xref="S6.E11.m1.2.3.1"></eq><apply id="S6.E11.m1.2.3.2.cmml" xref="S6.E11.m1.2.3.2"><times id="S6.E11.m1.2.3.2.1.cmml" xref="S6.E11.m1.2.3.2.1"></times><apply id="S6.E11.m1.2.3.2.2.cmml" xref="S6.E11.m1.2.3.2.2"><csymbol cd="ambiguous" id="S6.E11.m1.2.3.2.2.1.cmml" xref="S6.E11.m1.2.3.2.2">subscript</csymbol><apply id="S6.E11.m1.2.3.2.2.2.cmml" xref="S6.E11.m1.2.3.2.2.2"><ci id="S6.E11.m1.2.3.2.2.2.1.cmml" xref="S6.E11.m1.2.3.2.2.2.1">^</ci><ci id="S6.E11.m1.2.3.2.2.2.2.cmml" xref="S6.E11.m1.2.3.2.2.2.2">𝑓</ci></apply><ci id="S6.E11.m1.2.3.2.2.3.cmml" xref="S6.E11.m1.2.3.2.2.3">ℎ</ci></apply><ci id="S6.E11.m1.1.1.cmml" xref="S6.E11.m1.1.1">𝑥</ci></apply><apply id="S6.E11.m1.2.3.3.cmml" xref="S6.E11.m1.2.3.3"><times id="S6.E11.m1.2.3.3.1.cmml" xref="S6.E11.m1.2.3.3.1"></times><apply id="S6.E11.m1.2.3.3.2.cmml" xref="S6.E11.m1.2.3.3.2"><divide id="S6.E11.m1.2.3.3.2.1.cmml" xref="S6.E11.m1.2.3.3.2"></divide><cn type="integer" id="S6.E11.m1.2.3.3.2.2.cmml" xref="S6.E11.m1.2.3.3.2.2">1</cn><apply id="S6.E11.m1.2.3.3.2.3.cmml" xref="S6.E11.m1.2.3.3.2.3"><times id="S6.E11.m1.2.3.3.2.3.1.cmml" xref="S6.E11.m1.2.3.3.2.3.1"></times><ci id="S6.E11.m1.2.3.3.2.3.2.cmml" xref="S6.E11.m1.2.3.3.2.3.2">𝑁</ci><ci id="S6.E11.m1.2.3.3.2.3.3.cmml" xref="S6.E11.m1.2.3.3.2.3.3">ℎ</ci></apply></apply><apply id="S6.E11.m1.2.3.3.3.cmml" xref="S6.E11.m1.2.3.3.3"><apply id="S6.E11.m1.2.3.3.3.1.cmml" xref="S6.E11.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S6.E11.m1.2.3.3.3.1.1.cmml" xref="S6.E11.m1.2.3.3.3.1">superscript</csymbol><apply id="S6.E11.m1.2.3.3.3.1.2.cmml" xref="S6.E11.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S6.E11.m1.2.3.3.3.1.2.1.cmml" xref="S6.E11.m1.2.3.3.3.1">subscript</csymbol><sum id="S6.E11.m1.2.3.3.3.1.2.2.cmml" xref="S6.E11.m1.2.3.3.3.1.2.2"></sum><apply id="S6.E11.m1.2.3.3.3.1.2.3.cmml" xref="S6.E11.m1.2.3.3.3.1.2.3"><eq id="S6.E11.m1.2.3.3.3.1.2.3.1.cmml" xref="S6.E11.m1.2.3.3.3.1.2.3.1"></eq><ci id="S6.E11.m1.2.3.3.3.1.2.3.2.cmml" xref="S6.E11.m1.2.3.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S6.E11.m1.2.3.3.3.1.2.3.3.cmml" xref="S6.E11.m1.2.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S6.E11.m1.2.3.3.3.1.3.cmml" xref="S6.E11.m1.2.3.3.3.1.3">𝑁</ci></apply><apply id="S6.E11.m1.2.3.3.3.2.cmml" xref="S6.E11.m1.2.3.3.3.2"><times id="S6.E11.m1.2.3.3.3.2.1.cmml" xref="S6.E11.m1.2.3.3.3.2.1"></times><ci id="S6.E11.m1.2.3.3.3.2.2.cmml" xref="S6.E11.m1.2.3.3.3.2.2">𝐾</ci><apply id="S6.E11.m1.2.2.cmml" xref="S6.E11.m1.2.3.3.3.2.3.2"><divide id="S6.E11.m1.2.2.1.cmml" xref="S6.E11.m1.2.3.3.3.2.3.2"></divide><apply id="S6.E11.m1.2.2.2.cmml" xref="S6.E11.m1.2.2.2"><minus id="S6.E11.m1.2.2.2.1.cmml" xref="S6.E11.m1.2.2.2.1"></minus><ci id="S6.E11.m1.2.2.2.2.cmml" xref="S6.E11.m1.2.2.2.2">𝑥</ci><apply id="S6.E11.m1.2.2.2.3.cmml" xref="S6.E11.m1.2.2.2.3"><csymbol cd="ambiguous" id="S6.E11.m1.2.2.2.3.1.cmml" xref="S6.E11.m1.2.2.2.3">subscript</csymbol><ci id="S6.E11.m1.2.2.2.3.2.cmml" xref="S6.E11.m1.2.2.2.3.2">𝑥</ci><ci id="S6.E11.m1.2.2.2.3.3.cmml" xref="S6.E11.m1.2.2.2.3.3">𝑖</ci></apply></apply><ci id="S6.E11.m1.2.2.3.cmml" xref="S6.E11.m1.2.2.3">ℎ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E11.m1.2c">\widehat{f}_{h}(x)=\frac{1}{Nh}\sum_{i=1}^{N}K\left(\frac{x-x_{i}}{h}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S6.SS3.p2.18" class="ltx_p">where <math id="S6.SS3.p2.15.m1.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S6.SS3.p2.15.m1.1a"><msub id="S6.SS3.p2.15.m1.1.1" xref="S6.SS3.p2.15.m1.1.1.cmml"><mi id="S6.SS3.p2.15.m1.1.1.2" xref="S6.SS3.p2.15.m1.1.1.2.cmml">x</mi><mi id="S6.SS3.p2.15.m1.1.1.3" xref="S6.SS3.p2.15.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.15.m1.1b"><apply id="S6.SS3.p2.15.m1.1.1.cmml" xref="S6.SS3.p2.15.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.15.m1.1.1.1.cmml" xref="S6.SS3.p2.15.m1.1.1">subscript</csymbol><ci id="S6.SS3.p2.15.m1.1.1.2.cmml" xref="S6.SS3.p2.15.m1.1.1.2">𝑥</ci><ci id="S6.SS3.p2.15.m1.1.1.3.cmml" xref="S6.SS3.p2.15.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.15.m1.1c">x_{i}</annotation></semantics></math> are random samples from an unknown distribution. <math id="S6.SS3.p2.16.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S6.SS3.p2.16.m2.1a"><mi id="S6.SS3.p2.16.m2.1.1" xref="S6.SS3.p2.16.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.16.m2.1b"><ci id="S6.SS3.p2.16.m2.1.1.cmml" xref="S6.SS3.p2.16.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.16.m2.1c">N</annotation></semantics></math> is the number of samples, <math id="S6.SS3.p2.17.m3.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S6.SS3.p2.17.m3.1a"><mi id="S6.SS3.p2.17.m3.1.1" xref="S6.SS3.p2.17.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.17.m3.1b"><ci id="S6.SS3.p2.17.m3.1.1.cmml" xref="S6.SS3.p2.17.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.17.m3.1c">h</annotation></semantics></math> is the bandwidth, and <math id="S6.SS3.p2.18.m4.1" class="ltx_math_unparsed" alttext="K(.)" display="inline"><semantics id="S6.SS3.p2.18.m4.1a"><mrow id="S6.SS3.p2.18.m4.1b"><mi id="S6.SS3.p2.18.m4.1.1">K</mi><mrow id="S6.SS3.p2.18.m4.1.2"><mo stretchy="false" id="S6.SS3.p2.18.m4.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S6.SS3.p2.18.m4.1.2.2">.</mo><mo stretchy="false" id="S6.SS3.p2.18.m4.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S6.SS3.p2.18.m4.1c">K(.)</annotation></semantics></math> is the kernel function, which we choose to be Gaussian:</p>
<table id="S6.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S6.E12.m1.1" class="ltx_Math" alttext="K(u)=\frac{1}{\sqrt{2\pi}}e^{\frac{-u^{2}}{2}}" display="block"><semantics id="S6.E12.m1.1a"><mrow id="S6.E12.m1.1.2" xref="S6.E12.m1.1.2.cmml"><mrow id="S6.E12.m1.1.2.2" xref="S6.E12.m1.1.2.2.cmml"><mi id="S6.E12.m1.1.2.2.2" xref="S6.E12.m1.1.2.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S6.E12.m1.1.2.2.1" xref="S6.E12.m1.1.2.2.1.cmml">​</mo><mrow id="S6.E12.m1.1.2.2.3.2" xref="S6.E12.m1.1.2.2.cmml"><mo stretchy="false" id="S6.E12.m1.1.2.2.3.2.1" xref="S6.E12.m1.1.2.2.cmml">(</mo><mi id="S6.E12.m1.1.1" xref="S6.E12.m1.1.1.cmml">u</mi><mo stretchy="false" id="S6.E12.m1.1.2.2.3.2.2" xref="S6.E12.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S6.E12.m1.1.2.1" xref="S6.E12.m1.1.2.1.cmml">=</mo><mrow id="S6.E12.m1.1.2.3" xref="S6.E12.m1.1.2.3.cmml"><mfrac id="S6.E12.m1.1.2.3.2" xref="S6.E12.m1.1.2.3.2.cmml"><mn id="S6.E12.m1.1.2.3.2.2" xref="S6.E12.m1.1.2.3.2.2.cmml">1</mn><msqrt id="S6.E12.m1.1.2.3.2.3" xref="S6.E12.m1.1.2.3.2.3.cmml"><mrow id="S6.E12.m1.1.2.3.2.3.2" xref="S6.E12.m1.1.2.3.2.3.2.cmml"><mn id="S6.E12.m1.1.2.3.2.3.2.2" xref="S6.E12.m1.1.2.3.2.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S6.E12.m1.1.2.3.2.3.2.1" xref="S6.E12.m1.1.2.3.2.3.2.1.cmml">​</mo><mi id="S6.E12.m1.1.2.3.2.3.2.3" xref="S6.E12.m1.1.2.3.2.3.2.3.cmml">π</mi></mrow></msqrt></mfrac><mo lspace="0em" rspace="0em" id="S6.E12.m1.1.2.3.1" xref="S6.E12.m1.1.2.3.1.cmml">​</mo><msup id="S6.E12.m1.1.2.3.3" xref="S6.E12.m1.1.2.3.3.cmml"><mi id="S6.E12.m1.1.2.3.3.2" xref="S6.E12.m1.1.2.3.3.2.cmml">e</mi><mfrac id="S6.E12.m1.1.2.3.3.3" xref="S6.E12.m1.1.2.3.3.3.cmml"><mrow id="S6.E12.m1.1.2.3.3.3.2" xref="S6.E12.m1.1.2.3.3.3.2.cmml"><mo id="S6.E12.m1.1.2.3.3.3.2a" xref="S6.E12.m1.1.2.3.3.3.2.cmml">−</mo><msup id="S6.E12.m1.1.2.3.3.3.2.2" xref="S6.E12.m1.1.2.3.3.3.2.2.cmml"><mi id="S6.E12.m1.1.2.3.3.3.2.2.2" xref="S6.E12.m1.1.2.3.3.3.2.2.2.cmml">u</mi><mn id="S6.E12.m1.1.2.3.3.3.2.2.3" xref="S6.E12.m1.1.2.3.3.3.2.2.3.cmml">2</mn></msup></mrow><mn id="S6.E12.m1.1.2.3.3.3.3" xref="S6.E12.m1.1.2.3.3.3.3.cmml">2</mn></mfrac></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E12.m1.1b"><apply id="S6.E12.m1.1.2.cmml" xref="S6.E12.m1.1.2"><eq id="S6.E12.m1.1.2.1.cmml" xref="S6.E12.m1.1.2.1"></eq><apply id="S6.E12.m1.1.2.2.cmml" xref="S6.E12.m1.1.2.2"><times id="S6.E12.m1.1.2.2.1.cmml" xref="S6.E12.m1.1.2.2.1"></times><ci id="S6.E12.m1.1.2.2.2.cmml" xref="S6.E12.m1.1.2.2.2">𝐾</ci><ci id="S6.E12.m1.1.1.cmml" xref="S6.E12.m1.1.1">𝑢</ci></apply><apply id="S6.E12.m1.1.2.3.cmml" xref="S6.E12.m1.1.2.3"><times id="S6.E12.m1.1.2.3.1.cmml" xref="S6.E12.m1.1.2.3.1"></times><apply id="S6.E12.m1.1.2.3.2.cmml" xref="S6.E12.m1.1.2.3.2"><divide id="S6.E12.m1.1.2.3.2.1.cmml" xref="S6.E12.m1.1.2.3.2"></divide><cn type="integer" id="S6.E12.m1.1.2.3.2.2.cmml" xref="S6.E12.m1.1.2.3.2.2">1</cn><apply id="S6.E12.m1.1.2.3.2.3.cmml" xref="S6.E12.m1.1.2.3.2.3"><root id="S6.E12.m1.1.2.3.2.3a.cmml" xref="S6.E12.m1.1.2.3.2.3"></root><apply id="S6.E12.m1.1.2.3.2.3.2.cmml" xref="S6.E12.m1.1.2.3.2.3.2"><times id="S6.E12.m1.1.2.3.2.3.2.1.cmml" xref="S6.E12.m1.1.2.3.2.3.2.1"></times><cn type="integer" id="S6.E12.m1.1.2.3.2.3.2.2.cmml" xref="S6.E12.m1.1.2.3.2.3.2.2">2</cn><ci id="S6.E12.m1.1.2.3.2.3.2.3.cmml" xref="S6.E12.m1.1.2.3.2.3.2.3">𝜋</ci></apply></apply></apply><apply id="S6.E12.m1.1.2.3.3.cmml" xref="S6.E12.m1.1.2.3.3"><csymbol cd="ambiguous" id="S6.E12.m1.1.2.3.3.1.cmml" xref="S6.E12.m1.1.2.3.3">superscript</csymbol><ci id="S6.E12.m1.1.2.3.3.2.cmml" xref="S6.E12.m1.1.2.3.3.2">𝑒</ci><apply id="S6.E12.m1.1.2.3.3.3.cmml" xref="S6.E12.m1.1.2.3.3.3"><divide id="S6.E12.m1.1.2.3.3.3.1.cmml" xref="S6.E12.m1.1.2.3.3.3"></divide><apply id="S6.E12.m1.1.2.3.3.3.2.cmml" xref="S6.E12.m1.1.2.3.3.3.2"><minus id="S6.E12.m1.1.2.3.3.3.2.1.cmml" xref="S6.E12.m1.1.2.3.3.3.2"></minus><apply id="S6.E12.m1.1.2.3.3.3.2.2.cmml" xref="S6.E12.m1.1.2.3.3.3.2.2"><csymbol cd="ambiguous" id="S6.E12.m1.1.2.3.3.3.2.2.1.cmml" xref="S6.E12.m1.1.2.3.3.3.2.2">superscript</csymbol><ci id="S6.E12.m1.1.2.3.3.3.2.2.2.cmml" xref="S6.E12.m1.1.2.3.3.3.2.2.2">𝑢</ci><cn type="integer" id="S6.E12.m1.1.2.3.3.3.2.2.3.cmml" xref="S6.E12.m1.1.2.3.3.3.2.2.3">2</cn></apply></apply><cn type="integer" id="S6.E12.m1.1.2.3.3.3.3.cmml" xref="S6.E12.m1.1.2.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E12.m1.1c">K(u)=\frac{1}{\sqrt{2\pi}}e^{\frac{-u^{2}}{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S6.SS3.p2.19" class="ltx_p">The choice of bandwidth is non-trivial and dictates the tradeoff between bias and variance of the fitted model. Rather than relying on heuristic methods as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx15" title="" class="ltx_ref">15</a>]</cite>, we perform a grid search with 20-fold cross validation to select an appropriate bandwidth. Fig. <a href="#S6.F6.sf2" title="In Figure 6 ‣ VI-C Latent space clustering ‣ VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6(b)</span></a> shows the estimated density of the data. We evaluate each datapoint on the estimated PDF. We then choose an 80th-percentile threshold value on the density. As seen in Fig. <a href="#S6.F6.sf3" title="In Figure 6 ‣ VI-C Latent space clustering ‣ VI Anomaly detection metrics ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6(c)</span></a>, we can separate out most of the anomalous images with the threshold.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span id="S7.1.1" class="ltx_text ltx_font_smallcaps">RESULTS</span>
</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">We first test the performance of our two-pronged approach in extracting a subspace of anomalous images, and discarding inlier images. We denote the inlier class as negative and the outlier class as positive. We use the following metrics to evaluate anomaly detection performance: precision, recall, and F1-score. Precision is defined as:</p>
<table id="S7.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E13.m1.1" class="ltx_Math" alttext="\textrm{Precision}=\frac{TP}{TP+FP}" display="block"><semantics id="S7.E13.m1.1a"><mrow id="S7.E13.m1.1.1" xref="S7.E13.m1.1.1.cmml"><mtext id="S7.E13.m1.1.1.2" xref="S7.E13.m1.1.1.2a.cmml">Precision</mtext><mo id="S7.E13.m1.1.1.1" xref="S7.E13.m1.1.1.1.cmml">=</mo><mfrac id="S7.E13.m1.1.1.3" xref="S7.E13.m1.1.1.3.cmml"><mrow id="S7.E13.m1.1.1.3.2" xref="S7.E13.m1.1.1.3.2.cmml"><mi id="S7.E13.m1.1.1.3.2.2" xref="S7.E13.m1.1.1.3.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S7.E13.m1.1.1.3.2.1" xref="S7.E13.m1.1.1.3.2.1.cmml">​</mo><mi id="S7.E13.m1.1.1.3.2.3" xref="S7.E13.m1.1.1.3.2.3.cmml">P</mi></mrow><mrow id="S7.E13.m1.1.1.3.3" xref="S7.E13.m1.1.1.3.3.cmml"><mrow id="S7.E13.m1.1.1.3.3.2" xref="S7.E13.m1.1.1.3.3.2.cmml"><mi id="S7.E13.m1.1.1.3.3.2.2" xref="S7.E13.m1.1.1.3.3.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S7.E13.m1.1.1.3.3.2.1" xref="S7.E13.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S7.E13.m1.1.1.3.3.2.3" xref="S7.E13.m1.1.1.3.3.2.3.cmml">P</mi></mrow><mo id="S7.E13.m1.1.1.3.3.1" xref="S7.E13.m1.1.1.3.3.1.cmml">+</mo><mrow id="S7.E13.m1.1.1.3.3.3" xref="S7.E13.m1.1.1.3.3.3.cmml"><mi id="S7.E13.m1.1.1.3.3.3.2" xref="S7.E13.m1.1.1.3.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S7.E13.m1.1.1.3.3.3.1" xref="S7.E13.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S7.E13.m1.1.1.3.3.3.3" xref="S7.E13.m1.1.1.3.3.3.3.cmml">P</mi></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S7.E13.m1.1b"><apply id="S7.E13.m1.1.1.cmml" xref="S7.E13.m1.1.1"><eq id="S7.E13.m1.1.1.1.cmml" xref="S7.E13.m1.1.1.1"></eq><ci id="S7.E13.m1.1.1.2a.cmml" xref="S7.E13.m1.1.1.2"><mtext id="S7.E13.m1.1.1.2.cmml" xref="S7.E13.m1.1.1.2">Precision</mtext></ci><apply id="S7.E13.m1.1.1.3.cmml" xref="S7.E13.m1.1.1.3"><divide id="S7.E13.m1.1.1.3.1.cmml" xref="S7.E13.m1.1.1.3"></divide><apply id="S7.E13.m1.1.1.3.2.cmml" xref="S7.E13.m1.1.1.3.2"><times id="S7.E13.m1.1.1.3.2.1.cmml" xref="S7.E13.m1.1.1.3.2.1"></times><ci id="S7.E13.m1.1.1.3.2.2.cmml" xref="S7.E13.m1.1.1.3.2.2">𝑇</ci><ci id="S7.E13.m1.1.1.3.2.3.cmml" xref="S7.E13.m1.1.1.3.2.3">𝑃</ci></apply><apply id="S7.E13.m1.1.1.3.3.cmml" xref="S7.E13.m1.1.1.3.3"><plus id="S7.E13.m1.1.1.3.3.1.cmml" xref="S7.E13.m1.1.1.3.3.1"></plus><apply id="S7.E13.m1.1.1.3.3.2.cmml" xref="S7.E13.m1.1.1.3.3.2"><times id="S7.E13.m1.1.1.3.3.2.1.cmml" xref="S7.E13.m1.1.1.3.3.2.1"></times><ci id="S7.E13.m1.1.1.3.3.2.2.cmml" xref="S7.E13.m1.1.1.3.3.2.2">𝑇</ci><ci id="S7.E13.m1.1.1.3.3.2.3.cmml" xref="S7.E13.m1.1.1.3.3.2.3">𝑃</ci></apply><apply id="S7.E13.m1.1.1.3.3.3.cmml" xref="S7.E13.m1.1.1.3.3.3"><times id="S7.E13.m1.1.1.3.3.3.1.cmml" xref="S7.E13.m1.1.1.3.3.3.1"></times><ci id="S7.E13.m1.1.1.3.3.3.2.cmml" xref="S7.E13.m1.1.1.3.3.3.2">𝐹</ci><ci id="S7.E13.m1.1.1.3.3.3.3.cmml" xref="S7.E13.m1.1.1.3.3.3.3">𝑃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E13.m1.1c">\textrm{Precision}=\frac{TP}{TP+FP}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S7.p1.2" class="ltx_p">Recall is defined as:</p>
<table id="S7.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E14.m1.1" class="ltx_Math" alttext="\textrm{Recall}=\frac{TP}{TP+FN}" display="block"><semantics id="S7.E14.m1.1a"><mrow id="S7.E14.m1.1.1" xref="S7.E14.m1.1.1.cmml"><mtext id="S7.E14.m1.1.1.2" xref="S7.E14.m1.1.1.2a.cmml">Recall</mtext><mo id="S7.E14.m1.1.1.1" xref="S7.E14.m1.1.1.1.cmml">=</mo><mfrac id="S7.E14.m1.1.1.3" xref="S7.E14.m1.1.1.3.cmml"><mrow id="S7.E14.m1.1.1.3.2" xref="S7.E14.m1.1.1.3.2.cmml"><mi id="S7.E14.m1.1.1.3.2.2" xref="S7.E14.m1.1.1.3.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S7.E14.m1.1.1.3.2.1" xref="S7.E14.m1.1.1.3.2.1.cmml">​</mo><mi id="S7.E14.m1.1.1.3.2.3" xref="S7.E14.m1.1.1.3.2.3.cmml">P</mi></mrow><mrow id="S7.E14.m1.1.1.3.3" xref="S7.E14.m1.1.1.3.3.cmml"><mrow id="S7.E14.m1.1.1.3.3.2" xref="S7.E14.m1.1.1.3.3.2.cmml"><mi id="S7.E14.m1.1.1.3.3.2.2" xref="S7.E14.m1.1.1.3.3.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S7.E14.m1.1.1.3.3.2.1" xref="S7.E14.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S7.E14.m1.1.1.3.3.2.3" xref="S7.E14.m1.1.1.3.3.2.3.cmml">P</mi></mrow><mo id="S7.E14.m1.1.1.3.3.1" xref="S7.E14.m1.1.1.3.3.1.cmml">+</mo><mrow id="S7.E14.m1.1.1.3.3.3" xref="S7.E14.m1.1.1.3.3.3.cmml"><mi id="S7.E14.m1.1.1.3.3.3.2" xref="S7.E14.m1.1.1.3.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S7.E14.m1.1.1.3.3.3.1" xref="S7.E14.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S7.E14.m1.1.1.3.3.3.3" xref="S7.E14.m1.1.1.3.3.3.3.cmml">N</mi></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S7.E14.m1.1b"><apply id="S7.E14.m1.1.1.cmml" xref="S7.E14.m1.1.1"><eq id="S7.E14.m1.1.1.1.cmml" xref="S7.E14.m1.1.1.1"></eq><ci id="S7.E14.m1.1.1.2a.cmml" xref="S7.E14.m1.1.1.2"><mtext id="S7.E14.m1.1.1.2.cmml" xref="S7.E14.m1.1.1.2">Recall</mtext></ci><apply id="S7.E14.m1.1.1.3.cmml" xref="S7.E14.m1.1.1.3"><divide id="S7.E14.m1.1.1.3.1.cmml" xref="S7.E14.m1.1.1.3"></divide><apply id="S7.E14.m1.1.1.3.2.cmml" xref="S7.E14.m1.1.1.3.2"><times id="S7.E14.m1.1.1.3.2.1.cmml" xref="S7.E14.m1.1.1.3.2.1"></times><ci id="S7.E14.m1.1.1.3.2.2.cmml" xref="S7.E14.m1.1.1.3.2.2">𝑇</ci><ci id="S7.E14.m1.1.1.3.2.3.cmml" xref="S7.E14.m1.1.1.3.2.3">𝑃</ci></apply><apply id="S7.E14.m1.1.1.3.3.cmml" xref="S7.E14.m1.1.1.3.3"><plus id="S7.E14.m1.1.1.3.3.1.cmml" xref="S7.E14.m1.1.1.3.3.1"></plus><apply id="S7.E14.m1.1.1.3.3.2.cmml" xref="S7.E14.m1.1.1.3.3.2"><times id="S7.E14.m1.1.1.3.3.2.1.cmml" xref="S7.E14.m1.1.1.3.3.2.1"></times><ci id="S7.E14.m1.1.1.3.3.2.2.cmml" xref="S7.E14.m1.1.1.3.3.2.2">𝑇</ci><ci id="S7.E14.m1.1.1.3.3.2.3.cmml" xref="S7.E14.m1.1.1.3.3.2.3">𝑃</ci></apply><apply id="S7.E14.m1.1.1.3.3.3.cmml" xref="S7.E14.m1.1.1.3.3.3"><times id="S7.E14.m1.1.1.3.3.3.1.cmml" xref="S7.E14.m1.1.1.3.3.3.1"></times><ci id="S7.E14.m1.1.1.3.3.3.2.cmml" xref="S7.E14.m1.1.1.3.3.3.2">𝐹</ci><ci id="S7.E14.m1.1.1.3.3.3.3.cmml" xref="S7.E14.m1.1.1.3.3.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E14.m1.1c">\textrm{Recall}=\frac{TP}{TP+FN}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S7.p1.3" class="ltx_p">The F1-score is defined as the harmonic mean of the precision and recall, weighting both measures equally. High precision relates to a low false positive rate, and high recall relates to a low false negative rate.</p>
</div>
<figure id="S7.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S7.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/precision_result_summary.png" id="S7.F7.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="411" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F7.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S7.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/recall_result_summary.png" id="S7.F7.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="411" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F7.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S7.F7.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2306.04834/assets/f1_result_summary.png" id="S7.F7.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="411" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F7.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F7.4.2.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S7.F7.2.1" class="ltx_text" style="font-size:90%;">summary of results as a function of <math id="S7.F7.2.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S7.F7.2.1.m1.1b"><mi id="S7.F7.2.1.m1.1.1" xref="S7.F7.2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S7.F7.2.1.m1.1c"><ci id="S7.F7.2.1.m1.1.1.cmml" xref="S7.F7.2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.F7.2.1.m1.1d">d</annotation></semantics></math> (a) Precision; (b) Recall; (c) F1 score. 80th percentile thresholds are applied on both the density scores and ROI scores</span></figcaption>
</figure>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.4" class="ltx_p">We first evaluate the standalone performance of our clustering approach and ROI-based approach, before evaluating the joint performance of both methods. We assess how sensitive the performance is to the latent dimensionality <math id="S7.p2.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S7.p2.1.m1.1a"><mi id="S7.p2.1.m1.1.1" xref="S7.p2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S7.p2.1.m1.1b"><ci id="S7.p2.1.m1.1.1.cmml" xref="S7.p2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.p2.1.m1.1c">d</annotation></semantics></math>. Fig. <a href="#S7.F7" title="Figure 7 ‣ VII RESULTS ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows the precision and recall for (1) our proposed clustering approach; (2) our proposed ROI-based method, and (3) both methods applied jointly, plotted as a function of latent dimensionality <math id="S7.p2.2.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S7.p2.2.m2.1a"><mi id="S7.p2.2.m2.1.1" xref="S7.p2.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S7.p2.2.m2.1b"><ci id="S7.p2.2.m2.1.1.cmml" xref="S7.p2.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.p2.2.m2.1c">d</annotation></semantics></math>. When we apply the clustering method on its own, we observe that precision is generally low across the models we tested. However, this is to be expected since the intention behind our clustering approach is to present a reduced subspace of images to the human operator. These images will then be subject to our ROI scoring method in the second stage to further prune away inlier image instances.
The fraction of relevant images presented to the human operator (recall) gradually increases with <math id="S7.p2.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S7.p2.3.m3.1a"><mi id="S7.p2.3.m3.1.1" xref="S7.p2.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S7.p2.3.m3.1b"><ci id="S7.p2.3.m3.1.1.cmml" xref="S7.p2.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.p2.3.m3.1c">d</annotation></semantics></math>. This occurs only beyond <math id="S7.p2.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S7.p2.4.m4.1a"><mi id="S7.p2.4.m4.1.1" xref="S7.p2.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S7.p2.4.m4.1b"><ci id="S7.p2.4.m4.1.1.cmml" xref="S7.p2.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.p2.4.m4.1c">d</annotation></semantics></math>=512. Below this value, both precision and recall fluctuate. We reason that models with low capacity are unable to capture visual features that would allow the outlier and inlier images to be separated in the reduced low-dimensional space.</p>
</div>
<figure id="S7.F8" class="ltx_figure"><img src="/html/2306.04834/assets/kde_cluster_summary.jpg" id="S7.F8.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="509" height="382" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S7.F8.3.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S7.F8.4.2" class="ltx_text" style="font-size:90%;">Latent space embeddings for models with varying latent vector dimensions. The dimensionality is shown in each subplot.</span></figcaption>
</figure>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.4" class="ltx_p">This is supported by Fig. <a href="#S7.F8" title="Figure 8 ‣ VII RESULTS ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, in which we plot the reduced latent space for each model. Low values of <math id="S7.p3.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S7.p3.1.m1.1a"><mi id="S7.p3.1.m1.1.1" xref="S7.p3.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S7.p3.1.m1.1b"><ci id="S7.p3.1.m1.1.1.cmml" xref="S7.p3.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.1.m1.1c">d</annotation></semantics></math> result in the outliers being clustered together with inliers.
Precision and recall for our ROI-based approach applied on its own is not as sensitive to the size of the latent dimension <math id="S7.p3.2.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S7.p3.2.m2.1a"><mi id="S7.p3.2.m2.1.1" xref="S7.p3.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S7.p3.2.m2.1b"><ci id="S7.p3.2.m2.1.1.cmml" xref="S7.p3.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.2.m2.1c">d</annotation></semantics></math>, and plateaus beyond <math id="S7.p3.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S7.p3.3.m3.1a"><mi id="S7.p3.3.m3.1.1" xref="S7.p3.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S7.p3.3.m3.1b"><ci id="S7.p3.3.m3.1.1.cmml" xref="S7.p3.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.3.m3.1c">d</annotation></semantics></math>=512. The recall is generally lower than the clustering method but this is at the expense of far greater precision. To apply both methods jointly, we first apply the clustering method to obtain a reduced subspace and then apply the ROI scores to the reduced subspace. We are able to obtain a much lower false alarm rate (precision=0.434), with recall=0.714. To visualize the tradeoff between precision and recall and dependency on ROI thresholds, the precision-recall curve for a model with <math id="S7.p3.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S7.p3.4.m4.1a"><mi id="S7.p3.4.m4.1.1" xref="S7.p3.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S7.p3.4.m4.1b"><ci id="S7.p3.4.m4.1.1.cmml" xref="S7.p3.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.4.m4.1c">d</annotation></semantics></math>=2048 is shown in Fig. <a href="#S7.F9" title="Figure 9 ‣ VII RESULTS ‣ A Semi-supervised Object Detection Algorithm for Underwater Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. The figure also shows the effect of varying the ROI threshold. A very low threshold for the ROI score results in a near-stagnant value of precision. Increasing the ROI threshold shifts the PR-curve upwards and towards the left, essentially trading off recall for better precision. We obtain the largest average Precision (approximate measure of area under PR-curve) of 0.64 for a 95th-percentile threshold on the ROI score.</p>
</div>
<figure id="S7.F9" class="ltx_figure"><img src="/html/2306.04834/assets/pr_curves.png" id="S7.F9.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="327" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S7.F9.7.3.1" class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span id="S7.F9.5.2" class="ltx_text" style="font-size:90%;">Precision-recall curves for <math id="S7.F9.4.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S7.F9.4.1.m1.1b"><mi id="S7.F9.4.1.m1.1.1" xref="S7.F9.4.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S7.F9.4.1.m1.1c"><ci id="S7.F9.4.1.m1.1.1.cmml" xref="S7.F9.4.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.F9.4.1.m1.1d">d</annotation></semantics></math>=2048. Each curve represents precision-recall tradeoff for a single <math id="S7.F9.5.2.m2.1" class="ltx_Math" alttext="n^{th}" display="inline"><semantics id="S7.F9.5.2.m2.1b"><msup id="S7.F9.5.2.m2.1.1" xref="S7.F9.5.2.m2.1.1.cmml"><mi id="S7.F9.5.2.m2.1.1.2" xref="S7.F9.5.2.m2.1.1.2.cmml">n</mi><mrow id="S7.F9.5.2.m2.1.1.3" xref="S7.F9.5.2.m2.1.1.3.cmml"><mi id="S7.F9.5.2.m2.1.1.3.2" xref="S7.F9.5.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S7.F9.5.2.m2.1.1.3.1" xref="S7.F9.5.2.m2.1.1.3.1.cmml">​</mo><mi id="S7.F9.5.2.m2.1.1.3.3" xref="S7.F9.5.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S7.F9.5.2.m2.1c"><apply id="S7.F9.5.2.m2.1.1.cmml" xref="S7.F9.5.2.m2.1.1"><csymbol cd="ambiguous" id="S7.F9.5.2.m2.1.1.1.cmml" xref="S7.F9.5.2.m2.1.1">superscript</csymbol><ci id="S7.F9.5.2.m2.1.1.2.cmml" xref="S7.F9.5.2.m2.1.1.2">𝑛</ci><apply id="S7.F9.5.2.m2.1.1.3.cmml" xref="S7.F9.5.2.m2.1.1.3"><times id="S7.F9.5.2.m2.1.1.3.1.cmml" xref="S7.F9.5.2.m2.1.1.3.1"></times><ci id="S7.F9.5.2.m2.1.1.3.2.cmml" xref="S7.F9.5.2.m2.1.1.3.2">𝑡</ci><ci id="S7.F9.5.2.m2.1.1.3.3.cmml" xref="S7.F9.5.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.F9.5.2.m2.1d">n^{th}</annotation></semantics></math>-percentile threshold on the ROI score</span></figcaption>
</figure>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VIII </span><span id="S8.1.1" class="ltx_text ltx_font_smallcaps">CONCLUSIONS</span>
</h2>

<div id="S8.p1" class="ltx_para">
<p id="S8.p1.1" class="ltx_p">We present an anomaly detection system based on VAEs which can be used to detect artificial objects in large datasets of seafloor imagery. Estimating the density of the latent space provides a convenient method for a human operator to systematically query a database by simply applying an nth-percentile threshold. False positives within the returned images can be further filtered out by applying our ROI-based method. We test the performance of our approach as a function of the latent dimensionality of the VAE, and find that the clustering approach is particularly sensitive to the number of latent dimensions <math id="S8.p1.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S8.p1.1.m1.1a"><mi id="S8.p1.1.m1.1.1" xref="S8.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S8.p1.1.m1.1b"><ci id="S8.p1.1.m1.1.1.cmml" xref="S8.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.1.m1.1c">d</annotation></semantics></math>. As future work, we plan to apply a transfer-learning approach to our problem by using pre-trained models as feature extractors in the VAE encoder. Furthermore, in this paper we did not consider temporal dependencies between images or their latent representations. Extending our approach to image sequences would potentially support online anomaly detection. Another interesting area of future work would be in adapting reconstruction error thresholds rather than maintaining a static threshold across different datasets. This would be a first step towards developing an adaptive system that is robust to changes in the environment or operating conditions.</p>
</div>
</section>
<section id="S9" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IX </span><span id="S9.1.1" class="ltx_text ltx_font_smallcaps">ACKNOWLEDGEMENTS</span>
</h2>

<div id="S9.p1" class="ltx_para">
<p id="S9.p1.1" class="ltx_p">The research for this paper received funding from the Australian Government through Trusted Autonomous Systems, a Defence Cooperative Research Centre funded through the Next Generation Technologies Fund. The authors thank the captain and crew of the Research Vessel <span id="S9.p1.1.1" class="ltx_text ltx_font_italic">Kimbla</span> for supporting the AUV missions and experimental campaign at Jervis Bay. The authors also thank Dr. Phillip Skelton for his feedback on the manuscript.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bibx1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">Davide Abati, Angelo Porrello, Simone Calderara and Rita Cucchiara
</span>
<span class="ltx_bibblock">“Latent space autoregression for novelty detection”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx1.1.1" class="ltx_emph ltx_font_italic">Proc. of the IEEE/CVF Conf. on Computer Vision and Pattern Recognition</em>, 2019, pp. 481–490
</span>
</li>
<li id="bib.bibx2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">Ilker Bozcan, Jonas Le Fevre, Huy X Pham and Erdal Kayacan
</span>
<span class="ltx_bibblock">“Gridnet: Image-agnostic conditional anomaly detection for indoor surveillance”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx2.1.1" class="ltx_emph ltx_font_italic">IEEE Robotics and Automation Letters</em> <span id="bib.bibx2.2.2" class="ltx_text ltx_font_bold">6.2</span>
</span>
<span class="ltx_bibblock">IEEE, 2021, pp. 1638–1645
</span>
</li>
<li id="bib.bibx3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">Xiaoran Chen, Suhang You, Kerem Can Tezcan and Ender Konukoglu
</span>
<span class="ltx_bibblock">“Unsupervised lesion detection via image restoration with a normative prior”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx3.1.1" class="ltx_emph ltx_font_italic">Medical image analysis</em> <span id="bib.bibx3.2.2" class="ltx_text ltx_font_bold">64</span>
</span>
<span class="ltx_bibblock">Elsevier, 2020, pp. 101713
</span>
</li>
<li id="bib.bibx4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">Martin Ester, Hans-Peter Kriegel, Jörg Sander and Xiaowei Xu
</span>
<span class="ltx_bibblock">“A density-based algorithm for discovering clusters in large spatial databases with noise.”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx4.1.1" class="ltx_emph ltx_font_italic">kdd</em> <span id="bib.bibx4.2.2" class="ltx_text ltx_font_bold">96.34</span>, 1996, pp. 226–231
</span>
</li>
<li id="bib.bibx5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">Ye Fei et al.
</span>
<span class="ltx_bibblock">“Attribute restoration framework for anomaly detection”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx5.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. on Multimedia</em>
</span>
<span class="ltx_bibblock">IEEE, 2020
</span>
</li>
<li id="bib.bibx6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">Genevieve Flaspohler, Nicholas Roy and Yogesh Girdhar
</span>
<span class="ltx_bibblock">“Feature discovery and visualization of robot mission data using convolutional autoencoders and Bayesian nonparametric topic models”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx6.1.1" class="ltx_emph ltx_font_italic">2017 IEEE/RSJ Intl. Conf. on Intelligent Robots and Systems (IROS)</em>, 2017, pp. 1–8
</span>
<span class="ltx_bibblock">IEEE
</span>
</li>
<li id="bib.bibx7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">Jakob D Havtorn, Jes Frellsen, Søren Hauberg and Lars Maaløe
</span>
<span class="ltx_bibblock">“Hierarchical vaes know what they don’t know”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx7.1.1" class="ltx_emph ltx_font_italic">Intl. Conf. on Machine Learning</em>, 2021, pp. 4117–4128
</span>
<span class="ltx_bibblock">PMLR
</span>
</li>
<li id="bib.bibx8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">Chao Huang et al.
</span>
<span class="ltx_bibblock">“Self-supervision-augmented deep autoencoder for unsupervised visual anomaly detection”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx8.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. on Cybernetics</em>
</span>
<span class="ltx_bibblock">IEEE, 2021
</span>
</li>
<li id="bib.bibx9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">Diederik P Kingma and Max Welling
</span>
<span class="ltx_bibblock">“Auto-encoding variational bayes”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1312.6114</em>, 2013
</span>
</li>
<li id="bib.bibx10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">Alex Krizhevsky, Ilya Sutskever and Geoffrey E Hinton
</span>
<span class="ltx_bibblock">“Imagenet classification with deep convolutional neural networks”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx10.1.1" class="ltx_emph ltx_font_italic">Adv. in neural information processing systems</em> <span id="bib.bibx10.2.2" class="ltx_text ltx_font_bold">25</span>, 2012
</span>
</li>
<li id="bib.bibx11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">Dario Mantegazza, Alessandro Giusti, Luca Maria Gambardella and Jérôme Guzzi
</span>
<span class="ltx_bibblock">“An Outlier Exposure Approach to Improve Visual Anomaly Detection Performance for Mobile Robots”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx11.1.1" class="ltx_emph ltx_font_italic">IEEE Robotics and Automation Letters</em> <span id="bib.bibx11.2.2" class="ltx_text ltx_font_bold">7.4</span>
</span>
<span class="ltx_bibblock">IEEE, 2022, pp. 11354–11361
</span>
</li>
<li id="bib.bibx12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">Dushyant Rao et al.
</span>
<span class="ltx_bibblock">“Multimodal learning and inference from visual and remotely sensed data”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx12.1.1" class="ltx_emph ltx_font_italic">The Intl. J. of Robotics Research</em> <span id="bib.bibx12.2.2" class="ltx_text ltx_font_bold">36.1</span>
</span>
<span class="ltx_bibblock">SAGE Publications Sage UK: London, England, 2017, pp. 24–43
</span>
</li>
<li id="bib.bibx13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">Erich Schubert et al.
</span>
<span class="ltx_bibblock">“DBSCAN revisited, revisited: why and how you should (still) use DBSCAN”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx13.1.1" class="ltx_emph ltx_font_italic">ACM Trans. on Database Systems (TODS)</em> <span id="bib.bibx13.2.2" class="ltx_text ltx_font_bold">42.3</span>
</span>
<span class="ltx_bibblock">ACM New York, NY, USA, 2017, pp. 1–21
</span>
</li>
<li id="bib.bibx14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">David W Scott
</span>
<span class="ltx_bibblock">“Feasibility of multivariate density estimates”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx14.1.1" class="ltx_emph ltx_font_italic">Biometrika</em> <span id="bib.bibx14.2.2" class="ltx_text ltx_font_bold">78.1</span>
</span>
<span class="ltx_bibblock">Oxford University Press, 1991, pp. 197–205
</span>
</li>
<li id="bib.bibx15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">Bernard W Silverman
</span>
<span class="ltx_bibblock">“Density estimation for statistics and data analysis”
</span>
<span class="ltx_bibblock">Routledge, 2018
</span>
</li>
<li id="bib.bibx16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">Bowen Teng and Hongjian Zhao
</span>
<span class="ltx_bibblock">“Underwater target recognition methods based on the framework of deep learning: A survey”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx16.1.1" class="ltx_emph ltx_font_italic">Intl. J. of Advanced Robotic Systems</em> <span id="bib.bibx16.2.2" class="ltx_text ltx_font_bold">17.6</span>
</span>
<span class="ltx_bibblock">SAGE Publications Sage UK: London, England, 2020, pp. 1729881420976307
</span>
</li>
<li id="bib.bibx17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">Laurens Van der Maaten and Geoffrey Hinton
</span>
<span class="ltx_bibblock">“Visualizing data using t-SNE.”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx17.1.1" class="ltx_emph ltx_font_italic">J. of machine learning research</em> <span id="bib.bibx17.2.2" class="ltx_text ltx_font_bold">9.11</span>, 2008
</span>
</li>
<li id="bib.bibx18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">Takaki Yamada, Adam Prügel-Bennett and Blair Thornton
</span>
<span class="ltx_bibblock">“Learning features from georeferenced seafloor imagery with location guided autoencoders”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx18.1.1" class="ltx_emph ltx_font_italic">J. of Field Robotics</em> <span id="bib.bibx18.2.2" class="ltx_text ltx_font_bold">38.1</span>
</span>
<span class="ltx_bibblock">Wiley Online Library, 2021, pp. 52–67
</span>
</li>
<li id="bib.bibx19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">Xian Yu et al.
</span>
<span class="ltx_bibblock">“Man-made object recognition from underwater optical images using deep learning and transfer learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx19.1.1" class="ltx_emph ltx_font_italic">2018 IEEE Intl. Conf. on Acoustics, Speech and Signal Processing (ICASSP)</em>, 2018, pp. 1852–1856
</span>
<span class="ltx_bibblock">IEEE
</span>
</li>
<li id="bib.bibx20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">Bo Zong et al.
</span>
<span class="ltx_bibblock">“Deep autoencoding gaussian mixture model for unsupervised anomaly detection”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx20.1.1" class="ltx_emph ltx_font_italic">Intl. conf. on learning representations</em>, 2018
</span>
</li>
<li id="bib.bibx21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">Martin Zurowietz et al.
</span>
<span class="ltx_bibblock">“MAIA—A machine learning assisted image annotation method for environmental monitoring and exploration”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx21.1.1" class="ltx_emph ltx_font_italic">PloS one</em> <span id="bib.bibx21.2.2" class="ltx_text ltx_font_bold">13.11</span>
</span>
<span class="ltx_bibblock">Public Library of Science San Francisco, CA USA, 2018, pp. e0207498
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2306.04833" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2306.04834" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2306.04834">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2306.04834" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2306.04835" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Feb 26 22:49:01 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
