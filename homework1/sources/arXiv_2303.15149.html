<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.15149] What Can Human Sketches Do for Object Detection?</title><meta property="og:description" content="Sketches are highly expressive, inherently capturing subjective and fine-grained visual cues. The exploration of such innate properties of human sketches has, however, been limited to that of image retrieval. In this p…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="What Can Human Sketches Do for Object Detection?">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="What Can Human Sketches Do for Object Detection?">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.15149">

<!--Generated on Thu Feb 29 18:34:22 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">What Can Human Sketches Do for Object Detection?
<br class="ltx_break">
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pinaki Nath Chowdhury    Ayan Kumar Bhunia    Aneeshan Sain    Subhadeep Koley 
<br class="ltx_break">Tao Xiang    Yi-Zhe Song 
<br class="ltx_break">SketchX, CVSSP, University of Surrey, United Kingdom. 
<br class="ltx_break"><span id="id2.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{p.chowdhury, a.bhunia, a.sain, s.koley, t.xiang, y.song}@surrey.ac.uk</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.1" class="ltx_p">Sketches are highly expressive, inherently capturing subjective and fine-grained visual cues. The exploration of such innate properties of human sketches has, however, been limited to that of image retrieval. In this paper, for the first time, we cultivate the expressiveness of sketches but for the fundamental vision task of object detection. The end result is a sketch-enabled object detection framework that detects based on what <span id="id1.1.1" class="ltx_text ltx_font_italic">you</span> sketch – <span id="id1.1.2" class="ltx_text ltx_font_italic">that</span> “zebra” (e.g., one that is eating the grass) in a herd of zebras (instance-aware detection), and only the <span id="id1.1.3" class="ltx_text ltx_font_italic">part</span> (e.g., “head” of a “zebra”) that you desire (part-aware detection). We further dictate that our model works without (i) knowing which category to expect at testing (zero-shot) and (ii) not requiring additional bounding boxes (as per fully supervised) and class labels (as per weakly supervised). Instead of devising a model from the ground up, we show an intuitive synergy between foundation models (e.g., CLIP) and existing sketch models build for sketch-based image retrieval (SBIR), which can already elegantly solve the task – CLIP to provide model generalisation, and SBIR to bridge the (sketch<math id="id1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="id1.1.m1.1a"><mo stretchy="false" id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><ci id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\rightarrow</annotation></semantics></math>photo) gap. In particular, we first perform independent prompting on both sketch and photo branches of an SBIR model to build highly generalisable sketch and photo encoders on the back of the generalisation ability of CLIP. We then devise a training paradigm to adapt the learned encoders for object detection, such that the region embeddings of detected boxes are aligned with the sketch and photo embeddings from SBIR. Evaluating our framework on standard object detection datasets like PASCAL-VOC and MS-COCO outperforms both supervised (SOD) and weakly-supervised object detectors (WSOD) on zero-shot setups. Project Page: <a target="_blank" href="https://pinakinathc.github.io/sketch-detect" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://pinakinathc.github.io/sketch-detect</a></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2303.15149/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="260" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">We train an object detector using SBIR models. (a) First, we train an FG-SBIR model using existing sketch–photo pairs that generalise to unseen categories. (b) To train the object detector module, we tile multiple object-level photos from SBIR datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite> and use its paired sketch encoding via a pre-trained sketch encoder to align the region embedding of detected boxes. (c) Inclusion of sketches for object detection opens several avenues like detecting a specific object for query sketch (e.g., detect a “zebra” eating grass) or part of an object (e.g., “head” of “zebra”).</span></figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Sketches have been used from prehistoric times for humans to express and record ideas <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib78" title="" class="ltx_ref">78</a>]</cite>. The level of expressiveness <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> they carry remains unparalleled today even in the face of language <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib84" title="" class="ltx_ref">84</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> – recall that moment that you want to resort to pen and paper (or Zoom Whiteboard) to sketch down an idea?</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Sketch research has also flourished over the past decade <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib92" title="" class="ltx_ref">92</a>, <a href="#bib.bib72" title="" class="ltx_ref">72</a>, <a href="#bib.bib101" title="" class="ltx_ref">101</a>]</cite>, with a whole spectrum of works on traditional tasks such as classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> and synthesis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>, and those more sketch-specific such as modelling visual abstraction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, style transfer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib76" title="" class="ltx_ref">76</a>]</cite> and continuous stroke fitting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, to cute applications such as turning a sketch into a photo classifier <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The expressiveness of sketches, however, has been only explored in the form of sketch-based image retrieval (SBIR) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib72" title="" class="ltx_ref">72</a>, <a href="#bib.bib96" title="" class="ltx_ref">96</a>]</cite>, especially the fine-grained <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> variant (FG-SBIR). Great strides have been made, with recent systems already reaching maturity for commercial adaptation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> – a great testimony to how cultivating sketch expressiveness can make a real impact.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we ask the question – what can human sketches do for the fundamental vision tasks of object detection? The envisaged outcome is, therefore, a sketch-enabled object detection framework that detects based on what you sketch, i.e., how <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">you</span> want to express yourself. Sketching a “zebra eating the grass” (in <a href="#S1.F1" title="In 1 Introduction ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>) should detect “that” zebra from a herd of zebras (instance-aware detection), <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">and</span> it will also give you the freedom to be specific with parts (part-aware detection), so if the “head” of a “zebra” is what you would rather desire, then just sketch the very head.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Instead of devising a sketch-enabled object detection model from the ground up, we show that an intuitive synergy between foundation models (e.g., CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite>) and off-the-shelf SBIR models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib102" title="" class="ltx_ref">102</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> can already, rather elegantly, solve the problem – CLIP to provide model generalization, and SBIR to bridge the (sketch<math id="S1.p5.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S1.p5.1.m1.1a"><mo stretchy="false" id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><ci id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">\rightarrow</annotation></semantics></math>photo) gap. In particular, we adapt CLIP to build sketch and photo encoders (branches in a common SBIR model) by learning independent prompt vectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib73" title="" class="ltx_ref">73</a>]</cite> separately for both modalities. More specifically, during training, the learnable prompt vectors are prepended into the input sequence of the first transformer layer of CLIP’s ViT backbone <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> while keeping the rest frozen. As such, we inject model generalization into the learned sketch and photo distributions. Next, we devise a training paradigm to adapt the learned encoders for object detection, such that the region embeddings of detected boxes are aligned with the sketch and photo embeddings from SBIR. This allows our object detector to train <span id="S1.p5.1.1" class="ltx_text ltx_font_italic">without</span> requiring additional training photos (bounding boxes and class labels) from auxiliary datasets.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">To make our sketch-based detector more interesting (general-purpose <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>), we further dictate it also works in a zero-shot manner. For that, following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, we extend object detection from a pre-defined fixed-set setup to an open-vocab setup. Specifically, we replace the classification heads in object detectors with prototype learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>, where the encoded query sketch features act as the support set (or prototypes). Next, the model is trained under the weakly supervised object detection (WSOD) setting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib80" title="" class="ltx_ref">80</a>]</cite>, using a multi-category cross-entropy loss over the prototypes of all possible categories or instances. However, while SBIR is trained using object-level (single object) sketch/photo pairs, object detection works on image-level (multiple categories). Hence, to train object detectors using SBIR, we also need to bridge the gap between object and image-level features. Towards this, we use a data augmentation trick that is embarrassingly simple yet highly effective for robustness towards corruption and generalisation to out-of-vocab <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib103" title="" class="ltx_ref">103</a>, <a href="#bib.bib104" title="" class="ltx_ref">104</a>]</cite> – we randomly select <math id="S1.p6.1.m1.3" class="ltx_Math" alttext="n=\{1,\dots,7\}" display="inline"><semantics id="S1.p6.1.m1.3a"><mrow id="S1.p6.1.m1.3.4" xref="S1.p6.1.m1.3.4.cmml"><mi id="S1.p6.1.m1.3.4.2" xref="S1.p6.1.m1.3.4.2.cmml">n</mi><mo id="S1.p6.1.m1.3.4.1" xref="S1.p6.1.m1.3.4.1.cmml">=</mo><mrow id="S1.p6.1.m1.3.4.3.2" xref="S1.p6.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S1.p6.1.m1.3.4.3.2.1" xref="S1.p6.1.m1.3.4.3.1.cmml">{</mo><mn id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">1</mn><mo id="S1.p6.1.m1.3.4.3.2.2" xref="S1.p6.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S1.p6.1.m1.2.2" xref="S1.p6.1.m1.2.2.cmml">…</mi><mo id="S1.p6.1.m1.3.4.3.2.3" xref="S1.p6.1.m1.3.4.3.1.cmml">,</mo><mn id="S1.p6.1.m1.3.3" xref="S1.p6.1.m1.3.3.cmml">7</mn><mo stretchy="false" id="S1.p6.1.m1.3.4.3.2.4" xref="S1.p6.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.3b"><apply id="S1.p6.1.m1.3.4.cmml" xref="S1.p6.1.m1.3.4"><eq id="S1.p6.1.m1.3.4.1.cmml" xref="S1.p6.1.m1.3.4.1"></eq><ci id="S1.p6.1.m1.3.4.2.cmml" xref="S1.p6.1.m1.3.4.2">𝑛</ci><set id="S1.p6.1.m1.3.4.3.1.cmml" xref="S1.p6.1.m1.3.4.3.2"><cn type="integer" id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">1</cn><ci id="S1.p6.1.m1.2.2.cmml" xref="S1.p6.1.m1.2.2">…</ci><cn type="integer" id="S1.p6.1.m1.3.3.cmml" xref="S1.p6.1.m1.3.3">7</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.3c">n=\{1,\dots,7\}</annotation></semantics></math> photos from SBIR datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite> and arbitrarily tile them on a blank canvas (similar to CutMix <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib103" title="" class="ltx_ref">103</a>]</cite>).</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">In summary, our contributions are (i) for the first time cultivating the expressiveness of human sketches for object detection, (ii) sketch-based object detector that detects what you intend to express in your sketch, (iii) an object detector that is both instance-aware and part-aware, in addition to performing conventional category-level detection. (iv) a novel prompt learning setup to marry CLIP and SBIR to build the sketch-aware detector that works without needing bounding box annotations (as supervised <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>), class labels (as weakly supervised <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>), and in a zero-shot manner. (v) results outperform both supervised (SOD) and weakly supervised object detectors (WSOD) on zero-shot setup.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Sketch for Visual Understanding</span> 
Hand-drawn sketches serve as a useful query modality for visual understanding tasks that involve human perception and structural cues. Sketches not only convey a visual description <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> but also exhibit artistic styles <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib105" title="" class="ltx_ref">105</a>]</cite>. This makes sketch a vital querying modality for the creative industry, like artistic image editing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib100" title="" class="ltx_ref">100</a>]</cite> and animation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib95" title="" class="ltx_ref">95</a>]</cite>. Unlike photos that are passively captured by a camera, sketches are actively drawn by humans, which makes them a good visual representation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> enriched with human participation. Apart from the widely explored sketch-based image retrieval <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib76" title="" class="ltx_ref">76</a>, <a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite>, sketch as a query has shown potential in several vision understanding tasks like incremental learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> image and video synthesis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, representation learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib90" title="" class="ltx_ref">90</a>]</cite>, image-inpainting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib94" title="" class="ltx_ref">94</a>]</cite>, 3D shape retrieval <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib98" title="" class="ltx_ref">98</a>]</cite>, 3D shape modelling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, medical image analysis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib92" title="" class="ltx_ref">92</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, object localisation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib88" title="" class="ltx_ref">88</a>, <a href="#bib.bib71" title="" class="ltx_ref">71</a>]</cite> and segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Studying sketch as a query for object detection by Tripathi <em id="S2.p2.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib88" title="" class="ltx_ref">88</a>]</cite>, several limitations surfaced with respect to problem definition as well as architectural designs.
Firstly, instead of fine-grained matching, sketch was used to specify object category (easier via text/keyword <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>), thus overlooking the potential of sketch to model fine-grained details. Secondly, it requires both bounding-box and sketch annotation, which increases the annotation budget without significant improvement in performance over traditional object detection setups. Thirdly, due to an expensive annotation, only fewer than <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mn id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">50</mn><mo id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><csymbol cd="latexml" id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">50\%</annotation></semantics></math> object categories in existing object detection datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> are available for training. Finally, using an early fusion strategy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib97" title="" class="ltx_ref">97</a>]</cite> of sketch with object detection results in recomputing object regions for each new sketch – leading to a slower detection framework with increasing query sketches. In this paper, we propose a fine-grained sketch-based object detection framework that uses only object-level sketch photo pairs without any bounding-box annotations for training and is scalable with multiple fine-grained query sketches, even under zero-shot setup.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Supervised Object Detection</span> 
Object detection jointly localises and identifies objects in an image. Traditional object detectors rely on large datasets such as PASCAL VOC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and MS-COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>, containing thousands of examples per object category which are quite time-consuming to annotate, unlike our pipeline, that leverage sketch-photo pairs as annotation.
Existing literature on object detection is bifurcated as: (i) fast yet less accurate single-shot <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib67" title="" class="ltx_ref">67</a>, <a href="#bib.bib68" title="" class="ltx_ref">68</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib110" title="" class="ltx_ref">110</a>]</cite>; (ii) slow but more accurate two-stage object detectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib69" title="" class="ltx_ref">69</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. To fully exploit the fine-grained cues provided by sketch, our proposed method aligns with the accurate two-stage detectors that predict object regions using selective search in RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, ROI pooling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> in Fast-RCNN, and Region Proposal Network (RPN) with ROIAlign in Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>. While there has been several attempts with sophisticated architectural modifications <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib111" title="" class="ltx_ref">111</a>, <a href="#bib.bib110" title="" class="ltx_ref">110</a>]</cite>, Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite> still acts a fundamental building block for several downstream tasks like scene-graph generation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib99" title="" class="ltx_ref">99</a>]</cite>, visual grounding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>, and relationship prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib112" title="" class="ltx_ref">112</a>]</cite>. Therefore, we resort to the more traditional Faster-RCNN based two-stage pipeline.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Weakly Supervised Object Detection (WSOD)</span>  Collecting bounding box annotation per object category is already a time-consuming process, which is aggravated even further by fine-grained object detection (e.g., recognising animal species). To overcome this, existing WSOD adopt two schools of thought: (a) formulate this as a multiple instance learning (MIL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib106" title="" class="ltx_ref">106</a>, <a href="#bib.bib87" title="" class="ltx_ref">87</a>, <a href="#bib.bib81" title="" class="ltx_ref">81</a>]</cite> problem that interpret an image as a bag of proposals or regions. The image is labelled positive if one of the regions tightly contains the object of interest; otherwise negative. (b) CAM-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib108" title="" class="ltx_ref">108</a>, <a href="#bib.bib107" title="" class="ltx_ref">107</a>]</cite> that use class activation maps to predict proposals. Specifically, an image is fed to a backbone network to generate a feature vector from which the bounding box of each class is predicted by thresholding activation maps with the highest probability. Although CAM-based methods are faster, we use MIL-based technique as it can detect <span id="S2.p4.1.2" class="ltx_text ltx_font_italic">multiple instances</span> within the <span id="S2.p4.1.3" class="ltx_text ltx_font_italic">same</span> category <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib80" title="" class="ltx_ref">80</a>]</cite>.</p>
</div>
<div id="S2.p5" class="ltx_para ltx_noindent">
<p id="S2.p5.1" class="ltx_p"><span id="S2.p5.1.1" class="ltx_text ltx_font_bold">Data Augmentation in Computer Vision</span>  Data augmentation improves the sufficiency and diversity of training data. Approaches vary from simple image rotation and flipping to more advanced techniques of image erasing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> like CutOut <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, Hide-and-Seek <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib83" title="" class="ltx_ref">83</a>]</cite> and image mixing like MixUp <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib104" title="" class="ltx_ref">104</a>]</cite> and CutMix <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib103" title="" class="ltx_ref">103</a>]</cite>.
Aiming to generalise sketch-based object detection to complex scenes while training exclusively on existing object-level sketch photo pairs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite>, we employ a CutMix <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib103" title="" class="ltx_ref">103</a>]</cite> like data augmentation trick – a method that replaces removed sub-regions with a patch from another image to synthesise new images.</p>
</div>
<div id="S2.p6" class="ltx_para ltx_noindent">
<p id="S2.p6.1" class="ltx_p"><span id="S2.p6.1.1" class="ltx_text ltx_font_bold">Sketch-Based Object Representation</span> 
Sketch with its intrinsic ability to model fine-grained visual details makes it an ideal modality for object retrieval, giving rise to avenues like <em id="S2.p6.1.2" class="ltx_emph ltx_font_italic">category-level</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib101" title="" class="ltx_ref">101</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib72" title="" class="ltx_ref">72</a>, <a href="#bib.bib96" title="" class="ltx_ref">96</a>]</cite> and fine-grained (FG) <em id="S2.p6.1.3" class="ltx_emph ltx_font_italic">instance-level</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib74" title="" class="ltx_ref">74</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> sketch-based image retrieval (SBIR). Contemporary research also explored zero-shot SBIR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib101" title="" class="ltx_ref">101</a>, <a href="#bib.bib75" title="" class="ltx_ref">75</a>]</cite>, cross-domain translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite> and approaches like reinforcement learning based on-the-fly retrieval <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, self-supervised <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, etc. Apart from object-level images, retrieving sketched objects from scene images was studied using graph convolutional networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> and optimal transport <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Similar to cross-category FG-SBIR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, here we explore fine-grained sketch photo association for object detection by adapting large vision-language models like CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> using prompt engineering <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib109" title="" class="ltx_ref">109</a>]</cite>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p"><span id="S3.p1.1.1" class="ltx_text ltx_font_bold">Overview</span>  We propose a new paradigm training object detection without bounding box annotation or image-level class labels. Instead, we use sketch-based image retrieval for supervision. This leads to several emergent behaviours (i) fine-grained object detection – specify focused region-of-interest using fine-grained visual cues in sketch. (ii) category-level object detection – specify the category of detected instances via sketch. (iii) part-level object detection – detect specified parts (e.g., “head” and “legs” of a “horse”).</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Background</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Our framework has two key modules – Object Detection and Sketch-Based Image Retrieval (category-level and fine-grained). For completeness, we give a brief background.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2303.15149/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="369" height="133" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.8.4.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.6.3" class="ltx_text" style="font-size:90%;">Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite> use image encoder <math id="S3.F2.4.1.m1.1" class="ltx_Math" alttext="\mathcal{F}_{d}" display="inline"><semantics id="S3.F2.4.1.m1.1b"><msub id="S3.F2.4.1.m1.1.1" xref="S3.F2.4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F2.4.1.m1.1.1.2" xref="S3.F2.4.1.m1.1.1.2.cmml">ℱ</mi><mi id="S3.F2.4.1.m1.1.1.3" xref="S3.F2.4.1.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.4.1.m1.1c"><apply id="S3.F2.4.1.m1.1.1.cmml" xref="S3.F2.4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.4.1.m1.1.1.1.cmml" xref="S3.F2.4.1.m1.1.1">subscript</csymbol><ci id="S3.F2.4.1.m1.1.1.2.cmml" xref="S3.F2.4.1.m1.1.1.2">ℱ</ci><ci id="S3.F2.4.1.m1.1.1.3.cmml" xref="S3.F2.4.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.1.m1.1d">\mathcal{F}_{d}</annotation></semantics></math> and RPN <math id="S3.F2.5.2.m2.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S3.F2.5.2.m2.1b"><mi class="ltx_font_mathcaligraphic" id="S3.F2.5.2.m2.1.1" xref="S3.F2.5.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.F2.5.2.m2.1c"><ci id="S3.F2.5.2.m2.1.1.cmml" xref="S3.F2.5.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.2.m2.1d">\mathcal{R}</annotation></semantics></math> to generates box proposals. Feature maps of proposals, computed via RoI pool <math id="S3.F2.6.3.m3.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S3.F2.6.3.m3.1b"><mi class="ltx_font_mathcaligraphic" id="S3.F2.6.3.m3.1.1" xref="S3.F2.6.3.m3.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.F2.6.3.m3.1c"><ci id="S3.F2.6.3.m3.1.1.cmml" xref="S3.F2.6.3.m3.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.3.m3.1d">\mathcal{P}</annotation></semantics></math>, predicts class probabilities and box regression.</span></figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.19" class="ltx_p"><span id="S3.SS1.p2.19.1" class="ltx_text ltx_font_bold">Baseline Supervised Object Detection</span>  We briefly introduce a supervised object detection (SOD) framework, Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite> that remains state-of-the-art <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib99" title="" class="ltx_ref">99</a>, <a href="#bib.bib60" title="" class="ltx_ref">60</a>, <a href="#bib.bib112" title="" class="ltx_ref">112</a>]</cite>. Given a photo <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{p}\in\mathbb{R}^{H\times W\times 3}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">𝐩</mi><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.3.2" xref="S3.SS1.p2.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.1.m1.1.1.3.3.1" xref="S3.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.1.m1.1.1.3.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.1.m1.1.1.3.3.1a" xref="S3.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.1.m1.1.1.3.3.4" xref="S3.SS1.p2.1.m1.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><in id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></in><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝐩</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3"><times id="S3.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3.3">𝑊</ci><cn type="integer" id="S3.SS1.p2.1.m1.1.1.3.3.4.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathbf{p}\in\mathbb{R}^{H\times W\times 3}</annotation></semantics></math>, a backbone feature extractor (VGG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib82" title="" class="ltx_ref">82</a>]</cite>, or ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>) <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{F}_{d}(\cdot):\mathbb{R}^{H\times W\times 3}\rightarrow\mathbb{R}^{H^{\prime}\times W^{\prime}\times 512}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.2" xref="S3.SS1.p2.2.m2.1.2.cmml"><mrow id="S3.SS1.p2.2.m2.1.2.2" xref="S3.SS1.p2.2.m2.1.2.2.cmml"><msub id="S3.SS1.p2.2.m2.1.2.2.2" xref="S3.SS1.p2.2.m2.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.2.2.2.2" xref="S3.SS1.p2.2.m2.1.2.2.2.2.cmml">ℱ</mi><mi id="S3.SS1.p2.2.m2.1.2.2.2.3" xref="S3.SS1.p2.2.m2.1.2.2.2.3.cmml">d</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.2.m2.1.2.2.1" xref="S3.SS1.p2.2.m2.1.2.2.1.cmml">​</mo><mrow id="S3.SS1.p2.2.m2.1.2.2.3.2" xref="S3.SS1.p2.2.m2.1.2.2.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.1.2.2.3.2.1" xref="S3.SS1.p2.2.m2.1.2.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">⋅</mo><mo rspace="0.278em" stretchy="false" id="S3.SS1.p2.2.m2.1.2.2.3.2.2" xref="S3.SS1.p2.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.SS1.p2.2.m2.1.2.1" xref="S3.SS1.p2.2.m2.1.2.1.cmml">:</mo><mrow id="S3.SS1.p2.2.m2.1.2.3" xref="S3.SS1.p2.2.m2.1.2.3.cmml"><msup id="S3.SS1.p2.2.m2.1.2.3.2" xref="S3.SS1.p2.2.m2.1.2.3.2.cmml"><mi id="S3.SS1.p2.2.m2.1.2.3.2.2" xref="S3.SS1.p2.2.m2.1.2.3.2.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.2.m2.1.2.3.2.3" xref="S3.SS1.p2.2.m2.1.2.3.2.3.cmml"><mi id="S3.SS1.p2.2.m2.1.2.3.2.3.2" xref="S3.SS1.p2.2.m2.1.2.3.2.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.2.m2.1.2.3.2.3.1" xref="S3.SS1.p2.2.m2.1.2.3.2.3.1.cmml">×</mo><mi id="S3.SS1.p2.2.m2.1.2.3.2.3.3" xref="S3.SS1.p2.2.m2.1.2.3.2.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.2.m2.1.2.3.2.3.1a" xref="S3.SS1.p2.2.m2.1.2.3.2.3.1.cmml">×</mo><mn id="S3.SS1.p2.2.m2.1.2.3.2.3.4" xref="S3.SS1.p2.2.m2.1.2.3.2.3.4.cmml">3</mn></mrow></msup><mo stretchy="false" id="S3.SS1.p2.2.m2.1.2.3.1" xref="S3.SS1.p2.2.m2.1.2.3.1.cmml">→</mo><msup id="S3.SS1.p2.2.m2.1.2.3.3" xref="S3.SS1.p2.2.m2.1.2.3.3.cmml"><mi id="S3.SS1.p2.2.m2.1.2.3.3.2" xref="S3.SS1.p2.2.m2.1.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.2.m2.1.2.3.3.3" xref="S3.SS1.p2.2.m2.1.2.3.3.3.cmml"><msup id="S3.SS1.p2.2.m2.1.2.3.3.3.2" xref="S3.SS1.p2.2.m2.1.2.3.3.3.2.cmml"><mi id="S3.SS1.p2.2.m2.1.2.3.3.3.2.2" xref="S3.SS1.p2.2.m2.1.2.3.3.3.2.2.cmml">H</mi><mo id="S3.SS1.p2.2.m2.1.2.3.3.3.2.3" xref="S3.SS1.p2.2.m2.1.2.3.3.3.2.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.2.m2.1.2.3.3.3.1" xref="S3.SS1.p2.2.m2.1.2.3.3.3.1.cmml">×</mo><msup id="S3.SS1.p2.2.m2.1.2.3.3.3.3" xref="S3.SS1.p2.2.m2.1.2.3.3.3.3.cmml"><mi id="S3.SS1.p2.2.m2.1.2.3.3.3.3.2" xref="S3.SS1.p2.2.m2.1.2.3.3.3.3.2.cmml">W</mi><mo id="S3.SS1.p2.2.m2.1.2.3.3.3.3.3" xref="S3.SS1.p2.2.m2.1.2.3.3.3.3.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.2.m2.1.2.3.3.3.1a" xref="S3.SS1.p2.2.m2.1.2.3.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.2.m2.1.2.3.3.3.4" xref="S3.SS1.p2.2.m2.1.2.3.3.3.4.cmml">512</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.2.cmml" xref="S3.SS1.p2.2.m2.1.2"><ci id="S3.SS1.p2.2.m2.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2.1">:</ci><apply id="S3.SS1.p2.2.m2.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2.2"><times id="S3.SS1.p2.2.m2.1.2.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2.2.1"></times><apply id="S3.SS1.p2.2.m2.1.2.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.2.2.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2.2.2.2">ℱ</ci><ci id="S3.SS1.p2.2.m2.1.2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.1.2.2.2.3">𝑑</ci></apply><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">⋅</ci></apply><apply id="S3.SS1.p2.2.m2.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.2.3"><ci id="S3.SS1.p2.2.m2.1.2.3.1.cmml" xref="S3.SS1.p2.2.m2.1.2.3.1">→</ci><apply id="S3.SS1.p2.2.m2.1.2.3.2.cmml" xref="S3.SS1.p2.2.m2.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.2.3.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2.3.2">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.2.3.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2.3.2.2">ℝ</ci><apply id="S3.SS1.p2.2.m2.1.2.3.2.3.cmml" xref="S3.SS1.p2.2.m2.1.2.3.2.3"><times id="S3.SS1.p2.2.m2.1.2.3.2.3.1.cmml" xref="S3.SS1.p2.2.m2.1.2.3.2.3.1"></times><ci id="S3.SS1.p2.2.m2.1.2.3.2.3.2.cmml" xref="S3.SS1.p2.2.m2.1.2.3.2.3.2">𝐻</ci><ci id="S3.SS1.p2.2.m2.1.2.3.2.3.3.cmml" xref="S3.SS1.p2.2.m2.1.2.3.2.3.3">𝑊</ci><cn type="integer" id="S3.SS1.p2.2.m2.1.2.3.2.3.4.cmml" xref="S3.SS1.p2.2.m2.1.2.3.2.3.4">3</cn></apply></apply><apply id="S3.SS1.p2.2.m2.1.2.3.3.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.2.3.3.1.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.2.3.3.2.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.2">ℝ</ci><apply id="S3.SS1.p2.2.m2.1.2.3.3.3.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3"><times id="S3.SS1.p2.2.m2.1.2.3.3.3.1.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3.1"></times><apply id="S3.SS1.p2.2.m2.1.2.3.3.3.2.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.2.3.3.3.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3.2">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.2.3.3.3.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3.2.2">𝐻</ci><ci id="S3.SS1.p2.2.m2.1.2.3.3.3.2.3.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3.2.3">′</ci></apply><apply id="S3.SS1.p2.2.m2.1.2.3.3.3.3.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.2.3.3.3.3.1.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3.3">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.2.3.3.3.3.2.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3.3.2">𝑊</ci><ci id="S3.SS1.p2.2.m2.1.2.3.3.3.3.3.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3.3.3">′</ci></apply><cn type="integer" id="S3.SS1.p2.2.m2.1.2.3.3.3.4.cmml" xref="S3.SS1.p2.2.m2.1.2.3.3.3.4">512</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathcal{F}_{d}(\cdot):\mathbb{R}^{H\times W\times 3}\rightarrow\mathbb{R}^{H^{\prime}\times W^{\prime}\times 512}</annotation></semantics></math> computes feature map <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="f_{\mathbf{p}}\in\mathbb{R}^{H^{\prime}\times W^{\prime}\times 512}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><msub id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2.2" xref="S3.SS1.p2.3.m3.1.1.2.2.cmml">f</mi><mi id="S3.SS1.p2.3.m3.1.1.2.3" xref="S3.SS1.p2.3.m3.1.1.2.3.cmml">𝐩</mi></msub><mo id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml"><msup id="S3.SS1.p2.3.m3.1.1.3.3.2" xref="S3.SS1.p2.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.3.2.2" xref="S3.SS1.p2.3.m3.1.1.3.3.2.2.cmml">H</mi><mo id="S3.SS1.p2.3.m3.1.1.3.3.2.3" xref="S3.SS1.p2.3.m3.1.1.3.3.2.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.3.m3.1.1.3.3.1" xref="S3.SS1.p2.3.m3.1.1.3.3.1.cmml">×</mo><msup id="S3.SS1.p2.3.m3.1.1.3.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.3.3.2" xref="S3.SS1.p2.3.m3.1.1.3.3.3.2.cmml">W</mi><mo id="S3.SS1.p2.3.m3.1.1.3.3.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.3.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.3.m3.1.1.3.3.1a" xref="S3.SS1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.3.m3.1.1.3.3.4" xref="S3.SS1.p2.3.m3.1.1.3.3.4.cmml">512</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><in id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></in><apply id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2">𝑓</ci><ci id="S3.SS1.p2.3.m3.1.1.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.2.3">𝐩</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3"><times id="S3.SS1.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.1"></times><apply id="S3.SS1.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.2">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.2.2">𝐻</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.2.3">′</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.3">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.3.2">𝑊</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.3.3">′</ci></apply><cn type="integer" id="S3.SS1.p2.3.m3.1.1.3.3.4.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.4">512</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">f_{\mathbf{p}}\in\mathbb{R}^{H^{\prime}\times W^{\prime}\times 512}</annotation></semantics></math>. Next, a two-stage process is followed: (i) Given backbone feature map <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="f_{\mathbf{p}}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">𝐩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑓</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">f_{\mathbf{p}}</annotation></semantics></math>, a region proposal network (RPN) <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{R}:\mathbb{R}^{H^{\prime}\times W^{\prime}\times 512}\rightarrow\mathbb{R}^{R\times 5}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">ℛ</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">:</mo><mrow id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml"><msup id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.2.2" xref="S3.SS1.p2.5.m5.1.1.3.2.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.5.m5.1.1.3.2.3" xref="S3.SS1.p2.5.m5.1.1.3.2.3.cmml"><msup id="S3.SS1.p2.5.m5.1.1.3.2.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.3.2.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.2.3.2.2" xref="S3.SS1.p2.5.m5.1.1.3.2.3.2.2.cmml">H</mi><mo id="S3.SS1.p2.5.m5.1.1.3.2.3.2.3" xref="S3.SS1.p2.5.m5.1.1.3.2.3.2.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.5.m5.1.1.3.2.3.1" xref="S3.SS1.p2.5.m5.1.1.3.2.3.1.cmml">×</mo><msup id="S3.SS1.p2.5.m5.1.1.3.2.3.3" xref="S3.SS1.p2.5.m5.1.1.3.2.3.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.2.3.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.3.3.2.cmml">W</mi><mo id="S3.SS1.p2.5.m5.1.1.3.2.3.3.3" xref="S3.SS1.p2.5.m5.1.1.3.2.3.3.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.5.m5.1.1.3.2.3.1a" xref="S3.SS1.p2.5.m5.1.1.3.2.3.1.cmml">×</mo><mn id="S3.SS1.p2.5.m5.1.1.3.2.3.4" xref="S3.SS1.p2.5.m5.1.1.3.2.3.4.cmml">512</mn></mrow></msup><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.3.1" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">→</mo><msup id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.3.2" xref="S3.SS1.p2.5.m5.1.1.3.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.5.m5.1.1.3.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.3.3.2" xref="S3.SS1.p2.5.m5.1.1.3.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.5.m5.1.1.3.3.3.1" xref="S3.SS1.p2.5.m5.1.1.3.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.5.m5.1.1.3.3.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.3.3.cmml">5</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><ci id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1">:</ci><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">ℛ</ci><apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><ci id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1">→</ci><apply id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.2">ℝ</ci><apply id="S3.SS1.p2.5.m5.1.1.3.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3"><times id="S3.SS1.p2.5.m5.1.1.3.2.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3.1"></times><apply id="S3.SS1.p2.5.m5.1.1.3.2.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.2.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3.2">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.2.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3.2.2">𝐻</ci><ci id="S3.SS1.p2.5.m5.1.1.3.2.3.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3.2.3">′</ci></apply><apply id="S3.SS1.p2.5.m5.1.1.3.2.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.2.3.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3.3">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.2.3.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3.3.2">𝑊</ci><ci id="S3.SS1.p2.5.m5.1.1.3.2.3.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3.3.3">′</ci></apply><cn type="integer" id="S3.SS1.p2.5.m5.1.1.3.2.3.4.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3.4">512</cn></apply></apply><apply id="S3.SS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2">ℝ</ci><apply id="S3.SS1.p2.5.m5.1.1.3.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.3"><times id="S3.SS1.p2.5.m5.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.3.1"></times><ci id="S3.SS1.p2.5.m5.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.3.2">𝑅</ci><cn type="integer" id="S3.SS1.p2.5.m5.1.1.3.3.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.3.3">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\mathcal{R}:\mathbb{R}^{H^{\prime}\times W^{\prime}\times 512}\rightarrow\mathbb{R}^{R\times 5}</annotation></semantics></math> generates rectangular boxes (i.e., proposals) <math id="S3.SS1.p2.6.m6.3" class="ltx_Math" alttext="\mathbf{r}=\{r_{1},\dots,r_{R}\}" display="inline"><semantics id="S3.SS1.p2.6.m6.3a"><mrow id="S3.SS1.p2.6.m6.3.3" xref="S3.SS1.p2.6.m6.3.3.cmml"><mi id="S3.SS1.p2.6.m6.3.3.4" xref="S3.SS1.p2.6.m6.3.3.4.cmml">𝐫</mi><mo id="S3.SS1.p2.6.m6.3.3.3" xref="S3.SS1.p2.6.m6.3.3.3.cmml">=</mo><mrow id="S3.SS1.p2.6.m6.3.3.2.2" xref="S3.SS1.p2.6.m6.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.6.m6.3.3.2.2.3" xref="S3.SS1.p2.6.m6.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p2.6.m6.2.2.1.1.1" xref="S3.SS1.p2.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.6.m6.2.2.1.1.1.2" xref="S3.SS1.p2.6.m6.2.2.1.1.1.2.cmml">r</mi><mn id="S3.SS1.p2.6.m6.2.2.1.1.1.3" xref="S3.SS1.p2.6.m6.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.6.m6.3.3.2.2.4" xref="S3.SS1.p2.6.m6.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">…</mi><mo id="S3.SS1.p2.6.m6.3.3.2.2.5" xref="S3.SS1.p2.6.m6.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p2.6.m6.3.3.2.2.2" xref="S3.SS1.p2.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.6.m6.3.3.2.2.2.2" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2.cmml">r</mi><mi id="S3.SS1.p2.6.m6.3.3.2.2.2.3" xref="S3.SS1.p2.6.m6.3.3.2.2.2.3.cmml">R</mi></msub><mo stretchy="false" id="S3.SS1.p2.6.m6.3.3.2.2.6" xref="S3.SS1.p2.6.m6.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.3b"><apply id="S3.SS1.p2.6.m6.3.3.cmml" xref="S3.SS1.p2.6.m6.3.3"><eq id="S3.SS1.p2.6.m6.3.3.3.cmml" xref="S3.SS1.p2.6.m6.3.3.3"></eq><ci id="S3.SS1.p2.6.m6.3.3.4.cmml" xref="S3.SS1.p2.6.m6.3.3.4">𝐫</ci><set id="S3.SS1.p2.6.m6.3.3.2.3.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2"><apply id="S3.SS1.p2.6.m6.2.2.1.1.1.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.2">𝑟</ci><cn type="integer" id="S3.SS1.p2.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">…</ci><apply id="S3.SS1.p2.6.m6.3.3.2.2.2.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2">𝑟</ci><ci id="S3.SS1.p2.6.m6.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.3">𝑅</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.3c">\mathbf{r}=\{r_{1},\dots,r_{R}\}</annotation></semantics></math>, where <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{r}\in\mathbb{R}^{R\times 4}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><mrow id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">𝐫</mi><mo id="S3.SS1.p2.7.m7.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml"><mi id="S3.SS1.p2.7.m7.1.1.3.2" xref="S3.SS1.p2.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.7.m7.1.1.3.3" xref="S3.SS1.p2.7.m7.1.1.3.3.cmml"><mi id="S3.SS1.p2.7.m7.1.1.3.3.2" xref="S3.SS1.p2.7.m7.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.7.m7.1.1.3.3.1" xref="S3.SS1.p2.7.m7.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.7.m7.1.1.3.3.3" xref="S3.SS1.p2.7.m7.1.1.3.3.3.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><in id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1"></in><ci id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2">𝐫</ci><apply id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.3.1.cmml" xref="S3.SS1.p2.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.3.2.cmml" xref="S3.SS1.p2.7.m7.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.7.m7.1.1.3.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3.3"><times id="S3.SS1.p2.7.m7.1.1.3.3.1.cmml" xref="S3.SS1.p2.7.m7.1.1.3.3.1"></times><ci id="S3.SS1.p2.7.m7.1.1.3.3.2.cmml" xref="S3.SS1.p2.7.m7.1.1.3.3.2">𝑅</ci><cn type="integer" id="S3.SS1.p2.7.m7.1.1.3.3.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3.3.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">\mathbf{r}\in\mathbb{R}^{R\times 4}</annotation></semantics></math> and “objectness measure” – a scalar <math id="S3.SS1.p2.8.m8.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S3.SS1.p2.8.m8.2a"><mrow id="S3.SS1.p2.8.m8.2.3.2" xref="S3.SS1.p2.8.m8.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.8.m8.2.3.2.1" xref="S3.SS1.p2.8.m8.2.3.1.cmml">[</mo><mn id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">0</mn><mo id="S3.SS1.p2.8.m8.2.3.2.2" xref="S3.SS1.p2.8.m8.2.3.1.cmml">,</mo><mn id="S3.SS1.p2.8.m8.2.2" xref="S3.SS1.p2.8.m8.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS1.p2.8.m8.2.3.2.3" xref="S3.SS1.p2.8.m8.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.2b"><interval closure="closed" id="S3.SS1.p2.8.m8.2.3.1.cmml" xref="S3.SS1.p2.8.m8.2.3.2"><cn type="integer" id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">0</cn><cn type="integer" id="S3.SS1.p2.8.m8.2.2.cmml" xref="S3.SS1.p2.8.m8.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.2c">[0,1]</annotation></semantics></math> probability of the box <math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="r_{j}" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><msub id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><mi id="S3.SS1.p2.9.m9.1.1.2" xref="S3.SS1.p2.9.m9.1.1.2.cmml">r</mi><mi id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2">𝑟</ci><ci id="S3.SS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">r_{j}</annotation></semantics></math> having an object. (ii) Using proposals <math id="S3.SS1.p2.10.m10.1" class="ltx_Math" alttext="\mathbf{r}\in\mathbb{R}^{R\times 4}" display="inline"><semantics id="S3.SS1.p2.10.m10.1a"><mrow id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml">𝐫</mi><mo id="S3.SS1.p2.10.m10.1.1.1" xref="S3.SS1.p2.10.m10.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml"><mi id="S3.SS1.p2.10.m10.1.1.3.2" xref="S3.SS1.p2.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.10.m10.1.1.3.3" xref="S3.SS1.p2.10.m10.1.1.3.3.cmml"><mi id="S3.SS1.p2.10.m10.1.1.3.3.2" xref="S3.SS1.p2.10.m10.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.10.m10.1.1.3.3.1" xref="S3.SS1.p2.10.m10.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.10.m10.1.1.3.3.3" xref="S3.SS1.p2.10.m10.1.1.3.3.3.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><in id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1"></in><ci id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2">𝐫</ci><apply id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.10.m10.1.1.3.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3.3"><times id="S3.SS1.p2.10.m10.1.1.3.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.3.3.1"></times><ci id="S3.SS1.p2.10.m10.1.1.3.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.3.3.2">𝑅</ci><cn type="integer" id="S3.SS1.p2.10.m10.1.1.3.3.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3.3.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">\mathbf{r}\in\mathbb{R}^{R\times 4}</annotation></semantics></math> we pool the feature map <math id="S3.SS1.p2.11.m11.1" class="ltx_Math" alttext="f_{\mathbf{p}}" display="inline"><semantics id="S3.SS1.p2.11.m11.1a"><msub id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml">f</mi><mi id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml">𝐩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2">𝑓</ci><ci id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">f_{\mathbf{p}}</annotation></semantics></math> via RoI pool <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> to get intermediate feature of size <math id="S3.SS1.p2.12.m12.1" class="ltx_Math" alttext="\mathbb{R}^{7\times 7\times 512}" display="inline"><semantics id="S3.SS1.p2.12.m12.1a"><msup id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2" xref="S3.SS1.p2.12.m12.1.1.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml"><mn id="S3.SS1.p2.12.m12.1.1.3.2" xref="S3.SS1.p2.12.m12.1.1.3.2.cmml">7</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.12.m12.1.1.3.1" xref="S3.SS1.p2.12.m12.1.1.3.1.cmml">×</mo><mn id="S3.SS1.p2.12.m12.1.1.3.3" xref="S3.SS1.p2.12.m12.1.1.3.3.cmml">7</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.12.m12.1.1.3.1a" xref="S3.SS1.p2.12.m12.1.1.3.1.cmml">×</mo><mn id="S3.SS1.p2.12.m12.1.1.3.4" xref="S3.SS1.p2.12.m12.1.1.3.4.cmml">512</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">superscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2">ℝ</ci><apply id="S3.SS1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3"><times id="S3.SS1.p2.12.m12.1.1.3.1.cmml" xref="S3.SS1.p2.12.m12.1.1.3.1"></times><cn type="integer" id="S3.SS1.p2.12.m12.1.1.3.2.cmml" xref="S3.SS1.p2.12.m12.1.1.3.2">7</cn><cn type="integer" id="S3.SS1.p2.12.m12.1.1.3.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3">7</cn><cn type="integer" id="S3.SS1.p2.12.m12.1.1.3.4.cmml" xref="S3.SS1.p2.12.m12.1.1.3.4">512</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">\mathbb{R}^{7\times 7\times 512}</annotation></semantics></math>, followed by a fully-connected layer (FC) to get <math id="S3.SS1.p2.13.m13.1" class="ltx_Math" alttext="f_{\mathbf{r}}\in\mathbb{R}^{R\times 512}" display="inline"><semantics id="S3.SS1.p2.13.m13.1a"><mrow id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml"><msub id="S3.SS1.p2.13.m13.1.1.2" xref="S3.SS1.p2.13.m13.1.1.2.cmml"><mi id="S3.SS1.p2.13.m13.1.1.2.2" xref="S3.SS1.p2.13.m13.1.1.2.2.cmml">f</mi><mi id="S3.SS1.p2.13.m13.1.1.2.3" xref="S3.SS1.p2.13.m13.1.1.2.3.cmml">𝐫</mi></msub><mo id="S3.SS1.p2.13.m13.1.1.1" xref="S3.SS1.p2.13.m13.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.13.m13.1.1.3" xref="S3.SS1.p2.13.m13.1.1.3.cmml"><mi id="S3.SS1.p2.13.m13.1.1.3.2" xref="S3.SS1.p2.13.m13.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.13.m13.1.1.3.3" xref="S3.SS1.p2.13.m13.1.1.3.3.cmml"><mi id="S3.SS1.p2.13.m13.1.1.3.3.2" xref="S3.SS1.p2.13.m13.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.13.m13.1.1.3.3.1" xref="S3.SS1.p2.13.m13.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.13.m13.1.1.3.3.3" xref="S3.SS1.p2.13.m13.1.1.3.3.3.cmml">512</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><apply id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1"><in id="S3.SS1.p2.13.m13.1.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1.1"></in><apply id="S3.SS1.p2.13.m13.1.1.2.cmml" xref="S3.SS1.p2.13.m13.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.1.1.2.1.cmml" xref="S3.SS1.p2.13.m13.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.13.m13.1.1.2.2.cmml" xref="S3.SS1.p2.13.m13.1.1.2.2">𝑓</ci><ci id="S3.SS1.p2.13.m13.1.1.2.3.cmml" xref="S3.SS1.p2.13.m13.1.1.2.3">𝐫</ci></apply><apply id="S3.SS1.p2.13.m13.1.1.3.cmml" xref="S3.SS1.p2.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.1.1.3.1.cmml" xref="S3.SS1.p2.13.m13.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.13.m13.1.1.3.2.cmml" xref="S3.SS1.p2.13.m13.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.13.m13.1.1.3.3.cmml" xref="S3.SS1.p2.13.m13.1.1.3.3"><times id="S3.SS1.p2.13.m13.1.1.3.3.1.cmml" xref="S3.SS1.p2.13.m13.1.1.3.3.1"></times><ci id="S3.SS1.p2.13.m13.1.1.3.3.2.cmml" xref="S3.SS1.p2.13.m13.1.1.3.3.2">𝑅</ci><cn type="integer" id="S3.SS1.p2.13.m13.1.1.3.3.3.cmml" xref="S3.SS1.p2.13.m13.1.1.3.3.3">512</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">f_{\mathbf{r}}\in\mathbb{R}^{R\times 512}</annotation></semantics></math> as, <math id="S3.SS1.p2.14.m14.2" class="ltx_Math" alttext="f_{\mathbf{r}}=\mathcal{P}(f_{\mathbf{p}},\mathbf{r})" display="inline"><semantics id="S3.SS1.p2.14.m14.2a"><mrow id="S3.SS1.p2.14.m14.2.2" xref="S3.SS1.p2.14.m14.2.2.cmml"><msub id="S3.SS1.p2.14.m14.2.2.3" xref="S3.SS1.p2.14.m14.2.2.3.cmml"><mi id="S3.SS1.p2.14.m14.2.2.3.2" xref="S3.SS1.p2.14.m14.2.2.3.2.cmml">f</mi><mi id="S3.SS1.p2.14.m14.2.2.3.3" xref="S3.SS1.p2.14.m14.2.2.3.3.cmml">𝐫</mi></msub><mo id="S3.SS1.p2.14.m14.2.2.2" xref="S3.SS1.p2.14.m14.2.2.2.cmml">=</mo><mrow id="S3.SS1.p2.14.m14.2.2.1" xref="S3.SS1.p2.14.m14.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.14.m14.2.2.1.3" xref="S3.SS1.p2.14.m14.2.2.1.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.14.m14.2.2.1.2" xref="S3.SS1.p2.14.m14.2.2.1.2.cmml">​</mo><mrow id="S3.SS1.p2.14.m14.2.2.1.1.1" xref="S3.SS1.p2.14.m14.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.14.m14.2.2.1.1.1.2" xref="S3.SS1.p2.14.m14.2.2.1.1.2.cmml">(</mo><msub id="S3.SS1.p2.14.m14.2.2.1.1.1.1" xref="S3.SS1.p2.14.m14.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p2.14.m14.2.2.1.1.1.1.2" xref="S3.SS1.p2.14.m14.2.2.1.1.1.1.2.cmml">f</mi><mi id="S3.SS1.p2.14.m14.2.2.1.1.1.1.3" xref="S3.SS1.p2.14.m14.2.2.1.1.1.1.3.cmml">𝐩</mi></msub><mo id="S3.SS1.p2.14.m14.2.2.1.1.1.3" xref="S3.SS1.p2.14.m14.2.2.1.1.2.cmml">,</mo><mi id="S3.SS1.p2.14.m14.1.1" xref="S3.SS1.p2.14.m14.1.1.cmml">𝐫</mi><mo stretchy="false" id="S3.SS1.p2.14.m14.2.2.1.1.1.4" xref="S3.SS1.p2.14.m14.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m14.2b"><apply id="S3.SS1.p2.14.m14.2.2.cmml" xref="S3.SS1.p2.14.m14.2.2"><eq id="S3.SS1.p2.14.m14.2.2.2.cmml" xref="S3.SS1.p2.14.m14.2.2.2"></eq><apply id="S3.SS1.p2.14.m14.2.2.3.cmml" xref="S3.SS1.p2.14.m14.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m14.2.2.3.1.cmml" xref="S3.SS1.p2.14.m14.2.2.3">subscript</csymbol><ci id="S3.SS1.p2.14.m14.2.2.3.2.cmml" xref="S3.SS1.p2.14.m14.2.2.3.2">𝑓</ci><ci id="S3.SS1.p2.14.m14.2.2.3.3.cmml" xref="S3.SS1.p2.14.m14.2.2.3.3">𝐫</ci></apply><apply id="S3.SS1.p2.14.m14.2.2.1.cmml" xref="S3.SS1.p2.14.m14.2.2.1"><times id="S3.SS1.p2.14.m14.2.2.1.2.cmml" xref="S3.SS1.p2.14.m14.2.2.1.2"></times><ci id="S3.SS1.p2.14.m14.2.2.1.3.cmml" xref="S3.SS1.p2.14.m14.2.2.1.3">𝒫</ci><interval closure="open" id="S3.SS1.p2.14.m14.2.2.1.1.2.cmml" xref="S3.SS1.p2.14.m14.2.2.1.1.1"><apply id="S3.SS1.p2.14.m14.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.14.m14.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m14.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p2.14.m14.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.14.m14.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p2.14.m14.2.2.1.1.1.1.2">𝑓</ci><ci id="S3.SS1.p2.14.m14.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p2.14.m14.2.2.1.1.1.1.3">𝐩</ci></apply><ci id="S3.SS1.p2.14.m14.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1">𝐫</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m14.2c">f_{\mathbf{r}}=\mathcal{P}(f_{\mathbf{p}},\mathbf{r})</annotation></semantics></math>. The patch feature <math id="S3.SS1.p2.15.m15.1" class="ltx_Math" alttext="f_{\mathbf{r}}" display="inline"><semantics id="S3.SS1.p2.15.m15.1a"><msub id="S3.SS1.p2.15.m15.1.1" xref="S3.SS1.p2.15.m15.1.1.cmml"><mi id="S3.SS1.p2.15.m15.1.1.2" xref="S3.SS1.p2.15.m15.1.1.2.cmml">f</mi><mi id="S3.SS1.p2.15.m15.1.1.3" xref="S3.SS1.p2.15.m15.1.1.3.cmml">𝐫</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m15.1b"><apply id="S3.SS1.p2.15.m15.1.1.cmml" xref="S3.SS1.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m15.1.1.1.cmml" xref="S3.SS1.p2.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p2.15.m15.1.1.2.cmml" xref="S3.SS1.p2.15.m15.1.1.2">𝑓</ci><ci id="S3.SS1.p2.15.m15.1.1.3.cmml" xref="S3.SS1.p2.15.m15.1.1.3">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m15.1c">f_{\mathbf{r}}</annotation></semantics></math> is branched into two streams – a classification branch <math id="S3.SS1.p2.16.m16.2" class="ltx_Math" alttext="\phi_{\mathrm{cls}}:\mathbb{R}^{R\times 512}\rightarrow\mathbb{R}^{R\times(|\mathcal{C}|+1)}" display="inline"><semantics id="S3.SS1.p2.16.m16.2a"><mrow id="S3.SS1.p2.16.m16.2.3" xref="S3.SS1.p2.16.m16.2.3.cmml"><msub id="S3.SS1.p2.16.m16.2.3.2" xref="S3.SS1.p2.16.m16.2.3.2.cmml"><mi id="S3.SS1.p2.16.m16.2.3.2.2" xref="S3.SS1.p2.16.m16.2.3.2.2.cmml">ϕ</mi><mi id="S3.SS1.p2.16.m16.2.3.2.3" xref="S3.SS1.p2.16.m16.2.3.2.3.cmml">cls</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.16.m16.2.3.1" xref="S3.SS1.p2.16.m16.2.3.1.cmml">:</mo><mrow id="S3.SS1.p2.16.m16.2.3.3" xref="S3.SS1.p2.16.m16.2.3.3.cmml"><msup id="S3.SS1.p2.16.m16.2.3.3.2" xref="S3.SS1.p2.16.m16.2.3.3.2.cmml"><mi id="S3.SS1.p2.16.m16.2.3.3.2.2" xref="S3.SS1.p2.16.m16.2.3.3.2.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.16.m16.2.3.3.2.3" xref="S3.SS1.p2.16.m16.2.3.3.2.3.cmml"><mi id="S3.SS1.p2.16.m16.2.3.3.2.3.2" xref="S3.SS1.p2.16.m16.2.3.3.2.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.16.m16.2.3.3.2.3.1" xref="S3.SS1.p2.16.m16.2.3.3.2.3.1.cmml">×</mo><mn id="S3.SS1.p2.16.m16.2.3.3.2.3.3" xref="S3.SS1.p2.16.m16.2.3.3.2.3.3.cmml">512</mn></mrow></msup><mo stretchy="false" id="S3.SS1.p2.16.m16.2.3.3.1" xref="S3.SS1.p2.16.m16.2.3.3.1.cmml">→</mo><msup id="S3.SS1.p2.16.m16.2.3.3.3" xref="S3.SS1.p2.16.m16.2.3.3.3.cmml"><mi id="S3.SS1.p2.16.m16.2.3.3.3.2" xref="S3.SS1.p2.16.m16.2.3.3.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.16.m16.2.2.2" xref="S3.SS1.p2.16.m16.2.2.2.cmml"><mi id="S3.SS1.p2.16.m16.2.2.2.4" xref="S3.SS1.p2.16.m16.2.2.2.4.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.16.m16.2.2.2.3" xref="S3.SS1.p2.16.m16.2.2.2.3.cmml">×</mo><mrow id="S3.SS1.p2.16.m16.2.2.2.2.1" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.16.m16.2.2.2.2.1.2" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS1.p2.16.m16.2.2.2.2.1.1" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.cmml"><mrow id="S3.SS1.p2.16.m16.2.2.2.2.1.1.2.2" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S3.SS1.p2.16.m16.2.2.2.2.1.1.2.2.1" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.16.m16.1.1.1.1" xref="S3.SS1.p2.16.m16.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS1.p2.16.m16.2.2.2.2.1.1.2.2.2" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS1.p2.16.m16.2.2.2.2.1.1.1" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.1.cmml">+</mo><mn id="S3.SS1.p2.16.m16.2.2.2.2.1.1.3" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.p2.16.m16.2.2.2.2.1.3" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m16.2b"><apply id="S3.SS1.p2.16.m16.2.3.cmml" xref="S3.SS1.p2.16.m16.2.3"><ci id="S3.SS1.p2.16.m16.2.3.1.cmml" xref="S3.SS1.p2.16.m16.2.3.1">:</ci><apply id="S3.SS1.p2.16.m16.2.3.2.cmml" xref="S3.SS1.p2.16.m16.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m16.2.3.2.1.cmml" xref="S3.SS1.p2.16.m16.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.16.m16.2.3.2.2.cmml" xref="S3.SS1.p2.16.m16.2.3.2.2">italic-ϕ</ci><ci id="S3.SS1.p2.16.m16.2.3.2.3.cmml" xref="S3.SS1.p2.16.m16.2.3.2.3">cls</ci></apply><apply id="S3.SS1.p2.16.m16.2.3.3.cmml" xref="S3.SS1.p2.16.m16.2.3.3"><ci id="S3.SS1.p2.16.m16.2.3.3.1.cmml" xref="S3.SS1.p2.16.m16.2.3.3.1">→</ci><apply id="S3.SS1.p2.16.m16.2.3.3.2.cmml" xref="S3.SS1.p2.16.m16.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m16.2.3.3.2.1.cmml" xref="S3.SS1.p2.16.m16.2.3.3.2">superscript</csymbol><ci id="S3.SS1.p2.16.m16.2.3.3.2.2.cmml" xref="S3.SS1.p2.16.m16.2.3.3.2.2">ℝ</ci><apply id="S3.SS1.p2.16.m16.2.3.3.2.3.cmml" xref="S3.SS1.p2.16.m16.2.3.3.2.3"><times id="S3.SS1.p2.16.m16.2.3.3.2.3.1.cmml" xref="S3.SS1.p2.16.m16.2.3.3.2.3.1"></times><ci id="S3.SS1.p2.16.m16.2.3.3.2.3.2.cmml" xref="S3.SS1.p2.16.m16.2.3.3.2.3.2">𝑅</ci><cn type="integer" id="S3.SS1.p2.16.m16.2.3.3.2.3.3.cmml" xref="S3.SS1.p2.16.m16.2.3.3.2.3.3">512</cn></apply></apply><apply id="S3.SS1.p2.16.m16.2.3.3.3.cmml" xref="S3.SS1.p2.16.m16.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m16.2.3.3.3.1.cmml" xref="S3.SS1.p2.16.m16.2.3.3.3">superscript</csymbol><ci id="S3.SS1.p2.16.m16.2.3.3.3.2.cmml" xref="S3.SS1.p2.16.m16.2.3.3.3.2">ℝ</ci><apply id="S3.SS1.p2.16.m16.2.2.2.cmml" xref="S3.SS1.p2.16.m16.2.2.2"><times id="S3.SS1.p2.16.m16.2.2.2.3.cmml" xref="S3.SS1.p2.16.m16.2.2.2.3"></times><ci id="S3.SS1.p2.16.m16.2.2.2.4.cmml" xref="S3.SS1.p2.16.m16.2.2.2.4">𝑅</ci><apply id="S3.SS1.p2.16.m16.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.16.m16.2.2.2.2.1"><plus id="S3.SS1.p2.16.m16.2.2.2.2.1.1.1.cmml" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.1"></plus><apply id="S3.SS1.p2.16.m16.2.2.2.2.1.1.2.1.cmml" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.2.2"><abs id="S3.SS1.p2.16.m16.2.2.2.2.1.1.2.1.1.cmml" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.2.2.1"></abs><ci id="S3.SS1.p2.16.m16.1.1.1.1.cmml" xref="S3.SS1.p2.16.m16.1.1.1.1">𝒞</ci></apply><cn type="integer" id="S3.SS1.p2.16.m16.2.2.2.2.1.1.3.cmml" xref="S3.SS1.p2.16.m16.2.2.2.2.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m16.2c">\phi_{\mathrm{cls}}:\mathbb{R}^{R\times 512}\rightarrow\mathbb{R}^{R\times(|\mathcal{C}|+1)}</annotation></semantics></math> outputs probability distribution (per RoI) over <math id="S3.SS1.p2.17.m17.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS1.p2.17.m17.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.17.m17.1.1" xref="S3.SS1.p2.17.m17.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.17.m17.1b"><ci id="S3.SS1.p2.17.m17.1.1.cmml" xref="S3.SS1.p2.17.m17.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.17.m17.1c">\mathcal{C}</annotation></semantics></math> pre-defined classes and a catch-all background class; a box regressions <math id="S3.SS1.p2.18.m18.1" class="ltx_Math" alttext="\phi_{\mathrm{reg}}:\mathbb{R}^{R\times 512}\rightarrow\mathbb{R}^{R\times 4}" display="inline"><semantics id="S3.SS1.p2.18.m18.1a"><mrow id="S3.SS1.p2.18.m18.1.1" xref="S3.SS1.p2.18.m18.1.1.cmml"><msub id="S3.SS1.p2.18.m18.1.1.2" xref="S3.SS1.p2.18.m18.1.1.2.cmml"><mi id="S3.SS1.p2.18.m18.1.1.2.2" xref="S3.SS1.p2.18.m18.1.1.2.2.cmml">ϕ</mi><mi id="S3.SS1.p2.18.m18.1.1.2.3" xref="S3.SS1.p2.18.m18.1.1.2.3.cmml">reg</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.18.m18.1.1.1" xref="S3.SS1.p2.18.m18.1.1.1.cmml">:</mo><mrow id="S3.SS1.p2.18.m18.1.1.3" xref="S3.SS1.p2.18.m18.1.1.3.cmml"><msup id="S3.SS1.p2.18.m18.1.1.3.2" xref="S3.SS1.p2.18.m18.1.1.3.2.cmml"><mi id="S3.SS1.p2.18.m18.1.1.3.2.2" xref="S3.SS1.p2.18.m18.1.1.3.2.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.18.m18.1.1.3.2.3" xref="S3.SS1.p2.18.m18.1.1.3.2.3.cmml"><mi id="S3.SS1.p2.18.m18.1.1.3.2.3.2" xref="S3.SS1.p2.18.m18.1.1.3.2.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.18.m18.1.1.3.2.3.1" xref="S3.SS1.p2.18.m18.1.1.3.2.3.1.cmml">×</mo><mn id="S3.SS1.p2.18.m18.1.1.3.2.3.3" xref="S3.SS1.p2.18.m18.1.1.3.2.3.3.cmml">512</mn></mrow></msup><mo stretchy="false" id="S3.SS1.p2.18.m18.1.1.3.1" xref="S3.SS1.p2.18.m18.1.1.3.1.cmml">→</mo><msup id="S3.SS1.p2.18.m18.1.1.3.3" xref="S3.SS1.p2.18.m18.1.1.3.3.cmml"><mi id="S3.SS1.p2.18.m18.1.1.3.3.2" xref="S3.SS1.p2.18.m18.1.1.3.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.18.m18.1.1.3.3.3" xref="S3.SS1.p2.18.m18.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.18.m18.1.1.3.3.3.2" xref="S3.SS1.p2.18.m18.1.1.3.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.18.m18.1.1.3.3.3.1" xref="S3.SS1.p2.18.m18.1.1.3.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.18.m18.1.1.3.3.3.3" xref="S3.SS1.p2.18.m18.1.1.3.3.3.3.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.18.m18.1b"><apply id="S3.SS1.p2.18.m18.1.1.cmml" xref="S3.SS1.p2.18.m18.1.1"><ci id="S3.SS1.p2.18.m18.1.1.1.cmml" xref="S3.SS1.p2.18.m18.1.1.1">:</ci><apply id="S3.SS1.p2.18.m18.1.1.2.cmml" xref="S3.SS1.p2.18.m18.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m18.1.1.2.1.cmml" xref="S3.SS1.p2.18.m18.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.18.m18.1.1.2.2.cmml" xref="S3.SS1.p2.18.m18.1.1.2.2">italic-ϕ</ci><ci id="S3.SS1.p2.18.m18.1.1.2.3.cmml" xref="S3.SS1.p2.18.m18.1.1.2.3">reg</ci></apply><apply id="S3.SS1.p2.18.m18.1.1.3.cmml" xref="S3.SS1.p2.18.m18.1.1.3"><ci id="S3.SS1.p2.18.m18.1.1.3.1.cmml" xref="S3.SS1.p2.18.m18.1.1.3.1">→</ci><apply id="S3.SS1.p2.18.m18.1.1.3.2.cmml" xref="S3.SS1.p2.18.m18.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m18.1.1.3.2.1.cmml" xref="S3.SS1.p2.18.m18.1.1.3.2">superscript</csymbol><ci id="S3.SS1.p2.18.m18.1.1.3.2.2.cmml" xref="S3.SS1.p2.18.m18.1.1.3.2.2">ℝ</ci><apply id="S3.SS1.p2.18.m18.1.1.3.2.3.cmml" xref="S3.SS1.p2.18.m18.1.1.3.2.3"><times id="S3.SS1.p2.18.m18.1.1.3.2.3.1.cmml" xref="S3.SS1.p2.18.m18.1.1.3.2.3.1"></times><ci id="S3.SS1.p2.18.m18.1.1.3.2.3.2.cmml" xref="S3.SS1.p2.18.m18.1.1.3.2.3.2">𝑅</ci><cn type="integer" id="S3.SS1.p2.18.m18.1.1.3.2.3.3.cmml" xref="S3.SS1.p2.18.m18.1.1.3.2.3.3">512</cn></apply></apply><apply id="S3.SS1.p2.18.m18.1.1.3.3.cmml" xref="S3.SS1.p2.18.m18.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m18.1.1.3.3.1.cmml" xref="S3.SS1.p2.18.m18.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p2.18.m18.1.1.3.3.2.cmml" xref="S3.SS1.p2.18.m18.1.1.3.3.2">ℝ</ci><apply id="S3.SS1.p2.18.m18.1.1.3.3.3.cmml" xref="S3.SS1.p2.18.m18.1.1.3.3.3"><times id="S3.SS1.p2.18.m18.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.18.m18.1.1.3.3.3.1"></times><ci id="S3.SS1.p2.18.m18.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.18.m18.1.1.3.3.3.2">𝑅</ci><cn type="integer" id="S3.SS1.p2.18.m18.1.1.3.3.3.3.cmml" xref="S3.SS1.p2.18.m18.1.1.3.3.3.3">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.18.m18.1c">\phi_{\mathrm{reg}}:\mathbb{R}^{R\times 512}\rightarrow\mathbb{R}^{R\times 4}</annotation></semantics></math> refines initial box predictions <math id="S3.SS1.p2.19.m19.1" class="ltx_Math" alttext="\mathbf{r}\in\mathbb{R}^{R\times 4}" display="inline"><semantics id="S3.SS1.p2.19.m19.1a"><mrow id="S3.SS1.p2.19.m19.1.1" xref="S3.SS1.p2.19.m19.1.1.cmml"><mi id="S3.SS1.p2.19.m19.1.1.2" xref="S3.SS1.p2.19.m19.1.1.2.cmml">𝐫</mi><mo id="S3.SS1.p2.19.m19.1.1.1" xref="S3.SS1.p2.19.m19.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.19.m19.1.1.3" xref="S3.SS1.p2.19.m19.1.1.3.cmml"><mi id="S3.SS1.p2.19.m19.1.1.3.2" xref="S3.SS1.p2.19.m19.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.19.m19.1.1.3.3" xref="S3.SS1.p2.19.m19.1.1.3.3.cmml"><mi id="S3.SS1.p2.19.m19.1.1.3.3.2" xref="S3.SS1.p2.19.m19.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.19.m19.1.1.3.3.1" xref="S3.SS1.p2.19.m19.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.19.m19.1.1.3.3.3" xref="S3.SS1.p2.19.m19.1.1.3.3.3.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.19.m19.1b"><apply id="S3.SS1.p2.19.m19.1.1.cmml" xref="S3.SS1.p2.19.m19.1.1"><in id="S3.SS1.p2.19.m19.1.1.1.cmml" xref="S3.SS1.p2.19.m19.1.1.1"></in><ci id="S3.SS1.p2.19.m19.1.1.2.cmml" xref="S3.SS1.p2.19.m19.1.1.2">𝐫</ci><apply id="S3.SS1.p2.19.m19.1.1.3.cmml" xref="S3.SS1.p2.19.m19.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m19.1.1.3.1.cmml" xref="S3.SS1.p2.19.m19.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.19.m19.1.1.3.2.cmml" xref="S3.SS1.p2.19.m19.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.19.m19.1.1.3.3.cmml" xref="S3.SS1.p2.19.m19.1.1.3.3"><times id="S3.SS1.p2.19.m19.1.1.3.3.1.cmml" xref="S3.SS1.p2.19.m19.1.1.3.3.1"></times><ci id="S3.SS1.p2.19.m19.1.1.3.3.2.cmml" xref="S3.SS1.p2.19.m19.1.1.3.3.2">𝑅</ci><cn type="integer" id="S3.SS1.p2.19.m19.1.1.3.3.3.cmml" xref="S3.SS1.p2.19.m19.1.1.3.3.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.19.m19.1c">\mathbf{r}\in\mathbb{R}^{R\times 4}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.11" class="ltx_p"><span id="S3.SS1.p3.11.1" class="ltx_text ltx_font_bold">Baseline SBIR Framework</span>  We recap a baseline SBIR framework. Given a sketch/photo pair (<math id="S3.SS1.p3.1.m1.2" class="ltx_Math" alttext="\mathbf{s},\mathbf{p}" display="inline"><semantics id="S3.SS1.p3.1.m1.2a"><mrow id="S3.SS1.p3.1.m1.2.3.2" xref="S3.SS1.p3.1.m1.2.3.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">𝐬</mi><mo id="S3.SS1.p3.1.m1.2.3.2.1" xref="S3.SS1.p3.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS1.p3.1.m1.2.2" xref="S3.SS1.p3.1.m1.2.2.cmml">𝐩</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.2b"><list id="S3.SS1.p3.1.m1.2.3.1.cmml" xref="S3.SS1.p3.1.m1.2.3.2"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝐬</ci><ci id="S3.SS1.p3.1.m1.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2">𝐩</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.2c">\mathbf{s},\mathbf{p}</annotation></semantics></math>), we use a sketch/photo feature extractor to get the feature map <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="f_{\mathbf{s}}=\mathcal{F}_{\mathbf{s}}(\mathbf{s})\in\mathbb{R}^{512}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.2" xref="S3.SS1.p3.2.m2.1.2.cmml"><msub id="S3.SS1.p3.2.m2.1.2.2" xref="S3.SS1.p3.2.m2.1.2.2.cmml"><mi id="S3.SS1.p3.2.m2.1.2.2.2" xref="S3.SS1.p3.2.m2.1.2.2.2.cmml">f</mi><mi id="S3.SS1.p3.2.m2.1.2.2.3" xref="S3.SS1.p3.2.m2.1.2.2.3.cmml">𝐬</mi></msub><mo id="S3.SS1.p3.2.m2.1.2.3" xref="S3.SS1.p3.2.m2.1.2.3.cmml">=</mo><mrow id="S3.SS1.p3.2.m2.1.2.4" xref="S3.SS1.p3.2.m2.1.2.4.cmml"><msub id="S3.SS1.p3.2.m2.1.2.4.2" xref="S3.SS1.p3.2.m2.1.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.2.m2.1.2.4.2.2" xref="S3.SS1.p3.2.m2.1.2.4.2.2.cmml">ℱ</mi><mi id="S3.SS1.p3.2.m2.1.2.4.2.3" xref="S3.SS1.p3.2.m2.1.2.4.2.3.cmml">𝐬</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p3.2.m2.1.2.4.1" xref="S3.SS1.p3.2.m2.1.2.4.1.cmml">​</mo><mrow id="S3.SS1.p3.2.m2.1.2.4.3.2" xref="S3.SS1.p3.2.m2.1.2.4.cmml"><mo stretchy="false" id="S3.SS1.p3.2.m2.1.2.4.3.2.1" xref="S3.SS1.p3.2.m2.1.2.4.cmml">(</mo><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">𝐬</mi><mo stretchy="false" id="S3.SS1.p3.2.m2.1.2.4.3.2.2" xref="S3.SS1.p3.2.m2.1.2.4.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.2.m2.1.2.5" xref="S3.SS1.p3.2.m2.1.2.5.cmml">∈</mo><msup id="S3.SS1.p3.2.m2.1.2.6" xref="S3.SS1.p3.2.m2.1.2.6.cmml"><mi id="S3.SS1.p3.2.m2.1.2.6.2" xref="S3.SS1.p3.2.m2.1.2.6.2.cmml">ℝ</mi><mn id="S3.SS1.p3.2.m2.1.2.6.3" xref="S3.SS1.p3.2.m2.1.2.6.3.cmml">512</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.2.cmml" xref="S3.SS1.p3.2.m2.1.2"><and id="S3.SS1.p3.2.m2.1.2a.cmml" xref="S3.SS1.p3.2.m2.1.2"></and><apply id="S3.SS1.p3.2.m2.1.2b.cmml" xref="S3.SS1.p3.2.m2.1.2"><eq id="S3.SS1.p3.2.m2.1.2.3.cmml" xref="S3.SS1.p3.2.m2.1.2.3"></eq><apply id="S3.SS1.p3.2.m2.1.2.2.cmml" xref="S3.SS1.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.2.2.1.cmml" xref="S3.SS1.p3.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.2.2.2.cmml" xref="S3.SS1.p3.2.m2.1.2.2.2">𝑓</ci><ci id="S3.SS1.p3.2.m2.1.2.2.3.cmml" xref="S3.SS1.p3.2.m2.1.2.2.3">𝐬</ci></apply><apply id="S3.SS1.p3.2.m2.1.2.4.cmml" xref="S3.SS1.p3.2.m2.1.2.4"><times id="S3.SS1.p3.2.m2.1.2.4.1.cmml" xref="S3.SS1.p3.2.m2.1.2.4.1"></times><apply id="S3.SS1.p3.2.m2.1.2.4.2.cmml" xref="S3.SS1.p3.2.m2.1.2.4.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.2.4.2.1.cmml" xref="S3.SS1.p3.2.m2.1.2.4.2">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.2.4.2.2.cmml" xref="S3.SS1.p3.2.m2.1.2.4.2.2">ℱ</ci><ci id="S3.SS1.p3.2.m2.1.2.4.2.3.cmml" xref="S3.SS1.p3.2.m2.1.2.4.2.3">𝐬</ci></apply><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝐬</ci></apply></apply><apply id="S3.SS1.p3.2.m2.1.2c.cmml" xref="S3.SS1.p3.2.m2.1.2"><in id="S3.SS1.p3.2.m2.1.2.5.cmml" xref="S3.SS1.p3.2.m2.1.2.5"></in><share href="#S3.SS1.p3.2.m2.1.2.4.cmml" id="S3.SS1.p3.2.m2.1.2d.cmml" xref="S3.SS1.p3.2.m2.1.2"></share><apply id="S3.SS1.p3.2.m2.1.2.6.cmml" xref="S3.SS1.p3.2.m2.1.2.6"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.2.6.1.cmml" xref="S3.SS1.p3.2.m2.1.2.6">superscript</csymbol><ci id="S3.SS1.p3.2.m2.1.2.6.2.cmml" xref="S3.SS1.p3.2.m2.1.2.6.2">ℝ</ci><cn type="integer" id="S3.SS1.p3.2.m2.1.2.6.3.cmml" xref="S3.SS1.p3.2.m2.1.2.6.3">512</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">f_{\mathbf{s}}=\mathcal{F}_{\mathbf{s}}(\mathbf{s})\in\mathbb{R}^{512}</annotation></semantics></math> and <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="f_{\mathbf{p}}=\mathcal{F}_{\mathbf{p}}(\mathbf{p})\in\mathbb{R}^{512}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mrow id="S3.SS1.p3.3.m3.1.2" xref="S3.SS1.p3.3.m3.1.2.cmml"><msub id="S3.SS1.p3.3.m3.1.2.2" xref="S3.SS1.p3.3.m3.1.2.2.cmml"><mi id="S3.SS1.p3.3.m3.1.2.2.2" xref="S3.SS1.p3.3.m3.1.2.2.2.cmml">f</mi><mi id="S3.SS1.p3.3.m3.1.2.2.3" xref="S3.SS1.p3.3.m3.1.2.2.3.cmml">𝐩</mi></msub><mo id="S3.SS1.p3.3.m3.1.2.3" xref="S3.SS1.p3.3.m3.1.2.3.cmml">=</mo><mrow id="S3.SS1.p3.3.m3.1.2.4" xref="S3.SS1.p3.3.m3.1.2.4.cmml"><msub id="S3.SS1.p3.3.m3.1.2.4.2" xref="S3.SS1.p3.3.m3.1.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.3.m3.1.2.4.2.2" xref="S3.SS1.p3.3.m3.1.2.4.2.2.cmml">ℱ</mi><mi id="S3.SS1.p3.3.m3.1.2.4.2.3" xref="S3.SS1.p3.3.m3.1.2.4.2.3.cmml">𝐩</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p3.3.m3.1.2.4.1" xref="S3.SS1.p3.3.m3.1.2.4.1.cmml">​</mo><mrow id="S3.SS1.p3.3.m3.1.2.4.3.2" xref="S3.SS1.p3.3.m3.1.2.4.cmml"><mo stretchy="false" id="S3.SS1.p3.3.m3.1.2.4.3.2.1" xref="S3.SS1.p3.3.m3.1.2.4.cmml">(</mo><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">𝐩</mi><mo stretchy="false" id="S3.SS1.p3.3.m3.1.2.4.3.2.2" xref="S3.SS1.p3.3.m3.1.2.4.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.3.m3.1.2.5" xref="S3.SS1.p3.3.m3.1.2.5.cmml">∈</mo><msup id="S3.SS1.p3.3.m3.1.2.6" xref="S3.SS1.p3.3.m3.1.2.6.cmml"><mi id="S3.SS1.p3.3.m3.1.2.6.2" xref="S3.SS1.p3.3.m3.1.2.6.2.cmml">ℝ</mi><mn id="S3.SS1.p3.3.m3.1.2.6.3" xref="S3.SS1.p3.3.m3.1.2.6.3.cmml">512</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.2.cmml" xref="S3.SS1.p3.3.m3.1.2"><and id="S3.SS1.p3.3.m3.1.2a.cmml" xref="S3.SS1.p3.3.m3.1.2"></and><apply id="S3.SS1.p3.3.m3.1.2b.cmml" xref="S3.SS1.p3.3.m3.1.2"><eq id="S3.SS1.p3.3.m3.1.2.3.cmml" xref="S3.SS1.p3.3.m3.1.2.3"></eq><apply id="S3.SS1.p3.3.m3.1.2.2.cmml" xref="S3.SS1.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.2.2.1.cmml" xref="S3.SS1.p3.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.2.2.2.cmml" xref="S3.SS1.p3.3.m3.1.2.2.2">𝑓</ci><ci id="S3.SS1.p3.3.m3.1.2.2.3.cmml" xref="S3.SS1.p3.3.m3.1.2.2.3">𝐩</ci></apply><apply id="S3.SS1.p3.3.m3.1.2.4.cmml" xref="S3.SS1.p3.3.m3.1.2.4"><times id="S3.SS1.p3.3.m3.1.2.4.1.cmml" xref="S3.SS1.p3.3.m3.1.2.4.1"></times><apply id="S3.SS1.p3.3.m3.1.2.4.2.cmml" xref="S3.SS1.p3.3.m3.1.2.4.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.2.4.2.1.cmml" xref="S3.SS1.p3.3.m3.1.2.4.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.2.4.2.2.cmml" xref="S3.SS1.p3.3.m3.1.2.4.2.2">ℱ</ci><ci id="S3.SS1.p3.3.m3.1.2.4.2.3.cmml" xref="S3.SS1.p3.3.m3.1.2.4.2.3">𝐩</ci></apply><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝐩</ci></apply></apply><apply id="S3.SS1.p3.3.m3.1.2c.cmml" xref="S3.SS1.p3.3.m3.1.2"><in id="S3.SS1.p3.3.m3.1.2.5.cmml" xref="S3.SS1.p3.3.m3.1.2.5"></in><share href="#S3.SS1.p3.3.m3.1.2.4.cmml" id="S3.SS1.p3.3.m3.1.2d.cmml" xref="S3.SS1.p3.3.m3.1.2"></share><apply id="S3.SS1.p3.3.m3.1.2.6.cmml" xref="S3.SS1.p3.3.m3.1.2.6"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.2.6.1.cmml" xref="S3.SS1.p3.3.m3.1.2.6">superscript</csymbol><ci id="S3.SS1.p3.3.m3.1.2.6.2.cmml" xref="S3.SS1.p3.3.m3.1.2.6.2">ℝ</ci><cn type="integer" id="S3.SS1.p3.3.m3.1.2.6.3.cmml" xref="S3.SS1.p3.3.m3.1.2.6.3">512</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">f_{\mathbf{p}}=\mathcal{F}_{\mathbf{p}}(\mathbf{p})\in\mathbb{R}^{512}</annotation></semantics></math>. Category-level SBIR requires (<math id="S3.SS1.p3.4.m4.2" class="ltx_Math" alttext="\mathbf{s},\mathbf{p}" display="inline"><semantics id="S3.SS1.p3.4.m4.2a"><mrow id="S3.SS1.p3.4.m4.2.3.2" xref="S3.SS1.p3.4.m4.2.3.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">𝐬</mi><mo id="S3.SS1.p3.4.m4.2.3.2.1" xref="S3.SS1.p3.4.m4.2.3.1.cmml">,</mo><mi id="S3.SS1.p3.4.m4.2.2" xref="S3.SS1.p3.4.m4.2.2.cmml">𝐩</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.2b"><list id="S3.SS1.p3.4.m4.2.3.1.cmml" xref="S3.SS1.p3.4.m4.2.3.2"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝐬</ci><ci id="S3.SS1.p3.4.m4.2.2.cmml" xref="S3.SS1.p3.4.m4.2.2">𝐩</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.2c">\mathbf{s},\mathbf{p}</annotation></semantics></math>) from the same category, whereas fine-grained SBIR requires instance-level sketch/photo matching. For training, the cosine distance <math id="S3.SS1.p3.5.m5.2" class="ltx_Math" alttext="\delta(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.p3.5.m5.2a"><mrow id="S3.SS1.p3.5.m5.2.3" xref="S3.SS1.p3.5.m5.2.3.cmml"><mi id="S3.SS1.p3.5.m5.2.3.2" xref="S3.SS1.p3.5.m5.2.3.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.5.m5.2.3.1" xref="S3.SS1.p3.5.m5.2.3.1.cmml">​</mo><mrow id="S3.SS1.p3.5.m5.2.3.3.2" xref="S3.SS1.p3.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p3.5.m5.2.3.3.2.1" xref="S3.SS1.p3.5.m5.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.p3.5.m5.2.3.3.2.2" xref="S3.SS1.p3.5.m5.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p3.5.m5.2.2" xref="S3.SS1.p3.5.m5.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p3.5.m5.2.3.3.2.3" xref="S3.SS1.p3.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.2b"><apply id="S3.SS1.p3.5.m5.2.3.cmml" xref="S3.SS1.p3.5.m5.2.3"><times id="S3.SS1.p3.5.m5.2.3.1.cmml" xref="S3.SS1.p3.5.m5.2.3.1"></times><ci id="S3.SS1.p3.5.m5.2.3.2.cmml" xref="S3.SS1.p3.5.m5.2.3.2">𝛿</ci><interval closure="open" id="S3.SS1.p3.5.m5.2.3.3.1.cmml" xref="S3.SS1.p3.5.m5.2.3.3.2"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">⋅</ci><ci id="S3.SS1.p3.5.m5.2.2.cmml" xref="S3.SS1.p3.5.m5.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.2c">\delta(\cdot,\cdot)</annotation></semantics></math> to a sketch anchor (<math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="\mathbf{s}" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mi id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">\mathbf{s}</annotation></semantics></math>) from a negative photo (<math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="\mathbf{p}^{-}" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><msup id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mi id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2.cmml">𝐩</mi><mo id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2">𝐩</ci><minus id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">\mathbf{p}^{-}</annotation></semantics></math>), denoted as <math id="S3.SS1.p3.8.m8.2" class="ltx_Math" alttext="\beta^{-}=\delta(f_{\mathbf{s}},f_{\mathbf{p}^{-}})" display="inline"><semantics id="S3.SS1.p3.8.m8.2a"><mrow id="S3.SS1.p3.8.m8.2.2" xref="S3.SS1.p3.8.m8.2.2.cmml"><msup id="S3.SS1.p3.8.m8.2.2.4" xref="S3.SS1.p3.8.m8.2.2.4.cmml"><mi id="S3.SS1.p3.8.m8.2.2.4.2" xref="S3.SS1.p3.8.m8.2.2.4.2.cmml">β</mi><mo id="S3.SS1.p3.8.m8.2.2.4.3" xref="S3.SS1.p3.8.m8.2.2.4.3.cmml">−</mo></msup><mo id="S3.SS1.p3.8.m8.2.2.3" xref="S3.SS1.p3.8.m8.2.2.3.cmml">=</mo><mrow id="S3.SS1.p3.8.m8.2.2.2" xref="S3.SS1.p3.8.m8.2.2.2.cmml"><mi id="S3.SS1.p3.8.m8.2.2.2.4" xref="S3.SS1.p3.8.m8.2.2.2.4.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.8.m8.2.2.2.3" xref="S3.SS1.p3.8.m8.2.2.2.3.cmml">​</mo><mrow id="S3.SS1.p3.8.m8.2.2.2.2.2" xref="S3.SS1.p3.8.m8.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p3.8.m8.2.2.2.2.2.3" xref="S3.SS1.p3.8.m8.2.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p3.8.m8.1.1.1.1.1.1" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.8.m8.1.1.1.1.1.1.2" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.SS1.p3.8.m8.1.1.1.1.1.1.3" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.cmml">𝐬</mi></msub><mo id="S3.SS1.p3.8.m8.2.2.2.2.2.4" xref="S3.SS1.p3.8.m8.2.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.8.m8.2.2.2.2.2.2" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p3.8.m8.2.2.2.2.2.2.2" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2.2.cmml">f</mi><msup id="S3.SS1.p3.8.m8.2.2.2.2.2.2.3" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.2" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.2.cmml">𝐩</mi><mo id="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.3" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.3.cmml">−</mo></msup></msub><mo stretchy="false" id="S3.SS1.p3.8.m8.2.2.2.2.2.5" xref="S3.SS1.p3.8.m8.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.2b"><apply id="S3.SS1.p3.8.m8.2.2.cmml" xref="S3.SS1.p3.8.m8.2.2"><eq id="S3.SS1.p3.8.m8.2.2.3.cmml" xref="S3.SS1.p3.8.m8.2.2.3"></eq><apply id="S3.SS1.p3.8.m8.2.2.4.cmml" xref="S3.SS1.p3.8.m8.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.2.2.4.1.cmml" xref="S3.SS1.p3.8.m8.2.2.4">superscript</csymbol><ci id="S3.SS1.p3.8.m8.2.2.4.2.cmml" xref="S3.SS1.p3.8.m8.2.2.4.2">𝛽</ci><minus id="S3.SS1.p3.8.m8.2.2.4.3.cmml" xref="S3.SS1.p3.8.m8.2.2.4.3"></minus></apply><apply id="S3.SS1.p3.8.m8.2.2.2.cmml" xref="S3.SS1.p3.8.m8.2.2.2"><times id="S3.SS1.p3.8.m8.2.2.2.3.cmml" xref="S3.SS1.p3.8.m8.2.2.2.3"></times><ci id="S3.SS1.p3.8.m8.2.2.2.4.cmml" xref="S3.SS1.p3.8.m8.2.2.2.4">𝛿</ci><interval closure="open" id="S3.SS1.p3.8.m8.2.2.2.2.3.cmml" xref="S3.SS1.p3.8.m8.2.2.2.2.2"><apply id="S3.SS1.p3.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.3">𝐬</ci></apply><apply id="S3.SS1.p3.8.m8.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.8.m8.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2.2">𝑓</ci><apply id="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.1.cmml" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2.3">superscript</csymbol><ci id="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.2.cmml" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.2">𝐩</ci><minus id="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.3.cmml" xref="S3.SS1.p3.8.m8.2.2.2.2.2.2.3.3"></minus></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.2c">\beta^{-}=\delta(f_{\mathbf{s}},f_{\mathbf{p}^{-}})</annotation></semantics></math> should increase while that from the positive photo (<math id="S3.SS1.p3.9.m9.1" class="ltx_Math" alttext="\mathbf{p}^{+}" display="inline"><semantics id="S3.SS1.p3.9.m9.1a"><msup id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml"><mi id="S3.SS1.p3.9.m9.1.1.2" xref="S3.SS1.p3.9.m9.1.1.2.cmml">𝐩</mi><mo id="S3.SS1.p3.9.m9.1.1.3" xref="S3.SS1.p3.9.m9.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><apply id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m9.1.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">superscript</csymbol><ci id="S3.SS1.p3.9.m9.1.1.2.cmml" xref="S3.SS1.p3.9.m9.1.1.2">𝐩</ci><plus id="S3.SS1.p3.9.m9.1.1.3.cmml" xref="S3.SS1.p3.9.m9.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">\mathbf{p}^{+}</annotation></semantics></math>), <math id="S3.SS1.p3.10.m10.2" class="ltx_Math" alttext="\beta^{+}=\delta(f_{\mathbf{s}},f_{\mathbf{p}^{+}})" display="inline"><semantics id="S3.SS1.p3.10.m10.2a"><mrow id="S3.SS1.p3.10.m10.2.2" xref="S3.SS1.p3.10.m10.2.2.cmml"><msup id="S3.SS1.p3.10.m10.2.2.4" xref="S3.SS1.p3.10.m10.2.2.4.cmml"><mi id="S3.SS1.p3.10.m10.2.2.4.2" xref="S3.SS1.p3.10.m10.2.2.4.2.cmml">β</mi><mo id="S3.SS1.p3.10.m10.2.2.4.3" xref="S3.SS1.p3.10.m10.2.2.4.3.cmml">+</mo></msup><mo id="S3.SS1.p3.10.m10.2.2.3" xref="S3.SS1.p3.10.m10.2.2.3.cmml">=</mo><mrow id="S3.SS1.p3.10.m10.2.2.2" xref="S3.SS1.p3.10.m10.2.2.2.cmml"><mi id="S3.SS1.p3.10.m10.2.2.2.4" xref="S3.SS1.p3.10.m10.2.2.2.4.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.10.m10.2.2.2.3" xref="S3.SS1.p3.10.m10.2.2.2.3.cmml">​</mo><mrow id="S3.SS1.p3.10.m10.2.2.2.2.2" xref="S3.SS1.p3.10.m10.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p3.10.m10.2.2.2.2.2.3" xref="S3.SS1.p3.10.m10.2.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p3.10.m10.1.1.1.1.1.1" xref="S3.SS1.p3.10.m10.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.10.m10.1.1.1.1.1.1.2" xref="S3.SS1.p3.10.m10.1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.SS1.p3.10.m10.1.1.1.1.1.1.3" xref="S3.SS1.p3.10.m10.1.1.1.1.1.1.3.cmml">𝐬</mi></msub><mo id="S3.SS1.p3.10.m10.2.2.2.2.2.4" xref="S3.SS1.p3.10.m10.2.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.10.m10.2.2.2.2.2.2" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p3.10.m10.2.2.2.2.2.2.2" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2.2.cmml">f</mi><msup id="S3.SS1.p3.10.m10.2.2.2.2.2.2.3" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.2" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.2.cmml">𝐩</mi><mo id="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.3" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.3.cmml">+</mo></msup></msub><mo stretchy="false" id="S3.SS1.p3.10.m10.2.2.2.2.2.5" xref="S3.SS1.p3.10.m10.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.2b"><apply id="S3.SS1.p3.10.m10.2.2.cmml" xref="S3.SS1.p3.10.m10.2.2"><eq id="S3.SS1.p3.10.m10.2.2.3.cmml" xref="S3.SS1.p3.10.m10.2.2.3"></eq><apply id="S3.SS1.p3.10.m10.2.2.4.cmml" xref="S3.SS1.p3.10.m10.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m10.2.2.4.1.cmml" xref="S3.SS1.p3.10.m10.2.2.4">superscript</csymbol><ci id="S3.SS1.p3.10.m10.2.2.4.2.cmml" xref="S3.SS1.p3.10.m10.2.2.4.2">𝛽</ci><plus id="S3.SS1.p3.10.m10.2.2.4.3.cmml" xref="S3.SS1.p3.10.m10.2.2.4.3"></plus></apply><apply id="S3.SS1.p3.10.m10.2.2.2.cmml" xref="S3.SS1.p3.10.m10.2.2.2"><times id="S3.SS1.p3.10.m10.2.2.2.3.cmml" xref="S3.SS1.p3.10.m10.2.2.2.3"></times><ci id="S3.SS1.p3.10.m10.2.2.2.4.cmml" xref="S3.SS1.p3.10.m10.2.2.2.4">𝛿</ci><interval closure="open" id="S3.SS1.p3.10.m10.2.2.2.2.3.cmml" xref="S3.SS1.p3.10.m10.2.2.2.2.2"><apply id="S3.SS1.p3.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.10.m10.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.SS1.p3.10.m10.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.10.m10.1.1.1.1.1.1.3">𝐬</ci></apply><apply id="S3.SS1.p3.10.m10.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m10.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.10.m10.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2.2">𝑓</ci><apply id="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.1.cmml" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2.3">superscript</csymbol><ci id="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.2.cmml" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.2">𝐩</ci><plus id="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.3.cmml" xref="S3.SS1.p3.10.m10.2.2.2.2.2.2.3.3"></plus></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.2c">\beta^{+}=\delta(f_{\mathbf{s}},f_{\mathbf{p}^{+}})</annotation></semantics></math> should decrease. Training is done via triplet loss with hyperparameter <math id="S3.SS1.p3.11.m11.1" class="ltx_Math" alttext="\mu&gt;0" display="inline"><semantics id="S3.SS1.p3.11.m11.1a"><mrow id="S3.SS1.p3.11.m11.1.1" xref="S3.SS1.p3.11.m11.1.1.cmml"><mi id="S3.SS1.p3.11.m11.1.1.2" xref="S3.SS1.p3.11.m11.1.1.2.cmml">μ</mi><mo id="S3.SS1.p3.11.m11.1.1.1" xref="S3.SS1.p3.11.m11.1.1.1.cmml">&gt;</mo><mn id="S3.SS1.p3.11.m11.1.1.3" xref="S3.SS1.p3.11.m11.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.1b"><apply id="S3.SS1.p3.11.m11.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1"><gt id="S3.SS1.p3.11.m11.1.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1.1"></gt><ci id="S3.SS1.p3.11.m11.1.1.2.cmml" xref="S3.SS1.p3.11.m11.1.1.2">𝜇</ci><cn type="integer" id="S3.SS1.p3.11.m11.1.1.3.cmml" xref="S3.SS1.p3.11.m11.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.1c">\mu&gt;0</annotation></semantics></math>,</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{trip}}=\max\{0,\mu+\beta^{+}-\beta^{-}\}" display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><msub id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.3.2" xref="S3.E1.m1.3.3.3.2.cmml">ℒ</mi><mi id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml">trip</mi></msub><mo id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.2.cmml"><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">max</mi><mo id="S3.E1.m1.3.3.1.1a" xref="S3.E1.m1.3.3.1.2.cmml">⁡</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.2.cmml">{</mo><mn id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">0</mn><mo id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.2.cmml">,</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.2.2.cmml">μ</mi><mo id="S3.E1.m1.3.3.1.1.1.1.2.1" xref="S3.E1.m1.3.3.1.1.1.1.2.1.cmml">+</mo><msup id="S3.E1.m1.3.3.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.1.1.2.3.2.cmml">β</mi><mo id="S3.E1.m1.3.3.1.1.1.1.2.3.3" xref="S3.E1.m1.3.3.1.1.1.1.2.3.3.cmml">+</mo></msup></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml">−</mo><msup id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.cmml">β</mi><mo id="S3.E1.m1.3.3.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.cmml">−</mo></msup></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.4" xref="S3.E1.m1.3.3.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><eq id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2"></eq><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.2">ℒ</ci><ci id="S3.E1.m1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3">trip</ci></apply><apply id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.1"><max id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"></max><cn type="integer" id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">0</cn><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><minus id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"></minus><apply id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><plus id="S3.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.1"></plus><ci id="S3.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2">𝜇</ci><apply id="S3.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.3.2">𝛽</ci><plus id="S3.E1.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.3.3"></plus></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2">𝛽</ci><minus id="S3.E1.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3"></minus></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\mathcal{L}_{\mathrm{trip}}=\max\{0,\mu+\beta^{+}-\beta^{-}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">To extend FG-SBIR across multiple categories (cross-category FG-SBIR), we train with <a href="#S3.E1" title="In 3.1 Background ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a> using “hard-triplets” – <math id="S3.SS1.p4.1.m1.3" class="ltx_Math" alttext="(\mathbf{s},\mathbf{p}^{+},\mathbf{p}^{-})" display="inline"><semantics id="S3.SS1.p4.1.m1.3a"><mrow id="S3.SS1.p4.1.m1.3.3.2" xref="S3.SS1.p4.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.p4.1.m1.3.3.2.3" xref="S3.SS1.p4.1.m1.3.3.3.cmml">(</mo><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">𝐬</mi><mo id="S3.SS1.p4.1.m1.3.3.2.4" xref="S3.SS1.p4.1.m1.3.3.3.cmml">,</mo><msup id="S3.SS1.p4.1.m1.2.2.1.1" xref="S3.SS1.p4.1.m1.2.2.1.1.cmml"><mi id="S3.SS1.p4.1.m1.2.2.1.1.2" xref="S3.SS1.p4.1.m1.2.2.1.1.2.cmml">𝐩</mi><mo id="S3.SS1.p4.1.m1.2.2.1.1.3" xref="S3.SS1.p4.1.m1.2.2.1.1.3.cmml">+</mo></msup><mo id="S3.SS1.p4.1.m1.3.3.2.5" xref="S3.SS1.p4.1.m1.3.3.3.cmml">,</mo><msup id="S3.SS1.p4.1.m1.3.3.2.2" xref="S3.SS1.p4.1.m1.3.3.2.2.cmml"><mi id="S3.SS1.p4.1.m1.3.3.2.2.2" xref="S3.SS1.p4.1.m1.3.3.2.2.2.cmml">𝐩</mi><mo id="S3.SS1.p4.1.m1.3.3.2.2.3" xref="S3.SS1.p4.1.m1.3.3.2.2.3.cmml">−</mo></msup><mo stretchy="false" id="S3.SS1.p4.1.m1.3.3.2.6" xref="S3.SS1.p4.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.3b"><vector id="S3.SS1.p4.1.m1.3.3.3.cmml" xref="S3.SS1.p4.1.m1.3.3.2"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝐬</ci><apply id="S3.SS1.p4.1.m1.2.2.1.1.cmml" xref="S3.SS1.p4.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p4.1.m1.2.2.1.1">superscript</csymbol><ci id="S3.SS1.p4.1.m1.2.2.1.1.2.cmml" xref="S3.SS1.p4.1.m1.2.2.1.1.2">𝐩</ci><plus id="S3.SS1.p4.1.m1.2.2.1.1.3.cmml" xref="S3.SS1.p4.1.m1.2.2.1.1.3"></plus></apply><apply id="S3.SS1.p4.1.m1.3.3.2.2.cmml" xref="S3.SS1.p4.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.3.3.2.2.1.cmml" xref="S3.SS1.p4.1.m1.3.3.2.2">superscript</csymbol><ci id="S3.SS1.p4.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p4.1.m1.3.3.2.2.2">𝐩</ci><minus id="S3.SS1.p4.1.m1.3.3.2.2.3.cmml" xref="S3.SS1.p4.1.m1.3.3.2.2.3"></minus></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.3c">(\mathbf{s},\mathbf{p}^{+},\mathbf{p}^{-})</annotation></semantics></math> have same category, and a class discriminator loss across categories using cross-entropy loss,</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{cat}}=-c_{\mathbf{q}}^{i}\log\frac{\exp(\mathcal{F}_{\mathbf{c}}(f_{\mathbf{q}}^{i}))}{\sum_{\forall j}\exp(\mathcal{F}_{\mathbf{c}}(f_{\mathbf{q}}^{j}))}" display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.5" xref="S3.E2.m1.4.5.cmml"><msub id="S3.E2.m1.4.5.2" xref="S3.E2.m1.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.5.2.2" xref="S3.E2.m1.4.5.2.2.cmml">ℒ</mi><mi id="S3.E2.m1.4.5.2.3" xref="S3.E2.m1.4.5.2.3.cmml">cat</mi></msub><mo id="S3.E2.m1.4.5.1" xref="S3.E2.m1.4.5.1.cmml">=</mo><mrow id="S3.E2.m1.4.5.3" xref="S3.E2.m1.4.5.3.cmml"><mo id="S3.E2.m1.4.5.3a" xref="S3.E2.m1.4.5.3.cmml">−</mo><mrow id="S3.E2.m1.4.5.3.2" xref="S3.E2.m1.4.5.3.2.cmml"><msubsup id="S3.E2.m1.4.5.3.2.2" xref="S3.E2.m1.4.5.3.2.2.cmml"><mi id="S3.E2.m1.4.5.3.2.2.2.2" xref="S3.E2.m1.4.5.3.2.2.2.2.cmml">c</mi><mi id="S3.E2.m1.4.5.3.2.2.2.3" xref="S3.E2.m1.4.5.3.2.2.2.3.cmml">𝐪</mi><mi id="S3.E2.m1.4.5.3.2.2.3" xref="S3.E2.m1.4.5.3.2.2.3.cmml">i</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S3.E2.m1.4.5.3.2.1" xref="S3.E2.m1.4.5.3.2.1.cmml">​</mo><mrow id="S3.E2.m1.4.5.3.2.3" xref="S3.E2.m1.4.5.3.2.3.cmml"><mi id="S3.E2.m1.4.5.3.2.3.1" xref="S3.E2.m1.4.5.3.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E2.m1.4.5.3.2.3a" xref="S3.E2.m1.4.5.3.2.3.cmml">⁡</mo><mfrac id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E2.m1.2.2.2.2a" xref="S3.E2.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E2.m1.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml"><msub id="S3.E2.m1.2.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.2.1.1.3.2" xref="S3.E2.m1.2.2.2.2.1.1.3.2.cmml">ℱ</mi><mi id="S3.E2.m1.2.2.2.2.1.1.3.3" xref="S3.E2.m1.2.2.2.2.1.1.3.3.cmml">𝐜</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E2.m1.2.2.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.2" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.3.cmml">𝐪</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml"><msub id="S3.E2.m1.4.4.4.3" xref="S3.E2.m1.4.4.4.3.cmml"><mo id="S3.E2.m1.4.4.4.3.2" xref="S3.E2.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.4.3.3" xref="S3.E2.m1.4.4.4.3.3.cmml"><mo rspace="0.167em" id="S3.E2.m1.4.4.4.3.3.1" xref="S3.E2.m1.4.4.4.3.3.1.cmml">∀</mo><mi id="S3.E2.m1.4.4.4.3.3.2" xref="S3.E2.m1.4.4.4.3.3.2.cmml">j</mi></mrow></msub><mrow id="S3.E2.m1.4.4.4.2.1" xref="S3.E2.m1.4.4.4.2.2.cmml"><mi id="S3.E2.m1.3.3.3.1" xref="S3.E2.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E2.m1.4.4.4.2.1a" xref="S3.E2.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S3.E2.m1.4.4.4.2.1.1" xref="S3.E2.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.4.2.1.1.2" xref="S3.E2.m1.4.4.4.2.2.cmml">(</mo><mrow id="S3.E2.m1.4.4.4.2.1.1.1" xref="S3.E2.m1.4.4.4.2.1.1.1.cmml"><msub id="S3.E2.m1.4.4.4.2.1.1.1.3" xref="S3.E2.m1.4.4.4.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.4.2.1.1.1.3.2" xref="S3.E2.m1.4.4.4.2.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E2.m1.4.4.4.2.1.1.1.3.3" xref="S3.E2.m1.4.4.4.2.1.1.1.3.3.cmml">𝐜</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.4.2.1.1.1.2" xref="S3.E2.m1.4.4.4.2.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.4.2.1.1.1.1.1" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.4.2.1.1.1.1.1.2" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.2.2" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.2.3" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.2.3.cmml">𝐪</mi><mi id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo stretchy="false" id="S3.E2.m1.4.4.4.2.1.1.1.1.1.3" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.4.4.4.2.1.1.3" xref="S3.E2.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.5.cmml" xref="S3.E2.m1.4.5"><eq id="S3.E2.m1.4.5.1.cmml" xref="S3.E2.m1.4.5.1"></eq><apply id="S3.E2.m1.4.5.2.cmml" xref="S3.E2.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.5.2.1.cmml" xref="S3.E2.m1.4.5.2">subscript</csymbol><ci id="S3.E2.m1.4.5.2.2.cmml" xref="S3.E2.m1.4.5.2.2">ℒ</ci><ci id="S3.E2.m1.4.5.2.3.cmml" xref="S3.E2.m1.4.5.2.3">cat</ci></apply><apply id="S3.E2.m1.4.5.3.cmml" xref="S3.E2.m1.4.5.3"><minus id="S3.E2.m1.4.5.3.1.cmml" xref="S3.E2.m1.4.5.3"></minus><apply id="S3.E2.m1.4.5.3.2.cmml" xref="S3.E2.m1.4.5.3.2"><times id="S3.E2.m1.4.5.3.2.1.cmml" xref="S3.E2.m1.4.5.3.2.1"></times><apply id="S3.E2.m1.4.5.3.2.2.cmml" xref="S3.E2.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.5.3.2.2.1.cmml" xref="S3.E2.m1.4.5.3.2.2">superscript</csymbol><apply id="S3.E2.m1.4.5.3.2.2.2.cmml" xref="S3.E2.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.5.3.2.2.2.1.cmml" xref="S3.E2.m1.4.5.3.2.2">subscript</csymbol><ci id="S3.E2.m1.4.5.3.2.2.2.2.cmml" xref="S3.E2.m1.4.5.3.2.2.2.2">𝑐</ci><ci id="S3.E2.m1.4.5.3.2.2.2.3.cmml" xref="S3.E2.m1.4.5.3.2.2.2.3">𝐪</ci></apply><ci id="S3.E2.m1.4.5.3.2.2.3.cmml" xref="S3.E2.m1.4.5.3.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.4.5.3.2.3.cmml" xref="S3.E2.m1.4.5.3.2.3"><log id="S3.E2.m1.4.5.3.2.3.1.cmml" xref="S3.E2.m1.4.5.3.2.3.1"></log><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><divide id="S3.E2.m1.4.4.5.cmml" xref="S3.E2.m1.4.4"></divide><apply id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2"><exp id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"></exp><apply id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1"><times id="S3.E2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2"></times><apply id="S3.E2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3.2">ℱ</ci><ci id="S3.E2.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3.3">𝐜</ci></apply><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.3">𝐪</ci></apply><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"><apply id="S3.E2.m1.4.4.4.3.cmml" xref="S3.E2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.3.1.cmml" xref="S3.E2.m1.4.4.4.3">subscript</csymbol><sum id="S3.E2.m1.4.4.4.3.2.cmml" xref="S3.E2.m1.4.4.4.3.2"></sum><apply id="S3.E2.m1.4.4.4.3.3.cmml" xref="S3.E2.m1.4.4.4.3.3"><csymbol cd="latexml" id="S3.E2.m1.4.4.4.3.3.1.cmml" xref="S3.E2.m1.4.4.4.3.3.1">for-all</csymbol><ci id="S3.E2.m1.4.4.4.3.3.2.cmml" xref="S3.E2.m1.4.4.4.3.3.2">𝑗</ci></apply></apply><apply id="S3.E2.m1.4.4.4.2.2.cmml" xref="S3.E2.m1.4.4.4.2.1"><exp id="S3.E2.m1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3.1"></exp><apply id="S3.E2.m1.4.4.4.2.1.1.1.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1"><times id="S3.E2.m1.4.4.4.2.1.1.1.2.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.2"></times><apply id="S3.E2.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.2.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.4.2.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.3.2">ℱ</ci><ci id="S3.E2.m1.4.4.4.2.1.1.1.3.3.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.3.3">𝐜</ci></apply><apply id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.2.3">𝐪</ci></apply><ci id="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\mathcal{L}_{\mathrm{cat}}=-c_{\mathbf{q}}^{i}\log\frac{\exp(\mathcal{F}_{\mathbf{c}}(f_{\mathbf{q}}^{i}))}{\sum_{\forall j}\exp(\mathcal{F}_{\mathbf{c}}(f_{\mathbf{q}}^{j}))}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.p5.4" class="ltx_p">where, query <math id="S3.SS1.p5.1.m1.2" class="ltx_Math" alttext="\mathbf{q}=\{\mathbf{s},\mathbf{p}\}" display="inline"><semantics id="S3.SS1.p5.1.m1.2a"><mrow id="S3.SS1.p5.1.m1.2.3" xref="S3.SS1.p5.1.m1.2.3.cmml"><mi id="S3.SS1.p5.1.m1.2.3.2" xref="S3.SS1.p5.1.m1.2.3.2.cmml">𝐪</mi><mo id="S3.SS1.p5.1.m1.2.3.1" xref="S3.SS1.p5.1.m1.2.3.1.cmml">=</mo><mrow id="S3.SS1.p5.1.m1.2.3.3.2" xref="S3.SS1.p5.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p5.1.m1.2.3.3.2.1" xref="S3.SS1.p5.1.m1.2.3.3.1.cmml">{</mo><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">𝐬</mi><mo id="S3.SS1.p5.1.m1.2.3.3.2.2" xref="S3.SS1.p5.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p5.1.m1.2.2" xref="S3.SS1.p5.1.m1.2.2.cmml">𝐩</mi><mo stretchy="false" id="S3.SS1.p5.1.m1.2.3.3.2.3" xref="S3.SS1.p5.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.2b"><apply id="S3.SS1.p5.1.m1.2.3.cmml" xref="S3.SS1.p5.1.m1.2.3"><eq id="S3.SS1.p5.1.m1.2.3.1.cmml" xref="S3.SS1.p5.1.m1.2.3.1"></eq><ci id="S3.SS1.p5.1.m1.2.3.2.cmml" xref="S3.SS1.p5.1.m1.2.3.2">𝐪</ci><set id="S3.SS1.p5.1.m1.2.3.3.1.cmml" xref="S3.SS1.p5.1.m1.2.3.3.2"><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝐬</ci><ci id="S3.SS1.p5.1.m1.2.2.cmml" xref="S3.SS1.p5.1.m1.2.2">𝐩</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.2c">\mathbf{q}=\{\mathbf{s},\mathbf{p}\}</annotation></semantics></math>, <math id="S3.SS1.p5.2.m2.1" class="ltx_Math" alttext="c_{\mathbf{q}}^{i}" display="inline"><semantics id="S3.SS1.p5.2.m2.1a"><msubsup id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml"><mi id="S3.SS1.p5.2.m2.1.1.2.2" xref="S3.SS1.p5.2.m2.1.1.2.2.cmml">c</mi><mi id="S3.SS1.p5.2.m2.1.1.2.3" xref="S3.SS1.p5.2.m2.1.1.2.3.cmml">𝐪</mi><mi id="S3.SS1.p5.2.m2.1.1.3" xref="S3.SS1.p5.2.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><apply id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">superscript</csymbol><apply id="S3.SS1.p5.2.m2.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.2.1.cmml" xref="S3.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p5.2.m2.1.1.2.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2.2">𝑐</ci><ci id="S3.SS1.p5.2.m2.1.1.2.3.cmml" xref="S3.SS1.p5.2.m2.1.1.2.3">𝐪</ci></apply><ci id="S3.SS1.p5.2.m2.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">c_{\mathbf{q}}^{i}</annotation></semantics></math> represent class label of <math id="S3.SS1.p5.3.m3.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS1.p5.3.m3.1a"><msup id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml"><mi id="S3.SS1.p5.3.m3.1.1.2" xref="S3.SS1.p5.3.m3.1.1.2.cmml">i</mi><mrow id="S3.SS1.p5.3.m3.1.1.3" xref="S3.SS1.p5.3.m3.1.1.3.cmml"><mi id="S3.SS1.p5.3.m3.1.1.3.2" xref="S3.SS1.p5.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.3.m3.1.1.3.1" xref="S3.SS1.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p5.3.m3.1.1.3.3" xref="S3.SS1.p5.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><apply id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p5.3.m3.1.1.2.cmml" xref="S3.SS1.p5.3.m3.1.1.2">𝑖</ci><apply id="S3.SS1.p5.3.m3.1.1.3.cmml" xref="S3.SS1.p5.3.m3.1.1.3"><times id="S3.SS1.p5.3.m3.1.1.3.1.cmml" xref="S3.SS1.p5.3.m3.1.1.3.1"></times><ci id="S3.SS1.p5.3.m3.1.1.3.2.cmml" xref="S3.SS1.p5.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS1.p5.3.m3.1.1.3.3.cmml" xref="S3.SS1.p5.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">i^{th}</annotation></semantics></math> sample, <math id="S3.SS1.p5.4.m4.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{c}}:\mathbb{R}^{512}\rightarrow\mathbb{R}^{|\mathcal{C}|}" display="inline"><semantics id="S3.SS1.p5.4.m4.1a"><mrow id="S3.SS1.p5.4.m4.1.2" xref="S3.SS1.p5.4.m4.1.2.cmml"><msub id="S3.SS1.p5.4.m4.1.2.2" xref="S3.SS1.p5.4.m4.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.4.m4.1.2.2.2" xref="S3.SS1.p5.4.m4.1.2.2.2.cmml">ℱ</mi><mi id="S3.SS1.p5.4.m4.1.2.2.3" xref="S3.SS1.p5.4.m4.1.2.2.3.cmml">𝐜</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p5.4.m4.1.2.1" xref="S3.SS1.p5.4.m4.1.2.1.cmml">:</mo><mrow id="S3.SS1.p5.4.m4.1.2.3" xref="S3.SS1.p5.4.m4.1.2.3.cmml"><msup id="S3.SS1.p5.4.m4.1.2.3.2" xref="S3.SS1.p5.4.m4.1.2.3.2.cmml"><mi id="S3.SS1.p5.4.m4.1.2.3.2.2" xref="S3.SS1.p5.4.m4.1.2.3.2.2.cmml">ℝ</mi><mn id="S3.SS1.p5.4.m4.1.2.3.2.3" xref="S3.SS1.p5.4.m4.1.2.3.2.3.cmml">512</mn></msup><mo stretchy="false" id="S3.SS1.p5.4.m4.1.2.3.1" xref="S3.SS1.p5.4.m4.1.2.3.1.cmml">→</mo><msup id="S3.SS1.p5.4.m4.1.2.3.3" xref="S3.SS1.p5.4.m4.1.2.3.3.cmml"><mi id="S3.SS1.p5.4.m4.1.2.3.3.2" xref="S3.SS1.p5.4.m4.1.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p5.4.m4.1.1.1.3" xref="S3.SS1.p5.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.4.m4.1.1.1.3.1" xref="S3.SS1.p5.4.m4.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.4.m4.1.1.1.1" xref="S3.SS1.p5.4.m4.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS1.p5.4.m4.1.1.1.3.2" xref="S3.SS1.p5.4.m4.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><apply id="S3.SS1.p5.4.m4.1.2.cmml" xref="S3.SS1.p5.4.m4.1.2"><ci id="S3.SS1.p5.4.m4.1.2.1.cmml" xref="S3.SS1.p5.4.m4.1.2.1">:</ci><apply id="S3.SS1.p5.4.m4.1.2.2.cmml" xref="S3.SS1.p5.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m4.1.2.2.1.cmml" xref="S3.SS1.p5.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS1.p5.4.m4.1.2.2.2.cmml" xref="S3.SS1.p5.4.m4.1.2.2.2">ℱ</ci><ci id="S3.SS1.p5.4.m4.1.2.2.3.cmml" xref="S3.SS1.p5.4.m4.1.2.2.3">𝐜</ci></apply><apply id="S3.SS1.p5.4.m4.1.2.3.cmml" xref="S3.SS1.p5.4.m4.1.2.3"><ci id="S3.SS1.p5.4.m4.1.2.3.1.cmml" xref="S3.SS1.p5.4.m4.1.2.3.1">→</ci><apply id="S3.SS1.p5.4.m4.1.2.3.2.cmml" xref="S3.SS1.p5.4.m4.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m4.1.2.3.2.1.cmml" xref="S3.SS1.p5.4.m4.1.2.3.2">superscript</csymbol><ci id="S3.SS1.p5.4.m4.1.2.3.2.2.cmml" xref="S3.SS1.p5.4.m4.1.2.3.2.2">ℝ</ci><cn type="integer" id="S3.SS1.p5.4.m4.1.2.3.2.3.cmml" xref="S3.SS1.p5.4.m4.1.2.3.2.3">512</cn></apply><apply id="S3.SS1.p5.4.m4.1.2.3.3.cmml" xref="S3.SS1.p5.4.m4.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m4.1.2.3.3.1.cmml" xref="S3.SS1.p5.4.m4.1.2.3.3">superscript</csymbol><ci id="S3.SS1.p5.4.m4.1.2.3.3.2.cmml" xref="S3.SS1.p5.4.m4.1.2.3.3.2">ℝ</ci><apply id="S3.SS1.p5.4.m4.1.1.1.2.cmml" xref="S3.SS1.p5.4.m4.1.1.1.3"><abs id="S3.SS1.p5.4.m4.1.1.1.2.1.cmml" xref="S3.SS1.p5.4.m4.1.1.1.3.1"></abs><ci id="S3.SS1.p5.4.m4.1.1.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1.1.1">𝒞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">\mathcal{F}_{\mathbf{c}}:\mathbb{R}^{512}\rightarrow\mathbb{R}^{|\mathcal{C}|}</annotation></semantics></math> predicts softmax probabilities.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Weakly Supervised Object Detection</h3>

<figure id="S3.F3" class="ltx_figure"><img src="/html/2303.15149/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="177" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.12.6.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.10.5" class="ltx_text" style="font-size:90%;">Weakly supervised setup (no bounding box) trains using image-level class labels with classification heads (<math id="S3.F3.6.1.m1.1" class="ltx_Math" alttext="\phi_{\mathrm{cls}}" display="inline"><semantics id="S3.F3.6.1.m1.1b"><msub id="S3.F3.6.1.m1.1.1" xref="S3.F3.6.1.m1.1.1.cmml"><mi id="S3.F3.6.1.m1.1.1.2" xref="S3.F3.6.1.m1.1.1.2.cmml">ϕ</mi><mi id="S3.F3.6.1.m1.1.1.3" xref="S3.F3.6.1.m1.1.1.3.cmml">cls</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.6.1.m1.1c"><apply id="S3.F3.6.1.m1.1.1.cmml" xref="S3.F3.6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.6.1.m1.1.1.1.cmml" xref="S3.F3.6.1.m1.1.1">subscript</csymbol><ci id="S3.F3.6.1.m1.1.1.2.cmml" xref="S3.F3.6.1.m1.1.1.2">italic-ϕ</ci><ci id="S3.F3.6.1.m1.1.1.3.cmml" xref="S3.F3.6.1.m1.1.1.3">cls</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.6.1.m1.1d">\phi_{\mathrm{cls}}</annotation></semantics></math>). Initial prediction <math id="S3.F3.7.2.m2.1" class="ltx_Math" alttext="\omega_{0}" display="inline"><semantics id="S3.F3.7.2.m2.1b"><msub id="S3.F3.7.2.m2.1.1" xref="S3.F3.7.2.m2.1.1.cmml"><mi id="S3.F3.7.2.m2.1.1.2" xref="S3.F3.7.2.m2.1.1.2.cmml">ω</mi><mn id="S3.F3.7.2.m2.1.1.3" xref="S3.F3.7.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F3.7.2.m2.1c"><apply id="S3.F3.7.2.m2.1.1.cmml" xref="S3.F3.7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.F3.7.2.m2.1.1.1.cmml" xref="S3.F3.7.2.m2.1.1">subscript</csymbol><ci id="S3.F3.7.2.m2.1.1.2.cmml" xref="S3.F3.7.2.m2.1.1.2">𝜔</ci><cn type="integer" id="S3.F3.7.2.m2.1.1.3.cmml" xref="S3.F3.7.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.7.2.m2.1d">\omega_{0}</annotation></semantics></math> is refined in <math id="S3.F3.8.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.F3.8.3.m3.1b"><mi id="S3.F3.8.3.m3.1.1" xref="S3.F3.8.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F3.8.3.m3.1c"><ci id="S3.F3.8.3.m3.1.1.cmml" xref="S3.F3.8.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.8.3.m3.1d">K</annotation></semantics></math> steps with <math id="S3.F3.9.4.m4.1" class="ltx_Math" alttext="\phi_{\mathrm{cls}}^{*}" display="inline"><semantics id="S3.F3.9.4.m4.1b"><msubsup id="S3.F3.9.4.m4.1.1" xref="S3.F3.9.4.m4.1.1.cmml"><mi id="S3.F3.9.4.m4.1.1.2.2" xref="S3.F3.9.4.m4.1.1.2.2.cmml">ϕ</mi><mi id="S3.F3.9.4.m4.1.1.2.3" xref="S3.F3.9.4.m4.1.1.2.3.cmml">cls</mi><mo id="S3.F3.9.4.m4.1.1.3" xref="S3.F3.9.4.m4.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.F3.9.4.m4.1c"><apply id="S3.F3.9.4.m4.1.1.cmml" xref="S3.F3.9.4.m4.1.1"><csymbol cd="ambiguous" id="S3.F3.9.4.m4.1.1.1.cmml" xref="S3.F3.9.4.m4.1.1">superscript</csymbol><apply id="S3.F3.9.4.m4.1.1.2.cmml" xref="S3.F3.9.4.m4.1.1"><csymbol cd="ambiguous" id="S3.F3.9.4.m4.1.1.2.1.cmml" xref="S3.F3.9.4.m4.1.1">subscript</csymbol><ci id="S3.F3.9.4.m4.1.1.2.2.cmml" xref="S3.F3.9.4.m4.1.1.2.2">italic-ϕ</ci><ci id="S3.F3.9.4.m4.1.1.2.3.cmml" xref="S3.F3.9.4.m4.1.1.2.3">cls</ci></apply><times id="S3.F3.9.4.m4.1.1.3.cmml" xref="S3.F3.9.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.9.4.m4.1d">\phi_{\mathrm{cls}}^{*}</annotation></semantics></math> to predict <math id="S3.F3.10.5.m5.1" class="ltx_Math" alttext="\omega_{k}" display="inline"><semantics id="S3.F3.10.5.m5.1b"><msub id="S3.F3.10.5.m5.1.1" xref="S3.F3.10.5.m5.1.1.cmml"><mi id="S3.F3.10.5.m5.1.1.2" xref="S3.F3.10.5.m5.1.1.2.cmml">ω</mi><mi id="S3.F3.10.5.m5.1.1.3" xref="S3.F3.10.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.10.5.m5.1c"><apply id="S3.F3.10.5.m5.1.1.cmml" xref="S3.F3.10.5.m5.1.1"><csymbol cd="ambiguous" id="S3.F3.10.5.m5.1.1.1.cmml" xref="S3.F3.10.5.m5.1.1">subscript</csymbol><ci id="S3.F3.10.5.m5.1.1.2.cmml" xref="S3.F3.10.5.m5.1.1.2">𝜔</ci><ci id="S3.F3.10.5.m5.1.1.3.cmml" xref="S3.F3.10.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.10.5.m5.1d">\omega_{k}</annotation></semantics></math>.</span></figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.8" class="ltx_p">To avoid collecting expensive bounding box annotation, weakly supervised object detection (WSOD) trains using image-level class labels – objects of a class are present or not. To avoid using bounding box annotation, we either use a pre-trained region proposal network<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Pre-trained <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> RPN is highly generalisable to unseen datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> due to its generic objective that learns to predict “objectness” measure.</span></span></span> (<math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{R}</annotation></semantics></math>) or heuristic-based selective search <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib89" title="" class="ltx_ref">89</a>]</cite>, or edge boxes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib113" title="" class="ltx_ref">113</a>]</cite> that generate box proposals <math id="S3.SS2.p1.2.m2.3" class="ltx_Math" alttext="\mathbf{r}=\{r_{1},\dots,r_{R}\}" display="inline"><semantics id="S3.SS2.p1.2.m2.3a"><mrow id="S3.SS2.p1.2.m2.3.3" xref="S3.SS2.p1.2.m2.3.3.cmml"><mi id="S3.SS2.p1.2.m2.3.3.4" xref="S3.SS2.p1.2.m2.3.3.4.cmml">𝐫</mi><mo id="S3.SS2.p1.2.m2.3.3.3" xref="S3.SS2.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S3.SS2.p1.2.m2.3.3.2.2" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.3.3.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">{</mo><msub id="S3.SS2.p1.2.m2.2.2.1.1.1" xref="S3.SS2.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.2.2.1.1.1.2" xref="S3.SS2.p1.2.m2.2.2.1.1.1.2.cmml">r</mi><mn id="S3.SS2.p1.2.m2.2.2.1.1.1.3" xref="S3.SS2.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.2.m2.3.3.2.2.4" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.p1.2.m2.3.3.2.2.5" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p1.2.m2.3.3.2.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.2.m2.3.3.2.2.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2.cmml">r</mi><mi id="S3.SS2.p1.2.m2.3.3.2.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.2.2.3.cmml">R</mi></msub><mo stretchy="false" id="S3.SS2.p1.2.m2.3.3.2.2.6" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.3b"><apply id="S3.SS2.p1.2.m2.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3"><eq id="S3.SS2.p1.2.m2.3.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3.3"></eq><ci id="S3.SS2.p1.2.m2.3.3.4.cmml" xref="S3.SS2.p1.2.m2.3.3.4">𝐫</ci><set id="S3.SS2.p1.2.m2.3.3.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2"><apply id="S3.SS2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1.2">𝑟</ci><cn type="integer" id="S3.SS2.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">…</ci><apply id="S3.SS2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2">𝑟</ci><ci id="S3.SS2.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2.3">𝑅</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.3c">\mathbf{r}=\{r_{1},\dots,r_{R}\}</annotation></semantics></math>. The patch features <math id="S3.SS2.p1.3.m3.2" class="ltx_Math" alttext="f_{\mathbf{r}}=\mathcal{P}(f_{\mathbf{p}},\mathbf{r})" display="inline"><semantics id="S3.SS2.p1.3.m3.2a"><mrow id="S3.SS2.p1.3.m3.2.2" xref="S3.SS2.p1.3.m3.2.2.cmml"><msub id="S3.SS2.p1.3.m3.2.2.3" xref="S3.SS2.p1.3.m3.2.2.3.cmml"><mi id="S3.SS2.p1.3.m3.2.2.3.2" xref="S3.SS2.p1.3.m3.2.2.3.2.cmml">f</mi><mi id="S3.SS2.p1.3.m3.2.2.3.3" xref="S3.SS2.p1.3.m3.2.2.3.3.cmml">𝐫</mi></msub><mo id="S3.SS2.p1.3.m3.2.2.2" xref="S3.SS2.p1.3.m3.2.2.2.cmml">=</mo><mrow id="S3.SS2.p1.3.m3.2.2.1" xref="S3.SS2.p1.3.m3.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.2.2.1.3" xref="S3.SS2.p1.3.m3.2.2.1.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.2.2.1.2" xref="S3.SS2.p1.3.m3.2.2.1.2.cmml">​</mo><mrow id="S3.SS2.p1.3.m3.2.2.1.1.1" xref="S3.SS2.p1.3.m3.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.2.2.1.1.1.2" xref="S3.SS2.p1.3.m3.2.2.1.1.2.cmml">(</mo><msub id="S3.SS2.p1.3.m3.2.2.1.1.1.1" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p1.3.m3.2.2.1.1.1.1.2" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.3.m3.2.2.1.1.1.1.3" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1.3.cmml">𝐩</mi></msub><mo id="S3.SS2.p1.3.m3.2.2.1.1.1.3" xref="S3.SS2.p1.3.m3.2.2.1.1.2.cmml">,</mo><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">𝐫</mi><mo stretchy="false" id="S3.SS2.p1.3.m3.2.2.1.1.1.4" xref="S3.SS2.p1.3.m3.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.2b"><apply id="S3.SS2.p1.3.m3.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2"><eq id="S3.SS2.p1.3.m3.2.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2.2"></eq><apply id="S3.SS2.p1.3.m3.2.2.3.cmml" xref="S3.SS2.p1.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.3.1.cmml" xref="S3.SS2.p1.3.m3.2.2.3">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.3.2.cmml" xref="S3.SS2.p1.3.m3.2.2.3.2">𝑓</ci><ci id="S3.SS2.p1.3.m3.2.2.3.3.cmml" xref="S3.SS2.p1.3.m3.2.2.3.3">𝐫</ci></apply><apply id="S3.SS2.p1.3.m3.2.2.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1"><times id="S3.SS2.p1.3.m3.2.2.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.2"></times><ci id="S3.SS2.p1.3.m3.2.2.1.3.cmml" xref="S3.SS2.p1.3.m3.2.2.1.3">𝒫</ci><interval closure="open" id="S3.SS2.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1"><apply id="S3.SS2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1.2">𝑓</ci><ci id="S3.SS2.p1.3.m3.2.2.1.1.1.1.3.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1.3">𝐩</ci></apply><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐫</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.2c">f_{\mathbf{r}}=\mathcal{P}(f_{\mathbf{p}},\mathbf{r})</annotation></semantics></math> is branched into a classification head <math id="S3.SS2.p1.4.m4.3" class="ltx_Math" alttext="x_{c}=\phi_{\mathrm{cls}}(f_{\mathbf{r}})\in\mathbb{R}^{R\times(|\mathcal{C}|+1)}" display="inline"><semantics id="S3.SS2.p1.4.m4.3a"><mrow id="S3.SS2.p1.4.m4.3.3" xref="S3.SS2.p1.4.m4.3.3.cmml"><msub id="S3.SS2.p1.4.m4.3.3.3" xref="S3.SS2.p1.4.m4.3.3.3.cmml"><mi id="S3.SS2.p1.4.m4.3.3.3.2" xref="S3.SS2.p1.4.m4.3.3.3.2.cmml">x</mi><mi id="S3.SS2.p1.4.m4.3.3.3.3" xref="S3.SS2.p1.4.m4.3.3.3.3.cmml">c</mi></msub><mo id="S3.SS2.p1.4.m4.3.3.4" xref="S3.SS2.p1.4.m4.3.3.4.cmml">=</mo><mrow id="S3.SS2.p1.4.m4.3.3.1" xref="S3.SS2.p1.4.m4.3.3.1.cmml"><msub id="S3.SS2.p1.4.m4.3.3.1.3" xref="S3.SS2.p1.4.m4.3.3.1.3.cmml"><mi id="S3.SS2.p1.4.m4.3.3.1.3.2" xref="S3.SS2.p1.4.m4.3.3.1.3.2.cmml">ϕ</mi><mi id="S3.SS2.p1.4.m4.3.3.1.3.3" xref="S3.SS2.p1.4.m4.3.3.1.3.3.cmml">cls</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m4.3.3.1.2" xref="S3.SS2.p1.4.m4.3.3.1.2.cmml">​</mo><mrow id="S3.SS2.p1.4.m4.3.3.1.1.1" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.3.3.1.1.1.2" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.4.m4.3.3.1.1.1.1" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.cmml"><mi id="S3.SS2.p1.4.m4.3.3.1.1.1.1.2" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.4.m4.3.3.1.1.1.1.3" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.3.cmml">𝐫</mi></msub><mo stretchy="false" id="S3.SS2.p1.4.m4.3.3.1.1.1.3" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.4.m4.3.3.5" xref="S3.SS2.p1.4.m4.3.3.5.cmml">∈</mo><msup id="S3.SS2.p1.4.m4.3.3.6" xref="S3.SS2.p1.4.m4.3.3.6.cmml"><mi id="S3.SS2.p1.4.m4.3.3.6.2" xref="S3.SS2.p1.4.m4.3.3.6.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.4.m4.2.2.2" xref="S3.SS2.p1.4.m4.2.2.2.cmml"><mi id="S3.SS2.p1.4.m4.2.2.2.4" xref="S3.SS2.p1.4.m4.2.2.2.4.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.4.m4.2.2.2.3" xref="S3.SS2.p1.4.m4.2.2.2.3.cmml">×</mo><mrow id="S3.SS2.p1.4.m4.2.2.2.2.1" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.2.2.2.2.1.2" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS2.p1.4.m4.2.2.2.2.1.1" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.cmml"><mrow id="S3.SS2.p1.4.m4.2.2.2.2.1.1.2.2" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.2.2.2.2.1.1.2.2.1" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS2.p1.4.m4.2.2.2.2.1.1.2.2.2" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p1.4.m4.2.2.2.2.1.1.1" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.p1.4.m4.2.2.2.2.1.1.3" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p1.4.m4.2.2.2.2.1.3" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.3b"><apply id="S3.SS2.p1.4.m4.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3"><and id="S3.SS2.p1.4.m4.3.3a.cmml" xref="S3.SS2.p1.4.m4.3.3"></and><apply id="S3.SS2.p1.4.m4.3.3b.cmml" xref="S3.SS2.p1.4.m4.3.3"><eq id="S3.SS2.p1.4.m4.3.3.4.cmml" xref="S3.SS2.p1.4.m4.3.3.4"></eq><apply id="S3.SS2.p1.4.m4.3.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.3.1.cmml" xref="S3.SS2.p1.4.m4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.3.2.cmml" xref="S3.SS2.p1.4.m4.3.3.3.2">𝑥</ci><ci id="S3.SS2.p1.4.m4.3.3.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3.3.3">𝑐</ci></apply><apply id="S3.SS2.p1.4.m4.3.3.1.cmml" xref="S3.SS2.p1.4.m4.3.3.1"><times id="S3.SS2.p1.4.m4.3.3.1.2.cmml" xref="S3.SS2.p1.4.m4.3.3.1.2"></times><apply id="S3.SS2.p1.4.m4.3.3.1.3.cmml" xref="S3.SS2.p1.4.m4.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.1.3.1.cmml" xref="S3.SS2.p1.4.m4.3.3.1.3">subscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.1.3.2.cmml" xref="S3.SS2.p1.4.m4.3.3.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p1.4.m4.3.3.1.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3.1.3.3">cls</ci></apply><apply id="S3.SS2.p1.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.2">𝑓</ci><ci id="S3.SS2.p1.4.m4.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.3">𝐫</ci></apply></apply></apply><apply id="S3.SS2.p1.4.m4.3.3c.cmml" xref="S3.SS2.p1.4.m4.3.3"><in id="S3.SS2.p1.4.m4.3.3.5.cmml" xref="S3.SS2.p1.4.m4.3.3.5"></in><share href="#S3.SS2.p1.4.m4.3.3.1.cmml" id="S3.SS2.p1.4.m4.3.3d.cmml" xref="S3.SS2.p1.4.m4.3.3"></share><apply id="S3.SS2.p1.4.m4.3.3.6.cmml" xref="S3.SS2.p1.4.m4.3.3.6"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.6.1.cmml" xref="S3.SS2.p1.4.m4.3.3.6">superscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.6.2.cmml" xref="S3.SS2.p1.4.m4.3.3.6.2">ℝ</ci><apply id="S3.SS2.p1.4.m4.2.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2.2"><times id="S3.SS2.p1.4.m4.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2.3"></times><ci id="S3.SS2.p1.4.m4.2.2.2.4.cmml" xref="S3.SS2.p1.4.m4.2.2.2.4">𝑅</ci><apply id="S3.SS2.p1.4.m4.2.2.2.2.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.1"><plus id="S3.SS2.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.1"></plus><apply id="S3.SS2.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.2.2"><abs id="S3.SS2.p1.4.m4.2.2.2.2.1.1.2.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.2.2.1"></abs><ci id="S3.SS2.p1.4.m4.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1">𝒞</ci></apply><cn type="integer" id="S3.SS2.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.3c">x_{c}=\phi_{\mathrm{cls}}(f_{\mathbf{r}})\in\mathbb{R}^{R\times(|\mathcal{C}|+1)}</annotation></semantics></math> and a detection head <math id="S3.SS2.p1.5.m5.3" class="ltx_Math" alttext="x_{d}=\phi_{\mathrm{det}}(f_{\mathbf{r}})\in\mathbb{R}^{R\times(|\mathcal{C}|+1)}" display="inline"><semantics id="S3.SS2.p1.5.m5.3a"><mrow id="S3.SS2.p1.5.m5.3.3" xref="S3.SS2.p1.5.m5.3.3.cmml"><msub id="S3.SS2.p1.5.m5.3.3.3" xref="S3.SS2.p1.5.m5.3.3.3.cmml"><mi id="S3.SS2.p1.5.m5.3.3.3.2" xref="S3.SS2.p1.5.m5.3.3.3.2.cmml">x</mi><mi id="S3.SS2.p1.5.m5.3.3.3.3" xref="S3.SS2.p1.5.m5.3.3.3.3.cmml">d</mi></msub><mo id="S3.SS2.p1.5.m5.3.3.4" xref="S3.SS2.p1.5.m5.3.3.4.cmml">=</mo><mrow id="S3.SS2.p1.5.m5.3.3.1" xref="S3.SS2.p1.5.m5.3.3.1.cmml"><msub id="S3.SS2.p1.5.m5.3.3.1.3" xref="S3.SS2.p1.5.m5.3.3.1.3.cmml"><mi id="S3.SS2.p1.5.m5.3.3.1.3.2" xref="S3.SS2.p1.5.m5.3.3.1.3.2.cmml">ϕ</mi><mi id="S3.SS2.p1.5.m5.3.3.1.3.3" xref="S3.SS2.p1.5.m5.3.3.1.3.3.cmml">det</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.3.3.1.2" xref="S3.SS2.p1.5.m5.3.3.1.2.cmml">​</mo><mrow id="S3.SS2.p1.5.m5.3.3.1.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m5.3.3.1.1.1.2" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.5.m5.3.3.1.1.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.cmml"><mi id="S3.SS2.p1.5.m5.3.3.1.1.1.1.2" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.5.m5.3.3.1.1.1.1.3" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.3.cmml">𝐫</mi></msub><mo stretchy="false" id="S3.SS2.p1.5.m5.3.3.1.1.1.3" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.5.m5.3.3.5" xref="S3.SS2.p1.5.m5.3.3.5.cmml">∈</mo><msup id="S3.SS2.p1.5.m5.3.3.6" xref="S3.SS2.p1.5.m5.3.3.6.cmml"><mi id="S3.SS2.p1.5.m5.3.3.6.2" xref="S3.SS2.p1.5.m5.3.3.6.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.5.m5.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.cmml"><mi id="S3.SS2.p1.5.m5.2.2.2.4" xref="S3.SS2.p1.5.m5.2.2.2.4.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.5.m5.2.2.2.3" xref="S3.SS2.p1.5.m5.2.2.2.3.cmml">×</mo><mrow id="S3.SS2.p1.5.m5.2.2.2.2.1" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m5.2.2.2.2.1.2" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS2.p1.5.m5.2.2.2.2.1.1" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.cmml"><mrow id="S3.SS2.p1.5.m5.2.2.2.2.1.1.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m5.2.2.2.2.1.1.2.2.1" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS2.p1.5.m5.2.2.2.2.1.1.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p1.5.m5.2.2.2.2.1.1.1" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.p1.5.m5.2.2.2.2.1.1.3" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p1.5.m5.2.2.2.2.1.3" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.3b"><apply id="S3.SS2.p1.5.m5.3.3.cmml" xref="S3.SS2.p1.5.m5.3.3"><and id="S3.SS2.p1.5.m5.3.3a.cmml" xref="S3.SS2.p1.5.m5.3.3"></and><apply id="S3.SS2.p1.5.m5.3.3b.cmml" xref="S3.SS2.p1.5.m5.3.3"><eq id="S3.SS2.p1.5.m5.3.3.4.cmml" xref="S3.SS2.p1.5.m5.3.3.4"></eq><apply id="S3.SS2.p1.5.m5.3.3.3.cmml" xref="S3.SS2.p1.5.m5.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.3.1.cmml" xref="S3.SS2.p1.5.m5.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.3.2.cmml" xref="S3.SS2.p1.5.m5.3.3.3.2">𝑥</ci><ci id="S3.SS2.p1.5.m5.3.3.3.3.cmml" xref="S3.SS2.p1.5.m5.3.3.3.3">𝑑</ci></apply><apply id="S3.SS2.p1.5.m5.3.3.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1"><times id="S3.SS2.p1.5.m5.3.3.1.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.2"></times><apply id="S3.SS2.p1.5.m5.3.3.1.3.cmml" xref="S3.SS2.p1.5.m5.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.1.3.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.3">subscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.1.3.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p1.5.m5.3.3.1.3.3.cmml" xref="S3.SS2.p1.5.m5.3.3.1.3.3">det</ci></apply><apply id="S3.SS2.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.2">𝑓</ci><ci id="S3.SS2.p1.5.m5.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.3">𝐫</ci></apply></apply></apply><apply id="S3.SS2.p1.5.m5.3.3c.cmml" xref="S3.SS2.p1.5.m5.3.3"><in id="S3.SS2.p1.5.m5.3.3.5.cmml" xref="S3.SS2.p1.5.m5.3.3.5"></in><share href="#S3.SS2.p1.5.m5.3.3.1.cmml" id="S3.SS2.p1.5.m5.3.3d.cmml" xref="S3.SS2.p1.5.m5.3.3"></share><apply id="S3.SS2.p1.5.m5.3.3.6.cmml" xref="S3.SS2.p1.5.m5.3.3.6"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.6.1.cmml" xref="S3.SS2.p1.5.m5.3.3.6">superscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.6.2.cmml" xref="S3.SS2.p1.5.m5.3.3.6.2">ℝ</ci><apply id="S3.SS2.p1.5.m5.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2"><times id="S3.SS2.p1.5.m5.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2.3"></times><ci id="S3.SS2.p1.5.m5.2.2.2.4.cmml" xref="S3.SS2.p1.5.m5.2.2.2.4">𝑅</ci><apply id="S3.SS2.p1.5.m5.2.2.2.2.1.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.1"><plus id="S3.SS2.p1.5.m5.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.1"></plus><apply id="S3.SS2.p1.5.m5.2.2.2.2.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.2.2"><abs id="S3.SS2.p1.5.m5.2.2.2.2.1.1.2.1.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.2.2.1"></abs><ci id="S3.SS2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1">𝒞</ci></apply><cn type="integer" id="S3.SS2.p1.5.m5.2.2.2.2.1.1.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.3c">x_{d}=\phi_{\mathrm{det}}(f_{\mathbf{r}})\in\mathbb{R}^{R\times(|\mathcal{C}|+1)}</annotation></semantics></math>. The classification head <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\phi_{\mathrm{cls}}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">cls</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">italic-ϕ</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">cls</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\phi_{\mathrm{cls}}</annotation></semantics></math> scores individuals proposals into pre-defined <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathcal{C}</annotation></semantics></math> classes and a catch-all background class via softmax across (<math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="|\mathcal{C}|+1" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mrow id="S3.SS2.p1.8.m8.1.2" xref="S3.SS2.p1.8.m8.1.2.cmml"><mrow id="S3.SS2.p1.8.m8.1.2.2.2" xref="S3.SS2.p1.8.m8.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m8.1.2.2.2.1" xref="S3.SS2.p1.8.m8.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS2.p1.8.m8.1.2.2.2.2" xref="S3.SS2.p1.8.m8.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p1.8.m8.1.2.1" xref="S3.SS2.p1.8.m8.1.2.1.cmml">+</mo><mn id="S3.SS2.p1.8.m8.1.2.3" xref="S3.SS2.p1.8.m8.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.2.cmml" xref="S3.SS2.p1.8.m8.1.2"><plus id="S3.SS2.p1.8.m8.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.2.1"></plus><apply id="S3.SS2.p1.8.m8.1.2.2.1.cmml" xref="S3.SS2.p1.8.m8.1.2.2.2"><abs id="S3.SS2.p1.8.m8.1.2.2.1.1.cmml" xref="S3.SS2.p1.8.m8.1.2.2.2.1"></abs><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝒞</ci></apply><cn type="integer" id="S3.SS2.p1.8.m8.1.2.3.cmml" xref="S3.SS2.p1.8.m8.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">|\mathcal{C}|+1</annotation></semantics></math>) class labels</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.12" class="ltx_Math" alttext="\sigma_{\mathrm{cls}}(x_{c}^{(i,j)})=\frac{\exp(x_{c}^{(i,j)})}{\sum_{k=1}^{|\mathcal{C}|+1}\exp(x_{c}^{(i,k)})}" display="block"><semantics id="S3.E3.m1.12a"><mrow id="S3.E3.m1.12.12" xref="S3.E3.m1.12.12.cmml"><mrow id="S3.E3.m1.12.12.1" xref="S3.E3.m1.12.12.1.cmml"><msub id="S3.E3.m1.12.12.1.3" xref="S3.E3.m1.12.12.1.3.cmml"><mi id="S3.E3.m1.12.12.1.3.2" xref="S3.E3.m1.12.12.1.3.2.cmml">σ</mi><mi id="S3.E3.m1.12.12.1.3.3" xref="S3.E3.m1.12.12.1.3.3.cmml">cls</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.12.12.1.2" xref="S3.E3.m1.12.12.1.2.cmml">​</mo><mrow id="S3.E3.m1.12.12.1.1.1" xref="S3.E3.m1.12.12.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.12.12.1.1.1.2" xref="S3.E3.m1.12.12.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.12.12.1.1.1.1" xref="S3.E3.m1.12.12.1.1.1.1.cmml"><mi id="S3.E3.m1.12.12.1.1.1.1.2.2" xref="S3.E3.m1.12.12.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E3.m1.12.12.1.1.1.1.2.3" xref="S3.E3.m1.12.12.1.1.1.1.2.3.cmml">c</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">i</mi><mo id="S3.E3.m1.2.2.2.4.2" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">j</mi><mo stretchy="false" id="S3.E3.m1.2.2.2.4.3" xref="S3.E3.m1.2.2.2.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E3.m1.12.12.1.1.1.3" xref="S3.E3.m1.12.12.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.12.12.2" xref="S3.E3.m1.12.12.2.cmml">=</mo><mfrac id="S3.E3.m1.11.11" xref="S3.E3.m1.11.11.cmml"><mrow id="S3.E3.m1.6.6.4.4" xref="S3.E3.m1.6.6.4.5.cmml"><mi id="S3.E3.m1.5.5.3.3" xref="S3.E3.m1.5.5.3.3.cmml">exp</mi><mo id="S3.E3.m1.6.6.4.4a" xref="S3.E3.m1.6.6.4.5.cmml">⁡</mo><mrow id="S3.E3.m1.6.6.4.4.1" xref="S3.E3.m1.6.6.4.5.cmml"><mo stretchy="false" id="S3.E3.m1.6.6.4.4.1.2" xref="S3.E3.m1.6.6.4.5.cmml">(</mo><msubsup id="S3.E3.m1.6.6.4.4.1.1" xref="S3.E3.m1.6.6.4.4.1.1.cmml"><mi id="S3.E3.m1.6.6.4.4.1.1.2.2" xref="S3.E3.m1.6.6.4.4.1.1.2.2.cmml">x</mi><mi id="S3.E3.m1.6.6.4.4.1.1.2.3" xref="S3.E3.m1.6.6.4.4.1.1.2.3.cmml">c</mi><mrow id="S3.E3.m1.4.4.2.2.2.4" xref="S3.E3.m1.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.2.2.2.4.1" xref="S3.E3.m1.4.4.2.2.2.3.cmml">(</mo><mi id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.cmml">i</mi><mo id="S3.E3.m1.4.4.2.2.2.4.2" xref="S3.E3.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.4.4.2.2.2.2" xref="S3.E3.m1.4.4.2.2.2.2.cmml">j</mi><mo stretchy="false" id="S3.E3.m1.4.4.2.2.2.4.3" xref="S3.E3.m1.4.4.2.2.2.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E3.m1.6.6.4.4.1.3" xref="S3.E3.m1.6.6.4.5.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.11.11.9" xref="S3.E3.m1.11.11.9.cmml"><msubsup id="S3.E3.m1.11.11.9.6" xref="S3.E3.m1.11.11.9.6.cmml"><mo id="S3.E3.m1.11.11.9.6.2.2" xref="S3.E3.m1.11.11.9.6.2.2.cmml">∑</mo><mrow id="S3.E3.m1.11.11.9.6.2.3" xref="S3.E3.m1.11.11.9.6.2.3.cmml"><mi id="S3.E3.m1.11.11.9.6.2.3.2" xref="S3.E3.m1.11.11.9.6.2.3.2.cmml">k</mi><mo id="S3.E3.m1.11.11.9.6.2.3.1" xref="S3.E3.m1.11.11.9.6.2.3.1.cmml">=</mo><mn id="S3.E3.m1.11.11.9.6.2.3.3" xref="S3.E3.m1.11.11.9.6.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m1.7.7.5.1.1" xref="S3.E3.m1.7.7.5.1.1.cmml"><mrow id="S3.E3.m1.7.7.5.1.1.3.2" xref="S3.E3.m1.7.7.5.1.1.3.1.cmml"><mo stretchy="false" id="S3.E3.m1.7.7.5.1.1.3.2.1" xref="S3.E3.m1.7.7.5.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.7.7.5.1.1.1" xref="S3.E3.m1.7.7.5.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.E3.m1.7.7.5.1.1.3.2.2" xref="S3.E3.m1.7.7.5.1.1.3.1.1.cmml">|</mo></mrow><mo id="S3.E3.m1.7.7.5.1.1.2" xref="S3.E3.m1.7.7.5.1.1.2.cmml">+</mo><mn id="S3.E3.m1.7.7.5.1.1.4" xref="S3.E3.m1.7.7.5.1.1.4.cmml">1</mn></mrow></msubsup><mrow id="S3.E3.m1.11.11.9.5.1" xref="S3.E3.m1.11.11.9.5.2.cmml"><mi id="S3.E3.m1.10.10.8.4" xref="S3.E3.m1.10.10.8.4.cmml">exp</mi><mo id="S3.E3.m1.11.11.9.5.1a" xref="S3.E3.m1.11.11.9.5.2.cmml">⁡</mo><mrow id="S3.E3.m1.11.11.9.5.1.1" xref="S3.E3.m1.11.11.9.5.2.cmml"><mo stretchy="false" id="S3.E3.m1.11.11.9.5.1.1.2" xref="S3.E3.m1.11.11.9.5.2.cmml">(</mo><msubsup id="S3.E3.m1.11.11.9.5.1.1.1" xref="S3.E3.m1.11.11.9.5.1.1.1.cmml"><mi id="S3.E3.m1.11.11.9.5.1.1.1.2.2" xref="S3.E3.m1.11.11.9.5.1.1.1.2.2.cmml">x</mi><mi id="S3.E3.m1.11.11.9.5.1.1.1.2.3" xref="S3.E3.m1.11.11.9.5.1.1.1.2.3.cmml">c</mi><mrow id="S3.E3.m1.9.9.7.3.2.4" xref="S3.E3.m1.9.9.7.3.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.9.9.7.3.2.4.1" xref="S3.E3.m1.9.9.7.3.2.3.cmml">(</mo><mi id="S3.E3.m1.8.8.6.2.1.1" xref="S3.E3.m1.8.8.6.2.1.1.cmml">i</mi><mo id="S3.E3.m1.9.9.7.3.2.4.2" xref="S3.E3.m1.9.9.7.3.2.3.cmml">,</mo><mi id="S3.E3.m1.9.9.7.3.2.2" xref="S3.E3.m1.9.9.7.3.2.2.cmml">k</mi><mo stretchy="false" id="S3.E3.m1.9.9.7.3.2.4.3" xref="S3.E3.m1.9.9.7.3.2.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E3.m1.11.11.9.5.1.1.3" xref="S3.E3.m1.11.11.9.5.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.12b"><apply id="S3.E3.m1.12.12.cmml" xref="S3.E3.m1.12.12"><eq id="S3.E3.m1.12.12.2.cmml" xref="S3.E3.m1.12.12.2"></eq><apply id="S3.E3.m1.12.12.1.cmml" xref="S3.E3.m1.12.12.1"><times id="S3.E3.m1.12.12.1.2.cmml" xref="S3.E3.m1.12.12.1.2"></times><apply id="S3.E3.m1.12.12.1.3.cmml" xref="S3.E3.m1.12.12.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.1.3.1.cmml" xref="S3.E3.m1.12.12.1.3">subscript</csymbol><ci id="S3.E3.m1.12.12.1.3.2.cmml" xref="S3.E3.m1.12.12.1.3.2">𝜎</ci><ci id="S3.E3.m1.12.12.1.3.3.cmml" xref="S3.E3.m1.12.12.1.3.3">cls</ci></apply><apply id="S3.E3.m1.12.12.1.1.1.1.cmml" xref="S3.E3.m1.12.12.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.1.1.1.1.1.cmml" xref="S3.E3.m1.12.12.1.1.1">superscript</csymbol><apply id="S3.E3.m1.12.12.1.1.1.1.2.cmml" xref="S3.E3.m1.12.12.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.1.1.1.1.2.1.cmml" xref="S3.E3.m1.12.12.1.1.1">subscript</csymbol><ci id="S3.E3.m1.12.12.1.1.1.1.2.2.cmml" xref="S3.E3.m1.12.12.1.1.1.1.2.2">𝑥</ci><ci id="S3.E3.m1.12.12.1.1.1.1.2.3.cmml" xref="S3.E3.m1.12.12.1.1.1.1.2.3">𝑐</ci></apply><interval closure="open" id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑖</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑗</ci></interval></apply></apply><apply id="S3.E3.m1.11.11.cmml" xref="S3.E3.m1.11.11"><divide id="S3.E3.m1.11.11.10.cmml" xref="S3.E3.m1.11.11"></divide><apply id="S3.E3.m1.6.6.4.5.cmml" xref="S3.E3.m1.6.6.4.4"><exp id="S3.E3.m1.5.5.3.3.cmml" xref="S3.E3.m1.5.5.3.3"></exp><apply id="S3.E3.m1.6.6.4.4.1.1.cmml" xref="S3.E3.m1.6.6.4.4.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.4.4.1.1.1.cmml" xref="S3.E3.m1.6.6.4.4.1.1">superscript</csymbol><apply id="S3.E3.m1.6.6.4.4.1.1.2.cmml" xref="S3.E3.m1.6.6.4.4.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.4.4.1.1.2.1.cmml" xref="S3.E3.m1.6.6.4.4.1.1">subscript</csymbol><ci id="S3.E3.m1.6.6.4.4.1.1.2.2.cmml" xref="S3.E3.m1.6.6.4.4.1.1.2.2">𝑥</ci><ci id="S3.E3.m1.6.6.4.4.1.1.2.3.cmml" xref="S3.E3.m1.6.6.4.4.1.1.2.3">𝑐</ci></apply><interval closure="open" id="S3.E3.m1.4.4.2.2.2.3.cmml" xref="S3.E3.m1.4.4.2.2.2.4"><ci id="S3.E3.m1.3.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1">𝑖</ci><ci id="S3.E3.m1.4.4.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2.2">𝑗</ci></interval></apply></apply><apply id="S3.E3.m1.11.11.9.cmml" xref="S3.E3.m1.11.11.9"><apply id="S3.E3.m1.11.11.9.6.cmml" xref="S3.E3.m1.11.11.9.6"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.9.6.1.cmml" xref="S3.E3.m1.11.11.9.6">superscript</csymbol><apply id="S3.E3.m1.11.11.9.6.2.cmml" xref="S3.E3.m1.11.11.9.6"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.9.6.2.1.cmml" xref="S3.E3.m1.11.11.9.6">subscript</csymbol><sum id="S3.E3.m1.11.11.9.6.2.2.cmml" xref="S3.E3.m1.11.11.9.6.2.2"></sum><apply id="S3.E3.m1.11.11.9.6.2.3.cmml" xref="S3.E3.m1.11.11.9.6.2.3"><eq id="S3.E3.m1.11.11.9.6.2.3.1.cmml" xref="S3.E3.m1.11.11.9.6.2.3.1"></eq><ci id="S3.E3.m1.11.11.9.6.2.3.2.cmml" xref="S3.E3.m1.11.11.9.6.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.11.11.9.6.2.3.3.cmml" xref="S3.E3.m1.11.11.9.6.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.7.7.5.1.1.cmml" xref="S3.E3.m1.7.7.5.1.1"><plus id="S3.E3.m1.7.7.5.1.1.2.cmml" xref="S3.E3.m1.7.7.5.1.1.2"></plus><apply id="S3.E3.m1.7.7.5.1.1.3.1.cmml" xref="S3.E3.m1.7.7.5.1.1.3.2"><abs id="S3.E3.m1.7.7.5.1.1.3.1.1.cmml" xref="S3.E3.m1.7.7.5.1.1.3.2.1"></abs><ci id="S3.E3.m1.7.7.5.1.1.1.cmml" xref="S3.E3.m1.7.7.5.1.1.1">𝒞</ci></apply><cn type="integer" id="S3.E3.m1.7.7.5.1.1.4.cmml" xref="S3.E3.m1.7.7.5.1.1.4">1</cn></apply></apply><apply id="S3.E3.m1.11.11.9.5.2.cmml" xref="S3.E3.m1.11.11.9.5.1"><exp id="S3.E3.m1.10.10.8.4.cmml" xref="S3.E3.m1.10.10.8.4"></exp><apply id="S3.E3.m1.11.11.9.5.1.1.1.cmml" xref="S3.E3.m1.11.11.9.5.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.9.5.1.1.1.1.cmml" xref="S3.E3.m1.11.11.9.5.1.1.1">superscript</csymbol><apply id="S3.E3.m1.11.11.9.5.1.1.1.2.cmml" xref="S3.E3.m1.11.11.9.5.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.9.5.1.1.1.2.1.cmml" xref="S3.E3.m1.11.11.9.5.1.1.1">subscript</csymbol><ci id="S3.E3.m1.11.11.9.5.1.1.1.2.2.cmml" xref="S3.E3.m1.11.11.9.5.1.1.1.2.2">𝑥</ci><ci id="S3.E3.m1.11.11.9.5.1.1.1.2.3.cmml" xref="S3.E3.m1.11.11.9.5.1.1.1.2.3">𝑐</ci></apply><interval closure="open" id="S3.E3.m1.9.9.7.3.2.3.cmml" xref="S3.E3.m1.9.9.7.3.2.4"><ci id="S3.E3.m1.8.8.6.2.1.1.cmml" xref="S3.E3.m1.8.8.6.2.1.1">𝑖</ci><ci id="S3.E3.m1.9.9.7.3.2.2.cmml" xref="S3.E3.m1.9.9.7.3.2.2">𝑘</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.12c">\sigma_{\mathrm{cls}}(x_{c}^{(i,j)})=\frac{\exp(x_{c}^{(i,j)})}{\sum_{k=1}^{|\mathcal{C}|+1}\exp(x_{c}^{(i,k)})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.14" class="ltx_p">The detection head <math id="S3.SS2.p1.9.m1.1" class="ltx_Math" alttext="\phi_{\mathrm{det}}" display="inline"><semantics id="S3.SS2.p1.9.m1.1a"><msub id="S3.SS2.p1.9.m1.1.1" xref="S3.SS2.p1.9.m1.1.1.cmml"><mi id="S3.SS2.p1.9.m1.1.1.2" xref="S3.SS2.p1.9.m1.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.p1.9.m1.1.1.3" xref="S3.SS2.p1.9.m1.1.1.3.cmml">det</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m1.1b"><apply id="S3.SS2.p1.9.m1.1.1.cmml" xref="S3.SS2.p1.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m1.1.1.1.cmml" xref="S3.SS2.p1.9.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m1.1.1.2.cmml" xref="S3.SS2.p1.9.m1.1.1.2">italic-ϕ</ci><ci id="S3.SS2.p1.9.m1.1.1.3.cmml" xref="S3.SS2.p1.9.m1.1.1.3">det</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m1.1c">\phi_{\mathrm{det}}</annotation></semantics></math> measures the contribution of each patch <math id="S3.SS2.p1.10.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.10.m2.1a"><mi id="S3.SS2.p1.10.m2.1.1" xref="S3.SS2.p1.10.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m2.1b"><ci id="S3.SS2.p1.10.m2.1.1.cmml" xref="S3.SS2.p1.10.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m2.1c">i</annotation></semantics></math> (<math id="S3.SS2.p1.11.m3.1" class="ltx_Math" alttext="r_{i}\in\mathbf{r}" display="inline"><semantics id="S3.SS2.p1.11.m3.1a"><mrow id="S3.SS2.p1.11.m3.1.1" xref="S3.SS2.p1.11.m3.1.1.cmml"><msub id="S3.SS2.p1.11.m3.1.1.2" xref="S3.SS2.p1.11.m3.1.1.2.cmml"><mi id="S3.SS2.p1.11.m3.1.1.2.2" xref="S3.SS2.p1.11.m3.1.1.2.2.cmml">r</mi><mi id="S3.SS2.p1.11.m3.1.1.2.3" xref="S3.SS2.p1.11.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.11.m3.1.1.1" xref="S3.SS2.p1.11.m3.1.1.1.cmml">∈</mo><mi id="S3.SS2.p1.11.m3.1.1.3" xref="S3.SS2.p1.11.m3.1.1.3.cmml">𝐫</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m3.1b"><apply id="S3.SS2.p1.11.m3.1.1.cmml" xref="S3.SS2.p1.11.m3.1.1"><in id="S3.SS2.p1.11.m3.1.1.1.cmml" xref="S3.SS2.p1.11.m3.1.1.1"></in><apply id="S3.SS2.p1.11.m3.1.1.2.cmml" xref="S3.SS2.p1.11.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m3.1.1.2.1.cmml" xref="S3.SS2.p1.11.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.11.m3.1.1.2.2.cmml" xref="S3.SS2.p1.11.m3.1.1.2.2">𝑟</ci><ci id="S3.SS2.p1.11.m3.1.1.2.3.cmml" xref="S3.SS2.p1.11.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.11.m3.1.1.3.cmml" xref="S3.SS2.p1.11.m3.1.1.3">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m3.1c">r_{i}\in\mathbf{r}</annotation></semantics></math>) of being classified to class <math id="S3.SS2.p1.12.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p1.12.m4.1a"><mi id="S3.SS2.p1.12.m4.1.1" xref="S3.SS2.p1.12.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m4.1b"><ci id="S3.SS2.p1.12.m4.1.1.cmml" xref="S3.SS2.p1.12.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m4.1c">j</annotation></semantics></math> (in <math id="S3.SS2.p1.13.m5.1" class="ltx_Math" alttext="\mathcal{C}+1" display="inline"><semantics id="S3.SS2.p1.13.m5.1a"><mrow id="S3.SS2.p1.13.m5.1.1" xref="S3.SS2.p1.13.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.13.m5.1.1.2" xref="S3.SS2.p1.13.m5.1.1.2.cmml">𝒞</mi><mo id="S3.SS2.p1.13.m5.1.1.1" xref="S3.SS2.p1.13.m5.1.1.1.cmml">+</mo><mn id="S3.SS2.p1.13.m5.1.1.3" xref="S3.SS2.p1.13.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m5.1b"><apply id="S3.SS2.p1.13.m5.1.1.cmml" xref="S3.SS2.p1.13.m5.1.1"><plus id="S3.SS2.p1.13.m5.1.1.1.cmml" xref="S3.SS2.p1.13.m5.1.1.1"></plus><ci id="S3.SS2.p1.13.m5.1.1.2.cmml" xref="S3.SS2.p1.13.m5.1.1.2">𝒞</ci><cn type="integer" id="S3.SS2.p1.13.m5.1.1.3.cmml" xref="S3.SS2.p1.13.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m5.1c">\mathcal{C}+1</annotation></semantics></math>), (i.e., a patch score for each class) via softmax across <math id="S3.SS2.p1.14.m6.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS2.p1.14.m6.1a"><mi id="S3.SS2.p1.14.m6.1.1" xref="S3.SS2.p1.14.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m6.1b"><ci id="S3.SS2.p1.14.m6.1.1.cmml" xref="S3.SS2.p1.14.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m6.1c">R</annotation></semantics></math> regions</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.11" class="ltx_Math" alttext="\sigma_{\mathrm{det}}(x_{d}^{(i,j)})=\frac{\exp(x_{d}^{(i,j)})}{\sum_{k=1}^{R}\exp(x_{d}^{(k,j)})}" display="block"><semantics id="S3.E4.m1.11a"><mrow id="S3.E4.m1.11.11" xref="S3.E4.m1.11.11.cmml"><mrow id="S3.E4.m1.11.11.1" xref="S3.E4.m1.11.11.1.cmml"><msub id="S3.E4.m1.11.11.1.3" xref="S3.E4.m1.11.11.1.3.cmml"><mi id="S3.E4.m1.11.11.1.3.2" xref="S3.E4.m1.11.11.1.3.2.cmml">σ</mi><mi id="S3.E4.m1.11.11.1.3.3" xref="S3.E4.m1.11.11.1.3.3.cmml">det</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.1.2" xref="S3.E4.m1.11.11.1.2.cmml">​</mo><mrow id="S3.E4.m1.11.11.1.1.1" xref="S3.E4.m1.11.11.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.11.11.1.1.1.2" xref="S3.E4.m1.11.11.1.1.1.1.cmml">(</mo><msubsup id="S3.E4.m1.11.11.1.1.1.1" xref="S3.E4.m1.11.11.1.1.1.1.cmml"><mi id="S3.E4.m1.11.11.1.1.1.1.2.2" xref="S3.E4.m1.11.11.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E4.m1.11.11.1.1.1.1.2.3" xref="S3.E4.m1.11.11.1.1.1.1.2.3.cmml">d</mi><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.2.2.2.4.2" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.2.2.2.4.3" xref="S3.E4.m1.2.2.2.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E4.m1.11.11.1.1.1.3" xref="S3.E4.m1.11.11.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.11.11.2" xref="S3.E4.m1.11.11.2.cmml">=</mo><mfrac id="S3.E4.m1.10.10" xref="S3.E4.m1.10.10.cmml"><mrow id="S3.E4.m1.6.6.4.4" xref="S3.E4.m1.6.6.4.5.cmml"><mi id="S3.E4.m1.5.5.3.3" xref="S3.E4.m1.5.5.3.3.cmml">exp</mi><mo id="S3.E4.m1.6.6.4.4a" xref="S3.E4.m1.6.6.4.5.cmml">⁡</mo><mrow id="S3.E4.m1.6.6.4.4.1" xref="S3.E4.m1.6.6.4.5.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.4.4.1.2" xref="S3.E4.m1.6.6.4.5.cmml">(</mo><msubsup id="S3.E4.m1.6.6.4.4.1.1" xref="S3.E4.m1.6.6.4.4.1.1.cmml"><mi id="S3.E4.m1.6.6.4.4.1.1.2.2" xref="S3.E4.m1.6.6.4.4.1.1.2.2.cmml">x</mi><mi id="S3.E4.m1.6.6.4.4.1.1.2.3" xref="S3.E4.m1.6.6.4.4.1.1.2.3.cmml">d</mi><mrow id="S3.E4.m1.4.4.2.2.2.4" xref="S3.E4.m1.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.2.2.2.4.1" xref="S3.E4.m1.4.4.2.2.2.3.cmml">(</mo><mi id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.4.4.2.2.2.4.2" xref="S3.E4.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.4.4.2.2.2.2" xref="S3.E4.m1.4.4.2.2.2.2.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.4.4.2.2.2.4.3" xref="S3.E4.m1.4.4.2.2.2.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E4.m1.6.6.4.4.1.3" xref="S3.E4.m1.6.6.4.5.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.10.10.8" xref="S3.E4.m1.10.10.8.cmml"><msubsup id="S3.E4.m1.10.10.8.5" xref="S3.E4.m1.10.10.8.5.cmml"><mo id="S3.E4.m1.10.10.8.5.2.2" xref="S3.E4.m1.10.10.8.5.2.2.cmml">∑</mo><mrow id="S3.E4.m1.10.10.8.5.2.3" xref="S3.E4.m1.10.10.8.5.2.3.cmml"><mi id="S3.E4.m1.10.10.8.5.2.3.2" xref="S3.E4.m1.10.10.8.5.2.3.2.cmml">k</mi><mo id="S3.E4.m1.10.10.8.5.2.3.1" xref="S3.E4.m1.10.10.8.5.2.3.1.cmml">=</mo><mn id="S3.E4.m1.10.10.8.5.2.3.3" xref="S3.E4.m1.10.10.8.5.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.10.10.8.5.3" xref="S3.E4.m1.10.10.8.5.3.cmml">R</mi></msubsup><mrow id="S3.E4.m1.10.10.8.4.1" xref="S3.E4.m1.10.10.8.4.2.cmml"><mi id="S3.E4.m1.9.9.7.3" xref="S3.E4.m1.9.9.7.3.cmml">exp</mi><mo id="S3.E4.m1.10.10.8.4.1a" xref="S3.E4.m1.10.10.8.4.2.cmml">⁡</mo><mrow id="S3.E4.m1.10.10.8.4.1.1" xref="S3.E4.m1.10.10.8.4.2.cmml"><mo stretchy="false" id="S3.E4.m1.10.10.8.4.1.1.2" xref="S3.E4.m1.10.10.8.4.2.cmml">(</mo><msubsup id="S3.E4.m1.10.10.8.4.1.1.1" xref="S3.E4.m1.10.10.8.4.1.1.1.cmml"><mi id="S3.E4.m1.10.10.8.4.1.1.1.2.2" xref="S3.E4.m1.10.10.8.4.1.1.1.2.2.cmml">x</mi><mi id="S3.E4.m1.10.10.8.4.1.1.1.2.3" xref="S3.E4.m1.10.10.8.4.1.1.1.2.3.cmml">d</mi><mrow id="S3.E4.m1.8.8.6.2.2.4" xref="S3.E4.m1.8.8.6.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.8.8.6.2.2.4.1" xref="S3.E4.m1.8.8.6.2.2.3.cmml">(</mo><mi id="S3.E4.m1.7.7.5.1.1.1" xref="S3.E4.m1.7.7.5.1.1.1.cmml">k</mi><mo id="S3.E4.m1.8.8.6.2.2.4.2" xref="S3.E4.m1.8.8.6.2.2.3.cmml">,</mo><mi id="S3.E4.m1.8.8.6.2.2.2" xref="S3.E4.m1.8.8.6.2.2.2.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.8.8.6.2.2.4.3" xref="S3.E4.m1.8.8.6.2.2.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E4.m1.10.10.8.4.1.1.3" xref="S3.E4.m1.10.10.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.11b"><apply id="S3.E4.m1.11.11.cmml" xref="S3.E4.m1.11.11"><eq id="S3.E4.m1.11.11.2.cmml" xref="S3.E4.m1.11.11.2"></eq><apply id="S3.E4.m1.11.11.1.cmml" xref="S3.E4.m1.11.11.1"><times id="S3.E4.m1.11.11.1.2.cmml" xref="S3.E4.m1.11.11.1.2"></times><apply id="S3.E4.m1.11.11.1.3.cmml" xref="S3.E4.m1.11.11.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.3.1.cmml" xref="S3.E4.m1.11.11.1.3">subscript</csymbol><ci id="S3.E4.m1.11.11.1.3.2.cmml" xref="S3.E4.m1.11.11.1.3.2">𝜎</ci><ci id="S3.E4.m1.11.11.1.3.3.cmml" xref="S3.E4.m1.11.11.1.3.3">det</ci></apply><apply id="S3.E4.m1.11.11.1.1.1.1.cmml" xref="S3.E4.m1.11.11.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.1.1.1">superscript</csymbol><apply id="S3.E4.m1.11.11.1.1.1.1.2.cmml" xref="S3.E4.m1.11.11.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.1.1.1.1.2.1.cmml" xref="S3.E4.m1.11.11.1.1.1">subscript</csymbol><ci id="S3.E4.m1.11.11.1.1.1.1.2.2.cmml" xref="S3.E4.m1.11.11.1.1.1.1.2.2">𝑥</ci><ci id="S3.E4.m1.11.11.1.1.1.1.2.3.cmml" xref="S3.E4.m1.11.11.1.1.1.1.2.3">𝑑</ci></apply><interval closure="open" id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑖</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑗</ci></interval></apply></apply><apply id="S3.E4.m1.10.10.cmml" xref="S3.E4.m1.10.10"><divide id="S3.E4.m1.10.10.9.cmml" xref="S3.E4.m1.10.10"></divide><apply id="S3.E4.m1.6.6.4.5.cmml" xref="S3.E4.m1.6.6.4.4"><exp id="S3.E4.m1.5.5.3.3.cmml" xref="S3.E4.m1.5.5.3.3"></exp><apply id="S3.E4.m1.6.6.4.4.1.1.cmml" xref="S3.E4.m1.6.6.4.4.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.4.1.1.1.cmml" xref="S3.E4.m1.6.6.4.4.1.1">superscript</csymbol><apply id="S3.E4.m1.6.6.4.4.1.1.2.cmml" xref="S3.E4.m1.6.6.4.4.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.4.1.1.2.1.cmml" xref="S3.E4.m1.6.6.4.4.1.1">subscript</csymbol><ci id="S3.E4.m1.6.6.4.4.1.1.2.2.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2.2">𝑥</ci><ci id="S3.E4.m1.6.6.4.4.1.1.2.3.cmml" xref="S3.E4.m1.6.6.4.4.1.1.2.3">𝑑</ci></apply><interval closure="open" id="S3.E4.m1.4.4.2.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.2.4"><ci id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1">𝑖</ci><ci id="S3.E4.m1.4.4.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2">𝑗</ci></interval></apply></apply><apply id="S3.E4.m1.10.10.8.cmml" xref="S3.E4.m1.10.10.8"><apply id="S3.E4.m1.10.10.8.5.cmml" xref="S3.E4.m1.10.10.8.5"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.8.5.1.cmml" xref="S3.E4.m1.10.10.8.5">superscript</csymbol><apply id="S3.E4.m1.10.10.8.5.2.cmml" xref="S3.E4.m1.10.10.8.5"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.8.5.2.1.cmml" xref="S3.E4.m1.10.10.8.5">subscript</csymbol><sum id="S3.E4.m1.10.10.8.5.2.2.cmml" xref="S3.E4.m1.10.10.8.5.2.2"></sum><apply id="S3.E4.m1.10.10.8.5.2.3.cmml" xref="S3.E4.m1.10.10.8.5.2.3"><eq id="S3.E4.m1.10.10.8.5.2.3.1.cmml" xref="S3.E4.m1.10.10.8.5.2.3.1"></eq><ci id="S3.E4.m1.10.10.8.5.2.3.2.cmml" xref="S3.E4.m1.10.10.8.5.2.3.2">𝑘</ci><cn type="integer" id="S3.E4.m1.10.10.8.5.2.3.3.cmml" xref="S3.E4.m1.10.10.8.5.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.10.10.8.5.3.cmml" xref="S3.E4.m1.10.10.8.5.3">𝑅</ci></apply><apply id="S3.E4.m1.10.10.8.4.2.cmml" xref="S3.E4.m1.10.10.8.4.1"><exp id="S3.E4.m1.9.9.7.3.cmml" xref="S3.E4.m1.9.9.7.3"></exp><apply id="S3.E4.m1.10.10.8.4.1.1.1.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.8.4.1.1.1.1.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1">superscript</csymbol><apply id="S3.E4.m1.10.10.8.4.1.1.1.2.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.8.4.1.1.1.2.1.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1">subscript</csymbol><ci id="S3.E4.m1.10.10.8.4.1.1.1.2.2.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.2.2">𝑥</ci><ci id="S3.E4.m1.10.10.8.4.1.1.1.2.3.cmml" xref="S3.E4.m1.10.10.8.4.1.1.1.2.3">𝑑</ci></apply><interval closure="open" id="S3.E4.m1.8.8.6.2.2.3.cmml" xref="S3.E4.m1.8.8.6.2.2.4"><ci id="S3.E4.m1.7.7.5.1.1.1.cmml" xref="S3.E4.m1.7.7.5.1.1.1">𝑘</ci><ci id="S3.E4.m1.8.8.6.2.2.2.cmml" xref="S3.E4.m1.8.8.6.2.2.2">𝑗</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.11c">\sigma_{\mathrm{det}}(x_{d}^{(i,j)})=\frac{\exp(x_{d}^{(i,j)})}{\sum_{k=1}^{R}\exp(x_{d}^{(k,j)})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.10" class="ltx_p">We train using image-level labels <math id="S3.SS2.p2.1.m1.7" class="ltx_Math" alttext="\mathrm{\mathbf{Y}}=[y_{0},y_{1},\dots,y_{|\mathcal{C}|}]^{T}\in\mathbb{R}^{(|C|+1)\times 1}" display="inline"><semantics id="S3.SS2.p2.1.m1.7a"><mrow id="S3.SS2.p2.1.m1.7.7" xref="S3.SS2.p2.1.m1.7.7.cmml"><mi id="S3.SS2.p2.1.m1.7.7.5" xref="S3.SS2.p2.1.m1.7.7.5.cmml">𝐘</mi><mo id="S3.SS2.p2.1.m1.7.7.6" xref="S3.SS2.p2.1.m1.7.7.6.cmml">=</mo><msup id="S3.SS2.p2.1.m1.7.7.3" xref="S3.SS2.p2.1.m1.7.7.3.cmml"><mrow id="S3.SS2.p2.1.m1.7.7.3.3.3" xref="S3.SS2.p2.1.m1.7.7.3.3.4.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.7.7.3.3.3.4" xref="S3.SS2.p2.1.m1.7.7.3.3.4.cmml">[</mo><msub id="S3.SS2.p2.1.m1.5.5.1.1.1.1" xref="S3.SS2.p2.1.m1.5.5.1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.5.5.1.1.1.1.2" xref="S3.SS2.p2.1.m1.5.5.1.1.1.1.2.cmml">y</mi><mn id="S3.SS2.p2.1.m1.5.5.1.1.1.1.3" xref="S3.SS2.p2.1.m1.5.5.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS2.p2.1.m1.7.7.3.3.3.5" xref="S3.SS2.p2.1.m1.7.7.3.3.4.cmml">,</mo><msub id="S3.SS2.p2.1.m1.6.6.2.2.2.2" xref="S3.SS2.p2.1.m1.6.6.2.2.2.2.cmml"><mi id="S3.SS2.p2.1.m1.6.6.2.2.2.2.2" xref="S3.SS2.p2.1.m1.6.6.2.2.2.2.2.cmml">y</mi><mn id="S3.SS2.p2.1.m1.6.6.2.2.2.2.3" xref="S3.SS2.p2.1.m1.6.6.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.p2.1.m1.7.7.3.3.3.6" xref="S3.SS2.p2.1.m1.7.7.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.1.m1.4.4" xref="S3.SS2.p2.1.m1.4.4.cmml">…</mi><mo id="S3.SS2.p2.1.m1.7.7.3.3.3.7" xref="S3.SS2.p2.1.m1.7.7.3.3.4.cmml">,</mo><msub id="S3.SS2.p2.1.m1.7.7.3.3.3.3" xref="S3.SS2.p2.1.m1.7.7.3.3.3.3.cmml"><mi id="S3.SS2.p2.1.m1.7.7.3.3.3.3.2" xref="S3.SS2.p2.1.m1.7.7.3.3.3.3.2.cmml">y</mi><mrow id="S3.SS2.p2.1.m1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.1.1.1.3.1" xref="S3.SS2.p2.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS2.p2.1.m1.1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><mo stretchy="false" id="S3.SS2.p2.1.m1.7.7.3.3.3.8" xref="S3.SS2.p2.1.m1.7.7.3.3.4.cmml">]</mo></mrow><mi id="S3.SS2.p2.1.m1.7.7.3.5" xref="S3.SS2.p2.1.m1.7.7.3.5.cmml">T</mi></msup><mo id="S3.SS2.p2.1.m1.7.7.7" xref="S3.SS2.p2.1.m1.7.7.7.cmml">∈</mo><msup id="S3.SS2.p2.1.m1.7.7.8" xref="S3.SS2.p2.1.m1.7.7.8.cmml"><mi id="S3.SS2.p2.1.m1.7.7.8.2" xref="S3.SS2.p2.1.m1.7.7.8.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.1.m1.3.3.2" xref="S3.SS2.p2.1.m1.3.3.2.cmml"><mrow id="S3.SS2.p2.1.m1.3.3.2.2.1" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.3.3.2.2.1.2" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.cmml">(</mo><mrow id="S3.SS2.p2.1.m1.3.3.2.2.1.1" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.cmml"><mrow id="S3.SS2.p2.1.m1.3.3.2.2.1.1.2.2" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.3.3.2.2.1.1.2.2.1" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.2.1.1.cmml">|</mo><mi id="S3.SS2.p2.1.m1.2.2.1.1" xref="S3.SS2.p2.1.m1.2.2.1.1.cmml">C</mi><mo stretchy="false" id="S3.SS2.p2.1.m1.3.3.2.2.1.1.2.2.2" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p2.1.m1.3.3.2.2.1.1.1" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.p2.1.m1.3.3.2.2.1.1.3" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S3.SS2.p2.1.m1.3.3.2.2.1.3" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.SS2.p2.1.m1.3.3.2.3" xref="S3.SS2.p2.1.m1.3.3.2.3.cmml">×</mo><mn id="S3.SS2.p2.1.m1.3.3.2.4" xref="S3.SS2.p2.1.m1.3.3.2.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.7b"><apply id="S3.SS2.p2.1.m1.7.7.cmml" xref="S3.SS2.p2.1.m1.7.7"><and id="S3.SS2.p2.1.m1.7.7a.cmml" xref="S3.SS2.p2.1.m1.7.7"></and><apply id="S3.SS2.p2.1.m1.7.7b.cmml" xref="S3.SS2.p2.1.m1.7.7"><eq id="S3.SS2.p2.1.m1.7.7.6.cmml" xref="S3.SS2.p2.1.m1.7.7.6"></eq><ci id="S3.SS2.p2.1.m1.7.7.5.cmml" xref="S3.SS2.p2.1.m1.7.7.5">𝐘</ci><apply id="S3.SS2.p2.1.m1.7.7.3.cmml" xref="S3.SS2.p2.1.m1.7.7.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.7.7.3.4.cmml" xref="S3.SS2.p2.1.m1.7.7.3">superscript</csymbol><list id="S3.SS2.p2.1.m1.7.7.3.3.4.cmml" xref="S3.SS2.p2.1.m1.7.7.3.3.3"><apply id="S3.SS2.p2.1.m1.5.5.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.5.5.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.5.5.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.5.5.1.1.1.1.2">𝑦</ci><cn type="integer" id="S3.SS2.p2.1.m1.5.5.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.5.5.1.1.1.1.3">0</cn></apply><apply id="S3.SS2.p2.1.m1.6.6.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.6.6.2.2.2.2.1.cmml" xref="S3.SS2.p2.1.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.6.6.2.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.6.6.2.2.2.2.2">𝑦</ci><cn type="integer" id="S3.SS2.p2.1.m1.6.6.2.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.6.6.2.2.2.2.3">1</cn></apply><ci id="S3.SS2.p2.1.m1.4.4.cmml" xref="S3.SS2.p2.1.m1.4.4">…</ci><apply id="S3.SS2.p2.1.m1.7.7.3.3.3.3.cmml" xref="S3.SS2.p2.1.m1.7.7.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.7.7.3.3.3.3.1.cmml" xref="S3.SS2.p2.1.m1.7.7.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.7.7.3.3.3.3.2.cmml" xref="S3.SS2.p2.1.m1.7.7.3.3.3.3.2">𝑦</ci><apply id="S3.SS2.p2.1.m1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.3"><abs id="S3.SS2.p2.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.3.1"></abs><ci id="S3.SS2.p2.1.m1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1">𝒞</ci></apply></apply></list><ci id="S3.SS2.p2.1.m1.7.7.3.5.cmml" xref="S3.SS2.p2.1.m1.7.7.3.5">𝑇</ci></apply></apply><apply id="S3.SS2.p2.1.m1.7.7c.cmml" xref="S3.SS2.p2.1.m1.7.7"><in id="S3.SS2.p2.1.m1.7.7.7.cmml" xref="S3.SS2.p2.1.m1.7.7.7"></in><share href="#S3.SS2.p2.1.m1.7.7.3.cmml" id="S3.SS2.p2.1.m1.7.7d.cmml" xref="S3.SS2.p2.1.m1.7.7"></share><apply id="S3.SS2.p2.1.m1.7.7.8.cmml" xref="S3.SS2.p2.1.m1.7.7.8"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.7.7.8.1.cmml" xref="S3.SS2.p2.1.m1.7.7.8">superscript</csymbol><ci id="S3.SS2.p2.1.m1.7.7.8.2.cmml" xref="S3.SS2.p2.1.m1.7.7.8.2">ℝ</ci><apply id="S3.SS2.p2.1.m1.3.3.2.cmml" xref="S3.SS2.p2.1.m1.3.3.2"><times id="S3.SS2.p2.1.m1.3.3.2.3.cmml" xref="S3.SS2.p2.1.m1.3.3.2.3"></times><apply id="S3.SS2.p2.1.m1.3.3.2.2.1.1.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.1"><plus id="S3.SS2.p2.1.m1.3.3.2.2.1.1.1.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.1"></plus><apply id="S3.SS2.p2.1.m1.3.3.2.2.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.2.2"><abs id="S3.SS2.p2.1.m1.3.3.2.2.1.1.2.1.1.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.2.2.1"></abs><ci id="S3.SS2.p2.1.m1.2.2.1.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1">𝐶</ci></apply><cn type="integer" id="S3.SS2.p2.1.m1.3.3.2.2.1.1.3.cmml" xref="S3.SS2.p2.1.m1.3.3.2.2.1.1.3">1</cn></apply><cn type="integer" id="S3.SS2.p2.1.m1.3.3.2.4.cmml" xref="S3.SS2.p2.1.m1.3.3.2.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.7c">\mathrm{\mathbf{Y}}=[y_{0},y_{1},\dots,y_{|\mathcal{C}|}]^{T}\in\mathbb{R}^{(|C|+1)\times 1}</annotation></semantics></math>, where <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="y_{c}=1" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><msub id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">y</mi><mi id="S3.SS2.p2.2.m2.1.1.2.3" xref="S3.SS2.p2.2.m2.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><eq id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"></eq><apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">𝑦</ci><ci id="S3.SS2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.1.1.2.3">𝑐</ci></apply><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">y_{c}=1</annotation></semantics></math> or <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mn id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><cn type="integer" id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">0</cn></annotation-xml></semantics></math> indicates if instance of class <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="c\in\mathcal{C}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">c</mi><mo id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><in id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"></in><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑐</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">c\in\mathcal{C}</annotation></semantics></math> is present in the image or not. The combined score (element-wise product) of class score <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="\sigma_{\mathrm{cls}}" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">σ</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">cls</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝜎</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">cls</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\sigma_{\mathrm{cls}}</annotation></semantics></math> for each patch and a patch score for each class <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="\sigma_{\mathrm{det}}" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">σ</mi><mi id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">det</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">𝜎</ci><ci id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3">det</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\sigma_{\mathrm{det}}</annotation></semantics></math> is computed as, <math id="S3.SS2.p2.7.m7.2" class="ltx_Math" alttext="\omega_{0}=\sigma_{\mathrm{cls}}(x_{c})\odot\sigma_{\mathrm{det}}(x_{d})" display="inline"><semantics id="S3.SS2.p2.7.m7.2a"><mrow id="S3.SS2.p2.7.m7.2.2" xref="S3.SS2.p2.7.m7.2.2.cmml"><msub id="S3.SS2.p2.7.m7.2.2.4" xref="S3.SS2.p2.7.m7.2.2.4.cmml"><mi id="S3.SS2.p2.7.m7.2.2.4.2" xref="S3.SS2.p2.7.m7.2.2.4.2.cmml">ω</mi><mn id="S3.SS2.p2.7.m7.2.2.4.3" xref="S3.SS2.p2.7.m7.2.2.4.3.cmml">0</mn></msub><mo id="S3.SS2.p2.7.m7.2.2.3" xref="S3.SS2.p2.7.m7.2.2.3.cmml">=</mo><mrow id="S3.SS2.p2.7.m7.2.2.2" xref="S3.SS2.p2.7.m7.2.2.2.cmml"><mrow id="S3.SS2.p2.7.m7.1.1.1.1" xref="S3.SS2.p2.7.m7.1.1.1.1.cmml"><mrow id="S3.SS2.p2.7.m7.1.1.1.1.1" xref="S3.SS2.p2.7.m7.1.1.1.1.1.cmml"><msub id="S3.SS2.p2.7.m7.1.1.1.1.1.3" xref="S3.SS2.p2.7.m7.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.7.m7.1.1.1.1.1.3.2" xref="S3.SS2.p2.7.m7.1.1.1.1.1.3.2.cmml">σ</mi><mi id="S3.SS2.p2.7.m7.1.1.1.1.1.3.3" xref="S3.SS2.p2.7.m7.1.1.1.1.1.3.3.cmml">cls</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.7.m7.1.1.1.1.1.2" xref="S3.SS2.p2.7.m7.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p2.7.m7.1.1.1.1.1.1.1" xref="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.2" xref="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1" xref="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo rspace="0.055em" stretchy="false" id="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.3" xref="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.SS2.p2.7.m7.1.1.1.1.2" xref="S3.SS2.p2.7.m7.1.1.1.1.2.cmml">⊙</mo><msub id="S3.SS2.p2.7.m7.1.1.1.1.3" xref="S3.SS2.p2.7.m7.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.7.m7.1.1.1.1.3.2" xref="S3.SS2.p2.7.m7.1.1.1.1.3.2.cmml">σ</mi><mi id="S3.SS2.p2.7.m7.1.1.1.1.3.3" xref="S3.SS2.p2.7.m7.1.1.1.1.3.3.cmml">det</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p2.7.m7.2.2.2.3" xref="S3.SS2.p2.7.m7.2.2.2.3.cmml">​</mo><mrow id="S3.SS2.p2.7.m7.2.2.2.2.1" xref="S3.SS2.p2.7.m7.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.7.m7.2.2.2.2.1.2" xref="S3.SS2.p2.7.m7.2.2.2.2.1.1.cmml">(</mo><msub id="S3.SS2.p2.7.m7.2.2.2.2.1.1" xref="S3.SS2.p2.7.m7.2.2.2.2.1.1.cmml"><mi id="S3.SS2.p2.7.m7.2.2.2.2.1.1.2" xref="S3.SS2.p2.7.m7.2.2.2.2.1.1.2.cmml">x</mi><mi id="S3.SS2.p2.7.m7.2.2.2.2.1.1.3" xref="S3.SS2.p2.7.m7.2.2.2.2.1.1.3.cmml">d</mi></msub><mo stretchy="false" id="S3.SS2.p2.7.m7.2.2.2.2.1.3" xref="S3.SS2.p2.7.m7.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.2b"><apply id="S3.SS2.p2.7.m7.2.2.cmml" xref="S3.SS2.p2.7.m7.2.2"><eq id="S3.SS2.p2.7.m7.2.2.3.cmml" xref="S3.SS2.p2.7.m7.2.2.3"></eq><apply id="S3.SS2.p2.7.m7.2.2.4.cmml" xref="S3.SS2.p2.7.m7.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.2.2.4.1.cmml" xref="S3.SS2.p2.7.m7.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.7.m7.2.2.4.2.cmml" xref="S3.SS2.p2.7.m7.2.2.4.2">𝜔</ci><cn type="integer" id="S3.SS2.p2.7.m7.2.2.4.3.cmml" xref="S3.SS2.p2.7.m7.2.2.4.3">0</cn></apply><apply id="S3.SS2.p2.7.m7.2.2.2.cmml" xref="S3.SS2.p2.7.m7.2.2.2"><times id="S3.SS2.p2.7.m7.2.2.2.3.cmml" xref="S3.SS2.p2.7.m7.2.2.2.3"></times><apply id="S3.SS2.p2.7.m7.1.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.7.m7.1.1.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.2">direct-product</csymbol><apply id="S3.SS2.p2.7.m7.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.1"><times id="S3.SS2.p2.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.1.2"></times><apply id="S3.SS2.p2.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.1.3.2">𝜎</ci><ci id="S3.SS2.p2.7.m7.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.1.3.3">cls</ci></apply><apply id="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><apply id="S3.SS2.p2.7.m7.1.1.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.3.2">𝜎</ci><ci id="S3.SS2.p2.7.m7.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.7.m7.1.1.1.1.3.3">det</ci></apply></apply><apply id="S3.SS2.p2.7.m7.2.2.2.2.1.1.cmml" xref="S3.SS2.p2.7.m7.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p2.7.m7.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.2.2.2.2.1.1.2.cmml" xref="S3.SS2.p2.7.m7.2.2.2.2.1.1.2">𝑥</ci><ci id="S3.SS2.p2.7.m7.2.2.2.2.1.1.3.cmml" xref="S3.SS2.p2.7.m7.2.2.2.2.1.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.2c">\omega_{0}=\sigma_{\mathrm{cls}}(x_{c})\odot\sigma_{\mathrm{det}}(x_{d})</annotation></semantics></math>. Since we only have image-level class labels, from the combined score <math id="S3.SS2.p2.8.m8.2" class="ltx_Math" alttext="\omega_{0}\in\mathbb{R}^{R\times(|\mathcal{C}|+1)}" display="inline"><semantics id="S3.SS2.p2.8.m8.2a"><mrow id="S3.SS2.p2.8.m8.2.3" xref="S3.SS2.p2.8.m8.2.3.cmml"><msub id="S3.SS2.p2.8.m8.2.3.2" xref="S3.SS2.p2.8.m8.2.3.2.cmml"><mi id="S3.SS2.p2.8.m8.2.3.2.2" xref="S3.SS2.p2.8.m8.2.3.2.2.cmml">ω</mi><mn id="S3.SS2.p2.8.m8.2.3.2.3" xref="S3.SS2.p2.8.m8.2.3.2.3.cmml">0</mn></msub><mo id="S3.SS2.p2.8.m8.2.3.1" xref="S3.SS2.p2.8.m8.2.3.1.cmml">∈</mo><msup id="S3.SS2.p2.8.m8.2.3.3" xref="S3.SS2.p2.8.m8.2.3.3.cmml"><mi id="S3.SS2.p2.8.m8.2.3.3.2" xref="S3.SS2.p2.8.m8.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.8.m8.2.2.2" xref="S3.SS2.p2.8.m8.2.2.2.cmml"><mi id="S3.SS2.p2.8.m8.2.2.2.4" xref="S3.SS2.p2.8.m8.2.2.2.4.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.8.m8.2.2.2.3" xref="S3.SS2.p2.8.m8.2.2.2.3.cmml">×</mo><mrow id="S3.SS2.p2.8.m8.2.2.2.2.1" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.8.m8.2.2.2.2.1.2" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS2.p2.8.m8.2.2.2.2.1.1" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.cmml"><mrow id="S3.SS2.p2.8.m8.2.2.2.2.1.1.2.2" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S3.SS2.p2.8.m8.2.2.2.2.1.1.2.2.1" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.8.m8.1.1.1.1" xref="S3.SS2.p2.8.m8.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS2.p2.8.m8.2.2.2.2.1.1.2.2.2" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p2.8.m8.2.2.2.2.1.1.1" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.p2.8.m8.2.2.2.2.1.1.3" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p2.8.m8.2.2.2.2.1.3" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.2b"><apply id="S3.SS2.p2.8.m8.2.3.cmml" xref="S3.SS2.p2.8.m8.2.3"><in id="S3.SS2.p2.8.m8.2.3.1.cmml" xref="S3.SS2.p2.8.m8.2.3.1"></in><apply id="S3.SS2.p2.8.m8.2.3.2.cmml" xref="S3.SS2.p2.8.m8.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.2.3.2.1.cmml" xref="S3.SS2.p2.8.m8.2.3.2">subscript</csymbol><ci id="S3.SS2.p2.8.m8.2.3.2.2.cmml" xref="S3.SS2.p2.8.m8.2.3.2.2">𝜔</ci><cn type="integer" id="S3.SS2.p2.8.m8.2.3.2.3.cmml" xref="S3.SS2.p2.8.m8.2.3.2.3">0</cn></apply><apply id="S3.SS2.p2.8.m8.2.3.3.cmml" xref="S3.SS2.p2.8.m8.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.2.3.3.1.cmml" xref="S3.SS2.p2.8.m8.2.3.3">superscript</csymbol><ci id="S3.SS2.p2.8.m8.2.3.3.2.cmml" xref="S3.SS2.p2.8.m8.2.3.3.2">ℝ</ci><apply id="S3.SS2.p2.8.m8.2.2.2.cmml" xref="S3.SS2.p2.8.m8.2.2.2"><times id="S3.SS2.p2.8.m8.2.2.2.3.cmml" xref="S3.SS2.p2.8.m8.2.2.2.3"></times><ci id="S3.SS2.p2.8.m8.2.2.2.4.cmml" xref="S3.SS2.p2.8.m8.2.2.2.4">𝑅</ci><apply id="S3.SS2.p2.8.m8.2.2.2.2.1.1.cmml" xref="S3.SS2.p2.8.m8.2.2.2.2.1"><plus id="S3.SS2.p2.8.m8.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.1"></plus><apply id="S3.SS2.p2.8.m8.2.2.2.2.1.1.2.1.cmml" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.2.2"><abs id="S3.SS2.p2.8.m8.2.2.2.2.1.1.2.1.1.cmml" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.2.2.1"></abs><ci id="S3.SS2.p2.8.m8.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1">𝒞</ci></apply><cn type="integer" id="S3.SS2.p2.8.m8.2.2.2.2.1.1.3.cmml" xref="S3.SS2.p2.8.m8.2.2.2.2.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.2c">\omega_{0}\in\mathbb{R}^{R\times(|\mathcal{C}|+1)}</annotation></semantics></math>, we take the sum over all patches <math id="S3.SS2.p2.9.m9.2" class="ltx_Math" alttext="\hat{y}_{c}=\sum_{i=1}^{R}\omega_{0}^{i,c}" display="inline"><semantics id="S3.SS2.p2.9.m9.2a"><mrow id="S3.SS2.p2.9.m9.2.3" xref="S3.SS2.p2.9.m9.2.3.cmml"><msub id="S3.SS2.p2.9.m9.2.3.2" xref="S3.SS2.p2.9.m9.2.3.2.cmml"><mover accent="true" id="S3.SS2.p2.9.m9.2.3.2.2" xref="S3.SS2.p2.9.m9.2.3.2.2.cmml"><mi id="S3.SS2.p2.9.m9.2.3.2.2.2" xref="S3.SS2.p2.9.m9.2.3.2.2.2.cmml">y</mi><mo id="S3.SS2.p2.9.m9.2.3.2.2.1" xref="S3.SS2.p2.9.m9.2.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p2.9.m9.2.3.2.3" xref="S3.SS2.p2.9.m9.2.3.2.3.cmml">c</mi></msub><mo rspace="0.111em" id="S3.SS2.p2.9.m9.2.3.1" xref="S3.SS2.p2.9.m9.2.3.1.cmml">=</mo><mrow id="S3.SS2.p2.9.m9.2.3.3" xref="S3.SS2.p2.9.m9.2.3.3.cmml"><msubsup id="S3.SS2.p2.9.m9.2.3.3.1" xref="S3.SS2.p2.9.m9.2.3.3.1.cmml"><mo id="S3.SS2.p2.9.m9.2.3.3.1.2.2" xref="S3.SS2.p2.9.m9.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p2.9.m9.2.3.3.1.2.3" xref="S3.SS2.p2.9.m9.2.3.3.1.2.3.cmml"><mi id="S3.SS2.p2.9.m9.2.3.3.1.2.3.2" xref="S3.SS2.p2.9.m9.2.3.3.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p2.9.m9.2.3.3.1.2.3.1" xref="S3.SS2.p2.9.m9.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p2.9.m9.2.3.3.1.2.3.3" xref="S3.SS2.p2.9.m9.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p2.9.m9.2.3.3.1.3" xref="S3.SS2.p2.9.m9.2.3.3.1.3.cmml">R</mi></msubsup><msubsup id="S3.SS2.p2.9.m9.2.3.3.2" xref="S3.SS2.p2.9.m9.2.3.3.2.cmml"><mi id="S3.SS2.p2.9.m9.2.3.3.2.2.2" xref="S3.SS2.p2.9.m9.2.3.3.2.2.2.cmml">ω</mi><mn id="S3.SS2.p2.9.m9.2.3.3.2.2.3" xref="S3.SS2.p2.9.m9.2.3.3.2.2.3.cmml">0</mn><mrow id="S3.SS2.p2.9.m9.2.2.2.4" xref="S3.SS2.p2.9.m9.2.2.2.3.cmml"><mi id="S3.SS2.p2.9.m9.1.1.1.1" xref="S3.SS2.p2.9.m9.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p2.9.m9.2.2.2.4.1" xref="S3.SS2.p2.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p2.9.m9.2.2.2.2" xref="S3.SS2.p2.9.m9.2.2.2.2.cmml">c</mi></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.2b"><apply id="S3.SS2.p2.9.m9.2.3.cmml" xref="S3.SS2.p2.9.m9.2.3"><eq id="S3.SS2.p2.9.m9.2.3.1.cmml" xref="S3.SS2.p2.9.m9.2.3.1"></eq><apply id="S3.SS2.p2.9.m9.2.3.2.cmml" xref="S3.SS2.p2.9.m9.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.2.3.2.1.cmml" xref="S3.SS2.p2.9.m9.2.3.2">subscript</csymbol><apply id="S3.SS2.p2.9.m9.2.3.2.2.cmml" xref="S3.SS2.p2.9.m9.2.3.2.2"><ci id="S3.SS2.p2.9.m9.2.3.2.2.1.cmml" xref="S3.SS2.p2.9.m9.2.3.2.2.1">^</ci><ci id="S3.SS2.p2.9.m9.2.3.2.2.2.cmml" xref="S3.SS2.p2.9.m9.2.3.2.2.2">𝑦</ci></apply><ci id="S3.SS2.p2.9.m9.2.3.2.3.cmml" xref="S3.SS2.p2.9.m9.2.3.2.3">𝑐</ci></apply><apply id="S3.SS2.p2.9.m9.2.3.3.cmml" xref="S3.SS2.p2.9.m9.2.3.3"><apply id="S3.SS2.p2.9.m9.2.3.3.1.cmml" xref="S3.SS2.p2.9.m9.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.2.3.3.1.1.cmml" xref="S3.SS2.p2.9.m9.2.3.3.1">superscript</csymbol><apply id="S3.SS2.p2.9.m9.2.3.3.1.2.cmml" xref="S3.SS2.p2.9.m9.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.2.3.3.1.2.1.cmml" xref="S3.SS2.p2.9.m9.2.3.3.1">subscript</csymbol><sum id="S3.SS2.p2.9.m9.2.3.3.1.2.2.cmml" xref="S3.SS2.p2.9.m9.2.3.3.1.2.2"></sum><apply id="S3.SS2.p2.9.m9.2.3.3.1.2.3.cmml" xref="S3.SS2.p2.9.m9.2.3.3.1.2.3"><eq id="S3.SS2.p2.9.m9.2.3.3.1.2.3.1.cmml" xref="S3.SS2.p2.9.m9.2.3.3.1.2.3.1"></eq><ci id="S3.SS2.p2.9.m9.2.3.3.1.2.3.2.cmml" xref="S3.SS2.p2.9.m9.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p2.9.m9.2.3.3.1.2.3.3.cmml" xref="S3.SS2.p2.9.m9.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p2.9.m9.2.3.3.1.3.cmml" xref="S3.SS2.p2.9.m9.2.3.3.1.3">𝑅</ci></apply><apply id="S3.SS2.p2.9.m9.2.3.3.2.cmml" xref="S3.SS2.p2.9.m9.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.2.3.3.2.1.cmml" xref="S3.SS2.p2.9.m9.2.3.3.2">superscript</csymbol><apply id="S3.SS2.p2.9.m9.2.3.3.2.2.cmml" xref="S3.SS2.p2.9.m9.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.2.3.3.2.2.1.cmml" xref="S3.SS2.p2.9.m9.2.3.3.2">subscript</csymbol><ci id="S3.SS2.p2.9.m9.2.3.3.2.2.2.cmml" xref="S3.SS2.p2.9.m9.2.3.3.2.2.2">𝜔</ci><cn type="integer" id="S3.SS2.p2.9.m9.2.3.3.2.2.3.cmml" xref="S3.SS2.p2.9.m9.2.3.3.2.2.3">0</cn></apply><list id="S3.SS2.p2.9.m9.2.2.2.3.cmml" xref="S3.SS2.p2.9.m9.2.2.2.4"><ci id="S3.SS2.p2.9.m9.1.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1.1.1">𝑖</ci><ci id="S3.SS2.p2.9.m9.2.2.2.2.cmml" xref="S3.SS2.p2.9.m9.2.2.2.2">𝑐</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.2c">\hat{y}_{c}=\sum_{i=1}^{R}\omega_{0}^{i,c}</annotation></semantics></math> to get the probability of instances from the <math id="S3.SS2.p2.10.m10.1" class="ltx_Math" alttext="c^{th}" display="inline"><semantics id="S3.SS2.p2.10.m10.1a"><msup id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml"><mi id="S3.SS2.p2.10.m10.1.1.2" xref="S3.SS2.p2.10.m10.1.1.2.cmml">c</mi><mrow id="S3.SS2.p2.10.m10.1.1.3" xref="S3.SS2.p2.10.m10.1.1.3.cmml"><mi id="S3.SS2.p2.10.m10.1.1.3.2" xref="S3.SS2.p2.10.m10.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.10.m10.1.1.3.1" xref="S3.SS2.p2.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.10.m10.1.1.3.3" xref="S3.SS2.p2.10.m10.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><apply id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">superscript</csymbol><ci id="S3.SS2.p2.10.m10.1.1.2.cmml" xref="S3.SS2.p2.10.m10.1.1.2">𝑐</ci><apply id="S3.SS2.p2.10.m10.1.1.3.cmml" xref="S3.SS2.p2.10.m10.1.1.3"><times id="S3.SS2.p2.10.m10.1.1.3.1.cmml" xref="S3.SS2.p2.10.m10.1.1.3.1"></times><ci id="S3.SS2.p2.10.m10.1.1.3.2.cmml" xref="S3.SS2.p2.10.m10.1.1.3.2">𝑡</ci><ci id="S3.SS2.p2.10.m10.1.1.3.3.cmml" xref="S3.SS2.p2.10.m10.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">c^{th}</annotation></semantics></math> class present in the image or not. Training happens via multi-class cross entropy,</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.4" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{ws}}=-\sum_{c=1}^{|\mathcal{C}|+1}y_{c}\log\hat{y}_{c}+(1-y_{c})\log(1-\hat{y}_{c})" display="block"><semantics id="S3.E5.m1.4a"><mrow id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml"><msub id="S3.E5.m1.4.4.4" xref="S3.E5.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4.4.2" xref="S3.E5.m1.4.4.4.2.cmml">ℒ</mi><mi id="S3.E5.m1.4.4.4.3" xref="S3.E5.m1.4.4.4.3.cmml">ws</mi></msub><mo id="S3.E5.m1.4.4.3" xref="S3.E5.m1.4.4.3.cmml">=</mo><mrow id="S3.E5.m1.4.4.2" xref="S3.E5.m1.4.4.2.cmml"><mrow id="S3.E5.m1.4.4.2.4" xref="S3.E5.m1.4.4.2.4.cmml"><mo id="S3.E5.m1.4.4.2.4a" xref="S3.E5.m1.4.4.2.4.cmml">−</mo><mrow id="S3.E5.m1.4.4.2.4.2" xref="S3.E5.m1.4.4.2.4.2.cmml"><munderover id="S3.E5.m1.4.4.2.4.2.1" xref="S3.E5.m1.4.4.2.4.2.1.cmml"><mo movablelimits="false" id="S3.E5.m1.4.4.2.4.2.1.2.2" xref="S3.E5.m1.4.4.2.4.2.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.4.4.2.4.2.1.2.3" xref="S3.E5.m1.4.4.2.4.2.1.2.3.cmml"><mi id="S3.E5.m1.4.4.2.4.2.1.2.3.2" xref="S3.E5.m1.4.4.2.4.2.1.2.3.2.cmml">c</mi><mo id="S3.E5.m1.4.4.2.4.2.1.2.3.1" xref="S3.E5.m1.4.4.2.4.2.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.4.4.2.4.2.1.2.3.3" xref="S3.E5.m1.4.4.2.4.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.3.2.1" xref="S3.E5.m1.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.E5.m1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">+</mo><mn id="S3.E5.m1.1.1.1.4" xref="S3.E5.m1.1.1.1.4.cmml">1</mn></mrow></munderover><mrow id="S3.E5.m1.4.4.2.4.2.2" xref="S3.E5.m1.4.4.2.4.2.2.cmml"><msub id="S3.E5.m1.4.4.2.4.2.2.2" xref="S3.E5.m1.4.4.2.4.2.2.2.cmml"><mi id="S3.E5.m1.4.4.2.4.2.2.2.2" xref="S3.E5.m1.4.4.2.4.2.2.2.2.cmml">y</mi><mi id="S3.E5.m1.4.4.2.4.2.2.2.3" xref="S3.E5.m1.4.4.2.4.2.2.2.3.cmml">c</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E5.m1.4.4.2.4.2.2.1" xref="S3.E5.m1.4.4.2.4.2.2.1.cmml">​</mo><mrow id="S3.E5.m1.4.4.2.4.2.2.3" xref="S3.E5.m1.4.4.2.4.2.2.3.cmml"><mi id="S3.E5.m1.4.4.2.4.2.2.3.1" xref="S3.E5.m1.4.4.2.4.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E5.m1.4.4.2.4.2.2.3a" xref="S3.E5.m1.4.4.2.4.2.2.3.cmml">⁡</mo><msub id="S3.E5.m1.4.4.2.4.2.2.3.2" xref="S3.E5.m1.4.4.2.4.2.2.3.2.cmml"><mover accent="true" id="S3.E5.m1.4.4.2.4.2.2.3.2.2" xref="S3.E5.m1.4.4.2.4.2.2.3.2.2.cmml"><mi id="S3.E5.m1.4.4.2.4.2.2.3.2.2.2" xref="S3.E5.m1.4.4.2.4.2.2.3.2.2.2.cmml">y</mi><mo id="S3.E5.m1.4.4.2.4.2.2.3.2.2.1" xref="S3.E5.m1.4.4.2.4.2.2.3.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.4.4.2.4.2.2.3.2.3" xref="S3.E5.m1.4.4.2.4.2.2.3.2.3.cmml">c</mi></msub></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.4.4.2.3" xref="S3.E5.m1.4.4.2.3.cmml">+</mo><mrow id="S3.E5.m1.4.4.2.2" xref="S3.E5.m1.4.4.2.2.cmml"><mrow id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.cmml"><mn id="S3.E5.m1.3.3.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E5.m1.3.3.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E5.m1.3.3.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.3.2" xref="S3.E5.m1.3.3.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E5.m1.3.3.1.1.1.1.1.3.3" xref="S3.E5.m1.3.3.1.1.1.1.1.3.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E5.m1.4.4.2.2.3" xref="S3.E5.m1.4.4.2.2.3.cmml">​</mo><mrow id="S3.E5.m1.4.4.2.2.2.1" xref="S3.E5.m1.4.4.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">log</mi><mo id="S3.E5.m1.4.4.2.2.2.1a" xref="S3.E5.m1.4.4.2.2.2.2.cmml">⁡</mo><mrow id="S3.E5.m1.4.4.2.2.2.1.1" xref="S3.E5.m1.4.4.2.2.2.2.cmml"><mo stretchy="false" id="S3.E5.m1.4.4.2.2.2.1.1.2" xref="S3.E5.m1.4.4.2.2.2.2.cmml">(</mo><mrow id="S3.E5.m1.4.4.2.2.2.1.1.1" xref="S3.E5.m1.4.4.2.2.2.1.1.1.cmml"><mn id="S3.E5.m1.4.4.2.2.2.1.1.1.2" xref="S3.E5.m1.4.4.2.2.2.1.1.1.2.cmml">1</mn><mo id="S3.E5.m1.4.4.2.2.2.1.1.1.1" xref="S3.E5.m1.4.4.2.2.2.1.1.1.1.cmml">−</mo><msub id="S3.E5.m1.4.4.2.2.2.1.1.1.3" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3.cmml"><mover accent="true" id="S3.E5.m1.4.4.2.2.2.1.1.1.3.2" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3.2.cmml"><mi id="S3.E5.m1.4.4.2.2.2.1.1.1.3.2.2" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3.2.2.cmml">y</mi><mo id="S3.E5.m1.4.4.2.2.2.1.1.1.3.2.1" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.4.4.2.2.2.1.1.1.3.3" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S3.E5.m1.4.4.2.2.2.1.1.3" xref="S3.E5.m1.4.4.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.4b"><apply id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4"><eq id="S3.E5.m1.4.4.3.cmml" xref="S3.E5.m1.4.4.3"></eq><apply id="S3.E5.m1.4.4.4.cmml" xref="S3.E5.m1.4.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.1.cmml" xref="S3.E5.m1.4.4.4">subscript</csymbol><ci id="S3.E5.m1.4.4.4.2.cmml" xref="S3.E5.m1.4.4.4.2">ℒ</ci><ci id="S3.E5.m1.4.4.4.3.cmml" xref="S3.E5.m1.4.4.4.3">ws</ci></apply><apply id="S3.E5.m1.4.4.2.cmml" xref="S3.E5.m1.4.4.2"><plus id="S3.E5.m1.4.4.2.3.cmml" xref="S3.E5.m1.4.4.2.3"></plus><apply id="S3.E5.m1.4.4.2.4.cmml" xref="S3.E5.m1.4.4.2.4"><minus id="S3.E5.m1.4.4.2.4.1.cmml" xref="S3.E5.m1.4.4.2.4"></minus><apply id="S3.E5.m1.4.4.2.4.2.cmml" xref="S3.E5.m1.4.4.2.4.2"><apply id="S3.E5.m1.4.4.2.4.2.1.cmml" xref="S3.E5.m1.4.4.2.4.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.4.2.1.1.cmml" xref="S3.E5.m1.4.4.2.4.2.1">superscript</csymbol><apply id="S3.E5.m1.4.4.2.4.2.1.2.cmml" xref="S3.E5.m1.4.4.2.4.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.4.2.1.2.1.cmml" xref="S3.E5.m1.4.4.2.4.2.1">subscript</csymbol><sum id="S3.E5.m1.4.4.2.4.2.1.2.2.cmml" xref="S3.E5.m1.4.4.2.4.2.1.2.2"></sum><apply id="S3.E5.m1.4.4.2.4.2.1.2.3.cmml" xref="S3.E5.m1.4.4.2.4.2.1.2.3"><eq id="S3.E5.m1.4.4.2.4.2.1.2.3.1.cmml" xref="S3.E5.m1.4.4.2.4.2.1.2.3.1"></eq><ci id="S3.E5.m1.4.4.2.4.2.1.2.3.2.cmml" xref="S3.E5.m1.4.4.2.4.2.1.2.3.2">𝑐</ci><cn type="integer" id="S3.E5.m1.4.4.2.4.2.1.2.3.3.cmml" xref="S3.E5.m1.4.4.2.4.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><plus id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></plus><apply id="S3.E5.m1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.3.2"><abs id="S3.E5.m1.1.1.1.3.1.1.cmml" xref="S3.E5.m1.1.1.1.3.2.1"></abs><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝒞</ci></apply><cn type="integer" id="S3.E5.m1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.4">1</cn></apply></apply><apply id="S3.E5.m1.4.4.2.4.2.2.cmml" xref="S3.E5.m1.4.4.2.4.2.2"><times id="S3.E5.m1.4.4.2.4.2.2.1.cmml" xref="S3.E5.m1.4.4.2.4.2.2.1"></times><apply id="S3.E5.m1.4.4.2.4.2.2.2.cmml" xref="S3.E5.m1.4.4.2.4.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.4.2.2.2.1.cmml" xref="S3.E5.m1.4.4.2.4.2.2.2">subscript</csymbol><ci id="S3.E5.m1.4.4.2.4.2.2.2.2.cmml" xref="S3.E5.m1.4.4.2.4.2.2.2.2">𝑦</ci><ci id="S3.E5.m1.4.4.2.4.2.2.2.3.cmml" xref="S3.E5.m1.4.4.2.4.2.2.2.3">𝑐</ci></apply><apply id="S3.E5.m1.4.4.2.4.2.2.3.cmml" xref="S3.E5.m1.4.4.2.4.2.2.3"><log id="S3.E5.m1.4.4.2.4.2.2.3.1.cmml" xref="S3.E5.m1.4.4.2.4.2.2.3.1"></log><apply id="S3.E5.m1.4.4.2.4.2.2.3.2.cmml" xref="S3.E5.m1.4.4.2.4.2.2.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.4.2.2.3.2.1.cmml" xref="S3.E5.m1.4.4.2.4.2.2.3.2">subscript</csymbol><apply id="S3.E5.m1.4.4.2.4.2.2.3.2.2.cmml" xref="S3.E5.m1.4.4.2.4.2.2.3.2.2"><ci id="S3.E5.m1.4.4.2.4.2.2.3.2.2.1.cmml" xref="S3.E5.m1.4.4.2.4.2.2.3.2.2.1">^</ci><ci id="S3.E5.m1.4.4.2.4.2.2.3.2.2.2.cmml" xref="S3.E5.m1.4.4.2.4.2.2.3.2.2.2">𝑦</ci></apply><ci id="S3.E5.m1.4.4.2.4.2.2.3.2.3.cmml" xref="S3.E5.m1.4.4.2.4.2.2.3.2.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S3.E5.m1.4.4.2.2.cmml" xref="S3.E5.m1.4.4.2.2"><times id="S3.E5.m1.4.4.2.2.3.cmml" xref="S3.E5.m1.4.4.2.2.3"></times><apply id="S3.E5.m1.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><minus id="S3.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E5.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.2">1</cn><apply id="S3.E5.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E5.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3.3">𝑐</ci></apply></apply><apply id="S3.E5.m1.4.4.2.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2.1"><log id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"></log><apply id="S3.E5.m1.4.4.2.2.2.1.1.1.cmml" xref="S3.E5.m1.4.4.2.2.2.1.1.1"><minus id="S3.E5.m1.4.4.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.4.4.2.2.2.1.1.1.1"></minus><cn type="integer" id="S3.E5.m1.4.4.2.2.2.1.1.1.2.cmml" xref="S3.E5.m1.4.4.2.2.2.1.1.1.2">1</cn><apply id="S3.E5.m1.4.4.2.2.2.1.1.1.3.cmml" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.2.1.1.1.3.1.cmml" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3">subscript</csymbol><apply id="S3.E5.m1.4.4.2.2.2.1.1.1.3.2.cmml" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3.2"><ci id="S3.E5.m1.4.4.2.2.2.1.1.1.3.2.1.cmml" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3.2.1">^</ci><ci id="S3.E5.m1.4.4.2.2.2.1.1.1.3.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3.2.2">𝑦</ci></apply><ci id="S3.E5.m1.4.4.2.2.2.1.1.1.3.3.cmml" xref="S3.E5.m1.4.4.2.2.2.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.4c">\mathcal{L}_{\mathrm{ws}}=-\sum_{c=1}^{|\mathcal{C}|+1}y_{c}\log\hat{y}_{c}+(1-y_{c})\log(1-\hat{y}_{c})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.17" class="ltx_p">Unlike SOD, using bounding box annotation to refine proposals, WSOD uses only image-level class labels that fail to naively refine proposals. Hence, we use an iterative refinement classifier <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\omega_{k}=\phi_{\mathrm{cls}}^{*}(f_{\mathbf{r}})" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><msub id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml">ω</mi><mi id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml">k</mi></msub><mo id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">=</mo><mrow id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml"><msubsup id="S3.SS2.p3.1.m1.1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.1.3.2.2" xref="S3.SS2.p3.1.m1.1.1.1.3.2.2.cmml">ϕ</mi><mi id="S3.SS2.p3.1.m1.1.1.1.3.2.3" xref="S3.SS2.p3.1.m1.1.1.1.3.2.3.cmml">cls</mi><mo id="S3.SS2.p3.1.m1.1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.1.3.3.cmml">∗</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p3.1.m1.1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p3.1.m1.1.1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.1.m1.1.1.1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.1.m1.1.1.1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.SS2.p3.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.1.1.1.1.3.cmml">𝐫</mi></msub><mo stretchy="false" id="S3.SS2.p3.1.m1.1.1.1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><eq id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2"></eq><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">𝜔</ci><ci id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3">𝑘</ci></apply><apply id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1"><times id="S3.SS2.p3.1.m1.1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.1.2"></times><apply id="S3.SS2.p3.1.m1.1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.3">superscript</csymbol><apply id="S3.SS2.p3.1.m1.1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.3.2.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.1.3.2.2.cmml" xref="S3.SS2.p3.1.m1.1.1.1.3.2.2">italic-ϕ</ci><ci id="S3.SS2.p3.1.m1.1.1.1.3.2.3.cmml" xref="S3.SS2.p3.1.m1.1.1.1.3.2.3">cls</ci></apply><times id="S3.SS2.p3.1.m1.1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.1.3.3"></times></apply><apply id="S3.SS2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.SS2.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1.1.3">𝐫</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\omega_{k}=\phi_{\mathrm{cls}}^{*}(f_{\mathbf{r}})</annotation></semantics></math>, where <math id="S3.SS2.p3.2.m2.2" class="ltx_Math" alttext="\omega_{k}\in\mathbb{R}^{R\times(|\mathcal{C}|+1)}" display="inline"><semantics id="S3.SS2.p3.2.m2.2a"><mrow id="S3.SS2.p3.2.m2.2.3" xref="S3.SS2.p3.2.m2.2.3.cmml"><msub id="S3.SS2.p3.2.m2.2.3.2" xref="S3.SS2.p3.2.m2.2.3.2.cmml"><mi id="S3.SS2.p3.2.m2.2.3.2.2" xref="S3.SS2.p3.2.m2.2.3.2.2.cmml">ω</mi><mi id="S3.SS2.p3.2.m2.2.3.2.3" xref="S3.SS2.p3.2.m2.2.3.2.3.cmml">k</mi></msub><mo id="S3.SS2.p3.2.m2.2.3.1" xref="S3.SS2.p3.2.m2.2.3.1.cmml">∈</mo><msup id="S3.SS2.p3.2.m2.2.3.3" xref="S3.SS2.p3.2.m2.2.3.3.cmml"><mi id="S3.SS2.p3.2.m2.2.3.3.2" xref="S3.SS2.p3.2.m2.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.2.m2.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.cmml"><mi id="S3.SS2.p3.2.m2.2.2.2.4" xref="S3.SS2.p3.2.m2.2.2.2.4.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.2.m2.2.2.2.3" xref="S3.SS2.p3.2.m2.2.2.2.3.cmml">×</mo><mrow id="S3.SS2.p3.2.m2.2.2.2.2.1" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.2.m2.2.2.2.2.1.2" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS2.p3.2.m2.2.2.2.2.1.1" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.cmml"><mrow id="S3.SS2.p3.2.m2.2.2.2.2.1.1.2.2" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S3.SS2.p3.2.m2.2.2.2.2.1.1.2.2.1" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.2.m2.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS2.p3.2.m2.2.2.2.2.1.1.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p3.2.m2.2.2.2.2.1.1.1" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.p3.2.m2.2.2.2.2.1.1.3" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p3.2.m2.2.2.2.2.1.3" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.2b"><apply id="S3.SS2.p3.2.m2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.3"><in id="S3.SS2.p3.2.m2.2.3.1.cmml" xref="S3.SS2.p3.2.m2.2.3.1"></in><apply id="S3.SS2.p3.2.m2.2.3.2.cmml" xref="S3.SS2.p3.2.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.3.2.1.cmml" xref="S3.SS2.p3.2.m2.2.3.2">subscript</csymbol><ci id="S3.SS2.p3.2.m2.2.3.2.2.cmml" xref="S3.SS2.p3.2.m2.2.3.2.2">𝜔</ci><ci id="S3.SS2.p3.2.m2.2.3.2.3.cmml" xref="S3.SS2.p3.2.m2.2.3.2.3">𝑘</ci></apply><apply id="S3.SS2.p3.2.m2.2.3.3.cmml" xref="S3.SS2.p3.2.m2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.3.3.1.cmml" xref="S3.SS2.p3.2.m2.2.3.3">superscript</csymbol><ci id="S3.SS2.p3.2.m2.2.3.3.2.cmml" xref="S3.SS2.p3.2.m2.2.3.3.2">ℝ</ci><apply id="S3.SS2.p3.2.m2.2.2.2.cmml" xref="S3.SS2.p3.2.m2.2.2.2"><times id="S3.SS2.p3.2.m2.2.2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.2.2.3"></times><ci id="S3.SS2.p3.2.m2.2.2.2.4.cmml" xref="S3.SS2.p3.2.m2.2.2.2.4">𝑅</ci><apply id="S3.SS2.p3.2.m2.2.2.2.2.1.1.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1"><plus id="S3.SS2.p3.2.m2.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.1"></plus><apply id="S3.SS2.p3.2.m2.2.2.2.2.1.1.2.1.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.2.2"><abs id="S3.SS2.p3.2.m2.2.2.2.2.1.1.2.1.1.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.2.2.1"></abs><ci id="S3.SS2.p3.2.m2.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1">𝒞</ci></apply><cn type="integer" id="S3.SS2.p3.2.m2.2.2.2.2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.2c">\omega_{k}\in\mathbb{R}^{R\times(|\mathcal{C}|+1)}</annotation></semantics></math> to predict a <em id="S3.SS2.p3.17.1" class="ltx_emph ltx_font_italic">refined</em> class score for each RoI, as shown in <a href="#S3.F3" title="In 3.2 Weakly Supervised Object Detection ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>. The refinement classifier <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\phi_{\mathrm{cls}}^{*}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><msubsup id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2.2" xref="S3.SS2.p3.3.m3.1.1.2.2.cmml">ϕ</mi><mi id="S3.SS2.p3.3.m3.1.1.2.3" xref="S3.SS2.p3.3.m3.1.1.2.3.cmml">cls</mi><mo id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2">italic-ϕ</ci><ci id="S3.SS2.p3.3.m3.1.1.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3">cls</ci></apply><times id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\phi_{\mathrm{cls}}^{*}</annotation></semantics></math> is supervised via pseudo scores labels <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="{l}_{k-1}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">l</mi><mrow id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.3.2" xref="S3.SS2.p3.4.m4.1.1.3.2.cmml">k</mi><mo id="S3.SS2.p3.4.m4.1.1.3.1" xref="S3.SS2.p3.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p3.4.m4.1.1.3.3" xref="S3.SS2.p3.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝑙</ci><apply id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3"><minus id="S3.SS2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.1"></minus><ci id="S3.SS2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">{l}_{k-1}</annotation></semantics></math> from <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="(k-1)^{th}" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><msup id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mrow id="S3.SS2.p3.5.m5.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.5.m5.1.1.1.1.2" xref="S3.SS2.p3.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.5.m5.1.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.1.1.1.2" xref="S3.SS2.p3.5.m5.1.1.1.1.1.2.cmml">k</mi><mo id="S3.SS2.p3.5.m5.1.1.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS2.p3.5.m5.1.1.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p3.5.m5.1.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml"><mi id="S3.SS2.p3.5.m5.1.1.3.2" xref="S3.SS2.p3.5.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.1.1.3.1" xref="S3.SS2.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.5.m5.1.1.3.3" xref="S3.SS2.p3.5.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1">superscript</csymbol><apply id="S3.SS2.p3.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1"><minus id="S3.SS2.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1"></minus><ci id="S3.SS2.p3.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="S3.SS2.p3.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3"><times id="S3.SS2.p3.5.m5.1.1.3.1.cmml" xref="S3.SS2.p3.5.m5.1.1.3.1"></times><ci id="S3.SS2.p3.5.m5.1.1.3.2.cmml" xref="S3.SS2.p3.5.m5.1.1.3.2">𝑡</ci><ci id="S3.SS2.p3.5.m5.1.1.3.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">(k-1)^{th}</annotation></semantics></math> iteration as, (i) we compute the patches with highest scores in each class <math id="S3.SS2.p3.6.m6.4" class="ltx_Math" alttext="r_{*}^{c}=\arg\max_{r}(\omega_{k-1}^{(r,c)})" display="inline"><semantics id="S3.SS2.p3.6.m6.4a"><mrow id="S3.SS2.p3.6.m6.4.4" xref="S3.SS2.p3.6.m6.4.4.cmml"><msubsup id="S3.SS2.p3.6.m6.4.4.4" xref="S3.SS2.p3.6.m6.4.4.4.cmml"><mi id="S3.SS2.p3.6.m6.4.4.4.2.2" xref="S3.SS2.p3.6.m6.4.4.4.2.2.cmml">r</mi><mo id="S3.SS2.p3.6.m6.4.4.4.2.3" xref="S3.SS2.p3.6.m6.4.4.4.2.3.cmml">∗</mo><mi id="S3.SS2.p3.6.m6.4.4.4.3" xref="S3.SS2.p3.6.m6.4.4.4.3.cmml">c</mi></msubsup><mo id="S3.SS2.p3.6.m6.4.4.3" xref="S3.SS2.p3.6.m6.4.4.3.cmml">=</mo><mrow id="S3.SS2.p3.6.m6.4.4.2" xref="S3.SS2.p3.6.m6.4.4.2.cmml"><mi id="S3.SS2.p3.6.m6.4.4.2.3" xref="S3.SS2.p3.6.m6.4.4.2.3.cmml">arg</mi><mo lspace="0.167em" id="S3.SS2.p3.6.m6.4.4.2a" xref="S3.SS2.p3.6.m6.4.4.2.cmml">⁡</mo><mrow id="S3.SS2.p3.6.m6.4.4.2.2.2" xref="S3.SS2.p3.6.m6.4.4.2.2.3.cmml"><msub id="S3.SS2.p3.6.m6.3.3.1.1.1.1" xref="S3.SS2.p3.6.m6.3.3.1.1.1.1.cmml"><mi id="S3.SS2.p3.6.m6.3.3.1.1.1.1.2" xref="S3.SS2.p3.6.m6.3.3.1.1.1.1.2.cmml">max</mi><mi id="S3.SS2.p3.6.m6.3.3.1.1.1.1.3" xref="S3.SS2.p3.6.m6.3.3.1.1.1.1.3.cmml">r</mi></msub><mo id="S3.SS2.p3.6.m6.4.4.2.2.2a" xref="S3.SS2.p3.6.m6.4.4.2.2.3.cmml">⁡</mo><mrow id="S3.SS2.p3.6.m6.4.4.2.2.2.2" xref="S3.SS2.p3.6.m6.4.4.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p3.6.m6.4.4.2.2.2.2.2" xref="S3.SS2.p3.6.m6.4.4.2.2.3.cmml">(</mo><msubsup id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.cmml"><mi id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.2" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.2.cmml">ω</mi><mrow id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.cmml"><mi id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.2" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.2.cmml">k</mi><mo id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.1" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.1.cmml">−</mo><mn id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.3" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS2.p3.6.m6.2.2.2.4" xref="S3.SS2.p3.6.m6.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p3.6.m6.2.2.2.4.1" xref="S3.SS2.p3.6.m6.2.2.2.3.cmml">(</mo><mi id="S3.SS2.p3.6.m6.1.1.1.1" xref="S3.SS2.p3.6.m6.1.1.1.1.cmml">r</mi><mo id="S3.SS2.p3.6.m6.2.2.2.4.2" xref="S3.SS2.p3.6.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.6.m6.2.2.2.2" xref="S3.SS2.p3.6.m6.2.2.2.2.cmml">c</mi><mo stretchy="false" id="S3.SS2.p3.6.m6.2.2.2.4.3" xref="S3.SS2.p3.6.m6.2.2.2.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS2.p3.6.m6.4.4.2.2.2.2.3" xref="S3.SS2.p3.6.m6.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.4b"><apply id="S3.SS2.p3.6.m6.4.4.cmml" xref="S3.SS2.p3.6.m6.4.4"><eq id="S3.SS2.p3.6.m6.4.4.3.cmml" xref="S3.SS2.p3.6.m6.4.4.3"></eq><apply id="S3.SS2.p3.6.m6.4.4.4.cmml" xref="S3.SS2.p3.6.m6.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.4.4.4.1.cmml" xref="S3.SS2.p3.6.m6.4.4.4">superscript</csymbol><apply id="S3.SS2.p3.6.m6.4.4.4.2.cmml" xref="S3.SS2.p3.6.m6.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.4.4.4.2.1.cmml" xref="S3.SS2.p3.6.m6.4.4.4">subscript</csymbol><ci id="S3.SS2.p3.6.m6.4.4.4.2.2.cmml" xref="S3.SS2.p3.6.m6.4.4.4.2.2">𝑟</ci><times id="S3.SS2.p3.6.m6.4.4.4.2.3.cmml" xref="S3.SS2.p3.6.m6.4.4.4.2.3"></times></apply><ci id="S3.SS2.p3.6.m6.4.4.4.3.cmml" xref="S3.SS2.p3.6.m6.4.4.4.3">𝑐</ci></apply><apply id="S3.SS2.p3.6.m6.4.4.2.cmml" xref="S3.SS2.p3.6.m6.4.4.2"><arg id="S3.SS2.p3.6.m6.4.4.2.3.cmml" xref="S3.SS2.p3.6.m6.4.4.2.3"></arg><apply id="S3.SS2.p3.6.m6.4.4.2.2.3.cmml" xref="S3.SS2.p3.6.m6.4.4.2.2.2"><apply id="S3.SS2.p3.6.m6.3.3.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.3.3.1.1.1.1">subscript</csymbol><max id="S3.SS2.p3.6.m6.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p3.6.m6.3.3.1.1.1.1.2"></max><ci id="S3.SS2.p3.6.m6.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p3.6.m6.3.3.1.1.1.1.3">𝑟</ci></apply><apply id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.cmml" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.1.cmml" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1">superscript</csymbol><apply id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.cmml" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.1.cmml" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.2.cmml" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.2">𝜔</ci><apply id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.cmml" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3"><minus id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.1.cmml" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.1"></minus><ci id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.2.cmml" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.3.cmml" xref="S3.SS2.p3.6.m6.4.4.2.2.2.2.1.2.3.3">1</cn></apply></apply><interval closure="open" id="S3.SS2.p3.6.m6.2.2.2.3.cmml" xref="S3.SS2.p3.6.m6.2.2.2.4"><ci id="S3.SS2.p3.6.m6.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1.1.1">𝑟</ci><ci id="S3.SS2.p3.6.m6.2.2.2.2.cmml" xref="S3.SS2.p3.6.m6.2.2.2.2">𝑐</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.4c">r_{*}^{c}=\arg\max_{r}(\omega_{k-1}^{(r,c)})</annotation></semantics></math>. (ii) All regions <math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="r_{i}\in\mathbf{r}" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><mrow id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><msub id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2.2" xref="S3.SS2.p3.7.m7.1.1.2.2.cmml">r</mi><mi id="S3.SS2.p3.7.m7.1.1.2.3" xref="S3.SS2.p3.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p3.7.m7.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.cmml">∈</mo><mi id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">𝐫</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><in id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1"></in><apply id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.2.1.cmml" xref="S3.SS2.p3.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.2.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2.2">𝑟</ci><ci id="S3.SS2.p3.7.m7.1.1.2.3.cmml" xref="S3.SS2.p3.7.m7.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">r_{i}\in\mathbf{r}</annotation></semantics></math> that has high overlap with a top scoring patch <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="r_{*}^{c}" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><msubsup id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.2.2" xref="S3.SS2.p3.8.m8.1.1.2.2.cmml">r</mi><mo id="S3.SS2.p3.8.m8.1.1.2.3" xref="S3.SS2.p3.8.m8.1.1.2.3.cmml">∗</mo><mi id="S3.SS2.p3.8.m8.1.1.3" xref="S3.SS2.p3.8.m8.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><apply id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">superscript</csymbol><apply id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.1.1.2.1.cmml" xref="S3.SS2.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p3.8.m8.1.1.2.2.cmml" xref="S3.SS2.p3.8.m8.1.1.2.2">𝑟</ci><times id="S3.SS2.p3.8.m8.1.1.2.3.cmml" xref="S3.SS2.p3.8.m8.1.1.2.3"></times></apply><ci id="S3.SS2.p3.8.m8.1.1.3.cmml" xref="S3.SS2.p3.8.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">r_{*}^{c}</annotation></semantics></math> should be the same class label <math id="S3.SS2.p3.9.m9.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p3.9.m9.1a"><mi id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><ci id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">c</annotation></semantics></math> as, <math id="S3.SS2.p3.10.m10.2" class="ltx_Math" alttext="{l}_{k-1}^{r,c}=1" display="inline"><semantics id="S3.SS2.p3.10.m10.2a"><mrow id="S3.SS2.p3.10.m10.2.3" xref="S3.SS2.p3.10.m10.2.3.cmml"><msubsup id="S3.SS2.p3.10.m10.2.3.2" xref="S3.SS2.p3.10.m10.2.3.2.cmml"><mi id="S3.SS2.p3.10.m10.2.3.2.2.2" xref="S3.SS2.p3.10.m10.2.3.2.2.2.cmml">l</mi><mrow id="S3.SS2.p3.10.m10.2.3.2.2.3" xref="S3.SS2.p3.10.m10.2.3.2.2.3.cmml"><mi id="S3.SS2.p3.10.m10.2.3.2.2.3.2" xref="S3.SS2.p3.10.m10.2.3.2.2.3.2.cmml">k</mi><mo id="S3.SS2.p3.10.m10.2.3.2.2.3.1" xref="S3.SS2.p3.10.m10.2.3.2.2.3.1.cmml">−</mo><mn id="S3.SS2.p3.10.m10.2.3.2.2.3.3" xref="S3.SS2.p3.10.m10.2.3.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS2.p3.10.m10.2.2.2.4" xref="S3.SS2.p3.10.m10.2.2.2.3.cmml"><mi id="S3.SS2.p3.10.m10.1.1.1.1" xref="S3.SS2.p3.10.m10.1.1.1.1.cmml">r</mi><mo id="S3.SS2.p3.10.m10.2.2.2.4.1" xref="S3.SS2.p3.10.m10.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.10.m10.2.2.2.2" xref="S3.SS2.p3.10.m10.2.2.2.2.cmml">c</mi></mrow></msubsup><mo id="S3.SS2.p3.10.m10.2.3.1" xref="S3.SS2.p3.10.m10.2.3.1.cmml">=</mo><mn id="S3.SS2.p3.10.m10.2.3.3" xref="S3.SS2.p3.10.m10.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.2b"><apply id="S3.SS2.p3.10.m10.2.3.cmml" xref="S3.SS2.p3.10.m10.2.3"><eq id="S3.SS2.p3.10.m10.2.3.1.cmml" xref="S3.SS2.p3.10.m10.2.3.1"></eq><apply id="S3.SS2.p3.10.m10.2.3.2.cmml" xref="S3.SS2.p3.10.m10.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.2.3.2.1.cmml" xref="S3.SS2.p3.10.m10.2.3.2">superscript</csymbol><apply id="S3.SS2.p3.10.m10.2.3.2.2.cmml" xref="S3.SS2.p3.10.m10.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.2.3.2.2.1.cmml" xref="S3.SS2.p3.10.m10.2.3.2">subscript</csymbol><ci id="S3.SS2.p3.10.m10.2.3.2.2.2.cmml" xref="S3.SS2.p3.10.m10.2.3.2.2.2">𝑙</ci><apply id="S3.SS2.p3.10.m10.2.3.2.2.3.cmml" xref="S3.SS2.p3.10.m10.2.3.2.2.3"><minus id="S3.SS2.p3.10.m10.2.3.2.2.3.1.cmml" xref="S3.SS2.p3.10.m10.2.3.2.2.3.1"></minus><ci id="S3.SS2.p3.10.m10.2.3.2.2.3.2.cmml" xref="S3.SS2.p3.10.m10.2.3.2.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p3.10.m10.2.3.2.2.3.3.cmml" xref="S3.SS2.p3.10.m10.2.3.2.2.3.3">1</cn></apply></apply><list id="S3.SS2.p3.10.m10.2.2.2.3.cmml" xref="S3.SS2.p3.10.m10.2.2.2.4"><ci id="S3.SS2.p3.10.m10.1.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1.1.1">𝑟</ci><ci id="S3.SS2.p3.10.m10.2.2.2.2.cmml" xref="S3.SS2.p3.10.m10.2.2.2.2">𝑐</ci></list></apply><cn type="integer" id="S3.SS2.p3.10.m10.2.3.3.cmml" xref="S3.SS2.p3.10.m10.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.2c">{l}_{k-1}^{r,c}=1</annotation></semantics></math> if <math id="S3.SS2.p3.11.m11.2" class="ltx_Math" alttext="\mathrm{IoU}(r_{i},r_{*}^{c})\geq 0.5" display="inline"><semantics id="S3.SS2.p3.11.m11.2a"><mrow id="S3.SS2.p3.11.m11.2.2" xref="S3.SS2.p3.11.m11.2.2.cmml"><mrow id="S3.SS2.p3.11.m11.2.2.2" xref="S3.SS2.p3.11.m11.2.2.2.cmml"><mi id="S3.SS2.p3.11.m11.2.2.2.4" xref="S3.SS2.p3.11.m11.2.2.2.4.cmml">IoU</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.11.m11.2.2.2.3" xref="S3.SS2.p3.11.m11.2.2.2.3.cmml">​</mo><mrow id="S3.SS2.p3.11.m11.2.2.2.2.2" xref="S3.SS2.p3.11.m11.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p3.11.m11.2.2.2.2.2.3" xref="S3.SS2.p3.11.m11.2.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p3.11.m11.1.1.1.1.1.1" xref="S3.SS2.p3.11.m11.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.11.m11.1.1.1.1.1.1.2" xref="S3.SS2.p3.11.m11.1.1.1.1.1.1.2.cmml">r</mi><mi id="S3.SS2.p3.11.m11.1.1.1.1.1.1.3" xref="S3.SS2.p3.11.m11.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.11.m11.2.2.2.2.2.4" xref="S3.SS2.p3.11.m11.2.2.2.2.3.cmml">,</mo><msubsup id="S3.SS2.p3.11.m11.2.2.2.2.2.2" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.11.m11.2.2.2.2.2.2.2.2" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2.2.2.cmml">r</mi><mo id="S3.SS2.p3.11.m11.2.2.2.2.2.2.2.3" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2.2.3.cmml">∗</mo><mi id="S3.SS2.p3.11.m11.2.2.2.2.2.2.3" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2.3.cmml">c</mi></msubsup><mo stretchy="false" id="S3.SS2.p3.11.m11.2.2.2.2.2.5" xref="S3.SS2.p3.11.m11.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.11.m11.2.2.3" xref="S3.SS2.p3.11.m11.2.2.3.cmml">≥</mo><mn id="S3.SS2.p3.11.m11.2.2.4" xref="S3.SS2.p3.11.m11.2.2.4.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m11.2b"><apply id="S3.SS2.p3.11.m11.2.2.cmml" xref="S3.SS2.p3.11.m11.2.2"><geq id="S3.SS2.p3.11.m11.2.2.3.cmml" xref="S3.SS2.p3.11.m11.2.2.3"></geq><apply id="S3.SS2.p3.11.m11.2.2.2.cmml" xref="S3.SS2.p3.11.m11.2.2.2"><times id="S3.SS2.p3.11.m11.2.2.2.3.cmml" xref="S3.SS2.p3.11.m11.2.2.2.3"></times><ci id="S3.SS2.p3.11.m11.2.2.2.4.cmml" xref="S3.SS2.p3.11.m11.2.2.2.4">IoU</ci><interval closure="open" id="S3.SS2.p3.11.m11.2.2.2.2.3.cmml" xref="S3.SS2.p3.11.m11.2.2.2.2.2"><apply id="S3.SS2.p3.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m11.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.11.m11.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.11.m11.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.SS2.p3.11.m11.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.11.m11.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p3.11.m11.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m11.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p3.11.m11.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m11.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.11.m11.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2.2.2">𝑟</ci><times id="S3.SS2.p3.11.m11.2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2.2.3"></times></apply><ci id="S3.SS2.p3.11.m11.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.11.m11.2.2.2.2.2.2.3">𝑐</ci></apply></interval></apply><cn type="float" id="S3.SS2.p3.11.m11.2.2.4.cmml" xref="S3.SS2.p3.11.m11.2.2.4">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m11.2c">\mathrm{IoU}(r_{i},r_{*}^{c})\geq 0.5</annotation></semantics></math>. (iii) If a region <math id="S3.SS2.p3.12.m12.1" class="ltx_Math" alttext="r_{i}\in\mathbf{r}" display="inline"><semantics id="S3.SS2.p3.12.m12.1a"><mrow id="S3.SS2.p3.12.m12.1.1" xref="S3.SS2.p3.12.m12.1.1.cmml"><msub id="S3.SS2.p3.12.m12.1.1.2" xref="S3.SS2.p3.12.m12.1.1.2.cmml"><mi id="S3.SS2.p3.12.m12.1.1.2.2" xref="S3.SS2.p3.12.m12.1.1.2.2.cmml">r</mi><mi id="S3.SS2.p3.12.m12.1.1.2.3" xref="S3.SS2.p3.12.m12.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p3.12.m12.1.1.1" xref="S3.SS2.p3.12.m12.1.1.1.cmml">∈</mo><mi id="S3.SS2.p3.12.m12.1.1.3" xref="S3.SS2.p3.12.m12.1.1.3.cmml">𝐫</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m12.1b"><apply id="S3.SS2.p3.12.m12.1.1.cmml" xref="S3.SS2.p3.12.m12.1.1"><in id="S3.SS2.p3.12.m12.1.1.1.cmml" xref="S3.SS2.p3.12.m12.1.1.1"></in><apply id="S3.SS2.p3.12.m12.1.1.2.cmml" xref="S3.SS2.p3.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.12.m12.1.1.2.1.cmml" xref="S3.SS2.p3.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.12.m12.1.1.2.2.cmml" xref="S3.SS2.p3.12.m12.1.1.2.2">𝑟</ci><ci id="S3.SS2.p3.12.m12.1.1.2.3.cmml" xref="S3.SS2.p3.12.m12.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p3.12.m12.1.1.3.cmml" xref="S3.SS2.p3.12.m12.1.1.3">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m12.1c">r_{i}\in\mathbf{r}</annotation></semantics></math> has low overlap with any top scoring patch <math id="S3.SS2.p3.13.m13.1" class="ltx_Math" alttext="r_{*}^{c}" display="inline"><semantics id="S3.SS2.p3.13.m13.1a"><msubsup id="S3.SS2.p3.13.m13.1.1" xref="S3.SS2.p3.13.m13.1.1.cmml"><mi id="S3.SS2.p3.13.m13.1.1.2.2" xref="S3.SS2.p3.13.m13.1.1.2.2.cmml">r</mi><mo id="S3.SS2.p3.13.m13.1.1.2.3" xref="S3.SS2.p3.13.m13.1.1.2.3.cmml">∗</mo><mi id="S3.SS2.p3.13.m13.1.1.3" xref="S3.SS2.p3.13.m13.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.13.m13.1b"><apply id="S3.SS2.p3.13.m13.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.1.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1">superscript</csymbol><apply id="S3.SS2.p3.13.m13.1.1.2.cmml" xref="S3.SS2.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.1.1.2.1.cmml" xref="S3.SS2.p3.13.m13.1.1">subscript</csymbol><ci id="S3.SS2.p3.13.m13.1.1.2.2.cmml" xref="S3.SS2.p3.13.m13.1.1.2.2">𝑟</ci><times id="S3.SS2.p3.13.m13.1.1.2.3.cmml" xref="S3.SS2.p3.13.m13.1.1.2.3"></times></apply><ci id="S3.SS2.p3.13.m13.1.1.3.cmml" xref="S3.SS2.p3.13.m13.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.13.m13.1c">r_{*}^{c}</annotation></semantics></math>, we assign it to background class <math id="S3.SS2.p3.14.m14.2" class="ltx_Math" alttext="l_{k-1}^{r,0}=1" display="inline"><semantics id="S3.SS2.p3.14.m14.2a"><mrow id="S3.SS2.p3.14.m14.2.3" xref="S3.SS2.p3.14.m14.2.3.cmml"><msubsup id="S3.SS2.p3.14.m14.2.3.2" xref="S3.SS2.p3.14.m14.2.3.2.cmml"><mi id="S3.SS2.p3.14.m14.2.3.2.2.2" xref="S3.SS2.p3.14.m14.2.3.2.2.2.cmml">l</mi><mrow id="S3.SS2.p3.14.m14.2.3.2.2.3" xref="S3.SS2.p3.14.m14.2.3.2.2.3.cmml"><mi id="S3.SS2.p3.14.m14.2.3.2.2.3.2" xref="S3.SS2.p3.14.m14.2.3.2.2.3.2.cmml">k</mi><mo id="S3.SS2.p3.14.m14.2.3.2.2.3.1" xref="S3.SS2.p3.14.m14.2.3.2.2.3.1.cmml">−</mo><mn id="S3.SS2.p3.14.m14.2.3.2.2.3.3" xref="S3.SS2.p3.14.m14.2.3.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS2.p3.14.m14.2.2.2.4" xref="S3.SS2.p3.14.m14.2.2.2.3.cmml"><mi id="S3.SS2.p3.14.m14.1.1.1.1" xref="S3.SS2.p3.14.m14.1.1.1.1.cmml">r</mi><mo id="S3.SS2.p3.14.m14.2.2.2.4.1" xref="S3.SS2.p3.14.m14.2.2.2.3.cmml">,</mo><mn id="S3.SS2.p3.14.m14.2.2.2.2" xref="S3.SS2.p3.14.m14.2.2.2.2.cmml">0</mn></mrow></msubsup><mo id="S3.SS2.p3.14.m14.2.3.1" xref="S3.SS2.p3.14.m14.2.3.1.cmml">=</mo><mn id="S3.SS2.p3.14.m14.2.3.3" xref="S3.SS2.p3.14.m14.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.14.m14.2b"><apply id="S3.SS2.p3.14.m14.2.3.cmml" xref="S3.SS2.p3.14.m14.2.3"><eq id="S3.SS2.p3.14.m14.2.3.1.cmml" xref="S3.SS2.p3.14.m14.2.3.1"></eq><apply id="S3.SS2.p3.14.m14.2.3.2.cmml" xref="S3.SS2.p3.14.m14.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.14.m14.2.3.2.1.cmml" xref="S3.SS2.p3.14.m14.2.3.2">superscript</csymbol><apply id="S3.SS2.p3.14.m14.2.3.2.2.cmml" xref="S3.SS2.p3.14.m14.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.14.m14.2.3.2.2.1.cmml" xref="S3.SS2.p3.14.m14.2.3.2">subscript</csymbol><ci id="S3.SS2.p3.14.m14.2.3.2.2.2.cmml" xref="S3.SS2.p3.14.m14.2.3.2.2.2">𝑙</ci><apply id="S3.SS2.p3.14.m14.2.3.2.2.3.cmml" xref="S3.SS2.p3.14.m14.2.3.2.2.3"><minus id="S3.SS2.p3.14.m14.2.3.2.2.3.1.cmml" xref="S3.SS2.p3.14.m14.2.3.2.2.3.1"></minus><ci id="S3.SS2.p3.14.m14.2.3.2.2.3.2.cmml" xref="S3.SS2.p3.14.m14.2.3.2.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p3.14.m14.2.3.2.2.3.3.cmml" xref="S3.SS2.p3.14.m14.2.3.2.2.3.3">1</cn></apply></apply><list id="S3.SS2.p3.14.m14.2.2.2.3.cmml" xref="S3.SS2.p3.14.m14.2.2.2.4"><ci id="S3.SS2.p3.14.m14.1.1.1.1.cmml" xref="S3.SS2.p3.14.m14.1.1.1.1">𝑟</ci><cn type="integer" id="S3.SS2.p3.14.m14.2.2.2.2.cmml" xref="S3.SS2.p3.14.m14.2.2.2.2">0</cn></list></apply><cn type="integer" id="S3.SS2.p3.14.m14.2.3.3.cmml" xref="S3.SS2.p3.14.m14.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.14.m14.2c">l_{k-1}^{r,0}=1</annotation></semantics></math>. (iv) If a class <math id="S3.SS2.p3.15.m15.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p3.15.m15.1a"><mi id="S3.SS2.p3.15.m15.1.1" xref="S3.SS2.p3.15.m15.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.15.m15.1b"><ci id="S3.SS2.p3.15.m15.1.1.cmml" xref="S3.SS2.p3.15.m15.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.15.m15.1c">c</annotation></semantics></math> is not in image <math id="S3.SS2.p3.16.m16.1" class="ltx_Math" alttext="\mathbf{p}" display="inline"><semantics id="S3.SS2.p3.16.m16.1a"><mi id="S3.SS2.p3.16.m16.1.1" xref="S3.SS2.p3.16.m16.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.16.m16.1b"><ci id="S3.SS2.p3.16.m16.1.1.cmml" xref="S3.SS2.p3.16.m16.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.16.m16.1c">\mathbf{p}</annotation></semantics></math> we assign <math id="S3.SS2.p3.17.m17.2" class="ltx_Math" alttext="l_{k-1}^{r,c}=0" display="inline"><semantics id="S3.SS2.p3.17.m17.2a"><mrow id="S3.SS2.p3.17.m17.2.3" xref="S3.SS2.p3.17.m17.2.3.cmml"><msubsup id="S3.SS2.p3.17.m17.2.3.2" xref="S3.SS2.p3.17.m17.2.3.2.cmml"><mi id="S3.SS2.p3.17.m17.2.3.2.2.2" xref="S3.SS2.p3.17.m17.2.3.2.2.2.cmml">l</mi><mrow id="S3.SS2.p3.17.m17.2.3.2.2.3" xref="S3.SS2.p3.17.m17.2.3.2.2.3.cmml"><mi id="S3.SS2.p3.17.m17.2.3.2.2.3.2" xref="S3.SS2.p3.17.m17.2.3.2.2.3.2.cmml">k</mi><mo id="S3.SS2.p3.17.m17.2.3.2.2.3.1" xref="S3.SS2.p3.17.m17.2.3.2.2.3.1.cmml">−</mo><mn id="S3.SS2.p3.17.m17.2.3.2.2.3.3" xref="S3.SS2.p3.17.m17.2.3.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS2.p3.17.m17.2.2.2.4" xref="S3.SS2.p3.17.m17.2.2.2.3.cmml"><mi id="S3.SS2.p3.17.m17.1.1.1.1" xref="S3.SS2.p3.17.m17.1.1.1.1.cmml">r</mi><mo id="S3.SS2.p3.17.m17.2.2.2.4.1" xref="S3.SS2.p3.17.m17.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.17.m17.2.2.2.2" xref="S3.SS2.p3.17.m17.2.2.2.2.cmml">c</mi></mrow></msubsup><mo id="S3.SS2.p3.17.m17.2.3.1" xref="S3.SS2.p3.17.m17.2.3.1.cmml">=</mo><mn id="S3.SS2.p3.17.m17.2.3.3" xref="S3.SS2.p3.17.m17.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.17.m17.2b"><apply id="S3.SS2.p3.17.m17.2.3.cmml" xref="S3.SS2.p3.17.m17.2.3"><eq id="S3.SS2.p3.17.m17.2.3.1.cmml" xref="S3.SS2.p3.17.m17.2.3.1"></eq><apply id="S3.SS2.p3.17.m17.2.3.2.cmml" xref="S3.SS2.p3.17.m17.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.17.m17.2.3.2.1.cmml" xref="S3.SS2.p3.17.m17.2.3.2">superscript</csymbol><apply id="S3.SS2.p3.17.m17.2.3.2.2.cmml" xref="S3.SS2.p3.17.m17.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.17.m17.2.3.2.2.1.cmml" xref="S3.SS2.p3.17.m17.2.3.2">subscript</csymbol><ci id="S3.SS2.p3.17.m17.2.3.2.2.2.cmml" xref="S3.SS2.p3.17.m17.2.3.2.2.2">𝑙</ci><apply id="S3.SS2.p3.17.m17.2.3.2.2.3.cmml" xref="S3.SS2.p3.17.m17.2.3.2.2.3"><minus id="S3.SS2.p3.17.m17.2.3.2.2.3.1.cmml" xref="S3.SS2.p3.17.m17.2.3.2.2.3.1"></minus><ci id="S3.SS2.p3.17.m17.2.3.2.2.3.2.cmml" xref="S3.SS2.p3.17.m17.2.3.2.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p3.17.m17.2.3.2.2.3.3.cmml" xref="S3.SS2.p3.17.m17.2.3.2.2.3.3">1</cn></apply></apply><list id="S3.SS2.p3.17.m17.2.2.2.3.cmml" xref="S3.SS2.p3.17.m17.2.2.2.4"><ci id="S3.SS2.p3.17.m17.1.1.1.1.cmml" xref="S3.SS2.p3.17.m17.1.1.1.1">𝑟</ci><ci id="S3.SS2.p3.17.m17.2.2.2.2.cmml" xref="S3.SS2.p3.17.m17.2.2.2.2">𝑐</ci></list></apply><cn type="integer" id="S3.SS2.p3.17.m17.2.3.3.cmml" xref="S3.SS2.p3.17.m17.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.17.m17.2c">l_{k-1}^{r,c}=0</annotation></semantics></math>. The refinement loss is</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.7" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{ref}}^{k}=\frac{1}{R}\sum_{i=1}^{R}\sum_{c=1}^{|\mathcal{C}|}\omega_{k-1}^{(i,j)}\ l_{k-1}^{(i,j)}\ \log\omega_{k}^{(i,j)}" display="block"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.8" xref="S3.E6.m1.7.8.cmml"><msubsup id="S3.E6.m1.7.8.2" xref="S3.E6.m1.7.8.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.7.8.2.2.2" xref="S3.E6.m1.7.8.2.2.2.cmml">ℒ</mi><mi id="S3.E6.m1.7.8.2.2.3" xref="S3.E6.m1.7.8.2.2.3.cmml">ref</mi><mi id="S3.E6.m1.7.8.2.3" xref="S3.E6.m1.7.8.2.3.cmml">k</mi></msubsup><mo id="S3.E6.m1.7.8.1" xref="S3.E6.m1.7.8.1.cmml">=</mo><mrow id="S3.E6.m1.7.8.3" xref="S3.E6.m1.7.8.3.cmml"><mfrac id="S3.E6.m1.7.8.3.2" xref="S3.E6.m1.7.8.3.2.cmml"><mn id="S3.E6.m1.7.8.3.2.2" xref="S3.E6.m1.7.8.3.2.2.cmml">1</mn><mi id="S3.E6.m1.7.8.3.2.3" xref="S3.E6.m1.7.8.3.2.3.cmml">R</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.8.3.1" xref="S3.E6.m1.7.8.3.1.cmml">​</mo><mrow id="S3.E6.m1.7.8.3.3" xref="S3.E6.m1.7.8.3.3.cmml"><munderover id="S3.E6.m1.7.8.3.3.1" xref="S3.E6.m1.7.8.3.3.1.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.7.8.3.3.1.2.2" xref="S3.E6.m1.7.8.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.7.8.3.3.1.2.3" xref="S3.E6.m1.7.8.3.3.1.2.3.cmml"><mi id="S3.E6.m1.7.8.3.3.1.2.3.2" xref="S3.E6.m1.7.8.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E6.m1.7.8.3.3.1.2.3.1" xref="S3.E6.m1.7.8.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E6.m1.7.8.3.3.1.2.3.3" xref="S3.E6.m1.7.8.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.7.8.3.3.1.3" xref="S3.E6.m1.7.8.3.3.1.3.cmml">R</mi></munderover><mrow id="S3.E6.m1.7.8.3.3.2" xref="S3.E6.m1.7.8.3.3.2.cmml"><munderover id="S3.E6.m1.7.8.3.3.2.1" xref="S3.E6.m1.7.8.3.3.2.1.cmml"><mo movablelimits="false" id="S3.E6.m1.7.8.3.3.2.1.2.2" xref="S3.E6.m1.7.8.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.7.8.3.3.2.1.2.3" xref="S3.E6.m1.7.8.3.3.2.1.2.3.cmml"><mi id="S3.E6.m1.7.8.3.3.2.1.2.3.2" xref="S3.E6.m1.7.8.3.3.2.1.2.3.2.cmml">c</mi><mo id="S3.E6.m1.7.8.3.3.2.1.2.3.1" xref="S3.E6.m1.7.8.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E6.m1.7.8.3.3.2.1.2.3.3" xref="S3.E6.m1.7.8.3.3.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.E6.m1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E6.m1.7.8.3.3.2.2" xref="S3.E6.m1.7.8.3.3.2.2.cmml"><msubsup id="S3.E6.m1.7.8.3.3.2.2.2" xref="S3.E6.m1.7.8.3.3.2.2.2.cmml"><mi id="S3.E6.m1.7.8.3.3.2.2.2.2.2" xref="S3.E6.m1.7.8.3.3.2.2.2.2.2.cmml">ω</mi><mrow id="S3.E6.m1.7.8.3.3.2.2.2.2.3" xref="S3.E6.m1.7.8.3.3.2.2.2.2.3.cmml"><mi id="S3.E6.m1.7.8.3.3.2.2.2.2.3.2" xref="S3.E6.m1.7.8.3.3.2.2.2.2.3.2.cmml">k</mi><mo id="S3.E6.m1.7.8.3.3.2.2.2.2.3.1" xref="S3.E6.m1.7.8.3.3.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E6.m1.7.8.3.3.2.2.2.2.3.3" xref="S3.E6.m1.7.8.3.3.2.2.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E6.m1.3.3.2.4" xref="S3.E6.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.2.4.1" xref="S3.E6.m1.3.3.2.3.cmml">(</mo><mi id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml">i</mi><mo id="S3.E6.m1.3.3.2.4.2" xref="S3.E6.m1.3.3.2.3.cmml">,</mo><mi id="S3.E6.m1.3.3.2.2" xref="S3.E6.m1.3.3.2.2.cmml">j</mi><mo stretchy="false" id="S3.E6.m1.3.3.2.4.3" xref="S3.E6.m1.3.3.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.8.3.3.2.2.1" xref="S3.E6.m1.7.8.3.3.2.2.1.cmml">​</mo><msubsup id="S3.E6.m1.7.8.3.3.2.2.3" xref="S3.E6.m1.7.8.3.3.2.2.3.cmml"><mi id="S3.E6.m1.7.8.3.3.2.2.3.2.2" xref="S3.E6.m1.7.8.3.3.2.2.3.2.2.cmml">l</mi><mrow id="S3.E6.m1.7.8.3.3.2.2.3.2.3" xref="S3.E6.m1.7.8.3.3.2.2.3.2.3.cmml"><mi id="S3.E6.m1.7.8.3.3.2.2.3.2.3.2" xref="S3.E6.m1.7.8.3.3.2.2.3.2.3.2.cmml">k</mi><mo id="S3.E6.m1.7.8.3.3.2.2.3.2.3.1" xref="S3.E6.m1.7.8.3.3.2.2.3.2.3.1.cmml">−</mo><mn id="S3.E6.m1.7.8.3.3.2.2.3.2.3.3" xref="S3.E6.m1.7.8.3.3.2.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S3.E6.m1.5.5.2.4" xref="S3.E6.m1.5.5.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.2.4.1" xref="S3.E6.m1.5.5.2.3.cmml">(</mo><mi id="S3.E6.m1.4.4.1.1" xref="S3.E6.m1.4.4.1.1.cmml">i</mi><mo id="S3.E6.m1.5.5.2.4.2" xref="S3.E6.m1.5.5.2.3.cmml">,</mo><mi id="S3.E6.m1.5.5.2.2" xref="S3.E6.m1.5.5.2.2.cmml">j</mi><mo stretchy="false" id="S3.E6.m1.5.5.2.4.3" xref="S3.E6.m1.5.5.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0.167em" rspace="0em" id="S3.E6.m1.7.8.3.3.2.2.1a" xref="S3.E6.m1.7.8.3.3.2.2.1.cmml">​</mo><mrow id="S3.E6.m1.7.8.3.3.2.2.4" xref="S3.E6.m1.7.8.3.3.2.2.4.cmml"><mi id="S3.E6.m1.7.8.3.3.2.2.4.1" xref="S3.E6.m1.7.8.3.3.2.2.4.1.cmml">log</mi><mo lspace="0.167em" id="S3.E6.m1.7.8.3.3.2.2.4a" xref="S3.E6.m1.7.8.3.3.2.2.4.cmml">⁡</mo><msubsup id="S3.E6.m1.7.8.3.3.2.2.4.2" xref="S3.E6.m1.7.8.3.3.2.2.4.2.cmml"><mi id="S3.E6.m1.7.8.3.3.2.2.4.2.2.2" xref="S3.E6.m1.7.8.3.3.2.2.4.2.2.2.cmml">ω</mi><mi id="S3.E6.m1.7.8.3.3.2.2.4.2.2.3" xref="S3.E6.m1.7.8.3.3.2.2.4.2.2.3.cmml">k</mi><mrow id="S3.E6.m1.7.7.2.4" xref="S3.E6.m1.7.7.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.7.7.2.4.1" xref="S3.E6.m1.7.7.2.3.cmml">(</mo><mi id="S3.E6.m1.6.6.1.1" xref="S3.E6.m1.6.6.1.1.cmml">i</mi><mo id="S3.E6.m1.7.7.2.4.2" xref="S3.E6.m1.7.7.2.3.cmml">,</mo><mi id="S3.E6.m1.7.7.2.2" xref="S3.E6.m1.7.7.2.2.cmml">j</mi><mo stretchy="false" id="S3.E6.m1.7.7.2.4.3" xref="S3.E6.m1.7.7.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.8.cmml" xref="S3.E6.m1.7.8"><eq id="S3.E6.m1.7.8.1.cmml" xref="S3.E6.m1.7.8.1"></eq><apply id="S3.E6.m1.7.8.2.cmml" xref="S3.E6.m1.7.8.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.2.1.cmml" xref="S3.E6.m1.7.8.2">superscript</csymbol><apply id="S3.E6.m1.7.8.2.2.cmml" xref="S3.E6.m1.7.8.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.2.2.1.cmml" xref="S3.E6.m1.7.8.2">subscript</csymbol><ci id="S3.E6.m1.7.8.2.2.2.cmml" xref="S3.E6.m1.7.8.2.2.2">ℒ</ci><ci id="S3.E6.m1.7.8.2.2.3.cmml" xref="S3.E6.m1.7.8.2.2.3">ref</ci></apply><ci id="S3.E6.m1.7.8.2.3.cmml" xref="S3.E6.m1.7.8.2.3">𝑘</ci></apply><apply id="S3.E6.m1.7.8.3.cmml" xref="S3.E6.m1.7.8.3"><times id="S3.E6.m1.7.8.3.1.cmml" xref="S3.E6.m1.7.8.3.1"></times><apply id="S3.E6.m1.7.8.3.2.cmml" xref="S3.E6.m1.7.8.3.2"><divide id="S3.E6.m1.7.8.3.2.1.cmml" xref="S3.E6.m1.7.8.3.2"></divide><cn type="integer" id="S3.E6.m1.7.8.3.2.2.cmml" xref="S3.E6.m1.7.8.3.2.2">1</cn><ci id="S3.E6.m1.7.8.3.2.3.cmml" xref="S3.E6.m1.7.8.3.2.3">𝑅</ci></apply><apply id="S3.E6.m1.7.8.3.3.cmml" xref="S3.E6.m1.7.8.3.3"><apply id="S3.E6.m1.7.8.3.3.1.cmml" xref="S3.E6.m1.7.8.3.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.3.3.1.1.cmml" xref="S3.E6.m1.7.8.3.3.1">superscript</csymbol><apply id="S3.E6.m1.7.8.3.3.1.2.cmml" xref="S3.E6.m1.7.8.3.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.3.3.1.2.1.cmml" xref="S3.E6.m1.7.8.3.3.1">subscript</csymbol><sum id="S3.E6.m1.7.8.3.3.1.2.2.cmml" xref="S3.E6.m1.7.8.3.3.1.2.2"></sum><apply id="S3.E6.m1.7.8.3.3.1.2.3.cmml" xref="S3.E6.m1.7.8.3.3.1.2.3"><eq id="S3.E6.m1.7.8.3.3.1.2.3.1.cmml" xref="S3.E6.m1.7.8.3.3.1.2.3.1"></eq><ci id="S3.E6.m1.7.8.3.3.1.2.3.2.cmml" xref="S3.E6.m1.7.8.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.7.8.3.3.1.2.3.3.cmml" xref="S3.E6.m1.7.8.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.7.8.3.3.1.3.cmml" xref="S3.E6.m1.7.8.3.3.1.3">𝑅</ci></apply><apply id="S3.E6.m1.7.8.3.3.2.cmml" xref="S3.E6.m1.7.8.3.3.2"><apply id="S3.E6.m1.7.8.3.3.2.1.cmml" xref="S3.E6.m1.7.8.3.3.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.3.3.2.1.1.cmml" xref="S3.E6.m1.7.8.3.3.2.1">superscript</csymbol><apply id="S3.E6.m1.7.8.3.3.2.1.2.cmml" xref="S3.E6.m1.7.8.3.3.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.3.3.2.1.2.1.cmml" xref="S3.E6.m1.7.8.3.3.2.1">subscript</csymbol><sum id="S3.E6.m1.7.8.3.3.2.1.2.2.cmml" xref="S3.E6.m1.7.8.3.3.2.1.2.2"></sum><apply id="S3.E6.m1.7.8.3.3.2.1.2.3.cmml" xref="S3.E6.m1.7.8.3.3.2.1.2.3"><eq id="S3.E6.m1.7.8.3.3.2.1.2.3.1.cmml" xref="S3.E6.m1.7.8.3.3.2.1.2.3.1"></eq><ci id="S3.E6.m1.7.8.3.3.2.1.2.3.2.cmml" xref="S3.E6.m1.7.8.3.3.2.1.2.3.2">𝑐</ci><cn type="integer" id="S3.E6.m1.7.8.3.3.2.1.2.3.3.cmml" xref="S3.E6.m1.7.8.3.3.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.3"><abs id="S3.E6.m1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.3.1"></abs><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝒞</ci></apply></apply><apply id="S3.E6.m1.7.8.3.3.2.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2"><times id="S3.E6.m1.7.8.3.3.2.2.1.cmml" xref="S3.E6.m1.7.8.3.3.2.2.1"></times><apply id="S3.E6.m1.7.8.3.3.2.2.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.3.3.2.2.2.1.cmml" xref="S3.E6.m1.7.8.3.3.2.2.2">superscript</csymbol><apply id="S3.E6.m1.7.8.3.3.2.2.2.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.3.3.2.2.2.2.1.cmml" xref="S3.E6.m1.7.8.3.3.2.2.2">subscript</csymbol><ci id="S3.E6.m1.7.8.3.3.2.2.2.2.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2.2.2.2">𝜔</ci><apply id="S3.E6.m1.7.8.3.3.2.2.2.2.3.cmml" xref="S3.E6.m1.7.8.3.3.2.2.2.2.3"><minus id="S3.E6.m1.7.8.3.3.2.2.2.2.3.1.cmml" xref="S3.E6.m1.7.8.3.3.2.2.2.2.3.1"></minus><ci id="S3.E6.m1.7.8.3.3.2.2.2.2.3.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E6.m1.7.8.3.3.2.2.2.2.3.3.cmml" xref="S3.E6.m1.7.8.3.3.2.2.2.2.3.3">1</cn></apply></apply><interval closure="open" id="S3.E6.m1.3.3.2.3.cmml" xref="S3.E6.m1.3.3.2.4"><ci id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1.1">𝑖</ci><ci id="S3.E6.m1.3.3.2.2.cmml" xref="S3.E6.m1.3.3.2.2">𝑗</ci></interval></apply><apply id="S3.E6.m1.7.8.3.3.2.2.3.cmml" xref="S3.E6.m1.7.8.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.3.3.2.2.3.1.cmml" xref="S3.E6.m1.7.8.3.3.2.2.3">superscript</csymbol><apply id="S3.E6.m1.7.8.3.3.2.2.3.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.3.3.2.2.3.2.1.cmml" xref="S3.E6.m1.7.8.3.3.2.2.3">subscript</csymbol><ci id="S3.E6.m1.7.8.3.3.2.2.3.2.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2.3.2.2">𝑙</ci><apply id="S3.E6.m1.7.8.3.3.2.2.3.2.3.cmml" xref="S3.E6.m1.7.8.3.3.2.2.3.2.3"><minus id="S3.E6.m1.7.8.3.3.2.2.3.2.3.1.cmml" xref="S3.E6.m1.7.8.3.3.2.2.3.2.3.1"></minus><ci id="S3.E6.m1.7.8.3.3.2.2.3.2.3.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2.3.2.3.2">𝑘</ci><cn type="integer" id="S3.E6.m1.7.8.3.3.2.2.3.2.3.3.cmml" xref="S3.E6.m1.7.8.3.3.2.2.3.2.3.3">1</cn></apply></apply><interval closure="open" id="S3.E6.m1.5.5.2.3.cmml" xref="S3.E6.m1.5.5.2.4"><ci id="S3.E6.m1.4.4.1.1.cmml" xref="S3.E6.m1.4.4.1.1">𝑖</ci><ci id="S3.E6.m1.5.5.2.2.cmml" xref="S3.E6.m1.5.5.2.2">𝑗</ci></interval></apply><apply id="S3.E6.m1.7.8.3.3.2.2.4.cmml" xref="S3.E6.m1.7.8.3.3.2.2.4"><log id="S3.E6.m1.7.8.3.3.2.2.4.1.cmml" xref="S3.E6.m1.7.8.3.3.2.2.4.1"></log><apply id="S3.E6.m1.7.8.3.3.2.2.4.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.3.3.2.2.4.2.1.cmml" xref="S3.E6.m1.7.8.3.3.2.2.4.2">superscript</csymbol><apply id="S3.E6.m1.7.8.3.3.2.2.4.2.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.8.3.3.2.2.4.2.2.1.cmml" xref="S3.E6.m1.7.8.3.3.2.2.4.2">subscript</csymbol><ci id="S3.E6.m1.7.8.3.3.2.2.4.2.2.2.cmml" xref="S3.E6.m1.7.8.3.3.2.2.4.2.2.2">𝜔</ci><ci id="S3.E6.m1.7.8.3.3.2.2.4.2.2.3.cmml" xref="S3.E6.m1.7.8.3.3.2.2.4.2.2.3">𝑘</ci></apply><interval closure="open" id="S3.E6.m1.7.7.2.3.cmml" xref="S3.E6.m1.7.7.2.4"><ci id="S3.E6.m1.6.6.1.1.cmml" xref="S3.E6.m1.6.6.1.1">𝑖</ci><ci id="S3.E6.m1.7.7.2.2.cmml" xref="S3.E6.m1.7.7.2.2">𝑗</ci></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">\mathcal{L}_{\mathrm{ref}}^{k}=\frac{1}{R}\sum_{i=1}^{R}\sum_{c=1}^{|\mathcal{C}|}\omega_{k-1}^{(i,j)}\ l_{k-1}^{(i,j)}\ \log\omega_{k}^{(i,j)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">Both SOD and WSOD restrict detection to pre-defined <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\mathcal{C}</annotation></semantics></math> classes. In the next section, we overcome this fixed-set limitation using prototype learning with SBIR.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Localising Object Regions with Query Sketch</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.11" class="ltx_p">We replace the fixed-set classifier in WSOD with scalable open-set prototype learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>.
Each head <math id="S3.SS3.p1.1.m1.3" class="ltx_Math" alttext="\{\phi_{\mathrm{cls}},\phi_{\mathrm{det}},\phi_{\mathrm{cls}}^{*}\}" display="inline"><semantics id="S3.SS3.p1.1.m1.3a"><mrow id="S3.SS3.p1.1.m1.3.3.3" xref="S3.SS3.p1.1.m1.3.3.4.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.3.3.3.4" xref="S3.SS3.p1.1.m1.3.3.4.cmml">{</mo><msub id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.SS3.p1.1.m1.1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.1.1.3.cmml">cls</mi></msub><mo id="S3.SS3.p1.1.m1.3.3.3.5" xref="S3.SS3.p1.1.m1.3.3.4.cmml">,</mo><msub id="S3.SS3.p1.1.m1.2.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.2.cmml"><mi id="S3.SS3.p1.1.m1.2.2.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.2.2.cmml">ϕ</mi><mi id="S3.SS3.p1.1.m1.2.2.2.2.3" xref="S3.SS3.p1.1.m1.2.2.2.2.3.cmml">det</mi></msub><mo id="S3.SS3.p1.1.m1.3.3.3.6" xref="S3.SS3.p1.1.m1.3.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.1.m1.3.3.3.3" xref="S3.SS3.p1.1.m1.3.3.3.3.cmml"><mi id="S3.SS3.p1.1.m1.3.3.3.3.2.2" xref="S3.SS3.p1.1.m1.3.3.3.3.2.2.cmml">ϕ</mi><mi id="S3.SS3.p1.1.m1.3.3.3.3.2.3" xref="S3.SS3.p1.1.m1.3.3.3.3.2.3.cmml">cls</mi><mo id="S3.SS3.p1.1.m1.3.3.3.3.3" xref="S3.SS3.p1.1.m1.3.3.3.3.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S3.SS3.p1.1.m1.3.3.3.7" xref="S3.SS3.p1.1.m1.3.3.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.3b"><set id="S3.SS3.p1.1.m1.3.3.4.cmml" xref="S3.SS3.p1.1.m1.3.3.3"><apply id="S3.SS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.2">italic-ϕ</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.3">cls</ci></apply><apply id="S3.SS3.p1.1.m1.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.2">italic-ϕ</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.3">det</ci></apply><apply id="S3.SS3.p1.1.m1.3.3.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.3.3.1.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3">superscript</csymbol><apply id="S3.SS3.p1.1.m1.3.3.3.3.2.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.3.3.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.3.3.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.2.2">italic-ϕ</ci><ci id="S3.SS3.p1.1.m1.3.3.3.3.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.2.3">cls</ci></apply><times id="S3.SS3.p1.1.m1.3.3.3.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.3"></times></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.3c">\{\phi_{\mathrm{cls}},\phi_{\mathrm{det}},\phi_{\mathrm{cls}}^{*}\}</annotation></semantics></math> in WSOD that predict scores <math id="S3.SS3.p1.2.m2.2" class="ltx_Math" alttext="\mathbb{R}^{R\times 512}\rightarrow\mathbb{R}^{R\times(|\mathcal{C}|+1)}" display="inline"><semantics id="S3.SS3.p1.2.m2.2a"><mrow id="S3.SS3.p1.2.m2.2.3" xref="S3.SS3.p1.2.m2.2.3.cmml"><msup id="S3.SS3.p1.2.m2.2.3.2" xref="S3.SS3.p1.2.m2.2.3.2.cmml"><mi id="S3.SS3.p1.2.m2.2.3.2.2" xref="S3.SS3.p1.2.m2.2.3.2.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.2.m2.2.3.2.3" xref="S3.SS3.p1.2.m2.2.3.2.3.cmml"><mi id="S3.SS3.p1.2.m2.2.3.2.3.2" xref="S3.SS3.p1.2.m2.2.3.2.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.2.m2.2.3.2.3.1" xref="S3.SS3.p1.2.m2.2.3.2.3.1.cmml">×</mo><mn id="S3.SS3.p1.2.m2.2.3.2.3.3" xref="S3.SS3.p1.2.m2.2.3.2.3.3.cmml">512</mn></mrow></msup><mo stretchy="false" id="S3.SS3.p1.2.m2.2.3.1" xref="S3.SS3.p1.2.m2.2.3.1.cmml">→</mo><msup id="S3.SS3.p1.2.m2.2.3.3" xref="S3.SS3.p1.2.m2.2.3.3.cmml"><mi id="S3.SS3.p1.2.m2.2.3.3.2" xref="S3.SS3.p1.2.m2.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.2.m2.2.2.2" xref="S3.SS3.p1.2.m2.2.2.2.cmml"><mi id="S3.SS3.p1.2.m2.2.2.2.4" xref="S3.SS3.p1.2.m2.2.2.2.4.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.2.m2.2.2.2.3" xref="S3.SS3.p1.2.m2.2.2.2.3.cmml">×</mo><mrow id="S3.SS3.p1.2.m2.2.2.2.2.1" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.2.2.2.2.1.2" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS3.p1.2.m2.2.2.2.2.1.1" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.cmml"><mrow id="S3.SS3.p1.2.m2.2.2.2.2.1.1.2.2" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.2.2.2.2.1.1.2.2.1" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS3.p1.2.m2.2.2.2.2.1.1.2.2.2" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS3.p1.2.m2.2.2.2.2.1.1.1" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.1.cmml">+</mo><mn id="S3.SS3.p1.2.m2.2.2.2.2.1.1.3" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.p1.2.m2.2.2.2.2.1.3" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.2b"><apply id="S3.SS3.p1.2.m2.2.3.cmml" xref="S3.SS3.p1.2.m2.2.3"><ci id="S3.SS3.p1.2.m2.2.3.1.cmml" xref="S3.SS3.p1.2.m2.2.3.1">→</ci><apply id="S3.SS3.p1.2.m2.2.3.2.cmml" xref="S3.SS3.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.2.3.2.1.cmml" xref="S3.SS3.p1.2.m2.2.3.2">superscript</csymbol><ci id="S3.SS3.p1.2.m2.2.3.2.2.cmml" xref="S3.SS3.p1.2.m2.2.3.2.2">ℝ</ci><apply id="S3.SS3.p1.2.m2.2.3.2.3.cmml" xref="S3.SS3.p1.2.m2.2.3.2.3"><times id="S3.SS3.p1.2.m2.2.3.2.3.1.cmml" xref="S3.SS3.p1.2.m2.2.3.2.3.1"></times><ci id="S3.SS3.p1.2.m2.2.3.2.3.2.cmml" xref="S3.SS3.p1.2.m2.2.3.2.3.2">𝑅</ci><cn type="integer" id="S3.SS3.p1.2.m2.2.3.2.3.3.cmml" xref="S3.SS3.p1.2.m2.2.3.2.3.3">512</cn></apply></apply><apply id="S3.SS3.p1.2.m2.2.3.3.cmml" xref="S3.SS3.p1.2.m2.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.2.3.3.1.cmml" xref="S3.SS3.p1.2.m2.2.3.3">superscript</csymbol><ci id="S3.SS3.p1.2.m2.2.3.3.2.cmml" xref="S3.SS3.p1.2.m2.2.3.3.2">ℝ</ci><apply id="S3.SS3.p1.2.m2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.2.2.2"><times id="S3.SS3.p1.2.m2.2.2.2.3.cmml" xref="S3.SS3.p1.2.m2.2.2.2.3"></times><ci id="S3.SS3.p1.2.m2.2.2.2.4.cmml" xref="S3.SS3.p1.2.m2.2.2.2.4">𝑅</ci><apply id="S3.SS3.p1.2.m2.2.2.2.2.1.1.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2.1"><plus id="S3.SS3.p1.2.m2.2.2.2.2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.1"></plus><apply id="S3.SS3.p1.2.m2.2.2.2.2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.2.2"><abs id="S3.SS3.p1.2.m2.2.2.2.2.1.1.2.1.1.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.2.2.1"></abs><ci id="S3.SS3.p1.2.m2.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1">𝒞</ci></apply><cn type="integer" id="S3.SS3.p1.2.m2.2.2.2.2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.2c">\mathbb{R}^{R\times 512}\rightarrow\mathbb{R}^{R\times(|\mathcal{C}|+1)}</annotation></semantics></math> is modified to compute their respective embedding vectors <math id="S3.SS3.p1.3.m3.3" class="ltx_Math" alttext="e=\{e_{\mathrm{cls}},e_{\mathrm{det}},e_{\mathrm{cls}}^{*}\}" display="inline"><semantics id="S3.SS3.p1.3.m3.3a"><mrow id="S3.SS3.p1.3.m3.3.3" xref="S3.SS3.p1.3.m3.3.3.cmml"><mi id="S3.SS3.p1.3.m3.3.3.5" xref="S3.SS3.p1.3.m3.3.3.5.cmml">e</mi><mo id="S3.SS3.p1.3.m3.3.3.4" xref="S3.SS3.p1.3.m3.3.3.4.cmml">=</mo><mrow id="S3.SS3.p1.3.m3.3.3.3.3" xref="S3.SS3.p1.3.m3.3.3.3.4.cmml"><mo stretchy="false" id="S3.SS3.p1.3.m3.3.3.3.3.4" xref="S3.SS3.p1.3.m3.3.3.3.4.cmml">{</mo><msub id="S3.SS3.p1.3.m3.1.1.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.1.1.1.2" xref="S3.SS3.p1.3.m3.1.1.1.1.1.2.cmml">e</mi><mi id="S3.SS3.p1.3.m3.1.1.1.1.1.3" xref="S3.SS3.p1.3.m3.1.1.1.1.1.3.cmml">cls</mi></msub><mo id="S3.SS3.p1.3.m3.3.3.3.3.5" xref="S3.SS3.p1.3.m3.3.3.3.4.cmml">,</mo><msub id="S3.SS3.p1.3.m3.2.2.2.2.2" xref="S3.SS3.p1.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS3.p1.3.m3.2.2.2.2.2.2" xref="S3.SS3.p1.3.m3.2.2.2.2.2.2.cmml">e</mi><mi id="S3.SS3.p1.3.m3.2.2.2.2.2.3" xref="S3.SS3.p1.3.m3.2.2.2.2.2.3.cmml">det</mi></msub><mo id="S3.SS3.p1.3.m3.3.3.3.3.6" xref="S3.SS3.p1.3.m3.3.3.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.3.m3.3.3.3.3.3" xref="S3.SS3.p1.3.m3.3.3.3.3.3.cmml"><mi id="S3.SS3.p1.3.m3.3.3.3.3.3.2.2" xref="S3.SS3.p1.3.m3.3.3.3.3.3.2.2.cmml">e</mi><mi id="S3.SS3.p1.3.m3.3.3.3.3.3.2.3" xref="S3.SS3.p1.3.m3.3.3.3.3.3.2.3.cmml">cls</mi><mo id="S3.SS3.p1.3.m3.3.3.3.3.3.3" xref="S3.SS3.p1.3.m3.3.3.3.3.3.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S3.SS3.p1.3.m3.3.3.3.3.7" xref="S3.SS3.p1.3.m3.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.3b"><apply id="S3.SS3.p1.3.m3.3.3.cmml" xref="S3.SS3.p1.3.m3.3.3"><eq id="S3.SS3.p1.3.m3.3.3.4.cmml" xref="S3.SS3.p1.3.m3.3.3.4"></eq><ci id="S3.SS3.p1.3.m3.3.3.5.cmml" xref="S3.SS3.p1.3.m3.3.3.5">𝑒</ci><set id="S3.SS3.p1.3.m3.3.3.3.4.cmml" xref="S3.SS3.p1.3.m3.3.3.3.3"><apply id="S3.SS3.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1.2">𝑒</ci><ci id="S3.SS3.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1.3">cls</ci></apply><apply id="S3.SS3.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.2.2">𝑒</ci><ci id="S3.SS3.p1.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.2.3">det</ci></apply><apply id="S3.SS3.p1.3.m3.3.3.3.3.3.cmml" xref="S3.SS3.p1.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.3.3.3.3.3.1.cmml" xref="S3.SS3.p1.3.m3.3.3.3.3.3">superscript</csymbol><apply id="S3.SS3.p1.3.m3.3.3.3.3.3.2.cmml" xref="S3.SS3.p1.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.3.3.3.3.3.2.1.cmml" xref="S3.SS3.p1.3.m3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.3.m3.3.3.3.3.3.2.2.cmml" xref="S3.SS3.p1.3.m3.3.3.3.3.3.2.2">𝑒</ci><ci id="S3.SS3.p1.3.m3.3.3.3.3.3.2.3.cmml" xref="S3.SS3.p1.3.m3.3.3.3.3.3.2.3">cls</ci></apply><times id="S3.SS3.p1.3.m3.3.3.3.3.3.3.cmml" xref="S3.SS3.p1.3.m3.3.3.3.3.3.3"></times></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.3c">e=\{e_{\mathrm{cls}},e_{\mathrm{det}},e_{\mathrm{cls}}^{*}\}</annotation></semantics></math> as <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\mathbb{R}^{R\times 512}\rightarrow\mathbb{R}^{R\times 512}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><msup id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2.2" xref="S3.SS3.p1.4.m4.1.1.2.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.4.m4.1.1.2.3" xref="S3.SS3.p1.4.m4.1.1.2.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2.3.2" xref="S3.SS3.p1.4.m4.1.1.2.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.4.m4.1.1.2.3.1" xref="S3.SS3.p1.4.m4.1.1.2.3.1.cmml">×</mo><mn id="S3.SS3.p1.4.m4.1.1.2.3.3" xref="S3.SS3.p1.4.m4.1.1.2.3.3.cmml">512</mn></mrow></msup><mo stretchy="false" id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.cmml">→</mo><msup id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.4.m4.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.3.2" xref="S3.SS3.p1.4.m4.1.1.3.3.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.4.m4.1.1.3.3.1" xref="S3.SS3.p1.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.p1.4.m4.1.1.3.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.3.cmml">512</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><ci id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1">→</ci><apply id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2.2">ℝ</ci><apply id="S3.SS3.p1.4.m4.1.1.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.2.3"><times id="S3.SS3.p1.4.m4.1.1.2.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.2.3.1"></times><ci id="S3.SS3.p1.4.m4.1.1.2.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2.3.2">𝑅</ci><cn type="integer" id="S3.SS3.p1.4.m4.1.1.2.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.2.3.3">512</cn></apply></apply><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS3.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3"><times id="S3.SS3.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3.1"></times><ci id="S3.SS3.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3.2">𝑅</ci><cn type="integer" id="S3.SS3.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3.3">512</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\mathbb{R}^{R\times 512}\rightarrow\mathbb{R}^{R\times 512}</annotation></semantics></math>. Next, we compute a support set (prototypes for category-level/instance-level sketch) <math id="S3.SS3.p1.5.m5.8" class="ltx_Math" alttext="\mathcal{S}=[e_{\mathbf{bg}},f_{\mathbf{s}}^{1},f_{\mathbf{s}}^{2},\dots,f_{\mathbf{s}}^{|\mathcal{C}|}]^{T}\in\mathbb{R}^{512\times(|\mathcal{C}|+1)}" display="inline"><semantics id="S3.SS3.p1.5.m5.8a"><mrow id="S3.SS3.p1.5.m5.8.8" xref="S3.SS3.p1.5.m5.8.8.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.5.m5.8.8.6" xref="S3.SS3.p1.5.m5.8.8.6.cmml">𝒮</mi><mo id="S3.SS3.p1.5.m5.8.8.7" xref="S3.SS3.p1.5.m5.8.8.7.cmml">=</mo><msup id="S3.SS3.p1.5.m5.8.8.4" xref="S3.SS3.p1.5.m5.8.8.4.cmml"><mrow id="S3.SS3.p1.5.m5.8.8.4.4.4" xref="S3.SS3.p1.5.m5.8.8.4.4.5.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.8.8.4.4.4.5" xref="S3.SS3.p1.5.m5.8.8.4.4.5.cmml">[</mo><msub id="S3.SS3.p1.5.m5.5.5.1.1.1.1" xref="S3.SS3.p1.5.m5.5.5.1.1.1.1.cmml"><mi id="S3.SS3.p1.5.m5.5.5.1.1.1.1.2" xref="S3.SS3.p1.5.m5.5.5.1.1.1.1.2.cmml">e</mi><mi id="S3.SS3.p1.5.m5.5.5.1.1.1.1.3" xref="S3.SS3.p1.5.m5.5.5.1.1.1.1.3.cmml">𝐛𝐠</mi></msub><mo id="S3.SS3.p1.5.m5.8.8.4.4.4.6" xref="S3.SS3.p1.5.m5.8.8.4.4.5.cmml">,</mo><msubsup id="S3.SS3.p1.5.m5.6.6.2.2.2.2" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2.cmml"><mi id="S3.SS3.p1.5.m5.6.6.2.2.2.2.2.2" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2.2.2.cmml">f</mi><mi id="S3.SS3.p1.5.m5.6.6.2.2.2.2.2.3" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2.2.3.cmml">𝐬</mi><mn id="S3.SS3.p1.5.m5.6.6.2.2.2.2.3" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S3.SS3.p1.5.m5.8.8.4.4.4.7" xref="S3.SS3.p1.5.m5.8.8.4.4.5.cmml">,</mo><msubsup id="S3.SS3.p1.5.m5.7.7.3.3.3.3" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3.cmml"><mi id="S3.SS3.p1.5.m5.7.7.3.3.3.3.2.2" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3.2.2.cmml">f</mi><mi id="S3.SS3.p1.5.m5.7.7.3.3.3.3.2.3" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3.2.3.cmml">𝐬</mi><mn id="S3.SS3.p1.5.m5.7.7.3.3.3.3.3" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3.3.cmml">2</mn></msubsup><mo id="S3.SS3.p1.5.m5.8.8.4.4.4.8" xref="S3.SS3.p1.5.m5.8.8.4.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.5.m5.4.4" xref="S3.SS3.p1.5.m5.4.4.cmml">…</mi><mo id="S3.SS3.p1.5.m5.8.8.4.4.4.9" xref="S3.SS3.p1.5.m5.8.8.4.4.5.cmml">,</mo><msubsup id="S3.SS3.p1.5.m5.8.8.4.4.4.4" xref="S3.SS3.p1.5.m5.8.8.4.4.4.4.cmml"><mi id="S3.SS3.p1.5.m5.8.8.4.4.4.4.2.2" xref="S3.SS3.p1.5.m5.8.8.4.4.4.4.2.2.cmml">f</mi><mi id="S3.SS3.p1.5.m5.8.8.4.4.4.4.2.3" xref="S3.SS3.p1.5.m5.8.8.4.4.4.4.2.3.cmml">𝐬</mi><mrow id="S3.SS3.p1.5.m5.1.1.1.3" xref="S3.SS3.p1.5.m5.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.1.1.1.3.1" xref="S3.SS3.p1.5.m5.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.5.m5.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS3.p1.5.m5.1.1.1.3.2" xref="S3.SS3.p1.5.m5.1.1.1.2.1.cmml">|</mo></mrow></msubsup><mo stretchy="false" id="S3.SS3.p1.5.m5.8.8.4.4.4.10" xref="S3.SS3.p1.5.m5.8.8.4.4.5.cmml">]</mo></mrow><mi id="S3.SS3.p1.5.m5.8.8.4.6" xref="S3.SS3.p1.5.m5.8.8.4.6.cmml">T</mi></msup><mo id="S3.SS3.p1.5.m5.8.8.8" xref="S3.SS3.p1.5.m5.8.8.8.cmml">∈</mo><msup id="S3.SS3.p1.5.m5.8.8.9" xref="S3.SS3.p1.5.m5.8.8.9.cmml"><mi id="S3.SS3.p1.5.m5.8.8.9.2" xref="S3.SS3.p1.5.m5.8.8.9.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.5.m5.3.3.2" xref="S3.SS3.p1.5.m5.3.3.2.cmml"><mn id="S3.SS3.p1.5.m5.3.3.2.4" xref="S3.SS3.p1.5.m5.3.3.2.4.cmml">512</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.5.m5.3.3.2.3" xref="S3.SS3.p1.5.m5.3.3.2.3.cmml">×</mo><mrow id="S3.SS3.p1.5.m5.3.3.2.2.1" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.2.2.1.2" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.cmml">(</mo><mrow id="S3.SS3.p1.5.m5.3.3.2.2.1.1" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.cmml"><mrow id="S3.SS3.p1.5.m5.3.3.2.2.1.1.2.2" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.2.2.1.1.2.2.1" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.5.m5.2.2.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.2.2.1.1.2.2.2" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS3.p1.5.m5.3.3.2.2.1.1.1" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.1.cmml">+</mo><mn id="S3.SS3.p1.5.m5.3.3.2.2.1.1.3" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.2.2.1.3" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.8b"><apply id="S3.SS3.p1.5.m5.8.8.cmml" xref="S3.SS3.p1.5.m5.8.8"><and id="S3.SS3.p1.5.m5.8.8a.cmml" xref="S3.SS3.p1.5.m5.8.8"></and><apply id="S3.SS3.p1.5.m5.8.8b.cmml" xref="S3.SS3.p1.5.m5.8.8"><eq id="S3.SS3.p1.5.m5.8.8.7.cmml" xref="S3.SS3.p1.5.m5.8.8.7"></eq><ci id="S3.SS3.p1.5.m5.8.8.6.cmml" xref="S3.SS3.p1.5.m5.8.8.6">𝒮</ci><apply id="S3.SS3.p1.5.m5.8.8.4.cmml" xref="S3.SS3.p1.5.m5.8.8.4"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.8.8.4.5.cmml" xref="S3.SS3.p1.5.m5.8.8.4">superscript</csymbol><list id="S3.SS3.p1.5.m5.8.8.4.4.5.cmml" xref="S3.SS3.p1.5.m5.8.8.4.4.4"><apply id="S3.SS3.p1.5.m5.5.5.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.5.5.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.5.5.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.5.5.1.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.5.5.1.1.1.1.2">𝑒</ci><ci id="S3.SS3.p1.5.m5.5.5.1.1.1.1.3.cmml" xref="S3.SS3.p1.5.m5.5.5.1.1.1.1.3">𝐛𝐠</ci></apply><apply id="S3.SS3.p1.5.m5.6.6.2.2.2.2.cmml" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.6.6.2.2.2.2.1.cmml" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2">superscript</csymbol><apply id="S3.SS3.p1.5.m5.6.6.2.2.2.2.2.cmml" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.6.6.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.5.m5.6.6.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2.2.2">𝑓</ci><ci id="S3.SS3.p1.5.m5.6.6.2.2.2.2.2.3.cmml" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2.2.3">𝐬</ci></apply><cn type="integer" id="S3.SS3.p1.5.m5.6.6.2.2.2.2.3.cmml" xref="S3.SS3.p1.5.m5.6.6.2.2.2.2.3">1</cn></apply><apply id="S3.SS3.p1.5.m5.7.7.3.3.3.3.cmml" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.7.7.3.3.3.3.1.cmml" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3">superscript</csymbol><apply id="S3.SS3.p1.5.m5.7.7.3.3.3.3.2.cmml" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.7.7.3.3.3.3.2.1.cmml" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.5.m5.7.7.3.3.3.3.2.2.cmml" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3.2.2">𝑓</ci><ci id="S3.SS3.p1.5.m5.7.7.3.3.3.3.2.3.cmml" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3.2.3">𝐬</ci></apply><cn type="integer" id="S3.SS3.p1.5.m5.7.7.3.3.3.3.3.cmml" xref="S3.SS3.p1.5.m5.7.7.3.3.3.3.3">2</cn></apply><ci id="S3.SS3.p1.5.m5.4.4.cmml" xref="S3.SS3.p1.5.m5.4.4">…</ci><apply id="S3.SS3.p1.5.m5.8.8.4.4.4.4.cmml" xref="S3.SS3.p1.5.m5.8.8.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.8.8.4.4.4.4.1.cmml" xref="S3.SS3.p1.5.m5.8.8.4.4.4.4">superscript</csymbol><apply id="S3.SS3.p1.5.m5.8.8.4.4.4.4.2.cmml" xref="S3.SS3.p1.5.m5.8.8.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.8.8.4.4.4.4.2.1.cmml" xref="S3.SS3.p1.5.m5.8.8.4.4.4.4">subscript</csymbol><ci id="S3.SS3.p1.5.m5.8.8.4.4.4.4.2.2.cmml" xref="S3.SS3.p1.5.m5.8.8.4.4.4.4.2.2">𝑓</ci><ci id="S3.SS3.p1.5.m5.8.8.4.4.4.4.2.3.cmml" xref="S3.SS3.p1.5.m5.8.8.4.4.4.4.2.3">𝐬</ci></apply><apply id="S3.SS3.p1.5.m5.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.1.3"><abs id="S3.SS3.p1.5.m5.1.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.3.1"></abs><ci id="S3.SS3.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1">𝒞</ci></apply></apply></list><ci id="S3.SS3.p1.5.m5.8.8.4.6.cmml" xref="S3.SS3.p1.5.m5.8.8.4.6">𝑇</ci></apply></apply><apply id="S3.SS3.p1.5.m5.8.8c.cmml" xref="S3.SS3.p1.5.m5.8.8"><in id="S3.SS3.p1.5.m5.8.8.8.cmml" xref="S3.SS3.p1.5.m5.8.8.8"></in><share href="#S3.SS3.p1.5.m5.8.8.4.cmml" id="S3.SS3.p1.5.m5.8.8d.cmml" xref="S3.SS3.p1.5.m5.8.8"></share><apply id="S3.SS3.p1.5.m5.8.8.9.cmml" xref="S3.SS3.p1.5.m5.8.8.9"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.8.8.9.1.cmml" xref="S3.SS3.p1.5.m5.8.8.9">superscript</csymbol><ci id="S3.SS3.p1.5.m5.8.8.9.2.cmml" xref="S3.SS3.p1.5.m5.8.8.9.2">ℝ</ci><apply id="S3.SS3.p1.5.m5.3.3.2.cmml" xref="S3.SS3.p1.5.m5.3.3.2"><times id="S3.SS3.p1.5.m5.3.3.2.3.cmml" xref="S3.SS3.p1.5.m5.3.3.2.3"></times><cn type="integer" id="S3.SS3.p1.5.m5.3.3.2.4.cmml" xref="S3.SS3.p1.5.m5.3.3.2.4">512</cn><apply id="S3.SS3.p1.5.m5.3.3.2.2.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.1"><plus id="S3.SS3.p1.5.m5.3.3.2.2.1.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.1"></plus><apply id="S3.SS3.p1.5.m5.3.3.2.2.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.2.2"><abs id="S3.SS3.p1.5.m5.3.3.2.2.1.1.2.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.2.2.1"></abs><ci id="S3.SS3.p1.5.m5.2.2.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1">𝒞</ci></apply><cn type="integer" id="S3.SS3.p1.5.m5.3.3.2.2.1.1.3.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.8c">\mathcal{S}=[e_{\mathbf{bg}},f_{\mathbf{s}}^{1},f_{\mathbf{s}}^{2},\dots,f_{\mathbf{s}}^{|\mathcal{C}|}]^{T}\in\mathbb{R}^{512\times(|\mathcal{C}|+1)}</annotation></semantics></math> by encoding query sketches <math id="S3.SS3.p1.6.m6.4" class="ltx_Math" alttext="\{\mathbf{s}_{1},\dots,\mathbf{s}_{|\mathcal{C}|}\}" display="inline"><semantics id="S3.SS3.p1.6.m6.4a"><mrow id="S3.SS3.p1.6.m6.4.4.2" xref="S3.SS3.p1.6.m6.4.4.3.cmml"><mo stretchy="false" id="S3.SS3.p1.6.m6.4.4.2.3" xref="S3.SS3.p1.6.m6.4.4.3.cmml">{</mo><msub id="S3.SS3.p1.6.m6.3.3.1.1" xref="S3.SS3.p1.6.m6.3.3.1.1.cmml"><mi id="S3.SS3.p1.6.m6.3.3.1.1.2" xref="S3.SS3.p1.6.m6.3.3.1.1.2.cmml">𝐬</mi><mn id="S3.SS3.p1.6.m6.3.3.1.1.3" xref="S3.SS3.p1.6.m6.3.3.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p1.6.m6.4.4.2.4" xref="S3.SS3.p1.6.m6.4.4.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.6.m6.2.2" xref="S3.SS3.p1.6.m6.2.2.cmml">…</mi><mo id="S3.SS3.p1.6.m6.4.4.2.5" xref="S3.SS3.p1.6.m6.4.4.3.cmml">,</mo><msub id="S3.SS3.p1.6.m6.4.4.2.2" xref="S3.SS3.p1.6.m6.4.4.2.2.cmml"><mi id="S3.SS3.p1.6.m6.4.4.2.2.2" xref="S3.SS3.p1.6.m6.4.4.2.2.2.cmml">𝐬</mi><mrow id="S3.SS3.p1.6.m6.1.1.1.3" xref="S3.SS3.p1.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.6.m6.1.1.1.3.1" xref="S3.SS3.p1.6.m6.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m6.1.1.1.1" xref="S3.SS3.p1.6.m6.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS3.p1.6.m6.1.1.1.3.2" xref="S3.SS3.p1.6.m6.1.1.1.2.1.cmml">|</mo></mrow></msub><mo stretchy="false" id="S3.SS3.p1.6.m6.4.4.2.6" xref="S3.SS3.p1.6.m6.4.4.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.4b"><set id="S3.SS3.p1.6.m6.4.4.3.cmml" xref="S3.SS3.p1.6.m6.4.4.2"><apply id="S3.SS3.p1.6.m6.3.3.1.1.cmml" xref="S3.SS3.p1.6.m6.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.3.3.1.1.1.cmml" xref="S3.SS3.p1.6.m6.3.3.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.3.3.1.1.2.cmml" xref="S3.SS3.p1.6.m6.3.3.1.1.2">𝐬</ci><cn type="integer" id="S3.SS3.p1.6.m6.3.3.1.1.3.cmml" xref="S3.SS3.p1.6.m6.3.3.1.1.3">1</cn></apply><ci id="S3.SS3.p1.6.m6.2.2.cmml" xref="S3.SS3.p1.6.m6.2.2">…</ci><apply id="S3.SS3.p1.6.m6.4.4.2.2.cmml" xref="S3.SS3.p1.6.m6.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.4.4.2.2.1.cmml" xref="S3.SS3.p1.6.m6.4.4.2.2">subscript</csymbol><ci id="S3.SS3.p1.6.m6.4.4.2.2.2.cmml" xref="S3.SS3.p1.6.m6.4.4.2.2.2">𝐬</ci><apply id="S3.SS3.p1.6.m6.1.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.1.3"><abs id="S3.SS3.p1.6.m6.1.1.1.2.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1.3.1"></abs><ci id="S3.SS3.p1.6.m6.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1.1">𝒞</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.4c">\{\mathbf{s}_{1},\dots,\mathbf{s}_{|\mathcal{C}|}\}</annotation></semantics></math> with a pre-trained sketch encoder (<math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{s}}" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><msub id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml">𝐬</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2">ℱ</ci><ci id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">\mathcal{F}_{\mathbf{s}}</annotation></semantics></math>) and a learned catch-all background embedding <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="e_{\mathbf{bg}}\in\mathbb{R}^{512}" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><mrow id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><msub id="S3.SS3.p1.8.m8.1.1.2" xref="S3.SS3.p1.8.m8.1.1.2.cmml"><mi id="S3.SS3.p1.8.m8.1.1.2.2" xref="S3.SS3.p1.8.m8.1.1.2.2.cmml">e</mi><mi id="S3.SS3.p1.8.m8.1.1.2.3" xref="S3.SS3.p1.8.m8.1.1.2.3.cmml">𝐛𝐠</mi></msub><mo id="S3.SS3.p1.8.m8.1.1.1" xref="S3.SS3.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml"><mi id="S3.SS3.p1.8.m8.1.1.3.2" xref="S3.SS3.p1.8.m8.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS3.p1.8.m8.1.1.3.3" xref="S3.SS3.p1.8.m8.1.1.3.3.cmml">512</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><in id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1"></in><apply id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.2.1.cmml" xref="S3.SS3.p1.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.2.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2.2">𝑒</ci><ci id="S3.SS3.p1.8.m8.1.1.2.3.cmml" xref="S3.SS3.p1.8.m8.1.1.2.3">𝐛𝐠</ci></apply><apply id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.3.1.cmml" xref="S3.SS3.p1.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.3.2.cmml" xref="S3.SS3.p1.8.m8.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS3.p1.8.m8.1.1.3.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3.3">512</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">e_{\mathbf{bg}}\in\mathbb{R}^{512}</annotation></semantics></math>, as shown in <a href="#S3.F4" title="In 3.3 Localising Object Regions with Query Sketch ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>. The scores <math id="S3.SS3.p1.9.m9.3" class="ltx_Math" alttext="\{x_{c},x_{d},\omega_{k}\}" display="inline"><semantics id="S3.SS3.p1.9.m9.3a"><mrow id="S3.SS3.p1.9.m9.3.3.3" xref="S3.SS3.p1.9.m9.3.3.4.cmml"><mo stretchy="false" id="S3.SS3.p1.9.m9.3.3.3.4" xref="S3.SS3.p1.9.m9.3.3.4.cmml">{</mo><msub id="S3.SS3.p1.9.m9.1.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.1.cmml"><mi id="S3.SS3.p1.9.m9.1.1.1.1.2" xref="S3.SS3.p1.9.m9.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.p1.9.m9.1.1.1.1.3" xref="S3.SS3.p1.9.m9.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS3.p1.9.m9.3.3.3.5" xref="S3.SS3.p1.9.m9.3.3.4.cmml">,</mo><msub id="S3.SS3.p1.9.m9.2.2.2.2" xref="S3.SS3.p1.9.m9.2.2.2.2.cmml"><mi id="S3.SS3.p1.9.m9.2.2.2.2.2" xref="S3.SS3.p1.9.m9.2.2.2.2.2.cmml">x</mi><mi id="S3.SS3.p1.9.m9.2.2.2.2.3" xref="S3.SS3.p1.9.m9.2.2.2.2.3.cmml">d</mi></msub><mo id="S3.SS3.p1.9.m9.3.3.3.6" xref="S3.SS3.p1.9.m9.3.3.4.cmml">,</mo><msub id="S3.SS3.p1.9.m9.3.3.3.3" xref="S3.SS3.p1.9.m9.3.3.3.3.cmml"><mi id="S3.SS3.p1.9.m9.3.3.3.3.2" xref="S3.SS3.p1.9.m9.3.3.3.3.2.cmml">ω</mi><mi id="S3.SS3.p1.9.m9.3.3.3.3.3" xref="S3.SS3.p1.9.m9.3.3.3.3.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS3.p1.9.m9.3.3.3.7" xref="S3.SS3.p1.9.m9.3.3.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.3b"><set id="S3.SS3.p1.9.m9.3.3.4.cmml" xref="S3.SS3.p1.9.m9.3.3.3"><apply id="S3.SS3.p1.9.m9.1.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.1.1.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.9.m9.1.1.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.p1.9.m9.1.1.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.1.1.3">𝑐</ci></apply><apply id="S3.SS3.p1.9.m9.2.2.2.2.cmml" xref="S3.SS3.p1.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.2.2.2.2.1.cmml" xref="S3.SS3.p1.9.m9.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.9.m9.2.2.2.2.2.cmml" xref="S3.SS3.p1.9.m9.2.2.2.2.2">𝑥</ci><ci id="S3.SS3.p1.9.m9.2.2.2.2.3.cmml" xref="S3.SS3.p1.9.m9.2.2.2.2.3">𝑑</ci></apply><apply id="S3.SS3.p1.9.m9.3.3.3.3.cmml" xref="S3.SS3.p1.9.m9.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.3.3.3.3.1.cmml" xref="S3.SS3.p1.9.m9.3.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.9.m9.3.3.3.3.2.cmml" xref="S3.SS3.p1.9.m9.3.3.3.3.2">𝜔</ci><ci id="S3.SS3.p1.9.m9.3.3.3.3.3.cmml" xref="S3.SS3.p1.9.m9.3.3.3.3.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.3c">\{x_{c},x_{d},\omega_{k}\}</annotation></semantics></math> (analogous to <a href="#S3.SS2" title="3.2 Weakly Supervised Object Detection ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3.2</span></a>) are computed using <math id="S3.SS3.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS3.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><ci id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">\mathcal{S}</annotation></semantics></math> and embedding vectors <math id="S3.SS3.p1.11.m11.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS3.p1.11.m11.1a"><mi id="S3.SS3.p1.11.m11.1.1" xref="S3.SS3.p1.11.m11.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m11.1b"><ci id="S3.SS3.p1.11.m11.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m11.1c">e</annotation></semantics></math> of detected regions</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.2" class="ltx_Math" alttext="x_{c}=e_{\mathrm{cls}}\cdot\mathcal{S};\hskip 10.00002ptx_{d}=e_{\mathrm{det}}\cdot\mathcal{S};\hskip 10.00002pt\omega_{k}=e_{\mathrm{cls}}^{*}\cdot\mathcal{S}" display="block"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.3.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E7.m1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><msub id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.cmml">e</mi><mi id="S3.E7.m1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.cmml">cls</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E7.m1.1.1.1.1.3.1" xref="S3.E7.m1.1.1.1.1.3.1.cmml">⋅</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3.cmml">𝒮</mi></mrow></mrow><mo rspace="1.167em" id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.3a.cmml">;</mo><mrow id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.3.cmml"><mrow id="S3.E7.m1.2.2.2.2.1.1" xref="S3.E7.m1.2.2.2.2.1.1.cmml"><msub id="S3.E7.m1.2.2.2.2.1.1.2" xref="S3.E7.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E7.m1.2.2.2.2.1.1.2.2" xref="S3.E7.m1.2.2.2.2.1.1.2.2.cmml">x</mi><mi id="S3.E7.m1.2.2.2.2.1.1.2.3" xref="S3.E7.m1.2.2.2.2.1.1.2.3.cmml">d</mi></msub><mo id="S3.E7.m1.2.2.2.2.1.1.1" xref="S3.E7.m1.2.2.2.2.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.2.2.2.2.1.1.3" xref="S3.E7.m1.2.2.2.2.1.1.3.cmml"><msub id="S3.E7.m1.2.2.2.2.1.1.3.2" xref="S3.E7.m1.2.2.2.2.1.1.3.2.cmml"><mi id="S3.E7.m1.2.2.2.2.1.1.3.2.2" xref="S3.E7.m1.2.2.2.2.1.1.3.2.2.cmml">e</mi><mi id="S3.E7.m1.2.2.2.2.1.1.3.2.3" xref="S3.E7.m1.2.2.2.2.1.1.3.2.3.cmml">det</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E7.m1.2.2.2.2.1.1.3.1" xref="S3.E7.m1.2.2.2.2.1.1.3.1.cmml">⋅</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.2.2.1.1.3.3" xref="S3.E7.m1.2.2.2.2.1.1.3.3.cmml">𝒮</mi></mrow></mrow><mo rspace="1.167em" id="S3.E7.m1.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.3a.cmml">;</mo><mrow id="S3.E7.m1.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.cmml"><msub id="S3.E7.m1.2.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.2.2.cmml">ω</mi><mi id="S3.E7.m1.2.2.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="S3.E7.m1.2.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.2.3.cmml"><msubsup id="S3.E7.m1.2.2.2.2.2.2.3.2" xref="S3.E7.m1.2.2.2.2.2.2.3.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.3.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.3.2.2.2.cmml">e</mi><mi id="S3.E7.m1.2.2.2.2.2.2.3.2.2.3" xref="S3.E7.m1.2.2.2.2.2.2.3.2.2.3.cmml">cls</mi><mo id="S3.E7.m1.2.2.2.2.2.2.3.2.3" xref="S3.E7.m1.2.2.2.2.2.2.3.2.3.cmml">∗</mo></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E7.m1.2.2.2.2.2.2.3.1" xref="S3.E7.m1.2.2.2.2.2.2.3.1.cmml">⋅</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.2.2.2.2.3.3" xref="S3.E7.m1.2.2.2.2.2.2.3.3.cmml">𝒮</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.3a.cmml" xref="S3.E7.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"></eq><apply id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E7.m1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><ci id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1">⋅</ci><apply id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2">𝑒</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3">cls</ci></apply><ci id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3">𝒮</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.3a.cmml" xref="S3.E7.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.2.2.2.2.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1"><eq id="S3.E7.m1.2.2.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1"></eq><apply id="S3.E7.m1.2.2.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.2">𝑥</ci><ci id="S3.E7.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.3">𝑑</ci></apply><apply id="S3.E7.m1.2.2.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.3"><ci id="S3.E7.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.3.1">⋅</ci><apply id="S3.E7.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.3.2.2">𝑒</ci><ci id="S3.E7.m1.2.2.2.2.1.1.3.2.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.3.2.3">det</ci></apply><ci id="S3.E7.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.3.3">𝒮</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2"><eq id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1"></eq><apply id="S3.E7.m1.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2.2">𝜔</ci><ci id="S3.E7.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2.3">𝑘</ci></apply><apply id="S3.E7.m1.2.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3"><ci id="S3.E7.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3.1">⋅</ci><apply id="S3.E7.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.3.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3.2">superscript</csymbol><apply id="S3.E7.m1.2.2.2.2.2.2.3.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.3.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.3.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3.2.2.2">𝑒</ci><ci id="S3.E7.m1.2.2.2.2.2.2.3.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3.2.2.3">cls</ci></apply><times id="S3.E7.m1.2.2.2.2.2.2.3.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3.2.3"></times></apply><ci id="S3.E7.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3.3">𝒮</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">x_{c}=e_{\mathrm{cls}}\cdot\mathcal{S};\hskip 10.00002ptx_{d}=e_{\mathrm{det}}\cdot\mathcal{S};\hskip 10.00002pt\omega_{k}=e_{\mathrm{cls}}^{*}\cdot\mathcal{S}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.20" class="ltx_p">Carefully choosing a sketch encoder <math id="S3.SS3.p1.12.m1.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{s}}" display="inline"><semantics id="S3.SS3.p1.12.m1.1a"><msub id="S3.SS3.p1.12.m1.1.1" xref="S3.SS3.p1.12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.12.m1.1.1.2" xref="S3.SS3.p1.12.m1.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p1.12.m1.1.1.3" xref="S3.SS3.p1.12.m1.1.1.3.cmml">𝐬</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m1.1b"><apply id="S3.SS3.p1.12.m1.1.1.cmml" xref="S3.SS3.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.12.m1.1.1.1.cmml" xref="S3.SS3.p1.12.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.12.m1.1.1.2.cmml" xref="S3.SS3.p1.12.m1.1.1.2">ℱ</ci><ci id="S3.SS3.p1.12.m1.1.1.3.cmml" xref="S3.SS3.p1.12.m1.1.1.3">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m1.1c">\mathcal{F}_{\mathbf{s}}</annotation></semantics></math> leads to several properties: (i) pre-training <math id="S3.SS3.p1.13.m2.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{s}}" display="inline"><semantics id="S3.SS3.p1.13.m2.1a"><msub id="S3.SS3.p1.13.m2.1.1" xref="S3.SS3.p1.13.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.13.m2.1.1.2" xref="S3.SS3.p1.13.m2.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p1.13.m2.1.1.3" xref="S3.SS3.p1.13.m2.1.1.3.cmml">𝐬</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m2.1b"><apply id="S3.SS3.p1.13.m2.1.1.cmml" xref="S3.SS3.p1.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m2.1.1.1.cmml" xref="S3.SS3.p1.13.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.13.m2.1.1.2.cmml" xref="S3.SS3.p1.13.m2.1.1.2">ℱ</ci><ci id="S3.SS3.p1.13.m2.1.1.3.cmml" xref="S3.SS3.p1.13.m2.1.1.3">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m2.1c">\mathcal{F}_{\mathbf{s}}</annotation></semantics></math> on category-level SBIR computes <math id="S3.SS3.p1.14.m3.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS3.p1.14.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.14.m3.1.1" xref="S3.SS3.p1.14.m3.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m3.1b"><ci id="S3.SS3.p1.14.m3.1.1.cmml" xref="S3.SS3.p1.14.m3.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m3.1c">\mathcal{S}</annotation></semantics></math> that detect regions <math id="S3.SS3.p1.15.m4.1" class="ltx_Math" alttext="\mathbf{r}" display="inline"><semantics id="S3.SS3.p1.15.m4.1a"><mi id="S3.SS3.p1.15.m4.1.1" xref="S3.SS3.p1.15.m4.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m4.1b"><ci id="S3.SS3.p1.15.m4.1.1.cmml" xref="S3.SS3.p1.15.m4.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m4.1c">\mathbf{r}</annotation></semantics></math> with the same category as query sketches – category-level object detection. (ii) pre-training <math id="S3.SS3.p1.16.m5.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{s}}" display="inline"><semantics id="S3.SS3.p1.16.m5.1a"><msub id="S3.SS3.p1.16.m5.1.1" xref="S3.SS3.p1.16.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.16.m5.1.1.2" xref="S3.SS3.p1.16.m5.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p1.16.m5.1.1.3" xref="S3.SS3.p1.16.m5.1.1.3.cmml">𝐬</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m5.1b"><apply id="S3.SS3.p1.16.m5.1.1.cmml" xref="S3.SS3.p1.16.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.16.m5.1.1.1.cmml" xref="S3.SS3.p1.16.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.16.m5.1.1.2.cmml" xref="S3.SS3.p1.16.m5.1.1.2">ℱ</ci><ci id="S3.SS3.p1.16.m5.1.1.3.cmml" xref="S3.SS3.p1.16.m5.1.1.3">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m5.1c">\mathcal{F}_{\mathbf{s}}</annotation></semantics></math> on cross-category FG-SBIR computes <math id="S3.SS3.p1.17.m6.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS3.p1.17.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.17.m6.1.1" xref="S3.SS3.p1.17.m6.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.17.m6.1b"><ci id="S3.SS3.p1.17.m6.1.1.cmml" xref="S3.SS3.p1.17.m6.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.17.m6.1c">\mathcal{S}</annotation></semantics></math> where only instance-level aligned regions <math id="S3.SS3.p1.18.m7.1" class="ltx_Math" alttext="\mathbf{r}" display="inline"><semantics id="S3.SS3.p1.18.m7.1a"><mi id="S3.SS3.p1.18.m7.1.1" xref="S3.SS3.p1.18.m7.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.18.m7.1b"><ci id="S3.SS3.p1.18.m7.1.1.cmml" xref="S3.SS3.p1.18.m7.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.18.m7.1c">\mathbf{r}</annotation></semantics></math> are detected – fine-grained object detection. (iii) Extending fine-grained object detection with a generalisable (out-of-vocab) sketch encoder <math id="S3.SS3.p1.19.m8.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{s}}" display="inline"><semantics id="S3.SS3.p1.19.m8.1a"><msub id="S3.SS3.p1.19.m8.1.1" xref="S3.SS3.p1.19.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.19.m8.1.1.2" xref="S3.SS3.p1.19.m8.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p1.19.m8.1.1.3" xref="S3.SS3.p1.19.m8.1.1.3.cmml">𝐬</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.19.m8.1b"><apply id="S3.SS3.p1.19.m8.1.1.cmml" xref="S3.SS3.p1.19.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.19.m8.1.1.1.cmml" xref="S3.SS3.p1.19.m8.1.1">subscript</csymbol><ci id="S3.SS3.p1.19.m8.1.1.2.cmml" xref="S3.SS3.p1.19.m8.1.1.2">ℱ</ci><ci id="S3.SS3.p1.19.m8.1.1.3.cmml" xref="S3.SS3.p1.19.m8.1.1.3">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.19.m8.1c">\mathcal{F}_{\mathbf{s}}</annotation></semantics></math> helps to detect object parts (e.g., “head” of a “horse”) given query sketches – part-level object detection. We train object detection modules <math id="S3.SS3.p1.20.m9.5" class="ltx_Math" alttext="\{\mathcal{F}_{d},\mathcal{P},\phi_{\mathrm{cls}},\phi_{\mathrm{det}},\phi_{\mathrm{cls}}^{*}\}" display="inline"><semantics id="S3.SS3.p1.20.m9.5a"><mrow id="S3.SS3.p1.20.m9.5.5.4" xref="S3.SS3.p1.20.m9.5.5.5.cmml"><mo stretchy="false" id="S3.SS3.p1.20.m9.5.5.4.5" xref="S3.SS3.p1.20.m9.5.5.5.cmml">{</mo><msub id="S3.SS3.p1.20.m9.2.2.1.1" xref="S3.SS3.p1.20.m9.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.20.m9.2.2.1.1.2" xref="S3.SS3.p1.20.m9.2.2.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p1.20.m9.2.2.1.1.3" xref="S3.SS3.p1.20.m9.2.2.1.1.3.cmml">d</mi></msub><mo id="S3.SS3.p1.20.m9.5.5.4.6" xref="S3.SS3.p1.20.m9.5.5.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.20.m9.1.1" xref="S3.SS3.p1.20.m9.1.1.cmml">𝒫</mi><mo id="S3.SS3.p1.20.m9.5.5.4.7" xref="S3.SS3.p1.20.m9.5.5.5.cmml">,</mo><msub id="S3.SS3.p1.20.m9.3.3.2.2" xref="S3.SS3.p1.20.m9.3.3.2.2.cmml"><mi id="S3.SS3.p1.20.m9.3.3.2.2.2" xref="S3.SS3.p1.20.m9.3.3.2.2.2.cmml">ϕ</mi><mi id="S3.SS3.p1.20.m9.3.3.2.2.3" xref="S3.SS3.p1.20.m9.3.3.2.2.3.cmml">cls</mi></msub><mo id="S3.SS3.p1.20.m9.5.5.4.8" xref="S3.SS3.p1.20.m9.5.5.5.cmml">,</mo><msub id="S3.SS3.p1.20.m9.4.4.3.3" xref="S3.SS3.p1.20.m9.4.4.3.3.cmml"><mi id="S3.SS3.p1.20.m9.4.4.3.3.2" xref="S3.SS3.p1.20.m9.4.4.3.3.2.cmml">ϕ</mi><mi id="S3.SS3.p1.20.m9.4.4.3.3.3" xref="S3.SS3.p1.20.m9.4.4.3.3.3.cmml">det</mi></msub><mo id="S3.SS3.p1.20.m9.5.5.4.9" xref="S3.SS3.p1.20.m9.5.5.5.cmml">,</mo><msubsup id="S3.SS3.p1.20.m9.5.5.4.4" xref="S3.SS3.p1.20.m9.5.5.4.4.cmml"><mi id="S3.SS3.p1.20.m9.5.5.4.4.2.2" xref="S3.SS3.p1.20.m9.5.5.4.4.2.2.cmml">ϕ</mi><mi id="S3.SS3.p1.20.m9.5.5.4.4.2.3" xref="S3.SS3.p1.20.m9.5.5.4.4.2.3.cmml">cls</mi><mo id="S3.SS3.p1.20.m9.5.5.4.4.3" xref="S3.SS3.p1.20.m9.5.5.4.4.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S3.SS3.p1.20.m9.5.5.4.10" xref="S3.SS3.p1.20.m9.5.5.5.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.20.m9.5b"><set id="S3.SS3.p1.20.m9.5.5.5.cmml" xref="S3.SS3.p1.20.m9.5.5.4"><apply id="S3.SS3.p1.20.m9.2.2.1.1.cmml" xref="S3.SS3.p1.20.m9.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m9.2.2.1.1.1.cmml" xref="S3.SS3.p1.20.m9.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p1.20.m9.2.2.1.1.2.cmml" xref="S3.SS3.p1.20.m9.2.2.1.1.2">ℱ</ci><ci id="S3.SS3.p1.20.m9.2.2.1.1.3.cmml" xref="S3.SS3.p1.20.m9.2.2.1.1.3">𝑑</ci></apply><ci id="S3.SS3.p1.20.m9.1.1.cmml" xref="S3.SS3.p1.20.m9.1.1">𝒫</ci><apply id="S3.SS3.p1.20.m9.3.3.2.2.cmml" xref="S3.SS3.p1.20.m9.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m9.3.3.2.2.1.cmml" xref="S3.SS3.p1.20.m9.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p1.20.m9.3.3.2.2.2.cmml" xref="S3.SS3.p1.20.m9.3.3.2.2.2">italic-ϕ</ci><ci id="S3.SS3.p1.20.m9.3.3.2.2.3.cmml" xref="S3.SS3.p1.20.m9.3.3.2.2.3">cls</ci></apply><apply id="S3.SS3.p1.20.m9.4.4.3.3.cmml" xref="S3.SS3.p1.20.m9.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m9.4.4.3.3.1.cmml" xref="S3.SS3.p1.20.m9.4.4.3.3">subscript</csymbol><ci id="S3.SS3.p1.20.m9.4.4.3.3.2.cmml" xref="S3.SS3.p1.20.m9.4.4.3.3.2">italic-ϕ</ci><ci id="S3.SS3.p1.20.m9.4.4.3.3.3.cmml" xref="S3.SS3.p1.20.m9.4.4.3.3.3">det</ci></apply><apply id="S3.SS3.p1.20.m9.5.5.4.4.cmml" xref="S3.SS3.p1.20.m9.5.5.4.4"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m9.5.5.4.4.1.cmml" xref="S3.SS3.p1.20.m9.5.5.4.4">superscript</csymbol><apply id="S3.SS3.p1.20.m9.5.5.4.4.2.cmml" xref="S3.SS3.p1.20.m9.5.5.4.4"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m9.5.5.4.4.2.1.cmml" xref="S3.SS3.p1.20.m9.5.5.4.4">subscript</csymbol><ci id="S3.SS3.p1.20.m9.5.5.4.4.2.2.cmml" xref="S3.SS3.p1.20.m9.5.5.4.4.2.2">italic-ϕ</ci><ci id="S3.SS3.p1.20.m9.5.5.4.4.2.3.cmml" xref="S3.SS3.p1.20.m9.5.5.4.4.2.3">cls</ci></apply><times id="S3.SS3.p1.20.m9.5.5.4.4.3.cmml" xref="S3.SS3.p1.20.m9.5.5.4.4.3"></times></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.20.m9.5c">\{\mathcal{F}_{d},\mathcal{P},\phi_{\mathrm{cls}},\phi_{\mathrm{det}},\phi_{\mathrm{cls}}^{*}\}</annotation></semantics></math>, using <a href="#S3.E5" title="In 3.2 Weakly Supervised Object Detection ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">5</span></a> and <a href="#S3.E6" title="In 3.2 Weakly Supervised Object Detection ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">6</span></a> in WSOD (<a href="#S3.SS2" title="3.2 Weakly Supervised Object Detection ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3.2</span></a>).</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.8" class="ltx_p">While the sketch encoder (<math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{s}}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">𝐬</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">ℱ</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathcal{F}_{\mathbf{s}}</annotation></semantics></math>) trains object detector via prototypes for each category/instance sketch, we further enhance training efficiency with additional supervision from the photo encoder (<math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{p}}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">𝐩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">ℱ</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathcal{F}_{\mathbf{p}}</annotation></semantics></math>), as shown in <a href="#S3.F4" title="In 3.3 Localising Object Regions with Query Sketch ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>. Specifically, we impose a <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="L1" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">​</mo><mn id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><times id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></times><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝐿</ci><cn type="integer" id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">L1</annotation></semantics></math>-based feature matching loss (analogous to feature distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>) between patch features <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="f_{\mathbf{r}}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">𝐫</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝑓</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">f_{\mathbf{r}}</annotation></semantics></math> from proposals <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{r}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\mathbf{r}</annotation></semantics></math> in object detector and the photo feature computed for cropped photo regions <math id="S3.SS3.p2.6.m6.2" class="ltx_Math" alttext="\texttt{Crop}(\mathbf{p},\mathbf{r})" display="inline"><semantics id="S3.SS3.p2.6.m6.2a"><mrow id="S3.SS3.p2.6.m6.2.3" xref="S3.SS3.p2.6.m6.2.3.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.SS3.p2.6.m6.2.3.2" xref="S3.SS3.p2.6.m6.2.3.2a.cmml">Crop</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.2.3.1" xref="S3.SS3.p2.6.m6.2.3.1.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.2.3.3.2" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.2.3.3.2.1" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">𝐩</mi><mo id="S3.SS3.p2.6.m6.2.3.3.2.2" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p2.6.m6.2.2" xref="S3.SS3.p2.6.m6.2.2.cmml">𝐫</mi><mo stretchy="false" id="S3.SS3.p2.6.m6.2.3.3.2.3" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.2b"><apply id="S3.SS3.p2.6.m6.2.3.cmml" xref="S3.SS3.p2.6.m6.2.3"><times id="S3.SS3.p2.6.m6.2.3.1.cmml" xref="S3.SS3.p2.6.m6.2.3.1"></times><ci id="S3.SS3.p2.6.m6.2.3.2a.cmml" xref="S3.SS3.p2.6.m6.2.3.2"><mtext class="ltx_mathvariant_monospace" id="S3.SS3.p2.6.m6.2.3.2.cmml" xref="S3.SS3.p2.6.m6.2.3.2">Crop</mtext></ci><interval closure="open" id="S3.SS3.p2.6.m6.2.3.3.1.cmml" xref="S3.SS3.p2.6.m6.2.3.3.2"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝐩</ci><ci id="S3.SS3.p2.6.m6.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2">𝐫</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.2c">\texttt{Crop}(\mathbf{p},\mathbf{r})</annotation></semantics></math> using pre-trained <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{p}}" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><msub id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml">𝐩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">ℱ</ci><ci id="S3.SS3.p2.7.m7.1.1.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">\mathcal{F}_{\mathbf{p}}</annotation></semantics></math> as, <math id="S3.SS3.p2.8.m8.3" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{kd}}=||f_{\mathbf{r}}-\mathcal{F}_{\mathbf{p}}(\texttt{Crop}(\mathbf{p},\mathbf{r}))||_{1}" display="inline"><semantics id="S3.SS3.p2.8.m8.3a"><mrow id="S3.SS3.p2.8.m8.3.3" xref="S3.SS3.p2.8.m8.3.3.cmml"><msub id="S3.SS3.p2.8.m8.3.3.3" xref="S3.SS3.p2.8.m8.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.8.m8.3.3.3.2" xref="S3.SS3.p2.8.m8.3.3.3.2.cmml">ℒ</mi><mi id="S3.SS3.p2.8.m8.3.3.3.3" xref="S3.SS3.p2.8.m8.3.3.3.3.cmml">kd</mi></msub><mo id="S3.SS3.p2.8.m8.3.3.2" xref="S3.SS3.p2.8.m8.3.3.2.cmml">=</mo><msub id="S3.SS3.p2.8.m8.3.3.1" xref="S3.SS3.p2.8.m8.3.3.1.cmml"><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1" xref="S3.SS3.p2.8.m8.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.8.m8.3.3.1.1.1.2" xref="S3.SS3.p2.8.m8.3.3.1.1.2.1.cmml">‖</mo><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1.1" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.cmml"><msub id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.2.cmml">f</mi><mi id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.3" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.3.cmml">𝐫</mi></msub><mo id="S3.SS3.p2.8.m8.3.3.1.1.1.1.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.cmml">−</mo><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.cmml"><msub id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.3" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.3.cmml">𝐩</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.2a.cmml">Crop</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.3.2.1" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml">𝐩</mi><mo id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p2.8.m8.2.2" xref="S3.SS3.p2.8.m8.2.2.cmml">𝐫</mi><mo stretchy="false" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.SS3.p2.8.m8.3.3.1.1.1.3" xref="S3.SS3.p2.8.m8.3.3.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS3.p2.8.m8.3.3.1.3" xref="S3.SS3.p2.8.m8.3.3.1.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.3b"><apply id="S3.SS3.p2.8.m8.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3"><eq id="S3.SS3.p2.8.m8.3.3.2.cmml" xref="S3.SS3.p2.8.m8.3.3.2"></eq><apply id="S3.SS3.p2.8.m8.3.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.3.3.3.1.cmml" xref="S3.SS3.p2.8.m8.3.3.3">subscript</csymbol><ci id="S3.SS3.p2.8.m8.3.3.3.2.cmml" xref="S3.SS3.p2.8.m8.3.3.3.2">ℒ</ci><ci id="S3.SS3.p2.8.m8.3.3.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3">kd</ci></apply><apply id="S3.SS3.p2.8.m8.3.3.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.3.3.1.2.cmml" xref="S3.SS3.p2.8.m8.3.3.1">subscript</csymbol><apply id="S3.SS3.p2.8.m8.3.3.1.1.2.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.8.m8.3.3.1.1.2.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.2">norm</csymbol><apply id="S3.SS3.p2.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1"><minus id="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.2"></minus><apply id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.2">𝑓</ci><ci id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.3">𝐫</ci></apply><apply id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1"><times id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.2"></times><apply id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.2">ℱ</ci><ci id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.3.3">𝐩</ci></apply><apply id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1"><times id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.1"></times><ci id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.2">Crop</mtext></ci><interval closure="open" id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.1.1.1.3.2"><ci id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">𝐩</ci><ci id="S3.SS3.p2.8.m8.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2">𝐫</ci></interval></apply></apply></apply></apply><cn type="integer" id="S3.SS3.p2.8.m8.3.3.1.3.cmml" xref="S3.SS3.p2.8.m8.3.3.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.3c">\mathcal{L}_{\mathrm{kd}}=||f_{\mathbf{r}}-\mathcal{F}_{\mathbf{p}}(\texttt{Crop}(\mathbf{p},\mathbf{r}))||_{1}</annotation></semantics></math>. The final loss is,</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.3" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{tot}}=\underbrace{\mathcal{L}_{\mathrm{ws}}+\sum_{k=1}^{K}\mathcal{L}_{\mathrm{ref}}^{k}}_{\lx@cref{creftype~refnum}{eq: ws}\text{ and }\lx@cref{creftype~refnum}{eq: ref}}+\lambda\underbrace{||f_{\mathbf{r}}-\mathcal{F}_{\mathbf{p}}(\texttt{Crop}(\mathbf{p},\mathbf{r}))||_{1}}_{\mathcal{L}_{\mathrm{kd}}}" display="block"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.4" xref="S3.E8.m1.3.4.cmml"><msub id="S3.E8.m1.3.4.2" xref="S3.E8.m1.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.3.4.2.2" xref="S3.E8.m1.3.4.2.2.cmml">ℒ</mi><mi id="S3.E8.m1.3.4.2.3" xref="S3.E8.m1.3.4.2.3.cmml">tot</mi></msub><mo id="S3.E8.m1.3.4.1" xref="S3.E8.m1.3.4.1.cmml">=</mo><mrow id="S3.E8.m1.3.4.3" xref="S3.E8.m1.3.4.3.cmml"><munder id="S3.E8.m1.3.4.3.2" xref="S3.E8.m1.3.4.3.2.cmml"><munder accentunder="true" id="S3.E8.m1.3.4.3.2.2" xref="S3.E8.m1.3.4.3.2.2.cmml"><mrow id="S3.E8.m1.3.4.3.2.2.2" xref="S3.E8.m1.3.4.3.2.2.2.cmml"><msub id="S3.E8.m1.3.4.3.2.2.2.2" xref="S3.E8.m1.3.4.3.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.3.4.3.2.2.2.2.2" xref="S3.E8.m1.3.4.3.2.2.2.2.2.cmml">ℒ</mi><mi id="S3.E8.m1.3.4.3.2.2.2.2.3" xref="S3.E8.m1.3.4.3.2.2.2.2.3.cmml">ws</mi></msub><mo rspace="0.055em" id="S3.E8.m1.3.4.3.2.2.2.1" xref="S3.E8.m1.3.4.3.2.2.2.1.cmml">+</mo><mrow id="S3.E8.m1.3.4.3.2.2.2.3" xref="S3.E8.m1.3.4.3.2.2.2.3.cmml"><munderover id="S3.E8.m1.3.4.3.2.2.2.3.1" xref="S3.E8.m1.3.4.3.2.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E8.m1.3.4.3.2.2.2.3.1.2.2" xref="S3.E8.m1.3.4.3.2.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.3.4.3.2.2.2.3.1.2.3" xref="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.cmml"><mi id="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.2" xref="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.2.cmml">k</mi><mo id="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.1" xref="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.3" xref="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.3.4.3.2.2.2.3.1.3" xref="S3.E8.m1.3.4.3.2.2.2.3.1.3.cmml">K</mi></munderover><msubsup id="S3.E8.m1.3.4.3.2.2.2.3.2" xref="S3.E8.m1.3.4.3.2.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.3.4.3.2.2.2.3.2.2.2" xref="S3.E8.m1.3.4.3.2.2.2.3.2.2.2.cmml">ℒ</mi><mi id="S3.E8.m1.3.4.3.2.2.2.3.2.2.3" xref="S3.E8.m1.3.4.3.2.2.2.3.2.2.3.cmml">ref</mi><mi id="S3.E8.m1.3.4.3.2.2.2.3.2.3" xref="S3.E8.m1.3.4.3.2.2.2.3.2.3.cmml">k</mi></msubsup></mrow></mrow><mo id="S3.E8.m1.3.4.3.2.2.1" xref="S3.E8.m1.3.4.3.2.2.1.cmml">⏟</mo></munder><mrow id="S3.E8.m1.3.4.3.2.3" xref="S3.E8.m1.3.4.3.2.3j.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E8.m1.3.4.3.2.3a" xref="S3.E8.m1.3.4.3.2.3j.cmml"><a href="#S3.E5" title="In 3.2 Weakly Supervised Object Detection ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref ltx_font_italic" style="font-size:70%;"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">5</span></a></mtext><mtext id="S3.E8.m1.3.4.3.2.3e" xref="S3.E8.m1.3.4.3.2.3j.cmml"> and </mtext><mtext class="ltx_mathvariant_italic" id="S3.E8.m1.3.4.3.2.3f" xref="S3.E8.m1.3.4.3.2.3j.cmml"><a href="#S3.E6" title="In 3.2 Weakly Supervised Object Detection ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref ltx_font_italic" style="font-size:70%;"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">6</span></a></mtext></mrow></munder><mo id="S3.E8.m1.3.4.3.1" xref="S3.E8.m1.3.4.3.1.cmml">+</mo><mrow id="S3.E8.m1.3.4.3.3" xref="S3.E8.m1.3.4.3.3.cmml"><mi id="S3.E8.m1.3.4.3.3.2" xref="S3.E8.m1.3.4.3.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.4.3.3.1" xref="S3.E8.m1.3.4.3.3.1.cmml">​</mo><munder id="S3.E8.m1.3.4.3.3.3" xref="S3.E8.m1.3.4.3.3.3.cmml"><munder accentunder="true" id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml"><msub id="S3.E8.m1.3.3.3" xref="S3.E8.m1.3.3.3.cmml"><mrow id="S3.E8.m1.3.3.3.3.1" xref="S3.E8.m1.3.3.3.3.2.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.3.3.1.2" xref="S3.E8.m1.3.3.3.3.2.1.cmml">‖</mo><mrow id="S3.E8.m1.3.3.3.3.1.1" xref="S3.E8.m1.3.3.3.3.1.1.cmml"><msub id="S3.E8.m1.3.3.3.3.1.1.3" xref="S3.E8.m1.3.3.3.3.1.1.3.cmml"><mi id="S3.E8.m1.3.3.3.3.1.1.3.2" xref="S3.E8.m1.3.3.3.3.1.1.3.2.cmml">f</mi><mi id="S3.E8.m1.3.3.3.3.1.1.3.3" xref="S3.E8.m1.3.3.3.3.1.1.3.3.cmml">𝐫</mi></msub><mo id="S3.E8.m1.3.3.3.3.1.1.2" xref="S3.E8.m1.3.3.3.3.1.1.2.cmml">−</mo><mrow id="S3.E8.m1.3.3.3.3.1.1.1" xref="S3.E8.m1.3.3.3.3.1.1.1.cmml"><msub id="S3.E8.m1.3.3.3.3.1.1.1.3" xref="S3.E8.m1.3.3.3.3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.3.3.3.3.1.1.1.3.2" xref="S3.E8.m1.3.3.3.3.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E8.m1.3.3.3.3.1.1.1.3.3" xref="S3.E8.m1.3.3.3.3.1.1.1.3.3.cmml">𝐩</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.3.3.3.1.1.1.2" xref="S3.E8.m1.3.3.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.3.3.3.3.1.1.1.1.1" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.3.3.1.1.1.1.1.2" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.2" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.2a.cmml">Crop</mtext><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.3.2" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.3.2.1" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">𝐩</mi><mo id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.3.2.2" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">𝐫</mi><mo stretchy="false" id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.3.2.3" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E8.m1.3.3.3.3.1.1.1.1.1.3" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E8.m1.3.3.3.3.1.3" xref="S3.E8.m1.3.3.3.3.2.1.cmml">‖</mo></mrow><mn id="S3.E8.m1.3.3.3.5" xref="S3.E8.m1.3.3.3.5.cmml">1</mn></msub><mo id="S3.E8.m1.3.3.4" xref="S3.E8.m1.3.3.4.cmml">⏟</mo></munder><msub id="S3.E8.m1.3.4.3.3.3.2" xref="S3.E8.m1.3.4.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.3.4.3.3.3.2.2" xref="S3.E8.m1.3.4.3.3.3.2.2.cmml">ℒ</mi><mi id="S3.E8.m1.3.4.3.3.3.2.3" xref="S3.E8.m1.3.4.3.3.3.2.3.cmml">kd</mi></msub></munder></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.4.cmml" xref="S3.E8.m1.3.4"><eq id="S3.E8.m1.3.4.1.cmml" xref="S3.E8.m1.3.4.1"></eq><apply id="S3.E8.m1.3.4.2.cmml" xref="S3.E8.m1.3.4.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.2.1.cmml" xref="S3.E8.m1.3.4.2">subscript</csymbol><ci id="S3.E8.m1.3.4.2.2.cmml" xref="S3.E8.m1.3.4.2.2">ℒ</ci><ci id="S3.E8.m1.3.4.2.3.cmml" xref="S3.E8.m1.3.4.2.3">tot</ci></apply><apply id="S3.E8.m1.3.4.3.cmml" xref="S3.E8.m1.3.4.3"><plus id="S3.E8.m1.3.4.3.1.cmml" xref="S3.E8.m1.3.4.3.1"></plus><apply id="S3.E8.m1.3.4.3.2.cmml" xref="S3.E8.m1.3.4.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.2.1.cmml" xref="S3.E8.m1.3.4.3.2">subscript</csymbol><apply id="S3.E8.m1.3.4.3.2.2.cmml" xref="S3.E8.m1.3.4.3.2.2"><ci id="S3.E8.m1.3.4.3.2.2.1.cmml" xref="S3.E8.m1.3.4.3.2.2.1">⏟</ci><apply id="S3.E8.m1.3.4.3.2.2.2.cmml" xref="S3.E8.m1.3.4.3.2.2.2"><plus id="S3.E8.m1.3.4.3.2.2.2.1.cmml" xref="S3.E8.m1.3.4.3.2.2.2.1"></plus><apply id="S3.E8.m1.3.4.3.2.2.2.2.cmml" xref="S3.E8.m1.3.4.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.2.2.2.2.1.cmml" xref="S3.E8.m1.3.4.3.2.2.2.2">subscript</csymbol><ci id="S3.E8.m1.3.4.3.2.2.2.2.2.cmml" xref="S3.E8.m1.3.4.3.2.2.2.2.2">ℒ</ci><ci id="S3.E8.m1.3.4.3.2.2.2.2.3.cmml" xref="S3.E8.m1.3.4.3.2.2.2.2.3">ws</ci></apply><apply id="S3.E8.m1.3.4.3.2.2.2.3.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3"><apply id="S3.E8.m1.3.4.3.2.2.2.3.1.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.2.2.2.3.1.1.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.1">superscript</csymbol><apply id="S3.E8.m1.3.4.3.2.2.2.3.1.2.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.2.2.2.3.1.2.1.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.1">subscript</csymbol><sum id="S3.E8.m1.3.4.3.2.2.2.3.1.2.2.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.1.2.2"></sum><apply id="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.1.2.3"><eq id="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.1.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.1"></eq><ci id="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.2.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.3.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.3.4.3.2.2.2.3.1.3.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.1.3">𝐾</ci></apply><apply id="S3.E8.m1.3.4.3.2.2.2.3.2.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.2.2.2.3.2.1.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.2">superscript</csymbol><apply id="S3.E8.m1.3.4.3.2.2.2.3.2.2.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.2.2.2.3.2.2.1.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.2">subscript</csymbol><ci id="S3.E8.m1.3.4.3.2.2.2.3.2.2.2.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.2.2.2">ℒ</ci><ci id="S3.E8.m1.3.4.3.2.2.2.3.2.2.3.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.2.2.3">ref</ci></apply><ci id="S3.E8.m1.3.4.3.2.2.2.3.2.3.cmml" xref="S3.E8.m1.3.4.3.2.2.2.3.2.3">𝑘</ci></apply></apply></apply></apply><ci id="S3.E8.m1.3.4.3.2.3j.cmml" xref="S3.E8.m1.3.4.3.2.3"><mrow id="S3.E8.m1.3.4.3.2.3.cmml" xref="S3.E8.m1.3.4.3.2.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S3.E8.m1.3.4.3.2.3a.cmml" xref="S3.E8.m1.3.4.3.2.3"><a href="#S3.E5" title="In 3.2 Weakly Supervised Object Detection ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref ltx_font_italic" style="font-size:70%;"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">5</span></a></mtext><mtext mathsize="70%" id="S3.E8.m1.3.4.3.2.3e.cmml" xref="S3.E8.m1.3.4.3.2.3"> and </mtext><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S3.E8.m1.3.4.3.2.3f.cmml" xref="S3.E8.m1.3.4.3.2.3"><a href="#S3.E6" title="In 3.2 Weakly Supervised Object Detection ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref ltx_font_italic" style="font-size:70%;"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">6</span></a></mtext></mrow></ci></apply><apply id="S3.E8.m1.3.4.3.3.cmml" xref="S3.E8.m1.3.4.3.3"><times id="S3.E8.m1.3.4.3.3.1.cmml" xref="S3.E8.m1.3.4.3.3.1"></times><ci id="S3.E8.m1.3.4.3.3.2.cmml" xref="S3.E8.m1.3.4.3.3.2">𝜆</ci><apply id="S3.E8.m1.3.4.3.3.3.cmml" xref="S3.E8.m1.3.4.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.3.3.1.cmml" xref="S3.E8.m1.3.4.3.3.3">subscript</csymbol><apply id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3"><ci id="S3.E8.m1.3.3.4.cmml" xref="S3.E8.m1.3.3.4">⏟</ci><apply id="S3.E8.m1.3.3.3.cmml" xref="S3.E8.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.3.4.cmml" xref="S3.E8.m1.3.3.3">subscript</csymbol><apply id="S3.E8.m1.3.3.3.3.2.cmml" xref="S3.E8.m1.3.3.3.3.1"><csymbol cd="latexml" id="S3.E8.m1.3.3.3.3.2.1.cmml" xref="S3.E8.m1.3.3.3.3.1.2">norm</csymbol><apply id="S3.E8.m1.3.3.3.3.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1"><minus id="S3.E8.m1.3.3.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.3.3.1.1.2"></minus><apply id="S3.E8.m1.3.3.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.3.3.1.1.3.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S3.E8.m1.3.3.3.3.1.1.3.2.cmml" xref="S3.E8.m1.3.3.3.3.1.1.3.2">𝑓</ci><ci id="S3.E8.m1.3.3.3.3.1.1.3.3.cmml" xref="S3.E8.m1.3.3.3.3.1.1.3.3">𝐫</ci></apply><apply id="S3.E8.m1.3.3.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1"><times id="S3.E8.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1.2"></times><apply id="S3.E8.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.3.3.1.1.1.3.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.3.3.3.3.1.1.1.3.2.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1.3.2">ℱ</ci><ci id="S3.E8.m1.3.3.3.3.1.1.1.3.3.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1.3.3">𝐩</ci></apply><apply id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1"><times id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.1"></times><ci id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.2a.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.2">Crop</mtext></ci><interval closure="open" id="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1.1.1.1.3.2"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝐩</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝐫</ci></interval></apply></apply></apply></apply><cn type="integer" id="S3.E8.m1.3.3.3.5.cmml" xref="S3.E8.m1.3.3.3.5">1</cn></apply></apply><apply id="S3.E8.m1.3.4.3.3.3.2.cmml" xref="S3.E8.m1.3.4.3.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.3.3.2.1.cmml" xref="S3.E8.m1.3.4.3.3.3.2">subscript</csymbol><ci id="S3.E8.m1.3.4.3.3.3.2.2.cmml" xref="S3.E8.m1.3.4.3.3.3.2.2">ℒ</ci><ci id="S3.E8.m1.3.4.3.3.3.2.3.cmml" xref="S3.E8.m1.3.4.3.3.3.2.3">kd</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">\mathcal{L}_{\mathrm{tot}}=\underbrace{\mathcal{L}_{\mathrm{ws}}+\sum_{k=1}^{K}\mathcal{L}_{\mathrm{ref}}^{k}}_{\lx@cref{creftype~refnum}{eq: ws}\text{ and }\lx@cref{creftype~refnum}{eq: ref}}+\lambda\underbrace{||f_{\mathbf{r}}-\mathcal{F}_{\mathbf{p}}(\texttt{Crop}(\mathbf{p},\mathbf{r}))||_{1}}_{\mathcal{L}_{\mathrm{kd}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.1" class="ltx_p">where the hyperparameter <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\lambda=1" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">λ</mi><mo id="S3.SS3.p3.1.m1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><eq id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1"></eq><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝜆</ci><cn type="integer" id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\lambda=1</annotation></semantics></math>. Although, in theory, we can use our baseline SBIR (in <a href="#S3.SS1" title="3.1 Background ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">3.1</span></a>), training object detection requires learning a generalised (out-of-vocab) SBIR for category-level and fine-grained sketch/photo matching under wide variations like illumination, complex background, occlusions, unseen categories etc.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2303.15149/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="212" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.8.4.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S3.F4.6.3" class="ltx_text" style="font-size:90%;">The object detection modules <math id="S3.F4.4.1.m1.5" class="ltx_Math" alttext="\{\mathcal{F}_{d},\mathcal{P},\phi_{cls},\phi_{det},\phi_{cls}^{*}\}" display="inline"><semantics id="S3.F4.4.1.m1.5b"><mrow id="S3.F4.4.1.m1.5.5.4" xref="S3.F4.4.1.m1.5.5.5.cmml"><mo stretchy="false" id="S3.F4.4.1.m1.5.5.4.5" xref="S3.F4.4.1.m1.5.5.5.cmml">{</mo><msub id="S3.F4.4.1.m1.2.2.1.1" xref="S3.F4.4.1.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F4.4.1.m1.2.2.1.1.2" xref="S3.F4.4.1.m1.2.2.1.1.2.cmml">ℱ</mi><mi id="S3.F4.4.1.m1.2.2.1.1.3" xref="S3.F4.4.1.m1.2.2.1.1.3.cmml">d</mi></msub><mo id="S3.F4.4.1.m1.5.5.4.6" xref="S3.F4.4.1.m1.5.5.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.F4.4.1.m1.1.1" xref="S3.F4.4.1.m1.1.1.cmml">𝒫</mi><mo id="S3.F4.4.1.m1.5.5.4.7" xref="S3.F4.4.1.m1.5.5.5.cmml">,</mo><msub id="S3.F4.4.1.m1.3.3.2.2" xref="S3.F4.4.1.m1.3.3.2.2.cmml"><mi id="S3.F4.4.1.m1.3.3.2.2.2" xref="S3.F4.4.1.m1.3.3.2.2.2.cmml">ϕ</mi><mrow id="S3.F4.4.1.m1.3.3.2.2.3" xref="S3.F4.4.1.m1.3.3.2.2.3.cmml"><mi id="S3.F4.4.1.m1.3.3.2.2.3.2" xref="S3.F4.4.1.m1.3.3.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.F4.4.1.m1.3.3.2.2.3.1" xref="S3.F4.4.1.m1.3.3.2.2.3.1.cmml">​</mo><mi id="S3.F4.4.1.m1.3.3.2.2.3.3" xref="S3.F4.4.1.m1.3.3.2.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.F4.4.1.m1.3.3.2.2.3.1b" xref="S3.F4.4.1.m1.3.3.2.2.3.1.cmml">​</mo><mi id="S3.F4.4.1.m1.3.3.2.2.3.4" xref="S3.F4.4.1.m1.3.3.2.2.3.4.cmml">s</mi></mrow></msub><mo id="S3.F4.4.1.m1.5.5.4.8" xref="S3.F4.4.1.m1.5.5.5.cmml">,</mo><msub id="S3.F4.4.1.m1.4.4.3.3" xref="S3.F4.4.1.m1.4.4.3.3.cmml"><mi id="S3.F4.4.1.m1.4.4.3.3.2" xref="S3.F4.4.1.m1.4.4.3.3.2.cmml">ϕ</mi><mrow id="S3.F4.4.1.m1.4.4.3.3.3" xref="S3.F4.4.1.m1.4.4.3.3.3.cmml"><mi id="S3.F4.4.1.m1.4.4.3.3.3.2" xref="S3.F4.4.1.m1.4.4.3.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.F4.4.1.m1.4.4.3.3.3.1" xref="S3.F4.4.1.m1.4.4.3.3.3.1.cmml">​</mo><mi id="S3.F4.4.1.m1.4.4.3.3.3.3" xref="S3.F4.4.1.m1.4.4.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.F4.4.1.m1.4.4.3.3.3.1b" xref="S3.F4.4.1.m1.4.4.3.3.3.1.cmml">​</mo><mi id="S3.F4.4.1.m1.4.4.3.3.3.4" xref="S3.F4.4.1.m1.4.4.3.3.3.4.cmml">t</mi></mrow></msub><mo id="S3.F4.4.1.m1.5.5.4.9" xref="S3.F4.4.1.m1.5.5.5.cmml">,</mo><msubsup id="S3.F4.4.1.m1.5.5.4.4" xref="S3.F4.4.1.m1.5.5.4.4.cmml"><mi id="S3.F4.4.1.m1.5.5.4.4.2.2" xref="S3.F4.4.1.m1.5.5.4.4.2.2.cmml">ϕ</mi><mrow id="S3.F4.4.1.m1.5.5.4.4.2.3" xref="S3.F4.4.1.m1.5.5.4.4.2.3.cmml"><mi id="S3.F4.4.1.m1.5.5.4.4.2.3.2" xref="S3.F4.4.1.m1.5.5.4.4.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.F4.4.1.m1.5.5.4.4.2.3.1" xref="S3.F4.4.1.m1.5.5.4.4.2.3.1.cmml">​</mo><mi id="S3.F4.4.1.m1.5.5.4.4.2.3.3" xref="S3.F4.4.1.m1.5.5.4.4.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.F4.4.1.m1.5.5.4.4.2.3.1b" xref="S3.F4.4.1.m1.5.5.4.4.2.3.1.cmml">​</mo><mi id="S3.F4.4.1.m1.5.5.4.4.2.3.4" xref="S3.F4.4.1.m1.5.5.4.4.2.3.4.cmml">s</mi></mrow><mo id="S3.F4.4.1.m1.5.5.4.4.3" xref="S3.F4.4.1.m1.5.5.4.4.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S3.F4.4.1.m1.5.5.4.10" xref="S3.F4.4.1.m1.5.5.5.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.4.1.m1.5c"><set id="S3.F4.4.1.m1.5.5.5.cmml" xref="S3.F4.4.1.m1.5.5.4"><apply id="S3.F4.4.1.m1.2.2.1.1.cmml" xref="S3.F4.4.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.F4.4.1.m1.2.2.1.1.1.cmml" xref="S3.F4.4.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.F4.4.1.m1.2.2.1.1.2.cmml" xref="S3.F4.4.1.m1.2.2.1.1.2">ℱ</ci><ci id="S3.F4.4.1.m1.2.2.1.1.3.cmml" xref="S3.F4.4.1.m1.2.2.1.1.3">𝑑</ci></apply><ci id="S3.F4.4.1.m1.1.1.cmml" xref="S3.F4.4.1.m1.1.1">𝒫</ci><apply id="S3.F4.4.1.m1.3.3.2.2.cmml" xref="S3.F4.4.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.F4.4.1.m1.3.3.2.2.1.cmml" xref="S3.F4.4.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.F4.4.1.m1.3.3.2.2.2.cmml" xref="S3.F4.4.1.m1.3.3.2.2.2">italic-ϕ</ci><apply id="S3.F4.4.1.m1.3.3.2.2.3.cmml" xref="S3.F4.4.1.m1.3.3.2.2.3"><times id="S3.F4.4.1.m1.3.3.2.2.3.1.cmml" xref="S3.F4.4.1.m1.3.3.2.2.3.1"></times><ci id="S3.F4.4.1.m1.3.3.2.2.3.2.cmml" xref="S3.F4.4.1.m1.3.3.2.2.3.2">𝑐</ci><ci id="S3.F4.4.1.m1.3.3.2.2.3.3.cmml" xref="S3.F4.4.1.m1.3.3.2.2.3.3">𝑙</ci><ci id="S3.F4.4.1.m1.3.3.2.2.3.4.cmml" xref="S3.F4.4.1.m1.3.3.2.2.3.4">𝑠</ci></apply></apply><apply id="S3.F4.4.1.m1.4.4.3.3.cmml" xref="S3.F4.4.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.F4.4.1.m1.4.4.3.3.1.cmml" xref="S3.F4.4.1.m1.4.4.3.3">subscript</csymbol><ci id="S3.F4.4.1.m1.4.4.3.3.2.cmml" xref="S3.F4.4.1.m1.4.4.3.3.2">italic-ϕ</ci><apply id="S3.F4.4.1.m1.4.4.3.3.3.cmml" xref="S3.F4.4.1.m1.4.4.3.3.3"><times id="S3.F4.4.1.m1.4.4.3.3.3.1.cmml" xref="S3.F4.4.1.m1.4.4.3.3.3.1"></times><ci id="S3.F4.4.1.m1.4.4.3.3.3.2.cmml" xref="S3.F4.4.1.m1.4.4.3.3.3.2">𝑑</ci><ci id="S3.F4.4.1.m1.4.4.3.3.3.3.cmml" xref="S3.F4.4.1.m1.4.4.3.3.3.3">𝑒</ci><ci id="S3.F4.4.1.m1.4.4.3.3.3.4.cmml" xref="S3.F4.4.1.m1.4.4.3.3.3.4">𝑡</ci></apply></apply><apply id="S3.F4.4.1.m1.5.5.4.4.cmml" xref="S3.F4.4.1.m1.5.5.4.4"><csymbol cd="ambiguous" id="S3.F4.4.1.m1.5.5.4.4.1.cmml" xref="S3.F4.4.1.m1.5.5.4.4">superscript</csymbol><apply id="S3.F4.4.1.m1.5.5.4.4.2.cmml" xref="S3.F4.4.1.m1.5.5.4.4"><csymbol cd="ambiguous" id="S3.F4.4.1.m1.5.5.4.4.2.1.cmml" xref="S3.F4.4.1.m1.5.5.4.4">subscript</csymbol><ci id="S3.F4.4.1.m1.5.5.4.4.2.2.cmml" xref="S3.F4.4.1.m1.5.5.4.4.2.2">italic-ϕ</ci><apply id="S3.F4.4.1.m1.5.5.4.4.2.3.cmml" xref="S3.F4.4.1.m1.5.5.4.4.2.3"><times id="S3.F4.4.1.m1.5.5.4.4.2.3.1.cmml" xref="S3.F4.4.1.m1.5.5.4.4.2.3.1"></times><ci id="S3.F4.4.1.m1.5.5.4.4.2.3.2.cmml" xref="S3.F4.4.1.m1.5.5.4.4.2.3.2">𝑐</ci><ci id="S3.F4.4.1.m1.5.5.4.4.2.3.3.cmml" xref="S3.F4.4.1.m1.5.5.4.4.2.3.3">𝑙</ci><ci id="S3.F4.4.1.m1.5.5.4.4.2.3.4.cmml" xref="S3.F4.4.1.m1.5.5.4.4.2.3.4">𝑠</ci></apply></apply><times id="S3.F4.4.1.m1.5.5.4.4.3.cmml" xref="S3.F4.4.1.m1.5.5.4.4.3"></times></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.4.1.m1.5d">\{\mathcal{F}_{d},\mathcal{P},\phi_{cls},\phi_{det},\phi_{cls}^{*}\}</annotation></semantics></math> are learned using pre-trained sketch (<math id="S3.F4.5.2.m2.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{s}}" display="inline"><semantics id="S3.F4.5.2.m2.1b"><msub id="S3.F4.5.2.m2.1.1" xref="S3.F4.5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F4.5.2.m2.1.1.2" xref="S3.F4.5.2.m2.1.1.2.cmml">ℱ</mi><mi id="S3.F4.5.2.m2.1.1.3" xref="S3.F4.5.2.m2.1.1.3.cmml">𝐬</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.5.2.m2.1c"><apply id="S3.F4.5.2.m2.1.1.cmml" xref="S3.F4.5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.F4.5.2.m2.1.1.1.cmml" xref="S3.F4.5.2.m2.1.1">subscript</csymbol><ci id="S3.F4.5.2.m2.1.1.2.cmml" xref="S3.F4.5.2.m2.1.1.2">ℱ</ci><ci id="S3.F4.5.2.m2.1.1.3.cmml" xref="S3.F4.5.2.m2.1.1.3">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.5.2.m2.1d">\mathcal{F}_{\mathbf{s}}</annotation></semantics></math>) and photo (<math id="S3.F4.6.3.m3.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{p}}" display="inline"><semantics id="S3.F4.6.3.m3.1b"><msub id="S3.F4.6.3.m3.1.1" xref="S3.F4.6.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F4.6.3.m3.1.1.2" xref="S3.F4.6.3.m3.1.1.2.cmml">ℱ</mi><mi id="S3.F4.6.3.m3.1.1.3" xref="S3.F4.6.3.m3.1.1.3.cmml">𝐩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.6.3.m3.1c"><apply id="S3.F4.6.3.m3.1.1.cmml" xref="S3.F4.6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.F4.6.3.m3.1.1.1.cmml" xref="S3.F4.6.3.m3.1.1">subscript</csymbol><ci id="S3.F4.6.3.m3.1.1.2.cmml" xref="S3.F4.6.3.m3.1.1.2">ℱ</ci><ci id="S3.F4.6.3.m3.1.1.3.cmml" xref="S3.F4.6.3.m3.1.1.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.6.3.m3.1d">\mathcal{F}_{\mathbf{p}}</annotation></semantics></math>) encoders.</span></figcaption>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Prompt Learning for Generalised SBIR</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.12" class="ltx_p">To train object detection using SBIR with high generalisation and open-vocab capabilities, we introduce prompt learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib109" title="" class="ltx_ref">109</a>]</cite> using CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> for SBIR (both category-level and cross-category fine-grained). CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> consists an image and text encoder (e.g., ViT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, or ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>) trained on large <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="400M" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mn id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">400</mn><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><times id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1"></times><cn type="integer" id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">400</cn><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">400M</annotation></semantics></math> text/image pairs. This leads to a highly generalisable model that works zero-shot across multiple tasks and datasets. However, adapting CLIP for sketches is tricky since naive fine-tuning leads to model collapse. Hence, we use prompt learning, a set of <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mi id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">P</annotation></semantics></math> learnable vector <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{v}_{\mathbf{s}}\in\mathbb{R}^{P\times 768}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mrow id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><msub id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2.2" xref="S3.SS4.p1.3.m3.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS4.p1.3.m3.1.1.2.3" xref="S3.SS4.p1.3.m3.1.1.2.3.cmml">𝐬</mi></msub><mo id="S3.SS4.p1.3.m3.1.1.1" xref="S3.SS4.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml"><mi id="S3.SS4.p1.3.m3.1.1.3.2" xref="S3.SS4.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.3.m3.1.1.3.3" xref="S3.SS4.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS4.p1.3.m3.1.1.3.3.2" xref="S3.SS4.p1.3.m3.1.1.3.3.2.cmml">P</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.3.m3.1.1.3.3.1" xref="S3.SS4.p1.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.3.m3.1.1.3.3.3" xref="S3.SS4.p1.3.m3.1.1.3.3.3.cmml">768</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><in id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1.1"></in><apply id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.2.1.cmml" xref="S3.SS4.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2.2">𝐯</ci><ci id="S3.SS4.p1.3.m3.1.1.2.3.cmml" xref="S3.SS4.p1.3.m3.1.1.2.3">𝐬</ci></apply><apply id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.3.1.cmml" xref="S3.SS4.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.3.2.cmml" xref="S3.SS4.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.3.m3.1.1.3.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3.3"><times id="S3.SS4.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS4.p1.3.m3.1.1.3.3.1"></times><ci id="S3.SS4.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS4.p1.3.m3.1.1.3.3.2">𝑃</ci><cn type="integer" id="S3.SS4.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3.3.3">768</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\mathbf{v}_{\mathbf{s}}\in\mathbb{R}^{P\times 768}</annotation></semantics></math> for sketch and <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{v}_{\mathbf{p}}\in\mathbb{R}^{P\times 768}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mrow id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><msub id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2.2" xref="S3.SS4.p1.4.m4.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS4.p1.4.m4.1.1.2.3" xref="S3.SS4.p1.4.m4.1.1.2.3.cmml">𝐩</mi></msub><mo id="S3.SS4.p1.4.m4.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml"><mi id="S3.SS4.p1.4.m4.1.1.3.2" xref="S3.SS4.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.4.m4.1.1.3.3" xref="S3.SS4.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS4.p1.4.m4.1.1.3.3.2" xref="S3.SS4.p1.4.m4.1.1.3.3.2.cmml">P</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.4.m4.1.1.3.3.1" xref="S3.SS4.p1.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.4.m4.1.1.3.3.3" xref="S3.SS4.p1.4.m4.1.1.3.3.3.cmml">768</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><in id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1"></in><apply id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.2.1.cmml" xref="S3.SS4.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2.2">𝐯</ci><ci id="S3.SS4.p1.4.m4.1.1.2.3.cmml" xref="S3.SS4.p1.4.m4.1.1.2.3">𝐩</ci></apply><apply id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.3.2.cmml" xref="S3.SS4.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.4.m4.1.1.3.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3"><times id="S3.SS4.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3.1"></times><ci id="S3.SS4.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3.2">𝑃</ci><cn type="integer" id="S3.SS4.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3.3">768</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\mathbf{v}_{\mathbf{p}}\in\mathbb{R}^{P\times 768}</annotation></semantics></math> for photo, injected into the first layer of ViT to induce CLIP to learn downstream sketch/photo distribution. Importantly, prompting CLIP preserves the desired generalisation ability <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib109" title="" class="ltx_ref">109</a>]</cite> since the knowledge learned by CLIP is distilled into prompt’s weights while keeping the ViT weights frozen. Our new sketch encoder is defined by adapting CLIP’s image encoder using sketch prompt (<math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{v}_{\mathbf{s}}" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><msub id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.2" xref="S3.SS4.p1.5.m5.1.1.2.cmml">𝐯</mi><mi id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml">𝐬</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2">𝐯</ci><ci id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">\mathbf{v}_{\mathbf{s}}</annotation></semantics></math>) as, <math id="S3.SS4.p1.6.m6.3" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{s}}(\cdot)=\mathcal{F}_{\mathrm{clip}}(\cdot,\mathbf{v}_{\mathbf{s}})" display="inline"><semantics id="S3.SS4.p1.6.m6.3a"><mrow id="S3.SS4.p1.6.m6.3.3" xref="S3.SS4.p1.6.m6.3.3.cmml"><mrow id="S3.SS4.p1.6.m6.3.3.3" xref="S3.SS4.p1.6.m6.3.3.3.cmml"><msub id="S3.SS4.p1.6.m6.3.3.3.2" xref="S3.SS4.p1.6.m6.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.6.m6.3.3.3.2.2" xref="S3.SS4.p1.6.m6.3.3.3.2.2.cmml">ℱ</mi><mi id="S3.SS4.p1.6.m6.3.3.3.2.3" xref="S3.SS4.p1.6.m6.3.3.3.2.3.cmml">𝐬</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m6.3.3.3.1" xref="S3.SS4.p1.6.m6.3.3.3.1.cmml">​</mo><mrow id="S3.SS4.p1.6.m6.3.3.3.3.2" xref="S3.SS4.p1.6.m6.3.3.3.cmml"><mo stretchy="false" id="S3.SS4.p1.6.m6.3.3.3.3.2.1" xref="S3.SS4.p1.6.m6.3.3.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS4.p1.6.m6.3.3.3.3.2.2" xref="S3.SS4.p1.6.m6.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p1.6.m6.3.3.2" xref="S3.SS4.p1.6.m6.3.3.2.cmml">=</mo><mrow id="S3.SS4.p1.6.m6.3.3.1" xref="S3.SS4.p1.6.m6.3.3.1.cmml"><msub id="S3.SS4.p1.6.m6.3.3.1.3" xref="S3.SS4.p1.6.m6.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.6.m6.3.3.1.3.2" xref="S3.SS4.p1.6.m6.3.3.1.3.2.cmml">ℱ</mi><mi id="S3.SS4.p1.6.m6.3.3.1.3.3" xref="S3.SS4.p1.6.m6.3.3.1.3.3.cmml">clip</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m6.3.3.1.2" xref="S3.SS4.p1.6.m6.3.3.1.2.cmml">​</mo><mrow id="S3.SS4.p1.6.m6.3.3.1.1.1" xref="S3.SS4.p1.6.m6.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.6.m6.3.3.1.1.1.2" xref="S3.SS4.p1.6.m6.3.3.1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m6.2.2" xref="S3.SS4.p1.6.m6.2.2.cmml">⋅</mo><mo id="S3.SS4.p1.6.m6.3.3.1.1.1.3" xref="S3.SS4.p1.6.m6.3.3.1.1.2.cmml">,</mo><msub id="S3.SS4.p1.6.m6.3.3.1.1.1.1" xref="S3.SS4.p1.6.m6.3.3.1.1.1.1.cmml"><mi id="S3.SS4.p1.6.m6.3.3.1.1.1.1.2" xref="S3.SS4.p1.6.m6.3.3.1.1.1.1.2.cmml">𝐯</mi><mi id="S3.SS4.p1.6.m6.3.3.1.1.1.1.3" xref="S3.SS4.p1.6.m6.3.3.1.1.1.1.3.cmml">𝐬</mi></msub><mo stretchy="false" id="S3.SS4.p1.6.m6.3.3.1.1.1.4" xref="S3.SS4.p1.6.m6.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.3b"><apply id="S3.SS4.p1.6.m6.3.3.cmml" xref="S3.SS4.p1.6.m6.3.3"><eq id="S3.SS4.p1.6.m6.3.3.2.cmml" xref="S3.SS4.p1.6.m6.3.3.2"></eq><apply id="S3.SS4.p1.6.m6.3.3.3.cmml" xref="S3.SS4.p1.6.m6.3.3.3"><times id="S3.SS4.p1.6.m6.3.3.3.1.cmml" xref="S3.SS4.p1.6.m6.3.3.3.1"></times><apply id="S3.SS4.p1.6.m6.3.3.3.2.cmml" xref="S3.SS4.p1.6.m6.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.3.3.3.2.1.cmml" xref="S3.SS4.p1.6.m6.3.3.3.2">subscript</csymbol><ci id="S3.SS4.p1.6.m6.3.3.3.2.2.cmml" xref="S3.SS4.p1.6.m6.3.3.3.2.2">ℱ</ci><ci id="S3.SS4.p1.6.m6.3.3.3.2.3.cmml" xref="S3.SS4.p1.6.m6.3.3.3.2.3">𝐬</ci></apply><ci id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">⋅</ci></apply><apply id="S3.SS4.p1.6.m6.3.3.1.cmml" xref="S3.SS4.p1.6.m6.3.3.1"><times id="S3.SS4.p1.6.m6.3.3.1.2.cmml" xref="S3.SS4.p1.6.m6.3.3.1.2"></times><apply id="S3.SS4.p1.6.m6.3.3.1.3.cmml" xref="S3.SS4.p1.6.m6.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.3.3.1.3.1.cmml" xref="S3.SS4.p1.6.m6.3.3.1.3">subscript</csymbol><ci id="S3.SS4.p1.6.m6.3.3.1.3.2.cmml" xref="S3.SS4.p1.6.m6.3.3.1.3.2">ℱ</ci><ci id="S3.SS4.p1.6.m6.3.3.1.3.3.cmml" xref="S3.SS4.p1.6.m6.3.3.1.3.3">clip</ci></apply><interval closure="open" id="S3.SS4.p1.6.m6.3.3.1.1.2.cmml" xref="S3.SS4.p1.6.m6.3.3.1.1.1"><ci id="S3.SS4.p1.6.m6.2.2.cmml" xref="S3.SS4.p1.6.m6.2.2">⋅</ci><apply id="S3.SS4.p1.6.m6.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.3.3.1.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.6.m6.3.3.1.1.1.1.2.cmml" xref="S3.SS4.p1.6.m6.3.3.1.1.1.1.2">𝐯</ci><ci id="S3.SS4.p1.6.m6.3.3.1.1.1.1.3.cmml" xref="S3.SS4.p1.6.m6.3.3.1.1.1.1.3">𝐬</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.3c">\mathcal{F}_{\mathbf{s}}(\cdot)=\mathcal{F}_{\mathrm{clip}}(\cdot,\mathbf{v}_{\mathbf{s}})</annotation></semantics></math> and using <math id="S3.SS4.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{v}_{\mathbf{p}}" display="inline"><semantics id="S3.SS4.p1.7.m7.1a"><msub id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml"><mi id="S3.SS4.p1.7.m7.1.1.2" xref="S3.SS4.p1.7.m7.1.1.2.cmml">𝐯</mi><mi id="S3.SS4.p1.7.m7.1.1.3" xref="S3.SS4.p1.7.m7.1.1.3.cmml">𝐩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m7.1.1.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2">𝐯</ci><ci id="S3.SS4.p1.7.m7.1.1.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">\mathbf{v}_{\mathbf{p}}</annotation></semantics></math> for photo encoder as, <math id="S3.SS4.p1.8.m8.3" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{p}}(\cdot)=\mathcal{F}_{\mathrm{clip}}(\cdot,\mathbf{v}_{\mathbf{p}})" display="inline"><semantics id="S3.SS4.p1.8.m8.3a"><mrow id="S3.SS4.p1.8.m8.3.3" xref="S3.SS4.p1.8.m8.3.3.cmml"><mrow id="S3.SS4.p1.8.m8.3.3.3" xref="S3.SS4.p1.8.m8.3.3.3.cmml"><msub id="S3.SS4.p1.8.m8.3.3.3.2" xref="S3.SS4.p1.8.m8.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.8.m8.3.3.3.2.2" xref="S3.SS4.p1.8.m8.3.3.3.2.2.cmml">ℱ</mi><mi id="S3.SS4.p1.8.m8.3.3.3.2.3" xref="S3.SS4.p1.8.m8.3.3.3.2.3.cmml">𝐩</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m8.3.3.3.1" xref="S3.SS4.p1.8.m8.3.3.3.1.cmml">​</mo><mrow id="S3.SS4.p1.8.m8.3.3.3.3.2" xref="S3.SS4.p1.8.m8.3.3.3.cmml"><mo stretchy="false" id="S3.SS4.p1.8.m8.3.3.3.3.2.1" xref="S3.SS4.p1.8.m8.3.3.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS4.p1.8.m8.3.3.3.3.2.2" xref="S3.SS4.p1.8.m8.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p1.8.m8.3.3.2" xref="S3.SS4.p1.8.m8.3.3.2.cmml">=</mo><mrow id="S3.SS4.p1.8.m8.3.3.1" xref="S3.SS4.p1.8.m8.3.3.1.cmml"><msub id="S3.SS4.p1.8.m8.3.3.1.3" xref="S3.SS4.p1.8.m8.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.8.m8.3.3.1.3.2" xref="S3.SS4.p1.8.m8.3.3.1.3.2.cmml">ℱ</mi><mi id="S3.SS4.p1.8.m8.3.3.1.3.3" xref="S3.SS4.p1.8.m8.3.3.1.3.3.cmml">clip</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m8.3.3.1.2" xref="S3.SS4.p1.8.m8.3.3.1.2.cmml">​</mo><mrow id="S3.SS4.p1.8.m8.3.3.1.1.1" xref="S3.SS4.p1.8.m8.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.8.m8.3.3.1.1.1.2" xref="S3.SS4.p1.8.m8.3.3.1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m8.2.2" xref="S3.SS4.p1.8.m8.2.2.cmml">⋅</mo><mo id="S3.SS4.p1.8.m8.3.3.1.1.1.3" xref="S3.SS4.p1.8.m8.3.3.1.1.2.cmml">,</mo><msub id="S3.SS4.p1.8.m8.3.3.1.1.1.1" xref="S3.SS4.p1.8.m8.3.3.1.1.1.1.cmml"><mi id="S3.SS4.p1.8.m8.3.3.1.1.1.1.2" xref="S3.SS4.p1.8.m8.3.3.1.1.1.1.2.cmml">𝐯</mi><mi id="S3.SS4.p1.8.m8.3.3.1.1.1.1.3" xref="S3.SS4.p1.8.m8.3.3.1.1.1.1.3.cmml">𝐩</mi></msub><mo stretchy="false" id="S3.SS4.p1.8.m8.3.3.1.1.1.4" xref="S3.SS4.p1.8.m8.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.3b"><apply id="S3.SS4.p1.8.m8.3.3.cmml" xref="S3.SS4.p1.8.m8.3.3"><eq id="S3.SS4.p1.8.m8.3.3.2.cmml" xref="S3.SS4.p1.8.m8.3.3.2"></eq><apply id="S3.SS4.p1.8.m8.3.3.3.cmml" xref="S3.SS4.p1.8.m8.3.3.3"><times id="S3.SS4.p1.8.m8.3.3.3.1.cmml" xref="S3.SS4.p1.8.m8.3.3.3.1"></times><apply id="S3.SS4.p1.8.m8.3.3.3.2.cmml" xref="S3.SS4.p1.8.m8.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.3.3.3.2.1.cmml" xref="S3.SS4.p1.8.m8.3.3.3.2">subscript</csymbol><ci id="S3.SS4.p1.8.m8.3.3.3.2.2.cmml" xref="S3.SS4.p1.8.m8.3.3.3.2.2">ℱ</ci><ci id="S3.SS4.p1.8.m8.3.3.3.2.3.cmml" xref="S3.SS4.p1.8.m8.3.3.3.2.3">𝐩</ci></apply><ci id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">⋅</ci></apply><apply id="S3.SS4.p1.8.m8.3.3.1.cmml" xref="S3.SS4.p1.8.m8.3.3.1"><times id="S3.SS4.p1.8.m8.3.3.1.2.cmml" xref="S3.SS4.p1.8.m8.3.3.1.2"></times><apply id="S3.SS4.p1.8.m8.3.3.1.3.cmml" xref="S3.SS4.p1.8.m8.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.3.3.1.3.1.cmml" xref="S3.SS4.p1.8.m8.3.3.1.3">subscript</csymbol><ci id="S3.SS4.p1.8.m8.3.3.1.3.2.cmml" xref="S3.SS4.p1.8.m8.3.3.1.3.2">ℱ</ci><ci id="S3.SS4.p1.8.m8.3.3.1.3.3.cmml" xref="S3.SS4.p1.8.m8.3.3.1.3.3">clip</ci></apply><interval closure="open" id="S3.SS4.p1.8.m8.3.3.1.1.2.cmml" xref="S3.SS4.p1.8.m8.3.3.1.1.1"><ci id="S3.SS4.p1.8.m8.2.2.cmml" xref="S3.SS4.p1.8.m8.2.2">⋅</ci><apply id="S3.SS4.p1.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.8.m8.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.3.3.1.1.1.1.1.cmml" xref="S3.SS4.p1.8.m8.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m8.3.3.1.1.1.1.2.cmml" xref="S3.SS4.p1.8.m8.3.3.1.1.1.1.2">𝐯</ci><ci id="S3.SS4.p1.8.m8.3.3.1.1.1.1.3.cmml" xref="S3.SS4.p1.8.m8.3.3.1.1.1.1.3">𝐩</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.3c">\mathcal{F}_{\mathbf{p}}(\cdot)=\mathcal{F}_{\mathrm{clip}}(\cdot,\mathbf{v}_{\mathbf{p}})</annotation></semantics></math>. Since ViT weights are frozen, training our CLIP-based SBIR is parameter-efficient – we train only <math id="S3.SS4.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{v}_{\mathbf{s}}\in\mathbb{R}^{P\times 768}" display="inline"><semantics id="S3.SS4.p1.9.m9.1a"><mrow id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><msub id="S3.SS4.p1.9.m9.1.1.2" xref="S3.SS4.p1.9.m9.1.1.2.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2.2" xref="S3.SS4.p1.9.m9.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS4.p1.9.m9.1.1.2.3" xref="S3.SS4.p1.9.m9.1.1.2.3.cmml">𝐬</mi></msub><mo id="S3.SS4.p1.9.m9.1.1.1" xref="S3.SS4.p1.9.m9.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3.cmml"><mi id="S3.SS4.p1.9.m9.1.1.3.2" xref="S3.SS4.p1.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.9.m9.1.1.3.3" xref="S3.SS4.p1.9.m9.1.1.3.3.cmml"><mi id="S3.SS4.p1.9.m9.1.1.3.3.2" xref="S3.SS4.p1.9.m9.1.1.3.3.2.cmml">P</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.9.m9.1.1.3.3.1" xref="S3.SS4.p1.9.m9.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.9.m9.1.1.3.3.3" xref="S3.SS4.p1.9.m9.1.1.3.3.3.cmml">768</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><in id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1.1"></in><apply id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.2.1.cmml" xref="S3.SS4.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.2.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2.2">𝐯</ci><ci id="S3.SS4.p1.9.m9.1.1.2.3.cmml" xref="S3.SS4.p1.9.m9.1.1.2.3">𝐬</ci></apply><apply id="S3.SS4.p1.9.m9.1.1.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.3.1.cmml" xref="S3.SS4.p1.9.m9.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.3.2.cmml" xref="S3.SS4.p1.9.m9.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.9.m9.1.1.3.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3.3"><times id="S3.SS4.p1.9.m9.1.1.3.3.1.cmml" xref="S3.SS4.p1.9.m9.1.1.3.3.1"></times><ci id="S3.SS4.p1.9.m9.1.1.3.3.2.cmml" xref="S3.SS4.p1.9.m9.1.1.3.3.2">𝑃</ci><cn type="integer" id="S3.SS4.p1.9.m9.1.1.3.3.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3.3.3">768</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">\mathbf{v}_{\mathbf{s}}\in\mathbb{R}^{P\times 768}</annotation></semantics></math> and <math id="S3.SS4.p1.10.m10.1" class="ltx_Math" alttext="\mathbf{v}_{\mathbf{p}}\in\mathbb{R}^{P\times 768}" display="inline"><semantics id="S3.SS4.p1.10.m10.1a"><mrow id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml"><msub id="S3.SS4.p1.10.m10.1.1.2" xref="S3.SS4.p1.10.m10.1.1.2.cmml"><mi id="S3.SS4.p1.10.m10.1.1.2.2" xref="S3.SS4.p1.10.m10.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS4.p1.10.m10.1.1.2.3" xref="S3.SS4.p1.10.m10.1.1.2.3.cmml">𝐩</mi></msub><mo id="S3.SS4.p1.10.m10.1.1.1" xref="S3.SS4.p1.10.m10.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.10.m10.1.1.3" xref="S3.SS4.p1.10.m10.1.1.3.cmml"><mi id="S3.SS4.p1.10.m10.1.1.3.2" xref="S3.SS4.p1.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.10.m10.1.1.3.3" xref="S3.SS4.p1.10.m10.1.1.3.3.cmml"><mi id="S3.SS4.p1.10.m10.1.1.3.3.2" xref="S3.SS4.p1.10.m10.1.1.3.3.2.cmml">P</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.10.m10.1.1.3.3.1" xref="S3.SS4.p1.10.m10.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p1.10.m10.1.1.3.3.3" xref="S3.SS4.p1.10.m10.1.1.3.3.3.cmml">768</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><apply id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1"><in id="S3.SS4.p1.10.m10.1.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1.1"></in><apply id="S3.SS4.p1.10.m10.1.1.2.cmml" xref="S3.SS4.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.1.2.1.cmml" xref="S3.SS4.p1.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.10.m10.1.1.2.2.cmml" xref="S3.SS4.p1.10.m10.1.1.2.2">𝐯</ci><ci id="S3.SS4.p1.10.m10.1.1.2.3.cmml" xref="S3.SS4.p1.10.m10.1.1.2.3">𝐩</ci></apply><apply id="S3.SS4.p1.10.m10.1.1.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.1.3.1.cmml" xref="S3.SS4.p1.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.10.m10.1.1.3.2.cmml" xref="S3.SS4.p1.10.m10.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.10.m10.1.1.3.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3.3"><times id="S3.SS4.p1.10.m10.1.1.3.3.1.cmml" xref="S3.SS4.p1.10.m10.1.1.3.3.1"></times><ci id="S3.SS4.p1.10.m10.1.1.3.3.2.cmml" xref="S3.SS4.p1.10.m10.1.1.3.3.2">𝑃</ci><cn type="integer" id="S3.SS4.p1.10.m10.1.1.3.3.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3.3.3">768</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">\mathbf{v}_{\mathbf{p}}\in\mathbb{R}^{P\times 768}</annotation></semantics></math>. This allows training with less data, and faster convergence. For category-level SBIR, (<math id="S3.SS4.p1.11.m11.2" class="ltx_Math" alttext="\mathbf{v}_{\mathbf{s}},\mathbf{v}_{\mathbf{p}}" display="inline"><semantics id="S3.SS4.p1.11.m11.2a"><mrow id="S3.SS4.p1.11.m11.2.2.2" xref="S3.SS4.p1.11.m11.2.2.3.cmml"><msub id="S3.SS4.p1.11.m11.1.1.1.1" xref="S3.SS4.p1.11.m11.1.1.1.1.cmml"><mi id="S3.SS4.p1.11.m11.1.1.1.1.2" xref="S3.SS4.p1.11.m11.1.1.1.1.2.cmml">𝐯</mi><mi id="S3.SS4.p1.11.m11.1.1.1.1.3" xref="S3.SS4.p1.11.m11.1.1.1.1.3.cmml">𝐬</mi></msub><mo id="S3.SS4.p1.11.m11.2.2.2.3" xref="S3.SS4.p1.11.m11.2.2.3.cmml">,</mo><msub id="S3.SS4.p1.11.m11.2.2.2.2" xref="S3.SS4.p1.11.m11.2.2.2.2.cmml"><mi id="S3.SS4.p1.11.m11.2.2.2.2.2" xref="S3.SS4.p1.11.m11.2.2.2.2.2.cmml">𝐯</mi><mi id="S3.SS4.p1.11.m11.2.2.2.2.3" xref="S3.SS4.p1.11.m11.2.2.2.2.3.cmml">𝐩</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.2b"><list id="S3.SS4.p1.11.m11.2.2.3.cmml" xref="S3.SS4.p1.11.m11.2.2.2"><apply id="S3.SS4.p1.11.m11.1.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.11.m11.1.1.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.2">𝐯</ci><ci id="S3.SS4.p1.11.m11.1.1.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.3">𝐬</ci></apply><apply id="S3.SS4.p1.11.m11.2.2.2.2.cmml" xref="S3.SS4.p1.11.m11.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.2.2.2.2.1.cmml" xref="S3.SS4.p1.11.m11.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.11.m11.2.2.2.2.2.cmml" xref="S3.SS4.p1.11.m11.2.2.2.2.2">𝐯</ci><ci id="S3.SS4.p1.11.m11.2.2.2.2.3.cmml" xref="S3.SS4.p1.11.m11.2.2.2.2.3">𝐩</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.2c">\mathbf{v}_{\mathbf{s}},\mathbf{v}_{\mathbf{p}}</annotation></semantics></math>) learns category inducing prompts using triplet loss (in <a href="#S3.E1" title="In 3.1 Background ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>). Learning cross-category FG-SBIR, is slightly more complicated that trains (<math id="S3.SS4.p1.12.m12.2" class="ltx_Math" alttext="\mathbf{v}_{\mathbf{s}},\mathbf{v}_{\mathbf{p}}" display="inline"><semantics id="S3.SS4.p1.12.m12.2a"><mrow id="S3.SS4.p1.12.m12.2.2.2" xref="S3.SS4.p1.12.m12.2.2.3.cmml"><msub id="S3.SS4.p1.12.m12.1.1.1.1" xref="S3.SS4.p1.12.m12.1.1.1.1.cmml"><mi id="S3.SS4.p1.12.m12.1.1.1.1.2" xref="S3.SS4.p1.12.m12.1.1.1.1.2.cmml">𝐯</mi><mi id="S3.SS4.p1.12.m12.1.1.1.1.3" xref="S3.SS4.p1.12.m12.1.1.1.1.3.cmml">𝐬</mi></msub><mo id="S3.SS4.p1.12.m12.2.2.2.3" xref="S3.SS4.p1.12.m12.2.2.3.cmml">,</mo><msub id="S3.SS4.p1.12.m12.2.2.2.2" xref="S3.SS4.p1.12.m12.2.2.2.2.cmml"><mi id="S3.SS4.p1.12.m12.2.2.2.2.2" xref="S3.SS4.p1.12.m12.2.2.2.2.2.cmml">𝐯</mi><mi id="S3.SS4.p1.12.m12.2.2.2.2.3" xref="S3.SS4.p1.12.m12.2.2.2.2.3.cmml">𝐩</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m12.2b"><list id="S3.SS4.p1.12.m12.2.2.3.cmml" xref="S3.SS4.p1.12.m12.2.2.2"><apply id="S3.SS4.p1.12.m12.1.1.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m12.1.1.1.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.12.m12.1.1.1.1.2.cmml" xref="S3.SS4.p1.12.m12.1.1.1.1.2">𝐯</ci><ci id="S3.SS4.p1.12.m12.1.1.1.1.3.cmml" xref="S3.SS4.p1.12.m12.1.1.1.1.3">𝐬</ci></apply><apply id="S3.SS4.p1.12.m12.2.2.2.2.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m12.2.2.2.2.1.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.12.m12.2.2.2.2.2.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2.2">𝐯</ci><ci id="S3.SS4.p1.12.m12.2.2.2.2.3.cmml" xref="S3.SS4.p1.12.m12.2.2.2.2.3">𝐩</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m12.2c">\mathbf{v}_{\mathbf{s}},\mathbf{v}_{\mathbf{p}}</annotation></semantics></math>) using hard-triplet in <a href="#S3.E1" title="In 3.1 Background ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, and a modified class discriminative loss <a href="#S3.E2" title="In 3.1 Background ‣ 3 Proposed Method ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a> using CLIP’s text encoder as,</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.4" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{cat}}=-c_{\mathbf{q}}^{i}\log\frac{\exp(f_{\mathbf{q}}^{i}\cdot f_{\mathbf{t}}^{i})}{\sum_{\forall j}\exp(f_{\mathbf{q}}^{i}\cdot f_{\mathbf{t}}^{j})}" display="block"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.5" xref="S3.E9.m1.4.5.cmml"><msub id="S3.E9.m1.4.5.2" xref="S3.E9.m1.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.4.5.2.2" xref="S3.E9.m1.4.5.2.2.cmml">ℒ</mi><mi id="S3.E9.m1.4.5.2.3" xref="S3.E9.m1.4.5.2.3.cmml">cat</mi></msub><mo id="S3.E9.m1.4.5.1" xref="S3.E9.m1.4.5.1.cmml">=</mo><mrow id="S3.E9.m1.4.5.3" xref="S3.E9.m1.4.5.3.cmml"><mo id="S3.E9.m1.4.5.3a" xref="S3.E9.m1.4.5.3.cmml">−</mo><mrow id="S3.E9.m1.4.5.3.2" xref="S3.E9.m1.4.5.3.2.cmml"><msubsup id="S3.E9.m1.4.5.3.2.2" xref="S3.E9.m1.4.5.3.2.2.cmml"><mi id="S3.E9.m1.4.5.3.2.2.2.2" xref="S3.E9.m1.4.5.3.2.2.2.2.cmml">c</mi><mi id="S3.E9.m1.4.5.3.2.2.2.3" xref="S3.E9.m1.4.5.3.2.2.2.3.cmml">𝐪</mi><mi id="S3.E9.m1.4.5.3.2.2.3" xref="S3.E9.m1.4.5.3.2.2.3.cmml">i</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S3.E9.m1.4.5.3.2.1" xref="S3.E9.m1.4.5.3.2.1.cmml">​</mo><mrow id="S3.E9.m1.4.5.3.2.3" xref="S3.E9.m1.4.5.3.2.3.cmml"><mi id="S3.E9.m1.4.5.3.2.3.1" xref="S3.E9.m1.4.5.3.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E9.m1.4.5.3.2.3a" xref="S3.E9.m1.4.5.3.2.3.cmml">⁡</mo><mfrac id="S3.E9.m1.4.4" xref="S3.E9.m1.4.4.cmml"><mrow id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E9.m1.2.2.2.2a" xref="S3.E9.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E9.m1.2.2.2.2.1" xref="S3.E9.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.2.2.1.2" xref="S3.E9.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E9.m1.2.2.2.2.1.1" xref="S3.E9.m1.2.2.2.2.1.1.cmml"><msubsup id="S3.E9.m1.2.2.2.2.1.1.2" xref="S3.E9.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.2.2.2" xref="S3.E9.m1.2.2.2.2.1.1.2.2.2.cmml">f</mi><mi id="S3.E9.m1.2.2.2.2.1.1.2.2.3" xref="S3.E9.m1.2.2.2.2.1.1.2.2.3.cmml">𝐪</mi><mi id="S3.E9.m1.2.2.2.2.1.1.2.3" xref="S3.E9.m1.2.2.2.2.1.1.2.3.cmml">i</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E9.m1.2.2.2.2.1.1.1" xref="S3.E9.m1.2.2.2.2.1.1.1.cmml">⋅</mo><msubsup id="S3.E9.m1.2.2.2.2.1.1.3" xref="S3.E9.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.3.2.2" xref="S3.E9.m1.2.2.2.2.1.1.3.2.2.cmml">f</mi><mi id="S3.E9.m1.2.2.2.2.1.1.3.2.3" xref="S3.E9.m1.2.2.2.2.1.1.3.2.3.cmml">𝐭</mi><mi id="S3.E9.m1.2.2.2.2.1.1.3.3" xref="S3.E9.m1.2.2.2.2.1.1.3.3.cmml">i</mi></msubsup></mrow><mo stretchy="false" id="S3.E9.m1.2.2.2.2.1.3" xref="S3.E9.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E9.m1.4.4.4" xref="S3.E9.m1.4.4.4.cmml"><msub id="S3.E9.m1.4.4.4.3" xref="S3.E9.m1.4.4.4.3.cmml"><mo id="S3.E9.m1.4.4.4.3.2" xref="S3.E9.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S3.E9.m1.4.4.4.3.3" xref="S3.E9.m1.4.4.4.3.3.cmml"><mo rspace="0.167em" id="S3.E9.m1.4.4.4.3.3.1" xref="S3.E9.m1.4.4.4.3.3.1.cmml">∀</mo><mi id="S3.E9.m1.4.4.4.3.3.2" xref="S3.E9.m1.4.4.4.3.3.2.cmml">j</mi></mrow></msub><mrow id="S3.E9.m1.4.4.4.2.1" xref="S3.E9.m1.4.4.4.2.2.cmml"><mi id="S3.E9.m1.3.3.3.1" xref="S3.E9.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E9.m1.4.4.4.2.1a" xref="S3.E9.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S3.E9.m1.4.4.4.2.1.1" xref="S3.E9.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="S3.E9.m1.4.4.4.2.1.1.2" xref="S3.E9.m1.4.4.4.2.2.cmml">(</mo><mrow id="S3.E9.m1.4.4.4.2.1.1.1" xref="S3.E9.m1.4.4.4.2.1.1.1.cmml"><msubsup id="S3.E9.m1.4.4.4.2.1.1.1.2" xref="S3.E9.m1.4.4.4.2.1.1.1.2.cmml"><mi id="S3.E9.m1.4.4.4.2.1.1.1.2.2.2" xref="S3.E9.m1.4.4.4.2.1.1.1.2.2.2.cmml">f</mi><mi id="S3.E9.m1.4.4.4.2.1.1.1.2.2.3" xref="S3.E9.m1.4.4.4.2.1.1.1.2.2.3.cmml">𝐪</mi><mi id="S3.E9.m1.4.4.4.2.1.1.1.2.3" xref="S3.E9.m1.4.4.4.2.1.1.1.2.3.cmml">i</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E9.m1.4.4.4.2.1.1.1.1" xref="S3.E9.m1.4.4.4.2.1.1.1.1.cmml">⋅</mo><msubsup id="S3.E9.m1.4.4.4.2.1.1.1.3" xref="S3.E9.m1.4.4.4.2.1.1.1.3.cmml"><mi id="S3.E9.m1.4.4.4.2.1.1.1.3.2.2" xref="S3.E9.m1.4.4.4.2.1.1.1.3.2.2.cmml">f</mi><mi id="S3.E9.m1.4.4.4.2.1.1.1.3.2.3" xref="S3.E9.m1.4.4.4.2.1.1.1.3.2.3.cmml">𝐭</mi><mi id="S3.E9.m1.4.4.4.2.1.1.1.3.3" xref="S3.E9.m1.4.4.4.2.1.1.1.3.3.cmml">j</mi></msubsup></mrow><mo stretchy="false" id="S3.E9.m1.4.4.4.2.1.1.3" xref="S3.E9.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.5.cmml" xref="S3.E9.m1.4.5"><eq id="S3.E9.m1.4.5.1.cmml" xref="S3.E9.m1.4.5.1"></eq><apply id="S3.E9.m1.4.5.2.cmml" xref="S3.E9.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.2.1.cmml" xref="S3.E9.m1.4.5.2">subscript</csymbol><ci id="S3.E9.m1.4.5.2.2.cmml" xref="S3.E9.m1.4.5.2.2">ℒ</ci><ci id="S3.E9.m1.4.5.2.3.cmml" xref="S3.E9.m1.4.5.2.3">cat</ci></apply><apply id="S3.E9.m1.4.5.3.cmml" xref="S3.E9.m1.4.5.3"><minus id="S3.E9.m1.4.5.3.1.cmml" xref="S3.E9.m1.4.5.3"></minus><apply id="S3.E9.m1.4.5.3.2.cmml" xref="S3.E9.m1.4.5.3.2"><times id="S3.E9.m1.4.5.3.2.1.cmml" xref="S3.E9.m1.4.5.3.2.1"></times><apply id="S3.E9.m1.4.5.3.2.2.cmml" xref="S3.E9.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.3.2.2.1.cmml" xref="S3.E9.m1.4.5.3.2.2">superscript</csymbol><apply id="S3.E9.m1.4.5.3.2.2.2.cmml" xref="S3.E9.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.3.2.2.2.1.cmml" xref="S3.E9.m1.4.5.3.2.2">subscript</csymbol><ci id="S3.E9.m1.4.5.3.2.2.2.2.cmml" xref="S3.E9.m1.4.5.3.2.2.2.2">𝑐</ci><ci id="S3.E9.m1.4.5.3.2.2.2.3.cmml" xref="S3.E9.m1.4.5.3.2.2.2.3">𝐪</ci></apply><ci id="S3.E9.m1.4.5.3.2.2.3.cmml" xref="S3.E9.m1.4.5.3.2.2.3">𝑖</ci></apply><apply id="S3.E9.m1.4.5.3.2.3.cmml" xref="S3.E9.m1.4.5.3.2.3"><log id="S3.E9.m1.4.5.3.2.3.1.cmml" xref="S3.E9.m1.4.5.3.2.3.1"></log><apply id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4"><divide id="S3.E9.m1.4.4.5.cmml" xref="S3.E9.m1.4.4"></divide><apply id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2"><exp id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1"></exp><apply id="S3.E9.m1.2.2.2.2.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1"><ci id="S3.E9.m1.2.2.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1">⋅</ci><apply id="S3.E9.m1.2.2.2.2.1.1.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2">superscript</csymbol><apply id="S3.E9.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2.2.2">𝑓</ci><ci id="S3.E9.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2.2.3">𝐪</ci></apply><ci id="S3.E9.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E9.m1.2.2.2.2.1.1.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3">superscript</csymbol><apply id="S3.E9.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.2.2">𝑓</ci><ci id="S3.E9.m1.2.2.2.2.1.1.3.2.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.2.3">𝐭</ci></apply><ci id="S3.E9.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E9.m1.4.4.4.cmml" xref="S3.E9.m1.4.4.4"><apply id="S3.E9.m1.4.4.4.3.cmml" xref="S3.E9.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.4.3.1.cmml" xref="S3.E9.m1.4.4.4.3">subscript</csymbol><sum id="S3.E9.m1.4.4.4.3.2.cmml" xref="S3.E9.m1.4.4.4.3.2"></sum><apply id="S3.E9.m1.4.4.4.3.3.cmml" xref="S3.E9.m1.4.4.4.3.3"><csymbol cd="latexml" id="S3.E9.m1.4.4.4.3.3.1.cmml" xref="S3.E9.m1.4.4.4.3.3.1">for-all</csymbol><ci id="S3.E9.m1.4.4.4.3.3.2.cmml" xref="S3.E9.m1.4.4.4.3.3.2">𝑗</ci></apply></apply><apply id="S3.E9.m1.4.4.4.2.2.cmml" xref="S3.E9.m1.4.4.4.2.1"><exp id="S3.E9.m1.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3.1"></exp><apply id="S3.E9.m1.4.4.4.2.1.1.1.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1"><ci id="S3.E9.m1.4.4.4.2.1.1.1.1.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.1">⋅</ci><apply id="S3.E9.m1.4.4.4.2.1.1.1.2.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.4.2.1.1.1.2.1.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.2">superscript</csymbol><apply id="S3.E9.m1.4.4.4.2.1.1.1.2.2.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.4.2.1.1.1.2.2.1.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.2">subscript</csymbol><ci id="S3.E9.m1.4.4.4.2.1.1.1.2.2.2.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.2.2.2">𝑓</ci><ci id="S3.E9.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.2.2.3">𝐪</ci></apply><ci id="S3.E9.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E9.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.4.2.1.1.1.3.1.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.3">superscript</csymbol><apply id="S3.E9.m1.4.4.4.2.1.1.1.3.2.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.4.2.1.1.1.3.2.1.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.4.4.4.2.1.1.1.3.2.2.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.3.2.2">𝑓</ci><ci id="S3.E9.m1.4.4.4.2.1.1.1.3.2.3.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.3.2.3">𝐭</ci></apply><ci id="S3.E9.m1.4.4.4.2.1.1.1.3.3.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">\mathcal{L}_{\mathrm{cat}}=-c_{\mathbf{q}}^{i}\log\frac{\exp(f_{\mathbf{q}}^{i}\cdot f_{\mathbf{t}}^{i})}{\sum_{\forall j}\exp(f_{\mathbf{q}}^{i}\cdot f_{\mathbf{t}}^{j})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p2" class="ltx_para ltx_noindent">
<p id="S3.SS4.p2.3" class="ltx_p">where, <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="f_{\mathbf{t}}^{i}\in\mathbb{R}^{512}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><msubsup id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2.2.2" xref="S3.SS4.p2.1.m1.1.1.2.2.2.cmml">f</mi><mi id="S3.SS4.p2.1.m1.1.1.2.2.3" xref="S3.SS4.p2.1.m1.1.1.2.2.3.cmml">𝐭</mi><mi id="S3.SS4.p2.1.m1.1.1.2.3" xref="S3.SS4.p2.1.m1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.SS4.p2.1.m1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS4.p2.1.m1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.3.3.cmml">512</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><in id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1"></in><apply id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1.2">superscript</csymbol><apply id="S3.SS4.p2.1.m1.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.2.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2.2.2">𝑓</ci><ci id="S3.SS4.p2.1.m1.1.1.2.2.3.cmml" xref="S3.SS4.p2.1.m1.1.1.2.2.3">𝐭</ci></apply><ci id="S3.SS4.p2.1.m1.1.1.2.3.cmml" xref="S3.SS4.p2.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS4.p2.1.m1.1.1.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3">512</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">f_{\mathbf{t}}^{i}\in\mathbb{R}^{512}</annotation></semantics></math> is computed by CLIP’s text encoder as, <math id="S3.SS4.p2.2.m2.2" class="ltx_Math" alttext='f_{\mathbf{t}}^{i}=\mathcal{F}_{\mathrm{clip}}^{(\mathbf{t})}(``\texttt{a photo of a }[c_{\mathbf{q}}^{i}]")' display="inline"><semantics id="S3.SS4.p2.2.m2.2a"><mrow id="S3.SS4.p2.2.m2.2.2" xref="S3.SS4.p2.2.m2.2.2.cmml"><msubsup id="S3.SS4.p2.2.m2.2.2.3" xref="S3.SS4.p2.2.m2.2.2.3.cmml"><mi id="S3.SS4.p2.2.m2.2.2.3.2.2" xref="S3.SS4.p2.2.m2.2.2.3.2.2.cmml">f</mi><mi id="S3.SS4.p2.2.m2.2.2.3.2.3" xref="S3.SS4.p2.2.m2.2.2.3.2.3.cmml">𝐭</mi><mi id="S3.SS4.p2.2.m2.2.2.3.3" xref="S3.SS4.p2.2.m2.2.2.3.3.cmml">i</mi></msubsup><mo id="S3.SS4.p2.2.m2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.cmml">=</mo><mrow id="S3.SS4.p2.2.m2.2.2.1" xref="S3.SS4.p2.2.m2.2.2.1.cmml"><msubsup id="S3.SS4.p2.2.m2.2.2.1.3" xref="S3.SS4.p2.2.m2.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.2.m2.2.2.1.3.2.2" xref="S3.SS4.p2.2.m2.2.2.1.3.2.2.cmml">ℱ</mi><mi id="S3.SS4.p2.2.m2.2.2.1.3.2.3" xref="S3.SS4.p2.2.m2.2.2.1.3.2.3.cmml">clip</mi><mrow id="S3.SS4.p2.2.m2.1.1.1.3" xref="S3.SS4.p2.2.m2.2.2.1.3.cmml"><mo stretchy="false" id="S3.SS4.p2.2.m2.1.1.1.3.1" xref="S3.SS4.p2.2.m2.2.2.1.3.cmml">(</mo><mi id="S3.SS4.p2.2.m2.1.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.1.cmml">𝐭</mi><mo stretchy="false" id="S3.SS4.p2.2.m2.1.1.1.3.2" xref="S3.SS4.p2.2.m2.2.2.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.SS4.p2.2.m2.2.2.1.2" xref="S3.SS4.p2.2.m2.2.2.1.2.cmml">​</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.2.m2.2.2.1.1.1.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.3.cmml">`</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.2.cmml">​</mo><mi mathvariant="normal" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.4" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.4.cmml">`</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.2a" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.2.cmml">​</mo><mtext class="ltx_mathvariant_monospace" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.5" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.5a.cmml">a photo of a </mtext><mo lspace="0em" rspace="0em" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.2b" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.2.1.cmml">[</mo><msubsup id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml">𝐪</mi><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.2c" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.2.cmml">​</mo><mi mathvariant="normal" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.6" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.6.cmml">"</mi></mrow><mo stretchy="false" id="S3.SS4.p2.2.m2.2.2.1.1.1.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.2b"><apply id="S3.SS4.p2.2.m2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2"><eq id="S3.SS4.p2.2.m2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2"></eq><apply id="S3.SS4.p2.2.m2.2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.3.1.cmml" xref="S3.SS4.p2.2.m2.2.2.3">superscript</csymbol><apply id="S3.SS4.p2.2.m2.2.2.3.2.cmml" xref="S3.SS4.p2.2.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.3.2.1.cmml" xref="S3.SS4.p2.2.m2.2.2.3">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.2.3.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.3.2.2">𝑓</ci><ci id="S3.SS4.p2.2.m2.2.2.3.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.3.2.3">𝐭</ci></apply><ci id="S3.SS4.p2.2.m2.2.2.3.3.cmml" xref="S3.SS4.p2.2.m2.2.2.3.3">𝑖</ci></apply><apply id="S3.SS4.p2.2.m2.2.2.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1"><times id="S3.SS4.p2.2.m2.2.2.1.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.2"></times><apply id="S3.SS4.p2.2.m2.2.2.1.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.1.3.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.3">superscript</csymbol><apply id="S3.SS4.p2.2.m2.2.2.1.3.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.1.3.2.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.3">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.2.1.3.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.3.2.2">ℱ</ci><ci id="S3.SS4.p2.2.m2.2.2.1.3.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.3.2.3">clip</ci></apply><ci id="S3.SS4.p2.2.m2.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1">𝐭</ci></apply><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1"><times id="S3.SS4.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.2"></times><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.3">`</ci><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.4.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.4">`</ci><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.5a.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.5"><mtext class="ltx_mathvariant_monospace" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.5.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.5">a photo of a </mtext></ci><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.3">𝐪</ci></apply><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.6.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.6">"</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.2c">f_{\mathbf{t}}^{i}=\mathcal{F}_{\mathrm{clip}}^{(\mathbf{t})}(``\texttt{a photo of a }[c_{\mathbf{q}}^{i}]")</annotation></semantics></math> for category <math id="S3.SS4.p2.3.m3.1" class="ltx_Math" alttext="c_{\mathbf{q}}^{i}" display="inline"><semantics id="S3.SS4.p2.3.m3.1a"><msubsup id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.2.2" xref="S3.SS4.p2.3.m3.1.1.2.2.cmml">c</mi><mi id="S3.SS4.p2.3.m3.1.1.2.3" xref="S3.SS4.p2.3.m3.1.1.2.3.cmml">𝐪</mi><mi id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.2.1.cmml" xref="S3.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.2.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2.2">𝑐</ci><ci id="S3.SS4.p2.3.m3.1.1.2.3.cmml" xref="S3.SS4.p2.3.m3.1.1.2.3">𝐪</ci></apply><ci id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">c_{\mathbf{q}}^{i}</annotation></semantics></math>. Equipped with our novel prompt-based SBIR, we train open-vocab category-level object detection, fine-grained object detection, and part-level object detection.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Bridging Object-Level and Image-Level</h3>

<figure id="S3.F5" class="ltx_figure"><img src="/html/2303.15149/assets/x5.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="122" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F5.4.2.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S3.F5.2.1" class="ltx_text" style="font-size:90%;">Bridge object and image-level gap with synthetic photos by tiling <math id="S3.F5.2.1.m1.2" class="ltx_Math" alttext="n=\{1,\dots 7\}" display="inline"><semantics id="S3.F5.2.1.m1.2b"><mrow id="S3.F5.2.1.m1.2.2" xref="S3.F5.2.1.m1.2.2.cmml"><mi id="S3.F5.2.1.m1.2.2.3" xref="S3.F5.2.1.m1.2.2.3.cmml">n</mi><mo id="S3.F5.2.1.m1.2.2.2" xref="S3.F5.2.1.m1.2.2.2.cmml">=</mo><mrow id="S3.F5.2.1.m1.2.2.1.1" xref="S3.F5.2.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.F5.2.1.m1.2.2.1.1.2" xref="S3.F5.2.1.m1.2.2.1.2.cmml">{</mo><mn id="S3.F5.2.1.m1.1.1" xref="S3.F5.2.1.m1.1.1.cmml">1</mn><mo id="S3.F5.2.1.m1.2.2.1.1.3" xref="S3.F5.2.1.m1.2.2.1.2.cmml">,</mo><mrow id="S3.F5.2.1.m1.2.2.1.1.1" xref="S3.F5.2.1.m1.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S3.F5.2.1.m1.2.2.1.1.1.2" xref="S3.F5.2.1.m1.2.2.1.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.F5.2.1.m1.2.2.1.1.1.1" xref="S3.F5.2.1.m1.2.2.1.1.1.1.cmml">​</mo><mn id="S3.F5.2.1.m1.2.2.1.1.1.3" xref="S3.F5.2.1.m1.2.2.1.1.1.3.cmml">7</mn></mrow><mo stretchy="false" id="S3.F5.2.1.m1.2.2.1.1.4" xref="S3.F5.2.1.m1.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F5.2.1.m1.2c"><apply id="S3.F5.2.1.m1.2.2.cmml" xref="S3.F5.2.1.m1.2.2"><eq id="S3.F5.2.1.m1.2.2.2.cmml" xref="S3.F5.2.1.m1.2.2.2"></eq><ci id="S3.F5.2.1.m1.2.2.3.cmml" xref="S3.F5.2.1.m1.2.2.3">𝑛</ci><set id="S3.F5.2.1.m1.2.2.1.2.cmml" xref="S3.F5.2.1.m1.2.2.1.1"><cn type="integer" id="S3.F5.2.1.m1.1.1.cmml" xref="S3.F5.2.1.m1.1.1">1</cn><apply id="S3.F5.2.1.m1.2.2.1.1.1.cmml" xref="S3.F5.2.1.m1.2.2.1.1.1"><times id="S3.F5.2.1.m1.2.2.1.1.1.1.cmml" xref="S3.F5.2.1.m1.2.2.1.1.1.1"></times><ci id="S3.F5.2.1.m1.2.2.1.1.1.2.cmml" xref="S3.F5.2.1.m1.2.2.1.1.1.2">…</ci><cn type="integer" id="S3.F5.2.1.m1.2.2.1.1.1.3.cmml" xref="S3.F5.2.1.m1.2.2.1.1.1.3">7</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.2.1.m1.2d">n=\{1,\dots 7\}</annotation></semantics></math> object-level photos in SBIR datasets.</span></figcaption>
</figure>
<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.3" class="ltx_p">While SBIR is trained using object-level (single object) sketch/photo pairs, object detection works on image-level (multiple objects) data. To train object detectors using SBIR, we need to bridge this object and image-level gap. Our solution is embarrassingly simple – synthesise a canvas of size <math id="S3.SS5.p1.1.m1.1" class="ltx_Math" alttext="(H\times W)" display="inline"><semantics id="S3.SS5.p1.1.m1.1a"><mrow id="S3.SS5.p1.1.m1.1.1.1" xref="S3.SS5.p1.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS5.p1.1.m1.1.1.1.2" xref="S3.SS5.p1.1.m1.1.1.1.1.cmml">(</mo><mrow id="S3.SS5.p1.1.m1.1.1.1.1" xref="S3.SS5.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS5.p1.1.m1.1.1.1.1.2" xref="S3.SS5.p1.1.m1.1.1.1.1.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS5.p1.1.m1.1.1.1.1.1" xref="S3.SS5.p1.1.m1.1.1.1.1.1.cmml">×</mo><mi id="S3.SS5.p1.1.m1.1.1.1.1.3" xref="S3.SS5.p1.1.m1.1.1.1.1.3.cmml">W</mi></mrow><mo stretchy="false" id="S3.SS5.p1.1.m1.1.1.1.3" xref="S3.SS5.p1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><apply id="S3.SS5.p1.1.m1.1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1.1"><times id="S3.SS5.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1.1.1.1"></times><ci id="S3.SS5.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS5.p1.1.m1.1.1.1.1.2">𝐻</ci><ci id="S3.SS5.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS5.p1.1.m1.1.1.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">(H\times W)</annotation></semantics></math> by randomly tiling <math id="S3.SS5.p1.2.m2.3" class="ltx_Math" alttext="n=\{1,\dots,7\}" display="inline"><semantics id="S3.SS5.p1.2.m2.3a"><mrow id="S3.SS5.p1.2.m2.3.4" xref="S3.SS5.p1.2.m2.3.4.cmml"><mi id="S3.SS5.p1.2.m2.3.4.2" xref="S3.SS5.p1.2.m2.3.4.2.cmml">n</mi><mo id="S3.SS5.p1.2.m2.3.4.1" xref="S3.SS5.p1.2.m2.3.4.1.cmml">=</mo><mrow id="S3.SS5.p1.2.m2.3.4.3.2" xref="S3.SS5.p1.2.m2.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS5.p1.2.m2.3.4.3.2.1" xref="S3.SS5.p1.2.m2.3.4.3.1.cmml">{</mo><mn id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml">1</mn><mo id="S3.SS5.p1.2.m2.3.4.3.2.2" xref="S3.SS5.p1.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS5.p1.2.m2.2.2" xref="S3.SS5.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS5.p1.2.m2.3.4.3.2.3" xref="S3.SS5.p1.2.m2.3.4.3.1.cmml">,</mo><mn id="S3.SS5.p1.2.m2.3.3" xref="S3.SS5.p1.2.m2.3.3.cmml">7</mn><mo stretchy="false" id="S3.SS5.p1.2.m2.3.4.3.2.4" xref="S3.SS5.p1.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.3b"><apply id="S3.SS5.p1.2.m2.3.4.cmml" xref="S3.SS5.p1.2.m2.3.4"><eq id="S3.SS5.p1.2.m2.3.4.1.cmml" xref="S3.SS5.p1.2.m2.3.4.1"></eq><ci id="S3.SS5.p1.2.m2.3.4.2.cmml" xref="S3.SS5.p1.2.m2.3.4.2">𝑛</ci><set id="S3.SS5.p1.2.m2.3.4.3.1.cmml" xref="S3.SS5.p1.2.m2.3.4.3.2"><cn type="integer" id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">1</cn><ci id="S3.SS5.p1.2.m2.2.2.cmml" xref="S3.SS5.p1.2.m2.2.2">…</ci><cn type="integer" id="S3.SS5.p1.2.m2.3.3.cmml" xref="S3.SS5.p1.2.m2.3.3">7</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.3c">n=\{1,\dots,7\}</annotation></semantics></math> object-level photos in SBIR datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite>. Despite its simplicity, our augmentation trick, analogous to CutMix <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib103" title="" class="ltx_ref">103</a>]</cite>, improves robustness against input corruptions and out-of-distribution generalisation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib104" title="" class="ltx_ref">104</a>, <a href="#bib.bib103" title="" class="ltx_ref">103</a>]</cite>. The paired sketches for photos in canvas are used to construct the support set <math id="S3.SS5.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS5.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.1b"><ci id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">\mathcal{S}</annotation></semantics></math>. Note, we train our object detector without the need to “see” the evaluation data distribution or use any annotation (bounding box or image-level class labels). We call this setup – extremely weakly supervised object detection (EWSOD) – no need to “see” the downstream data distribution.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.9" class="ltx_p"><span id="S4.p1.9.1" class="ltx_text ltx_font_bold">Dataset</span>  We train our object detector using existing cross-category FG-SBIR dataset – Sketchy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite> that contains <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="125" display="inline"><semantics id="S4.p1.1.m1.1a"><mn id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">125</mn><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><cn type="integer" id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">125</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">125</annotation></semantics></math> categories, each with <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.p1.2.m2.1a"><mn id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><cn type="integer" id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">100</annotation></semantics></math> photos. Every photo in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite> has at least <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.p1.3.m3.1a"><mn id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><cn type="integer" id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">5</annotation></semantics></math> instance-level paired sketches. To evaluate fine-grained object detection, we use SketchyCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> comprising of natural images in MS-COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> with instance-level paired sketches. Following Liu <em id="S4.p1.9.2" class="ltx_emph ltx_font_italic">et al</em>.<span id="S4.p1.9.3" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>, we select <math id="S4.p1.4.m4.2" class="ltx_Math" alttext="1,225" display="inline"><semantics id="S4.p1.4.m4.2a"><mrow id="S4.p1.4.m4.2.3.2" xref="S4.p1.4.m4.2.3.1.cmml"><mn id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">1</mn><mo id="S4.p1.4.m4.2.3.2.1" xref="S4.p1.4.m4.2.3.1.cmml">,</mo><mn id="S4.p1.4.m4.2.2" xref="S4.p1.4.m4.2.2.cmml">225</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.2b"><list id="S4.p1.4.m4.2.3.1.cmml" xref="S4.p1.4.m4.2.3.2"><cn type="integer" id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">1</cn><cn type="integer" id="S4.p1.4.m4.2.2.cmml" xref="S4.p1.4.m4.2.2">225</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.2c">1,225</annotation></semantics></math> sketch/photo pairs from SketchyCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> with at least one foreground sketched object. We filter the overlapping categories of in SketchyCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> from Sketchy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite> to measure true zero-shot performance. For category-level object detection, we train on category-level sketch/photo pairs in QuickDraw-Extended <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> having <math id="S4.p1.5.m5.1" class="ltx_Math" alttext="330k" display="inline"><semantics id="S4.p1.5.m5.1a"><mrow id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml"><mn id="S4.p1.5.m5.1.1.2" xref="S4.p1.5.m5.1.1.2.cmml">330</mn><mo lspace="0em" rspace="0em" id="S4.p1.5.m5.1.1.1" xref="S4.p1.5.m5.1.1.1.cmml">​</mo><mi id="S4.p1.5.m5.1.1.3" xref="S4.p1.5.m5.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><apply id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1"><times id="S4.p1.5.m5.1.1.1.cmml" xref="S4.p1.5.m5.1.1.1"></times><cn type="integer" id="S4.p1.5.m5.1.1.2.cmml" xref="S4.p1.5.m5.1.1.2">330</cn><ci id="S4.p1.5.m5.1.1.3.cmml" xref="S4.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">330k</annotation></semantics></math> sketches and <math id="S4.p1.6.m6.1" class="ltx_Math" alttext="204k" display="inline"><semantics id="S4.p1.6.m6.1a"><mrow id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml"><mn id="S4.p1.6.m6.1.1.2" xref="S4.p1.6.m6.1.1.2.cmml">204</mn><mo lspace="0em" rspace="0em" id="S4.p1.6.m6.1.1.1" xref="S4.p1.6.m6.1.1.1.cmml">​</mo><mi id="S4.p1.6.m6.1.1.3" xref="S4.p1.6.m6.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.1b"><apply id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1"><times id="S4.p1.6.m6.1.1.1.cmml" xref="S4.p1.6.m6.1.1.1"></times><cn type="integer" id="S4.p1.6.m6.1.1.2.cmml" xref="S4.p1.6.m6.1.1.2">204</cn><ci id="S4.p1.6.m6.1.1.3.cmml" xref="S4.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.1c">204k</annotation></semantics></math> photos from <math id="S4.p1.7.m7.1" class="ltx_Math" alttext="110" display="inline"><semantics id="S4.p1.7.m7.1a"><mn id="S4.p1.7.m7.1.1" xref="S4.p1.7.m7.1.1.cmml">110</mn><annotation-xml encoding="MathML-Content" id="S4.p1.7.m7.1b"><cn type="integer" id="S4.p1.7.m7.1.1.cmml" xref="S4.p1.7.m7.1.1">110</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.7.m7.1c">110</annotation></semantics></math> categories. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib88" title="" class="ltx_ref">88</a>]</cite>, we evaluate on a subset of standard object detection datasets like PASCAL-VOC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and MS-COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> that have <math id="S4.p1.8.m8.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.p1.8.m8.1a"><mn id="S4.p1.8.m8.1.1" xref="S4.p1.8.m8.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.p1.8.m8.1b"><cn type="integer" id="S4.p1.8.m8.1.1.cmml" xref="S4.p1.8.m8.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.8.m8.1c">20</annotation></semantics></math> and <math id="S4.p1.9.m9.1" class="ltx_Math" alttext="56" display="inline"><semantics id="S4.p1.9.m9.1a"><mn id="S4.p1.9.m9.1.1" xref="S4.p1.9.m9.1.1.cmml">56</mn><annotation-xml encoding="MathML-Content" id="S4.p1.9.m9.1b"><cn type="integer" id="S4.p1.9.m9.1.1.cmml" xref="S4.p1.9.m9.1.1">56</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.9.m9.1c">56</annotation></semantics></math> overlapping categories in QuickDraw <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.24" class="ltx_p"><span id="S4.p2.24.1" class="ltx_text ltx_font_bold">Implementation Details</span>  Our model is implemented in PyTorch on a 11GB Nvidia RTX 2080-Ti GPU. First, we train a generalised cross-category FG-SBIR with image size (<math id="S4.p2.1.m1.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mn id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.p2.1.m1.1.1.1" xref="S4.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><times id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1"></times><cn type="integer" id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">224</cn><cn type="integer" id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">224\times 224</annotation></semantics></math>) by adapting CLIP with ViT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> backbone (ViT-B/32 weights) using prompt learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>. The prompts (<math id="S4.p2.2.m2.1" class="ltx_Math" alttext="P=3" display="inline"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">P</mi><mo id="S4.p2.2.m2.1.1.1" xref="S4.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><eq id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1"></eq><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝑃</ci><cn type="integer" id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">P=3</annotation></semantics></math>) are trained with triplet loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib102" title="" class="ltx_ref">102</a>]</cite>, margin <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="\mu=0.3" display="inline"><semantics id="S4.p2.3.m3.1a"><mrow id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mi id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">μ</mi><mo id="S4.p2.3.m3.1.1.1" xref="S4.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><eq id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1"></eq><ci id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">𝜇</ci><cn type="float" id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">\mu=0.3</annotation></semantics></math>, Adam optimiser with learning rate <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="1e-4" display="inline"><semantics id="S4.p2.4.m4.1a"><mrow id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><mrow id="S4.p2.4.m4.1.1.2" xref="S4.p2.4.m4.1.1.2.cmml"><mn id="S4.p2.4.m4.1.1.2.2" xref="S4.p2.4.m4.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.p2.4.m4.1.1.2.1" xref="S4.p2.4.m4.1.1.2.1.cmml">​</mo><mi id="S4.p2.4.m4.1.1.2.3" xref="S4.p2.4.m4.1.1.2.3.cmml">e</mi></mrow><mo id="S4.p2.4.m4.1.1.1" xref="S4.p2.4.m4.1.1.1.cmml">−</mo><mn id="S4.p2.4.m4.1.1.3" xref="S4.p2.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><minus id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1.1"></minus><apply id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1.2"><times id="S4.p2.4.m4.1.1.2.1.cmml" xref="S4.p2.4.m4.1.1.2.1"></times><cn type="integer" id="S4.p2.4.m4.1.1.2.2.cmml" xref="S4.p2.4.m4.1.1.2.2">1</cn><ci id="S4.p2.4.m4.1.1.2.3.cmml" xref="S4.p2.4.m4.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S4.p2.4.m4.1.1.3.cmml" xref="S4.p2.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">1e-4</annotation></semantics></math> for <math id="S4.p2.5.m5.1" class="ltx_Math" alttext="60" display="inline"><semantics id="S4.p2.5.m5.1a"><mn id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><cn type="integer" id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">60</annotation></semantics></math> epochs, and batch size <math id="S4.p2.6.m6.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S4.p2.6.m6.1a"><mn id="S4.p2.6.m6.1.1" xref="S4.p2.6.m6.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S4.p2.6.m6.1b"><cn type="integer" id="S4.p2.6.m6.1.1.cmml" xref="S4.p2.6.m6.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m6.1c">64</annotation></semantics></math>. Our object detection pipeline is build using Detectron2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib93" title="" class="ltx_ref">93</a>]</cite>. We use FasterRCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>, pretrained on Visual Genome <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> and remove the RoIPooling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> and subsequent layers to keep only the pretrained backbone ResNet+FPN (<math id="S4.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{F}_{d}" display="inline"><semantics id="S4.p2.7.m7.1a"><msub id="S4.p2.7.m7.1.1" xref="S4.p2.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.7.m7.1.1.2" xref="S4.p2.7.m7.1.1.2.cmml">ℱ</mi><mi id="S4.p2.7.m7.1.1.3" xref="S4.p2.7.m7.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.7.m7.1b"><apply id="S4.p2.7.m7.1.1.cmml" xref="S4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p2.7.m7.1.1.1.cmml" xref="S4.p2.7.m7.1.1">subscript</csymbol><ci id="S4.p2.7.m7.1.1.2.cmml" xref="S4.p2.7.m7.1.1.2">ℱ</ci><ci id="S4.p2.7.m7.1.1.3.cmml" xref="S4.p2.7.m7.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m7.1c">\mathcal{F}_{d}</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> and Region Proposal Network (<math id="S4.p2.8.m8.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S4.p2.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p2.8.m8.1.1" xref="S4.p2.8.m8.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S4.p2.8.m8.1b"><ci id="S4.p2.8.m8.1.1.cmml" xref="S4.p2.8.m8.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m8.1c">\mathcal{R}</annotation></semantics></math>) that generates <math id="S4.p2.9.m9.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S4.p2.9.m9.1a"><mn id="S4.p2.9.m9.1.1" xref="S4.p2.9.m9.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S4.p2.9.m9.1b"><cn type="integer" id="S4.p2.9.m9.1.1.cmml" xref="S4.p2.9.m9.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.9.m9.1c">1000</annotation></semantics></math> proposals. An alternative is to use handcrafted region proposals like selective search <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib89" title="" class="ltx_ref">89</a>]</cite>, but we observed slight performance drop. The object detector trains using SGD with batch size <math id="S4.p2.10.m10.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S4.p2.10.m10.1a"><mn id="S4.p2.10.m10.1.1" xref="S4.p2.10.m10.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.p2.10.m10.1b"><cn type="integer" id="S4.p2.10.m10.1.1.cmml" xref="S4.p2.10.m10.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.10.m10.1c">8</annotation></semantics></math> and initial learning rate <math id="S4.p2.11.m11.1" class="ltx_Math" alttext="5e-3" display="inline"><semantics id="S4.p2.11.m11.1a"><mrow id="S4.p2.11.m11.1.1" xref="S4.p2.11.m11.1.1.cmml"><mrow id="S4.p2.11.m11.1.1.2" xref="S4.p2.11.m11.1.1.2.cmml"><mn id="S4.p2.11.m11.1.1.2.2" xref="S4.p2.11.m11.1.1.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="S4.p2.11.m11.1.1.2.1" xref="S4.p2.11.m11.1.1.2.1.cmml">​</mo><mi id="S4.p2.11.m11.1.1.2.3" xref="S4.p2.11.m11.1.1.2.3.cmml">e</mi></mrow><mo id="S4.p2.11.m11.1.1.1" xref="S4.p2.11.m11.1.1.1.cmml">−</mo><mn id="S4.p2.11.m11.1.1.3" xref="S4.p2.11.m11.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.11.m11.1b"><apply id="S4.p2.11.m11.1.1.cmml" xref="S4.p2.11.m11.1.1"><minus id="S4.p2.11.m11.1.1.1.cmml" xref="S4.p2.11.m11.1.1.1"></minus><apply id="S4.p2.11.m11.1.1.2.cmml" xref="S4.p2.11.m11.1.1.2"><times id="S4.p2.11.m11.1.1.2.1.cmml" xref="S4.p2.11.m11.1.1.2.1"></times><cn type="integer" id="S4.p2.11.m11.1.1.2.2.cmml" xref="S4.p2.11.m11.1.1.2.2">5</cn><ci id="S4.p2.11.m11.1.1.2.3.cmml" xref="S4.p2.11.m11.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S4.p2.11.m11.1.1.3.cmml" xref="S4.p2.11.m11.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.11.m11.1c">5e-3</annotation></semantics></math>, multiplied by <math id="S4.p2.12.m12.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S4.p2.12.m12.1a"><mn id="S4.p2.12.m12.1.1" xref="S4.p2.12.m12.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S4.p2.12.m12.1b"><cn type="float" id="S4.p2.12.m12.1.1.cmml" xref="S4.p2.12.m12.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.12.m12.1c">0.1</annotation></semantics></math> at <math id="S4.p2.13.m13.1" class="ltx_Math" alttext="150k" display="inline"><semantics id="S4.p2.13.m13.1a"><mrow id="S4.p2.13.m13.1.1" xref="S4.p2.13.m13.1.1.cmml"><mn id="S4.p2.13.m13.1.1.2" xref="S4.p2.13.m13.1.1.2.cmml">150</mn><mo lspace="0em" rspace="0em" id="S4.p2.13.m13.1.1.1" xref="S4.p2.13.m13.1.1.1.cmml">​</mo><mi id="S4.p2.13.m13.1.1.3" xref="S4.p2.13.m13.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.13.m13.1b"><apply id="S4.p2.13.m13.1.1.cmml" xref="S4.p2.13.m13.1.1"><times id="S4.p2.13.m13.1.1.1.cmml" xref="S4.p2.13.m13.1.1.1"></times><cn type="integer" id="S4.p2.13.m13.1.1.2.cmml" xref="S4.p2.13.m13.1.1.2">150</cn><ci id="S4.p2.13.m13.1.1.3.cmml" xref="S4.p2.13.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.13.m13.1c">150k</annotation></semantics></math> and <math id="S4.p2.14.m14.1" class="ltx_Math" alttext="250k" display="inline"><semantics id="S4.p2.14.m14.1a"><mrow id="S4.p2.14.m14.1.1" xref="S4.p2.14.m14.1.1.cmml"><mn id="S4.p2.14.m14.1.1.2" xref="S4.p2.14.m14.1.1.2.cmml">250</mn><mo lspace="0em" rspace="0em" id="S4.p2.14.m14.1.1.1" xref="S4.p2.14.m14.1.1.1.cmml">​</mo><mi id="S4.p2.14.m14.1.1.3" xref="S4.p2.14.m14.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.14.m14.1b"><apply id="S4.p2.14.m14.1.1.cmml" xref="S4.p2.14.m14.1.1"><times id="S4.p2.14.m14.1.1.1.cmml" xref="S4.p2.14.m14.1.1.1"></times><cn type="integer" id="S4.p2.14.m14.1.1.2.cmml" xref="S4.p2.14.m14.1.1.2">250</cn><ci id="S4.p2.14.m14.1.1.3.cmml" xref="S4.p2.14.m14.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.14.m14.1c">250k</annotation></semantics></math> iterations. We train in a two-step process: (i) keeping <math id="S4.p2.15.m15.1" class="ltx_Math" alttext="\mathcal{F}_{d}" display="inline"><semantics id="S4.p2.15.m15.1a"><msub id="S4.p2.15.m15.1.1" xref="S4.p2.15.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.15.m15.1.1.2" xref="S4.p2.15.m15.1.1.2.cmml">ℱ</mi><mi id="S4.p2.15.m15.1.1.3" xref="S4.p2.15.m15.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.15.m15.1b"><apply id="S4.p2.15.m15.1.1.cmml" xref="S4.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S4.p2.15.m15.1.1.1.cmml" xref="S4.p2.15.m15.1.1">subscript</csymbol><ci id="S4.p2.15.m15.1.1.2.cmml" xref="S4.p2.15.m15.1.1.2">ℱ</ci><ci id="S4.p2.15.m15.1.1.3.cmml" xref="S4.p2.15.m15.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.15.m15.1c">\mathcal{F}_{d}</annotation></semantics></math> and <math id="S4.p2.16.m16.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S4.p2.16.m16.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p2.16.m16.1.1" xref="S4.p2.16.m16.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S4.p2.16.m16.1b"><ci id="S4.p2.16.m16.1.1.cmml" xref="S4.p2.16.m16.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.16.m16.1c">\mathcal{R}</annotation></semantics></math> fixed, we train the RoI pooling and FC layers (<math id="S4.p2.17.m17.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S4.p2.17.m17.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p2.17.m17.1.1" xref="S4.p2.17.m17.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S4.p2.17.m17.1b"><ci id="S4.p2.17.m17.1.1.cmml" xref="S4.p2.17.m17.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.17.m17.1c">\mathcal{P}</annotation></semantics></math>), classification head (<math id="S4.p2.18.m18.1" class="ltx_Math" alttext="\phi_{cls}" display="inline"><semantics id="S4.p2.18.m18.1a"><msub id="S4.p2.18.m18.1.1" xref="S4.p2.18.m18.1.1.cmml"><mi id="S4.p2.18.m18.1.1.2" xref="S4.p2.18.m18.1.1.2.cmml">ϕ</mi><mrow id="S4.p2.18.m18.1.1.3" xref="S4.p2.18.m18.1.1.3.cmml"><mi id="S4.p2.18.m18.1.1.3.2" xref="S4.p2.18.m18.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.p2.18.m18.1.1.3.1" xref="S4.p2.18.m18.1.1.3.1.cmml">​</mo><mi id="S4.p2.18.m18.1.1.3.3" xref="S4.p2.18.m18.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.p2.18.m18.1.1.3.1a" xref="S4.p2.18.m18.1.1.3.1.cmml">​</mo><mi id="S4.p2.18.m18.1.1.3.4" xref="S4.p2.18.m18.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.18.m18.1b"><apply id="S4.p2.18.m18.1.1.cmml" xref="S4.p2.18.m18.1.1"><csymbol cd="ambiguous" id="S4.p2.18.m18.1.1.1.cmml" xref="S4.p2.18.m18.1.1">subscript</csymbol><ci id="S4.p2.18.m18.1.1.2.cmml" xref="S4.p2.18.m18.1.1.2">italic-ϕ</ci><apply id="S4.p2.18.m18.1.1.3.cmml" xref="S4.p2.18.m18.1.1.3"><times id="S4.p2.18.m18.1.1.3.1.cmml" xref="S4.p2.18.m18.1.1.3.1"></times><ci id="S4.p2.18.m18.1.1.3.2.cmml" xref="S4.p2.18.m18.1.1.3.2">𝑐</ci><ci id="S4.p2.18.m18.1.1.3.3.cmml" xref="S4.p2.18.m18.1.1.3.3">𝑙</ci><ci id="S4.p2.18.m18.1.1.3.4.cmml" xref="S4.p2.18.m18.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.18.m18.1c">\phi_{cls}</annotation></semantics></math>), detection head (<math id="S4.p2.19.m19.1" class="ltx_Math" alttext="\phi_{det}" display="inline"><semantics id="S4.p2.19.m19.1a"><msub id="S4.p2.19.m19.1.1" xref="S4.p2.19.m19.1.1.cmml"><mi id="S4.p2.19.m19.1.1.2" xref="S4.p2.19.m19.1.1.2.cmml">ϕ</mi><mrow id="S4.p2.19.m19.1.1.3" xref="S4.p2.19.m19.1.1.3.cmml"><mi id="S4.p2.19.m19.1.1.3.2" xref="S4.p2.19.m19.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.p2.19.m19.1.1.3.1" xref="S4.p2.19.m19.1.1.3.1.cmml">​</mo><mi id="S4.p2.19.m19.1.1.3.3" xref="S4.p2.19.m19.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p2.19.m19.1.1.3.1a" xref="S4.p2.19.m19.1.1.3.1.cmml">​</mo><mi id="S4.p2.19.m19.1.1.3.4" xref="S4.p2.19.m19.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.19.m19.1b"><apply id="S4.p2.19.m19.1.1.cmml" xref="S4.p2.19.m19.1.1"><csymbol cd="ambiguous" id="S4.p2.19.m19.1.1.1.cmml" xref="S4.p2.19.m19.1.1">subscript</csymbol><ci id="S4.p2.19.m19.1.1.2.cmml" xref="S4.p2.19.m19.1.1.2">italic-ϕ</ci><apply id="S4.p2.19.m19.1.1.3.cmml" xref="S4.p2.19.m19.1.1.3"><times id="S4.p2.19.m19.1.1.3.1.cmml" xref="S4.p2.19.m19.1.1.3.1"></times><ci id="S4.p2.19.m19.1.1.3.2.cmml" xref="S4.p2.19.m19.1.1.3.2">𝑑</ci><ci id="S4.p2.19.m19.1.1.3.3.cmml" xref="S4.p2.19.m19.1.1.3.3">𝑒</ci><ci id="S4.p2.19.m19.1.1.3.4.cmml" xref="S4.p2.19.m19.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.19.m19.1c">\phi_{det}</annotation></semantics></math>), and refinement head (<math id="S4.p2.20.m20.1" class="ltx_Math" alttext="\phi_{cls}^{*}" display="inline"><semantics id="S4.p2.20.m20.1a"><msubsup id="S4.p2.20.m20.1.1" xref="S4.p2.20.m20.1.1.cmml"><mi id="S4.p2.20.m20.1.1.2.2" xref="S4.p2.20.m20.1.1.2.2.cmml">ϕ</mi><mrow id="S4.p2.20.m20.1.1.2.3" xref="S4.p2.20.m20.1.1.2.3.cmml"><mi id="S4.p2.20.m20.1.1.2.3.2" xref="S4.p2.20.m20.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.p2.20.m20.1.1.2.3.1" xref="S4.p2.20.m20.1.1.2.3.1.cmml">​</mo><mi id="S4.p2.20.m20.1.1.2.3.3" xref="S4.p2.20.m20.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.p2.20.m20.1.1.2.3.1a" xref="S4.p2.20.m20.1.1.2.3.1.cmml">​</mo><mi id="S4.p2.20.m20.1.1.2.3.4" xref="S4.p2.20.m20.1.1.2.3.4.cmml">s</mi></mrow><mo id="S4.p2.20.m20.1.1.3" xref="S4.p2.20.m20.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p2.20.m20.1b"><apply id="S4.p2.20.m20.1.1.cmml" xref="S4.p2.20.m20.1.1"><csymbol cd="ambiguous" id="S4.p2.20.m20.1.1.1.cmml" xref="S4.p2.20.m20.1.1">superscript</csymbol><apply id="S4.p2.20.m20.1.1.2.cmml" xref="S4.p2.20.m20.1.1"><csymbol cd="ambiguous" id="S4.p2.20.m20.1.1.2.1.cmml" xref="S4.p2.20.m20.1.1">subscript</csymbol><ci id="S4.p2.20.m20.1.1.2.2.cmml" xref="S4.p2.20.m20.1.1.2.2">italic-ϕ</ci><apply id="S4.p2.20.m20.1.1.2.3.cmml" xref="S4.p2.20.m20.1.1.2.3"><times id="S4.p2.20.m20.1.1.2.3.1.cmml" xref="S4.p2.20.m20.1.1.2.3.1"></times><ci id="S4.p2.20.m20.1.1.2.3.2.cmml" xref="S4.p2.20.m20.1.1.2.3.2">𝑐</ci><ci id="S4.p2.20.m20.1.1.2.3.3.cmml" xref="S4.p2.20.m20.1.1.2.3.3">𝑙</ci><ci id="S4.p2.20.m20.1.1.2.3.4.cmml" xref="S4.p2.20.m20.1.1.2.3.4">𝑠</ci></apply></apply><times id="S4.p2.20.m20.1.1.3.cmml" xref="S4.p2.20.m20.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.20.m20.1c">\phi_{cls}^{*}</annotation></semantics></math>) for <math id="S4.p2.21.m21.1" class="ltx_Math" alttext="240k" display="inline"><semantics id="S4.p2.21.m21.1a"><mrow id="S4.p2.21.m21.1.1" xref="S4.p2.21.m21.1.1.cmml"><mn id="S4.p2.21.m21.1.1.2" xref="S4.p2.21.m21.1.1.2.cmml">240</mn><mo lspace="0em" rspace="0em" id="S4.p2.21.m21.1.1.1" xref="S4.p2.21.m21.1.1.1.cmml">​</mo><mi id="S4.p2.21.m21.1.1.3" xref="S4.p2.21.m21.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.21.m21.1b"><apply id="S4.p2.21.m21.1.1.cmml" xref="S4.p2.21.m21.1.1"><times id="S4.p2.21.m21.1.1.1.cmml" xref="S4.p2.21.m21.1.1.1"></times><cn type="integer" id="S4.p2.21.m21.1.1.2.cmml" xref="S4.p2.21.m21.1.1.2">240</cn><ci id="S4.p2.21.m21.1.1.3.cmml" xref="S4.p2.21.m21.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.21.m21.1c">240k</annotation></semantics></math> iterations. (ii) We freeze only <math id="S4.p2.22.m22.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S4.p2.22.m22.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p2.22.m22.1.1" xref="S4.p2.22.m22.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S4.p2.22.m22.1b"><ci id="S4.p2.22.m22.1.1.cmml" xref="S4.p2.22.m22.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.22.m22.1c">\mathcal{R}</annotation></semantics></math> and finetune all modules for <math id="S4.p2.23.m23.1" class="ltx_Math" alttext="80k" display="inline"><semantics id="S4.p2.23.m23.1a"><mrow id="S4.p2.23.m23.1.1" xref="S4.p2.23.m23.1.1.cmml"><mn id="S4.p2.23.m23.1.1.2" xref="S4.p2.23.m23.1.1.2.cmml">80</mn><mo lspace="0em" rspace="0em" id="S4.p2.23.m23.1.1.1" xref="S4.p2.23.m23.1.1.1.cmml">​</mo><mi id="S4.p2.23.m23.1.1.3" xref="S4.p2.23.m23.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.23.m23.1b"><apply id="S4.p2.23.m23.1.1.cmml" xref="S4.p2.23.m23.1.1"><times id="S4.p2.23.m23.1.1.1.cmml" xref="S4.p2.23.m23.1.1.1"></times><cn type="integer" id="S4.p2.23.m23.1.1.2.cmml" xref="S4.p2.23.m23.1.1.2">80</cn><ci id="S4.p2.23.m23.1.1.3.cmml" xref="S4.p2.23.m23.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.23.m23.1c">80k</annotation></semantics></math> iterations. Non-maxima suppression with IoU <math id="S4.p2.24.m24.1" class="ltx_Math" alttext="\geq 0.3" display="inline"><semantics id="S4.p2.24.m24.1a"><mrow id="S4.p2.24.m24.1.1" xref="S4.p2.24.m24.1.1.cmml"><mi id="S4.p2.24.m24.1.1.2" xref="S4.p2.24.m24.1.1.2.cmml"></mi><mo id="S4.p2.24.m24.1.1.1" xref="S4.p2.24.m24.1.1.1.cmml">≥</mo><mn id="S4.p2.24.m24.1.1.3" xref="S4.p2.24.m24.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.24.m24.1b"><apply id="S4.p2.24.m24.1.1.cmml" xref="S4.p2.24.m24.1.1"><geq id="S4.p2.24.m24.1.1.1.cmml" xref="S4.p2.24.m24.1.1.1"></geq><csymbol cd="latexml" id="S4.p2.24.m24.1.1.2.cmml" xref="S4.p2.24.m24.1.1.2">absent</csymbol><cn type="float" id="S4.p2.24.m24.1.1.3.cmml" xref="S4.p2.24.m24.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.24.m24.1c">\geq 0.3</annotation></semantics></math> is applied to get final predictions.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.10" class="ltx_p"><span id="S4.p3.10.1" class="ltx_text ltx_font_bold">Evaluation Metric</span>  (i) For fine-grained object detection, we measure <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="AP_{.3}" display="inline"><semantics id="S4.p3.1.m1.1a"><mrow id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.p3.1.m1.1.1.1" xref="S4.p3.1.m1.1.1.1.cmml">​</mo><msub id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml"><mi id="S4.p3.1.m1.1.1.3.2" xref="S4.p3.1.m1.1.1.3.2.cmml">P</mi><mn id="S4.p3.1.m1.1.1.3.3" xref="S4.p3.1.m1.1.1.3.3.cmml">.3</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><times id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1.1"></times><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">𝐴</ci><apply id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.3.1.cmml" xref="S4.p3.1.m1.1.1.3">subscript</csymbol><ci id="S4.p3.1.m1.1.1.3.2.cmml" xref="S4.p3.1.m1.1.1.3.2">𝑃</ci><cn type="float" id="S4.p3.1.m1.1.1.3.3.cmml" xref="S4.p3.1.m1.1.1.3.3">.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">AP_{.3}</annotation></semantics></math>, <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mi id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.p3.2.m2.1.1.1" xref="S4.p3.2.m2.1.1.1.cmml">​</mo><msub id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3.cmml"><mi id="S4.p3.2.m2.1.1.3.2" xref="S4.p3.2.m2.1.1.3.2.cmml">P</mi><mn id="S4.p3.2.m2.1.1.3.3" xref="S4.p3.2.m2.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><times id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1"></times><ci id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2">𝐴</ci><apply id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.p3.2.m2.1.1.3.1.cmml" xref="S4.p3.2.m2.1.1.3">subscript</csymbol><ci id="S4.p3.2.m2.1.1.3.2.cmml" xref="S4.p3.2.m2.1.1.3.2">𝑃</ci><cn type="float" id="S4.p3.2.m2.1.1.3.3.cmml" xref="S4.p3.2.m2.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">AP_{.5}</annotation></semantics></math>, and <math id="S4.p3.3.m3.1" class="ltx_Math" alttext="AP_{.7}" display="inline"><semantics id="S4.p3.3.m3.1a"><mrow id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml"><mi id="S4.p3.3.m3.1.1.2" xref="S4.p3.3.m3.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.1.1.1" xref="S4.p3.3.m3.1.1.1.cmml">​</mo><msub id="S4.p3.3.m3.1.1.3" xref="S4.p3.3.m3.1.1.3.cmml"><mi id="S4.p3.3.m3.1.1.3.2" xref="S4.p3.3.m3.1.1.3.2.cmml">P</mi><mn id="S4.p3.3.m3.1.1.3.3" xref="S4.p3.3.m3.1.1.3.3.cmml">.7</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1"><times id="S4.p3.3.m3.1.1.1.cmml" xref="S4.p3.3.m3.1.1.1"></times><ci id="S4.p3.3.m3.1.1.2.cmml" xref="S4.p3.3.m3.1.1.2">𝐴</ci><apply id="S4.p3.3.m3.1.1.3.cmml" xref="S4.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.1.3.1.cmml" xref="S4.p3.3.m3.1.1.3">subscript</csymbol><ci id="S4.p3.3.m3.1.1.3.2.cmml" xref="S4.p3.3.m3.1.1.3.2">𝑃</ci><cn type="float" id="S4.p3.3.m3.1.1.3.3.cmml" xref="S4.p3.3.m3.1.1.3.3">.7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">AP_{.7}</annotation></semantics></math> that computes the average precision (AP) at IoU values <math id="S4.p3.4.m4.1" class="ltx_Math" alttext="0.3" display="inline"><semantics id="S4.p3.4.m4.1a"><mn id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><cn type="float" id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">0.3</annotation></semantics></math>, <math id="S4.p3.5.m5.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S4.p3.5.m5.1a"><mn id="S4.p3.5.m5.1.1" xref="S4.p3.5.m5.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S4.p3.5.m5.1b"><cn type="float" id="S4.p3.5.m5.1.1.cmml" xref="S4.p3.5.m5.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m5.1c">0.5</annotation></semantics></math>, and <math id="S4.p3.6.m6.1" class="ltx_Math" alttext="0.7" display="inline"><semantics id="S4.p3.6.m6.1a"><mn id="S4.p3.6.m6.1.1" xref="S4.p3.6.m6.1.1.cmml">0.7</mn><annotation-xml encoding="MathML-Content" id="S4.p3.6.m6.1b"><cn type="float" id="S4.p3.6.m6.1.1.cmml" xref="S4.p3.6.m6.1.1">0.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.6.m6.1c">0.7</annotation></semantics></math>. (ii) For category-level object detection, we use measure <math id="S4.p3.7.m7.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="S4.p3.7.m7.1a"><mrow id="S4.p3.7.m7.1.1" xref="S4.p3.7.m7.1.1.cmml"><mi id="S4.p3.7.m7.1.1.2" xref="S4.p3.7.m7.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.p3.7.m7.1.1.1" xref="S4.p3.7.m7.1.1.1.cmml">​</mo><msub id="S4.p3.7.m7.1.1.3" xref="S4.p3.7.m7.1.1.3.cmml"><mi id="S4.p3.7.m7.1.1.3.2" xref="S4.p3.7.m7.1.1.3.2.cmml">P</mi><mn id="S4.p3.7.m7.1.1.3.3" xref="S4.p3.7.m7.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.7.m7.1b"><apply id="S4.p3.7.m7.1.1.cmml" xref="S4.p3.7.m7.1.1"><times id="S4.p3.7.m7.1.1.1.cmml" xref="S4.p3.7.m7.1.1.1"></times><ci id="S4.p3.7.m7.1.1.2.cmml" xref="S4.p3.7.m7.1.1.2">𝐴</ci><apply id="S4.p3.7.m7.1.1.3.cmml" xref="S4.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.p3.7.m7.1.1.3.1.cmml" xref="S4.p3.7.m7.1.1.3">subscript</csymbol><ci id="S4.p3.7.m7.1.1.3.2.cmml" xref="S4.p3.7.m7.1.1.3.2">𝑃</ci><cn type="float" id="S4.p3.7.m7.1.1.3.3.cmml" xref="S4.p3.7.m7.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.7.m7.1c">AP_{.5}</annotation></semantics></math> and <em id="S4.p3.10.2" class="ltx_emph ltx_font_italic">CorLoc</em> that computes percentage of images for which the most confident predicted box has IoU <math id="S4.p3.8.m8.1" class="ltx_Math" alttext="\geq 0.5" display="inline"><semantics id="S4.p3.8.m8.1a"><mrow id="S4.p3.8.m8.1.1" xref="S4.p3.8.m8.1.1.cmml"><mi id="S4.p3.8.m8.1.1.2" xref="S4.p3.8.m8.1.1.2.cmml"></mi><mo id="S4.p3.8.m8.1.1.1" xref="S4.p3.8.m8.1.1.1.cmml">≥</mo><mn id="S4.p3.8.m8.1.1.3" xref="S4.p3.8.m8.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.8.m8.1b"><apply id="S4.p3.8.m8.1.1.cmml" xref="S4.p3.8.m8.1.1"><geq id="S4.p3.8.m8.1.1.1.cmml" xref="S4.p3.8.m8.1.1.1"></geq><csymbol cd="latexml" id="S4.p3.8.m8.1.1.2.cmml" xref="S4.p3.8.m8.1.1.2">absent</csymbol><cn type="float" id="S4.p3.8.m8.1.1.3.cmml" xref="S4.p3.8.m8.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.8.m8.1c">\geq 0.5</annotation></semantics></math> with at least one of the ground-truth boxes for every class. (iii) For cross-category FG-SBIR, we measures <math id="S4.p3.9.m9.2" class="ltx_Math" alttext="Acc.@q" display="inline"><semantics id="S4.p3.9.m9.2a"><mrow id="S4.p3.9.m9.2.2.2" xref="S4.p3.9.m9.2.2.3.cmml"><mrow id="S4.p3.9.m9.1.1.1.1" xref="S4.p3.9.m9.1.1.1.1.cmml"><mi id="S4.p3.9.m9.1.1.1.1.2" xref="S4.p3.9.m9.1.1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.p3.9.m9.1.1.1.1.1" xref="S4.p3.9.m9.1.1.1.1.1.cmml">​</mo><mi id="S4.p3.9.m9.1.1.1.1.3" xref="S4.p3.9.m9.1.1.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.p3.9.m9.1.1.1.1.1a" xref="S4.p3.9.m9.1.1.1.1.1.cmml">​</mo><mi id="S4.p3.9.m9.1.1.1.1.4" xref="S4.p3.9.m9.1.1.1.1.4.cmml">c</mi></mrow><mo lspace="0em" rspace="0.167em" id="S4.p3.9.m9.2.2.2.3" xref="S4.p3.9.m9.2.2.3a.cmml">.</mo><mrow id="S4.p3.9.m9.2.2.2.2" xref="S4.p3.9.m9.2.2.2.2.cmml"><mi mathvariant="normal" id="S4.p3.9.m9.2.2.2.2.2" xref="S4.p3.9.m9.2.2.2.2.2.cmml">@</mi><mo lspace="0em" rspace="0em" id="S4.p3.9.m9.2.2.2.2.1" xref="S4.p3.9.m9.2.2.2.2.1.cmml">​</mo><mi id="S4.p3.9.m9.2.2.2.2.3" xref="S4.p3.9.m9.2.2.2.2.3.cmml">q</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.9.m9.2b"><apply id="S4.p3.9.m9.2.2.3.cmml" xref="S4.p3.9.m9.2.2.2"><csymbol cd="ambiguous" id="S4.p3.9.m9.2.2.3a.cmml" xref="S4.p3.9.m9.2.2.2.3">formulae-sequence</csymbol><apply id="S4.p3.9.m9.1.1.1.1.cmml" xref="S4.p3.9.m9.1.1.1.1"><times id="S4.p3.9.m9.1.1.1.1.1.cmml" xref="S4.p3.9.m9.1.1.1.1.1"></times><ci id="S4.p3.9.m9.1.1.1.1.2.cmml" xref="S4.p3.9.m9.1.1.1.1.2">𝐴</ci><ci id="S4.p3.9.m9.1.1.1.1.3.cmml" xref="S4.p3.9.m9.1.1.1.1.3">𝑐</ci><ci id="S4.p3.9.m9.1.1.1.1.4.cmml" xref="S4.p3.9.m9.1.1.1.1.4">𝑐</ci></apply><apply id="S4.p3.9.m9.2.2.2.2.cmml" xref="S4.p3.9.m9.2.2.2.2"><times id="S4.p3.9.m9.2.2.2.2.1.cmml" xref="S4.p3.9.m9.2.2.2.2.1"></times><ci id="S4.p3.9.m9.2.2.2.2.2.cmml" xref="S4.p3.9.m9.2.2.2.2.2">@</ci><ci id="S4.p3.9.m9.2.2.2.2.3.cmml" xref="S4.p3.9.m9.2.2.2.2.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.9.m9.2c">Acc.@q</annotation></semantics></math> – percentage of sketches having true matched photo in the top-q list, and (iv) mean average precision (mAP), and precision considering top <math id="S4.p3.10.m10.1" class="ltx_Math" alttext="200" display="inline"><semantics id="S4.p3.10.m10.1a"><mn id="S4.p3.10.m10.1.1" xref="S4.p3.10.m10.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.p3.10.m10.1b"><cn type="integer" id="S4.p3.10.m10.1.1.cmml" xref="S4.p3.10.m10.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.10.m10.1c">200</annotation></semantics></math> retrievals P@200 for category-level SBIR.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Competitors</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.6" class="ltx_p">For object detection, we compare against, (i) supervised object detection (SOD) using both bounding box in addition to sketch/photo annotations: <span id="S4.SS1.p1.6.4" class="ltx_text ltx_font_bold">Mod-FRCNN</span> adapts Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite> for unseen class by concatenating query sketch feature with the RoI pooled feature followed by a binary classifier. <span id="S4.SS1.p1.6.5" class="ltx_text ltx_font_bold">MatchNet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> extends <em id="S4.SS1.p1.6.6" class="ltx_emph ltx_font_italic">Mod-FRCNN</em> using co-attention to generate region proposals conditioned on query sketch along with squeeze-and-co-excitation to adaptively re-weight importance distribution of candidate proposals. <span id="S4.SS1.p1.6.7" class="ltx_text ltx_font_bold">CoAttOD</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib88" title="" class="ltx_ref">88</a>]</cite> improves upon <em id="S4.SS1.p1.6.8" class="ltx_emph ltx_font_italic">MatchNet</em> by mitigating the sketch/photo domain misalignment using cross-modal attention. (ii) Weakly supervised object detection (WSOD) trains only on image-level sketch annotations without any additional bounding boxes: <span id="S4.SS1.p1.6.9" class="ltx_text ltx_font_bold">WSDDN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> repurposed object detection as a region classification via multiple instance learning (MIL) paradigm. To inject query sketch to <em id="S4.SS1.p1.6.10" class="ltx_emph ltx_font_italic">WSDDN</em>, we use cross-attention with RoI pooled feature followed by a binary classifier for detection. <span id="S4.SS1.p1.6.11" class="ltx_text ltx_font_bold">OICR</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib86" title="" class="ltx_ref">86</a>]</cite> improves <em id="S4.SS1.p1.6.12" class="ltx_emph ltx_font_italic">WSDDN</em> with an iterative MIL to refine initial predictions scores to improve discriminatory power for detection. <span id="S4.SS1.p1.6.13" class="ltx_text ltx_font_bold">PCL</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib85" title="" class="ltx_ref">85</a>]</cite> generates multiple positive instance in an image via clustering and assigning proposals to the label of corresponding object class for each cluster. <span id="S4.SS1.p1.6.14" class="ltx_text ltx_font_bold">ICMWSD</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite> addresses the problem of prior WSOD that focus on the most discriminative part of an object using context information. In particular, <em id="S4.SS1.p1.6.15" class="ltx_emph ltx_font_italic">ICMWSD</em> obtains a “dropped feature” by dropping the most discriminative parts, followed by maximising the loss of the “dropped feature” that force the network to look in the surrounding context regions. (iii) We adapt <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mo id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><lt id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">&lt;</annotation></semantics></math><span id="S4.SS1.p1.2.1" class="ltx_text ltx_font_bold">Method<math id="S4.SS1.p1.2.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S4.SS1.p1.2.1.m1.1a"><mo id="S4.SS1.p1.2.1.m1.1.1" xref="S4.SS1.p1.2.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.1.m1.1b"><gt id="S4.SS1.p1.2.1.m1.1.1.cmml" xref="S4.SS1.p1.2.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.1.m1.1c">&gt;</annotation></semantics></math></span> in <em id="S4.SS1.p1.6.16" class="ltx_emph ltx_font_italic">WSOD</em> to <span id="S4.SS1.p1.4.3" class="ltx_text ltx_font_bold">E-<math id="S4.SS1.p1.3.2.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S4.SS1.p1.3.2.m1.1a"><mo id="S4.SS1.p1.3.2.m1.1.1" xref="S4.SS1.p1.3.2.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.2.m1.1b"><lt id="S4.SS1.p1.3.2.m1.1.1.cmml" xref="S4.SS1.p1.3.2.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.2.m1.1c">&lt;</annotation></semantics></math>Method<math id="S4.SS1.p1.4.3.m2.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S4.SS1.p1.4.3.m2.1a"><mo id="S4.SS1.p1.4.3.m2.1.1" xref="S4.SS1.p1.4.3.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.3.m2.1b"><gt id="S4.SS1.p1.4.3.m2.1.1.cmml" xref="S4.SS1.p1.4.3.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.3.m2.1c">&gt;</annotation></semantics></math></span> that exclusively training on SBIR datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite> by synthesising canvas with randomly tiling <math id="S4.SS1.p1.5.m2.3" class="ltx_Math" alttext="n=\{1,\dots,7\}" display="inline"><semantics id="S4.SS1.p1.5.m2.3a"><mrow id="S4.SS1.p1.5.m2.3.4" xref="S4.SS1.p1.5.m2.3.4.cmml"><mi id="S4.SS1.p1.5.m2.3.4.2" xref="S4.SS1.p1.5.m2.3.4.2.cmml">n</mi><mo id="S4.SS1.p1.5.m2.3.4.1" xref="S4.SS1.p1.5.m2.3.4.1.cmml">=</mo><mrow id="S4.SS1.p1.5.m2.3.4.3.2" xref="S4.SS1.p1.5.m2.3.4.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.5.m2.3.4.3.2.1" xref="S4.SS1.p1.5.m2.3.4.3.1.cmml">{</mo><mn id="S4.SS1.p1.5.m2.1.1" xref="S4.SS1.p1.5.m2.1.1.cmml">1</mn><mo id="S4.SS1.p1.5.m2.3.4.3.2.2" xref="S4.SS1.p1.5.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.5.m2.2.2" xref="S4.SS1.p1.5.m2.2.2.cmml">…</mi><mo id="S4.SS1.p1.5.m2.3.4.3.2.3" xref="S4.SS1.p1.5.m2.3.4.3.1.cmml">,</mo><mn id="S4.SS1.p1.5.m2.3.3" xref="S4.SS1.p1.5.m2.3.3.cmml">7</mn><mo stretchy="false" id="S4.SS1.p1.5.m2.3.4.3.2.4" xref="S4.SS1.p1.5.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m2.3b"><apply id="S4.SS1.p1.5.m2.3.4.cmml" xref="S4.SS1.p1.5.m2.3.4"><eq id="S4.SS1.p1.5.m2.3.4.1.cmml" xref="S4.SS1.p1.5.m2.3.4.1"></eq><ci id="S4.SS1.p1.5.m2.3.4.2.cmml" xref="S4.SS1.p1.5.m2.3.4.2">𝑛</ci><set id="S4.SS1.p1.5.m2.3.4.3.1.cmml" xref="S4.SS1.p1.5.m2.3.4.3.2"><cn type="integer" id="S4.SS1.p1.5.m2.1.1.cmml" xref="S4.SS1.p1.5.m2.1.1">1</cn><ci id="S4.SS1.p1.5.m2.2.2.cmml" xref="S4.SS1.p1.5.m2.2.2">…</ci><cn type="integer" id="S4.SS1.p1.5.m2.3.3.cmml" xref="S4.SS1.p1.5.m2.3.3">7</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m2.3c">n=\{1,\dots,7\}</annotation></semantics></math> object-level photos and using their paired sketches to construct the support <math id="S4.SS1.p1.6.m3.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S4.SS1.p1.6.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m3.1.1" xref="S4.SS1.p1.6.m3.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m3.1b"><ci id="S4.SS1.p1.6.m3.1.1.cmml" xref="S4.SS1.p1.6.m3.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m3.1c">\mathcal{S}</annotation></semantics></math>. We call this setup – extreme weakly supervised object detection (EWSOD).</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">For zero-shot category-level SBIR, we compare against: <span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">GRL</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> combines similar semantic information (word2vec <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>) of class labels with visual sketch information and trains using a gradient reversal layer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> to reduce sketch/photo domain gap. <span id="S4.SS1.p2.1.2" class="ltx_text ltx_font_bold">VKD</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib91" title="" class="ltx_ref">91</a>]</cite> is similar to ours using prototype-learning but employ selective knowledge distillation and ViT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> backbone. For zero-shot cross-category FG-SBIR: <span id="S4.SS1.p2.1.3" class="ltx_text ltx_font_bold">CDG</span> is a SOTA domain generalisation method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib79" title="" class="ltx_ref">79</a>]</cite> adapted to cross-category FG-SBIR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite> using categories as domain and intra-category sketch/photo pairs as label. <span id="S4.SS1.p2.1.4" class="ltx_text ltx_font_bold">CCD</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite> models a universal manifold of prototypical visual sketch traits that dynamically embeds sketch/photo, to generalise to unseen categories.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Generalisibility of Cross-Category FG-SBIR</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.3" class="ltx_p">Due to the significant impact of SBIR on training object detectors, it is imperative to learn a powerful cross-category FG-SBIR that is highly generalisable. In other words, the accuracy of SBIR puts a bottleneck on object detection performance. <a href="#S4.T1" title="In 4.2 Generalisibility of Cross-Category FG-SBIR ‣ 4 Experiments ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a> compares category-level SBIR (CL-SBIR) and cross-category FG-SBIR (CC-FGSBIR) on QuickDraw-Extended <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> and Sketchy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>]</cite> respectively, using <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="100\%" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">100</mn><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">100\%</annotation></semantics></math>, <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="70\%" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">70</mn><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">70\%</annotation></semantics></math>, and <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">50</mn><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">50\%</annotation></semantics></math> of the training set.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.5" class="ltx_p"><span id="S4.SS2.p2.5.1" class="ltx_text ltx_font_bold">Performance Analysis</span>  From <a href="#S4.T1" title="In 4.2 Generalisibility of Cross-Category FG-SBIR ‣ 4 Experiments ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a> we make the following observations: (i) with decreasing train-set categories, the performance gap (ratio of proposed / SOTA) between the proposed method versus GRL (for CL-SBIR) and CDG (for CC-FGSBIR) increases from <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="2.1/1.4" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">2.1</mn><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">/</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">1.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><divide id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></divide><cn type="float" id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">2.1</cn><cn type="float" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">1.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">2.1/1.4</annotation></semantics></math> at <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="100\%" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">100</mn><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">100\%</annotation></semantics></math> data to <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="3.0/4.2" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mn id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">3.0</mn><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">/</mo><mn id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">4.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><divide id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></divide><cn type="float" id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">3.0</cn><cn type="float" id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">4.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">3.0/4.2</annotation></semantics></math> at <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mn id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">50</mn><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">50\%</annotation></semantics></math> data. This shows the high generalisation potential when using prompt-based CLIP models for sketch/photo matching. (ii) Performance gap of proposed versus SOTAs for <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="100\%\rightarrow 50\%" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mrow id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mrow id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml"><mn id="S4.SS2.p2.5.m5.1.1.2.2" xref="S4.SS2.p2.5.m5.1.1.2.2.cmml">100</mn><mo id="S4.SS2.p2.5.m5.1.1.2.1" xref="S4.SS2.p2.5.m5.1.1.2.1.cmml">%</mo></mrow><mo stretchy="false" id="S4.SS2.p2.5.m5.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.cmml">→</mo><mrow id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml"><mn id="S4.SS2.p2.5.m5.1.1.3.2" xref="S4.SS2.p2.5.m5.1.1.3.2.cmml">50</mn><mo id="S4.SS2.p2.5.m5.1.1.3.1" xref="S4.SS2.p2.5.m5.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><ci id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1">→</ci><apply id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2"><csymbol cd="latexml" id="S4.SS2.p2.5.m5.1.1.2.1.cmml" xref="S4.SS2.p2.5.m5.1.1.2.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.5.m5.1.1.2.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2.2">100</cn></apply><apply id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3"><csymbol cd="latexml" id="S4.SS2.p2.5.m5.1.1.3.1.cmml" xref="S4.SS2.p2.5.m5.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.5.m5.1.1.3.2.cmml" xref="S4.SS2.p2.5.m5.1.1.3.2">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">100\%\rightarrow 50\%</annotation></semantics></math> is more significant in CC-FGSBIR as compared to CL-SBIR. Hence, it is more difficult to discriminate unseen intra-category sketch/photo pairs than recognise a novel categories. (iii) Performance of all competitors in CL-SBIR and CC-FGSBIR are staggeringly inferior to proposed CLIP-based approach. Such a strong SBIR is necessary to unlock training object detection in EWSOD setup (cross-dataset and weakly supervised).</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.7.1.1" class="ltx_text" style="font-size:113%;">Table 1</span>: </span><span id="S4.T1.8.2" class="ltx_text" style="font-size:113%;">Quantitative performance of zero-shot category-level SBIR (CL-SBIR) and cross-category FG-SBIR (CC-FGSBIR).</span></figcaption>
<table id="S4.T1.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.3.4" class="ltx_tr">
<td id="S4.T1.3.4.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:6.0pt;padding-right:6.0pt;" rowspan="2"><span id="S4.T1.3.4.1.1" class="ltx_text" style="font-size:80%;"><span id="S4.T1.3.4.1.1.1" class="ltx_text"></span> <span id="S4.T1.3.4.1.1.2" class="ltx_text">
<span id="S4.T1.3.4.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.3.4.1.1.2.1.1" class="ltx_tr">
<span id="S4.T1.3.4.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;">Train</span></span>
</span></span> <span id="S4.T1.3.4.1.1.3" class="ltx_text"></span></span></td>
<td id="S4.T1.3.4.2" class="ltx_td ltx_border_tt" style="padding-left:6.0pt;padding-right:6.0pt;"></td>
<td id="S4.T1.3.4.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:6.0pt;padding-right:6.0pt;" colspan="2">
<span id="S4.T1.3.4.3.1" class="ltx_text" style="font-size:80%;">CL-SBIR </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.3.4.3.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib20" title="" class="ltx_ref">20</a><span id="S4.T1.3.4.3.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S4.T1.3.4.4" class="ltx_td ltx_border_tt" style="padding-left:6.0pt;padding-right:6.0pt;"></td>
<td id="S4.T1.3.4.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:6.0pt;padding-right:6.0pt;" colspan="2">
<span id="S4.T1.3.4.5.1" class="ltx_text" style="font-size:80%;">CC-FGSBIR </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.3.4.5.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib77" title="" class="ltx_ref">77</a><span id="S4.T1.3.4.5.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
</tr>
<tr id="S4.T1.3.5" class="ltx_tr">
<td id="S4.T1.3.5.1" class="ltx_td" style="padding-left:6.0pt;padding-right:6.0pt;"></td>
<td id="S4.T1.3.5.2" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.5.2.1" class="ltx_text" style="font-size:80%;">mAP</span></td>
<td id="S4.T1.3.5.3" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.5.3.1" class="ltx_text" style="font-size:80%;">P@200</span></td>
<td id="S4.T1.3.5.4" class="ltx_td" style="padding-left:6.0pt;padding-right:6.0pt;"></td>
<td id="S4.T1.3.5.5" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.5.5.1" class="ltx_text" style="font-size:80%;">Acc.@1</span></td>
<td id="S4.T1.3.5.6" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.5.6.1" class="ltx_text" style="font-size:80%;">Acc.@5</span></td>
</tr>
<tr id="S4.T1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;" rowspan="3"><span id="S4.T1.1.1.1.1" class="ltx_text" style="font-size:80%;"><math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="100\%" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml"><mn id="S4.T1.1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.1.m1.1.1.2.cmml">100</mn><mo id="S4.T1.1.1.1.1.m1.1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.T1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">100\%</annotation></semantics></math></span></td>
<td id="S4.T1.1.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.1.1.2.1" class="ltx_text" style="font-size:80%;">GRL</span></td>
<td id="S4.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.1.1.3.1" class="ltx_text" style="font-size:80%;">9.01</span></td>
<td id="S4.T1.1.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.1.1.4.1" class="ltx_text" style="font-size:80%;">6.75</span></td>
<td id="S4.T1.1.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.1.1.5.1" class="ltx_text" style="font-size:80%;">CDG</span></td>
<td id="S4.T1.1.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.1.1.6.1" class="ltx_text" style="font-size:80%;">20.1</span></td>
<td id="S4.T1.1.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.1.1.7.1" class="ltx_text" style="font-size:80%;">46.4</span></td>
</tr>
<tr id="S4.T1.3.6" class="ltx_tr">
<td id="S4.T1.3.6.1" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.6.1.1" class="ltx_text" style="font-size:80%;">VKD</span></td>
<td id="S4.T1.3.6.2" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.6.2.1" class="ltx_text" style="font-size:80%;">15.0</span></td>
<td id="S4.T1.3.6.3" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.6.3.1" class="ltx_text" style="font-size:80%;">29.8</span></td>
<td id="S4.T1.3.6.4" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.6.4.1" class="ltx_text" style="font-size:80%;">CCD</span></td>
<td id="S4.T1.3.6.5" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.6.5.1" class="ltx_text" style="font-size:80%;">22.6</span></td>
<td id="S4.T1.3.6.6" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.6.6.1" class="ltx_text" style="font-size:80%;">49.0</span></td>
</tr>
<tr id="S4.T1.3.7" class="ltx_tr">
<td id="S4.T1.3.7.1" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.7.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">Ours</span></td>
<td id="S4.T1.3.7.2" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.7.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">18.2</span></td>
<td id="S4.T1.3.7.3" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.7.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">36.1</span></td>
<td id="S4.T1.3.7.4" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.7.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">Ours</span></td>
<td id="S4.T1.3.7.5" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.7.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">27.6</span></td>
<td id="S4.T1.3.7.6" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.7.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">59.5</span></td>
</tr>
<tr id="S4.T1.2.2" class="ltx_tr">
<td id="S4.T1.2.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;" rowspan="3"><span id="S4.T1.2.2.1.1" class="ltx_text" style="font-size:80%;"><math id="S4.T1.2.2.1.1.m1.1" class="ltx_Math" alttext="70\%" display="inline"><semantics id="S4.T1.2.2.1.1.m1.1a"><mrow id="S4.T1.2.2.1.1.m1.1.1" xref="S4.T1.2.2.1.1.m1.1.1.cmml"><mn id="S4.T1.2.2.1.1.m1.1.1.2" xref="S4.T1.2.2.1.1.m1.1.1.2.cmml">70</mn><mo id="S4.T1.2.2.1.1.m1.1.1.1" xref="S4.T1.2.2.1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.1.m1.1b"><apply id="S4.T1.2.2.1.1.m1.1.1.cmml" xref="S4.T1.2.2.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.2.2.1.1.m1.1.1.1.cmml" xref="S4.T1.2.2.1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.T1.2.2.1.1.m1.1.1.2.cmml" xref="S4.T1.2.2.1.1.m1.1.1.2">70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.1.m1.1c">70\%</annotation></semantics></math></span></td>
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.2.2.2.1" class="ltx_text" style="font-size:80%;">GRL</span></td>
<td id="S4.T1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.2.2.3.1" class="ltx_text" style="font-size:80%;">6.3</span></td>
<td id="S4.T1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.2.2.4.1" class="ltx_text" style="font-size:80%;">5.7</span></td>
<td id="S4.T1.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.2.2.5.1" class="ltx_text" style="font-size:80%;">CDG</span></td>
<td id="S4.T1.2.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.2.2.6.1" class="ltx_text" style="font-size:80%;">14.6</span></td>
<td id="S4.T1.2.2.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.2.2.7.1" class="ltx_text" style="font-size:80%;">39.5</span></td>
</tr>
<tr id="S4.T1.3.8" class="ltx_tr">
<td id="S4.T1.3.8.1" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.8.1.1" class="ltx_text" style="font-size:80%;">VKD</span></td>
<td id="S4.T1.3.8.2" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.8.2.1" class="ltx_text" style="font-size:80%;">9.4</span></td>
<td id="S4.T1.3.8.3" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.8.3.1" class="ltx_text" style="font-size:80%;">17.3</span></td>
<td id="S4.T1.3.8.4" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.8.4.1" class="ltx_text" style="font-size:80%;">CCD</span></td>
<td id="S4.T1.3.8.5" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.8.5.1" class="ltx_text" style="font-size:80%;">16.3</span></td>
<td id="S4.T1.3.8.6" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.8.6.1" class="ltx_text" style="font-size:80%;">41.4</span></td>
</tr>
<tr id="S4.T1.3.9" class="ltx_tr">
<td id="S4.T1.3.9.1" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.9.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">Ours</span></td>
<td id="S4.T1.3.9.2" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.9.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">13.1</span></td>
<td id="S4.T1.3.9.3" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.9.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">23.2</span></td>
<td id="S4.T1.3.9.4" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.9.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">Ours</span></td>
<td id="S4.T1.3.9.5" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.9.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">21.0</span></td>
<td id="S4.T1.3.9.6" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.9.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">47.7</span></td>
</tr>
<tr id="S4.T1.3.3" class="ltx_tr">
<td id="S4.T1.3.3.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;" rowspan="3"><span id="S4.T1.3.3.1.1" class="ltx_text" style="font-size:80%;"><math id="S4.T1.3.3.1.1.m1.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S4.T1.3.3.1.1.m1.1a"><mrow id="S4.T1.3.3.1.1.m1.1.1" xref="S4.T1.3.3.1.1.m1.1.1.cmml"><mn id="S4.T1.3.3.1.1.m1.1.1.2" xref="S4.T1.3.3.1.1.m1.1.1.2.cmml">50</mn><mo id="S4.T1.3.3.1.1.m1.1.1.1" xref="S4.T1.3.3.1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.1.m1.1b"><apply id="S4.T1.3.3.1.1.m1.1.1.cmml" xref="S4.T1.3.3.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.3.3.1.1.m1.1.1.1.cmml" xref="S4.T1.3.3.1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.T1.3.3.1.1.m1.1.1.2.cmml" xref="S4.T1.3.3.1.1.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.1.m1.1c">50\%</annotation></semantics></math></span></td>
<td id="S4.T1.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.3.2.1" class="ltx_text" style="font-size:80%;">GRL</span></td>
<td id="S4.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.3.3.1" class="ltx_text" style="font-size:80%;">3.2</span></td>
<td id="S4.T1.3.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.3.4.1" class="ltx_text" style="font-size:80%;">2.7</span></td>
<td id="S4.T1.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.3.5.1" class="ltx_text" style="font-size:80%;">CDG</span></td>
<td id="S4.T1.3.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.3.6.1" class="ltx_text" style="font-size:80%;">7.9</span></td>
<td id="S4.T1.3.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.3.7.1" class="ltx_text" style="font-size:80%;">25.4</span></td>
</tr>
<tr id="S4.T1.3.10" class="ltx_tr">
<td id="S4.T1.3.10.1" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.10.1.1" class="ltx_text" style="font-size:80%;">VKD</span></td>
<td id="S4.T1.3.10.2" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.10.2.1" class="ltx_text" style="font-size:80%;">4.8</span></td>
<td id="S4.T1.3.10.3" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.10.3.1" class="ltx_text" style="font-size:80%;">6.3</span></td>
<td id="S4.T1.3.10.4" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.10.4.1" class="ltx_text" style="font-size:80%;">CCD</span></td>
<td id="S4.T1.3.10.5" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.10.5.1" class="ltx_text" style="font-size:80%;">9.2</span></td>
<td id="S4.T1.3.10.6" class="ltx_td ltx_align_center" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.10.6.1" class="ltx_text" style="font-size:80%;">32.2</span></td>
</tr>
<tr id="S4.T1.3.11" class="ltx_tr">
<td id="S4.T1.3.11.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.11.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">Ours</span></td>
<td id="S4.T1.3.11.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.11.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">9.6</span></td>
<td id="S4.T1.3.11.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.11.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">11.4</span></td>
<td id="S4.T1.3.11.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.11.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">Ours</span></td>
<td id="S4.T1.3.11.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.11.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">14.7</span></td>
<td id="S4.T1.3.11.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:6.0pt;padding-right:6.0pt;"><span id="S4.T1.3.11.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">40.1</span></td>
</tr>
</table>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Category-Level Object Detection</h3>

<figure id="S4.F6" class="ltx_figure"><img src="/html/2303.15149/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="153" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S4.F6.3.2" class="ltx_text" style="font-size:90%;">Qualitative retrieval results for cross-category FG-SBIR.</span></figcaption>
</figure>
<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We benchmark on a subset of standard object detection PASCAL-VOC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and MS-COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> datasets that have overlapping categories with QuickDraw <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> sketches. Unlike traditional object detection that detects all instances for known classes in an image, category-level object detection specifies the category of interest by drawing a query sketch.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.7" class="ltx_p"><span id="S4.SS3.p2.7.1" class="ltx_text ltx_font_bold">Performance Analysis</span>  From <a href="#S4.T2" title="In 4.3 Category-Level Object Detection ‣ 4 Experiments ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a> we observe: (i) best SOD method outperform the best WSOD by an average <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.1.m1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.cmml">​</mo><msub id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml">P</mi><mn id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><times id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1"></times><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝐴</ci><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">𝑃</ci><cn type="float" id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">AP_{.5}</annotation></semantics></math> margin of <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="1.7\%/0.1\%" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mrow id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml"><mn id="S4.SS3.p2.2.m2.1.1.2.2" xref="S4.SS3.p2.2.m2.1.1.2.2.cmml">1.7</mn><mo id="S4.SS3.p2.2.m2.1.1.2.1" xref="S4.SS3.p2.2.m2.1.1.2.1.cmml">%</mo></mrow><mo id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml">/</mo><mrow id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml"><mn id="S4.SS3.p2.2.m2.1.1.3.2" xref="S4.SS3.p2.2.m2.1.1.3.2.cmml">0.1</mn><mo id="S4.SS3.p2.2.m2.1.1.3.1" xref="S4.SS3.p2.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><divide id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1"></divide><apply id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2"><csymbol cd="latexml" id="S4.SS3.p2.2.m2.1.1.2.1.cmml" xref="S4.SS3.p2.2.m2.1.1.2.1">percent</csymbol><cn type="float" id="S4.SS3.p2.2.m2.1.1.2.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2.2">1.7</cn></apply><apply id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3"><csymbol cd="latexml" id="S4.SS3.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.p2.2.m2.1.1.3.1">percent</csymbol><cn type="float" id="S4.SS3.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.p2.2.m2.1.1.3.2">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">1.7\%/0.1\%</annotation></semantics></math> in VOC/MS-COCO. This shows that although WSOD performs less than SOD (using additional bounding box annotation), the performance gap is not as significant as generally observed in prior works on seen setup using text as query <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib86" title="" class="ltx_ref">86</a>, <a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite>. In other words, using sketch gives nearly similar performance for zero-shot setup for SOD and WSOD. (ii) EWSOD methods further drops <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><mrow id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.3.m3.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.cmml">​</mo><msub id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml"><mi id="S4.SS3.p2.3.m3.1.1.3.2" xref="S4.SS3.p2.3.m3.1.1.3.2.cmml">P</mi><mn id="S4.SS3.p2.3.m3.1.1.3.3" xref="S4.SS3.p2.3.m3.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><times id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1.1"></times><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝐴</ci><apply id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.1.1.3.1.cmml" xref="S4.SS3.p2.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.3.m3.1.1.3.2.cmml" xref="S4.SS3.p2.3.m3.1.1.3.2">𝑃</ci><cn type="float" id="S4.SS3.p2.3.m3.1.1.3.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">AP_{.5}</annotation></semantics></math> of best WSOD method by <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="5.1\%/1.6\%" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><mrow id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mrow id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml"><mn id="S4.SS3.p2.4.m4.1.1.2.2" xref="S4.SS3.p2.4.m4.1.1.2.2.cmml">5.1</mn><mo id="S4.SS3.p2.4.m4.1.1.2.1" xref="S4.SS3.p2.4.m4.1.1.2.1.cmml">%</mo></mrow><mo id="S4.SS3.p2.4.m4.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.cmml">/</mo><mrow id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml"><mn id="S4.SS3.p2.4.m4.1.1.3.2" xref="S4.SS3.p2.4.m4.1.1.3.2.cmml">1.6</mn><mo id="S4.SS3.p2.4.m4.1.1.3.1" xref="S4.SS3.p2.4.m4.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><divide id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1"></divide><apply id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2"><csymbol cd="latexml" id="S4.SS3.p2.4.m4.1.1.2.1.cmml" xref="S4.SS3.p2.4.m4.1.1.2.1">percent</csymbol><cn type="float" id="S4.SS3.p2.4.m4.1.1.2.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2.2">5.1</cn></apply><apply id="S4.SS3.p2.4.m4.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3"><csymbol cd="latexml" id="S4.SS3.p2.4.m4.1.1.3.1.cmml" xref="S4.SS3.p2.4.m4.1.1.3.1">percent</csymbol><cn type="float" id="S4.SS3.p2.4.m4.1.1.3.2.cmml" xref="S4.SS3.p2.4.m4.1.1.3.2">1.6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">5.1\%/1.6\%</annotation></semantics></math>. This highlights the lack of generalisation of object detectors to the shift in data distribution when trained on SBIR photos and tested on VOC/MS-COCO. (iii) Despite being trained on the challenging EWSOD setup, our proposed method outperforms best SOD by <math id="S4.SS3.p2.5.m5.1" class="ltx_Math" alttext="14.7/10.9" display="inline"><semantics id="S4.SS3.p2.5.m5.1a"><mrow id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml"><mn id="S4.SS3.p2.5.m5.1.1.2" xref="S4.SS3.p2.5.m5.1.1.2.cmml">14.7</mn><mo id="S4.SS3.p2.5.m5.1.1.1" xref="S4.SS3.p2.5.m5.1.1.1.cmml">/</mo><mn id="S4.SS3.p2.5.m5.1.1.3" xref="S4.SS3.p2.5.m5.1.1.3.cmml">10.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><apply id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1"><divide id="S4.SS3.p2.5.m5.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1"></divide><cn type="float" id="S4.SS3.p2.5.m5.1.1.2.cmml" xref="S4.SS3.p2.5.m5.1.1.2">14.7</cn><cn type="float" id="S4.SS3.p2.5.m5.1.1.3.cmml" xref="S4.SS3.p2.5.m5.1.1.3">10.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">14.7/10.9</annotation></semantics></math>, WSOD by <math id="S4.SS3.p2.6.m6.1" class="ltx_Math" alttext="16.4/11.0" display="inline"><semantics id="S4.SS3.p2.6.m6.1a"><mrow id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml"><mn id="S4.SS3.p2.6.m6.1.1.2" xref="S4.SS3.p2.6.m6.1.1.2.cmml">16.4</mn><mo id="S4.SS3.p2.6.m6.1.1.1" xref="S4.SS3.p2.6.m6.1.1.1.cmml">/</mo><mn id="S4.SS3.p2.6.m6.1.1.3" xref="S4.SS3.p2.6.m6.1.1.3.cmml">11.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><apply id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1"><divide id="S4.SS3.p2.6.m6.1.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1.1"></divide><cn type="float" id="S4.SS3.p2.6.m6.1.1.2.cmml" xref="S4.SS3.p2.6.m6.1.1.2">16.4</cn><cn type="float" id="S4.SS3.p2.6.m6.1.1.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3">11.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">16.4/11.0</annotation></semantics></math>, and EWSOD by <math id="S4.SS3.p2.7.m7.1" class="ltx_Math" alttext="21.5/13.2" display="inline"><semantics id="S4.SS3.p2.7.m7.1a"><mrow id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml"><mn id="S4.SS3.p2.7.m7.1.1.2" xref="S4.SS3.p2.7.m7.1.1.2.cmml">21.5</mn><mo id="S4.SS3.p2.7.m7.1.1.1" xref="S4.SS3.p2.7.m7.1.1.1.cmml">/</mo><mn id="S4.SS3.p2.7.m7.1.1.3" xref="S4.SS3.p2.7.m7.1.1.3.cmml">13.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><apply id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1"><divide id="S4.SS3.p2.7.m7.1.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1.1"></divide><cn type="float" id="S4.SS3.p2.7.m7.1.1.2.cmml" xref="S4.SS3.p2.7.m7.1.1.2">21.5</cn><cn type="float" id="S4.SS3.p2.7.m7.1.1.3.cmml" xref="S4.SS3.p2.7.m7.1.1.3">13.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">21.5/13.2</annotation></semantics></math> in zero-shot setup. This shows the extreme generalisation potential of training object detetction using a strong CLIP-based SBIR.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.11.2.1" class="ltx_text" style="font-size:113%;">Table 2</span>: </span><span id="S4.T2.2.1" class="ltx_text" style="font-size:113%;">Quantitative performance of category-level object detection on VOC 2007 and MS-COCO using <math id="S4.T2.2.1.m1.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="S4.T2.2.1.m1.1b"><mrow id="S4.T2.2.1.m1.1.1" xref="S4.T2.2.1.m1.1.1.cmml"><mi id="S4.T2.2.1.m1.1.1.2" xref="S4.T2.2.1.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.T2.2.1.m1.1.1.1" xref="S4.T2.2.1.m1.1.1.1.cmml">​</mo><msub id="S4.T2.2.1.m1.1.1.3" xref="S4.T2.2.1.m1.1.1.3.cmml"><mi id="S4.T2.2.1.m1.1.1.3.2" xref="S4.T2.2.1.m1.1.1.3.2.cmml">P</mi><mn id="S4.T2.2.1.m1.1.1.3.3" xref="S4.T2.2.1.m1.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.1.m1.1c"><apply id="S4.T2.2.1.m1.1.1.cmml" xref="S4.T2.2.1.m1.1.1"><times id="S4.T2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.1.m1.1.1.1"></times><ci id="S4.T2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.1.m1.1.1.2">𝐴</ci><apply id="S4.T2.2.1.m1.1.1.3.cmml" xref="S4.T2.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T2.2.1.m1.1.1.3.1.cmml" xref="S4.T2.2.1.m1.1.1.3">subscript</csymbol><ci id="S4.T2.2.1.m1.1.1.3.2.cmml" xref="S4.T2.2.1.m1.1.1.3.2">𝑃</ci><cn type="float" id="S4.T2.2.1.m1.1.1.3.3.cmml" xref="S4.T2.2.1.m1.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.1.m1.1d">AP_{.5}</annotation></semantics></math> and <em id="S4.T2.2.1.1" class="ltx_emph ltx_font_italic">CorLoc</em>.</span></figcaption>
<table id="S4.T2.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T2.4.3" class="ltx_tr">
<td id="S4.T2.4.3.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;" colspan="2" rowspan="2"><span id="S4.T2.4.3.1.1" class="ltx_text" style="font-size:80%;">Method</span></td>
<td id="S4.T2.4.3.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;" colspan="2">
<span id="S4.T2.4.3.2.1" class="ltx_text" style="font-size:80%;">VOC 2007 </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.4.3.2.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib24" title="" class="ltx_ref">24</a><span id="S4.T2.4.3.2.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S4.T2.4.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;" colspan="2">
<span id="S4.T2.4.3.3.1" class="ltx_text" style="font-size:80%;">MS-COCO </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.4.3.3.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib54" title="" class="ltx_ref">54</a><span id="S4.T2.4.3.3.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
</tr>
<tr id="S4.T2.4.2" class="ltx_tr">
<td id="S4.T2.3.1.1" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><math id="S4.T2.3.1.1.m1.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="S4.T2.3.1.1.m1.1a"><mrow id="S4.T2.3.1.1.m1.1.1" xref="S4.T2.3.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S4.T2.3.1.1.m1.1.1.2" xref="S4.T2.3.1.1.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.T2.3.1.1.m1.1.1.1" xref="S4.T2.3.1.1.m1.1.1.1.cmml">​</mo><msub id="S4.T2.3.1.1.m1.1.1.3" xref="S4.T2.3.1.1.m1.1.1.3.cmml"><mi mathsize="80%" id="S4.T2.3.1.1.m1.1.1.3.2" xref="S4.T2.3.1.1.m1.1.1.3.2.cmml">P</mi><mn mathsize="80%" id="S4.T2.3.1.1.m1.1.1.3.3" xref="S4.T2.3.1.1.m1.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.1.1.m1.1b"><apply id="S4.T2.3.1.1.m1.1.1.cmml" xref="S4.T2.3.1.1.m1.1.1"><times id="S4.T2.3.1.1.m1.1.1.1.cmml" xref="S4.T2.3.1.1.m1.1.1.1"></times><ci id="S4.T2.3.1.1.m1.1.1.2.cmml" xref="S4.T2.3.1.1.m1.1.1.2">𝐴</ci><apply id="S4.T2.3.1.1.m1.1.1.3.cmml" xref="S4.T2.3.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T2.3.1.1.m1.1.1.3.1.cmml" xref="S4.T2.3.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.T2.3.1.1.m1.1.1.3.2.cmml" xref="S4.T2.3.1.1.m1.1.1.3.2">𝑃</ci><cn type="float" id="S4.T2.3.1.1.m1.1.1.3.3.cmml" xref="S4.T2.3.1.1.m1.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.1.1.m1.1c">AP_{.5}</annotation></semantics></math></td>
<td id="S4.T2.4.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.2.3.1" class="ltx_text" style="font-size:80%;">CorLoc</span></td>
<td id="S4.T2.4.2.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><math id="S4.T2.4.2.2.m1.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="S4.T2.4.2.2.m1.1a"><mrow id="S4.T2.4.2.2.m1.1.1" xref="S4.T2.4.2.2.m1.1.1.cmml"><mi mathsize="80%" id="S4.T2.4.2.2.m1.1.1.2" xref="S4.T2.4.2.2.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.T2.4.2.2.m1.1.1.1" xref="S4.T2.4.2.2.m1.1.1.1.cmml">​</mo><msub id="S4.T2.4.2.2.m1.1.1.3" xref="S4.T2.4.2.2.m1.1.1.3.cmml"><mi mathsize="80%" id="S4.T2.4.2.2.m1.1.1.3.2" xref="S4.T2.4.2.2.m1.1.1.3.2.cmml">P</mi><mn mathsize="80%" id="S4.T2.4.2.2.m1.1.1.3.3" xref="S4.T2.4.2.2.m1.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.2.2.m1.1b"><apply id="S4.T2.4.2.2.m1.1.1.cmml" xref="S4.T2.4.2.2.m1.1.1"><times id="S4.T2.4.2.2.m1.1.1.1.cmml" xref="S4.T2.4.2.2.m1.1.1.1"></times><ci id="S4.T2.4.2.2.m1.1.1.2.cmml" xref="S4.T2.4.2.2.m1.1.1.2">𝐴</ci><apply id="S4.T2.4.2.2.m1.1.1.3.cmml" xref="S4.T2.4.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T2.4.2.2.m1.1.1.3.1.cmml" xref="S4.T2.4.2.2.m1.1.1.3">subscript</csymbol><ci id="S4.T2.4.2.2.m1.1.1.3.2.cmml" xref="S4.T2.4.2.2.m1.1.1.3.2">𝑃</ci><cn type="float" id="S4.T2.4.2.2.m1.1.1.3.3.cmml" xref="S4.T2.4.2.2.m1.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.2.2.m1.1c">AP_{.5}</annotation></semantics></math></td>
<td id="S4.T2.4.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.2.4.1" class="ltx_text" style="font-size:80%;">CorLoc</span></td>
</tr>
<tr id="S4.T2.4.4" class="ltx_tr">
<td id="S4.T2.4.4.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;" rowspan="3"><span id="S4.T2.4.4.1.1" class="ltx_text" style="font-size:80%;">
<span id="S4.T2.4.4.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:5.5pt;height:16.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:16.8pt;transform:translate(-5.66pt,-5.66pt) rotate(-90deg) ;">
<span id="S4.T2.4.4.1.1.1.1" class="ltx_p"><span id="S4.T2.4.4.1.1.1.1.1" class="ltx_text ltx_font_bold">SOD</span></span>
</span></span></span></td>
<td id="S4.T2.4.4.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.4.2.1" class="ltx_text" style="font-size:80%;">Mod-FRCNN</span></td>
<td id="S4.T2.4.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.4.3.1" class="ltx_text" style="font-size:80%;">30.1</span></td>
<td id="S4.T2.4.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.4.4.1" class="ltx_text" style="font-size:80%;">51.2</span></td>
<td id="S4.T2.4.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.4.5.1" class="ltx_text" style="font-size:80%;">7.4</span></td>
<td id="S4.T2.4.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.4.6.1" class="ltx_text" style="font-size:80%;">65.8</span></td>
</tr>
<tr id="S4.T2.4.5" class="ltx_tr">
<td id="S4.T2.4.5.1" class="ltx_td ltx_align_left" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.5.1.1" class="ltx_text" style="font-size:80%;">MatchNet</span></td>
<td id="S4.T2.4.5.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.5.2.1" class="ltx_text" style="font-size:80%;">31.4</span></td>
<td id="S4.T2.4.5.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.5.3.1" class="ltx_text" style="font-size:80%;">51.7</span></td>
<td id="S4.T2.4.5.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.5.4.1" class="ltx_text" style="font-size:80%;">12.4</span></td>
<td id="S4.T2.4.5.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.5.5.1" class="ltx_text" style="font-size:80%;">68.1</span></td>
</tr>
<tr id="S4.T2.4.6" class="ltx_tr">
<td id="S4.T2.4.6.1" class="ltx_td ltx_align_left" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.6.1.1" class="ltx_text" style="font-size:80%;">CoAttOD</span></td>
<td id="S4.T2.4.6.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.6.2.1" class="ltx_text" style="font-size:80%;">34.6</span></td>
<td id="S4.T2.4.6.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.6.3.1" class="ltx_text" style="font-size:80%;">53.9</span></td>
<td id="S4.T2.4.6.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.6.4.1" class="ltx_text" style="font-size:80%;">15.0</span></td>
<td id="S4.T2.4.6.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.6.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">71.3</span></td>
</tr>
<tr id="S4.T2.4.7" class="ltx_tr">
<td id="S4.T2.4.7.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;" rowspan="4"><span id="S4.T2.4.7.1.1" class="ltx_text" style="font-size:80%;">
<span id="S4.T2.4.7.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:5.5pt;height:25pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:25.0pt;transform:translate(-9.77pt,-9.77pt) rotate(-90deg) ;">
<span id="S4.T2.4.7.1.1.1.1" class="ltx_p"><span id="S4.T2.4.7.1.1.1.1.1" class="ltx_text ltx_font_bold">WSOD</span></span>
</span></span></span></td>
<td id="S4.T2.4.7.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.7.2.1" class="ltx_text" style="font-size:80%;">WSDDN</span></td>
<td id="S4.T2.4.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.7.3.1" class="ltx_text" style="font-size:80%;">20.9</span></td>
<td id="S4.T2.4.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.7.4.1" class="ltx_text" style="font-size:80%;">40.1</span></td>
<td id="S4.T2.4.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.7.5.1" class="ltx_text" style="font-size:80%;">11.9</span></td>
<td id="S4.T2.4.7.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.7.6.1" class="ltx_text" style="font-size:80%;">67.3</span></td>
</tr>
<tr id="S4.T2.4.8" class="ltx_tr">
<td id="S4.T2.4.8.1" class="ltx_td ltx_align_left" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.8.1.1" class="ltx_text" style="font-size:80%;">OICR</span></td>
<td id="S4.T2.4.8.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.8.2.1" class="ltx_text" style="font-size:80%;">24.7</span></td>
<td id="S4.T2.4.8.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.8.3.1" class="ltx_text" style="font-size:80%;">42.3</span></td>
<td id="S4.T2.4.8.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.8.4.1" class="ltx_text" style="font-size:80%;">12.2</span></td>
<td id="S4.T2.4.8.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.8.5.1" class="ltx_text" style="font-size:80%;">67.7</span></td>
</tr>
<tr id="S4.T2.4.9" class="ltx_tr">
<td id="S4.T2.4.9.1" class="ltx_td ltx_align_left" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.9.1.1" class="ltx_text" style="font-size:80%;">PCL</span></td>
<td id="S4.T2.4.9.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.9.2.1" class="ltx_text" style="font-size:80%;">26.1</span></td>
<td id="S4.T2.4.9.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.9.3.1" class="ltx_text" style="font-size:80%;">45.5</span></td>
<td id="S4.T2.4.9.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.9.4.1" class="ltx_text" style="font-size:80%;">13.8</span></td>
<td id="S4.T2.4.9.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.9.5.1" class="ltx_text" style="font-size:80%;">68.6</span></td>
</tr>
<tr id="S4.T2.4.10" class="ltx_tr">
<td id="S4.T2.4.10.1" class="ltx_td ltx_align_left" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.10.1.1" class="ltx_text" style="font-size:80%;">ICMWSD</span></td>
<td id="S4.T2.4.10.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.10.2.1" class="ltx_text" style="font-size:80%;">32.9</span></td>
<td id="S4.T2.4.10.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.10.3.1" class="ltx_text" style="font-size:80%;">52.6</span></td>
<td id="S4.T2.4.10.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.10.4.1" class="ltx_text" style="font-size:80%;">14.9</span></td>
<td id="S4.T2.4.10.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.10.5.1" class="ltx_text" style="font-size:80%;">69.5</span></td>
</tr>
<tr id="S4.T2.4.11" class="ltx_tr">
<td id="S4.T2.4.11.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;" rowspan="4"><span id="S4.T2.4.11.1.1" class="ltx_text" style="font-size:80%;">
<span id="S4.T2.4.11.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:5.5pt;height:30.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:30.4pt;transform:translate(-12.49pt,-12.49pt) rotate(-90deg) ;">
<span id="S4.T2.4.11.1.1.1.1" class="ltx_p"><span id="S4.T2.4.11.1.1.1.1.1" class="ltx_text ltx_font_bold">EWSOD</span></span>
</span></span></span></td>
<td id="S4.T2.4.11.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.11.2.1" class="ltx_text" style="font-size:80%;">E-WSDDN</span></td>
<td id="S4.T2.4.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.11.3.1" class="ltx_text" style="font-size:80%;">17.7</span></td>
<td id="S4.T2.4.11.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.11.4.1" class="ltx_text" style="font-size:80%;">37.9</span></td>
<td id="S4.T2.4.11.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.11.5.1" class="ltx_text" style="font-size:80%;">10.1</span></td>
<td id="S4.T2.4.11.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.11.6.1" class="ltx_text" style="font-size:80%;">66.7</span></td>
</tr>
<tr id="S4.T2.4.12" class="ltx_tr">
<td id="S4.T2.4.12.1" class="ltx_td ltx_align_left" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.12.1.1" class="ltx_text" style="font-size:80%;">E-OICR</span></td>
<td id="S4.T2.4.12.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.12.2.1" class="ltx_text" style="font-size:80%;">21.2</span></td>
<td id="S4.T2.4.12.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.12.3.1" class="ltx_text" style="font-size:80%;">40.5</span></td>
<td id="S4.T2.4.12.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.12.4.1" class="ltx_text" style="font-size:80%;">10.4</span></td>
<td id="S4.T2.4.12.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.12.5.1" class="ltx_text" style="font-size:80%;">67.0</span></td>
</tr>
<tr id="S4.T2.4.13" class="ltx_tr">
<td id="S4.T2.4.13.1" class="ltx_td ltx_align_left" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.13.1.1" class="ltx_text" style="font-size:80%;">E-PCL</span></td>
<td id="S4.T2.4.13.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.13.2.1" class="ltx_text" style="font-size:80%;">22.3</span></td>
<td id="S4.T2.4.13.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.13.3.1" class="ltx_text" style="font-size:80%;">41.1</span></td>
<td id="S4.T2.4.13.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.13.4.1" class="ltx_text" style="font-size:80%;">11.8</span></td>
<td id="S4.T2.4.13.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.13.5.1" class="ltx_text" style="font-size:80%;">67.3</span></td>
</tr>
<tr id="S4.T2.4.14" class="ltx_tr">
<td id="S4.T2.4.14.1" class="ltx_td ltx_align_left" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.14.1.1" class="ltx_text" style="font-size:80%;">E-ICMWSD</span></td>
<td id="S4.T2.4.14.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.14.2.1" class="ltx_text" style="font-size:80%;">27.8</span></td>
<td id="S4.T2.4.14.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.14.3.1" class="ltx_text" style="font-size:80%;">46.3</span></td>
<td id="S4.T2.4.14.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.14.4.1" class="ltx_text" style="font-size:80%;">12.7</span></td>
<td id="S4.T2.4.14.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.14.5.1" class="ltx_text" style="font-size:80%;">67.9</span></td>
</tr>
<tr id="S4.T2.4.15" class="ltx_tr">
<td id="S4.T2.4.15.1" class="ltx_td ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"></td>
<td id="S4.T2.4.15.2" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.15.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">Proposed</span></td>
<td id="S4.T2.4.15.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.15.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">49.3</span></td>
<td id="S4.T2.4.15.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.15.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">69.4</span></td>
<td id="S4.T2.4.15.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.15.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">25.9</span></td>
<td id="S4.T2.4.15.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.4.15.6.1" class="ltx_text" style="font-size:80%;background-color:#E6E6E6;">70.3</span></td>
</tr>
</table>
</figure>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2303.15149/assets/x7.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="191" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.2.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S4.F7.3.2" class="ltx_text" style="font-size:90%;">Category-Level Object Detection using query sketches with images from MS-COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> and PASCAL-VOC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.</span></figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Fine-Grained Object Detection</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">Unlike category-level object detection that detects all instances of sketched category, the goal of fine-grained object detection is to detect only a specific instance for the input query sketch with instance-level alignment.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.1" class="ltx_p"><span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_bold">Performance Analysis</span>  From <a href="#S4.T3" title="In 4.4 Fine-Grained Object Detection ‣ 4 Experiments ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a> we observe: (i) Methods in SOD have nearly similar performance as WSOD and drops for EWSOD, similar to that in category-level detection in <a href="#S4.T2" title="In 4.3 Category-Level Object Detection ‣ 4 Experiments ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. (ii) Compared to SOD, the performance of WSOD drops more for <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="AP_{.5}\rightarrow AP_{.7}" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mrow id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mrow id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2.2" xref="S4.SS4.p2.1.m1.1.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.1.m1.1.1.2.1" xref="S4.SS4.p2.1.m1.1.1.2.1.cmml">​</mo><msub id="S4.SS4.p2.1.m1.1.1.2.3" xref="S4.SS4.p2.1.m1.1.1.2.3.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2.3.2" xref="S4.SS4.p2.1.m1.1.1.2.3.2.cmml">P</mi><mn id="S4.SS4.p2.1.m1.1.1.2.3.3" xref="S4.SS4.p2.1.m1.1.1.2.3.3.cmml">.5</mn></msub></mrow><mo stretchy="false" id="S4.SS4.p2.1.m1.1.1.1" xref="S4.SS4.p2.1.m1.1.1.1.cmml">→</mo><mrow id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml"><mi id="S4.SS4.p2.1.m1.1.1.3.2" xref="S4.SS4.p2.1.m1.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.1.m1.1.1.3.1" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><msub id="S4.SS4.p2.1.m1.1.1.3.3" xref="S4.SS4.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS4.p2.1.m1.1.1.3.3.2" xref="S4.SS4.p2.1.m1.1.1.3.3.2.cmml">P</mi><mn id="S4.SS4.p2.1.m1.1.1.3.3.3" xref="S4.SS4.p2.1.m1.1.1.3.3.3.cmml">.7</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><ci id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1.1">→</ci><apply id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2"><times id="S4.SS4.p2.1.m1.1.1.2.1.cmml" xref="S4.SS4.p2.1.m1.1.1.2.1"></times><ci id="S4.SS4.p2.1.m1.1.1.2.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2.2">𝐴</ci><apply id="S4.SS4.p2.1.m1.1.1.2.3.cmml" xref="S4.SS4.p2.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.1.1.2.3.1.cmml" xref="S4.SS4.p2.1.m1.1.1.2.3">subscript</csymbol><ci id="S4.SS4.p2.1.m1.1.1.2.3.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2.3.2">𝑃</ci><cn type="float" id="S4.SS4.p2.1.m1.1.1.2.3.3.cmml" xref="S4.SS4.p2.1.m1.1.1.2.3.3">.5</cn></apply></apply><apply id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3"><times id="S4.SS4.p2.1.m1.1.1.3.1.cmml" xref="S4.SS4.p2.1.m1.1.1.3.1"></times><ci id="S4.SS4.p2.1.m1.1.1.3.2.cmml" xref="S4.SS4.p2.1.m1.1.1.3.2">𝐴</ci><apply id="S4.SS4.p2.1.m1.1.1.3.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS4.p2.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS4.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS4.p2.1.m1.1.1.3.3.2">𝑃</ci><cn type="float" id="S4.SS4.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3.3.3">.7</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">AP_{.5}\rightarrow AP_{.7}</annotation></semantics></math>. This is since WSOD methods use less accurate selective search <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib89" title="" class="ltx_ref">89</a>]</cite> and edge boxes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib113" title="" class="ltx_ref">113</a>]</cite> for region proposals compared to the more accurate RPN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite> in SOD. (iii) Our proposed method outperforms SOD, WSOD, and EWSOD in zero-shot setup, thereby proving its fine-grained generalisation.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.7.1.1" class="ltx_text" style="font-size:113%;">Table 3</span>: </span><span id="S4.T3.8.2" class="ltx_text" style="font-size:113%;">SketchyCOCO detection fine-grained.</span></figcaption>
<table id="S4.T3.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T3.3.3" class="ltx_tr">
<td id="S4.T3.3.3.4" class="ltx_td ltx_border_tt" style="padding-left:12.0pt;padding-right:12.0pt;"></td>
<td id="S4.T3.3.3.5" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.3.5.1" class="ltx_text" style="font-size:80%;">Method</span></td>
<td id="S4.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:12.0pt;padding-right:12.0pt;"><math id="S4.T3.1.1.1.m1.1" class="ltx_Math" alttext="AP_{.3}" display="inline"><semantics id="S4.T3.1.1.1.m1.1a"><mrow id="S4.T3.1.1.1.m1.1.1" xref="S4.T3.1.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S4.T3.1.1.1.m1.1.1.2" xref="S4.T3.1.1.1.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.T3.1.1.1.m1.1.1.1" xref="S4.T3.1.1.1.m1.1.1.1.cmml">​</mo><msub id="S4.T3.1.1.1.m1.1.1.3" xref="S4.T3.1.1.1.m1.1.1.3.cmml"><mi mathsize="80%" id="S4.T3.1.1.1.m1.1.1.3.2" xref="S4.T3.1.1.1.m1.1.1.3.2.cmml">P</mi><mn mathsize="80%" id="S4.T3.1.1.1.m1.1.1.3.3" xref="S4.T3.1.1.1.m1.1.1.3.3.cmml">.3</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><apply id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1"><times id="S4.T3.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1.1"></times><ci id="S4.T3.1.1.1.m1.1.1.2.cmml" xref="S4.T3.1.1.1.m1.1.1.2">𝐴</ci><apply id="S4.T3.1.1.1.m1.1.1.3.cmml" xref="S4.T3.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T3.1.1.1.m1.1.1.3.1.cmml" xref="S4.T3.1.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.T3.1.1.1.m1.1.1.3.2.cmml" xref="S4.T3.1.1.1.m1.1.1.3.2">𝑃</ci><cn type="float" id="S4.T3.1.1.1.m1.1.1.3.3.cmml" xref="S4.T3.1.1.1.m1.1.1.3.3">.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">AP_{.3}</annotation></semantics></math></td>
<td id="S4.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:12.0pt;padding-right:12.0pt;"><math id="S4.T3.2.2.2.m1.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="S4.T3.2.2.2.m1.1a"><mrow id="S4.T3.2.2.2.m1.1.1" xref="S4.T3.2.2.2.m1.1.1.cmml"><mi mathsize="80%" id="S4.T3.2.2.2.m1.1.1.2" xref="S4.T3.2.2.2.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.T3.2.2.2.m1.1.1.1" xref="S4.T3.2.2.2.m1.1.1.1.cmml">​</mo><msub id="S4.T3.2.2.2.m1.1.1.3" xref="S4.T3.2.2.2.m1.1.1.3.cmml"><mi mathsize="80%" id="S4.T3.2.2.2.m1.1.1.3.2" xref="S4.T3.2.2.2.m1.1.1.3.2.cmml">P</mi><mn mathsize="80%" id="S4.T3.2.2.2.m1.1.1.3.3" xref="S4.T3.2.2.2.m1.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.m1.1b"><apply id="S4.T3.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.m1.1.1"><times id="S4.T3.2.2.2.m1.1.1.1.cmml" xref="S4.T3.2.2.2.m1.1.1.1"></times><ci id="S4.T3.2.2.2.m1.1.1.2.cmml" xref="S4.T3.2.2.2.m1.1.1.2">𝐴</ci><apply id="S4.T3.2.2.2.m1.1.1.3.cmml" xref="S4.T3.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T3.2.2.2.m1.1.1.3.1.cmml" xref="S4.T3.2.2.2.m1.1.1.3">subscript</csymbol><ci id="S4.T3.2.2.2.m1.1.1.3.2.cmml" xref="S4.T3.2.2.2.m1.1.1.3.2">𝑃</ci><cn type="float" id="S4.T3.2.2.2.m1.1.1.3.3.cmml" xref="S4.T3.2.2.2.m1.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.m1.1c">AP_{.5}</annotation></semantics></math></td>
<td id="S4.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:12.0pt;padding-right:12.0pt;"><math id="S4.T3.3.3.3.m1.1" class="ltx_Math" alttext="AP_{.7}" display="inline"><semantics id="S4.T3.3.3.3.m1.1a"><mrow id="S4.T3.3.3.3.m1.1.1" xref="S4.T3.3.3.3.m1.1.1.cmml"><mi mathsize="80%" id="S4.T3.3.3.3.m1.1.1.2" xref="S4.T3.3.3.3.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.T3.3.3.3.m1.1.1.1" xref="S4.T3.3.3.3.m1.1.1.1.cmml">​</mo><msub id="S4.T3.3.3.3.m1.1.1.3" xref="S4.T3.3.3.3.m1.1.1.3.cmml"><mi mathsize="80%" id="S4.T3.3.3.3.m1.1.1.3.2" xref="S4.T3.3.3.3.m1.1.1.3.2.cmml">P</mi><mn mathsize="80%" id="S4.T3.3.3.3.m1.1.1.3.3" xref="S4.T3.3.3.3.m1.1.1.3.3.cmml">.7</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.m1.1b"><apply id="S4.T3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.m1.1.1"><times id="S4.T3.3.3.3.m1.1.1.1.cmml" xref="S4.T3.3.3.3.m1.1.1.1"></times><ci id="S4.T3.3.3.3.m1.1.1.2.cmml" xref="S4.T3.3.3.3.m1.1.1.2">𝐴</ci><apply id="S4.T3.3.3.3.m1.1.1.3.cmml" xref="S4.T3.3.3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T3.3.3.3.m1.1.1.3.1.cmml" xref="S4.T3.3.3.3.m1.1.1.3">subscript</csymbol><ci id="S4.T3.3.3.3.m1.1.1.3.2.cmml" xref="S4.T3.3.3.3.m1.1.1.3.2">𝑃</ci><cn type="float" id="S4.T3.3.3.3.m1.1.1.3.3.cmml" xref="S4.T3.3.3.3.m1.1.1.3.3">.7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.m1.1c">AP_{.7}</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.3.4" class="ltx_tr">
<td id="S4.T3.3.4.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;" rowspan="3"><span id="S4.T3.3.4.1.1" class="ltx_text" style="font-size:80%;">
<span id="S4.T3.3.4.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:5.5pt;height:16.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:16.8pt;transform:translate(-5.66pt,-5.66pt) rotate(-90deg) ;">
<span id="S4.T3.3.4.1.1.1.1" class="ltx_p"><span id="S4.T3.3.4.1.1.1.1.1" class="ltx_text ltx_font_bold">SOD</span></span>
</span></span></span></td>
<td id="S4.T3.3.4.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.4.2.1" class="ltx_text" style="font-size:80%;">Mod-FRCNN</span></td>
<td id="S4.T3.3.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.4.3.1" class="ltx_text" style="font-size:80%;">2.5</span></td>
<td id="S4.T3.3.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.4.4.1" class="ltx_text" style="font-size:80%;">3.5</span></td>
<td id="S4.T3.3.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.4.5.1" class="ltx_text" style="font-size:80%;">3.1</span></td>
</tr>
<tr id="S4.T3.3.5" class="ltx_tr">
<td id="S4.T3.3.5.1" class="ltx_td ltx_align_left" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.5.1.1" class="ltx_text" style="font-size:80%;">MatchNet</span></td>
<td id="S4.T3.3.5.2" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.5.2.1" class="ltx_text" style="font-size:80%;">9.3</span></td>
<td id="S4.T3.3.5.3" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.5.3.1" class="ltx_text" style="font-size:80%;">11.0</span></td>
<td id="S4.T3.3.5.4" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.5.4.1" class="ltx_text" style="font-size:80%;">10.5</span></td>
</tr>
<tr id="S4.T3.3.6" class="ltx_tr">
<td id="S4.T3.3.6.1" class="ltx_td ltx_align_left" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.6.1.1" class="ltx_text" style="font-size:80%;">CoAttOD</span></td>
<td id="S4.T3.3.6.2" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.6.2.1" class="ltx_text" style="font-size:80%;">10.4</span></td>
<td id="S4.T3.3.6.3" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.6.3.1" class="ltx_text" style="font-size:80%;">12.1</span></td>
<td id="S4.T3.3.6.4" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.6.4.1" class="ltx_text" style="font-size:80%;">11.7</span></td>
</tr>
<tr id="S4.T3.3.7" class="ltx_tr">
<td id="S4.T3.3.7.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;" rowspan="4"><span id="S4.T3.3.7.1.1" class="ltx_text" style="font-size:80%;">
<span id="S4.T3.3.7.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:5.5pt;height:25pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:25.0pt;transform:translate(-9.77pt,-9.77pt) rotate(-90deg) ;">
<span id="S4.T3.3.7.1.1.1.1" class="ltx_p"><span id="S4.T3.3.7.1.1.1.1.1" class="ltx_text ltx_font_bold">WSOD</span></span>
</span></span></span></td>
<td id="S4.T3.3.7.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.7.2.1" class="ltx_text" style="font-size:80%;">WSDDN</span></td>
<td id="S4.T3.3.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.7.3.1" class="ltx_text" style="font-size:80%;">8.1</span></td>
<td id="S4.T3.3.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.7.4.1" class="ltx_text" style="font-size:80%;">10.2</span></td>
<td id="S4.T3.3.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.7.5.1" class="ltx_text" style="font-size:80%;">9.4</span></td>
</tr>
<tr id="S4.T3.3.8" class="ltx_tr">
<td id="S4.T3.3.8.1" class="ltx_td ltx_align_left" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.8.1.1" class="ltx_text" style="font-size:80%;">OICR</span></td>
<td id="S4.T3.3.8.2" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.8.2.1" class="ltx_text" style="font-size:80%;">8.9</span></td>
<td id="S4.T3.3.8.3" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.8.3.1" class="ltx_text" style="font-size:80%;">10.9</span></td>
<td id="S4.T3.3.8.4" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.8.4.1" class="ltx_text" style="font-size:80%;">10.0</span></td>
</tr>
<tr id="S4.T3.3.9" class="ltx_tr">
<td id="S4.T3.3.9.1" class="ltx_td ltx_align_left" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.9.1.1" class="ltx_text" style="font-size:80%;">PCL</span></td>
<td id="S4.T3.3.9.2" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.9.2.1" class="ltx_text" style="font-size:80%;">9.2</span></td>
<td id="S4.T3.3.9.3" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.9.3.1" class="ltx_text" style="font-size:80%;">11.5</span></td>
<td id="S4.T3.3.9.4" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.9.4.1" class="ltx_text" style="font-size:80%;">10.6</span></td>
</tr>
<tr id="S4.T3.3.10" class="ltx_tr">
<td id="S4.T3.3.10.1" class="ltx_td ltx_align_left" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.10.1.1" class="ltx_text" style="font-size:80%;">ICMWSD</span></td>
<td id="S4.T3.3.10.2" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.10.2.1" class="ltx_text" style="font-size:80%;">10.3</span></td>
<td id="S4.T3.3.10.3" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.10.3.1" class="ltx_text" style="font-size:80%;">11.9</span></td>
<td id="S4.T3.3.10.4" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.10.4.1" class="ltx_text" style="font-size:80%;">10.8</span></td>
</tr>
<tr id="S4.T3.3.11" class="ltx_tr">
<td id="S4.T3.3.11.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;" rowspan="4"><span id="S4.T3.3.11.1.1" class="ltx_text" style="font-size:80%;">
<span id="S4.T3.3.11.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:5.5pt;height:30.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:30.4pt;transform:translate(-12.49pt,-12.49pt) rotate(-90deg) ;">
<span id="S4.T3.3.11.1.1.1.1" class="ltx_p"><span id="S4.T3.3.11.1.1.1.1.1" class="ltx_text ltx_font_bold">EWSOD</span></span>
</span></span></span></td>
<td id="S4.T3.3.11.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.11.2.1" class="ltx_text" style="font-size:80%;">E-WSDDN</span></td>
<td id="S4.T3.3.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.11.3.1" class="ltx_text" style="font-size:80%;">6.4</span></td>
<td id="S4.T3.3.11.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.11.4.1" class="ltx_text" style="font-size:80%;">8.5</span></td>
<td id="S4.T3.3.11.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.11.5.1" class="ltx_text" style="font-size:80%;">7.6</span></td>
</tr>
<tr id="S4.T3.3.12" class="ltx_tr">
<td id="S4.T3.3.12.1" class="ltx_td ltx_align_left" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.12.1.1" class="ltx_text" style="font-size:80%;">E-OICR</span></td>
<td id="S4.T3.3.12.2" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.12.2.1" class="ltx_text" style="font-size:80%;">7.1</span></td>
<td id="S4.T3.3.12.3" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.12.3.1" class="ltx_text" style="font-size:80%;">9.1</span></td>
<td id="S4.T3.3.12.4" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.12.4.1" class="ltx_text" style="font-size:80%;">8.3</span></td>
</tr>
<tr id="S4.T3.3.13" class="ltx_tr">
<td id="S4.T3.3.13.1" class="ltx_td ltx_align_left" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.13.1.1" class="ltx_text" style="font-size:80%;">E-PCL</span></td>
<td id="S4.T3.3.13.2" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.13.2.1" class="ltx_text" style="font-size:80%;">7.3</span></td>
<td id="S4.T3.3.13.3" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.13.3.1" class="ltx_text" style="font-size:80%;">9.4</span></td>
<td id="S4.T3.3.13.4" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.13.4.1" class="ltx_text" style="font-size:80%;">8.7</span></td>
</tr>
<tr id="S4.T3.3.14" class="ltx_tr">
<td id="S4.T3.3.14.1" class="ltx_td ltx_align_left" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.14.1.1" class="ltx_text" style="font-size:80%;">E-ICMWSD</span></td>
<td id="S4.T3.3.14.2" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.14.2.1" class="ltx_text" style="font-size:80%;">8.5</span></td>
<td id="S4.T3.3.14.3" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.14.3.1" class="ltx_text" style="font-size:80%;">10.2</span></td>
<td id="S4.T3.3.14.4" class="ltx_td ltx_align_center" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.14.4.1" class="ltx_text" style="font-size:80%;">9.4</span></td>
</tr>
<tr id="S4.T3.3.15" class="ltx_tr">
<td id="S4.T3.3.15.1" class="ltx_td ltx_border_bb" style="padding-left:12.0pt;padding-right:12.0pt;"></td>
<td id="S4.T3.3.15.2" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.15.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">Proposed</span></td>
<td id="S4.T3.3.15.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.15.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">15.0</span></td>
<td id="S4.T3.3.15.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.15.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">17.1</span></td>
<td id="S4.T3.3.15.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:12.0pt;padding-right:12.0pt;"><span id="S4.T3.3.15.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#E6E6E6;">16.3</span></td>
</tr>
</table>
</figure>
<figure id="S4.F8" class="ltx_figure"><img src="/html/2303.15149/assets/x8.png" id="S4.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="194" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F8.2.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S4.F8.3.2" class="ltx_text" style="font-size:90%;">Cross-Category Fine-Grained Object Detection using query sketches with images from SketchyCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.</span></figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Part-Level Object Detection</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">Encouraged with the generalised fine-grained discriminative power of the proposed method in <a href="#S4.T3" title="In 4.4 Fine-Grained Object Detection ‣ 4 Experiments ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, we go a step further and ask: can we only detect a <em id="S4.SS5.p1.1.1" class="ltx_emph ltx_font_italic">part</em> (e.g., only ‘head’) of an instance? Due to lack of annotation, a quantitative evaluation of part-level object detection is infeasible. Nonetheless, we conduct a qualitative study by manually editing sketches to create partial sketches of a single part (e.g., only “head” of “horse”). <a href="#S4.F9" title="In 4.5 Part-Level Object Detection ‣ 4 Experiments ‣ What Can Human Sketches Do for Object Detection?" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">9</span></a> presents some results (for more see supplementary). We observe that (i) our proposed method can uniquely detect the sketched ‘head’ region of different objects. (ii) Detection performance is lower for ambiguous part sketches like ‘leg’ (e.g., front-leg, back-leg etc.) (iii) Since detection depends on region proposals from RPN, our model fails to detect tiny sketched parts. Tiny object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> is a known challenge for traditional object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>.</p>
</div>
<figure id="S4.F9" class="ltx_figure"><img src="/html/2303.15149/assets/x9.png" id="S4.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F9.2.1.1" class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span id="S4.F9.3.2" class="ltx_text" style="font-size:90%;">Unlike traditional object detection that detects an entire object (e.g., a “horse”), sketches can express fine-grained RoI to detect a specified part of an object (e.g., the “head” of a “horse”).</span></figcaption>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Ablation</h3>

<div id="S4.SS6.p1" class="ltx_para ltx_noindent">
<p id="S4.SS6.p1.4" class="ltx_p"><span id="S4.SS6.p1.4.1" class="ltx_text ltx_font_bold">Selective Search v/s Edge Boxes v/s RPN</span>  Unlike the proposed method using pre-trained <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> RPN to generate <math id="S4.SS6.p1.1.m1.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S4.SS6.p1.1.m1.1a"><mn id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><cn type="integer" id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">1000</annotation></semantics></math> box proposals, WSOD methods mostly use selective search <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib89" title="" class="ltx_ref">89</a>]</cite> (SS) or edge boxes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib113" title="" class="ltx_ref">113</a>]</cite> (EB) that do not need pre-training using box annotation from visual genome <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>. Hence, for a fair comparison, we replace RPN with SS/EB drops <math id="S4.SS6.p1.2.m2.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="S4.SS6.p1.2.m2.1a"><mrow id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml"><mi id="S4.SS6.p1.2.m2.1.1.2" xref="S4.SS6.p1.2.m2.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p1.2.m2.1.1.1" xref="S4.SS6.p1.2.m2.1.1.1.cmml">​</mo><msub id="S4.SS6.p1.2.m2.1.1.3" xref="S4.SS6.p1.2.m2.1.1.3.cmml"><mi id="S4.SS6.p1.2.m2.1.1.3.2" xref="S4.SS6.p1.2.m2.1.1.3.2.cmml">P</mi><mn id="S4.SS6.p1.2.m2.1.1.3.3" xref="S4.SS6.p1.2.m2.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><apply id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1"><times id="S4.SS6.p1.2.m2.1.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1.1"></times><ci id="S4.SS6.p1.2.m2.1.1.2.cmml" xref="S4.SS6.p1.2.m2.1.1.2">𝐴</ci><apply id="S4.SS6.p1.2.m2.1.1.3.cmml" xref="S4.SS6.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS6.p1.2.m2.1.1.3.1.cmml" xref="S4.SS6.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS6.p1.2.m2.1.1.3.2.cmml" xref="S4.SS6.p1.2.m2.1.1.3.2">𝑃</ci><cn type="float" id="S4.SS6.p1.2.m2.1.1.3.3.cmml" xref="S4.SS6.p1.2.m2.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">AP_{.5}</annotation></semantics></math> performance by <math id="S4.SS6.p1.3.m3.1" class="ltx_Math" alttext="1.3" display="inline"><semantics id="S4.SS6.p1.3.m3.1a"><mn id="S4.SS6.p1.3.m3.1.1" xref="S4.SS6.p1.3.m3.1.1.cmml">1.3</mn><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.3.m3.1b"><cn type="float" id="S4.SS6.p1.3.m3.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1">1.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.3.m3.1c">1.3</annotation></semantics></math>/<math id="S4.SS6.p1.4.m4.1" class="ltx_Math" alttext="2.6" display="inline"><semantics id="S4.SS6.p1.4.m4.1a"><mn id="S4.SS6.p1.4.m4.1.1" xref="S4.SS6.p1.4.m4.1.1.cmml">2.6</mn><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.4.m4.1b"><cn type="float" id="S4.SS6.p1.4.m4.1.1.cmml" xref="S4.SS6.p1.4.m4.1.1">2.6</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.4.m4.1c">2.6</annotation></semantics></math> on SketchyCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.</p>
</div>
<div id="S4.SS6.p2" class="ltx_para ltx_noindent">
<p id="S4.SS6.p2.7" class="ltx_p"><span id="S4.SS6.p2.7.1" class="ltx_text ltx_font_bold">Influence of Classifier Refinement</span>  We observe <math id="S4.SS6.p2.1.m1.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="S4.SS6.p2.1.m1.1a"><mrow id="S4.SS6.p2.1.m1.1.1" xref="S4.SS6.p2.1.m1.1.1.cmml"><mi id="S4.SS6.p2.1.m1.1.1.2" xref="S4.SS6.p2.1.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS6.p2.1.m1.1.1.1" xref="S4.SS6.p2.1.m1.1.1.1.cmml">​</mo><msub id="S4.SS6.p2.1.m1.1.1.3" xref="S4.SS6.p2.1.m1.1.1.3.cmml"><mi id="S4.SS6.p2.1.m1.1.1.3.2" xref="S4.SS6.p2.1.m1.1.1.3.2.cmml">P</mi><mn id="S4.SS6.p2.1.m1.1.1.3.3" xref="S4.SS6.p2.1.m1.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.1.m1.1b"><apply id="S4.SS6.p2.1.m1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1"><times id="S4.SS6.p2.1.m1.1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1.1"></times><ci id="S4.SS6.p2.1.m1.1.1.2.cmml" xref="S4.SS6.p2.1.m1.1.1.2">𝐴</ci><apply id="S4.SS6.p2.1.m1.1.1.3.cmml" xref="S4.SS6.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS6.p2.1.m1.1.1.3.1.cmml" xref="S4.SS6.p2.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS6.p2.1.m1.1.1.3.2.cmml" xref="S4.SS6.p2.1.m1.1.1.3.2">𝑃</ci><cn type="float" id="S4.SS6.p2.1.m1.1.1.3.3.cmml" xref="S4.SS6.p2.1.m1.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.1.m1.1c">AP_{.5}</annotation></semantics></math> improve by <math id="S4.SS6.p2.2.m2.1" class="ltx_Math" alttext="2.4" display="inline"><semantics id="S4.SS6.p2.2.m2.1a"><mn id="S4.SS6.p2.2.m2.1.1" xref="S4.SS6.p2.2.m2.1.1.cmml">2.4</mn><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.2.m2.1b"><cn type="float" id="S4.SS6.p2.2.m2.1.1.cmml" xref="S4.SS6.p2.2.m2.1.1">2.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.2.m2.1c">2.4</annotation></semantics></math> and <math id="S4.SS6.p2.3.m3.1" class="ltx_Math" alttext="1.1" display="inline"><semantics id="S4.SS6.p2.3.m3.1a"><mn id="S4.SS6.p2.3.m3.1.1" xref="S4.SS6.p2.3.m3.1.1.cmml">1.1</mn><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.3.m3.1b"><cn type="float" id="S4.SS6.p2.3.m3.1.1.cmml" xref="S4.SS6.p2.3.m3.1.1">1.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.3.m3.1c">1.1</annotation></semantics></math> for <math id="S4.SS6.p2.4.m4.1" class="ltx_Math" alttext="K=1\rightarrow 2" display="inline"><semantics id="S4.SS6.p2.4.m4.1a"><mrow id="S4.SS6.p2.4.m4.1.1" xref="S4.SS6.p2.4.m4.1.1.cmml"><mi id="S4.SS6.p2.4.m4.1.1.2" xref="S4.SS6.p2.4.m4.1.1.2.cmml">K</mi><mo id="S4.SS6.p2.4.m4.1.1.3" xref="S4.SS6.p2.4.m4.1.1.3.cmml">=</mo><mn id="S4.SS6.p2.4.m4.1.1.4" xref="S4.SS6.p2.4.m4.1.1.4.cmml">1</mn><mo stretchy="false" id="S4.SS6.p2.4.m4.1.1.5" xref="S4.SS6.p2.4.m4.1.1.5.cmml">→</mo><mn id="S4.SS6.p2.4.m4.1.1.6" xref="S4.SS6.p2.4.m4.1.1.6.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.4.m4.1b"><apply id="S4.SS6.p2.4.m4.1.1.cmml" xref="S4.SS6.p2.4.m4.1.1"><and id="S4.SS6.p2.4.m4.1.1a.cmml" xref="S4.SS6.p2.4.m4.1.1"></and><apply id="S4.SS6.p2.4.m4.1.1b.cmml" xref="S4.SS6.p2.4.m4.1.1"><eq id="S4.SS6.p2.4.m4.1.1.3.cmml" xref="S4.SS6.p2.4.m4.1.1.3"></eq><ci id="S4.SS6.p2.4.m4.1.1.2.cmml" xref="S4.SS6.p2.4.m4.1.1.2">𝐾</ci><cn type="integer" id="S4.SS6.p2.4.m4.1.1.4.cmml" xref="S4.SS6.p2.4.m4.1.1.4">1</cn></apply><apply id="S4.SS6.p2.4.m4.1.1c.cmml" xref="S4.SS6.p2.4.m4.1.1"><ci id="S4.SS6.p2.4.m4.1.1.5.cmml" xref="S4.SS6.p2.4.m4.1.1.5">→</ci><share href="#S4.SS6.p2.4.m4.1.1.4.cmml" id="S4.SS6.p2.4.m4.1.1d.cmml" xref="S4.SS6.p2.4.m4.1.1"></share><cn type="integer" id="S4.SS6.p2.4.m4.1.1.6.cmml" xref="S4.SS6.p2.4.m4.1.1.6">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.4.m4.1c">K=1\rightarrow 2</annotation></semantics></math> and <math id="S4.SS6.p2.5.m5.1" class="ltx_Math" alttext="K=2\rightarrow 3" display="inline"><semantics id="S4.SS6.p2.5.m5.1a"><mrow id="S4.SS6.p2.5.m5.1.1" xref="S4.SS6.p2.5.m5.1.1.cmml"><mi id="S4.SS6.p2.5.m5.1.1.2" xref="S4.SS6.p2.5.m5.1.1.2.cmml">K</mi><mo id="S4.SS6.p2.5.m5.1.1.3" xref="S4.SS6.p2.5.m5.1.1.3.cmml">=</mo><mn id="S4.SS6.p2.5.m5.1.1.4" xref="S4.SS6.p2.5.m5.1.1.4.cmml">2</mn><mo stretchy="false" id="S4.SS6.p2.5.m5.1.1.5" xref="S4.SS6.p2.5.m5.1.1.5.cmml">→</mo><mn id="S4.SS6.p2.5.m5.1.1.6" xref="S4.SS6.p2.5.m5.1.1.6.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.5.m5.1b"><apply id="S4.SS6.p2.5.m5.1.1.cmml" xref="S4.SS6.p2.5.m5.1.1"><and id="S4.SS6.p2.5.m5.1.1a.cmml" xref="S4.SS6.p2.5.m5.1.1"></and><apply id="S4.SS6.p2.5.m5.1.1b.cmml" xref="S4.SS6.p2.5.m5.1.1"><eq id="S4.SS6.p2.5.m5.1.1.3.cmml" xref="S4.SS6.p2.5.m5.1.1.3"></eq><ci id="S4.SS6.p2.5.m5.1.1.2.cmml" xref="S4.SS6.p2.5.m5.1.1.2">𝐾</ci><cn type="integer" id="S4.SS6.p2.5.m5.1.1.4.cmml" xref="S4.SS6.p2.5.m5.1.1.4">2</cn></apply><apply id="S4.SS6.p2.5.m5.1.1c.cmml" xref="S4.SS6.p2.5.m5.1.1"><ci id="S4.SS6.p2.5.m5.1.1.5.cmml" xref="S4.SS6.p2.5.m5.1.1.5">→</ci><share href="#S4.SS6.p2.5.m5.1.1.4.cmml" id="S4.SS6.p2.5.m5.1.1d.cmml" xref="S4.SS6.p2.5.m5.1.1"></share><cn type="integer" id="S4.SS6.p2.5.m5.1.1.6.cmml" xref="S4.SS6.p2.5.m5.1.1.6">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.5.m5.1c">K=2\rightarrow 3</annotation></semantics></math> respectively but a small drop of <math id="S4.SS6.p2.6.m6.1" class="ltx_Math" alttext="0.2" display="inline"><semantics id="S4.SS6.p2.6.m6.1a"><mn id="S4.SS6.p2.6.m6.1.1" xref="S4.SS6.p2.6.m6.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.6.m6.1b"><cn type="float" id="S4.SS6.p2.6.m6.1.1.cmml" xref="S4.SS6.p2.6.m6.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.6.m6.1c">0.2</annotation></semantics></math> for <math id="S4.SS6.p2.7.m7.1" class="ltx_Math" alttext="K=3\rightarrow 4" display="inline"><semantics id="S4.SS6.p2.7.m7.1a"><mrow id="S4.SS6.p2.7.m7.1.1" xref="S4.SS6.p2.7.m7.1.1.cmml"><mi id="S4.SS6.p2.7.m7.1.1.2" xref="S4.SS6.p2.7.m7.1.1.2.cmml">K</mi><mo id="S4.SS6.p2.7.m7.1.1.3" xref="S4.SS6.p2.7.m7.1.1.3.cmml">=</mo><mn id="S4.SS6.p2.7.m7.1.1.4" xref="S4.SS6.p2.7.m7.1.1.4.cmml">3</mn><mo stretchy="false" id="S4.SS6.p2.7.m7.1.1.5" xref="S4.SS6.p2.7.m7.1.1.5.cmml">→</mo><mn id="S4.SS6.p2.7.m7.1.1.6" xref="S4.SS6.p2.7.m7.1.1.6.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.7.m7.1b"><apply id="S4.SS6.p2.7.m7.1.1.cmml" xref="S4.SS6.p2.7.m7.1.1"><and id="S4.SS6.p2.7.m7.1.1a.cmml" xref="S4.SS6.p2.7.m7.1.1"></and><apply id="S4.SS6.p2.7.m7.1.1b.cmml" xref="S4.SS6.p2.7.m7.1.1"><eq id="S4.SS6.p2.7.m7.1.1.3.cmml" xref="S4.SS6.p2.7.m7.1.1.3"></eq><ci id="S4.SS6.p2.7.m7.1.1.2.cmml" xref="S4.SS6.p2.7.m7.1.1.2">𝐾</ci><cn type="integer" id="S4.SS6.p2.7.m7.1.1.4.cmml" xref="S4.SS6.p2.7.m7.1.1.4">3</cn></apply><apply id="S4.SS6.p2.7.m7.1.1c.cmml" xref="S4.SS6.p2.7.m7.1.1"><ci id="S4.SS6.p2.7.m7.1.1.5.cmml" xref="S4.SS6.p2.7.m7.1.1.5">→</ci><share href="#S4.SS6.p2.7.m7.1.1.4.cmml" id="S4.SS6.p2.7.m7.1.1d.cmml" xref="S4.SS6.p2.7.m7.1.1"></share><cn type="integer" id="S4.SS6.p2.7.m7.1.1.6.cmml" xref="S4.SS6.p2.7.m7.1.1.6">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.7.m7.1c">K=3\rightarrow 4</annotation></semantics></math>.</p>
</div>
<div id="S4.SS6.p3" class="ltx_para ltx_noindent">
<p id="S4.SS6.p3.2" class="ltx_p"><span id="S4.SS6.p3.2.1" class="ltx_text ltx_font_bold">Influence of Supervision from Photo Encoder in SBIR</span>  Although we can train an object detector using only pre-trained sketch encoder (trained on SBIR) via prototype learning, removing supervision from the photo encoder in SBIR drops <math id="S4.SS6.p3.1.m1.1" class="ltx_Math" alttext="4.5" display="inline"><semantics id="S4.SS6.p3.1.m1.1a"><mn id="S4.SS6.p3.1.m1.1.1" xref="S4.SS6.p3.1.m1.1.1.cmml">4.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS6.p3.1.m1.1b"><cn type="float" id="S4.SS6.p3.1.m1.1.1.cmml" xref="S4.SS6.p3.1.m1.1.1">4.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p3.1.m1.1c">4.5</annotation></semantics></math> in <math id="S4.SS6.p3.2.m2.1" class="ltx_Math" alttext="A_{.5}" display="inline"><semantics id="S4.SS6.p3.2.m2.1a"><msub id="S4.SS6.p3.2.m2.1.1" xref="S4.SS6.p3.2.m2.1.1.cmml"><mi id="S4.SS6.p3.2.m2.1.1.2" xref="S4.SS6.p3.2.m2.1.1.2.cmml">A</mi><mn id="S4.SS6.p3.2.m2.1.1.3" xref="S4.SS6.p3.2.m2.1.1.3.cmml">.5</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p3.2.m2.1b"><apply id="S4.SS6.p3.2.m2.1.1.cmml" xref="S4.SS6.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p3.2.m2.1.1.1.cmml" xref="S4.SS6.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS6.p3.2.m2.1.1.2.cmml" xref="S4.SS6.p3.2.m2.1.1.2">𝐴</ci><cn type="float" id="S4.SS6.p3.2.m2.1.1.3.cmml" xref="S4.SS6.p3.2.m2.1.1.3">.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p3.2.m2.1c">A_{.5}</annotation></semantics></math> on SketchyCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Limitation and Future Works</h3>

<div id="S4.SS7.p1" class="ltx_para">
<p id="S4.SS7.p1.1" class="ltx_p">Introducing fine-grained object detection using sketch opens several possibilities that we do not consider. Given multiple query sketches, currently we tread them as independent query embeddings. However, a user might be interested in detecting complex scenes (a “dog” on the right of a “person”) with <em id="S4.SS7.p1.1.1" class="ltx_emph ltx_font_italic">multiple</em> objects that have meaningful <em id="S4.SS7.p1.1.2" class="ltx_emph ltx_font_italic">spatial</em> alignment. Future works can extend fine-grained object detection to semantic segmentation using complex sketches from the recently introduced FS-COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> dataset.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We cultivate the expressiveness that human sketch bring for object detection. The proposed sketch-enabled object detection framework detects what <em id="S5.p1.1.1" class="ltx_emph ltx_font_italic">you</em> intend to express in <em id="S5.p1.1.2" class="ltx_emph ltx_font_italic">your</em> sketch – an object detector that is both instance-aware and part-aware. Accordingly, we design a novel prompt learning setup to marry CLIP and SBIR, to train a sketch-aware detector, that works without needing bounding box annotation, or class labels. To make our detector general-purpose, we further dictate it to work in a zero-shot manner. While SBIR is trained using object-level (single object) sketch/photo pairs, object works on image-level (multiple categories). We bridge this object and image-level gap using a data augmentation trick that improves robustness towards corruption and generalisation to out-of-vocab. The resulting framework outperforms both supervised, and weakly supervised object detectors on zero-shot setup.</p>
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Human Study on Part-level Object Detection</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.8" class="ltx_p">Due to the lack of annotation, a quantitative evaluation of part-level object detection is infeasible. Nonetheless, we measure the real-world usability of our sketch-enabled object detection framework using Mean Opinion Score (MOS) by asking <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A1.p1.1.m1.1a"><mn id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><cn type="integer" id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">10</annotation></semantics></math> people to draw <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A1.p1.2.m2.1a"><mn id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><cn type="integer" id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">20</annotation></semantics></math> part-level sketches and rate from <math id="A1.p1.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.p1.3.m3.1a"><mn id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><cn type="integer" id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">1</annotation></semantics></math> to <math id="A1.p1.4.m4.1" class="ltx_Math" alttext="5" display="inline"><semantics id="A1.p1.4.m4.1a"><mn id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><cn type="integer" id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">5</annotation></semantics></math> (bad <math id="A1.p1.5.m5.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A1.p1.5.m5.1a"><mo stretchy="false" id="A1.p1.5.m5.1.1" xref="A1.p1.5.m5.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.1b"><ci id="A1.p1.5.m5.1.1.cmml" xref="A1.p1.5.m5.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m5.1c">\rightarrow</annotation></semantics></math> excellent) based on their opinion of how closely the queried object part was detected. Accordingly, we obtain a MOS (mean <math id="A1.p1.6.m6.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A1.p1.6.m6.1a"><mo id="A1.p1.6.m6.1.1" xref="A1.p1.6.m6.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.p1.6.m6.1b"><csymbol cd="latexml" id="A1.p1.6.m6.1.1.cmml" xref="A1.p1.6.m6.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m6.1c">\pm</annotation></semantics></math> variance of <math id="A1.p1.7.m7.1" class="ltx_Math" alttext="200" display="inline"><semantics id="A1.p1.7.m7.1a"><mn id="A1.p1.7.m7.1.1" xref="A1.p1.7.m7.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="A1.p1.7.m7.1b"><cn type="integer" id="A1.p1.7.m7.1.1.cmml" xref="A1.p1.7.m7.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.7.m7.1c">200</annotation></semantics></math> responses) of <math id="A1.p1.8.m8.1" class="ltx_Math" alttext="3.67\pm 0.6" display="inline"><semantics id="A1.p1.8.m8.1a"><mrow id="A1.p1.8.m8.1.1" xref="A1.p1.8.m8.1.1.cmml"><mn id="A1.p1.8.m8.1.1.2" xref="A1.p1.8.m8.1.1.2.cmml">3.67</mn><mo id="A1.p1.8.m8.1.1.1" xref="A1.p1.8.m8.1.1.1.cmml">±</mo><mn id="A1.p1.8.m8.1.1.3" xref="A1.p1.8.m8.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.8.m8.1b"><apply id="A1.p1.8.m8.1.1.cmml" xref="A1.p1.8.m8.1.1"><csymbol cd="latexml" id="A1.p1.8.m8.1.1.1.cmml" xref="A1.p1.8.m8.1.1.1">plus-or-minus</csymbol><cn type="float" id="A1.p1.8.m8.1.1.2.cmml" xref="A1.p1.8.m8.1.1.2">3.67</cn><cn type="float" id="A1.p1.8.m8.1.1.3.cmml" xref="A1.p1.8.m8.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.8.m8.1c">3.67\pm 0.6</annotation></semantics></math>.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Preliminary Study on Occluded Objects</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">In addition to category-level, fine-grained, and part-level object detection, we further qualitatively test the generalisability of the system to detect occluded objects as:</p>
</div>
<figure id="A2.1" class="ltx_figure"><img src="/html/2303.15149/assets/x10.png" id="A2.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="81" alt="[Uncaptioned image]">
</figure>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">While we show some successful, failed, and partially detected cases, future works can further investigate the role of sketch and foundation models like CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> for occluded object detection.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Relation to Open World setup</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">In open world setup, a model trained on <math id="A3.p1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">C</annotation></semantics></math> known classes can recognise the unknown class and update the base model via incremental learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>. Our method already works in open world setup as it detects in zero-shot, open-vocab setup, i.e., it works regardless of whether the query sketch is in the train set or not.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Detection across Different Poses</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">Our object detection has multiple setups: (i) for category-level OD, the sketch of object O1 (“zebra”) in image I1 will detect the same object O1 in a different image I2 <em id="A4.p1.1.1" class="ltx_emph ltx_font_italic">even with a different pose</em> (“sitting” or “standing”). (ii) For fine-grained OD, the sketch of object O1 in image I1 will only detect the same object O1 in a different image I2 if it has the <em id="A4.p1.1.2" class="ltx_emph ltx_font_italic">same pose</em>, e.g., detect only “zebras <span id="A4.p1.1.3" class="ltx_text ltx_font_italic">sitting down</span>” amongst a herd of “zebras”. Figure below shows qualitative results for clarity.
<img src="/html/2303.15149/assets/x11.png" id="A4.p1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="92" alt="[Uncaptioned image]"></p>
</div>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Additional Ablation Study</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.14" class="ltx_p">(i) <span id="A5.p1.14.1" class="ltx_text ltx_font_italic">Varying prompt length</span> <math id="A5.p1.1.m1.3" class="ltx_Math" alttext="P=\{1,3,5\}" display="inline"><semantics id="A5.p1.1.m1.3a"><mrow id="A5.p1.1.m1.3.4" xref="A5.p1.1.m1.3.4.cmml"><mi id="A5.p1.1.m1.3.4.2" xref="A5.p1.1.m1.3.4.2.cmml">P</mi><mo id="A5.p1.1.m1.3.4.1" xref="A5.p1.1.m1.3.4.1.cmml">=</mo><mrow id="A5.p1.1.m1.3.4.3.2" xref="A5.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="A5.p1.1.m1.3.4.3.2.1" xref="A5.p1.1.m1.3.4.3.1.cmml">{</mo><mn id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml">1</mn><mo id="A5.p1.1.m1.3.4.3.2.2" xref="A5.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A5.p1.1.m1.2.2" xref="A5.p1.1.m1.2.2.cmml">3</mn><mo id="A5.p1.1.m1.3.4.3.2.3" xref="A5.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A5.p1.1.m1.3.3" xref="A5.p1.1.m1.3.3.cmml">5</mn><mo stretchy="false" id="A5.p1.1.m1.3.4.3.2.4" xref="A5.p1.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.3b"><apply id="A5.p1.1.m1.3.4.cmml" xref="A5.p1.1.m1.3.4"><eq id="A5.p1.1.m1.3.4.1.cmml" xref="A5.p1.1.m1.3.4.1"></eq><ci id="A5.p1.1.m1.3.4.2.cmml" xref="A5.p1.1.m1.3.4.2">𝑃</ci><set id="A5.p1.1.m1.3.4.3.1.cmml" xref="A5.p1.1.m1.3.4.3.2"><cn type="integer" id="A5.p1.1.m1.1.1.cmml" xref="A5.p1.1.m1.1.1">1</cn><cn type="integer" id="A5.p1.1.m1.2.2.cmml" xref="A5.p1.1.m1.2.2">3</cn><cn type="integer" id="A5.p1.1.m1.3.3.cmml" xref="A5.p1.1.m1.3.3">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.3c">P=\{1,3,5\}</annotation></semantics></math> in <math id="A5.p1.2.m2.2" class="ltx_Math" alttext="\{\mathbf{v}_{\mathbf{s}},\mathbf{v}_{\mathbf{p}}\}\in\mathbb{R}^{P\times 768}" display="inline"><semantics id="A5.p1.2.m2.2a"><mrow id="A5.p1.2.m2.2.2" xref="A5.p1.2.m2.2.2.cmml"><mrow id="A5.p1.2.m2.2.2.2.2" xref="A5.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="A5.p1.2.m2.2.2.2.2.3" xref="A5.p1.2.m2.2.2.2.3.cmml">{</mo><msub id="A5.p1.2.m2.1.1.1.1.1" xref="A5.p1.2.m2.1.1.1.1.1.cmml"><mi id="A5.p1.2.m2.1.1.1.1.1.2" xref="A5.p1.2.m2.1.1.1.1.1.2.cmml">𝐯</mi><mi id="A5.p1.2.m2.1.1.1.1.1.3" xref="A5.p1.2.m2.1.1.1.1.1.3.cmml">𝐬</mi></msub><mo id="A5.p1.2.m2.2.2.2.2.4" xref="A5.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="A5.p1.2.m2.2.2.2.2.2" xref="A5.p1.2.m2.2.2.2.2.2.cmml"><mi id="A5.p1.2.m2.2.2.2.2.2.2" xref="A5.p1.2.m2.2.2.2.2.2.2.cmml">𝐯</mi><mi id="A5.p1.2.m2.2.2.2.2.2.3" xref="A5.p1.2.m2.2.2.2.2.2.3.cmml">𝐩</mi></msub><mo stretchy="false" id="A5.p1.2.m2.2.2.2.2.5" xref="A5.p1.2.m2.2.2.2.3.cmml">}</mo></mrow><mo id="A5.p1.2.m2.2.2.3" xref="A5.p1.2.m2.2.2.3.cmml">∈</mo><msup id="A5.p1.2.m2.2.2.4" xref="A5.p1.2.m2.2.2.4.cmml"><mi id="A5.p1.2.m2.2.2.4.2" xref="A5.p1.2.m2.2.2.4.2.cmml">ℝ</mi><mrow id="A5.p1.2.m2.2.2.4.3" xref="A5.p1.2.m2.2.2.4.3.cmml"><mi id="A5.p1.2.m2.2.2.4.3.2" xref="A5.p1.2.m2.2.2.4.3.2.cmml">P</mi><mo lspace="0.222em" rspace="0.222em" id="A5.p1.2.m2.2.2.4.3.1" xref="A5.p1.2.m2.2.2.4.3.1.cmml">×</mo><mn id="A5.p1.2.m2.2.2.4.3.3" xref="A5.p1.2.m2.2.2.4.3.3.cmml">768</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.2.m2.2b"><apply id="A5.p1.2.m2.2.2.cmml" xref="A5.p1.2.m2.2.2"><in id="A5.p1.2.m2.2.2.3.cmml" xref="A5.p1.2.m2.2.2.3"></in><set id="A5.p1.2.m2.2.2.2.3.cmml" xref="A5.p1.2.m2.2.2.2.2"><apply id="A5.p1.2.m2.1.1.1.1.1.cmml" xref="A5.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.p1.2.m2.1.1.1.1.1.1.cmml" xref="A5.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="A5.p1.2.m2.1.1.1.1.1.2.cmml" xref="A5.p1.2.m2.1.1.1.1.1.2">𝐯</ci><ci id="A5.p1.2.m2.1.1.1.1.1.3.cmml" xref="A5.p1.2.m2.1.1.1.1.1.3">𝐬</ci></apply><apply id="A5.p1.2.m2.2.2.2.2.2.cmml" xref="A5.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="A5.p1.2.m2.2.2.2.2.2.1.cmml" xref="A5.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="A5.p1.2.m2.2.2.2.2.2.2.cmml" xref="A5.p1.2.m2.2.2.2.2.2.2">𝐯</ci><ci id="A5.p1.2.m2.2.2.2.2.2.3.cmml" xref="A5.p1.2.m2.2.2.2.2.2.3">𝐩</ci></apply></set><apply id="A5.p1.2.m2.2.2.4.cmml" xref="A5.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="A5.p1.2.m2.2.2.4.1.cmml" xref="A5.p1.2.m2.2.2.4">superscript</csymbol><ci id="A5.p1.2.m2.2.2.4.2.cmml" xref="A5.p1.2.m2.2.2.4.2">ℝ</ci><apply id="A5.p1.2.m2.2.2.4.3.cmml" xref="A5.p1.2.m2.2.2.4.3"><times id="A5.p1.2.m2.2.2.4.3.1.cmml" xref="A5.p1.2.m2.2.2.4.3.1"></times><ci id="A5.p1.2.m2.2.2.4.3.2.cmml" xref="A5.p1.2.m2.2.2.4.3.2">𝑃</ci><cn type="integer" id="A5.p1.2.m2.2.2.4.3.3.cmml" xref="A5.p1.2.m2.2.2.4.3.3">768</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.2.m2.2c">\{\mathbf{v}_{\mathbf{s}},\mathbf{v}_{\mathbf{p}}\}\in\mathbb{R}^{P\times 768}</annotation></semantics></math> changes <math id="A5.p1.3.m3.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="A5.p1.3.m3.1a"><mrow id="A5.p1.3.m3.1.1" xref="A5.p1.3.m3.1.1.cmml"><mi id="A5.p1.3.m3.1.1.2" xref="A5.p1.3.m3.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A5.p1.3.m3.1.1.1" xref="A5.p1.3.m3.1.1.1.cmml">​</mo><msub id="A5.p1.3.m3.1.1.3" xref="A5.p1.3.m3.1.1.3.cmml"><mi id="A5.p1.3.m3.1.1.3.2" xref="A5.p1.3.m3.1.1.3.2.cmml">P</mi><mn id="A5.p1.3.m3.1.1.3.3" xref="A5.p1.3.m3.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.3.m3.1b"><apply id="A5.p1.3.m3.1.1.cmml" xref="A5.p1.3.m3.1.1"><times id="A5.p1.3.m3.1.1.1.cmml" xref="A5.p1.3.m3.1.1.1"></times><ci id="A5.p1.3.m3.1.1.2.cmml" xref="A5.p1.3.m3.1.1.2">𝐴</ci><apply id="A5.p1.3.m3.1.1.3.cmml" xref="A5.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A5.p1.3.m3.1.1.3.1.cmml" xref="A5.p1.3.m3.1.1.3">subscript</csymbol><ci id="A5.p1.3.m3.1.1.3.2.cmml" xref="A5.p1.3.m3.1.1.3.2">𝑃</ci><cn type="float" id="A5.p1.3.m3.1.1.3.3.cmml" xref="A5.p1.3.m3.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.3.m3.1c">AP_{.5}</annotation></semantics></math> to <math id="A5.p1.4.m4.1" class="ltx_Math" alttext="16.5" display="inline"><semantics id="A5.p1.4.m4.1a"><mn id="A5.p1.4.m4.1.1" xref="A5.p1.4.m4.1.1.cmml">16.5</mn><annotation-xml encoding="MathML-Content" id="A5.p1.4.m4.1b"><cn type="float" id="A5.p1.4.m4.1.1.cmml" xref="A5.p1.4.m4.1.1">16.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.4.m4.1c">16.5</annotation></semantics></math>, <math id="A5.p1.5.m5.1" class="ltx_Math" alttext="17.1" display="inline"><semantics id="A5.p1.5.m5.1a"><mn id="A5.p1.5.m5.1.1" xref="A5.p1.5.m5.1.1.cmml">17.1</mn><annotation-xml encoding="MathML-Content" id="A5.p1.5.m5.1b"><cn type="float" id="A5.p1.5.m5.1.1.cmml" xref="A5.p1.5.m5.1.1">17.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.5.m5.1c">17.1</annotation></semantics></math>, and <math id="A5.p1.6.m6.1" class="ltx_Math" alttext="15.9" display="inline"><semantics id="A5.p1.6.m6.1a"><mn id="A5.p1.6.m6.1.1" xref="A5.p1.6.m6.1.1.cmml">15.9</mn><annotation-xml encoding="MathML-Content" id="A5.p1.6.m6.1b"><cn type="float" id="A5.p1.6.m6.1.1.cmml" xref="A5.p1.6.m6.1.1">15.9</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.6.m6.1c">15.9</annotation></semantics></math> on SketchyCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> respectively. (ii) <span id="A5.p1.14.2" class="ltx_text ltx_font_italic">Replacing CLIP</span> with VGG-based sketch encoder <math id="A5.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{F}_{\mathbf{s}}" display="inline"><semantics id="A5.p1.7.m7.1a"><msub id="A5.p1.7.m7.1.1" xref="A5.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.p1.7.m7.1.1.2" xref="A5.p1.7.m7.1.1.2.cmml">ℱ</mi><mi id="A5.p1.7.m7.1.1.3" xref="A5.p1.7.m7.1.1.3.cmml">𝐬</mi></msub><annotation-xml encoding="MathML-Content" id="A5.p1.7.m7.1b"><apply id="A5.p1.7.m7.1.1.cmml" xref="A5.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A5.p1.7.m7.1.1.1.cmml" xref="A5.p1.7.m7.1.1">subscript</csymbol><ci id="A5.p1.7.m7.1.1.2.cmml" xref="A5.p1.7.m7.1.1.2">ℱ</ci><ci id="A5.p1.7.m7.1.1.3.cmml" xref="A5.p1.7.m7.1.1.3">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.7.m7.1c">\mathcal{F}_{\mathbf{s}}</annotation></semantics></math> sharply drops <math id="A5.p1.8.m8.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="A5.p1.8.m8.1a"><mrow id="A5.p1.8.m8.1.1" xref="A5.p1.8.m8.1.1.cmml"><mi id="A5.p1.8.m8.1.1.2" xref="A5.p1.8.m8.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A5.p1.8.m8.1.1.1" xref="A5.p1.8.m8.1.1.1.cmml">​</mo><msub id="A5.p1.8.m8.1.1.3" xref="A5.p1.8.m8.1.1.3.cmml"><mi id="A5.p1.8.m8.1.1.3.2" xref="A5.p1.8.m8.1.1.3.2.cmml">P</mi><mn id="A5.p1.8.m8.1.1.3.3" xref="A5.p1.8.m8.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.8.m8.1b"><apply id="A5.p1.8.m8.1.1.cmml" xref="A5.p1.8.m8.1.1"><times id="A5.p1.8.m8.1.1.1.cmml" xref="A5.p1.8.m8.1.1.1"></times><ci id="A5.p1.8.m8.1.1.2.cmml" xref="A5.p1.8.m8.1.1.2">𝐴</ci><apply id="A5.p1.8.m8.1.1.3.cmml" xref="A5.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="A5.p1.8.m8.1.1.3.1.cmml" xref="A5.p1.8.m8.1.1.3">subscript</csymbol><ci id="A5.p1.8.m8.1.1.3.2.cmml" xref="A5.p1.8.m8.1.1.3.2">𝑃</ci><cn type="float" id="A5.p1.8.m8.1.1.3.3.cmml" xref="A5.p1.8.m8.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.8.m8.1c">AP_{.5}</annotation></semantics></math> to <math id="A5.p1.9.m9.1" class="ltx_Math" alttext="9.1" display="inline"><semantics id="A5.p1.9.m9.1a"><mn id="A5.p1.9.m9.1.1" xref="A5.p1.9.m9.1.1.cmml">9.1</mn><annotation-xml encoding="MathML-Content" id="A5.p1.9.m9.1b"><cn type="float" id="A5.p1.9.m9.1.1.cmml" xref="A5.p1.9.m9.1.1">9.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.9.m9.1c">9.1</annotation></semantics></math> (iii) <span id="A5.p1.14.3" class="ltx_text ltx_font_italic">Increasing tiling</span> from <math id="A5.p1.10.m10.2" class="ltx_Math" alttext="n\in[1,7]" display="inline"><semantics id="A5.p1.10.m10.2a"><mrow id="A5.p1.10.m10.2.3" xref="A5.p1.10.m10.2.3.cmml"><mi id="A5.p1.10.m10.2.3.2" xref="A5.p1.10.m10.2.3.2.cmml">n</mi><mo id="A5.p1.10.m10.2.3.1" xref="A5.p1.10.m10.2.3.1.cmml">∈</mo><mrow id="A5.p1.10.m10.2.3.3.2" xref="A5.p1.10.m10.2.3.3.1.cmml"><mo stretchy="false" id="A5.p1.10.m10.2.3.3.2.1" xref="A5.p1.10.m10.2.3.3.1.cmml">[</mo><mn id="A5.p1.10.m10.1.1" xref="A5.p1.10.m10.1.1.cmml">1</mn><mo id="A5.p1.10.m10.2.3.3.2.2" xref="A5.p1.10.m10.2.3.3.1.cmml">,</mo><mn id="A5.p1.10.m10.2.2" xref="A5.p1.10.m10.2.2.cmml">7</mn><mo stretchy="false" id="A5.p1.10.m10.2.3.3.2.3" xref="A5.p1.10.m10.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.10.m10.2b"><apply id="A5.p1.10.m10.2.3.cmml" xref="A5.p1.10.m10.2.3"><in id="A5.p1.10.m10.2.3.1.cmml" xref="A5.p1.10.m10.2.3.1"></in><ci id="A5.p1.10.m10.2.3.2.cmml" xref="A5.p1.10.m10.2.3.2">𝑛</ci><interval closure="closed" id="A5.p1.10.m10.2.3.3.1.cmml" xref="A5.p1.10.m10.2.3.3.2"><cn type="integer" id="A5.p1.10.m10.1.1.cmml" xref="A5.p1.10.m10.1.1">1</cn><cn type="integer" id="A5.p1.10.m10.2.2.cmml" xref="A5.p1.10.m10.2.2">7</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.10.m10.2c">n\in[1,7]</annotation></semantics></math> to <math id="A5.p1.11.m11.2" class="ltx_Math" alttext="n\in[1,17]" display="inline"><semantics id="A5.p1.11.m11.2a"><mrow id="A5.p1.11.m11.2.3" xref="A5.p1.11.m11.2.3.cmml"><mi id="A5.p1.11.m11.2.3.2" xref="A5.p1.11.m11.2.3.2.cmml">n</mi><mo id="A5.p1.11.m11.2.3.1" xref="A5.p1.11.m11.2.3.1.cmml">∈</mo><mrow id="A5.p1.11.m11.2.3.3.2" xref="A5.p1.11.m11.2.3.3.1.cmml"><mo stretchy="false" id="A5.p1.11.m11.2.3.3.2.1" xref="A5.p1.11.m11.2.3.3.1.cmml">[</mo><mn id="A5.p1.11.m11.1.1" xref="A5.p1.11.m11.1.1.cmml">1</mn><mo id="A5.p1.11.m11.2.3.3.2.2" xref="A5.p1.11.m11.2.3.3.1.cmml">,</mo><mn id="A5.p1.11.m11.2.2" xref="A5.p1.11.m11.2.2.cmml">17</mn><mo stretchy="false" id="A5.p1.11.m11.2.3.3.2.3" xref="A5.p1.11.m11.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.11.m11.2b"><apply id="A5.p1.11.m11.2.3.cmml" xref="A5.p1.11.m11.2.3"><in id="A5.p1.11.m11.2.3.1.cmml" xref="A5.p1.11.m11.2.3.1"></in><ci id="A5.p1.11.m11.2.3.2.cmml" xref="A5.p1.11.m11.2.3.2">𝑛</ci><interval closure="closed" id="A5.p1.11.m11.2.3.3.1.cmml" xref="A5.p1.11.m11.2.3.3.2"><cn type="integer" id="A5.p1.11.m11.1.1.cmml" xref="A5.p1.11.m11.1.1">1</cn><cn type="integer" id="A5.p1.11.m11.2.2.cmml" xref="A5.p1.11.m11.2.2">17</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.11.m11.2c">n\in[1,17]</annotation></semantics></math> reduces <math id="A5.p1.12.m12.1" class="ltx_Math" alttext="AP_{.5}" display="inline"><semantics id="A5.p1.12.m12.1a"><mrow id="A5.p1.12.m12.1.1" xref="A5.p1.12.m12.1.1.cmml"><mi id="A5.p1.12.m12.1.1.2" xref="A5.p1.12.m12.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A5.p1.12.m12.1.1.1" xref="A5.p1.12.m12.1.1.1.cmml">​</mo><msub id="A5.p1.12.m12.1.1.3" xref="A5.p1.12.m12.1.1.3.cmml"><mi id="A5.p1.12.m12.1.1.3.2" xref="A5.p1.12.m12.1.1.3.2.cmml">P</mi><mn id="A5.p1.12.m12.1.1.3.3" xref="A5.p1.12.m12.1.1.3.3.cmml">.5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.12.m12.1b"><apply id="A5.p1.12.m12.1.1.cmml" xref="A5.p1.12.m12.1.1"><times id="A5.p1.12.m12.1.1.1.cmml" xref="A5.p1.12.m12.1.1.1"></times><ci id="A5.p1.12.m12.1.1.2.cmml" xref="A5.p1.12.m12.1.1.2">𝐴</ci><apply id="A5.p1.12.m12.1.1.3.cmml" xref="A5.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="A5.p1.12.m12.1.1.3.1.cmml" xref="A5.p1.12.m12.1.1.3">subscript</csymbol><ci id="A5.p1.12.m12.1.1.3.2.cmml" xref="A5.p1.12.m12.1.1.3.2">𝑃</ci><cn type="float" id="A5.p1.12.m12.1.1.3.3.cmml" xref="A5.p1.12.m12.1.1.3.3">.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.12.m12.1c">AP_{.5}</annotation></semantics></math> to <math id="A5.p1.13.m13.1" class="ltx_Math" alttext="11.3" display="inline"><semantics id="A5.p1.13.m13.1a"><mn id="A5.p1.13.m13.1.1" xref="A5.p1.13.m13.1.1.cmml">11.3</mn><annotation-xml encoding="MathML-Content" id="A5.p1.13.m13.1b"><cn type="float" id="A5.p1.13.m13.1.1.cmml" xref="A5.p1.13.m13.1.1">11.3</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.13.m13.1c">11.3</annotation></semantics></math> due to high occlusion (<math id="A5.p1.14.m14.1" class="ltx_Math" alttext="n\rightarrow 17" display="inline"><semantics id="A5.p1.14.m14.1a"><mrow id="A5.p1.14.m14.1.1" xref="A5.p1.14.m14.1.1.cmml"><mi id="A5.p1.14.m14.1.1.2" xref="A5.p1.14.m14.1.1.2.cmml">n</mi><mo stretchy="false" id="A5.p1.14.m14.1.1.1" xref="A5.p1.14.m14.1.1.1.cmml">→</mo><mn id="A5.p1.14.m14.1.1.3" xref="A5.p1.14.m14.1.1.3.cmml">17</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.14.m14.1b"><apply id="A5.p1.14.m14.1.1.cmml" xref="A5.p1.14.m14.1.1"><ci id="A5.p1.14.m14.1.1.1.cmml" xref="A5.p1.14.m14.1.1.1">→</ci><ci id="A5.p1.14.m14.1.1.2.cmml" xref="A5.p1.14.m14.1.1.2">𝑛</ci><cn type="integer" id="A5.p1.14.m14.1.1.3.cmml" xref="A5.p1.14.m14.1.1.3">17</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.14.m14.1c">n\rightarrow 17</annotation></semantics></math>).</p>
</div>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Robustness to Tiling</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.5" class="ltx_p">To test robustness, we generate occluded photos by randomly masking <math id="A6.p1.1.m1.3" class="ltx_Math" alttext="(10\%,30\%,50\%)" display="inline"><semantics id="A6.p1.1.m1.3a"><mrow id="A6.p1.1.m1.3.3.3" xref="A6.p1.1.m1.3.3.4.cmml"><mo stretchy="false" id="A6.p1.1.m1.3.3.3.4" xref="A6.p1.1.m1.3.3.4.cmml">(</mo><mrow id="A6.p1.1.m1.1.1.1.1" xref="A6.p1.1.m1.1.1.1.1.cmml"><mn id="A6.p1.1.m1.1.1.1.1.2" xref="A6.p1.1.m1.1.1.1.1.2.cmml">10</mn><mo id="A6.p1.1.m1.1.1.1.1.1" xref="A6.p1.1.m1.1.1.1.1.1.cmml">%</mo></mrow><mo id="A6.p1.1.m1.3.3.3.5" xref="A6.p1.1.m1.3.3.4.cmml">,</mo><mrow id="A6.p1.1.m1.2.2.2.2" xref="A6.p1.1.m1.2.2.2.2.cmml"><mn id="A6.p1.1.m1.2.2.2.2.2" xref="A6.p1.1.m1.2.2.2.2.2.cmml">30</mn><mo id="A6.p1.1.m1.2.2.2.2.1" xref="A6.p1.1.m1.2.2.2.2.1.cmml">%</mo></mrow><mo id="A6.p1.1.m1.3.3.3.6" xref="A6.p1.1.m1.3.3.4.cmml">,</mo><mrow id="A6.p1.1.m1.3.3.3.3" xref="A6.p1.1.m1.3.3.3.3.cmml"><mn id="A6.p1.1.m1.3.3.3.3.2" xref="A6.p1.1.m1.3.3.3.3.2.cmml">50</mn><mo id="A6.p1.1.m1.3.3.3.3.1" xref="A6.p1.1.m1.3.3.3.3.1.cmml">%</mo></mrow><mo stretchy="false" id="A6.p1.1.m1.3.3.3.7" xref="A6.p1.1.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.1.m1.3b"><vector id="A6.p1.1.m1.3.3.4.cmml" xref="A6.p1.1.m1.3.3.3"><apply id="A6.p1.1.m1.1.1.1.1.cmml" xref="A6.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="A6.p1.1.m1.1.1.1.1.1.cmml" xref="A6.p1.1.m1.1.1.1.1.1">percent</csymbol><cn type="integer" id="A6.p1.1.m1.1.1.1.1.2.cmml" xref="A6.p1.1.m1.1.1.1.1.2">10</cn></apply><apply id="A6.p1.1.m1.2.2.2.2.cmml" xref="A6.p1.1.m1.2.2.2.2"><csymbol cd="latexml" id="A6.p1.1.m1.2.2.2.2.1.cmml" xref="A6.p1.1.m1.2.2.2.2.1">percent</csymbol><cn type="integer" id="A6.p1.1.m1.2.2.2.2.2.cmml" xref="A6.p1.1.m1.2.2.2.2.2">30</cn></apply><apply id="A6.p1.1.m1.3.3.3.3.cmml" xref="A6.p1.1.m1.3.3.3.3"><csymbol cd="latexml" id="A6.p1.1.m1.3.3.3.3.1.cmml" xref="A6.p1.1.m1.3.3.3.3.1">percent</csymbol><cn type="integer" id="A6.p1.1.m1.3.3.3.3.2.cmml" xref="A6.p1.1.m1.3.3.3.3.2">50</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.1.m1.3c">(10\%,30\%,50\%)</annotation></semantics></math> of GT object boundaries with zero pixel values and measure the respective drop in accuracy (<math id="A6.p1.2.m2.1" class="ltx_math_unparsed" alttext="AP_{.5})" display="inline"><semantics id="A6.p1.2.m2.1a"><mrow id="A6.p1.2.m2.1b"><mi id="A6.p1.2.m2.1.1">A</mi><msub id="A6.p1.2.m2.1.2"><mi id="A6.p1.2.m2.1.2.2">P</mi><mn id="A6.p1.2.m2.1.2.3">.5</mn></msub><mo stretchy="false" id="A6.p1.2.m2.1.3">)</mo></mrow><annotation encoding="application/x-tex" id="A6.p1.2.m2.1c">AP_{.5})</annotation></semantics></math> on <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. Performance drop being less <span id="A6.p1.5.1" class="ltx_text ltx_font_italic">with tiling</span> for E-WSDDN (by <math id="A6.p1.3.m3.3" class="ltx_Math" alttext="\{1.7,3.4,5.7\}" display="inline"><semantics id="A6.p1.3.m3.3a"><mrow id="A6.p1.3.m3.3.4.2" xref="A6.p1.3.m3.3.4.1.cmml"><mo stretchy="false" id="A6.p1.3.m3.3.4.2.1" xref="A6.p1.3.m3.3.4.1.cmml">{</mo><mn id="A6.p1.3.m3.1.1" xref="A6.p1.3.m3.1.1.cmml">1.7</mn><mo id="A6.p1.3.m3.3.4.2.2" xref="A6.p1.3.m3.3.4.1.cmml">,</mo><mn id="A6.p1.3.m3.2.2" xref="A6.p1.3.m3.2.2.cmml">3.4</mn><mo id="A6.p1.3.m3.3.4.2.3" xref="A6.p1.3.m3.3.4.1.cmml">,</mo><mn id="A6.p1.3.m3.3.3" xref="A6.p1.3.m3.3.3.cmml">5.7</mn><mo stretchy="false" id="A6.p1.3.m3.3.4.2.4" xref="A6.p1.3.m3.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.3.m3.3b"><set id="A6.p1.3.m3.3.4.1.cmml" xref="A6.p1.3.m3.3.4.2"><cn type="float" id="A6.p1.3.m3.1.1.cmml" xref="A6.p1.3.m3.1.1">1.7</cn><cn type="float" id="A6.p1.3.m3.2.2.cmml" xref="A6.p1.3.m3.2.2">3.4</cn><cn type="float" id="A6.p1.3.m3.3.3.cmml" xref="A6.p1.3.m3.3.3">5.7</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.3.m3.3c">\{1.7,3.4,5.7\}</annotation></semantics></math>) or our method (by <math id="A6.p1.4.m4.3" class="ltx_Math" alttext="\{1.6,3.3,5.4\}" display="inline"><semantics id="A6.p1.4.m4.3a"><mrow id="A6.p1.4.m4.3.4.2" xref="A6.p1.4.m4.3.4.1.cmml"><mo stretchy="false" id="A6.p1.4.m4.3.4.2.1" xref="A6.p1.4.m4.3.4.1.cmml">{</mo><mn id="A6.p1.4.m4.1.1" xref="A6.p1.4.m4.1.1.cmml">1.6</mn><mo id="A6.p1.4.m4.3.4.2.2" xref="A6.p1.4.m4.3.4.1.cmml">,</mo><mn id="A6.p1.4.m4.2.2" xref="A6.p1.4.m4.2.2.cmml">3.3</mn><mo id="A6.p1.4.m4.3.4.2.3" xref="A6.p1.4.m4.3.4.1.cmml">,</mo><mn id="A6.p1.4.m4.3.3" xref="A6.p1.4.m4.3.3.cmml">5.4</mn><mo stretchy="false" id="A6.p1.4.m4.3.4.2.4" xref="A6.p1.4.m4.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.4.m4.3b"><set id="A6.p1.4.m4.3.4.1.cmml" xref="A6.p1.4.m4.3.4.2"><cn type="float" id="A6.p1.4.m4.1.1.cmml" xref="A6.p1.4.m4.1.1">1.6</cn><cn type="float" id="A6.p1.4.m4.2.2.cmml" xref="A6.p1.4.m4.2.2">3.3</cn><cn type="float" id="A6.p1.4.m4.3.3.cmml" xref="A6.p1.4.m4.3.3">5.4</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.4.m4.3c">\{1.6,3.3,5.4\}</annotation></semantics></math>), than <span id="A6.p1.5.2" class="ltx_text ltx_font_italic">without tiling</span> in WSDDN (by <math id="A6.p1.5.m5.3" class="ltx_Math" alttext="\{3.1,5.2,7.5\}" display="inline"><semantics id="A6.p1.5.m5.3a"><mrow id="A6.p1.5.m5.3.4.2" xref="A6.p1.5.m5.3.4.1.cmml"><mo stretchy="false" id="A6.p1.5.m5.3.4.2.1" xref="A6.p1.5.m5.3.4.1.cmml">{</mo><mn id="A6.p1.5.m5.1.1" xref="A6.p1.5.m5.1.1.cmml">3.1</mn><mo id="A6.p1.5.m5.3.4.2.2" xref="A6.p1.5.m5.3.4.1.cmml">,</mo><mn id="A6.p1.5.m5.2.2" xref="A6.p1.5.m5.2.2.cmml">5.2</mn><mo id="A6.p1.5.m5.3.4.2.3" xref="A6.p1.5.m5.3.4.1.cmml">,</mo><mn id="A6.p1.5.m5.3.3" xref="A6.p1.5.m5.3.3.cmml">7.5</mn><mo stretchy="false" id="A6.p1.5.m5.3.4.2.4" xref="A6.p1.5.m5.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.5.m5.3b"><set id="A6.p1.5.m5.3.4.1.cmml" xref="A6.p1.5.m5.3.4.2"><cn type="float" id="A6.p1.5.m5.1.1.cmml" xref="A6.p1.5.m5.1.1">3.1</cn><cn type="float" id="A6.p1.5.m5.2.2.cmml" xref="A6.p1.5.m5.2.2">5.2</cn><cn type="float" id="A6.p1.5.m5.3.3.cmml" xref="A6.p1.5.m5.3.3">7.5</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.5.m5.3c">\{3.1,5.2,7.5\}</annotation></semantics></math>) verifies robustness due to tiling on object detection.</p>
</div>
</section>
<section id="A7" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Clarification on CutMix <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib103" title="" class="ltx_ref">103</a>]</cite> vs. our Tiling</h2>

<div id="A7.p1" class="ltx_para">
<p id="A7.p1.1" class="ltx_p">(i) Our novelty lies in adapting well-known modules (CLIP, SBIR) to train an object detector from only object-level sketch-photo pairs (each photo has only one object) without any bounding-box annotations. (ii) Despite sharing a common technical implementation, CutMix <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib103" title="" class="ltx_ref">103</a>]</cite> is a data <span id="A7.p1.1.1" class="ltx_text ltx_font_italic">augmentation</span> tool that typically replaces a patch in one <span id="A7.p1.1.2" class="ltx_text ltx_font_italic">existing</span> scene-photo with that from another. Contrarily, tiling is a data <span id="A7.p1.1.3" class="ltx_text ltx_font_italic">synthesis</span> tool that combines multiple object-level photos in the SBIR dataset to <span id="A7.p1.1.4" class="ltx_text ltx_font_italic">newly create</span> a scene photo for subsequent training.</p>
</div>
<figure id="A7.F10" class="ltx_figure"><img src="/html/2303.15149/assets/x12.png" id="A7.F10.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="395" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A7.F10.10.3.1" class="ltx_text" style="font-size:90%;">Figure 10</span>: </span><span id="A7.F10.4.2" class="ltx_text" style="font-size:90%;">Additional qualitative results for fine-grained and part-level object detection on SketchyCOCO. Note both the <span id="A7.F10.4.2.1" class="ltx_text" style="color:#0000FF;">Blue</span> and <span id="A7.F10.4.2.2" class="ltx_text" style="color:#FFFF00;">Yellow</span> boxes are network predictions and not ground truth. The <span id="A7.F10.4.2.3" class="ltx_text" style="color:#0000FF;">Blue</span> boxes are predictions from the network prior to using Non-maximum suppression (NMS) with the confidence score of the predicted box <math id="A7.F10.3.1.m1.1" class="ltx_Math" alttext="\omega_{k}\geq 0.7" display="inline"><semantics id="A7.F10.3.1.m1.1b"><mrow id="A7.F10.3.1.m1.1.1" xref="A7.F10.3.1.m1.1.1.cmml"><msub id="A7.F10.3.1.m1.1.1.2" xref="A7.F10.3.1.m1.1.1.2.cmml"><mi id="A7.F10.3.1.m1.1.1.2.2" xref="A7.F10.3.1.m1.1.1.2.2.cmml">ω</mi><mi id="A7.F10.3.1.m1.1.1.2.3" xref="A7.F10.3.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="A7.F10.3.1.m1.1.1.1" xref="A7.F10.3.1.m1.1.1.1.cmml">≥</mo><mn id="A7.F10.3.1.m1.1.1.3" xref="A7.F10.3.1.m1.1.1.3.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.F10.3.1.m1.1c"><apply id="A7.F10.3.1.m1.1.1.cmml" xref="A7.F10.3.1.m1.1.1"><geq id="A7.F10.3.1.m1.1.1.1.cmml" xref="A7.F10.3.1.m1.1.1.1"></geq><apply id="A7.F10.3.1.m1.1.1.2.cmml" xref="A7.F10.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A7.F10.3.1.m1.1.1.2.1.cmml" xref="A7.F10.3.1.m1.1.1.2">subscript</csymbol><ci id="A7.F10.3.1.m1.1.1.2.2.cmml" xref="A7.F10.3.1.m1.1.1.2.2">𝜔</ci><ci id="A7.F10.3.1.m1.1.1.2.3.cmml" xref="A7.F10.3.1.m1.1.1.2.3">𝑘</ci></apply><cn type="float" id="A7.F10.3.1.m1.1.1.3.cmml" xref="A7.F10.3.1.m1.1.1.3">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.F10.3.1.m1.1d">\omega_{k}\geq 0.7</annotation></semantics></math>. The <span id="A7.F10.4.2.4" class="ltx_text" style="color:#FFFF00;">Yellow</span> boxes are the resulting predictions after applying NMS with <math id="A7.F10.4.2.m2.1" class="ltx_Math" alttext="\mathrm{IoU}\geq 0.3" display="inline"><semantics id="A7.F10.4.2.m2.1b"><mrow id="A7.F10.4.2.m2.1.1" xref="A7.F10.4.2.m2.1.1.cmml"><mi id="A7.F10.4.2.m2.1.1.2" xref="A7.F10.4.2.m2.1.1.2.cmml">IoU</mi><mo id="A7.F10.4.2.m2.1.1.1" xref="A7.F10.4.2.m2.1.1.1.cmml">≥</mo><mn id="A7.F10.4.2.m2.1.1.3" xref="A7.F10.4.2.m2.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.F10.4.2.m2.1c"><apply id="A7.F10.4.2.m2.1.1.cmml" xref="A7.F10.4.2.m2.1.1"><geq id="A7.F10.4.2.m2.1.1.1.cmml" xref="A7.F10.4.2.m2.1.1.1"></geq><ci id="A7.F10.4.2.m2.1.1.2.cmml" xref="A7.F10.4.2.m2.1.1.2">IoU</ci><cn type="float" id="A7.F10.4.2.m2.1.1.3.cmml" xref="A7.F10.4.2.m2.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.F10.4.2.m2.1d">\mathrm{IoU}\geq 0.3</annotation></semantics></math></span></figcaption>
</figure>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Stephan Alaniz, Massimiliano Mancini, Anjan Dutta, Diego Marcos, and Zeynep Akata.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Abstracting sketches through simple primitives.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Abhijit Bendale and Terrance Boult.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Towards Open World Recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Ayan Kumar Bhunia, Pinaki Nath Chowdhury, Aneeshan Sain, Yongxin Yang, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">More photos are all you need: Semi-supervised learning for fine-grained sketch based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Ayan Kumar Bhunia, Pinaki Nath Chowdhury, Yongxin Yang, Timothy M. Hospedales, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Vectorization and rasterization: Self-supervised learning for sketch and handwriting.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Ayan Kumar Bhunia, Ayan Das, Umar Riaz Muhammad, Yongxin Yang, Timothy M. Hospedales, Tao Xiang, Yulia Gryaditskaya, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Pixelor: a competitive sketching ai agent. so you think you can sketch?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM TOG</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Ayan Kumar Bhunia, Viswanatha Reddy Gajjala, Subhadeep Koley, Rohit Kundu, Aneeshan Sain, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Doodle it yourself: Class incremental learning by drawing a few sketches.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Ayan Kumar Bhunia, Subhadeep Koley, Abdullah Faiz Ur Rahman Khilji, Aneeshan Sain, Pinaki Nath Chowdhury, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Sketching without worrying: Noise-tolerant sketch-based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Ayan Kumar Bhunia, Subhadeep Koley, Amandeep Kumar, Aneeshan Sain, Pinaki Nath Chowdhury, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Sketch2Saliency: Learning to Detect Salient Objects from Human Drawings.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Ayan Kumar Bhunia, Aneeshan Sain, Parth Shah, Animesh Gupta, Pinaki Nath Chowdhury, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Adaptive fine-grained sketch-based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Ayan Kumar Bhunia, Yongxin Yang, Timothy M. Hospedales, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Sketch less for more: On-the-fly fine-grained sketch based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Hakan Bilen and Andrea Vedaldi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Weakly supervised deep detection networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Pengguang Chen, Shu Liu, Hengshuang Zhao, and Jiaya Jia.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Gridmask data augmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2001.04086</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Pinaki Nath Chowdhury, Ayan Kumar Bhunia, Viswanatha Reddy Gajjala, Aneeshan Sain, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Partially Does It: towards scene-level FG-SBIR with partial input.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Pinaki Nath Chowdhury, Ayan Kumar Bhunia, Aneeshan Sain, Subhadeep Koley, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">SceneTrilogy: On Human Scene-Sketch and its Complementarity with Photo and Text.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Pinaki Nath Chowdhury, Aneeshan Sain, Yulia Gryaditskaya, Ayan Kumar Bhunia, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Fs-coco: Towards understanding of freehand sketches of common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Pinaki Nath Chowdhury, Tuanfeng Wang, Duygu Ceylan, Yi-Zhe Song, and Yulia Gryaditskaya.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Garment ideation: Iterative view-aware sketch-based garment modeling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">3DV</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
John Collomosse, Tu Bui, and Jin Hailin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Livesketch: Query perturbations for guided sketch-based visual search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Ayan Das, Yongxin Yang, Timothy Hospedales, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Sketchode: Learning neural sketch representation in continuous time.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Terrance DeVries and Graham W Taylor.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Improved regularization of convolutional neural networks with cutout.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1708.04552</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Sounak Dey, Pau Riba, Anjan Dutta, Josep Llados, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Doodle to search: Practical zero-shot sketch-based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Ali Diba, Vivek Sharma, Ali Pazandeh, Hamed Pirsiavash, and Luc Van Gool.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Weakly supervised cascaded convolutional networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Thomas G. Dietterich, Richard H. Lathrop, and Tomás Lozano-Pérez.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Solving the multiple instance problem with axis-parallel rectangles.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Artificial Intelligence</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, 1997.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvian Gelly, Jakob Uszkoreit, and Neil Houlsby.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">An image is worth 16x16 words: Transformers for image recognition at scale.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Mark Everingham, Luc Van Gool, Christopher K. I. Williams, John Winn, and Andrew Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">The pascal visual object classes (voc) challenge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IJCV</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, 2010.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Yaroslav Ganin and Victor Lempitsky.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Unsupervised domain adaptation by backpropagation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Chengying Gao, Qi Liu, Qi Xu, Limin Wang, Jianzhuang Liu, and Changqing Zou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Sketchycoco: Image generation from freehand scene sketches.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Fast-rcnn.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Ross Girshick, Jeff Donahue, Trevor Darrell, and Jitendra Malik.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Rich feature hierarchies for accurate object detection and semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Todd Goodwin, Ian Vollick, and Aaron Hertzmann.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Isophote distance: A shading approach to artistic stroke thickness.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NPAR</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, 2007.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Xiuye Gu, Tsung-Yi Lin, Weicheng Kuo, and Yin Cui.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Open-vocabulary object detection via vision and language knowledge distillation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
David Ha and Douglas Eck.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">A neural representation of sketch drawings.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Cusuh Ham, Gemma Canet Tarres, Tu Bui, James Hays, Zhe Lin, and John Collomosse.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Cogs: Controllable generation and search from sketch and style.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Georgia Gkioxari, Piotr Dollár, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Mask r-cnn.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Byeongho Heo, Jeesoo Kim, Sangdoo Yun, Hyojin Park, Nojun Kwak, and Jin Young Choi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">A comprehensive overhaul of feature distillation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib35.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib35.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Aaron Hertzmann.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Why do line drawings work? a realism hypothesis.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Perception</span><span id="bib.bib36.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Ting-I Hsieh, Yi-Chen Lo, Hwann-Tzong Chen, and Tyng-Luh Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">One-shot object detection with co-attention and co-excitation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib37.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib37.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Conghui Hu, Da Li, Yi-Zhe Song, Tao Xiang, and Timothy M. Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Sketch-a-classifier: Sketch-based photo classifier generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib38.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib38.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Conghui Hu, Da Li, Yongxin Yang, Timothy M. Hospedales, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Sketch-a-segmenter: Sketch-based photo segmenter generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE-TIP</span><span id="bib.bib39.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Menglin Jia, Luming Tang, Bor-Chun Chen, Claire Cardie, Serge Belongie, Bharath Hariharan, and Ser-Nam Lim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Visual prompt tuning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib40.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib40.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Zequn Jie, Yunchao Wei, Xiaojie Jin, Jaishi Feng, and Wei Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Deep self-taught learning for weakly supervised object localization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
K J Joseph, Salman Khan, Fahad Shahbaz Khan, and Vineeth N Balasubramanian.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Towards Open World Object Detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
John M. Kennedy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">A psychology of picture perception: Images and information.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Jossey-Bass Publishers</span><span id="bib.bib43.4.2" class="ltx_text" style="font-size:90%;">, 1974.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Muhammad Uzair Khattak, Hanoona Rasheed, Muhammad Maaz, Salman Khan, and Fahad Shahbaz Khan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Maple: Multi-modal prompt learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2210.03117</span><span id="bib.bib44.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Kazuma Kobayashi, Lin Gu, Ryuichiro Hataya, Takaaki Mizuno, Mototaka Miyake, Hirokazu Watanabe, Masamichi Takahashi, Yasuyuki Takamizawa, Yukihiro Yoshida, Satoshi Nakamura, Nobuji Kouno, Amina Bolatkan, Yusuke Kurose, Tatsuya Harada, and Ryuji Hamamoto.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Sketch-based Medical Image Retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2303.03633</span><span id="bib.bib45.4.2" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Subhadeep Koley, Ayan Kumar Bhunia, Aneeshan Sain, Pinaki Nath Chowdhury, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Picture that Sketch: Photorealistic Image Generation from Abstract Sketches.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib46.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib46.5.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A Shamma, Michael Bernstein, and Li Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">Visual genome: Connecting language and vision using crowdsourced dense image annotations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IJCV</span><span id="bib.bib47.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text" style="font-size:90%;">
Hei Law and Jia Deng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.2.1" class="ltx_text" style="font-size:90%;">Cornernet: Detecting objects as paired keypoints.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib48.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib48.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text" style="font-size:90%;">
Chunggi Lee, Seonwook Park, Heon Song, Jeongun Ryu, Sanghoon Kim, Haejoon Kim, Sérgio Pereira, and Donggeun Yoo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.2.1" class="ltx_text" style="font-size:90%;">Interactive multi-class tiny-object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib49.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib49.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text" style="font-size:90%;">
Dong Li, Jia-Bin Huang, Yali Li, Shengjin Wang, and Ming-Hsuan Yang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.2.1" class="ltx_text" style="font-size:90%;">Weakly supervised object localization with progressive domain adaptation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib50.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib50.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text" style="font-size:90%;">
Gen Li, Varun Jampani, Laura Sevilla-Lara, Deqing Sun, Jonghyun Kim, and Joongkyu Kim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.2.1" class="ltx_text" style="font-size:90%;">Adaptive prototype learning and allocation for few-shot segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib51.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib51.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Piotr , Dollár, Ross Girshick, Kaiming He, Bharath Hariharan, and Serge Belongie.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.2.1" class="ltx_text" style="font-size:90%;">Feature pyramid networks for object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib52.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib52.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span id="bib.bib53.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Dollár.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.2.1" class="ltx_text" style="font-size:90%;">Focal loss for dense object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib53.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib53.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span id="bib.bib54.1.1" class="ltx_text" style="font-size:90%;">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva Ramanan, Piotr Dollár, and C. Lawrence Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.2.1" class="ltx_text" style="font-size:90%;">Microsoft coco: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib54.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib54.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text" style="font-size:90%;">
Fang Liu, Changqing Zhou, Xiaoming Deng, Ran Zuo, Yu-Kun Lai, Cuixia Ma, Yong-Jin Liu, and Hongan Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.2.1" class="ltx_text" style="font-size:90%;">Scenesketcher: Fine-grained image retrieval with scene sketches.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib55.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib55.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock"><span id="bib.bib56.1.1" class="ltx_text" style="font-size:90%;">
Feng-Lin Liu, Shu-Yu Chen, Yu-Kun Lai, Chunpeng Li, Yue-Ren Jiang, Hongbo Fu, and Lin Gao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.2.1" class="ltx_text" style="font-size:90%;">DeepFaceVideoEditing: Sketch-based deep editing of face videos.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM TOG</span><span id="bib.bib56.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text" style="font-size:90%;">
Wei Liu, Dragomir Anguelov, Dumitru Erhan, Christian Szegedy, Scott Reed, Cheng-Yang Fu, and Alexander C. Berg.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.2.1" class="ltx_text" style="font-size:90%;">Ssd: Single shot multibox detector.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib57.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib57.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock"><span id="bib.bib58.1.1" class="ltx_text" style="font-size:90%;">
Tomas Mikolov, Kai Chen, Greg Corrado, and Jeffrey Dean.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.2.1" class="ltx_text" style="font-size:90%;">Efficient estimation of word representations in vector space.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib58.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib58.5.3" class="ltx_text" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text" style="font-size:90%;">
Matthias Minderer, Alexey Gritsenko, Austin Stone, Maxim Neumann, Dirk Weissenborn, Alexey Dosovitskiy, Aravindh Mahendran, Anurag Arnab, Mostafa Dehghani, Zhuran Shen, Xiao Wang, Xiaohua Zhai, Thomas Kipf, and Neil Houlsby.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib59.2.1" class="ltx_text" style="font-size:90%;">Simple open-vocabulary object detection with vision transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib59.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib59.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib59.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock"><span id="bib.bib60.1.1" class="ltx_text" style="font-size:90%;">
Panagiotis Mouzenidis, Antonios Louros, Dimitrios Konstantinidis, Kosmas Dimitropoulos, and Petros Daras.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib60.2.1" class="ltx_text" style="font-size:90%;">Multi-modal variational faster-rcnn for improved visual object detection in manufacturing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib60.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib60.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib60.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock"><span id="bib.bib61.1.1" class="ltx_text" style="font-size:90%;">
Umar Riaz Muhammad, Yongxin Yang, Yi-Zhe Song, Tao Xiang, and Timothy M. Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib61.2.1" class="ltx_text" style="font-size:90%;">Learning deep sketch abstraction.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib61.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib61.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib61.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock"><span id="bib.bib62.1.1" class="ltx_text" style="font-size:90%;">
Kaiyue Pang, Ke Li, Yongxin Yang, Honggang Zhang, Timothy M. Hospedales, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib62.2.1" class="ltx_text" style="font-size:90%;">Generalising fine-grained sketch-based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib62.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib62.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib62.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock"><span id="bib.bib63.1.1" class="ltx_text" style="font-size:90%;">
Kaiyue Pang, Yi-Zhe Song, Tao Xiang, and Timothy M. Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib63.2.1" class="ltx_text" style="font-size:90%;">Cross-domain generative learning for fine-grained sketch-based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib63.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib63.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">BMVC</span><span id="bib.bib63.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock"><span id="bib.bib64.1.1" class="ltx_text" style="font-size:90%;">
Kaiyue Pang, Yongxin Yang, Timothy M. Hospedales, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib64.2.1" class="ltx_text" style="font-size:90%;">Solving mixed-modal jigsaw puzzle for fine-grained sketch-based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib64.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib64.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib64.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock"><span id="bib.bib65.1.1" class="ltx_text" style="font-size:90%;">
Anran Qi, Yulia Gryaditskaya, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib65.2.1" class="ltx_text" style="font-size:90%;">One sketch for all: One-shot personalized sketch segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib65.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE-TIP</span><span id="bib.bib65.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock"><span id="bib.bib66.1.1" class="ltx_text" style="font-size:90%;">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, Gretchen Krueger, and Ilya Sutskever.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib66.2.1" class="ltx_text" style="font-size:90%;">Learning transferable visual models from natural language supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib66.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib66.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib66.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock"><span id="bib.bib67.1.1" class="ltx_text" style="font-size:90%;">
Joseph Redmon, Santosh Divvala, Ross Girshick, and Ali Farhadi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib67.2.1" class="ltx_text" style="font-size:90%;">You only look once: Unified, real-time object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib67.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib67.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib67.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock"><span id="bib.bib68.1.1" class="ltx_text" style="font-size:90%;">
Joseph Redmon and Ali Farhadi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib68.2.1" class="ltx_text" style="font-size:90%;">Yolov3: An incremental improvement.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib68.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1804.02767</span><span id="bib.bib68.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock"><span id="bib.bib69.1.1" class="ltx_text" style="font-size:90%;">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib69.2.1" class="ltx_text" style="font-size:90%;">Faster r-cnn: Towards real-time object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib69.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib69.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib69.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock"><span id="bib.bib70.1.1" class="ltx_text" style="font-size:90%;">
Zhongzheng Ren, Zhiding Yu, Xiaodong Yang, Ming-Yu Liu, Yong Jae Lee, G. Schwing, Alexander, and Jan Kautz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib70.2.1" class="ltx_text" style="font-size:90%;">Instance-aware, context-focused, and memory-efficient weakly supervised object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib70.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib70.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib70.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock"><span id="bib.bib71.1.1" class="ltx_text" style="font-size:90%;">
Pau Riba, Sounak Dey, Ali Furkan Biten, and Josep Llados.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib71.2.1" class="ltx_text" style="font-size:90%;">Localizing infinity-shaped fishes: Sketch-guided object localization in the wild.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib71.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2109.11874</span><span id="bib.bib71.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock"><span id="bib.bib72.1.1" class="ltx_text" style="font-size:90%;">
Leo Sampaio Ferraz Ribeiro, Tui Bui, John Collomosse, and Moacir Ponti.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib72.2.1" class="ltx_text" style="font-size:90%;">Sketchformer: Transformer-based representation for sketched structure.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib72.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib72.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib72.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib73" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock"><span id="bib.bib73.1.1" class="ltx_text" style="font-size:90%;">
Aneeshan Sain, Ayan Kumar Bhunia, Pinaki Nath Chowdhury, Aneeshan Sain, Subhadeep Koley, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib73.2.1" class="ltx_text" style="font-size:90%;">CLIP for All Things Zero-Shot Sketch-Based Image Retrieval, Fine-Grained or Not.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib73.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib73.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib73.5.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib74" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[74]</span>
<span class="ltx_bibblock"><span id="bib.bib74.1.1" class="ltx_text" style="font-size:90%;">
Aneeshan Sain, Ayan Kumar Bhunia, Subhadeep Koley, Pinaki Nath Chowdhury, Soumitri Chattopadhyay, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib74.2.1" class="ltx_text" style="font-size:90%;">Exploiting Unlabelled Photos for Stronger Fine-Grained SBIR.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib74.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib74.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib74.5.3" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib75" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[75]</span>
<span class="ltx_bibblock"><span id="bib.bib75.1.1" class="ltx_text" style="font-size:90%;">
Aneeshan Sain, Ayan Kumar Bhunia, Vaishnav Potlapalli, Pinaki Nath Chowdhury, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib75.2.1" class="ltx_text" style="font-size:90%;">Sketch3t: Test-time training for zero-shot sbir.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib75.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib75.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib75.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib76" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[76]</span>
<span class="ltx_bibblock"><span id="bib.bib76.1.1" class="ltx_text" style="font-size:90%;">
Aneeshan Sain, Ayan Kumar Bhunia, Yongxin Yang, Tao Xiang, and Yi-Zhe Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib76.2.1" class="ltx_text" style="font-size:90%;">Stylemeup: Towards style-agnostic sketch-based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib76.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib76.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib76.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib77" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[77]</span>
<span class="ltx_bibblock"><span id="bib.bib77.1.1" class="ltx_text" style="font-size:90%;">
Patsorn Sangkloy, Nathan Burnell, Cusuh Ham, and James Hays.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib77.2.1" class="ltx_text" style="font-size:90%;">The sketchy database: Learning to retrieve badly drawn bunnies.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib77.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM TOG</span><span id="bib.bib77.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib78" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[78]</span>
<span class="ltx_bibblock"><span id="bib.bib78.1.1" class="ltx_text" style="font-size:90%;">
Bilge Sayim and Patrick Cavanagh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib78.2.1" class="ltx_text" style="font-size:90%;">What line drawings reveal about the visual brain.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib78.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Front. Hum. Neurosci.</span><span id="bib.bib78.4.2" class="ltx_text" style="font-size:90%;">, 2011.
</span>
</span>
</li>
<li id="bib.bib79" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[79]</span>
<span class="ltx_bibblock"><span id="bib.bib79.1.1" class="ltx_text" style="font-size:90%;">
Shiv Shankar, Vihari Piratla, Soumen Chakrabarti, Siddhartha Chaudhuri, Preethi Jyothi, and Sunita Sarawagi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib79.2.1" class="ltx_text" style="font-size:90%;">Generalizing across domains via cross-gradient training.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib79.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib79.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib79.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib80" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[80]</span>
<span class="ltx_bibblock"><span id="bib.bib80.1.1" class="ltx_text" style="font-size:90%;">
Feifei Shao, Long Chen, Jian Shao, Wei Ji, Shaoning Xiao, Lu Ye, Yueting Zhuang, and Jun Xiao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib80.2.1" class="ltx_text" style="font-size:90%;">Deep learning for weakly-supervised object detection and localization: A survey.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib80.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Neurocomputing</span><span id="bib.bib80.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib81" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[81]</span>
<span class="ltx_bibblock"><span id="bib.bib81.1.1" class="ltx_text" style="font-size:90%;">
Yunhang Shen, Rongrong Ji, Yan Wang, Yongjian Wu, and Liujuan Cao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib81.2.1" class="ltx_text" style="font-size:90%;">Cyclic guidance for weakly supervised joint detection and segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib81.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib81.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib81.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib82" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[82]</span>
<span class="ltx_bibblock"><span id="bib.bib82.1.1" class="ltx_text" style="font-size:90%;">
Karen Simonyan and Andrew Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib82.2.1" class="ltx_text" style="font-size:90%;">Very deep convolutional networks for large-scale image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib82.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib82.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib82.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib83" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[83]</span>
<span class="ltx_bibblock"><span id="bib.bib83.1.1" class="ltx_text" style="font-size:90%;">
Krishna Kumar Singh and Yong Jae Lee.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib83.2.1" class="ltx_text" style="font-size:90%;">Hide-and-seek: Forcing a network to be meticulous for weakly-supervised object and action localization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib83.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib83.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib83.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib84" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[84]</span>
<span class="ltx_bibblock"><span id="bib.bib84.1.1" class="ltx_text" style="font-size:90%;">
Jifei Song, Yi-Zhe Song, Tao Xiang, and Timothy Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib84.2.1" class="ltx_text" style="font-size:90%;">Fine-grained image retrieval: the text/sketch input dilemma.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib84.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib84.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">BMVC</span><span id="bib.bib84.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib85" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[85]</span>
<span class="ltx_bibblock"><span id="bib.bib85.1.1" class="ltx_text" style="font-size:90%;">
Peng Tang, Xinggang Wang, Song Bai, Wei Shen, Xiang Bai, Wenyu Liu, and Alan Yuille.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib85.2.1" class="ltx_text" style="font-size:90%;">Pcl: Proposal cluster learning for weakly supervised object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib85.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE-TPAMI</span><span id="bib.bib85.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib86" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[86]</span>
<span class="ltx_bibblock"><span id="bib.bib86.1.1" class="ltx_text" style="font-size:90%;">
Peng Tang, Xinggang Wang, Xiang Bai, and Wenyu Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib86.2.1" class="ltx_text" style="font-size:90%;">Multiple instance detection network with online instance classifier refinement.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib86.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib86.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib86.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib87" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[87]</span>
<span class="ltx_bibblock"><span id="bib.bib87.1.1" class="ltx_text" style="font-size:90%;">
Peng Tang, Xinggang Wang, Angtian Wang, Yongluan Yan, Wenyu Liu, Junzhou Huang, and Alan Yuille.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib87.2.1" class="ltx_text" style="font-size:90%;">Weakly supervised region proposal network and object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib87.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib87.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib87.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib88" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[88]</span>
<span class="ltx_bibblock"><span id="bib.bib88.1.1" class="ltx_text" style="font-size:90%;">
Aditay Tripathi, Rajath R. Dani, Anand Mishra, and Anirban Chakraborty.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib88.2.1" class="ltx_text" style="font-size:90%;">Sketch-guided object localization in natural images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib88.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib88.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib88.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib89" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[89]</span>
<span class="ltx_bibblock"><span id="bib.bib89.1.1" class="ltx_text" style="font-size:90%;">
Jasper RR Uijlings, Koen EA Van De Sande, Theo Gevers, and Arnold WM Smeulders.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib89.2.1" class="ltx_text" style="font-size:90%;">Selective search for object recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib89.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IJCV</span><span id="bib.bib89.4.2" class="ltx_text" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li id="bib.bib90" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[90]</span>
<span class="ltx_bibblock"><span id="bib.bib90.1.1" class="ltx_text" style="font-size:90%;">
Yael Vinker, Ehsan Pajouheshgar, Jessica Y. Bo, Roman Christian Bachmann, Amit Haim Bermano, Daniel Cohen-Or, Amir Zamir, and Ariel Shamir.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib90.2.1" class="ltx_text" style="font-size:90%;">Clipasso: Semantically-aware object sketching.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib90.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM TOG</span><span id="bib.bib90.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib91" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[91]</span>
<span class="ltx_bibblock"><span id="bib.bib91.1.1" class="ltx_text" style="font-size:90%;">
Kai Wang, Yifan Wang, Xing Xu, Xin Liu, Weihua Ou, and Huimin Lu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib91.2.1" class="ltx_text" style="font-size:90%;">Prototype-based selective knowledge distillation for zero-shot sketch based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib91.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib91.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM MM</span><span id="bib.bib91.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib92" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[92]</span>
<span class="ltx_bibblock"><span id="bib.bib92.1.1" class="ltx_text" style="font-size:90%;">
Xi Wang, Kathleen Ang, and Faramarz Samavati.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib92.2.1" class="ltx_text" style="font-size:90%;">Sketch-based editing and deformation of cardiac image segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib92.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">PRISM</span><span id="bib.bib92.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib93" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[93]</span>
<span class="ltx_bibblock"><span id="bib.bib93.1.1" class="ltx_text" style="font-size:90%;">
Yuxin Wu, Alexander Kirillov, Francisco Massa, Wan-Yen Lo, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib93.2.1" class="ltx_text" style="font-size:90%;">Detectron2.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib93.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">https://github.com/facebookresearch/detectron2</span><span id="bib.bib93.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib94" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[94]</span>
<span class="ltx_bibblock"><span id="bib.bib94.1.1" class="ltx_text" style="font-size:90%;">
Minshan Xie, Menghan Xia, and Tien-Tsin Wong.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib94.2.1" class="ltx_text" style="font-size:90%;">Exploiting aliasing for manga restoration.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib94.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib94.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib94.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib95" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[95]</span>
<span class="ltx_bibblock"><span id="bib.bib95.1.1" class="ltx_text" style="font-size:90%;">
Jun Xing, Li-Yi Wei, Takaaki Shiratori, and Koji Yatani.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib95.2.1" class="ltx_text" style="font-size:90%;">Autocomplete hand-drawn animations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib95.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM TOG</span><span id="bib.bib95.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib96" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[96]</span>
<span class="ltx_bibblock"><span id="bib.bib96.1.1" class="ltx_text" style="font-size:90%;">
Peng Xu, Yongye Huang, Tongtong Yuan, Kaiyue Pang, Yi-Zhe Song, Tao Xiang, Timothy M. Hospedales, Zhanyu Ma, and Jun Guo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib96.2.1" class="ltx_text" style="font-size:90%;">Sketchmate: Deep hashing for million-scale human sketch retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib96.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib96.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib96.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib97" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[97]</span>
<span class="ltx_bibblock"><span id="bib.bib97.1.1" class="ltx_text" style="font-size:90%;">
Peng Xu, Xiatian Zhu, and David A. Clifton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib97.2.1" class="ltx_text" style="font-size:90%;">Multimodal learning with transformers: A survey.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib97.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2206.06488</span><span id="bib.bib97.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib98" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[98]</span>
<span class="ltx_bibblock"><span id="bib.bib98.1.1" class="ltx_text" style="font-size:90%;">
Rui Xu, Zongyan Han, Le Hui, Jianjun Qian, and Jin Xie.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib98.2.1" class="ltx_text" style="font-size:90%;">Domain disentangled generative adversarial network for zero-shot sketch-based 3d shape retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib98.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib98.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AAAI</span><span id="bib.bib98.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib99" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[99]</span>
<span class="ltx_bibblock"><span id="bib.bib99.1.1" class="ltx_text" style="font-size:90%;">
Jianwei Yang, Jiasen Lu, Stefan Leel, Dhruv Batra, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib99.2.1" class="ltx_text" style="font-size:90%;">Graph r-cnn for scene graph generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib99.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib99.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib99.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib100" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[100]</span>
<span class="ltx_bibblock"><span id="bib.bib100.1.1" class="ltx_text" style="font-size:90%;">
Shuai Yang, Zhangyang Wang, Jiaying Liu, and Zongming Guo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib100.2.1" class="ltx_text" style="font-size:90%;">Deep plastic surgery: Robust and controllable image editing with human-drawn sketches.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib100.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib100.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib100.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib101" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[101]</span>
<span class="ltx_bibblock"><span id="bib.bib101.1.1" class="ltx_text" style="font-size:90%;">
Sasi Kiran Yelamarthi, Shiva Krishna Reddy, Ashish Mishra, and Anurag Mittal.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib101.2.1" class="ltx_text" style="font-size:90%;">A zero-shot framework for sketch based image retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib101.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib101.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib101.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib102" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[102]</span>
<span class="ltx_bibblock"><span id="bib.bib102.1.1" class="ltx_text" style="font-size:90%;">
Qian Yu, Feng Liu, Yi-Zhe Song, Tao Xiang, Timothy M. Hospedales, and Chen Change Loy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib102.2.1" class="ltx_text" style="font-size:90%;">Sketch me that shoe.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib102.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib102.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib102.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib103" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[103]</span>
<span class="ltx_bibblock"><span id="bib.bib103.1.1" class="ltx_text" style="font-size:90%;">
Sangdoo Yun, Dongyoon Han, Seong Joon Oh, Sanghyuk Chun, Junsuk Choe, and Youngjoon Yoo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib103.2.1" class="ltx_text" style="font-size:90%;">Cutmix: Regularization strategy to train strong classifiers with localizable features.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib103.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib103.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib103.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib104" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[104]</span>
<span class="ltx_bibblock"><span id="bib.bib104.1.1" class="ltx_text" style="font-size:90%;">
Hongyi Zhang, Moustapha Cisse, Yann N. Dauphin, and David Lopez-Paz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib104.2.1" class="ltx_text" style="font-size:90%;">mixup: Beyond empirical risk minimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib104.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib104.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib104.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib105" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[105]</span>
<span class="ltx_bibblock"><span id="bib.bib105.1.1" class="ltx_text" style="font-size:90%;">
Lvmin Zhang, Jinyue Jiang, and Yi Ji.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib105.2.1" class="ltx_text" style="font-size:90%;">Smartshadow: Artistic shadow drawing tool for line drawings.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib105.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib105.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib105.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib106" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[106]</span>
<span class="ltx_bibblock"><span id="bib.bib106.1.1" class="ltx_text" style="font-size:90%;">
Xiaopeng Zhang, Jiashi Feng, Hongkai Xiong, and Qi Tian.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib106.2.1" class="ltx_text" style="font-size:90%;">Zigzag learning for weakly supervised object detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib106.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib106.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib106.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib107" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[107]</span>
<span class="ltx_bibblock"><span id="bib.bib107.1.1" class="ltx_text" style="font-size:90%;">
Xialin Zhang, Yunchao Wei, Jiashi Feng, Yi Yang, and Thomas Huang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib107.2.1" class="ltx_text" style="font-size:90%;">Adversarial complementary learning for weakly supervised object localization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib107.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib107.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib107.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib108" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[108]</span>
<span class="ltx_bibblock"><span id="bib.bib108.1.1" class="ltx_text" style="font-size:90%;">
Bolei Zhou, Aditya Khosla, Agata Lapedriza, Aude Oliva, and Antonio Torralba.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib108.2.1" class="ltx_text" style="font-size:90%;">Learning deep features for discriminative localization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib108.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib108.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib108.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib109" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[109]</span>
<span class="ltx_bibblock"><span id="bib.bib109.1.1" class="ltx_text" style="font-size:90%;">
Kaiyang Zhou, Jingkang Yang, Chen Change Loy, and Ziwei Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib109.2.1" class="ltx_text" style="font-size:90%;">Conditional prompt learning for vision-language models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib109.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib109.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib109.5.3" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib110" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[110]</span>
<span class="ltx_bibblock"><span id="bib.bib110.1.1" class="ltx_text" style="font-size:90%;">
Xingyi Zhou, Dequan Wang, and Philipp Krähenbühl.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib110.2.1" class="ltx_text" style="font-size:90%;">Object as points.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib110.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1904.07850</span><span id="bib.bib110.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib111" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[111]</span>
<span class="ltx_bibblock"><span id="bib.bib111.1.1" class="ltx_text" style="font-size:90%;">
Xingyi Zhou, Jiacheng Zhuo, and Philipp Krahenbuhl.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib111.2.1" class="ltx_text" style="font-size:90%;">Bottom-up object detection by grouping extreme and center points.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib111.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib111.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib111.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib112" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[112]</span>
<span class="ltx_bibblock"><span id="bib.bib112.1.1" class="ltx_text" style="font-size:90%;">
Yaohui Zhu and Shuqiang Jiang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib112.2.1" class="ltx_text" style="font-size:90%;">Deep structured learning for visual relationship detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib112.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib112.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AAAI</span><span id="bib.bib112.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib113" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[113]</span>
<span class="ltx_bibblock"><span id="bib.bib113.1.1" class="ltx_text" style="font-size:90%;">
C. Lawrence Zitnick and Piotr Dollár.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib113.2.1" class="ltx_text" style="font-size:90%;">Edge boxes: Locating object proposals from edges.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib113.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib113.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib113.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.15147" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.15149" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.15149">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.15149" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.15150" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 18:34:22 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
