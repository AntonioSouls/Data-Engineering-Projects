<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2309.16870] LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection</title><meta property="og:description" content="We propose a late-to-early recurrent feature fusion scheme for 3D object detection using temporal LiDAR point clouds.
Our main motivation is fusing object-aware latent embeddings into the early stages of a 3D object de…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2309.16870">

<!--Generated on Wed Feb 28 03:50:49 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tong He<sup id="id4.3.id1" class="ltx_sup"><span id="id4.3.id1.1" class="ltx_text ltx_font_italic">∗</span></sup>, Pei Sun, Zhaoqi Leng, Chenxi Liu, Dragomir Anguelov, Mingxing Tan<sup id="id5.4.id2" class="ltx_sup"><span id="id5.4.id2.1" class="ltx_text ltx_font_italic">∗</span></sup>
</span><span class="ltx_author_notes">*Waymo LLC. <span id="id6.5.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{simpleig,tanmingxing}@waymo.com</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.1" class="ltx_p">We propose a late-to-early recurrent feature fusion scheme for 3D object detection using temporal LiDAR point clouds.
Our main motivation is fusing object-aware latent embeddings into the early stages of a 3D object detector. This feature fusion strategy enables the model to better capture the shapes and poses for challenging objects, compared with learning from raw points directly.
Our method conducts late-to-early feature fusion in a recurrent manner. This is achieved by enforcing window-based attention blocks upon temporally calibrated and aligned sparse pillar tokens.
Leveraging bird’s eye view foreground pillar segmentation, we reduce the number of sparse history features that our model needs to fuse into its current frame by 10<math id="id3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="id3.1.m1.1a"><mo id="id3.1.m1.1.1" xref="id3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="id3.1.m1.1b"><times id="id3.1.m1.1.1.cmml" xref="id3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="id3.1.m1.1c">\times</annotation></semantics></math>.
We also propose a stochastic-length FrameDrop training technique, which generalizes the model to variable frame lengths at inference for improved performance without retraining.
We evaluate our method on the widely adopted Waymo Open Dataset and demonstrate improvement on 3D object detection against the baseline model, especially for the challenging category of large objects.
</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The goal of LiDAR temporal fusion is aggregating learned history information to improve point clouds based tasks. The history information could be of various implicit (<span id="S1.p1.1.1" class="ltx_text ltx_font_italic">e</span>.<span id="S1.p1.1.2" class="ltx_text ltx_font_italic">g</span>. latent embeddings), explicit (<span id="S1.p1.1.3" class="ltx_text ltx_font_italic">e</span>.<span id="S1.p1.1.4" class="ltx_text ltx_font_italic">g</span>. point clouds, 3D box tracklets) representations or a mixture of both, depending on the models and tasks at hand.
Temporal fusion is critical for multiple driving related tasks, such as 3D object detection, tracking, segmentation, and behavior prediction. Here we mainly study LiDAR-based fusion methods for 3D object detection, which is a crucial task for recognizing and localizing surrounding objects in modern autonomous driving systems.
Point clouds of a single frame can only serve as partial observation of the scenes, lacking complete coverage of environment context and agent dynamics. This information bottleneck is caused by several factors such as object self-occlusion, occlusion by other objects, sensor field-of-view limitation, and data noises. Moreover, for moving objects, models with only single-frame data will struggle to understand their short-term states (velocities, accelerations) and long-term intentions (future trajectories). Tackling these issues demands effective ways of LiDAR temporal fusion, which can enable the model to understand scene / object attributes and dynamics from a wide time horizon.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S1.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.16870/assets/x1.png" id="S1.F1.sf1.g1" class="ltx_graphics ltx_img_landscape" width="460" height="221" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.sf1.4.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S1.F1.sf1.5.2" class="ltx_text" style="font-size:90%;">Overview structures of three temporal fusion approaches, where <span id="S1.F1.sf1.5.2.1" class="ltx_text ltx_font_typewriter">B</span> denotes the backbone, <span id="S1.F1.sf1.5.2.2" class="ltx_text ltx_font_typewriter">H</span> denotes the detection head.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S1.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.16870/assets/x2.png" id="S1.F1.sf2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="226" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S1.F1.sf2.3.2" class="ltx_text" style="font-size:90%;">Performance comparisons on Waymo Open Dataset.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.5.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.6.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Comparisons of temporal fusion approaches<span id="S1.F1.6.2.1" class="ltx_text ltx_font_medium">. Our late-to-early fusion approach achieves better detection quality (<span id="S1.F1.6.2.1.1" class="ltx_text ltx_font_italic">e</span>.<span id="S1.F1.6.2.1.2" class="ltx_text ltx_font_italic">g</span>. 54.4 3D AP for the challenging large objects) than previous early-to-early and late-to-late methods.</span></span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">The main challenge of temporal fusion is how to represent and aggregate the long-sequence information of history frames.
See <a href="#S1.F1.sf1" title="1(a) ‣ Figure 1 ‣ I Introduction ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">1(a)</span></a> for a high-level illustration and comparison.
Generally speaking, previous solutions can be classified into two types.
One of the most widely used methods is early-to-early fusion based point cloud stacking. Multi-frame LiDAR points are directly stacked together as model inputs, resulting in better performance than a single frame of LiDAR points. However, the performance quickly saturates when more frames are simply stacked together <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> without careful modeling of the inter-frame relationships. Moreover, each frame needs to be repeatedly processed when they are stacked into different adjacent frames, greatly increasing computation cost. Fitting long sequences will also greatly increase memory cost, reduce model efficiency or even result in out of memory (OOM) issues. Ideally, a model should leverage what it has already learned from the data, not simply stacking its raw sensory inputs.
To overcome this issue, another type of fusion methods turn to late-to-late fusion so as to utilize the learned history embeddings. A representative method is ConvLSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> which recurrently fuses latent embeddings between consecutive frames at deep layers of the model. This approach reduces memory usage and computation cost, but its results are usually inferior to early-to-early fusion, as shown in <a href="#S1.F1.sf2" title="1(b) ‣ Figure 1 ‣ I Introduction ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>. We suspect that this is because the backbone only has access to single-frame data before late fusion happens. The task of understanding temporally fused deep features falls upon the detection heads, which usually consist of low-capacity multi-layer perceptron (MLP) layers. Consequently, most state-of-the-art LiDAR 3D object detectors (<span id="S1.p2.1.1" class="ltx_text ltx_font_italic">e</span>.<span id="S1.p2.1.2" class="ltx_text ltx_font_italic">g</span>. PVRCNN++ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, SST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">etc</span>.) still rely on early-to-early fusion with point cloud stacking.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we propose a new fusion method named <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">LEF</span>: <span id="S1.p3.1.2" class="ltx_text ltx_font_bold">L</span>ate-to-<span id="S1.p3.1.3" class="ltx_text ltx_font_bold">E</span>arly temporal <span id="S1.p3.1.4" class="ltx_text ltx_font_bold">F</span>usion.
We argue that this fusion scheme can leverage learned history knowledge, and in the meantime
its backbone does not suffer from single-frame data deficiency issues.
Long history LIDAR fusion is a fundamental block for autonomous driving, and our work opens a promising direction to achieving that goal.
There are three main contributions in our paper:
</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a recurrent architecture that fuses late-stage sparse pillar features into early stages of the next frame. To align the underlying static objects, we propose an inverse calibration and alignment module to fuse history and current sparse sets of pillar features. As for moving objects, we leverage window-based attention layers, which can associate relevant features within the windows and thus connect pillar tokens that belong to the same object.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">While point stacking struggles to cache and preprocess huge point clouds as history length grows, we leverage a bird’s eye view (BEV) foreground pillar segmentation module to achieve long-sequence fusion at a low constant cost. The number of sparse voxels that our model needs to fuse at each recurrent step can be reduced by over 10<math id="S1.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.I1.i2.p1.1.m1.1a"><mo id="S1.I1.i2.p1.1.m1.1.1" xref="S1.I1.i2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.1.m1.1b"><times id="S1.I1.i2.p1.1.m1.1.1.cmml" xref="S1.I1.i2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.1.m1.1c">\times</annotation></semantics></math> via the foreground segmentation process.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We also propose a stochastic-length FrameDrop training recipe. It exposes the model to an augmented large motion space of pillar trajectories across time. Thus our recurrent model can capture different speed objects, and generalize to variable frame lengths during inference for improved performance.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The proposed late-to-early temporal fusion scheme leads to improved 3D detection results on the widely used Waymo Open Dataset (WOD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and demonstrates large gains on challenging large objects. We also conduct extensive ablation studies on various design choices made in our method, providing several interesting insights.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">3D Object Detection</span>.
LiDAR-based 3D object detection plays an essential role in autonomous driving. Early efforts of research such as PointRCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> usually operate on raw 3D point clouds through PointNet(++) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. But they struggle to generalize to large-scale data, such as long-sequence fused LiDAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> with millions of points. Heavily relying on MLP-based backbones, these detectors are soon outperformed by models with more advanced architectures like submanifold sparse convolution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> or Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.
By voxelizing free-shape point sets into regular 2D<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>2D-shape voxels are often referred to as pillars.</span></span></span> or 3D-shape voxels, LiDAR-based detectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> can leverage numerous advancements on image 2D object detection, and start to demonstrate promising 3D detection results. Particularly, CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> utilizes sparse convolution layers and CenterNet-based detection heads <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> to predict 3D boxes. Some recent works, such as SST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> and SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, exploit Swin-Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> and push the detection performance to a new state of the art.
Meanwhile, several methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> look into alternative LiDAR representations and strive towards a balance between detection efficiency and efficacy.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">LiDAR Temporal Fusion</span>.
Compared with the rapid progresses achieved on 3D detection backbones, approaches of LiDAR temporal fusion are less well-studied. Point clouds of a single frame in WOD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> have already caused huge computation burden (<span id="S2.p2.1.2" class="ltx_text ltx_font_italic">i</span>.<span id="S2.p2.1.3" class="ltx_text ltx_font_italic">e</span>., <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S2.p2.1.m1.1a"><mo id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><csymbol cd="latexml" id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\sim</annotation></semantics></math>200<span id="S2.p2.1.4" class="ltx_text ltx_font_italic">k</span> points), let alone long history sequences. As briefly discussed in the introduction section, LiDAR temporal fusion solutions can be generally classified into three types:
early-to-early, late-to-late and late-to-early fusion. Early-to-early fusion is also referred to as point cloud stacking. It is most widely adopted in recent LiDAR object detectors (<span id="S2.p2.1.5" class="ltx_text ltx_font_italic">e</span>.<span id="S2.p2.1.6" class="ltx_text ltx_font_italic">g</span>. CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, RSN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, <span id="S2.p2.1.7" class="ltx_text ltx_font_italic">etc</span>.) due to its simple setup. Multi-frame point sets are merged together. Timestamp offsets w.r.t. to the current frame are appended to sensory signals of each 3D point to serve as markers indicating different frame sources. However, point stacking struggles to work on long sequences due to the cost of fusing, saving and jointly preprocessing millions of points. It is also possible to use a Transformer to early fuse point clouds from different frames <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. While early-to-early fusion simply stacks raw sensory inputs without carefully modeling inter-frame relationships and ignores knowledge learned from prior frames, late-to-late fusion tries to tackle these issues by ConvLSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. It recurrently fuses sparse latent embeddings between deep layers of the backbone with improved efficiency than point stacking, but the results are often not as competitive as early-to-early fusion. This is presumably because its backbone can only utilize single-frame data until fusion happens at deep layers. 3D-MAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> may also be viewed as a form of late-to-late fusion, because the temporal fusion in this method is done through various kinds of cross-attention between box proposals and features in the memory bank, which are both after the backbone of its network. FaF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> studied both early fusion and late fusion. To the best of our knowledge, late-to-early fusion has not been explored before in LiDAR detectors. A similar fusion framework is studied in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> but targeting on camera-based detection. It faces very different challenges from our problems. We need to process sparsely distributed 3D data at wide ranges, which requires dedicated designs for sparse features alignment, fusion and also new training recipes.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Finally, we note that our review so far concentrates on a single-stage trainable model that internalizes the temporal fusion schemes. It is also possible to follow up the box predictions with a second-stage offline refinement, using the terminology from a recent exemplar of this two-stage approach, MPPNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. MPPNet runs a pre-trained CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> on 4-frame stacked LiDAR point clouds to generate anchor boxes, which will then be tracked and aggregated across long sequences. Specifically, latent embeddings or raw points within the box regions of one frame will be cropped and intertwined with those extracted from other frames in order to refine the box states. The key differentiating factor about the two-stage approach is that the two stages / models are trained separately <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, suggesting that the improvement inherently built into the first stage, like ours, is complementary to the second-stage innovation.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Method</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Problem Statement</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.15" class="ltx_p">We use <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\{P_{i}\}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.2.cmml">P</mi><mi id="S3.SS1.p1.1.m1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><set id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1"><apply id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.2">𝑃</ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\{P_{i}\}</annotation></semantics></math>, <math id="S3.SS1.p1.2.m2.3" class="ltx_Math" alttext="i=1,...,T" display="inline"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.4" xref="S3.SS1.p1.2.m2.3.4.cmml"><mi id="S3.SS1.p1.2.m2.3.4.2" xref="S3.SS1.p1.2.m2.3.4.2.cmml">i</mi><mo id="S3.SS1.p1.2.m2.3.4.1" xref="S3.SS1.p1.2.m2.3.4.1.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.3.4.3.2" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml"><mn id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">1</mn><mo id="S3.SS1.p1.2.m2.3.4.3.2.1" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS1.p1.2.m2.3.4.3.2.2" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p1.2.m2.3.3" xref="S3.SS1.p1.2.m2.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><apply id="S3.SS1.p1.2.m2.3.4.cmml" xref="S3.SS1.p1.2.m2.3.4"><eq id="S3.SS1.p1.2.m2.3.4.1.cmml" xref="S3.SS1.p1.2.m2.3.4.1"></eq><ci id="S3.SS1.p1.2.m2.3.4.2.cmml" xref="S3.SS1.p1.2.m2.3.4.2">𝑖</ci><list id="S3.SS1.p1.2.m2.3.4.3.1.cmml" xref="S3.SS1.p1.2.m2.3.4.3.2"><cn type="integer" id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">1</cn><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">…</ci><ci id="S3.SS1.p1.2.m2.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">i=1,...,T</annotation></semantics></math> to represent a consecutive sequence of LiDAR point clouds with <math id="S3.SS1.p1.3.m3.3" class="ltx_Math" alttext="P_{i}:\{X_{i,j}\in{\mathbb{R}}^{3}\}" display="inline"><semantics id="S3.SS1.p1.3.m3.3a"><mrow id="S3.SS1.p1.3.m3.3.3" xref="S3.SS1.p1.3.m3.3.3.cmml"><msub id="S3.SS1.p1.3.m3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.3.cmml"><mi id="S3.SS1.p1.3.m3.3.3.3.2" xref="S3.SS1.p1.3.m3.3.3.3.2.cmml">P</mi><mi id="S3.SS1.p1.3.m3.3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.3.3.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p1.3.m3.3.3.2" xref="S3.SS1.p1.3.m3.3.3.2.cmml">:</mo><mrow id="S3.SS1.p1.3.m3.3.3.1.1" xref="S3.SS1.p1.3.m3.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.3.3.1.1.2" xref="S3.SS1.p1.3.m3.3.3.1.2.cmml">{</mo><mrow id="S3.SS1.p1.3.m3.3.3.1.1.1" xref="S3.SS1.p1.3.m3.3.3.1.1.1.cmml"><msub id="S3.SS1.p1.3.m3.3.3.1.1.1.2" xref="S3.SS1.p1.3.m3.3.3.1.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.3.3.1.1.1.2.2" xref="S3.SS1.p1.3.m3.3.3.1.1.1.2.2.cmml">X</mi><mrow id="S3.SS1.p1.3.m3.2.2.2.4" xref="S3.SS1.p1.3.m3.2.2.2.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.3.m3.2.2.2.4.1" xref="S3.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.3.m3.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS1.p1.3.m3.3.3.1.1.1.1" xref="S3.SS1.p1.3.m3.3.3.1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.3.m3.3.3.1.1.1.3" xref="S3.SS1.p1.3.m3.3.3.1.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.3.3.1.1.1.3.2" xref="S3.SS1.p1.3.m3.3.3.1.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS1.p1.3.m3.3.3.1.1.1.3.3" xref="S3.SS1.p1.3.m3.3.3.1.1.1.3.3.cmml">3</mn></msup></mrow><mo stretchy="false" id="S3.SS1.p1.3.m3.3.3.1.1.3" xref="S3.SS1.p1.3.m3.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.3b"><apply id="S3.SS1.p1.3.m3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3"><ci id="S3.SS1.p1.3.m3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2">:</ci><apply id="S3.SS1.p1.3.m3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.3.3.3.2">𝑃</ci><ci id="S3.SS1.p1.3.m3.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.3.3">𝑖</ci></apply><set id="S3.SS1.p1.3.m3.3.3.1.2.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1"><apply id="S3.SS1.p1.3.m3.3.3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1"><in id="S3.SS1.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.1"></in><apply id="S3.SS1.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.1.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.1.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.2.2">𝑋</ci><list id="S3.SS1.p1.3.m3.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.2.4"><ci id="S3.SS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.3.m3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS1.p1.3.m3.3.3.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.1.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.1.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS1.p1.3.m3.3.3.1.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.3.3">3</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.3c">P_{i}:\{X_{i,j}\in{\mathbb{R}}^{3}\}</annotation></semantics></math>, <math id="S3.SS1.p1.4.m4.3" class="ltx_Math" alttext="j=1,...,N_{i}" display="inline"><semantics id="S3.SS1.p1.4.m4.3a"><mrow id="S3.SS1.p1.4.m4.3.3" xref="S3.SS1.p1.4.m4.3.3.cmml"><mi id="S3.SS1.p1.4.m4.3.3.3" xref="S3.SS1.p1.4.m4.3.3.3.cmml">j</mi><mo id="S3.SS1.p1.4.m4.3.3.2" xref="S3.SS1.p1.4.m4.3.3.2.cmml">=</mo><mrow id="S3.SS1.p1.4.m4.3.3.1.1" xref="S3.SS1.p1.4.m4.3.3.1.2.cmml"><mn id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">1</mn><mo id="S3.SS1.p1.4.m4.3.3.1.1.2" xref="S3.SS1.p1.4.m4.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.4.m4.2.2" xref="S3.SS1.p1.4.m4.2.2.cmml">…</mi><mo id="S3.SS1.p1.4.m4.3.3.1.1.3" xref="S3.SS1.p1.4.m4.3.3.1.2.cmml">,</mo><msub id="S3.SS1.p1.4.m4.3.3.1.1.1" xref="S3.SS1.p1.4.m4.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.3.3.1.1.1.2" xref="S3.SS1.p1.4.m4.3.3.1.1.1.2.cmml">N</mi><mi id="S3.SS1.p1.4.m4.3.3.1.1.1.3" xref="S3.SS1.p1.4.m4.3.3.1.1.1.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b"><apply id="S3.SS1.p1.4.m4.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3"><eq id="S3.SS1.p1.4.m4.3.3.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2"></eq><ci id="S3.SS1.p1.4.m4.3.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3.3">𝑗</ci><list id="S3.SS1.p1.4.m4.3.3.1.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1"><cn type="integer" id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">1</cn><ci id="S3.SS1.p1.4.m4.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2">…</ci><apply id="S3.SS1.p1.4.m4.3.3.1.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.1.2">𝑁</ci><ci id="S3.SS1.p1.4.m4.3.3.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">j=1,...,N_{i}</annotation></semantics></math>. Our goal is to detect 3D object boxes <math id="S3.SS1.p1.5.m5.3" class="ltx_Math" alttext="\{B_{i,m}\}" display="inline"><semantics id="S3.SS1.p1.5.m5.3a"><mrow id="S3.SS1.p1.5.m5.3.3.1" xref="S3.SS1.p1.5.m5.3.3.2.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.3.3.1.2" xref="S3.SS1.p1.5.m5.3.3.2.cmml">{</mo><msub id="S3.SS1.p1.5.m5.3.3.1.1" xref="S3.SS1.p1.5.m5.3.3.1.1.cmml"><mi id="S3.SS1.p1.5.m5.3.3.1.1.2" xref="S3.SS1.p1.5.m5.3.3.1.1.2.cmml">B</mi><mrow id="S3.SS1.p1.5.m5.2.2.2.4" xref="S3.SS1.p1.5.m5.2.2.2.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.5.m5.2.2.2.4.1" xref="S3.SS1.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.5.m5.2.2.2.2" xref="S3.SS1.p1.5.m5.2.2.2.2.cmml">m</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p1.5.m5.3.3.1.3" xref="S3.SS1.p1.5.m5.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.3b"><set id="S3.SS1.p1.5.m5.3.3.2.cmml" xref="S3.SS1.p1.5.m5.3.3.1"><apply id="S3.SS1.p1.5.m5.3.3.1.1.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.3.3.1.1.2.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.2">𝐵</ci><list id="S3.SS1.p1.5.m5.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.2.2.2.4"><ci id="S3.SS1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.5.m5.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2">𝑚</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.3c">\{B_{i,m}\}</annotation></semantics></math>, <math id="S3.SS1.p1.6.m6.3" class="ltx_Math" alttext="m=1,...,M_{i}" display="inline"><semantics id="S3.SS1.p1.6.m6.3a"><mrow id="S3.SS1.p1.6.m6.3.3" xref="S3.SS1.p1.6.m6.3.3.cmml"><mi id="S3.SS1.p1.6.m6.3.3.3" xref="S3.SS1.p1.6.m6.3.3.3.cmml">m</mi><mo id="S3.SS1.p1.6.m6.3.3.2" xref="S3.SS1.p1.6.m6.3.3.2.cmml">=</mo><mrow id="S3.SS1.p1.6.m6.3.3.1.1" xref="S3.SS1.p1.6.m6.3.3.1.2.cmml"><mn id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">1</mn><mo id="S3.SS1.p1.6.m6.3.3.1.1.2" xref="S3.SS1.p1.6.m6.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.6.m6.2.2" xref="S3.SS1.p1.6.m6.2.2.cmml">…</mi><mo id="S3.SS1.p1.6.m6.3.3.1.1.3" xref="S3.SS1.p1.6.m6.3.3.1.2.cmml">,</mo><msub id="S3.SS1.p1.6.m6.3.3.1.1.1" xref="S3.SS1.p1.6.m6.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.6.m6.3.3.1.1.1.2" xref="S3.SS1.p1.6.m6.3.3.1.1.1.2.cmml">M</mi><mi id="S3.SS1.p1.6.m6.3.3.1.1.1.3" xref="S3.SS1.p1.6.m6.3.3.1.1.1.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.3b"><apply id="S3.SS1.p1.6.m6.3.3.cmml" xref="S3.SS1.p1.6.m6.3.3"><eq id="S3.SS1.p1.6.m6.3.3.2.cmml" xref="S3.SS1.p1.6.m6.3.3.2"></eq><ci id="S3.SS1.p1.6.m6.3.3.3.cmml" xref="S3.SS1.p1.6.m6.3.3.3">𝑚</ci><list id="S3.SS1.p1.6.m6.3.3.1.2.cmml" xref="S3.SS1.p1.6.m6.3.3.1.1"><cn type="integer" id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">1</cn><ci id="S3.SS1.p1.6.m6.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2">…</ci><apply id="S3.SS1.p1.6.m6.3.3.1.1.1.cmml" xref="S3.SS1.p1.6.m6.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.3.3.1.1.1.2">𝑀</ci><ci id="S3.SS1.p1.6.m6.3.3.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.3.3.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.3c">m=1,...,M_{i}</annotation></semantics></math> for each frame-<math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">t</annotation></semantics></math> using <math id="S3.SS1.p1.8.m8.2" class="ltx_Math" alttext="\{P_{i}\ |\ i\leqslant t\}" display="inline"><semantics id="S3.SS1.p1.8.m8.2a"><mrow id="S3.SS1.p1.8.m8.2.2.2" xref="S3.SS1.p1.8.m8.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m8.2.2.2.3" xref="S3.SS1.p1.8.m8.2.2.3.1.cmml">{</mo><msub id="S3.SS1.p1.8.m8.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1.2" xref="S3.SS1.p1.8.m8.1.1.1.1.2.cmml">P</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.3" xref="S3.SS1.p1.8.m8.1.1.1.1.3.cmml">i</mi></msub><mo lspace="0em" rspace="0.500em" id="S3.SS1.p1.8.m8.2.2.2.4" xref="S3.SS1.p1.8.m8.2.2.3.1.cmml">|</mo><mrow id="S3.SS1.p1.8.m8.2.2.2.2" xref="S3.SS1.p1.8.m8.2.2.2.2.cmml"><mi id="S3.SS1.p1.8.m8.2.2.2.2.2" xref="S3.SS1.p1.8.m8.2.2.2.2.2.cmml">i</mi><mo id="S3.SS1.p1.8.m8.2.2.2.2.1" xref="S3.SS1.p1.8.m8.2.2.2.2.1.cmml">⩽</mo><mi id="S3.SS1.p1.8.m8.2.2.2.2.3" xref="S3.SS1.p1.8.m8.2.2.2.2.3.cmml">t</mi></mrow><mo stretchy="false" id="S3.SS1.p1.8.m8.2.2.2.5" xref="S3.SS1.p1.8.m8.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.2b"><apply id="S3.SS1.p1.8.m8.2.2.3.cmml" xref="S3.SS1.p1.8.m8.2.2.2"><csymbol cd="latexml" id="S3.SS1.p1.8.m8.2.2.3.1.cmml" xref="S3.SS1.p1.8.m8.2.2.2.3">conditional-set</csymbol><apply id="S3.SS1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.2">𝑃</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.8.m8.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2"><leq id="S3.SS1.p1.8.m8.2.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2.1"></leq><ci id="S3.SS1.p1.8.m8.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2.2">𝑖</ci><ci id="S3.SS1.p1.8.m8.2.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.2.2.2.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.2c">\{P_{i}\ |\ i\leqslant t\}</annotation></semantics></math>. Ideally the model should be capable of fusing history information <math id="S3.SS1.p1.9.m9.3" class="ltx_Math" alttext="F(P_{1},...,P_{t})" display="inline"><semantics id="S3.SS1.p1.9.m9.3a"><mrow id="S3.SS1.p1.9.m9.3.3" xref="S3.SS1.p1.9.m9.3.3.cmml"><mi id="S3.SS1.p1.9.m9.3.3.4" xref="S3.SS1.p1.9.m9.3.3.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.3.3.3" xref="S3.SS1.p1.9.m9.3.3.3.cmml">​</mo><mrow id="S3.SS1.p1.9.m9.3.3.2.2" xref="S3.SS1.p1.9.m9.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.9.m9.3.3.2.2.3" xref="S3.SS1.p1.9.m9.3.3.2.3.cmml">(</mo><msub id="S3.SS1.p1.9.m9.2.2.1.1.1" xref="S3.SS1.p1.9.m9.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.9.m9.2.2.1.1.1.2" xref="S3.SS1.p1.9.m9.2.2.1.1.1.2.cmml">P</mi><mn id="S3.SS1.p1.9.m9.2.2.1.1.1.3" xref="S3.SS1.p1.9.m9.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.9.m9.3.3.2.2.4" xref="S3.SS1.p1.9.m9.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">…</mi><mo id="S3.SS1.p1.9.m9.3.3.2.2.5" xref="S3.SS1.p1.9.m9.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.9.m9.3.3.2.2.2" xref="S3.SS1.p1.9.m9.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.9.m9.3.3.2.2.2.2" xref="S3.SS1.p1.9.m9.3.3.2.2.2.2.cmml">P</mi><mi id="S3.SS1.p1.9.m9.3.3.2.2.2.3" xref="S3.SS1.p1.9.m9.3.3.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS1.p1.9.m9.3.3.2.2.6" xref="S3.SS1.p1.9.m9.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.3b"><apply id="S3.SS1.p1.9.m9.3.3.cmml" xref="S3.SS1.p1.9.m9.3.3"><times id="S3.SS1.p1.9.m9.3.3.3.cmml" xref="S3.SS1.p1.9.m9.3.3.3"></times><ci id="S3.SS1.p1.9.m9.3.3.4.cmml" xref="S3.SS1.p1.9.m9.3.3.4">𝐹</ci><vector id="S3.SS1.p1.9.m9.3.3.2.3.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2"><apply id="S3.SS1.p1.9.m9.2.2.1.1.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.2">𝑃</ci><cn type="integer" id="S3.SS1.p1.9.m9.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">…</ci><apply id="S3.SS1.p1.9.m9.3.3.2.2.2.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2.2">𝑃</ci><ci id="S3.SS1.p1.9.m9.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2.3">𝑡</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.3c">F(P_{1},...,P_{t})</annotation></semantics></math> up to the current timestamp-<math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">t</annotation></semantics></math>, where <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="F(\cdot)" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mrow id="S3.SS1.p1.11.m11.1.2" xref="S3.SS1.p1.11.m11.1.2.cmml"><mi id="S3.SS1.p1.11.m11.1.2.2" xref="S3.SS1.p1.11.m11.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m11.1.2.1" xref="S3.SS1.p1.11.m11.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.11.m11.1.2.3.2" xref="S3.SS1.p1.11.m11.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m11.1.2.3.2.1" xref="S3.SS1.p1.11.m11.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.11.m11.1.2.3.2.2" xref="S3.SS1.p1.11.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.2.cmml" xref="S3.SS1.p1.11.m11.1.2"><times id="S3.SS1.p1.11.m11.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.2.1"></times><ci id="S3.SS1.p1.11.m11.1.2.2.cmml" xref="S3.SS1.p1.11.m11.1.2.2">𝐹</ci><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">F(\cdot)</annotation></semantics></math> denotes the fusion function.
LiDAR temporal fusion is known to be an open challenge due to the sparse and wide-range spatial distribution of point clouds, let alone diverse object dynamics. Currently early-to-early fusion (<span id="S3.SS1.p1.15.1" class="ltx_text ltx_font_italic">i</span>.<span id="S3.SS1.p1.15.2" class="ltx_text ltx_font_italic">e</span>., point stacking) is most widely used <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="P_{t-l}\cup...\cup P_{t}" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mrow id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><msub id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2.2" xref="S3.SS1.p1.12.m12.1.1.2.2.cmml">P</mi><mrow id="S3.SS1.p1.12.m12.1.1.2.3" xref="S3.SS1.p1.12.m12.1.1.2.3.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2.3.2" xref="S3.SS1.p1.12.m12.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p1.12.m12.1.1.2.3.1" xref="S3.SS1.p1.12.m12.1.1.2.3.1.cmml">−</mo><mi id="S3.SS1.p1.12.m12.1.1.2.3.3" xref="S3.SS1.p1.12.m12.1.1.2.3.3.cmml">l</mi></mrow></msub><mo id="S3.SS1.p1.12.m12.1.1.1" xref="S3.SS1.p1.12.m12.1.1.1.cmml">∪</mo><mi mathvariant="normal" id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">…</mi><mo id="S3.SS1.p1.12.m12.1.1.1a" xref="S3.SS1.p1.12.m12.1.1.1.cmml">∪</mo><msub id="S3.SS1.p1.12.m12.1.1.4" xref="S3.SS1.p1.12.m12.1.1.4.cmml"><mi id="S3.SS1.p1.12.m12.1.1.4.2" xref="S3.SS1.p1.12.m12.1.1.4.2.cmml">P</mi><mi id="S3.SS1.p1.12.m12.1.1.4.3" xref="S3.SS1.p1.12.m12.1.1.4.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><union id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1.1"></union><apply id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2.2">𝑃</ci><apply id="S3.SS1.p1.12.m12.1.1.2.3.cmml" xref="S3.SS1.p1.12.m12.1.1.2.3"><minus id="S3.SS1.p1.12.m12.1.1.2.3.1.cmml" xref="S3.SS1.p1.12.m12.1.1.2.3.1"></minus><ci id="S3.SS1.p1.12.m12.1.1.2.3.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2.3.2">𝑡</ci><ci id="S3.SS1.p1.12.m12.1.1.2.3.3.cmml" xref="S3.SS1.p1.12.m12.1.1.2.3.3">𝑙</ci></apply></apply><ci id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3">…</ci><apply id="S3.SS1.p1.12.m12.1.1.4.cmml" xref="S3.SS1.p1.12.m12.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.4.1.cmml" xref="S3.SS1.p1.12.m12.1.1.4">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.4.2.cmml" xref="S3.SS1.p1.12.m12.1.1.4.2">𝑃</ci><ci id="S3.SS1.p1.12.m12.1.1.4.3.cmml" xref="S3.SS1.p1.12.m12.1.1.4.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">P_{t-l}\cup...\cup P_{t}</annotation></semantics></math>, which is easy to implement. However, due to memory constraint the sequence length is usually small, e.g. <math id="S3.SS1.p1.13.m13.2" class="ltx_Math" alttext="l\in\{2,3\}" display="inline"><semantics id="S3.SS1.p1.13.m13.2a"><mrow id="S3.SS1.p1.13.m13.2.3" xref="S3.SS1.p1.13.m13.2.3.cmml"><mi id="S3.SS1.p1.13.m13.2.3.2" xref="S3.SS1.p1.13.m13.2.3.2.cmml">l</mi><mo id="S3.SS1.p1.13.m13.2.3.1" xref="S3.SS1.p1.13.m13.2.3.1.cmml">∈</mo><mrow id="S3.SS1.p1.13.m13.2.3.3.2" xref="S3.SS1.p1.13.m13.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.13.m13.2.3.3.2.1" xref="S3.SS1.p1.13.m13.2.3.3.1.cmml">{</mo><mn id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml">2</mn><mo id="S3.SS1.p1.13.m13.2.3.3.2.2" xref="S3.SS1.p1.13.m13.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p1.13.m13.2.2" xref="S3.SS1.p1.13.m13.2.2.cmml">3</mn><mo stretchy="false" id="S3.SS1.p1.13.m13.2.3.3.2.3" xref="S3.SS1.p1.13.m13.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.2b"><apply id="S3.SS1.p1.13.m13.2.3.cmml" xref="S3.SS1.p1.13.m13.2.3"><in id="S3.SS1.p1.13.m13.2.3.1.cmml" xref="S3.SS1.p1.13.m13.2.3.1"></in><ci id="S3.SS1.p1.13.m13.2.3.2.cmml" xref="S3.SS1.p1.13.m13.2.3.2">𝑙</ci><set id="S3.SS1.p1.13.m13.2.3.3.1.cmml" xref="S3.SS1.p1.13.m13.2.3.3.2"><cn type="integer" id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">2</cn><cn type="integer" id="S3.SS1.p1.13.m13.2.2.cmml" xref="S3.SS1.p1.13.m13.2.2">3</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.2c">l\in\{2,3\}</annotation></semantics></math>. Moreover, point clouds <math id="S3.SS1.p1.14.m14.3" class="ltx_Math" alttext="\{X_{i,j}\}" display="inline"><semantics id="S3.SS1.p1.14.m14.3a"><mrow id="S3.SS1.p1.14.m14.3.3.1" xref="S3.SS1.p1.14.m14.3.3.2.cmml"><mo stretchy="false" id="S3.SS1.p1.14.m14.3.3.1.2" xref="S3.SS1.p1.14.m14.3.3.2.cmml">{</mo><msub id="S3.SS1.p1.14.m14.3.3.1.1" xref="S3.SS1.p1.14.m14.3.3.1.1.cmml"><mi id="S3.SS1.p1.14.m14.3.3.1.1.2" xref="S3.SS1.p1.14.m14.3.3.1.1.2.cmml">X</mi><mrow id="S3.SS1.p1.14.m14.2.2.2.4" xref="S3.SS1.p1.14.m14.2.2.2.3.cmml"><mi id="S3.SS1.p1.14.m14.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.14.m14.2.2.2.4.1" xref="S3.SS1.p1.14.m14.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.14.m14.2.2.2.2" xref="S3.SS1.p1.14.m14.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p1.14.m14.3.3.1.3" xref="S3.SS1.p1.14.m14.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.3b"><set id="S3.SS1.p1.14.m14.3.3.2.cmml" xref="S3.SS1.p1.14.m14.3.3.1"><apply id="S3.SS1.p1.14.m14.3.3.1.1.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.3.3.1.1.1.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.3.3.1.1.2.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.2">𝑋</ci><list id="S3.SS1.p1.14.m14.2.2.2.3.cmml" xref="S3.SS1.p1.14.m14.2.2.2.4"><ci id="S3.SS1.p1.14.m14.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.14.m14.2.2.2.2.cmml" xref="S3.SS1.p1.14.m14.2.2.2.2">𝑗</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.3c">\{X_{i,j}\}</annotation></semantics></math> of one frame have to be repeatedly processed for <math id="S3.SS1.p1.15.m15.1" class="ltx_Math" alttext="(l+1)" display="inline"><semantics id="S3.SS1.p1.15.m15.1a"><mrow id="S3.SS1.p1.15.m15.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.15.m15.1.1.1.2" xref="S3.SS1.p1.15.m15.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.15.m15.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.1.1.2" xref="S3.SS1.p1.15.m15.1.1.1.1.2.cmml">l</mi><mo id="S3.SS1.p1.15.m15.1.1.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p1.15.m15.1.1.1.1.3" xref="S3.SS1.p1.15.m15.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.p1.15.m15.1.1.1.3" xref="S3.SS1.p1.15.m15.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1"><plus id="S3.SS1.p1.15.m15.1.1.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.1"></plus><ci id="S3.SS1.p1.15.m15.1.1.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.2">𝑙</ci><cn type="integer" id="S3.SS1.p1.15.m15.1.1.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">(l+1)</annotation></semantics></math> times when we conduct model inference on adjacent frames, causing huge waste of computation.
As for detection performance, whether directly stacking the raw sensory inputs without reusing learned history knowledge can lead to the optimal results also remains questionable.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2309.16870/assets/x3.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="468" height="278" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.7.2.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Detection pipeline with our proposed LEF<span id="S3.F2.2.1.1" class="ltx_text ltx_font_medium">. In each forward pass, the early-stage pillar encoding will be aligned and fused with the history late-stage foreground pillar features <math id="S3.F2.2.1.1.m1.1" class="ltx_Math" alttext="f_{i-1}" display="inline"><semantics id="S3.F2.2.1.1.m1.1b"><msub id="S3.F2.2.1.1.m1.1.1" xref="S3.F2.2.1.1.m1.1.1.cmml"><mi id="S3.F2.2.1.1.m1.1.1.2" xref="S3.F2.2.1.1.m1.1.1.2.cmml">f</mi><mrow id="S3.F2.2.1.1.m1.1.1.3" xref="S3.F2.2.1.1.m1.1.1.3.cmml"><mi id="S3.F2.2.1.1.m1.1.1.3.2" xref="S3.F2.2.1.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.F2.2.1.1.m1.1.1.3.1" xref="S3.F2.2.1.1.m1.1.1.3.1.cmml">−</mo><mn id="S3.F2.2.1.1.m1.1.1.3.3" xref="S3.F2.2.1.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F2.2.1.1.m1.1c"><apply id="S3.F2.2.1.1.m1.1.1.cmml" xref="S3.F2.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.2.1.1.m1.1.1.1.cmml" xref="S3.F2.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.F2.2.1.1.m1.1.1.2.cmml" xref="S3.F2.2.1.1.m1.1.1.2">𝑓</ci><apply id="S3.F2.2.1.1.m1.1.1.3.cmml" xref="S3.F2.2.1.1.m1.1.1.3"><minus id="S3.F2.2.1.1.m1.1.1.3.1.cmml" xref="S3.F2.2.1.1.m1.1.1.3.1"></minus><ci id="S3.F2.2.1.1.m1.1.1.3.2.cmml" xref="S3.F2.2.1.1.m1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.F2.2.1.1.m1.1.1.3.3.cmml" xref="S3.F2.2.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.2.1.1.m1.1d">f_{i-1}</annotation></semantics></math>. The alignment is achieved by an inverse calibration and alignment process (Section <a href="#S3.SS3" title="III-C Inverse Calibration and Alignment ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span></span></a>) that enables pillar features of the underlying static objects to be matched. To effectively associate moving object features, we further use window-based attention blocks (Section <a href="#S3.SS4" title="III-D Window-based Attention Fusion ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a>) to connect relevant pillars. Outputs from the attention fusion layers will then be fed into the main backbone network (<span id="S3.F2.2.1.1.1" class="ltx_text ltx_font_italic">e</span>.<span id="S3.F2.2.1.1.2" class="ltx_text ltx_font_italic">g</span>. SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>), followed by a foreground pillar segmentation layer and the final detection head <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> for 3D bounding box predictions.</span></span></figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Recurrent Late-to-Early Fusion</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">To address the aforementioned issues, we propose a recurrent late-to-early temporal fusion strategy. As shown in <a href="#S3.F2" title="Figure 2 ‣ III-A Problem Statement ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>, the fusion pipeline works like a “Markov chain”, which can accumulate history information from long sequences and reduce redundant computation. Thus, the fusion function <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="F(\cdot)" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.2" xref="S3.SS2.p1.1.m1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.1.2.2" xref="S3.SS2.p1.1.m1.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.2.1" xref="S3.SS2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.1.m1.1.2.3.2" xref="S3.SS2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.1.2.3.2.1" xref="S3.SS2.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p1.1.m1.1.2.3.2.2" xref="S3.SS2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.2"><times id="S3.SS2.p1.1.m1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.2.1"></times><ci id="S3.SS2.p1.1.m1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.2.2">𝐹</ci><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">F(\cdot)</annotation></semantics></math> can be iteratively defined as:</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E1.m1.30" class="ltx_Math" alttext="\displaystyle\begin{split}f_{i}=\psi(h(f_{i-1}\oplus\tau(t_{i}-t_{i-1}),\nu(\{X_{i,j}\})))\end{split}" display="inline"><semantics id="S3.E1.m1.30a"><mtable id="S3.E1.m1.30.30.2" xref="S3.E1.m1.29.29.1.cmml"><mtr id="S3.E1.m1.30.30.2a" xref="S3.E1.m1.29.29.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.30.30.2b" xref="S3.E1.m1.29.29.1.cmml"><mrow id="S3.E1.m1.30.30.2.29.29.29" xref="S3.E1.m1.29.29.1.cmml"><msub id="S3.E1.m1.30.30.2.29.29.29.30" xref="S3.E1.m1.29.29.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">f</mi><mi id="S3.E1.m1.2.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.2.1.cmml">i</mi></msub><mo id="S3.E1.m1.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29" xref="S3.E1.m1.29.29.1.cmml"><mi id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.4.4.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.30.30.2.29.29.29.29.2" xref="S3.E1.m1.29.29.1.cmml">​</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29.1.1" xref="S3.E1.m1.29.29.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.5.5.5.5" xref="S3.E1.m1.29.29.1.cmml">(</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1" xref="S3.E1.m1.29.29.1.cmml"><mi id="S3.E1.m1.6.6.6.6.6.6" xref="S3.E1.m1.6.6.6.6.6.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.3" xref="S3.E1.m1.29.29.1.cmml">​</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.2.2" xref="S3.E1.m1.29.29.1.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.7.7.7.7" xref="S3.E1.m1.29.29.1.cmml">(</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.1.1.1" xref="S3.E1.m1.29.29.1.cmml"><msub id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.1.1.1.2" xref="S3.E1.m1.29.29.1.cmml"><mi id="S3.E1.m1.8.8.8.8.8.8" xref="S3.E1.m1.8.8.8.8.8.8.cmml">f</mi><mrow id="S3.E1.m1.9.9.9.9.9.9.1" xref="S3.E1.m1.9.9.9.9.9.9.1.cmml"><mi id="S3.E1.m1.9.9.9.9.9.9.1.2" xref="S3.E1.m1.9.9.9.9.9.9.1.2.cmml">i</mi><mo id="S3.E1.m1.9.9.9.9.9.9.1.1" xref="S3.E1.m1.9.9.9.9.9.9.1.1.cmml">−</mo><mn id="S3.E1.m1.9.9.9.9.9.9.1.3" xref="S3.E1.m1.9.9.9.9.9.9.1.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.10.10.10.10.10.10" xref="S3.E1.m1.10.10.10.10.10.10.cmml">⊕</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.1.1.1.1" xref="S3.E1.m1.29.29.1.cmml"><mi id="S3.E1.m1.11.11.11.11.11.11" xref="S3.E1.m1.11.11.11.11.11.11.cmml">τ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.1.1.1.1.2" xref="S3.E1.m1.29.29.1.cmml">​</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.29.29.1.cmml"><mo stretchy="false" id="S3.E1.m1.12.12.12.12.12.12" xref="S3.E1.m1.29.29.1.cmml">(</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.29.29.1.cmml"><msub id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.29.29.1.cmml"><mi id="S3.E1.m1.13.13.13.13.13.13" xref="S3.E1.m1.13.13.13.13.13.13.cmml">t</mi><mi id="S3.E1.m1.14.14.14.14.14.14.1" xref="S3.E1.m1.14.14.14.14.14.14.1.cmml">i</mi></msub><mo id="S3.E1.m1.15.15.15.15.15.15" xref="S3.E1.m1.15.15.15.15.15.15.cmml">−</mo><msub id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.29.29.1.cmml"><mi id="S3.E1.m1.16.16.16.16.16.16" xref="S3.E1.m1.16.16.16.16.16.16.cmml">t</mi><mrow id="S3.E1.m1.17.17.17.17.17.17.1" xref="S3.E1.m1.17.17.17.17.17.17.1.cmml"><mi id="S3.E1.m1.17.17.17.17.17.17.1.2" xref="S3.E1.m1.17.17.17.17.17.17.1.2.cmml">i</mi><mo id="S3.E1.m1.17.17.17.17.17.17.1.1" xref="S3.E1.m1.17.17.17.17.17.17.1.1.cmml">−</mo><mn id="S3.E1.m1.17.17.17.17.17.17.1.3" xref="S3.E1.m1.17.17.17.17.17.17.1.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S3.E1.m1.18.18.18.18.18.18" xref="S3.E1.m1.29.29.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.19.19.19.19.19.19" xref="S3.E1.m1.29.29.1.cmml">,</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.2.2.2" xref="S3.E1.m1.29.29.1.cmml"><mi id="S3.E1.m1.20.20.20.20.20.20" xref="S3.E1.m1.20.20.20.20.20.20.cmml">ν</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.2.2.2.2" xref="S3.E1.m1.29.29.1.cmml">​</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.2.2.2.1.1" xref="S3.E1.m1.29.29.1.cmml"><mo stretchy="false" id="S3.E1.m1.21.21.21.21.21.21" xref="S3.E1.m1.29.29.1.cmml">(</mo><mrow id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.2.2.2.1.1.1" xref="S3.E1.m1.29.29.1.cmml"><mo stretchy="false" id="S3.E1.m1.22.22.22.22.22.22" xref="S3.E1.m1.29.29.1.cmml">{</mo><msub id="S3.E1.m1.30.30.2.29.29.29.29.1.1.1.2.2.2.1.1.1.1.1" xref="S3.E1.m1.29.29.1.cmml"><mi id="S3.E1.m1.23.23.23.23.23.23" xref="S3.E1.m1.23.23.23.23.23.23.cmml">X</mi><mrow id="S3.E1.m1.24.24.24.24.24.24.1.4" xref="S3.E1.m1.24.24.24.24.24.24.1.3.cmml"><mi id="S3.E1.m1.24.24.24.24.24.24.1.1" xref="S3.E1.m1.24.24.24.24.24.24.1.1.cmml">i</mi><mo id="S3.E1.m1.24.24.24.24.24.24.1.4.1" xref="S3.E1.m1.24.24.24.24.24.24.1.3.cmml">,</mo><mi id="S3.E1.m1.24.24.24.24.24.24.1.2" xref="S3.E1.m1.24.24.24.24.24.24.1.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.25.25.25.25.25.25" xref="S3.E1.m1.29.29.1.cmml">}</mo></mrow><mo stretchy="false" id="S3.E1.m1.26.26.26.26.26.26" xref="S3.E1.m1.29.29.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.27.27.27.27.27.27" xref="S3.E1.m1.29.29.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.28.28.28.28.28.28" xref="S3.E1.m1.29.29.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.30b"><apply id="S3.E1.m1.29.29.1.cmml" xref="S3.E1.m1.30.30.2"><eq id="S3.E1.m1.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3"></eq><apply id="S3.E1.m1.29.29.1.3.cmml" xref="S3.E1.m1.30.30.2"><csymbol cd="ambiguous" id="S3.E1.m1.29.29.1.3.1.cmml" xref="S3.E1.m1.30.30.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">𝑓</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1">𝑖</ci></apply><apply id="S3.E1.m1.29.29.1.1.cmml" xref="S3.E1.m1.30.30.2"><times id="S3.E1.m1.29.29.1.1.2.cmml" xref="S3.E1.m1.30.30.2"></times><ci id="S3.E1.m1.4.4.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4.4.4">𝜓</ci><apply id="S3.E1.m1.29.29.1.1.1.1.1.cmml" xref="S3.E1.m1.30.30.2"><times id="S3.E1.m1.29.29.1.1.1.1.1.3.cmml" xref="S3.E1.m1.30.30.2"></times><ci id="S3.E1.m1.6.6.6.6.6.6.cmml" xref="S3.E1.m1.6.6.6.6.6.6">ℎ</ci><interval closure="open" id="S3.E1.m1.29.29.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.30.30.2"><apply id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.30.30.2"><csymbol cd="latexml" id="S3.E1.m1.10.10.10.10.10.10.cmml" xref="S3.E1.m1.10.10.10.10.10.10">direct-sum</csymbol><apply id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.30.30.2"><csymbol cd="ambiguous" id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.30.30.2">subscript</csymbol><ci id="S3.E1.m1.8.8.8.8.8.8.cmml" xref="S3.E1.m1.8.8.8.8.8.8">𝑓</ci><apply id="S3.E1.m1.9.9.9.9.9.9.1.cmml" xref="S3.E1.m1.9.9.9.9.9.9.1"><minus id="S3.E1.m1.9.9.9.9.9.9.1.1.cmml" xref="S3.E1.m1.9.9.9.9.9.9.1.1"></minus><ci id="S3.E1.m1.9.9.9.9.9.9.1.2.cmml" xref="S3.E1.m1.9.9.9.9.9.9.1.2">𝑖</ci><cn type="integer" id="S3.E1.m1.9.9.9.9.9.9.1.3.cmml" xref="S3.E1.m1.9.9.9.9.9.9.1.3">1</cn></apply></apply><apply id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.30.30.2"><times id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.30.30.2"></times><ci id="S3.E1.m1.11.11.11.11.11.11.cmml" xref="S3.E1.m1.11.11.11.11.11.11">𝜏</ci><apply id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.30.30.2"><minus id="S3.E1.m1.15.15.15.15.15.15.cmml" xref="S3.E1.m1.15.15.15.15.15.15"></minus><apply id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.30.30.2"><csymbol cd="ambiguous" id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.30.30.2">subscript</csymbol><ci id="S3.E1.m1.13.13.13.13.13.13.cmml" xref="S3.E1.m1.13.13.13.13.13.13">𝑡</ci><ci id="S3.E1.m1.14.14.14.14.14.14.1.cmml" xref="S3.E1.m1.14.14.14.14.14.14.1">𝑖</ci></apply><apply id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.30.30.2"><csymbol cd="ambiguous" id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.30.30.2">subscript</csymbol><ci id="S3.E1.m1.16.16.16.16.16.16.cmml" xref="S3.E1.m1.16.16.16.16.16.16">𝑡</ci><apply id="S3.E1.m1.17.17.17.17.17.17.1.cmml" xref="S3.E1.m1.17.17.17.17.17.17.1"><minus id="S3.E1.m1.17.17.17.17.17.17.1.1.cmml" xref="S3.E1.m1.17.17.17.17.17.17.1.1"></minus><ci id="S3.E1.m1.17.17.17.17.17.17.1.2.cmml" xref="S3.E1.m1.17.17.17.17.17.17.1.2">𝑖</ci><cn type="integer" id="S3.E1.m1.17.17.17.17.17.17.1.3.cmml" xref="S3.E1.m1.17.17.17.17.17.17.1.3">1</cn></apply></apply></apply></apply></apply><apply id="S3.E1.m1.29.29.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.30.30.2"><times id="S3.E1.m1.29.29.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.30.30.2"></times><ci id="S3.E1.m1.20.20.20.20.20.20.cmml" xref="S3.E1.m1.20.20.20.20.20.20">𝜈</ci><set id="S3.E1.m1.29.29.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.30.30.2"><apply id="S3.E1.m1.29.29.1.1.1.1.1.2.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.30.30.2"><csymbol cd="ambiguous" id="S3.E1.m1.29.29.1.1.1.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.30.30.2">subscript</csymbol><ci id="S3.E1.m1.23.23.23.23.23.23.cmml" xref="S3.E1.m1.23.23.23.23.23.23">𝑋</ci><list id="S3.E1.m1.24.24.24.24.24.24.1.3.cmml" xref="S3.E1.m1.24.24.24.24.24.24.1.4"><ci id="S3.E1.m1.24.24.24.24.24.24.1.1.cmml" xref="S3.E1.m1.24.24.24.24.24.24.1.1">𝑖</ci><ci id="S3.E1.m1.24.24.24.24.24.24.1.2.cmml" xref="S3.E1.m1.24.24.24.24.24.24.1.2">𝑗</ci></list></apply></set></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.30c">\displaystyle\begin{split}f_{i}=\psi(h(f_{i-1}\oplus\tau(t_{i}-t_{i-1}),\nu(\{X_{i,j}\})))\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.5" class="ltx_p">where <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="f_{i-1}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">f</mi><mrow id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p3.1.m1.1.1.3.1" xref="S3.SS2.p3.1.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑓</ci><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><minus id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.1"></minus><ci id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">f_{i-1}</annotation></semantics></math> indicates history deep-layer voxel embeddings, and <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="\tau(\cdot)" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.2" xref="S3.SS2.p3.2.m2.1.2.cmml"><mi id="S3.SS2.p3.2.m2.1.2.2" xref="S3.SS2.p3.2.m2.1.2.2.cmml">τ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.2.m2.1.2.1" xref="S3.SS2.p3.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS2.p3.2.m2.1.2.3.2" xref="S3.SS2.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.2.m2.1.2.3.2.1" xref="S3.SS2.p3.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p3.2.m2.1.2.3.2.2" xref="S3.SS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.2.cmml" xref="S3.SS2.p3.2.m2.1.2"><times id="S3.SS2.p3.2.m2.1.2.1.cmml" xref="S3.SS2.p3.2.m2.1.2.1"></times><ci id="S3.SS2.p3.2.m2.1.2.2.cmml" xref="S3.SS2.p3.2.m2.1.2.2">𝜏</ci><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\tau(\cdot)</annotation></semantics></math> is a Sinusoidal function for encoding the timestamp offset. <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\nu(\cdot)" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mrow id="S3.SS2.p3.3.m3.1.2" xref="S3.SS2.p3.3.m3.1.2.cmml"><mi id="S3.SS2.p3.3.m3.1.2.2" xref="S3.SS2.p3.3.m3.1.2.2.cmml">ν</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.3.m3.1.2.1" xref="S3.SS2.p3.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS2.p3.3.m3.1.2.3.2" xref="S3.SS2.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.3.m3.1.2.3.2.1" xref="S3.SS2.p3.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p3.3.m3.1.2.3.2.2" xref="S3.SS2.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.2.cmml" xref="S3.SS2.p3.3.m3.1.2"><times id="S3.SS2.p3.3.m3.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.2.1"></times><ci id="S3.SS2.p3.3.m3.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.2.2">𝜈</ci><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\nu(\cdot)</annotation></semantics></math> represents VoxelNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> used to obtain pillar features from point clouds. <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="h(\cdot)" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><mrow id="S3.SS2.p3.4.m4.1.2" xref="S3.SS2.p3.4.m4.1.2.cmml"><mi id="S3.SS2.p3.4.m4.1.2.2" xref="S3.SS2.p3.4.m4.1.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.1.2.1" xref="S3.SS2.p3.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS2.p3.4.m4.1.2.3.2" xref="S3.SS2.p3.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.1.2.3.2.1" xref="S3.SS2.p3.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p3.4.m4.1.2.3.2.2" xref="S3.SS2.p3.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.2.cmml" xref="S3.SS2.p3.4.m4.1.2"><times id="S3.SS2.p3.4.m4.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.2.1"></times><ci id="S3.SS2.p3.4.m4.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.2.2">ℎ</ci><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">h(\cdot)</annotation></semantics></math> is the backbone for recurrent fusion and multi-scale sparse pillar features extraction, and <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="\psi(\cdot)" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mrow id="S3.SS2.p3.5.m5.1.2" xref="S3.SS2.p3.5.m5.1.2.cmml"><mi id="S3.SS2.p3.5.m5.1.2.2" xref="S3.SS2.p3.5.m5.1.2.2.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.1.2.1" xref="S3.SS2.p3.5.m5.1.2.1.cmml">​</mo><mrow id="S3.SS2.p3.5.m5.1.2.3.2" xref="S3.SS2.p3.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.5.m5.1.2.3.2.1" xref="S3.SS2.p3.5.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p3.5.m5.1.2.3.2.2" xref="S3.SS2.p3.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.2.cmml" xref="S3.SS2.p3.5.m5.1.2"><times id="S3.SS2.p3.5.m5.1.2.1.cmml" xref="S3.SS2.p3.5.m5.1.2.1"></times><ci id="S3.SS2.p3.5.m5.1.2.2.cmml" xref="S3.SS2.p3.5.m5.1.2.2">𝜓</ci><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\psi(\cdot)</annotation></semantics></math> is the foreground segmentation module.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.10" class="ltx_p"><span id="S3.SS2.p4.10.1" class="ltx_text ltx_font_bold">History features</span>. Particularly, we use the latent features of segmented foreground pillars as <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="f_{i-1}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">f</mi><mrow id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p4.1.m1.1.1.3.1" xref="S3.SS2.p4.1.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p4.1.m1.1.1.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝑓</ci><apply id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><minus id="S3.SS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.1"></minus><ci id="S3.SS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">f_{i-1}</annotation></semantics></math> and pass them into the next timestamp. Without loss of generality, we use SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> as our backbone and center-based detection heads <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> as examples in our following discussion if needed. The diagram is plotted in <a href="#S3.F2" title="Figure 2 ‣ III-A Problem Statement ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>. The model works on sparse pillar tokens and thus the segmentation outputs can be written as <math id="S3.SS2.p4.2.m2.3" class="ltx_Math" alttext="f_{i-1}:\{V_{i-1,k}\in{\mathbb{R}}^{2+d}\}" display="inline"><semantics id="S3.SS2.p4.2.m2.3a"><mrow id="S3.SS2.p4.2.m2.3.3" xref="S3.SS2.p4.2.m2.3.3.cmml"><msub id="S3.SS2.p4.2.m2.3.3.3" xref="S3.SS2.p4.2.m2.3.3.3.cmml"><mi id="S3.SS2.p4.2.m2.3.3.3.2" xref="S3.SS2.p4.2.m2.3.3.3.2.cmml">f</mi><mrow id="S3.SS2.p4.2.m2.3.3.3.3" xref="S3.SS2.p4.2.m2.3.3.3.3.cmml"><mi id="S3.SS2.p4.2.m2.3.3.3.3.2" xref="S3.SS2.p4.2.m2.3.3.3.3.2.cmml">i</mi><mo id="S3.SS2.p4.2.m2.3.3.3.3.1" xref="S3.SS2.p4.2.m2.3.3.3.3.1.cmml">−</mo><mn id="S3.SS2.p4.2.m2.3.3.3.3.3" xref="S3.SS2.p4.2.m2.3.3.3.3.3.cmml">1</mn></mrow></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p4.2.m2.3.3.2" xref="S3.SS2.p4.2.m2.3.3.2.cmml">:</mo><mrow id="S3.SS2.p4.2.m2.3.3.1.1" xref="S3.SS2.p4.2.m2.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS2.p4.2.m2.3.3.1.1.2" xref="S3.SS2.p4.2.m2.3.3.1.2.cmml">{</mo><mrow id="S3.SS2.p4.2.m2.3.3.1.1.1" xref="S3.SS2.p4.2.m2.3.3.1.1.1.cmml"><msub id="S3.SS2.p4.2.m2.3.3.1.1.1.2" xref="S3.SS2.p4.2.m2.3.3.1.1.1.2.cmml"><mi id="S3.SS2.p4.2.m2.3.3.1.1.1.2.2" xref="S3.SS2.p4.2.m2.3.3.1.1.1.2.2.cmml">V</mi><mrow id="S3.SS2.p4.2.m2.2.2.2.2" xref="S3.SS2.p4.2.m2.2.2.2.3.cmml"><mrow id="S3.SS2.p4.2.m2.2.2.2.2.1" xref="S3.SS2.p4.2.m2.2.2.2.2.1.cmml"><mi id="S3.SS2.p4.2.m2.2.2.2.2.1.2" xref="S3.SS2.p4.2.m2.2.2.2.2.1.2.cmml">i</mi><mo id="S3.SS2.p4.2.m2.2.2.2.2.1.1" xref="S3.SS2.p4.2.m2.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS2.p4.2.m2.2.2.2.2.1.3" xref="S3.SS2.p4.2.m2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS2.p4.2.m2.2.2.2.2.2" xref="S3.SS2.p4.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p4.2.m2.1.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.1.cmml">k</mi></mrow></msub><mo id="S3.SS2.p4.2.m2.3.3.1.1.1.1" xref="S3.SS2.p4.2.m2.3.3.1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.2.m2.3.3.1.1.1.3" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.cmml"><mi id="S3.SS2.p4.2.m2.3.3.1.1.1.3.2" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.2.m2.3.3.1.1.1.3.3" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.cmml"><mn id="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.2" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.2.cmml">2</mn><mo id="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.1" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.1.cmml">+</mo><mi id="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.3" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><mo stretchy="false" id="S3.SS2.p4.2.m2.3.3.1.1.3" xref="S3.SS2.p4.2.m2.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.3b"><apply id="S3.SS2.p4.2.m2.3.3.cmml" xref="S3.SS2.p4.2.m2.3.3"><ci id="S3.SS2.p4.2.m2.3.3.2.cmml" xref="S3.SS2.p4.2.m2.3.3.2">:</ci><apply id="S3.SS2.p4.2.m2.3.3.3.cmml" xref="S3.SS2.p4.2.m2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.3.3.3.1.cmml" xref="S3.SS2.p4.2.m2.3.3.3">subscript</csymbol><ci id="S3.SS2.p4.2.m2.3.3.3.2.cmml" xref="S3.SS2.p4.2.m2.3.3.3.2">𝑓</ci><apply id="S3.SS2.p4.2.m2.3.3.3.3.cmml" xref="S3.SS2.p4.2.m2.3.3.3.3"><minus id="S3.SS2.p4.2.m2.3.3.3.3.1.cmml" xref="S3.SS2.p4.2.m2.3.3.3.3.1"></minus><ci id="S3.SS2.p4.2.m2.3.3.3.3.2.cmml" xref="S3.SS2.p4.2.m2.3.3.3.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p4.2.m2.3.3.3.3.3.cmml" xref="S3.SS2.p4.2.m2.3.3.3.3.3">1</cn></apply></apply><set id="S3.SS2.p4.2.m2.3.3.1.2.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1"><apply id="S3.SS2.p4.2.m2.3.3.1.1.1.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1"><in id="S3.SS2.p4.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.1"></in><apply id="S3.SS2.p4.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.3.3.1.1.1.2.1.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.2.m2.3.3.1.1.1.2.2.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.2.2">𝑉</ci><list id="S3.SS2.p4.2.m2.2.2.2.3.cmml" xref="S3.SS2.p4.2.m2.2.2.2.2"><apply id="S3.SS2.p4.2.m2.2.2.2.2.1.cmml" xref="S3.SS2.p4.2.m2.2.2.2.2.1"><minus id="S3.SS2.p4.2.m2.2.2.2.2.1.1.cmml" xref="S3.SS2.p4.2.m2.2.2.2.2.1.1"></minus><ci id="S3.SS2.p4.2.m2.2.2.2.2.1.2.cmml" xref="S3.SS2.p4.2.m2.2.2.2.2.1.2">𝑖</ci><cn type="integer" id="S3.SS2.p4.2.m2.2.2.2.2.1.3.cmml" xref="S3.SS2.p4.2.m2.2.2.2.2.1.3">1</cn></apply><ci id="S3.SS2.p4.2.m2.1.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1">𝑘</ci></list></apply><apply id="S3.SS2.p4.2.m2.3.3.1.1.1.3.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.2.m2.3.3.1.1.1.3.2.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.3"><plus id="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.1.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.1"></plus><cn type="integer" id="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.2.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.2">2</cn><ci id="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.3.cmml" xref="S3.SS2.p4.2.m2.3.3.1.1.1.3.3.3">𝑑</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.3c">f_{i-1}:\{V_{i-1,k}\in{\mathbb{R}}^{2+d}\}</annotation></semantics></math>, <math id="S3.SS2.p4.3.m3.3" class="ltx_Math" alttext="k=1,...,K_{i-1}" display="inline"><semantics id="S3.SS2.p4.3.m3.3a"><mrow id="S3.SS2.p4.3.m3.3.3" xref="S3.SS2.p4.3.m3.3.3.cmml"><mi id="S3.SS2.p4.3.m3.3.3.3" xref="S3.SS2.p4.3.m3.3.3.3.cmml">k</mi><mo id="S3.SS2.p4.3.m3.3.3.2" xref="S3.SS2.p4.3.m3.3.3.2.cmml">=</mo><mrow id="S3.SS2.p4.3.m3.3.3.1.1" xref="S3.SS2.p4.3.m3.3.3.1.2.cmml"><mn id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">1</mn><mo id="S3.SS2.p4.3.m3.3.3.1.1.2" xref="S3.SS2.p4.3.m3.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p4.3.m3.2.2" xref="S3.SS2.p4.3.m3.2.2.cmml">…</mi><mo id="S3.SS2.p4.3.m3.3.3.1.1.3" xref="S3.SS2.p4.3.m3.3.3.1.2.cmml">,</mo><msub id="S3.SS2.p4.3.m3.3.3.1.1.1" xref="S3.SS2.p4.3.m3.3.3.1.1.1.cmml"><mi id="S3.SS2.p4.3.m3.3.3.1.1.1.2" xref="S3.SS2.p4.3.m3.3.3.1.1.1.2.cmml">K</mi><mrow id="S3.SS2.p4.3.m3.3.3.1.1.1.3" xref="S3.SS2.p4.3.m3.3.3.1.1.1.3.cmml"><mi id="S3.SS2.p4.3.m3.3.3.1.1.1.3.2" xref="S3.SS2.p4.3.m3.3.3.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p4.3.m3.3.3.1.1.1.3.1" xref="S3.SS2.p4.3.m3.3.3.1.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p4.3.m3.3.3.1.1.1.3.3" xref="S3.SS2.p4.3.m3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.3b"><apply id="S3.SS2.p4.3.m3.3.3.cmml" xref="S3.SS2.p4.3.m3.3.3"><eq id="S3.SS2.p4.3.m3.3.3.2.cmml" xref="S3.SS2.p4.3.m3.3.3.2"></eq><ci id="S3.SS2.p4.3.m3.3.3.3.cmml" xref="S3.SS2.p4.3.m3.3.3.3">𝑘</ci><list id="S3.SS2.p4.3.m3.3.3.1.2.cmml" xref="S3.SS2.p4.3.m3.3.3.1.1"><cn type="integer" id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">1</cn><ci id="S3.SS2.p4.3.m3.2.2.cmml" xref="S3.SS2.p4.3.m3.2.2">…</ci><apply id="S3.SS2.p4.3.m3.3.3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS2.p4.3.m3.3.3.1.1.1.2">𝐾</ci><apply id="S3.SS2.p4.3.m3.3.3.1.1.1.3.cmml" xref="S3.SS2.p4.3.m3.3.3.1.1.1.3"><minus id="S3.SS2.p4.3.m3.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p4.3.m3.3.3.1.1.1.3.1"></minus><ci id="S3.SS2.p4.3.m3.3.3.1.1.1.3.2.cmml" xref="S3.SS2.p4.3.m3.3.3.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p4.3.m3.3.3.1.1.1.3.3.cmml" xref="S3.SS2.p4.3.m3.3.3.1.1.1.3.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.3c">k=1,...,K_{i-1}</annotation></semantics></math>. The first two dimensions record BEV coordinates of the pillars and the rest are extracted embeddings (<span id="S3.SS2.p4.10.2" class="ltx_text ltx_font_italic">i</span>.<span id="S3.SS2.p4.10.3" class="ltx_text ltx_font_italic">e</span>., <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="d=128" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><mrow id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">d</mi><mo id="S3.SS2.p4.4.m4.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><eq id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1"></eq><ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">𝑑</ci><cn type="integer" id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">d=128</annotation></semantics></math>), which contain rich scene and object-aware information. Moreover, compared with the raw point clouds size <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="N_{i-1}" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><msub id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mi id="S3.SS2.p4.5.m5.1.1.2" xref="S3.SS2.p4.5.m5.1.1.2.cmml">N</mi><mrow id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml"><mi id="S3.SS2.p4.5.m5.1.1.3.2" xref="S3.SS2.p4.5.m5.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p4.5.m5.1.1.3.1" xref="S3.SS2.p4.5.m5.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p4.5.m5.1.1.3.3" xref="S3.SS2.p4.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2">𝑁</ci><apply id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3"><minus id="S3.SS2.p4.5.m5.1.1.3.1.cmml" xref="S3.SS2.p4.5.m5.1.1.3.1"></minus><ci id="S3.SS2.p4.5.m5.1.1.3.2.cmml" xref="S3.SS2.p4.5.m5.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p4.5.m5.1.1.3.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">N_{i-1}</annotation></semantics></math> (<math id="S3.SS2.p4.6.m6.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S3.SS2.p4.6.m6.1a"><mo id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><csymbol cd="latexml" id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">\sim</annotation></semantics></math>200<math id="S3.SS2.p4.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p4.7.m7.1a"><mi id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><ci id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">k</annotation></semantics></math>), the foreground pillar feature set size <math id="S3.SS2.p4.8.m8.1" class="ltx_Math" alttext="K_{i-1}" display="inline"><semantics id="S3.SS2.p4.8.m8.1a"><msub id="S3.SS2.p4.8.m8.1.1" xref="S3.SS2.p4.8.m8.1.1.cmml"><mi id="S3.SS2.p4.8.m8.1.1.2" xref="S3.SS2.p4.8.m8.1.1.2.cmml">K</mi><mrow id="S3.SS2.p4.8.m8.1.1.3" xref="S3.SS2.p4.8.m8.1.1.3.cmml"><mi id="S3.SS2.p4.8.m8.1.1.3.2" xref="S3.SS2.p4.8.m8.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p4.8.m8.1.1.3.1" xref="S3.SS2.p4.8.m8.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p4.8.m8.1.1.3.3" xref="S3.SS2.p4.8.m8.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><apply id="S3.SS2.p4.8.m8.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.1.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p4.8.m8.1.1.2.cmml" xref="S3.SS2.p4.8.m8.1.1.2">𝐾</ci><apply id="S3.SS2.p4.8.m8.1.1.3.cmml" xref="S3.SS2.p4.8.m8.1.1.3"><minus id="S3.SS2.p4.8.m8.1.1.3.1.cmml" xref="S3.SS2.p4.8.m8.1.1.3.1"></minus><ci id="S3.SS2.p4.8.m8.1.1.3.2.cmml" xref="S3.SS2.p4.8.m8.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p4.8.m8.1.1.3.3.cmml" xref="S3.SS2.p4.8.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">K_{i-1}</annotation></semantics></math> (<math id="S3.SS2.p4.9.m9.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S3.SS2.p4.9.m9.1a"><mo id="S3.SS2.p4.9.m9.1.1" xref="S3.SS2.p4.9.m9.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m9.1b"><csymbol cd="latexml" id="S3.SS2.p4.9.m9.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m9.1c">\sim</annotation></semantics></math>2<math id="S3.SS2.p4.10.m10.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p4.10.m10.1a"><mi id="S3.SS2.p4.10.m10.1.1" xref="S3.SS2.p4.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m10.1b"><ci id="S3.SS2.p4.10.m10.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m10.1c">k</annotation></semantics></math>) is much smaller. Therefore, we are motivated to fuse these deep-layer features into early stages of the next frame in order to efficiently reuse learned high-level knowledge for 3D detection, especially on challenging large objects.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.6" class="ltx_p"><span id="S3.SS2.p5.6.1" class="ltx_text ltx_font_bold">Fusion location</span>. To achieve recurrent late-to-<span id="S3.SS2.p5.6.2" class="ltx_text ltx_font_italic">early</span> fusion, we fuse <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="f_{i-1}" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">f</mi><mrow id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml"><mi id="S3.SS2.p5.1.m1.1.1.3.2" xref="S3.SS2.p5.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p5.1.m1.1.1.3.1" xref="S3.SS2.p5.1.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p5.1.m1.1.1.3.3" xref="S3.SS2.p5.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">𝑓</ci><apply id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3"><minus id="S3.SS2.p5.1.m1.1.1.3.1.cmml" xref="S3.SS2.p5.1.m1.1.1.3.1"></minus><ci id="S3.SS2.p5.1.m1.1.1.3.2.cmml" xref="S3.SS2.p5.1.m1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p5.1.m1.1.1.3.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">f_{i-1}</annotation></semantics></math> with VoxelNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> outputs <math id="S3.SS2.p5.2.m2.6" class="ltx_Math" alttext="\nu(\{X_{i,j}\})\mapsto\{V^{{}^{\prime}}_{i,n}\in{\mathbb{R}}^{2+d}\}" display="inline"><semantics id="S3.SS2.p5.2.m2.6a"><mrow id="S3.SS2.p5.2.m2.6.6" xref="S3.SS2.p5.2.m2.6.6.cmml"><mrow id="S3.SS2.p5.2.m2.5.5.1" xref="S3.SS2.p5.2.m2.5.5.1.cmml"><mi id="S3.SS2.p5.2.m2.5.5.1.3" xref="S3.SS2.p5.2.m2.5.5.1.3.cmml">ν</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.2.m2.5.5.1.2" xref="S3.SS2.p5.2.m2.5.5.1.2.cmml">​</mo><mrow id="S3.SS2.p5.2.m2.5.5.1.1.1" xref="S3.SS2.p5.2.m2.5.5.1.cmml"><mo stretchy="false" id="S3.SS2.p5.2.m2.5.5.1.1.1.2" xref="S3.SS2.p5.2.m2.5.5.1.cmml">(</mo><mrow id="S3.SS2.p5.2.m2.5.5.1.1.1.1.1" xref="S3.SS2.p5.2.m2.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.2" xref="S3.SS2.p5.2.m2.5.5.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.1" xref="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.1.2" xref="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.1.2.cmml">X</mi><mrow id="S3.SS2.p5.2.m2.2.2.2.4" xref="S3.SS2.p5.2.m2.2.2.2.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p5.2.m2.2.2.2.4.1" xref="S3.SS2.p5.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p5.2.m2.2.2.2.2" xref="S3.SS2.p5.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.3" xref="S3.SS2.p5.2.m2.5.5.1.1.1.1.2.cmml">}</mo></mrow><mo stretchy="false" id="S3.SS2.p5.2.m2.5.5.1.1.1.3" xref="S3.SS2.p5.2.m2.5.5.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p5.2.m2.6.6.3" xref="S3.SS2.p5.2.m2.6.6.3.cmml">↦</mo><mrow id="S3.SS2.p5.2.m2.6.6.2.1" xref="S3.SS2.p5.2.m2.6.6.2.2.cmml"><mo stretchy="false" id="S3.SS2.p5.2.m2.6.6.2.1.2" xref="S3.SS2.p5.2.m2.6.6.2.2.cmml">{</mo><mrow id="S3.SS2.p5.2.m2.6.6.2.1.1" xref="S3.SS2.p5.2.m2.6.6.2.1.1.cmml"><msubsup id="S3.SS2.p5.2.m2.6.6.2.1.1.2" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2.cmml"><mi id="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.2" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.2.cmml">V</mi><mrow id="S3.SS2.p5.2.m2.4.4.2.4" xref="S3.SS2.p5.2.m2.4.4.2.3.cmml"><mi id="S3.SS2.p5.2.m2.3.3.1.1" xref="S3.SS2.p5.2.m2.3.3.1.1.cmml">i</mi><mo id="S3.SS2.p5.2.m2.4.4.2.4.1" xref="S3.SS2.p5.2.m2.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p5.2.m2.4.4.2.2" xref="S3.SS2.p5.2.m2.4.4.2.2.cmml">n</mi></mrow><msup id="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.3" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.3.cmml"><mi id="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.3a" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.3.cmml"></mi><mo id="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.3.1" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.3.1.cmml">′</mo></msup></msubsup><mo id="S3.SS2.p5.2.m2.6.6.2.1.1.1" xref="S3.SS2.p5.2.m2.6.6.2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.2.m2.6.6.2.1.1.3" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.6.6.2.1.1.3.2" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.2.m2.6.6.2.1.1.3.3" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.cmml"><mn id="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.2" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.2.cmml">2</mn><mo id="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.1" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.1.cmml">+</mo><mi id="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.3" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><mo stretchy="false" id="S3.SS2.p5.2.m2.6.6.2.1.3" xref="S3.SS2.p5.2.m2.6.6.2.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.6b"><apply id="S3.SS2.p5.2.m2.6.6.cmml" xref="S3.SS2.p5.2.m2.6.6"><csymbol cd="latexml" id="S3.SS2.p5.2.m2.6.6.3.cmml" xref="S3.SS2.p5.2.m2.6.6.3">maps-to</csymbol><apply id="S3.SS2.p5.2.m2.5.5.1.cmml" xref="S3.SS2.p5.2.m2.5.5.1"><times id="S3.SS2.p5.2.m2.5.5.1.2.cmml" xref="S3.SS2.p5.2.m2.5.5.1.2"></times><ci id="S3.SS2.p5.2.m2.5.5.1.3.cmml" xref="S3.SS2.p5.2.m2.5.5.1.3">𝜈</ci><set id="S3.SS2.p5.2.m2.5.5.1.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.5.5.1.1.1.1.1"><apply id="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.5.5.1.1.1.1.1.1.2">𝑋</ci><list id="S3.SS2.p5.2.m2.2.2.2.3.cmml" xref="S3.SS2.p5.2.m2.2.2.2.4"><ci id="S3.SS2.p5.2.m2.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1">𝑖</ci><ci id="S3.SS2.p5.2.m2.2.2.2.2.cmml" xref="S3.SS2.p5.2.m2.2.2.2.2">𝑗</ci></list></apply></set></apply><set id="S3.SS2.p5.2.m2.6.6.2.2.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1"><apply id="S3.SS2.p5.2.m2.6.6.2.1.1.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1"><in id="S3.SS2.p5.2.m2.6.6.2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.1"></in><apply id="S3.SS2.p5.2.m2.6.6.2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.6.6.2.1.1.2.1.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2">subscript</csymbol><apply id="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.1.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2">superscript</csymbol><ci id="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.2.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.2">𝑉</ci><apply id="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.3.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.3"><ci id="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.3.1.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.2.2.3.1">′</ci></apply></apply><list id="S3.SS2.p5.2.m2.4.4.2.3.cmml" xref="S3.SS2.p5.2.m2.4.4.2.4"><ci id="S3.SS2.p5.2.m2.3.3.1.1.cmml" xref="S3.SS2.p5.2.m2.3.3.1.1">𝑖</ci><ci id="S3.SS2.p5.2.m2.4.4.2.2.cmml" xref="S3.SS2.p5.2.m2.4.4.2.2">𝑛</ci></list></apply><apply id="S3.SS2.p5.2.m2.6.6.2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.6.6.2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.2.m2.6.6.2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.3"><plus id="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.1.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.1"></plus><cn type="integer" id="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.2.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.2">2</cn><ci id="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.3.cmml" xref="S3.SS2.p5.2.m2.6.6.2.1.1.3.3.3">𝑑</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.6c">\nu(\{X_{i,j}\})\mapsto\{V^{{}^{\prime}}_{i,n}\in{\mathbb{R}}^{2+d}\}</annotation></semantics></math>, <math id="S3.SS2.p5.3.m3.3" class="ltx_Math" alttext="n=1,...,N^{{}^{\prime}}_{i}" display="inline"><semantics id="S3.SS2.p5.3.m3.3a"><mrow id="S3.SS2.p5.3.m3.3.3" xref="S3.SS2.p5.3.m3.3.3.cmml"><mi id="S3.SS2.p5.3.m3.3.3.3" xref="S3.SS2.p5.3.m3.3.3.3.cmml">n</mi><mo id="S3.SS2.p5.3.m3.3.3.2" xref="S3.SS2.p5.3.m3.3.3.2.cmml">=</mo><mrow id="S3.SS2.p5.3.m3.3.3.1.1" xref="S3.SS2.p5.3.m3.3.3.1.2.cmml"><mn id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml">1</mn><mo id="S3.SS2.p5.3.m3.3.3.1.1.2" xref="S3.SS2.p5.3.m3.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p5.3.m3.2.2" xref="S3.SS2.p5.3.m3.2.2.cmml">…</mi><mo id="S3.SS2.p5.3.m3.3.3.1.1.3" xref="S3.SS2.p5.3.m3.3.3.1.2.cmml">,</mo><msubsup id="S3.SS2.p5.3.m3.3.3.1.1.1" xref="S3.SS2.p5.3.m3.3.3.1.1.1.cmml"><mi id="S3.SS2.p5.3.m3.3.3.1.1.1.2.2" xref="S3.SS2.p5.3.m3.3.3.1.1.1.2.2.cmml">N</mi><mi id="S3.SS2.p5.3.m3.3.3.1.1.1.3" xref="S3.SS2.p5.3.m3.3.3.1.1.1.3.cmml">i</mi><msup id="S3.SS2.p5.3.m3.3.3.1.1.1.2.3" xref="S3.SS2.p5.3.m3.3.3.1.1.1.2.3.cmml"><mi id="S3.SS2.p5.3.m3.3.3.1.1.1.2.3a" xref="S3.SS2.p5.3.m3.3.3.1.1.1.2.3.cmml"></mi><mo id="S3.SS2.p5.3.m3.3.3.1.1.1.2.3.1" xref="S3.SS2.p5.3.m3.3.3.1.1.1.2.3.1.cmml">′</mo></msup></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.3b"><apply id="S3.SS2.p5.3.m3.3.3.cmml" xref="S3.SS2.p5.3.m3.3.3"><eq id="S3.SS2.p5.3.m3.3.3.2.cmml" xref="S3.SS2.p5.3.m3.3.3.2"></eq><ci id="S3.SS2.p5.3.m3.3.3.3.cmml" xref="S3.SS2.p5.3.m3.3.3.3">𝑛</ci><list id="S3.SS2.p5.3.m3.3.3.1.2.cmml" xref="S3.SS2.p5.3.m3.3.3.1.1"><cn type="integer" id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">1</cn><ci id="S3.SS2.p5.3.m3.2.2.cmml" xref="S3.SS2.p5.3.m3.2.2">…</ci><apply id="S3.SS2.p5.3.m3.3.3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS2.p5.3.m3.3.3.1.1.1">subscript</csymbol><apply id="S3.SS2.p5.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS2.p5.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.3.3.1.1.1.2.1.cmml" xref="S3.SS2.p5.3.m3.3.3.1.1.1">superscript</csymbol><ci id="S3.SS2.p5.3.m3.3.3.1.1.1.2.2.cmml" xref="S3.SS2.p5.3.m3.3.3.1.1.1.2.2">𝑁</ci><apply id="S3.SS2.p5.3.m3.3.3.1.1.1.2.3.cmml" xref="S3.SS2.p5.3.m3.3.3.1.1.1.2.3"><ci id="S3.SS2.p5.3.m3.3.3.1.1.1.2.3.1.cmml" xref="S3.SS2.p5.3.m3.3.3.1.1.1.2.3.1">′</ci></apply></apply><ci id="S3.SS2.p5.3.m3.3.3.1.1.1.3.cmml" xref="S3.SS2.p5.3.m3.3.3.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.3c">n=1,...,N^{{}^{\prime}}_{i}</annotation></semantics></math> before they are fed into the the main backbone network. Meanwhile, instead of early fusion before the backbone, some may argue that an alternative way is conducting late fusion after the backbone process, which is close to the network stage where <math id="S3.SS2.p5.4.m4.1" class="ltx_Math" alttext="f_{i-1}" display="inline"><semantics id="S3.SS2.p5.4.m4.1a"><msub id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><mi id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">f</mi><mrow id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.3.2" xref="S3.SS2.p5.4.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p5.4.m4.1.1.3.1" xref="S3.SS2.p5.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p5.4.m4.1.1.3.3" xref="S3.SS2.p5.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2">𝑓</ci><apply id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3"><minus id="S3.SS2.p5.4.m4.1.1.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.3.1"></minus><ci id="S3.SS2.p5.4.m4.1.1.3.2.cmml" xref="S3.SS2.p5.4.m4.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p5.4.m4.1.1.3.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">f_{i-1}</annotation></semantics></math> is extracted. Diagrams of these two different fusion locations are plotted in <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>. We think that presumably late fusion can cause the backbone <span id="S3.SS2.p5.6.3" class="ltx_text ltx_markedasmath ltx_font_typewriter">B</span> to lose access to temporally aggregated LiDAR sequence information, and thus the low-capacity detection heads <span id="S3.SS2.p5.6.4" class="ltx_text ltx_markedasmath ltx_font_typewriter">H</span> will struggle to understand fused features and predict object poses and shapes. Ablation studies on early-to-early, late-to-late and our proposed late-to-early fusion methods are provided in <a href="#S4.T4" title="TABLE IV ‣ IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table IV</span></a> and Section <a href="#S4.SS3" title="IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-C</span></span></a>, which empirically proved the advantages of our approach.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Inverse Calibration and Alignment</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.8" class="ltx_p">While image sequences are naturally aligned across different frames by the shapes (height, width, channel), sparse sets of pillar features <math id="S3.SS3.p1.1.m1.3" class="ltx_Math" alttext="\{V_{i-1,k}\}" display="inline"><semantics id="S3.SS3.p1.1.m1.3a"><mrow id="S3.SS3.p1.1.m1.3.3.1" xref="S3.SS3.p1.1.m1.3.3.2.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.3.3.1.2" xref="S3.SS3.p1.1.m1.3.3.2.cmml">{</mo><msub id="S3.SS3.p1.1.m1.3.3.1.1" xref="S3.SS3.p1.1.m1.3.3.1.1.cmml"><mi id="S3.SS3.p1.1.m1.3.3.1.1.2" xref="S3.SS3.p1.1.m1.3.3.1.1.2.cmml">V</mi><mrow id="S3.SS3.p1.1.m1.2.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.3.cmml"><mrow id="S3.SS3.p1.1.m1.2.2.2.2.1" xref="S3.SS3.p1.1.m1.2.2.2.2.1.cmml"><mi id="S3.SS3.p1.1.m1.2.2.2.2.1.2" xref="S3.SS3.p1.1.m1.2.2.2.2.1.2.cmml">i</mi><mo id="S3.SS3.p1.1.m1.2.2.2.2.1.1" xref="S3.SS3.p1.1.m1.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS3.p1.1.m1.2.2.2.2.1.3" xref="S3.SS3.p1.1.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS3.p1.1.m1.2.2.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS3.p1.1.m1.3.3.1.3" xref="S3.SS3.p1.1.m1.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.3b"><set id="S3.SS3.p1.1.m1.3.3.2.cmml" xref="S3.SS3.p1.1.m1.3.3.1"><apply id="S3.SS3.p1.1.m1.3.3.1.1.cmml" xref="S3.SS3.p1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS3.p1.1.m1.3.3.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.1.1.2.cmml" xref="S3.SS3.p1.1.m1.3.3.1.1.2">𝑉</ci><list id="S3.SS3.p1.1.m1.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2"><apply id="S3.SS3.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.1"><minus id="S3.SS3.p1.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.1.1"></minus><ci id="S3.SS3.p1.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.1.2">𝑖</ci><cn type="integer" id="S3.SS3.p1.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2.1.3">1</cn></apply><ci id="S3.SS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1">𝑘</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.3c">\{V_{i-1,k}\}</annotation></semantics></math>, <math id="S3.SS3.p1.2.m2.3" class="ltx_Math" alttext="\{V^{{}^{\prime}}_{i,n}\}" display="inline"><semantics id="S3.SS3.p1.2.m2.3a"><mrow id="S3.SS3.p1.2.m2.3.3.1" xref="S3.SS3.p1.2.m2.3.3.2.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.3.3.1.2" xref="S3.SS3.p1.2.m2.3.3.2.cmml">{</mo><msubsup id="S3.SS3.p1.2.m2.3.3.1.1" xref="S3.SS3.p1.2.m2.3.3.1.1.cmml"><mi id="S3.SS3.p1.2.m2.3.3.1.1.2.2" xref="S3.SS3.p1.2.m2.3.3.1.1.2.2.cmml">V</mi><mrow id="S3.SS3.p1.2.m2.2.2.2.4" xref="S3.SS3.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p1.2.m2.2.2.2.4.1" xref="S3.SS3.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.2.m2.2.2.2.2" xref="S3.SS3.p1.2.m2.2.2.2.2.cmml">n</mi></mrow><msup id="S3.SS3.p1.2.m2.3.3.1.1.2.3" xref="S3.SS3.p1.2.m2.3.3.1.1.2.3.cmml"><mi id="S3.SS3.p1.2.m2.3.3.1.1.2.3a" xref="S3.SS3.p1.2.m2.3.3.1.1.2.3.cmml"></mi><mo id="S3.SS3.p1.2.m2.3.3.1.1.2.3.1" xref="S3.SS3.p1.2.m2.3.3.1.1.2.3.1.cmml">′</mo></msup></msubsup><mo stretchy="false" id="S3.SS3.p1.2.m2.3.3.1.3" xref="S3.SS3.p1.2.m2.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.3b"><set id="S3.SS3.p1.2.m2.3.3.2.cmml" xref="S3.SS3.p1.2.m2.3.3.1"><apply id="S3.SS3.p1.2.m2.3.3.1.1.cmml" xref="S3.SS3.p1.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS3.p1.2.m2.3.3.1.1">subscript</csymbol><apply id="S3.SS3.p1.2.m2.3.3.1.1.2.cmml" xref="S3.SS3.p1.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.3.3.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.3.3.1.1">superscript</csymbol><ci id="S3.SS3.p1.2.m2.3.3.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.3.3.1.1.2.2">𝑉</ci><apply id="S3.SS3.p1.2.m2.3.3.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.3.3.1.1.2.3"><ci id="S3.SS3.p1.2.m2.3.3.1.1.2.3.1.cmml" xref="S3.SS3.p1.2.m2.3.3.1.1.2.3.1">′</ci></apply></apply><list id="S3.SS3.p1.2.m2.2.2.2.3.cmml" xref="S3.SS3.p1.2.m2.2.2.2.4"><ci id="S3.SS3.p1.2.m2.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1">𝑖</ci><ci id="S3.SS3.p1.2.m2.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2">𝑛</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.3c">\{V^{{}^{\prime}}_{i,n}\}</annotation></semantics></math> are neither aligned nor with the same cardinality (<span id="S3.SS3.p1.8.1" class="ltx_text ltx_font_italic">i</span>.<span id="S3.SS3.p1.8.2" class="ltx_text ltx_font_italic">e</span>., <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="K_{i-1}\neq N^{{}^{\prime}}_{i}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><msub id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2.2" xref="S3.SS3.p1.3.m3.1.1.2.2.cmml">K</mi><mrow id="S3.SS3.p1.3.m3.1.1.2.3" xref="S3.SS3.p1.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2.3.2" xref="S3.SS3.p1.3.m3.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p1.3.m3.1.1.2.3.1" xref="S3.SS3.p1.3.m3.1.1.2.3.1.cmml">−</mo><mn id="S3.SS3.p1.3.m3.1.1.2.3.3" xref="S3.SS3.p1.3.m3.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.cmml">≠</mo><msubsup id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.2.2" xref="S3.SS3.p1.3.m3.1.1.3.2.2.cmml">N</mi><mi id="S3.SS3.p1.3.m3.1.1.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.cmml">i</mi><msup id="S3.SS3.p1.3.m3.1.1.3.2.3" xref="S3.SS3.p1.3.m3.1.1.3.2.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.2.3a" xref="S3.SS3.p1.3.m3.1.1.3.2.3.cmml"></mi><mo id="S3.SS3.p1.3.m3.1.1.3.2.3.1" xref="S3.SS3.p1.3.m3.1.1.3.2.3.1.cmml">′</mo></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><neq id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1"></neq><apply id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2.2">𝐾</ci><apply id="S3.SS3.p1.3.m3.1.1.2.3.cmml" xref="S3.SS3.p1.3.m3.1.1.2.3"><minus id="S3.SS3.p1.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.2.3.1"></minus><ci id="S3.SS3.p1.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p1.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3">subscript</csymbol><apply id="S3.SS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2.2">𝑁</ci><apply id="S3.SS3.p1.3.m3.1.1.3.2.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2.3"><ci id="S3.SS3.p1.3.m3.1.1.3.2.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2.3.1">′</ci></apply></apply><ci id="S3.SS3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">K_{i-1}\neq N^{{}^{\prime}}_{i}</annotation></semantics></math>).
Intuitively one could convert sparse features into dense BEV maps <math id="S3.SS3.p1.4.m4.3" class="ltx_Math" alttext="\{V_{i-1,k}\}\mapsto I_{i-1}\in{\mathbb{R}}^{H\times W\times d}" display="inline"><semantics id="S3.SS3.p1.4.m4.3a"><mrow id="S3.SS3.p1.4.m4.3.3" xref="S3.SS3.p1.4.m4.3.3.cmml"><mrow id="S3.SS3.p1.4.m4.3.3.1.1" xref="S3.SS3.p1.4.m4.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m4.3.3.1.1.2" xref="S3.SS3.p1.4.m4.3.3.1.2.cmml">{</mo><msub id="S3.SS3.p1.4.m4.3.3.1.1.1" xref="S3.SS3.p1.4.m4.3.3.1.1.1.cmml"><mi id="S3.SS3.p1.4.m4.3.3.1.1.1.2" xref="S3.SS3.p1.4.m4.3.3.1.1.1.2.cmml">V</mi><mrow id="S3.SS3.p1.4.m4.2.2.2.2" xref="S3.SS3.p1.4.m4.2.2.2.3.cmml"><mrow id="S3.SS3.p1.4.m4.2.2.2.2.1" xref="S3.SS3.p1.4.m4.2.2.2.2.1.cmml"><mi id="S3.SS3.p1.4.m4.2.2.2.2.1.2" xref="S3.SS3.p1.4.m4.2.2.2.2.1.2.cmml">i</mi><mo id="S3.SS3.p1.4.m4.2.2.2.2.1.1" xref="S3.SS3.p1.4.m4.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS3.p1.4.m4.2.2.2.2.1.3" xref="S3.SS3.p1.4.m4.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS3.p1.4.m4.2.2.2.2.2" xref="S3.SS3.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.4.m4.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS3.p1.4.m4.3.3.1.1.3" xref="S3.SS3.p1.4.m4.3.3.1.2.cmml">}</mo></mrow><mo stretchy="false" id="S3.SS3.p1.4.m4.3.3.3" xref="S3.SS3.p1.4.m4.3.3.3.cmml">↦</mo><msub id="S3.SS3.p1.4.m4.3.3.4" xref="S3.SS3.p1.4.m4.3.3.4.cmml"><mi id="S3.SS3.p1.4.m4.3.3.4.2" xref="S3.SS3.p1.4.m4.3.3.4.2.cmml">I</mi><mrow id="S3.SS3.p1.4.m4.3.3.4.3" xref="S3.SS3.p1.4.m4.3.3.4.3.cmml"><mi id="S3.SS3.p1.4.m4.3.3.4.3.2" xref="S3.SS3.p1.4.m4.3.3.4.3.2.cmml">i</mi><mo id="S3.SS3.p1.4.m4.3.3.4.3.1" xref="S3.SS3.p1.4.m4.3.3.4.3.1.cmml">−</mo><mn id="S3.SS3.p1.4.m4.3.3.4.3.3" xref="S3.SS3.p1.4.m4.3.3.4.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p1.4.m4.3.3.5" xref="S3.SS3.p1.4.m4.3.3.5.cmml">∈</mo><msup id="S3.SS3.p1.4.m4.3.3.6" xref="S3.SS3.p1.4.m4.3.3.6.cmml"><mi id="S3.SS3.p1.4.m4.3.3.6.2" xref="S3.SS3.p1.4.m4.3.3.6.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.4.m4.3.3.6.3" xref="S3.SS3.p1.4.m4.3.3.6.3.cmml"><mi id="S3.SS3.p1.4.m4.3.3.6.3.2" xref="S3.SS3.p1.4.m4.3.3.6.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.4.m4.3.3.6.3.1" xref="S3.SS3.p1.4.m4.3.3.6.3.1.cmml">×</mo><mi id="S3.SS3.p1.4.m4.3.3.6.3.3" xref="S3.SS3.p1.4.m4.3.3.6.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.4.m4.3.3.6.3.1a" xref="S3.SS3.p1.4.m4.3.3.6.3.1.cmml">×</mo><mi id="S3.SS3.p1.4.m4.3.3.6.3.4" xref="S3.SS3.p1.4.m4.3.3.6.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.3b"><apply id="S3.SS3.p1.4.m4.3.3.cmml" xref="S3.SS3.p1.4.m4.3.3"><and id="S3.SS3.p1.4.m4.3.3a.cmml" xref="S3.SS3.p1.4.m4.3.3"></and><apply id="S3.SS3.p1.4.m4.3.3b.cmml" xref="S3.SS3.p1.4.m4.3.3"><csymbol cd="latexml" id="S3.SS3.p1.4.m4.3.3.3.cmml" xref="S3.SS3.p1.4.m4.3.3.3">maps-to</csymbol><set id="S3.SS3.p1.4.m4.3.3.1.2.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1"><apply id="S3.SS3.p1.4.m4.3.3.1.1.1.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1.1.2">𝑉</ci><list id="S3.SS3.p1.4.m4.2.2.2.3.cmml" xref="S3.SS3.p1.4.m4.2.2.2.2"><apply id="S3.SS3.p1.4.m4.2.2.2.2.1.cmml" xref="S3.SS3.p1.4.m4.2.2.2.2.1"><minus id="S3.SS3.p1.4.m4.2.2.2.2.1.1.cmml" xref="S3.SS3.p1.4.m4.2.2.2.2.1.1"></minus><ci id="S3.SS3.p1.4.m4.2.2.2.2.1.2.cmml" xref="S3.SS3.p1.4.m4.2.2.2.2.1.2">𝑖</ci><cn type="integer" id="S3.SS3.p1.4.m4.2.2.2.2.1.3.cmml" xref="S3.SS3.p1.4.m4.2.2.2.2.1.3">1</cn></apply><ci id="S3.SS3.p1.4.m4.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1">𝑘</ci></list></apply></set><apply id="S3.SS3.p1.4.m4.3.3.4.cmml" xref="S3.SS3.p1.4.m4.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.3.3.4.1.cmml" xref="S3.SS3.p1.4.m4.3.3.4">subscript</csymbol><ci id="S3.SS3.p1.4.m4.3.3.4.2.cmml" xref="S3.SS3.p1.4.m4.3.3.4.2">𝐼</ci><apply id="S3.SS3.p1.4.m4.3.3.4.3.cmml" xref="S3.SS3.p1.4.m4.3.3.4.3"><minus id="S3.SS3.p1.4.m4.3.3.4.3.1.cmml" xref="S3.SS3.p1.4.m4.3.3.4.3.1"></minus><ci id="S3.SS3.p1.4.m4.3.3.4.3.2.cmml" xref="S3.SS3.p1.4.m4.3.3.4.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p1.4.m4.3.3.4.3.3.cmml" xref="S3.SS3.p1.4.m4.3.3.4.3.3">1</cn></apply></apply></apply><apply id="S3.SS3.p1.4.m4.3.3c.cmml" xref="S3.SS3.p1.4.m4.3.3"><in id="S3.SS3.p1.4.m4.3.3.5.cmml" xref="S3.SS3.p1.4.m4.3.3.5"></in><share href="#S3.SS3.p1.4.m4.3.3.4.cmml" id="S3.SS3.p1.4.m4.3.3d.cmml" xref="S3.SS3.p1.4.m4.3.3"></share><apply id="S3.SS3.p1.4.m4.3.3.6.cmml" xref="S3.SS3.p1.4.m4.3.3.6"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.3.3.6.1.cmml" xref="S3.SS3.p1.4.m4.3.3.6">superscript</csymbol><ci id="S3.SS3.p1.4.m4.3.3.6.2.cmml" xref="S3.SS3.p1.4.m4.3.3.6.2">ℝ</ci><apply id="S3.SS3.p1.4.m4.3.3.6.3.cmml" xref="S3.SS3.p1.4.m4.3.3.6.3"><times id="S3.SS3.p1.4.m4.3.3.6.3.1.cmml" xref="S3.SS3.p1.4.m4.3.3.6.3.1"></times><ci id="S3.SS3.p1.4.m4.3.3.6.3.2.cmml" xref="S3.SS3.p1.4.m4.3.3.6.3.2">𝐻</ci><ci id="S3.SS3.p1.4.m4.3.3.6.3.3.cmml" xref="S3.SS3.p1.4.m4.3.3.6.3.3">𝑊</ci><ci id="S3.SS3.p1.4.m4.3.3.6.3.4.cmml" xref="S3.SS3.p1.4.m4.3.3.6.3.4">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.3c">\{V_{i-1,k}\}\mapsto I_{i-1}\in{\mathbb{R}}^{H\times W\times d}</annotation></semantics></math>, <math id="S3.SS3.p1.5.m5.3" class="ltx_Math" alttext="\{V^{{}^{\prime}}_{i,n}\}\mapsto I^{{}^{\prime}}_{i}\in{\mathbb{R}}^{H\times W\times d}" display="inline"><semantics id="S3.SS3.p1.5.m5.3a"><mrow id="S3.SS3.p1.5.m5.3.3" xref="S3.SS3.p1.5.m5.3.3.cmml"><mrow id="S3.SS3.p1.5.m5.3.3.1.1" xref="S3.SS3.p1.5.m5.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.1.1.2" xref="S3.SS3.p1.5.m5.3.3.1.2.cmml">{</mo><msubsup id="S3.SS3.p1.5.m5.3.3.1.1.1" xref="S3.SS3.p1.5.m5.3.3.1.1.1.cmml"><mi id="S3.SS3.p1.5.m5.3.3.1.1.1.2.2" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.2.cmml">V</mi><mrow id="S3.SS3.p1.5.m5.2.2.2.4" xref="S3.SS3.p1.5.m5.2.2.2.3.cmml"><mi id="S3.SS3.p1.5.m5.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p1.5.m5.2.2.2.4.1" xref="S3.SS3.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.5.m5.2.2.2.2" xref="S3.SS3.p1.5.m5.2.2.2.2.cmml">n</mi></mrow><msup id="S3.SS3.p1.5.m5.3.3.1.1.1.2.3" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.3.cmml"><mi id="S3.SS3.p1.5.m5.3.3.1.1.1.2.3a" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.3.cmml"></mi><mo id="S3.SS3.p1.5.m5.3.3.1.1.1.2.3.1" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.3.1.cmml">′</mo></msup></msubsup><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.1.1.3" xref="S3.SS3.p1.5.m5.3.3.1.2.cmml">}</mo></mrow><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.3" xref="S3.SS3.p1.5.m5.3.3.3.cmml">↦</mo><msubsup id="S3.SS3.p1.5.m5.3.3.4" xref="S3.SS3.p1.5.m5.3.3.4.cmml"><mi id="S3.SS3.p1.5.m5.3.3.4.2.2" xref="S3.SS3.p1.5.m5.3.3.4.2.2.cmml">I</mi><mi id="S3.SS3.p1.5.m5.3.3.4.3" xref="S3.SS3.p1.5.m5.3.3.4.3.cmml">i</mi><msup id="S3.SS3.p1.5.m5.3.3.4.2.3" xref="S3.SS3.p1.5.m5.3.3.4.2.3.cmml"><mi id="S3.SS3.p1.5.m5.3.3.4.2.3a" xref="S3.SS3.p1.5.m5.3.3.4.2.3.cmml"></mi><mo id="S3.SS3.p1.5.m5.3.3.4.2.3.1" xref="S3.SS3.p1.5.m5.3.3.4.2.3.1.cmml">′</mo></msup></msubsup><mo id="S3.SS3.p1.5.m5.3.3.5" xref="S3.SS3.p1.5.m5.3.3.5.cmml">∈</mo><msup id="S3.SS3.p1.5.m5.3.3.6" xref="S3.SS3.p1.5.m5.3.3.6.cmml"><mi id="S3.SS3.p1.5.m5.3.3.6.2" xref="S3.SS3.p1.5.m5.3.3.6.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.5.m5.3.3.6.3" xref="S3.SS3.p1.5.m5.3.3.6.3.cmml"><mi id="S3.SS3.p1.5.m5.3.3.6.3.2" xref="S3.SS3.p1.5.m5.3.3.6.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.5.m5.3.3.6.3.1" xref="S3.SS3.p1.5.m5.3.3.6.3.1.cmml">×</mo><mi id="S3.SS3.p1.5.m5.3.3.6.3.3" xref="S3.SS3.p1.5.m5.3.3.6.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.5.m5.3.3.6.3.1a" xref="S3.SS3.p1.5.m5.3.3.6.3.1.cmml">×</mo><mi id="S3.SS3.p1.5.m5.3.3.6.3.4" xref="S3.SS3.p1.5.m5.3.3.6.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.3b"><apply id="S3.SS3.p1.5.m5.3.3.cmml" xref="S3.SS3.p1.5.m5.3.3"><and id="S3.SS3.p1.5.m5.3.3a.cmml" xref="S3.SS3.p1.5.m5.3.3"></and><apply id="S3.SS3.p1.5.m5.3.3b.cmml" xref="S3.SS3.p1.5.m5.3.3"><csymbol cd="latexml" id="S3.SS3.p1.5.m5.3.3.3.cmml" xref="S3.SS3.p1.5.m5.3.3.3">maps-to</csymbol><set id="S3.SS3.p1.5.m5.3.3.1.2.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1"><apply id="S3.SS3.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1">subscript</csymbol><apply id="S3.SS3.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.1.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.5.m5.3.3.1.1.1.2.2.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.2">𝑉</ci><apply id="S3.SS3.p1.5.m5.3.3.1.1.1.2.3.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.3"><ci id="S3.SS3.p1.5.m5.3.3.1.1.1.2.3.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.3.1">′</ci></apply></apply><list id="S3.SS3.p1.5.m5.2.2.2.3.cmml" xref="S3.SS3.p1.5.m5.2.2.2.4"><ci id="S3.SS3.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1">𝑖</ci><ci id="S3.SS3.p1.5.m5.2.2.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2.2.2">𝑛</ci></list></apply></set><apply id="S3.SS3.p1.5.m5.3.3.4.cmml" xref="S3.SS3.p1.5.m5.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.4.1.cmml" xref="S3.SS3.p1.5.m5.3.3.4">subscript</csymbol><apply id="S3.SS3.p1.5.m5.3.3.4.2.cmml" xref="S3.SS3.p1.5.m5.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.4.2.1.cmml" xref="S3.SS3.p1.5.m5.3.3.4">superscript</csymbol><ci id="S3.SS3.p1.5.m5.3.3.4.2.2.cmml" xref="S3.SS3.p1.5.m5.3.3.4.2.2">𝐼</ci><apply id="S3.SS3.p1.5.m5.3.3.4.2.3.cmml" xref="S3.SS3.p1.5.m5.3.3.4.2.3"><ci id="S3.SS3.p1.5.m5.3.3.4.2.3.1.cmml" xref="S3.SS3.p1.5.m5.3.3.4.2.3.1">′</ci></apply></apply><ci id="S3.SS3.p1.5.m5.3.3.4.3.cmml" xref="S3.SS3.p1.5.m5.3.3.4.3">𝑖</ci></apply></apply><apply id="S3.SS3.p1.5.m5.3.3c.cmml" xref="S3.SS3.p1.5.m5.3.3"><in id="S3.SS3.p1.5.m5.3.3.5.cmml" xref="S3.SS3.p1.5.m5.3.3.5"></in><share href="#S3.SS3.p1.5.m5.3.3.4.cmml" id="S3.SS3.p1.5.m5.3.3d.cmml" xref="S3.SS3.p1.5.m5.3.3"></share><apply id="S3.SS3.p1.5.m5.3.3.6.cmml" xref="S3.SS3.p1.5.m5.3.3.6"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.6.1.cmml" xref="S3.SS3.p1.5.m5.3.3.6">superscript</csymbol><ci id="S3.SS3.p1.5.m5.3.3.6.2.cmml" xref="S3.SS3.p1.5.m5.3.3.6.2">ℝ</ci><apply id="S3.SS3.p1.5.m5.3.3.6.3.cmml" xref="S3.SS3.p1.5.m5.3.3.6.3"><times id="S3.SS3.p1.5.m5.3.3.6.3.1.cmml" xref="S3.SS3.p1.5.m5.3.3.6.3.1"></times><ci id="S3.SS3.p1.5.m5.3.3.6.3.2.cmml" xref="S3.SS3.p1.5.m5.3.3.6.3.2">𝐻</ci><ci id="S3.SS3.p1.5.m5.3.3.6.3.3.cmml" xref="S3.SS3.p1.5.m5.3.3.6.3.3">𝑊</ci><ci id="S3.SS3.p1.5.m5.3.3.6.3.4.cmml" xref="S3.SS3.p1.5.m5.3.3.6.3.4">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.3c">\{V^{{}^{\prime}}_{i,n}\}\mapsto I^{{}^{\prime}}_{i}\in{\mathbb{R}}^{H\times W\times d}</annotation></semantics></math> and then align them. However, as <a href="#S3.F2" title="Figure 2 ‣ III-A Problem Statement ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a> shows, directly doing so without proper calibration can result in misalignment between underlying objects of the scene. This is because pillar features extracted by the backbones are from their corresponding local vehicle coordinates with poses of <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="g_{i-1}\in{\mathbb{R}}^{4\times 4}" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mrow id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><msub id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2.2" xref="S3.SS3.p1.6.m6.1.1.2.2.cmml">g</mi><mrow id="S3.SS3.p1.6.m6.1.1.2.3" xref="S3.SS3.p1.6.m6.1.1.2.3.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2.3.2" xref="S3.SS3.p1.6.m6.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p1.6.m6.1.1.2.3.1" xref="S3.SS3.p1.6.m6.1.1.2.3.1.cmml">−</mo><mn id="S3.SS3.p1.6.m6.1.1.2.3.3" xref="S3.SS3.p1.6.m6.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p1.6.m6.1.1.1" xref="S3.SS3.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml"><mi id="S3.SS3.p1.6.m6.1.1.3.2" xref="S3.SS3.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.6.m6.1.1.3.3" xref="S3.SS3.p1.6.m6.1.1.3.3.cmml"><mn id="S3.SS3.p1.6.m6.1.1.3.3.2" xref="S3.SS3.p1.6.m6.1.1.3.3.2.cmml">4</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.6.m6.1.1.3.3.1" xref="S3.SS3.p1.6.m6.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.p1.6.m6.1.1.3.3.3" xref="S3.SS3.p1.6.m6.1.1.3.3.3.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><in id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1"></in><apply id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.2.1.cmml" xref="S3.SS3.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2.2">𝑔</ci><apply id="S3.SS3.p1.6.m6.1.1.2.3.cmml" xref="S3.SS3.p1.6.m6.1.1.2.3"><minus id="S3.SS3.p1.6.m6.1.1.2.3.1.cmml" xref="S3.SS3.p1.6.m6.1.1.2.3.1"></minus><ci id="S3.SS3.p1.6.m6.1.1.2.3.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p1.6.m6.1.1.2.3.3.cmml" xref="S3.SS3.p1.6.m6.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.3.1.cmml" xref="S3.SS3.p1.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.3.2.cmml" xref="S3.SS3.p1.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS3.p1.6.m6.1.1.3.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3.3"><times id="S3.SS3.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS3.p1.6.m6.1.1.3.3.1"></times><cn type="integer" id="S3.SS3.p1.6.m6.1.1.3.3.2.cmml" xref="S3.SS3.p1.6.m6.1.1.3.3.2">4</cn><cn type="integer" id="S3.SS3.p1.6.m6.1.1.3.3.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3.3.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">g_{i-1}\in{\mathbb{R}}^{4\times 4}</annotation></semantics></math>, <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="g_{i}\in{\mathbb{R}}^{4\times 4}" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mrow id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><msub id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2.2" xref="S3.SS3.p1.7.m7.1.1.2.2.cmml">g</mi><mi id="S3.SS3.p1.7.m7.1.1.2.3" xref="S3.SS3.p1.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.p1.7.m7.1.1.1" xref="S3.SS3.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml"><mi id="S3.SS3.p1.7.m7.1.1.3.2" xref="S3.SS3.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.7.m7.1.1.3.3" xref="S3.SS3.p1.7.m7.1.1.3.3.cmml"><mn id="S3.SS3.p1.7.m7.1.1.3.3.2" xref="S3.SS3.p1.7.m7.1.1.3.3.2.cmml">4</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.7.m7.1.1.3.3.1" xref="S3.SS3.p1.7.m7.1.1.3.3.1.cmml">×</mo><mn id="S3.SS3.p1.7.m7.1.1.3.3.3" xref="S3.SS3.p1.7.m7.1.1.3.3.3.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><in id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1"></in><apply id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.2.1.cmml" xref="S3.SS3.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2.2">𝑔</ci><ci id="S3.SS3.p1.7.m7.1.1.2.3.cmml" xref="S3.SS3.p1.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.3.1.cmml" xref="S3.SS3.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.3.2.cmml" xref="S3.SS3.p1.7.m7.1.1.3.2">ℝ</ci><apply id="S3.SS3.p1.7.m7.1.1.3.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3.3"><times id="S3.SS3.p1.7.m7.1.1.3.3.1.cmml" xref="S3.SS3.p1.7.m7.1.1.3.3.1"></times><cn type="integer" id="S3.SS3.p1.7.m7.1.1.3.3.2.cmml" xref="S3.SS3.p1.7.m7.1.1.3.3.2">4</cn><cn type="integer" id="S3.SS3.p1.7.m7.1.1.3.3.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3.3.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">g_{i}\in{\mathbb{R}}^{4\times 4}</annotation></semantics></math>. To alleviate this misalignment issue, we need to calibrate the history BEV maps <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="I_{i-1}" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><msub id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><mi id="S3.SS3.p1.8.m8.1.1.2" xref="S3.SS3.p1.8.m8.1.1.2.cmml">I</mi><mrow id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml"><mi id="S3.SS3.p1.8.m8.1.1.3.2" xref="S3.SS3.p1.8.m8.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p1.8.m8.1.1.3.1" xref="S3.SS3.p1.8.m8.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p1.8.m8.1.1.3.3" xref="S3.SS3.p1.8.m8.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2">𝐼</ci><apply id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3"><minus id="S3.SS3.p1.8.m8.1.1.3.1.cmml" xref="S3.SS3.p1.8.m8.1.1.3.1"></minus><ci id="S3.SS3.p1.8.m8.1.1.3.2.cmml" xref="S3.SS3.p1.8.m8.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p1.8.m8.1.1.3.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">I_{i-1}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<table id="S5.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E2.m1.12" class="ltx_Math" alttext="\displaystyle\begin{split}I_{i-1}\circ g^{-1}_{i-1}\circ g_{i}\mapsto\tilde{I}_{i-1}\end{split}" display="inline"><semantics id="S3.E2.m1.12a"><mtable id="S3.E2.m1.12.12a" xref="S3.E2.m1.12.13.1.cmml"><mtr id="S3.E2.m1.12.12aa" xref="S3.E2.m1.12.13.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.12.12ab" xref="S3.E2.m1.12.13.1.cmml"><mrow id="S3.E2.m1.12.12.12.12.12a" xref="S3.E2.m1.12.13.1.cmml"><mrow id="S3.E2.m1.12.12.12.12.12a.13" xref="S3.E2.m1.12.13.1.cmml"><msub id="S3.E2.m1.12.12.12.12.12a.13.1" xref="S3.E2.m1.12.13.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">I</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.2.2.1.2.cmml">i</mi><mo id="S3.E2.m1.2.2.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.2.2.1.1.cmml">−</mo><mn id="S3.E2.m1.2.2.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.7.7.7.7.7.7" xref="S3.E2.m1.7.7.7.7.7.7.cmml">∘</mo><msubsup id="S3.E2.m1.12.12.12.12.12a.13.2" xref="S3.E2.m1.12.13.1.cmml"><mi id="S3.E2.m1.4.4.4.4.4.4" xref="S3.E2.m1.4.4.4.4.4.4.cmml">g</mi><mrow id="S3.E2.m1.6.6.6.6.6.6.1" xref="S3.E2.m1.6.6.6.6.6.6.1.cmml"><mi id="S3.E2.m1.6.6.6.6.6.6.1.2" xref="S3.E2.m1.6.6.6.6.6.6.1.2.cmml">i</mi><mo id="S3.E2.m1.6.6.6.6.6.6.1.1" xref="S3.E2.m1.6.6.6.6.6.6.1.1.cmml">−</mo><mn id="S3.E2.m1.6.6.6.6.6.6.1.3" xref="S3.E2.m1.6.6.6.6.6.6.1.3.cmml">1</mn></mrow><mrow id="S3.E2.m1.5.5.5.5.5.5.1" xref="S3.E2.m1.5.5.5.5.5.5.1.cmml"><mo id="S3.E2.m1.5.5.5.5.5.5.1a" xref="S3.E2.m1.5.5.5.5.5.5.1.cmml">−</mo><mn id="S3.E2.m1.5.5.5.5.5.5.1.2" xref="S3.E2.m1.5.5.5.5.5.5.1.2.cmml">1</mn></mrow></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.7.7.7.7.7.7a" xref="S3.E2.m1.7.7.7.7.7.7.cmml">∘</mo><msub id="S3.E2.m1.12.12.12.12.12a.13.3" xref="S3.E2.m1.12.13.1.cmml"><mi id="S3.E2.m1.8.8.8.8.8.8" xref="S3.E2.m1.8.8.8.8.8.8.cmml">g</mi><mi id="S3.E2.m1.9.9.9.9.9.9.1" xref="S3.E2.m1.9.9.9.9.9.9.1.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E2.m1.10.10.10.10.10.10" xref="S3.E2.m1.10.10.10.10.10.10.cmml">↦</mo><msub id="S3.E2.m1.12.12.12.12.12a.14" xref="S3.E2.m1.12.13.1.cmml"><mover accent="true" id="S3.E2.m1.11.11.11.11.11.11" xref="S3.E2.m1.11.11.11.11.11.11.cmml"><mi id="S3.E2.m1.11.11.11.11.11.11.2" xref="S3.E2.m1.11.11.11.11.11.11.2.cmml">I</mi><mo id="S3.E2.m1.11.11.11.11.11.11.1" xref="S3.E2.m1.11.11.11.11.11.11.1.cmml">~</mo></mover><mrow id="S3.E2.m1.12.12.12.12.12.12.1" xref="S3.E2.m1.12.12.12.12.12.12.1.cmml"><mi id="S3.E2.m1.12.12.12.12.12.12.1.2" xref="S3.E2.m1.12.12.12.12.12.12.1.2.cmml">i</mi><mo id="S3.E2.m1.12.12.12.12.12.12.1.1" xref="S3.E2.m1.12.12.12.12.12.12.1.1.cmml">−</mo><mn id="S3.E2.m1.12.12.12.12.12.12.1.3" xref="S3.E2.m1.12.12.12.12.12.12.1.3.cmml">1</mn></mrow></msub></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E2.m1.12b"><apply id="S3.E2.m1.12.13.1.cmml" xref="S3.E2.m1.12.12a"><csymbol cd="latexml" id="S3.E2.m1.10.10.10.10.10.10.cmml" xref="S3.E2.m1.10.10.10.10.10.10">maps-to</csymbol><apply id="S3.E2.m1.12.13.1.2.cmml" xref="S3.E2.m1.12.12a"><compose id="S3.E2.m1.7.7.7.7.7.7.cmml" xref="S3.E2.m1.7.7.7.7.7.7"></compose><apply id="S3.E2.m1.12.13.1.2.2.cmml" xref="S3.E2.m1.12.12a"><csymbol cd="ambiguous" id="S3.E2.m1.12.13.1.2.2.1.cmml" xref="S3.E2.m1.12.12a">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">𝐼</ci><apply id="S3.E2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1"><minus id="S3.E2.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.1"></minus><ci id="S3.E2.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2">𝑖</ci><cn type="integer" id="S3.E2.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.3">1</cn></apply></apply><apply id="S3.E2.m1.12.13.1.2.3.cmml" xref="S3.E2.m1.12.12a"><csymbol cd="ambiguous" id="S3.E2.m1.12.13.1.2.3.1.cmml" xref="S3.E2.m1.12.12a">subscript</csymbol><apply id="S3.E2.m1.12.13.1.2.3.2.cmml" xref="S3.E2.m1.12.12a"><csymbol cd="ambiguous" id="S3.E2.m1.12.13.1.2.3.2.1.cmml" xref="S3.E2.m1.12.12a">superscript</csymbol><ci id="S3.E2.m1.4.4.4.4.4.4.cmml" xref="S3.E2.m1.4.4.4.4.4.4">𝑔</ci><apply id="S3.E2.m1.5.5.5.5.5.5.1.cmml" xref="S3.E2.m1.5.5.5.5.5.5.1"><minus id="S3.E2.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E2.m1.5.5.5.5.5.5.1"></minus><cn type="integer" id="S3.E2.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.E2.m1.5.5.5.5.5.5.1.2">1</cn></apply></apply><apply id="S3.E2.m1.6.6.6.6.6.6.1.cmml" xref="S3.E2.m1.6.6.6.6.6.6.1"><minus id="S3.E2.m1.6.6.6.6.6.6.1.1.cmml" xref="S3.E2.m1.6.6.6.6.6.6.1.1"></minus><ci id="S3.E2.m1.6.6.6.6.6.6.1.2.cmml" xref="S3.E2.m1.6.6.6.6.6.6.1.2">𝑖</ci><cn type="integer" id="S3.E2.m1.6.6.6.6.6.6.1.3.cmml" xref="S3.E2.m1.6.6.6.6.6.6.1.3">1</cn></apply></apply><apply id="S3.E2.m1.12.13.1.2.4.cmml" xref="S3.E2.m1.12.12a"><csymbol cd="ambiguous" id="S3.E2.m1.12.13.1.2.4.1.cmml" xref="S3.E2.m1.12.12a">subscript</csymbol><ci id="S3.E2.m1.8.8.8.8.8.8.cmml" xref="S3.E2.m1.8.8.8.8.8.8">𝑔</ci><ci id="S3.E2.m1.9.9.9.9.9.9.1.cmml" xref="S3.E2.m1.9.9.9.9.9.9.1">𝑖</ci></apply></apply><apply id="S3.E2.m1.12.13.1.3.cmml" xref="S3.E2.m1.12.12a"><csymbol cd="ambiguous" id="S3.E2.m1.12.13.1.3.1.cmml" xref="S3.E2.m1.12.12a">subscript</csymbol><apply id="S3.E2.m1.11.11.11.11.11.11.cmml" xref="S3.E2.m1.11.11.11.11.11.11"><ci id="S3.E2.m1.11.11.11.11.11.11.1.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1">~</ci><ci id="S3.E2.m1.11.11.11.11.11.11.2.cmml" xref="S3.E2.m1.11.11.11.11.11.11.2">𝐼</ci></apply><apply id="S3.E2.m1.12.12.12.12.12.12.1.cmml" xref="S3.E2.m1.12.12.12.12.12.12.1"><minus id="S3.E2.m1.12.12.12.12.12.12.1.1.cmml" xref="S3.E2.m1.12.12.12.12.12.12.1.1"></minus><ci id="S3.E2.m1.12.12.12.12.12.12.1.2.cmml" xref="S3.E2.m1.12.12.12.12.12.12.1.2">𝑖</ci><cn type="integer" id="S3.E2.m1.12.12.12.12.12.12.1.3.cmml" xref="S3.E2.m1.12.12.12.12.12.12.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.12c">\displaystyle\begin{split}I_{i-1}\circ g^{-1}_{i-1}\circ g_{i}\mapsto\tilde{I}_{i-1}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.2" class="ltx_p">here <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\circ" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mo id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><compose id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\circ</annotation></semantics></math> means applying vehicle coordinates transformation and <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\tilde{I}_{i-1}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mover accent="true" id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2.2" xref="S3.SS3.p3.2.m2.1.1.2.2.cmml">I</mi><mo id="S3.SS3.p3.2.m2.1.1.2.1" xref="S3.SS3.p3.2.m2.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.2.m2.1.1.3.1" xref="S3.SS3.p3.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p3.2.m2.1.1.3.3" xref="S3.SS3.p3.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2"><ci id="S3.SS3.p3.2.m2.1.1.2.1.cmml" xref="S3.SS3.p3.2.m2.1.1.2.1">~</ci><ci id="S3.SS3.p3.2.m2.1.1.2.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2.2">𝐼</ci></apply><apply id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3"><minus id="S3.SS3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1"></minus><ci id="S3.SS3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p3.2.m2.1.1.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\tilde{I}_{i-1}</annotation></semantics></math> represents the calibrated BEV maps.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.11" class="ltx_p">However, in practice if we apply forward calibration upon <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="I_{i-1}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><msub id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">I</mi><mrow id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p4.1.m1.1.1.3.1" xref="S3.SS3.p4.1.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p4.1.m1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝐼</ci><apply id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3"><minus id="S3.SS3.p4.1.m1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3.1"></minus><ci id="S3.SS3.p4.1.m1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p4.1.m1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">I_{i-1}</annotation></semantics></math> we might get more than one pillars that fall into the same discrete coordinates within <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="\tilde{I}_{i-1}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msub id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mover accent="true" id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2.2" xref="S3.SS3.p4.2.m2.1.1.2.2.cmml">I</mi><mo id="S3.SS3.p4.2.m2.1.1.2.1" xref="S3.SS3.p4.2.m2.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.2" xref="S3.SS3.p4.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p4.2.m2.1.1.3.1" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p4.2.m2.1.1.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2"><ci id="S3.SS3.p4.2.m2.1.1.2.1.cmml" xref="S3.SS3.p4.2.m2.1.1.2.1">~</ci><ci id="S3.SS3.p4.2.m2.1.1.2.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2.2">𝐼</ci></apply><apply id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3"><minus id="S3.SS3.p4.2.m2.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.1"></minus><ci id="S3.SS3.p4.2.m2.1.1.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p4.2.m2.1.1.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\tilde{I}_{i-1}</annotation></semantics></math>. To address this issue we conduct inverse transformation from <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="\tilde{I}_{i-1}" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><msub id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml"><mover accent="true" id="S3.SS3.p4.3.m3.1.1.2" xref="S3.SS3.p4.3.m3.1.1.2.cmml"><mi id="S3.SS3.p4.3.m3.1.1.2.2" xref="S3.SS3.p4.3.m3.1.1.2.2.cmml">I</mi><mo id="S3.SS3.p4.3.m3.1.1.2.1" xref="S3.SS3.p4.3.m3.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.3.m3.1.1.3" xref="S3.SS3.p4.3.m3.1.1.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.2" xref="S3.SS3.p4.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p4.3.m3.1.1.3.1" xref="S3.SS3.p4.3.m3.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p4.3.m3.1.1.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><apply id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2"><ci id="S3.SS3.p4.3.m3.1.1.2.1.cmml" xref="S3.SS3.p4.3.m3.1.1.2.1">~</ci><ci id="S3.SS3.p4.3.m3.1.1.2.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2.2">𝐼</ci></apply><apply id="S3.SS3.p4.3.m3.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3"><minus id="S3.SS3.p4.3.m3.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3.1"></minus><ci id="S3.SS3.p4.3.m3.1.1.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p4.3.m3.1.1.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">\tilde{I}_{i-1}</annotation></semantics></math> to <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="I_{i-1}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><msub id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><mi id="S3.SS3.p4.4.m4.1.1.2" xref="S3.SS3.p4.4.m4.1.1.2.cmml">I</mi><mrow id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.2" xref="S3.SS3.p4.4.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p4.4.m4.1.1.3.1" xref="S3.SS3.p4.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p4.4.m4.1.1.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2">𝐼</ci><apply id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3"><minus id="S3.SS3.p4.4.m4.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.1"></minus><ci id="S3.SS3.p4.4.m4.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p4.4.m4.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">I_{i-1}</annotation></semantics></math> and sample the history BEV features. We use zero padding to fill in the pillar features of empty samples and also for out-of-view locations, <span id="S3.SS3.p4.11.1" class="ltx_text ltx_font_italic">e</span>.<span id="S3.SS3.p4.11.2" class="ltx_text ltx_font_italic">g</span>. red cross markers in <a href="#S3.F2" title="Figure 2 ‣ III-A Problem Statement ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>.
The inversely calibrated history maps now can be aligned with current maps by feature concatenation <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="\tilde{I}_{i-1}\oplus I^{{}^{\prime}}_{i}\mapsto J_{i}\in{\mathbb{R}}^{H\times W\times 2d}" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><mrow id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml"><mrow id="S3.SS3.p4.5.m5.1.1.2" xref="S3.SS3.p4.5.m5.1.1.2.cmml"><msub id="S3.SS3.p4.5.m5.1.1.2.2" xref="S3.SS3.p4.5.m5.1.1.2.2.cmml"><mover accent="true" id="S3.SS3.p4.5.m5.1.1.2.2.2" xref="S3.SS3.p4.5.m5.1.1.2.2.2.cmml"><mi id="S3.SS3.p4.5.m5.1.1.2.2.2.2" xref="S3.SS3.p4.5.m5.1.1.2.2.2.2.cmml">I</mi><mo id="S3.SS3.p4.5.m5.1.1.2.2.2.1" xref="S3.SS3.p4.5.m5.1.1.2.2.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.5.m5.1.1.2.2.3" xref="S3.SS3.p4.5.m5.1.1.2.2.3.cmml"><mi id="S3.SS3.p4.5.m5.1.1.2.2.3.2" xref="S3.SS3.p4.5.m5.1.1.2.2.3.2.cmml">i</mi><mo id="S3.SS3.p4.5.m5.1.1.2.2.3.1" xref="S3.SS3.p4.5.m5.1.1.2.2.3.1.cmml">−</mo><mn id="S3.SS3.p4.5.m5.1.1.2.2.3.3" xref="S3.SS3.p4.5.m5.1.1.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p4.5.m5.1.1.2.1" xref="S3.SS3.p4.5.m5.1.1.2.1.cmml">⊕</mo><msubsup id="S3.SS3.p4.5.m5.1.1.2.3" xref="S3.SS3.p4.5.m5.1.1.2.3.cmml"><mi id="S3.SS3.p4.5.m5.1.1.2.3.2.2" xref="S3.SS3.p4.5.m5.1.1.2.3.2.2.cmml">I</mi><mi id="S3.SS3.p4.5.m5.1.1.2.3.3" xref="S3.SS3.p4.5.m5.1.1.2.3.3.cmml">i</mi><msup id="S3.SS3.p4.5.m5.1.1.2.3.2.3" xref="S3.SS3.p4.5.m5.1.1.2.3.2.3.cmml"><mi id="S3.SS3.p4.5.m5.1.1.2.3.2.3a" xref="S3.SS3.p4.5.m5.1.1.2.3.2.3.cmml"></mi><mo id="S3.SS3.p4.5.m5.1.1.2.3.2.3.1" xref="S3.SS3.p4.5.m5.1.1.2.3.2.3.1.cmml">′</mo></msup></msubsup></mrow><mo stretchy="false" id="S3.SS3.p4.5.m5.1.1.3" xref="S3.SS3.p4.5.m5.1.1.3.cmml">↦</mo><msub id="S3.SS3.p4.5.m5.1.1.4" xref="S3.SS3.p4.5.m5.1.1.4.cmml"><mi id="S3.SS3.p4.5.m5.1.1.4.2" xref="S3.SS3.p4.5.m5.1.1.4.2.cmml">J</mi><mi id="S3.SS3.p4.5.m5.1.1.4.3" xref="S3.SS3.p4.5.m5.1.1.4.3.cmml">i</mi></msub><mo id="S3.SS3.p4.5.m5.1.1.5" xref="S3.SS3.p4.5.m5.1.1.5.cmml">∈</mo><msup id="S3.SS3.p4.5.m5.1.1.6" xref="S3.SS3.p4.5.m5.1.1.6.cmml"><mi id="S3.SS3.p4.5.m5.1.1.6.2" xref="S3.SS3.p4.5.m5.1.1.6.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.5.m5.1.1.6.3" xref="S3.SS3.p4.5.m5.1.1.6.3.cmml"><mrow id="S3.SS3.p4.5.m5.1.1.6.3.2" xref="S3.SS3.p4.5.m5.1.1.6.3.2.cmml"><mi id="S3.SS3.p4.5.m5.1.1.6.3.2.2" xref="S3.SS3.p4.5.m5.1.1.6.3.2.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.5.m5.1.1.6.3.2.1" xref="S3.SS3.p4.5.m5.1.1.6.3.2.1.cmml">×</mo><mi id="S3.SS3.p4.5.m5.1.1.6.3.2.3" xref="S3.SS3.p4.5.m5.1.1.6.3.2.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.5.m5.1.1.6.3.2.1a" xref="S3.SS3.p4.5.m5.1.1.6.3.2.1.cmml">×</mo><mn id="S3.SS3.p4.5.m5.1.1.6.3.2.4" xref="S3.SS3.p4.5.m5.1.1.6.3.2.4.cmml">2</mn></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p4.5.m5.1.1.6.3.1" xref="S3.SS3.p4.5.m5.1.1.6.3.1.cmml">​</mo><mi id="S3.SS3.p4.5.m5.1.1.6.3.3" xref="S3.SS3.p4.5.m5.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><apply id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1"><and id="S3.SS3.p4.5.m5.1.1a.cmml" xref="S3.SS3.p4.5.m5.1.1"></and><apply id="S3.SS3.p4.5.m5.1.1b.cmml" xref="S3.SS3.p4.5.m5.1.1"><csymbol cd="latexml" id="S3.SS3.p4.5.m5.1.1.3.cmml" xref="S3.SS3.p4.5.m5.1.1.3">maps-to</csymbol><apply id="S3.SS3.p4.5.m5.1.1.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2"><csymbol cd="latexml" id="S3.SS3.p4.5.m5.1.1.2.1.cmml" xref="S3.SS3.p4.5.m5.1.1.2.1">direct-sum</csymbol><apply id="S3.SS3.p4.5.m5.1.1.2.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.2.2.1.cmml" xref="S3.SS3.p4.5.m5.1.1.2.2">subscript</csymbol><apply id="S3.SS3.p4.5.m5.1.1.2.2.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2.2.2"><ci id="S3.SS3.p4.5.m5.1.1.2.2.2.1.cmml" xref="S3.SS3.p4.5.m5.1.1.2.2.2.1">~</ci><ci id="S3.SS3.p4.5.m5.1.1.2.2.2.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2.2.2.2">𝐼</ci></apply><apply id="S3.SS3.p4.5.m5.1.1.2.2.3.cmml" xref="S3.SS3.p4.5.m5.1.1.2.2.3"><minus id="S3.SS3.p4.5.m5.1.1.2.2.3.1.cmml" xref="S3.SS3.p4.5.m5.1.1.2.2.3.1"></minus><ci id="S3.SS3.p4.5.m5.1.1.2.2.3.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p4.5.m5.1.1.2.2.3.3.cmml" xref="S3.SS3.p4.5.m5.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.SS3.p4.5.m5.1.1.2.3.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.2.3.1.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3">subscript</csymbol><apply id="S3.SS3.p4.5.m5.1.1.2.3.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.2.3.2.1.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3">superscript</csymbol><ci id="S3.SS3.p4.5.m5.1.1.2.3.2.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3.2.2">𝐼</ci><apply id="S3.SS3.p4.5.m5.1.1.2.3.2.3.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3.2.3"><ci id="S3.SS3.p4.5.m5.1.1.2.3.2.3.1.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3.2.3.1">′</ci></apply></apply><ci id="S3.SS3.p4.5.m5.1.1.2.3.3.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS3.p4.5.m5.1.1.4.cmml" xref="S3.SS3.p4.5.m5.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.4.1.cmml" xref="S3.SS3.p4.5.m5.1.1.4">subscript</csymbol><ci id="S3.SS3.p4.5.m5.1.1.4.2.cmml" xref="S3.SS3.p4.5.m5.1.1.4.2">𝐽</ci><ci id="S3.SS3.p4.5.m5.1.1.4.3.cmml" xref="S3.SS3.p4.5.m5.1.1.4.3">𝑖</ci></apply></apply><apply id="S3.SS3.p4.5.m5.1.1c.cmml" xref="S3.SS3.p4.5.m5.1.1"><in id="S3.SS3.p4.5.m5.1.1.5.cmml" xref="S3.SS3.p4.5.m5.1.1.5"></in><share href="#S3.SS3.p4.5.m5.1.1.4.cmml" id="S3.SS3.p4.5.m5.1.1d.cmml" xref="S3.SS3.p4.5.m5.1.1"></share><apply id="S3.SS3.p4.5.m5.1.1.6.cmml" xref="S3.SS3.p4.5.m5.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.6.1.cmml" xref="S3.SS3.p4.5.m5.1.1.6">superscript</csymbol><ci id="S3.SS3.p4.5.m5.1.1.6.2.cmml" xref="S3.SS3.p4.5.m5.1.1.6.2">ℝ</ci><apply id="S3.SS3.p4.5.m5.1.1.6.3.cmml" xref="S3.SS3.p4.5.m5.1.1.6.3"><times id="S3.SS3.p4.5.m5.1.1.6.3.1.cmml" xref="S3.SS3.p4.5.m5.1.1.6.3.1"></times><apply id="S3.SS3.p4.5.m5.1.1.6.3.2.cmml" xref="S3.SS3.p4.5.m5.1.1.6.3.2"><times id="S3.SS3.p4.5.m5.1.1.6.3.2.1.cmml" xref="S3.SS3.p4.5.m5.1.1.6.3.2.1"></times><ci id="S3.SS3.p4.5.m5.1.1.6.3.2.2.cmml" xref="S3.SS3.p4.5.m5.1.1.6.3.2.2">𝐻</ci><ci id="S3.SS3.p4.5.m5.1.1.6.3.2.3.cmml" xref="S3.SS3.p4.5.m5.1.1.6.3.2.3">𝑊</ci><cn type="integer" id="S3.SS3.p4.5.m5.1.1.6.3.2.4.cmml" xref="S3.SS3.p4.5.m5.1.1.6.3.2.4">2</cn></apply><ci id="S3.SS3.p4.5.m5.1.1.6.3.3.cmml" xref="S3.SS3.p4.5.m5.1.1.6.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">\tilde{I}_{i-1}\oplus I^{{}^{\prime}}_{i}\mapsto J_{i}\in{\mathbb{R}}^{H\times W\times 2d}</annotation></semantics></math>. Next, we apply a MLP on <math id="S3.SS3.p4.6.m6.1" class="ltx_Math" alttext="J_{i}" display="inline"><semantics id="S3.SS3.p4.6.m6.1a"><msub id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml"><mi id="S3.SS3.p4.6.m6.1.1.2" xref="S3.SS3.p4.6.m6.1.1.2.cmml">J</mi><mi id="S3.SS3.p4.6.m6.1.1.3" xref="S3.SS3.p4.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><apply id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p4.6.m6.1.1.2.cmml" xref="S3.SS3.p4.6.m6.1.1.2">𝐽</ci><ci id="S3.SS3.p4.6.m6.1.1.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">J_{i}</annotation></semantics></math> for dimension reduction (<span id="S3.SS3.p4.11.3" class="ltx_text ltx_font_italic">i</span>.<span id="S3.SS3.p4.11.4" class="ltx_text ltx_font_italic">e</span>., <math id="S3.SS3.p4.7.m7.1" class="ltx_Math" alttext="2d\mapsto d" display="inline"><semantics id="S3.SS3.p4.7.m7.1a"><mrow id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml"><mrow id="S3.SS3.p4.7.m7.1.1.2" xref="S3.SS3.p4.7.m7.1.1.2.cmml"><mn id="S3.SS3.p4.7.m7.1.1.2.2" xref="S3.SS3.p4.7.m7.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS3.p4.7.m7.1.1.2.1" xref="S3.SS3.p4.7.m7.1.1.2.1.cmml">​</mo><mi id="S3.SS3.p4.7.m7.1.1.2.3" xref="S3.SS3.p4.7.m7.1.1.2.3.cmml">d</mi></mrow><mo stretchy="false" id="S3.SS3.p4.7.m7.1.1.1" xref="S3.SS3.p4.7.m7.1.1.1.cmml">↦</mo><mi id="S3.SS3.p4.7.m7.1.1.3" xref="S3.SS3.p4.7.m7.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><apply id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1"><csymbol cd="latexml" id="S3.SS3.p4.7.m7.1.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1.1">maps-to</csymbol><apply id="S3.SS3.p4.7.m7.1.1.2.cmml" xref="S3.SS3.p4.7.m7.1.1.2"><times id="S3.SS3.p4.7.m7.1.1.2.1.cmml" xref="S3.SS3.p4.7.m7.1.1.2.1"></times><cn type="integer" id="S3.SS3.p4.7.m7.1.1.2.2.cmml" xref="S3.SS3.p4.7.m7.1.1.2.2">2</cn><ci id="S3.SS3.p4.7.m7.1.1.2.3.cmml" xref="S3.SS3.p4.7.m7.1.1.2.3">𝑑</ci></apply><ci id="S3.SS3.p4.7.m7.1.1.3.cmml" xref="S3.SS3.p4.7.m7.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">2d\mapsto d</annotation></semantics></math>) and get the temporally aligned pillar features <math id="S3.SS3.p4.8.m8.1" class="ltx_Math" alttext="J^{{}^{\prime}}_{i}" display="inline"><semantics id="S3.SS3.p4.8.m8.1a"><msubsup id="S3.SS3.p4.8.m8.1.1" xref="S3.SS3.p4.8.m8.1.1.cmml"><mi id="S3.SS3.p4.8.m8.1.1.2.2" xref="S3.SS3.p4.8.m8.1.1.2.2.cmml">J</mi><mi id="S3.SS3.p4.8.m8.1.1.3" xref="S3.SS3.p4.8.m8.1.1.3.cmml">i</mi><msup id="S3.SS3.p4.8.m8.1.1.2.3" xref="S3.SS3.p4.8.m8.1.1.2.3.cmml"><mi id="S3.SS3.p4.8.m8.1.1.2.3a" xref="S3.SS3.p4.8.m8.1.1.2.3.cmml"></mi><mo id="S3.SS3.p4.8.m8.1.1.2.3.1" xref="S3.SS3.p4.8.m8.1.1.2.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m8.1b"><apply id="S3.SS3.p4.8.m8.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1">subscript</csymbol><apply id="S3.SS3.p4.8.m8.1.1.2.cmml" xref="S3.SS3.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.1.2.1.cmml" xref="S3.SS3.p4.8.m8.1.1">superscript</csymbol><ci id="S3.SS3.p4.8.m8.1.1.2.2.cmml" xref="S3.SS3.p4.8.m8.1.1.2.2">𝐽</ci><apply id="S3.SS3.p4.8.m8.1.1.2.3.cmml" xref="S3.SS3.p4.8.m8.1.1.2.3"><ci id="S3.SS3.p4.8.m8.1.1.2.3.1.cmml" xref="S3.SS3.p4.8.m8.1.1.2.3.1">′</ci></apply></apply><ci id="S3.SS3.p4.8.m8.1.1.3.cmml" xref="S3.SS3.p4.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m8.1c">J^{{}^{\prime}}_{i}</annotation></semantics></math>. Note that not all the coordinates within <math id="S3.SS3.p4.9.m9.1" class="ltx_Math" alttext="J^{{}^{\prime}}_{i}" display="inline"><semantics id="S3.SS3.p4.9.m9.1a"><msubsup id="S3.SS3.p4.9.m9.1.1" xref="S3.SS3.p4.9.m9.1.1.cmml"><mi id="S3.SS3.p4.9.m9.1.1.2.2" xref="S3.SS3.p4.9.m9.1.1.2.2.cmml">J</mi><mi id="S3.SS3.p4.9.m9.1.1.3" xref="S3.SS3.p4.9.m9.1.1.3.cmml">i</mi><msup id="S3.SS3.p4.9.m9.1.1.2.3" xref="S3.SS3.p4.9.m9.1.1.2.3.cmml"><mi id="S3.SS3.p4.9.m9.1.1.2.3a" xref="S3.SS3.p4.9.m9.1.1.2.3.cmml"></mi><mo id="S3.SS3.p4.9.m9.1.1.2.3.1" xref="S3.SS3.p4.9.m9.1.1.2.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m9.1b"><apply id="S3.SS3.p4.9.m9.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1">subscript</csymbol><apply id="S3.SS3.p4.9.m9.1.1.2.cmml" xref="S3.SS3.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.1.2.1.cmml" xref="S3.SS3.p4.9.m9.1.1">superscript</csymbol><ci id="S3.SS3.p4.9.m9.1.1.2.2.cmml" xref="S3.SS3.p4.9.m9.1.1.2.2">𝐽</ci><apply id="S3.SS3.p4.9.m9.1.1.2.3.cmml" xref="S3.SS3.p4.9.m9.1.1.2.3"><ci id="S3.SS3.p4.9.m9.1.1.2.3.1.cmml" xref="S3.SS3.p4.9.m9.1.1.2.3.1">′</ci></apply></apply><ci id="S3.SS3.p4.9.m9.1.1.3.cmml" xref="S3.SS3.p4.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.9.m9.1c">J^{{}^{\prime}}_{i}</annotation></semantics></math> have valid features. We use the union BEV boolean mask <math id="S3.SS3.p4.10.m10.1" class="ltx_Math" alttext="O_{i}\in{\mathbb{R}}^{H\times W}" display="inline"><semantics id="S3.SS3.p4.10.m10.1a"><mrow id="S3.SS3.p4.10.m10.1.1" xref="S3.SS3.p4.10.m10.1.1.cmml"><msub id="S3.SS3.p4.10.m10.1.1.2" xref="S3.SS3.p4.10.m10.1.1.2.cmml"><mi id="S3.SS3.p4.10.m10.1.1.2.2" xref="S3.SS3.p4.10.m10.1.1.2.2.cmml">O</mi><mi id="S3.SS3.p4.10.m10.1.1.2.3" xref="S3.SS3.p4.10.m10.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.p4.10.m10.1.1.1" xref="S3.SS3.p4.10.m10.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.10.m10.1.1.3" xref="S3.SS3.p4.10.m10.1.1.3.cmml"><mi id="S3.SS3.p4.10.m10.1.1.3.2" xref="S3.SS3.p4.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.10.m10.1.1.3.3" xref="S3.SS3.p4.10.m10.1.1.3.3.cmml"><mi id="S3.SS3.p4.10.m10.1.1.3.3.2" xref="S3.SS3.p4.10.m10.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.10.m10.1.1.3.3.1" xref="S3.SS3.p4.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.10.m10.1.1.3.3.3" xref="S3.SS3.p4.10.m10.1.1.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.10.m10.1b"><apply id="S3.SS3.p4.10.m10.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1"><in id="S3.SS3.p4.10.m10.1.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1.1"></in><apply id="S3.SS3.p4.10.m10.1.1.2.cmml" xref="S3.SS3.p4.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.1.1.2.1.cmml" xref="S3.SS3.p4.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.10.m10.1.1.2.2.cmml" xref="S3.SS3.p4.10.m10.1.1.2.2">𝑂</ci><ci id="S3.SS3.p4.10.m10.1.1.2.3.cmml" xref="S3.SS3.p4.10.m10.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p4.10.m10.1.1.3.cmml" xref="S3.SS3.p4.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m10.1.1.3.1.cmml" xref="S3.SS3.p4.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.10.m10.1.1.3.2.cmml" xref="S3.SS3.p4.10.m10.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.10.m10.1.1.3.3.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3"><times id="S3.SS3.p4.10.m10.1.1.3.3.1.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3.1"></times><ci id="S3.SS3.p4.10.m10.1.1.3.3.2.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3.2">𝐻</ci><ci id="S3.SS3.p4.10.m10.1.1.3.3.3.cmml" xref="S3.SS3.p4.10.m10.1.1.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.10.m10.1c">O_{i}\in{\mathbb{R}}^{H\times W}</annotation></semantics></math> obtained from the current and calibrated history BEV features to mark valid coordinates of <math id="S3.SS3.p4.11.m11.1" class="ltx_Math" alttext="J^{{}^{\prime}}_{i}" display="inline"><semantics id="S3.SS3.p4.11.m11.1a"><msubsup id="S3.SS3.p4.11.m11.1.1" xref="S3.SS3.p4.11.m11.1.1.cmml"><mi id="S3.SS3.p4.11.m11.1.1.2.2" xref="S3.SS3.p4.11.m11.1.1.2.2.cmml">J</mi><mi id="S3.SS3.p4.11.m11.1.1.3" xref="S3.SS3.p4.11.m11.1.1.3.cmml">i</mi><msup id="S3.SS3.p4.11.m11.1.1.2.3" xref="S3.SS3.p4.11.m11.1.1.2.3.cmml"><mi id="S3.SS3.p4.11.m11.1.1.2.3a" xref="S3.SS3.p4.11.m11.1.1.2.3.cmml"></mi><mo id="S3.SS3.p4.11.m11.1.1.2.3.1" xref="S3.SS3.p4.11.m11.1.1.2.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.11.m11.1b"><apply id="S3.SS3.p4.11.m11.1.1.cmml" xref="S3.SS3.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m11.1.1.1.cmml" xref="S3.SS3.p4.11.m11.1.1">subscript</csymbol><apply id="S3.SS3.p4.11.m11.1.1.2.cmml" xref="S3.SS3.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m11.1.1.2.1.cmml" xref="S3.SS3.p4.11.m11.1.1">superscript</csymbol><ci id="S3.SS3.p4.11.m11.1.1.2.2.cmml" xref="S3.SS3.p4.11.m11.1.1.2.2">𝐽</ci><apply id="S3.SS3.p4.11.m11.1.1.2.3.cmml" xref="S3.SS3.p4.11.m11.1.1.2.3"><ci id="S3.SS3.p4.11.m11.1.1.2.3.1.cmml" xref="S3.SS3.p4.11.m11.1.1.2.3.1">′</ci></apply></apply><ci id="S3.SS3.p4.11.m11.1.1.3.cmml" xref="S3.SS3.p4.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.11.m11.1c">J^{{}^{\prime}}_{i}</annotation></semantics></math>. Thus, we do not lose the data sparsity.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.5.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.6.2" class="ltx_text ltx_font_italic">Window-based Attention Fusion</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.13" class="ltx_p">Pillars of the static objects are effectively aligned after the prior steps, but the moving ones are still facing the misalignment issue. One solution is to apply flow estimation to further calibration the history BEV features <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\tilde{I}_{i-1}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2.2" xref="S3.SS4.p1.1.m1.1.1.2.2.cmml">I</mi><mo id="S3.SS4.p1.1.m1.1.1.2.1" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS4.p1.1.m1.1.1.3.1" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2"><ci id="S3.SS4.p1.1.m1.1.1.2.1.cmml" xref="S3.SS4.p1.1.m1.1.1.2.1">~</ci><ci id="S3.SS4.p1.1.m1.1.1.2.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2.2">𝐼</ci></apply><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><minus id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.1"></minus><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\tilde{I}_{i-1}</annotation></semantics></math> before temporal alignment with <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="I^{{}^{\prime}}_{i}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msubsup id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2.2" xref="S3.SS4.p1.2.m2.1.1.2.2.cmml">I</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">i</mi><msup id="S3.SS4.p1.2.m2.1.1.2.3" xref="S3.SS4.p1.2.m2.1.1.2.3.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2.3a" xref="S3.SS4.p1.2.m2.1.1.2.3.cmml"></mi><mo id="S3.SS4.p1.2.m2.1.1.2.3.1" xref="S3.SS4.p1.2.m2.1.1.2.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.2.1.cmml" xref="S3.SS4.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2.2">𝐼</ci><apply id="S3.SS4.p1.2.m2.1.1.2.3.cmml" xref="S3.SS4.p1.2.m2.1.1.2.3"><ci id="S3.SS4.p1.2.m2.1.1.2.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.2.3.1">′</ci></apply></apply><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">I^{{}^{\prime}}_{i}</annotation></semantics></math>. But that requires adding additional occupancy flow models, losses and feature coordinates transformation, which might greatly increase the computation overhead of the 3D object detector. Therefore, we propose to learn such association implicitly from the data by window-based attention blocks. We sparsify the dense BEV feature map <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="J^{{}^{\prime}}_{i}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><msubsup id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2.2" xref="S3.SS4.p1.3.m3.1.1.2.2.cmml">J</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">i</mi><msup id="S3.SS4.p1.3.m3.1.1.2.3" xref="S3.SS4.p1.3.m3.1.1.2.3.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2.3a" xref="S3.SS4.p1.3.m3.1.1.2.3.cmml"></mi><mo id="S3.SS4.p1.3.m3.1.1.2.3.1" xref="S3.SS4.p1.3.m3.1.1.2.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.2.1.cmml" xref="S3.SS4.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2.2">𝐽</ci><apply id="S3.SS4.p1.3.m3.1.1.2.3.cmml" xref="S3.SS4.p1.3.m3.1.1.2.3"><ci id="S3.SS4.p1.3.m3.1.1.2.3.1.cmml" xref="S3.SS4.p1.3.m3.1.1.2.3.1">′</ci></apply></apply><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">J^{{}^{\prime}}_{i}</annotation></semantics></math> and its boolean mask <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="O_{i}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msub id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">O</mi><mi id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">𝑂</ci><ci id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">O_{i}</annotation></semantics></math> into a sparse set of pillar tokens <math id="S3.SS4.p1.5.m5.3" class="ltx_Math" alttext="\{V^{{}^{\prime\prime}}_{i,u}\}" display="inline"><semantics id="S3.SS4.p1.5.m5.3a"><mrow id="S3.SS4.p1.5.m5.3.3.1" xref="S3.SS4.p1.5.m5.3.3.2.cmml"><mo stretchy="false" id="S3.SS4.p1.5.m5.3.3.1.2" xref="S3.SS4.p1.5.m5.3.3.2.cmml">{</mo><msubsup id="S3.SS4.p1.5.m5.3.3.1.1" xref="S3.SS4.p1.5.m5.3.3.1.1.cmml"><mi id="S3.SS4.p1.5.m5.3.3.1.1.2.2" xref="S3.SS4.p1.5.m5.3.3.1.1.2.2.cmml">V</mi><mrow id="S3.SS4.p1.5.m5.2.2.2.4" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml"><mi id="S3.SS4.p1.5.m5.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS4.p1.5.m5.2.2.2.4.1" xref="S3.SS4.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p1.5.m5.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.2.cmml">u</mi></mrow><msup id="S3.SS4.p1.5.m5.3.3.1.1.2.3" xref="S3.SS4.p1.5.m5.3.3.1.1.2.3.cmml"><mi id="S3.SS4.p1.5.m5.3.3.1.1.2.3a" xref="S3.SS4.p1.5.m5.3.3.1.1.2.3.cmml"></mi><mo id="S3.SS4.p1.5.m5.3.3.1.1.2.3.1" xref="S3.SS4.p1.5.m5.3.3.1.1.2.3.1.cmml">′′</mo></msup></msubsup><mo stretchy="false" id="S3.SS4.p1.5.m5.3.3.1.3" xref="S3.SS4.p1.5.m5.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.3b"><set id="S3.SS4.p1.5.m5.3.3.2.cmml" xref="S3.SS4.p1.5.m5.3.3.1"><apply id="S3.SS4.p1.5.m5.3.3.1.1.cmml" xref="S3.SS4.p1.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS4.p1.5.m5.3.3.1.1">subscript</csymbol><apply id="S3.SS4.p1.5.m5.3.3.1.1.2.cmml" xref="S3.SS4.p1.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.3.3.1.1.2.1.cmml" xref="S3.SS4.p1.5.m5.3.3.1.1">superscript</csymbol><ci id="S3.SS4.p1.5.m5.3.3.1.1.2.2.cmml" xref="S3.SS4.p1.5.m5.3.3.1.1.2.2">𝑉</ci><apply id="S3.SS4.p1.5.m5.3.3.1.1.2.3.cmml" xref="S3.SS4.p1.5.m5.3.3.1.1.2.3"><ci id="S3.SS4.p1.5.m5.3.3.1.1.2.3.1.cmml" xref="S3.SS4.p1.5.m5.3.3.1.1.2.3.1">′′</ci></apply></apply><list id="S3.SS4.p1.5.m5.2.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.4"><ci id="S3.SS4.p1.5.m5.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1">𝑖</ci><ci id="S3.SS4.p1.5.m5.2.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2">𝑢</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.3c">\{V^{{}^{\prime\prime}}_{i,u}\}</annotation></semantics></math>, <math id="S3.SS4.p1.6.m6.3" class="ltx_Math" alttext="u=1,...,U_{i}" display="inline"><semantics id="S3.SS4.p1.6.m6.3a"><mrow id="S3.SS4.p1.6.m6.3.3" xref="S3.SS4.p1.6.m6.3.3.cmml"><mi id="S3.SS4.p1.6.m6.3.3.3" xref="S3.SS4.p1.6.m6.3.3.3.cmml">u</mi><mo id="S3.SS4.p1.6.m6.3.3.2" xref="S3.SS4.p1.6.m6.3.3.2.cmml">=</mo><mrow id="S3.SS4.p1.6.m6.3.3.1.1" xref="S3.SS4.p1.6.m6.3.3.1.2.cmml"><mn id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml">1</mn><mo id="S3.SS4.p1.6.m6.3.3.1.1.2" xref="S3.SS4.p1.6.m6.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p1.6.m6.2.2" xref="S3.SS4.p1.6.m6.2.2.cmml">…</mi><mo id="S3.SS4.p1.6.m6.3.3.1.1.3" xref="S3.SS4.p1.6.m6.3.3.1.2.cmml">,</mo><msub id="S3.SS4.p1.6.m6.3.3.1.1.1" xref="S3.SS4.p1.6.m6.3.3.1.1.1.cmml"><mi id="S3.SS4.p1.6.m6.3.3.1.1.1.2" xref="S3.SS4.p1.6.m6.3.3.1.1.1.2.cmml">U</mi><mi id="S3.SS4.p1.6.m6.3.3.1.1.1.3" xref="S3.SS4.p1.6.m6.3.3.1.1.1.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.3b"><apply id="S3.SS4.p1.6.m6.3.3.cmml" xref="S3.SS4.p1.6.m6.3.3"><eq id="S3.SS4.p1.6.m6.3.3.2.cmml" xref="S3.SS4.p1.6.m6.3.3.2"></eq><ci id="S3.SS4.p1.6.m6.3.3.3.cmml" xref="S3.SS4.p1.6.m6.3.3.3">𝑢</ci><list id="S3.SS4.p1.6.m6.3.3.1.2.cmml" xref="S3.SS4.p1.6.m6.3.3.1.1"><cn type="integer" id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">1</cn><ci id="S3.SS4.p1.6.m6.2.2.cmml" xref="S3.SS4.p1.6.m6.2.2">…</ci><apply id="S3.SS4.p1.6.m6.3.3.1.1.1.cmml" xref="S3.SS4.p1.6.m6.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.3.3.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.6.m6.3.3.1.1.1.2.cmml" xref="S3.SS4.p1.6.m6.3.3.1.1.1.2">𝑈</ci><ci id="S3.SS4.p1.6.m6.3.3.1.1.1.3.cmml" xref="S3.SS4.p1.6.m6.3.3.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.3c">u=1,...,U_{i}</annotation></semantics></math>. Usually we have <math id="S3.SS4.p1.7.m7.1" class="ltx_Math" alttext="U_{i}\geqslant N^{{}^{\prime}}_{i}" display="inline"><semantics id="S3.SS4.p1.7.m7.1a"><mrow id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml"><msub id="S3.SS4.p1.7.m7.1.1.2" xref="S3.SS4.p1.7.m7.1.1.2.cmml"><mi id="S3.SS4.p1.7.m7.1.1.2.2" xref="S3.SS4.p1.7.m7.1.1.2.2.cmml">U</mi><mi id="S3.SS4.p1.7.m7.1.1.2.3" xref="S3.SS4.p1.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p1.7.m7.1.1.1" xref="S3.SS4.p1.7.m7.1.1.1.cmml">⩾</mo><msubsup id="S3.SS4.p1.7.m7.1.1.3" xref="S3.SS4.p1.7.m7.1.1.3.cmml"><mi id="S3.SS4.p1.7.m7.1.1.3.2.2" xref="S3.SS4.p1.7.m7.1.1.3.2.2.cmml">N</mi><mi id="S3.SS4.p1.7.m7.1.1.3.3" xref="S3.SS4.p1.7.m7.1.1.3.3.cmml">i</mi><msup id="S3.SS4.p1.7.m7.1.1.3.2.3" xref="S3.SS4.p1.7.m7.1.1.3.2.3.cmml"><mi id="S3.SS4.p1.7.m7.1.1.3.2.3a" xref="S3.SS4.p1.7.m7.1.1.3.2.3.cmml"></mi><mo id="S3.SS4.p1.7.m7.1.1.3.2.3.1" xref="S3.SS4.p1.7.m7.1.1.3.2.3.1.cmml">′</mo></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1"><geq id="S3.SS4.p1.7.m7.1.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1.1"></geq><apply id="S3.SS4.p1.7.m7.1.1.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.2.1.cmml" xref="S3.SS4.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.7.m7.1.1.2.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2.2">𝑈</ci><ci id="S3.SS4.p1.7.m7.1.1.2.3.cmml" xref="S3.SS4.p1.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p1.7.m7.1.1.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.3.1.cmml" xref="S3.SS4.p1.7.m7.1.1.3">subscript</csymbol><apply id="S3.SS4.p1.7.m7.1.1.3.2.cmml" xref="S3.SS4.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.3.2.1.cmml" xref="S3.SS4.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.7.m7.1.1.3.2.2.cmml" xref="S3.SS4.p1.7.m7.1.1.3.2.2">𝑁</ci><apply id="S3.SS4.p1.7.m7.1.1.3.2.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3.2.3"><ci id="S3.SS4.p1.7.m7.1.1.3.2.3.1.cmml" xref="S3.SS4.p1.7.m7.1.1.3.2.3.1">′</ci></apply></apply><ci id="S3.SS4.p1.7.m7.1.1.3.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">U_{i}\geqslant N^{{}^{\prime}}_{i}</annotation></semantics></math>. Because the cardinality <math id="S3.SS4.p1.8.m8.1" class="ltx_Math" alttext="U_{i}" display="inline"><semantics id="S3.SS4.p1.8.m8.1a"><msub id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml"><mi id="S3.SS4.p1.8.m8.1.1.2" xref="S3.SS4.p1.8.m8.1.1.2.cmml">U</mi><mi id="S3.SS4.p1.8.m8.1.1.3" xref="S3.SS4.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><apply id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.1.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m8.1.1.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2">𝑈</ci><ci id="S3.SS4.p1.8.m8.1.1.3.cmml" xref="S3.SS4.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">U_{i}</annotation></semantics></math> means the number of fused pillars after temporal alignment between the history and current features through the steps in Section <a href="#S3.SS3" title="III-C Inverse Calibration and Alignment ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span></span></a>.
While <math id="S3.SS4.p1.9.m9.3" class="ltx_Math" alttext="\{V^{{}^{\prime\prime}}_{i,u}\}" display="inline"><semantics id="S3.SS4.p1.9.m9.3a"><mrow id="S3.SS4.p1.9.m9.3.3.1" xref="S3.SS4.p1.9.m9.3.3.2.cmml"><mo stretchy="false" id="S3.SS4.p1.9.m9.3.3.1.2" xref="S3.SS4.p1.9.m9.3.3.2.cmml">{</mo><msubsup id="S3.SS4.p1.9.m9.3.3.1.1" xref="S3.SS4.p1.9.m9.3.3.1.1.cmml"><mi id="S3.SS4.p1.9.m9.3.3.1.1.2.2" xref="S3.SS4.p1.9.m9.3.3.1.1.2.2.cmml">V</mi><mrow id="S3.SS4.p1.9.m9.2.2.2.4" xref="S3.SS4.p1.9.m9.2.2.2.3.cmml"><mi id="S3.SS4.p1.9.m9.1.1.1.1" xref="S3.SS4.p1.9.m9.1.1.1.1.cmml">i</mi><mo id="S3.SS4.p1.9.m9.2.2.2.4.1" xref="S3.SS4.p1.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p1.9.m9.2.2.2.2" xref="S3.SS4.p1.9.m9.2.2.2.2.cmml">u</mi></mrow><msup id="S3.SS4.p1.9.m9.3.3.1.1.2.3" xref="S3.SS4.p1.9.m9.3.3.1.1.2.3.cmml"><mi id="S3.SS4.p1.9.m9.3.3.1.1.2.3a" xref="S3.SS4.p1.9.m9.3.3.1.1.2.3.cmml"></mi><mo id="S3.SS4.p1.9.m9.3.3.1.1.2.3.1" xref="S3.SS4.p1.9.m9.3.3.1.1.2.3.1.cmml">′′</mo></msup></msubsup><mo stretchy="false" id="S3.SS4.p1.9.m9.3.3.1.3" xref="S3.SS4.p1.9.m9.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.3b"><set id="S3.SS4.p1.9.m9.3.3.2.cmml" xref="S3.SS4.p1.9.m9.3.3.1"><apply id="S3.SS4.p1.9.m9.3.3.1.1.cmml" xref="S3.SS4.p1.9.m9.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.3.3.1.1.1.cmml" xref="S3.SS4.p1.9.m9.3.3.1.1">subscript</csymbol><apply id="S3.SS4.p1.9.m9.3.3.1.1.2.cmml" xref="S3.SS4.p1.9.m9.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.3.3.1.1.2.1.cmml" xref="S3.SS4.p1.9.m9.3.3.1.1">superscript</csymbol><ci id="S3.SS4.p1.9.m9.3.3.1.1.2.2.cmml" xref="S3.SS4.p1.9.m9.3.3.1.1.2.2">𝑉</ci><apply id="S3.SS4.p1.9.m9.3.3.1.1.2.3.cmml" xref="S3.SS4.p1.9.m9.3.3.1.1.2.3"><ci id="S3.SS4.p1.9.m9.3.3.1.1.2.3.1.cmml" xref="S3.SS4.p1.9.m9.3.3.1.1.2.3.1">′′</ci></apply></apply><list id="S3.SS4.p1.9.m9.2.2.2.3.cmml" xref="S3.SS4.p1.9.m9.2.2.2.4"><ci id="S3.SS4.p1.9.m9.1.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1.1.1">𝑖</ci><ci id="S3.SS4.p1.9.m9.2.2.2.2.cmml" xref="S3.SS4.p1.9.m9.2.2.2.2">𝑢</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.3c">\{V^{{}^{\prime\prime}}_{i,u}\}</annotation></semantics></math> is used as the query tensor for the attention blocks, we can make different choices when determining the key and value tensors: using <math id="S3.SS4.p1.10.m10.3" class="ltx_Math" alttext="\{V^{{}^{\prime\prime}}_{i,u}\}" display="inline"><semantics id="S3.SS4.p1.10.m10.3a"><mrow id="S3.SS4.p1.10.m10.3.3.1" xref="S3.SS4.p1.10.m10.3.3.2.cmml"><mo stretchy="false" id="S3.SS4.p1.10.m10.3.3.1.2" xref="S3.SS4.p1.10.m10.3.3.2.cmml">{</mo><msubsup id="S3.SS4.p1.10.m10.3.3.1.1" xref="S3.SS4.p1.10.m10.3.3.1.1.cmml"><mi id="S3.SS4.p1.10.m10.3.3.1.1.2.2" xref="S3.SS4.p1.10.m10.3.3.1.1.2.2.cmml">V</mi><mrow id="S3.SS4.p1.10.m10.2.2.2.4" xref="S3.SS4.p1.10.m10.2.2.2.3.cmml"><mi id="S3.SS4.p1.10.m10.1.1.1.1" xref="S3.SS4.p1.10.m10.1.1.1.1.cmml">i</mi><mo id="S3.SS4.p1.10.m10.2.2.2.4.1" xref="S3.SS4.p1.10.m10.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p1.10.m10.2.2.2.2" xref="S3.SS4.p1.10.m10.2.2.2.2.cmml">u</mi></mrow><msup id="S3.SS4.p1.10.m10.3.3.1.1.2.3" xref="S3.SS4.p1.10.m10.3.3.1.1.2.3.cmml"><mi id="S3.SS4.p1.10.m10.3.3.1.1.2.3a" xref="S3.SS4.p1.10.m10.3.3.1.1.2.3.cmml"></mi><mo id="S3.SS4.p1.10.m10.3.3.1.1.2.3.1" xref="S3.SS4.p1.10.m10.3.3.1.1.2.3.1.cmml">′′</mo></msup></msubsup><mo stretchy="false" id="S3.SS4.p1.10.m10.3.3.1.3" xref="S3.SS4.p1.10.m10.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.3b"><set id="S3.SS4.p1.10.m10.3.3.2.cmml" xref="S3.SS4.p1.10.m10.3.3.1"><apply id="S3.SS4.p1.10.m10.3.3.1.1.cmml" xref="S3.SS4.p1.10.m10.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.3.3.1.1.1.cmml" xref="S3.SS4.p1.10.m10.3.3.1.1">subscript</csymbol><apply id="S3.SS4.p1.10.m10.3.3.1.1.2.cmml" xref="S3.SS4.p1.10.m10.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.3.3.1.1.2.1.cmml" xref="S3.SS4.p1.10.m10.3.3.1.1">superscript</csymbol><ci id="S3.SS4.p1.10.m10.3.3.1.1.2.2.cmml" xref="S3.SS4.p1.10.m10.3.3.1.1.2.2">𝑉</ci><apply id="S3.SS4.p1.10.m10.3.3.1.1.2.3.cmml" xref="S3.SS4.p1.10.m10.3.3.1.1.2.3"><ci id="S3.SS4.p1.10.m10.3.3.1.1.2.3.1.cmml" xref="S3.SS4.p1.10.m10.3.3.1.1.2.3.1">′′</ci></apply></apply><list id="S3.SS4.p1.10.m10.2.2.2.3.cmml" xref="S3.SS4.p1.10.m10.2.2.2.4"><ci id="S3.SS4.p1.10.m10.1.1.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1.1.1">𝑖</ci><ci id="S3.SS4.p1.10.m10.2.2.2.2.cmml" xref="S3.SS4.p1.10.m10.2.2.2.2">𝑢</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.3c">\{V^{{}^{\prime\prime}}_{i,u}\}</annotation></semantics></math> again or the sparsified set of history pillar tokens in (<a href="#S3.E2" title="In III-C Inverse Calibration and Alignment ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>):
<math id="S3.SS4.p1.11.m11.3" class="ltx_Math" alttext="\tilde{I}_{i-1}\mapsto\{\tilde{V}_{i-1,c}\}" display="inline"><semantics id="S3.SS4.p1.11.m11.3a"><mrow id="S3.SS4.p1.11.m11.3.3" xref="S3.SS4.p1.11.m11.3.3.cmml"><msub id="S3.SS4.p1.11.m11.3.3.3" xref="S3.SS4.p1.11.m11.3.3.3.cmml"><mover accent="true" id="S3.SS4.p1.11.m11.3.3.3.2" xref="S3.SS4.p1.11.m11.3.3.3.2.cmml"><mi id="S3.SS4.p1.11.m11.3.3.3.2.2" xref="S3.SS4.p1.11.m11.3.3.3.2.2.cmml">I</mi><mo id="S3.SS4.p1.11.m11.3.3.3.2.1" xref="S3.SS4.p1.11.m11.3.3.3.2.1.cmml">~</mo></mover><mrow id="S3.SS4.p1.11.m11.3.3.3.3" xref="S3.SS4.p1.11.m11.3.3.3.3.cmml"><mi id="S3.SS4.p1.11.m11.3.3.3.3.2" xref="S3.SS4.p1.11.m11.3.3.3.3.2.cmml">i</mi><mo id="S3.SS4.p1.11.m11.3.3.3.3.1" xref="S3.SS4.p1.11.m11.3.3.3.3.1.cmml">−</mo><mn id="S3.SS4.p1.11.m11.3.3.3.3.3" xref="S3.SS4.p1.11.m11.3.3.3.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS4.p1.11.m11.3.3.2" xref="S3.SS4.p1.11.m11.3.3.2.cmml">↦</mo><mrow id="S3.SS4.p1.11.m11.3.3.1.1" xref="S3.SS4.p1.11.m11.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.11.m11.3.3.1.1.2" xref="S3.SS4.p1.11.m11.3.3.1.2.cmml">{</mo><msub id="S3.SS4.p1.11.m11.3.3.1.1.1" xref="S3.SS4.p1.11.m11.3.3.1.1.1.cmml"><mover accent="true" id="S3.SS4.p1.11.m11.3.3.1.1.1.2" xref="S3.SS4.p1.11.m11.3.3.1.1.1.2.cmml"><mi id="S3.SS4.p1.11.m11.3.3.1.1.1.2.2" xref="S3.SS4.p1.11.m11.3.3.1.1.1.2.2.cmml">V</mi><mo id="S3.SS4.p1.11.m11.3.3.1.1.1.2.1" xref="S3.SS4.p1.11.m11.3.3.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS4.p1.11.m11.2.2.2.2" xref="S3.SS4.p1.11.m11.2.2.2.3.cmml"><mrow id="S3.SS4.p1.11.m11.2.2.2.2.1" xref="S3.SS4.p1.11.m11.2.2.2.2.1.cmml"><mi id="S3.SS4.p1.11.m11.2.2.2.2.1.2" xref="S3.SS4.p1.11.m11.2.2.2.2.1.2.cmml">i</mi><mo id="S3.SS4.p1.11.m11.2.2.2.2.1.1" xref="S3.SS4.p1.11.m11.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS4.p1.11.m11.2.2.2.2.1.3" xref="S3.SS4.p1.11.m11.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p1.11.m11.2.2.2.2.2" xref="S3.SS4.p1.11.m11.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p1.11.m11.1.1.1.1" xref="S3.SS4.p1.11.m11.1.1.1.1.cmml">c</mi></mrow></msub><mo stretchy="false" id="S3.SS4.p1.11.m11.3.3.1.1.3" xref="S3.SS4.p1.11.m11.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.3b"><apply id="S3.SS4.p1.11.m11.3.3.cmml" xref="S3.SS4.p1.11.m11.3.3"><csymbol cd="latexml" id="S3.SS4.p1.11.m11.3.3.2.cmml" xref="S3.SS4.p1.11.m11.3.3.2">maps-to</csymbol><apply id="S3.SS4.p1.11.m11.3.3.3.cmml" xref="S3.SS4.p1.11.m11.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.3.3.3.1.cmml" xref="S3.SS4.p1.11.m11.3.3.3">subscript</csymbol><apply id="S3.SS4.p1.11.m11.3.3.3.2.cmml" xref="S3.SS4.p1.11.m11.3.3.3.2"><ci id="S3.SS4.p1.11.m11.3.3.3.2.1.cmml" xref="S3.SS4.p1.11.m11.3.3.3.2.1">~</ci><ci id="S3.SS4.p1.11.m11.3.3.3.2.2.cmml" xref="S3.SS4.p1.11.m11.3.3.3.2.2">𝐼</ci></apply><apply id="S3.SS4.p1.11.m11.3.3.3.3.cmml" xref="S3.SS4.p1.11.m11.3.3.3.3"><minus id="S3.SS4.p1.11.m11.3.3.3.3.1.cmml" xref="S3.SS4.p1.11.m11.3.3.3.3.1"></minus><ci id="S3.SS4.p1.11.m11.3.3.3.3.2.cmml" xref="S3.SS4.p1.11.m11.3.3.3.3.2">𝑖</ci><cn type="integer" id="S3.SS4.p1.11.m11.3.3.3.3.3.cmml" xref="S3.SS4.p1.11.m11.3.3.3.3.3">1</cn></apply></apply><set id="S3.SS4.p1.11.m11.3.3.1.2.cmml" xref="S3.SS4.p1.11.m11.3.3.1.1"><apply id="S3.SS4.p1.11.m11.3.3.1.1.1.cmml" xref="S3.SS4.p1.11.m11.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.11.m11.3.3.1.1.1">subscript</csymbol><apply id="S3.SS4.p1.11.m11.3.3.1.1.1.2.cmml" xref="S3.SS4.p1.11.m11.3.3.1.1.1.2"><ci id="S3.SS4.p1.11.m11.3.3.1.1.1.2.1.cmml" xref="S3.SS4.p1.11.m11.3.3.1.1.1.2.1">~</ci><ci id="S3.SS4.p1.11.m11.3.3.1.1.1.2.2.cmml" xref="S3.SS4.p1.11.m11.3.3.1.1.1.2.2">𝑉</ci></apply><list id="S3.SS4.p1.11.m11.2.2.2.3.cmml" xref="S3.SS4.p1.11.m11.2.2.2.2"><apply id="S3.SS4.p1.11.m11.2.2.2.2.1.cmml" xref="S3.SS4.p1.11.m11.2.2.2.2.1"><minus id="S3.SS4.p1.11.m11.2.2.2.2.1.1.cmml" xref="S3.SS4.p1.11.m11.2.2.2.2.1.1"></minus><ci id="S3.SS4.p1.11.m11.2.2.2.2.1.2.cmml" xref="S3.SS4.p1.11.m11.2.2.2.2.1.2">𝑖</ci><cn type="integer" id="S3.SS4.p1.11.m11.2.2.2.2.1.3.cmml" xref="S3.SS4.p1.11.m11.2.2.2.2.1.3">1</cn></apply><ci id="S3.SS4.p1.11.m11.1.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1">𝑐</ci></list></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.3c">\tilde{I}_{i-1}\mapsto\{\tilde{V}_{i-1,c}\}</annotation></semantics></math>, <math id="S3.SS4.p1.12.m12.3" class="ltx_Math" alttext="c=1,...,\tilde{K}_{i-1}" display="inline"><semantics id="S3.SS4.p1.12.m12.3a"><mrow id="S3.SS4.p1.12.m12.3.3" xref="S3.SS4.p1.12.m12.3.3.cmml"><mi id="S3.SS4.p1.12.m12.3.3.3" xref="S3.SS4.p1.12.m12.3.3.3.cmml">c</mi><mo id="S3.SS4.p1.12.m12.3.3.2" xref="S3.SS4.p1.12.m12.3.3.2.cmml">=</mo><mrow id="S3.SS4.p1.12.m12.3.3.1.1" xref="S3.SS4.p1.12.m12.3.3.1.2.cmml"><mn id="S3.SS4.p1.12.m12.1.1" xref="S3.SS4.p1.12.m12.1.1.cmml">1</mn><mo id="S3.SS4.p1.12.m12.3.3.1.1.2" xref="S3.SS4.p1.12.m12.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p1.12.m12.2.2" xref="S3.SS4.p1.12.m12.2.2.cmml">…</mi><mo id="S3.SS4.p1.12.m12.3.3.1.1.3" xref="S3.SS4.p1.12.m12.3.3.1.2.cmml">,</mo><msub id="S3.SS4.p1.12.m12.3.3.1.1.1" xref="S3.SS4.p1.12.m12.3.3.1.1.1.cmml"><mover accent="true" id="S3.SS4.p1.12.m12.3.3.1.1.1.2" xref="S3.SS4.p1.12.m12.3.3.1.1.1.2.cmml"><mi id="S3.SS4.p1.12.m12.3.3.1.1.1.2.2" xref="S3.SS4.p1.12.m12.3.3.1.1.1.2.2.cmml">K</mi><mo id="S3.SS4.p1.12.m12.3.3.1.1.1.2.1" xref="S3.SS4.p1.12.m12.3.3.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS4.p1.12.m12.3.3.1.1.1.3" xref="S3.SS4.p1.12.m12.3.3.1.1.1.3.cmml"><mi id="S3.SS4.p1.12.m12.3.3.1.1.1.3.2" xref="S3.SS4.p1.12.m12.3.3.1.1.1.3.2.cmml">i</mi><mo id="S3.SS4.p1.12.m12.3.3.1.1.1.3.1" xref="S3.SS4.p1.12.m12.3.3.1.1.1.3.1.cmml">−</mo><mn id="S3.SS4.p1.12.m12.3.3.1.1.1.3.3" xref="S3.SS4.p1.12.m12.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m12.3b"><apply id="S3.SS4.p1.12.m12.3.3.cmml" xref="S3.SS4.p1.12.m12.3.3"><eq id="S3.SS4.p1.12.m12.3.3.2.cmml" xref="S3.SS4.p1.12.m12.3.3.2"></eq><ci id="S3.SS4.p1.12.m12.3.3.3.cmml" xref="S3.SS4.p1.12.m12.3.3.3">𝑐</ci><list id="S3.SS4.p1.12.m12.3.3.1.2.cmml" xref="S3.SS4.p1.12.m12.3.3.1.1"><cn type="integer" id="S3.SS4.p1.12.m12.1.1.cmml" xref="S3.SS4.p1.12.m12.1.1">1</cn><ci id="S3.SS4.p1.12.m12.2.2.cmml" xref="S3.SS4.p1.12.m12.2.2">…</ci><apply id="S3.SS4.p1.12.m12.3.3.1.1.1.cmml" xref="S3.SS4.p1.12.m12.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m12.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.12.m12.3.3.1.1.1">subscript</csymbol><apply id="S3.SS4.p1.12.m12.3.3.1.1.1.2.cmml" xref="S3.SS4.p1.12.m12.3.3.1.1.1.2"><ci id="S3.SS4.p1.12.m12.3.3.1.1.1.2.1.cmml" xref="S3.SS4.p1.12.m12.3.3.1.1.1.2.1">~</ci><ci id="S3.SS4.p1.12.m12.3.3.1.1.1.2.2.cmml" xref="S3.SS4.p1.12.m12.3.3.1.1.1.2.2">𝐾</ci></apply><apply id="S3.SS4.p1.12.m12.3.3.1.1.1.3.cmml" xref="S3.SS4.p1.12.m12.3.3.1.1.1.3"><minus id="S3.SS4.p1.12.m12.3.3.1.1.1.3.1.cmml" xref="S3.SS4.p1.12.m12.3.3.1.1.1.3.1"></minus><ci id="S3.SS4.p1.12.m12.3.3.1.1.1.3.2.cmml" xref="S3.SS4.p1.12.m12.3.3.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS4.p1.12.m12.3.3.1.1.1.3.3.cmml" xref="S3.SS4.p1.12.m12.3.3.1.1.1.3.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m12.3c">c=1,...,\tilde{K}_{i-1}</annotation></semantics></math>. Most often, <math id="S3.SS4.p1.13.m13.1" class="ltx_Math" alttext="\tilde{K}_{i-1}\leqslant K_{i-1}" display="inline"><semantics id="S3.SS4.p1.13.m13.1a"><mrow id="S3.SS4.p1.13.m13.1.1" xref="S3.SS4.p1.13.m13.1.1.cmml"><msub id="S3.SS4.p1.13.m13.1.1.2" xref="S3.SS4.p1.13.m13.1.1.2.cmml"><mover accent="true" id="S3.SS4.p1.13.m13.1.1.2.2" xref="S3.SS4.p1.13.m13.1.1.2.2.cmml"><mi id="S3.SS4.p1.13.m13.1.1.2.2.2" xref="S3.SS4.p1.13.m13.1.1.2.2.2.cmml">K</mi><mo id="S3.SS4.p1.13.m13.1.1.2.2.1" xref="S3.SS4.p1.13.m13.1.1.2.2.1.cmml">~</mo></mover><mrow id="S3.SS4.p1.13.m13.1.1.2.3" xref="S3.SS4.p1.13.m13.1.1.2.3.cmml"><mi id="S3.SS4.p1.13.m13.1.1.2.3.2" xref="S3.SS4.p1.13.m13.1.1.2.3.2.cmml">i</mi><mo id="S3.SS4.p1.13.m13.1.1.2.3.1" xref="S3.SS4.p1.13.m13.1.1.2.3.1.cmml">−</mo><mn id="S3.SS4.p1.13.m13.1.1.2.3.3" xref="S3.SS4.p1.13.m13.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS4.p1.13.m13.1.1.1" xref="S3.SS4.p1.13.m13.1.1.1.cmml">⩽</mo><msub id="S3.SS4.p1.13.m13.1.1.3" xref="S3.SS4.p1.13.m13.1.1.3.cmml"><mi id="S3.SS4.p1.13.m13.1.1.3.2" xref="S3.SS4.p1.13.m13.1.1.3.2.cmml">K</mi><mrow id="S3.SS4.p1.13.m13.1.1.3.3" xref="S3.SS4.p1.13.m13.1.1.3.3.cmml"><mi id="S3.SS4.p1.13.m13.1.1.3.3.2" xref="S3.SS4.p1.13.m13.1.1.3.3.2.cmml">i</mi><mo id="S3.SS4.p1.13.m13.1.1.3.3.1" xref="S3.SS4.p1.13.m13.1.1.3.3.1.cmml">−</mo><mn id="S3.SS4.p1.13.m13.1.1.3.3.3" xref="S3.SS4.p1.13.m13.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.13.m13.1b"><apply id="S3.SS4.p1.13.m13.1.1.cmml" xref="S3.SS4.p1.13.m13.1.1"><leq id="S3.SS4.p1.13.m13.1.1.1.cmml" xref="S3.SS4.p1.13.m13.1.1.1"></leq><apply id="S3.SS4.p1.13.m13.1.1.2.cmml" xref="S3.SS4.p1.13.m13.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.13.m13.1.1.2.1.cmml" xref="S3.SS4.p1.13.m13.1.1.2">subscript</csymbol><apply id="S3.SS4.p1.13.m13.1.1.2.2.cmml" xref="S3.SS4.p1.13.m13.1.1.2.2"><ci id="S3.SS4.p1.13.m13.1.1.2.2.1.cmml" xref="S3.SS4.p1.13.m13.1.1.2.2.1">~</ci><ci id="S3.SS4.p1.13.m13.1.1.2.2.2.cmml" xref="S3.SS4.p1.13.m13.1.1.2.2.2">𝐾</ci></apply><apply id="S3.SS4.p1.13.m13.1.1.2.3.cmml" xref="S3.SS4.p1.13.m13.1.1.2.3"><minus id="S3.SS4.p1.13.m13.1.1.2.3.1.cmml" xref="S3.SS4.p1.13.m13.1.1.2.3.1"></minus><ci id="S3.SS4.p1.13.m13.1.1.2.3.2.cmml" xref="S3.SS4.p1.13.m13.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS4.p1.13.m13.1.1.2.3.3.cmml" xref="S3.SS4.p1.13.m13.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS4.p1.13.m13.1.1.3.cmml" xref="S3.SS4.p1.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.13.m13.1.1.3.1.cmml" xref="S3.SS4.p1.13.m13.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.13.m13.1.1.3.2.cmml" xref="S3.SS4.p1.13.m13.1.1.3.2">𝐾</ci><apply id="S3.SS4.p1.13.m13.1.1.3.3.cmml" xref="S3.SS4.p1.13.m13.1.1.3.3"><minus id="S3.SS4.p1.13.m13.1.1.3.3.1.cmml" xref="S3.SS4.p1.13.m13.1.1.3.3.1"></minus><ci id="S3.SS4.p1.13.m13.1.1.3.3.2.cmml" xref="S3.SS4.p1.13.m13.1.1.3.3.2">𝑖</ci><cn type="integer" id="S3.SS4.p1.13.m13.1.1.3.3.3.cmml" xref="S3.SS4.p1.13.m13.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.13.m13.1c">\tilde{K}_{i-1}\leqslant K_{i-1}</annotation></semantics></math> due to out-of-view truncation after vehicle coordinates calibration.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">The resulting variants are: self / cross / mix-attention. In self-attention the key and value tensors are the same as query. Cross-attention uses <math id="S3.SS4.p2.1.m1.3" class="ltx_Math" alttext="\{\tilde{V}_{i-1,c}\}" display="inline"><semantics id="S3.SS4.p2.1.m1.3a"><mrow id="S3.SS4.p2.1.m1.3.3.1" xref="S3.SS4.p2.1.m1.3.3.2.cmml"><mo stretchy="false" id="S3.SS4.p2.1.m1.3.3.1.2" xref="S3.SS4.p2.1.m1.3.3.2.cmml">{</mo><msub id="S3.SS4.p2.1.m1.3.3.1.1" xref="S3.SS4.p2.1.m1.3.3.1.1.cmml"><mover accent="true" id="S3.SS4.p2.1.m1.3.3.1.1.2" xref="S3.SS4.p2.1.m1.3.3.1.1.2.cmml"><mi id="S3.SS4.p2.1.m1.3.3.1.1.2.2" xref="S3.SS4.p2.1.m1.3.3.1.1.2.2.cmml">V</mi><mo id="S3.SS4.p2.1.m1.3.3.1.1.2.1" xref="S3.SS4.p2.1.m1.3.3.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS4.p2.1.m1.2.2.2.2" xref="S3.SS4.p2.1.m1.2.2.2.3.cmml"><mrow id="S3.SS4.p2.1.m1.2.2.2.2.1" xref="S3.SS4.p2.1.m1.2.2.2.2.1.cmml"><mi id="S3.SS4.p2.1.m1.2.2.2.2.1.2" xref="S3.SS4.p2.1.m1.2.2.2.2.1.2.cmml">i</mi><mo id="S3.SS4.p2.1.m1.2.2.2.2.1.1" xref="S3.SS4.p2.1.m1.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS4.p2.1.m1.2.2.2.2.1.3" xref="S3.SS4.p2.1.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS4.p2.1.m1.2.2.2.2.2" xref="S3.SS4.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p2.1.m1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.cmml">c</mi></mrow></msub><mo stretchy="false" id="S3.SS4.p2.1.m1.3.3.1.3" xref="S3.SS4.p2.1.m1.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.3b"><set id="S3.SS4.p2.1.m1.3.3.2.cmml" xref="S3.SS4.p2.1.m1.3.3.1"><apply id="S3.SS4.p2.1.m1.3.3.1.1.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.3.3.1.1.1.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1">subscript</csymbol><apply id="S3.SS4.p2.1.m1.3.3.1.1.2.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1.2"><ci id="S3.SS4.p2.1.m1.3.3.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1.2.1">~</ci><ci id="S3.SS4.p2.1.m1.3.3.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1.2.2">𝑉</ci></apply><list id="S3.SS4.p2.1.m1.2.2.2.3.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2"><apply id="S3.SS4.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2.1"><minus id="S3.SS4.p2.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2.1.1"></minus><ci id="S3.SS4.p2.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2.1.2">𝑖</ci><cn type="integer" id="S3.SS4.p2.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS4.p2.1.m1.2.2.2.2.1.3">1</cn></apply><ci id="S3.SS4.p2.1.m1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1">𝑐</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.3c">\{\tilde{V}_{i-1,c}\}</annotation></semantics></math> as key and value and mix-attention uses the union set of prior two attention variants. We apply Sinusoidal functions based absolute positional encoding to inform the attention blocks of the sparse pillar coordinates within a window. Detailed ablation studies on different attention designs are provided in Section <a href="#S4.SS3" title="IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-C</span></span></a>. With window-based attention fusion, features of both static and moving pillars now can be associated and fused for later being passed into the main backbone network.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.3.1.1" class="ltx_text" style="font-size:90%;">TABLE I</span>: </span><span id="S3.T1.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Overall performance comparisons on Waymo Open Dataset<span id="S3.T1.4.2.1" class="ltx_text ltx_font_medium">.
Refine means that the detectors need an additional step of box refinement via feature pooling and fusion from the box areas, which usually increases time cost and might not be end-to-end trainable. For fair comparisons we focus on single-stage detectors without (w/o) box refinement.</span></span></figcaption>
<div id="S3.T1.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:333.9pt;height:140.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-89.3pt,37.6pt) scale(0.651560641765242,0.651560641765242) ;">
<table id="S3.T1.5.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.5.1.1.1" class="ltx_tr">
<td id="S3.T1.5.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" rowspan="2"><span id="S3.T1.5.1.1.1.1.1" class="ltx_text">Method</span></td>
<td id="S3.T1.5.1.1.1.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt" rowspan="2"><span id="S3.T1.5.1.1.1.2.1" class="ltx_text">Refine</span></td>
<td id="S3.T1.5.1.1.1.3" class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt" colspan="2">Test set 3D AP/APH</td>
<td id="S3.T1.5.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">Validation set 3D AP/APH</td>
</tr>
<tr id="S3.T1.5.1.2.2" class="ltx_tr">
<td id="S3.T1.5.1.2.2.1" class="ltx_td ltx_align_center">L1</td>
<td id="S3.T1.5.1.2.2.2" class="ltx_td ltx_align_center ltx_border_rr">L2</td>
<td id="S3.T1.5.1.2.2.3" class="ltx_td ltx_align_center">L1</td>
<td id="S3.T1.5.1.2.2.4" class="ltx_td ltx_align_center">L2</td>
</tr>
<tr id="S3.T1.5.1.3.3" class="ltx_tr">
<td id="S3.T1.5.1.3.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">3D-MAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>
</td>
<td id="S3.T1.5.1.3.3.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">with</td>
<td id="S3.T1.5.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.71 / 78.28</td>
<td id="S3.T1.5.1.3.3.4" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">70.37 / 69.98</td>
<td id="S3.T1.5.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">74.53 / 74.03</td>
<td id="S3.T1.5.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">67.61 / 67.14</td>
</tr>
<tr id="S3.T1.5.1.4.4" class="ltx_tr">
<td id="S3.T1.5.1.4.4.1" class="ltx_td ltx_align_left ltx_border_r">CenterPoint <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
<td id="S3.T1.5.1.4.4.2" class="ltx_td ltx_align_center ltx_border_rr">with</td>
<td id="S3.T1.5.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r">80.20 / 79.70</td>
<td id="S3.T1.5.1.4.4.4" class="ltx_td ltx_align_center ltx_border_rr">72.20 / 71.80</td>
<td id="S3.T1.5.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r">76.60 / 76.10</td>
<td id="S3.T1.5.1.4.4.6" class="ltx_td ltx_align_center">68.90 / 68.40</td>
</tr>
<tr id="S3.T1.5.1.5.5" class="ltx_tr">
<td id="S3.T1.5.1.5.5.1" class="ltx_td ltx_align_left ltx_border_r">SST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>
</td>
<td id="S3.T1.5.1.5.5.2" class="ltx_td ltx_align_center ltx_border_rr">with</td>
<td id="S3.T1.5.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">80.99 / 80.62</td>
<td id="S3.T1.5.1.5.5.4" class="ltx_td ltx_align_center ltx_border_rr">73.08 / 72.72</td>
<td id="S3.T1.5.1.5.5.5" class="ltx_td ltx_align_center ltx_border_r">77.00 / 76.60</td>
<td id="S3.T1.5.1.5.5.6" class="ltx_td ltx_align_center">68.50 / 68.10</td>
</tr>
<tr id="S3.T1.5.1.6.6" class="ltx_tr">
<td id="S3.T1.5.1.6.6.1" class="ltx_td ltx_align_left ltx_border_r">PVRCNN++ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>
</td>
<td id="S3.T1.5.1.6.6.2" class="ltx_td ltx_align_center ltx_border_rr">with</td>
<td id="S3.T1.5.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r">81.62 / 81.20</td>
<td id="S3.T1.5.1.6.6.4" class="ltx_td ltx_align_center ltx_border_rr">73.86 / 73.47</td>
<td id="S3.T1.5.1.6.6.5" class="ltx_td ltx_align_center ltx_border_r">79.30 / 78.80</td>
<td id="S3.T1.5.1.6.6.6" class="ltx_td ltx_align_center">70.60 / 70.20</td>
</tr>
<tr id="S3.T1.5.1.7.7" class="ltx_tr">
<td id="S3.T1.5.1.7.7.1" class="ltx_td ltx_align_left ltx_border_r">MPPNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>
</td>
<td id="S3.T1.5.1.7.7.2" class="ltx_td ltx_align_center ltx_border_rr">with</td>
<td id="S3.T1.5.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r">84.27 / 83.88</td>
<td id="S3.T1.5.1.7.7.4" class="ltx_td ltx_align_center ltx_border_rr">77.29 / 76.91</td>
<td id="S3.T1.5.1.7.7.5" class="ltx_td ltx_align_center ltx_border_r">82.74 / 82.28</td>
<td id="S3.T1.5.1.7.7.6" class="ltx_td ltx_align_center">75.41 / 74.96</td>
</tr>
<tr id="S3.T1.5.1.8.8" class="ltx_tr">
<td id="S3.T1.5.1.8.8.1" class="ltx_td ltx_align_left ltx_border_r">CenterFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</td>
<td id="S3.T1.5.1.8.8.2" class="ltx_td ltx_align_center ltx_border_rr">with</td>
<td id="S3.T1.5.1.8.8.3" class="ltx_td ltx_align_center ltx_border_r">84.70 / 84.40</td>
<td id="S3.T1.5.1.8.8.4" class="ltx_td ltx_align_center ltx_border_rr">78.10 / 77.70</td>
<td id="S3.T1.5.1.8.8.5" class="ltx_td ltx_align_center ltx_border_r">78.80 / 78.30</td>
<td id="S3.T1.5.1.8.8.6" class="ltx_td ltx_align_center">74.30 / 73.80</td>
</tr>
<tr id="S3.T1.5.1.9.9" class="ltx_tr">
<td id="S3.T1.5.1.9.9.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">PointPillars <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>
</td>
<td id="S3.T1.5.1.9.9.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">w/o</td>
<td id="S3.T1.5.1.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.60 / 68.10</td>
<td id="S3.T1.5.1.9.9.4" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">60.50 / 60.10</td>
<td id="S3.T1.5.1.9.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63.30 / 62.70</td>
<td id="S3.T1.5.1.9.9.6" class="ltx_td ltx_align_center ltx_border_t">55.20 / 54.70</td>
</tr>
<tr id="S3.T1.5.1.10.10" class="ltx_tr">
<td id="S3.T1.5.1.10.10.1" class="ltx_td ltx_align_left ltx_border_r">RSN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</td>
<td id="S3.T1.5.1.10.10.2" class="ltx_td ltx_align_center ltx_border_rr">w/o</td>
<td id="S3.T1.5.1.10.10.3" class="ltx_td ltx_align_center ltx_border_r">80.70 / 80.30</td>
<td id="S3.T1.5.1.10.10.4" class="ltx_td ltx_align_center ltx_border_rr">71.90 / 71.60</td>
<td id="S3.T1.5.1.10.10.5" class="ltx_td ltx_align_center ltx_border_r">78.40 / 78.10</td>
<td id="S3.T1.5.1.10.10.6" class="ltx_td ltx_align_center">69.50 / 69.10</td>
</tr>
<tr id="S3.T1.5.1.11.11" class="ltx_tr">
<td id="S3.T1.5.1.11.11.1" class="ltx_td ltx_align_left ltx_border_r">SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>
</td>
<td id="S3.T1.5.1.11.11.2" class="ltx_td ltx_align_center ltx_border_rr">w/o</td>
<td id="S3.T1.5.1.11.11.3" class="ltx_td ltx_align_center ltx_border_r">82.25 / 81.87</td>
<td id="S3.T1.5.1.11.11.4" class="ltx_td ltx_align_center ltx_border_rr">74.23 / 73.87</td>
<td id="S3.T1.5.1.11.11.5" class="ltx_td ltx_align_center ltx_border_r">79.03 / 78.55</td>
<td id="S3.T1.5.1.11.11.6" class="ltx_td ltx_align_center">70.55 / 70.11</td>
</tr>
<tr id="S3.T1.5.1.12.12" class="ltx_tr">
<td id="S3.T1.5.1.12.12.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="S3.T1.5.1.12.12.1.1" class="ltx_text ltx_font_bold">LEF (ours)</span></td>
<td id="S3.T1.5.1.12.12.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_rr">w/o</td>
<td id="S3.T1.5.1.12.12.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S3.T1.5.1.12.12.3.1" class="ltx_text ltx_font_bold">83.39</span> / <span id="S3.T1.5.1.12.12.3.2" class="ltx_text ltx_font_bold">83.02</span>
</td>
<td id="S3.T1.5.1.12.12.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_rr">
<span id="S3.T1.5.1.12.12.4.1" class="ltx_text ltx_font_bold">75.51</span> / <span id="S3.T1.5.1.12.12.4.2" class="ltx_text ltx_font_bold">75.16</span>
</td>
<td id="S3.T1.5.1.12.12.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S3.T1.5.1.12.12.5.1" class="ltx_text ltx_font_bold">79.64</span> / <span id="S3.T1.5.1.12.12.5.2" class="ltx_text ltx_font_bold">79.18</span>
</td>
<td id="S3.T1.5.1.12.12.6" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S3.T1.5.1.12.12.6.1" class="ltx_text ltx_font_bold">71.37</span> / <span id="S3.T1.5.1.12.12.6.2" class="ltx_text ltx_font_bold">70.94</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS5.5.1.1" class="ltx_text">III-E</span> </span><span id="S3.SS5.6.2" class="ltx_text ltx_font_italic">Stochastic-Length FrameDrop</span>
</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.5" class="ltx_p">To enable robust training upon long sequences, we randomly drop history frames from <math id="S3.SS5.p1.1.m1.3" class="ltx_Math" alttext="(P_{1},...,P_{t})" display="inline"><semantics id="S3.SS5.p1.1.m1.3a"><mrow id="S3.SS5.p1.1.m1.3.3.2" xref="S3.SS5.p1.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS5.p1.1.m1.3.3.2.3" xref="S3.SS5.p1.1.m1.3.3.3.cmml">(</mo><msub id="S3.SS5.p1.1.m1.2.2.1.1" xref="S3.SS5.p1.1.m1.2.2.1.1.cmml"><mi id="S3.SS5.p1.1.m1.2.2.1.1.2" xref="S3.SS5.p1.1.m1.2.2.1.1.2.cmml">P</mi><mn id="S3.SS5.p1.1.m1.2.2.1.1.3" xref="S3.SS5.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS5.p1.1.m1.3.3.2.4" xref="S3.SS5.p1.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS5.p1.1.m1.3.3.2.5" xref="S3.SS5.p1.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS5.p1.1.m1.3.3.2.2" xref="S3.SS5.p1.1.m1.3.3.2.2.cmml"><mi id="S3.SS5.p1.1.m1.3.3.2.2.2" xref="S3.SS5.p1.1.m1.3.3.2.2.2.cmml">P</mi><mi id="S3.SS5.p1.1.m1.3.3.2.2.3" xref="S3.SS5.p1.1.m1.3.3.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS5.p1.1.m1.3.3.2.6" xref="S3.SS5.p1.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.3b"><vector id="S3.SS5.p1.1.m1.3.3.3.cmml" xref="S3.SS5.p1.1.m1.3.3.2"><apply id="S3.SS5.p1.1.m1.2.2.1.1.cmml" xref="S3.SS5.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS5.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS5.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS5.p1.1.m1.2.2.1.1.2">𝑃</ci><cn type="integer" id="S3.SS5.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS5.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">…</ci><apply id="S3.SS5.p1.1.m1.3.3.2.2.cmml" xref="S3.SS5.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS5.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS5.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS5.p1.1.m1.3.3.2.2.2">𝑃</ci><ci id="S3.SS5.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS5.p1.1.m1.3.3.2.2.3">𝑡</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.3c">(P_{1},...,P_{t})</annotation></semantics></math> during each training iteration. In other words, we randomly sample <math id="S3.SS5.p1.2.m2.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.SS5.p1.2.m2.1a"><msub id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml"><mi id="S3.SS5.p1.2.m2.1.1.2" xref="S3.SS5.p1.2.m2.1.1.2.cmml">S</mi><mi id="S3.SS5.p1.2.m2.1.1.3" xref="S3.SS5.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><apply id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.2.m2.1.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.p1.2.m2.1.1.2.cmml" xref="S3.SS5.p1.2.m2.1.1.2">𝑆</ci><ci id="S3.SS5.p1.2.m2.1.1.3.cmml" xref="S3.SS5.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">S_{i}</annotation></semantics></math> history frames, with <math id="S3.SS5.p1.3.m3.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.SS5.p1.3.m3.1a"><msub id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1.cmml"><mi id="S3.SS5.p1.3.m3.1.1.2" xref="S3.SS5.p1.3.m3.1.1.2.cmml">S</mi><mi id="S3.SS5.p1.3.m3.1.1.3" xref="S3.SS5.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.1b"><apply id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m3.1.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS5.p1.3.m3.1.1.2.cmml" xref="S3.SS5.p1.3.m3.1.1.2">𝑆</ci><ci id="S3.SS5.p1.3.m3.1.1.3.cmml" xref="S3.SS5.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">S_{i}</annotation></semantics></math> being a stochastic number at different training steps and the sampled frames are not necessarily adjacent ones. In comparison, the previous LiDAR temporal fusion methods usually fix <math id="S3.SS5.p1.4.m4.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.SS5.p1.4.m4.1a"><msub id="S3.SS5.p1.4.m4.1.1" xref="S3.SS5.p1.4.m4.1.1.cmml"><mi id="S3.SS5.p1.4.m4.1.1.2" xref="S3.SS5.p1.4.m4.1.1.2.cmml">S</mi><mi id="S3.SS5.p1.4.m4.1.1.3" xref="S3.SS5.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.1b"><apply id="S3.SS5.p1.4.m4.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS5.p1.4.m4.1.1.2.cmml" xref="S3.SS5.p1.4.m4.1.1.2">𝑆</ci><ci id="S3.SS5.p1.4.m4.1.1.3.cmml" xref="S3.SS5.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.1c">S_{i}</annotation></semantics></math> to be a constant (<span id="S3.SS5.p1.5.1" class="ltx_text ltx_font_italic">e</span>.<span id="S3.SS5.p1.5.2" class="ltx_text ltx_font_italic">g</span>. 3 or 4) and sample consecutive frames. We apply stop gradient between each recurrent pass when fusing deep-layer history features into early layers of the next frame, without which long-sequence training of 3D object detectors can easily get intractable or run into OOM.
During training, the model only predicts 3D boxes <math id="S3.SS5.p1.5.m5.3" class="ltx_Math" alttext="\{\hat{B}_{i,m}\}" display="inline"><semantics id="S3.SS5.p1.5.m5.3a"><mrow id="S3.SS5.p1.5.m5.3.3.1" xref="S3.SS5.p1.5.m5.3.3.2.cmml"><mo stretchy="false" id="S3.SS5.p1.5.m5.3.3.1.2" xref="S3.SS5.p1.5.m5.3.3.2.cmml">{</mo><msub id="S3.SS5.p1.5.m5.3.3.1.1" xref="S3.SS5.p1.5.m5.3.3.1.1.cmml"><mover accent="true" id="S3.SS5.p1.5.m5.3.3.1.1.2" xref="S3.SS5.p1.5.m5.3.3.1.1.2.cmml"><mi id="S3.SS5.p1.5.m5.3.3.1.1.2.2" xref="S3.SS5.p1.5.m5.3.3.1.1.2.2.cmml">B</mi><mo id="S3.SS5.p1.5.m5.3.3.1.1.2.1" xref="S3.SS5.p1.5.m5.3.3.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS5.p1.5.m5.2.2.2.4" xref="S3.SS5.p1.5.m5.2.2.2.3.cmml"><mi id="S3.SS5.p1.5.m5.1.1.1.1" xref="S3.SS5.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS5.p1.5.m5.2.2.2.4.1" xref="S3.SS5.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS5.p1.5.m5.2.2.2.2" xref="S3.SS5.p1.5.m5.2.2.2.2.cmml">m</mi></mrow></msub><mo stretchy="false" id="S3.SS5.p1.5.m5.3.3.1.3" xref="S3.SS5.p1.5.m5.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.5.m5.3b"><set id="S3.SS5.p1.5.m5.3.3.2.cmml" xref="S3.SS5.p1.5.m5.3.3.1"><apply id="S3.SS5.p1.5.m5.3.3.1.1.cmml" xref="S3.SS5.p1.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS5.p1.5.m5.3.3.1.1">subscript</csymbol><apply id="S3.SS5.p1.5.m5.3.3.1.1.2.cmml" xref="S3.SS5.p1.5.m5.3.3.1.1.2"><ci id="S3.SS5.p1.5.m5.3.3.1.1.2.1.cmml" xref="S3.SS5.p1.5.m5.3.3.1.1.2.1">^</ci><ci id="S3.SS5.p1.5.m5.3.3.1.1.2.2.cmml" xref="S3.SS5.p1.5.m5.3.3.1.1.2.2">𝐵</ci></apply><list id="S3.SS5.p1.5.m5.2.2.2.3.cmml" xref="S3.SS5.p1.5.m5.2.2.2.4"><ci id="S3.SS5.p1.5.m5.1.1.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1.1.1">𝑖</ci><ci id="S3.SS5.p1.5.m5.2.2.2.2.cmml" xref="S3.SS5.p1.5.m5.2.2.2.2">𝑚</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.5.m5.3c">\{\hat{B}_{i,m}\}</annotation></semantics></math> in the last forward pass. Losses are enforced upon certain intermediate outputs (<span id="S3.SS5.p1.5.3" class="ltx_text ltx_font_italic">e</span>.<span id="S3.SS5.p1.5.4" class="ltx_text ltx_font_italic">g</span>. foreground pillar segmentation) and the final box parameter predictions (<span id="S3.SS5.p1.5.5" class="ltx_text ltx_font_italic">e</span>.<span id="S3.SS5.p1.5.6" class="ltx_text ltx_font_italic">g</span>. shapes and poses).</p>
</div>
<div id="S3.SS5.p2" class="ltx_para">
<table id="S5.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E3.m1.14" class="ltx_Math" alttext="\displaystyle\begin{split}L=\lambda_{1}L_{seg}+\lambda_{2}L_{center}+L_{box}\end{split}" display="inline"><semantics id="S3.E3.m1.14a"><mtable id="S3.E3.m1.14.14a" xref="S3.E3.m1.14.15.1.cmml"><mtr id="S3.E3.m1.14.14aa" xref="S3.E3.m1.14.15.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.14.14ab" xref="S3.E3.m1.14.15.1.cmml"><mrow id="S3.E3.m1.14.14.14.14.14a" xref="S3.E3.m1.14.15.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">L</mi><mo id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.cmml">=</mo><mrow id="S3.E3.m1.14.14.14.14.14a.15" xref="S3.E3.m1.14.15.1.cmml"><mrow id="S3.E3.m1.14.14.14.14.14a.15.1" xref="S3.E3.m1.14.15.1.cmml"><msub id="S3.E3.m1.14.14.14.14.14a.15.1.2" xref="S3.E3.m1.14.15.1.cmml"><mi id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml">λ</mi><mn id="S3.E3.m1.4.4.4.4.4.4.1" xref="S3.E3.m1.4.4.4.4.4.4.1.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.14.14.14.14.14a.15.1.1" xref="S3.E3.m1.14.15.1.cmml">​</mo><msub id="S3.E3.m1.14.14.14.14.14a.15.1.3" xref="S3.E3.m1.14.15.1.cmml"><mi id="S3.E3.m1.5.5.5.5.5.5" xref="S3.E3.m1.5.5.5.5.5.5.cmml">L</mi><mrow id="S3.E3.m1.6.6.6.6.6.6.1" xref="S3.E3.m1.6.6.6.6.6.6.1.cmml"><mi id="S3.E3.m1.6.6.6.6.6.6.1.2" xref="S3.E3.m1.6.6.6.6.6.6.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.6.6.6.6.6.6.1.1" xref="S3.E3.m1.6.6.6.6.6.6.1.1.cmml">​</mo><mi id="S3.E3.m1.6.6.6.6.6.6.1.3" xref="S3.E3.m1.6.6.6.6.6.6.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.6.6.6.6.6.6.1.1a" xref="S3.E3.m1.6.6.6.6.6.6.1.1.cmml">​</mo><mi id="S3.E3.m1.6.6.6.6.6.6.1.4" xref="S3.E3.m1.6.6.6.6.6.6.1.4.cmml">g</mi></mrow></msub></mrow><mo id="S3.E3.m1.7.7.7.7.7.7" xref="S3.E3.m1.7.7.7.7.7.7.cmml">+</mo><mrow id="S3.E3.m1.14.14.14.14.14a.15.2" xref="S3.E3.m1.14.15.1.cmml"><msub id="S3.E3.m1.14.14.14.14.14a.15.2.2" xref="S3.E3.m1.14.15.1.cmml"><mi id="S3.E3.m1.8.8.8.8.8.8" xref="S3.E3.m1.8.8.8.8.8.8.cmml">λ</mi><mn id="S3.E3.m1.9.9.9.9.9.9.1" xref="S3.E3.m1.9.9.9.9.9.9.1.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.14.14.14.14.14a.15.2.1" xref="S3.E3.m1.14.15.1.cmml">​</mo><msub id="S3.E3.m1.14.14.14.14.14a.15.2.3" xref="S3.E3.m1.14.15.1.cmml"><mi id="S3.E3.m1.10.10.10.10.10.10" xref="S3.E3.m1.10.10.10.10.10.10.cmml">L</mi><mrow id="S3.E3.m1.11.11.11.11.11.11.1" xref="S3.E3.m1.11.11.11.11.11.11.1.cmml"><mi id="S3.E3.m1.11.11.11.11.11.11.1.2" xref="S3.E3.m1.11.11.11.11.11.11.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.11.11.11.11.11.11.1.1" xref="S3.E3.m1.11.11.11.11.11.11.1.1.cmml">​</mo><mi id="S3.E3.m1.11.11.11.11.11.11.1.3" xref="S3.E3.m1.11.11.11.11.11.11.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.11.11.11.11.11.11.1.1a" xref="S3.E3.m1.11.11.11.11.11.11.1.1.cmml">​</mo><mi id="S3.E3.m1.11.11.11.11.11.11.1.4" xref="S3.E3.m1.11.11.11.11.11.11.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.11.11.11.11.11.11.1.1b" xref="S3.E3.m1.11.11.11.11.11.11.1.1.cmml">​</mo><mi id="S3.E3.m1.11.11.11.11.11.11.1.5" xref="S3.E3.m1.11.11.11.11.11.11.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.11.11.11.11.11.11.1.1c" xref="S3.E3.m1.11.11.11.11.11.11.1.1.cmml">​</mo><mi id="S3.E3.m1.11.11.11.11.11.11.1.6" xref="S3.E3.m1.11.11.11.11.11.11.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.11.11.11.11.11.11.1.1d" xref="S3.E3.m1.11.11.11.11.11.11.1.1.cmml">​</mo><mi id="S3.E3.m1.11.11.11.11.11.11.1.7" xref="S3.E3.m1.11.11.11.11.11.11.1.7.cmml">r</mi></mrow></msub></mrow><mo id="S3.E3.m1.7.7.7.7.7.7a" xref="S3.E3.m1.7.7.7.7.7.7.cmml">+</mo><msub id="S3.E3.m1.14.14.14.14.14a.15.3" xref="S3.E3.m1.14.15.1.cmml"><mi id="S3.E3.m1.13.13.13.13.13.13" xref="S3.E3.m1.13.13.13.13.13.13.cmml">L</mi><mrow id="S3.E3.m1.14.14.14.14.14.14.1" xref="S3.E3.m1.14.14.14.14.14.14.1.cmml"><mi id="S3.E3.m1.14.14.14.14.14.14.1.2" xref="S3.E3.m1.14.14.14.14.14.14.1.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.14.14.14.14.14.14.1.1" xref="S3.E3.m1.14.14.14.14.14.14.1.1.cmml">​</mo><mi id="S3.E3.m1.14.14.14.14.14.14.1.3" xref="S3.E3.m1.14.14.14.14.14.14.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.14.14.14.14.14.14.1.1a" xref="S3.E3.m1.14.14.14.14.14.14.1.1.cmml">​</mo><mi id="S3.E3.m1.14.14.14.14.14.14.1.4" xref="S3.E3.m1.14.14.14.14.14.14.1.4.cmml">x</mi></mrow></msub></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.14b"><apply id="S3.E3.m1.14.15.1.cmml" xref="S3.E3.m1.14.14a"><eq id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2"></eq><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝐿</ci><apply id="S3.E3.m1.14.15.1.3.cmml" xref="S3.E3.m1.14.14a"><plus id="S3.E3.m1.7.7.7.7.7.7.cmml" xref="S3.E3.m1.7.7.7.7.7.7"></plus><apply id="S3.E3.m1.14.15.1.3.2.cmml" xref="S3.E3.m1.14.14a"><times id="S3.E3.m1.14.15.1.3.2.1.cmml" xref="S3.E3.m1.14.14a"></times><apply id="S3.E3.m1.14.15.1.3.2.2.cmml" xref="S3.E3.m1.14.14a"><csymbol cd="ambiguous" id="S3.E3.m1.14.15.1.3.2.2.1.cmml" xref="S3.E3.m1.14.14a">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3">𝜆</ci><cn type="integer" id="S3.E3.m1.4.4.4.4.4.4.1.cmml" xref="S3.E3.m1.4.4.4.4.4.4.1">1</cn></apply><apply id="S3.E3.m1.14.15.1.3.2.3.cmml" xref="S3.E3.m1.14.14a"><csymbol cd="ambiguous" id="S3.E3.m1.14.15.1.3.2.3.1.cmml" xref="S3.E3.m1.14.14a">subscript</csymbol><ci id="S3.E3.m1.5.5.5.5.5.5.cmml" xref="S3.E3.m1.5.5.5.5.5.5">𝐿</ci><apply id="S3.E3.m1.6.6.6.6.6.6.1.cmml" xref="S3.E3.m1.6.6.6.6.6.6.1"><times id="S3.E3.m1.6.6.6.6.6.6.1.1.cmml" xref="S3.E3.m1.6.6.6.6.6.6.1.1"></times><ci id="S3.E3.m1.6.6.6.6.6.6.1.2.cmml" xref="S3.E3.m1.6.6.6.6.6.6.1.2">𝑠</ci><ci id="S3.E3.m1.6.6.6.6.6.6.1.3.cmml" xref="S3.E3.m1.6.6.6.6.6.6.1.3">𝑒</ci><ci id="S3.E3.m1.6.6.6.6.6.6.1.4.cmml" xref="S3.E3.m1.6.6.6.6.6.6.1.4">𝑔</ci></apply></apply></apply><apply id="S3.E3.m1.14.15.1.3.3.cmml" xref="S3.E3.m1.14.14a"><times id="S3.E3.m1.14.15.1.3.3.1.cmml" xref="S3.E3.m1.14.14a"></times><apply id="S3.E3.m1.14.15.1.3.3.2.cmml" xref="S3.E3.m1.14.14a"><csymbol cd="ambiguous" id="S3.E3.m1.14.15.1.3.3.2.1.cmml" xref="S3.E3.m1.14.14a">subscript</csymbol><ci id="S3.E3.m1.8.8.8.8.8.8.cmml" xref="S3.E3.m1.8.8.8.8.8.8">𝜆</ci><cn type="integer" id="S3.E3.m1.9.9.9.9.9.9.1.cmml" xref="S3.E3.m1.9.9.9.9.9.9.1">2</cn></apply><apply id="S3.E3.m1.14.15.1.3.3.3.cmml" xref="S3.E3.m1.14.14a"><csymbol cd="ambiguous" id="S3.E3.m1.14.15.1.3.3.3.1.cmml" xref="S3.E3.m1.14.14a">subscript</csymbol><ci id="S3.E3.m1.10.10.10.10.10.10.cmml" xref="S3.E3.m1.10.10.10.10.10.10">𝐿</ci><apply id="S3.E3.m1.11.11.11.11.11.11.1.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1"><times id="S3.E3.m1.11.11.11.11.11.11.1.1.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1.1"></times><ci id="S3.E3.m1.11.11.11.11.11.11.1.2.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1.2">𝑐</ci><ci id="S3.E3.m1.11.11.11.11.11.11.1.3.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1.3">𝑒</ci><ci id="S3.E3.m1.11.11.11.11.11.11.1.4.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1.4">𝑛</ci><ci id="S3.E3.m1.11.11.11.11.11.11.1.5.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1.5">𝑡</ci><ci id="S3.E3.m1.11.11.11.11.11.11.1.6.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1.6">𝑒</ci><ci id="S3.E3.m1.11.11.11.11.11.11.1.7.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1.7">𝑟</ci></apply></apply></apply><apply id="S3.E3.m1.14.15.1.3.4.cmml" xref="S3.E3.m1.14.14a"><csymbol cd="ambiguous" id="S3.E3.m1.14.15.1.3.4.1.cmml" xref="S3.E3.m1.14.14a">subscript</csymbol><ci id="S3.E3.m1.13.13.13.13.13.13.cmml" xref="S3.E3.m1.13.13.13.13.13.13">𝐿</ci><apply id="S3.E3.m1.14.14.14.14.14.14.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1"><times id="S3.E3.m1.14.14.14.14.14.14.1.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.1"></times><ci id="S3.E3.m1.14.14.14.14.14.14.1.2.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.2">𝑏</ci><ci id="S3.E3.m1.14.14.14.14.14.14.1.3.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.3">𝑜</ci><ci id="S3.E3.m1.14.14.14.14.14.14.1.4.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1.4">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.14c">\displaystyle\begin{split}L=\lambda_{1}L_{seg}+\lambda_{2}L_{center}+L_{box}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS5.p3" class="ltx_para ltx_noindent">
<p id="S3.SS5.p3.4" class="ltx_p">in which <math id="S3.SS5.p3.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS5.p3.1.m1.1a"><mi id="S3.SS5.p3.1.m1.1.1" xref="S3.SS5.p3.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.1.m1.1b"><ci id="S3.SS5.p3.1.m1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.1.m1.1c">L</annotation></semantics></math> means the total losses. <math id="S3.SS5.p3.2.m2.1" class="ltx_Math" alttext="L_{seg}" display="inline"><semantics id="S3.SS5.p3.2.m2.1a"><msub id="S3.SS5.p3.2.m2.1.1" xref="S3.SS5.p3.2.m2.1.1.cmml"><mi id="S3.SS5.p3.2.m2.1.1.2" xref="S3.SS5.p3.2.m2.1.1.2.cmml">L</mi><mrow id="S3.SS5.p3.2.m2.1.1.3" xref="S3.SS5.p3.2.m2.1.1.3.cmml"><mi id="S3.SS5.p3.2.m2.1.1.3.2" xref="S3.SS5.p3.2.m2.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p3.2.m2.1.1.3.1" xref="S3.SS5.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p3.2.m2.1.1.3.3" xref="S3.SS5.p3.2.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p3.2.m2.1.1.3.1a" xref="S3.SS5.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p3.2.m2.1.1.3.4" xref="S3.SS5.p3.2.m2.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.2.m2.1b"><apply id="S3.SS5.p3.2.m2.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.1.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.p3.2.m2.1.1.2.cmml" xref="S3.SS5.p3.2.m2.1.1.2">𝐿</ci><apply id="S3.SS5.p3.2.m2.1.1.3.cmml" xref="S3.SS5.p3.2.m2.1.1.3"><times id="S3.SS5.p3.2.m2.1.1.3.1.cmml" xref="S3.SS5.p3.2.m2.1.1.3.1"></times><ci id="S3.SS5.p3.2.m2.1.1.3.2.cmml" xref="S3.SS5.p3.2.m2.1.1.3.2">𝑠</ci><ci id="S3.SS5.p3.2.m2.1.1.3.3.cmml" xref="S3.SS5.p3.2.m2.1.1.3.3">𝑒</ci><ci id="S3.SS5.p3.2.m2.1.1.3.4.cmml" xref="S3.SS5.p3.2.m2.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.2.m2.1c">L_{seg}</annotation></semantics></math> is focal loss for foreground segmentation. <math id="S3.SS5.p3.3.m3.1" class="ltx_Math" alttext="L_{center}" display="inline"><semantics id="S3.SS5.p3.3.m3.1a"><msub id="S3.SS5.p3.3.m3.1.1" xref="S3.SS5.p3.3.m3.1.1.cmml"><mi id="S3.SS5.p3.3.m3.1.1.2" xref="S3.SS5.p3.3.m3.1.1.2.cmml">L</mi><mrow id="S3.SS5.p3.3.m3.1.1.3" xref="S3.SS5.p3.3.m3.1.1.3.cmml"><mi id="S3.SS5.p3.3.m3.1.1.3.2" xref="S3.SS5.p3.3.m3.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p3.3.m3.1.1.3.1" xref="S3.SS5.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p3.3.m3.1.1.3.3" xref="S3.SS5.p3.3.m3.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p3.3.m3.1.1.3.1a" xref="S3.SS5.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p3.3.m3.1.1.3.4" xref="S3.SS5.p3.3.m3.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p3.3.m3.1.1.3.1b" xref="S3.SS5.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p3.3.m3.1.1.3.5" xref="S3.SS5.p3.3.m3.1.1.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p3.3.m3.1.1.3.1c" xref="S3.SS5.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p3.3.m3.1.1.3.6" xref="S3.SS5.p3.3.m3.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p3.3.m3.1.1.3.1d" xref="S3.SS5.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p3.3.m3.1.1.3.7" xref="S3.SS5.p3.3.m3.1.1.3.7.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.3.m3.1b"><apply id="S3.SS5.p3.3.m3.1.1.cmml" xref="S3.SS5.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.3.m3.1.1.1.cmml" xref="S3.SS5.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS5.p3.3.m3.1.1.2.cmml" xref="S3.SS5.p3.3.m3.1.1.2">𝐿</ci><apply id="S3.SS5.p3.3.m3.1.1.3.cmml" xref="S3.SS5.p3.3.m3.1.1.3"><times id="S3.SS5.p3.3.m3.1.1.3.1.cmml" xref="S3.SS5.p3.3.m3.1.1.3.1"></times><ci id="S3.SS5.p3.3.m3.1.1.3.2.cmml" xref="S3.SS5.p3.3.m3.1.1.3.2">𝑐</ci><ci id="S3.SS5.p3.3.m3.1.1.3.3.cmml" xref="S3.SS5.p3.3.m3.1.1.3.3">𝑒</ci><ci id="S3.SS5.p3.3.m3.1.1.3.4.cmml" xref="S3.SS5.p3.3.m3.1.1.3.4">𝑛</ci><ci id="S3.SS5.p3.3.m3.1.1.3.5.cmml" xref="S3.SS5.p3.3.m3.1.1.3.5">𝑡</ci><ci id="S3.SS5.p3.3.m3.1.1.3.6.cmml" xref="S3.SS5.p3.3.m3.1.1.3.6">𝑒</ci><ci id="S3.SS5.p3.3.m3.1.1.3.7.cmml" xref="S3.SS5.p3.3.m3.1.1.3.7">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.3.m3.1c">L_{center}</annotation></semantics></math> is also based on focal loss but for object-center heatmap estimation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. <math id="S3.SS5.p3.4.m4.1" class="ltx_Math" alttext="L_{box}" display="inline"><semantics id="S3.SS5.p3.4.m4.1a"><msub id="S3.SS5.p3.4.m4.1.1" xref="S3.SS5.p3.4.m4.1.1.cmml"><mi id="S3.SS5.p3.4.m4.1.1.2" xref="S3.SS5.p3.4.m4.1.1.2.cmml">L</mi><mrow id="S3.SS5.p3.4.m4.1.1.3" xref="S3.SS5.p3.4.m4.1.1.3.cmml"><mi id="S3.SS5.p3.4.m4.1.1.3.2" xref="S3.SS5.p3.4.m4.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p3.4.m4.1.1.3.1" xref="S3.SS5.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p3.4.m4.1.1.3.3" xref="S3.SS5.p3.4.m4.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p3.4.m4.1.1.3.1a" xref="S3.SS5.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p3.4.m4.1.1.3.4" xref="S3.SS5.p3.4.m4.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.4.m4.1b"><apply id="S3.SS5.p3.4.m4.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.4.m4.1.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS5.p3.4.m4.1.1.2.cmml" xref="S3.SS5.p3.4.m4.1.1.2">𝐿</ci><apply id="S3.SS5.p3.4.m4.1.1.3.cmml" xref="S3.SS5.p3.4.m4.1.1.3"><times id="S3.SS5.p3.4.m4.1.1.3.1.cmml" xref="S3.SS5.p3.4.m4.1.1.3.1"></times><ci id="S3.SS5.p3.4.m4.1.1.3.2.cmml" xref="S3.SS5.p3.4.m4.1.1.3.2">𝑏</ci><ci id="S3.SS5.p3.4.m4.1.1.3.3.cmml" xref="S3.SS5.p3.4.m4.1.1.3.3">𝑜</ci><ci id="S3.SS5.p3.4.m4.1.1.3.4.cmml" xref="S3.SS5.p3.4.m4.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.4.m4.1c">L_{box}</annotation></semantics></math> contains SmoothL1 losses for box azimuth, center offsets and sizes regression. A detailed explanation is in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.</p>
</div>
<div id="S3.SS5.p4" class="ltx_para">
<p id="S3.SS5.p4.1" class="ltx_p">The training randomness introduced in LiDAR sequence sampling enables the model to be robust to various
motion patterns of pillar trajectories across time.
Thus our recurrent model can understand different object dynamics, and generalize to variable frame lengths during inference without retraining.
More experiments and analysis are provided in <a href="#S4.T6" title="TABLE VI ‣ IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table VI</span></a> and the ablation studies.</p>
</div>
</section>
<section id="S3.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS6.5.1.1" class="ltx_text">III-F</span> </span><span id="S3.SS6.6.2" class="ltx_text ltx_font_italic">Implementation Details</span>
</h3>

<div id="S3.SS6.p1" class="ltx_para">
<p id="S3.SS6.p1.8" class="ltx_p">We conduct 3D object detection within a wide range of 164<math id="S3.SS6.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.SS6.p1.1.m1.1a"><mo id="S3.SS6.p1.1.m1.1.1" xref="S3.SS6.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.1.m1.1b"><times id="S3.SS6.p1.1.m1.1.1.cmml" xref="S3.SS6.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.1.m1.1c">\times</annotation></semantics></math>164 meters (<math id="S3.SS6.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS6.p1.2.m2.1a"><mi id="S3.SS6.p1.2.m2.1.1" xref="S3.SS6.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.2.m2.1b"><ci id="S3.SS6.p1.2.m2.1.1.cmml" xref="S3.SS6.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.2.m2.1c">m</annotation></semantics></math>) square zone, centering on the top LiDAR sensor. Point clouds inside this region are voxelized into 2D pillars with 0.32<math id="S3.SS6.p1.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS6.p1.3.m3.1a"><mi id="S3.SS6.p1.3.m3.1.1" xref="S3.SS6.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.3.m3.1b"><ci id="S3.SS6.p1.3.m3.1.1.cmml" xref="S3.SS6.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.3.m3.1c">m</annotation></semantics></math> spatial resolutions.
The window attention blocks are based on 10<math id="S3.SS6.p1.4.m4.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.SS6.p1.4.m4.1a"><mo id="S3.SS6.p1.4.m4.1.1" xref="S3.SS6.p1.4.m4.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.4.m4.1b"><times id="S3.SS6.p1.4.m4.1.1.cmml" xref="S3.SS6.p1.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.4.m4.1c">\times</annotation></semantics></math>10 grouping sizes.
The loss weights <math id="S3.SS6.p1.5.m5.1" class="ltx_Math" alttext="\lambda_{1}" display="inline"><semantics id="S3.SS6.p1.5.m5.1a"><msub id="S3.SS6.p1.5.m5.1.1" xref="S3.SS6.p1.5.m5.1.1.cmml"><mi id="S3.SS6.p1.5.m5.1.1.2" xref="S3.SS6.p1.5.m5.1.1.2.cmml">λ</mi><mn id="S3.SS6.p1.5.m5.1.1.3" xref="S3.SS6.p1.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.5.m5.1b"><apply id="S3.SS6.p1.5.m5.1.1.cmml" xref="S3.SS6.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS6.p1.5.m5.1.1.1.cmml" xref="S3.SS6.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS6.p1.5.m5.1.1.2.cmml" xref="S3.SS6.p1.5.m5.1.1.2">𝜆</ci><cn type="integer" id="S3.SS6.p1.5.m5.1.1.3.cmml" xref="S3.SS6.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.5.m5.1c">\lambda_{1}</annotation></semantics></math>, <math id="S3.SS6.p1.6.m6.1" class="ltx_Math" alttext="\lambda_{2}" display="inline"><semantics id="S3.SS6.p1.6.m6.1a"><msub id="S3.SS6.p1.6.m6.1.1" xref="S3.SS6.p1.6.m6.1.1.cmml"><mi id="S3.SS6.p1.6.m6.1.1.2" xref="S3.SS6.p1.6.m6.1.1.2.cmml">λ</mi><mn id="S3.SS6.p1.6.m6.1.1.3" xref="S3.SS6.p1.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.6.m6.1b"><apply id="S3.SS6.p1.6.m6.1.1.cmml" xref="S3.SS6.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS6.p1.6.m6.1.1.1.cmml" xref="S3.SS6.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS6.p1.6.m6.1.1.2.cmml" xref="S3.SS6.p1.6.m6.1.1.2">𝜆</ci><cn type="integer" id="S3.SS6.p1.6.m6.1.1.3.cmml" xref="S3.SS6.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.6.m6.1c">\lambda_{2}</annotation></semantics></math> defined in (<a href="#S3.E3" title="In III-E Stochastic-Length FrameDrop ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) are 200, 10 respectively.
We use AdamW <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> optimizer with 128 batch sizes and 240<math id="S3.SS6.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS6.p1.7.m7.1a"><mi id="S3.SS6.p1.7.m7.1.1" xref="S3.SS6.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.7.m7.1b"><ci id="S3.SS6.p1.7.m7.1.1.cmml" xref="S3.SS6.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.7.m7.1c">k</annotation></semantics></math> iterations for distributed training on 128 TPUv3. The training takes about 2 days.
TPU memory usage is 5.4 GB on average and 7.4 GB at peak.
The first 10<math id="S3.SS6.p1.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS6.p1.8.m8.1a"><mi id="S3.SS6.p1.8.m8.1.1" xref="S3.SS6.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.8.m8.1b"><ci id="S3.SS6.p1.8.m8.1.1.cmml" xref="S3.SS6.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.8.m8.1c">k</annotation></semantics></math> steps will warm up the learning rate from 5.0e-4 to 1.0e-3, after which the learning rate will follow a cosine annealing schedule to zero.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T2.3.1.1" class="ltx_text" style="font-size:90%;">TABLE II</span>: </span><span id="S3.T2.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Detection results on challenging large objects<span id="S3.T2.4.2.1" class="ltx_text ltx_font_medium">.</span></span></figcaption>
<div id="S3.T2.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:368.6pt;height:111.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(35.5pt,-10.7pt) scale(1.23857381266639,1.23857381266639) ;">
<table id="S3.T2.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.5.1.1.1" class="ltx_tr">
<th id="S3.T2.5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S3.T2.5.1.1.1.1.1" class="ltx_text">Method</span></th>
<th id="S3.T2.5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2">L1</th>
<th id="S3.T2.5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">L2</th>
</tr>
<tr id="S3.T2.5.1.2.2" class="ltx_tr">
<th id="S3.T2.5.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">2D</th>
<th id="S3.T2.5.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">3D</th>
<th id="S3.T2.5.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">2D</th>
<th id="S3.T2.5.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">3D</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.5.1.3.1" class="ltx_tr">
<th id="S3.T2.5.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">RSN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</th>
<td id="S3.T2.5.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53.10</td>
<td id="S3.T2.5.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">45.20</td>
<td id="S3.T2.5.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S3.T2.5.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t">40.90</td>
</tr>
<tr id="S3.T2.5.1.4.2" class="ltx_tr">
<th id="S3.T2.5.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>
</th>
<td id="S3.T2.5.1.4.2.2" class="ltx_td ltx_align_center ltx_border_r">58.33</td>
<td id="S3.T2.5.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">49.74</td>
<td id="S3.T2.5.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">53.45</td>
<td id="S3.T2.5.1.4.2.5" class="ltx_td ltx_align_center">45.23</td>
</tr>
<tr id="S3.T2.5.1.5.3" class="ltx_tr">
<th id="S3.T2.5.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S3.T2.5.1.5.3.1.1" class="ltx_text ltx_font_bold">LEF (ours)</span></th>
<td id="S3.T2.5.1.5.3.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T2.5.1.5.3.2.1" class="ltx_text ltx_font_bold">62.63</span></td>
<td id="S3.T2.5.1.5.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T2.5.1.5.3.3.1" class="ltx_text ltx_font_bold">54.35</span></td>
<td id="S3.T2.5.1.5.3.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T2.5.1.5.3.4.1" class="ltx_text ltx_font_bold">57.42</span></td>
<td id="S3.T2.5.1.5.3.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T2.5.1.5.3.5.1" class="ltx_text ltx_font_bold">49.34</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we will compare our model with other state-of-the-art methods, and perform ablation studies upon the impact of our designs on detection performance.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Dataset and Backbone</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.6" class="ltx_p">We choose Waymo Open Dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> over nuScenes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> and KITTI <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> because WOD has large-scale and high-quality LiDAR data, which can better simulate the settings for developing on-road fully autonomous vehicles.
There are about 160<math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">k</annotation></semantics></math> annotated training frames in WOD but only around 30<math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">k</annotation></semantics></math> frames in nuScenes.
As for per-frame point cloud densities, WOD is <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mo id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><csymbol cd="latexml" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\sim</annotation></semantics></math>200<math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">k</annotation></semantics></math> and nuScenes is <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mo id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><csymbol cd="latexml" id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\sim</annotation></semantics></math>30<math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">k</annotation></semantics></math>.
Therefore WOD is widely used in recent LiDAR-based methods: PV-RCNN(++), SST, RSN, SWFormer and so on <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>.
WOD has 798 training sequences, 202 validation and 150 test sequences, covering diverse driving scenarios and agent status.
LiDAR data collection frequency is 10Hz.
Each frame of point clouds consists of data gathered from five sensors: one long-range and four short-range LiDAR.
For evaluation metrics, we adopt the officially recommended 3D AP / APH under two difficulty levels (L1, L2) depending on point densities of the ground-truth bounding boxes. APH is a weighted metric of AP using heading angles (<span id="S4.SS1.p1.6.1" class="ltx_text ltx_font_italic">i</span>.<span id="S4.SS1.p1.6.2" class="ltx_text ltx_font_italic">e</span>., azimuth).</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">We adopt the state-of-the-art SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> as our detection backbone, and replace its original early-to-early LiDAR fusion with our proposed LEF. For fair comparisons, all training settings are kept the same as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.6.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.7.2" class="ltx_text ltx_font_italic">Main Results and Comparisons</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The overall vehicle detection results with other competing methods are in <a href="#S3.T1" title="TABLE I ‣ III-D Window-based Attention Fusion ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table I</span></a>.
We compare against methods both with and without box refinement steps, although our model is a single-stage method without refinement and generally more efficient than those with box refinement.
Our method LEF surpasses the prior best single-stage model SWFormer by +1.3 3D APH on L2 test data (<span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">e</span>.<span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_italic">g</span>. 75.16 <span id="S4.SS2.p1.1.3" class="ltx_text ltx_font_italic">vs</span>. 73.87), demonstrating the strong overall performance of our approach.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Our method is particularly useful for detecting challenging large objects whose maximum dimension is beyond 7 meters: truck, bus, construction vehicle, <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_italic">etc</span>. We conduct detailed analysis on validation set in <a href="#S3.T2" title="TABLE II ‣ III-F Implementation Details ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table II</span></a>.
Our method LEF outperforms SWFormer by +9.3% relative increase on L1 3D AP: 54.35 <span id="S4.SS2.p2.1.2" class="ltx_text ltx_font_italic">vs</span>. 49.74.
Hard cases such as large vehicles suffer from partial observation issues more often than small or medium size objects. Faithfully detecting these challenging cases requires LiDAR temporal fusion at long frame lengths in order to enlarge the sensory data coverage. Moreover, our late-to-early fusion scheme can reuse learned scene and object-aware latent features from prior frames, not simply stacking the point clouds as in RSN and SWFormer. Such high-level history knowledge can enable the model to more easily tackle challenging detection cases, compared with solving them from scratch using stacked raw sensory inputs.
</p>
</div>
<figure id="S4.F3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2309.16870/assets/x4.png" id="S4.SS2.1.g1" class="ltx_graphics ltx_figure_panel ltx_img_square" width="461" height="492" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.3.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.4.2" class="ltx_text" style="font-size:90%;">
Box colors are explain in the legend.
<span id="S4.F3.4.2.1" class="ltx_text ltx_font_italic">Errors of the baseline SWFormer</span> are highlighted in dashed red regions.</span></figcaption>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Qualitative results are visualized in <a href="#S4.F3" title="Figure 3 ‣ IV-B Main Results and Comparisons ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 3</span></a>. Typical errors of SWFormer are highlighted in the red zones. Our results are aligned better (<span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_italic">i</span>.<span id="S4.SS2.p3.1.2" class="ltx_text ltx_font_italic">e</span>., have higher 3D IoU) with the ground truth boxes than SWFormer predictions, especially for challenging large objects. Moreover, our results contain fewer false negative and false positive predictions than SWFormer results. We also measure model latency, flops and parameter sizes of different LiDAR 3D object detectors in <a href="#S4.T3" title="TABLE III ‣ IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table III</span></a>, following the same benchmark settings as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. PointPillars and SWFormer both use point stacking. The results demonstrate the efficiency advantages of our late-to-early recurrent fusion method.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">Ablation Studies</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p"><span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_bold">Fusion strategy.</span>
We conduct apple-to-apple comparisons to study the effect of early-to-early (E2E), late-to-late (L2L) and late-to-early (L2E) fusion strategies as illustrated in <a href="#S1.F1.sf1" title="1(a) ‣ Figure 1 ‣ I Introduction ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>.
Specifically, we test all fusion variants with the same backbone and frame number (<span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_italic">i</span>.<span id="S4.SS3.p1.1.3" class="ltx_text ltx_font_italic">e</span>., 3) to factorize out the influence of model architectures and LiDAR sequence lengths.
Results on validation set large objects are in <a href="#S4.T4" title="TABLE IV ‣ IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table IV</span></a>.
Our L2E fusion surpasses the other two methods with 7.8% relative gains on L1 3D AP. By comparing E2E and L2L fusion, we observe that their results on 2D AP are comparable. But E2E clearly outperforms L2L on 3D AP, indicating higher 3D object detection quality.
These results validate our arguments about the benefits of late-to-early fusion. Compared with E2E fusion, L2E enables the model to reuse learned scene and object-aware knowledge from prior frames. Compared with L2L, the model capacity of L2E fusion is not constrained because its backbone has early access to the temporally aggregated sensory data.
</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.3.1.1" class="ltx_text" style="font-size:90%;">TABLE III</span>: </span><span id="S4.T3.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Computation cost<span id="S4.T3.4.2.1" class="ltx_text ltx_font_medium">. For fair comparisons, we use 3-frame temporal fusion settings on WOD for measurement.</span></span></figcaption>
<div id="S4.T3.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:364.2pt;height:82pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(22.2pt,-5.0pt) scale(1.13875166460065,1.13875166460065) ;">
<table id="S4.T3.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.5.1.1.1" class="ltx_tr">
<th id="S4.T3.5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Method</th>
<th id="S4.T3.5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Latency</th>
<th id="S4.T3.5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Flops</th>
<th id="S4.T3.5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Parameters</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.5.1.2.1" class="ltx_tr">
<th id="S4.T3.5.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">PointPillars <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>
</th>
<td id="S4.T3.5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">93ms</td>
<td id="S4.T3.5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">375G</td>
<td id="S4.T3.5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">6.4M</td>
</tr>
<tr id="S4.T3.5.1.3.2" class="ltx_tr">
<th id="S4.T3.5.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>
</th>
<td id="S4.T3.5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">47ms</td>
<td id="S4.T3.5.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r">35G</td>
<td id="S4.T3.5.1.3.2.4" class="ltx_td ltx_align_center">4.4M</td>
</tr>
<tr id="S4.T3.5.1.4.3" class="ltx_tr">
<th id="S4.T3.5.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S4.T3.5.1.4.3.1.1" class="ltx_text ltx_font_bold">LEF (ours)</span></th>
<td id="S4.T3.5.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T3.5.1.4.3.2.1" class="ltx_text ltx_font_bold">38ms</span></td>
<td id="S4.T3.5.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T3.5.1.4.3.3.1" class="ltx_text ltx_font_bold">29G</span></td>
<td id="S4.T3.5.1.4.3.4" class="ltx_td ltx_align_center ltx_border_bb">4.6M</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.3.1.1" class="ltx_text" style="font-size:90%;">TABLE IV</span>: </span><span id="S4.T4.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Ablation studies on different types of temporal fusion schemes<span id="S4.T4.4.2.1" class="ltx_text ltx_font_medium">. All methods are trained with SLF.</span></span></figcaption>
<div id="S4.T4.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:368.6pt;height:159.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(74.3pt,-32.2pt) scale(1.67578179958414,1.67578179958414) ;">
<table id="S4.T4.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.5.1.1.1" class="ltx_tr">
<th id="S4.T4.5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Fusion Strategy</th>
<th id="S4.T4.5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2">
<table id="S4.T4.5.1.1.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.5.1.1.1.2.1.1" class="ltx_tr">
<td id="S4.T4.5.1.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">L1</td>
</tr>
<tr id="S4.T4.5.1.1.1.2.1.2" class="ltx_tr">
<td id="S4.T4.5.1.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">2D       3D</td>
</tr>
</table>
</th>
<th id="S4.T4.5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">
<table id="S4.T4.5.1.1.1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.5.1.1.1.3.1.1" class="ltx_tr">
<td id="S4.T4.5.1.1.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">L2</td>
</tr>
<tr id="S4.T4.5.1.1.1.3.1.2" class="ltx_tr">
<td id="S4.T4.5.1.1.1.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">2D       3D</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.5.1.2.1" class="ltx_tr">
<th id="S4.T4.5.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Early-to-Early</th>
<td id="S4.T4.5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">58.33</td>
<td id="S4.T4.5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">49.74</td>
<td id="S4.T4.5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53.45</td>
<td id="S4.T4.5.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">45.23</td>
</tr>
<tr id="S4.T4.5.1.3.2" class="ltx_tr">
<th id="S4.T4.5.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Late-to-Late</th>
<td id="S4.T4.5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">58.74</td>
<td id="S4.T4.5.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r">48.83</td>
<td id="S4.T4.5.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r">53.67</td>
<td id="S4.T4.5.1.3.2.5" class="ltx_td ltx_align_center">44.32</td>
</tr>
<tr id="S4.T4.5.1.4.3" class="ltx_tr">
<th id="S4.T4.5.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S4.T4.5.1.4.3.1.1" class="ltx_text ltx_font_bold">Late-to-Early</span></th>
<td id="S4.T4.5.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T4.5.1.4.3.2.1" class="ltx_text ltx_font_bold">61.46</span></td>
<td id="S4.T4.5.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T4.5.1.4.3.3.1" class="ltx_text ltx_font_bold">53.13</span></td>
<td id="S4.T4.5.1.4.3.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T4.5.1.4.3.4.1" class="ltx_text ltx_font_bold">56.37</span></td>
<td id="S4.T4.5.1.4.3.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.5.1.4.3.5.1" class="ltx_text ltx_font_bold">48.28</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T5.3.1.1" class="ltx_text" style="font-size:90%;">TABLE V</span>: </span><span id="S4.T5.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Ablation studies on different object sizes<span id="S4.T5.4.2.1" class="ltx_text ltx_font_medium">. The 3D AP gains achieved by LEF increase as object size grows.</span></span></figcaption>
<div id="S4.T5.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:96.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(15.0pt,-3.3pt) scale(1.0744230354213,1.0744230354213) ;">
<table id="S4.T5.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.5.1.1.1" class="ltx_tr">
<th id="S4.T5.5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T5.5.1.1.1.1.1" class="ltx_text">Method</span></th>
<th id="S4.T5.5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="3">L1</th>
<th id="S4.T5.5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">L2</th>
</tr>
<tr id="S4.T5.5.1.2.2" class="ltx_tr">
<th id="S4.T5.5.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">Large</th>
<th id="S4.T5.5.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">Medium</th>
<th id="S4.T5.5.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">Small</th>
<th id="S4.T5.5.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">Large</th>
<th id="S4.T5.5.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">Medium</th>
<th id="S4.T5.5.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">Small</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.5.1.3.1" class="ltx_tr">
<th id="S4.T5.5.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">RSN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</th>
<td id="S4.T5.5.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">45.20</td>
<td id="S4.T5.5.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">77.30</td>
<td id="S4.T5.5.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">79.40</td>
<td id="S4.T5.5.1.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">40.90</td>
<td id="S4.T5.5.1.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.60</td>
<td id="S4.T5.5.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">69.90</td>
</tr>
<tr id="S4.T5.5.1.4.2" class="ltx_tr">
<th id="S4.T5.5.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>
</th>
<td id="S4.T5.5.1.4.2.2" class="ltx_td ltx_align_center ltx_border_r">49.74</td>
<td id="S4.T5.5.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">79.11</td>
<td id="S4.T5.5.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">82.36</td>
<td id="S4.T5.5.1.4.2.5" class="ltx_td ltx_align_center ltx_border_r">45.23</td>
<td id="S4.T5.5.1.4.2.6" class="ltx_td ltx_align_center ltx_border_r">70.59</td>
<td id="S4.T5.5.1.4.2.7" class="ltx_td ltx_align_center">74.04</td>
</tr>
<tr id="S4.T5.5.1.5.3" class="ltx_tr">
<th id="S4.T5.5.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S4.T5.5.1.5.3.1.1" class="ltx_text ltx_font_bold">LEF (ours)</span></th>
<td id="S4.T5.5.1.5.3.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T5.5.1.5.3.2.1" class="ltx_text ltx_font_bold">54.35</span></td>
<td id="S4.T5.5.1.5.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T5.5.1.5.3.3.1" class="ltx_text ltx_font_bold">79.62</span></td>
<td id="S4.T5.5.1.5.3.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T5.5.1.5.3.4.1" class="ltx_text ltx_font_bold">82.46</span></td>
<td id="S4.T5.5.1.5.3.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T5.5.1.5.3.5.1" class="ltx_text ltx_font_bold">49.34</span></td>
<td id="S4.T5.5.1.5.3.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T5.5.1.5.3.6.1" class="ltx_text ltx_font_bold">71.32</span></td>
<td id="S4.T5.5.1.5.3.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.5.1.5.3.7.1" class="ltx_text ltx_font_bold">74.15</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">Different object sizes.</span>
Besides the overall results and hard example analysis in Section <a href="#S4.SS2" title="IV-B Main Results and Comparisons ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-B</span></span></a>, we are also interested in knowing the impact of our method on different object sizes.
Thus we divide validation set objects into: large, medium and small. Typical large objects are bus and truck. Medium and small objects usually include sedan and pedestrian, respectively. Detailed results are in <a href="#S4.T5" title="TABLE V ‣ IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table V</span></a>.
Although our method LEF achieves comparable results with the competing methods on small objects, we observe increasingly more gains as object sizes grow larger. On L2 medium objects, LEF improves SWFormer by 0.73 AP and the gains further bump to 4.11 AP on large objects.
One possible explanation is that small objects suffer less from partial-view observation issues than large objects, and thus do not significantly benefit from temporal fusion.
From the results we believe that our method works robustly across different object sizes.
</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">Frame length generalization.</span>
Due to memory constraint of the computing devices, GPU or TPU, 3D object detectors with LiDAR temporal fusion usually sample a fixed number of history frames (<span id="S4.SS3.p3.1.2" class="ltx_text ltx_font_italic">e</span>.<span id="S4.SS3.p3.1.3" class="ltx_text ltx_font_italic">g</span>. 2 or 3) during training. However, during inference, there are usually additional frames available to the model depending on the history lengths. For typical early-to-early fusion based multi-frame detectors (<span id="S4.SS3.p3.1.4" class="ltx_text ltx_font_italic">e</span>.<span id="S4.SS3.p3.1.5" class="ltx_text ltx_font_italic">g</span>. CenterPoint, SWFormer), if we want to test a trained model on different frame lengths, the training settings need to be modified and the model needs to be retrained.
With stochastic-length FrameDrop (SLF), LEF can generalize to variable frame lengths <span id="S4.SS3.p3.1.6" class="ltx_text ltx_font_italic">without</span> retraining.
It can leverage additional frames and achieve increasingly improved results.
Large objects 3D AP are shown in <a href="#S4.T6" title="TABLE VI ‣ IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table VI</span></a>.
In contrast, SWFormer and LEF without SLF can not make best of long history and might even face performance decrease. This is because long history frames can exhibit diverse motion patterns of temporally aggregated data, posing generalization difficulties for methods trained without SLF. Moreover, since SWFormer is based on point cloud stacking, it will run into OOM if we simply stack
a long LiDAR sequence into millions of 3D points
and use them as inputs. These observations indicate that stochastic-length FrameDrop and recurrent fusion are critical in generalizing our method LEF to variable frame lengths during inference.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.4" class="ltx_p"><span id="S4.SS3.p4.4.1" class="ltx_text ltx_font_bold">Foreground pillar segmentation.</span> To efficiently fuse history pillar features in a recurrent manner, we apply BEV foreground segmentation before passing history latent pillar embeddings into the next frame.
the number of history pillars that need to be recurrently fused can be reduced from <math id="S4.SS3.p4.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS3.p4.1.m1.1a"><mo id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><csymbol cd="latexml" id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">\sim</annotation></semantics></math>20<math id="S4.SS3.p4.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p4.2.m2.1a"><mi id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><ci id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">k</annotation></semantics></math> to <math id="S4.SS3.p4.3.m3.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.SS3.p4.3.m3.1a"><mo id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><csymbol cd="latexml" id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">\sim</annotation></semantics></math>2<math id="S4.SS3.p4.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p4.4.m4.1a"><mi id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.1b"><ci id="S4.SS3.p4.4.m4.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.1c">k</annotation></semantics></math> on average after removing a huge amount of uninformative background data.
Therefore the computation burden of our late-to-early temporal fusion scheme can be greatly reduced and maintained at a relatively low constant cost.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T6.4.1.1" class="ltx_text" style="font-size:90%;">TABLE VI</span>: </span><span id="S4.T6.5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Long frame history generalization studies<span id="S4.T6.5.2.1" class="ltx_text ltx_font_medium">. For each trained model, we evaluate its inference generalization ability to different frame (f) lengths <span id="S4.T6.5.2.1.1" class="ltx_text ltx_font_italic">without</span> retraining.
</span></span></figcaption>
<div id="S4.T6.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:104.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(29.6pt,-7.1pt) scale(1.1582911934764,1.1582911934764) ;">
<table id="S4.T6.6.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.6.1.1.1" class="ltx_tr">
<th id="S4.T6.6.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T6.6.1.1.1.1.1" class="ltx_text">Method</span></th>
<th id="S4.T6.6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="3">L1</th>
<th id="S4.T6.6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">L2</th>
</tr>
<tr id="S4.T6.6.1.2.2" class="ltx_tr">
<th id="S4.T6.6.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">3-f</th>
<th id="S4.T6.6.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">6-f</th>
<th id="S4.T6.6.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">9-f</th>
<th id="S4.T6.6.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">3-f</th>
<th id="S4.T6.6.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">6-f</th>
<th id="S4.T6.6.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">9-f</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.6.1.3.1" class="ltx_tr">
<th id="S4.T6.6.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">SWFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>
</th>
<td id="S4.T6.6.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">46.23</td>
<td id="S4.T6.6.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">38.76</td>
<td id="S4.T6.6.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">OOM</td>
<td id="S4.T6.6.1.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">41.93</td>
<td id="S4.T6.6.1.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">35.09</td>
<td id="S4.T6.6.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">OOM</td>
</tr>
<tr id="S4.T6.6.1.4.2" class="ltx_tr">
<th id="S4.T6.6.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">LEF (w/o SLF)</th>
<td id="S4.T6.6.1.4.2.2" class="ltx_td ltx_align_center ltx_border_r">51.18</td>
<td id="S4.T6.6.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">51.44</td>
<td id="S4.T6.6.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">50.84</td>
<td id="S4.T6.6.1.4.2.5" class="ltx_td ltx_align_center ltx_border_r">46.58</td>
<td id="S4.T6.6.1.4.2.6" class="ltx_td ltx_align_center ltx_border_r">46.91</td>
<td id="S4.T6.6.1.4.2.7" class="ltx_td ltx_align_center">46.28</td>
</tr>
<tr id="S4.T6.6.1.5.3" class="ltx_tr">
<th id="S4.T6.6.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S4.T6.6.1.5.3.1.1" class="ltx_text ltx_font_bold">LEF (with SLF)</span></th>
<td id="S4.T6.6.1.5.3.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T6.6.1.5.3.2.1" class="ltx_text ltx_font_bold">53.13</span></td>
<td id="S4.T6.6.1.5.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T6.6.1.5.3.3.1" class="ltx_text ltx_font_bold">53.96</span></td>
<td id="S4.T6.6.1.5.3.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T6.6.1.5.3.4.1" class="ltx_text ltx_font_bold">54.35</span></td>
<td id="S4.T6.6.1.5.3.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T6.6.1.5.3.5.1" class="ltx_text ltx_font_bold">48.28</span></td>
<td id="S4.T6.6.1.5.3.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T6.6.1.5.3.6.1" class="ltx_text ltx_font_bold">48.99</span></td>
<td id="S4.T6.6.1.5.3.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T6.6.1.5.3.7.1" class="ltx_text ltx_font_bold">49.34</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T7.3.1.1" class="ltx_text" style="font-size:90%;">TABLE VII</span>: </span><span id="S4.T7.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Inverse calibration and alignment (ICA)<span id="S4.T7.4.2.1" class="ltx_text ltx_font_medium"> can improve detection AP across different object sizes.</span></span></figcaption>
<div id="S4.T7.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:398.9pt;height:118pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(77.7pt,-23.0pt) scale(1.63868536620451,1.63868536620451) ;">
<table id="S4.T7.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T7.5.1.1.1" class="ltx_tr">
<th id="S4.T7.5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T7.5.1.1.1.1.1" class="ltx_text">ICA</span></th>
<th id="S4.T7.5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2">Large</th>
<th id="S4.T7.5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2">Medium</th>
<th id="S4.T7.5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">Small</th>
</tr>
<tr id="S4.T7.5.1.2.2" class="ltx_tr">
<th id="S4.T7.5.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">2D</th>
<th id="S4.T7.5.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">3D</th>
<th id="S4.T7.5.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">2D</th>
<th id="S4.T7.5.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">3D</th>
<th id="S4.T7.5.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">2D</th>
<th id="S4.T7.5.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">3D</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T7.5.1.3.1" class="ltx_tr">
<th id="S4.T7.5.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">w/o</th>
<td id="S4.T7.5.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60.85</td>
<td id="S4.T7.5.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">51.34</td>
<td id="S4.T7.5.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">92.72</td>
<td id="S4.T7.5.1.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.30</td>
<td id="S4.T7.5.1.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">85.92</td>
<td id="S4.T7.5.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">80.59</td>
</tr>
<tr id="S4.T7.5.1.4.2" class="ltx_tr">
<th id="S4.T7.5.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S4.T7.5.1.4.2.1.1" class="ltx_text ltx_font_bold">with</span></th>
<td id="S4.T7.5.1.4.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T7.5.1.4.2.2.1" class="ltx_text ltx_font_bold">62.63</span></td>
<td id="S4.T7.5.1.4.2.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T7.5.1.4.2.3.1" class="ltx_text ltx_font_bold">54.35</span></td>
<td id="S4.T7.5.1.4.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T7.5.1.4.2.4.1" class="ltx_text ltx_font_bold">93.02</span></td>
<td id="S4.T7.5.1.4.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T7.5.1.4.2.5.1" class="ltx_text ltx_font_bold">79.62</span></td>
<td id="S4.T7.5.1.4.2.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T7.5.1.4.2.6.1" class="ltx_text ltx_font_bold">87.40</span></td>
<td id="S4.T7.5.1.4.2.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T7.5.1.4.2.7.1" class="ltx_text ltx_font_bold">82.46</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.1" class="ltx_p"><span id="S4.SS3.p5.1.1" class="ltx_text ltx_font_bold">Inverse calibration and alignment.</span>
Inverse calibration and alignment, as illustrated in <a href="#S3.F2" title="Figure 2 ‣ III-A Problem Statement ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>, is important for fusing two sparse sets of pillar features between the prior and the current frames. Features belonging to the same underlying static objects can be effectively aligned after this temporal alignment process.
In <a href="#S4.T7" title="TABLE VII ‣ IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table VII</span></a> we show that inverse calibration and alignment achieves consistent detection improvement across different size objects, including truck, sedan, pedestrian, and so on.</p>
</div>
<figure id="S4.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T8.3.1.1" class="ltx_text" style="font-size:90%;">TABLE VIII</span>: </span><span id="S4.T8.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Variants of window-based attention blocks for recurrent temporal fusion<span id="S4.T8.4.2.1" class="ltx_text ltx_font_medium">.
Based on the comparisons, we adopt self-attention as default in other experiments.</span></span></figcaption>
<div id="S4.T8.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:357.7pt;height:144.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(67.8pt,-27.4pt) scale(1.60980533497872,1.60980533497872) ;">
<table id="S4.T8.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T8.5.1.1.1" class="ltx_tr">
<th id="S4.T8.5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T8.5.1.1.1.1.1" class="ltx_text">Attention Type</span></th>
<th id="S4.T8.5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2">L1</th>
<th id="S4.T8.5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">L2</th>
</tr>
<tr id="S4.T8.5.1.2.2" class="ltx_tr">
<th id="S4.T8.5.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">2D</th>
<th id="S4.T8.5.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">3D</th>
<th id="S4.T8.5.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">2D</th>
<th id="S4.T8.5.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">3D</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T8.5.1.3.1" class="ltx_tr">
<th id="S4.T8.5.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Cross-Attn</th>
<td id="S4.T8.5.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">51.69</td>
<td id="S4.T8.5.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">42.35</td>
<td id="S4.T8.5.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t">47.06</td>
<td id="S4.T8.5.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t">38.36</td>
</tr>
<tr id="S4.T8.5.1.4.2" class="ltx_tr">
<th id="S4.T8.5.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Mix-Attn</th>
<td id="S4.T8.5.1.4.2.2" class="ltx_td ltx_align_center">61.68</td>
<td id="S4.T8.5.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">52.94</td>
<td id="S4.T8.5.1.4.2.4" class="ltx_td ltx_align_center">56.46</td>
<td id="S4.T8.5.1.4.2.5" class="ltx_td ltx_align_center">48.06</td>
</tr>
<tr id="S4.T8.5.1.5.3" class="ltx_tr">
<th id="S4.T8.5.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S4.T8.5.1.5.3.1.1" class="ltx_text ltx_font_bold">Self-Attn</span></th>
<td id="S4.T8.5.1.5.3.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T8.5.1.5.3.2.1" class="ltx_text ltx_font_bold">62.63</span></td>
<td id="S4.T8.5.1.5.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T8.5.1.5.3.3.1" class="ltx_text ltx_font_bold">54.35</span></td>
<td id="S4.T8.5.1.5.3.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T8.5.1.5.3.4.1" class="ltx_text ltx_font_bold">57.42</span></td>
<td id="S4.T8.5.1.5.3.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T8.5.1.5.3.5.1" class="ltx_text ltx_font_bold">49.34</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T9.3.1.1" class="ltx_text" style="font-size:90%;">TABLE IX</span>: </span><span id="S4.T9.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">The impact of window-based self-attention on different speed objects<span id="S4.T9.4.2.1" class="ltx_text ltx_font_medium">.</span></span></figcaption>
<div id="S4.T9.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:83pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(75.7pt,-14.5pt) scale(1.53644610642403,1.53644610642403) ;">
<table id="S4.T9.5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T9.5.1.1.1" class="ltx_tr">
<th id="S4.T9.5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_rr ltx_border_tt">Self-Attention</th>
<th id="S4.T9.5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Static</th>
<th id="S4.T9.5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Slow</th>
<th id="S4.T9.5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_rr ltx_border_tt">Medium</th>
<th id="S4.T9.5.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Fast</th>
<th id="S4.T9.5.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Very Fast</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T9.5.1.2.1" class="ltx_tr">
<td id="S4.T9.5.1.2.1.1" class="ltx_td ltx_align_left ltx_border_rr ltx_border_t">without</td>
<td id="S4.T9.5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60.55</td>
<td id="S4.T9.5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63.46</td>
<td id="S4.T9.5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">74.58</td>
<td id="S4.T9.5.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53.07</td>
<td id="S4.T9.5.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">75.47</td>
</tr>
<tr id="S4.T9.5.1.3.2" class="ltx_tr">
<td id="S4.T9.5.1.3.2.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_rr"><span id="S4.T9.5.1.3.2.1.1" class="ltx_text ltx_font_bold">with</span></td>
<td id="S4.T9.5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T9.5.1.3.2.2.1" class="ltx_text ltx_font_bold">66.62</span></td>
<td id="S4.T9.5.1.3.2.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T9.5.1.3.2.3.1" class="ltx_text ltx_font_bold">69.27</span></td>
<td id="S4.T9.5.1.3.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_rr"><span id="S4.T9.5.1.3.2.4.1" class="ltx_text ltx_font_bold">79.62</span></td>
<td id="S4.T9.5.1.3.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T9.5.1.3.2.5.1" class="ltx_text ltx_font_bold">62.46</span></td>
<td id="S4.T9.5.1.3.2.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T9.5.1.3.2.6.1" class="ltx_text ltx_font_bold">82.14</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS3.p6" class="ltx_para">
<p id="S4.SS3.p6.9" class="ltx_p"><span id="S4.SS3.p6.9.1" class="ltx_text ltx_font_bold">Window-based Attention Fusion.</span> We apply window-based attention blocks on temporally aligned sparse pillar tokens to further fuse information of the history and current frames. As explained in Section <a href="#S3.SS4" title="III-D Window-based Attention Fusion ‣ III Method ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a>, we explore three different attention designs: self / cross / mix-attention.
Detection AP on large objects of WOD validation set are shown in <a href="#S4.T8" title="TABLE VIII ‣ IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table VIII</span></a>.
For all methods, we use the sparse set of pillar tokens <math id="S4.SS3.p6.1.m1.3" class="ltx_Math" alttext="\{V^{{}^{\prime\prime}}_{i,u}\}" display="inline"><semantics id="S4.SS3.p6.1.m1.3a"><mrow id="S4.SS3.p6.1.m1.3.3.1" xref="S4.SS3.p6.1.m1.3.3.2.cmml"><mo stretchy="false" id="S4.SS3.p6.1.m1.3.3.1.2" xref="S4.SS3.p6.1.m1.3.3.2.cmml">{</mo><msubsup id="S4.SS3.p6.1.m1.3.3.1.1" xref="S4.SS3.p6.1.m1.3.3.1.1.cmml"><mi id="S4.SS3.p6.1.m1.3.3.1.1.2.2" xref="S4.SS3.p6.1.m1.3.3.1.1.2.2.cmml">V</mi><mrow id="S4.SS3.p6.1.m1.2.2.2.4" xref="S4.SS3.p6.1.m1.2.2.2.3.cmml"><mi id="S4.SS3.p6.1.m1.1.1.1.1" xref="S4.SS3.p6.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p6.1.m1.2.2.2.4.1" xref="S4.SS3.p6.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p6.1.m1.2.2.2.2" xref="S4.SS3.p6.1.m1.2.2.2.2.cmml">u</mi></mrow><msup id="S4.SS3.p6.1.m1.3.3.1.1.2.3" xref="S4.SS3.p6.1.m1.3.3.1.1.2.3.cmml"><mi id="S4.SS3.p6.1.m1.3.3.1.1.2.3a" xref="S4.SS3.p6.1.m1.3.3.1.1.2.3.cmml"></mi><mo id="S4.SS3.p6.1.m1.3.3.1.1.2.3.1" xref="S4.SS3.p6.1.m1.3.3.1.1.2.3.1.cmml">′′</mo></msup></msubsup><mo stretchy="false" id="S4.SS3.p6.1.m1.3.3.1.3" xref="S4.SS3.p6.1.m1.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.3b"><set id="S4.SS3.p6.1.m1.3.3.2.cmml" xref="S4.SS3.p6.1.m1.3.3.1"><apply id="S4.SS3.p6.1.m1.3.3.1.1.cmml" xref="S4.SS3.p6.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.3.3.1.1.1.cmml" xref="S4.SS3.p6.1.m1.3.3.1.1">subscript</csymbol><apply id="S4.SS3.p6.1.m1.3.3.1.1.2.cmml" xref="S4.SS3.p6.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.3.3.1.1.2.1.cmml" xref="S4.SS3.p6.1.m1.3.3.1.1">superscript</csymbol><ci id="S4.SS3.p6.1.m1.3.3.1.1.2.2.cmml" xref="S4.SS3.p6.1.m1.3.3.1.1.2.2">𝑉</ci><apply id="S4.SS3.p6.1.m1.3.3.1.1.2.3.cmml" xref="S4.SS3.p6.1.m1.3.3.1.1.2.3"><ci id="S4.SS3.p6.1.m1.3.3.1.1.2.3.1.cmml" xref="S4.SS3.p6.1.m1.3.3.1.1.2.3.1">′′</ci></apply></apply><list id="S4.SS3.p6.1.m1.2.2.2.3.cmml" xref="S4.SS3.p6.1.m1.2.2.2.4"><ci id="S4.SS3.p6.1.m1.1.1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS3.p6.1.m1.2.2.2.2.cmml" xref="S4.SS3.p6.1.m1.2.2.2.2">𝑢</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.3c">\{V^{{}^{\prime\prime}}_{i,u}\}</annotation></semantics></math> converted from the temporally aligned BEV feature map <math id="S4.SS3.p6.2.m2.1" class="ltx_Math" alttext="J^{{}^{\prime}}_{i}" display="inline"><semantics id="S4.SS3.p6.2.m2.1a"><msubsup id="S4.SS3.p6.2.m2.1.1" xref="S4.SS3.p6.2.m2.1.1.cmml"><mi id="S4.SS3.p6.2.m2.1.1.2.2" xref="S4.SS3.p6.2.m2.1.1.2.2.cmml">J</mi><mi id="S4.SS3.p6.2.m2.1.1.3" xref="S4.SS3.p6.2.m2.1.1.3.cmml">i</mi><msup id="S4.SS3.p6.2.m2.1.1.2.3" xref="S4.SS3.p6.2.m2.1.1.2.3.cmml"><mi id="S4.SS3.p6.2.m2.1.1.2.3a" xref="S4.SS3.p6.2.m2.1.1.2.3.cmml"></mi><mo id="S4.SS3.p6.2.m2.1.1.2.3.1" xref="S4.SS3.p6.2.m2.1.1.2.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m2.1b"><apply id="S4.SS3.p6.2.m2.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m2.1.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1">subscript</csymbol><apply id="S4.SS3.p6.2.m2.1.1.2.cmml" xref="S4.SS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m2.1.1.2.1.cmml" xref="S4.SS3.p6.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p6.2.m2.1.1.2.2.cmml" xref="S4.SS3.p6.2.m2.1.1.2.2">𝐽</ci><apply id="S4.SS3.p6.2.m2.1.1.2.3.cmml" xref="S4.SS3.p6.2.m2.1.1.2.3"><ci id="S4.SS3.p6.2.m2.1.1.2.3.1.cmml" xref="S4.SS3.p6.2.m2.1.1.2.3.1">′</ci></apply></apply><ci id="S4.SS3.p6.2.m2.1.1.3.cmml" xref="S4.SS3.p6.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m2.1c">J^{{}^{\prime}}_{i}</annotation></semantics></math> as the query tensor.
In self-attention, query, key and value are based on the same tensor.
In cross-attention, the key and value tensors are the sparse set of pillar tokens <math id="S4.SS3.p6.3.m3.3" class="ltx_Math" alttext="\{\tilde{V}_{i-1,c}\}" display="inline"><semantics id="S4.SS3.p6.3.m3.3a"><mrow id="S4.SS3.p6.3.m3.3.3.1" xref="S4.SS3.p6.3.m3.3.3.2.cmml"><mo stretchy="false" id="S4.SS3.p6.3.m3.3.3.1.2" xref="S4.SS3.p6.3.m3.3.3.2.cmml">{</mo><msub id="S4.SS3.p6.3.m3.3.3.1.1" xref="S4.SS3.p6.3.m3.3.3.1.1.cmml"><mover accent="true" id="S4.SS3.p6.3.m3.3.3.1.1.2" xref="S4.SS3.p6.3.m3.3.3.1.1.2.cmml"><mi id="S4.SS3.p6.3.m3.3.3.1.1.2.2" xref="S4.SS3.p6.3.m3.3.3.1.1.2.2.cmml">V</mi><mo id="S4.SS3.p6.3.m3.3.3.1.1.2.1" xref="S4.SS3.p6.3.m3.3.3.1.1.2.1.cmml">~</mo></mover><mrow id="S4.SS3.p6.3.m3.2.2.2.2" xref="S4.SS3.p6.3.m3.2.2.2.3.cmml"><mrow id="S4.SS3.p6.3.m3.2.2.2.2.1" xref="S4.SS3.p6.3.m3.2.2.2.2.1.cmml"><mi id="S4.SS3.p6.3.m3.2.2.2.2.1.2" xref="S4.SS3.p6.3.m3.2.2.2.2.1.2.cmml">i</mi><mo id="S4.SS3.p6.3.m3.2.2.2.2.1.1" xref="S4.SS3.p6.3.m3.2.2.2.2.1.1.cmml">−</mo><mn id="S4.SS3.p6.3.m3.2.2.2.2.1.3" xref="S4.SS3.p6.3.m3.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS3.p6.3.m3.2.2.2.2.2" xref="S4.SS3.p6.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p6.3.m3.1.1.1.1" xref="S4.SS3.p6.3.m3.1.1.1.1.cmml">c</mi></mrow></msub><mo stretchy="false" id="S4.SS3.p6.3.m3.3.3.1.3" xref="S4.SS3.p6.3.m3.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.3.m3.3b"><set id="S4.SS3.p6.3.m3.3.3.2.cmml" xref="S4.SS3.p6.3.m3.3.3.1"><apply id="S4.SS3.p6.3.m3.3.3.1.1.cmml" xref="S4.SS3.p6.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.3.m3.3.3.1.1.1.cmml" xref="S4.SS3.p6.3.m3.3.3.1.1">subscript</csymbol><apply id="S4.SS3.p6.3.m3.3.3.1.1.2.cmml" xref="S4.SS3.p6.3.m3.3.3.1.1.2"><ci id="S4.SS3.p6.3.m3.3.3.1.1.2.1.cmml" xref="S4.SS3.p6.3.m3.3.3.1.1.2.1">~</ci><ci id="S4.SS3.p6.3.m3.3.3.1.1.2.2.cmml" xref="S4.SS3.p6.3.m3.3.3.1.1.2.2">𝑉</ci></apply><list id="S4.SS3.p6.3.m3.2.2.2.3.cmml" xref="S4.SS3.p6.3.m3.2.2.2.2"><apply id="S4.SS3.p6.3.m3.2.2.2.2.1.cmml" xref="S4.SS3.p6.3.m3.2.2.2.2.1"><minus id="S4.SS3.p6.3.m3.2.2.2.2.1.1.cmml" xref="S4.SS3.p6.3.m3.2.2.2.2.1.1"></minus><ci id="S4.SS3.p6.3.m3.2.2.2.2.1.2.cmml" xref="S4.SS3.p6.3.m3.2.2.2.2.1.2">𝑖</ci><cn type="integer" id="S4.SS3.p6.3.m3.2.2.2.2.1.3.cmml" xref="S4.SS3.p6.3.m3.2.2.2.2.1.3">1</cn></apply><ci id="S4.SS3.p6.3.m3.1.1.1.1.cmml" xref="S4.SS3.p6.3.m3.1.1.1.1">𝑐</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.3.m3.3c">\{\tilde{V}_{i-1,c}\}</annotation></semantics></math> converted from the calibrated history features <math id="S4.SS3.p6.4.m4.1" class="ltx_Math" alttext="\tilde{I}_{i-1}" display="inline"><semantics id="S4.SS3.p6.4.m4.1a"><msub id="S4.SS3.p6.4.m4.1.1" xref="S4.SS3.p6.4.m4.1.1.cmml"><mover accent="true" id="S4.SS3.p6.4.m4.1.1.2" xref="S4.SS3.p6.4.m4.1.1.2.cmml"><mi id="S4.SS3.p6.4.m4.1.1.2.2" xref="S4.SS3.p6.4.m4.1.1.2.2.cmml">I</mi><mo id="S4.SS3.p6.4.m4.1.1.2.1" xref="S4.SS3.p6.4.m4.1.1.2.1.cmml">~</mo></mover><mrow id="S4.SS3.p6.4.m4.1.1.3" xref="S4.SS3.p6.4.m4.1.1.3.cmml"><mi id="S4.SS3.p6.4.m4.1.1.3.2" xref="S4.SS3.p6.4.m4.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p6.4.m4.1.1.3.1" xref="S4.SS3.p6.4.m4.1.1.3.1.cmml">−</mo><mn id="S4.SS3.p6.4.m4.1.1.3.3" xref="S4.SS3.p6.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.4.m4.1b"><apply id="S4.SS3.p6.4.m4.1.1.cmml" xref="S4.SS3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.4.m4.1.1.1.cmml" xref="S4.SS3.p6.4.m4.1.1">subscript</csymbol><apply id="S4.SS3.p6.4.m4.1.1.2.cmml" xref="S4.SS3.p6.4.m4.1.1.2"><ci id="S4.SS3.p6.4.m4.1.1.2.1.cmml" xref="S4.SS3.p6.4.m4.1.1.2.1">~</ci><ci id="S4.SS3.p6.4.m4.1.1.2.2.cmml" xref="S4.SS3.p6.4.m4.1.1.2.2">𝐼</ci></apply><apply id="S4.SS3.p6.4.m4.1.1.3.cmml" xref="S4.SS3.p6.4.m4.1.1.3"><minus id="S4.SS3.p6.4.m4.1.1.3.1.cmml" xref="S4.SS3.p6.4.m4.1.1.3.1"></minus><ci id="S4.SS3.p6.4.m4.1.1.3.2.cmml" xref="S4.SS3.p6.4.m4.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS3.p6.4.m4.1.1.3.3.cmml" xref="S4.SS3.p6.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.4.m4.1c">\tilde{I}_{i-1}</annotation></semantics></math>.
Mix-attention uses the union set of prior methods as key and value.
We observe that self-attention consistently outperforms the other two attention variants. This is presumably because the history tokens exist in a quite different latent space from the temporally aligned tokens. Therefore attention between <math id="S4.SS3.p6.5.m5.3" class="ltx_Math" alttext="\{\tilde{V}_{i-1,c}\}" display="inline"><semantics id="S4.SS3.p6.5.m5.3a"><mrow id="S4.SS3.p6.5.m5.3.3.1" xref="S4.SS3.p6.5.m5.3.3.2.cmml"><mo stretchy="false" id="S4.SS3.p6.5.m5.3.3.1.2" xref="S4.SS3.p6.5.m5.3.3.2.cmml">{</mo><msub id="S4.SS3.p6.5.m5.3.3.1.1" xref="S4.SS3.p6.5.m5.3.3.1.1.cmml"><mover accent="true" id="S4.SS3.p6.5.m5.3.3.1.1.2" xref="S4.SS3.p6.5.m5.3.3.1.1.2.cmml"><mi id="S4.SS3.p6.5.m5.3.3.1.1.2.2" xref="S4.SS3.p6.5.m5.3.3.1.1.2.2.cmml">V</mi><mo id="S4.SS3.p6.5.m5.3.3.1.1.2.1" xref="S4.SS3.p6.5.m5.3.3.1.1.2.1.cmml">~</mo></mover><mrow id="S4.SS3.p6.5.m5.2.2.2.2" xref="S4.SS3.p6.5.m5.2.2.2.3.cmml"><mrow id="S4.SS3.p6.5.m5.2.2.2.2.1" xref="S4.SS3.p6.5.m5.2.2.2.2.1.cmml"><mi id="S4.SS3.p6.5.m5.2.2.2.2.1.2" xref="S4.SS3.p6.5.m5.2.2.2.2.1.2.cmml">i</mi><mo id="S4.SS3.p6.5.m5.2.2.2.2.1.1" xref="S4.SS3.p6.5.m5.2.2.2.2.1.1.cmml">−</mo><mn id="S4.SS3.p6.5.m5.2.2.2.2.1.3" xref="S4.SS3.p6.5.m5.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS3.p6.5.m5.2.2.2.2.2" xref="S4.SS3.p6.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p6.5.m5.1.1.1.1" xref="S4.SS3.p6.5.m5.1.1.1.1.cmml">c</mi></mrow></msub><mo stretchy="false" id="S4.SS3.p6.5.m5.3.3.1.3" xref="S4.SS3.p6.5.m5.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.5.m5.3b"><set id="S4.SS3.p6.5.m5.3.3.2.cmml" xref="S4.SS3.p6.5.m5.3.3.1"><apply id="S4.SS3.p6.5.m5.3.3.1.1.cmml" xref="S4.SS3.p6.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.5.m5.3.3.1.1.1.cmml" xref="S4.SS3.p6.5.m5.3.3.1.1">subscript</csymbol><apply id="S4.SS3.p6.5.m5.3.3.1.1.2.cmml" xref="S4.SS3.p6.5.m5.3.3.1.1.2"><ci id="S4.SS3.p6.5.m5.3.3.1.1.2.1.cmml" xref="S4.SS3.p6.5.m5.3.3.1.1.2.1">~</ci><ci id="S4.SS3.p6.5.m5.3.3.1.1.2.2.cmml" xref="S4.SS3.p6.5.m5.3.3.1.1.2.2">𝑉</ci></apply><list id="S4.SS3.p6.5.m5.2.2.2.3.cmml" xref="S4.SS3.p6.5.m5.2.2.2.2"><apply id="S4.SS3.p6.5.m5.2.2.2.2.1.cmml" xref="S4.SS3.p6.5.m5.2.2.2.2.1"><minus id="S4.SS3.p6.5.m5.2.2.2.2.1.1.cmml" xref="S4.SS3.p6.5.m5.2.2.2.2.1.1"></minus><ci id="S4.SS3.p6.5.m5.2.2.2.2.1.2.cmml" xref="S4.SS3.p6.5.m5.2.2.2.2.1.2">𝑖</ci><cn type="integer" id="S4.SS3.p6.5.m5.2.2.2.2.1.3.cmml" xref="S4.SS3.p6.5.m5.2.2.2.2.1.3">1</cn></apply><ci id="S4.SS3.p6.5.m5.1.1.1.1.cmml" xref="S4.SS3.p6.5.m5.1.1.1.1">𝑐</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.5.m5.3c">\{\tilde{V}_{i-1,c}\}</annotation></semantics></math> and <math id="S4.SS3.p6.6.m6.3" class="ltx_Math" alttext="\{V^{{}^{\prime\prime}}_{i,u}\}" display="inline"><semantics id="S4.SS3.p6.6.m6.3a"><mrow id="S4.SS3.p6.6.m6.3.3.1" xref="S4.SS3.p6.6.m6.3.3.2.cmml"><mo stretchy="false" id="S4.SS3.p6.6.m6.3.3.1.2" xref="S4.SS3.p6.6.m6.3.3.2.cmml">{</mo><msubsup id="S4.SS3.p6.6.m6.3.3.1.1" xref="S4.SS3.p6.6.m6.3.3.1.1.cmml"><mi id="S4.SS3.p6.6.m6.3.3.1.1.2.2" xref="S4.SS3.p6.6.m6.3.3.1.1.2.2.cmml">V</mi><mrow id="S4.SS3.p6.6.m6.2.2.2.4" xref="S4.SS3.p6.6.m6.2.2.2.3.cmml"><mi id="S4.SS3.p6.6.m6.1.1.1.1" xref="S4.SS3.p6.6.m6.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p6.6.m6.2.2.2.4.1" xref="S4.SS3.p6.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p6.6.m6.2.2.2.2" xref="S4.SS3.p6.6.m6.2.2.2.2.cmml">u</mi></mrow><msup id="S4.SS3.p6.6.m6.3.3.1.1.2.3" xref="S4.SS3.p6.6.m6.3.3.1.1.2.3.cmml"><mi id="S4.SS3.p6.6.m6.3.3.1.1.2.3a" xref="S4.SS3.p6.6.m6.3.3.1.1.2.3.cmml"></mi><mo id="S4.SS3.p6.6.m6.3.3.1.1.2.3.1" xref="S4.SS3.p6.6.m6.3.3.1.1.2.3.1.cmml">′′</mo></msup></msubsup><mo stretchy="false" id="S4.SS3.p6.6.m6.3.3.1.3" xref="S4.SS3.p6.6.m6.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.6.m6.3b"><set id="S4.SS3.p6.6.m6.3.3.2.cmml" xref="S4.SS3.p6.6.m6.3.3.1"><apply id="S4.SS3.p6.6.m6.3.3.1.1.cmml" xref="S4.SS3.p6.6.m6.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.6.m6.3.3.1.1.1.cmml" xref="S4.SS3.p6.6.m6.3.3.1.1">subscript</csymbol><apply id="S4.SS3.p6.6.m6.3.3.1.1.2.cmml" xref="S4.SS3.p6.6.m6.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.6.m6.3.3.1.1.2.1.cmml" xref="S4.SS3.p6.6.m6.3.3.1.1">superscript</csymbol><ci id="S4.SS3.p6.6.m6.3.3.1.1.2.2.cmml" xref="S4.SS3.p6.6.m6.3.3.1.1.2.2">𝑉</ci><apply id="S4.SS3.p6.6.m6.3.3.1.1.2.3.cmml" xref="S4.SS3.p6.6.m6.3.3.1.1.2.3"><ci id="S4.SS3.p6.6.m6.3.3.1.1.2.3.1.cmml" xref="S4.SS3.p6.6.m6.3.3.1.1.2.3.1">′′</ci></apply></apply><list id="S4.SS3.p6.6.m6.2.2.2.3.cmml" xref="S4.SS3.p6.6.m6.2.2.2.4"><ci id="S4.SS3.p6.6.m6.1.1.1.1.cmml" xref="S4.SS3.p6.6.m6.1.1.1.1">𝑖</ci><ci id="S4.SS3.p6.6.m6.2.2.2.2.cmml" xref="S4.SS3.p6.6.m6.2.2.2.2">𝑢</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.6.m6.3c">\{V^{{}^{\prime\prime}}_{i,u}\}</annotation></semantics></math> might easily lead to intractable feature fusion and eventually hurt detection. Meanwhile, since <math id="S4.SS3.p6.7.m7.1" class="ltx_Math" alttext="J^{{}^{\prime}}_{i}" display="inline"><semantics id="S4.SS3.p6.7.m7.1a"><msubsup id="S4.SS3.p6.7.m7.1.1" xref="S4.SS3.p6.7.m7.1.1.cmml"><mi id="S4.SS3.p6.7.m7.1.1.2.2" xref="S4.SS3.p6.7.m7.1.1.2.2.cmml">J</mi><mi id="S4.SS3.p6.7.m7.1.1.3" xref="S4.SS3.p6.7.m7.1.1.3.cmml">i</mi><msup id="S4.SS3.p6.7.m7.1.1.2.3" xref="S4.SS3.p6.7.m7.1.1.2.3.cmml"><mi id="S4.SS3.p6.7.m7.1.1.2.3a" xref="S4.SS3.p6.7.m7.1.1.2.3.cmml"></mi><mo id="S4.SS3.p6.7.m7.1.1.2.3.1" xref="S4.SS3.p6.7.m7.1.1.2.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.7.m7.1b"><apply id="S4.SS3.p6.7.m7.1.1.cmml" xref="S4.SS3.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.7.m7.1.1.1.cmml" xref="S4.SS3.p6.7.m7.1.1">subscript</csymbol><apply id="S4.SS3.p6.7.m7.1.1.2.cmml" xref="S4.SS3.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.7.m7.1.1.2.1.cmml" xref="S4.SS3.p6.7.m7.1.1">superscript</csymbol><ci id="S4.SS3.p6.7.m7.1.1.2.2.cmml" xref="S4.SS3.p6.7.m7.1.1.2.2">𝐽</ci><apply id="S4.SS3.p6.7.m7.1.1.2.3.cmml" xref="S4.SS3.p6.7.m7.1.1.2.3"><ci id="S4.SS3.p6.7.m7.1.1.2.3.1.cmml" xref="S4.SS3.p6.7.m7.1.1.2.3.1">′</ci></apply></apply><ci id="S4.SS3.p6.7.m7.1.1.3.cmml" xref="S4.SS3.p6.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.7.m7.1c">J^{{}^{\prime}}_{i}</annotation></semantics></math> has already merged information from the history <math id="S4.SS3.p6.8.m8.1" class="ltx_Math" alttext="\tilde{I}_{i-1}" display="inline"><semantics id="S4.SS3.p6.8.m8.1a"><msub id="S4.SS3.p6.8.m8.1.1" xref="S4.SS3.p6.8.m8.1.1.cmml"><mover accent="true" id="S4.SS3.p6.8.m8.1.1.2" xref="S4.SS3.p6.8.m8.1.1.2.cmml"><mi id="S4.SS3.p6.8.m8.1.1.2.2" xref="S4.SS3.p6.8.m8.1.1.2.2.cmml">I</mi><mo id="S4.SS3.p6.8.m8.1.1.2.1" xref="S4.SS3.p6.8.m8.1.1.2.1.cmml">~</mo></mover><mrow id="S4.SS3.p6.8.m8.1.1.3" xref="S4.SS3.p6.8.m8.1.1.3.cmml"><mi id="S4.SS3.p6.8.m8.1.1.3.2" xref="S4.SS3.p6.8.m8.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p6.8.m8.1.1.3.1" xref="S4.SS3.p6.8.m8.1.1.3.1.cmml">−</mo><mn id="S4.SS3.p6.8.m8.1.1.3.3" xref="S4.SS3.p6.8.m8.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.8.m8.1b"><apply id="S4.SS3.p6.8.m8.1.1.cmml" xref="S4.SS3.p6.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.8.m8.1.1.1.cmml" xref="S4.SS3.p6.8.m8.1.1">subscript</csymbol><apply id="S4.SS3.p6.8.m8.1.1.2.cmml" xref="S4.SS3.p6.8.m8.1.1.2"><ci id="S4.SS3.p6.8.m8.1.1.2.1.cmml" xref="S4.SS3.p6.8.m8.1.1.2.1">~</ci><ci id="S4.SS3.p6.8.m8.1.1.2.2.cmml" xref="S4.SS3.p6.8.m8.1.1.2.2">𝐼</ci></apply><apply id="S4.SS3.p6.8.m8.1.1.3.cmml" xref="S4.SS3.p6.8.m8.1.1.3"><minus id="S4.SS3.p6.8.m8.1.1.3.1.cmml" xref="S4.SS3.p6.8.m8.1.1.3.1"></minus><ci id="S4.SS3.p6.8.m8.1.1.3.2.cmml" xref="S4.SS3.p6.8.m8.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS3.p6.8.m8.1.1.3.3.cmml" xref="S4.SS3.p6.8.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.8.m8.1c">\tilde{I}_{i-1}</annotation></semantics></math> and the current <math id="S4.SS3.p6.9.m9.1" class="ltx_Math" alttext="I_{i}" display="inline"><semantics id="S4.SS3.p6.9.m9.1a"><msub id="S4.SS3.p6.9.m9.1.1" xref="S4.SS3.p6.9.m9.1.1.cmml"><mi id="S4.SS3.p6.9.m9.1.1.2" xref="S4.SS3.p6.9.m9.1.1.2.cmml">I</mi><mi id="S4.SS3.p6.9.m9.1.1.3" xref="S4.SS3.p6.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.9.m9.1b"><apply id="S4.SS3.p6.9.m9.1.1.cmml" xref="S4.SS3.p6.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.9.m9.1.1.1.cmml" xref="S4.SS3.p6.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.p6.9.m9.1.1.2.cmml" xref="S4.SS3.p6.9.m9.1.1.2">𝐼</ci><ci id="S4.SS3.p6.9.m9.1.1.3.cmml" xref="S4.SS3.p6.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.9.m9.1c">I_{i}</annotation></semantics></math>, self-attention is competent to associate relevant pillar tokens and fulfill the fusion task.</p>
</div>
<div id="S4.SS3.p7" class="ltx_para">
<p id="S4.SS3.p7.1" class="ltx_p">Window-based attention fusion plays an important role in fusing the information from moving object pillars.
In <a href="#S4.T9" title="TABLE IX ‣ IV-C Ablation Studies ‣ IV Experiments ‣ LEF: Late-to-Early Temporal Fusion for LiDAR 3D Object Detection" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table IX</span></a>, we present validation set 3D AP comparisons between with and without window-based self-attention fusion.
We report subcategory metrics under different speed ranges:
[0, 0.45), [0.45, 2.24), [2.24, 6.71), [6.71, 22.37), [22.37, +<math id="S4.SS3.p7.1.m1.1" class="ltx_Math" alttext="\infty" display="inline"><semantics id="S4.SS3.p7.1.m1.1a"><mi mathvariant="normal" id="S4.SS3.p7.1.m1.1.1" xref="S4.SS3.p7.1.m1.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.1.m1.1b"><infinity id="S4.SS3.p7.1.m1.1.1.cmml" xref="S4.SS3.p7.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.1.m1.1c">\infty</annotation></semantics></math>) miles per hour for static, slow, medium, fast, very fast objects.
The metrics are averaged over different size objects.
We observe that attention fusion brings consistent detection gains across different object speed ranges. Particularly, the improvements achieved on high-speed objects are larger than those on low-speed objects: +9.4 (fast) <span id="S4.SS3.p7.1.1" class="ltx_text ltx_font_italic">vs</span>. +6.1 (static) 3D AP gains. The comparisons empirically prove that window-based self-attention fusion is critical in associating relevant pillars that belong to the same underlying objects, which is especially important for moving object detection.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusions and Future Work</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we conduct an in-depth study on the temporal fusion aspect of 3D object detection from LiDAR sequences.
We propose a late-to-early temporal feature fusion method that recurrently extracts sparse pillar features from both object-aware latent embeddings and LiDAR sensor raw inputs.
To handle the alignment issues of static and moving objects, we propose inverse calibration and alignment as well as window-based attention fusion methods.
We also apply foreground segmentation to obtain sparse pillar features from history for computation reduction.
The resulting model, LEF, performs favorably against its base model SWFormer in both detection quality and efficiency. The improvement is especially significant on large objects that require multiple LiDAR sweeps fused across space and time to achieve high surface coverage rate.
</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">As future work, we plan to extend our method to multi-modal sensor fusion with a focus on integrating camera and radar information.
Recurrent late-to-early temporal fusion schemes like ours and BEVFormer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> have been explored in very few papers. To further demonstrate the effectiveness of this approach, it would be beneficial to test it on various backbone models and extend its application beyond the scope of 3D object detection task.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
R. Huang, W. Zhang, A. Kundu, C. Pantofaru, D. A. Ross, T. Funkhouser, and A. Fathi, “An lstm approach to temporal 3d object detection in lidar point clouds,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2020, pp. 266–282.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
S. Shi, C. Guo, L. Jiang, Z. Wang, J. Shi, X. Wang, and H. Li, “Pv-rcnn: Point-voxel feature set abstraction for 3d object detection,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2020, pp. 10 529–10 538.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
S. Shi, L. Jiang, J. Deng, Z. Wang, C. Guo, J. Shi, X. Wang, and H. Li, “Pv-rcnn++: Point-voxel feature set abstraction with local vector representation for 3d object detection,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
T. Yin, X. Zhou, and P. Krahenbuhl, “Center-based 3d object detection and tracking,” in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2021, pp. 11 784–11 793.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
L. Fan, Z. Pang, T. Zhang, Y.-X. Wang, H. Zhao, F. Wang, N. Wang, and Z. Zhang, “Embracing single stride 3d object detector with sparse transformer,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2022, pp. 8458–8468.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
P. Sun, M. Tan, W. Wang, C. Liu, F. Xia, Z. Leng, and D. Anguelov, “Swformer: Sparse window transformer for 3d object detection in point clouds,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
P. Sun, H. Kretzschmar, X. Dotiwalla, A. Chouard, V. Patnaik, P. Tsui, J. Guo, Y. Zhou, Y. Chai, B. Caine, <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Scalability in perception for autonomous driving: Waymo open dataset,” in <em id="bib.bib7.2.2" class="ltx_emph ltx_font_italic">CVPR</em>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
S. Shi, X. Wang, and H. Li, “Pointrcnn: 3d object proposal generation and detection from point cloud,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pp. 770–779, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
C. Qi, W. Liu, C. Wu, H. Su, and L. J. Guibas, “Frustum pointnets for 3d object detection from rgb-d data,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pp. 918–927, 2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
C. Qi, H. Su, K. Mo, and L. J. Guibas, “Pointnet: Deep learning on point sets for 3d classification and segmentation,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
C. Qi, L. Yi, H. Su, and L. J. Guibas, “Pointnet++: Deep hierarchical feature learning on point sets in a metric space,” in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2017.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
B. Graham and L. van der Maaten, “Submanifold sparse convolutional networks,” <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1706.01307</em>, 2017.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, Ł. Kaiser, and I. Polosukhin, “Attention is all you need,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, vol. 30, 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
H. Zhao, L. Jiang, J. Jia, P. H. Torr, and V. Koltun, “Point transformer,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2021, pp. 16 259–16 268.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
J. Mao, Y. Xue, M. Niu, H. Bai, J. Feng, X. Liang, H. Xu, and C. Xu, “Voxel transformer for 3d object detection,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
A. H. Lang, S. Vora, H. Caesar, L. Zhou, J. Yang, and O. Beijbom, “Pointpillars: Fast encoders for object detection from point clouds,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2019, pp. 12 697–12 705.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Y. Yan, Y. Mao, and B. Li, “Second: Sparsely embedded convolutional detection,” <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Sensors (Basel, Switzerland)</em>, vol. 18, 2018.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Y. Zhou and O. Tuzel, “Voxelnet: End-to-end learning for point cloud based 3d object detection,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2018, pp. 4490–4499.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
X. Zhou, D. Wang, and P. Krähenbühl, “Objects as points,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/1904.07850, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
L. Fan, Z. Pang, T. Zhang, Y.-X. Wang, H. Zhao, F. Wang, N. Wang, and Z. Zhang, “Embracing single stride 3d object detector with sparse transformer,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pp. 8448–8458, 2022.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Z. Liu, Y. Lin, Y. Cao, H. Hu, Y. Wei, Z. Zhang, S. Lin, and B. Guo, “Swin transformer: Hierarchical vision transformer using shifted windows,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, pp. 9992–10 002, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
P. Sun, W. Wang, Y. Chai, G. Elsayed, A. Bewley, X. Zhang, C. Sminchisescu, and D. Anguelov, “Rsn: Range sparse net for efficient, accurate lidar 3d object detection,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2021, pp. 5725–5734.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
G. P. Meyer, A. G. Laddha, E. Kee, C. Vallespi-Gonzalez, and C. K. Wellington, “Lasernet: An efficient probabilistic 3d object detector for autonomous driving,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pp. 12 669–12 678, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
J. Ngiam, B. Caine, W. Han, B. Yang, Y. Chai, P. Sun, Y. Zhou, X. Yi, O. Alsharif, P. Nguyen, Z. Chen, J. Shlens, and V. Vasudevan, “Starnet: Targeted computation for object detection in point clouds,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/1908.11069, 2019.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Y. Wang, A. Fathi, A. Kundu, D. A. Ross, C. Pantofaru, T. Funkhouser, and J. Solomon, “Pillar-based object detection for autonomous driving,” in <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2020, pp. 18–34.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Y. Chai, P. Sun, J. Ngiam, W. Wang, B. Caine, V. Vasudevan, X. Zhang, and D. Anguelov, “To the point: Efficient 3d object detection in the range image with graph convolution kernels,” in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2021.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
L. Fan, X. Xiong, F. Wang, N. long Wang, and Z. Zhang, “Rangedet: In defense of range view for lidar-based 3d object detection,” <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, pp. 2898–2907, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Z. Li, F. Wang, and N. Wang, “Lidar r-cnn: An efficient and universal 3d object detector,” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2021, pp. 7546–7555.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
H. Sheng, S. Cai, Y. Liu, B. Deng, J. Huang, X.-S. Hua, and M.-J. Zhao, “Improving 3d object detection with channel-wise transformer,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2021, pp. 2743–2752.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
C. Liu, Z. Leng, P. Sun, S. Cheng, C. R. Qi, Y. Zhou, M. Tan, and D. Anguelov, “Lidarnas: Unifying and searching neural architectures for 3d point clouds,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2022, pp. 158–175.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Z. Yuan, X. Song, L. Bai, Z. Wang, and W. Ouyang, “Temporal-channel transformer for 3d lidar-based video object detection for autonomous driving,” <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">TCSVT</em>, vol. 32, no. 4, pp. 2068–2078, 2021.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
J. Yin, J. Shen, C. Guan, D. Zhou, and R. Yang, “Lidar-based online 3d video object detection with graph-based message passing and spatiotemporal transformer attention,” in <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Z. Yang, Y. Zhou, Z. Chen, and J. Ngiam, “3d-man: 3d multi-frame attention network for object detection,” in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2021.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
W. Luo, B. Yang, and R. Urtasun, “Fast and furious: Real time end-to-end 3d detection, tracking and motion forecasting with a single convolutional net,” in <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2018, pp. 3569–3577.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Z. Li, W. Wang, H. Li, E. Xie, C. Sima, T. Lu, Q. Yu, and J. Dai, “Bevformer: Learning bird’s-eye-view representation from multi-camera images via spatiotemporal transformers,” in <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.17270</em>, 2022.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
X. Chen, S. Shi, B. Zhu, K. C. Cheung, H. Xu, and H. Li, “Mppnet: Multi-frame feature intertwining with proxy points for 3d temporal object detection,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2205.05979</em>, 2022.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Z. Zhou, X. Zhao, Y. Wang, P. Wang, and H. Foroosh, “Centerformer: Center-based transformer for 3d object detection,” in <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2022.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
X. Zhou, D. Wang, and P. Krähenbühl, “Objects as points,” in <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1904.07850</em>, 2019.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. Ba, “Adam: A method for stochastic optimization,” <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
I. Loshchilov and F. Hutter, “Decoupled weight decay regularization,” <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1711.05101</em>, 2017.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
H. Caesar, V. Bankiti, A. H. Lang, S. Vora, V. E. Liong, Q. Xu, A. Krishnan, Y. Pan, G. Baldan, and O. Beijbom, “nuscenes: A multimodal dataset for autonomous driving,” in <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2020.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
A. Geiger, P. Lenz, and R. Urtasun, “Are we ready for autonomous driving? the kitti vision benchmark suite,” in <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2012.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2309.16869" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2309.16870" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2309.16870">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2309.16870" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2309.16871" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 03:50:49 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
